{
  "article_text": [
    "density - functional theory ( dft ) constitutes one of the most popular methods in quantum chemistry .",
    "the foundations of dft rest in particular on three contributions : first , the hohenberg  kohn ( hk ) theorems established a one - to - one mapping between a set of scalar potentials and a set of ground - state densities as well as a variation principle based on the density  @xcite . here , the density is the charge density ( strictly , the negative of the charge density in units of the elementary electron charge ) .",
    "second , the levy  lieb constrained - search expression provided a formal but explicit expression for the intrinsic energy ( the universal density functional ) and clarified significant fundamental points  @xcite .",
    "third , lieb further generalized the universal functional to a convex functional represented in terms of a legendre  fenchel transform  @xcite . from a mathematical point of view",
    ", lieb s formulation is particularly attractive as it allows application of convex analysis to establish several properties of the intrinsic energy functional  @xcite .",
    "additionally , lieb s framework has made feasible practical calculations of approximations to the exact intrinsic energy functional and adiabatic connection curves  @xcite , enabling detailed comparisons of the properties of approximate and near - exact density functionals to be made  @xcite .",
    "standard dft , involving universal energy functionals of only the charge density , is limited to the treatment of physical systems that may be represented as eigenstates of hamiltonians that differ only in their scalar potentials . to treat systems subject to an external magnetic field",
    ", it is necessary to introduce an additional dependence on the magnetic field or its associated vector potential into the hamiltonian .",
    "consequently , a dependence on a corresponding variable apart from charge density is needed in the universal energy functional . in magnetic - field",
    "density functional theory ( b - dft ) this is resolved by constructing a family of density functionals ",
    "one for each external magnetic field@xcite .    in the present work",
    ", we consider the alternative current density - functional theory ( cdft ) , where the additional variable is either the paramagnetic current density or the physical current density .",
    "we restrict our attention to non - relativistic formulations and most of the discussion will for simplicity not be concerned with densities or density - contributions arising from spin - degrees of freedom .",
    "we term the variables on which the energy functionals explicitly depend the _ basic variables _ and make a distinction between _ basic densities _ and _ basic potentials_. many choices of basic densities are conceivable  @xcite ; we require only that the choices result in useful density - functional theories .",
    "our perspective thus differs from that in recent works on cdft by pan and sahni  @xcite , who restrict the term _ basic variable _ to variables that admit an hk theorem .",
    "although it appears naturally in the generic framework introduced by ayers and fuentealba  @xcite , the possibility of choosing basic potentials other than the standard electromagnetic potentials and fields has not previously been explored in detail .    by far",
    "the most developed form of cdft is that due to vignale and rasolt  @xcite , who use the charge and paramagnetic current densities as basic variables . for these variables , a kohn ",
    "sham approach has been formulated  @xcite with an associated adiabatic - connection  @xcite , virial and scaling relations  @xcite analogous to standard kohn  sham dft .",
    "in addition , optimized - effective - potential ( oep ) approaches based on this formulation of cdft have been presented to treat non - collinear magnetism  @xcite and extensions to time - dependent cdft have been considered  @xcite . however , in cdft based on the charge and paramagnetic current densities as basic variables , no hk - type theorem exists and the consequences of this have been extensively discussed in the literature  @xcite . in the present work",
    ", we examine this question for cdft in some detail , demonstrating how convex analysis of the underlying universal density functional can be a significant aid in clarifying the relationship between basic variables of cdft and the potentials .",
    "a cdft featuring the gauge - invariant physical current density ( rather than the paramagnetic current density ) as a basic variable is appealing from a physical perspective and is therefore also considered here .",
    "specifically , we examine the formulations due to diener  @xcite and pan and sahni  @xcite .",
    "we begin in sec .",
    "[ sec : prelim ] by introducing notation related to sets of basic potentials , basic densities , and mappings between them . in sec .",
    "[ sec : cdft ] , we consider cdfts that use the charge and paramagnetic current densities as basic variables  in particular , sec .",
    "[ sec : restoreconc ] establishes the concavity of a universal density functional based on these variables and sec .",
    "[ subsec : numf ] outlines the opportunities that this formulation affords for numerical studies of this functional .",
    "next , in sec .",
    "[ secphyscdft ] , the use of the charge and physical current densities as basic variables is considered and two previous formulations  @xcite are examined . our concluding remarks are presented in sec .",
    "[ sec : conc ] .",
    "before discussing cdft , we briefly review standard dft , with emphasis on lieb s treatment based on convex conjugation  @xcite . the concepts and techniques of convex analysis introduced here",
    "are well suited to the study of dft and will later be used in our discussion of cdft .",
    "some background is also given in the appendix .",
    "we consider a system of @xmath0 electrons with an electronic hamiltonian of the form ( in atomic units ) @xmath1 = \\frac{1}{2 } \\sum_k p_k^2 + \\sum_k v(\\mathbf{r}_k ) + w , \\label{hamv}\\ ] ] where @xmath2 is the canonical momentum operator of electron @xmath3 , @xmath4 is the external potential at position @xmath5 , and @xmath6 is the two - electron coulomb repulsion operator .",
    "the state of the system is described by a density matrix @xmath7 , which is a convex combination of normalized @xmath0-electron pure - state density matrices @xmath8 where the wave functions @xmath9 are antisymmetric in the space and spin coordinates @xmath10 of the @xmath0 electrons . the electron density associated with such density matrices",
    "is given by @xmath11 where the volume element is @xmath12 , i.e. , the integration is over all @xmath0 spin and spatial coordinates except @xmath13 .",
    "the ground - state energy is obtained from the rayleigh ",
    "ritz variation principle , @xmath14 = \\inf_{\\gamma }   { \\mathrm{tr } ( { \\gamma h[v ] } ) } , \\ ] ] where the minimization is over all @xmath0-electron density matrices .",
    "an infimum rather than a minimum is taken in eq .   since @xmath15 may or may not support an @xmath0-electron ground state .",
    "the set of potentials that support one or more @xmath0-electron ground states ( and for which therefore the infimum is attained ) is denoted by @xmath16 ; the potentials in @xmath16 are sometimes said to be @xmath17-representable .",
    "conversely , a density that is an ensemble ground - state density for some potential @xmath18 is said to be ( ensemble ) @xmath15-representable ; the set of @xmath15-representable densities is denoted by @xmath19 . for convenience , we shall also refer to @xmath17-representable potentials and @xmath15-representable densities as ground - state potentials and densities , respectively .    in the constrained - search formalism of dft",
    ", we write the rayleigh ",
    "ritz variation principle as an hk variation principle , @xmath20 = \\inf_{\\rho \\in \\mathcal{i}_n } \\left ( f[\\rho ] + ( \\rho | v ) \\right ) , \\label{eqhk}\\ ] ] where @xmath21 is the set of @xmath0-representable densities  that is , the set of the nonnegative densities @xmath17 with @xmath22 and with a finite von weizscker kinetic energy",
    ". the lieb constrained - search functional @xmath23 is given by @xmath24 = \\inf_{\\gamma\\mapsto \\rho } { \\mathrm{tr}({\\gamma h[0 ] } ) } , \\label{fll}\\ ] ] where the notation @xmath25 indicates that the minimization is restricted to density matrices @xmath7 that reproduce the density @xmath17 .",
    "if @xmath17 is not @xmath0-representable , no such @xmath7 exists , and @xmath26=+\\infty$ ] by definition .",
    "the hk variation principle in  eq .",
    "is well defined for all potentials @xmath15 that have a finite pairing with every @xmath27 , @xmath28    an especially attractive formulation of dft is lieb s formulation in terms of legendre  fenchel transformations or convex conjugation .",
    "this formulation is not only elegant , but also fits naturally in the well - developed mathematical field of convex analysis , allowing application of deep results of convex analysis to dft , of which we will give some examples .",
    "lieb s formulation of dft begins with the observation that the ground - state energy @xmath29 $ ] is upper semi - continuous and concave in @xmath15 and therefore may be represented by its conjugate function : lieb s universal density functional @xmath26 $ ] .",
    "the ground - state energy and density functionals are then related as    @xmath30 & = \\inf_{\\rho\\in x } \\left[f[\\rho ] + ( \\rho|v)\\right ] ,    \\label{eqliebvfun }         \\\\",
    "f[\\rho ] & = \\sup_{v\\in x^ * } \\left[e[v ] - ( \\rho|v)\\right ] .",
    "\\label{eqliebffun}\\end{aligned}\\ ] ]    [ eqlieb ]    here , @xmath31 is a banach space ( a complete normed vector space ) that contains @xmath21 , and @xmath32 is its dual  that is , the set of all bounded linear functionals on @xmath31 ( also a banach space ) , thereby ensuring that @xmath33 .",
    "lieb identified @xmath34 and @xmath35 , which contains , among others , all coulomb potentials .",
    "the observations that @xmath29 $ ] and @xmath26 $ ] are upper and lower semicontinuous concave and convex functions , respectively , together with the identification of the banach spaces @xmath31 and @xmath32 are the key elements that place dft within the setting of convex analysis .    the duality of @xmath36 and @xmath23 apparent in eq .",
    "means that the same information is contained in either functional but encoded in different ways ; this duality is emphasized by referring to @xmath36 and @xmath23 as the extrinsic and intrinsic energies , respectively , of the electronic system .",
    "the infimum and supremum expressions on the right - hand sides of eqs .   and   feature linear pairings of densities and potentials and are therefore by construction concave and convex , respectively .",
    "indeed , a necessary and sufficient condition for @xmath29 $ ] ( @xmath26 $ ] ) to be upper ( lower ) semicontinuous and concave ( convex ) is the existence of such expressions  @xcite .    unlike the lieb density - matrix constrained - search functional ,",
    "lieb constrained - search functional , defined in terms of pure states rather than density matrices , is not convex and hence not identical to the lieb functional .    in the present paper ,",
    "we generalize lieb s formulation of dft to cdft .",
    "in particular , we discuss the vignale ",
    "rasolt constrained - search functional as a generalization of the lieb functional to systems in the presence of a vector potential .",
    "we shall see that such a generalization is possible after a redefinition of the scalar potential .",
    "however , we here leave aside technical questions such as lower semicontinuity and infimum and supremum domains ( i.e. , banach spaces ) , which is the subject of future work ; for a discussion of such mathematical issues within standard dft , see lieb  @xcite and eschrig  @xcite .",
    "by contrast , the concavity of @xmath36 and the convexity of @xmath23 are essential properties for our discussion of cdft .",
    "if @xmath29 $ ] happens to be non - concave , it can not be represented by an expression like that in eq .",
    ", even by allowing @xmath23 to be non - convex .",
    "therefore , no universal functional with a linear potential pairing can exist for non - concave energies ( such as those of excited states of the same symmetry as the ground state ) .",
    "a cdft with the paramagnetic current as a basic density was considered in the seminal work of vignale and rasolt  @xcite . in their formulation of cdft ,",
    "the basic potentials are the standard electromagnetic potentials @xmath37 and the basic densities are the charge density and paramagnetic current density @xmath38 .",
    "we shall here first review their theory and then discuss an alternative formalism , based on a redefinition of the basic scalar potential .",
    "we consider electrons subject to time - independent external electromagnetic fields @xmath39 and @xmath40 , represented by the scalar potential @xmath4 and the vector potential @xmath41 , respectively . for potentials",
    "@xmath42 , we introduce the equivalence relation @xmath43 which defines equivalence classes of potentials that differ only by a static gauge transformation , thereby representing the same external fields .",
    "we note that a general gauge transformation of @xmath15 and @xmath44 is given by @xmath45 and @xmath46 , for some arbitrary gauge function @xmath47 .",
    "if @xmath44 is to remain static after the transformation , we must require that @xmath48 , where @xmath49 is constant .",
    "it follows that a general time - independent gauge transformation is given by @xmath50 and @xmath51 , where the constant @xmath49 and the function @xmath52 are independent .",
    "therefore , the equivalence relation in eq .   holds if and only if there exists a constant @xmath49 and a sufficiently well - behaved gauge function @xmath52 such that @xmath53 and @xmath54 .    in the presence of a vector potential , the electronic hamiltonian in eq .",
    "is modified by replacing the canonical momentum operator @xmath55 by the mechanical ( kinetic ) momentum operator @xmath56 , yielding @xmath57 = \\frac{1}{2 } \\sum_k \\pi_k^2 + \\sum_k v(\\mathbf{r}_k ) + w.    \\label{ham}\\ ] ] we have here omitted the spin - dependent term , @xmath58 , from the hamiltonian . by analogy with eq .",
    ", the rayleigh  ritz variation principle in the presence of a vector potential is given by @xmath59 = \\inf_{\\gamma }   { \\mathrm{tr } ( { \\gamma h[v,\\mathbf{a } ] } ) } , \\ ] ] where the minimization is over density matrices @xmath7 containing @xmath0 electrons , see eq .  .",
    "an infimum rather than a minimum is taken to ensure that the energy is well defined also when @xmath37 does not support a ground state .",
    "we denote the set of all potentials @xmath60 that support a ground state with this hamiltonian by @xmath61 \\text{\\ has a g.s.}\\}\\ ] ] and also introduce the related set @xmath62 \\text{\\ has a g.s.}\\}\\ ] ] in preparation of a reparameterization of the scalar potential that will be introduced later .    in the presence of a vector potential , the ensemble ground - state charge densities @xmath17 are as before given by eq .  . regarding the induced currents , we distinguish between the paramagnetic current density and the physical current density",
    "the former is defined as @xmath63 the paramagnetic current density is gauge - dependent and unobservable .",
    "the physical current density is given by @xmath64 and satisfies the relation @xmath65 .",
    "unlike the paramagnetic current , the physical current is gauge - invariant .",
    "finally , the sets of paramagnetic and physical @xmath15-representable ground - state densities are denoted by @xmath66\\ } , \\\\",
    "\\mathcal{b}_n & = \\{(\\rho,\\mathbf{j } ) | ( \\rho,\\mathbf{j } ) \\text{\\ is g.s .",
    "den.\\ of some\\ } h[v,\\mathbf{a}]\\},\\end{aligned}\\ ] ] where both mixed and pure states are allowed .      the hk theorem of standard dft states that the ground - state density @xmath17 determines the scalar potential @xmath15 up to a constant shift .",
    "hence , two potentials that differ by more than a constant shift can not give rise to the same ground - state density .",
    "this fact establishes a mapping from ground - state densities to potentials .",
    "vignale and rasolt established that two different potentials @xmath67 with different ground - state wave functions @xmath68 can not give rise to the same paramagnetic ground - state density @xmath38 . however",
    ", this does not establish an analogue of the hk theorem for cdft  @xcite since different potentials @xmath67 can map to the same density in @xmath69 via the same wave function , @xmath70 = \\psi[v_2,\\mathbf{a}_2]$ ] .",
    "vignale and rasolt s result can be extended to a form that applies also when the ground states are degenerate : _ let @xmath71 be a ground state of @xmath72 $ ] and let @xmath73 be a ground state of @xmath74 $ ] .",
    "if @xmath71 and @xmath73 give rise to the same paramagnetic density , @xmath75 , then @xmath73 is also a ground state of @xmath72 $ ] and @xmath71 is also a ground state of @xmath74 $ ] .",
    "_    the above statement appears to be as close as one can get to a hk - like result for paramagnetic densities @xmath38 .",
    "a cdft formulated in terms of the paramagnetic current density thus can not be based on a formal mapping from ground - state densities to potentials . on the other hand , rigorous formulations of standard dft",
    "do not rely on the hk mapping from densities to potentials .",
    "these rigorous formulations can be extended to the paramagnetic current density as a basic variable .",
    "the absence of an hk - type theorem in cdft is therefore not a serious impediment .",
    "an important property of @xmath29 $ ] in eq .",
    "is its concavity in @xmath15 , which established duality with the universal density functional @xmath26 $ ] .",
    "however , unlike @xmath29 $ ] , the energy functional @xmath76 $ ] in eq .",
    "is not concave .",
    "the non - concavity of @xmath76 $ ] is apparent in , for example , any diamagnetic ground state at vanishing external magnetic field .",
    "such a ground state has a negative definite magnetizability tensor @xmath77 and , when restricted to weak uniform magnetic fields @xmath78 , the energy is a convex function @xmath79 in @xmath80 and therefore in @xmath44 .    in more detail , consider a one - electron system confined to the ( two - dimensional ) @xmath81-plane , subject both to a uniform magnetic field along the @xmath82-axis and to a harmonic - oscillator potential .",
    "parameterizing the scalar and vector potentials under consideration as @xmath83 we obtain the following hamiltonian @xmath84 & = \\frac{1}{2 } p^2 + \\frac{1}{2 } b l_z + v_{\\text{ho}}(\\mathbf{r};k ) + \\frac{1}{2 } a_{\\perp}(\\mathbf{r};b)^2 \\\\    & = \\frac{1}{2 } p^2 + \\frac{1}{2 } b l_z + \\frac{1}{8 } \\left(4k + b^2\\right ) ( x^2+y^2 ) ,   \\end{split}\\ ] ] where @xmath85 is a good quantum number . for @xmath86 and some finite interval @xmath87 ,",
    "the ground state has @xmath88 and application of a magnetic field has exactly the same effect as the introduction of a harmonic - oscillator potential .",
    "for these potentials , the ground - state energy is @xmath89 = e[v_{\\text{ho } } + \\tfrac{1}{2 }    a_{\\perp}^2 , \\mathbf{0 } ] = \\sqrt{k + \\tfrac{1}{4 } b^2}.    \\label{eq : example - energy}\\ ] ] note that the right - hand side is concave in @xmath90 and convex in @xmath91 .",
    "hence , on the restricted set of potentials spanned by @xmath92 and @xmath87 , the functional @xmath93 $ ] is not only non - concave but convex in its second argument . on a larger domain ,",
    "the functional is neither concave nor convex .",
    "we conclude that @xmath94 $ ] can not be represented by a conjugate functional in the manner of eq .  .",
    "however , this does not preclude a constrained - search formulation of cdft , as discussed in the next subsection .      rewriting the rayleigh ",
    "ritz variation principle in eq .   by analogy with the constrained - search approach of standard dft in eq .",
    ", we obtain an hk - type variation principle for a system in the presence of a scalar and vector potential , @xmath95 = \\inf_{\\rho,\\mathbf{j}_{\\text{p } } } \\left [ f_{\\text{vr}}[\\rho,\\mathbf{j}_{\\text{p } } ] + ( \\rho|v+\\tfrac{1}{2 } a^2 ) + ( \\mathbf{j}_{\\text{p}}|\\mathbf{a } ) \\right],\\ ] ] where the _ vignale  rasolt constrained - search functional _ is given by @xmath96 = \\inf_{\\gamma\\mapsto(\\rho,\\mathbf{j}_{\\text{p } } ) } { \\mathrm{tr}({\\gamma ( \\tfrac{1}{2 } p^2 + w ) } ) } \\label{fvr}\\ ] ] and we have introduced the following notation for the pairing between a current density and a vector potential : @xmath97    like the lieb constrained - search functional given in eq .  , the vignale  rasolt",
    "constrained - search functional in  eq .   is universal in the sense that it does not depend on the potential @xmath37 , only on the density @xmath38 .",
    "another important characterization of the lieb functional is its convexity . to examine the convexity of @xmath98 ,",
    "let @xmath99 and @xmath100 be arbitrary ( lebesque integrable ) functions and let @xmath101 , @xmath102 .",
    "we then obtain @xmath103 \\\\      & \\leq    \\inf_{\\substack{\\gamma_1\\mapsto(\\rho_1,\\mathbf{j}_{\\text{p}1})\\\\\\gamma_2\\mapsto(\\rho_2,\\mathbf{j}_{\\text{p}2 } ) } }        { \\mathrm{tr}({(\\lambda\\gamma_1 + \\mu\\gamma_2 )   ( \\tfrac{1}{2 } p^2 + w ) } ) }   \\\\       & = \\lambda f_{\\text{vr}}[\\rho_1 , \\mathbf{j}_{\\text{p}1 } ] +        \\mu f_{\\text{vr}}[\\rho_2,\\mathbf{j}_{\\text{p}2 } ] , \\end{split}\\ ] ] demonstrating that @xmath98 is convex in @xmath38 .",
    "the key point in establishing the inequality above is to restrict the infimum over all density matrices @xmath104 to an infimum over all matrices of the form @xmath105 where @xmath106 and @xmath107 , thereby overestimating the infimum .    given that the vignale  rasolt functional is convex , it is uniquely represented by a convex conjugate functional . for the lieb functional @xmath26 $ ]",
    ", the conjugate is the concave ground - state energy @xmath29 $ ] .",
    "however , since @xmath76 $ ] is not concave , it can not be the conjugate to @xmath108 $ ] .",
    "in the following , we identify the energy conjugate to @xmath109 $ ] , thereby arriving at a legendre  fenchel formulation of cdft .      inspection of the general expression in eq .   and",
    "the harmonic - oscillator example suggest the introduction of a new basic scalar potential , @xmath110 the choice of @xmath111 as basic potentials and @xmath38 as basic densities results in a theory where the hk variation principle takes the form of a legendre  fenchel transformation with a linear pairing @xmath112 of the densities and potentials : @xmath113 & = \\inf_{\\gamma } { \\mathrm{tr}({\\gamma \\bar{h}[u , \\mathbf{a } ] } ) } \\\\     & = \\inf_{\\rho,\\mathbf{j}_{\\text{p } } } \\left[f_{\\text{vr}}[\\rho,\\mathbf{j}_{\\text{p } } ] + ( \\rho|u ) + ( \\mathbf{j}_{\\text{p}}|\\mathbf{a } ) \\right ] .",
    "\\end{split}\\ ] ] here we have introduced the notation @xmath114 & = h[u - \\tfrac{1}{2 } a^2 , \\mathbf{a } ] , \\\\",
    "\\bar{e}[u,\\mathbf{a } ] & = e[u - \\tfrac{1}{2 } a^2 , \\mathbf{a } ] .\\end{aligned}\\ ] ] the energy @xmath115 $ ] is now by construction concave , allowing it to be generated from the convex intrinsic energy @xmath116 $ ] by a reverse legendre ",
    "fenchel transformation : @xmath117 = \\sup_{u,\\mathbf{a } } \\left [ \\bar{e}[u,\\mathbf{a } ] - ( \\rho|u ) - ( \\mathbf{j}_{\\text{p}}|\\mathbf{a } ) \\right].\\ ] ] thus , by a change of variables from @xmath15 to @xmath118 , we have restored the conjugate relation between the extrinsic and intrinsic energies characteristic of standard dft .    strictly speaking , for @xmath116 $ ] and @xmath115 $ ] to form a conjugate pair",
    ", we must specify their domains in the form of a banach space @xmath119 and its dual @xmath120 , respectively .",
    "furthermore , we must demonstrate lower and upper semi - continuity of the intrinsic and extrinsic energies , respectively .",
    "however , regarding the domains , we note here that , in lieb s formulation of standard dft , the vector space @xmath35 of potentials does not contain every potential with a square integrable ground state ( e.g. , it does not contain harmonic potentials ) , but @xmath121 does contain all coulomb potentials , thus covering most systems of interest .",
    "a similar compromise is expected for cdft : we can not expect to identify a vector space @xmath119 of densities such that its dual @xmath120 includes all ground - state potentials @xmath16 . in particular ,",
    "since gauge transformations may produce potentials @xmath122 that are arbitrarily ill - behaved at infinity , we expect some gauge restriction to be necessary .",
    "in general , the functionals @xmath123 and @xmath98 are not differentiable .",
    "consequently , we can not characterize the ground - state densities in the cdft hk variation principle of eq .   in terms of functional derivatives .",
    "on the other hand , in convex analysis , the proper tool for characterizing minimizers and maximizers are sub- and supergradients , respectively .",
    "we here introduce sub- and supergradients in the context of cdft .",
    "we begin by noting that an immediate consequence of the cdft variation principles in eqs .   and",
    "fenchel s inequality _ , @xmath124 \\leq    f_{\\text{vr}}[\\rho,\\mathbf{j}_{\\text{p } } ] + ( \\rho|u ) + ( \\mathbf{j}_{\\text{p}}|\\mathbf{a } ) ,    \\label{eqfenchelineq}\\ ] ] valid for any choice of potential @xmath125 and density @xmath126 .",
    "moreover , equality holds if and only if @xmath127 is a ground - state density belonging to @xmath111 . to characterize ground - state densities and their potentials mathematically",
    ", we use the concepts of subgradients and subdifferentials .",
    "subgradient _ of @xmath98 at @xmath128 is an external potential @xmath129 for which the inequality @xmath96 \\geq f_{\\text{vr}}[\\rho_0,\\mathbf{j}_{\\text{p}0 } ] - ( \\rho-\\rho_0|u_0 ) - ( \\mathbf{j}_{\\text{p}}-\\mathbf{j}_{\\text{p}0}|\\mathbf{a}_0)\\ ] ] holds for all @xmath126 ; see fig.[fig : subdiff ] .",
    "clearly , all potentials @xmath130 for which the density @xmath131 is a minimizer in eq .",
    "are subgradients of @xmath132 at @xmath131 .",
    "the set of all subgradients at @xmath131 is known as the _ subdifferential _ of @xmath98 at @xmath133 and is denoted by @xmath134\\subset x_{\\text{p}}^*$ ] .",
    "hence , to within a minus sign , the subdifferential at @xmath135 is the collection of all external potentials that have the same ground - state density @xmath135 .",
    "$ ] : the set of all slopes ( potentials @xmath136 ) of just - touching tangent planes entirely below the graph at @xmath131 .",
    "one particular tangent , with slope @xmath130 , is shown , while others are indicated by dashed lines .",
    "a similar illustration can be made of the superdifferential @xmath137 $ ] .",
    "[ fig : subdiff ] ]    analogously , we consider the concave energy functional @xmath115 $ ] and its supergradients .",
    "in general , @xmath138 is a _ supergradient _ of @xmath123 at @xmath139 if and only if @xmath140 is a subgradient of the convex functional @xmath141 at @xmath142 .",
    "hence , @xmath131 is a supergradient of @xmath123 at @xmath142 if the inequality @xmath124 \\leq \\bar{e}[u_0,\\mathbf{a}_0 ] + ( \\rho_0|u - u_0 ) + ( \\mathbf{j}_{\\text{p}0}|\\mathbf{a}-\\mathbf{a}_0)\\ ] ] holds for all @xmath143 .",
    "this condition is satisfied precisely when @xmath131 is the density arising from a ( possibly degenerate ) ground state of @xmath144 $ ] .",
    "the _ superdifferential _",
    "@xmath145 $ ] is the collection of all supergradients of @xmath123 at @xmath142 .    for all ground - state densities @xmath131 and associated potentials @xmath142",
    ", we now have the following stationary conditions of the hk and lieb variation principles in eqs .   and  , respectively : @xmath146 , \\quad & ( \\rho_0,\\mathbf{j}_{\\text{p}0 } ) & \\in \\mathcal{b}_n^{\\text{p } } \\cap x,\\\\    ( \\rho_0,\\mathbf{j}_{\\text{p}0 } ) & \\in { \\bar{\\partial}}\\bar{e}[u_0,\\mathbf{a}_0 ] ,   \\quad & ( u_0,\\mathbf{a}_{0 } ) & \\in \\mathcal{u}_n \\cap x^\\ast.\\end{aligned}\\]]importantly , these conditions are equivalent : @xmath130 is a subgradient of @xmath98 at @xmath131 if and only if @xmath131 is a supergradient of @xmath123 at @xmath142 . hence , instead of a one - to - one mapping between individual potentials and individual ground - state densities , the convexity and concavity of the intrinsic and extrinsic energies , respectively , establish a mapping between the convex sets @xmath147 of degenerate ground - state densities and convex sets @xmath148 of potentials that give rise to identical ground - state densities ; see fig .  [",
    "fig : subdiff2 ] .",
    "the sub- and superdifferentials are empty when no minimizer and maximizer exist in the corresponding optimization problems in eqs .   and  .",
    "however , it is a general result of convex analysis that the subgradients ( supergradients ) of a convex ( concave ) function ( under certain semicontinuity conditions ) exist at a dense subset of the domain of the function . in cdft",
    ", this result implies that the set of ground - state densities @xmath149 is dense in the set of all densities and that the set of potentials @xmath142 that support a ground state is dense in the set of potentials .    . instead of a one - to - one mapping of individual potential pairs and corresponding ground - state density pairs ,",
    "the sub- and superdifferentials of @xmath98 and @xmath123 , respectively , maps ( ground - state ) densities into convex sets of ( ground - state ) potentials and potentials into convex sets of densities.[fig : subdiff2 ] ]      consider now the case of degenerate ground - state densities in eq .  .",
    "for a finite degeneracy @xmath150 , the superdifferential of the ground - state energy in the external potential @xmath142 is then a @xmath151-dimensional simplex with @xmath150 pure - state densities @xmath152 at the vertices : @xmath153 = \\operatorname{co}\\{(\\rho_0^i , \\mathbf{j}_{\\text{p},0}^i ) , \\ , | \\",
    ", i = 1 , g_\\text d\\ } ,   \\label{corho}\\ ] ] see fig .",
    "[ fig : convex - hull ] for an illustration .",
    "consequently , each ground - state density @xmath133 may be written as convex combination of the @xmath154 pure - state densities , @xmath155 as is well known , such degeneracies are either accidental or caused by symmetries of the hamiltonian .",
    "$ ] of ground state densities for potentials @xmath111 with degeneracy @xmath156 .",
    "this is a convex set , a three - dimensional simplex , with vertices at @xmath157 , i.e. , @xmath158 =      \\operatorname{co}\\{(\\rho_0^i,\\mathbf{j}_{\\text{p},0}^i)\\}.$ ] in this example , we embed the simplex in @xmath159 , but in reality it is a three - dimensional subset of the density space @xmath119 .",
    "the corresponding set of potentials is also a convex set , but usually with a more complicated structure .",
    "see also fig .",
    "[ fig : subdiff2 ] .",
    "[ fig : convex - hull ] ]    consider next a ground - state density @xmath133 with several maximizing potentials in the lieb variation principle in eq .  .",
    "like the superdifferential of the ground - state energy , the subdifferential of the vignale ",
    "rasolt density functional is a convex set .",
    "let now @xmath142 be a potential with ground - state density @xmath160 and consider the family of external potentials @xmath161 for some potential @xmath162 and @xmath163 .",
    "the associated hamiltonians are given by @xmath164 & = \\bar{h}[u_0,\\mathbf{a}_0 ] + \\lambda k , \\\\ k & = \\sum\\nolimits_i [ \\delta u_0(\\mathbf{r}_i ) + \\frac{1}{2 } \\{\\mathbf{p}_i , \\delta \\mathbf{a}_0(\\mathbf{r}_i)\\ } ] .\\end{aligned}\\ ] ] where @xmath165 denotes the anti - commutator .",
    "clearly , if @xmath144 $ ] and @xmath166 commute , @xmath167 , k \\right ] = 0 , \\label{huk}\\ ] ] then @xmath168 $ ] has the same eigenstates for all @xmath169 .",
    "in particular , as @xmath169 changes continuously from @xmath170 , the external potentials in eq .   will have the same ground - state density @xmath131 until a level crossing with the ground state occurs for @xmath168 $ ] , see capelle and vignale  @xcite .",
    "we note that the commutation condition in eq .",
    "is sufficient but not necessary for the existence of degenerate maximizing potentials",
    ".    there may be several , independent perturbing potentials that commute with the reference hamiltonian @xmath144 $ ] . assuming a finite degeneracy @xmath171 of these potentials , we may write the subdifferential of the vignale ",
    "rasolt density functional as a @xmath172-dimensional simplex @xmath173 = -\\operatorname{co}\\{(u_0^i , \\mathbf{a}_{0}^i ) , \\,|\\ , i = 1 , g_{\\text{p}}\\}.\\ ] ] all potentials with the ground - state density @xmath160 may then be written as a convex combination , @xmath174 of the @xmath171 vertex potentials @xmath175 .",
    "consider now the special case of dft , for which the hk and lieb variation principles are given by eqs .   and  , where @xmath29 $ ] and @xmath26 $ ] depend only on the scalar potential and the electron density , respectively .",
    "let @xmath176 be a potential with ground - state density @xmath177 . clearly , the only scalar potentials @xmath4 that commute with the hamiltonian @xmath178 $ ] are the constant potentials @xmath49 .",
    "it follows that the subdifferential of @xmath23 at @xmath177 is the convex set @xmath179 = - \\ { v_0(\\mathbf{r } ) + c \\,|\\ , c \\in \\mathbb r \\},\\ ] ] which may be regarded as a one - dimensional simplex with vertices @xmath180 . in dft",
    ", therefore , the ground - state density @xmath177 determines the external potential @xmath181 uniquely up to an additive constant @xmath49 , in accordance with the hk theorem .",
    "returning to cdft , consider next two potentials @xmath182 and @xmath183 with the same ground - state density @xmath131 . by the convexity of the subgradient of @xmath98 ,",
    "all convex combinations @xmath184 then have the same ground - state density . recalling that @xmath185 , @xmath186 , and @xmath187 , the characterization of the non - uniqueness given in eq .",
    "can be expressed in terms of the ordinary scalar potential @xmath15 .",
    "if @xmath188 and @xmath189 give rise to the same density , then so do all potentials of the form @xmath190 with @xmath191 .",
    "however , this set is not a convex set and not a subdifferential , due to the use of the @xmath37 rather than @xmath192 variables .",
    "an advantage of the formulation of stationary conditions in cdft in terms of sub- and superdifferentials is that differentiability is not required . in general",
    ", a sufficient condition for differentiability of a function at a point is that the function is continuous at this point and has a single sub- or supergradient there ; in the absence of continuity , differentiability is not guaranteed .",
    "the ground - state energy is differentiable at all potentials @xmath111 that have a nondegenerate ground - state density , whereas the vignale  rasolt functional is in principle nowhere differentiable since we may always add a constant term @xmath49 to the potential without affecting the ground - state densities .",
    "however , assuming that this is the only cause of nondifferentiability of the potentials , we may in the absence of other degeneracies write @xmath193}{\\delta \\rho(\\mathbf{r } ) } = -u(\\mathbf{r } ) - c ,   \\quad     \\frac{\\delta f_{\\text{vr}}[\\rho,\\mathbf{j}_{\\text{p}}]}{\\delta \\mathbf{j}_{\\text{p}}(\\mathbf{r } ) } = -\\mathbf{a}(\\mathbf{r } ) ,    \\label{statf}\\ ] ] and @xmath194}{\\delta u(\\mathbf{r } ) } = \\rho(\\mathbf{r } ) , \\quad    \\frac{\\delta \\bar{e}[u,\\mathbf{a}]}{\\delta \\mathbf{a}(\\mathbf{r } ) } = \\mathbf{j}_{\\text{p}}(\\mathbf{r } ) ,    \\label{state}\\ ] ] where @xmath38 is the ( non - degenerate ) ground - state density of the potential @xmath111",
    ".      besides allowing formal application of theorems in convex analysis to cdft , the convex formulation given above has practical value .",
    "after linear programming and optimization of quadratic functions , optimization of convex and concave functions is the mathematically most well - characterized type of optimization problem .",
    "the fact that convex and concave optimization problems have a unique global optimum ( either in the form a single point or a convex set of optimal points ) and no additional local optima is of great value when devising practical optimization methods .    in standard dft",
    ", lieb s formulation  @xcite of @xmath26 $ ] in terms of the legendre  fenchel transform of the concave energy functional @xmath29",
    "$ ] has proven useful in the study of functionals of interest in kohn  sham theory  @xcite .",
    "in particular , the modulation of the two - electron interaction operator @xmath196 by a parameter @xmath169 such that , @xmath197 allows us to represent the ground - state energy @xmath198 $ ] at interaction strength @xmath169 in terms of its conjugate functional @xmath199 $ ] .",
    "the standard choice is @xmath200 , but other choices are possible .",
    "if the density supplied to @xmath199 $ ] is held fixed at a physical density generated by an appropriate ( high - level , systematically improvable ) _ ab - initio _ quantum - chemical methodology and if the value of the interaction - strength parameter is varied from @xmath170 to @xmath201 , then the adiabatic connection  @xcite between the kohn ",
    "sham ( @xmath202 ) and physical ( @xmath203 ) systems can be studied numerically .",
    "such studies for atomic and molecular species  @xcite can provide useful insight into the failings of standard density - functional approximations and provide data for the construction and evaluation of new forms , based on the modeling of the adiabatic connection  @xcite .    having established a convex formulation of cdft in sec .",
    "[ sec : restoreconc ] , it is possible to calculate the adiabatic connection in cdft in a manner similar to that of standard dft .",
    "details of the adiabatic connection for cdft have been presented previously by liu  @xcite .",
    "the ground - state energy functionals at interaction strength @xmath169 are given by @xmath204 & = \\inf_{\\gamma } { \\mathrm{tr}({\\gamma h_{\\lambda}[v,\\mathbf{a } ] } ) } , \\\\",
    "\\label{eqelambdau }    \\bar{e}_{\\lambda}[u,\\mathbf{a } ] & = e_{\\lambda}[u-\\tfrac{1}{2 } a^2,\\mathbf{a}],\\end{aligned}\\ ] ] where we have introduced the hamiltonian @xmath205 = \\frac{1}{2 } \\sum_k \\pi_k^2 + \\sum_k v(\\mathbf{r}_k ) + w_\\lambda . \\label{hamlambda}\\ ] ] from the exact functional @xmath206 $ ] or an accurate approximation to it , the adiabatic connection may be studied in terms the corresponding vignale ",
    "rasolt functional @xmath207 = \\sup_{u,\\mathbf{a } } \\left [ \\bar{e}_{\\lambda}[u,\\mathbf{a } ] - ( \\rho | u ) - ( \\mathbf{j}_{\\text{p } } | \\mathbf{a } )   \\right ] ,    \\label{acf}\\ ] ] which needs to be evaluated for a fixed density @xmath38 and different values of @xmath169 in the interval @xmath208 .",
    "typically , the density is the ground - state density for some external potential @xmath209 at @xmath203 .",
    "the optimization in eq .",
    "is trivial for @xmath210 since the optimal potential is then @xmath211 ; for @xmath212 , the optimization is non - trivial . in particular , for @xmath202 , the optimal potential is the kohn ",
    "sham potential @xmath213 given by @xmath214 where the classical coulomb or hartree potential @xmath215 and the exchange  correlation potential @xmath216 are the functional derivatives of the corresponding energy components as in standard kohn",
    " sham dft .",
    "the exchange ",
    "correlation contribution to the vector potential is defined as @xmath217}{\\delta \\mathbf{j}_{\\text{p}}},\\ ] ] where differentiability in relevant directions is assumed .",
    "these scalar and vector potentials then enter the cdft kohn ",
    "sham equations  @xcite , which may be re - written in terms of @xmath213 as @xmath218 \\varphi_p = \\varepsilon_p \\varphi_p.\\ ] ] if the spin dependent @xmath219 term is included in the hamiltonian of eq .   with the modified interactions of eq .",
    ", then similar arguments apply .",
    "two - component spinors rather than one - particle orbitals then occur in the kohn ",
    "sham equations , allowing for a treatment of non - collinear magnetism .    even in the absence of external magnetic fields , violations of non - interacting @xmath15-representability ",
    "that is , the existence of a ground - state density of the fully interacting hamiltonian @xmath220 $ ] that can not be reproduced by slater - determinantal ground - states of the non - interacting hamiltonian @xmath221$]have been shown to be common in two - electron systems  @xcite . in general , an extended kohn  sham formalism , allowing for an ensemble description and fractional occupation numbers , is therefore required in cdft as well as in standard dft .    to facilitate the optimization of @xmath222 $ ] at a general interaction strength @xmath169 , we restrict our attention to classes of potentials that can be parameterized in a simple way  for example , as linear combinations of basis functions . the most direct way to benefit from the concavity of @xmath115 $ ] is to parameterize @xmath223 rather than @xmath15 in the affine form @xmath224 the use of @xmath223 rather than @xmath15 eliminates the @xmath225 term and the associated quadratic dependence on @xmath226 , thereby simplifying the equations obtained upon substitution in eq .  .",
    "importantly , it also ensures that all stationary points are true global maxima . to perform optimizations similar to those in refs .",
    "@xcite , all that remains is to be able to calculate the ground - state energy @xmath227 $ ] with sufficient accuracy and to choose appropriate basis functions @xmath228 and @xmath229 .",
    "derivatives with respect to the expansion coefficients @xmath230 and @xmath226 may then be used in a quasi - newton procedure analogous to that in ref .",
    "the choice of basis functions and reference potentials raises the issue of a balanced descriptions of @xmath223 and @xmath44 , as well as the asymptotic limits and reduction of gauge freedom inherent in the finite basis set .",
    "although important for practical implementation , these issues are beyond the scope of this article .      the formulation of cdft with @xmath111 as the basic potential and with the intrinsic and extrinsic energies expressed as mutual legendre ",
    "fenchel transforms makes the introduction of spin straightforward .",
    "the addition of the spin - zeeman operator to the hamiltonian introduces an energy term containing the spin density @xmath231 paired with the magnetic field , @xmath232 . a partial integration transfers the curl operator to the spin density and gives a surface term if the integration domain is finite .",
    "neglect of the surface term leads to the energy term @xmath233 and a theory with @xmath234 as the basic density . here , @xmath235 is the sum of the paramagnetic current and the _ spin current _ @xmath236 .",
    "all results above remain valid with @xmath237 replaced by @xmath238 and with suitable modifications of the hamiltonian and definitions of @xmath16 and @xmath239 .",
    "the use of @xmath240 as a basic density has been discussed by capelle and gross  @xcite as a way to translate functionals between spin - density functional theory ( sdft ) and cdft . the alternative formulation of current - spin dft ( csdft ) in terms of the charge density @xmath17 , the spin density @xmath241 , and the paramagnetic current density @xmath237 as separate basic variables is a less attractive formal theory since two independent potentials such as @xmath111 can not be conjugate to three independent densities @xmath242 . on the other hand , construction of practical approximate exchange ",
    "correlation functionals may be substantially more difficult with the basic variables @xmath17 and @xmath238 .",
    "mathematically , it is not surprising that a theory formulated in terms of magnetic vector potentials and wave functions  both gauge - dependent objects  makes use of gauge - dependent basic variables . indeed , with gauge - dependent notions being so deeply entrenched in the theory , it is not trivial to construct a useful reformulation that features only gauge - invariant basic variables . on the other hand , from a physical point of view ,",
    "it is somewhat unappealing that the paramagnetic current , rather than the physical current , arises as a basic density . therefore , some authors have attempted the construction of an alternative cdft , with the physical current as a basic variable . in particular ,",
    "pan and sahni have gone far in arguing that the paramagnetic current density , in some sense , can not correctly be regarded as a basic cdft variable  @xcite .",
    "an important question that arises in cdft is to what extent an hk theorem is possible when the physical densities @xmath243 are chosen as the basic densities  that is , whether @xmath244 always implies that @xmath245 .",
    "two simple observations lend plausibility to this claim .",
    "first , for one - electron systems , @xmath37 can be found explicitly given @xmath243 .",
    "writing the one - electron wave function as @xmath246 where @xmath247 and @xmath248 are real valued , we obtain the density @xmath249 and physical current density @xmath250 .",
    "because of the identity @xmath251 , the physical densities @xmath17 and @xmath252 determine the external magnetic field , @xmath253 the scalar potential @xmath15 may be determined up to a constant from the eigenvalue equation @xmath254 and the observation that @xmath255 , yielding @xmath256 \\rho^{1/2}(\\mathbf{r } ) = 0,\\ ] ] from which @xmath257 is uniquely determined .",
    "hence , for a one - electron system , @xmath80 and @xmath15 are both determined by @xmath17 and @xmath252 . for an @xmath0-electron system ,",
    "we obtain more generally @xmath258 where @xmath259 is the vorticity introduced by vignale and rasolt  @xcite .",
    "vorticity is a gauge - invariant quantity , but it is not clear whether it can be uniquely reconstructed from @xmath243 , without a priori knowledge of the external magnetic field @xmath80 .",
    "following pan and sahni  @xcite , the second observation is that , while there is no hk theorem for cdft in terms of _ paramagnetic _ densities , the counterexamples to the existence of an hk theorem for paramagnetic densities ( such as the harmonic - oscillator system in sec .",
    "[ sec : electronic ] ) do not preclude an hk theorem for physical densities .    to see this , note that these counterexamples all exhibit different potentials @xmath260 with the same ground state @xmath261 and therefore the same paramagnetic density @xmath262 .",
    "however , according to the original hk theorem , this situation is impossible when @xmath263 since this would imply @xmath264 and therefore @xmath265 .",
    "we must therefore assume that @xmath266 in the counterexamples .",
    "however , from the assumption @xmath267 , it then follows that @xmath268 . in short ,",
    "if @xmath260 share the same ground - state wave function , then the _ physical densities _ are not the same .",
    "it remains to explore whether it is possible to have different ground states @xmath269 but the same physical densities @xmath270 ; if possible , then no hk theorem exists for the physical current densities .",
    "general arguments for an hk theorem for physical current densities have been put forth by pan and sahni  @xcite and by diener  @xcite . however , as discussed below , neither of these arguments amounts to a rigorous proof . to our knowledge ,",
    "the existence of an hk theorem for physical current densities therefore remains open .",
    "the standard hk theorem of dft states that @xmath271 implies @xmath272 .",
    "the proof has two parts : first , it is shown that scalar potentials that differ by more than a constant must have different wave functions @xmath273 and @xmath274 ; second , this result is combined with the rayleigh  ritz variation principle to show that the assumptions @xmath275 and @xmath276 lead to a contradiction .",
    "it follows that @xmath277 implies @xmath278 .    for cdft with physical densities ,",
    "a proof along the same lines has been attempted by pan and sahni  @xcite .",
    "the first part of their argument establishes that different potentials @xmath279 can not yield the same physical density @xmath280 if the ground - state wave functions are the same .",
    "that is , without loss of generality , it may be assumed in an hk - type argument that the wave functions are different .",
    "the second part of their argument seeks to establish , by the rayleigh ",
    "ritz variation principle , that gauge - inequivalent potentials can not have both different ground - state wave functions and the same physical ground - state density . to this end , two potentials @xmath281 , @xmath282 , are considered and it is argued that a contradiction arises from the following assumptions :    * the potentials have the same physical density @xmath283 . *",
    "the potentials differ by more than a gauge transformation , @xmath284 .",
    "no contradiction can result from ( a ) alone , so the assumption ( b ) is crucial for any reductio ad absurdum argument to succeed .",
    "for example , because of gauge freedom , ( a ) and the negation of ( b ) are certainly not contradictory since this corresponds to the perfectly consistent situation where two potentials that differ by a gauge transformation give rise to the same physical density .",
    "a correct proof must therefore contain at least one step that makes use of ( b ) .",
    "however , while stated as an assumption , ( b ) is in fact never used in pan and sahni s argument .",
    "the argument must consequently be invalid .    in more detail , we here identify an erroneous step in the reasoning in ref .",
    "@xcite , in particular eqs .",
    "( 35)(40 ) . with @xmath273 and @xmath274",
    "denoting the ground states of the two potentials , we obtain eq .",
    "( 35 ) from ref .",
    "@xcite : @xmath285 { | { \\psi } \\rangle } < { \\langle { \\psi ' } | } h[v,\\mathbf{a } ] { | { \\psi ' } \\rangle}.\\ ] ] the identity @xmath286 = h[v',\\mathbf{a } ' ] + ( h[v,\\mathbf{a } ] - h[v',\\mathbf{a}'])$ ] yields for the expectation value on the right - hand side",
    "@xmath287 { | { \\psi ' } \\rangle } & = e ' + { \\langle { \\psi ' } | } \\tfrac{1}{2 } \\pi^2 + v - \\tfrac{1}{2 } \\pi'^2 - v ' { | { \\psi ' } \\rangle }    \\\\      & = e ' + { \\langle { \\psi ' } | } \\tfrac{1}{2 } \\{\\boldsymbol{\\pi},\\mathbf{a}\\ } + v - \\tfrac{1}{2 } a^2 - \\tfrac{1}{2 } \\{\\boldsymbol{\\pi}',\\mathbf{a}'\\ } - v ' + \\tfrac{1}{2 } a'^2 { | { \\psi ' } \\rangle}.     \\label{hexp }   \\end{split}\\ ] ]    it is here important to distinguish between @xmath288 and @xmath289 since the representation of the mechanical momentum operator is gauge and vector - potential dependent . to proceed ,",
    "we explicitly write out the corresponding physical current density operators , which for the two potentials are given by @xmath290 from these , we may calculate the physical current ( assumed to be the same in the two cases ) and its interaction with some vector potential @xmath291 as @xmath292 where it is important to use primed or unprimed quantities consistently . to ensure that we are using the correct current - density operator for @xmath274 in eq .",
    ", we insert the identity @xmath293 yielding , @xmath294 where we have introduced @xmath295 and @xmath296 and also used the inequality in eq .  .",
    "carrying out the above argument with primed and unprimed variables interchanged , we obtain the strict inequality @xmath297 where the last term does not vanish since @xmath298 is symmetric in the primed and unprimed variables . in agreement with the hk theorem",
    ", a contradiction arises if ( and only if ) @xmath299 .",
    "when @xmath41 and @xmath300 differ where @xmath301 ( as a result of different physical fields or by a gauge transformation ) , no contradiction arises .    in the argument given in ref .",
    "@xcite , the authors incorrectly identify @xmath302 and @xmath303 , leading to their eq .",
    "( 38 ) , which differs from eq .   above by the replacement of @xmath304 with @xmath305 .",
    "since their term is antisymmetric rather than symmetric in the primed and unprimed variables , the authors obtain a contradiction @xmath306 irrespective of @xmath44 and @xmath307 , leading to the unjustified conclusion that ( @xmath308 determines @xmath37",
    ".      an earlier attempt to prove an hk - type theorem for physical currents by diener  @xcite invokes an intriguing strategy for eliminating the term @xmath309 from eq .  .",
    "the key idea is to replace the external vector potential @xmath44 by an effective vector potential @xmath310 $ ] defined to reproduce a given physical current density @xmath252 from a given wave function @xmath273 so that @xmath311.\\ ] ] consider now the following rearrangement of the kinetic energy term @xmath312 by definition , @xmath313,\\mathbf{a}\\ } { | { \\psi } \\rangle } = ( \\mathbf{j}|\\mathbf{a})$ ] . for a prescribed physical current density @xmath314 , the expectation value of an arbitrary wave function is then @xmath315 { | { \\psi } \\rangle } & = { \\langle { \\psi } | } \\tfrac{1}{2 } ( p^2 - a_{\\text{eff}}^2 ) + w { | { \\psi } \\rangle } \\nonumber \\\\     & + ( \\mathbf{j}_0|\\mathbf{a } ) + ( \\rho|v ) + \\tfrac{1}{2}(\\rho | ( \\mathbf{a}_{\\text{eff}}-\\mathbf{a})^2 ) .",
    "\\label{eqhwitheffa}\\end{aligned}\\ ] ] the total current evaluated using the effective momentum operator @xmath316 instead of the true mechanical momentum operator @xmath317 always evaluates to the prescribed current @xmath314 .",
    "diener then defines a universal density functional of the form @xmath318 & = \\inf_{\\psi\\mapsto\\rho } { \\langle { \\psi } | } h_{\\text{eff}}[\\mathbf{j},\\psi ] { | { \\psi } \\rangle } ,           \\\\",
    "h_{\\text{eff}}[\\mathbf{j},\\psi ] & = \\tfrac{1}{2 } p^2 - \\tfrac{1}{2 } a_{\\text{eff}}[\\mathbf{j},\\psi]^2 + w. \\label{dienerh}\\end{aligned}\\ ] ] by exploiting this functional , diener derives the inequality @xmath319 { | { \\psi_0 } \\rangle } \\leq { \\langle { \\psi'_0 } | } h[v,\\mathbf{a } ] { | { \\psi'_0 } \\rangle } - \\frac{1}{2 } ( \\rho_0 | \\delta a^2),\\ ] ] in lieu of the usual strict rayleigh  ritz inequality underlying the hk proof as given in  eq .  .",
    "when @xmath320 is the ground state of potentials that differ by more than a gauge , @xmath321 , the above non - strict inequality is ( without further ado ) taken to be strict in diener s presentation .",
    "if a strict inequality is accepted , a standard reductio ad absurdum proof is possible because the last term of eq",
    ".   cancels to yield the contradiction @xmath322 .",
    "we now consider two technical problems not addressed by diener .",
    "the first is that the expectation value being minimized in @xmath323 is not bounded from below for densities that vanish at some point .",
    "although unusual , such ground - state densities can arise for small molecules in strong magnetic fields .",
    "consider a wave function @xmath324 giving rise to a density @xmath177 that vanishes at some point in space @xmath325 .",
    "let us also introduce spherical coordinates @xmath326 about @xmath325 .",
    "then , for the wave functions @xmath327 with integer @xmath328 , we see that @xmath329 and @xmath324 give rise to the same density @xmath177 but to different paramagnetic current densities related by @xmath330 where @xmath331 is the unit vector in the direction specified by @xmath332 . as a result , @xmath333 = \\mathbf{a}_{\\text{eff}}[\\mathbf{j } , \\phi_0 ] - \\frac{m \\hat{\\boldsymbol{\\phi}}}{r \\sin(\\theta ) } = \\mathbf{a}_0 - \\frac{m \\hat{\\boldsymbol{\\phi}}}{r \\sin(\\theta)}.\\ ] ] calculating the expectation value of the effective hamiltonian in eq .  , some terms arising from @xmath334 cancel terms arising from @xmath335 , leaving @xmath336 for physical currents @xmath252 with a nonzero last integral , for example a circular current , the expectation value can be decreased without bound , demonstrating that @xmath337 $ ] is not well defined on the full domain @xmath19 .",
    "the second technical problem in the derivation of the inequality in eq .",
    "concerns the strategy of choosing a prescribed @xmath314 such that the effective vector potential equals the external vector potential .",
    "this amounts to a self - consistency condition [ eq .  ( 11 ) of ref .",
    "] , @xmath338 = \\mathbf{j}_{\\text{p};\\psi[v,\\mathbf{a } ] } + \\rho_0 \\mathbf{a},\\ ] ] where @xmath339 minimizes @xmath340 { | { \\phi_{\\text{d } } } \\rangle}$ ] and @xmath341 $ ] is the ground state of the external potentials giving rise to @xmath283 .",
    "diener s derivation of the inequality in eq .",
    "hinges on the ability to reproduce the paramagnetic current density from a ground state @xmath341 $ ] of @xmath286 $ ] by a minimizing wave function in @xmath342 $ ] . however , it is unclear whether this is always possible .      in lieu of a rigorous proof for an hk - type theorem for physical currents ,",
    "it is possible to proceed by conjecturing such a result and exploring its consequences . additionally , an important point is that a mapping from ground state densities to potentials may not be required for a formulation of cdft , provided that the theory can be constructed by some other means such as a constrained search or legendre  fenchel transformation formalism .",
    "we shall here explore such issues in the framework introduced by pan and sahni  @xcite in more detail .    a complication due to the choice of the physical current as",
    "a basic variable is that constraints of the type `` @xmath343 '' require explicit reference to a vector potential , because the physical current is not determined by the wave function alone .",
    "care must therefore be exercised when developing a constrained - search formalism for physical currents .    for each magnetic field under consideration",
    ", we fix a gauge .",
    "hence , we choose a mapping @xmath344(\\mathbf{r})\\ ] ] from magnetic fields to magnetic vector potentials , and also fix the constant shift of scalar potentials in some way . from the conjecture",
    "that a ground state density @xmath243 uniquely determines a gauge class of potentials @xmath345 , we may now write mappings @xmath346)\\ ] ] hence , we may write the scalar potential , the external magnetic field and its vector potential as functionals @xmath347 $ ] , @xmath348 $ ] , and @xmath349 $ ] of the physical densities ; these are representatives of the equivalence class @xmath345",
    ".    given potentials @xmath37 , we may determine the corresponding ground state @xmath350 and physical ground - state densities @xmath351 , and express the energy as @xmath352 = { \\langle { \\psi_0 } | } \\tfrac{1}{2 } p^2 + w { | { \\psi_0 } \\rangle } + ( \\rho|v-\\tfrac{1}{2 } a^2 ) + ( \\mathbf{j}|\\mathbf{a } ) .",
    "\\end{split}\\ ] ] using the mapping from densities to potentials , a universal density functional could in principle internally reconstruct the ground state potentials , and obtain the intrinsic energy via @xmath353 & = e\\left[w[\\rho,\\mathbf{j}],\\mathbf{a}[\\mathbf{b}[\\rho,\\mathbf{j}]]\\right ] - ( \\rho\\,|\\,w[\\rho,\\mathbf{j}]-\\tfrac{1}{2 } a[\\mathbf{b}[\\rho,\\mathbf{j}]]^2 ) \\\\       & \\ \\   - ( \\mathbf{j}\\,|\\,\\mathbf{a}[\\mathbf{b}[\\rho,\\mathbf{j } ] ] ) .",
    "\\end{split}\\ ] ] furthermore , we may define a non - universal constrained - search functional that depends explicitly on the external vector potential , @xmath354 & = \\inf_{\\gamma\\mapsto(\\rho,\\mathbf{j}-\\rho\\mathbf{a } ) } { \\mathrm{tr}({\\gamma ( \\tfrac{1}{2 } p^2 + w ) } ) }   \\\\      &   = f_{\\text{vr}}[\\rho,\\mathbf{j}-\\rho\\mathbf{a } ] ,   \\end{split}\\ ] ] where we note that @xmath355 . in principle , given the conjectured one - to - one mapping between potentials and physical densities , a functional of physical densities may internally reconstruct the corresponding potentials .",
    "this observation is relied on in the definition of @xmath356 and it is tempting to consider also a universal constrained - search functional that exploits this idea , @xmath357 & = \\inf_{\\gamma\\mapsto(\\rho,\\mathbf{j}-\\rho\\mathbf{a}[\\mathbf{b}[\\rho,\\mathbf{j } ] ] ) } { \\mathrm{tr}({\\gamma ( \\tfrac{1}{2 } p^2 + w ) } ) }   \\\\      &   = f_{\\text{vr}}[\\rho,\\mathbf{j}-\\rho\\mathbf{a}[\\mathbf{b}[\\rho,\\mathbf{j } ] ] ] .",
    "\\end{split}\\ ] ]    consider now the reformulation of the minimization in eq .   as a nested minimization over physical densities and wave functions .",
    "@xmath358 & = \\inf_{\\rho',\\mathbf{j } ' } \\big [ \\overbrace{\\inf_{\\gamma\\mapsto\\rho',\\mathbf{j}'-\\rho'\\mathbf{a } } { \\mathrm{tr}({\\gamma ( \\tfrac{1}{2 } p^2 + w)})}}^{f^{\\text{cs1}}_{\\text{ps}}[\\rho',\\mathbf{j}',\\mathbf{a } ] } \\\\     & \\ \\ + ( \\rho'|v-\\tfrac{1}{2 } a^2 ) + ( \\mathbf{j}'|\\mathbf{a } )   \\big ]     \\end{split}\\ ] ] a constrained - search - like expression is thus possible , but the functional that arises from the nested minimization is the non - universal functional @xmath359 .",
    "a minimization over the universal functional @xmath360 is here not equivalent , @xmath361 & \\neq \\inf_{\\rho',\\mathbf{j } ' }   \\big [ \\overbrace { \\inf_{\\gamma\\mapsto\\rho',\\mathbf{j}'-\\rho'\\mathbf{a}[\\mathbf{b}[\\rho',\\mathbf{j } ' ] ] } { \\mathrm{tr}({\\gamma ( \\tfrac{1}{2 } p^2 + w)})}}^{f^{\\text{cs2}}_{\\text{ps}}[\\rho',\\mathbf{j } ' ] } \\\\       & \\ \\ + ( \\rho'|v-\\tfrac{1}{2 } a^2 ) + ( \\mathbf{j}'|\\mathbf{a } )   \\big ] .",
    "\\end{split}\\ ] ] to establish the non - equality , consider the introduction of a new scalar potential @xmath362 . written in terms of @xmath363 , the right - hand side of eq .   has the form of a legendre  fenchel transformation and consequently a functional of @xmath364 that is concave by construction .",
    "however , writing the harmonic oscillator energy of sec .",
    "[ sec : restoreconc ] in terms of this scalar potential , we see that the resulting energy functional is not concave in @xmath364 ( it is in fact only concave in scalar potentials @xmath365 for @xmath366 ) .",
    "hence this non - concave energy functional can not equal the concave functional defined in terms of @xmath360 . in previous work",
    "( see , e.g. , eqs .",
    "( 24)(28 ) of ref .",
    "@xcite ) , these two non - equivalent functionals were conflated .",
    "the constrained - search approach to cdft with the physical current as a basic variable is substantially complicated by the fact that a wave function does not determine the physical current .",
    "it does not appear possible to construct a functional that is both universal and admits a straightforward variation principle .",
    "moreover , unlike the situation when @xmath237 is a basic variable , a simple redefinition of the scalar potential does not simultaneously yield a concave energy functional and linear pairing between potentials and physical densities .",
    "an avenue for further study could be to consider the properties of a universal intrinsic energy functional of the physical densities .",
    "such a functional can not be convex in the pair @xmath243 as a whole , but could possibly be convex in @xmath17 ( for a fixed @xmath252 ) and concave in @xmath252 ( for a fixed @xmath17 ) , which would enable at least partial legendre  fenchel transformations .",
    "in this work we have compared formulations of cdft based on different choices of basic variables .",
    "while the usual formulation in terms of @xmath367 and @xmath37 does not lead to a one - to - one mapping between potentials and densities , it allows for the construction of a useful density functional theory via a constrained search approach .",
    "a drawback with this choice of basic variables is that @xmath76 $ ] is not concave , making a full legendre  fenchel transform treatment infeasible .",
    "however , as shown here , concavity can be restored by considering the conjugate variables @xmath368 and @xmath111 , where @xmath369 .",
    "this allows the application of convex analysis in analogy with lieb s formulation of standard dft  @xcite .",
    "such a formulation is particularly natural in the context of the study of adiabatic connections for cdft functional construction , which can be done in a manner similar to that undertaken for standard dft  @xcite .",
    "the information garnered from such analysis would be suitable for comparison with kohn ",
    "sham implementations of cdft based on functionals of @xmath38 .",
    "alternative cdft formulations based on the physical densities @xmath243 have also been critically examined .",
    "pan and sahni s  @xcite recent attempt to formulate such a theory is found to be unsatisfactory .",
    "both their attempt to prove the existence of a one - to - one mapping between potentials and densities and their constrained - search formulation were found to be flawed .",
    "an earlier attempt to formulate a cdft in terms of the physical current by diener  @xcite has also been examined , and technical difficulties with this approach have been highlighted . despite the appealing physical motivation behind this choice of basic variables , we thus find that a formal justification for such a framework is currently lacking .",
    "furthermore , while it remains open whether or not an analogue of the hohenberg ",
    "kohn theorem holds for the physical current , other aspects of standard dft such as the variation principle , the constrained - search formalism , and formulations in terms of legendre  fenchel transformations do not straightforwardly carry over to this type of cdft .",
    "we conclude that the most common formulation in terms of @xmath367 is presently the most convenient and viable formulation of cdft .",
    "let @xmath31 be a normed vector space and @xmath121 its dual  that is , the the linear space of all continuous linear functionals on @xmath31 .",
    "a function @xmath370 is said to be convex if it satisfies the relation @xmath371 for all @xmath372 .",
    "the effective domain , @xmath373 , is the set of @xmath374 for which @xmath375 .",
    "a function @xmath376 is lower semi - continuous at @xmath377 if , for any @xmath378 , there exists @xmath379 such that @xmath380 whenever @xmath381 ; @xmath376 is lower semi - continuous if it is lower semi - continuous at all @xmath374 .",
    "a lower semi - continuous convex function @xmath370 may be represented by its conjugate @xmath382 in the manner @xmath383 , \\\\",
    "f(x ) & = \\sup_{y \\in x^\\ast } [ ( x | y ) - f^\\ast(y)],\\end{aligned}\\ ] ] where @xmath384 is also lower semi - continuous and convex .",
    "the dual function @xmath385 is said to be a subgradient of @xmath376 at @xmath386 if it satisfies the inequality @xmath387 the set of all subgradients of @xmath376 at @xmath377 is called the subdifferential @xmath388 and is a ( possibly empty ) convex subset of @xmath121 .",
    "subgradients and subdifferentials of @xmath384 are defined in an analogous manner .",
    "the function @xmath376 and its conjugate satisfy fenchel s inequality @xmath389 , which is sharpened into the equality @xmath390 whenever the equivalent reciprocal relations @xmath391 are satisfied .",
    "a function @xmath392 is said to be concave if @xmath393 is convex .",
    "its conjugate is defined in the same manner as for convex functions but with @xmath394 replaced by @xmath395 ; likewise , subgradients and subdifferentials are defined as for a convex function but with the inequality sign reversed in eq .  .",
    "this work was supported by the norwegian research council through the coe centre for theoretical and computational chemistry ( ctcc ) grant no .",
    "179568/v30 and the grant no .",
    "171185/v30 and through the european research council under the european union seventh framework program through the advanced grant abacus , erc grant agreement no . 267683 .",
    "a. m. t. is also grateful for support from the royal society university research fellowship scheme .",
    "52ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/physrev.136.b864 [ * * , ( ) ] link:\\doibase 10.1073/pnas.76.12.6062 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.560240302 [ * * ,   ( ) ] @noop _",
    "_ ,  ed .",
    "( ,  ) link:\\doibase 10.1016/j.theochem.2006.05.012 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.73.012513 [ * * , ( ) ] link:\\doibase 10.1088/0305 - 4608/4/8/013 [ * * ,   ( ) ] link:\\doibase 10.1016/0038 - 1098(75)90618 - 3 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.13.4274 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.15.6006.3 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.15.2884 [ * * , ( ) ] link:\\doibase 10.1063/1.478234 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1535422 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3082285 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3380834 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3488100 [ * * ,   ( ) ] link:\\doibase    10.1063/1.3660357 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.50.3089 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.69.035113 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.80.032510 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.22862 [ * * , ( ) ] link:\\doibase 10.1016/j.jpcs.2011.12.023 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.85.052502 [ * * , ( ) ] link:\\doibase 10.1103/physreva.86.042502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.59.2360 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.37.10685 [ * * , ( ) ] link:\\doibase 10.1103/physreva.54.1328 [ * * , ( ) ] link:\\doibase 10.1103/physreva.53.r5 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.59.209 [ * * , ( ) ] link:\\doibase    10.1103/physreva.74.062511 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.77.245106 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.98.036403 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physreva.38.1149 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.65.113106 [ * * ,   ( ) ] link:\\doibase",
    "10.1088/0953 - 8984/3/47/014 [ * * ,   ( ) ] @noop _ _",
    "( ,  ) link:\\doibase 10.1063/1.464304 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.59.51 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.62.012502 [ * * ,   ( ) ] link:\\doibase 10.1021/ct8005248 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2749510 [ * * , ( ) ] link:\\doibase 10.1103/physreva.80.022517 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.78.1872 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> the selection of basic variables in current - density functional theory and formal properties of the resulting formulations are critically examined . </S>",
    "<S> focus is placed on the extent to which the hohenberg  </S>",
    "<S> kohn theorem , constrained - search approach and lieb s formulation ( in terms of convex and concave conjugation ) of standard density - functional theory can be generalized to provide foundations for current - density functional theory . </S>",
    "<S> for the well - known case with the gauge - dependent paramagnetic current density as a basic variable , we find that the resulting total energy functional is not concave . </S>",
    "<S> it is shown that a simple redefinition of the scalar potential restores concavity and enables the application of convex analysis and convex / concave conjugation . as a result , </S>",
    "<S> the solution sets arising in potential - optimization problems can be given a simple characterization . </S>",
    "<S> we also review attempts to establish theories with the physical current density as a basic variable . despite the appealing physical motivation behind this choice of basic variables , we find that the mathematical foundations of the theories proposed to date are unsatisfactory . </S>",
    "<S> moreover , the analogy to standard density - functional theory is substantially weaker as neither the constrained - search approach nor the convex analysis framework carry over to a theory making use of the physical current density . </S>"
  ]
}