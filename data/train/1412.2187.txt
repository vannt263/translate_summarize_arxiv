{
  "article_text": [
    "reciprocity evaluates the tendency of vertex pairs to form mutual connections between each other and is an important object to study in complex networks , such as email networks , see e.g. newman et al .",
    "@xcite , world wide web , see e.g. albert et al .",
    "@xcite , world trade web , see e.g. gleditsch @xcite , social networks , see e.g. wasserman and faust @xcite , and cellular networks , see e.g. jeong et al . @xcite . in networks that aggregate temporal information",
    ", reciprocity provides a measure of the simplest feed - back process occurring on the network , i.e. , the tendency of one stimulus , a vertex , to respond to another stimulus , another vertex .",
    "reciprocity is important because most complex networks are directed and it is the main quantity characterizing feasible dyadic patterns , namely possible types of connections between two nodes .",
    "one example is the email network . just because user b s email address appears in user a s address book",
    "does not necessarily mean that the reverse is also true , although it often is , see e.g. newman et al .",
    "another example is the social network .",
    "reciprocity captures a basic way in which different forms of interaction take place on a social network like twitter .",
    "when two users a and b interact as peers , one expects that messages will be exchanged between them in both directions .",
    "however , if user a sends messages to user b , who is a celebrity or news source , it is likely that user b will not send messages in return , see e.g. cheng et al .",
    "therefore , it is not enough to just understand the _ edge density _ of a directed network , the _ reciprocal density _ needs to be studied as well . in garlaschelli and loffredo @xcite",
    ", it was discovered that detecting nontrivial patterns of reciprocity can reveal mechanisms and organizing principles that help explain the topology of the observed network .",
    "they also proposed a measure of reciprocity and studied how strong it is for different complex networks , and found that reciprocity is strongest in the world trade web .",
    "people often treat complex networks as undirected for simplicity , and reciprocity can help quantify the information loss induced by projecting a directed network into an undirected one . using the knowledge of reciprocity , significant directed information can be retrieved from an undirected projection , and the error introduced when a directed network is treated as undirected may be estimated , see e.g. garlaschelli and loffredo @xcite .",
    "directed networks consisting of @xmath0 nodes can be modeled by directed graphs on @xmath0 vertices , where a graph is represented by a matrix @xmath1 with each @xmath2 . here ,",
    "@xmath3 means there is a directed edge from vertex @xmath4 to vertex @xmath5 ; otherwise , @xmath6 .",
    "we assume that @xmath7 so that there are no self - loops .",
    "give the set of such graphs the probability @xmath8,\\ ] ] where @xmath9 @xmath10 and @xmath11 are parameters , and @xmath12 is the appropriate normalization . note that @xmath13 and @xmath14 , defined in  , respectively represent the directed _ edge density _ and the _ reciprocal density_.    in the literature , @xmath15 and @xmath16 are sometimes referred to as the _ single edge _ and the _",
    "reciprocal edge_. this belongs to the class of exponential random graph models called @xmath17 models of holland and leinhardt @xcite .",
    "further extensions include @xmath18 models , see e.g. lazega and van duijn @xcite and van duijn et al .",
    "more general types of exponential models have also been introduced and studied .",
    "see besag @xcite , newman @xcite , rinaldo et al .",
    "@xcite , robins et al .",
    "@xcite , snijders et al .",
    "@xcite , wasserman and faust @xcite , and fienberg @xcite for history and a review of developments .",
    "the exponential random graph models have popular counterparts in statistical physics : a hierarchy of models ranging from the _ grand canonical ensemble _ , the _ canonical ensemble _ , to the _ microcanonical ensemble _ , with particle density and energy density in place of @xmath13 and @xmath14 , and temperature and chemical potential in place of @xmath10 and @xmath11 . in the grand canonical ensemble",
    ", the reciprocal model ( [ 1 ] ) in this case , no prior knowledge of the graph is assumed . in the canonical ensemble ,",
    "partial information of the graph is given .",
    "for instance , the edge density of the graph is close to @xmath19 or the reciprocal density is close to @xmath20 . in the microcanonical ensemble , complete",
    "information of the graph is observed beforehand , say in the reciprocal model , both the edge density and the reciprocal density are specified .",
    "it is well - known that models in this hierarchy have a very simple relationship involving legendre transforms and , more importantly , the _ free energy density _ ( of the grand canonical ensemble ) , the _ conditional free energy density _ ( of the canonical ensemble ) , and the _ entropy density _ ( of the microcanonical ensemble ) encode important information of a random graph drawn from the model .",
    "see illustration below . as one goes down the hierarchy ,",
    "the model is understood from varying perspectives : the free energy and conditional free energy densities characterize the macroscopic and mesoscopic configurations of the system respectively , while the entropy density describes the degree to which the probability of the system is spread out over different possible microstates .",
    "various objects of interest are obtained by differentiating these densities with respect to appropriate parameters and phases are determined by analyzing the singularities of the derivatives . in particular , they serve as a measure of how close the system is to equilibrium , namely perfect internal disorder , and their monotonicity sheds light on the relative likelihood of each configuration following the philosophy that the higher the entropy the greater the disorder . since real - world networks",
    "are often very large in size , the infinite - size asymptotics of these quantities have received exponentially growing attention in recent years . see e.g. aristoff and zhu @xcite , chatterjee and dembo @xcite , chatterjee and diaconis @xcite , kenyon et al .",
    "@xcite , kenyon and yin @xcite , lubetzky and zhao @xcite , radin and sadun @xcite , radin et al .",
    "@xcite , radin and yin @xcite , yin @xcite , yin et al .",
    "@xcite , and zhu @xcite .",
    "it may be worth pointing out that most of these papers utilize the theory of graph limits as developed by lovsz and coworkers @xcite .    .1truein",
    "the hierarchy @xmath21    .1truein    the rest of this paper is organized as follows . in section [ microcanonical ] we derive the exact expression for the normalization constant ( partition function ) of the reciprocal model ( the grand canonical ensemble ) and analyze the asymptotic features of its associated microcanonical ensemble .",
    "our main results are : an exact expression for the limiting entropy density ( theorem [ exact ] ) and some discussion on its monotonicity ( remark [ mono1 ] ) . in section [ canonical ] we investigate the asymptotic features of two canonical ensembles associated with the reciprocal model , one conditional on the edge density and the other conditional on the reciprocal density .",
    "our main results are : exact expressions for the two limiting conditional free energy densities ( theorem [ exact2 ] ) and some discussion on their monotonicity ( remark [ mono23 ] ) . in section [ grand ]",
    "we take another look at the reciprocal model and examine its asymptotic features .",
    "our main results are : a joint central limit theorem describing convergence of the edge density and the reciprocal density ( proposition [ clt ] ) , exact scalings for the limiting normalization constant ( theorem [ scaling ] ) and the mean of the limiting probability distribution in the sparse regime ( proposition [ sparsemean ] ) .",
    "lastly , in section [ discussion ] we extend our analysis to more general reciprocal models whose sufficient statistics , besides single edge and reciprocal edge , also include reciprocal @xmath22-star and reciprocal triangle .",
    "large deviations techniques are used throughout this paper .",
    "we refer the readers to the works of chatterjee and diaconis @xcite and chatterjee and varadhan @xcite for more details of this framework .",
    "after extracting the exponential factor in the reciprocal model ( [ 1 ] ) , each possible configuration of the directed graph is weighted equally .",
    "this amounts to taking @xmath23 as iid bernoulli random variables having values @xmath24 and @xmath25 each with probability @xmath19 . denote the associated probability measure and the associated expectation by @xmath26 and @xmath27 respectively .",
    "define @xmath28 and @xmath29 by letting @xmath30 go to zero , we are interested in the limit @xmath31 the quantity in will be called the _ limiting entropy density_. via the theory of large deviations , it is directly connected to the _ limiting free energy density _",
    "@xmath32    [ lyapunov ]",
    "@xmath33    recall that by assumption , @xmath34 .",
    "thus @xmath35 @xmath36 this implies that @xmath37 \\\\ & = 2^{n(n-1)}\\mathbb{e}_n\\left[e^{\\beta_{1}\\sum_{1\\leq i < j\\leq n}(x_{ij}+x_{ji } ) + 2\\beta_{2}\\sum_{1\\leq i < j\\leq n}x_{ij}x_{ji}}\\right ] \\nonumber \\\\ & = 2^{n(n-1)}\\prod_{1\\leq i",
    "< j\\leq n}\\mathbb{e}_n\\left[e^{\\beta_{1}(x_{ij}+x_{ji } ) + 2\\beta_{2}x_{ij}x_{ji}}\\right ] \\nonumber \\\\ & = \\left(1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}\\right)^{\\binom{n}{2}}. \\nonumber\\end{aligned}\\ ] ] hence we draw the conclusion .    [ cor ] @xmath38    from the proof of theorem [ lyapunov ] , @xmath39 \\\\=\\frac{1}{2}\\log\\left(\\frac{1}{4}+\\frac{1}{2}e^{\\beta_{1}}+\\frac{1}{4}e^{2\\beta_{1}+2\\beta_{2}}\\right),\\end{gathered}\\ ] ] which up to a constant is essentially ( [ chi ] ) , and is finite for any @xmath40 and differentiable in both @xmath41 and @xmath42 .",
    "the result then follows from grtner - ellis theorem in large deviations theory , see e.g. dembo and zeitouni @xcite , which states that the entropy @xmath43 may be obtained as the legendre transform of the free energy @xmath44 .",
    "\\(i ) note that @xmath45 and + @xmath46 , which implies that @xmath47 if @xmath48 $ ] or @xmath49 $ ] .",
    "\\(ii ) note that @xmath50 , which implies that @xmath47 if @xmath51 .",
    "\\(iii ) note that @xmath52 which implies that @xmath47 if @xmath53 .",
    "[ exact ] for @xmath54 $ ] , @xmath55 and @xmath56 , @xmath57 and otherwise @xmath47 .    under the assumption that @xmath58 $ ] , it is easy to see that the supremum in ( [ sup ] ) can not be obtained at @xmath59 , and @xmath43 must attain its extremum at finite @xmath60 . at optimality ,",
    "@xmath61 dividing by , we get @xmath62 substitute this back into , @xmath63 which implies that @xmath64 the conclusion thus follows .",
    "it is straightforward to compute that @xmath65 this is consistent with the law of large numbers and the maximal entropy principle .    along the erds - rnyi curve @xmath66 , @xmath67 , @xmath68",
    "this is the entropy of a bernoulli random variable and is minus the rate function of the large deviations for the edge density .",
    "obtained from theorem [ exact ] . on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono1 ] . in region @xmath69 , @xmath70 is decreasing in both @xmath71 and @xmath29 ; in region @xmath72 , @xmath70 is increasing in @xmath71 and decreasing in @xmath29 ; in region @xmath73 , @xmath70 is increasing in both @xmath71 and @xmath29 ; in region @xmath74 , @xmath70 is decreasing in @xmath71 and increasing in @xmath29 .",
    "the boundaries are given by @xmath75 and @xmath66.,width=228,height=171 ]     obtained from theorem [ exact ] .",
    "on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono1 ] . in region @xmath69",
    ", @xmath70 is decreasing in both @xmath71 and @xmath29 ; in region @xmath72 , @xmath70 is increasing in @xmath71 and decreasing in @xmath29 ; in region @xmath73 , @xmath70 is increasing in both @xmath71 and @xmath29 ; in region @xmath74 , @xmath70 is decreasing in @xmath71 and increasing in @xmath29 . the boundaries",
    "are given by @xmath75 and @xmath66.,width=228,height=171 ]    [ mono1 ] let us analyze the monotonicity of the limiting entropy density .",
    "on one hand , @xmath76 which implies that @xmath77 if and only if @xmath78 , which is equivalent to @xmath79 . on the other hand , @xmath80 which implies that @xmath81 if and only if @xmath82 , which is equivalent to @xmath83 , i.e. , @xmath43 is increasing in @xmath29 below the erds - rnyi curve and decreasing in @xmath29 above the erds - rnyi curve .",
    "( see @xcite for a similar phenomenon across the erds - rnyi curve in the ( undirected ) edge - triangle model . )",
    "as in aristoff and zhu @xcite , kenyon and yin @xcite and zhu @xcite , we are interested in the asymptotic features of constrained models .",
    "the probability measure is given by @xmath84 1_{|e(x)-\\epsilon|<\\delta}\\ ] ] if conditional on the edge density , and by @xmath85 1_{|r(x)-r|<\\delta}\\ ] ] if conditional on the reciprocal density , where @xmath86 , \\\\ & \\psi_{n,\\delta}(\\beta_{1},r ) = \\frac{1}{n^{2}}\\log \\mathbb e_n\\left [ \\exp\\left(n^2\\beta_{1}e(x)\\right)1_{|r(x)-r|<\\delta}\\right ] .",
    "\\nonumber\\end{aligned}\\ ] ] we shrink the interval around @xmath71 ( or @xmath29 ) by letting @xmath30 go to zero : @xmath87 the quantities in ( [ conditional ] ) will be called the _ limiting conditional free energy densities_.    [ exact2 ] for any @xmath88 , @xmath67 , @xmath89 where @xmath90 for any @xmath91 , @xmath92 , @xmath93    by using varadhan s lemma , see e.g. dembo and zeitouni @xcite , @xmath94 by , the optimal @xmath29 in satisfies @xmath95 which is equivalent to @xmath96 when @xmath97 , has one solution @xmath98 . when @xmath99 , since @xmath100 has two solutions @xmath101 when @xmath102 , one solution of is positive and the other is negative .",
    "we check that @xmath103 and @xmath104 and thus the optimal @xmath105 . when @xmath106 , both solutions of are positive .",
    "we check that @xmath107 and @xmath108 and thus the optimal @xmath105 .",
    "this is indeed the optimizer following the mean value theorem , since @xmath109 and + @xmath110 . by , the optimal @xmath71 in satisfies @xmath111 which has one solution @xmath112",
    "this is indeed the optimizer following the mean value theorem , since @xmath113 and @xmath114 .",
    "obtained from theorem [ exact2 ] . on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono23 ] .",
    "@xmath115 is always increasing in @xmath42 . in region @xmath73",
    ", @xmath115 is increasing in @xmath71 ; in region @xmath74 , @xmath115 is decreasing in @xmath71 . the boundary is specified in remark [ mono23].,width=228,height=171 ]     obtained from theorem [ exact2 ] . on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono23 ] .",
    "@xmath115 is always increasing in @xmath42 . in region @xmath73",
    ", @xmath115 is increasing in @xmath71 ; in region @xmath74 , @xmath115 is decreasing in @xmath71 . the boundary is specified in remark [ mono23].,width=228,height=171 ]    [ mono23 ] let us analyze the monotonicity of the two limiting conditional free energy densities .",
    "we have @xmath116\\frac{\\partial r^*}{\\partial \\beta_2}=r^ * , \\\\ \\frac{\\partial\\psi(\\beta_{1},r)}{\\partial\\beta_{1}}=\\epsilon^{\\ast}+\\left[\\beta_1+\\frac{\\partial \\lambda(\\epsilon^*,r)}{\\partial \\epsilon^*}\\right]\\frac{\\partial \\epsilon^*}{\\partial \\beta_1}=\\epsilon^*. \\nonumber\\end{aligned}\\ ] ] therefore @xmath117 and @xmath118 are increasing in @xmath42 and @xmath41 respectively .",
    "moreover , we have @xmath119\\frac{\\partial r^{\\ast}}{\\partial\\epsilon } + \\frac{\\partial\\lambda(\\epsilon , r^{\\ast})}{\\partial\\epsilon } \\\\ & = -\\log\\left(\\frac{\\epsilon - r^{\\ast}}{1+r^{\\ast}-2\\epsilon}\\right ) .",
    "\\nonumber\\end{aligned}\\ ] ] therefore @xmath117 is increasing in @xmath71 if and only if @xmath120 .",
    "this is equivalent to @xmath121 when @xmath122 ; while for @xmath123 , this is equivalent to @xmath124 which can be simplified to @xmath125 and can be further simplified to @xmath126 or alternatively @xmath127 similarly , @xmath128\\frac{\\partial\\epsilon^{\\ast}}{\\partial r } + \\frac{\\partial\\lambda(\\epsilon^{\\ast},r)}{\\partial r } \\\\ & = -\\frac{1}{2}\\log\\left(\\frac{r(1+r-2\\epsilon^{\\ast})}{(\\epsilon^{\\ast}-r)^{2}}\\right ) .",
    "\\nonumber\\end{aligned}\\ ] ] therefore @xmath118 is increasing in @xmath29 if and only if @xmath129 .",
    "this is equivalent to @xmath130 or alternatively @xmath131     obtained from theorem [ exact2 ] .",
    "on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono23 ] .",
    "@xmath132 is always increasing in @xmath41 . in region @xmath72",
    ", @xmath132 is decreasing in @xmath29 ; in region @xmath73 , @xmath132 is increasing in @xmath29 . the boundary is specified in remark [ mono23].,width=228,height=171 ]     obtained from theorem [ exact2 ] . on the right hand side , we specify the regions of monotonicity as obtained in remark [ mono23 ] .",
    "@xmath132 is always increasing in @xmath41 . in region @xmath72",
    ", @xmath132 is decreasing in @xmath29 ; in region @xmath73 , @xmath132 is increasing in @xmath29 . the boundary is specified in remark [ mono23].,width=228,height=171 ]",
    "a crucial observation on the reciprocal model is that the probability measure ( [ 1 ] ) may be alternatively written as @xmath133 and is equivalent to an erds - rnyi type measure which assigns the following joint distribution iid for every pair @xmath134 with @xmath135 : @xmath136 this tractable feature of the model has been partially used in earlier sections of the paper where we study the microcanonical and canonical ensembles . in this section",
    "we will explore further the consequences of the iid structure on the grand canonical ensemble .",
    "as seen in corollary [ cor ] , the entropy @xmath43 and the free energy @xmath44 are related by the legendre transform .",
    "an explicit connection between @xmath137 and @xmath138 is given in theorem [ exact ] ( see ( [ eqni ] ) and ( [ eqnii ] ) ) .",
    "the next proposition , which easily follows from ( [ alt ] ) and ( [ observe ] ) , calculates the mean of the edge and reciprocal densities when the parameters are fixed .",
    "[ mean ] for any @xmath139 , @xmath140 @xmath141    in the reciprocal model , the number of directed edges from a given vertex is binomial with parameter given by ( [ binom1 ] ) and the number of reciprocal edges from a given vertex is binomial with parameter given by ( [ binom2 ] ) .",
    "this leads to a host of results in large deviations theory .",
    "for example , @xmath142 where the rate function @xmath143\\right\\}\\\\ & = \\epsilon\\log \\frac{\\epsilon}{e^{\\beta_1}+e^{2\\beta_1 + 2\\beta_2}}+(1-\\epsilon)\\log \\frac{1-\\epsilon}{1+e^{\\beta_1}}+\\log \\left(1 + 2e^{\\beta_1}+e^{2\\beta_1 + 2\\beta_2}\\right ) .",
    "\\nonumber\\end{aligned}\\ ] ] note that when @xmath144 , ( [ crate ] ) reduces to the rate function under the uniform measure , @xmath145 coinciding with ( [ rate ] ) .",
    "we can further study the fluctuations of the edge and reciprocal densities around their mean , i.e. , the central limit theorem .",
    "[ clt ] under the grand canonical measure ( [ 1 ] ) , @xmath146 in distribution as @xmath147 , where @xmath148 where @xmath149    note that when @xmath150 , proposition [ clt ] gives the central limit theorem for @xmath13 and @xmath14 under the uniform measure and we have @xmath151    the drift term @xmath152 in proposition [ clt ] is due to the definition of @xmath13 and @xmath14 in .",
    "if one defines @xmath13 and @xmath14 as @xmath153 instead , then proposition [ clt ] will hold with minor modifications : @xmath154 though definitions ( [ es ] ) and lead to a difference of the drift term in the central limit theorem , they are indistinguishable as regards the limiting entropy and free energy densities .    for any @xmath155 , @xmath156 \\\\ & = \\frac{\\mathbb{e}_n\\left[e^{n^2\\left((\\frac{\\theta_{1}}{n}+\\beta_{1})e(x)+(\\frac{\\theta_{2}}{n}+\\beta_{2})r(x)\\right)}\\right ] e^{-\\frac{e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } \\theta_{1}n -\\frac{e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\theta_{2}n } } { \\mathbb{e}_n\\left[e^{n^2\\left(\\beta_1e(x)+\\beta_2r(x)\\right)}\\right ] } \\nonumber \\\\ & = \\frac{\\left(1 + 2e^{\\frac{\\theta_{1}}{n}+\\beta_{1}}+e^{\\frac{2\\theta_{1}}{n}+\\frac{2\\theta_{2}}{n}+2\\beta_{1}+2\\beta_{2}}\\right)^{\\frac{n(n-1)}{2 } } e^{-\\frac{e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } \\theta_{1}n -\\frac{e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\theta_{2}n } } { \\left(1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}\\right)^{\\frac{n(n-1)}{2 } } } \\nonumber \\\\ & = \\left(1+\\frac{a}{n}+\\frac{b}{n^{2}}+o(n^{-3})\\right)^{\\frac{n(n-1)}{2 } } e^{-\\frac{e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } \\theta_{1}n -\\frac{e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\theta_{2}n } , \\nonumber\\end{aligned}\\ ] ] where @xmath157 since @xmath158 we have @xmath159 this implies that @xmath156 \\\\ & \\rightarrow\\exp\\bigg\\{-\\frac{e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } \\theta_{1 } -\\frac{e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\theta_{2 } \\nonumber \\\\ & \\qquad\\qquad + \\frac{1}{2}\\left(\\frac{e^{\\beta_{1}}+2e^{2\\beta_{1}+2\\beta_{2 } } } { 1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } -2\\left(\\frac{e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\right)^{2}\\right)\\theta_{1}^{2 } \\nonumber \\\\ & \\qquad\\qquad + \\left(\\frac{2e^{2\\beta_{1}+2\\beta_{2 } } } { 1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } -\\frac{2e^{2\\beta_{1}+2\\beta_{2}}(e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}})}{\\left(1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}\\right)^{2}}\\right)\\theta_{1}\\theta_{2 } \\nonumber \\\\ & \\qquad\\qquad + \\frac{1}{2}\\left(\\frac{2e^{2\\beta_{1}+2\\beta_{2 } } } { 1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2 } } } -2\\left(\\frac{e^{2\\beta_{1}+2\\beta_{2}}}{1 + 2e^{\\beta_{1}}+e^{2\\beta_{1}+2\\beta_{2}}}\\right)^{2}\\right)\\theta_{2}^{2 } \\bigg\\ } \\nonumber\\end{aligned}\\ ] ] as @xmath147 .",
    "since convergence of moment generating functions implies convergence in distribution , the proof is complete .",
    "similar to the analysis in yin and zhu @xcite , we can also study directed graphs where the parameters depend on the number of vertices .",
    "assume that @xmath160 and @xmath161 , where @xmath10 and @xmath11 are fixed , @xmath162 is positive and @xmath163 as @xmath147 . with some abuse of notation",
    ", we will still denote the associated normalization constant and probability measure by @xmath164 and @xmath165 respectively .",
    "from the proof of theorem [ lyapunov ] , @xmath166 which yields the following asymptotics for the normalization .    [ scaling ] ( i )",
    "when @xmath167 and @xmath168 , @xmath169 .",
    "\\(ii ) when @xmath167 and @xmath170 , @xmath171 .",
    "\\(iii ) when @xmath172 and @xmath173 , @xmath174 .",
    "\\(iv ) when @xmath175 and @xmath102 , @xmath176 .",
    "\\(v ) when @xmath175 and @xmath97 , @xmath177 .",
    "\\(vi ) when @xmath178 and @xmath179 , @xmath180 .",
    "\\(vii ) when @xmath178 and @xmath181 , @xmath182 .",
    "\\(viii ) when @xmath178 and @xmath183 , @xmath174 .",
    "since many networks data are sparse in the real world , we are more interested in the situation where a random graph sampled from this modified model is sparse , i.e. , the probability that there is an edge between vertex @xmath4 and vertex @xmath5 goes to @xmath25 as @xmath184 .",
    "one natural question to ask is for what set of parameters @xmath185 will this happen ? and",
    "a natural follow - up question is what is the speed of the graph towards sparsity when this indeed happens ?",
    "we give some concrete answers to these questions .",
    "[ sparsemean ] for any @xmath139 ,    \\(i ) when @xmath186 , @xmath187 .",
    "\\(ii ) when @xmath188 , @xmath189 .",
    "\\(iii ) when @xmath190 , @xmath191 .    from proposition",
    "[ mean ] , @xmath192 as @xmath184 only when @xmath167 and @xmath168 .",
    "the rest of the proof easily follows .",
    "we have studied directed graphs whose sufficient statistics are given by edge and reciprocal densities .",
    "now let us generalize these ideas and analyze directed graphs whose sufficient statistics also include densities of _ reciprocal @xmath22-stars _ and _ reciprocal triangles_. reciprocal triangles are sometimes called _",
    "cyclic triads _ in the literature , see e.g. robins et al .",
    "@xcite . they are used to model the situation where you have three vertices @xmath4 , @xmath5 and @xmath193 and there are bilateral relations between @xmath4 and @xmath5 , @xmath5 and @xmath193 , and @xmath193 and @xmath4 , i.e. , @xmath194 .",
    "similarly , reciprocal @xmath22-stars have generated significant interest as well .",
    "we define the densities of reciprocal triangles and reciprocal @xmath22-stars respectively as @xmath195 and @xmath196    as for the less complicated reciprocal model investigated earlier , we are interested in the _ limiting free energy density _ @xmath197 \\nonumber\\end{aligned}\\ ] ] for the grand canonical ensemble and the _ limiting entropy density _ @xmath198 for the microcanonical ensemble , where @xmath199 .",
    "in contrast to the reciprocal model discussed in sections [ microcanonical]-[grand ] , in this generalized model , different pairs of vertices are no longer independent , and this sophistication renders a concrete analysis of the model rather difficult .",
    "we hope the partial answers presented in this section will provide insight into its intrinsic structure and help us better understand the nature of reciprocity .",
    "previously , we derive the limiting free energy density ( [ chi ] ) and then obtain the limiting entropy density ( [ sup ] ) using the legendre transform . we take an opposite approach here .",
    "below we find an expression for the limiting entropy density ( [ microlimit ] ) and then apply the inverse legendre transform to develop an expression for the limiting free energy density ( [ macrolimit ] ) .",
    "we examine the limiting entropy density first .",
    "a key observation is that we can define @xmath200 so that @xmath201 are iid random variables with @xmath202 and @xmath203",
    ". then densities of reciprocal edges , reciprocal triangles , and reciprocal @xmath22-stars may be alternatively written as @xmath204 using chatterjee and varadhan s large deviations results for the erds - rnyi random graph , see e.g. chatterjee and varadhan @xcite , this gives @xmath205^{2}\\rightarrow[0,1],g(x , y)=g(y , x ) \\\\",
    "r(g)=r , t(g)=t , s(g)=s}}\\frac{1}{2}i_{\\frac{1}{4}}(g ) , \\nonumber\\end{aligned}\\ ] ] where @xmath206^{2}}g(x , y)dxdy , \\\\ & t(g):=\\iiint_{[0,1]^{3}}g(x , y)g(y , z)g(z , x)dxdydz , \\nonumber \\\\ & s(g):=\\int_{0}^{1}\\left(\\int_{0}^{1}g(x , y)dy\\right)^{p}dx , \\nonumber\\end{aligned}\\ ] ] and @xmath207^{2}}i_{\\frac{1}{4}}(g(x , y))dxdy$ ] , where @xmath208    another key observation is that the distribution of @xmath13 conditional on @xmath209 is the same as conditional on @xmath14 .",
    "thus , the distribution of @xmath13 conditional on @xmath210 is the same as conditional on @xmath14 .",
    "we compute @xmath211 which , combined with ( [ epsilonr ] ) , implies that @xmath212 together with , we hence conclude that @xmath213^{2}\\rightarrow[0,1],g(x , y)=g(y , x ) \\\\",
    "r(g)=r , t(g)=t , s(g)=s}}\\frac{1}{2}i_{\\frac{1}{4}}(g).\\ ] ]    next we examine the limiting free energy density ( [ macrolimit ] ) .",
    "varadhan s lemma in large deviations theory , see e.g. dembo and zeitouni @xcite , states that the free energy @xmath214 may be obtained as the inverse legendre transform of the entropy @xmath215 : @xmath216^{2}\\rightarrow[0,1],g(x , y)=g(y , x ) \\\\",
    "r(g)=r , t(g)=t , s(g)=s}}\\left\\{\\beta_{1}\\epsilon+\\beta_{2}r+\\beta_{3}t+\\beta_{4}s+\\zeta(\\epsilon , r)-\\frac{1}{2}\\left(i_{\\frac{1}{4}}(g)-2\\log 2\\right)\\right\\}. \\nonumber\\end{aligned}\\ ] ] consider the optimization problem @xmath217",
    ". note that at optimality , @xmath218 which implies that @xmath219 .",
    "therefore , we have @xmath220 and hence @xmath221^{2}\\rightarrow[0,1],g(x , y)=g(y , x ) \\\\ r(g)=r , t(g)=t , s(g)=s}}\\left\\{\\eta(\\beta_{1},r)+\\beta_{2}r+\\beta_{3}t+\\beta_{4}s-\\frac{1}{2}\\left(i_{\\frac{1}{4}}(g)-2\\log 2\\right)\\right\\ } \\nonumber \\\\ & = \\sup_{\\substack{g:[0,1]^{2}\\rightarrow[0,1 ] \\\\",
    "g(x , y)=g(y , x)}}\\left\\{\\eta(\\beta_{1},r(g))+\\beta_{2}r(g)+\\beta_{3}t(g)+\\beta_{4}s(g)-\\frac{1}{2}\\left(i_{\\frac{1}{4}}(g)-2\\log 2\\right)\\right\\}. \\nonumber\\end{aligned}\\ ] ] this is a complicated variational problem that is hard to solve in general , however we can proceed further in two special situations . as we will see , introducing reciprocal triangles and reciprocal @xmath22-stars into the probability measure significantly affects the structure of the model .",
    "unlike the limiting free energy density @xmath44 for the reciprocal model that only takes into account reciprocal edges , the limiting free energy density @xmath222 for this generalized model may lose analyticity , giving rise to phase transitions in the grand canonical ensemble .",
    "the first special situation is when @xmath175 , @xmath223^{2}\\rightarrow[0,1 ] \\\\",
    "g(x , y)=g(y , x ) } } \\left\\{\\beta_{2}r(g)+\\beta_{3}t(g)+\\beta_{4}s(g)-\\frac{1}{2}\\left(i_{\\frac{1}{4}}(g)-2\\log 2\\right)\\right\\ } \\nonumber \\\\ & = \\sup_{\\substack{g:[0,1]^{2}\\rightarrow[0,1 ] \\\\",
    "g(x , y)=g(y , x ) } } \\left\\{\\left(\\beta_{2}-\\frac{\\log 3}{2}\\right)r(g)+\\beta_{3}t(g)+\\beta_{4}s(g)-\\frac{1}{2}\\left(i_{0}(g)-\\log 3\\right)\\right\\ } , \\nonumber\\end{aligned}\\ ] ] where @xmath224^{2}}i_{0}(g(x , y))dxdy$ ] and @xmath225 .",
    "this shows that @xmath226 may be equivalently viewed as the limiting free energy density of an undirected model whose sufficient statistics are given by ( undirected ) edge , triangle , and @xmath22-star densities .",
    "the @xmath227 parameters @xmath228 allow one to adjust the influence of these different local features on the limiting probability distribution and thus expectedly should impact the global structure of a random graph drawn from the model .",
    "it is therefore important to understand if and when the supremum in ( [ formulatwo ] ) is attained and whether it is unique .",
    "many people have delved into this area .",
    "a particularly significant discovery was made by chatterjee and diaconis @xcite , who showed that the supremum in ( [ formulatwo ] ) is always attained and a random graph drawn from the model must lie close to the maximizing set with probability vanishing in @xmath0 .",
    "when @xmath229 , yin @xcite further showed that the @xmath227-parameter space would consist of a single phase with first - order phase transition(s ) across one ( or more ) surfaces , where all the first derivatives of @xmath230 exhibit ( jump ) discontinuities , and second - order phase transition(s ) along one ( or more ) critical curves , where all the second derivatives of @xmath230 diverge .",
    "the second special situation is when @xmath231 , @xmath232^{2}\\rightarrow[0,1 ] \\\\",
    "g(x , y)=g(y , x)}}\\left\\{\\eta(\\beta_{1},r(g))+\\beta_{2}r(g)+\\beta_{4}s(g)-\\frac{1}{2}\\left(i_{\\frac{1}{4}}(g)-2\\log 2\\right)\\right\\}. \\nonumber\\end{aligned}\\ ] ] we can derive the euler - lagrange equation for this variational problem , and it is given by @xmath233 where @xmath234 .",
    "solving for @xmath235 and then integrating over @xmath236 , we get @xmath237 following similar arguments as in kenyon et al .",
    "@xcite , we conclude that @xmath238 can take only finitely many values .",
    "the optimal graphon @xmath239 is multipodal and phase transitions are expected .",
    "the authors are very grateful to the anonymous referees for their invaluable suggestions that greatly improved the quality of this paper .",
    "mei yin s research was partially supported by nsf grant dms-1308333 .",
    "she appreciated the opportunity to talk about this work in the special session on spectral theory , disorder , and quantum many body physics at the 2015 ams central spring sectional meeting , organized by peter d. hislop and jeffrey schenker .",
    "lazega , e. and m. a. j. van duijn .",
    "position in formal structure , personal characteristics and choices of advisors in a law firm : a logistic regression model for dyadic network data .",
    "_ * 19 * , 375 - 397 ."
  ],
  "abstract_text": [
    "<S> reciprocity is an important characteristic of directed networks and has been widely used in the modeling of world wide web , email , social , and other complex networks . in this paper , we take a statistical physics point of view and study the limiting entropy and free energy densities from the microcanonical ensemble , the canonical ensemble , and the grand canonical ensemble whose sufficient statistics are given by edge and reciprocal densities . </S>",
    "<S> the sparse case is also studied for the grand canonical ensemble . </S>",
    "<S> extensions to more general reciprocal models including reciprocal triangle and star densities will likewise be discussed .    </S>",
    "<S> reciprocity , entropy , free energy , directed network , exponential random graph </S>"
  ]
}