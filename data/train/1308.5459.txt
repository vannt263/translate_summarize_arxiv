{
  "article_text": [
    "the goal of any procedure for shuffling a deck of @xmath9 cards labeled with , say , @xmath1 : = \\{1,2,\\ldots , n\\}$ ] is to take the cards in some specified original order , which we may take to be @xmath10 , and re - arrange them randomly in such a way that all @xmath15 possible orders are close to being equally likely . a natural approach to checking empirically whether the outcomes of a given shuffling procedure deviate from uniformity is to apply some fixed numerical function to each of the permutations produced by several independent instances of the shuffle and determine whether the resulting empirical distribution is close to the distribution of the random variable that would arise from applying the chosen function to a uniformly distributed permutation .",
    "_ smoosh _ shuffling ( also known as _ wash , corgi , chemmy _ or _",
    "shuffling ) is a simple physical mechanism for randomizing a deck of cards ",
    "see @xcite for an article that has a brief discussion of smoosh shuffling and a link to a video of the first author carrying it out , and @xcite for other short descriptions . in their forthcoming analysis of this shuffle ,",
    "@xcite use the approach described above with the function that takes a permutation @xmath16 , the set of permutations of @xmath1 : = \\{1,2 , \\ldots , n\\}$ ] , and returns the cardinality of the set of labels @xmath2 $ ] such that @xmath17 .",
    "that is , they count the number of pairs of cards that were adjacent in the original deck and are nt separated or in a different relative order at the completion of the shuffle . for example , the permutation @xmath18 of @xmath19 $ ] given by @xmath20 has @xmath21 : \\pi(k+1 ) = \\pi(k)+1\\ } = \\{1,2,5,6\\}$ ] .    if we write @xmath22 for a random permutation that is uniformly distributed on @xmath23 and @xmath24 $ ] for the set of labels @xmath2 $ ] such that @xmath25 , then , in order to support the contention that the smoosh shuffle is producing a random permutation with a distribution close to uniform , it is necessary to know , at least approximately , the distribution of the integer - valued random variable @xmath26 .",
    "banklader et al .",
    "@xcite use stein s method ( see , for example , @xcite for a survey ) , to show that the distribution of @xmath26 is close to a poisson distribution with expected value @xmath14 when @xmath9 is large .",
    "the problem of computing @xmath27 ( or , more correctly , the integer @xmath28 ) appears in various editions of the 19th century textbook on combinatorics and probability , _ choice and chance _ by william allen whitworth .",
    "for example , proposition xxxii in chapter iv of @xcite gives @xmath29    this formula is quite suggestive .",
    "the probability that @xmath22 has no fixed points is @xmath30 by de montmort s @xcite celebrated enumeration of derangements , and so if we write @xmath31 $ ] for the set of labels @xmath2 $ ] such that @xmath32 ( that is , @xmath33 is the set of fixed points of @xmath22 that fall in @xmath4 $ ] ) , then @xmath34 because in order for the set @xmath35 to be empty either the permutation @xmath22 has no fixed points or it has @xmath9 as a fixed point ( an event that has probability @xmath36 ) and the resulting restriction of @xmath22 to @xmath4 $ ] is a permutation of @xmath4 $ ] that has no fixed points .    the following theorem and the remark after it were pointed out to us by jim pitman ; they show that much more is true .",
    "pitman s proof was similar to the enumerative one we present in section  [ s : enumerative ] and he asked if there are other , more `` conceptual '' proofs .",
    "we present two further proofs in section  [ s : markov ] and section  [ s : bijective ] that we hope make it clearer `` why '' the result is true .",
    "[ t : main ] for all @xmath37 , the random sets @xmath38 and @xmath35 have the same distribution .",
    "in particular , for @xmath39 , @xmath40    [ r : exchangeable ] perhaps the most surprising consequence of this result is that the random set @xmath24 $ ] is exchangeable ; that is , conditional on @xmath41 , the conditional distribution of @xmath38 is that of @xmath42 random draws without replacement from the set @xmath4 $ ] .",
    "this follows because the same observation holds for the random set @xmath35 by a symmetry that does not at first appear to have a counterpart for @xmath38 .",
    "for example , it does not seem obvious _ a priori _ that @xmath43 for some @xmath44 $ ] should be the same as @xmath45 for some @xmath46 $ ] with @xmath47 .",
    "[ r : count_distribution ] once we know that @xmath38 and @xmath35 have the same distribution , the formula given in theorem  [ t : main ] for the common distribution distribution of @xmath26 and @xmath48 follows from the well - known fact that the probability that @xmath22 has @xmath42 fixed points is @xmath49 ( something that follows straightforwardly from the formula above for the probability that @xmath22 has no fixed points ) coupled with the observation that @xmath50 if and only if either @xmath22 has @xmath42 fixed points and all of these fall in @xmath4 $ ] or @xmath22 has @xmath51 fixed points and one of these is @xmath9 .",
    "we present an enumerative proof of theorem  [ t : main ] in section  [ s : enumerative ] .",
    "although this proof is simple , it is not particularly illuminating .",
    "we show in section  [ s : markov ] that the result can be derived with essentially no computation from a comparison of two different ways of iteratively generating uniform random permutations .",
    "theorem  [ t : main ] is , of course , equivalent to the statement that for every subset @xmath52 $ ] the set @xmath53 : \\pi(k+1 ) = \\pi(k)+1\\ } = s\\}$ ] has the same cardinality as @xmath53 : \\pi(k ) = k\\ } = s\\}$ ] , and so if the theorem holds then there must exist a bijection @xmath54 such that @xmath55 : \\pi(k+1 ) = \\pi(k)+1\\ }   = \\{k \\in [ n-1 ] : \\mathcal{h } \\pi(k ) = k\\}$ ] .",
    "conversely , exhibiting such a bijection proves the theorem , and we present a natural construction of one in section  [ s : bijective ] .",
    "the analogue of @xmath38 for circular permutations is the random set consisting of those @xmath5 $ ] such that @xmath6 .",
    "we obtain the distribution of this random set via an enumeration in section  [ s : circular ] and then present some bijective proofs of facts suggested by the enumerative results .    note that the latter random set is just the set of fixed points of the commutator @xmath7 $ ] , where @xmath8 is the @xmath9-cycle @xmath10 . in section  [ s :",
    "commutator ] we show for a general permutation @xmath11 that , under weak conditions on the number of fixed points and @xmath12-cycles of @xmath11 , the total variation distance between the distribution of the number of fixed points of @xmath13 $ ] and a poisson distribution with expected value @xmath14 is small when @xmath9 is large .    it is clear from theorem  [ t : main ] that the common distribution of @xmath26 and @xmath48 is approximately poisson with expected value @xmath14 when @xmath9 is large .",
    "write @xmath56 : \\pi_n(k ) = k\\}$ ] for the set of fixed points of the uniform random permutation @xmath22 and @xmath57 for the poisson probability distribution with expected value @xmath14 .",
    "it is well - known that the total variation distance between the distribution of @xmath58 and @xmath57 is amazingly small : @xmath59 and so it is natural to ask whether the common distribution of @xmath26 and @xmath48 is similarly close to @xmath57 . because @xmath60 , we might suspect that the total variation distance between the distributions of @xmath48 and @xmath61 is on the order of @xmath36 , and so the total variation distance between the distribution of @xmath26 and @xmath57 is also of that order .",
    "indeed , it follows from that @xmath62 and so @xmath63",
    "our first approach to proving theorem  [ t : main ] is to compute @xmath64 for a subset @xmath65 $ ] and show that this number is @xmath66 .",
    "this establishes that @xmath67 and an inclusion - exclusion argument completes the proof .",
    "we begin by noting that we can build up a permutation of @xmath1 $ ] by first taking the elements of @xmath1 $ ] in any order and then imagining that we lay elements down successively so that the @xmath68 element goes in one of the @xmath69 `` slots '' defined by the @xmath70 elements that have already been laid down , that is , the slot before the first element , the slot after the last element , or one of the @xmath71 slots between elements .",
    "consider first the set @xmath72 for some fixed @xmath2 $ ] .",
    "we can count this set by imagining that we first put down @xmath73 and @xmath74 next to each other in that order and then successively lay down the remaining elements @xmath1 \\setminus \\{k , k+1\\}$ ] in such a way that no element is ever laid down in the slot between @xmath73 and @xmath74 .",
    "it follows that @xmath75 as required .",
    "now consider the set @xmath76 for some fixed @xmath77 $ ] .",
    "we can count this set by imagining that we first put down @xmath73 , @xmath74 and @xmath78 next to each other in that order and then successively lay down the remaining elements @xmath1 \\setminus \\{k , k+1,k+2\\}$ ] in such a way that no element is ever laid down in the slot between @xmath73 and @xmath74 or the slot between @xmath74 and @xmath78 .",
    "the number of such permutations is thus @xmath79 , again as required . on the other hand ,",
    "suppose we fix @xmath80 $ ] with @xmath47 and consider the set @xmath81 & @xmath82 .",
    "we imagine that we first put down @xmath73 and @xmath74 next to each other in that order and then @xmath83 and @xmath84 next to each other in that order either before or after the pair @xmath73 and @xmath74 .",
    "there are two ways to do this .",
    "then we successively lay down the remaining elements @xmath1 \\setminus \\{k , k+1 , \\ell , \\ell+1\\}$ ] in such a way that no element is ever laid down in the slot between @xmath73 and @xmath74 or the slot between @xmath83 and @xmath84 .",
    "there are @xmath85 ways to do this second part of the construction , and so the number of permutations we are considering is @xmath86 , once again as required .",
    "it is clear how this argument generalizes .",
    "suppose we have a subset @xmath65 $ ] and we wish to compute @xmath87 .",
    "we can break @xmath88 up into @xmath89 `` blocks '' of consecutive labels for some @xmath89 .",
    "there are @xmath90 ways to lay down the blocks and then @xmath91 ways of laying down the remaining labels @xmath1",
    "\\setminus \\{k_1 , \\ldots , k_m\\}$ ] so that no label is inserted into a slot within one of the blocks .",
    "thus , the cardinality we wish to compute is indeed @xmath92 .",
    "the following proof proceeds by first showing that the random set @xmath38 is exchangeable and then establishing that the distribution of @xmath93 is the same as the distribution of @xmath94 without explicitly calculating either distribution .",
    "suppose that we build the uniform random permutations @xmath95 sequentially in the following manner : @xmath96 is obtained from @xmath22 by inserting @xmath97 uniformly at random into one of the @xmath97 `` slots '' defined by the ordered list @xmath22 ( i.e. as in section  [ s : enumerative ] , we have slots before and after the first and last elements of the list and @xmath98 slots between successive elements ) .",
    "the choice of slot is independent of @xmath99 , where @xmath99 is the @xmath100-field generated by @xmath101 .",
    "it is clear that the set - valued stochastic process @xmath102 is markovian with respect to the filtration @xmath103 .",
    "in fact , if we write @xmath104 , then @xmath105 corresponding to @xmath97 being inserted in the slot between the successive elements @xmath106 and @xmath107 in the list , @xmath108 corresponding to @xmath97 being inserted in the slot to the right of @xmath9 , and @xmath109 moreover , it is obvious from the symmetry inherent in these transition probabilities and induction that @xmath38 is an exchangeable random subset of @xmath4 $ ] for all @xmath9 . furthermore , the nonnegative integer valued process @xmath110 is also markovian with respect to the filtration @xmath103 with the following transition probabilities : @xmath111 @xmath112 and @xmath113    because the conditional distribution of @xmath38 given @xmath114 is , by exchangeability , the same as that of @xmath35 given @xmath115 for @xmath39 , it will suffice to show that the distribution of @xmath93 is the same as that of @xmath94 .",
    "moreover , because @xmath94 has the same distribution as @xmath116 for all @xmath37 and @xmath117 , it will certainly be enough to build another sequence @xmath118 such that    * @xmath119 is a uniform random permutation of @xmath1 $ ] for all @xmath37 , * @xmath118 is markovian with respect to some filtration @xmath120 , * @xmath121 is also markovian with respect to the filtration @xmath120 with the following transition probabilities @xmath122 @xmath123 and @xmath124    we recall the simplest instance of the _ chinese restaurant process _ that iteratively generates uniform random permutations ( see , for example , @xcite ) .",
    "individuals labeled @xmath125 successively enter a restaurant equipped with an infinite number of round tables .",
    "individual @xmath14 sits at some table .",
    "suppose that after the first @xmath98 individuals have entered the restaurant we have a configuration of individuals sitting around some number of tables .",
    "when individual @xmath9 enters the restaurant he is equally likely to sit to the immediate left of one of the individuals already present or to sit at an unoccupied table .",
    "the permutation @xmath119 is defined in terms of the resulting seating configuration by setting @xmath126 , @xmath127 , if individual @xmath128 is sitting immediately to the left of individual @xmath129 and @xmath130 if individual @xmath129 is sitting by himself at some table .",
    "each occupied table corresponds to a cycle of @xmath119 and , in particular , tables with a single occupant correspond to fixed points of @xmath119 .",
    "it is clear that if we let @xmath131 be the @xmath100-field generated by @xmath132 , then all of the requirements listed above for @xmath118 and @xmath133 are met .",
    "as we remarked in the introduction , in order to prove theorem  [ t : main ] it suffices to find a bijection @xmath54 such that @xmath55 : \\pi(k+1 ) = \\pi(k)+1\\ }   = \\{k \\in [ n-1 ] : \\mathcal{h } \\pi(k ) = k\\}$ ] for all @xmath16 .    not only will we find such a bijection , but we will prove an even more general result that requires we first set up some notation .",
    "fix @xmath134 .",
    "let @xmath135 be the permutation that maps @xmath136 $ ] to @xmath137 $ ] .",
    "next define the following bijection of @xmath23 to itself that is essentially the _ transformation fondamentale _ of ( * ? ? ?",
    "* section 1.3 ) ( such bijections seem to have been first introduced implicitly in ( * ? ? ?",
    "* chapter 8) ) .",
    "take a permutation @xmath18 and write it in cycle form @xmath138 , where in each cycle the leading element is the least element of the cycle and these leading elements form a decreasing sequence .",
    "that is , @xmath139 .",
    "next , remove the parentheses to form an ordered listing @xmath140 of @xmath1 $ ] and define @xmath141 by taking @xmath142 to be this ordered listing .",
    "the following result for @xmath143 provides a bijection that establishes theorem  [ t : main ] .",
    "[ t : bijection ] for every @xmath16 , @xmath144 : \\widehat{\\rho \\pi}^{-1}(k+h ) = \\widehat{\\rho \\pi}^{-1}(k ) + 1\\ } = \\{k \\in [ n - h ] : \\pi(k ) = k\\}.\\ ] ]    suppose for some @xmath145 $ ] that @xmath146 .",
    "then , @xmath147 , because no reduction modulo @xmath9 takes place .",
    "if we write the cycle decomposition of @xmath148 in the canonical form described above , then there will be a cycle of the form @xmath149 because of the convention that each cycle begins with its least element .",
    "after the parentheses are removed to form @xmath150 , we will have @xmath151 and @xmath152 for some @xmath153 $ ] .",
    "hence , @xmath154 and @xmath155 .",
    "conversely , suppose for some @xmath145 $ ] that @xmath156 , so that @xmath157 and @xmath158 for some @xmath153 $ ] .",
    "then , @xmath159 and @xmath160 .",
    "the canonical cycle decomposition of @xmath148 is obtained by taking the ordered listing @xmath161 , placing left parentheses before each element that is smaller than its predecessors to the left , and then inserting right parentheses as necessary to produce a legal bracketing .",
    "it follows that @xmath148 must have a cycle of the form @xmath149 , and hence @xmath147 .",
    "thus , @xmath146 , as required .    we give the following example of the construction of @xmath162 from @xmath18 for the benefit of the reader .",
    "suppose that @xmath163 and @xmath164 so that @xmath18 has canonical cycle decomposition @xmath165 for @xmath143 , @xmath166 the canonical cycle decomposition of @xmath148 is @xmath167 thus , @xmath168 and @xmath169 note that it is indeed the case that @xmath170 : \\pi(k ) = k\\ }   =   \\{2,4\\ }   = \\{k \\in [ 6 ] : \\widehat{\\rho \\pi}^{-1}(k+1 ) = \\widehat{\\rho \\pi}^{-1}(k ) + 1\\}.\\ ] ]    it follows from theorem  [ t : bijection ] and the argument outlined in remark  [ r : count_distribution ] that the probability the random variable @xmath171 : \\pi_n(k+h ) = \\pi_n(k ) + 1\\}$ ] takes the values @xmath42 is @xmath172 for @xmath173 .",
    "a question closely related to the ones we have been considering so far is to ask for the distribution of the random set @xmath174 : \\pi_n(k+1 \\mod n ) = \\pi_n(k)+1 \\mod n\\}.\\ ] ] that is , we think of our deck @xmath1 $ ] as being `` circularly ordered '' , with @xmath9 followed by @xmath14 , and ask for the distribution of the number of cards that are followed immediately by their original successor when we lay the shuffled deck out around the circumference of a circle .",
    "[ p : circular ] the random set @xmath175 is exchangeable with @xmath176 for @xmath177 .",
    "consider a subset @xmath178 $ ] .",
    "we wish to compute @xmath179 when @xmath180 this number is clearly @xmath9 and when @xmath181 it is @xmath15 .",
    "consider @xmath182 .",
    "for some positive integer @xmath89 we can break @xmath88 up into @xmath89 `` runs '' of labels that are `` consecutive '' modulo @xmath9 ; that is we can write @xmath88 as the disjoint union of sets @xmath183 @xmath184 , @xmath185 , @xmath186 , where all additions are @xmath187 and @xmath188 for @xmath127 .",
    "this leads to @xmath89 disjoint `` blocks '' @xmath189 , @xmath185 , @xmath190 of labels that must be kept together if we take the permutation and join up the last element of the resulting ordered listing of @xmath1 $ ] with the first to produce a circularly ordered list .",
    "there are @xmath191 ways to circularly order the blocks .",
    "initially this leaves @xmath89 slots between the @xmath89 blocks when we think of them as being ordered around a circle .",
    "also , there are initially @xmath192 labels that are not contained in some block .",
    "it follows that there are then @xmath193 ways of laying down the remaining @xmath192 elements of @xmath1 $ ] that are nt in a block so that no element is inserted into a slot within one of the blocks . finally , there are @xmath9 places between the @xmath9 circularly ordered elements of @xmath1 $ ] where we can cut to produce a permutation of @xmath1 $ ] .",
    "thus , the cardinality we wish to compute is @xmath194 .",
    "we see that @xmath195 consequently , by inclusion - exclusion , @xmath196    in particular , @xmath175 is exchangeable and @xmath197    as expected , @xmath198 converges to the poisson probability @xmath199 as @xmath200 .",
    "the exchangeability of @xmath175 implies that there are is at least one bijection ( and hence many ) between the sets @xmath201 and @xmath202 for two subsets @xmath203 and @xmath204 of @xmath1 $ ] .",
    "this leads to the question of whether there is a bijection with a particularly nice description . rather than pursue this question directly , we give a bijective explanation of the following interesting consequence of proposition  [ p : circular ] from which the desired bijection can be readily derived .",
    "observe that @xmath205 whereas @xmath206 so that @xmath207    let @xmath135 be the permutation that maps @xmath136 $ ] to @xmath208 $ ] .",
    "define an equivalence relation on @xmath23 by declaring that @xmath209 and @xmath210 are equivalent if and only if @xmath211 for some @xmath212 .",
    "we call the set of equivalence classes the circular permutations of @xmath1 $ ] and denote this set by @xmath213 . note that @xmath214",
    ". we will write @xmath215 as an ordered listing @xmath216 of @xmath1 $ ] , with the understanding that the listings produced by a cyclic permutation of the coordinates also represent @xmath100 : a permutation @xmath16 is in the equivalence class @xmath100 if for some @xmath212 we have @xmath217 for @xmath136 $ ] .",
    "we can also think of @xmath216 as the cycle representation of a permutation @xmath218 of @xmath1 $ ] consisting of a single @xmath9-cycle ( that is , the permutation @xmath218 sends @xmath219 to @xmath220 ) .",
    "hence we can also regard @xmath213 as the set of @xmath9-cycles in @xmath23 .    if @xmath16 , then the set @xmath221 : \\pi^{-1}(j+1 \\mod n ) = \\pi^{-1}(j ) + 1 \\mod n\\}\\ ] ] is unchanged if we replace @xmath18 by an equivalent permutation .",
    "we denote the common value for the equivalence class @xmath215 to which @xmath18 belongs by @xmath222 . in terms of the @xmath9-cycle @xmath223 associated with @xmath100 , @xmath224 : \\tilde \\sigma(j ) = j + 1 \\mod n\\}.\\ ] ]",
    "the identity is equivalent to the identity @xmath225 for any subset @xmath178 $ ] , and we will give a bijective proof of this fact .",
    "consider @xmath226 with @xmath227 .",
    "suppose that we have indexed @xmath88 so that @xmath228 .",
    "note that @xmath229 $ ] for @xmath230 .",
    "we are going to recursively build circular permutations @xmath231 with @xmath232 and @xmath233 for @xmath230 .",
    "suppose that @xmath234 have been built .",
    "write @xmath232 as @xmath235 , where @xmath236 is a listing of @xmath237 $ ] in some order and we recognize two such representations as describing the same circular permutation if each can be obtained from the other by a circular permutation of the the entries .",
    "we first add one to each entry of @xmath235 that is greater than @xmath238 , thereby producing a vector that is still of length @xmath239 and has entries that are a listing of @xmath240 . now insert @xmath241 immediately to the right of @xmath238 , thereby producing a vector that is now of length @xmath242 and has entries that are a listing of @xmath243 $ ] .",
    "we can describe the procedure more formally as follows .",
    "either @xmath244 or @xmath245 .",
    "in the first case , let @xmath246 $ ] be such that @xmath247 and define @xmath248 by setting @xmath249 on the other hand , if @xmath245 , then let @xmath246 $ ] be such that @xmath250 and define @xmath248 by setting @xmath251    it is not difficult to check in either case that a cyclic permutation of the coordinates in the chosen representation of @xmath252 induces a cyclic permutation in the coordinates of @xmath253 , and so @xmath254 is a well - defined map from @xmath255 to @xmath256 .",
    "it is clear that @xmath257 .",
    "[ e : circular_perm ] here are two examples of the construction just described .",
    "suppose that @xmath163 , @xmath258 , @xmath259 and @xmath260 .",
    "we begin by adding one to each entry of @xmath100 greater than @xmath261 .",
    "this gives us @xmath262 we then insert @xmath263 immediately to the right of @xmath261 to get @xmath264 now we add one to each entry greater than @xmath265 .",
    "this gives us @xmath266 we then insert @xmath267 immediately to the right of @xmath265 to get @xmath268 we next add one to each entry greater than @xmath269 .",
    "this gives us @xmath270",
    "lastly , we insert @xmath271 immediately to the right of @xmath269 to get @xmath272 suppose that @xmath163 , @xmath273 , @xmath259 and @xmath274 . then , @xmath275 @xmath276 and @xmath277    it remains to show that each of the maps @xmath254 is invertible .",
    "suppose we have the circular permutation @xmath278 with @xmath279 .",
    "the circular permutation @xmath232 is recovered as follows .",
    "if @xmath280 , then let @xmath281 $ ] be such that @xmath282 and and define @xmath283 by setting @xmath284 on the other hand , if @xmath245 , then let @xmath281 $ ] be such that @xmath285 and define @xmath283 by setting @xmath286    [ e : circular_perm_inverse ] we illustrate the inversion procedure just outlined with the second example in example  [ e : circular_perm ] .",
    "we start with @xmath277 remove the entry @xmath287 and subtract @xmath14 from every entry greater than @xmath287 to produce @xmath288 we then remove the entry @xmath289 and subtract @xmath14 from every entry greater than @xmath289 to produce @xmath290",
    "lastly , we remove the entry @xmath291 and subtract @xmath14 from every entry greater than @xmath291 to produce @xmath292    note that @xmath293 the values of this quantity for @xmath294 are @xmath295 recall that the number of permutations of @xmath1 $ ] with no fixed points ( that is , the number of derangements of @xmath9 ) is given by @xmath296 and values of this quantity for @xmath294 are @xmath297 a comparison of these sequences suggests that @xmath298 and this follows readily from the observation that @xmath299 \\\\ & \\quad = \\frac{n!}{h ! ( n - h ) ! } ( n - h-1 ) ! \\frac{n - h}{h+1 } \\\\ & \\quad = \\frac{n!}{(h+1)!}. \\\\ \\end{split}\\ ] ]    a bijective proof of follows from corollary 2 of @xcite , where it is shown via a bijection that @xmath300\\}.\\ ] ] if @xmath301 is such that @xmath302 for @xmath153 $ ] , then either @xmath303 for @xmath304 $ ] , so that @xmath305 , or @xmath302 for @xmath153 $ ] and @xmath306 . the set of @xmath100 in the latter category",
    "are in a bijective correspondence with the set of @xmath307 such that @xmath308 via the bijection that sends a @xmath309 to the @xmath307 given by @xmath310    the identity has the following probabilistic interpretation : if @xmath22 is a uniform random permutation of @xmath1 $ ] and @xmath311 is a uniform random @xmath97-cycle in @xmath312 , then @xmath313 : \\pi_n(k ) = k\\}=0\\ }   =   \\mathbb{p}\\{\\#\\{k \\in [ n ] : \\gamma_{n+1}(k ) = k+1\\}=0\\}.\\ ] ] it is , in fact , the case that the two random sets @xmath56 : \\pi_n(k ) = k\\}$ ] and @xmath314 : \\gamma_{n+1}(k ) = k+1\\}$ ] have the same distribution .",
    "we will show this using an argument similar to that in section  [ s : markov ] .",
    "suppose that @xmath95 are generated using the chinese restaurant process and @xmath315 are generated recursively by constructing @xmath311 from @xmath316 by picking @xmath317 uniformly at random from @xmath1 $ ] and replacing @xmath318 in the cycle representation of @xmath316 by @xmath319 .",
    "it is clear that the random set @xmath320 is exchangeable .",
    "the process @xmath321 is markovian : writing @xmath322 and @xmath323 , we have @xmath324 corresponding to @xmath97 being inserted immediately to the right of @xmath325 , @xmath326 corresponding to @xmath97 being inserted immediately to the right of @xmath9 , and @xmath327 it is obvious from the symmetry inherent in these transition probabilities and induction that @xmath328 is an exchangeable random subset of @xmath1 $ ] for all @xmath9 .",
    "it therefore suffices to show that @xmath329 has the same distribution as @xmath330 .",
    "observe that @xmath331 .",
    "it is clear that @xmath332 is a markov chain with the following transition probabilities @xmath333 @xmath334 and @xmath335 it follows from the chinese restaurant construction that @xmath336 @xmath337 and @xmath338 and so @xmath339 and @xmath329 do indeed have the same distribution for all @xmath9 .",
    "if we write @xmath8 for the permutation of @xmath1 $ ] given by @xmath340 , then the random set @xmath175 of section  [ s : circular ] is nothing other than @xmath341 : \\rho \\pi_n(i ) = \\pi_n \\rho(i)\\}\\ ] ] or , equivalently , the set @xmath341 : \\rho^{-1 } \\pi_n^{-1 } \\rho \\pi_n(i ) = i\\}.\\ ] ] this is just the set of fixed points of the commutator @xmath342 = \\rho^{-1 } \\pi_n^{-1 } \\rho \\pi_n$ ] . in this section",
    "we investigate the asymptotic behavior of the distribution of the set of fixed points of the commutators @xmath343 $ ] for a sequence of permutations @xmath344 , where @xmath345 .",
    "write @xmath346 for the function that gives the number of fixed points ( i.e. @xmath347 is the character of the defining representation of @xmath23 ) .",
    "it follows from of ( * ? ? ?",
    "* corollary 1.2 ) ( see also of ( * ? ? ? * theorem 25 ) ) that if @xmath348 and @xmath349 are independent uniformly distributed permutations of @xmath1 $ ] , then the distribution of @xmath350)$ ] is approximately poisson with expected value @xmath14 when @xmath9 is large .    the results of @xcite suggest that if @xmath9 is large and @xmath351 is a `` generic '' element of @xmath23 , then the distribution of @xmath352)$ ] should be close to poisson with expected value @xmath14 . of course , such a result will not hold for arbitrary sequences @xmath344 . for example , if @xmath351 is the identity permutation , then @xmath353 ) = n$ ] . the behavior of @xmath353)$ ] for a deterministic sequence @xmath344 does not appear to have been investigated in the literature",
    ". however , we note that if @xmath354 is an independent uniform permutation of @xmath1 $ ] , then @xmath355 )   & = \\chi_n(\\eta_n^{-1 } \\pi_n^{-1 } \\eta_n \\pi_n ) \\\\ & = \\chi_n(\\tilde \\pi_n^{-1 } \\ , \\eta_n^{-1 } \\pi_n^{-1 } \\eta_n \\pi_n \\ , \\tilde \\pi_n ) \\\\ & =   \\chi_n(\\tilde \\pi_n^{-1 } \\eta_n^{-1 } \\tilde \\pi_n \\ ; \\tilde \\pi_n^{-1 } \\ , \\pi_n^{-1 } \\eta_n \\pi_n \\ , \\tilde \\pi_n ) .",
    "\\\\ & = \\#\\{i \\in [ n ] : u_n(i ) = v_n(i)\\ } , \\end{split}\\ ] ] where @xmath356 and @xmath357 are independent random permutations of @xmath1 $ ] that are uniformly distributed on the conjugacy class of @xmath351 . since @xmath358 has the same distribution as @xmath359 , we see that @xmath353)$ ] is distributed as the number of fixed points of the random permutation @xmath360 and we could , in principle , determine the distribution of @xmath353)$ ] if we knew the the distribution of the conjugacy class to which @xmath360 belongs . given a partition @xmath361 ,",
    "write @xmath362 for the conjugacy class of @xmath23 consisting of permutations with cycle lengths given by @xmath363 and let @xmath364 be the element @xmath365 of the group algebra of @xmath23 . if @xmath366 is another conjugacy class with cycle lengths @xmath367 , then , writing @xmath368 for the multiplication in the group algebra , @xmath369 for nonnegative integer coefficients @xmath370 .",
    "denote by @xmath371 the partition of @xmath9 given by the cycles lengths of @xmath351 .",
    "if we knew @xmath372 for all @xmath373 , then we would know the distribution of the conjugacy class to which @xmath360 belongs and hence , in principle the distribution of @xmath353)$ ] .",
    "unfortunately , the determination of the coefficients @xmath370 appears to be a rather difficult problem .",
    "the special case when @xmath374 ( that is , the conjugacy class of @xmath9-cycles is being multiplied by itself ) is treated in @xcite and fairly explicit formulae for some other simple cases are given in @xcite , but in general there do not seem to be usable expressions .",
    "firstly , it follows that if we write @xmath375 for the number of fixed points of @xmath351 , then @xmath376 ) ]   =   n \\mathbb{p}\\{u_n(i ) = v_n(i)\\ } = n   \\left [ \\left(\\frac{n - f_n}{n}\\right)^2 \\frac{1}{n-1 } + \\left(\\frac{f_n}{n}\\right)^2 \\right],\\ ] ] and so it appears that we will at least require some control on the sequence @xmath377 .    a second , and somewhat more subtle , potential difficulty becomes apparent if we consider the permutation @xmath351 that is made up entirely of @xmath12-cycles ( so that @xmath9 is necessarily even ) . in this case , @xmath378 if and only if @xmath379 , and so @xmath353)$ ] is even .",
    "going a little further , we may write @xmath380 , take @xmath351 to have the cycle decomposition @xmath381 , and note that @xmath353 ) = \\#\\{i \\in [ n ] : u_n(i ) = v_n(i)\\}$ ] has the same distribution as @xmath382 : u_n(i ) = \\eta_n(i)\\ }   = 2 \\#\\{i \\in [ m ] : u_n(i ) = \\eta_n(i)\\ } = 2 m_n$ ] , where @xmath383 , with @xmath384 the indicator of the event @xmath385 .",
    "it is not difficult to show that @xmath386   & =   \\frac{m(m-1 ) \\cdots ( m - k+1)}{(2m-1)(2m-3 ) \\cdots ( 2 m - 2k + 1 ) } \\\\ & \\rightarrow \\frac{1}{2^k } \\quad \\text{as $ m \\to \\infty$ } , \\\\ \\end{split}\\ ] ] and so the distribution of @xmath353)/2 $ ] converges to a poisson distribution with expected value @xmath387 .",
    "returning to the case of a general permutation @xmath351 and writing @xmath388 for the number of @xmath12-cycles in the cycle decomposition of @xmath351 , it seems that in order for the distribution of the random variable @xmath353)$ ] to be close to that of a poisson random variable with expected value @xmath14 when @xmath9 is large we will need to at least impose suitable conditions on @xmath389 and @xmath388 .",
    "it will , in fact , suffice to suppose that @xmath389 and @xmath388 are bounded as @xmath9 varies , as the following result shows .",
    "suppose that @xmath390 .",
    "there exists a constant @xmath317 that depends on @xmath391 and @xmath392 but not on @xmath37 such that if @xmath0 is uniformly distributed on @xmath23 and @xmath393 has at most @xmath391 fixed points and at most @xmath392 @xmath12-cycles , then the total variation distance between the distribution of the number of fixed points of the commutator @xmath13 $ ] and a poisson distribution with expected value @xmath14 is at most @xmath394 .",
    "as we have observed above , the number of fixed points of @xmath13 $ ] has the same distribution as @xmath395 : u(i ) = v(i ) \\}$ ] , where @xmath396 and @xmath397 are independent random permutations that are uniformly distributed on the conjugacy class of @xmath11 . we will write @xmath398 for @xmath347 to simplify notation .",
    "similarly , we write @xmath399 for the number of fixed points of @xmath11 and @xmath400 for the number of @xmath12-cycles .",
    "we assume that @xmath401 and @xmath402 .",
    "let @xmath403 and @xmath404 be the random subsets of @xmath1 $ ] that are , respectively , the fixed points of @xmath396 and the elements that belong to the @xmath12-cycles of @xmath396 .",
    "define @xmath405 and @xmath406 similarly .",
    "set @xmath407 : u(i ) = v(i ) ,   \\ ; i \\notin f_u \\cup t_u",
    "\\cup f_v \\cup t_v\\}.\\ ] ] observe that @xmath408 so @xmath409 ) \\ne n\\ } & \\le \\mathbb{e}[\\chi([\\eta,\\pi ] ) ] - \\mathbb{e}[n ] \\\\ & = n   \\left [ \\left(\\frac{n - f}{n}\\right)^2 \\frac{1}{n-1 } + \\left(\\frac{f}{n}\\right)^2 -   \\left(\\frac{n - f - 2t}{n}\\right)^2 \\frac{1}{n-1 } \\right ] . \\\\",
    "\\end{split}\\ ] ] in particular , @xmath410 ) \\ne n\\}$ ] is bounded in @xmath9 .",
    "let @xmath411 be chosen elements uniformly without replacement from @xmath1 $ ] and independent of the permutations @xmath396 and @xmath397 .",
    "set @xmath412 and @xmath413 note that @xmath414 so that @xmath415 , and hence @xmath416)\\}$ ] , is bounded in @xmath9 .",
    "it will therefore suffice to show that the total variation distance between the distribution of @xmath417 and a poisson distribution with expected value @xmath14 is at most a constant muliple of @xmath36 .",
    "we will do this using stein s method .",
    "more precisely , we will use the version in ( * ? ? ?",
    "* section 1 ) that depends on the construction of an _ exchangeable pair _ ; that is , another random variable @xmath418 such that @xmath419 has the same distribution as @xmath420 .",
    "build another random permutation @xmath421 by interchanging @xmath422 and @xmath423 in the cycle representation of @xmath397 .",
    "if , using a similar notation to that above , we set @xmath424 : u(i ) = v'(i )   \\ ; i \\notin f_u \\cup",
    "t_u \\cup f_{v ' } \\cup t_{v'}\\}\\ ] ] and @xmath425 then @xmath419 is clearly an exchangeable pair",
    ". we can represent the permutations @xmath396 and @xmath397 when the event @xmath426 occurs as in figure  [ fig : general_position ] .     and",
    "@xmath397 on the elements @xmath422 and @xmath423 when the event @xmath426 occurs .",
    "the solid arrows depict the action of @xmath396 and the dashed arrows depict the action of @xmath397 .",
    "the components of the triple @xmath427 are distinct .",
    "the same is true of the components of the triples @xmath428 , @xmath429 , and @xmath430 .",
    "however , it may happen that @xmath431 , @xmath432 , etc.,scaledwidth=100.0% ]      note that @xmath434 where @xmath435 is a random variable such that if we set @xmath436 $ ] , then @xmath437 is bounded in @xmath9 .",
    "furthermore , @xmath438 where @xmath439 is a constant such that @xmath440 is bounded in @xmath9 , and similar arguments show that @xmath441    suppose we can show that the probability of the intersection of any two of the events whose indicators appear on the right - hand side of is at most a constant @xmath442 , where @xmath443 is bounded in @xmath9 , then @xmath444 \\le n b_n + 7 n d_n\\ ] ]    @xmath445 \\le n |c_n| + 7 n d_n.\\ ] ] it will follow from the main result of ( * ? ? ?",
    "* section 1 ) that the total variation distance between the distribution of @xmath417 and a poisson distribution with expected value @xmath14 is at most @xmath446 for a suitable constant @xmath447 , and hence , as we have already remarked , the same is true ( with a larger constant ) for the distribution of @xmath448)$ ] .",
    "the probability of this event is also @xmath452 continuing in this way , we see that , as required , the probability of the intersection of any two of the events whose indicators appear on the right - hand side of is at most a constant @xmath442 , where @xmath443 is bounded in @xmath9 .",
    "* acknowledgments : * we thank jim pitman for getting us interested in the area investigated in this paper , sharing with us the contents of his results theorem  [ t : main ] and remark  [ r : exchangeable ] , and telling us about the results in @xcite .",
    "we thank steve butler for helpful discussions about circular permutations and an anonymous referee for several helpful suggestions .",
    "j.  pitman , _ combinatorial stochastic processes _ , lecture notes in mathematics , vol .",
    "1875 , springer - verlag , berlin , 2006 , lectures from the 32nd summer school on probability theory held in saint - flour , july 724 , 2002 , with a foreword by jean picard .",
    "mr 2245368 ( 2008c:60001 )"
  ],
  "abstract_text": [
    "<S> in a uniform random permutation @xmath0 of @xmath1 : = \\{1,2,\\ldots , n\\}$ ] , the set of elements @xmath2 $ ] such that @xmath3 has the same distribution as the set of fixed points of @xmath0 that lie in @xmath4 $ ] . </S>",
    "<S> we give three different proofs of this fact using , respectively , an enumeration relying on the inclusion - exclusion principle , the introduction of two different markov chains to generate uniform random permutations , and the construction of a combinatorial bijection . </S>",
    "<S> we also obtain the distribution of the analogous set for circular permutations that consists of those @xmath5 $ ] such that @xmath6 . </S>",
    "<S> this latter random set is just the set of fixed points of the commutator @xmath7 $ ] , where @xmath8 is the @xmath9-cycle @xmath10 . </S>",
    "<S> we show for a general permutation @xmath11 that , under weak conditions on the number of fixed points and @xmath12-cycles of @xmath11 , the total variation distance between the distribution of the number of fixed points of @xmath13 $ ] and a poisson distribution with expected value @xmath14 is small when @xmath9 is large .    , </S>"
  ]
}