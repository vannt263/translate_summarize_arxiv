{
  "article_text": [
    "by nature a fault causes a system to behave abnormally but does not cause the system to shut down @xcite , however if left unattended a fault may lead to a system failure , hence the importance of a fault tolerant control ( ftc ) system . while faults can cause instability in a system , the integration of an ftc scheme significantly increases the ability of the system to maintain overall stability in the presence of a fault @xcite . in this paper",
    "we develop a new active ftc system using an unscented kalman filter ( ukf ) for fault detection and identification ( fdi ) where parameter updates made by the ukf are sent to the nonlinear model predictive control ( nmpc ) based control system . to test the ftc system",
    "the design is applied to the control of a 2d robot model .",
    "+ there are numerous solutions to the ftc design problem with the ftc research community classifying these designs as either _ active _ or _",
    "passive_. passive ftc systems are based on fixed controllers and are designed to be resilient against known faults .",
    "they are designed using robust control techniques for worst case scenarios .",
    "active ftc systems `` actively '' seek the fault and try to gather as much information about it as possible to help the controller overcome any consequential instabilities and are also known as self - repairing , self - designing or fault detection , identification ( diagnosis ) and accommodation schemes .",
    "active schemes are made up of an fdi component and are based on controller redesign , or selection / mixing of pre - designed controllers .",
    "+ the main difficulty with active ftc is on - line reconfiguration which requires detailed information about changes in system parameters .",
    "hence the main role of the fdi subsystem is the gathering of information on parameter changes to assist in controller reconfiguration .",
    "fdi is a key component in an active ftc system and is the most difficult aspect of ftc @xcite . in the early days",
    "most research on fdi was done independently of the controller design and no combined design existed @xcite .",
    "recently there has been some research on the integration of fdi and ftc ; however much remains to be done .",
    "+ techniques commonly used for fdi include artifical intelligence based fdi schemes @xcite , @xcite , @xcite , and multiple model based methods @xcite @xcite where different models are used to describe the dynamics of the system for different operating regimes . sliding mode observers for fault detection have also been used because of their strong robustness to a particular class of uncertainty @xcite .",
    "other methods include analytical fdi methods that are based on estimating the fault through matrix algebra @xcite .",
    "observer based fdi remains the most common approach studied in recent literature where an extended state observer is used to estimate faults .",
    "+ quite often in the design of an ftc system two controllers are utilised ; the main ( or nominal ) controller is designed for the faultless case with the second controller being a compensator designed to handle the faulty case @xcite . in this paper",
    "a number of observer based fdi schemes are investigated and integrated with the nmpc ( nonlinear model predictive control ) controller design of @xcite to develop a full active ftc system . in our design only one controller needs to be designed capable of handling the faultless as well as the fault cases .",
    "the 2d robot model from @xcite is used as a test bed to assist in the development of the ftc system design .",
    "+ this paper is organised as follows ; section [ section : chap4_fdi_tandi ] presents an in - depth look at the fdi methods chosen for investigation , namely the ekf ( extended kalman filter ) , the ukf ( unscented kalman filter ) and the imm ( integrated multiple models ) . an ekf filter , ukf filter , ekf based imm filter and a ukf based imm filter are each designed in section [ section : chap4_probform ] for the purposes of fdi using the 2d robot model of @xcite .",
    "four different active fault tolerant control systems using nmpc ( nonlinear model predictive control ) as the controller design are formulated and implemented in matlab for the 2d robot model .",
    "each of the four different active ftc systems developed are then tested under different conditions in section [ section : chap4_nranda ] .",
    "the tests are designed to evaluate the performance of the filters as well as the interaction of the filter and controller designs .",
    "section [ section : chap4_nranda ] provides a detailed analysis of the test results and concludes with a summary of findings .",
    "based on the findings the ukf filter was chosen as part of the final design of the active ftc system .",
    "section [ subsec : lmpc ] concludes with a comparison between linear mpc and nonlinear mpc as the controller showing that an active ftc system with a nonlinear mpc controller has better overall performance in the event of a failure .",
    "conclusions are given in section [ section : chap4_conclusion ] .",
    "the fault detection schemes considered here are all based on filtering techniques , namely the ekf , the ukf , the ekf based imm and the ukf based imm .",
    "these filters are used to sequentially estimate the state of a dynamic system using a sequence of noisy measurements made on the system .",
    "the state estimates are then utilised to aid in fault detection and control reconfiguration . a general overview and key mathematical concepts are provided for each method below .",
    "the ekf is an extension of the well known kalman filter .",
    "one of the drawbacks of the kalman filter is that it does not provide good estimations for nonlinear systems @xcite .",
    "the ekf approximates ( or linearises ) the nonlinear functions in the state dynamic and measurement models .",
    "there are two main stages during an ekf ( and the general kalman filter ) cycle : predict and update . during the prediction stage",
    "the filter states and covariances are predicted forward one time step as are the measurement predictions . during the update stage corrections",
    "are made to the state predictions via noisy measurements .",
    "a summary of the ekf ( ristic et .",
    "al @xcite ) equations is given below .",
    "the target state @xmath0 and measurement @xmath1 equations propagate according to : @xmath2 where @xmath3 and @xmath4 are random sequences and are mutually independent with zero - mean , white gaussian with covariances @xmath5 and @xmath6 respectively .",
    "the ekf is based on the assumption that local linearisation of the above equations may be a sufficient description of nonlinearity .",
    "the mean and covariance of the underlying gaussian density are computed recursively in a two stage process ( ristic et .",
    "al @xcite ) : + stage 1 : prediction @xmath7    stage 2 : update / correction @xmath8    where @xmath9 , @xmath10 and @xmath11 .",
    "the parameter @xmath12 is commonly known as the kalman gain and @xmath13 is referred to as the innovation covariance .",
    "the innovation @xmath14 is the error between the predicted measurement and the actual measurement of the system .",
    "the matrices @xmath15 and @xmath16 are the local linearisation of the nonlinear functions @xmath17 and @xmath18 . the two matrices are defined as jacobians evaluated at @xmath19 and @xmath20 respectively ( ristic et .",
    "al @xcite ) .",
    "the non - gaussianity of the true posterior density is more evident , for example becomes bimodal or heavily skewed , when the model is highly nonlinear . in this event",
    "the performance of the ekf will significantly degrade .",
    "the ukf addresses the issue of non - gaussianity .",
    "the ukf is a part of a family of nonlinear filters , referred to as linear regression kalman filters , that are based on statistical linearisation rather than analytical linearisation .",
    "the key concept behind these filters is to perform nonlinear filtering using a gaussian representation of the posterior @xmath21 through a set of deterministically chosen sample points .",
    "the true mean and covariance of the gaussian density are completely captured by these sample points up to the second order of nonlinearity , with errors introduced in the third and higher order when propagated through a nonlinear transform .",
    "the ekf on the other hand is only of first order with errors introduced in the second and higher orders .",
    "the filters belonging to this family differ only by the method used to select the sample points i.e. their number , weights and values in the filtering equations are identical and are given below .",
    "the ukf uses an unscented transform for the selection of points in an ekf framework ( ristic et .",
    "al @xcite ) . + we assume that at time @xmath22 the posterior is gaussian : @xmath23 .",
    "the very first step is representing this density via a set of @xmath24 sample points @xmath25 and their weights @xmath26 .",
    "the ukf uses the unscented transform @xcite to select the sample points @xmath25 and weights @xmath27 .",
    "the prediction step is as follows : @xmath28\\left[\\mathbf{f}_{k-1}\\left(\\mathcal{x}_{k-1}^i\\right ) - \\mathbf{\\hat{x}}_{k\\vert k -1}\\right]^\\top.\\end{aligned}\\ ] ] a set of @xmath24 sample points : @xmath29 are used to represent the predicted density : @xmath30 and the predicted measurement becomes : @xmath31 the update step is defined as : @xmath32    where : @xmath33    as can be seen from the above filter equations there is no explicit calculation of jacobians .",
    "consequently these filters can be utilised even when the nonlinear functions @xmath34 and @xmath35 have discontinuities .",
    "the imm belongs to a class of filters called the gaussian sum filters . the main concept here is the approximation of the required posterior density @xmath36 by a gaussian mixture ( ristic et .",
    "al @xcite ) : @xmath37 where @xmath38 are weights that are normalised , @xmath39 .",
    "gaussian sum filters such as the imm are ideal when the posterior density is multimodal because for multimodal densities there is a performance degradation in both the ekf and ukf . at time @xmath40 the state estimate is calculated for each possible current model using @xmath41 filters , with each filter using a different combination of the previous model - conditioned estimates called mixed initial condition .",
    "the algorithm as outlined in bar - shalom et .",
    "al @xcite is :    * calculation of the mixing probabilities .",
    "the probability that mode @xmath42 was in effect at time @xmath22 given that @xmath43 is in effect at @xmath40 conditioned on @xmath44 is given by : @xmath45 the above can be written as : @xmath46 where the normalising constants are : @xmath47 * mixing . the mixed initial condition for the filter matched to @xmath48 is calculated starting with @xmath49 : @xmath50 and the corresponding covariance is given by : @xmath51\\\\ & \\cdot \\left[\\hat{x}^i\\left(k-1 \\vert k-1\\right ) -",
    "\\hat{x}^{0}\\left(k-1\\vert k-1\\right)\\right]^\\intercal\\bigg\\},\\quad\\quad i , j = 1,\\hdots , r . \\end{split}\\ ] ] * mode - matched filtering .",
    "the estimates of the states and covariances calculated in step 2 above are used as inputs to the filter matched to @xmath48 which uses @xmath52 to determine @xmath53 and @xmath54 .",
    "the likelihood functions associated to the @xmath41 filters : @xmath55,\\ ] ] are calculated using the mixed initial condition and covariance from step 2 : @xmath56,\\quad\\quad j = 1,\\hdots , r,\\ ] ] that is : @xmath57,s^j\\left[k;p^{0j}\\left(k-1\\vert k-1\\right)\\right]\\right],\\quad\\quad j = 1,\\hdots , r.\\ ] ] * mode probability update .",
    "the mode probabilities are then updated via : @xmath58 where @xmath59 is the normalisation constant and is given by @xmath60 * estimations and covariance combination .",
    "the output is obtained by combining the model - conditioned estimates and covariances : @xmath61\\left[\\hat{x}^j\\left(k\\vert   k\\right ) - \\hat{x}\\left(k\\vert k\\right)\\right]^\\intercal\\right\\rbrace.\\end{aligned}\\ ] ]    this section outlined the details of the the methods chosen for further investigation , the ekf , the ukf and the imm filters .",
    "these techniques are applied to the 2d robot model in the next section .",
    "to test the different filtering techniques in an fdi context the robot model of @xcite is used for development and testing purposes and forms the plant that is to be controlled as well as the process model of the nmpc controller ( see figure [ fig : chap3_robot eom ] ) .",
    "the equations for this robot model are : @xmath62 where @xmath63 is the @xmath63-coordinate of the point @xmath64 , @xmath65 is the @xmath65-coordinate of the point @xmath64 , @xmath66 is the heading angle , @xmath67 is the right wheel angular velocity , @xmath68 is the left wheel angular velocity and @xmath69 is the speed given by @xmath70 .",
    "+ the nmpc controller is based on the design given in @xcite which solves the following optimal control problem using pseudospectral discretisation :    @xmath71    subject to @xmath72    full details of the design are given in @xcite . fifty coincidence points ( @xmath73 )",
    "are used along with a prediction window length of 5 secs ( @xmath74 ) .",
    "the weights @xmath75 and @xmath76 are diagonal matrices with the diagonal values set to 10 , 1 and 1 respectively and found through trial and error . + the fault , to be simulated and tested for , is a punctured wheel .",
    "if a wheel is punctured the radius of the wheel will decrease and so the filters are set up to estimate the radius of the wheel .",
    "four different filters have been designed , the ekf , the ukf , the ekf imm and the ukf imm .",
    "+ the robot parameters used for all simulations are : right wheel radius , @xmath77 , left wheel radius , @xmath78 , distance between wheels , @xmath79 , speed demand is @xmath80 and the input constraints on @xmath67 and @xmath68 are @xmath81 .",
    "the filters are updated at 100hz while the controller is updated at 10hz .",
    "all work was developed using matlab with snopt as the nonlinear programme ( nlp ) solver .",
    "the following subsections detail the design of each of the filters .",
    "the state vector for the ekf consists of the following states : @xmath82^\\intercal,\\ ] ] where @xmath63 , @xmath65 and @xmath66 are the robot states and @xmath83 and @xmath84 are the right wheel and left wheel radii respectively .",
    "the measurements are assumed to be of the speed , @xmath69 , of the robot :    @xmath85    where @xmath86 is additive white noise .",
    "the initial state vector and initial covariance matrix are : @xmath87^\\intercal,\\quad\\quad p(0 ) = \\begin{bmatrix }      ( 0.5)^2 & 0 & 0 & 0 & 0 \\\\      0 & ( 0.5)^2 & 0 & 0 & 0 \\\\      0 & 0 & ( 1\\pi/180)^2 & 0 & 0 \\\\      0 & 0 & 0 & ( 0.5)^2 & 0 \\\\      0 & 0 & 0 & 0 & ( 0.5)^2   \\end{bmatrix}.\\ ] ] the @xmath88 and @xmath89 noise matrices were chosen to be : @xmath90 where @xmath91 is the update rate of the filter .",
    "for the prediction cycle an euler integration scheme is used to predict the states of the ekf forward .",
    "the predicted measurement @xmath92 is given by : @xmath93 given the above information the kalman filter equations given in section [ subsection : chap4_ekf_equations ] are applied to estimate the radius of each wheel in the experiments conducted in section [ section : chap4_nranda ] .",
    "the general structure of the ekf and ukf are very similar in that they both have a prediction and update cycle and produce a single state vector and a corresponding covariance matrix . for the robot model",
    "the state vector is the same as the one given in equation .",
    "the initial state vector , initial covariance matrix , the process noise matrix @xmath88 and the noise covariance matrix @xmath89 all remain the same as those given in subsection [ subsec : chap4_ekf_equations_sims ] .",
    "the ukf algorithm given in subsection [ subsec : chap4_ukf_equations ] is applied to the robot model with @xmath94 @xcite .",
    "the interacting multiple model method , as the name suggests , is made up of multiple models where each model tests a different hypothesis .",
    "four different models ( the terms mode and model are used interchangeably and have the same meaning in the context of imms ) have been designed where :    * no fault case . *",
    "@xmath95 right wheel deflation , left wheel no fault . * right wheel no fault , @xmath95 left wheel deflation .",
    "* @xmath95 right wheel deflation , @xmath95 left wheel deflation .    during step 3 of the imm algorithm given in section [ subsection : chap4_imm_equations ] a filter such as the ekf is used to update the states and covariances , and both an ekf based imm filter and a ukf based imm filter have been designed .",
    "the initial covariance matrix for each filter and each mode are the same as equation .",
    "the @xmath88 and @xmath89 matrices are those given in equation and the initial state vectors for each filter and mode are : @xmath96^\\intercal,\\\\ \\mathbf{x}_2(0 ) & = & \\left[x_0,\\,\\,\\,y_0\\,\\,\\,\\psi_0\\,\\,\\,1\\,\\,\\,2\\right]^\\intercal,\\\\ \\mathbf{x}_3(0 ) & = & \\left[x_0,\\,\\,\\,y_0\\,\\,\\,\\psi_0\\,\\,\\,2\\,\\,\\,1\\right]^\\intercal,\\\\ \\mathbf{x}_4(0 ) & = & \\left[x_0,\\,\\,\\,y_0\\,\\,\\,\\psi_0\\,\\,\\,1\\,\\,\\,1\\right]^\\intercal.\\end{aligned}\\ ] ] the mixing probabilities or mode probabilities are initially set to : @xmath97^\\intercal,\\ ] ] and the mode transition probabilities matrix @xmath98 is set to : @xmath99",
    "the robot is required to follow a circular path for all experiments . to simulate the measurement additive white noise",
    "is added to the speed of the robot which is calculated as a part of the truth simulations of the robot movement .",
    "to test the filters four different test cases were set up and each test case was run twice . during the first run the fdi feedback loop is not closed and the filters are used for estimation only . the fdi loop is closed during the second run to investigate the behaviour of the full active ftc controller .",
    "the test cases are as follows : +    1 .   no fault .",
    "the objective is to investigate how well the filters estimate the radii of the tyres in a no fault situation .",
    "2 .   left wheel @xmath95 puncture . in this case",
    "a puncture is simulated to occur 10 secs into the simulation .",
    "the wheel is assumed to deflate to @xmath95 of its original value instantaneously .",
    "3 .   left and right wheel puncture . in this test case",
    "a left wheel puncture is simulated 5 secs into the run and a right wheel puncture is simulated to occur 10 secs into the simulation .",
    "both punctures are assumed to cause an instantaneous reduction of the respective wheel radius to @xmath95 of the original wheel radius .",
    "4 .   left wheel linear puncture . in this test case",
    "once again the left wheel is punctured 10 secs into the run however this time the puncture is assumed to follow a linear reduction in wheel radius according to @xmath100 , where @xmath84 represents the left wheel radius reduced from its original value of 2 m down to 0.1 m at a rate of 0.1 m/s and t is the current time . the radius does not drop to 0 m as this caused a complete system failure .",
    "+    the results for each filter are presented in the next four subsections :      plots of the speed innovation were produced ( but have been omitted due to space constraints ) where the innovations were plotted along with the calculated @xmath101 uncertainty bounds .",
    "the @xmath101 uncertainty bounds are a @xmath102 confidence interval and the solution ( innovations in this case ) must remain within the bounds @xmath102 of the time . the results for the ekf and ukf filters showed that the speed innovations remained well within the uncertainty bounds throughout the duration of the run both with and without feedback .",
    "the speed innovation plots for the imm filters were also produced .",
    "the results for both the ukf and ekf based imm filters showed that the filters were able to very quickly detect the correct mode of operation .",
    "+ plots of the wheel radius estimates were also produced .",
    "all filters do a very good job of estimating the radius of the tyres with and without feedback .",
    "the imm filters initially have a higher error in the tyre estimate as the estimation is based on a mixture of all the models , however it took only one update for the imm to reach the correct estimate .",
    "+ the wheel speed estimates ( or angular rates ) were also analysed and it was found that the estimates for all four filters were very similar . in the case of no feedback",
    "the estimate was the same as the actual speed ; however in the case where feedback is provided the wheel speeds were quite noisy .",
    "this is a result of calculations based on noisy measurements which is a consequence of feedback .",
    "+ plots of the robot trajectory for all four filters showed that the robot remained on the path with and without feedback which is to be expected in the no fault case .",
    "the speed innovations for all four filters were plotted and the results showed that all filters were able to detect the fault .",
    "the fault occurred at 10 secs into the run , and the plots show that at 10 seconds there was a peak change in the innovation curves .",
    "the corrections / innovations were seen to increase at the time the fault occurred and settle again near zero once the correct estimate was reached .",
    "+ for the imm filters model 3 is the correct match for scenario 2 and both of the imm filters were seen to find the correct mode immediately as mode 3 is the most confident in its estimate .",
    "mode 3 and mode 4 both hypothesise a failure in the left wheel of @xmath95 which is why after the occurrence of the fault the uncertainties do not increase .",
    "however because mode 1 and mode 2 do not hypothesise a fault in the left wheel the uncertainties can be seen to increase once the fault has occurred . the uncertainty in mode 3",
    "was seen to decrease twice as much compared to mode 4 after the fault occurred .",
    "this is because mode 4 hypothesises that both wheels are punctured whereas mode 3 predicts the puncture of only the left wheel .",
    "another point to note is that in the single filter cases feedback did not have much effect on the innovations .",
    "however , in the case of the imm filters the results show that with feedback the filter errors do not grow as rapidly between updates .",
    "the errors are seen to grow very quickly when no feedback is present which is evident in figures [ fig : chap4_scenario2_immukf_velocityerrors_nfb ] and [ fig : chap4_scenario2_immukf_velocityerrors_wfb ] .",
    "uncertainty bounds ( red ) , speed innovations ( blue ) ]     uncertainty bounds ( red ) , speed innovations ( blue ) ]    the results for the wheel radius estimates showed that the ukf estimates were closer to the actual wheel radius compared to those produced by the ekf . turning on feedback results in the filters reaching a steady estimate faster when compared to the no feedback case .",
    "the imm filters produced slightly better estimates than the single ukf filter and there was very little improvement on the imm estimates compared to the no feedback case . +",
    "the wheel speeds were also analysed and the results for all four filters presented the same trends . without feedback there is much more activity present compared to turning on the feedback .",
    "once the fault occurs the robot yaws to the side with the punctured wheel and demands a faster speed to compensate for the loss in radius . +",
    "the robot trajectories were simulated and all results showed that the robot was only able to remain on the path if feedback from the filter was provided to reconfigure the controller .",
    "although all filter estimates without feedback were excellent , without reconfiguration of the controller the robot could not be made to follow the desired path ( see figure [ fig : chap4_scenario2_traj_ukf ] ) .",
    "the plots of the speed innovations for all filters clearly indicated , from the sudden changes in innovations , the detection of both faults , left wheel at 5 secs and right wheel at 10 secs .",
    "the ekf innovations were found to be consistent , however the innovations produced by the ukf show that , with feedback , the innovation uncertainty begins to grow rapidly between updates whereas without feedback the uncertainty remains constant ( see figure [ fig : chap4_scenario3_ukf_velocityerrors ] ) .",
    "the imm filters show that after 5 secs model 3 is the best model .",
    "however , once the second fault occurs the filters do an excellent job of recognising that mode 4 is the correct match and uncertainties in mode 4 are seen to decrease ( see figure [ fig : chap4_scenario3_immekf_velocityerrors_wfb ] ) .",
    "it was again observed in the no feedback case that the uncertainties on the imm filters grow rapidly between updates and many more corrections are required .",
    "+     uncertainty bounds ( red ) , speed innovations ( blue ) ]     uncertainty bounds ( red ) , speed innovations ( blue ) ]    the wheel radius estimates produced by the filters showed that the imm filters produce the best estimates of the radii .",
    "the ukf performs slightly better than the ekf , and turning feedback on results in a faster settling time ( see figure [ fig : chap4_scenario3_ukf_wheelradius ] ) .",
    "+        plots of the angular rates achieved by the robot via the ekf showed that once a fault occurred the punctured wheel is required to spin faster in order to compensate for the loss in radius .",
    "the angular rates produced as a result of the ukf , with feedback , resulted in operation at the angular rate constraints .",
    "both imm filters displayed similar behaviour in that once a wheel was punctured it was required to rotate faster to compensate for the loss in radius . + the trajectories produced by each filter for scenario 3 showed that without feedback it is impossible to maintain the robot on the path . reconfiguring the controller on the other hand with estimates from the filters allowed the robot to easily follow the reference path .",
    "an anomaly occurred with the ukf filter where even turning the feedback on did not result in the robot following the path after the occurrence of the second fault .",
    "this could possibly be the result of poor tuning of the filter ( see figure [ fig : chap4_scenario3_traj_ukf ] ) .",
    "+          scenario 4 velocity innovations are presented in figures [ fig : chap4_scenario4_ekf_velocityerrors ] and [ fig : chap4_scenario4_ukf_velocityerrors ] for the ekf and ukf respectively .",
    "the ekf breaks down 5 seconds after the fault occurs , when feedback is turned on as can be seen by the innovations exceeding the covariance bounds . without feedback however the innovations remain within the uncertainty bounds .",
    "the results from the ukf are much better as it produces innovations which remain well within the uncertainty bounds with and without feedback .",
    "both of the imm filters failed , because the fault type of scenario 4 was not modelled as a part of the filter design , i.e. the hypothesis for this type of failure is not accounted for and so no model exists for this failure ( see figure [ fig : chap4_scenario4_immukf_velocityerrors_wfb ] ) .",
    "uncertainty bounds ( red ) , velocity innovations ( blue ) ]     uncertainty bounds ( red ) , velocity innovations ( blue ) ]     uncertainty bounds ( red ) , velocity innovations ( blue ) ]    the wheel radius estimates showed that without a hypothesis on the imm filters the ukf was the only filter able to produce the correct estimates of the wheel radii .",
    "the ukf results clearly indicated that reconfiguring the controller resulted in a faster convergence to the correct estimate .",
    "+ plots of wheel speed produced by all four filters with and without feedback show that with this type of fault both wheels were required to work at their constraints .",
    "+ the robot trajectories as a result of the different filter information were examined and it was found that none of the filters show full compliance with the reference trajectory",
    ". however the ukf was able to maintain the robot on the path the longest .",
    "- this section looks at the behaviour of the imm filters by re - designing the filters to accommodate the fault type covered by scenario 4 .",
    "the filters were modified by adding a fifth model , which hypothesises the left wheel puncturing in the manner described by scenario 4 .",
    "the @xmath88 and @xmath89 matrices remain the same and the initial state vectors for the fifth filter and mode are : @xmath103^\\intercal.\\end{aligned}\\ ] ] the mixing probabilities or mode probabilities become : @xmath104^\\intercal,\\ ] ] and the mode transition probabilities matrix @xmath98 is redefined as : @xmath105 the speed innovations for the imm ekf are presented in figures [ fig : chap4_scenario4_immekf_velocityerrors_nfb_5models ] and [ fig : chap4_scenario4_immekf_velocityerrors_wfb_5models ] with no feedback and with feedback respectively . as predicted the results show that if a hypothesis is made the imm performs very well .",
    "the ekf as part of imm is able to predict this type of error which it was unable to do as a single filter .",
    "the imm ukf speed innovation plots showed a higher level of confidence in its estimates compared to its ekf counterpart as the uncertainty is lower and consistent . providing feedback in both cases ( ekf and ukf imms )",
    "was shown to increase confidence in the filter estimates .",
    "uncertainty bounds ( red ) , velocity innovations ( blue ) ]     uncertainty bounds ( red ) , velocity innovations ( blue ) ]    the ukf based imm estimates of the wheel radii for the 5 mode imm are shown in figure [ fig : chap4_scenario4_immukf_wheelradius_5models ] .",
    "the results of both ekf and ukf based imms showed that in both cases the filters do an excellent job of making the correct estimations on the radius of the wheel .",
    "the angular rate plots of the 5 mode imms again showed that the control inputs are required to work at the constraints the majority of the time once the fault occurred .",
    "this result is not dependent on the filter type but rather the fault that has occurred makes it impossible for the robot to achieve the desired task while at the same time respecting its constraints .",
    "+ the trajectory plots showed that for this type of fault where the wheel radius had almost approached zero , the wheels are unable to maintain the reference .",
    "the ukf imm is again able to keep the robot on the path for a longer time than the ekf imm .",
    "the results of the previous section reveal that each of the filters considered exhibits excellent qualities for fault detection and identification .",
    "figure [ fig : radiicomparisons ] shows a comparison of the different filters in terms of wheel radius estimation .",
    "the plot shows the radius estimates for scenario 4 which is the worst case scenario out of the 4 scenarios considered .",
    "the output of the ekf and the 4 mode imm filters have been omitted from the plots as the errors were very high and as a consequence the remaining results were invisible .",
    "the plot shows that in terms of wheel radius estimate performance the ukf performed equally as well as the 5 mode imm filters .",
    "the imm filters were able to reach the correct estimate faster than the single ukf particularly when a sudden change is present as is evident at the 10 second mark .",
    "the ekf performance also dramatically increases when used within an imm configuration .",
    "the drawback of the imm filter is that all possible scenarios must be accounted for .",
    "the method used in this research illustrated the concept of the imm , by showing easy adaptability to different situations , and the speed with which it is able to identify and reach the correct estimate .",
    "however predicting exactly how a fault will occur ( in this case how a tyre will puncture ) is impractical . a more practical implementation",
    "would have been to develop a number of filters each with different process noises that could adapt to all different situations .",
    "the number of filters and the process noise values would have to be determined by trial and error . in any case",
    "an imm performs well if and only if it is equipped to make a hypothesis on the current situation . if the given situation is unaccounted for the filter breaks down . in terms of the single filter , in general the ukf displayed better performance than the ekf , especially in the case of scenario 4 where the non - linearities of the fault caused the single ekf to breakdown . for these reasons",
    "the ukf has been chosen for the final ftc system design .          as a result of the findings given in subsection [ subsection : chap4_fandc ]",
    "only the ukf with feedback is implemented to compare nonlinear mpc with linear mpc .",
    "the results given in the next two sections are for scenarios 2 and 4 respectively however plots for only scenario 2 are given due to space constraints .",
    "the velocity innovation plots in figure [ fig : chap4_scenario2_ukf_velocityerrors_linearmpc ] produced by the linear mpc controller show that the innovations remain well within the uncertainty bounds and are approximately zero .",
    "however the uncertainty was seen to be double that produced by the nonlinear controller .",
    "uncertainty bounds ( red ) , speed innovations ( blue ) ]    the wheel radii plots give in figure [ fig : chap4_scenario2_ukf_wheelradius_linearmpc ] show that the estimations produced by a nonlinear controller are the same as those produced by the linear controller .",
    "hence the filter performs well even with linear mpc .",
    "the angular rate plots for the linear mpc controller ( figure [ fig : chap4_scenario2_ar_ukf_linearmpc ] ) show that five seconds after the fault occurred the linear controller pushes the wheels to operate at their constraints and is unable to tolerate the faulty condition .",
    "the angular rates produced by the nmpc controller ( figure [ fig : chap4_scenario2_ar_ukf_nmpc ] ) show that it was able to easily adapt to the fault .",
    "this is further illustrated in the trajectory plot given in figure [ fig : chap4_scenario2_traj_ukf_linearmpc ] which clearly shows that the nonlinear mpc controller does an excellent job of keeping the robot on the path despite a faulty wheel whereas the solution produced by the linear controller has diverged .",
    "a point to note here is that while the trajectory tracking is good , the switching behaviour observed in wheel rotation rates is highly undesirable , and in the real world would produce wheel slippage , and high levels of wear on tyres and mechanicals .",
    "the wheel rates produced by the nonlinear mpc controller show a dramatic decrease in this switching behaviour .",
    "it is , however , still present ( figure [ fig : chap4_scenario2_ar_ukf_nmpc ] ) .",
    "this limit cycle behaviour is a negative characteristic that needs to be addressed before this technique can be applied to real systems .",
    "this exercise was purely for proof of concept and is not a practical application .",
    "the model is entirely kinematic and for it to represent a more practical scenario further work is required to eliminate the limit cycling behaviour ; for example adding actuation activity to the cost function and an angular acceleration term to avoid wheel slippage issues .",
    "the speed innovations were plotted for scenario 4 and showed similar trends to those above in that the innovations are quite small ; however the uncertainties with the linear controller are higher than those produced as a result of nonlinear mpc .",
    "the estimates of the wheel radii however are very good and were seen to be the same for both linear and nonlinear controllers . +",
    "as expected the linear controller was unable to maintain the robot on the path .",
    "neither of the controllers were able to drive the robot to the path as the wheel radius had almost reached 0 m making it infeasible for the robot to continue .",
    "the angular rates showed that the linear controller constantly demanded operation at the constraints oscillating between the upper and lower limits continuously .",
    "the nonlinear mpc controller results for wheel angular rates showed that the right wheel oscillates between the upper and lower bounds , however the left wheel is required to constantly work at the upper bound .",
    "the analysis from this work has proven the feasibility of the nmpc controller design with filter estimates for controller reconfiguration as a viable solution to fault tolerant control .",
    "four different filters were compared , the ekf , the ukf , the imm ekf and the imm ukf filters .",
    "the results showed that in terms of fault detection performance the ukf is the best candidate in a trajectory tracking scenario .",
    "+ comparisons were also made between the performance of nonlinear mpc and linear mpc .",
    "the results clearly show that for the purposes of reconfigurable fault tolerant control the nonlinear mpc controller has better performance .",
    "+ the next phase of this research is to implement the nmpc pseudospectral controller with a ukf based fdi subsystem to an aircraft , for fault tolerant flight control .",
    "9 khan , r. , williams , p. , riseborough p. , rao , a. and hill , r. , _ designing a nonlinear model predictive controller for fault tolerant flight control_. arxiv e - prints 2016 ; http://adsabs.harvard.edu/abs/2016arxiv160901529k , [ last accessed : 07 - 09 - 2016 ] .",
    "cork  lr , walker  r , dunn  s. _ fault detection , identification and accommodation techniques for unmanned airborne vehicles_. australian international aerospace congress ( aiac ) 2005 ; http://eprints.qut.edu.au/1729/ , [ last accessed : 07 - 01 - 2016 ] .",
    "boskovic  jd ,",
    "li  sm , mehra  rk .",
    "_ on - line failure detection and identification ( fdi ) and adaptive reconfigurable control ( arc ) in aerospace applications_. proceedings of the 2001 american control conference 2001 ; 4:26252626 .",
    "jiong - sang  y , bin  j , jian  lw , yan  l. _ discrete - time actuator fault estimation design for flight control application_. 7th international conference on control , automation , robotics and vision 2002 ; 3:1287 - 1292 .",
    "doi:10.1109/icarcv.2002.1234958 .",
    "wang  w , hameed  t , ren  z. _ extended state observer - based robust fault - tolerant controller for flight control surface failures_. icemi09 .",
    "9th international conference on electronic measurement & instruments 2009 ; 3610 .",
    "wan  ea , van der merwe  r. _ the unscented kalman filter for nonlinear estimation_. the ieee 2000 adaptive systems for signal processing , communications , and control symposium 2000 ; 153 - 158 . doi:10.1109/asspcc.2000.882463"
  ],
  "abstract_text": [
    "<S> this paper develops a new active fault tolerant control system based on the concept of analytical redundancy . </S>",
    "<S> the novel design consists of an observation filter based fault detection and identification system integrated with a nonlinear model predictive controller . </S>",
    "<S> a number of observation filters were designed , integrated with the nonlinear controller and tested before reaching the final design which comprises an unscented kalman filter for fault detection and identification together with a nonlinear model predictive controller to form an active fault tolerant control system design .    </S>",
    "<S> keywords : fault tolerant control , fault detection and identification , model predictive control , nonlinear control , observation filters . </S>"
  ]
}