{
  "article_text": [
    "it is well known ( see for example @xcite ) that constraint satisfactions problems , which provide a formulation for many combinatorial problems , can be stated as the problem of finding a homomorphism between structures . moreover ( @xcite ) any such homomorphism problem can be reduced to the retraction problem for _ reflexive _ graphs- graphs in which every vertex has a loop .",
    "the problem @xmath1 of retraction to @xmath0 is @xmath2-complete for most reflexive graphs @xmath0 and in the case that the problem is known to be polynomial time solvable for some @xmath0 , the polynomial time algorithm is tied to the existence of a _ polymorphism _ on @xmath0 an operation @xmath3 that preserves edges satisfying some nice identity .",
    "a reflexive graph @xmath0 is a _ lattice _",
    "graph if it has a _ compatible lattice _ , a lattice on its vertex set such that the meet and join operations , @xmath4 and @xmath5 , are polymorphisms of @xmath0 .",
    "it is a _ distributive lattice graph _ or _",
    "@xmath6-graph _ if the lattice @xmath7 is distributive ; we call @xmath8 a _ @xmath6-pair_.    it was shown in @xcite that @xmath1 can be solved , for a structure @xmath0 , by a linear monadic datalog program with at most one extensional predicate per rule , ( i.e. , @xmath0 has caterpillar duality ) , if and only if it is a retract of a @xmath6-graph .    to give a bit more context , a @xmath9-ary polymorphism @xmath10 is a _ totally symmetric idempotent _ ( @xmath11 ) polymorphism if @xmath12 for all @xmath13 and if @xmath14 whenever @xmath15 .",
    "the class @xmath11 of reflexive graphs @xmath0 admitting @xmath11 polymorphisms of all aritites is important , as this is the class for which @xmath1 can be solved by a monadic datalog program with at most one extensional predicate per rule , ( i.e. , @xmath0 has tree duality ) .",
    "it is of interest to get a graph theoretic characterisation of the class @xmath11 .",
    "the two main sources of @xmath11 polymorphisms , are near - unanimity ( @xmath16 ) polymorphisms , and semilattice ( @xmath17 ) polymorphisms .",
    "while @xmath16 polymorphisms have been well studied , and the classes of graphs admitting them have several nice characterisations , no such study had been attempted for @xmath17 polymorphisms until @xcite , where we looked at the family of reflexive graphs admitting @xmath17 polymorphisms .",
    "a ( meet ) semilattice ordering on the vertices of a graph defines a @xmath18-ary operation @xmath5 on the vertex set .",
    "if this operation is a polymorphism of the graph then it is an _",
    "@xmath17 polymorphism _ of the graph .",
    "the problem of characterising reflexive graphs admitting @xmath17 polymorphsims was difficult , and we restricted our attention to those graphs @xmath0 that admit @xmath17 polymorphisms for which the hasse diagram of the semilattice ordering is a tree , and a subgraph of @xmath0 .",
    "we showed that the class of such graphs extends the class of chordal graphs .",
    "we were unable to say much in the case that the semilattice was not a tree .",
    "the other extreme is when the ordering is a lattice the hasse diagram is not a tree except in the trivial case that the lattice it is a chain .",
    "this leads us to consider lattice polymorphisms .      in this paper",
    "we give two explicit characterisations of the class of reflexive @xmath6-graphs , and use these characterisations to address the problem of recognition .    for our first characterisation",
    ", we recall a well known result of birkhoff @xcite . for a poset @xmath19 ,",
    "a subset @xmath20 is a _ downset _ if @xmath21 and @xmath22 implies @xmath23 .",
    "the family @xmath24 of all downsets of @xmath19 is a distributive lattice under the ordering @xmath25 .",
    "the meet and join operations are @xmath26 and @xmath27 , respectively .",
    "birkhoff showed that for any distributive lattice @xmath7 , @xmath7 is isomorphic to @xmath28 for a unique poset @xmath29 , ( the poset of join irreducible elements of @xmath7 ) .    viewing a comparability @xmath22 as an arc @xmath30 ,",
    "a poset @xmath19 is just a transitive acyclic ( except for loops ) reflexive digraph .",
    "so we can talk of a sub - digraph @xmath31 of @xmath19 .",
    "[ def : gpa ] for a poset @xmath19 and a sub - digraph @xmath31 of @xmath19 , let @xmath32 be the graph on @xmath24 , in which two downsets @xmath33 are adjacent if @xmath31 contains all arcs @xmath34 of @xmath19 for which @xmath35 and @xmath36 are in either @xmath37 or @xmath38 .",
    "see figure [ fig : gpa ] for an example .",
    "the left side shows a poset @xmath19 represented by its hasse diagram ( defined in section [ sec : def ] ) in thick light edges , and a sub - digraph @xmath31 in dark edges , missing only the arc @xmath39 . on the right",
    "is the downset lattice @xmath24 again represented by its hasse diagram , and the graph @xmath40 missing only edges between vertices one of which contains @xmath41 and @xmath42 and the other of which contains neither of them .",
    "( 8,5)(0,0 ) ( 0,0 ) and lattice @xmath24 in thick light edges .",
    "digraph @xmath31 and ( the complement of ) graph @xmath40 in dark . , title=\"fig:\",width=302 ] ( 1.3,0 ) ( 1.1,1.3 ) ( 2.6,1.3 ) ( 1.3,3.2 ) ( 2.7,3.2 ) ( 4.2,0 ) ( 5.6,0.4 ) ( 4.2,1.1 ) ( 6.3,1.1 ) ( 5.8,2.4 ) ( 7.6,2.4 ) ( 4.0,3.7 ) ( 6.3,3.7 ) ( 5.2,4.7 )    our first main theorem , theorem [ thm : char2 ] says that for any @xmath6-pair @xmath8 , @xmath0 is isomorphic to @xmath43 for some sub - digraph @xmath31 of @xmath29 . showing , in lemma [ lem : pographiscompat ] that @xmath40 is always a @xmath6-graph , we get the following characterisation of reflexive @xmath6-graphs .",
    "[ cor : char2 ] a reflexive graph @xmath0 is a @xmath6-graph if and only if there is there is a poset @xmath19 and a sub - digraph @xmath31 such that @xmath44 .    in @xcite",
    "it was shown that a graph ( without loops ) is a _ proper interval graph _ if and only if there is an ordering of its vertices such that if it satisfies the so - called _ min - max _ identity : @xmath45 we take this as our definition of a proper interval graph in the reflexive context , and say a proper interval graph is in _ min - max form _ if its vertices are labelled @xmath46 for some @xmath47 so that it satisfies .",
    "simple arguments ( see fact [ fact : ids ] ) show that any reflexive graph that is compatible with a chain lattice is a proper interval graph .",
    "as any distributive lattice is embeddable in a product of chains , it follows that any @xmath6-graph is a subgraph of a categorical product ( defined in section [ sec : def ] ) of proper interval graphs .",
    "in fact dilworth @xcite showed , and we recall this in more detail in section [ sec : main2 ] , that any chain decomposition of @xmath19 yields an embedding of @xmath24 into a product of chains . the embedding shown in figure [ fig : gpa ] comes from the decomposition of @xmath19 into the chains @xmath48 and @xmath49 .",
    "figure [ fig : pi ] shows the embedding corresponding to the decomposition of @xmath19 into the chains @xmath50 , @xmath51 , and @xmath9 . for the embedding in figure [ fig : pi ] the graph @xmath40 is an induced subgraph of proper interval graphs , in this case paths , on the chain factors .",
    "it turns out that this happens when certain edges in the complement of @xmath31 in @xmath19 are contained in the chain decomposition of @xmath19 .    for any @xmath6-pair @xmath8",
    ", we get , in theorem [ thm : embedding ] , an embedding of @xmath7 into a product of chains such that @xmath0 is an induced subgraph of @xmath52 .",
    "further , it is an induced subgraph of quite a particular form .",
    "the vertex set of a product @xmath53 of proper interval graphs @xmath54 is a set of @xmath9-tuples @xmath55 for some @xmath56 .",
    "vertex interval _ of @xmath52 is the set @xmath57 } } , { { \\beta}^{[j]}}]}}= \\ { x \\in v(\\cg ) \\mid   \\alpha \\leq x_i \\mbox { and } x_j \\leq \\beta \\}\\ ] ] for some @xmath58 $ ] , @xmath59 and @xmath60 .",
    "( see right side of figure [ fig : pi ] . )",
    "( 14,5)(0,0 ) ( 6,0 ) from figure [ fig : gpa ] embedded in a product of three chains , and the graph @xmath40 from figure [ fig : gpa ] embedded as an induced subgraph of the product of paths on those chains .",
    "right : the usual labelling on the product of chains showing @xmath24 as @xmath61 } } , { { 0}^{[1 ] } } ] } - { [ { { 2}_{[1 ] } } , { { 0}^{[3]}}]}$].,title=\"fig:\",width=302 ] ( 8.1,-0.1 ) ( 9.7,.4 ) ( 10.9,1.5 ) ( 11.9,2.6 ) ( 11.9,3.7 ) ( 8 , .7 ) ( 10 , 4.4 ) ( 7.2 , 2.0 ) ( 7.2 , 2.0 ) ( 0,0 ) from figure [ fig : gpa ] embedded in a product of three chains , and the graph @xmath40 from figure [ fig : gpa ] embedded as an induced subgraph of the product of paths on those chains .",
    "right : the usual labelling on the product of chains showing @xmath24 as @xmath61 } } , { { 0}^{[1 ] } } ] } - { [ { { 2}_{[1 ] } } , { { 0}^{[3]}}]}$].,title=\"fig:\",width=302 ] ( 2.7,-0.1 ) ( 4,.5 ) ( 4.9,1.5 ) ( 5.9,2.5 ) ( 5.9,3.7 ) ( 3,2.1 ) ( 2.8,3.1 ) ( 4.6,3.25 ) ( 4.8,2.5 ) ( 2.3 , .9 ) ( 2.1 , 2.1 ) ( 4 , 4.4 )    our following , second , characterisation of reflexive @xmath6-graphs is immediate from theorem [ thm : embedding ] .    [ cor : charpi ] a reflexive graph @xmath0 is a @xmath6-graph if and only if it is the induced subgraph of a product @xmath62 of proper interval graphs @xmath54 in min - max form , that we get by removing vertex intervals .",
    "a reflexive graph @xmath0 is @xmath63-thin if no two vertices have the same neighbourhood . for questions of @xmath1",
    ", one may always assume that @xmath0 is @xmath63-thin as there are simple linear time reductions between @xmath1 and @xmath64 where @xmath65 , defined formally in section [ sub : nrthin ] , is the @xmath63-thin graph we get from @xmath0 by removing all but one vertex from every set of vertices sharing the same neighbourhood .",
    "in section [ sect : recog ] we prove the following .    [ thm : poly ] there is a polynomial time algorithm to decide whether or not an @xmath63-thin reflexive graph is a @xmath6-graph .    in fact , we give a polynomial time algorithm that not only decides if a given @xmath63-thin graph has a compatible distributive lattice , but if it does , finds one ( actually all ) such lattices .    while for questions about @xmath1 one may assume that @xmath0 is @xmath63-thin , distributive lattice polymorphisms are unusual in the fact that the existence of a compatible distributive lattice for @xmath65 does not imply the existence of one for @xmath0 .",
    "we finish of section [ sect : recog ] with some notes about deciding if a non @xmath63-thin graph is a @xmath6-graph .",
    "for any element @xmath66 of any ordering , @xmath67}$ ] is the set of elements below @xmath66 , and @xmath68 is the set of elements above it .",
    "we write @xmath69 if @xmath41 _ covers _ @xmath50 ; that is , if @xmath70 and there is no @xmath35 such that @xmath71 . it is standard to depict a poset by it s",
    "hasse diagram its sub - digraph of covers and to depict direction of the covers simply by assuming that the greater element is higher on the page .",
    "as we draw a lattice and a graph on the same set of vertices , the edges of our hasse diagram are the thicker lighter edges , and the graph edges are thin and dark .",
    "recall that a _ lattice _ @xmath7 is a partial ordering on a set such that the greatest lower bound and least upper bound are uniquely defined for any pair of elements .",
    "these define the meet , @xmath4 , and join , @xmath5 , operations respectively .",
    "it is a basic fact that the operations @xmath4 and @xmath5 and the lattice defined each other by the identities @xmath72 the lattice is _ distributive _ if the meet and join distribute . as our lattices are finite the meet and join operations are well defined for any set of elements and there is a maximum element , or _",
    ", denoted @xmath73 , and a minimum element or _",
    "zero _ denoted @xmath74 .",
    "a lattice @xmath7 on the vertices of a graph @xmath0 was defined to be compatible if its meet and join operations @xmath4 and @xmath5 are polymorphisms .",
    "explicitly , @xmath7 is compatible with @xmath0 if and only if the following holds , where ` @xmath75 ' denotes adjacency in @xmath0 : @xmath76    along with , there is another useful property of an ordering of vertices .",
    "[ fact : ids ] for a compatible lattice ordering of a reflexive graph @xmath0 identities and hold for all vertices @xmath78 of @xmath0 .    for , as @xmath79 we get @xmath80 and @xmath81 , as needed . for ,",
    "assuming that @xmath82 , we get @xmath83 .",
    "the product @xmath84 of two lattices is the ordering on the set @xmath84 defined by @xmath85 and the operations @xmath5 and @xmath4 of the product are defined componentwise from the corresponding operations of the factors .",
    "thus the product of distributive lattices is a distributive lattice .",
    "the _ ( categorical ) product _ of two graphs @xmath86 and @xmath87 , is the graph @xmath88 with vertex set @xmath89 and edgeset @xmath90    the following is standard .",
    "[ lem : product ] if the reflexive graph @xmath54 is compatible with the lattice @xmath91 for @xmath92 then @xmath93 is compatible with @xmath84 .",
    "let @xmath94 and @xmath95 in @xmath93 .",
    "then @xmath96 and similarly @xmath97 .    a sublattice @xmath98 of a lattice @xmath7 is any subset that is closed under the meet and join operations .",
    "the following is clear from the definition of compatibility .",
    "[ fact : sublat ] if a graph @xmath0 is compatible with a lattice @xmath7 , and @xmath98 is a sublattice of @xmath7 , then the subgraph @xmath99 of @xmath0 induced by @xmath98 is compatible with @xmath98 .",
    "a _ conservative set _ ( or subalgebra ) in a reflexive graph @xmath0 is an subset @xmath100 that is the intersection of sets of the form @xmath101 for some vertex @xmath102 and integer @xmath9 .",
    "components and maximal cliques are examples of conservative sets .",
    "it is a basic fact , ( see @xcite ) , that a conservative set of a graph is closed under any polymorphism .",
    "we use this to prove the following , which allows us to restrict our attention to connected graphs .",
    "[ lem : connected ] a graph is a ( distributive ) lattice graph if and only if each component is .",
    "if a graph is disconnected , and each of its components has a compatible lattice @xmath91 , then let @xmath7 be the _",
    "simple join _ of the component lattices ; that is , let @xmath7 be the lattice on the set @xmath103 with the ordering defined by @xmath104 if @xmath104 in some @xmath91 or if @xmath105 and @xmath106 for @xmath107 .",
    "it is easy to check that this lattice is compatible with @xmath0 , and that it is distributive if the component lattices are .    on the other hand ,",
    "if a disconnected graph has a compatible lattice , then as each component is a subalgebra , and subalgebras are closed under polymorphisms , each component is closed under the lattice operations . thus each component induces a sublattice , so is compatible with the component by fact [ fact : sublat ] .",
    "if a lattice is distributive , then so is any sublattice .",
    "the following , which does not hold for semilattices , is a huge simplifaction .",
    "[ prop : hassesubgraph ] for a connected reflexive graph @xmath0 with a compatible lattice @xmath7 , the hasse diagram of @xmath7 is a subgraph of @xmath0 .",
    "it is enough to show for any cover @xmath108 , that @xmath109 is an edge of @xmath0 .",
    "observe first that the upset @xmath110 is a connected subgraph of @xmath0 . indeed as @xmath0 is connected , for @xmath111 and @xmath112 in @xmath110",
    ", there is a path @xmath113 between them in @xmath0 .",
    "so @xmath114 is a walk between them in @xmath110 .",
    "the same proof in connected @xmath110 then shows that the downset @xmath67}$ ] in @xmath110 is connected .",
    "but it contains only @xmath66 and @xmath115 , so @xmath109 is an edge .",
    "as all but the minimum and maximum vertex of a lattice must have at least one cover and be covered by one other vertex , the following is immediate from proposition [ prop : hassesubgraph ] .",
    "[ ex : degone ] for a connected reflexive graph @xmath0 with a degree one vertex @xmath115 , @xmath115 must be the minimum or maximum vertex of any compatible lattice @xmath7 .",
    "in particular , the only reflexive trees with compatible lattices are paths .",
    "( 1,0.43333335)(-.2,0 ) ( 0,0 ) ( 0.46666669,0.02500007)(0,0)[lb ] ( 0.46666669,0.36666671)(0,0)[lb ] ( 0.45833336,0.10833334)(0,0)[lb ] ( 0.38553573,0.14279105)(0,0)[lb ] ( 0.49388894,0.14195102)(0,0)[lb ] ( 0.45693121,0.18394846)(0,0)[lb ] ( 0.45273149,0.23854504)(0,0)[lb ] ( 0.34437829,0.19822752)(0,0)[lb ] ( 0.54596561,0.20326726)(0,0)[lb ] ( 0.3905754,0.26206356)(0,0)[lb ] ( 0.50396828,0.25366398)(0,0)[lb ] ( 0.4636508,0.29230159)(0,0)[lb ]    [ prop : badretracts ] neither the class of graphs admitting compatible lattices , nor the class admitting compatible distributive lattices , are closed under retraction .",
    "it is easy to see that the reflexive biclique @xmath116 is a retract of the product @xmath117 of two reflexive paths .",
    "@xmath117 has a distributive lattice by lemma [ lem : product ] , but @xmath116 does not , by example [ ex : degone ] .",
    "[ ex : bigone ] there are graphs that have compatible lattices but have no compatible distributive lattices .",
    "let @xmath0 be the graph on the left of figure [ fig : lnotdl ] .",
    "it is easy but tedious to verify , using that the non - distributive lattice shown on the right is compatible .",
    "we show that there is no distributive lattice that is compatible with @xmath0 .",
    "assume , towards contradiction , that @xmath0 has a compatible distributive lattice . by proposition [ prop : hassesubgraph ] ,",
    "@xmath74 and @xmath73 must be the vertices labelled @xmath118 and @xmath119 in the figure .",
    "further @xmath74 must have unique cover @xmath50 and @xmath73 must cover @xmath120 .",
    "so @xmath121 } \\cap { [ a \\bm{\\rangle}}$ ] is a distributive sublattice with zero @xmath50 and unit @xmath120 .    as the set @xmath122 is the intersection of maximal cliques , it is a conservative set , so induces a sublattice .",
    "the only @xmath18 element lattices is the chain , so we may assume , without loss of generality , that @xmath123 .",
    "the set @xmath124 is also an intersection of maximal cliques , so induces a sublattice of three elements , so must also be a chain .",
    "if @xmath125 then by @xmath50 and @xmath126 are adjacent , so @xmath127 . similarly @xmath128 .",
    "the set @xmath129 is a maximal clique , so induces a lattice .",
    "as @xmath41 is not adjacent to @xmath50 or @xmath120 , it follows from that it can neither be above or below @xmath9 or @xmath130 , so it is incomparable with them .",
    "thus the sublattice induced on @xmath129 is as shown in the figure .",
    "it is well known that no lattice with this lattice as a sublattice is distributive .",
    "our main result of this section is theorem [ thm : char2 ] .",
    "before we prove it , we make some easy observations about the construction @xmath40 of definition [ def : gpa ] . recall that @xmath31 is a sub - digraph of a poset @xmath19",
    "; it will always have the same vertex set as @xmath19 we write @xmath131 to mean that @xmath30 is an arc of @xmath31 .",
    "an arc @xmath132 of @xmath19 is _ useless _ in a sub - digraph @xmath31 if there is @xmath133 with @xmath134 ( and @xmath135 or @xmath136 ) .",
    "removing all useless arcs from @xmath31 it clearly satisfies the following directed version of @xmath137    [ lem : extension1 ] the graph @xmath40 is unchanged by adding or removing useless arcs from @xmath31 .",
    "thus @xmath31 may be assumed to satisfy .",
    "let @xmath134 , and @xmath138 in @xmath31 .",
    "for any two downsets @xmath20 and @xmath139 of @xmath19 with @xmath140 in @xmath37 , we clearly have that @xmath141 are in @xmath37 as well , and so @xmath142 in @xmath40 whether @xmath143 or not .",
    "for a sub - digraph @xmath31 of a poset @xmath19 , let @xmath144 be the sub - digraph of @xmath19 with arc set @xmath145 the following is a useful alternate definition of adjacency in @xmath40 .",
    "[ lem : altgpa ] where @xmath31 is a sub - digraph of a poset @xmath19 , and @xmath20 and @xmath139 are in @xmath24 , @xmath20 and @xmath139 are adjacent in @xmath40 if and only if the following hold for all vertices @xmath35 and @xmath36 .    * if @xmath146 and @xmath147 then @xmath148 , and * if @xmath149 and @xmath147 then @xmath150 .",
    "the definition of adjacency of @xmath20 and @xmath139 is clearly equivalent to the statement that neither of @xmath37 or @xmath38 induce an edge of @xmath144 .",
    "that @xmath37 induces no edge in @xmath144 is equivalent to the statement that for all @xmath151 in @xmath144 with @xmath141 in @xmath20 , either @xmath152 or @xmath153 .",
    "as @xmath20 and @xmath139 are downsets , this reduces to the statement that for all @xmath151 in @xmath144 with @xmath146 , @xmath152 .",
    "[ thm : char2 ] for any reflexive graph @xmath0 compatible with a distributive lattice @xmath7 , @xmath154 for a unique sub - digraph @xmath31 of @xmath29 satisfying .",
    "let @xmath0 be compatible with a distributive lattice @xmath7 .",
    "by @xcite we have that @xmath155 , so we denote vertices of @xmath0 by downsets of the poset @xmath29 .",
    "we define a sub - digraph @xmath156 of @xmath29 as follows . for a vertex @xmath157 of @xmath29 ,",
    "let @xmath158 be the maximum downset not containing @xmath157 . for each arc @xmath159 of @xmath29 ,",
    "let @xmath159 be in @xmath31 if @xmath160 } \\cap c_y$ ] and @xmath160}$ ] are adjacent in @xmath0 . we show that @xmath154 .",
    "let @xmath20 and @xmath139 be adjacent downsets of @xmath29 . to show that @xmath20 and @xmath139 are adjacent in @xmath43 , it is enough to show , without loss of generality , that any arc @xmath161 for @xmath162 , is in @xmath31 .",
    "so we must show that @xmath160 } \\cap c_y$ ] and @xmath160}$ ] are adjacent . as @xmath163 and @xmath160 } \\sim { \\bm{\\langle } x ] } $ ] in @xmath0 we have that @xmath164 } \\cap d ' ) \\sim ( { \\bm{\\langle } x ] } \\cap",
    "d ) = { \\bm{\\langle } x ] } .\\ ] ] but as @xmath152 we have that @xmath165 , and so we also have @xmath166}\\cap d ' \\leq { \\bm{\\langle } x ] } \\cap c_y   \\leq { \\bm{\\langle } x ] } ; \\ ] ] and so by we get @xmath160 } \\sim ( { \\bm{\\langle } x ] } \\cap c_y)$ ] , as needed .",
    "on the other hand , let @xmath20 and @xmath139 be non - adjacent downsets of @xmath29 .",
    "then we must show that there is some arc @xmath161 for @xmath162 or @xmath167 that is not in @xmath31 .",
    "assume that all such arcs with @xmath162 are in @xmath31 .",
    "then for each , we saw above that @xmath160 } \\sim ( { \\bm{\\langle } x ] } \\cap c_y)$ ] .",
    "fixing @xmath35 and taking the intersection over all @xmath168 in @xmath37 , we get @xmath166 } = \\bigcap { \\bm{\\langle } x ] } \\sim \\bigcap ( { \\bm{\\langle } x ] } \\cap c_y ) = \\bigcap ( { \\bm{\\langle } x ] } { - } { [ y \\bm{\\rangle } } )         = : t_x\\ ] ] where @xmath169 } { -}\\bigcup { [ y \\bm{\\rangle}}$ ] is contained in @xmath160 } { -}d'$ ] as the union is over all @xmath168 that are in @xmath37 . now taking the union over all @xmath170",
    "we get that @xmath171 } \\sim \\bigcup t_x \\subseteq \\bigcup ( { \\bm{\\langle } x ] } { -}d ' ) \\subseteq ( d { -}d').\\ ] ] by we get that @xmath172 .",
    "similarily we get that @xmath173 . but as @xmath174 we get from that @xmath175 , a contradiction .",
    "now , lemma [ lem : extension1 ] allows us to assume that @xmath31 satisfies .",
    "the uniqueness of @xmath31 then follows by observing that @xmath176 would be different for any other sub - digraph @xmath177 of @xmath29 satisfying : this is simple let @xmath178 be an arc of @xmath177 but not @xmath31 .",
    "then the edge @xmath160 } \\sim { \\bm{\\langle } y ] } $ ] is in @xmath176 but not in @xmath43 .",
    "corollary [ cor : char2 ] is immediate from theorem [ thm : char2 ] and the following lemma .",
    "[ lem : pographiscompat ] if @xmath19 is a poset and @xmath179 , then @xmath24 is compatible with @xmath32 .",
    "we use lemma [ lem : altgpa ] for the definition of adjacency in @xmath0 .",
    "assume that @xmath175 and @xmath180 .",
    "we must show that @xmath181 and @xmath182 . for",
    "the former , let @xmath183 and @xmath184 be in @xmath144 .",
    "then @xmath146 or @xmath185 , so as @xmath175 and @xmath180 , we have that @xmath148 or @xmath186 .",
    "thus @xmath187 . that @xmath188 implies @xmath189 is the same , so @xmath181 .",
    "the proof of the latter is similar .",
    "now , consider @xmath190 where @xmath191 is a chain .",
    "all downsets are of the form @xmath192}$ ] for some @xmath193 , or @xmath194}$ ] . as we may assume that @xmath31 satisfies , two downsets @xmath160}$ ] and @xmath195}$ ] , for @xmath168 are adjacent if and only if @xmath196 is an arc of @xmath31 .",
    "the following is then clear , and is the starting point of our next characterisation of reflexive @xmath6-graphs .",
    "[ fact : pi ] for a chain @xmath191 and a sub - digraph @xmath31 , @xmath190 satisfies , so is a proper interval graph .",
    "assume that @xmath67 } \\subsetneq { \\bm{\\langle } v ] } \\subsetneq { \\bm{\\langle } w ] } \\mbox { and } { \\bm{\\langle } u ] } \\sim { \\bm{\\langle } w ] } $ ] in @xmath190 .",
    "so @xmath197 and @xmath198 in @xmath31 .",
    "as we may assume that @xmath31 satisfies we have @xmath199 and @xmath200 in @xmath31 , and so @xmath67 } \\sim { \\bm{\\langle } v ] } $ ] and @xmath201 } \\sim { \\bm{\\langle } w ] } $ ] .",
    "in this section we prove theorem [ thm : embedding ] and give some related results .",
    "[ thm : embedding ] for any @xmath6-pair @xmath8 , there is an embedding @xmath202 , where @xmath203 is a union of intervals of the form @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] , of @xmath7 into a product @xmath205 of chains .",
    "further , for each @xmath206 there is a proper interval graph @xmath54 compatible with @xmath206 such that @xmath0 is the subgraph of @xmath62 induced by vertices in @xmath7 .    before proving this",
    ", we observe that this gives corollary [ cor : charpi ] .",
    "if @xmath0 is a @xmath6-graph then theorem [ thm : embedding ] gives us the necessary embedding of @xmath0 into a product of proper interval graphs .",
    "on the other hand , assume we get @xmath0 from a product @xmath207 of proper interval graphs @xmath54 in min - max form by removing vertex intervals @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] .",
    "the ordering on the @xmath54 is a chain lattice @xmath206 , so induces on @xmath208 a lattice @xmath205 . by a result in @xcite , the subset induced by removing sets of the form @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] is a sublattice .",
    "by fact [ fact : sublat ] it is therefore compatible with the subgraph @xmath0 of @xmath52 that it induces .",
    "we start with some results from the literature that will help us prove theorem [ thm : embedding ] .",
    "the first statement of theorem [ thm : embedding ] is acually from @xcite .",
    "we explain , as we will have to build on this . generalising the notion of a _ chain decomposition _ in which the subchains must be disjoint , a _ chain cover _ of a poset @xmath19 is family @xmath209 of subchains of @xmath19 such that every element of @xmath19 is in one chain .",
    "given @xmath210 , label the elements of @xmath19 so that the subchain @xmath211 is @xmath212 for some @xmath213 ; if an element is in more than one chain , it gets more than one label .",
    "it is clear that a downset @xmath20 of @xmath19 is uniquely defined by the tuple @xmath214 where @xmath215 .",
    "( note that @xmath20 is thus the downset generated by the set @xmath216 \\}$ ] . )    as dilworth @xcite observed in the case that @xmath210 is a decomposition , we observed in @xcite that @xmath217 is in fact a lattice embedding of @xmath24 into the product of chains @xmath218 where @xmath206 is the chain @xmath219 with one more element than @xmath211 .",
    "thus by birkoff s result from @xcite , every chain cover of @xmath29 gives an embedding @xmath217 of @xmath7 as a sublattice of a product @xmath220 of chains . in ( corollary 6.6 of )",
    "@xcite we showed that every embedding of @xmath7 as a sublattice of a product of chains such that @xmath7 contains the zero and unit of the product , is @xmath217 for some chain cover @xmath210 of @xmath29 .",
    "the following notation will also be useful , and explains the notation @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] . given a product of chains @xmath218 , let @xmath221}}}= ( \\underbrace{0,\\dots,0,\\alpha}_{i},0,\\dots,0 ) \\qquad \\mbox { and } \\qquad { { { \\beta}^{[j]}}}= ( n_1 , \\dots , n_{j-1},\\beta , n_{j+1 } , \\dots , n_d)\\ ] ] for all @xmath58 $ ] and @xmath222 with @xmath223 and @xmath224 .",
    "let @xmath8 be a @xmath6-pair , so by theorem [ thm : char2 ] , @xmath225 for some sub - digraph @xmath31 of @xmath29 , and let @xmath210 be a chain cover of @xmath29",
    ". for each chain @xmath226 let @xmath227 be the subgraph of @xmath31 induced by the vertices of @xmath211 .",
    "by fact [ fact : pi ] we have that @xmath228 , on the chain @xmath206 is a proper interval graph .",
    "let @xmath229 be the product of these proper interval graphs .",
    "the embedding @xmath230 embeds @xmath231 as a subset of @xmath208 .    in @xcite , we observed the following , using a result of @xcite .    where @xmath7 is the image of the embedding @xmath230 , @xmath232 where @xmath203 is the union , over comparable pairs @xmath233 in @xmath29 , of the intervals @xmath234 } } , { { \\beta}^{[j ] } } ] } =   \\ { x \\in \\cp_\\cc \\mid \\alpha \\leq x_i \\mbox { and } x_j \\leq \\beta \\}.\\ ] ]    so any chain cover @xmath210 of @xmath29 yields an embedding of @xmath7 into @xmath220 as required by the first statement of theorem [ thm : embedding ] .",
    "to show that @xmath0 can be taken as an induced subgraph of @xmath52 we need a similar statement about how the edges of @xmath0 relate to those of @xmath52 .",
    "we get this by looking at how our construction @xmath43 behaves notationally under the embedding @xmath217 .    to finish proving theorem [ thm : embedding ] we must show that @xmath217 embeds @xmath0 as an induced subgraph of @xmath52 .",
    "this is not true of every chain cover @xmath210 , but every chain cover embeds it as a subgraph .    for each @xmath235 $ ] and @xmath223 and @xmath224 , let @xmath236 } }",
    "\\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } : = \\left\\ { \\{x , y\\ } \\mid \\alpha",
    "\\leq x_i \\mbox { and }             y_j \\leq \\beta \\right\\}.\\ ] ]    [ lem : tight ] where @xmath210 is a chain cover of @xmath29 , @xmath225 is a subgraph of the product @xmath207 of proper interval graphs @xmath237 .",
    "in fact @xmath238 where @xmath239 } } , { { \\beta}^{[j]}}]}}\\mid { { { ( \\beta + 1)}^{(j)}}}\\leq { { { \\alpha}^{(i)}}}\\in j_l \\ } \\\\            \\ce = \\bigcup \\ { { { { [ { { \\alpha}_{[i ] } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } } \\mid { { { ( \\beta + 1)}^{(j)}}}\\to { { { \\alpha}^{(i)}}}\\in { { a^{\\rm c } } } \\}.         \\end{gathered}\\ ] ]",
    "let @xmath240 and @xmath241 be downsets of @xmath29 and let @xmath242 and @xmath243 .    if @xmath244 we have in particular that for each @xmath245 , @xmath246 if @xmath247 and @xmath248 if @xmath249 .",
    "so @xmath250 in @xmath251 .",
    "this shows that @xmath0 is a subgraph of @xmath52 .",
    "as we mentioned above , it follows from @xcite that @xmath252 so we are done with the following claim .",
    "vertices @xmath35 and @xmath36 of @xmath0 are non - adjacent in @xmath0 if and only if there is some arc @xmath253 in @xmath144 such that @xmath254 is in the set @xmath255 } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } $ ] of edges of @xmath52 .",
    "let @xmath240 and @xmath241 be the downsets of @xmath29 for which @xmath256 and @xmath257 .",
    "then @xmath258 if and only if there is some @xmath253 in @xmath144 with @xmath259 in @xmath260 ( or @xmath261 , but wlog we assume the former ) .",
    "this is true if and only if @xmath262 but since @xmath253 in @xmath144 we certainly have that @xmath233 in @xmath29 , so @xmath35 and @xmath36 are not in @xmath263 } } , { { \\beta}^{[j]}}]}$ ] .",
    "this means that neither of @xmath264 hold . as and",
    "the negation of are logically equivalent to @xmath265 we get the claim .",
    "this completes the proof of the lemma .",
    "now many of the sets @xmath266 } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } } $ ] in the above lemma may not actually contain edges of @xmath52 , so it begs the question : when is @xmath0 an induced subgraph of @xmath52 .",
    "clearly it is induced if and only if we can express it as @xmath267 , but this does not mean that @xmath144 must be empty . we have been using lemma [ lem : extension1 ] to remove edges to @xmath31 and assume that it satisfies ; we may also use it to add all useless edges , doing so the complement ( in @xmath29 ) is a reduced version of @xmath144 : a graph @xmath268 that generates the usual @xmath144 by composition with @xmath29 .",
    "[ cor : tight ] where @xmath210 is a chain cover of @xmath29 , @xmath225 is @xmath269 if and only if @xmath268 is a sub - digraph of @xmath270 .    on the one hand ,",
    "let @xmath268 be a subgraph of @xmath271 .",
    "we show that no edge of @xmath266 } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } } $ ] , for any @xmath253 in @xmath268 , is in @xmath52 .",
    "indeed , for any @xmath253 in @xmath268 there exist @xmath272 and @xmath273 such that @xmath274 and @xmath275 , so @xmath276}}}= { { \\delta}^{[k]}}$ ] and @xmath277}}}= { { \\gamma}_{[k]}}$ ] and so @xmath278 } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\beta}^{[j ] } } ] } } } = { { [ { { \\gamma}_{[k ] } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\delta}^{[k ] } } ] } } .\\ ] ] for any edge @xmath254 of @xmath279 } } \\bm{\\rangle } } \\times { \\bm{\\langle } { { \\delta}^{[k ] } } ] } } $ ] we have @xmath280 and @xmath281 , but @xmath282 is not in @xmath54 as @xmath283 in @xmath284 .",
    "on the other hand , assume that @xmath268 is not a subgraph of @xmath271 .",
    "then there is some @xmath253 in @xmath268 such that @xmath285 and @xmath286 are not both in @xmath287 for some @xmath288 .",
    "we show that the projection of @xmath289 } \\not\\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] onto any of the @xmath290 is an edge of @xmath290 , and so @xmath289 } \\not\\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] is an edge of @xmath52 .",
    "indeed , @xmath291 } { -}{{{\\alpha}^{(i ) } } } ) \\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] , or otherwise there is an arc in @xmath144 in @xmath291 } { -}{{{\\alpha}^{(i ) } } } ) { -}{\\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] which would contradict the existence of @xmath253 in the reduced @xmath268 . for any @xmath288 such that @xmath292 , @xmath291 } { -}{{{\\alpha}^{(i ) } } } ) \\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] projects onto the same edge in @xmath290 as does @xmath289 } \\not\\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] , implying that it is in @xmath290 .",
    "similarily @xmath289 } \\sim    { \\bm{\\langle } { { \\beta}^{(j ) } } ] } \\cup \\{{{{(\\beta + 1)}^{(j)}}}\\}$ ] is an arc showing that the projection of @xmath289 } \\not\\sim { \\bm{\\langle } { { \\beta}^{(j ) } } ] } $ ] onto @xmath290 is an edge of @xmath290 for any @xmath288 such that @xmath293 .    let @xmath0 be a reflexive @xmath6-graph and @xmath7 a compatible distributive lattice .",
    "theorem [ thm : char2 ] provides us a sub - digraph @xmath31 of @xmath29 such that @xmath294 . as we mentioned above , we have from @xcite that every chain cover @xmath210 of @xmath29 yields an embedding @xmath295 into a product of chains . by corollary [ cor : tight ] it is induced if and only if @xmath268 is a subgraph of @xmath271 .",
    "we can assure this by taking every arc of @xmath268 as a two element chain in @xmath210 and then covering then rest of @xmath29 with one element chains .",
    "theorem [ thm : embedding ] tells us that for every @xmath6-pair @xmath8 there is an embedding of @xmath7 into a product @xmath296 of chains @xmath211 such that @xmath0 is an induced subgraph of the product @xmath52 of proper interval graphs @xmath54 .",
    "we simply refer to this as an _ induced embedding _ of @xmath8 .",
    "an embedding is _ tight _ if every cover of @xmath7 is a cover of @xmath296 .",
    "classical results of birkoff and dilworth correspond tight embeddings of @xmath7 into products of chains to _ chain decompositions _ of @xmath29 : chain covers @xmath210 consisting of disjoint chains . by lemma [ lem : tight ]",
    "any @xmath6-pair @xmath8 has a tight embedding , but if @xmath268 has any vertices with in - degree or out - degree greater than @xmath18 , then by [ cor : tight ] this it is not induced .",
    "in fact , we will see at the end of the next section that there are @xmath6-graphs @xmath0 such that there are no compatible lattices @xmath7 for which @xmath8 has a tight induced embedding .",
    "this is why we had to consider non - tight embeddings , and why we wrote @xcite .",
    "recall that a graph is _ @xmath297-thin _ if no two vertices have the same neighbourhood . as our graphs are reflexive neighbourhoods and closed neighbourhoods are the same thing .",
    "the factorization of a categorical product was shown to be unique ( up to certain obviously necessary assumptions which include @xmath63-thinness ) in @xcite by drfler and imrich .",
    "feigenbaum and schffer @xcite showed that a categorical product can be factored in polynomial time . on the other hand ,",
    "it was shown in @xcite that proper interval graphs can be recognised in linear time .",
    "so products @xmath52 of proper interval graphs can be recognised in polynomial time .",
    "using techniques discussed in @xcite we will prove theorem [ thm : poly ] , which says that there is a polynomial time algorithm to decide whether or not an @xmath63-thin reflexive graph is a @xmath6-graph .",
    "we make no effort to optimise our algorithm .",
    "first we develop some properties of @xmath6-graphs .",
    "as we mentioned in subsection [ sub : nottight ] , not all @xmath6-pairs @xmath8 have tight induced embeddings .",
    "we call an induced embedding _ tightest _ if it minimises then number of _ non - tight covers_ covers of @xmath7 that are not covers of @xmath296 .",
    "we prove some properties of tightest embeddings .",
    "[ cl:6 - 1 ] if @xmath298 is an non - tight cover in a tightest induced embedding of a @xmath6-pair @xmath8 , then for every vertex @xmath299 of @xmath0 either @xmath300 or @xmath301 .    indeed , @xmath302 is impossible as @xmath298 . if @xmath303 but @xmath304 ( i.e. , @xmath299 and @xmath36 are incomparible ) then @xmath305 for some @xmath245 and so @xmath306 giving us that @xmath307 , which is again impossible as @xmath298 .",
    "similarily @xmath308 and @xmath309 is impossible .",
    "finally , if @xmath308 and @xmath310 then taking @xmath311 we get that @xmath312 and @xmath313 , which we have already seen is impossible .",
    "[ cl:6 - 2 ] if @xmath298 is an non - tight cover in a tightest induced embedding of a @xmath6-pair @xmath8 , then for all @xmath314 $ ] , @xmath315 and @xmath316 have different neighbourhoods in @xmath54 .    towards contradiction ,",
    "assume that @xmath315 and @xmath316 have the same neighbourhoods , then replacing @xmath54 with the proper interval graph we get by contracting @xmath315 and @xmath316 into a point , and reducing the @xmath245-coordinate of every vertex in @xmath317 by one , we get a tighter embedding of @xmath8 , contradicting the fact that we started with a tigthest embedding .",
    "[ lem : rthin ] if @xmath0 is @xmath63-thin then each @xmath54 in a tightest induced embedding of @xmath8 is @xmath63-thin .    towards contradiction ,",
    "assume that some @xmath54 contains vertices @xmath50 and @xmath41 with the same neighbourhoods .",
    "as @xmath54 is a proper interval graph , we may assume that @xmath318 .",
    "by claim [ cl:6 - 2 ] no non - tight cover projects onto @xmath319 so there is some @xmath320 with @xmath321 such that @xmath35 and @xmath322 are both in @xmath0 .",
    "but these have the same neighbourhoods in @xmath52 , and so as @xmath0 is an induced subgraph , they have the same neighbourhood in @xmath0 , contradicting the fact that @xmath0 is @xmath63-thin .",
    "the following definition can also be found in @xcite .",
    "[ def : disp ] an edge @xmath324 of @xmath0 _ dispensable _ if it satisfies the following conditions .    1",
    ".   @xmath325 such that @xmath326 , or 2 .",
    "@xmath325 such that @xmath327 , or 3 .",
    "@xmath325 such that @xmath328 and @xmath329 .",
    "observe that when @xmath0 is @xmath63-thin , we can replace the @xmath330 in the first two conditions with @xmath331 ; they are equivalent .    in the proof of the following lemma",
    "we will assume an embedding of @xmath8 into some product @xmath207 of proper inteval graphs @xmath54 .",
    "we will ust the following notation . for a vertex @xmath332 of",
    "@xmath54 we let @xmath333 be the greatest neighbour of @xmath332 in @xmath54 and @xmath334 be its least neighbour .",
    "as @xmath54 is proper interval @xmath335 implies that @xmath336 and @xmath337 .",
    "as @xmath54 is @xmath63-thin , strict inequality @xmath338 implies strict inequality in at least one of @xmath336 and @xmath337 .",
    "[ lem : hhasse ] let @xmath8 be a @xmath6-pair , @xmath0 be @xmath63-thin , and @xmath323 be the graph we get from @xmath0 by removing all dispensable edges . then    1 .",
    "every edge of @xmath323 is between comparable vertices of @xmath7 , and 2 .",
    "@xmath323 contains the hasse graph @xmath339 of @xmath7 .",
    "first we prove part ( a ) , by showing that any edge @xmath340 between incomparable vertices @xmath35 and @xmath36 is dispensable . indeed , as @xmath35 and @xmath36 are incomparable , we have that @xmath341 and @xmath342 are distinct and different from @xmath35 and @xmath36 .",
    "further as @xmath4 and @xmath5 are polymorphisms , any common neighbour of @xmath35 and @xmath36 is a neighbour of both of @xmath341 and @xmath342 , so @xmath343 .",
    "by @xmath63-thinness , @xmath344 and @xmath345 are distinct , so one of them properly contains @xmath346 .",
    "thus @xmath340 is dispensable .",
    "now , part ( b ) is harder .",
    "let @xmath298 be a cover of @xmath7 ; we show that it is not dispensable .",
    "assume some tightest induced embedding of @xmath8 into a product @xmath52 of proper interval graphs .",
    "we have two cases .",
    "+ * case : @xmath298 is a not tight cover . * for any @xmath299 in @xmath347 , we may assume by claim [ cl:6 - 1 ] that @xmath348 .",
    "we show that item i. of definition [ def : disp ] can not hold .",
    "any neighbour of @xmath36 in @xmath317 is a neighbour of @xmath299 by ( of section [ sec : def ] ) and so any @xmath349 in @xmath350 must be in @xmath160}$ ] .",
    "but then by it is adjacent to @xmath35 , contradicting that @xmath351 .",
    "items ii . and iii",
    ". can not hold , as by any common neighbour of @xmath35 and @xmath299 is also a neighbour of @xmath36 . + * case : @xmath298 is a tight cover . * by the @xmath63-thinness of @xmath0 , we may assume without loss of generality that there is some @xmath352 . so immediately ,",
    "condition ( ii ) of definition [ def : disp ] does not hold .",
    "we may assume , by permuting indices of the interval graphs @xmath54 , and possibly reversing the ordering on the first one , that @xmath353 assume that ( i ) holds , that is , that there is some @xmath299 with @xmath326 .",
    "as @xmath299 has some neighbour in @xmath354 we get that @xmath355 , so in particular @xmath356 . as @xmath357",
    "we have @xmath358 .",
    "there is some vertex @xmath349 adjacent to @xmath36 but neither @xmath299 nor @xmath35 .",
    "as it is in @xmath354 we have @xmath359 .",
    "putting these together we have @xmath360 and so @xmath361 means we may assume that @xmath362 , and so that @xmath363 .",
    "now let @xmath364 be the vertex in @xmath52 we get from @xmath35 by replacing @xmath365 with @xmath366 and @xmath367 with @xmath368 .",
    "so @xmath369 in @xmath52 , while @xmath370 and @xmath371 implies that @xmath372 , so @xmath373 in @xmath52 .",
    "as @xmath351 in @xmath0 , @xmath364 can not be in @xmath0 , so is in some vertex interval @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] removed from @xmath52 to get @xmath0 .    as @xmath349 is not in @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] we have that @xmath374 and @xmath375 . also , as @xmath35 is not in @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] , we have that @xmath376 or @xmath18 . but a tightest embedding can not have a vertex interval of the form @xmath263 } } , { { \\beta}^{[i]}}]}$ ] removed , so @xmath377 and @xmath378 .",
    "so @xmath379 .",
    "now we claim that the vertex @xmath380 which we get from @xmath35 by reducing @xmath367 to @xmath381 has the same neighbourhood as @xmath35 in @xmath0 , a contradiction .",
    "indeed @xmath382 contains @xmath383 , so contains @xmath384 , and all vertices @xmath115 of @xmath52 that are adjacent to @xmath35 but not @xmath380 have @xmath385 and @xmath386 so are in @xmath387 } } , { { \\beta}^{[1]}}]}$ ] which has been removed .",
    "thus we have our contradiction , so ( i ) can not hold .",
    "the argument that ( ii ) can not hold is essentially the same .",
    "finally , assume that ( iii ) holds .",
    "clearly this implies that both @xmath388 and @xmath354 are non - empty , so @xmath389 and @xmath390 .",
    "moreover , @xmath299 has a neighbour @xmath391 , so having @xmath392 , and similarly another neighbour @xmath41 having @xmath393 .",
    "but then there is no viable value for @xmath394 .",
    "this completes the proof of ( b ) and so of the lemma .",
    "compare lemma [ lem : hhasse ] to similar statements in ( * ? ? ?",
    "* chap 8) , where they show that @xmath323 is closely related to what they call the _ cartesian skeleton _ of a product graph @xmath0 .",
    "our proof is complicated by the fact that @xmath0 is not a product , but a subgraph of a product .",
    "[ alg:2 ] given a graph @xmath0 and subgraph @xmath323 with designated vertices @xmath74 and @xmath73 , let the sets @xmath395 and the graphs @xmath396 for all @xmath397 be defined as follows .",
    "@xmath398 , and @xmath396 is be the subgraph of @xmath323 induced by @xmath399 .",
    "let @xmath400 be the partial orientation of @xmath323 we get as follows .",
    "for @xmath401 do the following . for",
    "an edge @xmath109 of @xmath323 , let @xmath402 if    1 .",
    "@xmath403 and @xmath404 , or 2 .",
    "@xmath405 and any one of the following holds 1 .",
    "@xmath406 has a vertex @xmath407 such that @xmath408 for all @xmath409 .",
    "( we consider @xmath408 if there is a directed path in @xmath410 from @xmath411 to @xmath412 . ) 2 .",
    "@xmath413 has a vertex @xmath414 such that @xmath408 for all @xmath415 .",
    "@xmath413 has a vertex in @xmath416 but not in @xmath417 .    if every edge of @xmath323 is oriented in @xmath400 , and the transitive closure of @xmath400 is a lattice @xmath7 , then return @xmath7 , otherwise , return no.    this algorithm is clearly polynomial in @xmath47 .",
    "[ lem : orient ] let @xmath8 be a compatible pair ; @xmath0 be @xmath63-thin ; and let @xmath323 be a subgraph of @xmath0 , containing the hasse graph @xmath339 of @xmath7 , such that every edge of @xmath323 is between vertices that are comparible in @xmath7 .",
    "algorithm [ alg:2 ] , applied to @xmath323 , @xmath418 , and @xmath419 , returns @xmath7 .",
    "it is enough to show that for any ( non - loop ) edge @xmath109 of @xmath323 with @xmath420 , the above algorithm _ properly orients @xmath109 _ ; i.e. , sets @xmath402 and at the same time does not set @xmath421 .    observe that by construction every edge of @xmath323 is either in @xmath396 for some @xmath120 or is between @xmath410 and @xmath422 for some @xmath120 .",
    "we will prove by induction on @xmath120 that the @xmath423 step of the algorithm proper orients such edges , yielding a proper orientation of all the edges of @xmath396 . before we do this though",
    ", we first prove that it will never improperly orient an edge .",
    "let @xmath420 then the algorithm will not set @xmath421 .    we must check that none of the conditions of the algorithm are satisfied when the roles of @xmath66 and @xmath115 are reversed    to see that item ( i ) is not satisfied",
    "observe that if not both of @xmath66 and @xmath115 are in @xmath395 , then clearly it is @xmath66 that is closer to @xmath119 . indeed ,",
    "if @xmath424 is a path in @xmath0 , then so is @xmath425 .",
    "so @xmath403 and @xmath404 .",
    "( in fact this shows that the algorithm properly sets @xmath402 in the case that @xmath66 and @xmath115 are not both in @xmath395 .",
    "to see that items ( iia ) and ( iib ) are not satisfied , it is enough to observe that if @xmath426 and @xmath427 and @xmath428 then @xmath429 and @xmath430 .",
    "but this is clear , as the premises imply that @xmath431 and @xmath432    to see that item ( iic ) is not satisfied , assume that there is some @xmath433 .",
    "as @xmath434 is conservative , ( recall the definition of conservative sets preceding lemma [ lem : connected ] ) it induces a sublattice of @xmath7 , so has a maximum element @xmath411 .",
    "this element must also be in @xmath406 ; as if we had @xmath435 , then @xmath436 contradicting the fact that @xmath437 .",
    "we now show that @xmath411 is in @xmath417 , so item ( iic ) is not satisfied .",
    "indeed , some neighbour @xmath35 of @xmath66 must be in @xmath417 , as @xmath438 .",
    "let @xmath439 be a length @xmath440 walk from @xmath35 to @xmath73 . then taking the join of each element in the walk with @xmath411 we get a walk @xmath441 from @xmath411 to @xmath73 .",
    "this shows that @xmath411 is in @xmath442 for some @xmath443 , but being a neighbour of @xmath66 , it must be in @xmath417 .",
    "now we have just to verify that for @xmath420 the algorithm sets @xmath402 .    for the case",
    "@xmath374 let @xmath109 be an edge of @xmath323 in @xmath444 with @xmath420 . item ( i ) holds if and only if @xmath445 , and in this case gives @xmath402 , as needed .",
    "assume therefore that @xmath446 . as all vertices in @xmath447 are adjacent to @xmath73 , items ( iia ) and ( iib ) are vacuous ,",
    "so we must show that ( iic ) holds . to see this ,",
    "observe that as @xmath448 , we have that @xmath449 for all @xmath314 $ ] . as @xmath450 for all @xmath245 , we have by @xmath63-thinness that @xmath451 .",
    "the vertex in @xmath452 is thus in @xmath453 as needed .",
    "now assume that all edges of @xmath410 are properly oriented .",
    "we show that the @xmath423 round of the algorithm properly orients the heretofore unoriented edges of @xmath396 .",
    "let @xmath109 be an edge of @xmath454 with @xmath448 .",
    "if not both of @xmath66 and @xmath115 are in @xmath395 , then ( as we showed in the claim ) @xmath402 is properly ordered by step ( i ) of the algorithm .",
    "so we may assume that both of @xmath66 and @xmath115 are in @xmath395 .",
    "as @xmath420 we have that for all @xmath245 , @xmath449 . by @xmath63-thinness there is a vertex @xmath349 in either @xmath455 or in @xmath456 .",
    "we show now that in the first case , ( iia ) is satisfied , and then that in the second case , ( iib ) or ( iic ) are satisfied .    if @xmath457 , then ( iia ) is satisfied .",
    "let @xmath457 . as we showed in the proof that item ( iic ) is not satisfied in the previous claim , we have that the maximum neighbour @xmath411 of @xmath66 is in @xmath458",
    ".    to see that ( iia ) is satisfied , we must show that @xmath459 for any neighbour @xmath412 of @xmath115 in @xmath460 .",
    "indeed , @xmath427 and @xmath426 give @xmath461 .",
    "as @xmath411 is the maximal neighbour of @xmath66 this gives us that @xmath462 .",
    "this implies however that @xmath463 , and so @xmath464 , as needed .    if @xmath465 , then ( iib ) or ( iic ) are satisfied .",
    "we assume that ( iic ) does not hold , and then show that ( iib ) must .    indeed ,",
    "if ( iic ) does not hold , then @xmath466 . as @xmath467 is a conservative set it induces a sublattice",
    ", so has a minimum element @xmath412 .",
    "but then for any neighbour @xmath411 of @xmath66 in @xmath410 we have from @xmath427 and @xmath426 , that @xmath468 . as @xmath410 is conservative",
    ", @xmath469 is in @xmath410 so is in @xmath467 .",
    "thus @xmath470 which implies that @xmath459 . as @xmath471",
    "we have that @xmath408 , as needed .",
    "this completes the proof of the lemma .",
    "now we are ready to prove theorem [ thm : poly ] .",
    "let @xmath0 be an @xmath63-thin graph .",
    "it is shown in @xcite that the subgraph @xmath323 we get by removing dispensible edges can be found in polynomial time .",
    "for every choice of @xmath74 and @xmath73 in @xmath0 apply algorithm [ alg:2 ] to @xmath472 and @xmath74 and @xmath73 . as this is at most @xmath473 applications of a polynomial time algorithm , it is also polynomial .",
    "if for any choice of @xmath74 and @xmath73 a lattice @xmath7 is returned then by lemmas [ lem : hhasse ] and [ lem : orient ] , then @xmath0 is in @xmath6 and @xmath7 is a compatible distributive lattice .",
    "if no is returned for every choice , then by lemmas [ lem : hhasse ] and [ lem : orient ] , @xmath0 is not in @xmath6 .",
    "here is an unexpected consequence of our algorithm .",
    "[ cor : uniquetype2 ] if @xmath0 is @xmath63-thin , then for a given choice of minimum and maximum vertices @xmath74 and @xmath73 , there is at most one distributive lattice @xmath7 with minimum element @xmath74 and maximum element @xmath73 that is compatible with @xmath0 .    with this",
    "we can get the following .",
    "( 1,0.43333335)(0,0 ) ( 0,0 ) , poset @xmath29 , and the graph @xmath268,title=\"fig : \" ] ( 0.47,0.017)(0,0)[lb ] ( 0.72500005,0.017)(0,0)[lb ] ( 0.21,0.017)(0,0)[lb ] ( 0.20833334,0.37500001)(0,0)[lb ] ( 0.16,0.02500002)(0,0)[lb ] ( 0.40,0.12083341)(0,0)[lb ] ( 0.40,0.21214294)(0,0)[lb ] ( 0.40,0.29865747)(0,0)[lb ] ( 0.40,0.38097229)(0,0)[lb ] ( 0.57246034,0.06148159)(0,0)[lb ] ( 0.58084656,0.15098546)(0,0)[lb ] ( 0.57916668,0.23749999)(0,0)[lb ] ( 0.5774868,0.31981481)(0,0)[lb ]    [ prop:3not2 ] there are distributive lattice graphs that are not tight .",
    "let @xmath8 be the @xmath6-pair shown with a tight but non - induced embedding in figure [ fig:3not2 ] .",
    "by example [ ex : degone ] , the shown @xmath74 and @xmath73 are the only possible @xmath74 and @xmath73 for lattice @xmath7 compatible with @xmath0 . as @xmath0 is @xmath63-thin , we have by corollary [ cor : uniquetype2 ] that @xmath7 is the only distributive lattice ( upto isomorphism ) compatible with @xmath0 .",
    "the poset @xmath29 and subdigraph @xmath268 are also shown . as @xmath268 has a vertex with up - degree two , we have , following remarks in subsection [ sub : nottight ] , that there is no tight induced embedding of @xmath8 .",
    "so @xmath0 has no compatible distributive lattice with which it has a tight induced embedding .      for a reflexive graph @xmath0",
    "we define a relation @xmath63 on the vertex set by letting @xmath474 if @xmath66 and @xmath115 have the same neighbourhood .",
    "clearly this is an equivalence relations .",
    "the _ @xmath63-thin reduction _ of a graph @xmath0 is the graph @xmath65 whose vertices are the sets @xmath63 and in which two sets are adjacent if there are any ( and so all ) edges between their member vertices .",
    "the following shows our algorithm can be useful in showing that a non @xmath63-thin graph is not @xmath6 .",
    "[ lem : rthinred ] if a reflexive graph @xmath0 is a @xmath6-graph then its @xmath63-thin reduction is .",
    "assume that @xmath0 is a reflexive @xmath6-graph that is not @xmath63-thin .",
    "we will find pairs of vertices that are identified in @xmath65 and show that when we identify them , or reduce the number of coordinates in which they differ , we still have a @xmath6 graph .",
    "the fact that @xmath65 is @xmath6 then follows by induction .    for some compatible @xmath7 assume a tightest induced embedding of @xmath8 into @xmath475 .",
    "let @xmath35 and @xmath36 be vertices of @xmath0 with the same neighbourhood . by lemma [ lem : rthin ]",
    "there is some @xmath476 such that @xmath477 and @xmath478 have the same neighbourhood in @xmath476 .",
    "we may assume that @xmath479 .",
    "for any vertex @xmath115 in @xmath0 with @xmath480 , reduce @xmath481 by @xmath119 .",
    "if under this reduction , two vertices now have the same co - ordinates , then identity them- they had the same neighbourhood so are identified in @xmath65 .",
    "clearly there is an embedding of this reduced graph into @xmath482 where @xmath483 when @xmath484 and we get @xmath485 from @xmath476 by identifying @xmath477 and @xmath478 .    we conjecture the following .",
    "[ conj : rthin ] for a reflexive graph @xmath0 there is a polynomial time algorithm to decide whether or not @xmath0 is a @xmath6-graph .",
    "notice that the graph @xmath0 in figure [ fig : lnotdl ] is not @xmath63-thin .",
    "the vertices @xmath9 and @xmath130 have the same neighbourhoods .",
    "if we remove one of these vertices then the resulting lattice is distributive and is still compatible with the resulting @xmath63-thin reduction @xmath65 .",
    "thus the converse of the above lemma is , unfortunately , not true .",
    "that said , one sees by reversing the operation in the proof of lemma [ lem : rthinred ] that from an embedding of a @xmath6-pair , we can add a copy of every vertex that has the same value in some coordinate .",
    "moreover one can argue that fattening the lattice in a new dimension can be replicated in the existing dimensions .",
    "so resolving the conjecture comes down solving a general version of the following game , described vaguely , but clear from figure  [ fig : game ] .",
    "given a set of numbers in a diamond tableau , decide if one can    * divide the regions with square lines , and * make two decreasing walks from the top to the bottom ,    so that the number of divided regions in each of the original regions between the walks equals the number proscribed in the tableau . with some students",
    "@xcite , we show that this game has a polynomial time solution for tableaux of two dimentions .",
    "( 8,6)(0,0 ) ( 0,.5),title=\"fig:\",width=302 ] ( -1,0)diamond tableau ( 2.5,0)divided tableau ( 6,0)two walks",
    "a partial characterisation of lattice graphs can be extracted from known literature .",
    "indeed , it follows from @xcite and @xcite ( see also @xcite ) that retracts of products of reflexive paths are exactly the reflexive graphs that admit majority , or @xmath486-nu polymorphisms , that is , polymorphisms @xmath487 satisfying    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ @xmath488 if at least two of @xmath141 and @xmath299 are @xmath42 . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    if a reflexive graph has a compatible lattice , then it also admits the following majority operation ( seen , for example , in @xcite ) @xmath489 thus all lattice graphs are retractions of products of paths",
    ". it would also be nice to see how our characterisations can be use to show this for @xmath6-graphs : that every @xmath6-graph is a retract of products of paths . in general",
    ", removing a vertex interval @xmath204 } } , { { \\beta}^{[j]}}]}}$ ] is not a retraction .",
    "e. jawhari , m. pouzet , d. misane , _ retracts : graphs and ordered sets from the metric point of view _ combinatorics and ordered sets ( arcata , calif . , 1985 ) , 175226 , contemp .",
    ", * 57 * , amer . math .",
    "soc . , providence , ri , 1986 ."
  ],
  "abstract_text": [
    "<S> in this paper we give two characterisations of the class of reflexive graphs admitting _ distributive lattice polymorphisms _ and use these characterisations to address the problem of recognition : for a reflexive graph @xmath0 in which no two vertices have the same neighbourhood , we find a polynomial time algorithm to decide if @xmath0 admits a distributive lattice polymorphism . </S>"
  ]
}