{
  "article_text": [
    "the monte carlo technique @xcite has served us well in the study of equilibrium statistical mechanics and other fields .",
    "the traditional local monte carlo method is simple , extremely general , and versatile .",
    "however , there are some intrinsic drawbacks .",
    "first , the convergence of the results to the exact values is slow .",
    "the basic probabilistic nature has limited the monte carlo error to decrease as @xmath0 , where @xmath1 is monte carlo steps or computer time . with exception of quasi monte carlo @xcite for numerical integration ,",
    "as long as we use a probabilistic approach , it does not appear possible to overcome this barrier .",
    "most of the work to improve the efficiency of monte carlo method has been via variance reduction @xcite , which reduces the value of coefficient in front of the @xmath0 law .",
    "next , while the traditional monte carlo method is good for computing expectation values such as the internal energy and its derivatives , it is more difficult to compute the free energy or entropy @xcite .    over the last few decades",
    ", a number of methods have been developed to compute the density of states .",
    "the histogram method @xcite and the multiple histogram method @xcite can be regarded from this point of view .",
    "the multi - canonical method @xcite in some sense is also a computation of the density of states .",
    "both of these methods involve the re - weighting of probabilities to construct the canonical distribution .",
    "et al _ @xcite proposed a broad histogram method , in which the density of states is also computed from simulation .",
    "if the density of states can be computed with sufficient accuracy , then most thermodynamic quantities can be obtained with little further effort .",
    "this includes the moments of energy , entropy , and free energy .",
    "moreover , the results are obtained as a continuous function of temperature from a single simulation . in this paper , we present such a method and study its efficiency .",
    "this method includes the use of a transition matrix @xcite , a stochastic matrix defined in the space of energy , and a class of related simulation algorithms @xcite .",
    "the present method has the elements of both the broad histogram method and multi - canonical method .",
    "the flat - histogram algorithm offers an effective way to compute density of states @xmath2 for all energy @xmath3 . with its multi - canonical element",
    ", it also offers fast dynamics for systems at first - order phase transitions .",
    "the use of transition matrix improves the efficiency of data analysis .    in the next section",
    ", we shall discuss the formalism and the essential aspects of the method .",
    "we also present the results of some numerical tests and discuss the connections of our method with previous methods . in the appendices , we give details of a transition matrix dynamics .",
    "the monte carlo method aims at generating samples @xmath4 with probability distribution @xmath5 , where @xmath4 is a particular state of the system . in the ising model , which we shall use as a concrete example",
    ", @xmath4 is a vector of all the spins @xmath6 , where @xmath7 . in the usual application of the monte carlo method , the invariant distribution @xmath5 is given by the canonical distribution ( gibbs distribution ) @xmath8 .",
    "however , this need not be the case . in the equal - hit ensemble that we shall discuss later , @xmath5 is not known , and is not even unique . nevertheless , it is still a valid monte carlo algorithm that can have significant advantages .",
    "a sequence of states or samples is generated by a markov chain @xcite with transitions between states described by a matrix @xmath9 .",
    "this is the conditional probability that state moves to @xmath10 given that the current state is @xmath4 .",
    "this matrix is known as a stochastic matrix and it must satisfy @xmath11there is considerable freedom in choosing the matrix @xmath12 , but the most important condition ( or criterion ) is detailed balance @xmath13a markov chain that satisfies the above condition is called a reversible markov chain .",
    "this condition guarantees the invariance of the probability @xmath5 with respect to the transition matrix @xmath12 , i.e. , @xmath14repeated application of @xmath12 to an arbitrary probability distribution makes the resulting probability distribution converge to a fixed point , @xmath15 .",
    "we shall not elaborate on the condition that an invariant probability distribution exists and is unique . roughly speaking",
    ", we must be able to make transitions in a finite numbers of steps from any initial state to any final state .",
    "this is known as ergodicity .",
    "the standard metropolis algorithm @xcite is to take @xmath16where @xmath17 is a selection function  a conditional probability of attempting to go to state @xmath10 given that the current state is @xmath4 . within the above formulation",
    ", it is required that the @xmath18 matrix is symmetric , @xmath19although this condition can also be relaxed @xcite . following oliveira @xcite , we call this condition microscopic reversibility .",
    "the diagonal elements of @xmath12 are fixed by the normalization condition , eq .",
    "( [ eq - norm ] ) .",
    "note that the diagonal elements are not needed explicitly in a computer simulation .    in a computer implementation",
    ", a move is selected according to @xmath18 ( e.g. , pick a site to flip a spin ) .",
    "the move is made if a random number @xmath20 between 0 and 1 is less than the flip rate @xmath21 ; otherwise , it is rejected , and the original configuration @xmath4 is counted once more as the next configuration in a monte carlo move .    clearly the above formalism is very general . although the procedure can be used to sample any distribution , it has its limitations .",
    "one drawback of standard algorithm is that the configurations generated are correlated .",
    "these correlations severely limit the efficiency of the method near phase transitions or for models with competing interactions and many local minima .",
    "a number of methods have been proposed to address this problem , such as the cluster algorithms @xcite , the multi - canonical methods @xcite , replica monte carlo @xcite , and simulated tempering @xcite .",
    "the flat histogram method presented in this paper is similar in some aspects to the multi - canonical method .",
    "the implementations of flat histogram method and transition matrix based methods are very simple and efficient .",
    "the concept of an energy histogram is essential to all of these methods .",
    "other types of histogram of macroscopic quantities can be easily defined in analogy to the energy histogram and may be useful in some contexts , such as the joint histogram of energy and total magnetization .",
    "we define the energy histogram ( in the case of a discrete energy spectrum ) as the number of instances of each value of the energy @xmath3 generated during a monte carlo simulation ; we denote the histogram by @xmath22 .",
    "the histogram is important because of its direct relationship to the probability distribution of the energy in the system being simulated .",
    "if the probability of a state @xmath4 is given by @xmath5 for a given simulation , then @xmath23is the probability that the system has an energy @xmath3 .",
    "if the monte carlo simulation in question generates @xmath24 configurations , then the expectation value of the histogram ( average of the histogram over an infinite number of similar monte carlo runs ) is given by @xmath25 for the canonical distribution , we have @xmath26 where @xmath27 is the partition function , @xmath28then @xmath29 .",
    "we define the density of states ( for systems with discrete energy spectrum ) @xmath30as the number of states with energy @xmath3 .",
    "note that the configuration dependence of the probability is only through energy implicitly .",
    "thus , two configurations with the same energy will have the same probability .",
    "we shall call this the microcanonical property .",
    "the transition matrix monte carlo to be discussed below relies on this property crucially , while allowing the function @xmath31 to be arbitrary .",
    "the histogram @xmath22 sampled during a monte carlo run ( the number of visits to energy @xmath3 ) is an estimator to @xmath32 , i.e. , @xmath33 .",
    "the usual canonical monte carlo method is equivalent to using the number of visits @xmath22 to compute the moments of @xmath3 at the simulation temperature @xmath34 .",
    "the histogram method of ferrenberg and swendsen @xcite is based on the simple observation that density of states can be estimated ( up to a proportionality constant ) by @xmath35 . with this information",
    ", the moments of @xmath3 can be extrapolated for nearby temperatures as well .    clearly ,",
    "if we can determine @xmath2 , then most of the energy related thermodynamic averages can be determined , such as internal energy , specific heat , free energy , and entropy .",
    "the free energy is given then by @xmath36 other quantity of interest can also be computed if a `` histogram '' ( as a function of @xmath3 ) of such quantity is also collected , @xmath37 the main objective of this paper is to show that we can determine the density of states @xmath2 for the whole range of energy with monte carlo sampling efficiently .",
    "the transition matrix defined below serves a dual purpose  for the computation of the density of states and for the construction of flat histogram algorithms .",
    "there are a number of ways to look at the transition matrix based methods .",
    "we shall take the detailed balance equation , ( [ eq - detailed - balance ] ) , as a basic starting point .",
    "consider all initial states @xmath4 with energy @xmath3 and all final states @xmath10 with energy @xmath38 .",
    "each pair of states @xmath39 has a detailed balance equation",
    ". some of the equations may be the identity @xmath40 if the transition by a single - spin flip is not possible .",
    "summing up the detailed balance equations for all the states @xmath4 with a fixed energy @xmath3 and all the states @xmath10 with a fixed energy @xmath38 , we have @xmath41assuming that the configuration probability distribution is a function of energy only , i.e. , @xmath42 , and defining the transition matrix in energy as @xmath43we have @xmath44as a consequence of @xmath12 being a stochastic matrix , @xmath45 is also a stochastic matrix : @xmath46with the histogram @xmath29 being the invariant distribution : @xmath47 similar definition to eq .",
    "( [ eq - t - matrix - definition ] ) was introduced in ref .",
    "@xcite in a different context .",
    "because the matrix @xmath48 is composed of two factors , only the second of which depends on the specific ensemble under consideration , it is convenient to refer all calculations to the `` infinite - temperature '' transition matrix , @xmath49where @xmath50 is the number of spins , or more generally , the number of allowed moves from a given state .",
    "if we define @xmath51 , we then have @xmath52 in a random single - spin - flip dynamics , @xmath53 equals @xmath54 if the two configurations @xmath4 and @xmath55 differ by one spin , and zero otherwise . thus , the second summation over @xmath10 gives the number @xmath56 of configurations of energy @xmath38 that can be reached from @xmath4 of energy @xmath3 by a spin flip .",
    "the first summation is over the configurations with energy @xmath3 , i.e. , a microcanonical average of the quantity @xmath57 .",
    "the constancy of @xmath58 for the nonzero matrix elements is important for this interpretation of @xmath59 .",
    "the quantity @xmath57 is central to the current method , as well as to the broad histogram method @xcite .    within the single - spin - flip dynamics , the matrix @xmath60",
    "is then given by @xmath61where any flip rate @xmath62 can be inserted once @xmath63 has been determined .",
    "substituting eq .",
    "( [ eq - transition - matrix ] ) into the energy detailed balance equation ( [ eq - energy - detailed - balance ] ) , we can cancel @xmath31 and @xmath64 as for a valid dynamics which generates distribution @xmath65 , we have the usual detailed balance , @xmath66the final equation is known as broad histogram equation , initially presented by oliveira _",
    "et al _ @xcite , @xmath67 in terms of the transition matrix notation , this becomes @xmath68the name `` broad histogram '' equation is historical and clearly a misnomer .",
    "the above equation has a very simple interpretation .",
    "consider all pairs of states @xmath4 with energy @xmath3 and states @xmath10 with energy @xmath69 such that the moves ( or transitions ) between @xmath4 and @xmath10 are allowed .",
    "these states correspond to states for which the matrix elements in @xmath18 are non - zero .",
    "due to the microscopic reversibility , if @xmath4 to @xmath10 is allowed , so is the reverse move from @xmath10 to @xmath4 .",
    "there are two ways to count the total number of moves , summing up from states with energy @xmath3 or summing up from states with energy @xmath38 .",
    "the state @xmath4 has @xmath70 ways to move into energy @xmath71 .",
    "the total number of moves to energy @xmath38 from all states with energy @xmath3 is @xmath72 . by the reversibility requirement",
    ", we must have @xmath73a microcanonical average of any quantity is defined by @xmath74using this definition , the previous equation ( [ eq - n - eq ] ) is reduced to eq .",
    "( [ eq - broad - histogram ] )",
    ". this argument is first put forth by oliveira @xcite and by berg and hansmann @xcite .",
    "clearly , the result does not depend on what type of moves we use , so long as it satisfies the reversibility condition .",
    "the detailed balance condition imposes a restriction on the transition matrix , which we call the @xmath76 identity .",
    "consider three distinct energy levels , @xmath3 , @xmath38 , and @xmath77 , for which energy transition matrix elements among them are nonzero .",
    "let us write down three equations associated with the transitions among them : @xmath78multiplying the left and right sides of the three equations together and assuming that the product @xmath79 is nonzero , we can cancel this factor from the equation and obtain : @xmath80this is the @xmath76 identity .",
    "the importance of this equation is that it does not require the knowledge of the stationary distribution to check for agreement of the data with the condition of detailed balance .",
    "while for normal monte carlo simulation , the detailed balance is built - in directly to the transition matrix @xmath12 , this is not the case for some of the transition matrix monte carlo schemes that have been proposed .",
    "one implication of detailed balance violation is that the microcanonical property that all states with the same energy have the same probability is violated .",
    "this detailed balance violation for the initial choice of oliveira s broad histogram dynamics , a particular choice of the transition rate @xmath12 , has been demonstrated explicitly for small systems @xcite .",
    "the significance of the @xmath76 identity is that given the probability @xmath81 of energy having value @xmath3 , if we can predict @xmath82 at energy @xmath83 by the detailed balance equations in two ways , one directly from @xmath3 to @xmath83 , one by two hops , from @xmath3 to @xmath84 , and then @xmath84 to @xmath83 , then the @xmath76 identity guarantees that the results are exactly the same .",
    "that is , @xmath85 and @xmath86 the @xmath76 identity says that the two predictions based on the detailed balance are equal , @xmath87 .",
    "detailed balance implies @xmath76 identity .",
    "is the reverse also true ?",
    "i.e. , given a complete set of @xmath76 identities , do they imply detailed balance in the sense of equation @xmath88 for all @xmath3 and @xmath38 ?",
    "the answer is yes .",
    "the @xmath76 identity turns out to guarantee a consistent ( detailed balance ) solution involving three jumps , say , @xmath3 to @xmath38 , to @xmath77 , to @xmath89 , versus @xmath3 to @xmath89 directly when such jumps are allowed .",
    "therefore , @xmath90 identities that follow from detailed balance are automatically fulfilled and neither provide further information , nor require separate proof .",
    "naturally , when we consider adding more complex monte carlo moves , either to improve the efficiency of a calculation or to reflect the nature of a more complex model , more @xmath76 identities are generated and identities with more factors of @xmath60 are automatically satisfied .",
    "we define a quantity to measure the detailed balance violation for three energy levels for which the transitions among them are nonzero as @xmath91where @xmath92 is monte carlo estimate of @xmath93 . for a single - spin - flip dynamics with the metropolis rate ,",
    "the energy transition matrix is given by eq .",
    "( [ eq - transition - matrix ] ) , with @xmath94 , thus the above equation is equivalent to @xmath95for ising model where energies are equally spaced , we consider three levels at @xmath3 , @xmath96 and @xmath97 , where @xmath98 is the coupling constant . a plot of @xmath99 for ising model is presented in ref .",
    "@xcite .",
    "if a configuration has probability @xmath100 , then the histogram is @xmath101 .",
    "a flat histogram is obtained if we take @xmath102 .",
    "a single spin flip with the flip rate @xmath103 can be used to do the simulation .",
    "lee s reformulation of multi - canonical method @xcite is essentially this . the trick there is to determine @xmath2 efficiently @xcite .    from the equation describing detailed balance for the transition matrix , ( [ tmatrix - broad - hist ] ) ,",
    "we can write the acceptance rate as @xmath104this is the first equation derived for flat histogram dynamics , although we will show below that it is not unique .",
    "this rate is first proposed in ref .",
    "@xcite , and is independently discovered by li @xcite . unlike the quantity @xmath2 , a good approximation is already available in the very beginning , since we can use the instantaneous value @xmath105 as a preliminary estimate for @xmath106 . a cumulative average of contributions to @xmath106 can be used as a convenient , and remarkably accurate , approximation for the microcanonical average .",
    "we shall discuss how good this scheme is in a later section .",
    "there is another equivalent way of looking at the problem .",
    "consider the energy detailed balance equation in the form @xmath107if we require that the histogram is a constant , @xmath108 , then the spin - flip rate must satisfy the following equation , @xmath109clearly , eq .",
    "( [ eq - flat - histogram - rate ] ) satisfies the above equation .",
    "moreover , there is a whole family of choices of the transition rates .",
    "some of the choices are given in table  [ tb - rates ] .",
    "the standard metropolis algorithm contains two steps .",
    "first , a move is proposed .",
    "next , this move is accepted with probability @xmath111 or rejected with probability @xmath112 , where @xmath113 .",
    "is it possible to always accept a move without sampling the same configuration repeatedly ?",
    "the answer is yes , if we are willing to keep extra information during the simulation . in the flat histogram method ,",
    "this extra information is already there for free .",
    "it is precisely @xmath114 .    in an @xmath50-fold way simulation (",
    "also known as event - driven simulation ) @xcite , we do not change the dynamics ; it is fully equivalent to the usual single - spin - flip dynamics .",
    "however , there is a substantial improvement in efficiency in those situations for which the rejection rate is high .",
    "the method begins by computing the total probability that a move would be accepted with the standard approach .",
    "for the ising model , this probability is @xmath115where the factor @xmath54 is due to the fact that each spin located at site @xmath116 is picked up with probability @xmath54 .",
    "the notation @xmath117 refers to a configuration with the spin at site @xmath116 reversed in sign .",
    "the quantity @xmath118 is the probability that any spin is flipped .",
    "since the flip rate depends on the initial and final energies only , we can simplify the above equation as @xmath119we divide the possible moves into classes according to their energy increment @xmath120 . within a given class ,",
    "each spin has the same flipping probability .",
    "we now set the probability of the class with energy change @xmath120 being chosen as @xmath121a spin in this class is then chosen at random and flipped with probability one . as a practical consideration in designing algorithms , we note that the condition that @xmath64 must be between 0 and 1 can now be relaxed because of the normalization by @xmath122 in this equation .    in the original algorithm @xcite , monte carlo time",
    "is rescaled to make the dynamics equivalent to that of the usual algorithm . for the purpose of calculating averages",
    ", we will reweight each configuration to achieve the same effect .",
    "each configuration @xmath4 in the original single spin flip has equal weight .",
    "the monte carlo average of a quantity @xmath123 is computed as @xmath124here @xmath125 at step @xmath1 and the subsequent steps could be the same , due to the possibility of rejecting a move .",
    "the probability that a move is rejected is @xmath126 .",
    "thus the life - time of a configuration has the probability distribution @xmath127the average life - time for configuration @xmath4 is then @xmath128 in the @xmath50-fold - way simulation , each step generates a distinct state from the immediate preceding one ; each of these states is supposed to last for a during of @xmath129 , on average . thus in replacing eq .",
    "( [ eq - average ] ) the correct formula for statistical average with @xmath50-fold - way simulation is @xmath130    naively the computation of @xmath131 seems to require @xmath132 basic steps at each single - spin - flip move .",
    "but the effect of changing configuration by a flip is local , involving only the site in question and its neighboring sites .",
    "we only need to compute the changes in @xmath133 .",
    "thus each move takes @xmath134 in computer time .",
    "it is few times slower than a corresponding straightforward single - spin - flip program .",
    "the @xmath135-fold way does require extra memory , as a list of spins for each class is required in order to be able to pick a spin from the class with a computer time of @xmath134 .",
    "the flat histogram ensemble in some sense is the best ensemble to evaluate the density of states , for each energy level is sampled with the same frequency .",
    "however , as we have seen in the @xmath50-fold way , this is not entirely true , as some configurations are weighted more than others .",
    "the equal - hit algorithms @xcite generate fresh configurations with equal probability at each energy .",
    "there is a very interesting aspect of these algorithms  the histograms in such algorithms are not unique and depend on the details of the dynamics .    the energy histogram in the normal single - spin - flip dynamics ( that is , not in the @xmath50-fold way ) is computed as @xmath136i.e . , the contribution to the histogram from the configuration @xmath137 of energy @xmath138 is 1 for @xmath139 and zero for other energies .",
    "the angular brackets refer to monte carlo average . in the @xmath50-fold way",
    ", the statistics are weighted with @xmath122 to get the equivalent result in the original dynamics , so we have @xmath140the angular brackets indicate simple arithmetic average over the samples generated in an @xmath50-fold way , c.f .",
    "( [ eq - n - fold - average ] ) .",
    "we put a subscript n to emphasize the fact that the average is over @xmath50-fold way samples .",
    "we define the hits as @xmath141this quantity measures the average number of fresh configurations generated at each energy , since in the @xmath50-fold way , each configuration @xmath4 in the sample is distinct from the previous sample due to the fact that there is no rejection in @xmath50-fold way .",
    "we can relate the histogram to the hits by @xmath142where @xmath143is the average of inverse acceptance rate for states of fixed energy in the @xmath50-fold way samples .",
    "note that this is not the same as the microcanonical average of @xmath122 , which in general is @xmath144substituting eq .",
    "( [ eq - histogram - hit ] ) into energy detailed balance equation , ( [ eq - histogram - detailed - balance ] ) , we have @xmath145equal - hit is realized if the flip rate satisfies the above equation with @xmath146 .",
    "for example , @xmath147other choices are also possible ; some of them are given in table  [ tb - rates ] .",
    "we note that since the transition rate depends on the underlying dynamics through @xmath118 , there is no guarantee that the histogram @xmath32 is unique .",
    "in fact , in the equal - hit dynamics , @xmath32 is not known , and has to be determined self - consistently through the equal - hit dynamics .",
    "we note that @xmath118 is defined by eq.([eq - a ] ) using @xmath148 , which uses @xmath118 in eq .",
    "( [ eq - hit - rate ] ) .",
    "there is also a peculiarity that @xmath32 diverges for some choices of the transition rates for the ground states .",
    "in this section , we evaluate the performance of various proposed algorithms . in table  [ tb - rates ] , we list a dozen possible choices of flip rates , @xmath64 . for each rate , the simulation can be implemented with or without the @xmath50-fold way .",
    "as the flip rates require the knowledge of exact microcanonical average , which is not available , we use the crucial approximation @xmath149where energy histogram @xmath22 is the number of samples generated for a given energy , @xmath150 , @xmath24 is the total number of samples generated so far , and @xmath151 is the configuration at step @xmath1 in the algorithm .",
    "we collect a sample after every attempt of moves .",
    "the above expression is suitable for the normal single - spin - flip algorithm . in @xmath50-fold way",
    ", the statistics have to be weighted by @xmath152 .",
    "whenever information is not available , we set the flip rate to 1 .",
    "this biases the system to visit unexplored energy levels .    in the above method ,",
    "the simulation is started automatically , without an iteration process .",
    "this bootstrap is efficient and is also correct in the sense that it converges .",
    "we shall call the above method iteration 0 . strictly speaking ,",
    "iteration 0 need not be a valid monte carlo algorithm as the transition rates are fluctuating quantities , thus the normal markov chain theory for convergence does not apply .",
    "however , numerical results do support convergence , although a rigorous proof is lacking .",
    "= 0.8    figure  [ fig - histo ] presents energy and hit histograms for a @xmath153 square lattice for an 8-state ferromagnetic potts model .",
    "as expected , the energy histogram is flat for the flat histogram algorithm .",
    "the hits are roughly proportional to the number of different configurations generated .",
    "this is not exactly true since in the @xmath50-fold way , we can only guarantee that the next configuration is different from the immediate preceding one",
    ". the new configuration can be the same with configurations in earlier steps . by requiring that the hits are equal for all energies , we obtain the equal - hit algorithm with the corresponding energy and hit distribution shown in the lower part of the figure .",
    "= 0.90    due to the statistical nature of the histogram and also due to the fact that the energy range is explored similarly to a random walk , the histogram is not exactly flat , but fluctuates around a mean . during a simulation of length @xmath1 of monte carlo steps ( sweeps ) ,",
    "we have generated @xmath154 independent samples , where @xmath155 is correlation time related to the histogram .",
    "these samples are distributed to order @xmath50 bins of different energies ( for the two - dimensional ising model , it is exactly @xmath156 bins ) .",
    "thus , each bin has about @xmath157 independent samples .",
    "the relative fluctuation of the histogram is ( asymptotically for large @xmath1 ) @xmath158 although the above argument applies for the fluctuation between different runs , it is also reasonable to apply it to the fluctuation among different energies , since the samples between different energies are assumed independent .",
    "the same analysis also applies to the hits in equal - hit algorithm .",
    "equation ( [ eq - fluctuation ] ) can be used as a definition for the correlation time @xmath155 .",
    "a perfect poisson process has a constant correlation time ( @xmath159 ) ; an ideal random walk in energy is @xmath160 .",
    "we compute @xmath155 for the nearest neighbor ising model on one - dimensional chain , two - dimensional square lattice , and three - dimensional cubic lattice .",
    "we found that numerically eq .",
    "( [ eq - fluctuation ] ) is approximately satisfied , with the correlation time growing with size , @xmath161 in one dimension , @xmath162 in two dimensions , and @xmath163 or @xmath164 in three dimensions , see fig .",
    "( [ fig - h - slowing - down ] ) .",
    "the algorithm 0 becomes inefficient ( slow convergence ) for large lattices in two and three dimensions .",
    "we shall discuss this further later on .",
    ".a list of choices of the flip rates and their errors in transition matrix with respect to the exact results on a @xmath165 square lattice for the ising model . in the formula , we have @xmath166 , @xmath167 , @xmath168 , @xmath169 , where @xmath3 is the current energy and @xmath84 is proposed new energy . in simulation ,",
    "the exact microcanonical average @xmath170 is replaced by a cumulative average . [",
    "cols=\">,^,>,<\",options=\"header \" , ]     we tested the zeroth iteration algorithms for convergence to the exact values for the infinite temperature transition matrix , @xmath171 , on a @xmath172 ising square lattice model .",
    "the exact result @xmath173 is obtained by an exhaustive enumeration .",
    "figure  [ fig - t - converge ] is a plot of overall error in the @xmath50-fold - way simulation data @xmath174 , defined by @xmath175versus monte carlo simulation length @xmath1 ( averaged over many runs ) .",
    "the monte carlo times are in units of sweeps ( @xmath50 moves ) .",
    "the asymptotic value @xmath176 for large @xmath1 is listed in table  [ tb - rates ] , which characterizes the rate of convergence .",
    "= 0.90    as expected , the best algorithm is algorithm number @xmath177 , when the input @xmath2 is exact .",
    "the algorithms ( or rates ) number 0 , 1 , and 7 are only slightly worse than the best .",
    "numbers 5 and 6 are the second best . the rate numbers 3 , 4 , and 11 may still converge extremely slowly or not converge at all .",
    "we do not understand why this is so .",
    "number 9 does not converge , which we know since it does not satisfy detailed balance equation .",
    "using instantaneous values rather than average values is clearly wrong .",
    "errors for single - spin - flip algorithm are about 1.5 larger than with the @xmath50-fold - way , or about @xmath178 less efficient in monte carlo steps . however , since the @xmath50-fold way is slower in cpu time than single - spin flips by a factor of 2 or more , the two methods are comparable in overall efficiency in this particular instance .    from the above results we conclude that even the zeroth iteration converges to the correct results",
    "this does not mean that the rate of convergence is uniform in @xmath3 .",
    "in fact , we found for large lattices , the violation of detailed balance , @xmath99 , is large at the two ends of the energy spectrum @xcite .",
    "there are a number of different ways of determining the density of states .",
    "the matrix @xmath63 has eigenvalue 1 with corresponding left eigenvector @xmath2 .",
    "however , the solutions of the eigenvalue problem are numerically unstable . the broad histogram equation , ( [ eq - broad - histogram ] ) , can be used . in the simplest application",
    ", we can ignore the extra equations , and consider only these with smallest @xmath179 , and obtain solution from iteration , @xmath180since there are more equations of this type than the unknown @xmath2 , we can use least - squares method .",
    "our experience suggests that we should view the problem as an optimization with nonlinear constraints .",
    "there are two possible models for an optimization solution . introducing the optimization variable @xmath181 , consider , @xmath182subject to any known constraints .",
    "for the @xmath183-dimensional ising model , we have @xmath184the three conditions are the symmetry between low and high energies , the degeneracy for the ground states , and the total number of states .",
    "the weight @xmath185 is the variance of the monte carlo estimates of the quantity @xmath186 .",
    "the above minimization problem is essentially a linear problem .",
    "we solve it by an iterative method .",
    "the second , different formulation of the optimization is expressed in variable @xmath187 , @xmath188where @xmath189 is monte carlo estimate with error @xmath190 , and @xmath191 is unknown . the minimization is subject to the conditions @xmath192the last one is symbolically a @xmath76 identity , see eq .",
    "( [ eq - ttt - identity ] ) for a concrete example . for the ising model ,",
    "there is also an additional symmetry relation @xmath193this set of constraints is much more difficult to handle .",
    "intuitively , this second optimization problem should give better result than the first one .",
    "however , this is not the case , at least for the two - dimensional ising model . for this model , optimization in @xmath194 , eq .",
    "( [ eq - opt - t ] ) , gives twice the error ( @xmath195 defined below ) of the first optimization method .",
    "a simple iteration with eq .",
    "( [ eq - simple - iter ] ) and @xmath196 has 4 times the error comparing to optimizing solution of eq .",
    "( [ eq - minimize - n ] ) and ( [ eq - opt - n2 ] ) .",
    "= 0.90    figure  [ fig - n - conv ] is another convergence test plot for algorithm 0 and a two - stage simulation , both with @xmath50-fold way , on the two - dimensional ising square lattices . in this plot",
    ", we consider the relative error per energy level for density of states , @xmath197 the normalization by @xmath156 is to exclude ground state energy and its symmetric state energy , for which the exact values are imposed . the exact value @xmath2 is obtained according to ref .",
    "@xcite ; @xmath198 is monte carlo estimate obtained from solving eq .",
    "( [ eq - minimize - n ] ) with @xmath199 .",
    "we see signs of slower convergence for large lattice sizes for algorithm 0 .",
    "a two - stage simulation improves the efficiency to that of using the exact density of states in flip rates .",
    "we first apply the algorithm 0 using cumulative average in the flip rates ; we then apply algorithm @xmath177 ( lee s method of multi - canonical algorithm ) , using the density of states obtained in the first step .",
    "both steps use the same number of monte carlo sweeps .",
    "with the two - stage algorithm , the slowing down is roughly @xmath200 , using a similar definition as given in eq .",
    "( [ eq - fluctuation ] ) .",
    "= 0.90      we have already presented two correlation times  @xmath155 characterizes the convergence of the histogram and @xmath201 characterizes the convergence of the density of states . both of them showed the effect of reduced performance when the size is increased . by definition of the correlation times @xmath155 and @xmath201 , they also measure roughly how many monte carlo steps are needed to generate independent samples .",
    "of course , in @xmath201 , it also reflects the effect of data analysis methods .",
    "another measure of the performance of algorithms is the tunneling time . in our study , we define the tunneling time as the average monte carlo steps that the system in the lowest energy state goes to the highest energy state , or vice versa .",
    "more precisely , as soon as a ground state is reached , we record the current monte carlo move @xmath202 , and then look for the highest energy , which may happen at @xmath203 .",
    "we then look for the ground state again .",
    "the difference @xmath204 consists of one sample for the tunneling time .",
    "the tunneling time for the two - dimensional ising model is very well described by @xmath205 ( in units of sweeps ) . an ideal random walk in the space of energy would have an exponent of 2 ( @xmath206 in general ) .",
    "the dynamics is close but not quite random walk in energy .",
    "the spin glass is one of the most difficult systems to simulate .",
    "the performance of the flat histogram algorithm for the two - dimensional @xmath207 spin glass is presented in ref .",
    "@xcite . in fig .",
    "[ fig - tun ] , we show the tunneling time as a function of system linear size @xmath208 for three algorithms ( algorithm 0 and 1 with @xmath50-fold way , and algorithm 0 without @xmath50-fold way ) on the three - dimensional ising spin glass . the gain from @xmath50-fold way as comparing to standard",
    "single - spin - flip is by a constant factor .",
    "the equal - hit algorithm is about a factor of 6 faster in tunneling times than the algorithm 0 without @xmath50-fold way .",
    "unfortunately , this gain is not very significant as the @xmath50-fold - way program runs few times slower than standard single - spin flips .",
    "the slowing down exponent is about 8 , this is comparable to that of multi - canonical method @xcite .",
    "the stochastic matrix @xmath12 describes monte carlo dynamics in the space of spin configurations .",
    "such state space is extremely large , containing @xmath209 states , from which monte carlo moves sample only a very small fraction . on the other hand",
    ", we introduced a new stochastic matrix @xmath60 in a coarse - grained space of energy .",
    "the matrix @xmath12 and @xmath60 are related by eq .",
    "( [ eq - t - matrix - definition ] ) .",
    "we shall call the dynamics induced by this stochastic matrix energy transition matrix dynamics . in discrete time step @xmath210 ,",
    "the dynamics describes the evolution of the histogram @xmath211 as @xmath212what is the significance of this dynamics ?",
    "the dynamics describes the change of energy distribution through the following single - spin - flip moves : given the current state @xmath4 with energy @xmath3 , pick a new state @xmath10 with the same energy @xmath3 among all the @xmath2 degenerate spin states with equal probability , flip a spin according to the usual spin flip rate as embedded in @xmath12 .",
    "as we can see , since the state changes at random to a completely new state of the same energy to try another flip , its dynamics is substantially faster than single spin flip or even cluster flip .",
    "unfortunately , such dynamics is not realizable on a computer , but it is of interest for comparison with realizable algorithms .",
    "we can say more about the dynamics given by eq .",
    "( [ eq - discrete - tmmc ] ) .",
    "let us first convert the equation into continuous time which is more convenient for analytic treatment , and which is a valid description for moderately large system . introducing @xmath213 and @xmath214 and define @xmath215 , we have @xmath216 dividing both side by @xmath54 , taking the limit of large @xmath50 , we have @xmath217 where the continuous time transition matrix @xmath218 is related to the discrete step matrix by @xmath219 .    two results were initially reported in ref .",
    "detailed derivations will be given in appendices .",
    "firstly , an explicit form of @xmath220 can be given for the one - dimensional ising model with glauber flip rate , as @xmath221where @xmath222 , @xmath223 , and @xmath50 is the chain length .",
    "the diagonal term is computed from the relation @xmath224and the rest of the elements @xmath225 if @xmath226 .",
    "secondly , equation ( [ eq - t - conti ] ) is continuous in time but still discrete in energy",
    ". we can go one step further to consider the limit of both time and energy to be continuous . for transition matrix associated with canonical ensemble",
    ", we found a partial differential equation in such limit as @xmath227where @xmath228 and @xmath229 are properly scaled energy fluctuation and time : @xmath230and @xmath231 with @xmath232where @xmath233 is the average energy per spin and @xmath234 is the reduced specific heat per spin .",
    "this equation , ( [ eq - diffusion ] ) , is equivalent to the one - dimensional quantum harmonic oscillator equation , thus the analytic solutions are readily obtained .",
    "the most important consequence of this equation is that the relaxation time is proportional to the specific heat of the system .",
    "this result can also be seen from a less rigorous point of view . since this artificial dynamics",
    "involves a random walk on the probability distribution of the energy , the characteristic relaxation time will be proportional to the square of the energy fluctuation , @xmath235 , which is in turn proportional to the specific heat .",
    "in the single histogram method @xcite , one performs a canonical ensemble simulation at a fixed temperature @xmath236 , and collects the histogram @xmath22 . the histogram is proportional to @xmath237 , so an estimate to the density of states is obtained from @xmath238 once we have the density of states , we can use it to evaluate thermodynamic quantities at any temperature .",
    "= 0.90    unfortunately , since @xmath22 is approximately a gaussian function with mean @xmath239 and variance @xmath240 , where @xmath241 is the specific heat per spin , the accuracy of the estimates deteriorates exponentially outside the energy window of order @xmath242 , c.f .  fig .",
    "[ fig - tmfs - err ] .",
    "detailed error analyses for energy and specific heat are given in @xcite .",
    "the region of good accuracy coincides with the critical region at a second order phase transition , so the single histogram method is still an extremely valuable tool to study phase transitions .",
    "the transition matrix approach can also be used in a way similar to single histogram method , i.e. , collecting the statistics of the transition matrix in a canonical simulation .",
    "numerical comparison suggests that the two methods are comparable in accuracy .",
    "in fact , as we can see in fig .",
    "[ fig - tmfs - err ] , for a certain interval , the transition matrix gives results which are up to 10 times better , but become comparable or worse outside the limited range of @xmath3 . if we use the two results to compute the average energy or heat capacity , we found that the errors are about the same @xcite .",
    "the reason is that the contributions to errors are dominated by the tails of the histogram distribution @xmath22 , at these ranges , the density of states is of comparable accuracy .",
    "it is somewhat disappointing that the single histogram method and transition matrix monte carlo analysis are of the same accuracy .",
    "some improvement can be made by a careful analysis using baysian method @xcite .",
    "but it is unlikely that we can bring about an improvement of order @xmath242 for the accuracy .      both of the multiple histogram method @xcite and the multi - canonical method @xcite",
    "give density of states over a wide range .",
    "while the multiple histogram method uses a collection of standard canonical simulations , the multi - canonical method uses only one simulation . in reality",
    ", a multi - canonical simulation needs to be iterated few times to converge to the desired ensemble . in this respect , the flat histogram method takes at most three iterations .",
    "the first iteration already gives excellent results , although there are noticeable biases for large systems ; the second iteration with fixed flip rates greatly improves the accuracy ; the third iteration would give correct sample average for the transition matrix as well as correct multi - canonical ensemble .",
    "= 0.90    the additional benefit of using the transition matrix is improved accuracy comparing to other methods , within the same simulation runs .",
    "figure  [ fig-2d16lee ] shows the accuracy of the density of states for two - dimensional ising model on a @xmath243 lattice .",
    "we note that the accuracy is sensitive to the constraints imposed with the optimization .",
    "this extra accuracy comes about due to the nature of the samples that are taken . in histogram or multi - canonical methods , each new state",
    "gives one count in the histogram , while @xmath50 counts are collected from each state for the matrix .",
    "naively , we expect an improvement by a factor of @xmath50 in terms of the variance , since each state contributes 1 for the histogram , and each state contributes a number of @xmath132 for the transition matrix . while the accuracy of the transition matrix elements does improve as the system size increases ( may be by @xmath244 for the error ) , as has been pointed out by others @xcite , this accuracy is lost in the density of states .",
    "this is due to accumulation of errors , as the transition matrix elements only determine the ratio of the density of states , c.f .",
    "( [ eq - simple - iter ] ) .",
    "if we use a simple iteration method starting from the ground state , we see that this extra accuracy in the matrix elements gets canceled exactly by the accumulation of errors .",
    "however , the optimization methods of determining @xmath2 make the error analysis difficult . here are some quantitative comparisons .",
    "we take the exact multi - canonical rate ( algorithm @xmath177 ) in simulation , and collect both the transition matrix and the histogram . with transition matrix , the average relative errors of the density of states defined by eq .",
    "( [ eq - n - err ] ) for the two - dimensional ising model of size @xmath245 , 8 , 16 , 32 , and 50 with @xmath246 monte carlo steps in each run are 0.0003 , 0.0012 , 0.0037 , 0.011 , 0.024 , respectively .",
    "the corresponding results computed by histograms are 0.0033 , 0.010 , 0.027 , 0.058 , 0.10 , respectively . in general , transition matrix method performs better than histogram based methods , as we have shown numerically .",
    "a proposal to use the transition matrix was given by smith and bruce @xcite in 1995 in connection with multi - canonical simulation .",
    "this is further developed by fitzgerald _",
    "et al _ @xcite .",
    "the canonical transition probability ( ctp ) method @xcite also estimates the transition matrix and uses energy detailed balance equations to estimate the canonical distribution . in the simplest version , instead of collecting the histogram @xmath22",
    ", a matrix @xmath247 is incremented by 1 for every monte carlo move from state with energy @xmath3 to state with energy @xmath248 .",
    "clearly , this quantity is an estimator of @xmath249 .",
    "the transition matrix is obtained by @xmath250 .",
    "both of the above methods and the present method are similar in the way that transition matrix is used .",
    "however , there are two important differences : ( 1 ) in ctp method , only the current move is used for statistics , not all possible moves of the state ; ( 2 ) the simulation is performed in canonical ensemble at a given temperature .",
    "= 0.90    very recently , wang and landau @xcite proposed an intriguing method to determine the density of states .",
    "the dynamics follows the usual multi - canonical simulation or entropic sampling , by the single - spin - flip rate @xmath251",
    ". however , @xmath2 is not a constant , but is updated at each step of trial move with @xmath252 for the current energy @xmath3 .",
    "this is somewhat like the lee s method of entropic sampling , but to some extent the updating of the weights are done at every move .",
    "if @xmath253 were greater than 1 , the algorithm would never converge , so the idea is to reduce @xmath253 after some monte carlo steps , by @xmath254 , for example .",
    "a criterion of flatness of the histogram was used to determine if @xmath253 should be reduced .",
    "wang and landau s idea can be adopted in the context of transition matrix .",
    "for example , we can consider updating the logarithm of density of states , @xmath255 , using the information from the transition matrix by @xmath256 where @xmath257 is some small parameter and @xmath258 is the predicted logarithmic density of states , based on @xmath259 possible hops from @xmath260 to the current @xmath3 .",
    "if we already know the ground state degeneracy , we can fix it to the constant .",
    "unlike the updating rule @xmath261 which makes @xmath2 grow indefinitely , @xmath262 will converge to the exact value",
    ". this generalization does give more accurate results than algorithm 0 if it converges to flat histogram .",
    "however , it appears to have the problem of sticking to a gaussian - like distribution for the histogram for large systems .",
    "we made an extensive test of the accuracy of the random walk algorithm of wang and landau .",
    "in general , the random walk algorithm is far inferior to the flat histogram algorithm in terms of accuracy and rate of convergence to flatness , particularly for small systems . for the original implementation of the method ,",
    "once the system passes the transient period , the error becomes independent of the total monte carlo steps used and the system sizes , and is primarily determined by how slowly @xmath253 is reduced .",
    "this feature is useful for its robustness , particularly for large systems .    in fig .",
    "[ fig - wl - compare ] we plot average errors in the density of states as defined by eq .",
    "( [ eq - n - err ] ) for fixed monte carlo steps of @xmath246 ( @xmath263 for the two - stage algorithm ) .",
    "it is clear that all methods have bigger errors for larger systems .",
    "but the random walk algorithm is generally order of magnitudes worse than the best transition matrix based methods .",
    "the sharp increase of the error with system sizes from 16 to 32 , and to 50 for the random walk algorithm is an indication that with @xmath246 steps , the system is still in transients for these sizes . if @xmath264 monte carlo steps are used , the random walk algorithm comes closer to the accuracy of algorithm 0 at size @xmath265 .",
    "the two - stage method ( algorithm 0 followed by algorithm @xmath177 , both using @xmath50-fold way ) gives the best performance .",
    "the transition matrix approach can be used for continuous degrees of freedom . in such applications ,",
    "both the dynamic variables and energy spectrum have to be discretized .",
    "et al _ have applied the broad histogram method to the xy model @xcite .",
    "the important issue here is how to control the numerical error caused by discretization .",
    "it is straightforward to generalize the transition matrix to more than one macroscopic variable , such as energy and magnetization ; in fact , this has already been done @xcite with the broad histogram method .",
    "this approach may have problems , particularly when the hamiltonian is complicated .",
    "first , the matrix may be too large to handle in general .",
    "second , with more elements to fill , the statistics for individual entry is poor .",
    "this makes the method less robust .",
    "the transition matrix simulation can be parallelized very efficiently , where each processor works on separate configurations , using and updating a common transition matrix .",
    "each processor can be limited to work on a range of energies .",
    "the advantage of this is clearly a fast way of approaching the flat distribution for the histogram .",
    "starting from the detailed balance equation , we have formulated the transition matrix in energy .",
    "the infinite - temperature version of this matrix serves as the basic data from which we determine the density of states and at the same time is used for construction of flat - histogram and equal - hit algorithms .",
    "this method of simulation together with optimization method to determine the density of states offers a better way of computing thermodynamic quantities by monte carlo simulation .",
    "in such an approach , a single simulation produces the whole function of temperature ( or other parameter of the model ) through re - weighting .",
    "it is efficient and easy to implement .",
    "as the use of accumulated average for the transition rates causes slow convergence for large systems , a two - stage iteration is recommended and is enough to get the best convergence .",
    "dynamically , the flat - histogram algorithm for long simulations is equivalent to the multi - canonical method . using the equal - hit algorithm together with @xmath50-fold way",
    "offers additional benefits .",
    "we thank fugao wang for providing us his programs for the random walk simulation .",
    "we also thank lik wee lee , bernd a. berg , and fei fan for comments on the manuscript . j .- s .",
    "w. is supported by nus and singapore - mit alliance research grants .",
    "we consider the single - spin - flip dynamics with a random pick of spins and the glauber flip rate @xmath266.\\ ] ] in one dimension for the ising model , the quantity @xmath267 can be evaluated exactly .",
    "let us first define a set of new variables @xmath268 .",
    "@xmath269 is 1 for a satisfied bond , and 0 for an unsatisfied bond .",
    "the mapping from @xmath270 to @xmath271 is unique modulo an overall spin up - down symmetry .",
    "we assume periodic boundary condition and lattice size @xmath50 to be even .",
    "there are three possible energy changes , @xmath272 , 0 , @xmath273 .",
    "if the original spin of a site and the spins of two neighboring sites all have the same sign , it contributes one count for the total @xmath274 . in terms of @xmath269 , it requires two consecutive satisfied bonds , i.e. , @xmath275 .",
    "thus we can express @xmath276 in terms of @xmath269 as @xmath277 note that only @xmath156 variables @xmath269 , @xmath278 , are independent ( since @xmath279 must be even ) .    a microcanonical average at energy @xmath3 needs to be carried out .",
    "let us use @xmath280 to label the equally spaced energy levels , @xmath281 .",
    "then @xmath282 , and @xmath283 .",
    "the microcanonical average can be expressed as a summation over all @xmath269 subject to @xmath284 being an integer constant .",
    "thus we have @xmath285 and similarly @xmath286 the factor 2 is due to the two - to - one mapping from @xmath270 to @xmath271 . in order to compute the above sums , we consider the statistical mechanics problem of a one - dimensional lattice gas with the hamiltonian , @xmath287 the partition function of this system ( at @xmath288 ) is @xmath289 taking the derivative with respect to @xmath290 , we have @xmath291 where @xmath292 .",
    "the desired quantity is obtained from the generating function @xmath27 as @xmath293 .",
    "the partition function is obtained by the standard trick of transfer matrix .",
    "we find @xmath294 where @xmath295 are the eigenvalues of the matrix @xmath296.\\ ] ] after some algebra , we find @xmath297 thus @xmath298 a similar derivation from a slightly different hamiltonian gives @xmath299 combining the above results with the density of states for the ising model , @xmath300 $ ] , which is readily obtained by the combinatorial problem of putting @xmath301 unsatisfied bonds in @xmath50 places , we obtain the expressions given in eq .",
    "( [ eq-1d - exact - a ] ) and ( [ eq-1d - exact - b ] ) .",
    "we start from the dynamical equation @xmath302 where time @xmath1 is continuous but energy @xmath3 is discrete .",
    "the aim is to consider the continuous energy limit .",
    "this limit is natural and is a very good approximation for large systems .",
    "we follow the general method known as @xmath303 expansion @xcite .",
    "let us introduce a new variable , @xmath304 where @xmath305 will be determined later . since @xmath3 is of order @xmath50 ,",
    "naively @xmath306 is of order @xmath242 .",
    "however , by choosing @xmath305 to be the average of @xmath307 , we cancel the leading @xmath50 dependence ; @xmath306 is actually of order 1 , measuring the relative fluctuation around mean .",
    "we look for nontrivial solution in variable @xmath306 in the scaling limit of @xmath308 , keeping @xmath306 fixed .",
    "more precisely , we find equation in @xmath306 such that the coefficients of the differential equation are independent of @xmath50 .",
    "consider the function in terms of @xmath306 as @xmath309 .",
    "we also write @xmath218 in @xmath306 as @xmath310 where @xmath311 is the change of energy associated with @xmath84 , and @xmath312 , @xmath313 .",
    "we assume a @xmath183-dimensional ising model in the derivation .",
    "replacing @xmath3 by @xmath314 , @xmath84 by @xmath315 , equation  ( [ eq - energy - discrete ] ) becomes @xmath316 the crucial step now is to take taylor expansion assuming @xmath317 small , and to find equation that is leading order in the large @xmath50 limit .",
    "for notational convenient , we shall drop the tildes on @xmath318 and @xmath319 , which actually denote different functions .",
    "we know in the limit @xmath308 , @xmath320 and @xmath321 are smooth functions in @xmath306 .",
    "then ( omitting the variable @xmath1 for clarity ) @xmath322 the primes denote derivatives with respect to @xmath306 .",
    "we should note that in the large @xmath50 limit with @xmath306 fixed , @xmath323 and its derivatives do not contain @xmath50 .",
    "the @xmath50 dependence is made explicit by the above expansion .",
    "substituting eq .",
    "( [ eq - expansion ] ) into eq .",
    "( [ eq - new - variable ] ) , we have @xmath324 where @xmath325 naively , since @xmath60 is @xmath132 , we expect @xmath326 , @xmath327 , and @xmath328 and the equation does not have a well - defined large @xmath50 limit . but this is not true , due to special relations among @xmath329 . two relations are important in the derivation below to show that both @xmath330 , @xmath331 , and @xmath332 are of @xmath134 and the third derivative can be dropped in the large @xmath50 limit .",
    "the existence of an equilibrium implies @xmath333 expressed in @xmath321 , it is @xmath334 thus , using @xmath335 from the above @xmath336 \\\\ & = & \\sum_{i \\neq 0 } \\left [ t_i^{\\prime}(x ) { \\frac { i\\,a } { \\sqrt{n } } } - { \\frac{1}{2 } } t_i^{\\prime\\prime}(x ) { \\frac { ( i\\,a)^2 } { n } } + \\cdots \\right].\\end{aligned}\\ ] ] the last equation above used a taylor expansion . since @xmath321 has a scaling form @xmath337 in the large @xmath50 limit , we find that the @xmath338-th derivative of @xmath321 at @xmath339 is of order @xmath340 .",
    "thus @xmath341 is of order @xmath242 , and we can safely replace @xmath306 by 0 , and find @xmath342 for @xmath331 , we make an expansion in @xmath306 for @xmath321 and find @xmath343 where in the last formula , the first term is of order @xmath242 , the second term is of order 1 , and last term is of order @xmath244 . if the first term were there , we would have an ill - defined limit .",
    "so we must require that @xmath344 this is in fact a condition to fix @xmath305 .",
    "we shall show that this condition requires @xmath345 , the canonical average of energy per spin .",
    "we evoke the energy detailed balance equation , ( [ eq - energy - detailed - balance ] ) . in terms of the new variables @xmath306 and @xmath116 , it is @xmath346 let @xmath347 , taylor expanding the terms involving @xmath348 , we find : @xmath349^{\\prime}\\delta + t_{-i}^{\\prime}(0 ) \\delta + o\\left ( { \\frac{1 } { n } } \\right).\\ ] ] note that the first term is of order @xmath350 , the second term of order @xmath134 .",
    "it is important to realize that we are looking for the scaling limit of @xmath308 , fixing @xmath306 .    substituting this equation into the expression for @xmath351",
    ", we find @xmath352 { \\frac{k a } { \\sqrt{n } } } \\approx \\sum_{k=1,2,\\cdots , d } k^2 t_k(0 ) [ \\ln h_{eq}(0 ) ] ^{\\prime}{\\frac{a^2 } { n}}.\\ ] ] the requirement that @xmath353 is equivalent to say that @xmath339 is at the extreme of equilibrium probability distribution .",
    "when the first term in @xmath331 is set to 0 , we have @xmath354 the coefficient @xmath332 is a constant to leading order in @xmath50 : @xmath355    the equilibrium distribution of energy for large system is a gaussian distribution with mean @xmath356 , and variance @xmath357 where @xmath358 is reduced specific heat per spin , thus @xmath359 substituting this result into the partial differential equation in equilibrium @xmath360 we find @xmath361 . this same relation can also be obtained using detailed balance equation .",
    "changing variables from @xmath1 to @xmath362 and from @xmath306 to @xmath363 , we obtain eq .",
    "( [ eq - diffusion ] ) .",
    "the file below is the raw data for various errors .",
    "formally this is not part of the paper .",
    "we included here which could be useful for future benchmarking use .",
    "1     14.961 15.059 15.043 13.995 14.299 15.357 13.330 14.241 14.455 15.883 13.859 16.06 13.776 15.237 10    6.480   8.107   7.795   6.509   6.33    8.83    5.52    5.40    6.79    9.91    6.32    9.68   6.41    8.09 100   0.681   0.819   0.736   0.759   2.28    1.09    0.710   0.713   0.667   1.29    1.47    1.00   1.171   0.825 1000 0.188   0.204   0.210   0.234   1.50    0.320   0.221   0.221   0.199   0.226   0.581   0.227 0.370   0.256 1e4   0.0608 0.0644 0.0663 0.080   1.00    0.14    0.070   0.070   0.064   0.076   0.539   0.079 0.256   0.094 1e5   0.0181 0.0206 0.0215 0.030   0.698   0.070   0.0219 0.0224 0.0201 0.0246 0.5353 0.026 0.2136 0.0349 1e6   0.0060 0.0064 0.0070 0.0098 0.43    0.044   0.0067 0.0077 0.0064 0.0085 0.533   0.008 0.131   0.0144 1e7 0.00186 0.0020 0.0021 0.0040 0.357   0.0172 0.0024 0.0023 0.0021 0.0030 0.5342 0.0026 0.0926 0.0047 1e8          0.00062 0.00066       0.29    0.012                                             0.0842      mcs   -1      0       1       2       3       4       5       6       7       8       9       10     11      12    1    16.448   15.26   15.263 15.178 15.307 15.31   15.18   15.31   15.41   15.30   15.31   15.31 15.54   15.30 10    9.329   9.162   9.165    100   1.286   1.583   1.599 1000 0.287   0.312   0.310 1e4   0.093   0.097   0.095 1e5   0.0287 0.0311 0.0314               algo no ( error at n - fold mcs=1e4 ) best         -1      ( 0.061 ) very good    0,1,7   ( 0.065 ) good         5,6,8   ( 0.07 ) ok           2,10    ( 0.08 ) not so good 4,12    ( 0.1 )",
    "bad ( converge ) 3,11 ( > 0.25 ) do n't converge 9    ( 0.5 )      2d ising model , e_n = ( 1/(n-1 ) ) sum | n(e)/n_ex(e ) - 1 |                     algo 0 ( n - fold - way ) mcs       l=4           l=8            l=16        l=32         l=50 1         1.200         10        0.152         1.38^ 100       0.0340        0.212          1.3^ 1000      0.0109        0.0492         0.20        1^ 1e4       0.00342       0.0154         0.0568      0.28         0.31   1e5       0.00108       0.0054         0.0189      0.084        0.23 1e6       0.000338      0.00154        0.0066      0.07         0.22+/-0.02 1e7       0.000110      0.00051        0.0024      0.042        0.191+/-0.0138",
    "1e8       0.000035      0.000190       0.0009      0.022        0.16         2d ising model , e_n = ( 1/(n-1 ) ) sum | n(e)/n_ex(e ) - 1 |               algo 1 ( n - fold - way , equal - hit ) mcs       l=4           l=8            l=16        l=32         l=50 1         1.20 10        0.142         1.27 100       0.0410        0.178 1000      0.0134        0.051          0.26   1e4       0.0042        0.0152         0.048       0.18^        0.4 1e5       0.00138       0.0050         0.015       0.04         0.12^ 1e6       0.00044 1e7       0.00015    2d ising model , e_n = ( 1/(n-1 ) ) sum | n(e)/n_ex(e ) - 1 |            algo -1 ( n - fold - way ) ( exact rate , best we can do ) mcs       l=4           l=8            l=16        l=32         l=50 1        1.32    10       0.131        14 100      0.031         0.18   1000     0.0097        0.038          0.16 1e4      0.0030        0.0125         0.041        0.13         0.23 1e5      0.00096       0.00383        0.0121       0.037        0.07 1e6      0.00031       0.00119        0.0037       0.0114       0.024   1e7      0.000095      0.00040        0.00122      0.00337      0.007 1e8      0.000032      0.000103       0.00045      0.00091    ising model , same as above algo -1 n - fold - way , but use histogram to compute n(e ) , i.e. berg / lee method mcs       l=4           l=8            l=16        l=32         l=50 1e5      0.010          0.033         0.0733       0.32         0.5 1e6      0.0033         0.0099        0.027        0.058        0.10     2d ising model , e_n = ( 1/(n-1 ) ) sum | ... | two stage simulation , stage 1 , using algo 0 ,                         stage 2 , using algo -1 of n(e ) generated from stage 0 .",
    "same run length for the two stages mcs        l=4          l=8        l=16            l=32         l=50 100       0.0311        0.26                     1000      0.0096        0.0404     0.10 10000     0.0030        0.0122     0.0401          0.2          0.5 1e5       0.00100       0.00349    0.0131          0.038        0.075 1e6       0.00036       0.00123    0.0034          0.0133       0.017 1e7                    0.00038    0.0016          0.0029       0.0074 1e8                              0.0004          0.0010    modified wang fg / wang js method ( algo 13 ' ) , e_n = ( 1/(n-1 ) sum | ... | using s(e ) < - s(e ) + eta ( s^pred - s(e ) ) ( eta = 0.1 )   ( two numbers - using tmatrix / using s(e ) directly ) mcs   l=4             l=8             l=16           l=32 100 1000 0.00936/0.358 1e4   0.00306/0.0087 0.39/0.96 1e5   0.00096/0.0028 0.0039/0.015   0.99/0.99 1e6                  0.00115/0.004 0.71/0.99 1e7                  0.00049/0.0014    wang fugao 's program ( fixed mcs , f_max = 2.718 , f_min=1 , 80%h , check every 1k steps ) e_n = < | n(e)/n_ex(e ) - 1 | > mcs        l=4          l=8        l=16            l=32         l=50 1e4       0.172       10^ 1e5       0.065        0.073      1 1e6       0.066        0.049      0.066            0.36         9(+/-4 ) 1e7       0.055        0.073      0.043            0.05         0.18 1e8       0.069        0.047      0.07             0.025        0.14",
    "wang fg method e_n ( my program algo 13 , 80%h , checks 30 times , single - spin - flip ) mcs        l=4          l=8        l=16            l=32         l=50 1e4        0.079        1.62 1e5        0.034        0.071      0.7 1e6        0.012        0.031      0.056          0.42          5.5 1e7",
    "0.0044       0.010      0.025          0.06          0.14 1e8        0.0013                                            0.02 ....    99 k. binder , ( editor ) , `` monte carlo methods in statistical physics , '' topics in current physics , vol 7 , springer - verlag ( 1979 ) ; `` applications of the monte carlo method in statistical physics , '' topics in current physics , vol 36 , 2nd ed . , springer - verlag ( 1987 ) ; `` the monte carlo method in condensed matter physics , '' topics in applied physics , vol 71 , 2nd ed . , springer - verlag ( 1995 ) ."
  ],
  "abstract_text": [
    "<S> we present a formalism of the transition matrix monte carlo method . </S>",
    "<S> a stochastic matrix in the space of energy can be estimated from monte carlo simulation . </S>",
    "<S> this matrix is used to compute the density of states , as well as to construct multi - canonical and equal - hit algorithms . </S>",
    "<S> we discuss the performance of the methods . </S>",
    "<S> the results are compared with single histogram method , multi - canonical method , and other methods . in many aspects , </S>",
    "<S> the present method is an improvement over the previous methods .    </S>",
    "<S> pacs numbers : 02.70.tt , 05.10.ln , 05.50.+q .    </S>",
    "<S> keywords : monte carlo method , flat histogram , multi - canonical ensemble . </S>"
  ]
}