{
  "article_text": [
    "riemann surfaces are important in many fields of mathematics and physics .",
    "an interesting example for their applications are quasiperiodic solutions to certain integrable partial differential equations ( pdes ) such as korteweg - de vries ( kdv ) and nonlinear schrdinger ( nls ) equation given at the beginning of the 1970s by novikov , dubrovin , its , matveev , van moerbeke , krichever and others in terms of multidimensional theta functions on compact riemann surfaces , see @xcite and references therein for a historic account . whereas the surfaces are hyperelliptic in the case of the kdv and nls equation , krichever s @xcite solutions to the kadomtsev - petviashvili ( kp )",
    "equation can be given on arbitrary compact riemann surfaces .",
    "these applications require efficient numerical tools to study riemann surfaces in cases where analytical methods are not yet available .",
    "first plots of kp solutions appeared in @xcite and via schottky uniformizations in @xcite .",
    "since all compact riemann surfaces can be defined via non - singular plane algebraic curves of the form @xmath0 with constant complex coefficients @xmath1 , deconinck and van hoeij developed an approach to the symbolic - numerical treatment of algebraic curves .",
    "their work is distributed as the ` algcurves ` package with maple , see @xcite .",
    "it works for coefficients given as exact arithmetic expressions , a restriction due to the use of exact integer arithmetic . a purely numerical approach to real hyperelliptic riemann surfaces",
    "was given in @xcite and for general hyperelliptic surfaces in @xcite .",
    "for a review of the current state of the art of computational approaches to riemann surfaces , the reader is referred to @xcite .",
    "a first adaption of the ` algcurves ` package to matlab for general complex coefficients @xmath1 was presented in @xcite .",
    "the fact that the coefficients are general floating point numbers , removed the limitations in the maple package on the coefficients which have to be converted to rational numbers , a procedure which can lead to technical problems in practice especially when families of algebraic curves are studied , i.e. , when the coefficients @xmath1 in ( [ fdef ] ) themselves depend on parameters and when one is interested in modular properties of riemann surfaces .",
    "an additional problem in this context can be computing time since the computation of the riemann matrix uses the somewhat slow maple integration routine .",
    "thus , a more efficient computation of the riemann matrix is interesting if one wants to study families of riemann surfaces or higher genus examples which are computationally expensive .",
    "therefore , the numerical approach to compact riemann surfaces presented in this paper is complementary to the maple ` algcurves ` package : whereas for examples of curves of low genus with rational coefficients the maple approach is excellent , the purely numerical approach is intended for the study of modular properties and computationally demanding higher genus surfaces .",
    "note , that a transfer of the maple package to a more efficient platform is also planned by the original authors of the ` algcurves ` package , see @xcite for a first step in this direction .",
    "the numerical approach presented in this paper allows to efficiently study solutions to integrable pdes along the lines discussed in @xcite and , for real nonsingular solutions , in @xcite . as an example we will consider here solutions to the kp equation on non - hyperelliptic riemann surfaces",
    "the code can also be used to efficiently study modular properties of riemann surfaces , which have many applications .",
    "examples in this context are determinants of laplacians on riemann surfaces which appear for instance in conformal field theories , see @xcite for an overview .",
    "a numerical study of extremal points for the determinant of the laplacian in the bergman metric on riemann surfaces of genus 2 was presented in @xcite .",
    "the modular dependence of riemann surfaces is also important in the asymptotic description of so - called dispersive shocks , highly oscillatory regions in solutions to purely dispersive equations such as kdv and nls . the asymptotic description of the rapidly modulated oscillations in the dispersive shock is given by the exact solution to the kdv equation on a family of elliptic or hyperelliptic surfaces , where , however , the branch points depend on the physical coordinates via the whitham equations @xcite , see @xcite . families of hyperelliptic curves , where the branch points depend on the physical coordinates , also appear in exact solutions for the ernst equation , which has many applications in mathematics such as the theory of bianchi surfaces , and physics such as general relativity , see @xcite for references .",
    "hyperelliptic solutions to the ernst equation were found by korotkin @xcite .",
    "the einstein - maxwell equations in the presence of two commuting killing vectors are equivalent to the electro - magnetic ernst equations .",
    "the latter have solutions on three - sheeted coverings of @xmath2 with branch points depending on the physical coordinates , see @xcite .",
    "the preliminary version of the first fully numerical approach to riemann surfaces in @xcite was very close to the ` algcurves ` package .",
    "it was found that the methods used in that package sometimes led to _ cancellation problems _ near singularities of the curves where numerically large terms cancel and thus lead to a comparatively high inaccuracy in the final result , a well known problem for numerical approaches . in this paper",
    "we present a computational approach to algebraic curves which is better suited for a purely numerical treatment .",
    "the critical points of the algebraic curve are identified with a two - dimensional newton iteration , the paths for the computation of the monodromies are constructed in numerically optimal form as in @xcite ( see also @xcite ) with a minimal spanning tree .",
    "the periods of the holomorphic differentials are computed with the clenshaw - curtis method which shows an exponential decrease of the numerical error with the number of collocation points for the analytic functions integrated here .",
    "this is to be contrasted with widely used finite difference techniques for which the numerical error decreases algebraically with the number of collocation points .    a general problem in finite precision numerical approaches are _ cancellation errors _ which occur when",
    "numerically large terms cancel resulting in a small residue with a comparatively large numerical error ( since all numerical results are given with the same finite precision ) .",
    "to avoid such errors , we make use at several occasions of the well known cauchy formula @xmath3 here @xmath4 could be a holomophic differential or the abel map , and @xmath5 is some closed contour on the riemann surface around the point @xmath6 at which cancellations occur in the evaluation of the quantity @xmath4 . since we are interested in the evaluation of such quantities at singularities or branch points of the algebraic curve , the integrand will be already known on the contours used to compute the periods , and the computation of the integral in ( [ cauchy ] ) comes at essentially no additional cost .",
    "in addition there will be no cancellations on the contours @xmath5 since by construction they avoid the critical points of the algebraic curve .",
    "thus , machine precision ( @xmath7 in our case , in practice limited to @xmath8 because of rounding errors ) can be reached also in cases where this was not possible in @xcite .",
    "the paper is organized as follows : in sect .  [ 2 ] we determine the critical points of an algebraic curve , i.e. , branch points and singular points , via a two - dimensional newton iteration .",
    "the starting points of the iteration are obtained from the zeros of the resultants of @xmath9 and @xmath10 with respect to both coordinates .",
    "the paths for the computation of the monodromies , the generators of the fundamental group of the complex plane minus the critical points of the algebraic curve , are constructed in sect .  [ 4 ] from circles around these points and connecting lines according to a minimal spanning tree . the algebraic equation for the curve",
    "is solved at a set of points on these contours . in view of the numerical integration",
    ", these collocation points are chosen as _",
    "chebychev points_. then the computation of the integrals of the candidates for the holomorphic differentials is only a scalar multiplication at negligible computational cost . in sect .",
    "[ 3 ] we compute the puiseux expansions at the singular points via the cauchy formula .",
    "these expansions are used in sect .",
    "[ 3a ] to determine a basis of the holomorphic 1-forms .",
    "the periods of the holomorphic 1-forms are computed for a homology basis constructed with the tretkoff and tretkoff algorithm @xcite .",
    "the abel map is computed for general points on the riemann surface in sect .",
    "[ 9a ] . in sect .",
    "[ 7 ] we discuss the numerical performance and convergence properties in dependence of the numerical resolution in the integration . in sect .",
    "[ 9 ] we use the characteristic quantities of the riemann surface such as the riemann matrix obtained above to compute multi - dimensional theta functions .",
    "this allows for an efficient computation of solutions to certain completely integrable equations as kp , which we discuss as an example in sect .",
    "in sect .  [ outlook ]",
    "we add some concluding remarks .",
    "in this section , we numerically identify the critical points of the algebraic curve ( [ fdef ] ) for a projection on the @xmath11-plane , i.e. , the branch points and singular points of the curve given by the set of common zeros of @xmath12 and @xmath13 , the partial derivative of @xmath9 with respect to @xmath14 . in @xcite ,",
    "these points were determined via the resultant of @xmath9 and @xmath10 , and the zeros of the resulting polynomial in @xmath11 were identified via zeng s @xcite ` multroot ` package in matlab .",
    "here we use the resultant ( both for a projection on @xmath11 and on @xmath14 ) only to obtain starting values for an ensuing two - dimensional newton iteration with some post processing for multiple zeros .      in this paper , we consider plane algebraic curves defined as a subset @xmath15 of @xmath16 where @xmath17 , where @xmath12 is an irreducible polynomial in @xmath11 and @xmath14 of the form ( [ fdef ] ) .",
    "we assume that not all @xmath18 vanish and that @xmath19 is thus the degree of the polynomial in @xmath14 . the joint degree in @xmath11 and @xmath14 ,",
    "i.e. , the maximum of @xmath20 for non - vanishing @xmath21 is denoted by @xmath22",
    ". we will always solve ( [ fdef ] ) for @xmath14 .",
    "in general position , for each @xmath11 there are @xmath19 distinct solutions @xmath23 corresponding to the @xmath19 sheets of the riemann surface . at the points",
    "where @xmath13 vanishes , there are less than @xmath19 distinct solutions and thus less than @xmath19 sheets .",
    "these points are either branch points or singularities .",
    "the @xmath11 coordinates of the points where @xmath24 and @xmath25 are given by the zeros of the resultant @xmath26 of @xmath27 and @xmath10 , the discriminant of the curve . the resultant",
    "is given in terms of the @xmath28 sylvester determinant , @xmath29    the algebraic curve is completely characterized by the matrix @xmath21 in ( [ fdef ] ) .",
    "each entry in the sylvester determinant is one of the functions @xmath30 depending on @xmath11 and thus by itself a vector of length @xmath31 .",
    "therefore , the computation of the determinant involves products of the @xmath32 , i.e. , convolutions of these vectors which are known to be equivalent to products in fourier space . to compute the resultant , we build as in @xcite the sylvester determinant ( [ resultant ] ) of the discrete fourier transforms of the vectors",
    "each vector in this determinant is divided by @xmath19 for numerical reasons .",
    "the determinant is obtained in fourier space , and the resultant follows from this via an inverse fourier transform .",
    "an analogous resultant can be constructed for the projection on @xmath14 leading to a polynomial in @xmath14 only .",
    "the roots of the resulting polynomial in @xmath11 gives the @xmath11 coordinates of the points , where @xmath34 .",
    "note that the resultant is also used by the ` algcurves ` package to determine the critical points .",
    "the use of exact integer arithmetics in that package has the consequence that there are no rounding problems .",
    "this is in contrast to the numerical approach of @xcite and the present paper , where finite precision arithmetic is used .",
    "this necessitates a careful rounding of all numerical results to a certain number of digits ( limited by machine precision )",
    ". typically we aim at a precision @xmath35 which can be freely chosen between @xmath36 and @xmath37 .",
    "root finding in matlab is possible via the ` roots ` function .",
    "it uses efficient algorithms to find the eigenvalues of the _ companion matrix _ , i.e. , the matrix which has the studied polynomial as the characteristic polynomial .",
    "the eigenvalues are determined to machine precision which does not mean , however , that the zeros of the polynomial with coefficients within roundoff error are determined with machine precision .",
    "problems occur if there are multiple roots or roots which are almost identical .",
    "it is well known that the computation of multiple roots is a long standing numerical challenge , see for instance @xcite for references .",
    "the most common approaches in this context use multiprecision arithmetic , i.e. , more than 16 digits , and need exact coefficients of the polynomials .",
    "this is also the main reason why the maple ` algcurves ` package uses exact integer arithmetic .",
    "however , if the coefficients of the polynomials are not exact , but approximated by floating point numbers , this will inhibit the identification of correct multiple roots .",
    "finite precision in the coefficients of the polynomial turns multiple roots into clusters of simple roots .",
    "consider for example the case of the klein curve , the curve of lowest genus with the maximal number of automorphisms , in the form @xmath38 the resultant with respect to @xmath11 for this curve has the form @xmath39 . after rounding , our procedure gives the correct coefficients of the polynomial up to machine precision , but instead of the root at 1 with multiplicity 12 , ` roots(r(x ) ) ` returns the following cluster of roots ,    ....",
    "1.1053 + 0.0297i         1.1053 - 0.0297i         1.0736 + 0.0790i         1.0736 - 0.0790i         1.0224 + 0.1032i         1.0224 - 0.1032i         0.9686 + 0.0980i         0.9686 - 0.0980i         0.9264 + 0.0686i         0.9264 - 0.0686i         0.9037 + 0.0245i         0.9037 - 0.0245i , ....    a consequence of the finite precision ( the error in the above roots is of the order of the 12th root of the rounding error ) .",
    "the identification of multiple roots within the available numerical precision is thus a crucial problem in the numerical study of algebraic curves with non - exact coefficients . in @xcite",
    "we used zeng s matlab package ` multroot ` . as discussed in more detail in @xcite ,",
    "two algorithms are used by ` multroot ` to identify multiple roots : the first algorithm identifies tentatively the multiplicity of the roots , the second uses a newton iteration to determine the roots corresponding to this multiplicity structure to machine precision .",
    "the code provides an estimation of the forward and backward error at some given point @xmath11 via an approximate function @xmath40 is defined as the difference @xmath41 ; the backward error is defined as the difference @xmath42 , where @xmath43 is the value for which @xmath44 . ] and varies with the multiplicity structure to minimize the backward error .",
    "the ` multroot ` package is very efficient . for the above example of the klein curve ( [ klein ] ) , it finds the two zeros 0 and 1 with multiplicity 6 and 12 , respectively . as mentioned above",
    ", rounding is important in this context .",
    "the disadvantage of the approach to identify the critical points of an algebraic curve via the resultant is that the zeros of a high order polynomial in one variable have to identified .",
    "this gives the values of @xmath11 , and the corresponding values of @xmath14 are computed a posteriori by solving ( [ fdef ] ) for each of these @xmath11 values . if the degree of the polynomial obtained from the resultant gets too high , the ratio of the estimated forward to backward error will be comparable to the maximal precision accessible in matlab , and the results for the roots via ` multroot ` will not be reliable .",
    "instead we solve here the equations for both @xmath11 and @xmath14 values simultaneously , i.e. , we solve two polynomial equations in two variables at the same time instead of one polynomial in one variable of considerably higher order than @xmath19 . in the example of the klein curve ( [ klein ] ) , these would be the polynomials @xmath45 and @xmath46 .",
    "visibly the multiplicity of the zero in @xmath11 at @xmath47 is much lower than for the resultant , 2 instead of 12 .",
    "whereas the problems with multiple zeros persist , they are thus of considerably lower order .",
    "if , as in the example of the klein curve or of hyperelliptic curves , one of the polynomials @xmath48 or @xmath10 depends only on one variable @xmath11 or @xmath14 , the zeros of this polynomial are determined with ` roots ` .",
    "the resulting roots are taken as starting values for a standard one - dimensional newton iteration to improve the accuracy of the found roots and to identify multiple roots as discussed below for the general case .",
    "the second polynomial is then used to determine for each of these roots the corresponding values of the second variable @xmath11 or @xmath14 .    in the general case where none of the two polynomial equations to be solved reduces to one dimension",
    ", the starting values for the newton iteration are obtained from the resultants of @xmath48 and @xmath10 with respect to both @xmath11 and @xmath14 .",
    "the zeros @xmath49 , @xmath50 and @xmath51 , @xmath52 ( since some of the finite zeros in one variable can correspond to infinite values in the other , @xmath53 is not necessarily equal to @xmath54 ) , of these polynomials are identified via ` roots ` . as in the example of the klein curve above , multiple roots are determined with a considerable numerical error .",
    "therefore the roots need to be paired in a way to minimize the residual of the two equations @xmath48 and @xmath10 .",
    "note that this residual can be rather large for zeros of high multiplicity .",
    "up to values of @xmath55 for this quantity , we observe convergence of the newton iteration up to machine precision , in general within a few iterations .    whereas the found roots will satisfy the equations @xmath56 and @xmath57 to machine precision , as in the example of the klein curve this does not mean that multiple roots are identified with this precision .",
    "thus roots which coincide to a certain precision , which can be chosen by hand , are identified . in the examples discussed in the following , a tolerance of @xmath58 was chosen .",
    "if the ratio of the smallest distance between any two critical points to the largest distance between any two finite critical points is smaller than @xmath59 , the code issues a warning .",
    "given the multiplicity of the roots of the equations @xmath56 and @xmath57 , the code determines the singular points , i.e. , the points with @xmath60 .",
    "all roots @xmath61 with a multiplicity greater than one are tested in this context : it is checked whether @xmath62 with the same precision used for the check of multiple roots . in this way",
    "we find all finite branch points and singularities .      to determine the singular behavior of the curve @xmath24 at infinity , we proceed similarly as the maple package : we introduce homogeneous coordinates @xmath63 via @xmath64 , @xmath65 in ( [ fdef ] ) and get @xmath66 infinite points of the algebraic curve are given by @xmath67 , for the finite points one can choose @xmath68 .",
    "singular points at infinity satisfy @xmath69 .",
    "we first check for such points with @xmath70 which implies we can put @xmath71 without loss of generality .",
    "the roots of @xmath72 are determined via ` roots ` and an ensuing newton iteration .",
    "it is then checked as above whether the found roots also satisfy @xmath73 and @xmath74 .",
    "this analysis identifies all singular points with @xmath70 , but not the ones with @xmath75 and @xmath76 . in the latter case",
    "we can put @xmath77 and check whether @xmath78 .",
    "the singularities are given by the code in homogeneous coordinates in the form @xmath79 $ ] .      as in @xcite",
    "we will consider the curve @xmath80 throughout as an example for the various aspects of the code , if necessary complemented by further curves .",
    "for ( [ cubic ] ) we find the finite branch points ( corresponding to 0 and @xmath81 times fifth roots of unity )    .... bpoints =    -0.3197 - 0.9839i     0.8370 - 0.6081i     0.8370 + 0.6081i    -0.3197 + 0.9839i    -0.0000 + 0.0000i    -1.0346 + 0.0000i ....    and two singularities ,    .... sing =    0      0      1      4    0      1      0      9    ....    corresponding to @xmath82 and @xmath71 , @xmath83 .",
    "the last column corresponds to the delta invariant at the respective singularity , for a definition of which we refer to sect .",
    "the fact that the point @xmath84 appears both as a branch point and as a singularity implies that it is a discriminant point which is in addition singular .",
    "in this section we describe how to construct the paths for the computation of the monodromies . as in the maple ` algcurves ` package and in @xcite , we consider the _ problem points _ determined in the previous section , i.e. , the branch points and singularities of a given algebraic curve and the finite points where @xmath14 diverges ( the zeros of @xmath85 determined with the same techniques as explained in the previous section ) , which are denoted by @xmath86 , @xmath87 .",
    "the paths to compute the monodromies are formed by a set of circles around these problem points and by connecting lines between these circles . as in @xcite and @xcite ,",
    "these connecting lines will be formed according to a minimal spanning tree .",
    "in contrast to @xcite , we do not consider half circles around the discriminant points obtained by intersecting the circles with lines through the points @xmath86 , @xmath87 , parallel to the real axis . in that approach , the lines connecting the circles always at these intersection points . in the present approach ,",
    "we use essentially direct connections between the circles since this has numerical advantages . as in @xcite",
    ", we first construct the paths @xmath88 , @xmath87 , then we determine how the numbering of the points must be changed by swapping points in order to ensure the relation @xmath89 where @xmath90 is the contour surrounding all @xmath86 , @xmath87 in clockwise order .    to obtain a set of generators for the fundamental group @xmath91",
    ", we construct a set of contours @xmath88 , @xmath87 , i.e. , closed paths in the base of the covering starting at the base point @xmath92 ( chosen as explained below ) and going around each of the @xmath86 , @xmath87 , projected into the base .",
    "numerical problems are to be expected if a contour @xmath88 comes too close to one of the problem points @xmath93 , @xmath94 .",
    "thus , it is necessary in the construction of the contours that all of them have a minimal distance from all problem points .    as in @xcite , we determine the minimal distance @xmath95 between any two problem points , @xmath96 we choose a radius @xmath97 , where @xmath98 for circles around these discriminant points . for a better vectorization of the code",
    "we use the same value of @xmath99 for all discriminant points in contrast to the maple ` algcurves ` package , where such a radius is determined for each of them .",
    "we typically work with values of @xmath100 between @xmath101 and @xmath102 ( in maple , the value @xmath103 is used ) .",
    "the general procedure to construct the contours @xmath104 is as follows : the points are ordered according to a minimal spanning tree , starting with the point with minimal real part ( in the case of a degeneracy , the point with minimal imaginary part amongst those with minimal real part is chosen ) .",
    "then the problem point nearest to this starting point is identified , after that the point nearest to one of these two points and so on . as indicated by the so constructed minimal spanning , direct connection lines are drawn between neighboring points . the base point @xmath92 is chosen as the intersection point of the line through the first two problem points with the circle around the first point .",
    "for the example of the curve ( [ cubic ] ) , this leads to fig .  [",
    "fig : monpaths ] , where the base point is indicated with a square .",
    "the part of the line through the first two points ( here denoted by 1 and 4 ) between the circles around the two points forms the connecting line between the circles around the points @xmath105 and @xmath106 . in the same way connecting lines between all problem",
    "points in the order indicated by the spanning tree are constructed which leads to fig .",
    "[ fig : monpaths ] . in practice a set of @xmath107 collocation points ( as detailed in the next section ) is introduced on each of the circles starting with the first connecting line to this circle ( in the order indicated by the spanning tree ) and going around the circle in counter - clockwise order .",
    "all further connecting lines from a circle to a neighboring circle then start at the collocation point closest to the direct connection between these two points .",
    "the contours @xmath88 , @xmath87 are then formed by the circle around the point @xmath86 , connecting lines between circles and segments of circles around other points . in fig .",
    "[ fig : monpaths ] , the contour @xmath108 for instance starts at the base point , goes along the connecting line between @xmath109 and @xmath110 , then in counter - clockwise order to the connecting line between @xmath110 and @xmath111 , along the circle around @xmath111 and then the same way back to the base point .    ) with a radius of the circles around the discriminant points @xmath112 , where @xmath95 is the minimal distance between any two branch points .",
    "the base point is marked with a square.,width=377 ]    as already mentioned , in the maple ` algcurves ` package and in @xcite , the connecting lines between the circles are between the intersection points of the circles with a line parallel to the real axis through the center of the circle .",
    "this had advantages in the treatment of real curves , but with the obvious effect that the connecting lines were not of minimal length as they are now .",
    "in addition they could enter the interior of the circles and thus come closer to the critical points than the distance @xmath99 . in the present approach , both",
    "these issues are addressed .",
    "the numbering of the problem points is as indicated by the order in which the points are identified as discussed in the previous section ; only the point with the base point is swapped with the point no . 1 . to enforce relation ( [ gamma ] ) , as in @xcite the relative position of the @xmath88 , @xmath87 has to be determined . to this",
    "endpoints _ of the spanning tree , i.e. , the points @xmath86 with @xmath113 just connected to one other point , are determined , in fig .",
    "[ fig : monpaths ] the points 3 , 6 , 5 , 2 .",
    "in addition the _ nodes _ are identified , i.e. , the points connected ( possibly via intermediate points ) to several endpoints , in fig .",
    "[ fig : monpaths ] the points 4 and 1 .",
    "then starting from the endpoint all branches are traced to the next node . at a node , the branches are ordered according to the angles of the connecting lines .",
    "this procedure is repeated until the base point is reached where a final ordering according to the angles of the connecting lines with respect to the arriving line ( the line to the next point on the lower level of the spanning tree ) is performed . for fig .",
    "[ fig : monpaths ] , this leads to the sequence 3 , 6 , 5 , 2 , 4 , 1 .",
    "in contrast to @xcite , we do not change the contours @xmath88 ( @xmath87 ) , but permute the problem points to enforce ( [ gamma ] ) .",
    "this leads to the order of the branch points given at the end of sect .",
    "in this section we identify the monodromy group of the covering of the riemann sphere regarded as the projective space @xmath114 as given by ( [ fdef ] ) .",
    "an algebraic curve ( [ fdef ] ) defines an @xmath19-sheeted covering of the riemann sphere .",
    "this covering can be characterized by the following data : branch points and permutations , which are called the monodromies of the covering . to compute the monodromies , we lift the basis of @xmath91 , the contours @xmath88",
    ", @xmath87 constructed in the previous section , to the covering .      since by construction no branch point or singularity nor points , where  @xmath14 diverges ,",
    "lie on the @xmath88 , there are always @xmath19 distinct finite roots @xmath23 of @xmath24 for a given @xmath115 , @xmath87 .",
    "the procedure is similar to the one in the maple ` algcurves ` package and in @xcite : at the base point @xmath92 we enumerate the sheets and obtain a vector @xmath116 by solving @xmath117 .",
    "if we start at a point @xmath118 , @xmath119 on the covering , and consider the analytic continuation of the vector of roots @xmath120 along one of the contours @xmath88 , we will obtain a permutation of the components of the vector @xmath120 back at the base point , @xmath121 the permutation @xmath122 associated with @xmath123 can be computed in the same way along a contour @xmath90 with negative orientation surrounding all finite branch points , i.e. , a contour for which we have relation ( [ gamma ] ) .",
    "alternatively , it follows from the permutations obtained for the finite discriminant points via the relation @xmath124 the group generated by the @xmath125 is called the monodromy group of the covering .      as in @xcite",
    ", we numerically construct the analytic continuation of the vector @xmath120 along the lifted contours @xmath88 and compute at the same time the integrals of the holomorphic differentials along the @xmath88 , @xmath126 .",
    "thus , the collocation points on the contours are chosen in accordance with the numerical integration scheme which is here the _ clenshaw - curtis method_. the theoretical basis of this method is an expansion of the integrand in chebychev polynomials by a _ collocation method _ on the _ chebychev points _ @xmath127 , @xmath128 .",
    "this means we approximate the function @xmath129 for @xmath130 by an interpolating polynomial written as a sum of chebychev polynomials @xmath131 : @xmath132 , where the _ spectral coefficients _",
    "follow from imposing this approximation as an exact condition at the chebychev points , i.e. , @xmath134 , @xmath135 ( @xmath136 is also called the number of _ modes _ in the computation ) .",
    "consequently , we obtain @xmath137 an expansion of a function with respect to a system of globally smooth functions on their domain is called a _ ( pseudo-)spectral method_. the computation of the spectral coefficients @xmath133 by inverting the matrix @xmath138 and the integral of the chebychev polynomials in ( [ leg ] ) can be combined in the so - called clenshaw - curtis weights @xmath139 , with which ( [ leg ] ) can be written in the form @xmath140 thus , for given function values @xmath141 at the chebychev points @xmath49 and weights @xmath139 , the numerical approximation of the integral is just the computation of a scalar product .",
    "the weights can be conveniently determined in matlab via trefethen s code  @xcite .",
    "they have to be computed only once and are then stored for later use in the numerical integrations .",
    "this is one of the reasons why the same radius of the circles and thus the same mappings to the interval @xmath142 $ ] and the same number @xmath136 of chebychev points are used for all circles and lines ( on the connecting lines , typically one fourth of the points on the circles are used , but this can be freely chosen ) .",
    "in contrast to @xcite , where only half - circles were considered , the computation of the integrals along the contours @xmath88 , @xmath87 also includes integrations over segments of a circle .",
    "the integration along these segments is done by expanding the integrands in terms of chebychev polynomials as in .",
    "then the well known identity @xmath143 is used to determine the coefficients of the expansion of the anti - derivative of @xmath129 in terms of chebychev polynomials .",
    "this gives the value of the integral over the segment .",
    "note that the spectral coefficients @xmath133 can be computed with a _ fast cosine transformation _",
    "( see for instance @xcite ) which is the reason why we use chebychev polynomials here instead of legendre polynomials in @xcite for which no fast algorithm is known .",
    "it would be of course possible to map all segments on the circle to the interval @xmath142 $ ] and use clenshaw - curtis there , but this is not done to allow for a better vectorization of the code .",
    "it is known that the difference between an analytic function @xmath4 and its spectral approximation decreases exponentially with @xmath136 .",
    "here we have to integrate functions of @xmath11 and @xmath14 on a set of contours where the functions are analytic , which guarantees an optimal efficiency of the method provided the radius @xmath99 of the circles is not too small .",
    "thus , we can reach machine precision typically with @xmath144 .",
    "the contours consist of the circle segments discussed above , and of lines and full circles each of which is mapped to the interval @xmath142 $ ] , where we use clenshaw - curtis integration . to reach machine precision , it is obviously necessary to know the integrand with this precision",
    ". therefore we solve the algebraic equation @xmath24 on each chebychev point .",
    "since the @xmath88 , @xmath87 , by construction do not come close to branch points or singularities , no multiple roots will occur .",
    "thus , we can use the matlab command ` roots ` efficiently to determine @xmath120 .",
    "the analytic continuation is obtained by sorting the newly computed vector components according to minimal difference with the components at the previous collocation point .",
    "carrying out this procedure starting from a base point @xmath118 along some contour @xmath88 , @xmath87 , one obtains the permutation by comparing the analytic continuation of @xmath120 along @xmath88 and @xmath120 .",
    "since @xmath120 is then known at the chebychev points , the same holds for the differentials there .",
    "it is well known ( see @xcite ) that the holomorphic differentials on the riemann surface associated to an algebraic curve ( [ fdef ] ) can be written in the form @xmath145 where the adjoint polynomials @xmath146 are of degree at most @xmath147 in @xmath11 and @xmath14 .",
    "if the curve has no singular points , there are no further conditions on the @xmath148 and , consequently , there are @xmath149 linearly independent polynomials @xmath148 .",
    "since , as is well known , the dimension of the space of holomorphic 1-forms is equal to the genus @xmath150 of the riemann surface , the genus is @xmath151 in this case .",
    "if there are singular points , the set of which is denoted by @xmath152 , there is a number @xmath153  called the _ delta invariant _  of further conditions on the @xmath148 at a point @xmath154 as a consequence of the holomorphicity of the differentials also at these points .",
    "these will be discussed in sect .",
    "[ 3a ] .    since we are interested in an efficient computation of the riemann matrix , we do not separate the monodromy computation from the integration of the holomorphic differentials along these contours , but do both in one go .",
    "this also explains why we use a much higher number of collocation points than needed for the determination of the monodromies alone , the choice of the number @xmath136 is in accordance with the resolution required for the determination of the periods . as will be seen below ,",
    "not all of these integrals are linearly independent .",
    "our integration procedure will thus provide more integrals than actually needed .",
    "but the efficient vectorization algorithms in matlab ensure that the computation of the additional integrals will not be time consuming .",
    "in addition , the possibility to check the validity of identities between the computed integrals will provide strong tests of the numerical results since the integrals are computed independently .",
    "the monodromies @xmath125 are stored in an @xmath155-array .",
    "we then check which of the discriminant points are actually branch points , i.e. , have non - trivial monodromy .",
    "the monodromy at infinity is computed via ( [ sigma ] ) from the monodromies at the finite branch points .",
    "it can be computed via the contour @xmath90 as in maple to provide an additional test , but this is only done here if the puiseux expansion at the infinite points is required or if the abel map for points in the vicinity of the infinite points is needed .",
    "this is done for reasons of numerical efficiency since more resolution is necessary in general on the big contour surrounding all finite critical points , and since all other information is already easily accessible at this stage . the base point used by the code is stored in the variable ` base ` , the vector @xmath156 indicating the labeling of the sheets in the variable ` ybase ` , the branch points in ` bpoints ` , and the monodromies in the variable ` mon ` .      for the curve  ( [ cubic ] )",
    "the code produces the base point    .... base =         -0.6778 ybase =         -0.8374          0.7299          0.1075 , ....    the branch points    .... bpoints =    -0.3197 - 0.9839i     0.8370 - 0.6081i     0.8370 + 0.6081i    -0.3197 + 0.9839i    -0.0000 + 0.0000i    -1.0346 + 0.0000i        inf + 0.0000i ....    and the monodromies    .... mon =       3      1      3      1      2      1      3       2      3      2      3      1      3      1       1      2      1      2      3      2      2 . ....",
    "@xmath157    this example shows that going around the first branch point one ends up in the third sheet when starting in the first and vice versa , whereas sheet two is not affected .",
    "the above procedure to compute monodromies and periods is insensitive to the accuracy with which the branch points are computed as long as the error in the location of the branch points is much smaller than the radius of the circles around the points . for numerical accuracy of the periods",
    ", it is just important that the branch points are not close to the contours .",
    "whereas algebraic curves can have singularities as discussed in sect .  [ 2 ] , riemann surfaces are smooth manifolds . in order to define a riemann surface via algebraic curves with singularities ,",
    "a desingularization procedure has to be implemented . as in the maple",
    "` algcurves ` package and in @xcite , we construct an atlas of local coordinates for the riemann surface corresponding to the algebraic curve via series @xmath158 with rational exponents in the vicinity of the singular point .",
    "these _ puiseux expansions _ are calculated at least up to the order necessary to identify all sheets of the riemann surface near the singularities .",
    "they are used as local coordinates in the vicinity of these points which will provide part of an atlas for the description of the riemann surface as a smooth manifold . in @xcite ,",
    "puiseux expansions were constructed via the newton polygon . to avoid as much as possible cancellation errors , we use here an approach based on complex contour integrals .",
    "duval @xcite and poteaux @xcite gave efficient puiseux expansion over certain algebraic fields as rational numbers which are , however , not helpful in the context of a purely numerical approach .",
    "a puiseux expansion near a point @xmath61 on the curve in general position is just a taylor expansion of @xmath14 in terms of @xmath11 . in the vicinity of a branch point or a singularity with non - trivial monodromy as determined in the previous section ,",
    "the corresponding series is entire only in the local parameter @xmath159 , where @xmath160 is the length of the monodromy cycle @xmath161 , @xmath162 , at the point @xmath61 , i.e. , the number of sheets connected at this point .",
    "we write the puiseux expansions in the form @xmath163 where @xmath164 , and where @xmath165 .",
    "note that due to the definition of the local parameter @xmath6 , there are in fact @xmath160 expansions of the form ( [ puidef ] ) which differ only by a change @xmath166 , where @xmath167 is a root of unity of order @xmath160 . to identify all sheets in the vicinity of the singular point @xmath168 ,",
    "@xmath19 inequivalent expansions of the form ( [ puidef ] ) are needed .",
    "the minimal number of terms in the series to achieve this is called the _ singular part _ of a puiseux expansion .    in the maple",
    "` algcurves ` package and in @xcite , the puiseux expansion ( [ puidef ] ) is computed via the newton polygon . to this end , the curve ( [ fdef ] ) is written in terms of the variables @xmath169 , @xmath170 as @xmath171 , i.e. , as a curve for which the expansion is studied at the point @xmath172 .",
    "a disadvantage of this approach for a purely numerical scheme working with inexact coefficients of the polynomial ( [ fdef ] ) and thus with inexact representations of @xmath61 is that these inaccuracies are amplified in the expansion of terms of the form @xmath173 and @xmath174 because of possibly large binomial coefficients .",
    "this problem also exists in the approach with contour integrals , since @xmath12 has to be evaluated on the circles around the point @xmath168 , but there the algebraic equation ( [ fdef ] ) is solved for @xmath14 for given @xmath11 with machine precision . a worse problem for the numerical approach via the newton polygon are cancellation errors if the singularity is of high order since the first terms in the expansion ( [ puidef ] ) will cancel . in @xcite",
    "we discussed the example of the curve @xmath175 having a singularity at @xmath172 , where the singular part of the puiseux expansion consists of 3 terms . in this case the rounding errors in the puiseux coefficients introduced errors of the order of @xmath176 in the conditions on the adjoint polynomials and thus in the holomorphic differentials to be constructed in the next section .    to avoid as much as possible these numerical problems , we use the well known cauchy formula to compute the coefficients of a taylor expansion of a holomorphic function .",
    "the procedure outlined below also works for general points @xmath61 , where first @xmath14 has to be determined as discussed in the previous section on a small circle centered at @xmath168 in the base . for the branch points and singularities to be discussed in the following , this has been done already during the computation of the monodromy group which makes the approach particularly efficient .",
    "for the point @xmath61 it is determined to which monodromy cycle @xmath161 , @xmath162 it belongs . denoting the lifts of the circle of radius @xmath99 around @xmath168 in the base to the corresponding sheets in the covering by @xmath177 respectively , the contour @xmath178 is a closed contour on the covering . thus the cauchy formula can be used in standard way to obtain the coefficients @xmath179 in ( [ puidef ] ) via @xmath180 if the expansion is done at a point @xmath181 different from the center of the circle .",
    "parametrizing in ( [ alphant0 ] ) the circle in the base by @xmath182 , @xmath183 $ ] ( the index of the contour is @xmath160 ) , we get for @xmath184 @xmath185 since the integrands are known on chebychev collocation points for @xmath186 , the clenshaw - curtis algorithm ( [ legw ] ) can be applied as before with negligible computational cost .",
    "the coefficients @xmath179 , @xmath187 are computed in a vectorized way for all desired values of @xmath188 at the same time",
    ". the value of @xmath189 can be freely chosen ( to allow for highly degenerate cases , the default value is @xmath190 ) .",
    "values of the coefficients of the puiseux expansion at some point @xmath168 are given for all cycles of the monodromy .",
    "for the example ( [ cubic ] ) , the point @xmath172 is , as already mentioned , a singular point , and the puiseux expansions in the vicinity of the point are @xmath191 , @xmath192 and @xmath193 , @xmath194 .",
    "the code produces the following result ,    ....",
    "puiexp{1}(:,1:11 ) =     columns 1 through 4       2.0000 + 0.0000i   -0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i     1.0000 + 0.0000i    0.0000 + 0.0000i   -0.0000 - 0.0000i   -0.0000 + 0.0000i      columns 5 through 8       0.0000 - 1.4142i    0.0000 + 0.0000i    0.0000 + 0.0000i   -0.0000 + 0.0000i     0.0000 - 0.0000i    0.5000 + 0.0000i    0.0000 + 0.0000i   -0.0000 - 0.0000i      columns 9 through 11       0.0000 + 0.0000i   -0.2500 - 0.0000i   -0.0000 - 0.0000i    -0.0000 + 0.0000i    0.0000 + 0.0000i   -0.0625 + 0.0000i     ....    where the first column of the output gives the length @xmath160 of the monodromy cycle ( recall that as in the maple ` algcurves ` package there are always @xmath160 expansions differing from the ones shown by multiplication of @xmath6 with roots of unity of order @xmath160 ) .",
    "note that the first given coefficients in the second column correspond to @xmath195 .",
    "if there is sufficient resolution in terms of chebychev points to compute the integrals in ( [ alphan2 ] ) , this will be done with the clenshaw - curtis algorithm to machine precision .",
    "but since the radius @xmath99 is in general smaller than 1 , the numerical errors are growing with @xmath188 as @xmath196 .",
    "this can be seen for the example ( [ cubic ] ) , where @xmath197 , at the singularity @xmath172 in fig .  [",
    "fig : puicoeff ] , where the difference between the exact and the numerical puiseux coefficients is shown in a logarithmic plot .",
    "since @xmath198 is of the order @xmath199 , the error in @xmath200 is for @xmath201 of the order of @xmath202 , whereas for @xmath203 it is still of the order of @xmath36 .",
    "thus the size of @xmath99 , which can be at most half the minimal distance to the closest branch point , delimits the accessible accuracy of the puiseux coefficients in this finite precision approach .    ) in a logarithmic plot.,width=377 ]      to obtain the puiseux expansion at points on the curve where @xmath11 is infinite , one could use the information along the contours around the finite critical points as it was done for the computation of the monodromy at infinity in the previous section .",
    "however , this would imply to compute integrals of the form ( [ alphant0 ] ) also along the connecting lines between the circles and to trace roots of @xmath204 there .",
    "since the matlab root is always branched along the negative real axis , this would require an analytic continuation of the roots along these lines as in the previous subsection .",
    "this can be done , but it is cumbersome which is why we use other approaches here .",
    "if the curve has singularities at infinity as determined in section [ 2 ] , we consider puiseux expansions at infinity in the homogeneous coordinates of sect .",
    "[ 2 ] and use the same approach as for the finite singular points above at the point @xmath205 .",
    "we determine the critical points of the curve @xmath206 ( [ fdef ] ) ( either @xmath77 or @xmath71 ) to establish the minimal distance between discriminant points for this curve to identify a possible radius @xmath99 for the circle around @xmath205",
    ". then equation ( [ fdef ] ) is solved for @xmath207 in dependence of @xmath208 ( if @xmath71 ) or for @xmath209 in dependence of @xmath207 ( if @xmath77 ) as discussed in the previous section .",
    "this approach has the additional benefit to provide an independent check of the monodromy computation along the contours around the finite critical points .",
    "the puiseux coefficients are then determined via formula ( [ alphan2 ] ) .    as an example we consider the curve ( [ cubic ] ) which has a singular point @xmath210 .",
    "the curve @xmath211 has a singularity at @xmath172 , where all four sheets are connected .",
    "the code gives the puiseux expansion ( again there are four expansions of this form differing by multiplication of @xmath6 with a fourth root of unity )    ....      puiexp{2}(1:11 ) =     columns 1 through 4       4.0000 + 0.0000i    0.0000 - 0.0000i   -0.0000 + 0.0000i   -0.0000 + 0.0000i      columns 5 through 8      -0.0000 - 0.0000i   -0.0000 + 0.0000i   -0.0000 + 0.0000i   -0.0000 + 0.0000i      columns 9 through 11      -1.0000 - 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i . ....",
    "the first entry gives again the value of the length of the monodromy cycle , @xmath212 .",
    "this shows that the expansion is of the form @xmath213 which implies in leading order for ( [ cubic ] ) that @xmath214 and @xmath215 .",
    "thus we recover that the 3 sheets are connected at infinity , and that @xmath216 there .    as an option",
    ", the code offers the possibility to compute the puiseux expansion at infinity directly in the coordinates @xmath11 and @xmath14 . to this end",
    ", a circle of radius @xmath217 centered at the origin , surrounding all circles of radius @xmath99 around the critical points and touching at least one of these circles is constructed . at the point , where the two circles touch , the roots for @xmath14 have already been determined .",
    "if the circle is around the branch point @xmath218 , then the points @xmath219 have already been surrounded before reaching the touching point along the contours constructed in section [ 4 ] .",
    "thus the computed monodromies for these contours have to be applied to the value of @xmath14 at the touching point .",
    "these values of the roots of @xmath14 are then analytically continued along the circle in positive orientation as before .",
    "this is again done between chebychev collocation points on the circle . by construction",
    "the computed monodromy must be equal to @xmath220 computed via ( [ sigma ] ) .",
    "the code reports an error if this is not the case .",
    "given the values of @xmath14 on the chebychev collocation points on the circle of radius @xmath217 , the puiseux expansion can be computed in the same way as for the finite critical points in the previous subsection .",
    "the only difference is that negative powers in @xmath221 can appear in this case .",
    "note that we use here in general twice the resolution on the circle with radius @xmath217 than for the circles with radius @xmath99 , simply because @xmath217 is by construction bigger than @xmath99 . for the example ( [ cubic ] )",
    ", we find ( the first value corresponds to the power @xmath222 , the second to @xmath223 and so on )    ....      columns 1 through 4      -0.5000 - 0.8660i   -0.0000 - 0.0000i   -0.0000 - 0.0000i   -0.0000 + 0.0000i      columns 5 through 8      -0.0000 + 0.0000i    0.3333 - 0.5774i    0.0000 - 0.0000i   -0.0000 + 0.0000i ....    this corresponds to @xmath224 where @xmath225 , i.e. , the same result as obtained above by using the projective coordinates ( @xmath63 ) .",
    "in this section , we describe the construction of a basis of the holomorphic 1-forms on the riemann surface if the set @xmath152 of singular points is non - empty . to this end",
    ", we will use the complex contour integral techniques of the previous section . as already discussed in sect .",
    "[ 5 ] , the holomorphic differentials are of the form ( [ holdiff ] ) with @xmath226 . at the singular points , we use a puiseux expansion in the local parameter @xmath6 of ( [ alphant0 ] ) near the singularity of the integrands ( [ holdiff ] ) . for the integral to be holomorphic",
    ", there must be no negative powers of @xmath6 in this expansion which leads to a number @xmath153 , the _ delta invariant _ , of conditions at each singular point @xmath227 .",
    "the genus of the surface is given in this case by @xmath228    to determine the conditions on the differentials ( [ holdiff ] ) at the corrected singular point @xmath61 , we determine the puiseux expansion of @xmath10 which has now ( within numerical precision ) a vanishing constant term . since we are interested in the highest power of @xmath6 appearing in the denominator of ( [ holdiff ] ) , i.e. , the smallest power @xmath229 of @xmath6 appearing in the puiseux expansion of @xmath10 , we consider the formula ( [ alphan2 ] ) with @xmath14 replaced by @xmath10 .",
    "a differential of the form ( [ holdiff ] ) is holomorphic at a singular point @xmath61 if no negative powers of @xmath6 in the puiseux expansion of the integrand appear . to establish the conditions on the differentials to ensure this",
    ", we multiply the differential by powers @xmath230 , @xmath231 and compute the integral along the contour @xmath5 of ( [ alphant0 ] ) .",
    "the residue theorem implies that the terms in the puiseux expansion of the differentials proportional to @xmath232 lead to a non - vanishing integral .",
    "singular points at infinity are treated in a completely analogous way as in the last section as puiseux expansions at infinity in the homogeneous coordinates @xmath233 .    to implement the conditions on the adjoint polynomials at the singularities in matlab",
    ", we write the matrix @xmath234 with @xmath235 in standard way as a vector @xmath236 of length @xmath151 .",
    "the holomorphicity of ( [ holdiff ] ) at the singular points implies relations of the form @xmath237 where @xmath238 is a @xmath239 matrix .",
    "each condition on @xmath236 following from a non - vanishing residue in the above expansions gives a line in @xmath238 .",
    "the first such condition found is stored as the first row of @xmath238 .",
    "for each subsequent condition found , it is checked that this new condition is linearly independent of the already present ones in @xmath238 . this",
    "is done in the following way : if the matrix @xmath238 contains @xmath31 linearly independent conditions on @xmath236 , the first @xmath31 rows will be non - trivial , and @xmath238 has rank @xmath31 .",
    "the new condition will be tentatively added as row @xmath240 in @xmath238 , and it will be checked if the resulting matrix has rank @xmath240 . if not , the new condition is linearly dependent on the @xmath31 conditions already stored in @xmath238 , and line @xmath240 will be suppressed . at the end of this procedure , there will be @xmath241 non - trivial lines in this matrix .",
    "the holomorphic differentials correspond to the vectors @xmath236 in the kernel of the matrix @xmath238 .",
    "they are determined with the matlab command ` null ` , where ` null`(h ) provides an orthonormal basis for the null space of @xmath238 .",
    "notice that for reasons of numerical accuracy we do not look for a rational basis @xmath236 of the kernel of @xmath238 even in cases where such a basis exists .",
    "the polynomials @xmath148 are stored in the form of matrices @xmath242 where in matlab convention @xmath243 , and where the first row / column has @xmath244 .",
    "the code gives the matrices @xmath245 as @xmath246 , where @xmath150 is the genus of the riemann surface .",
    "for the curve ( [ cubic ] ) , where @xmath247 , we get    .... c{1 } =           0      0      0      0      0           0      0      0      0      1           0      0      0      0      0           0      0      0      0      0           0      0      0      0      0 c{2 } =          columns 1 through 4       0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i     0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i     0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i     0.0000 + 0.0000i   -0.0000 + 0.0000i   -0.0000 + 0.0000i    0.9938 - 0.1111i    -0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i    0.0000 + 0.0000i      column 5      -0.0000 + 0.0000i     0.0000 + 0.0000i     0.0000 + 0.0000i     0.0000 + 0.0000i     0.0000 + 0.0000i ....",
    "i.e. , the polynomials @xmath248 and @xmath249 .",
    "thus , the curve has genus @xmath250 which implies it is _ hyperelliptic _ since all surfaces of genus 2 are ( recall that hyperelliptic surfaces can be written in weierstrass normal form @xmath251 after a birational transformation @xmath252 , @xmath253 ) .",
    "the integrals of the holomorphic differentials along @xmath88 are obtained as discussed above , and the results are stored in an @xmath254 array .",
    "the sum of integrals of a holomorphic differential over all contours with the same projection into the @xmath11-sphere must vanish . in practice",
    "this sum will not vanish because of numerical errors and thus gives an indication on the quality of the numerics .",
    "the code issues a warning if this sum is greater than the prescribed rounding tolerance @xmath35 .",
    "the monodromies computed in sect .  [ 5 ] provide the necessary information to determine a basis for the homology on a riemann surface .",
    "we use as in the maple ` algcurves ` package and in @xcite the algorithm by tretkoff and tretkoff @xcite to construct such a basis .",
    "we outline only the main steps here , for details the reader is referred to @xcite and @xcite .",
    "the first step in the construction of the homology is the identification of the points on the covering belonging to more than one sheet , i.e. , the points , where the _ branching number _ ( the number of sheets to which a point belongs minus 1 ) is different from zero . to this end",
    "one has to identify the cycles within the permutations in the monodromies computed in sect .",
    "this is simply done by determining for each discriminant point with non - trivial monodromy , i.e. , each branch point , the sheets which are permuted whilst encircling this point .",
    "the permuted sheets form the cycles within the permutation .",
    "they are identified as follows : the monodromies are given as permutations of the vector @xmath255 .",
    "for each permutation vector the code identifies the components which are not in the order @xmath255 . for the first such component",
    ", it goes to the sheet indicated by this component , then to the next indicated by the component in the vectors there , until the starting point for the procedure is reached again .",
    "this identifies the first cycle . for the first vector in the example ( [ mono ] ) , the first permuted component corresponds to the first sheet .",
    "the 3 there indicates that going around this point in the first sheet , one ends up in the third .",
    "the third component of the permutation vector is a 1 , the sheet where this cycle @xmath256 started .",
    "if not all permuted sheets appear in the first cycle identified in this way , the procedure is repeated for the remaining permuted sheets until all permutation cycles are determined .",
    "each such cycle corresponds to one of the @xmath257 ramification points on the covering and is labelled by @xmath258 , @xmath259 , where it is possible that several such points have the same projection onto the complex plane . from the number @xmath260 of elements in the permutation cycle we obtain the branching number @xmath261 .",
    "the riemann - hurwitz formula then allows the computation of the genus : @xmath262 since the determination of the genus via monodromies is completely independent from the genus computation via the dimension of the space of the holomorphic 1-forms , this provides a strong test for the code . a failure in this test results in an error which in general indicates that the branch points and singularities or the holomorphic 1-forms were not correctly identified , the latter typically for a lack of resolution . for the curve ( [ cubic ] ) we find that all branch points on the covering connect exactly two sheets except for the one above infinity where 3 sheets come together .",
    "therefore , the genus is 2 in accordance with the results for the holomorphic 1-forms .",
    "the tretkoff - tretkoff algorithm constructs a spanning tree connecting the points @xmath263 on the covering ( the points projecting to the base point in the base ) starting from @xmath264 with the points @xmath265 .",
    "the algorithm allows to identify non - trivial closed cycles on the riemann surface and to compute intersection numbers between them via a planar graph . in total",
    ", one obtains @xmath266 cycles . since the homology on a riemann surface of genus @xmath150 has dimension @xmath267",
    ", the cycles can not be all linearly independent .",
    "a canonical basis of cycles @xmath268 on a riemann surface of genus @xmath150 satisfies the intersection conditions @xmath269 to find a canonical basis with the tretkoff - tretkoff algorithm , one has to compute the intersection matrix @xmath270 for the obtained @xmath266 cycles , which is straightforward to do from the planar graph .",
    "it was shown in @xcite that the resulting matrix has rank @xmath267 .",
    "for the example of the curve ( [ cubic ] ) we obtain the intersection matrix :    .... k =       0      1      0      0     -1     -1      -1      0      0      1     -1     -1       0      0      0      1     -1      0       0     -1     -1      0      1      0       1      1      1     -1      0      1       1      1      0      0     -1      0 .",
    "....    this matrix can be transformed to the canonical form @xmath271 where @xmath272 is a @xmath273-matrix  with integer entries and @xmath274 , @xmath275 is the @xmath276 zero matrix , @xmath277 is the @xmath276 identity matrix , and @xmath278 the @xmath279 zero matrix .",
    "the canonical basis of the homology of the surface is given by the cycles @xmath32 and @xmath86 : @xmath280 where @xmath281 are the @xmath266 closed contours obtained from the planar graph .",
    "the remaining cycles are homologous to zero , @xmath282 for the curve ( [ cubic ] ) , the code produces    .... acycle{1 } =           1      1      3      2      2      5      1 acycle{2 } =           1      1      3      6      2      5      1 bcycle{1 } =           1      1      3      4      2      5      1 bcycle{2 } =           3      1      3      2      2      5      1      3      3 , ....    where @xmath283 corresponds to @xmath32 , and @xmath284 to @xmath86 .",
    "these numbers are to be read in the following way : the numbers at odd positions in the cycle correspond to the indices @xmath285 of @xmath263 , @xmath286 , the numbers at the even positions to the indices @xmath287 of the @xmath258 , @xmath288 . in the above example",
    ", the cycle @xmath109 starts in the first sheet , goes around @xmath289 to end in the third sheet , then around @xmath290 to the second sheet , then around @xmath291 to come back to the first sheet .",
    "the code can give more detailed information on the tretkoff - tretkoff tree and the cycles @xmath292 , @xmath293 , as an option ( it is stored in the variable ` cycle ` in the code tretkoffalg.m ) .",
    "relations ( [ cycle ] ) allow the computation of the periods of the holomorphic differentials from the integrals along the contours @xmath294 used for the monodromy computation .",
    "the cycles @xmath292 , @xmath293 , are equivalent to a sequence of contours @xmath294 .",
    "thus , using ( [ cycle ] ) and the integrals of the holomorphic differentials along the contours @xmath294 , we get the @xmath92- and @xmath295-periods of the holomorphic differentials , the matrices @xmath296 and @xmath297 , respectively .",
    "the riemann matrix @xmath298 is given by @xmath299 since the riemann matrix must be symmetric , the asymmetry of the computed matrix is a strong test for the numerical accuracy .",
    "a warning is reported if the asymmetry is greater than the prescribed tolerance .",
    "similarly it is checked whether the periods along the cycles ( [ cycle2 ] ) homologous to zero vanish with the same accuracy . for the curve ( [ cubic ] )",
    "the code finds the riemann matrix    .... riemat =     0.3090 + 0.9511i    0.5000 - 0.3633i     0.5000 - 0.3633i   -0.3090 + 0.9511i . ....    for a more compact representation we give only 4 digits here though 16 are available internally .",
    "the @xmath300 norm of @xmath301 and of the periods along the cycles ( [ cycle2 ] ) are of the order of @xmath302 with @xmath303 modes .",
    "we will discuss the performance of the code in more detail in the next section .",
    "in this section we will illustrate the performance of the code for typical examples and discuss certain features of the chosen numerical approach .",
    "we note that the code is constructed for high precision computation .",
    "the identification of the holomorphic differentials at singularities of the algebraic curve is done as the null space of conditions on the candidate differentials at the singularities . to be able to identify this null space ( via the matlab command ` null ` ) , these conditions obtained from complex contour integrals need to be known with sufficient precision",
    ". if this is not the case , the holomorphic differentials are not correctly found , and the code exits with an error due to a disagreement between the genus obtained via the monodromies and the dimension of the space of holomorphic differentials . due to the exponential decrease of the error in the computation of the periods with the number @xmath136 of chebychev polynomials , a general feature of spectral methods , this is in practice",
    "not a problem .",
    "but it explains why a precision of merely @xmath59 can not be reached with this code in the presence of singularities : the integrals have to computed with an error smaller than @xmath58 in order that the holomorphic differentials are correctly identified .",
    "the numerical error we will study here in more detail is defined as the maximum of the @xmath300 norm of the antisymmetric part of the numerically computed riemann matrix and the same norm of the right hand sides of ( [ cycle2 ] ) .",
    "the resulting variable is denoted by ` err ` . for the curve ( [ cubic ] ) we find that the code exits with an error with @xmath304 for the reasons outlined above . for @xmath305 , the minimal error of order @xmath302",
    "is already reached .",
    "a more demanding test for the code is provided by the curve @xmath306 which is a nine - sheeted genus 16 covering of the sphere with 42 finite branch points and two singular points @xmath307 and ( 1,0,0 ) .",
    "what makes this curve computationally challenging is the fact that the minimal distance between the branch points is just @xmath308 .",
    "the dependence of the error on the number of chebychev polynomials is shown in fig .",
    "[ fig : error ] .",
    "it can be seen that machine precision is reached with 400 polynomials .",
    "the plot is typical for spectral methods : one can see the exponential decrease of the error ( an essentially linear decrease in a logarithmic plot ) and the saturation of the error once machine precision is reached , here at roughly @xmath37 .    )",
    ".,width=377 ]    as already mentioned , the code @xcite had difficulties with curves having singularities where the singular part of the puiseux expansion consists of many terms due to rounding problems occur .",
    "the example ( [ highsing ] ) could only be computed with an error of the order of @xmath176 because of this .",
    "this curve of genus 1 has a singularity at @xmath172 with a delta invariant 43 , i.e. , a singularity of high order with a singular part of the puiseux expansion consisting of 3 terms . with @xmath305 chebychev polynomials , the code exits with an error since",
    "the holomorphic differentials are not correctly identified at the singularity as discussed above . with @xmath309 , an error of smaller than @xmath37",
    "is reached , a precision inaccessible with the code @xcite .",
    "it is interesting to know for which operations the computation time in matlab is used .",
    "matlab timings have to be taken with a grain of salt since they depend on whether used functions are precompiled or not , but they are interesting from a practical point of view to get an idea how long a computation takes and what is the most time consuming task .",
    "we used the vectorization algorithms in matlab as much as possible to obtain an efficient code .",
    "for the riemann matrix of the curve ( [ cubic ] ) computed with 128 polynomials we find that roughly one third of the time is used for the analytic continuation of @xmath120 along the contours and the computation of the integrals ( this includes solving the algebraic equation and sorting the roots to analytically continue the sheets , which both takes essentially the same time ) . the various puiseux expansions needed in the determination of the holomorphic differentials also take roughly one third of the computing time ( this is partly due to the fact that we work with a high number of puiseux coefficients to allow for highly degenerate cases ) .",
    "the clenshaw - curtis integration , which is just a matrix multiplication in this implementation , only takes negligible computation time .",
    "the precise distribution of computing time to the different numerical tasks necessary to obtain the riemann matrix for an algebraic curve depends of course on the studied example . note that the main advantage of the code presented here compared to the code @xcite is not speed , but efficiency .",
    "this means the former can treat cases with high precision where the latter fails or can only reach low accuracy .",
    "theta functions are the building blocks of meromorphic functions on riemann surfaces .",
    "we define the theta function with characteristic @xmath310 $ ] as an infinite series , @xmath311 with @xmath312 and @xmath313 , @xmath314 , where @xmath315 denotes the euclidean scalar product @xmath316 .",
    "the properties of the riemann matrix ensure that the series converges absolutely and that the theta function is an entire function on @xmath317 .",
    "a characteristic is called _ singular _ if the corresponding theta function vanishes identically . of special importance",
    "are half - integer characteristics with @xmath318 .",
    "a half - integer characteristic is called _ even _ if @xmath319 and _ odd _ otherwise .",
    "theta functions with odd ( even ) characteristic are odd ( even ) functions of the argument @xmath320 .",
    "the theta function with characteristic is related to the riemann theta function @xmath321 , the theta function with zero characteristic @xmath322 , via @xmath323 the theta function has the periodicity properties @xmath324 where @xmath325 is a vector in @xmath326 consisting of zeros except for a 1 in jth position . in the computation of the theta function",
    "we will always use the periodicity properties ( [ eq : periodicity ] ) .",
    "this allows us to write an arbitrary vector @xmath327 in the form @xmath328 with @xmath329 , where @xmath330 with @xmath331 , @xmath332 , and to compute @xmath333 instead of @xmath334 ( they are identical up to an exponential factor ) .",
    "the series ( [ thchar ] ) will be approximated by a sum . for details of the computation of the theta function ,",
    "the reader is referred to @xcite or @xcite .",
    "the abel map @xmath335 is a bijective map from the riemann surface @xmath336 into the _ jacobian _",
    "@xmath337 where @xmath338 is the lattice formed by the periods of the holomorphic 1-forms , @xmath339 in this section , we discuss how the abel map can be efficiently computed for general points on the riemann surface . in addition , the expansion of the abel map at a point @xmath340 near a point @xmath341 is often needed , @xmath342 where @xmath343 is a local parameter in the vicinity of @xmath92 containing also @xmath227 , and where @xmath344 , @xmath345 , @xmath346 are vectors in @xmath317 .",
    "note that the abel map is only defined up to periods of the holomorphic 1-forms .",
    "thus we always choose it to be in the fundamental domain given by @xmath347 the abel map and thus an arbitrary point of the jacobian can be given in terms of the characteristics @xmath348 .",
    "for a point @xmath349 in general position , i.e. , not close to one of the problem points of the curve ( see section [ 4 ] ) and to infinity , we use the same approach as for the integrals along the connecting lines in fig .  [",
    "fig : monpaths ] .",
    "more precisely if the projection @xmath350 of @xmath227 into the base is such that @xmath351 for @xmath87 and @xmath352 , the point @xmath353 with minimal distance to @xmath227 is identified . on the circle of radius @xmath99 around this point @xmath353 , the collocation point with minimal distance to @xmath227",
    "is found . as detailed in sect .",
    "[ 5 ] , the integral of the holomorphic differentials on a segment of the circle up to this collocation point is computed by expanding the integrands in terms of chebychev polynomials and using ( [ chebint ] ) .",
    "the integral from this collocation point to the point @xmath227 is determined as for the integrals along the connecting lines : a number @xmath136 of chebychev points is introduced in the base on the connecting line between the projections of the collocation point on the circle and of @xmath227 .",
    "the line is then lifted to the surface as before by solving ( [ fdef ] ) via ` roots ` and analytically continuing the roots to obtain the integrand on the connecting line on the surface",
    ". then we use clenshaw - curtis integration to determine the abel map .",
    "the vectors @xmath344 , @xmath345 and @xmath346 in ( [ abelexp ] ) are determined in the process : @xmath344 is just the integrand of the abel map at the last collocation point . to obtain @xmath345 and @xmath346 respectively",
    ", the integrand has to be differentiated once respectively twice .",
    "since the integrands are quotients of polynomials in @xmath11 and @xmath14 , this could be done essentially by hand .",
    "but since the integrand is known already on chebychev collocation points and since by construction the integrand is analytic on the line , we use _ chebychev differentiation matrices _ as computed in @xcite ( see @xcite for a code to generate these matrices ) .",
    "note that these matrices are obtained from the lagrange polynomial on the collocation points , and that this is again a spectral method with an exponential decrease of the numerical error with the number of collocation points .",
    "thus the derivatives are computed with the same precision as the integral .      for a point @xmath227 inside one of the circles around the problem",
    "points @xmath353 , i.e. , with @xmath354 , this approach will not be efficient . even if the local coordinate @xmath355 is used near a branch point @xmath168 of order @xmath160 , cancellation errors for @xmath356 can affect numerical accuracy .",
    "but since the monodromies are already known and since the holomorphic 1-forms are closed , the cauchy formula ( [ cauchy ] ) can be also applied to the case that @xmath357 is the abel map . more concretely , we consider @xmath358 where @xmath359 .",
    "this is even a very efficient approach since the holomorphic differentials are already known on the circle around @xmath353 on chebychev points .",
    "thus we use relation ( [ chebint ] ) to obtain the abel map on these collocation points , and then use ( [ cauchy ] ) for the abel map to obtain its value at point @xmath227 .",
    "since the cauchy formula gets numerically problematic if @xmath360 is close to @xmath5 , we only use it for values of @xmath354 . in this case , the abel map will be computed up to the precision with which the holomorphic 1-forms are known on the circle where no cancellation errors are to be expected .",
    "the vectors @xmath344 , @xmath345 and @xmath346 in ( [ abelexp ] ) appear in the puiseux expansion of the abel map at this point which can be obtained by differentiating ( [ cauchy2 ] ) with respect to @xmath361 . as discussed in section [",
    "3 ] , the involved integrals are computed to machine precision with this approach .",
    "note that in this computation , the abel map to a point in the sheet with the label @xmath362 is always computed starting from the point @xmath118 , the point in sheet @xmath362 covering the base point .",
    "the abel map between @xmath363 , which is always taken as the base point for the abel map , and the point @xmath118 is then added .",
    "the connection between these points on the surface has been identified by the tretkoff - tretkoff algorithm , and the integral has been computed already during the monodromy computation .",
    "thus this change of the base point comes at virtually no computational cost .",
    "if the point @xmath227 is far from all problem points , the cauchy formula will be applied for the circle centered at the origin of radius @xmath217 already used for the puiseux expansion at infinity in section [ 3 ] .",
    "this circle contains all circles around the critical points and touches at least one of them , say @xmath353 , in a collocation point .",
    "the abel map up to the point where the connecting line to the previous critical point on the spanning tree intersects the circle around @xmath353 has been already computed .",
    "the integral up to the collocation point touching the circle with radius @xmath217 is computed as for the period computation with the formula ( [ chebint ] ) .",
    "on the circle with radius @xmath217 , the roots @xmath14 have been already determined during the computation of the puiseux expansion at infinity in section [ 3 ] . consequently also the holomorphic differentials are known on this circle .",
    "using ( [ chebint ] ) once more on the circle gives the abel map on the collocation points chosen on this circle .    with this knowledge , the cauchy formula ( [ cauchy2 ] ) can be used for the abel map with @xmath364 , @xmath365 $ ] and @xmath366 .",
    "the vectors @xmath367 , @xmath368 , @xmath369 can be obtained as for points in the vicinity of finite critical points by differentiating ( [ cauchy2 ] ) with respect to @xmath6 .",
    "again all integrals are computed to machine precision .      to test the abel map ,",
    "we first consider a hyperelliptic curve of genus 2 in weierstrass normal form , @xmath370 it is known that the abel map between branch points of the curve is a half period . to test this",
    ", we compute the abel map from the base point @xmath363 to all branch points and get    .... abelmap =      columns 1 through 4       0.9779 - 0.3078i    1.5710 + 0.2243i    1.0710 + 0.2243i    0.4779 - 0.3078i     1.8651 + 0.8773i    2.3651 + 0.6729i    2.3651 + 0.6729i    2.3651 + 0.8773i      columns 5 through 6       0.9779 - 0.1033i",
    "0.9779 - 0.1033i     0.9582 + 0.3452i    1.4582 + 0.3452i ....    corresponding to the abel map to the branch points @xmath86 , @xmath371 in the order @xmath372 . with    .... riemat =       1.1862 + 1.0642i    0.0000 - 0.4090i    -0.0000 - 0.4090i    1.8138 + 1.0642i ....",
    "we find for @xmath373 , @xmath374    ....      q =        0.5000     0.5000          0          0          0      0.0000     0.0000          0    -0.5000    -0.5000 ....    and    ....",
    "p =      0         -0.5000    -0.5000    -0.0000    -0.0000      0.5000     0.5000     0.5000          0     0.5000 . ....",
    "as expected @xmath375 , @xmath376 are integers , in fact with an accuracy of @xmath7 .",
    "this implies that the abel map to the branch points is computed to machine precision .",
    "a further test also used in @xcite is related to abel s theorem : recall that a divisor is a formal symbol @xmath377 where @xmath378 , @xmath379 are points on the riemann surface , and where @xmath380 .",
    "the degree of a divisor is defined as @xmath381 . if the degree of a divisor vanishes , it is the set of zeros @xmath382 ( positive @xmath260 ) and poles @xmath383 ( negative @xmath260 ) of a meromorphic function on @xmath336 ( multiplicities have to be counted ) .",
    "abel s theorem says that if @xmath384 , then the abel map of the divisor is a lattice vector in @xmath338 .    as an example",
    ", we consider the function @xmath14 on the surface defined by ( [ cubic ] ) .",
    "the puiseux expansions in section [ 3 ] indicate that @xmath14 has a pole of order 7 at infinity ( there is just one point on the surface covering infinity ) and two zeros of order 3 and 4 respectively covering 0 .",
    "we get for the abel map in the form ( [ charabel ] ) ( @xmath385 , @xmath386 , @xmath387 ) ( the sheets are denoted by superscripts , @xmath388 is the point in the third sheet covering @xmath389 )    .... [ p1,q1 ]    ans =        0.5998     0.5615      0.7193     0.2389    [ p2,q2 ]    ans =        0.1998     0.7615      0.1193     0.8389       [ p3,q3 ]    ans =        0.3998     0.1615      0.9193     0.0389       ....    the abel theorem requires that @xmath390 and @xmath391 are integer vectors .",
    "in fact we find for these combinations the vectors @xmath392 respectively @xmath393 with a precision of @xmath394 .",
    "a very efficient test for the abel map and its derivatives ( [ abelexp ] ) is provided by fay s trisecant identity @xcite for theta functions .",
    "this identity ( [ fay ] ) for products of theta functions holds for four arbitrary points on a riemann surface .",
    "thus it is possible to consider also degenerations ( [ fay1 ] ) , ( [ fay2 ] ) and ( [ fay3 ] ) which are summarized in the appendix .",
    "these identities are very important in the context of algebro - geometric solutions to integrable equations of which we discuss an example in the following section .",
    "their purpose here is to allow tests both for the abel map and its expansion ( [ abelexp ] ) .",
    "we consider again the example ( [ cubic ] ) and the points @xmath385 ( there is just one point covering infinity in this example , @xmath395 ( thus a point computed with the cauchy formula on the circle surrounding all branch points ) , @xmath396 , a point ` in general position ' , and @xmath397 , a finite singular point .",
    "thus this example should test all routines to compute the abel map .",
    "the theta functions needed in the various fay identities are computed to machine precision as discussed in section [ 9 ] .",
    "the abel map is expanded near infinity , a singularity with @xmath398 .",
    "we find that the identity ( [ fay ] ) involving all four points is satisfied to the order of @xmath8 , the tolerance used in all computations .",
    "the same holds for the identities ( [ fay1 ] ) and ( [ fay2 ] ) . identity ( [ fay3 ] ) is even satisfied to the order @xmath302 , but this appears to be a coincidence ; in other examples it is just satisfied to the order of @xmath36 since fourth derivatives of theta functions are involved which lowers the maximally achievable accuracy .",
    "the above tests allow to conclude that the abel map for a point in general position is efficiently computed with the same precision as the periods of the surface .",
    "as an example we study in this section algebro - geometric solutions to the kp equation on compact riemann surfaces . the completely integrable equation can be seen as @xmath399 dimensional generalization of the celebrated kdv equation .",
    "it has a physical interpretation as describing the propagation of weakly two - dimensional waves of small amplitude in shallow water as well as similar physical processes , see for instance @xcite and references therein .",
    "the kp ii equation for the real valued potential @xmath400 depending on the three real coordinates @xmath401 can be written in the form @xmath402 the kp i equation can be obtained from ( [ eq : kp ] ) by changing the sign of the @xmath403 term .",
    "if @xmath404 is a solution to the kp  ii equation , @xmath405 formally solves the kp  i equation .",
    "solutions to kp  i are applicable when surface tension is strong , whereas kp  ii is a good model for weak surface tension .",
    "algebro - geometric solutions to the kp ii equation can be given on an arbitrary compact riemann surface as shown by @xcite .",
    "solutions to the kp equation on the above riemann surfaces are given by the generalization of the its - matveev formula for the kdv equation ( see e.g.  @xcite ) @xmath406 where @xmath407 and @xmath408 is given in ( [ c1 ] ) . by a coordinate change @xmath409",
    "one can change a solution @xmath400 to the kp equation by @xmath410 .",
    "probably the most elegant way to show that ( [ eq : solution ] ) provides a solution to the kp equation is the use of fay s trisecant identity in the form ( [ fay3 ] ) , see appendix  [ sec : fay ] . differentiating ( [ fay3 ] ) twice",
    ", one finds that ( [ eq : solution ] ) is indeed a solution to the kp ii equation .",
    "kp i solutions can be obtained from ( [ eq : solution ] ) by considering as mentioned @xmath405 .",
    "the important question of real and singularity free solutions to the kp equation was addressed by dubrovin and natanzon in @xcite .",
    "it was shown that real and smooth solutions to the kp ii equation of the form ( [ eq : solution ] ) are obtained on real riemann surfaces , i.e. , surfaces with all @xmath21 in ( [ fdef ] ) real .",
    "such surfaces have an antiholomorphic involution @xmath411 , @xmath412 , which acts on the each sheet of the surface as the complex conjugation .",
    "the connected components of the set of fixed points @xmath413 of the anti - involution are called the _ real ovals _ of @xmath414 .",
    "if @xmath415 has two components , the surface is called _",
    "dividing_. a curve with the maximal set @xmath416 of real ovals is called an _",
    "m - curve_. note that an m - curve is always dividing . in @xcite",
    "is was shown that real , smooth kp ii solutions of the form ( [ eq : solution ] ) are obtained on m - curves for @xmath417 . real smooth solutions to the kp i equation of the form ( [ eq : solution ] ) are obtained after the mapping @xmath418 , @xmath419 , @xmath420 for @xmath421 on dividing curves .",
    "in @xcite the numerical evaluation of solutions of the form ( [ eq : solution ] ) was discussed using the example of the davey - stewartson and multi - component nls equations .",
    "an important point in this context is the introduction of a homology basis adapted to the anti - holomorphic involution @xmath414 ( see @xcite ) for which the regularity conditions can be most easily identified . since the tretkoff - tretkoff algorithm @xcite implemented in the code in general does not produce such a basis , a symplectic transformation to the adapted basis has to be constructed .",
    "an algorithm to achieve this was presented in @xcite to which the reader is referred for details . in the following",
    "we will always assume that we work in the adapted basis obtained after applying this symplectic transformation .",
    "hyperelliptic solutions to the kp equation were discussed in @xcite .",
    "therefore we focus here on non - hyperelliptic curves .",
    "an example for a non - hyperelliptic m - curve of genus 3 is the trott curve @xcite given by the algebraic equation @xmath422 it is an m - curve with respect to the anti - holomorphic involution @xmath414 defined by @xmath423 .",
    "this curve has real branch points only ( and 28 real bitangents , namely , tangents to the curve in two places ) . in fig.[kptrott ] we show the solution ( [ eq : solution ] ) to the kp ii equation on the trott curve for vanishing @xmath424 and @xmath425 .",
    "it can be seen that the solution propagates mainly in the @xmath14-direction .",
    "the sheets are identified at    ....",
    "base =      -0.9871       ybase =      -0.0000 + 0.9047i    -0.0000 - 0.9047i    -0.1137 + 0.0000i     0.1137 + 0.0000i     ....    ) to the kp ii equation on the trott curve ( [ trott ] ) for @xmath426 and @xmath425 for different values of @xmath6 . ]",
    "note that the accuracy of the solution is controlled pointwise with the twice differentiated identity ( [ fay3 ] ) for theta functions which is identical to ( [ eq : kp ] ) .",
    "this identity is less well satisfied than for the examples discussed in previous section for the abel map since it has been differentiated twice more ( it contains 6th derivatives now , and each derivative leads roughly to a loss of an order of magnitude in the maximally achievable accuracy ) .",
    "still the identity is satisfied in all examples to the order of @xmath58 and better .    as an example for a dividing curve which is not an m - curve , we consider the curve given by the equation @xmath427 which was studied in @xcite and @xcite .",
    "it is a genus 3 curve , dividing with respect to the anti - holomorphic involution @xmath414 , without real branch point .",
    "this curve admits two real ovals .",
    "the kp i solution on this curve for @xmath426 and @xmath425 for @xmath428 can be seen in fig .",
    "the sheets are identified at    ....",
    "base =      -1.8931 - 0.1931i       ybase =     -11.1415 - 0.8713i    -4.5308 - 0.4989i    -3.9376 - 0.5035i    -1.2143 - 0.2500i     ....    ) to the kp i equation on the dividing curve ( [ divg3 ] ) for @xmath426 and @xmath425 for @xmath428 .",
    ", scaledwidth=70.0% ]    the curve given by the equation @xmath429 is a dividing curve of genus 6 without real branch points .",
    "we show a kp i solution ( [ divg6 ] ) ( after the usual substitution ) defined on this curve for @xmath426 and @xmath425 in fig .",
    "the code identifies the sheets as    ....      base =      -1.8243 - 0.4642i       ybase =     -11.0742 - 2.7527i   -10.8111 - 2.0894i    -4.0601 - 1.2074i    -3.9298 - 1.2330i    -1.1382 - 0.6088i     ....    ) to the kp i equation on the dividing curve ( [ divg6 ] ) for @xmath426 and @xmath425 for @xmath428 .",
    ", scaledwidth=70.0% ]",
    "in this paper we have outlined a fully numerical method for compact riemann surfaces which computes the characteristic quantities of the surface with spectral accuracy .",
    "an approach to algebraic curves based on finite precision floating point numbers obviously faces limitations , but as we have shown , these restrictions are not severe .",
    "we are mainly interested in the study of modular properties of generic riemann surfaces of low genus , i.e. , of curves which are regular or do not have singularities corresponding to zeros of very high multiplicity of the resultant ( [ resultant ] ) . in these cases",
    "the purely numerical approach presented here works well and is considerably more efficient than mixed symbolic - numeric approaches . for algebraic curves of high degree or with singularities of high order , homotopy tracing methods as in @xcite",
    "are more efficient if accompanied by an ` endgame ` to treat high order zeros ( for instance complex contour integrals as also used in the present paper in a different context ) .",
    "this is beyond the scope of this paper , but is planned for future versions of the code .    for an efficient approximation of the theta functions ( [ theta ] ) entering the solutions ( [ eq : solution ] ) to the kp equation",
    ", it is of course important that the number of terms in the truncated theta series needed to reach machine precision is as small as possible .",
    "this number is mainly determined by the eigenvalues of the imaginary part of the riemann matrix @xmath298 , see the discussion in @xcite and @xcite .",
    "siegel @xcite has shown that a symplectic transformation can be found that the diagonal elements of the imaginary part of @xmath298 are always larger than @xmath430 .",
    "this does not give a priori a lower bound for the eigenvalues of this matrix , but leads in general to more equally distributed eigenvalues .",
    "an implementation of siegel s algorithm was presented in @xcite .",
    "the problem is that siegel s method requires that certain matrices appearing during the algorithm need to be minkowski ordered which is computationally very expensive .",
    "therefore the lll algorithm @xcite which approximates the minkowski form and which is computationally less expensive has been used instead in @xcite , and is also implemented in the matlab package presented here .",
    "the problem is that lll does not provide a controlled approximation of the minkowski conditions .",
    "hence , future versions of the code will contain an implementation of the minkowski reduction conditions for small genus to test whether this in fact improves the convergence of the theta series with respect to the use of the lll algorithm .",
    "theta functions satisfy many identities .",
    "one of these , fay s trisecant identity @xcite , is very interesting and important in the context of completely integrable equations such as the kp equation studied in this paper .",
    "we define for four arbitrary points @xmath431 the cross ratio function ( @xmath432 is a theta function with a nonsingular half - integer characteristic ) @xmath433 which is a function on @xmath336 that vanishes for @xmath434 and @xmath435 and has poles for @xmath436 and @xmath437 . then the following identity holds : @xmath438 where @xmath327 and @xmath439 .",
    "the integration paths in ( [ fay ] ) have to be chosen in a way not to intersect the canonical cycles .    degenerate versions of fay s identity lead to identities for derivatives of theta functions .",
    "let @xmath440 be a local coordinate near @xmath227 .",
    "we denote by @xmath441 the operator for the directional derivative along the basis of holomorphic differentials , acting on theta functions , and similarly @xmath442 and @xmath443 the directional derivatives along @xmath368 and @xmath369 , @xmath444        in the limit @xmath451 , equation ( [ fay2 ] ) can be cast into the form ( we suppress the index @xmath452 at the derivatives ) @xmath453 where @xmath454 the constant @xmath455 is not needed here ( its somewhat involved expression can be obtained by expanding @xmath456 and @xmath457 ( [ qi ] ) in the considered limit to fourth order in the local parameter near @xmath452 ) .",
    "frauendiener , j. , klein , c. : _ algebraic curves and riemann surfaces in matlab _ , in a.  bobenko and c.  klein ( ed . ) , _ riemann surfaces computational approaches _ , lecture notes in mathematics vol . *",
    "2013 * ( springer ) ( 2011 ) .",
    "kamvissis , s. , mclaughlin , k.d.t .- r .",
    "miller , p.d . , semiclassical soliton ensembles for the focusing nonlinear schrdinger equation .",
    "annals of mathematics studies , * 154*. princeton university press , princeton , nj ( 2003 )      klein , c. , kokotov , a. , korotkin , d. : extremal properties of the determinant of the laplacian in the bergman metric on the moduli space of genus two riemann surfaces .",
    "zeitschr . *",
    "261*(1 ) , 73108 ( 2009 )          i. krichever , _ the averaging method for two - dimensional integrable equations _ , ( russian )",
    "i prilozhen . *",
    "22 * , no .",
    "3 , 3752 , 96 ( 1988 ) ; translation in funct . anal .",
    "* 22 * ( 1988 ) , no .",
    "3 , 200213 ( 1989 ) .              a.  poteaux , calcul de dveloppements de puiseux et application au calcul du groupe de monodromie dune courbe algbrique plane , phd thesis ( in french ) ( 2008 ) , http://www.lifl.fr/~poteaux/fichiers/these_poteaux.pdf          c.  swierczewski , b.  deconinck , computing riemann theta functions in sage with applications , mathematics and computers in simulation , issn 0378 - 4754 , http://dx.doi.org/10.1016/j.matcom.2013.04.018 ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> a purely numerical approach to compact riemann surfaces starting from plane algebraic curves is presented . </S>",
    "<S> the critical points of the algebraic curve are computed via a two - dimensional newton iteration . </S>",
    "<S> the starting values for this iteration are obtained from the resultants with respect to both coordinates of the algebraic curve and a suitable pairing of their zeros . </S>",
    "<S> a set of generators of the fundamental group for the complement of these critical points in the complex plane is constructed from circles around these points and connecting lines obtained from a minimal spanning tree . </S>",
    "<S> the monodromies are computed by solving the defining equation of the algebraic curve on collocation points along these contours and by analytically continuing the roots . </S>",
    "<S> the collocation points are chosen to correspond to chebychev collocation points for an ensuing clenshaw - curtis integration of the holomorphic differentials which gives the periods of the riemann surface with spectral accuracy . at the singularities of the algebraic curve , </S>",
    "<S> puiseux expansions computed by contour integration on the circles around the singularities are used to identify the holomorphic differentials . </S>",
    "<S> the abel map is also computed with the clenshaw - curtis algorithm and contour integrals . as an application of the code , solutions to the kadomtsev - petviashvili equation </S>",
    "<S> are computed on non - hyperelliptic riemann surfaces . </S>"
  ]
}