{
  "article_text": [
    "a set of quantiles provides a more complete description of a distribution than the mean .",
    "similarly , exploring the relationship between the quantiles of the conditional distribution of the response variable and a set of covariates offers key insight into the structure of the data at hand . as an important approach to quantile inference , the quantile regression has received substantial attention since koenker and bassett s  ( 1978 ) seminal work . there is a vast literature on the theory of quantile regression ; for an overview , see koenker  ( 2005 ) , yu  _ et  al_.  ( 2003 ) , and buchinsky  ( 1998 ) .",
    "studies on bayesian quantile regression particularly increased following yu and moyeed  ( 2001 ) , who introduced a likelihood function on the basis of asymmetric laplace distribution and performed a posterior estimation using the markov chain monte carlo ( mcmc ) method .",
    "a wide variety of quantile regression models based on the asymmetric laplace distribution have been considered in the literature ( _ e.g. _  kozumi and kobayashi ,  2011 ; yue and rue ,  2011 ; lum and gelfand ,  2012 ; neelon  _ et  al_. ,  2014 ) .",
    "moreover , kottas and krnjaji  ( 2009 ) and reich  _ et  al_. s   ( 2010 ) semiparametric approaches aimed at constructing a more flexible error distribution using quantile restriction . as an alternative to modelling error distributions with quantile restrictions , recent studies have directly considered modelling a conditional distribution or quantile function of the response variable ( _ e.g. _  taddy and kottas ,  2010 ; kadane and tokdar ,  2012 ; reich  _ et  al_. ,  2011 ; jang and wang ,  2015 ) .    as in the case of conventional mean",
    "regression , a standard quantile regression estimator is known to be biased when an endogenous variable is included .",
    "the problem of endogeneity in the quantile regression framework was recognised as early as in the 1980s ( amemiya ,  1982 ; powell ,  1983 ) . since then , there has been a growing interest in the inference for quantile regression models with endogenous variables and quantile treatment effects in the context of the frequentist approach ( _ e.g. _  abadie  _ et  al_. ,  2002 ; kim and muller ,  2004 ; ma and koenker ,  2005 ; chernozhukov and hansen ,  2005 ; 2006 ; 2008 ; lee ,  2007 ; horowitz and lee ,  2007 ; blundell and powell ,  2007 ; chernozhukov  _ et  al_. ,  2015 ) .    there exist numerous studies that adopt the bayesian framework to examine mean regression models with an endogenous variable from a theoretical and computational viewpoint ( _ e.g. _  hoogerheide  _ et  al_. ,  2007a ; 2007b ; conley  _ et  al_. ,  2008 ; lopes and polson ,  2014 ; wiesenfarth  _ et  al_. ,  2014 ) .",
    "however , despite the growing interest in and demand for bayesian quantile inference , the literature on the bayesian approach to quantile inference in the presence of an endogenous variable remains particularly sparse .",
    "lancaster and jun  ( 2010 ) adopted the moment conditions adopted in chernozhukov and hansen  ( 2006 ) for the empirical likelihood .",
    "drawing on lee  ( 2007 ) , kobayashi  ( 2016 ) and ogasawara and kobayashi  ( 2015 ) employed the control function approach .",
    "they considered the use of parametric and semiparametric first - stage error distributions , whose quantile is restricted to zero for some quantile level , and employed the asymmetric laplace distribution in the second stage , as in the standard bayesian quantile regression .",
    "kobayashi s   ( 2016 ) simulation study showed that while this approach works well in many situations , it may provide biased estimates owing to the restrictive specification of the first - stage error distribution . furthermore",
    ", both approaches assume a simple linear model for the conditional quantile and monotonicity ( non - crossing ) of the estimated quantiles is not necessarily guaranteed .",
    "given the preceding discussion , this study aims to provide a flexible bayesian approach to determine the structural effects of covariates on the conditional quantile of the response variable in the presence of an endogenous variable . to this end",
    ", we extend the bayesian nonparametric instrumental variable regression model proposed by wiesenfarth  _ et  al_.  ( 2014 ) and conley  _ et  al_.  ( 2008 ) and consider a location - scale specification . in particular , the joint error distribution of the instrumental variable regression model is modelled using the dirichlet process mixture of bivariate normals to capture the non - normality of the error distribution . to capture the nonlinear effect of the covariate on the response variable",
    ", the mean functions are nonparametrically modelled using the spline functions .",
    "in addition , we also nonparametrically model the conditional variance of the second - stage regression using spline functions such that the conditional variance varies smoothly with covariates . unlike the quantile curves implied from the bayesian nonparametric instrumental variable regression model , those implied from the proposed model are not necessarily parallel to each other since the conditional variance differs by covariate value .",
    "therefore , the estimated quantile curves allow significant flexibility in estimating the structural effect of the covariate of interest .",
    "in addition , since the conditional quantiles are computed from the nonparametrically estimated error distribution , the monotonicity of the quantile curves is guaranteed .",
    "the proposed model is estimated using the mcmc method that includes no metropolis  hastings ( mh ) update .",
    "the mcmc method is applied to sample from the posterior distributions of the conditional quantiles .",
    "the remainder of this paper is organised as follows .",
    "the proposed model is introduced and the choice of the prior distributions is discussed in section  [ sec : model ] .",
    "the mcmc method for the posterior inference on the conditional quantiles is developed in section  [ sec : mcmc ] .",
    "the proposed approach is illustrated using the simulated data in section  [ sec : sim ] and real data in section  [ sec : real ] , where the effect of doctors on the death rate in japan during the inter - war period is studied .",
    "finally , we conclude in section  [ sec : conc ] .",
    "the following parametric bayesian instrumental variable regression model provides the starting point of the model proposed in this study : @xmath0 where @xmath1 is the response variable , @xmath2 is the endogenous variable , @xmath3 is the instrumental variable , @xmath4 and @xmath5 are the intercepts , @xmath6 and @xmath7 are the coefficient parameters , and @xmath8 is the error term following @xmath9 , where @xmath10.\\ ] ] the correlation coefficient @xmath11 represents the degree of endogeneity .    the normality assumption for @xmath12 can be restrictive .",
    "outliers , some form of model misspecification , and heterogeneity can also induce non - normality in the error term . to relax the normality assumption ,",
    "conley  _ et  al_.  ( 2008 ) extended the model by introducing the dirichlet process mixture of bivariate normal distributions to nonparametrically construct the joint distribution of @xmath12 .",
    "more recently , wiesenfarth  _ et  al_.  ( 2014 ) further extended the model of conley  _ et  al_.  ( 2008 ) by considering @xmath13 where @xmath4 and @xmath5 are intercepts and @xmath14 and @xmath15 represent the nonlinear effects of the instrument and endogenous variables , respectively .",
    "the assumptions required for identification are denoted by @xmath16=0 $ ] and @xmath17=e[{\\epsilon}_2|{\\epsilon}_1]$ ] .",
    "the smooth functions are approximated using the spline functions and are represented as the linear combinations of the basis functions .",
    "the extensive simulation in these studies revealed that the nonparametric modelling approach is more robust against non - normality and outliers and performs better than existing approaches , including two- and three - stage least squares , a model under the normality assumption , and the control function approach with the generalised cross - validation procedure for the choice of a smoothing parameter .    from the viewpoint of quantile inference ,",
    "conley  _ et  al_.  ( 2008 ) and wiesenfarth  _ et  al_.  s(2014 ) modelling approach could be used to infer the structural effect of the covariate on the conditional quantile . however , although their dirichlet process mixture approach to the joint error distribution introduces heteroskedasticity over observations , the estimated quantile curves are parallel to each other since the conditional variance does not vary by covariate .",
    "an interesting feature of quantile regression is that its coefficients can vary by quantile .",
    "for example , if the data are generated from @xmath18 , where @xmath19 is the error term and @xmath20 represents heteroskedasticity , the @xmath21-th quantile regression estimator corresponds to @xmath22 , where @xmath23 is the quantile function of @xmath19 ( he ,  1997 ; reich  _ et  al_. ,  2010 ) .",
    "therefore , the applicability of conley  _ et  al_.  ( 2008 ) and wiesenfarth  _ et  al_.  ( 2014 ) to quantile inference would be limited to cases in which error distribution may exhibit heteroskedasticity but the variance does not depend on the covariates .      to allow for inference on the conditional quantile while correcting for an endogeneity effect , we extend and consider a location - scale model for more flexibility in the quantile curve .",
    "furthermore , to introduce the model for the conditional variance and prior distribution in a more flexible manner , the error term is rewritten following lopes and polson  ( 2014 ) .",
    "specifically , this study considers the model given by @xmath24 for @xmath25 , where @xmath26 is the intercept and @xmath27 is the smooth function of @xmath2 . for identifiability",
    ", the functions @xmath28 , @xmath29 , and @xmath30 are centred around zero .",
    "this formulation implies that the components of the covariance matrix @xmath31 for @xmath32 is recovered through @xmath33 , @xmath34 , and @xmath35 .",
    "although each equation in includes only one nonlinear effect for notational simplicity , the model can include more functions of covariates in an additive manner .",
    "as in conley  _ et  al_.  ( 2008 ) and wiesenfarth  _ et  al_.  ( 2014 ) , the error distribution is nonparametrically modelled using the dirichlet process mixture , but the prior distribution is introduced in a different manner .",
    "we introduce the dirichlet process prior for the distribution of @xmath36 : @xmath37 where @xmath38 denotes the dirichlet process with the precision parameter @xmath39 and base measure @xmath40 . since our model contains the global intercepts @xmath4 and @xmath5 ,",
    "to achieve identifiability , we employ the priors @xmath41 and @xmath42 such that @xmath41 and @xmath42 have mean zero apriori and force @xmath43 to ensure they have zero mean posteriori .",
    "in addition , since @xmath44 includes the intercept @xmath26 , we force @xmath45 posteriori as in sarkar  _ et  al_.  ( 2014 ) . as discussed in wiesenfarth  _ et  al_.  ( 2014 ) , this nonparametric modelling approach to error distribution allows different degrees of endogeneity correction over observations and downweights outliers in the error term .",
    "the degree of downweighting is controlled through the precision parameter of the dirichlet process and the parameters for variance components .",
    "the representation for the error term in allows for a more flexible choice of base measure and hyperpriors than that in conley  _ et  al_.  ( 2008 ) and wiesenfarth  _ et  al_.  ( 2014 ) , where the inverse wishart distribution for @xmath31 was employed ( lopes and polson ,  2014 ) . in this study",
    ", we employ the following independent distributions for @xmath40 : @xmath46 , @xmath47 , @xmath48 , @xmath49 , and @xmath50 .",
    "the choice of the hyperparameters and hyperpriors is discussed in section  [ sec : prior ] .",
    "each smooth function of covariate is approximated using a linear combination of b - spline functions in the study . for @xmath28 , for example , given the number of interior knots @xmath51 and degree @xmath52 , let us denote the set of knots by @xmath53 . using these knots ,",
    "the b - spline bases of degree @xmath54 denoted by @xmath55 can be calculated through a simple recursion of de  boor  ( 2000 ) .",
    "the smooth function @xmath14 is approximated by @xmath56 similarly , functions @xmath57 and @xmath27 are approximated using @xmath58 and @xmath59 .",
    "the smoothness of the functions is controlled through the prior distributions on the basis coefficients by penalising the differences between adjacent coefficients ( see section  [ sec : prior ] ) .    finally , we are interested in estimating the structural effect on the conditional quantile : @xmath60 where @xmath61 is the quantile function of @xmath62 . in addition , since the quantiles of the error term are directly obtained from the nonparametrically modelled distribution , crossing of estimated quantiles is not an issue .",
    "as mentioned above , contrary to the bayesian nonparametric instrumental variable regression model , since the conditional variance of the error term smoothly varies across the covariate values , the proposed approach models the conditional quantiles of the response variable in a more flexible manner .",
    "therefore , the smooth effects in the location - scale model , , allows for a great deal of flexibility in the estimated quantile curve .",
    "the present model is an extension of the control function approach of wiesenfarth  _ et  al_.  ( 2014 ) to the conditional mean .",
    "this is different from the bayesian quantile regression approach of kobayashi  ( 2016 ) and ogasawara and kobayashi  ( 2015 ) , who employed lee s  ( 2007 ) control function approach in the quantile regression framework .",
    "the control variable is introduced to the second - stage regression such that the @xmath21-th quantile for some @xmath21 of interest is corrected to be equal to zero .",
    "then , assuming a linear model , the structural effect is estimated from @xmath63 . while this approach works well in several situations , the required assumption for the first - stage error that the @xmath64-th quantile is equal to zero for some @xmath65 can be quite restrictive in modelling the error distribution . in terms of the quantile modelling",
    ", the present approach may be considered a bayesian nonparametric extension of gilchrist  ( 2008 ) , who considered various ways to introduce the covariate influence on the quantile function using parametric models .",
    "this section discusses the choice of the prior distributions and associated hyperparameters . for the spline coefficients for the nonlinear effects@xmath66 , @xmath67 , and @xmath68the gaussian random walk priors",
    "are assigned following lang and brezger  ( 2004 ) . in the case of @xmath69 ,",
    "the joint prior density is given by @xmath70 where @xmath71 with the difference matrix @xmath72 and @xmath73 is the variance parameter that controls the smoothness of the fitted function .",
    "the second - order priors are used throughout this study . for @xmath67 and @xmath68 ,",
    "the prior distributions have the parameters @xmath74 and @xmath75 . to let the data determine the amount of smoothness , following wiesenfarth",
    "_ et  al_.  ( 2014 ) , @xmath76 , @xmath77 , and @xmath78 are estimated along with the coefficients by introducing the vague inverse gamma priors , @xmath79 , where @xmath80 .",
    "for the intercepts @xmath4 , @xmath5 , and @xmath26 , we adopt the normal priors @xmath81 , @xmath82 , and @xmath83 , respectively . since we do not have information on these parameters , the hyperparameters are set such that the priors are vague : @xmath84 .",
    "we turn to the prior specification for the components in the dirichlet process . specifically , @xmath85 and @xmath86 , such that the prior means of @xmath41 and @xmath42 are zero . for these priors to be vague , we set @xmath87 .",
    "the values of @xmath88 and @xmath89 are selected such that the prior distributions cover the possible regions where @xmath41 and @xmath42 are likely to be produced .",
    "therefore , following ishwaran and james  ( 2002 ) , we let @xmath90 and @xmath91 equal four times the sample standard deviations of @xmath2 and @xmath1 .",
    "the prior specification for the hyperparameters @xmath92 and @xmath93 of @xmath94 is important because @xmath94 controls the degree of correction required because of the endogeneity .",
    "since @xmath95 , it is natural to assume that @xmath92 is centred around this value .",
    "therefore , @xmath96 is assumed , where @xmath97 is equal to the sample covariance between @xmath2 and @xmath1 divided by the sample variance of @xmath2 and @xmath98 .",
    "since we do not know the variability of @xmath94 , that is , the degree of heterogeneity in the endogeneity , we place a prior distribution for @xmath93 .",
    "namely , @xmath99 with @xmath100 such that @xmath93 takes a value between @xmath101 and @xmath102 with high probability . for @xmath103 and @xmath104",
    ", assuming that the data are appropriately rescaled , we set @xmath105 , @xmath106 , and @xmath107 . finally , the precision parameter of the dirichlet process follows the gamma prior @xmath108 with @xmath109 , such that both small and large numbers of mixture components are allowed . in the simulation study in section",
    "[ sec : sim ] , we also consider some alternative prior specifications for @xmath92 and @xmath39 .",
    "posterior inference for the proposed model is based on the output from the mcmc method .",
    "we develop the gibbs sampling method comprising the slice ( walker ,  2007 ) and retrospective ( papaspiliopoulos and roberts ,  2008 ) sampler for the variables included in the dirichlet process and mixture sampler ( chib and greenberg ,  2013 ) for coefficients in the variance function .",
    "we denote the variable representing the component assigned for the @xmath110-th observation by @xmath111 for @xmath25 and the weight of the @xmath112-th component of the mixture by @xmath113 with @xmath114 , and @xmath115 is the beta distribution with parameters @xmath39 and @xmath116 ( sethuraman ,  1994 ) .",
    "we also let @xmath117 denote the minimum integer such that @xmath118 . to apply the slice sampler and retrospective sampler to the variables involved in the dirichlet process",
    ", we work on the following joint density : @xmath119 where @xmath120 denotes the density function of the normal distribution with mean @xmath121 and variance @xmath104 , @xmath122 , and @xmath123\\left [ \\begin{array}{cc } \\tau_{k}&0\\\\ 0&s_i\\sigma_{k } \\end{array } \\right ] \\left [ \\begin{array}{cc } 1&\\eta_{k}\\\\ 0&1 \\end{array } \\right].\\ ] ] in addition , collecting terms of and would be useful for some steps of the gibbs sampler : @xmath124 , \\quad \\tilde{{\\text{\\boldmath{$\\beta$}}}}=({\\text{\\boldmath{$\\gamma$}}}',{\\text{\\boldmath{$\\beta$}}}')',\\quad { \\text{\\boldmath{$\\epsilon$}}}_i\\sim{\\mathcal{n}}({\\text{\\boldmath{$\\mu$}}}_{k_i},{\\mathbf{\\sigma}}_{k_i i}),\\end{aligned}\\ ] ] where @xmath125 , @xmath126 , @xmath127 , @xmath128 , @xmath129 , @xmath130 , @xmath131 @xmath132 , and @xmath133 .    our gibbs sampler proceeds by alternately sampling from the full conditional distributions of @xmath134 , @xmath135 , @xmath136 , @xmath137 , @xmath138 , @xmath139 , @xmath140 , @xmath39 , @xmath141 , @xmath142 , @xmath92 , @xmath93 , @xmath143 , @xmath144 , @xmath76 , @xmath77 , and @xmath78 .    *",
    "* sampling @xmath134 : * generate @xmath145 from @xmath146 for @xmath25 . *",
    "* sampling @xmath147 : * generate @xmath148 from @xmath149 , where @xmath150 for @xmath151 . *",
    "* sampling @xmath136 : * generate @xmath111 from the multinomial distribution with probabilities @xmath152 * * sampling @xmath39 : * by introducing @xmath153 , the full conditional distribution of @xmath39 is a mixture of two gamma distributions given by @xmath154 where @xmath155 is the number of distinct clusters and @xmath156 .",
    "see escober and west  ( 1995 ) . * * sampling @xmath137 : * for @xmath151 , @xmath157 is sampled from @xmath158 , where @xmath159^{-1 } , \\quad \\hat{{\\text{\\boldmath{$\\mu$}}}}_k=\\hat{{\\mathbf{m}}}_k\\left[\\sum_{i : k_i = k } { \\mathbf{\\sigma}}_{ki}^{-1}({\\mathbf{y}}_i-{\\mathbf{x}}_i\\tilde{{\\text{\\boldmath{$\\beta$}}}})+{\\mathbf{m}}_0^{-1}\\mathbf{\\vartheta } \\right],\\ ] ] where @xmath160 and @xmath161 . *",
    "* sampling @xmath138 : * for @xmath151 , @xmath162 is sampled from @xmath163 , where @xmath164^{-1 } , \\quad \\hat{\\theta}_k=\\hat{e}_k\\left[\\sum_{i : k_i = k}\\frac{(v_i-\\mu_{1k})(y_i-\\mu_{2k}-{\\mathbf{x}}_i'{\\text{\\boldmath{$\\beta$}}})}{\\sigma_k\\exp({\\mathbf{w}}_i'{\\text{\\boldmath{$\\alpha$}}})}+\\frac{\\vartheta_e}{\\varphi_e}\\right].\\ ] ] * * sampling @xmath165 : * for @xmath151 , @xmath166 is sampled from @xmath167 , where @xmath168 * * sampling @xmath169 : * for @xmath151 , @xmath170 is sampled from @xmath171 , where @xmath172 * * sampling @xmath141 and @xmath142 : * the full conditional distribution of @xmath141 is @xmath173 , where @xmath174 the sampling for @xmath142 is performed in a similar manner . * * sampling @xmath92 and @xmath93 : * the full conditional distribution of @xmath92 is @xmath175 , where @xmath176 and the full conditional distribution of @xmath93 is @xmath177 , where @xmath178 * * sampling @xmath143 : * the full conditional distribution of @xmath143 is denoted by @xmath179 , where @xmath180^{-1 } , \\quad \\hat{\\tilde{{\\text{\\boldmath{$\\beta$}}}}}=\\hat{\\tilde{{\\mathbf{b}}}}\\left[\\sum_{i=1}^n{\\mathbf{x}}_i'{\\mathbf{\\sigma}}_{k_i i}^{-1}({\\mathbf{y}}_i-{\\text{\\boldmath{$\\mu$}}}_{k_i})+\\tilde{{\\mathbf{b}}}_0^{-1}\\tilde{{\\mathbf{b}}}_0\\right],\\ ] ] @xmath181 , and @xmath182 is the block diagonal matrix with @xmath183 , @xmath184 , @xmath185 , and @xmath186 on the diagonal blocks . *",
    "* sampling @xmath144 : * note that @xmath187 where @xmath188 follows the log-@xmath189 distribution with one degree of freedom .",
    "it is known that the log-@xmath189 distribution can be accurately approximated by the ten - component mixture of normal distributions @xmath190 with the known means @xmath191 , variances @xmath192 , and component weights @xmath193 , @xmath194 ( omori  _ et  al_. ,  2007 ) .",
    "the values for @xmath191 , @xmath192 , and @xmath193 are summarised in [ sec : appa ] . introducing the indicator @xmath195 ,",
    "the mixture sampler proceeds by first sampling @xmath196 for @xmath25 from the multinomial distribution with probabilities @xmath197 and then , sampling @xmath144 from @xmath198 , where @xmath199^{-1},\\quad \\hat{{\\text{\\boldmath{$\\alpha$}}}}=\\hat{{\\mathbf{a}}}\\left[\\sum_{i=1}^n\\frac{{\\mathbf{w}}_i(y_i^*-\\xi_{h_i})}{\\zeta_{h_i}}+\\tilde{{\\mathbf{a}}}_0^{-1}\\tilde{{\\mathbf{a}}}_0\\right],\\ ] ] @xmath200 , and @xmath201 is the block diagonal matrix with @xmath202 and @xmath203 on the diagonal blocks .",
    "the values for @xmath191 , @xmath192 , and @xmath193 are presented in [ sec : appa ] .",
    "see also chib and greenberg  ( 2013 ) . * * sampling @xmath76 , @xmath77 , and @xmath78 : * the full conditional distribution of @xmath76 is @xmath204 , where @xmath205 we sample @xmath77 and @xmath78 in the same manner .",
    "the @xmath206-th iteration of the gibbs sampler provides a posterior draw from @xmath207 : @xmath208 where superscript @xmath209 denotes the sampled value at the @xmath206-th iteration and @xmath210 is the dirac mass at @xmath211 .",
    "the density estimate for the error distribution can be obtained from the posterior predictive density .",
    "then , given a draw @xmath212 from the posterior distribution , the posterior predictive density of the error term is computed as @xmath213 the second term is approximated by @xmath214 where @xmath215 is the @xmath216-th draw from @xmath40 and @xmath217 can be as large as @xmath218 ( see , _ e.g. _  jin and maheu ,  2016 ) . over the @xmath219 iterations of the gibbs sampler",
    ", the error density is estimated using @xmath220 to estimate for any @xmath221 , we obtain draws @xmath222 from the posterior distribution , where @xmath223 is a posterior draw of the @xmath21-th quantile of @xmath62 and computed from the posterior draw of the distribution function denoted by @xmath224 where @xmath225 denotes the distribution function of the standard normal distribution .",
    "as in taddy and kottas  ( 2010 ) , @xmath226 and @xmath61 must be computed over a sufficiently fine grid of covariate values . for a high dimensional covariate vector ,",
    "the inference would be feasible only when a one- or two - dimensional grid is used for the covariates of interest , while the other variables are fixed at some value .",
    "to illustrate the importance of modelling the variance function for quantile inference , the data are generated using a simple linear model : @xmath227 for @xmath25 , where @xmath228 and @xmath229 , @xmath230 , @xmath231 , @xmath232 , @xmath233 , @xmath234 , and @xmath235 , and @xmath236 takes the value of @xmath237 , @xmath238 , or @xmath239 with equal probabilities , such that the error distribution is a three - component mixture of normal distributions .",
    "this specification for the mixture components implies that the correlation coefficients between @xmath240 and @xmath62 are @xmath241 , @xmath242 , and @xmath243 .",
    "the data are replicated 100 times .",
    "we fit a simple version of the proposed model comprising a linear mean and variance functions but with a nonparametric error distribution . for comparison",
    ", we also fit two alternative models .",
    "the first is denoted by the restricted model and set to @xmath244 , such that the conditional variance is no longer a function of the covariates , following conley  _ et  al_. s  ( 2008 ) model and wiesenfarth  _ et  al_. s  ( 2014 ) simplified version .",
    "the second model is denoted by the uncorrected model and ignores the endogeneity of @xmath2 but accounts for covariate dependent variance .",
    "note that due to the bimodality of the error density , kobayashi s  ( 2016 ) approach is not applicable because it assumes a unimodal density for the first - stage error .",
    "for the three models , 10,000 draws are obtained from the posterior distribution using a gibbs sampler after discarding the initial 1,000 draws as a burn - in period .",
    "every fifth draw is retained for posterior estimation .",
    "figure  [ fig : sim1a ] presents the typical result for the posterior means and 95% credible intervals for the @xmath21-th quantile curves with @xmath245 , @xmath246 , and @xmath247 for the proposed , restricted , and uncorrected models for @xmath228 and @xmath229 . in the case of @xmath228",
    ", the figure shows that the true curves are not included in the 95% credible intervals for the restricted and uncorrected models for some parts of the region where @xmath2 is observed and for some @xmath21 . increasing the sample size to @xmath248 shows a clear difference between the three models .",
    "the quantile curves obtained from the restricted model must be parallel to each other and the 95% credible intervals do not include the true curves for most parts of the region where @xmath2 is observed , especially for @xmath245 and @xmath247 . for the uncorrected model , the figure shows that ignoring endogeneity leads to a bias and the 95% credible intervals do not include the true curves for most of the region for all three quantile levels considered here .",
    "in contrast , the proposed model correctly estimates the true quantile curves over the entire region where @xmath2 is observed .     for @xmath245 ,",
    "@xmath246 , and @xmath247 under the proposed , restricted , and uncorrected models for @xmath228 ( top row ) and @xmath248 ( bottom row),title=\"fig : \" ] +   for @xmath245 , @xmath246 , and @xmath247 under the proposed , restricted , and uncorrected models for @xmath228 ( top row ) and @xmath248 ( bottom row),title=\"fig : \" ]    figures  [ fig : sim1b ] and [ fig : sim1c ] present the biases and root mean squared errors ( rmses ) for the proposed , restricted , and uncorrected models for @xmath245 , @xmath246 , and @xmath247 , respectively .",
    "the bias and rmses are defined as @xmath249 over @xmath250 replication and over the grid @xmath251 on the space of @xmath2 , where @xmath252 is the posterior mean of at @xmath253 for the @xmath254-th replication .",
    "we set @xmath255 and let @xmath256 and @xmath257 .",
    "figure  [ fig : sim1b ] shows that the biases for the restricted and uncorrected models nonlinearly depend on the value of @xmath2 and do not become smaller as the sample size increases .",
    "by contrast , for all quantiles , the biases for the proposed model are near zero for the region considered and become closer to zero as the sample size increases . similar to the biases , figure  [ fig : sim1c ] shows the clear dependence of rmses for the restricted and uncorrected models on the value of @xmath2 .",
    "( top row ) and @xmath248 ( bottom row),title=\"fig : \" ] +   ( top row ) and @xmath248 ( bottom row),title=\"fig : \" ]     ( top row ) and @xmath248 ( bottom row),title=\"fig : \" ] +   ( top row ) and @xmath248 ( bottom row),title=\"fig : \" ]      in this section , the proposed model is demonstrated under various settings for the mean and variance functions .",
    "the data are generated from @xmath258 where we use the same setting for the error distribution as in section  [ sec : sim1 ] .",
    "for the mean and variance functions , the following three settings are considered :    1 .",
    "@xmath259 , @xmath260 , @xmath261 2 .",
    "@xmath262 , @xmath263 , @xmath264 3 .",
    "@xmath265 , @xmath266 , @xmath267    similar settings can be found in , for example , chib and greenberg  ( 2010 ; 2013 ) and leslie  _ et  al_.  ( 2007 ) .",
    "we consider two cases : @xmath268 and @xmath269 .",
    "the data are replicated 100 times .    to estimate the mean and variance functions",
    ", we use the cubic b - spline functions with equidistant knots by setting the first and last interior knots equal to the values of minimum and maximum observations . in the case of @xmath3 , for example , @xmath270 and @xmath271 for the @xmath254-th replication . following the rule of thumb",
    ", we set @xmath272 as in kauermann and wegener  ( 2011 ) and wiesenfarth  _ et  al_.  ( 2014 ) .",
    "as in the previous simulation , the performance of the proposed , restricted , and uncorrected models are compared .",
    "in addition , the following two alternative prior specifications are applied to the error distribution in the proposed model . as mentioned in section  [ sec : model ] , @xmath94 is an important quantity controlling the degree of correction required from the endogeneity in @xmath2 .",
    "the precision parameter @xmath39 controls how close the realisation of @xmath207 is to base measure @xmath40 .",
    "therefore , we consider two ways of introducing prior information with respect to @xmath94 and @xmath39 and compare the results .",
    "the first alternative prior deflates the prior variance of @xmath94 by about five times by setting @xmath273 , @xmath274 , and @xmath275 and inflates the prior expectation of @xmath39 by about five times by setting @xmath276 and @xmath277 .",
    "the second alternative prior inflates the prior variance of @xmath94 by about five times by setting @xmath278 and @xmath100 and deflates the prior expectation of @xmath39 by about five times by setting @xmath276 and @xmath279 .",
    "figure  [ fig : sim2c ] presents the estimated curves for settings  ( i ) , ( ii ) , and ( iii ) over 100 replication in the proposed model with the default and alternative prior specifications , restricted model , and uncorrected models for @xmath280 , and @xmath247 for @xmath281 . as in the previous simulation study",
    ", the figure shows that ignoring the covariate dependent variance or endogeneity leads to biased estimates .",
    "the figure also shows that the proposed model with three prior specifications can correctly estimate the true curves and appear to provide qualitatively similar results in these cases .",
    "figures  [ fig : sim2a ] and [ fig : sim2b ] present the biases and rmses for @xmath268 and @xmath281 and @xmath280 , and @xmath247 .",
    "figure  [ fig : sim2a ] shows that the restricted and uncorrected models produce biased estimates regardless of the sample size for all quantile levels and the biases nonlinearly depend on the value of @xmath2 . by contrast , the bias for the proposed model is near zero for all values of @xmath2 and becomes closer to zero as the sample size increases . as shown in figure  [ fig : sim2b ] , the rmse for the proposed model is smaller than those for the restricted and uncorrected models for most parts of the region where @xmath2 is observed . here",
    "as well , the rmses for the restricted model and , particularly , the uncorrected model , substantially vary by the value of @xmath2 .",
    "the figures also show that there is little difference in the biases and rmses between the default prior specification and with the two alternative prior specifications .     ,",
    "title=\"fig : \" ] +   , title=\"fig : \" ] +   , title=\"fig : \" ]     ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ]     ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ]    the proposed model does not model the variance of @xmath240 as a function of the covariates and the variances of @xmath240 in the data - generating models do not depend on the covariate in settings  ( i ) , ( ii ) , and ( iii ) .",
    "therefore , to examine how the proposed model performs when the variance of @xmath240 is a function of the covariate , settings ( i ) , ( ii ) , and ( iii ) , respectively , are extended to ( iv ) , ( v ) , and ( vi ) , such that @xmath282 with the following settings    1 .",
    "@xmath283 , 2 .",
    "@xmath284 , 3 .",
    "@xmath285 .",
    "figures  [ fig : sim2d ] and [ fig : sim2e ] show the biases and rmses for settings  ( iv ) , ( v ) , and ( vi ) under the proposed , restricted , and uncorrected models for @xmath245 , @xmath246 , and @xmath247 and for @xmath268 and @xmath269 .",
    "similar to figure  [ fig : sim2a ] , the bias for the proposed model is near zero for all values of @xmath2 and becomes closer to zero as the sample size increases .",
    "we obtained similar results for the rmse , which are also shown in figure  [ fig : sim2b ] .",
    "furthermore , the results for these settings under the proposed model do not appear to be significantly influenced by the prior specification .",
    "( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ]     ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ] +    ( top three rows ) and @xmath281 ( bottom three rows),title=\"fig : \" ]",
    "to illustrate the proposed approach using real data , the effect of the number of doctors on japan s death rate during the inter - war period is studied .",
    "the economic history literature has extensively studied declines in the mortality rates of western countries across the 19th and 20th centuries .",
    "recent studies have found the improving effects of national health insurance systems on mortality rate ( _ e.g. _  winegarden and murray ,  1998 ; 2004 ; bowblis ,  2010 ) .",
    "the successful application of germ theory has also been considered to decrease the mortality rate ( mackenbach ,  1996 ; mokyr and stein ,  1997 ) . to the effect of medical care , the importance of opportunity for medical care , for instance , through one - on - one contact and medical vouchers , for people with limited access to medical care",
    "have also been stressed in recent studies ( moehling and thomasson ,  2014 ; ogasawara and kobayashi ,  2015 ) .",
    "these studies revealed that increased access to medical care contributed to the decline in mortality rates in the process of economic development .    while the existing literature has dominantly focused on the _ indirect _ effects of medical doctors through national insurance systems or medical vouchers , limited works identify the _",
    "direct _ effects of medical doctors on the mortality rate in industrialising countries . evaluating the effects of medical access on mortality rate",
    "has key implications for medical policies in developing countries ( _ e.g. _  banerjee and deflo ,  2007 ; schultz ,  2010 ) .",
    "since the number of medical doctors in a certain area may be correlated with unobservable wealth levels , an instrumental variable technique is needed to straightforwardly identify the effects of medical doctors on mortality rate .",
    "therefore , we estimate the impact of medical doctors with modern medical techniques on the crude death rate ( hereafter , death rate ) by applying the proposed approach to the newly constructed county - level japanese dataset for 1925 and 1930 .      to analyse the effects of an increase in medical opportunities on death rate , we compiled a large set of statistical reports published by the central and local governments , such as the prefectural statistical tables ( psts ) and population census for 1925 and 1930 .",
    "the finer details of the documents and method of constructing the dataset are provided in [ sec : appb ] .",
    "we restricted the sample to counties in the mainland of japan because of the small sample size in several small islands .",
    "the data comprise 638 observations for each year , and thus , a total of 1,276 observations are used in the following analysis .",
    "table  [ tab : real1 ] presents the summary statistics and the definition of the variables included in our data .",
    "the death rate ( _ dr _ ) is defined as the number of deaths per 1,000 people .",
    "the sample means of the death rate are @xmath286 and @xmath287 for 1925 and 1930 .",
    "our key variable is the log of the number of doctors ( _ lndoc _ ) .",
    "the sample means of @xmath288 in our data are @xmath289 and @xmath290 for 1925 and 1930 . for the above - mentioned reason , it is treated as an endogenous variable .",
    "the effects of the number of doctors on the mean and variance of the death rate are allowed to vary between the years by considering a varying coefficient specification .",
    "the instrumental variable used herein is the log of the total area of the county in square kilometres ( _ lnarea _ ) .",
    "we argue that our exclusion restriction is plausible because the borders of the counties were exogenously predetermined and thus , it should not be affected by unobserved factors , which might have affected medical opportunities such as potential wealth levels in the counties .",
    "it will be confirmed that the area has a positive effect on the number of medical doctors .",
    "the covariates include the share of infant ( _ child _ ) and elder ( _ old _ ) population and the age structure of the population is assumed to have nonlinear effects on the death rate .",
    "we also include the log odds ratios of the proportion of population employed in the agricultural ( _ agri _ ) , mining ( _ mine _ ) , and industrial ( _ ind _ ) sectors and the log odds ratio of the primary school enrolment rate ( _ enrol _ ) .",
    "these variables are included to control for the population and industrial structure effects , potential wealth level , and unobservable macroeconomic shock in a given year and are assumed to have linear effects .",
    "to summarise , the following model is fitted to the data : @xmath291 where @xmath292 and @xmath293 is the dummy variable such that @xmath294 and @xmath295 .",
    ".real data : summary of data [ cols=\"<,<,>,>,>,>\",options=\"header \" , ]",
    "the crude death rate is defined as the number of deaths per 1,000 people .",
    "the number of deaths in each county is taken from a compilation of _ fuken tokei hyo _",
    "( prefectural statistical tables ; psts ) for 1925 and 1930 published by each prefecture ( yushodo filmshuppan yugenkaisha , 1977 ) .",
    "the psts for some prefectures for a specific year generally comprise several volumes of reports , such as the volumes for the land and population , education , public health , and police .",
    "each volume comprises roughly 2001,000 pages . in total , we compiled roughly 200 volumes to obtain the number of deaths in each county .",
    "the population are taken from _",
    "kokusei chosa hokoku _ ( population census of japan ; pcj ) for 1925 and 1930 ( statistics bureau of the cabinet 1926 ; 1935 ) .",
    "data on the number of medical doctors in each county are from the psts . to account for the missing values in miyagi prefecture for 1925 , we used data from _ dainihon ishimeibo _",
    "( list of medical doctors in japan ; lmdj 1925 ) edited by medical doctor masao takasaki . for the missing values in aomori , miyagi , fukushima , tochigi , shizuoka , shimane , hiroshima , and fukuoka prefectures for 1930 , we adopted data from _ dainihon ishimeibo _",
    "( lmdj 1930 ) edited by kaneharashoten .",
    "data on the total area in square kilometres were also taken from the psts .",
    "for the missing values in fukui ( 1925 and 1930 ) and miyagi and ishikawa ( in 1930 ) prefectures , we used the 1921 and 1925 values of total area for these prefectures from the psts since the total area of a prefecture is unlikely to change .",
    "the county - level age - specific population data are from the 1925 and 1930 editions of _ kokusei chosa hokoku , fukenhen _",
    "( population census of japan , prefectural part ; pcjpp ) published by the statistics bureau of the cabinet ( various years ) . for each census year , we compiled 47 reports of the pcjpp .",
    "data on the number of workers in each industry are also from the 1920 and 1930 editions of the pcjpp published by the statistics bureau of the cabinet ( various years ) . since the population census of 1925 was a partial census , the number of workers in the year is linearly interpolated using both the 1920 and 1930 values .",
    "the data on the primary school enrolment rate are taken from the psts .",
    "hoogerheide ,  l.  f. , kleibergen ,  f. , and van  dijk ,  h.  k. ( 2007a ) .",
    "`` natural conjugate priors for the instrumental variables regression model applied to the angrist  krueger data , '' _ journal of econometrics _ , * 138 * , 63103 .",
    "hoogerheide ,  l. , kaashoek ,  j.  f. , and van  dijk ,  h.  k. ( 2007b ) .",
    "`` on the shape of posterior densities and credible sets in instrumental variable regression models with reduced rank : an application of flexible sampling methods using neural networks , '' _ journal of econometrics _ , * 139 * , 154180 .",
    "ishwaran ,  h. and james ,  l.  f. ( 2002 ) . `` approximate dirichlet process computing in finite normal mixtures : smoothing and prior information , '' _ journal of computational and graphical statistics _ , * 11 * , 508532",
    ".                                    mokyr ,  j. and stein ,  r. ( 1997 ) .",
    "`` science , health , and household technology : the effect of the pasteur revolution on consumer demand , '' in t.f .  bresnahan and r.j .",
    "gordon ( eds . ) , _ the economics of new goods _ , university of chicago press : chicago .",
    "ogasawara ,  k. and kobayashi ,  g. ( 2015 ) .",
    "`` the impact of social workers on infant mortality in inter - war tokyo : bayesian dynamic panel quantile regression with endogenous variables , '' _ cliometrica _ , * 9 * , 97130 .",
    "sarkar ,  a. , mallick ,  b.  k. , and carroll ,  r.  j. ( 2014 ) .",
    "`` bayesian semiparametric regression in the presence of conditionally heteroscedastic measurement and regression errors , '' _ biometrics _ , * 70 * , 823834 .",
    "wiesenfarth ,  m. , hisgen ,  c.  m. , kneib ,  t. , and cadarso - suarez ,  c. ( 2014 ) .",
    "`` bayesian nonparametric instrumental variables regression based on penalized splines and dirichlet process mixtures , '' _ journal of business and economic statistics _ , * 32 * , 468482 .",
    "winegarden ,  c.  r. , and murray  j.e .",
    "( 1998 ) . `` the contributions of early health - insurance programs to mortality declines in pre - world war i europe : evidence from fixed - effects model , '' _ explorations in economic history _ , * 35 * , 431446 ."
  ],
  "abstract_text": [
    "<S> this study extends the bayesian nonparametric instrumental variable regression model to determine the structural effects of covariates on the conditional quantile of the response variable . </S>",
    "<S> the error distribution is nonparametrically modelled using a dirichlet mixture of bivariate normal distributions . </S>",
    "<S> the mean functions include the smooth effects of the covariates represented using the spline functions in an additive manner . </S>",
    "<S> the conditional variance of the second - stage error is also modelled using the spline functions such that it varies smoothly with the covariates . accordingly </S>",
    "<S> , the proposed model allows for considerable flexibility in the shape of the quantile function while correcting for an endogeneity effect . </S>",
    "<S> the posterior inference for the proposed model is based on the markov chain monte carlo method that requires no metropolis  </S>",
    "<S> hastings update . </S>",
    "<S> the approach is demonstrated using simulated and real data on the death rate in japan during the inter - war period .    * keywords * : dirichlet process mixture ; historical data ; instrumental variable ; markov chain monte carlo ; penalised splines    = 1 </S>"
  ]
}