{
  "article_text": [
    "quasi periodic oscillations ( qpo ) have been observed in many x - ray sources for the last 24 years @xcite .",
    "they appear as broad peaks in the power spectra , with a behavior dependent on the source state , the mass accretion rate , and other physical properties of the sources .",
    "they are present in both neutron star ( hereafter ns ) and black hole ( bh ) sources , sometimes with peculiar similarities between the two classes of objects ( see * ? ? ?",
    "* for a review ) .    of particular interest",
    "are the khz qpos : they were first discovered in the low mass x - ray binary ( lmxb ) and z source sco - x1 @xcite , to be then observed in the spectra of nearly all z and atoll sources , as well as several weak lmxbs ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "they have frequencies between 300hz and 1.2khz ( see * ? ? ?",
    "the peaks move with timescales of hours / days and their quality factor @xmath1 ( ratio between the frequency and the width of the peak , a measure of coherence ) is not constant , but can be related with the qpo frequency @xcite and with the mass accretion rate ( see for example * ? ? ?",
    "the khz qpos usually appear as a pair of peaks ( the _ twin peaks _ ) , labeled `` upper '' and `` lower '' ( and their frequencies , accordingly , @xmath2 and @xmath3 ) .",
    "while on timescales of hours the two frequencies change , their difference @xmath4 tends to be almost costant . as with the discovery of burst oscillations @xcite and accreting millisecond x - ray pulsars ( hereafter amxp ) @xcite the spin frequencies @xmath5 of more and more accreting neutron stars were measured ,",
    "an interesting behavior was observed : @xmath6 was usually found to be close to either @xmath5 or @xmath7 .",
    "recent works ( see for example * ? ? ?",
    "* ) call this assumption into question .",
    "in particular , it can be shown that @xmath8 could in principle be independent from @xmath5 .",
    "it has been shown that the khz qpos frequency is correlated , at least on a given system and for short timescales , with the x - ray count rate @xcite and thus also , probably , with the mass accretion rate .",
    "many models have been developed to explain the khz qpo phenomenon .",
    "they involve a number of different mechanisms , like for example relativistic precession frequencies @xcite , relativistic resonances @xcite , beats between the keplerian frequency at a particular radius in the disk and the frequency of the star @xcite , oscillations in the comptonizing medium @xcite .",
    "recently , @xcite and @xcite found and analyzed a radially localized rossby wave instability which exists in the inner region of a disk around a magnetized star where the angular rotation rate of the matter decreases approaching the star .",
    "this instability may explain the twin kilo - hertz qpos observed in some lmxbs .",
    "the importance for qpos of the disk angular rotation rate having a maximum was discussed earlier by @xcite    most of the models of khz qpos , based on the fact that qpos also appear in black hole systems and there seems to be a link between @xmath3 with frequencies observed in black hole systems @xcite , try to explain the behavior of khz qpos in both the neutron star and the black hole cases , excluding the possibility of a surface emission .",
    "@xcite claim that , according to spectral emission properties of qpos , in atoll and z sources periodic and quasi - periodic emission is more likely to be produced on the surface of the star .    during the past years mhd simulations have been amongst the most fruitful methods to investigate accreting magnetized stars ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "3d simulations have given insight into the way matter accretes , showing in more detail trajectories , shapes of magnetic field lines , shapes and movements of hot spots on the surface of the star ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "simulations show that matter may accrete in several different regimes :    * the _ stable accretion _",
    "regime , when matter is stopped by the magnetic field and conveyed to the magnetic poles via the so called _ funnel flow _ @xcite ; * the _ unstable _ regime , when rayleigh - taylor instabilities form at the boundary between the disk and the magnetosphere @xcite , and accretion takes place through tongues of matter from the inner edge of the disk to random places between the equator and the magnetic poles ; * the _ magnetic boundary layer _ regime ,",
    "during which the disk is very close to the surface of the star and the accretion takes place via two big antipodal equatorial tongues which rotate with the frequency of the inner disk @xcite .",
    "one of the interesting phenomena observed in 3d simulations is the movement of spots around the magnetic pole of the accreting star , both in stable @xcite and in unstable regime @xcite .",
    "it was noticed that in some cases , such as in the magnetic boundary layer regime , the moving spots produce qpo features @xcite .",
    "usually , models of ns surface emission ( like in the case of accreting millisecond pulsars ) consider funneling of matter onto the polar caps as a static process , with a fixed polar cap and thus a fixed emission spot + citep[e.g.][]beloborodov:2002p4173,poutanen:2003p4169 .",
    "3d simulations show that this may not be the case in particular for small misalignment angles .",
    "recent works @xcite investigate the wandering of hot spots at which matter accretes in sources with a small misalignment angle , finding that it might affect the coherence of the pulsed signal from neutron stars and even destroy it , being the origin of the transient emission in amxps .",
    "the movements hypothesized in those works , though , are different from the movements observed in our 3d simulations , where the motion of the hotspots is a rotational motion around the magnetic pole or in the equatorial region , on timescales of milliseconds .",
    "moreover , the dimension of the hotspot in those two works ( a radius of @xmath9 ) does not find confirmation in our simulations .",
    "it corresponds to the dimension of the whole `` hot ring '' where our hotspots ( much smaller ) move ( see fig .",
    "fig : sf - stab - join ) .    in this paper",
    "we show that the observed movements carry with them the information of disk frequencies near the inner disk , and their effect is the production of quasi - periodic oscillations at the relative frequencies .",
    "we perform a series of 3d mhd simulations ( mostly for the cases of very small @xmath0 ) and analyze the rotation of the spots and the related frequencies in detail .",
    "mhd simulations can only follow the motion of the disk on very short timescales compared to the disk evolution timescale and the observational time .",
    "for this reason , we use the features of the moving spots produced in simulations to generate long lightcurves by means of monte carlo techniques , showing that the motion observed produces qpos .",
    "then , we show that the phenomenon follows a predictable behavior as the mass accretion rate changes .",
    "we start in  sec : model with a general description of the 3d mhd model used for this work .",
    "then , we show the way spots move in our simulations in  sec:3d .",
    "we then show with a monte carlo - generated lightcurve our model of surface qpo production in  sec : mc .",
    "finally , in  sec : mdot we show how the angular velocities of hot spots correlate with the mass accretion rate .",
    "we model the accretion disk around a neutron star as a single fluid plasma , interacting with the star s magnetic field .",
    "we then solve the complete system of mhd equations in the coordinate system rotating with the star @xcite @xmath10 where @xmath11 is the density , @xmath12 is the velocity of the fluid , @xmath13 is the gravitational acceleration , @xmath14 is the magnetic field , @xmath15 is the momentum flux - density tensor , and @xmath16 is the density of entropy .",
    "the equations are solved by means of the godunov scheme @xcite , using a cubed - sphere grid .",
    "the outward transfer of angular momentum in the disk is produced by an @xmath17-type viscosity @xcite .",
    "a detailed description of these equations and their implementation can be found in @xcite .    the potential",
    "well around the neutron star is represented by the pseudo - newtonian potential described in @xcite , in order to take into account relativistic corrections to the movement of matter around the star .",
    "this potential is described by the equation @xmath18 where @xmath19 is gravitational radius ( equal to the schwarzschild radius ) .",
    "this form of the potential gives the correct values for the marginally bound circular orbit and in particular the innermost stable circular orbit ( isco ) in the schwarzschild non - rotating bh case .",
    "this can be useful to interpret the results of this work in terms of theoretical models taking the isco as a fundamental quantity for understanding qpos .",
    "all quantities used in the 3d code are dimensionless .",
    "hereafter , given a dimensional quantity @xmath20 , we call @xmath21 the corresponding dimensionless unit , where @xmath22 is the reference value for @xmath20",
    ". every result can be applied to different physical systems , evaluating the @xmath22s by choosing the right values of three fundamental dimensional parameters :    * @xmath23 : the * mass * of the star ; * @xmath24 : its * radius * ; * @xmath25 : its * magnetic moment * , corresponding to a dipolar surface magnetic field @xmath26 .    at the start of simulations , we fix the following dimensionless parameters :    * the * corotation radius * @xmath27 , defined as the radius where the keplerian angular velocity equals the star s angular velocity",
    ". it sets the rotational velocity of the star ( see eq .",
    "eq : omega ) ; * the * viscosity * @xmath28 , on the model of @xcite ; * the * magnetic moment * @xmath29 , and possible non - dipolar components , which are not used in this work .",
    "alternatively , @xmath29 can be considered as a parameter to set the size of the magnetosphere and the mass accretion rate ( see eq .",
    "eq : mdot ) ; * the * misalignment angle * @xmath0 , the angle between the magnetic axis and the rotation axis .    the reference quantities are calculated as follows :    * @xmath30 ; * @xmath31 , the reference * distance * from the center of the star , chosen this way for convenience , because of the vicinity of @xmath32 to the usual range of magnetospheric radii ; * @xmath33 and @xmath34 ; then , the surface magnetic field is @xmath35 ; * @xmath36 , the reference * velocity * ; * @xmath37 , the reference * angular velocity * ; * @xmath38 , the keplerian period at @xmath32 as the reference * time * ; * @xmath39 as the reference * density * ; * @xmath40 as the reference * mass accretion rate * ; * @xmath41 is the reference * luminosity *    from which we obtain @xmath42 where @xmath5 , @xmath43 , @xmath44 and @xmath45 are the frequency of the star , its period , the mass accretion rate and luminosity respectively . @xmath46 and @xmath47",
    "are returned by the code at every time step .",
    "@xmath47 is calculated under the assumption that all the energy of the accreted matter is converted into luminosity .",
    "equation  [ eq : mdot ] gives us a way to use the parameter @xmath29 to effectively measure the accretion rate .",
    "instead of using the simplest interpretation , according to which @xmath29 is a dimensionless measure of the magnetic field , we can in fact change @xmath48 in order to make @xmath49 constant , changing effectively the mass accretion rate reference value @xmath50 .      unless otherwise specified , throughout this paper all results are referred to a neutron star with @xmath51 km , @xmath52 , @xmath53",
    ". the magnetic field will be either @xmath54 g or @xmath55 g . with these parameters ,",
    "the gravitational radius of the paczynski - wiita potential is @xmath56 km while the isco is at a radius @xmath57 km ( in dimensionless units , @xmath58 ) .",
    "the grid used for most of the simulations has 72 cells in radial direction and 31 along every side of the six blocks of the cubed sphere .",
    "the simulations shown have been produced in the period january - june 2009 , using the high performance computing facilities of nasa ( pleiades , columbia ) and cineca ( bcx ) .",
    "in this section we show how spot motions can produce visible features in the lightcurves .",
    "@xmath59{img / d2_c1_5-a0_04_theta-2_lpk_xz - join.jpg } &   \\includegraphics[width=4.5in]{img / d2_c1_5-a0_04_theta-2_lpk_sf - join.jpg } \\end{array}$ ]    @xmath59{img / c1_8-a0_03-theta-2_d0_9_lpk_xz - join.jpg } &   \\includegraphics[width=4.5in]{img / c1_8-a0_03-theta-2_d0_9_lpk_sf - join.jpg } \\end{array}$ ]    @xmath59{img / c1_8-a0_03-theta-2_d0_3_lpk_xz - join.jpg }   \\includegraphics[width=4.5in]{img / c1_8-a0_03-theta-2_d0_3_lpk_sf - join.jpg } \\end{array}$ ]    the magnetic field of a ns is usually strong enough to truncate the accretion disk at a certain distance , called inner radius or magnetospheric radius , where the magnetic and material stresses are equal @xcite . in most cases ,",
    "if the inner radius is comparable with the corotation radius , accretion takes place in a stable fashion : matter is stopped in the disk by the magnetic field and moves towards the magnetic poles with the magnetic field lines acting like an invisible funnel ( see fig .",
    "fig : sf - stab - join , left ) . depending on the misalignment angle ,",
    "the hot spot can either be almost fixed or move in a ring - like zone around the magnetic pole ( e.g. * ? ? ?",
    "* ) , with an angular velocity dependent on the keplerian velocity of the zone of the disk which the matter comes from . for the cases in this paper , the misalignment angle is very small ( @xmath60 ) and we observe that the hot spot almost always rotates ( e.g. , fig .",
    "fig : sf - stab - join , right three columns ) . in fig",
    "fig : spotvsmis several test cases at various @xmath0 are plotted , showing that the spot movement is less and less pronounced as @xmath0 increases , as expected .",
    "this hotspot movement can be visualized in this way : for a moment let us imagine the star as a perfectly aligned rotator .",
    "matter falling onto the polar caps forms a sort of whirlpool . if density enhancements of the flow are formed ( see fig .",
    "fig : sf - stab - join and also fig .",
    "fig : sf - unstab - join , bottom left : the density over the funnel is not constant ) these density enhancements rotate around the magnetic pole with the angular velocity of the zone of the disk they come from .",
    "but when the disk comes closer , either for a weak magnetic field or for a high accretion rate , rayleigh - taylor instabilities appear at the interface between the disk and the magnetosphere .",
    "these instabilities produce long and narrow tongues of matter , that penetrate the magnetosphere and fall towards the equator .",
    "matter spilling through the magnetospheric boundaries can , at this point , fall onto the equator or be diverted by the magnetic field lines to a random point between the equator and the magnetic poles ( see fig .",
    "fig : sf - unstab - join , left ; see also @xcite ) . in this case",
    "multiple hot spots appear , whose duration is normally shorter than in the stable case , and whose motion is more complicated , because the tongues of matter originating them follow random paths before reaching the star .",
    "the formation of instabilities does not usually prevent the funnel from forming , as fig .",
    "fig : sf - unstab - join shows .",
    "the angular velocities of the unstable spots are measurable from the spot - omega diagram described below and thus , as we are going to see in the next sections , they can give observable effects on the lightcurves .",
    "if the disk comes very close to the surface of the star , matter can penetrate the field lines forming two ordered antipodal tongues which fall towards the equator of the star @xcite , as in fig .",
    "fig : sf - boulay - join . the hot spots produced in this way last longer than in the above cases , and move with a stable angular velocity corresponding to the keplerian velocity at the truncation radius .",
    "we plot the average density in the area delimited by the ring borders and the directions @xmath61 and @xmath62 , obtaining a plot like the bottom of fig .",
    "fig : so - wlet - join , width=288 ]    we need a tool to describe the movement of the hot spots on the surface of the star in a quantitative way . a tool which not only highlights the movements , but also gives us a way to measure their angular velocity and their duration .",
    "the spot - omega diagram , first introduced in @xcite , shows the variation of the azimuthal density distribution around the magnetic pole during accretion . to obtain it",
    ", we choose a ring around the magnetic pole as in fig .",
    "fig : spotpos , whose limits are two angles @xmath63 and @xmath64 with respect to the magnetic pole . then , for every direction @xmath65 around the magnetic pole , we calculate the average density of accreting matter in the area enclosed by @xmath66 ( with @xmath67 a small step ) and the borders of the ring .",
    "we do this for every time step of our simulation .",
    "this gives us the azimuthal density distribution as a function of time .    in the resulting diagram ,",
    "rotations of the spots appear as drifts of the maximum of the flux with time .",
    "if we draw a line along the drifts , evidently @xmath68 , and so the slopes of the curves give us a measure of the angular velocity of the moving spots .",
    "to highlight movements which are longer than one rotation around the star , we can replicate the plot in the vertical direction , going from @xmath69 to , say , @xmath70 instead of @xmath71 , obtaining for example the plot shown in fig .",
    "fig : so - wlet - join .",
    "the spot - omega diagram can be analogously used to track the hot spots formed in the equatorial plane , choosing as @xmath63 and @xmath64 two angles that enclose the equator , measured with respect to the rotational axis instead of the magnetic axis .              in the spot - omega diagram",
    "the movement of the spots is shown by the variation of position of the flux maxima with time .",
    "the angular velocity @xmath72 of the spots is straightforward to calculate from the slopes of the curves the moving spots produce .",
    "the values in the boxes are the angular velocities in the frame of reference of a distant observer , in units of @xmath73 .    before utilizing the frequencies obtained from the spot - omega diagram ,",
    "let us justify its use .",
    "our goal is to show that the movements whose frequencies can be observed in the spot - omega diagram also produce oscillations in the lightcurves , and thus traces in the power spectrum .    after obtaining the diagram",
    ", we independently calculate the lightcurve produced by the surface of the star .",
    "this lightcurve is produced in the approximation of perfect black body emission of all the kinetic energy of the accreting matter and includes corrections for relativistic dppler effect , light bending and time delay @xcite .",
    "we analyze it with a wavelet transform , in order to verify if frequencies associated with the spot movement can be extracted by means of spectral analysis .    here",
    "we show an example of stable accretion onto a neutron star .",
    "the parameters chosen for this case are @xmath74 ( corresponding to a ns with @xmath75ms ) , @xmath53 , @xmath76 , @xmath77 .",
    "the results for this case can be summed up as in fig .",
    "fig : so - wlet - join .    not surprisingly , we can see a correlation between the slopes observed in the spot - omega diagram and some features of the wavelet transform .",
    "moreover , we should take into account the fact that the typical time scale of our simulations is a few rotations of the star ( milliseconds in the case of amxps ) .",
    "the wavelet transform only has a very short time to record spectral features . in real accreting systems",
    ", time scales for average density changes in the disk are much longer .",
    "therefore , we can reasonably expect to see the emission from the moving spots as spectral features , in contrast with the usual assumptions found in the literature .    as shown in fig .",
    "fig : xz - e - join , the velocity of the spot is consistent with the keplerian velocity of the zone of the disk where the funnel starts from .",
    "thus , so far we have shown that spot motions produce visible features in the power spectra , and can be tracked using the spot - omega diagram .",
    "in the last section we showed that during accretion , in both the stable and the unstable cases , spots can move on the surface of the star with a different velocity than the star itself .",
    "what is evident from our simulations is that the moving spots are as bright as the ones produced in other simulations , in which the spots were fixed . if the fixed spots are able to produce the strong and stable signal we observe in accreting millisecond pulsars , we believe that the moving ones must be visible through particular features in the power spectrum .",
    "we suggest that qpos may be among these features . to show this , we start by observing that the spot movements shown in 3d simulations last a very short time , only a few rotations of the star , because disk conditions are changing very fast . in real accretion disks ,",
    "disk properties change on much longer timescales , say minutes at least",
    ". we can safely assume that if movements of spots exist , they will probably last much longer than in simulations .",
    "nonetheless , we can expect the flux of matter not to be constant , and so the spots may be sometimes brighter , sometimes less .",
    "these bright moving spots emit a signal which , from an observer point of view , must be modulated with a frequency corresponding to the angular velocity of the spots in the observer s frame . our way to model this kind of emission is to imagine consecutive trains of sinusoids , of variable duration and amplitude but constant or quasi - constant frequency . to simulate the non - pulsed emission from the disk , we add a fixed background .    furthermore , we see from simulations that near the @xmath78 plane , where the infall of matter is slightly more favorable , the spots are slightly brighter on average .",
    "we model this as an additional pulsed signal to add to the rest of the lightcurve .",
    "this pulsed signal , coming from a fixed point on the star , is rotating with the star and will thus have the frequency of the star @xmath5 .    at the end of this process",
    ", we have a single , continuous lightcurve in which we can separate three components : a fixed background representing the overall average emission from the star , a continuous pulsed signal with the frequency of the star , and a certain number of wavetrains with the frequency of the spots .    as a final icing on the cake",
    ", we notice that normally accreting neutron stars are observed in x - rays , and therefore the observed signal is not a continuous lightcurve , but rather a series of photons which are detected as `` events '' by the instruments in x - ray telescopes . to switch from a continuous lightcurve to a more realistic series of events , we take advantage of the fact that common detection rates for this kind of objects in real observations are of the order of @xmath79 . for millisecond pulsars , we have approximately one event per rotation , and we can thus safely assume these events as rare .",
    "in fact , these events are very well described by a poissonian variate with an amplitude of probability corresponding to the number of photons detected per unit time .",
    "then , we obtain a poissonian random variate with the given amplitude and thus create an event series with the same statistical properties as the `` real '' ones .",
    "this helps us compare the results in our monte carlo simulation with the observational properties of qpos from real observations .",
    "the movements observed in 3d simulations produce a modulation in the lightcurve emitted by the star .",
    "let us assume that this modulation is purely sinusoidal , but of fixed duration , and thus the product of a sinusoid and a rectangular window function .",
    "it can be shown that the fourier transform of such a sinusoidal wavetrain whose duration is @xmath80 is a broad peak for which @xmath81 , where @xmath8 is the width of the peak .",
    "hence , if we say that @xmath80 is @xmath82 times the period @xmath83 of the impulses , then the quality factor is : @xmath84 thus , eq .",
    "eq : q effectively says that the @xmath85 factor of a broad peak in the power spectrum produced by short wavetrains gives us an estimate on the duration of the wavetrains themselves . in nature ,",
    "the @xmath85 factor of khz qpos is such that , if the model we propose is correct , the spot movements should last for hundreds of rotations in some cases . in our 3d simulations",
    "the hot spots rotate with a stable frequency for a much shorter time , but we must consider that the whole simulations only lasts tens of rotations , due to numerical problems that do not permit to maintain stable disk conditions . in nature the disk conditions are , in all probability , much stabler .      in this section",
    "we show in more detail the parameters of our model and the procedure to produce the simulated lightcurve .      to generate the random variates we used the very well tested functions of the gnu scientific library v.1.10 @xcite .",
    "as random number generator , we chose the _",
    "luxury random number _ algorithm of lscher ( ranlxd2 ) , characterized by a period of about @xmath86 , as implemented in the library itself .",
    "every moving spot is represented by a wavetrain described by the following parameters :    * * spot frequency * @xmath87 , corresponding to the angular velocity of the spot in the observer frame of reference ; its value can be constant or vary in a given range ; * * duration * @xmath88 , whose values can assume a range of values between @xmath89 and @xmath90 ; * * background * @xmath91 , the amplitude ( in @xmath92 ) , constant , of the simulated lightcurve ; * * oscillation amplitude * @xmath93 , constant for a given wavetrain , but varying between different wavetrains from @xmath94 to @xmath95 .",
    "its value is expressed as a pulsed fraction of the background .",
    "it can also be further modulated as exponentially decreasing or gaussian shaped during a given wavetrain ; * * next spot appearance time * @xmath96 , corresponding to the time between the appearance of two consecutive spots , again varying between @xmath97 to @xmath98 ; * * phase * @xmath65 , which can assume any value between @xmath99 and @xmath71 .",
    "furthermore , we can also choose the * frequency of the star * @xmath73 , used to produce the fixed spot emission and also as a unit of time to be consistent with the units used in 3d simulations , and the * background level * @xmath91 , constant during the whole simulation .",
    "and several different behaviors of the intensity of the hot spot , with its modulation at the frequency of the spots @xmath87.,width=288 ]    we first produce the continuous lightcurve by taking the following steps :    1 .",
    "we choose a frequency @xmath100 , a sampling time @xmath83 and a total length @xmath45 of the lightcurve ; 2 .",
    "we choose a pulse shape @xmath101 ( by default sinusoidal ) and a window function @xmath102 ( typically flat , gaussian or exponentially decaying as in fig .",
    "fig : trainshapes ) giving the overall intensity variation of the wavetrains .",
    "it is of particular importance to also choose if we want a constant average intensity of the source ( and so @xmath103 ) or if we want the spots to create an additional luminosity ( `` burst - like '' ) ; 3 .",
    "[ item : generate ] we generate a random value ( distributed according to a uniform or gaussian variate ) for @xmath93 and @xmath88 ; 4 .",
    "we generate a random value ( distributed according to a uniform , gaussian or exponential decay - like variate ) for @xmath96 ; 5 .",
    "we produce a random value for @xmath65 ; 6 .",
    "we generate a wavetrain of duration @xmath88 from @xmath96 , according to the formula : @xmath104 7 .",
    "we go back to  [ item : generate ] if @xmath105 8 .   to the lightcurve obtained , we add a constant background and a continuous sinusoidal modulation with frequency @xmath73 .    at this point",
    ", we have the complete simulated lightcurve as it would be seen by an optical telescope .",
    "we only need the following few steps to obtain a series of events as in real x - ray observations :    1 .   for every @xmath106",
    "we produce a random integer number @xmath107 , distributed according to a poissonian variate with amplitude @xmath108 , corresponding to the expected number of events in the time @xmath83 ; 2 .",
    "we write in the output file the number of events @xmath107 `` recorded '' at the time @xmath106 .",
    "fourier transform is the main technique used to find periodicities in time series .",
    "the fourier transform , in fact , gives a representation of the input function in term of its harmonic content .",
    "with fourier transforms it is possible to find periodicities in a time series even if the amplitude of the periodic component is very small .",
    "we performed a fast fourier transform on the data by means of the fftw3 library @xcite , and obtained the power spectrum according to the formula @xmath109 where @xmath82 and @xmath110 are the real and imaginary parts , respectively , of the fourier transform of the time series , and @xmath111 is the total number of simulated events .",
    "this is the standard normalization proposed by @xcite , which is particularly useful in the case of poissonian events .",
    "in fact , using this normalization the power spectrum of a constant background follows a @xmath112 distribution with @xmath113 degrees of freedom , where @xmath114 is the total number of bins in the spectrum . in this way we have a very solid statistical framework to help us",
    "interpret our results .    in order to improve the signal to noise ratio",
    ", we performed the fft on m consecutive chunks of data and obtained a single fft from the average of the chunks . with the chosen normalization",
    ", the background has an average of 2 and a standard deviation of @xmath115 @xcite .      the case in fig .",
    "fig : spectrum is corresponding to a spin period @xmath116ms and a hot spot period @xmath117ms ; we used a duration of the spot motion of @xmath118ms and @xmath119ms .",
    "the pulsed fraction of the moving spots was @xmath120 , while that of the fixed spot was @xmath121 .",
    "we can see the qpo peak at @xmath122 and the sharp peak at the frequency of the star .    on the right hand side of the same figure ,",
    "the qpo peak is fitted and some details are provided : as one can see , the peak is well fitted by a gaussian with @xmath123 .",
    "@xmath124{img / diskper0_67_life16_67_16_67_ampl0_2_0_2_next33_33_33_33_len10000_plot_fourier - simulspots_disk0_002_spin0_003_16384_dat.jpg }   \\includegraphics[width=3in]{img / diskper0_67_life16_67_16_67_ampl0_2_0_2_next33_33_33_33_len10000_plotzoom_fourier - simulspots_disk0_002_spin0_003_16384_dat.jpg } \\end{array}$ ]",
    "in  sec:3d and  [ sec : mc ] we showed that movements of the hot spots can produce qpos . in this section",
    "we show that those movements are not a fortuitous event , but in fact they present a predictable behavior . to show this",
    ", we study the change on the angular velocity of the hot spots as the mass accretion rate changes , performing a number of new simulations with different values of @xmath29 using eq .",
    "eq : mdot to find the corresponding values of @xmath44 .",
    "we then represent the frequencies observed from the spot - omega diagrams against the corresponding values of @xmath29 and @xmath44 in plots like those in figs  [ fig : mdot15 ] and [ fig : mdot18 ] . to be complete , we include in the study all the frequencies visible in the spot - omega diagrams for all cases .",
    "we do not perform any choices on the frequencies to plot .",
    "multiple frequencies appear in some cases simultaneously , in others at different times .",
    "the size of the bullets in the plots is proportional to the time the plotted features appear at during the runs . in this way is possible to see whether multiple features appear together or not .",
    "@xmath124{img / c1_5-a0_03-theta-2_mdot_c1_5.jpg } &   \\includegraphics[width=3in]{img / c1_5-a0_03-theta-2_mu_c1_5.jpg}\\\\ \\end{array}$ ]    @xmath124{img / c1_8-a0_02-theta-2_mdot_c1_8.jpg } &   \\includegraphics[width=3in]{img / c1_8-a0_02-theta-2_mu_c1_8.jpg}\\\\   \\includegraphics[width=3in]{img / c1_8-a0_03-theta-2_mdot_c1_8.jpg } &   \\includegraphics[width=3in]{img / c1_8-a0_03-theta-2_mu_c1_8.jpg } \\\\",
    "\\includegraphics[width=3in]{img / mdot_c1_8.jpg } &   \\includegraphics[width=3in]{img / mu_c1_8.jpg } \\end{array}$ ]     ( @xmath125=5.4ms ) , @xmath126 , @xmath127 . in this case is possible to notice the coexistence of two motions of the hot spots , with two different scales of velocity.,width=288 ]    in figs .",
    "[ fig : mdot15 ] and  [ fig : mdot18 ] the @xmath128s obtained from the spot - omega diagrams are plotted against the mass accretion rate and the dimensionless parameter @xmath29 ( which determines the size of the magnetosphere ) for several cases .",
    "as previously said , we choose to model a neutron star with @xmath129 g , @xmath51 km , @xmath52 . according to eq .",
    "eq : mdot we can use @xmath29 to change @xmath50 , investigating the variation of @xmath128 with respect to the measured value of @xmath44 .    the case in fig .",
    "fig : mdot15 describes an ns with @xmath75ms .",
    "this is a case of almost stable accretion , except for high values of the accretion rate .",
    "as the accretion rate grows , the magnetosphere becomes smaller and smaller , and the hot spots move around the magnetic pole with an increasing frequency , as expected .",
    "when @xmath44 reaches higher values the accretion is not stable anymore , and multiple hot spots appear , originating the multiple frequencies observed in fig .",
    "fig : mdot15 . in this case",
    "all the simulations were short compared to the ones in the next paragraph because of the appearance of numerical instabilities , and so all frequencies are observed at an early time .    the case in fig .",
    "fig : mdot18 describes unstable behavior , like we can see in fig .",
    "fig : sf - unstab - join . in this case",
    "we can observe a peculiar behavior : the hot spots in the ring around the magnetic pole and the ones produced by instabilities move with different angular velocities .",
    "this movement is visible also from the spot - omega diagram in fig .",
    "fig : doubleso .",
    "this produces two traces in the spot - omega diagram , whose frequencies present the same approximate behavior , as @xmath44 changes , as the ones seen in the first case .",
    "the frequency separation of the two peaks is in the correct range of values ( @xmath130hz ) to suggest that the twin khz qpo peaks often observed in nature could be originated in a similar way .",
    "a confirmation of this idea can be the fact that the upper khz qpo is usually much less coherent than the lower one ( @xcite ; @xcite investigate this particular aspect for a wide sample of lmxbs ) . in our simulations ,",
    "the `` upper '' peak is produced by instabilities while the `` lower '' one is produced by the motion around the magnetic pole .",
    "normally , unstable accretion is characterized by a much smaller coherence than the stable drift around the magnetic pole , except in the strongly unstable regime in which the two antipodal tongues maintain a constant angular velocity for a relatively long time @xcite .",
    "both frequencies relate to the zone near the inner disk .",
    "the instabilities form at the edge of the disk , and hotspots produced by them have higher frequencies than those of the hotspots in the polar region , which are produced by matter captured by the field lines at a slightly larger distance ( see fig .",
    "fig : xz - e - join , fig .",
    "fig : sf - unstab - join ) .",
    "the two frequencies move together as @xmath44 changes because both of them depend on the distance of the disk from the star .",
    "we developed a model of quasi - periodic oscillations based on the spot movements on the surface of the accreting neutron star with a slightly misaligned dipole magnetic field .",
    "3d mhd simulations have shown that spots may rotate faster / slower than the star in cases of stable or unstable accretion ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and in the magnetic boundary layer regime @xcite .",
    "we have shown that in all above cases , the spot movements develop ordered oscillations in the light - curves .",
    "modeling these oscillations as short - lived sinusoidal trains , we showed that if they are powerful enough to be seen , their fingerprint is a qpo .",
    "given the range of values of the frequencies involved , we hypothesize that khz qpos could be produced in this way .",
    "there are several features of qpos that can give confirmation to this model .",
    "first of all , the general trend with the mass accretion rate , as shown in  sec : mdot , is as it is expected .",
    "though it is not generally true that luminosity and mass accretion rate are proportional to each other , we can assume it to be true on a given source and for a short timescale .",
    "this is the case of the simulations in this paper , where only one parameter ( the mass accretion rate ) changed between the various simulations .",
    "the rms amplitude of real life qpos has a strong dependence on energy @xcite , suggesting that the mechanism of emission is different from that of the background . in our opinion , this is because the qpos are produced on the surface , or perhaps just above the surface by means of shocks in the accretion column similarly to what happens in amxps ( see for example * ? ? ?",
    "* ) , while most of the background is produced by the disk .",
    "the rms amplitude is also generally higher in atoll sources ( up to 20% ) than in z sources ( 2 - 5% ) @xcite .",
    "the reason for this difference is probably related to the higher accretion rate of z sources .    in some cases 3d simulations show that two frequencies appear at the same time .",
    "this numerical discovery is important for possible interpretation of two qpo peaks observed in a number of lmxbs .",
    "in fact , this mechanism for the production of multiple qpos is able to explain more than the mere appearance of two peaks in the power spectrum .",
    "when double qpos appear in observations , they normally present different behavior as regards their @xmath85 factor @xcite , and hence ( according to our assumption ) their coherence time with the upper peak generally less coherent ; in our model , this is due to the fact that the lower one comes from a smooth motion around the magnetic pole , while the upper one is produced by instability tongues , shorter - lasting and thus with a lower coherence .",
    "the term `` unstable '' should not mislead the reader though : the unstable regime is very common in simulations , expecially for fast rotators , also at small values of the mass accretion rate , as shown in fig .",
    "fig : mdot18 . a higher coherence of the upper khz qpo , in our model , could in principle be produced by a very high accretion rate and the onset of the magnetic boundary layer regime , in which instabilities produce long - lasting opposite tongues in the equatorial plane . during this regime",
    "though , it is very probable that the zone around the surface of the neutron star is optically thick .",
    "just as observations show , multiple qpos can appear simultaneously or at different times .",
    "as regards the models predicting the upper limit of @xmath2 as the keplerian frequency at the isco @xcite , it would be interesting to investigate the matter further .",
    "for the values of mass , magnetic field and radius used in the present job , the isco is never reached by the inner disk during qpo production with the two channels described because of the onset of the magnetic boundary layer regime . further investigation should include the use of more extreme values of the mass in order to study the behavior of the inner disk when the isco is considerably far from the surface .    another interesting point is the @xmath131 correlation observed in many papers ( for example * ? ? ? * ; * ? ? ? * ) .",
    "the correlation only holds for a given source and on time scales shorter than a few hours .",
    "the main reason why it does not hold across sources can easily be found in the magnetic field : for a given value of the mass accretion rate , different values of the magnetic field correspond to a different size of the magnetosphere and , as a consequence , to different values of the frequency of the moving spots .",
    "again , this is evident from our simulations : the exact same frequency in figure [ fig : mdot15 ] is obtained for @xmath132 in a system with @xmath54 g and for @xmath133 in a system with @xmath55 g . but the simulations presented here show only one of the many possible configurations of the disk around the star . for a given source , it is possible that changes in the structure ( density distribution for example ) of the disk produce a different behavior of the moving hot spots , even with the same mass accretion rate . besides , the relationship between luminosity and mass accretion rate is not clear .",
    "this point will be investigated more deeply in future papers , by simulating systems similar to the one shown here but with different initial disk conditions .",
    "the results presented here are based on simulations of neutron stars with very small misalignment angles .",
    "an equivalent discussion can be made at slightly larger misalignment angles , where the behavior of the spots does not change considerably ( see fig .",
    "fig : spotvsmis , but also @xcite ) , and obtain almost the same features in the power spectrum . in this case",
    "though , from simple geometrical considerations it is reasonable to expect some kind of modulation at the frequency of the star .",
    "the least we can expect is a broad lorentzian - like feature at the frequency of the star @xcite just from the action of the rotating spot in the polar region , due to the rotation of the star .",
    "its quality factor @xmath85 would be comparable to that of the moving hotspots ( @xmath134 , according to the considerations of  sec : q ) .",
    "the observation of such a feature , even very dim , in observations where the lower khz qpo ( the one from the funnel flow in this model ) is present , would give interesting evidence in favor of this model .",
    "as a final remark , we notice that the difference between the frequencies of the two qpos is @xmath135hz , close to the frequency of the star .",
    "it is generally known that for relatively slow rotators the frequency difference of qpos is similar to the frequency of the star . until about two years ago",
    ", it seemed that the @xmath6 was approximately equal to @xmath5 for slow rotators and @xmath7 for fast rotators .",
    "@xcite , analyzing the matter in detail , find that this distinction is not so clear , and that data can be interpreted and fitted equally well by values of @xmath6 around @xmath136hz for all sources , with the caveat @xcite of a few amxps showing all variability components ( and thus also @xmath6 ) shifted down by a factor of @xmath137 .",
    "the range of values of @xmath6 found in this work are compatible with both hypotheses , because the simulated system is a slow rotator and @xmath6 is both near the frequency of the star and @xmath136hz .",
    "we are planning to investigate the matter with simulations of faster rotators .",
    "nevertheless , this mechanism for the production of double qpos does not need the two frequencies to be origined from one another , giving a fixed value of @xmath138 , which was the main caveat of a somewhat similar model , the sonic point beat frequency model by @xcite .    from what we observe in this work ,",
    "the two qpos are two separate effects of the interaction between the rotating magnetosphere and the disk .",
    "the funnel flow comes from a zone just behind the inner radius where the magnetic field is strong enough to capture matter and make it drift towards the pole .",
    "the instabilities form right at the inner radius , where magnetic field energy density and ram pressure are equal ( the green line in fig .",
    "fig : sf - stab - join ) .",
    "the results of this paper can give insight into the matter : the frequencies found in observations are a probe of the interaction between the magnetic field and the disk .",
    "mb , lb and td were supported by the contract asi - inaf i/088/06/0 for high energy astrophysics .",
    "mb was also supported by a grant from infn .",
    "mmr and ak were supported in part by nasa grant nnx08ah25 g and by nsf grant ast-0807129 .",
    "the simulations described in this paper have been perfermed using the nasa s columbia and pleiades , and cineca s bcx , supercomputers , the latter under the 2008/2010 inaf / cineca agreement .",
    "mb thanks the cornell plasma astrophysics group for the exquisite hospitality they offered and for the use of the 3d code .",
    "in fig .  fig : spotvsmis we can compare the behavior of the hot spots at different misalignment angles .",
    "as can be seen in the picture , the spot movement is not limited to the case with very small misalignment angles , being present even for @xmath139 .",
    "berger m. , van  der klis m. , van paradijis j. , lewin w. h.  g. , lamb f.  k. , vaughan b. , kuulkers e. , augusteijn t. , zhang w. , marshall f.  e. , swank j.  h. , lapidus i. , lochner j.  c. , strohmayer t.  e. , 1996 , apjl v.469 , 469 , l13                            kulikovskii a.  g. , pogorelov n.  v. , semenov a.  y. , 2001 , mathematical aspects of numerical solution of hyperbolic systems .",
    "118 of chapman & hall / crc monographs and surveys in pure and applied mathematics , chapman & hall / crc , boca raton , fl"
  ],
  "abstract_text": [
    "<S> we present recent results of 3d magnetohydrodynamic simulations of neutron stars with small misalignment angles , as regards the features in lightcurves produced by regular movements of the hot spots during accretion onto the star . </S>",
    "<S> in particular , we show that the variation of position of the hot spot created by the infalling matter , as observed in 3d simulations , can produce high frequency quasi periodic oscillations with frequencies associated with the inner zone of the disk . </S>",
    "<S> previously reported simulations showed that the usual assumption of a fixed hot spot near the polar region is valid only for misalignment angles @xmath0 relatively large . </S>",
    "<S> otherwise , two phenomena challenge the assumption : one is the presence of rayleigh - taylor instabilities at the disk - magnetospheric boundary , which produce tongues of accreting matter that can reach the star almost anywhere between the equator and the polar region ; the other one is the motion of the hot spot around the magnetic pole during stable accretion . in this paper </S>",
    "<S> we start by showing that both phenomena are capable of producing short - term oscillations in the lightcurves . </S>",
    "<S> we then use monte carlo techniques to produce model lightcurves based on the features of the movements observed , and we show that the main features of khz qpos can be reproduced . finally , we show the behavior of the frequencies of the moving spots as the mass accretion rate changes , and propose a mechanism for the production of double qpo peaks .    accretion , accretion discs ; instabilities ; mhd ; stars : neutron ; stars : oscillations ; stars : magnetic fields </S>"
  ]
}