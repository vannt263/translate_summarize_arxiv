{
  "article_text": [
    "our focus in this paper is on easy special cases of otherwise difficult to evaluate polynomials , and their connection to various classes of arithmetic circuits .",
    "in particular we consider the permanent and hamiltonian polynomials for matrices of bounded treewidth , and sum of weights of perfect matchings for planar graphs .",
    "it is a widely believed conjecture that the permanent is hard to evaluate .",
    "indeed , in valiant s framework  @xcite the permanent is complete for the class .",
    "this is an algebraic analogue of his @xmath4-completeness result for the permanent  @xcite . for a book - length treatment of valiant s algebraic complexity theory one may consult  @xcite .",
    "the same results ( @xmath4-completeness in the boolean framework , and -completeness in the algebraic framework ) also apply to the hamiltonian polynomial .",
    "the sum of weights of perfect matchings in an ( undirected ) graph @xmath5 is yet another example of a presumably hard to compute polynomial since it reduces to the permanent when @xmath5 is bipartite .",
    "however , all three polynomials are known to be easy to evaluate in special cases . in particular , the permanent and hamiltonian polynomials can be evaluated in a polynomial number of arithmetic operations for matrices of bounded treewidth  @xcite .",
    "an earlier result of this flavour is kasteleyn s theorem @xcite which states that the sum of weights of perfect matchings of a planar graph can be computed in a polynomial number of arithmetic operations .",
    "one can try to turn these three efficient algorithms into general - purpose evaluation algorithms by means of reductions ( this is the approach followed by valiant in  @xcite , where he exhibits polynomial time algorithms for several problems which previously only had exponential time algorithms , by means of holographic reductions to perfect matchings of planar graphs ) . for instance , in order to evaluate a polynomial @xmath6 one can try to construct a matrix of bounded treewidth @xmath7 such that :    * the entries of @xmath7 are variables of @xmath6 , or constants . *",
    "the permanent of @xmath7 is equal to @xmath6 .",
    "the same approach can be tried for the hamiltonian and the sum of weights of perfect matchings in a planar graph .",
    "the goal of this paper is to assess the power of these polynomial evaluation methods .",
    "it turns out that the three methods are all universal - that is , every polynomial can be expressed as the sum of weights of perfect matchings in a planar graph , and as a permanent and hamiltonian of matrices of bounded treewidth .",
    "> from a complexity - theoretic point of view , these methods are no longer equivalent .",
    "our main findings are that :    * the permanents and hamiltonians of matrices of polynomial size and bounded treewidth have the same expressive power , namely , the power of polynomial size arithmetic formulas .",
    "this is established in theorem  [ treewidthchar ] . *",
    "the sum of weights of perfect matchings in polynomial size planar graphs has at least the same power as the above two representations , and in fact it is more powerful under a widely believed conjecture .",
    "indeed , this representation has the same power as polynomial size ( weakly ) skew arithmetic circuits .",
    "this is established in theorem  [ planarchar ] .",
    "we recall that ( weakly ) skew arithmetic circuits capture the complexity of computing the determinant  @xcite .",
    "it is widely believed that the determinant can not be expressed by polynomial size arithmetic formulas .",
    "our three methods therefore capture ( presumably proper ) subsets of the class  of easy to compute polynomial families .",
    "by contrast , if we drop the bounded treewidth or planarity assumptions , the class  is captured in all three cases .",
    "various notions of graph `` width '' have been defined in the litterature besides treewidth ( there is for instance pathwidth , cliquewidth , rankwidth ... ) .",
    "they should be worth studying from the point of view of their expressive power .",
    "also , barvinok  @xcite has shown that if the underlying matrix has bounded rank , both the permanent and the hamiltonian polynomials can be evaluated in a polynomial number of arithmetic operations . a proper study of the expressive power of permanents and hamiltonians of bounded rank along the same line as in this paper remains to be done .",
    "an arithmetic circuit is a finite , acyclic , directed graph .",
    "vertices have indegree 0 or 2 , where those with indegree 0 are referred to as _ inputs_.",
    "a single vertex must have outdegree 0 , and is referred to as _ output_. each vertex of indegree 2 must be labeled by either @xmath8 or @xmath9 , thus representing computation .",
    "vertices are commonly referred to as _ gates _ and edges as",
    "_ arrows_.    by interpreting the input gates either as constants or variables",
    "it is easy to prove by induction that each arithmetic circuit naturally represents a polynomial .    in this paper various subclasses of arithmetic circuits",
    "will be considered : for _ weakly skew _ circuits we have the restriction that for every multiplication gate , at least one of the incoming arrows is from a subcircuit whose only connection to the rest of the circuit is through this incoming arrow . for _ skew _ circuits",
    "we have the restriction that for every multiplication gate , at least one of incoming arrows is from an input gate . for _ formulas _ all gates ( except output )",
    "have outdegree 1 .",
    "thus , reuse of partial results is not allowed .    for a detailed description of various subclasses of arithmetic circuits , along with examples ,",
    "we refer to @xcite .",
    "the _ size _ of a circuit is the total number of _ gates _ in the circuit .",
    "the _ depth _ of a circuit is the length of the longest path from an input gate to the output gate .",
    "a family @xmath10 belongs to the complexity class  if @xmath11 can be computed by a circuit @xmath12 of size polynomial in @xmath13 , and if moreover the degree of @xmath11 is bounded by a polynomial function of  @xmath13 .",
    "treewidth for undirected graphs is most commonly defined as follows :    let @xmath14 be a graph .",
    "a @xmath15-tree - decomposition of @xmath5 is :    * a tree @xmath16 .",
    "* for each @xmath17 a subset @xmath18 of size at most @xmath19 .",
    "* for each edge @xmath20 there is a @xmath17 such that @xmath21 .",
    "* for each vertex @xmath22 the set @xmath23 forms a ( connected ) subtree of @xmath24 .",
    "the treewidth of @xmath5 is then the smallest @xmath15 such that there exists a @xmath15-tree - decomposition for @xmath5 .",
    "there is an equivalent definition of treewidth in terms of certain graph grammars called hr algebras  @xcite :    a graph @xmath5 has a @xmath15-tree - decomposition iff there exist a set of source labels of cardinality @xmath25 such that @xmath5 can be constructed using a finite number of the following operations :    * @xmath26 , @xmath27 , @xmath28 ( basic constructs : create a single vertex with label @xmath29 , a single vertex with label @xmath29 and a looping edge , two vertices labeled @xmath29 and @xmath30 connected by an edge ) * @xmath31 ( rename all labels @xmath29 as labels @xmath30 and rename all labels @xmath30 as labels @xmath29 ) * @xmath32 ( forget all labels @xmath29 ) * @xmath33 ( composition of graphs : any two vertices with the same label are identified as a single vertex )    cycles are known to have treewidth 2 . here",
    "we show that they have treewidth at most 2 by constructing @xmath5 , a cycle of length @xmath34 , using @xmath35 as the set of source labels .",
    "first we construct @xmath36 by the operation @xmath28 .",
    "for @xmath37 we construct @xmath38 by operations @xmath39 .",
    "finally @xmath5 is then constructed by the operation @xmath40 .",
    "the treewidth of a directed graph is defined as the treewidth of the underlying undirected graph .",
    "the treewidth of an @xmath41 matrix @xmath42 is defined as the treewidth of the directed graph @xmath43 where @xmath44 , @xmath45 iff @xmath46 , and @xmath47 .",
    "notice that @xmath48 can have loops .",
    "loops do not affect the treewidth of @xmath48 but are important for the characterization of the permanent and hamiltonian polynomials .      in this paper",
    "we take a graph theoretic approach to deal with permanent and hamiltonian polynomials .",
    "the reason for this being that a natural way to define the treewidth of a matrix , is by the treewidth of the underlying graph , see also e.g. @xcite .",
    "a _ cycle cover _ of a directed graph is a subset of the edges , such that these edges form disjoint , directed cycles ( loops are allowed ) .",
    "furthermore , each vertex in the graph must be in one ( and only one ) of these cycles .",
    "the _ weight _ of a cycle cover is the _ product _ of weights of all participating edges .",
    "[ permdef ] the _ permanent _ of an @xmath41 matrix @xmath42 is the sum of weights of all cycle covers of @xmath48 .",
    "the permanent of @xmath49 can also be defined by the formula @xmath50 the equivalence with definition  [ permdef ] is clear since any permutation can be written down as a product of disjoint cycles , and this decomposition is unique .",
    "there is a natural way of representing polynomials by permanents . indeed ,",
    "if the entries of @xmath49 are variables or constants from some field @xmath51 , @xmath52 is a polynomial with coefficients in @xmath51 ( in valiant s terminology , @xmath53 is a projection of the permanent polynomial ) . in the next section",
    "we study the power of this representation in the case where @xmath49 has bounded treewidth .",
    "the _ hamiltonian _ polynomial @xmath54 is defined similarly , except that we only sum over cycle covers consisting of a _ single _ cycle ( hence the name ) .",
    "in this section we work with directed graphs . all paths and cycles",
    "are assumed to be directed , even if this word is omitted .",
    "in @xcite it is shown that the permanent and hamiltonian polynomials are in @xmath0 for matrices of bounded treewidth . here",
    "we show that both the permanent and hamiltonian polynomials for matrices of bounded treewidth are equivalent to arithmetic formulas .",
    "this is an improvement on the result of  @xcite since the set of polynomial families representable by polynomial size arithmetic formulas is a ( probably strict ) subset of @xmath0 .",
    "[ treewidthchar ] let @xmath10 be a family of polynomials with coefficients in a field @xmath51 .",
    "the three following properties are equivalent :    * @xmath10 can be represented by a family of polynomial size arithmetic formulas . * there exists a family @xmath55 of polynomial size , bounded treewidth matrices such that the entries of @xmath56 are constants from @xmath51 or variables of @xmath11 , and @xmath57 .",
    "* there exists a family @xmath55 of polynomial size , bounded treewidth matrices such that the entries of @xmath56 are constants from @xmath51 or variables of @xmath11 , and @xmath58 .    by the @xmath1-completeness of the hamiltonian ,",
    "if we drop the bounded treewidth assumption on @xmath56 we capture exactly the @xmath1 families instead of the families represented by polynomial size arithmetic formulas .",
    "the same property holds true for the permanent if the characteristic of @xmath51 is different from 2 .",
    "theorem  [ treewidthchar ] follows immediately from theorems  [ formulatoperm ] , [ formulatoham ] , [ permtocircuit ] and  [ hamtocircuit ] .",
    "[ formulatoperm ] every arithmetic formula can be expressed as the permanent of a matrix of treewidth at most 2 and size at most @xmath59 where @xmath13 is the size of the formula .",
    "all entries in the matrix are either 0 , 1 , or variables of the formula .",
    "the first step is to construct a directed graph that is a special case of a _ series - parallel _ ( sp ) graph , in which there is a connection between weights of directed paths and the value computed by the formula .",
    "the overall idea behind the construction is quite standard , see e.g. @xcite .",
    "sp graphs in general can between any two adjacent vertices have multiple directed edges .",
    "but we construct an sp graph in which there is at most one directed edge from any vertex @xmath60 to any vertex @xmath61 .",
    "this property will be needed in the second step , in which a connection between cycle covers and the permanent of a given matrix will be established .",
    "sp graphs have distinguished _ source _ and _ sink _ vertices , denoted by @xmath62 and @xmath63 . by @xmath64",
    "we denote the sum of weights of all directed paths from @xmath62 to @xmath63 , where the weight of a path is the _ product _ of weights of participating edges .",
    "let @xmath65 be a formula of size @xmath66 .",
    "for the first step of the proof we will by induction over @xmath66 construct a weighted , directed sp graph @xmath5 such that @xmath67 . for the base case @xmath68",
    "we construct vertices @xmath62 and @xmath63 and connect them by a directed edge from @xmath62 to @xmath63 with weight @xmath69 .",
    "assume @xmath70 and let @xmath38 be the graph associated with @xmath71 by the induction hypothesis .",
    "introduce one new vertex @xmath62 and let @xmath5 be the union of the three graphs @xmath72 , @xmath36 and @xmath73 in which we identify @xmath74 with @xmath75 and denote it @xmath63 , add an edge of weight 1 from @xmath62 to @xmath76 , and add an edge of weight 1 from @xmath62 to @xmath77 . by induction hypothesis the resulting graph @xmath5 satisfies @xmath78 . between any two vertices @xmath60 and @xmath61 there is at most one directed edge from @xmath60 to @xmath61 .",
    "we introduced one new vertex , but since @xmath74 was identified with @xmath75 the number of vertices used equals @xmath79 .",
    "assume @xmath80 .",
    "we construct @xmath5 by making the disjoint union of @xmath36 and @xmath73 in which we identify @xmath74 with @xmath77 , identify @xmath76 as @xmath62 in @xmath5 and identify @xmath75 as @xmath63 in @xmath5 . for every directed path from @xmath76 to @xmath74 in @xmath36 and for every directed path from @xmath77 to @xmath75 in @xmath73",
    "we can find a directed path from @xmath62 to @xmath63 in @xmath5 of weight equal to the product of the weights of the paths in @xmath36 and @xmath73 , and since all @xmath81 paths in @xmath5 are of this type we get @xmath82 .",
    "the number of vertices used equals @xmath83 .    for the second step of the proof",
    "we need to construct a graph @xmath84 such that there is a relation between cycle covers in @xmath84 and directed paths from @xmath62 to @xmath63 in @xmath5 .",
    "we construct @xmath84 by adding an edge of weight 1 from @xmath63 back to @xmath62 , and loops of weight @xmath85 at all vertices different from @xmath62 and @xmath63 .",
    "now , for every @xmath81 path in @xmath5 we can find a cycle in @xmath84 visiting the corresponding nodes . for nodes in @xmath84 not in this cycle ,",
    "we include them in a cycle cover by the loops of weight 1 .",
    "because there is at most one directed edge from any vertex @xmath60 to any vertex @xmath61 in @xmath84 we can find a matrix @xmath49 of size at most @xmath59 such that @xmath86 and @xmath87 .",
    "the graph @xmath84 can be constructed using an hr algebra with only 3 source labels , and thus have treewidth at most 2 . for the base case",
    "the operation @xmath28 is sufficient . for the simulation of addition of formulas",
    "the following grammar operations provide the desired construction : @xmath88 . for simulating multiplication of formulas we use the following grammar operations : @xmath89 @xmath90 . finally , the last step in obtaining @xmath84 is to make a composition with the graph @xmath28 .",
    "[ formulatoham ] every arithmetic formula of size @xmath13 can be expressed as the hamiltonian of a matrix of treewidth at most 6 and size at most @xmath91 .",
    "all entries in the matrix are either 0 , 1 , or variables of the formula .",
    "the first step is to produce the graph @xmath5 as shown in theorem  [ formulatoperm ] .",
    "the next step is to show that the proof of universality for the hamiltonian polynomial in @xcite can be done with treewidth at most 6 .",
    "their construction for universality of the hamiltonian polynomial introduces @xmath92 new vertices to @xmath5 in order to produce @xmath84 , along with appropriate directed edges ( all of weight 1 ) .",
    "the proof is sketched in figure  [ hamuniversal ] .",
    "the additional vertices @xmath93 and edges permit to visit any subset of vertices of @xmath5 with a directed path of weight 1 from @xmath63 to @xmath62 using all @xmath93 s .",
    "hence , any path from @xmath62 to @xmath63 in @xmath5 can be followed by a path from @xmath63 to @xmath62 to obtain a hamiltonian cycle of same weight .",
    "if one just need to show universality , then it is not important exactly which one of the vertices @xmath93 that has an edge to a given vertex among @xmath94 .",
    "but in order to show bounded treewidth one carefully need to take into account which one of the vertices of @xmath93 that has an edge to a particular @xmath94 vertex .",
    "we show such a construction with bounded treewidth , by giving an hr algebra which can express a graph similar to the one in figure  [ hamuniversal ] using 7 source labels .",
    "series composition is done using the following operations ( also see figure  [ hamseries ] ) : @xmath95    labels @xmath96 and @xmath97 in figures  [ hamseries ] and  [ hamparallel ] plays the roles of @xmath98 and @xmath99 respectively in figure  [ hamuniversal ] .",
    "the above construction does not take into account , that @xmath36 and/or @xmath73 are graphs generated from the base case .",
    "for base cases vertices @xmath100 and @xmath97 are replaced by a single vertex . however , it is clear that the above construction can be modified to work for these simpler cases as well .        for parallel composition",
    "an additional vertex was introduced .",
    "it can be done using the following operations ( also see figure  [ hamparallel ] ) : @xmath101    the final step in the construction , after all series and parallel composition have been done , is to connect vertices @xmath29 and @xmath100 and connect vertices @xmath30 and @xmath97 .    the decision version of the hamiltonian cycle problem for graphs of bounded cliquewidth is shown to be polynomial time solvable in @xcite . though bounded treewidth implies bounded cliquewidth we are mainly interested in studying the evaluation version .",
    "evaluation of the hamiltonian and permanent polynomials was shown in @xcite to be in @xmath0 for matrices of bounded treewidth .",
    "they give efficients algorithms for a much broader class of problems , but the proof we give here is more direct and gives a more precise characterization .    by definition  [ permdef ] , computing the permanent of a matrix @xmath49 amounts to computing the sum of the weights of all cycle covers of @xmath48 . in our algorithm",
    "we need to consider partial covers , which are generalizations of cycle covers .",
    "a partial cover of a directed graph is a union of paths and cycles such that every vertex of the graph belongs to at most one path ( and to none of the cycles ) , or to at most one cycle ( and to none of the paths ) .",
    "the weight of a partial cover is the product of the weights of all participating edges .",
    "more generally , for any set @xmath102 of edges the weight @xmath103 of @xmath102 is defined as the product of the weights of the elements of @xmath102 .",
    "in contrast to cycle covers , for a partial cover there is no requirement that all vertices be covered .",
    "the following theorem from  @xcite is a standard tool in the design of parallel algorithms for graphs of bounded treewidth ( see also  @xcite and  @xcite ) .",
    "[ baltree ] let @xmath14 be a graph of treewidth k with n vertices .",
    "then there exists a tree - decomposition @xmath104 of g of width @xmath105 such that @xmath106 is a binary tree of depth at most @xmath107 .",
    "we also need the following standard lemma :    [ circuittoformula ] let @xmath65 be a circuit of depth @xmath97 .",
    "then there exists a formula of depth @xmath97 and size @xmath108 representing the same polynomial .",
    "we construct the formula from the circuit by duplicating entire subcircuits whenever we reuse a gate .",
    "the formula constructed in this way also has height @xmath97 . in the produced formula",
    "the number of gates having distance @xmath109 to the root is at most twice the number of gates having distance @xmath110 to the root , so the formula has at most @xmath111 gates .",
    "[ permtocircuit ] the permanent of a @xmath112 matrix @xmath49 of bounded treewidth @xmath15 can be expressed as a formula of size @xmath113 .",
    "we show how to construct a circuit of depth @xmath114 , which can then be expressed as a formula of size @xmath113 using lemma [ circuittoformula ] .",
    "consider the graph @xmath115 and apply theorem  [ baltree ] to obtain a balanced , binary tree - decomposition @xmath24 of bounded width @xmath116 . for each node @xmath63 of @xmath24 , we denote by @xmath117 the subtree of @xmath24 rooted at @xmath63 , and we denote by @xmath118 the set of vertices of @xmath5 which belong to @xmath119 for at least one of the nodes @xmath60 of @xmath117 .",
    "we denote by @xmath120 the subgraph of @xmath5 induced by the subset of vertices @xmath118 .",
    "consider a partial cover @xmath121 of @xmath120 .",
    "any given edge @xmath122 is either used or unused by @xmath121 .",
    "likewise , any given vertex of @xmath123 has indegree 0 or 1 in @xmath121 , and outdegree 0 or 1 .",
    "we denote by @xmath124 the list of all these data for every edge @xmath122 and every element of @xmath123 . by abuse of language",
    ", we will say that an edge in @xmath125 is used by @xmath126 if it is used by one partial cover satisfying @xmath127 ( or equivalently , by all partial cover satisfying @xmath127 ) .",
    "we will compute for each possible list @xmath126 a weight @xmath128 , defined as the sum of the weights of all partial covers @xmath121 of @xmath120 satisfying the following three properties :    * the two endpoints of all paths of @xmath121 belong to @xmath123 ; * all uncovered vertices belong to @xmath123 ; * @xmath127 .",
    "note that the number of weights to be computed at each node of @xmath24 is bounded by a constant ( which depends on @xmath116 ) .",
    "when @xmath63 is the root of @xmath24 we can easily compute the permanent of @xmath49 from the weights @xmath128 : it is equal to the sums of the @xmath128 over all @xmath126 which assign indegree 1 and outdegree 1 to all vertices of @xmath123 . also , when @xmath63 is a leaf of @xmath24 we can compute the weights in a constant number of arithmetic operations since @xmath120 has at most @xmath116 vertices in this case .",
    "it therefore remains to explain how to compute the weights @xmath128 when @xmath63 is not a leaf .",
    "our algorithm for this proceeds in a bottom - up manner : we will compute the weights for @xmath63 from the weights already computed for its left child ( denoted @xmath129 ) and its right child ( denoted @xmath130 ) .",
    "the idea is that we can obtain a partial cover of @xmath120 by taking the union of a partial cover of @xmath131 and of a partial cover of @xmath132 , and adding some additional edges .",
    "conversely , a partial cover of @xmath120 induces a partial cover of @xmath131 and a partial cover of @xmath132 . in order to avoid counting many times the same partial cover",
    ", we must define the considered partial covers of @xmath131 and @xmath132 to ensure that the partial cover of @xmath120 induces a unique partial cover of @xmath131 and a unique partial cover of @xmath132 .",
    "we will say that @xmath133 is compatible with @xmath126 if and only if the following holds :    * no edge in @xmath125 is used in @xmath134 or @xmath135 ; * for every vertex @xmath136 at most one of @xmath137 assigns indegree 1 to @xmath138 ; * for every vertex @xmath136 at most one of @xmath137 assigns outdegree 1 to @xmath138 ; * every vertex @xmath139 has indegree 1 and outdegree 1 in @xmath134 ; * every vertex @xmath140 has indegree 1 and outdegree 1 in @xmath135 .",
    "we now have to prove two things . if there is a partial cover @xmath121 of @xmath120 which satisfies the properties ( i ) and ( ii ) such that @xmath127 then it induces a partial cover @xmath141 of @xmath131 and a partial cover @xmath142 of @xmath132 such that @xmath141 and @xmath142 satisfy ( i ) and ( ii ) , @xmath143 , @xmath144 , and @xmath133 is compatible with @xmath126 .",
    "conversely , if @xmath133 is compatible with @xmath126 , and @xmath141 and @xmath142 are partial covers of @xmath131 and @xmath132 satisfying ( i ) , ( ii ) , @xmath143 , and @xmath144 , then there exists a unique partial cover @xmath121 of @xmath120 containing @xmath141 and @xmath142 such that @xmath127 .",
    "consider a partial cover @xmath121 of @xmath120 which satisfies the properties ( i ) and ( ii ) defined above .",
    "we can assign to @xmath121 a unique triple @xmath145 defined as follows .",
    "first , we define @xmath102 as the set of edges of @xmath146 .",
    "then we define @xmath141 as the set of edges of @xmath121 which have their two endpoints in @xmath147 , and at least one of them outside of @xmath123 .",
    "finally , we define @xmath142 as the set of edges of @xmath121 which have their two endpoints in @xmath148 , and at least one of them outside of @xmath123 .",
    "note that @xmath149 since @xmath145 forms a partition of the edges of @xmath121 .",
    "moreover , @xmath141 is a partial cover of @xmath131 and properties ( i ) and ( ii ) are satisfied : the endpoints of the paths of @xmath141 and the uncovered vertices of @xmath147 all belong to @xmath150 .",
    "likewise , @xmath142 is a partial cover of @xmath148 and properties ( i ) and ( ii ) are satisfied . if @xmath143 and @xmath144 , it is clear that @xmath133 is compatible with @xmath126 .",
    "any other partition of @xmath121 in three parts with one partial cover of @xmath131 , one partial cover of @xmath132 , and a subset of edges in @xmath125 would have an edge of @xmath125 used by @xmath141 or @xmath142 .",
    "hence @xmath133 would not be compatible with @xmath126 .",
    "suppose now @xmath133 is compatible with @xmath126 , and @xmath141 and @xmath142 are partial covers of @xmath131 and @xmath132 satisfying ( i ) , ( ii ) , @xmath143 , and @xmath144 .",
    "we define @xmath151 as the set of edges of @xmath125 which are used by @xmath126 .",
    "it is clear that @xmath151 , @xmath141 and @xmath142 are disjoint .",
    "consider @xmath152 .",
    "since @xmath133 is compatible with @xmath126 , @xmath121 is a partial cover satisfying ( i ) and ( ii ) .",
    "it is also clear that @xmath121 is the only partial cover containing @xmath141 and @xmath142 such that @xmath127 .",
    "these considerations lead to the formula @xmath153 the sum runs over all pairs @xmath133 that are compatible with @xmath126 .",
    "the weight @xmath154 can therefore be computed in a constant number of arithmetic operations .",
    "since the height of @xmath24 is @xmath114 the above algorithm can be executed on a circuit of height @xmath114 as well .",
    "[ hamtocircuit ] the hamiltonian of a @xmath112 matrix @xmath49 of bounded treewidth @xmath15 can be expressed as a formula of size @xmath113 .",
    "the proof is very similar to that of theorem  [ permtocircuit ] .",
    "the only difference is that we only consider partial cycle covers consisting exclusively of paths , and at the root of @xmath24 the partial cycle covers of the two children must be combined into a hamiltonian cycle .",
    "in this section we work with undirected graphs .",
    "a _ perfect matching _ of a graph @xmath14 is a subset @xmath155 of @xmath156 such that every vertex in @xmath157 is incident to _",
    "exactly one _ edge in @xmath155 .",
    "the _ weight _ of a perfect matching @xmath155 is the product of weights of all edges in @xmath155 . by @xmath158",
    "we denote the sum of weights of all perfect matchings of @xmath5 .    in 1967",
    "kasteleyn showed in @xcite that @xmath158 can be computed efficiently if @xmath5 is planar .",
    "his observations was that for planar graphs @xmath158 could be expressed as a special kind of pfaffian . for general non - planar graphs",
    "computing @xmath158 is @xmath1-complete ( or @xmath4-complete in the boolean model of computation ) .",
    "this follows from the fact that for a bipartite graph @xmath159 , @xmath158 is equal to the permanent of its `` bipartite adjacency matrix '' @xmath49 ( if @xmath160 , @xmath49 is a @xmath112 matrix and @xmath161 is equal to the weight of the edge between @xmath162 and  @xmath163 ) .",
    "[ planarchar ] let @xmath10 be a family of polynomials with coefficients in a field @xmath51 .",
    "the three following properties are equivalent :    * @xmath10 can be computed by a family of polynomial size weakly skew circuits .",
    "* @xmath10 can be computed by a family of polynomial size skew circuits .",
    "* there exists a family @xmath164 of polynomial size planar graphs with edges weighted by constants from @xmath51 or variables of @xmath11 such that @xmath165 .",
    "the equivalence of ( i ) and ( ii ) is etablished in  @xcite and  @xcite .",
    "in @xcite the complexity class @xmath166 is defined as the class of polynomial families computed by polynomial size ( weakly ) skew circuits , and it is shown that the determinant is @xmath166-complete .",
    "we have therefore shown that computing @xmath158 for a planar graph @xmath5 is equivalent to computing the determinant .",
    "previously it was known that @xmath158 could be reduced to computing pfaffians  @xcite .",
    "the equivalence of ( iii ) with ( i ) and ( ii ) follows immediately from theorem  [ circuittospm ] and theorem  [ spmtocircuit ] .",
    "[ circuittospm ] the output of every skew circuit of size @xmath13 can be expressed as @xmath158 where @xmath5 is a weighted , planar , bipartite graph with @xmath167 vertices .",
    "the weight of each edge of @xmath5 is equal to 1 , to -1 , or to an input variable of the circuit .",
    "let @xmath65 be a skew circuit ; that is , for each multiplication gate _ at least _",
    "one of the inputs is an input gate of @xmath65 ( w.l.o.g .",
    "we assume it is _ exactly _ one ) .",
    "furthermore , by making at most a linear amount of duplication we can assume all input gates have outdegree 1 .",
    "thus , every input gate of @xmath65 is either input to exactly one addition gate or input to exactly one multiplication gate ( ignoring the trivial special case where @xmath65 only consist of a single gate ) , and throughout the proof we will distinguish between these two types of input gates .",
    "consider a drawing of @xmath65 in which all input gates which are input to an addition gate , are placed on a straight line , and all other gates are drawn on the same side of that line .",
    "assume all arrows in the circuit are drawn as straight lines .",
    "this implies at most a quadratic number of places where two arrows cross each other in the plane . by using the planar crossover widget from figure  [ planarcrossover ]",
    "we replace these crossings by planar subgraphs , introducing at most a quadratic amount of extra gates .",
    "for each multiplication gate we have that exactly one of the input gates is an input gate of @xmath65 , so these input gates can be placed arbitrarily close the the multiplication gate in which they are used .",
    "thus we obtain a _ planar _",
    "skew circuit @xmath168 computing the same value as @xmath65 .",
    "consider a topological ordering of the gates in @xmath168 in which input gates that are input to multiplication gates have numbers less than 1 , and input gates that are input to addition gates have the numbers 1 through @xmath169 ( where @xmath169 is the number of input gates that are input to addition gates ) .",
    "let @xmath170 be the number of the output gate in this topological ordering of @xmath168 .",
    "steps 1 through @xmath169 in the construction of @xmath5 are shown in figure  [ planarinit ] .",
    "edge weight @xmath171 denote the input at the gate with topological number @xmath169 in @xmath168 .        for each step @xmath172",
    "an addition or multiplication gate are handled as shown in figure  [ planariterate ] .",
    "white vertices indicate vertices that are already present in the graph , whereas black vertices indicate new vertices that are introduced during that step . for multiplications",
    "the edge weight @xmath69 denote the value of the input gate of @xmath168 , which is input to that multiplication gate .",
    "finally , the output gate of @xmath168 is handled in a special way .",
    "correctness can be shown by induction using the following observation .",
    "for each step @xmath173 in the construction of @xmath5 the following properties will hold for the graph generated so far : the labels @xmath174 have been assigned to @xmath175 distinct vertices . for all @xmath176 if the vertex with label @xmath177 is removed ( along with all adjacent edges ) , then @xmath178 of the remaining graph equals the value computed at gate with topological number @xmath109 in @xmath168 .",
    "it is clear that the graph produced during the initialization ( figure  [ planarinit ] ) has this property . for the remaining vertices in the topological",
    "ordering we either have to simulate an addition gate ( @xmath179 ) or a multiplication gate ( @xmath180 ) . for each new labeled vertex added in this way we can see that it simulates the corresponding gate correctly , without affecting the simulation done by other labeled vertices in the graph .",
    "bipartiteness of @xmath5 can be shown by putting the vertex labeled @xmath62 as well as vertices labeled @xmath181 , @xmath182 , on one side of the partition , and all other vertices on the other side of the partition .",
    "the theorem can be proven for _ weakly _ skew circuits as well without the result from @xcite stating that weakly skew circuits are equivalent to skew circuits . consider the graph @xmath183 .",
    "one can show that this graph has a single perfect matching of weight @xmath85 . for simulation of a multiplication gate , instead of adding a single edge of weight @xmath69 , one can add an entire subcircuit constructed in the above manner .",
    "[ spmtocircuit ] for any weighted , planar graph @xmath5 with @xmath13 vertices , @xmath158 can be expressed as the output of a skew circuit of size @xmath113 .",
    "inputs to the skew circuit are either constants or weights of the edges of @xmath5 .",
    "the result will be established by computation of pfaffians and is shown by combining results from @xcite and @xcite .",
    "let @xmath184 be a weighted graph and @xmath185 an oriented version of @xmath184 .",
    "then the pfaffian is defined as : @xmath186 where @xmath187 ranges over all perfect matchings of @xmath185 .",
    "the pfaffian depends on how the edges of @xmath185 are oriented , since the sign of a perfect matching depends on this orientation ( details on how the sign depends on the orientation are not needed for this proof ) .",
    "it is known from kasteleyn s work  @xcite that all planar graphs have a _ pfaffian orientation _ of the edges ( and that such an orientation can be found in polynomial time ) .",
    "a pfaffian orientation is an orientation of the edges such that each term in the above sum has positive sign @xmath188 .",
    "so for planar graphs computing @xmath158 reduces to computing pfaffians ( which can be done in polynomial time ) .",
    "a pfaffian orientation of @xmath5 does not depend on the weights of the edges , it only depends on the planar layout of @xmath5 . in our reduction to a skew circuit we can therefore assume that a pfaffian orientation @xmath189 is given along with @xmath5 , thus the problem of computing @xmath158 by a skew circuit is reduced to computing @xmath190 by a skew circuit .",
    "> from theorem 12 in @xcite we have that @xmath190 can be expressed as @xmath191 where @xmath84 is a weighted , acyclic , directed graph with distinguished source and sink vertices denoted @xmath62 and @xmath63 ( recall @xmath191 from theorem [ formulatoperm ] ) .",
    "the size of @xmath84 is polynomial in the size of @xmath189 .",
    "the last step is to reduce @xmath84 to a polynomial size skew circuit representing the same polynomial . consider a topological ordering of the vertices of @xmath84 .",
    "the vertex @xmath62 is replaced by an input gate with value 1 . for a vertex @xmath61 of indegree 1 ,",
    "assume @xmath60 is the vertex such that there is a directed edge from @xmath60 to @xmath61 in @xmath84 , and assume the weight of this edge is @xmath69 .",
    "we then replace @xmath61 by a multiplication gate , where one arrow leading to this gate comes from the subcircuit representing @xmath60 , and the other arrow leading to this gate comes from a new input gate with value @xmath69 .",
    "vertices of indegree @xmath192 are replaced by a series of @xmath193 addition gates , adding weights of all paths leading here , similar to what is done for vertices of indegree 1 .",
    "the circuit produced in this way clearly represent the same polynomial , and it is a skew circuit because for every multiplication gate at least one of the arrows leading to that gate comes from an input gate .",
    "this work was done while u.  flarup was visiting the ens lyon during the spring semester of 2007 .",
    "this visit was partially made possible by funding from ambassade de france in denmark , service de coopration et daction culturelle , ref.:39/2007-csu 8.2.1 .",
    "h. l. bodlaender .",
    "nc - algorithms for graphs with small treewidth . in _ proc .",
    "14th workshop graph - theoretic concepts in computer science wg88 , _",
    "p. 1 - 10 .",
    "springer verlag , lecture notes in computer science 344 ( 1989 ) .",
    "h. l. bodlaender and t. hagerup .",
    "parallel algorithms with optimal speedup for bounded treewidth . in z. fulop and f.",
    "gecseg , editors , _",
    "proceedings 22nd international colloquium on automata , languages and programming , _ pages 268 - 279 , berlin .",
    "springer - verlag , lecture notes in computer science 944 ( 1995 ) .",
    "a. k. mackworth and y. zhang .",
    "parallel and distributed finite constraint satisfaction . technical report 92 - 30 , department of computer science , university of british columbia , vancouver , b. c. canada ( 1992 ) .",
    "j. a. makowsky and k. meer .",
    "polynomials of bounded treewidth .",
    "foundations of computational mathematics , proceedings of the smalefest 2000 , felipe cucker and j. maurice rojas , edts . , world scientific 2002 , p. 211 - 250",
    "( 2002 ) .",
    "g. malod and n. portier .",
    "characterizing valiant s algebraic complexity classes .",
    "in mfcs 2006 , proceedings of the 31st international symposium on mathematical foundations of computer science , volume 4162 of lecture notes in computer science , p. 704 - 716",
    "springer verlag ( 2006 ) .",
    "l.  g. valiant .",
    "reducibility by algebraic projections . in _ logic and algorithmic ( an international symposium held in honour of ernst specker ) _ , pages 365380 .",
    "monographie @xmath194 30 de lenseignement mathmatique , 1982 ."
  ],
  "abstract_text": [
    "<S> valiant introduced some 25 years ago an algebraic model of computation along with the complexity classes @xmath0 and @xmath1 , which can be viewed as analogues of the classical classes @xmath2 and @xmath3 . </S>",
    "<S> they are defined using non - uniform sequences of arithmetic circuits and provides a framework to study the complexity for sequences of polynomials . </S>",
    "<S> prominent examples of difficult </S>",
    "<S> ( that is , @xmath1-complete ) problems in this model includes the permanent and hamiltonian polynomials .    </S>",
    "<S> while the permanent and hamiltonian polynomials in general are difficult to evaluate , there have been research on which special cases of these polynomials admits efficient evaluation . </S>",
    "<S> for instance , barvinok has shown that if the underlying matrix has bounded rank , both the permanent and the hamiltonian polynomials can be evaluated in polynomial time , and thus are in @xmath0 . </S>",
    "<S> courcelle , makowsky and rotics have shown that for matrices of bounded treewidth several difficult problems ( including evaluating the permanent and hamiltonian polynomials ) can be solved efficiently . </S>",
    "<S> an earlier result of this flavour is kasteleyn s theorem which states that the sum of weights of perfect matchings of a planar graph can be computed in polynomial time , and thus is in @xmath0 also . for general graphs </S>",
    "<S> this problem is @xmath1-complete .    in this paper </S>",
    "<S> we investigate the expressive power of the above results . </S>",
    "<S> we show that the permanent and hamiltonian polynomials for matrices of bounded treewidth both are equivalent to arithmetic formulas . </S>",
    "<S> also , arithmetic weakly skew circuits are shown to be equivalent to the sum of weights of perfect matchings of planar graphs . </S>"
  ]
}