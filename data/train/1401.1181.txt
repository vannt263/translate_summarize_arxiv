{
  "article_text": [
    "numerical simulation at atomic scale predicts system states and properties from a limited number of physical principles , using a numerical resolution method implemented with computers . in molecular dynamics ( md ) @xcite systems are organic molecules , metallic atoms , or ions .",
    "we concentrate on organic molecules , but our approach could as well apply to other kinds of systems .",
    "the goal is to determine the temporal evolution of the geometry and energy of atoms .    at the basis of md",
    "is the classical ( newtonian ) physics , with the fundamental equation :    @xmath0    where @xmath1 is the force applied to a particle of mass @xmath2 and @xmath3 is its acceleration ( second derivative of the variation of the position , according to time ) .",
    "a _ force - field _ is composed of several components , called",
    "_ potentials _ ( of bonds , valence angles , dihedral angles , van der waals contributions , electrostatic contributions , _",
    "etc_. ) and is defined by the analytical form of each of these components , and by the parameters caracterizing them .",
    "the basic components used to model molecules are the following :    * atoms , with 6 degrees of freedom ( position and velocity ) ; * bonds , which link two atoms belonging to the same molecule ; a bond between two atoms @xmath4 tends to maintain constant the distance @xmath5 .",
    "* valence angles , which are the angle formed by two adjacent bonds @xmath6 et @xmath7 in a same molecule ; a valence angle tends to maintain constant the angle @xmath8 .",
    "a valence angle is thus concerned by the positions of three atoms . * torsion angles ( also called _ dihedral angles",
    "_ ) are defined by four atoms @xmath9 consecutively linked in the same molecule : @xmath10 is linked to @xmath11 , @xmath11 to @xmath12 , and @xmath12 to @xmath13 ; a torsion angle tends to priviledge particular angles between the planes @xmath14 and @xmath15 .",
    "these particular angles are the equilibrium positions of the torsion potential ( minimal energies ) . in most cases , they are _ trans _ ( angle of @xmath16 ) , _ gauche _ ( @xmath17 ) or _ gauche _ ( @xmath18 ) .",
    "* van der waals interactions apply between two atoms which either belong to two different molecules , or are not linked by a chain of less than three ( or sometimes , four ) bonds , if they belong to the same molecule .",
    "they are pair potentials .",
    "all these potentials depend on the nature of the concerned atoms and are parametrized differently in specific force - fields .",
    "molecular models can also consider electrostatic interactions ( coulomb s law ) which are pair potentials , as van der waals potentials are ; their implementation is close to van der waals potentials , with a different dependence to distance .",
    "intra - molecular forces ( bonds , valence angles , torsion angles ) as well as inter - molecular forces ( van der waals ) are conservative : the work between two points does not depend on the path followed by the force between these two points .",
    "thus , forces can be defined as derivatives of scalar fields . from now on , we consider that potentials are scalar fields and we have :    @xmath19    where @xmath20 denotes the coordinates of the point on which the force @xmath21 applies , and @xmath22 is the potential from which the force derives .",
    "the work presented here is part of a md system presently under development@xcite ; the defined forces and their implementations have been tested with it .",
    "bonds are considered in section [ section : liaison ] , valence angles in section [ section : valence ] , torsion angles in section [ section : torsion ] , and finally lennard - jones potentials in section [ section : lj ] .",
    "section [ section : resume ] summarises the force definitions , and section [ section : conclusion ] concludes the text . a summary of the notations used in the paper is given in the annex .",
    "a bond models a sharing of electrons between two atoms which produces a force between them .",
    "this force is the derivative of the bond potential defined between the two atoms .",
    "[ figure : liaison ] shows a ( attractive ) force produced between two linked atoms @xmath10 and @xmath11 .",
    "[ ! htb ]        a _ harmonic bond potential _ is a scalar field @xmath23 which defines the potential energy of two atoms placed at distance @xmath24 as : @xmath25 where @xmath26 is the strength of the bond and @xmath27 is the equilibrium distance ( the distance at which the force between the two atoms is null ) .",
    "we thus have : @xmath28    the partial derivative of @xmath22 according to the position @xmath29 of @xmath10 is : @xmath30    but : @xmath31    we thus have : @xmath32    let @xmath10 and @xmath11 be two atoms , and @xmath33 be the normalization of vector @xmath34 .",
    "the force produced on atom @xmath10 is : @xmath35 and the one on @xmath11 is the opposite , according to the action / reaction principle : @xmath36 therefore , if @xmath37 , the force on @xmath10 is a vector whose direction is opposite to @xmath38 and tends to bring @xmath10 and @xmath11 closer ( attractive force ) , while it tends to bring them apart ( repulsive force ) when @xmath39 .",
    "according to the definition of @xmath40 and @xmath41 , the sum of the forces applied to @xmath10 and @xmath11 is null ( i.e. equilibrium of forces ) : @xmath42 note that no torque is produced as the two forces are colinear .",
    "valence angles tend to maintain at a fixed value the angle between three atoms @xmath10 , @xmath11 and @xmath12 such that @xmath10 is linked to @xmath11 and @xmath11 to @xmath12 , as shown on fig .",
    "[ figure : valence ] .",
    "[ htb ]        the forces applied to the three atoms all belong to the plane @xmath14 defined by the points @xmath10 , @xmath11 , @xmath12 .",
    "a _ harmonic valence potential _ is a scalar field @xmath22 which defines the potential energy of an atom configuration forming a valence angle @xmath43 by : @xmath44 where @xmath26 is the strength of the valence angle and @xmath45 is the equilibrium angle ( the one for which energy is null ) .",
    "the partial derivative of @xmath22 according to the angle @xmath43 is thus : @xmath46    the partial derivative of @xmath22 according to the position @xmath29 of @xmath10 is : @xmath47 that is : @xmath48 as @xmath10 describes a circle with radius @xmath49 , centered on @xmath11 , we have : @xmath50    let @xmath51 be the normalized vector in the plane @xmath14 , orthogonal to @xmath34  : @xmath52    the force applied on @xmath10 is then : @xmath53 in the same way , the force applied on @xmath12 is : @xmath54 where @xmath55 is the normalized vector in plane @xmath14 , orthogonal to @xmath56  : @xmath57    the sum of the forces should be null : @xmath58 thus , the force applied to @xmath11 is : @xmath59      let us now consider torques ( moment of forces ) .",
    "the torque exerted by @xmath40 on @xmath11 is @xmath60 and the torque exerted by @xmath61 on @xmath11 is @xmath62 . as @xmath34 and @xmath40",
    "are orthogonal , one has then @xmath63 . ] :    @xmath64    for the same reasons : @xmath65 thus , the two vectors @xmath60 and @xmath62 have the same length .",
    "as they are by construction in opposite directions , the sum of the two torques on @xmath11 is null : @xmath66 as a consequence , no rotation around @xmath11 can result from the application of the two forces @xmath67 and @xmath61 .",
    "a torsion angle @xmath43 defined by four atoms @xmath68 is shown on fig .",
    "[ figure : torsion ] . in the opls @xcite force - field , as in many other force - fields , potentials of torsion angles have a _ `` triple - cosine '' _ form .",
    "this means that the potential @xmath22 of a torsion angle @xmath43 is defined by . ] : @xmath69\\ ] ]    [ !",
    "htb ]    , width=377 ]    the partial derivative of the torsion angle potential according to the position @xmath29 of @xmath10 is : @xmath70 the partial derivative of the potential according to the angle @xmath43 is : @xmath71      let us call @xmath72 the angle @xmath73 .",
    "atom @xmath10 turns around direction @xmath7 , on a circle of radius @xmath74 .",
    "the partial derivative of @xmath43 according to the position of @xmath10 is : @xmath75    we thus have : @xmath76    similarly , for atom @xmath13 , noting @xmath77 the angle @xmath78  : @xmath79    let @xmath80 the normalized vector orthogonal to the plane @xmath14 , and @xmath81 the normalized vector orthogonal to the plane @xmath15 ( the angle between @xmath80 and @xmath81 is @xmath43 ) : @xmath82    the force applied on @xmath10 is : @xmath83    in the same way , the force applied on @xmath13 is : @xmath84      we now have to determine the forces @xmath41 and @xmath61 to be applied on @xmath11 and @xmath12 .",
    "the equilibrium conditions imply two constraints : ( a ) the sum of the forces has to be null : @xmath85 and ( b ) the sum of torques also has to be null and @xmath86 , as the sum of torques would be non - null , thus leading to an increase of potential energy . ] . calling @xmath87 the center of bond @xmath7 ,",
    "this means : @xmath88    from ( [ eq : dih : null - sum - torque ] ) it results : @xmath89    and : @xmath90    which implies : @xmath91    from ( [ eq : dih : null ] ) it results : @xmath92    substituting ( [ eq : dih : sum2 ] ) in ( [ eq : dih : sum1 ] ) , one gets : @xmath93 thus : @xmath94 which implies : @xmath95 and we finally get the condition that the torque from @xmath61 should verify in order ( [ eq : dih : null - sum - torque ] ) to be true : @xmath96 let us state : @xmath97    equation @xmath98 has an infinity of solutions in @xmath99 , all having the same component perpendicular to @xmath100 .",
    "we thus simply choose as solution the force perpendicular to @xmath100 defined by : @xmath101    equation ( [ eq : cpl ] ) is verified because : @xmath102 thus , then @xmath103 . ]  : @xmath104    the value of @xmath41 is finally deduced from equation ( [ eq : dih : null ] ) stating the equilibrium of forces : @xmath105    we have thus determined four forces @xmath106 whose sum is null ( [ eq : dih : null ] ) and whose sum of torques is also null ( [ eq : dih : null - sum - torque ] ) .",
    "a lennard - jones ( lj ) potential @xmath107 between two atoms placed at distance @xmath24 is defined by :    @xmath108\\ ] ]    in this definition , parameter @xmath109 is the distance at which the potential is null , and parameter @xmath110 is the minimum of the potential ( corresponding to the maximum of the attractive energy ) .    stating @xmath111 and @xmath112 , eq .",
    "( [ equation : lj-1 ] ) becomes :    @xmath113    the partial derivative of @xmath22 according to distance is thus : @xmath114 let @xmath10 and @xmath11 be two atoms .",
    "the force on @xmath10 is : @xmath115 where @xmath38 is the normalization of @xmath34 . from the action / reaction principle ,",
    "one deduces that the force on @xmath11 should be the opposite of the force on @xmath10 : @xmath116    according to the definition of @xmath40 and @xmath41 , the sum of the forces applied to @xmath10 and @xmath11 is null : @xmath117 note that , as for bonds , no torque is produced because the two forces are colinear .",
    "the forces defined in the previous sections are summed up in the following table :    r|c|l bond @xmath5 & [ eq : bond : fa ] & @xmath118 + & [ eq : bond : fb ] & @xmath119 + valence @xmath14 & [ eq : valence : fa ] & @xmath120 + & [ eq : valence : fb ] & @xmath121 + & [ eq : valence : fc ] & @xmath122 + torsion @xmath123 & [ eq : torsion : fa ] & @xmath124 + & [ eq : torsion : fb ] & @xmath125 + & [ eq : torsion : fc ] & @xmath126 + & [ eq : torsion : fd ] & @xmath127 + lj @xmath5 & [ eq : lj : fa ] & @xmath128 + & [ eq : lj : fb ] & @xmath129 +    * in eq .",
    "[ eq : bond : fa ] , @xmath26 is the bond strength constant , @xmath24 is the distance between atoms @xmath10 and @xmath11 , and @xmath27 is the equilibrium distance , for which energy is null .",
    "vector @xmath38 is defined by @xmath33 . * in [ eq : valence : fa ] and [ eq : valence : fc ] , @xmath26 is the angle strength constant , @xmath43 is the angle @xmath130 , and @xmath45 is the equilibrium angle , for which energy is null . in [ eq : valence : fa ] , @xmath51 is defined by @xmath131 . in [ eq : valence : fc ] , @xmath55 is defined by @xmath132 . * in [ eq : torsion : fa ] and [ eq : torsion : fd ] , @xmath43 is the torsion angle , @xmath72 is the angle @xmath73 , @xmath77 is the angle @xmath78 and @xmath133 , @xmath134 and @xmath135 are the parameters which define the `` three - cosine '' form of the torsion angle .",
    "vector @xmath80 is defined by @xmath136 and @xmath137 . in [ eq : torsion : fc ] , @xmath87 is the middle of @xmath7 and @xmath138 is defined by @xmath139 . * in [ eq : lj : fa ] , @xmath109 is the distance at which the potential is null and @xmath110 is the depth of the potential ( minimum of energy ) . as for bonds , one has @xmath33 .    in each case",
    "( bond , valence , torsion , lj interaction ) , the sum of the forces that are applied to atoms is always null ( eq . (",
    "[ eq : bond : null - sum ] ) , ( [ eq : valence : null - sum ] ) , ( [ eq : dih : null ] ) , ( [ eq : lj : null - sum ] ) ) .",
    "moreover , no torque is induced by application of these forces : no torque is produced by bonds and lj interactions , as the produced forces are colinear ; we have verified in sec .",
    "[ subsection : toques ] that no torque is produced by valence angles ( [ eq : valence : torque ] ) ; for torsion angles , we have chosen the forces in such a way that the sum of the forces and the global sum of torques are always null ( [ eq : dih : null - sum - torque ] ) .",
    "this means that no energy is ever added by the application of the forces during the simulation process .",
    "we have precisely defined the forces that apply on atoms in md simulations .",
    "the definitions are given in a purely vectorial formalism ( no use of a specific coordinate system ) .",
    "we have shown that the sum of the forces and the sum of the torques are always null , which means that the energy of molecular systems is preserved while the forces are applied .    1    .",
    "http://mdrp.cemef.mines-paristech.fr .",
    "m.  p. allen and d.  j. tildesley . .",
    "oxford , 1987 .",
    "w.  damm , a.  frontera , j.  tirado - rives , and w.l .",
    "jorgensen . .",
    ", 16(18):19551970 , 1997 .",
    "* if @xmath10 and @xmath11 are two atoms , we note @xmath140 the vector with origin @xmath10 and end @xmath11 ; the distance between the two atoms is noted @xmath49 . * the null vector",
    "is noted @xmath141 . *",
    "the length of vector @xmath38 is noted @xmath142 .",
    "one thus has : @xmath143 . *",
    "multiplication of @xmath38 by the scalar @xmath144 is noted @xmath145 , or more simply @xmath146 . * the vectorial product of @xmath38 and @xmath147",
    "is noted @xmath148 . * the scalar product of @xmath38 and @xmath147",
    "is noted @xmath149 .",
    "* we write @xmath150 when @xmath38 and @xmath147 are orthogonal ( @xmath151 ) . *",
    "we note @xmath152 the normalized vector from @xmath38 ( same direction , but length equal to 1 ) defined by @xmath153 . * if @xmath10 , @xmath11 and @xmath12 are atoms , we note @xmath73 the angle formed by @xmath10 , @xmath11 and @xmath12 ."
  ],
  "abstract_text": [
    "<S> in molecular dynamics ( md ) , the forces applied to atoms derive from potentials which describe the energy of bonds , valence angles , torsion angles , and lennard - jones interactions of which molecules are made . </S>",
    "<S> these definitions are classic ; on the contrary , their implementation in a md system which respects the local equilibrium of mechanical conditions is usually not described . </S>",
    "<S> the precise derivation of the forces from the potential and the proof that their application preserves energy is the object of this note . </S>",
    "<S> this work is part of the building of a multi - scale md system , presently under development .    </S>",
    "<S> [ [ keywords . ] ] keywords . </S>",
    "<S> + + + + + + + + +    molecular dynamics  ; force - fields  ; potentials  ; forces . </S>"
  ]
}