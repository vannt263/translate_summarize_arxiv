{
  "article_text": [
    "stochastic models on lattices are an old subject in statistical physics , and cluster mean - field theories have been developed and used both in the context of equilibrium and non - equilibrium problems @xcite .",
    "these are mean - field approximations that are formulated in terms of the @xmath0-site joint probabilities .",
    "since for any fixed @xmath0 the evolution equations for these probabilities do not in general form a closed set , the @xmath1-site probabilities are expressed in terms of the lower order probabilities according to some closure assumption . at the lowest nontrivial order of truncation , this method corresponds to the well known pair approximation ( pa ) according to which the triplet probabilities @xmath2 are factorized as @xmath3 , where @xmath4 denote lattice nodes states and @xmath5 is the conditional probability of having state @xmath6 in neighbor of a node in state @xmath7 .",
    "the pa is exact on the bethe lattice or cayley tree , a mathematical model which can not be realized as a physical system or simulated computationally . in finite lattices ,",
    "in particular in the @xmath8-dimensional regular lattice with first neighbor interactions often considered in these models , the pa is used as the simplest analytical description that includes an explicit representation of spatial correlations . despite being quantitatively inaccurate ,",
    "it provides insight and qualitative information about the system .",
    "more recently , the interest in this approximation procedure shifted from the exploration of conceptual models to its applications in several problems of population dynamics .",
    "the spread of a virus is an example of a dynamic process occurring on a discrete spatial arrangement that was modeled in the traditional literature with the 1-site or mean - field approximation ( mfa ) @xcite .",
    "while the mfa reasonably reproduces the spreading behavior for topologies where the number of connections per node is either high or strongly fluctuating and for those that show small - world features , it is highly inaccurate for lattice and in general network structured populations .",
    "the pa has become very popular in lattice - based stochastic models of ecological , epidemic and evolutionary game dynamics @xcite , and several modifications of the pa have been proposed for particular graphs and dynamic rules that lead to better quantitative agreement @xcite .",
    "some of these modifications are based on different closure assumptions at the level of pairs , while others depend on including higher order clusters .    by contrast , the pa is expected to perform well , even quantitatively , for stochastic models on large regular random graphs ( rrgs ) which are random networks of fixed connectivity per node , or degree @xcite .",
    "this is because of the rrg s statistical properties , namely the short loop density of the graph tending to zero in the limit of large graph size @xcite , so that a rrg may be seen locally as a bethe lattice of the same degree .    in this paper",
    ", we consider the susceptible - infective - recovered - susceptible ( sirs ) stochastic epidemic model on simple rrgs , that is rrgs with no loops formed by one or two edges .",
    "we construct a detailed stochastic model based on the pa that captures the behavior of this dynamics in finite systems , in the sense that the power spectrum of the fluctuations computed analytically from the model matches the numerical power spectrum measured along the simulation runs whenever the averaged dynamics of the densities is well approximated by the solutions of the pa equations in the thermodynamic limit .",
    "this happens in a large region of parameter space because the quality of the approximation becomes poor only when the recovery rate is much larger than the rate of loss of immunity .",
    "the coupling between dynamics and graph structure intervenes in the microscopic description of the system through the different transitions that it is necessary to consider and the corresponding transition rates .",
    "when recovery is much faster than loss of immunity and the pa fails in the thermodynamics limit , the cluster approximation must be carried out beyond the level of pairs .",
    "we show that a triplet approximation ( ta ) with a standard closure assumption is adequate to describe the behavior of the system up to recovery rates two orders of magnitude larger than the immunity waning rates .",
    "this parameter range is of interest in applications to childhood infectious diseases @xcite . in order to describe the behavior of finite systems in this region ,",
    "a detailed stochastic model suitable for rrgs can be built on the basis of the ta following the procedure described for the pa .",
    "in this section we propose a stochastic model of the sirs epidemic process in the pa .",
    "the effects of the inclusion of an implicit representation of spatial dependence in a stochastic model have been recently studied @xcite .",
    "an extension of the analysis of stochastic fluctuations from non - spatial models to the case of models on regular structures such as @xmath8-dimensional hypercubic lattices has also been performed @xcite .",
    "the present study elaborates on the stochastic models with implicit spatial dependence by including a detailed microscopic description of the transitions between the states of the nodes and the states of the pairs of the nearest neighbors , that can be treated analytically .",
    "the results obtained both for the averaged dynamics that describes the behavior of the system in the thermodynamic limit and for the spectrum of the fluctuations in the quasi - stationary state of finite systems agree well with the results of monte carlo simulations on rrgs in a large parameter range .",
    "technically , the pa approach is quite similar to that previously developed for well - mixed systems also known as the mfa approach @xcite while having substantial differences which can be easily understood as soon as we review a few facts .",
    "the full set of deterministic equations describing the sirs process in the mfa is written in terms of the densities of susceptible and infected populations ( we will equivalently use the term `` probability '' in what follows ) .",
    "these differential equations are deduced on the assumption of uncorrelated nodes in the limit of infinite system size and constitute an approximation for the transient and quasi - stationary behaviors of large spatially extended systems . accordingly , the associated stochastic model has two classes of individuals , infected and susceptible , as its independent dynamical variables , and a particular realization of the model at a given time @xmath9 consists of @xmath10 susceptible individuals , @xmath11 infected individuals and @xmath12 recovered individuals , where @xmath13 is the total population size or the number of nodes in a graph .    the deterministic formulation of the sirs model in the pa couples the dynamics of the node and pair densities in the thermodynamic limit .",
    "the purpose of the inclusion of pair densities is to improve the level of approximation in the description of spatially explicit simulations of the stochastic model .",
    "consider the stochastic sirs process on a rrg with fixed degree per node @xmath14 ( rrg-@xmath14 ) and @xmath13 nodes .",
    "after the initial distribution of the nodes among the classes of susceptible ( @xmath15 ) , infected ( @xmath16 ) and recovered ( @xmath17 ) individuals , let the state of the system evolve in time according to asynchronous update of the events of infection , recovery and immunity waning .",
    "namely , infected individuals recover at rate @xmath18 [ @xmath19 , immunity of recovered individuals ceases at rate @xmath20 [ @xmath21 , and infection in the susceptible - infected pairs of the nearest neighbors occurs with rate @xmath22 [ @xmath23 .",
    "each executed event taken separately changes the state of only one node , has its side - effects on the state of the pairs the node forms with its neighbors , propagates to larger configurations and finally to the whole graph .",
    "consequently , frequency distributions or numbers of various correlations present in the graph , among which pairs are the simplest ones , change . to construct a stochastic model in the pa the transition probabilities of different events have to be approximated purely in terms of pairs . more specifically , to represent independent classes of the constituents of the stochastic system we can choose five independent numbers subject to the constraints on the number of nodes and pairs in the graph .",
    "these can be five pair variables alone , one node and four pair variables or two node and three pair variables .",
    "we shall adopt the last variant so that taking the limit @xmath24 in the stochastic pa model we recover the pa - sirs deterministic equations in the form given in ref .",
    "we introduce the following notation for the independent variables : @xmath10 and @xmath11 are the numbers of susceptible and of infected nodes and @xmath25 , @xmath26 and @xmath27 are the numbers of susceptible - infected , susceptible - recovered and recovered - infected pairs of the nearest neighbor nodes , respectively , at time @xmath9 . the full set of the five variables is denoted shortly as @xmath28 .",
    "the remaining variables are not independent .",
    "they can be computed from the constraints as follows : @xmath29 where @xmath30 is the number of nodes in state @xmath31 , @xmath32 is the number of pairs of the nearest neighbor nodes in states @xmath33 . in this notation , @xmath10 and @xmath11 equal @xmath34 and @xmath35 , and @xmath25 , @xmath26 and @xmath27 equal @xmath36 , @xmath37 and @xmath38 , respectively .",
    "note that in eq .",
    "( [ constraintspairs ] ) the factor of 2 comes from the fact that @xmath39 pairs must be counted twice .",
    "further , the number of constituents in the classes , which are now interpreted as classes of individuals in specific states and classes of fixed contacts established amongst individuals in specific states , evolves according to the rule : whichever event is executed , a transition of one individual between the classes of individuals occurs simultaneously with transitions of the individual s @xmath14 contacts between the classes of contacts .",
    "this rule is nothing else than the statement of the local modifications on a rrg-@xmath14 caused by a single event : a change in state of one node induces the simultaneous change in states of the @xmath14 pairs whose common member is the node undergoing the transition . the coarse grained description where the effect of the change in state of a given node on the @xmath14 pairs that it forms is averaged over each pair type has been given in ref .",
    "@xcite . in this study",
    ", we consider a detailed stochastic model in which the @xmath14 pairs are , in general , different .     and its nearest neighbors in states @xmath40 , where @xmath41 and @xmath42 , in a rrg-@xmath43 . ]",
    "next , we calculate the transition rates for the pa - sirs stochastic process corresponding to the full microscopic description and yielding the pa deterministic equations as the equations of motion for the infinite system size .",
    "consider a recovery event [ @xmath19 on a rrg-@xmath43 as an example . during a simulation of the stochastic process",
    "the rate of this event is equal to the constant rate of recovery , @xmath18 , multiplied by the number of infected nodes at given time , @xmath11 . as we keep track of the changes in states of the pairs formed by the central node that switches from infected to recovered , we have to calculate how this net rate is distributed among all possible configurations the infected node and its first neighbors might form . the configurations with a central node in state @xmath16 are accepted as different if they have different number of pairs @xmath44 , where @xmath45 , irrespective of their spatial arrangement .",
    "the total number of such configurations for recovery equals @xmath46 , where @xmath47 is the number of states and @xmath48 is coordination number of the graph .",
    "as it is well known in large sparse rrgs the members of a pair are unlikely to share neighbors @xcite .",
    "having no nodes in common suggests that in the first approximation the pairs can be considered as independently distributed . in mathematical formulation",
    "it means that the probabilities of having particular configurations follow a multinomial law @xcite . to be as general as possible",
    "we give the conditional probability of a configuration , shown in fig .",
    "[ fig1 ] , by the formula : @xmath49 here @xmath42 denote states of the five nodes and @xmath50 .",
    "the number of neighbors to be independently distributed is @xmath48 .",
    "@xmath51 is the conditional probability that given a node in state @xmath31 its nearest neighbor is in state @xmath40 : @xmath52 summation over the states of all pairs present in a given configuration equals the number of the nearest neighbors : @xmath53 .        if there are chains of connections between outer nodes of a configuration , especially short ones , the described method introduces an error because the pairs can no longer be considered independent .",
    "this is a crucial point that explains the failure of the standard pa for regular structures characterized by a huge number of loops of all lengths . for sparse rrgs with locally tree - like structure",
    "we assume the pairs to be uncorrelated , so that the probability distribution of a central node s neighbors can still be estimated by the multinomial eq .",
    "( [ multinomial ] ) .    to demonstrate an application of eq .",
    "( [ multinomial ] ) we choose a configuration before recovery of the central node shown in fig .",
    "the probability of this configuration is given by : @xmath54 using eq .",
    "( [ constraintspairs ] ) and the notation introduced in the beginning of this section one obtains : @xmath55    according to fig .",
    "[ fig1 ] , we introduce the total variation of the number of nodes in state @xmath31 and of the number of pairs in state @xmath56 in a graph as the difference between the respective numbers after and before the central node switches from state @xmath31 to another state : @xmath57 in fig .",
    "[ fig2 ] , after recovery of the central node the configuration changes to that with a recovered node in the center inducing transitions in pairs of the nearest neighbors .",
    "the corresponding number variations for the independent variables are @xmath58 , @xmath59 , @xmath60 , @xmath61 , and @xmath62",
    ". finally , we can give the transition rate for a recovery event in the center of the configuration shown in fig .",
    "[ fig2 ] as follows : @xmath63 where the subscript and the superscript of @xmath64 denote the initial and the final states of the system , respectively .",
    "the other transition rates for events of recovery and immunity waning are straightforward modifications of the above . as for infection process",
    "[ @xmath23 it is considered as inherent to a pair of nodes because transmission of infection requires a contact between two individuals , susceptible and infected .",
    "a transition of @xmath15 node in @xmath65 pair from susceptible to infected changes both the state of this pair and the states of the other three pairs joining the @xmath15 node with its three nearest neighbors which we assume to be independently distributed in the pa .",
    "thus , eq . ( [ multinomial ] ) is still applicable with @xmath66 , @xmath67 and @xmath68 : @xmath69 where we have used the closure assumption in the standard pa , @xmath70 .",
    "now , for instance , the approximate transition rate for infection within an @xmath65 pair of the configuration depicted in fig .",
    "[ fig5 ] equals : @xmath71        having calculated all transition rates as described , we are ready to write the master equation for the pa - sirs stochastic process @xcite : @xmath72 \\ , \\ ] ] where @xmath73 denotes transition rates from other states @xmath74 to state @xmath75 and vice versa for @xmath76 .",
    "the complete solution of this differential - difference equation @xmath77 gives the probability of finding the system in state @xmath75 for all allowed sets of integers @xmath78 , where @xmath79 , at time @xmath80 subject to the initial , normalization and boundary conditions .",
    "in general , it is not easy to solve this equation analytically but it is quite straightforward to analyze it for large but finite @xmath13 using van kampen s system size expansion @xcite . in that spirit , we set : @xmath81 in both equations , the first macroscopic terms scale with the system size @xmath13 .",
    "the functions @xmath82 and @xmath83 are densities of susceptible and infected populations which have to be adjusted so as to satisfy the deterministic equations of motion in the pa . @xmath84 and @xmath85 are the new variables which denote stochastic fluctuations around the corresponding solutions of the pa deterministic equations and replace @xmath86 and @xmath87 , respectively",
    ". the time - dependent transformations [ eq .",
    "( [ nodefluc ] ) ] from @xmath86 , @xmath87 to @xmath84 , @xmath85 involving functions @xmath88",
    ", @xmath89 come from the fact that one expects , with respect to the node variables , the probability distribution function @xmath77 to have a sharp peak around the macroscopic values @xmath90 , @xmath91 with a width of order of @xmath92 , so that the functions @xmath88 , @xmath89 follow the motion of the peak in time . wheareas the system involves nodes and pairs as constituent elements we should carefully define what is meant by stochastic fluctuations around the solutions of the pa deterministic equations regarding the pair variables . for the fluctuations of the pair densities we set : @xmath93 in the above transformations , the first macroscopic terms are of order @xmath94 , and the ansatz for the fluctuations scaling with the system size is @xmath95 for fixed parameter @xmath14 [ actually , the scaling of the macroscopic terms in eqs .",
    "( [ nodefluc ] ) and ( [ parefluc ] ) can be found from eqs .",
    "( [ constraintsnodes ] ) and ( [ constraintspairs ] ) ] .",
    "the densities of susceptible - infected , susceptible - recovered and recovered - infected pairs are defined as @xmath96 , @xmath97 and @xmath98 , respectively .",
    "the large-@xmath13 expansion is carried out using integer step operators @xmath99 , where @xmath79 , that can be expressed as taylor series involving partial derivatives with respect to the node and pair fluctuation variables @xcite : @xmath100 with the aid of eqs . ( [ nodefluc])-([epsilons ] ) , the master equation ( [ generalmasterequation ] ) can be written in the following form : @xmath101 where the probability distribution function @xmath102 and @xmath103 are integer powers such that : @xmath104 the leading terms in the power series expansion of eq . ( [ master_epsilon ] )",
    "are of order @xmath92 . collecting and setting them to zero yields a set of five first order differential equations .",
    "these are the pa - sirs deterministic equations , see the appendix for their explicit form . in next - to - leading - order , setting to zero the terms of order @xmath105 , one gets a linear multivariate fokker - planck equation for the probability distribution function @xmath106 @xcite :    @xmath107    here @xmath108 are stochastic fluctuations of the node and pair densities about their endemic steady state values in the pa .",
    "@xmath109 is the jacobian matrix of the pa equations linearized about the endemic equilibrium solution , see formula ( [ pajacobian ] ) in the appendix .",
    "@xmath110 is symmetric internal noise cross correlation matrix derived directly from the expansion . for instance , @xmath111 , where @xmath112 stands for the endemic equilibrium value of the density of infected individuals in the pa .",
    "the difference of the detailed stochastic description from the coarse grained description considered in ref .",
    "@xcite is reflected in the elements of the matrix @xmath113 , where @xmath114 .",
    "since the fokker - planck equation is linear , its solution @xmath115 is a multivariate gaussian distribution completely determined by the first and the second moments .",
    "however , to analyze the fluctuations it is convenient to use the equivalent linear multivariate langevin equation for @xmath116 @xcite :    @xmath117    @xmath118 are white random noise terms with the following properties : @xmath119 the structure of the noise @xmath116 as function of angular frequency @xmath120 is found from the power spectrum of the normalized fluctuations ( psnf ) denoted as the averaged squared modulus of the fourier transform of @xmath116 : @xmath121 where @xmath122 solving for the fourier transforms from the linear eq .",
    "( [ langevinequation ] ) and using the correlation function in the frequency domain @xmath123 , the approximate analytical expression for the psnfs about the endemic equilibrium solution of the pa equations becomes :    @xmath124    where @xmath125 .",
    "the psnf of the susceptibles ( of the infectives ) is then obtained by setting @xmath126 ( @xmath127 , respectively ) . in this case , the psnfs are of the form @xmath128 , where @xmath129 and @xmath130 are polynomials in @xmath120 of order 8 and 10 , respectively .",
    "note that the same formula [ eq .",
    "( [ psnfgeneral ] ) ] is also valid for the psnfs in the mfa taking @xmath109 as the jacobian of the mfa - sirs differential equations linearized about the mean - field endemic equilibrium solution and the noise cross correlation matrix @xmath110 computed directly from the expansion",
    "[ fig4 ] and [ ps_rrg4_pa ] compare results of the theory developed so far with data of the sirs stochastic model obtained from monte carlo simulations on a rrg-@xmath43 .",
    "the rrgs are generated using a quick algorithm introduced in ref .",
    "the algorithm guarantees that for small degrees at least , which is the case here , the rrg-@xmath14 on @xmath13 nodes is generated uniformly at random , in the sense that all rrg-@xmath14 on @xmath13 nodes have asymptotically the same probability as @xmath131 . in the stochastic simulations ,",
    "the system is set in a random initial condition with fixed node and pair densities , after which the states of the nodes are updated asynchronously according to the events of infection , recovery and loss of immunity .",
    "figure [ fig4 ] shows averaged or global behavior of the densities as obtained from many runs of numerical simulations , namely for each set of given parameter values and initial conditions the simulations are averaged over @xmath132 realizations of a rrg .",
    "figure [ ps_rrg4_pa ] analyzes the fluctuations about the steady state densities observed in an individual run .",
    "more precisely , we compute the psnfs in @xmath133 parallel long simulation runs on rrgs numerically , and then we average . in both figures , the same parameter values in the endemic phase",
    "are used in the corresponding panels to ease a comparison of the results .",
    "note that on a finite graph , the only true steady state of the sirs process corresponds to all nodes being in susceptible state , that is why the steady states of the pa model are compared with the quasi - stationary states of large but finite systems .     and averaged numerical time series ( black lines ) obtained from monte carlo simulations of the sirs stochastic model on a rrg-@xmath43 with @xmath134 nodes .",
    "all plots were obtained for @xmath135 , @xmath136 and @xmath48 .",
    "parameters : ( a ) and ( b ) @xmath137 ; ( c ) and ( d ) @xmath138 . ]    plots in fig .",
    "[ fig4 ] show susceptible and infective densities as function of time .",
    "numerical solutions of the pa deterministic equations given in the appendix are plotted in gray ( green ) .",
    "black lines are sample averages of the densities as obtained from @xmath132 realizations of a rrg-@xmath43 with @xmath134 nodes . for the sirs model",
    "the agreement of the solutions of the pa deterministic equations with the averaged dynamics on rrgs is sensitive to the rate of immunity waning @xmath20 , viz it deteriorates with decreasing @xmath20 @xcite .",
    "the upper panels in fig .",
    "[ fig4 ] are plotted for a set of parameter values for which the solutions of the pa equations reproduce the behavior of the averaged times series on a rrg-@xmath43 with a good accuracy both in the transient and in the quasi - stationary regime . the lower panels in fig .",
    "[ fig4 ] plotted for a smaller value of @xmath20 with the other parameters being fixed reflect the striking difference in the dynamics of the simulations ( black lines ) and of the pa deterministic model [ gray ( green ) lines ] .",
    "although the steady state values of the densities are close , during the transient period the averaged time series attenuate more rapidly in the numerical simulations than the damped oscillations predicted by the pa .     and",
    "averaged numerical psnfs ( black lines ) calculated from monte carlo simulations of the sirs epidemic process on a rrg-@xmath43 with @xmath134 nodes .",
    "all plots were obtained for @xmath135 , @xmath136 and @xmath48 .",
    "parameters : ( a ) and ( b ) @xmath137 , lin - lin plot ; ( c ) and ( d ) @xmath138 , lin - log plot . ]    plots in fig .",
    "[ ps_rrg4_pa ] are the approximate analytical psnfs [ gray ( green ) lines ] given by formula ( [ psnfgeneral ] ) and the averaged numerical psnfs ( black lines ) calculated from @xmath139 replicate simulation runs of the sirs process on a rrg-@xmath43 with @xmath134 nodes .",
    "the upper panels in fig .",
    "[ ps_rrg4_pa ] plotted for parameter values used in the upper panels in fig .",
    "[ fig4 ] show the agreement between the analytical and numerical psnfs of the susceptibles and infectives .",
    "the analytical psnfs [ eq .",
    "( [ psnfgeneral ] ) ] deduced from the detailed stochastic pa model with the transition rates calculated on the basis of eqs .",
    "( [ multinomial ] ) and ( [ simultinomial ] ) approximate the averaged numerical psnfs well in those regions where the pa deterministic model predicts the same behavior as that of the times series obtained from the simulations averaged over many realizations . in this region ,",
    "the typical psnf is a bell - shaped curve indicating that in an individual simulation run susceptible and infective densities oscillate in time with frequencies close to the principal frequency demarked by the maximum of the curve .",
    "in fact , the large oscillations of the densities are due to a kind of internal resonance previously studied for a non - spatial predator - prey model @xcite . in the lower panels in fig .",
    "[ ps_rrg4_pa ] the amplitude of both the analytical and the numerical psnfs gets much higher , indicating that for smaller values of @xmath20 the stochastic fluctuations become more pronounced and better structured . the fact that the numerical psnfs lie significally below those predicted analytically is closely related to the stability of the endemic equilibrium of the pa equations .",
    "as @xmath20 decreases the equilibrium s stability gets weaker until it is lost on a critical line corresponding to a supercritical andronov - hopf bifurcation @xcite .",
    "accordingly , the approximate analytical psnfs become more and more enhanced until they finally diverge on the critical line .",
    "note that in the lower panels in fig .",
    "[ fig4 ] plotted for the same parameters the behaviors of the analytical and numerical global densities do not agree too .",
    "a good correspondence and subsequent divergence between the analytical and numerical psnfs can be understood from the van kampen s large-@xmath13 expansion about the endemic equilibrium performed above .",
    "the analytical expression for the psnfs , see formula ( [ psnfgeneral ] ) , is a function of @xmath120 and constant matrices @xmath109 and @xmath110 whose elementes are expressed in terms of the basic parameters of the model @xmath22 , @xmath20 , @xmath18 and @xmath14 . in the general theory developed in ref .",
    "@xcite , the matrices can depend on time through the node [ @xmath140 , @xmath141 and pair [ @xmath142 , @xmath143 , @xmath144 densities .",
    "however , as we are interested in the analysis of the fluctuations in the endemic equilibrium we have to substitute for the node and pair variables their stationary values [ @xmath145 , @xmath146 , @xmath147 , @xmath148 , @xmath149 depending on the parameters .",
    "this substitution results in time - independent coefficient matrices @xmath109 and @xmath110 .",
    "it follows that the agreement between the analytical and numerical psnfs is expectable in the regions where the pa deterministic model approximates the transient and quasi - stationary global dynamics on rrgs quite well .",
    "we emphasize that although the coarse grained stochastic model considered in ref .",
    "@xcite exhibits the same qualitative behavior as the detailed model described here , the quantitative agreement between the corresponding psnfs is not achieved in that case . therefore",
    ", the detailed microscopic description is needed to approximate the exact stochastic dynamics on rrgs . moreover , taking into account the above analysis it now becomes clear that resorting to higher order cluster approximations is necessary to describe the behavior of the sirs stochastic model on rrgs for small @xmath20 .",
    "as mentioned in the previous section , in ref .",
    "@xcite we have compared the data of the sirs stochastic process obtained from monte carlo simulations on rrgs with the solutions of the standard pa equations and have shown that the pa describes correctly the global behavior of the model in the limit where rate of immunity waning @xmath150 but it fails to capture the dynamics for @xmath151 .",
    "the question is then whether a cluster approximation of the next order can explain the suppression of global oscillations predicted by the pa for @xmath151 and , in particular , whether it can describe stationary states correctly",
    ". a reasonable description of the endemic equilibria as well as of the phase diagram of the stationary state calculated from numerical simulations is obtained by extending the generalized cluster approximation procedure to combinations of three neighboring nodes or triplets for short .    in this section",
    ", we address this question and more generally the problem of the construction of cluster approximations of the order @xmath152 higher than two , that is higher than the pa . as a matter of fact , for the sirs process the time evolution of the @xmath152-node joint probabilities is governed by a set of first order differential equations expressing their time derivatives as linear combinations of @xmath152- and @xmath153-node joint probabilities .",
    "this is due to the infection process involving two nodes , susceptible and infected , simultaneously . in order to proceed the set of equations",
    "must be closed . in the standard cluster approximation",
    "the @xmath153-node joint probabilities are rational functions of the joint probabilities of smaller clusters of neighboring nodes , appropriately normalized , and thus the full set of first order differential equations can be obtained .    within this perspective",
    "the pa is a standard cluster approximation for @xmath154 .",
    "the ta is obtained for @xmath155 in a straightforward way by keeping node , pair and triplet probabilities as independent variables and expressing quadruplet probabilities in terms of them .",
    "we remind that each equation for the probability evolution of a particular cluster configuration is derived by considering all transitions leaving or entering it . using the notation of the appendix , in the ta of the sirs process the equation for , for example",
    ", @xmath156 reads as @xmath157 the first term on the right - hand side is due to the transition of @xmath158 pairs to @xmath159 pairs occurring at rate @xmath18 .",
    "the second [ third ] term corresponds to recovery [ loss of immunity ] of @xmath16 [ @xmath17 ] node in @xmath159 pairs that transit to @xmath161 [ @xmath65 ] pairs at rate @xmath18 [ @xmath20 ] . finally , a triplet @xmath164 changes to @xmath165 with rate @xmath22 such that a pair @xmath166 is changed to @xmath159 .",
    "since @xmath15 node of @xmath166 pair has @xmath167 free neighbors that can infect it , this factor is included in the fourth term of the equation .",
    "keeping again the same node [ @xmath140 , @xmath141 and pair probabilities [ @xmath142 , @xmath143 , @xmath144 as independent variables the equation can be written in the following form : @xmath168-(2\\delta+\\gamma)p(ri)+\\nonumber\\\\ & + & \\lambda ( k-1)p(rsi ) \\ . \\nonumber\\end{aligned}\\ ] ]    the equations for triplet probabilities are obtained in a similar way . in general , as far as clusters of more than two neighboring nodes are concerned , these split into two distinct classes , open and closed , and both have to be taken into account by considering the probabilities of finding an open and a closed configuration separately . by definition , an open cluster of a given size does not contain any loop while a closed cluster , on the contrary , necessarily contains at least one loop .",
    "thus , for example , a triplet cluster can be closed forming a triangle or open forming a linear chain of three nodes . however , the number of short loops is small for large rrgs with small @xmath14 @xcite .",
    "for instance , the analytical estimates for the mean @xmath169 and variance @xmath170 of the number of loops of length @xmath171 in a rrg-@xmath43 in the thermodynamic limit are @xmath172 , @xmath173 @xcite .",
    "the rrgs with @xmath174 are even more sparse , so that the number of short loops is even smaller .",
    "based on these results we neglect the presence of small closed clusters in rrgs .",
    "thus in the ta of the sirs process , we complement eq . ( [ paeq ] ) ,",
    "see the appendix , in which the probabilities of the triplets will be retained , with the equations for the triplet probabilities considering only open clusters of neighboring nodes . for instance , using the transition rules of the sirs process the evolution equation for the probability @xmath175 of finding a random triplet in state @xmath176 becomes : @xmath177-\\nonumber\\\\ & -&2\\gamma p(rri)+\\lambda(k-1)p(rrsi ) \\ , \\nonumber\\end{aligned}\\ ] ] where @xmath178 is the probability of an open linear quadruplet in state @xmath179 .",
    "the deduction of other triplet equations is straightforward .    to write the final closed set of differential equations in the ta we have : ( a ) to choose independent triplet variables",
    "whose number is reduced due to basic conservation relations ; ( b ) to approximate quadruplet probabilities in terms of the node , pair and triplet ones .",
    "we discuss these two questions by order . with the use of probabilistic relations @xmath180 and reflection symmetries @xmath181",
    "where @xmath182 , the number of independent triplet variables yields 9 and thus the total number of the ta equations is 14 .",
    "note that in finite rrgs the probability of triplets at given time equals : @xmath183 where we used the obvious notation for triplets . in this case , the factor of 2 is due to double counting of @xmath184 triplets . from eqs .",
    "( [ tripletprobsum])-([pairprob ] ) , the constraints on the number of pairs and triplets of the following type can be found [ compare with eqs .",
    "( [ constraintsnodes ] ) and ( [ constraintspairs ] ) ] : @xmath185        a closer inspection of the equations for the triplets shows that probabilities of two types of open quadruplet configurations occur : linear quadruplets as in fig .",
    "[ adds6 ] ( a ) and `` t - like '' quadruplets as in fig .",
    "[ adds6 ] ( b ) .",
    "note that open triplet configurations can only be linear . with the assumption of uncorrelated triplets ,",
    "linear quadruplets are approximated as follows .",
    "the joint probability of a quadruplet in state @xmath186 equals the joint probability to find a triplet in state @xmath187 multiplied by the conditional probability to have a node in state @xmath188 neighboring with @xmath189 triplet : @xmath190 neglecting the influence of @xmath31 node on @xmath188 node , the distribution of @xmath188 nodes in the neighborhood of @xmath189 triplets is approximately equal to that in the neighborhood of @xmath191 pairs : @xmath192 substitution of eq .",
    "( [ approx ] ) into eq .",
    "( [ linquad ] ) yields the closure assumption for linear quadruplets in the standard ta : @xmath193 note the resemblance of eq .",
    "( [ clolin ] ) with the closure assumption for open triplets in the standard pa : @xmath194 in both formulas the product of the probabilities ( of pairs in the pa and triplets in the ta ) is divided by the probability of the configuration in which they overlap ( a node and a pair , respectively ) .",
    "reasoning in the same way , a closure assumption for a `` t - like '' cluster depicted in fig .",
    "[ adds6 ] ( b ) , can be obtained .",
    "for example , considering a pair in state @xmath195 as the overlapping configuration the probability a `` t - like '' quadruplet becomes : @xmath196 clearly , this closure assumption is not unique as any of the three pairs @xmath197 , @xmath198 , and @xmath195 joining in the node @xmath199 is suitable as an overlapping configuration .",
    "however , they all coincide in the limit when triplets are considered to be formed by uncorrelated pairs : @xmath200    notwithstanding the closure assumption for `` t - like '' quadruplets , eq .",
    "( [ tastrong ] ) , is not unique it includes more information since the probability of a quadrupet is expessed in terms of the probabilities of triplets and pairs , unlike eq .",
    "( [ taweak ] ) where the same probability depends on the probabilities of pairs and nodes .",
    "there is no a priori reason that the ta model with eq .",
    "( [ tastrong ] ) should give a better approximation to monte carlo simulations than the same model with eq .",
    "( [ taweak ] ) and direct numerical calculation of the distribution of nodes , pairs , triplets and quadruplets in the simulations is required to check this point .",
    "however , indirect evidence of this comes from the comparison of the ta model with both types of closure assumptions for `` t - like '' quadruplets and the stochastic sirs process on rrgs in the regions where the pa model fails .",
    "we have found that the closure assumption given by eq .",
    "( [ tastrong ] ) gives a quantitative improvement over the closure given by eq .",
    "( [ taweak ] ) both for the stationary and for the time - dependent behaviors when it is faced with the exact stochastic dynamics on rrgs .",
    "qualitatively , the behavior of both ta models is similar . for @xmath48",
    "no stable oscillatory behavior is observed for small @xmath20 , and for @xmath174 the oscillatory phase becomes much smaller than in the pa model .",
    "the only difference we have been able to identify without performing the full linear analysis and calculating the whole phase diagrams of the ta deterministic models is that in the ta model with eq .",
    "( [ tastrong ] ) the oscillations are suppressed faster than in the same model with eq .",
    "( [ taweak ] ) , making the former model a better approximation for the global behavior observed in the simulations on rrgs .    in figs .",
    "[ ta_pa_rrg3 ] and [ ta_pa_rrg4 ] we compare the three models of the sirs process , namely the ta - sirs model with the closure assumptions for linear and `` t - like '' quadruplets given by eqs .",
    "( [ clolin ] ) and ( [ tastrong ] ) [ solid gray ( green ) lines ] , the pa - sirs model given in the appendix [ dashed black ( blue ) lines ] and the results of stochastic simulations ( solid black lines ) on rrgs with @xmath174 and @xmath48 , respectively . in the plots",
    "where the solid black lines can not be distinguished they are superimposed by the solid gray ( green ) lines .",
    "the differential equations were integrated numerically using the 4th order runge - kutta algorithm , and for each set of initial conditions and parameters the simulations were averaged over an ensemble of @xmath132 rrgs of given degree with @xmath134 nodes .",
    "the properties of the fluctuations around this averaged behavior are described by the numerical psnfs . for all parameter values considered below these numerical psnfs",
    "are resonant - like as in fig .",
    "[ ps_rrg4_pa ] .    , the pa model [ dashed black ( blue ) lines ] and the results of stochastic simulations ( solid black lines ) on a rrg-@xmath201 with @xmath134 nodes .",
    "all plots were obtained for @xmath135 , @xmath202 and @xmath174 .",
    "parameters : ( a ) and ( b ) @xmath203 ; ( c ) and ( d ) @xmath204 ; ( e ) and ( f ) @xmath205 . ]    in fig .",
    "[ ta_pa_rrg3 ] the evolution of susceptible ( left panels ) and infective ( right panels ) densities as a function of time is shown for three sets of parameter values that correspond to constant infection rate @xmath202 and decreasing rate of immunity waning @xmath206 ( from top to bottom ) .",
    "the values of the parameters are chosen so as to reflect the behavior of the models in three different phases in the endemic region of the phase diagram of the pa model @xcite .",
    "as regards the asymptotic behavior of the pa - sirs equations , these phases are associated with the asymptotically stable nodes , asymptotically stable foci and limit cycles ( from top to bottom ) . in the upper panels for the typical value @xmath203 we used , the steady state of",
    "the system is a stable node both for the pa and for the ta model .",
    "the solutions of both deterministic models are almost coincident with the averaged densities obtained from the stochastic simulations for this whole region .",
    "the agreement between the deterministic models deteriorates in the region where both predict a behavior corresponding to a stable focus as can be seen in the middle panels where we used @xmath204 .",
    "the steady state of the pa equations is different from the quasi - stationary state observed in the simulations while the ta model describes the dynamics accurately both in the transient and in the steady state regime .",
    "the bottom panels with @xmath205 illustrate that in the region where the pa model exhibits stable oscillatory behavior both the ta solutions and the simulation trajectories show damped oscillations towards a nontrivial equilibrium .",
    "the steady state densities given by the ta equations and the quasi - stationary densities calculated from the stochastic simulations on a rrg-@xmath201 are equal .",
    "however , in the transient regime we observe that the trajectories approach the steady state in a slightly different manner demonstrating a higher damping in the stochastic simulations .",
    "also , for @xmath174 the oscillatory phase still persists in a very small region in the endemic phase in the ta but once more this result is not confirmed by the simulations for the same parameter values [ results not shown ] .",
    "sustained oscillations , instead of resonant fluctuations , would show up as multiple peaks in the numerical psnfs , which are not observed .",
    "this suggests that a complete description of the global behavior of the sirs on a rrg-@xmath201 requires even more elaborate approximations and that the global oscillations predicted by both the pa - sirs and the ta - sirs in the thermodynamic limit are an artifact of the models .     with @xmath135 , @xmath136 for @xmath48 and rrg-@xmath43 with @xmath134 nodes .",
    "parameters : ( a ) and ( b ) @xmath207 ; ( c ) and ( d ) @xmath208 ; ( e ) and ( f ) @xmath209 . ]    fig .",
    "[ ta_pa_rrg4 ] illustrates the data as in fig .",
    "[ ta_pa_rrg3 ] with @xmath136 , and @xmath210 ( from top to bottom ) for @xmath48 and rrg-@xmath43 .",
    "these values are chosen as before to represent the different phases of the pa diagram associated with the asymptotically stable nodes , asymptotically stable foci and limit cycles ( from top to bottom ) .",
    "we observe the same comparative behavior of the models as @xmath20 decreases .",
    "the only difference is that in the case of @xmath48 the oscillatory behavior in the ta has not been identified . everywhere in the region of stable oscillations predicted by the pa model ,",
    "the ta model reaches the steady state through damped oscillations that are associated with the existence of a stable fixed point , namely a stable focus .",
    "such a dynamics of the ta - sirs model is confirmed by the results of the simulations , see the bottom panels in fig .",
    "[ ta_pa_rrg4 ] .    regarding the fluctuations , the same procedure that was used in the previous section to derive an approximate analytical expression for the psnfs based on the pa can be extended to the ta in the region where the pa model fails .",
    "an explicit construction of a detailed stochastic ta model is cumbersome but straightforward , and once the master equation is written down the analytical psnfs can be computed using van kampen s system size expansion and then the general formula ( [ psnfgeneral ] ) . according to the results for the pa model",
    ", we expect the analytical psnfs obtained in this way to approximate well the numerical power spectra in the parameter regions of the middle panels in fig .",
    "[ ta_pa_rrg3 ] .",
    "we also expect a fair approximation in the parameter regions of the bottom panels of the same figure .",
    "the standard pa is known to perform poorly for lattice - based stochastic models but it gives in general good results for large rrgs due to the local tree - like structure of these graphs . taking a simple epidemic model as an example , we have used the pa to derive the master equation of the corresponding stochastic process on a rrg and an approximate analytical expression for the power spectrum of the fluctuations in the quasi - stationary state . we have checked the agreement of the analytical power spectrum in the pa against numerical simulations and found that whenever the behavior of the system in the thermodynamic limit is well described by the pa deterministic equations , the analytical power spectrum also describes accurately the fluctuations observed in long simulations .",
    "this happens in a large region of parameter space .",
    "however , as @xmath211 approaches the phase boundary @xmath212 the quality of the pa deteriorates , and it is necessary to switch to higher order cluster approximations in order to obtain even qualitative agreement between the model equations and the simulations .",
    "we have shown that a ta with a standard closure assumption yields an accurate description of the behavior of the system in the thermodynamic limit in a @xmath211 range where the pa breaks down . for finite systems ,",
    "the fluctuation power spectrum can be computed analytically as before from the master equation of the stochastic process that corresponds to the ta .    for small values of @xmath211 ,",
    "long simulations require very large system sizes .",
    "for the smallest @xmath211 we have explored we found indications of the breakdown of the ta , and that clusters of order higher than three would have to be considered . as the order of the cluster approximation increases , however , the no loop assumption that is an ingredient of the construction of the detailed stochastic model becomes less accurate .",
    "extension of this method to smaller values of @xmath211 through higher order clusters would have to be combined with more complicated closure assumptions .",
    "the parameter range explored in this paper is relevant to childhood infectious diseases modeling .",
    "published estimates for the epidemiological parameters of measles , whooping cough , rubella and chicken pox , see ref .",
    "@xcite , correspond in the sirs model to @xmath20 in the range @xmath213 assuming that the average immunity waning period can be taken as the typical duration of basic school .",
    "our results show that the oscillatory phase that implicitly spatial models such as the pa - sirs and the ta - sirs exhibit in the thermodynamic limit can not be directly related with the recurrent epidemic peaks found in many data sets @xcite .",
    "however , they also show that once stochastic effects are taken into account , the model predicts a well defined bell - shaped high amplitude fluctuation spectrum reproducing the qualitative features of typical time patterns of real data for this class of endemic diseases .",
    "financial support from the foundation of the university of lisbon and the portuguese foundation for science and technology ( fct ) under contract no .",
    "pocti / isfl/2/618 is gratefully acknowledged . the first author ( g.r . )",
    "was also supported by fct under grant no .",
    "sfrh / bd/32164/2006 and by calouste gulbenkian foundation under its program `` stimulus for research . ''",
    "throughout the main text the node and pair probabilities are denoted as @xmath214 and @xmath215 , where the small greek letters stand for states @xmath15 , @xmath16 , and @xmath17 .",
    "we extend this notation for open linear triplet and quadruplet probabilities , @xmath216 and @xmath217 , respectively , while in the probabilities of open `` t - like '' quadruplets the clusters are depicted explicitly .    substituting @xmath218 in the set below yields the pa - sirs deterministic equations @xcite : @xmath219-k\\lambda p(si ) \\ , \\\\",
    "\\dfrac{dp(i)}{dt}&=&k\\lambda p(si)-\\delta p(i ) \\ , \\nonumber\\\\ \\dfrac{dp(si)}{dt}&=&\\gamma p(ri)-\\delta p(si ) -\\lambda p(si)+ \\nonumber\\\\ & + & \\lambda(k-1)[2p(ssi)+p(rsi)-p(si ) ] \\ , \\nonumber\\\\ \\dfrac{dp(sr)}{dt}&=&\\delta p(si)- \\lambda(k-1 ) p(rsi)+\\nonumber\\\\ & + & \\gamma[1-p(s)-p(i)-p(ri)-2p(sr ) ] \\ , \\nonumber\\\\ \\dfrac{dp(ri)}{dt}&=&\\delta\\left[p(i)-p(si)-2p(ri)\\right]-\\gamma p(ri)+\\nonumber\\\\ & + & \\lambda ( k-1 ) p(rsi ) \\ .\\nonumber\\end{aligned}\\ ] ]    the steady state solutions of the pa - sirs equations can be obtained analytically .",
    "let @xmath220 , @xmath112 and @xmath221 , @xmath222 , @xmath223 denote the endemic steady state values of the node and pair densities of the pa - sirs model , then the jacobian matrix @xmath109 of the linearized system is written as    @xmath224    where we introduced the constants @xmath225 @xmath226 @xmath227 and @xmath228 in the ta of the sirs process , we complement eq .",
    "( [ paeq ] ) in which the probabilities of the triplets are retained with the equations for the triplet probabilities as described in the main text .",
    "j.  ziman , _ models of disorder : the theoretical physics of homogeneously disordered systems _",
    "( cambridge university press , cambridge , 1979 ) .",
    "the assumption on which the following deduction relies is the one used in the standard deterministic pa . strictly speaking",
    ", it implies the complete absence of closed loops in a rrg-@xmath14 which is , of course , not realizable in practice .",
    "however , the classical results of graph theory show that in the thermodynamic limit the average expected number of short loops of length @xmath229 , which are known to have the greatest effect on the performance of the pa , is given by @xmath230 with poisson fluctuations around the mean , so that it is negligibly small .",
    "these results are in a good agreement with the numerical values obtained from an ensemble of finite rrgs with @xmath13 ranging from @xmath231 to @xmath232 nodes we generate in the simulations .",
    "a.  steger and n.  c.  wormald , combinatorics , probab .",
    "comput . * 8 * , 377 ( 1999 ) ; j.  h.  kim and v.  h.  vu , _ stoc 2003 : proceedings of the 35th annual acm symposium on theory of computing _",
    "( acm , new york , 2003 ) , p. 213"
  ],
  "abstract_text": [
    "<S> in this paper , we consider a simple stochastic epidemic model on large regular random graphs and the stochastic process that corresponds to this dynamics in the standard pair approximation . </S>",
    "<S> using the fact that the nodes of a pair are unlikely to share neighbors , we derive the master equation for this process and obtain from the system size expansion the power spectrum of the fluctuations in the quasi - stationary state . </S>",
    "<S> we show that whenever the pair approximation deterministic equations give an accurate description of the behavior of the system in the thermodynamic limit , the power spectrum of the fluctuations measured in long simulations is well approximated by the analytical power spectrum . </S>",
    "<S> if this assumption breaks down , then the cluster approximation must be carried out beyond the level of pairs . </S>",
    "<S> we construct an uncorrelated triplet approximation that captures the behavior of the system in a region of parameter space where the pair approximation fails to give a good quantitative or even qualitative agreement . for these parameter values , </S>",
    "<S> the power spectrum of the fluctuations in finite systems can be computed analytically from the master equation of the corresponding stochastic process . </S>"
  ]
}