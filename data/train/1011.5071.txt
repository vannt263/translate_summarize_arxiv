{
  "article_text": [
    "many fluid flows of interest in engineering and geophysical fluid dynamics have low mach number ( @xmath5 ) and small relative density variations @xmath6 , where @xmath7 is a typical velocity scale , @xmath8 is the speed of sound , @xmath9 is the density and @xmath10 a reference density .",
    "it has been common practice over the past century to regard such flows as incompressible or weakly compressible , where an incompressible fluid is one whose density dependence upon pressure is eliminated while still possibly retaining its dependence upon temperature ( and chemical composition as the case may be ) , e.g. , @xcite .",
    "there has been much effort in seeking to take advantage of the smallness of the two above parameters to develop sound - proof reduced sets of equations that are somehow simpler to study than the fully compressible navier - stokes equations .",
    "two particular classes of approximations have been particularly influential and key to simplifying the numerical and theoretical analysis of low mach number fluid flows , and will be under focus in this paper .",
    "the first one is the oberbeck - boussinesq approximation ( after @xcite and @xcite ) , which in its most common form retains only the rotational divergence free component of the velocity field , and treats the density as constant everywhere except where it multiplies the acceleration of gravity .",
    "the second one is the anelastic approximation , e.g. , @xcite .",
    "many other sets can be constructed , which are beyond the scope of this paper , for instance by using low mach number asymptotics and multi - scale expansion techniques , e.g. , @xcite .",
    "@xcite offers a review of a number of commonly employed reduced sound - proof sets of equations , and show how they respectively represent normal modes on the sphere .    the main focus of this paper is on how compressible effects and the coupling between mechanical energy and internal energy ( the dynamics / thermodynamics coupling ) are represented in the boussinesq / anelastic approximations , which are known to decouple either fully or almost fully the thermodynamics from the dynamics for adiabatic motions and a linearised equations of state , i.e. , @xcite . in the latter case , the boussinesq / anelastic approximations usually admit a well - defined conservative energy quantity , e.g. , @xcite , but the issue of the energetic and thermodynamic consistency appears to be much less understood when diabatic effects and/or a nonlinear equation of state are retained , because the thermodynamics / dynamics coupling then becomes less trivial . in this respect ,",
    "the oceanographic case is instructive , as oceanographers have used the boussinesq hydrostatic approximation in conjunction with a realistic nonlinear equation of state ( including the pressure dependence ) for many decades as the basis for numerical ocean general circulation models of the kind used in climate studies , without any apparent obvious drawbacks apart from the lack of a well - defined and closed energy budget , see @xcite . since boussinesq ocean models appear to work well with a `` compressible '' equation of state , one may wonder how essential the assumptions of `` incompressibility '' or `` weak compressibility '' are in the construction of the boussinesq and anelastic approximations in the first place .    to clarify this issue ,",
    "a thermodynamics perspective is useful .",
    "indeed , from a thermodynamic viewpoint , the very idea that it might be possible to simplify a particular equation of state to eliminate its dependence upon pressure while retaining its dependence upon temperature appears to become very dubious if not outright physically meaningless when diabatic effects are retained .",
    "this is because the way changes in density are affected by pressure changes depends critically on the particular thermodynamic transformation undergone by the fluid parcels .",
    "take an isothermal transformation for instance .",
    "@xcite shows that the isothermal compressibility @xmath11 is linked to the adiabatic compressibility @xmath12 ( his eq .",
    "a.6 ) by : @xmath13 where @xmath14 is the adiabatic lapse rate .",
    "the key point here is that setting up the adiabatic compressibility to zero ( by taking the zero mach number limit @xmath15 ) , while it makes the fluid effectively `` incompressible '' for adiabatic motions , fails in general to do so for nondiabatic transformations if the thermal expansion coefficient @xmath16 is allowed to remain nonzero .",
    "note that for seawater , typical values are : @xmath17 , whereas @xmath18 , using @xmath19 , @xmath20 , @xmath21 , and @xmath22 .",
    "for these values , the limit @xmath15 decreases the isothermal compressibility by about two to three orders of magnitude , so that even if it fails to fully eliminate compressibility effects for non - adiabatic motions , it appears nevertheless capable of reducing them considerably .",
    "this being said , if one agrees that the very concept of an `` incompressible '' fluid becomes physically meaningless when diabatic effects are retained , then one may also agree that it might not be that essential to set up the adiabatic compressibility to zero in the first place .",
    "historically , the latter approach was originally motivated as a natural way to filter out sound waves , but it is now recognised that imposing @xmath15 is not necessarily to filter out sound waves , as such a filtering can be more simply achieved by using a hydrostatically adjusted pressure in the equation of state for density , as discussed by @xcite .    whether boussinesq / anelastic models accurately represent the conversions between mechanical energy and internal energy recently came to attention in relation with the question of how strong would the oceanic overturning circulation and meridional heat transport be , and how much diapycnal mixing would then be supported , if it were possible somehow to suppress the mechanical stirring due to the wind and tides , which has been a controversial issue for the past decade , as reviewed in @xcite , @xcite and @xcite .",
    "the resulting configuration is often referred to as horizontal convection , see @xcite for a recent review on the subject .",
    "the reason why understanding the nature of the thermodynamics / dynamics coupling is important in that case is because the steady - state mechanical energy balance reduces to : @xmath23 which shows that in order to estimate the overall viscous dissipation rate , one has to estimate the overall work of expansion / contraction , where @xmath2 is the pressure , @xmath3 is the specific volume , @xmath24 is the elementary mass element of a fluid parcel , and @xmath25 is the viscous dissipation rate . as discussed by @xcite , the issue of estimating @xmath26 for a fully compressible fluid is a subtle one . as shown by @xcite and others ,",
    "considerable analytical progress can be achieved for a boussinesq fluid with a linear equation of state , as in that case , eq .",
    "( [ real_me ] ) becomes : @xmath27 ,       \\label{boussinesq_me}\\ ] ] which can be integrated analytically , where @xmath28 is the molecular diffusivity , @xmath29 the acceleration of gravity and the terms within brackets are the surface area integrated density at the bottom and top of the oceans respectively .",
    "using typical oceanic values , @xcite estimated the right - hand side to be @xmath30 , which is at least two orders of magnitude smaller than the mechanical power input due to the wind and tides for instance .",
    "the smallness of this number have been widely interpreted as evidence that the surface buoyancy fluxes could not by themselves be responsible for an overturning circulation and associated meridional heat transport of the observed magnitude .    the smallness of the r.h.s . of eq .",
    "( [ boussinesq_me ] ) had been previously interpreted in the context of stratified turbulence ( following @xcite ) as implying that conversions between internal energy and mechanical energy enter the energetics of turbulent stratified mixing only at second order .",
    "@xcite argued , however , that the apparent smallness of the thermodynamic / coupling in boussinesq stratified turbulence actually hides two large and opposite conversions between internal energy ( ie ) and gravitational potential energy ( gpe ) that almost exactly cancel out , viz .",
    ", one conversion transferring ie into background gpe , associated with the smoothing out of the vertical reference temperature gradient and a significant overall volume reduction ( assuming that @xmath16 increases with temperature , as is the case for water ) , the other conversion dissipating available gpe into ie in a way analogous to the viscous dissipation of kinetic energy ( ke ) into ie , and associated with the increase of the mean thermodynamic equilibrium temperature of the fluid but with only a negligible overall volume expansion .",
    "these results suggest therefore that compressibility effects must increase with the degree of stratification and turbulence , which appears to be supported empirically by the kind of laboratory experiment illustrated in fig .",
    "[ set_up ] , but have yet to be widely accepted , as most subsequent studies so far , e.g. , @xcite continue to favour the classical view that internal energy and thermodynamics / dynamics coupling play only a minor role in the energetics of turbulent stratified mixing .",
    "at least two important misconceptions about weakly compressible fluids appear to greatly confuse the understanding of the role of compressible effects in stratified turbulent fluids .",
    "the first misconception is associated with the widespread ( erroneous ) belief that a weak thermodynamics / dynamics coupling is an intrinsic feature of all weakly compressible fluids irrespective of the particular thermodynamic transformations undergone by fluid parcels , whereas as far as we can judge , such a weak coupling is an intrinsic feature of _ adiabatic _ motions only , with no physical basis for this to be the case for diabatic motions .",
    "the second misconception is associated with the widespread confusion about what a `` weakly compressible '' or `` incompressible '' fluid is actually supposed to be .",
    "should such a property pertain to a fluid whose density dependence on pressure is eliminated , as seems to have been the original intention , e.g. , @xcite , or with the use of the constraints @xmath31 or @xmath32 , as seems to be increasingly assumed following the realization that boussinesq and anelastic fluids can be used with nonlinear equations of state ? based on the present analysis , the idea of an incompressible fluid seems to be justified only for a fluid with zero adiabatic compressibility in the context of purely adiabatic motions , but physically meaningless otherwise .",
    "physically , the constraints @xmath33 and @xmath32 do not imply incompressibility or weak compressibility , in contrast to what is often assumed , because they do not preclude diabatic or adiabatic density changes along fluid trajectories . the new view that emerges from the above arguments is that the boussinesq and anelastic approximations are actually able to support potentially large compressible effects and conversions between internal energy and mechanical energy .",
    "if so , this raises many questions that the present paper seeks to clarify .",
    "1 ) how do the conversions between internal energy and mechanical energy in a boussinesq / anelastic fluid compare with that of a fully compressible fluid ? does the answer depend on whether diabatic effects and/or a nonlinear equation of state are retained ?",
    "2 ) do the boussinesq and anelastic approximations conform with the first and second laws of thermodynamics ? what is the form of the thermodynamic potentials supported by such approximations ?",
    "how different are they from their exact counterparts ?",
    "3 ) is it an intrinsic problem that many boussinesq and anelastic models fail to be energetically and thermodynamically consistent , or can such models be modified to correct the problem ?",
    "in the latter case , can this be done without modifying the formal order of accuracy of the original boussinesq / anelastic approximations ?",
    "the main purpose of this paper is to provide an answer to all above questions , by showing that the boussinesq and anelastic approximations can be endowed with well defined energetics and thermodynamics that closely mimic that of the fully compressible navier - stokes equations .",
    "a couple of recent papers have touched upon some of these issues .",
    "thus , @xcite showed , using ideas previously developed by @xcite , that the seawater boussinesq equation have a well - defined conserved energy quantity for an arbitrary nonlinear equation of state , although whether this extends to the diabatic case is not clear .",
    "@xcite addressed a similar issue for the anelastic approximation for a binary fluid such as moist air , also with a highly nonlinear equation of state , and discussed energy and thermodynamic consistency issues .",
    "the above studies , however , did not clearly address the nature of the conversions between mechanical energy and internal energy , which is then addressed here in details .",
    "section 2 provides the general theory .",
    "section 3 applies the result to elucidating the thermodynamics of a boussinesq fluid with a linear equation of state that has been widely used recently in numerical study of turbulent mixing , as well as in the context of horizontal convection .",
    "section 4 discusses the case of the boussinesq primitive equations currently used in numerical ocean models .",
    "section 5 summarises and discusses some implications of the results .",
    "to help set up the context and the motivation for the present work , it is useful to provide some specific examples of energetically and thermodynamically inconsistent boussinesq approximations , which have played and often continue to play a key role in the theoretical and numerical study of many fluid flows of interest in traditional and geophysical fluid dynamics .",
    "the first boussinesq model of interest is one that is meant to approximate fluids with an equation of state close to linear , retaining all physical processes apart from sound waves from the largest scales down to the molecular diffusive and dissipative scales .",
    "its governing equations are : @xmath34 @xmath35 @xmath36 @xmath37 ,       \\label{eos_model1}\\ ] ] where @xmath38 is the three - dimensional velocity field , @xmath39 is the pressure anomaly defined relative to the reference boussinesq pressure @xmath40 , @xmath9 is the density , @xmath41 is the temperature , @xmath10 and @xmath42 are reference constant density and temperature , @xmath43 is the unit normal vector pointing upwards in the direction opposite to gravity , and @xmath29 is a nominal value of the acceleration of gravity .",
    "although such a model is neither energetically nor thermodynamically consistent , as made clear in this paper , it has nevertheless been extensively used in recent theoretical discussion of the energetics of horizontal convection , e.g. , @xcite , @xcite and @xcite , as well as in discussing the energetics of turbulent mixing in stratified fluids by @xcite .",
    "moreover , such a model also forms the basis for numerous direct numerical simulations of stratified turbulence , in the sense that in such studies , both @xmath28 and @xmath44 are usually interpreted as representing the molecular values of diffusivity and viscosity respectively . from a thermodynamic viewpoint , the physical meaning of the temperature @xmath41 is ambiguous , since it is conserved for adiabatic motions as if it were potential temperature , while also being homogenised by molecular diffusion as if it were in - situ temperature .",
    "regarding pressure , it can be written as the sum of a purely hydrostatic component plus a perturbation @xmath45 that can be regarded as the lagrange multiplier associated with the incompressibility condition @xmath33 , and hence differs from the thermodynamic pressure .",
    "a second important class of boussinesq model is that associated with the kind of hydrostatic primitive equations model that has formed the basis for most numerical ocean models currently in used for climate change studies .",
    "an early formulation , following that introduced by @xcite , is the following : @xmath46 @xmath47 @xmath48 @xmath49 @xmath50 @xmath51 where @xmath52 is the horizontal velocity field , @xmath53 is the vertical velocity , @xmath54 is the horizontal nabla operator , @xmath55 and @xmath56 represents horizontal and vertical turbulent eddy viscosities , while @xmath57 and @xmath58 represent horizontal and vertical turbulent eddy diffusivities . here , the full nonlinear equation of state for seawater is used , and is usually formulated in terms of salinity @xmath59 , potential temperature @xmath60 and pressure @xmath2 . regarding the latter , it is worth pointing out that there is currently much debate about whether the boussinesq pressure @xmath40 or the full hydrostatic pressure @xmath2 should be used in the equation of state , see @xcite for a discussion of this point . note that turbulent closure schemes in modern versions of primitive equations models are in general significantly more sophisticated than in the above model , see @xcite for a detailed discussion of current numerical ocean model formulations . until very recently , it was generally thought impossible for boussinesq primitive equations models such as the one above to admit a closed energy budget when using a nonlinear equation of state ; as a result",
    ", numerical and empirical considerations must have been key in controlling the energetics of current numerical implementations of numerical ocean models and hence their numerical stability .",
    "the first step toward constructing an energetically and thermodynamically consistent boussinesq / anelastic approximation for an arbitrary nonlinear equation of state is to clarify the nature of the coupling between the dynamics and thermodynamics in a boussinesq / anelastic fluid . in a real fluid ,",
    "such a coupling is achieved via the work of expansion / contraction which occurs through the term @xmath61 , where @xmath2 is the total pressure , and @xmath3 the specific volume . to fix ideas ,",
    "we examine the issue in the context of the following set of equations , which is based on that previously considered by @xcite and @xcite : @xmath62 @xmath63 @xmath64 @xmath65 @xmath66 the above system of equations is sufficiently general that it also includes the usual boussinesq approximation @xmath67 as a particular case , as is easily verified . for that reason , eqs .",
    "( [ v_equation]-[eos ] ) will be hereafter referred to as the _ boussinesq - anelastic _ system , or _",
    "system for short , where @xmath68 is the specific entropy , @xmath59 is salinity , @xmath29 is a constant acceleration of gravity , @xmath69 is the geopotential height , so that @xmath70 is the geopotential , and @xmath71 is the stress tensor .",
    "the terms @xmath72 and @xmath73 are used as short - hand to denote the diabatic effects affecting @xmath68 and @xmath59 .",
    "these are further specified in terms of an entropy flux @xmath74 and irreversible entropy production term @xmath75 in eq .",
    "( [ eta_equation ] ) , which is the expression of the second law of thermodynamics , as well as in terms of a salt flux in eq .",
    "( [ s_equation ] ) , so that salt is assumed to be a conservative quantity .",
    "it is important to remark at this stage that the definition of buoyancy @xmath76 is the one that is the most commonly encountered in the literature .",
    "this differs , however , from the form @xmath77 assumed by @xcite and @xcite .",
    "as shown in this paper , it turns out that the form used by @xcite and @xcite is the one that should be used in practice , and the one that is the most energetically and thermodynamically consistent .    before proceeding",
    ", it seems important to point out that although @xcite s derivation of the above ba system initially assumes the reference pressure @xmath78 to satisfy the classical hydrostatic balance @xmath79 , this is no longer the case in the final energy conserving form of the equations .",
    "indeed , in absence of fluid motion , setting @xmath2 and @xmath9 to zero in eq .",
    "( [ v_equation ] ) shows that @xmath78 and @xmath10 must actually be solution of : @xmath80 which can be immediately integrated as : @xmath81 , where @xmath82 is the assumed constant and spatially uniform atmospheric pressure at @xmath83 .",
    "this form is identical to the boussinesq reference pressure , except for a non - constant @xmath10 .",
    "this in turn implies that : @xmath84 where @xmath85 is the reference pressure in hydrostatic equilibrium with @xmath10 , which shows that the relative error in @xmath78 as compared to @xmath85 , i.e. , @xmath86 , and is therefore small by assumption .",
    "therefore , even though the anelastic approximation attempts to relax the incompressibility constraint of the boussinesq approximation , @xcite s energy conserving form does so at the price of distorting the hydrostatic modes of motions , so that it would be of interest to study the dynamical consequences of the ba system in more details , for instance by following @xcite s approach .",
    "the issue of whether the distortion of the hydrostatic modes , which is not discussed in @xcite , could invalidate the approach is beyond the scope of this paper , which is primarily concerned with thermodynamic and energetic consistency issues .    in order to discuss the energetics of the ba system , our starting point is the evolution equation for the kinetic energy , obtained in the usual way by multiplying eq .",
    "( [ v_equation ] ) by @xmath87 , which after some manipulation can be written as follows : @xmath88 where the work against the stress tensor has been written as @xmath89 as the difference between the divergence of a flux term minus the viscous dissipation term .",
    "for instance , in the special case where @xmath90 , then @xmath91 and @xmath92 . over the past decade , a number of studies by @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite all followed a similar approach in seeking to establish the energetic consistency of the above ba system , with the studies differing only in minor details and in the particular set of equations considered . specifically , all these studies approached the problem by introducing the following function : @xmath93 obtained by vertically integrating the buoyancy @xmath94 regarded as a function of @xmath69 and of the adiabatically conserved variables , so that : @xmath95 where @xmath96 then , summing eqs .",
    "( [ ke_equation ] ) and ( [ h_equation ] ) yields @xmath97 because the right - hand side @xmath98 of eq .",
    "( [ energy_conservation_previous ] ) obviously vanishes for adiabatic and inviscid motions , it may be concluded that the quantity @xmath99 should be regarded as the relevant energy quantity being conserved in absence of diabatic and viscous effects .",
    "note that the energy quantity thus constructed is non - unique , since it involves the arbitrary constant of integration @xmath100 as discussed by @xcite . in the context of the boussinesq approximation",
    ", both @xcite and @xcite chose @xmath101 and referred to @xmath102 as the `` dynamic enthalpy '' and `` effective potential energy '' respectively .",
    "the above proof is incomplete , however , because establishing the energy consistency of the ba system actually requires : ( 1 ) identifying the quantity playing the role of the total energy ; ( 2 ) demonstrating that the total energy thus identified is a conservative quantity for both diabatic and adiabatic motions . by contrast , all what the above arguments manage to establish is that the `` adiabatic '' energy @xmath103 is a conservative quantity for adiabatic motions only .",
    "when diabatic effects are retained , this adiabatic quantity is obviously created or destroyed owing to the r.h.s .",
    "( [ energy_conservation_previous ] ) becoming non - zero , and hence no longer conservative .",
    "in that case , the principle of energy conservation calls for the existence of an additional energy quantity @xmath104 obeying an equation of the type : @xmath105 involving some energy flux @xmath106 to be determined , as upon summation with eq .",
    "( [ energy_conservation_previous ] ) , the following conservation equation is obtained @xmath107 which now states that the energy quantity @xmath108 is conservative for both diabatic and adiabatic motions , and hence the natural candidate to play the role of the total energy in the ba system .",
    "physically , the above approach casts the discussion of energetics in terms of the interactions between the adiabatic energy @xmath109 and the diabatic energy @xmath104 .",
    "while legitimate and sometimes useful ( as attested by the papers by @xcite and @xcite for instance ) , this approach can not be regarded as entirely satisfactory , since : 1 ) the adiabatic and diabatic energies are fundamentally ill defined quantities , given that equally valid alternatives can be obtained by adding and subtracting any arbitrary function of @xmath59 and @xmath68 from the former and to the later respectively ; 2 ) the approach does not appear to be naturally linked to the classical description in terms of interactions between kinetic energy , gravitational potential energy and internal energy .",
    "for instance , can we regard the sum @xmath110 as equal to the sum of gravitational potential energy and internal energy , as for actual fully compressible fluids ?",
    "how do energy conversions in the ba system compare with that of a fully compressible fluid ?    to address the above questions ,",
    "a fundamentally different approach is clearly needed .",
    "if we are to understand the coupling between mechanical energy and internal energy in the ba system , it seems necessary to first identify what is the relevant expression for the mechanical energy , and then look for its evolution equation in order to determine how it couples with the internal energy .",
    "the most natural definition for the later appears to be : @xmath111 = \\rho_0 { \\bf v}^2/2 + ( \\rho-\\rho_0)g_0(z - z_0)$ ] ( for some reference geopotential height @xmath112 ) , for which an evolution equation can be obtained from the kinetic energy equation ( [ ke_equation ] ) as follows : @xmath113 +     \\nabla \\cdot ( \\delta p { \\bf v } - \\rho_0 { \\bf f}_{ke } )      = -\\rho_0 ( z - z_0 ) \\frac{db}{dt }      - \\rho_0 \\varepsilon_k ,    \\label{anelastic_em1}\\ ] ] or equivalently , in conservative form :",
    "@xmath114 =       -\\rho_0 ( z - z_0 ) \\frac{db}{dt } -\\rho_0 \\varepsilon_k .",
    "\\label{anelastic_em2}\\ ] ] for comparison , the corresponding evolution equation for the mechanical energy in a fully compressible fluid takes the form : @xmath115 + \\nabla \\cdot \\left ( p { \\bf v } - \\rho { \\bf f}_{ke } \\right )    = \\rho p \\frac{d\\upsilon}{dt } - \\rho \\varepsilon_k .",
    "\\label{compressible_em}\\ ] ] in a compressible fluid , mechanical energy and internal energy are coupled in mainly two ways : ( i ) via a reversible conversion between internal energy and kinetic energy accomplished by the work of expansion / contraction @xmath116 ; ( ii ) the irreversible dissipation of kinetic energy into heat by viscous processes @xmath117 , as seen in the r.h.s .",
    "( [ compressible_em ] ) .",
    "since viscous dissipation is obviously present in both eqs .",
    "( [ anelastic_em1 ] ) and ( [ compressible_em ] ) , the only question that needs addressing is whether the following equivalence can be established ?",
    "@xmath118 to see that this is indeed the case , we expand the pressure and specific volume as follows : @xmath119 which uses the underlying assumption in the boussinesq and anelastic approximations that @xmath120 .",
    "this implies in turn that at leading order , the work of expansion / contraction can be approximated by : @xmath121 @xmath122 eq . ( [ pv_result ] ) shows that the equivalence eq .",
    "( [ correspondance ] ) is exact in the boussinesq case @xmath67 , but only approximate in the anelastic case because of the term proportional to @xmath123 .",
    "this suggests , therefore , that the term @xmath124 is the natural counterpart of the compressible work @xmath125 for a compressible fluid .",
    "the possibility to identify @xmath0 with @xmath126 is a key result of this paper , for it points to a natural way to construct the whole range of known thermodynamic potentials for a ba fluid , as shown in the next subsection [ thermo_ba ] . to be fair , the identification of @xmath0 with @xmath126 is not entirely new , since it was pointed out in earlier studies such as @xcite , @xcite and @xcite for the kind of boussinesq fluid with a linear equation of state discussed in section [ linear_eos ] . as far as we are aware , however , its consequences for constructing thermodynamically consistent boussinesq and anelastic approximations do not appear to have been realized until now .",
    "physically , eq .",
    "( [ correspondance ] ) can be interpreted as expressing the fact that in a ba fluid , the compressible work manifests itself through the apparent changes in gravitational potential energy due to the apparent changes in the mass element @xmath127 , which is possible since a ba fluid conserves the reference mass element @xmath128 rather than @xmath129 .",
    "having established in the previous section that the energetics of both the boussinesq and anelastic equations possess a term that can be identified as a conversion between internal energy and mechanical energy , it then becomes relatively straightforward to show that this can be used to construct energetically and thermodynamically consistent ba system of equations . to that end , let us first recall that a basic tenet of classical equilibrium thermodynamics is that the specific internal energy @xmath130 of any fluid in local thermodynamic equilibrium ( lte ) can be regarded as a function of state whose value is independent of the thermodynamic path followed , where @xmath68 is the specific entropy , @xmath59 is salinity ( the argument would also work if @xmath59 was the total mixing ratio , as for the case of moist air considered by @xcite ) , and @xmath3 is the specific volume .",
    "as is well known , this implies that the reversible work transfer @xmath131 and generalised heat transfer @xmath132 entering the total differential of @xmath133 , viz .",
    ", @xmath134 can not be specified independently of each other . in classical equilibrium thermodynamics ,",
    "this interdependence is imposed by the so - called maxwell relationships , which simply express the result that the cross - derivatives with respect to two different variables must be equal for twice continously differentiable functions . in the present case",
    ", the assumption that @xmath133 is a function of the thermodynamic state only implies that : @xmath135 which in turn implies the following three maxwell relationships : @xmath136 the above remarks suggest that the simplest way to ensure that the ba system is energetically and thermodynamically consistent is to ensure that the approximation to the generalised heat transfer , denoted here by @xmath137 , is similarly linked via relevant maxwell relationships to the approximation to the work transfer identified previously , viz .",
    ", @xmath138 where the subscript _ ba _ was used to denote the approximation to the generalised ` heat variables and functions ' @xmath41 , @xmath68 , @xmath139 and @xmath59 .",
    "if so , this would in turn allows one to regard the following expression : @xmath140 as the natural counterpart of the fundamental relation of thermodynamics eq .",
    "( [ fundamental_relation ] ) , and hence as the total differential of the relevant approximation to the internal energy of the ` ba fluid ' , for which the natural variables are entropy @xmath68 , salinity @xmath59 , and buoyancy @xmath94 . in practice , however , it is often more convenient to work with pressure @xmath2 as a dependent variable rather than specific volume , as well as with temperature @xmath41 rather than entropy @xmath68 , which motivates the introduction of additional thermodynamic potentials constructed from eq .",
    "( [ fundamental_relation ] ) by means of the legendre transform , e.g. , @xcite .",
    "the most common thermodynamic potentials that are also the most relevant for the present work are the specific enthalpy @xmath141 and the gibbs free energy @xmath142 , whose natural dependent variables are @xmath143 and @xmath144 respectively . from eq .",
    "( [ eba ] ) , it is easy to convince oneself that the corresponding approximations to @xmath145 and @xmath146 are given by : @xmath147 and @xmath148 , with the following total differentials : @xmath149 = t_{ba }    { \\rm d}\\eta_{ba } + \\mu_{ba } { \\rm d}s_{ba } - b { \\rm d}z    \\label{ba_enthalpy}\\ ] ] @xmath150     = - \\eta_{ba } { \\rm d}t_{ba } + \\mu_{ba } { \\rm d}s_{ba } - b { \\rm d}z .    \\label{ba_gibbs}\\ ] ] until now , the above considerations have remained rather formal , and while they indicate that it is in principle possible to construct the full range of known thermodynamic potentials for a ba fluid , they have not addressed the issue of how such potentials might be constructed in practice . to simplify notations , we will usually refrain from using the suffix @xmath151 for the dependent variables in the following",
    ". we should keep in mind , however , that all thermodynamic variables used in the context of the boussinesq / anelastic approximations are fundamentally different , even if possibly only very slightly in numerical values , from their actual counterparts .",
    "in the previous approaches by @xcite , @xcite , @xcite and @xcite , authors have generally assumed the buoyancy @xmath152 to be given as a function of the dependent variables considered , typically entropy , salinity and geopotential height @xmath69 . from eq .",
    "( [ ba_enthalpy ] ) , this can be integrated with respect to @xmath69 , viz .",
    ", @xmath153 for some reference geopotential height @xmath112 , traditionally taken at the ocean surface in the oceanic case , but this only provides an expression for the specific enthalpy up to an indeterminate function of entropy and salinity , which can not be specified without additional thermodynamic information about the fluid .    the above problem arises because the knowledge of density alone is insufficient to specify all possible thermodynamic quantities ; the heat capacity , for instance , can not be inferred from density . on the other hand , many thermodynamic potentials have the property of encapsulating all known thermodynamic knowledge about a given fluid , as discussed by @xcite . in the following ,",
    "we show how to obtain the relevant approximations to the boussinesq / anelastic system directly from two such thermodynamic potentials , the gibbs function and the enthalpy .      given the similarity of the approximate and exact differentials for the internal energy , enthalpy , and gibbs free energy , it is natural to ask whether it is possible to compute the approximate thermodynamic potentials from their exact counterparts , rather than by integrating the total differential of the approximate thermodynamic potentials .",
    "that this is indeed the case is shown first for the gibbs free energy , which is the thermodynamic potential currently chosen to express all the thermodynamic properties for seawater in the latest standard recently adopted by unesco , see @xcite , as advocated earlier by @xcite for instance . to that end , let us introduce the following function : @xmath154 and verify that its total differential agrees with the above differential relationship for the approximate gibbs function , where @xmath155 is the exact gibbs free energy expressed in terms of its natural variables @xmath41 , @xmath59 and @xmath2 .",
    "note that the approximate pressure used in eq .",
    "( [ gba_trial ] ) is the pressure @xmath85 in hydrostatic balance with @xmath10 , not the anelastic reference pressure @xmath156 . from the result that @xmath157",
    ", it follows that the total differential of @xmath158 is given by : @xmath159 where we used @xmath160 , and where the tilde quantities are estimated for the reference pressure @xmath161 instead of the actual pressure , so that @xmath162 , @xmath163 and @xmath164 .",
    "( [ gba_differential ] ) is obviously consistent with eq .",
    "( [ ba_gibbs ] ) provided that @xmath165 , @xmath166 and @xmath94 be defined by : @xmath167 the key result here is that while @xmath165 and @xmath166 are found to be identical to their natural tilded expressions , the density @xmath9 initially used to defined the buoyancy @xmath76 is on the other hand found to differ from its natural tilded expression @xmath168 , as eq .",
    "( [ main_results ] ) shows that : @xmath169 which implies that : @xmath170 interestingly , the definition of the buoyancy in eq .",
    "( [ main_results ] ) is identical to the one recently proposed by @xcite and @xcite , but differs from the definition usually adopted in most numerical ocean general circulation models as far as we know .    as seen above",
    ", the knowledge of @xmath158 is sufficient by itself to determine all possible thermodynamic potentials .",
    "thus , the expressions for the specific internal energy and enthalpy are given by : @xmath171 @xmath172 which provide expressions for the specific internal energy and enthalpy in terms of the gibbs function natural variables @xmath41 , @xmath59 , and @xmath69 , rather than in terms of @xmath133 and @xmath145 s natural variables .",
    "it is easily verified that the total differential for @xmath173 and @xmath174 are given by : @xmath175 @xmath176 which can be checked to be in agreement with eqs .",
    "( [ eba ] ) and ( [ ba_enthalpy ] ) , thus completing the proof .    while the use of the gibbs function is the most natural approach when the thermodynamic properties are tabulated as functions of @xmath41 , @xmath59 , and @xmath2 , as is currently the case for seawater , e.g. , @xcite , it is sometimes more convenient , depending on the particular situation considered , to work with different dependent variables and hence with a different `` master '' thermodynamic potential . for a general discussion of the different ways to compile thermodynamic data ,",
    "the interested reader is referred to @xcite .",
    "the specific enthalpy @xmath177 , owing to the particularly important role it plays for describing and understanding the energetics of stratified fluids , warrants a separate discussion and is therefore discussed next . to that end , let us introduce the function @xmath174 : @xmath178 and verify that it is the relevant boussinesq / anelastic approximation to the specific enthalpy .",
    "this is done by taking the total differential of @xmath174 , viz . ,",
    "@xmath179 and checking that it agrees with eq .",
    "( [ ba_enthalpy ] ) .",
    "qed . the corresponding expression for the internal energy @xmath180",
    "can be written as : @xmath181 its total differential is : @xmath182 which is again consistent with eq .",
    "( [ eba ] ) .    as a final remark ,",
    "let us mention that while the above derivations demonstrate that the ba thermodynamic potentials can be constructed from the knowledge of the exact gibbs function or enthalpy , integration of the maxwell relationships will in general be needed to construct the ba thermodynamic potentials when an idealised equation of state is assumed .",
    "sections [ linear_eos ] and [ nonlinear_eos ] illustrate in details the two different possible cases .",
    "the above results make it possible to write down the evolution equations for the specific internal energy and enthalpy by combining eqs .",
    "( [ de_ba ] ) and ( [ dh_ba ] ) with the evolution equations eqs .",
    "( [ eta_equation ] ) and ( [ s_equation ] ) for @xmath68 and @xmath59 respectively , leading to : @xmath183       + \\rho_0 ( z - z_0 ) \\frac{db}{dt } ,      \\label{eba_evolution}\\ ] ] @xmath184 - \\rho_0 b \\frac{dz}{dt } .",
    "\\label{hba_evolution}\\ ] ] interestingly , taking the difference between these two equations yields the evolution equation for the gravitational potential energy @xmath185 : @xmath186 =             \\rho_0 \\frac{d(h_{ba}-e_{ba})}{dt } , \\ ] ] which shows that for a ba fluid , the gravitational potential energy can be regarded as a thermodynamic property of the fluid , since it is entirely determined from the knowledge of @xmath59 , @xmath41 , and @xmath69 .",
    "there are therefore two main ways to describe the coupling between dynamics and thermodynamics in a ba fluid , the first one focusing on the coupling between internal energy and the total mechanical energy ( the sum of kinetic energy and gravitational potential energy ) , and the other between the kinetic energy and the total potential energy ( the sum of internal energy and gravitational potential energy , which is equal to the enthalpy here ) . by combining either one of eqs .",
    "( [ eba_evolution ] ) or ( [ hba_evolution ] ) with the mechanical energy equation eq .",
    "( [ anelastic_em1 ] ) , the two following equivalent evolution equations for the total energy @xmath187 are obtained : @xmath188 + \\nabla \\cdot [ \\delta p { \\bf v } -       \\rho_0 { \\bf f}_{ke } ] = \\rho_0 \\left [ \\dot{q } + \\tilde{\\mu } \\dot{s } -       \\varepsilon_k \\right ] ,     \\label{total_energy}\\ ] ] @xmath189     + \\nabla \\cdot \\left [ \\delta p { \\bf v } -       \\rho_0 { \\bf f}_{ke } \\right ] = \\rho_0       \\left [ \\dot{q } + \\tilde{\\mu } \\dot{s } - \\varepsilon_k \\right ] .",
    "\\label{total_energy_2}\\ ] ] now , in order for the ba system to be energetically consistent , it remains to verify that eqs .",
    "( [ total_energy ] ) and ( [ total_energy_2 ] ) are consistent with the principle of energy conservation .",
    "this is easily shown to be the case only if the right - hand side of eq .",
    "( [ total_energy ] ) is the divergence of some energy flux @xmath190 , i.e. , @xmath191 as we show now , this imposes a constraint on the form of the entropy flux @xmath74 and irreversible entropy production @xmath192 in eq .",
    "( [ eta_equation ] ) . assuming salt to be conservative quantity , and hence such that @xmath193 for some salt flux @xmath194 , implies for the evolution equation of specific entropy : @xmath195 @xmath196 .\\ ] ] the latter expression establishes that the entropy flux @xmath74 and irreversible entropy production @xmath192 in eq .",
    "( [ eta_equation ] ) must be related to the salt flux @xmath194 and enthalpy / internal energy flux @xmath190 by : @xmath197 @xmath198 in non - equilibrium thermodynamics , this is usually the point at which the second law of thermodynamics is then invoked to further constrain @xmath190 and @xmath194 , in order to guarantee that @xmath199 , e.g. , see @xcite .",
    "going back to the evolution equation for internal energy and enthalpy , note that eq .",
    "( [ energy_flux ] ) implies : @xmath200 @xmath201 so that @xmath190 appears as the diffusive flux of internal energy or enthalpy .",
    "both equations can be regarded as equivalent forms of the first law of thermodynamics .",
    "we now investigate the consequences of the above results for the determination of various temperature variables .",
    "let us first note that from the differential of the gibbs function : @xmath202 the maxwell relationships provide the following partial derivatives for the entropy : @xmath203 by defining @xmath204 as the relevant definition of the thermal expansion coefficient . using the well known result that @xmath205 , this implies that we can write : @xmath206 as a result , it follows that the temperature equation can be written as : @xmath207 in absence of salinity , this equation takes the simpler form : @xmath208 by assuming the diffusive heating to be given by the classical fourier law @xmath209 .",
    "this shows that the evolution equation for in - situ temperature in general possesses : a ) a term related to molecular diffusion , that is general not - conservative , i.e. , it can not be expressed as the divergence of a flux because @xmath210 is not constant ; b ) it usually incorporate the joule heating due to viscous dissipation ; c ) it possesses a term related to change in pressure , which some authors , e.g. @xcite , call the `` piston effect '' , and the resultant boussinesq equations , the thermodynamic boussinesq equations .    in practice",
    ", the pressure effect can be accounted for by constructing evolution equations for the potential temperature or conservative temperature respectively . in order to show how an equation for @xmath211 can be constructed ,",
    "it is useful to construct the potential temperature @xmath60 first . by definition",
    ", @xmath60 is the temperature that a parcel with temperature @xmath41 would have if lifted adiabatically to a reference level @xmath83 .",
    "potential temperature is thus defined as the implicit solution of the following equation : @xmath212 differentiating this expression yields : @xmath213 where we defined @xmath214 and @xmath215 . in the following , we simplify notations by defining @xmath216 .",
    "this expression shows that it is possible to rewrite the evolution equation for entropy as follows : @xmath217 in absence of salinity , we can write : @xmath218 this can be transformed in the following equation for @xmath60 , @xmath219 where the nonconservative production / destruction of @xmath60 is given by : @xmath220 in the literature , @xmath60 is often treated as a conservative variable , which consists in neglecting the nonconservative term @xmath221 .",
    "alternatively , one may remark that the equation for @xmath60 can also be written as : @xmath222 where @xmath223 is the enthalpy a parcel would have if moved adiabatically from @xmath69 to @xmath83 .",
    "for this reason , @xmath224 was called `` potential enthalpy '' by @xcite .",
    "this allows one to defined a new temperature variable @xmath211 , also conserved for adiabatic motions , such that : @xmath225 , where @xmath226 is an arbitrarily defined specific heat capacity representative of @xmath210 at @xmath83 .",
    "@xcite discusses a possible choice for @xmath226 in the oceanic context . as a result ,",
    "it is possible to write the above equation as : @xmath227 where this time , the nonconservative production / destruction of @xmath211 is given by : @xmath228 @xcite provides convincing evidence that the nonconservative term @xmath229 is significantly smaller than @xmath221 for the present - day oceans .",
    "the relative smallness of @xmath229 over @xmath221 does not appear to be entirely generic though , and should therefore be checked on a case by case basis , as it may depend on the particular fluid considered and on the degree of turbulence present .",
    "it is beyond the scope to simplify the equations further , and to discuss when the evolution equation for @xmath211 can be approximated by the above simple diffusive model using @xmath230 .",
    "in this section , we return to the case of a boussinesq fluid with a linear equation of state , originally assumed to be governed by eqs .",
    "( [ velocity_model1]-[eos_model1 ] ) , with the aim of clarifying its thermodynamics , as well as to improve its formulation to make it thermodynamically and energetically consistent .",
    "we first seek to construct the relevant forms of the specific gibbs function , enthalpy and internal energy , assuming a linear equation of state @xmath231 $ ] and constant specific heat capacity @xmath232 , so that the expression for the buoyancy is : @xmath233 we need to decide on whether to interpret @xmath41 as the potential or in - situ temperature in the equation of state , as we saw above that any thermodynamically consistent formulation must distinguish between the two kinds of temperature . for completeness , the two cases are considered .",
    "we first discuss the case where @xmath41 is the in - situ temperature , deferring the discussion of an equation of state linear in potential temperature to subsection [ theta_case ] .",
    "this choice amounts to assume that the isothermal compressibility , rather than the adiabatic compressibility , vanishes . from a thermodynamic viewpoint , this is arguably an awkward assumption , because eq . ( [ compressibilities ] ) suggest that this endows the fluid with a negative speed of sound , but since sound waves are filtered out , it is unclear whether this is a serious impediment .",
    "the interpretation of @xmath41 as the in - situ temperature motivates looking for a description of the thermodynamic properties in terms of the specific gibbs function @xmath158 , since the natural variables of the latter are @xmath41 and @xmath69 . as seen previously , the total differential of @xmath158 is @xmath234 , which implies : @xmath235 the assumption of constant heat capacity provides the additional differential relation : @xmath236 the system of partial differential equations eqs .",
    "( [ gba_derivatives ] ) and ( [ cpo_gibbs ] ) is sufficient to completely specify @xmath158 , whose integration yields @xmath237      - \\alpha g_0 ( z - z_0 ) ( t - t_0 ) , \\ ] ] up to some arbitrary constant of integration . from eq .",
    "( [ gba_derivatives ] ) , the following expression for the specific entropy is obtained : @xmath238 this makes it possible to derive an exact expression for the potential temperature @xmath60 , which is the implicit solution of the equation @xmath239 , i.e. , @xmath240 , yielding : @xmath241 this makes it clear that in order for a model to be thermodynamically consistent , potential temperature is always different from the in - situ temperature .",
    "now , we previously established that the expressions for internal energy and enthalpy were given by : @xmath242 and @xmath243 , yielding therefore the following expressions : @xmath244 @xmath245 t .\\ ] ] these relations can be written in terms of other variables by using the expression for @xmath60 , as well as @xmath94 .",
    "for instance , the enthalpy can be written in terms of the potential temperature and @xmath69 as follows : @xmath246 @xmath247 \\left ( t_0 + \\frac{b}{\\alpha g_0 } \\right ) \\ ] ]      having clarified the nature of the thermodynamics and thermodynamic potentials for a boussinesq fluid with a linear equation , we now turn to the issue of writing down explicitly how to transform the initial formulation into an energetically and thermodynamically consistent one .",
    "the main modification introduced is related to the heat equation .",
    "moreover , there is now a distinction between in - situ temperature and potential temperature . to summarise ,",
    "the whole model is therefore given as follows : @xmath248 @xmath249 @xmath250 @xmath251 @xmath252 note that we can rewrite the temperature equation as : @xmath253 where @xmath254 note that it is also possible to write the flux entirely in terms of @xmath60 : @xmath255 which was computed assuming @xmath256 .",
    "interestingly , these equations introduce the following length scale : @xmath257 . for typical values , @xmath258 , @xmath20 and @xmath259 , which yields : @xmath260 . as @xmath261 is huge compared to the typical length scales at which molecular diffusion is important",
    ", it follows that the nonconservative term is probably negligible .",
    "this section revisits the above results by assuming that the equation of state is linear in @xmath60 rather than in @xmath41 , and hence that the adiabatic compressibility vanishes , as is generally implicitly assumed in traditional low mach number asymptotics . in this case",
    ", the buoyancy becomes : @xmath262 with @xmath263 the isentropic thermal expansion , which @xcite shows ( his eq .",
    "a.11 ) is related to the classical thermal expansion by @xmath264 for a constant @xmath232 .",
    "the use of @xmath60 as a dependent variable makes it natural to seek a description of the thermodynamic properties of the fluid from the specific enthalpy , since @xmath60 is closely related to the specific entropy by @xmath265 , as seen previously . as a result",
    ", the total differential of specific enthalpy can be written as : @xmath266 which yields the following system of two partial differential equations : @xmath267 the maxwell relationship for such a system imposes the following integrability constraint : @xmath268 which can be integrated to yield the following expression between @xmath41 and @xmath60 : @xmath269 using the fact that by definition , @xmath270 at @xmath83 . by using eq .",
    "( [ t_theta_2 ] ) , it becomes straightforward to integrate the partial differential relations eqs .",
    "( [ hba_pde ] ) to eventually obtain @xmath271 ( \\theta - \\theta_0 ) =     \\left ( \\frac{\\theta-\\theta_0}{\\theta } \\right ) c_{p0 } t,\\ ] ] up to an arbitrary constant of integration .",
    "the expression for the internal energy is therefore given by : @xmath272      ( \\theta-\\theta_0 ) , \\ ] ] which implies that in the present model , @xmath60 is in fact a proxy for the specific internal energy .",
    "it is useful to note here that because @xmath232 is constant , the concepts of potential temperature @xmath60 and conservative temperature @xmath211 coincide .",
    "the evolution equation for temperature is unchanged , while the expression linking @xmath41 and @xmath60 is now given by eq .",
    "( [ t_theta_2 ] ) , so that in summary , the thermodynamics is now described by the system : @xmath273 @xmath274 .\\ ] ] as shown in this paper , the diffusive term can be written as the sum of the divergence of a diffusive flux , plus a nonconservative production / destruction term , which are explicitly given by : @xmath275 where @xmath276 ^ 2 }        \\frac{\\partial t}{\\partial z } =      - \\frac{\\kappa \\alpha_{\\theta } g_0}{c_{p0 } }        \\left ( \\frac{\\theta}{t}\\right ) ^2 \\frac{\\partial t}{\\partial z}\\ ] ] the nonconservative terms have been shown by @xcite to be very small compared to the diffusive term , so that can be neglected in practice .",
    "in this section , we return to the boussinesq primitive equations eqs .",
    "( [ velocity_ogcm]-[eos_ogcm ] ) that form the basis for most current numerical ocean general circulation models ( save for the form of the turbulent parameterisations ) , with the aim of showing how to modify them in order to make them energetically and thermodynamically consistent",
    ".      it should be clear by now from the above results that two main modifications are needed to make the boussinesq primitive equations ( [ velocity_ogcm]-[eos_ogcm ] ) energetically and thermodynamically consistent , which are : 1 ) modification of the definition of buoyancy ,",
    "2 ) addition of the nonconservative terms in the thermodynamic equation eq .",
    "( [ temperature_ogcm ] ) .",
    "the resulting set of modified equations is as follows : @xmath277 @xmath278 @xmath279 @xmath280 @xmath281 @xmath282 where @xmath211 is now assumed to be the conservative temperature , on the basis of @xcite s results suggesting that the nonconservative term @xmath229 is significantly smaller for @xmath211 than for the potential temperature @xmath60 , resulting in a smaller error in the overall energy budget when this term is neglected . for completeness",
    ", we need to provide an explicit expression for @xmath229 . to that end , it is first necessary to understand how to evaluate a number of thermodynamic properties for boussinesq seawater , which is discussed next .",
    "in contrast to the idealised boussinesq model of the previous section , the aim of numerical ocean modelling is to achieve realistic simulations , and therefore to use an equation of state that is as realistic as possible .",
    "as mentioned earlier , the thermodynamic properties of seawater are currently encapsulated in a gibbs function , e.g. , @xcite , with natural variables in - situ temperature , salinity , and pressure .",
    "it is therefore natural to seek a determination of boussinesq thermodynamics from the published gibbs function .",
    "the boussinesq gibbs function was shown above to be given by : @xmath283 as is well known , the specific entropy @xmath165 , the relative chemical potential @xmath166 , the buoyancy @xmath94 ( and specific volume ) , and the specific heat capacity @xmath284 can all be obtained from the first and second partial derivatives of @xmath158 as follows : @xmath285 @xmath286 @xmath287 @xmath288 where the formula for @xmath94 was arrived at by using the result that @xmath289 .",
    "as previously , tilded quantities refer to quantities estimated for the hydrostatic reference pressure @xmath290 rather than the full pressure , so that @xmath291 for instance .    in order to arrive at an expression for the conservative temperature ,",
    "we need the expressions for the specific enthalpy @xmath174 and potential enthalpy @xmath292 , which are respectively given by : @xmath293 @xmath294 where the potential temperature @xmath60 is now the implicit solution of @xmath295 . using the above expressions for the specific entropy and heat capacity , as well as the maxwell relationships for the gibbs function ,",
    "yields the following expression for the total differential of specific entropy : @xmath296 which in turn yields the following expression for the total differential of specific enthalpy : @xmath297}_{{\\rm d}\\tilde{\\eta } }       + \\tilde{\\mu } { \\rm d}s - b { \\rm d}z\\ ] ] @xmath298 where @xmath299 , by defining the thermal expansion coefficient by @xmath300 .",
    "similarly , the haline contraction coefficient should be defined by @xmath301 . by evaluating the above expression at @xmath83 , we obtain the following expression for the total differential of potential enthalpy : @xmath302 where @xmath303 and @xmath304 . as discussed by @xcite , the conservative temperature",
    "is defined such that @xmath305 , for some constant representative value of the specific heat capacity @xmath226 .",
    "the latter expression allows one to express @xmath306 in terms of @xmath307 as follows : @xmath308 now , by evaluating the differential of entropy eq .",
    "( [ entropy_differential ] ) at @xmath83 , as well as by using the implicit definition of potential temperature and eq .",
    "( [ potential_to_conservative ] ) , it is possible to write down the differential of entropy equivalently in terms of @xmath60 or @xmath211 as follows : @xmath309 which in turn allows one to write the total differential of specific enthalpy in terms of the conservative temperature as follows : @xmath310 this result is used next to provide an explicit expression for the nonconservative production of conservative temperature .",
    "as discussed in @xcite , the determination of @xmath229 follows from the constraint of total energy conservation . in order to see this ,",
    "let us first derive the evolution equation for the kinetic energy by multiplying the momentum equations by @xmath311 .",
    "after some manipulation , this can be put in the form : @xmath312 where the diffusive flux of kinetic energy and viscous dissipation are given by : @xmath313",
    "@xmath314         + a_v \\left ( \\frac{\\partial { \\bf u}}{\\partial z } \\right ) ^2 .\\ ] ] now , by inserting the evolution equations for @xmath211 and @xmath59 into eq .",
    "( [ first_law_theta ] ) , it is possible to rewrite the evolution equation for the specific enthalpy as follows : @xmath315 @xmath316 where the diffusive flux @xmath317 and the irreversible nonconservative term @xmath318 are given by : @xmath319        + \\left ( \\tilde{\\mu}_r - \\frac{t \\tilde{\\mu}_r}{\\theta }        \\right ) \\left [ k_h \\nabla_h s + k_v \\frac{\\partial s}{\\partial z }      { \\bf k } \\right ] , \\ ] ] @xmath320 + k_v    \\left [ \\frac{\\partial s}{\\partial z } \\frac{\\partial      \\tilde{\\mu}^{\\ast \\ast } }     { \\partial z } + \\frac{\\partial \\theta}{\\partial z }     \\frac{\\partial}{\\partial z } \\left ( \\frac{t c_p^0}{\\theta } \\right )     \\right ] , \\ ] ] where @xmath321 . finally , an evolution equation for the total energy is obtained by eqs .",
    "( [ ke_ogcm ] ) and ( [ enthalpy_ogcm ] ) , @xmath322 which shows that the total energy @xmath323 is a conservative quantity only if the right - hand side of the later equation vanishes , which yields : @xmath324 .\\ ] ] this completes the full specification of the modified boussinesq primitive equations .",
    "the above results imply that there are at least two main sources of error in the global energy budget of current ogcms , resulting respectively from their use of the buoyancy @xmath325 instead of @xmath326 , as well as from neglecting the irreversible production term @xmath229 in the temperature equation ( see @xcite for relevant expressions when potential temperature is used ) .",
    "thus , by replacing the buoyancy @xmath94 by @xmath327 in the kinetic energy equation , as well as by neglecting @xmath229 in the enthalpy equation , implies for the evolution equation of total energy in current ogcms to be of the form : @xmath328 where the right - hand side @xmath329 corresponds to the spurious production / destruction of total energy resulting from the inconsistent treatment of the buoyancy and temperature equation . from the above results , its explicit expression is given by : @xmath330 since we have : @xmath331 note here that the final form for the error term @xmath332 differs significantly from that discussed in @xcite , because in the latter study",
    ", @xmath332 was estimated using the non - approximated thermodynamic potentials , resulting in additional spurious sinks / sources of energy .",
    "interestingly , it is important to note that because the term @xmath333 scales as the square of the small boussinesq parameter @xmath6 , it follows that the energetically and thermodynamically consistent boussinesq formulation has the same order of accuracy as the non - consistent formulation . from that viewpoint",
    ", it can be said that of all the possible boussinesq approximations that can be constructed with the same formal order of accuracy , one can be found that is energetically and thermodynamically consistent .    as discussed in @xcite ,",
    "errors in the global energy are likely to be of consequence only if they are associated with spurious forces in the momentum equations .",
    "indeed , @xcite estimated that the same error @xmath334 in the overall energy budget corresponds only to a spurious heat source / sink in the temperature equation that is @xmath335 , which is arguably utterly small , whereas it may correspond to spurious positive or negative acceleration in the momentum equations @xmath336 in the momentum equations , which is in contrast a significant number . on this basis",
    ", it appears important to correct the definition of the buoyancy in current ogcms , but less vital to retain the nonconservative term @xmath229 . from a practical computational viewpoint ,",
    "modifying the definition of buoyancy in current ogcm implementations should be rather straightforward , as it amounts to change the integrand in the particular sub - routine estimating the hydrostatic pressure from the knowledge of density .",
    "by contrast , evaluating the nonconservative term @xmath229 at each grid point at all time steps would be a major undertaking , since it requires the evaluation of many thermodynamic quantities such as @xmath337 , @xmath338 , @xmath339 , @xmath60 and @xmath41 .",
    "this would be computationally prohibitive , given that the evaluation of density alone already amounts for a significant fraction of the total cpu time owing to its strongly nonlinear character .",
    "in this paper , we sought to clarify the nature of the conversions between mechanical energy and internal energy supported by the boussinesq and anelastic approximations , in the general case of a binary fluid with an arbitrary nonlinear equation of state .",
    "a key result was to show that the energetics of such approximations possesses a term that can be identified as playing the role of the classical compressible work of expansion / contraction , which manifests itself as apparent changes in gravitational potential energy due changes in density ( and hence of mass if the volume is exactly or approximately conserved , as is the case for such approximations ) .",
    "in contrast with a fully compressible fluid , however , the conversion between mechanical energy and internal energy is between gpe and ie rather than between ke and ie . by regarding this term as the boussinesq / anelastic approximation to the compressible work @xmath340 , it is possible to construct the relevant approximation to the `` heat '' @xmath341 in a consistent way by ensuring satisfaction of maxwell relationships , which upon integration eventually leads to the construction of consistent expressions for the specific internal energy , as well as of the whole range of known thermodynamic potentials , illustrating @xcite s statement that the `` thermodynamics is slaved to the dynamics '' .",
    "the existence of well - defined thermodynamic potentials from which to derive physically consistent expressions for the first law of thermodynamics appears to be sufficient to endow the boussinesq and anelastic approximations considered in this paper with fully consistent energetics and thermodynamics , even when diabatic effects and a fully nonlinear equation of state for a binary fluid are retained . in the energetically consistent form of the boussinesq and anelastic approximations ,",
    "the sum of kinetic energy and enthalpy is a conservative quantity , and hence the natural total energy for the system . as a consequence",
    ", the gravitational potential energy can be regarded as the difference between enthalpy and internal energy , and hence as a purely thermodynamic property of the fluid .",
    "these ideas were illustrated by showing how two widely used but energetically inconsistent boussinesq models could be modified to make them fully energetically and thermodynamically consistent .",
    "interestingly , we find that the modifications required to ensure energetic and thermodynamic consistency do not alter the formal order of accuracy of the approximations .",
    "in other words , in the space of all boussinesq and anelastic approximations of a given order of accuracy , one exists that is fully consistent energetically and thermodynamically .",
    "it was also showed how to construct explicitly the full range of thermodynamic potentials for boussinesq and anelastic models , either by integrating maxwell relationships in the context of idealised models with idealised equations of state and heat capacities , or by approximating the exact thermodynamic potentials when those are known .",
    "a direct application of our results is to suggest that current numerical ocean circulation models possess a potentially significant source of error in their momentum equations owing to their use of an incorrect definition of buoyancy , which could in principle be simply corrected by using the correct definition .",
    "interestingly , the improved definition of buoyancy is one that was recently proposed earlier by @xcite and @xcite , but it does not appear to have been realized until now that such a modification was needed to improve the energetic consistency of current ogcms",
    ".    an important implication of our results is to support the earlier suggestion by @xcite that the boussinesq ( and hence anelastic ) approximations can support large conversions between mechanical energy and internal energy , and therefore compressibility effects significantly larger than previously assumed .",
    "specifically , the point made in @xcite is that in the context of turbulent stratified mixing , the apparent irreversible conversion of available gpe into background gpe should not be interpreted as a mechanical to mechanical energy conversion , as proposed by @xcite , but as an irreversible conversion of agpe into ie .",
    "note , indeed , that on the one hand , @xcite interpret the following energy conversion term : @xmath342 ,       \\label{laminar_conversion}\\ ] ] as a ( laminar ) conversion of internal energy into background gravitational potential energy , but on the other hand , interpret the following energy conversion term : @xmath343 as the irreversible conversion of agpe into background @xmath344 , where @xmath345 is the parcel s position in lorenz s reference state , and hence as a mechanical to mechanical energy conversion , on the grounds that @xmath346 shows up in the evolution equations for @xmath347 and @xmath344 with opposite signs .",
    "yet , both @xmath348 and @xmath346 are seen to involve terms of the form @xmath349 , which the present paper argues is the one playing the role of the compressible work of expansion / contraction in the boussinesq / anelastic approximations . for this reason ,",
    "@xcite argue that @xmath346 actually refers to two different types of energy conversions in the @xmath347 and @xmath344 evolution equations , for which two different notations should be used . @xcite",
    "used the notation @xmath350 to refer to the dissipation of agpe into @xmath351 .",
    "if one accepts the idea that @xmath350 and @xmath346 actually represent two large conversions between @xmath347 and @xmath351 , and between @xmath351 and @xmath344 respectively , then the question arises as to how these conversions are actually achieved in reality since there is no direct conversion between ie and gpe in the classical description of the energetics of the fully compressible navier - stokes equations ?",
    "with regard to @xmath352 , the theory of the hydrostatic adjustment , e.g. , @xcite can be tentatively invoked to speculate on some of the physical mechanisms and processes involved .",
    "physically , localised heating / cooling anomalies due to molecular diffusion must cause localised pressure anomalies , which will propagate as acoustic waves whose energy can be converted into kinetic energy via the compressible work of expansion / contraction and then ultimately into gravitational potential energy via the buoyancy flux @xmath353 .",
    "if this is what indeed happens , then it is interesting to note that the boussinesq / anelastic approximations implicitly assumes that of all the internal energy lost to mechanical energy , all of it goes toward increasing the gravitational potential energy , whereas in reality , it seems plausible that some of it could go toward increasing the turbulent kinetic energy , thereby acting as a positive feedback on turbulent mixing .",
    "the latter hypothesis warrants further research , as acoustic waves are known to be capable of generating mean flows via acoustic streaming for instance , e.g. , see @xcite .",
    "what are the physical mechanisms involved in the opposite conversion whereby @xmath347 is ultimately dissipated into @xmath351 by molecular diffusion is less clear , because physically agpe can only be converted reversibly into ke by construction . as a result ,",
    "the only way to dissipate agpe into ie by molecular diffusive processes seems to require converting agpe into ke reversibly , then ke into ie reversibly , presumably in the form of acoustic waves , and finally removing the latter by thermal dissipation .",
    "the problem with this hypothesis , however , is that thermal dissipation is generally found to be a significantly less effective way to dissipate acoustic waves in liquids than the bulk viscosity , e.g. , @xcite ( thermal dissipation is more effective in gases , however ) .",
    "however , as the bulk viscosity dissipates the divergent velocity component , it is absent as a dissipation mechanism in the boussinesq and anelastic approximations . if the physical mechanisms underlying the agpe dissipation into ie are indeed related to the dissipation mechanisms of acoustic waves , then it is probably not possible to ascertain that only molecular diffusion is involved in reality .",
    "the overall conclusion is that the diabatic effects due to molecular diffusive processes in turbulent stratified fluids seem to give rise to nontrivial and potentially large conversions between mechanical energy and internal energy even in fluids traditionally regarded as incompressible or nearly incompressible , and that such conversions are actually supported by such models as the boussinesq and anelastic approximations even if this is still largely unappreciated .",
    "the main consequences is that thermodynamics , compressible effects , and the divergent component of the fluid velocity play a potentially more important role than traditionally assumed for understanding the physical processes and mechanisms ultimately involved in the energetics of turbulent mixing in stratified fluids .",
    "the present results , which suggest that the boussinesq and anelastic approximations can support large conversions between mechanical energy , help rationalise why such approximations appears to do so well in simulating turbulent stratified flows . on the other hand",
    ", the present results also suggest that real turbulent stratified fluids should exhibit differences with boussinesq and anelastic fluids , as there must be a limit beyond which neglecting the effects of a divergent velocity may become noticeable for instance .",
    "making progress toward clarifying these issues will probably require further detailed analysis of the energetics of the compressible navier - stokes equations along the lines recently developed by @xcite , and direct numerical simulations of turbulent mixing in fully compressible stratified liquid flows resolving acoustic waves emitted by molecular diffusive heating / cooling and their dissipation mechanisms .",
    "laboratory experiments , of the kind illustrated in fig . [ set_up ] , might also help .",
    "13 alberty , r. a. 2001 use of legendre transforms in chemical thermodynamics .",
    "_ pure appl .",
    "chem . _ * 73 * , 13491380 .",
    "andrews , d. g. 1981 a note on potential energy density in a stratified compressible fluid .",
    "_ j. fluid mech . _ * 107 * , 227236 .",
    "bannon , p. r. 1995 hydrostatic adjustment : lamb s problem . _ j. atm .",
    "sciences _ * 52 * , 23022312 .",
    "bannon , p.r .",
    "1996 on the anelastic approximation for a compressible atmosphere .",
    "sciences _ * 53 * , 36183628 .",
    "boussinesq , j. 1903 thorie analytique de la chaleur .",
    "gauthier - villars , paris .",
    "bryan , k. 1969 a numerical model for the study of the circulation of the world ocean .",
    "_ j. comp .",
    "phys . _ * 7 * , 347376 .",
    "callen , h.b .",
    "1985 thermodynamics and an introduction to thermostatistics .",
    "davies , t. , staniforth , a. , wood , n. & thuburn , j. 2003 validity of anelastic and other equation sets as inferred from normal - mode analysis .",
    "_ q. j. roy .",
    "* 129 * , 27612775 .",
    "de groot , s.r . & mazur , p. 1962",
    "non - equilibrium thermodynamics .",
    "north holland publishers .",
    "durran , d. r. 1989 improving the anelastic approximation .",
    "_ j. atmos .",
    "sci . _ * 46 * , 14531461 .",
    "de szoeke , r. a. & samelson , r. m. 2002 the duality between boussinesq and non - boussinesq hydrostatic equations of motion .",
    "_ j. phys .",
    "* 30 * , 21942203 .",
    "feistel , r. 2003 a new extended gibbs thermodynamic potential of seawater . _ prog .",
    "oceanogr . _ * 58 * , 43114 .",
    "griffies , s. m. 2004 fundamentals of ocean climate models .",
    "princeton university press .",
    "holliday , d. & mcintyre , m. e. 1981 on potential energy density in an incompressible stratified fluid .",
    "_ j. fluid mech . _ * 107 * , 221225 .",
    "hughes , g. 0 . & griffiths , r. w. 2008 horizontal convection .",
    "fluid mech .",
    "_ * 40 * , 185208 .",
    "hughes , g.0 . , hogg , a. , & griffiths , r.w .",
    "2009 available potential energy and irreversible mixing in the meridional overturning circulation .",
    "_ j. phys .",
    "oceanogr . _ * 39 * , 31303146 .",
    "ingersoll , a. p. & pollard , d. 1982 motions in the interiors and atmospheres of jupiter and saturn : scale analysis , anelastic equations , barotropic stability criterion .",
    "_ icarus _ * 52 * , 6280 .",
    "ingersoll , a. 2005 boussinesq and anelastic approximations revisited : potential energy release during thermobaric instability .",
    "_ j. phys .",
    "oceanogr . _ * 35 * , 13591369 .",
    "lighhill , m. j. 1978a ` acoustic stream ' , _ j. sound vibr . _ * 61 * , 391418 .",
    "lighthill , m.j .",
    "1978b waves in fluids , cambridge university press .",
    "lipps , f. b. & hemler , r. s. 1982 a scale analysis of deep moist convection and some related numerical calculations .",
    "_ j. atmos .",
    "sci . _ * 39 * , 21922210 .",
    "klein , r. 2009 asymptotics , structure , and integration of sound - proof atmospheric flow equations .",
    "fluid dyn . _",
    "* 23 * , 161195 .",
    "klein , r. 2010 scale - dependent models for atmospheric flows .",
    "fluid mech . _ * 42 * , 249274 .",
    "lilly , d.k .",
    "1996 a comparison of incompressible , anelastic and boussinesq dynamics .",
    "_ , * 40 * , 143151 .",
    "lorenz , e. n. 1955 available potential energy and the maintenance of the general circulation .",
    "_ tellus _ * 7 * , 157167 .",
    "mcintyre , m. e. 2010 on spontaneous imbalance and ocean turbulence : generalizations of the paparella - young epsilon theorem . in turbulence in the atmosphere and oceans .",
    "international iutam / newton inst .",
    "workshop held 8 - 12 december 2008 , ed .",
    "d. g. dritschel , springer - verlag .",
    "mcdougall , t.j .",
    "2003 potential enthalpy : a conservative oceanic variable for evaluating heat content and heat fluxes .",
    "_ j. phys .",
    "oceanogr . _ * 33 * , 945963 .",
    "mller , b. 1998 low - mach number aymptotics of the navier - stokes equations _",
    "j. engineering math .",
    "_ * 34 * , 97109 .",
    "nycander , j. , nilsson , j. , ds , & brostrm , g. 2007 thermodynamic analysis of the ocean circulation .",
    "_ j. phys .",
    "oceanogr . _ * 37 * , 20382052 .",
    "nycander , j.2010 horizontal convection with a nonlinear equation of state : generalization of a theorem of paparella and young .",
    "_ tellus _ * 62a * , 134137 .",
    "ogura , y. & phillips , n. a. 1962 scale analysis of deep and shallow convection in the atmosphere .",
    "_ j. atmos .",
    "_ * 19 * , 173179 .",
    "oberbeck , a. 1879 ber die wrmeleitung der flssigkeiten bei bercksichtigung der strmungen infolge vor temperaturedifferenzen ( on the thermal conduction of liquids taking account flows due to temperature differences ) . _",
    ", neue folge . _ * 7 * , 271292 .",
    "paparella , f. & young , w. r. 2002 horizontal convection is non turbulent .",
    "_ j. fluid mech . _",
    "* 466 * , 205 - 214 .",
    "pauluis , 0 .",
    "2008 thermodynamic consistency of the analestic approximation for a moist atmosphere . _ j. atm .",
    "_ , * 65 * , 27192729 .",
    "pons , m. & p. le qur 2005 an example of entropy balance in natural convection .",
    "part 2 : the thermodynamic boussinesq equations .",
    "_ c. r. mecanique _ * 333 * , 133138 . pons , m. & p. le qur 2007 modeling natural convection with the work of pressure - forces , a thermodynamic necessity . _",
    "heat fluid flow _ * 17 * , 322332 .",
    "shchepetkin a. f. & mcwilliams , j. c. 2011 accurate boussinesq oceanic modelling with a practical , `` stiffened '' equation of state .",
    "_ ocean modelling _ , * 38 * , 4170 .",
    "spiegel , e. a. & veronis , g. 1960 on the boussinesq approximation for a compressible fluid .",
    "_ astrophys . journal _ * 131 * , 442447 .",
    "tailleux , r. 2009 on the energetics of stratified turbulent mixing , irreversible thermodynamics , boussinesq models , and the ocean heat engine controversy .",
    "_ j. fluid mech . _ * 638 * , 339382 .",
    "tailleux , r. & rouleau , l. 2010 the effect of mechanical stirring on horizontal convection .",
    "_ tellus a _ * 62 * , 138153 .",
    "tailleux , r. 2010 identifying and quantifying nonconservative energy production / destruction terms in hydrostatic boussinesq primitive equation models .",
    "_ ocean modell .",
    "_ , * 34 * , 125136 .",
    "tailleux , r. 2010 on the buoyancy power input in the oceans energy cycle .",
    "_ geophys .",
    "_ , * 37 * , l22603 , doi:10.1029/2010gl044962 .",
    "ioc , scor and iapso 2010 the international thermodynamic equation of seawater - 2010 : calculation and use of thermodynamic properties .",
    "intergovernmental oceanogrphic commission , manuals and guides no .",
    "56 , unesco ( english ) , 196 pp .",
    "vallis , g.2006 atmospheric and oceanic fluid dynamics .",
    "cambridge university press .",
    "vanneste , j. & o. bhler 2011 streaming by leaky surface acoustic waves .",
    "a _ , * 467 * , 17791800 .",
    "wang & huang , r. x.2005 an experimental study on thermal circulation driven by horizontal differential heating .",
    "_ j. fluid mech . _ * 540 * , 4973 .",
    "winters , k. b. , lombard , p. n. , and riley , j. j. , & dasaro ( 1995 ) available potential energy and mixing in density - stratified fluids .",
    "_ j. fluid mech . _ * 289 * , 115228 .",
    "winters , k.b . & young , w.r.2009 available potential energy and buoyancy variance in horizontal convection .",
    "_ j. fluid mech . _ * 629 * , 221230 .",
    "young , w. r.2010 dynamic enthalpy , conservative temperature , and the seawater boussinesq approximation .",
    "_ j. phys .",
    "_ , * 40 * , 394400 ."
  ],
  "abstract_text": [
    "<S> this paper shows that the energetics of boussinesq and anelastic fluids possesses a term that can be identified as the approximation @xmath0 to the compressible work of expansion / contraction @xmath1 , where @xmath2 is the pressure and @xmath3 is the specific volume . </S>",
    "<S> it follows that boussinesq and anelastic fluids admit explicit compressible effects and conversions between internal energy and mechanical energy , under the form of apparent changes in gravitational potential energy resulting from changes in density by diabatic and adiabatic effects . from the knowledge of @xmath0 , the corresponding approximation to the `` heat '' @xmath4 </S>",
    "<S> can be constructed in a consistent way by requiring that the maxwell relationships be satisfied , ultimately leading to the construction of a well defined approximation to the internal energy and ultimately of the full range of known thermodynamic potentials . </S>",
    "<S> these properties make it possible to endow common forms of the boussinesq and anelastic approximations with fully consistent energetics and thermodynamics , even when diabatic effects and an arbitrary nonlinear equation of state for a binary fluid are retained , without loss of accuracy . in that case </S>",
    "<S> , it can be shown that the sum of kinetic energy and enthalpy is a conservative quantity , which plays the role of the total energy in the boussinesq and anelastic approximations for both diabatic and adiabatic motions . </S>",
    "<S> this implies that gravitational potential energy can be regarded as the difference between enthalpy and internal energy , and hence as a pure thermodynamic property of the fluid .    </S>",
    "<S> an important implication of the present results is to support the recent suggestion by @xcite that the boussinesq approximation is capable of describing potentially large conversions between internal energy and gravitational potential energy in turbulent stratified fluids , which physically seems to require that an active role be played by the emission and dissipation of acoustic waves by molecular diffusive heating and cooling , as well as by the associated divergent velocity field , a surprising result with potentially important implications for our understanding of turbulent mixing in stratified fluids if further confirmed . </S>",
    "<S> another implication of the results is to suggest that the form of the boussinesq primitive equations currently used as the basis for a majority of numerical ocean models possesses a potentially significant spurious source of momentum , which can in principle be corrected by using an alternative and more physically - based definition of buoyancy in the hydrostatic approximation . </S>"
  ]
}