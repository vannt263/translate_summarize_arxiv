{
  "article_text": [
    "in a recent paper ( lucy 2004 ) , a monte carlo ( mc ) treatment accurate to @xmath0 of the time - dependent transport of radiation in 3-d sne is described and tested .",
    "a major concern in that paper is establishing the accuracy of the mc code . to this end",
    ", the 3-d code was applied to a 1-d problem that could be solved independently with conventional numerical methods . specifically , the test problem was to compute the bolometric light curve of a spherical sn in which the transfer of uvoir radiation is treated with a grey extinction coefficient .",
    "an independent approach to this problem is provided by castor s ( 1972 ) co - moving frame ( cmf ) moment equations for spherically - symmetric flows .",
    "the resulting pair of partial differential equations ( pdes ) were solved with the henyey method .",
    "the final outcome of this test was entirely satisfactory : the mean difference between the two light curves is @xmath1mag . for elapsed times",
    "@xmath2 from @xmath3 to @xmath4 days . nevertheless , the differences were initially significant , and it was not clear which code was in error .",
    "this question was eventually answered by testing each code separately against an exact similarity solution of castor s equations .",
    "the cause of the differences could then be traced to the poor spatial resolution of the mc code .    in the interest of concise presentation ,",
    "the essential part played by this similarity solution was not described in the earlier paper ( lucy 2004 ) .",
    "but subsequently , this solution was found to generalize to all orders of @xmath5 .",
    "accordingly , since time - dependent relativistic flows and the associated transfer problems are of interest for such phenomena as gamma - ray bursts and micro - quasars , this paper derives this solution ( and variants thereof ) and illustrates its use in testing a relativistic transfer code .",
    "similarity solutions will be sought for the frequency - integrated radiation field in a homologously expanding or contracting flow .",
    "the configuration is spherically - symmetric , and the matter has grey extinction ( @xmath6 ) and integrated emissivity ( @xmath7 ) coefficients that are isotropic in the cmf .",
    "mihalas ( 1980 ) has derived the general time - dependent cmf transfer equation for spherically - symmetric flows with relativistic velocities . from this",
    ", he derives the zeroth and first frequency - integrated moment equations , whose earlier derivation by prokofev ( 1962 ) is acknowledged .",
    "when terms of @xmath8 and higher are neglected , castor s ( 1972 ) moment equations are recovered .",
    "following mihalas ( 1980 ) , the interaction coefficients ( @xmath9 ) and the radiation field ( @xmath10 ) are expressed in the cmf but spacetime coordinates @xmath11 and flow velocities @xmath12 are measured in the rest frame ( rf ) .",
    "since radiation quantities always refer to the cmf , primes or suffixes to indicate this frame are omitted ( cf .",
    "mihalas 1980 , sect .",
    "iii ) .    in a homologous spherical flow",
    ", we have @xmath13 . for @xmath14 ,",
    "the flow is an explosion ( @xmath15 ) starting with infinite density at @xmath16 . for @xmath17 ,",
    "the flow is an implosion ( @xmath18 ) leading to infinite density at @xmath16 .    when eq .",
    "( 2.12 ) of mihalas ( 1980 ) is applied to the homologous flow of matter with a grey extinction coefficient , the resulting frequency - integrated transfer equation is @xmath19 here the dependent variable is the integrated specific intensity @xmath20 , the radial coordinate @xmath21 has been replaced by @xmath22 , the time derivative is lagrangian , and @xmath23 .",
    "moment equations can be derived from eq .",
    "( 1 ) as usual by multiplying by @xmath24 with @xmath25 and then integrating over direction cosine @xmath26 .",
    "alternatively , eqs .",
    "( 2.16 ) and ( 2.17 ) in mihalas ( 1980 ) can be simplified to the case of homologous flow , as above for his transfer equation .",
    "the resulting equations are @xmath27 for the zeroth moment , and @xmath28 for the first moment .",
    "following mihalas ( 1980 ) , eddington s flux variable @xmath29 is here preferred to the standard flux @xmath30 .",
    "the integrated physical flux in the cmf is therefore @xmath31 .",
    "comparing eqs .",
    "( 2 ) and ( 3 ) with eqs . ( 2.16 ) and ( 2.17 ) of mihalas ( 1980 ) , we see that specializing to homologous flow has resulted in a huge simplification in the coefficients of the moments @xmath32 , @xmath29 and @xmath33 .",
    "most notably , the coefficient of @xmath33 in the zeroth moment equation reduces to zero , so now only @xmath32 and @xmath29 appear in this equation .      in order to construct simple solutions of these equations for use in testing computer codes , we first effect a separation of variables .",
    "this is achieved by writing the specific intensity @xmath34 where @xmath35 is an arbitrary reference time , and the exponent @xmath36 is unspecified . with this assumption ,",
    "each term on the left - hand side of eq .",
    "( 1 ) scales as @xmath37 . accordingly",
    ", we must assume that @xmath38 and @xmath39 not surprisingly , this necessary scaling of the extinction coefficient per unit volume implies that the ratio of @xmath40 , the local mean free path of a photon , to the radius of the configuration is time - independent .",
    "( 4)-(6 ) are substituted in eq .",
    "( 1 ) , the scaling factor cancels by construction , and we thus obtain the transfer equation @xmath41   i_{1 }   \\nonumber \\\\   = \\eta_{1 } - \\chi_{1 } \\ , i_{1}\\end{aligned}\\ ] ] that determines the scale - free radiation field @xmath42 .",
    "the moments @xmath32 , @xmath29 and @xmath33 evidently also scale as @xmath43 .",
    "the equations satisfied by the corresponding scale - free moments @xmath44 , @xmath45 and @xmath46 are @xmath47 for the zeroth moment , and @xmath48 for the first moment .    eqs .",
    "( 7)-(9 ) are the basic equations of this investigation .",
    "if mc techniques are used directly to simulate the physics of radiation transport , then the mc quanta are photons and convergence to the solution of the radiative transfer equation ( rte ) requires that @xmath49 , where @xmath50 is the number of photons whose interaction histories are followed . in such a code , in addition to crossings of boundaries , mc quanta are created spontaneously within the computational domain @xmath51 by sampling the thermal emissivity and may subsequently be destroyed within @xmath51 by absorption . because the rte is directly simulated , testing such mc codes is not fundamentally different from testing a conventional numerical solution of the rte .",
    "however , for tranfer problems involving interactions between radiation and the internal energy states of matter , there are advantages in taking the mc quanta to be indestructible and indivisible energy ( @xmath52- ) packets ( lucy 2003 , and references therein ) . in such a code ,",
    "in addition to crossings of boundaries , @xmath52-packets are created spontaneously within @xmath51 by sampling the _ net _ emissivity ( i.e. , emission minus absorption ) but then , though the nature of the contained energy may change , they are not subsequently destroyed within @xmath51 by absorption .",
    "let the integrated net emissivity per unit volume at time @xmath35 be @xmath53 , where @xmath54 this quantity creates radiant energy within the configuration by a physical mechanism that need not be specified for test problems .    if we replace the right - hand side of eq .",
    "( 8) by @xmath55 and eliminate @xmath56 from the left - hand side by setting @xmath57 , the result is an ordinary differential equation ( ode ) for @xmath45 , @xmath58 this equation can be solved analytically with the integrating factor @xmath59 .",
    "the solution satisfying the boundary condition @xmath60 is @xmath61 note that this formula is exact . in transfer theory ,",
    "analytic formulae for moments are typically not exact because they are derived with eddington s closure approximation @xmath62 . here",
    "this is not necessary : k and j drop out of the zeroth moment equation because of the assumptions of homologous flow and scaling exponent @xmath57 .",
    "a second point to note is that @xmath45 has been derived without specifying the scale - free extinction coefficient .",
    "accordingly , eq . ( 12 ) is valid for arbitrary @xmath63 .",
    "it is of interest to note that the scaling @xmath57 arises naturally in the limiting case of completely opaque matter within which there is no net emissivity . in this case , the right - hand side of eq .",
    "( 2 ) is zero , and the cmf flux @xmath64 since radiation is position - coupled to matter .",
    "the solution of eq .",
    "( 2 ) is then such that @xmath65 , corresponding to adiabatic evolution of the radiation energy density present initially .",
    "in contrast , in the solution derived here , this same scaling is maintained because every layer s losses due to flux divergence is exactly replaced by the net emissivity in that layer .",
    "moreover , the similarity solution represents the state reached when initial conditions have been erased .",
    "the simplest case for testing a mc code is when @xmath66 is independent of @xmath67 .",
    "this also simplifies the evaluation of the exact @xmath45 since the integral in eq .",
    "( 12 ) is then analytic .",
    "the result is @xmath68\\ ] ] thus we obtain an exact closed - form expression for the cmf flux in a particular time - dependent relativistic flow .",
    "the corresponding moment @xmath44 can not be obtained exactly .",
    "but an approximate formula can be derived from eqs .",
    "( 9 ) and ( 13 ) with the help of eddington s closure approximation and surface boundary condition .",
    "the resulting formula for @xmath56 can then be substituted in eq .",
    "( 10 ) to obtain an approximate formula for the conventional emissivity @xmath69 .",
    "details are omitted .      in order to illustrate how",
    "similarity solutions can be used to test codes , we now briefly report mc calculations for relativistic homologous flows .",
    "the mc code is a spherically - symmetric and fully relativistic version of the 3-d code described recently ( lucy 2004 ) . as in that code , the mc quanta are indestructible @xmath52-packets .",
    "the calculations start at reference time @xmath35 with no @xmath52-packets present . but as time advances , @xmath52-packets spontaneously appear in accordance with the net emissivity @xmath70 and then propagate through the configuration interacting with matter in accordance with extinction coefficient @xmath71 .",
    "we choose to create equal numbers of @xmath52-packets in equal intervals of @xmath72 and having cmf energies @xmath73 that are independent of @xmath67 .",
    "the energy @xmath74 created in the cmf within the space - time element @xmath75 is @xmath76 .",
    "but since @xmath75 is invariant under the lorentz transformation , we may regard @xmath75 as referring to the rf .",
    "accordingly , for the particular case ( sect .",
    "3.2 ) where @xmath77 does not depend on @xmath67 , the total cmf energy created in the rf interval @xmath78 is @xmath79 , where @xmath80 is the rf volume at time t. thus , if @xmath81 gives the packet creation rate , and we set @xmath57 , then the packets cmf energies are @xmath82 with @xmath77 independent of @xmath67 , @xmath83 at fixed rf @xmath2 .",
    "accordingly , since we choose @xmath84 to be independent of @xmath67 , equal numbers of packets are created in equal rf volume elements .",
    "the appropriate mc sampling algorithm for the initial rf radius of a packet created at @xmath2 is @xmath85 z$ ] , where @xmath86 and @xmath87 is a random number from @xmath88 . here",
    "@xmath89 is the value of @xmath5 at the surface .",
    "the transport of these packets through the configuration is as described in the earlier paper ( lucy 2004 ) except that now the factor @xmath90 in the doppler formula is restored to make the code fully relativistic .",
    "the cmf energies of the packets that escape from the surface in each rf time step @xmath91 are summed and then divided by @xmath92 to obtain an estimate of the cmf luminosity @xmath93    monte carlo simulations for two strongly relativistic explosions are plotted in fig .",
    "1 . for these simulations ,",
    "the rf time steps are @xmath94 , during each of which @xmath95 additional @xmath52-packets are created with cmf energies given by eq .",
    "( 14 ) .",
    "the evolution of the cmf luminosity is shown starting at @xmath35 , together with the predicted result @xmath96 , with @xmath97 from eq .",
    "one solution is the free streaming limit ( @xmath98 ) and the second ( @xmath99 ) has photon mean free paths @xmath100 . in both cases , the mc solutions tend asymptotically to the similarity solution , the convergence being somewhat slower for @xmath99 because of the longer residence times of the @xmath52-packets . since agreement is achieved in both cases , the prediction , for @xmath57 , that the cmf flux @xmath29 is independent of @xmath101",
    "is confirmed .",
    "although relatively trivial , it is of interest to illustrate the application to implosions .",
    "accordingly , fig .",
    "2 shows the same two test problems but with the signs of @xmath35 and @xmath102 reversed .",
    "again , after a transition period during which the internal radiation field is established , the mc solutions converge to the similarity solution .",
    "this possibility of testing numerical treatments of radiative transfer in relativistic implosions is possibly relevant for codes that simulate laser - driven implosions in support of the quest for fusion by inertial confinement .",
    "accurate numerical solutions for relativistic inflows have also been computed by yin & miller ( 1995 ) , who stress the dramatic effects that can arise from photon trapping .",
    "but their solutions are only for stationary flows .",
    "apart from the degenerate case @xmath103 , the exact solution of sect .",
    "3 is not appropriate for the precision testing of a conventional relativistic transfer code since the implied scale - free emissivity @xmath69 could only be determined approximately .",
    "accordingly , we now seek exact solutions when @xmath69 is specified rather than @xmath55 .      as did mihalas ( 1980 , sect .",
    "iiib ) for his general equation , we construct characteristics for eq.(7 ) such that the partial differential operator becomes a perfect differential .",
    "( 7 ) becomes @xmath104    \\ , i_{1 } =   \\eta_{1}\\ ] ] where @xmath105 is distance along a characteristc defined by the equations @xmath106 dividing these equations , we find that @xmath107 is constant along characteristics .",
    "accordingly , the family of characteristics is given by @xmath108 where @xmath109 is a characteristic s direction cosine at its entry point into the configuration .",
    "integrations of eq .",
    "( 15 ) proceed inwardly along such characteritics starting at @xmath110 with the boundary condition @xmath111 and continuing until the characteristic emerges at the surface with @xmath112 .    in fig .",
    "3 , the characteristics are plotted for various values of @xmath113 when @xmath114 . note that , to obtain a characteristic that penetrates close to the centre , the parameter @xmath113 must closely approach @xmath115 .",
    "the point of closest approach ( @xmath116 ) is at @xmath117 , or , equivalently , at @xmath118 .",
    "parenthetically , we note that these analytic characteristic curves provide a further powerful test of the relativistic mc code described in sect . 3.3 . in the free streaming case",
    ", each @xmath52-packet follows its appropriate characteristic to high precision , as it should . at creation ,",
    "an @xmath52-packet s initial @xmath67 and @xmath26 determine its invariant @xmath119 and hence @xmath113 from eq .",
    "the packet then propagates along this characteristic in the direction of increasing @xmath120 until it escapes at the surface @xmath121 with @xmath112 .",
    "the simplicity of the characteristics for homologous flow allows the dimensionless arc length @xmath120 to be evaluated analytically as a function of @xmath67 .",
    "integrating the first member of eq .",
    "( 16 ) after eliminating @xmath26 with eq .",
    "( 17 ) , we find that , along the inwardly - directed @xmath122 segment of a characteristic , @xmath123\\ ] ] the corresponding formula after the point of closest approach @xmath124 is @xmath125\\ ] ] because the function @xmath126 is readily inverted to give @xmath127 , the remaining quantities @xmath128 and @xmath129 can likewise be transformed into functions of @xmath120 along the characteristic defined by @xmath113 for the given @xmath89 ; and this remark therefore applies also to the coefficient of @xmath130 in eq .",
    "( 15 ) .",
    "let us now define the effective extinction coefficient along a characteristic to be @xmath131 with corresponding effective optical depth @xmath132 in terms of these quantities , the formal solution of eq .",
    "( 15 ) subject to the boundary condition @xmath133 at @xmath134 is @xmath135 with straightforward numerical integrations , eqs . ( 18 ) - ( 22 ) allow the intensity @xmath136 to be determined as a function @xmath120 along the characteristic defined by @xmath113 . by varying @xmath113 from @xmath115 to @xmath137",
    ", we can thus determine @xmath138 throughout the @xmath139-plane .",
    "this reduction of the problem to solution with the formal integral strongly suggests that these results could also be obtained with the method developed by baschek et al .",
    "although their paper is restricted to stationary relativistic flows , they note that time - dependent problems can be treated .",
    "the above analysis shows that , with the scaling assumptions for @xmath7 and @xmath6 given in eqs .",
    "( 5 ) and ( 6 ) , the time - dependent relativistic transfer problem for homologous spherical flow , reduces asymptotically to a tranfer problem in a static medium . for explosions",
    ", the solution tends to this asymptote as @xmath140 ; for implosions , the limit is @xmath141 . for free - streaming",
    ", the similarity solution is achieved after all light signals emitted from within the configuration at @xmath142 have escaped .    because light travel - time and relativistic effects are absent in a static medium , these effects reappear in eq .",
    "( 20 ) as corrections to the extinction coefficient .",
    "the term @xmath143 , which survives in the limit @xmath144 , represents the combination of finite propagation speed and the time - dependence of the emissivity . the second correction term , which @xmath145 as @xmath144 , represents relativistic effects .",
    "note that these corrections can give @xmath146 , which implies that @xmath147 is not necessarily a monotonically increasing function of @xmath120 .",
    "accordingly , @xmath147 is not appropriate as an alternative independent variable for eq .",
    "( 15 ) .",
    "although the analysis of sect .",
    "4.1 provides a complete solution for the scale - free radiation field without assumptions about @xmath148 or @xmath63 , the answer is not in closed analytic form as was the earlier result ( eq . [ 13 ] ) for the cmf flux @xmath149 when the net emissivity @xmath77 is independent of @xmath67 .",
    "interestingly , an analogous result can be constructed when the conventional emissivity @xmath7 is the quantity specified .    the coefficient of @xmath56 in eq .",
    "( 8) is zero if we set @xmath150 thus @xmath151 is necessary for @xmath152 , while @xmath57 gives free - streaming radiation .    with @xmath101 given by eq .",
    "( 23 ) , eq .",
    "( 8) simplifies to @xmath153 this equation has integrating factor @xmath154 , and so the solution satisfying the boundary condition @xmath60 is @xmath155 a simple case for which this integral is analytic is obtained by assuming that @xmath69 is independent of @xmath67 and that @xmath156 .",
    "the result is @xmath157 with this exact formula , a code that solves relativistic transfer problems with conventional techniques can be subjected to tests similar to those described in sect .",
    "3.3 for a mc code based on @xmath52-packets .      the particular case of sect .",
    "4.2 is remarkable in that the complete solution can be obtained in closed form .",
    "the starting point is eq .",
    "( 15 ) with @xmath101 from eq .",
    "the independent variable @xmath120 is conveniently transformed to @xmath67 using the first member of eq .",
    "the resulting transfer equation is @xmath158 where , from eq .",
    "( 17 ) , @xmath159 here the negative root applies along the inward segment of a characteristic as @xmath67 decreases from @xmath89 to @xmath160 - see fig .",
    "3 . thereafter , the positive root applies .",
    "the integrating factor for eq .",
    "( 27 ) is @xmath161 . accordingly , substituting for @xmath26 , imposing boundary condition @xmath162 , setting @xmath156 , and assuming that @xmath69 is independent of @xmath67 , we find that the intensity of inwardly - directed radiation is    @xmath163    which simplifies to @xmath164\\ ] ] where @xmath165 with @xmath166 the outwardly - directed intensity is obtained similarly . in this case",
    ", the boundary condition is @xmath167 , and the solution is @xmath168\\ ] ]    eqs .",
    "( 30 ) and ( 33 ) determine the intensity along the characteristic defined by @xmath113 .",
    "but these formulae can readily be used to calclulate @xmath42 , the intensity as a function of @xmath26 at fixed @xmath67 .",
    "given @xmath26 and @xmath67 , eq .",
    "( 17 ) determines @xmath169 , which in turn determines @xmath160 , so that @xmath170 and similarly of course for @xmath171 . thus the right - hand sides of eqs .",
    "( 30 ) and ( 33 ) are now functions of @xmath26 and @xmath67 , and the characteristics are no longer relevant .",
    "this exact closed form analytic solution has been checked by substitution back into eq .",
    "( 7 ) using numerical differentation to evaluate the two partial derivatives .    in fig.3 ,",
    "the emergent intensity given by eq .",
    "( 33 ) is plotted for various values of @xmath89 .",
    "this shows extremely strong forward peaking when @xmath114 , with huge intensities when @xmath172 .",
    "this is basically a light travel - time effect : with @xmath114 radiation emerging with @xmath173 includes photons emitted shortly after the explosion when , since @xmath174 , the emissivity was much higher than that now in the surface layers .",
    "one consequence of this forward peaking is poor accuracy for eddington s approximations .",
    "thus , at the surface of the @xmath114 solution , @xmath175 and @xmath176 , as against eddington s values of @xmath177 and @xmath178 , repectively .      thus far the physical mechanisms responsible for extinction and emission have not been specified .",
    "but let us now suppose that @xmath179 where @xmath180 and @xmath181 are grey absorption and scattering coefficients , respectively .",
    "the corresponding integrated emissivity coefficient is then @xmath182 where @xmath183 is the integrated planck function , and the scattering is isotropic in the cmf .",
    "( 34 ) and ( 35 ) are consistent with the scaling of eqs .",
    "( 5 ) and ( 6 ) if @xmath180 and @xmath181 are @xmath184 and if @xmath185 . given these scalings , the exact solution of sect .",
    "4.2 can now be applied as follows : we set @xmath186 and choose the scale - free functions @xmath187 and @xmath188 such that their sum satisfies eq .",
    "( 23 ) . then , since @xmath44 can be computed from eqs .",
    "( 30 ) and ( 33 ) , the implied scale - free function @xmath189 can be derived from eq .",
    "because the thermal emissivity is now known , this analytic solution can be used to test a code that incorporates an iteration procedure to detemine the scattering contribution to the emissivity .",
    "the net emissivity @xmath190 is also determined by the above steps .",
    "accordingly , this analytic solution can be used to test mc codes based on @xmath52-packets .",
    "moreover , this test is in principle more powerful than that provided by the flux moment solution of sect .",
    "3.2 since the angular distribution of the mc radiation field can now also be checked .",
    "the aim of this paper has been to derive exact analytic solutions in order to test radiative transfer codes for relativistic flows .",
    "such solutions exist for spherically - symmetric homologous flows with power - law time dependencies for the grey extinction coefficient and the integrated emissivity .",
    "the exact solution for the integrated intensity derived in sect .",
    "4.4 , being a function of three independent variables @xmath191 and one parameter @xmath89 , provides an extraordinarily demanding and informative test for such codes . moreover , its somewhat contrived derivation based on a particular spatial variation of @xmath6 in no way lessens its usefulness .",
    "in addition to deriving closed form analytic formulae for the intensity and flux in the cmf , an exact formula has been derived for the characteristics .",
    "this allows the kinematic and geometric aspects of relativistic transport codes to be tested independently of the treatments of absorption and emission . for mc codes , this test is carried out by setting the extinction coefficient to zero and then checking that photon packets propagate along the known characteristics .    in solving time - dependent transport problems with the rte , the time derivatives are commonly approximated with a backward difference formula , thus using the solution at the previous time step .",
    "this introduces errors @xmath192 that might well accumulate as the integration proceeds . with the availability of an exact time - dependent solution , the magnitude of the accumulated error can be determined .",
    "if the error accumulation is unacceptable , a higher order difference formula can be employed that uses the solutions at the two previous time steps ( lucy 2004 ) ."
  ],
  "abstract_text": [
    "<S> exact analytic solutions are derived for radiation in time - dependent relativistic flows . </S>",
    "<S> the flows are spherically - symmetric homologous explosions or implosions of matter with a grey extinction coefficient . </S>",
    "<S> the solutions are suitable for testing numerical transfer codes , and this is illustrated for a fully relativistic monte carlo code . </S>"
  ]
}