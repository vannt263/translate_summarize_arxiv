{
  "article_text": [
    "in this paper , we study virtual properties ( i.e.  properties that hold for some finite covering ) of nonpositively curved graph manifolds .",
    "our main result is the following , ( cf .",
    "section [ sec - prelim ] for terminology ) :    [ main - npcgm ] let @xmath0 be an aspherical compact graph manifold",
    ". then the following statements are equivalent :    1 .",
    "@xmath0 is nonpositively curved ; 2 .",
    "@xmath0 is virtually homotopy equivalent to a special cube complex ; 3 .",
    "@xmath1 virtually embeds into a finitely generated right - angled artin group ; 4 .",
    "@xmath1 is virtually rfrs .    by the rfrs criterion of ian agol for virtual fibering ( @xcite , cf .",
    "subsection [ subsec - rfrs ] ) , theorem [ main - npcgm ] strengthens a result of pavel svetlov that nonpositively curved graph manifolds virtually fibers over the circle , ( @xcite , cf .",
    "subsection [ subsec - graphmfd ] ) .",
    "we have also learned recently that piotr przytycki and daniel wise have an independent proof of the special cubulation for the bounded case using criteria of separability and double - coset separability of surface subgroups , ( @xcite ) .",
    "it has also been conjectured that @xmath2-manifold groups are linear . because finitely generated right - angled artin groups are known to be linear ( cf .",
    "subsection [ subsec - raag ] ) , and because linearity is a commensurability - class property , an interest of theorem [ main - npcgm ] is the following :    the fundamental group of any nonpositively curved compact graph manifold is linear .",
    "theorem [ main - npcgm ] is motivated by some recent progress in the virtual fibering conjecture ( vfc ) . back to the 1980s",
    ", william thurston conjectured that every hyperbolic @xmath2-manifold virtually fibers over the circle , ( @xcite ) .",
    "two years ago , daniel wise announced a proof of this conjecture for hyperbolic @xmath2-manifolds that contain essentially embedded geometrically finite closed subsurfaces , using quasiconvex hierarchies ( @xcite ) .",
    "in fact , he showed that every such manifold is virtually homotopy equivalent to a finite - dimensional special cube complex .",
    "hence the fundamental group of any such manifold virtually embeds into a right - angled artin group .",
    "this implies virtual fibering by agol s criterion .",
    "thus the vfc for hyperbolic @xmath2-manifolds is implied by the virtual haken conjecture ( vhc ) that every closed @xmath2-manifold virtually contains an ( embedded ) incompressible subsurface . in more general context",
    ", the statement of the vfc is known to be false for many graph manifolds , ( cf .",
    "subsection [ subsec - graphmfd ] ) , and for any closed seifert - fibered space with nontrivial euler class of the fiber .",
    "nevertheless , it has been conjectured that the vfc holds for nonpositively curved @xmath2-manifolds , ( cf .",
    "* conjecture 9.1 ) ) .",
    "based on wise s work and theorem [ main - npcgm ] , a reasonable specification of this conjecture might be the following - manifold groups since the announcement of this paper in the fall of 2011 .",
    "the remaining cases of conjecture [ npcvsp ] are verified by @xcite .",
    "the introduction is now a little behind the times but we prefer keeping it as a historical record . ] :    [ npcvsp ] an aspherical compact @xmath2-manifold is nonpositively curved if and only if its fundamental group virtually embeds into a right - angled artin group .",
    "we explain our strategy to prove theorem [ main - npcgm ] .",
    "it suffices to consider the nontrivial case , namely , where the graph manifold is not itself seifert fibered . from known results , ( cf .",
    "theorems [ thm - sv ] , [ thm - ag ] ) , all the statements of theorem [ main - npcgm ] imply virtual fibering . by a trick of doubling the @xmath2-manifold along boundary , and by verifying the anosov - mapping - torus case directly",
    ", we shall focus on the case that @xmath0 is the mapping torus @xmath3 of a multitwist @xmath4 on an oriented closed surface @xmath5 , ( definition [ multitwist ] ) .",
    "our plan is to show ( 1 ) @xmath6 ( 2 ) @xmath6 ( 3 ) @xmath6 ( 4 ) @xmath6 ( 1 ) , where only the first and the last implications require our effort .    to show virtual rfrs - ness implies nonpositive curving , we introduce the current equations associated to the multitwist @xmath4 . a nondegenerate symmetric solution of this system of equations is virtually ensured by the rfrs condition .",
    "such a solution can be pertubed into a nondegenerate symmetric solution of certain structural equations regarding to nonpositively curved metrics , called the bkn equations .",
    "this will provide a nonpositively curved metric on @xmath3 . to show that nonpositive curving implies a virtual special cubulation",
    ", we apply a technique used by svetlov to find a virtually embedded surface , which virtually guarantees a nondegenerate symmetric solution to the current equations .",
    "with such a solution in hand , we shall find a finite collection of first cohomology classes , whose duals are supposably represented by subsurfaces of @xmath3 appropriate for the sageev construction .",
    "keeping this in mind , we shall , however , implement a more explicit construction .",
    "it turns out the cubical geometry of the cube complex will be so well understood that one can nicely recognize its virtual specialness .    in section [ sec - prelim ] ,",
    "we provide background materials related to our discussion . in section [ sec - eqns ] ,",
    "we introduce the notion of multitwists and their configuration graphs .",
    "we setup the current equations and the bkn equations , and show the virtual equivalence of the existence of their nondegenerate symmetric solutions . in section [ sec - spcubulation ] , we construct a special cube complex homotopy equivalent to the mapping torus of any multitwist with a bipartite configuration graph . in section [ sec - mainproof ] ,",
    "we combine all the partial results above and provide a proof of theorem [ main - npcgm ] .",
    "* acknowledgement*. the author thanks ian agol and piotr przytycki for valuable communications , and stefan friedl for suggestion on the statement of theorem [ main - npcgm ] .",
    "the author also thanks the referees for proofreading and comments .",
    "in this section , we recall some notions and known results relevant to our discussion . as we are only interested in virtual properties in this paper , we shall always work with orientable @xmath2-manifolds for convenience .",
    "we refer to @xcite for standard terminology and facts in @xmath2-manifold topology .",
    "a compact @xmath2-manifold is said to be _ nonpositively curved _ if it supports a complete riemannian metric in the interior with everywhere nonpositve sectional curvature .",
    "this is equivalent to being virtually nonpositively curved , ( @xcite ) .",
    "it is well known that nonpositively curved @xmath2-manifolds are all aspherical .",
    "atoroidal aspherical @xmath2-manifolds are hyperbolic by the geometrization , so these are clearly nonpositively curved .",
    "a seifert fibered space is nonpositively curved if and only if it is virtually a product of the circle and a compact surface other than the sphere , ( @xcite ) .",
    "a torus bundle with an anosov monodromy , and hence any @xmath7-geometric @xmath2-manifold , is not nonpositively curved , ( @xcite , @xcite ) . by a result of bernhard leeb , any aspherical compact @xmath2-manifold with either nonempty boundary or at least one atoroidal jsj piece",
    "is nonpositively curved , ( @xcite ) .",
    "he also discovered the first family of nontrivial graph manifolds other than the @xmath7-manifolds which are not nonpositively curved . in @xcite , sergei buyalo and pavel svetlov provided several characterizations of nonpositively curved graph manifolds in terms of certain structure equations and operators associated to the jsj graph , ( cf .",
    "subsection [ subsec - bkneqns ] ) .",
    "a _ graph manifold _ is an irreducible compact orientable @xmath2-manifold obtained by gluing up compact seifert fibered spaces along boundary .",
    "we say a graph manifold is _ nontrivial _ if it is not a seifert fibered space , or in other words , if it has a nontrivial jsj decomposition .",
    "recall that for any orientable irreducible compact @xmath2-manifold , the jaco - shalen - johanson ( jsj ) decomposition provides a minimal finite collection of essential tori , canonical up to isotopy , which cuts the manifold into atoroidal and seifert fibered _",
    "pieces_. graph manifolds are precisely compact @xmath2-manifolds with only seifert - fibered pieces .",
    "note that if a @xmath2-manifold is virtually a torus bundle with an anosov monodromy , it is a nontrivial graph manifold according to our convention , but in literature ( e.g.  @xcite ) , some authors exclude this case , and use the term ` nontrivial ' in a the sense of having nontrivial jsj decomposition with seifert - fibered jsj pieces over hyperbolic bases .",
    "much has been explored on virtual properties of graph manifolds during the past two decades . here",
    "we are most interested in virtual fibering and nonpositive curving . in @xcite ,",
    "john luecke and yingqing wu exhibited examples of graph manifolds that are not virtually fibered over the circle .",
    "there are also graph manifolds that are fibered but not nonpositively curved , for example , the mapping torus @xmath3 of an automorphism @xmath4 of a closed oriented surface @xmath5 of nonpositive euler characteristic , where @xmath4 is the product of positive powers of right - hand dehn twists along a nonempty collection of disjoint , mutually non - parallel simple closed curves on @xmath5 , ( ( * ? ? ?",
    "* theorem 3.7 ) ) .",
    "however , pavel svetlov proved :    [ thm - sv ] nonpositively curved graph manifolds virtually fiber over the circle .",
    "svetlov s proof relies on a criterion of hyam rubinstein and shicheng wang on the separability of immersed horizontal surfaces in graph manifolds . in @xcite ,",
    "this approach was systematically developed , providing characterizations of various virtual properties of graph manifolds , on three levels in terms of homological , geometric , and operator - spectral data , respectively . for our purpose",
    "the second level is particularly interesting , as it describes the nonpositively curved metric on the graph manifold , via the so - called bkn equations .",
    "we shall investigate this system of equations in more details in section [ sec - eqns ] .",
    "the paper @xcite is written in an elegant , expository style , so we recommend it for further information of the reader .",
    "special cube complexes were introduced by frdric haglund and daniel wise ( cf .",
    "@xcite ) as suitable generalizations of graphs in higher dimensions .",
    "heuristically speaking , these are cube complexes in which hyperplanes are ` properly embedded in properly transversal positions ' in certain combinatorial sense .",
    "the building blocks in a cube complex are euclidean _",
    "@xmath8-cubes _ , namely , isometric copies of the double - unit cube @xmath9^n\\subset{{\\mathbf r}}^n$ ] for each dimension @xmath10 . for all dimensions @xmath11 ,",
    "every @xmath8-cube contains exactly @xmath8 _ midcubes _ which are the @xmath12-cubes obtained from @xmath9^n$ ] intersecting with each coordinate hyperplane through the origin of @xmath13 , and @xmath14 _ corners _ , which are the @xmath8-simplices each spanned by the half - edges adjacent to a single vertex .",
    "[ cubecplx ] a _ cube complex _",
    "@xmath15 is a cw complex whose cells are identified as cubes , such that the attaching maps are combinatorial in the sense that they send the faces of cubes isometrically onto lower - dimensinoal cubes . for any vertex @xmath16 ,",
    "the _ link _ @xmath17 of @xmath18 is the complex of simplices over which the union of the corners - of - cubes at @xmath18 can be naturally regarded as a cone .",
    "a _ combinatorial map _ @xmath19 between cube complexes is a cellular map , whose restriction to each cube is an isometric homeomorphism onto the image .",
    "it is a ( combinatorial ) _ local isometry _",
    ", often written as @xmath20 , if for any vertex @xmath16 , the induced combinatorial map between links @xmath21 is furthermore an embedding whose image is a full subcomplex , ( i.e. such that a simplex lies in the image whenever all its vertices lie in the image ) .",
    "a cube complex is sometimes said to be _ simple _ if all the links are simplicial complexes . for square ( i.e.  @xmath22-dimensional cube )",
    "complexes , this is equivalent to saying that no link contains a cycle of at most two edges .",
    "nonpositively curved cube complexes are all simple .",
    "a _ nonpositively curved _ cube complex is known as a cube complex whose universal covering is @xmath23 with respect to the naturally induced path metric .",
    "an equivalent combinatorial characterization is that all the links are flag ( i.e. such that any finite collection of pairwisely joined vertices spans a unique simplex ) , ( @xcite ) .    the collection of all the midcubes in a cube complex @xmath15 forms a new cube complex whose",
    "connected components are called _",
    "a hyperplane @xmath24 is _ two - sided _ if it naturally induces a local isometry @xmath25\\looparrowright x$ ] .",
    "a hyperplane @xmath24 is said to be _ self - intersecting _ if there are two edges dual to ( i.e.  across ) @xmath24 lying in a common square of @xmath15 ; or it is said to be ( directly ) _ self - osculating _ if there are two dual edges not in a common square but adjacent at a common vertex , whose directions towards the vertex induces the same side of @xmath24 in an obvious sense .",
    "two distinct hyperplanes @xmath24 , @xmath26 are said to be _",
    "inter - osculating _ if they both intersect and osculate , namely , such that there are two edges dual to @xmath24 and @xmath26 respectively , which share a common square of @xmath15 , and that there are two edges dual to @xmath24 and @xmath26 respectively , which do not share a common square in @xmath15 but share a common vertex .",
    "[ spcubecplx ] a cube complex @xmath15 is said to be _ special _ if its hyperplanes are all two - sided , with no self - intersection , no self - osculation , nor inter - osculation .",
    "[ a - special ] in earlier literatures , ( e.g.  @xcite ) , this property was sometimes refered to as being ` a - special ' , indicating its relation to right - angled rtin groups .",
    "prototype examples of special cube complexes are graphs and the cube complexes of right - angled artin groups , ( cf .",
    "subsection [ subsec - raag ] ) .",
    "it is also known that every special cube complex can be canonically completed by ` filling up cubes ' into a nonpositively curved special cube complex .",
    "let @xmath27 be a ( possibly infinite , and possibly locally infinite ) simplicial graph .",
    "denote the vertex set as @xmath28 , and the edge set as @xmath29 .",
    "the _ right - angled artin group _ associated to @xmath27 is the group : @xmath30\\,:\\,\\{v , v'\\}\\in{{\\mathrm{edg}}}(\\gamma)\\rangle.\\ ] ] free groups and abelian groups are examples of right - angled artin groups , associated to edgeless graphs and perfect graphs , respectively .",
    "right - angled artin groups are closely related to special cube complexes . for any right - angled artin group @xmath31 , there is a special nonpositively curved complex @xmath32 by completing the square complex naturally associated to the defining presentation of @xmath33 .",
    "it has a single vertex , and the edges of @xmath32 correspond to the generators @xmath34 s , and the squares of @xmath32 correspond to the relators @xmath35 $ ] s .",
    "moreover , haglund and wise proved :    [ thm - hw ] a cube complex is special if and only if it admits a local isometry into the cube complex of a right - angled artin group .",
    "in fact , the right - angled artin group associate to a special cube complex @xmath15 can be canonically constructed by taking the simplicial graph whose vertices are hyperplanes in @xmath15 , such that two vertices are joined by an edge if and only if the corresponding hyperplanes intersect each other .",
    "note theorem [ thm - hw ] does not assume the cube complex to be finite dimensional , nor the right - angled artin group to be finitely generated .",
    "finitely generated right - angled artin groups are known to be subgroups of finitely generated right - angled coxeter groups , which are subgroups of @xmath36 for some integer @xmath11 , ( cf .",
    "@xcite , @xcite ) .",
    "in @xcite , ian agol gave a criterion for @xmath2-manifolds to fiber over the circle in terms of a residual - type condition on the fundamental groups .",
    "[ rfrs ] a group @xmath31 is said to be _ residually finite rationally solvable _ ( or _ rfrs _ ) if there is a sequence of finite index subgroups @xmath37 such that @xmath38 , and that the quotient homomorphism @xmath39 factors through a free abelian group for every integer @xmath40 .",
    "examples of virtually rfrs groups are surface groups , reflection groups , and finitely generated right - angled artin groups , following from the more general fact that finitely generated right - angled coxeter groups are virtually rfrs ( ( * ? ? ? * theorem 2.2 ) ) .",
    "[ thm - ag ] let @xmath0 be an orientable compact irreducible @xmath2-manifold of zero euler characteristic . if @xmath1 is virtually rfrs , then @xmath0 virtually fibers over the circle",
    ".    roughly speaking , the rfrs assumption allows one to pass to a suitable sequence of finite cyclic coverings by cutting and pasting the @xmath2-manifold along nonseparating subsurfaces .",
    "this process can be shown to destroy all the nonproduct parts within a finite number of steps , using gabai s sutured manifold hierarchy .",
    "with his criterion , agol showed that reflection @xmath2-orbifolds and arithmetic hyperbolic @xmath2-manifolds defined by quadratic forms virtually fiber .",
    "his criterion is also an ingredient in wise s proof of the virtual fibering conjecture for closed haken hyperbolic @xmath2-manifolds .",
    "in this section , we introduce the system of the current equations and the system of the bkn equations associated to multitwists . a nondegenerate symmetric solution of the current equations reflects the virtual rfrs - ness of the mapping torus , ( lemma [ survivalcriterion ] ) ; and a nondegenerate symmetric solution of the bkn equations reflects the nonpositively - curving property , ( theorem [ thm - bs ] ) .",
    "we show that the existence of such a solution for any one of these two systems virtually implies that for the other , ( proposition [ nssolutions ] ) .",
    "let @xmath5 be an oriented closed surface of negative euler characteristic .",
    "for any essential simple closed curve @xmath41 on @xmath5 , we denote the ( right - hand ) dehn twist on @xmath5 along @xmath41 as : @xmath42 note it does not depend on the direction of @xmath41 .",
    "it induces the automorphism of @xmath43 defined by @xmath44,\\alpha)\\,[z]$ ] for any @xmath45 , where @xmath46 denotes the intersection form .",
    "[ multitwist ] let @xmath5 be an oriented closed surface of negative euler characteristic , and @xmath47 be a collection of mutually disjoint , mutually non - parallel essential simple closed curves , and @xmath48 be nonzero integers .",
    "the _ multitwist _",
    "@xmath4 on @xmath5 along these curves with multiplicity @xmath49 s is the automorphism ( i.e.  orientation - preserving self - homeomorphism ) defined by @xmath50 .",
    "we often more specifically denote a multitwist by the pair @xmath51 .",
    "the jsj decomposition of the mapping torus @xmath3 of a multitwist @xmath51 is fairly easy to describe .",
    "recall that for an oriented closed surface @xmath5 with an automorphism @xmath4 , the mapping torus @xmath3 associated to the pair @xmath51 is the closed oriented @xmath2-manifold obtained from @xmath52 $ ] identifying @xmath53 with @xmath54 for every @xmath55 . with the notations above , a jsj torus of @xmath3 is the suspension of some @xmath56 , namely , the image of @xmath57 $ ] in @xmath3 ; and a jsj piece is the suspension of some component of @xmath58 ( i.e.  the compact surface obtained from @xmath5 by removing open regular neighborhoods of @xmath56 s ) .",
    "we shall usually denote the union of jsj tori of @xmath3 as @xmath59 , and the disjoint union of ( compact ) jsj pieces as @xmath60 .",
    "there is a naturally induced graph ( i.e.  a cw @xmath61-complex ) : @xmath62 dual to the decomposition , called the _ jsj graph _ , whose vertex set @xmath63 labels to the jsj pieces , and whose edge set @xmath64 labels to the jsj tori .",
    "for any jsj piece @xmath65 corresponding to a vertex @xmath66 , each component of @xmath67 is a torus @xmath68 s labelled by an end - of - edge @xmath69 adjacent to @xmath18 .",
    "we often denote the set of ends - of - edges as @xmath70 , which may be regarded as a two - fold covering of @xmath64 . for any end - of - edge @xmath69",
    ", there is a natural orientation - reversing homeomorphism : @xmath71 where @xmath72 is the opposite end of the edge which @xmath69 belongs to , satisfying @xmath73 .",
    "these @xmath74 s together defines an orientation - reversing involution : @xmath75 often referred to as the _",
    "gluing_. in view of this , we also re - index the curves @xmath56 s and the multiplicity @xmath49 s by @xmath64 . in the rest of this paper",
    ", it will be convenient to write @xmath76 for @xmath77 whenever @xmath69 is an end of @xmath78 .",
    "thus : @xmath79 we also index the components of @xmath80 by @xmath63 , writing @xmath81 for the component indexed by @xmath66 .    we may integrate the defining information for a multitwist alternatively as follows . by a _ cycle _",
    "@xmath82 of @xmath83 , we mean a sequence of mutually distinct , consecutive directed edges @xmath84 such that the terminal endpoint of @xmath85 coincides with the initial endpoint of @xmath86 .",
    "a graph @xmath83 is said to be _ bipartite _ if every cycle of @xmath83 consists of an even number of edges .",
    "let @xmath51 be a multitwist .",
    "the _ configuration graph _ associated to @xmath51 is the triple : @xmath87 where @xmath83 is the jsj graph of @xmath3 , and the integer @xmath88 is the euler characteristic of @xmath81 for each vertex @xmath66 , and the integer @xmath89 is the dehn - twist multiplicity along the curve @xmath90 for each edge @xmath91 .",
    "a _ bipartite _",
    "configuration graph is such that @xmath83 is bipartite .",
    "it is clear that the positive integer @xmath92 is greater than the valence of @xmath18 minus one . given a graph decorated with nonzero integers satisfying this compatibility , one may canonically recover a multitwist @xmath51 . however , it turns out that @xmath93 s are irrelevant to the virtual properties of @xmath94 listed in theorem [ main - npcgm ] .",
    "every jsj piece @xmath95 of @xmath3 has a natural product structure @xmath96 , where @xmath97 are parallel to the copy @xmath98 , and where @xmath99 are the seifert fibers directed forward along the suspension flow .",
    "thus every ( preglue ) jsj torus @xmath100 has a canonical _ waldhausen basis _ ,",
    "namely : @xmath101 where @xmath102 is the directed seifert fiber , and @xmath103 is component with the induced orientation .",
    "in other words , @xmath104 $ ] and @xmath105 $ ] forms a basis of @xmath106 with the intersection number @xmath107,\\,[z_\\delta])=1 $ ] . by a straightforward computation , @xmath108",
    "is given by the formula : @xmath109 )   & =   &    [ f_{\\bar\\delta}]&+   & b_\\delta\\,[z_{\\bar\\delta}],\\\\                  \\phi_{\\delta*}([z_\\delta ] )   & =   &                    &    & -\\,[z_{\\bar\\delta } ] .",
    "\\end{array}\\ ] ] in particular , @xmath76 equals the intersection number between seifert fibers from the two sides of @xmath68 , namely , @xmath110,\\,\\phi_{\\bar\\delta*}[f_{\\bar\\delta}])$ ] on @xmath106 .",
    "in fact , the latter is the usual definition of @xmath76 ( or @xmath77 ) for a graph manifold in general , ( cf .",
    "* subsection 1.3 ) ) .    for every vertex @xmath66 , the _ charge _ at @xmath18 is known as the rational number : @xmath111 it is the euler number of the framing on @xmath112 provided by the seifert fibers from the adjacent pieces , with respect to its own seifert fibration , or more precisely , the unique @xmath113 satisfying @xmath114}{b_\\delta }          = k_v\\cdot [ f_v]$ ] in @xmath115 , with our notations .",
    "the charge at jsj pieces can be defined for general graph manifolds , but unlike for mapping tori of multitwists , it is not always determined by the intersection numbers @xmath77 s between fibers from both sides on the jsj tori , ( cf .",
    "* subsection 1.3 ) ) .",
    "we end up this subsection by pointing out a simplification of our situation .",
    "we say a multitwist ( or more generally , a surface aumorphism ) @xmath116 _ covers _",
    "@xmath51 if there is a covering map @xmath117 such that the diagram below commutes : @xmath118 hence the mapping torus @xmath119 covers @xmath3 if @xmath116 covers @xmath51 .",
    "[ mappingtorus ] every closed , virtually fibered , nontrivial graph manifold is finitely covered by either the mapping torus @xmath3 of an anosov automorphism @xmath120 of the torus , or the mapping torus @xmath3 of a multitwist @xmath51 with a bipartite configuration graph .    if the closed graph manifold is virtually a torus bundle over the circle , it is a nontrivial graph manifold if and only if the monodromy is anosov .",
    "if the virtual fiber has negative euler characteristic , by the nielsen - thurston classification of surface automorphisms ( @xcite ) , a closed , virtually fibered , nontrivial graph manifold is finitely covered by the mapping torus @xmath3 of a nontrivial multitwist @xmath121 of an oriented closed surface @xmath5 of negative euler characteristic . to ensure the bipartition ,",
    "let @xmath122 be the homomorphism defined by the parity counting of edges in cycles of @xmath83 .",
    "the kernel of @xmath123 corresponds to a @xmath22-fold covering @xmath124 of @xmath83 , which furthermore induces a @xmath22-fold covering @xmath117 .",
    "note @xmath125 acts trivially on @xmath126 as any @xmath127 does .",
    "we may lift each @xmath128 to a multitwist on @xmath129 along preimages of @xmath56 , and hence obtain a lift @xmath130 of @xmath131 such that @xmath132 .",
    "note that @xmath124 is bipartite , carrying the configurations of @xmath133 , the pair @xmath133 provides a mapping torus as desired .",
    "let @xmath51 be a multitwist with a bipartite configuration graph . in this subsection",
    ", we introduce a system of _ current equations _ associated to @xmath51 , whose nondegenerate symmetric solutions give rise to nonseparating subsurfaces of @xmath3 intersecting each @xmath90 algebraically nontrivially .",
    "remember a cycle @xmath82 of @xmath83 is a combinatorial closed path formed by a finite number of consecutive directed edges @xmath84 . for any cycle @xmath82 , the set of the initial ends of all the @xmath134 s will be denoted as @xmath135 .",
    "[ currenteqns ] let @xmath51 be a multitwist with a bipartite configuration graph @xmath136 .",
    "the system of the _ current equations _ associated to @xmath51 , with the unknowns @xmath137 where @xmath138 , consists of the following :    * for any vertex @xmath18 of @xmath83 , @xmath139 * for any cycle @xmath82 of @xmath83 , @xmath140    a solution @xmath141 of the current equations is said to be _ symmetric _ if @xmath142 for each end - of - edge @xmath69 , and to be _ nondegenerate _ if no @xmath143 equals zero .",
    "as the equations are linear with integral coefficients , there is a nondegenerate symmetric solution over @xmath144 if and only if there is such a solution over @xmath145 . somewhat coincidentally ,",
    "this system of equations is analogous to the kirchhoff s circuit laws in physics if one allows ` negative resistence ' , which explains its name .",
    "[ survivalcriterion ] let @xmath51 be a multitwist with a bipartite configuration graph .",
    "then the current equations associated to @xmath51 have a nondegenerate symmetric solution if and only if for each edge @xmath91 , the simple closed curve @xmath146 is nontrivial in @xmath147 under the natural inclusion of @xmath5 into the mapping torus @xmath3 .    because @xmath83 is bipartite",
    ", we may pick a bicoloring @xmath148 , so that vertices of the same color have no edge between each other .",
    "this induces directions of the edges , say toward positive vertices , so @xmath90 s are also oriented . as every vertex is adjacent to either only incoming edges or only outgoing edges , a symmetric solution of the current equations at vertices exists if and only if there is a homology class @xmath149\\in h_1(f;{{\\mathbf q}})$ ] with the intersection number @xmath150,\\,[z_e])\\,=\\,x_{e}$ ] , where @xmath151 is the @xmath143 for the initial end @xmath69 of @xmath78 .",
    "when the current equations around cycles are also fulfilled , @xmath152=[s]+\\sum_{e\\in{{\\mathrm{edg}}}({{\\lambda}})}\\,b_ex_e\\,[z_e]$ ] on @xmath153 .",
    "this equals @xmath149 $ ] because the second term vanishes as it evalutes zero on every cycle .",
    "thus we may suspend @xmath149\\in h_1(f;{{\\mathbf q}})$ ] to be a class @xmath154\\in h_2(m_\\sigma;{{\\mathbf q}})$ ] , so that the intersection pairing on @xmath155 gives the intersection number @xmath156,\\,[z_e])\\,=\\,x_e$ ] .",
    "therefore , the existence of a symmetric solution is equivalent to the existence of @xmath154 $ ] which yields @xmath157 s under pairing with @xmath158 $ ] s , and the solution is nondegenerate if and only if @xmath158 $ ] s are nontrivial in @xmath147 .",
    "an immediate consequence is the following :    [ rfrsnssol ] let @xmath51 be a multitwist with a bipartite configuration graph . if @xmath3 is virtually rfrs , then for some positive integer @xmath159 , and for some multitwist @xmath160 finitely covering the @xmath159-th power @xmath161 , the current equations associated to @xmath160 admit a nondegenerate symmetric solution .    by passing to a finite covering",
    ", we may assume that the fundamental group of @xmath162 is itself rfrs .",
    "let @xmath163 be a cofinal filtration of finite index subgroups as in definition [ rfrs ] , and let @xmath164 be the finite regular covering of @xmath0 corresponding to @xmath165 .",
    "for any curve @xmath90 , suppose , as an element of @xmath1 , @xmath90 lies in @xmath165 but not in @xmath166 , then any component of the preimage of @xmath90 in @xmath164 is rational homologically nontrivial .",
    "hence this holds for any finite cover of @xmath164 as well .",
    "as there are finitely many @xmath90 s , we may assume @xmath164 is a finite covering such that the components of the preimage of all @xmath90 s are rationally homologically nontrivial .",
    "note that @xmath164 is the mapping torus of some automorphism @xmath167 covering @xmath51 of finite degree , where @xmath129 is the regular covering of @xmath5 corresponding to the subgroup @xmath168 . by further passing to sufficiently high power @xmath169 of @xmath170",
    ", we have that @xmath160 is a multitwist .",
    "it has a bipartite configuration graph since this holds for @xmath51 , so from above we conclude that it has a nondegenerate symmetric solution by lemma [ survivalcriterion ] .    in figure [ figcurrent ] , we have sketched a nondegenerate current on an orientable closed surface with a multitwist .",
    "the simple closed curves marked with integers indicate the @xmath90 s and @xmath77 s , while the directed green curves represents a nondegenerate _",
    "current _ , by which we mean a first homology class preserved by the multitwist that intersects each @xmath90 algebraically nontrivially .          for a nontrivial graph manifold ,",
    "the buyalo - kobelski - neumann ( bkn ) equations are structure equations related to nonpositively curved metrics .",
    "focusing on mapping tori of multitwists , we prefer rearranging them into the following simplified form :    [ bkneqns ] let @xmath51 be a multitwist with a bipartite configuration graph @xmath171 . the system of ( affine ) the _ bkn equations _ associated to @xmath51 , with the unknowns @xmath172 , and @xmath173 $ ] , where @xmath138 , consists of the following :    * for any vertex @xmath18 of @xmath83 , @xmath174 * for any cycle @xmath82 of @xmath83 , @xmath175    a solution @xmath176 of the bkn equations is said to be _ symmetric _ if @xmath177 , and @xmath178 for each end - of - edge @xmath69 , and to be _ nondegenerate _ if no @xmath179 equals @xmath180 .    [ generalbkn ] in general , the bkn equations can be defined for any nontrivial graph manifold @xmath0 with base - orientable jsj pieces .",
    "let the positive integer @xmath181 be the absolute value of the intersection number of fibers from adjacent pieces on @xmath182 for each edge @xmath91 , and the rational number @xmath113 be the charge at each vertex @xmath66 , ( cf .",
    "subsection [ subsec - multitwist ] ) . with the unknowns",
    "@xmath183 for each vertex @xmath66 , and @xmath184 $ ] for each edge @xmath91 , the bkn equations are defined as : @xmath185 for every vertex @xmath66 , where @xmath186 means the vertex adjacent to the end - of - edge @xmath72 , and @xmath187 means the edge carrying @xmath69 , ( ( * ? ? ? * section 3 ) ) .",
    "we affinize the unknowns by taking @xmath188 , and @xmath189 for each end - of - edge @xmath138 .",
    "note that @xmath0 virtually fibers if and only if @xmath190 s can be picked to be positive , ( ( * ? ? ?",
    "* theorem 3.1 ) ) .",
    "note also that @xmath191 is the formula of the charge for mapping tori of multitwists , ( subsection [ subsec - multitwist ] ) .",
    "it is clear our definition above is equivalent to the original bkn equations .",
    "besides several other results , in @xcite , buyalo and svetlov provided a criterion for a graph manifold to be nonpositively curved .",
    "in particular , their result implies :    [ thm - bs ] let @xmath51 be a multitwist with a bipartite configuration graph .",
    "then the mapping torus @xmath3 is nonpositively curved if and only if the bkn equations associated to @xmath51 have a nondegenerate symmetric solution .",
    "moreover , in this case , there is a nondegenerate symmetric solution over @xmath145 .    to interpretate the unknowns geometrically , every nondegenerate symmetric solution of the affine bkn equations endows @xmath3 with a nonpositively curved metric so that the jsj tori are totally geodesic , eulidean , with @xmath192 being the ratio between the lengths of the fibers @xmath193 and @xmath102 , and @xmath179 being the cosine of the angle between these fibers .      in this subsection , we study the connection between the current equations and the bkn equations .",
    "heuristically speaking , a multitwist defines a nonpositively curved mapping torus if and only if it virtually admits a nondegenerate current :    [ nssolutions ] let @xmath51 be a multitwist with a bipartite configuration graph . then the bkn equations associated to @xmath51 have a nondegenerate symmetric solution if and only if for some finite covering @xmath116 of @xmath51 , the current equations associated to @xmath116 have a nondegenerate symmetric solution .",
    "we prove proposition [ nssolutions ] in the rest of this subsection .",
    "as before , we write the bipartite configuration graph of @xmath51 as @xmath171 , and the essential curves on @xmath5 defining @xmath4 as @xmath90 s , and the mapping torus of @xmath51 as @xmath3 .    the ` if ' direction follows from perturbing nondegenerate symmetric solutions of the current equations :    [ curr2bkn ] if the current equations associated to @xmath51 have a nondegenerate symmetric solution , so do the bkn equations .",
    "write @xmath194 for the charge at a vertex @xmath66 .",
    "if all the charges @xmath113 s are zero , there is clearly a nondegenerate symmetric solution @xmath195 to the bkn equations , where @xmath196 and @xmath197 . in the following ,",
    "we suppose that not all the charges are zero .",
    "let @xmath198 be a nondegenerate symmetric solution of the current equations . with the new parameters @xmath199 s and @xmath200 s in @xmath144",
    ", we put : @xmath201 where @xmath202 denotes the vertex that @xmath69 is adjacent to , and where @xmath203 stands for the analytic function @xmath204 .",
    "then the bkn equations around cycles are automatically satisfied .    to ensure the bkn equations at vertices , consider the functions : @xmath205 for each vertex @xmath66 , where @xmath206 and @xmath207 are the vectors with the coordinates @xmath199 s and @xmath200 s , respectively .",
    "formally , these together define a smooth map : @xmath208 sending the origin to the origin . our goal is to use the existence of @xmath198 to show that for some @xmath206 sufficiently close to the origin , there are @xmath209 with sufficiently small positive coordinates , fulfilling @xmath210 for any vertex @xmath66 .",
    "first observe that @xmath211 is a submersion near the origin . indeed : @xmath212 so the tangent map : @xmath213 satisfies at the origin : @xmath214 here the @xmath215 s stand for the natural coordinate parameters of the target space @xmath216 .",
    "to see @xmath217 is surjective , note that by our assumption , there is some vertex @xmath218 at which the charge @xmath219 nonzero . since the image of @xmath220 under @xmath217 equals @xmath221 , we see @xmath222 .",
    "thus for any vertex @xmath18 adjacent to @xmath223 , @xmath224 also lies in @xmath225 by the formula of @xmath226 for @xmath227 . further applying the formula of @xmath226 s for other end - of - edges",
    ", it follows from the connectivity of the graph @xmath83 that for all @xmath66 , @xmath224 lies in @xmath225 .",
    "this means @xmath217 is surjective .",
    "now as @xmath211 is a submersion near the origin , the preimage of the origin of @xmath216 is a smooth submanifold @xmath228 of @xmath229 through the origin , of the dimension @xmath230 .",
    "because @xmath198 satisfies the current equations around cycles , it is clear that there exist @xmath231 , for all @xmath232 , such that @xmath233 equals @xmath234 for each end - of - edge @xmath138 . consider the curve @xmath235 , where @xmath236 is defined by : @xmath237 since @xmath198 is symmetric , i.e.   @xmath238 , we have : @xmath239 using the current equation at vertices , it is clear that all the @xmath240 vanish up to the second order , namely , @xmath241 .",
    "thus there exists a curve @xmath242 which is jet-@xmath22 equivalent to @xmath243 .",
    "hence @xmath244 has the taylor expansion near zero : @xmath245 because @xmath198 is nondegenerate , @xmath246 is strictly positive for any sufficiently small nonzero @xmath247 .",
    "therefore , for any sufficiently small nonzero @xmath247 , the corresponding @xmath248 and @xmath249 gives a nondegenerate symmetric solution of the bkn equations .    to prove the ` only - if ' direction , we need some ingredient from @xcite :    [ virtualfibersurface ] if the bkn equations associated to @xmath51 has a nondegenerate symmetric solution over @xmath145 , then there are linearly independent elements @xmath250,\\,[\\theta^-_\\delta]\\in h_1(t_\\delta;{{\\mathbf q}})$ ] for each end - of - edge @xmath138 , subject to @xmath251=\\pm\\phi_{\\bar\\delta*}([\\theta^\\pm_{\\bar\\delta}])$ ] , and there is a connected immersed orientable closed surface @xmath252 satisfying the following . for the preimage @xmath253 of each @xmath68 , the homology class @xmath254",
    "$ ] is a scalar multiple of @xmath255=[\\theta^+_\\delta]+[\\theta^-_\\delta]$ ] , and for each component @xmath256 , the homology class @xmath257 $ ] is a scalar multiple of either @xmath250 $ ] or @xmath258 $ ] .",
    "moreover , @xmath259 is a virtual fiber , namely , there is a surface bundle finitely covering @xmath3 with the fiber covering @xmath259 up to homotopy .",
    "we outline the proof in our context following @xcite , ( cf .",
    "remark [ generalbkn ] for the translation of the notations ) .",
    "suppose @xmath176 is a nondegenerate symmetric solution over @xmath145 of the bkn equations associated to @xmath51 .",
    "in fact , the elements @xmath251 $ ] can be explicitly picked as : @xmath260=\\frac{1\\pm\\gamma_\\delta}{2b_\\delta}\\,(\\phi_{\\bar\\delta*}[f_{\\bar\\delta}]\\pm u_\\delta\\,[f_\\delta]).\\ ] ] note these are linearly independent elements as @xmath261 and @xmath262 .",
    "moreover , it is straightforward to check the following , where @xmath255=[\\theta_\\delta^+]+[\\theta_\\delta^-]$ ] , and @xmath263 denotes the intersection pairing on @xmath264 :    * for each end - of - edge @xmath138 , using the nondegeneracy : @xmath265,\\,[\\theta_\\delta^\\pm])\\,>\\,0;\\ ] ] * for each end - of - edge @xmath138 : @xmath265,\\,[\\theta_\\delta])\\,=\\,1;\\ ] ] * for each vertex @xmath66 , using the bkn equation at @xmath18 and the formula of the charge @xmath113 , ( cf .",
    "subsection [ subsec - multitwist ] ) : @xmath266,\\ ,                          \\frac{\\phi_{\\bar\\delta*}[f_{\\bar\\delta}]}{b_\\delta}\\right)\\,=\\,k_{v};\\ ] ] * and for each end - of - edge @xmath138 : @xmath267,\\,[\\theta_\\delta^\\pm])}{i([f_\\delta],\\,[\\theta_\\delta^\\pm])}\\right|                      \\,=\\,u_\\delta.\\ ] ]    the first three properties imply the existence of a connected , horizontal ( i.e.  transverse to the fiber in each seifert fibered piece ) , immersed , orientable closed surface @xmath252 .",
    "furthermore , one may require that for any component @xmath256 , the homology class @xmath257 $ ] is a scalar multiple of either @xmath250 $ ] or @xmath258 $ ] , and @xmath254 $ ] is a scalar multiple of @xmath255 $ ] , ( ( * ? ? ?",
    "* lemma 3.1 ) ; cf .",
    "* proposition 1.4 ) ) . the last property together with the bkn equations around cycles",
    "imply that @xmath259 is a virtually embedded horizontal surface , and hence is a virtual fiber , using a cocycle criterion due to rubinstein and wang ( @xcite ; cf .",
    "* proposition 1.4 ) ) .",
    "[ bkn2curr ] if the bkn equations associated to @xmath51 have a nondegenerate symmetric solution , so do the current equations associated to some finite covering @xmath167 of @xmath51 .    by theorem [ thm - bs ]",
    ", we may assume the nondegenerate symmetric solution to be over @xmath145 .",
    "let @xmath252 be the virtual fiber surface as ensured by lemma [ virtualfibersurface ] .",
    "note that for any essential simple closed curve @xmath268 corresponding to an end - of - edge @xmath138 , at least one of the intersection numbers @xmath269,\\,[\\theta^\\pm_\\delta])$ ] is nonzero .",
    "suppose @xmath270 is a regular finite covering in which a finite covering @xmath271 of @xmath259 embeds as a fiber .",
    "then every component @xmath272 of @xmath273 intersects a component of the preimage @xmath274 , i.e.  a conjuate of @xmath271 under the covering transformation , algebraically nontrivially .",
    "in particular , @xmath272 is nontrivial in @xmath275 . note that any component @xmath129 of @xmath276 is still a fiber of @xmath275 .",
    "then a further finite covering of @xmath275 is a mapping torus associated to a multitwist @xmath167 .",
    "now the defining essential curves of @xmath277 cover the @xmath90 s , so they are nontrivial in @xmath278 . by lemma [ survivalcriterion ] , this is to say the current equations associated to @xmath116 have a nondegenerate symmetric solution .",
    "we apply lemma [ curr2bkn ] to @xmath167 in the ` if ' direction .",
    "note the mapping torus @xmath279 is nonpositively curved if and only if so is @xmath3 , ( @xcite ) , thus equivalently , the bkn equations associated to @xmath116 have a nondegenerate symmetric solution if and only if so do the bkn equations associated to @xmath51 , ( theorem [ thm - bs ] ) .",
    "the ` only - if ' direction follows from lemma [ bkn2curr ] .",
    "in this section , we construct a virtual special cube complex homotopy equivalent to the mapping torus of a multitwist with a bipartite configuration graph , under the assumption that the associated current equation possesses a nondegenerate symmetric solution , ( proposition [ spcubulation ] ) . as mentioned before , this assumption should be regarded as a seemingly weaker translation of the rfrs condition .",
    "[ spcubulation ] let @xmath51 be a multitwist with a bipartite configuration graph .",
    "suppose the current equations associated to @xmath51 have a nondegenerate symmetric solution .",
    "then for some integer @xmath280 , the product @xmath281 of the mapping torus @xmath3 and the @xmath8-space @xmath13 is homeomorphic to a virtually special cube complex .    in fact , the special cube complex by our construction is complete with finitely many hyperplanes , but when @xmath11 , it has no compact convex subcomplex homotopy equivalent to @xmath275 .",
    "we prove proposition [ spcubulation ] in the rest of this section .",
    "our cubulation is inspired by the sageev construction . generally speaking , from any finite collection of @xmath282-injective surfaces ,",
    "the sageev construction allows one to obtain a cat(0 ) cube complex on which the fundamental group of the @xmath2-manifold acts , ( cf .",
    "this will be a proper action if one can find a ` sufficient ' collection , and the virtual specialness will be verified if one can show the separability and the double - coset separability of the surface subgroups . this approach has been taken by piotr przytycki and dani wise recently , ( @xcite ) . instead of",
    "that , in this paper , we shall present an explicit construction , through which the virtual specialness can be seen directly .    throughout this section ,",
    "we suppose @xmath51 satisfies the assumption of proposition [ spcubulation ] .",
    "we shall write the configuration graph of as @xmath171 , and the essential curves on @xmath5 defining @xmath4 as @xmath90 s . regarding the mapping torus @xmath3 as @xmath52 $ ] identifying @xmath53 with @xmath54 for every @xmath55",
    ". there is a natural inclusion : @xmath283 identifying @xmath5 as the copy @xmath284 in @xmath3 .",
    "the poincar dual of @xmath285\\in h_2(m_\\sigma)$ ] will be written as : @xmath286      in this subsection , we choose some setup data for the construction of the cubulation .",
    "it will be described as a cut - bind system @xmath287 of curves with respect to @xmath51 , which naturally induces a cohomology class @xmath288 and a finite collection of lifted cohomology classes @xmath289 for some @xmath290 .",
    "[ subordinate ] suppose @xmath291 is a collection of mutually disjoint simple closed curves so that @xmath292 is a disjoint union of ( compact ) pairs - of - pants .",
    "we say the pants decomposition @xmath292 is _ subordinate to _",
    "@xmath51 if @xmath90 is a component of @xmath293 for every @xmath91 .",
    "the components of @xmath293 are called the _ cut - curves_.    [ cbs ] suppose @xmath292 is a pants decomposition of @xmath5 subordinate to @xmath51 , and @xmath294 is a union of oriented mutually - disjoint simple closed curves , representing a cohomology class @xmath288 in poincar dual . if for every cut curve @xmath295 , @xmath296 is nonempty consisting of exactly @xmath297)|$ ] points , and if for every pair - of - pants @xmath298 , @xmath299 is a union of disjoint arcs , then we call @xmath287 a _ cut - bind system _ with respect to @xmath51 .",
    "the components of @xmath300 are called the _ bind - curves_.    [ pantsdecomposition ] with the notations above , there is a pants decomposition @xmath292 subordinate to @xmath51 , so that every cut - curve @xmath301 represents a nontrivial element ( up to sign ) in @xmath147 . in particular , every cut - curve @xmath302 is non - separating on @xmath5 , adjacent to two distinct pairs - of - pants of @xmath303 .",
    "let @xmath304 be the union of the @xmath90 s .",
    "by lemma [ survivalcriterion ] , as the current equations associated to @xmath51 have a nondegenerate solution , each @xmath90 survives in @xmath305 .",
    "suppose by induction that for some @xmath306 , @xmath307 is a union of mutually non - parallel , disjoint essential simple closed curves that has been constructed , so that every component @xmath301 survives in @xmath147 .    whenever @xmath308 is not a disjoint union of pairs - of - pants , we construct @xmath309 as follows .",
    "if there is a non - planar component of @xmath310 of @xmath308 , let @xmath311 be a non - separating simple closed curve .",
    "it is clear that @xmath41 is rational - homologically nontrivial in @xmath3 , so we take @xmath312 .",
    "otherwise , there is still a component planar @xmath310 of @xmath308 which has at least four boundary components . with the orientation induced from that of @xmath310 , at least two boundary components @xmath313 such that @xmath314+[z'']\\neq0 $ ] in @xmath147 .",
    "let @xmath311 be a simple closed curve separating @xmath315 from the other components of @xmath316 , so @xmath41 is rational - homologically nontrivial in @xmath3 .",
    "we take @xmath312 .",
    "this process terminates after finitely many steps . in the end",
    ", we get a pants decomposition @xmath292 as desired .",
    "fix a pants decomposition @xmath292 subordinate to @xmath51 as asserted by lemma [ pantsdecomposition ] .",
    "[ barxi ] with the notations above , there is a cohomology class @xmath288 invariant under @xmath317 , such that @xmath318)$ ] is nontrivial for any cut - curve @xmath301 .    as the pants decomposition @xmath292 satisfies the conclusion of lemma [ pantsdecomposition ] , we may find a generic @xmath319 , so that @xmath320)\\neq0 $ ] for any cutting curve @xmath301 . after passing to a multiple",
    ", we may assume @xmath321 as well .",
    "take @xmath288 to be the restriction of @xmath322 under the natural inclusion @xmath323 .",
    "it is straightforward to check that @xmath324 satisfies the conclusion .",
    "fix a cohomology class @xmath288 as asserted by lemma [ barxi ] .",
    "[ cbsexist ] with the notations above , there is a cut - bind system @xmath287 with respect to @xmath51 such that @xmath325\\in h_1(f)$ ] is in poincar dual to @xmath288 .",
    "let @xmath298 be a pair - of - pants . for simplicity ,",
    "we write @xmath18 for the vertex @xmath326 carrying a pair - of - pants @xmath298 , and write @xmath327 for the index @xmath328 .",
    "note that the value of the cohomology class @xmath324 on the three components @xmath329 of @xmath330 ( with the induced orientations ) are three nonzero integers @xmath331 , respectively , so that @xmath332 . without loss of generality , we assume @xmath333 and @xmath334 has the same sign , and @xmath159 has the opposite sign .",
    "thus one may take @xmath335 parallel arcs from @xmath41 to @xmath336 , and @xmath337 parallel arcs from @xmath41 to @xmath338 , so that they are mutually disjoint , cutting @xmath339 into one octagon and @xmath340 bands .",
    "see figure [ figcubpants2d ] for an illustration with @xmath341 , @xmath342 , and @xmath343 , in which the bind - arcs are colored green .        there is a canonical orientation for these arcs so that their union is dual to the restriction @xmath344 .",
    "these parallel arcs will later serve as the bind - arcs @xmath299 . moreover , we glue up these @xmath339 s according to the pants decomposition , or more precisely , embed @xmath339 into @xmath5 , so that the bind - arcs match up along the boundary , giving rise to bind - curves @xmath294 .",
    "arbitrary matching up may result in some @xmath325\\in h_1(f)$ ] which differs from the dual of @xmath288 by an integral linear combination of the @xmath345 $ ] s , where @xmath301 are the cut - curves .",
    "however , we may modify the matching by shifting the embedding of @xmath339 s into @xmath5 near @xmath330 , so that @xmath325 $ ] is the poincar dual of @xmath324 , as desired .",
    "fix a cut - bind system @xmath287 with respect to @xmath51 as asserted by lemma [ cbsexist ] .",
    "[ cohomologyclasses ] with the notations above , there are canonical integral cohomology classes : @xmath346 for some @xmath290 , such that each @xmath347 restricts to @xmath288 under the natural inclusion @xmath323 , and that for every vertex @xmath66 , there is exactly one @xmath348 with @xmath349)=0 $ ] .",
    "as @xmath288 is invariant under @xmath317 , it comes from the restriction of some @xmath321 , and the space of such cohomology classes is exactly @xmath350 . for any vertex @xmath66 , and any @xmath351",
    ", we have @xmath352)=0 $ ] if and only if @xmath353 equals @xmath354)$ ] , since @xmath355)=1 $ ] .",
    "we may take @xmath356 to be all the @xmath357 s , where @xmath358)$ ] as @xmath18 runs over @xmath63 .",
    "this is the canonically ( ordered ) finite set of cohomology classes .",
    "let @xmath289 be the cohomology as asserted by lemma [ cohomologyclasses ] .",
    "it will be convenient to write : @xmath359 for the unique index associated to @xmath66 .",
    "we often call @xmath360 the _ vertical index _ with respect to @xmath18 , and call any other index @xmath361 a _ horizontal index _ with respect to @xmath18 .      in this subsection",
    ", we construct a canonical cube complex @xmath15 provided a choice of the cut - bind system @xmath362 with respect to @xmath51 , as can be obtained by subsection [ subsec - setupdata ] .",
    "let @xmath288 and @xmath363 be the canonically associated cohomology classes as before .",
    "we also have a natural cubulation of @xmath5 dual to @xmath287 , namely , the cubulation obtained by matching up the dual cubulation on each pair - of - pants .",
    "see figure [ figcubpants2d ] for an illustration , where the dots and the dashed arcs are the vertices and the edges in the dual cubulation , respectively . note that the boundary of the pair - of - pants is regarded as a union of mid - cubes .",
    "cubulate @xmath364 .",
    "* for every vertex @xmath66 , the jsj piece @xmath95 is the mapping torus of @xmath4 restricted to @xmath365 .",
    "it has a canonical seifert fibered structure given by the short exact sequence of groups : @xmath366 and a natural inclusion @xmath367 .",
    "hence @xmath368 is a canonical direct product @xmath369 .",
    "let @xmath370 be the universal covering of @xmath81 with the induced cubulation .",
    "we parametrize @xmath371 by the real coordinates @xmath372 , and for each @xmath373 , let @xmath374 be the subspace defined by @xmath375 .",
    "we often denote points of @xmath374 by @xmath376 .",
    "the integral lattice of @xmath371 endows @xmath371 , and each @xmath374 , with a standard cubulation given by the tiling of standard unit @xmath377-cubes .",
    "therefore , the fundamental group @xmath368 acts on : @xmath378 via : @xmath379)\\right),\\ ] ] for any @xmath380 , and any @xmath381 .",
    "acts by the deck transformations on @xmath370 , and @xmath383)$ ] denotes @xmath384),\\,\\cdots,\\widehat{\\xi^{i(v)}([g])},\\cdots,\\xi^{n+2}([g]))$ ] , where @xmath385\\in h_1(j_v)$ ] is the corresponding homology class .",
    "[ x_pproduct ] the action on @xmath368 on the cube complex @xmath386 is proper and combinatorial .",
    "the quotient cube complex : @xmath387 is homeomorphic to @xmath364 .",
    "moreover , there is a canonical isomorphism @xmath388 induced by an @xmath8-plane bundle structure of @xmath389 over @xmath95 .",
    "the stabilizer of @xmath368 at any point of @xmath370 is the center @xmath390 .",
    "since @xmath391 acts on @xmath392 as a translation by @xmath393)$ ] , which is nontrivial by lemma [ cohomologyclasses ] , the action of @xmath368 is proper on @xmath394",
    ". it clearly preserves the cube complex structure as well",
    ".    moreover , let @xmath395 be the subspace of @xmath392 spanned by @xmath393)$ ] over @xmath144 .",
    "then the @xmath8-dimensional foliation of @xmath392 by the affine parallel copies of any subspace complementary @xmath396 to @xmath395 induces an ( affine ) @xmath8-plane bundle structure of @xmath389 over @xmath95 .",
    "in fact , different choices of @xmath396 s result in naturally isomorphic bundles over @xmath95 .",
    "this bundle is trivial because the structure group is translational , and it induces a canonical isomorphism @xmath388 .    for any end - of - edge @xmath138 adjacent to @xmath18",
    ", we write : @xmath397 for the boundary component corresponding to @xmath69 .",
    "it is a cube complex formed by mid - cubes , and @xmath398 under the natural isomorphism @xmath399 . to understand the cubulation on @xmath400 ,",
    "remember we have cubulated @xmath401 as the quotient of @xmath402 by a translation by @xmath403)$ ] .",
    "thus , the universal covering of @xmath400 can be naturally regarded as @xmath371 up to integral translations , where @xmath404 is identified via plugging @xmath402 as the @xmath360-th factor . using this identification",
    ", @xmath400 is the quotient of @xmath371 under the action of @xmath405 via : @xmath406),\\ ] ] for any @xmath407 , and any @xmath408 . here",
    "@xmath409)$ ] denotes @xmath384),\\,\\cdots,\\xi^{n+2}([g]))$ ] . in particular",
    ", any @xmath401 translates by @xmath410 ) )          = ( \\bar\\xi([z_\\delta]),\\,\\cdots,\\,\\bar\\xi([z_\\delta]))$ ] along the diagonal of @xmath371 , and any @xmath391 translates only in the subspace @xmath392 .    because integral translations on the @xmath392 factor of @xmath411 commute with the action of @xmath368 on @xmath386 , this induces a group of automorphisms of the cube complex @xmath389 .",
    "it is an abelian group naturally isomorphic to the quotient of @xmath412 modulo @xmath393)$ ] .",
    "we shall call these automorphisms _ combinatorial translations _ of @xmath389 .    * step 2 .",
    "cubulate @xmath413 .",
    "* it is almost clear how to glue up these @xmath389 s . in the previous step ,",
    "we identified @xmath400 up to combinatorial translations as the quotient of @xmath371 by the action of @xmath414 , and under the identification , the action of @xmath414 and @xmath415 coincide on @xmath371 .",
    "this implies the cubulations on the boundary components corresponding to any pair of opposite ends match up .",
    "therefore , we may glue up all @xmath389 s along the boundaries with respect to @xmath83 , matching up the cube complex structures , to obtain a cube complex : @xmath416 which is clearly complete .",
    "however , the cube complex @xmath15 is determined only up to combinatorial translations along the boundary at this point . to further make the matching canonical , we need to specify a reference point on each component of each @xmath417 . for this purpose ,",
    "let : @xmath418 be a lift of the configuration graph @xmath83 into @xmath5 , namely , such that @xmath419 is homotopic to the identity where @xmath420 is the natural collapsing .",
    "this gives a base - point @xmath421 on each @xmath81 , and a base - point @xmath422 on each @xmath90 , and a path @xmath423 from @xmath424 to @xmath425 for each end - of - edge @xmath426 , where @xmath427 is the vertex adjacent to @xmath69 , and @xmath428 is the edge carrying @xmath69 .",
    "we may also assume that the @xmath429 s and @xmath430 s are vertices of the cubulated @xmath81 , and hence they miss the bind - curves @xmath300 . by picking a direction of all the edges of @xmath83",
    ", it makes sense to speak of the algebraic intersection number of any @xmath431 with the bind - curves @xmath300 , which will be _ ad hoc _ written as @xmath432 . for every vertex @xmath66 ,",
    "let : @xmath433 be the point in @xmath434 , where @xmath435 is a lift of @xmath436 .",
    "thus the lift of @xmath437 into @xmath370 based at @xmath438 gives rise to the @xmath439 for every end - of - edge @xmath227 adjacent to @xmath18 .",
    "let : @xmath440 be the further lift @xmath425 into @xmath386 , where @xmath441 is the diagonal inclusion , namely , @xmath442 for any @xmath443 .",
    "this naturally gives rise to a lift of @xmath437 into @xmath444 based at @xmath445 , for instance , using the linear extension on the @xmath446 factor .",
    "we denote the corresponding images in the quotient as : @xmath447 which are all vertices in the cubulation .",
    "glue up the @xmath389 s matching the reference points on the boundary .",
    "we denote the gluing by : @xmath448 for every end - of - edge @xmath138 , satisfying @xmath449 , and @xmath450 .",
    "thus we obtain a cube complex @xmath15 , and in addition , a lifted @xmath451 such that @xmath452 is the identity , where @xmath453 is the natural collapsing .",
    "different choices of @xmath454 and the @xmath438 s in @xmath455 yield the same cube complex @xmath15 up to combinatorial isometry .",
    "suppose we choose a new lift of the configuration graph @xmath456 with a new collection of lifted base - points @xmath457 .",
    "denote the gluing map with respect to the new reference points by @xmath458 .",
    "we need to find a combinatorial isometry @xmath459 for each @xmath66 , such that the following commutative diagram holds for every end - of - edge @xmath138 : @xmath460    to obtain the @xmath461 s , let each @xmath462 be an immersed path in @xmath370 from @xmath438 to @xmath463 , and let @xmath464 be the projected immersed path in @xmath81 .",
    "we define : @xmath465 to be the combinatorial translation induced from the integral translation on @xmath386 given by : @xmath466    it is straightforward to check that these @xmath461 s satisfy the diagram above . to be precise ,",
    "let each @xmath467 be an immersed path in @xmath90 from @xmath430 to @xmath468 , and let @xmath469 be the lifted path in @xmath370 based at @xmath470 , where @xmath69 is the end - of - edge adjacent to @xmath18 and carried by @xmath78 .",
    "we further lift @xmath469 as a path @xmath471 in @xmath386 based at @xmath445 , so that the @xmath392 component of the other end - point @xmath472 is @xmath473 .",
    "let @xmath474 be the element represented by the loop obtained from joining the consecutive directed paths @xmath475 , @xmath476 , @xmath464 and @xmath477 .",
    "we regard @xmath478 as in @xmath368 via the natural inclusion induced by @xmath367 . then from the construction , @xmath383)=\\vec\\delta(\\bar\\xi([g]))$ ] .",
    "moreover , we have : @xmath479 this means in the quotient space @xmath389 , @xmath480",
    ". however , from the construction we also have @xmath481 .",
    "hence it is verified that @xmath482 .",
    "hence the cube complex @xmath15 is canonically determined by the multitwist @xmath51 and the cut - bind system @xmath287 .",
    "[ xproduct ] the cube complex @xmath15 is homeomorphic to @xmath483 with a canonical isomorphism @xmath484 .    under the natural inclusion @xmath323 ,",
    "the reference points also gives rise to natural reference points for the jsj pieces and jsj tori of @xmath3 .",
    "thus the caonical isomorphisms @xmath485 induces a canonical isomorphism @xmath484 using the graph - of - groups decomposition . to see @xmath15 is homeomorphic to @xmath483 ,",
    "we take an @xmath8-plane foliation of @xmath389 for each @xmath66 as in the proof of lemma [ x_pproduct ] . for any @xmath91 ,",
    "the foliations on the quotient of @xmath371 modulo @xmath405 induced from the two adjacent pieces are clearly isotopic in the space of ( affine ) @xmath8-plane foliations .",
    "@xmath15 is topologically a trivial @xmath8-plane bundle over @xmath3 .",
    "hence @xmath15 is homeomorphic to @xmath483 .      in this subsection , we study the cubical geometry of the hyperplanes of @xmath15 .",
    "this will prepare us for the proof of the virtual specialness of @xmath15 .",
    "there are @xmath486 types hyperplanes in @xmath15 , one called the cut - type and the others called the bind - types , indexed by @xmath487 . with the notations from subsection [ subsec - cubcplxx ] , an edge of the cubulation of @xmath5 is said to have the _ cut - type _",
    "the _ bind - type _ ) if it is dual to a cut - curve ( resp .",
    "a bind - curve ) .",
    "this also gives rise to types of edges in any covering space of @xmath5 with the induced cubulation . in the subcomplex",
    "@xmath389 corresponding to a vertex @xmath488 , a _ cut - type _ edge is an edge projected from a cut - type edge parallel to @xmath455 in @xmath394 ; and a _ bind - type _ edge of _ index _ @xmath361 , is either an edge projected from a bind - type edge parallel to @xmath455 in @xmath394 , if @xmath361 is the vertical index @xmath360 , or an edge projected from an edge parallel to @xmath392 , if @xmath361 is a horizontal index . by our construction , it is clear that every hyperplane is dual to exactly one type of edges .",
    "this gives rise to @xmath486 types of hyperplanes .",
    "[ geom - cuttype ] the cut - type hyperplanes in @xmath15 are in natural bijection to the cut - curves on @xmath5 , namely , the components of @xmath293 . moreover , for every cut - type hyperplane is two - sided , homeomorphic to @xmath489 . here",
    "@xmath490 denotes the torus .",
    "let @xmath301 be a cut - curve , and @xmath66 be one of the at most two vertices for which @xmath491 ( possibly on the boundary ) .",
    "then for any copy of the universal covering @xmath492 of @xmath41 in @xmath370 , the stabilizer of @xmath493 is clearly a conjugate of @xmath494 in @xmath368 , where @xmath495 denotes the mapping torus @xmath496 of @xmath4 restricted to @xmath41 , which is a torus .",
    "thus the quotient hyperplane @xmath497 is two - sided , homeomorphic to @xmath489 .",
    "moreover , different choices of the copies projects to the same @xmath498 , and every cut - type hyperplane @xmath499 is naturally some @xmath498 by the definition .",
    "this gives the natural bijection between cut - type hyperplanes of @xmath15 and the cut - curves on @xmath5 .",
    "we denote the union of all the cut - type hyperplanes in @xmath15 as @xmath500 , and denote the component of @xmath500 corresponding to the cut - curve @xmath301 as @xmath498 .",
    "it is also clear that the components of @xmath501 are in natural bijection to the pairs - of - pants on @xmath5 , namely , the components of @xmath292 ; moreover , each component is homeomorphic to the product of a pair - of - pants with @xmath502 .",
    "we denote : @xmath503 and denote the component corresponding to the pair - of - pants @xmath298 as @xmath504 .",
    "this induces a graph - of - spaces decomposition of @xmath15 , whose dual graph : @xmath505 is naturally isomorphic to the graph dual to the pants decomposition @xmath292 of @xmath5 .",
    "this decomposition also naturally agrees with the decomposition of @xmath3 : @xmath506 where @xmath507 is the disjoint union of the mapping tori @xmath508 of @xmath4 restricted to each cut - curve @xmath301 , and @xmath509 is the disjoint union of of the mapping tori @xmath510 of @xmath4 restricted to each pair - of - pants @xmath298 . as the pants decomposition is subordinate to @xmath51 , @xmath511 refines the configuration graph @xmath83 , in the sense that there is an obvious natural collapse @xmath512 .",
    "we often write @xmath513 for the vertex @xmath514 such that @xmath81 contains @xmath339 .",
    "we call @xmath515 the _ cut decomposition _ of @xmath15 .    for every index @xmath487",
    ", we denote the union of all the bind - type hyperplane of index @xmath361 as : @xmath516    [ geom - bindtype ] for every index @xmath487 , there are only finitely many index-@xmath361 bind - type hyperplanes in @xmath15 . moreover , index-@xmath361 bind - type hyperplanes are all two - sided , canonically oriented , so that @xmath517 is dual to @xmath347 in @xmath518 .",
    "because the bind - curves @xmath300 are canonically oriented ( definition [ cbs ] ) , and because edges in @xmath371 are naturally directed by the basis vectors , it is clear that @xmath517 is two - sided and canonically oriented .    to see there are only finitely many bind - type hyperplanes in @xmath15 , observe that every cut - type hyperplane , as an @xmath377-dimensional cube complex by itself , has only finitely many sub - hyperplanes .",
    "in fact , let @xmath497 be the cut - type hyperplane corresponding to the cut - curve @xmath301 . with the notations in the proof of lemma [ geom - cuttype ]",
    ", the element in @xmath494 represented by the cut - curve @xmath41 acts on @xmath519 as a translation by @xmath520),\\cdots,\\xi^{n+2}([z]))=\\vec\\delta(\\bar\\xi([z]))$ ] , which is nontrivial on every component .",
    "thus for every @xmath521 in @xmath522 , there are only finitely many distinct sub - hyperplanes in @xmath498 , which are projected by a parallel copy of @xmath361-th coordinate sub - hyperplane @xmath523 , namely , the intersection of @xmath392 and @xmath524 .",
    "this means @xmath498 has only finitely many sub - hyperplanes .",
    "this finiteness implies the finiteness of bind - type hyperplanes in @xmath15 , because every bind - type hyperplane must intersect at least one @xmath498 in a ( nonempty ) sub - hyperplane by our construction .",
    "counting the algebraic intersection of @xmath517 with any representative cycle of @xmath525 induces a dual cohomology class in @xmath526 . to see that @xmath517 is dual to @xmath347 ,",
    "observe that the restriction of @xmath347 to each @xmath527 is dual to @xmath528 .",
    "this follows immediately from the construction of @xmath389 .",
    "furthermore , it is also clear from our canonical gluing that for any lift @xmath451 of the configuration graph , @xmath347 evaluates on the image of @xmath529 precisely by counting the algebraic intersection number of any representative cycle with @xmath517 .",
    "note that the image of @xmath529 and all the @xmath530 s generate @xmath525 .",
    "therefore , @xmath517 is dual to @xmath531 .",
    "while they are complicated in general , bind - type hyperplanes are locally easy to understand .",
    "note that for any bind - type hyperplane @xmath24 in @xmath15 , and for any pair - of - pants @xmath298 , the components of @xmath532 are all hyperplanes in @xmath504 , with the bind - type index known as that of @xmath24 . the _ vertical index _",
    "@xmath533 with respect to @xmath339 is known as the vertical index @xmath360 with respect to the unique @xmath66 such that @xmath534 ; and the other indices are the _ horizontal indices _ with respect to @xmath339 .",
    "a bind - type hyperplane in @xmath504 of index @xmath361 is said to be _ vertical _ if its index @xmath361 equals @xmath533 ; it is said to be _ horizontal _ , if @xmath361 differs from @xmath533 .",
    "[ geom - vertical ] for every pair - of - pants @xmath298 , the vertical hyperplanes in @xmath504 are in natural bijection to the bind - arcs in @xmath339 , namely , the components of @xmath535 .",
    "moreover , each vertical hyperplane in @xmath504 is homeorphic to @xmath536 , with the two boundary components lying on two distinct components of @xmath537 . here",
    "@xmath538 denotes the compact annulus .",
    "note that the universal covering @xmath539 is @xmath540 , where @xmath541 is the universal covering of @xmath339 . for every vertical hyperplane @xmath542 ,",
    "every component @xmath543 of its preimage is the product @xmath544 , where @xmath545 is a preimage - component of a unique bind - arc @xmath546 .",
    "the stabilizer of @xmath547 in @xmath548 is @xmath549 .",
    "this implies that @xmath550 is homeomorphic to @xmath536 .",
    "moreover , different choices of the preimage - component @xmath547 projects to the same @xmath551 , so @xmath552 is well - defined , sending every vertical hyperplane in @xmath504 to a bind - arc @xmath553 on @xmath339 .",
    "it is straightforward to check that this defines a bijection between these two kinds of objects .    for every pair - of - pants @xmath298 , and for every horizontal index @xmath361",
    ", we denote the restriction of @xmath347 to @xmath554 as @xmath555 , and the restriction of @xmath347 to @xmath556 as @xmath557 .",
    "remember also from subsection [ subsec - setupdata ] that @xmath288 is the cohomology class dual to the bind - curves @xmath300 .",
    "we denote the restriction of @xmath324 to @xmath339 as @xmath558 . for any nonzero integer @xmath559 , @xmath560 modulo @xmath559 lives in @xmath561 , and it induces a dual cyclic covering of @xmath339 corresponding to the kernel of @xmath562 , whose degree is the greatest common divisor of @xmath559 and the divisibility @xmath563 of @xmath560 .",
    "recall that the _ divisibility _ @xmath564 of a nontrivial element @xmath565 in a free abelian group @xmath566 is the largest positive integer by which @xmath565 is divisible in @xmath566 .",
    "[ geom - horizontal ] for every pair - of - pants @xmath298 , and for every horizontal index @xmath361 , there are exactly @xmath567 index-@xmath361 horizonal hyperplanes in @xmath504 .",
    "moreover , these hyperplanes are all parallel , each homeomorphic to @xmath568 , where @xmath569 is the finite cyclic covering of @xmath339 dual to @xmath560 modulo @xmath570)$ ] . in particular , for every cut - curve @xmath301 on @xmath330 , each horizontal hyperplane has exactly @xmath571 boundary components on the corresponding component of @xmath537 .",
    "let @xmath542 be the horizontal hyperplane of index @xmath361 .",
    "if @xmath389 is the piece containing @xmath504 , then the construction of @xmath389 implies that @xmath504 is the quotient of its universal covering @xmath572 by the action @xmath548 defined in the same manner , and @xmath550 is projected from from @xmath573 , where @xmath574 for the intersection @xmath575 .",
    "the stabilizer : @xmath576 consists of elements @xmath577 such that @xmath578)=0 $ ] .",
    "note that the canonical seifert - fibration induces the commutative diagram of groups , where the rows are short exact sequences : @xmath579 regarding @xmath580 naturally as a linear functional in @xmath581 , the stabilizer @xmath582 is precisely the preimage in @xmath548 of @xmath583 with respect to the abelianization @xmath584 . because @xmath585)$ ] does not vanish , ( lemma [ cohomologyclasses ] )",
    ", @xmath586 is trivial , so @xmath582 embeds into @xmath587 under @xmath588 .",
    "this means @xmath589 acts properly on the @xmath541 factor of @xmath590 , so @xmath550 is homeomorphic to @xmath568 , where @xmath569 is the normal covering of @xmath339 corresponding to the subgroup @xmath591 of @xmath587 .",
    "moreover , @xmath592){{\\mathbf z}}\\right)\\\\                                          & \\cong & \\mathrm{im}(\\bar\\xi_p)\\,/\\,\\left(\\xi^j_p([f_v]){{\\mathbf z}}\\right ) .",
    "\\end{aligned}\\ ] ] from this we see that @xmath569 is a finite cyclic covering of @xmath339 dual to @xmath560 modulo @xmath593)$ ] .    to see there are exactly @xmath567 copies of @xmath550 in @xmath504 , note that the parallel copies of @xmath590 are parametrized as @xmath594 by the @xmath361-th coordinate of @xmath371 .",
    "the action of @xmath548 on the spaces of these copies is exactly the translation group generated by a translation of distance @xmath567 .    finally , the number of boundary components of @xmath550 on the boundary component @xmath595 corresponding to @xmath596 is the index of the image @xmath597 in @xmath598 . in other words , it is the index of the subgroup of @xmath599 generated by @xmath600)$ ] and @xmath601)$ ] .",
    "note @xmath599 is identified as the subgroup @xmath602 of @xmath594 . since @xmath345 $ ] and @xmath603 $ ] generates @xmath604",
    ", @xmath605 is just the greatest common divisor of @xmath600)$ ] and @xmath601)$ ] .",
    "hence the index equals @xmath571 .    in order to capture the global geometry of bind - type hyperplanes in @xmath15 ,",
    "it is useful to consider its decomposition induced from the cut decomposition of @xmath15 .",
    "specifically , let @xmath499 be a bind - type hyperplane .",
    "there is a naturally associated graph @xmath606 , whose vertices correspond to the components of @xmath607 , and whose edges correspond to the components of @xmath608 . hence there is a naturally associated map @xmath609 between graphs , satisfying the following commutative diagram : @xmath610 where the vertical maps are natural collapses .",
    "note also that @xmath606 is a finite graph by the proof of lemma [ geom - bindtype ] .",
    "[ iotah ] for a bind - type hyperpane @xmath24 of @xmath15 , the associated map @xmath611 is an immersion ( i.e.  a local isometry ) if and only if no component of any @xmath532 has two boundary components lying on the same component of @xmath537 ; and @xmath612 is an embedding if and only if @xmath532 is connected ( possibly empty ) for every @xmath504 .",
    "this follows immediately from the definition .",
    "we discuss which pathologies may occur to hyperplanes in @xmath15 .",
    "in other words , we study the position relationship of hyperplanes near vertices .",
    "there are two types of vertices in @xmath15 , called the octagon type and the band type .",
    "octagon - type _ vertex comes from the center of the octagon in a pair - of - pants , while a _ band - type _ vertex comes from the center of a band in a pair - of - pants , ( cf .",
    "figure [ figcubpants2d ] ) .",
    "[ positionsbasic ] the following statements are true .    1 .   every hyperplane in @xmath15 is two - sided with no self - intersection ; 2 .",
    "any two distinct hyperplanes of the same type do not intersect , and hence do not inter - osculate ; 3 .",
    "any two bind - type hyperplanes of distinct indices do not osculate , and hence do not inter - osculate .",
    "the first statement has been proved in lemma [ geom - cuttype ] , lemma [ geom - bindtype ] .",
    "the second statement is true by the definition of types .",
    "the third statement is true by the definition of osculation .",
    "in fact , it is straightforward to check at each octagon - type vertex and at each band - type vertex , that two edges dual to two bind - type hyperplanes of distinct indices , respectively , always share a common square .",
    "there remains to be three kinds of possible pathologies :    * self - osculation of cut - type hyperplanes ; * self - osculation of bind - type hyperplanes ; * inter - osculation between cut - type hyperplanes and bind - type hyperplanes .    to be more illustrative ,",
    "let us name the edges in figure [ figcubpants2d ] adjacent to the octagon center by the compass directions , such as the east , the northwest , etc .",
    "self - osculation of cut - types occurs at every octagon - type vertex , as the north and the south are dual to the same cut - type hyperplane .",
    "self - osculation of bind - types occurs at an octagon - type vertex , when the northwest ( resp .",
    "southwest ) and the southeast ( resp .",
    "northeast ) are dual to the same bind - type hyperplane .",
    "inter - osculation between mixed types may also occur .",
    "for instance , if the northwest and the northeast are dual to the same bind - type hyperplane , this hyperplane will inter - osculate both the cut - type hyperplanes dual to the east and the west .      in this subsection",
    ", we show the cube complex @xmath15 constructed in subsection [ subsec - cubcplxx ] is virtually special , namely , such that a finite covering of @xmath15 is a special cube complex ( definition [ spcubecplx ] ) .",
    "note that for any covering @xmath613 , it makes sense to speak of the types of hyperplanes and vertices in @xmath614 , according to the type of the underlying image .",
    "there will also be an induced cut decomposition of @xmath614 , over a graph @xmath615 whose vertices correspond to the components of the @xmath616 , and whose edges correspond to the components of @xmath617 .",
    "moreover , for any bind - type hyperplane @xmath618 of @xmath614 , there is also an associate decomposition graph @xmath619 , which is a finite graph , and there is an associated map @xmath620 , for which the conclusion of lemma [ iotah ] still holds .",
    "our strategy is as follows . for every index @xmath487 ,",
    "pass to a finite cyclic covering @xmath621 of @xmath15 , so that there is no self - osculation of cut - type hyperplanes in an @xmath504 with the vertical index @xmath533 equal to @xmath361 , and that every bind - type hyperplane of index @xmath361 in @xmath621 induces an immersion between the decomposition graphs .",
    "then we pass to a further finite regular covering @xmath622 induced by a finite regular covering of the decomposition graph , so that every bind - type hyperplane of index @xmath361 in @xmath622 induces an embedding between the decomposition graphs .",
    "this will eliminate self - osculations of index-@xmath361 bind - types as well as inter - osculations between cut - types and index-@xmath361 bind - types .",
    "it follows that a common finite regular covering @xmath623 of all these @xmath622 s will be special .",
    "the finite cyclic covering @xmath621 .",
    "* let @xmath487 be an index .",
    "note that for every cut - curve @xmath301 , the restricted cohomology class @xmath557 is nontrivial as it evaluates nontrivially on @xmath345\\in h_1(t_z)$ ] , ( lemmas [ barxi ] , [ cohomologyclasses ] ) . let the positive integer @xmath624 be the least common multiple of all the divisibilities @xmath605 as @xmath41 runs over the all components of the cut - curves @xmath293 .",
    "let : @xmath625 be the finite cyclic covering corresponding to the kernel of the the composed homomorphism : @xmath626 > >",
    "h_1(m_\\sigma )    @>{\\xi^j } > > { { \\mathbf z}}@>\\bmod l^j > >   { { \\mathbf z}}_{l^j}.\\end{cd}\\ ] ] it is clear that the covering degree is @xmath627 . we denote the induced decomposition graph of @xmath621 as @xmath628 .    [ noosculatecut ] for any pair - of - pants @xmath298 with the vertical index @xmath533 equal to @xmath361 , and for any vertex @xmath629 with @xmath630 , no cut - type hyperplane in @xmath621 self - osculates at @xmath631 .    by lemma [ geom - cuttype ]",
    ", cut - type hyperplanes do not self - osculate at any band - type vertex in @xmath15 .",
    "in fact , there are two cut - type edges adjacent to each band - type vertex , but they are dual to different hyperplanes .",
    "thus cut - type hyperplanes do not self - osculate at any band - type vertex in @xmath621 either .",
    "suppose there were an octagon - type vertex @xmath632 , such that @xmath633 for some pair - of - pants @xmath298 with the vertical index @xmath533 equal to @xmath361 , and that there are two cut - type edges adjacent to it dual to the same cut - type hyperplane @xmath634 .",
    "pick a path on @xmath618 joining the two end - points on @xmath618 of the two edges .",
    "project the loop @xmath635 formed by the path and the two edges to @xmath15 via @xmath636 , then @xmath637 represents an element in @xmath525 .",
    "let @xmath301 be the cut - curve whose corresponding hyperplane @xmath497 equals @xmath638 , ( lemma [ geom - cuttype ] ) .",
    "then by counting the algebraic intersection number of @xmath82 and @xmath517 , @xmath639)$ ] modulo @xmath640)$ ] is nontrivial .",
    "note that the absolute value of @xmath640)$ ] is the divisibility of @xmath641 , since @xmath604 is generated by @xmath345 $ ] and @xmath603 $ ] while @xmath585)=0 $ ] , ( lemma [ cohomologyclasses ] ) .",
    "thus @xmath639)$ ] modulo @xmath624 is nontrivial either .",
    "such a loop @xmath635 can not lie in the covering space @xmath621 , so we reach a contradiction .    [ immersioniotah ] for every index-@xmath361 bind - type hyperplane @xmath634 , the associated map between the decomposition graphs : @xmath642 is an immersion .    by lemma [ iotah ] , we must show that for any component @xmath643 of the preimage @xmath644 , no two boundary components of @xmath645 lie in the same component of @xmath646 .",
    "if @xmath647 is vertical in @xmath648 , this is automatically true by lemma [ geom - vertical ] .",
    "if @xmath647 is horizontal in @xmath648 , suppose there were some component @xmath649 containing two distinct boundary components @xmath650 .",
    "let @xmath301 be the cut - curve so that @xmath497 equals @xmath651 .",
    "because @xmath636 is the cyclic covering induced by @xmath347 modulo @xmath624 , and because the union @xmath652 of index-@xmath361 bind - type hyperplanes is dual to @xmath347 by our construction , ( lemma [ geom - bindtype ] ) , @xmath621 can be obtained by cyclically gluing @xmath627 copies of @xmath653 . in particular",
    ", @xmath636 embeds @xmath654 into @xmath504 , so the projected images of @xmath655 and @xmath656 in @xmath389 are different as well .",
    "pick a path in @xmath647 with the two end - points @xmath657 on @xmath658 , respectively , and pick another path in @xmath618 joining @xmath659 .",
    "project the loop @xmath635 formed by these two paths into @xmath504 , so that @xmath637 represents an element in @xmath530 .",
    "as @xmath660 have distinct projected images , counting the algebraic intersection number of @xmath82 with @xmath517 yields that @xmath661)$ ] modulo @xmath571 is nontrivial , ( lemma [ geom - horizontal ] ) .",
    "thus @xmath639)\\bmod l^j$ ] is nontrivial either , which leads to a contradiction as the loop @xmath635 can not lie in the covering space @xmath621 .    *",
    "step 2 . the graph - induced covering @xmath622 .",
    "* we find some finite regular covering @xmath662 , so that for every bind - type hyperplane of index @xmath361 , all the elevations of @xmath663 into @xmath664 are embeddings . here by an _ elevation _ of @xmath663 we mean a map @xmath665 from a connected covering @xmath666 of @xmath667 into @xmath668 , minimal subject to the following commutative diagram of maps : @xmath669 writing @xmath670 for the naturally induced finite regular covering of @xmath614 , it is clear that every elevation is exactly the induced map @xmath671 for some component @xmath672 of the preimage of @xmath618 .",
    "[ embeddingiotah ] there exists a finite regular covering @xmath662 , so that for every bind - type hyperplane of index @xmath361 , every elevation of @xmath663 into @xmath668 is an embedding .",
    "this follows from the fact that finitely generated free groups are lerf , ( ( * ? ? ?",
    "* theorem 2.2 ) ) .",
    "recall from @xcite that a group @xmath31 is said to be _ locally extended residually finite _ ( or _ lerf _ ) , if for every finitely generated subgroup @xmath24 of @xmath31 , and for every @xmath673 not in @xmath24 , there is a finite - index subgroup @xmath674 of @xmath31 containing @xmath24 , which does not contain @xmath478 . if @xmath259 is a connected cw complex with @xmath675 , then @xmath31 is lerf if and only if for every finitely generated covering @xmath676 and every compact subset @xmath677 , @xmath678 factors through a finite covering of @xmath259 in which @xmath679 embeds , ( cf .",
    "* lemma 1.4 ) ) .",
    "suppose @xmath680 is a bind - type hyperplane of index @xmath361 , by lemma [ immersioniotah ] , @xmath681 is an immersion , so it is @xmath282-injective .",
    "let @xmath682 be the covering corresponding to image of @xmath683 , ( after picking a base - point ) .",
    "then @xmath663 elevates to an embedding into @xmath684 . because @xmath685 is a finitely generated free group , it is lerf , so @xmath682 factors through a finite covering @xmath686 , in which an elevated image @xmath687 embeds . in other words",
    ", there is an elevation of @xmath663 into @xmath686 which is an embedding .",
    "pass to the characteristic covering @xmath688 , corresponding to the intersection of all the conjugates of @xmath689 in @xmath685 , then @xmath690 is a finite regular covering into which every elevation of @xmath663 is an embedding .    by lemma [ geom - bindtype ] , there are only finitely many bind - type hyperplanes of index @xmath361 in @xmath15 , so there are only finitely many index-@xmath361 bind - types in @xmath621 as well .",
    "we take a common finite regular covering @xmath691 of all these @xmath690 .",
    "it is the covering as desired .",
    "let : @xmath692 be the finite regular covering of @xmath621 naturally induced from the finite regular covering @xmath662 as in lemma [ immersioniotah ] .",
    "[ noosculatebind ] no bind - type hyperplane of index @xmath361 self - osculates in @xmath622 .    by lemmas [ geom - vertical ] , [ geom - horizontal ] , no bind - type hyperplane in any @xmath504 self - osculates .",
    "indeed , bind - type edges adjacent at any vertex are dual to distinct hyperplanes in @xmath504 . passing to the covering space",
    ", this also holds for any component of @xmath693 .",
    "now let @xmath694 be any hyperplane .",
    "suppose @xmath695 is any component of @xmath693 , for any @xmath298 . by lemmas [ iotah ] , [ embeddingiotah ] , @xmath672 intersects @xmath695 in a single hyperplane , if not in the empty set .",
    "thus at any vertex in @xmath695 , at most one edge is dual to @xmath672 in @xmath622 .",
    "this means @xmath672 does not self - osculate in @xmath622 , which completes the proof .",
    "[ nointerosculate ] no bind - type hyperplane of index @xmath361 inter - osculates any cut - type hyperplane in @xmath622 .    by lemma [ geom - cuttype ] ,",
    "every cut - type hyperplane of @xmath15 is contained in exactly two components of @xmath696 .",
    "this also holds for cut - type hyperplanes in @xmath622 .",
    "if a cut - type hyperplane @xmath697 intersect an index-@xmath361 bind - type hyperplane @xmath694 .",
    "suppose @xmath695 is a component of some @xmath698 , which is adjacent to @xmath699 .",
    "it follows from lemmas [ iotah ] , [ embeddingiotah ] that the intersection @xmath700 is a single hyperplane in @xmath695 , and it does not osculate @xmath699 , ( lemmas [ geom - vertical ] , [ geom - horizontal ] ) .",
    "this implies @xmath672 does not osculate @xmath699 , which completes the proof .",
    "* step 3 . the common covering @xmath623 .",
    "* we take the covering : @xmath701 to be the common covering of all the @xmath622 , as @xmath361 runs over @xmath702 . in other words",
    ", @xmath623 is the finite regular covering of @xmath15 corresponding to the intersection of all the subgroups @xmath703 of @xmath704 .",
    "[ ddotxspecial ] the cube complex @xmath623 is special .    by lemma [ positionsbasic ] ( 1 ) , every hyperplane in @xmath623 is two - sided with no self - intersection . by lemmas [ noosculatecut ] , [ noosculatebind ] and the fact that @xmath623 is the common covering of all the @xmath622 s , no hyperplane in @xmath623 self - osculates . by lemmas [ positionsbasic ] ( 2 ) , ( 3 ) , [ nointerosculate ]",
    ", there is no inter - osculation between hyperplanes in @xmath623 either .",
    "we conclude that the cube complex @xmath623 is special .    to sum up",
    ", we have shown that for a multitwist @xmath51 with a bipartite configuration graph , if the current equations associated to @xmath51 have a nondegenerate symmetric solution , then we can find a cut - bind system @xmath287 , ( subsection [ subsec - setupdata ] ) , and construct a canonical cube complex @xmath15 , ( subsection [ subsec - cubcplxx ] ) .",
    "moreover , @xmath15 is homeomorphic to @xmath483 for some @xmath705 , ( lemma [ xproduct ] ) , and @xmath15 is virtually special , ( lemma [ ddotxspecial ] ) .",
    "this completes the proof of proposition [ spcubulation ] .",
    "in this section , we summarize the proof of theorem [ main - npcgm ] .",
    "a compact seifert space is aspherical if and only if its base orbifold is compact and aspherical .",
    "it is virtually fibered if and only if either it has nonempty boundary , or that it is closed with vanishing euler class of the fiber . note that this is exactly the case when the seifert fibered space is nonpositively curved , cf .",
    "the other three statements are straightforward to check",
    ".      such an @xmath0 is @xmath7-geometric , so it is not nonpositively curved , ( @xcite , @xcite ) .",
    "it is clearly not virtually rfrs either .",
    "in fact , for any sequence of finite index subgroups @xmath163 with each @xmath39 factoring through a free abelian group , the intersection of all the @xmath165 s always contains a finite - index subgroup the commutator subgroup of @xmath1 . note that the second and the third statement implies the fourth , ( cf .",
    "subsections [ subsec - raag ] , [ subsec - rfrs ] ) .",
    "thus none of the statements in theorem [ main - npcgm ] holds for such an @xmath0 .",
    "[ reduction ] if the conclusion of theorem [ main - npcgm ] holds for the mapping torus @xmath3 of every multitwist @xmath51 with a bipartite configuration graph , it holds for any nontrivial compact graph manifold as well .",
    "the bounded case reduces to the closed case .",
    "in fact , if @xmath0 is a compact graph manifold with nonempty boundary , it follows from @xcite that @xmath0 supports a nonpositively curved riemannian metric with totally geodesic boundary .",
    "then the double @xmath211 of @xmath0 along the boundary is closed and nonpositively curved .",
    "assuming that theorem [ main - npcgm ] holds in the closed case , then @xmath706 is virtually specially cubulated , and is virtually a subgroup of a right - angled artin group , and is virtually rfrs . as @xmath1 may be regarded as a subgroup of @xmath706 , the same holds for @xmath1 .",
    "the closed case reduces to the fibered case .",
    "this is because all the statements of theorem [ main - npcgm ] are virtual properties , and each of them implies that the manifold is virtually fibered , ( theorems [ thm - sv ] , [ thm - hw ] , [ thm - ag ] ) .",
    "furthermore , lemmas [ mappingtorus ] , [ solcase ] imply that it suffices to prove theorem [ main - npcgm ] for the mapping torus of multitwists with a bipartite configuration graphs .",
    "we reduced to the case for nontrivial graph manifolds by lemma [ sfcase ] .",
    "moreover , by lemma [ reduction ] , it suffices to assume that @xmath0 is the mapping torus @xmath3 of some multitwist @xmath51 with a bipartite configuration graph .    to see ( 1 ) @xmath6 ( 2 ) , note the nonpositive curving implies a nondegenerate symmetric solution of the bkn equations associated to @xmath51 , ( theorem [ thm - bs ] ) .",
    "by proposition [ nssolutions ] , the current equations virtually have a nondegenerated symmetric solution as well . after passing to a finite covering",
    ", we can apply proposition [ spcubulation ] to construct a special cube complex homotopy equivalent to @xmath3 .    to see ( 2 )",
    "@xmath6 ( 3 ) , we apply theorem [ thm - hw ] .",
    "note that @xmath707 is finitely generated , so we may further require the right - angled artin group @xmath33 to be finitely generated , for instance , by taking subgroup @xmath708 generated only by the generators of @xmath33 that spell the words representing the image of the generators of @xmath709 .",
    "to see ( 4 ) @xmath6 ( 1 ) , note the virtual rfrs - ness implies virtually a nondegenerate symmetric solution of the current equations , ( lemma [ rfrsnssol ] ) , and hence a nondegenerate symmetric solution to the bkn equations , ( proposition [ nssolutions ] ) . by theorem [ thm - bs ]",
    ", @xmath3 is nonpositively curved .",
    "this completes the proof .",
    "d.  gromoll , j.  a.  wolf , _ some relations between the metric structure and the algebraic structure of the fundamental group in manifolds of nonpositive curvature _ , bull .",
    "* 77 * ( 1971 ) , 545552 .",
    "j.  luecke , y .- q .",
    "wu , _ relative euler number and finite covers of graph manifolds _ , geometric topology ( athens , ga , 1993 ) , ams / ip stud",
    ".  adv .",
    "2.1 , american mathematical society , provi- dence , ri , 1997 , pp .  80103 .",
    "v.  svetlov , _ graph - manifolds of nonpositive curvature are virtually fibered over a circle _ , ( russian ) , algebra i analiz * 14 * ( 2002 ) , no .  5 , 188201 ; english translation in st .",
    "petersburg math .",
    "j.  * 14 * ( 2003 ) , no .  5 , 847856 ."
  ],
  "abstract_text": [
    "<S> in this paper , we show that an aspherical compact graph manifold is nonpositively curved if and only if its fundamental group virtually embeds into a right - angled artin group . as a consequence , </S>",
    "<S> nonpositively curved graph manifolds have linear fundamental groups . </S>"
  ]
}