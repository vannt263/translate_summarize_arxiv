{
  "article_text": [
    "diffuse reflectance spectroscopy in the visible and near - infrared range ( vis - nir drs ) has proved to be useful to assess various soil properties @xcite .",
    "it can be employed to provide more data rapidly and inexpensively compared to classical laboratory analysis .",
    "therefore , drs is increasingly used for vast soil surveys in agriculture and environmental research @xcite . recently",
    ", several studies have shown the applicability of vis - nir drs _ in situ _ as a proximal soil sensing technique @xcite .    to predict soil properties from soil spectra ,",
    "a model is calibrated , often using partial least squares ( pls ) regression . however , when calibration is based on air - dried spectra collected under laboratory conditions , predictions of soil properties from field spectra tend to be less accurate @xcite .",
    "usually , this decrease in accuracy is attributed to varying moisture between air - dried calibration samples and field spectra recorded with a variable moisture content .",
    "different remediation techniques have been proposed , ranging from advanced preprocessing of the spectra @xcite to `` spiking '' the calibration set with field spectra @xcite .    in our study",
    ", we adopt a slightly different view on the calibration problem .",
    "it does not only apply to the varying moisture conditions between the calibration data set and the field spectra .",
    "indeed , it is also valid if we want to predict soil properties in a range where calibration samples are rare .",
    "mining with rarity or learning from imbalanced data is an ongoing research topic in machine learning @xcite . in imbalanced data sets",
    "frequent samples outnumber the rare once .",
    "therefore , a model will be better at predicting the former and might fail for the latter .",
    "two different approaches exist to take care of the data imbalance : we can either adjust the model or `` balance '' the data .",
    "the latter approach has the advantage that we can use the usual modelling framework .",
    "synthetic minority oversampling technique ( smote ) is one way to balance the data .",
    "it was first proposed for classification @xcite and recently for regression @xcite .",
    "smote oversamples the rare data by generating synthetic points and thus helps to equalize the distribution .    in this study",
    ", we propose a strategy to increase the prediction accuracy of soil properties from field spectra when they are rare in calibration .",
    "the goal of this study is to build a calibration model to predict soil organic carbon content ( socc ) from field spectra by air - dried samples spiked with synthetic field spectra .",
    "the studied soil was sampled at the southern slopes of mt .",
    "kilimanjaro , tanzania ( 3@xmath3 4@xmath4 33@xmath5 s , 37@xmath3 21@xmath4 12@xmath5 e ) in coffee plantations . due to favourable soil and climate in this region ,",
    "extensive coffee plantations constitute a frequent form of land use .",
    "we took 31 samples for calibration at 4 different study sites . for validation",
    ", we scanned 12 field spectra at a wall of a soil pit and sampled soil material for chemical analysis at the scanned spots .",
    "we call these validation field spectra f.    after collection , the calibration samples were dried in an oven at 45@xmath3c and sieved @xmath6 2 mm .",
    "subsequently , they were scanned with an agrispec portable spectrophotometer equipped with a contact probe ( analytical spectral devices , boulder , colorado ) in the range 3502500 nm with 1 nm intervals .",
    "the same spectrometer was used in the field .",
    "the instrument was calibrated with a spectralon white tile before scanning the soil samples . for the measurement",
    ", a thoroughly mixed aliquot of the sample was placed in a small cup and the surface was smoothed with a spatula .",
    "each sample was scanned 30 times and the signal averaged to reduce the noise . in the following , we call this calibration data set l.    socc was measured in a cns - analyser by high temperature combustion with conductivity detectors .",
    "to generate new data to spike the calibration data set l , we used smote @xcite and its extension for regression @xcite .",
    "this algorithm consists of generating new synthetic data using existing data and is summarized below . in our case , we generated new spectra and the related socc using the field spectra f. the new spectra are created by calculating the difference between a field spectrum and one of its nearest neighbours and adding this difference ( weighted by a random number between 0 and 1 ) to the field spectrum .",
    "the socc of the synthetic spectrum is then a weighted average between the socc of the field spectrum and the used nearest neighbour .",
    "smote has two parameters , namely @xmath7 , the number of points to generate for each existing point ( given in percent of the whole data set ) and @xmath8 , the number of nearest neighbours . to study the influence of these parameters we generated six different synthetic data sets s1 through s6 , varying @xmath9 and @xmath10 .",
    "@xmath11 $ ] : original sample @xmath12 @xmath13 $ ] : target value of original sample @xmath14 @xmath15 $ ] : synthetic sample @xmath16 @xmath17 $ ] : target values of synthetic sample @xmath18 @xmath19 @xmath20 : number of synthetic samples to compute for each original sample    generate synthetic samples : @xmath21 compute @xmath8 nearest neighbours for @xmath11 $ ] randomly choose @xmath22 @xmath23 $ ] @xmath24 = { \\mathit{orig.s}}[i ] + \\mathrm{random}(0,1 ) \\times { \\mathit{diff}}$ ] @xmath25)$ ] @xmath26 @xmath27      we corrected each spectrum ( calibration , validation and synthetic ) for the offset at 1000 and 1830 nm and kept only parts with a high signal - to - noise ratio ( 4502400 nm ) .",
    "then , we transformed the spectra to absorbance @xmath28 and smoothed them using the singular spectrum analysis ( ssa ) .",
    "ssa is a non - parametric technique to decompose a signal into additive components that can be identified as the signal itself or as noise @xcite . finally , we divided each spectrum by its maximum and calculated the first derivative .    in order to assess similarities between the calibration , validation and synthetic data sets , we calculated the principal component analysis ( pca ) of the ( uncorrected original ) spectra l and f and projected the synthetic data into the space spanned by the principal components .",
    "we calibrated seven different pls models .",
    "for model i we used the data set l , the spectra scanned under laboratory conditions .",
    "model ii through vii were calibrated on l spiked with synthetic spectra s1 through s6 . to find the best model i through vii",
    ", we varied the number of pls components between 1 and 15 .",
    "based on the predictions in the leave - one - out cross - validation ( loocv ) we calculated the corrected akaike information criterion @xcite aic@xmath29 , where @xmath30 is the number of calibration samples , @xmath31 the number of pls components and @xmath32 the root mean - squared error .",
    "the latter is defined as @xmath33 , where @xmath34 are the predicted and @xmath35 the measured soccs .",
    "we selected the model with the smallest aic@xmath36 as the most plausible .",
    "to assess the model quality , we used the @xmath32 , the mean error @xmath37 and the coefficient of determination @xmath38 , where @xmath39 is the mean socc .",
    "smote has two random components because it selects spectra randomly ( with replacement ) among the nearest neighbours and weights the difference between spectra by a random number ( between 0 and 1 ) . to study the influence of these random steps",
    ", we generated 100 different datasets s1 through s6 .",
    "each data set was then used to spike the calibration data set l , to build a new pls model and to predict the data set f.",
    "the first principal components ( pcs ) explain 85.4% and 11.2% of variance , respectively .",
    "we can clearly identify two distinct groups of samples : the calibration data set l and the field spectra f ( fig .",
    "[ fig : pca ] ) .",
    "in other words , the data sets l and f differ .",
    "the synthetic points that were projected into the space spanned by the pcs resemble the field spectra as expected .",
    "the distinct characteristics of the data sets l and f accord well with the difficulties to predict the data set f by using the laboratory spectra l only ( table  [ tab : results : calib ] and table  [ tab : results : valid ] ) . although the loocv of model i yields a moderate @xmath32 and a large @xmath1 , the validation on the data set f fails .    spiking the calibration data",
    "set l with synthetic spectra increases the prediction accuracy of the socc in the data set f. actually , the @xmath32 decreases and @xmath1 increases with increasing number of synthetic points both for the loocv and the validation ( table  [ tab : results : calib ] and table  [ tab : results : valid ] ) .",
    "however , the number of model parameters also increases from 2 to 7 .",
    "the monte carlo results show only a small variability in the interquartile range . however , some synthetic data sets in model v produced @xmath1 values smaller than @xmath20.53 , the value we obtain in model i on air - dried samples only .",
    "this might be due to the combination of neighbours during smoting .",
    "in general , models with 5 neighbours were more accurate than those with 3 neighbours .",
    "however , the number of neighbours had a smaller influence on the prediction accuracy than the number of synthetic points .",
    "it is difficult to decide _ a priory _ how many synthetic points should be included in the calibration .",
    "indeed , in a classification problem the goal is to approximate an equal distribution of different classes such that the rare class becomes an ordinary one . in regression , however , we do not know which features of the data make them rare . for our data , the range of socc in the data set l is larger than in the data set f. therefore , we conclude that concentration is not responsible for the difference between these data sets .    based on the monte carlo results we chose one synthetic data set from model vi , namely the one with the median number of model parameters and the best @xmath1 in the validation .",
    "thus , the calibration data set includes 31 air - dried and 24 synthetic spectra . compared to model i",
    ", spiking the air - dried data set l with these synthetic spectra clearly improves the prediction of the data set f ( fig .",
    "[ fig : models ] ) .    [ cols=\"<,<,>,>,>,>,>,>\",options=\"header \" , ]",
    "we propose a framework to predict soil properties from _ in situ _ acquired field spectra by spiking air - dried laboratory calibration data by synthetic ones generated from these field spectra . in general , the prediction accuracy increases when a sufficient number of synthetic points is included in the calibration . however , because it is difficult to determine this number _ a priori _ , we recommend to generate several synthetic data sets to find an appropriate model .",
    "this study is part of the project dfg for 1246 `` kilimanjaro ecosystems under global change : linking biodiversity , biotic interactions and biogeochemical ecosystem processes '' and was supported by the deutsche forschungsgemeinschaft .",
    "b.  stenberg and r.  a. viscarra  rossel , `` diffuse reflectance spectroscopy for high - resolution soil sensing , '' in _ proximal soil sensing _ , r.  a. viscarra  rossel , a.  b. mcbratney , and b.  minasny , eds . , pp .",
    "springer , 2010 .",
    "k.  d. shepherd and m.  g. walsh , `` infrared spectroscopy - enabling an evidence - based diagnostic surveillance approach to agricultural and environmental management in developing countries , '' , vol .",
    "1 , pp . 119 , 2007 .",
    "vgen , k.  d. shepherd , and m.  g. walsh , `` sensing landscape level change in soil fertility following deforestation and conversion in the highlands of madagascar using vis - nir spectroscopy , '' , vol .",
    "3 , pp . 281294 , 2006 .",
    "r.  a. viscarra  rossel , s.  r. cattle , a.  ortega , and y.  fouad , `` in situ measurements of soil colour , mineral composition and clay content by vis",
    " nir spectroscopy , '' , vol .",
    "3 , pp . 253266 , 2009 .",
    "t.  h. waiser , c.  l.  s. morgan , d.  j. brown , and c.  t. hallmark , `` in situ characterization of soil clay content with visible near - infrared diffuse reflectance spectroscopy , '' , vol .",
    "2 , pp . 389396 , 2007 .",
    "b.  minasny , a.  b. mcbratney , v.  bellon - maurel , j .-",
    "roger , a.  gobrecht , l.  ferrand , and s.  joalland , `` removing the effect of soil moisture from nir diffuse reflectance spectra for the prediction of soil organic carbon , '' , vol .",
    "118124 , 2011 ."
  ],
  "abstract_text": [
    "<S> diffuse reflectance spectroscopy is a powerful technique to predict soil properties . </S>",
    "<S> it can be used _ in situ _ to provide data inexpensively and rapidly compared to the standard laboratory measurements . </S>",
    "<S> because most spectral data bases contain air - dried samples scanned in the laboratory , field spectra acquired _ in situ _ are either absent or rare in calibration data sets . </S>",
    "<S> however , when models are calibrated on air - dried spectra , prediction using field spectra are often inaccurate . </S>",
    "<S> we propose a framework to calibrate partial least squares models when field spectra are rare using synthetic minority oversampling technique ( smote ) . </S>",
    "<S> we calibrated a model to predict soil organic carbon content using air - dried spectra spiked with synthetic field spectra . </S>",
    "<S> the root mean - squared error of prediction decreased from 6.18 to 2.12 mg g@xmath0 and @xmath1 increased from @xmath20.53 to 0.82 compared to the model calibrated on air - dried spectra only .    </S>",
    "<S> = 1    diffuse reflectance spectroscopy , soil , partial least squares , calibration , smote </S>"
  ]
}