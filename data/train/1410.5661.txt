{
  "article_text": [
    "for a long time there has been a desire at bnl to recover the beam  beam parameter and with it the tune spreads from btf of beams undergoing the beam  beam effect .",
    "recently this desire has been intensified by the construction and installation of the electron lens  @xcite .",
    "normally the machine is run in conditions with the two rings tuned to identical or near - identical tunes .",
    "we refer to these conditions as _",
    "normal conditions_. under these circumstances , the coherent beam ",
    "beam modes often dominate the btf .",
    "when observed , the distance between @xmath0 and @xmath1 modes can be used to determine the beam  beam parameter and with it one can estimate the tune spread . for diagnosing the tune",
    "spread due to the electron lens we can not expect @xmath0 and @xmath1 modes outside the incoherent spectrum : the electron beam is dumped after usage and not fed back into the system .",
    "however , running the electron lens will lead to a tune spread similar to the one caused by the beam  beam effect ( but with a positive tune shift ) .",
    "this tune spread in turn will lead to a deformation of the betatron peak .",
    "we would like to be able to recover the strength of the electron lens from this deformation in the absence of beam  beam interactions .",
    "a similar situation can be hoped for in runs with split tunes .",
    "we talk about split tunes when the tunes are , unlike normal conditions , offset in the two rings ; for example , during the 2012 split tunes run they were typically separated by about 0.04 and located on either side of the 7/10 resonance line . in this case",
    "the coherent lines can move into the incoherent spectrum where they can be landau - damped .",
    "the resulting beam heating has been observed in measurement  @xcite . in simulation ,",
    "the incoherent spectrum of the beam  beam effect of split tunes leads to btf similar to those of an electron lens .",
    "however , due to the opposite sign of the force of the beam  beam and the electron lens the betatron peak is located on the other side of the lattice tune .",
    "when talking about btf we should specify what we mean exactly .",
    "the btf system at rhic uses the direct diode detection technique  @xcite developed at cern together with a coherent excitation signal fed onto the beams . the complex response amplitude as a fraction of excitation amplitude gives the btf at the frequency of the excitation .",
    "the excitation signal is swept over a range of frequencies around the fractional tune to obtain the btf as a function of frequency . commonly the complex btf is separated into phase and amplitude and the result is shown as a function of frequency .",
    "the btf of coasting beams have been studied in detail in the past , as they give , for example , information on the stability limits for beams under space charge .",
    "examples of such studies can be found in @xcite .",
    "we think that the machine conditions in rhic during pp - operation allow us to apply coasting beam considerations for the bunched beams in rhic : the synchrotron period with the 28 mhz radio frequency ( rf ) system and the time used to take one frequency sample in the baseband - q ( bbq ) btf system are about the same ( @xmath230  ms ) . for this reason , from the point of view of the btf measurement",
    ", the beam might be expected to resemble a coasting beam .",
    "longitudinal motion is very slow on the timescale of the btf measurement .",
    "simulations include chromaticity and synchrotron motion .",
    "it will be shown later that they agree with a coasting - beam description .      to account for an electron lens or a beam  beam effect where the coherent modes lie inside the incoherent spectrum , we use the theory developed by berg and ruggiero in  @xcite .",
    "we only have to extend the btf they give by replacing the tune change due to an octupole with the tune change due to a gaussian lens .",
    "the btf by berg and ruggiero is @xmath3 where @xmath4 and @xmath5 are the transverse action angle variables , @xmath6 are the distribution functions in action angle variables , separated into the contribution of @xmath7 and @xmath8 direction , @xmath9 is betatron frequency as a function of these variables , and @xmath10 is the frequency at which the btf is calculated .    for the distribution functions",
    "@xmath6 , we use the distribution of a gaussian transverse distribution in action angle variables as found for example in @xcite ( we can also simply split the @xmath11 we find in  @xcite to get @xmath6 ) .",
    "we also need the formula for the single particle tune shift due to a gaussian lens @xmath12 which as a function of the action - angle amplitudes of the particles @xmath13 and the peak tune shift @xmath14 is  @xcite @xmath15 because the bessel functions are slow to evaluate when one tries to calculate eq .  ( [ eq : anabtf ] ) numerically , instead of this analytic expression we use a well - behaved replacement that is friendlier for numerics and was developed for the treatment of space charge in  @xcite . with @xmath16 ,",
    "the approximation for our @xmath12 is now @xmath17 for the longitudinal distribution we assume a gaussian momentum spread with the tune shift according to chromaticity resulting in a tune deviation @xmath18 .",
    "it can be taken into account by modifying @xmath19 to include also the tune shift due to chromaticity , the resulting @xmath19 is @xmath20 where @xmath21 contains the combined densities in the vertical and momentum plane .",
    "the resulting @xmath22 is ",
    "@xmath23 with @xmath24 the revolution frequency , @xmath25 the lattice tune and @xmath26 the tune shift due to chromaticity .",
    "the chromaticity usually plays a minor role for the btf of realistic beams because rhic runs at low chromaticity .",
    "for the investigation of btf of beams undergoing the beam  beam effect in rhic , a simulation model was implemented on top of the particle tracking code patric  @xcite . for the tracking between interaction points  ( ips ) ,",
    "matrices from madx are used . the translation between ips",
    "is done by one single matrix multiplication with the linear one - turn map computed using the one - turn map on the 2012 100  gev polarized proton lattice  @xcite . for synchrotron motion",
    "the respective parts of the madx result are ignored and replaced by a more versatile model which is present in the code ; this allows us to take into account different rf waveforms .",
    "one instance of the code is run for each of the typically six ( in the case of two ips ) or two ( in the case of one ip ) coupling bunches .",
    "beam interaction is taken into account by exchanging the two - dimensional electric fields between the bunches at the interaction points and kicking the particles accordingly .",
    "the fields are calculated using a two - dimensional fast - fourier - transform - based poisson solver with open boundary conditions  @xcite .",
    "the beam  beam implementation reproduces the expected behaviour , especially the @xmath0 an @xmath1 modes are found at the expected positions of @xmath27 and @xmath28 with @xmath27 the tune , @xmath29 the beam  beam parameter and @xmath30 the yokoya factor  @xcite . the maximum single particle tune shift in simulation equals the beam  beam parameter as expected .",
    "the btf is implemented as follows .",
    "a particle ensemble of typically between @xmath31 and @xmath32 macroparticles is initialized as a matched gaussian distribution and left coasting for a few thousand turns to equilibrate possible matching errors . after this initial equilibration",
    "the equilibrium distribution is cached . then",
    ", a coherent excitation is carried out by adding a sinusoidal excitation signal @xmath33 to the momentum component of the particle vectors at each passing of the exciter .",
    "because the excitation frequency is chosen around the fractional tune , it is assumed that a whole bunch sees the same excitation signal .",
    "after each turn the transverse position of the centre of charge of the beam and the excitation signal amplitude is stored . in post",
    "- processing the btf is calculated as the fraction of the complex amplitudes of the response and the exciting signal .",
    "the amplitudes are determined using the discrete fourier transformation ( dft ) at the chosen excitation frequency .",
    "after each excitation frequency the pic - code re - initializes with the equilibrium particle distribution to reduce transient modes . to make sure we look primarily at the steady state of the excited beam , not at the transients ,",
    "the first few hundred turns at the excitation frequency are ignored .    in the case of multiple bunches in one ring ,",
    "the btf excitation signal takes into account the phase between the bunches to replicate the situation in the real machine where all bunches are excited by the same excitation signal .",
    "is the normalized frequency coordinate given in eq .",
    "( [ eq : normu ] ) .",
    "the simulation agrees well with analytic predictions . ]    before considering btf of more complex situations we needed to validate our simulation model to make sure we agree with known analytic results .",
    "a good benchmark is the btf of a beam with a gaussian velocity profile and a tune spread solely due to chromaticity .",
    "we consider the single particles as harmonic oscillators around their betatron frequency @xmath34 . in the derivation",
    "we follow  @xcite .",
    "a harmonic oscillator driven off - frequency at a frequency of @xmath10 carries out a beating at an amplitude @xmath35 which is proportional to @xmath36 . to determine the response of an ensemble of harmonic oscillators to a driving frequency @xmath10 the intuitive approach is to integrate amplitude over the density @xmath37 of eigenfrequencies . to make things simpler",
    ", @xmath35 can be approximated by @xmath38 where @xmath39 ( which is the case around the betatron lines ) .",
    "taking out constant factors , the btf behaves as @xmath40 this equation has an analytic solution for different forms of frequency distributions  @xcite .",
    "we look at the result for a gaussian frequency spread .",
    "the normalized frequency @xmath41 can be defined as a function of the mean particle betatron frequency @xmath42 , the driving frequency @xmath10 and the frequency width of the distribution @xmath43 via the equation , @xmath44 then the real and imaginary parts of the btf are proportional to @xmath45 and @xmath46 , as below  @xcite : @xmath47 the analytic btf compares well to our pic code as shown on example data in fig .",
    "[ fig : anal ] .",
    "it is also noteworthy that eq .",
    "( [ eq : fullanabtf ] ) simplifies to eq .",
    "( [ eq : chrombtf ] ) in the absence of the lens .",
    "the tune distributions in simulation are computed by running the simulation without btf excitation for ( 2000 to 8000 ) turns .",
    "the particle coordinates are stored for a subset of typically ( @xmath48 to @xmath31 ) particles . in post - processing",
    ", dft is used to find the peak of the oscillation frequency .",
    "the analytic tune distributions are computed by numerically evaluating particle density over the distribution and binning the resulting fractions into bins depending on the corresponding tune change according to eq .",
    "( [ eq : fulldq ] ) .      to model the electron lens",
    ", the code uses the analytic expressions for the fields of a round gaussian beam to kick the particles at one of the interaction points .",
    "the intensity of the field is adjusted to correspond to a chosen beam ",
    "beam parameter . the electron lens in simulation",
    "can be run as a _ positron lens _ by simply changing the sign of the beam  beam parameter , which we did most of the time to be able to easily make a comparison between btf with stationary gaussian lens and btf with split tunes .",
    "first we ran simulations of a beam undergoing an interaction solely with a gaussian lens . at the beginning it appeared as though the btf from simulation and the analytic expectation were in disagreement : the first simulations for both split tunes and electron - lens type configuration showed a double peak structure not present in the analytic expectation .",
    "however , as shown in a sweep of excitation amplitudes in fig .",
    "[ fig : ampcomp ] on the example of a split tunes simulation , a significant reduction in exciter amplitude led to results in which no double peaks were observed any more . after amplitude reduction ,",
    "the simulation results for a gaussian lens were in good agreement with the analytic formula from eq .",
    "( [ eq : fullanabtf ] ) .",
    "are on the right .",
    "the excitation amplitude ( the amplitude of the sinusoidal signal added to the @xmath49 component of the particle vector ) is given on the left of the plots .",
    "we see good agreement for medium amplitudes . for higher amplitudes",
    "we observe a deviation , possibly due to particles in the tails of the distribution or due to coherent modes . for lower amplitudes",
    "the numerical noise is higher than the signal but can be reduced by increasing particle number . ]      to test whether fitting to measured btf of a beam interacting with an electron lens would enable us to recover the beam  beam parameter , we ran simulations of beams with gaussian lenses of different beam  beam parameters .",
    "we fitted the analytic formula for the btf to simulated btf .",
    "because the evaluation of the analytic btf is rather costly , we calculate analytic btf in mathematica for a reasonable range of parameters and use an interpolating function to fit the simulation data .",
    "an example fit is shown in fig .",
    "[ fig : elensfitexample ] .",
    "the beam  beam parameters to which the fits converge lie within three percent of the actual beam  beam parameter chosen for the simulation .",
    "our test set consisted of simulated btf with beam  beam parameters between 0.0025 and 0.0145 .",
    "we conducted part of the simulation study on split tune conditions because during the current run the hopes for a running electron lens are not high .",
    "the btf of beams under split tune conditions looked similar to the analytic expectation for a defocussing gaussian lens .",
    "we ran simulations for split tune conditions for the same range of beam  beam parameters as we did previously for the electron lens .",
    "again we tried to recover the beam  beam parameters using our fitting routine . for the split tunes we observed a slight deviation of the analytic result from the btf even though overall agreement was visually still acceptable , as shown in fig .",
    "[ fig : fittedexamples ] .",
    "the beam  beam parameters recovered from the fits are given in the figure and were slightly underestimating the actual beam  beam parameter used in the simulation .",
    "we blame this on the coherent modes to be expected within the incoherent spectrum and possibly leading to a narrowing of the peak .",
    "a plot of the beam  beam parameter from the fit over the actual beam  beam parameter from the simulation can be found in fig .",
    "[ fig : linbbfit ] .",
    "the relation between fit result and actual beam  beam parameter appears to be scaling linearly with a factor of about 0.8 .",
    "this result might , however , be dependent on the tune splitting .    .",
    "]     from fit to btf simulations of split tunes and from simulation input .",
    "the dependence is approximately linear for our range of parameters . ]",
    "the btf that are available of split tunes measured in the machine do unfortunately not all replicate the analytic expectation .",
    "there may be several reasons for that .",
    "firstly the split tunes fills were full machines ( instead of the simulation situation of only two or six coupling bunches ) . during",
    "the 2012 run the btf system was measuring the centre - of - mass motion of all the bunches in the machine and combining them into a single btf . for conditions with differing bunch parameters",
    "this may lead to a deformation of the signal so that we can not expect it to follow our clean simulation data anymore .",
    "furthermore the coherent modes in the incoherent tune distribution can lead to a deformation of the bunches and a resulting deformation of the btf not covered by our assumption of round gaussian beams .",
    "for this reason we decided to look at the btf of the best - behaved fills among the split tunes .",
    "best - behaved means , in this case , no multipeak - structures in the individual planes , low heating compared to the other fills , and rather round beams .",
    "the beams were , however , still slightly asymmetrical ( normalized 6 @xmath1 emittances were , for yellow , @xmath50 , and , for blue , @xmath51 ) at an average of @xmath52 particles per bunch .",
    "nevertheless we tried to apply the fitting algorithm for round beams demonstrated above on simulated btf . in the horizontal plane according to the beam properties we would expect a beam  beam parameter of 0.012 to 0.014 .",
    "we found a reasonable approximation of the measurement by the analytic result . the beam  beam parameters obtained from the fits to yellow and blue horizontal btf measurement data are @xmath53 and @xmath54 when one takes into account the factor of 0.835 between @xmath55 and @xmath56 obtained from simulation .",
    "furthermore the fits to amplitude and phase deviate only by a few percent .",
    "in the vertical plane , the peaks looked distorted , on which basis we reason that here other effects might be at work . on top of that , in the vertical plane , coherent modes were observed for some fills .",
    "example fits in the horizontal plane can be found in fig .",
    "[ fig : measana ] .",
    "currently our analytic model is restricted to round gaussian beams , as is typically the case in rhic . however , it should be feasible to generalize the analytic theory for arbitrary aspect ratios by adjusting @xmath12 . in absence of an electron",
    "lens a possible test scenario for the fitting method could be found in weak ",
    "strong beam  beam interactions , where a strong beam could be modelled as the electron lens and the measurement would be done on the weak beam . for the 2013 run ,",
    "the btf system has been upgraded and is now able to measure btf of single bunches , which would enable running different intensity strong  weak btf in one fill .",
    "furthermore , once the electron lenses are up and running , we can test whether the btf of an electron lens agrees with the btf according to eq .",
    "( [ eq : fullanabtf ] ) , as is to be expected according to our simulation . in this case",
    "we would be able to give a good estimate for the strength of the electron lens from the btf alone .",
    "paul grgen would like to thank simon white for his support ."
  ],
  "abstract_text": [
    "<S> we present considerations about the transverse beam transfer function ( btf ) of beams under the influence of two effects : the strong  strong beam  beam effect and the influence of a gaussian electron lens . </S>",
    "<S> the btf are investigated using two methods : btf excitation is simulated in a particle - in - cell ( pic ) code . </S>",
    "<S> the btf model is verified using a known analytic expectation . </S>",
    "<S> analytic expectations for btf of beams under a stationary electron lens are derived by extending btf from the formalism of berg and ruggiero . </S>",
    "<S> finally we compare the analytic btf results for a stationary gaussian lens to both the pic simulation for split tune conditions and to pic simulations for a beam influenced by an electron lens . </S>",
    "<S> we conclude that the formalism represents the electron lens well and can be applied to a limited extend to the beam  beam effect under split tune conditions . </S>",
    "<S> the analytic formalism allows us to recover the strength of an electron lens by means of fitting and can give clues regarding the strength of the beam  beam effect under split tune conditions . </S>"
  ]
}