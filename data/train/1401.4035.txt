{
  "article_text": [
    "the galactic cosmic ray propagation problem , i.e. , the question how cosmic rays are transported from their sources to arbitrary locations in the galaxy , becomes ever more relevant with recent advances in observational techniques .",
    "such observations yield the flux of primary cosmic rays ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) or also of secondaries at earth . for neutral secondary particles",
    "also directional information can be extracted from the data ( see , e.g. , * ? ? ?",
    "together with a physical description of the transport process of cosmic rays these data should allow a better understanding of the physics involved in cosmic ray transport .",
    "the transport of galactic cosmic rays is a diffusion - loss problem ( see * ? ? ?",
    "that is we have to find a solution of the partial differential equation : @xmath0 with @xmath1 where the first term on the right hand side represents the sources of cosmic ray species @xmath2 , the second term gives the spatial diffusion , the third represents the energy losses and the fourth term gives losses by fragmentation and radioactive decay for the current cosmic ray species .",
    "this partial differential equation has been solved using different numerical codes or analytical approximations or a mixture of both .",
    "use of analytical solutions or approximations within a numerical code decreases the numerical cost to find a solution and gives more direct idea of the underlying dependence of the solution on different parameters .",
    "analytical methods , however , are not suited to investigate the cosmic ray propagation problem in a realistic environment , i.e. , an environment , where all functions that determine the final outcome of eq . ( [ eqpropagation ] )",
    "are allowed to vary arbitrarily in configuration- and momentum - space .    with the increasing precision of galactic cosmic ray measurements",
    "an analytical approach is far from being able to explain the fine details in the measurements .",
    "also a discussion of @xmath3 tev cosmic rays would necessitate consideration of the cosmic ray transport from individual sources .",
    "therefore we will only discuss fully numerical methods in the paper , thus also omitting references to such numerical codes like usine ( see * ? ? ? * ) ) that use analytical approximations to improve the performance of the code .",
    "such codes aim at finding the best values for the variables in eq .",
    "( [ eqpropagation ] ) which , however , are assumed constant in the space .    for the full numerical solution of the galactic cosmic ray propagation problem",
    "there are mainly two publicly available codes : galprop ( see * ? ? ?",
    "* ) and dragon ( see * ? ? ?",
    "galprop is a very sophisticated framework that tries to include all relevant physics for the propagation problem with a high complexity .",
    "the dragon code emerged from an earlier galprop version and has been continuously enhanced since . in particular dragon allows a significantly more complex description for some of the transport parameters , like e.g. fully anisotropic spatial diffusion , than currently available in galprop  see , e.g. , @xcite , where also the effort in establishing the transition to spatially three - dimensional simulations is shown .",
    "there are indeed some issues with the representation of the physical parameters in galprop as is discussed in @xcite .",
    "this will not be subject of the present paper .",
    "here we rather diagnose the problem that there was far less attention directed to the numerical solver in galprop than to other aspects of the code .",
    "this led to the fact that the solver is rather outdated regarding the numerical methods employed .",
    "consequently we will discuss the implementation of an up to date numerical solver within a code that can adopt the same transport parameters as galprop , using initialisation via galdef files . in sect .",
    "[ secnumerics ] we describe the new numerical scheme .",
    "corresponding tests will be discussed in sect .",
    "[ sectests ] and we will show a typical example of a galactic cosmic ray propagation problem in sec .",
    "[ secexample ] .",
    "finally we will conclude with an outlook on ongoing development of the code .",
    "as mentioned in the introduction the presently most widely used code for the solution of the galactic cosmic ray transport problem is galprop .",
    "this code was introduced some 20 years ago ( see * ? ? ?",
    "* ) where the numerical solver has only been marginal altered since that time .    the solution in the galprop code is computed from a crank - nicolson discretisation of the partial differential equation eq .",
    ", where the authors use operator splitting by which they can apply the updating scheme to each spatial or momentum dimension separately . to avoid the problem of having to solve a prohibitively large amount of timesteps galprop",
    "additionally uses a procedure where a range of different timestep sizes is used for the time integration beginning with very large steps and ending at a user - specified smallest timestep . by this the solution can reach a steady state faster than for a constant timestep method ( for further details see the appendix of * ? ? ?",
    "this solution scheme , however , has some severe shortcomings .",
    "the first issue is that the numerical integration scheme depends on parameters to be set by the user .",
    "such parameters are , e.g. , the largest and smallest timestep , and the number each timestep size is supposed to be used for the integration .",
    "the final solution of a simulation then depends on the correct choice of these parameters .",
    "while the standard parameters might suffice for the standard galprop runs a significant change in the configuration might lead to the necessity to come up with a corresponding new set of integration parameters . to investigate the steady state solution",
    "that has been found galprop offers some diagnostic tools . these , however , have explicitly to be administered and also interpreted by the user . therefore , when finding new time - integration parameters , several simulations will have to be done with different parameters until it is certain that a steady state is reached from a comparison of the results .",
    "most of these issues arise from the fact that a time integration scheme is used where a steady state solution is searched for .",
    "therefore , we are using two different approaches depending on the question whether the parameters in eq . are time dependant or not . in the former case",
    "the solution is obtained by integrating eq .",
    "( [ eqpropagation ] ) from some initial conditions up to the time of interest .",
    "whenever the source term @xmath4 , the diffusion tensor @xmath5 , the momentum loss rate @xmath6 and the catastrophic loss times @xmath7 are time independent we are using a solver that yields a steady state solution without any integration in time instead . in this section",
    "we will discuss both approaches - keeping in mind that it is also a viable option to use a steady state solution to compute an initial condition for the time dependant problem .",
    "looking at the transport equation eq . shows that when re - acceleration is not taken into account we only have to deal with first order derivatives in momentum space .",
    "if additionally the energy changes universally occur in the same direction , the momentum space transport problem becomes particularly simple .",
    "this motivates the choice of a dedicated solver . even though this might seem to be a special case it is a very common application in galactic cosmic ray propagation simulations . by comparison with the more general solver we will later find that the solver adapted to this particular case is indeed more efficient than the general one . in the following",
    "we will refer to the different solvers as the _ re - acceleration scheme _ for the general solver and the _ energy - loss scheme _ for the special case without re - acceleration .",
    "we will introduce adapted solvers for both situations .",
    "we start by discussing the steady state problem .      looking for a steady state solution of eq .",
    "( [ eqpropagation ] ) means that we are looking for a solution where the time - derivative goes to zero .",
    "therefore a popular option is to do a time integration instead and integrate until a steady state solution is reached , i.e. until the solution does not change anymore .",
    "depending on the choice of variables in eq .",
    "( [ eqpropagation ] ) this , however , can take quite some time and also a good criterion is needed to check whether the code has found a steady state solution . in particular , one has to ask how small a change would have to be in order to indicate such a steady state .",
    "this is a particular issue for cosmic ray transport were the solution varies over orders in magnitude especially as a function of energy .",
    "here we are therefore using a different approach , where we explicitly make use of the fact that the time derivative is supposed to be zero .",
    "that is we are solving the equation @xmath8    instead . for this equation",
    "it is not possible to use dimensional splitting anymore like , e.g. , employed in the galprop code .",
    "solving eq .",
    "( [ eqpropagationsteady ] ) requires solving the whole equation at once . to find a numerical solution we need to discretise this equation on a grid  here",
    "we use the same approach as in galprop , i.e. , a linear spatial grid and a logarithmic grid in momentum space . using such a discretisation",
    "the above pde is transformed into a coupled system of algebraic equations . in 1d",
    "such a system can directly be solved by inverting the corresponding matrix ( that motivates the dimensional splitting used , e.g. , in galprop ) , which usually is just a tridiagonal matrix . in the present case with three spatial and one momentum dimension",
    ", however , a direct solution is not efficient to compute anymore .",
    "therefore we are using an iterative method that relies heavily on the application of multigrid methods , which turned out to lead to excellent convergence in this case .",
    "as indicated above , we will now discuss two different implementations of the numerical solver .",
    "neglecting re - acceleration and provided that energy losses always dominate gains by adiabatic energy changes it is possible to derive an extremely efficient solution scheme for the cosmic ray transport problem . due to the fact that spatial advection can only be treated using this scheme , when adiabatic energy gains are sufficiently small everywhere , we will allow spatial advection exclusively in the full scheme that also allows for re - acceleration . in the steady state energy - loss scheme",
    ", we solve the reduced transport equation : @xmath9 we now discuss the ingredients for the particular solver individually .",
    "first we start by discussing the corresponding discretisation .      with regard to the discretisaion of the steady state form of the energy - loss transport equation given in eq .",
    "( [ eqpropagationsteadyenloss ] ) we use different approaches for momentum and configuration space .",
    "instead of using a finite difference discretisation we use an integration in momentum space to discretise the momentum part of the problem . in particular , to find the solution at momentum @xmath10 we integrate eq .",
    "( [ eqpropagationsteadyenloss ] ) from @xmath10 to @xmath11 resulting in : @xmath12 here the integral on the right hand side is now evaluated using the trapezoidal rule , leading to a second order accurate representation . with this",
    "we find after some rearrangement : @xmath13 where all terms containing @xmath14 are on the left hand side of the equation .",
    "the right hand side with terms depending on @xmath15 can , thus , be used as a source term , when computing the solution at momentum @xmath10 .",
    "computing the solution at the lower momentum using the one at higher momentum as a source term reflects the fact that we are dealing with losses in momentum space . numerically speaking",
    "this means that we have advection from high to low momenta .",
    "this also hints at the viable form for the boundary conditions in momentum space : it is sufficient to prescribe some value for the cosmic ray distribution function at the highest momentum . for all physically meaningful propagation simulations we will use the assumption that the distribution function is zero at the highest energies .    from this discussion",
    "it is obvious that we can bring eq .",
    "( [ eqsteadyevolugly ] ) into a more convenient form .",
    "when introducing the abbreviations : @xmath16 and @xmath17 we can rewrite eq .",
    "( [ eqsteadyevolugly ] ) as : @xmath18 with this we arrived at a semi - discrete form of eq .",
    "( [ eqpropagationsteadyenloss ] ) where so far only the momentum space is discretised .",
    "differential operators in configuration space are then discretised using finite differences . for example",
    "the spatial diffusion term can be written in cartesian coordinates as : @xmath19 where we assumed the diffusion tensor to be diagonal .",
    "any of these three terms is now discretised in analogy to the example : @xmath20 the diffusion tensor can also contain off - diagonal elements @xmath21 , @xmath22 or @xmath23 , but needs to be symmetric in any case .",
    "in the presence of off - diagonal elements the discrete version of eq . has to be extended by terms of the form : @xmath24 with analogous expressions for the other possible entries .",
    "with this we have a fully discrete form of the steady state transport equation for cosmic rays .",
    "the resulting discretisation yields a coupled system of equations for @xmath25 . in this case",
    "the values of @xmath2 at the different grid points are coupled due to the fact that the discretisation of the diffusion operator in eq.([eqsteadyevolnice ] ) at point @xmath26 yields a function of @xmath2 at @xmath26 and at all neighbouring spatial grid - points as well .",
    "insofar we have to deal with an implicit evolution scheme in momentum space . while there might be no efficient direct solver for the corresponding matrix equation available there are still several methods , which can solve such systems efficiently .",
    "for all models computed in this paper we used an a gauss - seidel multigrid solver .    for this solver we explicitly made use of the fact that in momentum space the solution at momentum @xmath10 can be computed using the one at momentum @xmath11 as input",
    "this is possible due to the fact that we are exclusively dealing with momentum losses in the transport equation .",
    "therefore , we are confronted with a coupling of the grid - points in the spatial domain only , accordingly requiring a solver for a three - dimensional instead of a four - dimensional problem . in principle",
    "this approach can also be extended to the case where the cosmic rays are subject to energy gains over the whole computational domain instead of energy losses .",
    "while this may be the case for re - acceleration models , they pose the additional problem that also a diffusion term in momentum space is present , also leading to a coupling to the adjacent cells in momentum space .",
    "this case will be addressed in sec .",
    "[ secreaccscheme ] .      as discussed in the previous section , after discretisation we are facing a coupled system of algebraic equations .",
    "this system can be rewritten in matrix form .",
    "this matrix equation would for one spatial dimension be a tridiagonal matrix .",
    "for such a case there are numerical methods for the direct inversion of the matrix available where the numerical cost is of order @xmath27 . for three - dimensional problems , however , there are no such methods available anymore .",
    "therefore we will in this case rely on an iterative method to solve the system of equations .",
    "there are several such iterative relaxation methods available like , e.g. jacobi or gauss - seidel just to name a few .",
    "these methods , however , suffer from the fact that the relaxation is most efficient for short wavelengths , while long wavelength relaxation takes a large amount of iterations . to remedy this shortcoming",
    "the multigrid method was introduced , which applies grids of different resolution to allow an efficient relaxation at all wavelengths of a problem .",
    "it turns out that multigrid methods can be set up that are also of order @xmath27 with regard to numerical expense .",
    "here we are using gauss - seidel relaxation in a multigrid method .",
    "we included different variations of this method in the code .",
    "the difference is in the order in which the solutions is applied to the different grid - points .",
    "here we are using either so called red - black gauss - seidel or an alternating plane gauss - seidel version ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* for further details ) .",
    "the former of these is faster regarding a single iteration but the latter turns out to need fewer iterations for anisotropic problems like , e.g. , strongly anisotropic source distributions . with this",
    "we can now discuss the implementation of the re - acceleration scheme .      in the presence of re - acceleration",
    "we are confronted with a coupled system of equations in all four dimensions .",
    "this requires a different approach to the discretisation in momentum space and also some extensions to the matrix solver .      for the re - acceleration scheme we use the same discretisation for the spatial derivatives as",
    "was discussed for the energy - loss scheme . for the momentum derivatives , in contrast to the approach described under [ secdiscmomloss ] , we will also use a finite difference discretisation .",
    "we note that the re - acceleration term can be expressed as a combination of a momentum diffusion and an advection term in momentum space that represents an energy gain : @xmath28 with this we find for the momentum advection velocity @xmath29 : @xmath30 this expression shows that the momentum advection velocity may have a different sign at different energies or positions , also reflected in the corresponding discretisation : @xmath31 which is the same as used in the galprop code . at the same time we discretise the diffusion term via : @xmath32 this shows that the discretisation of the transport equation at @xmath33 now also depends on the value of @xmath2 at the two neighbouring points in momentum space .",
    "thus , in this case we are dealing with a four - dimensional matrix problem .      to solve the four - dimensional coupled system of algebraic equations",
    "we apply a four - dimensional extension of the multigrid solver discussed in sec .",
    "[ secmatrixsolve ] .",
    "here we found that a four - dimensional red - black gauss - seidel iteration does not yields satisfactorily convergence rates . in this red - black gauss - seidel approach the solution at a single grid - point is computed using the values of the surrounding grid - points in all four dimensions .",
    "in contrast to that it turns out to be significantly more efficient to compute the solution collectively for all spatial grid - points at the same momentum . for this collective solution of the spatial problem",
    "we use a few iterations of the three - dimensional solution scheme presented in sec .",
    "[ secmatrixsolve ] . at each multigrid level of the four - dimensional multigrid solver",
    "this approach is applied at all grid - points in momentum space . in this",
    "we alternate between the solution at all even and all odd grid - points in momentum .",
    "this is due to the chosen discretisation where , e.g. , the solution at an even grid - point in momentum only depends directly on the solution at the surrounding odd grid - points .",
    "corresponding tests that validate the capabilities of these solvers are given in section [ sectests ] .",
    "we found that both the three - dimensional and the four - dimensional multigrid solver yield a solution after @xmath3410 iterations . with this",
    "the steady state method is significantly faster than any method that attempts to find a steady state solution using a time integration scheme .",
    "even the time integration scheme used within the galprop code that uses ever decreasing timesteps ( see * ? ? ?",
    "* ) is slower than the present steady state algorithm .",
    "this is of particular interest as galprop aims at finding the steady state solution of the propagation problem .",
    "having found a suitable steady state solution is a promising starting point for a time dependant computation with , e.g , time variable sources .",
    "this is also handled by an adapted time integration scheme .",
    "when time dependant parameters ( like , e.g. , a variable source distribution ) are present we have to use the evolution equation eq . instead of eq . . in this case",
    "the only difference is the presence of the time derivative .",
    "this , however , poses no problem in using the same momentum space discretisation as for the previously discussed steady state solvers .",
    "here we begin the discussion again with the energy - loss scheme . at this point",
    "we just repeat the corresponding derivation including the rate of change in time . in applying the momentum space integration to the dynamical problem we find as a first step",
    ": @xmath35 this is so far only discretised in momentum space . as a next step",
    "we therefore perform a similar integration in time . while this would in principle allow different timestep sizes , using such would be highly unusual because commonly the timestep size is determined either from energy loss timescales or particle decay timescales .",
    "these , however , usually do not change with time . using the same second order integral as for the momentum discretisation",
    "we find : @xmath36 where @xmath37 indicates the timestep . here",
    "@xmath38 is the timestep for which all quantities are known and the quantities at @xmath39 are to be computed . from this one",
    "can actually find a very similar evolution scheme as was used for the solution of the steady state problem .",
    "due to the fact that we only consider energy _ loss _ processes in this paper quantities at momentum @xmath10 depend on such at momentum @xmath11 which was already used for the steady state problem .",
    "then the procedure following from the above discretisation is as follows : after having computed @xmath40 we start the computation of @xmath41 . for this",
    "we apply boundary conditions at the highest momentum . for @xmath42 gridpoints in the computational domain of momentum space ( with the range @xmath43 )",
    "we then use the boundary condition at @xmath44 .",
    "then we can compute the solution at @xmath45 from the values at the previous timestep and the boundary values . from the resulting @xmath46",
    "we can then compute @xmath47 and so on .",
    "that means we can easily rearrange eq . in a way that all unknown quantities are on the left hand side .",
    "in particular we find : @xmath48 this equation can actually be brought into the exact same form as the evolution equation for the steady state momentum - loss problem eq . .",
    "the above can be written as : @xmath49 by using the definitions : @xmath50 and @xmath51 this equation can , again , be solved by a discretisation of the diffusion operator and subsequent application of the numerical matrix solver .",
    "for the re - acceleration solver we can use a similar treatment . in this case",
    "we just need to add the time - derivative to the discrete form of the transport equation .",
    "then by an integral over one timestep as discussed above we actually come up with the crank - nicolson discretisation also used in galprop , where all terms at time @xmath38 are used as source terms and we are solving for @xmath41 .",
    "the resulting equation then reads : @xmath52 by combining all terms on the right - hand side into a single source term , and using the substitution : @xmath53 we end up with an equation of the same form as eq . .",
    "this means that we find an equation of the same form as for the steady state problem in both cases .",
    "accordingly , the same numerical solver can be applied to all problems .",
    "the portrayed numerical solver is embedded into a computational framework that supplies all relevant parameters at runtime .",
    "these parameters are in particular the spatial diffusion tensor , the momentum loss rates , the source distribution and the timescales for radioactive and fragmentation decays ( see eq . ) , all of which might vary with spatial position and energy .",
    "furthermore they depend on physical quantities like , e.g. , the gas distribution , nuclear cross sections and intensities of the interstellar radiation fields for which we adopt here the same distributions as in galprop .",
    "additionally we allowed for a spatial variation of the components of the diffusion tensor .",
    "the solver is applied to all nuclei individually which are coupled through radiative decay and fragmentation , where the latter results from an interaction with the interstellar medium .",
    "this means that heavier nuclei can decay into lighter ones , and , consequently , serve as a secondary source for the latter .",
    "therefore the solver is first applied to the heaviest particle with mass - number @xmath54 and charge @xmath55 . in the next step the solver",
    "is applied to the isotope with @xmath56 until the solution for all isotopes of the current element is found",
    ". then the code continues with the element with @xmath57 in the same fashion . in this way",
    "the transport problem for most of those species that can act as a secondary source for the species currently under investigation was already treated earlier .",
    "there are , however , a few exception where species that appear later in the structure of the network can decay into an earlier one .",
    "the most commonly known example is probably the beta - decay of @xmath58 into @xmath59 .",
    "galprop deals with this problem by iterating several times over the full nuclear reaction network , which increases the numerical cost of the code linearly with the number of iterations .",
    "we are using a different approach : first the code determines those elements , which have a secondary source partner earlier in the network . during the computation the solver then just iterates over the range between these two coupled elements instead of an iteration of the whole network . using this numerical scheme",
    "is not only cheaper due to the fact that we avoid the re - computation of the complete reaction network , also the numerical solution of species solved repeatedly in the network iterations becomes significantly faster .",
    "this is due to the fact that the solution at the previous iteration is used as an input , which , however , does not deviate significantly from the final solution anymore .",
    "therefore the picard code is even more efficient when the nuclear reaction network is fully explored .",
    "in this section we will use several simplified forms of the evolution equation eq . to proof the correctness of the different numerical schemes .",
    "all the following tests have an analytical solution , thus , allowing a direct evaluation of the quality of the numerical scheme .",
    "this first test will be used to verify the convergence properties of the solution in momentum space for the energy - loss scheme . for",
    "that we will only take losses and source terms into account and assume that we have a steady state problem . from eq .",
    "( [ eqpropagationsteadyenloss ] ) we see that we are dealing with the equation : @xmath60 at this point we need a specific form for the loss term @xmath6 and for the source term @xmath61 . here",
    "we will just use different power - laws for each .",
    "that is , we will use : @xmath62 where @xmath63 is a reference momentum .",
    "this differential equation can easily be solved by standard methods , where the corresponding analytical solution is : @xmath64 the different constants are chosen in a way that both terms contribute significantly to the resulting spectrum .",
    "first we use the following values for the power - indices : @xmath65 and @xmath66 .",
    "then we have : @xmath67 the different constants used within this test problem might not be physically meaningful , but they will still serve as good examples for testing the solver . with the momentum given in units of @xmath68 mev , we use @xmath69 in order to have a spectral break at about @xmath70 mev .",
    "the test is run on a grid similar to what is eventually used in cosmic ray transport problems .",
    "that is we use a kinetic energy between 10 mev and @xmath71 mev for our test , subdivided into @xmath42 logarithmically spaced cells .",
    "we use this as a test for the momentum discretisation of both the steady - state and the time - dependant version of the solver . for the former test we use eq .",
    "( [ eqsteadyevolugly ] ) where we neglect spatial diffusion and catastrophic losses . with this",
    "we find the algebraic equation : @xmath72 in this case we prescribe the analytical solution at @xmath73 and compute the values at lower momenta successively .    for the time - dependant version we use a very similar procedure .",
    "in this case we keep all relevant terms from eq .",
    ", which results in : @xmath74 where @xmath75 .",
    "in this case the solution depends on the solution at the previous timestep and the one at the current time but at momentum @xmath11 . apart from that we also prescribe the analytical solution at @xmath76 .    for a solution via the steady state method we find that the results are in agreement with the analytical solution and that the method is indeed of second order in momentum as can be seen from fig .",
    "[ figmomtestorder ] , where the relative l2 error is shown as a function of the number of gridcells .",
    "this error is computed as : @xmath77 where @xmath78 is the solution computed by the numerical scheme and @xmath79 is the correct , analytical result .",
    "additionally we show results for a first order version of the steady state solver .",
    "apparently , for a resolution of 100 gridpoints an error in the order of can be expected in that case .",
    "this shows that for a reasonable number of gridpoints in momentum space a second order solver is recommended , for which the error at the given resolution is well below the percent level .",
    "note that we are dealing with a four - dimensional problem , so excessively high numbers of gridpoints are not feasible due to memory constraints .",
    "( 1100,862)(-100,-100 ) ( 330,-70)number of gridpoints ( -70,360 ) relative l2 error for the momentum space test . here",
    "we show the errors as a function of the number of gridpoints for the steady state solver ( red circles for the second order and blue squares for the first order version ) .",
    "results for the time dependant version are identical . for comparison",
    "the black line indicates a slope of -2.,title=\"fig : \" ]    for the test of the time - dependant solver the problem is initialised with @xmath80 everywhere apart from the upper boundary .",
    "then the solver is applied successively until a steady state solution is reached . again , the result is consistent with the analytical solution and the code is of second order as expected .",
    "actually we found that when the steady state solution is reached with the time - dependant solver , the result is identical to the one found using the steady - state solver .",
    "one important aspect , however , became obvious from this test .",
    "when using time integration to find a steady state solution the number of timesteps necessary to reach the solution can be fairly high .",
    "this is due to the fact that the loss term is represented by a power - law in momentum space .",
    "this means that the problem relaxes quickly at highest energies , whereas relaxation at low energies takes much longer .",
    "actually the correct solution is slowly propagated down to the smallest energies .",
    "this problem is somewhat remedied by using the logarithmic grid , but still the number of timesteps necessary to reach a steady state solution can be fairly large .",
    "this has to be kept in mind , whenever trying to reach a steady state using a time integration scheme to solve the energy loss problem in case of significant changes of the loss timescale with energy .",
    "in particular the direct solution via the steady state solver is much more efficient in that regard .      having shown that the solution for the momentum space problem is accurate",
    "we now need to verify the solver for the spatial diffusion problem .",
    "in particular we need to verify that the solver can handle a problem of the form : @xmath81 together with the boundary conditions @xmath82 , typically used for galactic propagation models , it is rather simple to come up with a test problem that has an analytical solution . here",
    "we will just prescribe an analytical solution as : @xmath83 where the numerical domain extents from @xmath84 to @xmath85 in the @xmath86- and @xmath87-direction and from @xmath88 to @xmath89 in the @xmath90-direction . for this",
    "we then find the corresponding source - function that fulfils eq .",
    "( [ eqdiffonly ] ) as : @xmath91 we test the diffusion solver by using this source function within eq .",
    "( [ eqdiffonly ] ) where we initialise @xmath2 as zero everywhere .",
    "the entries of the diffusion tensor are spatially constant with : @xmath92 m@xmath93 s@xmath94 and @xmath95 m@xmath93 s@xmath94 .",
    "this test might appear simplified , but at a closer look the source function is strongly variable and the problem also shows a significant anisotropy in the @xmath90-direction .",
    "tests of this problem show that our numerical solver can very efficiently handle this specific problem .",
    "already for a spatial resolution of 33 gridcells we find a deviation from the analytical solution of @xmath96% . by studying different resolutions like for the previous test we can verify the second order accuracy of the method .",
    "the present problem turns out to be sufficiently anisotropic to demand an alternating plane relaxation technique ( see sec .",
    "[ secmatrixsolve ] ) , for which it converges in just a few iterations .    as another test",
    "we also investigate the case with spatially variable entries of the diffusion tensor .",
    "in particular we use @xmath97 , @xmath98 and @xmath99 .",
    "this problem is obviously significantly anisotropic . using the source term :",
    "@xmath100 actually corresponds to the same analytical solution as before .",
    "also for this case we observe the expected second order convergence . here",
    "the deviation from the analytical solution is somewhat larger with 0.18 % at a spatial resolution of 33 gridpoints in each dimension .",
    "both tests have been verified up to 129 gridpoints in each dimension being equivalent to a spatial resolution of about 0.3 kpc in the @xmath86- and @xmath87-directions and 0.047 kpc in the @xmath90-direction where they show deviations from the analytical solution of @xmath101 for the former of these tests .",
    "this also shows that adequate handling of these high resolutions is indeed possible with the new method .",
    "the most general diffusion test we applied is one including non - zero off - diagonal elements . for this an alternating plane relaxation technique",
    "turns out to be required , too .",
    "we assume that diffusion is dominant along a preferred direction and reduced in perpendicular directions . in this case",
    "this is the cylindrical @xmath102-direction .",
    "that leads to the following form for the diffusion tensor :    @xmath103    where @xmath104 for this case we assume that the diffusion tensor in the local frame relative to the @xmath102 dimension features constant entries , i.e. , we use @xmath105m@xmath93s@xmath94 and @xmath106m@xmath93s@xmath94 . using the same analytical solution as before we find that the source - function needs to fulfill : @xmath107 where we implicitly used that @xmath108 like for the previous tests we computed solutions up to a resolution of 129 gridpoints in each dimension .",
    "the deviations from the analytical solution are similar to the previous tests , where we find in this case an error of 0.13% with 33 gridpoints and a second order reduction of the error with incresing spatial resolution .",
    "this shows that the resulting deviation stems from the discretisation only .",
    "the chosen numerical scheme for the solution of the diffusion problem solves the discrete problem exactly .",
    "we conclude the discussion of analytical tests with one that includes both spatial diffusion and momentum losses , thus being suitable to test both the energy - loss and the re - acceleration steady - state scheme , respectively .",
    "we first apply the test to the energy - loss scheme .",
    "the only term that is neglected in is thus the catastrophic loss term , which represents a simple ode in itself .    to allow for an analytical solution",
    ", we assume that the spatial and the momentum dimension decouple from each other .",
    "that is , we will investigate problems with a solution of the form : @xmath109 for the spatial diffusion we assume the same spatially constant coefficients as for the first test in the previous section .",
    "for this case one can find the solution @xmath110 for a specific derivation of this result see [ secappendanalyt ] .",
    "there also the specific simplifications that are made are discussed in detail .",
    "some of the transport parameters need to be fixed to simplify the solution ; others are still free .",
    "in particular we are using a diffusion tensor , with entries that depend on momentum @xmath111 as : @xmath112 m@xmath93s@xmath94 and @xmath113 m@xmath93s@xmath94 , where @xmath114 .",
    "this is actually in rough agreement with typical values used for galactic cosmic ray propagation . at the same time we use a power - law for the loss term @xmath6 and for the source term @xmath61 as already discussed in sec .",
    "[ sectestmom ] . in the present case",
    ", however , we use the parameters : @xmath115 , @xmath116 , @xmath117 and @xmath118 .",
    "some of these choices help finding an analytical solution , whereas alternative parameters constitute another independent test .",
    "for the spatial extent of the numerical domain we choose @xmath119 kpc and @xmath120 kpc leading to @xmath121 pc@xmath122 or @xmath123 m@xmath122 ( for the specific form of @xmath124 see [ secappendanalyt ] ) .",
    "this test was run with different resolutions in normal and momentum - space .",
    "for this we , again , found second order behaviour as expected for the code .",
    "in particular we found for 33 gridpoints in each of the spatial dimensions and approximately 100 gridpoints in momentum space that the deviation from the analytical solution ( computed via the relative l2 error ) was on the @xmath125 level for the steady state solver .",
    "this finally shows that also the full transport equation is solved efficiently and highly accurately .",
    "( 1100,862)(-100,-100 ) ( 390,-70)@xmath111 [ mev/@xmath126 ( -70,380 )   results for the overall test of the code using the time - dependant version .",
    "results are shown for different times , where we show the converged solution for a time of @xmath127 years.,title=\"fig : \" ]    we also tested the same configuration using the time - dependant solver . in that case",
    "we initialised the cosmic ray distribution function with the analytical value at the highest momentum throughout the whole numerical domain .",
    "this value was used as a boundary condition for the whole simulation run . from this",
    "we also found convergence to the analytical solution .",
    "however , we also found that convergence can take a very long time .",
    "this is depicted in fig .",
    "[ figtestcodetimeconv ] . as expected from the fact that we only consider momentum losses it is obvious that the correct solution is advanced from high to low momenta .",
    "also it is obvious that convergence is taking longer for lower momenta which is due to the fact that the energy loss rate decreases with decreasing momentum .    from fig .",
    "[ figtestcodetimeconv ] one can also see some fluctuations below the momentum , for which the steady state solution has already been reached .",
    "this is due to the steep slope in this region .",
    "such fluctuations can be avoided by using a slope limiter that would suppress such fluctuations .",
    "we also tested a different time - integration scheme using operator splitting . in that case",
    "the momentum losses were handled using a variation of the semi - lagrangian scheme presented in @xcite .",
    "for this , such fluctuations did indeed not occur .",
    "the resulting solver , however , was not as accurate as the one presented here anymore .",
    "also one has to bear in mind that such jumps are not to be expected for a physical application to galactic cosmic ray transport , where we are mostly dealing with smooth power - laws .    in this case",
    "the solution is shown as a function of momentum instead of energy because the analytical solution is also a function of momentum .",
    "in particular the break between the two power - laws is clearly visible in the region around @xmath128 gev/@xmath129 which is determine from the specific choice of @xmath130 in eq .",
    "( [ eqtestfullsolution ] ) .",
    "time is given in units of years , where a single timestep is 100 years .",
    "note , however , that this constitutes only an exemplary test without deep physical meaning .",
    "the important point , however , is the effective number of timesteps , which can readily be deduced from fig .",
    "[ figtestcodetimeconv ] to be in excess of 1000 steps . from a runtime evaluation of the l2-error we find in particular that a steady state solution is reached at about @xmath131 years or 5000 timesteps .    finally , we simulated the same model with the re - acceleration scheme . even though this scheme has been implemented for the solution of cosmic ray transport problems with re - acceleration , it is also applicable to a problem with just energy losses . in this case",
    "we solved the model problem for @xmath42=17 , 33 , 65 gridpoints in each of the four dimensions . while the solver turned out to be indeed suitable for solving this model problem we observed at the same time that the momentum part of the scheme is in contrast to the energy - loss scheme just of first order .",
    "this is due to the discretisation of the momentum loss term in eq .",
    "[ eqmomupwind ] being of first order  as is common in galactic cosmic ray propagation codes like , e.g. , galprop .",
    "this results in an error of a several percent in comparison to the analytical solution at @xmath132 in contrast to an error of a fraction of a percent for the energy - loss solver .",
    "while this might seem problematic at first sight one has to bear three important points in mind .",
    "first , an error of a few percent in energy is a very decent result for cosmic ray transport models .",
    "secondly , in the present test the loss - rate is of critical importance for the solution , while  with the exception of electrons ",
    "the energy losses only have a significant influence at the low energy end of the cosmic ray spectrum .",
    "this is also reflected in the comparison test discussed later . and",
    "third , the cosmic ray distribution function is very smooth in momentum space , thus , not requiring excessively high resolution there .",
    "from these tests we can draw several important conclusions : the code works as expected for the analytical tests presented here .",
    "this is true for both the steady state version and the time - integration version of the code , which yield identical results when the steady state is reached for the time - integrating solver .",
    "when it comes to the decision which solver to use the answer is therefore obvious : whenever interested in a steady state solution the steady state solver is the preferred one .",
    "this is due to the fact that it is significantly faster than a time - integrating solver that also has to check for convergence to a steady state result . for the overall test of the code",
    "the time - integrating scheme obviously needs more than @xmath133 time steps to converge ( at @xmath134 years the results are not converged yet as can be seen in fig .",
    "[ figtestcodetimeconv ] ) .",
    "one also has to keep in mind that for higher resolutions also smaller timesteps are needed , thus , increasing integration time even further . taking into account that the numerical cost of finding the steady state solution is of the same order as the cost of computing a single timestep in the time - integrating version of the solver the steady state solver obviously performs significantly faster in this case .    for time variable problems (",
    "as , e.g , when using variable sources ) the only choice is to use the time - integrating solver , where the steady state solver might be used to find an appropriate initial condition . with this remark we can now discuss a first application of the new code to the galactic cosmic ray transport problem .",
    "in this section we will discuss three particular example scenarios .",
    "first , we will investigate a case that has also been used by @xcite to test the galprop solver with high resolution simulations in three spatial dimensions .",
    "then we will verify the re - acceleration solver by a comparison to galprop simulations for a physically motivated model including re - acceleration and to an energy - loss problem solved with the energy - loss scheme .",
    "finally , we will investigate the galactic cosmic ray propagation problem for electrons and protons considering the effect of a time variable source .      in the first model we investigate an azimuthally symmetric problem for galactic cosmic ray proton propagation as it was introduced in @xcite .",
    "in this model we use a simulation domain with the extent @xmath135 kpc and @xmath136 kpc . in momentum space",
    "we use a logarithmic grid for kinetic energy in the range @xmath137mev , which is discretised using the same number of gridpoints as for each spatial dimension . in this case",
    "the upper boundary in momentum space is significantly higher than in @xcite where the current choice is motivated by the boundary conditions at the highest energies . due to the fact that we are dealing exclusively with energy loss processes in momentum space we have an inflow boundary there .",
    "such a boundary can easily lead to numerical instabilities .",
    "therefore we use the assumption that the cosmic ray density above @xmath71mev is negligible , which yields the numerically stable boundary condition @xmath138 .    in these simulations",
    "we focus on the propagation of galactic cosmic ray protons , where simulations with different resolutions were run to check for convergence of the results .",
    "results are compared to computations using galprop with the same parameters .",
    "here we compare simulations with @xmath139 where @xmath42 is the number of gridpoints in each dimension including the momentum dimension .",
    "for galprop we did non run the simulations with @xmath140 due to excessive memory demand and long computation time .",
    "for @xmath132 we found the steady state solver presented here to be more than a factor of ten faster than the equivalent simulation with the galprop solver .",
    "( 1100,866)(-100,-100 ) ( 420,-70)@xmath141 [ mev ] ( -70,320 ) proton spectrum at the galactic centre for different resolutions as indicated in the figure .",
    "solutions were computed with the steady state solver .",
    "results are given in arbitrary units.,title=\"fig : \" ]    convergence of the results was studied by a comparison to the simulation with @xmath140 .",
    "we found that the quality of the result for this simulation is similar for the new solver and the galprop solver .",
    "the different runs computed with the steady state solver are compared in fig .",
    "[ figconvnew ] , where the flux at the position of the galactic centre is shown as computed by the solver .",
    "results are given in non - normalised form .",
    "to compute values that can be compared with experimental data results are usually normalised .",
    "for this the numerical data are rescaled so that the flux is identical to the observed one at the position of earth at a specific energy ( typically around 100  gev ) .",
    "when the position of earth does not coincide with a numerical gridpoint an interpolation procedure is used for the normalisation .",
    "this , however , might have an influence on the estimate of the quality of the convergence , because the position of earth relative to the nearest gridpoint might change with changing spatial resolution .",
    "the deviations are on the order of 10% for a resolution of @xmath142 and of the order of a few percent for @xmath132 for the new solver .",
    "when comparing the normalised values the deviation turns out to be about twice as large . for the galprop",
    "run we only compared the @xmath142 to the @xmath132 which show about the same deviation as for the new solver .",
    "a comparison between the two solvers also shows good agreement , within a few percent deviation .",
    "this reflect the fact that the deviations are just due to the discretisation error of the methods , which is similar in both cases .",
    "this shows that the results obtained using the solver presented here are indeed sufficiently accurate to be applied to actual physical problems .",
    "the new quality of this solver can be described two - fold : it does not need any tests of the convergence criteria to be studied , while being more than a factor of 10 faster than the galprop solver .",
    "finally the present solver has also been written in a fully mpi parallel way , thus , making use also of distributed memory machines , advantageous for very high resolution simulations .",
    "yet another verification of the re - acceleration solver is investigated using two different simulations , for which we compare results by the re - acceleration solver to those from the energy - loss scheme and those computed using the galprop code , respectively .",
    "we considered two different standard galprop simulation setups described in @xcite .",
    "as a first test we chose model z04lmpds , which is a setup without re - acceleration , where only protons and electrons are considered . in this case",
    "we compared simulations with both the energy - loss and the re - acceleration steady state scheme .",
    "both simulations are in fairly good agreement with a relative l2-deviation of the proton spectrum at earth of 16% at @xmath142 and 8% at @xmath132 with @xmath42 the number of gridpoints in each dimension . in this case",
    "we only observe deviations above the percent level below energies of about 2gev , which is likely due to the fact that energy losses become increasingly important for low energy protons only .",
    "this localisation of the deviation becomes also apparent , when computing the deviation using the l1-norm @xmath143 instead : @xmath144 where we used the solution obtained using the energy - loss scheme as reference solution @xmath145 . in this case",
    "we find that @xmath146% for @xmath142 and @xmath147% for @xmath132 .",
    "taking into account that the l2-deviation puts more weight on localised errors especially at low energies it becomes apparent that we have a very good agreement .    for electrons we found somewhat larger deviations , as expected from the larger impact of energy losses .",
    "in this case we determined errors of @xmath148% , @xmath149% , @xmath150% and @xmath151% .",
    "these errors reflect the observation also drawn from a visual inspection of the spectra that we see some deviation at all energies with larger differences towards high energies .",
    "this indeed supports the idea that the results deviate most strongly , where energy losses become relevant .",
    "taking into account that the discretisation in both schemes are quite different the agreement is fairly good . in particular the decrease of the error for higher resolution shows that both schemes converge towards the same solution .",
    "additionally , we found for this test that the energy - loss solver is about a factor of 3 faster than the re - acceleration solver .    as the second example we used model z04lms , taking only protons into account , to compare the results of a simulation with re - acceleration to the corresponding results found using the galprop code .",
    "in this case we find for @xmath142 a relative l2 deviation of the proton spectrum at earth of about 5,8% , while at @xmath132 we find a deviation of about 1.9% . in this case",
    "the l1 deviation is with @xmath152% and @xmath153% very similar to the l2 deviation showing that the error is not localised to a specific energy range in this case .",
    "this was to be expected due to the fact that the discretisation of the energy loss terms is of first order in both cases .",
    "this shows that the picard code yields reliable results very efficiently also in the presence of re - acceleration . in the final test",
    "we apply the energy loss scheme to a dynamical problem involving electrons and protons .",
    "in the final test we apply the new energy - loss solver to a specific galactic propagation problem . for this",
    "we used the same parameters as in @xcite , where the simulation domain extents from -20 to 20 kpc in the @xmath154 plane and from -4 to 4 perpendicular to the galactic plane .",
    "all other parameters can be found in table 1 of @xcite .",
    "( 1143,1100)(-100,-100 ) ( 470,-70)@xmath86 [ kpc ] ( -70,420 )        ( 1217,1118)(0,-100 ) ( 470,-70)@xmath86 [ kpc ]     as a difference we presently only consider electrons and protons . at the same time we did the simulation in three spatial dimensions instead of using an azimuthally symmetric setup .",
    "this was done for two reasons .",
    "first we want to show the capability of the new scheme to recover the azimuthal symmetry using a cartesian 3d spatial grid .",
    "secondly we included a dynamical source in the vicinity of earth at coordinates @xmath155 in units of kpc ( where earth is located at @xmath156 kpc ) .",
    "this source is switched on 100 years after the start of the simulation and is active for @xmath157 years . by this we of course brake the azimuthal symmetry of the setup , thus , forbidding a spatial 2d simulation .    for this simulation",
    "we first computed the steady state solution and then switched on the time integration scheme using the steady state solution as initial condition . in fig .",
    "[ figprotondist ] we show the initial spatial distribution of galactic cosmic ray protons in the galactic plane on the left hand side . in this fig .",
    "all cells are shown individually , each with constant colour .",
    "the high resolution is apparent from the fig .",
    ", where we used a cell size of only 0.156 kpc in the @xmath86-@xmath87-plane .",
    "also the results show indeed the azimuthal symmetry expected from the azimuthally symmetric source distribution .",
    "( 1143,1100)(-100,-100 ) ( 470,-70)@xmath86 [ kpc ] ( -70,420 )        ( 1217,1118)(0,-100 ) ( 470,-70)@xmath86 [ kpc ]     in the same fig .",
    "we also show the result in the presence of the additional source , which is clearly visible as the localised peak .",
    "these results are shown at a time of @xmath158 years near the end of the active phase of the additional source . for protons , however , the effect of the localised source is rather weak resulting in a local increase of the cosmic ray density at @xmath159  tev of about 13.5% . for electrons",
    "this effect is much more pronounced and is still relevant at significantly lower energies as expected ( see , e.g. * ? ? ?",
    "* ) .    in fig .",
    "[ figelecdist ] we show the electron distribution at @xmath160  tev at the same times as used in fig .",
    "[ figprotondist ] .",
    "obviously the source has a much higher impact for electrons at an even lower energy than in the proton case .",
    "in particular we find a local increase of @xmath3490% for the electron flux here , which becomes even higher for higher energies .",
    "( 1172,1100)(-100,0 ) ( -70,420 )        ( 1192,1000)(0,0 )      +   +    ( 1313,1100)(-100,-100 ) ( 460,-70)@xmath86 [ kpc ] ( -70,420 )        ( 1213,1100)(0,-100 ) ( 460,-70)@xmath86 [ kpc ]     for electrons one can now investigate the dynamics of the source by comparing the flux at different times .",
    "this is shown in fig .",
    "[ figelecdistevol ] where the residual is plotted for different times . here",
    "the residual is computed from the comparison with the result at @xmath161 , where no additional source was present .",
    "results are shown at the end of the active phase of the source and at @xmath157 , @xmath162 and @xmath163 years after the disappearance of the additional source . what is obvious from these figs .",
    "is that the effect of the source disappears from a combination of energy losses and spatial diffusion .",
    "the latter in particular is readily visible from the plots by the ever larger region affected by the source .",
    "note , however , that at @xmath164 years the effect could not be detected anymore , because the residual even at the position of the sources approaches the 1% level .",
    "( 1100,861)(-100,-100 ) ( 380,-70)@xmath141 [ mev ] ( -90,240 ) evolution of the electron spectrum for the active phase of the source at the position of the source.,title=\"fig : \" ]    ( 1100,861)(-100,-100 ) ( 380,-70)@xmath141 [ mev ] ( -90,240 ) same as fig .",
    "[ figelecspecevol_active ] also showing the phase after the disappearance of the source.,title=\"fig : \" ]    this decay can also be visualised by looking at the electron spectrum at the position of the source shown in figs .",
    "[ figelecspecevol_active ] and [ figelecspecevol_off ] . in fig .",
    "[ figelecspecevol_active ] we show the evolution of the spectrum for the active phase of the source . for high energies quickly a new equilibrium between losses and the additional source strength is achieved .",
    "this can be seen from the re - appearance of the same spectral power - law as without the source at a higher flux level .",
    "this re - appearance of the power - low continues to lower energies for increased lifetimes of the source .    in fig .",
    "[ figelecspecevol_off ] we show the evolution of the spectrum after the source became inactive .",
    "apparently , the spectrum decays back to the undisturbed form most quickly for high energies again .",
    "thus , the imprint of the previous source is longer visible at lower energies . at energies below approximately 1  tev the effect of the source",
    "can hardly be observed . in the present case",
    "the effect of the local source is most obvious at energies above @xmath3410  tev .",
    "we re - ran the simulation for 5-times higher source strength , however , for which we found the spectrum to be affected at lower energies .",
    "here we introduced a new code for the numerical solution for the galactic cosmic ray propagation problem .",
    "the code was presented in detail in conjunction with tests validating the numerical scheme for documenting the capabilities of the code . in particular , the picard code can compute a steady state solution for the propagation problem without any adjustments of numerical parameters by the user . at the same time the code is significantly faster than , e.g. the galprop code .",
    "we used the code for an initial physical application , where we investigated the evolution of a localised cosmic ray source on the proton and electron distributions .",
    "we find that , as expected , a significant impact for electrons and only a minor effect for the proton distribution .",
    "this also shows the applicability of the new solver to relevant physical problems .",
    "in particular the simulation was run with a spatial resolution of @xmath340.15 kpc in a fully 3d setup .",
    "this is a genuine quality to the simulation of galactic cosmic ray propagation , warranted and necessitated by the ever improving quality of observational data .",
    "such high resolutions allow for an investigation of localised sources and 3d structures in the matter distribution , magnetic fields or radiation fields in our galaxy .",
    "this seems to be a very timely development for transferring cosmic ray propagation into a full 3d scenario ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "i would like to thank o. reimer , m. werner , a. ostermann , p. csoms , k. reitberger and k. egberts for helpful discussions and valuable suggestions . additionally , a.  w.  strong helped with useful ideas and important insights into propagation physics .    21 natexlab#1#1url # 1`#1`urlprefix    , m. , ajello , m. , atwood , w.  b. , baldini , l. , ballet , j. , barbiellini , g. , bastieri , d. , bechtol , k. , bellazzini , r. , berenji , b. , blandford , r.  d. , bloom , e.  d. , bonamente , e. , borgland , a.  w. , brandt , t.  j. , bregeon , j. , brigida , m. , bruel , p. , buehler , r. , buson , s. , caliandro , g.  a. , cameron , r.  a. , caraveo , p.  a. , cavazzuti , e. , cecchi , c. , charles , e. , chekhtman , a. , chiang , j. , ciprini , s. , claus , r. , cohen - tanugi , j. , conrad , j. , cutini , s. , de angelis , a. , de palma , f. , dermer , c.  d. , digel , s.  w. , silva , e.  d.  c.  e. , drell , p.  s. , drlica - wagner , a. , falletti , l. , favuzzi , c. , fegan , s.  j. , ferrara , e.  c. , focke , w.  b. , fortin , p. , fukazawa , y. , funk , s. , fusco , p. , gaggero , d. , gargano , f. , germani , s. , giglietto , n. , giordano , f. , giroletti , m. , glanzman , t. , godfrey , g. , grove , j.  e. , guiriec , s. , gustafsson , m. , hadasch , d. , hanabata , y. , harding , a.  k. , hayashida , m. , hays , e. , horan , d. , hou , x. , hughes , r.  e. , jhannesson , g. , johnson , a.  s. , johnson , r.  p. , kamae , t. , katagiri , h. , kataoka , j. , kndlseder , j. , kuss , m. , lande , j. , latronico , l. , lee , s .- h . , lemoine - goumard , m. , longo , f. , loparco , f. , lott , b. , lovellette , m.  n. , lubrano , p. , mazziotta , m.  n. , mcenery , j.  e. , michelson , p.  f. , mitthumsiri , w. , mizuno , t. , monte , c. , monzani , m.  e. , morselli , a. , moskalenko , i.  v. , murgia , s. , naumann - godo , m. , norris , j.  p. , nuss , e. , ohsugi , t. , okumura , a. , omodei , n. , orlando , e. , ormes , j.  f. , paneque , d. , panetta , j.  h. , parent , d. , pesce - rollins , m. , pierbattista , m. , piron , f. , pivato , g. , porter , t.  a. , rain , s. , rando , r. , razzano , m. , razzaque , s. , reimer , a. , reimer , o. , sadrozinski , h.  f .- w . ,",
    "sgr , c. , siskind , e.  j. , spandre , g. , spinelli , p. , strong , a.  w. , suson , d.  j. , takahashi , h. , tanaka , t. , thayer , j.  g. , thayer , j.  b. , thompson , d.  j. , tibaldo , l. , tinivella , m. , torres , d.  f. , tosti , g. , troja , e. , usher , t.  l. , vandenbroucke , j. , vasileiou , v. , vianello , g. , vitale , v. , waite , a.  p. , wang , p. , winer , b.  l. , wood , k.  s. , wood , m. , yang , z. , ziegler , m. , zimmer , s. , may 2012 .",
    "fermi - lat observations of the diffuse @xmath165-ray emission : implications for cosmic rays and the interstellar medium .",
    "750 , 3 .    , o. , barbarino , g.  c. , bazilevskaya , g.  a. , bellotti , r. , boezio , m. , bogomolov , e.  a. , bonechi , l. , bongi , m. , bonvicini , v. , borisov , s. , bottai , s. , bruno , a. , cafagna , f. , campana , d. , carbone , r. , carlson , p. , casolino , m. , castellini , g. , consiglio , l. , de pascale , m.  p. , de santis , c. , de simone , n. , di felice , v. , galper , a.  m. , gillard , w. , grishantseva , l. , jerse , g. , karelin , a.  v. , koldashov , s.  v. , krutkov , s.  y. , kvashnin , a.  n. , leonov , a. , malakhov , v. , malvezzi , v. , marcelli , l. , mayorov , a.  g. , menn , w. , mikhailov , v.  v. , mocchiutti , e. , monaco , a. , mori , n. , nikonov , n. , osteria , g. , palma , f. , papini , p. , pearce , m. , picozza , p. , pizzolotto , c. , ricci , m. , ricciarini , s.  b. , rossetto , l. , sarkar , r. , simon , m. , sparvoli , r. , spillantini , p. , stozhkov , y.  i. , vacchi , a. , vannuccini , e. , vasilyev , g. , voronov , s.  a. , yurkin , y.  t. , wu , j. , zampa , g. , zampa , n. , zverev , v.  g. , apr .",
    "pamela measurements of cosmic - ray proton and helium spectra .",
    "science 332 , 69.    adriani , o. , barbarino , g.  c. , bazilevskaya , g.  a. , bellotti , r. , boezio , m. , bogomolov , e.  a. , bongi , m. , bonvicini , v. , borisov , s. , bottai , s. , bruno , a. , cafagna , f. , campana , d. , carbone , r. , carlson , p. , casolino , m. , castellini , g. , consiglio , l. , de  pascale , m.  p. , de  santis , c. , de  simone , n. , di  felice , v. , galper , a.  m. , gillard , w. , grishantseva , l. , jerse , g. , karelin , a.  v. , koldashov , s.  v. , krutkov , s.  y. , kvashnin , a.  n. , leonov , a. , malakhov , v. , malvezzi , v. , marcelli , l. , mayorov , a.  g. , menn , w. , mikhailov , v.  v. , mocchiutti , e. , monaco , a. , mori , n. , nikonov , n. , osteria , g. , palma , f. , papini , p. , pearce , m. , picozza , p. , pizzolotto , c. , ricci , m. , ricciarini , s.  b. , rossetto , l. , sarkar , r. , simon , m. , sparvoli , r. , spillantini , p. , stochaj , s.  j. , stockton , j.  c. , stozhkov , y.  i. , vacchi , a. , vannuccini , e. , vasilyev , g. , voronov , s.  a. , wu , j. , yurkin , y.  t. , zampa , g. , zampa , n. , zverev , v.  g. , may 2011 .",
    "cosmic - ray electron flux measured by the pamela experiment between 1 and 625  gev .",
    "106 , 201101 .",
    "http://link.aps.org/doi/10.1103/physrevlett.106.201101    , c. , gaggero , d. , grasso , d. , maccione , l. , oct .",
    "cosmic ray nuclei , antiprotons and gamma rays in the galaxy : a new diffusion model .",
    "10 , 18 .    ,",
    "d. , maccione , l. , di bernardo , g. , evoli , c. , grasso , d. , jul .",
    "three - dimensional model of cosmic - ray lepton propagation reproduces data from the alpha magnetic spectrometer on the international space station .",
    "physical review letters 111  ( 2 ) , 021102 .    , d. , maccione , l. , di bernardo , g. , evoli , c. , grasso , d. , jun . 2013 .",
    "three dimensional modeling of cr propagation .",
    "arxiv e - prints .    , g. , moskalenko , i. , porter , t. , 2013 . toward 3d mapping of the interstellar medium in the milky way :",
    "impact on cosmic rays and diffuse emission .",
    "proceedings of the 33rd international cosmic ray conference .    ,",
    "r. , werner , m. , egberts , k. , reimer , o. , csoms , p. , ostermann , a. , dec .",
    "physics and parameters in galactic cr transport models . in : aharonian ,",
    "f.  a. , hofmann , w. , rieger , f.  m. ( eds . ) , american institute of physics conference series .",
    "1505 of american institute of physics conference series .",
    ". 450453 .    , r.  a. , yanasak , n.  e. , wiedenbeck , m.  e. , davis , a.  j. , binns , w.  r. , christian , e.  r. , cummings , a.  c. , hink , p.  l. , leske , r.  a. , niebur , s.  m. , stone , e.  c. , von rosenvinge , t.  t. , oct .",
    "radioactive clocks and cosmic - ray transport in the galaxy .",
    "99 , 2739 .    ,",
    "m. , esposito , j.  a. , nov .",
    "1998 . electron acceleration in supernova remnants and diffuse gamma rays above 1 gev .",
    "507 , 327338 .",
    ", a. , derome , l. , maurin , d. , jun .",
    "a markov chain monte carlo technique to sample transport and source parameters of galactic cosmic rays .",
    "results for the diffusion model combining b / c and radioactive nuclei .",
    "516 , a66 + .",
    ", t. , motoki , m. , matsumoto , h. , seo , e.  s. , wang , j.  z. , abe , k. , anraku , k. , asaoka , y. , fujikawa , m. , imori , m. , maeno , t. , makida , y. , matsui , n. , matsunaga , h. , mitchell , j. , mitsui , t. , moiseev , a. , nishimura , j. , nozaki , m. , orito , s. , ormes , j. , saeki , t. , sasaki , m. , shikaze , y. , sonoda , t. , streitmatter , r. , suzuki , j. , tanaka , k. , ueda , i. , yajima , n. , yamagami , t. , yamamoto , a. , yoshida , t. , yoshimura , k. , dec . 2000 .",
    "precise measurement of cosmic - ray proton and helium spectra with the bess spectrometer .",
    "545 , 11351142 .",
    ", a.  w. , moskalenko , i.  v. , dec . 1998 .",
    "propagation of cosmic - ray nucleons in the galaxy .",
    "509 , 212228 .    , a.  w. , moskalenko , i.  v. , porter , t.  a. , jhannesson , g. , orlando , e. , digel , s.  w. , vladimirov , a.  e. , 2011 .",
    "galprop version 54 : explanatory supplement .",
    "url : http://galprop.stanford.edu/code.php?option=manual .    , a.  w. , moskalenko , i.  v. , ptuskin , v.  s. , nov . 2007 .",
    "cosmic - ray propagation and interactions in the galaxy . annual review of nuclear and particle science 57 , 285327 .",
    ", a.  w. , porter , t.  a. , digel , s.  w. , jhannesson , g. , martin , p. , moskalenko , i.  v. , murphy , e.  j. , orlando , e. , oct .",
    "global cosmic - ray - related luminosity and energy budget of the milky way .",
    "722 , l58l63 .",
    ", a.  w. , youssefi , g. , 1995 .",
    "propagation models for cr nucleons and electrons and predictions of the galactic gamma - ray spectrum . in : international cosmic ray conference .",
    "vol .  3 of international cosmic ray conference .",
    "p.  48 .",
    "thole , c .- a .",
    ", trottenberg , u. , 1986 .",
    "basic smoothing procedures for the multigrid treatment of elliptic 3d operators . applied mathematics and computation 19  ( 14 ) , 333  345 .",
    "http://www.sciencedirect.com / science / article / pii/009630% 0386901128[http://www.sciencedirect.com / science / article / pii/009630% 0386901128 ]    , u. , , ooosterlee , c.  w. , schller , a. , 2001 .",
    "multigrid . academic press , inc . ,",
    "orlando , fl , usa .    , m. , kissmann , r. , strong , a.  w. , reimer , o. , aug .",
    "2013 . a new 3d transport and radiation code for galactic cosmic rays .",
    "arxiv e - prints .",
    "zerroukat , m. , wood , n. , staniforth , a. , 2006 . the parabolic spline method ( psm ) for conservative transport problems .",
    "international journal for numerical methods in fluids 51  ( 11 ) , 12971318 .",
    "here we will derive the analytical solution for the test case used in sec .",
    "[ sectestoverall ] .",
    "in particular we are looking for an analytical solution to eq .",
    "( [ eqpropagationsteadyenloss ] ) where only catastrophic losses are neglected .",
    "this is of course done to help finding an analytical solution , but at the same time this is not a severe limitation due to the fact that other terms of the same form will still contribute in the end .",
    "the pde we are working with , is thus : @xmath166 for this there is of course no general analytical solution for three spatial dimensions available .",
    "so some simplifications will be necessary .",
    "first we assume that all space and the momentum dimension decouple from each other .",
    "that is , we will only investigate problems with a solution of the form : @xmath167 apart from the decoupling of the solution we will also assume that the source term @xmath168 decouples into a spatial and a momentum part , where the spatial part is just given by the spatial part of the solution : @xmath169 this is actually the same approach as was used in the first test in sec .",
    "[ sectestdiff ] .",
    "just like in that test we will also neglect a spatial variation of the components of the the diffusion tensor .",
    "so these components are only allowed to depend on momentum of the particle .",
    "in particular we will assume the same momentum dependence for all components .",
    "that is we can write : @xmath170 where all entries of @xmath171 are constant .",
    "when inserting this together with the separation ansatz into the transport equation we find : @xmath172 dividing this result by @xmath173 we can decouple the spatial part of the pde and the momentum part of the pde , where we find after some rearrangement : @xmath174 here we assumed that the energy loss rate @xmath6 does not to depend on spatial position .",
    "thus both sides of the equation need to be constant because they are identical while depending on different variables .    for the spatial diffusion we use the solution used before : @xmath175 from this solution we can find the constant @xmath130 to be",
    ": @xmath176 this can now be used to solve the momentum part of the equation .",
    "that is we have to deal with the differential equation : @xmath177 for the momentum losses we choose the same general form as in sec .",
    "[ sectestmom ] . for the energy dependence of the components of the diffusion tensor we use @xmath178 .",
    "now we first compute the solution to the homogeneous problem in momentum space .",
    "the corresponding ode is : @xmath179 the solution to this is @xmath180 where @xmath37 is the power - law index of the energy loss term .",
    "now we need to address the full equation , i.e. , we need to find a particular solution . for the momentum source term we , again , use the same form as in sec [ sectestmom ] .",
    "some rearrangement then gives : @xmath181 this obviously can not easily be solved , when desiring a somewhat general source - terms .",
    "in the present case , it is sufficient , however , to find a special solution as our analytical test - case . for this",
    "we use the specific choice @xmath182 . with this the homogeneous solution of eq .",
    "( [ eqappinhom ] ) computed above simplifies significantly and we find it to be a constant power - law @xmath183 this , however , can also be integrated to find the inhomogeneous solution . in this particular case",
    "we find for the particular solution : @xmath184 thus yielding for the overall solution : @xmath185 this solution and the corresponding parameters are still sufficiently complex to be a good test to the numerical framework .",
    "the overall solution to be compared to the simulation results is @xmath186 ."
  ],
  "abstract_text": [
    "<S> in this manuscript we present a new approach for the numerical solution of the galactic cosmic ray propagation problem . </S>",
    "<S> we introduce a method using advanced contemporary numerical algorithms while retaining the general complexity of other established codes . in this paper </S>",
    "<S> we present the underlying numerical scheme in conjunction with tests showing the correctness of the scheme . </S>",
    "<S> finally we show the solution of a first example propagation problem using the new code to show its applicability to galactic cosmic ray propagation .    </S>",
    "<S> cosmic rays , methods : numerical , diffusion </S>"
  ]
}