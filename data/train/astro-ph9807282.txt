{
  "article_text": [
    "according to current thinking , the epoch of hydrogen reionization begins with the formation of the first massive stars in subgalactic objects at high redshifts @xmath0 ( e.g. , couchman & rees 1986 ; gnedin & ostriker 1997 ; haiman & loeb 1997 ) and is essentially complete by @xmath1 as required by the gunn - peterson test .",
    "due to its higher ionization threshold and lower photoionization rate , helium reionization may be delayed to @xmath2 or less ( meiksin & madau 1993 ; reimers et al .",
    "the essential reason for this delay is that it is not until @xmath3 that the spectrum of the uv background has hardened sufficiently due the rising quasar population .",
    "reionization has been studied in a spatially averaged fashion by many authors ( e.g , shapiro & giroux 1987 ; miralda - escud & ostriker 1990 , 1992 ; meiksin & madau 1993 ; giroux & shapiro 1996 ; haiman ( these proccedings , and references therein . ) these studies reinforce shapiro & giroux s conclusion that quasars are insufficient to reionize the universe at @xmath4 as required by the gunn - peterson measurement .",
    "( for a discussion of the uncertainties involved , see meiksin & madau 1993 . ) barring exotica , such as decaying neutrinos , that leaves only stellar sources of reionization at higher redshifts .",
    "these stars will inevitably form in highly localized regions of space ( i.e. , galaxies . ) thus , cosmic reionization is intrinsically highly inhomogeneous .    in this short contribution",
    ", we outline our intended approach to numerically simulate _",
    "inhomogeneous reionization _ in three spatial dimensions .",
    "we seek efficient numerical methods for evolving the ionizing radiation field in 3d which we may couple to hydrodynamic models of structure formation ( e.g. , abel , bryan & norman , these proceedings . )",
    "we warn the reader that at this time , we have not proven that our method will be sufficiently accurate and robust to meet our goal , nor do we have any measurements of the computational cost .",
    "immediately after the first photoionizing sources turn on , one has a collection of isolated ionization zones ( essentially hii regions ) growing in an inhomogeneous , expanding universe .",
    "their number and evolution will depend on the source population , ionizing fluxes , and ambient conditions . until the hii regions begin to interact ( percolation ) , they can be solved as isolated cases . the homogeneous case has been solved by shapiro ( 1986 ) for the case of quasar reionization . with no inhomogeneities to spoil spherical symmetry or emit appreciable ionizing recombination radiation , one can reduce the problem to an ode for the radius of the i - front versus redshift .",
    "one avoids solving the radiative transfer equation by simply attenuating the ionizing flux by the @xmath5 geometrical factor and volumetric losses due to recombination to atomic levels @xmath6 .",
    "the peculiar velocity of the i - front is set by balancing , in the rest frame of the i - front , outgoing ionizing photons and incoming neutrals . with these approximations",
    ", shapiro found that for typical quasar luminosities , the i - front always expands supersonically with respect to both neutral and ionized media .",
    "such i - fronts are known as weak r - type i - fronts ( cf .",
    "spitzer 1978 ) .",
    "thus hydrodynamic motions are unimportant , justifying their neglect _ a posteriori_.",
    "secondly , he found that the i - fronts never reach their equilibrium strmgren radii in a hubble time , although they do overlap completely by @xmath7 ( but not by @xmath8 ) for the observed number density of quasars .",
    "this is simply because the recombination time , which enters in the definition of the strmgren radius , is longer than the hubble time , and consequently the strmgren radius is very large .",
    "the evolution of an hii region in an inhomogeneous medium ( expanding or otherwise ) in 3d is an unsolved problem  one that requires more powerful numerical methods to solve in the general case .",
    "the principal complication is that localized density enhancements will both absorb the primary ionizing flux ( shadowing ) , and isotropically emit ionizing radiation via recombinations to the ground state ( diffuse radiation . ) as a consequence , the ionizing radiation field becomes inhomogeneous and anisotropic .",
    "the presence of density enhancements ( clouds ) retard the expansion of the i - front relative to the homogenous case due to enhanced down - conversion of ionizing photons into non - ionizing balmer continuum photons .",
    "when the areal covering factor of opaque clouds approaches one , the i - front will become starved of ionizing photons and stop expanding .",
    "well before this limit is reached , hydrodynamics will become important for two reasons .",
    "first , dense clouds inside the hii region will be photo - evaporated , leading to peculiar velocities of order the thermal sound speed @xmath9 ( see shapiro , these proceedings . ) secondly , when the i - front expansion rate falls below the sound speed in the hii region , it makes a transition to a weak d - type front ( cf .",
    "yorke 1986 ) .",
    "when this occurs , the pressure difference between the ionized gas and the neutral gas drives a shock wave into the ambient medium .",
    "the subsequent expansion of the hii region is due to a combination of hydrodynamic and radiative effects .",
    "a shell of material is accumulated between the inner i - front and the outer shock front , which separate from one another .",
    "the complexities of the percolation phase depend on whether hydrodynamic effects are imporant or not .",
    "that in turn depends on the presence of density inhomogeneities and whether the isolated hii regions become weak d - type before or after overlap .",
    "shapiro & giroux ( 1987 ) modeled the effects of density inhomogeneities on quasar - driven i - fronts phenomenologically by adding a clumping factor to the shapiro ( 1986 ) formalism . physically , these clumps correspond to the @xmath10 forest and lyman limit systems .",
    "meiksin & madau ( 1993 ) calculate that the clouds may absorb as much as @xmath11 of the uv radiation from point sources .",
    "consequently , the clouds are a substantial diffuse source of ionizing radiation ( haardt & madau 1996 . )",
    "shapiro & giroux ( 1987 ) showed that although the enhanced recombinations increase the uv background deficit relative to observed qso source population , i - fronts remain supersonic ( globally ) until full overlap is achieved .",
    "however , if quasars fade , or if reionization is caused by far more numerous , less luminous stellar uv sources , hydrodynamics will become important as i - fronts become weak d - type as they approach their strmgren radii .",
    "we desire numerical methods which can treat both kinds of circumstances .",
    "the basic elements of our method can be described very simply . in the next section",
    "we provide equations .",
    "we decompose the radiation field into point source and diffuse components : @xmath12 .",
    "the point source radiation field is attenuated along radial rays from each point source in the volume .",
    "every cell is crossed by at least one ray . the number of photoionizations in frequency interval @xmath13 in each ray segment inside a cell is simply related to the decrease in @xmath14 along that segment .",
    "the total number of photoionizations in the cell is the sum over ray segments within the cell .",
    "the diffuse radiation field is computed by solving the angle - integrated moment equations with appropriate eddington factor closure ( stone , mihalas & norman 1992 ) . in the limit of small ( compared to the horizon ) volumes ,",
    "the zeroth and first moment equations can be simplified and combined into a single nonlinear elliptic equation for @xmath15 .",
    "this elliptic equation is discretized on a 3d cartesian mesh and may be solved using a variety of techniques , including multigrid relaxation and/or iterative sparse - banded matrix methods .",
    "the equation of cosmological radiative transfer in comoving coordinates ( cosmological , not fluid ) is ( paschos , mihalas & norman 1998 ) :    @xmath16    where @xmath17 is the monochromatic specific intensity of the radiation field , @xmath18 is a unit vector along the direction of propagation of the ray ; @xmath19 is the ( time - dependent ) hubble constant , and @xmath20 is the ratio of cosmic scale factors between photon emission at frequency @xmath21 and the present time t. the remaining variables have their traditional meanings ( e.g , mihalas 1978 . )",
    "equation ( 1 ) will be recognized as the standard equation of radiative transfer with two modifications : the denominator @xmath22 in the second term , which accounts for the changes in path length along the ray due to cosmic expansion , and the third term , which accounts for cosmological redshift and dilution .    in principle",
    ", one could solve equation ( 1 ) directly for the intensity at every point given @xmath23 and @xmath24 .",
    "however the high dimensionality of the problem ( three positions , two angles , one frequency and time ) not to mention the high spatial and angular resolution needed in cosmological simulations make this approach impractical for dynamic computations",
    ". therefore we proceed through a sequence of well - motivated approximations which reduce the complexity to a tractable level .",
    "we begin by eliminating the cosmological terms and factors .",
    "that we can do this can be understood on simple physical grounds . before the universe is reionized , it is opaque to h and he lyman continuum photons .",
    "consequently , ionizing sources are local to scales of interest , and not at cosmological distances .",
    "if our simulation box is of side length l and @xmath25 is the photon mean free path , then by construction @xmath26 .",
    "the ratio of the third to the second terms in equation ( 1 ) is @xmath27 , and hence the third term can safely be ignored .",
    "now , let us consider the factor @xmath22 in equation ( 1 ) . for a photon which is emitted at time",
    "t on one side of the box and absorbed on the other side at time @xmath28 , @xmath29 , where @xmath23 is the logarithmic expansion rate of the universe ( 2/3 for @xmath30 ) and @xmath31 is the hubble horizon scale .",
    "for @xmath32 , and @xmath33 . in practice ,",
    "our dynamical timesteps are much longer than a photon crossing time .",
    "however , even in this case accuracy limits our dynamical timesteps such that @xmath34 , and hence @xmath35 in any given timestep .",
    "therefore , setting @xmath36 , equation ( 1 ) reduces to its standard , non - cosmological form :    @xmath37    where now @xmath21 is the instantaneous , comoving frequency .",
    "now consider the case where @xmath38 , i.e. , the simulation volume is optically thin to ionizing radiation as it would be after reionization .",
    "in that case ionizing sources are are either inside the box ( local ) or outside the box ( nonlocal ) , or both .",
    "local sources are treated as in the case above .",
    "nonlocal sources sufficiently far from the box contribute to a nearly isotropic , homogeneous uv background ( metagalactic flux ) . in this limit ,",
    "equation ( 1 ) can be solved in an angle and spatially averaged fashion , and the cosmological term is not ignorable .",
    "this computation has been done by haardt & madau ( 1996 ) including emission from the observed quasar population , and absorption and re - emission by the @xmath10 forest .",
    "the result of this calculation is @xmath39the mean metagalactic intensity as a function of redshift . if the material in the simulation volume is optically thin everywhere , then the local radiation field is @xmath39 .",
    "current simulations of the @xmath10 forest ( e.g. , zhang et al .",
    "1997 , 1998 ) employ this approximation . if , however , there exist opague regions within the simulation volume  for example , high column density lyman alpha clouds",
    " then @xmath40 no longer equals @xmath39 locally , but must be computed using some approximation to equation ( 1 ) using @xmath39 as a boundary condition . in this case , the cosmological terms are accounted for in the boundary conditions , and for box sizes much smaller than the horizon , ignorable within the box .      while the radiation field due to local point sources is highly anisotropic , the diffuse radiation field should be more nearly isotropic since recombination radiation is emitted isotropically and absorbed by density enhancements which are well resolved on our computational grid .",
    "thus we expect the angular structure in @xmath41 to be well described by its angular moments , the first three of which are defined as follows : @xmath42 .",
    "the radiation energy density , flux , and pressure tensor are related to these moments via the simple relations @xmath43 and @xmath44    now , it is advantageous to work in a frame which is comoving with the fluid because in this frame the emission and absorption coefficients are isotropic ( mihalas & mihalas 1984 ; hereafter mm ) . denoting _ comoving frame _ quantities with a subscript  o \" , the first two moment equations of the radiation field are obtained by taking angular moments of equation ( 2 ) , which yields temporarily suppressing the @xmath21 subscript :    @xmath45    @xmath46    where @xmath47 is the fluid density and @xmath48 is the convective derivative . equations ( 3 ) and ( 4 ) are mm equations ( 95.87 ) and ( 95.88 ) dropping acceleration terms .",
    "equations ( 3 ) and ( 4 ) can be simplified further when we realize we are interested in phenomena occuring on the fluid flow timescale , not the radiation flow timescale .",
    "this _ quasi - static approximation _ amounts to throwing away terms which are always @xmath49 or higher .",
    "this must be done with care , and we refer the reader to mm for a thorough analysis .",
    "the result , for _ continuum radiation _ is :    @xmath50    @xmath51    where now it is understood all quantities are measure in the comoving ( fluid ) frame , @xmath52 , and @xmath53 is the absorption coefficient ( we have ignored scattering . )",
    "equations ( 5 ) and ( 6 ) are called quasi - static because the only timescale which enters is through the material opacity @xmath54 , which evolves on a photoionization timescale .",
    "equations ( 5 ) and ( 6 ) are two equations in three unknowns : e , f and p. we will experiment with various approaches to closing the hierarchy of moment equations . the most general and accurate approach is the _ eddington factor closure _ : @xmath55 , where @xmath56 is the tensor eddington factor ( e.g. , stone , mihalas & norman 1992 ) .",
    "@xmath57 contains all the angular information of the radiation field .",
    "if one knew @xmath58 , say from solving equation ( 2 ) , then @xmath59 can be computed via angular quadratures at every point @xmath60 . however , the goal is to avoid solving the angle - dependent transfer equation .",
    "one approach , which we call news , is to compute @xmath61 only along rays parallel to grid lines , as well as along the principal diagonals .",
    "since we use uniform cartesian meshes in cosmology , we simply evaluate the formal solution to eq .",
    "( 2 ) on long characteristics .",
    "a second , less accurate approach , is to compute @xmath59 using geometric information about the location of principal emitters and absorbers .",
    "this approach would have to be calibrated against more exact methods .",
    "yet more approximate , but perhaps adequate for our needs , is the _ diffusion approximation _ which states that @xmath62 , where d depends on the energy density and opacity through the relation : @xmath63 .",
    "the quantity @xmath64 is called the flux limiter , and for optically thick media has a value of 1/3 .",
    "when radiation propagates through optically thin media , it streams rather than diffuses .",
    "there are many functional forms for @xmath64 which are taylored to the problem under study ; we mention three which are prominent in the literature by alme & wilson ( 1974 ) , minerbo ( 1978 ) and levermore & pomraning ( 1981 ) .",
    "all depend on the quantity @xmath65 , which is used as a switch between the diffusion and free streaming limit .",
    "whether any of these formulations will prove adequate for our application remains to be seen .    inserting the relation @xmath62 into equation ( 5 ) ,",
    "we obtain @xmath66    where @xmath67 , s : the source function . since @xmath68 , equation ( 7 ) is a nonlinear , elliptic equation for @xmath69 , where the quantities @xmath70 and @xmath53 are functions of space and time .",
    "solution requires the specification of boundary values on @xmath69 and its normal derivative .",
    "finally , we consider reducing the frequency complexity . for this , we employ the _ multigroup method _ ( cf .",
    "6 ) , in which the frequency spectrum is divided into a number of _ frequency groups_. since , in the first instance , we are are only interested in the photoionization of primordial gas , we need only consider three frequency groups above the ionization edges for hi , hei and heii at energies @xmath71 = 1 , 1.809 , and 4 ryd , respectively",
    ". defining the group average radiation energy density as :    @xmath72    the multigroup diffusion equations to be solved are : @xmath73 where @xmath74 and @xmath75 , the flux mean and absorption mean opacities , respectively . because we do nt know @xmath69 and @xmath76 in advance , these mean opacities must be approximated .",
    "the approximations , while not unique , can be constructed to have various desirable properties , such as giving the exact energy or momentum absorbed within a group .",
    "we desire group means which conserve the total number of photoionizations within a group to a high degree of accuracy .",
    "thus , we write : @xmath77 where @xmath78 is the lyman limit , and @xmath79 is the photoionization cross section for species x. the angle average is defined formally as : @xmath80 where the weighting function @xmath81 depends on the assumed spectral form ( e.g. , piecewise constant ) of @xmath69 within each frequency group .",
    "here we briefly discuss the solution strategy for the coupled radiation , matter , cosmological fluid dynamical system . a method for efficiently computing nonequilibrium ionization , chemistry , and cooling coupled to mulitspecies cosmological hydrodynamics",
    "is described in anninos et al .",
    "applications of this method to first structure formation and the @xmath10 forest are found in abel et al .",
    "( 1998 ) and zhang et al .",
    "( 1998 ) , respectively . in the latter , photoionization of the igm in the optically thin limit due to a metagalactic uv background is included . at the heart of the method",
    "is an implicit scheme for solving the kinetic equations for all the ionization states of h and he , as well as the reactants for @xmath82 . inside the main loop of the hydrodynamic computation , we subscycle on heating and cooling portion of the gas energy equation and the kinetic equations .",
    "the timestep during subcyclying is chosen such that the fractional abundances of species which dominate the cooling change by no more than 10% .",
    "since all atomic and molecular cooling is proportional to the electron density , we find it sufficient to limit our chemistry timestep to @xmath83 .",
    "radiative transfer merely changes _ when and where _ material gets photo- heated , ionized and dissociated .",
    "thus , within the chemistry / cooling subcycle loop we also call the methods described above for computing the point source and diffuse radiation field .",
    "since opacities change on the photoionization timescale which is reflected in the electron fraction , we need not change our subcyle timestep criterion to include radiative transfer .    we thank the organizers f. palla , d. galli and e. corbelli for a most enjoyable meeting in florence .",
    "one of us ( t.a . ) thanks d. mihalas for suggesting the news scheme .",
    "the work was partially support by grants nsf asc-9318185 and nasa nag5 - 3923 ."
  ],
  "abstract_text": [
    "<S> we describe an approach for incorporating radiative transfer into 3d hydrodynamic cosmological simulations . the method , while approximate , </S>",
    "<S> allows for a self - consistent treatment of self - shielding and shadowing , diffuse and point sources of radiation , and frequency dependent transfer . </S>",
    "<S> applications include photodissociation , photoheating , and photoionization of the igm .    </S>",
    "<S> # 1 # 2 _ mem .  soc .  </S>",
    "<S> astron .  </S>",
    "<S> it . _ * # 1 * , # 2 # 1 # 2 _ the messenger _ * # 1 * , # 2 # 1 # 2 _ astron . </S>",
    "<S> nach . _ * # 1 * , # 2 # 1 # 2 _ astron . </S>",
    "<S> astrophys . _ * # 1 * , # 2 # 1 # 2 _ astron . </S>",
    "<S> astrophys . </S>",
    "<S> lett . _ * # 1 * , l#2 # 1 # 2 _ astron . </S>",
    "<S> astrophys . </S>",
    "<S> rev . </S>",
    "<S> _ * # 1 * , # 2 # 1 # 2 _ astron . </S>",
    "<S> astrophys . suppl . </S>",
    "<S> ser . _ * # 1 * , # 2 # 1 # 2 _ astron . </S>",
    "<S> j. _ * # 1 * , # 2 # 1 # 2 _ ann . </S>",
    "<S> rev . </S>",
    "<S> astron . </S>",
    "<S> astrophys . _ * # 1 * , # 2 # 1 # 2 _ astrophys . </S>",
    "<S> j. _ * # 1 * , # 2 # 1 # 2 _ astrophys . </S>",
    "<S> j. lett . </S>",
    "<S> _ * # 1 * , l#2 # 1 # 2 _ astrophys . </S>",
    "<S> j. suppl . </S>",
    "<S> _ * # 1 * , # 2 # 1 # 2 _ astrophys . </S>",
    "<S> space sci . </S>",
    "<S> _ * # 1 * , # 2 # 1 # 2 _ adv . </S>",
    "<S> space res . </S>",
    "<S> _ * # 1 * , # 2 # 1 # 2 _ bull . </S>",
    "<S> astron . </S>",
    "<S> inst . </S>",
    "<S> czechosl . _ * # 1 * , # 2 # 1 # 2 _ j. quant . </S>",
    "<S> spectrosc . </S>",
    "<S> . transfer _ * # 1 * , # 2 # 1 # 2 _ mon . not . </S>",
    "<S> r. astr . </S>",
    "<S> soc . _ * # 1 * , # 2 # 1 # 2 _ mem . </S>",
    "<S> r. astr . </S>",
    "<S> soc . </S>",
    "<S> _ * # 1 * , # 2 # 1 # 2 _ phys . </S>",
    "<S> lett . </S>",
    "<S> rev . _ * # 1 * , # 2 # 1 # 2 _ publ . </S>",
    "<S> astron . </S>",
    "<S> . japan _ * # 1 * , # 2 # 1 # 2 _ publ . </S>",
    "<S> astr . </S>",
    "<S> soc . </S>",
    "<S> pacific _ * # 1 * , # 2 # 1 # 2 _ nature _ * # 1 * , # 2 epsf.sty </S>"
  ]
}