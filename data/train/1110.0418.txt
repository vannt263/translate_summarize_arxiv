{
  "article_text": [
    "since the advent of quantum mechanics , practitioners have struggled with an inherent conceptual dualism in its formalism . on one hand , time evolution of a quantum state is a continuous , deterministic , and reversible process well described by a wave equation . on the other hand",
    ", there is irreducible stochasticity present in the measurement process that leads to discontinuous and generally irreversible state evolution in the form of so - called `` quantum jumps '' or `` state collapse . ''",
    "to cope with the necessary introduction of the stochastic element of the theory while still preserving ties with the deterministic classical mechanics , traditional quantum mechanics @xcite emphasizes the role of hermitian observable operators that are analogous to classical observables .",
    "indeed , we find that observables underlie most of the core concepts in the quantum theory : commutation relations of observables , complete sets of commuting observables , spectral expansions of observables , conjugate pairs of observables , expectation values of observables , uncertainty relations between observables , and time evolution generated by a hamiltonian observable . even the quantum state is introduced as a superposition of observable eigenvectors .",
    "the stochasticity of the theory manifests itself as a single prescription for how to average the omnipresent observables under a deterministically evolving quantum state : the implicit projective quantum jumps corresponding to laboratory measurements are largely hidden by the formalism .",
    "experimental control of quantum systems has improved since the early days of quantum mechanics , however , so the discontinuous evolution present in the measurement process can now be more carefully investigated .",
    "modern optical and condensed matter systems , for example , can condition the evolution of a state on the outcomes of weakly coupled measurement devices ( e.g. @xcite ) , resulting in _ nonprojective _ quantum jumps that alter the state more gently , or even resulting in continuous controlled evolution of the state .",
    "since observables are defined in terms of projective jumps that strongly affect the state , it becomes unclear how to correctly apply a formalism based on observables to such nonprojective measurements .",
    "a refinement of the traditional formalism must be employed to correctly describe the general case .    to address this need ,",
    "the theory of _ quantum operations _ , or generalized measurement , was introduced in the early 1970 s by davies @xcite and kraus @xcite , and has been developed over the past forty years to become a comprehensive and mathematically rigorous theory @xcite .",
    "the formalism of quantum operations has seen the most use in quantum optics , quantum computation , and quantum information communities , where it is indispensable and well - supported by experiment .",
    "however , it has not yet seen wide adoption outside of those communities .",
    "unlike the traditional observable formalism , the formalism of quantum operations emphasizes the _",
    "states_. observables are mentioned infrequently in the quantum operations literature , usually appearing only in the context of projective measurements where they are well - understood .",
    "some references ( e.g. @xcite ) define `` generalized observables '' in terms of the generalized measurements and detector outcome labels , but give no indication about their relationship to traditional observables , if any . as a result , there is a conceptual gap between the traditional quantum mechanics of observables and the modern treatment of quantum operations that encompasses a much larger class of possible measurements than the traditional observables seemingly allow .",
    "a possible response to this conceptual gap is to declare that traditional observables are meaningless outside the context of projective measurements .",
    "this argument is supported by the fact that any generalized measurement can be understood as a part of a projective measurement being made on a larger joint system that can be associated with a traditional observable in the usual way ( i.e. @xcite ) .",
    "however , there has been parallel research into the `` weak measurement '' of observables @xcite that suggests that linking generalized measurements to traditional observables may not be such an outlandish idea .",
    "weak measurements were introduced as a consequence of the von neumann measurement protocol @xcite that uses an interaction hamiltonian with variable coupling strength to correlate an observable of interest to the generator of translations for a continuous meter observable . the resulting shift in the meter observable",
    "is then used to infer information about the observable of interest in a nonprojective manner .",
    "the technique has been used to great effect in the laboratory @xcite to measure physical quantities like pulse delays , beam deflections , phase shifts , polarization , and averaged trajectories .",
    "therefore , we conclude that there must be some meaningful way to reconcile nonprojective measurements with traditional observables more formally .",
    "the primary purpose of the present work is to detail a synthesis between generalized measurements and observables that is powerful enough to encompass projective measurements , weak measurements , and any strength of measurement in between .",
    "the formalism of _ contextual values _",
    ", which we explicitly introduced in @xcite and further developed in @xcite , forms a bridge between the traditional notion of an observable and the modern theory of quantum operations",
    ". for a concise introduction to the topic in the context of the quantum theory , we recommend reading our letter @xcite .",
    "the central idea of the contextual - value formalism is that an observable can be completely measured indirectly using an imperfectly correlated detector by assigning an appropriate set of values to the detector outcomes .",
    "the assigned set of values generally differs from the set of eigenvalues for the observable , and forms a _ generalized spectrum _ that is associated with the operations of the generalized measurement , rather than the spectral projections for the observable .",
    "thus , the spectrum that one associates with an observable will depend on the _ context _ of how the measurement is being performed ; such an inability to completely discuss observables without specifying the full measurement context is reminiscent of bell - kochen - specker contextuality @xcite and motivates the name `` contextual values . ''",
    "the secondary purpose of the present work is to demonstrate that the contextual values formalism for generalized observable measurement is essentially classical in nature .",
    "hence , it has potential applications outside the usual scope of the quantum theory .",
    "indeed , we will show that any system that can be described by bayesian probability theory can benefit from the contextual - value formalism .",
    "extending contextual values to the quantum theory from the classical theory clarifies which features of the quantum theory are novel .",
    "the quantum theory can be seen as an extension of a classical probability space to a continuous manifold of incompatible frameworks , where each framework is a copy of the original probability space . hence , intrinsically quantum features arise not from the observables defined in any particular framework , but instead from the relative orientations of the incompatible frameworks .",
    "as we shall see , the differences manifest in sequential measurements and conditional measurements due to the probabilistic structure of the incompatible frameworks , rather than the observables or contextual values themselves .    to keep the paper self - contained with these aims in mind , we first develop both the operational approach to measurement and the contextual values formalism completely within the confines of classical probability theory , giving illustrative examples to cement the ideas .",
    "we then port the formalism to the quantum theory and identify the essential differences that arise .",
    "our analysis therefore doubles as a pedagogical introduction to the operational approaches for both classical and quantum probability theory that should be accessible to a wide audience .",
    "the paper is organized as follows : in sec .",
    "[ sec : colorblind ] , we provide a simple intuitive example to introduce the concept of contextual values . in secs .",
    "[ sec : csample ] through [ sec : cdetector ] , we develop the classical version of the operational approach to measurement . in sec .",
    "[ sec : ccv ] , we introduce the contextual values formalism classically and then give several examples similar to the initial example . in secs .",
    "[ sec : qsample ] through [ sec : qdetector ] , we generalize the classical operations to quantum operations and highlight the key differences with explicit examples . in sec . [",
    "sec : qcv ] , we apply the contextual values formalism to the quantum case and show that it is unchanged .",
    "we also specifically address how to treat weak measurements as a special case of our more general formalism and provide a derivation of the quantum weak value in sec .",
    "[ sec : wv ] . finally , we give our conclusions in sec . [",
    "sec : conclusion ] .",
    "the idea of the contextual values formalism is deceptively simple .",
    "its essence can be distilled from the following classical example of an _ ambiguous detector _ : suppose we wish to measure a marble that may be colored either red or green .",
    "a person with normal vision can distinguish the colors unambiguously and so would represent an ideal detector for the color state of the marble .",
    "a partially colorblind person , however , may only estimate the color correctly some percentage of the time and so would represent an ambiguous detector of the color state of the marble .",
    "if the person is only mildly colorblind , then the estimations will be strongly correlated to the actual color of the marble .",
    "the ambiguity would then be perturbative and could be interpreted as _ noise _ introduced into the measurement .",
    "however , if the person is strongly colorblind , then the estimations may be only mildly correlated to the actual color of the marble .",
    "the ambiguity becomes _ nonperturbative _ , so the noise dominates the signal in the measurement .",
    "we can design an experimental protocol where an experimenter holds up a marble and the colorblind person gives a thumbs - up if he thinks the marble is green or a thumbs - down if he thinks the marble is red .",
    "suppose , after testing a large number of known marbles , the experimenter determines that a green marble correlates with a thumbs - up 51% of the time , while a red marble correlates with a thumbs - down 53% of the time .",
    "the experimental outcomes of thumbs - up and thumbs - down are thus only weakly correlated with the actual color of the marble .",
    "having characterized the detector in this manner , the experimenter provides the colorblind person with a very large bag of an unknown distribution of colored marbles .",
    "the colorblind person examines every marble , and for each one records a thumbs - up or a thumbs - down on a sheet of paper , which he then returns to the experimenter .",
    "the experimenter then wishes to reconstruct what the average distribution of marble colors in the bag must be , given only the ambiguous output of his colorblind detector .    for simplicity",
    ", the clever experimenter decides to associate the colors with numerical values : @xmath0 for green ( g ) and @xmath1 for red ( r ) . in order to compare the ambiguous outputs with the colors",
    ", he also assigns them _ different _ numerical values : @xmath2 for thumbs - up ( u ) , and @xmath3 for thumbs - down ( d ) .",
    "he then writes down the following probability constraint equations for obtaining the average marble color , @xmath4 , based on what he has observed , @xmath5 which he can rewrite as a matrix equation in the basis of the color probabilities @xmath6 and @xmath7 , @xmath8 after solving this equation , he finds that he must assign the amplified values @xmath9 and @xmath10 to the outcomes of thumbs - up and thumbs - down , respectively , in order to compensate for the detector ambiguity . after doing so",
    ", he can confidently calculate the average color of the marbles in the large unknown bag using the identity .",
    "the classical color observable has eigenvalues of @xmath0 and @xmath1 that correspond to an ideal measurement .",
    "the amplified values of @xmath11 and @xmath12 that must be assigned to the ambiguous detector outcomes are _ contextual values _ for the same color observable .",
    "the _ context _ of the measurement is the characterization of the colorblind detector , which accounts for the degree of colorblindness .",
    "the expansion relates the spectrum of the observable to its generalized spectrum of contextual values . with this identity",
    ", both an ideal detector and a colorblind detector can measure the same observable ; however , the assigned values must change depending on the context of the detector being used .",
    "to define contextual values more formally , we shall define generalized measurements within the classical theory of probability using the same language as quantum operations .",
    "in particular , rather than representing the observables of classical probability theory in the traditional way as functions , we shall adopt a more calculationally flexible , yet equivalent , _ algebraic _ representation that closely resembles the operator algebra for quantum observables .",
    "we also briefly comment that the relevant subset of probability theory that is summarized here may slightly differ in emphasis from incarnations that the reader may have encountered previously .",
    "our treatment acknowledges that probability theory , in its most general incarnation , is a system of formal reasoning about boolean logic propositions @xcite ; specifically , our treatment emphasizes logical inference rather than the traditional frequency analysis of concrete random variable realizations .",
    "however , the `` frequentist '' approach of random variables is not displaced by the logical approach , but is rather subsumed as an important special case pertaining to repeatable experiments with logically independent outcomes . due to its clarity and generality , the logical approach has been widely adopted in diverse disciplines under the distinct name `` bayesian probability theory . '' several physicists , including ( but certainly not limited to ) jaynes @xcite , caves @xcite , fuchs @xcite , spekkens @xcite , harrigan @xcite , wiseman @xcite , and leifer @xcite , have also extolled its virtues in recent years . we follow suit to emphasize the generality of the contextual - value concept .      in what follows",
    ", we shall consider the stage on which classical probability theory unfolds  namely its space of observables  to be a commutative algebra over the reals that we denote @xmath13 .",
    "this choice of notation is motivated by the fact that the observable algebra is built from and contains two related spaces , @xmath14 and @xmath15 , that are conceptually distinct and equally important to the theory .",
    "the three are illustrated in fig .",
    "[ fig : venndiagram ] to orient the discussion . to avoid distracting technical detail",
    ", we will briefly describe finite - dimensional versions of these three spaces here , and note straightforward generalizations to the continuous case when needed @xcite .    , the boolean algebra of propositions @xmath15 , and the algebra of observables @xmath16 .",
    "the probability state @xmath17 is a measure from @xmath15 to the interval @xmath18 $ ] .",
    "the expectation functional @xmath19 is a linear extension of @xmath17 that maps @xmath16 to the reals @xmath20 ; by construction @xmath21 whenever both are defined . ]",
    "_ sample spaces_.the core of a probability space is a set of mutually exclusive logic propositions , @xmath14 , known as the _ sample space _ of _ atomic propositions_. in other words , elements of the sample space , such as @xmath22 , represent `` yes or no '' questions that can not be answered `` yes '' simultaneously and can not be broken into simpler questions .",
    "for example , @xmath23 and @xmath24 are valid mutually exclusive atomic propositions . to be a proper sample space",
    ", the propositions should form a complete set , meaning that there must always be exactly one true proposition . physically",
    ", such propositions typically correspond to mutually independent outcomes of an experiment that probes some system of interest .",
    "indeed , any accessible physical property must be testable by some experiment , and any experiment can be described by such a collection of yes or no questions .    _",
    "boolean algebra_.the atomic propositions in @xmath14 can be extended to more complex propositions by logical combination in order to form the larger space @xmath15 .",
    "specifically , we can combine them algebraically with a logical or denoted by addition and a logical and denoted by multiplication .",
    "for example , given propositions @xmath25 , the quantity @xmath26 would denote the proposition `` ( @xmath27 and @xmath28 ) or ( @xmath28 and @xmath29 ) . ''",
    "importantly , both the sum and the product commute since the corresponding logical operations commute , and the propositions are idempotent so @xmath30 for any @xmath31 .",
    "furthermore , the product of any two nonequal propositions in @xmath14 must be trivially false since they are mutually exclusive ; we denote the trivially false proposition as @xmath32 since its product with any proposition is also trivially false .",
    "similarly , the sum of all propositions in @xmath14 will be trivially true since one of the atomic propositions must be true by construction ; we denote the trivially true proposition as @xmath33 since its product with any proposition @xmath34 leaves that proposition invariant , @xmath35 . the logical operation of not , or complementation ( @xmath36 ) with respect to @xmath14 ,",
    "can then be defined as the subtraction from the identity @xmath37 since @xmath38 must be true for any proposition @xmath34 by definition .",
    "the proposition space @xmath15 contains @xmath14 and is closed under the operations of and , or , and not ; hence , it forms a _ boolean logic algebra _ @xcite .    _",
    "observables_.finally , we extend @xmath15 linearly over the real numbers to obtain the commutative algebra of _ observables _ @xmath16 . that is , any linear combination of propositions @xmath39 with @xmath40 and @xmath41 is an observable in @xmath16 ; similarly any linear combination of observables @xmath42 with @xmath43 and @xmath44 is also an observable in @xmath16 .",
    "countable sums are permitted provided the coefficients converge .",
    "the three spaces @xmath14 , @xmath15 , and @xmath16 are illustrated in fig .",
    "[ fig : venndiagram ] .",
    "the observables combine logical propositions with numbers that describe the relation of each proposition to some meaningful reference .",
    "for example , one could define a simple observable @xmath45 that assigns a value of @xmath0 to the proposition asking whether a marble looks green and assigns a value of @xmath1 to the proposition asking whether that same marble looks red in order to distinguish the colors by a sign .",
    "alternatively , one can bestow a physical meaning to the color propositions by defining a wavelength observable instead : @xmath46 .",
    "one could even define an observable @xmath47 that indicates a monetary bet made on the color of the marble , with @xmath48 being awarded for a color of green and @xmath49 being lost for a color of red .",
    "such numerical labels are always assigned by convention , but indicate physically relevant information about the type of questions being asked by the experimenter that are answerable by the independent propositions .    _",
    "representation_.the algebra @xmath15 can be represented as the lattice of projection operators acting on a hilbert space exactly as in the standard representation of quantum theory @xcite .",
    "the elements @xmath50 of @xmath14 correspond to rank-1 projection operators @xmath51 onto orthogonal subspaces spanned by orthonormal vectors @xmath52 in the hilbert space .",
    "any sum of @xmath53 elements of @xmath14 , @xmath54 , corresponds to a rank-@xmath53 projection operator @xmath55 onto a subspace spanned by @xmath53 orthonormal vectors @xmath56 in the hilbert space .",
    "hence , we shall casually refer to propositions of the boolean algebra @xmath15 as _ projections _ in what follows .",
    "however , it is important to note that the boolean algebra @xmath15 need not be represented in this fashion to be well defined .    just like the propositions @xmath15 can be represented as projections on a hilbert space , the observables @xmath16 can also be represented as the algebra of hermitian operators acting on the same hilbert space .",
    "hence , we shall casually refer to observables in @xmath16 as _ observable operators _ in analogy to the quantum theory .",
    "however , unlike quantum observables , all classical observables commute .",
    "it is important to note that the representation of observables as operators on a hilbert space in both the classical and the quantum case remains strictly optional for calculational convenience .",
    "_ independent probability observables_.we note that the identity observable @xmath33 can be partitioned into many distinct sets of independent propositions in @xmath15 , such as @xmath57 , which is known as a _",
    "closure relation_. each partitioning corresponds to a particular detector arrangement that only probes those propositions .",
    "such a partitioning @xmath58 has the common mathematical name _ projection - valued measure _ ( pvm )",
    "since it forms a measure over the index @xmath59 and has a representation that consists of orthogonal projections .",
    "however , we shall make an effort to call the propositions @xmath58 _ independent probability observables _ to be more physically descriptive .",
    "we will later contrast them with more general probability observables .",
    "general observables can be constructed from independent probability observables by associating a real value @xmath60 to each index @xmath59 in the sum , @xmath61 .",
    "the product of the observable with any of its constituent probability observables simplifies , @xmath62 ; hence , the associated values form the set of _ eigenvalues _ for the observable . for a finite observable space @xmath16 , the set of atomic propositions @xmath14 itself is a maximally refined set of independent probability observables that can construct any observable in the space , @xmath63 in the continuous case the values @xmath64 form a measurable function that specifies the _ spectrum _ of the observable ;",
    "the sum is then commonly written as an integral over the continuous set of propositions @xmath51 , @xmath65 .",
    "we use the hilbert space notation @xmath66 in the integral to avoid later confusion with real - valued integrals .      _",
    "probability measures_.a _ state _",
    "@xmath17 is a _ probability measure _ over the boolean algebra @xmath15 , meaning that it is a linear map from @xmath15 to the interval @xmath18 $ ] such that @xmath67 .",
    "such a state @xmath17 assigns a numerical value @xmath68 to each proposition @xmath31 that quantifies its degree of _ plausibility _ ; that is , @xmath68 formally indicates how likely it is that the question @xmath27 would be answered `` yes '' were it to be answered , with @xmath0 indicating a certain `` yes '' and @xmath32 indicating a certain `` no . ''",
    "the value @xmath68 is called the _ probability _ for the proposition @xmath27 to be true .",
    "normalizing @xmath67 ensures that exactly one proposition in the sample space must be true . for continuous spaces",
    ", the state becomes an integral @xmath69 .    _",
    "frequencies_.empirically , one can check probabilities by repeatedly asking a proposition in @xmath15 to identically prepared systems and collecting statistics regarding the answers . for a particular proposition @xmath70 ,",
    "the ratio of yes - answers to the number of trials will converge to the probability @xmath68 as the number of trials becomes infinite .",
    "however , the probability has a well - defined meaning as a plausibility prediction even without actually performing such a repeatable experiment . indeed , designing good quality repeatable experiments to check the probabilities assigned by a predictive state",
    "is the primary goal of experimental science , and is generally quite difficult to achieve .",
    "_ expectation functionals_.the linear extension of a state @xmath17 to the whole observable algebra @xmath16 is an _ expectation functional _ that averages the observables , and is traditionally notated with angled brackets @xmath19 .",
    "specifically , for an observable @xmath71 , then , @xmath72 is the _ expectation value _ , or average value , of @xmath73 under the functional @xmath19 that extends the probability state @xmath17 .",
    "since @xmath19 is linear , it passes through the sum and the constant factors of @xmath64 to apply directly to the propositions @xmath27 .",
    "the restriction of @xmath19 to @xmath15 is @xmath17 , so @xmath74 as written in .",
    "that is , the expectation value @xmath75 of a pure proposition @xmath27 is the probability of that proposition .",
    "the probability state @xmath17 and its linear extension @xmath19 are illustrated in fig .",
    "[ fig : venndiagram ] . for continuous spaces",
    "the sum becomes an integral of the measurable function @xmath64 , @xmath76 .    _",
    "moments_.the @xmath53^th^ statistical moment of @xmath73 is @xmath77 and empirically corresponds to measuring the observable @xmath73 @xmath53 times in a row per trial on identical systems and averaging the repeated results .",
    "hence , the moments quantify the fluctuations of the observable measurements that stem from uncertainty in the state .",
    "for continuous spaces , the higher moments also become integrals @xmath78 .",
    "_ densities_.states can often be represented as _ densities _ with respect to some _ reference measure _ @xmath79 from @xmath15 to @xmath80 , which can be convenient for calculational purposes . just as the state @xmath17 can be linearly extended to an expectation functional @xmath19",
    ", any reference measure @xmath79 can be linearly extended to a functional @xmath81 . for continuous spaces ,",
    "such a reference functional takes the form of an integral @xmath82 .",
    "the representation of a state as a density follows from changing the integration measure for the state to the reference measure @xmath83 .",
    "the jacobian conversion factor @xmath84 from the integral over @xmath85 to the integral over a different measure @xmath86 is the _ probability density _ for @xmath17 with respect to @xmath79 , if it exists @xcite .",
    "we can then define a _",
    "state density observable _",
    "@xmath87 that relates the expectation functional @xmath19 to the reference functional @xmath81 directly according to the relation @xmath88 .    for continuous spaces ,",
    "the standard integral is most frequently used as a reference .",
    "hence , the probability density with respect to the standard integral is given the simple notation @xmath89 such that @xmath90 .",
    "importantly , the probability for @xmath27 is not the density @xmath91 , but is the ( generally infinitesimal ) integral of the density over a single point @xmath92 @xcite , commonly notated @xmath93 .    in discrete spaces we apply the same idea by defining a state density observable directly in terms of measure ratios , @xmath94",
    "then by definition and linearity , @xmath95 f(x ) \\mu(x ) = \\sum_{x\\in x }",
    "f(x ) p(x ) = { \\big\\langle f \\big\\rangle}$ ] , as required .",
    "evidently , the measure @xmath79 must be nonzero for all propositions @xmath27 for which @xmath17 is nonzero in order for such a state density to be well defined .",
    "this definition as a ratio of functionals will correctly reproduce the jacobian derivative in the continuous case using a limiting prescription .    _",
    "trace_.an important reference measure which is nonzero for any nonzero proposition is the counting measure , or _",
    "@xmath96 , which evaluates to the rank of any proposition in @xmath15 ; for example , given @xmath97 then @xmath98 is a rank-3 proposition and @xmath99 .",
    "since the trace evaluates to unity on any atomic proposition , _ any _ state has a trace - density defined by equation that is traditionally notated as @xmath100 . @xmath101",
    "the trace - density is the only state density that is always defined and exactly determined by the probabilities of the atomic propositions @xmath68 . because of this",
    ", the trace - representation of a state can be naturally interpreted as an inner product , @xmath102 between the trace - density and the observable , known as the hilbert - schmidt inner product .",
    "the trace will become particularly important when we generalize to quantum mechanics , which is why we mention it here .",
    "indeed , the trace - density @xmath100 will be equivalent to the quantum mechanical density operator when extended to the noncommutative case .",
    "for continuous spaces the integral is traditionally preferred to the trace as a reference because the trace can frequently diverge .",
    "_ state collapse_.if a question on the probability space is answered by some experiment , then the state indicating the plausibilities for future answers must be updated to reflect the acquired answer .",
    "the update process is known as _",
    "bayesian state conditioning _ , or _",
    "state collapse_. specifically , if a proposition @xmath103 is verified to be true , then the experimenter updates the expectation functional to the conditioned functional , @xmath104 that reflects the new information . for a proposition @xmath31",
    ", the conditional probability @xmath105 has the traditional notation @xmath106 and is read as `` the probability of @xmath27 given @xmath28 . ''    from , any state density corresponding to @xmath17 will be similarly updated to a new density via a product , @xmath107 notably , conditioning the trace - density @xmath100 on an atomic proposition @xmath108 will collapse the density to become the proposition itself , @xmath109 .",
    "note that the proposition @xmath28 serves a dual role in the conditioning procedure .",
    "first , it is used to compute the normalization probability @xmath110 .",
    "second , it directly updates the state via a product action .",
    "the product indicates that future questions will be logically linked to the answered question with the _ and _ operation ; that is , the knowledge about the system has been refined by the answered question .",
    "the process of answering a question about the system and then conditioning the state on the new information is called a _ measurement _ ; moreover , since the proposition @xmath28 is a projection acting on the density , this kind of measurement is called a _ projective measurement_.    _",
    "bayes rule_.if we pick another proposition @xmath111 as the observable in we can derive _ bayes rule _ as a necessary consequence by interchanging @xmath28 and @xmath29 and then equating the joint probabilities @xmath112 , @xmath113 bayes rule relates conditioned expectation functionals to one another and so is a powerful logical inference tool that drives much of the modern emphasis on the logical approach to probability theory .    _",
    "disturbance_.conditioning , however , is not the only way that one can alter a state .",
    "one can also _ disturb _ a state without learning any information about it , which creates a transition to an updated expectation functional that we denote with a tilde @xmath114 according to ,    [ eq : cdisturb ] @xmath115    here the disturbance @xmath116 is a map from @xmath16 to @xmath16 that is governed by a collection of states @xmath117 that specify _ transition probabilities _",
    "@xmath118 from old propositions @xmath27 to new propositions @xmath119 .",
    "to be normalized , the transition states must satisfy @xmath120 , so that @xmath121 and therefore @xmath122 .",
    "updating the state according to is also known as _",
    "bayesian belief propagation _ @xcite and is more commonly written in the fully expanded form @xmath123 .",
    "_ time evolution_.as an important special case , the time evolution of a markovian stochastic process is a form of disturbance @xmath124 , known as a _ propagator _ , that is parametrized by a time interval @xmath125 .",
    "no information is learned as the system evolves , so the knowledge about the system as represented by the expectation functional can only propagate according to the laws governing the time evolution . for a hamiltonian system ,",
    "the time evolution is of liouville form ; that is , if we define a time - evolving observable as @xmath126 then we have @xmath127 , where @xmath128 is defined point wise as the poisson bracket .",
    "the differential equation implicitly specifies the form of the disturbance @xmath124 .    _",
    "correlation functions_.correlations between observables at different times can be obtained by inserting a time - evolution disturbance between the observable measurements , @xmath129 operationally this corresponds to measuring the observable @xmath73 , waiting an interval of time @xmath125 , then measuring the observable @xmath130 .",
    "similarly , @xmath53-time correlations can be defined with @xmath131 time - evolution disturbances between the observable measurements @xmath132 .",
    "computing the correlation of an observable with itself at the same time will produce a higher moment @xmath133 .",
    "_ invasive measurement_.a system may also be disturbed during the physical process that implements conditioning , which will alter the state above and beyond the pure conditioning expression .",
    "with such an _ invasive measurement _ , one conditions a state after a disturbance induced by the measurement process has occurred ; hence , one obtains a new state , @xmath134 which is a composition of the measurement disturbance followed by the pure conditioning .    as we shall see later in sec .",
    "[ sec : qcollapse ] , the quantum projection postulate ( lder s rule ) can be understood as an invasive measurement similar to , but not as pure conditioning similar to .",
    "this observation has also been recently emphasized by @xcite , who show that a careful extension of to the noncommutative quantum setting does not reproduce the projection postulate .",
    "hence , better understanding classical invasive measurement should provide considerable insight into the quantum measurement process .",
    "however , to properly understand the implications of invasive measurements on the measurement of observables , we must consider the measurement process in more detail .",
    "for a single ideal experiment that answers questions of interest with perfectly correlated independent outcomes , knowing the spectrum of an observable for that experiment is completely sufficient . however , in many ( if not most ) cases the independent propositions corresponding to the experimental outcomes are only _ imperfectly correlated _ with the questions of interest about the system .",
    "since in such a case one may not have direct access to the questions of interest , one also may not have direct access to the observables of interest .",
    "one must instead _ infer _ information about the observables of interest _ indirectly _ from the correlated outcomes of the detector to which one does have access .",
    "_ joint sample space_.to handle this case formally , we first enlarge the sample space to include both the sample space of interest , which we call the _ system _ , @xmath14 and the accessible sample space , which we call the _ detector _ , @xmath135 .",
    "questions about the system and the detector can be asked independently , so every question for the system can be paired with any question from the detector ; therefore , the resulting joint sample space must be a product space , @xmath136 , where the products of propositions from different sample spaces commute .",
    "the boolean algebra @xmath137 and observable algebra @xmath138 are constructed in the usual way from the joint sample space , and contain the algebras @xmath15 , @xmath139 , @xmath16 , and @xmath140 as subalgebras . when represented as operators on a hilbert space , the corresponding joint representation exists within the tensor product of the system and detector space representations .",
    "_ product states_.if the probabilities of the system propositions are uncorrelated with the probabilities of the detector propositions under a joint state @xmath17 on the joint sample space , then the joint state can be written as a _ composition _ of independent states that are restricted to the sample spaces of the system and detector , @xmath141 .",
    "just as the state @xmath17 has a linear extension to @xmath19 , its restrictions @xmath142 and @xmath143 have linear extensions @xmath144 and @xmath145 , respectively .",
    "thus , for any joint observable @xmath73 an uncorrelated expectation has the form @xmath146 .",
    "such an uncorrelated joint state is known as a _ product state_. the name stems from the fact that for a simple product @xmath147 of system and detector observables the corresponding joint expectation decouples into a product of system and detector expectations separately , @xmath148 .    similarly , general measures on the joint sample space can be product measures .",
    "a particularly useful example is the trace @xmath149 on @xmath150 , which is composed of the _ partial traces _ , @xmath151 and @xmath152 .",
    "the trace serves as a convenient reference measure since it is a product measure for which any joint state has a corresponding density . on continuous spaces",
    "the standard integral is also a product measure , @xmath153\\,dx = \\int_y [ \\int_x f(x , y ) p(x , y)\\ , dx]\\ , dy$ ] , which tends to have noninfinitesimal densities .",
    "_ correlated states_.in addition to product states , the joint space admits a much larger class of _ correlated _ states where the detector and system questions are dependent on one another .",
    "with such a correlated state a measurement on the detector can not be decoupled in general from a measurement on the system .",
    "information gathered from a measurement on a detector under a correlated state will also indirectly provide information about the system , thus motivating the term `` detector . ''",
    "_ reduced states_.for a pure system observable @xmath154 or a pure detector observable @xmath155 , the average under a joint state will be equivalent to the average under a state restricted to either the system or the detector space , known as a _ reduced state _ , or a _",
    "marginalized state_. we can define such a reduced state by using the joint state density under any reference _ product _ measure @xmath156 , such as the trace @xmath96 .",
    "it then follows that ,    @xmath157    the quantities @xmath158 and @xmath159 are the _ reduced state densities _ that define the reduced states @xmath142 and @xmath143 with expectation functionals ,    @xmath160    by definition , @xmath161 and @xmath162 . however , in general @xmath163 , @xmath164 , and @xmath165 unless @xmath17 is a product state .",
    "the resulting reduced expectations @xmath144 and @xmath145 are independent of the choice of reference product functional @xmath79 .    _",
    "probability observables_.any correlation between the system and detector in the joint state allows us to directly relate propositions on the detector to _ observables _ on the system .",
    "we can compute the relationship directly by using a closure relation and rearranging the conditioning procedure to find , @xmath166 the resulting set of system observables @xmath167 exactly correspond to the detector outcomes @xmath168 .",
    "analogously to a set of independent probability observables , they form a partition of the system identity , but are indexed by detector propositions rather than by system propositions , @xmath169 .",
    "such a set @xmath167 has the common mathematical name _ positive operator - valued measure _ ( povm ) @xcite , since it forms a measure over the detector sample space @xmath135 consisting of positive operators .",
    "however , we shall make an effort to refer to them as general _ probability observables _ to emphasize their physical significance .",
    "as long as the detector outcomes are not mutually exclusive with the system , the probability observables will be a faithful representation of the reduced state of the detector in the observable space of the system .    _",
    "process tomography_.the probability observables are completely specified by the _ conditional likelihoods _",
    "@xmath170 for a detector proposition @xmath28 to be true given that a system proposition @xmath27 is true .",
    "such conditional likelihoods are more commonly known as _ response functions _ for the detector and can be determined via independent _ detector characterization _ using known reduced system states ; such characterization is also known as _ detector tomography _ , or _",
    "process tomography_. any good detector will then maintain its characterization with any _ unknown _ reduced system state .",
    "that is , a noninvasive coupling of such a good detector to an unknown system produces a correlated joint state according to @xmath171 , where @xmath142 is the unknown reduced system state prior to the interaction with the detector .",
    "_ generalized state collapse_.in addition to allowing the computation of detector probabilities , @xmath172 , probability observables also have the dual role of updating the reduced system state following a measurement on the detector . to see this",
    ", we apply the general rule for state collapse for a detector proposition @xmath28 on the joint state to find , @xmath173 which can be seen as a generalization of the bayesian conditioning rule to account for the effect of an imperfectly correlated detector , and can also be understood as a form of _ jeffrey s conditioning _ @xcite . for this reason , probability observables are commonly called _ effects _ of the _ generalized measurement_. a reduced state density @xmath174 for the system updates as @xmath175 .",
    "generalized measurement _ is nonprojective , so is not constrained to the disjoint questions on the sample space of the system . as a result , it answers questions on the system space _ ambiguously _ or _",
    "noisily_.    _ weak measurement_.the extreme case of such an ambiguous measurement is a _ weak measurement _ , which is a measurement that does not ( appreciably ) collapse the system state .",
    "such a measurement is inherently ambiguous to the extent that only a minuscule amount of information is learned about the system with each detection .",
    "formally , the probability observables for a weak measurement are all nearly proportional to the identity on the system space .",
    "typically , an experimenter has access to some control parameter @xmath176 ( such as the correlation strength ) that can alter the weakness of the measurement such that , @xmath177 where @xmath178 is the nonzero probability of obtaining the detector outcome @xmath28 in the absence of any interaction with the system .",
    "then for small values of @xmath176 the measurement leaves the system state nearly unperturbed , @xmath179 .",
    "the limit as such a control parameter @xmath180 is known as the _ weak measurement limit _ and is a formal idealization not strictly achievable in an experiment .    _",
    "strong measurement_.the opposite extreme case is a _ strong measurement _ or projective measurement , which is a measurement for which all outcomes are independent , as in . in other words , the probability observables are independent for a strong measurement .",
    "the projective collapse rule can therefore be seen as a special case of the general collapse rule from this point of view .",
    "_ measurement sequences_.a further benefit of the probability observable representation of a detector is that it becomes straightforward to discuss sequences of generalized measurements performed on the same system .",
    "for example , consider two detectors that successively couple to a system and have the outcomes @xmath28 and @xmath29 measured , respectively . to describe the full joint state of the system and both detectors",
    "requires a considerably enlarged sample space .",
    "however , if the detectors are characterized by two sets of probability observables @xmath167 and @xmath181 we can immediately write down the probability of both outcomes to occur as well as the resulting final collapsed system state without using the enlarged sample space ,    @xmath182    similarly , a conditioned density takes the form @xmath183 .",
    "the detectors have been _ abstracted _ away to leave only their effect upon the system of interest .",
    "_ generalized invasive measurement_.the preceding discussion holds provided that the detector can be noninvasively coupled to a reduced system state @xmath142 to produce a joint state @xmath171 .",
    "however , more generally the process of coupling a reduced detector state @xmath143 to the reduced system state @xmath142 will _ disturb _ both states as discussed for .",
    "the disturbance produces a joint state from the original product state of the system and detector according to , @xmath184 where @xmath185 are states specifying the joint transition probabilities for the disturbance .",
    "the noninvasive coupling @xmath171 is a special case of this where the reduced system state is unchanged by the coupling .    as a result",
    ", we must slightly modify the derivation of the probability observables to properly include the disturbance ,    [ eq : cpovmdisturb ] @xmath186    the modified probability observable @xmath187 includes both the initial detector state @xmath143 and the disturbance from the measurement . detector tomography will therefore find the effective characterization probabilities @xmath188 .    the generalized collapse rule similarly must be modified to include the disturbance , @xmath189 surprisingly , we can no longer write the conditioning in terms of just the probability observables @xmath187 ; instead we must use an _ operation _ @xmath190 that takes into account both the coupling of the detector and the disturbance of the measurement in an active way .",
    "the measurement operation is related to the effective probability observable according to , @xmath191 .",
    "the change from observables to operations when the disturbance is included becomes particularly important for a sequence of invasive measurements .",
    "consider an initial system state @xmath142 that is first coupled to a detector state @xmath143 via a disturbance @xmath192 , then conditioned on the detector proposition @xmath28 , then coupled to a second detector state @xmath193 via a disturbance @xmath194 , and finally conditioned on the detector proposition @xmath29 .",
    "the joint probability for obtaining the ordered sequence @xmath195 can be written as @xmath196 the effective probability observable @xmath197 for the ordered measurement sequence @xmath195 is no longer a simple product of the probability observables @xmath187 and @xmath198 as in , but is instead an ordered _ composition of operations_.    the ordering of operations also leads to a new form of _ postselected _ conditioning .",
    "specifically , if we condition only on the second measurement of @xmath29 in an invasive sequence @xmath195 , we obtain , @xmath199{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } & = \\frac{{\\big\\langle \\mathcal{e}_y(\\tilde{e}'_z ) \\big\\rangle}_x}{\\sum_{y'\\in y } { \\big\\langle \\mathcal{e}_{y'}(\\tilde{e}'_z ) \\big\\rangle}_x } = \\frac{{\\big\\langle \\mathcal{e}_y(\\tilde{e}'_z ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(\\tilde{e}'_z ) \\big\\rangle}_x } , \\\\",
    "\\mathcal{e}(\\tilde{e}'_z ) & = \\sum_{y'\\in y } \\mathcal{e}_{y'}(\\tilde{e}'_z ) = { \\big\\langle \\mathcal{d}(\\tilde{e}'_z ) \\big\\rangle}_y.\\end{aligned}\\ ] ] the different position of the subscript serves to distinguish the postselected probability @xmath200{{{\\big\\langle \\widetilde { y } \\big\\rangle}}}{}}$ ] from the preselected probability @xmath201 corresponding to the reverse measurement ordering of @xmath202 .",
    "the operation @xmath203 appearing in the denominator is called a _ nonselective measurement _ since it includes the disturbance induced by the measurement coupling , but does not condition on any particular detector outcome . when the disturbance to the reduced system state vanishes , the conditioning becomes order - independent and both types of conditional probability reduce to @xmath204 .",
    "the two forms of conditioning for invasive measurements in turn lead to a modified form of bayes rule that relates the preselected conditioning of a sequence to the postselected conditioning of the same sequence , @xmath205{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } & = { { \\big\\langle \\widetilde { z } \\big\\rangle}}_y \\frac{{\\big\\langle e_y \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(\\tilde{e}'_z ) \\big\\rangle}_x}.\\end{aligned}\\ ] ] when the disturbance to the reduced system state vanishes , the nonselective measurement @xmath203 reduces to the identity operation , @xmath200{{{\\big\\langle \\widetilde { y } \\big\\rangle}}}{}}$ ] reduces to @xmath206 , @xmath207 reduces to @xmath208 , and we correctly recover the noninvasive bayes rule .",
    "_ observable correspondence_.with the preliminaries about generalized state conditioning out of the way , we are now in a position to discuss the measurement of observables in more detail .",
    "first we observe an important corollary of the observable representation of the detector probabilities @xmath172 from : _ detector _ observables can be mapped into equivalent _ system _ observables , @xmath209 note that the eigenvalues @xmath210 of the equivalent system observable @xmath154 are not the same as the eigenvalues @xmath211 of the original detector observable @xmath155 , but are instead their average under the detector response .",
    "if the system propositions were accessible then the system observable @xmath154 would allow nontrivial inference about the detector observable @xmath155 , provided that the probability observables were nonzero for all @xmath28 in the support of @xmath155 .",
    "_ contextual values_.a more useful corollary of the expansion is that any _ system _ observable that can be expressed as a combination of probability observables may be equivalently expressed as a _ detector _ observable , @xmath212 which is the classical form of our main result . using this equivalence ,",
    "_ we can indirectly measure such system observables using only the detector_. we dub the eigenvalues of the detector observable @xmath211 the * contextual values * ( cvs ) of the system observable @xmath154 under the _ context of the specific detector _ characterized by a specific set of probability observables @xmath167 . the cvs form",
    "a _ generalized spectrum _ for the observable since they are associated with general probability observables for a generalized measurement and not independent probability observables for a projective measurement ; the eigenvalues are a special case when the probability observables are the spectral projections of the observable being measured .    with this point of view",
    ", we can understand an observable as an _ equivalence class _ of possible measurement strategies for the same average information .",
    "that is , using appropriate pairings of probability observables and cvs , one can measure the same observable average in many different ways , @xmath213 .",
    "each such expansion corresponds to a different experimental setup .    _",
    "moments_.similarly , the @xmath53^th^ statistical moment of an observable can be measured in many different , yet equivalent , ways .",
    "for instance , the @xmath53^th^ moment of an observable @xmath154 can be found from the expansion as , @xmath214 by examining the general collapse rule for measurement sequences we observe that the quantity @xmath215 must be the joint probability for a sequence @xmath216 of @xmath53 _ noninvasive _ measurements that couple the same detector to the system @xmath53 times in succession .",
    "furthermore , the average in is explicitly different from the @xmath53^th^ statistical moment of the raw detector results , @xmath217 .",
    "we conclude that , _ for imperfectly correlated noninvasive detectors , one must perform measurement sequences to obtain the correct statistical moments of an observable using a particular set of cvs_. only for unambiguous measurements with independent probability observables do such measurement sequences reduce to simple powers of the eigenvalues being averaged with single measurement probabilities . if a single measurement by the detector is done per trial , then only the statistical moments of the _ detector _",
    "observable @xmath155 can be inferred from that set of cvs , as opposed to the true statistical moments of the inferred system observable @xmath154 .",
    "we can , however , change the cvs to define new observables that correspond to powers of the original observable , such as @xmath218 .",
    "these new observables can then be measured indirectly using the same experimental setup without the need for measurement sequences .",
    "the cvs @xmath219 for the @xmath53^th^ power of @xmath154 will not be simple powers of the cvs @xmath211 for @xmath154 unless the measurement is unambiguous .",
    "_ invasive measurements_.if the measurement is invasive , then the disturbance forces us to associate the cvs with the measurement _ operations _ @xmath220 and not solely with their associated probability operators @xmath221 in order to properly handle measurement sequences as in .",
    "specifically , we must define the _ observable operation _ ,",
    "@xmath222 which produces the identity @xmath223 similar to .    correlated sequences of invasive observable measurements can be obtained by composing the observable operations , @xmath224 such an @xmath53-measurement sequence reduces to the @xmath53^th^ moment when the disturbance vanishes .",
    "if time evolution disturbance @xmath124 is inserted between different invasive observable measurements , then we obtain an invasive _ correlation function _ instead ,",
    "@xmath225 when the observable measurements become noninvasive , then this correctly reduces to the noninvasive correlation function .",
    "similarly , @xmath53-time invasive correlations can be defined with @xmath131 time - evolution disturbances between the invasive observable measurements @xmath226 .",
    "_ conditioned averages_.in addition to statistical moments of the observable , we can also use the cvs to construct principled _ conditioned averages _ of the observable . recall that in the general case of an invasive measurement sequence we can condition the observable measurement in two distinct ways . if we condition on an outcome @xmath29 before the measurement of @xmath154 we obtain the _ preselected conditioned average _",
    "@xmath227 defined in . on the other hand ,",
    "if the invasive conditioning measurement of @xmath29 happens after the invasive observable measurement then we must use the postselected conditional probabilities to construct a _ postselected conditioned average _",
    ", @xmath228{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\sum_{y\\in y } f_y(y)\\ , { \\tensor[_{z}]{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } , \\\\    & = \\frac{\\sum_{y\\in y } f_y(y ) { \\big\\langle \\mathcal{e}_y(\\tilde{e}'_z ) \\big\\rangle}_x}{\\sum_{y\\in y } { \\big\\langle \\mathcal{e}_y(\\tilde{e}'_z ) \\big\\rangle}_x } = \\frac{{\\big\\langle \\mathcal{f}_x(\\tilde{e}'_z ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(\\tilde{e}'_z ) \\big\\rangle}}. \\nonumber\\end{aligned}\\ ] ] the observable operation @xmath229 and the nonselective measurement @xmath203 encode the relevant details from the first measurement .",
    "when the disturbance to the reduced system state vanishes , both the preselected and the postselected conditioned averages simplify to the pure conditioned average @xmath230 defined in that depends only on the system observable @xmath154 .",
    "while the pure conditioned average @xmath230 is independent of the order of conditioning and is always constrained to the eigenvalue range of the observable , the postselected invasive conditioned average @xmath200{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{}}$ ] can , perhaps surprisingly , stray outside the eigenvalue range with ambiguous measurements . the combination of the amplified cvs and the disturbance can lead to a postselected average that lies anywhere in the full cv range , rather than just the eigenvalue range .",
    "we will see an example of this in sec .",
    "[ sec : cmarbledisturb ] .",
    "_ inversion_.so far we have treated the cvs in the expansion as known quantities . however , for a realistic detector situation , the cvs will need to be experimentally determined from the characterization of the detector and the observable that one wishes to measure .",
    "the reduced system state @xmath142 will generally not be known _ a priori _ , since the point of a detector is to learn information about the system in the _ absence _ of such prior knowledge .",
    "we can still solve for the cvs without knowledge of the system state , however , since the probability observables are only specified by the conditional likelihoods @xmath170 that can be obtained independently from detector tomography .    to solve for the cvs when the system state is presumed unknown , we rewrite in the form , @xmath231 where @xmath232 is the map that converts observables in the detector space to observables in the system space @xmath233 .",
    "our goal is to invert this map and solve for the required spectrum of @xmath155 given a desired system observable @xmath154 .",
    "however , the inverse of such a map is not generally unique ; for it to be uniquely invertible it must be one - to - one between system and detector spaces of equal size . if the detector space is smaller than the system , then no exact inverse solutions are possible ; it may be possible , however , to find course - grained solutions that lose some information . perhaps more alarmingly , if the detector space is larger than the system , then it is possible to have an infinite set of exact solutions .",
    "when disturbance is taken into account as in , the equality becomes , @xmath234 so the composition of the disturbance @xmath116 and the detector expectation @xmath145 produces the map @xmath235 that must be inverted .",
    "equation is a special case when the reduced system state is unchanged by the coupling disturbance .    _",
    "pseudoinversion_.the entire set of possible solutions to may be completely specified using the _ moore - penrose pseudoinverse _ of the map @xmath235 , which we denote as @xmath236 .",
    "the pseudoinverse is the inverse of the restriction of @xmath235 to the space @xmath237 ; that is , the null space of @xmath235 is removed from the detector space before constructing the inverse .",
    "we will show a practical method for computing the pseudoinverse using the singular value decomposition in the examples to follow .    using the pseudoinverse , all possible solutions of",
    "can be written compactly as , @xmath238 where @xmath239 is the identity map and @xmath240 is an arbitrary detector observable .",
    "the solutions specified by the pseudoinverse in this manner contain exact inverses and course - grainings as special cases .",
    "_ detector variance_.since @xmath241 is a projection operation to the null space of @xmath235 , the second term of lives in the null space of @xmath235 and is orthogonal to the first term .",
    "therefore , the norm squared of @xmath155 has the form , @xmath242 making the @xmath243 solution have the smallest norm .",
    "the norm @xmath244 of the cv solution is relevant because the second moment of the detector observable @xmath155 is simply bounded by the norm squared @xmath245 .",
    "the second moment is similarly an upper bound for the variance of the detector observable @xmath246 .",
    "therefore , the norm squared is a reasonable upper bound for the detector variance that one can make without prior knowledge of the state .",
    "_ mean - squared error_.the variance of @xmath155 governs the mean - squared error of any estimation of its average with a finite sample , such as an empirically measured sample in a laboratory .",
    "specifically , one measures a sequence of detector outcomes of length @xmath53 , @xmath247 , and uses this finite sequence to estimate the average of @xmath155 via the _ unbiased estimator _",
    ", @xmath248 that converges to the true mean value @xmath249 as @xmath250 .",
    "the mean squared error of this estimator @xmath251 from the true mean is the variance over the number of trials in the sequence @xmath252 .",
    "hence , the maximum mean squared error for a finite sequence of length @xmath53 must be bounded by the norm squared of the cvs divided by length of the sequence , @xmath253 that is , the norm bounds the number of trials necessary to obtain an experimental estimation of observable averages to a desired precision using the imperfect detector .",
    "_ pseudoinverse prescription_.choosing the arbitrary observable to be @xmath243 therefore not only picks the solution @xmath254 that is uniquely related to @xmath154 by discarding the irrelevant null space of @xmath235 , but also picks the solution with the smallest norm , which places a reasonable upper bound on the statistical error . without prior knowledge of the system state , the pseudoinverse solution does a reasonable job at obtaining an optimal fit to the relation .",
    "moreover , when is not satisfied by the direct pseudoinverse then an exact solution is impossible , but the pseudoinverse still gives the `` best fit '' coursegraining of an exact solution in the least - squares sense .",
    "as such , we consider the direct pseudoinverse of @xmath154 to be the preferred solution in the absence of other motivating factors stemming from prior knowledge of the state being measured .      as an illustrative example similar to the one given in the introduction ,",
    "suppose that one wishes to know whether the color of a marble is green or red , but one is unable to examine the marble directly .",
    "instead , one only has a machine that can display a blue light or a yellow light after it examines the marble color .",
    "in such a case , the marble colors are the propositions of interest , but the machine lights are the only accessible propositions . the lights may be correlated imperfectly with the marble color ; for instance , if a blue light is displayed one may learn something about the possible marble color , but it may still be partially _ ambiguous _ whether the marble is actually green or actually red .",
    "the relevant boolean algebra for the system is @xmath255 , where @xmath256 is the proposition for the color green , @xmath257 is the proposition for the color red , and @xmath258 is the logical _ or _ of the two possible color propositions .",
    "we consider the task of measuring a simple color observable @xmath259 that distinguishes the colors with a sign using an imperfectly correlated detector .",
    "the relevant boolean algebra for the detector is @xmath260 , where @xmath3 is the proposition for the blue light , @xmath28 is the proposition for the yellow light , and @xmath261 . in order to measure the marble observable @xmath154 using only the detector , the experimenter must determine the proper form of the corresponding detector observable @xmath155 .",
    "first , the experimenter characterizes the detector by sending in known samples and observing the outputs of the detector .",
    "after many characterization trials , the experimenter determines to some acceptable precision the four conditional probabilities ,    [ eq : marblecharacter ] @xmath262    for the detector outcomes @xmath3 and @xmath28 given specific marble preparations @xmath256 and @xmath257 .",
    "these characterization probabilities completely determine the detector response in the form of its _ probability observables _",
    ",    [ eq : marblepovm ] @xmath263    by construction , @xmath264 .",
    "second , the experimenter expands the system observable @xmath154 using the detector probability observables and unknown _ contextual values _",
    "( cvs ) @xmath265 and @xmath211 , @xmath266 after expressing this relation as the equivalent matrix equation , @xmath267 it can be directly inverted to find the cvs , @xmath268 therefore , @xmath269 so @xmath154 can be inferred from a measurement of the equivalent detector observable @xmath270 .    notably , the cvs are amplified from the eigenvalues of @xmath271 due to the _ ambiguity _ of the detector .",
    "the amplification compensates for the ambiguity so that the correct _ average _ can be obtained after measuring an ensemble of many unknown marbles described by the initial marble state @xmath142 .",
    "the amplification also leads to a larger upper bound for the variance of the detector , @xmath272 hence , we can expect the imperfect detector to display a root - mean - squared ( rms ) error in the reported average color that is no larger than @xmath273 after @xmath53 repeated measurements .",
    "for contrast , a perfect detector would display an rms error no larger than @xmath274 after @xmath53 repeated measurements .",
    "the detector apparatus in the last example could be generally _",
    "invasive_. in such a case , the characterization probabilities composing the probability observables would be a combination of the initial state of the detector lights @xmath143 and a _ disturbance _",
    "@xmath116 from the measurement coupling according to ,    @xmath275    where we have used the marginalization identity @xmath276 for @xmath277 and @xmath278 . for a noninvasive detector ,",
    "the transition probabilities that involve marbles changing color must be zero @xmath279 .",
    "however , they need not be zero for a general invasive detector .    as an example , suppose that the initial detector state is unbiased , @xmath280 , and that the detector has a 10% chance of flipping the color of a given marble .",
    "the following possible values for the sixteen transition probabilities would then lead to the same effective characterization probabilities as before ,    [ eq : marbledisturb ] @xmath281    since the effective characterization probabilities are the same , the probability observables are the same as , leading to the same cvs as to measure the observable @xmath259 .",
    "the disturbance of the reduced marble state will become apparent only when making a second measurement after the first one .",
    "suppose we make a second measurement of the marble colors @xmath256 and @xmath257 directly .",
    "the probability of obtaining a detector outcome @xmath278 and then observing a specific marble color @xmath277 will then be @xmath282 .",
    "if we define an _ operation _ as in to be , @xmath283 then we can express the probability for the sequence compactly as @xmath284 .",
    "averaging the outcomes for the detector lights using the cvs and then conditioning on a particular marble color @xmath285 in the second measurement produces a _ postselected conditioned average _ of the marble colors as reported by the invasive ambiguous detector , @xmath286{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\frac{f_y(b)\\ , { \\big\\langle \\mathcal{e}_b(c ) \\big\\rangle}_x + f_y(y)\\ , { \\big\\langle \\mathcal{e}_y(c ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}_b(c ) \\big\\rangle}_x + { \\big\\langle \\mathcal{e}_y(c ) \\big\\rangle}_x}. \\end{aligned}\\ ] ]    if we also preselect the marbles to be a particular color , we can compute the pre- and postselected conditioned averages of the marble colors as reported by the invasive ambiguous detector from , , and ,    [ eq : marblecondavs ] @xmath287{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{g } } } & = 1.125 , \\\\    { \\tensor[_{r}]{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{g } } } & = 0.5 , \\\\    { \\tensor[_{g}]{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{r } } } & = 0.5 , \\\\    { \\tensor[_{r}]{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{r } } } & = -1.375 . \\end{aligned}\\ ] ]    due to a combination of the invasiveness and the ambiguity of the measurement , the postselected conditioned averages can stray outside the eigenvalue range @xmath288 $ ] for the observable @xmath154 .",
    "however , they remain within the cv range @xmath289 $ ] .",
    "when the measurement is noninvasive , then the pre- and postselected conditioned averages in that remain well - defined reduce to the pure conditioned averages @xmath290 and @xmath291 .      consider a similar marble detection setup to the previous examples , but where the detector apparatus has _",
    "three _ independent outcome lights : blue , yellow , and purple .",
    "hence , the detector boolean algebra is @xmath292 , where @xmath293 is the new proposition for the purple light , and @xmath294 . after characterizing the detector",
    "the experimenter finds the conditional probabilities ,    @xmath295    that define the probability observables ,    @xmath296    by construction , @xmath297 .",
    "furthermore , @xmath298 , so the purple outcome can not distinguish whether the marble is green or red and can be imagined as a generic detector malfunction outcome .",
    "the experimenter now has a choice for how to assign cvs to a detector observable @xmath155 in order to infer the marble observable @xmath259 .",
    "a simple choice is to ignore the redundant ( and nondistinguishing ) purple outcome by zeroing out its cv @xmath299 , and then invert the remaining relationship analogously to to find @xmath300 and @xmath301 .",
    "the variance bound for this simple choice is @xmath302 , leading to a root - mean - squared error no larger than @xmath303 after @xmath53 repeated measurements .",
    "however , a better choice is to find the preferred values for all three outcomes using the pseudoinverse of the map between @xmath155 and @xmath154 . to do this",
    ", we write a matrix equation similar to that uses all three outcomes ,    [ eq : marblematrixredundant ] @xmath304    the pseudoinverse @xmath236 can be constructed by using the singular value decomposition , @xmath305 , where @xmath306 is an orthogonal matrix composed of the normalized eigenvectors of @xmath307 , @xmath308 is an orthogonal matrix composed of the normalized eigenvectors of @xmath309 , and @xmath310 is a diagonal matrix composed of the singular values of @xmath235 ( which are the square roots of the eigenvalues of @xmath307 and @xmath309 ) . after computing the singular value decomposition ,",
    "the pseudoinverse can be constructed as @xmath311 , where @xmath312 is the diagonal matrix constructed by inverting all nonzero elements of @xmath313 . performing this inversion we find the following preferred cv",
    ",    @xmath314    this preferred solution has the smallest variance bound of @xmath315 .    we find ( perhaps counterintuitively ) that even though the purple outcome itself can not distinguish the marble color , the fact that one obtains a purple outcome at all still provides some useful information to the experimenter due to the asymmetry of the blue and yellow outcomes",
    "indeed , if for the red marble we instead found the symmetric detector response @xmath316 , @xmath317 , and @xmath318 , the pseudoinverse would produce the preferred cvs @xmath319 , @xmath320 , and @xmath299 , indicating that the purple outcome was truly noninformative .",
    "a less principled approach to solving would be for the experimenter to assign a completely arbitrary value to one outcome , like @xmath321 .",
    "the cv relation still produces a matrix equation , @xmath322 that can be solved to find , @xmath323 the bound for the variance of this solution is @xmath324 ; the value of @xmath325 that minimizes the bound is @xmath326 , which recovers the pseudoinverse solution .",
    "although picking an arbitrary solution gives mathematically equivalent results , the experimenter will only increase the norm of the solution without any physical motivation .",
    "as such , the higher moments of the detector observable @xmath155 can be correspondingly larger , and more trials may be necessary for the estimated average of the system observable @xmath154 to reach the desired precision .",
    "consider the extreme example of a marble color detector that has a continuum of outcomes , such as the position of impact of a marble on a continuous screen .",
    "in such a case , the detector sample space @xmath135 is indexed by a real parameter @xmath327 , and the relevant boolean algebra @xmath139 can be chosen to be the set of all borel subsets of the real line @xcite .",
    "after characterizing the detector , the experimenter finds that the detector displaces its initial probability distribution @xmath328 by an amount @xmath29 from the zero - point according to which marble - color is sent into the detector , @xmath329 these probabilities define the probability observables , @xmath330 such that @xmath331 .    to infer information about the marble observable @xmath154 using this detector ,",
    "the experimenter must assign a continuum of cvs @xmath211 such that , @xmath332 or in matrix form , @xmath333 = \\begin{pmatrix}\\int_\\mathbb{r } f_y(y ) \\ , dp_y(y - z ) \\\\",
    "\\int_\\mathbb{r } f_y(y ) \\ , dp_y(y+z)\\end{pmatrix}.\\end{aligned}\\ ] ] since @xmath334 is a function , @xmath235 is a vector - valued functional , which is why we adopt the square - bracket notation .    in this case , the detector outcomes are overwhelmingly redundant .",
    "however , we can pick the least norm solution using the pseudoinverse of the map @xmath235 as before . to do so , we first calculate @xmath307 ,    @xmath335    where ,    [ eq : marblecont ] @xmath336    and we find its eigenvalues of @xmath337 with corresponding normalized eigenvector @xmath338 and @xmath339 with corresponding normalized eigenvector @xmath340",
    ". we can then construct the orthogonal matrix @xmath306 composed of the normalized eigenvectors of @xmath307 and the diagonal matrix @xmath310 composed of the square roots of the eigenvalues of @xmath307 , @xmath341    next we calculate the relevant eigenfunctions of @xmath309 that correspond to the same nonzero eigenvalues @xmath342 of @xmath307 ; the remaining eigenfunctions belong to the nullspace of @xmath235 and do not contribute .",
    "specifically , we have , @xmath343(y ) = & p_y(y - z)\\int_\\mathbb{r } h(y)\\ , dp_y(y - z ) \\\\    & + p_y(y+z)\\int_\\mathbb{r }",
    "h(y ) dp_y(y+z ) , \\nonumber\\end{aligned}\\ ] ] where @xmath344 is an arbitrary function .",
    "then the equations ,    @xmath345(y ) = & ( a + b(z))\\ , v_+(y ) , \\\\",
    "\\mathcal{s}^t\\mathcal{s}[v_-](y ) = & ( a - b(z))\\ , v_-(y ) , \\end{aligned}\\ ] ]    define the normalized eigenfunctions ,    @xmath346    which allows us to construct the relevant part of the orthogonal map @xmath347 , @xmath348 & = \\begin{pmatrix}\\int v_+(y)h(y)\\ , dy & \\int v_-(y)h(y)\\ , dy \\end{pmatrix},\\end{aligned}\\ ] ] completing the nonzero part of the singular value decomposition of @xmath305 .",
    "finally , we construct the pseudoinverse , @xmath349 and solve for the cv , @xmath350 where @xmath2 and @xmath351 are as defined in .",
    "the pseudoinverse solution contains only the physically relevant detector state density @xmath352 and provides direct physical intuition about the detection process .",
    "namely , everything in the shifted distribution corresponding to the green marble @xmath353 is associated with the eigenvalue @xmath354 , while everything in the shifted distribution corresponding to the red marble @xmath355 is associated with the eigenvalue @xmath1 . the overall amplification factor",
    "@xmath339 indicates the discrepancy between the overlap of the shifted distributions and the distribution autocorrelation .",
    "the more the shifted distributions overlap , the more ambiguous the measurement will be , so the amplification factor makes the cvs larger to compensate . if the shifted distributions do not overlap , then @xmath356 and the only amplification comes from the autocorrelation @xmath2 that indicates the ambiguity of the intrinsic profile of the detector state .",
    "moreover , the support of the cvs is equal to the support of both shifted detector distributions , which is physically satisfying .",
    "the bound for the detector variance using the pseudoinverse solution is @xmath357 $ ] , which depends solely on the amplification factor in the denominator . if the measurement is strong , such that @xmath358 , then the variance bound reduces to the ideal variance bound of @xmath359 , as expected , leading to a maximum rms error of @xmath360 .",
    "any additional ambiguity of the measurement stemming from distribution overlap or distributed autocorrelation amplifies the maximum rms error by a factor of @xmath361}$ ] .",
    "contrast these preferred values with the generic linear solution @xmath362 , which also satisfies when @xmath352 is symmetric about its mean @xcite .",
    "while the generic solution could be argued to be simpler in form , it provides no information about the detector and provides no physical insight into the meaning or origin of the values themselves .",
    "it has nonzero support in areas where the detector has zero support and even gets progressively larger in regions that will not contribute to the average .",
    "moreover , the bound for the detector variance diverges , indicating that the rms error can in principle be unbounded .",
    "hence , despite the mathematical equivalence , the linear solution is _ physically _ inferior as a solution when compared to the pseudoinverse .",
    "to transition from the classical theory of probability to the quantum theory we shall take a somewhat unconventional approach that leverages what we have already derived in the classical theory .",
    "specifically , we shall construct the quantum theory as a superstructure over the existing classical theory , rather than developing it as an independent logical system @xcite or as a restriction of a larger classical theory @xcite .",
    "this approach serves to illustrate the myriad similarities between the quantum and classical theories , while also highlighting their key differences .",
    "we shall see that the contextual - value formalism is essentially unchanged , despite the modifications that must be made to the operational theory of measurement .",
    "_ quantum sample space_.the quantum theory of probability forms a superstructure on the classical theory of probability in the following sense : given a classical sample space @xmath14 , the corresponding quantum sample space can be obtained as the orbit of @xmath14 under the action of the special unitary group of rotations .",
    "that is , the entire classical sample space @xmath14 can be rotated to a different classical sample space @xmath363 with some special unitary rotation @xmath306 .",
    "we call each classical sample space generated in this fashion a _ framework _ to be consistent with other recent work @xcite .",
    "the collection of all such continuously connected classical sample spaces is the quantum sample space , which we will notate as @xmath364 to emphasize that it can be generated from @xmath14 .",
    "_ representation_.if the sample space @xmath14 is represented as a set of orthogonal rank-1 projections @xmath51 on a hilbert space , the rotated sample space @xmath365 will be represented by a different set of orthogonal projections @xmath366 on the same hilbert space .",
    "any such rotation @xmath306 can be given a spinor representation ( see , e.g. , @xcite ) as a two - sided product with a rotor @xmath367 belonging to the special unitary group , such that @xmath368 , and @xmath369 .",
    "the _ involution _ ( @xmath370 ) is the adjoint with respect to the inner product of the hilbert space .",
    "while the projections @xmath51 correspond to subspaces spanned by vectors @xmath52 in the hilbert space , the rotated projections @xmath371 correspond to subspaces spanned by rotated vectors @xmath372 . in what follows",
    "we shall tend to use the shorter algebraic notation @xmath27 and adopt the equivalent hilbert space notation @xmath373 only when it readily simplifies expressions .",
    "since the hilbert space representation of a unitary rotor @xmath367 generally contains complex numbers in order to satisfy the special unitary group relations , the hilbert space also becomes _",
    "complex_. however , it is important to note that the complex structure arises solely from the representation of the unitary rotations that specify the relative framework orientations and will not appear directly in any calculable quantity to follow @xcite .",
    "the representation of the quantum sample space @xmath364 therefore consists of all possible rank-1 projections on the complex hilbert space in which the classical sample space @xmath14 is represented .",
    "_ quantum observables_.each classical framework @xmath14 has an associated boolean algebra @xmath374 and space of observables @xmath375 exactly as previously discussed .",
    "the space of quantum observables is the collection of all classical observables that are independently constructed in all the classical frameworks in @xmath376 .",
    "we will denote this space as @xmath377 .",
    "quantum observables are therefore constructed entirely with real numbers that have empirical meaning for a laboratory setting ; hence , their representations on a complex hilbert space will be hermitian operators .    for observables in the same framework @xmath378 , we find that @xmath379 , meaning that the rotations preserve their algebraic structure . as a corollary , all observables in @xmath377",
    "can be obtained by rotating observables constructed in a single framework @xmath16 ; hence , our previous discussion of observables carries over to the quantum theory essentially unaltered .",
    "furthermore , the independence of the propositions in a framework @xmath14 remains unaltered by unitary rotation , so every other framework @xmath380 has the same number of independent propositions .",
    "thus , the number of independent propositions is an invariant known as the _ quantum dimension _ ; for a representation it fixes the dimension of the hilbert space .",
    "similarly , the identity and zero observables are invariants , so are the same in every framework and unique in the quantum observable algebra .    since each different framework forms a separate well - behaved classical sample space , the entire preceding discussion about classical probability theory applies unaltered when restricted to a particular framework in the quantum theory .",
    "all observables constructed in a particular framework will commute with each other .",
    "we expect distinctly quantum features to appear only when comparing elements from different frameworks .",
    "_ noncommutativity_.the unitary rotations @xmath306 are generally _ noncommutative _ and so introduce noncommutativity into the quantum theory that is not present in the classical theory .",
    "specifically , given @xmath381 , @xmath382 , and @xmath383 , then @xmath384 , since @xmath367 and @xmath385 do not necessarily commute with each other or with @xmath386 and @xmath325 .",
    "such noncommutativity is a manifestation of the fact that the boolean algebras corresponding to different frameworks are _ incompatible _ with each other ; propositions from one framework can not form a boolean logical _ and _ with propositions from a different framework .",
    "we shall see in the next section , however , that the notion of _ disturbance _ followed by a logical _ and _ can be generalized to the noncommutative setting in the form of the projection postulate .",
    "_ disturbance_.all nonconditioning disturbances @xmath116 in the quantum theory also take the form of unitary rotations @xmath306 .",
    "indeed , we shall see that the parallels between the quantum theory and the classical theory with disturbance are quite strong when one interprets all unitary rotations as a form of classical disturbance .",
    "_ time evolution_.as an example , the continuous time - evolution of a closed quantum system is specified by a disturbance in the form of a unitary rotation @xmath387 with corresponding rotor @xmath388 , known as a _",
    "propagator_. for nonrelativistic quantum mechanics , the time - dependence of the rotor is specified by the schrdinger equation : @xmath389 and a hamiltonian observable @xmath390 that generates the time translation .",
    "we are not concerned with the ( well - established ) details of continuous time - evolution in this paper , so we will treat any unitary rotations as given in what follows .      as an example quantum system we shall pick the simplest possible nontrivial system : a qubit .",
    "specifically , we will consider the polarization degree of freedom of a laser beam .",
    "suppose we are interested in measuring the linear polarization of the beam with respect to the surface of an optical table .",
    "we denote the polarization direction parallel to the table as `` horizontal '' ( @xmath344 ) and the direction perpendicular to the table as `` vertical '' ( @xmath391 ) .",
    "although we casually refer to the polarizations @xmath344 and @xmath391 as if they were properties of the light beam , the propositions @xmath344 and @xmath391 operationally refer to two independent outcomes of a polarization distinguishing device , such as a polarizing beam splitter , that can be implemented in the laboratory .",
    "the two orthogonal polarizations form a classical sample space @xmath392 and a classical boolean algebra @xmath393 , where @xmath394 , similar to the classical sample space for the marble colors considered in sec . [",
    "sec : cmarble ] . by extending the boolean algebra over the reals to @xmath13 as before we can define classical observables @xmath395 in this sample space , such as the stokes observable @xmath396 that distinguishes the polarizations with a sign .",
    "we can represent the commutative observable algebra @xmath13 as diagonal @xmath397 matrices , @xmath398 which can also be understood as commuting hermitian operators over a two - dimensional hilbert space .",
    "the atomic propositions @xmath399 and @xmath400 are projectors that correspond to disjoint subspaces spanned by the orthonormal jones polarization basis for the hilbert space , @xmath401    to obtain the full quantum sample space @xmath376 from @xmath14 , we introduce the group of possible polarization rotations .",
    "algebraically , an arbitrary rotation @xmath402 can be readily understood in terms of its rotor @xmath367 , which is an element of the group su(2 ) and can be parametrized , for example , in terms of the cartan decomposition @xmath403 , which for a qubit happens to correspond to an euler angle decomposition of a three - dimensional rotation . here",
    "@xmath404 and @xmath405 are two of the three generators of the lie algebra for su(2 ) in terms of the standard pauli matrices , @xmath406 since the group generators have a complex representation , the unitary rotation @xmath407 will also have a complex representation in the hilbert space ,    [ eq : polunitary ] @xmath408    the algebraic involution @xmath409 is the complex transpose in the matrix representation .",
    "physically , the factor @xmath410 corresponds to a rotation of the apparatus around the axis of the light beam by an angle @xmath411 , while the factors @xmath412 and @xmath413 correspond to the action of phase plates that shift the relative phases of @xmath344 and @xmath391 by @xmath414 and @xmath415 , respectively .",
    "hence , the ubiquitous quantum phase also appears as a consequence of the unitary rotations .",
    "using the unitary rotations , we can generate other incompatible frameworks @xmath416 in @xmath376 ,    @xmath417\\\\    \\mathcal{u}_{\\alpha,\\beta,\\gamma}(v ) & = u^\\dagger_{\\alpha,\\beta,\\gamma } v u_{\\alpha,\\beta,\\gamma } , \\\\    & = \\begin{pmatrix}\\sin^2\\frac{\\beta}{2 } & -\\frac{1}{2}e^{-i\\gamma}\\sin\\beta \\\\ -\\frac{1}{2}e^{i\\gamma}\\sin\\beta & \\cos^2\\frac{\\beta}{2}\\end{pmatrix } , \\nonumber\\end{aligned}\\ ] ]    which depend solely on the two parameters @xmath418 and @xmath419 .",
    "the atomic propositions of such a rotated framework are projectors corresponding to each disjoint subspace spanned by a rotated orthonormal jones polarization basis ,    @xmath420    physically , one could in principle construct an apparatus corresponding to such a rotated framework using three laboratory elements : ( 1 ) attach a tunable phase plate to the incident port of a polarizing beam splitter with the fast axis aligned to the table , ( 2 ) rotate both the beam splitter and attached phase plate with respect to the table , and ( 3 ) attach a second tunable phase plate to the incident port of the first phase plate with the fast axis aligned to the table . of course this is only one possible parametrization for the unitary rotations ; other parametrizations will correspond to other experimental implementations .",
    "it follows that any observable in the full quantum observable space @xmath421 can be obtained by rotating a classical observable @xmath395 to the appropriate framework , @xmath422 we see that a general qubit observable depends on four parameters : the eigenvalues @xmath2 and @xmath3 , as well as the framework orientation angles @xmath418 and @xmath419 .",
    "the complex representation of an observable stems solely from the unitary rotation of the atomic propositions @xmath344 and @xmath391 to a different relative framework .",
    "the observables no longer generally commute since the unitary rotations need not commute .      _",
    "quantum states_.a quantum state @xmath17 is a classical state defined in a particular framework @xmath14 that is then extended to apply to the entire quantum boolean algebra @xmath423 .",
    "the extension of a classical state @xmath17 that has been defined in a framework @xmath14 to a proposition @xmath424 in a different framework can be accomplished by heuristically breaking down the state into a composition of the classical state in framework @xmath14 and _ transition probabilities _",
    "that connect the framework @xmath14 to the different framework @xmath380 , @xmath425 the transition probabilities characterize a _ disturbance _ that connects the classical state @xmath17 to propositions in incompatible frameworks .    to define the transition probabilities",
    ", we assume that atomic propositions in the framework @xmath14 are undisturbed , so @xmath426 . the only classical state with this property",
    "is the pure state which has a trace - density @xmath427 .",
    "hence , we assume that we can consistently write the transition probability @xmath118 in terms of the extension of the _ trace _ to the full boolean algebra @xmath423 , @xmath428 notably , this definition makes the transition between frameworks symmetric .    _",
    "born rule_.we pick the trace extension to be the unique measure that satisfies the cyclic property @xmath429 for all @xmath430 and agrees with the classical trace within any specific framework @xcite . on a hilbert space ,",
    "has the familiar form , @xmath431 which we immediately recognize as the _ born rule _ @xcite .",
    "hence , the complex square of the hilbert space inner product can be seen as a disguised form of the natural extension of the trace to define transition probabilities between propositions in incompatible frameworks .",
    "if we recall that @xmath432 we can also write the transition probability in terms of the unitary rotor that connects the two propositions , @xmath433 .",
    "_ density operator_.we can rewrite in a more familiar form by using the born rule and the full trace - density of the original state @xmath434 , which is traditionally known as the _ density operator _",
    ", @xmath435 this form of the probability functional conforms to _ gleason s theorem _ @xcite .",
    "we note , however , that it is the extension of the _ trace _ that extends the state to the noncommutative quantum setting since the trace - density @xmath100 is identical to a classical trace - density in some particular framework @xmath14 .",
    "_ moments_.since the probabilities @xmath436 are well - defined for a proposition in any framework @xmath437 , we can linearly extend @xmath17 to an expectation functional @xmath19 on the entire quantum observable algebra @xmath438 , @xmath439 similarly , observable moments will be well - defined by the expectation functional , @xmath440 hence , the unitary rotations and resulting extension of the trace completely construct the quantum probability space from a single classical probability space and its associated observables .    _",
    "double - sided and_.to be consistent with the assumptions made in , we must also ensure that conditioning a quantum state on an atomic proposition will collapse the state to a pure state with a trace - density equal to that atomic proposition .",
    "in other words , we must generalize the logical and of the classical case to the noncommutative incompatible frameworks in the quantum case .",
    "the consistent way to do this is through a _ double - sided product _ : given atomic propositions @xmath34 and",
    "@xmath437 then @xmath441 .    the double - sided product with @xmath119 produces a _ transition probability _",
    "@xmath118 from @xmath27 to @xmath119 as a proportionality factor in addition to collapsing the original proposition @xmath27 to @xmath119 . in this sense ,",
    "the double - sided product includes a form of _ disturbance _ in addition to the logical _ and _ of pure conditioning .",
    "if @xmath442 , so the frameworks coincide , then @xmath27 and @xmath119 will commute ; the disturbance will vanish , reducing the transition probability @xmath118 to either @xmath32 or @xmath0 ; and , the classical and will be recovered as a special case .    _",
    "lders rule_.using the double - sided product as a disturbance followed by a logical @xmath443 , we find the quantum form of the _ invasive conditioning rule _ ,    [ eq : qcollapse ] @xmath444    for any boolean proposition @xmath28 in a framework algebra @xmath15 measured prior to the observable @xmath154 . as with the classical case",
    ", we use the tilde to indicate the intrinsic quantum invasiveness of the measurement process . if @xmath100 and @xmath28 commute , or if @xmath154 and @xmath28 commute , then the noninvasive classical conditioning rule is properly recovered .",
    "this generalization of is known as the projection postulate , or _",
    "lders rule _",
    "if @xmath28 is an atomic proposition in @xmath14 , then @xmath445 as in the classical case and we consistently recover the assumption .",
    "for contrast , @xcite provide a careful quantum generalization of the _ noninvasive _ conditioning rule using a formalism based around conditional density operators .",
    "they confirm that lder s rule can not be obtained with pure conditioning , so it must imply additional disturbance from the measurement process itself , as indicated here .",
    "_ aharonov - bergmann - lebowitz rule_.just as with classical invasive conditioning , the order of conditioning will generally matter . specifically , substituting a system proposition @xmath111 into yields @xmath446 ; however , @xmath447 , so the `` joint probability '' in the numerator is order - dependent unless @xmath28 and @xmath29 commute , just as in .",
    "that is , @xmath207 explicitly describes the case when the conditioning proposition @xmath28 is measured first as a _ preselection _ , followed by the proposition @xmath29 .",
    "to obtain the converse case when the conditioning proposition @xmath29 is measured second as a _ postselection _ , we must derive the quantum form of .",
    "as in the classical case , we reinterpret the denominator of as a marginalization @xmath448 of the ordered joint probability that renormalizes the conditioning procedure ; the identity @xmath449 permits the equality . with this interpretation ,",
    "the postselected form of conditioning becomes straightforward , @xmath450{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } = \\frac{p(yzy)}{\\sum_{y'\\in y } p(y'zy')}.\\end{aligned}\\ ] ] as in the classical case , the different position of the subscript serves to distinguish the two conditioned expectations @xmath451 and @xmath200{{{\\big\\langle \\widetilde { \\,\\cdot\\ , } \\big\\rangle}}}{}}$ ] corresponding to different measurement orderings .    for a pure state @xmath452",
    ", this postselected conditioning is known as the _ aharonov - bergmann - lebowitz ( abl ) rule _",
    "@xcite , and has the form @xmath200{{{\\big\\langle \\widetilde { y } \\big\\rangle}}}{_{x } } } = |{\\langle z | y \\rangle}|^2|{\\langle y | x \\rangle}|^2 / \\sum_{y'\\in y}|{\\langle z | y ' \\rangle}|^2|{\\langle y ' | x \\rangle}|^2 $ ] . unlike lders rule , the generalized abl rule does not perform a simple update to the trace - density @xmath100 ; moreover , it depends on the entire disturbance of the first measurement via the normalization sum in the denominator .",
    "if @xmath28 and @xmath29 commute , then the disturbance vanishes and we again correctly recover the classical case that is order - independent .    _",
    "bayes rule_.the two forms of quantum invasive conditioning also lead to a modified form of bayes rule that relates the preselected conditioning of a sequence to the postselected conditioning of the same sequence , similarly to the classical case , @xmath453{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } = { { \\big\\langle \\widetilde { z } \\big\\rangle}}_y \\frac{p(y)}{\\sum_{y'\\in y } p(y'zy')}.\\end{aligned}\\ ] ] if @xmath28 and @xmath29 commute , then the disturbance vanishes and we correctly recover bayes rule .    the unusual form of has led to postselected quantum conditioning being largely overlooked .",
    "the lack of symmetry in the density update under such postselected conditioning has even prompted works in multistate - density time - symmetric reformulations of quantum mechanics @xcite , which are outside the scope of this work .",
    "however , we see here that the form of the conditioning is the same as the classically _ invasive _ postselected conditioning .",
    "later we shall use a fully generalized form of the abl rule together with cvs to consider the subtle case of postselected averages of observables in some detail , so we delay their consideration for now .",
    "a quantum state for a single system is a classical state in some particular framework .",
    "for a two - dimensional framework such as @xmath454 , all probabilities for such a classical state can be completely specified by a mixing angle @xmath455 such that @xmath456 and @xmath457 .",
    "hence , after rotating the trace - density @xmath458 to an arbitrary framework according to , any quantum state trace - density of polarization must have the form , @xmath459 the @xmath460 parameter of the rotation disappears in favor of the @xmath455 parameter characterizing the classical state , leaving only three net parameters , in contrast to the four parameters of an arbitrary observable .",
    "the expectation functional @xmath461 is then defined from the trace - density @xmath462 and the unique extension of the trace @xmath96 to the whole observable algebra @xmath421 according to @xmath463 .",
    "the trace extension is the sum of the diagonal matrix elements in the matrix representation .",
    "hence for the expectation of an arbitrary observable under an arbitrary state we find ,    @xmath464    where @xmath465 $ ] is an interference factor that depends only on relative orientation between the state framework and the observable framework .",
    "if the frameworks coincide , then @xmath466 and the classical result is recovered .      _ joint observable space_.as with the classical case , we can couple a system to a detector by enlarging the sample space to the product space @xmath150 of a particular pair of frameworks .",
    "we can then perform _ local _ unitary rotations on each space independently to form a joint quantum sample space from the classical joint observables @xmath467 .",
    "however , the quantum observable space also admits _ global _ unitary rotations on the classical joint observables to form a larger joint quantum sample space @xmath468 .",
    "just as with a single sample space , any two propositions in @xmath468 can be continuously connected with some global unitary rotation .",
    "the full quantum observable space @xmath469 is constructed from @xmath468 in the usual way .",
    "product observables will maintain their product form under local unitary rotations , @xmath470 .",
    "however , global unitary rotations can create unfactorable correlated joint observables in @xmath469 even from product observables @xmath471 .    _ joint states_.similarly , joint _ states _ on a classical product framework extend to joint quantum states on the quantum product observable space . under local unitary rotations ,",
    "product states remain product states and classically correlated states between two specific frameworks remain classically correlated . however , _",
    "global _ unitary rotations performed on any state can also form _ entangled _ states that have no analog in the classical theory @xcite .",
    "entangled states have some degree of _ local - rotation - independent _ correlation between frameworks , so display a stronger degree of correlation than can even be defined with a classically correlated state that is restricted to a single pair of frameworks . as an extreme example , maximally entangled states are completely local - rotation - independent and perfectly correlated with respect to any pair of frameworks .",
    "_ quantum operations_.the specifics of entanglement do not concern us here , since any type of correlation is sufficient to represent detector probabilities within the reduced system space .",
    "for the purposes of measurement , we only assume that the correlated state with density @xmath472 is connected to some initial product state with density @xmath473 via a unitary rotation @xmath474 .",
    "since all quantum states can be continuously connected with some global unitary rotation that acts as a disturbance , this is always possible .",
    "physically , the unitary rotation couples the known detector state @xmath475 to an unknown system state @xmath476 .",
    "furthermore , we assume that the initial state of the detector has some ( not necessarily unique ) pure - state expansion that is meaningful with respect to the preparation procedure @xmath477 .",
    "it then follows that the numerator for the conditioning rules and becomes , @xmath478\\\\    & = { \\big\\langle \\mathcal{e}_y(f_x ) \\big\\rangle}_x = \\text{tr}_x(\\mathcal{e}^\\dagger_y(\\rho_x )",
    "f_x ) , \\nonumber \\displaybreak[0]\\end{aligned}\\ ] ] with the _ operations _ @xmath190 and @xmath479 defined as ,    [ eq : qmeasoper ] @xmath480\\\\    \\label{eq : qoperad }    \\mathcal{e}^\\dagger_y(\\rho_x ) & = \\text{tr}_y(yu\\rho_x\\rho_yu^\\dagger y ) , \\\\    & = \\sum_{y'\\in y ' } p'(y ' ) \\text{tr}_y(y u \\rho_x y ' u^\\dagger y ) , \\nonumber \\\\    & = \\sum_{y'\\in y ' } m_{y , y ' } \\rho_x m^\\dagger_{y , y ' } , \\nonumber \\displaybreak[0]\\\\    \\label{eq : qmeasops }    m_{y , y ' } & = e^{i\\phi_{y , y ' } } \\sqrt{p'(y ' ) } { \\langle y|}u{|y'\\rangle } , \\\\",
    "m_{y , y'}^\\dagger & = e^{-i\\phi_{y , y ' } } \\sqrt{p'(y ' ) } { \\langle y'|}u^\\dagger{|y\\rangle}.\\end{aligned}\\ ] ]    here , the hilbert space representations of the _ kraus operators _ @xmath481 have the form of partial matrix elements and are only well - defined up to the arbitrary phase factors @xmath482 .",
    "we also stress that @xmath481 depend not only on the measured detector outcome @xmath28 , but also on a particular detector _ preparation _ @xmath483 .    as a result",
    ", we find the quantum versions of the probability observables , @xmath484 and the general invasive measurement , @xmath485    similarly to the invasive classical case , the measurement of @xmath28 on the detector must be described by a _ quantum operation _",
    "@xmath190 in , which is a completely positive map @xcite that performs a _ generalized measurement _ on the system state corresponding to the detector outcome @xmath28 .",
    "the operation @xmath190 acting on the identity in produces a positive operator known as a _ quantum effect _ , @xmath486 . by construction ,",
    "the set of operations @xmath220 preserves the identity , @xmath487 ; hence , the effects form a partition of the identity , @xmath488 , making them probability observables over a particular detector framework exactly as in .",
    "sequences of measurements emphasize the temporal ordering of operations , just as in the invasive classical case . given two sets of quantum operations that define the sequential interaction of two detectors with the system and their subsequent conditioning , @xmath220 and @xmath489 , the joint probability of the ordered sequence of detector outcomes @xmath195 is , @xmath490 where @xmath491 .",
    "the proper sequential probability observable @xmath492 is not a simple product of the individual probability observables @xmath486 and @xmath493 .",
    "these sequence probabilities then give us the full generalization of the abl rule , @xmath494{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } & = \\frac{{\\big\\langle \\mathcal{e}_y(e'_z ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(e'_z ) \\big\\rangle}_x } = \\frac{{\\big\\langle \\mathcal{e}_y(e'_z ) \\big\\rangle}_x}{\\sum_{y''\\in y}{\\big\\langle \\mathcal{e}_{y''}(e'_z ) \\big\\rangle}_x } , \\\\    & = \\frac{\\sum_{y'\\in y ' } \\text{tr}_x(\\rho_x m^\\dagger_{y , y'}e'_z m_{y , y'})}{\\sum_{y''\\in y}\\sum_{y'\\in y ' } \\text{tr}_x(\\rho_x m^\\dagger_{y'',y'}e'_z m_{y'',y ' } ) } , \\nonumber\\end{aligned}\\ ] ] and the most general version of the invasive quantum bayes rule , @xmath495{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } & = { { \\big\\langle \\widetilde { e'_z } \\big\\rangle}}_y \\frac{{\\big\\langle e_y \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(e'_z ) \\big\\rangle}_x } , \\end{aligned}\\ ] ] as with and , the postselected conditioning depends on the entire disturbance of the first measurement via the _ nonselective measurement _",
    "@xmath496 in the denominator .",
    "the noncommutativity of the detection operations @xmath190 emphasizes the fact that measurement is an active _ process _ : an experimenter alters the quantum state by coupling it to a detector and then conditioning on acquired information from the detector . without some filtering process that completes the disturbance implied by , there is no measurement .",
    "the nonselective measurement @xmath203 also includes the active disturbance of the measurement process , but does not condition on a particular outcome .",
    "furthermore , measuring a quantum state in a different order generally disturbs it differently",
    ". the state may also in certain conditions be probabilistically `` uncollapsed '' back to where it started by using the correct conditioning sequence @xcite . in this sense ,",
    "sequential quantum conditioning is analogous to a stochastic control process that guides the progressive disturbance of a state along some trajectory in the state space @xcite .",
    "_ measurement operators_.since the quantum operation @xmath190 performs a measurement , we will refer to its kraus operators @xmath481 as _ measurement operators_. however , a quantum operation generally has many equivalent double - sided product expansions like in terms of measurement operators .",
    "each such set of measurement operators @xmath481 corresponds to a specific choice of framework for the preparation of the detector state @xmath497 .",
    "given a specific set of measurement operators , the substitution @xmath498 with unitary @xmath499 will produce the same effect @xmath486 according to but will correspond to a different operation @xmath500 .",
    "hence , we conclude that many measurement operations can produce the same probability observables on the system space @xcite .",
    "therefore , _ probability observables are not sufficient to completely specify a quantum measurement _ : one needs to specify the full operations as in the classically invasive case .    _ quantum process tomography_.just as classical probability observables can be characterized via process tomography , operations can be characterized by _ quantum process tomography_. one performs quantum process tomography by sending known states into a detector , measuring the detector , then measuring the resulting states to see how the state was changed by the detector .",
    "since quantum operations contain information about disturbance as well as conditioning , quantum process tomography generally requires more characterization measurements than pure classical process tomography .",
    "_ pure operations_.an initially pure detector state with density @xmath483 produces a _ pure operation _",
    "@xmath501 with a single associated measurement operator @xmath502 that is unique up to the arbitrary phase factor @xmath503 .",
    "most laboratory preparation procedures for the detector are designed to produce a pure initial state , so pure operations will be the typical case .",
    "a pure operation has the additional property of partially collapsing a pure state to another pure state .",
    "it is also most directly related to the probability observable @xmath504 , since the single measurement operator has a polar decomposition @xmath505 in terms of the positive root of the probability observable @xmath506 .",
    "_ weak measurement_.if we wish for such a conditioning process to leave the state approximately unchanged , we must make a _ weak measurement _ , just as in the classical case .",
    "however , a quantum weak measurement requires a strict condition regarding the measurement operations and not just the probability observables due to the additional disturbance in the measurement .",
    "formally , the measurement operations typically depend on a measurement strength parameter @xmath176 such that , @xmath507 where @xmath239 is the identity operation and @xmath508 is the probability for obtaining the detector outcome @xmath28 in the absence of interaction . as with the classical case , the limit as @xmath180 is an idealization known as the _ weak measurement limit _ and is not strictly achievable in the laboratory .",
    "the definition implies that subsequent measurements will be unaffected , @xmath509 , and that the probability observables are proportional to the identity in the weak limit , @xmath510 , just as in the classical case .",
    "it also follows that any set of measurement operators @xmath511 that characterize @xmath512 must also be proportional to the identity in the weak limit @xmath513 .",
    "weak measurements are more interesting in the quantum case than in the classical case due to the existence of incompatible frameworks . since a weak measurement of an observable does not appreciably affect the quantum state , subsequent measurements on incompatible observables can be made that will probe approximately the same state .",
    "this technique allows ( noisy ) information about two incompatible frameworks to be gleaned from nearly the same quantum state in a single experiment , which is strictly impossible using strong measurements that collapse the state to a pure state in a particular framework after each measurement .",
    "the penalty for using weak measurements is that many more measurements are needed than in the strong measurement case to overcome the ambiguity of the measurement , as discussed in the classical case .          to cement these ideas",
    ", we consider the task of indirectly measuring polarization in a particular framework . for specificity , we will consider the passage of a laser beam with unknown polarization through a glass microscope coverslip , as shown in fig .",
    "[ fig : coverslip ] .",
    "fresnel reflection off the coverslip leads to a disparity between transmission and reflection of the polarizations , so comparing transmitted to reflected light allows a generalized measurement of polarization , as we demonstrated experimentally in @xcite .",
    "the system sample space we wish to measure is the polarization with respect to the table ( @xmath399 ) and ( @xmath400 ) , which could in principle be measured ideally with a polarizing beam splitter .",
    "the detector sample space is the spatial degree of freedom of the transmitted ( @xmath514 ) and reflected ( @xmath515 ) ports of a coverslip rotated to some fixed angle with respect to the incident beam around an axis perpendicular to the table .",
    "the initial state of the detector is the pure state indicating that the beam enters a single incident port ( @xmath516 ) of the coverslip with certainty .",
    "the rotation @xmath517 that couples the system to the detector describes the interaction of the beam with the coverslip and has a unitary rotor @xmath367 corresponding to the polarization - dependent scattering matrix of the coverslip . assuming that the scattering preserves beams of pure polarization ,",
    "so @xmath344 remains @xmath344 and @xmath391 remains @xmath391 , the rotor decouples into a direct sum of rotors that are specific to each polarization , @xmath518 meaning that @xmath367 has a block - diagonal structure when represented as a matrix .    selecting each output port of",
    "the coverslip produces the two _ measurement operators _ according to ,    [ eq : polmeasops ] @xmath519    which characterize the _ pure measurement operations _ that modify observables according to ,    [ eq : polpmo ] @xmath520    and their adjoints that modify the state density according to ,    [ eq : polpmoa ] @xmath521    the pure measurement operations in turn produce _",
    "probability observables _ according to ,    [ eq : polpo ] @xmath522    in the same framework as @xmath344 and @xmath391 .",
    "these probability observables are therefore equivalent to classical probability observables specified by the effective characterization probabilities @xmath523 , @xmath524 , @xmath525 , and @xmath526 .",
    "the measurement operators have a polar decomposition in terms of the roots of the probability observables and an extra unitary phase contribution ,    [ eq : polmeasops2 ] @xmath527    any nonzero relative phase , such as @xmath528 , will affect the framework orientation for subsequent measurements ; however , it will not contribute to the acquisition of information from the measurement since it does not contribute to the probability observables .",
    "such relative phase is therefore part of the _ disturbance _ of the measurement process .",
    "specifically , the initial state of polarization @xmath142 will be conditioned by a selection of a particular port on the detector according to ,    @xmath529    although the probabilities in each denominator only depend on the probability observables , the altered states in each numerator depend on the measurement operations and will include effects from the relative phase in the measurement operators .      _",
    "operation correspondence_.the introduction of contextual values in the quantum case proceeds identically to the classical case of invasive measurements . since we must generally represent detector probabilities by _ operations _ @xmath220 within the reduced system space according to and , we must also generally represent detector observables by _ weighted operations _ within the reduced system space ,",
    "@xmath530 if we are concerned with only a single measurement , or are working within a single framework as in the classical formalism , then for all practical purposes the operation @xmath229 reduces to its associated system observable @xmath531 as in the classical definition .",
    "_ contextual values_.we observe a corollary exactly as in the classical case : if we can expand a _ system _ observable in terms of the probability observables generated by a particular measurement operation , then that observable can also be expressed as an equivalent _ detector _",
    "observable , @xmath532 which is the quantum form of our main result originally introduced in @xcite . as in the classical case",
    ", we dub the required detector labels @xmath211 the * contextual values * ( cv ) of the quantum observable @xmath154 with respect to the _ context _ of a specific detection scheme as represented in the system space by the measurement operations @xmath220 .",
    "since many measurement operations produce the same probability observables @xmath533 , many detection schemes can use the same cvs to reproduce an observable average .    _",
    "moments_.as with classically invasive measurements , higher statistical moments of the observable require more care to measure .",
    "for instance , we require the following equality in order to accurately reproduce the @xmath53^th^ moment of an observable indirectly using the same cv , @xmath534 however , as indicated in , performing a sequence of @xmath53 measurements produces the measurable probability @xmath535 .",
    "indeed , @xmath536 will not generally be a well - formed probability . to obtain the equality with a particular choice of cv",
    ", we need the additional constraint that _ all the measurement operators must commute with each other_. as a result , they must be part of the same framework as the system observable and hence commute with that observable as well .",
    "we will call any detector with commuting measurement operators with respect to a particular observable a _ fully compatible detector _ for that observable .",
    "evidently , this is a strict requirement for a detector .    alternatively , as with the classical case",
    ", we can change the cvs to define new observables that correspond to powers of the original observable , such as @xmath218 .",
    "these new observables can then be measured indirectly using the same experimental setup without the need for measurement sequences .",
    "the cvs @xmath219 for the @xmath53^th^ power of @xmath154 will not be a simple power of the cvs @xmath211 for @xmath154 unless the measurement is unambiguous .    _",
    "correlation functions_.if a time - evolution unitary rotation @xmath387 is inserted between different observable measurements , then we obtain a quantum _ correlation function _ instead ,",
    "@xmath537 which should be compared to the classical case .",
    "similarly , @xmath53-time correlations can be defined with @xmath131 time - evolutions between the observable measurements @xmath538 .",
    "_ inversion_.since the cvs depend only on the probability observables , which commute with the measured observable for a fully compatible detector , the procedure for determining the cvs will be identical to the classical case .",
    "that is , _ the contextual values of a quantum observable exactly correspond to the detector labels for a classically ambiguous detector_. we shall refer the reader back to the classical inversion for discussion on how to solve the relation . as a reminder",
    ", we advocate the pseudoinverse as a principled approach for picking the cvs in the event of redundancy or course - graining .",
    "_ conditioned averages_.we can construct a general _ postselected conditioned average _ from the cvs and the fully generalized abl rule analogously to the classical case , @xmath539{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\sum_y f_y(y)\\ , { \\tensor[_{z}]{{{\\big\\langle \\widetilde { y } \\big\\rangle } } } { } } = \\frac{{\\big\\langle \\mathcal{f}_x(e'_z ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(e'_z ) \\big\\rangle}_x } , \\\\    & = \\frac{\\sum_{y\\in y}\\sum_{y'\\in y ' } f_y(y ) { \\text{tr}(\\rho_x m^\\dagger_{y , y'}e'_z m_{y , y'})}}{\\sum_{y\\in y}\\sum_{y'\\in y ' } { \\text{tr}(\\rho_x m^\\dagger_{y , y'}e'_z m_{y , y'})}}. \\nonumber\\end{aligned}\\ ] ] we introduced this type of conditioned average in @xcite for the typical case of pure operations @xmath220 with single associated measurement operators @xmath540 .",
    "if the postselection is defined in the same framework as the measurement operation , then the nonselective measurement @xmath203 in the denominator will reduce to unity , leaving a classical conditioned average , @xmath541 of the same form as .",
    "similarly , the preselected conditioning will also reduce to for such a case .",
    "this special case can not exceed the eigenvalue range of the observable : the observable @xmath154 will always reduce to its eigenvalues since either the state or the postselection commute with it .    more generally , however , the combination of amplified cvs and the context - dependent probabilities in the general postselected average can send it outside the eigenvalue range of the observable . as we discussed in @xcite , having such a conditioned average stray outside the eigenvalue range of the observable",
    "is equivalent to a violation of a leggett - garg inequality that tests the assumptions of macrorealism under noninvasive detection . as a result",
    ", an eigenvalue range violation gives a direct indication of either _ nonclassicality _ present in a measurement sequence , or intrinsic measurement _ disturbance _ beyond that of noninvasive classical conditioning as we saw in the example in ",
    "[ sec : cmarbledisturb ] .",
    "we refer the reader to @xcite for more detail on this matter .",
    "_ strong - conditioned average_.there are two other important special cases of the conditioned average worth mentioning : strong measurement and weak measurement .",
    "the strong measurement case is distinguished by being constrained exclusively to the eigenvalue range of the observable .",
    "specifically , reduces to the form , @xmath542{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\frac{\\sum_{x\\in x } f_x(x ) p(x)d_x(z)}{\\sum_{x\\in x } p(x)d_x(z ) } , \\\\    & = \\frac{\\sum_{x\\in x } f_x(x ) { \\langle x|}\\rho{|x\\rangle}|{\\langle x | z \\rangle}|^2}{\\sum_{x\\in x } { \\langle x|}\\rho{|x\\rangle}|{\\langle x | z \\rangle}|^2 } , \\nonumber\\end{aligned}\\ ] ] which contains only the eigenvalues @xmath543 of the observable and factored probability products .",
    "however , it can not be expressed solely in terms of the observable @xmath154 and a conditioned state as in the classical case due to the disturbances @xmath544 .",
    "only when the state or postselection commutes with the observable does reduce to a special case of and become free from disturbance .    _",
    "weak values_.the weak measurement case is distinguished by being the only case of the quantum postselected conditioned average that can become _ context independent _ for any state and postselection ( under certain conditions ) .",
    "the context - independent weak limit of the conditioned average is the _ weak value _",
    "@xcite , @xmath545{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{}}^w & = \\frac{{\\big\\langle e'_z f_x + f_x e'_z \\big\\rangle}_x}{2 { \\big\\langle e'_z \\big\\rangle}_x},\\end{aligned}\\ ] ] and is expressed entirely in terms of the system expectation functional @xmath144 , the postselection probability observable @xmath493 , and the observable @xmath154 .",
    "written in this form it is clear that it is a symmetrized version of the context - independent commuting case ; however , unlike the weak value is not constrained to the eigenvalue range and can even diverge . for a pure initial state with trace - density @xmath27 and pure postselection @xmath29",
    ", the weak value takes the traditional form , @xmath546{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{^w_{x } } } & \\to \\text{re}\\frac{{\\langle z|}f_x{|x\\rangle}}{{\\langle z | x \\rangle}}.\\end{aligned}\\ ] ] we will consider under what conditions one can obtain such a weak value in sec .",
    "[ sec : wv ] .      continuing the example from sec .",
    "[ sec : qpbscover ] and fig .",
    "[ fig : coverslip ] , observables defined in the same framework as the probability observables may be expressed in terms of the probability observables according to using _ contextual values _ ( cvs ) , exactly as in the classical example ,    @xmath547    inverting this relation according to produces the unique cvs ,    [ eq : polcv ] @xmath548    the denominator is unity when the output ports of the coverslip are perfectly correlated with the polarization . otherwise , the denominator is less than one and serves to _ amplify _ the cvs to compensate for the ambiguity of the detection .",
    "the numerator contains cross - compensation factors that correct bias in the detector ; that is , the eigenvalue @xmath549 for @xmath344 in the contextual value @xmath550 for @xmath125 is weighted by the conditional probability @xmath551 corresponding to the complementary quantities of @xmath391 and @xmath257 , and so forth .",
    "the cvs define the detector observable that is actually being measured in the laboratory , @xmath552 this detector observable corresponds to a detection _",
    "operation _ on the system space according to , @xmath553 which fully describes the interaction with the detector , subsequent conditioning , and experimental convention for defining the observable .",
    "when no subsequent conditioning is performed on the system , this operation constructs the system observable @xmath554 , as desired .",
    "since the pure measurement operations all belong to the same framework and commute with @xmath154 , the operation @xmath229 is also _ fully compatible _ with the observable @xmath154 , meaning it can measure any moment of that observable using the same cvs according to , @xmath555 the quantity @xmath556 indicates a sequence of @xmath53 consecutive measurements made by the same coverslip on the beam to construct the observable @xmath557 for the @xmath53^th^ moment of @xmath154 .",
    "that is , the output from each port of the coverslip is fed back into the coverslip to be measured again .",
    "there are @xmath558 possible outcome sequences @xmath559 for @xmath53 traversals through the coverslip , each with probability @xmath560 of occurring .",
    "these probabilities are weighted with appropriate products of corresponding cvs and summed to correctly construct the @xmath53^th^ moment of @xmath154 .",
    "alternatively , one can change the cvs to directly measure the observable @xmath561 from one traversal of the coverslip . the required cvs for @xmath562 ,    [ eq : polcvnthmom ] @xmath563    are not simple powers of the cvs for @xmath154 unless the measurement is unambiguous .",
    "in addition to moments of @xmath154 , we can obtain postselected _ conditioned averages _ of @xmath154 by conditioning on a second measurement outcome characterized by a probability observable @xmath493 after the measurement by the coverslip according to , @xmath564{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\frac{{\\big\\langle \\mathcal{f}_x(e'_z ) \\big\\rangle}_x}{{\\big\\langle \\mathcal{e}(e'_z ) \\big\\rangle}_x},\\end{aligned}\\ ] ] where @xmath565 is the nonselective measurement by the coverslip .",
    "the second measurement could be a polarizer , another coverslip , or any other method for measuring polarization a second time .",
    "if the initial state is pure with a density @xmath452 and the final postselection is also pure @xmath566 , then simplifies to a pre- and postselected conditioned average , @xmath567{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{x } } } & = \\frac{f_y(t ) |{\\langle z|}m_t{|x\\rangle}|^2 + f_y(r ) |{\\langle",
    "z|}m_r{|x\\rangle}|^2}{|{\\langle z|}m_t{|x\\rangle}|^2 + |{\\langle z|}m_r{|x\\rangle}|^2}.\\end{aligned}\\ ] ] if we relate both pure states to the reference state @xmath344 via unitary rotations as defined in , @xmath568 and @xmath569 , then the probabilities take the form ,    [ eq : polprobs ] @xmath570    we see that each probability possesses an interference term that stems from the relative orientations of the incompatible frameworks for the preparation , measurement , and postselection . in addition , the relative phases in the measurement operators will affect the orientations of the frameworks and further disturb the measurement , as mentioned . for the classical case ,",
    "the frameworks coincide , so @xmath571 ; the interference term vanishes ; and , the probabilities reduce to the conditional probabilities that characterize the probability observables .",
    "the combination of the expanded range of the cvs and the interference term in the probabilities can make the postselected conditioned averages counter - intuitively exceed the eigenvalue range of the observable @xmath154 .",
    "such a violation of the eigenvalue range can not occur from classical conditioning without disturbance as in sec .",
    "[ sec : cmarbledisturb ] .",
    "we can also measure polarization using a von neumann measurement @xcite that uses a detector with a continuous sample space detector , such as position .",
    "for example , passing a beam of polarized light through a calcite crystal will continuously separate the polarizations @xmath344 and @xmath391 along a particular position axis . measuring the position profile of the resulting split beam along that axis",
    "allows information to be gained about the polarization .",
    "for such a setup , measuring the position with a linear scale corresponds to measuring a detector observable @xmath572 for a continuous sample space of distinguishable positions .",
    "the observable @xmath573 has a conjugate @xmath574 that satisfies @xmath575 = i 1_y$ ] .",
    "the conjugate can thus generate translations in @xmath573 with a unitary rotor , @xmath576 + [ i q d_q , [ i q d_q , q ] ] + \\dots = q + q 1_y$ ] . hence , we can model the calcite crystal as a rotation governed by a unitary rotor of the form @xmath577 which will translate @xmath344 polarization by some amount @xmath578 while simultaneously translating @xmath391 polarization by some amount @xmath579 in the opposing direction . the parameters @xmath578 and @xmath579 will depend on the geometry of the crystal with respect to the incident beam .",
    "suppose the light beam has an initially pure beam profile state described by a density @xmath580 .",
    "the probability for obtaining a particular pure position @xmath581 in the profile would then be @xmath582 .",
    "each complex factor @xmath583 is the `` wave function '' of the transverse beam profile , whose complex square is the probability density with respect to the integral @xmath584 .",
    "if we then pass the beam through the crystal described by the rotor and measure its position in a pure position state @xmath581 , we will have enacted a pure operation on the polarization of the beam that is characterized by a single measurement operator ,    @xmath585    with components equal to the initial wave function of the detector profile shifted in position by an appropriate @xmath176 .",
    "the pure measurement operations define a continuous set of probability observables , @xmath586 with components equal to the initial transverse beam profile shifted in position by an appropriate @xmath176 .",
    "unless the shifts become degenerate with @xmath587 then these probability observables can be used to indirectly measure any observable in the framework of @xmath344 and @xmath391 .",
    "since the observable @xmath588 appears as a generator for the rotation @xmath367 , it could be tempting to assert that the detector must specifically measure this observable .",
    "however , only the _ framework _ in which the generating observable is defined determines which observables can be measured . the choice of cv , which can be made in postprocessing , will calibrate the detector to measure specific observables in that framework .",
    "we considered a classical version of similar probability observables in  [ sec : ccontinuousexample ] . generalizing that derivation only slightly",
    ", we can find the preferred contextual values ( cvs ) @xmath211 for an arbitrary polarization observable @xmath589 ,    @xmath590 \\\\",
    "v_+(y ) & = \\frac{p_y(y - \\epsilon_h ) + p_y(y + \\epsilon_v)}{a + b(\\epsilon_h,\\epsilon_v)},\\displaybreak[0 ]   \\\\    \\label{eq : contpolcvgen }    v_-(y ) & = \\frac{p_y(y - \\epsilon_h ) - p_y(y + \\epsilon_v)}{a - b(\\epsilon_h,\\epsilon_v ) } , \\displaybreak[0 ]   \\\\    a & = \\int_y p_y^2(y ) \\ , dy , \\displaybreak[0 ] \\\\",
    "b(\\epsilon_h,\\epsilon_v ) & = \\int_y p_y(y-\\epsilon_h)\\,p_y(y+\\epsilon_v ) \\ , dy.\\end{aligned}\\ ] ]    in particular , one can measure the orthogonal observables @xmath591 and @xmath33 using the expansions , @xmath592    for the specific case of an initial gaussian beam centered at zero , we have ,    [ eq : contpolgauss ] @xmath593   \\\\    \\epsilon & = ( \\epsilon_h + \\epsilon_v)/2,\\displaybreak[0 ]   \\\\",
    "\\delta & = ( \\epsilon_h - \\epsilon_v)/2,\\displaybreak[0 ]   \\\\    a & = \\frac{1}{2\\sigma\\sqrt{\\pi}},\\displaybreak[0 ]   \\\\",
    "b(\\epsilon ) & = a \\exp(- ( \\epsilon/\\sigma)^2 ) , \\displaybreak[0 ]   \\\\",
    "\\label{eq : contpolcv }    v_-(y ) & = \\sqrt{2}\\ , \\frac{\\exp(-\\frac{(y-\\delta)^2}{2\\sigma^2 } ) \\sinh(\\frac{\\epsilon(y-\\delta)}{\\sigma^2})}{\\sinh ( \\frac{\\epsilon^2}{2 \\sigma^2})},\\displaybreak[0 ]   \\\\",
    "v_+(y ) & = \\sqrt{2}\\ , \\frac{\\exp(-\\frac{(y-\\delta)^2}{2\\sigma^2 } ) \\cosh(\\frac{\\epsilon(y-\\delta)}{\\sigma^2})}{\\cosh ( \\frac{\\epsilon^2}{2\\sigma^2})},\\end{aligned}\\ ] ]    what matters for the measurement is the average translation @xmath176 away from the midpoint @xmath594 .",
    "the amplification of the cvs is controlled by the parameter @xmath595 , which serves as an indicator for the ambiguity of the measurement .",
    "when the shift @xmath176 is large compared to the width of the gaussian @xmath596 , then @xmath597 ; the shifted gaussians for @xmath344 and @xmath391 are distinguishable ; the cvs approach the eigenvalues of the measurement ; and , the measurement is unambiguous . when the shift is small compared to the width of the gaussian , then @xmath598 , the gaussians for @xmath344 and @xmath391 largely overlap , the cvs diverge , and the measurement is ambiguous .",
    "[ fig : continuouscv ] shows the cvs for the gaussian initial beam profile , as well as for a laplace and top - hat profile for comparison .",
    "this sort of detection protocol was used in the original paper on weak values @xcite in the form of a stern - gerlach apparatus that measures spin analogously to polarization using a continuous momentum displacement generated by a magnetic field .",
    "the initial gaussian beam profile shifted an amount @xmath176 away from the midpoint of the initial beam profile in a direction corresponding to the value of the spin .",
    "since the beam profile was symmetric about its mean , the generic cvs @xmath599 were implicitly assigned as a linear calibration of the detector , which targets a specific observable analogous to @xmath591 . motivating this implicit choice was the fact that when @xmath176 is sufficiently small , the two overlapping gaussians produce to a good approximation a single resulting gaussian with a shifted mean consistent with such a linear scaling , as shown in fig .",
    "[ fig : continuousprobs ] . that such a choice was being made",
    "was later pointed out explicitly in @xcite before we identified the role of the cvs in @xcite and derived the preferred form .",
    "the proposed spin measurement protocol was adapted to a polarization measurement using a calcite crystal , as we have developed in this section , and then verified experimentally @xcite .    to produce the weak value from the polarization measurement , we postselect on a second measurement to form a conditioned average .",
    "if the initial polarization state is pure with a density @xmath452 and the final postselection is also pure @xmath566 , then we have the form , @xmath600{{{\\big\\langle \\widetilde { f_x } \\big\\rangle}}}{_{x } } } & = \\frac{\\int_y f_y(y ) |{\\langle z|}m(y){|x\\rangle}|^2",
    "dy}{\\int_y |{\\langle z|}m(y){|x\\rangle}|^2 dy}.\\end{aligned}\\ ] ] if we choose the symmetric gaussian case with @xmath601 and take the form of @xmath602 without additional unitary disturbance , @xmath603 and relate both pure states to the reference state @xmath344 via unitary rotations as defined in , @xmath568 and @xmath569 , then the postselected probability density @xmath604{\\tilde{p}}{_x}(y)$ ] takes the form , @xmath605 choosing the cvs to target the observable @xmath591 , the conditioned average then takes the form ,    [ eq : contcondavgauss ] @xmath606{{{\\big\\langle \\widetilde { h - v } \\big\\rangle}}}{_{x } } } & = \\frac{\\cos\\beta + \\cos\\beta'}{1 + \\cos\\beta\\cos\\beta ' + \\xi(\\epsilon,\\sigma ) } , \\\\",
    "\\xi(\\epsilon,\\sigma ) & = \\sin\\beta\\sin\\beta'\\cos(\\gamma-\\gamma')\\exp\\left(-\\frac{\\epsilon^2}{2 \\sigma^2}\\right).\\end{aligned}\\ ] ]    the interference term @xmath607 in the denominator is the only part of the conditioned average that depends on the details of the measurement context through the exponential dependence on @xmath595 , which was also noted in @xcite .",
    "this conditioned average can exceed the eigenvalue range of the observable due to the combination of the amplified cvs and the disturbance linking the incompatible frameworks in the conditional probabilities .",
    "[ fig : continuouswv ] shows the gaussian measurement of the conditioned average , as well as top - hat and triangular measurements for comparison .",
    "the conditioned average has two limiting cases that eliminate the explicit context - dependence : ( 1 ) in the strong - measurement limit , @xmath608 , the interference term vanishes , leaving a conditioned average of projective measurements that always stays in the eigenvalue range of the observable .",
    "( 2 ) in the weak - measurement limit , @xmath609 , the conditioned average reduces to the _ weak value _ , @xmath610{{{\\big\\langle \\widetilde { h - v } \\big\\rangle}}}{^w_{x } } } & = \\text{re}\\frac{{\\langle z|}(h - v){|x\\rangle}}{{\\langle z | x \\rangle } } , \\\\    & = \\frac{\\cos\\beta + \\cos\\beta'}{1 + \\cos\\beta\\cos\\beta ' + \\sin\\beta\\sin\\beta'\\cos(\\gamma-\\gamma')}. \\nonumber\\end{aligned}\\ ] ] the weak value is distinguished by being the only case that can be written entirely in terms of the observable , the post - selection , and the pre - selected state without reference to the intermediate measurement . in this sense",
    ", it is the only context - independent form of the conditioned average .",
    "however , we shall see in  [ sec : wv ] that the weak value is not guaranteed as a limit point of the conditioned average in the weak - measurement limit .",
    "we can also use contextual values and the general conditioned average to analyze an often repeated paradox related to the logic of weak values : the three - box paradox @xcite .",
    "suppose one has three boxes , only one of which may be occupied by some quantum particle .",
    "the boxes form a classical sample space , @xmath611 , with boolean algebra @xmath612 , with @xmath613 .",
    "suppose that the boxes are preselected in the pure state with density @xmath614 and associated hilbert space vector @xmath615 and then later postselected with the pure projector @xmath566 and associated vector @xmath616 .",
    "the postselected state has a transition probability from the preselected state of @xmath617 .    according to the weak value definition ,",
    "the weak values of the box - occupation observables for this pre- and postselected situation are ,    [ eq : threeboxwv ] @xmath618{{{\\big\\langle \\widetilde { a } \\big\\rangle}}}{^w_{x } } } & = 1 , \\\\    { \\tensor*[_{z}]{{{\\big\\langle \\widetilde { b } \\big\\rangle}}}{^w_{x } } } & = 1 , \\\\    { \\tensor*[_{z}]{{{\\big\\langle \\widetilde { c } \\big\\rangle}}}{^w_{x } } } & = -1.\\end{aligned}\\ ] ]    these values",
    "have occasionally been interpreted as the counterfactual conditional probabilities of box - occupation given the double boundary conditions ; that is , the box - occupation was not checked in between the pre- and postselection , but if it _ had _ been checked without disturbing the system , then these probabilities would have been observed .",
    "part of the paradox is that the weak value for @xmath285 is negative , despite the fact that the eigenvalues for the occupation projector @xmath285 are @xmath0 and @xmath32 and can not produce such a negative conditioned average unless _ negative conditional probabilities _ average the eigenvalues .",
    "moreover , if the weak values do represent counterfactual probabilities , then the weak values for @xmath2 and @xmath3 both indicate a counterfactual certainty of occupation , and hence require a negative counterfactual probability for @xmath285 to correctly maintain the probability normalization condition .",
    "operationally , the weak value is an idealized limit point of a pre- and postselected conditioned average . since measuring it is not strictly achievable in the laboratory",
    ", we prefer to analyze this situation by considering a specific measurement context containing experimentally observable quantities .",
    "in particular , we shall consider a detector for the three - box occupation that has the three outcomes @xmath0 , @xmath359 , and @xmath619 .",
    "the measurement operations are fully characterized by the single measurement operators ,    @xmath620    corresponding to the probability observables @xmath621 , @xmath622 , and @xmath623 . for the particular pre- and postselection under consideration , these measurement operators produce the generalized abl conditional probabilities ,    @xmath624{{{\\big\\langle \\widetilde { 1 } \\big\\rangle}}}{_{x } } } & = \\frac{\\text{tr}(z m_1 x m_1)}{\\sum_{i=1}^3 \\text{tr}(z m_i x m_i ) } , \\\\     & = \\frac{3 - 2\\sqrt{1 + \\epsilon",
    "} - 2\\sqrt{1 - \\epsilon } + 2\\sqrt{1 - \\epsilon^2}}{9 - 2\\sqrt{1 + \\epsilon",
    "} - 2\\sqrt{1 - \\epsilon } - 2\\sqrt{1 - \\epsilon^2 } } , \\nonumber \\\\     & = \\frac{1}{3 } - \\frac{\\epsilon^2}{3 } + o(\\epsilon^3 ) , \\nonumber \\displaybreak[0]\\\\     { \\tensor[_{z}]{{{\\big\\langle \\widetilde { 2 } \\big\\rangle}}}{_{x } } } & = \\frac{\\text{tr}(z m_2 x m_2)}{\\sum_{i=1}^3 \\text{tr}(z m_i x m_i ) } , \\\\     & = \\frac{3 - 2\\sqrt{1 + \\epsilon } + 2\\sqrt{1 - \\epsilon } - 2\\sqrt{1 - \\epsilon^2}}{9 - 2\\sqrt{1 + \\epsilon",
    "} - 2\\sqrt{1 - \\epsilon } - 2\\sqrt{1 - \\epsilon^2 } } , \\nonumber \\\\     & = \\frac{1}{3 } - \\frac{2\\epsilon}{3 } + \\frac{\\epsilon^2}{6 } + o(\\epsilon^3 ) , \\displaybreak[0]\\nonumber \\\\     { \\tensor[_{z}]{{{\\big\\langle \\widetilde { 3 } \\big\\rangle}}}{_{x } } } & = \\frac{\\text{tr}(z m_3 x m_3)}{\\sum_{i=1}^3 \\text{tr}(z m_i x m_i ) } , \\\\     & = \\frac{3 + 2\\sqrt{1 + \\epsilon } - 2\\sqrt{1 - \\epsilon } - 2\\sqrt{1 - \\epsilon^2}}{9 - 2\\sqrt{1 + \\epsilon",
    "} - 2\\sqrt{1 - \\epsilon } - 2\\sqrt{1 - \\epsilon^2 } } , \\nonumber \\\\     & = \\frac{1}{3 } + \\frac{2\\epsilon}{3 } + \\frac{\\epsilon^2}{6 } + o(\\epsilon^3 ) , \\nonumber   \\end{aligned}\\ ] ]    these detection probabilities are all positive and well - formed , since they are operationally accessible quantities .",
    "if we target a particular observable @xmath625 for the three boxes , we can solve for the appropriate cvs by inverting the matrix equation , @xmath626 producing , @xmath627 in particular , we can use these cvs to expand the box - occupation observables in terms of the probability observables ,    @xmath628    hence , all three box - occupation observables can be measured simultaneously from the same set of probabilities for the three detector outcomes .",
    "notably , the cvs assigned to each outcome can be _ negative _ for sufficiently small @xmath176 , even though all eigenvalues are positive or zero .",
    "hence the values being averaged can be negative and thus can lead to negative averages in principle .",
    "computing the appropriate conditioned averages we find to @xmath629 ,    @xmath606{{{\\big\\langle \\widetilde { a } \\big\\rangle}}}{_{x } } } & = 1 - \\frac{\\epsilon}{2 } - \\frac{\\epsilon^2}{4 } + o(\\epsilon^3 ) , \\\\    { \\tensor[_{z}]{{{\\big\\langle \\widetilde { b } \\big\\rangle}}}{_{x } } } & =   1 + \\frac{\\epsilon}{2 } - \\frac{\\epsilon^2}{4 } + o(\\epsilon^3 ) , \\\\    \\label{eq : threeboxca }    { \\tensor[_{z}]{{{\\big\\langle \\widetilde { c } \\big\\rangle}}}{_{x } } } & =   -1 + \\frac{\\epsilon^2}{2 } + o(\\epsilon^3).\\end{aligned}\\ ] ]    which shows that the weak values are the @xmath180 limit of the conditioned averages with this specific measurement context .",
    "the paradox of the negative weak value can therefore be largely resolved in the following sense : the combination of the amplified negative cvs and the disturbance in the detector probabilities linking pre- and postselection frameworks leads to the negative result for @xmath200{{{\\big\\langle \\widetilde { c } \\big\\rangle}}}{_{x}}}$ ] given sufficiently small @xmath176 .",
    "no negative probabilities are required to obtain the negative limit point since negative cvs are being averaged in the weak limit and not eigenvalues .",
    "all operationally accessible probabilities are positive and well - behaved : the negative cvs are assigned by the experimenter and highlighted by the disturbance in the well - behaved probabilities .",
    "we leave the reader to ponder how to interpret the operationally accessible negative conditioned average .",
    "however , we note that with at least this measurement context the conditioned averages do obey the equality , @xmath606{{{\\big\\langle \\widetilde { a } \\big\\rangle}}}{_{x } } } + { \\tensor[_{z}]{{{\\big\\langle \\widetilde { b } \\big\\rangle}}}{_{x } } } + { \\tensor[_{z}]{{{\\big\\langle \\widetilde { c } \\big\\rangle}}}{_{x } } } = 1,\\end{aligned}\\ ] ] for all values of @xmath176 .",
    "the three sets of cvs sum to unity for each detector outcome , leaving only the normalized sum of detector probabilities @xmath200{{{\\big\\langle \\widetilde { 1 } \\big\\rangle}}}{_{x } } } + { \\tensor[_{z}]{{{\\big\\langle \\widetilde { 2 } \\big\\rangle}}}{_{x } } } + { \\tensor[_{z}]{{{\\big\\langle \\widetilde { 3 } \\big\\rangle}}}{_{x } } } = 1 $ ] . for more discussion of this paradox , see , for example , @xcite .",
    "_ weak value controversy_.as we have seen for the case of the calcite detector and the three box paradox , the weak value seems to arise naturally as the weak limit of postselected conditioned averages .",
    "indeed , much of the existing literature on weak values ( e.g. @xcite ) operates under the assumption that it is the only weak limit of a conditioned average , or that it is a well - defined property of a pre- and postselected ensemble prior to the ensemble being measured . however",
    ", a conditioned average does not necessarily converge to the weak value in the weak measurement limit , as has been noted independently by several groups @xcite , making its interpretation as a well - defined property worthy of more careful consideration . to obtain correct laboratory predictions for a conditioned average",
    ", the formula must be used , which generally requires the specification of the detection strategy and the protocol for assigning cvs to target a specific observable .    despite the interpretational controversy",
    ", the weak value is distinguished by being a _ context independent _ weak limit of the conditioned average that is easy to compute theoretically and appears quite commonly in typical laboratory situations .",
    "the formal expression of the weak value can also appear in other measurement scenarios , such as in `` modular values '' @xcite , or even perturbative corrections to energy spectra @xcite , which makes it an independently interesting quantity to study .",
    "we will now demonstrate how the weak value can be uniquely defined from the general conditioned average by imposing a set of sufficient conditions that the measurement should satisfy .    _",
    "preliminaries_.first we note from that each measurement operator has a polar decomposition , @xmath630 , in terms of a unitary operator @xmath499 and a positive operator @xmath631 .",
    "it then follows that , @xmath632}\\big]}/2 , \\nonumber\\end{aligned}\\ ] ] where @xmath633 is the anticommutator , @xmath634 } = ab - ba$ ] is the commutator , and @xmath635 is a unitary rotation of the postselection .    _",
    "sufficient conditions_.next we make the following sufficient assumptions regarding the dependence of the relevant quantities on the measurement strength parameter @xmath176 :    1 .",
    "the measurement operators @xmath636 are analytic functions of @xmath176 , and thus have well defined taylor expansions around @xmath637 such that they are proportional to the identity in the weak limit , @xmath638 .",
    "the unitary parts of the measurement operators @xmath639 are generated by hermitian operators of order @xmath640 , @xmath641 , for some integer @xmath642 .",
    "furthermore , each @xmath499 must commute with either the system state or the postselection , @xmath643 = 0 $ ] , or @xmath644 = 0 $ ] .",
    "3 .   the equality @xmath645 must be satisfied , where the cvs @xmath646 are selected according to the pseudo - inverse prescription .",
    "the minimum nonzero order in @xmath176 for all @xmath647 is @xmath648 such that assumption @xmath649 can also be satisfied for some cvs by the truncation to order @xmath648 .",
    "that is , for all @xmath28,@xmath483 , @xmath650 , where @xmath651 is the detector probability in absence of interaction , and some of the @xmath652 may vanish .",
    "the probability observables @xmath653 commute with the observable @xmath154 .",
    "_ theorem_.given the above sufficient conditions , we have the following theorem : _ in the weak limit @xmath654 the context dependence of the conditioned average vanishes and the weak value is uniquely defined_.    _ proof_.to prove the theorem , we expand to the minimum necessary order of @xmath648 and then take the weak limit as @xmath180 .",
    "first , we expand to order @xmath648 using assumptions ( 1 ) , and ( 4 ) , @xmath655 generally , the remaining unitary rotation of the postselection will disturb the weak limit . however , if @xmath656 } = 0 $ ] as in assumption ( 2 ) , then @xmath657 and the unitary disturbance disappears .",
    "if instead @xmath658 } = 0 $ ] , then we can apply the state to and find , @xmath659 since @xmath660 , the first term simplifies .",
    "the unitary rotation in the second term expands to @xmath661 , and the @xmath662 correction can be absorbed into the overall @xmath663 correction .",
    "therefore , after summing over @xmath483 we find up to corrections of order @xmath664 , @xmath665 where the probability observable has the expansion to order @xmath648 , @xmath666    inserting into , we find , @xmath606{{{\\big\\langle \\widetilde { f_x } \\big\\rangle } } } { } } & = \\frac{{\\big\\langle { \\big\\{f_x,\\,e'_z\\big\\}}/2 \\big\\rangle}_x + \\sum_y f_y(\\epsilon ; y ) o(\\epsilon^{n+1})}{{\\big\\langle { \\big\\{1_x,\\,e'_z\\big\\}}/2 \\big\\rangle}_x + o(\\epsilon^{n+1 } ) } , \\end{aligned}\\ ] ] where we have simplified @xmath667 in the numerator , and @xmath668 in the denominator . hence ,",
    "unless the cvs in the numerator have poles larger than @xmath669 the correction terms of order @xmath664 will vanish , producing in the weak limit @xmath180 , as claimed .",
    "the last step in obtaining , therefore , is to show that the pseudoinverse solution for @xmath334 that was indicated by assumption ( 3 ) can not have poles larger than @xmath669 .",
    "the following lemmas will show this , which will prove the main theorem .",
    "_ lemma preliminaries_.first , we note that @xmath154 commutes with @xmath670 by assumption ( 5 ) . as such , we will replace the cv definition @xmath645 with an equivalent matrix equation ,    @xmath671    the pseudoinverse is constructed from the singular value decomposition @xmath672 as @xmath673 , where @xmath306 and @xmath308 are orthogonal matrices such that @xmath674 , @xmath310 is the singular value matrix composed of the square roots of the eigenvalues of @xmath307 , and @xmath675 is composed of the inverse nonzero elements in @xmath313 .",
    "next , we note that the truncation of the matrix @xmath235 to order @xmath648 has the form , @xmath676 where @xmath677 is a matrix whose rows are identical and whose columns contain the interaction - free detector probabilities @xmath508 , and @xmath678 is a matrix whose rows all sum to zero . furthermore , since the solution to the equation @xmath679 is assumed to exist by assumption ( 4 ) , then the dimension of the detector , @xmath680 , must be greater than or equal to the dimension of the system , @xmath681 .",
    "we then have the following two lemmas .    _",
    "lemma 1_._the singular values of the truncated matrix _",
    "@xmath682 _ have maximum leading order _ @xmath648 .    _",
    "proof_.the singular values of @xmath682 are @xmath683 , where @xmath684 are @xmath681 eigenvalues of @xmath685 , with its other @xmath686 eigenvalues being zero .",
    "since @xmath687 , this matrix has the simple form @xmath688 , where @xmath689 is @xmath690 times the projection operator onto the probability vector @xmath691 , and @xmath692 .",
    "we will use @xmath693 to determine the singular values of @xmath682 .    differentiating the eigenvalue relation @xmath694 and",
    "the eigenvector normalization condition @xmath695 with respect to @xmath696 produces the following deformation equation that describes how the eigenvalues of @xmath693 continuously change with increasing @xmath696 , @xmath697 integrating this equation produces the following perturbative expansion of the eigenvalues for small @xmath176 , @xmath698 hence , to prove the lemma it is sufficient to show that @xmath699 and @xmath700 can not both vanish unless @xmath701 for all @xmath176 .    since @xmath702 is a projection operator , @xmath703 is its only nonzero eigenvalue with associated eigenvector @xmath704",
    "hence , @xmath705 to leading order . for @xmath706 , @xmath707 and @xmath708 can be chosen arbitrarily to span the degenerate @xmath709-dimensional subspace orthogonal to @xmath710 .",
    "suppose @xmath711 for some @xmath712 .",
    "it follows that @xmath713 since @xmath708 is orthogonal to @xmath714 .",
    "therefore , @xmath708 is an eigenvector of @xmath715 with eigenvalue @xmath32 for any @xmath176 .",
    "since @xmath693 is symmetric , its eigenvectors form an orthogonal set for any @xmath176 , so we must have the identification @xmath716 . as a result ,",
    "the associated eigenvalue vanishes for any @xmath176 , @xmath717 , which proves the lemma .",
    "_ lemma 2_._the pseudoinverse solution _",
    "@xmath718 _ to _ _ can not have poles larger than _ @xmath669 .    _",
    "proof_.in order to satisfy , we have the equivalent condition for each component of @xmath719 , @xmath720 therefore , all singular values @xmath721 corresponding to nonzero components of @xmath722 must also be nonzero ; we shall call these the _ relevant _ singular values . singular values which are not relevant will not contribute to the solution @xmath723 .",
    "we can see this since @xmath724 , so any zero element of @xmath725 will eliminate the inverse irrelevant singular value @xmath726 from the solution for @xmath727 .",
    "since the orthogonal matrices @xmath306 and @xmath308 do not contain any poles , and since @xmath728 is @xmath176-independent , then the only poles in the solution @xmath729 must come from the inverses of the relevant singular values in @xmath312 . if a singular value @xmath721 has leading order @xmath730 , then its inverse @xmath731 has leading order @xmath732 ; therefore , to have a pole of order higher than @xmath669 then there must be at least one relevant singular value with a leading order greater than @xmath648 .",
    "however , if that were the case then the truncation @xmath682 of @xmath235 to order @xmath648 could not satisfy since to that order it would have a relevant singular value of zero according to the previous lemma , contradicting assumption ( 4 ) about needing to satisfy the cv definition with the minimum nonzero order in @xmath176 .",
    "therefore , the pseudoinverse solution @xmath733 can have no pole with order higher than @xmath669 and the lemma is proven .",
    "_ exceptions_.as the main theorem indicates , the weak value will arise as the weak limit of a conditioned average in many common laboratory situations , which explains its seeming stability in the literature .",
    "however , if the sufficiency conditions of the theorem are not met , then a different weak limit may be found .",
    "for example , if there is @xmath176-dependent unitary disturbance in the measurement , then the postselection can be effectively rotated to a different framework for each measurement outcome , which creates additional terms in the weak limit .",
    "similarly , if the cvs are @xmath176-dependent and diverge more rapidly than @xmath669 then additional terms will become relevant in the weak limit .",
    "( see , for example , ref .",
    "this latter case can happen either from a pathological choice of cvs by the experimenter in the case of redundancy , or from a set of probability observables that can not satisfy the constraint equation @xmath645 with their lowest nonzero order in @xmath176 .",
    "such probability observables that do not satisfy the constraint equation to lowest order are poorly correlated with the observable in the weak limit .",
    "we refer the reader to @xcite for more discussion on the uniqueness issue of weak values .",
    "the theorem presented here is a slight generalization of the one presented therein .",
    "in this work , we have detailed the contextual - value approach to the generalized measurement of observables that we originally introduced in the letter @xcite and further developed in @xcite .",
    "this approach completes the well - established operational theory of state measurements by directly relating the state - transformations to traditional observables .",
    "each such operation typically corresponds to a distinguishable outcome of a correlated detection apparatus .",
    "an experimenter can construct an observable from such an apparatus by assigning values to its outcomes .",
    "the assigned values can be generally amplified from the eigenvalues of the constructed observable due to ambiguity in the measurement , and thus form a generalized spectrum that depends on the specific measurement context .",
    "hence , we call these values _ contextual values _ for the constructed observable that allow its indirect measurement using such a correlated detector .    constructing an observable using contextual values requires only classical probability theory , according to . hence , the technique may be used wherever bayesian probability theory applies .",
    "we have outlined an algebraic approach to operational measurements from within bayesian probability theory to encourage applications along these lines .",
    "we have also shown how to construct a quantum probability space as the orbit of a classical probability space under the special unitary group .",
    "this point of view illustrates that quantum observables can be constructed from contextual values in precisely the same way as their classical counterparts .",
    "the approach also highlights the similarity between lder s rule for updating a quantum state and _ invasive _ classical conditioning , which leads to a similarity between quantum operations and classically invasive measurement operations .",
    "numerous physical examples have been given .    by putting all observable measurements on the same footing ,",
    "the contextual values formalism subsumes not only projective measurements but also weak measurements as special cases . to emphasize this point ,",
    "we have analyzed the quantum weak measurement protocol introduced by aharonov et al .",
    "@xcite in detail as an example using a calcite crystal and a polarized laser beam .",
    "we have also derived the quantum weak value as a limit point of a general pre- and postselected conditioned average as the measurement strength goes to zero and have given sufficient conditions for the convergence to hold .",
    "like the classically invasive conditioned average , the quantum conditioned average , with the quantum weak value as a special case , can exceed the eigenvalue bounds of the observable .",
    "the use of contextual values considerably clarifies and formalizes the process of measuring observables , particularly within a laboratory setting .",
    "the elements of the formalism directly describe operationally accessible quantities that can be tomographically calibrated . as such",
    ", the technique should be of considerable interest to experimentalists working on measurement and control of both quantum and classical systems .",
    "furthermore , the formalism prompts interesting theoretical questions about the foundations of quantum mechanics by highlighting its myriad similarities to classical probability theory .",
    "we acknowledge helpful discussions with shantanu agarwal and support from the national science foundation under grant no .",
    "dmr-0844899 , and the us army research office under grant grant no .",
    "w911nf-09 - 0 - 01417 ."
  ],
  "abstract_text": [
    "<S> we present a detailed motivation for and definition of the _ contextual values _ of an observable , which were introduced by dressel et al . , </S>",
    "<S> phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 104 * , 240401 ( 2010 ) . </S>",
    "<S> the theory of contextual values is a principled approach to the generalized measurement of observables . </S>",
    "<S> it extends the well - established theory of generalized state measurements by bridging the gap between partial state collapse and the observables that represent physically relevant information about the system . to emphasize the general utility of the concept </S>",
    "<S> , we first construct the full theory of contextual values within an operational formulation of classical probability theory , paying special attention to observable construction , detector coupling , generalized measurement , and measurement disturbance . </S>",
    "<S> we then extend the results to quantum probability theory built as a superstructure on the classical theory , pointing out both the classical correspondences to and the full quantum generalizations of both lder s rule and the aharonov - bergmann - lebowitz rule in the process . </S>",
    "<S> as such , our treatment doubles as a self - contained pedagogical introduction to the essential components of the operational formulations for both classical and quantum probability theory . </S>",
    "<S> we find in both cases that the contextual values of a system observable form a generalized spectrum that is associated with the independent outcomes of a partially correlated and generally ambiguous detector ; the eigenvalues are a special case when the detector is perfectly correlated and unambiguous . </S>",
    "<S> to illustrate the approach , we apply the technique to both a classical example of marble color detection and a quantum example of polarization detection . for the quantum example we detail two devices : fresnel reflection from a glass coverslip , and continuous beam displacement from a calcite crystal . </S>",
    "<S> we also analyze the three - box paradox to demonstrate that no negative probabilities are necessary in its analysis . </S>",
    "<S> finally , we provide a derivation of the quantum weak value as a limit point of a pre- and postselected conditioned average and provide sufficient conditions for the derivation to hold . </S>"
  ]
}