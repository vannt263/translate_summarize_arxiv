{
  "article_text": [
    "paper considers the task of accurate image retrieval on a large scale . given a query image , we aim at finding the similar images from the database . a number of retrieval models have been proposed in this scenario , among which local feature based model , _",
    "i.e. _ , bag - of - words ( bow ) @xcite , has obtained widespread applications .",
    "nevertheless , traditional bow is lack of spatial layout and may encounter quantization errors . besides , local feature",
    "based models usually lead to huge storage consumption , which is limited in real - world applications featured by the rapid expansion of the image volume . on the contrary ,",
    "holistic representations such as hsv represent an image via global vectors and obtain good scalability , while the retrieval accuracy is less desirable .        generally speaking ,",
    "local descriptors and holistic representations demonstrate distinct strengths in finding similar images .",
    "local features are capable of capturing local image patterns or textures , while holistic representations delineate overall feature distributions in images .",
    "thus , a variety of methods @xcite are proposed to integrate the strengths of local and holistic features to yield more satisfying retrieval results .",
    "@xcite propose a graph based fusion approach to merge and rerank multiple retrieval sets .",
    "although this method achieves desirable accuracy , there are some disadvantages , _ e.g. _ , being not robust to the dynamic changes of the dataset or being unable to find reciprocal neighborhoods .",
    "zheng _ et al .",
    "_ @xcite propose a coupled multi - index framework to perform feature fusion at indexing level .",
    "specifically , color and sift features are coupled into a multi - dimensional inverted index to filter out false positive sift matches .",
    "the _ c - mi _ seems to achieve higher accuracy accompanied with less query time , while the storage consumption is still remarkable when the image dataset rapidly expands .",
    "another representative work is the query - adaptive late fusion method proposed in @xcite . to a certain query ,",
    "@xcite extracts five different image descriptors and each of them is used to search the whole dataset independently .",
    "the initial score curves obtained via these representations are normalized by the references and later used to evaluate the effectiveness of the corresponding descriptors .",
    "this query - adaptive method does have competitive retrieval performance , while it heavily relies on the number of to - be - fused features and needs considerable amount of storage to save these features , as well as the reference curves .",
    "different from the above fusion methods utilizing multiple image descriptors to search the entire database simultaneously , c2f proposed in this paper is a two - layer fusion procedure working from coarse to fine .",
    "the first stage aims at filtering out distractors from the dataset , which helps enhance the retrieval efficiency and reduce the memory consumption to be encountered in the next step .",
    "the subsequent operation focuses on refining the rank list from the filtered candidates , which further improves the retrieval accuracy ( see figure [ fig : example ] for an illustration ) .    to be more specific ,",
    "we firstly exploit the holistic descriptors to filter out distractor images that are dissimilar to the query from the database , and thus the number of candidate images used to compared with the query can be greatly reduced .",
    "this process is efficient and the retrieved candidates usually appear globally similar .",
    "then , according to the similarity scores obtained via holistic features , we acquire @xmath0 candidate images which are more similar to the query when compared with other images in the database .",
    "moreover , for each candidate image , we design an adaptive weight by holistic similarity scores to measure its similarity degree to the query . finally , accurate image search is conducted on candidate image pool via local features . in this step ,",
    "adaptive weights of the candidate images are used in refining the initial retrieval list .    the main contribution of the proposed framework consists in the coarse - to - fine fusion of retrieval sets given by different methods , which has two merits : 1 ) by filtering out distractors from the database , the number of candidate images to be used for comparison with the query can be greatly reduced .",
    "2 ) given a certain query , the relative weight of each candidate can be automatically evaluated via global similarity scores , which helps ensure the stability of the retrieval performance .",
    "we validate the performance of c2f on two public datasets , _",
    "i.e. _ , ukbench and holidays datasets .",
    "the evaluation shows that our method compares favorably with the recent state of the art .",
    "the remainder of the paper is organized as follows : section 2 highlights the related works ; we describe the formulation details of c2f in section 3 ; section 4 provides comprehensive experimental results to validate the superiority of c2f ; finally , section 5 concludes the paper and states directions for future work .",
    "a variety of works have been exposed to improve the image retrieval performance . in this section ,",
    "we briefly introduce several closely related methods .    to obtain a discriminative image representation with local features ,",
    "bow based methods are usually adopted . in bow model ,",
    "a codebook is generated off - line by unsupervised clustering algorithms , such as k - means , hierarchical k - means @xcite , and approximate k - means @xcite .",
    "each local feature is quantized to one or a few visual words by approximate nearest neighbor algorithms",
    ". then the image is represented by a high - dimensional histogram over the visual codebook .",
    "this process is usually accompanied by the quantization error @xcite .    to correct quantization defects ,",
    "hard assignment can be replaced with schemes such as soft assignment @xcite , multiple assignment @xcite , sparse coding @xcite , _",
    "etc_. nevertheless , quantizing a single feature to several visual words @xcite will introduce more storage burden and higher search complexity .",
    "representatively , @xcite proposes to generate a @xmath1-bit binary signature to each local feature with the hashing approach via a smaller codebook , for example 20,000 .",
    "the true matches are defined as those local features that are not only quantized to the same visual word but also have small hamming distance between their binary signatures .        on the other hand , @xcite proposes a compact feature based clustering ( cfc ) to represent images .",
    "@xcite improves the retrieval performance by automatically learning robust visual features and hash functions .",
    "@xcite proposes a discriminative light unsupervised learning network to learn a compact image representation .",
    "@xcite employs a two - layer hierarchical scheme to extract the global information and statistics of the local feature set of image datasets .",
    "there is no doubt that methods based on compact holistic features are efficient in computation and memory usage , as well as more suitable to large - scale dataset .",
    "since holistic features tend to be less invariant than local features and more sensitive to image transformations , their retrieval precision is often lower compared to local feature based methods .",
    "as a consequence , it would be desirable if one method can effectively combine the complementary cues of local and holistic features .",
    "rank aggregation @xcite is a solution to fuse local and holistic cues at the rank level , but the effectiveness of rank aggregation is discounted when there is no intersection among the top candidates retrieved by the local and holistic feature based methods , which does occasionally occur . to overcome this weakness , @xcite proposes an undirected - graph based fusion approach to further enhance the retrieval precision . built on this undirected - graph , @xcite proposes a directed graph which is robust to outlier distraction .",
    "@xcite propose a graph - based optimization framework to leverage category independent object proposals for logo search in a large scale image database .",
    "@xcite proposes a semantic - aware co - indexing algorithm to jointly embed local invariant features and semantic attributes into the inverted indexes .",
    "@xcite introduces a simple color signature generation procedure and embeds local color features into the inverted index to provide color information by bag of colors . in @xcite , a couple multi - index framework",
    "is proposed to perform feature fusion at indexing level by couple complementary features into a multi - dimensional inverted index .",
    "@xcite proposes a late fusion at score level . particularly , the effectiveness of each to - be - fused feature is estimated in an unsupervised , query - adaptive manner .",
    "@xcite proposes a bag - of - words based deep neural network for image retrieval task , which learns high - level image representation and maps images into bag - of - words space .    from the above analysis",
    ", it can be seen that considerable efforts have been made to improve the retrieval accuracy via fusion schemes , such as graph - based @xcite , query - adaptive late fusion @xcite .",
    "usually , with more heterogeneous features , higher accuracy can be obtained , while more information needs to be stored and higher computational complexity incurred , correspondingly .",
    "therefore , how to maintain a good balance between accuracy and complexity is an important issue when focusing on large - scale data .",
    "different from the above fusion methods , in this work , we propose a two - layer fusion framework to rank database images from coarse to fine ( c2f ) .",
    "this method improves retrieval efficiency and accuracy reliably .",
    "in this section , we present the detailed structure of the proposed c2f aiming at accurate image retrieval on large - scale databases .",
    "c2f is a two - layer fusion framework which consists of three key components .",
    "1 ) it filters distractors from the whole database with holistic representations , and thus the number of images to be used for comparison with the query can be greatly reduced .",
    "2 ) for a certain query , we design an adaptive weight for each selected candidate image according to the similarity scores obtained via holistic features .",
    "3 ) we further refine the candidate set with local features , considering the impact of adaptive weights .",
    "the mechanism of c2f is presented in figure [ fig : framework ] . in the next subsections",
    ", we will elaborate each component of the framework .",
    "we assume that there are a total of @xmath2 color images in the database @xmath3 . using holistic features , such as hsv , each database image",
    "is represented as a @xmath4-dimensional histogram vector @xmath5 , and the image set can be defined as @xmath6 . in order to reduce the impact of bins with large values , hsv histograms of both query and dataset images are l1-normalized and square scaled , similar to the rootsift @xcite : @xmath7 where @xmath8 is a coefficient and its value is set to 0.5 .",
    "to select candidate images from the dataset , we adopt the cosine distance between vectors of the query and the database images as similarity measurement : @xmath9 where @xmath10 is the query , @xmath11 is a database image , and @xmath12 represents the similarity score obtained by global feature .",
    "the cosine similarity between the query and all the dataset images can be defined as : @xmath13 particularly , a larger cosine score corresponds to higher similarity with the query .",
    "note that there exists large variationa among the database image .",
    "thus , we hold the opinion that most database images have significant differences from the query . hence , the holistic image representation can be used to quickly filter out these noise images . for each query ,",
    "@xmath0 candidates that share similar information with the query are adaptively selected from the original database .",
    "different queries commonly have different candidate images .",
    "after the filtering stage , @xmath0 candidate images more similar to the query are selected from the original image database .",
    "the similarity of the query with different candidates varies extensively .",
    "it is important to design an adaptive weight for each candidate image to evaluate its similarity level with the query . considering that holistic representations , _",
    "i.e. _ , hsv histograms , delineate overall color feature distributions in images , the cosine values computed in sec .",
    "[ method : choose ] are used as the basis of learning weights . in particular , the similarity scores of the query with @xmath0 candidates are represented as @xmath14 .",
    "the motivation behind the weighting method is that the larger cosine values correspond to higher importance of the candidate images . to overcome the dictatorship incurred by the candidates with larger scores , the cosine similarity values of the corresponding candidate images are min - max normalized to @xmath15 $ ] :    @xmath16",
    "then , the normalized scores are used as the adaptive weights of the corresponding @xmath0 candidate images .",
    "@xmath17    experimental results show that adaptive weights significantly improves the accuracy of image retrieval on both holidays and ukbench datasets .",
    "the performance of c2f with and without wights are compared in table [ fig : weights ] .",
    "given the @xmath0 candidate images and their corresponding weights of a certain query , we focus on utilizing local features to find out ground truths .",
    "firstly , we extract sift descriptors from an image by hessian - affine detector @xmath18 \\in r^{d\\times m}$ ] .",
    "the image contains @xmath19 local descriptors in @xmath20 dimensions .",
    "then , a codebook trained on filckr60k dataset by approximate k - means ( akm ) @xcite clustering algorithm is used to quantize sift features . specifically , each local feature @xmath21 of an image is assigned to its nearest visual word of the codebook , represented by the i d of the corresponding visual word .",
    "@xmath22    next , to enhance the discriminative validity of the visual words , a @xmath23-bit binary signatures feature is generated for each sift feature @xmath24 $ ] , which encodes the location of the sift descriptor within the voronoi cell .",
    "the distance between two descriptors @xmath25 and @xmath26 lying in the same cell is approximated by the hamming distance of their corresponding binary signatures .",
    "@xmath27    at this point , a sift descriptor is represented by @xmath28 and @xmath29 , and a standard inverted index is generated .",
    "then the matching function is defined as : @xmath30 where @xmath31 is the hamming distance defined in e.q .",
    "[ gongshi10 ] , and @xmath32 is a fixed hamming threshold .",
    "the similarity score between the query and the candidate image is : @xmath33 where @xmath19 is the number of local feature in the query image @xmath10 , @xmath25 and @xmath26 is the local feature of the query and dataset image , respectively , l represents that the score is computed via local features .",
    "considering the similarity degrees measured by holistic representations , the sorted list of the @xmath0 candidate images obtained via local features are refined according to the adaptive weights learned in sec .",
    "[ method : weight ] .",
    "the final similarity scores of the query and the candidate images are defined as : @xmath34 where @xmath35 is the final similarity score between the query and the dataset image d , @xmath36 is the weight obtained by the intuitively or steadily weighted method .",
    "overall , we propose a two - layer fusion framework which takes advantage of global and local cues and ranks database images from coarse to fine . considering the efficiency and low storage consumption of holistic features",
    ", we use the hsv histograms to coarsely search the original database and filter out noise images .",
    "then , accurate image search is conducted on candidate images , combining the adaptive weights learned via global similarity scores to further enhance the retrieval accuracy .",
    "experimental results in sec .",
    "[ exper : state - of - the - arts ] demonstrate that the retrieval accuracy of c2f is competitive to state of the art .      in order to illustrate the following analysis",
    "more clearly , we provide a brief description of these parameters : @xmath37 is the number of dataset images , @xmath38 is the number of query images , @xmath39 is the number of candidate images , and @xmath40 is the number of features to - be - fused .",
    "the rising processing time of the image retrieval mainly caused by the increasing number of candidate images , which are used for comparison with the query . in this paper",
    ", we propose a two - layer fusion method which takes advantage of global and local cues and ranks database images from coarse to fine . the total comparison number in c2f",
    "is @xmath41 , which is a relative small value compared with other fusion methods @xcite .",
    "for example , the comparison number in @xcite is @xmath42 , especially , @xmath40 is set to 5 in the experiment . correspondingly , the shorten of the comparisons in c2f will certainly contribution to the efficiency and the storage consumption . the memory storage consumed by c2f",
    "is quite smaller than that of @xcite .",
    "this is because @xcite need to save multiple features of all images of the database , while c2f stores holistic features of all database images and local features of only @xmath0 candidate images .    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]      to further evaluate the performance of c2f on the large - scale image datasets , we merge holidays with imagenet 1@xmath19 . in the experiments , we use different numbers of distractors to test the scalability of the proposed two - layer fusion framework .",
    "specifically , we set the number of candidates @xmath0 to 1000 , and adopt adaptive weights to enhance the retrieval accuracy .",
    "table [ table : large - scale ] shows the retrieval results with different numbers of distractor images .",
    "undoubtedly , the performance of the performance of c2f gradually decreases with the augment of distractors in the database .",
    "when the number of distractor images is 0 , c2f obtain best accuracy . while when all 1 m distractors of imagenet are added into the holidays database , the map of c2f reduce significantly , which is 12.63% lower than that of without distractors .",
    "moreover , we do not enhance the corresponing candidates when the distractors increase , so c2f can significantly enhance the efficiency and reduce the memory consumption at the cost of some accuracy loss .",
    "it is well known that bow incorporated with hamming embedding can achieve desirable performance . meanwhile",
    ", a major bottleneck in bow based methods is the length of the inverted list for it grows almost linearly with the database size .",
    "a traverse on the inverted index generated by the whole database can be extravagantly expensive .",
    "this problem appears more severe if we consider a typical case where the benchmark contains millions of images , for the inverted list can be as long as gbs .",
    "it means that for each query feature , a naive full comparision with all images of the dataset takes considerable time . table [ table : memory ] and table [",
    "table : efficiency ] give the average query memory consumption and the corresponding time on holidays and ukbench datasets with the increasing number of candidates , respectively .    with the same candidate number ,",
    "memory expended on ukbench is far less than that on holidays due to the different size of images , while incremental tendency reflected on two benchmarks is consistent .",
    "similarly , from table [ table : memory ] and table [ table : efficiency ] , we observe that the average query time also significantly increases with the growing number of candidates .",
    "this is because that more candidates means larger inverted index , namely , more search time to one query .",
    "thus , an effective filter mechanism is very necessary for large - scale image retrieval , and a moderate @xmath0 candidate set is important to guarantee the tradeoff between the retrieval accuracy and memory consumption .",
    "figure [ fig : failure ] presents some false retrieval results through c2f on holidays dataset .",
    "as shown in figure [ fig : failure ] , these inaccurate images have the following two characteristics : 1 ) the image itself contains ambiguous information . taking the query in the upper left corner as an example , we want the returned top images contain the waterfall , while in fact , the query involves abundant greenery information .",
    "this is why neither global representation nor local feature can acquire satisfactory results .",
    "2 ) in the experiments , c2f utilizes hsv histograms delineating overall color feature distributions in images to filter out distractors , so the top ranked candidates share similar color composition .",
    "this similar error will affect the query accuracy in the next stage , see the queries on the upper right corner and the lower left corner of the figure [ fig : failure ] .",
    "in this paper , a two - layer fusion method is proposed , which takes advantage of global and local cues and ranks database images from coarse to fine .",
    "the main purpose of c2f is to reduce memory consumption and the computational complexity , without compromising the retrieval accuracy . to achieve this goal",
    ", c2f adopts holistic representation to filter out noisy images of the benchmark and choose the images with high similarity scores as candidates .",
    "particularly , for each candidate , an adaptive weight is learned via the holistic similarity scores .",
    "then retrieval is conducted on candidate set by taking the adaptive weights into account .",
    "comprehensive experiments are conducted to evaluate the accuracy and scalability of the c2f . with the same holistic and local descriptors ,",
    "the accuracy of c2f on holidays is 3.31% higher than the query - adaptive fusion method @xcite . in future work",
    ", we will further explore more effective holistic representations and design more adaptive weighted functions ."
  ],
  "abstract_text": [
    "<S> this paper addresses the problem of large - scale image retrieval . </S>",
    "<S> we propose a two - layer fusion method which takes advantage of global and local cues and ranks database images from coarse to fine ( c2f ) . </S>",
    "<S> departing from the previous methods fusing multiple image descriptors simultaneously , c2f is featured by a layered procedure composed by filtering and refining . in particular , c2f consists of three components . </S>",
    "<S> 1 ) distractor filtering . with holistic representations , </S>",
    "<S> noise images are filtered out from the database , so the number of candidate images to be used for comparison with the query can be greatly reduced . </S>",
    "<S> 2 ) adaptive weighting . for a certain query </S>",
    "<S> , the similarity of candidate images can be estimated by holistic similarity scores in complementary to the local ones . </S>",
    "<S> 3 ) candidate refining . </S>",
    "<S> accurate retrieval is conducted via local features , combining the pre - computed adaptive weights . </S>",
    "<S> experiments are presented on two benchmarks , _ </S>",
    "<S> i.e. , _ holidays and ukbench datasets . </S>",
    "<S> we show that our method outperforms recent fusion methods in terms of storage consumption and computation complexity , and that the accuracy is competitive to the state - of - the - arts .    </S>",
    "<S> shell : bare demo of ieeetran.cls for ieee journals    image retrieval , coarse - to - fine , holistic representation , local feature . </S>"
  ]
}