{
  "article_text": [
    "one of the main motives behind the recent development of the uppsala quantum chemistry package , uquantchem)@xcite , has been to complement the broad selection of quantum chemistry codes available with an `` easy to use '' , open source , development friendly and yet versatile computational framework .",
    "the other motive , which has perhaps been the most important driving force , is to provide a pedagogical platform for students and scientists active in the computational chemistry community that are harboring intermediate to basic programming skills , but nevertheless are interested in learning how to implement new computational tools in quantum chemistry .",
    "the didactical design of the code has been achieved by limiting the level of optimization , not to obscure the connection between the different quantum chemical methods implemented in the package , and the actual text - book algorithms @xcite , upon which the construction of the code rests .",
    "the user - friendliness of the uquantchem package has been ascertained by a large set of default values for the computational parameters , in order for the inexperienced user not to get overwhelmed by technical details .",
    "furthermore , thanks to the limited number of pre - installed computational libraries required prior to the installation of the uquantchem code ( only the linear algebra package ( lapack)@xcite and the basic linear algebra subprograms ( blas)@xcite are required ) the package is also very simple to install .",
    "the uquatchem code has been written completely in fortran90 and comes in three versions ; a serial version , an openmp version and a mpi version . in the case of the serial and the openmp version ,",
    "more or less generic make files are provided for the ifortran and gfortran@xcite compilers .",
    "the mpi version of the uquantchem code comes with pre - constructed make files for five of the largest computer clusters in sweden , the lindgren cluster@xcite , the matter cluster@xcite , the triolith cluster@xcite , the abisko cluster@xcite and the kalkyl cluster@xcite .",
    "these makefiles can be used as templates to create makefiles for a broad selection of clusters .",
    "the wide range of capabilities of the uquantchem package is perhaps best illustrated by the different levels of chemical theory in which the electron correlation can be treated by uquantchem , ranging from hartree - fock and mller plesset second order perturbation theory ( mp2)@xcite to configuration interaction@xcite , density functional theory ( dft)@xcite and diffusion quantum monte carlo ( dqmc)@xcite .",
    "the uquantchem package provides a platform on which further development can easily be made , since the implementation of the different electronic structure techniques in uquantchem has , to a large extent , been made almost in one to one correspondence with the text books of _ szabo and ostlund _ @xcite and _ cook _",
    "@xcite , i.e the code has been transparently written and well commented in reference to these texts .",
    "the developer friendliness is further enhanced by the explicit calculation of all relevant data structures such as kinetic energy integrals , potential energy integrals and their gradients with respect to electron and nuclear coordinates .",
    "furthermore , since the uquantchem is constructed from a very limited number of subroutines and modules , an overview of the data structure and design of the code is easilly achieved , simplifying any future modification of the program .",
    "the uquantchem code is a versatile computational package with a number of features useful to any computational chemist .",
    "the main ingredient in any quantum chemical calculation is the level of theory in which the correlation of the electrons are treated , here the uquantchem package is no exception .",
    "the least computational demanding level of theory explored by the uquantchem code is the hartree - fock level of theory , where the electron correlation is completely ignored .    in the context of hartree - fock total energy calculations it is also possible to calculate analytical inter - atomic forces , enabling the user to either relax the molecular structure with respect to the hartree - fock total energy , or perform molecular dynamics ( md ) calculations . here",
    "the user can either choose to run a born - oppenheimer molecular dynamics calculation ( bomd ) , or an extended lagrangian molecular dynamics calculation ( xl - bomd ) , where the density matrix of the next time - step is propagated from the previous time step by means of an auxiliary recursion relation@xcite .",
    "the advantage of the xl - bomd methodology over the bomd approach is that in the case of xl - bomd , there is no need of a thermostat and an accompanying rescaling of the nuclear velocities in order to suppress any energy drift .",
    "o molecule , where the density matrix from the previous time step , is used as the initial guess to the scf optimization with the energy converged to @xmath0hartree , blue dotted line .",
    "the total energy of a extended lagrangian born - oppenheimer molecular dynamics ( xl - bomd)@xcite calculation of a h@xmath1o molecule with 5 scf iterations per time step , full black line . ]    in figure [ fig : xlbomd ] the results obtained with the uquantchem code for a h@xmath1o molecule using the xl - bomd and bomd schemes without thermostat are shown . here",
    "the superiority of the xl - bomd approach over the bomd scheme is manifested by the lack of energy drift in the former s total energy .    on the intermediate level of electron correlation theory implemented in the package one finds mp2@xcite , cisd@xcite and dft@xcite .",
    "when using the dft level of electron correlation it is also possible to calculate analytical interatomic forces , and therefore also perform structural relaxation and molecular dynamics calculations . here",
    "the dft forces are analytical to the extent that the gradients with respect to nuclear coordinates of the exchange correlation energy are calculated as analytical gradients of the quadrature expression used to calculate the exchange correlation energy@xcite .    the highest level of electron correlation theory possible to utilize within the uquantchem package is dqmc@xcite .",
    "here it is possible , within the fixed node approximation@xcite , to calculate total ground state energies of medium sized molecules taking into account @xmath2 of the correlation energy . in figure",
    "[ fig : dqmc ] the estimated charge density of a h@xmath1o molecule is shown , here calculated with dqmc as implemented in uquantchem .",
    "time steps with a time step of @xmath3 au , and a cusp corrected@xcite cc - pvtz basis .",
    "the resulting ground state energy was @xmath4 a.u .",
    "the rendering of the charge density map was obtained by using the uquantchem output file ` chargedens.dat ` as input to the matlab script ` chargdens2dim.m ` , which is a script provided with the uquantchem package . ]",
    "apart from the different methods involved in dealing with electron correlation implemented in the uquantchem package , a number of other capabilities can also be found within the package . amongst these capabilities",
    "is the ability to provide graphical information about the highest occupied and the lowest unoccupied orbitals ( homo and lumo ) , deal with charged systems as well as calculating mulliken charges , plot the hartree - fock and kohn - sham orbitals as well as the corresponding charge density , calculate the velocity auto - correlation function and relax the molecular structure with respect to interatomic forces by utilizing a conjugate gradient scheme .",
    "however , it should be stressed that the code can only deal with finite systems , thus excluding any calculation of periodic systems .",
    "the code utilizes a localized atomic basis set , where each basis function , @xmath5 , is constructed from a contraction of primitive cubic gaussian orbitals@xcite @xmath6 here , @xmath7 are the contraction coefficients , @xmath8 are the atomic coordinates at which the basis function is centered , @xmath9 are the primitive gaussian exponents and @xmath10 and @xmath11 integer numbers determining the angular momentum , @xmath12 , of the corresponding basis function . in what follows",
    "we will suppress the spin part of the basis functions and assume that the spin degrees of freedom are treated implicitly , i.e have been integrated out .",
    "thanks to the use of primitive gaussians almost all the matrices involved in the different implementations , such as the overlap matrix , @xmath13 , the kinetic energy matrix , @xmath14 and the nuclear attraction matrix , @xmath15 defined by @xmath16 have been calculated analytically . here",
    ", @xmath17 denotes the atomic numbers of the nuclei .",
    "the implementation of the analytic evaluation of the above integrals follows almost exactly the outline given in d. b. cook s book _ handbook of computational chemistry_.@xcite    in order to enhance the performance of the code , the electron - electron integrals , @xmath18 have been calculated by rys quadrature@xcite , even though they can be calculated analytically as is described in cook s book@xcite .",
    "the exchange correlation energy , @xmath19 and the corresponding exchange correlation matrix elements , @xmath20 @xmath21\\rho(\\mathbf{r } ) , \\qquad   \\qquad \\qquad \\\\",
    "v^{xc}_{ij } =   \\int d^{3}\\mathbf{r}\\phi_{i}(\\mathbf{r})\\frac{\\delta e_{xc}}{\\delta \\rho}\\phi_{j}(\\mathbf{r})=    \\nonumber \\qquad \\qquad",
    "\\\\   = \\int d^{3}\\mathbf{r}\\phi_{i}(\\mathbf{r})\\frac{d ( \\epsilon_{xc}\\rho)}{d \\rho}\\phi_{j}(\\mathbf{r } ) + \\tilde{v}^{xc}_{ij } ,   \\qquad \\qquad \\\\ \\tilde{v}^{xc}_{ij } = \\int \\frac{d^{3}\\mathbf{r}}{|\\nabla\\rho|}\\big ( \\nabla \\phi_{i}\\cdot\\nabla\\rho \\phi_{j } + \\phi_{i}\\nabla\\rho\\cdot \\nabla \\phi_{j}\\big ) \\frac{d(\\epsilon_{xc}\\rho)}{d |\\nabla\\rho|}\\end{aligned}\\ ] ] defined through the exchange correlation energy density , @xmath22 $ ] , and the functional derivative of the exchange correlation energy @xcite , @xmath23 have been calculated by decomposing the above spatial integrals into sums of integrals over atom - centered `` fuzzy '' polyhedra , as described by becke@xcite .",
    "each one of these polyhedral integrals is computed by the use of gauss - chebyshev quadrature of second order@xcite , and lebedev quadrature@xcite . here",
    ", @xmath24 denotes the charge density .",
    "the only difference between the implementation of the above integrals in uquantchem and the outline given by becke@xcite , is that in the uquantchem implementation , the mapping of the interval @xmath25 $ ] into the radial integration interval @xmath26 $ ] , enabling the use of gauss - chebyshev quadrature , is contrary to what is prescribed by becke done with the mapping @xmath27.\\ ] ] here @xmath28 is the slater atomic covalent radius@xcite of the atom at which the corresponding `` fuzzy '' tetrahedron is centered .",
    "it has been shown by mura _",
    "et al_@xcite that the above mapping results in a much more accurate numerical integration as compared to what is achieved with the mapping proposed by becke@xcite .",
    "the density functionals provided with the uquantchem package are the local density approximation ( lda ) functional of vosko _",
    "et al_@xcite , the revised gradient corrected functional of perdew _ et al_@xcite ( revpbe)@xcite and the b3lyp hybrid functional@xcite .",
    "the mp2 implementation and the cisd implementation very closely follow the outline given in the text - book of szabo and ostlund @xcite .",
    "the implementation of the dqmc algorithm in uquantchem follows closely the algorithm outlined in the work of umrigar _ et al _ @xcite .",
    "however , in uquantchem the trial function is constructed with a much simpler jastrow factor , @xmath29 , and the slater determinants are constructed from cusp corrected gaussian orbitals , instead of slater type orbitals ( sto ) , as in the work of umrigar _",
    "et al_. the implementation of the cusp correction in uquantchem follows the prescription given by s. manten and a. lchow @xcite .",
    "the explicit form of the trial function used for the importance sampling in the dqmc of uquantchem is given by : @xmath30 where @xmath31 @xmath32 is the distance between electron @xmath33 and @xmath34 , @xmath35 and @xmath36 are the slater determinants created from spin up respectively spin down orbitals .",
    "the orbitals are constructed from the unrestricted hartree - fock ( urhf ) self consistent solution . here",
    "@xmath37 if the spin of the electrons @xmath33 and @xmath34 are identical otherwise if the spins are opposite , @xmath38 . here ,",
    "@xmath39 and @xmath40 are jastrow parameters that can be chosen and optimized by the user .",
    "as was mentioned in the introduction , the uquantchem package has been written with the aim of keeping a high level of transparency in order to facilitate further development , with the result of a somewhat limited computational speed for the serial implementation of the code .",
    "a quantitative illustration of the performance limitation of the uquantchem code is obtained by comparing the total execution times of the uquantchem code with corresponding times of the gamess code @xcite . when comparing the execution times for a hf total energy calculation employing a cc - pvtz basis set , the gamess code is about 15 times faster on a dual intel core processor . and",
    "if one instead would compare the performance of the two codes when doing a b3lyp calculation , on the same system , with the same basis and the same machine , the gamess code come out to be @xmath41 150 times faster .",
    "therefore we will in this section more carefully discuss these performance limitations and how they have been dealt with by means of parallelization within the context of the message passing interface ( mpi ) .    in figure",
    "[ fig : time ] ( a - e ) , in order to highlight the performance of the code , the results of a series of total energy calculations obtained with the serial version of the uquantchem code are displayed . here in ( a - d )",
    ", the logarithm of the computational time , @xmath42 , and the finite difference , @xmath43 , as a function of number of basis - set functions are displayed , and in ( e ) , the logarithm of the computational time , @xmath42 , and the finite difference , @xmath44 , as a function of number of electrons z are displayed . from these finite differences the computational time of the hf implementation can be seen to scale as @xmath45 , and the computational time of the dft implementation scale as @xmath46 , which are comparable with the nominal scaling of these methods , @xmath47 and @xmath48 , respectively , found in the literature .",
    "however , when it comes to the computational time scaling of the mp2 and cisd implementation in uquantchem , with nominal scalings of @xmath49 and @xmath50 , respectively , the situation is worse . here",
    "the computational time scales as @xmath51 for a basis set size of @xmath52 , for the mp2 implementation , and as @xmath53 for the cisd implementation for basis sets of size @xmath54 .",
    "finally , from the lower panel of figure [ fig : time ] ( e ) the computational time of the dqmc calculation can be seen to scale approximately as @xmath48 , which is basically equal to the nominal scaling found in the literature . here",
    "the jump in the finite difference at z = 3 , in figure [ fig : time ] ( e ) , is related to the stochastical nature of the dqmc scheme .    in figure",
    "[ fig : timing ] the speed - up relative to the serial execution time , @xmath55 , for a couple of total energy benchmark calculations of the uquantchem mpi version is displayed .",
    "o using a cc - pvqz basis set , the red squares is the speed - up of a density functional theory ( dft ) @xcite calculation of h@xmath1o using the perdew , burke and ernzerhof ( pbe ) functional@xcite and a cc - pvtz basis set , the green triangles is the speed - up of a second order mller plesset ( mp2 ) @xcite calculation of h@xmath1o using a cc - pvtz basis set , the empty blue diamonds is the speed up of a singles and doubles configuration interaction ( cisd ) calculation of h@xmath1 using a cc - pvtz basis set and the violet crosses is the speed - up of a quantum diffusion monte carlo ( qdmc ) @xcite calculation of a single be atom utilizing a cc - pv5z basis set . in all the calculations . here",
    "the computational time on one single processor , @xmath55,was the following : @xmath55 = 13547 s for the hartree - fock calculation , @xmath55 = 1764 s , for the dft calculation , @xmath55 = 5995 s for the mp2 calculation , @xmath55 = 3381 s for the cisd calculation and @xmath55 = 44300 s for the qdmc calculation .",
    "the inset shows an enlarged portion of the figure in order to more clearly expose the region in which the different paralellizations are close to maximum efficiency . ]    here the most effective paralellization , when using around 500 processors , is found in the hartree - fock ( hf ) and diffusion quantum monte carlo ( dqmc ) implementations , where the speed - ups of @xmath56 , in the case of the hf implementation , and @xmath57 , in the case of the dqmc implementation , correspond to efficiencies of the respective parallelizations of 76% respectively 56% .",
    "the speed - up of the mp2 and cisd implementations , at the same number of processors , only reaches @xmath41 30% efficiency , with the dft paralellization performing slightly better .",
    "when using more than 1000 processors the hf level of theory prevails as the most effectively parallelized method , at which point the speed - up of dqmc method has already saturated and been overtaken by the cisd method . before we continue , we note in passing that the number of processors at which the speed - up ( at any level of theory ) is saturated strongly depends on the serial execution time , @xmath55 , i.e on the system size and the number of basis functions used in the calculation . therefore it should be stressed that it is more informative to compare the efficiency of the different parallelizations rather than the number of processors at which the speed - up saturates .",
    "the difference in efficiency between parallel hf calculations and the parallel mp2 and cisd calculations , comes from the fact that in the case of the hf calculation , only the computation of two - electron integrals , @xmath58 , and the contraction of these integrals with the density matrices @xmath59 into fock , @xmath60 , and exchange , @xmath61 , matrices , i.e @xmath62 are parallelized .",
    "whereas in the case of the mp2 calculation , also the sum of two - particle excitations@xcite are made in parallel , and in the case of the cisd calculations , both the construction of the hamiltonian and the diagonalization are made in parallel , thanks to the utilization of the scalable linear algebra package ( scalapack)@xcite _ divide and conquer _ diagonalization routine ` pdsyevd`@xcite .",
    "furthermore , since the storage of the cisd hamiltonian is shared amongst all the computational nodes taking part in the calculation , memory bottlenecks can be avoided , permitting the computation and diagonalization of hamiltonians of substantial size .    the difference in the performance between parallel implementations of hf and dft comes from the fact that in the dft implementation , not only the computation of two - electron integrals and their contraction are parallelized , as in the hf implementation , but also the calculation of the exchange - correlation potential and exchange correlation energy by means of numerical quadrature is parallelized .",
    "furthermore , in order to accelerate the convergence of the hf and dft self consistent calculations , the direct inversion of the iterative subspace algorithm ( diis ) of p. pulay@xcite has also been implemented in both the serial and parallel versions of uquantchem .",
    "the uqantchem package has been developed to be easily installed and run on unix - type platforms .",
    "the code has been compiled without any problems on machines running under mac osx 10.7 , red - hat linux and ubuntu , using either the gfortran or ifort compilers .",
    "the interface of the code with the user goes mainly through one single file , the ` inputfile`-file , through which the user specifies what type of calculation is going to be performed on what type of molecule .",
    "below , the ` inputfile`-file specifying a dft calculation of the total energy and homo - lumo orbitals of a water molecule is given .",
    "+   + ` corrlevel b3lyp tol 1.0e-8 whomolumo .t .",
    "ne 10 natoms 3 atom 1  0.4535 1.7512 0.0000 atom 8  0.0000 0.0000 0.0000 atom 1 -1.8090 0.0000 0.0000 ` +   + apart from the ` inputfile`-file the user is only required to provide the code with the so called ` basisfile`-file , specifying which type of gaussian basis set to use in the calculation .",
    "the most common basis - sets used in modern quantum chemistry are provided within the uquantchem package .",
    "there is also the possibility to use the information at the _ basis exchange portal _",
    ", located at ` https://bse.pnl.gov/bse/portal ` , to extend the default library of basis - sets that comes with the uquantchem package .    once the user has made sure that the files ` inputfile ` and ` basisfile ` are located in the same directory as the code is being executed , then , in order to run for instance the serial version of the code , it is just a matter of giving the command : + `` ` commad - prompt>./uquantchem.s ` '' + on the command line .",
    "thus from the above given expos , it becomes apparent that the user can , after the code has been compiled , quickly start performing quantum chemical calculations without getting overwhelmed by a plethora of input - parameters and input - files .",
    "however , when necessary , the user can always bypass the default settings and more carefully specify the calculation with the computational input - parameters that were initially `` hidden '' .",
    "in table [ table : table1 ] and table [ table : table2 ] , we show the results of a series of geometry optimization calculations obtained with uquantchem and the well established gamess code @xcite . here",
    "the results obtained with uquantchem are virtually indistinguishable from the results obtained with the gamess code , especially when comparing the results obtained with the b3lyp hybrid functional . in order to calculate the exchange correlation potential matrix elements in these uquantchem calculations , gauss - chebyshev quadrature of the second kind with 100 grid points was used for the radial integration , and lebedev quadrature @xcite using 194 angular grid points",
    "was used for the angular part of the integration .",
    "the structures of the molecules were considered optimized when the absolute values of the interatomic forces had been relaxed down to @xmath63 a.u .    in table",
    "[ table : table3 ] , the corresponding experimental structural parameters are also displayed .    [ cols=\"^,^,^,^,^,^,^,^,^,^ \" , ]     [ table : table3 ]",
    "in order to test that the compilation of the uquantchem package have been successful , seven different test - calculations have been provided within the package .",
    "the input files of these calculations are located in the subdirectories ` run1,run2,\\ldots , run7 ` of the ` tests ` -directory .",
    "here follows a brief description of these tests :    * * run1 : * an unrestricted hartree - fock total energy calculation of a single water molecule . *",
    "* run2 : * a dft total energy calculation using the revpbe functional of a single water molecule . *",
    "* run3 : * a dft total energy calculation and interatomic force calculation using the b3lyp functional of a single water molecule . *",
    "* run4 : * a mp2 total energy calculation of a single water molecule . *",
    "* run5 : * a cisd total energy calculation of a single be atom .",
    "* * run6 : * a dqmc total energy calculation of a single he atom , using a cc - pvtz basis set . *",
    "* run7 : * an unrestricted hartree - fock structural relaxation of a single water molecule , using a sto-3 g basis set .    in al tests listed above the 6 - 31 g * * basis",
    "is used except in test calculations run6 and run7 . to run the test calculations",
    "the user just have to execute the command : ` ./runtests.pl ` , in the root directory of the uquantchem code .",
    "the uquantchem software comes with a set of supporting utility scripts for generating two - dimensional charge - density plots and three - dimensional iso - density plots with matlab .",
    "see for example figure [ fig : dqmc ] showing a two - dimensional charge - density plot of a water molecule generated with the ` chargdens2dim.m ` matlab script included in the software package .",
    "the uquantchem has been adapted to work with the graphical software package xcrysden @xcite , by generating a number of files in the xsf - format . in figure",
    "[ fig : homolumo ] the highest occupied molecular orbital ( homo ) iso - surface and the lowest unoccupied molecular orbital ( lumo ) iso - surface of alanine are shown .",
    "the rendering of the iso - surfaces was obtained by using the uquantchem output files ` homo.xsf ` and ` lumo.xsf ` as input to the xcrysden@xcite graphical software package .",
    "in this work the recently developed quantum chemistry package uquantchem has been presented together with the results of some performance benchmark calculations . here ,",
    "even though the scaling of the computational time with respect to system size , especially the mp2 and cisd implementations , leave room for much improvement , the mpi - implementation of the package compensates rather well for the limited performance in the serial version , enabling the uquantchem package to be utilized as a `` proof of principle '' platform for new computational ideas in quantum chemistry , or to be utilized in standard quantum chemistry calculations of molecules with @xmath64 100 atoms .",
    "thanks to professor olle eriksson for his patience and to carl caleman and anders niklasson for their inspiration .      36 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2 , http://www.anst.uu.se",
    "/ pesou087/download - uquantchem / download - u% quantchem / download - site - uquantchem.html[http://www.anst.uu.se / pesou087/download - uquantchem / download - u% quantchem / download - site - uquantchem.html ] .",
    "here the conventional definition of the _ functional derivative _ is used as opposed to the more unconventional definitions : @xmath65\\rho \\equiv   \\frac{d ( \\epsilon_{xc}\\rho)}{d \\rho}$ ] , + @xmath66\\rho \\equiv   \\frac{d ( \\epsilon_{xc}\\rho)}{d ( \\nabla\\rho)_{x}}$ ] , + @xmath67\\rho \\equiv   \\frac{d ( \\epsilon_{xc}\\rho)}{d ( \\nabla\\rho)_{y}}$ ] , + @xmath68\\rho \\equiv   \\frac{d ( \\epsilon_{xc}\\rho)}{d ( \\nabla\\rho)_{z}}$ ] , + which were used in the comp .",
    "-version of this article                                    m.f .",
    "guest , i. j. bush , h.j.j .",
    "van dam , p. sherwood , j.m.h .",
    "thomas , j.h .",
    "van lenthe , r.w.a havenith , j. kendrick , `` the gamess - uk electronic structure package : algorithms , developments and applications '' , molecular physics , * 103 * , 719 - 747 ( 2005 ) ."
  ],
  "abstract_text": [
    "<S> in this paper we present the uppsala quantum chemistry package ( uquantchem ) , a new and versatile computational platform with capabilities ranging from simple hartree - fock calculations to state of the art first principles extended lagrangian born oppenheimer molecular dynamics ( xl - bomd ) and diffusion quantum monte carlo ( dmc ) . </S>",
    "<S> the uquantchem package is distributed under the general public license and can be directly downloaded from the code web - site@xcite . </S>",
    "<S> together with a presentation of the different capabilities of the uquantchem code and a more technical discussion on how these capabilities have been implemented , a presentation of the user - friendly aspect of the package on the basis of the large number of default settings will also be presented . </S>",
    "<S> furthermore , since the code has been parallelized within the framework of the message passing interface ( mpi ) , the timing of some benchmark calculations are reported to illustrate how the code scales with the number of computational nodes for different levels of chemical theory . </S>"
  ]
}