{
  "article_text": [
    "the simulation of fluid flow and transport processes through porous media is an important field that contributes to a number of scientific and engineering applications , e.g. , oil extraction , groundwater pollution , nuclear waste storage , and chemical reactors .",
    "the application of pore - scale simulations is challenging in most practical situations since the system under study is often by orders of magnitude larger than the characteristic size of the pores .",
    "thus for practical purposes , many computational techniques are based on macroscopic models that average over many pores and consider average flow rates .    for steady state flow at low reynolds numbers a generally accepted and experimentally confirmed macroscopic relation between the pressure gradient and flow rate",
    "is given by darcy s law @xmath0 where @xmath1 is the fluid dynamic viscosity , @xmath2 is a permeability tensor associated with the geometry of the porous medium under consideration , and @xmath3 and @xmath4 are the volume averaged velocity and pressure , respectively .",
    "this model , which was first found by @xcite in experimental investigations , is valid in the regime @xmath5 , where @xmath6 is the reynolds number based on a characteristic pore - diameter @xmath7 , @xmath8 denotes the density of the fluid , and @xmath9 is the scalar velocity in streamwise direction @xmath10 . at larger",
    "pore reynolds numbers , @xcite observed a non - linear deviation from this relation , for which he proposed the addition of a quadratic term , namely    @xmath11    where @xmath12 is the constant inertial factor proposed by forchheimer , which mainly depends on the flow path and is usually found experimentally . replacing the @xmath12 factor by a dimensionless forchheimer constant as @xmath13",
    ", equation is known as hazen  dupuit  darcy equation @xcite .",
    "although the forchheimer equation is widely used in porous media simulations , recent studies suggest that the correction has also a limited range of applicability @xcite .",
    "a recent experimental study of @xcite showed that the @xmath12 factor which is measured in the laminar regime is not generally valid for the whole range of the fluid flow . in @xcite the use of two different values for permeability is proposed , together with distinct values @xmath12 for laminar and turbulent flow through the spherical particles . in particular ,",
    "in the range @xmath14 , the flow becomes turbulent and significant deviations from the forchheimer model with the laminar @xmath12 can be observed .",
    "based on a series of experiments , @xcite proposed another model that has the same structure as the darcy model but which replaces the absolute permeability @xmath15 by an apparent permeability @xmath16 .",
    "the apparent permeability can be measured in the same way as the darcy permeability , but it depends on the flow in a non - linear fashion and is approximated as @xmath17 here , @xmath18 and @xmath19 are exponential coefficients that describe the heterogeneity of the porous medium , and @xmath20 is the reynolds number based on a transition length scale @xmath21 , and @xmath22 is a minimum permeability that is attained at high reynolds numbers .",
    "this model is proposed based on the conjecture of two plateau areas for permeability at low and high reynolds number . while the plateau areas at low reynolds numbers corresponds to the darcy regime , and the prediction of the barree",
    " conway model in the transition region shows good agreement to experiments @xcite , the plateau at higher reynolds numbers is largely hypothesized . to the best knowledge of the authors , no experimental setup or numerical simulation",
    "was published that exhibits the plateau behavior at high reynolds numbers .",
    "while the rigorous , analytic up - scaling of the pore - scale problem at lower reynolds numbers has received much attention in the literature @xcite , similar approaches for higher reynolds numbers have not been demonstrated to date .",
    "this is mainly due to the immense mathematical difficulties that arise in the flow models if a moderate reynolds number can not be assumed .",
    "however , with the rise of extremely capable supercomputers , the direct numerical simulation ( dns ) has been established as a third possibility for the analysis of homogenized models that can complement the classical experimental and the rigorous mathematical averaging approaches . in the past two decades",
    ", the class of lattice boltzmann methods ( lbm ) has attracted the interest of researchers in cfd - related areas .",
    "in contrast to traditional cfd approaches based on the conservation of macroscopic quantities like mass , momentum , and energy , the lbm models the fluid by the kinetics of discrete particles that propagate ( streaming step ) and collide ( relaxation step ) on a discrete lattice mesh . due to this kinetic nature , microscopic interactions in the fluid flow can be handled even in complex geometries , such as in micro - fluidic devices or in porous media  @xcite .",
    "moreover , due to the inherently local dynamics , an efficient implementation and parallelization of both fundamental algorithmic stages of the lbm is possible which allows to harness the computational power of currently available and emerging super - computing architectures @xcite . in this study",
    ", we use the walberla framework ( widely applicable lattice - boltzmann from erlangen ) @xcite that is aimed at massively parallel fluid flow simulations , enabling us to compute problems with resolutions of more than one trillion ( @xmath23 ) cells and with up to 1.93 trillion cell updates per second using 1.8 million threads @xcite .",
    "walberla has already been used to study the flow through moderately dense fluid - particle systems in @xcite and to simulate large scale particulate flows @xcite .",
    "it is based on four main software concepts , namely blocks , sweeps , communication and boundary handling @xcite .",
    "the modular structure of this framework allows the implementation of new lbm schemes and models .",
    "however , having immense computational power at hand is not enough to solve relevant problems : due to the explicitness of classical lbm methods the spatial and temporal discretization characteristics are strongly coupled .",
    "hence , special care has to be taken for pore - scale simulations to properly incorporate the physics at the boundaries and inside the domain without over - resolving the problem .",
    "as already pointed out in the evaluation of @xcite , this requires a suitable combination of collision and boundary operators .",
    "a common way to simulate pressure driven flow is to replace the pressure gradient with an equivalent body force and applying stream - wise periodic boundary conditions .",
    "however , previous studies @xcite show that using this approach does not lead to correct flow fields for the flow through complex geometries , e.g. , in general porous media . in this article",
    "we drive the flow by imposing the pressure gradient while applying the periodic boundary condition in stream - wise direction and allow the flow to develop based on the geometry . in this study , we employ a simple periodic pressure scheme for incompressible flow and investigate it in combination with different types of collision operators and a number of first to third order bounce back schemes for the treatment of the boundaries",
    ".    to model porous media , we simulate the flow through simple sphere packs by a number of different lbm approaches which we briefly outline in section [ sec : lbm - approaches ] .",
    "their accuracy , convergence and the associated computational costs are investigated in section  [ results ]   for flow in the darcy regime , where semi - analytic solutions exist to compare with .",
    "also the scalability of different boundary schemes is investigated to choose the best combination for the high resolution simulation in high reynolds numbers flow .",
    "having found a suitable configuration , we then simulate the flow through a simple sphere pack in section  [ sec : results - nondarcy ] .",
    "by sampling over the regime @xmath24 $ ] , we numerically investigate the plateau hypothesis of the barree and conway model in the turbulent regime .",
    "additionally , we measure the forchheimer constant @xmath25 for laminar and turbulent regimes . to highlight the ability of the proposed lbm to deal with complex geometries , in section  [ sec : results_turbu_porous ]   we also present an illustration of turbulent flow over a permeable wall which is constructed by rigid - body interaction of the spheres .",
    "the lattice boltzmann equation ( lbe ) is a simplification of the boltzmann kinetic equation where we assume that particle velocities are restricted to a discrete set of values @xmath26 , @xmath27 , i.e. , the particles can only move along a finite number of directions , connecting the nodes of a regular lattice @xcite . in the following ,",
    "we consider a three dimensional 19-direction lattice , the so - called d3q19 model , which provides a good compromise between computational accuracy and parallel efficiency .",
    "discretizing in time using a time - step size of @xmath28 , the semi - discrete lbe then reads as @xmath29    where @xmath30 represents the probability of finding a particle at some position @xmath31 and time @xmath32 with velocity @xmath33 .",
    "the left hand side of corresponds to a discrete representation of the boltzmann streaming operator , while the right hand side @xmath34_{k=0}^{18}$ ] is responsible for controlling the relaxation to a local equilibrium .",
    "it is generally split into @xmath35 , where @xmath36 is a collision term function of @xmath37_{i=0}^{18}$ ] , and @xmath38 is a forcing term that drives the flow .",
    "provided that the modeled fluid is close to its equilibrium state , bhatnagar , gross and krook  ( bgk ,  @xcite ) proposed that the discrete local equilibria in collision processes can be modeled by a second - order expansion of a local maxwellian .",
    "the collision operator takes the general form @xmath39 where @xmath40 is a relaxation operator and @xmath41 is an equilibrium distribution function of @xmath42 which , for incompressible flow , is given by @xcite @xmath43 \\right\\rbrace,\\ ] ] where @xmath44 is a set of weights normalized to unity , @xmath45 while @xmath46 is the density fluctuation and @xmath47 is the mean density which we set to @xmath48 , @xmath49 is the lattice speed of sound , while @xmath50 is the lattice cell width .",
    "the macroscopic values of density @xmath8 and velocity @xmath51 can be calculated from @xmath52 as zeroth and first order moments with respect to the particle velocity , i.e. , @xmath53    in a lattice boltzmann scheme , we typically split the computation into a collision and streaming step , which are given as @xmath54    respectively , for @xmath55 .",
    "the execution order of these two steps is arbitrary and may vary from code to code for implementation reasons .",
    "for instance , in walberla , the order is first streaming and then collision .",
    "this has the benefit that the stream and collision steps can be fused and that the macroscopic values need not be stored and later retrieved from memory .",
    "two important components must be investigated whenever one aims to study the numerical properties ( i.e. , stability , convergence and accuracy ) as well as the computational cost - efficiency of an lbm based approach : firstly , we have to consider the treatment of the collision term @xmath56 in the relaxation step . secondly",
    ", since the nodes of the lattice in the lbm approach are only distinguished into fluid and solid nodes , the choice of the bounce - back operator for the fluid - wall interaction is important for the numerical accuracy .",
    "unfortunately , the relaxation and the bounce - back can not be treated as two independent ingredients , since their interplay is essential for finding a sweet spot between computational effort and physical accuracy .",
    "for instance , in the context of porous media flow , using the bgk collision operator in an approach with a single relaxation time ( srt ) @xmath57 , i.e. , @xmath58 is reported to suffer from numerical instabilities and moreover exhibits unwanted boundary effects  @xcite .",
    "more precisely , the effective modeled pore - size by the numerical scheme becomes viscosity - dependent . on a macroscopic level",
    "this has the effect that the calculated permeability in the stokes flow is slightly viscosity - dependent while physically it should be independent of the fluid properties @xcite",
    ". the limitations of this simple and computationally appealing approach outlined above are the motivation for the investigation of more sophisticated schemes .",
    "similar as in @xcite , our aim is to investigate different lbm approaches with the application of porous media flow in mind .",
    "however , we put our focus on boundary conditions which are suitable for flow driven by pressure - gradients instead of lumping these boundary conditions into a body - force .    before we present a detailed evaluation of suitable combinations for pore - scale simulations ,",
    "let us briefly summarize the different approaches .",
    "in the evaluation of @xcite it is reported that by using multiple relaxation time @xcite ( mrt ) schemes one can overcome the deficiencies of the srt approach when applied to porous media flow . in the mrt model ,",
    "the relaxation times for different kinetic modes can be treated separately , which allows fine - tuning of the free relaxation - times to improve numerical stability and accuracy .",
    "this is done by the ansatz @xmath59 where the components of the collision matrix in the mrt are developed to reflect the underlying physics of collision as a relaxation process .",
    "the rows of the orthogonal matrix @xmath60 are obtained by the gram - schmidt orthogonalization procedure applied to polynomials of the cartesian components of the particle velocities @xmath33 , and @xmath61 $ ] is the diagonal matrix holding the relaxation rates @xmath62 ; cf .",
    ", e.g. , @xcite for details . clearly , within this class of relaxation schemes , srt approaches are contained as a special case .",
    "the parameters @xmath63 , @xmath64 , @xmath65 and @xmath66 are the relaxation parameters corresponding to the collision invariant @xmath8 , and @xmath67 , respectively , which are conserved quantities during a collision .",
    "they are set to zero in the absence of a forcing term , i.e. , if @xmath68 .",
    "@xcite proposed to choose the remaining modes as follows : ( i ) viscous stress vectors @xmath69 , @xmath70 , @xmath71 , @xmath72 and @xmath73 equal to @xmath74 , which is related to the kinematic viscosity @xmath75 as @xmath76 , and ( ii ) , set the kinetic modes @xmath77 , @xmath78 , @xmath79 , @xmath80 , @xmath81 , @xmath82 , @xmath83 , @xmath84 , @xmath85 , and @xmath86 to @xmath87 , which is also related to the kinematic viscosity .",
    "however , as their evaluation showed , it does not lead to viscosity - independent results of the macroscopic quantities , except for the multi - reflection boundary scheme .",
    "as @xcite recently stated , this problem can be solved if one modifies the aforementioned model in a way that the symmetric energy modes , i.e. , @xmath77 and @xmath78 , keep the ratio @xmath88 constant while @xmath74 varies . in this study , we set this ratio to @xmath89 which provides better accuracy .    based on a symmetry argument , @xcite proposes a model based on two relaxation times ( trt ) , which can be seen as the minimal configuration that provides just enough free relaxation parameters to avoid non - linear dependencies of the truncation errors on the viscosity in the context of porous media simulations @xcite .",
    "the scheme is derived from the mrt approach by splitting the probability density functions @xmath90 into the symmetric and anti - symmetric components @xmath91 and @xmath92 , where @xmath93 is the diametrically opposite direction to @xmath94 @xcite . performing a separate relaxation by the two corresponding relaxation rates @xmath95 and",
    "@xmath96 yields the operator @xmath97 where @xmath98 and @xmath99 are the tensorial representations of the operators extracting the symmetric and antisymmetric components , respectively .",
    "the eigenvalue of the symmetric components is again related to the kinematic viscosity as @xmath100 , and the second eigenvalue @xmath101 is a free parameter . for steady non - linear flow situations , it has been demonstrated that most of the macroscopic errors depend on the so - called `` magic '' parameter @xmath102 which has to be determined for the specific flow setup .",
    "the choice @xmath103 is given as a suitable value for porous media simulations .",
    "another choice , namely @xmath104 , yields the exact location of bounce - back walls in case of poiseuille flow in a straight channel @xcite . in our studies ,",
    "we choose different values in the range @xmath105 $ ] .",
    "the exact numbers are listed in section [ sec : results - nondarcy ] .      in pore - scale simulations , we typically encounter two types of boundary conditions .",
    "the first one is a _ solid - wall interaction _ of fluid particles that come into contact with the porous matrix ( corresponding to a no - slip condition in continuum - mechanics terminology ) .",
    "the second one is a _ periodic pressure forcing _ that is applied to drive the flow by a pressure gradient in order to compute fluid or matrix properties such as the forchheimer coefficient or the ( apparent ) permeability .",
    "we shall next outline the different schemes under consideration for this study .      in a simple bounce - back ( sbb ) scheme",
    ", the wall location is represented through a zeroth order interpolation ( staircase approximation ) , and the collision of particles with a wall is incorporated by mimicking the bounce - back phenomenon of a particle reflecting its momentum upon collision with a wall , which is supposed to happen half - way between a solid and fluid node .",
    "hence , the unknown distribution function is calculated as : @xmath106 where we recall that @xmath93 is the diametrically opposite direction to @xmath94 , and we take the values @xmath107 after collision but before streaming on the right hand side . however , in complex geometries , the wall position is not always located half - way on a regular lattice .",
    "hence , especially at coarse resolutions , this boundary treatment introduces severe geometric errors , which in turn lead to boundary layer effects that can be particularly problematic in porous media of low porosity , where large part of the domain is occupied by solid nodes . here ,",
    "a discretization that adequately resolve the solid boundaries are often computationally prohibitive since the meshes would get too large .",
    "thus , several advanced schemes have been proposed to more accurately represent boundaries that are not mesh aligned using spatial interpolations @xcite .    in our numerical study , we compare five different interpolating boundary condition schemes to deal with curved boundaries , namely , the linear interpolation bounce - back ( libb , @xcite ) , the quadratic extension ( qibb , @xcite ) , the interpolation / extrapolation bounce back ( iebb , @xcite ) , the multi - reflection ( mr , @xcite ) scheme and the central linear interpolation ( cli , @xcite ) scheme . for",
    "the sake of completeness , let us briefly recall these different approaches .    . for simplicity",
    ", we only display a two - dimensional illustration . ]",
    "let @xmath108 denote a lattice node which is at a distance of at most @xmath109 cells from the boundary and let @xmath110 define a normalized wall distance ; cf .",
    "[ fig : differentbb ] . bounce - back schemes based on higher order interpolations require more than one fluid node between nearby solid surfaces .",
    "for instance , the libb condition proposed by @xcite is given by @xmath111    one can also use quadratic interpolation to obtain the qibb scheme @xcite , where the unknown distribution function would be calculated as : @xmath112 while the use of extrapolation is also possible to obtain better accuracy .",
    "however , care must be taken to preserve numerical stability@xcite .",
    "an interpolation / extrapolation bounce - back ( iebb ) model was proposed by @xcite as an improvement to the scheme of @xcite , where a velocity at the wall is computed via @xmath113    to determine an auxiliary distribution function @xmath114 \\right\\rbrace,\\\\\\ ] ]    which is then used to linearly interpolate the unknown as : @xmath115 above we let @xmath116 for @xmath117 , while for @xmath118 we let @xmath119 , where we set @xmath120 in case of the trt scheme and @xmath121 in case of the mrt scheme .    another alternative approach to obtain highly accurate bounce - back conditions is the multi - reflection ( mr ) scheme @xcite , which reads as @xmath122 note that this scheme needs to access five distribution values at three fluid nodes for the update .",
    "a computationally cheaper variant is given by the central linear interpolation scheme ( cli ) that only needs three values at two fluid nodes , i.e. , @xmath123 it should be noted that two latter schemes do not involve a distinction of cases for different values of @xmath124 which allows for an efficient implementation .",
    "the cli and mr schemes can be modified with a post collision correction @xmath125 to remove the second order error for steady flows .",
    "the correction term is constructed based on anti - symmetric non - equilibrium of the trt and mrt collision operators . however , since the correction is not suitable for unsteady flow , we do not consider it in this study .",
    "interested readers are referred to the work of @xcite .      in many applications ,",
    "fluid flow is driven by a pressure difference .",
    "for incompressible flow , the corresponding periodicity boundary conditions can be written as @xmath126 where @xmath127 is the length of the domain in the periodic direction @xmath10 , and @xmath128 is the pressure gradient applied between the inlet and outlet boundaries of the domain .    in lbm - based approaches , applying this type of boundary condition is not straightforward . simply adjusting the corresponding pressures at the inlet and outlet boundaries produces non - physical mass defects at the periodic boundary , as was reported e.g. for poisseulle flow in @xcite .",
    "the most commonly employed approaches replace the pressure gradient by incorporating an equivalent body force ; see e.g. @xcite .",
    "however , these approaches suffer from the inability to predict the pressure gradient accurately for flow situations in general geometries  @xcite .",
    "for porous media applications , where we face complex pore geometries it is therefore desirable to have a boundary condition that is not lumped into a volume forcing and hence does not rely on rough predictions of the pressure field . in this work , we employ a pressure boundary condition which can be applied for incompressible periodic flows . here",
    "we specify the equilibrium distribution function @xmath129 and the non - equilibrium distribution @xmath130 separately , as we shall describe below . as the extension to multiple periodic boundaries is straightforward",
    ", we consider in our description an essentially one - dimensional setting in which flow propagates from the left ( l ) to the right ( r ) boundary :    since the pressure is related to the density via the equation of state @xmath131 , we consider a density difference instead of pressure difference in the following .",
    "the density at the left boundary is obtained by @xmath132 regarding to the relaxation dynamics of the non - equilibrium distribution , in presence of the periodic boundaries , it can be approximated as @xmath133 now by using the above formulations , the unknown distribution functions can be computed as @xmath134    since the momentum in a periodic channel does not change , the implementation of this approach is simple .",
    "for instance , by considering , the update and can be performed as : @xmath135",
    "to verify the implementation and to assess the quality of the different schemes before tackling more complex flow problems , we shall in the following first evaluate different combinations of the lbm strategies discussed in section [ sec : lbm - approaches ] in the darcy regime , and compare the results with a semi - analytic solution .",
    "we consider flow through a periodic array of spheres arranged on a regular lattice as depicted in fig .",
    "[ fig : simplespherepack ] . to quantify the errors ,",
    "we compute the dimensionless drag coefficient @xmath137 where @xmath138 is the sphere radius , and @xmath139 is the drag force acting on the sphere .",
    "a semi - analytical reference solution @xmath140 can be derived as a function of the porosity by a series expansion ; for details on the calculation , we refer to @xcite .    to save on computational cost we compute the wall - distances required for the higher order boundary conditions only once before the time - stepping loop starts and reuse it in each boundary handling step .",
    "this can be done since we consider a non - deformable porous medium .",
    "moreover , we exploit the periodicity in the domain and consider only one cubic representative elementary volume ( rev ) containing a single sphere . for details on the boundary handling ,",
    "we refer to the previous section [ sec : bc ] .    in the following",
    ", we shall summarize our results related to the undesired effect of viscosity - dependence of the schemes .",
    "however , to make sure that the measured errors are not resulting from other approximation issues , and to compare the accuracy in terms of resolution which can be obtained by the different schemes , we shall first conduct a grid - convergence study .      in this test ,",
    "we change the size of the sphere and increase the computational domain accordingly , such that the relative solid volume fraction is fixed to @xmath141 .",
    "we compute the dimensionless drag force @xmath142 and consider the relative error @xmath143 . at the resolution where this quantity drops below @xmath144 and stays below this limit on finer lattices , we call the result grid - independent .",
    "our results are plotted in fig .",
    "[ fig : discretecollision ] .    it can be seen that using higher order boundary conditions generally increases the accuracy of the computed drag force . as fig .",
    "[ fig : discretesrtlog ] indicates , all of the interpolation boundary schemes have second - order accuracy when combined with the srt model . moreover ,",
    "for this example , we observe that the linear interpolation models , i.e. , libb and cli , show higher accuracy than the other schemes .",
    "for the cli scheme for instance , we reach a grid - independent solution at @xmath145 in lattice unit .",
    "in figures [ fig : discretetrtlog ] and [ fig : discretemrtlog ] , we list the results for the trt and mrt models , respectively . here",
    "we observe a difference between the cli and the mr schemes , i.e. , the cli scheme converges with second - order while the mr scheme converges with third - order .",
    "the results also exhibit that the iebb scheme converges with at least second order . for the trt model ,",
    "the results for the iebb scheme becomes grid - independent for @xmath146 , the mr with @xmath147 and the cli with @xmath148 .",
    "the mrt scheme also shows better accuracy than the srt collision model but it is found to converge slower than the trt model , which is additionally considerably less expensive in terms of computational effort .",
    "it is worth to mention here that the simulation results using the trt and mrt collision can be different by changing the magic number .",
    "this is why the sbb scheme in the srt collision gives better results than the trt and mrt collision in this specific test for which the magic number is set to @xmath149 in which the interpolation boundary schemes results in better accuracy .    in these experiments",
    "we also observe that the errors for most models do not smoothly decrease with respect to the resolution .",
    "comparing for instance the linear libb model with the quadratic qibb model reveals that the higher order scheme is less affected by this phenomenon . to investigate the source of these fluctuations ,",
    "we conduct a second series of tests where the center of the sphere is shifted streamwise inside the cell . in all cases , the radius of the sphere is kept fixed at 4.5 lattice units and the relative volume fraction is again set to @xmath150 . in fig .",
    "[ fig : displacementflactx ] , we show the results for a displacement of @xmath151 times a cell width . although the results obtained by the srt - sbb are relatively good for this setup , we observe that the sbb scheme is for all considered collision schemes more sensitive with respect to the positioning of the center .",
    "since this behavior stems only from the geometry representation , the use of interpolation models significantly increases the reliability of the results .",
    "as a number of authors previously reported , the choice of boundary conditions and collision models may have a strong impact on the simulation accuracy @xcite .",
    "to exclude pre - asymptotic discretization error modes from our observations and only concentrate on the physical inconsistencies introduced by a specific combination of collision and boundary treatment , we use a sufficient resolution of @xmath152 ( in lattice units ) for the sphere radius .",
    "since the permeability in the darcy regime is only a geometrical characteristic , it is used for comparison in this study .",
    "as proposed by @xcite , we compute the average pressure gradient in the flow direction as @xmath153 , where l is again the length of the domain in flow direction . by combining this and with",
    ", we find the reference permeability @xmath154 which we use as a reference .",
    "the plots of fig .",
    "[ fig : viscodep ] display the ratio @xmath155 of the computed permeability by the reference permeability for a simple sphere pack with a relative solid volume fraction of @xmath141 .",
    "we consider viscosities in the range @xmath156 $ ] and compare different collision models and boundary conditions . in fig .",
    "[ fig : viscosrt ] we show that for all boundary schemes , the srt collision results in a permeability that is strongly depending on the viscosity . while the iebb scheme is less sensitive than the other schemes , the errors we can expect from an srt collision model are still unacceptable for our purposes .",
    "the results of figures [ fig : viscotrt ] and [ fig : viscomrt ] depict the same set of experiments conducted with the trt and mrt models , respectively . in these plots , we observe that the sbb , the iebb , as well as the mr , and the cli schemes are nearly viscosity independent . however , the sbb severely under - predicts the permeability due to its staircase representation of the geometry .",
    "these results are in line with those found in the related work of @xcite .",
    "when comparing only the two linear boundary schemes , namely , the cli and the libb , we observe that the libb fails to produce viscosity - independent results with all collision models under consideration , while the cli has much better properties in this respect .",
    "our results obtained in section  [ sec : viscosity - effect ] and [ sec : griddep ] indicate that the trt and mrt collision operators in combination with the mr boundary scheme results in the most accurate solutions . given that the highly optimized split kernel of the trt implementation in walberla is about as fast as the srt model , there is no justification to use the mrt scheme , which is around a factor of two more expensive .",
    "while the question about the favorable collision operator is rather easy to answer , the choice of the right boundary treatment is less obvious .",
    "note , that especially for a dns of turbulent flow , where we have to scale the number of unknowns as @xmath157 to resolve the smallest dissipative scales , we can not avoid massive parallelism .",
    "unfortunately , the more accurate boundary handling methods must access lbm nodes from up to three cells away from the fluid particle boundary , see sect .  [",
    "sec : bc ] . in a massively parallel setting",
    ", such physical boundary points may be near a logical processor boundary that has been created by the domain partitioning for a distributed memory machine . in walberla",
    "this situation is handled by extra ghost - layer exchanges , i.e.  by communicating an extended set of distribution functions to neighboring processors along the subdomain boundaries .",
    "the data dependencies also cause additional synchronization overhead in the parallel execution . in a weak scaling scenario with few spheres embedded in the flow and where large subdomains can be handled on each processor",
    ", we have measured that the more advanced boundary schemes may already cause a slowdown of by 10% to 50% compared to the sbb method .",
    "however , for our computational objectives , more complex geometric configurations must be considered .",
    "then the communication of data quickly becomes the critical bottleneck . for our application",
    ", it is particularly important to save on communication since for production runs many timesteps are necessary until the desired solution is found .",
    "thus , to keep the compute times acceptable , only moderately large blocks of lbm nodes can be assigned to each processor .",
    "consequently , the ratio between computation and communication is already a bottleneck despite the highly optimized walberla  program and even when just one layer of ghost nodes is exchanged in every time step .",
    "this means that our typical simulation runs are already close to the strong scaling limit of the parallel execution , as analyzed in @xcite .    as a good compromise between the cost ( including communication on parallel computers ) and numerical accuracy , we choose here the trt - cli scheme for large pore - scale problems .",
    "it leads to a reasonably good accuracy , has no viscosity - dependence , and needs less communication than the mr scheme .",
    "hence , using the slightly less accurate but significantly better parallelizable method results in a considerable reduction of run - time .",
    "a more concise quantitative analysis of the performance trade offs , will require the development of sophisticated parallel performance models following the techniques of @xcite , but this is beyond the scope of the current paper .",
    "@xcite already presents program optimization for lbm simulations in the case of simple boundary conditions , as they are being used in the walberla  software framework .",
    "in this section , we present a series of pore - scale simulations for a reynolds number ranging over more than seven orders of magnitude , i.e. , @xmath24 $ ] .",
    "we conduct a direct numerical simulation through the simple sphere pack using the periodic - pressure boundary treatment combined with the trt - cli scheme .    to avoid grid - dependencies as well as instabilities resulting from under - resolved turbulence ,",
    "we conduct a grid - independence study for six different reynolds number ranges .",
    "we investigate the dependency of the drag coefficient , i.e. @xmath159 while @xmath160 represents the cross sectional area , on the resolution . to keep the re number of the flow the same ,",
    "we adjust the pressure drop , as well as the viscosity while changing the resolution . in table  [ tab : griddep ] , we list the resulting resolutions which were identified as sufficiently resolved for our purposes .",
    "also , the magic @xmath161 value is shown for different flow regimes .",
    "we consider a solution as converged if the computed time - averaged drag coefficient stops changing .",
    "the averaging will be started when the flow is developed , which usually takes around 400600 flow - through times to happen .",
    ".[tab : griddep ] the resolution and @xmath161 value which are chosen for different range of the @xmath162 numbers [ cols=\"<,^,^\",options=\"header \" , ]     fig .",
    "[ fig : streamlinelowre ] depicts the streamlines that are plotted in two perpendicular planes based on an instantaneous velocity field at a dimensionless time @xmath163 .",
    "the plots are presented in three views of side , top and stream - wise views , respectively .",
    "[ fig : str0.01xy ] presents side view of the streamlines of the simulation in @xmath164 .",
    "we can observe the development of steady boundary layers near the solid boundaries and symmetric streamlines before and after the sphere .",
    "this behavior can be observed from the other views as well .",
    "[ fig : str0.01yz ] shows that the streamlines that are plotted on the @xmath165 and @xmath166 planes stick to the plane .    as the reynolds number increases",
    ", we can see the onset of inertial effects caused by the acceleration and deceleration of the fluid passing through the pores . in fig .",
    "[ fig : str46xy ] , we see that small vortices start to form in front of the sphere and some larger ones behind the sphere . in this regime , the form drag is added to the viscous drag which increases the head loss .",
    "a further increase of the flow rate yields that these two types of vortices join to an even larger vortex occupying the distance between two spheres , which results in a lower flow capacity ; cf .",
    "[ fig : str79xy ] .",
    "the flow regime is still laminar and steady .",
    "+   +     +   +   +    the acceleration / deceleration effects described above are the dominant phenomenona until the flow starts to fluctuate . as we can see in fig .",
    "[ fig : flowfield183 ] , at around @xmath167 the flow is still laminar , but the symmetry breaks and the flow becomes unsteady .",
    "we can see the flow separation behind the sphere and the boundary layer interaction that causes energy dissipation in the unsteady laminar flow regime .",
    "this is in line with the observations of previous studies , where the onset of fluctuations is reported between @xmath168 and @xmath169 for different porous media @xcite .",
    "however , the starting reynolds number of the fluctuation strongly depends on the porosity , the arrangement of the packing and the size of the spheres .    by further increasing the reynolds number of the flow",
    ", we observe the onset of turbulent chaotic behavior ; cf .",
    "[ fig : flowfield509 ] and  [ fig : flowfield762 ] .",
    "the flow is in the transition regime from the laminar unsteady flow to turbulent flow .",
    "we can also observe smaller vortices that can pass through the pores and thereby increase the non - linear effects .",
    "increasing the reynolds number of the flow even further , we can see turbulent flow behavior .",
    "[ fig : flowfield3880 ] and  [ fig : flowfield5812 ] are showing a strongly chaotic flow field and random behavior .",
    "based on the above mentioned results of the pore scale simulation , we compute the forchheimer constant @xmath25 , using equation and also the normalized apparent permeability by the darcy permeability as defined by barree  conway model , i.e. ,    @xmath170    where @xmath16 is determined using the one - dimensional equivalent of darcy s law by means of a spatially and temporally averaged velocity . the temporal averaging starts after the drag force acting on the sphere is converged",
    ". once converged , we average the volume averaged velocity for a period of 100150 flow through times .    our results are presented in fig .",
    "[ fig : beta+barree - conway ] for the whole range of reynolds numbers considered in this study . in the left figure",
    ", we compare our results to a best fit with respect to the barree  conway model , obtained for reynolds numbers up to @xmath171 .",
    "we see that the results can be fitted well to the model equations which agrees with the experimental validations reported in @xcite .",
    "however , for higher reynolds numbers , we observe a significant deviation from the plateau region that is predicted by the model .",
    "it indicates that , while the model of barree ",
    "conway can be adjusted well to flow simulations in the range up to @xmath171 , it lacks enough degrees of freedom to model flow beyond that range . including the additional data for high reynolds numbers increases the fitting error in the low reynolds regime , where the model has been validated by previous studies of various authors .",
    "based on our observations , we moreover conclude that @xmath172 in the model does not have the physical meaning of a minimal permeability that is attained in the high reynolds limit .",
    "it should rather be referred to as a free model parameter that can be chosen to fit the curves for a porous medium at hand in the regime @xmath173 .    the right plot of fig .",
    "[ fig : beta+barree - conway ] depicts that the value of @xmath25 strongly depends on the reynolds number , which is in line with the experimental results of @xcite who stated that the @xmath12 factors have to be chosen differently for different flow regimes .",
    "however , it can be seen that two approximately constant values can be considered for laminar and turbulent flow . in our setup",
    "these are @xmath174 for @xmath175 and @xmath176 for @xmath177 , respectively .",
    "the former is the non - linear laminar , the latter is for the turbulent regime .",
    "a non - dimensional form of equation can be provided in form of a friction factor , i.e. , @xmath178 where @xmath179 , and @xmath180 .",
    "[ fig : friction ] presents the results of the friction factor for different reynolds numbers .",
    "as it can be seen , for @xmath181 the results are inversely proportional to @xmath182 which is the typical behavior of the friction factor .",
    "the deviation starts at @xmath183 ( @xmath184 ) which is the inertial regime of the flow .",
    "the transition regime from unsteady flow to chaotic flow is @xmath185 ( @xmath186 ) . by further increasing the reynolds number",
    ", we can see the turbulent flow regime in which the friction factor converges to nearly a constant value which depends on the porous geometry , and in our simulation is @xmath187 .",
    "by using the results of the evaluation which is presented in the previous sections , we provide a pore - scale simulation for semi - realistic porous structure consisting several spherical particles . to construct a semi - real porous structure , our in - house physics engine framework @xcite",
    "is used to simulate the rigid body interaction between spherical bodies . in this simulation , several spherical particles with different size",
    "are configured such that they fall down due to the gravity and onto the bed .",
    "after the particles come to rest , the geometry is imported as a permeable bed in the walberla  framework for fluid flow simulation .    to resolve all scales ,",
    "the porous media part of the domain is refined using three different levels of refinement .",
    "periodic boundary conditions have been used in the stream - wise and span - wise direction while the top boundary is free surface .",
    "we apply the trt model of collision and the cli scheme for wall boundary condition .",
    "the simulation is executed on the lima supercomputer , with 64 nodes and 24 cores on each node . with this configuration",
    "it roughly takes 24 hours of computation for the whole simulation for a spatial resolution of @xmath188 cells .",
    "[ fig : turbulent_porous ] shows the contours of the flow velocity of the simulation after @xmath189 timesteps . the block structure used in walberla",
    "is shown on the left hand side of the figure to indicate the static refinement of the meshes .",
    "the grids are also displayed on the right hand side of the contour to show the grid resolution .",
    "we point out that the results are stored after coarsening the grids throughout the domain by a factor of 8 to keep the size of the resulting outputs reasonable for post - processing and visualization .",
    "in this article , the lattice boltzmann method is used to realize methods to simulate the flow through periodic and random sphere packs for a large range of reynolds numbers .",
    "the article studies different collision operators and different types of boundary conditions .",
    "a new periodic pressure boundary condition has been developed to drive the flow .",
    "while the srt collision operator produces a viscosity dependent permeability that affects the accuracy of porous flow simulations , the mrt model reduces the viscosity dependency of the results significantly .",
    "however , the trt collision model in combination with the mr or cli boundary model can also lead to accurate viscosity - independent results and is computationally cheaper as the mrt scheme .",
    "the grid independence for low reynolds numbers is verified by computing the drag force and permeability as compared to the analytic solution for different sizes of the spheres .",
    "the results indicate that using the cli combined with the trt leads to good accuracy in both evaluation criteria .",
    "since the trt in its optimized version results in a run - time similar the srt collision model , and since using the mrt for low reynolds number flow does not improve the accuracy significantly , the trt collision model is used in the remainder of the article . considering the accuracy versus computational cost in a massively parallel",
    "setting indicates that the cli boundary scheme is a favorable compromise choice .",
    "the results for the permeability shows that , contrary to the barree ",
    "conway model , no plateau area for the permeability can be observed at high reynolds number . although these results show a change from concave downward to convex upward in the transition between the laminar unsteady flow and the turbulent flow , it decreases by increasing the reynolds number which is in line with the theory derived from the navier - stokes equation .",
    "considering the forchheimer model for high reynolds number flow , it is shown that two different values can be considered for laminar and turbulent regimes of the flow .",
    "also the results show good agreement with the friction factor models .",
    "different flow regimes can be found for different reynolds numbers when the square root of the permeability is considered as the characteristic length scale .",
    "the results demonstrate that the flow regimes can be defined as , creeping flow , laminar steady , laminar unsteady , chaotic flow and turbulent flow .",
    "financial support from the german research foundation ( dfg , project wo 671/11 - 1 ) and also the international graduate school of science and engineering ( igsse ) of the technische universitt mnchen for research training group 6.03 are gratefully acknowledged .",
    "our special thank goes to simon bogner and dominik bartuschat for many fruitful discussions and the walberla  primary authors florian schornbaum , christian godenschwager and martin bauer for their essential help with implementing the code .",
    "ulrich rde wishes to thank the institute of mathematical sciences at national university of singapore where part of this work was conducted .    53 natexlab#1#1[2]#2 , , ( ) .",
    ", , ( ) . , , ( ) .",
    ", , , in : , , , pp . . .",
    ", , , , ( ) . , , ph.d .",
    "thesis , colorado school of mines .",
    "department of petroleum engineering , .",
    ", , , , in : , pp . . , ,",
    "( ) . , , ( ) . , , , ( )",
    ", , , , ( ) . , , , , ( ) .",
    ", , , , , , , , , in : , , , , pp . . , , , , , , , ( ) . , , , , , , ( ) . .",
    ", , , , , , in : , sc 13 , , , , pp . .",
    ", , , , ( ) .",
    ", , , , , in : , sc 10 , , , , pp . .",
    ", , , , in : , pp . .",
    ", , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , , ( ) . , , ( ) .",
    ", , , , ( ) . , , , , ( ) .",
    ", , , , ( ) .",
    ", , , , , ( ) . , , , ( ) .",
    ", , , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , ph.d . thesis , university of geneva , .",
    ", , , , ( ) . , , , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) ."
  ],
  "abstract_text": [
    "<S> the lattice boltzmann method can be used to simulate flow through porous media with full geometrical resolution . </S>",
    "<S> with such a direct numerical simulation , it becomes possible to study fundamental effects which are difficult to assess either by developing macroscopic mathematical models or experiments . </S>",
    "<S> we first evaluate the lattice boltzmann method with various boundary handling of the solid - wall and various collision operators to assess their suitability for large scale direct numerical simulation of porous media flow . </S>",
    "<S> a periodic pressure drop boundary condition is used to mimic the pressure driven flow through the simple sphere pack in a periodic domain . </S>",
    "<S> the evaluation of the method is done in the darcy regime and the results are compared to a semi - analytic solution . </S>",
    "<S> taking into account computational cost and accuracy , we choose the most efficient combination of the solid boundary condition and collision operator . </S>",
    "<S> we apply this method to perform simulations for a wide range of reynolds numbers from stokes flow over seven orders of magnitude to turbulent flow . </S>",
    "<S> contours and streamlines of the flow field are presented to show the flow behavior in different flow regimes . moreover , </S>",
    "<S> unknown parameters of the forchheimer , the barree  conway and friction factor models are evaluated numerically for the considered flow regimes .    </S>",
    "<S> lattice boltzmann method , porous media , forchheimer force , pore scale simulation , turbulence , darcy , periodic pressure boundary </S>"
  ]
}