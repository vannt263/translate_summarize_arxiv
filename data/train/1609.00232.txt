{
  "article_text": [
    "in contemporary financial mathematics , _ stochastic local volatility _ ( slv ) _ models _ are for describing asset price processes , notably foreign exchange ( fx ) rates , see e.g.  @xcite .",
    "they constitute a natural combination of _ local volatility _ ( lv ) and _ stochastic volatility _ ( sv ) models .",
    "denote by @xmath0 the fx rate at time @xmath1 and consider the standard transformed variable @xmath2 .",
    "we deal in this paper with general slv models of the type @xmath3 with @xmath4 a non - negative function , @xmath5 a non - negative parameter , @xmath6 strictly positive parameters , @xmath7 , @xmath8 , and given spot values @xmath9 , @xmath10 .",
    "the function @xmath11 is often called _ the leverage function _ and @xmath12 , respectively @xmath13 , denotes the risk - free interest rate in the domestic currency , respectively foreign currency .",
    "the slv model can be viewed as obtained from a mixture of the lv model @xmath14 with lv function @xmath15 , and the sv model @xmath16 clearly , if @xmath11 is identically equal to one , then the slv model reduces to a sv model .",
    "next , if the stochastic volatility parameter @xmath17 is equal to zero , then the slv model reduces to  a  lv  model .    the choice @xmath18 , @xmath19 corresponds to the well - known heston - based s(l)v model , the choice @xmath20 , @xmath21 to the s(l)v model considered in @xcite and the choice @xmath22 , @xmath23 corresponds to the s(l)v model based on the exponential ornstein  uhlenbeck model described in @xcite .    if @xmath5 is strictly positive , we assume that @xmath24 and the processes @xmath25 are non - negative . for @xmath26",
    "it holds that @xmath27 is attainable , for @xmath28 it holds that @xmath27 is unattainable , and for @xmath19 one has that @xmath27 is attainable if @xmath29 , see e.g.  @xcite .",
    "the analogous result is true for the pure sv model .    in financial practice ,",
    "@xmath15 is determined such that the lv model yields the exact market prices for vanilla options , see e.g.  @xcite , and the parameters @xmath30 are chosen such that the sv model reflects the market dynamics of the underlying asset , see e.g.  @xcite . for the calibration of the slv model",
    "it is customary to start from the parameters of the sv model under consideration , and to define @xmath31 with mixing parameter .",
    "the mixing parameter tunes between the local volatility and stochastic volatility features .",
    "next , the leverage function @xmath32 is calibrated such that the slv model yields the exact market prices for european call and put options . in the literature",
    ", no closed - form analytical relationship appears to be available between the leverage function and the fair value of vanilla options within the slv model .",
    "accordingly , in financial practice the leverage function is calibrated by making use of a relationship between the slv model and the lv model .",
    "it is well - known , see e.g.  @xcite , that these models yield the same marginal distribution for the exchange rate @xmath33 , and hence always define the same fair value for vanilla options , if the leverage function @xmath34 satisfies @xmath35 = \\sigma_{slv}^{2 } ( x,\\tau)\\mathbb{e}[\\psi^{2}(v_{\\tau } ) \\vert x_{\\tau } = x ] , \\label{eq : sigmatomatch}\\ ] ] for all @xmath36 .",
    "the latter conditional expectation can be written as @xmath37 = \\frac{\\int_{-\\infty}^{\\infty } \\psi^{2}(v ) p(x , v,\\tau;x_{0},v_{0})dv}{\\int_{-\\infty}^{\\infty}p(x , v,\\tau;x_{0},v_{0})dv } ,   \\label{eq : condexpec}\\ ] ] where @xmath38 denotes the joint density of @xmath39 given by the slv model . since the lv function is determined such that the lv model yields exactly the observed market prices for vanilla options , the slv model will also exactly define the same fair value whenever one is able to determine the conditional expectation above and defines the leverage function by .",
    "this conditional expectation itself depends on @xmath34 , however , and determining it is a highly non - trivial task .",
    "recently , a variety of numerical techniques , see e.g.  @xcite , has been proposed in order to approximate this conditional expectation and to approximate the appropriate leverage function .",
    "the numerical techniques presented in the references above do not take into account explicitly that , even if the lv function is known analytically , it is often not possible to determine exactly the corresponding fair value of vanilla options . even within",
    "the lv model one relies on numerical methods in order to approximate the fair option values .",
    "a common approach consists of numerically solving the corresponding backward partial differential equation ( pde ) by for example finite difference or finite volume methods , see e.g.  @xcite . when calibrating the slv model to the lv model , the best result one can thus aim for is that the numerical approximation of the fair value of vanilla options is the same for both models whenever similar numerical valuation methods are used .    in this paper",
    "we assume that the fair option value ( within the lv model , resp . slv model ) is approximated through numerically solving the backward pde ( corresponding to the lv model , resp .",
    "slv model ) by standard finite difference or finite volume methods . given such a spatial discretization for the backward pde , an _",
    "adjoint spatial discretization _ will be introduced for the corresponding forward pde",
    ". this adjoint spatial discretization has the important property that it always defines _ exactly the same approximation _ for the fair value of non - path - dependent european options as the approximation given by the discretization of the backward equation .",
    "moreover , if similar spatial discretizations are used for the backward pde associated with the lv model and the backward pde associated with the slv model , then their adjoint spatial discretizations can be employed to  _ create an exact match between the approximations for the fair value of vanilla options within the lv model and the slv model .",
    "_    the main contributions of this article can be visualized in the following scheme :    ( 0,0 ) node[align = center , draw , rounded corners](blv ) discretization + backward pde , lv ; ( 2.5,0 ) node[align = center](=b ) @xmath40 ; ( 5,0 ) node[align = center , draw , rounded corners](flv ) adjoint discretization + forward pde , lv ; ( 5,-1 ) node[align = center](=r ) @xmath41 @xmath42 ; ( 5,-2 ) node[align = center , draw , rounded corners](fslv ) adjoint discretization + forward pde , slv ; ( 2.5,-2 ) node[align",
    "= center](=u ) @xmath40 ; ( 0,-2 ) node[align = center , draw , rounded corners](bslv ) discretization + backward pde , slv ;    0.5 cm here relationship @xmath42 can only be achieved if similar discretizations are used for the backward pdes stemming from the lv and slv models .",
    "an outline of the rest of our paper is as follows .    in section [ forwardbackward ] a relationship between the forward pde and backward pde",
    "is introduced , both for the case of the slv model as for the case of the lv model .    in section [ forwardbackwarddiscrete ]",
    "this relationship is preserved at the semidiscrete level : given a spatial discretization of the backward pde , an adjoint spatial discretization for the forward pde is defined such that both discretizations yield identical approximations for the fair value of non - path - dependent european options .    in section [ backwardforward ] an actual spatial discretization , using second - order central finite difference schemes , is constructed for the backward pde stemming from the slv model and subsequently the corresponding adjoint spatial discretization is stated .",
    "the main result of the paper is derived in section [ localvolmatching ] .",
    "it is shown that , under some assumptions , the adjoint spatial discretization can be employed to obtain an expression for the leverage function such that the approximation of the fair value of vanilla options is the same for the lv and slv models . in order to effectively use this expression",
    ", one has to solve a large system of non - linear ordinary differential equations ( odes ) .    in section [ timediscretization ] an alternating direction implicit ( adi ) temporal discretization scheme is applied to increase the computational efficiency in the numerical solution of this ode system and in section [ calibration ]",
    "an iteration procedure is described for handling the non - linearity .    in section [ numerical experiments ] ample numerical experiments",
    "are presented to illustrate the performance of the obtained slv calibration procedure .",
    "the final section [ conclusion ] gives concluding remarks .",
    "consider a european - style option with maturity @xmath43 and payoff @xmath44 .",
    "denote by @xmath45 the _ non - discounted fair value _ of the option under the slv model at time to maturity @xmath46 , that is at time level @xmath47 , if @xmath48 and @xmath49 .",
    "it is well - known , see e.g.  @xcite , that the function @xmath50 satisfies the _ backward kolmogorov equation _",
    "@xmath51 for @xmath52 , @xmath53 . at maturity ,",
    "i.e.  at time level @xmath54 , the initial condition @xmath55 is defined by the payoff @xmath44 of the option . by solving pde ,",
    "the fair value @xmath56 of the option under the slv model can be determined at the spot , i.e.  at @xmath57 . for strictly positive values of the parameter @xmath5 ,",
    "the process @xmath58 is non - negative and the spatial domain in the @xmath59-direction reduces to @xmath60 .",
    "if the option under consideration is non - path - dependent , then the payoff @xmath44 is only a function of @xmath61 , the initial condition is given by @xmath62 and the non - discounted fair value @xmath45 of the option can be written as @xmath63,\\ ] ] for @xmath64 . by making use of the tower property for conditional expectations it readily follows that @xmath65 = \\int_{-\\infty}^{\\infty } \\int_{-\\infty}^{\\infty } u(x , v , t ) p(x , v , t - t;x_{0},v_{0 } ) dx dv , \\label{eq : fairvalue}\\ ] ] for @xmath64 .",
    "recall that @xmath38 denotes the joint density of @xmath39 under the slv model .",
    "if the parameter @xmath5 is chosen strictly positive , then the integral with respect to @xmath59 can be taken from @xmath66 .",
    "in particular , the fair value of non - path - dependent european options at the spot can also be computed by evaluating the integral @xmath67 where @xmath55 is defined by the payoff of the option .",
    "it can be shown , see e.g.  @xcite , that the joint density @xmath38 satisfies the _ forward kolmogorov equation _",
    "@xmath68 for @xmath69 and with initial condition @xmath70 where @xmath71 denotes the dirac delta function . for ease of presentation ,",
    "the dependency of @xmath32 on @xmath72 and the dependency of @xmath73 on @xmath74 is omitted in .",
    "recall that the process @xmath58 is non - negative whenever @xmath5 is strictly positive . in this case",
    "the spatial domain of the pde in the @xmath59-direction is naturally restricted to @xmath60 .",
    "the integrals in , , with respect to the @xmath59-variable can then be taken from @xmath75 to infinity .",
    "equation establishes a _",
    "fundamental relationship between the forward and backward kolmogorov equation_. it states that the fair value of non - path - dependent european options under the slv model can be seen as the combination of the solution of two different pdes . by considering the extreme time value @xmath76 ( @xmath77 ) , or @xmath54 ( @xmath78 ) , only one pde has to be solved . in the forthcoming sections relationship",
    "will be employed to define an adjoint spatial discretization for the forward equation .",
    "even if the functions @xmath50 and @xmath73 are known exactly , the integrals in can often not be calculated analytically and one relies on numerical integration methods in order to approximate them . in this article",
    "we assume that the integrand is known on a cartesian grid .",
    "denote by @xmath79 , respectively @xmath80 , the number of spatial grid points in the @xmath81-direction , respectively @xmath59-direction .",
    "the cartesian grid is given by @xmath82 with @xmath83 , @xmath84 and @xmath85 , @xmath86 .",
    "define spatial mesh widths @xmath87 for @xmath88 , @xmath89 for @xmath90 and put @xmath91 .",
    "when working with cartesian grids , most numerical integration methods approximate the expression by @xmath92 for certain weights @xmath93 .",
    "if the numerical integration is performed with the trapezoidal rule , then the weights are given by @xmath94 the values @xmath95 , @xmath96 have to lie sufficiently far away from @xmath97 such that the truncation error is negligible .",
    "if @xmath5 is strictly positive , the value @xmath98 can be set equal to zero . in order for to be exact",
    "if @xmath77 @xmath99 , it is assumed that there exist indices @xmath100 such that @xmath101 and the approximation @xmath102 is used with @xmath103 \\times [ v_{j_{0 } } - \\tfrac{\\delta v_{j_{0}}}{2 } , v_{j_{0 } } + \\tfrac{\\delta v_{j_{0}+1}}{2 } ] , \\\\\\\\ 0 & \\quad \\mathrm{else . } \\end{array } \\right.\\ ] ]    analogously as above , consider within the lv model a european - style option with payoff @xmath104 at maturity @xmath43 and denote by @xmath105 the non - discounted fair value of the option under the lv model at time @xmath106 if @xmath107 .",
    "the function @xmath108 satisfies the backward kolmogorov equation @xmath109 for @xmath110 , @xmath111 and with initial condition @xmath112 defined by the payoff @xmath104 of the option .",
    "the non - discounted fair value of the option at the spot @xmath99 is then given by @xmath113 .",
    "for non - path - dependent options this fair value can also be formulated as @xmath114 for @xmath64 , where @xmath115 denotes the density of the process @xmath116 in the lv model .",
    "it can be shown , see e.g.  @xcite , that this density function satisfies the forward kolmogorov equation @xmath117 for @xmath118 , and with initial condition @xmath119 .",
    "hence , the expression establishes a fundamental relationship between the forward and backward kolmogorov equation which is similar to . by applying the same numerical integration technique as above",
    ", the fair value from can be approximated by @xmath120    recall that the slv model is calibrated perfectly to the lv model if the leverage function is defined by .",
    "it was shown by gyngy @xcite that under this assumption both processes @xmath121 and @xmath116 have the same marginal densities , i.e.  that @xmath122 for @xmath123 from now on , for the ease of presentation , the dependency of @xmath73 and @xmath124 on the spot values @xmath125 is omitted .",
    "in general the values @xmath126 and @xmath127 are not known exactly if @xmath128 and @xmath129 , respectively , and one relies on numerical methods to approximate them .",
    "extensive literature is available on numerical techniques to solve backward kolmogorov equations , see e.g.  @xcite . a common approach in financial mathematics in order to approximate",
    "the fair value of options is by numerically solving the pertinent pde using the general _ method of lines _ ( mol ) , cf .  @xcite . in this approach ,",
    "the pde is first discretized in the spatial variables @xmath81 and @xmath59 , yielding a large system of stiff ordinary differential equations ( odes ) .",
    "this , so - called , _ semidiscrete system _ is subsequently solved by applying a suitable implicit time stepping method .",
    "spatial discretization by finite difference or finite volume methods of the backward kolmogorov equation on a cartesian grid yields approximations @xmath130 of the exact non - discounted option value @xmath127 .",
    "denote by @xmath131 the @xmath132 matrix with entries @xmath130 and denote by @xmath133 a matrix with entries @xmath134 that represent approximations to the exact density values @xmath126 . in this section , for a general spatial discretization of the backward kolmogorov equation ,",
    "an adjoint spatial discretization of the corresponding forward equation is defined such that @xmath135 is constant for @xmath64 .",
    "this can be viewed as a discrete version of relationship .",
    "let the vector @xmath136,\\ ] ] where @xmath137 $ ] denotes the operator that turns any given matrix into a vector by putting its successive columns below each other .",
    "spatial discretization of leads to a large system of odes of the form @xmath138 for @xmath53 , with given matrix @xmath139 and with given vector @xmath140 that is defined by the payoff of the option .",
    "let the vector @xmath141,\\ ] ] where the matrix @xmath142 is defined by the function @xmath143 from section [ forwardbackward ] .",
    "note that it has only one non - zero entry .",
    "denote by @xmath144 the diagonal matrix with diagonal entries @xmath145 where @xmath146 are the indices such that element @xmath147 , respectively @xmath148 , corresponds to @xmath130 , respectively @xmath134 .",
    "the semidiscrete analogue of can then be compactly written as @xmath149 where @xmath150 denotes taking the transpose .",
    "if @xmath151 is the index that corresponds to @xmath152 , then for @xmath77 the right - hand side of is equal to @xmath153 .",
    "now , consider the fair value of any given non - path - dependent european option with maturity @xmath43 .",
    "it is readily seen that semidiscretization of the forward equation and semidiscretization of the backward equation define _ the same approximation _ of the fair value for all @xmath154 , i.e.  property holds in the semidiscrete sense , if @xmath155 for all @xmath156 .",
    "this requirement is satisfied whenever @xmath157 holds for all @xmath158 .",
    "accordingly , we define the _ adjoint spatial discretization _ of the forward kolmogorov equation as @xmath159 in this paper we always employ the adjoint spatial discretization of the forward equation . thus , given any semidisretization of the backward equation , the obtained approximated option value for non - path - dependent european options satisfy .",
    "it is convenient to introduce @xmath160 denote by @xmath161 the matrix corresponding to the vector @xmath162 .",
    "the elements @xmath163 can be viewed as approximations of @xmath164 and hence , as an approximation of the probability that @xmath165 \\times [ v_{j } - \\tfrac{\\delta v_{j}}{2 } , v_{j } + \\tfrac{\\delta v_{j+1}}{2}].\\ ] ] clearly , @xmath166 for @xmath158 , with given vector @xmath167 , i.e.  with @xmath168 the approximation of the non - discounted fair value of a non - path - dependent european option at the spot can then also be represented as @xmath169",
    "in this section , a spatial discretization of the backward equation by finite differences will be performed on a non - uniform cartesian grid .",
    "this semidiscretization then defines the adjoint spatial discretization of the forward equation .      to construct a spatial grid and a semidiscretization for",
    ", the spatial domain needs to be truncated to a bounded set @xmath170 \\times [ v_{\\min } , v_{\\max}]$ ] .",
    "the boundaries have to lie sufficiently far away from @xmath97 such that the truncation error incurred is negligible . if the parameter @xmath5 is strictly positive , the process @xmath58 is non - negative and @xmath98 is naturally set equal to zero . for non - path - dependent european options",
    "the following boundary conditions are imposed : @xmath171 the above conditions at @xmath172 and @xmath173 correspond to linear boundary conditions in the @xmath174-variable , where @xmath175 , cf .",
    "section [ intro ] .",
    "if @xmath23 , the process @xmath58 can take negative values and it is additionally assumed that @xmath176 thus at @xmath177 a linear boundary condition is taken .",
    "the condition at @xmath178 corresponds with a linear boundary condition in the variable @xmath179 . for values of @xmath5 that are strictly positive",
    ", the process @xmath58 is non - negative .",
    "moreover , @xmath27 can be attained if @xmath180 . in these cases",
    "the boundary @xmath66 of the pde requires special attention .",
    "it has recently been proved in @xcite that setting @xmath66 in the pde at this boundary then yields the correct condition here . at the boundary @xmath178",
    "it is then additionally assumed that @xmath181    for this truncated domain , non - uniform meshes are applied in both the @xmath81- and @xmath59-direction such that relatively many mesh points lie in the neighbourhood of @xmath182 and @xmath183 .",
    "the application of such non - uniform meshes improves the accuracy of the finite difference discretization compared to using uniform meshes .",
    "the type of non - uniform meshes that is employed is similar to the ones considered in e.g.  @xcite , which make use of a transformation with the @xmath184 function of an underlying uniform mesh .",
    "akin to @xcite we opt to have here a fine , locally uniform mesh around the point @xmath185 .",
    "further , the choice @xmath186 is considered .",
    "denote by @xmath187 the mesh width of the underlying uniform mesh in the @xmath81-direction .",
    "then the mesh under consideration in the @xmath81-direction is _ smooth _ in the sense that there exist real constants @xmath188 such that the mesh widths @xmath189 satisfy @xmath190 uniformly in @xmath191 and @xmath79 .",
    "analogously , the mesh in the @xmath59-direction is smooth . as an illustration ,",
    "the left plot in figure [ fig : spatialgrid ] displays the spatial grid for the ( small ) sample values @xmath192 , in the case @xmath193 , @xmath194 , @xmath195 and @xmath196 .",
    "the right plot in figure [ fig : spatialgrid ] displays a part of the spatial grid to show the local uniformity of the grid around @xmath97 .    ,",
    "the case @xmath197 , @xmath194 , @xmath195 and @xmath198 .",
    "the left plot displays the complete grid , the right plot shows the uniformity around @xmath97.,title=\"fig : \" ] , the case @xmath197 , @xmath194 , @xmath195 and @xmath198 .",
    "the left plot displays the complete grid , the right plot shows the uniformity around @xmath97.,title=\"fig : \" ]    semidiscretization on the spatial grid is performed by finite differences",
    ". let @xmath199 be any given function . to approximate the first derivative @xmath200 we consider two finite difference schemes :    f(x_i ) & & _ i,-1",
    "f(x_i-1 ) + _",
    "i,0 f(x_i ) + _",
    "i,1 f(x_i+1 ) , + f(x_i ) & & _ i,0",
    "f(x_i ) + _",
    "i,1 f(x_i+1 ) + _",
    "i,2 f(x_i+2 ) ,    with coefficients given by @xmath201 to approximate the second derivative @xmath202 , we apply the finite difference scheme @xmath203 where @xmath204 the finite difference schemes in the @xmath59-direction are defined completely analogously . for a function of two variables @xmath205 , the mixed derivative is approximated by application of  successively in the two directions .",
    "the finite difference schemes above are all well - known .",
    "formula , respectively , is called the second - order central , respectively second - order forward , formula for the first derivative .",
    "finite difference scheme is called the second - order central formula for the second derivative . through taylor expansion",
    "it can be verified that each of the finite difference approximations above has a second - order truncation error , provided that the function @xmath206 is sufficiently often continuously differentiable and the mesh is smooth , cf .  above .",
    "the actual semidiscretization of the backward pde is defined as follows . at all spatial grid points that do not lie on the boundary of the truncated domain , each spatial derivative appearing in",
    "is replaced by its corresponding second - order central finite difference scheme described above .",
    "concerning the boundaries in the @xmath81-direction , it is assumed that the pertinent conditions from are valid for every @xmath81 smaller than @xmath207 or larger than @xmath208 .",
    "thus for these extreme values @xmath81 we assume that @xmath209 is an exponential function . for instance , considering the upper boundary @xmath210 and hence @xmath211 for some constants @xmath212 , @xmath213 . based on the function",
    "values @xmath50 at @xmath208 and @xmath214 the constants @xmath212 , @xmath213 can be determined and this leads to the approximation for both the first and second derivatives in the @xmath81-direction at @xmath214 given by @xmath215 the first and second derivatives in the @xmath81-direction at the lower boundary are approximated analogously .",
    "if the parameter @xmath5 is strictly positive , a linear boundary condition is applied at @xmath178 , i.e.  the second derivative in the @xmath59-direction is equal to zero .",
    "the first derivative in the @xmath59-direction at this boundary is approximated by using the central scheme with the virtual point @xmath216 , where the value at this point is defined by extrapolation using the linear boundary condition .",
    "this discretization reduces to the first - order backward finite difference formula for the first derivative .",
    "moreover , at the boundary @xmath217 all the second derivatives vanish and the first derivative @xmath218 is then approximated by using the forward scheme . if @xmath5 equals zero ,",
    "a linear boundary condition is imposed at @xmath98 and discretization of the spatial derivatives in the @xmath59-direction is performed as above .",
    "the discretization of the boundary condition at @xmath219 is then performed analogously as the discretization of the boundary conditions in the @xmath81-direction .",
    "denote by @xmath220 , respectively @xmath221 , the matrices corresponding with the first , respectively second , derivatives in the @xmath81-direction .",
    "analogously , denote by @xmath222 the matrices corresponding with spatial derivatives in the @xmath59-direction .",
    "for example , given that @xmath197 , @xmath223 is the matrix with entries @xmath224 where @xmath225 .",
    "denote by @xmath226 the @xmath227 diagonal matrix with entries @xmath228 , let @xmath229 be the @xmath230 diagonal matrix with entries @xmath231 , and define for an arbitrary function @xmath232 the matrix @xmath233 as the diagonal matrix with entries @xmath234 .",
    "further , denote by @xmath235 , respectively @xmath236 , the identity matrix of size @xmath227 , respectively @xmath230 .",
    "then semidiscretization of yields a system of differential equations given by @xmath237 for @xmath53 .",
    "this can be written in the form , @xmath238 for @xmath53 where , using a well - known property of the _ kronecker product _ @xmath239 , @xmath240 the initial vector @xmath140 is defined by the payoff of the option .      as indicated in section [ forwardbackwarddiscrete ] , semidiscretization of the forward equation",
    "is performed by the adjoint spatial discretization . since the transpose of the kronecker product of two matrices is equal to the kronecker product of the transposed matrices , and recalling that @xmath241 , it follows",
    "that @xmath162 defined by is given by the system of odes @xmath242 for @xmath243 , with @xmath244 and given initial vector @xmath245 .",
    "this in turn corresponds to the system of differential equations @xmath246 for @xmath243 .",
    "the expression shall be employed to calibrate the slv model to the lv model .",
    "the total integral of a density function is equal to one . for",
    "a natural adjoint spatial discretization one would expect that the total numerical integral of @xmath247 , corresponding with @xmath248 , is close to one .",
    "let @xmath249 and @xmath250 denote the vectors consisting of all ones with lengths @xmath251 and @xmath252 , respectively . by construction of the finite difference discretization and",
    "the chosen boundary conditions for the slv model there holds @xmath253 and it directly follows that @xmath254 for all @xmath243 . since further @xmath255 , this yields @xmath256 for all @xmath1 .",
    "it can be concluded that the adjoint spatial discretization of the forward kolmogorov equation keeps the total numerical integral of the density identically equal to one , which is a favourable property .",
    "in this section the main result of the article is presented .",
    "it is shown that , under some assumptions , one can calibrate the semidiscrete slv model exactly to the corresponding semidiscrete lv model .",
    "a priori the leverage function @xmath32 , and hence the matrix function @xmath257 , are unknown and one wishes to determine them in such a way that the lv model and the slv model define identical values for european call and put options . in practice",
    ", however , even the lv function @xmath258 is not known analytically in general and one relies on numerical methods to approximate the option value defined by the lv model .",
    "accordingly , it is unrealistic to require an algorithm to produce a leverage function @xmath32 such that the slv model yields the same exact european call and put values as the lv model .",
    "one rather wants to construct the leverage function in such a way that the two models yield _ identical approximate values _ for european call and put options whenever similar semidiscretizations of these models are used .    a common approach to approximate the fair value of a european - style option under the lv model is by discretizing the backward pde with finite differences .",
    "since the region of interest in the @xmath81-direction in the lv model is the same as that in the slv model , the same spatial mesh can be used in this spatial direction .",
    "denote by @xmath259 the vector with approximations @xmath260 to @xmath261 for @xmath262 such that the component @xmath263 is the approximation of the non - discounted fair value at the spot .",
    "semidiscretization by finite differences then leads to a system of odes @xmath264 for @xmath53 , with initial vector @xmath265 defined by the payoff @xmath104 .",
    "since the spatial derivatives @xmath266 and @xmath267 in also occur in the backward equation , and since also the same boundary conditions from section [ backwardforward ] can be applied for non - path - dependent european options , the same finite difference matrices @xmath220 and @xmath221 can be used to perform semidiscretization , and hence @xmath268 where @xmath269 is the @xmath227 diagonal matrix with entries @xmath270 .",
    "denote by @xmath271 a vector with approximations @xmath272 of @xmath273 , where @xmath124 is given by the forward equation , and define @xmath274 where @xmath275 is the diagonal matrix with entries @xmath276 analogously to section [ forwardbackwarddiscrete ] , we define an adjoint forward discretization by @xmath277 for @xmath243 , with @xmath278 and @xmath279 so that @xmath280 for all @xmath281 . especially , for non - path - dependent european options one can just solve the forward problem and approximate the non - discounted fair value at the spot by @xmath282 .",
    "now , consider a non - path - dependent option whose payoff is only dependent on the exchange rate @xmath283 .",
    "then @xmath284 whenever @xmath285 .",
    "it is readily verified that the semidiscretizations of the lv model and the slv model define the same value at the spot , i.e.  @xmath286 , if @xmath287 this property is desirable for every possible maturity .",
    "hence , one would like to have @xmath288 for all @xmath289 .",
    "notice that is equivalent to @xmath290 which can be viewed as a semidiscrete analogue of . since @xmath291 , the condition is satisfied if @xmath292 for all @xmath293 . from",
    ", we directly obtain @xmath294 if the ( initially unspecified ) diagonal matrix @xmath226 is now defined through @xmath295 then @xmath296 hence , it follows that holds whenever equation has a unique solution .",
    "remark that in the definition for the semidiscrete leverage function it is tacitly assumed that both vectors @xmath297 only contain strictly positive values . by performing a spatial discretization with finite differences it is possible that some of the values @xmath298 become negative . in our experiments , both vectors remained strictly positive , however , for natural values of @xmath299 .",
    "notice that _ the derivation above is not restricted to the choice of finite difference formulas_. if the second - order central formulas from subsection [ subsec : backwarddiscretization ] are replaced by alternative finite difference formulas for which holds , and if these formulas are also applied for a similar semidiscretization in the lv model , then the slv model is calibrated exactly to the lv model by employing .",
    "we arrive at the following main result .",
    "assume semidiscretization of the backward kolmogorov equation is performed by consistent finite difference formulas on a cartesian grid and that semidiscretization of the forward kolmogorov equation is performed by the adjoint spatial discretization .",
    "then @xmath300 where @xmath151 corresponds to the index @xmath152 such that @xmath101 .",
    "hence , the two semidiscretizations define the same approximation for the fair value of non - path - dependent european options .",
    "next , assume semidiscretization of the backward and forward equations and under the lv model is performed in complete correspondence to that of and , respectively , under the slv model by using the same grid and finite difference formulas in the @xmath81-direction .",
    "if holds and equation has a unique solution and if the leverage function @xmath32 is defined on the grid in the @xmath81-direction by @xmath301 then @xmath302 in particular , if the payoff depends only on the exchange rate @xmath283 , then the semidiscretizations of the lv model and the slv model define the same approximation for the fair value of non - path - dependent european options : @xmath303 [ th : ltomatchtheorem ]    the second part of theorem [ th : ltomatchtheorem ] can be regarded as the semidiscrete analogue of . indeed , if @xmath32 is defined on the spatial grid in the @xmath81-direction by , then by the definition of @xmath248 it is directly seen that this is equivalent to applying , where the conditional expectation is approximated by @xmath304 \\approx \\frac{\\sum_{j=1}^{m_{2}}\\psi^{2}(v_{j } ) \\boldsymbol{p}_{i , j}(\\tau ) w_{v , j}}{\\sum_{j=1}^{m_{2 } } \\boldsymbol{p}_{i , j}(\\tau)w_{v , j } } = \\frac{\\sum_{j=1}^{m_{2}}\\psi^{2}(v_{j } ) \\overline{\\boldsymbol{p}}_{i , j}(\\tau)}{\\sum_{j=1}^{m_{2 } } \\overline{\\boldsymbol{p}}_{i , j}(\\tau ) }   \\qquad \\mathrm{for}~ 1 \\leq i \\leq m_{1}. \\label{eq : semidiscreteexpectation}\\ ] ]",
    "in this section we consider a suitable time stepping method for the numerical solution of semidiscrete systems of the type and assuming that the matrix - valued function @xmath257 is known . in general ,",
    "semidiscretization by means of finite difference or finite volume methods of initial - boundary value problems for two - dimensional time - dependent convection - diffusion equations leads to large systems of stiff odes , @xmath305 with given vector - valued function @xmath306\\times \\r^m \\rightarrow \\r^m$ ] and given vector @xmath307 where is the number of spatial grid points . for the effective time discretization of these semidiscrete systems , _",
    "operator splitting schemes _ of the _ alternating direction implicit _ ( adi ) type are widely used in practice .",
    "several adi schemes have been developed and analyzed in the literature for the situation where mixed spatial derivative terms are present in the convection - diffusion equation .",
    "mixed derivative terms are ubiquitous in the field of financial option valuation ; they arise due to correlations between the underlying stochastic processes .",
    "notably , this holds for the general slv model under consideration .    in this paper",
    "we employ the _ modified craig  sneyd ( mcs ) scheme _ , which is a modern scheme of the adi - type suitable to deal with mixed derivative terms .",
    "let the vector - valued function @xmath308 be decomposed as @xmath309 where @xmath310 represents the mixed spatial derivative term and @xmath311 , respectively @xmath312 , represents all spatial derivative terms in the first , respectively second , spatial direction .",
    "let @xmath313 be a given parameter , @xmath314 the number of time steps and @xmath315 with @xmath316 . then the mcs scheme defines approximations @xmath317 to @xmath318 successively for @xmath319 through @xmath320",
    "the mcs scheme has been introduced by in t hout & welfert @xcite .",
    "it starts with an explicit euler predictor stage , which is followed by two implicit but unidirectional corrector stages .",
    "then a second explicit stage is performed , followed again by two implicit unidirectional corrector stages . in the special case where @xmath321 one obtains the _ craig  sneyd ( cs ) scheme _ , proposed in @xcite .",
    "observe the favourable feature that the @xmath322 part , representing the mixed derivative term , is always treated in an explicit manner .    in the past years",
    "various positive _ stability _ results have been derived for the mcs scheme relevant to multidimensional convection - diffusion equations with mixed derivative terms , see e.g.  @xcite .",
    "subsequently , in t hout & wyns  @xcite proved that , under natural stability and smoothness assumptions , the mcs scheme is _ second - order convergent _ with respect to the time step whenever it is applied to semidiscrete two - dimensional convection - diffusion equations with mixed derivative term .",
    "the temporal convergence bound from @xcite has the key property that it holds uniformly in the spatial mesh width .    in the present application , both vectors @xmath140 and",
    "@xmath245 are stemming from initial functions that are nonsmooth .",
    "it is well - known in the literature that the convergence behaviour of time discretization methods can be seriously impaired for nonsmooth initial data , compare  @xcite . to alleviate this ,",
    "rannacher time stepping will be applied , that is , the first few time steps of the mcs scheme are replaced by twice as many half time steps using the implicit euler scheme @xcite .",
    "we opt to replace here the first two mcs time steps by four half time steps of the implicit euler scheme . based on the recent results in @xcite , the mcs scheme",
    "is then expected to maintain second - order convergence in time , uniformly in the number of spatial grid points .    as seen in section  [ forwardbackward ] , the fair values of non -",
    "path - dependent european options can be determined by solving either the backward equation or the forward equation . in section  [ backwardforward ]",
    "spatial discretization of these two pdes led to the semidiscrete systems and , respectively .",
    "application of the mcs scheme to yields approximations @xmath323 of @xmath324 and the non - discounted fair option value at the spot is then approximated by @xmath325 .",
    "alternatively , take @xmath326 and let temporal grid points @xmath327 .",
    "application of the mcs scheme to yields approximations @xmath328 of @xmath329 and the non - discounted fair option value at the spot is then approximated by @xmath330 .",
    "it is possible , see itkin  @xcite , to construct a new adi discretization for such that there is an exact match between the fully discretized backward equation and the fully discretized forward equation , that is , @xmath331 for all @xmath332 . in this paper",
    "we prefer to employ the mcs scheme for the numerical solution of both ode systems and .",
    "a main reason is that ample positive results are already available in the literature on the stability and convergence of the mcs scheme .",
    "the alternative scheme from @xcite ends with an explicit stage and numerical experiments indicate that computing with the corresponding @xmath333 can lead to undesirable ( erratic ) behaviour of the numerical conditional expectation .",
    "in addition , practical experience shows that the temporal discretization error of the mcs scheme is often much smaller than the spatial discretization error .",
    "in section [ localvolmatching ] we derived the expression for the discrete leverage function @xmath32 that exactly calibrates the semidiscrete slv model to the semidiscrete lv model .",
    "this expression involves the matrix function @xmath248 . combining with the semidiscrete forward equation for @xmath334 $ ]",
    ", one arrives at a large , non - linear system of odes . in the present section numerical time - stepping",
    "is applied together with an inner iteration so as to numerically solve this system of odes and acquire the discrete leverage function that satisfies .",
    "suppose an approximation @xmath328 to @xmath329 at time level @xmath335 is known .",
    "let @xmath336 denote the @xmath132 matrix such that @xmath337.\\ ] ] then the discrete leverage function is determined by @xmath338 where the quantity @xmath339 forms an approximation to the conditional expectation @xmath340 $ ] , see .",
    "in order to arrive at the actual calibration procedure , we need to consider three practical issues concerning formula .",
    "@xmath341   due to the spatial and temporal discretizations , it may happen that either the numerator or denominator of becomes negative . in this case",
    "we assume that the conditional expectation is locally constant in time and set @xmath342 . in our experiments , however , both parts of the quotient remained strictly positive for common values of @xmath343 .",
    "@xmath341   since @xmath344 is an approximation of the probability of the event that @xmath345 \\times [ v_{j } - \\tfrac{\\delta v_{j}}{2 } , v_{j } + \\tfrac{\\delta v_{j+1}}{2}],\\ ] ] it can happen that the numerator and denominator of become very small , which can lead to unrealistic values of the leverage function . to resolve this ,",
    "a regularized approximation of the conditional expectation is used ( cf .",
    "@xcite ) , @xmath346 for given small value @xmath347 . in this paper @xmath348 is taken . by using the regularized version ,",
    "the approximated conditional expectation is shifted towards @xmath349 where @xmath350 is the mean - reversion level of the process @xmath58 .",
    "@xmath341   at the spot @xmath351 , the matrix @xmath352 has @xmath152-th entry equal to one and all its other entries are equal to zero .",
    "consequently , if @xmath353 , then the expression is only defined if @xmath354 . to render the calibration procedure feasible , we extend this definition to all indices @xmath191 and thus put @xmath355 notice that this agrees with for @xmath353 whenever @xmath356 , which often holds in practice .",
    "+ let @xmath357 be a given integer . for calibrating the slv model to the lv model , we employ the following numerical procedure .",
    "it consists of numerical time stepping combined with an inner iteration , cf .",
    "whenever a time step from @xmath358 to @xmath335 with the mcs scheme is replaced by two half - time steps of the implicit euler scheme , the inner iteration above is first performed for the substep from @xmath358 to @xmath359 , yielding an approximation of @xmath360 and @xmath361 .",
    "next , the inner iteration is performed for the substep from @xmath362 to @xmath335 , yielding an approximation of @xmath329 and @xmath363 .    upon completion of the time stepping and iteration procedure above",
    ", the original approximation for @xmath364 is replaced on the grid in the @xmath81-direction by @xmath365 for @xmath262 .",
    "this appears more realistic as the original approximation was actually only valid for the index @xmath354 .",
    "in this section , numerical experiments are presented to illustrate the effectiveness of the calibration procedure . here , we opt to consider the popular and challenging heston - based slv model , i.e.  slv model with @xmath366 and @xmath19 , to describe the evolution of the eur / usd exchange rate .",
    "as stated in the introduction , for the calibration of the slv model it is customary to start from the parameters @xmath367 of the underlying ( heston ) sv model such that this model reflects the market dynamics of the exchange rate .",
    "next a mixing parameter @xmath368 is used to define @xmath31 and thus to tune between the underlying lv and sv models . in this article",
    "we consider the following four sets of parameters :    [ cols=\"^,>,>,>,>,>,>,>\",options=\"header \" , ]     one observes that the size of the @xmath369 is similar in tables  [ table : impliedvolm100n200 ] and  [ table : impliedvolm200n200 ] .",
    "hence , the experiments indicate that the performance of the calibration procedure is independent of the number of spatial grid points .",
    "the difference between the approximations of the fair value by discretizing either , , or is always of the size of the temporal discretization error , which is small .    by increasing @xmath299 the values",
    "@xmath370 have noticeably changed , which is related to the convergence of @xmath263 to the exact non - discounted fair value @xmath113 .",
    "the differences in implied volatility in tables  [ table : impliedvolm100n200 ] , [ table : impliedvolm100n400 ] , [ table : impliedvolm200n200 ] reveal that within the lv model and for the current , realistic values of @xmath371 the spatial discretization error is larger than the temporal discretization error ( cf .",
    "section [ timediscretization ] ) .",
    "since the calibration procedure from section [ calibration ] matches the fully discrete lv and slv models up to a difference with the size of the temporal discretization error , one can define an appropriate semidiscretization of the pde , control the spatial discretization error within the lv model , and then calibrate the slv model to the lv model such that the fully discrete slv model matches the market data up to an error which is dominated by the controlled spatial error from semidiscretization within the lv model .",
    "in financial practice , slv models are calibrated to market data for european call and put options by calibrating them to their underlying lv models . since there is often no closed - form analytical formula available for the fair value of vanilla options under an lv model , the best one can aim for",
    "is that the approximations of the fair value given by the two models are identical whenever similar numerical valuation methods are used . here",
    ", we choose to perform the numerical option valuation by semidiscretizing the respective backward kolmogorov equations with finite differences . by making use of an adjoint semidiscretization of the corresponding forward kolmogorov equations",
    ", we derived an expression for the leverage function such that the semidiscretized slv model is calibrated exactly to the semidiscretized lv model . in order to employ this expression",
    ", one has to solve a large non - linear system of odes . for the actual numerical calibration , temporal discretization of this system by a suitable adi method",
    "is combined with an inner iteration to deal with the non - linearity .",
    "our numerical experiments reveal that the fully discrete approximations of the fair value of european call options under the lv and slv models are always the same up to the size of the temporal discretization error .",
    "since the spatial discretization error is typically much larger than the temporal discretization error , one can control the former one by defining an appropriate semidiscretization of the lv model and then calibrate the fully discrete slv model de facto exactly to the fully discrete lv model .",
    "the work by the first author has been supported financially by a phd fellowship of the research foundation  flanders .                                  in  t  hout , k.  j. , welfert , b.  d. ( 2009 ) unconditional stability of second - order adi schemes applied to multi - dimensional diffusion equations with mixed derivative terms .",
    "_ , * 59 * , 677692 .",
    "wyns , m. ( 2016 ) convergence analysis of the modified craig ",
    "sneyd scheme for two - dimensional convection - diffusion equations with nonsmooth initial data . to appear in _",
    "i m a j. numer .",
    "_ , http://dx.doi.org/10.1093/imanum/drw028 ."
  ],
  "abstract_text": [
    "<S> this paper deals with the exact calibration of semidiscretized stochastic local volatility ( slv ) models to their underlying semidiscretized local volatility ( lv ) models . under an slv model , it is common to approximate the fair value of european - style options by semidiscretizing the backward kolmogorov equation using finite differences . in the present paper </S>",
    "<S> we introduce an adjoint semidiscretization of the corresponding forward kolmogorov equation . this adjoint semidiscretization is used to obtain an expression for the leverage function in the pertinent slv model such that the approximated fair values defined by the lv and slv models are identical for non - path - dependent european - style options . in order to employ this expression , a large non - linear system of odes </S>",
    "<S> needs to be solved . </S>",
    "<S> the actual numerical calibration is performed by combining adi time stepping with an inner iteration to handle the non - linearity . </S>",
    "<S> ample numerical experiments are presented that illustrate the effectiveness of the calibration procedure .    </S>",
    "<S> * key words : * stochastic local volatility ; adjoint spatial discretization ; calibration ; finite differences ; adi methods . </S>"
  ]
}