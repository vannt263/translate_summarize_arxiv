{
  "article_text": [
    "it has been observed that classification methods can be very accurate in high - dimensional problems , apparently contradicting the curse of dimensionality .",
    "a plausible explanation for this phenomenon is the `` low noise '' condition described , for instance , in @xcite .",
    "when the low noise condition holds , the probability mass near the decision boundary is small and fast rates of convergence of the classification error are possible in high dimensions .",
    "similarly , clustering methods can be very accurate in high - dimensional problems .",
    "for example , clustering subjects based on gene profiles and clustering curves are both high - dimensional problems where several methods have worked well despite the high dimensionality .",
    "this suggests that it may be possible to find conditions that explains the success of clustering in high - dimensional problems .    in this paper , we focus on clusters that are defined as the connected components of high density regions [ @xcite , @xcite ] .",
    "the advantage of density clustering over other methods is that there is a well - defined population quantity being estimated and density clustering allows the shape of the clusters to be very general .",
    "( a related but somewhat different approach for generally shaped clusters is spectral clustering ; see @xcite and [ @xcite ] . )",
    "of course , without some conditions , density estimation is subject to the usual curse of dimensionality .",
    "one would hope that an appropriate low noise condition would obviate the curse of dimensionality .",
    "such assumptions have been proposed by @xcite , @xcite , @xcite , and others . however , the assumptions used by these authors rule out the case where the clusters are very sharply defined , which should be the easiest cases , and , more generally , clusters defined on lower dimensional sets .",
    "the purpose of this paper is to define a notion of density clusters that does not rule out the most favorable cases and is not limited to sets of full dimension .",
    "we study the risk properties of density - based clustering and its stability properties , and we provide data - based methods for choosing the smoothing parameters .",
    "the following simple example helps to illustrate our motivation .",
    "we refer the reader to the next section for a more rigorous introduction .",
    "suppose that a distribution @xmath0 is a mixture of finitely many point masses at distinct points @xmath1 where @xmath2 .",
    "specifically , suppose that @xmath3 where @xmath4 is a point mass at @xmath5 .",
    "the clusters are @xmath6 .",
    "this is a trivial clustering problem even if the dimension @xmath7 is very high .",
    "the clusters could not be more sharply defined yet the density does not even exist in the usual sense .",
    "this makes it clear that common assumptions about the density such as smoothness or even boundedness are not well - suited for density clustering .",
    "now let @xmath8 be the lebesgue density of the measure @xmath9 obtained by convolving @xmath0 with the probability measure having lebesgue density @xmath10 , a kernel with bandwidth @xmath11 .",
    "unlike the original distribution @xmath0 , @xmath9 has full - dimensional support for each positive @xmath11 . the `` mollified '' density @xmath12 contains all the information needed for clustering .",
    "indeed , there exist constants @xmath13 and @xmath14 such that the following facts are true :    1 .   for all @xmath15 , the level set @xmath16 has disjoint , connected components @xmath17 ; 2 .",
    "the components @xmath18 contain the true clusters : @xmath19 for @xmath20 ; 3 .",
    "although @xmath18 overestimates the true cluster @xmath21 , this overestimation is inconsequential since @xmath22 and hence a new observation will not be misclustered ; 4 .",
    "let @xmath23 denote the kernel density estimator using @xmath10 with fixed bandwidth @xmath15 and based on a i.i.d .",
    "sample of size @xmath24 from @xmath0 .",
    "then , @xmath25 almost everywhere @xmath0 , which does not depend on the dimension @xmath7 ( see section [ sec::preliminaries ] )",
    ". the bias from using a fixed bandwidth @xmath11which does not vanish as @xmath26does not adversely affect the clustering .    in summary",
    ", we can recover the true clusters using an estimator of the density @xmath12 with a large bandwidth @xmath11 .",
    "it is not necessary to assume that the true density is smooth or that it even exists .",
    "our contributions in this paper are the following :    1 .   we develop a notion of density clustering that applies to probability distributions that have nonsmooth lebesgue densities or do not even admit a density .",
    "we find the rates of convergence for estimators of these clusters .",
    "we study two data - driven methods for choosing the bandwidth .",
    "we study the stability properties of density clusters .",
    "we show that the depth - first search algorithm on the @xmath27-nearest neighborhood graph of @xmath28 is effective at recovering the high - density clusters .",
    "another approach to clustering that does not require densities is the minimum volume set approach [ @xcite , @xcite ] .",
    "our approach is different because we are specifically trying to capture the idea that kernel density estimates are useful for clustering even when the density may not exist .",
    "section [ section::clusters ] contains notation and definitions .",
    "section [ section::rates ] contains results on rates of convergence .",
    "we give a data - driven method for choosing the bandwidth in section  [ sec::bandwidth ] .",
    "section [ section::stability ] contains results on cluster stability .",
    "the validity of the graph - based algorithm for approximating the clusters is proved in section [ sec::friend ] .",
    "section::examples ] contains some examples based on simulated data .",
    "concluding remarks are in section [ section::discussion ] .",
    "all proofs are in the section [ section::proofs ] .",
    "some technical details are in the .      for two sequences @xmath29 and @xmath30 , we write @xmath31 and @xmath32 if there exists a constant @xmath33 such that , for all @xmath24 large enough , @xmath34 and @xmath35 , respectively . if @xmath32 and @xmath31 , then we will write @xmath36",
    ". we denote with @xmath37 the probability of a generic event @xmath38 , whenever the underlying probability measure is implicitly understood from the context . by the dimension of a euclidean set",
    ", we will always mean the @xmath39-dimensional hausdorff dimension for some integer @xmath40 ( see the ) .",
    "these sets may consist , for example , of smooth submanifolds or even single points .",
    "in this section , we develop a probabilistic framework for the definition of clusters we have adopted . for ease of readability , the more technical measure - theoretic details are given in the .",
    "let @xmath0 be a probability distribution on @xmath41 whose support @xmath42 ( the smallest closed set of @xmath0-measure @xmath43 ) is comprised of an unknown number @xmath44 of disjoint compact sets @xmath45 of different dimensions .",
    "we define the _ geometric density _ of @xmath0 as the measurable function @xmath46 given by @xmath47 where @xmath48 is the euclidean ball of radius @xmath11 centered at @xmath49 , @xmath50 is the @xmath7-dimensional lebesgue measure and @xmath51 .",
    "note that , almost everywhere @xmath0 , @xmath52 if and only if @xmath49 belongs to some set @xmath53 having dimension strictly less than @xmath7 and is positive and finite if and only if @xmath49 belongs to some @xmath7-dimensional set  @xmath53 . in general , @xmath54 and , therefore , @xmath55 is not necessarily a probability density . nonetheless , @xmath55 can be used to recover the support of @xmath0 , since @xmath56 where for a set @xmath57",
    ", @xmath58 denotes its closure .    for @xmath14 ,",
    "define the @xmath59-level set @xmath60 and its boundary @xmath61 . throughout the paper",
    ", we will suppose that we are given a fixed value of @xmath62 , where @xmath63 .",
    "often , @xmath59 is chosen so that @xmath64 for some given @xmath65 . in practice , it is advisable to present the results for a variety of values of @xmath59 as we discuss in section [ section::discussion ] .",
    "we assume that there are @xmath66 disjoint , compact , connected sets @xmath67 such that @xmath68 we will often write @xmath21 instead of of @xmath69 when the dependence of @xmath59 is clear from the context . the value of @xmath39 is not assumed to be known .",
    "the sets @xmath70 are called the _ @xmath59-clusters _ of @xmath55 , or just _ clusters_. in our setting , the @xmath21 s need not be full dimensional .",
    "indeed , @xmath21 might be a lower - dimensional manifold or even a single point .",
    "furthermore , if @xmath53 has dimension smaller than @xmath7 , then @xmath71 , for some @xmath72 .",
    "thus , for any @xmath14 , the @xmath59-clusters of @xmath55 will include all the lower - dimensional components of @xmath42 . on the other hand ,",
    "if @xmath53 is full - dimensional , then there may be multiple clusters in it , depending on the value of @xmath59 .",
    "we observe an i.i.d .",
    "sample @xmath73 from @xmath0 , from which we construct the kernel density estimator @xmath74 where @xmath75 . for simplicity , we assume that the kernel @xmath76 is a symmetric , bounded , smooth function supported on the euclidean unit ball . these assumptions can be easily relaxed to include , for instance , the case of regular kernels as defined in devroye , gyrfi and lugosi [ ( @xcite ) , chapter 10 ] . in particular , while the compactness of the support of @xmath77 simplifies our analysis , it is not essential and could be replace by assuming fast decaying tails",
    ". further conditions on the kernel @xmath77 are discussed in section [ sec::preliminaries ] .",
    "let @xmath78 be the measurable function given by @xmath79 where @xmath80 .",
    "also , let @xmath81 be the probability measure given by @xmath82 , for any borel set @xmath83 .",
    "then , @xmath12 is the lebesgue density of the probability measure @xmath9 obtained by convolving @xmath0 with @xmath84 .",
    "more precisely , for each measurable set @xmath85 , @xmath86 borrowing some terminology from analysis , where the kernel @xmath77 is referred to as a mollifier , we call the measure @xmath9 and the density @xmath12 as the mollified measure and mollified density , respectively . for each @xmath11 , the mollification of @xmath0 by @xmath77 yields",
    "that :    1 .   the mollified measure @xmath9 has full - dimensional support @xmath87 and is absolutely continuous with respect to @xmath50 ; here , for two set @xmath85 and @xmath88 in @xmath41",
    ", @xmath89 denotes its minkowski sum ; 2 .",
    "the mollified density @xmath12 is of class @xmath90 whenever @xmath77 is of class @xmath90 , with @xmath91 .",
    "( a real valued function is of class @xmath90 if its partial derivatives up to order @xmath65 exist and are continuous . )",
    "( as a referee pointed out to us , the properties of mollified measures are related to the classical theory of distributions . )",
    "mollifying @xmath0 makes it better behaved . at the same time",
    ", @xmath9 and @xmath12 can be seen as approximations of the original measure @xmath0 and the geometric density @xmath55 , respectively , in a sense made precise by the following result .",
    "[ lem : ph ] as @xmath92 , @xmath9 converges weakly to @xmath0 and @xmath93 almost everywhere @xmath0 .    to estimate the @xmath59-clusters of @xmath55",
    ", we use the connected components of @xmath94 , that is , the @xmath59-clusters of @xmath23 .",
    "that is , we estimate @xmath95 with @xmath96    in practice , finding the estimated clusters is computationally difficult . indeed , to verify that two points @xmath97 and @xmath98 are in the same cluster , we need to find at least one path @xmath99 connecting them such that @xmath100 for each @xmath101 .",
    "conversely , when @xmath97 and @xmath98 do not belong to the same cluster , this property has to be shown to fail for every possible path between them .",
    "we discuss an algorithm for approximating the clusters in section [ sec::friend ] . until then , we ignore the computational problems and assume that the @xmath59-clusters of @xmath23 can be computed exactly .",
    "we consider two different risk functions .    * the _ level set risk _",
    "is defined to be @xmath102 , where @xmath103 and @xmath104 is the symmetric set difference .",
    "* define the _ excess mass functional _ as @xmath105 for any measurable set @xmath57 .",
    "this functional is maximized by the true level set @xmath95 ; see @xcite and @xcite .",
    "we can use the excess mass functional as a risk function except , of course , that we maximize it rather than minimize it . given an estimate @xmath94 of @xmath95 based on @xmath23 , we will then be interested in making the _ excess mass risk _",
    "@xmath106 as small as possible .",
    "furthermore , if @xmath0 has full - dimensional support , simple algebra reveals that maximizing @xmath107 is equivalent to minimizing , @xmath108 which is the loss function used by @xcite . in this case",
    ", the minimizer @xmath95 is unique . more generally , if @xmath109 where @xmath110 is the part of @xmath0 that is absolutely continuous with respect to the lebesgue measure , then @xmath111 where @xmath112 .",
    "it is clear that @xmath95 is no longer the unique minimizer of the excess mass functional .      throughout our analysis",
    ", we assume the following conditions .    1 .",
    "there exist positive constants @xmath113 , @xmath114 and @xmath115 such that @xmath116 2 .",
    "there exist a positive constant @xmath117 , and a permutation @xmath118 of @xmath119 such that , for all @xmath120 and all @xmath121 , @xmath122 where : a.   @xmath123 for @xmath124 ; b.   @xmath125 , for all @xmath126 .",
    "there exist a positive constant @xmath127 such that , for all @xmath128 and @xmath129 $ ] , @xmath130 where @xmath131 and @xmath132 is the dimension of the component @xmath53 of the support of @xmath0 such that @xmath133 .",
    "conditions of the form ( c1 ) or of other equivalent forms , are also known as low noise condition or margin conditions in the classification literature .",
    "they have appeared in many places , such as @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite and @xcite .",
    "this condition , first introduced in @xcite , provides a way to relate the stochastic fluctuations of @xmath23 around its mean @xmath12 to the clustering risk .",
    "indeed , the larger @xmath113 , the smaller the effects of these fluctuations , and the easier it is to obtain good clusters from noisy estimates of @xmath12 , for any @xmath134 .    conditions ( c2 ) simply require that the level set of the mollified density include the true clusters .",
    "the additional fringe @xmath135 can be viewed as a form of clustering bias .",
    "though mild and reasonable , these assumptions are particularly important , as they imply that the estimated density @xmath23 can be used quite effectively for clustering purposes , for a range of bandwidth values .",
    "this is is shown in the next simple result .",
    "let @xmath136 , @xmath137 and @xmath138 denote the number of @xmath59-clusters for @xmath55 , @xmath139 and @xmath140 , respectively .",
    "notice that we do not require @xmath55 to satisfy any smoothness properties .",
    "see section [ sec : cases ] for the case case of smooth densities .",
    "[ lem : clust.numb ] under conditions and for all @xmath141 and @xmath142 , on the event @xmath143 , @xmath144    condition ( c3 ) is used to obtain establish rates of convergence for the level set risk and the excess mass risk .",
    "it provides a way of quantifying the clustering bias due to the use of the mollified density @xmath12 as a function of the bandwidth @xmath11 , locally in a neighborhood of @xmath59 .",
    "in fact , if condition ( c2 ) holds , then the clustering bias is due to the sets @xmath145 , for @xmath128 and @xmath146 .",
    "[ lem : xi.theta ] under conditions and , for all @xmath147 and @xmath148 such that @xmath149 , @xmath150 where @xmath151 and , for some positive constant @xmath152 , @xmath153 where @xmath154 is either @xmath155 or @xmath43 ; in particular , @xmath156 only if @xmath157 .    condition ( c3 ) is rather mild and depends only on dimension of the support of  @xmath0 .",
    "indeed , it follows from the rectifiability property ( see the for details ) that if , @xmath53 is a component of the support of @xmath0 of dimension @xmath158 , then @xmath53 has box - counting dimension @xmath132 [ see , e.g. , @xcite , theorem 2.104 ] .",
    "this implies that ( c3 ) is satisfied for all @xmath11 small enough [ see also @xcite ] . for clusters @xmath21 belonging to full - dimensional components of the support of @xmath0 , ( c3 )",
    "follows if the sets @xmath159 have box - counting dimension @xmath160 for all @xmath129 $ ] and if @xmath117 is small enough . in fact , under these additional assumptions , it is possible to show that the bounds in lemma [ lem : xi.theta ] are sharp in the sense that , for all @xmath161 $ ] and @xmath120 , @xmath162 .",
    "in addition , provided that @xmath117 is smaller than the minimal inter - cluster distance @xmath163 we also obtain that @xmath164 , where @xmath154 can only be @xmath43 or  @xmath155 .",
    "finally , we point out that the value of @xmath117 depends on the curvature of the components @xmath165 for all @xmath166 , and on the minimal inter - cluster distance . the smaller the condition numbers [ see , e.g. , @xcite ] of these components , and the larger the inter - cluster distance , the larger @xmath117 .",
    "although the rates are not affected by the constants , in practice , they can have a significant effect on the results , since they may very well depend on @xmath7 .",
    "this is especially true of @xmath114 , as illustrated in example [ ex : gaussians ] below .",
    "we conclude this section with some comments on the parameter @xmath113 appearing in condition ( c1 ) , whose value affects in a crucial way the consistency rates , with faster rates arising from larger values of @xmath113 . if @xmath42 has dimension smaller than @xmath7 , then , clearly , @xmath167 , thus throughout this subsection we assume that @xmath0 is a probability measure on @xmath41 having lebesgue density @xmath55 .    first , a fairly general sufficient condition for assumption ( c1 ) to hold with @xmath168 at @xmath59 can be easily obtained using probabilistic arguments as follows .",
    "let @xmath169 denote the distribution of the random variable @xmath170 and suppose @xmath169 has a lebesgue density @xmath171 which is bounded away from @xmath172 and infinity on @xmath173 .",
    "then , by the mean value theorem , for any nonnegative @xmath174 , @xmath175 for some @xmath176",
    ". thus , ( c1 ) holds with @xmath177 at @xmath59 .",
    "see also example [ ex : gaussians ] below . a more refined result based on analytic conditions",
    "is given next .",
    "below @xmath178 denotes the @xmath179-dimensional hausdorff measure in @xmath41 .",
    "see the for the definition of hausdorff measure .",
    "[ lem:1 ] suppose that @xmath0 is a probability measure on @xmath41 having lipschiz density @xmath55 .",
    "assume that , almost everywhere @xmath50 , @xmath180 and that @xmath181 for any @xmath182 .",
    "then holds with @xmath177 for each @xmath183 except for a set of lebesgue measure @xmath172 .",
    "a further point of interest is to characterize the set of @xmath59 values for which condition ( c1 ) holds with @xmath184 .",
    "clearly , if @xmath55 has a jump discontinuity , then ( c1 ) holds with @xmath185 , for all values of @xmath59 in some interval . on the other hand , due to the previous result , if @xmath186 is bounded away from @xmath172 and @xmath155 in a neighborhood of @xmath187 , then @xmath177 .",
    "thus , one could expect a value of @xmath113 different than @xmath43 when @xmath188 does not exist or when @xmath189 is infinity or vanishes in @xmath187 .",
    "see the example on page 7 in @xcite , where ( c1 ) holds with @xmath190 if @xmath191 and @xmath192 if @xmath193 , the former case corresponding to @xmath194 and the latter to @xmath195 .",
    "however , this would seem to indicate that , if @xmath55 is sufficiently regular , the values of @xmath59 for which @xmath184 form a negligible set of @xmath196 .",
    "lemma  [ lem:1 ] above already shows that this set has lebesgue measure zero if @xmath55 is lipschitz with nonvanishing gradient . under stronger assumptions",
    ", it can be verified that this set is in fact finite .",
    "[ cor:2 ] under the assumption of lemma [ lem:1 ] , if @xmath55 is of class @xmath197 and has compact support , then the set of @xmath59 such that holds with @xmath184 is finite .",
    "[ example::sharp ] sharp clusters and lower - dimensional clusters .",
    "suppose that @xmath198 where @xmath199 is a density with support on a compact , connected set @xmath53 , @xmath200 and @xmath201 .",
    "moreover , suppose that @xmath202 where @xmath203 .",
    "finally , suppose that @xmath204 we denote clusters of this type as sharp clusters .",
    "see @xcite , for example .",
    "it is easy to see that ( c1 ) and ( [ eq : xi ] ) hold with @xmath205 .",
    "a more general example in which one of the mixture component is supported on a lower dimensional set is shown in figure [ fig::sharp ] .     and",
    "the mollified density @xmath12 for @xmath206 .",
    "the point mass at 0 is indicated with a vertical bar .",
    "bottom : the true clusters and the mollified clusters of @xmath12 with @xmath207 . ]    here , the true distribution is @xmath208 .",
    "the geometric density and the mollified density based on @xmath206 are shown in the top plot .",
    "the point mass at @xmath172 is indicated with a vertical bar .",
    "the bottom plot shows the true clusters and the mollified clusters based on @xmath12 with @xmath207 .",
    "the clusters based on @xmath12 contain the true clusters and the difference between them is a set of zero probability .",
    "[ ex : gaussians ] suppose that @xmath209 , with @xmath210 positive definite .",
    "set @xmath211 .",
    "then ( c1 ) holds for any @xmath212 with @xmath213 and @xmath214 , where the constant @xmath215 depends on @xmath7 ( and , of course , @xmath59 ) .",
    "we prove the claim only for @xmath216 , where @xmath217 .",
    "cases in which @xmath218 or @xmath219 can be dealt with similarly .",
    "let @xmath220 and notice that @xmath221 .",
    "for all @xmath222 smaller than @xmath223 simple algebra yields @xmath224 for some @xmath225 where @xmath226 denotes the density of a @xmath227 distribution and the second equality holds in virtue of the mean value theorem . by a first order taylor expansion , for @xmath228 , the first term on the right - hand side of the previous display can be written as @xmath229 since @xmath230 for any @xmath231 bounded by ( [ eq : bound.e ] ) , the claim is proved .     versus @xmath232 for @xmath233 .",
    "the plots are nearly linear since @xmath168 in this case . ]",
    "see figure [ fig::normal_epsilon ] .",
    "in this section , we study the rates of convergence in the two distances using deterministic bandwidths .",
    "we defer the discussion of random ( data driven ) bandwidths until section [ sec::bandwidth ] .      before establishing consistency rates for the different risk measures described above ,",
    "we discuss some necessary preliminaries .    in our analysis",
    ", we require the event @xmath234 to hold with high probability , for all @xmath24 large enough .",
    "in fact , some control over @xmath235 provides a means of bounding the clustering risks , as shown in the following result .",
    "[ lemma::handy2 ] let @xmath141 and @xmath236 be such that the conditions and are satisfied .",
    "then , on the event @xmath235 , @xmath237 where @xmath238 and @xmath239 therefore , on @xmath235 , under the additional condition , @xmath240    in order to bound @xmath241 , we study the properties of the kernel estimator @xmath23 .",
    "we will impose the following condition on the kernel @xmath77 .    1",
    ".   the class of functions @xmath242 satisfies , for some positive number @xmath85 and @xmath243 @xmath244 where @xmath245 denotes the @xmath232-covering number of the metric space @xmath246 , @xmath247 is the envelope function of @xmath248 and the supremum is taken over the set of all probability measures on @xmath41 . the quantities @xmath85 and @xmath243",
    "are called the vc characteristics of @xmath248 .    assumption",
    "( vc ) appears in @xcite , @xcite , and @xcite .",
    "it holds for a large class of kernels , including , for example , any compact supported polynomial kernel and the gaussian kernel .",
    "see @xcite and @xcite for sufficient conditions for ( vc )",
    ".    using condition ( vc ) , we can establish the following finite sample bound for @xmath249 , which is obtained as a direct application of results in @xcite .",
    "[ prop::density ] assume that the kernel satisfies the property and that @xmath250    1 .",
    "let @xmath11 be fixed .",
    "then , there exist constants @xmath251 and @xmath252 , which depend only on the vc characteristics of @xmath77 , such that , for any @xmath253 and @xmath254 , there exists an @xmath255 , which depends on @xmath232 , @xmath256 , @xmath257 and the vc characteristics of @xmath77 , such that , for all",
    "@xmath258 , @xmath259 2 .",
    "let @xmath260 as @xmath261 in such a way that @xmath262 .",
    "if @xmath263 is a sequence such that @xmath264 where @xmath265 , then , for all @xmath24 large enough , ( [ eq : sup ] ) holds with @xmath11 and @xmath232 replaced by @xmath266 and @xmath267 , respectively .",
    "in particular , the term on the right - hand side of ( [ eq : sup ] ) vanishes at the rate @xmath268 .",
    "the above theorem imposes minimal assumptions on the kernel @xmath77 and , more importantly , on the probability distribution @xmath0 , whose density is not required to be bounded or smooth , and , in fact , may not even exist . condition ( [ eq : p ] ) is automatically satisfied by bounded kernels .",
    "finally , we remark that , for fixed @xmath11 , setting @xmath269 for an appropriate constant @xmath270 ( depending on @xmath77 ) , an application of the borel ",
    "cantelli lemma yields that , as @xmath26 , @xmath271 almost everywhere @xmath0 .",
    "we now derive the converge rates for the clustering risks defined in section [ sec : risk ] .",
    "below , we will write @xmath270 for a constant whose value depends only on the vc characteristic of the kernel @xmath77 and on the constant @xmath256 appearing in ( [ eq : p ] ) .    we recall that lemma [ lem : xi.theta ] provides a way of controlling the clustering bias due to the sets @xmath145 , uniformly over @xmath272 and @xmath134 .",
    "in fact , the parameters @xmath273 and @xmath274 will determine the rates of consistency for the excess mass and the level set risk , respectively .",
    "specifically , higher values of the parameter @xmath275 which correspond to supports of lower dimension yield faster convergence rates for the excess mass risk . as for the level set risks ,",
    "the case @xmath276 is the most favorable , since it implies that the clustering bias has no effect on the estimation of level sets and dimension independent rates are possible . in particular ,",
    "if @xmath21 has dimension smaller than @xmath7 , then @xmath277 , so that @xmath276 . more generally , @xmath276 occurs when @xmath278 .",
    "overall our results yield that , as expected , better rates for the clustering risk are obtained for distributions supported on lower - dimensional sets .",
    "[ thm::levelset ] suppose that , , and hold .",
    "then there exists a constant @xmath279 such that , for any @xmath142 and @xmath280 , @xmath281 in particular , setting @xmath282 we obtain @xmath283    if @xmath167 , then either @xmath284 is empty or has zero lebesgue measure , or @xmath285 is a full dimensional set of positive lebesgue measure . the former cases , which correspond to @xmath0 having a lower - dimensional support or to sharp clusters ( see example [ example::sharp ] ) , implies that @xmath286 .",
    "thus , we have dimension independent rates for sharp clusters . in the latter case ,",
    "@xmath287 , so that @xmath288 is of order @xmath289 . when @xmath290 , then @xmath287 and the risk is of order @xmath291",
    ".    in practice , there are examples in between the sharp and nonsharp cases for probability distributions with full - dimensional support . for example , if there is a very small amount of mass just outside the cluster , then , technically , @xmath287 and the rate will be slow for large @xmath7 .",
    "however , if this mass is very small then we expect for finite samples that the behavior of the risk will be close to the behavior observed in the sharp case .",
    "we could capture this idea mathematically by allowing @xmath0 to change with @xmath24 and then allowing @xmath292 to vary with @xmath24 and take values between 1 and  @xmath155 .",
    "however , we shall not pursue the details here .    as an interesting corollary to theorem [ thm::levelset ]",
    ", we can show that the expected proportion of sample points that are incorrectly assigned as clusters or noise vanishes at the same rate .",
    "[ corollary::fi ] let @xmath293 , where @xmath294 then , @xmath295 .",
    "we now turn to the excess mass risk .",
    "[ thm::excessmass ] suppose that , , and hold .",
    "then , there exists a constant @xmath296 , independent of @xmath232 and @xmath11 , such that , for any @xmath120 and @xmath297 with @xmath298 , @xmath299 thus , setting @xmath300 we obtain @xmath301    when @xmath167 the excess mass risk @xmath302 is of order @xmath303 .",
    "thus , the higher  @xmath275 , that is , the smaller the dimension of the support of @xmath0 , the faster the rate of convergence . in particular , if @xmath0 is supported over a finite set of points the  risk vanishes at the dimension independent rate @xmath304",
    ". when @xmath290 , then @xmath305 and the risk is of order @xmath306 .      here , we discuss some interesting special cases .      in some cases , we might be content with estimating the level set @xmath307 , which is a biased version of @xmath308 .",
    "that is , the fringe @xmath309 may not be of great practical concern and , in fact , it may contain a very small amount of mass . indeed , we believe this is why clustering is often so successful in high - dimensional problems . exact estimation of the level sets is not necessary in many practical problems .",
    "in fact , by lemma [ lem : clust.numb ] , conditions ( c2 ) guarantees that @xmath94 will include @xmath95 with high probability .",
    "thus , for clustering purposes , one may consider some modifications of our risk functions .",
    "first , suppose we only require that the estimated clusters cover the true clusters .",
    "that is , we say there is not error as long as @xmath310 .",
    "this suggests the following modification of our risk functions :    * @xmath311 , * @xmath312",
    ".    then we have the following result , which gives faster , dimension independent rates .",
    "the proof is similar to the proofs of the previous results and is omitted .",
    "[ thm::biased ] let @xmath120 be fixed . under , and",
    ", then @xmath313 and @xmath314    alternatively , one may be only interested in estimating the clusters of the mollified density @xmath12 , for any fixed @xmath147 .",
    "then , provided that @xmath12 is sufficiently smooth ( which is guaranteed by choosing a smooth kernel ) and has finite positive gradient for each point in the set @xmath315 , the results in section [ sec : c1 ] show that , for all @xmath232 small enough , @xmath316 thus , under assumptions ( c2 ) and ( vc ) , similar arguments to the ones used in the proofs of theorems [ thm::levelset ] and [ thm::excessmass ] imply that @xmath317 and @xmath318 in either case , we get dimension independent rates .      in the more specialized settings in which @xmath0 has full - dimensional support and the lebesgue density @xmath55 is smooth , better results are possible .",
    "for example , using the same settings of @xcite , if @xmath55 is @xmath319-times hlder differentiable , then the bias conditions ( c2 ) are superfluous , as @xmath320 for some constant @xmath321 which depends only on the kernel @xmath77 . choosing @xmath11 such that @xmath322 , on the event @xmath235 , the triangle inequality yields @xmath323 .",
    "thus , for each @xmath324 and each @xmath11 such that @xmath325 , on @xmath235 , instead of ( [ eq : firstrates ] ) , one obtains @xmath326 then , setting @xmath327 and @xmath328 , we see that @xmath329 is of order @xmath330 , while @xmath331 is of order @xmath332 . these , are , up to an extra logarithmic factor , the minimax rates established by @xcite .",
    "in fact , under these smoothness assumptions , and since the bias can be uniformly controlled as in ( [ eq : p.bias ] ) , then , by a combination of fubini s theorem and of a peeling argument as in @xcite and @xcite , the exponential term @xmath333 becomes redundant and rates without the logarithmic term are possible .",
    "in this section , we discuss two data - driven method for choosing the bandwidth that adapts to the unknown parameters @xmath113 and  @xmath275 .",
    "before we explain the details , we point out that @xmath334 cross - validation is not appropriate for this problem .",
    "in fact , we are allowing for the case where @xmath0 may have atoms , in which case it is well known that cross - validation chooses @xmath335 .",
    "we propose choosing @xmath11 by splitting the data and maximizing an empirical estimate of the excess mass functional .",
    "polonik ( 1995 ) used this approach to choose a level set from among a fixed class @xmath336 of level sets of finite vc dimension . here",
    ", we are choosing a bandwidth , or , in other words , we are choosing a level set from a random class of level sets @xmath337 depending on the observed sample @xmath338 .",
    "the steps are in table [ fig::bandwidth ] .    ' '' ''    1 .   split the data into two halves which we denote by @xmath339 and @xmath340 .",
    "2 .   let @xmath341 be a finite set of bandwidths .",
    "using @xmath338 , construct kernel density estimators @xmath342 .",
    "let @xmath343 .",
    "3 .   using @xmath344 , estimate the excess mass functional @xmath345 4 .",
    "let @xmath346 be the maximizer of @xmath347 and set @xmath348 .    ' '' ''    to implement the method , we need to compute @xmath349 .",
    "in practice , @xmath349 can be approximated by @xmath350 where @xmath351 is a sample from a convenient density @xmath171 .",
    "in particular , one can choose @xmath352 for some large bandwidth @xmath353 .",
    "choosing @xmath354 ensures that the extra error of this importance sampling estimator is @xmath355 which is negligible .",
    "we ignore this error in what follows .",
    "technically , the method only applies for @xmath356 , at least in terms of the theory that we derive . in practice , it can be used for @xmath357 . in this case",
    ", @xmath358 becomes 1 when @xmath11 is large .",
    "we then take @xmath346 to be the smallest @xmath11 for which @xmath359 .",
    "below we use the notation @xmath360 instead of @xmath361 to indicate that the excess mass functional ( [ eq : excess.mass ] ) is evaluated at a random set depending on the training set @xmath338 and , therefore , is itself random . accordingly , with some abuse of notation , for any , we will write @xmath362 , with @xmath363 the @xmath59-level set of @xmath23 . below @xmath341 is a countable dense subset of @xmath364 $ ] .",
    "the next result is closely related to theorem 7.1 of @xcite .",
    "[ thm::split ] let @xmath365 . for any @xmath366 , @xmath367 where the expectation is with respect to the joint distribution of the training and test set , @xmath368 , with @xmath369 and @xmath370 .",
    "now we construct a grid @xmath371 of size depending on @xmath24 that is guaranteed to ensure that optimizing over @xmath371 implies we are adapting over @xmath113 and @xmath275 .",
    "[ thm::adapt ] suppose and hold .",
    "let @xmath372 where @xmath373 and @xmath374 let @xmath375 where @xmath376 and @xmath377 is the smallest integer less than or equal to @xmath378 , @xmath379 and @xmath380 let @xmath381 where @xmath382 .",
    "let @xmath383 be obtained by minimizing @xmath358 for @xmath384 .",
    "then @xmath385    the latter theorem shows that our cross - validation methods gives a completely data - driven method for choosing the bandwidth that preserves the rate .",
    "notice , in particular , that adapting to the parameter @xmath275 is equivalent to adapting to the unknown dimension of the support of @xmath0 .",
    "this makes it possible to use our method in practical problems as long as the sample size is large . for small sample sizes ,",
    "data splitting might lead to highly variable results in which case our bandwidth selection method might not work well .",
    "an alternative is to split the data many times and combines the estimates over multiple splits .    when @xmath386 , we have that @xmath387 . the above theorems are still valid in this case .",
    "thus , the case where @xmath0 is atomic is included while it is ruled out for @xmath334 cross - validation .",
    "another method for selecting the bandwidth is to choose the value for @xmath11 that produces stable clusters , in a sense defined below .",
    "the use of stability has gained much popularity in clustering ; see @xcite and @xcite , for example . in the context of @xmath39-means clustering and related methods , @xcite showed that minimizing instability leads to poor clustering . here , we investigate the use of stability for density clustering .",
    "suppose , for simplicity , that the sample size is a multiple of 3 .",
    "that is , the sample size is @xmath388 say .",
    "now randomly split the data into three vectors of size @xmath24 , denoted by @xmath339 , @xmath389 and @xmath390 .",
    "( in practice , we split the data into three approximately equal subsets . )",
    "we define the _ instability function _ as the random function @xmath391 $ ] given by @xmath392 where @xmath23 is constructed from @xmath338 , @xmath393 is constructed from @xmath394 and @xmath395 is the empirical distribution based on @xmath344 .    rather than studying stability in generality , we consider a special case involving the following extra conditions .    1 .   _ sharp clusters .",
    "_ assume that @xmath396 where @xmath397 , and @xmath398 is uniform on the compact set @xmath399 of full dimension @xmath7 .",
    "thus , @xmath400 where @xmath401 .",
    "let @xmath402 and let @xmath403 .",
    "spherical kernel .",
    "_ we use a spherical kernel so that @xmath404 where @xmath405 denotes the volume of the unit ball and @xmath406 is the empirical measure .",
    "the support of @xmath0 is a standard set .",
    "_ letting @xmath407 , we assume that there exists a @xmath408 such that @xmath409 where @xmath410 indicates the diameter of the set @xmath42",
    ". this property appears in a natural way in set estimation problems ; see , for example , @xcite .",
    "choice of @xmath59 .",
    "_ we take @xmath411 , so that @xmath278 .    under these settings ,",
    "the graph @xmath412 is typically unimodal with @xmath413 .",
    "hence , it makes no sense to minimize @xmath414 .",
    "instead , we will fix a constant @xmath217 and choose @xmath415    [ thm::stability ] let @xmath416 . under conditions 14 :    1 .",
    "@xmath417 and @xmath418 , for all @xmath419 ; 2 .",
    "@xmath420 ; 3 .   as @xmath421 , @xmath422",
    "; 4 .   for each @xmath423 , @xmath424 where @xmath425    to see the implication of theorem [ thm::stability ] , we proceed as follows .",
    "consider a grid of values @xmath426 of cardinality @xmath427 , for some @xmath428 . by hoeffding s inequality , with probability at least @xmath429",
    ", we have that @xmath430 replacing @xmath431 by @xmath432 and @xmath433 in the upper and lower bounds of part 4 of theorem [ thm::stability ] , respectively , setting them both equal to @xmath65 and then finally solving for @xmath11 , we conclude that the selected @xmath346 is upper bounded by @xmath434 and lower bounded by @xmath435 with probability larger than @xmath436 .",
    "thus , as @xmath437 , the resulting bandwidth does not tend to @xmath172 .",
    "hence , the stability based method leads to bandwidths that are quite different than the method in the previous section .",
    "our explanation for this finding is that the stability criterion is essentially aimed at reducing the variability of the clustering solution , but it is virtually unaffected by the bias caused by large bandwidths .    in the analysis above",
    ", we assumed for simplicity that @xmath357 .",
    "when @xmath356 , the instability @xmath412 can have some large peaks for very large @xmath11 .",
    "this occurs when @xmath11 is large enough so that some mode of @xmath438 is close to @xmath59 .",
    "choosing @xmath11 according to ( [ eq::alpha ] ) will then lead to serious oversmoothing .",
    "instead , we can choose @xmath346 as follows .",
    "let @xmath439 and define @xmath440 we will revisit this issue in section [ section::examples ] . a theoretical analysis of this modified procedure is tedious and , in the interest of space",
    ", we shall not pursue it here .",
    "lemma [ lem : clust.numb ] shows that , under mild , conditions and when the sample size is large enough , @xmath441 uniformly over @xmath128 with high probability .",
    "however , computing the number of connected components of @xmath442 exactly is computationally difficult , especially if @xmath7 is large . in this section ,",
    "we study a graph - based algorithm for finding the connected components of @xmath443 and for estimating the number of @xmath59-clusters @xmath136 that is based on the @xmath27-nearest neighborhood graph of @xmath444 that is fast and easy to implement .",
    "the idea using the union of balls of radius @xmath27 centered at the sample points to recover certain properties of the support of a probability distribution is well understood .",
    "for instance , @xcite and @xcite use it as a simple yet effective estimator of the support , while @xcite show how it can be utilized for identifying certain homology features of the support .",
    "in particular , @xcite and @xcite propose to combine a kernel density estimation with a single - linkage graph algorithm to estimate the number of @xmath59-clusters [ see also @xcite , for an application to large databases ] .",
    "our results offer similar guarantees but hold under more general settings .",
    "the algorithm proceeds as follows . for some @xmath128 and a given @xmath14 :    1 .",
    "compute the kernel density estimate @xmath23 ; 2 .",
    "compute the @xmath27-nearest neighborhood graph of @xmath445 , that is the graph @xmath446 on @xmath447 where there is an edge between any two nodes if and only if they both belong to a ball of radius @xmath27 ; 3 .   compute the connected components of @xmath446 using a depth - first search .",
    "the computational complexity of the last step is linear in the number of nodes and the number of edges of @xmath446 [ see , e.g. , @xcite ] , which are both random .",
    "we will show that , if @xmath27 is chosen appropriately , then , with high probability as @xmath26 :    1 .   the number of connected components of @xmath446 , @xmath448 , matches the number of true clusters , @xmath449 ; 2 .",
    "there exists a permutation of @xmath450 such that , for each @xmath451 and @xmath452 , @xmath453 where @xmath454 are the connected components of @xmath446",
    ".    we will assume the following regularity condition on the densities @xmath12 , which is satisfied if the kernel @xmath77 is of class @xmath197 and @xmath0 is not flat in a neighborhood of @xmath59 :    a.   there exist constants @xmath455 and @xmath456 such that for each @xmath128 , @xmath12 is of class @xmath197 on @xmath457 and @xmath458    let @xmath459 and set @xmath460 .",
    "notice that , under ( c2)(b ) , @xmath461 .",
    "finally , let @xmath462 denote the event in ( [ eq : supp ] ) , which clearly implies the event @xmath463 .",
    "[ thm::friends ] assume conditions and and let @xmath464 .",
    "assume further that there exists a constant @xmath465 such that , for every @xmath466 and for @xmath0-almost all @xmath467 , @xmath468 where @xmath469 , with @xmath470 .",
    "then there exists positive constants @xmath471 and @xmath472 , depending on @xmath473 and @xmath95 such that , for every @xmath474 , there exists a number @xmath475 such that , for any @xmath476 , @xmath477 uniformly in @xmath478 .",
    "the previous result deserves few comments .",
    "first , the constants @xmath471 , @xmath472 and @xmath465 depend on @xmath473 .",
    "second , assumption ( [ eq : standard ] ) is a natural generalization to lower - dimensional sets of the standardness assumption used , for example , in @xcite .",
    "it is clearly true for components @xmath479 of full - dimensional support that are absolutely continuous with respect to the lebesgue measure .",
    "finally , in view of lemma [ lem : suff.cond ] [ and , specifically , of the way @xmath480 is defined ] , theorem [ thm::friends ] holds for sequences @xmath481 , @xmath482 and @xmath483 such that :    1 .",
    "@xmath484 , 2 .",
    "@xmath485 ; 3 .",
    "@xmath486 and @xmath487 .    in particular ,",
    "if @xmath488 , then , following proposition [ prop::density ] , the term @xmath489 vanishes if @xmath262 .",
    "interestingly enough , condition ( c1 ) does not play a direct role in theorem [ thm::friends ] .",
    "we now consider a bootstrap extension of the previous algorithm , as suggested in @xcite . for any @xmath11 ,",
    "let @xmath490 , denote a bootstrap sample from @xmath140 conditionally on @xmath491 and let @xmath492 denote the @xmath27-neighborhood graph with node set @xmath493 .",
    "finally , let @xmath494 be the event given in ( [ eq : supp ] ) , except that @xmath454 are now the connected components of @xmath495 .",
    "[ thm::bootstrap ] assume conditions and .",
    "suppose that there exist positive constants @xmath465 and @xmath471 such that @xmath496 for any ball @xmath497 of radius @xmath498 and center in @xmath307 . then , for any @xmath499 , there exists a positive number @xmath475 such that , for each @xmath500 , @xmath501 uniformly in @xmath478 , where @xmath472 and @xmath321 are positive constants independent of @xmath11 and @xmath27 .",
    "the constants @xmath321 , @xmath465 , @xmath471 , and @xmath472 depend on both @xmath7 and @xmath502 .",
    "in our settings , condition ( [ eq : cond.boot ] ) clearly holds if @xmath0 has full - dimensional support .",
    "more generally , it can be shown that conditions ( g ) and ( [ eq : standard ] ) imply ( [ eq : cond.boot ] ) .    just like with theorem [ thm::friends ] , using lemma [ lem : suff.cond ] , it can be verified that the theorem holds if one consider sequences of parameters depending on the sample size such that @xmath484 , @xmath487 , @xmath503 and @xmath504 , provided that the conditions of proposition [ prop::density ] are met .    despite the similar form for the error bounds of theorems [ thm::friends ] and [ thm::bootstrap ] , there are some marked differences",
    ". in fact , in theorem [ thm::friends ] the performance of the algorithm depends directly on the sample size @xmath24 and , in particular , on the actual dimension @xmath505 of the support of @xmath0 , with smaller values of @xmath473 yielding better guarantees .",
    "in contrast , besides @xmath24 , the performance of the algorithm based on the bootstrap sample depends on the ambient dimension @xmath7 , regardless of @xmath473 , and on the bootstrap sample size @xmath506 . by choosing @xmath506 very large ,",
    "the expression @xmath241 becomes the leading term in the upper bound of the probability of the event @xmath507 .",
    "in this section , we consider a few examples to illustrate the methods .      in section [ section::stability ] , we pointed out that when @xmath356 and large , it is safer to use the modified rule @xmath508 where @xmath439 , in place of the original rule @xmath509 . we illustrate this with a simple one - dimensional example .    .",
    "the right plots show the true density and the kernel density estimator based on the selected bandwidth @xmath11 . in the top plots , @xmath357 . in the bottom plots , @xmath510 . ]",
    "figure [ fig::onedim1 ] shows an example based on @xmath511 points from the density @xmath55 that is uniform on @xmath512\\cup[5,6]$ ] .",
    "when @xmath357 ( top ) , the original rule works fine .",
    "( we use @xmath65 = 0.05 . )",
    "the selected bandwidth is small leading to the very wiggly density estimator in the top right plot .",
    "however , this estimator correctly estimates the level set and the clusters . in the bottom",
    ", we have @xmath510 .",
    "when @xmath11 is large , there is a blip in the instability curve corresponding to the fact that the modes of @xmath438 are close to @xmath59 .",
    "the original rule corresponds to the second vertical line in the bottom left plot .",
    "the resulting density estimator shown in the bottom right plot is oversmoothed and leads to no points being in the set @xmath513 .",
    "the modified rule corresponds to the first vertical line in the bottom left plot .",
    "this bandwidth works fine .     using the modified rule .",
    "the bottom left plot shows the estimated excess mass risk as a function of log bandwidth .",
    "the top right plot shows the true density and the kernel density estimator based on the selected bandwidth @xmath11 obtained by maximizing the excess mass . in both bottom plots , @xmath510 .",
    "both methods recover the level set and the clusters . ]",
    "figure [ fig::onedim2 ] compares the instability method ( top ) with the excess mass method ( bottom ) .",
    "both methods recover the level set and the clusters .",
    "we took @xmath514 in both cases .",
    "because @xmath59 is very large , the excess mass becomes undefined for large @xmath11 since @xmath515 for all @xmath49 , which we denoted by setting the risk to 0 in the bottom left plot .",
    "figure [ fig::fuzzy1 ] shows data from a fuzzy stick with a spiral . the stick has noise while the spiral is supported on a lower - dimensional curve .",
    "figure [ fig::fuzzy2 ] shows the clusterings from the instability method and the excess risk method with @xmath357 .",
    "both recover the clusters perfectly .",
    "note that the excess risk is necessarily equal to 1 for large @xmath11 . in this case , we take @xmath346 to be the smallest @xmath11 of all bandwidths that maximize the excess mass . we see that both methods recover the clusters .",
    "this is a 20-dimensional example .",
    "the data lie on two half - moons embedded in @xmath516 .",
    "the results are shown in figure [ fig::highdim ] . only the first two coordinates of the data are plotted .",
    "again we see that both methods recover the clusters .",
    "but only the first two components are plotted . ]    as is common in density clustering , we have assumed a fixed , given value of @xmath59 . in practice , we recommend that the results should be computed for a range of values of @xmath59 [ see , e.g. , @xcite , and references therein ] .",
    "it is important to choose a different bandwidth for each @xmath59 .",
    "indeed , inspection of the proof of theorem [ thm::excessmass ] shows that the optimal bandwidth is a function of @xmath59 and that @xmath517 as @xmath59 increases .",
    "further research on data - dependent methods to choose @xmath59 and @xmath27 ( the parameter used in the graph - based algorithm of section [ sec::friend ] ) would be very useful .",
    "we discussed the idea of using stability to choose a bandwidth .",
    "we saw that the behavior of the selected bandwidth is quite different than with the excess mass method .",
    "this method seems to work well for density clustering unlike what happens for @xmath39-means clustering [ @xcite ] .",
    "we believe that the stability method deserves more scrutiny . in particular",
    ", it would be helpful to understand the behavior of the stability measure under more general conditions .",
    "also , the detailed theoretical properties of the modified method for selecting @xmath11 based on stability should be explored .",
    "finally , we note that there is growing interest in spectral clustering methods [ @xcite ] .",
    "we believe there are connections between the work reported here and spectral methods .",
    "proof of lemma [ lem : ph ] the weak convergence follows from the fact that @xmath0 is a radon measure [ see , e.g. , @xcite , theorem  2.79 ] . as for the second part , if @xmath470 , where @xmath53 has hausdorff dimension  @xmath7 , then @xmath518 , with @xmath199 a lebesgue density , and the result follows directly from leoni and fonseca ( @xcite ) , theorem 2.73 , part ( ii ) .",
    "see also the . on the other hand",
    "if @xmath158 , then it is necessary to modify the arguments as follows . since @xmath77 is smooth and supported on @xmath519 , there exists a @xmath520 such that @xmath521 if @xmath522 .",
    "set @xmath523 , where @xmath524 is the volume of the unit euclidean ball in @xmath525 .",
    "then @xmath526 as as @xmath92 , @xmath527 , by ( [ eq : pi ] ) almost everywhere @xmath528 , while @xmath529 , thus showing that @xmath530 .",
    "proof of lemma [ lem : clust.numb ] by assumption ( c2 ) , for any @xmath531 and @xmath15 , @xmath532 on the event @xmath235 it holds that @xmath533 which implies that , on the same event , @xmath534    proof of lemma [ lem : xi.theta ] recall that @xmath10 is supported on @xmath535 . for the first claim , it is enough to show that , for any @xmath536 , @xmath537 . indeed , by ( c3 ) ,",
    "@xmath538 which implies  ( [ eq : theta ] ) .",
    "thus , we will prove that , if @xmath539 , then @xmath540 .",
    "for such a point @xmath541 , either @xmath542 or , by conditions ( c2 ) , @xmath543 for every @xmath544 . since the kernel @xmath77 has compact support , the latter case implies that @xmath545 as well .",
    "therefore , @xmath546 as for inequality ( [ eq : xi ] ) , it is enough to observe that the set @xmath547 either has zero probability ( because it is empty or has lebesgue measure @xmath172 ) or has positive lebesgue measure . in the former case",
    ", we obtain @xmath276 . in the latter case",
    ", @xmath548 must be full dimensional , so that , by ( [ eq : theta ] ) , @xmath549 , for all @xmath128 . since @xmath55 is bounded by @xmath59 on @xmath548 , we obtain @xmath550 which implies that we can take @xmath156 .",
    "proof of lemma [ lem:1 ] since @xmath55 is lipschitz and integrable , @xmath187 is @xmath178-measurable , so the integral @xmath551 is well defined for @xmath183 , where @xmath178 denote the @xmath179-dimensional hausdorff measure in  @xmath41 .",
    "furthermore , we can use the coarea formula .",
    "see @xcite and @xcite for backgrounds on hausdorff measures and the coarea formula . by the rademacher theorem , the set @xmath552 of points where @xmath55 is not differentiable has lebesgue measure zero . by lemma 2.96 in @xcite ,",
    "the set @xmath553 is such that @xmath554 , for all @xmath182 outside of a set @xmath555 of lebesgue measure @xmath172 . without loss of generality , below",
    "we may assume that @xmath552 and @xmath556 are empty .",
    "thus , we can assume that , for any @xmath557 , there exists positive numbers @xmath558 , @xmath321 and @xmath559 such that :    @xmath560 , almost everywhere-@xmath50 ;    @xmath561 .",
    "then for each @xmath141 , @xmath562 where the second equality holds because @xmath563 is bounded away from @xmath172 on @xmath564 by ( i ) , the third equality is a direct application of the coarea formula [ see , e.g. , proposition 3 , page 118 in @xcite ] and the last inequality follows from ( i ) and ( ii ) .",
    "proof of corollary [ cor:2 ] following the proof of lemma [ lem:1 ] and using our additional assumption that @xmath55 is of class @xmath197 , without any loss of generality , below we can assume that the set @xmath552 and @xmath556 are empty and we recall that @xmath565 has lebesgue measure @xmath172 . let @xmath566 be such that @xmath567 we now claim that there exists a nonempty neighborhood @xmath568 of @xmath569 for which @xmath570 indeed , arguing by contradiction , suppose that the previous display were not verified for any neighborhood @xmath568 of @xmath59 .",
    "then there exist sequences @xmath571 and @xmath572 such that @xmath573 , and @xmath574 and @xmath575 for each  @xmath24 . by compactness , it is possible to extract a subsequence @xmath576 of @xmath577 such that @xmath578 , for some @xmath579 . since @xmath55 is of class @xmath197 , this implies that @xmath580 as well .",
    "however , @xmath581 for each @xmath39 by construction , while @xmath582 .",
    "this produces a contradiction .",
    "thus , for each @xmath59 that is not a critical point , one can find a neighborhood of positive length containing it and , by lemma [ lem:1 ] , ( c1 ) holds at @xmath59 with @xmath177 .",
    "since , using compactness again , @xmath583 , this implies that there can only be a finite number of critical points for which @xmath113 may differ from @xmath43 .",
    "proof of lemma [ lemma::handy2 ] since @xmath174 and @xmath134 , in virtue of ( c2)(b ) it holds that , on @xmath235 , @xmath584 and @xmath585 because @xmath586 , the above inclusions imply , still on @xmath235 , that @xmath587 where it is clear that the sets @xmath85 and @xmath88 are disjoint . taking expectation with respect to @xmath0 of the indicators of the sets @xmath588 , @xmath85 and @xmath88 and using condition ( c1 ) and lemma [ lem : xi.theta ] yield ( [ eq : firstrates ] ) .",
    "proof of proposition [ prop::density ] the claimed results are a direct consequence of corollary 2.2 in @xcite .",
    "we outline the details below .",
    "we rewrite the left - hand side of ( [ eq : sup ] ) as @xmath589 \\biggr\\|_{\\mathcal{f}_h } > 2 \\varepsilon n h^d \\biggr\\},\\ ] ] where @xmath590 and then proceed to apply gin and guillou ( @xcite ) , corollary 2.2 . following their notation , we set @xmath591 and , since , @xmath592 \\leq\\sup_z \\int _ { \\mathbb{r}^d }",
    "k^2 \\biggl ( \\frac{z - x}{h } \\biggr ) \\,dp(x ) \\leq h^d d,\\ ] ] we can further take @xmath593 and @xmath594 , where @xmath321 is a positive constant , depending on @xmath11 , such that @xmath595 .",
    "then conditions ( 2.4 ) , ( 2.5 ) and ( 2.6 ) of @xcite are satisfied for all @xmath24 bigger than some finite @xmath596 , which depends on the vc characteristics of @xmath77 , @xmath256 , @xmath257 , @xmath321 and @xmath232 .",
    "part 2 is proved in a very similar way . in this case , we take the supremum over the the entire class @xmath248 and we set @xmath597 and @xmath598 . for all @xmath24 large enough , condition ( 2.5 )",
    "is trivially satisfied because @xmath488 , while equations ( 2.4 ) and ( 2.6 ) hold true by virtue of  ( [ eq : hn.en ] ) .",
    "the unspecified constants again depend on the vc characteristics of @xmath77 , @xmath256 and @xmath257 .",
    "proof of theorem [ thm::levelset ] we can write @xmath599 where for a random variable @xmath338 defined on some probability space @xmath600 and an event @xmath601 , @xmath602 . using proposition [ prop::density ] , the second term on the right - hand side is upper bounded by @xmath603 as for the first term on the right - hand side of ( [ eq : level.dec ] ) , without loss of generality , we consider separately the case in which the support of @xmath0 has no lower - dimensional components and the case in which it of lower dimension .",
    "the result for the cases in which the support has components of different dimensions follows in a straightforward way .",
    "if the support of @xmath0 consists of full - dimensional sets , then , on the event @xmath235 , @xmath604 where the first inequality stems from ( [ eq : firstrates ] ) and the second from conditions ( c1 ) and ( [ eq : xi ] ) .",
    "if instead @xmath0 has lower - dimensional support , then , because , on the event @xmath235 , @xmath605 and because @xmath606 by ( c2)(b ) , we see that , on @xmath235 , @xmath607 we conclude that @xmath608 is bounded by @xmath609 if the support of @xmath0 contains a full - dimensional set and is @xmath172 otherwise . this , combined with ( [ eq : e ] ) , yields the claimed upper bound on the level set risk with @xmath610 .",
    "the convergence rates are established using simple algebra .",
    "notice that the choice of the sequences @xmath611 and @xmath612 does not violate condition ( [ eq : hn.en ] ) .",
    "proof of corollary [ corollary::fi ] for each @xmath613 , @xmath614 where the last inequality is due to lemma [ lemma::handy2 ] .",
    "thus , @xmath615    proof of theorem [ thm::excessmass ] from ( [ eq : excessmass ] ) , we have @xmath616 where @xmath112 . since , on the event @xmath617 , @xmath618 , we obtain , on the same event , @xmath619 where the last equality is due to condition ( c2)(b ) .",
    "therefore , @xmath620 just like in the proof of theorem [ thm::levelset ] , we treat separately the case in which the support of @xmath0 is of lower - dimension and the case in which it consists of full - dimensional sets . if the support of @xmath0 is not of full dimension , then , on @xmath617 , @xmath621 by ( [ eq : theta ] )",
    "on the other hand , if the support of @xmath0 has no lower - dimensional components ( so that @xmath622 ) , still on the event @xmath617 and using lemma [ lemma::handy2 ] , @xmath623\\\\[-8pt ] & & { } + { \\int_{l_h(\\lambda- \\varepsilon ) - l(\\lambda- \\varepsilon ) } } | p - \\lambda| \\,d \\mu.\\nonumber\\end{aligned}\\ ] ]    the first term on the right - hand side of the previous inequality can be bounded as follows : @xmath624 where the last inequality is due to condition ( c1 ) . as for the second term of the right - hand side of ( [ eq : mass.dec ] ) , @xmath625 by ( [ eq : theta ] ) .",
    "thus , we conclude that @xmath626 is bounded by @xmath627 if the support of @xmath0 is a lower - dimensional set and by @xmath628 otherwise . next , by compactness of @xmath42 , and using ( [ eq : e ] ) , @xmath629 for some positive constant @xmath630 , uniformly in @xmath134 .",
    "the claimed upper bound on the excess mass risk now follows by taking @xmath631 .",
    "the convergence rates can be easily obtained by simple algebra .",
    "notice that the choice of the sequences @xmath632 and @xmath612 does not violate condition ( [ eq : hn.en ] ) .",
    "proof of theorem [ thm::split ] this follows by combining the version of talagrand s inequality for empirical processes as given in @xcite with an adaptation of the arguments used in the proof of theorem 7.1 in @xcite . for completeness",
    ", we provide the details .",
    "define @xmath633 , where @xmath634 and @xmath635 .",
    "set @xmath636 , where @xmath637 .",
    "recall that both @xmath638 and @xmath639 , are random sets depending on the training set  @xmath338 .",
    "we will bound @xmath640 , where the expectation is over the joint distribution of @xmath338 and @xmath394 .",
    "we can write @xmath641 where @xmath642 .",
    "note that @xmath643 thus , @xmath644 . we conclude that @xmath645    now we bound @xmath646 . consider the empirical process @xmath647 so that @xmath648 and @xmath649 .",
    "we have @xmath650 notice that , conditionally on @xmath338 , @xmath651 , where , for each , @xmath652 is the function given by @xmath653 with @xmath654 .",
    "let @xmath655 and notice that @xmath656 .",
    "thus , @xmath657 which , by corollary 13 in @xcite , is upper bounded by @xmath658 then , some algebra [ see problem 7.1 in @xcite ] yields the final bound @xmath659 where @xmath660 is given the in the statement of the theorem .    set @xmath661",
    ". then @xmath662 from ( [ eq::iter ] ) , we conclude that @xmath663 and so @xmath664 which implies that @xmath665 this shows ( [ eq::expect ] ) .",
    "proof of theorem [ thm::adapt ] define @xmath666 .",
    "for each @xmath275 , @xmath667 is decreasing in @xmath275 and @xmath668 hence , @xmath669 } r_n(\\gamma,\\theta ) \\leq 2\\inf_{\\gamma\\geq0 } r(\\gamma,\\theta)$ ] . some algebra shows that @xmath670 for all @xmath113 and @xmath275 .",
    "therefore , for each @xmath451 , @xmath671 .",
    "let @xmath672 . by theorem [ thm::excessmass ] , @xmath673 .",
    "let @xmath674 minimize @xmath675 for @xmath384 .",
    "then @xmath676 .",
    "so , @xmath677    proof of theorem [ thm::stability ] ( 1 ) when @xmath335 , @xmath678 and @xmath679 so that @xmath680 .",
    "since @xmath0 has a lebesgue density , with probability one , @xmath681 puts no mass on @xmath682 and , therefore , @xmath683 . by compactness of @xmath42 ,",
    "if @xmath684 , then @xmath685 , with the supremum attained by any @xmath686 . thus , as @xmath687 , @xmath688 and consequently , @xmath689 .",
    "\\(2 ) note that @xmath690 define @xmath691 .",
    "then @xmath692 where @xmath693 denotes identity in distribution .",
    "let @xmath694 .",
    "by fubini s theorem and independence , @xmath695\\\\[-8pt ] & = & 2 \\int_{\\mathbb{r}^d } \\mathbb{p}\\bigl(\\widehat{p}_h(z ) \\geq\\lambda \\bigr)\\mathbb{p}\\bigl(\\widehat{q}_h(z ) \\leq\\lambda\\bigr ) \\,dp(z ) \\nonumber\\\\ & = & 2 \\int_{\\mathbb{r}^d } \\pi_h(z)\\bigl(1-\\pi_h(z)\\bigr ) \\,dp(z).\\nonumber\\end{aligned}\\ ] ] since @xmath696 for all @xmath24 , @xmath11 and @xmath697 , ( 2 ) follows .",
    "\\(3 ) let @xmath698 be the @xmath699-dimensional vector obtained by concatenating @xmath338 and @xmath394 and define the event @xmath700 let @xmath11 be small enough such that @xmath701 ( trivially satisfied if @xmath411 ) .",
    "then , for any realization @xmath541 of the vector @xmath702 for which the event @xmath703 occurs , @xmath704 by our assumptions , @xmath705    using the union bound , we also have @xmath706 thus , it follows that , for fixed @xmath24 , @xmath707 as @xmath421 according to @xmath708    \\(4 ) by the same arguments used in the proof of point ( 1 ) , for all @xmath419 , @xmath709 almost everywhere with respect to the joint distribution of @xmath338 and @xmath394 , and , therefore , @xmath710 .",
    "thus , we need only to consider the case @xmath711 .",
    "set @xmath712 and denote with @xmath713 a random variable with distribution @xmath714 .",
    "then @xmath715 for each @xmath686 , set @xmath716 and @xmath717 . furthermore ,",
    "set @xmath718 and @xmath719 .",
    "then the expected instability can be written as @xmath720 so that @xmath721 , where @xmath722    we will now upper bound @xmath723 . for the first term , we proceed as follows .",
    "there exists a sphere @xmath724 such that @xmath725 .",
    "[ e.g. , choose any two points @xmath726 such that @xmath727 . set @xmath728 .",
    "] let @xmath729 .",
    "we claim that @xmath730 .",
    "this follows since if @xmath731 then @xmath732 and then @xmath733 .",
    "thus , if @xmath734 then @xmath735 . hence , @xmath736 where @xmath737    for the second term , let @xmath738 .",
    "then @xmath739 where @xmath740 .",
    "the third term is bounded above by 1 .",
    "hence , @xmath741 .",
    "now we lower bound @xmath742 .",
    "first , we claim that @xmath743 contains the intersection of a sphere of radius @xmath744 where @xmath745 , with @xmath42 .",
    "indeed , let @xmath734 .",
    "then there exists @xmath746 such that @xmath747 .",
    "let @xmath748 . by the triangle inequality , @xmath749 .",
    "so @xmath750 .",
    "therefore , @xmath751 where @xmath752 .    to lower bound the second term , let @xmath753 .",
    "then @xmath754 where @xmath755 .",
    "thus , @xmath756 . for the third term , argue as above that @xmath757 so the third term is larger than @xmath758 when @xmath11 is close enough to @xmath759 . hence , @xmath760 .",
    "proof of theorem [ thm::friends ] by our assumptions ( see section [ sec : settings ] ) , @xmath761 where @xmath469 , for any @xmath49 outside of a set of @xmath479 measure zero . by theorem 5.7 in @xcite",
    ", @xmath132 is also the box - counting dimension of @xmath53 .",
    "thus , @xmath762 . combined with ( [ eq : standard ] ) this implies that , without loss of generality , we can assume that there exist constants @xmath763 and @xmath764 such that for every ball @xmath88 of radius @xmath765 and center in @xmath308 , @xmath766 .",
    "let @xmath767 be a covering of @xmath308 with balls of radius @xmath768 and centers in @xmath308 , with @xmath498 .",
    "by compactness of @xmath95 , @xmath769 , where @xmath472 depends on @xmath473 and @xmath308 but not on @xmath27 .",
    "next , by lemma [ lem : clust.numb ] , on the event @xmath770 , the set @xmath443 consists of @xmath39 disjoint connected sets .",
    "since @xmath771 , this implies , on the same event , that @xmath772 .",
    "thus , on the event @xmath235 , for some @xmath773 to be specified below , a  sufficient condition for the event @xmath462 to be verified is that every @xmath774 contains at least one point from the set @xmath775 [ similar arguments are used also in @xcite , @xcite ] .",
    "we conclude that the probability of @xmath776 is bounded from above by @xmath777 since , on the event @xmath235 the set @xmath778 is contained in @xmath779 , we further have that , for each @xmath780 , @xmath781 where the inequality stems from the identity among events @xmath782 and the independence of the @xmath783 s . by lemma [ lem : suff.cond ] , for any fixed @xmath784",
    ", there exists a point @xmath785 such that @xmath786 , for all @xmath787 .",
    "thus , @xmath788 for all @xmath789 , where the second inequality is verified since @xmath790 . set @xmath791 .",
    "the result now follows from collecting all the terms and the inequality @xmath792 , valid for all @xmath793 .",
    "proof of theorem [ thm::bootstrap ] let @xmath703 be a covering of @xmath307 by balls of radius @xmath768 and centers in @xmath307 . by the same arguments used in the proof of the theorem  [ thm::friends ] , the probability of the event @xmath794 is bounded by @xmath795 where the probability is over the original sample @xmath796 and the bootstrap sample @xmath797 . here , the value of @xmath773 used in the definition of the event @xmath235 is to be specified below . because of compactness of the support of @xmath0",
    ", @xmath472 is a constant depending only @xmath7 and @xmath798 .    for a set @xmath799",
    ", we denote with @xmath800 the @xmath24-fold cartesian product of @xmath42 and with @xmath801 the conditional distribution of the bootstrap sample @xmath493 given @xmath802 , with @xmath803 .",
    "let @xmath804 , where @xmath23 is the kernel density estimate based on @xmath49 . then , for each @xmath780 , @xmath805 where , if @xmath806 , @xmath807 .",
    "for every @xmath808 , by the conditional independence of @xmath493 given @xmath802 , @xmath809 where @xmath810 by lemma [ lem : suff.cond ] , for any fixed @xmath811 and each @xmath11 , there exists a point @xmath812 such that @xmath813 , for all @xmath814 .",
    "thus , @xmath815 next , @xmath816 following the proof of lemma [ lem : suff.cond ] , one can verify that , because of assumption ( g ) , @xmath817 , as @xmath818 .",
    "thus , @xmath819 as @xmath818",
    ". then using ( [ eq : cond.boot ] ) and the facts @xmath811 and @xmath820 for each @xmath11 , we conclude that there exists a @xmath480 such that @xmath821 for all @xmath822 and for some appropriate constant @xmath321 , independent of @xmath27 and  @xmath11 .",
    "thus , @xmath823 and the results now follows by setting @xmath824 .",
    "[ lem : suff.cond ] assume conditions and .",
    "then , for any @xmath825 and @xmath826 , there exists a positive number @xmath480 such that , for all @xmath787 , @xmath827    the claim follows by minor modifications of the arguments used in the appendix of @xcite .",
    "we provide some details for completeness and refer to @xcite for background . because of assumption ( g ) and in virtue of the regular level set theorem [ see , e.g. , @xcite , corollary  8.10 ] , for any @xmath828 and @xmath128 , the set @xmath829 is a closed embedded submanifold of @xmath41 .",
    "let @xmath830 be the maximal radius of the tubular neighborhood around @xmath831 . set @xmath832 and notice that @xmath833 is positive for each @xmath147 .",
    "then , following the proof of biau , cadre and pellettier [ ( @xcite ) , proposition a.2 ] if @xmath773 , for any @xmath147 , @xmath834 where @xmath835 in the same constant appearing in ( [ eq : grad ] ) [ see equation ( a.1 ) in @xcite ] .",
    "in fact , since @xmath835 does not depend on @xmath11 , ( [ eq : dist.h ] ) holds uniformly over @xmath836 .",
    "set @xmath837 .",
    "then as @xmath838 by ( c2)(b ) , ( [ eq : final ] ) is verified for each @xmath787 .",
    "in this section , we describe in detail our assumptions on the unknown distribution @xmath0 . for the sake of completeness",
    ", we provide the basic definitions of hausdorff measure , hausdorff dimension , and rectifiability .",
    "we refer the reader to @xcite , @xcite , @xcite and @xcite for all the relevant geometric and measure theoretic background .",
    "let @xmath839 .",
    "the @xmath39-dimensional hausdorff measure of a set @xmath38 in @xmath41 is defined as @xmath840 , where , for @xmath841 $ ] , @xmath842 where the infimum is over all the countable covers @xmath843 of @xmath38 , with the convention @xmath844 .",
    "the hausdorff dimension of a set @xmath845 is @xmath846 note that @xmath847 is the counting measure , while @xmath848 coincides with the ( outer ) lebesgue measure .",
    "if @xmath849 , we will refer to any @xmath850-measureable set as a set of lower - dimension .",
    "when @xmath851 is an integer , @xmath852 coincides with the @xmath39-dimensional area of @xmath38 , if @xmath38 is contained in a @xmath197 @xmath39-dimensional manifold embedded in @xmath41 .",
    "the set @xmath38 is said to be @xmath850-rectifiable if @xmath39 is an integer , @xmath853 and there exist countably many lipschitz functions @xmath854 such that @xmath855 a radon measure @xmath856 in @xmath41 is said to be @xmath39-rectifiable if there exists a @xmath850-rectifiable set @xmath42 and a borel function @xmath857 such that @xmath858 for each measurable set @xmath83 .    throughout this article",
    ", we assume that @xmath0 is a finite mixture of probability measures supported on disjoint compact sets of possibly different integral hausdorff dimensions .",
    "formally , for each borel set @xmath83 and for some integer @xmath44 , @xmath859 where @xmath860 is a point in the interior of the @xmath861-dimensional standard simplex and each @xmath479 is a @xmath132-rectifiable radon measure with compact and connected support @xmath53 , where @xmath862 and @xmath863 , for each @xmath864 .",
    "notice that we also have @xmath865 . by theorem 3.2.18 in @xcite ,",
    "each of the lower - dimensional rectifiable sets comprising the support of @xmath0 , can be represented as the union of @xmath197 embedded submanifolds , almost everywhere @xmath0 .",
    "thus , we are essentially allowing @xmath0 to be a mixture of distributions supported on disjoint submanifolds of different dimensions and finite sets .",
    "our assumptions imply that , for every mixture component @xmath479 , there exists a @xmath866-measurable real valued function @xmath199 such that such that @xmath867 where @xmath524 is the volume of the unit euclidean ball in @xmath868 .",
    "see , for instance , mattila [ ( @xcite ) , corollary 17.9 ] or ambrosio , fusco and pallara [ ( @xcite ) , theorem 2.83 ] .",
    "indeed , @xmath199 is a density function with respect to @xmath528 since , for any measurable set  @xmath85 , @xmath869 where @xmath866 denotes the @xmath132-dimensional hausdorff measure on @xmath41 .",
    "we do not assume any knowledge of the probability measures comprising the mixture @xmath0 , of their number , supports and dimensions , nor of the vector of mixing probabilities @xmath860 .",
    "recall that the geometric density is the extended real - valued function defined as @xmath870 below , we list the key properties of the geometric density .",
    "notice , in particular , that @xmath55 is not a probability density with respect to @xmath871 , since , in general , @xmath872 .",
    "the geometric density satisfies the following properties :    @xmath52 if and only if @xmath470 with @xmath873 , almost everywhere @xmath0 ,    @xmath874 if and only if @xmath875 with @xmath876 , almost everywhere @xmath50 ,    @xmath877 ,    if @xmath878 , then @xmath879 ,    @xmath880 .    if @xmath53 has dimension @xmath7 , then , by the lebesgue theorem , @xmath881 @xmath50-almost everywhere on @xmath53 .",
    "similarly , if @xmath158 , then , by ( [ eq : pi ] ) , @xmath882 since @xmath883 as @xmath884 , @xmath866-almost everywhere on @xmath53 .",
    "thus , part ( i ) and ( ii ) follow . part ( iii ) is a direct consequence of ( i ) and ( ii ) , while parts ( iv ) and ( v ) stem directly from the definition of support .    as a final remark ,",
    "even though the geometric density @xmath55 is very different from the mixture densities @xmath199 , for our clustering purposes , we need only to concern ourselves with estimating the level sets of @xmath55 .",
    "the authors thank giovanni leoni and aarti singh for helpful discussions and two anonymous referees for many constructive comments and suggestions that greatly improved the exposition .",
    "ben - hur , a. , elisseeff , a. and guyon , i. ( 2002 ) .",
    "a stability based method for discovering structure in clustered data . in _ pacific symposium on biocomputing _",
    "( r. b. altman , a. k. dunker , l.  hunter , k. lauderdale and t. e. klein , eds . ) 617 .",
    "world scientific , new york .",
    "gin , e. and koltchinskii , v. ( 2006 ) .",
    "empirical graph laplacian approximation of laplace - beltrami operators : large sample results . in",
    "_ high dimensional probability _",
    "( e. gin , v. koltchinskii , w. li and j. zinn , eds . ) 238259 ."
  ],
  "abstract_text": [
    "<S> we study generalized density - based clustering in which sharply defined clusters such as clusters on lower - dimensional manifolds are allowed . </S>",
    "<S> we show that accurate clustering is possible even in high dimensions . </S>",
    "<S> we propose two data - based methods for choosing the bandwidth and we study the stability properties of density clusters . we show that a simple graph - based algorithm successfully approximates the high density clusters .    and    .    . </S>"
  ]
}