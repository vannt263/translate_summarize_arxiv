{
  "article_text": [
    "the macroscopic transport of solutes in porous media depends critically on microscopic features such as the structure of the porous matrix and the nature of the interactions between the solid and liquid phases . on the other hand",
    ", the complexity of the microscopic problem means that in practice it is often desirable to obtain a macroscopic effective - medium equation from which the macroscopic transport can be obtained directly .",
    "this idea of upscaling is ubiquitous in many sciences .",
    "in particular , diffusive transport in heterogeneous media occurs in hydrogeology ( aquifers , groundwater @xcite ) , contaminant transport ( water filtration with membranes ) , lithium - ion batteries @xcite , and biological applications such as porous biofilms @xcite and intracellular transport @xcite .",
    "efforts to find the form of the macroscopic equation and estimate the effective properties of the medium date back at least to the 19th century , when maxwell gives an approximate expression for the effective conductivity of a heterogeneous medium comprising small ( i.e.  well - separated ) spheres of one material distributed in another @xcite . since then a great variety of approaches have been developed to obtain such upscaled equations @xcite .",
    "a usual starting point is to suppose that the solute undergoes a simple diffusion process in the void or fluid phase @xmath0 of the porous medium @xmath1 so that the evolution of the concentration of particles @xmath2 is described by    [ origin ] @xmath3 where @xmath4 is the solid - fluid interface and @xmath5 is the outward unit normal to @xmath0 .",
    "the fraction of space available to the diffusing species is the porosity @xmath6 ( the complement of @xmath0 ) then the volume fraction of solid is @xmath7 .",
    "when the microstructure is fine we would like to be able to use an effective transport equation such as @xmath8 , \\qquad { \\bf x } \\in \\omega \\equiv \\omega_v \\cup \\omega_s,\\ ] ] where @xmath9 is an effective diffusion coefficient , which will depend both on @xmath10 and the geometry of @xmath0 . here",
    "@xmath11 is the homogenized solute concentration ( whose definition will be made precise in the next section ) .",
    "note that @xmath11 is defined throughout the material , whereas @xmath12 is defined only in the fluid region .",
    "in general , the homogenization procedure will depend on both the porous medium structure and the transport processes within the medium .",
    "a large number of homogenization techniques have been developed over the years @xcite .",
    "these can be divided into two very broad categories , deterministic and stochastic techniques .",
    "deterministic techniques include techniques such as volume averaging @xcite , multiple scales @xcite and the generalized taylor ",
    " brenner method of moments @xcite .",
    "here the averaging relies on the separation of scales between the microstructure and the macroscopic material , and is a local spatial average .",
    "many techniques , included the method of multiple scales and the generalized taylor ",
    "aris  brenner method of moments , assume some periodicity in the microstructure .",
    "in this case , the microscopic lengthscale measures variations within a period cell and the macroscopic lengthscale measures variations within the macroscopic region of interest .",
    "more specifically , the method of multiple scales constructs a family of problems involving the ratio @xmath13 between these two lengthscales and uses asymptotic expansions in @xmath13 to study systematically the convergence as @xmath14 to a limit problem .",
    "since @xmath13 is assumed to be small , the resulting family of problems contains rapidly oscillating ( periodic ) coefficients .",
    "thanks to its systematic nature , this method has formed the basis of a whole field in mathematics known as mathematical homogenisation @xcite .    in terms of the example above , deterministic approaches upscale from to by assuming a particular given geometry of the solid matrix @xmath15 from which the effective coefficient @xmath9 can be computed .",
    "for example , it is common to consider either very simple periodic structures [ such as the array of spheres depicted in figure  [ fig : det_ran](a ) ] or to consider a disordered unit cell representative of the material as a whole , which is then extended periodically @xcite . in the case of a periodic array of spherical inclusions , @xmath9 can be computed exactly using rayleigh s multipole method @xcite , leading to an infinite system of algebraic equations .",
    "more complex microscopic structures can be dealt with via multiple scales ( see for example @xcite ) or volume averaging @xcite . although these two methods are based on different underlying principles , they result in the same averaged equations @xcite .",
    "these equations contain effective parameters ( such as @xmath9 ) which depend on the microscale and are evaluated using the solution of a _ cell problem _ in the periodic unit cell ( in multiple scales ) or the solution of a closure problem in a _ representative elementary volume _",
    "( in volume averaging ) . for a review of the application of the method of volume averaging in ordered and disordered porous media",
    "we refer the reader to @xcite .",
    "the assumption of periodicity can be seen as artificial or too idealistic when modelling real heterogeneous media . as a result ,",
    "an obvious progression came in the form of homogenization techniques for random media , in an attempt to reflect the uncertainty caused by the high degree of heterogeneity as well as the lack of experimental data @xcite .",
    "in its simplest setting , this can be seen as replacing the periodicity assumption in the multiple scales method by stochastic periodicity ( or statistical homogeneity ) @xcite .",
    "in particular , this means that the problem now contains random coefficients rather than periodic ones , and the homogenization consists of taking an averaging window of size @xmath13 large enough so that ergodicity holds , that is , that a spatial average is equivalent to an ensemble average .",
    "a rigorous derivation of the limit problem as @xmath14 is quite challenging in general , but has been done in specific cases such as steady heat conduction @xcite or , in a discrete setting , in a random conductance model for a network of resistors @xcite . in natural porous media such as soils and aquifers , the problem to be upscaled is usually more challenging than the cases above , as often one must consider the coupled problems for groundwater flow and solute transport .",
    "stochastic approaches developed in the context of hydrology include the works of cushman @xcite , dagan @xcite , and gelhar @xcite .",
    "a common starting point is to take the hydraulic conductivity to be a random field , for example assuming it has a lognormal probability density function @xcite ( p.  164 ) . in particular",
    ", this implies that the stokes velocity and the solute concentration are random fields as well .",
    "the classical approach is to linearize both the flow and the transport equations and to then take ensemble averages of the resulting problem @xcite .    in terms of the particular problem ,",
    "a natural stochastic approach is to suppose that the microstructure is random and statistically homogeneous , with the effective properties arising by taking an ensemble average over different realizations of the microstructure @xcite .",
    "for example , one could assume that the solid matrix @xmath15 is composed of spherical inclusions uniformly distributed in @xmath1 with a non - overlapping constraint [ see figure  [ fig : det_ran](b ) for one sample of such configuration ] .",
    "however , it is usually very difficult to estimate the effective properties from such a description , since doing so requires an infinite set of statistical correlation functions , which are generally never known @xcite .",
    "brown @xcite provided a series form of the effective constant @xmath9 ( for dielectric constants rather than diffusivities , but the problem is analogous ) and showed that the first correction term to @xmath10 depends only on the solid volume fraction @xmath16 , but that all other terms require knowledge of the statistical distribution of the solid matrix .",
    "thus the best estimate one can obtain knowing only @xmath16 and @xmath10 is equivalent to maxwell s formula , namely @xmath17 . in the current notation .",
    "thus , the expression reported in @xcite for example is @xmath18 .",
    "the two definitions result in the same macroscopic equation for homogeneous media , but not when the volume fraction varies on the macroscale , as we will see later . ] as a result , subsequent work by hashin and shtrikman @xcite focused on using variational methods to obtain lower and upper bounds on @xmath9 as a function of @xmath16 , independent of the statistics of the medium .",
    "prager @xcite developed a method to introduce two- and three - particle correlation functions into such bounds .",
    "a specific application of these variational principles in the case of a porous medium formed by uniformly distributed spheres without non - overlapping constraints was used by weissberg @xcite , who obtained the upper bound @xmath19 . in @xcite . ]",
    "fig1_1a ( -10,90)(a )    fig1_1b ( -10,90)(b )    it is not completely clear which of these approaches is preferable in any given situation , or how they compare to each other . as pointed out in @xcite , enforced periodic structures can have an important influence on the homogenized model in low - porosity systems .",
    "on the other hand , the variational approaches used by brown @xcite or weissberg @xcite are very general and do not require any constraints on scale or periodicity .",
    "they would be applicable also for so - called non - homogenizable media , in which there is no clear separation of scales between micro and macrostructures .",
    "one situation in which all the approaches discussed above need to be rethought is that in which there is macroscopic inhomogeneity in the material as well as microscopic inhomogeneity .",
    "such a situation would arise in a material in which there is a non - uniform porosity on the macroscale .",
    "it might be thought that since the porosity is varying slowly it is locally constant , and the standard formulae can be used albeit with a cell problem ( and hence diffusivity ) which varies on the slow scale .",
    "however , we will see that this is not the case .",
    "despite its acknowledged importance in many physical systems ( for example , in the design of membranes for water filtration , in groundwater flow systems @xcite , and in portland cement @xcite ) , non - uniform porosity has rarely been accounted for in models and the effect on diffusion is not well understood .",
    "one exception is @xcite , which uses the method of volume averaging in systems with gradients in porosity .",
    "worryingly , though , they find that the effective diffusivity , the porosity , and its gradient are highly dependent upon the location of the centroid of the representative elementary volume .    in this paper",
    "we derive the effective transport equation for diffusion in a porous medium with gradients in porosity .",
    "we consider two types of porous media , namely an ordered medium with quasi - periodic inclusions and a disordered medium composed of randomly ( but not uniformly ) distributed inclusions .",
    "the homogenization procedures for each of these media are fundamentally different .",
    "thus , the purpose of the paper is twofold : first , to study how macroscopic changes in the microstructure affect the homogenized equation and , second , to compare the two different approaches used to model diffusion in porous media .",
    "we consider a simple diffusion process in the void or liquid phase , where the solute has a constant diffusion coefficient @xmath10 .",
    "the solid phase is composed of spherical and non - overlapping inclusions , which are impenetrable by the solute ( that is , the diffusion coefficient is zero in the solid phase ) . for most of this paper",
    "we consider a fixed solid matrix ( although we later remove this assumption in the stochastic approach to consider moving obstructions ) .",
    "we obtain the effective diffusion coefficient as a function of the microstructure of the medium , and in particular the porosity .",
    "we find that a non - uniform porosity on the macroscale results in an advection term in the homogenized equation , as found by @xcite .",
    "this term accounts for the biasing of the motion of solute particles towards regions of high porosity .",
    "we also show that our two approaches , although very different , can be reconciled to give the same macroscopic equation in the limit of small solid volume fraction .    the article is organized as follows . in  [ sec : determ ] we consider a deterministic approach and we apply the method of multiple scales to derive the effective transport equation in ordered porous media .",
    "we show how the method can be adapted to non - uniform porosity and non - periodic structures , providing they are locally periodic .",
    "we then consider the same problem for stochastic porous media ( disordered and non - periodic ) in  [ sec : stoch ] , and derive an equivalent effective equation from the fokker ",
    "planck description of the microstructure . in ",
    "[ sec : comparision ] we present two numerical studies comparing the two approaches , both with each other and with the exact solution of the corresponding microscopic problems .",
    "finally , in  [ sec : discussion ] , we present our conclusions .",
    "we rescale length and time so that the rescaled domain has volume one , @xmath20 and the molecular diffusion coefficient is @xmath21 . and @xmath10 as in the dimensional problem .",
    "] we also rescale concentration so that @xmath22 . for simplicity",
    "we assume that @xmath23^d$ ] , where the dimension @xmath24 may be @xmath25 or @xmath26 .",
    "we suppose that the solid phase consists of @xmath27 spherical and non - overlapping obstacles with radii @xmath28 and centers @xmath29 for @xmath30 . we suppose that the radius is a slowly varying function of position given by @xmath31 , so that we may write @xmath32 .",
    "thus @xmath33 , where @xmath34 is the @xmath24-dimensional ball of radius @xmath35 centered at @xmath36 .",
    "we begin by supposing that the centers @xmath29 lie on a regular square lattice with period @xmath37 , as depicted in figure  [ fig : periodicdomain ] . then reduces to    [ determin0 ]",
    "@xmath38 with @xmath39 .",
    "the local porosity is then @xmath40 .",
    "the global porosity is the average of the local porosities and is determined by the volume of all @xmath27 obstructions , namely @xmath41      we use the method of multiple scales to derive an averaged ( or homogenized ) model for the concentration @xmath12 , valid over many obstacles , in the limit @xmath37 .",
    "we retain @xmath42 as the macroscale variable , measuring distance on the scale of the whole sample , and introduce @xmath43 as the microscale variable , which measures distance over the scale of the obstacle separation .",
    "as is usual in the method of multiple scales we treat these two variables as independent .",
    "the extra freedom this gives is removed by enforcing that the solution is exactly periodic in @xmath44 ; small variations from one unit cell to the next are thereby captured through the macroscale variable @xmath42 .    after introducing these two scales and using the chain rule spatial derivatives in transform according to @xmath45",
    "we introduce @xmath46 as the the obstacle radius relative to the dimension of the unit cell .",
    "as stated above , a crucial assumption we make is that this varies slowly , that is , it depends on @xmath42 but not on @xmath44 .",
    "we denote the unit cell by @xmath47^d$ ] and the solid phase by @xmath48 , with the fluid phase then given by @xmath49 ( see right - hand side of figure  [ fig : periodicdomain ] ) .",
    "the expression allows us to transform according to the multiple - scales approximation .",
    "what is not clear is how we should write in multiple - scales form , given that the radius of the obstacle depends on @xmath42 , so that the unit normal depends on @xmath42 as well as @xmath44 . at first sight",
    "it would seem that geometry dictates that @xmath50 and should be written @xmath51 however , this is incorrect as it neglects the variation of @xmath5 with @xmath42 .",
    "the systematic way to derive the multiple - scales equivalent of is to introduce the function @xmath52 for which the fluid ",
    "solid interface is the level set @xmath53 .",
    "note that this idea can be extended to more complicated interfaces in a straightforward manner .",
    "the normal is in the direction @xmath54 , which we can now readily put in multiple - scales form using : @xmath55 this expression for the normal in multiple - scales form is far from obvious , and is a crucial part in extending the theory in @xcite to macroscopically varying cell geometries .",
    "there are two contributions to the interface normal in ; the first is due to the slow variation of the obstacle radius , and the second is the unit radial vector in the microscale .    thus writing in multiple - scales form gives    [ s1 ] @xmath56    where @xmath57 ( given in ) is the unit normal vector into the obstacle in the microscale variable .    our aim is to derive the equation for the averaged macroscopic concentration @xmath58 over a representative volume located at position @xmath42 . with our periodic microstructure",
    "we may define this as @xmath59 since @xmath60 in the solid phase . in the context of volume averaging",
    ", the unit cell @xmath61 is the _ representative elementary volume _ ( rev ) , and is located at the centre of each of the obstacles .",
    "the average @xmath11 is referred to as _ volumetric _ or _",
    "superficial average_. it is related to the _ intrinsic average _ @xmath62 through the porosity @xmath63 : @xmath64 with a spherical obstruction in the centre of each cell , the porosity is @xmath65 .",
    "the concentration @xmath11 is normalized in the whole space , whereas @xmath66 is normalized in the available space .    following the standard multiple - scales method",
    ", we now seek a solution to in the limit of small @xmath13 of the form @xmath67 which is periodic in @xmath68 , while treating @xmath42 and @xmath44 as independent .",
    "expanding in powers of @xmath13 as @xmath69 we find the leading - order equations require that @xmath70 is independent of @xmath44 . at first order in @xmath13",
    "we find    [ o1 ] @xmath71    the solution of can be written as @xmath72 where @xmath73 is a @xmath24-vectorial function , whose components @xmath74 satisfy the following _ cell problem _ :    [ cellproblem ] @xmath75    where @xmath76 is the @xmath77th component of the unit vector @xmath78 .",
    "we note that @xmath79 varies with the macroscale variable @xmath42 because of the variation of @xmath80 with @xmath42 .",
    "proceeding to second order in the expansion of leads to the following problem for @xmath81 :    [ o2 ] @xmath82    integrating over @xmath83 using the divergence theorem , and periodic boundary conditions on @xmath84 and @xmath81 yields @xmath85 now using the transport theorem to switch the order of integration with respect to @xmath44 and differentiation with respect to @xmath42 in the term on the right - hand side gives @xmath86 let @xmath87 be the jacobian matrix of @xmath88 given by @xmath89 . then using we may write @xmath90 combining and we arrive at the following equation for the leading - order intrinsic average :    [ sol_poreav ] @xmath91 , \\end{aligned}\\ ] ] where the effective diffusion tensor is given by @xmath92 where @xmath93 is the identity matrix of dimension @xmath24 .    the resulting model is equivalent to that derived by @xcite using a volume averaging approach . , @xmath94 and @xmath95 .",
    "however , we note that their cell problem ( 14 ) includes formally higher - order terms and hence is not exactly equal to our cell problem . ]",
    "we see that if @xmath96 is independent of @xmath42 then it may be cancelled on both sides of giving the usual homogenized result from multiple scales . however , when the radius of the obstacles varies with @xmath42 the effect is felt not only through @xmath9 ( due to a cell problem that depends on @xmath42 ) but also through the fact that @xmath96 on the right - hand side appears _ inside _ the @xmath97-derivative .",
    "the homogenized model for the intrinsic average @xmath66 is not yet an effective diffusion equation because of the porosity @xmath96 multiplying the left - hand side of .",
    "hence it is incorrect to refer to @xmath98 in as an effective diffusion coefficient .",
    "however , if we rewrite it in terms of the volume average @xmath99 we find @xmath100 =    \\nabla_{\\bf     x } \\cdot   \\left [ d_e({\\bf x } )   \\nabla_{\\bf x } c -     \\frac{d_e({\\bf x } ) \\nabla_{\\bf x } \\psi ( { \\bf x } ) } { \\psi ( { \\bf         x } ) } c   \\right ] .",
    "\\end{aligned}\\end{aligned}\\ ] ] thus , we see that , when written in terms of @xmath11 , the equation turns into a classical advection  diffusion equation , with @xmath101 the effective diffusion coefficient . the advection term arises when the porosity is non - uniform .",
    "we see that solutes diffuse with a bias towards regions of increased porosity .    in the case of uniform porosity @xmath102 ,",
    "the intrinsic average @xmath66 is simply a scaled version of the volumetric average @xmath11 and their respective equations and both reduce to a diffusion equation with constant diffusion coefficient @xmath9 as in .",
    "however , when the porosity is non - uniform the equations are different , and it is important to be clear which average of @xmath12 we are dealing with .      to evaluate the diffusion tensor @xmath101 in , we must solve the cell problem .",
    "so far we have not used that the obstacle in each cell is spherical , and in principle we could solve the cell problem ( numerically ) for any obstacle shape . however , having a spherical obstacle greatly simplifies the procedure .",
    "this is because , by symmetry , we find that @xmath9 is a multiple of the identity tensor , so that we have a single scalar diffusion coefficient .",
    "we solve the cell problem using comsol multiphysics and evaluate the integrals in numerically .",
    "we repeat for various @xmath103 and plot the resulting @xmath9 in figure  [ fig:23d_diag](a ) as a function of the solid volume fraction @xmath104 .",
    "the three - dimensional counterpart is shown in figure  [ fig:23d_diag](b ) .",
    "[ ] [ ] [ ] [ -90]@xmath105 [ ] [ ] [ ] @xmath106 [ ] [ ] [ ] [ -90]@xmath105 [ ] [ ] [ ] @xmath106 [ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) . shown are the simulation results of @xmath9 in ( data points ) , rayleigh s multipole method values ( solid lines ) and asymptotic result @xmath107 ( dash lines ) . ( a ) @xmath108 : square lattice [ square data points and ] and hexagonal lattice ( circle data points and ) ; asymptotic value @xmath109 .",
    "( b ) @xmath110 : cubic lattice ( square data points and ) and asymptotic value @xmath111.,title=\"fig : \" ] . shown",
    "are the simulation results of @xmath9 in ( data points ) , rayleigh s multipole method values ( solid lines ) and asymptotic result @xmath107 ( dash lines ) .",
    "( a ) @xmath108 : square lattice [ square data points and ] and hexagonal lattice ( circle data points and ) ; asymptotic value @xmath109 . ( b )",
    "@xmath110 : cubic lattice ( square data points and ) and asymptotic value @xmath111.,title=\"fig : \" ]    we next show with an example how , still using spherical obstacles , the microscopic arrangement of the obstacles can alter the effective diffusion coefficient , that is , two structures with the same porosity may have different @xmath9 . specifically ,",
    "we consider the hexagonal packing configuration in two dimensions .",
    "the periodic cell for such a configuration is @xmath112\\times [ -\\sqrt 3/2 , \\sqrt 3/2]$ ] with one disk at the centre and a quarter of a disk at each corner ( see figure  [ fig : cellh ] ) .",
    "we solve this new cell problem and evaluate the effective diffusion as a function of @xmath106 using .",
    "the resulting effective diffusion tensor is again a multiple of the identity ; we plot the scalar @xmath9 as a function of solid volume fraction @xmath106 in figure  [ fig:23d_diag](a ) .",
    "we find that , for the same value of @xmath106 , there are differences in the effective diffusion coefficient in a square or hexagonal configuration , which become important for @xmath106 above 50@xmath113 .",
    "as mentioned in the introduction , the exact values of @xmath114 in ordered lattices can be computed using rayleigh s multipole method , in the form of an infinite system of algebraic equations involving image multipoles and lattice sums @xcite . by truncating the infinite system",
    ", rayleigh obtained a closed - form approximation for a square lattice ( s ) and cubic lattice ( c ) . the corresponding result for a two - dimensional hexagonal lattice ( h )",
    "was derived in @xcite as :    [ multipole ] @xmath115    the values in parenthesis indicate the maximum volume fraction for which the closed forms are valid @xcite .",
    "these formulae are also plotted in figure  [ fig:23d_diag ] , and show good agreement with the multiple - scales result .      until now we have considered porous media with a simple regular structure , with the centers of the obstacles lying on a regular lattice , and accounted for macroscopic gradients in porosity by allowing the radius of the obstacles to vary slowly with position . in this section",
    "we consider an alternative way in which the porosity may vary : we suppose that the obstacles are all the same size , but that the number density of obstacles varies with position .",
    "this means that the obstacles can no longer be arranged on a regular periodic lattice .",
    "however , we suppose that their arrangement is locally a periodic lattice , but that the scale and orientation of the lattice vary slowly with position .",
    "to make this precise , we assume that the centers can be mapped to a regular periodic lattice with a map that depends only on the slow scale . effectively this map defines ( slow ) curvilinear coordinates in which the structure is periodic .",
    "we use a recently developed generalization of the multiple - scales method that can handle such a microstructure @xcite .",
    "thus we suppose there is exists a transformation @xmath116 mapping the centers of the obstacles @xmath29 into a regular lattice with periodicity @xmath13 , as illustrated in figure  [ fig : periodicdomain ] .",
    "we could now apply the method of multiple scales in the transformed domain , averaging over the fast scale , before inverting the transformation to write the homogenized equation back in the original variables .",
    "however , since the fast and slow scales are treated as independent , there is no point in transforming the slow scale , only to invert the transformation later .",
    "instead we suppose that the solution @xmath12 is a function of the slow scale @xmath42 and the transformed fast scale @xmath117 and that these variables are independent .",
    "then , since the microstructure is periodic in @xmath44 , we assume that @xmath12 is periodic in @xmath118 , with period one .",
    "we denote the unit cell in @xmath44 by @xmath61 and the obstacle by @xmath119 , where @xmath120 the available volume is then @xmath121 .    using the chain rule",
    "spatial derivatives now transform according to @xmath122 where @xmath123 or @xmath124 , and we are using the summation convention for repeated indices .",
    "the derivation of the homogenized equation is similar to the perfectly periodic case .",
    "the result is again an advection  diffusion equation for the concentration @xmath11 as in ,    [ sol_poreavmap ] @xmath125 , \\end{aligned}\\ ] ] with a modified diffusion tensor @xmath126 the function @xmath127 now satisfies the following cell problem    [ cellproblem_def ] @xmath128    in general the cell problem now depends on the slow scale @xmath42 not only through @xmath83 but also because @xmath129 depends on @xmath42 .      since the jacobian matrix @xmath129 is dependent only on the slow scale",
    "@xmath42 it represents a constant linear transformation on the fast scale .",
    "such a transformation can always be written @xmath130 where @xmath131 and @xmath132 are real orthonormal matrices and @xmath133 is a diagonal matrix .",
    "in fact , in our application we expect @xmath131 and @xmath132 to have positive determinant and therefore be rotations ( so that we maintain the right - handedness of the coordinate system ) .",
    "thus @xmath129 can be thought of as successive application of a rotation , a stretch along the coordinate axes , and then another rotation .    in the particular case",
    "in which the stretch is isotropic , so that the entries along the diagonal in @xmath133 are all equal , then @xmath129 reduces to an isotropic stretch and a single rotation . in this case",
    "we may write @xmath134 , where @xmath135 is a scalar stretch , and @xmath136 is a rotation matrix .",
    "maps @xmath137 whose jacobian @xmath129 have this property preserve angles , that is they are conformal . because the stretch is isotropic , spherical obstacles remain spherical under such a transformation , with the new radius of the original sphere centered at @xmath42 being @xmath138    for conformal maps the cell problem simplifies considerably , both because the sphere is mapped to a sphere , but also because @xmath139 thus the cell problem reduces to our original cell problem , with the slow scale felt only through the change in obstacle radius with position via .    in two dimensions , we may generate conformal maps by taking advantage of complex variables .",
    "if we write @xmath140 then any holomorphic function @xmath141 such that @xmath142 for @xmath143 is a conformal map .",
    "an example that we will use in our simulations later is the function @xmath144 which is one - to - one and holomorphic except at @xmath145 . in particular",
    ", this defines a conformal map between @xmath146 ^ 2 $ ] and @xmath147 , with inverse @xmath148 . in coordinate form , @xmath149 in figure  [",
    "fig : trans ] we plot the original domain @xmath1 and the domain @xmath150 .",
    "we see that in the transformed variables @xmath151 the centers of the obstacles lie on a regular square lattice , but the radii of the obstacles vary with position , that is , the structure is very similar to the one depicted in figure  [ fig : periodicdomain ] .",
    "fig2_4a ( -13,90)(a ) ( -1,50)@xmath152 ( 50,-5)@xmath153    fig2_4b ( -13,90)(b ) ( -3,50)@xmath154 ( 50,-5)@xmath155",
    "in this section we take a very different approach to model the same physical problem .",
    "we assume that the solid matrix is still formed of @xmath27 solid immobile non - overlapping spheres or disks of radius @xmath35 at positions @xmath156 , but now the @xmath157 are randomly distributed .",
    "the non - overlapping constraint means that the @xmath158 can not be distributed independently , but we suppose that they are distributed identically , that is , the probability distribution function is invariant with respect to permutations of the particle labels @xmath159 .    we suppose that there are @xmath160 mobile solute particles at positions @xmath161 , @xmath162 , at time @xmath163 , which undergo brownian motion with constant diffusion coefficient @xmath10 , which we may set to unity as before through appropriate nondimensionalisation .",
    "in contrast to the previous section , we relax the assumption that the solute particles are point particles and allow for them to have a finite size . to keep things simple",
    ", we assume the solute particles are also spherical and of radius @xmath164 and interact via hard - core elastic collisions with each other as well as with the obstacles .",
    "we will use the same approach as in our previous works @xcite , for which we require that the total particle volume fraction is small so that three - particle interactions and higher form a negligible fraction of state space and can be ignored . in terms of the parameters introduced above",
    ", this means that @xmath165 .",
    "each solute particle evolves according to the overdamped langevin stochastic differential equation @xmath166 where the @xmath167 are @xmath160 independent @xmath24-dimensional standard brownian motions .",
    "we suppose that the initial positions @xmath168 are random and identically distributed ( that is , the probability distribution is invariant with respect to a permutation of particle labels ) .",
    "let @xmath169 be the joint probability density of the @xmath170 particles , where @xmath171 and @xmath172 .",
    "we introduce the @xmath173dimensional position vector @xmath174 with the coordinates of the mobile particles in the first @xmath175 positions , and the obstacle positions in the remaining @xmath176 positions .",
    "the probability density evolves according to the fokker ",
    "planck equation    [ twofp ] @xmath177 although this looks like the standard diffusion equation we must remember that is solved in the low - dimensional physical space @xmath178 while equation is solved in the high - dimensional configuration space @xmath179 , corresponding to @xmath180 copies of the physical domain @xmath1 minus the set of illegal configurations corresponding to particles overlapping , @xmath181 where @xmath182 for @xmath183 and @xmath184 otherwise .",
    "it is convenient to introduce @xmath185 as the distance between centers at contact between an obstacle particle and a mobile particle , @xmath186 .    on the collision surfaces",
    "@xmath187 we have the reflecting boundary condition @xmath188 where @xmath189 is the projection of the unit normal on the first @xmath175 coordinates .",
    "since @xmath190 is invariant with respect to permutations of the labels in @xmath191 , the marginal density functions of @xmath192 corresponding to fixing the position of one obstacle and integrating over the positions of the remaining obstacles are all identical , and given by @xmath193 this gives the probability of finding an obstacle in a given position , that is , it is the obstacle population density .",
    "since @xmath194 is the volume of one obstruction , the local volume concentration of obstacles is @xmath195 where , as before , @xmath16 is the average solid volume fraction .    in order to compare the fokker ",
    "planck equation to the model we have derived via multiple scales , we need an equation for the marginal solute density @xmath196 defined on the physical domain @xmath1 . as with the obstacles , since the @xmath160 mobile particles are identically distributed , @xmath192 is invariant to permutations of their labels and we can define the solute population density as @xmath197 then the concentration of mobile particles is @xmath198 and the normalized concentration ( used in  [ sec : determ ] ) is @xmath199 .",
    "the procedure we adopt to derive an equation for @xmath200 from is a systematic asymptotic expansion as @xmath201 .",
    "we use matched asymptotic expansions in configuration space , with an outer region in which particles are well - separated , and an inner region in which two particles are close together . in contrast with other approaches this systematic procedure does not require a closure assumption .",
    "the derivation is analogous to that presented in our previous work @xcite , and we omit the details .",
    "in fact , the problem studied here can be regarded as a particular case of the model for two species of diffusing and interacting particles presented in @xcite if we formally set the diffusivity of one of the species to zero .",
    "although the derivation should really be modified in this limit , the result is identical to equation ( 22a ) in @xcite , which , in our notation , reads    [ asym_density ] @xmath202 , \\end{aligned}\\ ] ] where the diffusion and drift coefficients are @xmath203    for @xmath204 .",
    "the effective diffusion coefficient of solute particles has three components : the base molecular diffusion , an enhanced diffusion due to collective motion of finite size solute particles , and reduced diffusion due to excluded - volume interactions with the obstacle particles .",
    "the effective advection @xmath205 is due to the gradient in the distribution of obstacles ; it indicates that the particles are advected towards regions with fewer obstacles .",
    "note that there is no system - size expansion in ( [ asym_density ] ) : the equations are equally valid with small numbers of solute particles or obstacles ( for example , the collective term disappears if there is only one solute particle , as it should ) .",
    "the two approaches we have taken each have their strengths and weaknesses .",
    "the multiple - scales approach can handle arbitrary volume fraction of obstacles , but is limited to locally periodic structures and the diffusion of point particles of solute .",
    "the fokker ",
    "planck approach can handle arbitrary obstacle configurations and finite - size solute particles , but can only be reduced to a low - dimensional effective diffusion equation in the limit of small volume fraction .    in order to compare the two approaches later , we set @xmath206 in to consider point solute particles .",
    "the effective diffusion and drift coefficients reduce to    [ point_eff ] @xmath207 where @xmath208 .",
    "we plot @xmath209 given by in figure  [ fig:23d_diag ] with dashed lines .",
    "we observe that it agrees with the multiple - scales value @xmath9 for small volume fractions @xmath106 ( we will show this formally in  [ sec : deter_limit ] ) .",
    "we note that , in the cubic obstacle configuration ( @xmath110 ) , the asymptotic value @xmath209 is a good approximation to @xmath114 throughout the whole range of valid porosities .    for point solute particles ,",
    "the stationary density @xmath210 takes a very simple form . substituting in and imposing no - flux boundary conditions ,",
    "we find    @xmath211^{d-1 } \\sim   \\",
    "1- \\phi({\\bf x } ) = \\psi({\\bf x}),\\ ] ]    where @xmath212 is the normalization constant .",
    "this corresponds to the uniform measure in the available space , and is consistent with the stationary density found via multiple scales .      before moving on to compare our different approaches , we briefly examine how the effective transport properties of the solute particles change",
    "when the obstacles themselves are allowed to diffuse , with molecular diffusion @xmath213 ( in our dimensionless setting this represents the ratio of the diffusion coefficient of the obstacles to that of the solute ) .",
    "this would be relevant in biological applications such as the diffusion through biological tissues or the cytoplasm , where one is interested in the diffusion of small molecules through an environment containing large macromolecules @xcite .",
    "these macromolecules constitute the `` solid phase '' , which is sometimes considered as a porous structure since its dynamics are much slower than the smaller diffusing particles . using the general model in @xcite the coefficients in change to @xmath214 for @xmath204 . setting @xmath215 in recovers the expressions in as expected . from we",
    "see that the faster the obstacles move ( the larger @xmath213 ) , the less they impede the diffusion of the point solute particles , with their effect disappearing completely as @xmath216 .",
    "on the other hand , the larger @xmath213 is , the larger the coefficient in front of the drift term @xmath217 .",
    "this drift does not disappear in the limit , with @xmath218 as @xmath219 .",
    "of course , since the obstacles are much larger than the solute particles , we would expect that they diffuse more slowly , i.e. that @xmath220 in any practical situation .",
    "in this section we compare the macroscopic models for diffusion in a porous medium of variable porosity which we derived via multiple scales in  [ sec : determ ] and using the fokker ",
    "planck approach in  [ sec : stoch ] . as we mentioned above , the fokker ",
    "planck approach can only be systematically reduced to a low - dimensional effective diffusion equation in the limit of small volume fraction .",
    "we observed in figure  [ fig:23d_diag ] that the multiple - scales - derived diffusion coefficient seems numerically to asymptote to the fokker  planck - derived diffusion coefficient in this limit . in the next section",
    "we show that this is indeed the case , by considering the asymptotic solution to the multiple - scales model in the limit of low obstacle volume fraction @xmath16 .",
    "we then compare our effective equations with each other and with direct numerical simulations in a variety of test problems .",
    "we consider the model in the limit of low volume fraction @xmath16 .",
    "this means that the local volume fraction @xmath221 is also small ( almost everywhere ) , corresponding to small relative obstacle radius @xmath222 . in this limit",
    ", the cell problem can be solved explicitly .",
    "since @xmath42 , and hence @xmath223 , are constants as far as the cell problem is concerned , we can look for an asymptotic solution to in terms of the small parameter @xmath223 .",
    "consider , say , the first component of the vector function @xmath224 , which satisfies    [ cellproblem_1 ] @xmath225    we use the method of matched asymptotic expansions , supposing that the unit cell @xmath226 can be divided into two regions : an inner region in which , and an outer region in which @xmath227 . in the inner region , we set @xmath228 and define @xmath229 to give    [ cellproblem_as2 ] @xmath230    with a matching condition as @xmath231 .",
    "expanding @xmath232 gives that the leading - order inner solution @xmath233 is simply a constant in @xmath234 , whence the leading - order outer solution is also constant . at first order in @xmath235",
    "we find    [ cellproblem_as3 ] @xmath236    using polar ( @xmath108 ) or spherical ( @xmath110 ) coordinates , we look for a solution to of the form @xmath237 ( @xmath108 ) or @xmath238 ( @xmath110 ) , where @xmath239 when @xmath108 and @xmath240 when @xmath110 .",
    "we find that @xmath241}{(d-1)r^{d-1}},\\ ] ] for an unknown function @xmath242 .",
    "since the leading - order outer solution is constant in @xmath44 , matching gives @xmath243 .",
    "thus @xmath244 thus the first non - constant term in the outer expansion is @xmath245 .",
    "matching with the outer solution gives that @xmath246 as @xmath247 .",
    "we can now use this asymptotic behavior to determine the outer solution at this order .",
    "however , it is possible to determine the effective diffusion coefficient , which is our primary aim , with the information we already have . since the integrals we have to evaluate in are all derivatives with respect to some component of @xmath44 , by integrating with respect to this component first we turn the volume integral over the unit cell @xmath83 into surface integrals over the exterior periodic boundaries and the interior boundary with the solid obstacle .",
    "the contributions from the exterior boundaries cancel due to periodicity , while on the interior boundary we can use the asymptotic solution .",
    "the result is @xmath248 thus as @xmath249 , @xmath9 is a scalar multiple of the identity , equal to    @xmath250    since @xmath251 at leading order .",
    "as expected , this result agrees with the asymptotic value obtained with the fokker ",
    "planck approach .    the drift term in the multiple - scales homogenized equation is @xmath252 . using , we obtain @xmath253 this asymptotic value also agrees with the drift obtained in the reduced fokker ",
    "planck model ; see .",
    "finally we comment that the nature of the calculation above makes it clear that the configuration of the inclusions does not affect the diffusion coefficient at this order , since the dominant contribution comes from the solution of the cell problem in the inner region , which has no information about the position of the inclusion(s ) in the unit cell .",
    "the aim of this section is to compare the two models for diffusion in porous media against each other as well as against numerical simulations for the full problem and stochastic simulations of the particle system .",
    "first , we consider the mean squared displacement of particles diffusing in two homogeneous porous media with the same porosity , namely a deterministic structure with a square lattice of obstacles and a random structure with obstacle configurations drawn from a uniform distribution with non - overlapping constraints .",
    "second , we consider the spreading out of a localized initial concentration of particles in porous media with gradients in porosity .",
    "again we consider locally periodic structures accessible to the multiple - scales analysis and random structures with the same ( ensemble ) average porosity .",
    "all the simulations are made in a two - dimensional unit square domain @xmath1 with @xmath160 point mobile particles and @xmath27 hard - disk obstacles of constant radius @xmath35 .",
    "when the porous structure is random with probability law @xmath254 , a new configuration of obstacles is generated for every new run .      in this section",
    "we compare the diffusion coefficient computed from simulations of the discrete stochastic system to the effective diffusion coefficient obtained in the previous sections , either from multiple scales @xmath9 if the obstacles are placed in a regular structure , or from the fokker ",
    "planck description @xmath107 if the obstacles are randomly distributed with density @xmath254 . in particular , we consider two porous media with uniform porosity @xmath16 ( so that @xmath255 so that the drift is @xmath256 ) and the same number @xmath27 of obstacles : ( i ) a square lattice configuration , and ( ii ) a random uniform configuration of obstacles with non - overlapping constraints .",
    "the numerical value of the diffusion coefficient is obtained from the mean - square displacement , using the relation @xmath257 as @xmath258 . to evaluate the mean - square displacement , we run @xmath259 runs with @xmath260 mobile particles , and compute @xmath261 . here",
    "@xmath262 is the position of the @xmath77th particle in the @xmath263 realization at time @xmath163 .",
    "point particles , this is equivalent to averaging over particle trajectories and regenerating the solid matrix every @xmath160 realizations ) . ]",
    "our stochastic simulations are performed integrating eq .",
    "using an euler  maruyama scheme , with reflective boundary conditions between mobile particles and obstacles ( @xmath264 ) and periodic boundary conditions on the outer boundary ( @xmath265 ) .",
    "the reflective boundary conditions between the mobile point particles and the obstacles are implemented similar to as in @xcite , namely , the distance that a particle has travelled ( illegally ) inside an obstacle is reflected back into the domain @xmath0 . to do that , we compute the point on the obstacle boundary where the particle penetrated , and compute a particle  wall elastic collision on that point .",
    "the integration timestep @xmath266 must be chosen carefully so that virtually no collisions are missed .",
    "a convergence study is shown in the appendix and based on this , we have used @xmath267 in the results presented below .    we perform experiments with the periodic and random porous media at porosities @xmath268 and 30% . from figure  [ fig:23d_diag](a ) , we expect differences between the random and periodic porous media to become apparent from @xmath269 .",
    "the question is whether the discrepancy between @xmath9 and @xmath107 is real ( due to the structure ) or artificial ( due to the nature of the asymptotic approximation in obtaining @xmath107 ) .",
    "we plot the mean - square displacement @xmath270 against time in figure  [ fig : msd_simul](a ) for the square lattice ( solid lines with error bars ) and the random structure ( dashed lines with crosses and error bars ) .",
    "( the error bars indicate the 95% confidence interval , or @xmath271sd values , of each data point , and are barely discernible . )",
    "as expected , @xmath272 increases linearly with time , with a slope that decreases with @xmath16 .",
    "= .8 cm [ ] [ ] [ ] @xmath163 [ ] [ ] [ ] @xmath16 [ ] [ ] [ ] @xmath273 [ ] [ ] [ ] @xmath274 [ ] [ ] [ ] @xmath275 [ ] [ ] [ ] @xmath273 [ ] [ ] [ ] @xmath274 [ ] [ ] [ ] @xmath275 [ ] [ ] [ ] @xmath107 th .",
    "[ ] [ ] [ ] @xmath107 sim .",
    "[ ] [ ] [ ] @xmath9 th",
    ".   [ ] [ ] [ ] @xmath9 sim . [ ] [ ] [ ] @xmath272 [ ] [ ] [ ] @xmath276 [ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ ] [ ] [ ] simulation [ ] [ ] [ ] @xmath107 [ ] [ ] [ ] @xmath9 [ ] [ ] [ ] @xmath277   as a function of time @xmath163 for diffusion of point particles in the presence of obstacles .",
    "the obstacles are arranged on a square lattice ( error bars ) or uniformly distributed ( error bars with crosses ) and at volume fraction @xmath278 .",
    "the theoretical curves using @xmath9 ( eq . ) and @xmath107 ( eq . ) are shown with solid lines and dashed lines , respectively .",
    "( b ) the same data replotted as @xmath279 , to demonstrate that by the final simulation time the numerical diffusion coefficient has converged .",
    "the data points inside the dashed black rectangle are used to compute the numerical value of diffusion . in both plots ,",
    "the error bars indicate the 95% confidence interval .",
    "parameters used for the simulations are : @xmath260 , @xmath259 ( a new obstacle configuration was generated at every new run in the random case ) , @xmath267 , @xmath280 , and @xmath281 for @xmath282 respectively.,title=\"fig : \" ]   as a function of time @xmath163 for diffusion of point particles in the presence of obstacles .",
    "the obstacles are arranged on a square lattice ( error bars ) or uniformly distributed ( error bars with crosses ) and at volume fraction @xmath278 .",
    "the theoretical curves using @xmath9 ( eq . ) and @xmath107 ( eq . ) are shown with solid lines and dashed lines , respectively . (",
    "b ) the same data replotted as @xmath279 , to demonstrate that by the final simulation time the numerical diffusion coefficient has converged .",
    "the data points inside the dashed black rectangle are used to compute the numerical value of diffusion . in both plots ,",
    "the error bars indicate the 95% confidence interval .",
    "parameters used for the simulations are : @xmath260 , @xmath259 ( a new obstacle configuration was generated at every new run in the random case ) , @xmath267 , @xmath280 , and @xmath281 for @xmath282 respectively.,title=\"fig : \" ]    the diffusion coefficient is given by @xmath283 . to check that we have run the simulation for long enough and rule out any anomalous transient diffusion , in figure  [ fig : msd_simul](b ) we plot @xmath284 @xcite .",
    "this type of plot highlights any time dependence in the diffusion coefficient @xcite .",
    "we observe that , for all curves in figure  [ fig : msd_simul](b ) , the curves have slope 0 after the first @xmath285 and hence have converged .",
    "to evaluate the diffusion coefficient , we average over the last @xmath286 of each simulation ( data points marked with a dashed rectangle in figure  [ fig : msd_simul](b ) ) . from figure",
    "[ fig : msd_simul](b ) and the estimated values ( data not shown ) , we note that : ( i ) for the square lattice case , theory ( eq .",
    ", solid lines ) and simulation results ( solid error bars ) for @xmath9 agree very well , as expected since @xmath9 from is exact .",
    "( ii ) the random media simulation results ( error bars with crosses ) agree well with the asymptotic value @xmath107 ( eq . , dashed lines ) for @xmath287 but there is a significant discrepancy for @xmath288 .",
    "( iii ) the difference between the regular and random porous media is within the error bars for @xmath289 but becomes apparent for @xmath290 .",
    "interestingly , while the multiple - scales effective diffusion coefficient @xmath9 does a better job for the period medium ( as we might expect ) , the fokker  planck effective diffusion coefficient @xmath107 seems to do a slightly better job for the random medium .",
    "this was not at all obvious , since this coefficient is only the leading term in an expansion as @xmath291 ( while the multiple - scales coefficient is valid for all @xmath16 ) .",
    "it seems that , for a given obstacle volume fraction @xmath16 , random porous media may have a slightly lower diffusion coefficient than periodic ones . because @xmath107 is an asymptotic expansion",
    ", we can use the order of the next term to estimate the error . the next term in the asymptotic expansion of @xmath107",
    "is @xmath292 @xcite , which gives 0.065 and 0.1459 for @xmath293 and 0.3 respectively .",
    "the discrepancies in figure  [ fig : msd_simul](b ) between the asymptotic values @xmath107 and the simulation results for @xmath293 and 0.3 are 0.0103 and 0.0257 , respectively . in other words ,",
    "the effective diffusion @xmath107 does better than expected from the asymptotic error bounds .      for our second model comparison",
    ", we consider a porous medium with a non - uniform porosity .",
    "as before , we consider both a locally periodic array of obstacles of constant radius @xmath35 , and a random array of obstacles giving the same local porosity .    for the locally periodic structure we use the arrangement illustrated in figure  [ fig : trans](a ) .",
    "the obstacles have a fixed radius @xmath294 , and the average volume fraction of obstacle is . to generate a random periodic medium with the same ( ensemble ) average",
    "local porosity we need to determine the probability density function of obstacle position @xmath254 , which we have seen is related to the volume concentration of obstacles by @xmath295 this is easily found once we have determined the variable obstacle radius @xmath296 in the mapped multiple - scales domain ( shown in figure  [ fig : trans](b ) ) .    to determine @xmath296 ,",
    "consider one representative cell @xmath297 centered at @xmath42 in the original domain @xmath1 .",
    "the cell @xmath298 is mapped to a square of side @xmath13 centered at @xmath151 in @xmath299 , which we denote @xmath300 .",
    "the area of @xmath298 is then @xmath301 since the volume fraction in the cell is conserved , we have @xmath302 thus knowing @xmath303 through allows us to determine both @xmath221 ( and therefore @xmath254 ) , and also @xmath304 which we need in order to solve the multiple - scales cell problem . in figure",
    "[ fig : random_s](a ) we plot the density @xmath254 corresponding to the configuration shown in figure  [ fig : trans](a ) .",
    "we see that the maximum local solid volume fraction is about 2.5 times the average solid volume fraction @xmath16 . in figure",
    "[ fig : random_s](a ) we show one realization of obstacles randomly drawn from the corresponding probability distribution , with a non - overlapping constraint .",
    "fig4_2a ( -5,75)(a )    fig4_2b ( -10,90)(b )    we suppose that at @xmath305 a drop of solute of radius @xmath35 is placed centered at @xmath306 . we have chosen @xmath307 such that the drop does not intersect with any of the obstacles , that is , @xmath308 for @xmath309 .",
    "thus the initial condition is @xmath310 for @xmath311 , and zero otherwise .",
    "of course , this initial condition does not satisfy the requirement of the multiple - scales method that it varies slowly with respect to the obstacle separation ; nevertheless we expect that it will quickly spread into a function which does .    in figure",
    "[ fig : gradient_ia ] we illustrate the time evolution of the solute density for four different models . in figure",
    "[ fig : gradient_ia](a ) we show the ( numerically calculated ) true solution for the locally periodic distribution of obstacles . in figure  [ fig : gradient_ia](c ) we show the ( numerically calculated ) true solution for one realization of the random configuration of obstacles , distributed according to the density function @xmath254 . in figure",
    "[ fig : gradient_ia](b ) we show the solution of the effective equation derived through the multiple - scales method , while in figure  [ fig : gradient_ia](d ) we show the solution of the ( intrinsic version of the ) effective equation derived through the fokker  planck approach . in each case",
    "we show the intrinsic average @xmath66 , since this allows direct comparison between the solutions of the effective equations and the solutions of the real problems .",
    "given the normalization condition on @xmath11 , and hence we identify the intrinsic average as @xmath312 , where @xmath313 . ]",
    "we see that , perhaps counterintuitively , the maximum of the solute concentration initially moves to the right , towards the region of low porosity .",
    "this is because the localized source spreads out in all directions , but spreads out more in the high porosity region .",
    "the increased diffusion in the high - porosity region lowers the concentration more , giving the impression that the solute is moving towards the low - porosity region .",
    "at least visually , the two effective models capture the behavior of the true solutions , both for the regular structure and even for a single realization of the random structure . to make the comparison a little easier , we show in figure  [ fig : cut_ui ] a slice along the line @xmath314 for the true locally periodic solution , the multiple - scales - derived solution , and the fokker  planck - derived solution .",
    "we see that the agreement is remarkably good .",
    "fig4_3a ( 0,98)(a )    fig4_3b ( 0,98)(b )    fig4_3c ( 0,98)(c )    fig4_3d ( 0,98)(d )    = .8 cm    [ l][][]@xmath163 [ ] [ ] [ ] @xmath153 [ ] [ ] [ ] mspde [ ] [ ] [ ] fppde [ ] [ ] [ ] msfull [ ] [ ] [ ] [ -90]@xmath66    while the intrinsic average @xmath66 is the natural variable to compare with a particular realization of the microstructure , the volume average @xmath11 is the natural variable to compare with an ensemble average over a random microstructure ( and is also usually the natural variable in an application of the effective equations ) .",
    "while @xmath66 converges to the uniform measure as time evolves ( as in figure  [ fig : gradient_ia ] ) , the volume average @xmath11 approaches a non - uniform density which is a multiple of the porosity .",
    "we show in figure  [ fig : gradient_va ] the evolution of the volume average @xmath11 for three models . in figure",
    "[ fig : gradient_va](a ) we show the solution of the effective equation derived through the multiple - scales method , while in figure  [ fig : gradient_va](c ) we show the solution of the effective equation derived through the fokker ",
    "planck approach . in figure",
    "[ fig : gradient_va](b ) we show average of the true solution over 100 realizations of the randomly distributed obstacles .",
    "again , visually , both models seem to do a good job of approximating the ensemble average .",
    "fig4_5a ( 0,98)(a )    fig4_5b ( 0,98)(b )    fig4_5c ( 0,98)(c )    in figure  [ fig : cuty ] we show the solutions in figure  [ fig : gradient_va ] along the strip @xmath315 $ ] for @xmath316 . in figure",
    "[ fig : cuty](a ) we show the solutions of the multiple - scales - derived and fokker  planck - derived effective equations , along with the average over 100 realizations of the true solution for a random distribution of obstacles ( as in figure  [ fig : gradient_va ] ) . in figure",
    "[ fig : cuty](b ) we show some of the individual realizations along with the ensemble average , to give an idea of the variance .",
    "= .8 cm    [ b][][]@xmath163 [ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ ] [ ] [ ] @xmath153 [ ] [ ] [ ] [ -90]@xmath11 [ ] [ ] [ ] [ -90]@xmath11",
    "we have investigated the problem of diffusion through a porous medium in which the porosity is non - uniform .",
    "transport through porous media is inherently a multiscale process , with properties determined by individual pores at the microscale while one is usually interested transport over much larger distances . to derive an effective macroscopic model ,",
    "a common approach is to assume that all heterogeneities lie within the microscale and that , once these are averaged out , we are left with a homogeneous porous medium at the macroscale .",
    "it is tempting to suppose that , if the properties such as porosity do vary macroscopically , then all we have to do is carry out this procedure locally at each point ( that is , treat the material as though it were uniform with a porosity equal to the local porosity ) , so that the effective diffusivity becomes a function of macroscopic position .",
    "however , in this paper we have seen that this is not the case , and that a more careful analysis is needed .",
    "we have considered two different approaches to the upscaling problem , suitable for deterministic and random porous media respectively , and have generalized them to heterogeneous media .",
    "the result is a macroscopic advection  diffusion equation , with the advection term accounting for the macroscopic gradients in porosity .",
    "first , we have extended the method of multiple scales to account for non - uniform porosity ( via a microscopic cell geometry parametrized by the macroscopic variable ) and non - periodic structures ( providing they are locally periodic , that is , they can be mapped into periodic structures by a transformation depending only on the slow scale ) .",
    "the resulting equation is equivalent at leading order to the one presented in @xcite using a volume - averaging approach , although some formally higher - order terms are included in their unit cell problem ( which leads them to some worrying conclusions ; for example , the effective diffusivity depends on the location of the centroid in the unit cell ) .",
    "the multiple - scales method has the advantage of being a systematic asymptotic expansion ( for which higher - order terms could in principle be calculated ) which is able to handle any porosity .",
    "its disadvantage is that , even with our extensions , it requires the microstructure to be locally periodic .",
    "our examples have considered spherical obstacles that remained spherical when mapped to a periodic arrangement , which has greatly simplified parts of the presentation . however , the technique is more general . in particular",
    "if the diffusion tensor is anisotropic ( for example , if the inclusions were ellipsoids instead of spheres ) the technique demonstrates systematically that the principal directions of the diffusion tensor would be aligned with the local axes of the ellipsoids .",
    "one question that always arises when deriving effective equations with the method of multiple scales is how much of an error is introduced by treating the microstructure as periodic , when in reality it is unstructured . to address this question",
    ", we considered a second approach involving diffusion through a random distribution of spherical obstacles . in this case",
    "we again used a systematic asymptotic expansion , but this time in the limit of low volume fraction of obstacles .",
    "the macroscopic equation turns out to be a particular case of our model for the diffusion of binary mixtures of finite - sized particles @xcite , when the diffusivity of one of the species is set to zero .",
    "we compared the macroscopic models described above to each other and also to their microscopic counterparts . for the examples we considered both effective material models performed well , and the differences between the structured and unstructured media were small .",
    "for both deterministic and random media , the mean - square displacement @xmath272 analysis in figure  [ fig : msd_simul ] showed that the effective transport mechanism of the solute particle is still normal diffusion , that is , @xmath272 grows linearly in time , and it is only the diffusion coefficient that changes from one ( in the microscale ) to @xmath9 in the macroscale .",
    "however , depending on the timescale used in such analysis , one can observe _ transient _ anomalous diffusion ( the transient period can only just be seen in our simulations , see figure [ fig : msd_simul](b ) ) . in the context of porous media ,",
    "if the ratio @xmath35 between pore scale and typical domain length is not sufficiently small , diffusion may occur in a lengthscale shorter than the crossover region between transient anomalous diffusion and normal diffusion @xcite . this transient behavior should not be confused with real _ stationary _ anomalous diffusion @xcite .",
    "using the method described in  [ sec : self - diffusion ] , we compute the effective diffusion coefficient in porous media with 20% obstacle volume fraction , with obstacles either on a square lattice or uniformly distributed .",
    "we use the same parameters as in figure  [ fig : msd_simul ] except the timestep @xmath266 , which we will vary to perform a convergence study .",
    "in addition , we use this study to check the number of trajectories ( the number of particles @xmath160 times the number of runs @xmath317 ) required to obtain an accurate mean - square displacement .",
    "this is particularly important in the random case , as we need to obtain an accurate mean from the distribution of random media .",
    "the mean displacement of a diffusive particle according to is @xmath318 .",
    "if the obstacle s diameter is @xmath319 , then we should use @xmath320 such that @xmath321 .",
    "we use a simulation time @xmath322 ( so that each particle has had time to diffuse across almost the whole domain @xmath1 ) .",
    "we choose a mean step @xmath323 for @xmath324 , or , equivalently , a timestep @xmath325 , where @xmath280 .",
    "the diffusion coefficients are obtained as the average of the last 10 data points of the time series ( after checking it has converged to a stationary value , see dashed area in figure  [ fig : msd_simul](b ) ) .",
    "the resulting values for the periodic and random media , denoted by @xmath326 and @xmath327 respectively , are shown in table [ table : de ] . the standard deviation in both cases is below 0.006 for all @xmath263 .",
    ".diffusion coefficient in a square lattice with volume fraction @xmath269 from simulations using @xmath325 .",
    "theoretical predictions @xmath9 and @xmath107 from eqs . and",
    "respectively are also shown . [ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]      the order of convergence of @xmath326 and @xmath327 as @xmath328 is one ( in @xmath266 ) , as expected from the euler ",
    "maruyama integration scheme .",
    "we can apply repeated richardson extrapolations @xmath329 and @xmath330 to improve the accuracy of these numerical results ( see table [ table : de ] ) . by the last extrapolation , @xmath331 appears to have five correct figures , three of which coincide with the theoretical value @xmath9 .",
    "similarly , @xmath332 has four correct figures , two of which agree with the theoretical value @xmath107",
    ".    * acknowledgements . *",
    "the authors thank dr martin robinson for helpful discussions on the implementation of the stochastic algorithms . in particular",
    ", we benefited from his software library aboria ( available online at https:@xmath333github.com/martinjrobins/ aboria ) , which includes the neighbourhood search subroutine we have used to speed up the calculation of collisions in the stochastic simulations ."
  ],
  "abstract_text": [
    "<S> the problem of diffusion in a porous medium with a spatially varying porosity is considered . </S>",
    "<S> the particular microstructure analyzed comprises a collection of impenetrable spheres , though the methods developed are general . </S>",
    "<S> two different approaches for calculating the effective diffusion coefficient as a function of the microstructure are presented . </S>",
    "<S> the first is a deterministic approach based on the method of multiple scales ; the second is a stochastic approach for small volume fraction of spheres based on matched asymptotic expansions . </S>",
    "<S> we compare the two approaches , and we show good agreement between them in a number of example configurations .    diffusion , porous media , hard spheres , multiple scales , variable porosity .    35b27 , 35q84 , 60j70 , 82c31 </S>"
  ]
}