{
  "article_text": [
    "integration of the form @xmath6 , where @xmath1 is either @xmath2 or @xmath7 , is widely encountered in many engineering and scientific applications , such as those involving fourier or laplace transforms",
    ". often such integrals are approximated by numerical integrations over a finite domain @xmath4 , resulting in a truncation error @xmath8 , in addition to the discretization error .",
    "one example is a discrete fourier transform ( dft ) , where there is a truncation error due to cut - off in the tail , in addition to the discretization error .    in theory",
    "the cut - off error can always be reduced by extending the finite domain at the expense of computing time . however , in many cases a sufficiently long integration domain covering a very long tail can be computationally expensive , such as when the integrand @xmath9 itself is a semi - infinite integration ( e.g. forward fourier or laplace transform ) , or when the integrand decays to zero very slowly ( e.g. a heavy tailed density or its characteristic function ) . much work has been done to directly compute the tail integration in order to reduce the truncation error .",
    "examples include nonlinear transformation and extrapolation ( wynn 1956 , alaylioglu et al 1973 , sidi 1980 , 1982 , 1988 , levin and sidi 1981 ) and application of special or generalized quadratures ( longman 1956 , hurwitz and zweifel 1956 , bakhvalov and vasileva 1968 , piessens 1970 , piessens and haegemans 1973 , patterson 1976 , evans and webster 1997 , evans and chung 2007 ) , among many others .",
    "this paper describes a very simple , perhaps the simplest , end - point correction to account for the tail integration over the entire range @xmath10 .",
    "the treatment of the tail reduces the usual truncation error significantly to a much smaller discrete error , thus increasing overall accuracy of the integration , while requiring virtually no extra computing effort . for the same accuracy ,",
    "this simple tail correction allows a much shorter finite integration domain than would be required otherwise , thus saving computer time while avoiding extra programming effort .",
    "to our knowledge this result is not known in the literature and we believe it deserves to be published for its elegant simplicity and broad applicability . though it is possible that our formula is a rediscovery of a very old result hidden in the vast literature related to numerical integration .",
    "the paper is organized as follows . in section 2",
    ", we derive the tail integration approximation and its analytical error .",
    "a few examples are shown to demonstrate the effectiveness of the tail integration approximation in section 3 .",
    "concluding remarks are given in section 4 .",
    "consider integration @xmath11 . without loss of generality , we assume @xmath12 ( a change of variable @xmath13 results in the desired form ) . for @xmath14",
    "the derivation procedure and the resulting formula are very similar . in the following ,",
    "we assume that    * the integral @xmath11 exists ; * all derivatives @xmath15 exist and @xmath16 as @xmath17 .",
    "the truncation error of replacing @xmath18 by @xmath19 is simply the tail integration    @xmath20    for higher accuracy , instead of increasing truncation length at the cost of computing time , we propose to compute the tail integration @xmath21 explicitly by a very economical but effective simplification .",
    "assume @xmath9 approaches zero as @xmath22 and the truncation point @xmath23 can be arbitrarily chosen in a numerical integration .",
    "let @xmath24 , where @xmath25 is some large integer .",
    "dividing integration from @xmath26 to @xmath27 into cycles with an equal length of @xmath28 yields    @xmath29    now assume that @xmath9 is piecewise linear within each @xmath28-cycle , so that each of the integrals @xmath30 in ( 2 ) can be computed exactly . that is , in the range @xmath31 $ ] , we assume that @xmath9 is approximated by    @xmath32    where @xmath33 .",
    "substitute ( 3 ) into ( 2 ) , then analytical integration by parts of each @xmath34 in ( 2 ) gives    @xmath35    this elegant result given by ( 4 ) means that we only need to evaluate the integrand @xmath9 at one single point @xmath36 ( the truncation point ) for the entire tail integration , replacing the truncation error with a much smaller round - off error . as will be demonstrated later , this one - point formula for the potentially demanding tail integration is remarkably effective in reducing the truncation error caused by ignoring @xmath21 .",
    "formula ( 4 ) can be derived more generally through integration by parts , and a recursive deduction gives us higher order correction terms and thus error estimates . integrating ( 1 ) by parts with @xmath37 , we have    @xmath38    where @xmath39 .",
    "if we assume @xmath9 is linear within each @xmath28-cycle in the tail , then the integration @xmath40 vanishes , because within each @xmath28-cycle @xmath41 is constant from the piecewise linear assumption and @xmath42 for any integer @xmath43 , and @xmath44 as @xmath45 .",
    "thus , under the piecewise linear assumption , ( 5 ) and ( 4 ) are identical .",
    "continuing with integration by parts in ( 5 ) and noting @xmath46 at infinity , we further obtain    @xmath47    where @xmath48 .",
    "equation ( 6 ) , as well as ( 5 ) , is exact  no approximation is involved .",
    "the recursive pattern in ( 6 ) is evident .",
    "if we now assume that the second derivative @xmath49 is piecewise linear in each @xmath28-cycle in the tail , then ( 6 ) becomes    @xmath50    with the additional correction term , ( 7 ) is more accurate than ( 4 ) . in general , without making any approximation , from the recursive pattern of ( 6 ) we arrive at the following expression for the tail integral    @xmath51    where @xmath52 , @xmath53 is the 2@xmath43-th order derivative of @xmath9 at the truncation point . as will be shown later with examples , typically the first few terms from ( 8) are sufficiently accurate .",
    "the error in using formula ( 4 ) is readily obtained from ( 8)    @xmath54    in deriving ( 8) , we have assumed all derivatives exist and @xmath55 . under certain conditions ,",
    "the infinite series in ( 8) and ( 9 ) represents the integral asymptotically as @xmath56 , i.e. we have the asymptotic expansion    @xmath57    for example , if we assume that , for some @xmath58 ,    @xmath59    then the integral term on the right - hand side of ( 8) can be bounded by @xmath60 as @xmath61 , for some positive constant @xmath62 , and the series converges to the integral .    the derivatives approaching zero as @xmath22 is a consequence of the existence of integral ( 1 ) . otherwise ,",
    "if @xmath63 , integral ( 1 ) does not exist , which is evident form ( 5 ) . applying this argument recursively ,",
    "all derivatives @xmath64 , if they exist .",
    "obviously if @xmath9 is a power function ( e.g. @xmath65 ) , the ratio @xmath66 is of the order @xmath67 as @xmath22 , so is the ratio @xmath68 .",
    "this implies that , for a power - like function , each error term in ( 9 ) decreases by two orders of magnitude from its preceding term as the index number @xmath43 increases by one .",
    "* remark*. note that there is no truncation error in ( 4 ) and the error is a discretization error in nature . in theory ,",
    "the tail integration error can be estimated by ( 9 ) . in practice , however , derivatives of integrand at the truncation point may only be evaluated numerically .",
    "the assumption of piecewise linearity , although reasonable for @xmath9 at large @xmath69 , may appear to be rather crude for a high precision computation .",
    "however , we recall that we are only trying to reduce the already small truncation error @xmath21 and a reasonable approximation in @xmath70 could lead to significant improvement in the overall accuracy of integration .",
    "for example , suppose a relative error of 1% due to ignoring truncation and 10% error in evaluating the tail integration using the very simple formula ( 4 ) .",
    "the overall accuracy with this tail integration added is now improved from 1% to 0.1% ( 1% times 10% ) .",
    "this improvement by an order of magnitude is achieved by simply evaluating the integrand at the truncation point .",
    "the assumption of a piecewise linearity applies to a broad range of functions , thus the special tail integration approximation can have a wide application .",
    "note , piecewise linear assumption does not even require monotonicity - @xmath9 can be oscillating , as long as its frequency is relatively small compared with the principal cycles in @xmath71 , as demonstrated in one of the examples below .",
    "if the oscillating factor is @xmath72 instead of @xmath71 , we can still derive a one - point formula similar to ( 4 ) by starting the tail integration at @xmath73 instead of @xmath26 . in this case , the tail integration is    @xmath74    also , the tail integration approximation can be applied to the left tail ( integrating from @xmath75 to @xmath76 as well , if such integration is required .",
    "it is known from the literature that truncation is better at extrema of the oscillatory part than at the zeros ( lyness 1986 , espelid and overholt 1994 and sauter 2000 ) .",
    "truncating at @xmath77 , the extrema for @xmath78 , we obtain an expression for the tail integration or the truncation error similar to ( 8)    @xmath79    the leading term of the truncation error is now @xmath80 in ( 11 ) , compared with @xmath81 in ( 8) .",
    "assuming @xmath82 for some large @xmath83 , e.g. when @xmath9 is a power - like function , then it is obvious truncation at extrema has a smaller truncation error .",
    "however , our formula is about the reduction of the truncation error by including an approximation of the tail integration .",
    "if truncation is done at @xmath84 instead of @xmath85 , then the first correction term will be @xmath86 , involving the first derivative of @xmath9 .",
    "in many important applications the first derivative of @xmath9 can not be evaluated accurately .",
    "for example , when inverting a characteristic function of a compound distribution , @xmath9 itself is a semi - infinite integration of an oscillatory function , which could only be obtained numerically .",
    "taking finite difference of a numerically evaluated function will in general reduce the accuracy by an order of magnitude .",
    "so for general purposes the truncation is chosen at the zeros , i.e. at @xmath85 .",
    "of course , if derivative of @xmath9 is in closed form and can be accurately evaluated , truncation and correction at extrema will indeed be more accurate , with a leading error term of @xmath87 .",
    "but we could also include the second derivative term for the truncation at zeros , with a leading error term of @xmath88 , and so on .",
    "in general when higher order derivatives can be computed precisely , then one can include some higher order terms to reduce truncation error further and it does not matter much whether the truncation is done at extrema or at zeros .",
    "the effectiveness of the above tail integration approximation is now demonstrated in a few examples . introduce the following notations    @xmath89    in all the following examples the exact semi - infinite integration @xmath90 is known in closed form , and its truncated counterpart @xmath91 is either known in closed form or can be computed accurately . for simplicity in all the examples @xmath25 is taken to be an even number , i.e @xmath92 .",
    "the exact tail integration @xmath93 can be computed from @xmath94 .",
    "we compare @xmath95 with @xmath91 and compare both of them with the exact semi - infinite integration @xmath90 .",
    "the error reduction can be quantified by comparing the `` magic '' point value given by formula ( 4 ) with the exact tail integration @xmath93 .",
    "also note that the analytic formula for the error of using ( 4 ) , @xmath96 $ ] , is given by ( 9 ) .",
    "* _ example 1 : _ * @xmath97    in this example , the closed form results are    @xmath98    figure 1 compares the `` magic '' point value @xmath99 representing simplified tail integration with the exact tail integration @xmath100 as functions of parameter @xmath101 for @xmath102 , i.e. the truncated lengths @xmath103 .",
    "the figure shows that a simple formula ( 4 ) matches the exact semi - infinite tail integration surprisingly well for the entire range of parameter @xmath104 .",
    "corresponding to figure 1 , the actual errors of using formula ( 4 ) are shown in table 1 , in comparison with the truncation errors without applying the correction term given by ( 4 ) .",
    "figure 2 shows the same comparison at an even shorter truncated length of @xmath105 .",
    "the error of using ( 4 ) is @xmath106 .",
    "if @xmath104 is large , the function @xmath107 is `` short tailed '' and it goes to zero very fast .",
    "the absolute error @xmath108 is very small even at @xmath109 .",
    "the relative error ( against the already very small tail integration ) , given by @xmath110 , is actually large in this case .",
    "but this large relative error in the tail approximation does not affect the high accuracy of the approximation for the whole integration .",
    "what is important is the error of the tail integration relative to the whole integration value . indeed ,",
    "relative to the exact integration , the error of using ( 4 ) is @xmath111 , which is about @xmath112 at @xmath113 .",
    "the condition @xmath114 as @xmath17 is not satisfied in this case if @xmath115",
    ". however , as discussed above , the application of formula ( 4 ) does not cause any problem .    for a small value of parameter @xmath104 , the truncation error will be large unless the truncated length is very long .",
    "for instance , with @xmath116 the truncation error ( if ignore the tail integration ) is more than 70% at @xmath103 ( @xmath102 , as the case in figure 1 ) , and it is more than 88% at @xmath117 ( @xmath113 , as the case in figure 2 ) . on the other hand , if we add the `` magic '' value from formula ( 4 ) to approximate the tail integration , the absolute error of the complete integration @xmath118 due to this approximation is less than 0.01% , and the relative error is @xmath119 at both @xmath103 and @xmath117 . in other words , by including this one - point value , the accuracy of integration has dramatically improved by several orders of magnitude at virtually no extra cost , compared with the truncated integration . for the truncated integration @xmath91 to have similar accuracy as @xmath120 , we need to extend the truncated length from @xmath105 to @xmath121 for this heavy tailed integrand .",
    "* _ example 2 : @xmath122 _ * .",
    "this example has a heavier tail than the previous one . here ,",
    "we have closed form for @xmath90 , but not for @xmath123 or @xmath21 ,    @xmath124    @xmath123 or @xmath21 can be accurately computed by adaptive integration functions available in many numerical packages .",
    "here we used _",
    "imsl _ function based on the modified clenshaw - curtis integration method ( clenshaw and curtis 1960 ; piessens , doncker - kapenga , berhuber and kahaner 1983 ) .",
    "figure 3 compares the `` exact '' tail integration @xmath125 with the one - point value @xmath99 .",
    "again the one - point approximation does an extremely good job . even at the shortest truncation length of just @xmath126 the one - point approximation is very close to the exact semi - infinite tail integration . applying the analytical error formula ( 9 ) to @xmath127 * * , * * we have    @xmath128    taking the first three leading terms we get @xmath129 at @xmath130 and @xmath131 at @xmath132 .",
    "the relative error @xmath133 is about 1% at @xmath134 and it is about 0.002% at @xmath132 . apparently , if the extra correction term @xmath135 is included as in ( 7 ) , the error @xmath136 reduces further by an order of magnitude at @xmath130 and by several orders of magnitude at @xmath132 .",
    "corresponding to figure 3 , the actual errors of using formula ( 4 ) are shown in table 2 , in comparison with the truncation errors without applying the correction term given by ( 4 ) .",
    "figure 4 shows the truncated integration @xmath91 and the truncated integration with the tail modification ( 4 ) added , i.e. @xmath137 , along with the correct value of the full integration @xmath138 .",
    "the contrast between results with and without the one - point tail approximation is striking . at the shortest truncation length of @xmath126 ( @xmath139 , the relative error due to truncation for the truncated integration @xmath140 is more than 30% , but with the tail approximation added , the relative error @xmath141 reduces to 0.5% . at @xmath142 , the largest truncation length shown in figure 4 ,",
    "the relative error due to truncation is still more than 4% , but after the `` magic '' point value is added the relative error reduces to less than @xmath143 .    another interesting way to look at these comparisons , which is relevant for integrating heavy tailed functions , is to consider the required truncation length for the truncated integration to achieve the same accuracy as the one with the `` magic '' value added . for the truncated integration @xmath144 to achieve the same accuracy of @xmath145 ( integration truncated at one - cycle plus the  magic point value ) , we need to extend the integration length to @xmath146 . for @xmath91 to achieve the same accuracy of @xmath147 , the integration length has to be extended to more than @xmath148",
    "! on the other hand , if we add the tail approximation @xmath149 to @xmath150 , the relative error reduces from 0.5% to less than @xmath151 !",
    "this error reduction requires no extra computing , since @xmath149 is simply a number given by @xmath152 .",
    "* _ example 3 : _ * @xmath153**. * *    we have remarked that the piecewise linear assumption does not require monotonicity , i.e. @xmath9 can be oscillating , as long as its frequency is relatively small compared with the principal cycles .",
    "for example , when the function @xmath9 is the characteristic function of a compound distribution , it oscillates with its frequency approaching zero in the long tail . in the current example with @xmath154",
    ", there is a closed form for @xmath155 , but not for @xmath123 or @xmath21 ,    @xmath156    figure 5 compares the `` exact '' tail integration @xmath93 with the one - point approximation @xmath99 for the case @xmath157 .",
    "again the one - point approximation performs surprisingly well , despite @xmath9 itself is now an oscillating function , along with the principal cycles in @xmath71 .",
    "the piecewise linearity assumption is apparently still valid for relatively mild oscillating @xmath9 .",
    "corresponding to figure 5 , the actual errors of using formula ( 4 ) are shown in table 3 , in comparison with the truncation errors without applying the correction term given by ( 4 ) .",
    "not surprisingly , the errors are larger in comparison with those in examples 1 and 2 , due to the fact that @xmath9 now is itself an oscillating function .",
    "still , table 3 shows the truncation error is reduced by an order of magnitude after applying the simple formula ( 4 ) .",
    "figure 6 compares the truncated integration @xmath91 against @xmath158 , along with the correct value of the full integration @xmath159 . at truncation length @xmath160 , the shortest truncation length shown in figures 5 and 6 , the relative error @xmath161 is less than 0.06% and it is less than 0.01% at @xmath162 . in comparison ,",
    "the truncated integration without the end point correction has relative error of 2.7% and 0.2% , respectively for those two truncation lengths . applying the analytical error formula ( 9 ) to @xmath163 and noting @xmath164 and @xmath165 with @xmath157 and @xmath166",
    ", we obtain    @xmath167    where only the first two leading terms corresponding to the 2@xmath168 and 4@xmath169 derivatives are included , leading to @xmath170 at @xmath171 that agrees with the actual error .",
    "similar to the previous example , if we include the extra correction term @xmath135 , the error reduces further by two orders of magnitude at @xmath162 .",
    "the purpose of example 3 is to show that the piecewise linear approximation in the tail could still be valid even if there is a secondary oscillation in @xmath9 , provided its frequency is not as large as the principal oscillator .",
    "if the parameter @xmath172 is larger than one , then we can simply perform a change of variable with @xmath173 and integrate @xmath174 in terms of @xmath175 .",
    "better still , for any value of @xmath172 , we can make use of the equality @xmath176 to get rid of the secondary oscillation altogether before doing numerical integration . in practice",
    ", the secondary oscillation often has a varying frequency with a slowly decaying magnitude , such as in the case of the characteristic function of a compound distribution with a heavy tail . in this case",
    "it might be difficult to effectively apply regular numerical quadratures in the tail integration , but the simple one - point formula ( 4 ) might be very effective .",
    "all these examples show dramatic reduction in truncation errors if tail integration approximation ( 4 ) is employed , with virtually no extra cost .",
    "if the extra correction term @xmath177 is included , i.e. using ( 7 ) instead of ( 4 ) , the error is reduced much further .",
    "we have derived perhaps the simplest but efficient tail integration approximation , first intuitively by piecewise linear approximation , then more generally through integration by parts .",
    "analytical higher - order correction terms and thus error estimates are also derived . the usual truncation error associated with a finite length of the truncated integration domain",
    "can be reduced dramatically by employing the one - point tail integration approximation , at virtually no extra computing cost , so a higher accuracy is achieved with a shorter truncation length .    under certain conditions outlined in the present study , the method can be used in many practical applications . for example , the authors have successfully applied the present method in computing heavy tailed compound distributions through inverting their characteristic functions , where the function @xmath9 itself is a semi - infinite numerical integration ( luo , shevchenko and donnelly 2007 ) .    of course there are more elaborate methods in the literature which are superior to the present simple formula in terms of better accuracy and broader applicability , such as some of the extrapolation methods proposed by wynn 1956 and by sidi 1980 , 1988 .",
    "the merit of the present proposal is its simplicity and effectiveness - a single function evaluation for the integrand at the truncation point is all that is needed to reduce the truncation error , often by orders of magnitude .",
    "it can not be simpler than that .",
    "also , in some applications the function @xmath9 may not even exist in closed form , for instance when @xmath9 is the characteristic function of some compound distributions as mentioned above , then @xmath9 itself is a semi - infinite integration of a highly oscillatory function , which could only be obtained numerically",
    ". in such cases some of the other more sophisticated methods relying on a closed form of @xmath9 may not be readily applicable .",
    "we would like to thank david gates , mark westcott and three anonymous refrees for many constructive comments which have led to significant improvements in the manuscript .                                                  0.5 @@ccc@ @xmath69 & @xmath136 & @xmath179 + @xmath184 & @xmath185 & 0.2241 + @xmath186 & @xmath187 & 0.1422 + @xmath188 & @xmath189 & 0.1006 + @xmath190 & @xmath191 & 0.0637 + @xmath192 & @xmath193 & 0.0318 +      0.5 @@ccc@ @xmath69 & @xmath136 & @xmath179 + @xmath188 & @xmath194 & 0.0105 + @xmath195 & @xmath196 & 0.0053 + @xmath197 & @xmath198 & 0.0035 + @xmath199 & @xmath187 & 0.0026 + @xmath192 & @xmath200 & 0.0021 +             and the truncated integration plus the one - point approximation of tail integration , @xmath95 , as functions of the truncated length @xmath203 , where @xmath204 .",
    "the solid line represents the exact value of the full integration without truncation error , @xmath205 . ]       and the truncated integration plus the one - point approximation of tail integration , @xmath95 , as functions of the truncated length @xmath209 , where @xmath210 , @xmath208 .",
    "the solid line represents the exact value of the full integration without truncation error , @xmath211 . ]"
  ],
  "abstract_text": [
    "<S> integration of the form @xmath0 , where @xmath1 is either @xmath2 or @xmath3 , is widely encountered in many engineering and scientific applications , such as those involving fourier or laplace transforms </S>",
    "<S> . often such integrals are approximated by a numerical integration over a finite domain @xmath4 , leaving a truncation error equal to the tail integration @xmath5 in addition to the discretization error . </S>",
    "<S> this paper describes a very simple , perhaps the simplest , end - point correction to approximate the tail integration , which significantly reduces the truncation error and thus increases the overall accuracy of the numerical integration , with virtually no extra computational effort . </S>",
    "<S> higher order correction terms and error estimates for the end - point correction formula are also derived . </S>",
    "<S> the effectiveness of this one - point correction formula is demonstrated through several examples .    </S>",
    "<S> * keywords : * numerical integration , fourier transform , laplace transform , truncation error . </S>"
  ]
}