{
  "article_text": [
    "all data are created equal but some data are more alike than others .",
    "we propose a method expressing this alikeness , using a new similarity metric based on compression .",
    "this metric does nt use any features or background knowledge , and can without changes be applied to different areas and across area boundaries .",
    "it is robust in the sense that its success appears independent from the type of compressor used .",
    "the clustering we use is hierarchical clustering in dendrograms based on a new fast heuristic for the quartet method .",
    "the method is available as an open - source software tool .",
    "below we explain the method , the theory underpinning it , and present evidence for its universality and robustness by experiments and results in a plethora of different areas using different types of compressors .    * feature - based similarities : * we are presented with unknown data and the question is to determine the similarities among them and group like with like together . commonly , the data are of a certain type : music files , transaction records of atm machines , credit card applications , genomic data . in these data there are hidden relations that we would like to get out in the open .",
    "for example , from genomic data one can extract letter- or block frequencies ( the blocks are over the four - letter alphabet ) ; from music files one can extract various specific numerical features , related to pitch , rhythm , harmony etc .",
    "one can extract such features using for instance fourier transforms  @xcite or wavelet transforms  @xcite .",
    "the feature vectors corresponding to the various files are then classified or clustered using existing classification software , based on various standard statistical pattern recognition classifiers  @xcite , bayesian classifiers  @xcite , hidden markov models  @xcite , ensembles of nearest - neighbor classifiers  @xcite or neural networks  @xcite .",
    "for example , in music one feature would be to look for rhythm in the sense of beats per minute .",
    "one can make a histogram where each histogram bin corresponds to a particular tempo in beats - per - minute and the associated peak shows how frequent and strong that particular periodicity was over the entire piece .",
    "in @xcite we see a gradual change from a few high peaks to many low and spread - out ones going from hip - hip , rock , jazz , to classical .",
    "one can use this similarity type to try to cluster pieces in these categories .",
    "however , such a method requires specific and detailed knowledge of the problem area , since one needs to know what features to look for .    * non - feature similarities : * our aim is to capture , in a single similarity metric , _ every effective metric _ : effective versions of hamming distance , euclidean distance , edit distances , alignment distance , lempel - ziv distance @xcite , and so on .",
    "this metric should be so general that it works in every domain : music , text , literature , programs , genomes , executables , natural language determination , equally and simultaneously",
    ". it would be able to simultaneously detect _ all _ similarities between pieces that other effective metrics can detect .",
    "* compression - based similarity : * such a `` universal '' metric was co - developed by us in @xcite , as a normalized version of the `` information metric '' of @xcite .",
    "roughly speaking , two objects are deemed close if we can significantly `` compress '' one given the information in the other , the idea being that if two pieces are more similar , then we can more succinctly describe one given the other .",
    "the mathematics used is based on kolmogorov complexity theory @xcite . in @xcite",
    "we defined a new class of metrics , taking values in @xmath0 $ ] and appropriate for measuring effective similarity relations between sequences , say one type of similarity per metric , and _ vice versa_. it was shown that an appropriately `` normalized '' information distance minorizes every metric in the class .",
    "it discovers all effective similarities in the sense that if two objects are close according to some effective similarity , then they are also close according to the normalized information distance .",
    "put differently , the normalized information distance represents similarity according to the dominating shared feature between the two objects being compared .",
    "the normalized information distance too is a metric and takes values in @xmath0 $ ] ; hence it may be called _",
    "`` the '' similarity metric_. to apply this ideal precise mathematical theory in real life , we have to replace the use of the noncomputable kolmogorov complexity by an approximation using a standard real - world compressor .",
    "earlier approaches resulted in the first completely automatic construction of the phylogeny tree based on whole mitochondrial genomes , @xcite , a completely automatic construction of a language tree for over 50 euro - asian languages @xcite , detects plagiarism in student programming assignments @xcite , gives phylogeny of chain letters @xcite , and clusters music @xcite .",
    "moreover , the method turns out to be robust under change of the underlying compressor - types : statistical ( ppmz ) , lempel - ziv based dictionary ( gzip ) , block based ( bzip2 ) , or special purpose ( gencompress ) .    *",
    "related work : * in view of the simplicity and naturalness of our proposal , it is perhaps surprising that compression based clustering and classification approaches did not arise before .",
    "but recently there have been several partially independent proposals in that direction : @xcite for building language trees  while citing @xcite  is by essentially more _ ad hoc _ arguments about empirical shannon entropy and kullback - leibler distance .",
    "this approach is used to cluster music midi files by kohonen maps in @xcite .",
    "another recent offshoot based on our work is @xcite hierarchical clustering based on mutual information . in a related , but considerably simpler feature - based approach , one can compare the word frequencies in text files to assess similarity .",
    "in @xcite the word frequencies of words common to a pair of text files are used as entries in two vectors , and the similarity of the two files is based on the distance between those vectors .",
    "the authors attribute authorship to shakespeare plays , the federalist papers , and the chinese classic `` the dream of the red chamber . ''",
    "the approach to similarity distances based on block occurrence statistics is standard in genomics , and in an experiment below it gives inferior phylogeny trees compared to our compression method ( and wrong ones according to current biological wisdom ) .",
    "the possibly new feature in the cited work is that it uses statistics of only the words that the files being compared have in common .",
    "a related , opposite , approach was taken in @xcite , where literary texts are clustered by author gender or fact versus fiction , essentially by first identifying distinguishing features , like gender dependent word usage , and then classifying according to those features .",
    "* outline : * here we propose a first comprehensive theory of real - world compressor - based normalized compression distance , a novel hierarchical clustering heuristic , together with many new applications .",
    "first , we define new mathematical notions of `` similarity metric , '' `` normal compressor , '' and `` normalized compression distance . ''",
    "we then prove the normalized compression distance based on a normal compressor to be a similarity metric .",
    "the normalized compression distance is shown to be quasi - universal in the sense that it minorizes every computable similarity metric up to an additive error term that depends on the quality of the compressor s approximation of the true kolmogorov complexities of the files concerned , and that under certain conditions vanishes with increasing file length .",
    "this means that the ncd captures the dominant similarity over all possible features of the objects compared , up to the stated precision .",
    "next , we present a method of hierarchical clustering based on a novel fast randomized hill - climbing heuristic of a new quartet tree optimization criterion . given a matrix of the pairwise similarity distances between the objects , we score how well the resulting tree represents the information in the distance matrix on a scale of 0 to 1 .",
    "then , as proof of principle , we run the program on three data sets , where we know what the final answer should be : ( i ) reconstruct a tree from a distance matrix obtained from a randomly generated tree ; ( ii ) reconstruct a tree from files containing artificial similarities ; and ( iii ) reconstruct a tree from natural files of vastly different types .",
    "to substantiate our claim of universality , we apply the method to different areas , not using any feature analysis at all .",
    "we first give an example in whole - genome phylogeny using the whole mitochondrial dna of the species concerned .",
    "we compare the hierarchical clustering of our method with a more standard method of two - dimensional clustering ( to show that our dendrogram method of depicting the clusters is more informative ) .",
    "we give a whole - genome phylogeny of fungi and compare this to results using alignment of selected proteins ( alignment being often too costly to perform on the whole - mitochondial genome , but the disadvantage of protein selection being that different selections usually result in different phylogenies  so which is right ? ) .",
    "we identify the virii that are closest to the sequenced sars virus ; we give an example of clustering of language families ; russian authors in the original russian , the same pieces in english translation ( clustering partially follows the translators ) ; clustering of music in midi format ; clustering of handwritten digits used for optical character recognition ; and clustering of radio observations of a mysterious astronomical object , a microquasar of extremely complex variability .",
    "in all these cases the method performs very well in the following sense : the method yields the phylogeny of 24 species precisely according to biological wisdom .",
    "the probability that it randomly would hit this one outcome , or anything reasonably close , is very small . in clustering 36 music pieces taken equally many from pop , jazz , classic , so that 12 - 12 - 12 is the grouping we understand is correct , we can identify convex clusters so that only six errors are made .",
    "( that is , if three items get dislodged then six items get misplaced . )",
    "the probability that this happens by chance is extremely small .",
    "the reason why we think the method does something remarkable is concisely put by laplace @xcite :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ `` if we seek a cause wherever we perceive symmetry , it is not that we regard the symmetrical event as less possible than the others , but , since this event ought to be the effect of a regular cause or that of chance , the first of these suppositions is more probable than the second . on a table",
    "we see letters arranged in this order c o n s t a n t i n o p l e , and we judge that this arrangement is not the result of chance , not because it is less possible than others , for if this word were not employed in any language we would not suspect it came from any particular cause , but this word being in use among us , it is incomparably more probable that some person has thus arranged the aforesaid letters than that this arrangement is due to chance . ''",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    * materials and methods : * the data samples we used were obtained from standard data bases accessible on the world - wide web , generated by ourselves , or obtained from research groups in the field of investigation .",
    "we supply the details with each experiment .",
    "the method of processing the data was the same in all experiments .",
    "first , we preprocessed the data samples to bring them in appropriate format : the genomic material over the four - letter alphabet @xmath1 is recoded in a four - letter alphabet ; the music midi files are stripped of identifying information such as composer and name of the music piece .",
    "then , in all cases the data samples were completely automatically processed by our complearn toolkit , rather than as is usual in phylogeny , by using an ecclectic set of software tools per experiment .",
    "oblivious to the problem area concerned , simply using the distances according to the ncd below , the method described in this paper fully automatically classifies the objects concerned .",
    "the method has been released in the public domain as open - source software at http://complearn.sourceforge.net/ .",
    "the complearn toolkit is a suite of simple utilities that one can use to apply compression techniques to the process of discovering and learning patterns in completely different domains .",
    "in fact , this method is so general that it requires no background knowledge about any particular subject area .",
    "there are no domain - specific parameters to set , and only a handful of general settings .",
    "the complearn toolkit using ncd and not , say , alignment , can cope with full genomes and other large data files and thus comes up with a single distance matrix .",
    "the clustering heuristic generates a tree with a certain confidence , called standardized benefit score or @xmath2 value in the sequel . generating trees from the same distance matrix",
    "many times resulted in the same tree or almost the same tree , for all distance matrices we used , even though the heuristic is randomized .",
    "the differences that arose are apparently due to early or late termination with different @xmath2 values .",
    "this is a great difference with previous phylogeny methods , where because of computational limitations one uses only parts of the genome , or certain proteins that are viewed as significant @xcite .",
    "these are run through a tree reconstruction method like neighbor joining @xcite , maximum likelihood , maximum evolution , maximum parsimony as in @xcite , or quartet hypercleaning @xcite , many times .",
    "the percentage - wise agreement on certain branches arising are called `` bootstrap values . ''",
    "trees are depicted with the best bootstrap values on the branches that are viewed as supporting the theory tested .",
    "different choices of proteins result in different best trees .",
    "one way to avoid this ambiguity is to use the full genome , @xcite , leading to whole - genome phylogeny . with our method",
    "we do whole - genome phylogeny , and end up with a single overall best tree , not optimizing selected parts of it .",
    "the quality of the results depends on ( a ) the ncd distance matrix , and ( b ) how well the hierarchical tree represents the information in the matrix .",
    "the quality of ( b ) is measured by the @xmath2 value , and is given with each experiment .",
    "in general , the @xmath2 value deteriorates for large sets .",
    "we believe this to be partially an artifact of a low - resolution ncd matrix due to limited compression power , and limited file size .",
    "the main reason , however , is the fact that with increasing size of a natural data set the projection of the information in the ncd matrix into a binary tree gets increasingly distorted .",
    "another aspect limiting the quality of the ncd matrix is more subtle .",
    "recall that the method knows nothing about any of the areas we apply it to .",
    "it determines the dominant feature as seen through the ncd filter .",
    "the dominant feature of alikeness between two files may not correspond to our a priori conception but may have an unexpected cause .",
    "the results of our experiments suggest that this is not often the case : in the natural data sets where we have preconceptions of the outcome , for example that works by the same authors should cluster together , or music pieces by the same composers , musical genres , or genomes , the outcomes conform largely to our expectations .",
    "for example , in the music genre experiment the method would fail dramatically if genres were evenly mixed , or mixed with little bias . however , to the contrary , the separation in clusters is almost perfect .",
    "the few misplacements that are discernable are either errors ( the method was not powerful enough to discern the dominant feature ) , or the dominant feature between a pair of music pieces is not the genre but some other aspect .",
    "the surprising news is that we can generally confirm expectations with few misplacements , indeed , that the data do nt contain unknown rogue features that dominate to cause spurious ( in our preconceived idea ) clustering .",
    "this gives evidence that where the preconception is in doubt , like with phylogeny hypotheses , the clustering can give true support of one hypothesis against another one .",
    "* figures : * we use two styles to display the hierarchical clusters . in the case of genomics of eutherian orders and fungi , language trees ,",
    "it is convenient to follow the dendrograms that are customary in that area ( suggesting temporal evolution ) for easy comparison with the literature .",
    "although there is no temporal relation intended , the dendrogram representation looked also appropriate for the russian writers , and translations of russian writers .",
    "in the other experiments ( even the genomic sars experiment ) it is more informative to display an unrooted ternary tree ( or binary tree if we think about incoming and outgoing edges ) with explicit internal nodes .",
    "this facilitates identification of clusters in terms of subtrees rooted at internal nodes or contiguous sets of subtrees rooted at branches of internal nodes .",
    "in mathematics , different distances arise in all sorts of contexts , and one usually requires these to be a `` metric '' .",
    "we give a precise formal meaning to the loose distance notion of `` degree of similarity '' used in the pattern recognition literature .    *",
    "metric : * let @xmath3 be a nonempty set and @xmath4 be the set of nonnegative real numbers .",
    "metric _ on @xmath3 is a function @xmath5 satisfying the metric ( in)equalities :    * @xmath6 iff @xmath7 , * @xmath8 ( symmetry ) , and * @xmath9 ( triangle inequality ) .    the value @xmath10 is called the _ distance _ between @xmath11 .",
    "a familiar example of a metric is the euclidean metric , the everyday distance @xmath12 between two objects @xmath13 expressed in , say , meters .",
    "clearly , this distance satisfies the properties @xmath14 , @xmath15 , and @xmath16 ( for instance , @xmath17 amsterdam , @xmath18 brussels , and @xmath19 chicago . )",
    "we are interested in `` similarity metrics '' .",
    "for example , if the objects are classical music pieces then the function @xmath20 if @xmath21 and @xmath22 are by the same composer and @xmath23 otherwise , is a similarity metric .",
    "this metric captures only one similarity aspect ( feature ) of music pieces , presumably an important one because it subsumes a conglomerate of more elementary features .",
    "* density : * in defining a class of acceptable metrics we want to exclude unrealistic metrics like @xmath24 for _ every _ pair @xmath25 .",
    "we do this by restricting the number of objects within a given distance of an object . as in @xcite we do this by only considering effective distances , as follows .",
    "fix a suitable , and for the remainder of the paper , fixed , programming language .",
    "this is the _ reference programming _ language .",
    "[ def.em ] let @xmath26 , with @xmath27 a finite nonempty alphabet and @xmath28 the set of finite strings over that alphabet .",
    "note that for us `` files '' in computer memory are finite binary strings .",
    "a function @xmath5 is an _ acceptable metric _ if for every pair of objects @xmath11 the distance @xmath10 is the length of a binary prefix code - word that is a program that computes @xmath29 from @xmath30 , and vice versa , in the reference programming language , and the metric ( in)equalities hold up to @xmath31 where @xmath32 is the maximal binary length of an element of @xmath3 involved in the ( in)equality concerned .",
    "[ ex.ham ] in representing the hamming distance @xmath33 between @xmath29 and @xmath30 strings of equal length @xmath32 differing in positions @xmath34 , we can use a simple prefix - free encoding of @xmath35 in @xmath36 bits .",
    "we encode @xmath32 and @xmath33 prefix - free in @xmath37 bits each , see e.g. @xcite , and then the literal indexes of the actual flipped - bit positions .",
    "hence , @xmath38 is the length of a prefix code word ( prefix program ) to compute @xmath29 from @xmath30 and _ vice versa_. then , by the kraft inequality , see @xcite , @xmath39    it is easy to verify that @xmath40 is a metric in the sense that it satisfies the metric ( in)equalities up to @xmath31 additive precision .",
    "* normalization : * large objects ( in the sense of long strings ) that differ by a tiny part are intuitively closer than tiny objects that differ by the same amount .",
    "for example , two whole mitochondrial genomes of 18,000 bases that differ by 9,000 are very different , while two whole nuclear genomes of @xmath41 bases that differ by only 9,000 bases are very similar .",
    "thus , absolute difference between two objects does nt govern similarity , but relative difference appears to do so .    a _ compressor _ is a lossless encoder mapping @xmath28 into @xmath42 such that the resulting code is a prefix code . for convenience of notation",
    "we identify `` compressor '' with a `` code word length function '' @xmath43 , where @xmath44 is the set of nonnegative integers . the compressed version of a file @xmath29 is denoted by @xmath45 and its length is @xmath46 .",
    "we only consider compressors such that @xmath47 .    since the compressor is a lossless encoder , if @xmath48 then @xmath49 . in the following we fix a compressor @xmath50 , at this stage it does nt matter which one .",
    "we call the fixed compressor the _ reference compressor_.    [ eq.defsm ] a _ normalized metric _ or _ similarity metric _ , relative to a reference compressor @xmath50 , is a function @xmath51 $ ] that for every constant @xmath52 $ ] satisfies the density constraint @xmath53 and satisfies the metric ( in)equalities up to additive precision @xmath54 where @xmath32 is the maximal binary length of an element of @xmath3 involved in the ( in)equality concerned .",
    "this requirement follows from a `` normalized '' version of the kraft inequality :    [ lem.ki ] let @xmath51 $ ] satisfy @xmath55 then , @xmath33 satisfies .    for suppose the contrary :",
    "there is an @xmath52 $ ] , such that is false .",
    "then , starting from ( [ eq.nc ] ) we obtain a contradiction : @xmath56    we call a normalized metric a `` similarity '' metric , because it gives a relative similarity according to the metric distance ( with distance 0 when objects are maximally similar and distance 1 when the are maximally dissimilar ) and , conversely , for every well - defined computable notion of similarity we can express it as a metric distance according to our definition . in the literature a distance that expresses lack of similarity ( like ours ) is often called a `` dissimilarity '' distance or a `` disparity '' distance .    as far as the authors know ,",
    "the idea of normalized metric is , surprisingly , not well - studied .",
    "an exception is @xcite , which investigates normalized metrics to account for relative distances rather than absolute ones , and it does so for much the same reasons as in the present work .",
    "an example there is the normalized euclidean metric @xmath57 , where @xmath58 ( @xmath59 denotes the real numbers ) and @xmath60 is the euclidean metric  the @xmath61 norm .",
    "another example is a normalized symmetric - set - difference metric .",
    "but these normalized metrics are not necessarily effective in that the distance between two objects gives the length of an effective description to go from either object to the other one .",
    "the prefix - code for the hamming distance @xmath38 between @xmath62 in example  [ ex.ham ] is a program to compute from @xmath29 to @xmath30 and _ vice versa_. it is metric up to @xmath31 additive precision . to turn it into a similarity metric define @xmath63 , where @xmath64 .",
    "trivially , @xmath65 .",
    "the metric properties of @xmath38 that held up to additive precision @xmath31 are preserved under division by @xmath66 with the precision improved to @xmath67 . since @xmath68",
    "we have @xmath69 .",
    "then , @xmath70 , where the last inequality is the kraft inequality since @xmath71 is a prefix code word length .",
    "hence @xmath72 satisfies and therefore by lemma  [ lem.ki ] .",
    "in @xcite the conditions and definitions on a similarity metric are the particular instance where the compressor @xmath50 is instantiated as the ultimate compressor @xmath73 such that @xmath74 is the kolmogorov complexity @xcite of @xmath29 . in @xcite",
    ", it is shown that one can represent the entire wide class of the similarity metrics ( the class based on the ultimate compressor @xmath73 ) by a single representative : the `` normalized information distance '' is a metric , and it is universal in the sense that this single metric uncovers all similarities simultaneously that the various metrics in the class uncover separately .",
    "this should be understood in the sense that if two files ( of whatever type ) are similar ( that is , close ) according to the particular feature described by a particular metric , then they are also similar ( that is , close ) in the sense of the normalized information metric .",
    "this justifies calling the latter _ the _ similarity metric .",
    "however , this metric is based on the notion of kolmogorov complexity .",
    "the kolmogorov complexity of a file is essentially the length of the ultimate compressed version of the file .",
    "unfortunately , the kolmogorov complexity of a file is non - computable in the turing sense . in applying the approach",
    ", we have to make do with an approximation based on a far less powerful real - world reference compressor @xmath50 .",
    "the resulting applied approximation of the `` normalized information distance '' is called the _ normalized compression distance ( ncd ) _ and is defined by @xmath75 here , @xmath76 denotes the compressed size of the concatenation of @xmath29 and @xmath30 , @xmath71 denotes the compressed size of @xmath29 , and @xmath77 denotes the compressed size of @xmath30 .",
    "the ncd is a non - negative number @xmath78 representing how different the two files are .",
    "smaller numbers represent more similar files .",
    "the @xmath79 in the upper bound is due to imperfections in our compression techniques , but for most standard compression algorithms one is unlikely to see an @xmath79 above 0.1 ( in our experiments gzip and bzip2 achieved ncd s above 1 , but ppmz always had ncd at most 1 ) .",
    "[ rem.compensate ] technically , the _ kolmogorov complexity _ of @xmath29 given @xmath30 is the length of the shortest binary program that on input @xmath30 outputs @xmath29 ; it is denoted as @xmath80 . for precise definitions , theory and applications ,",
    "see @xcite .",
    "the kolmogorov complexity of @xmath29 is the length of the shortest binary program with no input that outputs @xmath29 ; it is denoted as @xmath81 where @xmath79 denotes the empty input .",
    "the similarity metric in @xcite is @xmath82 .",
    "approximation of the denominator by a given compressor is straightforward by @xmath83 .",
    "the numerator is more tricky .",
    "it can be written as @xmath84 within logarithmic additive precision by the additive property of kolmogorov complexity @xcite .",
    "the term @xmath85 represents the length of the shortest program for the pair @xmath86 . in compression practice",
    "it is easier to deal with the concatenation @xmath87 or @xmath88 .",
    "again , within logarithmic precision @xmath89 .",
    "but we have to deal with a real - life compressor here , for which @xmath76 may be different from @xmath90 .",
    "clearly , however , the smaller of the two will be the closest approximation to @xmath85 .",
    "therefore , following a suggestion by steven de rooij , one can approximate best by @xmath91 . here , and in the complearn toolkit , however , we simply use @xmath76 rather than @xmath92 .",
    "this is justified by the observation that block - coding based compressors are symmetric almost by definition , and experiments with various stream - based compressors ( gzip , ppmz ) show only small deviations from symmetry . in our definition of a `` normal '' compressor below we put symmetry as one of the basic properties .",
    "the theory as developed for the kolmogorov - complexity based `` normalized information distance '' in @xcite does not hold directly for the ( possibly poorly ) approximating ncd .",
    "below , we develop the theory of ncd based on the notion of a `` normal compressor , '' and show that the ncd is a ( quasi- ) universal similarity metric relative to a normal reference compressor @xmath50 .",
    "the theory developed in @xcite is the boundary case @xmath93 , where the `` quasi - universality '' below has become full `` universality '' .",
    "the properties of the ncd defined below depend on the details of the compressor used .",
    "however , under mild and natural assumptions on the compressor one can show the ncd is a ( quasi-)universal similarity metric .",
    "a compressor @xmath50 is _ normal _ if it satisfies , up to an additive @xmath31 term , with @xmath32 the maximal binary length of an element of @xmath3 involved in the ( in)equality concerned , the following :    1 .",
    "_ idempotency _ : @xmath94 .",
    "_ monotonicity _ : @xmath95 .",
    "symmetry _ : @xmath96 .",
    "_ distributivity _ : @xmath97 .",
    "* idempotency : * a reasonable compressor will see exact repetitions and obey idempotency up to the required precision .",
    "* monotonicity : * a real compressor must have the monotonicity property , at least up to the required precision .",
    "the property is evident for stream - based compressors , and only slightly less evident for block - coding compressors .",
    "* symmetry : * stream - based compressors of the lempel - ziv family , like gzip and pkzip , and the predictive ppm family , like ppmz , are possibly not precisely symmetric .",
    "this is related to the stream - based property : the initial file @xmath29 may have regularities to which the compressor adapts ; after crossing the border to @xmath30 it must unlearn those regularities and adapt to the ones of @xmath29 .",
    "this process may cause some imprecision in symmetry that vanishes asymptotically with the length of @xmath98 .",
    "a compressor must be poor indeed ( and will certainly not be used to any extent ) if it does nt satisfy symmetry up to the required precision . apart from stream - based , the other major family of compressors is block - coding based , like bzip2 .",
    "they essentially analyze the full input block by considering all rotations in obtaining the compressed version .",
    "it is to a great extent symmetrical , and real experiments show no departure from symmetry .    * distributivity : * the distributivity property is not immediately intuitive . in kolmogorov complexity theory",
    "the stronger distributivity property @xmath99 holds ( with @xmath100 ) .",
    "however , to prove the desired properties of ncd below , only the weaker distributivity property @xmath101 above is required , also for the boundary case were @xmath93 . in practice ,",
    "real - world compressors appear to satisfy this weaker distributivity property up to the required precision .",
    "define @xmath102 this number @xmath103 of bits of information in @xmath30 , relative to @xmath29 , can be viewed as the excess number of bits in @xmath104 compared to @xmath45 , and is called the amount of _ conditional compressed information_.    in the definition of compressor the decompression algorithm is not included ( unlike the case of kolmorogov complexity , where the decompressing algorithm is given by definition ) , but it is easy to construct one : given the file @xmath45 in @xmath71 bits , we can run the compressor on all candidate strings @xmath105for example , in length - increasing lexicographical order , until we find the compressed string @xmath106 .",
    "since this string decompresses to @xmath29 we have found @xmath107 .",
    "given the file @xmath104 in @xmath76 bits we repeat this process using strings @xmath108 until we find @xmath109 .",
    "since this string decompresses to @xmath87 , we have found @xmath110 . by the unique decompression property",
    "we find that @xmath103 is the extra number of bits we require to describe @xmath30 apart from describing @xmath29 .",
    "it is intuitively acceptable that the conditional compressed information @xmath111 satisfies the triangle inequality @xmath112    both and imply .",
    "( implies :) by monotonicity .",
    "( implies :) rewrite the terms in according to , cancel @xmath77 in the left- and right - hand sides , use symmetry , and rearrange .",
    "a normal compressor satisfies additionally _ subadditivity _ : @xmath113 .",
    "consider the special case of distributivity with @xmath105 the empty word so that @xmath114 , @xmath115 , and @xmath116 .",
    "* subadditivity : * the subadditivity property is clearly also required for every viable compressor , since a compressor may use information acquired from @xmath29 to compress @xmath30 .",
    "minor imprecision may arise from the unlearning effect of crossing the border between @xmath29 and @xmath30 , mentioned in relation to symmetry , but again this must vanish asymptotically with increasing length of @xmath98 .",
    "there is a natural interpretation to @xmath117 : if , say , @xmath118 then we can rewrite @xmath119 that is , the distance @xmath117 between @xmath29 and @xmath30 is the improvement due to compressing @xmath30 using @xmath29 as previously compressed `` data base , '' and compressing @xmath30 from scratch , expressed as the ratio between the bit - wise length of the two compressed versions .",
    "relative to the reference compressor we can define the information in @xmath29 about @xmath30 as @xmath120 .",
    "then , @xmath121 that is , the ncd between @xmath29 and @xmath30 is 1 minus the ratio of the information @xmath29 about @xmath30 and the information in @xmath30 .",
    "if the compressor is normal , then the ncd is a similarity metric .",
    "( _ metricity : _ ) we first show that the ncd satisfies the three metric ( in)equalities up to @xmath54 additive precision , where @xmath32 is the maximal binary length of an opject involved in the ( in)equality concerned .",
    "\\(i ) by idempotency we have @xmath122 . by monotonicity",
    "we have @xmath123 for every @xmath98 .",
    "\\(ii ) @xmath124 .",
    "the ncd is unchanged by interchanging @xmath29 and @xmath30 in .",
    "\\(iii ) the difficult property is the triangle inequality . without loss of generality",
    "we assume @xmath125 .",
    "since the ncd is symmetrical , there are only three triangle inequalities that can be expressed by @xmath126 .",
    "we verify them in turn :    _ proof of _ @xmath127 : by distributivity , the compressor itself satisfies @xmath128 . subtracting @xmath71 from both sides and rewriting , @xmath129 . dividing by @xmath77 on both sides we find @xmath130 the left - hand side is @xmath131 .",
    "_ case a : _ assume the right - hand side is @xmath131 .",
    "setting @xmath132 , and adding @xmath133 to both the numerator and denominator of the right - hand side , it can only increase and draw closer to 1 .",
    "therefore , @xmath134 which was what we had to prove .",
    "_ case b : _ assume the right - hand side is @xmath135 .",
    "we proceed like in case 2.1 , and add @xmath133 to both numerator and denominator .",
    "although now the right - hand side decreases , it must still be greater than 1 , and therefore the right - hand side remains at least as large as the left - hand side .",
    "_ proof of _ @xmath136 : by distributivity we have @xmath137 . adding @xmath71 to both sides , and dividing both sides by @xmath138 we obtain @xmath139",
    "the right - hand side does nt decrease when we substitute @xmath77 for the denominator @xmath138 of the first term , since @xmath140 .",
    "therefore , the inequality stays valid under this substitution , which was what we had to prove .",
    "_ proof of _ @xmath141 : by distributivity we have @xmath142 . adding @xmath77 to both sides , and dividing both sides by @xmath138 we obtain @xmath143",
    "the right - hand side does nt decrease when we substitute @xmath77 for the denominator @xmath138 of the first term , since @xmath140 .",
    "therefore , the inequality stays valid under this substitution , which was what we had to prove .",
    "( _ range : _ ) we next verify the range of the ncd : the @xmath117 is always in between 0 and 1 , up to an additive @xmath54 term with @xmath32 the maximum binary length of @xmath98 .",
    "( _ density : _ ) it remains to show that the ncd satisfies .",
    "since @xmath144 , the set condition @xmath145 can be rewritten ( using symmetry ) as @xmath146 .",
    "using @xmath144 again , we also have @xmath147 .",
    "together , @xmath148 suppose that for some @xmath149 there are @xmath150 distinct @xmath87 satisfying .",
    "since there are at most @xmath151 programs to encode the concatenations @xmath87 , by the pigeon hole principle , two distinct ones share the same code word .",
    "this contradicts the unique decompression property .    *",
    "quasi - universality : * we now digress to the theory developed in @xcite , which formed the motivation for developing the ncd . if , instead of the result of some real compressor , we substitute the kolmogorov complexity for the lengths of the compressed files in the ncd formula , the result is a similarity metric .",
    "let us call it the _ kolmogorov metric_. it is universal in the following sense : every metric expressing similarity according to some feature , that can be computed from the objects concerned , is comprised ( in the sense of minorized ) by the universal metric . note that every feature of the data gives rise to a similarity , and , conversely , every similarity can be thought of as expressing some feature : being similar in that sense .",
    "our actual practice in using the ncd falls short of this ideal theory in at least three respects :    \\(i ) the claimed universality of the kolmogorov metric holds only for indefinitely long sequences @xmath98 .",
    "once we consider strings @xmath98 of definite length @xmath32 , the kolmogorov metric is only universal with respect to `` simple '' computable normalized information distances , where `` simple '' means that they are computable by programs of length , say , logarithmic in @xmath32 .",
    "this reflects the fact that , technically speaking , the universality is achieved by summing the weighted contribution of all similarity metrics in the class considered with respect to the objects considered .",
    "only similarity metrics of which the complexity is small ( which means that the weight is large ) with respect to the size of the data concerned kick in .",
    "\\(ii ) the kolmogorov complexity is not computable , and it is in principle impossible to compute how far off the ncd is from the kolmogorov metric .",
    "so we can not in general know how well we are doing using the ncd .",
    "\\(iii ) to approximate the ncd we use standard compression programs like gzip , ppmz , and bzip2 .",
    "while better compression of a string will always approximate the kolmogorov complexity better , this may not be true for the ncd .",
    "due to its arithmetic form , subtraction and division , it is theoretically possible that while all items in the formula get better compressed , the improvement is not the same for all items , and the ncd value moves away from the asymptotic value . in our experiments",
    "we have not observed this behavior in a noticable fashion .",
    "formally , we can state the following :    let @xmath33 be a computable similarity metric . given a constant @xmath152 , let objects @xmath98 be such that @xmath153 .",
    "then , @xmath154 where @xmath155 .",
    "fix @xmath156 in the statement of the theorem . without loss of generality",
    "we assume @xmath157 and @xmath158 . by , there are @xmath159 many @xmath160 pairs , such that @xmath161 and @xmath162",
    ". since both @xmath50 and @xmath33 are computable functions , we can compute and enumerate all these pairs @xmath160 .",
    "the initially fixed pair @xmath86 is an element in the list and its index takes @xmath163 bits .",
    "it can be described by at most @xmath164 bits ",
    "its index in the list and an @xmath165 term accounting for the lengths of the programs involved in reconstructing @xmath86 given its index in the list , including algorithms to compute functions @xmath33 and @xmath50 .",
    "since the kolmogorov complexity gives the length of the shortest effective description , we have @xmath166 .",
    "then , @xmath167    so the ncd is _ quasi - universal _ in the sense that if for objects @xmath98 the compression complexity @xmath76 approximates the kolmogorov complexity @xmath168 up to much closer precision than @xmath71 , then the @xmath117 minorizes the metric @xmath169 up to a vanishing term .",
    "more precisely , the error term @xmath170 for a sequence of pairs @xmath98 with @xmath144 , @xmath153 and @xmath171",
    ".    clustering according to ncd will group sequences together that are similar according to features that are not explicitly known to us .",
    "analysis of what the compressor actually does , still may not tell us which features that make sense to us can be expressed by conglomerates of features analyzed by the compressor .",
    "this can be exploited to track down unknown features implicitly : forming automatically clusters of data and see in which cluster ( if any ) a new candidate is placed .",
    "another aspect that can be exploited is exploratory : given that the ncd is small for a pair @xmath98 of specific sequences , what does this really say about the sense in which these two sequences are similar ?",
    "the above analysis suggests that close similarity will be due to a dominating feature ( that perhaps expresses a conglomerate of subfeatures ) . looking into these deeper causes",
    "may give feedback about the appropriateness of the realized ncd distances and may help extract more intrinsic information about subject matter than the oblivious division into clusters by looking for the common features in the data clusters .",
    "given a set of objects , the pairwise ncd s form the entries of a distance matrix .",
    "this distance matrix contains the pairwise relations in raw form .",
    "but in this format that information is not easily usable . just as the distance matrix is a reduced form of information representing the original data set , we now need to reduce the information even further in order to achieve a cognitively acceptable format like data clusters . to extract a hierarchy of clusters from the distance matrix , we determine a dendrogram ( binary tree ) that agrees with the distance matrix according to a cost measure .",
    "this allows us to extract more information from the data than just flat clustering ( determining disjoint clusters in dimensional representation ) .",
    "clusters are groups of objects that are similar according to our metric .",
    "there are various ways to cluster .",
    "our aim is to analyze data sets for which the number of clusters is not known a priori , and the data are not labeled . as stated in @xcite , conceptually simple , hierarchical clustering is among the best known unsupervised methods in this setting , and the most natural way is to represent the relations in the form of a dendrogram , which is customarily a directed binary tree or undirected ternary tree . to construct the tree from a distance matrix with entries consisting of the pairwise distances between objects ,",
    "we use a quartet method .",
    "this is a matter of choice only , other methods may work equally well .",
    "the distances we compute in our experiments are often within the range 0.85 to 1.2 .",
    "that is , the distinguishing features are small , and we need a sensitive method to extract as much information contained in the distance matrix as is possible .",
    "for example , our experiments showed that reconstructing a minimum spanning tree is not sensitive enough and gives poor results . with increasing number of data items ,",
    "the projection of the ncd matrix information into the tree representation format gets increasingly distorted .",
    "a similar situation arises in using alignment cost in genomic comparisons .",
    "experience shows that in both cases the hierarchical clustering methods seem to work best for small sets of data , up to 25 items , and to deteriorate for larger sets , say 40 items or more .",
    "a standard solution to hierarchically cluster larger sets of data is to first cluster nonhierarchically , by say multidimensional scaling of @xmath172-means , available in standard packages , for instance _ matlab _ , and then apply hierarchical clustering on the emerging clusters .    * the quartet method : * we consider every group of four elements from our set of @xmath32 elements ; there are @xmath173 such groups . from each group",
    "@xmath174 we construct a tree of arity 3 , which implies that the tree consists of two subtrees of two leaves each .",
    "let us call such a tree a _",
    "quartet topology_. there are three possibilities denoted ( i ) @xmath175 , ( ii ) @xmath176 , and ( iii ) @xmath177 , where a vertical bar divides the two pairs of leaf nodes into two disjoint subtrees ( figure  [ figquart ] ) .    for any",
    "given tree @xmath178 and any group of four leaf labels @xmath174 , we say @xmath178 is @xmath179 with @xmath175 if and only if the path from @xmath180 to @xmath181 does not cross the path from @xmath182 to @xmath29 .",
    "note that exactly one of the three possible quartet topologies for any set of 4 labels must be consistent for any given tree .",
    "we may think of a large tree having many smaller quartet topolgies embedded within its structure .",
    "commonly the goal in the quartet method is to find ( or approximate as closely as possible ) the tree that embeds the maximal number of consistent ( possibly weighted ) quartet topologies from a given set @xmath183 of quartet topologies",
    "@xcite ( figure  [ figquartex ] ) .",
    "this is called the ( weighted ) _ maximum quartet consistency ( mqc ) _ problem .",
    "we propose a new optimization problem : the _ minimum quartet tree cost ( mqtc ) _ , as follows : the cost of a quartet topology is defined as the sum of the distances between each pair of neighbors ; that is , @xmath184 .",
    "the total cost @xmath185 of a tree @xmath178 with a set @xmath186 of leaves ( external nodes of degree 1 ) is defined as @xmath187 is consistent with @xmath188the sum of the costs of all its consistent quartet topologies .",
    "first , we generate a list of all possible quartet topolgies for all four - tuples of labels under consideration . for each group of three possible quartet topologies for a given set of four labels @xmath174 ,",
    "calculate a best ( minimal ) cost @xmath189 , and a worst ( maximal ) cost @xmath190 . summing all best quartet toplogies",
    "yields the best ( minimal ) cost @xmath191 .",
    "conversely , summing all worst quartet toplogies yields the worst ( maximal ) cost @xmath192 . for some distance matrices , these minimal and maximal values",
    "can not be attained by actual trees ; however , the score @xmath185 of every tree @xmath178 will lie between these two values . in order to be able to compare tree scores in a more uniform way",
    ", we now rescale the score linearly such that the worst score maps to 0 , and the best score maps to 1 , and term this the _ normalized tree benefit score _ @xmath193 .",
    "our goal is to find a full tree with a maximum value of @xmath2 , which is to say , the lowest total cost .    to express the notion of computational difficulty",
    "one uses the notion of `` nondeterministic polynomial time ( np ) '' .",
    "if a problem concerning @xmath32 objects is np - hard this means that the best known algorithm for this ( and a wide class of significant problems ) requires computation time exponential in @xmath32 .",
    "that is , it is infeasible in practice .",
    "the _ mqc decision problem _ is the following : given @xmath32 objects , let @xmath178 be a tree of which the @xmath32 leaves are labeled by the objects , and let @xmath194 be the set of quartet topologies embedded in @xmath178 . given a set of quartet topologies @xmath183 , and an integer @xmath172 , the problem is to decide whether there is a binary tree @xmath178 such that @xmath195 . in @xcite",
    "it is shown that the mqc decision problem is np - hard .",
    "for every mqc decision problem one can define an mqtc problem that has the same solution : give the quartet topologies in @xmath183 cost 0 and the other ones cost 1 . this way the mqc decision problem can be reduced to the mqtc decision problem , which shows also the latter to be np - hard .",
    "hence , it is infeasible in practice , but we can sometimes solve it , and always approximate it .",
    "( the reduction also shows that the quartet problems reviewed in @xcite , are subsumed by our problem . )",
    "adapting current methods in @xcite to our mqtc optimization problem , results in far too computationally intensive calculations ; they run many months or years on moderate - sized problems of 30 objects .",
    "therefore , we have designed a simple , feasible , heuristic method for our problem based on randomization and hill - climbing .",
    "first , a random tree with @xmath196 nodes is created , consisting of @xmath32 leaf nodes ( with 1 connecting edge ) labeled with the names of the data items , and @xmath197 non - leaf or _",
    "internal _ nodes labeled with the lowercase letter `` n '' followed by a unique integer identifier .",
    "each internal node has exactly three connecting edges . for this tree @xmath178",
    ", we calculate the total cost of all embedded quartet toplogies , and invert and scale this value to find @xmath2 .",
    "a tree is consistent with precisely @xmath198 of all quartet topologies , one for every quartet",
    ". a random tree may be consistent with about @xmath198 of the best quartet topologies  but because of dependencies this figure is not precise .",
    "the initial random this tree is chosen as the currently best known tree , and is used as the basis for further searching .",
    "we define a simple mutation on a tree as one of the three possible transformations :    1 .   a _ leaf swap _ , which consists of randomly choosing two leaf nodes and swapping them .",
    "2 .   a _ subtree swap _ , which consists of randomly choosing two internal nodes and swapping the subtrees rooted at those nodes .",
    "a _ subtree transfer _ , whereby a randomly chosen subtree ( possibly a leaf ) is detached and reattached in another place , maintaining arity invariants .",
    "each of these simple mutations keeps the number of leaf nodes and internal nodes in the tree invariant ; only the structure and placements change .",
    "define a full mutation as a sequence of at least one but potentially many simple mutations , picked according to the following distribution .",
    "first we pick the number @xmath172 of simple mutations that we will perform with probability @xmath199 . for each such simple mutation , we choose one of the three types listed above with equal probability .",
    "finally , for each of these simple mutations , we pick leaves or internal nodes , as necessary .",
    "notice that trees which are close to the original tree ( in terms of number of simple mutation steps in between ) are examined often , while trees that are far away from the original tree will eventually be examined , but not very frequently . in order to search for a better tree",
    ", we simply apply a full mutation on @xmath178 to arrive at @xmath200 , and then calculate @xmath201 .",
    "if @xmath202 , then keep @xmath200 as the new best tree . otherwise , try a new different tree and repeat .",
    "if @xmath201 ever reaches @xmath203 , then halt , outputting the best tree .",
    "otherwise , run until it seems no better trees are being found in a reasonable amount of time , in which case the approximation is complete .",
    "note that if a tree is ever found such that @xmath204 , then we can stop because we can be certain that this tree is optimal , as no tree could have a lower cost .",
    "in fact , this perfect tree result is achieved in our artificial tree reconstruction experiment ( section  [ sect.artificial ] ) reliably in a few minutes . for real - world data",
    ", @xmath2 reaches a maximum somewhat less than @xmath203 , presumably reflecting distortion of the information in the distance matrix data by the best possible tree representation , as noted above , or indicating getting stuck in a local optimum or a search space too large to find the global optimum . on many typical problems of up to 40 objects",
    "this tree - search gives a tree with @xmath205 within half an hour .",
    "for large numbers of objects , tree scoring itself can be slow ( as this takes order @xmath206 computation steps ) , and the space of trees is also large , so the algorithm may slow down substantially . for larger experiments",
    ", we use a c++/ruby implementation with mpi ( message passing interface , a common standard used on massively parallel computers ) on a cluster of workstations in parallel to find trees more rapidly .",
    "we can consider the graph mapping the achieved @xmath2 score as a function of the number of trees examined .",
    "progress occurs typically in a sigmoidal fashion towards a maximal value @xmath131 , figure  [ figprogress ] .      with the natural data sets we use",
    ", one may have the preconception ( or prejudice ) that , say , music by bach should be clustered together , music by chopin should be clustered together , and so should music by rock stars .",
    "however , the preprocessed music files of a piece by bach and a piece by chopin , or the beatles , may resemble one another more than two different pieces by bach  by accident or indeed by design and copying .",
    "thus , natural data sets may have ambiguous , conflicting , or counterintuitive outcomes . in other words ,",
    "the experiments on natural data sets have the drawback of not having an objective clear `` correct '' answer that can function as a benchmark for assessing our experimental outcomes , but only intuitive or traditional preconceptions .",
    "we discuss three experiments that show that our program indeed does what it is supposed to do ",
    "at least in artificial situations where we know in advance what the correct answer is .",
    "the similarity machine consists of two parts : ( i ) extracting a distance matrix from the data , and ( ii ) constructing a tree from the distance matrix using our novel quartet - based heuristic .    *",
    "testing the quartet - based tree construction : * we first test whether the quartet - based tree construction heuristic is trustworthy : we generated a ternary tree @xmath178 with 18 leaves , using the pseudo - random number generator `` rand '' of the ruby programming language , and derived a metric from it by defining the distance between two nodes as follows : given the length of the path from @xmath21 to @xmath22 , in an integer number of edges , as @xmath207 , let @xmath208 except when @xmath209 , in which case @xmath210 .",
    "it is easy to verify that this simple formula always gives a number between 0 and 1 , and is monotonic with path length .",
    "given only the @xmath211 matrix of these normalized distances , our quartet method exactly reconstructed the original tree @xmath178 represented in figure  [ figarttreereal ] , with @xmath212 .    * testing the similarity machine on artificial data : * given that the tree reconstruction method is accurate on clean consistent data , we tried whether the full procedure works in an acceptable manner when we know what the outcome should be like .",
    "we used the `` rand '' pseudo - random number generator from the c programming language standard library under linux .",
    "we randomly generated 11 separate 1-kilobyte blocks of data where each byte was equally probable and called these _",
    "tags_. each tag was associated with a different lowercase letter of the alphabet .",
    "next , we generated 22 files of 80 kilobyte each , by starting with a block of purely random bytes and applying one , two , three , or four different tags on it . applying a tag consists of ten repetitions of picking a random location in the 80-kilobyte file , and overwriting that location with the globally consistent tag that is indicated .",
    "so , for instance , to create the file referred to in the diagram by `` a , '' we start with 80 kilobytes of random data , then pick ten places to copy over this random data with the arbitrary 1-kilobyte sequence identified as tag _",
    "a_. similarly ,",
    "to create file `` ab , '' we start with 80 kilobytes of random data , then pick ten places to put copies of tag _ a _ , then pick ten more places to put copies of tag _ b _ ( perhaps overwriting some of the _ a _ tags ) . because we never use more than four different tags , and therefore never place more than 40 copies of tags",
    ", we can expect that at least half of the data in each file is random and uncorrelated with the rest of the files .",
    "the rest of the file is correlated with other files that also contain tags in common ; the more tags in common , the more related the files are .",
    "the compressor used to compute the ncd matrix was bzip2 .",
    "the resulting tree is given in figure  [ figtaggedfiles ] ; it can be seen that the clustering has occured exactly as we would expect .",
    "the @xmath2 score is 0.905 .    *",
    "testing the similarity machine on natural data : * we test gross classification of files based on markedly different file types . here",
    ", we chose several files : ( i ) four mitochondrial gene sequences , from a black bear , polar bear , fox , and rat obtained from the genbank database on the world - wide web ; ( ii ) four excerpts from the novel _ the zeppelin s passenger _ by e.",
    "phillips oppenheim , obtained from the project gutenberg edition on the world - wide web ; ( iii ) four midi files without further processing ; two from jimi hendrix and two movements from debussy s suite bergamasque , downloaded from various repositories on the world - wide web ; ( iv ) two linux x86 elf executables ( the _ cp _ and _ rm _ commands ) , copied directly from the redhat 9.0 linux distribution ; and ( v ) two compiled java class files , generated by ourselves .",
    "the compressor used to compute the ncd matrix was bzip2 . as expected",
    ", the program correctly classifies each of the different types of files together with like near like .",
    "the result is reported in figure  [ figfiletypes ] with @xmath2 equal to the very high confidence value 0.984 .",
    "this experiment shows the power and universality of the method : no features of any specific domain of application are used .",
    "we developed the complearn toolkit , section  [ sect.intro ] , and performed experiments in vastly different application fields to test the quality and universality of the method .",
    "the success of the method as reported below depends strongly on the judicious use of encoding of the objects compared . here",
    "one should use common sense on what a real world compressor can do .",
    "there are situations where our approach fails if applied in a straightforward way .",
    "for example : comparing text files by the same authors in different encodings ( say , unicode and 8-bit version ) is bound to fail . for the ideal similarity metric based on kolmogorov complexity",
    "as defined in @xcite this does not matter at all , but for practical compressors used in the experiments it will be fatal . similarly , in the music experiments below we use symbolic midi music file format rather than wave format music files .",
    "the reason is that the strings resulting from straightforward discretizing the wave form files may be too sensitive to how we discretize .            in recent years ,",
    "as the complete genomes of various species become available , it has become possible to do whole genome phylogeny ( this overcomes the problem that useing different targeted parts of the genome , or proteins , may give different trees @xcite ) .",
    "traditional phylogenetic methods on individual genes depended on multiple alignment of the related proteins and on the model of evolution of individual amino acids .",
    "neither of these is practically applicable to the genome level . in absence of such models , a method which can compute the shared information between two sequences",
    "is useful because biological sequences encode information , and the occurrence of evolutionary events ( such as insertions , deletions , point mutations , rearrangements , and inversions ) separating two sequences sharing a common ancestor will result in the loss of their shared information .",
    "our method ( in the form of the complearn toolkit ) is a fully automated software tool based on such a distance to compare two genomes .",
    "[ [ mammalian - evolution ] ] mammalian evolution : + + + + + + + + + + + + + + + + + + + +    in evolutionary biology the timing and origin of the major extant placental clades ( groups of organisms that have evolved from a common ancestor ) continues to fuel debate and research . here",
    ", we provide evidence by whole mitochondrial genome phylogeny for competing hypotheses in two main questions : the grouping of the eutherian orders , and the therian hypothesis versus the marsupionta hypothesis .",
    "[ [ eutherian - orders ] ] eutherian orders :    we demonstrate ( already in @xcite ) that a whole mitochondrial genome phylogeny of the eutherians ( placental mammals ) can be reconstructed automatically from _ unaligned _ complete mitochondrial genomes by use of an early form of our compression method , using standard software packages .",
    "as more genomic material has become available , the debate in biology has intensified concerning which two of the three main groups of placental mammals are more closely related : primates , ferungulates , and rodents . in @xcite ,",
    "the maximum likelihood method of phylogeny tree reconstruction gave evidence for the ( ferungulates , ( primates , rodents ) ) grouping for half of the proteins in the mitochondial genomes investigated , and ( rodents , ( ferungulates , primates ) ) for the other halves of the mt genomes . in that experiment they aligned 12 concatenated mitochondrial proteins , taken from 20 species : rat ( _ rattus norvegicus _ ) , house mouse ( _ mus musculus _ ) , grey seal ( _ halichoerus grypus _ ) , harbor seal ( _ phoca vitulina _ ) , cat ( _ felis catus _ ) , white rhino ( _ ceratotherium simum _ ) , horse ( _ equus caballus _ ) , finback whale ( _ balaenoptera physalus _ ) , blue whale ( _ balaenoptera musculus _ ) , cow ( _ bos taurus _ ) , gibbon ( _ hylobates lar _ ) , gorilla ( _ gorilla gorilla _ ) , human ( _ homo sapiens _ ) , chimpanzee ( _ pan troglodytes _ ) , pygmy chimpanzee ( _ pan paniscus _ ) , orangutan ( _ pongo pygmaeus _ ) , sumatran orangutan ( _ pongo pygmaeus abelii _ ) , using opossum ( _ didelphis virginiana _ ) , wallaroo ( _ macropus robustus _ ) , and the platypus ( _ ornithorhynchus anatinus _ ) as outgroup . in @xcite we used the whole mitochondrial genome of the same 20 species , computing the ncd distances ( or a closely related distance in @xcite ) , using the gencompress compressor , followed by tree reconstruction using the neighbor joining program in the molphy package @xcite to confirm the commonly believed morphology - supported hypothesis ( rodents , ( primates , ferungulates ) ) . repeating",
    "the experiment using the hypercleaning method @xcite of phylogeny tree reconstruction gave the same result .",
    "here , we repeated this experiment several times using the complearn toolkit using our new quartet method for reconstructing trees , and computing the ncd with various compressors ( gzip , bzip2 , ppmz ) , again always with the same result .",
    "these experiments are not reported since they are subsumed by the larger experiment of figure  [ tree - mammal ] .",
    "[ [ marsupionta - and - theria ] ] marsupionta and theria :    the extant monophyletic divisions of the class mammalia are the prototheria ( monotremes : mammals that procreate using eggs ) , metatheria ( marsupials : mammals that procreate using pouches ) , and eutheria ( placental mammals : mammals that procreate using placentas ) .",
    "the sister relationships between these groups is viewed as the most fundamental question in mammalian evolution @xcite .",
    "phylogenetic comparison by either anatomy or mitochondrial genome has resulted in two conflicting hypotheses : the gene - isolation - supported _ marsupionta hypothesis _ : ( ( prototheria , metatheria ) , eutheria ) versus the morphology - supported _ theria hypothesis _ : ( prototheria , ( methateria , eutheria ) ) , the third possiblity apparently not being held seriously by anyone",
    ". there has been a lot of support for either hypothesis ; recent support for the theria hypothesis was given in @xcite by analyzing a large nuclear gene ( m6p / ig2r ) , viewed as important across the species concerned , and even more recent support for the marsupionta hypothesis was given in @xcite by phylogenetic analysis of another sequence from the nuclear gene ( 18s rrna ) and by the whole mitochondrial genome .",
    "[ [ experimental - evidence ] ] experimental evidence :    to test the eutherian orders simultaneously with the marsupionta- versus theria hypothesis , we added four animals to the above twenty : australian echidna ( _ tachyglossus aculeatus _ ) , brown bear ( _ ursus arctos _ ) , polar bear ( _ ursus maritimus _ ) , using the common carp ( _ cyprinus carpio _ ) as the outgroup .",
    "interestingly , while there are many species of eutheria and metatheria , there are only three species of now living prototheria known : platypus , and two types of echidna ( or spiny anteater ) .",
    "so our sample of the prototheria is large .",
    "the addition of the new species might be risky in that the addition of new relations is known to distort the previous phylogeny in traditional computational genomics practice . with our method , using the full genome and obtaining a single tree with a very high confidence @xmath2 value , that risk is not as great as in traditional methods obtaining ambiguous trees with bootstrap ( statistic support ) values on the edges .",
    "the mitochondrial genomes of the total of 24 species we used were downloaded from the genbank database on the world - wide web .",
    "each is around 17,000 bases .",
    "the ncd distance matrix was computed using the compressor ppmz .",
    "the resulting phylogeny , with an almost maximal @xmath2 score of 0.996 supports anew the currently accepted grouping ( rodents , ( primates , ferungulates ) ) of the eutherian orders , and additionally the marsupionta hypothesis ( ( prototheria , metatheria ) , eutheria ) , see figure [ tree - mammal ] .",
    "overall , our whole - mitochondrial ncd analysis supports the following hypothesis : @xmath213 which indicates that the rodents , and the branch leading to the metatheria and prototheria , split off early from the branch that led to the primates and ferungulates .",
    "inspection of the distance matrix shows that the primates are very close together , as are the rodents , the metatheria , and the prototheria .",
    "these are tightly - knit groups with relatively close ncd s .",
    "the ferungulates are a much looser group with generally distant ncd s .",
    "the intergroup distances show that the prototheria are furthest away from the other groups , followed by the metatheria and the rodents .",
    "also the fine - structure of the tree is consistent with biological wisdom .    ....",
    "bluewhale             cat              echidna            gorilla             horse             opossum           polarbear          sumorang                     brownbear          chimpanzee          finwhale           greyseal         housemouse          orangutan          pygmychimp          wallaroo                             carp                cow               gibbon           harborseal           human             platypus             rat             whiterhino       bluewhale 0.005 0.906 0.943 0.897 0.925 0.883 0.936 0.616 0.928 0.931 0.901 0.898 0.896 0.926 0.920 0.936 0.928 0.929 0.907 0.930 0.927 0.929 0.925 0.902       brownbear 0.906 0.002 0.943 0.887 0.935 0.906 0.944 0.915 0.939 0.940 0.875 0.872 0.910 0.934 0.930 0.936 0.938 0.937 0.269 0.940 0.935 0.936 0.923 0.915            carp 0.943 0.943 0.006 0.946 0.954 0.947 0.955 0.952 0.951 0.957 0.949 0.950 0.952 0.956 0.946 0.956 0.953 0.954 0.945 0.960 0.950 0.953 0.942 0.960             cat 0.897 0.887 0.946 0.003 0.926 0.897 0.942 0.905 0.928 0.931 0.870 0.872 0.885 0.919 0.922 0.933 0.932 0.931 0.885 0.929 0.920 0.934 0.919 0.897      chimpanzee 0.925 0.935 0.954 0.926 0.006 0.926 0.948 0.926 0.849 0.731 0.925 0.922 0.921 0.943 0.667 0.943 0.841 0.946 0.931 0.441 0.933 0.835 0.934 0.930             cow 0.883 0.906 0.947 0.897 0.926 0.006 0.936 0.885 0.931 0.927 0.890 0.888 0.893 0.925 0.920 0.931 0.930 0.929 0.905 0.931 0.921 0.930 0.923 0.899         echidna 0.936 0.944 0.955 0.942 0.948 0.936 0.005 0.936 0.947 0.947 0.940 0.937 0.942 0.941 0.939 0.936 0.947 0.855 0.935 0.949 0.941 0.947 0.929 0.948    finbackwhale 0.616 0.915 0.952 0.905 0.926 0.885 0.936 0.005 0.930 0.931 0.911 0.908 0.901 0.933 0.922 0.936 0.933 0.934 0.910 0.932 0.928 0.932 0.927 0.902          gibbon 0.928 0.939 0.951 0.928 0.849 0.931 0.947 0.930 0.005 0.859 0.932 0.930 0.927 0.948 0.844 0.951 0.872 0.952 0.936 0.854 0.939 0.868 0.933 0.929         gorilla 0.931 0.940 0.957 0.931 0.731 0.927 0.947 0.931 0.859 0.006 0.927 0.929 0.924 0.944 0.737 0.944 0.835 0.943 0.928 0.732 0.938 0.836 0.934 0.929        greyseal 0.901 0.875 0.949 0.870 0.925 0.890 0.940 0.911 0.932 0.927 0.003 0.399 0.888 0.924 0.922 0.933 0.931 0.936 0.863 0.929 0.922 0.930 0.920 0.898      harborseal 0.898 0.872 0.950 0.872 0.922 0.888 0.937 0.908 0.930 0.929 0.399 0.004 0.888 0.922 0.922 0.933 0.932 0.937 0.860 0.930 0.922 0.928 0.919 0.900           horse 0.896 0.910 0.952 0.885 0.921 0.893 0.942 0.901 0.927",
    "0.924 0.888 0.888 0.003 0.928 0.913 0.937 0.923 0.936 0.903 0.923 0.912 0.924 0.924 0.848      housemouse 0.926 0.934 0.956 0.919 0.943 0.925 0.941 0.933 0.948 0.944 0.924 0.922 0.928 0.006 0.932 0.923 0.944 0.930 0.924 0.942 0.860 0.945 0.921 0.928           human 0.920 0.930 0.946 0.922 0.667 0.920 0.939 0.922 0.844 0.737 0.922 0.922 0.913 0.932 0.005 0.949 0.834 0.949 0.931 0.681 0.938 0.826 0.934 0.929         opossum 0.936 0.936 0.956 0.933 0.943 0.931 0.936 0.936 0.951 0.944 0.933 0.933 0.937 0.923 0.949 0.006 0.960 0.938 0.939 0.954 0.941 0.960 0.891 0.952       orangutan 0.928 0.938 0.953 0.932 0.841 0.930 0.947 0.933 0.872 0.835 0.931 0.932 0.923 0.944 0.834 0.960 0.006 0.954 0.933 0.843 0.943 0.585 0.945 0.934        platypus",
    "0.929 0.937 0.954 0.931 0.946 0.929 0.855 0.934 0.952 0.943 0.936 0.937 0.936 0.930 0.949 0.938 0.954 0.003 0.932 0.948 0.937 0.949 0.920 0.948       polarbear 0.907 0.269 0.945 0.885 0.931 0.905 0.935 0.910 0.936 0.928 0.863 0.860 0.903 0.924 0.931 0.939 0.933 0.932 0.002 0.942 0.940 0.936 0.927 0.917      pygmychimp 0.930 0.940 0.960 0.929 0.441 0.931 0.949 0.932 0.854 0.732 0.929 0.930 0.923 0.942 0.681 0.954 0.843 0.948 0.942 0.007 0.935 0.838 0.931 0.929             rat 0.927 0.935 0.950 0.920 0.933 0.921 0.941 0.928 0.939 0.938 0.922 0.922 0.912 0.860 0.938 0.941 0.943 0.937 0.940 0.935 0.006 0.939 0.922 0.922    sumorangutan 0.929 0.936 0.953 0.934 0.835 0.930 0.947 0.932 0.868 0.836 0.930 0.928 0.924 0.945 0.826 0.960 0.585 0.949 0.936 0.838 0.939 0.007 0.942 0.937        wallaroo",
    "0.925 0.923 0.942 0.919 0.934 0.923 0.929 0.927 0.933 0.934 0.920 0.919 0.924 0.921 0.934 0.891 0.945 0.920 0.927 0.931 0.922 0.942 0.005 0.935      whiterhino",
    "0.902 0.915 0.960 0.897 0.930 0.899 0.948 0.902 0.929 0.929 0.898 0.900 0.848 0.928 0.929 0.952 0.934 0.948 0.917 0.929 0.922 0.937 0.935 0.002 ....    [ [ hierarchical - versus - flat - clustering ] ] hierarchical versus flat clustering :    this is a good place to contrast the informativeness of hierarchical clustering with multidimensional clustering using the same ncd matrix , exhibited in figure  [ fig.distmatr ] .",
    "the entries give a good example of typical ncd values ; we truncated the number of decimals from 15 to 3 significant digits to save space .",
    "note that the majority of distances bunches in the range @xmath214 $ ] .",
    "this is due to the regularities the compressor can perceive .",
    "the diagonal elements give the self - distance , which , for ppmz , is not actually 0 , but is off from 0 only in the third decimal .",
    "in figure  [ fig.mammal2d ] we clustered the 24 animals using the ncd matrix by multidimenional scaling as points in 2-dimensional euclidean space . in this method",
    ", the ncd matrix of 24 animals can be viewed as a set of distances between points in @xmath32-dimensional euclidean space ( @xmath215 ) , which we want to project into a 2-dimensional euclidean space , trying to distort the distances between the pairs as little as possible .",
    "this is akin to the problem of projecting the surface of the earth globe on a two - dimensional map with minimal distance distortion .",
    "the main feature is the choice of the measure of distortion to be minimized , @xcite .",
    "let the original set of distances be @xmath216 and the projected distances be @xmath217 .",
    "in figure  [ fig.mammal2d ] we used the distortion measure _",
    "kruskall s stress-1 _ , @xcite , which minimizes @xmath218 .",
    "kruskall s stress-1 equal 0 means no distortion , and the worst value is at most 1 ( unless you have a really bad projection ) . in the projection of the ncd matrix according to our quartet method one minimizes the more subtle distortion @xmath2 measure , where 1 means perfect representation of the relative relations between every 4-tuple , and 0 means minimal representation .",
    "therefore , we should compare distortion kruskall stress-1 with @xmath219 .",
    "figure  [ tree - mammal ] has a very good @xmath220 and figure  [ fig.mammal2d ] has a poor kruskal stress @xmath221 . assuming that the comparison is significant for small values ( close to perfect projection ) , we find that the multidimensional scaling of this experiment s ncd matrix is formally inferior to that of the quartet tree .",
    "this conclusion formally justifies the impression conveyed by the figures on visual inspection .",
    "[ [ sars - virus ] ] sars virus : + + + + + + + + + + +    in another experiment we clustered the sars virus after its sequenced genome was made publicly available , in relation to potential similar virii .",
    "the 15 virus genomes were downloaded from the universal virus database of the international committee on taxonomy of viruses , available on the world - wide web .",
    "the sars virus was downloaded from canada s michael smith genome sciences centre which had the first public sars coronovirus draft whole genome assembly available for download ( sars tor2 draft genome assembly 120403 ) .",
    "the ncd distance matrix was computed using the compressor bzip2 .",
    "the relations in figure  [ fig.sars ] are very similar to the definitive tree based on medical - macrobio - genomics analysis , appearing later in the new england journal of medicine , @xcite .",
    "we depicted the figure in the ternary tree style , rather than the genomics - dendrogram style , since the former is more precise for visual inspection of proximity relations .",
    "[ [ analysis - of - mitochondrial - genomes - of - fungi ] ] analysis of mitochondrial genomes of fungi : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as a pilot for applications of the complearn toolkit in fungi genomics reasearch , the group of t. boekhout , e. kuramae , v. robert , of the fungal biodiversity center , royal netherlands academy of sciences , supplied us with the mitochondrial genomes of _ candida glabrata , pichia canadensis , saccharomyces cerevisiae , s. castellii , s. servazzii , yarrowia lipolytica _ ( all yeasts ) , and two filamentous ascomycetes _",
    "hypocrea jecorina _ and _ verticillium lecanii_. the ncd distance matrix was computed using the compressor ppmz .",
    "the resulting tree is depicted in figure  [ fig.fungi ] .",
    "the interpretation of the fungi researchers is `` the tree clearly clustered the ascomycetous yeasts versus the two filamentous ascomycetes , thus supporting the current hypothesis on their classification ( for example , see @xcite ) .",
    "interestingly , in a recent treatment of the saccharomycetaceae , s. servazii , s. castellii and c. glabrata were all proposed to belong to genera different from saccharomyces , and this is supported by the topology of our tree as well ( @xcite ) . ''",
    "to compare the veracity of the ncd clustering with a more feature - based clustering , we also calculated the pairwise distances as follows : each file is converted to a @xmath222-dimensional vector by considering the frequency of all ( overlapping ) 6-byte contiguous blocks .",
    "the l2-distance ( euclidean distance ) is calculated between each pair of files by taking the square root of the sum of the squares of the component - wise differences .",
    "these distances are arranged into a distance matrix and linearly scaled to fit the range @xmath223 $ ] . finally , we ran the clustering routine on this distance matrix .",
    "the results are in figure  [ fig.vbf ] .",
    "as seen by comparing with the ncd - based figure  [ fig.fungi ] there are apparent misplacements when using the euclidean distance in this way .",
    "thus , in this simple experiment , the ncd performed better , that is , agreed more precisely with accepted biological knowledge .",
    "our method improves the results of @xcite , using a linguistic corpus of `` the universal declaration of human rights ( udohr ) '' @xcite in 52 languages .",
    "previously , @xcite used an asymmetric measure based on relative entropy , and the full matrix of the pair - wise distances between all 52 languages , to build a language classification tree .",
    "this experiment was repeated ( resulting in a somewhat better tree ) using the compression method in @xcite using standard biological software packages to construct the phylogeny .",
    "we have redone this experiment , and done new experiments , using the complearn toolkit . here , we report on an experiment to separate radically different language families .",
    "we downloaded the language versions of the udohr text in english , spanish , dutch , german ( native - european ) , pemba , dendi , ndbele , kicongo , somali , rundi , ditammari , dagaare ( native african ) , chikasaw , perhupecha , mazahua , zapoteco ( native - american ) , and did nt preprocess them except for removing initial identifying information .",
    "we used an lempel - ziv - type compressor _ gzip _ to compress text sequences of sizes not exceeding the length of the sliding window _ gzip _ uses ( 32 kilobytes ) , and compute the ncd for each pair of language sequences .",
    "subsequently we clustered the result .",
    "we show the outcome of one of the experiments in figure  [ fig.lang ] .",
    "note that three groups are correctly clustered , and that even the subclusters of the european languages are correct ( english is grouped with the romance languages because it contains up to 40% admixture of words from latin origine ) .",
    "the texts used in this experiment were down - loaded from the world - wide web in original cyrillic - lettered russian and in latin - lettered english by l. avanasiev ( moldavian msc student at the university of amsterdam ) .",
    "the compressor used to compute the ncd matrix was bzip2 .",
    "we clustered russian literature in the original ( cyrillic ) by gogol , dostojevski , tolstoy , bulgakov , tsjechov , with three or four different texts per author .",
    "our purpose was to see whether the clustering is sensitive enough , and the authors distinctive enough , to result in clustering by author . in figure  [ fig.russwriter ]",
    "we see a perfect clustering .       considering the english translations of the same texts , in figure  [ fig.russtrans ] , we see errors in the clustering .",
    "inspection shows that the clustering is now partially based on the translator .",
    "it appears that the translator superimposes his characteristics on the texts , partially suppressing the characteristics of the original authors . in other experiments we separated authors by gender and by period .",
    "the amount of digitized music available on the internet has grown dramatically in recent years , both in the public domain and on commercial sites .",
    "napster and its clones are prime examples .",
    "websites offering musical content in some form or other ( mp3 , midi ,  ) need a way to organize their wealth of material ; they need to somehow classify their files according to musical genres and subgenres , putting similar pieces together .",
    "the purpose of such organization is to enable users to navigate to pieces of music they already know and like , but also to give them advice and recommendations ( `` if you like this , you might also like  '' ) .",
    "currently , such organization is mostly done manually by humans , but some recent research has been looking into the possibilities of automating music classification .",
    "initially , we downloaded 36 separate midi ( musical instrument digital interface , a versatile digital music format available on the world - wide - web ) files selected from a range of classical composers , as well as some popular music .",
    "the files were down - loaded from several different midi databases on the world - wide web .",
    "the identifying information , composer , title , and so on , was stripped from the files ( otherwise this may give a marginal advantage to identify composers to the compressor ) .",
    "each of these files was run through a preprocessor to extract just midi note - on and note - off events .",
    "these events were then converted to a player - piano style representation , with time quantized in @xmath224 second intervals .",
    "all instrument indicators , midi control signals , and tempo variations were ignored . for each track in the midi file , we calculate two quantities : an _ average volume _ and a _ modal note_. the average volume is calculated by averaging the volume ( midi note velocity ) of all notes in the track . the modal note is defined to be the note pitch that sounds most often in that track . if this is not unique , then the lowest such note is chosen .",
    "the modal note is used as a key - invariant reference point from which to represent all notes .",
    "it is denoted by @xmath225 , higher notes are denoted by positive numbers , and lower notes are denoted by negative numbers .",
    "a value of @xmath203 indicates a half - step above the modal note , and a value of @xmath226 indicates a whole - step below the modal note .",
    "the tracks are sorted according to decreasing average volume , and then output in succession . for each track ,",
    "we iterate through each time sample in order , outputting a single signed 8-bit value for each currently sounding note .",
    "two special values are reserved to represent the end of a time step and the end of a track .",
    "this file is then used as input to the compression stage for distance matrix calculation and subsequent tree search . to check whether any important feature of the music was lost during preprocessing",
    ", we played it back from the preprocessed files to verify whether it sounded like the original . to the authors the pieces sounded almost unchanged .",
    "the compressor used to compute the ncd matrix of the genres tree , figure  [ figgenres ] , and that of 12-piece music set , figure  [ figsmallset ] is bzip2 . for the full range of the music experiments see @xcite .    before testing whether our program can see the distinctions between various classical composers ,",
    "we first show that it can distinguish between three broader musical genres : classical music , rock , and jazz",
    ". this may be easier than making distinctions `` within '' classical music .",
    "all musical pieces we used are listed in the tables in the full paper ( on the url provided above ) . for the genre - experiment we used 12 classical pieces consisting of bach , chopin , and debussy , 12 jazz pieces , and 12 rock pieces .",
    "the tree ( figure  [ figgenres ] ) that our program came up with has @xmath227 .",
    "the discrimination between the 3 genres is reasonable but not perfect . since @xmath227 , a fairly low value",
    ", the resulting tree does nt represent the ncd distance matrix very well .",
    "presumably , the information in the ncd distance matrix can not be represented by a dendrogram of high @xmath2 score .",
    "this appears to be a common problem with large ( @xmath228 or so ) natural data sets .",
    "another reason may be that the program terminatedi , while trapped in a local optimum .",
    "we repeated the experiment many times with almost the same results , so that does nt appear to be the case .",
    "the 11-item subtree rooted at @xmath229 contains 10 of the 12 jazz pieces , together with a piece of bach s `` wohltemporierte klavier ( wtk ) '' .",
    "the other two jazz pieces , miles davis `` so what , '' and john coltrane s `` giant steps '' are placed elsewhere in the tree , perhaps according to some kinship that now escapes us ( but may be identified by closer studying of the objects concerned ) .",
    "of the 12 rock pieces , 10 are placed in the 12-item subtree rooted at @xmath230 , together with a piece of bach s `` wtk , '' and coltrane s `` giant steps , '' while hendrix s `` voodoo chile '' and rush `` yyz '' is further away .",
    "of the 12 classical pieces , 10 are in the 13-item subtrees rooted at the branch @xmath231 , together with hendrix s `` voodoo chile , '' rush s `` yyz , '' and miles davis `` so what . ''",
    "surprisingly , 2 of the 4 bach `` wtk '' pieces are placed elsewhere .",
    "yet we perceive the 4 bach pieces to be very close , both structurally and melodically ( as they all come from the mono - thematic `` wohltemporierte klavier '' ) .",
    "but the program finds a reason that at this point is hidden from us .",
    "in fact , running this experiment with different compressors and termination conditions consistently displayed this anomaly .",
    "the small set encompasses the 4 movements from debussy s `` suite bergamasque , '' 4 movements of book 2 of bach s `` wohltemperierte klavier , '' and 4 preludes from chopin s `` opus  28 . '' as one can see in figure  [ figsmallset ] , our program does a pretty good job at clustering these pieces .",
    "the @xmath2 score is also high : 0.968 .",
    "the 4 debussy movements form one cluster , as do the 4 bach pieces .",
    "the only imperfection in the tree , judged by what one would intuitively expect , is that chopin s prlude no .  15 lies a bit closer to bach than to the other 3 chopin pieces .",
    "this prlude no  15 , in fact , consistently forms an odd - one - out in our other experiments as well .",
    "this is an example of pure data mining , since there is some musical truth to this , as no .",
    "15 is perceived as by far the most eccentric among the 24 prludes of chopin s opus  28 .",
    "can we also cluster two - dimensional images ? because our method appears focussed on strings this is not straightforward .",
    "it turns out that scanning a picture in raster row - major order retains enough regularity in both dimensions for the compressor to grasp .",
    "a simple task along these lines is to cluster handwritten characters .",
    "the handwritten characters in figure  [ fig.ocrdata ] were downloaded from the nist special data base 19 ( optical character recognition database ) on the world - wide web .",
    "each file in the data directory contains 1 digit image , either a four , five , or six .",
    "each pixel is a single character ; # for a black pixel , . for white .",
    "newlines are added at the end of each line .",
    "each character is 128x128 pixels .",
    "the ncd matrix was computed using the compressor ppmz .",
    "the figure  [ fig.ocr ] shows each character that is used .",
    "there are 10 of each digit `` 4 , '' `` 5 , '' `` 6 , '' making a total of 30 items in this experiment .",
    "all but one of the 4 s are put in the subtree rooted at @xmath232 , all but one of the 5 s are put in the subtree rooted at @xmath229 , and all 6 s are put in the subtree rooted at @xmath233 .",
    "the remaining 4 and 5 are in the branch @xmath234 joining @xmath235 and @xmath233 .",
    "so 28 items out of 30 are clustered correctly , that is , 93% .",
    "in this experiment we used only 3 digits . using the full set of decimal digits results in a lower clustering accuracy .",
    "however , we can use the ncd as a oblivious feature - extraction technique to convert generic objects into finite - dimensional vectors .",
    "we have used this technique to train a support vector machine ( svm ) based ocr system to classify handwritten digits by extracting 80 distinct , ordered ncd features from each input image . in this initial stage of ongoing research , by our oblivious method of compression - based clustering to supply a kernel for an svm classifier , we achieved a handwritten single decimal digit recognition accuracy of 85% .",
    "the current state - of - the - art for this problem , after half a century of interactive feature - driven classification research , in the upper ninety % level @xcite .",
    "all experiments are bench marked on the standard nist special data base 19 ( optical character recognition database ) .      as a proof of principle we clustered data from unknown objects , for example objects that are far away . in @xcite observations of the microquasar grs 1915",
    "+ 105 made with the rossi x - ray timing eplorer were analyzed .",
    "the interest in this microquasar stems from the fact that it was the first galactic object to show a certain behavior ( superluminal expansion in radio observations ) .",
    "photonometric observation data from x - ray telescopes were divided into short time segments ( usually in the order of one minute ) , and these segments have been classified into a bewildering array of fifteen different modes after considerable effort .",
    "briefly , spectrum hardness ratios ( roughly , `` color '' ) and photon count sequences were used to classify a given interval into categories of variability modes . from this analysis ,",
    "the extremely complex variability of this source was reduced to transitions between three basic states , which , interpreted in astronomical terms , gives rise to an explanation of this peculiar source in standard black - hole theory .",
    "the data we used in this experiment made available to us by m. klein wolt ( co - author of the above paper ) and t. maccarone , both researchers at the astronomical institute `` anton pannekoek '' , university of amsterdam .",
    "the observations are essentially time series , and our aim was experimenting with our method as a pilot to more extensive joint research . here",
    "the task was to see whether the clustering would agree with the classification above .",
    "the ncd matrix was computed using the compressor ppmz .",
    "the results are in figure  [ fig.astro ] .",
    "we clustered 12 objects , consisting of three intervals from four different categories denoted as @xmath236 in table 1 of @xcite . in figure  [ fig.astro ]",
    "we denote the categories by the corresponding roman letters d , g , p , and t , respectively .",
    "the resulting tree groups these different modes together in a way that is consistent with the classification by experts for these observations .",
    "the oblivious compression clustering corresponds precisely with the laborious feature - driven classification in @xcite .",
    "to interpret what the ncd is doing , and to explain its remarkable accuracy and robustness across application fields and compressors , the intuition is that the ncd minorizes all similarity metrics based on features that are captured by the reference compressor involved .",
    "such features must be relatively _ simple _ in the sense that they are expressed by an aspect that the compressor analyzes ( for example frequencies , matches , repeats ) .",
    "certain sophisticated features may well be expressible as combinations of such simple features , and are therefore themselves simple features in this sense .",
    "the extensive experimenting above shows that even elusive features are captured .    a potential application of our non - feature ( or rather",
    ", many - unknown - feature ) approach is exploratory . presented with data for which the features are as yet unknown , certain dominant features governing similarity",
    "are automatically discovered by the ncd .",
    "examining the data underlying the clusters may yield this hitherto unknown dominant feature .",
    "our experiments indicate that the ncd has application in two new areas of support vector machine ( svm ) based learning .",
    "firstly , we find that the inverted ncd ( 1-ncd ) is useful as a kernel for generic objects in svm learning .",
    "secondly , we can use the normal ncd as a feature - extraction technique to convert generic objects into finite - dimensional vectors , see the last paragraph of section  [ sec.ocr ] . in effect",
    "our similarity engine aims at the ideal of a perfect data mining process , discovering unknown features in which the data can be similar .",
    "this is the subject of current joint research in genomics of fungi , clinical molecular genetics , and radio - astronomy .",
    "we thank loredana afanasiev , graduate school of logic , university of amsterdam ; teun boekhout , eiko kuramae , vincent robert , fungal biodiversity center , royal netherlands academy of sciences ; marc klein wolt , thomas maccarone , astronomical institute `` anton pannekoek '' , university of amsterdam ; evgeny verbitskiy , philips research ; steven de rooij , ronald de wolf , cwi ; the referees and the editors , for suggestions , comments , help with experiments , and data ; jorma rissanen and boris ryabko for discussions , tzu - kuo huang for pointing out some typos and simplifications , and teemu roos and henri tirry for implementing a visualization of the clustering process .",
    "d.  bryant , v.  berry , p.  kearney , m.  li , t.  jiang , t.  wareham and h.  zhang .",
    "a practical algorithm for recovering the best supported edges of an evolutionary tree .",
    "11th acm - siam symposium on discrete algorithms _",
    ", 287296 , 2000 .",
    "y. cao , a. janke , p. j. waddell , m. westerman , o. takenaka , s. murata , n. okada , s. pbo , m. hasegawa , conflict among individual mitochondrial proteins in resolving the phylogeny of eutherian orders , _",
    "_ , 47(1998 ) , 307 - 322 .",
    "m.  grimaldi , a.  kokaram , and p.  cunningham .",
    "classifying music by genre using the wavelet packet transform and a round - robin ensemble .",
    "technical report tcd - cs-2002 - 64 , trinity college dublin , 2002 .",
    "a. janke , o. magnell , g. wieczorek , m. westerman , u. arnason , phylogenetic analysis of 18s rrna and the mitochondrial genomes of wombat , vombatus ursinus , and the spiny anteater , tachyglossus acelaetus : increased support for the marsupionta hypothesis , _",
    "_ , 1:54(2002 ) , 7180 .",
    "killian , t.r .",
    "buckley , n. steward , b.l .",
    "munday , r.l .",
    "jirtle , marsupials and eutherians reunited : genetic evidence for the theria hypothesis of mammalian evolution , _ mammalian genome _ , 12(2001 ) , 513517 .",
    "kurtzman , phylogenetic circumscription of saccharomyces , kluyveromyces and other members of the saccharomycetaceaea , and the proposal of the new genera lachnacea , nakaseomyces , naumovia , vanderwaltozyma and zygotorulaspora , _ fems yeast res .",
    "_ , 4(2003 ) , 233245 .",
    "m.  li , j.h .",
    "badger , x.  chen , s.  kwong , p.  kearney , and h.  zhang . an information - based sequence distance and its application to whole mitochondrial genome phylogeny , _ bioinformatics _ , 17:2(2001 ) , 149154 .",
    "x.  chen , m. li , x.  li , b.  ma , p.m.b .",
    "the similarity metric , _ ieee trans . infrom .",
    "_ , to appear . m.  li and p.m.b .  vitnyi .",
    "_ an introduction to kolmogorov complexity and its applications _ , springer - verlag , new york , 2nd edition , 1997 .",
    "oliveira , r. sabourin , f. bortolozzi , c.y .",
    "suen , automatic recognition of handwritten numerical strings : a recognition and verification strategy , _ ieee trans .",
    "pattern analysis and machine intelligence _ , 24:11(2002 ) , 14381454 ."
  ],
  "abstract_text": [
    "<S> we present a new method for clustering based on compression . the method does nt use subject - specific features or background knowledge , and works as follows : first , we determine a universal similarity distance , the normalized compression distance or ncd , computed from the lengths of compressed data files ( singly and in pairwise concatenation ) . </S>",
    "<S> second , we apply a hierarchical clustering method . </S>",
    "<S> the ncd is universal in that it is not restricted to a specific application area , and works across application area boundaries . a theoretical precursor , </S>",
    "<S> the normalized information distance , co - developed by one of the authors , is provably optimal in the sense that it minorizes every computable normalized metric that satisfies a certain density requirement . </S>",
    "<S> however , the optimality comes at the price of using the non - computable notion of kolmogorov complexity . </S>",
    "<S> we propose precise notions of similarity metric , normal compressor , and show that the ncd based on a normal compressor is a similarity metric that approximates optimality . to extract a hierarchy of clusters from the distance matrix , </S>",
    "<S> we determine a dendrogram ( binary tree ) by a new quartet method and a fast heuristic to implement it . </S>",
    "<S> the method is implemented and available as public software , and is robust under choice of different compressors . to substantiate our claims of universality and robustness , </S>",
    "<S> we report evidence of successful application in areas as diverse as genomics , virology , languages , literature , music , handwritten digits , astronomy , and combinations of objects from completely different domains , using statistical , dictionary , and block sorting compressors . in genomics we presented new evidence for major questions in mammalian evolution , based on whole - mitochondrial genomic </S>",
    "<S> analysis : the eutherian orders and the marsupionta hypothesis against the theria hypothesis . </S>"
  ]
}