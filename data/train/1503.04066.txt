{
  "article_text": [
    "we consider data sets describing contacts between individuals , collected by the sociopatterns collaboration ( http://www.sociopatterns.org ) in three different settings : a workplace ( office building , invs ) @xcite , a high school ( thiers13 ) @xcite and a scientific conference ( sfhh ) @xcite .",
    "these data correspond to the close face - to - face proximity of individuals equipped with wearable sensors , at a temporal resolution of @xmath0 seconds  @xcite .",
    "table  [ tab : data ] summarises the characteristics of each data set .",
    "the contact data are represented by temporal networks , in which nodes represent the participating individuals and a link between two nodes @xmath1 and @xmath2 at time @xmath3 indicates that the two corresponding persons were in contact at that time .",
    "these three data sets were chosen as representative of different types of day - to - day contexts and of different contact network structures : the sfhh data correspond to a rather homogeneous contact network ; the invs and thiers13 populations were instead structured in departments and classes , respectively . moreover ,",
    "high school classes ( thiers13 ) are of similar sizes while the invs department sizes are unequal .",
    "finally , the high school contact patterns ( thiers13 ) are constrained by strict and repetitive school schedules , while contacts in offices are less regular across days .    to quantify how the incompleteness of data , assumed to stem from a uniformly random participation of individuals to the data collection , affects the outcome of simulations of dynamical processes , we consider as ground truth the available data and perform population resampling experiments by removing a fraction @xmath4 of the nodes uniformly at random .",
    "( note that the full data sets are also samples of all the contacts that occurred in the populations , as the participation rate was lower than @xmath5 in each case . in the thiers13 case",
    "however , the participation rate was quite high . )",
    "we then simulate on the resampled data the paradigmatic susceptible - infectious - recovered ( sir ) and the susceptible - infectious - susceptible ( sis ) models of epidemic propagation . in these models ,",
    "a susceptible ( s ) node becomes infectious ( i ) at rate @xmath6 when in contact with an infectious node .",
    "infectious nodes recover spontaneously at rate @xmath7 . in the sir model , nodes then enter an immune recovered ( r ) state , while in the sis model , nodes become susceptible again and can be reinfected .",
    "the quantities of interest are for the sir model the distribution of epidemic sizes , defined as the final fraction of recovered nodes , and for the sis model the average fraction of infectious nodes @xmath8 in the stationary state .",
    "we also calculate for the sir model the fraction of epidemics that infect more than 20% of the population and the average size of these epidemics . for the sis model",
    ", we determine the epidemic threshold @xmath9 for different values of @xmath7 : it corresponds to the value of @xmath6 that separates an epidemic - free state ( @xmath10 ) for @xmath11 from an endemic state ( @xmath12 ) for @xmath13 , and is thus an important indicator of the epidemic risk .",
    "we refer to the methods section for further details on the simulations .",
    "we then present several methods for constructing surrogate data using only information contained in the resampled data .",
    "we compare for each data set the outcomes of simulations performed on the whole data set , on resampled data sets with a varying fraction of nodes removed , @xmath4 , and on the reconstructed data sets built using these various methods .",
    "missing data are known to affect the various properties of contact networks in different ways . in particular",
    ", the number of neighbours ( degree ) of a node decreases as the fraction @xmath4 of removed nodes increases , since removing nodes also removes links to these nodes . under the hypothesis of uniform sampling ,",
    "the average degree @xmath14 becomes @xmath15 for the resampled network @xcite . as a result ,",
    "the density of the resampled aggregated contact network , defined as the number of links divided by the total number of possible links between the nodes , does not depend on @xmath4 .",
    "the same reasoning applies to the density @xmath16 of links between groups of nodes @xmath17 and @xmath18 , defined as the number of links @xmath19 between nodes of group @xmath17 and nodes of group @xmath18 , normalised by the maximum possible number of such links , @xmath20 , where @xmath21 is the number of nodes of group @xmath17 ( for @xmath22 , the maximum possible number of links is @xmath23 ) : both the expected number of neighbours of group @xmath18 for nodes of group @xmath17 ( given by @xmath24 ) and the number @xmath25 of nodes in group @xmath18 are indeed reduced by a factor @xmath26 , so that @xmath16 remains constant .",
    "this means that the link density contact matrix , which gathers these densities and gives a measure of the interaction between groups ( here classes or departments ) , is stable under uniform resampling .",
    "we illustrate these results on our empirical data sets in supplementary figures 1 , 2 , 4 and 5 .",
    "table [ tab : sim_cm ] and supplementary figure 2 show in particular that the similarities between the original and resampled matrices are high for all data sets ( see supplementary figures 45 for the contact matrices themselves ) .",
    "finally , the temporal statistics of the contact network are not affected by population sampling , as already noted in @xcite for other data sets : the distributions of contact and inter - contact durations ( the inter - contact durations are the times between consecutive contacts on a link ) , of number of contacts per link and of cumulated contact durations ( i.e. , of the link weights in the aggregated network ) do not change when the network is sampled uniformly ( supplementary figure 1 ) . in the case of structured population ,",
    "an interesting property is moreover illustrated in supplementary figures 67 : although the distributions of contact durations occurring between members of the same group or between individuals belonging to different groups are indistinguishable , this is not the case for the distributions of the numbers of contacts per link nor , as a consequence , for the distributions of cumulated contact durations .",
    "in fact , both cumulated contact durations and numbers of contacts per link are more broadly distributed for links joining members of the same group .",
    "the figures show that this property is stable under uniform resampling .    despite the robustness of these properties , the outcome of simulations of epidemic spread is strongly affected by the resampling . as fig .",
    "[ sampling ] illustrates for instance , the probability of large outbreaks in the sir model decreases strongly as @xmath4 increases and even vanishes at large @xmath4 .",
    "as mentioned above , such a result is expected , since the removed nodes act as if they were immunised : sampling hinders the propagation in simulations by removing transmission routes between the remaining nodes . as a consequence , the prevalence and the final size of the outbreaks",
    "are systematically underestimated by simulations of the sir model on the resampled network with respect to simulations on the whole data set ( for the sis model , the epidemic threshold is overestimated ) : resampling leads overall to a systematic underestimation of the epidemic risk , and fig .",
    "[ sampling ] illustrates the extent of this underestimation for the data at hand .",
    "we now present a series of methods to improve the estimation of the epidemic risk in simulations of epidemic spread on temporal network data sets in which nodes ( individuals ) are missing uniformly at random .",
    "note that we do not address here the problem of link prediction @xcite as our aim is not to infer the missing contacts .",
    "the hierarchy of methods we put forward uses increasing amounts of information corresponding to increasing amounts of detail on the group and temporal structure of the contact patterns , as measured in the resampled network .",
    "we moreover assume that the timelines of scheduled activity are known ( i.e. , nights and weekends , during which no contact occurs ) .    for each data set , considered as ground truth ,",
    "we create resampled data sets by removing at random a fraction @xmath4 of the @xmath27 nodes .",
    "we then measure on each resampled data set a series of statistics of the resulting contact network and construct stochastic , surrogate versions of the missing part of the network by creating for each missing node a surrogate instance of its links and a synthetic timeline of contacts on each surrogate link , in the different ways described below ( see supplementary information and methods section for more details on their practical implementation ) .",
    "method 0 . as discussed above , the first effect of missing data is to decrease the average degree of the aggregate contact network , while keeping its density constant .",
    "hence , the simplest approach is to merely compensate this decrease .",
    "we therefore measure the density of the resampled contact network @xmath28 , as well as the average aggregate duration of the contacts , @xmath29 .",
    "we then add back the missing nodes and create surrogate links between these nodes and between these nodes and the nodes of the resampled data set at random , with the only constraint to keep the overall link density fixed to @xmath28 .",
    "we then attribute to each surrogate link the same weight @xmath29 and create for each link a timeline of randomly chosen contact events of equal length @xmath30 ( the temporal resolution of the data set ) whose total duration gives back @xmath29 .",
    "method w. the heterogeneity of aggregated contact durations is known to play a role in the spreading patterns of model diseases @xcite . we therefore refine method 0 by collecting in the resampled data the list @xmath31 of aggregate contact durations , or weights ( w ) .",
    "we build the surrogate links and surrogate timelines of contacts on each link as in method 0 , except that each surrogate link carries a weight extracted at random from @xmath31 , instead of the average @xmath29 .",
    "method ws . the fact that the population is divided into groups of individuals such as classes or departments can have a strong impact on the structure of the contact network @xcite and on spreading processes @xcite .",
    "we thus measure here the link density contact matrix of the resampled data , and construct surrogate links in a way to keep this matrix fixed ( equal to the value measured in the resampled data ) , in the spirit of stochastic block models with fixed numbers of edges between blocks @xcite .",
    "we collect in the resampled data two separate lists of aggregate contact durations : @xmath32 gathers the weights of links between individuals belonging to the same group , and @xmath33 is built with the weights of links joining individuals of different groups . for each surrogate link ,",
    "its weight is extracted at random either from @xmath32 if it joins individuals of the same group or from @xmath33 if it associates individuals of different groups .",
    "timelines are then attributed to links as in w. this method assumes that the number of missing nodes in each group is known , and preserves the group structure ( s ) of the population .",
    "method wt .",
    "several works have investigated how the temporal characteristics of networks ( such as burstiness ) can slow down or accelerate spreading @xcite . in order",
    "to take these characteristics into account , we measure in the resampled data the distributions of number of contacts per link and of contact and inter - contact durations , in addition to the global network density .",
    "we build surrogate links as in method w , and construct on each link a synthetic timeline in a way to respect the measured temporal statistics ( t ) of contacts .",
    "more precisely , we attribute at random a number of contacts ( taken from the measured distribution ) to each surrogate link , and then alternate contact and inter - contact durations taken at random from the respective empirical distributions .",
    "method wst .",
    "this method conserves the distribution of link weights ( w ) , the group structure ( s ) , and the temporal characteristics of contacts ( t ) : surrogate links are built and weights assigned as in method ws , and contact timelines on each link as in method wt .",
    "each of these methods uses a different amount of information gathered from the resampled data .",
    "methods 0 , w and wt include an increasing amount of detail on the temporal structure of contacts : method 0 assumes homogeneity of aggregated contact durations , while w takes into account their heterogeneity , and wt reproduces heterogeneities of contact and inter - contact durations . on the other hand ,",
    "neither of these three methods assume any knowledge of the population group structure .",
    "this can be due either to an effective complete lack of knowledge about the population structure , as in the sfhh data , or also to the lack of data on the repartition of the missing nodes in the groups .",
    "methods ws and wst on the other hand reproduce the group structure as in a stochastic block model with fixed number of links within and between groups , and take into account the difference between the distributions of numbers of contacts and aggregate durations between individuals of the same or of different groups .",
    "indeed , links within groups correspond on average to larger weights , as found empirically in @xcite and discussed above ( supplementary figures 56 ) .",
    "overall , method wst is the one that uses most information measured in the resampled data .",
    "( additional properties such as the transitivity -which is also stable under resampling procedure , see supplementary figure 3- can also be measured in the resampled data and imposed in the construction of surrogate links , as detailed in the supplementary information .",
    "this comes however at a strong computational cost and we have verified that it does not impact significantly our results , as shown in the supplementary figure 20 . )    we check in table  [ tab : sim_cm ] and supplementary figures 813 that the statistical properties of the resulting reconstructed ( surrogate ) networks , obtained by the union of the resampled data and of the surrogate links , are similar to the ones of the original data for the wst method .",
    "we emphasise again that our aim is not to infer the true missing contacts , so that we do not compare the detailed structures of the surrogate and original contact networks .",
    "figures  [ fig : inferinvs ] , [ fig : inferthiers ] , [ fig : infersfhh ] and supplementary figures 1619 display the outcome of sir spreading simulations performed on surrogate networks obtained using the various reconstruction methods , compared with the outcome of simulations on the resampled data sets , for various values of @xmath4 .",
    "method 0 leads to a clear overestimation of the outcome and does not capture well the shape of the distribution of outbreak sizes .",
    "method w gives only slightly better results .",
    "the overall shape of the distribution is better captured for the three reconstruction methods using more information : ws , wt and wst ( note that for the sfhh case the population is not structured , so that w and ws are equivalent , as are wt and wst ) .",
    "the wst method matches best the shape of the distributions and yields distributions much more similar to those obtained by simulating on the whole data set than the simulations performed on the resampled networks .",
    "we also show in fig .",
    "[ fig : dist ] the fraction of outbreaks that reach at least @xmath34 of the population and the average epidemic size for these outbreaks . in the case of simulations performed on resampled data ,",
    "we rapidly lose information about the size and even the existence of large outbreaks as @xmath4 increases .",
    "simulations using data reconstructed with methods 0 and w , on the contrary , largely overestimate these quantities , which is expected as infections spread easier on random graphs than on structured graphs @xcite , especially if the heterogeneity of the aggregated contact durations is not considered @xcite . taking into account the population structure or using contact sequences that respect the temporal heterogeneities ( broad distributions of contact and inter - contact durations ) yield better results ( ws and wt cases , respectively ) .",
    "overall , the wst method , for which the surrogate networks respect all these constraints , yields the best results .",
    "we show in the supplementary information that similar results are obtained for different values of the spreading parameters .",
    "moreover , as shown in fig .",
    "[ fig : sis_invs ] and supplementary figures 1415 , the phase diagram obtained for the sis model when using reconstructed networks is much closer to the original than for resampled networks .",
    "overall , simulations on networks reconstructed using the wst method yield a much better estimation of the epidemic risk than simulations using resampled network data , for both sis and sir models .      even when simulations are performed on reconstructed contact patterns built with the wst method , the maximal outbreak sizes are systematically overestimated ( figs .",
    "[ fig : inferinvs ] - [ fig : infersfhh ] ) , as well as , in most cases , the probability and average size of large outbreaks , especially for the sfhh case ( figs .",
    "[ fig : infersfhh ] - [ fig : dist ] ) .",
    "these discrepancies might stem from structural and/or temporal correlations present in empirical contact data that are not taken into account in our reconstruction methods . in order to test this hypothesis",
    ", we construct several reshuffled data sets and use them as initial data in our resampling and reconstruction procedure .",
    "we use both structural and temporal reshuffling as described in the methods section , in order to remove either structural correlations , temporal correlations , or both , from the original data sets .",
    "we then proceed to a resampling and reconstruction procedure ( using the wst method ) as for the original data , and perform numerical simulations of sir processes . as for the original data , simulations on resampled data",
    "lead to a strong underestimation of the process outcome , and simulations using the reconstructed data gives much better results .",
    "we show in the supplementary figures 21 - 22 that we still obtain discrepancies , and in particular overestimations of the largest epidemic sizes , when we use temporally reshuffled data in which the link structure of the contact network is maintained .",
    "if on the other hand we use data in which the network structure has been reshuffled in a way to cancel structural correlations within each group , the reconstruction procedure gives a very good agreement between the distributions of epidemic sizes of original and reconstructed data , as shown in fig .",
    "[ fig : infercmshuffled ] .",
    "more precisely we consider here `` cm - shuffled '' data , i.e. , contact networks in which the links have been reshuffled randomly but separately for each pair of groups , i.e. , a link between an individual of group @xmath17 and an individual of group @xmath18 is still between groups @xmath17 and @xmath18 in the reshuffled network .",
    "the difference with the case of non - reshuffled empirical data is particularly clear for the sfhh case .",
    "this indicates that the overestimation observed in figs .",
    "[ fig : inferinvs ] - [ fig : infersfhh ] is mostly due to the fact that the reconstructed data does not reproduce small scale structures of the contact networks : such structures might be due to e.g. groups of colleagues or friends , whose composition is neither available as metadata nor detectable in the resampled data sets .      when the fraction @xmath4 of nodes excluded by the resampling procedure becomes large , the properties of the resampled data may start to differ substantially from those of the whole data set ( figs . s1 & s2 ) . as a result ,",
    "the distributions of epidemic sizes of sir simulations show stronger deviations from those obtained on the whole data set ( fig .",
    "[ fig : infer_high ] ) , even if the epidemic risk evaluation is still better than for simulations on the resampled networks ( fig .",
    "[ fig : dist ] ) .",
    "most importantly however , the information remaining in the resampled data at large @xmath4 can be insufficient to construct surrogate contacts .",
    "this happens in particular if an entire class or department is absent from the resampled data or if all the resampled nodes of a class / department are disconnected ( see methods for details ) .",
    "we show in the bottom plots of fig .",
    "[ fig : dist ] the failure rate , i.e. , the fraction of cases in which we are not able to construct surrogate networks from the resampled data . the failure rate increases",
    "gradually with @xmath4 for the invs data since the groups ( departments ) are of different sizes . for the thiers13 data , all classes are of similar sizes so that the failure rate reaches abruptly a large value at a given value of @xmath4 . for the sfhh data",
    ", we can always construct surrogate networks as the population is not structured .",
    "another limitation of the reconstruction method lies in the need to know the number of individuals missing in each department or class .",
    "if these numbers are completely unknown , giving an estimation of outbreak sizes is impossible as adding arbitrary numbers of nodes and links to the resampled data can lead to arbitrarily large epidemics .",
    "the methods are however still usable if only partial information is available . for instance , if only the overall missing number of individuals is available , it is possible to use the wt method , which still gives sensible results .",
    "moreover , if @xmath4 is only approximately known , e.g. , @xmath4 is known to be within an interval of possible values @xmath35 $ ] , it is possible to perform two reconstructions using the respective hypothesis @xmath36 and @xmath37 and to give an interval of estimates .",
    "we provide an example of such procedure in supplementary figure 23 .",
    "the understanding of epidemic spreading phenomena has been vastly improved thanks to the use of data - driven models at different scales .",
    "high resolution contact data in particular have been used to evaluate epidemic risk or containment policies in specific populations or to perform contact tracing @xcite . in such studies ,",
    "missing data due to population sampling might represent however a serious issue : individuals absent from a data set are indeed equivalent to immunised individuals when epidemic processes are simulated . feeding sampled data into data - driven models",
    "can therefore lead to severe underestimations of the epidemic risk and might even a priori affect the evaluation of mitigation strategies if for instance some at - risk groups are particularly undersampled .    here",
    "we have put forward a set of methods to obtain a better evaluation of the outcome of spreading simulations for data - driven models using contact data from a uniformly sampled population . to this aim",
    ", we have shown how it is possible , starting from a data set describing the contacts of only a fraction of the population of interest ( uniformly sampled from the whole population ) , to construct surrogate data sets using various amounts of accessible information , i.e. , quantities measured in the sampled data .",
    "we have shown that the simplest method , which consists in simply compensating for the decrease in the average number of neighbours due to sampling , yields a strong overestimation of the epidemic risk . when additional information describing the group structure and the temporal properties of the data is added in the construction of surrogate data sets , simulations of epidemic spreading on such surrogate data yield results similar to those obtained on the complete data set .",
    "( we note that the issue of how much information should be included when constructing the surrogate data is linked to the general issue of how much information is needed to get an accurate picture of spreading processes on temporal networks @xcite . ) some discrepancies in the epidemic risk estimation are however still observed , due in particular to small scale structural correlations of the contact network that are difficult or even impossible to measure in the resampled data : these discrepancies are indeed largely suppressed if we use as original data a reshuffled contact network in which such correlations are absent .",
    "the methods presented here yield much better results than simulations using resampled data , even when a substantial part of the population is excluded , in particular in estimating the probability of large outbreaks .",
    "it suffers however from limitations , especially when the fraction @xmath4 of excluded individuals is too large .",
    "first , the construction of the surrogate contacts relies on the stability of a set of quantities with respect to resampling , but the measured quantities start to deviate from the original ones at large @xmath4 .",
    "the shape of the distribution of epidemic sizes may then differ substantially from the original one .",
    "second , large values of @xmath4 might even render the construction of the surrogate data impossible due to the loss of information on whole categories of nodes .",
    "finally , at least an estimate of the number of missing individuals in the population is needed in order to create a surrogate data set .",
    "an interesting avenue for future work concerns possible improvements of the reconstruction methods , in particular by integrating into the surrogate data additional information and complex correlation patterns measured in the sampled data .",
    "for instance , the number of contacts varies significantly with the time of day in most contexts : the corresponding activity timeline might be measured in the sampled data ( overall or even for each group of individuals ) , assumed to be robust to sampling and used in the reconstruction of contact timelines .",
    "more systematically , it might also be possible to use the temporal network decomposition technique put forward in @xcite on the sampled data , in order to extract mesostructures such as temporally - localized mixing patterns .",
    "the surrogate contacts could then be built in a way to preserve such patterns .",
    "indeed , correlations between structure and activity in the temporal contact network are known to influence spreading processes @xcite but are notoriously difficult to measure .",
    "if the group structure of the population is unknown , recent approaches based on stochastic block models @xcite might be used to extract groups from the resampled data ; this extracted group structure could then be used to build the corresponding contact matrix and surrogate data sets .",
    "we finally recall that we have assumed an uniform sampling of nodes , corresponding to an independent random choice of each individual of the population to take part or not to the data collection .",
    "other types of sampling or data losses can however also be present in data collected by wearable sensors , such as partial coverage of the premises of interest by the measuring infrastructure , non - uniform sampling depending on individual activity ( too busy persons or , on the contrary , asocial individuals , might not want to wear sensors ) , on group membership , or due to clusters of non - participating individuals ( e.g. , groups of friends ) .",
    "in addition , other types of data sets such as the ones obtained from surveys or diaries correspond to different types of sampling , as each respondent provides then information in the form of an ego - network @xcite .",
    "such data sets involve potentially additional types of biases such as underreporting of the number of contacts and overestimation of contact durations @xcite : how to adapt the methods presented here is an important issue that we will examine in future work .",
    "finally , the population under study is ( usually ) not isolated from the external world , and it would be important to devise ways to include contacts with outsiders in the data and simulations , for instance by using other data sources such as surveys .",
    "the present work is partially supported by the french anr project harms - flu ( anr-12-monu-0018 ) to m.g . and",
    "a.b , by the eu fet project multiplex 317532 to a.b . , c.c . and c.l.v . , by the a*midex project ( anr-11-idex-0001 - 02 ) funded by the `` investissements davenir '' french government program , managed by the french national research agency ( anr ) to a.b . , by the lagrange project of the isi foundation funded by the crt foundation to c.c . , and by the q - aracne project funded by the fondazione compagnia di san paolo to c.c .",
    "a.b . and c.c .",
    "designed and supervised the study . m.g .",
    ", c.l.v . , c.c . , and a.b .",
    "collected and post - processed the data , analyzed the data , carried out computer simulations and prepared the figures .",
    ", c.l.v . ,",
    "c.c . , and a.b .",
    "wrote the manuscript .",
    "the authors declare that no competing financial interests exist .",
    "we consider data sets collected using the sociopatterns proximity sensing platform ( http://www.sociopatterns.org ) based on wearable sensors that detect close face - to - face proximity of individuals wearing them .",
    "informed consent was obtained from all participants and the french national bodies responsible for ethics and privacy , the commission nationale de linformatique et des liberts ( cnil , http://www.cnil.fr ) , approved the data collections .",
    "the high school ( thiers13 ) data set @xcite is structured in 9 classes , forming three subgroups of three classes corresponding to their specialisation in mathematics - physics ( mp , mp@xmath381 , mp@xmath382 with respectively @xmath39 , @xmath40 and @xmath41 students ) , physics ( pc , pc@xmath38 , psi with respectively @xmath42 , @xmath43 and @xmath44 students ) , or biology ( 2bio1 , 2bio2 , 2bio3 with respectively @xmath45 , @xmath46 and @xmath43 students ) .",
    "the workplace ( invs ) data set @xcite is structured in @xmath47 departments : disq ( scientific direction , @xmath48 persons ) , dmct ( department of chronic diseases and traumatisms , @xmath49 persons ) , dse ( department of health and environment , @xmath44 persons ) , srh ( human resources , @xmath50 persons ) and sfle ( logistics , @xmath51 persons ) .    for the conference data ( sfhh )",
    ", we do not have metadata on the participants , and the aggregated network structure was found to be homogeneous @xcite .",
    "simulations of sir and sis processes on the temporal networks of contacts ( original , resampled or reconstructed ) are performed using the temporal gillespie algorithm described in  @xcite . for each run of the simulations ,",
    "all nodes are initially susceptible ; a node is chosen at random as the seed of the epidemic and put in the infectious state at a point in time chosen at random over the duration of the contact data .",
    "a susceptible node in contact with an infectious node becomes infectious at rate @xmath6 .",
    "infectious nodes recover at rate @xmath7 : in the sir model they then enter the recovered state and can not become infectious again , while in the sis model they enter the susceptible state again .",
    "if needed , the sequence of contacts is repeated in the simulation  @xcite .    for sir processes",
    ", we run each simulation , with the seed node chosen at random , until no infectious individual remains ( nodes are thus either still susceptible or have been infected and then recovered ) .",
    "we consider values of @xmath6 and @xmath7 yielding a non - negligible epidemic risk , i.e. , such that a rather large fraction of simulations lead to a final size larger than @xmath52 of the population ( see figs .",
    "[ sampling][fig : infersfhh ] ) : @xmath53 , @xmath54 ( invs ) or @xmath55 ( sfhh and thiers13 ) .",
    "other parameter values are explored in the supplementary information . for each set of parameters ,",
    "the distribution of epidemic sizes is obtained by performing @xmath56 simulations .    for sis processes",
    ", simulations are performed using the quasi - stationary approach of  @xcite .",
    "they are run until the system enters a stationary state as witnessed by the mean number of infected nodes being constant over time .",
    "simulations are then continued for 50,000 time - steps while recording the number of infected nodes . for each set of parameters ,",
    "the simulations are performed once with each node of the network chosen as the seed node .",
    "we consider a population @xmath57 of @xmath27 individuals , potentially organised in groups .",
    "we assume that all the contacts occurring among a subpopulation @xmath58 of these individuals , of size @xmath59 , are known .",
    "this constitutes our resampled data from which we need to construct a surrogate set of contacts concerning the remaining @xmath60 individuals for which no contact information is available : these contacts can occur among these individuals and between them and the members of @xmath58 .",
    "we assume that we know the group of each member of @xmath61 , and the overall activity timeline , i.e. , the intervals during which contacts take place , separated by nights and weekends .",
    "to construct the surrogate data ( wst method ) , we first compute from the activity timeline the total duration @xmath62 of the periods during which contacts can occur .",
    "then , we measure in the sampled data :    * the density @xmath63 of links in the aggregated contact network ; * a row - normalised contact matrix @xmath64 , in which the element @xmath65 gives the probability for a node of group @xmath17 to have a link to a node of group @xmath18 ; * the list @xmath66 of contact durations ; * the lists @xmath67 and @xmath68 of inter - contact durations for internal and external links , _",
    "i.e. _ , for links between nodes of the same group and links between nodes that belong to two different groups , respectively ; * the lists @xmath69 and @xmath70 of numbers of contacts per link , respectively for internal ( within groups ) and external ( between groups ) links ; * the list @xmath71 of initial times between the start of the data set and the first contact between two nodes",
    ".    given @xmath63 , we compute the number @xmath72 of additional links needed to keep the network density constant when we add the @xmath73 excluded nodes .    we then construct each link according to the following procedure :    * a node @xmath1 is randomly chosen from the set @xmath61 of excluded nodes ; * knowing the group @xmath17 that @xmath1 belongs to , we extract at random a target group @xmath18 with probability given by @xmath65 ; * we draw a target node @xmath2 at random from @xmath18 ( if @xmath74 , we take care that @xmath75 ) such that @xmath1 and @xmath2 are not linked ; * depending on whether @xmath1 and @xmath2 belong to the same group or not , we draw from @xmath69 or @xmath70 the number of contact events @xmath76 taking place over the link @xmath77 ; * from @xmath71 , we draw the initial waiting time before the first contact ; * from @xmath66 , we draw @xmath76 contact durations @xmath78 , @xmath79 ; * from @xmath67 or @xmath68 , we draw @xmath80 inter - contact durations @xmath81 , @xmath82 ; * if @xmath83 , we repeat steps ( d ) to ( g ) until we obtain a set of values such that @xmath84 ; * from @xmath85 and the @xmath78 and @xmath81 , we build the contact timeline of the link @xmath77 ; * finally , we insert in the contact timeline the breaks defined by the global activity timeline .",
    "the construction of the surrogate version of the missing links uses as an input the group structure of the subgraph that remains after sampling , as given by the contact matrix of the link densities between the different groups of nodes that are present in the subpopulation @xmath58 . depending on the characteristics of @xmath58 and of the corresponding contacts ,",
    "the construction method can fail in several cases : ( i ) if an entire group ( class / department ) of nodes in the population is absent from @xmath58 ; ( ii ) if the remaining nodes of a specific group ( class / department ) are all isolated in @xmath58 s contact network ; ( iii ) if , during the algorithm , a node of @xmath61 is selected in a certain group @xmath17 but can not create any more links because it already has links to all nodes in the groups @xmath18 such that @xmath86 ; ( iv ) if there are either no internal ( within groups ) or external ( between groups ) links in the contact network of @xmath58 : in this case one of the lists of link temporal characteristics is empty and the corresponding structures can not be reconstructed",
    ".    cases ( i ) and ( ii ) correspond to a complete loss of information about the connectivity of a group ( class / department ) of the population , due to sampling .",
    "it is then impossible to reconstruct a sensible connectivity pattern for these nodes .",
    "case ( iii ) is more subtle and occurs in situations of very low connectivity between groups .",
    "for instance , within the contact network of @xmath57 , a group @xmath17 has links only with another specific group @xmath18 , and both @xmath17 and @xmath18 are small ; it is then possible that the nodes of @xmath87 exhaust the set of possible links to nodes of @xmath18 during the reconstruction algorithm .",
    "if a node of @xmath88 is again chosen to create a link , such a creation is not possible and the construction fails .",
    "case ( iv ) usually corresponds to situations in which the links between individuals of different groups which remain in the resampled data set correspond to pairs of individuals who have had only one contact event : in such cases , @xmath68 is empty and external links with more than one contact can not be built .      in order to test the effect of correlations in the temporal network , we use four shuffling methods , based on the ones defined in @xcite .    link shuffling .",
    "the contact timelines associated with each link are randomly redistributed among the links .",
    "correlations between timelines of links adjacent to a given node are destroyed , as well as correlations between weights and topology .",
    "the structure of the network is kept , as well as the global activity timeline .",
    "time shuffling . from the contact data we build the lists @xmath66 , @xmath89 and @xmath90 of , respectively , contact durations , inter - contact durations and number of contacts per link .",
    "we also measure the list @xmath71 of initial times between the start of the data set and the first contact between two nodes . for each link , we draw randomly a starting time @xmath85 , a number @xmath76 of contacts from @xmath90 , @xmath76 contact durations from @xmath66 and @xmath80 inter - contact durations from @xmath89 , so that the total duration of the timeline does not exceed the total available time @xmath62 .",
    "we then construct the contact timelines , thus destroying the temporal correlations among contacts .",
    "the structure of the network is instead kept fixed .",
    "cm shuffling .",
    "we perform a link rewiring separately on each compartment of the contact matrix , _",
    "i.e. _ , we randomly redistribute links with their contact timelines within each group , and within each pair of groups .",
    "we thus destroy the structural correlations inside each compartment of the contact matrix , while preserving the group structure of the network as given by the link density contact matrix and the contact matrix of total contact times between groups .",
    "cm - time shuffling .",
    "we perform both a cm shuffling and a time shuffling .",
    "10 url # 1`#1`urlprefix[2]#2 [ 2][]#2    , & _",
    "_ ( , ) .    , , , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .    , , , & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al . _ . in _ _",
    "( , , ) .",
    "_ et  al . _ . in _ _ , vol . , ( ) .    , & . _",
    "_ * * , ( ) .",
    ", , & . in _ _ , mswim 10 , ( , , ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    , & . in _ _ , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ et  al .",
    "_ _ * * , ( ) .",
    "_ et  al . _ .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * ( ) .    , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    , , & .",
    "in _ _ , stoc 05 , ( , , ) .    .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , , & ( ) .    , &",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , &",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "& _ _ * * , ( ) .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , ,",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    ", , & ( ) .",
    "( ) .    , & .",
    "_ _ * * , ( ) .",
    ", , & ( ) .    & ( ) .    , & _ _ * * , ( ) .",
    ".[tab : data]*data sets . * for each data set we specify the type of social situation , the number @xmath27 of individuals whose contacts were measured , the corresponding participation rate @xmath91 , the duration @xmath92 and the dates of the data collection . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     * sir epidemic simulations on resampled contact networks .",
    "* we plot the distributions of epidemic sizes ( fraction of recovered individuals ) at the end of sir processes simulated on top of resampled contact networks , for different values of the fraction @xmath4 of nodes removed .",
    "the plot shows the progressive disparition of large epidemic outbreaks as @xmath4 increases .",
    "the parameters of the sir models are @xmath93 and @xmath94 ( invs ) or @xmath95 ( thiers13 and sfhh ) .",
    "the case @xmath96 corresponds to simulations using the whole data set , i.e. , the reference case . for each value of @xmath4 , @xmath56 independent simulations were performed . ]",
    "* sir simulations for the invs ( workplace ) case .",
    "* we compare of the outcome of sir epidemic simulations performed on resampled and reconstructed contact networks , for different methods of reconstruction .",
    "we plot the distribution of epidemic sizes ( fraction of recovered individuals ) at the end of sir processes simulated on top of resampled ( sample ) and reconstructed contact networks , for different values of the fraction @xmath4 of nodes removed , and for the 5 reconstruction methods described in the text ( 0 , w , ws , wt , wst ) .",
    "the parameters of the sir models are @xmath93 and @xmath94 .",
    "the case @xmath96 corresponds to simulations using the whole data set , _",
    "i.e. _ , the reference case . for each value of @xmath4 ,",
    "@xmath56 independent simulations were performed.,scaledwidth=90.0% ]    * sir simulations for the thiers13 ( high school ) case .",
    "* we compare of the outcome of sir epidemic simulations performed on resampled ( top left ) and reconstructed contact networks , for different methods of reconstruction .",
    "we plot the distribution of epidemic sizes ( fraction of recovered individuals ) at the end of sir processes simulated on top of resampled ( sample ) and reconstructed contact networks , for different values of the fraction @xmath4 of nodes removed , and for the 5 reconstruction methods described in the text ( 0 , w , ws , wt , wst ) .",
    "the parameters of the sir models are @xmath93 and @xmath95 .",
    "the case @xmath96 corresponds to simulations using the whole data set , i.e. , the reference case . for each value of @xmath4 ,",
    "@xmath56 independent simulations were performed.,scaledwidth=90.0% ]    * sir simulations for the sfhh ( conference ) case .",
    "* we compare of the outcome of sir epidemic simulations performed on resampled and reconstructed contact networks , for different methods of reconstruction .",
    "we plot the distribution of epidemic sizes ( fraction of recovered individuals ) at the end of sir processes simulated on top of resampled ( sample ) and reconstructed contact networks , for different values of the fraction @xmath4 of nodes removed , and for three reconstruction methods described in the text ( 0 , w , wt ) . in this case , as the population is not structured , methods w and ws on the one hand , wt and wst on the other hand , are equivalent .",
    "the parameters of the sir models are @xmath93 and @xmath95 .",
    "the case @xmath96 corresponds to simulations using the whole data set , i.e. , the reference case . for each value of @xmath4 ,",
    "@xmath56 independent simulations were performed.,scaledwidth=90.0% ]    * accuracy of the different reconstruction methods . *",
    "we perform sir epidemic simulations for each case , for different values of the fraction @xmath4 of missing nodes , for both sampled networks and networks reconstructed with the different methods .",
    "we compare in each case , and as a function of @xmath4 , the fraction of outbreaks that lead to a final fraction of recovered individuals @xmath97 larger than @xmath34 of the population ( a , b ,",
    "c ) , and the average size of these large outbreaks ( d , e , f ) .",
    "the dashed lines give the corresponding values for simulations performed on the complete data sets .",
    "the different methods are : reconstruction conserving only the link density and the average weight of the resampled data ( 0 ) ; reconstruction conserving only the link density and the distribution of weights of the resampled data ( w ) ; reconstruction preserving , in addition to the w method , the group structure of the resampled data ( ws ) ; reconstruction conserving link density , distribution of weights and distributions of contact times , of inter - contact times and of numbers of contacts per link measured in the resampled data ( wt ) ; full method conserving all these properties ( wst ) .",
    "we also plot as a function of @xmath4 the failure rate of the wst algorithm , _",
    "i.e. _ , the percentage of failed reconstructions ( g , h , i ) . for the sfhh case ,",
    "as the population is not structured into groups , methods w and ws are equivalent , as well as methods wt and wst ; moreover , reconstruction is always possible .",
    "the sir parameters are @xmath93 and @xmath94 ( invs ) or @xmath95 ( thiers13 and sfhh ) and each point is averaged over @xmath56 independent simulations . ]    * sis simulations for the invs ( workplace ) case .",
    "* we perform sis epidemic simulations and report the phase diagram of the sis model for the original , resampled and reconstructed contact networks .",
    "each panel shows the stationary value @xmath8 of the prevalence in the stationary state of the sis model , computed as described in methods , as a function of @xmath6 , for several values of @xmath7 .",
    "simulations are performed in each case using either the complete data set ( continuous lines ) , resampled data ( dashed lines ) or reconstructed contact networks using the wst method ( pluses ) .",
    "the fraction of excluded nodes in the resampling is @xmath98 for a , c , e , g and @xmath99 for b , d , f , h. ]    * sir simulations on shuffled data .",
    "* we compare of the outcome of sir epidemic simulations performed on resampled and reconstructed contact networks , for shuffled data .",
    "we plot the distribution of epidemic sizes ( fraction of recovered individuals ) at the end of sir processes simulated on top of either resampled ( a , c , e ) or reconstructed ( b , d , f ) contact networks , for different values of the fraction @xmath4 of nodes removed .",
    "we use here the wst reconstruction method , and the data set considered consists in a cm - shuffled version ( see methods ) of the original data , in which the shuffling procedure removes structural correlations of the contact network within each group .",
    "the parameters of the sir models are @xmath93 and @xmath94 ( invs ) or @xmath95 ( thiers13 and sfhh ) .",
    "the case @xmath96 corresponds to simulations using the whole data set , _",
    "i.e. _ , the reference ( reshuffled data ) case . for each value of @xmath4 ,",
    "@xmath56 independent simulations were performed.,scaledwidth=90.0% ]    * sir simulations for very large numbers of missing nodes .",
    "* we simulate sir processes on reconstructed contact networks for large values of the fraction @xmath4 of removed nodes .",
    "we plot the distributions of epidemic sizes for simulations on reconstructed networks and on the whole data set ( case @xmath96 ) , for large values of the fraction @xmath4 of removed nodes . here",
    "@xmath93 and @xmath94 ( invs ) or @xmath95 ( thiers13 and sfhh ) and @xmath56 simulations were performed for each value of @xmath4 .",
    "the distributions of epidemic sizes for simulations performed on resampled data sets are not shown since at these high values of @xmath4 , almost no epidemics occur . ]",
    "as described in the main text , we consider temporally resolved networks of contacts @xmath100 in a population @xmath57 of @xmath27 individuals and we perform a resampling experiment by selecting a subpopulation @xmath58 of these individuals , of size @xmath59 .",
    "we assume that only the contacts occurring among the subpopulation @xmath58 are known and we compare the properties of the corresponding resampled subnetwork @xmath101 with those of the original network .",
    "supplementary figure [ fig : sampling_network ] shows how population sampling affects several statistical properties of the contact networks .",
    "on the one hand , the degree distribution of the aggregated network of contacts systematically shifts towards smaller degree value .",
    "this is expected as each remaining node has in the resampled network a degree which is at most its degree in the original network , and is strictly smaller if some of its neighbours are not part of the resampled population . on the other hand , the statistical distributions of several quantities of interest",
    "are not affected by sampling : this is the case of the quantities attached either to single contacts or to single links , namely contact and inter - contact durations , number of contacts per link and link weights ( the weight of a link is given by the total duration of the contacts between the two corresponding nodes ) .    moreover , as shown in supplementary figure [ fig : sampling ] , the density of the aggregated network , i.e. the ratio between the number of links and the number of possible links , is on average conserved by the random resampling procedure .",
    "it varies however for different realisations of the resampling , and the corresponding variance increases with the fraction @xmath4 of excluded nodes .",
    "supplementary figure [ fig : clust_trans ] shows how the average clustering coefficient of the aggregated network varies with the resampling : notably , it remains high and close to its original value until large values of @xmath4 are reached .",
    "the transitivity of the network , defined as three times the number of triangles divided by the number of connected triplets ( connected subgraphs of @xmath102 nodes and @xmath103 edges ) , is even less affected than the clustering coefficient by the resampling procedure .    in the case of structured populations , supplementary figures [ fig : cml_sample_invs ] & [ fig : cml_sample_thiers13 ]",
    "show that the stability of the resampled network s density holds at the more detailed level of the contact matrices of link densities . in such matrices , the element @xmath104 is given by the number of links between individuals of groups @xmath1 and @xmath2 , normalised by the total number of possible links between these two groups ( if @xmath105 denotes the number of individuals in group @xmath1 , the number of possible links is equal to @xmath106 for @xmath107 and to @xmath108 for @xmath109 ) .",
    "these figures clearly illustrate how the diagonal and block - diagonal structures are preserved , and supplementary figure [ fig : sampling ] gives a quantitative assessment of this stability by showing that the cosine similarity between contact matrices between the resampled and original aggregated contact networks remains high even for when a large fraction of the nodes are excluded .",
    "we moreover illustrate in supplementary figures [ fig : int_ext_invs ] and [ fig : int_ext_thiers ] the difference in statistical properties of contacts and links within and between groups , still for structured populations :    * the distributions of contact durations are indistinguishable ; * the distribution of link weights ( aggregated contact durations ) is broader for links between individuals belonging to the same group than for links joining individuals of different groups ; * this is due to the difference in the distributions of numbers of contacts per link , which is broader for links within groups than for links between groups ; * the distributions of inter - contact durations differ also slightly , with smaller averages for within - group links .    most importantly ,",
    "all these properties and distributions remain stable under resampling , showing that reliable information on the distributions of contact and inter - contact durations , aggregated contact durations , numbers of contacts per link , can be obtained in the resampled data , including the statistical differences between links joining members of different groups and links between two individuals of the same group .",
    "as described in the main text and in particular in the methods section , we construct a surrogate set of contacts concerning the @xmath110 individuals excluded by the resampling .",
    "we compare here the properties of the resulting contact networks ( obtained by merging the resampled contact network @xmath101 and the surrogate set of contacts ) and of the original contact network , @xmath100 .",
    "supplementary figure [ fig : infer_network ] shows that the degree distribution , which is not constrained by the reconstruction procedure , deviates from the original distribution . on the other hand , the distributions of contact durations , inter - contact durations , number of contacts per link and link weights are preserved .",
    "moreover , the link density contact matrices of the reconstructed networks ( supplementary figure [ fig : cml_infer_invs ] & [ fig : cml_infer_thiers13 ] ) share a high similarity with the original contact matrices , even for high fractions of nodes excluded ( supplementary figure [ fig : simcm ] ) .    for completeness",
    ", we also compute the contact matrices in contact time density ( cmt ) , in which each element @xmath104 is given by the total time in contact between individuals of groups @xmath1 and @xmath2 , normalised by the total number of possible links between these two groups : it gives the average time spent in contact by two random individuals of groups @xmath1 and @xmath2 .",
    "supplementary figures [ fig : simcm ] , [ fig : cmt_infer_invs ] and [ fig : cmt_infer_thiers13 ] show that the structure of these matrices is well recovered by the reconstruction methods , with high similarity with the original matrices .",
    "we observe for the high school and the conference the same effect on the phase diagram of the sis model as in the workplace : sampling leads to a shift of the epidemic threshold to higher values and thus to an underestimation of the epidemic risk .",
    "the phase diagram and the epidemic threshold are estimated more accurately by using reconstructed networks , thus giving a better evaluation of the epidemic risk ( supplementary figures [ fig : sis_thiers ] & [ fig : sis_sfhh ] ) .      in the main text ,",
    "we have considered values of the sir model parameters leading to a non - negligible epidemic risk and a value of @xmath6 corresponding to slow processes .",
    "we consider here several other values of the parameters , corresponding either to faster processes ( supplementary figures [ fig : beta.004 ] - [ fig : beta.04_large ] ) or to smaller epidemic risk ( supplementary figure [ fig : beta.004_small ] ) .",
    "in all cases , simulations performed on the resampled contact networks lead to a strong underestimation of the epidemic sizes , with distributions shifting to smaller values as @xmath4 increases , while the use of reconstructed data sets leads to a better estimation and generally speaking a slight overestimation of the epidemic risk .",
    "we give here details on the alternative reconstruction methods mentioned in the main text , which use less information than the * wst * method . in each case",
    "we consider the same setup as the complete method : a population @xmath57 of @xmath27 individuals ( the nodes of the contact network ) , potentially organised in groups , for which we know all the contacts taking place among a subpopulation @xmath58 of size @xmath59 . for the remaining @xmath60 individuals ,",
    "no contact information is available , but we know to which group they belong .",
    "we also have access to the overall activity timeline , _",
    "i.e. _ , to the successive intervals during which contacts can happen ( daytimes ) , and are excluded ( nights and weekends ) .",
    "the alternative reconstruction methods are the following :    0 : :    we perform the reconstruction using only the network density and the    average link weight , both measured in the resampled network    @xmath101 .",
    "the algorithm goes as follows :    +    1 .",
    "we measure in the resampled data :    * the density @xmath63 of links in the time - aggregated    network ;    * the average link weight @xmath29 ( the    weight of a link is defined as the total contact time between the two    linked nodes ) ;    2 .",
    "we compute the number of links @xmath72 that must be added    to keep the network density constant when we add the @xmath73    excluded nodes ;    3 .",
    "we construct @xmath72 links according to the following    procedure :    * a node @xmath1 is randomly chosen from the set    @xmath61 of excluded nodes ;    * a node @xmath2 is randomly chosen from the set    @xmath111 of all other nodes ;    * we compute    @xmath112 , where    @xmath113 is the temporal resolution of the data set ,    and we randomly choose @xmath114 time windows of length    @xmath115 within the activity windows defined by the    activity timeline as contact events between @xmath1 and    @xmath2 .",
    "w : :    we perform the reconstruction using only the network density and the    distribution of link weights , both measured in the resampled network    @xmath101 .",
    "the algorithm goes as follows :    +    1 .",
    "we measure in the resampled data :    * the density @xmath63 of links in the time - aggregated    network ;    * the list @xmath31 of link weights ( the weight of a link    is defined as the total contact time between the two linked nodes ) ;    2 .",
    "we compute the number of links @xmath72 that must be added    to keep the network density constant when we add the @xmath73    excluded nodes ;    3 .",
    "we construct @xmath72 links according to the following    procedure :    * a node @xmath1 is randomly chosen from the set    @xmath61 of excluded nodes ;    * a node @xmath2 is randomly chosen from the set    @xmath111 of all other nodes ;    * from @xmath31 , we draw the weight @xmath116 of    the link @xmath77 ;    * we compute @xmath117 , where    @xmath113 is the temporal resolution of the data set ,    and we randomly choose @xmath114 time windows of length    @xmath115 within the activity windows defined by the    activity timeline as contact events between @xmath1 and    @xmath2 .",
    "ws : :    we perform the reconstruction using the network density , the    distributions of link weights for internal ( within groups ) and    external ( between groups ) links , and the structure of the aggregated    network given by the link density contact matrix , all measured in the    resampled network @xmath101 .",
    "the algorithm goes    as follows :    +    1 .",
    "we measure in the resampled data :    * the density @xmath63 of links in the time - aggregated    network ;    * a _ row - normalised _",
    "contact matrix @xmath64 , in which the    element @xmath65 gives the probability for a node in    group @xmath17 to have a link to a node of group    @xmath18 ;    * the lists @xmath32 and    @xmath33 of link weights for respectively    internal and external links",
    "( internal links are links between nodes    that belong to the same group , external links are links between nodes    from different groups ) ;    2 .",
    "we compute the number of links @xmath72 that must be added    to keep the network density constant when we add the @xmath73    excluded nodes ;    3 .",
    "we construct @xmath72 links according to the following    procedure :    * a node @xmath1 is randomly chosen from the set    @xmath61 of excluded nodes ;    * knowing the group @xmath17 that @xmath1 belongs to ,    we extract at random a target group @xmath18 with probability    given by @xmath65 ;    * we draw a target node @xmath2 at random from @xmath18    ( if @xmath74 , we check that @xmath118 ) ;    * depending on whether nodes @xmath1 and @xmath2    belong to the same group or not , we draw from    @xmath32 or @xmath33 the    weight @xmath116 of the link @xmath77 ;    * as for the @xmath119 method , we extract at random    @xmath120 contact events of length    @xmath113 within the activity timeline .",
    "wt : :    we perform the reconstruction using the network density , the    distribution of link weights and the temporal structure of the    contacts given by the distributions of contact durations ,    inter - contact durations , number of contacts per link and initial    waiting times before the first contact , all measured in the resampled    network @xmath101 .",
    "the algorithm goes as follows :    +    1 .",
    "we compute from the activity timeline the time    @xmath62 as the total duration of the periods during    which contacts can occur .    2 .",
    "we measure in the resampled data :    * the density @xmath63 of links in the time - aggregated    network ;    * the list @xmath66 of contact durations ;    * the list @xmath89 of inter - contact durations ;    * the list @xmath90 of numbers of contacts per link ;    * the list @xmath71 of initial waiting times before the    first contact for each link ;    3 .",
    "we compute the number of links @xmath72 that must be added    to keep the network density constant when we add the @xmath73    excluded nodes ;    4 .",
    "we construct @xmath72 links according to the following    procedure :    1 .",
    "a node @xmath1 is randomly chosen from the set    @xmath61 of excluded nodes ;    2 .",
    "a node @xmath2 is randomly chosen from the set    @xmath111 of all other nodes ;    3 .",
    "we draw from @xmath90 the number of contact events    @xmath76 taking place over the link @xmath77 ;    4 .   from @xmath71 ,",
    "we draw the initial waiting time    @xmath85 before the first contact ;    5 .   from @xmath66 ,",
    "we draw @xmath76    contact durations @xmath78 ,    @xmath79 ;    6 .   from @xmath89 , we draw @xmath80    inter - contact durations @xmath81 ,    @xmath82 ;    7 .   while    @xmath83 ,    we repeat steps ( c ) to ( f ) ;    8 .   from @xmath85,the @xmath78 and    @xmath81",
    ", we build the contact timeline of the    link @xmath77 ;    9 .   finally , we insert in the contact timeline the breaks defined by    the activity timeline .        1",
    ".   we measure in the resampled data the transitivity @xmath121 of the time - aggregated network ; 2 .   for the construction of each link of a node @xmath1 : * we calculate the current transitivity @xmath122 of the network ; * we list the potential targets @xmath2 in two lists @xmath123 and @xmath124 , depending on whether the creation of a link between @xmath1 and @xmath2 would close a triangle or not ; * * * if @xmath125 , we draw a target node @xmath2 at random from @xmath123 such that @xmath1 and @xmath2 are not linked ; * * else if @xmath126 , we draw a target node @xmath2 at random from @xmath124 such that @xmath1 and @xmath2 are not linked ."
  ],
  "abstract_text": [
    "<S> data describing human interactions often suffer from incomplete sampling of the underlying population . as a consequence , </S>",
    "<S> the study of contagion processes using data - driven models can lead to a severe underestimation of the epidemic risk . here </S>",
    "<S> we present a systematic method to alleviate this issue and obtain a better estimation of the risk in the context of epidemic models informed by high - resolution time - resolved contact data . </S>",
    "<S> we consider several such data sets collected in various contexts and perform controlled resampling experiments . </S>",
    "<S> we show how the statistical information contained in the resampled data can be used to build a series of surrogate versions of the unknown contacts . </S>",
    "<S> we simulate epidemic processes on the resulting reconstructed data sets and show that it is possible to obtain good estimates of the outcome of simulations performed using the complete data set . </S>",
    "<S> we discuss limitations and potential improvements of our method .    </S>",
    "<S> human interactions play an important role in determining the potential transmission routes of infectious diseases and other contagion phenomena  @xcite . </S>",
    "<S> their measure and characterisation thus represent an invaluable contribution to the study of transmissible diseases @xcite . </S>",
    "<S> while surveys and diaries in which volunteer participants record their encounters @xcite have provided crucial insights ( see however @xcite for recent investigations of the memory biases inherent in self - reporting procedures ) , new approaches have recently emerged to measure contact patterns between individuals with high resolution , using wearable sensors that can detect the proximity of other similar devices @xcite . </S>",
    "<S> the resulting measuring infrastructures register contacts specifically within the closed population formed by the participants wearing sensors , with typically high spatial and temporal resolutions . in the recent years </S>",
    "<S> , several data gathering efforts have used such methods to obtain , analyse and publish data sets describing the contact patterns between individuals in various contexts in the form of temporal networks @xcite : nodes represent individuals and , at each time step , a link is drawn between pairs of individuals who are in contact @xcite . </S>",
    "<S> such data has been used to inform models of epidemic spreading phenomena used to evaluate epidemic risks and mitigation strategies in specific , size - limited contexts such as schools or hospitals @xcite , finding in particular outcomes consistent with observed outbreak data @xcite or providing evidence of links between specific contacts and transmission events @xcite .    </S>",
    "<S> despite the relevance and interest of such detailed data sets , as illustrated by these recent investigations , they suffer from the intrinsic limitation of the data gathering method : contacts are registered only between participants wearing sensors . </S>",
    "<S> contacts with and between individuals who do not wear sensors are thus missed . in other words , as most often not all individuals accept to participate by wearing sensors , many data sets obtained by such techniques suffer from population sampling , despite efforts to maximise participation through e.g. scientific engagement of participants @xcite . </S>",
    "<S> hence , the collected data only contains information on contacts occurring among a fraction of the population under study .    </S>",
    "<S> population sampling is well - known to affect the properties of static networks @xcite : various statistical properties and mixing patterns of the contact network of a fraction of the population of interest may differ from those of the whole population , even if the sampling is uniform @xcite , and several works have focused on inferring network statistics from the knowledge of incomplete network data @xcite . </S>",
    "<S> both structural and temporal properties of time - varying networks might as well be affected by missing data effects @xcite .    </S>",
    "<S> in addition , a crucial though little studied consequence of such missing data is that simulations of dynamical processes in data - driven models can be affected if incomplete data are used @xcite . </S>",
    "<S> for instance , in simulations of epidemic spreading , excluded nodes are by definition unreachable and thus equivalent to immunised nodes . due to herd vaccination effects , the outcome of simulations of epidemic models on sampled networks is thus expected to be underestimated with respect to simulations on the whole network . </S>",
    "<S> ( we note however , that in the different context of transportation networks , it was found in @xcite that the inclusion of the most important transportation nodes can be sufficient to describe the global worldwide spread of influenza - like illnesses , at least in terms of times of arrival of the spread in various cities . ) how to estimate the outcome of dynamical processes on contact networks using incomplete data remains an open question .    here </S>",
    "<S> we make progresses on this issue for incompletely sampled data describing networks of human face - to - face interactions , collected by infrastructures based on sensors , under the assumption that the population participating to the data collection is a uniform random sample of the whole population of interest . </S>",
    "<S> ( we do not therefore address here the issue of non - uniform sampling of contacts that may result from other measurement methods such as diaries or surveys . ) </S>",
    "<S> we proceed through resampling experiments on empirical data sets in which we exclude uniformly at random a fraction of the individuals ( nodes of the contact network ) . </S>",
    "<S> we measure how relevant network statistics vary under such uniform resampling and confirm that , although some crucial properties are stable , numerical simulations of spreading processes performed using incomplete data lead to strong underestimations of the epidemic risk . </S>",
    "<S> our goal and main contribution consists then in putting forward and comparing a hierarchy of systematic methods to provide better estimates of the outcome of models of epidemic spread in the whole population under study . to this aim </S>",
    "<S> , we do not try to infer the true sequence of missing contacts . </S>",
    "<S> instead , the methods we present consist in the construction of surrogate contact sequences for the excluded nodes , using only structural and temporal information available in the resampled contact data . we perform simulations of spreading processes on the reconstructed data sets , obtained by the union of the resampled and surrogate contacts , and </S>",
    "<S> investigate how their outcomes vary depending on the amount of information included in the reconstruction method . </S>",
    "<S> we show that it is possible to obtain outcomes close to the results obtained on the complete data set , while , as mentioned above , using only the incomplete data severely underestimates the epidemic risk . </S>",
    "<S> we show the efficiency of our procedure using three data sets collected in widely different contexts and representative of very different population structures found in day - to - day life : a scientific conference , a high school and a workplace . </S>",
    "<S> we finally discuss the limitations of our method in terms of sampling range , model parameters and population sizes . </S>"
  ]
}