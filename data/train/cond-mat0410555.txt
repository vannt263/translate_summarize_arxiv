{
  "article_text": [
    "the issue of galilean invariance for lattice boltzmann methods , and in particular for non - ideal fluid simulations based on an input pressure tensor@xcite , has received considerable attention in the past@xcite .",
    "it was noticed that these methods had a severe problems with galilean invariance and careful expansion methods elucidated a set of correction terms for the pressure tensor to improve galilean invariance .",
    "the attraction of methods based on an input pressure tensor is that this pressure tensor can be easily derived from an input free energy .",
    "this immediately delivers predictions for the phase - diagram , the interface profiles and the surface tension .",
    "others held that the problem lay deeper , and that it was inappropriate to include the non - ideal terms for the method in an input pressure tensor , and that it is appropriate to put the non - ideal terms in a vlasov - like forcing term@xcite .",
    "unfortunately , it has been difficult to relate the approach by shan and chen@xcite to a free energy .",
    "meanwhile others have taken to use a forcing term that corresponds to the divergence of the pressure tensor@xcite .",
    "this should , in principle , lead to an equivalent model to the pressure tensor approach .",
    "we will show later , that there are subtle differences though . on the up - side , using a forcing approach does not require similar correction terms to the pressure tensor approach , and therefore it has been labeled `` galilean invariant '' .",
    "recently we have been working on including lees - edwards - like boundary conditions in lattice boltzmann @xcite to simulate sheared systems .",
    "it turns out that these boundary conditions are very sensitive to galilean invariance violations .",
    "none of the above methods seemed to show a sufficient level of galilean invariance which lead us to this closer investigation of the origins of galilean invariance in lattice boltzmann methods .    in a lattice",
    "based method the lattice represents a fixed reference frame , and it is not surprising that this should show up to some order .",
    "so we measured the error for a variety of situations and tried to quantify the main contribution .",
    "we found that the well known @xmath0 term in the taylor expansion of the momentum equations , which is usually neglected , is responsible for the majority of the error .",
    "we then demonstrate how including an additional correction term can significantly increase the galilean invariance of lattice boltzmann methods .",
    "we can write the lattice boltzmann method in a general way that neatly separates the ideal gas contributions from the non - ideal contributions . to do this we write @xmath1 where @xmath2 is the contribution function for an ideal gas , the @xmath3 are the contributions of a forcing term and the @xmath4 allow us to manipulate the pressure tensor . as usual",
    "the moments for the ideal - gas distribution function are @xmath5 where @xmath6 is the mass density , @xmath7 is the mean fluid velocity before the action of the forcing term @xmath3 .",
    "the velocity of sound is given by @xmath8 .",
    "for all models with @xmath9 ( like d1q3 , d2q7 , d2q9 , d3q15 , d3q19 or d3q27 ) we have @xmath10 which means that",
    "_ e.g. _ @xmath11 making a correction term @xmath12 necessary for the third moment .",
    "one usually chooses @xmath13 .",
    "it is this term that will lead to the leading galilean invariance problems .    to simulate fluids with a non - ideal equation of state we can introduce either a forcing term @xmath3 with the moments @xmath14 or a pressure term @xmath4 with the moments @xmath15 here",
    "@xmath16 is a forcing term and @xmath17 is a pressure term .",
    "we will see below how these terms can be used to introduce non - ideal terms into the equation of state or simply to correct the above mentioned deficiencies of the velocity set .",
    "the knowledge of these moments is sufficient to perform a taylor expansion ( or equivalently a chapman enskog multi - scale expansion ) of equation ( [ lb ] ) .",
    "if we define the macroscopic velocity @xmath18 as @xmath19 we obtain the continuity equation @xmath20 and a momentum conservation equation @xmath21 \\label{ns}\\\\ & & - \\nu \\partial_\\beta [ u_\\alpha \\partial_\\gamma a_{\\beta \\gamma } + u_\\beta \\partial_\\gamma a_{\\alpha \\gamma}+ \\partial_\\rho a_{\\alpha \\beta } \\partial_\\gamma ( \\rho u_\\gamma)+\\partial_\\gamma q_{\\alpha \\beta \\gamma } ] \\nonumber\\end{aligned}\\ ] ] where the kinematic viscosity is @xmath22 .",
    "this equation is the navier - stokes equation , except for the terms in the last line .",
    "the condition of galilean invariance requires that a description in a reference frame @xmath23 another reference frame @xmath24 translating with a constant velocity @xmath25 be related by a spatial coordinate transformation @xmath26 and a translation of velocities @xmath27 .",
    "it is easy to see that only the terms in the last line of eqn .",
    "( [ ns ] ) are not galilean invariant .",
    "let us first consider ( [ ns ] ) for an ideal gas . in this case @xmath28 and @xmath29 so the only non - galilean invariant term to second order is @xmath12 .",
    "we can eliminate this error term by introducing a well crafted forcing term of the form @xmath30 we should mention here that we can avoid this problem and choose @xmath31 if we use a velocity set that is large enough@xcite .",
    "but for now we want to stay with the standard velocity sets .    to simulate a non - ideal system we want to obtain a pressure term in the first line of ( [ ns ] ) that is the divergence of a pressure tensor derived from thermodynamics .",
    "in particular we need @xmath32 to first order . for the forcing approach",
    "we choose @xmath29 and this equation defines @xmath33 .",
    "we will refer to this approach as `` forcing '' in our comparisons . to improve galilean invariance for this approach",
    "we can add the same additional forcing term ( [ corr ] ) to restore galilean invariance to second order .",
    "this approach we will refer to as `` forcingq '' .    if we chose to introduce the non - ideal term in @xmath17 we can recover the algorithm of swift _ _ et al.__@xcite .",
    "this corresponds to choosing @xmath34 and @xmath28 .",
    "we refer to this approach in the following as `` pressure '' .",
    "this approach is deficient in as much as the correction terms in the third line in ( [ ns ] ) are unphysical and will lead to severely non - galilean invariant behavior .",
    "this problem was addressed by holdych _ _ et al.__@xcite and independently by inamuro _ _ et al.__@xcite .",
    "because the divergence of the pressure tensor is small to first order , the main contribution to the error terms comes from the density alone .",
    "therefore choosing @xmath35 will only leave error terms of the order @xmath36 which can be assumed to be small in systems close to equilibrium .",
    "this approach will be referred to as `` holdych '' .",
    "the restriction of being close to equilibrium was late revisited by kalarakis _ _ et al.__@xcite who suggested an improvement to these corrections",
    ".    however , the holdych approach as well as all other later approaches are still deficient in that they do not correct the q term .",
    "clearly there is a multitude of possible combinations of choices for @xmath17 and @xmath33 that will lead to a galilean invariant form of eqn .",
    "( [ ns ] ) .",
    "one other choice we examined is @xmath37\\}.\\end{aligned}\\ ] ] which has in common with the kalarakis@xcite approach that it is not limited to systems close to equilibrium .",
    "the above choice leads to a galilean invariant momentum equation given by @xmath38 \\label{ns2}\\end{aligned}\\ ] ] this scheme has a tensorial interface viscosity .",
    "we refer to the resulting method as `` pressureq '' .",
    "for simplicity we will consider a non - ideal gas with a @xmath39-free energy@xcite .",
    "for such a system we can calculate the phase diagram and the surface tension analytically , simplifying the analysis .    for a critical density @xmath40 , critical temperature @xmath41 and critical pressure @xmath42 we obtain for the pressure tensor @xmath43\\delta_{\\alpha \\beta } + \\kappa\\partial_\\alpha \\rho\\partial_\\beta \\rho\\ ] ] where @xmath44 is the reduced density and",
    "@xmath45 is the reduced temperature , where @xmath46 is an arbitrary constant .",
    "the equilibrium values for the density are given by @xmath47 the definition of the pressure tensor is all that is needed to define the lattice boltzmann methods for non - ideal fluids as we explained in section [ seclb ] .",
    "we performed simulations of an equilibrium system containing one domain of gas and one of liquid at different imposed velocities .",
    "as mentioned above , while the different approaches are very similar as far as the expansion to second order is concerned , there are noticeable differences in the behavior of the methods .",
    "firstly let us compare the numerical results for the phase - diagram shown in figure [ phasediagram ] .",
    "on the one hand we notice that the ability of the pressure based methods to reproduce the analytical phase - diagram is noticeably better than the corresponding forcing method .",
    "on the other hand we we see that the range of stability for the forcing method is larger , leading to a larger maximum density ratio ( of about six ) which can be simulated with this method .",
    "next we examine the effect of an imposed velocity on the equilibrium densities . in figure [ figdev ]",
    "we show the deviation of the predicted liquid - gas density difference from the measured one .",
    "we notice that the original pressure method has excessive deviations even for small @xmath48 .",
    "we were surprised to see that in these simulations the gas and liquid domains were actually stationary , even with an imposed velocity @xmath25 .",
    "the domains made up for the imposed velocity by evaporation and condensation mechanisms and a faster velocity in the gas than in the fluid .",
    "we see that the error is generally less for the corrected pressure methods than for the forcing methods .",
    "we were very surprised to see that the @xmath12 corrections did not only improve that galilean invariance of the method , they substantially increased the range of stability .",
    "this is true both for the range of stable velocities @xmath25 as well as the accessible density ratios ( even at @xmath49 .",
    "this was an unexpected benefit of our study and we still do not understand why the correction term has such beneficial effects on the stability .",
    "we now need to quantify the galilean invariance error for the advection of an interface profile . for the velocity",
    "the analytical solution is a constant , so we can define an error function @xmath50 this measure is effectively time independent , as is appropriate for this equilibrium consideration .    in figure [ figphasegal ]",
    "we show the galilean invariance error @xmath51 for the different methods we described .",
    "as mentioned above the original pressure approach performs very poorly , in fact refusing to advect the domains relative to the lattice .",
    "the holdych approach improves on this significantly leading to an advection of the profile .",
    "we were surprised by the non - monotonic behavior of the error , leading to a minimum at @xmath52 .",
    "we will come back to this later . adding the @xmath12 correction to the holdych approach leads to a noticeable improvement for velocities as small as @xmath53 .",
    "the forcing approach leads to a good behavior at small @xmath25 but increases rapidly with @xmath25 .",
    "its behavior is significantly improved for @xmath54 by including the @xmath12 correction in the in the method .",
    "when interpreting the above results , it is important to remember that the parameter space for the galilean invariance problem includes not only @xmath25 but also the parameters determining the equilibrium density profile @xmath55 , @xmath56 and @xmath42 as well as the relaxation time @xmath57 .",
    "this parameter space is so large as to make it nearly impossible to examine it exhaustively .",
    "but we want to discuss at least the dependence on @xmath55 , which is related to the interface width and the surface tension .",
    "it is also important to look at this when one wants to fairly compare the pressure an forcing approaches .",
    "it turns out that while the pressure approach reproduces the analytical interface profile fairly , the forcing approach does not , at least not for the nominal value of @xmath55 .",
    "the forcing approach leads to a much wider interface so that it would be fairer to compare the forcing approach to a pressure approach with a larger @xmath55 . in figure [ figkappadep ]",
    "we can see that this matters a lot .",
    "the galilean invariance error @xmath58 is largest for small values of @xmath55 corresponding to thin interfaces . and for small values of @xmath55 this absolute error decreases much slower with decreasing @xmath25 .",
    "this is probably the reason that the pressure approach performed much worse than the forcing approach ( with the same nominal @xmath55 value ) for small @xmath25 .",
    "a close examination of fig [ figkappadep ] also shows that the non - monotonic behavior of @xmath59 is related to the small @xmath55 behavior .",
    "the graph suggests that the error function becomes monotonic for large @xmath55 .",
    "we have shown that the usually neglected error term in the navier stokes level momentum equation derived for standard lattice boltzmann methods leads to noticeable galilean invariance violations .",
    "these violations are noticeable even in the range of usual velocities of @xmath60 , but become dominant for larger velocities .",
    "a carefully defined forcing term can remove the non - galilean invariant terms recovering the navier stokes equation .",
    "we have shown that this approach is also effective in practice , reducing the galilean invariance error substantially .",
    "the correction term also had the added benefit of increasing the range of stability for the multi - phase applications , leading to a larger range of stable velocities and even , perhaps surprisingly , to a larger range of density ratios that can be simulated by the methods .    99 m.s.swift,w.r.osborn ,",
    "lett . _ * 75 * , 830 ( 1995 ) .",
    "holdych , d .",
    "rovas , j.g .",
    "georgiadis , and r.o .",
    "buchius , _ int .",
    "j. of mod .",
    "c _ * 9 * , 1393 ( 1998 ) .",
    "t. inamuro , n. konishi , f.ogino , _ comp .",
    "_ * 129 * , 32 ( 2000 ) .",
    "kalarakis , v.n .",
    "burganos , and a.c .",
    "payatakes , _ phys",
    "e _ * 65 * , 056702 ( 2002 ) .",
    "x. shan , h .",
    "e__**49 * * , 2941(1994 ) .",
    "luo , _ phys .",
    "e _ * 62 * , 4982 ( 2000 ) , l .- s .",
    "luo , _ phys .",
    "e _ * 62 * , 4982 ( 2002 ) . y .-",
    "h . qian , y. zhou , _ icase report no.98 - 38 _ , nasa / cr-1998 - 208701(1998 ) .",
    "briant , a.j .",
    "wagner , and j.m .",
    "yeomans , _ phys . rev .",
    "e _ * 69 * , 031602 ( 2004 ) .",
    "wagner and i. pagonabarraga , _ j. stat .",
    "phys . _ * 107 * , 521 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> we examine the galilean invariance of standard lattice boltzmann methods for two - phase fluids . </S>",
    "<S> we show that the known galilean invariant term that is cubic in the velocities , and is usually neglected , is the main source of galilean invariance violations . </S>",
    "<S> we show that incorporating a correction term can improve the galilean invariance of the method by up to an order of magnitude . </S>",
    "<S> surprisingly incorporating this correction term can also noticeably increase the range of stability for multi - phase algorithms . </S>",
    "<S> we found that this is true for methods in which the non - ideality is incorporated by a forcing term as well as methods in which non - ideality is directly incorporated in a non - ideal pressure tensor .    </S>",
    "<S> lattice boltzmann , liquid - gas , galilean invariance . </S>"
  ]
}