{
  "article_text": [
    "evolution is naturally a multiscale phenomenon  @xcite .",
    "the choice of right scale to describe a particular problem has as much art as science . for some populations ( e.g , with non overlapping generations )",
    "a discrete time provides adequate description ; for different examples , this is excessively simplifying .",
    "large populations can be described as infinite ( in order to use differential equations , for example ) , but this imposes limitations in the time validity of the model  @xcite . on the other hand , some finite population effects , like , for example , the bottleneck effect ,",
    "will be missing in any description relying in infinite populations  @xcite .    in this vein ,",
    "diffusion approximations , frequently used for large populations and long time scales , enjoy a long tradition in population genetics .",
    "this tradition dates back as early as the work by @xcite and references there in . in particular , diffusion approximations were implicitly used in the pioneering works of @xcite and @xcite .",
    "these efforts have been further developed in a number of directions as , for instance , in the studies on multispecies models in @xcite ; see also the review in @xcite .",
    "subsequently , @xcite systematically studied the approximation of finite markov chain models by diffusions .",
    "in particular , they showed the validity of a diffusion approximation to a multidimensional wright - fisher model , in the regime of weak selection , and linear fitness .",
    "this led to a notable progress in diffusion theory , as reported for instance in @xcite .",
    "this considerable progress , in turn , led to a large use of diffusion theory in population genetics , which can be verified in contemporary introductions to the subject  ( see * ? ? ?",
    "* ; * ? ? ?",
    "there is also a more heuristic approach , called the kramers - moyal expansion , where the kernel of the master equation of the stochastic process is fully expanded in a series .",
    "the diffusion approximation can be viewed as a kramers - moyal expansion truncated at second order . although it is commonly claimed that the full expansion is needed in order to obtain a continuous approximation of discrete processes , it is known that under various conditions discrete markov chains can be approximated by diffusions",
    "@xcite and @xcite for instance . in this work",
    ", we shall show that under a number of conditions similar results hold for the discrete processes considered .",
    "see  @xcite for a discussion about this and other techniques for continuous approximations of discrete processes .",
    "as observed above , results along similar lines had been obtained earlier by a number of authors @xcite .",
    "these works approach the problem mostly within a probabilistic framework , while here we take a pure analytical setting , and this brings two immediate consequences : firstly , we are able to directly derive a weak formulation for the forward kolmogorov equation , assuming only continuity of the fitness functions in contrast to the weak formulation for the backward problem for feller processes ; see  @xcite .",
    "the second , and possibly most important consequence , is that we are able to deal with a variety of scalings for the evolution problem .",
    "this yields a full family of evolution problems : genetic - drift dominated evolution , which is described by a diffusion equation ; selection dominated evolution , which is governed by a hyperbolic equation ; and an evolutionary dynamics , where the two forces are balanced , which is governed by a convection - diffusion equation that we term replicator - diffusion .    if we assume some more regularity of the fitness functions , we can then recast the weak formulation in a strong formulation . in this case , we can not impose any boundary conditions , but we must supplement it by a number of conservation laws , namely that the probability of fixation of each type for a given probability density of population , in any time , must be the same as in the initial time .",
    "the conservation laws are used to circumvent the impossibility of imposing boundary conditions when the boundaries are absorbing .",
    "furthermore , by a duality argument we obtain the backward equation formulation .",
    "for the particular case of linear fitness and balanced scalings , we then recover the classical result by @xcite . additionally , by an appropriate combination of the weak and strong formulations , we are able to give a complete description of the forward solution .    a complimentary approach to the study of evolution , based on evolutionary game theory , has also been developed ( cf . * ? ? ?",
    "* ) with conclusions that are not always compatible with results from diffusion theory .",
    "as an example , diffusion models without mutation lead to the fixation of a homogeneous population , while frequency dependent models associated to the replicator dynamics may lead to stable mixed populations .",
    "for an introduction to evolutionary game theory and replicator dynamics , we refer the reader to @xcite and @xcite .",
    "the replicator equation was also modified to introduce stochasticity at population level  @xcite .",
    "relations between the matching scheme in a population and the deterministic approximation of its stochastic evolution are studied in  @xcite .",
    "consistent interaction among these two modelling schools have been attempted by a number of authors , with different degrees of success  ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we will show , as in many of these works , that both descriptions  the one based on the diffusion approximation and the one based on the replicator dynamics  are correct as models for the evolutionary dynamics of a given trait , but in different scalings .",
    "as a by product , we will provide a generalisation of the kimura equation valid for an arbitrary number of types and general fitness functions .",
    "the long time asymptotics of both descriptions will suggest that the replicator equation is a model with limited time validity , given a certain maximum admissible error .",
    "such a limitation is to be naturally anticipated on the grounds that the diffusion process will be eventually absorbed , while the replication dynamics might converge to an equilibrium in the interior .",
    "we also confirm that the solution of the replicator equation indicates the most probable state ( mode ) of the population , conditional on not have been absorbed .",
    "hence , it does not necessarily indicate the expected value of the trait .",
    "the work presented here is a development of earlier work in @xcite : the former studying the derivation and convergence of the moran model with two types to the 1-d version of the replicator - diffusion equation discussed here , and the latter with a comprehensive analytical study of the 1-d replicator - diffusion equation .",
    "the derivation of the continuous model in @xcite hinged on the idea that a formal expansion of master equation , but with control of the local error , and results on well - posedness of the continuous classical problem can be brought together via numerical analysis approximation results .",
    "this combination then yielded uniform convergence , in any proper closed sub interval of [ 0,1 ] , of the rescaled probabilities of the discrete model to the continuous probability density .",
    "this convergence result , combined with the analytical results in @xcite on a weak formulation that satisfies the conservation laws provided a continuous measure solution .",
    "the discrete process then converges weakly towards such a solution , on a neighbourhood of each endpoint , but uniformly as described above . to study the wright - fisher continuous limits ,",
    "however , we took a different route .",
    "this allows us to derive an approximate discrete weak formulation of the discrete process , with global error control .",
    "further , by embedding the discrete probabilities in an appropriate measure space , we could use compactness arguments to obtain the continuous limit .",
    "thus , in this setting both the weak formulation and the weak convergence of the discrete model to the continuous one follows with considerable less effort , but we do not get the improved convergence on the interior .      in order to be able to study more general models ,",
    "we follow the approach used by the authors in @xcite . in particular , we are interested not only in diffusion approximations , but in approximations that can be consistent with the dynamics of the corresponding discrete process .    we begin with a definition :    [ def : dca ] we shall say that a simplified model @xmath0 is an approximation of the family of detailed models @xmath1 , @xmath2 , in a sense @xmath3 , where @xmath3 is an appropriate metric as , for instance , any norm in a suitable space of functions ( e.g. , @xmath4 , @xmath5 , @xmath6 , etc ) if the following holds true :    1 .   consider a certain family of initial conditions @xmath7 such that @xmath8 , in the sense @xmath3 ; 2 .   evolve through the model @xmath1 the initial condition @xmath7 and through the model @xmath0 the initial condition @xmath9 until the time @xmath10 obtaining @xmath11 and @xmath12 respectively ;    if for all @xmath10 we have that @xmath13 , in the sense @xmath3 , then we say that the model @xmath1 converge in the limit @xmath14 , in the sense @xmath3 , to the model @xmath0 .",
    "if , furthermore , this convergence is uniformly in @xmath15 , then we say that the model @xmath1 converge in the limit @xmath14 to the model @xmath0 uniformly in time .",
    "some examples of the relation between detailed and simplified models are listed in table  [ table : drm ] .    in general ,",
    "some extra assumptions are frequently required to allow the passage to the limit .",
    "if , for example , there are more than one small parameter in the detailed model , it is natural to assume a relationship among them , called _ scaling _ , as , in general , the limit model will depend on how these parameters approaches zero .",
    "other assumptions may also be necessary , as it will be discussed in the next paragraph .",
    "the process of taking the limit of a family of models , considering a given scaling , will be called `` the thermodynamical limit '' ; by extension , we shall also call the limit model the _",
    "thermodynamical limit_. in this work , depending on the precise choice of the scaling , the limit equation can be of drift - type ( a partial differential equation fully equivalent to the replicator equation or system ) , of purely diffusion type , or , in a delicate balance , of drift - diffusion type .    .detailed and simplified models . the last two lines state that both the replicator equation and the replicator diffusion equation approximates the moran process .",
    "references to these works are @xcite . [ cols=\"^,^,^\",options=\"header \" , ]     in what follows , an important and natural assumption that must be introduced in order that we have an approximation in the sense of definition  [ def : dca ] is the so - called _ weak selection principle _ , to be precisely stated in equation  ( [ wsp ] ) . generally speaking , we assume that the _ fitness _ of a given individual converges to 1 when the time separation between two successive generations @xmath16 approaches zero .",
    "this is a natural assumption when we consider that two successive generations collapses into a single one .",
    "however , in most of the literature , the weak selection principle is assumed in the limit of @xmath17 , where @xmath18 is the population size .",
    "although they are equivalent ( as we shall assume a certain scaling relation between @xmath18 and @xmath16 ) , we consider our approach more natural .    in this work",
    ", we will consider as the detailed model , the wright - fisher process , to be studied in detail for finite populations in section  [ sec : finite ] : an evolutionary process for an asexual population of @xmath18 individuals , constant in size , divided in @xmath19 different types , that evolves according to a specific rule , with fixed time separation between generations of @xmath20 ( the detailed model in the discussion above , where @xmath21 is the inverse of the population size  or , as we shall see , equivalently , the inter generation time ) .",
    "in short , given the weak - selection principle , we are able to find a precise scaling that yields , as the thermodynimical limit . a parabolic equation with degenerate diffusion at the boundaries : namely the replicator - diffusion equation .",
    "under a range of different scalings , however , we shall also obtain a simpler first order differential system : the replicator equation .",
    "this simpler model turns out to be a good approximation for the detailed model over a short time scale , if genetic drift is weak or selection is strong . for the former approximation ,",
    "nevertheless , we shall be able to show that @xmath22 , and hence we conjecture that such an approximation should be uniform in time .      section  [ sec : prelim ] introduces the basic notation and provides an extended abstract of our main results .",
    "in section  [ sec : finite ] , we review some classical results about the discrete process ( the finite population wright - fisher process ) ; we also show the existence of a number of associated conservation laws , and explicitly obtain the first moments of the wright - fisher process . in section  [ sec :",
    "infinite ] , with the assumption of weak - selection , we obtain a family of continuous limits of the wright - fisher process depending on the scalings that are derived within a weak formulation , with solutions in appropriate measure spaces .",
    "in particular , we derive the replicator - diffusion equation , and show that it satisfies continuous counterparts of the conservation laws for the discrete process .",
    "we then continue the study of the replicator - diffusion equation in section  [ sec : forward ] , where we derive the main properties of its solutions , including a description of the solution structure as a regular part and a sum of singular measures over the sumbsimplices , and the large time convergence to a sum of dirac measures over the vertices of the simplex .",
    "we also show that the probability distribution associated with all types in the population concentrates along the evolutionary stable states .",
    "additionally , in subsection  [ ssec : duality ] , we obtain the backward equation as the proper dual of the replicator - diffusion equation , providing a consistent generalisation of the kimura equation for the @xmath19 types and arbitrary fitness functions . in section  [ sec : replicator ] , we study the replicator equation and show that , in the regime of strong selection the solutions to the replicator - diffusion will be well approximated by the solutions to the replicator equation within a finite time interval .",
    "numerical examples are given in section  [ sec : numerics ] , where we also point out that , for intermediate times and large but finite populations , the replicator equation will approximate the mode of the discrete evolution , but not the expected value of a given trait .",
    "conclusions are presented in section  [ sec : conclusion ] .",
    "we begin by introducing the space of states for the evolution :    [ def : simplex ] let @xmath23 .",
    "we define the @xmath24 dimensional simplex @xmath25 we also define the set of vertices of the simplex @xmath26 , its interior @xmath27 and its boundary @xmath28 .",
    "the _ state _ of the population is a vector @xmath29 .",
    "the elements of @xmath30 are denoted @xmath31 , @xmath32 and called `` homogeneous states '' .",
    "a vector @xmath33 is a `` mixed state '' .    in what follows ,",
    "we let @xmath34 to be the probability density of finding the population at state @xmath29 at time @xmath35 .",
    "the fitness of type @xmath36 , @xmath32 is a continuous function @xmath37 , and the average fitness in a given population is given by @xmath38 .",
    "note that we consider the fitness function to not depend explicitly on time .",
    "in this work , we derive a family of detailed models described by a parabolic equation of drift - diffusion type , with degenerated coefficients  @xcite , defined in the simplex @xmath39 , called _ the replicator - diffusion equation _ ,",
    "namely : @xmath40 with @xmath41 , @xmath42 , and where @xmath43 if @xmath44 and 0 otherwise is the kronecker delta .",
    "the above equation has a solution in the classical sense ( i.e. , everywhere differentiable ) .",
    "furthermore , in the classical sense , it is a well posed problem , without any boundary conditions .",
    "however , this classical solution is not the correct limit of the discrete process . in order to find the correct limit , equation ( [ replicator_diffusion_eps ] ) is to be supplemented with @xmath19 conservation laws . from now on , whenever we refer to the replicator - diffusion equation  ( [ replicator_diffusion_eps ] ) , we are implicitly assuming these conservation laws .",
    "our main conclusions are :    1 .",
    "an analysis of the equation ( [ replicator_diffusion_eps ] ) leads to a unique solution of measure type .",
    "this will require definitions of appropriate functional spaces .",
    "this unique solution approximates , in the thermodynamical limit , the evolution of a discrete population by the wright - fisher process pointwise for any time .",
    "in addition , the large time asymptotics is consistent with the discrete model .",
    "3 .   a reduced model , obtained by setting @xmath45 in ( [ replicator_diffusion_eps ] ) ( with only one conservation law ) ,",
    "is shown to be equivalent to the replicator dynamics .",
    "this will suggest that the replicator dynamics approximates the discrete process for any @xmath46 , however with an error increasing in @xmath46 along a fixed discretisation 4 .",
    "furthermore , the solution of the replicator equation models the time evolution of the mode of the probability distribution associated to the discrete process ( and not the _ expected value _ of the same distribution ) ; 5 .",
    "a frequency dependent generalisation of the kimura equation for an arbitrary number of types is obtained by looking at the dual problem for ( [ replicator_diffusion_eps ] ) .    before going into the technical details ,",
    "we explain the last paragraph a little further .",
    "equation  ( [ replicator_diffusion_eps ] ) has two natural time scales , one for the natural selection ( the mathematical drift and , as we shall see , fully compatible with the replicator equation ) , the second for the genetic drift ( the mathematical diffusion ) .",
    "that is why we call equation  ( [ replicator_diffusion_eps ] ) together with the conservation laws to be introduced in subsection  [ ssec : conservation ] , the `` replicator - diffusion equation '' .",
    "more precisely , the solution of the replicator - diffusion equation when @xmath45 ( which is of hyperbolic type ) is the leading order term of the solution @xmath47 of the replicator - diffusion equation for small @xmath48 ( i.e. , large fitness and/or short times ) .",
    "the replicator - diffusion equation with zero diffusion ( @xmath45 ) happens to be the replicator equation ( or system )  @xcite . in an appropriate sense , to be made precise in section  [ ssec : local ] ( theorem  [ thm : conv_to_replicator ] ) , we have @xmath49 , pointwise , but not uniformly in time .    theorem  [ thm : conv_to_replicator ] can not be made uniform in time , for general fitness functions and initial conditions , as the wright - fisher process always converge in @xmath50 to a linear combination of homogeneous states , while it is possible that the solution of the replicator equation converges to a stable mixed state .",
    "the former statement is the mathematical formulation of a known principle in evolutionary biology that states that `` given enough time every mutant gene will be fixed or extinct . ''",
    "this means that the final state of the replicator - diffusion equation with any @xmath51 will be a linear combination of dirac deltas at the vertices of the simplex @xmath39 .",
    "actually , for any positive time , the solution of equation  ( [ replicator_diffusion_eps ] ) with the conservation laws described above is a sum of a classical function in the simplex plus a sum of singular measures over all the subsimplexes on @xmath52 and , inductively , on their boundaries subsimplexes . in particular , we shall have also dirac measures supported on the vertices of the simplex .",
    "these measures appears immediately , i.e. , for any @xmath53 .",
    "this represents the fact that in a single step there is a non zero  however , small  probability that the population reaches fixation through wright - fisher evolution .",
    "the full evolution and the final states of the replicator - diffusion equation will be studied in section  [ sec : forward ] .    from the practical point of view",
    ", we are , however , often interested in transient states ( `` in the long run , we are all dead '' , said john maynard keynes ) , specially because the transient states become more and more important for the discrete evolution as the population size increases .",
    "heuristically , when the population is large the stochastic fluctuations decrease in importance , and therefore , its evolution is deterministic .",
    "the associated limit will be given by equation  ( [ replicator_diffusion_eps ] ) , with @xmath45 , i.e. , the hyperbolic limit of equation  ( [ replicator_diffusion_eps ] ) .",
    "this equation does not develop finite - time singularities .",
    "the relationships between the three models is summarised in figure  [ fig : relations ] .    ) , the replicator - diffusion equation ( positive diffusion @xmath48 ) and the replicator equation .",
    "the vertical axis indicates the arrow of time ( top - down ) , and the horizontal axis indicates , first the large population limit , secondly the no - diffusion limit .",
    "consider that there is a maximum acceptable error @xmath54 ( in the @xmath6 norm ) between the wright - fisher model ( suitably _ radonmised _",
    " see subsection  [ ssec : continuos_rep ] ) and the continuous approximation .",
    "therefore , there is a population size @xmath55 such that for @xmath56 the difference between the replicator - diffusion equation and the discrete model is less than @xmath54 . for the replicator approximation , for any @xmath18 , it may exist maximal time @xmath57 such that for @xmath58 the error is too large . ]    finally , we observe that the natural formulation for the continuous limit is the weak one .",
    "for such a formulation , we only require the fitness functions to be continuous . if , in addition , these functions are also lipschitz",
    ", we can then recast the problem in a strong sense , provided that we supplement it with the conservation laws .",
    "finally , requiring the fitness functions to be smooth allows for a number of results about the solutions to be easily derived .",
    "in particular , one can prove a structure theorem that show that the problem is equivalent to a hierarchy of classical degenerate problems , provided that some members are interpreted as densities for singular measures .",
    "in this section , we study the discrete model , i.e. , the wright - fisher model for constant population , arbitrary number of types and arbitrary fitnesses functions .",
    "we start , in subsection  [ ssec : prelim ] with basic definitions ; in subsection  [ ssec : sstates_fstates_claws ] we briefly review some important results in the literature .",
    "we also prove that the discrete process has as many linear conservation laws as types .",
    "additionally , we also show that the final state is a linear superposition of these independent stationary states , with coefficients that depend on the initial condition and that can be calculated from a set of @xmath19 linearly independent conservation laws .",
    "all these results will be useful in the correct determination of the continuous process , to be done in sections  [ sec : infinite ] and  [ sec : forward ] .",
    "the discrete wright - fisher process was studied , with different level of details in , for example ,  @xcite , but , to the best of our knowledge the conservation laws associated to the process were overlooked .",
    "the fact that the final state in the wright - fisher process , among others , for a finite population is always homogeneous was also a matter of dispute with respect to the validity of the modelling  @xcite . as we will shortly see in this work , this dispute is basically a consequence of the existence of two different time scales hidden in the model : the non - diffusive ( drift ) and the diffusive one .",
    "see also  @xcite and @xcite and references therein for a discussion in the rle of time scales .",
    "we consider a fixed size population of @xmath18 individuals at time @xmath46 consisting of a fraction @xmath59 of individuals of type @xmath60 .",
    "the population evolves in discrete generations with time - step separation of @xmath16 .",
    "we introduce the following notation :    the _ state _ of a population is defined by a vector in the @xmath18-discrete @xmath24-dimensional simplex @xmath61 we also define the set of vertices of the @xmath24-dimensional simplex @xmath62 the elements of @xmath63 are called _ the homogeneous states_. to each type we attribute a function , called fitness , @xmath64 .",
    "it is convenient to assume that @xmath65 is a discretisation of a continuous function on the simplex @xmath39 ; more assumptions on @xmath65 will be introduced in section  [ sec : infinite ]",
    ".    a population at time @xmath66 is obtained from the population at time @xmath46 choosing @xmath18 individuals with probability proportional to the fitness .",
    "more precisely , we define the average fitness @xmath67 and then the transition probability from a population at state @xmath68 to a population at state @xmath69 is given by @xmath70    the evolutionary process given by a markov chain with transition probabilities given by equation  ( [ tran_prob_wf ] ) is called _",
    "the ( frequency dependent ) wright - fisher process_.    let @xmath71 , with @xmath72 where @xmath73 is the probability of finding the population at a given state @xmath74 at time @xmath46 .",
    "then , the evolution is given by the so called `` master equation '' : @xmath75      we call an homogeneous population a population of a single type , i.e. , @xmath76 for @xmath77 , where @xmath78 from the inner product definition : @xmath79 it follows immediately that @xmath80 if @xmath81 and 0 otherwise .",
    "now , we state classical results for the wright - fisher process that will be useful in the sequel .",
    "firstly , from the perron - frobenius theorem , the operator @xmath82 , @xmath83 is well defined . for details in the lemma below , the interested reader should consult  @xcite .",
    "[ lem : classical ] a function @xmath84 defined in @xmath85 is a fixed state of the operator @xmath86 if , and only if , @xmath84 is a linear combination of homogeneous states . in particular , @xmath86 has exactly @xmath19 linearly independent eigenfunctions associated to the eigenvalue @xmath87 . for all non - negative initial condition @xmath88 , the final result is a linear combination of homogeneous states , @xmath89    where @xmath90 is the fixation probability of the type @xmath36 in a population initially with a probability distribution @xmath91 .",
    "we define a _ linear conservation law _ as one given by a linear functional @xmath92 over the functions of @xmath85 such that @xmath93 .",
    "a set of linear conservation laws is linearly independent , if the only linear combination providing a trivial conservation law @xmath94 is the trivial one .",
    "define @xmath95 , @xmath96 , a functional over @xmath85 .",
    "therefore @xmath97 is the fixation probability of the type @xmath36 associated to the initial condition @xmath69 . finally , the set @xmath98 is a basis for the set of linear conservation laws associated to the operator @xmath86 .    from the fact that @xmath99 we find @xmath100 in particular @xmath101",
    "finally , @xmath102 therefore , @xmath103 is an eigenvector of @xmath104 . in particular , @xmath105 it is immediate to prove that they are linearly independent ; let @xmath106 such that @xmath107 , i.e. , for every @xmath74 , @xmath108 . using @xmath109",
    ", we conclude that @xmath110 , and then @xmath98 is a basis for the eigenspace of @xmath104 associated to @xmath87 .",
    "now , consider a linear conservation law @xmath92 . from standard representation theorems ,",
    "there is a vector @xmath111 such that @xmath112 therefore , @xmath113 is an eigenvector of @xmath104 associated to @xmath87 and then it is a linear combination of @xmath103 , @xmath32 .",
    "the conservation of probability ( the most natural conservation law ) , follows directly from the equation @xmath114      the probability conservation is a consequence of the definition  ( [ tran_prob_wf ] ) and reads @xmath115 it also follows from the definition that @xmath116 which can be readily interpreted as the absence of mutations in the model",
    ".    it will be also convenient to write @xmath117 and to introduce @xmath118    [ theta_moments ] define @xmath119 and @xmath120=\\sum_{z\\boldsymbol{\\tau}\\in s^{n-1}_{n,\\mathbf{x}^+}}\\theta({\\mathbf{x}}\\to{\\mathbf{x}}+z\\boldsymbol{\\tau})h(\\boldsymbol{\\tau})\\ , \\ ] ] where @xmath121 .    for any @xmath18",
    ", we have @xmath122&=1\\\\ z{\\mathbb{g}}_\\theta[\\tau_i]&={\\widetilde{x}}_i - x_i\\\\ z^2{\\mathbb{g}}_\\theta[\\tau_i\\tau_j]&=({\\widetilde{x}}_i - x_i)({\\widetilde{x}}_j - x_j)+z^2\\left(\\delta_{ij}{\\widetilde{x}}_i-{\\widetilde{x}}_i{\\widetilde{x}}_j\\right)\\\\",
    "z^3{\\mathbb{g}}_\\theta[\\tau_i\\tau_j\\tau_k]&=({\\widetilde{x}}_i - x_i)({\\widetilde{x}}_j - x_j)({\\widetilde{x}}_k - x_k)\\\\ & \\qquad + z^2\\left[(\\delta_{ij}{\\widetilde{x}}_i-{\\widetilde{x}}_i{\\widetilde{x}}_j)({\\widetilde{x}}_k - x_k)+(\\delta_{ik}{\\widetilde{x}}_i-{\\widetilde{x}}_i{\\widetilde{x}}_k)({\\widetilde{x}}_j - x_j ) + ( \\delta_{jk}{\\widetilde{x}}_j-{\\widetilde{x}}_j{\\widetilde{x}}_k)({\\widetilde{x}}_i - x_i)\\right]\\\\ & \\qquad + z^4\\left[2{\\widetilde{x}}_i{\\widetilde{x}}_j{\\widetilde{x}}_k-(\\delta_{ij}{\\widetilde{x}}_j{\\widetilde{x}}_k+\\delta_{ik}{\\widetilde{x}}_i{\\widetilde{x}}_j+\\delta_{kj}{\\widetilde{x}}_i{\\widetilde{x}}_j)+ \\delta_{ij}\\delta_{ik}\\delta_{jk}{\\widetilde{x}}_i\\right ]   \\end{aligned}\\ ] ]    let @xmath123 , @xmath124 and consider the multinomial distribution given by @xmath125 then , @xmath126 is a vector of random variables with first moments given by @xmath127=1\\ , \\\\ & \\mathbb{e}[\\alpha_i]=nq_i\\ , \\\\ & \\mathbb{e}[(\\alpha_i - nq_i)(\\alpha_j - nq_j)]=\\mathop{\\mathrm{cov}}(\\alpha_i,\\alpha_j)=n(\\delta_{ij}q_i - q_iq_j)\\ , \\\\ & \\mathbb{e}[(\\alpha_i - nq_i)(\\alpha_j - nq_j)(\\alpha_k - nq_k)]= n\\left[q_i\\delta_{ij}\\delta_{kj}-\\left(q_iq_k\\delta_{ij}+q_iq_j\\delta_{kj}+q_kq_j\\delta_{ik}\\right)+2q_iq_jq_k\\right],\\end{aligned}\\ ] ] where @xmath128 $ ] is the expected value under the multinomial distribution .",
    "see  @xcite for the mean and covariance ; for the sake of completeness , we provide a derivation of the third moment in appendix  [ ap : thirdmomentum ] .",
    "now , note that @xmath129 .",
    "therefore , @xmath130 is a random vector that is multinomially distributed , and upon substituting @xmath131 in the multinomial moments  with @xmath132  all the identities follow after some manipulation .",
    "the aim of this section is to obtain a differential equation that approximates the discrete evolution , when the population is large ( @xmath17 ) and there is no time - separation between successive generations ( @xmath133 ) . the relevant variables , @xmath29 and @xmath53 will be forced to be continuous .",
    "the first four subsections will be devoted to the development of three models , based on partial differential equations obtained from the wright - fisher process , when @xmath17 and @xmath133 ( see equations  ( [ convective_approximation ] ) , ( [ diffusive_approximation ] ) and ( [ replicator_diffusion ] ) , respectively ) .",
    "there is no `` right choice '' of the simplified model .",
    "as we could expect , simpler models will have a restricted application .",
    "for example , the model given by equation ( [ convective_approximation ] ) is equivalent to a system of a ordinary differential equations ; actually , it is exactly equivalent to the well - know replicator dynamics  ( see * ? ? ? * ) . on the other hand ,",
    "the diffusive approximation , given by equation  ( [ diffusive_approximation ] ) , is a parabolic partial differential equation that is much simpler to solve than the full model ; in fact , explicit solutions are know using gegenbauer polynomials  @xcite",
    ". our focus will be on the replicator - diffusion approximation , equation  ( [ replicator_diffusion ] ) , which we expect to be valid uniformly in time .",
    "results known for the wright - fisher process , and stated in section  [ sec : finite ] will guide the derivation , i.e. , the choice of the right thermodynamical limit .",
    "we start in subsection  [ ssec : prelimcont ] by the asymptotic expansion of the transition kernel in the negligible parameters ( suitable combinations of @xmath18 and @xmath16 ) ; we plug this expansion into the master equation  ( [ discrete_evolution ] ) in subsection  [ ssec : weak - discrete ] . in subsection",
    "[ ssec : continuos_rep ] , we construct the continuous version of the discrete probability densities ; in particular , we interpolate discrete probabilities in order to represent them by continuous probability measures ; these measures will be central when we finally pass to the limits in subsection  [ ssec : passage_to_the_limit ] , obtaining the various continuous approximations of the discrete model .",
    "finally , in subsection  [ ssec : conservation ] , we show that , for every conservation law of the discrete process , there exists a corresponding conservation law in the continuous model . as a by product",
    ", the final state of the continuous model shall be a linear superposition of homogeneous states ( see lemma  [ lem : classical ] and compare it with theorem  [ thm : final_state ] ) .      from a biological point of view",
    ", the most important assumption in this derivation is the so called weak selection principle @xmath134 where @xmath37 is a continuous function , and @xmath135 is a parameter yet to be specified . in this case",
    ", we also have @xmath136 where @xmath137 .    as an immediate corollarium of lemma  [ theta_moments ] we have",
    "[ cor : theta_moments_asymp ] assume the weak - selection principle given by equation  ( [ wsp ] ) .",
    "then , equations for @xmath138 in lemma  [ theta_moments ] are given by @xmath139&=x_i\\left(\\delta t\\right)^\\nu\\left(\\psi^{(i)}({\\mathbf{x}})-\\bar\\psi({\\mathbf{x}})\\right)+{o}\\left(\\left(\\delta t\\right)^{2\\nu}\\right)\\ , \\\\",
    "z^2{\\mathbb{g}}_\\theta[\\tau_i\\tau_j]&= \\frac{1}{n}\\left(x_i\\delta_{ij}-x_ix_j\\right)+{o}\\left(n^{-1}\\left(\\delta t\\right)^\\nu,\\left(\\delta t\\right)^{2\\nu}\\right)\\\\",
    "z^3{\\mathbb{g}}_\\theta[\\tau_i\\tau_j\\tau_k]&={o}\\left(\\left(\\delta t\\right)^{3\\nu},n^{-1}\\left(\\delta t\\right)^\\nu , n^{-2}\\right)\\ .\\end{aligned}\\ ] ]    all equations follow from the fact that @xmath140\\ ] ]    and from lemma  [ theta_moments ] .",
    "we rewrite the master equation   using displacements : @xmath141    we use our information on moments of the process as follows :    let @xmath142 , where @xmath143 is any open set such that @xmath144 , and consider its restriction to the simplex @xmath145 .",
    "then , we have @xmath146\\\\ \\nonumber & \\qquad\\qquad+{o}\\left(n^{-2},\\left(\\delta",
    "t\\right)^{2\\nu},n^{-1}\\left(\\delta t\\right)^\\nu \\right).\\end{aligned}\\ ] ]    on multiplying equation  ( [ master_new ] ) by @xmath147 and summing over @xmath85 , we find that : @xmath148 .",
    "\\end{aligned}\\ ] ] where there is a constant @xmath149 , depending only on @xmath150 , such that @xmath151    using corollary  [ cor : theta_moments_asymp ] , we obtain the result .    equation   can be seen as discrete weak formulation for @xmath152 in space only , and thus any limiting argument would require some regularity assumption on @xmath152 in @xmath46 . in order to circumvent such assumptions , we need a full discrete weak formulation :    let @xmath153 , where @xmath154 is some fixed positive integer , and let @xmath150 be an admissible test function , with support in @xmath155 $ ] .",
    "let @xmath156 then we have that @xmath157\\\\ \\nonumber & \\qquad\\qquad+{o}\\left(n^{-2}\\left(\\delta t\\right)^{-1},\\left(\\delta t\\right)^{2\\nu-1},n^{-1}\\left(\\delta t\\right)^{\\nu-1}\\right)\\nonumber.\\end{aligned}\\ ] ]    sum over @xmath158 , and estimate the error term by its total sum , taking into account that there are @xmath159 terms in this sum .",
    "this shows the right hand side of . to obtain the left hand side",
    ", we perform a summation by parts and use that @xmath160 . see appendix  [ ap : a ] for details .",
    "the aim is now to obtain a continuous version of , but _ without taking any limits yet_. we first need some preliminary definitions :    [ def : pti ] let @xmath158 be a set of sampling times as above , and let @xmath161 be a set of times such that for each @xmath162 , there exists a unique @xmath163 such that @xmath164 .",
    "let @xmath150 be an admissible test function with support in @xmath155 $ ] . observe that under the assumptions on the sets @xmath158 and @xmath161 , for each @xmath165 $ ] there exists a unique @xmath162 such that @xmath166 , and a unique @xmath167 .",
    "with this in mind , we define : @xmath168 and @xmath169    for fixed @xmath170 , we have on one hand that @xmath171 is just freezing the value of @xmath150 on @xmath172 to be the value of @xmath173 .",
    "on the other hand , @xmath174 is freezing the value of @xmath150 on the same interval to be the value of @xmath175 , with @xmath164 .",
    "the natural choice for @xmath176 will arise , in the present context , from applications of the mean value theorem to @xmath150 over the interval @xmath177 $ ] .",
    "[ def : rdd ] let @xmath152 be a probability density defined no @xmath178 .",
    "let @xmath179 denote the atomic measure at @xmath170 .",
    "we define @xmath180    with these definitions we have the following result    [ thm : cont_discr ]",
    "let @xmath150 be an admissible test function , let @xmath181 , where @xmath182 is a second parameter yet to be specified , and let @xmath183 .",
    "then there exists a set @xmath161 as in definition  [ def : pti ] , such that @xmath184{\\mathrm{d}}\\mathbf{x } \\,{\\mathrm{d}}t\\label{eqn : cont_discr}\\\\ & \\qquad+{o}\\left(\\left(\\delta t\\right)^{2\\mu-1},\\left(\\delta t\\right)^{\\nu+\\mu-1},\\left(\\delta t\\right)^{2\\nu-1}\\right).\\nonumber\\end{aligned}\\ ] ]    for the right hand side , we observe that @xmath185 for @xmath186 and @xmath187 , @xmath188 , and that this also holds for all partial derivatives of @xmath150 not involving @xmath46 . on using the definition of @xmath189",
    ", we readily obtain the equivalence between the sums over @xmath190 and the integrals in @xmath170 . for the time integrals , we point out that both @xmath191 , @xmath171 and similarly for the derivatives of @xmath150 are piecewise constant in @xmath46 . hence the summation over time",
    "can be exactly converted into a time integral with a factor of @xmath192 .",
    "as for the left hand side , apply the mean value theorem to @xmath193 to get the result and the set @xmath161 .",
    "the reader is cautioned that , although has a remarkable resemblance with a weak formulation , it is not quite so , since the prospective test functions @xmath194 and @xmath195 are not test functions in the usual sense .",
    "we now deal with the limit @xmath196 in .",
    "[ thm : weak_conv ] under the same assumptions of proposition  [ thm : cont_discr ] , we have that , for any choice of parameters @xmath197 and @xmath198 , there exists @xmath199,{\\mathsf{bm}^+\\left(s^{n-1}\\right)}))$ ] , where @xmath200 is the set of positive measures of bounded variation on @xmath39 , such that @xmath201 weakly as @xmath196 .",
    "moreover , the following limits also hold : @xmath202{\\mathrm{d}}{\\mathbf{x}}\\,{\\mathrm{d}}t \\\\ & \\qquad\\qquad\\to   \\int_0^{\\infty}\\int_{s^{n-1}}p(\\mathbf{x},t)\\left[\\sum_{j=1}^{n-1}x_j\\left(\\psi^{(j)}(\\mathbf{x})-\\bar\\psi(\\mathbf{x})\\right)\\partial_{j}g(\\mathbf{x},t)\\right]{\\mathrm{d}}{\\mathbf{x}}\\,{\\mathrm{d}}t\\end{aligned}\\ ] ]    from the tightness of radon measures , cf .",
    "@xcite , we have that there exists a sequence @xmath203 , with @xmath204 as @xmath205 , and @xmath199,{\\mathsf{bm}^+\\left(s^{n-1}\\right)})$ ] , such that @xmath206 the convergence of the integrals follows from the weak convergence of @xmath207 , and from the fact that for a continuous function @xmath208 , we have @xmath209    if either @xmath210 or @xmath211 , we can multiply by @xmath212 . it is then easily verified that the error term vanishes in the limit , as well as the term with a time derivative .",
    "thus , in this case , we obtain stationary limits governed by the steady version of the equations derived below .",
    "now let us assume that @xmath213 .",
    "it is easily verified that the error term will be small .",
    "if both @xmath214 , we have stationary solutions given by the initial condition .",
    "the other cases are as follows :    [ thm : weak_limits ] there exists @xmath199;{\\mathsf{bm}^+\\left(s^{n-1}\\right)})$ ] such that    if @xmath215 , @xmath216 , the _ convective or drift approximation _ : @xmath217{\\mathrm{d}}\\mathbf{x}\\,{\\mathrm{d}}t.\\label{weak : convective}\\end{aligned}\\ ] ]    if @xmath218 , @xmath219 , the _ diffusive approximation _ @xmath220    if @xmath218 , @xmath216 , the case where there is a maximal balance of selection and genetic drift ; we find the _ replicator - diffusion equation _ @xmath221{\\mathrm{d}}\\mathbf{x}\\,{\\mathrm{d}}t.\\nonumber\\end{aligned}\\ ] ]    the result follows from theorem  [ thm : weak_conv ] , and from straightforward bookkeeping of the @xmath16 orders of the terms in .    alternatively , theorems  [ thm : weak_conv ] and [ thm : weak_limits ] can be seen together as an existence theorem for equations  , and . under additional regularity hypothesis on the fitness functions we have uniqueness",
    " see section  [ sec : forward ]  and then the limit is unique .",
    "equations  ( [ weak : convective ] ) , ( [ weak : diffusion ] ) and  ( [ weak : replicator_diffusion ] ) are written in the weak form . in population dynamics , and in others contexts",
    "as well , they are used casted into the strong formulation ( or standard pde formulation ) as follows ( see , however , remark  [ rmk : weak_to_pde ] ) :    * if @xmath215 and @xmath216 , the _ convective of drift approximation _ : @xmath222 .\\ ] ] this equation is equivalent to the replicator dynamics , showing that the wright - fisher process will be equivalent to the the replicator dynamics , in the limit of large population and small time - steps , if the population increases faster than the time - step decreases . * if @xmath218 and @xmath219 , the _ diffusive approximation _ @xmath223 which is relevant when the fitness converges to 1 as @xmath133 faster than @xmath17 .",
    "* when there is a perfect balance between population size and time step , i.e. , @xmath224 , we find the _ replicator - diffusion approximation _ , given by equation  ( [ replicator_diffusion_eps ] ) , which we repeat here for convenience : @xmath225 .\\ ] ]    we shall focus on the last equation and on its weak formulation  ( [ weak : replicator_diffusion ] ) .",
    "[ rmk : weak_to_pde ] we shall see in section  [ sec : forward ] that the weak and the pde formulations are not equivalent , and that the correct formulation is actually the weak one .",
    "let us write @xmath226 for the set of all functions @xmath227 such that there exist an open set @xmath228 and a function @xmath229 such that @xmath150 is the restriction of @xmath230 to @xmath39 and @xmath231 .",
    "notice that in the right hand side of , @xmath232 is multiplied by : @xmath233 equation   is readily seen to be a steady backward equation .",
    "we now show that the weak solutions have also conservation laws .",
    "let @xmath232 be a solution to ( we shall take as a special case ) .",
    "let @xmath234 be in the kernel of",
    ". then @xmath235 for almost every @xmath15 .",
    "let @xmath236 , with @xmath237 .",
    "then @xmath238 is an admissible test function . on substituting in , we find that @xmath239 since @xmath240 is an arbitrary function with compact support in @xmath241 , the result follows .",
    "a similar argument shows also the following    let @xmath232 be a solution to",
    ". then @xmath242 for almost every @xmath15 .",
    "therefore , the conservation laws given by equation  ( [ discrete_conservation_laws ] ) now become @xmath243 where @xmath244 satisfies . in principle",
    "the condition set out by seems to imply an infinite ( likely to be uncountable ) number of conservation laws .",
    "the following result shows that it is actually much more conspicuous :    [ thm : finite_cons ] let @xmath31 denote the vertices of @xmath39 . then there",
    "exist unique @xmath245 , @xmath246 , with @xmath247 that are solutions to .",
    "in addition , let @xmath248 .",
    "then , any solution to in @xmath226 can be written as a linear combination of @xmath245 , @xmath249 .",
    "in particular its kernel , for solutions in @xmath226 , has dimension @xmath19 .    given a vertex @xmath31 ,",
    "let @xmath250 be an adjacent vertex .",
    "now we solve in the segment @xmath251 with boundary values @xmath252 . in the segments not adjacent to @xmath31 define the solution to be zero .",
    "this defines the solution in all one - dimensional simplices . for each two - dimensional subsimplex",
    ", we now solve the dirichlet problem with the data from the previous step .",
    "now , assume that we have the solution uniquely defined in all subsimplices of dimension @xmath253 . repeating the construction above yields the solution in all subsimplices of dimension @xmath254 .",
    "proceeding inductively , this yields a solution in @xmath39 that is unique and admissible .",
    "uniqueness follows from the maximum principle applied at each subsimplex level .",
    "let @xmath234 , and let @xmath255 then @xmath256 . by the preceding argument , @xmath257 and @xmath244 must agree at all edges of @xmath39 . proceeding inductively once again yields that @xmath258 in @xmath39 .",
    "thus , the solutions to must satisfy : @xmath259    from a probabilistic viewpoint , the @xmath245 , @xmath260 , are naturally identified with the fixation probability of type @xmath36 .",
    "we now give a pure analytical argument for this fact . in section  [ sec : forward ] , we shall prove theorem  [ thm : final_state ] which shows that the final state is given by @xmath261=\\lim_{t\\to\\infty}p(\\cdot , t)=\\sum_{i=1}^n\\pi_i[p^{{\\mathrm{i}}}]\\delta_{\\mathbf{e}_i}\\ , \\ ] ] where @xmath262 is a dirac measure supported on the vertex @xmath263 . clearly , @xmath264 $ ] is the fixation probability of type @xmath36 in a population initially described by a probability distribution @xmath265 .",
    "therefore , @xmath266=\\int\\rho_i(\\mathbf{x})p^\\infty(\\mathbf{x}){\\mathrm{d}}\\mathbf{x}=\\int\\rho_i(\\mathbf{x})p^{{\\mathrm{i}}}(\\mathbf{x}){\\mathrm{d}}\\mathbf{x } = \\int\\rho_i(\\mathbf{x})\\delta_{\\mathbf{x}_0}(\\mathbf{x}){\\mathrm{d}}\\mathbf{x}=\\rho_i(\\mathbf{x}_0).\\ ] ]    in the neutral case , i.e. , @xmath267 for all @xmath268 and @xmath29 , we define the _ neutral fixation probability _ @xmath269=x_i$ ] , which follows from the fact that in the neutral case , @xmath270 .",
    "we now discuss the nature of solutions @xmath232 to ( [ replicator_diffusion ] ) together with the conservation laws ( [ continuous_conservation_laws ] ) .",
    "the main result of this section is theorem  [ thm : final_state ] .",
    "this must be understood as the continuous counterpart of the lemma  [ lem : classical ] .",
    "we do not refer to the discrete model to prove this result .",
    "our approach is based solely in the properties of the partial differential equation  ( [ replicator_diffusion ] ) , the restriction of the domain to the domain of interest , and the associated conservation laws  ( [ continuous_conservation_laws ] ) .",
    "an outline of the proof of theorem  [ thm : final_state ] is as follows : first , we show that a solution to can be written as regular part plus a singular measure over the boundary .",
    "moreover , the regular part vanishes for large time .",
    "repeating these arguments over the lower dimensional subsimplices , and using the projection result in proposition  [ prop : face_proj ] , we arrive at a representation of @xmath232 as a sum of its classical solution and a sum of singular measures that are uniformly supported on the descending chain of subsimplices of @xmath39 down to the zeroth dimension .",
    "since the solutions over the subsimplices also have a regular part that vanishes , we can show that all measures that are not atomically supported at the vertices should vanish for large time .",
    "thus , conservation of probability implies that the steady state of is a sum of deltas .    finally , we provide two applications",
    ". in subsection  [ ssec : duality ] , we study the dual equation",
    ". this will be the continuous limit of the evolution by the dual equation ( backward equation ) of the discrete process and therefore its solution @xmath271 gives the fixation probability at time @xmath46 of a given type ( to be prescribed by the boundary conditions in the dual process ) for a population initially at state @xmath272 .",
    "this gives a generalization for an arbitrary number of types and for arbitrary fitnesses of the celebrated kimura equation with reversed time  @xcite . in the sequel , subsection  [ ssec : strat_domin ] , we will show that if one type dominates all other types then , for any initial condition , the fixation probability of this type will be larger than the neutral fixation probability .",
    "this shows , in particular , that for large populations , the most probable type to fixate will be the one playing the nash - equilibrium strategy of the game ( assuming the identity between fitness and pay - offs , which is standard in this framework ) .",
    "this is not true in general for small populations  @xcite .",
    "we now study in more detail the features of the solution to ( [ weak : replicator_diffusion ] ) and show two important results : first that in the interior of the simplex , the solution must satisfy ( [ replicator_diffusion ] ) in the classical sense ; second , no classical solution to ( [ replicator_diffusion ] ) can satisfy the conservation laws . throughout this section",
    ", we shall have the further assumption that the fitnesses are smooth .",
    "we start by showing that , in the interior , a weak solution is regular enough to be a classical solution .",
    "[ lem : classical_int ] let @xmath232 be a solution to ( [ weak : replicator_diffusion ] ) .",
    "let @xmath273 be a proper compact subset .",
    "then , in @xmath274 , @xmath232 satisfies ( [ replicator_diffusion ] ) in the classical sense .",
    "in particular , @xmath275;c^{\\infty}(\\mathop{\\mathrm{int}}(s)))$ ] .",
    "let @xmath276 , we have then the standard weak formulation of ( [ replicator_diffusion ] ) in @xmath274 . on the other hand , ( [ replicator_diffusion ] ) is uniformly parabolic in any proper subset .",
    "hence the weak and strong formulations coincide  c.f .",
    "the last statement follows from @xmath277 , with @xmath274 compact and @xmath278 .",
    "the next two lemmas show existence of a unique classical solution , and that such a solution decays to zero for large time .",
    "[ lem : ncons_pde ] let @xmath232 be a classical solution to ( [ replicator_diffusion ] ) .",
    "then @xmath279    we define @xmath280 ( such that @xmath281 in @xmath39 with @xmath282 if and only if @xmath283 ) .",
    "note that @xmath284=0\\ .",
    "\\label{change_zero}\\ ] ] we introduce the new variable @xmath285 and after some manipulations , we find @xmath286\\ , \\label{rd_chang_var}\\ ] ] with @xmath287 and @xmath288 .    we now show that the last equation is well defined in @xmath145 .",
    "for the second order term , this follows from a new application of equation  ( [ change_zero ] ) . for the first order term , note that @xmath289 furthermore @xmath290    we shall now study the eigenvalue problem associated to by considering the dual problem , with respect to the measure @xmath291 , and with regularised coefficients : @xmath292 + s \\boldmath{\\omega}\\cdot\\nabla\\varphi^{({\\varepsilon})}= \\lambda^{({\\varepsilon})}\\varphi^{({\\varepsilon})},\\\\ & \\varphi^{({\\varepsilon})}=0\\text { in } \\partial{s}^{n-1}\\ , \\end{array}\\right . \\label{for : evp2}\\ ] ] where @xmath293 is a positive defined matrix in @xmath39 , with @xmath294 uniformly in @xmath170 , and @xmath295 in @xmath145 , @xmath296 uniformly in @xmath170 , and @xmath297 is a real parameter .",
    "first we observe that , for @xmath298 , equation satisfies a maximum principle for solutions in @xmath299 ; therefore if @xmath300 we have @xmath301 in @xmath145 ; see @xcite .",
    "we conclude that @xmath302 , for @xmath303 and @xmath298 .",
    "additionally , since the coefficients are smooth , the solution to equation is smooth in the interior by standard elliptic regularity .    for @xmath304 , the dominant eigenvalue @xmath305 is real and from the maximum principle it follows that @xmath306 . for @xmath307",
    ", @xmath305 is negative and therefore from its continuity in @xmath297 , we conclude that @xmath308 for any @xmath297 .",
    "therefore , for any other eigenvalue @xmath309 ( see  @xcite for further details ) .",
    "moreover , let @xmath310 be a decreasing sequence of positive numbers , and @xmath311 be the normalised eigenfunctions for the corresponding leading eigenvalues . since the coefficients are assumed smooth , the eigenfunctions are also smooth .",
    "hence , by rellich theorem , there is a subsequence @xmath312 such that @xmath313 converges in @xmath314 . by considering the weak formulation for equation",
    ", we immediately see that , for this subsequence , we must also have @xmath315 .",
    "we thus have obtained a real negative eigenvalue @xmath316 , with a real eigenfunction that is single signed . using the same argument in @xcite",
    ", we conclude that @xmath316 is the principal eigenvalue for the nonregularised problem .",
    "hence , any other eigenvalue will satisfy @xmath317 .",
    "this also shows that there exists @xmath318 , such that @xmath319 u \\,\\mu_{\\mathrm{s}}^{-1}{\\mathrm{d}}{\\mathbf{x}}<-\\alpha \\int_{s^{n-1}}u^2\\,\\mu_{\\mathrm{s}}^{-1}{\\mathrm{d}}{\\mathbf{x}}.\\ ] ]    therefore @xmath320    [ lem : unique ] equation  ( [ rd_chang_var ] ) has a unique solution @xmath321 .",
    "consider equation  ( [ rd_chang_var ] ) with @xmath322 and @xmath323 , with @xmath324 and @xmath325 as in lemma  [ lem : ncons_pde ] .",
    "for @xmath304 , it is uniformly parabolic , and hence it has a unique solution with the required regularity .",
    "we write ( [ rd_chang_var ] ) in weak form as @xmath326 we now observe that any such solution is bounded in @xmath327 .",
    "hence , one can select a sequence @xmath328 such that @xmath329 . since is weakly parabolic , such a solution must be unique  @xcite .",
    "finally , regularity follows from lemma  [ lem : classical_int ] .",
    "the preceding two lemmas have an important consequence :    [ cor : no_cons ] no solution to ( [ replicator_diffusion ] ) in the classical sense can satisfy the required conservation laws .",
    "in particular , this shows that the weak - formulation presented in theorem  [ thm : weak_limits ] is not only a device for obtaining the continuous limit , but it turns out to be the correct formulation .    in view of corollary  [ cor : no_cons ] , we turn back to the weak formulation given by or , equivalently , to together with the conservation laws . in",
    "what follows , we obtain some more information about such solutions .",
    "[ rmk : decomp ] as an extension of lemma  4.1 in @xcite , we observe that if @xmath232 is a radon measure in @xmath39 , we can write @xmath330 , with @xmath331 and @xmath332 .    [ prop : face_proj ] let @xmath333 and let @xmath232 be a solution to .",
    "let @xmath334 be a face of @xmath335 .",
    "assume that @xmath336 .",
    "then , over @xmath334 , @xmath232 satisfies in one less dimension with forcing given by the regular part of @xmath232 evaluated at @xmath337 , for a certain value of @xmath36 .",
    "assume , without loss of generality , that @xmath338 . in view of remark  [ rmk : decomp",
    "] , we can write @xmath330 , where @xmath339 with the singular support of @xmath340 lying in the complement with respect to the full simplex",
    ". moreover , we can also assume , without loss of generality , that @xmath341 is given by the intersection of the hyperplane @xmath342 with @xmath39 .",
    "let us write @xmath343 .",
    "let @xmath208 be an appropriate test function in @xmath341 , satisfying @xmath344 and let @xmath345)$ ] , with @xmath237 .",
    "then @xmath346 is an appropriate test function for @xmath39 and a direct computation with then yields @xmath347{\\mathrm{d}}\\mathbf{x}.\\end{aligned}\\ ] ] over @xmath342 , on using the definition of @xmath150 , we find that @xmath348{\\mathrm{d}}\\mathbf{x}\\,{\\mathrm{d}}t.\\end{aligned}\\ ] ] for @xmath340 , we have @xmath349{\\mathrm{d}}\\mathbf{x}\\,{\\mathrm{d}}t.\\end{aligned}\\ ] ]    by lemma  [ lem : classical_int ] , @xmath340 is smooth .",
    "therefore , the above equation can be integrated by parts to yield , an integral on @xmath39 that will cancel out identically , since @xmath340 is a classical solution to , and a number of integrals over the various faces of @xmath39 . in particular , at @xmath342",
    ", we find that @xmath350 by collecting together the two calculations on @xmath342 , we obtain the result .    in what follows , we shall need some preliminaries .",
    "recall  see @xcite  that to the simplex @xmath145 is associated a corresponding @xmath84-vector , such that the entry @xmath351 ( @xmath352 ) is the number of @xmath36-dimensional subsimplices of @xmath145 .",
    "we shall assume that , for each dimension @xmath36 , there is a definite order of the subsimplices @xmath353 , with @xmath354 and @xmath355 .",
    "moreover , we define the adjacent operator by @xmath356 which denotes the @xmath357th adjacent subsimplex of dimension @xmath351 to @xmath358 .",
    "notice that there are @xmath359 such simplexes .",
    "[ thm : soln_struct ] equation , with a given initial condition @xmath360 , has a unique solution @xmath361;{\\mathsf{bm}^+\\left(s^{n-1}\\right)}\\right)$ ] .",
    "moreover , let @xmath362 be the radon measure with unit mass uniformly supported on @xmath358 .",
    "then the solution @xmath232 can be written as @xmath363 where @xmath364 satisfies @xmath365{\\mathrm{d}}\\mathbf{x}\\,{\\mathrm{d}}t\\nonumber\\\\ & \\qquad \\quad + \\int_0^{\\infty}\\int_{s^{ij}}\\sum_{k=1}^{n - i}\\left.p_{(i+1){\\mathrm{ad}}(j , k)}\\right|_{s^{ij}}\\,{\\mathrm{d}}{\\mathbf{x}}\\,{\\mathrm{d}}t.\\nonumber\\end{aligned}\\ ] ] the initial condition for will be denoted @xmath366 , and it is obtained from @xmath265 by applying the decomposition described in remark  [ rmk : decomp ] recursively .    by direct substitution into and after a integrating by parts starting from @xmath145 , proceeding downwards until the vertices and using lemma  [ prop : face_proj ]",
    "one can verify that is indeed a solution . to verify uniqueness ,",
    "let @xmath367 a solution to .",
    "consider @xmath367 restricted to @xmath39 and let @xmath368 be the classical solution guaranteed by lemma  [ lem : unique ] . by considering with test functions with compact support on @xmath369",
    ", we see that @xmath370 vanishes .",
    "therefore @xmath371 .",
    "by remark  [ rmk : decomp ] , we can write @xmath372 , with @xmath373 . now @xmath52 is the union of @xmath374 copies of @xmath341 . by proposition  [ prop : face_proj ]",
    ", @xmath375 must satisfies in one less dimension in each of the subsimplices .",
    "proceeding inductively , we can now choose a subsimplex @xmath376 of @xmath341 .",
    "now , we repeat the argument above for each simplex @xmath341 which has @xmath376 as a subsimplex .",
    "iterate until arrive at the simplices of zero dimension to get the result .",
    "this theorem leads to the following result :    [ thm : final_state ] let @xmath377 where @xmath232 is the solution of equation  ( [ replicator_diffusion_eps ] ) subject to conservation laws  ( [ continuous_conservation_laws ] ) .",
    "then @xmath378 is a linear combination of point masses at the vertices of @xmath39,i.e , @xmath379\\delta_{\\mathbf{e}_i}\\ .\\ ] ]    first , we observe that lemma  [ lem : ncons_pde ] still holds if applied to inhomogeneous version of , provided that the forcing decays for large times .",
    "the results now follows from a straightforward application of proposition  [ prop : face_proj ] together with lemma  [ lem : ncons_pde ] applied in a descending chain of simplices down to dimension 1 .",
    "conservation of probability then yields that @xmath378 must be a sum of atomic measures at the vertices of @xmath39 . on using the other conservation laws",
    ", we obtain the coefficients , and hence the result .",
    "the formal adjoint of equation  ( [ replicator_diffusion_eps ] ) ( changing the flow of time from forward to backward ) provides a generalization of the celebrated kimura equation  @xcite , both including more types and allowing frequency dependent fitness : @xmath380 in diffusion theory this equation is associated with a martingale problem for the diffusive continuous process . in genetics ,",
    "the meaning of equation  ( [ backward_kimura_full ] ) is seldom made clear and depends on the boundary conditions imposed .",
    "one possible and common interpretation is as follows : given an homogeneous state @xmath381 , let @xmath382 be the probability that given a population initially in a well - defined state @xmath383 ( i.e. , @xmath384 ) we find the population fixed at the homogeneous state @xmath31 at time @xmath46 ( or before ) , i.e. , @xmath385 .",
    "in this case , we need to find consistent boundary conditions .",
    "see  @xcite .",
    "let us study the fixation of type 1 , represented by the state @xmath386 .",
    "let us now call @xmath387 the face of the simplex with @xmath337 ( type @xmath36 is absent ) .",
    "then , @xmath388 .",
    "for @xmath389 , @xmath390 is the solution of @xmath391 , where the type @xmath36 was omitted from the equation . as the faces of the simplex are invariant under the adjoint evolution ( one more fact to be attributed to lack of mutations in the model ) , this represent the same problem in one dimension less .",
    "we continue this procedure until we find the evolution in the edge from vertex @xmath392 to vertex @xmath389 , @xmath393 .",
    "in this case , we have that @xmath394\\to\\mathbb{r}$ ] , the restriction of @xmath395 to this edge , with @xmath396 being the fraction of type 1 individuals , is the solution of @xmath397 with boundary conditions given by @xmath398 and @xmath399 and @xmath400 is the restriction of @xmath401 to the edge @xmath393 .",
    "the forward and backward versions of equation  ( [ kimura ] ) are fully studied in the references  @xcite . for @xmath402",
    "constant this is the kimura equation .",
    "let us assume that @xmath403 for all @xmath29 .",
    "this happens , for example , if we identify fitness functions with pay - offs in game theory , types with strategists , and if strategist 1 plays the nash - equilibrium strategy .",
    "therefore , we prove    if , for all states @xmath29 , and all types @xmath32 , @xmath403 , then the fixation probability of the first type is not less than the neutral fixation probability for any initial condition @xmath265 ; i.e , @xmath404\\ge\\pi_1^{\\mathrm{n}}[p^{{\\mathrm{i}}}]\\ .\\ ] ]    first note that it is enough to prove that @xmath405\\ge\\pi_1^{\\mathrm{n}}[\\delta_{\\mathbf{x}}]=x_1 $ ] for all @xmath29 .",
    "the difference @xmath406 satisfy @xmath407 with vertex conditions @xmath408 for @xmath32 .",
    "now , we proceed by induction in @xmath19 . for the case",
    "@xmath409 , the proof is in  ( * ? ? ?",
    "* section 4.3 ) ; we reproduce it here only for completeness .",
    "we write explicitly the equation for @xmath410 : @xmath411 with @xmath412 and @xmath413 .",
    "we simplify the equation using the fact that @xmath414 and the solution is given by @xmath415{\\mathrm{d}}\\bar x } { \\int_0 ^",
    "1\\exp\\left[-\\frac{2}{\\kappa}\\int_0^{\\bar x}\\left(\\psi^{(1)}(\\bar{\\bar x})-\\psi^{(2)}(\\bar{\\bar x})\\right){\\mathrm{d}}\\bar{\\bar x}\\right]{\\mathrm{d}}\\bar x}\\ .\\ ] ] as @xmath416 , we conclude that @xmath417{\\mathrm{d}}\\bar x \\\\&\\qquad\\qquad\\ge \\int_0 ^ 1\\exp\\left[-\\frac{2}{\\kappa}\\int_0^{\\bar x}\\left(\\psi^{(1)}(\\bar{\\bar x})-\\psi^{(2)}(\\bar{\\bar x})\\right){\\mathrm{d}}\\bar{\\bar x}\\right]{\\mathrm{d}}\\bar x\\ .\\end{aligned}\\ ] ] in particular , @xmath418 .",
    "now , assume that @xmath419 for all @xmath420 .",
    "( note that @xmath52 is an union of a finite number of @xmath421 dimensional simplexes , where by the principle of induction we assume the result valid . ) finally , we use the maximum principle for subharmonic functions to conclude that the minimum can not be in the interior of the simplex  @xcite .",
    "therefore @xmath422 for all @xmath29 .",
    "in section  [ sec : infinite ] , we proved that , when genetic drift and selection balance , then there is a special timescale such that the evolution of an infinite population can be described by a parabolic partial differential equation .",
    "nevertheless , in applications one is usually interested in large but finite populations . in this case , an exact limit is not taken , and can be taken as an approximation of this evolution .",
    "we shall discuss this further in the conclusions , but we observe that this equation might be a good approximation even when balance is not exact , i.e. , when @xmath198 and @xmath197 are close but not equal to one .",
    "this could typically lead to an equation with @xmath48 being either quite large or small . in the former case ,",
    "a regular expansion in @xmath48 shows that the evolutions is governed by . on the other hand , in the latter case",
    ", one expects that the much simpler transport equation will be a good approximation for the evolution . indeed ,",
    "in this section we show that can be uniformly approximated by in proper compact subsets of the simplex , and over a time interval shorter than @xmath423 .",
    "we start in subsection  [ ssec : repode ] showing that the equation  ( [ convective_approximation ] ) is formally equivalent to the replicator system .",
    "afterwards , in subsection  [ ssec : peak ] , we answer what we believe to be an important question : what exactly is the replicator equation modelling ?",
    "in particular , we will show , using a simple argument , that the replicator equation does not model the evolution of the expected value ( of a given trait ) in the population , but the evolution of the most common trait conditional on the absence of extinctions . finally , we show , in subsection  [ ssec : local ] , that the replicator ordinary differential equation is a good approximation for the initial dynamics of the wright - fisher process , when @xmath48 is small . as in section",
    "[ sec : forward ] , we shall assume that the fitness functions are smooth .",
    "we shall now study in more detail the equation  ( [ convective_approximation ] ) , which has a close connection with the replicator dynamics as shown below :    [ thm : replicator_eu ] assume that @xmath424 is lipschitz . let @xmath425 the flow map of @xmath426 and let @xmath427 let @xmath428 and assume that @xmath429 ( see remark  [ rmk : decomp ] ) . then the solution to with initial condition @xmath430",
    "is given by @xmath431    we observe that , since @xmath424 is lipschitz , the push - forward of @xmath430 by @xmath432 is well defined@xcite . hence , the proof is based on the methods of characteristics ; see  @xcite .",
    "see @xcite for an approach that works even if @xmath424 fails to be lipschitz continuous .",
    "if @xmath265 gives mass to the boundaries of @xmath433 , we write , as in theorem  [ thm : soln_struct ] : @xmath434 moreover , notice that @xmath424 restricted to @xmath435 is tangent to @xmath436 .",
    "hence , the restricted dynamics is always well defined , and we can write @xmath437 for the flow map of @xmath438 where @xmath439 is the restriction of @xmath424 to @xmath435 , and @xmath440 is divergence in @xmath435 . then , repeated applications of theorem  [ thm : replicator_eu ] lead to the conclusion that the solution to is given by @xmath441      we start by showing that the long term dynamics of the average in the wright - fisher process , even in the thermodynamical limit , is not governed by the replicator equation . consider for example , a population of @xmath19 types , evolving according to the replicator - diffusion equation with fitness functions given by @xmath37 .    from the fact that the final state of the the replicator - diffusion equation is given by equation  ( [ final_state ] ) , the coefficients @xmath264 $ ] , @xmath32 can be calculated in two ways : @xmath442=\\int x_ip^\\infty(\\mathbf{x}){\\mathrm{d}}\\mathbf{x}=:\\langle p^\\infty\\rangle_i\\ .\\ ] ] therefore the average of the probability distribution will converge to a certain point of the simplex depending on the initial condition .",
    "this is completely different from the replicator dynamics , as its solution converges to a single attractor , periodic orbits , chaotic attractors , etc  @xcite .",
    "now , we show that the probability distribution concentrates in the ess ; this shows that the peak will behave in manner similar to the solutions of the replicator dynamics .",
    "recall that @xcite an ess that lies in interior of @xmath145 must be a global attractor of the replicator equation  ( [ replicator_ode ] ) .",
    "we have then the following result    [ thm : delta_conv ] assume @xmath360 , @xmath443 and assume that ( [ replicator_ode ] ) has a unique point @xmath444 such that for any initial condition @xmath445 , @xmath446",
    ". then the solution of equation  ( [ convective_approximation ] ) is such that @xmath447    assume , initially , that @xmath448 . since @xmath444 is a globally stable equilibrium for interior initial points , we can find @xmath449 , such that , for @xmath450 , and sufficiently small @xmath451 , we have , for any proper compact subset @xmath452 , that : @xmath453 where @xmath454 is the open ball of radius @xmath455 and centered at @xmath444 .",
    "let @xmath456 be a continuous function with support contained in @xmath274 .",
    "then , for @xmath450 , we have that @xmath457 but , let @xmath458 be given .",
    "since @xmath240 is continuous , possibly with a smaller @xmath451 , we must have @xmath459 now take @xmath460 such that ( [ eq : nearid ] ) is satisfied .",
    "this yields a sequence of times @xmath461 such that @xmath462 and @xmath463 since @xmath464 , for @xmath465 , the claim follows .    for the case",
    "@xmath466 , the result follows from similar arguments , replacing @xmath467 by @xmath468 .",
    "let @xmath469 if we perform a regular asymptotic expansion , i.e. , if we write @xmath470 , then we find , for times @xmath471 , that the leading order dynamics is given by    @xmath472    the next theorem shows that this indeed the case , provided we see @xmath473 as the leading order dynamics with respect to the regular part of the probability density .",
    "[ thm : conv_to_replicator ] assume that the fitness are @xmath474 functions , and that the initial condition @xmath265 is also @xmath474 .",
    "let @xmath475 be the regular part of the solution of ( [ replicator_diffusion_eps ] ) , with @xmath476 .",
    "then @xmath473 is @xmath474 , and satisfies the conservation law  ( [ continuous_conservation_laws ] ) .",
    "moreover , if @xmath477 , then given @xmath48 and @xmath274 positive , there exits a @xmath149 such that , for @xmath478 , we have @xmath479 and @xmath480 thus @xmath473 is the leading order asymptotic approximation to @xmath475 , for @xmath481 .",
    "the statements about @xmath473 follows straightforward by obtaining the solution by the method of characteristics .",
    "let @xmath482 .",
    "then @xmath483 satisfies    @xmath484    with null initial condition , where @xmath485 notice that , because of the assumptions on @xmath265 , we have that @xmath486 is uniformly bounded in time .",
    "the solution for such a problem is given by duhammel principle .",
    "let @xmath487 be associated solution operator .",
    "we have that @xmath488 by the maximum principle applied to the semigroup @xmath489 , we have that @xmath490 , and by the uniform bound on @xmath486 , we have that there exists a constant @xmath154 such that @xmath491 .",
    "thus , we find that @xmath492 hence @xmath493 therefore , taking @xmath494 , we find , for @xmath478 , that : @xmath495    if the condition on @xmath496 is not satisfied , a similar proof shows that if @xmath497 then the same conclusion holds .",
    "notice also that this condition is satisfied if the replicator has a globally stable equilibrium in the interior of @xmath39 .",
    "[ prop : weak_asymp ] under the same hypothesis of theorem  [ thm : conv_to_replicator ] , let @xmath498 be an open set such that @xmath499 and @xmath500",
    ". then , there exists @xmath501 , such that @xmath502 for any @xmath46 .    by theorem  [ thm : conv_to_replicator ]",
    ", there exists @xmath503 such that @xmath504 , which we write as : @xmath505 integrating in @xmath498 and using that @xmath506 , the result follows .",
    "theorem  [ thm : delta_conv ] shows that , for sufficient large time , the support of the solution of the replicator pde , equation  ( [ convective_approximation ] ) , will be concentrated in sufficiently small neighbourhoods of @xmath444 .",
    "in particular , this will be true for the maximum .",
    "for the replicator - diffusion equation  ( [ replicator_diffusion_eps ] ) this can not be valid for any value of @xmath51 ( as it was proved in theorem  [ thm : final_state ] ) ; however , for strong selection , the initial dynamics given by the replicator - diffusion equation is similar to the one given by the replicator ode .",
    "this is justified by the following result :    assume that the replicator has a unique global attractor .",
    "then , under the same hypothesis of theorem  [ thm : conv_to_replicator ] , we have that given @xmath304 and @xmath451 there exist a time @xmath507 and a constant @xmath501 , depending only on the initial condition , such that @xmath508 for @xmath509 .",
    "we have @xmath510 from theorem  [ thm : conv_to_replicator ] , we have a constant @xmath501 such that @xmath511 from theorem  [ thm : delta_conv ] , we have that there exists a time @xmath507 such that , for @xmath509 , we have @xmath512 combining these two calculations yields the result .",
    "we show , in this section , numerical results for two variants of the rock - scissor - paper game  @xcite ; i.e. , fitness are identified with the pay - off from game theory . in subsection",
    "[ ssec : num_f ] , we study the evolution of the discrete evolution numerically in time , and show that the peak of distribution behaves accordingly to the replicator equation while the average value of the same distribution converges to a point which is not the ess . in subsection",
    "[ ssec : num_b ] we obtain explicitly the fixation probability of a given type for the symmetric rock - scissor - paper game .",
    "a full animation is available in the website indicated in the caption of figure  [ simulation ] .      ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time",
    ", the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time",
    ", the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially .",
    "after a long time , it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] + ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time",
    ", the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation , also for different population sizes @xmath18 ,",
    "see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation , also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] + ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time",
    ", the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 .",
    "for a full animation , also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time",
    ", the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 .",
    "for a full animation , also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially .",
    "after a long time , it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] + ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially .",
    "after a long time , it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) .",
    "at the same time , the green spot marks the mean value of the probability distribution and also rotates initially . after a long time",
    ", it moves toward its final position , given by @xmath516 . for a full animation ,",
    "also for different population sizes @xmath18 , see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ] ) and ( [ pay_off_rsp ] ) for a distribution initially concentrated in the interior non - stationary point @xmath513 .",
    "the value of the distribution @xmath514 is in logarithmic scale .",
    "note that the cyan spot , marking the interior peak of the probability distribution rotates and converges to the ess @xmath515 ( along characteristics of the pde or , equivalently , the trajectories of the replicator dynamics ) . at the same time , the green spot marks the mean value of the probability distribution and also rotates initially .",
    "after a long time , it moves toward its final position , given by @xmath516 . for a full animation , also for different population sizes @xmath18 ,",
    "see ` http://dl.dropbox.com/u/11325424/wfsim/rspfinal.html ` , title=\"fig : \" ]    [ fig : evolutionrsp ]    we use evolutionary game theory  @xcite to define the fitness function .",
    "more precisely , we define a pay - off matrix @xmath517 such that @xmath518 is the gain ( in fitness ) of the @xmath36 type against the @xmath519 type .",
    "the fitness of the @xmath36 type in a population at state @xmath69 is @xmath520 in a simulation where both effects , drift and diffusion , are apparent , we have @xmath224 and @xmath521 .",
    "the last identity implies @xmath522 .",
    "furthermore , from equation  ( [ wsp ] ) , we have @xmath523 , and therefore , in order to see both effects we need strong fitness functions and long times , i.e. , @xmath524 .",
    "we consider in figure  [ fig : evolutionrsp ] the evolution of a discrete population of @xmath525 individuals with the pay - off matrix given by @xmath526 this is know as the generalized rock - scissor - paper game and presents an evolutionary stable state ( ess ) @xmath527 .",
    "furthermore , the flow of the replicator dynamics converges in spirals to the ess .",
    "the vertices as well as @xmath528 are equilibrium points for the continuum dynamics .",
    "see  @xcite for the choice of values of the matrix @xmath529 .",
    "note that the peak moves in inward spirals around the central equilibrium , following the trajectories of the replicator dynamics , while all the mass diffuses to the boundary .",
    "the green spot indicates the average value for @xmath530 and @xmath531 ; at first it moves in spirals close to the trajectories of the replicator dynamics . after a time depending on the value of @xmath18",
    "it starts to move in the direction of its final point @xmath532,\\pi_2[p^{{\\mathrm{i}}}],\\pi_3[p^{{\\mathrm{i}}}])$ ] .",
    "this point can be calculated using equation  ( [ final_state ] ) and the @xmath533 independent conservation laws .      ) , simulated by a wright - fisher process with @xmath525 and pay - off matrix @xmath534,[40 , 20 , 0],[0 , 40 , 20]]\\right)$ ] .",
    "note that higher values of the fixation probability `` rotates '' around the center of the simplex ( the stationary state of the replicator dynamics ) . ]",
    "the stationary state of the backward equation ( [ backward_kimura_full ] ) represents the fixation of probability of a given type .",
    "this type is specified by the associated boundary conditions .",
    "let us consider , as an example , that @xmath533 , the evolution is given by the rock - scissor - paper game defined by the matrix @xmath535 and we study the fixation probability of the third type .",
    "an exact solution is difficult to obtain , as it would be necessary to solve an hierarchy of equations , each solution representing boundary conditions of a larger set ; however , a numerical solution is extremely easy to compute , as the wright - fisher process is a natural discretisation of the ( forward as well as the ) backward equation ( cf .",
    "theorem  [ thm : finite_cons ] ) .",
    "this is probably computationally inefficient , and different processes can be compatible with the same limit equations",
    ". see figure [ fig : backward ] for an illustration .    in figure",
    "[ fig : l1norm ] , we plot the @xmath4 norm in the interior of the simplex and all subsimplexes , showing that that the probability mass flows from the simplex @xmath39 to the faces ( which are equivalent to the simplexes @xmath341 ) ; the solution behaves on the faces as the solution of the replicator - diffusion problem with one dimension less .",
    "the probability flows to the `` faces of the faces '' , i.e. , to simplexes @xmath376 until it reaches the absorbing state @xmath31 ( simplexes @xmath536 ) for @xmath32 .",
    "we may think of a stochastic process reaching and sticking to the faces of the simplex until they reach their final spot , the vertices .",
    "we further observe that , the probability mass in the interior of the simplex is the so - called quasi - stationary distribution of the process , namely , the probability distribution given that it has not been absorbed .",
    "see @xcite for a recent survey on the topic .    ) and with initial condition concentrated in the ess , @xmath537 .",
    "the red line indicates the mas ( @xmath4-norm ) in the interior of the simplex ; the blue line , the mass in the interior any of the faces , and the black line , the mass in any of the vertices.,scaledwidth=70.0% ]",
    "we present a derivation of continuous limits of discrete markov chain evolutionary models , that are frequency - dependent extensions the classical wright - fisher model , through pure analytical techniques .",
    "the derivation presented pays close attention to the variety of possible time scalings possible as related to the selection and population size that are measured by two parameters @xmath538 .",
    "the balance of diffusion and selection ( @xmath224 in our terminology ) can be seen as slight extension of the results in ( * ? ? ?",
    "* chapter 10 ) using analytical methods instead of probabilistic arguments , and that favours the forward fokker - planck equation instead of the backward . in this sense , from a mathematical point of view , the weak formulation presented for the forward equation seems to be new , in particular for the minimal assumptions on the fitness functions .",
    "the case @xmath539 yields a hyperbolic equation that is the pde version of the replicator equation .",
    "an apparently similar result can be found in ( * ? ? ?",
    "* chapter 11 ) , which would correspond formally to take @xmath540 and @xmath541 , without using explicit scaling between these two variables .    with some additional regularity assumptions on the fitnesses functions",
    ", we can show that is equivalent to together with the conservation laws .",
    "in particular , this allows to characterise the behaviour of @xmath232 on the lower dimensional subsimplices of @xmath39 .",
    "this can be used to obtain equations for the probability of extinction among other information .",
    "the results here are also related to results in  @xcite , where the idea that the underling scaling influences the macroscopic model was already present , although in a less explicit way than here .",
    "nevertheless , the accelerated birth - death regime in @xcite can be seen as a counterpart to our scaling of @xmath16 and @xmath18 . on the other hand ,",
    "the scaling for the fitness are taken as fixed ( corresponding to our @xmath216 in our terminology ) , and this explains why they do not obtain the pure diffusive limit in the large population regime .",
    "notice also that the large population regime taken there seems to annihilate any stochastic effects coming from births and deaths , and that the stochastic effects in this limit are due only to the mutation process .",
    "however , as pointed out above , as we allow more flexibility in the scaling laws , we are able to highlight any of these two factors independently ; more precisely , for certain choices of the scaling in the fitnesses functions ( namely , the exponent @xmath219 ) , their influence in the dynamics goes to zero so fast that the limit model is purely diffusive . on the other hand ,",
    "if we grow the population size fast enough ( i.e. , @xmath215 ) then we highlight the deterministic evolution , providing a direct way to compare the replicator equation with the wright - fisher process ( or , for that matter , also with the moran process , but , naturally , in a different time scale ) . to the best of our knowledge , this explicit comparison is new .",
    "see also  @xcite for a similar approach .",
    "the use of ordinary differential equations in population dynamics is widespread .",
    "however , as they are valid only for infinite populations , and real populations are always finite , the precise justification of its use and the precise meaning of its solution is seldom made clear . in this paper",
    ", we showed , in a limited framework , but expanding results from previous works  @xcite , that odes can be justifiably used to model the evolution of a population .",
    "however , the validity of the modelling is necessarily limited in time ( increasing with the population size ) , and the solution of the differential equation models the most probable state of the system ( therefore , the differential equation would give answers compatible with the maximum likelihood method , but not necessarily compatible with other estimators ) .",
    "one of the central issues of the present work is to discuss the possibility of using diffusive approximation for large , but finite , @xmath18 .",
    "however , a major challenge to any one interested to use the replicator - diffusion equation to fit experimental data is the value of @xmath48 .    from the derivation of the replicator - diffusion equation",
    ", we see that @xmath48 is directly linked to the variance of the diffusion , while @xmath542 is directly linked with natural selection .",
    "hence , their ratio is an adimensional measure of the relative relevance of the genetic drift with respect to natural selection .",
    "if we normalise the fitness functions such that @xmath543 , then @xmath48 becomes a measure of such relative relevance .    in this sense",
    ", @xmath423 could be an alternative definition of effective population size ( see also  @xcite for usual definitions ) .",
    "only when the population is small or times are long in the evolutionary scale , we would expect order 1 values of @xmath48 .",
    "we are currently applying a similar technique to epidemiological models ; in this case it is necessary to impose boundary conditions in part of the boundary ( as an homogeneous population of infected individual is not stationary , as infected individuals become , with time , removed or even susceptible ) and it is impossible to impose boundary conditions in part of the boundary ( a population of susceptible remains in this state for ever ) .",
    "early results were already published in  @xcite .",
    "the same problem , regarding the imposition of boundary conditions is true if we include mutations in the moran or wright - fisher model .",
    "this is work in progress .",
    "faccc was partially supported by cma / fct / unl , financiamento base 2011 isfl-1 - 297 and projects ptdc / fis/101248/2008 , ptdc / fis/70973/2006 from fct / mctes / portugal .",
    "faccc also acknowledges the hospitality of crm / barcelona where part of this work was performed and discussions with j. j. velazquez ( madrid ) .",
    "mos was partially supported by cnpq grants # s 309616/2009 - 3 and 451313/2011 - 9 , and faperj grant # 110.174/2009 .",
    "we thank the careful reading and comments of three anonymous referees .",
    "let @xmath126 be a multinomially distributed vector .",
    "let also @xmath544 and @xmath545 ( not necessarily equal to 1 ) .",
    "evidently @xmath546 . then : @xmath547&=\\left\\{\\sum_{\\boldsymbol{\\alpha}}\\alpha_i\\alpha_j\\alpha_kf(\\mathbf{q},\\boldsymbol{\\alpha},n)\\right\\}_{|\\mathbf{q}|=1 } = \\left\\{q_i\\partial_i\\left[q_j\\partial_j\\left(q_k\\partial_k|\\mathbf{q}|^n\\right)\\right]\\right\\}_{|\\mathbf{q}|=1}\\\\ & = n[q_i\\delta_{ij}\\delta_{kj}]+n(n-1)\\left[q_iq_k\\delta_{ij}+q_iq_j\\delta_{kj}+q_kq_j\\delta_{ki}\\right]+n(n-1)(n-2)q_iq_jq_k\\ .\\end{aligned}\\ ] ]",
    "the expression for the third moment now follows from a straightforward calculation .",
    "in order to obtain a truly weak formulation , without any requirement upon the regularity of @xmath232 , we observe that the equation is valid for any time @xmath548 .",
    "hence , if we also let @xmath549 in the equation , and sum over @xmath357 , we obtain that @xmath550{\\mathrm{d}}\\mathbf{x}.\\end{aligned}\\ ] ]                              chalub facc , souza mo ( 2009a ) from discrete to continuous evolution models : a unifying approach to drift - diffusion and replicator dynamics .",
    "doi : 10.1016/j.tpb.2009.08.006                                feller w ( 1951 ) diffusion processes in genetics .",
    "proceedings of the second berkeley symposium on mathematical statistics and probability , 1950 , university of california press , berkeley and los angeles , pp  227246          fournier n , mlard s ( 2004 ) a microscopic probabilistic description of a locally regulated population and macroscopic approximations .",
    "doi : 10.1214/105051604000000882                                    metz jaj ( 2011 ) thoughts on the geometry of meso - evolution : collecting mathematical elements for a post - modern synthesis . in : chalub facc , rodrigues jf ( eds ) the mathematics of darwin s legacy , springer , basel , pp  193231                          stevens a ( 2000 ) the derivation of chemotaxis equations as limit dynamics of moderately interacting stochastic many - particle systems .",
    "siam j. appl . math .",
    "61(1):183212 ( electronic ) .",
    "doi : 10.1137/s0036139998342065                  waxman d ( 2011 ) comparison and content of the wright - fisher model of random genetic drift , the diffusion approximation , and an intermediate model .",
    "j. of theoret .",
    "269(1):79  87 .",
    "doi : 10.1016/j.jtbi.2010.10.014"
  ],
  "abstract_text": [
    "<S> we study a class of processes that are akin to the wright - fisher model , with transition probabilities weighted in terms of the frequency - dependent fitness of the population types . by considering an approximate weak formulation of the discrete problem , </S>",
    "<S> we are able to derive a corresponding continuous weak formulation for the probability density . </S>",
    "<S> therefore , we obtain a family of partial differential equations ( pde ) for the evolution of the probability density , and which will be an approximation of the discrete process in the joint large population , small time - steps and weak selection limit . </S>",
    "<S> if the fitness functions are sufficiently regular , we can recast the weak formulation in a more standard formulation , without any boundary conditions , but supplemented by a number of conservation laws . </S>",
    "<S> the equations in this family can be purely diffusive , purely hyperbolic or of convection - diffusion type , with frequency dependent convection . </S>",
    "<S> the particular outcome will depend on the assumed scalings . </S>",
    "<S> the diffusive equations are of the degenerate type ; using a duality approach , we also obtain a frequency dependent version of the kimura equation without any further assumptions . </S>",
    "<S> we also show that the convective approximation is related to the replicator dynamics and provide some estimate of how accurate is the convective approximation , with respect to the convective - diffusion approximation . </S>",
    "<S> in particular , we show that the mode , but not the expected value , of the probability distribution is modelled by the replicator dynamics . </S>",
    "<S> some numerical simulations that illustrate the results are also presented . </S>"
  ]
}