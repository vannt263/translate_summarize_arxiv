{
  "article_text": [
    "recent advances in non - equilibrium statistical mechanics have given fresh perspectives on computational procedures applied to fluctuating molecular systems .",
    "the jarzynski work relation and the crooks fluctuation theorem , for instance , provide routes to compute equilibrium quantities from non - equilibrium measurements  @xcite . here",
    ", we demonstrate that traditional metropolis - hastings markov chain monte carlo ( mcmc ) can be similarly viewed as a procedure to extract equilibrium sampling from generically non - equilibrium processes .",
    "monte carlo trial moves drive a system away from the steady state distribution , and an entropy production can be assigned to these driven transformations .",
    "this interpretation provides an elegant way to understand challenges encountered in mcmc sampling , one that is especially revealing for mcmc sampling of trajectories .",
    "path sampling methods suffer routinely from profound inefficiency when trajectories of interest become long . from a non - equilibrium perspective on mcmc",
    ", we provide simple and quantitative ways to understand the inefficiency .    importance sampling of trajectories has enabled studies of a myriad of dynamical processes in physics and chemistry  @xcite . in particular , reaction rates and mechanisms can be found by transition path sampling ( tps ) , which examines the subensemble of trajectories that complete a reaction  @xcite .",
    "the practicality of tps depends intimately on the design of the monte carlo ( mc ) move set .",
    "namely , the moves must generate correlated trajectories so that a trial trajectory is likely to exhibit similar dynamical behavior as the previously sampled trajectory .",
    "chaotic divergence and microscopic reversibility of equilibrium dynamics informs the construction of two such moves , the so - called `` shooting '' and `` shifting '' moves  @xcite .",
    "these methods generate correlated trajectories by propagating alternative histories from highly correlated initial configurations . for sufficiently short trajectories ,",
    "the imposed correlation at one time serves to strongly correlate the trajectories at all times .",
    "long trajectories , however , are problematic : trial trajectories either lose all useful correlation with the reference path , or else they coincide so closely with the reference that changes are impractically small  @xcite . in both cases the efficiencies of shooting and shifting moves plummet as trajectories grow longer . sampling trajectories that involve slow molecular rearrangements and diffusive processes stands to benefit significantly from alternative methods of generating correlated trajectories .",
    "we consider three different ways to guide long trajectories : introducing auxiliary forces ; selecting among series of short trial segments , as in steered transition path sampling ( steps )  @xcite ; and advancing stochastic integrators with correlated random numbers ( which we refer to as `` noise guidance '' )  @xcite .",
    "of the three , only noise guidance yields an mc entropy production which is subextensive in the trajectory length .",
    "the other schemes , which accumulate extensive entropy production , can not efficiently extend to sampling of long trajectories .",
    "strong noise guidance is not , however , a panacea ; correlated noises need not imply correlated trajectories .",
    "we illustrate this point by considering glauber dynamics of a two - dimensional ising model and langevin dynamics of a two - dimensional weeks - chandler - andersen ( wca ) fluid .",
    "only when microscopic degrees of freedom have a small number of discrete possibilities , as in the lattice dynamics , is it possible to generate correlated long - timescale trajectories by tuning the noise .",
    "the structure of the paper is as follows .",
    "first we introduce and discuss the perspective of mc moves as non - equilibrium processes which produce entropy , detailing the consequences of constraints analogous to fluctuation theorems and the second law of thermodynamics .",
    "next we review transition path sampling in stochastic dynamics and demonstrate the challenge posed by long trajectories in the context of trajectory sampling of a one - dimensional random walker .",
    "we then analyze alternative strategies to correlate long trajectories of a one - dimensional single particle system and of a two - dimensional ising model .",
    "finally , we explore how strongly noise guidance correlates trajectories in example systems , and then conclude .",
    "we start by discussing a very general perspective on traditional metropolis - hastings mcmc sampling  @xcite .",
    "consider the problem of sampling a configuration , @xmath0 , according to probability distribution @xmath1 .",
    "for example , @xmath0 could be a vector of the coordinates and momenta of @xmath2 hard spheres , the state of spins in an ising model , or all coordinates of a classical trajectory .",
    "the metropolis - hastings algorithm generates a markov chain , which can be thought of as a dynamics through configuration space with the steady - state distribution @xmath1 .",
    "this dynamics obeys detailed balance but is not necessarily physical .",
    "one typically splits each monte carlo move into two steps .",
    "first , a change from @xmath0 to a new state @xmath3 is proposed according to a generation probability , @xmath4 $ ] . throughout this paper",
    "we will refer to @xmath0 as a reference and @xmath3 as the trial .",
    "this trial is conditionally accepted with probability @xmath5 =   \\min \\left[1 , e^{-\\omega}\\right ] , \\label{eq : metropolis}\\ ] ] where @xmath6}{p(\\tilde{\\mathbf{x } } ) p_{\\text{gen}}[\\tilde{\\mathbf{x } } \\rightarrow \\mathbf{x}]}. \\label{eq : entropyproduction}\\ ] ] together , these two steps ensure detailed balance , guaranteeing that the equilibrium distribution @xmath1 is stationary under the mc protocol . lacking the conditional acceptance step ,",
    "such an mc procedure would generally drive a system away from its equilibrium distribution .",
    "we find it instructive to view this notional process as a genuine non - equilibrium transformation , one that would generate nonzero entropy in most cases . in the formalism of stochastic thermodynamics ,",
    "the resulting entropy production corresponds precisely to the quantity @xmath7 defined in eq .",
    "@xcite .",
    "the mc acceptance step effectively filters realizations of this non - equilibrium process , with a bias towards low values of @xmath7 . by construction",
    ", the bias exactly negates the tendency of trial move generation to drive a system out of equilibrium . from this perspective , the countervailing tendencies of proposal and acceptance are akin to the operation of a maxwellian demon , which by contrast filters realizations of _ equilibrium _ dynamics with a bias that creates a _ non - equilibrium _ state .    viewing the procedure in the language of entropy production distributions reveals an important asymmetry of @xmath8 .",
    "following the more general demonstration of an entropy production fluctuation theorem  @xcite , note that @xmath9 with @xmath10 representing the entropy produced by a proposal move from @xmath0 to @xmath3 and @xmath11 denoting the dirac delta function .",
    "we are more likely to propose moves with positive entropy production than we are to choose their negative counterparts .",
    "the straightforward corollary , @xmath12 , is by analogy a statement of the second law , and the equality is satisfied if and only if @xmath13 . a further consequence of eq .",
    "[ eq : fluctthm ] relates the mc acceptance rate to the probability of attempting a move with a negative value of @xmath7 , which we call @xmath14 .",
    "specifically , @xmath15 = 2 p_{<},\\ ] ] which has been noted in the related context of replica exchange monte carlo  @xcite . as @xmath16 increases ,",
    "@xmath14 , and therefore @xmath17 , tends to decrease .",
    "we will see that @xmath16 scales with the number of driven degrees of freedom , such that monte carlo sampling of chain molecules or of long trajectories becomes especially challenging .",
    "we focus below on the sampling of dynamical pathways ( rather than individual configurations ) . in this case",
    "@xmath7 is an `` entropy production '' only by analogy , since the `` non - equilibrium transformations '' effected by mc trial moves occur in the more abstract space of trajectories .",
    "lessons from eq",
    ".   are nevertheless illuminating in the context of this abstract space .",
    "let us now specialize to the sampling of discrete - time stochastic trajectories with a fixed number of steps , @xmath18 .",
    "the probability of observing a trajectory , @xmath19 , can be written as @xmath20 \\propto \\rho_{\\text{init}}(\\mathbf{x}_0 ) \\prod_{t = 0}^{t_{\\text{obs}}-1 } p(\\mathbf{x}_t \\rightarrow \\mathbf{x}_{t+1 } ) , \\label{eq : pathprob}\\ ] ] where @xmath21 is a distribution for the initial time point , frequently an equilibrium or steady state distribution .",
    "the probability of each time propagation step is denoted @xmath22 , the form of which depends on details of the stochastic dynamics .",
    "we refer to this propagation as the natural dynamics .",
    "representative trajectories can be generated by sampling the initial state and propagating natural dynamics .    in many contexts , it is useful to study a biased trajectory ensemble constructed to highlight particular rare events .",
    "common examples include the reactive subensemble , @xmath23 \\propto p_{0}[\\mathbf{x}(t ) ] h_{\\text{a}}(\\mathbf{x}_0 ) h_{\\text{b}}(\\mathbf{x}_{t_{\\text{obs } } } ) , \\label{eq : reactivepathprob}\\ ] ] and the so - called tilted ensemble , @xmath24 \\propto p_0[\\mathbf{x}(t ) ] e^{-s k[\\mathbf{x}(t)]}. \\label{eq : tiltedpathprob}\\ ] ] in the former case , @xmath25 and @xmath26 are indicator functions which constrain the endpoints of the trajectory to fall in regions of phase space corresponding to reactants and products of a chemical reaction or other barrier crossing process  @xcite . in the latter case ,",
    "@xmath27 $ ] is an order parameter reporting on dynamical properties of the trajectory ( e.g.  the current  @xcite , activity  @xcite , or entropy production  @xcite ) and @xmath28 sets the strength of bias  @xcite .",
    "these biased ensembles highlight classes of trajectories only rarely sampled by the natural dynamics . to effectively sample them , a markov chain of correlated trajectories",
    "is constructed .",
    "the correlations between subsequent steps of the markov chain ensure that newly - generated trajectories are likely to share the rare features that made the prior trajectory a good representative of the biased ensemble .",
    "one of the most general and effective methods for generating a trial trajectory is the shooting move , which is particularly well - suited to sampling equilibrium dynamics  @xcite .",
    "the move proceeds as follows . a discrete time , @xmath29 , between @xmath30 and @xmath18",
    "is uniformly selected and designated the shooting time .",
    "the state of the system at @xmath29 , perhaps slightly modified , is then propagated forward and backward in time with natural dynamics to yield a trial trajectory , @xmath31 .",
    "the probability of generating this trial takes the form @xmath32 \\propto & \\rho_{\\text{init}}(\\mathbf{x}_0 ) p_{\\text{gen}}\\left(\\mathbf{x}_{t_{\\text{shoot}}}\\rightarrow \\tilde{\\mathbf{x}}_{t_{\\text{shoot}}}\\right ) \\times\\\\ & \\prod_{t=0}^{t_{\\text{shoot}}-1}\\bar{p}(\\mathbf{x}_{t+1}\\rightarrow \\mathbf{x}_{t } ) \\prod_{t = t_{\\text{shoot}}}^{t_{\\text{obs}}-1 } p(\\mathbf{x}_t \\rightarrow \\mathbf{x}_{t+1 } ) , \\label{eq : shootpgen}\\end{aligned}\\ ] ] where @xmath33 is the transition probability for time - reversed dynamics and @xmath34 is the probability of the perturbation at the shooting time . in the language of section",
    "[ sec : mcep ] , the entropy produced by this trial move is given by @xmath35 for long trial trajectories to be accepted by the mcmc scheme , @xmath7 must be small . however , when @xmath36 and @xmath33 are not equal ( as is the case in driven processes ) , the sum in eq .   has order @xmath18 nonvanishing terms   is uniformly selected between @xmath30 and @xmath18 , @xmath29 is of order @xmath18 . furthermore , while neighboring terms in the sum may be correlated , there will still be order @xmath18 independent terms for sufficiently long @xmath18 . ] .",
    "consequently , @xmath16 scales linearly with @xmath18 , and @xmath8 adopts the long - time form @xmath37 , \\label{eq : ldf}\\ ] ] with large deviation rate function @xmath38 . from this asymptotic expression for the entropy produced by a tps move",
    ", one might generally expect that the corresponding acceptance rate decreases exponentially as @xmath18 grows long .",
    "this extensive growth of @xmath16 with time has an important and general exception , namely the case of microscopically reversible dynamics . under those conditions , the sum in eq .",
    "vanishes and the only entropy production is contributed from the endpoints of the trajectory ( e.g. , @xmath25 and @xmath26 ) . since",
    "this entropy production is subextensive in time , long trajectories appear no more difficult to sample than short ones .",
    "the acceptability of trial trajectories , however , is also subject to biases like those expressed in eqs .   and  .",
    "because long trajectories typically decorrelate strongly from one another , the rare , biased qualities of a reference trajectory ( e.g. , reactivity or inactivity ) are recapitulated in the trial path with a probability that also decays with @xmath18 .",
    "we conclude that the challenges for efficiently sampling long trajectories are twofold .",
    "the tps move must produce entropy that is subextensive in observation time or the method will not scale to long trajectories .",
    "additionally , one must preserve strong correlations between @xmath39 and @xmath31 , so that rare properties of interest are retained in the trial trajectory . in the next section",
    "we show that these two goals are often conflicting .",
    "in particular , we examine three general schemes for engineering correlations between reference and trial trajectories in shooting - like moves .",
    "two of the schemes fail to exhibit subextensive entropy production scaling while the remaining scheme can only maintain strong trajectory correlations in special cases .",
    "we explore the three methods for trial trajectory generation in the specific context of a one - dimensional discrete - time random walker with equation of motion @xmath40 where at the @xmath41 timestep , the noise @xmath42 is drawn from the normal distribution with zero mean and variance @xmath43 . as a simple illustration focusing on the effects of entropy production , suppose we want to sample the unbiased trajectory distribution @xmath44 \\propto   \\delta(x_0 ) \\exp\\left[-\\sum_{t=0}^{t_{\\text{obs}}-1 } \\frac{(x_{t+1}-x_t)^2}{2\\sigma^2}\\right],\\ ] ] where the initial position is set to zero without loss of generality  . to construct a reference trajectory @xmath45 , we draw a value for @xmath42 at each timestep and propagate the walker s position according to eq .  .",
    "a trial trajectory is then generated by evolving dynamics from the same initial configuration ( with a different realization of the noise or perhaps even a different equation of motion ) .",
    "we imagine that it is desirable for the trial trajectory to retain a significant correlation with the reference path .",
    "this goal is motivated by the challenges of sampling biased ensembles as discussed above , but for the sake of simplicity we do not include such a bias here . to ensure this correlation , we employ shooting moves that differ from the conventional procedure described in section  [ sec : shootingsec ] .",
    "specifically , we implement and scrutinize three distinct ways to engineer correlation over long times : ( a ) adding artificial forces that pull the trial trajectory closer to the reference , ( b ) preferentially selecting among sets of otherwise unbiased short path segments , or ( c ) using correlated histories of noises .",
    "we assess the influence of these three biasing methods on the mcmc efficiency by characterizing the distribution @xmath8 .",
    "we first consider effecting correlations with guiding forces , i.e. , artificial contributions to the effective potential that tend to lead the trial trajectory toward the reference .",
    "this strategy is equivalent to using steered molecular dynamics  @xcite to generate new trajectories .",
    "the trial trajectory @xmath46 is grown with the equation of motion @xmath47 we denote @xmath48 as the trial trajectory noise at timestep @xmath49 , also drawn from a gaussian with mean zero and variance @xmath43 .",
    "the linear spring constant @xmath50 adjusts the strength of correlation between reference and trial trajectories .",
    "the probability that this guided dynamics generates a particular trial from the reference is given by @xmath51 \\propto \\exp\\left[-\\sum_{t=0}^{t_{\\text{obs}}-1 } \\frac{\\left(\\tilde{x}_{t+1 } - \\tilde{x}_t - k ( x_t - \\tilde{x}_t)\\right)^2}{2 \\sigma^2}\\right ] .",
    "\\label{eq : forcepgen}\\ ] ] the entropy production associated with the trial move depends also on the probability of generating the reverse tps move , growing the reference trajectory with extra forces pulling it close to the trial .",
    "it is straightforward to compute @xmath7 from eq .",
    ", @xmath52 in this approach , @xmath7 can be physically interpreted as the difference between two work values : that expended by the artificial force to guide the trial trajectory , versus the work that would be required to conversely guide the reference . the resulting distribution of entropy production , obtained from numerical sampling , is shown in in fig .",
    "[ fig : guidancefig](a ) .    since @xmath7 is given by a sum over all @xmath18 timesteps",
    ", @xmath8 adopts a large deviation form as in eq .  , and @xmath53 .",
    "these scaling properties are demonstrated numerically in fig .",
    "[ fig : ldffig](a ) and analytically in appendix  [ app : guidingforces ] .        in the appendix we re - express @xmath7 in terms of the @xmath54 and @xmath55 variables , which can be integrated over to yield @xmath56 .",
    "\\label{eq : meanscaling}\\ ] ] indeed , for @xmath57 , this expression gives the anticipated long time scaling with @xmath18 , @xmath58 as seen in fig .",
    "[ fig : guidancefig](a ) , the negative-@xmath7 tail of @xmath8 , which gives rise to mcmc acceptances , becomes correspondingly small for large @xmath18 .      in both sections  [ sec : shootingsec ] and",
    "[ sec : guidingforces ] we showed that time - extensive entropy production arises generically when we do not use natural ( forward ) dynamics to generate a trajectory .",
    "dynamical biases can alternatively be achieved by preferentially selecting among different examples of natural dynamics . at a high level ,",
    "conventional tps  @xcite is just such an approach , constructing biased trajectory ensembles through selection rather than artificial forces .",
    "can this strategy be used effectively to impose resemblance between reference and trial trajectories ?",
    "we consider a scheme very similar in spirit to the steps algorithm  @xcite . like",
    "configurational - bias mc sampling of a polymer  @xcite , the steps procedure generates a long trajectory by piecing together short segments , as illustrated in fig .",
    "[ fig : guidancefig](b ) . to generate a new segment ,",
    "one starts at the end of the previous segment and samples a collection of short , unbiased trajectories according to the natural dynamics , which we will refer to as branches .",
    "one of these branches is selected as the next segment of the trial trajectory , with a preference for branches that stay close to the reference trajectory .",
    "( proximity could be judged in different ways , e.g. , through euclidean distance in the full phase space , or with respect to an order parameter ) . though each branch is grown with natural dynamics ,",
    "the added segment is biased . to show that this bias affects acceptance rates in the same manner as the guiding forces bias , we compute the entropy produced by a tps move .",
    "starting at the initial condition of the reference trajectory , we grow @xmath59 branches of length @xmath60 according to @xmath61 where @xmath62 is an index over the @xmath59 independent samples of the natural dynamics . of these @xmath59 possibilities for the @xmath63 segment of the trial trajectory , we select branch @xmath62 with probability @xmath64 where @xmath65 is a weighting function with a maximum when its argument is zero , for example a gaussian centered on zero",
    ". the reference trajectory is indicated by a superscript @xmath66 .",
    "starting from the end of the chosen branch , the growth procedure is repeated with @xmath59 new branches of length @xmath60 .",
    "while each time propagation step uses segments of unbiased natural dynamics , the selection of preferred branches exerts a bias which ultimately leads to a nonvanishing entropy production , @xmath67 where @xmath68 is the index of the selected branch for the @xmath63 segment .",
    "the calculation of this entropy production requires generation of the backwards tps move , in which the @xmath66 branch is always selected .    in the preceding section we discussed that the entropy produced by guiding forces could be thought of in terms of a work performed by the bias . from that perspective , this guiding choices scheme trades work for information .",
    "we bias the dynamics not by applying explicit forces but instead by selecting the preferred branches based on information about the likelihood that a branch stays close to the reference .",
    "in particular , @xmath7 is a difference between the shannon information associated with selecting the set of trial branches which produced the trajectory @xmath69(t ) and the information associated with selecting the reference branches in a reverse tps move . as with biasing forces ,",
    "the trajectory space entropy production exhibits large deviation scaling with @xmath53 .",
    "numerical demonstrations of this scaling are provided in fig .",
    "[ fig : ldffig](b ) .",
    "consequently , acceptance probabilities drop precipitously in the long time limit .      as a third scheme for engineering path correlation , we consider generating a trial trajectory with natural dynamics but with biased noises . rather than trying to corral trajectories to proceed along similar paths ,",
    "one may impose much simpler correlations between their underlying noise histories  @xcite .",
    "consider a tps trial move which consists of re - propagating dynamics from the initial timestep using new noises @xmath55 that differ only slightly from the old noises @xmath54 , @xmath70 where @xmath71 is sampled from a gaussian distribution with zero mean and variance @xmath43 . in section  , the symbol @xmath62 was used as an index , but here we redefined @xmath62 to be the parameter controlling noise correlations .",
    "guiding gaussian noise variables in this manner has been referred to as a brownian tube proposal move  @xcite . unlike the prior two kinds of moves , the brownian tube proposal produces strictly vanishing entropy production @xmath7 for all trials regardless of trajectory length .",
    "the cancellation results from some algebra after writing the path weights and generation probabilities in terms of the noise variables , @xmath72 \\exp\\left[{-\\frac{(\\tilde{{\\boldsymbol \\xi}}-\\alpha { \\boldsymbol \\xi})^2}{2(1-\\alpha^2)\\sigma^2}}\\right]}{\\exp\\left[{-\\frac{\\tilde{{\\boldsymbol \\xi}}^2}{2\\sigma^2}}\\right ] \\exp\\left[{-\\frac{({\\boldsymbol \\xi}-\\alpha \\tilde{{\\boldsymbol \\xi}})^2}{2(1-\\alpha^2)\\sigma^2}}\\right]}=1 , \\label{eq : noise}\\ ] ] where @xmath73 is a vector detailing noises at all times .",
    "the vanishing entropy production is achieved by _ independently sampling _ the noise variables . in the previously discussed approaches , the bias applied to any one noise variable depended on how far astray the trial trajectory had drifted from its reference up to that point in time .",
    "such history - dependent biasing coupled the sampling of one noise variable to all of the previous noises , ultimately giving rise to the nonvanishing @xmath7 .",
    "by sampling all noises independently , we can perturb the @xmath54 variables in a symmetric manner . for noises drawn from a gaussian distribution , this symmetric perturbation",
    "was given in eq .  , but the strategy of symmetrically sampling independent noises generalizes to other choices of stochastic dynamics .",
    "for example , hartmann has applied these methods with uniform random variable noises to monte carlo dynamics in the form of wolff dynamics of a two - dimensional ising model  @xcite .        using correlated noise histories to sample monte carlo trajectories",
    "avoids the time - extensive bias that arose from guiding paths in configuration space , but this merit comes at a cost",
    ". if the reactive or tilted ensembles are to be sampled , it is important that the guidance scheme produces highly correlated trajectories .",
    "that is to say , the @xmath74 coordinates , not just the @xmath54 coordinates , must be correlated .",
    "when will similar noise histories produce similar trajectories ? in the remainder of the paper we address this question in the context of two dynamical systems , one on - lattice and the other off - lattice .",
    "in the preceding section we noted that sampling trajectories with noise - guided shooting moves avoids a time - extensive mc entropy production .",
    "however , we seek correlated trajectories , not just correlated noises . when trajectories with correlated noises synchronize , efficient path sampling of long trajectories can be achieved .",
    "but under what conditions should such synchronization be expected ?",
    "we investigate this question by studying lattice dynamics of a two - dimensional ising model and off - lattice dynamics of a wca fluid , also in two dimensions .",
    "we show that synchronization can be achieved with a suitable treatment of ising dynamics .",
    "this success does not extend to our example of off - lattice dynamics .",
    "let us first consider a two - dimensional ising model consisting of @xmath2 spins .",
    "the @xmath63 spin , denoted @xmath75 , takes the value @xmath76 .",
    "the lattice evolves , at inverse temperature @xmath77 , under single spin - flip glauber dynamics with hamiltonian @xmath78 the spins interact in the usual ising manner ; they couple to nearest neighbors with coupling constant @xmath79 and to an external field @xmath80 .",
    "each spin - flip trial move requires us to choose two random numbers uniformly from @xmath81 .",
    "one random number , @xmath82 , determines which site will be flipped .",
    "the other random number , @xmath83 , determines whether to accept or reject the flip .",
    "given @xmath82 and @xmath83 , the spin - flip move is deterministic :    1 .",
    "choose spin @xmath84 = ceiling@xmath85 to act on .",
    "2 .   construct a trial state by flipping spin @xmath84 .",
    "3 .   compute the energy difference , @xmath86 , between the original configuration and the trial .",
    "4 .   accept the spin flip if @xmath87 .    by carrying out @xmath18 sequential mc sweeps , each consisting of @xmath2 spin flip moves , we construct an ising trajectory , @xmath88 .",
    "the effective unit of time is thus taken to be a mc sweep .",
    "now consider a noise - guided trial tps move designed to generate a trajectory @xmath89 which is correlated with @xmath88 . at every mc step",
    "we alter @xmath82 and @xmath83 to some trial values , @xmath90 and @xmath91 .",
    "there is significant freedom in doing so , while producing zero entropy  . ] , and we analyze one particular choice .",
    "we focus first on updating the noise that chooses which spin to flip . with probability",
    "@xmath92 we reuse the old noise , i.e. , @xmath93 .",
    "otherwise , we uniformly draw a new value of @xmath90 from the unit interval .",
    "the tunable parameter @xmath94 controls the correlation between noise histories of the reference and trial trajectory .",
    "we update the noises that control conditional acceptance , @xmath83 , in an analogous manner .",
    "another parameter , @xmath95 , is the probability of drawing new noise for @xmath91 .        starting with the initial configuration of @xmath88",
    ", we construct @xmath89 by performing spin flips with the new trial noise history .",
    "the trial and reference trajectories start in identical configurations , but we expect the correlation to decay as mc time advances . to monitor the similarity between reference and trial , we study the site - wise product between @xmath96 and @xmath97 as illustrated in fig .  [ fig : latticefig ] . the average of this product over all spins , @xmath98 is a measure of correlation between @xmath96 and @xmath97 .",
    "decorrelated configurations return a value of zero while identical configurations return one .",
    "[ fig : decorrelationfig](a ) shows that the correlation between @xmath88 and @xmath89 decays to zero at long times .",
    "the rate of this decay is tuned by @xmath95 and @xmath94 , the parameters controlling the extent of noise correlation . at long times",
    "@xmath99 eventually approaches zero , even with the strongest noise guidance .",
    "the corresponding `` uncorrelated '' configurations , however , bear a subtler resemblance .",
    "some regions are significantly correlated , while others are significantly anti - correlated , averaging to give @xmath100 .    motivated by this subtler resemblance",
    ", we introduce a minor alteration in the implementation of glauber spin - flip dynamics .",
    "below we detail this modification and show that it does in fact enable the preservation of correlation between trajectories over very long times . as observed in the context of damage spreading , different choices of ising model monte carlo dynamics can result in identical equilibrium states yet different dynamical properties  @xcite .",
    "the effectiveness of correlated noises in guiding trajectories is , in effect , one such dynamical property .    in particular ,",
    "we replace step 2 of the spin - flip move to include a directionality .",
    "we introduce another random number , @xmath101 , used to decide the trial state . if @xmath102 , the trial state is a down spin ;",
    "otherwise it is up .",
    "whereas the conventional trial move effects an attempted spin flip , this trial move can be viewed as an attempt to push the spin either up or down , depending on the state of @xmath103 . as with the other noise variables ,",
    "correlations between @xmath103 and @xmath104 are tuned by the probability @xmath105 of resampling the noise .",
    "the addition of directionality to the spin - flip dynamics results in moves which are trivially ineffectual .",
    "for example , half of the spin moves attempt to `` push up '' a spin which is already up .",
    "these moot moves are absent from the traditional implementation of single - spin - flip glauber dynamics , which attempts a spin flip at every step of mc time . in every other respect ,",
    "the two schemes generate markov chains with identical statistics .",
    "they can therefore be made identical by excising moot moves , or , equivalently on average , by scaling time by a factor of two .    as fig .",
    "[ fig : decorrelationfig](b ) illustrates , the push up / push down implementation of single - spin - flip glauber dynamics allows the trial trajectories , @xmath89 to remain tunably close to @xmath88 for long times . by incorporating information about spin change directionality into the noise history ,",
    "the noises signal not just how likely a spin is to change , but in what direction it will change .",
    "appropriately chosen @xmath106 parameters can create trajectories which remain tunably close to each other for arbitrarily long times . when averaged over the whole lattice , steady state correlation",
    "is maintained , but the correlations are not spatially homogeneous . as mc time progresses , the regions in which two trajectories are highly correlated move throughout the lattice , ensuring ergodic exploration of the trajectory space .",
    "for push up / push down dynamics , noise guidance does not merely preserve correlations that existed at time zero .",
    "we find that correlated noise histories can in fact _ induce _ synchronization between trajectories . to illustrate this synchronization effect , we have characterized the correlation between trajectories that share similar noise histories only intermittently . as shown in fig .",
    "[ fig : intermediates ] , such paths acquire similarity during periods of strong noise guidance .",
    "this similarity degrades during periods without noise guidance , but can be recovered by re - introducing guidance , regardless of how significantly correlations have decayed .",
    "indeed , even very different initial configurations , propagated with correlated noises , become more similar with time , their ensemble - averaged correlation @xmath99 converging to the same value as for trajectories that are identical at time zero .",
    "a nonzero steady state value of @xmath99 is the quantitative signature of synchronization .",
    "the origins of this finite asymptotic correlation are transparent in the limit of weak coupling , @xmath107 . with the additional simplification @xmath108 , each attempted spin flip is accepted with probability @xmath109 based on the value of @xmath83 , regardless of the states of neighboring spins . in this case",
    "the steady state overlap can be calculated analytically .",
    "to do so , we derive an equation of motion for the probability @xmath110 that a given spin has identical values in the reference and trial trajectories after @xmath60 mc steps .",
    "note that @xmath60 differs from time @xmath49 by a factor of @xmath2 .",
    "the long - time , steady - state limit of this time evolution , @xmath111 , yields @xmath112 . in appendix",
    "[ app : overlap ] , we tabulate the various ways that a selected spin can become identical in reference and trial trajectories after a single timestep . from this enumeration , and the corresponding probabilities ,",
    "we find @xmath113    the various terms of eq .",
    "[ eq : eom ] describe the different ways that a single mc move can impact the state of an arbitrarily chosen spin in trial and reference trajectories .",
    "since each move of our mc dynamics acts on a single site of the lattice , some moves do not involve the tagged spin at all , but instead some other lattice site ; the first term in eq .",
    "[ eq : eom ] reflects this possibility .",
    "the second term accounts for the decrease in overlap when reference and trial trajectories accept a spin - flip at the same site but in opposite directions . the third term results from the constructive action of correlated noises on the tagged spin , either maintaining existing correlation or inducing synchronization , as detailed in appendix  [ app : overlap ] . the final term accounts for random alignment of the tagged spin despite uncorrelated noise variables , a possibility particular to degrees of freedom with a limited number of discrete states .",
    "equating @xmath110 and @xmath114 gives the steady state probability , @xmath115    analytically calculating steady - state overlap at finite temperature is not straightforward .",
    "numerical results , shown for @xmath116 in fig .  [ fig : ssfig ] , indicate that the dependence of overlap on strengths of noise perturbation is generically similar to the @xmath107 case analyzed above .",
    "increasing @xmath117 from zero does , however , slow the rate of convergence to the steady state , while decreasing the degree of steady state correlation . for all coupling strengths we have examined ,",
    "@xmath118 can be made arbitrarily close to unity by decreasing the various @xmath106 parameters .",
    "this level of control ensures that one can generate trial trajectories which are correlated with a reference for all times , an essential capability for efficient path sampling of long trajectories .      .",
    "average distance between the two trajectories , as defined in eq .",
    "[ eq : wcadist ] , is shown for a system of 400 particles with mass @xmath119 and diameter @xmath96 , in a square box with side length 24 @xmath96 ( i.e. , density @xmath120 ) .",
    "underdamped langevin dynamics was propagated with inverse temperature @xmath121 and friction coefficient @xmath122 using a timestep of 0.005 @xmath60 , where @xmath123 and @xmath106 is the lennard - jones interaction energy scale  @xcite .",
    "data are averaged over 500 independent trial trajectories .",
    ", scaledwidth=46.0% ]    the success we have achieved in synchronizing ising dynamics with noise guidance should not be expected for complex dynamical systems in general .",
    "we demonstrate this limitation for the specific case of a two - dimensional wca fluid  @xcite evolving by underdamped langevin dynamics .",
    "the purely repulsive particles are propagated using an integration scheme that requires generating a collection of gaussian random variables  @xcite .",
    "these noises are guided by a brownian tube proposal , eq .",
    "[ eq : stoltzalpha ] .",
    "the similarity between trial and reference noise histories is controlled by a parameter @xmath62 that ranges from zero ( no noise guidance ) to one ( complete noise guidance ) .",
    "starting from identical initial configurations , we propagate dynamics with correlated noise histories and monitor the difference between trial and reference as @xmath124 where @xmath125 and @xmath126 are the positions of particle @xmath84 in the reference and trial and @xmath127 is the two - dimensional euclidean distance . at short times , the difference between trial and reference trajectories is small , but this difference grows exponentially , a hallmark of chaotic dynamics .",
    "even with exceptionally strong noise guidance , trajectories can not be held arbitrarily close to each other for long times , as shown in fig .",
    "[ fig : wca ] .",
    "why are we unable to guide the evolution of wca particles as effectively as we guided ising dynamics ?",
    "a principal difference between the two systems is the likelihood of spontaneous local recurrences . in either case ,",
    "trajectories with similar initial conditions but different noise histories wander away from one another in a global sense , eventually exploring very different regions of configuration space . correlating their noise histories",
    "generally acts to defer , but not defeat , this divergence . in the case of ising dynamics , however , a given small block of adjacent spins will occasionally align spontaneously in two trajectories with reasonable probability .",
    "following such a spontaneous , local recurrence , correlated noises again work to hold trajectories close",
    ". global spontaneous recurrence of a large number of spins is , of course , highly improbable , but the noise guidance seems to `` lock in '' local correlations every time they spontaneously reoccur .",
    "transition path sampling has proven useful for a variety of equilibrium , as well as non - equilibrium , problems in chemical dynamics .",
    "the problem of sampling long trajectories , particularly those with multiple intermediates , has hindered a variety of extensions and applications of the methodology .",
    "we have outlined a modern physical perspective from which to assess and address these challenges . we have demonstrated and discussed successful trajectory guidance in the case of monte carlo dynamics of an ising model .",
    "substantial difficulties remain for systems with continuous degrees of freedom .",
    "our results suggest that effective noise guidance of long trajectories requires a nonnegligible probability of spontaneous local recurrence , i.e. , a significant chance that reference and trial trajectories transiently align within small regions of space",
    ". such synchronization could be particularly helpful for sampling reactive trajectories that traverse metastable intermediate states , for example the coarsening or assembly of colloidal systems as they organize on progressively larger scales .",
    "in such cases , trial trajectories in the course of path sampling should maintain correlations with the reference while passing through the intermediates , not just at the endpoints . even without identifying metastable configurations ,",
    "correlated noises could be applied during some intervals but not others . a tendency to synchronize",
    "would enable trial trajectories to explore widely during unguided periods , but to be reined in globally by intermittent guidance .",
    "we anticipate that these noise - guidance methods will be effective for other lattice systems as well , but their usefulness could depend sensitively on the exact manner in which the noise influences dynamics . in particular , without incorporating directionality into proposed spin changes ,",
    "we were not able to guide long ising trajectories . furthermore , ising dynamics can exhibit spontaneous recurrence , i.e. , transient local alignment between two trajectories regardless of their noise histories . because small blocks of ising spins can adopt only a modest number of configurations , such random local synchronization occurs with an appreciable probability .",
    "the probability of recurrence will likely be lower for models with a larger collection of possible local configurations , e.g. , a potts model or an ising model with more neighbors .",
    "we thus expect that the application of noise - guided path sampling could face substantial challenges for long trajectories of these more intricate lattice models .",
    "we acknowledge many useful discussions with michael grnwald about strategies for sampling long trajectories .",
    "t.r.g . acknowledges support from the nsf graduate research fellowship and the fannie and john hertz foundation .",
    "p.l.g . was supported by the u.s .",
    "department of energy , office of basic energy sciences , through the chemical sciences division ( csd ) of the lawrence berkeley national laboratory ( lbnl ) , under contract de - ac02 - 05ch11231 .",
    "here we analytically characterize the entropy production distribution , @xmath8 , for shooting moves generated with guiding forces as discussed in section  [ sec : guidingforces ] .",
    "it is useful to first rewrite eq .   in terms of the noise variables , @xmath54 and @xmath55 . for a one - dimensional random walk ,",
    "the position @xmath128 and the difference between reference and trial trajectory , @xmath129 , can be compactly expressed in terms of the noises .",
    "@xmath130 after straightforward algebra it is possible to express @xmath7 as @xmath131 where for convenience we have defined @xmath132 , @xmath133 , and @xmath134 the main text presents results for a random walk without drift , i.e. , with @xmath54 drawn from a distribution with mean zero .",
    "here we consider the more general case with nonzero mean @xmath135 . noting that @xmath136 and @xmath137",
    ", the average entropy production is found to be @xmath138 the two geometric series are summed to yield @xmath56 .",
    "\\label{eq : meanscalingapp}\\ ] ] when @xmath139 , @xmath16 grows exponentially in @xmath18 .",
    "this superlinear scaling results from coupling between trajectories so strong that the trial trajectory rapidly tends to infinity due to a numerical instability , much like the instability that arises in conventional molecular dynamics simulations performed with an excessively large integration timestep .",
    "for the useful range of coupling strength , @xmath140 , @xmath141 in the long time limit .",
    "the marginal @xmath142 case is well - behaved ( @xmath143 ) , but uninteresting for our purposes .",
    "the behavior of the higher - order cumulants can be extracted from the cumulant generating function @xmath144",
    ". this average requires integration over all of the gaussian @xmath54 and @xmath55 variables at all times , which can be performed inductively .",
    "we define @xmath145 as    @xmath146\\\\ & \\exp\\left[\\frac{1}{\\sigma^2}\\left(\\frac{-(\\xi_{t-1}^+)^2-(\\xi_{t-1}^-)^2}{4 } + \\lambda \\left(s_{t-1 } \\xi_{t-1}^+ - h s_{t-1}^2 + 2 g k ( 1-k ) s_{t-1 } \\xi_{t-1}^- + g k^2 ( \\xi_{t-1}^-)^2\\right)\\right)\\right ] \\label{eq : phieq}\\end{aligned}\\ ] ]    the integral @xmath147 is defined such that @xmath148 . by introducing @xmath149 and @xmath80 we can derive recursion relations as we sequentially integrate out gaussian noises at the latest remaining timestep .",
    "in particular , integration over @xmath150 then @xmath151 returns an integral of the same form .",
    "that is to say @xmath152 with @xmath153 iterating the map @xmath18 times corresponds to integrating over all of the @xmath154 integrals in eq .  .",
    "after some algebraic simplification , @xmath155 where @xmath156 and @xmath157 the scaled cumulant generating function is then given by @xmath158 where @xmath159 is a fixed point of the map given in eq .  .",
    "specifically it is the lesser of the two roots of the quadratic equation obtained when @xmath160 is inserted into eq .  .",
    "the numerical legendre transform of this scaled cumulant generating function gives the solid black curve in fig .",
    "[ fig : ldffig](a ) , toward which the results of numerical sampling should converge for long @xmath18 .",
    "to derive the steady state correlation between reference and trial trajectories , we examine the time evolution of the probability @xmath110 that reference and trial overlap at site @xmath84 and mc step @xmath60 . without loss of generality , we focus on a particular site , @xmath161",
    ". push up / push down moves can be grouped into four classes : ( i ) the reference and trial each act on spin @xmath162 , ( ii ) the reference acts on spin @xmath162 while the trial acts on a different spin , ( iii ) the trial acts on spin @xmath162 while the reference acts on a different spin , or ( iv ) neither reference nor trial acts on spin @xmath162 . for each case",
    ", we derive a transition matrix which maps the vector @xmath163 to its state at mc step @xmath164 .",
    "the full transition matrix for a step of dynamics is the sum of these transition matrices , weighted by the probability of each case , @xmath165 the transition matrix for case ( iv ) is the identity matrix , since this case can not alter the overlap at site 1 .",
    "the transition matrices for cases ( i ) , ( ii ) , and ( iii ) are @xmath166 and @xmath167 , respectively , the forms of which we now derive .    when reference and trial act on different spins , only one copy of spin 1 ( the reference or the trial ) can change its state .",
    "when the two copies differ at site @xmath84 after @xmath60 steps , overlap is induced with probability 1/4 ( i.e. , the probability that any given move results in a change of spin state ) . for initially aligned copies ,",
    "loss of overlap similarly occurs with probability 1/4 .",
    "this logic applies equally well to cases ( ii ) and ( iii ) , so @xmath168    when both reference and trial act on site 1 , we must account for correlated influence on the two copies . as a result",
    ", @xmath167 depends on @xmath95 and @xmath105 . to enumerate these correlated changes",
    ", we denote states of spin 1 at step @xmath60 in the reference and trial as @xmath169 and @xmath170 , respectively . after the mc step ,",
    "these spins are given by @xmath171 and @xmath172 .",
    "table  [ tab : enumeration ] lists the possible transformations which result in overlapping spins ( @xmath173 ) after @xmath174 steps .    .",
    "enumeration of moves yielding @xmath175 . without loss of generality",
    ", we only list the moves which start with @xmath176 .",
    "the moves starting with @xmath177 are analogous .",
    "@xmath178 is the direction of a push with @xmath162 meaning up .",
    "@xmath179 indicates whether the move is accepted ( 1 ) or rejected ( 0 ) .",
    "an asterisk indicates that both options yield the same result . [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]          we are interested in the steady state solution , found by setting @xmath184 .",
    "multiplying the equation through by @xmath2 , followed by algebraic simplification , yields eq .",
    "[ eq : hightemp ] of the main text .",
    "39ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) _ _ , @noop ph.d .",
    "thesis ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> importance sampling of trajectories has proved a uniquely successful strategy for exploring rare dynamical behaviors of complex systems in an unbiased way . carrying out this sampling </S>",
    "<S> , however , requires an ability to propose changes to dynamical pathways that are substantial , yet sufficiently modest to obtain reasonable acceptance rates . </S>",
    "<S> satisfying this requirement becomes very challenging in the case of long trajectories , due to the characteristic divergences of chaotic dynamics . </S>",
    "<S> here we examine schemes for addressing this problem , which engineer correlation between a trial trajectory and its reference path , for instance using artificial forces . </S>",
    "<S> our analysis is facilitated by a modern perspective on markov chain monte carlo sampling , inspired by non - equilibrium statistical mechanics , which clarifies the types of sampling strategies that can scale to long trajectories . </S>",
    "<S> viewed in this light , the most promising such strategy guides a trial trajectory by manipulating the sequence of random numbers that advance its stochastic time evolution , as done in a handful of existing methods . in cases where this `` noise guidance '' synchronizes trajectories effectively , as the glauber dynamics of a two - dimensional ising model , we show that efficient path sampling can be achieved for even very long trajectories . </S>"
  ]
}