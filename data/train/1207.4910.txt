{
  "article_text": [
    "when electronic computers first became widely available , it was discovered that orbits in typical axisymmetric galactic potentials usually admit three isolating integrals of motion @xcite .",
    "consequently , by jeans theorem , the distribution functions ( s ) of equilibrium axisymmetric galaxies should be functions of three integrals of motion .",
    "unfortunately , analytic forms of all three integrals are known only for exceptional potentials , so the few three - dimensional galaxy models in the literature that have a known  ( e.g. * ? ? ?",
    "* ) employ only the classical energy and angular - momentum integrals @xmath0 and @xmath1 , and therefore lack generality .",
    "the action integrals @xmath2 , @xmath3 and @xmath1 are particularly useful constants of motion ( e.g. * ? ? ?",
    "* ) , and we have previously argued the merits of models in which the distribution function is an analytic function of @xmath2 , @xmath3 and @xmath1 . to take advantage of these models",
    "one should be able to evaluate economically the actions of a star from its conventional phase - space coordinates @xmath4 . to date",
    "we have used two techniques for evaluating actions : ( i ) torus construction @xcite and ( ii ) the adiabatic approximation @xcite .",
    "torus construction is a general and rigorous technique and for some applications it is the technique of choice ( e.g. * ? ? ?",
    "* ) . for other applications",
    "it is inconvenient because it delivers @xmath4 as functions of the actions and angles , rather than the actions and angles as functions of @xmath4 .",
    "the adiabatic approximation delivers actions and angles as functions of @xmath4 but it is reasonably accurate only for stars that stay close to the galaxy s mid - plane .",
    "here we introduce a different approximate way to obtain actions , which , though still approximate , is more accurate than the adiabatic approximation and is valid for stars that move far from the mid plane .",
    "our algorithm is based on the idea that the galaxy s gravitational potential is similar to a stckel potential  for a detailed description of the latter see @xcite .",
    "stckel potentials for oblate bodies are framed in terms of prolate confocal coordinates .",
    "the latter are defined by the distance @xmath5 between the foci of the coordinate curves .",
    "these foci lie at @xmath6 and @xmath7 , where @xmath8 is a system of cylindrical polar coordinates . following binney & tremaine ( 2008 ; hereafter bt08 ) ",
    "3.5.3 we define new coordinates @xmath9 by @xmath10 the generating function of the canonical transformation between these systems of coordinates is @xmath11 so from @xmath12 we have @xmath13 in these coordinates a stckel potential can be written in terms of two functions of one variable , @xmath14 and @xmath15 , being given by @xmath16 this being so , the hamilton  jacobi equation yields ( bt08 eq .",
    "3.249 ) @xmath17 where @xmath0 is the orbit s energy and @xmath18 is a constant of separation .",
    "these equations make @xmath19 and @xmath20 functions of only their conjugate coordinate , so we can evaluate the actions as @xmath21 where @xmath22 are the roots of @xmath23 and @xmath24 is the root of @xmath25 .",
    "note that an orbit s actions are independent of any system of coordinates and the subscripts @xmath26 and @xmath27 on the actions merely remind us that , in a general way , @xmath2 quantifies oscillations inwards and outwards , while @xmath3 quantifies oscillations around the equatorial plane .",
    "in as much as our potential @xmath28 is similar to a stckel potential , we have @xmath29 consequently , we have @xmath30 here @xmath31 is a reference value of @xmath32 , the choice of which will be discussed below , and the right side of the first equation appears to be a function of @xmath33 but its dependence on @xmath33 will be weak unless @xmath28 is very unlike a stckel potential .",
    "similarly , we assume that the dependence of the right side of the second equation on @xmath32 is at most weak .",
    "then , given a point @xmath4 on the orbit we can calculate two constants of motion : @xmath34 now we can evaluate @xmath35 for any given @xmath32 from @xmath36-{l_z^2\\over2\\delta^2\\sinh^2u},\\ ] ] so we can evaluate the integral for @xmath2 .",
    "the integral for @xmath3 is evaluated in the same way .    in principle",
    "@xmath31 can be taken to be any quantity that is constant along an orbit , but the accuracy of our work will depend on our choosing a value such that the term in the definition ( [ eq : deltas ] ) of @xmath37 that contains @xmath31 almost completely eliminates the @xmath33 dependence of the first term in this equation .",
    "in fact , the natural choice for @xmath31 is the location @xmath38 of the minimum with respect to @xmath32 of @xmath37 at fixed @xmath33 .",
    "this minimum can be determined before we have specified @xmath31 because the derivative with respect to @xmath32 of the first of equations ( [ eq : deltas ] ) is manifestly independent of @xmath31 .",
    "physically @xmath38 is the radial coordinate of the shell orbit @xmath39 of given values of @xmath0 and @xmath1 .",
    "equations ( [ eq : puv ] ) for the momenta are obtained by solving the hamilton ",
    "jacobi equation for the generating function @xmath40 of the canonical transformation between the @xmath41 and the @xmath42 systems of canonical coordinates with @xmath43 of the form @xmath44 given that @xmath43 takes this form , we may write @xmath45 hence @xmath46 we obtain the derivatives of @xmath35 and @xmath47 from the chain rule . for example @xmath48",
    "where @xmath49 is the radial frequency , so @xmath50 a detail possibly worth noting is that we always take @xmath35 of @xmath47 to be given by the positive square root and when considering a point in phase space at which @xmath51 we obtain the indefinite integrals over @xmath32 as twice the corresponding integral from @xmath52 to @xmath53 minus the integral from @xmath52 to @xmath32 with @xmath35 taken to be positive .",
    "when this procedure is followed for all integrals , the angle variables increase along an orbit continuously as they should .",
    "the derivatives with respect to @xmath2 in equation ( [ eq : pujr ] ) can be obtained by observing that by the chain rule the matrix @xmath54 is the inverse of the matrix regarding whether they are at constant @xmath55 or @xmath56 . ]",
    "@xmath57 the latter is readily obtained by differentiating equations ( [ eq : jrz ] ) and leads to the definite integrals mentioned in the previous paragraph .      to recover the observable properties of a model stellar system at a given spatial point , such as its density @xmath58 and velocity dispersion tensor @xmath59",
    ", one has to integrate the distribution function over all velocities .",
    "these integrals entail large numbers of evaluations of the , and it is important to keep down the cost of each evaluation .",
    "this goal motivates us to tabulate the values of @xmath2 and @xmath3 as functions of the classical integrals @xmath0 , @xmath1 and @xmath60 or @xmath61 .",
    "however , @xmath60 proves ill - suited to this task because its numerical value varies rapidly as one moves through action space .",
    "a more convenient constant of motion is @xmath62 at @xmath63 , which we have chosen to be the minimum of the potential that governs the motion in @xmath32 , @xmath64 so we can think of @xmath65 as the energy invested in radial oscillations .",
    "consequently , for any values of @xmath0 and @xmath1 , @xmath65 vanishes for @xmath39 and takes its largest value for @xmath66 and we can readily obtain @xmath2 and @xmath3 by interpolating between the values taken by @xmath2 and @xmath3 at a grid of values of @xmath65 .    in detail",
    "we structure the grid in @xmath67 space as follows .",
    "the grid points in @xmath1 are defined by the angular momenta of circular orbits with radii uniformly distributed between minimum and maximum radii . for each value of @xmath1",
    "we adopt as grid points in @xmath0 the energies @xmath68 where @xmath69 is the energy of the circular orbit with angular momentum @xmath1 and @xmath70 is slightly smaller than the difference between the energy of that orbit and the escape energy from its circle . for each such energy",
    "we identify @xmath71 , the minimum with respect to @xmath32 of @xmath72 then we find the speed @xmath33 that the star has at this spatial point and determine the values taken by @xmath65 , @xmath61 , @xmath2 and @xmath3 at the phase - space point @xmath73 for values of @xmath74 uniformly distributed in @xmath75 .",
    "with this scheme interpolation errors can be kept below @xmath76 with a grid of size @xmath77 , which takes @xmath78sec to compute on a laptop .",
    "the present algorithm lends itself to tabulation better than the adiabatic approximation because with the present algorithm it is straightforward to resort to the algorithm whenever actions are required for values of the integrals that lie outside the grid .",
    "by contrast , when the adiabatic approximation is used , values of @xmath79 are required for given @xmath3 and these are hard to obtain beyond the limits of the pre - computed table of values of @xmath3 for given @xmath79 .",
    "we have tested the algorithm by numerically integrating orbits in a realistic galaxy potential and after each time - step using the above algorithm to determine @xmath80 . any variation in the recovered values of the actions along",
    "the orbit quantifies errors in the procedure , as do deviations of the motion in the @xmath81 lane from straight lines .",
    "the adopted potential is that of model 2 of @xcite modified to give the thin disc a scale height of @xmath82  this potential is generated by exponential thin and thick stellar discs , plus a gas disc , an axisymmetric bulge with axis ratio @xmath83 and a dark halo with axis ratio @xmath84 .",
    "the upper panel of shows values of the actions along an orbit that has corners at @xmath85 and @xmath86 .",
    "the black points are obtained using the above algorithm , while the red points are obtained with the adiabatic approximation in the superior formulation of @xcite .",
    "quantitatively , with the adiabatic approximation the standard deviations of @xmath2 and @xmath3 are @xmath87 while with the above algorithm they are @xmath88 , smaller by a factor @xmath89 .",
    "the lower panel shows the values taken by @xmath81 at each integration step .",
    "the points lie on straight lines as required and the slopes of plots of @xmath90 versus time agree accurately with the frequencies that are recovered from the formulae of section [ sec : alg ] .",
    "since the upper panel of shows that the actions we recover , either by the present algorithm or from the adiabatic approximation , are tightly correlated , it is natural to ask what else they are correlated with . their correlations with @xmath91 and @xmath27 prove to be extremely small ( especially in the case of the present algorithm ) , but the red squares in show that in the case of the adiabatic approximation @xmath3 ( and therefore @xmath2 also ) is correlated with the combination of angle variables @xmath92 .",
    "this angular dependence implies that as one moves over an orbital torus at constant radius , the error in @xmath3 has one sign in the plane and another far from it , and that the magnitude of this pattern of errors oscillates between pericentre and apocentre , changing sign somewhere in between .",
    "the black triangles in show that the present algorithm yields more accurate actions largely by eliminating this angular dependence .",
    "plots the ratios of the standard deviations of @xmath2 and @xmath3 to @xmath93 as functions of the maximum height @xmath94 attained on the orbit  all orbits were started by dropping particles from @xmath95 .",
    "the fractional error in @xmath3 is never more than 4% and is rarely in excess of 2% .",
    "the error in @xmath2 is larger but is still generally under 2% of the average action .",
    "the pronounced peaks in the errors in both actions around @xmath96 is probably connected with the @xmath97 resonance between the horizontal and vertical motions : none of the orbits contributing to the figure appears to be actually trapped , but for @xmath98 the frequency @xmath99 is very low .",
    "consequently , the small difference between @xmath28 and a stckel potential has appreciable time to disturb the orbit .",
    "the results shown in figs .  [ fig : jj ] to [ fig : sd_juv ] were obtained with @xmath100 .",
    "shows the standard deviations of @xmath2 and @xmath3 along two orbits as functions of @xmath101 .",
    "the orbits have similar eccentricities , but different values of @xmath94 : the upper squares and triangles are associated with an orbit that has @xmath102 , while the lower triangles and points are for an orbit that has @xmath103 .",
    "both orbits have corners at @xmath104 and @xmath105 .",
    "we see that the standard deviation in the values of @xmath3 along the orbit is much less sensitive to the value of @xmath101 than is the standard deviation of the @xmath2 values .",
    "we have shown that values of actions and angles accurate to a couple of percent can be obtained for orbits in a realistic axisymmetric model of the galactic potential by treating the potential as if it were a stckel potential . for orbits typical of observed stars belonging to either the thin or thick discs the error in @xmath3 is always less than @xmath106 of the average action and is usually significantly smaller .",
    "the errors in @xmath2 are always less than 6% and usually less than 2% of the average action . even in the era of gaia",
    "it is unlikely that the errors in the measured phase - space coordinates of any star will be small enough that the inaccuracies inherent in our algorithm will dominate the final uncertainties in derived angles and actions .",
    "the errors in actions obtained from the adiabatic approximation are larger by a factor @xmath89 for thin - disc stars and significantly larger still for thick - disc stars .    a possibility that we have not pursued , but which might be important if one needs to model an entire galaxy rather than the extended solar neighbourhood , is to make the inter - focal semi - distance @xmath101 a function of @xmath1 and @xmath0  by integrating a few orbits at wide - ranging values of @xmath1 and @xmath0 it should be possible to choose a suitable functional form for @xmath107 .",
    "each action evaluation requires a one - dimensional integral and with the existing code takes @xmath108 on a laptop .",
    "each angle evaluation takes about twice as long because it requires of order two one - dimensional integrals .",
    "since evaluation of the observables that follow from a requires a great many evaluations of the actions , it is cost - effective to tabulate @xmath56 as functions of the classical integrals @xmath109 and we have described an effective scheme for doing this . in a companion paper",
    "we illustrate what can be achieved using this scheme by fitting s to observational data for our galaxy ."
  ],
  "abstract_text": [
    "<S> we give an algorithm for the economical calculation of angles and actions for stars in axisymmetric potentials . </S>",
    "<S> we test the algorithm by integrating orbits in a realistic model of the galactic potential , and find that , even for orbits characteristic of thick - disc stars , the errors in the actions are typically smaller than 2 percent . </S>",
    "<S> we describe a scheme for obtaining actions by interpolation on tabulated values that significantly accelerates the process of calculating observables quantities , such as density and velocity moments , from a distribution function .    </S>",
    "<S> [ firstpage ] </S>"
  ]
}