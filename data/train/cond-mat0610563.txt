{
  "article_text": [
    "electronic structure theory plays a crucial role in understanding and controlling nanostructures , structures in nano - meter and ten - nano - meter scales . dynamical simulation in these scales",
    "is , however , impractical for the present standard methodology , such as the car - parrinello method @xcite , owing to its heavy computational cost . from 1990",
    "s , many calculation methods and related techniques have been proposed for large systems , systems with thousands of atoms or more , by calculating one - body density matrix or the green s function , instead of one - electron eigenstates .",
    "@xcite in these methodologies , calculation is carried out with real - space representation and a physical quantity @xmath2 is given as a trace form @xmath3    = \\int\\int d{\\bm r}d{\\bm r}^\\prime     \\rho ( { \\bm r},{\\bm r}^\\prime ) x({\\bm r}^\\prime , { \\bm r } ) .",
    "\\label{trace - eq}\\ ] ] here the one - body density matrix @xmath4 is defined , from occupied one - electron eigenstates @xmath5 , as @xmath6 one can find that , if the matrix @xmath7 is of short range , the off - diagonal long - range component of the density matrix does not contribute to the physical quantity @xmath2 , which is important for practical success of large - scale calculations .",
    "@xcite actual calculation methods and their applications are found in recent reviews @xcite or papers .",
    "@xcite a set of theories and program codes have been developed in our group and a test calculation of fig .",
    "[ fig - cpu - order - n ] shows that the computational cost is order-@xmath8 or proportional to the system size ( @xmath8 ) among the calculations with @xmath0-@xmath9 atoms @xcite .",
    "a practical success in an application study always requires the balance between the accuracy and the computational cost .",
    "every calculation method has several controlling parameters and one should establish a systematic way of setting them in optimal values .",
    "here we remember that a nanostructure is composed of several comparable regions with essential difference in electronic structure , such as bulk and surface regions . since the competition of these regions gives various structural and functional properties of nanostructures ,",
    "the requirement on dynamical simulation of a nanostructure is to reproduce the competition , or to reproduce the difference in electronic structure among the regions , throughout the process .    in this paper",
    ", we will show how to construct an optimal calculation scheme for nanostructure process .",
    "the essential concepts are ( i ) controlling method of the accuracy and the computational cost by monitoring residuals for microscopic or basis freedoms and ( ii ) choice or combination of different calculation methods .",
    "hereafter the word solver method is used as a practical calculation method of density matrix @xmath4 with a given hamiltonian @xmath10 .",
    "this paper is organized as follows ; in sec .",
    "[ theory - solver ] , we will explain the foundation of two methods , krylov subspace method and generalized wannier state method .",
    "they are practical solver methods to calculate the density matrix for a given system and we will compare them , in sec .",
    "[ sec - compari ] , from a practical view point . in sec .",
    "[ sec - hyb ] , we will construct a methodology of multi - solver scheme , as a hybrid or combination of different solver methods .",
    "several applications as molecular dynamics ( md ) simulations will be presented in sec .",
    "[ sec - appl ] , so as to clarify the methodological points . in the present paper , we limit the formulations into those for a hamiltonian @xmath10 as a real - symmetric matrix .",
    "practical calculations were carried out with hamiltonians in the slater - koster ( tight - binding ) form ; the hamiltonian for fcc cu is constructed from the first - order form @xmath11 of the linear muffin - tin orbital theory  @xcite and those for c and si are typical ones in ref .",
    "@xcite and ref .",
    "@xcite , respectively .     the computational time as a function of the number of atoms ( @xmath8 ) ( refs .",
    "@xcite , this work ) ; several metallic ( fcc cu and liquid c ) and insulating ( bulk si ) systems are calculated up to 11,315,021 atoms . the time was measured for the electronic structure calculation with a given atomic structure .",
    "the calculations were carried out by the conventional eigenstate calculation ( eig ) and by our methods for large systems ; ( i ) krylov - subspace method with subspace - diagonalization procedure ( kr - sd ) , ( ii ) wannier - state method with variational procedure ( ws - vr ) and ( iii ) wannier - state method with perturbative procedure ( ws - pt ) . for 1cpu computations , we used single pentium 4@xmath12 processor in 2 ghz .",
    "parallel computations were carried out by sgi origin 3800@xmath12 ( for ws - pt method ) , origin 2800@xmath12 ( for ws - vr method ) and altix 3700@xmath12 ( for kr - sd method ) .",
    "see text for details .",
    ", width=264 ]",
    "krylov subspace is a general mathematical concept defined as the linear space of @xmath13 here the starting vector ( @xmath14 ) and the dimension of the subspace ( @xmath15 ) are arbitrary .",
    "many iterative methods , such as the standard conjugate - gradient method , are formulated with krylov subspace .",
    "see a recent textbook  @xcite , for example . in the present context ,",
    "the matrix @xmath10 is a hamiltonian and @xmath14 is a real space basis .",
    "a large - scale calculation can be realized , when the density matrix @xmath16 is constructed within the krylov subspace @xmath17 .",
    "the krylov subspace method enables us also to calculate the green s function @xmath18 , which gives directly the information of electronic states , such as the density of states ( dos ) . when the dimension @xmath15 is equal to that of the original hamiltonian matrix @xmath10 , the linear space of eq .",
    "( [ eq : krylov1 ] ) is complete and all the calculation results are exact .",
    "@xcite      here we explain a practical solver method with krylov subspace , called subspace - diagonalization method ( kr - sd ) @xcite ; first , we construct an orthogonal basis set @xmath19 for the krylov subspace ( @xmath20 ) ; @xmath21-th basis @xmath22 is constructed in the @xmath23-dimensional krylov subspace ( @xmath24 ) . in result , a reduced hamiltonian matrix @xmath25 is obtained as an explicit @xmath26 matrix .",
    "a typical subspace dimension is @xmath27 in md simulations .",
    "then , we diagonalize the reduced ( small ) matrix @xmath28 with a negligible computational cost .",
    "the resultant eigen vectors @xmath29 are described as the set of coefficients @xmath30 .",
    "the density matrix is obtained by @xmath31 with the definition of @xmath32 here the occupation number @xmath33 is given by the fermi - dirac function with a temperature ( level - broadening ) parameter @xmath34 and the chemical potential @xmath35 .",
    "the chemical potential is determined by the bisection method .",
    "the green s function @xmath36 can be calculated in a similar manner .",
    "@xcite in short , the present procedure is a standard quantum - mechanical calculation for eigen states , except the point that the calculation is carried out within the krylov subspace .",
    "therefore it is straightforward to apply the method to calculations with a nonorthogonal basis set , in which a generalized eigen - value equation , instead of eq .",
    "( [ label - kr - eig ] ) , is solved within the subspace .",
    "another solver method with krylov subspace was formulated and called shifted conjugate - orthogonal conjugate - gradient ( scocg ) method .",
    "@xcite its foundation is given by a mathematical theorem proved recently .",
    "@xcite the practical procedure is based on an iterative solver method for the linear equation of the green s function ; @xmath37 because of @xmath38 .",
    "the density matrix is obtained by @xmath39 the scocg method and kr - sd method share many common features but are different in the numerical treatment .",
    "see the original paper @xcite for detailed comparison . for the present time",
    ", we use , mainly , the kr - sd method for md simulation and we think that the scocg method is suitable to discuss a very fine energy spectrum of the green s function .",
    "so as to monitor the accuracy during the simulation , we calculate a residual vector of the green s function ; @xcite @xmath40 the residual vector is defined individually among the basis suffix @xmath41 .",
    "we observed that the required subspace dimension @xmath42 for a given criteria on the residual vector is different among surface and bulk regions .",
    "@xcite such a determination of the controlling parameters @xmath43 is an example of the accuracy control for microscopic or basis freedoms .",
    "another method for obtaining the density matrix in large systems is formulated using generalized wannier state .",
    "@xcite a physical picture of the generalized wannier states is localized chemical wave function in condensed matters , such as a bonding orbital or a lone - pair orbital with a slight spatial extension or tail. @xcite their wavefunctions @xmath44 are equivalent to the unitary transformation of occupied eigen states and satisfy the equation of @xmath45 where the matrix @xmath46 is the lagrange multipliers for the orthogonality constraint @xmath47 .",
    "the suffix @xmath48 of a wavefunction @xmath49 indicates the position of its localization center , such as bond site . since wannier states give the density matrix @xmath4 in eq .",
    "( [ dm - def ] ) by replacing eigen states @xmath50 into wannier states @xmath51 , any physical quantity can be reproduced in the trace form of eq .",
    "( [ trace - eq ] ) .",
    "our practical solver methods are based on a mapped eigen - value equation @xcite that is equivalent to eq .",
    "( [ rev - sce - unitary ] ) ; @xmath52 where @xmath53 the energy parameter @xmath54 should be much larger than the highest occupied level .",
    "equation  ( [ mfe ] ) was derived in refs .",
    "@xcite and will be derived again , from a different theoretical background , in sec .",
    "[ sec - hyb - theory ] of this paper .",
    "equation ( [ mfe ] ) gives a practical iterative procedure to generate wannier states under explicit localized constraint , @xcite which is called variational wannier state method .",
    "see papers @xcite for details .",
    "residual vector for each wavefunction @xmath55 @xmath56 is monitored for each wannier state during the simulation , so as to control the accuracy , which realizes the accuracy control for microscopic or basis freedoms , as discussed in the krylov - subspace method with eq .",
    "( [ eq - rn ] ) . a practical success in the wannier - state method is realized , when all or a dominant number of wavefunctions are well localized .",
    "examples and technical details are given in sec .",
    "[ appl - silicon - frac ] and references @xcite .",
    "we developed also a perturbative method ,  @xcite in which a perturbation solution of eq .",
    "( [ mfe ] ) is constructed for each wannier state @xmath55 ; @xmath57 here @xmath58 and @xmath59 are the unperturbed and first - order perturbation terms , respectively , and the factor @xmath60 is the normalization factor . the unperturbed term @xmath58 should be prepared as an input quantity and the perturbation term @xmath59 and the normalization factor @xmath60 are determined automatically by the standard first - order perturbation procedure .",
    "@xcite during a simulation , the weight of the unperturbed term @xmath61 is monitored , for each wavefunction , as an accuracy control for microscopic or basis freedoms . in silicon crystal , for example , the ideally @xmath62-bonding wavefunction is chosen as the unperturbed term and the weight of the unperturbed term is dominant ( @xmath63 )  @xcite , which validates the perturbative treatment .",
    "when the perturbative method is validated , its computational performance is faster than that of the variational method , since the perturbative method gives a simpler procedure to generate the wavefunctions and does not require any iteration loop .      when the wannier - state methods are compared with the krylov - subspace methods , the wannier - state methods require an initial guess of wavefunctions in the variational ( iterative ) method or an unperturbed term of wavefunction in the perturbative method . as an example , the reconstruction on si(001 ) surface was calculated with the force on atoms .",
    "the calculation was carried out by the two krylov - subspace methods , ( i ) the subspace diagonalization procedure @xcite and ( ii ) the scocg procedure @xcite , and ( iii ) the variational wannier - state method .",
    "@xcite in the variational wannier - state method , the initial guess of the wavefunctions are prepared to be the lone - pair state of @xmath64 for surface states and to be the @xmath62-bonding states for other ( bulk ) states .",
    "the three methods reproduce the energy differences satisfactorily among the @xmath65 , @xmath66 , and @xmath67 surfaces , when these results are compared with those of the eigen - state calculation with the present hamiltonian @xcite and the standard _ ab initio _",
    "calculation @xcite .",
    "the perturbative wannier - state method is much limited in its applicability than the above three methods , because the unperturbed term should be prepared as a good approximation ( @xmath68 ) .",
    "so far we have applied the perturbative wannier - state method only to the bulk ( @xmath62-bonding ) wavefunction in the diamond - structure solids without deformation or with small ( elastic ) deformation .",
    "@xcite since the first - order perturbation form was used for the wavefunction @xmath69 in these cases , the calculated energy @xmath70 is correct within the second order with respect to deformation and the elastic constants are well reproduced .",
    "we should say , however , that a drastic change of wavefunction , like that in a bond - breaking process , is not reproduced by the perturbative wannier - state method , if the bulk ( @xmath62-bonding ) wavefunction is chosen as the unperturbed term .    despite the limitations ,",
    "the computational performance of the wannier - state methods is faster , at best by several hundred times , than that of the krylov - subspace method , if it is applicable . in fig .",
    "[ fig - cpu - order - n ] , for example , the wannier - state method with the perturbative procedure ( ws - pt ) using single cpu is faster than the krylov - subspace method with the subspace - diagonalization procedure ( kr - sd ) using 64 cpus .",
    "when one thinks about a guiding principle for how to choose a solver method in an application study , the above discussion suggests that the wannier - state methods give a faster performance , when the input wavefunctions are near the final solutions and , particularly , they are well localized .",
    "in other cases , the krylov - subspace method is preferable , since the krylov - subspace method does not require any input quantity for electronic states .",
    "as another fundamental methodology for large - scale calculations , we developed a multi - solver scheme @xcite , as hybrid or combination of two different solver methods .",
    "its basis idea is that the density matrix is decomposed into two parts called subsystems and they are given by different solver methods . as discussed below , the multi - solver scheme will be fruitful , particularly , when the simulation system is composed of different regions , such as bulk and surface regions , and different solver methods are used in these different regions .",
    "the mathematical foundation of the multi - solver scheme is based on the commutation relation of the density matrix ; @xmath71=0 .",
    "\\label{hyb - eqn-0}\\end{aligned}\\ ] ] when the occupied one - electron states , eigenstates or wannier states , are classified into two groups a and b , the density matrix is decomposed into the corresponding two parts @xmath72 where @xmath73 here we call @xmath74 and @xmath75 subsystems and the two subsystems are orthogonal @xmath76 owing to the orthogonality relation @xmath77    if the subsystems @xmath78 are defined from eigenstates , a mapped hamiltonian @xmath79 with a scalar @xmath54 , satisfies the commutation relation @xmath80 = 0   \\label{hyb - eqn - a}\\end{aligned}\\ ] ] owing to eq .",
    "( [ hyb - ortho ] ) and @xmath81 = 0 \\quad ( \\alpha = a , b ) .",
    "\\label{hyb - eqn - ab1 } \\end{aligned}\\ ] ] we call the scalar @xmath54 energy - shift parameter. if @xmath75 is given , the problem for obtaining @xmath82 is reduced to a standard quantum mechanical problem with the well - defined hamiltonian @xmath83 . in practical calculations",
    ", the energy shift parameter is chosen to be so large that the states in @xmath75 do not lie in the occupied energy region of @xmath83 .",
    "note that eqs .",
    "( [ hyb - eqn - a ] ) , ( [ hyb - eqn - ab1 ] ) are satisfied , even if the subsystems @xmath78 are constructed by eigen states with fractional occupancy .    if the subsystems @xmath78 are defined from wannier states , on the other hand , eq .",
    "( [ hyb - eqn - a ] ) are not satisfied , because eq .  ( [ hyb - eqn - ab1 ] ) is not satisfied . then we redefine the mapped hamiltonian as @xmath84 which satisfies eq .",
    "( [ hyb - eqn - a ] ) in the cases of eigenstates and wannier states . see [ appendix - hyb - wani ] for proof .",
    "a simplest case is that the subsystem @xmath74 is consist of only one wannier state @xmath49 . in this case , the mapped hamiltonian in eq .",
    "( [ hyb - ham-1-all ] ) is reduced to that in of eq .",
    "( [ eq - wani - hami ] ) , because of @xmath85 and @xmath86 . in other words ,",
    "the present theory gives another derivation of eq .",
    "( [ mfe ] ) , the mapped equation of wannier state . from a practical view point ,",
    "the term @xmath87 in eq .",
    "( [ hyb - ham-1-all ] ) can be ignored , when the energy shift parameter @xmath54 is so large @xmath88 that the energy band of @xmath75 is well separated , energetically , from that of @xmath74 .",
    "if the term is ignored , the mapped hamiltonian is reduced to the form of eq .",
    "( [ hyb - ham - a ] ) .",
    "correspond to the surface atoms .",
    "the calculation is carried out by the conventional eigen - state calculation ( @xmath89 ) and the present multi - solver scheme ( @xmath90 and @xmath91 ) .",
    "( c)(d ) dos in the multi - solver scheme .",
    "lower panel : dos of the original hamiltonian @xmath10 .",
    "upper panel : dos of the mapped hamiltonian @xmath83 . , width=529 ]      hereafter , the multi - solver scheme will be demonstrated .",
    "although the formulation of the multi - solver scheme is general , we have used , so far , the scheme only with the perturbative wannier - state method for a subsystem ( @xmath75 ) . among these cases ,",
    "the subsystem @xmath75 is determined in the first - order perturbation form , and then the other subsystem @xmath74 is determined , through the mapped hamiltonian @xmath92 , by a different solver method ( @xmath93 ) . in other words ,",
    "the present procedure does not contain a self - consistent loop ( @xmath94 ) .",
    "a related general discussion will be given in sec .",
    "[ hyb - discuss ] .",
    "the first example is a si slab with ideal ( 001 ) surface , in which we use the eigen - state method for @xmath74 and the perturbative wannier - state method for @xmath75 .",
    "each atomic layer contains 64 atoms and the total number of atoms is @xmath95 in the periodic simulation cell . since an ideal ( 001 ) surface gives an almost zero energy gap ( 0.025 ev ) , the present example is one of the severest tests for the present methodology .",
    "the @xmath96 coordinate is written in the unit of atomic layer ( @xmath97 ) .",
    "the surface atoms are located at @xmath98 and have dangling - bond electrons .",
    "the atoms in the opposite surface ( @xmath99 ) are terminated by the bulk ( sp@xmath100-bonded ) wannier states and do not have any dangling - bond electrons .",
    "the @xmath96 coordinate of bulk - bond sites can be described as half integers @xmath101 . in the multi - solver scheme ,",
    "the subsystem @xmath75 is constructed from the wannier states whose localization ( bond ) centers are located deeper than the eighth atomic layer ( @xmath102 ) .",
    "the rest system is assigned to the subsystem @xmath74 that contains the surface states .",
    "the wavefunctions @xmath103 in @xmath75 are determined by the perturbation form and , then , @xmath74 is determined by diagonalizing the mapped hamiltonian @xmath92 .",
    "the energy shift parameter is chosen as @xmath104a.u .",
    "( @xmath105 27.2 ev ) .    in fig .",
    "[ fig - hybrid - tot - density](a ) , the electron populations of the subsystems , @xmath106 and @xmath107 , are plotted as the function of the atomic coordinate @xmath96 .",
    "the total electron population in the multi - solver scheme @xmath108 reproduces the exact one @xmath109 . as a remarkable result",
    ", the population at @xmath110 is contributed by both of the subsystem @xmath74 and @xmath75 with an almost equal weight , since the wannier states located at @xmath111 and those at @xmath112 belong to @xmath74 and @xmath75 , respectively .",
    "figure [ fig - hybrid - tot - density](b ) shows that @xmath106 decays quickly at @xmath113 , because of the nature of the mapped hamiltonian @xmath92 .    so as to understand the multi - solver scheme , figs .",
    "[ fig - hybrid - tot - density](c)(d ) show the dos of the original hamiltonian and the mapped hamiltonian @xmath83 . the energy origin ( @xmath114 ) is chosen at the lowest unoccupied level in @xmath10 .",
    "each eigen level is drawn as a spike with the width of @xmath115 ev . in the dos of the mapped hamiltonian ,",
    "the band in the occupied energy region ( @xmath116 ) is that of @xmath82 , while the band of @xmath75 is shifted by @xmath117 , owing to the term of @xmath118 in @xmath83 , and is located at the high - energy region at @xmath119 . as in fig .",
    "[ fig - hybrid - tot - density](d ) , the two dos profiles agree excellently at the bottom of the unoccupied energy region ( @xmath120ev ) . here",
    "we recall that the original and mapped hamiltonians , from their definitions , share the unoccupied eigen states that gives the density matrix of @xmath121 ( @xmath122=[\\bar{\\rho } , h_{\\rm map}^{\\rm ( a)}]=0 $ ] ) and the disagreement in the present result appears only because @xmath75 is deviated from the exact one .",
    "the excellent agreement at the band bottom ( @xmath120ev ) appears , since these states are contributed dominantly by surface states and are almost free from the subsystem @xmath75 .    , @xmath75 ) .",
    "top ( a ) and three - dimensional ( b ) views of a silicon nano - crystal with 4501 atoms .",
    "atoms are visible , only if its electron population is dominated by the subsystem @xmath74 .",
    "the figures are drawn in ideal crystalline geometry for eye guide , though the actual system is deformed .",
    "the sample edges are plotted as lines for eye guide .",
    "[ fig-4501 - 0716a - hyb - demo ] , width=377 ]      the multi - solver scheme was demonstrated in large - scale calculations .",
    "the first example is reconstructed ( 001 ) surface of si slab with @xmath123 atoms , which is determined with the force on atoms .",
    "the practical procedure is the same as in sec.[hyb - ex1 ] , except the point that the subsystem @xmath74 is calculated by the krylov - subspace ( kr - sd ) method instead of the exact diagonalization method .",
    "the result shows the correct surface reconstruction .",
    "@xcite    the second example is a md simulation of a silicon nanocrystal with 4501 atoms .",
    "the the multi - solver scheme is constructed from the variational wannier - state method for @xmath74 and the perturbative wannier - state method @xmath75 .",
    "@xcite an external load is imposed in the [ 001 ] direction and one initial defect bond is introduced by imposing a repulsive force on an atom pair .",
    "the sample is deformed with external load , the initial defect bond and thermal motion but not fractured .",
    "the subsystems , @xmath74 and @xmath75 , are assigned automatically during the md simulation , as explained below ; first , all the wavefunctions are calculated by the perturbative solver method , in which the weight of the unperturbed term @xmath124 is defined for each wavefunction @xmath125 .",
    "( see sec .",
    "[ sec - wani - on ] ) if the weight @xmath124 of a specific wavefunction is less than 95 % of the averaged weight @xmath126 ( @xmath127 ) , the corresponding wavefunction @xmath125 is assigned into the subsystem @xmath74 and is determined by the variational procedure . in other words , if the perturbative procedure does not give a satisfactory accuracy , the procedure is switched automatically into the variational one .",
    "the result of the automatic assignment is shown in fig .",
    "[ fig-4501 - 0716a - hyb - demo ] , in which atoms are visible , only if its electron population is significantly contributed from @xmath74 . as a result , the subsystem @xmath74 , treated by the variational procedure , appear mainly near the sample edges and in the internal region near the initial defect bond , because these regions are significantly deformed and the electronic states in these regions are fairly deviated from that in ideal crystal .    as a technical detail of the md simulation with the multi - solver scheme",
    ", we used a fine tuning technique of lattice constant ; @xcite in calculations of ideal silicon crystal , the equilibrium lattice constant or bond length differs by 2 % between the variational and perturbative methods .",
    "the difference can cause , in principle , an artificial lattice mismatch in the multi - solver scheme and therefore we tuned the bond length , by imposing an additional two - body classical potential on an atom pair or bond site , if the atom pair is occupied by a perturbative wannier state .",
    "this fine tuning technique avoids the possible artificial lattice mismatch .",
    "although the calculation results without the fine tuning ( not shown ) did not indicate any practical problem among our calculations of silicon , we presume that an error of 2 % in lattice constant might be non - negligible in several cases .",
    "for example , the lattice constant between si and ge is different by 4 % and the artificial lattice mismatch by 2 % might cause a problem , when a si / ge system is calculated .",
    " , since the simulation cell size is smaller .",
    "( b ) dos in a snapshot with 13824 atoms , using the krylov subspace method . the energy origin ( @xmath128 )",
    "is chosen at the chemical potential .",
    "( c ) mean square displacement using the krylov subspace method ( kr ) or the standard eigen - state method . in the latter method ,",
    "the level - broadening parameter in the fermi - dirac function is set to @xmath129ev ( eig1 ) and @xmath130ev ( eig2 ) .",
    "the numbers of atoms are 216 in the main figure and 13824 in the inset , respectively .",
    ", width=529 ]          liquid carbon was simulated with the krylov - subspace method as a test calculation .",
    "the cubic simulation cell is used with 216 and 13824 atoms . the density and the temperature",
    "are set to be @xmath131 g/@xmath132 and @xmath133k , respectively .",
    "the time interval between md steps is set to be @xmath134fs . as technical details , the subspace dimension and the number of atoms in the real - space projection ( see [ sec - appendix - technical ] )",
    "are chosen to be @xmath27 and @xmath135 , respectively .",
    "figure  [ fig - liq - c - rgr](a ) shows the resultant pair correlation ( pc ) function for the conventional eigen - state method with 216 atoms and for the krylov - subspace method with 13824 atoms .",
    "the two graphs are indistinguishable , owing to an excellent agreement . in fig .",
    "[ fig - liq - c - rgr](b ) , the dos is calculated , from the green s function , by the krylov subspace method with 13824 atoms . in the dos calculation , the controlling parameters are set into a heavier computational cost ( @xmath136 and @xmath137 ) , so as to reproduce the fine dos profile .",
    "since the present hamiltonian includes only @xmath138 and @xmath139 orbitals , the resultant dos is missing in higher energy regions .",
    "the imaginary part of the energy @xmath140 is chosen at @xmath141ev .",
    "the resultant dos profile in fig .  [ fig - liq - c - rgr](b ) shows the correct feature of liquid carbon , as follows ; a narrow @xmath142 band appears , from @xmath143ev to @xmath144ev , as in nanotubes , which can be decomposed the bonding and antibonding bands .",
    "the @xmath142 bond in liquid phase is , however , imperfect and non - bonding ( atomic ) @xmath139 states appear as a sharp peak near the chemical potential ( @xmath145ev ) .",
    "figure  [ fig - liq - c - rgr](c ) shows the resultant mean square displacement ( msd ) for the krylov subspace method ( kr ) and the conventional eigen - state method ( eig1,eig2 ) .",
    "the main figure shows a system of 216 atoms by the two methods , while the inset shows that of 13824 atoms by the krylov subspace method . in the eigen - state method , the level - broadening ( temperature ) parameter in the fermi - dirac function is set to @xmath129ev ( eig1 ) and @xmath146ev ( eig2 ) , respectively , so as to show that the detailed treatment near the fermi level causes different fluctuation behaviors of the msd . since the difference in fluctuation behavior",
    "is seen even among the two cases of the eigen - state method , we conclude that the krylov subspace method shows satisfactory agreements with the eigen - state method for pc function and diffusion constant ( the gradient of the linear behavior in the main figure of fig .",
    "[ fig - liq - c - rgr](c ) ) .      as a practical large - scale calculation ,",
    "silicon cleavage process was investigated .",
    "@xcite the wannier - state method is used , since it is faster than the krylov - subspace method , when , as discussed in sec .",
    "[ sec - compari ] , a dominant number of wavefunctions are well localized .",
    "the number of atoms in the localization region for each wannier state ( @xmath147 ) is assigned to be @xmath148 , which is determined by the residual norm @xmath149 .",
    "the resultant density matrix has a spatial spread , in its off - site elements , over regions with hundreds of atoms .",
    "particularly , wavefunctions near cleaved regions tend to have a large residual norm and the localization constraint on such wavefunctions are automatically relaxed to increase the number @xmath147 .",
    "we found that such a way of controlling the accuracy for microscopic freedoms is crucial for reproducing the surface reconstruction on cleaved surface .",
    "see ref .",
    "@xcite for details .",
    "figure [ fig-4501b](a)-(c ) shows a silicon cleavage process with the variational wannier - state method .",
    "the external load is imposed on the @xmath150 $ ] direction , as in our previous simulation @xcite .",
    "the present system , unlike the previous one @xcite , does not contain any initial defect for cleavage seed. in result , the cleavage starts from two points on the sample edges and two cleavage planes appear .",
    "the lower cleavage surface is shown in figs .",
    "[ fig-4501b](d ) and ( e ) . in fig .",
    "[ fig-4501b ] , a rod ( atomic wavefunction ) or ball ( bonding wavefunction ) is assigned for each wavefunction , according to the weight distribution among atoms .",
    "the black rods are the reconstructed bonds that are not seen in the initial ( crystalline ) structure .",
    "a ball is assigned for an atomic ( non - bonding ) orbital , localized on an atom site . on the cleaved surface",
    ", an asymmetric dimer appears , as on a clean ( 001 ) surface , with a ball ( lone - pair state ) on the upper atom , which is shown in fig .",
    "[ fig-4501b](g ) . for quantitative discussion of orbital freedoms ,",
    "a parameter @xmath151 is defined , @xcite for a wave function @xmath152 , as @xmath153 where @xmath154 is the s orbital at the @xmath155-th atom .",
    "for example , @xmath156 in an ideal @xmath62 hybridized state . to visualize the orbital freedom of wave functions , the atomic ( non - bonding ) states are classified by the color of ball , according to the value of @xmath151 ( see the caption of fig .",
    "[ fig-4501b ] ) . after a bulk",
    "( sp@xmath100 ) bond is broken , the corresponding wavefunction is stabilized with increasing the weight of @xmath138 orbitals ( @xmath157 ) , which results in appearance of red or yellow balls on cleaved surface .    as a remarkable result , a well - defined dimer - row domain is formed by nine dimers in fig .  [ fig-4501b](e ) , in which the tilting freedoms of asymmetric dimers are fixed into the @xmath158 configuration , although the surface energy of the @xmath158 surface is higher than that of the @xmath159 surface ( see sec .",
    "[ sec - compari ] ) .",
    "we suggest that the directional anisotropy of deformation is caused by the cleavage propagation direction , as indicated by the green arrow in fig .",
    "[ fig-4501b](e ) , and gives the ordering of the tilting freedoms into the @xmath158 configuration .",
    "we also calculated many other systems ( not shown ) in different sample geometry , which supports the above suggestion .",
    "figure  [ fig-4501b](h ) is a larger system simulated by the multi - solver scheme , in which we use the variational and perturbative wannier - state methods for subsystems @xmath74 and @xmath75 , respectively .",
    "@xcite the system contains 118850 atoms and the sample dimension is @xmath160 in the unit of the atomic layers , where @xmath161 corresponds to about 20 nm . here",
    "the subsystem @xmath74 was composed of selected wannier states near fracture regions and the rest part of the electron system is defined as the subsystem @xmath75 .",
    "the number of wannier states in the subsystem @xmath74 is approximately 5 % of the total and the computational cost by the present multi - solver scheme is nearly @xmath162 of that by the single - solver calculation with the variational procedure . in fig .",
    "[ fig-4501b](h ) , the electronic states in the subsystem @xmath74 are depicted as rods or balls and those in the subsystem @xmath75 are invisible .",
    "the cleave surface in fig .  [ fig-4501b](h ) contains ( 001 ) surface but is fairly unstable with many step formations .",
    "@xcite see refs .",
    "@xcite for the physical discussion of the instability .",
    "finally , a general discussion is made for a practical application of the multi - solver scheme . among the present examples ,",
    "the procedure was carried out without a self - consistent loop ( @xmath93 ) , as explained in the beginning of sec .",
    "[ hyb - ex1 ] .",
    "the present non - selfconsistent procedure is practical , particularly , if the electron system can be decomposed into two parts that are governed by stronger and weaker binding mechanisms , respectively . in the present examples , the electronic states in the bulk part ( @xmath75 )",
    "are governed by a stronger binding mechanism ( the @xmath62 bonding ) than those in surface states ( @xmath74 ) and can be well described without any detailed information of the surface states ( @xmath74 ) .",
    "another example of the decomposition may be a system with strong @xmath163 bonds and weak @xmath142 bonds .",
    "the situation of the decomposition is a candidate of the multi - solver scheme .",
    "when the multi - solver scheme is used , the solver method for each subsystem should be chosen from the discussion of sec .",
    "[ sec - compari ] .",
    "we note that the multi - solver scheme with a self - consistent loop can be realized , in principle , and its practical application might be a possible future work .",
    "this paper presents fundamental theories and practical methods for large - scale electronic structure calculations , particularly for dynamical process with nm - scale or 10-nm - scale structures .",
    "first , we presented several practical solver procedures , based on krylov subspace and generalized wannier state , so as to obtain the density matrix without calculating eigen states .",
    "we emphasized that every method has a way of accuracy control for microscopic freedoms , by monitoring the residuals of exact equations .",
    "second , the multi - solver scheme was formulated based on the commutation relation of the density matrix and was used for a hybrid or combined method of different solver methods .",
    "several practical large - scale calculations were carried out in metallic and insulating cases .",
    "these methodologies enable us to design a simulation of nanostructure process with an optimal computational cost , in which the accuracy is controlled dynamically for microscopic ( basis ) freedoms and solver methods may be different among different regions .",
    "these points are essential in nanostructured systems , nm - scale or 10-nm - scale systems , because a competition between different regions , such as bulk and surface regions , is essential and is required to be reproduced in simulation . since the above requirement is general among nanostructure processes , the present discussion is always valid , even when a different system is calculated by a different solver method from those in the present paper .",
    "this work is supported by a grant - in - aid from the ministry of education , science , sports and culture of japan .",
    "numerical calculation was partly carried out using the facilities of the japan atomic energy research institute , the institute for solid state physics , university of tokyo , and the research center for computational science , okazaki .",
    "krylov - subspace method for a fcc cu system with 10,800 atoms ; ( a ) the convergence behavior of the band structure energy as the function of the subspace dimension @xmath15 ( @xmath1642 , 5 , 10 , 20 , 30 , 60 and 90 ) . a reference value calculated by the standard eigen - state method",
    "is plotted as a dashed line .",
    "( b ) the decay behavior of the density matrix @xmath165 , as the function of the basis number ( @xmath23 ) .",
    "the subspace dimension is set to be @xmath166 and the temperature ( level - broadening ) parameter is set to be @xmath129 ev .",
    "the circle and square indicate the values with the staring bases of the @xmath138 and @xmath167 ( @xmath168 ) orbitals ( @xmath169 ) , respectively .",
    "( c)(d)decay behavior of the density matrix @xmath165 with respect to the basis number of the krylov subspace ( @xmath23 ) .",
    "the circles indicate the result of 10,800-atom system with the real - space projection and the crosses indicate the result of 876-atom system without the real - space projection . the staring basis @xmath170 is chosen to be a @xmath167 ( @xmath168 ) orbital .",
    "the temperature ( level - broadening ) parameter is set to be @xmath129 ev in ( c ) and @xmath171 ev in ( d ) . , width=529 ]",
    "here we prove eq .",
    "( [ hyb - eqn - a ] ) , the fundamental equation in the multi - solver scheme , when the subsystems @xmath74 , @xmath75 are constructed from wannier states in eqs .",
    "( [ hyb - rhoa - eig - dev ] ) and ( [ hyb - rhob - eig - dev ] ) and the mapped hamiltonian @xmath92 is defined by eq .",
    "( [ hyb - ham-1-all ] ) .",
    "we notice that the projection operator onto the unoccupied hilbert space , @xmath172 , is defined as @xmath173 and satisfies @xmath174 equation  ( [ hyb - eqn - a ] ) is satisfied as follows ; @xmath175    & = &   \\left [ h , \\rho_{\\rm a } \\right ]     + 2 \\eta_{\\rm s } \\left [ \\rho_{\\rm b } , \\rho_{\\rm a } \\right ]     - \\left[h \\rho_{\\rm b }   +        \\rho_{\\rm b } h , \\ , \\ , \\rho_{\\rm a } \\right ] { \\nonumber}\\\\   & = &           \\left ( h \\rho_{\\rm a }   -   \\rho_{\\rm a } h \\right ) + 0       -   \\left ( \\rho_{\\rm b } h \\rho_{\\rm a } - \\rho_{\\rm a } h \\rho_{\\rm b }          \\right ) { \\nonumber}\\\\   & = & ( 1- \\rho_{\\rm b } ) h   \\rho_{\\rm a }          -   \\rho_{\\rm a } h \\left ( 1   - \\rho_{\\rm b } \\right ) { \\nonumber}\\\\   & = & ( \\bar{\\rho } + \\rho_{\\rm a } ) h   \\rho_{\\rm a }          -   \\rho_{\\rm a } h \\left ( \\bar{\\rho } + \\rho_{\\rm a } \\right ) { \\nonumber}\\\\   & = & \\bar{\\rho } h   \\rho_{\\rm a }           - \\rho_{\\rm a } h \\bar{\\rho } { \\nonumber}\\\\   & = & h \\bar{\\rho }   \\rho_{\\rm a }           - \\rho_{\\rm a } \\bar{\\rho } h = 0 ,   \\label{qmdm - calc - tochu}\\end{aligned}\\ ] ] where the second equality is obtained by eqs .",
    "( [ hyb - ortho ] ) and the fourth and sixth equality is obtained by eq .",
    "( [ qmdm - unocc0 ] ) and eq .",
    "( [ qmdm - unocc1 ] ) , respectively .",
    "the last equality is obtained by the orthogonality relation of @xmath176 .",
    "here we discuss several technical details of the krylov - subspace method and demonstrate how the method works , particularly in metals . as a demonstration ,",
    "a fcc cu system was calculated with a periodic simulation cell of @xmath177 atoms .",
    "the temperature ( level - broadening ) parameter in the fermi - dirac function is set to be @xmath129ev . as a practical technique",
    ", a real - space projection technique is introduced ; the krylov subspace is generated by a hamiltonian projected in real space , @xmath178 , instead of the original one @xmath10 , where the projection operator @xmath179 projects a function onto the spherical region whose center is located at the atomic position of the @xmath41-th atomic basis .",
    "the resultant krylov subspace is the same as the original one @xmath180 , while the bases lie within the projection region ( @xmath181 ) .",
    "since the procedure of constructing the krylov subspace @xmath182 is independent among the starting bases @xmath183 , all the procedures and the quantities are well - defined with the real - space projection technique .",
    "the projection radius is determined for each starting basis @xmath184 , so that a given number of atoms , @xmath185 , should be contained inside the radius .",
    "the present calculation with @xmath177 atoms was carried out using the projection technique with @xmath186 . the calculation without the projection technique",
    "was also carried out in a smaller ( 876-atom ) system , which is discussed below .    in fig .",
    "[ fig - cu - decay](a ) , the convergence behavior of the calculated band structure energy is shown as the function of the subspace dimension , in which a reference value is also calculated by standard eigen - state calculation with the standard brouillion - zone integration .",
    "the deviation from the reference value is about 0.01 ev per atom for @xmath16410 , 20 and 30 and less than 1 mev per atom for @xmath187 and 90 . since the density matrix @xmath188 is calculated in the form of eq .",
    "( [ eq - dm - summation ] ) , its representation within the krylov subspace @xmath189 is plotted in fig .",
    "[ fig - cu - decay](b ) , where the starting bases @xmath190 are set to be @xmath138 and @xmath167 ( @xmath191 ) orbitals , as examples . in fig .",
    "[ fig - cu - decay](b ) , we observe a @xmath192 or faster decay , and this observation is also seen with the other staring bases ( @xmath139 and @xmath193 orbitals ) .",
    "the decay behavior of fig .",
    "[ fig - cu - decay](b ) is explained by a general mathematical analysis of the lanczos procedure  @xcite , in which a @xmath192 decay should appear with the zero - temperature formulation ( @xmath194 ) and a faster decay should appear with a finite temperature formulation ( @xmath195 ) .",
    "the quantity @xmath196 , on the other hand , also decays as @xmath192 or faster ( not shown ) , since the ( normalized ) vector @xmath197 has a spatial spread within @xmath23-th hopping range from the starting basis ( @xmath24 ) .",
    "consequently , their product ( @xmath198 ) decays as @xmath199 or faster , which validates the fast convergence in the summation of eq .",
    "( [ eq - dm - summation ] ) .",
    "we should emphasis that the decay behavior in fig .",
    "[ fig - cu - decay](b ) comes from a general property of the lanczos procedure , as discussed above , _ not _ from the projection technique .",
    "the above statement is confirmed numerically in figs .",
    "[ fig - cu - decay](c)(d ) , in which fcc cu systems were calculated with or without the real - space projection and the resultant decay behavior is affected significantly by the temperature ( level - broadening ) parameter @xmath34 , but not by the projection technique ."
  ],
  "abstract_text": [
    "<S> fundamental theories and practical methods for large - scale electronic structure calculations are given , in which the computational cost is proportional to the system size . </S>",
    "<S> accuracy controlling methods for microscopic freedoms are focused on two practical solver methods , krylov - subspace method and generalized - wannier - state method . a general theory called the multi - solver scheme </S>",
    "<S> is also formulated , as a hybrid between different solver methods . </S>",
    "<S> practical examples are carried out in several insulating and metallic systems with @xmath0-@xmath1 atoms . </S>",
    "<S> all the theories provide general guiding principles of constructing an optimal calculation for simulating nanostructure processes , since a nanostructured system consists of several competitive regions , such as bulk and surface regions , and the simulation is designed to reproduce the competition with an optimal computational cost . </S>"
  ]
}