{
  "article_text": [
    "the classical matrix - tree theorem , which is usually attributed to either kirchhoff @xcite or brooks et al .",
    "@xcite , states that the product of the nonzero eigenvalues of the combinatorial laplacian on a connected graph is equal to the number of rooted spanning trees of that graph .",
    "this theorem has extensions to graphs with weighted edges ( resistor networks ) and more generally to markov chains .",
    "forman @xcite extended the theorem in a more interesting direction , to the setting of a line bundle on a graph . in this paper , we reprove his result and extend the theorem further to two - dimensional vector bundles on graphs ( with @xmath0 connection ) .",
    "our main theorem gives a combinatorial interpretation of the determinant of the laplacian as a sum over cycle - rooted spanning forests ( crsfs ) .",
    "these are simply collections of edges each of whose connected components has as many vertices as edges ( and therefore , each component is a tree plus an edge : a  unicycle ) . here",
    "the weight of a configuration is the product of @xmath1 minus the trace of the holonomy around each of the cycles .    by varying the connection on the vector bundle , one constructs in this way many natural measures on crsfs",
    ". if the monodromy of the underlying connection is unitary , then these measures are determinantal processes for the edges ( or @xmath2-determinantal in the case of an @xmath0-connection ) .",
    "we give here a number of applications of these results .",
    "further applications can be found in the papers @xcite and @xcite .",
    "one of the main applications is to the study of spanning trees , in particular spanning trees on planar graphs or graphs on surfaces . by a judicious choice of vector bundle connection ,",
    "the natural probability measure on crsfs can be made to model the uniform spanning tree measure conditioned on having certain `` boundary connections . '' as simple examples we compute the probability that , on a finite planar graph , the branch of the uniform spanning tree connecting two boundary points @xmath3 and @xmath4 passes left of a given face or a given two faces .",
    "these probabilities are given in terms of the green s function for the standard laplacian on the graph .",
    "suppose @xmath5 is a graph embedded on an annulus .",
    "on such a graph , a _",
    "@xmath6-function _ is a multi - valued harmonic function whose `` analytic continuation '' around the annulus is a constant times the original function . in other terminology ( defined below )",
    ", it is a harmonic section of a flat line bundle .",
    "the constant is called the _ multiplier _ of the @xmath6 function .",
    "we prove that if @xmath7 is the largest integer such that one can simultaneously embed @xmath7 pairwise disjoint cycles in @xmath5 , each winding once around the annulus , then @xmath5 has at most @xmath8 @xmath6-functions .",
    "these @xmath9-functions have distinct positive real multipliers ; these multipliers are closed under inverses ( if @xmath10 is a multiplier then so is @xmath11 ) . for generic conductances",
    ", @xmath5 will have exactly @xmath8 @xmath6-functions ; we conjecture that this is always the case .",
    "the multipliers have a  probabilistic meaning for crsfs : see below .      for a graph embedded on a surface ( in such a  way that complementary components are contractible or peripheral annuli ) ,",
    "a natural probability model is the uniform random crsf whose cycles are topologically nontrivial ( not null - homotopic ) .",
    "such crsfs are called _ incompressible_. the cycles in a crsf give a finite lamination of the surface , that is , a finite collection of disjoint simple closed curves .",
    "the laplacian determinant on a flat line bundle on the surface counts crsfs weighted by a  function of the monodromy of the connection . by considering the laplacian determinant as a function on the representation variety ( consisting of flat connections modulo conjugacy )",
    ", one can extract the terms for each possible topological type of finite lamination .",
    "in particular , one can study the uniform measure on incompressible crsfs .",
    "for example , the number of components for a uniform incompressible crsf on a graph on an annulus is distributed as a sum of a finite number of independent bernoulli random variables , with biases given by @xmath12 , where @xmath10 runs over the @xmath6-function multipliers defined above .",
    "see corollary [ bernoullicor ] below .    given a riemann surface one can take a sequence of finer and finer graphs adapted to the metric so that the potential theory on the graph and on the riemann surface agree in the limit . in this case , one can show @xcite that the uniform incompressible crsf has a scaling limit , whose distribution only depends on the conformal structure of the underlying surface .",
    "this is similar to the theorem of lawler , schramm and werner on conformal invariance of the uniform spanning tree @xcite .",
    "we compute here for the annulus and the square torus the exact distribution of the number and homology class of the cycles of an incompressible crsf in the scaling limit .      the papers @xcite and @xcite studied crsfs on a  north / east - directed @xmath13 grid on a torus .",
    "the distribution of the number of cycles was shown to have a highly nontrivial structure as a function of  @xmath14 . here",
    "the line bundle laplacian gives quantitative information about the model which was not available in @xcite .",
    "in particular , we obtain an exact expression for the generating function for the number and homology type of the cycles . for the @xmath15 torus ,",
    "for example , we show that the number of cycles tends to a gaussian as @xmath16 with expectation @xmath17 and variance @xmath18 .",
    "the uniform probability measure on spanning trees on a  graph , called the ust measure , has for the past @xmath19 years been a remarkably successful and rich area of study in probability theory .",
    "pemantle @xcite showed that the unique path between two points in a uniform spanning tree has the same distribution as the loop - erased random walk between those two points . and",
    "@xmath20 is defined as follows : draw the trace a simple random walk from @xmath21 stopped when it reaches @xmath20 , and then erase from the trace all loops in chronological order .",
    "what remains is a simple path from @xmath21 to @xmath20 . ]",
    "wilson @xcite extended this to give a simple method of sampling a uniform spanning tree in any graph .",
    "burton and pemantle @xcite proved that the edges of the uniform spanning tree form a determinantal process ( see definition below ) .",
    "this allows computation of multi - edge probabilities in terms of the green s function .",
    "the ust on @xmath22 received particular attention due to the conformal invariance properties of its scaling limit .",
    "pemantle showed that almost surely the ust in @xmath22 has one component . in @xcite",
    ", we proved that the expected length of the lerw in  @xmath22 , and therefore a branch of the ust of diameter  @xmath23 was of order @xmath24 , a result predicted earlier by conformal field theory @xcite . in @xcite",
    ", we showed that the scaling limit of the `` winding field '' ( describing how the branches of the ust wind around faces ) was a gaussian free field .",
    "further conformally invariant properties were proved in @xcite . in @xcite ,",
    "lawler , schramm and werner proved that the @xmath22-lerw converges to @xmath25 , and the peano curve winding around the @xmath22-ust converges to @xmath26 .    as a result of these works",
    ", we have a decent understanding of the scaling limit of the ust on @xmath22",
    ". however , some important questions remain .",
    "for example , how are different points in the ust connected : given a set of points in the plane , what is the topology of their tree convex hull , that is , the union of the branches of the ust connecting them in pairs",
    "? can one compute various connection probabilities , for example , the probability that the lerw from @xmath27 passes through the points @xmath28 in order ?",
    "what is the distribution of the `` bush size , '' the finite component of the tree obtained by removing a single random edge ? while many of these can be answered in principle using sle techniques , in practice one must solve a  hard pde .",
    "many of these questions can be answered with the bundle laplacian . some of these are illustrated below .",
    "we will discuss how these results can be used to compute various connection probabilities for the ust in @xcite , and discuss the connection with integrable systems in @xcite .",
    "let @xmath5 be a finite graph . given a fixed vector space @xmath29 , a _",
    "@xmath29-bundle _ , or simply a _ vector bundle on _",
    "@xmath5 is the choice of a vector space @xmath30 isomorphic to @xmath29 for every vertex @xmath31 of @xmath5 .",
    "a vector bundle can be identified with the vector space @xmath32 .",
    "section _ of a vector bundle is an element of @xmath33 .    a _ connection _ @xmath34 on a @xmath29-bundle is the choice for each edge @xmath35 of @xmath5 of an isomorphism @xmath36 between the corresponding vector spaces @xmath37 , with the property that @xmath38 .",
    "this isomorphism is called the _ parallel transport _ of vectors in @xmath30 to vectors in @xmath39 .",
    "two connections @xmath40 are said to be _ gauge equivalent _ if there is for each vertex an isomorphism @xmath41 such that the diagram    [ cols=\"^ \" , ]     commutes .",
    "in other words @xmath42 is just a base change of @xmath34 . given an oriented cycle @xmath43 in @xmath5 starting at @xmath31 , the _ monodromy _ of the connection is the element of @xmath44 which is the product of the parallel transports around @xmath43 .",
    "monodromies starting at different vertices on @xmath43 are conjugate , as are monodromies of gauge - equivalent connections .",
    "a _ line bundle _ is a @xmath29-bundle where @xmath45 , the one - dimensional complex vector space . in this case , if we choose a basis for each @xmath46 then the parallel transport is just multiplication by an element of @xmath47 .",
    "the monodromy of a cycle is in @xmath48 and does not depend on the starting vertex of the cycle ( or gauge ) .",
    "the laplacian @xmath49 on a @xmath29-bundle with connection @xmath34 is the linear operator @xmath50 defined by @xmath51 where the sum is over neighbors @xmath52 of @xmath31 .",
    "if we assign to each edge a positive real weight ( a conductance ) @xmath53 , the weighted laplacian is defined by @xmath54    note that if the vector bundle is _ trivial _ , in the sense that @xmath36 is the identity for all edges , this is the classical notion of graph laplacian ( or more precisely , the direct sum of @xmath55 copies of the laplacian ) .",
    "here is an example .",
    "let @xmath56 with vertices @xmath57 .",
    "let @xmath34 be the line bundle connection with @xmath58 . then in the natural basis",
    ", @xmath49 has matrix @xmath59      one can extend the definition of a vector bundle to the edges of @xmath5 . in this case",
    ", there is a vector space @xmath60 for each edge @xmath61 as well as each vertex .",
    "one defines connection isomorphisms @xmath62 for a vertex @xmath31 and edge @xmath61 containing that vertex , in such a way that if @xmath35 then @xmath63 , where @xmath36 is the connection on the vertex bundle .",
    "the vertex / edge bundle can be identified with @xmath64 , where  @xmath65 is the direct sum of the edge vector spaces .",
    "a _ @xmath66-form _ ( or cochain ) is a function on oriented edges which is antisymmetric under changing orientation .",
    "if we fix an orientation for each edge , a  @xmath66-form is a section of the edge bundle , that is , an element of @xmath67 .",
    "we denote by @xmath68 the space of @xmath66-forms and @xmath69 the space of @xmath70-forms , that is , sections of the vertex bundle .",
    "we define a map @xmath71 by @xmath72 where @xmath73 is an oriented edge from vertex @xmath74 to vertex @xmath75 .",
    "we also define an operator @xmath76 as follows : @xmath77 where the sum is over edges containing @xmath31 and oriented toward @xmath31 . despite the notation ,",
    "this operator @xmath78 is not a standard adjoint of @xmath79 unless @xmath80 and @xmath81 are adjoints themselves , that is , if parallel transports are unitary operators ( see below ) .",
    "the laplacian @xmath49 on @xmath82 can then be defined as the operator @xmath83 : @xmath84    we can see from the example ( [ 3vexample ] ) above on @xmath85 that @xmath49 is not necessarily self - adjoint .",
    "however , if @xmath36 is unitary : @xmath86 then @xmath78 will be the adjoint of @xmath79 for the standard hermitian inner products on @xmath87 and @xmath67 , and so in this case @xmath49 is a hermitian , positive semidefinite operator .",
    "in particular on a line bundle if @xmath88 for all edges @xmath35 , then @xmath49 is hermitian and positive semidefinite .",
    "for a line bundle @xmath89 on a finite graph @xmath5 , we have a combinatorial interpretation of the determinant of the laplacian in terms of cycle - rooted spanning forests .",
    "cycle - rooted spanning forest _ ( crsf ) is a subset @xmath90 of the edges of @xmath5 , spanning all vertices ( in the sense that every vertex is the endpoint of some edge ) and with the property that each connected component of @xmath90 has as many vertices as edges ( and so has a unique cycle ) .",
    "see figure [ crsf ] .",
    "an _ oriented crsf _ is a crsf in which we orient each edge in such a way that cycles are oriented coherently and we orient the edges not in a cycle toward the cycle .",
    "an oriented crsf is the same as a",
    "_ nonzero vector field _ on @xmath5 , which is the choice of a single outgoing edge from each vertex .    a _ cycle - rooted tree _ ( crt ) ,",
    "also called unicycle , is a component of a crsf ( oriented or not ) .",
    "the following theorem is due to forman  @xcite .",
    "[ mainline ] for a line bundle on a connected finite graph , @xmath91 where the sum is over all unoriented crsfs @xmath92 , the product is over the cycles of @xmath92 , and @xmath93 are the monodromies of the two orientations of the cycle .",
    "recall that for a line bundle the monodromy of an oriented cycle does not depend on the starting vertex .",
    "note that we could as well have written @xmath94 where now the sum is over oriented crsfs ( ocrsfs ) .",
    "forman uses an explicit expansion of the determinant as a sum over the symmetric group , and a careful rearrangement of the terms .",
    "we give a different proof using cauchy ",
    "binet formula which allows us to bypass this step.=-1    proof of theorem [ mainline ] we use the cauchy ",
    "binet formula , @xmath95 , where @xmath96 is a maximal minor of @xmath79 ( i.e. , if @xmath79 is @xmath97 then @xmath96 runs over all @xmath15 submatrices of @xmath79 obtained by choosing @xmath23 columns ) .",
    "columns of @xmath96 index vertices and rows of @xmath96 index edges of @xmath5 .",
    "since @xmath96 is square , it corresponds to a selection of @xmath23 edges ( where @xmath23 is the number of vertices of @xmath5 ) .",
    "if the set of edges in @xmath96 contains a component @xmath92 with no cycles , say of  size @xmath98 , this component necessarily has @xmath99 edges .",
    "so @xmath96 maps a @xmath7-dimensional subspace of the vertex space to a @xmath99-dimensional subspace of the edge space and so @xmath100 . therefore to have a nonzero contribution to the sum every component of @xmath96 has at least one cycle , and , since the total number of vertices equals the total number of edges , every component must have exactly one cycle .",
    "we have proved that the sum is over crsfs .    if @xmath96 has only one component which is a crt , orient its edges so that all edges are oriented toward the unique cycle , and along the cycle choose one of the two coherent orientations .",
    "write @xmath101 the only nonzero terms in this expansion are those in which vertex @xmath102 is adjacent to edge @xmath103 , that is , the two terms which are consistent with one of these two orientations .",
    "thus @xmath104\\\\[-8pt ] & & { } \\times\\biggl(\\prod_{j\\in \\mathrm{bushes } } -\\phi_{v_je_j } \\prod_{i\\in\\mathrm{cycle}}-\\phi_{v_{i+1}e_i}\\biggr)\\nonumber\\\\ & = & \\operatorname{sgn}(\\sigma_1)(-1)^n \\prod_{j\\in\\mathrm{bushes } } \\phi_{v_je_j}\\biggl(\\prod_{i\\in \\mathrm{cycle}}\\phi_{v_ie_i}- \\prod_{i\\in\\mathrm{cycle}}\\phi_{v_{i+1}e_i}\\biggr),\\nonumber\\end{aligned}\\ ] ] where the products over @xmath105 are over edges not in the cycle ( called bush edges ) , and those over @xmath102 are for the two cyclic orientations ( indices are taken cyclically ) . if the cycle has odd length , @xmath106 and the sign change in front of the second product in ( [ line2 ] ) is due to switching the sign on the odd number of edges of the cycle .",
    "if the cycle has even length , the sign change is due to @xmath107 ( a  cyclic permutation of even length has signature @xmath108 ) .",
    "we similarly have @xmath109 and multiplying these two and using @xmath110 , we get @xmath111 where @xmath112 which is the monodromy of the cycle .",
    "if each component of @xmath96 is a crt , then @xmath113 is the product over components of the above contributions .",
    "in the case of a line bundle @xmath34 with unitary connection , theorem [ mainline ] provides a definition of a natural probability measure  @xmath114 on crsfs .",
    "a crsf has probability equal to @xmath115 where the product is over its cycles .",
    "the constant of proportionality @xmath116 , or partition function , is then just @xmath117 .",
    "note that as long as the ( unitary ) bundle is not trivializable ( gauge equivalent to the trivial bundle ) then some cycle has nontrivial monodromy and so @xmath118 .",
    "the goal of this section is to show that the measure is determinantal for the edges .",
    "the laplacian is the composition : @xmath119 if @xmath49 has full rank , then @xmath68 splits as @xmath120    a section @xmath121 is _ harmonic _ if @xmath122 . if @xmath49 does not have full rank ,",
    "there are nontrivial harmonic sections and the above is no longer a direct sum . a @xmath66-form @xmath123 is harmonic if it is in the intersection @xmath124 .",
    "such a form is both _ exact _ ( @xmath125 for some @xmath126 ) and _ co - closed _ ( @xmath127 ) .",
    "[ pdef ] when @xmath49 has full rank , the projection along @xmath128 from @xmath129 to the space of exact @xmath66-forms @xmath130 is given by the operator @xmath131 where @xmath132 is the green s function for @xmath49 on @xmath82 .",
    "note that @xmath131 is zero on co - closed forms and the identity on exact forms : @xmath133 .",
    "this projection operator @xmath134 plays a role below .",
    "let @xmath135 be a probability measure on @xmath136 .",
    "for a set of indices @xmath137 , define the set @xmath138 we say @xmath135 is a _",
    "determinantal _ probability measure ( see , e.g. , @xcite ) if there is an @xmath15 matrix @xmath139 with the property that for any set of indices @xmath137 , we have @xmath140.\\ ] ] that is , principal minors of @xmath139 determine the probability of events of type  @xmath141 .",
    "the matrix @xmath139 is called the _ kernel _ of the measure .",
    "a simple example of a  determinantal process is the product measure , in which case @xmath139 is a  diagonal matrix with diagonal entries in @xmath142 $ ] .",
    "another well - known example of a determinantal process is the uniform spanning tree measure on a finite graph  @xcite . here",
    "@xmath143 index the edges of a connected graph .",
    "the kernel  @xmath139 is the so - called _ transfer - current matrix _ , defined by @xmath144 , where  @xmath145 is the green s function , see @xcite .",
    "a simple inclusion - exclusion argument shows that individual point probabilities are also given by determinants :    [ pointprobs ] let @xmath146 .",
    "then @xmath147 where @xmath148 is the diagonal matrix whose diagonal entries are @xmath149 , and @xmath150 .",
    "we will need the following well - known lemma .",
    "[ schur ] if @xmath151 is a block matrix with @xmath152 square and @xmath153 invertible then @xmath154    this follows from @xmath155    recall the definition of the projection @xmath134 from @xmath66-forms to exact @xmath66-forms ( proposition [ pdef ] ) .    for a line bundle @xmath34 with unitary connection , with respect to the measure",
    "@xmath156 the edges of the crsf form a determinantal process with kernel @xmath131 .",
    "let @xmath5 be a graph with @xmath23 vertices and @xmath157 edges .",
    "let @xmath158 be the edges of a crsf @xmath43 .",
    "write the matrix for @xmath79 and @xmath78 so that the first  @xmath23 edges are @xmath159",
    ". then @xmath160 where @xmath161 is @xmath15 and @xmath162 is @xmath163 .    from proposition",
    "[ pointprobs ] , the probability of @xmath43 is @xmath164 which by lemma [ schur ] with @xmath165 and @xmath166 can be written @xmath167 by theorem [ mainline ] this is exactly the probability of @xmath43 .    among other things , this theorem along with proposition [ pointprobs ] allows us to do exact sampling from the measure @xmath156 , as follows ( see @xcite ) .",
    "pick an edge  @xmath168 ; it is present with probability @xmath169 .",
    "take another edge  @xmath170 ; if @xmath168 is present ,  @xmath170 will be present with probability @xmath171 if @xmath168 is not present , @xmath170 will be present with probability @xmath172 and so on .",
    "an important limit , or actually set of limits of these determinantal processes , is when the monodromies tend to @xmath66 .",
    "even though @xmath117 tends to zero , the probability measures @xmath156 may converge .",
    "we get determinantal processes supported on crsfs on the graph with trivial line bundle .",
    "choose an orientation for each edge and suppose the parallel transport is @xmath173 for the @xmath105th edge in the direction of its orientation .",
    "fix the @xmath174 and let @xmath175 . in the limit @xmath175 the determinantal process @xmath176 tends to a determinantal process @xmath177 supported on crsfs with a  single component , that is , crts .",
    "the probability of a crt is proportional to @xmath178 , where the sum is over oriented edges in the unique cycle .",
    "the monodromy of a loop is @xmath179 .",
    "we have @xmath180 . in the limit @xmath175 ,",
    "the partition function is @xmath181 so only crsfs with one component contribute .",
    "let @xmath5 be a finite graph with @xmath157 vertices and @xmath182 the @xmath23-cycle .",
    "let @xmath183 be the product graph whose vertices are @xmath184 and edges connect @xmath185 to @xmath186 and @xmath185 to @xmath187 when @xmath188 are neighbors in @xmath5 .",
    "we compare the uniform spanning tree on @xmath183 and the uniform cycle - rooted tree whose cycle winds around @xmath182 .",
    "minimum cut set _ of a spanning tree is the set of edges not in the tree such that when added to the tree make a cycle winding nontrivially around @xmath182 .",
    "fix @xmath189 with @xmath190 . on the product graph",
    "@xmath183 let @xmath191 except when @xmath192 and @xmath193 in which case @xmath194 .",
    "then cycles have trivial monodromy unless they wind nontrivially around the @xmath182 direction .",
    "so a crsf has nonzero probability only if all of its cycles wind nontrivially around @xmath182 ( possibly many times ) .",
    "because of the product structure the eigenvectors of the laplacian on @xmath183 are products of eigenvectors of the standard laplacian on @xmath5 and the line bundle laplacian on @xmath182",
    ". thus , the eigenvalues of the laplacian on @xmath183 are sums of eigenvalues of @xmath195 ( the standard laplacian ) and @xmath196 ( the line bundle laplacian ) .",
    "the eigenvalues of @xmath196 are @xmath197 where @xmath198 ranges over the roots of @xmath199 ( the corresponding eigenvectors are exponential functions ) .",
    "the laplacian determinant of @xmath183 is then @xmath200\\\\[-8pt ] & = & ( 2-z - z^{-1})\\prod_{\\zeta^n = z}\\prod_{\\lambda\\ne0}(\\lambda+2-\\zeta -\\zeta^{-1}),\\nonumber\\end{aligned}\\ ] ] where @xmath10 runs over the eigenvalues of the laplacian on @xmath5 .",
    "compare this to @xmath201 , the product of nonzero eigenvalues of the standard laplacian @xmath202 on @xmath183 : @xmath203    as @xmath16 a @xmath114-random crsf has one component with probability tending to @xmath66 , that is , is a crt .",
    "its unique cycle winds around  @xmath182 once with probability tending to @xmath66 .",
    "the ratio @xmath204 of the number of such crts and number of spanning trees satisfies @xmath205 .",
    "the expected length  @xmath206 of the cycle in such a random crt of @xmath183 satisfies @xmath207 where @xmath208 is the expected size of the minimum cut set of a random spanning tree of @xmath183 .",
    "the first two statements can be seen as follows .",
    "take @xmath23 large and consider the part of the configuration in a piece @xmath209 $ ] for large @xmath210 .",
    "we claim that the number of spanning tree configurations restricted to this subgraph , as a function of @xmath210 , has a strictly larger exponential growth rate than that of the number of spanning forest configurations in this subgraph with two or more components ( `` strands '' ) each of which intersects both ends @xmath211 and @xmath212 .",
    "the growth rate of spanning trees can be computed as the leading eigenvalue of nonnegative finite matrix @xmath213 , the transfer matrix .",
    "occurring in a spanning tree of @xmath214 along with a partition of the components in this forest , which describes which components of this forest are connected to each other to the left , that is , in the part of the tree in @xmath215 $ ] . ]",
    "it is easily seen that the transfer matrix @xmath213 is primitive , that is , has the property that some power is strictly positive . on the other hand ,",
    "the transfer matrix for spanning forest configurations with two or more strands is a  matrix which can be obtained from @xmath213 by setting some of its positive entries to @xmath70 ( those entries whose components are all connected to the left ) .",
    "this strictly decreases its leading eigenvalue .",
    "this proves the claim and the first two statements of the theorem .",
    "if we divide ( [ ncrsfs ] ) by @xmath216 and let @xmath217 tend to @xmath66 the expression counts crsfs with one component , that is , crts , with a weight @xmath218 if they wind @xmath7 times around @xmath219 , because @xmath220 as @xmath23 gets large crts which wind more than once around have probability tending to zero . line ( [ nrootedtrees ] ) is the number of rooted trees ; dividing by @xmath221 , the number of locations for the root , gives the number of trees , which by ( [ ncrsfs ] ) and the above remarks is @xmath222 times the number of crts winding once around , plus errors tending to zero as @xmath16 .",
    "this proves the third statement .",
    "the following two sets @xmath223 and @xmath96 are in bijection : @xmath223 is the set of crts whose cycle winds once around @xmath182 , along with the choice of an edge on this cycle .",
    "@xmath96 is the set of spanning trees with a choice of a complementary edge in the minimum cut set .",
    "the bijection consists in adding the edge to the tree .",
    "therefore , the expected length of the unique cycle in a random crt is @xmath224 by the above , @xmath225 .",
    "putting weights on the edges is a minor generalization ; let @xmath226 be a conductance associated to each edge , with @xmath53 .",
    "we then define @xmath227    in other words , letting @xmath92 be the diagonal matrix , indexed by the edges , whose diagonal entries are the conductances , we have @xmath228    @xmath229 where the first product is over all edges of the configuration and the second is over cycles , and  @xmath230 is the monodromy of the cycle as before .",
    "this follows directly from the proof of theorem [ mainline ] above .",
    "we can also have weights which depend on direction , so that each edge has two weights , one associated to each direction .",
    "this makes @xmath5 into a markov chain , in which the transition probabilities are proportional to the edge weights .    in this case",
    "the laplacian has the same form @xmath231 except that @xmath232 in general .",
    "the operator @xmath233 can be defined by @xmath234 as in the unweighted case , where @xmath235 , and @xmath78 by @xmath236 where the sum is over edges @xmath235 containing @xmath31 .    in this case , each oriented crsf has a different weight .",
    "forman s theorem in this case is the following .",
    "[ directed ] @xmath237 where the sum is over oriented crsfs , the first product is over the edges in the bushes ( i.e. , not in the cycles ) , oriented toward the cycle , and the second product is over oriented cycles , @xmath238 is the product of semiconductances along @xmath43 and @xmath230 is the monodromy of @xmath43 .",
    "an application is in section [ monotone ] below .",
    "let @xmath5 be a graph with line bundle and connection @xmath34 and @xmath90 a subset of its vertices , which play the role of boundary vertices .",
    "we can define a laplacian @xmath239 with dirichlet boundary conditions at @xmath90 as follows : for @xmath240 and @xmath241 , @xmath242 this is of course just the laplacian @xmath243 restricted to the subspace @xmath244 of functions which are zero on @xmath90 and projected back to this subspace . as a  matrix",
    ", it is just a submatrix of @xmath243 .",
    "an _ essential crsf _ of @xmath245 is a set of edges in which each component is either a tree containing a unique vertex in @xmath90 or a cycle - rooted tree containing no vertices in @xmath90 .",
    "[ theo7 ] @xmath246 is the weighted sum of essential crsfs , where each configuration has weight @xmath247 , where @xmath230 is the monodromy of the cycle .",
    "this generalizes the matrix - tree theorem from @xmath49 is equal to the number of spanning trees rooted at @xmath31 . ]",
    "( when @xmath34 is the identity and @xmath248 ) and the matrix - crsf theorem ( when @xmath249 ) .",
    "proof of theorem [ theo7 ] the proof follows the same lines as the proof of theorem [ mainline ] .",
    "now @xmath79 is an @xmath13 matrix with @xmath250 .",
    "a maximal minor @xmath96 of @xmath79 corresponds to a choice of @xmath23 edges .",
    "each component of @xmath96 is either a crt , in which case its weight is computed as before , or a tree connecting some vertices of @xmath251 with a single vertex of @xmath90 . in this case , the determinant of @xmath96 ( we mean , that part of @xmath96 coming from this component ) has a single nonzero term in its expansion , and the corresponding term in  @xmath252 is its inverse .",
    "so each tree component counts @xmath66 .",
    "again when @xmath253 there is a determinantal measure associated with @xmath49 .",
    "we can extend many of the above results to the case of a @xmath254-bundle with @xmath0-connection .",
    "given @xmath256 define @xmath257 , the adjugate of @xmath223 .",
    "that is , if @xmath258 then @xmath259 .",
    "note that @xmath260 is a scalar .",
    "let @xmath261 be a matrix with entries in @xmath262 .",
    "@xmath261 is said to be _ self - dual _ if @xmath263 .",
    "in particular , diagonal entries must be scalar matrices .    for a matrix @xmath261 with noncommuting entries",
    ", there are many possible ways one might define its determinant : however these all involve the expansion @xmath264_{\\sigma},\\ ] ] where @xmath265_\\sigma$ ] denotes the product of the terms @xmath266 after they have been rearranged in some specified order depending on @xmath267 .",
    "each of these `` order functions '' determines a different possible determinant .    in the current case",
    ", there is one very natural condition to put on these orders .",
    "if @xmath267 is written as a product of disjoint cycles , then in the corresponding order the terms in each cycle of @xmath267 should appear consecutively .",
    "moreover , if @xmath268 are two permutations with the same cycles , except that some of the cycles are reversed , then the corresponding order should have the cycles appear in the same relative order .",
    "the advantage of this for self - dual matrices is that the product of entries along a cycle is the adjugate of the product along the reversed cycle ; so that the sum of these is a scalar by ( [ scalar ] ) .",
    "thus by grouping permutations into sets with the same cycles up to reversals , one arrives at a product of scalar matrices . the sum ( [ mdetexp ] ) with appropriately rearranged products then yields a  @xmath269 scalar matrix @xmath270 , and the number @xmath2 is defined to be the determinant .",
    "the @xmath255-determinant of self - dual matrix @xmath261 @xcite is defined in precisely this way .",
    "we define @xmath271 where the sum is over the symmetric group , each permutation @xmath267 is written as a product of disjoint cycles , and @xmath272 is the trace of the product of the matrix entries in that cycle .",
    "if we group together terms above with the same cycles  up to the order of traversal of each cycle  then the contribution from each of these terms is identical : reversing the orientation of a cycle does not change its trace .",
    "so we can write @xmath273 where the sum is over cycle decompositions of the indices , @xmath274 is the number of cycles , and @xmath275 is the monodromy ( in one direction or the other ) of each cycle . here",
    "@xmath276 is equal to the trace for cycles of length at least @xmath277 ; cycles of length  @xmath66 or @xmath1 are their own reversals so we define @xmath278 for these cycles.=-1    as an example , let @xmath279 and @xmath280 .",
    "then @xmath281    note that if @xmath261 is a self - dual @xmath15 matrix then @xmath282 , considered as a  @xmath283 matrix is antisymmetric , where @xmath116 is the matrix with diagonal blocks @xmath284 and zeros elsewhere . the following theorem allows us to compute @xmath255-determinants explicitly .",
    "let @xmath261 be an @xmath15 self - dual matrix with entries in @xmath262 and @xmath285 the associated @xmath283 matrix , obtained by replacing each entry with the @xmath269 block of its entries .",
    "then @xmath286 , the pfaffian of the antisymmetric matrix @xmath287 .      for a @xmath254-bundle on a graph @xmath5 with @xmath0 connection",
    "@xmath49 is a self - dual operator ( in the above sense ) .",
    "[ mainsl2 ] for a @xmath254-bundle on a connected graph @xmath5 with @xmath0 connection , @xmath288 where @xmath272 is the trace of the monodromy of the cycle .",
    "the proof generalizes the proof of theorem [ mainline ] .",
    "we use as before the cauchy  binet formula which holds for general @xmath255-determinants ( theorem  [ cb ] below ) .",
    "suppose @xmath5 has @xmath23 vertices .",
    "write @xmath289 . here",
    "@xmath96 runs over choices of @xmath23 edges of @xmath5 .",
    "if @xmath96 corresponds to a set of edges which has a component with no cycle , that is , a component with @xmath99 edges and @xmath7 vertices , the corresponding matrix @xmath96 is singular ( in fact has a block form with nonsquare blocks ) and so @xmath290 .",
    "thus , as before , each component of @xmath96 must have exactly one cycle .",
    "we now work directly with @xmath291 .",
    "note that this is the laplacian on the subgraph defined by  @xmath96 .",
    "suppose that @xmath96 has only one component ; the general case is similar .",
    "a  nonzero term in the expansion of the determinant corresponds to a decomposition of @xmath267 into cycles ; the only such terms which are nonzero are when adjacent vertices are paired , each vertex is fixed , or the vertices on the unique cycle are advanced or retreated in the direction of that cycle and the other vertices are fixed .",
    "consider the case when some vertices are paired ; if @xmath292 are paired in @xmath291 then @xmath96 maps @xmath102 and @xmath105 to the same edge @xmath293 , so this term does not contribute . if no terms are paired , the expansion of the @xmath255-determinant for @xmath291 therefore has exactly four terms .",
    "it has two terms in which @xmath267 fixes the bush vertices and advances the cycle vertices around the cycle in one of the two orientations .",
    "it also has two terms in which all vertices are fixed : the vertices in the cycle advance to the edges in one of the two directions and then retreat back to their original positions .",
    "the signs work out as before .",
    "[ cb ] @xmath294 where @xmath295 runs over maximal minors of @xmath296 , and @xmath297 is the corresponding minor of  @xmath298 .",
    "proof suppose @xmath296 is @xmath97 with @xmath299 .",
    "the standard proof only relies on the multilinearity of the determinant .",
    "write columns of @xmath300 as linear combinations of columns of @xmath296 with coefficients in @xmath298 ( acting on the right ) . use multilinearity to write this as a sum of @xmath301 @xmath255-determinants ; the @xmath255-determinant of one of these is zero if two of the same columns are used .",
    "group the remaining @xmath157 choose @xmath23 nonzero terms into products@xmath302 .",
    "let @xmath303 be an oriented surface , possibly with boundary , and @xmath5 a graph embedded on @xmath303 in such a way that complementary components are contractible or peripheral annuli ( i.e. , an annular neighborhood of a boundary component ) .",
    "we call the pair @xmath304 a _ surface graph_.    for each boundary component there is a `` peripheral '' cycle on @xmath5 , consisting of those vertices and edges bounding the same complementary component as the boundary component .",
    "an _ finite lamination _ or _ simple closed curve system _ on @xmath303 is ( the isotopy class of ) a finite set of pairwise disjoint simple closed curves on @xmath303 each of which has nontrivial homotopy type ( i.e. , no curve bounds a disk ) .",
    "we allow two or more curves in the lamination to be isotopic .      given a surface graph",
    "@xmath304 a vector bundle on @xmath5 with connection @xmath34 is _ flat _ if it has trivial monodromy around any face ( contractible complementary component of @xmath303 ; peripheral cycles do not bound faces ) . in this case , given a closed loop starting at a base point @xmath31 , the monodromy around a loop only depends on the homotopy class of the ( pointed ) loop in @xmath305 , and so the monodromy determines a representation of @xmath305 into @xmath306 .",
    "this representation depends on the base point for @xmath307 ; choosing a different base point will conjugate the representation .",
    "conversely , let @xmath308 be a representation of @xmath305 into @xmath306 ; for a fixed base point there is a unique flat line bundle , up to gauge equivalence , with monodomy @xmath309 .",
    "it is easy to construct : start with trivial parallel transport on the edges of a spanning tree of @xmath5 . now on each additional edge , adding it to the tree makes a unique cycle ; define the parallel transport along this edge to be the image of the homotopy class of this cycle under @xmath309 .",
    "thus , we have a correspondence between flat bundles modulo gauge equivalence and a space @xmath310 , the space of homomorphisms of @xmath305 into @xmath306 modulo conjugation .",
    "this space @xmath311 has the structure of an algebraic variety : it can be represented using variables for the matrix entries of a set of generators of @xmath312 , modulo an ideal corresponding to the relations in @xmath305 and the conjugation relations . the variety @xmath311 is called the _ representation variety _ of @xmath305 in @xmath306 .",
    "when dealing with flat bundles it is natural to restrict our attention to crsfs each of whose cycles is topologically nontrivial , since other crsfs have zero weight in @xmath117 .",
    "we call these _ incompressible crsfs_. the cycles in an incompressible crsf form a finite lamination .",
    "we now restrict to @xmath313 and @xmath314-connections . for a flat bundle",
    ", @xmath117 is a regular function on the representation variety @xmath315 ( i.e. , it is a polynomial function of the matrix entries ) .",
    "remarkably , by varying the representation it is possible to extract from @xmath117 those terms for incompressible crsfs whose cycles have any given set of homotopy types .",
    "the following theorem is due to fock and goncharov @xcite :    [ theo11 ] if @xmath303 has nonempty boundary , the products @xmath316 over all finite laminations form a basis for the vector space of regular functions on the representation variety @xmath317 .    in our case",
    ", @xmath117 is a regular function on @xmath311 ; hence it can be written @xmath318 where @xmath319 , the sum is over finite laminations @xmath320 , the product is over curves @xmath43 in @xmath320 and @xmath230 is the monodromy of @xmath43 . by an integral change of basis ( in fact an upper triangular integer matrix , if we order isotopy types of finite laminations by inclusion )",
    "we can write this as @xmath321 and therefore by theorem [ mainsl2 ] , @xmath322 is the desired weighted sum of crsfs with lamination type @xmath320 .",
    "the actual extraction of a coefficient can be done as follows .",
    "there is  a  natural measure @xmath135 on @xmath311 , essentially just the product of @xmath7 copies of haar measure on @xmath314 , where @xmath7 is the rank of the free group @xmath305 .",
    "the regular functions discussed above form a basis for the hilbert space @xmath323 ( not an orthonormal basis but obtained from an orthonormal basis by an upper - triangular linear transformation ) .",
    "thus , one can obtain @xmath324 above by an integration of @xmath117 against a particular function over  @xmath311 .",
    "the simplest example of a surface graph , after a graph on a disk , is a graph on an annulus .",
    "suppose @xmath304 is a surface graph on an annulus .",
    "since @xmath325 is abelian , it will suffice to work with a line bundle ( a @xmath326 subgroup of @xmath0 will have the same traces as a @xmath326 subgroup of diagonal matrices in @xmath0 , which is equivalent to taking a line bundle connection ) .",
    "let @xmath327 be the monodromy of a flat line bundle .",
    "then @xmath328 is a laurent polynomial in @xmath217 .",
    "it is reciprocal : @xmath329 by theorem [ mainline ] .",
    "[ reality ] @xmath330 is a reciprocal polynomial with real and positive roots and a double root at @xmath331 .",
    "we emphasize here that the roots of @xmath134 are unrelated to the eigenvalues of @xmath49 .",
    "rather they are special values of the monodromy @xmath217 for which @xmath49 is singular .",
    "we conjecture that the roots are distinct .",
    "proof of theorem [ reality ] when @xmath331 , the line bundle is trivializable and @xmath49 is the usual graph laplacian .",
    "thus , @xmath332 .",
    "however , there exists a  crsf on @xmath5 with a single component winding once around @xmath303 : just take any cycle of this type and complete it to a crt .",
    "so in theorem [ mainline ] , the coefficient of @xmath333 is nonzero , and @xmath331 is a double root ( i.e. , not of higher order ) .",
    "we prove reality by a deformation argument . at each real root @xmath334 of @xmath134",
    ", @xmath49 has a kernel @xmath335 .",
    "we claim that @xmath336 .",
    "if it were of larger dimension , let @xmath337 be independent .",
    "these are real and harmonic for @xmath49 , and so lift to actual harmonic functions on the embedded graph @xmath338 on the universal cover @xmath339 of @xmath303 .",
    "these functions have the property that @xmath340 where `` @xmath341 '' represents the deck transformation , that is , on a path winding once around the annulus the values of @xmath342 are multiplied by @xmath343 .",
    "let @xmath31 be a vertex on the boundary of @xmath303 ( i.e. , on a peripheral cycle ) and @xmath344 be a linear combination of @xmath342 which is zero at @xmath31 .",
    "then @xmath344 is a harmonic function on @xmath345 which is zero on a biinfinite sequence of boundary points .",
    "we claim that this is impossible unless @xmath344 is identically zero . by the mean - value principle , from each zero of a ( not identically zero ) harmonic function on an infinite graph",
    "there are two paths to @xmath346 , one on which the function is increasing ( and eventually positive ) and another on which the function is decreasing ( and eventually negative ) .",
    "let @xmath347 be a choice of increasing and eventually positive infinite path from a fixed lift @xmath348 of  @xmath31 , and @xmath349 be a choice of decreasing and eventually negative infinite path from the same point @xmath348 .",
    "the union of the lifts of @xmath347 starting at all lifts of @xmath31 is a nonnegative connected set of vertices containing all lifts of @xmath31 , and containing a strictly positive path from @xmath350 to @xmath346 ; this contradicts the existence of @xmath349 .",
    "this completes the proof of the claim that @xmath344 must be identically zero , and thus the claim that @xmath336 .",
    "the roots of @xmath134 vary continuously with the conductances .",
    "we can find a set of conductances for which all roots are real , see the next paragraph .",
    "as we vary the conductances , if two real roots @xmath351 collide and become a  complex conjugate pair , the sum @xmath352 at the point of collision must be a two - dimensional subspace of the kernel of @xmath49 , which we showed above can not happen .",
    "thus , the roots must remain real . from theorem",
    "[ mainline ] , @xmath353 can not have negative real roots so all roots are real and positive .",
    "we now find specific conductances for which all roots are real .",
    "take a  set of maximal cardinality of disjoint cycles , each winding around @xmath303 , and complete it to a crsf .",
    "let @xmath354 be the cycles in order from innermost to outermost .",
    "add @xmath99 more edges to join these crts up into a connected set  @xmath355 ( a `` chain of loops , '' with bushes ) , so that @xmath356 is connected to @xmath357 with a  path @xmath358 .",
    "put a large conductance @xmath359 on every edge of @xmath355 except for one edge of every @xmath356 , and one edge of every path @xmath358 ; these edges of @xmath355 have weight @xmath66 .",
    "put a small conductance @xmath360 on the remaining edges of @xmath5 not in @xmath355 .",
    "are real and distinct . ]",
    "when @xmath360 is small and @xmath359 is large , @xmath117 is to leading order a power of @xmath359 times the determinant of the graph of figure [ loopline ] .",
    "this is because with high probability all edges with conductance @xmath359 , none of the edges of conductance  @xmath360 , and some of the edges of conductance @xmath66 will be present in a random crsf . contracting all edges of conductance @xmath359 and removing those of conductance  @xmath360 , we are left with the graph of figure [ loopline ] with all edges of conductance @xmath66 . for this graph , it is easy to verify that the roots @xmath361 of @xmath117 are real and distinct ( see the example after corollary [ bernoullicor ] ) .",
    "the actual laplacian is a small perturbation of this so its determinant also has real distinct roots .",
    "[ bernoullicor ] the number of cycles in a uniform random incompressible crsf on an annulus is distributed as @xmath66 plus a sum of @xmath7 independent bernoulli random variables , where @xmath362 is the maximal number of nonintersecting incompressible cycles one can simultaneously draw on @xmath5 .",
    "let @xmath363 .",
    "then @xmath364 has only real negative roots : @xmath365 by theorem [ mainline ] , @xmath366 is the probability generating function for the number of loops .",
    "it is also the probability generating function for a sum of independent bernoullis , with the @xmath102th bernoulli being biased as @xmath367 .    as an example , let us compute , for a rectangular cylinder , @xmath117 and the corresponding distribution of cycles in a uniform random incompressible crsf .",
    "let @xmath368 be a line graph of length @xmath157 and @xmath369 .",
    "the eigenvalues of @xmath370 are @xmath371 for @xmath372 [ the corresponding eigenvectors are @xmath373 for @xmath374 . by ( [ ncrsfs ] )",
    ", we have @xmath375 where @xmath376 and @xmath377 is defined by @xmath378 ( a variant of the chebyshev polynomial ) . for nonnegative @xmath10 and large @xmath23",
    ", @xmath379 is large unless @xmath10 is near @xmath70 , so the relevant roots are @xmath380 for small @xmath105 , @xmath381 we have @xmath382 where @xmath383 .",
    "thus , in the limit @xmath384 with @xmath385 the roots satisfy @xmath386 .",
    "the limit probability generating function for the number of cycles is then @xmath387    for example , for a square annulus ( @xmath388 ) the probability of a single cycle is approximately @xmath389 .",
    "we compute the laplacian determinant for a flat line bundle on a @xmath15 grid on a torus , that is , for the graph @xmath390 . in this case , the determinant is @xmath391 this product was evaluated in @xcite , yielding @xmath392 where @xmath393 is a constant tending to @xmath394 and @xmath395 tends to @xmath134 , where @xmath396 we wish to rewrite this as @xmath397 where the first sum is over primitive vectors @xmath398 in @xmath22 , one per direction [ i.e. , only one of @xmath398 and @xmath399 appears ] .",
    "thus , @xmath400 will be the relative probability that a crsf has @xmath157 cycles in homology class @xmath398 .",
    "to this end , pick a primitive vector @xmath398 and consider the terms in ( [ p ] ) with monomials @xmath401 for @xmath402 . letting @xmath403 and @xmath404",
    "the sum of these terms is @xmath405 which can be rewritten as a power series in @xmath406 as ] ] @xmath407 thus , we find @xmath408    for example , the probability of a single cycle in homology class @xmath409 is @xmath410      we consider here the case when @xmath303 is a @xmath277-holed sphere .",
    "this is the simplest case where the noncommutativity of the connection plays a role .",
    "we consider a flat @xmath0-connection on @xmath304 .",
    "let @xmath411 and @xmath274 be the monodromies around the three holes , which satisfy @xmath412 . since @xmath305 is the free group on two generators ,",
    "there are no other relations .",
    "note that a simple closed curve on @xmath303 has only one of three possibly homotopy types : it must be homotopic to one of the three boundary curves .",
    "a finite lamination up to homotopy is therefore described by a triple @xmath413 of nonnegative integers , where there are @xmath102 curves homotopic to @xmath21 , @xmath105 homotopic to @xmath20 , and @xmath7 homotopic to @xmath274 .",
    "theorem [ mainsl2 ] gives the following .",
    "let @xmath414 .",
    "then @xmath415 where @xmath416 is the number of cycles with homotopy type @xmath417 , respectively .",
    "note in particular that @xmath134 is a polynomial with nonnegative coefficients .",
    "what polynomials occur ?",
    "is there an analog of theorem [ reality ] in this setting ?",
    "we do not know .",
    "however , it is not difficult to show that the set of exponents @xmath416 of the nonzero monomials of @xmath418 form a convex set in @xmath419 : let  @xmath420 be the length in terms of the number of vertices of the shortest path from face @xmath21 ( the face with monodromy @xmath21 ) to face @xmath20 ( the face with monodromy  @xmath20 ) .",
    "similarly define @xmath421 and  @xmath422 .",
    "then we can simultaneously embed @xmath423 cycles of types @xmath417 if and only if @xmath424 this is easily proved by induction on @xmath425 .",
    "so the newton polyhedron of @xmath134 is defined by @xmath426 , @xmath427 , and ( [ 3ineq ] ) .",
    "in this section , we use the vector - bundle laplacian to study the loop - erased walk on a planar graph . in section  [ onehole ] , we compute the probability that the lerw between two boundary points passes left or right of a given face . in section [ twoholes ] , we compute this probability for two faces .",
    "let @xmath5 be a finite planar graph .",
    "let @xmath428 vertices on the outer boundary and @xmath126 a bounded face .",
    "we compute the probability that the lerw from @xmath3 to @xmath4 goes left of @xmath126 .",
    "this can be computed quite simply using duality : given a ust on a planar graph @xmath5 , the duals of the edges not in @xmath213 form a ust of the planar dual graph . in the dual graph",
    ", our question is equivalent to asking whether the lerw from the face @xmath126 first reaches the outer face along the edge between @xmath3 and @xmath4 or outside this edge .",
    "this is just the harmonic measure of the path from @xmath3 to @xmath4 as seen from @xmath126 .    here",
    "we will compute this in another way , using line bundle technology .",
    "it illustrates a general method which will be useful in the next section .",
    "take a line bundle with monodromy @xmath20 around @xmath126 and trivial around all other faces .",
    "this can be achieved by putting in a zipper of edges ( dual of a  simple path in the dual graph from @xmath126 to the boundary ) each with parallel transport @xmath20 as in figure [ zipper ] .",
    "suppose without loss of generality that the zipper ends between @xmath3 and @xmath4 as in the figure .",
    "put in an extra edge from @xmath3 to @xmath4 with parallel transport @xmath429 . then by theorem",
    "[ mainline ] , @xmath430\\\\[-8pt ] & = & p_1 + 2p_2 + 2p_3-a\\biggl(p_2+\\frac{p_3}b\\biggr)-\\frac1a(p_2+bp_3).\\nonumber\\end{aligned}\\ ] ] here @xmath431 is the weighted sum of crsfs which contain a cycle containing edge @xmath21 and going left of @xmath126 ( when oriented so that @xmath21 is the edge before  @xmath3 ) ; @xmath432 is the weighted sum of crsfs containing a cycle through @xmath21 going `` right '' of  @xmath126 .",
    "we wish to compute @xmath433 .",
    "these can be extracted from the coefficients of @xmath21 and @xmath434 in @xmath117 .",
    "letting @xmath428 be the first two vertices , we have @xmath435 where @xmath436 is the laplacian without the extra edge from @xmath3 to @xmath4 ( and @xmath437 represents a vector or matrix of zeros ) . as a consequence , @xmath438 where @xmath439 .",
    "this last determinant is @xmath440 . comparing coefficients with ( [ p1p2p3 ] ) yields @xmath441 and",
    "@xmath442    the desired quantity is @xmath443 in the limit @xmath444 .",
    "we need to compute @xmath445 when @xmath20 is near @xmath66 .",
    "[ oneterm ] when @xmath446 , @xmath447 where @xmath448 is the number of spanning trees of @xmath5 and @xmath449 is the expected signed number of crossings of the zipper on a simple random walk from @xmath31 to  @xmath52 .    for a matrix @xmath261 ,",
    "let @xmath450 denote @xmath451 times the determinant of @xmath261 upon removing rows @xmath223 and columns @xmath96 . here",
    "@xmath452 is the sum of the indices of elements of @xmath223 and likewise for @xmath453 .",
    "( we can assume without loss of generality that all relevant vertices have even index so that we can ignore the signs . )",
    "recall that for the standard laplacian @xmath202 , we have for any @xmath454 that @xmath455 , the number of spanning trees of @xmath5 .",
    "we also have @xmath456 where @xmath145 is the green s function.\\kappa\\det \\bigl(t+g(a_i , b_j)\\bigr)_{1\\le i , j\\le k},\\ ] ] where @xmath457p(t)$ ] denotes the coefficient of @xmath458 in @xmath459 .",
    "this can be proved by induction on @xmath7 and expanding the determinant on the left - hand side along row @xmath460 . ]    letting @xmath461 , a matrix supported on the zipper edges .",
    "we have @xmath462 here the sum is over the zipper edges .",
    "for an edge @xmath463 the quantity @xmath464 is the transfer current , equivalently , the expected signed number of crossings of @xmath465 of the simple random walk started at @xmath52 and stopped at @xmath31 .    by the lemma , when @xmath446 the probability ( [ oneholeprob ] ) becomes @xmath466 since @xmath467 .",
    "the probability that the lerw from @xmath3 to @xmath4 goes left of @xmath126 is the total amount of current flowing left of @xmath126 when @xmath66 unit of current enters at @xmath3 and exits at @xmath4 .",
    "let @xmath342 be two faces in a finite planar graph @xmath5 and @xmath428 two points on the boundary .",
    "consider the lerw from @xmath3 to @xmath4 .",
    "we compute the probability that it goes left of both faces .",
    "although this can be computed in principle using theorem [ theo11 ] and the comments thereafter , in practice that method involves an integration of @xmath117 over the representation variety @xmath311 ; in the case of a large graph one might not have access to an explicit expression for @xmath117 . here , we do the computation using only a bundle which is close to the trivial bundle ; the determinant as a  function on @xmath311 can be expanded as a power series around the trivial bundle case and we only need the first two terms in the expansion , which we can write down explicitly in terms of the standard green s function .",
    "we use an @xmath0-bundle . choose a bundle with mondromy @xmath223 around @xmath468 and",
    "@xmath96 around @xmath469 , and trivial monodromy around the other faces .",
    "this can be achieved by putting trivial parallel transport on all edges except for two zippers , one from each of @xmath342 to the boundary , as in figure [ twozips ] .",
    "let @xmath470 denote these two zippers .",
    "add a new edge connecting @xmath3 to @xmath4 with parallel transport @xmath92 .",
    "suppose that @xmath471 are close to the identity .",
    "then a crsf will have with high probability only a loop containing @xmath92 .",
    "the first - order correction to this consists in crsfs having two loops , one of them containing @xmath92 and the other of monodromy @xmath471 or @xmath472 ( or their inverses ) .",
    "the possible loops in a crsf with one or two loops , one of which contains @xmath92 , have one of the seven monodromy types ( or their inverses ) : @xmath473 where @xmath474 .",
    "let @xmath475 be the representations in @xmath0 , where @xmath476 is small and @xmath477 are variables .",
    "the equations @xmath478 yield @xmath479 and @xmath480 .    computing the traces of the above seven classes , we have @xmath481    the relevant quantities for us are the last four and the products of any one the first three of these with the last four .",
    "we let @xmath482 be the weight sum of configurations in which the lerw from @xmath3 to @xmath4 goes left of both faces , and having no other loops ( i.e. , crsfs with one loop containing the extra edge , with the property that this loop surrounds both @xmath342 ) .",
    "similarly , define @xmath483 .",
    "let @xmath484 be , respectively , the weighted sum of those configurations having one loop containing @xmath92 and one loop surrounding , respectively , hole @xmath468 , hole @xmath469 , and both holes .    if we extract the coefficient of @xmath61 in @xmath485 , from ( [ 7traces ] )",
    "the result will be of the form @xmath486    recall that these variables are subject to the constraints @xmath479 and @xmath480 .",
    "the coefficients of the @xmath487 are linearly independent given these constraints .",
    "thus given an explicit expression for @xmath488 to first order in @xmath476 , it is a simple matter to extract these various coefficients @xmath487 .",
    "the desired probabilities are @xmath489 and so on .",
    "let us show how to compute the coefficient of @xmath61 in @xmath488 , to first order in @xmath476 .",
    "indexing the vertices so that @xmath428 are the first two vertices , we have @xmath490 where @xmath491 is the laplacian without the extra edge from @xmath3 to @xmath4 ( and  @xmath437 represents a vector or matrix of zeros ) . as a consequence , @xmath492 where @xmath493 . note that @xmath145 is self - dual , since it is the inverse of a  self - dual matrix .",
    "thus , we have @xmath494 where @xmath495 and @xmath496 are diagonal matrices .",
    "the right - hand side is @xmath497 times @xmath498    thus , the coefficient of @xmath61 in @xmath499 is @xmath500 to first order in @xmath476 .",
    "it is possible to give an exact expression for @xmath501 as a sum over @xmath502 and @xmath503 of products of standard green s functions . since @xmath471 are close to the identity , we can write @xmath504 where @xmath116 is a perturbation supported on the zippers . as a consequence ,",
    "both @xmath505 and @xmath497 itself have expansions in powers of @xmath476 .",
    "the ratio of these is the desired quantity .    for the present purposes , we need the expansion of @xmath506 to first order ( which is the term of order @xmath507 ) and @xmath508 to first order ( which is the term of order @xmath476 ) .",
    "unfortunately these computations , although elementary , can be quite long , and we have not been able to get an explicit answer for a main case of interest which is the upper half plane .",
    "we give here a probabilistic interpretation of the green s function of the line bundle laplacian in the case where each edge has parallel transport either @xmath66 or @xmath217 .",
    "let @xmath5 be a graph ,  @xmath509 a collection of directed edges , and consider the line bundle with parallel transport @xmath217 on @xmath509 and @xmath66 elsewhere .",
    "let @xmath145 be the inverse of the line bundle laplacian .",
    "let @xmath454 be vertices of @xmath5 .",
    "let us first ask : what is the distribution of the signed number of crossings of @xmath509 on the srw from @xmath31 to @xmath52 ?",
    "let @xmath134 be the transition matrix of the simple random walk on @xmath5 ( ignoring the line bundle ) with absorbing state @xmath52 .",
    "thus , @xmath510 is the probability of going to @xmath511 from state @xmath512 ( as usual the indices are reversed so that composition respects the natural path order ) .",
    "multiply the entry @xmath510 by @xmath217 or @xmath513 if @xmath514 is in @xmath509 or @xmath515 , respectively . with @xmath52 as the vertex with last index",
    "@xmath134 has the form @xmath516 .",
    "then the probability generating function of the number of crossings is @xmath517    [ gvv ] the probability generating function of the signed number of crossings of @xmath509 on a simple random walk from @xmath31 to @xmath52 is @xmath518    note that @xmath519 for @xmath520 , where @xmath153 is the diagonal matrix of vertex degrees . as a consequence @xmath521",
    "the quantity @xmath522 also has a probabilistic interpretation . choosing a gauge such that @xmath523 for all @xmath31 adjacent to @xmath52 , and using @xmath524 we have ( setting @xmath525 ) @xmath526 giving @xmath527 thus",
    ", we have the following proposition .    [ gvv ]",
    "@xmath522 is the probability generating function of the signed number of crossings of @xmath509 on a srw started at @xmath52 and stopped on its first return to @xmath52 .",
    "now let @xmath528 with small @xmath360 and @xmath529 so that @xmath530 is the expected signed number of crossings of @xmath509 on a srw from  @xmath31 to  @xmath52 .",
    "similarly let @xmath531 so that @xmath532 is the expectation of the square of the signed number of crossings of @xmath509 of the srw from @xmath52 until its first return to @xmath52 ( note that @xmath533 is zero and @xmath534 by symmetry ) .",
    "the determinant of the line bundle laplacian @xmath49 above satisfies @xmath535 where @xmath532 is the expected square of the signed number of crossings of @xmath509 of a srw from @xmath52 until its first return to @xmath52 .",
    "in particular @xmath536 does not depend on  @xmath52 .    from lemma [ oneterm",
    "] , we have @xmath537 however by ( [ gvvexpansion ] ) and ( [ gvvexpansion ] ) , we have @xmath538 so we must have @xmath539 .",
    "we can get a full expansion of @xmath117 as a power series in @xmath217 around @xmath331 as follows .",
    "we have @xmath540 this follows from differentiating the entries in @xmath49 . here using propositions  [ gvv ] and  [ gvv ] , the quantities on the right - hand side have explicit probabilistic interpretations . integrating both sides from @xmath331 to @xmath541 ,",
    "gives the desired expansion .",
    "let @xmath542 be the @xmath13 grid on a torus [ the nearest neighbor grid @xmath543 with opposite sides identified : @xmath544 and @xmath545 .",
    "choose for each vertex a north- or east - going edge , independently and with probability @xmath546 .",
    "the resulting configuration of edges makes a directed crsf , and we wish to determine the distribution of the number and homology type of the cycles .",
    "this problem was studied in @xcite who showed among other things that when @xmath547 is close to a rational with small denominator the number of cycles is ( in the limit @xmath384 ) tending to a gaussian with expectation on the order of @xmath548 .    here",
    "we show how to compute explicitly for each @xmath14 the probability generating function of the total homology class of the cycles ( which determines both the number of cycles and their direction ) .",
    "we make @xmath542 into a directed graph , directing all edges northward or eastward .",
    "let @xmath34 be a flat line bundle on @xmath542 with monodromy @xmath217 and @xmath230 for loops in homology class @xmath409 and @xmath549 , respectively .",
    "@xmath34 can be obtained by putting parallel transports @xmath66 on all edges except edges @xmath550 which get parallel transport @xmath217 and edges @xmath551 which get parallel transport  @xmath230 .    by theorem [ directed ] , the determinant of the line bundle laplacian is @xmath552 where @xmath553 and @xmath554 are coprime , and @xmath555 is the number of crsfs with total homology class @xmath398 , that is , with @xmath556 cycles of homology @xmath557 .",
    "this determinant can be explicitly computed using a standard fourier diagonalization of @xmath49 .",
    "@xmath558    if @xmath559 and @xmath560 , then the function @xmath561 is an eigenvector of @xmath49 with eigenvalue @xmath562 .",
    "these eigenvectors are independent and span @xmath563 .    from ( [ fprod ] )",
    ", we can extract the coefficients @xmath564 .",
    "let us consider for simplicity the case @xmath388 . in @xcite",
    ", it was shown that with probability tending to  @xmath66 as @xmath16 , all cycles will have homology class @xmath565 .",
    "thus , from ( [ fzw ] ) , @xmath566 where the second sum is negligible , in the sense that the sum of its coefficients is @xmath567 .",
    "we can thus ignore the second sum , let @xmath331 and expand @xmath568 around @xmath569 .",
    "we have @xmath570 letting @xmath571 and @xmath572 , we have @xmath573 and @xmath574 the product @xmath575 is large in absolute value unless @xmath576 is small , that is , when @xmath576 is @xmath577 , so the dependence on @xmath578 comes from terms with @xmath576 small .",
    "that is , the product can be written as @xmath579 and the second product is @xmath580 .",
    "when @xmath581 is small , @xmath582 plugging in @xmath583 yields @xmath584 where we have extended the range of @xmath105 without loss of precision . thus up to exponentially small errors ,",
    "@xmath585 is the probability generating function for the number @xmath586 of @xmath565-cycles .",
    "we see that the number of @xmath565 cycles is a sum of independent bernoulli random variables with the @xmath105th having bias @xmath587 .",
    "the expectation of @xmath586 is then ( using @xmath588 ) @xmath589 the variance is @xmath590 since the variance tends to @xmath346 , the central limit theorem implies that distribution tends to a gaussian as @xmath16 .",
    "a similar computation holds when @xmath591 and @xmath592 .",
    "1 .   consider a graph embedded on a riemann surface , such that edges are geodesic segments .",
    "now use a naturally associated connection , for example , the levi  civita connection on the tangent bundle .",
    "what are the probabilistic consequences of choosing such a connection ? 2 .",
    "is there any combinatorial meaning to the vector bundle laplacian for higher - rank bundles ? 3",
    ".   what information does the line bundle laplacian give about the three - dimensional monotone lattice path problem , generalizing the results of section [ monotone ] ?",
    "we thank alexander goncharov , adrien kassel and david wilson for important contributions and the referee for helpful feedback ."
  ],
  "abstract_text": [
    "<S> the classical matrix - tree theorem relates the determinant of the combinatorial laplacian on a graph to the number of spanning trees . </S>",
    "<S> we generalize this result to laplacians on one- and two - dimensional vector bundles , giving a combinatorial interpretation of their determinants in terms of so - called cycle rooted spanning forests ( crsfs ) . </S>",
    "<S> we construct natural measures on crsfs for which the edges form a determinantal process .    </S>",
    "<S> this theory gives a natural generalization of the spanning tree process adapted to graphs embedded on surfaces . </S>",
    "<S> we give a number of other applications , for example , we compute the probability that a loop - erased random walk on a planar graph between two vertices on the outer boundary passes left of two given faces . </S>",
    "<S> this probability can not be computed using the standard laplacian alone .    .    . </S>"
  ]
}