{
  "article_text": [
    "in many physics analyses , one has non - interfering background events which can not be cleanly separated from the desired signal .",
    "this is of particular concern when the problem being studied is multi - dimensional , _",
    "i.e. _ there are kinematic correlations in the signal which must be preserved .",
    "one typical way to handle these situations is with the _ side - band subtraction _ method .",
    "distributions constructed using events outside the signal region are subtracted from those using events inside the signal region to create distributions in which the backgrounds have been removed .",
    "while this method can be effective in some situations , implementing it can become problematic if the kinematics of the background region are different than those of the signal or if the problem is sufficiently multi - dimensional such that binning the data is severely limited by statistical uncertainties .    in this paper",
    ", we describe a procedure for assigning each event in a data sample a quality factor ( @xmath0-factor ) which gives the chance that it originates from the signal sample .",
    "this @xmath0-factor can then be used as an event weight in subsequent analysis procedures to gain access to the signal distribution . for example",
    ", the @xmath0-factors can be used to perform event - based unbinned maximum likelihood fits on the data to extract physical observables .",
    "eliminating the need to bin the data is highly desirable for the case of multi - dimensional problems .",
    "we note here that this procedure is not appropriate for situations where there are quantum mechanical interference effects between the signal and background .",
    "consider a data set composed of @xmath1 total events , each of which is described by @xmath2 coordinates @xmath3 ( @xmath4 ) .",
    "the coordinates can be masses , angles , energies , _",
    "etc_. furthermore , the data set consists of @xmath5 signal and @xmath6 background events . both the signal and background distributions are functions of the coordinates , @xmath7 and @xmath8 respectively . for this procedure , we need to know _ a priori _ the functional dependence ( possibly with unknown parameters ) of the signal and background distributions in terms of one of the coordinates",
    ". we will refer to this coordinate as the reference coordinate and label it @xmath9 .",
    "as an example , consider the case where the reference coordinate is a mass .",
    "the functional dependence of the signal , in terms of @xmath9 , might be given by a gaussian or breit - wigner distribution .",
    "the background may be well represented by a polynomial . in both cases",
    ", there could be unknown parameters ( _ e.g. _ the width of the gaussian ) ; these are permitted when using this procedure .",
    "no other _ a priori _ information is required concerning the dependence of @xmath7 or @xmath8 on any of the other coordinates .    the aim of this procedure is to assign each event a quality factor , or @xmath0-factor , which gives the chance that it originates from the signal sample .",
    "we first need to define a metric for the space spanned by @xmath3 ( excluding @xmath9 ) .",
    "a reasonable choice is to use @xmath10 where @xmath11 is the maximum possible difference between the coordinates @xmath12 of any two events in the sample . using this metric , the distance between any two events , @xmath13 ,",
    "is given as @xmath14 ^ 2,\\ ] ] where the sum is over all coordinates except @xmath9 .",
    "for each event , we compute the distance to all other events in the data set , and retain the @xmath15 _ nearest neighbor _ events , including the events itself , according to ( [ eq : dist ] ) .",
    "the value of @xmath15 , which varies depending on the analysis , is discussed below .",
    "the @xmath15 events are then fit using the unbinned maximum likelihood method to obtain estimators for the parameters , @xmath16 , in the probability distribution function @xmath17d\\xi_r},\\ ] ] where @xmath18 and @xmath19 describe the functional dependence on the reference coordinate , @xmath9 , of the signal and background respectively .    the @xmath0-factor for each event is then calculated as @xmath20 where @xmath21 is the value of the event s reference coordinate and @xmath22 are the estimators for the parameters obtained from the event s fit .    if one wants to bin the data , the signal yield in a bin is obtained as @xmath23 where @xmath24 is the number of events in the bin .",
    "for example , to construct a histogram ( of any dimension ) of the signal , one would simply weight each event s contribution by its @xmath0-factor .",
    "it is also important to extract the uncertainties on the individual @xmath0-factors so that we can obtain error estimates on measurable quantities .",
    "the full covariance matrix obtained from each event s fit , @xmath25 , can be used to calculate the uncertainty in @xmath0 as @xmath26 when using these values to obtain errors on the signal yield in any bin , we must consider the fact that the nature of our procedure leads to highly - correlated results for each event and its @xmath15 nearest neighbors ; thus , simply adding the @xmath27 values in quadrature would certainly underestimate the true error . the actual degree of correlation of the @xmath0-factors would depend on the population of the bins .",
    "a safe choice is to assume 100% correlation ; thus , @xmath28 which provides an overestimate of the true uncertainty inherent in the procedure .",
    "in addition to the uncertainties associated with the fits , there will also be a purely statistical error associated with the signal yield in each bin , given by poisson statistics . for large values of @xmath29 , the signal yield obtained using ( [ eq : sig - yield ] ) , this can be taken to be @xmath30 ; however , for smaller @xmath29 the upper limit is better approximated by @xmath31  @xcite . the total uncertainty on the signal yield in any bin is then obtained by adding the fit errors , calculated using ( [ eq : q - err ] ) , in quadrature with the statistical errors discussed above .",
    "as an example , we will consider the reaction @xmath32 in a single @xmath33 bin , _",
    "i.e. _ a single center - of - mass energy and production angle bin ( extending the example to avoid binning in production angle , or @xmath34 , is discussed below ) .",
    "the @xmath35 decays to @xmath36 about 90% of the time ; thus , we will assume we have a detector which has reconstructed @xmath37 events .",
    "of course , there are production mechanisms other than @xmath32 which can produce this final state and there is no cut which can be performed to separate out events that originated from @xmath32 . below we will construct a toy - model of this situation by generating monte carlo events for both signal , _ i.e. _ @xmath35 events , and background , _",
    "i.e. _ non-@xmath35 @xmath36 events ( 10,000 events were generated for each ) .",
    "the goal of our model analysis is to extract the @xmath35 polarization observables known as the _ spin density matrix elements _ , denoted by @xmath38 ( discussed below ) .    in terms of the mass of the @xmath36 system , @xmath39 ,",
    "the @xmath35 events were generated according to 3-body phase space weighted by a voigtian ( a convolution of a breit - wigner and a gaussian , see ( [ eq : voigt ] ) ) to account for both the natural width of the @xmath35 and detector resolution .",
    "for this example , we chose to use @xmath40  mev / c@xmath41 for the detector resolution ( see figure  [ fig : m3pi - gen ] ) .",
    "the goal of our analysis is to extract the three measurable elements of the spin density matrix ( for the case where neither the beam nor target are polarized ) traditionally chosen to be @xmath42 , @xmath43 and @xmath44 .",
    "these can be accessed by examining the distribution of the decay products ( @xmath36 ) of the @xmath35 in its rest frame .",
    "mass of the @xmath36 system ( gev / c@xmath41 ) for all generated events ( unshaded ) and for only the background ( shaded ) .",
    ", scaledwidth=45.0% ]    for this example , we chose to work in the helicity system which defines the @xmath45 axis as the direction of the @xmath35 in the overall center - of - mass frame , the @xmath46 axis as the normal to the production plane and the @xmath47 axis is simply given by @xmath48 .",
    "the decay angles @xmath49 are the polar and azimuthal angles of the normal to the decay plane in the @xmath35 rest frame , _",
    "i.e. _ the angles of the vector @xmath50 .",
    "the decay angular distribution of the @xmath35 in its rest frame is then given by  @xcite @xmath51 which follows directly from the fact that the @xmath35 is a vector particle ; it has spin - parity @xmath52 .",
    "we chose to use the following @xmath38 values for this example :    [ eq : rho - gen ] @xmath53 @xmath54 @xmath55    the resulting generated decay distribution is shown in figure  [ fig : decay - angles - gen ] .    for the background , we chose to generate it according to 3-body phase space weighted by a linear function in @xmath39 and @xmath56 in the decay angles .",
    "figure  [ fig : m3pi - gen ] shows the @xmath36 mass spectrum for all generated events and for just the background .",
    "the generated decay angular distributions for all events , along with only the signal and background are shown in figure  [ fig : decay - angles - gen ] .",
    "there is clearly no way to separate out the signal events through the use of a cut .          to obtain the @xmath0-factors",
    ", we first need to identify the relevant coordinates , _ i.e. _ the kinematic variables in which we need to separate signal from background .",
    "the @xmath36 mass will be used as the reference coordinate , @xmath57",
    ". the stated goal of our analysis is to extract the @xmath38 elements .",
    "we will do this using ( [ eq : schil ] ) ; thus , only the angles @xmath49 are relevant .",
    "other decay variables , such as the distance from the edge of the @xmath36 dalitz plot , are not relevant to this analysis  though , they would be in other analyses ( see section  [ section : example : full - pwa ] ) .    using the notation of section  [ section : method ] , @xmath58 and the distance between any two points , @xmath13 ,",
    "is given by @xmath59 the functional dependence of the signal and background on the reference coordinate , @xmath39 , are    @xmath60    @xmath61    where @xmath62  gev / c@xmath41 , @xmath63  mev , @xmath64  mev is the simulated detector resolution , @xmath65 are unknown parameters and @xmath66,\\end{aligned}\\ ] ] is the convolution of a gaussian and non - relativistic breit - wigner known as a voigtian ( @xmath67 is the complex error function ) .",
    "as stated above , the number of nearest neighbor events required depends on the analysis .",
    "specifically , it depends on how many unknown parameters there are , along with the functional forms of @xmath18 and @xmath19 .",
    "for this relatively simple case , the value @xmath68 works well . for each simulated event",
    ", we then find the @xmath15 closest events ( containing both signal and background ) and perform an unbinned maximum likelihood fit , using the cernlib package minuit  @xcite , to determine the estimators @xmath69 .",
    "the @xmath0-factors are then calculated from ( [ eq : q - factor ] ) and the uncertainties are straightforward to calculate using section  [ section : errors ] .",
    "( color online ) mass of the @xmath36 system ( gev / c@xmath41 ) for all generated events ( unshaded ) , only generated background events ( shaded ) and all generated events weighted by @xmath70 ( dashed - red ) .",
    ", scaledwidth=45.0% ]    figure  [ fig : m3pi - fit ] shows the comparison of the extracted and generated background @xmath39 distributions integrated over all decay angles .",
    "the agreement is quite good ; however , we are looking for more than just global agreement .",
    "figure  [ fig : decay - angles - fit ] shows the extracted angular distributions for the signal and background .",
    "the agreement with the generated distributions is excellent ( see figure  [ fig : decay - angles - gen ] ) .",
    "we can also compare the @xmath0-factors extracted by the fits to the theoretical distributions from which our data was generated .",
    "figure  [ fig : q - compare ] shows that the extracted values are in very good agreement with the generated values .",
    "we conclude this section by discussing the importance of quality control in the fits . for this example",
    ", we performed 20,000 independent fits to extract the @xmath0-factors . to avoid problems which can arise due to fits not converging or finding local minima",
    ", each unbinned maximum likelihood fit was run with three different sets of starting values for the parameters @xmath16 : ( 1 )  100% signal ; ( 2 )  100% background ; ( 3 )  50% signal , 50% background . in all cases ,",
    "the fit with the best likelihood was used .",
    "the @xmath15 events were then binned and a @xmath71 was obtained . in",
    "about 2% of the fits the @xmath71 was very large , a clear indicator that the fit had not found the best estimators @xmath69 . for these events ,",
    "a binned @xmath72 fit was run to obtain the @xmath0-factor .      as discussed in section  [ section : errors ] , the covariance matrix obtained from each event s fit can be used to obtain the uncertainty in @xmath0 , @xmath73 , using ( [ eq : sigma - q ] ) .",
    "the nature of our procedure leads to a high degree of correlation between neighboring event s @xmath0-factors .",
    "this means that adding the uncertainties in quadrature would definitely underestimate the true error . in section",
    "[ section : errors ] , we argued that a better approach was to assume 100% correlation which provides an overestimate of the true error .",
    "to examine the error bars in our toy example , we chose to project our data into a one - dimensional distribution in @xmath74 .",
    "this was done to avoid bin occupancy issues which arise in the two - dimensional case due to limitations in statistics .",
    "figure  [ fig : compare - q - err](a ) shows the comparison between the generated and calculated @xmath74 distributions .",
    "the agreement is excellent .",
    "the error bars on the calculated points were obtained using ( [ eq : q - err ] ) . for this study , we ignore the poisson statistical uncertainty in the yield due to the fact that the number of generated events is known . in a real world analysis ,",
    "these should be included in the quoted error bars .",
    "we can examine the quality of the error estimation by examining the difference between the generated and calculated yields in each bin , @xmath75 .",
    "figure  [ fig : compare - q - err](b ) shows the comparison between @xmath75 , @xmath76 obtained assuming 100% correlation and @xmath76 obtained assuming no correlation , _ i.e. _ adding the individual uncertainties in quadrature .",
    "as expected , the correlated errors provide an overestimate of @xmath75 in every bin , while the uncorrelated errors greatly underestimate @xmath75 in the majority of bins .",
    "it is not surprising that the errors obtained using ( [ eq : q - err ] ) are better estimates of the true uncertainty when the bin occupancy is closer to @xmath15 .",
    "we could come up with a scheme to scale the size of the error bars according to bin occupancy ; however , recall that in this example we fit the background with the functional form to which it was generated .",
    "this typically will not be the case for real data . in a real analysis ,",
    "fitting with different functional forms and examining the extracted signal distributions to estimate systematic effects due to the choice of background is generally required . in this case",
    ", one should simply consider that the uncorrelated error bars are overestimates for each choice of background function when estimating the systematic uncertainty in the signal yields .",
    "the goal of our model analysis is to extract the spin density matrix elements .",
    "when studying multi - dimensional problems , binning the data is often undesirable due to limitations in statistics .",
    "the @xmath0-factors obtained for each event above can be used in conjunction with the unbinned maximum likelihood method to avoid this difficulty .",
    "if we could cleanly separate out the signal events from the background , then the likelihood function would be defined as @xmath77 where @xmath78 is the decay angular distribution defined in ( [ eq : schil ] ) .",
    "we could then obtain estimators for the spin density matrix elements by minimizing @xmath79 in this example , it is not possible to separate the signal and background event samples ; however , we can use the @xmath0-factors to achieve the same effect by rewriting ( [ eq : log - l ] ) as @xmath80 where the sum is now over all events ( signal and background ) .",
    "thus , the @xmath0-factors are used to weight each event s contribution to the likelihood .    using the @xmath0-factors obtained in section  [ section : example : apply ] , minimizing ( [ eq : log - l - q ] ) yields    @xmath81    @xmath82    @xmath83    where the uncertainties are purely statistical ( obtained from the fit covariance matrix ) .",
    "thus , the values extracted for the spin density matrix elements are in excellent agreement with the values used to generate the data given in ( [ eq : rho - gen ] ) .      to extend this example to allow for the case where the data is not binned in production angle , we would simply need to include @xmath84 or @xmath34 in the vector of relevant coordinates , @xmath3 . to perform a full partial wave analysis on the data",
    ", we would also need to include any additional kinematic variables which factor into the partial wave amplitudes , _",
    "e.g. _ the distance from the edge of the @xmath36 dalitz plot ( typically included in the @xmath35 decay amplitude ) .",
    "we would then construct the likelihood from the partial waves and minimize @xmath85 using the @xmath0-factors obtained by applying our procedure including the additional coordinates .",
    "an example of this can be found in  @xcite .",
    "in this paper , we have presented a procedure for separating signals from non - interfering backgrounds by determining , on an event - by - event basis , a quality factor ( @xmath0-factor ) that a given event originated from the signal distribution .",
    "we have shown that this @xmath0-factor can be used as an event weight in subsequent analysis procedures to allow more direct access to the true signal distribution .",
    "though this procedure may be computationally expensive , in principle it only needs to be performed once for each event in the data sample .",
    "this work was supported by grants from the united states department of energy no .",
    "de - fg02 - 87er40315 and the national science foundation no . 0653316 through the `` physics at the information frontier '' program .",
    "99 v. h. regener , phys . rev . * 84 * , 161 ( 1951 ) .",
    "k. schilling , p. seyboth and g. wolf , nucl .",
    "b15 * , 397 ( 1970 ) .",
    "f. james , cern program library d506 ( 1998 ) . m. williams , carnegie mellon university ph.d . thesis , ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> a common situation in experimental physics is to have a signal which can not be separated from a non - interfering background through the use of any cut . in this paper , we describe a procedure for determining , on an event - by - event basis , a quality factor ( @xmath0-factor ) that a given event originated from the signal distribution . </S>",
    "<S> this @xmath0-factor can then be used as an event weight in subsequent analysis procedures , allowing one to more directly access the true spectrum of the signal .    ,    and    29.85.-c , 29.85.fj </S>"
  ]
}