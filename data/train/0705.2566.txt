{
  "article_text": [
    "many applications in the control of quantum systems involve controlling a large ensemble using the same control signal @xcite . in many practical cases , the elements of the ensemble show dispersions or variations in the parameters which govern the dynamics of each individual system .",
    "for example , in magnetic resonance experiments , the spins in an ensemble may have large dispersions in their resonance frequencies ( larmor dispersion ) or in the strength of the applied radio frequency fields ( rf inhomogeneity ) seen by each member of the ensemble .",
    "another example is in the field of nmr imaging , where a dispersion is intentionally introduced in the form of a linear gradient @xcite , and then exploited to successfully image the material under study .",
    "a canonical problem in the control of quantum ensembles is the design of rf fields ( control laws ) which can simultaneously steer a continuum of systems , characterized by the variation in the internal parameters governing the systems , from a given initial distribution to a desired final distribution .",
    "such control laws are called compensating pulse sequences in the nuclear magnetic resonance ( nmr ) literature . from the standpoint of mathematical control theory",
    ", the challenge is to simultaneously steer a continuum of systems between points of interest using the same control signal .",
    "typical designs include excitation and inversion pulses in nmr spectroscopy and slice selective pulses in nmr imaging @xcite . in many cases ,",
    "one desires to find a control law that prepares the final state as some desired function of the parameters .",
    "a premier example is the design of slice selective pulse sequences in magnetic resonance imaging applications , where spins are excited or inverted depending upon their physical position in the sample under study @xcite .",
    "in fact , the design of such pulses is a fundamental requisite for almost all magnetic resonance imaging techniques .",
    "this paper introduces the new method of fourier synthesis pulse sequence design for systems showing dispersions in the parameters governing their dynamics .    in this paper",
    "we focus on the bloch equations with a linear one dimensional gradient , which arise in the context of nmr spectroscopy and nmr imaging applications .",
    "@xmath0 = \\left[\\begin{array}{ccc } 0 & -g(t ) s & \\epsilon u(t )   \\\\",
    "g(t ) s & 0 & -\\epsilon v(t ) \\\\ -\\epsilon",
    "u(t ) & \\epsilon v(t ) & 0 \\end{array}\\right]\\left[\\begin{array}{c } m_x \\\\ m_y \\\\ m_z \\end{array}\\right ] \\label{chap32_bloch}\\ ] ] here , @xmath1^t$ ] is the state vector , @xmath2 , @xmath3 , and @xmath4 are controls and the parameters @xmath5 $ ] and @xmath6 , \\",
    "\\delta > 0 $ ] are dispersion parameters which will be explained subsequently . without loss of generality , we will always normalize the initial state of the system ( [ chap32_bloch ] ) to have unit norm , so that the system evolves on the unit sphere in three dimensions ( bloch sphere ) .",
    "a useful way to think about the bloch equations ( [ chap32_bloch ] ) , is by imagining a two dimensional mesh of systems , each with a particular value of the pair @xmath7 .",
    "we are permitted to apply a single set of controls @xmath8 to the entire mesh of systems , and the controls should prepare the final state of each system as a desired function of the parameters @xmath7 which govern the system dynamics .    from a physics perspective , the system ( [ chap32_bloch ] ) corresponds to an ensemble of noninteracting spin-@xmath9 in a static magnetic field @xmath10 along the @xmath11 axis and a transverse rf field @xmath12 in the @xmath13-@xmath14 plane .",
    "the state vector @xmath15^t$ ] represents the coordinate of the unit vector in the direction of the net magnetization vector for the ensemble @xcite .",
    "the controls @xmath16 and @xmath17 correspond to available rf fields we may apply to the ensemble of spins .",
    "the dispersion in the magnitude of the rf field applied to the sample is modeled by including a dispersion parameter @xmath18 such that @xmath19 with @xmath6 , \\",
    "\\delta > 0 $ ] .",
    "thus , the maximum amplitude for the rf field ( @xmath20 ) corresponds to the maximum amplitude seen by any spin in the ensemble .",
    "similarly , we consider a linear gradient @xmath21 , where @xmath22 may be thought of as a control , and @xmath23 represents the normalized spatial position of the spin system in the sample of interest . in ( [ chap32_bloch ] )",
    ", we work in units with the gyromagnetic ratio of the spins @xmath24 . in this paper",
    "we give new design methods which scale polynomially that can be used to design pulse sequences for ( [ chap32_bloch ] ) which prepare the final state of the system as a function of the parameters @xmath23 and @xmath18 .",
    "considering only the bloch equations with rf inhomogeneity and no linear gradient ( @xmath25 ) , we can rewrite ( [ chap32_bloch ] ) in terms of the generators of rotation in three dimensions as @xmath0 = \\epsilon ( u(t ) \\omega_y + v(t ) \\omega_x )   \\left[\\begin{array}{c } m_x \\\\ m_y \\\\",
    "m_z \\end{array}\\right ] \\label{bloch_eps}\\ ] ] where @xmath26 \\nonumber \\\\ \\omega_y & = & \\left[\\begin{array}{ccc } 0 & 0 & 1   \\\\ 0 & 0 & 0 \\\\ -1 & 0 & 0 \\end{array}\\right ] \\nonumber \\\\ \\omega_z & = & \\left[\\begin{array}{ccc } 0 & -1 & 0   \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{array}\\right]\\end{aligned}\\ ] ] we will come back to the full version of the bloch equations ( [ chap32_bloch ] ) with both a linear gradient and rf inhomogeneity later in the paper .",
    "the problem is to design @xmath27 and @xmath3 to effect some desired evolution .",
    "we now show how to construct controls to give a rotation of angle @xmath28 around the @xmath13 axis or the @xmath14 axis of the bloch sphere . from these constructions , an arbitrary rotation on the bloch sphere",
    "can be constructed using an euler angle decomposition .    ) .",
    "the pulse sequence element consists of six individual rotations which can be produced using the controls @xmath16 and @xmath17 as explained in the text .",
    "[ fig : eps_seq ] ]      in a time interval @xmath29 , we can use the controls to generate rotations @xmath30 and @xmath31 where @xmath32 and @xmath33 are constants to be specified .",
    "using this idea , consider generating the rotation @xmath34 with @xmath35 using the controls @xmath36 and @xmath37 .",
    "using the relation @xmath38 the matrices @xmath39 and @xmath40 may be rewritten as @xmath41 for small @xmath42 , we can make the approximation @xmath43 in ( [ approx ] ) , we have expanded the exponentials in @xmath39 and @xmath40 to first order , performed the multiplication called for in ( [ uk_prop ] ) , and then rewritten the product as ( [ approx ] ) keeping terms to first order . in the case",
    "when @xmath42 is too large for ( [ approx ] ) to represent a good approximation , we should choose a threshold value @xmath44 such that ( [ approx ] ) represents a good approximation and so that @xmath45 with @xmath46 an integer .",
    "defining @xmath47 we can apply the total propagator @xmath48^n \\label{approx_b01 } \\\\",
    "\\approx \\left [ \\exp(\\epsilon \\beta_0 \\cos(\\pi k",
    "\\epsilon ) \\omega_y )   \\right]^n \\label{approx_b0 } \\\\   = \\exp(\\epsilon \\beta_k \\cos(\\pi k \\epsilon ) \\omega_y)\\end{aligned}\\ ] ] where we used the approximation ( [ approx ] ) in ( [ approx_b0 ] ) .",
    "more will be said about this approximation below .",
    "if we then think about making the incremental rotation @xmath49 for many different values of @xmath50 , we will get a net rotation @xmath51 so long as we keep @xmath42 sufficiently small to justify the approximation ( [ approx ] ) .",
    "the total propagator @xmath52 for the bloch equations can then be rewritten as @xmath53 if we now choose the coefficients @xmath42 so that @xmath54 then we will have constructed a pulse sequence to approximate a desired @xmath18 dependent rotation around the @xmath14 axis . since @xmath18 is bounded away from the origin , @xmath55 is everywhere finite , and we can approximate it with a fourier series .",
    "here we consider the error introduced by the approximation ( [ approx_b0 ] ) .",
    "define the error @xmath56 when a unitary matrix @xmath57 is implemented instead of a desired unitary matrix @xmath58 by @xmath59 with these identifications , in ( [ approx_b01 ] ) we have @xmath60 and @xmath61 where @xmath62 and @xmath63 are matrices with finite entries and of maximum order @xmath64 .",
    "notice this implies that the difference @xmath65 is of order @xmath64 .",
    "as defined previously , @xmath66 . a well known result ( see for example @xcite ) says that the maximum error introduced by implementing ( multiplying ) the product of @xmath46 of the @xmath57 matrices instead of implementing @xmath46 of the @xmath58 matrices is the sum of the individual errors .",
    "thus , the total error @xmath67 satisfies @xmath68 and thus , by making @xmath46 sufficiently large , we may decrease the total error introduced in the above method to an arbitrarily small value .",
    "for the simulations done in this paper , we find a value @xmath69 produces good results .",
    "an analogous derivation can be made for rotations about the @xmath13 axis of the bloch sphere . replacing ( [ u_1k_e ] ) and ( [ u_2k_e ] ) with @xmath70 and following an analogous procedure leads to an approximate net propagator @xmath71 the coefficients @xmath42",
    "may be chosen to approximate @xmath72 , and thus we can approximately produce a desired @xmath18 dependent rotation about the @xmath13 axis of the bloch sphere .",
    "since an arbitrary rotation on the bloch sphere may be decomposed in terms of euler angles , the methods presented can be used to approximately synthesize any evolution on the bloch sphere .",
    "suppose we wish to design a pulse with a uniform net rotation angle of @xmath73 around either the @xmath13 or @xmath14 axis of the bloch sphere using the previously discussed algorithm .",
    "we focus on the case of a uniform rotation ( independent of @xmath18 ) because this is the most useful pulse sequence in nmr .",
    "it is straightforward to incorporate an @xmath18 dependent rotation @xmath28 into everything that follows .",
    "we face the problem of choosing @xmath42 and @xmath50 so that @xmath74 where @xmath75 since we only have @xmath76 terms in the series , we first will extend @xmath77 to have even symmetry about @xmath78 . to do this ,",
    "we define @xmath79 to be @xmath80 and now consider choosing @xmath42 and @xmath50 so that @xmath81 a natural choice is to choose @xmath50 as nonnegative integers , in which case @xmath42 may be computed using the orthogonality relation @xmath82 where @xmath83 is the kronecker delta .",
    "we find for the coefficients @xmath84 @xmath85 the number of terms kept in the series is decided by the pulse designer .     over the range @xmath86 for the rotation angle @xmath87 .",
    "five terms in the series expansion were retained .",
    "the relevant range of rf inhomogeneity is @xmath88 .",
    "[ fig : design ] ]    a sufficient number of terms should be retained so that the error across the relevant range of @xmath18 does not exceed some acceptable value .",
    "figure [ fig : design ] depicts an example design using a series with five terms .",
    "the region of interest for @xmath77 is @xmath88 . in this region , we see relatively small errors .",
    "we now give two examples to demonstrate the usefulness of the algorithm .",
    "suppose we wish to design a @xmath89 pulse around the @xmath14 axis and we want to consider rf inhomogeneity in the range @xmath88",
    ". then we should consider @xmath90 figure [ fig : design1 ] shows the results of the designed pulse sequence acting on the initial state @xmath91^t$ ] while keeping five terms in the series expansion .",
    "rotation about @xmath14 axis .",
    "the sequence was applied to the initial state @xmath91^t$ ] , and the plot shows the final state as a function of @xmath18 after propagating the bloch equations . [",
    "fig : design1 ] ]    we see that the resulting pulse sequence reliably produces a net evolution @xmath92 across the entire range of @xmath18 values . figure [ fig : cdc_nieve_control_mod ] shows the results of applying @xmath93 for one unit of time to the system ( [ bloch_eps ] ) .",
    "this approach corresponds to assuming the dispersion parameter @xmath18 is fixed at a nominal value @xmath20 , so that every system sees the same control signals @xmath16 and @xmath17 .",
    "systems corresponding to values @xmath94 exhibit deteriorated performance as demonstrated in figure [ fig : cdc_nieve_control_mod ] .     for one unit of time to the initial state @xmath91^t$ ] .",
    "the system corresponding to the value @xmath20 for the dispersion parameter experiences a @xmath89 rotation about the @xmath14 axis of the bloch sphere , but systems corresponding to other values of @xmath18 show deteriorated performance .",
    "[ fig : cdc_nieve_control_mod ] ]      as a second example , suppose we wish to design a @xmath95 pulse around the @xmath13 axis and we want to consider rf inhomogeneity in the range @xmath96 .",
    "then we should consider @xmath97 figure [ fig : design4 ] shows the results of the designed pulse sequence acting on the initial state @xmath98^t$ ] while keeping nine terms in the series expansion .",
    "rotation about @xmath13 axis .",
    "the sequence was applied to the initial state @xmath98^t$ ] , and the plot shows the final state as a function of @xmath18 after propagating the bloch equations . [ fig : design4 ] ]    we see that the resulting pulse sequence reliably produces a net evolution @xmath99 across the entire range of @xmath18 values .    it should be noted that although we consider design examples where we wish to produce a uniform rotation that is independent of the parameter @xmath18 , the method presented in the paper can also be used to design control laws which prepare the final state as a function of the parameter @xmath18 .",
    "we consider examples to produce a uniform rotation , independent of @xmath18 , because this is the most useful application in nmr .",
    "now consider the bloch equations with no rf inhomogeneity and with a linear gradient @xmath0 = ( g(t ) s \\omega_z + u(t ) \\omega_y + v(t ) \\omega_x )   \\left[\\begin{array}{c } m_x \\\\ m_y \\\\",
    "m_z \\end{array}\\right]\\ ] ] where @xmath2 , @xmath3 , and @xmath4 are time dependent control amplitudes we may specify , and @xmath5 $ ] can be thought of as a dispersion parameter .",
    "as previously discussed , @xmath23 represents the spatial position of the spin system in the sample under study .",
    "the goal is to engineer a control law that will effect a net position dependent rotation , so that the final state is prepared as a function of @xmath23 .",
    "a common example in nmr imaging is a so - called slice selective sequence , whereby the controls should selectively perform a @xmath89 rotation on some range of @xmath23 values , while performing no net rotation on @xmath23 values falling outside of that range .    using the controls ,",
    "consider generating the evolution @xmath100 with @xmath101 the matrices @xmath39 and @xmath40 may be rewritten as @xmath102 again performing a first order analysis on the exponentials as was done in the previous section , we can make the approximation @xmath103 if we then think about making the rotation @xmath49 for different values of @xmath50 and @xmath42 , we will get the net propagator @xmath104 within the approximation previously discussed .",
    "the propagator ( [ prop_x_y ] ) may be rewritten as @xmath105 choosing @xmath50 as the nonnegative integers , and choosing the @xmath42 so that @xmath106 where @xmath107 is the desired position @xmath23 dependent rotation angle results in a net rotation around the @xmath14 axis of the bloch sphere with the desired dependence on the parameter @xmath23 .",
    "an analogous procedure may be used to generate an @xmath23 dependent rotation around the @xmath13 axis of the bloch sphere . replacing ( [ u_1k_s ] ) and ( [ u_2k_s ] ) with @xmath108 and following a similar procedure",
    ", we can approximately produce the total propagator @xmath109 choosing @xmath50 as the nonnegative integers , and choosing the @xmath42 appropriately results in a net rotation around the @xmath13 axis of the bloch sphere with the desired dependence on the parameter @xmath23 .",
    "since any rotation can be decomposed in terms of euler angles , we may use the methods just discussed to approximately produce any position @xmath23 dependent rotation on the bloch sphere .      as an example design using the procedure just discussed , consider a slice selective pulse sequence , where we wish to excite a certain range of @xmath23 values while leaving systems with @xmath23 values falling outside of that range unaffected at the end of the sequence .",
    "@xmath110 figure [ fig : xfigure ] shows the results of a pulse sequence designed using the procedure described in the text while keeping 30 terms in the series .",
    "rotation about @xmath14 axis over the range @xmath111 .",
    "the sequence was applied to the initial state @xmath112^t$ ] , and the plot shows the final state as a function of @xmath23 after propagating the bloch equations . [",
    "fig : xfigure ] ]    the ripples appearing in figure [ fig : xfigure ] result from the ripples in the approximation of the sharp slice selective profile using a fourier series .",
    "one method used to overcome this in practice is to allow for a ramp between the @xmath113 and @xmath89 level on the slice .",
    "we now come back to the problem of considering the full version of the bloch equations ( [ chap32_bloch ] ) including the two dispersion parameters @xmath23 and @xmath18 . rewriting ( [ chap32_bloch ] ) in terms of the generators of rotation we have    @xmath0 = ( g(t ) s \\omega_z + \\epsilon u(t ) \\omega_y + \\epsilon v(t ) \\omega_x )   \\left[\\begin{array}{c } m_x \\\\ m_y",
    "\\\\ m_z \\end{array}\\right ] \\label{bloch_xe}\\ ] ]    where the state vector is now a function of both parameters @xmath23 and @xmath18 .",
    "the control task is to choose @xmath2 , @xmath114 , and @xmath4 to effect a desired rotation @xmath115 .",
    "proceeding along the lines of the previous two sections , consider generating the propagators @xmath116 and @xmath117 within a first order approximation for the exponentials , we have the approximate total propagator @xmath118 building on this , we can produce the propagator @xmath119 similarly , we can produce @xmath120 so that we can approximately produce the total propagator @xmath121 within the approximation for the exponentials .",
    "we can use the method previously discussed in the case when @xmath42 is too large for the approximation to be valid . producing the propagator @xmath49 for different values of @xmath122 , @xmath123 , and @xmath42 results in the net propagator @xmath124 a choice of @xmath122 , @xmath123 , and @xmath42 so that @xmath125 where @xmath115 is the desired position @xmath23 and rf inhomogeneity parameter @xmath18 dependent rotation angle , results in an approximate desired evolution for the bloch equations ( [ bloch_xe ] ) .",
    "analogous arguments show we may approximately produce a rotation around the @xmath13 axis of the bloch sphere @xmath126 and may thus approximately generate a net propagator @xmath127 and thus approximately produce a desired position @xmath23 and rf inhomogeneity parameter @xmath18 rotation around the @xmath13 axis of the bloch sphere . since any rotation on the unit sphere can be decomposed in terms of euler angles , an arbitrary @xmath128 dependent rotation can be approximately produced using these methods .",
    "in this paper we have provided new methods to design control laws for the bloch equations when certain dispersion parameters are present in the system dynamics .",
    "these methods are of utmost practical importance in the fields of nmr spectroscopy and nmr imaging , and can be implemented in many well known experiments immediately .",
    "the methods presented in the paper allow the design of a compensating control law ( pulse sequence ) that will compensate for dispersions in the system dynamics while providing a clear tradeoff for the control law designer between total time required for the sequence and amplitude of the available controls .",
    "skinner , t. reiss , b. luy , n. khaneja , and s.j .",
    "glaser , application of optimal control theory to the design of broadband excitation pulses for high resolution nmr , _ journal of magnetic resonance _ vol .",
    "163 , 2003 , pp 8 - 15 .",
    "k. kobzar , b. luy , n. khaneja , and s.j .",
    "glaser , pattern pulses : design of arbitrary excitation profiles as a function of pulse amplitude and offset , _ journal of magnetic resonance _ , vol . 173 , 2005 , pp 229 - 235 ."
  ],
  "abstract_text": [
    "<S> finding control laws ( pulse sequences ) that can compensate for dispersions in parameters which govern the evolution of a quantum system is an important problem in the fields of coherent spectroscopy , imaging , and quantum information processing . </S>",
    "<S> the use of composite pulse techniques for such tasks has a long and widely known history . in this paper </S>",
    "<S> , we introduce the method of fourier synthesis control law design for compensating dispersions in quantum system dynamics . </S>",
    "<S> we focus on system models arising in nmr spectroscopy and nmr imaging applications . </S>"
  ]
}