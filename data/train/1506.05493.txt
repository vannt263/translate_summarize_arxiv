{
  "article_text": [
    "bell nonlocality is one of the most iconic and paradoxical aspects of quantum phenomenology .",
    "the realities of two space - like separated systems can be entangled , such that the choice of whether to measure @xmath0 or @xmath1 on one system can affect the measurement statistics of @xmath2 on the other @xcite .",
    "contextuality generalized these ideas , noting that the essence of non - locality remains in single , localized quantum systems .",
    "the outcome of an observable @xmath2 can depend on whether it is comeasured with @xmath0 or @xmath1 , even if neither observable @xmath0 nor @xmath1 disturbs the measurement statistics of @xmath2 @xcite .    unlike nonlocality",
    ", contextuality can be exhibited by classical as well as quantum systems @xcite .",
    "all contextuality experiments so far , have relied on collecting output statistics from a series of joint measurements @xmath3 , @xmath4 , etc . on some quantum state .",
    "while this approach has been immensely successful @xcite , all outcomes in these tests can be replicated by classical systems .",
    "suppose two black boxes are tested for contextuality .",
    "one contains a genuine quantum system that faithfully outputs the required quantum measurement statistics , the other contains a classical computer which merely simulates the mathematics of quantum theory .",
    "current experimental tests of contextuality can not distinguish which of the two is quantum .",
    "this stands in stark contrast to tests of nonlocality where local hidden variables can be excluded due to space like separation of alice and bob s choice of measurement settings and no - signalling .",
    "the inability to exclude hidden variables is a key limitation of current contextuality experiments , which in turn , hinders their use as a resource in device independent scenarios - such as generating certified random numbers @xcite .",
    "this article aims to mitigate this limitation .",
    "we introduce experimental methods to exclude contextual hidden variables through physical principles and apply them to refine experimental tests of contextuality in quantum systems .",
    "our approach rests on the use of an external quantum mechanical degree of freedom . in synthesizing superpositions of different contextuality measurements conditioned on this degree of freedom",
    ", we can imprint the predictions of contextuality into correlations between the system of interest , and our quantum mechanical ancilla .",
    "the outcomes of contextuality experiments can thus be translated into a bipartite setting . in doing so",
    ", we can replace the standard ad hock assumption in contextuality tests - that any participating classical system did not reconfigure its answers based on the measurement settings - with a much more physically motivated assumption of no - signaling .",
    "this puts tests of contextuality on a similar footing to nonlocality tests , and ultimately reduces the current gap between them .",
    "the article is organized as follows .",
    "section [ sec : contextualitytests ] will introduce the formal framework of contextuality .",
    "section [ sec : results ] will outline the specifics of our proposed experiment , together with corresponding proofs of how it can distinguish contextual hidden variables from genuine quantum contextuality .",
    "section [ sec : blackbox ] describes these ideas within the general black box framework .",
    "section [ sec : discusion ] then concludes the paper with discussions .",
    "suppose that a system has @xmath5-observables @xmath6 , including an observable @xmath7 which is compatible with several distinct proper subsets of @xmath8 .",
    "each compatible subset constitutes a measurement context for @xmath7 .",
    "the non - contextual hypothesis is : the outcome of @xmath7 is independent of which subset you choose to measure @xmath7 alongside .",
    "quantum systems with three or more hilbert space dimensions violate his hypothesis - they are innately contextual @xcite .",
    "tests are formulated in terms of non - contextual inequalities ; mathematical inequalities that constrain all non - contextual systems .",
    "an archetypical example is the @xmath5-cycle inequality : @xmath9 where observables @xmath10 have dichotomic @xmath11- outcomes , all addition is done modulo @xmath5 , and any consecutive pair @xmath7 and @xmath12 can be measured simultaneously @xcite .",
    "this inequality is derived under the no - disturbance assumption  the marginal distributions @xmath13 is assumed to be independent of the measurement context , i.e. @xmath14 . provided this assumption",
    "is upheld , any non - contextual hidden variable will satisfy . meanwhile quantum systems can violate up to the tsirelson bound @xmath15 if @xmath5 is even , or @xmath16 if @xmath5 is odd @xcite .",
    "contextual hidden variables can also violate this inequality . consider a hidden variable that flips an unbiased coin to generate @xmath17 or @xmath18 at random",
    ", then computes @xmath19",
    ". this hidden variable will violate the @xmath5-cycle inequality up to the arithmetic bound of @xmath20 .",
    "thus contextuality is not unique to quantum systems .",
    "it is also exhibited by classical processes which take the full complement of observables being simultaneously measured @xmath21 and uses this input to generate a context - dependent - outcome @xmath22 for each observable @xmath7 , i.e. a contextual hidden variable .",
    "this observation limits the capacity of standard contextuality tests to guarantee the non - classicality of an untrusted physical system .",
    "an unknown system may violate a noncontextual inequality simply by hosting a computer that executes a suitable contextual hidden variable model . indeed many such automata have already been proposed @xcite .",
    "* framework*. this motivates us to consider the following scenario .",
    "alice wishes to test if a quantum system @xmath23 inside a black box is contextual , while excluding contextual hidden variables .",
    "this may be motivated by a desire to generate quantum random numbers through a certifiable quantum source of contextuality .",
    "her adversary wishes to cheat her by replacing this black - box with an imitation that mimics the measurement results through contextual hidden variables @xcite .",
    "alice is tasked with distinguishing the genuinely quantum system from the imitation and simultaneously checking for contextuality - i.e. the task of discriminating between these two boxes is equivalent to excluding a contextual hidden variable explanations for her experimental data .",
    "alice has an experimental apparatus , which can be pre - configured to measure any pair of observables @xmath24 and @xmath12 .",
    "she also has a source of black boxes ; supplied by an untrusted third party with the capability to generate classical or quantum boxes . in each run",
    "alice uses the source to generate a black box , and then inserts it into the experimental apparatus , without knowing whether it contains a quantum or classical system .",
    "the apparatus then returns two measurement outcomes @xmath25 and @xmath26 , respectively . at the end of the run alice",
    "uses the outcomes as data points for @xmath22 and @xmath27 in her experiment .",
    "we note two properties that are required for the experimental test to conclude a system is contextual :    * if an observable @xmath7 is measured twice during a single run , then both answers should be the same .",
    "[ item1 ] * the data will violate the @xmath5-cycle inequality in eqn ..  [ item2 ]    alice will thus screen her data for compliance with both ( i ) and ( ii ) . criterion ( i ) is often applied to strings of measurements @xmath28 . checking the outcomes of @xmath7 ( and of @xmath12 ) are consistent in any string of measurements @xmath29 , is an operational way of verifying the no - disturbance assumption .",
    "this check is often advocated and used in experimental implementations , where the emphasis is on checking the quantum measurements commute .    in the following sections , we develop experimental methods for excluding contextual hidden variables and",
    "use them to refine existing experimental tests of contextuality .",
    "our new refined tests can exclude contextual hidden variables , due to inability to satisfy the aforementioned criteria ( i ) and ( ii ) .",
    "to implement the aforementioned standard contextuality tests , alice needs to choose measurement settings at random .",
    "this involves the use of a reliable source of randomness .",
    "one method , for example , is via the use of an ancillary qubit @xmath30 initiated in state @xmath31 . by measuring this qubit in the standard pauli @xmath32 basis ( i.e. , the @xmath33 basis ) , alice can obtain a random bit @xmath34 that determines which measurement she will perform . for example , alice may use the random bit to decide which of two sets of mutually commuting observables @xmath35 , or @xmath36 , where @xmath37 to measure .",
    "that is she configures her apparatus to co - measure @xmath38 if the random bit if @xmath39 , and @xmath40 if @xmath41 .",
    "basis measurement outcomes of an ancillary qubit @xmath42 , are used as a quantum random number generator ( qrng ) .",
    "if the qrng outputs 0 then the observables @xmath43 are measured , else when the qrng outputs 1 the measurement settings are flipped to @xmath44 . in the revamped protocol ( b ) a control - unitary is used to reverse the order of measurement , so the settings can be flipped retroactively - that is we measure the system we are testing for contextuality , afterwards we fix the settings by measuring the ancilla in the @xmath32 basis .",
    "this figure highlights the tight knit relationship with quantum delayed choice protocols @xcite .",
    "[ fig : schematic],scaledwidth=50.0% ]    our proposal is based on reversing this order of events . instead of pre -",
    "selecting the measurement setting , alice will delay this choice until after the system of interest @xmath45 , has been measured . formally , suppose there exists a unitary @xmath46 , that transforms each element of @xmath47 to an element of @xmath48 , i.e. , @xmath49 . for @xmath5-cycle tests based upon the standard observables @xmath50 as in @xcite ,",
    "the compatible subsets @xmath51 and @xmath52 where @xmath53 , satisfy this assumption  provided we ensure @xmath47 and @xmath48 have the same number of elements .",
    "consider the following general strategy .",
    "let @xmath23 represent the state of the system of interest , and @xmath54 the state of the ancilla qubit . instead of measuring the system directly",
    ", alice first applies the aforementioned @xmath46 controlled on the @xmath32 basis of the ancilla qubit , i.e. , alice applies @xmath55 . following this process",
    ", alice makes the standard measurements associated with each of the observables in @xmath47 to obtain outcomes @xmath56 .",
    "once these measurement outcomes are obtained , alice generates the random number @xmath57 by a @xmath32 measurement of the ancilla ( see fig . [",
    "fig : schematic ] for details ) .",
    "when @xmath58 , alice treats @xmath56 as the outputs of measuring the elements of @xmath47 and use them to collect statistics on @xmath59 .",
    "otherwise the outputs are treated as if the elements of @xmath48 were measured ; and used to evaluate @xmath60 for elements of @xmath48 .",
    "thus , alice now decides what questions to ask a possibly contextual system of interest _",
    "after _ she receives the answers to the said questions .",
    "the main idea is that the black box s incumbent phd student must now generate outcomes , without knowing exactly what observables are being measured .",
    "such a phd student can no longer execute a contextual hidden variable strategy , which uses the full complement of observables being measured to compute outcomes . in",
    "what follows , we demonstrate appropriate choice of @xmath47 and @xmath48 allows alice to exclude classical contextual hidden variables .",
    "the exact specifics will vary depending on whether the number of observables , @xmath5 , is even or odd .",
    "[ sec : evenncycles ] * when @xmath5 is even * , we execute the protocol above with @xmath61 and @xmath62 for some @xmath63 . in instances where the ancilla measurement outcome @xmath64 , is @xmath65 , we have effectively measured @xmath66 and @xmath67 and thus can collect statistics about @xmath68 . in instances where @xmath41 , similar reasoning allows us to collect information on @xmath69 .",
    "for example , repetition of the protocol when @xmath70 is set to @xmath65 allows estimation of @xmath68 and @xmath71 . reiterating this procedure for @xmath72 each time allows evaluation of each of the correlation terms in eq . .",
    "consider a contextual classical box that attempts to mimic these statistics . without loss of generality",
    ", we can model such a box by assuming it contains an internal memory - a contextual hidden variable @xmath73 .",
    "the box is assumed to have complete knowledge of alice s experimental setup ( i.e , what @xmath47 and @xmath74 are ) , but no knowledge about the outcome of alice s eventual measurement of the ancilla ( we will see in section [ sec : blackbox ] that the latter assumption can be verified experimentally ) .    in each run alice",
    "makes a measurement for each observable in @xmath75 . to successfully fool alice",
    ", the box must replicate the quantum output statistics for @xmath25 and @xmath26 . in the following",
    "we show that this is impossible ; a classical box with contextual hidden variables can not consistently satisfy conditions ( i ) and ( ii ) from sec .",
    "[ sec : contextualitytests ] , making it impossible for such a system to mimic genuine quantum contextuality without detection .",
    "_ proof of result .",
    "_ in order to violate the @xmath5-cycle inequality , it is necessary that @xmath76 this holds independently for each @xmath77 . to see this write as @xmath78 , where @xmath79 . because @xmath80 contain @xmath81 correlation terms which satisfy @xmath82 , we are guaranteed that @xmath83 .",
    "hence in order to violate we need @xmath84 .",
    "we take the outcomes @xmath85 , collected from runs where @xmath86 and @xmath87 , in conjunction with the output of the ancilla measurement , @xmath64 , and evaluate @xmath88 we observe that if we define probability distributions @xmath89 and @xmath90 , then @xmath91 is the variational distance between @xmath92 and @xmath93 .",
    "let us assume a contextual hidden variable @xmath73 supplied the outcomes @xmath25 and @xmath26 .",
    "this assignment must be made without knowing @xmath64 , the future outcome of measuring the ancilla qubit in the @xmath32 basis .",
    "we note that @xmath64 equiprobable to be 0 or 1 , since the ancilla is prepared in a @xmath94 state and the control unitary does not effect the @xmath32 statistics of the ancilla ( i.e. the control unitary commutes with a @xmath32 basis measurement of the ancilla , since with respect to the @xmath32 basis of the ancilla the control unitary is @xmath95 , where @xmath96 is the direct sum and @xmath97 is the identity . ) . with no prior knowledge of @xmath64 available when @xmath73 is assigned @xmath98 , and @xmath99 hence the variational distance @xmath100 in eq .",
    "is precisely 0",
    ". a contextual hidden variable can not violate inequality and therefore will not violate the @xmath5-cycle inequality .",
    "of course if the experiment is not repeated enough times , then a classical system could appear to satisfy due to random statistical fluctuations . in practice",
    "this problem effects all contextuality tests , and has a standard resolution .",
    "quantum systems actually violate the @xmath5-cycle inequality up to the tsirleson @xcite bound @xmath101 in sec . [",
    "sec : contextualitytests ]  so the quantum statistics ideally satisfy a stricter inequality @xmath102 .",
    "alice will pick an @xmath103 satisfying @xmath104 , and check if the experimental outcomes satisfy : @xmath105 due to the central limit theorem , the probability that statistics generated by a classical hidden variable , will satisfy , dies off exponentially with the number of runs @xmath106 .    * when @xmath5 is odd * , the protocol is summarized by fig .",
    "alice intends to evaluate the correlation term @xmath107 for some @xmath108 .",
    "the main difference here is that alice first implements a non - destructive measurement of observable @xmath109 on system @xmath45 , with outcome @xmath25 .",
    "once done , she then implements the procedure in sec .",
    "[ sec : results ] , with @xmath110 and @xmath111 .",
    "that is she introduces an ancillary qubit @xmath42 , and applies the unitary @xmath46 satisfying @xmath112 to @xmath45 , controlled on the @xmath32 basis of @xmath113 .    to determine what measurements she has effectively made",
    ", alice completes the protocol by measuring the ancilla in the @xmath32 basis , with outcome @xmath64 . on runs where @xmath114",
    ", alice attributes the outcomes @xmath115 to two consecutive measurements of @xmath109 .",
    "otherwise , alice treats @xmath25 as an outcome of measuring @xmath109 and @xmath26 as an outcome of measuring @xmath116 .",
    "thus , depending on the outcome @xmath64 , alice can collect statistics about either @xmath117 or @xmath107 .",
    "cycle case we use an alternate protocol , where each run allows us to measure @xmath107 for some @xmath118 , or @xmath117 . a non - destructive measurement of the observable @xmath109 on the register is followed by a control unitary @xmath119 where @xmath120 .",
    "finally we repeat the measurement of @xmath109 , and measure the ancilla in the @xmath32 basis generating an outcome @xmath121 .",
    "supposing we start with @xmath122 then post selecting on runs where the ancilla outcome @xmath123 , we can evaluate @xmath71 meanwhile when @xmath58 the data yields @xmath124 .",
    "[ fig3],scaledwidth=30.0% ]    analogously to the even @xmath5-cycle case , a classical box with contextual hidden variables must replicate the output statistics of @xmath25 and @xmath26 , for both possible measurement outcomes of the ancilla .",
    "this is not possible .",
    "_ proof of result .",
    "_ in order to satisfy the criteria ( i ) and ( ii ) from sec .",
    "[ sec : contextualitytests ] , it is necessary that @xmath125 this inequality must be satisfied independently for each @xmath126 .",
    "this follows from observing two points .",
    "firstly criterion ( i ) implies @xmath127 . secondly to violate the @xmath5-cycle inequality ( criterion ( ii ) ) , we require @xmath128 for all @xmath108 . we can establish this using proof by contradiction : assume @xmath129 for some @xmath130 and we observe violation of inequality .",
    "this would imply @xmath131 .",
    "but this sum only contains @xmath132 terms each lower bounded by -1 .",
    "this is a contradiction .    by mirroring the analysis in the even case ,",
    "specifically eq . -",
    ", we observe @xmath133 again @xmath134 , where @xmath135 and @xmath136 are defined analogously to the even @xmath5 case .",
    "if @xmath25 and @xmath26 are generated by a contextual hidden variable @xmath73 , then using the same argument as in eq .",
    "we conclude @xmath137 is exactly zero provided no prior information about @xmath64 is available to influence the choice of @xmath73 .",
    "hence the contextual box will not satisfy , implying that either condition ( i ) or ( ii ) from sec . [",
    "sec : contextualitytests ] , will be contradicted .",
    "as with all contextuality experiments , the physical implementation of this protocol must satisfy an important caveat .    during this implementation alice will need to collect data for all @xmath5 correlation terms @xmath138 .",
    "for each correlation term alice must set up her experiment in figs .",
    "[ fig : schematic]-[fig3 ] using a different @xmath139 gate . if an observable @xmath109 is measured in two different setups ",
    "i.e. the setups for @xmath140 and @xmath141  then the actual measurement @xmath109 must be physically identical in both cases .",
    "otherwise any observed dependence of the outcomes @xmath142 on whether we measure @xmath143 or @xmath144 ( i.e. any contextuality ) could be due to imperfect reconstruction of @xmath109 when changing the settings .    in practice",
    "this problem is solved in standard contextuality tests by ref . @xcite and others .",
    "we simply refine the contextuality test in ref .",
    "@xcite to ensure we have also fulfilled this basic tenant .",
    "the even case is illustrated in fig .",
    "[ fig2 ] , the odd case will follow the same principles and therefore has not been included here .     cycles .",
    "figure ( a ) demonstrates the example @xmath145 , which allows us to measure the correlation terms @xmath146 and @xmath147 .",
    "unitary @xmath148 is applied to the register , controlled on the state of the ancilla @xmath42 .",
    "note @xmath148 is chosen so that it commutes with measurements of @xmath66 , i.e. @xmath149 , and satisfies @xmath150 .",
    "afterwards we measure @xmath66 and @xmath67 on the register , followed by a @xmath32 basis measurement on the ancilla . in ( b )",
    "we need to extend this protocol to get the next correlation term @xmath151 .",
    "however we must ensure that in both ( a ) and ( b ) , the measurements associated with @xmath152 and @xmath2 are physically identical . to do this",
    "we follow the techniques in ref .",
    "we introduce a new control unitary @xmath153 such that @xmath154 while @xmath155 , so that measurements of observable @xmath2 commute with the action of @xmath153 .",
    "note that measurements of @xmath156 will also commute with the @xmath153 gate ( i.e. to measure @xmath157 we postselect on runs where the effect of the @xmath153 gate is the same as an identity transformation ) . in principle , because the only difference between ( a ) and ( b ) is a @xmath153 gate , and this gate does not effect the measurement outcome of @xmath2 , or @xmath156 , these observables should be the same in both setups .",
    "furthermore the action of the two control unitaries is equivalent to a single control gate @xmath158 where @xmath159 while @xmath160 .",
    "iteratively repeating this method along with the techniques in ref .",
    "@xcite allows us to acquire the remaining correlation terms @xmath161 in the @xmath5-cycle inequality .",
    "[ fig2],scaledwidth=50.0% ]",
    "so far we have made use of quantum mechanical terminology .",
    "this is in line with the paper s focus on describing concrete experiments that can rule out contextual hidden variables .",
    "of course , contextuality is often discussed in a completely black - box setting - where the only properties of a system are its output statistics given input questions ; and no assumptions are made that the system is quantum mechanical .",
    "our proposal generalized naturally into this picture .",
    "because the security of this protocol relies on independence of the control from the system being tested for contextuality ; we need to introduce two parties alice and bob , who share a pair of black boxes . indeed , since the quantum protocol required alice and bob to share @xmath5-different entangled resource states ",
    "one for each of alice s settings choices @xmath162 , in the @xmath5-cycle test  the black box analogue actually requires @xmath5 pairs of boxes , labeled @xmath162 .",
    "we want recast the measurements in figs .",
    "[ fig : schematic]-[fig2 ] as a series of questions alice and bob ask their respective boxes .    in each round of the @xmath5-cycle test alice",
    "( and bob ) now select a pair of boxes labeled ` @xmath70 ' .",
    "alice asks her box two sequential dichotomic questions @xmath163 and @xmath164 and gets answers @xmath165 .",
    "afterwards bob asks his box a single question @xmath32 which generates outcome @xmath166 or @xmath167 .",
    "the outcomes @xmath168 can be treated as the outcome from sec .",
    "[ sec : results ] for the aforementioned values of @xmath70 and @xmath5 .    * verifying non - determinism of measurement selection . *",
    "recall that our proofs above relied on the crucial assumption that the box does not have access to the value of @xmath64 prior to outputting @xmath25 and @xmath26 .",
    "this relies of the assertion that there is no hidden variable that determines the value of @xmath64 prior to its measurement .",
    "the black - box framework gives us a natural way to explicitly verify this assumption .",
    "on some runs , after selecting their boxes alice and bob may randomly choose to perform a bell test between their box pairs . during",
    "this bell test alice chooses to ask her box one of two possible questions @xmath169 or @xmath170 ; while bob chooses to asks his box either question @xmath171 or @xmath172 .",
    "@xmath171 is selected to be the same question , @xmath32 , bob would have asked in delayed choice contextuality .",
    "the resulting statistics are used to test violation of the chsh inequality @xcite : @xmath173 the violation of this inequality certifies there is no realistic description for outcomes of question @xmath171 .",
    "this demonstrates that there is no hidden variable that predicts alice s decision of whether to ask questions in @xmath47 or @xmath48 .",
    "thus any capacity for the box to gain this knowledge will violate causality .    in the specific case of quantum systems , the bell test is performed on the final state of the circuits in figs .",
    "[ fig2]-[fig3 ] .",
    "the control qubit is assumed to be inside bob s box @xmath70 ; and the register inside alice s box ` @xmath70 ' .",
    "@xmath171 represents a @xmath32-measurement , in line with our constraint that it asks the same question as our refined contextuality test .",
    "provided the register was in some pure state @xmath174 directly before the control unitary gate @xmath139 , the resulting bipartite system is able to violate the chsh inequality for any @xmath5 for some choices of @xmath172 , @xmath169 and @xmath170 .",
    "specifically let @xmath172 be a @xmath175 measurement ; such that bob measures the ancilla in either the @xmath175 or @xmath32 basis .",
    "meanwhile define @xmath176 , @xmath177 where @xmath178 , as an effective qubit on alice s system of interest ; with associated pauli operators @xmath179 and @xmath180 ; and let @xmath181 and @xmath182 represent the two measurement settings for alice .",
    "application of these measurement settings allows violation of the chsh inequality up to @xmath183 , for all @xmath184 . for more details",
    "see the appendices .",
    "here we have developed experimental techniques for excluding contextual hidden variables and applied them to refine contextuality experiments . by controlling the measurement settings in the contextuality test on an external ancillary quantum mechanical degree of freedom ,",
    "we present a method for effectively concealing which observable is being measured in the contextuality test .",
    "this will effectively thwart a contextual hidden variable that needs to use prior knowledge of which observables are being measured in order to preassign a contextual outcome .",
    "one of the major stumbling blocks in the use of contextuality as a quantum resource in line with non - locality has been its capacity to be simulated by classical information processing .",
    "how can we use contextuality as a resource if we can replace the same system with a student in a box ? in developing an experimental method to certify a quantum state is contextual , and simultaneously exclude contextual hidden variables , our protocol helps address this problem .",
    "this innovation may thus lead to potential applications for contextual quantum systems - the natural candidate being , for example , the certified generation of random numbers @xcite    it would be interesting to see if some of the other problems surrounding contextuality tests could be addressed using similar ideas .",
    "for instance the no - disturbance assumption  which is the direct equivalent of no - signalling in bell tests  is a hot button topic in contextuality tests .",
    "a key issue is that hidden variable models which do not satisfy the no - disturbance condition ( i.e. the marginal distribution they predict @xmath185 depends on the measurement context @xmath109 ) can violate a noncontextual inequality .",
    "this opens an interesting possibility : could a refined protocols , which effectively hides the measurement context ` - ' in any joint measurement @xmath186`- ' , help address this problem ?",
    "furthermore the topic of contextuality as a resource is controversial , particularly since according to state independent contextuality protocols even the completely mixed state is contextual . by imprinting the predictions of contextuality into correlations between the test system and an external ancilla , we give a new interpretation for contextual statistics , which also links back to the quantum circuit formalism .",
    "this leaves a host of interesting problems which could be addressed in future work .",
    "another point of interest , is the close relationship between our protocol and quantum delayed choice , a class of quantum protocols which have been experimentally demonstrated in the context of optical interferometry  @xcite .",
    "the measurement statistics of a photon exiting an interferometer depend on a setting in the interferometer which can be either open and closed . by controlling whether the interferometer is open or closed on an ancillary quantum degree of freedom",
    ", we can effectively toggle the interferometer setting between open and closed after the photon has been measured @xcite .",
    "this innovation , provides a remarkable way to rule out a hidden variable description for the photon s measurement statistics .",
    "while the principles involved are similar to wheeler s delayed choice @xcite , quantum delayed choice is known to be more versatile and have applications to ruling out hidden variables in more general settings such as bell tests @xcite .",
    "quantum delayed choice also furnishes a technique for measuring complementary phenomena using a single configuration of the measurement apparatus @xcite .",
    "our work highlights the natural confluence of these ideas with tests of quantum contextuality .",
    "j.t . would like to acknowledge input and discussions with marek wajs , kavan modi , daniel terno and kihwan kim .",
    "this project / publication was made possible through the support of the john templeton foundation ( grant number 54914 ) and the foundational questions institute .",
    "the opinions expressed in this publication are those of the author(s ) and do not necessarily reflect the views of the john templeton foundation .",
    "the project was also supported by the national research foundation and the ministry of education in singapore through the tier 3 moe2012-t3 - 1 - 009 grant  random numbers from quantum processes \" as well as the national basic research program of china grant 2011cba00300 , 2011cba00302 , the national natural science foundation of china grants 11450110058 , 61033001 , and 61361136003 .",
    "99 j. s. bell , physics 1 , 195 ( 1964 ) s. kochen & e.p .",
    "specker , j. math .",
    "17 , 59 ( 1967 ) m. kleinmann , o. ghne , j. r. portillo , j. a. larsson , & a. cabello , new journal of physics , 13(11 ) , 113011 .",
    "( 2011 ) b. daki , m. suvakov , t. paterek , &  .",
    "brukner , phys .",
    "lett . , 101(19 ) , 190402 ( 2008 ) n. harrigan , t. rudolph & s. aaronson , ( 2008 ) .",
    "[ arxiv:0709.1149 ]    r. lapkiewicz , p. li , c. schaeff , n. k. langford , s. ramelow , m. wieniak , & a. zeilinger , nature ( london ) 474 , 490 ( 2011 ) .",
    "v. dambrosio , i. herbauts , e. amselem , e. nagali , m. bourennane , f. sciarrino , & a. cabello , phys .",
    "x. 3 , 011012 ( 2013 ) x. zhang , m. um , j. zhang , s. an , y. wang , d .-",
    "deng , c. shen , l .- m .",
    "duan , & k. kim , phys .",
    "110 , 070401 ( 2013 )    j. ahrens , e. amselem , a. cabello & m. bourennane , sci .",
    "rep . 3 , 2170 ( 2013 ) m. um , x. zhang , j. zhang , y. wang , s. yangchao , d .-",
    "deng , l .- m .",
    "duan & k kim , sci .",
    "rep . 3 , 1627 ( 2012 )    m. araujo , m. t. quintino , c. budroni , m. t. cunha , & a. cabello , phys .",
    "a , 88(2 ) , 022118 ( 2013 ) s. l. braunstein , & c. m. caves , annals of physics , 202(1 ) , 22 - 56 ( 1990 )    a. a. klyachko , m. a. can , s. binicioglu , & a. s. shumovsky , phys .",
    "lett . 101 , 020403 ( 2008 )    b. s. tsirelson , j. sov .",
    "36 , 557 ( 1987 )    a. grudka , k. horodecki , m. horodecki , p. horodecki , m. pawowski , & r. ramanathan , phys .",
    "a , 90 , 032322 ( 2013 ) j. f. clauser , m. a. horne , a. shimony & r. a. holt , phys .",
    "lett . , 23 , 880 ( 1969 )    r. colbeck , & r. renner , nat . phys .",
    ", 8(6 ) , 450 - 453 ( 2012 )    s. pironio , a. acn , s. massar , a. boyer de la giroday , d. n. matsukevich , p. maunz , s. olmschenk , d. hayes , l. luo , t. a. manning & c. monroe , nature 464 , 1021 - 1024 ( 2010 )    r. ionicioiu , & d. r. terno , phys .",
    "lett . , 107(23 ) , 230406 ( 2011 ) r. ionicioiu , t. jennewein , r. b. mann , & d. r. terno nat .",
    "commun . 5 , 3997 ( 2013 ) l. c. cleri , r. m. gomes , r. ionicioiu , t. jennewein , r. b. mann , & d. r. terno , foundations of physics , 44(5 ) , 576 - 587 ( 2014 ) r. ionicioiu , r. b. mann , & d. r. terno , phys .",
    "lett . , 114 , 060405 ( 2015 )    j. s. tang , y. l. li , x. y. xu , g. y. xiang , c. f. li , & g. c. guo , nat .",
    ", 6(9 ) , 600 - 604 ( 2012 ) a. peruzzo , p. shadbolt , n. brunner , s. popescu , & j. l. obrien , science , 338(6107 ) , 634 - 637 ( 2012 ) x. s. ma , s. zotter , j. kofler , r. ursin , t. jennewein ,  .",
    "brukner , & a. zeilinger , nat .",
    ", 8(6 ) , 479 - 484 ( 2012 ) p.",
    "j. coles , j. kaniewski , s. wehner , nat .",
    "commun . 5 , 5814 ( 2014 ) j.a .",
    "wheeler , in quantum theory and measurement , j.a.wheeler & w.h .",
    "zurek , eds .",
    "( princeton univ . press , princeton , nj , 1984 ) ,",
    "wheeler , in mathematical foundations of quantum mechanics , a.r .",
    "marlow , ed .",
    "( academic , new york , 1978 ) , pp . 948 .",
    "here we elaborate on the bell test in more detail .",
    "we illustrate the idealised scenario where the control qubit is in a state @xmath42 directly before the control unitary gate , while the register is in a pure state @xmath187 . in standard",
    "@xmath5-cycle experiments the system being tested for contextuality is pure which should substantiate this assumption , see for instance @xcite .",
    "however any additional noise in the system being tested for contextuality should simply decrease the predicted bell violation . given these assumptions the state of the circuit after the control unitary @xmath139 is :    @xmath188    we use the two subspaces @xmath176 , @xmath177 where @xmath178 , to define an effective qubit on alice s system of interest .",
    "we then equip alice with two observables @xmath181 and @xmath182 defined interms of pauli operators for her effective qubit @xmath179 and @xmath180 . and re - expresses the circuit s final state as @xmath189 let s assume the control qubit goes to bob and the register to alice ; and that bob uses with the standard pauli observables @xmath190 and @xmath191 on his qubit . now alice and bob can test a bell inequality : @xmath192 in terms of the condensed notation @xmath193 , the expectation value on state is : @xmath194 to find the best possible bell violation @xmath195 , we optimize as a function of @xmath196 , @xmath197 . we know",
    "this quantity is greater than ( or equal to ) the value of when @xmath198 , i.e. : @xmath199 now we can use @xmath200 , together with the choice @xmath201 , and @xmath202 to simplify this to @xmath203 for any @xmath204 this is always greater than 2 , provided alice chooses @xmath205 so that @xmath206 .    note that when @xmath207 ( i.e. in the limiting case @xmath208 ) the control unitary obviously generates no entanglement and consequently we do not expect any bell inequality violation when @xmath209 .",
    "this is not a problem for our application which should always fall in the regime @xmath210 .",
    "hence alice and bob should be able to violate a bell inequality using the output of the circuits in fig .",
    "[ fig3 ] and [ fig2 ] .",
    "in addition bob may uses @xmath175 and @xmath32-directions as his two measurement settings during the bell test . by using these settings",
    "we can establish the z - outcomes of the control qubit in the contextuality protocol are not realistic .",
    "consequently during any run of the contextuality test , the choice of which two observables are being measured on the register is not predetermined ( because this choice depends on the z - outcome of the control qubit - a non realistic quantity ) .",
    "@xmath212-cycle contextuality tests , are usually performed on @xmath213-level quantum systems in the state @xmath214 , where we have chosen to label the hilbert space basis @xmath215 .",
    "the optimal settings for observables @xmath216 are    @xmath217    where any pair @xmath109 and @xmath218 are compatible and @xmath219    for example in the @xmath213-cycle case we have : @xmath220    the theory of euler rotations will give a systematic method for computing @xmath46 , provided we use the representations of @xmath221 given in refs .",
    "@xcite , we provide another appendix on how this representation is related to - .",
    "all other details should follow unaltered .",
    "tests of @xmath222-cycle inequalities based on eq . , are typically implemented in a 3-level quantum system .",
    "the observables are : @xmath223 where the ray @xmath224 for @xmath225 @xcite and @xmath108 .",
    "the state that violates this inequality maximally , and is therefore usually adopted in experimental tests is @xmath226 .",
    "the protocol could be implemented by control - unitary based : @xmath227 where @xmath228 form a basis for the 3-d hilbert space , @xmath229 and @xmath230 .",
    "this is tantamount to a @xmath231 rotation in the plane spanned by @xmath232 and @xmath233 .",
    "all @xmath5-cycle inequalities for even @xmath5 have a one to one mapping onto a chained bell inequalities ( where alice and bob each have one half of a bell pair and @xmath234 observables ) . in this case",
    "our 4-level system basis vectors @xmath235 from sec .",
    "[ sec : evenncycles ] should be identified with a basis for the 2-qubit space according to @xmath236 .",
    "the state that violates the chained bell inequality maximally is @xmath237 and the optimal settings are @xmath238 for an exact correspondence with sec .",
    "[ sec : evenncycles ] note that with the basis identification above @xmath239 in eq . .",
    "similarly @xmath240 , while @xmath241 and @xmath242 .",
    "we highlight that for the chsh inequality @xmath243 using the bell state @xmath244 , the settings prescribed by are @xmath245 the problem of finding @xmath46 such that @xmath246 and @xmath247 in sec . [ sec : evenncycles ] , now inheres a systematic solution from the theory of euler rotations .",
    "this solution is the form @xmath248 , where each single qubit unitary @xmath249 for @xmath250 , has the free parameters , @xmath251 ( rotation angle and axis ) .",
    "parameters @xmath252 are fixed by @xmath253 , while @xmath254 are fixed by @xmath255 . from the form of @xmath109 and @xmath256 in eq .",
    "we observe that it is always possible to set @xmath257 .",
    "once we have found @xmath46 , it is possible , albeit convoluted to rewrite @xmath248 in the basis @xmath258 ."
  ],
  "abstract_text": [
    "<S> a phd student is locked inside a box , imitating a quantum system by mimicking the measurement statistics of any viable observable nominated by external observers . inside a second box </S>",
    "<S> lies a genuine quantum system . </S>",
    "<S> either box can be used to pass a test for contextuality - and from the perspective of an external observer , be operationally indistinguishable . </S>",
    "<S> there is no way to discriminate between the two boxes based on the output statistics of any contextuality test . </S>",
    "<S> this poses a serious problem for contextuality tests to be used as viable tests for device independent quantumness , and severely limits realistic use of contextuality as an operational resource . </S>",
    "<S> here we rectify this problem by building experimental techniques for distinguishing a contextual system that is genuinely quantum , and one that mimics it through clever use of hidden variables . </S>"
  ]
}