{
  "article_text": [
    "we present in this paper an abstract method , having general interest , that can be applied to prove existence of solutions to a number of problems in geometric optics relative to refraction .",
    "the method is formulated in the abstract setting of compact metric spaces and it is based on the ideas of concave and convex mappings and the existence of families of functions that play the role of building blocks satisfying certain properties . the application to show existence of solutions to various problems then consists in selecting the appropriate maps and the appropriate class of building blocks related to the specific problem .",
    "a main application of this method considered in the paper is to solve the one source near field refractor problem , that is , to show existence of surfaces that refract radiation when the output and input intensities are prescribed .",
    "more precisely , we have a domain @xmath1 in the unit sphere @xmath2 and a domain @xmath3 contained in an @xmath0 dimensional surface in @xmath4 ; @xmath3 is referred as the target domain or screen to be illuminated .",
    "we also have two homogeneous and isotropic media i and ii with refractive indices @xmath5 and @xmath6 , respectively , and suppose that from a point @xmath7 surrounded by medium i , light emanates with intensity @xmath8 for @xmath9 , and @xmath3 is surrounded by media ii .",
    "we are also given in @xmath3 a radon measure @xmath10 and the energy conservation equation @xmath11 .",
    "we prove the existence of an optical surface @xmath12 parameterized by @xmath13 , interface between media i and ii , such that all rays refracted by @xmath12 into medium ii illuminate the object @xmath3 , and the prescribed illumination intensity distribution at @xmath3 is @xmath10 .",
    "of course , some conditions on the relative position of @xmath3 and the set of directions in @xmath1 are needed to illuminate @xmath3 .",
    "this implies that one can design a lens refracting light beams so that the screen @xmath3 is illuminated in a prescribed way .",
    "the lens is bounded by two optical surfaces , the `` outer '' surface is @xmath12 and the `` inner '' one is a sphere with center at the point from where the radiation emanates .    to implement the application of our abstract result to this case , we determine that the building blocks to construct the surface solution are descartes ovals . descartes ovals refract all light rays emanating from a point @xmath7 into a fixed point @xmath14 ; see figures [ fig : ovalskappa<1 ] and [ fig : ovalskappa>1 ] .",
    "the solution of the near field refraction problem depends in a essential way of a novel and very delicate study of the eccentricity of the ovals and its approximation properties , section [ sec : ovals ] .",
    "this geometry is much more complicated than the one needed for the solution to the far field problem solved in @xcite using mass transport .",
    "in particular , existence of solutions for the far field refractor problem can be obtained directly with this abstract method , section [ sec : furtherapplications ] .",
    "geometric optics problems -far and near field- received recently attention because of both its applications and their mathematical interest and difficulty .",
    "to put our results in perspective , we enumerate some related results .",
    "the problem of the far field reflector has been considered by several authors , both mathematicians and engineers .",
    "for example , existence and uniqueness up to dilations of solutions for the far field reflector problem were proved by caffarelli and oliker in @xcite and x - j .",
    "wang in @xcite , and for nonisotropic media by caffarelli and q. huang @xcite .",
    "@xmath15 regularity of solutions for the far field reflector was established in @xcite .",
    "the near field reflector problem was considered by kochengin and oliker in @xcite , and in recent work by karakhanyan and x - j .",
    "wang @xcite .",
    "the far field refractor problem was for the first time considered by the authors , and existence and uniqueness up to dilations of solutions were established in @xcite .",
    "refraction problems are in general more involved that reflection problems because of physical constraints .",
    "a difference between near and far field problems is that the latter can be cast in the frame of optimal transportation .",
    "instead , near field problems are in general not optimal transportation problems which makes their mathematical treatment more difficult .",
    "in particular , the presence of @xmath16 in the matrix @xmath17 and on the right hand side of the pde , indicates the problem is not an optimal transport problem .",
    "we mention that some results for the near field refractor problem have been announced in @xcite .",
    "the plan of the paper is the following .",
    "section [ sec : abstract setup ] contains the main results in the paper where we develop the abstract method .",
    "section [ sec : snelllaw ] describes the snell law and the physical constraints of refraction .",
    "section [ sec : ovals ] contains our study of cartesian ovals and estimates that are essential in the application to the near field problem . in section [ sec : definitionofweaksolution ] we describe the assumptions on the domains @xmath1 and @xmath3 and solve the near field problem when @xmath18 .",
    "similar existence results when @xmath19 are proved in section [ sec : existencekappa>1 ] . in section [ sec : furtherapplications ] we show further applications of our method : the far field refractor problem and the second boundary value problem for the monge - ampre equation .    finally , the pde governing the near field refractor problem is a fully nonlinear equation of monge - ampre type whose derivation is quite complicated and it is included in appendix , section [ sec : derivationofpde ] .",
    "let @xmath20 be compact metric spaces , and @xmath21 a radon measure on @xmath22 .",
    "let @xmath23 denote the class of all set - valued maps @xmath24 from @xmath22 to @xmath25 such that @xmath26 is single valued for a.e .",
    "@xmath27 with respect to the measure @xmath21 .",
    "we say that the map @xmath28 is continuous at @xmath29 if given @xmath30 and @xmath31 , there exists a subsequence @xmath32 and @xmath33 such that @xmath34 , as @xmath35 .",
    "let @xmath36 denote the class of all @xmath28 such that @xmath24 is continuous in @xmath22 ; and let @xmath37 denote the class of @xmath38 such that @xmath39 .",
    "[ lm : radonmeasureontarget ] given @xmath40 , the set function defined by @xmath41 is a radon measure on @xmath25 .",
    "the set @xmath42 is a @xmath43-algebra containing all borel sets in @xmath25 ( @xmath44 ) .",
    "indeed , @xmath45 , @xmath46 , @xmath47 , @xmath48 , and @xmath49 . if @xmath50 is compact in @xmath25 , then @xmath51 is compact in @xmath22 .",
    "in fact , let @xmath52 , and @xmath53 . since @xmath22 is compact and @xmath24 is continuous , there exist subsequences @xmath54 and @xmath55 such that @xmath56 and @xmath34 with @xmath33 , that is , @xmath57 . to show the @xmath43-additivity ,",
    "let @xmath58 be a disjoint sequence of sets in @xmath59",
    ". then @xmath60 .",
    "let @xmath61 denote the set of continuous functions in @xmath22 with the topology of uniform convergence .",
    "[ def : definitionofmaptcontinuous ] if @xmath62 and @xmath63 , we say that @xmath64 is continuous at @xmath65 , if whenever @xmath66 , @xmath67 uniformly in @xmath22 , @xmath29 , and @xmath68 , then there exists a subsequence @xmath69 such that @xmath70 with @xmath71 .",
    "[ lm : continuityofmeasuresabstractapproach ] if @xmath62 , @xmath63 is continuous at @xmath65 , and @xmath67 in @xmath61 with @xmath66 , then @xmath72 weakly .",
    "it is enough to show that @xmath73 and @xmath74 to prove , we show that @xmath75 .",
    "let @xmath76 .",
    "so there is @xmath77 , and since @xmath64 is continuous at @xmath78 , there exists a subsequence @xmath69 such that @xmath70 with @xmath71 .",
    "since @xmath79 , we have @xmath80 .",
    "hence @xmath81    to prove , we show that @xmath82 , with @xmath83 .",
    "indeed , @xmath84\\\\ & = \\limsup_{j\\to \\infty}\\mathcal t(\\phi_j)^{-1}(g^c)\\\\ & \\subset \\mathcal t(\\phi)^{-1}(g^c)\\qquad \\text{since $ g^c$ is compact because $ y$ is compact}\\\\ & = \\left(\\mathcal t(\\phi)^{-1}(g)\\right)^c\\cup \\left[\\mathcal t(\\phi)^{-1}(g)\\cap \\mathcal t(\\phi)^{-1}(g^c)\\right ] : = \\left(\\mathcal t(\\phi)^{-1}(g)\\right)^c\\cup e_0,\\end{aligned}\\ ] ] with @xmath83 , since @xmath85 is single valued except on a set of @xmath21-measure zero . therefore @xmath86      let @xmath87 in this subsection , we consider classes @xmath88 satisfying the following condition :    1 .   if @xmath89 , then @xmath90 .",
    "_ we say that the class @xmath88 is @xmath64-concave if @xmath91 satisfies ( a1 ) and there exists a map @xmath63 that is continuous at each @xmath65 and the following condition holds _    1 .   if @xmath92 , then @xmath93 .",
    "we also introduce the following condition on the class @xmath91 :    1",
    ".   for each @xmath94 there exists an interval @xmath95 and a family of functions @xmath96 satisfying 1 .",
    "@xmath97 for all @xmath98 , 2 .",
    "@xmath99 for @xmath100 , 3 .",
    "@xmath101 uniformly as @xmath102 , 4 .",
    "@xmath103 is continuous in @xmath61 with respect to @xmath104 , i.e. , @xmath105 as @xmath106 , for @xmath107 .",
    "[ rmk : mofhequalsdelta]notice that ( a3)(a ) implies that @xmath108 for @xmath107 . because if @xmath109 is a borel set with @xmath110 , then from ( a3)(a ) , @xmath111 and so @xmath112 . if @xmath113 , then @xmath114 and so @xmath115 and then @xmath116 .",
    "the following is the main theorem in this section .",
    "we solve a measure equation when the given measure in @xmath25 is discrete .",
    "[ thm : abstractcasediscritecase ] let @xmath20 be compact metric spaces and @xmath21 is a radon measure in @xmath22 .",
    "let @xmath117 be distinct points in @xmath25 , and @xmath118 be positive numbers with @xmath119 .",
    "let @xmath88 and @xmath63 be such that @xmath91 is @xmath64-concave and ( a3 ) holds .",
    "assume that @xmath120 and there exists @xmath121 such that @xmath122 for @xmath123 .",
    "then there exist @xmath124 , @xmath125 , such that the function , with @xmath126 , @xmath127 satisfies @xmath128    let @xmath126 and define the set @xmath129    by the assumptions , @xmath130 .",
    "* step 1 : * there exist constants @xmath131 , @xmath132 such that for all @xmath133 we have @xmath134 if @xmath135 , and @xmath136 if @xmath137 , for @xmath123 .    to prove this , we first show that the measure @xmath138 is supported on @xmath139 .",
    "this follows if we show that the set @xmath140 , where @xmath141 has @xmath21-measure zero .",
    "if @xmath142 , then @xmath143",
    ". therefore there is @xmath144 with @xmath145 for @xmath146 . on the other hand , @xmath147 for some @xmath148 . from ( a2 ) we then have @xmath149 , but @xmath150 by ( a3)(a ) , and so @xmath151 is not single - valued at @xmath152 .    consequently , from we get @xmath153 , and so @xmath154 . pick @xmath155 .",
    "we claim that @xmath156 for @xmath157 .",
    "otherwise , there is some @xmath157 such that @xmath158 .",
    "pick @xmath159 such that @xmath160 . then @xmath161 . hence from ( a2 ) , @xmath162 .",
    "but from ( a3)(a ) , @xmath163 , a contradiction and the claim is proved .",
    "since @xmath164 , we then get @xmath165 for all @xmath157 . from ( a3)(c ) , @xmath166 as @xmath167 , and therefore step 1 is proved .",
    "* step 2 : * @xmath168 is compact .",
    "it is enough to show that @xmath169 is continuous in @xmath170 for each @xmath146 .",
    "let @xmath171 converging to @xmath172 .",
    "then by ( a3)(d ) , @xmath173 uniformly as @xmath174 .",
    "therefore , as in the proof of lemma [ lm : continuityofmeasuresabstractapproach ] , we obtain @xmath175 for @xmath176 , and @xmath177 for each @xmath178 open . now choose @xmath178 open such that @xmath179 and @xmath180 for @xmath181 .",
    "then @xmath182 , but @xmath183 .",
    "we then obtain @xmath184 and the continuity follows .    * step 3 : * existence of solutions .",
    "the function @xmath185 attains its minimum on @xmath168 at some point @xmath186 .",
    "we claim that @xmath187 is the desired solution .",
    "otherwise , assume for example that @xmath188 .",
    "let @xmath189 and @xmath190 . by continuity @xmath191 for all",
    "@xmath192 sufficiently small .    for @xmath193",
    ", we claim that @xmath194 except on a set of @xmath21-measure zero . indeed , if @xmath195 and @xmath196 is a single point , then @xmath197 . notice that @xmath198 .",
    "otherwise , there exists @xmath181 , @xmath199 , such that @xmath200 ( we set @xmath201 ) . then from ( a2 ) , @xmath202 , and by ( a3)(a ) @xmath203 and so @xmath204 , a contradiction . from ( a3 ) ( b ) , @xmath205 so @xmath206 , and therefore @xmath207 . hence , and once again from ( a2 ) , @xmath208 .",
    "thus , @xmath209 from ( a3)(a ) , so @xmath210 , and the claim is proved .",
    "we then obtain @xmath211 for @xmath193 , that is , @xmath212 , a contradiction .",
    "[ rmk : existenceofrho0forb1close]the existence of the function @xmath213 in theorem [ thm : abstractcasediscritecase ] follows if one assumes that @xmath214 is given and it is sufficiently close to @xmath215 .",
    "in fact , in this case we pick @xmath216 for @xmath123 . since @xmath88",
    ", we have @xmath217 for @xmath157 and @xmath98 .",
    "then from ( a3 ) ( c ) , we can choose @xmath218 sufficiently close to @xmath215 such that @xmath219 .",
    "if @xmath220 for @xmath125 , we then select @xmath221 and so from remark [ rmk : mofhequalsdelta ] @xmath222 .",
    "consequently , @xmath223 for @xmath123 .",
    "[ lm : partialcomparison ] let @xmath224 be two solutions as in theorem [ thm : abstractcasediscritecase ] , with @xmath225 , and @xmath226 .",
    "assume that @xmath22 is connected and @xmath227 for each open set @xmath228 .",
    "assume in addition that condition ( a3)(b ) is replaced by @xmath229 for @xmath230 .    1 .",
    "if @xmath231 , then @xmath232 for all @xmath233 .",
    "in particular , if @xmath234 , then @xmath235 for all @xmath233 .",
    "2 .   if @xmath236 at some @xmath29 , then @xmath237 .",
    "\\(a ) let @xmath238 and @xmath239 .",
    "suppose by contradiction that @xmath240 .",
    "we have @xmath241 since @xmath242 . for each @xmath243",
    "we have @xmath244 for all @xmath98 , since @xmath245 . and also @xmath246 for all @xmath247 and all @xmath98 .",
    "let @xmath248 . from ( a2 ) and ( a3)(a ) , we notice that if @xmath249 , for some @xmath146 , then @xmath250 .",
    "we next prove that @xmath251 , where @xmath252 .",
    "indeed , let @xmath253 and @xmath254 be an open neighborhood of @xmath152 .",
    "then @xmath255 is a nonempty open set , since @xmath256 is compact .",
    "thus , @xmath257 has a positive measure and therefore is non empty .",
    "we then obtain @xmath258 such that @xmath259 and @xmath260 .",
    "so there exists @xmath261 with @xmath262 and @xmath263 .",
    "we may assume that @xmath264 , for some @xmath247 .",
    "therefore , @xmath265 . by taking limit , @xmath266 . from ( a2 ) and ( a3)(a ) , this yields @xmath267 . since @xmath268",
    ", we obtain @xmath269 .    as a consequence , @xmath270 .",
    "given @xmath271 , for any open neighborhood @xmath272 of @xmath273 , we have that @xmath274 is a nonempty open set .",
    "therefore , as in the previous argument , there exists @xmath275 for @xmath276 such that @xmath277 .",
    "hence , one may assume that there exists some @xmath278 with @xmath243 such that @xmath279 .",
    "so @xmath280 and then @xmath281 by taking limit .",
    "therefore , @xmath282 for all @xmath233 .",
    "thus , we obtain for @xmath243 that @xmath283 hence by continuity , there exists @xmath272 a neighborhood of @xmath273 such that @xmath284 by definition of @xmath16 this implies that @xmath285 for all @xmath286",
    ". therefore for each @xmath286 there exists @xmath287 , depending on @xmath288 , such that @xmath289 .",
    "hence , once again by ( a2 ) and ( a3)(a ) , @xmath290 .",
    "that is , @xmath291 , and therefore @xmath292    we then have that every point @xmath293 has a neighborhood contained in @xmath294 , that is , @xmath295 this is a contradiction with the fact that @xmath296    \\(b ) if @xmath297 , then @xmath298 for all @xmath299 by part ( a ) , and we are done",
    ". we claim that if @xmath300 , then @xmath301 for all @xmath299 .",
    "indeed , if @xmath298 for some @xmath302 , then @xmath303 for all @xmath304 by part ( a ) , a contradiction .",
    "therefore @xmath305 , a contradiction .",
    "[ thm : uniquenessabstractcase ] let @xmath306 be a sequence of discrete radon measures in @xmath25 such that @xmath307 weakly and @xmath308 for @xmath309 .",
    "let @xmath310 be a solution obtained in theorem [ thm : abstractcasediscritecase ] corresponding to @xmath311 .",
    "assume that there exists @xmath312 such that @xmath313 for @xmath309 .",
    "suppose that    1 .   for each @xmath314 with @xmath315",
    ", there exists @xmath316 such that @xmath317 .",
    "2 .   for any @xmath318",
    ", the family @xmath319 is compact in @xmath61 .",
    "then there exists @xmath320 satisfying @xmath321 .    by ( ii ) and lemma [ lm : continuityofmeasuresabstractapproach ] , it suffices to show @xmath322 is bounded from below and above .",
    "assume @xmath323 for some @xmath324 .",
    "then there exists @xmath325 such that @xmath326 and @xmath327 . by ( i ) , @xmath328 for some @xmath329 .",
    "therefore , @xmath330 . to get a lower bound , given @xmath331",
    ", there exists @xmath332 such that @xmath333 and @xmath334 .",
    "hence , @xmath335 .",
    "since @xmath336 is continuous and decreasing to zero ( ( a3)(b ) and ( c ) ) , there exists @xmath337 with @xmath338 .",
    "it follows from ( a3)(b ) that @xmath339 .",
    "hence @xmath340 .      we assume here that @xmath88 and condition ( a1 ) above is replaced by    1 .   if @xmath89 , then @xmath341 .",
    "_ we say that the class @xmath88 is @xmath64-convex if @xmath91 satisfies ( a1 ) and there exists a map @xmath63 that is continuous at each @xmath65 and the following condition holds _    1 .   if @xmath342 , then @xmath343 .    here",
    "we substitute condition ( a3 ) by    1",
    ".   for each @xmath94 there exists an interval @xmath95 and a family of functions @xmath96 satisfying 1 .",
    "@xmath97 for all @xmath98 , 2 .",
    "@xmath344 for @xmath100 , 3 .",
    "@xmath101 uniformly as @xmath345 , 4 .",
    "@xmath103 is continuous in @xmath61 with respect to @xmath104 , i.e. , @xmath105 as @xmath106 , for @xmath107 .    under these assumptions",
    "we prove the following theorem .",
    "[ thm : abstractcasediscritecaseconvexcasebis ] let @xmath20 be compact metric spaces and @xmath21 is a radon measure in @xmath22 .",
    "let @xmath117 be distinct points in @xmath25 , and @xmath118 be positive numbers with @xmath119 .",
    "let @xmath88 and @xmath63 be such that @xmath91 is @xmath64-convex and ( a3 ) holds .",
    "assume that @xmath346 suppose that there exists @xmath347 with @xmath348 on @xmath22 .",
    "then there exist @xmath124 , @xmath125 , such that the function , with @xmath126 , @xmath349 satisfies @xmath128    let @xmath126 and @xmath350 . from ( a3)(c ) , there exists @xmath351 such that @xmath352 for all @xmath123 .",
    "therefore , if @xmath353 , then @xmath354 , and so @xmath355 for @xmath125 .",
    "consider the set @xmath356 @xmath357 , because @xmath358 .",
    "we claim that @xmath359 , for @xmath360 , for all @xmath361 .    to prove the claim , we first show @xmath362 ; @xmath363 . indeed , for @xmath364",
    ", there is @xmath144 with @xmath145 for @xmath146 . on the other hand , @xmath147 for some @xmath365 . from ( a2 ) and ( a3)(a ) we then have @xmath366 .",
    "so @xmath151 is not single - valued at @xmath152 and so @xmath367 .",
    "consequently , from we get @xmath153 .",
    "now suppose by contradiction that @xmath368 for some @xmath123 .",
    "since @xmath126 , it follows from the assumption and ( a3)(b ) that @xmath369 in @xmath22 .",
    "this implies that for each @xmath29 , there is @xmath302 such that @xmath370 . by ( a2 ) ,",
    "thus , @xmath372 and @xmath373 , a contradiction and the claim is proved .    as in the proof of theorem 2.5",
    ", one can show that @xmath169 is continuous in @xmath170 for each @xmath146 .",
    "therefore , @xmath374 is compact .",
    "finally , to get the existence of solutions , the function @xmath185 attain its minimum on @xmath374 at some point @xmath186 .",
    "we claim that @xmath375 is the desired solution .",
    "otherwise , we may assume , for example , that @xmath188 .",
    "let @xmath189 and @xmath376 . by continuity @xmath191 for all",
    "@xmath192 sufficiently small .    on the other hand , for @xmath193",
    ", we claim that @xmath194 except on a set of @xmath21-measure zero . indeed ,",
    "if @xmath195 and @xmath196 is a single point , then @xmath377 .",
    "notice that @xmath198 .",
    "otherwise , if @xmath378 for some @xmath181 ( we set @xmath201 ) , then by ( a2 ) and ( a3)(a ) @xmath379 and so @xmath204 , a contradiction . set @xmath380 . from ( a3 ) ( b ) , @xmath381 and hence @xmath382 .",
    "hence , and once again from ( a2 ) , @xmath383 .",
    "thus , @xmath209 from ( a3)(a ) ; so @xmath210 , and the claim is proved .",
    "we then obtain @xmath211 for @xmath193 , that is , @xmath212 , a contradiction .",
    "similar to theorem [ lm : partialcomparison ] we have the following .",
    "[ lm : partialcomparisonconvex ] let @xmath224 be two solutions as in theorem [ thm : abstractcasediscritecaseconvexcasebis ] , with @xmath225 , and @xmath226 .",
    "assume that @xmath22 is connected and @xmath227 for each open set @xmath228 .",
    "assume in addition that condition ( a3)(b ) is replaced by @xmath384 for @xmath230 .    1 .",
    "if @xmath231 , then @xmath232 for all @xmath233 .",
    "in particular , if @xmath234 , then @xmath235 for all @xmath233 .",
    "2 .   if @xmath236 at some @xmath29 , then @xmath237 .",
    "[ thm : general measure ] let @xmath306 be a sequence of discrete radon measures in @xmath25 such that @xmath307 weakly and @xmath308 for @xmath309 .",
    "let @xmath310 be a solution obtained in theorem [ thm : abstractcasediscritecaseconvexcasebis ] corresponding to @xmath311 .",
    "assume that there exists @xmath312 such that @xmath313 for @xmath309 and @xmath385 for @xmath98 , @xmath386 .",
    "suppose that    1 .   for each @xmath314 with @xmath315",
    ", there exists @xmath316 such that @xmath317 .",
    "2 .   for any @xmath318",
    ", the family @xmath319 is compact in @xmath61",
    ".    then there exists @xmath320 satisfying @xmath321 .    by ( ii ) and lemma [ lm : continuityofmeasuresabstractapproach ] , it suffices to show @xmath322 is bounded from below and above .",
    "assume @xmath323 for some @xmath324 .",
    "then there exists @xmath325 such that @xmath387 and @xmath327 . by ( i ) , @xmath328 for some @xmath329 .",
    "therefore , @xmath388 . to get an upper bound , given @xmath331",
    ", there exists @xmath332 such that @xmath389 and @xmath334 .",
    "hence , @xmath390 .",
    "since @xmath391 , there exists @xmath392 with @xmath393 .",
    "it follows from ( a3)(b ) that @xmath394 .",
    "hence @xmath395 .",
    "we assume here that the class @xmath62 is @xmath64-convex , i.e. , @xmath91 satisfies ( a1 ) and there exists a map @xmath63 that is continuous at each @xmath65 and ( a2 ) holds .",
    "we also consider the following condition    1",
    ".   for each @xmath94 there exists an interval @xmath95 and a family of functions @xmath96 satisfying 1 .",
    "@xmath97 for all @xmath98 , 2 .",
    "@xmath99 for @xmath100 , 3 .",
    "@xmath396 uniformly as @xmath345 , 4 .",
    "@xmath103 is continuous in @xmath61 with respect to @xmath104 , i.e. , @xmath105 as @xmath106 , for @xmath107 .    under these assumptions",
    "we prove the following theorem .",
    "[ thm : abstractcasediscritecaseconvexcase ] let @xmath20 be compact metric spaces and @xmath21 be a radon measure in @xmath22 .",
    "let @xmath117 be distinct points in @xmath25 , and @xmath118 be positive numbers with @xmath119 .",
    "let @xmath62 and @xmath63 be such that @xmath91 is @xmath64-convex and ( a3  ) holds .",
    "assume that @xmath397 and there exists @xmath398 such that @xmath122 for @xmath123 .",
    "then there exist @xmath124 , @xmath125 , such that the function , with @xmath126 , @xmath349 satisfies @xmath128    we convert this case to the concave case considered in subsection [ subsect : convexcasebis ] , and use theorem [ thm : abstractcasediscritecase ] to prove the theorem .",
    "consider the family @xmath399 and the mapping @xmath400 given by @xmath401 .",
    "it is easy to verify that ( a1 ) and ( a2 ) hold and hence @xmath402 is @xmath403-concave .",
    "to verify ( a3 ) , for @xmath94 , consider the interval @xmath404 and @xmath405 .",
    "obviously , @xmath406 and satisfies ( a3)(a)-(d ) .",
    "set @xmath407 . by definition of @xmath403 , @xmath408 , and consequently @xmath409 . by theorem [ thm : abstractcasediscritecase ] , there exists @xmath410 satisfying the equation @xmath411 . since @xmath412 , @xmath413 .",
    "suppose @xmath414 is a surface in @xmath415 that separates two media i and ii that are homogeneous and isotropic .",
    "let @xmath416 and @xmath417 be the velocities of propagation of light in the media i and ii respectively .",
    "the index of refraction of medium i is @xmath418 , where @xmath419 is the velocity of propagation of light in the vacuum , and similarly @xmath420 .",
    "if a ray of light having direction @xmath421 and traveling through medium i hits @xmath414 at the point @xmath14 , and @xmath422 is the unit normal to @xmath414 at @xmath14 going towards medium ii , then this ray is refracted in the direction @xmath423 through medium ii according with the snell law in vector form : the vectors @xmath424 and @xmath425 are all coplanar , and the vector @xmath426 is parallel to the normal vector @xmath422 , that is , setting @xmath427 , we have @xmath428 for some @xmath429 . making the vector product of this equation with the normal @xmath422 we obtain the well known form of the snell law : @xmath430 , where @xmath431 is the angle between @xmath27 and @xmath422 ( the angle of incidence ) , @xmath432 the angle between @xmath425 and @xmath422 ( the angle of refraction ) . when @xmath18 , or equivalently @xmath433 , waves propagate in medium ii faster than in medium i , or equivalently , medium i is denser than medium ii . in this case",
    "the refracted rays tend to bent away from the normal , that is the case for example , when medium i is glass and medium ii is air . in case @xmath19 ,",
    "waves propagate in medium i faster than in medium ii , and the refracted rays tend to bent towards the normal . we summarize the physical constraints of refraction in the following lemma whose proof is in @xcite .",
    "let @xmath5 and @xmath6 be the indices of refraction of two media i and ii , respectively , and @xmath427",
    ". then a light ray in medium i with direction @xmath421 is refracted by some surface into a light ray with direction @xmath423 in medium ii if and only if @xmath434 , when @xmath18 ; and if and only if @xmath435 , when @xmath19 .",
    "to resolve our problem it is important to solve first the following simpler problem : given a point @xmath7 inside medium i and a point @xmath14 inside medium ii , find an interface surface @xmath436 between media i and ii that refracts all rays emanating from the point @xmath7 into the point @xmath14 .",
    "suppose @xmath7 is the origin , and let @xmath437 be a curve on @xmath436 . by the snell law of refraction",
    "the tangent vector @xmath438 satisfies @xmath439 that is , @xmath440 therefore @xmath436 is the cartesian oval @xmath441 with @xmath421 . then writing @xmath442 , squaring this quantity and solving the quadratic equation yields @xmath443 set @xmath444      we have @xmath446 if @xmath447 , then @xmath7 and @xmath14 are inside or on the oval , and so the oval can not refract rays to @xmath14 .",
    "if the oval is non empty , then @xmath448 . in case @xmath449 , the oval reduces to the point @xmath7 .",
    "the only interesting case is then @xmath450 . from the equation of the oval",
    "we get that @xmath451 .",
    "so we now should decide which values @xmath452 to take in the definition of @xmath453 .",
    "let @xmath454 and @xmath455 be the corresponding @xmath16 s .",
    "we claim that @xmath456 and @xmath457 .",
    "indeed , @xmath458 the equality @xmath459 holds only if @xmath460 and @xmath461 .",
    "so @xmath462 if @xmath450 .",
    "similarly , @xmath463 so the claim is proved .",
    "therefore the polar equation of the oval is then given by @xmath464    to find the refracting part of the oval , from the physical constraint for refraction ( lemma 3.1 ) , we must have @xmath465 , and by ( 4.1 ) it is reduced to @xmath466    the estimates of @xmath467 are contained in the following lemma .",
    "[ lm : minandmaxofovalskappa<1 ] let @xmath445 , @xmath467 given by , and assume that @xmath450 .",
    "then we have @xmath468 we also have @xmath469 and @xmath470    we write @xmath471 and let @xmath472 .",
    "we have @xmath473 is decreasing for @xmath474 , and so @xmath475 . hence @xmath476 and calculating @xmath477 and @xmath478 the estimates in follow .",
    "to prove , since @xmath479 , the first equality follows from the right identity in . to show the second identity in ,",
    "notice that since the oval is convex and symmetric with respect to the line joining 0 and @xmath14 we have that @xmath480 is attained at @xmath481 .",
    "in particular , this gives the explicit value of the distance from @xmath14 to the oval .",
    "to prove we have @xmath482 , and we claim that @xmath483 for all @xmath484 .",
    "in fact , this follows from since @xmath485 , obtaining @xmath486 .",
    "if @xmath487 , then the oval converges to an ellipsoid which is the surface having the uniform refraction property in the far field case , see @xcite .",
    "in fact , if @xmath488 and @xmath489 with @xmath490 positive constant we have @xmath491 as @xmath487 .      in this case",
    "we must have @xmath493 , and in case @xmath494 the oval reduces to the point @xmath14 .",
    "also @xmath495 , since otherwise the points @xmath496 are inside the oval or @xmath497 is on the oval , and therefore there can not be refraction if @xmath498 .",
    "so to have refraction we must have @xmath499 and so the point @xmath14 is inside the oval and @xmath497 is outside the oval .    rewriting @xmath16 in we get that @xmath500 now @xmath501 amounts @xmath502 , by noticing that @xmath503 if @xmath504 .",
    "we have that @xmath505 . to have refraction , by the physical constraint we need to have @xmath506 , which is equivalent to @xmath507 .",
    "therefore , the physical constraint is satisfied only by @xmath455 .    for @xmath499 , the refracting piece of the oval is then given by @xmath508 with @xmath509",
    "let us define @xmath510 and let @xmath511 that is , @xmath512 denotes the set of directions in @xmath513 .",
    "we notice that @xmath514 is decreasing as a function of @xmath515 and tends to one when @xmath516 , and tends to @xmath517 when @xmath518 .    if @xmath487 , then the oval @xmath513 converges to the semi hyperboloid appearing in the far field refraction problem when @xmath19 , see @xcite . indeed , let @xmath519 and @xmath520 with @xmath521 a constant",
    ". then we have @xmath522 as @xmath487 .",
    "on the other hand , if @xmath523 , we get @xmath524 as @xmath487 .",
    "the following lemma gives estimates for the size of @xmath467 .",
    "[ lm : estimateofovalsk>1 ] let @xmath19 , @xmath467 is given by , assume @xmath499 , and @xmath512 given by .",
    "we have    1 .",
    "@xmath525 ; 2 .",
    "@xmath526 ; 3 .",
    "@xmath527 , for @xmath528 ; 4 .",
    "the following inequalities hold : @xmath529 where @xmath514 is given by .",
    "\\(a ) the minimum of @xmath467 is attained when @xmath481 .",
    "so @xmath530    \\(b ) the maximum of @xmath467 on @xmath512 is attained when @xmath531 that is , when @xmath532 and the formula follows .",
    "\\(c ) we have @xmath533 furthermore , set @xmath534 and then @xmath535 .",
    "it yields @xmath536 .",
    "\\(d ) it follows writing @xmath537 and noticing that @xmath538 , since @xmath499 .    if @xmath518 , then , by lemma [ lm : estimateofovalsk>1](a ) , @xmath513 approaches zero .    if @xmath516 , then @xmath513 shrinks to @xmath14 . because @xmath539 for @xmath540 and so @xmath541 .",
    "let @xmath542 be a domain with @xmath543 ( measure in the sphere ) .",
    "let @xmath544 be a `` target '' domain that we want to illuminate and suppose it is contained in an @xmath0 dimensional hypersurface , and assume @xmath545 is compact , and @xmath546 .",
    "points in the sphere will be denoted with lower case letters and points in @xmath4 by capitals .",
    "we make the following assumptions on @xmath1 and @xmath3 :    1 .",
    "[ assumption1 ] there exists @xmath547 with @xmath548 such that @xmath549 for all @xmath550 and all @xmath551 .",
    "2 .   [ assumption2 ]",
    "let @xmath552 and consider the cone in @xmath4 @xmath553 for each @xmath423 and for each @xmath554 we assume that @xmath555 contains at most one point .",
    "that is , for each @xmath554 each ray emanating from @xmath22 intersects @xmath545 at most in one point .    given @xmath556 and @xmath450 , keeping in mind and , a refracting oval is the set @xmath557 where @xmath558    [ def : definitionofrefractorkappa<1 ] let @xmath559 be a surface .",
    "we say that @xmath436 is a near field refractor if for any point @xmath560 there exist @xmath551 and @xmath561 such that the refracting oval @xmath513 supports @xmath436 at @xmath562 , i.e. @xmath563 for all @xmath550 with equality at @xmath564 .",
    "the near field refractor mapping associated with @xmath436 is defined by @xmath565    the definition implies that if @xmath513 is a supporting oval , then the openning of @xmath513 is wider than @xmath566 , i.e. , @xmath567 for all @xmath550 .",
    "[ rmk : refractorissurjective]if @xmath436 is a near field refractor , then @xmath568 .",
    "indeed , let @xmath551 and @xmath569 . then from the left identity in and the assumption on @xmath570 in [ assumption2 ] we get that @xmath571 for @xmath550 . also from [ assumption1 ]",
    ", we have @xmath572 .",
    "hence @xmath573 enclosed by @xmath574 .",
    "let @xmath575 thus , the oval @xmath576 supports @xmath436 at some @xmath577 .",
    "we point out that if @xmath578 , then @xmath579 .",
    "[ rmk : uniformlipschitz ] if @xmath436 is a near field refractor with defining function @xmath453 , then @xmath16 is lipschitz continuous in @xmath580 with a lipschitz constant depending only on @xmath581 ad @xmath547 in the assumptions [ assumption1 ] and [ assumption2 ] and @xmath582 .    indeed , given @xmath583 , @xmath436 has a supporting oval @xmath467 at @xmath584 with @xmath551 .",
    "then @xmath585 where @xmath586 is given by .",
    "we have @xmath587 and @xmath588 we estimate @xmath589 from below .",
    "obviously , the function @xmath590 has a minimum at @xmath591 , is increasing in @xmath592 and decreasing in @xmath593 . since @xmath18 , we have @xmath594 , and so @xmath586 decreases in the interval @xmath595 $ ] . since @xmath596 and @xmath597 , @xmath598}\\delta ( t)=\\delta(|p|)=\\kappa^{2}\\,(|p|-b)^{2},\\ ] ] and therefore @xmath599 from @xmath600 which combined with yields @xmath601 since @xmath602 , and @xmath573",
    ", we get that @xmath603 . from [ assumption2 ] ,",
    ". therefore we obtain the estimate @xmath605 clearly , @xmath606 which completes the proof of the lemma .",
    "we apply the setup in that section with the spaces @xmath607 , and @xmath608 .",
    "the radon measure @xmath21 in @xmath566 there is now given by @xmath609 with @xmath610 nonnegative .",
    "if @xmath436 is a near field refractor in the sense of definition [ def : definitionofrefractorkappa<1 ] , then it is proved in lemma [ measurabilityrefractormap ] below that the map @xmath611 . from lemma",
    "[ lm : radonmeasureontarget ] we therefore obtain that the set function @xmath612 is a radon measure defined on @xmath613 .",
    "we call this measure _ the near field refractor measure associated with @xmath614 and the refractor @xmath436_.    let @xmath615 denote the near field refractor with defining radial function @xmath16 given by definition [ def : definitionofrefractorkappa<1 ] .",
    "we let @xmath91 be the family of functions in @xmath616 given by @xmath617 on @xmath91 we define the mapping @xmath64 by @xmath618 to continue with the application of the results from section [ sec : abstract setup ] , we need to show also that @xmath64 is continuous at each @xmath320 in the sense of definition [ def : definitionofmaptcontinuous ] .",
    "this is proved in lemma [ lm : weakcompactness ] below .",
    "[ measurabilityrefractormap ] for each near field refractor @xmath436 , we have @xmath619 .    by remark [ rmk : refractorissurjective ]",
    ", @xmath620 is surjective .",
    "now show that @xmath621 is single - valued for a.e .",
    "@xmath27 with respect to @xmath21 .",
    "if @xmath621 contains more than one point , then @xmath436 parameterized by @xmath16 has two distinct supporting ovals @xmath622 and @xmath623 at @xmath624 with @xmath625 .",
    "we claim that @xmath624 is a singular point of @xmath436 .",
    "otherwise , if @xmath436 has tangent hyperplane @xmath626 at @xmath624 , then @xmath627 must coincide both with the tangent hyperplane of @xmath622 and that of @xmath623 at @xmath624 . from the snell law",
    "we get that @xmath628 , and so the ray through @xmath629 with direction @xmath425 contains @xmath630 and therefore @xmath631 from assumption [ assumption2 ] , a contradiction .",
    "since the graph of @xmath436 is lipschitz and @xmath543 , the set of singular points of @xmath436 has measure zero and therefore @xmath621 is single - valued for a.e . @xmath632 .    to prove that @xmath620 is continuous , let @xmath633 and @xmath634 .",
    "let @xmath635 be a supporting oval to @xmath436 at @xmath636 . then @xmath637 with equality at @xmath638 and @xmath639 for all @xmath550 .",
    "assume that @xmath640 on @xmath566 for some constant @xmath641 . from and [ assumption2 ]",
    "we get @xmath642 . therefore selecting a subsequence we can assume that @xmath643 and @xmath644 , as @xmath645 . by taking limit in",
    ", one obtains that the oval @xmath646 supports @xmath436 at @xmath647 , @xmath648 , and @xmath649 .",
    "[ lm : weakcompactness ] the refractor mapping @xmath650 is continuous at each @xmath320 .",
    "suppose @xmath651 uniformly as @xmath35 .",
    "let @xmath652 and @xmath653 .",
    "then there exists @xmath654 such that @xmath655 for all @xmath550 with equality at @xmath656 and with @xmath657 . as in the proof of lemma [ measurabilityrefractormap ] , @xmath658for some @xmath521",
    ", so there exists a subsequence @xmath659 and @xmath660 .",
    "we therefore can apply lemma [ lm : continuityofmeasuresabstractapproach ] to obtain that the definition of refractor measure given in is stable by uniform limits , i.e. , if @xmath661 uniformly , then @xmath662 weakly .    to be able to apply theorem [ thm : abstractcasediscritecase ] , we next need to verify that the family @xmath91 and the map @xmath64 satisfy conditions ( a1)-(a3 ) from subsection [ subsect : generalconcavecase ] .",
    "indeed , ( a1 ) follows immediately from the definition of refractor .",
    "condition ( a2 ) immediately follows from the definition of refractor .",
    "it remains to verify ( a3 ) .",
    "for that we use the estimates for ovals proved in section [ sec : ovals ] . indeed , with the notation in condition ( a3 ) we will take @xmath663 with the understanding that @xmath664 , and @xmath665 , and @xmath467 is the oval defined by .",
    "in other words , we will show that the family @xmath666 and verifies ( a3 ) , with @xmath667 from [ assumption2 ] . indeed , to show the inclusion , if @xmath668 , then from [ assumption2 ] and [ assumption1 ] we have @xmath669 for all @xmath9 .",
    "so the oval @xmath670 refracts in @xmath1 and in particular @xmath671 for all @xmath672 , that is , ( a3)(a ) holds .",
    "condition ( a3)(b ) is trivial .",
    "condition ( a3)(c ) follows from the second identity in .",
    "to verify ( a3)(d ) , we notice that since @xmath673 has a lower bound given in , we obtain that @xmath674 , with @xmath490 depending only on the constants in [ assumption1 ] and [ assumption2 ] .",
    "the notion of weak solution is introduced through conservation of energy .",
    "a near field refractor @xmath675 is a weak solution of the near field refractor problem for the case @xmath18 with emitting illumination intensity @xmath8 on @xmath566 and prescribed refracted illumination intensity @xmath10 on @xmath545 if for any borel set @xmath676 @xmath677    we are now ready to apply theorem [ thm : abstractcasediscritecase ] to solve the near field refractor problem when the measure @xmath10 is a linear combination of deltas .",
    "[ thm : existencesumofdiracmasses ] suppose [ assumption1 ] and [ assumption2 ] hold .",
    "let @xmath678 be distinct points in @xmath545 , @xmath679 are positive numbers , and @xmath680 with @xmath681 a.e . in @xmath1",
    "such that @xmath682 then , for each @xmath683 with @xmath684 , there exists a unique @xmath685 such that the poly - oval @xmath686 with @xmath687 is a weak solution to the near field refractor problem .",
    "moreover , @xmath688 for @xmath233 .    to prove the theorem , we apply theorem [ thm : abstractcasediscritecase ] .",
    "so we only need to verify that there exists @xmath689 satisfying @xmath690 for @xmath125 .",
    "rewrite @xmath691 for some @xmath692 .",
    "let @xmath693 , and @xmath694 for @xmath123 .",
    "then @xmath695 , because @xmath696 for @xmath123 , from [ assumption2 ] and .",
    "hence @xmath697 for @xmath698 .",
    "the uniqueness follows from theorem [ lm : partialcomparison ] .",
    "[ thm : existencegeneralcasekappa<1 ] assume conditions [ assumption1 ] and [ assumption2 ] . let @xmath10 be a radon measure on @xmath545 , @xmath680 with @xmath681 a.e . , and satisfying the energy conservation condition @xmath699    then given @xmath700 with @xmath701 , there exists a weak solution of the near field refractor problem passing through @xmath702 .",
    "we assume first that @xmath703 , with @xmath704 and @xmath705 distinct points in @xmath613 . from theorem [ thm : existencesumofdiracmasses ] ,",
    "given @xmath706 there exists a unique @xmath685 such that @xmath436 , defined by the radial function @xmath707 , is a weak solution to the near field refractor problem . by the comparison theorem",
    "[ lm : partialcomparison ] , the function @xmath708 is increasing in @xmath709 and continuous for @xmath710 .",
    "let @xmath711 for @xmath712 .",
    "we shall first prove that @xmath713 we have @xmath714 with @xmath715 and some @xmath716",
    ". from @xmath717 also there exists @xmath718 such that @xmath719 and then again by , @xmath720 .",
    "hence from we get @xmath721 once again by , @xmath722 , which combined with yields @xmath723 and hence follows . on the other hand , @xmath724 by for all @xmath725 and",
    "hence given @xmath726 , we get @xmath727 for all @xmath550 as long as @xmath683 is sufficiently close to @xmath728 .",
    "suppose now that @xmath700 with @xmath701 and with @xmath729 .",
    "hence from and the continuity of @xmath730 , we obtain that there exists @xmath731 such that @xmath732 .    for the general case of a radon measure @xmath10 in @xmath613",
    ", we choose a sequence of measures @xmath733 such that each one is a finite combination of dirac measures and @xmath734 weakly with @xmath735 . from the above ,",
    "let @xmath736 be the near field refractor corresponding to the measure @xmath733 and parameterized by @xmath737 and passing through the point @xmath702 .",
    "thus , @xmath729 and @xmath738 .",
    "i.e. , @xmath739 for all @xmath740 .",
    "we also notice that if @xmath741 , then by lemma [ lm : minandmaxofovalskappa<1 ] @xmath742 from lemma [ rmk : uniformlipschitz ] and the proof of lemma 5.5 , the family @xmath743 is compact . then applying theorem [ thm : uniquenessabstractcase ] we obtain the existence of the desired solution .",
    "let @xmath542 be a domain with @xmath543 ( measure in the sphere ) , and let @xmath544 be a compact hypersurface with @xmath744 .",
    "we assume :    1 .",
    "@xmath745 for some @xmath746 .",
    "2 .   let @xmath747 and consider the cone in @xmath4 @xmath748 for each @xmath423 and for each @xmath554 we assume that @xmath555 contains at most one point .",
    "that is , for each @xmath554 each ray emanating from @xmath22 intersects @xmath545 at most in one point .    similarly with the case @xmath18 , but now keeping in mind and , we define the notion of refractor when @xmath19 .",
    "[ def : refractorkappa>1 ] let @xmath559 be a surface .",
    "we say that @xmath436 is a near field refractor if for any point @xmath560 there exist @xmath551 and @xmath561 such that the refracting oval @xmath513 supports @xmath436 at @xmath562 , i.e. @xmath749 for all @xmath550 with equality at @xmath564 , and @xmath750 where @xmath514 is defined in .",
    "the near field refractor map of @xmath436 is defined by @xmath751    [ rmk : estimateofrhoandrhox0]if @xmath752 is a refractor , then for any @xmath753 we have @xmath754 indeed , if @xmath755 is a supporting oval at @xmath624 , then from lemma [ lm : estimateofovalsk>1 ] we have @xmath756 .",
    "[ eq : estimateofipb]@xmath568 for any refractor @xmath757 . to prove the remark",
    ", we first notice that if @xmath551 and @xmath603 for some @xmath583 , then @xmath758 .",
    "indeed , we have from lemma [ lm : estimateofovalsk>1](d ) that @xmath759 from the choice of @xmath570 in condition ( h4 ) . given @xmath551 ,",
    "let @xmath576 be the oval with @xmath760 obviously , @xmath761 touches @xmath436 at some @xmath718 .",
    "[ rmk : uniformlipschitzkappa>1 ] if @xmath436 is a near field refractor with defining function @xmath453 , then @xmath16 is lipschitz in @xmath580 with a lipschitz constant depending only on the constants in the assumptions ( h3 ) and ( h4 ) .    as in the proof of lemma [ rmk : uniformlipschitz ]",
    ", the lipschitz continuity and constant of @xmath467 is reduced to the lipschitz continuity and lower bound of @xmath586 , where @xmath762 by ( h3 ) @xmath763 for @xmath632 . from lemma [ lm : estimateofovalsk>1](a ) and",
    "( d ) we have @xmath764 where @xmath765 by ( h4 ) .",
    "thus , if @xmath603 , for @xmath632 we have @xmath766 and furthermore @xmath767 ^ 2- ( \\kappa^2 - 1)(\\kappa^2|p|^2-b^2)\\notag \\\\",
    "& \\ge \\left[\\kappa^2|p|i(p , b)-b\\right]^2+(\\kappa^2|p|\\sigma)^2- ( \\kappa^2 - 1)(\\kappa^2|p|^2-b^2 ) \\notag \\\\ & \\ge \\left(\\kappa^2\\inf_{p\\in d}|p|\\sigma\\right)^2.\\end{aligned}\\ ] ] therefore , the uniform lipschitz continuity for ovals and refractors contained in @xmath768 on @xmath566 follows .",
    "we apply the setup in that subsection with the spaces @xmath607 , and @xmath608 .",
    "the radon measure @xmath21 in @xmath566 there is given by @xmath609 with @xmath610 nonnegative .",
    "if @xmath436 is a near field refractor in the sense of definition [ def : refractorkappa>1 ] , then it is proved in lemma [ measurabilityrefractormapkappa>1 ] below that the map @xmath619 . from lemma [ lm : radonmeasureontarget ]",
    "we therefore obtain that the set function @xmath769 is a radon measure on @xmath613 .",
    "we call this measure _ the near field refractor measure associated with @xmath614 and the refractor @xmath436_.    we next introduce the family @xmath91 .",
    "let @xmath615 denote the near field refractor with defining radial function @xmath16 given by definition [ def : refractorkappa>1 ] .",
    "we let @xmath91 be the family of functions in @xmath616 given by @xmath617 on @xmath91 we introduce the mapping @xmath64 by @xmath618 to continue with the application of the results from subsection [ subsect : convexcasebis ] , we show in the next two lemmas that @xmath619 and @xmath64 is continuous at each @xmath320 in the sense of definition [ def : definitionofmaptcontinuous ] .",
    "[ measurabilityrefractormapkappa>1 ] for any near field refractor @xmath436 , we have @xmath770 .    as in the proof of lemma [ measurabilityrefractormap ] , using ( h4 )",
    ", one can show that @xmath621 is single - valued for a.e .",
    "x with respect to @xmath21 .    to prove that @xmath620 is continuous , let @xmath633 and @xmath634 .",
    "let @xmath635 be a supporting oval to @xmath436 at @xmath771 .",
    "we have @xmath772 and from lemma [ lm : estimateofovalsk>1 ] ( b ) we get @xmath773 , and so @xmath774 .",
    "on the other hand , by lemma [ lm : estimateofovalsk>1 ] ( c ) we have @xmath775 .",
    "since @xmath776 , we obtain @xmath777 . therefore selecting a subsequence",
    "we can assume that @xmath778 and @xmath644 , as @xmath645 .",
    "taking limits one obtains that the oval @xmath646 supports @xmath436 at @xmath647 , @xmath779 , and @xmath649 .",
    "this completes the proof .    by lemma [ rmk : uniformlipschitzkappa>1 ] and",
    "modifying the proof of lemma [ measurabilityrefractormapkappa>1 ] , we also obtain the following analogue of lemma [ lm : weakcompactness ] when @xmath19 .",
    "[ lm : weakcompactnesskappa>1 ] the refractor mapping @xmath650 is continuous at each @xmath320 .",
    "moreover , for @xmath780 , @xmath781 is compact in @xmath782 .    to be able to apply theorem [ thm : abstractcasediscritecaseconvexcasebis ]",
    ", we next need to verify that the family @xmath91 and the map @xmath64 satisfy conditions ( a1)-(a3 ) from subsection [ subsect : convexcasebis ] . indeed , ( a1 ) and ( a2 ) follow immediately from the definition [ def : refractorkappa>1 ] of refractor , lemma [ measurabilityrefractormapkappa>1 ] , and lemma [ lm : weakcompactnesskappa>1 ] .",
    "it remains to verify ( a3 ) .",
    "for that we use the estimates for ovals proved in subsection [ subsect : estimatesofovalskappa>1 ] . indeed , with the notation in condition ( a3 ) we will take @xmath663 with the understanding that @xmath664 , and @xmath665 , and @xmath467 is the oval defined by and . by lemma [ lm : estimateofovalsk>1 ] and remark [ eq : estimateofipb ] , we have that the family @xmath783 with @xmath667 from ( h4 ) . obviously , @xmath671 for all @xmath672 , that is , ( a3)(a ) holds .",
    "condition ( a3)(b ) is trivial .",
    "condition ( a3)(c ) follows lemma [ lm : estimateofovalsk>1 ] parts ( a ) and ( b ) . to verify ( a3)(d )",
    ", we notice that from the lower bound , we obtain that @xmath674 , with @xmath490 depending only on the constants in ( h3 ) and ( h4 ) .    the notion of weak solution is again introduced through conservation of energy .",
    "a near field refractor @xmath675 is a weak solution of the near field refractor problem for the case @xmath19 with emitting illumination intensity @xmath8 on @xmath566 and prescribed refracted illumination intensity @xmath10 on @xmath545 if for any borel set @xmath676 @xmath784      this follows from theorem [ thm : abstractcasediscritecaseconvexcasebis ] .",
    "[ thm : existencesumofdiracmasseskappa>1 ] suppose ( h3 ) and ( h4 ) hold .",
    "let @xmath678 be distinct points in @xmath545 , @xmath679 are positive numbers , and @xmath680 with @xmath681 a.e . in @xmath1",
    "such that @xmath785 then for each @xmath683 such that @xmath786 , with @xmath787 , there exist a unique @xmath685 such that the poly - oval @xmath686 with @xmath788 is a weak solution to the near field refractor problem .",
    "moreover , @xmath688 for @xmath233 .    by theorem [ thm : abstractcasediscritecaseconvexcasebis ] , it suffices to show that there exists @xmath347 such that @xmath789 for all @xmath790 .",
    "rewrite @xmath791 with @xmath792 .",
    "choose @xmath793 , @xmath125 .",
    "then from lemma [ lm : estimateofovalsk>1](b ) , @xmath794 .",
    "on the other hand , from lemma [ lm : estimateofovalsk>1](a ) , we have for @xmath125 that @xmath795 by the choice of @xmath43 , @xmath796 for @xmath125 .",
    "[ thm : generalcaseradonmeasurekappa>1 ] assume conditions ( h3 ) and ( h4 ) .",
    "let @xmath10 be a radon measure on @xmath545 , @xmath680 with @xmath681 a.e . , and satisfying the energy conservation condition @xmath699 then given @xmath700 with @xmath797 , there exists a weak solution of the near field refractor problem passing through @xmath702 .",
    "we assume first that @xmath703 , with @xmath704 and @xmath705 pairwise distinct points in @xmath613 . from theorem [ thm : existencesumofdiracmasseskappa>1 ] ,",
    "given @xmath798 there exists a unique @xmath685 such that @xmath799 , defined by the radial function @xmath800 , is a weak solution to the near field refractor problem . by the comparison theorem [ lm : partialcomparisonconvex ] , the function @xmath708 is decreasing in @xmath709 and continuous for @xmath801 . for small @xmath802 , from lemma [ lm : estimateofovalsk>1](a ) we have @xmath803 on the other hand , let @xmath804 , @xmath123 be the corresponding @xmath805 s to @xmath806 .",
    "we have @xmath807 .",
    "since @xmath808 , there exists @xmath809 such that @xmath810 .",
    "consequently , @xmath811 and therefore @xmath812{\\epsilon}\\to 0,\\ ] ] as @xmath813 .",
    "consequently , by continuity of @xmath708 , given @xmath814 with @xmath815 , there exists @xmath816 such that @xmath817 .    for the general case of a radon measure @xmath10 in @xmath613",
    ", we choose a sequence of measures @xmath733 such that each one is a finite combination of dirac measures and @xmath734 weakly with @xmath735 . from the above ,",
    "let @xmath736 be the near field refractor corresponding to the measure @xmath733 and parameterized by @xmath737 and passing through the point @xmath702 .",
    "thus , @xmath818 for all @xmath819 . from , @xmath820 , where @xmath821 .",
    "by lemma [ lm : estimateofovalsk>1 ] and lemma [ lm : weakcompactnesskappa>1 ] , one can apply theorem [ thm : general measure ] to obtain the existence of solutions .",
    "to illustrate the general framework described in section [ sec : abstract setup ] , we briefly show how to recover the results for the far field refractor , proved using mass transport in @xcite , and also the solution to the second boundary value problem for the monge - ampre equation .",
    "we only state the results when the measure @xmath10 is a finite combination of dirac measures .",
    "the general case for a general radon measure follows by approximation as in theorems [ thm : uniquenessabstractcase ] and [ thm : existencegeneralcasekappa<1 ] , and noticing that the far field refractor problem is dilation invariant and the second boundary value problem for monge - ampre equation is translation invariant .",
    "we have two domains @xmath822 satisfying the condition @xmath823 for all @xmath9 , @xmath824 , with @xmath825 . in this case , refractors are defined with supporting semi - ellipsoids @xmath826 in ( * ? ? ?",
    "* definition 3.1 ) .",
    "we shall apply the setup in section [ sec : abstract setup ] with the spaces @xmath607 , and @xmath827 .",
    "the radon measure @xmath21 in @xmath566 is now given by @xmath609 with @xmath610 nonnegative . if @xmath436 is a far field refractor in the sense of ( * ? ? ?",
    "* definition 3.1 ) , then it is proved in lemma [ measurabilityrefractormapfarfield ] below that the map @xmath828 , where @xmath829 is defined in ( * ? ? ?",
    "* definition 3.2 ) . from lemma [ lm : radonmeasureontarget ]",
    "we therefore obtain that the set function @xmath830 is a radon measure defined on @xmath831 .",
    "we call this measure _ the far field refractor measure associated with @xmath614 and the refractor @xmath436_.    we next introduce the family @xmath91",
    ". let @xmath615 denote the far field refractor with defining radial function @xmath16 given by ( * ? ? ?",
    "* definition 3.1 ) .",
    "we let @xmath91 be the family of functions in @xmath616 given by @xmath832 on @xmath91 we define the mapping @xmath64 by @xmath833 to continue with the application of the results from section [ sec : abstract setup ] , we need to also show that @xmath64 is continuous at each @xmath320 in the sense of definition [ def : definitionofmaptcontinuous ] .",
    "this is proved in lemma [ lm : weakcompactnessfarfield ] below .",
    "[ measurabilityrefractormapfarfield ] for each far field refractor @xmath436 , we have @xmath834 .",
    "suppose @xmath436 is parameterized by @xmath453 .",
    "we first show that @xmath835 . because if @xmath836 , then letting @xmath837 we get that the semi ellipsoid @xmath838 supports @xmath453 at some @xmath839 .",
    "next show that @xmath840 is single - valued for a.e .",
    "@xmath27 with respect to @xmath21 .",
    "indeed , will prove that @xmath841 .",
    "in fact , if @xmath842 , and @xmath16 is differentiable at @xmath27 , then @xmath16 has a unique supporting hyperplane @xmath627 at @xmath27 having outer unit normal @xmath422 .",
    "since the semi ellipsoids @xmath843 and @xmath844 support @xmath16 at @xmath27 , the hyperplane @xmath627 supports both semi ellipsoids at @xmath27 , and then from the snell law we get that @xmath845 and @xmath846 .",
    "but since @xmath847 , we get that @xmath848 .",
    "since the graph of @xmath436 is lipschitz and @xmath543 , the set of singular points of @xmath436 has measure zero and therefore @xmath840 is single - valued for a.e . @xmath632 .    to prove that @xmath829 is continuous , let @xmath633 and @xmath849 .",
    "let @xmath850 be a supporting semi ellipsoid to @xmath436 at @xmath636 . then @xmath851 with equality at @xmath638 and @xmath852 for all @xmath550 .",
    "assume that @xmath853 on @xmath566 for some constants @xmath854 .",
    "from we then get @xmath855 . therefore selecting a subsequence",
    "we can assume that @xmath856 and @xmath644 , as @xmath645 . by taking limit in",
    ", one obtains that semi ellipsoid @xmath857 supports @xmath436 at @xmath647 .",
    "[ lm : weakcompactnessfarfield ] the far field refractor mapping @xmath858 is continuous at each @xmath320 .",
    "suppose @xmath651 uniformly as @xmath35 .",
    "let @xmath652 and @xmath859",
    ". then there exists @xmath654 such that @xmath860 for all @xmath550 with equality at @xmath656 and with @xmath861 . selecting subsequences as in the proof of lemma [ measurabilityrefractormapfarfield ]",
    ", we obtain @xmath862 .",
    "we therefore can apply lemma [ lm : continuityofmeasuresabstractapproach ] to obtain that the definition of refractor measure given in is stable by uniform limits , i.e. , if @xmath661 uniformly , then @xmath662 weakly .    to be able to apply theorem [ thm : abstractcasediscritecase ] , we next need to verify that the family @xmath91 and the map @xmath64 satisfy conditions ( a1)-(a3 ) from section [ sec : abstract setup ] .",
    "indeed , ( a1 ) follows immediately from the definition of far field refractor .",
    "condition ( a2 ) immediately follows from the definition of far field refractor .",
    "it remains to verify ( a3 ) .",
    "indeed , with the notation in condition ( a3 ) we will take @xmath863 with the understanding that @xmath664 , and @xmath864 , and @xmath865 is the semi ellipsoid @xmath866 .",
    "in other words , we will show that the family @xmath867 and verifies ( a3 ) .",
    "indeed , it is clear that @xmath868 is a far field refractor , and in particular , @xmath869 for all @xmath672 , that is , ( a3)(a ) holds . condition ( a3)(b ) is trivial .",
    "condition ( a3)(c ) follows from @xmath870 .",
    "finally , ( a3)(d ) follows from @xmath871 .",
    "the notion of weak solution is introduced through conservation of energy .",
    "[ def : definitionoffarfieldrefractorkappa<1 ] a far field refractor @xmath675 is a weak solution of the far field refractor problem for the case @xmath18 with emitting illumination intensity @xmath8 on @xmath566 and prescribed refracted illumination intensity @xmath10 on @xmath545 if for any borel set @xmath676 @xmath872    we are now ready to apply theorem [ thm : abstractcasediscritecase ] to solve the far field refractor problem when the measure @xmath10 is a linear combination of deltas .",
    "[ thm : existencesumofdiracmassesfarfield ] let @xmath873 be distinct points in @xmath831 , @xmath679 are positive numbers , @xmath680 such that @xmath874 for @xmath9 , @xmath146 , and @xmath875 then there exist positive numbers @xmath876 such that @xmath686 with @xmath877 is a weak solution to the far field refractor problem .",
    "moreover , @xmath878 for @xmath233 .    to prove the theorem , we apply theorem [ thm : abstractcasediscritecase ] .",
    "so we only need to verify that there exists @xmath879 satisfying @xmath880 , @xmath125 . from remark [ rmk : existenceofrho0forb1close ] this follows by choosing @xmath709 close to zero .",
    "using the results from subsection [ subsect : convexcase ] and adapting the above arguments we can easily deal with the case @xmath19 . in this case , we assume @xmath881 , @xmath825 , and the definition of far field refractor is made with supporting semi - hyperboloids @xmath882 as in ( * ? ? ?",
    "* definition 4.1 ) . the far field refractor mapping of @xmath436 is given by ( * ? ? ?",
    "* definition 4.2 ) .",
    "the family @xmath91 is then given by @xmath883 .",
    "we have @xmath867 where the functions @xmath884 now satisfying conditions ( a1)-(a2 ) and ( a3  ) from subsection [ subsect : convexcase ] . weak solutions of the far field refractor problem for @xmath19 are defined as in definition [ def : definitionoffarfieldrefractorkappa<1 ] .",
    "applying theorem [ thm : abstractcasediscritecaseconvexcase ] , we obtain the following theorem .",
    "[ thm : existencesumofdiracmassesfarfieldkappa>1 ] let @xmath873 be distinct points in @xmath831 , @xmath679 are positive numbers , @xmath680 such that @xmath885 for @xmath9 , @xmath146 , and @xmath886 then there exist positive numbers @xmath876 such that @xmath686 with @xmath887 is a weak solution to the far field refractor problem for @xmath19 .",
    "moreover , @xmath878 for @xmath233 .",
    "we assume here that @xmath888 and @xmath889 with @xmath890 bounded convex domains in @xmath415 .",
    "we have a radon measure @xmath21 in @xmath891 given by @xmath892 with @xmath893 , @xmath614 nonnegative .",
    "the subdifferential of the function @xmath894 is given by @xmath895 we let the family @xmath896 .",
    "on @xmath91 we define the mapping @xmath64 by @xmath897 one needs to prove that @xmath898 and the map @xmath899 is continuous at each @xmath900 . to show @xmath901 , we proceed exactly as at the beginning of the proof of lemma [ measurabilityrefractormapfarfield ] .",
    "everything else follows from well known properties of the subdifferential , see @xcite .",
    "the family @xmath91 satisfies ( a1 ) and ( a2 ) , and we verify that it also satisfies ( a3  ) , all from subsection [ subsect : convexcase ] .",
    "we let @xmath902 where @xmath664 and @xmath903 . here",
    "@xmath672 and @xmath904 .",
    "we show that @xmath905 satisfies condition ( a3  ) .",
    "in fact , @xmath906 for all @xmath672 , so ( a3)(a ) holds .",
    "( a3)(b ) is trivial . since @xmath907 , where @xmath490 depends on the diameters of @xmath1 and @xmath908 , ( a3)(c ) follows .",
    "( a3)(d ) trivially holds .",
    "we are now ready to apply theorem [ thm : abstractcasediscritecaseconvexcase ] to solve the second boundary value problem for the monge - ampre equation when the measure @xmath10 is a linear combination of deltas .",
    "that is , to find a convex function @xmath900 such that @xmath901 and solving @xmath909 for each borel set @xmath910 .",
    "[ thm : existencesumofdiracmassessecondbdryma ]",
    "let @xmath911 be distinct points in @xmath831 , @xmath679 are positive numbers , @xmath680 , and @xmath912 then there exist positive numbers @xmath876 such that the convex function @xmath913 solves the second boundary value problem for the monge - ampre equation .",
    "suppose the function defining the refractor is @xmath914 and set @xmath915 .",
    "we have points @xmath916 , so we think of the region @xmath1 defined by @xmath917 and therefore we identify @xmath1 with @xmath918 .",
    "we also think of the defining function @xmath16 as a function @xmath919 with @xmath920 . for the derivation of the equation",
    "we assume that @xmath16 is @xmath921 . following the paper @xcite",
    ", we use the notation @xmath922 and @xmath923 .",
    "we also use the notation @xmath924 and let @xmath925 be the refracted direction of the ray @xmath27 by the surface @xmath624 , that is , @xmath926 where @xmath422 is the outer unit normal to the refractor at the point @xmath624 , and @xmath927 .      notice that this is compatible with hypotheses h1 and h2 if @xmath18 or h3 and h4 if @xmath19 , when @xmath1 is above or near the hyperplane @xmath929 .",
    "suppose the surface refracts off the ray with direction @xmath27 into the point @xmath930 .",
    "then @xmath931 we denote by @xmath932 the map @xmath933 and we regard it defined in @xmath918 , that is , @xmath934 , where @xmath3 is the target screen . since @xmath935 , we have that @xmath936 , and the jacobian of @xmath932 is then the matrix @xmath937 , @xmath938 . if @xmath939 and @xmath940 denote the surface area elements in @xmath1 and in @xmath3 , respectively , then @xmath941 .",
    "noticing that @xmath942 , and since @xmath614 and @xmath473 are the energy distributions in @xmath1 and @xmath3 , respectively , we obtain the equation @xmath943 we now find the explicit form of @xmath944 which will yield the pde satisfied by @xmath16 .    from ( * ? ? ?",
    "* formula ( 2.15 ) ) we have the following expression for the outer normal ( the change in the sign is due to the direction of the normal ) : @xmath945 and so @xmath946 we now calculate @xmath947 . since @xmath928 , we have @xmath948 and so @xmath949 .",
    "also @xmath950 so @xmath951 from we then have @xmath952 therefore @xmath953 where @xmath954 with @xmath955 .",
    "it is convenient to use the notation @xmath956 so @xmath957 for @xmath958 and @xmath959 . differentiating this with respect to @xmath960 we get @xmath961",
    "if @xmath962 are row vectors in @xmath963 , the tensor product is the @xmath964 matrix defined by @xmath965 with the multiplication of matrices .",
    "then the jacobian matrix @xmath966 can be written as @xmath967 if @xmath968 are row vectors and @xmath969 is an @xmath964 matrix , then @xmath970 , and we then obtain the formula @xmath971 we have from the sherman - morrison formula that if @xmath972 , with @xmath973 and @xmath974 row vectors , then , @xmath975 therefore , if @xmath976 then @xmath977 hence @xmath978 and so @xmath979 we have @xmath980 .",
    "therefore @xmath981 since @xmath982 , from the form of @xmath983 and @xmath984 we have that @xmath985.\\ ] ] combining this with , we obtain that @xmath16 satisfy the following pde of monge - ampre type : @xmath986 where @xmath987.\\ ] ]      we assume the target domain @xmath3 is contained in a hypersurface @xmath988 , where @xmath989 is @xmath990 and @xmath991 .",
    "we recall that we assume the configuration given by either ( h1 ) and ( h2 ) , if @xmath18 , or ( h3 ) and ( h4 ) , if @xmath19 . in order to find the pde in the general case we will use the calculations from subsection [ subsec : pdewhendiscontainedinahyperplane ] .    given the direction @xmath9 , the point @xmath624 is refracted with direction @xmath288 into the point @xmath930 .",
    "the normal at @xmath992 is given by @xmath993 and so the map @xmath994 has jacobian matrix @xmath995 satisfying @xmath996.\\ ] ] we have @xmath997 and @xmath998 , so differentiating with respect to @xmath960 we get @xmath999 and so @xmath1000 inserting these into @xmath1001 yields @xmath1002.\\ ] ] for @xmath930 , @xmath9 , with @xmath1003 , let @xmath1004 , and let @xmath740 be the line with direction @xmath288 passing through the point @xmath624 .",
    "let @xmath168 be the intersection point between @xmath740 and the hyperplane @xmath929 .",
    "we write @xmath1005 the existence of @xmath168 follows from ( h1 ) and ( h2 ) if @xmath1006 and @xmath1007 . indeed",
    ", we notice that @xmath740 does not intersect @xmath929 if and only if @xmath740 is perpendicular to @xmath1008 , or equivalently the vector @xmath288 is perpendicular to @xmath1008 . from ( h1 ) , @xmath1009 is contained in the solid cone with axis @xmath1008 with opening @xmath1010 for @xmath930 , i.e. @xmath1011 . on the other hand , since the refractor is contained in @xmath768 , we have @xmath1012 now from ( h2 ) @xmath1013 so @xmath1014 . therefore @xmath1015 thus , if @xmath1007 , then @xmath1016 , and so the vector @xmath288 lies in a cone with axis @xmath1008 that does not intersect the plane @xmath929 which proves the existence of @xmath168 .",
    "similarly , if @xmath19 , then the existence of @xmath168 also follows from ( h3 ) and ( h4 ) assuming again @xmath1006 and that @xmath547 is sufficiently small .",
    "a calculation as in the case when @xmath935 yields that @xmath1017 if we write @xmath1018 then @xmath1019 and making the dot product of this equation with @xmath1008 we obtain that @xmath1020 where @xmath1021 . in view of",
    ", we only need to calculate @xmath1022 for @xmath938 .",
    "set @xmath1023 and @xmath1024 , we get @xmath1025 this equation written in matrix form is @xmath1026 we calculate @xmath1027 .",
    "differentiating the equation @xmath1028 with respect to @xmath960 , @xmath1029 , we get @xmath1030 since @xmath1031 .",
    "so we have the formula for the vector @xmath1032 @xmath1033 where @xmath1034 , and we used the notation @xmath1035 .",
    "for simplicity in the calculation let @xmath1036 .",
    "so from @xmath1037 and from @xmath1038 so inserting into and using the formula @xmath1039 as multiplication of matrices . ] , we obtain @xmath1040 letting @xmath1041 , from we get @xmath1042 since @xmath1043 , it follows that @xmath1044 therefore @xmath1045 we have @xmath1046 consequently @xmath1047",
    "we recall from that @xmath1048 with @xmath1049 from , so @xmath1050 we have @xmath1051 and @xmath1052 .",
    "so @xmath1053 with @xmath1054 from and we then obtain that @xmath16 satisfy the pde of monge - ampre type @xmath1055              c.  e. gutirrez and qingbo huang , _ the near field refractor _ , geometric methods in pde s , conference for the 65th birthday of e. lanconelli , lecture notes of seminario interdisciplinare di matematica , vol .",
    "7 , universita  degli studi della basilicata , potenza , italy , 2008 , pp ."
  ],
  "abstract_text": [
    "<S> we present an abstract method in the setting of compact metric spaces which is applied to solve a number of problems in geometric optics . </S>",
    "<S> in particular , we solve the one source near field refraction problem . </S>",
    "<S> that is , we construct surfaces separating two homogenous media with different refractive indices that refract radiation emanating from the origin into a target domain contained in an @xmath0 dimensional hypersurface . the input and output energy are prescribed . </S>",
    "<S> this implies the existence of lenses focusing radiation in a prescribed manner . </S>"
  ]
}