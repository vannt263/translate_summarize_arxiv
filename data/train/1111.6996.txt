{
  "article_text": [
    "global error control in numerical solutions of initial - value problems is of paramount importance . in this paper",
    ", we consider the effect of global error control on the numerical solution of hamiltonian systems .",
    "we solve a test problem using the rkq algorithm , which is designed to achieve stepwise global error control .",
    "significantly , we use explicit runge - kutta methods in rkq , as opposed to implicit symplectic runge - kutta methods , which are often preferred for hamiltonian systems .",
    "if the total energy of a physical system is given in the form of the _",
    "_ hamiltonian__@xmath0where the canonical coordinates @xmath1 and @xmath2 are the momentum and position , respectively , then the evolution of the system is given by@xmath3the hamiltonian @xmath4 is a _ first integral _ of ( ham system ) , meaning that it is constant for all @xmath5 .",
    "for an appropriate set of initial values , ( [ ham system ] ) is an _ initial - value problem _ ( ivp ) .",
    "since hamiltonian systems are nonlinear , their solution is usually obtained numerically - using , for example , a _",
    "runge - kutta _",
    "( rk ) method .    for ease of presentation",
    "we consider here a two - dimensional hamiltonian , rather than the more general case@xmath6but this restriction will not affect our discussion .",
    "runge - kutta methods are very well - known , and the reader is referred to the extensive literature . for our purposes , an rk method applied to ( [ ham system ] ) has the form@xmath7 = \\left [   \\begin{array}{c } \\widetilde{q}_{i } \\\\   \\widetilde{p}_{i}% \\end{array}% \\right ] + h_{i+1}\\mathbf{f}\\left ( t_{i},\\left [   \\begin{array}{c } \\widetilde{q}_{i }",
    "\\\\   \\widetilde{p}_{i}% \\end{array}% \\right ] , h_{i+1}\\right ) .",
    "\\label{rk for ham}\\]]in ( [ rk for ham ] ) , @xmath8 denotes discrete points along the @xmath5-axis , so that @xmath9 and @xmath10 are numerical solutions at @xmath11 the stepsize @xmath12 and @xmath13 is a vector function associated to the rk method under consideration .",
    "initial values of @xmath1 and @xmath2 are specified at @xmath14    we define the local and global errors of an rk method as@xmath15 + h_{i+1}\\mathbf{f}\\left ( t_{i},\\left [   \\begin{array}{c } q_{i } \\\\   p_{i}% \\end{array}% \\right ] , h_{i+1}\\right ) \\right ) -\\left [   \\begin{array}{c } q_{i+1 } \\\\   p_{i+1}% \\end{array}% \\right]\\]]and@xmath16 \\equiv \\left [   \\begin{array}{c } \\widetilde{q}_{i+1 } \\\\   \\widetilde{p}_{i+1}% \\end{array}% \\right ] -\\left [   \\begin{array}{c } q_{i+1 } \\\\   p_{i+1}% \\end{array}% \\right ] .",
    "\\label{global error}\\]]note the use of the exact values of @xmath2 and @xmath1 in the definition of the local error .",
    "if the rk method is of order @xmath17 ( denoted rk@xmath18 , we have@xmath19and @xmath20where @xmath21 is representative of the stepsizes ( for example , @xmath21 could be taken as the average stepsize along the discretized @xmath5-axis ) .    usually , _",
    "symplectic _ rk methods are used to solve hamiltonian systems @xcite .",
    "such methods have the property that the hamiltonian arising from the numerical solution is bounded in the sense that it does not drift away from the exact value ; rather , it exhibits small oscillations in the vicinity of the exact value . also , symplectic rk methods reproduce closed orbits in the @xmath22 phase space , as expected when periodic solutions are present .",
    "the symplectic property of hamiltonian systems refers to the invariance of the differential 2-form @xmath23 a feature that is respected by symplectic rk methods ( hence their name ) . practically speaking , however , it is the first two properties listed here - essentially constant numerical hamiltonian and closed phase space trajectories - that are of primary interest .",
    "the disadvantage of symplectic rk methods is that they are _ implicit _ ( a particular characteristic of the function @xmath24 , and this requires the solution of a nonlinear system of equations at each node @xmath25 which can be computationally expensive . _",
    "explicit _ rk methods do not require the solution of such a nonlinear system , but neither are they symplectic .",
    "we will not discuss rk@xmath26q@xmath27 in detail here ; the reader is referred to our previous work where the algorithm has been discussed extensively prentice 2,@xcite .",
    "it is sufficient to state that rk@xmath26q@xmath27 uses rk@xmath17 and rk@xmath28 to control  the local error via so - called _ local extrapolation _ , while simultaneously using rk@xmath27 to keep track of the global error in the rk@xmath17 solution ( we have @xmath29 .",
    "such global error arises from the propagation of the rk@xmath28 global error in the rk@xmath17 method , as a consequence of local extrapolation .",
    "rk@xmath26q@xmath27 is designed to estimate the various components of the global error in rk@xmath17 and rk@xmath28 at each node @xmath30 and , when the global error exceeds a user - defined tolerance , a _ quenching _ procedure is carried out .",
    "this simply involves replacing the rk@xmath17 and rk@xmath28 solutions with the much more accurate rk@xmath27 solution , whenever necessary , so that the rk@xmath17 and rk@xmath28 global errors do not accumulate beyond the desired tolerance .",
    "from ( [ global error ] )  we have@xmath31this gives@xmath32where we have ignored higher - order terms .",
    "now , say @xmath33 is an upper bound on the magnitude of the global errors .",
    "hence,@xmath34we see that the bound on the error in the numerical hamiltonian is proportional to the bound @xmath35    for a point on the trajectory in phase space , we have@xmath36where @xmath37 is any norm suitable for determining distances in the phase space .",
    "hence , the bound on the trajectory error is proportional to @xmath35 for the euclidean norm and the two - dimensional case considered here , we have@xmath38    the implication of the above analysis is obvious : if we apply rk@xmath26q@xmath27 to the problem , with a suitable tolerance of @xmath39 then we would generate solutions @xmath40 and @xmath41 for which the error bounds on the numerical hamiltonian and the phase - space trajectories are acceptably small . furthermore , this can be achieved using explicit rk methods in the rk@xmath42q@xmath27 algorithm , as opposed to the more computationally intensive symplectic rk methods .",
    "as an example , we consider the hamiltonian@xmath43which yields@xmath44this is the same example considered in hairer et al @xcite .",
    "we use initial values@xmath45and we integrate over @xmath46 .$ ]    we solve the system using rk34q8 @xmath47 with a tolerance of @xmath48 on both the local and global error . for comparison , we solve the system via local extrapolation only with rk3 and rk4 , also subject to a tolerance ( on the local error ) of @xmath49 results are shown in the figures following the references .",
    "the various explicit rk methods used here are the same as those referenced in prentice 2,@xcite .",
    "we use the notation rk34 to indicate the local extrapolation algorithm using rk3 and rk4 .    in figure 1 , the top two plots show the first few periods of the solution numerical @xmath50 and @xmath51 demonstrating their periodic character .",
    "consistent with this periodicity is the closed trajectory in phase space , shown in the third plot in figure 1 .",
    "the numerical hamiltonian is shown in the fourth plot , for rk34q8 and rk34 .",
    "clearly , the latter exhibits a generally monotonic drift from the exact value of @xmath52 , while the former is essentially constant with slight oscillations . for the sake of clarity",
    "we have not shown all the data points in this plot ; there are some @xmath53 nodes on @xmath54 $ ] in the computation , and we show relatively few - sufficient , nonetheless , to exhibit the salient features of the calculation ( this also holds for subsequent plots in figures 2 - 4 ) .",
    "the drift in @xmath55 is slight - only about @xmath56 over the entire interval of integration - but it is definite . given that @xmath55 should be invariant , however , the result obtained with rk34q8 should be preferred .",
    "figure 2 shows global errors in @xmath50 and @xmath57 determined from the difference of the rk34 solution and the rk8 solution . clearly , the errors in the rk34 algorithm grow as the integration proceeds , achieving maximal values of @xmath58 on the other hand , the rk34q8 algorithm , thanks to the high - order quenching device , gives a solution that is bounded by @xmath59 as desired .",
    "this bound is indicated by the horizontal line labelled ` tolerance ' .",
    "the maximal errors in this case are @xmath60 in @xmath61 and @xmath62 in @xmath63    in figure 3 we show the trajectory error , determined using the euclidean norm , for both algorithms .",
    "clearly , the trajectory error grows for rk34 , consistent with growth of global error in the solutions seen in figure 2 . for rk34q8 ,",
    "the trajectory error is bounded by @xmath64 as expected .",
    "this bound is indicated by the horizontal line labelled ` upper bound ' .    for completeness , we show the estimated global error in the rk8 solution in figure 4 ( errors for both @xmath1 and @xmath2 are shown )",
    "this has been computed with ( see @xcite,@xcite,@xcite)@xmath65here , @xmath66 is the jacobian of the function @xmath13 in ( [ rk for ham ] ) , @xmath67 is the jacobian of@xmath68 , \\]]@xmath69 is the @xmath70 identity matrix , and we assume @xmath71 .\\]]also , we have used richardson extrapolation to estimate the local error @xmath72 in the rk8 solution @xcite , butcher . for a reasonably small stepsize ( @xmath73 in this problem ) and a high - order rk method , we expect this to be a good estimator .",
    "the largest error in either component of the rk8 solution was @xmath74 .",
    "this means that any global error in the rk8 solution would not ` contaminate ' the rk34q8 error control procedure , since the tolerance of @xmath48 is considerably larger than @xmath75 we note here that it is feasible to use a method of higher order than rk8 to estimate the global error in the rk8 solution , even though this would probably increase the computational effort . at the time of writing",
    ", however , we did not have access to such a method .",
    "nevertheless , in this regard one might consider transforming the problem into a second - order problem , making it suitable for nystrm integration , as we considered in @xcite .",
    "this would enable the use of the @xmath76 embedded nystrm pair due to dormand et al @xcite .      in this paper",
    ", we have only considered absolute error control , since the magnitude of the solution was @xmath77 if the magnitude of the solution had been much larger than unity , it would have been better to implement relative error control .",
    "we will not discuss this in detail ; a thorough account has been given in @xcite , wherein we generalized the rkq algorithm .",
    "it suffices to say that at each node , for relative error control in the problem considered here , the tolerance would have the form@xmath78where @xmath79 and @xmath80 are user - defined ( the presence of @xmath81 caters for those situations where @xmath82 and/or @xmath83 are very close to zero ) .",
    "we have explored global error control in the numerical solution of hamiltonian systems .",
    "a theoretical analysis shows that if the error in the solution is bounded , then errors in quantities such as the numerical hamiltonian and phase space trajectories are also bounded .",
    "we have considered the use of the rkq algorithm , with explicit runge - kutta methods , as our choice of numerical integrator , since rkq  is specifically designed to achieve global error control .",
    "a test problem has demonstrated the expected results .",
    "in addition to the bounding of the error in the solution , we also observe an essentially constant numerical hamiltonian and a bounded error in the numerical trajectory in phase space .",
    "this contrasts hamiltonian drift and unbounded trajectory deviation normally associated with the use of explicit runge - kutta methods in solving hamiltonian systems .",
    "it is our contention that , even though rkq utilizes explicit runge - kutta methods , stepwise global error control via rkq leads to results with a similar quality to those that would be obtained using symplectic methods .",
    "prentice , j.s.c .",
    "stepwise global error control in an explicit runge - kutta method using local extrapolation with high - order selective quenching , _ journal of mathematics research , _ 3 , 2 , 126 - 136 .",
    "[ http://ccsenet.org/journal/index.php/jmr/article/view/8700/7481 ]    prentice , j.s.c .",
    "relative global error control in the rkq algorithm for systems of ordinary differential equations , _ journal of mathematics research , _ 3 , 4 , 59 - 66 .",
    "[ http://ccsenet.org/journal/index.php/jmr/article/view/10491/8952 ]"
  ],
  "abstract_text": [
    "<S> we study the effect of global error control in the numerical solution of hamiltonian systems . in particular , we apply the rkq algorithm in the numerical solution of a hamiltonian system . </S>",
    "<S> this algorithm is designed to provide stepwise control of both local and global error . </S>",
    "<S> a test problem demonstrates the error control features of rkq . </S>",
    "<S> good results are obtained , despite the fact that explicit runge - kutta methods have been used in rkq , rather than symplectic runge - kutta methods . </S>",
    "<S> this simply emphasizes the value of stepwise global error control , as per the rkq algorithm . </S>"
  ]
}