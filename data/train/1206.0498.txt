{
  "article_text": [
    "elastic scattering is important in various experimental domains , such as material analysis applications , medical diagnostics and imaging @xcite ; more in general , elastic interactions contribute to the determination of photon mass attenuation coefficients , which are widely used parameters in medical physics and radiation protection @xcite . in the energy range between approximately 1  kev and few mev , which is the object of this paper , the resolution of modern detectors , high intensity synchrotron radiation sources and , in recent years",
    ", the availability of resources for large scale numerical computations have concurred to build a wide body of knowledge on photon elastic scattering .",
    "extensive reviews of photon elastic scattering , that cover both its theoretical and experimental aspects , can be found in the literature ( e.g. @xcite ) .",
    "this paper addresses this topic under a pragmatic perspective : its simulation in general purpose monte carlo codes for particle transport .",
    "photon interactions with matter , both elastic and inelastic , play a critical role in these systems ; their modeling presents some peculiarities , because the software must satisfy concurrent requirements of physical accuracy and computational performance .",
    "photon - atom elastic scattering encompasses various interactions , but rayleigh scattering , i.e. scattering from bound electrons , is the dominant contribution in the low energy rgime and , as energy increases , remains dominant in a progressively smaller angular range of forward scattering .",
    "rayleigh scattering models are implemented in all general - purpose monte carlo systems ; comparison studies have highlighted discrepancies among some of them @xcite , nevertheless a comprehensive , quantitative appraisal of their validity is not yet documented in the literature .",
    "it is worthwhile to note that the validation of simulation models implies their comparison with experimental measurements @xcite ; comparisons with tabulations of theoretical calculations or analytical parameterizations , such as those that are reported in @xcite as validation of geant4 @xcite photon cross sections , do not constitute a validation of the simulation software .",
    "this paper evaluates the models adopted by general - purpose monte carlo systems and other modeling approaches not yet implemented in these codes , to identify the state - of - the - art in the simulation of photon elastic scattering .",
    "computational performance imposes constraints on the complexity of physics calculations to be performed in the course of simulation : hence the analysis is limited to theoretical models for which tabulations of pre - calculated values are available , or that are expressed by means of simple analytical formulations . to be relevant for general purpose monte carlo systems",
    ", tabulated data should cover the whole periodic table of elements and an extended energy range .",
    "the accuracy of elastic scattering simulation models is quantified with statistical methods comparing them with a wide collection of experimental data retrieved from the literature ; the evaluation of physics capabilities is complemented by the estimate of their computational performance .",
    "these results provide guidance for the selection of physics models in simulation applications in response to the requirements of physics accuracy and computational speed pertinent to different experimental scenarios .",
    "special emphasis is devoted to the validation and possible improvement of photon elastic scattering modeling in geant4 ; nevertheless , the results documented in this paper can be of more general interest also for other monte carlo systems .",
    "photon - atom elastic scattering has been the object of theoretical and experimental interest for several decades ; only a brief overview is summarized here to facilitate the comprehension of the software developments and simulation validation results documented in this paper .",
    "conventionally , photon - atom interactions are classified into elastic and inelastic processes , depending on whether the photon energy changes in the center of mass frame : although commonly applied in atomic physics practice and monte carlo transport , this distinction is somewhat arbitrary , since qed ( quantum electrodynamics ) radiative corrections and target recoil actually make all processes inelastic and , on the experimental side , the classification of a process as elastic or inelastic is limited by source bandwidth and detector resolution .    the physics models considered in this study concern isolated photon - atom scattering : they neglect the effects of the environment of the target atom and multi - photon effects associated with incident beams",
    ". they do not take into account either any internal degrees of freedom of the initial or final atom , such as its orientation ; therefore they do not describe x - ray scattering from electrons in molecules and oriented solids .",
    "this scenario is consistent with the assumptions of general - purpose monte carlo systems for particle transport , where particles are assumed to interact with free atoms of the medium .",
    "elastic photon - atom scattering encompasses various types of interactions , which are usually distinguished as :    * rayleigh scattering , for scattering from the atomic electrons , * nuclear thomson scattering , for scattering from the nucleus considered as a point charge , * delbrck scattering , for scattering from the field of the nucleus , * nuclear resonance scattering , for scattering from the internal structure of the nucleus .",
    "these amplitudes are coherent , i.e. not physically distinguishable ; the total elastic amplitude is commonly calculated as the sum of these separate amplitudes .",
    "there are still unresolved questions about the additivity of the amplitudes from composite systems , due to the complex interplay in a composite system between partitioning the total amplitude and the reduction from a many - body photon - atom interaction to an effective single particle formalism @xcite ; open issues concern the effects of electron correlations and of the finite lifetimes of atomic excited states @xcite .",
    "rayleigh scattering calculations are commonly performed by means of an approximation , that describes the scattering amplitude in terms of the form factor , which represents the fourier transform of the charge density of the atom .",
    "this can be simply understood considering the two thomson amplitudes from a free ( point - like ) particle @xcite : @xmath0 leading to a differential cross section @xmath1 which , for coherent scattering , is modified in presence of a charge distribution in @xmath2 where @xmath3 represents the cross section , @xmath4 is the solid angle , @xmath5 is the classical electron radius , @xmath6 is the scattering angle , @xmath7 is the atomic form factor as a function of momentum transfer @xmath8 and atomic number z of the target atom .",
    "this approximation is valid for photon energies much greater than electron binding energies and for non - relativistic momentum transfers , which in this case is meant as @xmath9 , where @xmath10 is the reduced planck constant , @xmath11 is the electron mass and @xmath12 is the speed of light . in the so - called `` modified form factor '' approximation each subshell charge density is multiplied by a different factor .    various calculations of non - relativistic ,",
    "relativistic and modified relativistic form factors are documented in the literature ; the tabulations by hubbell et al .",
    "@xcite , hubbell and verb @xcite , and schaupp et al .",
    "@xcite , respectively of non - relativistic , relativistic and modified form factors , are representative of this approach .    for forward scattering",
    "the difference between the form factor amplitude and the exact amplitude is described by two anomalous scattering factors @xcite , that take into account the persistence of binding effects even in the high energy limit of rayleigh scattering .    a more consistent approach for the description of elastic photon - atom scattering involves the evaluation of the relativistic second order s - matrix element in independent particle approximation .",
    "relativistic quantum electrodynamics , treated in lowest non - vanishing order in @xmath13 , provides the basic theoretical framework for these calculations ; neglect of higher order terms in @xmath13 in the calculation means that radiative corrections are not taken into account .",
    "the mass of the atomic nucleus is assumed to be infinite compared to the photon energy in question ; therefore only scattering from atomic electrons is considered .",
    "this many - electron state is treated in a self - consistent central field approximation , in which each electron is assumed to move in an average potential due to all atomic electrons and the nucleus .",
    "numerical evaluation of the second order s - matrix for single electron transitions in a potential was first attempted in the 1950s by brown and co - workers @xcite .",
    "this calculation scheme requires considerable computing resources , since the multipole expansion of the photon field converges slower and slower for increasing energies ; systematic evaluation of the s - matrix element has become practical relatively recently , thanks to wide availability of large scale computing facilities .",
    "extensive calculations based on the s - matrix approach ( e.g. @xcite ) have been performed by kissel , pratt and co - workers .",
    "some results of theoretical calculations of photon elastic scattering are publicly available in the form of tabulations distributed as data libraries .",
    "epdl97 @xcite ( epdl evaluated photon data library , 1997 version ) , which is part of the endf / b - vii.1 @xcite evaluated nuclear data file , includes total cross sections , form factors and anomalous scattering factors for atoms with atomic number between 1 and 100 , and for photon energies from 1  ev to 100  gev .",
    "the form factors in epdl97 are the non - relativistic ones calculated by hubbell @xcite ; the anomalous scattering factors are by cullen @xcite ; the total cross sections derive from calculations combining thomson scattering , form factors and anomalous scattering factors , which were numerically integrated .",
    "epdl97 documentation reports rough estimates and qualitative comments about the accuracy of the tabulated data , but it does not document how these estimates were produced . to the best of our knowledge",
    "systematic , quantitative validation of epdl97 coherent scattering data is not documented in the literature .",
    "epdl97 is extensively used in monte carlo simulation ; details are given in section [ sec_mc ] .",
    "the rtab @xcite database encompasses a set of tabulations of photon elastic scattering cross sections , which are the result of various methods of calculation , and of components for their calculations , such as form factors and anomalous scattering factors .",
    "the differential cross sections listed in rtab are based on :    * numerical s - matrix calculations by kissel and pratt , * relativistic form factors , * non - relativistic form factors by hubbell et al .",
    "@xcite , * modified relativistic form factors , * modified relativistic form factors with angle - independent anomalous scattering factors .    apart from the data derived from other sources , such as hubbell s form factors , all the data in the rtab database have been consistently computed in the same dirac - slater potential .",
    "the tabulations have been generated on a 97-point grid for scattering angles between 0 and 180 degrees , and on a 56-point grid for energies between 54.3 ev and 2.7541 mev ; they are listed for atomic numbers from 1 to 100 .",
    "two sets of cross sections based on s - matrix tabulations are available in rtab : one takes into account both the rayleigh and thomson scattering amplitudes , which are added coherently , and one is limited to the rayleigh scattering amplitude .",
    "in the following , `` s - matrix '' or `` sm '' identify rtab tabulations involving both amplitudes ; whenever tabulations limited to rayleigh scattering are used , they are explicitly identified in the text .",
    "comparisons of measured data with s - matrix calculations are reported in some experimental publications , which are limited to the configuration ( photon energy , scattering angle and target material ) of the experiment they describe .",
    "a systematic , quantitative validation of rtab data is not documented yet in the literature .",
    "this database has not been exploited yet in general purpose monte carlo systems .",
    "general purpose monte carlo codes for particle transport include algorithms for the simulation of rayleigh scattering , most of which are based on the form factor approximation ; they do not appear to account for other amplitudes involved in photon elastic scattering , apart from the implicit inclusion of thomson scattering in the calculation of total cross sections by the codes that use epdl97 .",
    "these codes assume that photons interact with free atoms of the medium : this assumption neglects that the molecular structure and the structure of the medium can affect coherent scattering .",
    "some codes provide users the option to directly input tabulated rayleigh scattering cross sections and form factors , which may account for molecular effects specific to a given material ; such tabulations are available for a limited number of materials ( e.g. @xcite ) .",
    "photon elastic scattering by molecules is not treated in this paper .",
    "the information summarized here concerns models implemented in monte carlo codes to describe elastic scattering by non - polarized photons ; some monte carlo systems also include algorithms for rayleigh scattering by polarized photons , which are not considered here .",
    "egs5 @xcite and egs4 @xcite calculate total rayleigh scattering cross sections from the tabulations by storm and israel @xcite , which in turn derive from the integration over angle of equation ( [ eq_dcs ] ) , where form factors by hanson @xcite were used .",
    "they sample the coherent scattering angle based on the relativistic form factors by hubbell and verb @xcite .",
    "egsnrc @xcite can use three sets of cross section data : those by storm and israel as egs4 , and the additional options of epdl97 and xcom @xcite cross sections .",
    "etran @xcite uses the cross sections of the xcom database , which are based on the relativistic form factors of hubbell and verb @xcite , and samples the change in photon direction according to the form factor approximation .",
    "fluka @xcite simulates rayleigh scattering based on epdl97 .",
    "its @xcite calculates total rayleigh scattering cross sections based on the relativistic form factors by hubbell and verb @xcite , but it samples the scattering angle based on the non - relativistic form factors by hubbell et al .",
    "@xcite .",
    "mcnp5 @xcite and mcnpx @xcite neglect rayleigh scattering when the `` simple option '' of photon transport is chosen ; otherwise they also base the simulation on the form factor approximation .",
    "they provide different options of rayleigh scattering data , the most recent of which uses epdl97 ; the other options use the older epdl89 @xcite version of epdl , data from endf / b - iv @xcite based on non - relativistic form factors by hubbell et al .",
    "@xcite , and the tabulations by storm and israel @xcite , the latter limited to a few elements with atomic number greater than 83 .",
    "nuclear resonance fluorescence , nuclear thomson scattering and delbrck scattering are not treated @xcite .",
    "penelope @xcite 2008 @xcite and 2011 @xcite versions calculate total rayleigh scattering cross sections and scattering angles based on epdl97 @xcite ; earlier versions exploited analytical approximations @xcite to hubbell s non - relativistic form factors for the calculation of differential and total cross sections . while penelope 2008 and 2011 documentation @xcite states that the total cross sections and form factors used in penelope are from epdl97 , the tabulations of these quantities distributed with the penelope code appear different from those in epdl97 : presumably , the tabulations included in penelope have been recalculated , or interpolated , over a different energy or momentum transfer grid .",
    "geant 3 @xcite handled rayleigh scattering according to empirical formulae derived from egs3 @xcite ; they consist of polynomial fits to cross sections by storm and israel , and relativistic form factors by hubbell and verb @xcite .",
    "the geant4 toolkit encompasses various implementations of rayleigh scattering .",
    "the latest versions at the time of writing this paper are geant4 9.4p03 and geant4 9.5 , both released in december 2011 ( 9.4p03 being the most recent ) .",
    "the geant4 _",
    "g4oprayleigh _ class implements a rayleigh scattering model only applicable to a particle type identified in geant4 as `` optical photon '' , which is an object of the _ g4opticalphoton _ class ; this process is not considered in the following analysis , that deals with geant4 rayleigh scattering models concerning ordinary photons , which are instances of the _ g4gamma _ class .",
    "functionality for the simulation of rayleigh scattering of ordinary photons was first introduced @xcite in the low energy electromagnetic package @xcite of geant4 0.1 version , based on total cross sections and non - relativistic form factors tabulated in the epdl97 @xcite data library ; this modeling approach is identified in geant4 9.5 as `` livermore rayleigh model '' .",
    "geant4 also includes two implementations of rayleigh scattering reengineered from the penelope @xcite monte carlo code , respectively equivalent to the rayleigh scattering algorithms in penelope 2001 @xcite and 2008 @xcite versions , the latter also based on epdl97 as the original rayleigh scattering implementation available in geant4 .",
    "the reengineered penelope 2008 code uses the tabulations of rayleigh scattering total cross sections and form factors distributed with penelope , which , as discussed above , appear different from the native epdl97 values used by the `` livermore rayleigh '' implementation .    a further rayleigh scattering simulation model , implemented in the _ g4xrayrayleighmodel _",
    "class , has been first released in geant4 9.5 version : it is defined in the software release notes as `` implementing simplified rayleigh scattering '' , but no further information could be found in geant4 documentation , nor in the literature , about the physics model underlying this implementation . from the c++ source code , the authors of this paper could evince that this model calculates the total rayleigh scattering cross section according to an analytical formula involving numerical parameters , and samples the scattering angle according to the distribution of thomson scattering from a point - like charge .",
    "an extensive set of simulation models , which are representative of the variety of theoretical approaches documented in the literature , have been evaluated to identify the state - of - the - art of photon elastic scattering in the context of monte carlo particle transport .",
    "the physics models considered in this analysis involve the implementation of simple formulae in the simulation software or exploit available tabulations of complex theoretical calculations .",
    "the models for photon elastic scattering simulation evaluated in this paper concern total and differential cross sections : in particle transport , the former are relevant to determine the occurrence of the scattering process , while the latter determine the actual outcome of the scattering by defining the angular distribution of the scattered photon at a given energy and for a given target .    all the models subject to study have been implemented in a consistent software design , compatible with the geant4 toolkit , which minimizes external dependencies to ensure the unbiased appraisal of their intrinsic capabilities .",
    "a wide set of experimental data of photon elastic scattering has been collected from the literature for this study ; simulation models are validated through comparison with these measurements .",
    "the compatibility with experiment for each model , and the differences in compatibility with experiment across the various models , are quantified by means of statistical methods .",
    "the measurements of photon elastic scattering reported in the literature mainly concern differential cross sections ; therefore the validation process is focused on this observable . due to the scarcity of total cross section measurements in the literature",
    ", the capability of the simulation models to calculate total cross sections consistent with experiment can be directly tested only over a small data sample ; nevertheless , it can be indirectly inferred for total cross sections deriving from the integration of validated differential cross sections .",
    "the validation of the physics capabilities of the simulation models is complemented by the evaluation of their computational performance .      [ cols=\"<,<,^\",options=\"header \" , ]     [ tab_interpol ]      computational performance is an important issue in assessing whether a physics model is suitable for monte carlo particle transport , and in optimizing the selection of physics models for the simulation of a given experimental scenario , when multiple options are available .",
    "the validation analysis documented in section [ sec_diffcs ] has identified the simulation model based on rtab tabulations of second order s - matrix calculations as the most accurate at reproducing experimental measurements of elastic scattering differential cross sections , i.e. at determining the actual outcome of the scattering process .",
    "nevertheless , the use of s - matrix tabulations in particle transport requires more complex operations than models based on the form factor approximation , since it implies the management of two - dimensional tabulations ( over a grid of energies and angles ) and the development of an ad hoc algorithm to sample the direction of the scattered photon , replacing the sampling algorithms that are currently established to deal with the form factor approximation .",
    "the comparative evaluation of its computational performance with respect to models based on the form factor approximation is relevant to determine whether this modeling approach , that has not yet been exploited in monte carlo codes , is practically usable in that context .    from another standpoint , less accurate models , for instance based on parameterizations or neglecting some physical features ,",
    "could be justified for inclusion in a simulation system , if they provide significantly faster computational performance than more accurate alternatives .",
    "the analysis addresses various issues related to how features specific to different photon elastic scattering modeling approaches and software algorithms affect the computational performance of the simulation .",
    "evaluations of computational performance are necessarily specific to a given monte carlo code , computing platform and test case ; the results reported here concern test cases using the geant4 toolkit , and have been obtained on an amd 2.4 ghz 2-core processor computer with scientific linux 5 operating system and the gcc 4.1.2 compiler .    from a computational perspective , one can distinguish two methods of total cross section calculation as a function of energy : either by interpolation of tabulated values , or by means of analytical formulae . in the context of geant4",
    "the former method is used by the models based on epdl97 , while the latter is used by _ g4xrayrayleighmodel _ and by the model derived from penelope 2001 .",
    "total cross sections based on s - matrix calculations are computed by interpolation of tabulations as well ; therefore , in computational terms , they do not differ from calculations currently based on epdl97 .",
    "two test cases have been evaluated as representative of the computational burden associated with either method ; they concern the average time to calculate one million total cross sections , for atomic number between 1 and 99 , and photon energy between 250 ev and 50 kev .",
    "the computation time is @xmath14  seconds for a model based on the interpolation of epdl97 , and @xmath15  seconds for the analytical algorithm implemented in _",
    "g4xrayrayleighmodel _ ; it appears independent from the photon energy .",
    "the hypothesis of equivalent computational impact of the two calculation methods is rejected 99% confidence level in this test case , i.e. the calculation of total cross sections based on the interpolation of epdl97 is significantly faster that the calculation performed by the simplified _",
    "g4xrayrayleighmodel_. however , this result should not be generalized to the computational equivalence of interpolation and analytical algorithms in absolute terms , since the relative performance of these calculation methods depends on the computational complexity of the analytically formulae and on the characteristics of the interpolation algorithms subject to test .    nevertheless , the computational impact of total cross section calculation methods on monte carlo simulation is marginal , since in general it affects the computational performance only in the initialization phase of the simulation : for instance , in geant4 atomic total cross sections are calculated at initialization in the process of building mean free path tabulations for each material present in the geometrical model of the experimental set - up , which are then used in the course of particle transport .",
    "two issues contribute to the computational performance of the actual photon scattering simulation : the calculation of the physical distribution to sample the scattering angle , and the sampling algorithm .",
    "the calculation of the distribution to sample can occur by interpolation of tabulated values or through an analytical formula .",
    "the computational performance of a set of representative methods for the generation of the elastically scattered photon has been analyzed on a test case consisting of one million primary photons with energy between 250 ev and 1 mev , which are only subject to elastic scattering as possible interaction with matter .",
    "the geant4-based application developed for this test can be configured to use any of the existing rayleigh scattering options in geant4 9.5 or the newly developed software described in this paper , namely elastic scattering based on s - matrix calculations ; it provides options for elemental targets with atomic number between 1 and 99 .    the results of this test are illustrated in fig .",
    "[ fig_time ] , which report the average time to simulate one million events as a function of photon energy for two representative test cases ( carbon and lead as targets ) ; the plotted values are scaled to the time needed to simulate one million events with 10 kev primary photons and copper as a target .",
    "the computational perfomance of physics models based on the form factor approximation appears independent from the way the sampling distribution is calculated , but is strongly affected by the efficiency of the sampling algorithm .",
    "it is comparable for the penelope 2001 and 2008 scattering implementations , which adopt the same sampling algorithm ( based on inverse transform adaptive sampling @xcite ) , but calculate the sampling distribution respectively from an analytical formula and by interpolation .",
    "it exhibits large differences for the geant4 penelope 2008 and livermore implementations , which both interpolate epdl97 tabulations , but use different sampling algorithms ( acceptance - rejection sampling for the livermore model , a form of inverse transform sampling for penelope @xcite ) .",
    "the inefficiency of the acceptance - rejection algorithm shows a strong dependence on the photon energy , which severely affects the computational performance of the elastic scattering simulation above approximately a few tens kev .    the simplified physics model implemented in _",
    "g4xrayrayleighmodel _ does not exhibit any significant computational advantage with respect to the interpolation of epdl97 with inverse transform sampling , which is available in geant4 through the reengineered penelope 2008 model .",
    "the generation of photon elastic scattering based on s - matrix calculations is approximately a factor two slower than the method based on the form factor approximation exploiting inverse transform sampling , which , among the test cases illustrated in figs .",
    "[ fig_time ] , is represented by the reengineered penelope 2008 model : the difference is due to performing interpolation over bi - dimensional tabulations rather than one - dimensional interpolation .",
    "the final state generation model based on s - matrix calculations exploits the inverse transform algorithm to sample the scattering angle , similarly to the penelope models ; thanks to its more efficient sampling algorithm , it is significantly faster than the model based on epdl97 form factors currently implemented in geant4 , which utilizes an acceptance - rejection sampling algorithm .",
    "a factor two degradation in the computational performance of photon elastic scattering simulation can be considered an acceptable compromise for most experimental applications requiring accurate simulation of photon interactions , given the superior physical performance of this model demonstrated by the validation documented in section [ sec_diffcs ] .",
    "it should be stressed that the degradation of performance discussed in this context is limited to photon elastic scattering , while in experimental practice other types of photon interactions , and of their secondary products , are usually activated in the simulation : the factor two penalty in computational performance represents an upper limit , which corresponds to applications only involving photon elastic scattering .",
    "the relative impact of photon elastic scattering on the overall computational performance can not be quantified in general terms , since it depends on many physical and user parameters specific to a given experimental scenario : some factors affecting the computational speed of a simulation are the energy of the particles involved , the materials of the experimental set - up , the physics processes and models activated in the simulation , secondary production thresholds and other user cuts , the complexity of the geometrical configuration , and the characteristics of the user application software , but this enumeration is not intended to be exhaustive .",
    "a policy class for final state generation has been developed in the context of this study , which can exploit any form factor tabulation and uses an inverse transform algorithm to sample the photon scattering angle .",
    "this class provides optimal computational performance , while it substantially improves simulation accuracy with respect to the penelope 2008 model , still in the form factor approximation , by using modified form factors with angle independent anomalous scattering factors .",
    "an extensive set of models for the simulation of photon elastic scattering has been quantitatively evaluated regarding their accuracy at reproducing experimental measurements and their computational performance .",
    "the analysis has identified the simulation of photon elastic scattering based on second order s - matrix calculations tabulated in rtab as the state - of - the - art .",
    "this model , that accounts for rayleigh scattering and nuclear thomson scattering , represents approximately a factor two improvement in compatibility with experiment with respect to the rayleigh scattering models currently available in geant4 and in other general purpose monte carlo codes .",
    "the inclusion of nuclear thomson scattering is relevant especially at higher energies and for backscattering .",
    "complementary evaluation of the computational performance has demonstrated that photon elastic scattering simulation based on s - matrix calculations is practically feasible in a general purpose monte carlo system , despite its greater computational complexity than models based on the form factor approximation currently in use .",
    "the results of the analysis hint that the accuracy of simulation based on s - matrix calculations could be further improved by optimizing the tabulation grid of rtab for more precise interpolation in areas that are sensitive to the underlying atomic structure . nevertheless , the production of an extended data library of second order s - matrix calculations would require significant computational investment and the collaboration of expert theoreticians .",
    "if one prefers to base the simulation of rayleigh scattering on the form factor approach to avoid more complex computations required by the s - matrix model , modified form factors with anomalous scattering factors ( mfasf ) appear the preferable choice among the various form factor options examined in this paper , although they result in degraded simulation accuracy with respect to the state - of - the - art model based on s - matrix calculations .",
    "the choice of the method to sample the direction of the scattered photon is critical for computational performance : inverse transform sampling is preferable to acceptance - rejection .",
    "relativistic form factors result in worse accuracy than other form factor options ( non - relativistic and modified ) ; therefore their use in simulation models is not encouraged .",
    "anomalous scattering factors calculated in the rtab theoretical environment contribute to improve the accuracy of cross sections based on modified and relativistic form factors , while the anomalous scattering factors included in epdl97 do not improve the results based on this data library .",
    "total and differential cross sections calculated by interpolation of pristine epdl97 tabulations , and by the reengineered code and reprocessed epdl97 tabulations originating from penelope 2008 produce equivalent physics results .",
    "the maintenance in geant4 of two implementations that conform to the same software design scheme and produce equivalent physics outcome appears redundant .",
    "the total cross sections calculated by the penelope 2001 model neglect the underlying atomic structure in the low energy range , and the differential cross sections exhibit significantly worse accuracy than other models based on the form factor approximation : the maintenance of the penelope 2001 model in geant4 does not appear physically justified .",
    "total cross sections calculated by xcom , storm and israel , and brennan and cowan look qualitatively similar ; they exhibit relatively limited differences with respect to cross sections based on epdl97 and on s - matrix calculations above approximately 10  kev , but they appear largely deficient at reproducing effects close to absorption edges .    the total cross sections calculated by geant4 _",
    "g4xrayrayleighmodel _ are insensitive to the atomic structure at low energies , and largely inconsistent with experimental data in the energy range of a few hundred kev .",
    "the scattering angle distribution produced by this model corresponds to thomson scattering by a point - like charge , which is an unrealistic description of photon elastic scattering .",
    "this model does not exhibit any computational advantage with respect to more accurate models currently available in geant4 .",
    "further maintenance of this model in geant4 should be seriously considered .",
    "the policy - based software design adopted in this study for the simulation of photon elastic scattering has played a key role in ensuring versatility of modeling , at the same time greatly facilitating the verification and validation process due to minimization of the dependencies of basic physics code on other parts of geant4 .",
    "this finding is relevant in view of future design evolutions of the geant4 toolkit to improve its reliability and to reduce the efforts invested for quality assurance and maintenance .",
    "the software for the simulation of photon elastic scattering developed for this study will be proposed for release in a forthcoming geant4 version , following the publication of this paper , to improve geant4 capabilities in this physics domain .",
    "the authors are grateful to lynn kissel for valuable information and advice , and to andrew buckley for proofreading the manuscript and useful comments .",
    "d. a. bradley , o. d. gonalves , and p. p. kane , `` measurements of photon - atom elastic scattering cross - sections in the photon energy range 1 kev to 4 mev '' , _ rad .",
    "125 - 150 , 1999 .",
    "t. g. trucano , l. p. swiler , t. igusa , w. l. oberkampf , and m. pilch ,  calibration , validation , and sensitivity analysis : what s what \" , _ reliab .",
    "syst . safety _ ,",
    "10 - 11 , pp .",
    "1331 - 1357 , 2006 .",
    "g. a. p. cirrone , g. cuttone , f. di rosa , l. pandola , f. romano , and q. zhang , `` validation of the geant4 electromagnetic photon cross - sections for elements and compounds '' , _ nucl .",
    "instr . meth .",
    "a _ , vol .",
    "315 - 322 , 2010 .",
    "r. h. pratt , l. kissel , and p. m. bergstrom , `` new relativistic s - matrix results for scattering beyond the usual anomalous factors / beyond impulse approximation '' , in _ resonant anomalous x - ray scattering - theory and applications _ , elsevier science , amsterdam , pp .",
    "9 - 33 , 1994",
    ".      j. h. hubbell , w. j. viegele , e. a. briggs , r. t. brown , d. t. cromer , and r. j. howerton , .",
    "`` atomic form factors , incoherent scattering functions , and photon scattering cross sections '' , _ j. phys . chem . ref . data _",
    "471 - 538 , 1975 .",
    "d. schaupp , m. schumacher , f. smend , p. rullhusen , and j. h. hubbell , `` small angle rayleigh scattering of photons at high energies : tabulation of relativistic hfs modified atomic form factors '' , _ j. phys",
    ". chem . ref . data _ , vol .",
    "467 - 508 , 1983 .",
    "l. kissel , b. zhou , s. c. roy , s. k. sen gupta , and r. h. pratt , `` the validity of form factor , modified form factor and anomalous scattering factor approximations in elastic scattering calculations '' _ acta cryst .",
    "a _ , vol .",
    "271 - 288 , 1995 .",
    "m. b. chadwick et al .",
    ", `` endf / b - vii.1 nuclear data for science and technology : cross sections , covariances , fission product yields and decay data '' , _ nucl . data",
    "sheets _ , vol .",
    "2887 - 3152 , 2011 .",
    "d. e. cullen , `` program scatman : a code designed to calculate photon coherent scattering anomalous scattering factors and cross sections '' , lawrence livermore national laboratory ucrl - id-103422 report , 1989 .",
    "g. battistoni et al . ,  the fluka code : description and benchmarking \" , _ aip conf .",
    "31 - 49 , 2007 .",
    "a.  ferrari et al .",
    ", `` fluka : a multi - particle transport code '' , report cern-2005 - 010 , infn / tc-05/11 , slac - r-773 , geneva , oct . 2005 .",
    "d. e. cullen et al . ,",
    "`` tables and graphs of photon interaction cross sections from 10 ev to 100 gev derived from the llnl evaluated photon data library ( epdl ) '' , lawrence livermore national laboratory report ucrl-50400 , vol .",
    "6 , rev . 4 , 1989 .",
    "j.  baro , j.  sempau , j. m.  fernndez - varea , and f.  salvat , `` penelope , an algorithm for monte carlo simulation of the penetration and energy loss of electrons and positrons in matter '' , _ nucl .",
    "b _ , vol . 100 , no .",
    "31 - 46 , 1995 .",
    "s. chauvie , g. depaola , v. ivanchenko , f. longo , p. nieminen and m. g. pia , `` geant4 low energy electromagnetic physics '' , in _ proc . computing in high energy and nuclear physics _ , beijing , china , pp .",
    "337 - 340 , 2001 .",
    "s. brennan and p. l. cowan , `` a suite of programs for calculating xray absorption , reflection , and diffraction performance for a variety of materials at arbitrary wavelengths '' , _ rev .",
    "_ , vol . , 63 , pp . 850 - 853 , 1992 .",
    "s. chauvie et al .",
    ", `` geant4 physics processes for microdosimetry simulation : design foundation and implementation of the first set of models '' , _ ieee trans .",
    "54 , no . 6 , pp . 2619 - 2628 , 2007 .",
    "m. augelli et al . , `` research in geant4 electromagnetic physics design , and its effects on computational performance and quality assurance '' , in _ 2009 ieee nucl .",
    "177 - 180 , 2009 .",
    "g.  basavaraju and p.  p. kane ,  elastic scattering of 1.12 mev and 1.33 mev @xmath16-rays through 90@xmath18 and 124.5@xmath18 by different elements and the real parts of the delbr``uck scattering amplitudes' , _ nucl . phys .",
    "a _ , vol .",
    "49 - 62 , 1970 .",
    "d.  a. bradley , c.  s. chong , a.  a. tajuddin , a.  shukri , and a.  m. ghose , `` small - angle coherent gamma - ray scattering at 662 kev for pb and sn '' , _ nucl .",
    "instr . meth .",
    "a _ , vol .",
    "280 , no . 2 - 3 ,",
    "207 - 211 , 1989 .",
    "d.  a. bradley , c.  s. chong , a.  a. tajuddin , a.  shukri , and a.  m. ghose , `` small - angle coherent @xmath16-ray scattering for moderate- to high - atomic - number elements '' , _ phys .",
    "a _ , vol .",
    "5974 - 5979 , 1990",
    ".    d.  a. bradley and a.  m. ghose , `` total - atom differential coherent - scattering cross - section measurements on sn and pb using moderate - energy @xmath16 rays '' , _ phys .",
    "a _ , vol .",
    "191 - 204 , 1986 .",
    "b.  k. chatterjee and s.  c. roy .",
    "`` tables of elastic scattering cross sections of photons in the energy range 50 - 1500 kev for all elements in the range 13 @xmath19 z @xmath19 104 '' , _ j. phys",
    ". chem . ref . data _ , vol .",
    "1011 - 1215 , 1998 .",
    "w.  chitwattanagorn , s.  kwaengsobha , j.  jarasrangsichol , k.  rachdawanpong , and p.  oungmanee , `` elastic scattering of @xmath20eu @xmath16 rays by various targets '' , _ nucl .",
    "instr . meth .",
    "255 , no . 1 - 2 , pp . 75 - 77 , 1987 .",
    "i.  s. elyaseery , a.  shukri , c.  s. chong , a.  a. tajuddin , and d.  a. bradley , `` measurement of forward scattering of 59.5 kev gamma rays by low to high z elements '' , _ radiat .",
    "4 - 6 , pp .",
    "365 - 367 , 1998 .",
    "i.  s. elyaseery , a.  shukri , c.  s. chong , a.  a. tajuddin , and d.  a. bradley , `` photon - atom scattering of 13.95- , 17.75- , 26.36- , and 59.54-kev photons by cu , zn , zr , nb , mo , ag , cd , in , sn , ta , and w '' , _ phys .",
    "a _ , vol .",
    "5 , pp . 3469 - 3477 , 1998 .",
    "i.  s. elyaseery , a.  shukri , c. s. chong , a. a. tajuddin , and d. a. bradley , `` total differential scattering cross - sections of 59.54 kev photons for elements in the range 29 @xmath19 z @xmath19 74 '' , _ radiat .",
    "211 - 214 , 2000 .",
    "e.  hara , j.  banaigs , p.  eberhard , and j.  goldzahl , l. abd  mey , `` diffusion lastique par le plomb et ltain des rayons @xmath16 de 1.33 mev et de 1.17 mev du @xmath21co , et de 1.12 mev du @xmath22zn '' , _ j. phys .",
    "668 - 673 , 1958 .",
    "o.  ielli and s.  erzeneo@xmath23lu , `` coherent scattering of 59.5 kev @xmath16-rays by @xmath24au through angles from 45@xmath18 to 125@xmath18 '' , _ spectrochim .",
    "331 - 335 , 2001 .",
    "p.  p. kane , g.  basavaraju , s.  m. lad , k.  m. varier , l.  kissel , and r.  h. pratt , `` inelastic and anomalous elastic scattering of 88.03-kev @xmath16 rays '' , _ phys .",
    "a _ , vol .",
    "5626 - 5631 , 1987 .",
    "p.  p. kane , g.  basavaraju , j.  mahajani , and a.  k. priyadarsini , `` elastic and compton scattering of 1.17 and 1.33 mev gamma rays through small angles '' , _ nucl .",
    "467 - 474 , 1978 .",
    "p.  p. kane , j.  mahajani , g.  basavaraju , and a.  k. priyadarsini , `` scattering of 1.1732- and 1.3325-mev gamma rays through small angles by carbon , aluminum , copper , tin , and lead '' , _ phys .",
    "a _ , vol .",
    "1509 - 1516 , 1983 .",
    "b.  kasten , d.  schaupp , p.  rullhusen , f.  smend , m.  schumacher , and l.  kissel , ",
    "coulomb correction effect in delbr``uck scattering and atomic rayleigh scattering of 1 - 4 mev photons' , _ phys .",
    "c _ , vol .",
    "5 , pp . 1606 - 1615 , 1986 .",
    "a.  kumar , j.  shahi , d.  mehta , and n.  singh , `` differential cross - section measurements for elastic scattering of 22.1 kev photons by elements with 6 @xmath19 z @xmath19 81 '' , _ nucl .",
    "b _ , vol . 194 , no .",
    "2 , pp . 105 - 111 , 2002 .",
    "a.  kumar , j.  s. shahi , m.  l. garg , s.  puri , d.  mehta , and n.  singh , `` large - angle elastic scattering of 88.03 kev photons by elements with 30@xmath25 z @xmath25 92 '' , _ nucl .",
    "b _ , vol .",
    "183 , no . 3 - 4 ,",
    "178 - 188 , 2001 .",
    "s.  kumar , v.  sharma , j.  s. shahi , d.  mehta , and n.  singh , `` elastic scattering of 59.54-kev @xmath16-rays in elements with @xmath26 at momentum transfer @xmath27 @xmath28 '' , _ eur .",
    "23 - 33 , 2009 .",
    "a.  c. mandal , d.  mitra , m.  sarkar , and d.  bhattacharya , `` differential elastic scattering cross sections of 22.1 kev x ray by elements in the range @xmath30 '' , _ phys . rev .",
    "a _ , vol .",
    "4 , pp . 042705 , 2002 .",
    "s.  s. nandi , s.  k. ghose , s.  k.  sen gupta , and n.  chaudhuri , `` study of anomalous dispersion in elastic scattering of 59.5 kev photons at k - absorption edges of target atoms '' , _ j. phys .",
    "b _ , vol . 22 , no . 8 , pp .",
    "1175 - 1182 , 1989 .",
    "n.  g. nayak , k.  m. balakrishna , and k.  siddappa , `` experimental study on coherent scattering of 145.4 and 279.2 kev gamma rays by medium and heavy elements '' , _ j. phys .",
    "b _ , vol .",
    "4117 - 4127 , 1993 .",
    "s.  puri , b.  chand , d.  mehta , m.  l. garg , n.  singh , and p.  n. trehan , `` differential cross section measurements for the elastic scattering of 59.5 kev photons by elements in the atomic region @xmath31 '' , _ nucl .",
    "b _ , vol . 111 , no . 3 - 4 ,",
    "pp . 209 - 214 , 1996 .",
    "d.  v. rao , `` measurements of whole - atom coherent and incoherent scattering cross - sections in some rare earth elements at low photon energies '' , _ appl .",
    "855 - 859 , 1991 .",
    "d.  v. rao , r.  cesareo , a.  brunetti , and g.  e. gigante , `` influence of solid state environment effects on measured elastic scattering cross sections in the x - ray regime and the associated anomalous dispersion '' , _ phys .",
    "1 , pp . 81 - 87 , 2000 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` coherent and incoherent scattering of 14.93 , 17.44 and 21.12 kev photons from al , cu , sr , cd , ce , pr , sm , pt , au and pb '' , _ phys .",
    "314 - 320 , 1994 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` rayleigh and compton scattering cross sections for low , medium and high z elements in the energy region 23.18 @xmath19 e @xmath19 30.85 kev '' , _ phys .",
    "362 - 367 , 1996 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` elastic and compton scattering of x - ray photons from platinum in the momentum transfer region 1.3175 @xmath10 @xmath32 @xmath28 '' , _ phys .",
    "305 - 309 , 1997 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` elastic scattering and the associated anomalous dispersion in the vicinity of cd , in , sn and sb , k - absorption edges '' , _ appl .",
    "48 , no . 6 , pp .",
    "789 - 806 , 1997 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` a new method to estimate elastic scattering cross sections in the x - ray region and the associated anomalous dispersion '' , _ appl .",
    "49 , no . 7 , pp .",
    "835 - 844 , 1998 .",
    "d.  v. rao , r.  cesareo , and g.  e. gigante , `` elastic scattering and the associated anomalous dispersion in the energy range 8.63 @xmath19 e @xmath19 42.75 kev from heavy atoms '' , _ x - ray spectrom .",
    "27 , no . 6 , pp .",
    "381 - 389 , 1998 .      d.  v. rao , g.  e. gigante , and r.  cesareo , `` coherent and incoherent scattering of 42.75 and 47.24 kev x - ray photons scattered from al , cu , y , mo , au and pb '' , _ x - ray spectrom . _ ,",
    "172 - 176 , 1995 .",
    "s.  k. sen  gupta , n.  c. paul , bose j. , g.  c. goswami , das  s. c. , and n.  chaudhuri , `` atomic rayleigh scattering of phonons in the vicinity of k - absorption edges '' , _ j. phys .",
    "b _ , vol . 15 , no .",
    "595 - 602 , 1982 .",
    "s.  k. sen  gupta , n.  c. paul , s.  c. roy , and n.  chaudhuri , `` new measurements of coherent and incoherent photon scattering by low , medium and high z atoms '' , _ j. phys .",
    "b _ , vol . 12 , no . 7 , pp . 1211 - 1224 , 1979",
    ".    j.  s. shahi , s.  puri , d.  mehta , m.  l. garg , n.  singh , and p.  n. trehan , `` elastic scattering of 22.1 kev photons by elements in the atomic region 12 @xmath19 z @xmath19 92 '' , _ phys .",
    "a _ , vol .",
    "5 , pp . 3557 - 3565 , 1997 .",
    "j.  s. shahi , s.  puri , d.  mehta , m.  l. garg , n.  singh , and p.  n. trehan , `` large - angle elastic scattering of 59.54 kev photons by elements with 12 @xmath19 z @xmath19 92 '' , _ phys .",
    "a _ , vol .",
    "57 , no . 6 , pp . 4327 - 4334 , 1998 .",
    "k.  siddappa , n.  g. nayak , k.  m. balakrishna , and n.  lingappa , `` experimental studies on atomic form factors at 4.808-@xmath28 photon momentum transfer '' , _ phys .",
    "a _ , vol .",
    "5106 - 5110 , 1989 .",
    "shardanand and a. d. p. rao , `` absolute rayleigh scattering cross sections of gases and freons of stratospheric interest in the visible and ultraviolet regions '' , nasa technical note tn d-8442 , washington dc , 1977 .              d. w. o. heddle , r. e. jennings and a. s. l. parsons , `` determination of the refractive indices of gases in the vacuum ultraviolet . i. the cerenkov radiation method '' ,",
    "840 - 846 , 1963 .",
    "g. i. chashchina , v. c. gladushchak and e. y. shreider , `` determination of the refractive index of argon and the oscillator strength of its resonance lines '' , _ opt .",
    "542 - 543,1968 .",
    "m. han , c. h. kim , l. moneta , m.g .",
    "pia , h. seo , `` physics data management tools : computational evolutions and benchmarks '' in _ proc .",
    ". conf . on supercomputing nucl .",
    "appl . and monte carlo _ , p. 10269",
    ", 2010 .",
    "m. han , m. g. pia , h. seo , l. moneta , and c. h. kim , `` physics data management tools for monte carlo transport : computational evolutions and benchmarks '' , in _ ieee nucl .",
    "95 - 101 , 2010 ."
  ],
  "abstract_text": [
    "<S> several models for the simulation of photon elastic scattering are quantitatively evaluated with respect to a large collection of experimental data retrieved from the literature . </S>",
    "<S> they include models based on the form factor approximation , on s - matrix calculations and on analytical parameterizations ; they exploit publicly available data libraries and tabulations of theoretical calculations . </S>",
    "<S> some of these models are currently implemented in general purpose monte carlo systems ; some have been implemented and evaluated for the first time in this paper for possible use in monte carlo particle transport . </S>",
    "<S> the analysis mainly concerns the energy range between 5 kev and a few mev . </S>",
    "<S> the validation process identifies the newly implemented model based on second order s - matrix calculations as the one best reproducing experimental measurements . </S>",
    "<S> the validation results show that , along with rayleigh scattering , additional processes , not yet implemented in geant4 nor in other major monte carlo systems , should be taken into account to realistically describe photon elastic scattering with matter above 1 mev . </S>",
    "<S> evaluations of the computational performance of the various simulation algorithms are reported along with the analysis of their physics capabilities .    </S>",
    "<S> monte carlo , simulation , geant4 , x - rays </S>"
  ]
}