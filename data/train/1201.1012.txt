{
  "article_text": [
    "the fisher information matrix ( fm , @xcite ) is a statistical instrument of paramount importance in parameter estimation problems .",
    "its function is to _ predict _ the precision with which the parameters of interest can be measured by a given experiment , starting from the expected observational uncertainties on the data .",
    "the utility of the fm comes from the fact that it can be used to optimize the experimental setup , according to the desired target results , _ before _ actually collecting the data .",
    "the cramr - rao inequality @xcite states that the uncertainties predicted by the fm formalism are , in general , optimistic ; they set the upper limit for the precision that an experiment can attain .",
    "in particular , the fm method is expected to be accurate only if the probability distribution is a gaussian function of the parameters .",
    "therefore , in order to validate the fm method for a specific problem , it is necessary to compare the predictions obtained via the fm to the results obtained by using other statistical techniques that do not suffer from this limitation . in many fields of astronomy ,",
    "the uncertainties predicted by the fm have been shown to closely resemble the ones estimated by fitting the probability distribution function ( pdf ) .",
    "this is the case , for example , of cosmological parameter estimation from the cosmic microwave background ( @xcite ) , or distance measurements from baryon acoustic oscillations ( @xcite ) ; see also @xcite for a review .    in this paper",
    ", we study the applicability of the fm formalism to the problem of fitting the spectral energy distribution ( sed ) of galaxies . in this case",
    ", the planned experiment consists of acquiring multi - wavelength photometry of galaxies , the uncertainties on the projected data are the photometric errors on the flux measurements in each band ( including any systematics ) , and the parameters to be measured are the physical properties of the target galaxies , such as age , stellar mass and dust content . our objective is to demonstrate , for a variety of cases , that the uncertainties forecasted by the fm are comparable to the ones obtained by running a pdf fitting algorithm on the same simulated data , and therefore the fm predictions can be used as a guideline in survey planning .",
    "the advantage of using the fisher matrix as opposed to full pdf fitting is that the former method is much faster , allowing one to very quickly predict the expected results for many different experimental setups .",
    "the paper is organized as follows . in sec .",
    "[ seci ] we review the currently available tools for sed fitting .",
    "[ secii ] describes the relevant fisher information matrix formalism .",
    "our main results for the comparison of uncertainties obtained via the fm and mcmc sed fitting are presented in sec .",
    "[ seciii ] ; we consider several cases of galaxies observed with different signal to noise , star formation histories , dust content , and wavelength coverage . in sec .",
    "[ seciv ] we apply galfish , the fisher matrix algorithm we developed , to real data , using a catalog of several hundred galaxies at redshifts @xmath1 in the great observatories origins deep survey south ( goods - s ) field , and we compare the results to those obtained by using galmc . we provide a worked example of survey optimization in sec .",
    "[ secvi ] contains a summary of our findings and our conclusions .",
    "sed fitting is the procedure of comparing models to the observed galaxy seds ( for reviews , see and references therein ) .",
    "the unknown physical properties of the observed galaxy can be inferred from the known physical properties of the model , once the model that most closely resembles the data ( the best - fit model ) is found .",
    "the best - fit model can be located easily by using @xmath2 minimization techniques , building a grid of models and computing the @xmath2 for each model in the grid .",
    "however , the computation of the uncertainties on sed fitting parameters ( also called _ marginalization _ ) involves solving multi - dimensional integrals , and grid - based techniques are highly inefficient in performing this task . as a result",
    ", markov chain monte carlo techniques have become increasingly popular in the past few years . in mcmc",
    ", the parameter space is explored non - uniformly , sampling more frequently where the models resemble the data more closely . as a result ,",
    "the process is more cpu - efficient , and computing uncertainties amounts to performing sums at the locations sampled by the markov chain . examples of mcmc algorithms for sed fitting include . in @xcite , we presented our own mcmc fitting algorithm , galmc , which is publicly available at http://www.physics.rutgers.edu/@xmath3vacquaviva/web/galmc.html . in this paper",
    ", we use galmc to simulate and fit the data , and to compute the marginalized probability distributions for the sed fitting parameters to be compared with the fm predictions .",
    "let us assume that we are observing galaxies in _",
    "n _ photometric bands , so that the data is a vector containing _",
    "fluxes @xmath4 , each observed with photometric error @xmath5 = @xmath6 . assuming that our models depend on a set of _ m _ parameters @xmath7 , where we include in this list only the parameters we want to measure , the theoretical fluxes in the same photometric bands are denoted as @xmath8 . for the moment , we assume flat priors in the parameters @xmath9 , so that the posterior distribution coincides with the likelihood ; we return to this issue later in this section .",
    "the likelihood associated to each model is = e^- ^2 = e^ _ k = 1^n    let @xmath10 be the location of the best - fit model in the parameter space .",
    "around @xmath11 , which is a maximum of the likelihood , we can expand @xmath12 in a taylor series as :    = ( ) + _ ij ( _ i - _ i,0 ) _ _ 0 ( _ j,0 - _ j ) + .... [ eq : loglike ]    the fisher matrix @xmath13 , which enters the second term in the above equation , is defined as : f_ij = - [ eq : f ]    the following relation holds for the marginalized error on parameter @xmath14 in terms of the fisher matrix :    [ eq : sigma ] _ _ i .",
    "equation offers the most general way to compute the fisher matrix .",
    "however , in our case this formula can be simplified considerably by using the reasonable assumption that the data obey a gaussian distribution ( in other words , that the likelihood can be written as a gaussian function of the observable quantities ) . in this case , it can be shown ( @xcite ) that f_ij & = & tr [ c^-1 _ i c c^-1 _ j c + & + & c^-1 _",
    "i ^th ( ) _ j ( ^th())^t + & + & c^-1 _ j ^th ( ) _ i ( ^th())^t ] , where @xmath15 is the data covariance matrix , and @xmath16 ; the trace is computed over the length of the data vector . in our case , the photometric errors do not depend on the location of the fiducial model in parameter space , and the first term in the above equation vanishes .",
    "the fisher matrix formalism is able to describe correlations between measurements in different bands as non - diagonal terms in the covariance matrix .",
    "here we make the simplifying assumptions that they are uncorrelated , and the fisher matrix becomes simply f_ij = _ k = 1^n _ j ^th_k ( ) _ i ^th_k ( ) . as is well - known , the fisher matrix does not require the use of any data .",
    "the above formula also allows us to compare the computational advantage of using the fisher matrix to predict the uncertainties on sed fitting parameters , with respect to mcmc methods .",
    "this comparison is only valid for the specific issue of comparing estimated errors before taking the data , since the fisher matrix is not a data fitting technique and , unlike mcmc , does not allow one to find the truly best fitting model and associated uncertainties .    in both cases , almost all of the cpu time",
    "is spent running a stellar population synthesis ( sps ) code , in our case the faster version of galaxev @xcite released with galmc , to compute the theoretical model as a function of the sed fitting parameters .",
    "the first derivatives of the model with respect to each parameter can be approximated by the finite differences : _",
    "i ^th_k ( ) = ( ^th_k ( + ) - ^th_k ( - ) ) /(2 _",
    "i ) , [ eq : der ] where @xmath17 is a small increment in the direction of the @xmath18-th parameter . therefore",
    ", each derivative requires computing two theoretical models , and the fisher matrix requires a total of @xmath19 iterations , where @xmath20 is the number of sed fitting parameters .",
    "we have empirically determined in @xcite and @xcite that the necessary number of iterations for galmc to converge is , as a rough rule - of - thumb , @xmath21 , larger by a factor of @xmath22 .",
    "the purpose of this paper is to verify whether ( or under what circumstances ) the  @xmath23 \" sign in eq .",
    "becomes effectively a  @xmath24 \" sign .",
    "if the uncertainties from the fisher matrix are systematically much smaller than the ones found by the slower but more accurate parameter estimation methods which are able to reconstruct the form of the pdf , the fisher matrix can not be used as a guideline in planning experiments .",
    "furthemore , because the fisher matrix always assumes a fiducial model , it should only be used in planning experiments and it can not be a substitute for data fitting techniques such as mcmc .",
    "we expect that differences between the uncertainties obtained by fm and pdf fitting can arise from ( at least ) three different issues :    - _ a non - gaussian likelihood_. from eq .",
    ", it is clear that if the likelihood is not a gaussian function of the _ parameters _ , the truncation in the taylor series is not exact .",
    "this is different from the aforementioned assumption of a gaussian distribution of the data .",
    "the latter assumption is well justified at high s / n , while the likelihood is strictly a gaussian function of the parameters only if the model fluxes are linear functions of the parameters . for a simple star formation history ( sfh ) , this can be expected to be true for stellar mass , which is an overall normalization of the sed , but not , for example , for age or dust content .    - _ a displacement between best - fit model and fiducial model_. the fisher matrix is computed at some fiducial parameter values , chosen to represent a typical target galaxy . however , due to the photometric error , the data will be in general scattered away from the fiducial values of the fluxes , and the best - fit model might not lie at the fiducial location in parameter space , as shown in fig . [",
    "fig : sed ] .",
    "if the shape of the posterior varies significantly with the location in parameter space , the size of the uncertainties predicted by the fm at the fiducial values may not reflect those at the location of the best - fit model ( and as a consequence , those found by pdf fitting ) . in the case of real data ,",
    "this issue can be further worsened by template incompleteness , although this is not a specific drawback of the fm formalism but rather a consequence of assuming a fiducial model .",
    "- _ the impact of priors used in pdf fitting_. in the expression for the fisher matrix , we have implicitly assumed flat priors in the parameters .",
    "while this is not in general necessary ( and , for example , using a uniform prior in @xmath25(age ) or @xmath25(mass ) is straightforward ) , it is not possible to use top - hat priors ( define a range ) in the fm formalism .",
    "this issue is relevant especially for the upper bound in age corresponding to the age of the universe .",
    "such prior can not be taken away from the mcmc run used for pdf fitting , not only because it is an important piece of knowledge that we want to incorporate in the sampling process , but also because theoretical models are only available in a limited age range . however , there are ways to simulate priors of similar effect in the fm , as explained in sec .",
    "[ sec : lm ] .    in the next sections we present the results of our careful comparison of the uncertainties predicted by fm and mcmc sed fitting , commenting on each of these issues .",
    "we conduct our analysis on different sets of reference galaxies . the assumed wavelength coverage and limiting magnitudes ( summarized in table [ table : mag ] ) are inspired by fig . 3 of @xcite , which corresponds to the  wide \" program of the candels galaxy survey @xcite , supplemented by photometry in the spitzer irac 3.6 and 4.5 @xmath26 m bands from goods @xcite",
    "therefore , the results found here represent what is achievable , using public data only , for a galaxy in goods - s .",
    "we do not include any additional calibration uncertainty .",
    "we consider 1 gyr old galaxies at different redshifts ( z = 1 , 2 , and 3 ) with high ( @xmath27 ) and low ( @xmath28 ) stellar mass .",
    "we marginalize over age , total mass m@xmath29 ( the integral of the star formation history over the age of the galaxy , which is the input of sps codes ) , and dust content parametrized by the excess color e(b - v ) . fig .",
    "[ fig : sed ] shows the simulated data ( including a scatter of width equal to the photometric error ) , the fiducial model sed , and the best - fit sed for the high - mass and low - mass reference galaxy at z = 2 , together with the filters transmission curves .    .",
    "the mock data points are obtained by adding a gaussian scatter of @xmath30 amplitude equal to the photometric error to the model fluxes ; the best - fit model comes from sed fitting using galmc .",
    "for the low - mass galaxy the displacement between the best - fit and the fiducial model is more pronounced , since the signal to noise ratio is lower and the data have less constraining power .",
    "the filter transmission curves ( multiplied by 0.001 ) are also plotted for reference . ]    for all the galaxies described below , we compute the derivatives of the sed ( convolved with the 9 filter curves ) using eq . .",
    "the derivative with respect to the total mass can also be computed analytically since the sed depends linearly on the total mass , and we verified that the derivatives obtained with the two methods agree .",
    "the step size is chosen to be 5% of the reference parameter value , with the exception of dust - free galaxies , where we used values of e(b - v ) = 0.01 and -0.01 ( which is unphysical , and only used in order to correctly evaluate double - sided derivatives ) .",
    "we checked that the step size is unimportant by choosing different values and verifying that the derivatives do not change .",
    "the mcmc analysis in galmc is conducted using a flat prior in @xmath25(age ) and @xmath25(mass ) . in the fisher matrix , we used both a flat prior in age and @xmath25(age ) , and mass and @xmath25(mass ) , finding no or very little ( at the percent level ) dependence on this choice of prior , which wo nt be further discussed .    ) .",
    "each row corresponds to a different redshift ( z = 1 , 2 , and 3 ) .",
    "the fm is computed at the fiducial value ( blue thicker line ) and at the best - fit model obtained by galmc when scatter is added to the data ( thin green line ) .",
    "the pdf from galmc is shown for simulated data without ( dashed line ) and with ( dot - dashed line ) scatter .",
    "the estimates from fm and galmc are in good agreement in all cases ; see text for more details . ]",
    "the first set of galaxies we consider are massive galaxies ( @xmath27 ) at the three reference redshifts z = 1 , 2 and 3 , characterized by constant star formation ( csf ) history and a moderate amount of dust ( e(b - v ) = 0.3 ) .",
    "we begin by simulating data with uncertainties corresponding to the magnitude limits in table [ table : mag ] , but not adding scatter to the simulated data points . in this case",
    ", we are testing the first of the  caveats \" listed in the previous section ; we expect the constraints coming from galmc to be equal to or broader than those predicted by the fm , as a result of a non - gaussian pdf which can not be captured by the fm formalism .",
    "our results are shown in fig .",
    "[ fig : dusty_mas ] .",
    "the agreement between galmc and fm is very good for z = 1 and z = 2 galaxies , the main difference being some non - gaussian tails coming from the mcmc analysis . in the case of the galaxy at z = 3 , the fm is obviously unable to capture the bi - modality of the posterior , and the fm moderately underestimates the uncertainties ( at the 20% level ) .",
    "this behavior is probably a consequence of the lower s / n ratio due to the increase in the luminosity distance at higher redshift .",
    "next , we introduce a gaussian scatter in the mock data , of amplitude equal to the photometric error on each data point , and use galmc to fit the new simulated data .",
    "this setting corresponds to what we can expect with real data .",
    "strictly speaking , the fm is expected to represent the pdf at the location of the best - fit model , so finding a difference in the width of the distribution coming from mcmc , which uses the simulated data , and the fm , which only uses the theoretical models at the fiducial value , is not in itself worrisome . however , if the pdf at the best - fit model is very different from the pdf at the fiducial model , the utility of the fm to predict uncertainties before performing an experiment is diminished , since in that case knowledge of the best - fit model is not available .    the results are also shown in fig .",
    "[ fig : dusty_mas ] .",
    "we find a good agreement ( within 20% ) between the width of the distribution obtained by galmc using the data including scatter , and the fm previously computed at the fiducial model values . to verify that the disagreement ( and in particular , the smaller width of the dust distribution reconstructed by galmc at z = 2 ) indeed comes from the displacement of the best fit model with respect to the fiducial one",
    ", we also compute the uncertainties coming from the fm method at the location of the best - fit model . in this case",
    "the uncertainties from the fm are correctly equal to or smaller than the uncertainties coming from galmc . in the subsequent analysis",
    ", we only compare the fm uncertainties evaluated at the fiducial model with the distribution obtained by galmc by fitting simulated data including scatter , since this is the relevant case for survey planning .    ) .",
    "mock data include a gaussian scatter .",
    "each row corresponds to a different redshift ( z = 1 , 2 , and 3 ) .",
    "the mcmc predictions include a top - hat prior on age . at redshift z = 1 ( first row ) , the s / n is still good enough that the prior is inessential and the fm predictions match the results of galmc , although the uncertainty in mass is underestimated by the fm by about 50% . at redshift z = 2 and z = 3 ( bottom two rows ) , the prior used in mcmc needs to be incorporated in the fm , which would otherwise overestimate the uncertainties .",
    "when the prior is taken into account , the uncertainties from the two methods are in good agreement for all parameters . ]      the next set of galaxies that we consider are similar in sfh and dust content to the ones previously discussed , but have lower stellar mass of @xmath31 , and consequently , lower signal to noise .",
    "we expect sed fitting to be more challenging in this case , since the displacement between best - fit and fiducial model will in general be larger , as illustrated in fig .",
    "[ fig : sed ] , potentially causing a sizable disagreement between the width of the pdf at the fiducial model evaluated by the fm and the width of the  real \" pdf reconstructed by galmc .",
    "the results are shown in fig .",
    "[ fig : dusty ] . at redshift z = 1 , the fm predictions are similar to the results from galmc , although the uncertainty in the mass is underestimated by the fm by about 50% .",
    "the anticipated difference between fiducial model and best - fit model causes the observed displacement of the peaks in the two curves ; however , the widths of the two distributions , which represent the size of the uncertainties , are very similar . at higher redshift",
    ", though , the fm appears to overestimate the attainable precision on all parameters . in this case , the difference is caused by the top - hat prior on age ( between a minimum value of @xmath32 yr and a maximum value of @xmath33 gyr ) used by galmc . to properly compare the two methods ,",
    "one would need to use the same prior in the fm formalism .",
    "however , it is not possible to include a flat  range \" in the fm , while it is easy to implement a gaussian prior in any parameter just by adding it to the corresponding diagonal terms of the fisher matrix . therefore , we add a broad gaussian prior of width @xmath34(age / yr ) = 1.6 when computing the fm ; we verified that the exact width of the prior ( between 1.3 and 1.75 ) is not essential .",
    "this simple addition is able to reproduce the main effect of the top - hat prior in age used by galmc , and when the prior is enforced , the uncertainties predicted by the fm or found by galmc are in good agreement . as an empirical prescription for fm calculation , we propose in general to run the fm both with and without this prior .",
    "if no dependence on the prior is found , such as , for example , for the low - mass galaxies at z = 1 , or for all the high - mass galaxies previously discussed ( not shown ) , one can be confident in the fm results .",
    "in general , this will be the case when the tails of the distribution predicted by the fm are far away from the edges of the top - hat priors set in galmc .",
    "on the contrary , if the priors set in galmc intersect the distribution predicted by the fm at high likelihood values ( near the center , rather than near the tails ) , one should keep in mind that these uncertainties might be grossly overestimated , and possibly use a gaussian prior in the fm in order to capture the main effect of the top - hat prior used by mcmc .",
    "galmc also uses a top - hat prior in e(b - v ) between 0 and 1 .",
    "while we did nt find this prior to be of importance in this case , since the posterior distribution intersects these extrema at low values of the likelihood , it might be useful in the general case to test that the fm prediction does not change significantly if a gaussian prior in e(b - v ) is used .",
    "a special case is represented by galaxies with very high ( e(b - v ) @xmath24 1 ) or very low ( e(b - v ) @xmath24 0 ) dust content , which we discuss in detail in the next subsection .    ) .",
    "mock data include a gaussian scatter .",
    "each row corresponds to a different redshift ( z = 1 , 2 , and 3 )",
    ". since dust - free galaxies have higher signal to noise in the rest - frame uv - optical than their dusty counterparts , the constraints are significantly better than those from fig .",
    "[ fig : dusty ] , and the prior on age is unimportant .",
    "the slight underestimation of uncertainties from fm ( order of 30% ) in this case might be due to the constraint e(b - v ) @xmath35 0 used by galmc , which can not be reproduced by the fm .",
    "however , this effect is mild and well within the uncertainties observed in other cases . ]",
    "dust - free galaxies present a possible challenge for the fisher matrix vs mcmc comparison , because the prior that forbids negative values of e(b - v ) , used in mcmc , can not be incorporated in the fm formalism .",
    "the latter only allows one to introduce priors centered at the fiducial model , and any gaussian prior centered at e(b - v ) = 0 and wide enough not to introduce a spurious extra weight at low - dust values does not have any effect on the shape of the fisher matrix .",
    "the effect of this difference would be an underestimation of the width of the distribution by the fm .",
    "in fact , all models with e(b - v ) @xmath36 are rejected during mcmc sampling , so that more models with non - zero amounts of dust become part of the markov chain during the random walk , making the posterior distribution ( which is proportional to the density of sampled points ) wider than it would be in absence of this constraint . while we observe this effect in our comparison in fig .",
    "[ fig : nodust ] , the difference in the distribution recovered by galmc and the one predicted by the fm is still moderate ( around 30% ) , even for these low - mass galaxies .",
    "we notice in particular that a large part of the visually striking difference in the dust distribution at z = 2 is attributable to the median value for dust being displaced from the fiducial model by about @xmath37e(b - v ) = 0.1 , while the width of the pdfs from fm and galmc is indeed similar . unlike the case of their dusty counterparts , in dust - free galaxies the rest - frame uv and optical flux is not suppressed , enabling a better determination of age and making the use of a prior in age unnecessary .    ) .",
    "mock data include a gaussian scatter .",
    "each row corresponds to a different redshift ( z = 1 , 2 , and 3 ) . for these galaxies the parameter  age \" , identified with the time from the starburst ,",
    "is 200 myr .",
    "the results obtained by the two methods are in good agreement .",
    "for the z = 3 galaxy we also show the effect of a broad gaussian prior in age ( red dashed - dotted line ) and in e(b - v ) ( green thin solid line ) .",
    "the former has a moderate impact on the prediction for age , while the latter is basically negligible .",
    "the priors have no effect for z = 1 and z = 2 galaxies , as expected ( see discussion in the text ) . ]",
    "to verify whether the star formation history has an impact on the fm vs pdf fitting comparison , we used the two methods to estimate the uncertainties on sed fitting parameters for low - mass starburst galaxies , often referred to as  simple stellar populations \" ( ssp ) . in this case",
    ", we use the terminology  age \" slightly inappropriately , since we are basically only sensitive to the time elapsed since the instantaneous burst of star formation happened . in this scenario ,",
    "the rest - frame uv and optical radiation coming from massive stars decreases rapidly with time , since these stars have shorter life spans , and these energetic photons are not replenished by ongoing star formation as in the csf case .",
    "one can not hope to recover the galaxy properties well for a burst that happened 1 gyr before observation ( , at age = 1 gyr ) .",
    "therefore , we take as reference cases galaxies where the time since the starburst is 200 myr .",
    "the results of our comparison , shown in fig . [ fig : ssp ] , confirm that the agreement between the width of the distributions predicted by the fm and computed by galmc is good ( within 20% after the prior on age is properly taken into account for the higher - redshift objects , with the exception of the dust content for the z = 2 galaxy , which is underestimated by a factor two ) . for z = 3 galaxies",
    ", we noticed that the prior at e(b - v ) = 0 used by galmc ",
    "cuts \" the fm distribution at a high likelihood value .",
    "to possibly reproduce this behavior in the fm formalism , similarly to what we did with age , we introduced an additional wide ( @xmath37e(b - v ) = 0.8 ) gaussian prior in the dust distribution , centered at the fiducial model ( e(b - v ) = 0.3 ) .",
    "we found however that the effect of such prior is negligible ( bottom - right panel of fig .",
    "[ fig : ssp ] ) .      as a final test case for our comparison , we considered low - mass galaxies for which no irac coverage is available .",
    "it is well known that the rest - frame near - infrared spectrum is a good tracer of stellar mass , so we expected that determining the galaxy mass would be extremely challenging , and we aimed to verify that the fm formalism would be able to capture this phenomenon .",
    "our results are shown in fig .",
    "[ fig : noirac ] . at redshift z = 1 , the handle offered by the near - ir yjh coverage is still able to guarantee a measurement of stellar mass within a factor of two , and the prior in age has a very moderate effect on the shape of the fm . at higher redshift",
    ", the complete lack of constraints on the sed beyond rest - frame optical wavelengths causes a dramatic increase in the uncertainties in all sed fitting parameters . in these cases , imposing a prior in age in the fm formalism , as discussed in sec .",
    "[ sec : lm ] , becomes important .",
    "after the prior has been incorporated , we find once again good agreement between the prediction of the fm and galmc s results , although , as expected , the parameters are basically unconstrained within their ranges .",
    "the comparison between the results of the fisher matrix approximation and sed fitting has so far only been applied to a set of simulated data . however ,",
    "when the mcmc algorithm is used on real data , we can expect further differences to be introduced by template incompleteness ( the fact that real galaxy spectra are more complicated than the models we used to describe them ) and by the residual effect of priors , as noticed above . to investigate this issue",
    ", we use a sample of 640 galaxies at @xmath38 with spectroscopic redshifts in the goods - s field , which are part of the catalog presented in @xcite .",
    "each sed contains twelve data points , vlt / vimos ( u band ) , hst / acs ( f435w , f606w , f775w , and f850lp bands ) , vlt / isaac ( j , h , and ks bands ) , and the four spitzer / irac channels ( 3.6 , 4.5 , 5.8 , and 8.0@xmath26 m ) .",
    "a @xmath39 flux error in the u , optical and nir bands , and a 10@xmath40 error in the irac bands is added in quadrature to the photometric error to account for calibration uncertainty and template incompleteness .",
    "reveal the heterogeneity of the sample .",
    "the redshift distribution is also shown in the rightmost panel . ]    for each of these galaxies , we use galmc to perform mcmc sed fitting and select the objects for which the chains pass all the convergence tests , and the reduced @xmath2 value is less than 10 . in fact , sed fits with very high reduced @xmath2 value indicate a strong template incompleteness problem , and the mcmc uncertainties are likely to be significantly underestimated in these cases .",
    "this procedure selects 485 objects , characterized by a broad range of physical properties ; the distribution of the mean expectation values of sed fitting parameters and the redshifts for the sample are illustrated in fig .",
    "[ fig : params ] .",
    "we proceed to compute the uncertainties on the sed fitting parameters predicted by our fisher matrix algorithm , galfish , for this set of galaxies . in each case",
    ", we use as reference spectrum ( around which the derivatives are computed ) the one of the model characterized by the mean expectation values of the parameters for that galaxy .",
    "the results of our test are shown in fig .",
    "[ fig : fmgalmc ] , which summarizes the differences between the uncertainties found by the mcmc and the ones predicted by the fm , expressed by the quantity @xmath41 for each of the parameters .",
    "( first row ) , signal - to - noise ratio in the sed ( second row ) , and star formation rate ( third row ) .",
    "we do not observe any significant correlation between these properties and the ability of galfish to match the uncertainties of the mcmc analysis.,title=\"fig : \" ]    ( first row ) , signal - to - noise ratio in the sed ( second row ) , and star formation rate ( third row ) .",
    "we do not observe any significant correlation between these properties and the ability of galfish to match the uncertainties of the mcmc analysis.,title=\"fig : \" ]    ( first row ) , signal - to - noise ratio in the sed ( second row ) , and star formation rate ( third row ) .",
    "we do not observe any significant correlation between these properties and the ability of galfish to match the uncertainties of the mcmc analysis.,title=\"fig : \" ]    in the case of age , the average value of the relative difference is 10% , meaning that if the uncertainty on age predicted by fm is 20% , the uncertainty found by mcmc would be @xmath42 .",
    "an useful way to summarize the overall behavior of the test is the fraction of objects for which the absolute value of the relative difference is less than 0.5 or less than 1.0 , which are the 68 and 91% of the sample .",
    "one possible caveat associated to this statistic is that objects for which @xmath43 would still satisfy the condition @xmath44 1.0 , despite the disagreement between the uncertainties predicted by the two methods .",
    "however , such occurrences ( which amount to about 10% of the objects that pass the test ) are much more likely to be due to mcmc underestimating the uncertainties because of template incompleteness , rather than to the failure of the fisher matrix formalism .",
    "in fact , if we alleviate the template incompleteness problem by considering only the subset of seds for which @xmath45 , these occurrences basically disappear .",
    "we also note that the median value of the relative difference is slightly negative ( - 5% ) , while one would generally expect this quantity to be positive , since the fm should give an optimistic evaluation of achievable uncertainties .",
    "however , for this test we have assumed only an extremely broad gaussian prior in age , which basically has no effect on the parameters , while the mcmc uses a top - hat prior on this quantity . therefore , this result is not problematic .",
    "the results for the uncertainties in the stellar mass are similar to those obtained for the age . in this case , the average relative difference @xmath41 is 25% , the fraction of objects for which the absolute value of the relative difference is less than 0.5 or less than 1.0 is 63 and 85@xmath40 respectively , and the median value of the relative difference is again @xmath46 .",
    "the trend is exactly equivalent to what is found for the age , as expected since there is a well - known positive correlation in the increasing age vs increasing mass direction for constant star formation .",
    "finally , the dust content parameterized by e(b - v ) is the parameter for which the fm performs best ; the average relative difference between the uncertainties found by the two methods is 10@xmath40 , the median disagreement is @xmath47 , and the fraction of objects for which the absolute value of the relative difference is less than 0.5 or less than 1.0 is 75@xmath40 and 96@xmath40 respectively .",
    "these statistics are also reported in table [ table : fmgalmc ] .",
    "we also investigate whether the capability of galfish to match the uncertainties obtained via mcmc is correlated with some properties of the target galaxies .",
    "in particular , in fig . [",
    "fig : fmgalmc ] we show the relative differences as a function of the @xmath2 of the fit , of the signal - to - noise ratio of the sed , defined as @xmath48^{0.5}$ ] , and of the star formation rate of the galaxy , but we do not observe any significant trend .",
    "further tests done on the correlations of each parameter with the difference in its own uncertainty similarly do not reveal any recognizable correlation .",
    "in this section we give a practical example of how to optimize observations using galfish .",
    "we assume that spitzer - irac observations at the depths of goods - s are available for our target galaxies ; we fix the depth of these channels to the ones described in @xcite since limited improvements in these measurements will be available in the near future .",
    "our scope is to plan hst observations in the b , v , i , and z channels on the advanced camera for surveys ( acs ) and the y , j and h channels on the wide field camera 3 ( wfc3 ) , with a total of 14 requested orbits .",
    "overhead times are not included in this total time .",
    "we require that at least five out of these seven filters must be used , that an integer number of orbits is spent in each filter , and that a maximum of six orbits are spent in one single filter ; these requirements are merely dictated by common sense and serve to limit the total number of possibilities while preserving the freedom intrinsic in this optimization problem .",
    "each optimization process is valid for a certain type of target galaxy ; in this example , we consider a low mass ( m@xmath49 @xmath50 m@xmath51 ) , 1 gyr old , moderately dusty ( e(b - v ) = 0.2 ) galaxy at @xmath52 , and we run galfish on each of the 9794 possible observational configurations . in fig . [",
    "fig : example ] , we show the predicted fractional uncertainties on age , mass and dust content , as well as their sum , which might be used as the overall quantity to minimize . when this indicator is used , the favored configuration is one where one orbit is allotted to the b , v , and i , and y filters , four orbits are spent in the z filter , six orbits are allotted to the j filter , and the h filter is not used .",
    "the resulting best - case uncertainties achievable on each parameter are @xmath37age / age = 70% or @xmath37age = 0.7 gyr , @xmath37m@xmath49/m@xmath49 = 30% or @xmath53m@xmath49 = 3@xmath54 m@xmath51 , and @xmath37e(b - v)/e(b - v ) = 30% , or @xmath37e(b - v ) = 0.06 .",
    "it is interesting to note that the configurations that lead to the lowest fractional error in each parameter are roughly the same as the ones that give the lowest sum ; in particular , the aforementioned setup is also optimal to minimize the uncertainty on age and mass , and very slightly sub - optimal ( with a difference at the percent level ) to minimize the uncertainty on e(b - v ) .    for all parameters ,",
    "we observe a ",
    "large scale \" modulation which is set by the amount of time spent in the acs b and v filters ; better results are always obtained when one and only one orbit of the total 14 is dedicated to each of these two filters .",
    "the only other constant requirement observed in the minimal - errors region is that the time spent observing with the wfc3 y filter is between one and three orbits .",
    "after these variables have been fixed , several hundred configurations generate similar predicted results ; the 50 configurations generating the lowest error for each parameter are shown in fig .",
    "[ fig : config ] .",
    "in this paper we have compared the uncertainties on sed fitting obtained by using two different methods , the fisher matrix formalism and a mcmc algorithm for pdf fitting , galmc . in the first case ,",
    "the forecasted uncertainties come from a mathematical approximation of the posterior distribution function at some fiducial value of the parameters ; no data are involved . in the second case ,",
    "the data are used to properly reconstruct the pdf by sampling the parameter space through a markov chain .",
    "the latter method is much slower but more accurate ; in particular , the width of the pdf predicted by the fm is in general predicted to be smaller than the real precision attainable on the parameters measured by data fitting techniques such as mcmc .",
    "however , if it can be verified that the uncertainties obtained via the two methods are comparable , the much faster fm becomes a very useful tool to predict the results of a certain experimental setup and to plan astronomical observations .    we have compared the pdfs predicted by the fm and fitted by galmc for several sets of reference galaxies , both on simulated data and real data .",
    "the comparison that uses simulated data is the most relevant one for the purpose of comparing the two methods in the context of planning observations , since in any case a fiducial model needs to be chosen , whether the fm or mcmc is used to compute the uncertainties on the sed fitting parameters . on the other hand ,",
    "performing the comparison on real data allows one to test whether the simplifying assumptions used in modeling the stellar populations invalidate the attempt itself to predict the achievable precision in the measurement of parameters .    in the case of simulated seds , we started by considering high - mass galaxies ( @xmath55 ) , but most of our analyses have been conducted on low - mass galaxies ( @xmath56 ) , for which more potential sources of disagreement are present as a consequence of the lower signal to noise ratio .",
    "we considered dusty and dust - free galaxies , with constant and instantaneous star formation history , with and without infrared photometric coverage , at redshifts z = 1 , z = 2 , and z = 3 .",
    "we found a remarkably good agreement between the results from the two methods .",
    "of course , the fm is not able to capture features such as non - gaussianity or multi - modality of the posterior , which mcmc can correctly explore .",
    "however , the precision in the sed fitting measurements for the two techniques are within 30% of each other ( with the fm always being an underestimate ) in the vast majority of cases , and within a factor of two in all cases .",
    "priors play an important role in the comparison , in particular for higher redshift galaxies with low s / n .",
    "mcmc uses a top - hat prior in age , ( 6 @xmath57(age / yr ) @xmath58 10.13 ) , bracketed by the minimum age for which templates are trustworthy and by the universe age .",
    "this prior needs to be incorporated in the fm at least approximately , otherwise the fm may grossly overestimate the uncertainties .",
    "we have found that if the fiducial model is far from the extremum values of the age range , a good proxy for the top - hat prior in age is a gaussian prior of width @xmath59(age / yr ) @xmath24 3.5 . as a general prescription , one can always test the predictions with or without the prior in age , but it is easy to verify that the prior only has a non - negligible effect if the prior intersects the distribution predicted by the fm at high likelihood values .",
    "we also investigated the effect of the range imposed in e(b - v ) ( between 0 and 1 in galmc ) , finding this prior to be negligible for all cases considered .",
    "we then proceeded to test the performance of the fm approximation for a set of 485 galaxies at redshifts between 0 and 5 observed in goods - s , with widely spread photometric and stellar population properties . in this case",
    ", we also found that the fm provides an acceptable approximation to the probability distributions found by galmc , with average relative differences between results of the order of @xmath60 , and significant failures ( errors differing by more than a factor of two ) in @xmath3 10% of all cases .",
    "as mentioned earlier , these difference do not necessarily arise from the failure of the fm formalism , but can come from the fact that a real galaxy sed might be more complicated than the model used for the analysis , and the fiducial model used to predict the uncertainties might be significantly different from the observed spectrum .    in this analysis , we chose to only marginalize over three sed fitting parameters : age , mass , and dust content .",
    "it is often the case that other parameters are considered in sed fitting , for example , the e - folding time @xmath61 for exponential star formation histories , the metallicity @xmath62 , or the redshift .",
    "as far as @xmath61 is concerned , we showed in @xcite that for exponential sfhs the parameters age and @xmath61 are nearly degenerate , and that different choices of prior on @xmath61 can strongly influence the results of sed fitting , even for those data , which have deeper photometry than the ones considered in this paper .",
    "therefore , @xmath61 is not a suitable parameter for fm analysis .",
    "however , an exponentially declining or decreasing sfh with @xmath63 age is effectively a starburst either at the age of the galaxy or at very recent times , and an exponentially increasing or declining sfh with @xmath64 age is well approximated by a constant sfh , so that the results found here apply to most exponential sfh models .",
    "similarly , the seds depend on metallicity in a very non - linear manner and thus the effect of @xmath62 can not be effectively captured in the fm formalism .",
    "the present analysis assumes that the metallicity of the target galaxies is known , which is a fairly common assumption made in the literature when analyzing broad - band photometry data .",
    "however , if one were to relax this hypothesis , the width of the recovered pdfs could increase .",
    "our analysis in @xcite showed that this effect is mild in the case of @xmath65 and @xmath66 lyman alpha emitters with uv , optical , nir and irac photometry , with probability distributions becoming @xmath3 10 - 20% broader , but of course this effect might be stronger for different stellar populations and data sets and this caveat should be kept in mind .    in the case of redshift , a direct comparison with galmc is not really informative , since for real data the redshift is usually determined by using photo - z algorithms .",
    "we have been so far very cautious in using galmc to determine photometric redshifts .",
    "in fact , when the pdf has multiple and widely separated peaks , even mcmc codes might fail to explore the parameter space in a way that respects the basic mcmc property that the density of visited points is proportional to the volume enclosed in the probability distribution function .",
    "as a result , the analysis presented here is strictly valid only if spectroscopic redshifts are available .",
    "however , the fm formalism is able to include redshift as one of the sed fitting parameters , at least in the particular form of a gaussian prior centered at the photometric redshift of the galaxy .",
    "if the uncertainties on the photo-@xmath67 can be expressed in this form , and an educated guess of the width of such prior is available , we can expect the uncertainties from the fm to be reliable .    in summary",
    ", we have demonstrated that the fisher matrix formalism is a valuable tool for planning photometric observations .",
    "estimates of the attainable precision on sed fitting parameters are relatively accurate ( within a factor of two at the maximum ) and can be obtained very quickly , allowing one to optimize planned surveys by simulating a variety of experimental setups . just as one example of the many applications , suppose that the scientific goal of an experiment is to achieve a certain precision in the measurement of stellar mass .",
    "the fm formalism allows one to explore what wavelength coverage and depth of observations is needed , and to understand how the aim can be achieved by minimizing costs .    in the hope that the formalism cast here is useful to the scientific community , the fisher matrix code presented and used here is publicly available as a php website at http://galfish.physics.rutgers.edu",
    "users can specify which filters they want to use from a list of many common ones , the depth of planned observations , and the characteristics of the target galaxies , and they will immediately obtain the results of the fm analysis .",
    "the fortran code used in the more complex optimization problems will also be available on request upon publication of the paper .",
    "+    we warmly thank the anonymous referee of @xcite for her / his invitation to compare the results obtained by galmc to the predictions from the fisher matrix formalism , tomas dahlen for providing us with the acs - z selected tfit catalog used in sec .",
    "v , and lucia guaita , amir hajian , and licia verde for useful comments on the manuscript draft .",
    "this material is based on work supported by the national science foundation under grants ast-0807570 and ast-1055919 .",
    "support for program number hst - go-12060.57 was provided by nasa through a grant from the space telescope science institute , which is operated by the association of universities for research in astronomy , incorporated , under nasa contract nas5 - 26555 ."
  ],
  "abstract_text": [
    "<S> the spectral energy distribution ( sed ) of a galaxy contains information on the galaxy s physical properties , and multi - wavelength observations are needed in order to measure these properties via sed fitting . in planning these surveys , </S>",
    "<S> optimization of the resources is essential . </S>",
    "<S> the fisher matrix formalism can be used to quickly determine the best possible experimental setup to achieve the desired constraints on the sed fitting parameters . however , because it relies on the assumption of a gaussian likelihood function , it is in general less accurate than other slower techniques that reconstruct the probability distribution function ( pdf ) from the direct comparison between models and data . </S>",
    "<S> we compare the uncertainties on sed fitting parameters predicted by the fisher matrix to the ones obtained using the more thorough pdf fitting techniques . </S>",
    "<S> we use both simulated spectra and real data , and consider a large variety of target galaxies differing in redshift , mass , age , star formation history , dust content , and wavelength coverage . </S>",
    "<S> we find that the uncertainties reported by the two methods agree within a factor of two in the vast majority ( @xmath0 ) of cases . if the age determination is uncertain , the top - hat prior in age used in pdf fitting to prevent each galaxy from being older than the universe needs to be incorporated in the fisher matrix , at least approximately , before the two methods can be properly compared . </S>",
    "<S> we conclude that the fisher matrix is a useful tool for astronomical survey design . </S>"
  ]
}