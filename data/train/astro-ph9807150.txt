{
  "article_text": [
    "a numerical method and corresponding computer code for the calculation of galactic cosmic - ray propagation has been developed , which is a further development of the approach described by strong & youssefi ( 1995 ) and strong ( 1996 ) .",
    "primary and secondary nucleons , primary and secondary electrons , and secondary positrons are included .",
    "the basic spatial propagation mechanisms are ( momentum - dependent ) diffusion and convection , while in momentum space energy loss and diffusive reacceleration are treated .",
    "fragmentation and energy losses are computed using realistic distributions for the interstellar gas and radiation fields .",
    "preliminary results were presented in strong & moskalenko ( 1997 ) ( hereafter @xcite ) and full results for protons , helium , positrons , and electrons in moskalenko & strong ( 1998a ) ( hereafter @xcite ) . in @xcite",
    "we referred the description of the numerical method to the present paper ( paper iii ) , and full details are now given .",
    "results for gamma - rays and synchrotron radiation will be given in moskalenko & strong ( 1998b ) ( hereafter @xcite ) .",
    "we note that our positron predictions from @xcite have been compared with more recent absolute measurements in barwick et al .",
    "( 1998 ) and the agreement is good ; for the positrons this new comparison has the advantage of being independent of the electron spectrum , unlike the positron / electron ratio which was the main focus of @xcite .",
    "the ultimate goal is to combine all constraints including gamma - ray and synchrotron spectra ; this will be pursued in @xcite .",
    "the rationale for our approach was given previously ( @xcite ) .",
    "briefly , the idea is to develop a model which simultaneously reproduces observational data of many kinds related to cosmic - ray origin and propagation : directly via measurements of nuclei , electrons , and positrons , indirectly via gamma rays and synchrotron radiation .",
    "these data provide many independent constraints on any model and our approach is able to take advantage of this since it must be consistent with all types of observation .",
    "we emphasize also the use of realistic astrophysical input ( e.g. for the gas distribution ) as well as theoretical developments ( e.g. reacceleration ) .",
    "the code is sufficiently general that new physical effects can be introduced as required .",
    "we aim for a ` standard model ' which can be improved with new astrophysical input and additional observational constraints . for interested users",
    "our model is available in the public domain on the world wide web .",
    "it was pointed out many years ago ( see @xcite ) that the interpretation of radioactive cosmic - ray nuclei is model - dependent and in particular that halo models lead to a quite different physical picture from homogeneous models .",
    "the latter show simply a rather lower average matter density than the local galactic hydrogen ( e.g. , @xcite ) , but do not lead to a meaningful estimate of the size of the confinement region , and the correponding cosmic - ray ` lifetime ' is model - dependent . in such treatments",
    "the lifetime is combined with the grammage to yield an ` average density ' .",
    "for example lukasiak et al .",
    "( 1994a ) find an ` average density ' of 0.28 @xmath5 compared to the local interstellar value of about 1 @xmath5 , indicating a @xmath6-extent of less than 1 kpc compared to the several kpc found in diffusive halo models . in the present work we use a model which includes spatial dimensions as a basic element , and",
    "so these issues are automatically addressed .",
    "the possible rle of convection was shown by jokipii ( 1976 ) , and jones ( 1979 ) pointed out its effect on the energy - dependence of the secondary / primary ratio .",
    "recent papers give estimates for the halo size and limits on convection based on existing calculations ( e.g. , @xcite ) , and in the present work we attempt to improve on these models with a more detailed treatment .",
    "previous approaches to the spatial nucleon propagation problem have been mainly analytical : jones ( 1979 ) , freedman et al .",
    "( 1980 ) , berezinskii et al . (",
    "1990 ) , webber , lee & gupta ( 1992 ) and bloemen et al .",
    "( 1993 ) treated diffusion / convection models in this way .",
    "a problem here is that energy losses are difficult to treat and in fact were apparently not included except by webber , lee & gupta ( 1992 ) , however even there not _ explicitly_. bloemen et al .",
    "( 1993 ) used the ` grammage ' formulation rather than the explicit isotope ratios , and their propagation equation implicitly assumes identical distributions of primary and secondary source functions .",
    "these papers did not attempt to fit the low - energy ( @xmath7 gev / nucleon ) @xmath0  data ( which we will show leads to problems ) and also did not consider reacceleration .",
    "it is clear than an analytical treatment quickly becomes limited as soon as more realistic models are desired , and this is the main justification for the numerical approach presented in this paper .",
    "the case of electrons and positrons is even more intractable analytically , although fairly general cases have been treated ( @xcite ) .",
    "owens & jokipii ( 1977a , b ) adopted an alternative approach with monte - carlo simulations , for both nucleons and electrons . recently porter & protheroe ( 1997 ) made use of this method for electrons . both these applications are for 1-d propagation , in the @xmath6-direction only .",
    "this method allows realistic models to be computed , but would be very time - consuming for 2- or 3-d cases .",
    "our method , using numerical solution of the propagation equation , is a practical alternative . since most of these studies were done , the data on both stable and radioactive nuclei has improved considerably and thus a re - evaluation is warranted .",
    "reacceleration has previously been handled using leaky - box calculations ( @xcite ) ; this has the advantage of allowing a full reaction network to be used ( far beyond what is possible in the present approach ) , but suffers from the usual limitations of leaky - box models , especially concerning radioactive nuclei , which were not included in these treatments .",
    "our simplified reaction network is necessary because of the added spatial dimensions , but we believe it is fully sufficient for our purpose , since we are not attempting to derive a comprehensive isotopic composition . a similar approach was followed by webber , lee & gupta ( 1992 ) .",
    "a more complex reaction scheme would not in any way change our conclusions .",
    "we model convection in a simple way , taking a linear increase of velocity with @xmath6 . detailed self - consistent models of cosmic - ray driven mhd winds ( @xcite ) provide explicit predictions for the convective transport of cosmic - rays , and our approach could be used in future to evaluate the observational consequences of such models .",
    "in this paper we concentrate on the evaluation of the @xmath0  and @xmath1ratios , evaluation of diffusion / convection and reacceleration models , and on setting limits on the halo size .",
    "the @xmath0  data is used since it is the most accurately measured ratio covering a wide energy range and having well established cross sections .",
    "the @xmath1  ratio is used rather than @xmath8 since it is less sensitive to solar modulation and to rigidity effects in the propagation .",
    "a re - evaluation of the halo size is desirable since new @xmath1  data are now available from ulysses ( @xcite ) with better statistics than previously .",
    "it is not the purpose of this approach to perform detailed source abundance calculations with a large network of reactions , which is still best done with the path - length distribution approach ( @xcite and references therein ) .",
    "instead we use just the principal progenitors and weighted cross sections based on the observed cosmic - ray abundances ( see @xcite ) .",
    "other key cosmic - ray ratios such as @xmath9 and sub-@xmath10 are beyond the scope of this paper but will be addressed in future work .    also important are cosmic - ray gradients as derived from gamma rays ; this provides a consistency check on the distribution of cosmic - ray sources , and we address this here .",
    "the models are three dimensional with cylindrical symmetry in the galaxy , and the basic coordinates are @xmath11 , where @xmath12 is galactocentric radius , @xmath6 is the distance from the galactic plane , and @xmath13 is the total particle momentum .",
    "the distance from the sun to the galactic centre is taken as 8.5 kpc . in the models the propagation region",
    "is bounded by @xmath14 , @xmath15 beyond which free escape is assumed .",
    "we take @xmath16 kpc .",
    "the range @xmath17 kpc is considered since this is suggested by previous studies of radioactive nuclei ( e.g. , @xcite ) and the distribution of synchrotron radiation ( @xcite ) . for a given @xmath18 the diffusion coefficient as a function of momentum",
    "is determined by @xmath0  for the case of no reacceleration ; if reacceleration is assumed then the reacceleration strength ( related to the alfvn speed ) is constrained by the energy - dependence of @xmath0 .",
    "the spatial diffusion coefficient for the case of no reacceleration is taken as @xmath19 below rigidity @xmath20 , @xmath21 above rigidity @xmath20 , where the factor @xmath22 ( @xmath23 ) is a natural consequence of a random - walk process .",
    "since the introduction of a sharp break in @xmath24 is an extremely contrived procedure which is adopted just to fit @xmath0  at all energies , we also consider the case @xmath25 , i.e. no break , in order to investigate the possibility of reproducing the data in a physically simpler way and did not consider convection ] .",
    "the convection velocity ( in @xmath6-direction only ) @xmath26 is assumed to increase linearly with distance from the plane ( @xmath27 for @xmath28 , @xmath29 for @xmath30 , and @xmath31 for all @xmath6 ) .",
    "this implies a constant adiabatic energy loss ; the possibility of adiabatic energy gain ( @xmath32 ) is not considered .",
    "the linear form for @xmath26 is consistent with cosmic - ray driven mhd wind models ( e.g. , @xcite ) .",
    "the velocity at @xmath33 is a model parameter , but we consider here only @xmath34 .    some stochastic reacceleration is inevitable , and it provides a natural mechanism to reproduce the energy dependence of the @xmath0  ratio without an _ ad hoc _ form for the diffusion coefficient ( @xcite ) .",
    "the spatial diffusion coefficient for the case of reacceleration assumes a kolmogorov spectrum of weak mhd turbulence so @xmath35 with @xmath36 for all rigidities .",
    "simon and heinbach ( 1995 ) showed that the kolmogorov form best reproduces the observed @xmath0  variation with energy .",
    "for the case of reacceleration the momentum - space diffusion coefficient @xmath37 is related to the spatial coefficient using the formula given by seo & ptuskin ( 1994 ) ( their equation [ 9 ] ) , and berezinskii et al .  (",
    "1990 ) @xmath38where @xmath39 characterises the level of turbulence , and is equal to the ratio of mhd wave energy density to magnetic field energy density .",
    "the main free parameter in this relation is the alfvn speed @xmath40 ; we take @xmath41 ( @xcite ) but clearly only the quantity @xmath42 is relevant .",
    "the atomic hydrogen distribution is represented by the formula @xmath43where @xmath44 is taken from gordon & burton ( 1976 ) and @xmath45 from cox , krgel & mezger ( 1986 ) giving an exponential increase in the width of the @xmath46 layer outside the solar circle :    @xmath47    the distribution of molecular hydrogen is taken from bronfman et al .",
    "( 1988 ) using @xmath48 surveys : @xmath49the adopted radial distribution of @xmath46 and @xmath50 is shown in figure  [ fig1 ] .",
    "for the ionized gas we use the two - component model of cordes et al .",
    "( 1991 ) : @xmath51the first term represents the extensive warm ionized gas and is similar to the distribution given by reynolds ( 1989 ) ; the second term represents @xmath52 regions and is concentrated around @xmath53 kpc .",
    "a temperature of @xmath54 k is assumed to compute coulomb energy losses in ionized gas .        -5pt",
    "-5pt    the @xmath55 ratio of the interstellar gas is taken as 0.11 by number ; there is some uncertainty in this quantity , but our value is consistent with recent photospheric determinations ( @xmath56 : @xcite ) .",
    "helioseismological methods ( @xcite ) give a helium abundance by mass of @xmath57 corresponding to @xmath58 , but still with possible uncertainties due to the details of the models .",
    "although the latter is perhaps the most accurate local determination , the uncertainty in extending the photospheric value to the interstellar medium over the whole galaxy is large .",
    "other uncertainties dominate the secondary production , for example the density of neutral and molecular hydrogen .",
    "in any case , even if @xmath59 the influence of the uncertainty of @xmath55 on the secondary production does not exceed 10% .",
    "the distribution of cosmic - ray sources is chosen to reproduce ( after propagation ) the cosmic - ray distribution determined by analysis of egret gamma - ray data ( @xcite ) .",
    "the form used is @xmath60where @xmath61 is a normalization constant , @xmath62 and @xmath63 are parameters ; the @xmath12-dependence has the same parameterization as that used for snr by case & bhattacharya ( 1996 ) , but we adopt different parameters in order to fit the gamma - ray gradient .",
    "we also compute models with the snr distribution , to investigate the possibility of fitting the gradient in this case .",
    "we apply a cutoff in the source distribution at @xmath64 kpc since it is unlikely that significant sources are present at such large radii .",
    "the @xmath6-dependence of @xmath65 is nominal and reflects simply the assumed confinement of sources to the disk .",
    "we assume that the source distribution of all cosmic - ray primaries is the same .",
    "meyer , drury & ellison ( 1997 ) suggest that part of the c and o originates in acceleration of c and o enriched pre - sn wolf - rayet wind material by supernovae , but the source distribution in this case would still follow that of snr .",
    "the primary propagation is computed first giving the primary distribution as a function of ( @xmath66 ) ; then the secondary source function is obtained from the gas density and cross sections , and finally the secondary propagation is computed .",
    "tertiary reactions , such as @xmath67 are treated as described in appendix  a. the entire calculation is performed with momentum as the kinematic variable , since this greatly facilitates the inclusion of reacceleration .",
    "full details of the propagation equation and numerical method used are given in appendices  a and b. the method encompasses nucleons , electrons and positrons .",
    "energy losses for nucleons by ionization and coulomb interactions are included following mannheim & schlickeiser ( 1994 ) ( see appendix  c.1 ) .",
    "details of the positron source function , magnetic field and interstellar radiation field models were given in @xcite , and the energy loss formulae for electrons are given in the present paper in appendix  c.2 .",
    "as an illustration of the calculations performed by the code , figure  [ fig2 ] shows the @xmath68 distribution of primary @xmath69 and secondary @xmath70 at 515 mev / nucleon for a reacceleration model with @xmath71 kpc . in practice we are only interested in the isotope ratios at the solar position , but it is worth noting the variations over the galaxy , which are due to effect of the inhomogeneous distribution of sources and gas on the secondary production , fragmentation and energy losses . for comparison with gamma - ray data",
    "the full 3-d distribution is of course important and will be addressed in @xcite , but here only the radial cosmic - ray gradient from gamma - rays is considered .",
    "we consider the cases of diffusion+convection and diffusion+reacceleration , since these are the minimum combinations which can reproduce the key observations . in principle",
    "all three processes could be significant , and such a general model can be considered if independent astrophysical information or models , for example for a galactic wind ( e.g. , @xcite ) , were to be used . anticipating the results , it can be noted at the outset that the reacceleration models are more satisfactory in meeting the constraints provided by the data , reproducing the @xmath0  energy dependence without _ ad hoc _ variations in the diffusion coefficient ; further it is not possible to find any _ simple _ version of the diffusion / convection model which reproduces @xmath0  satisfactorily without additional special assumptions .      -5pt      -5pt",
    "-5pt        -5pt    in our calculations we use the @xmath0  data summarized by webber et al .",
    "( 1996 ) , from heao3 and voyager 1 and 2 .",
    "the spectra were modulated to 500 mv appropriate to this data using the force - field approximation ( @xcite ) .",
    "we also show @xmath0  values from ulysses ( @xcite ) for comparison , but since this has large modulation ( 600  1080 mv ) we do not base conclusions on these values .",
    "we use the measured @xmath1  ratio from ulysses ( @xcite ) and from voyager1,2 , imp7/8 , isee3 as summarized by lukasiak et al .",
    "( 1994a ) .",
    "the source distribution adopted has @xmath72 , @xmath73 in eq .",
    "( [ 2.2 ] ) ( apart from the cases with snr source distribution ) .",
    "this form adequately reproduces the small observed gamma - ray based gradient , for all @xmath18 ; a more detailed discussion is given in section  4 .",
    "the main parameters are @xmath18 , @xmath74 , @xmath75 , @xmath76 and @xmath20 and @xmath77 .",
    "we treat @xmath18 as the main unknown quantity , and consider values 1  20 kpc .",
    "the parameters of these models are summarized in table  [ table1 ] . for a given @xmath18",
    "we show @xmath0  for a series of models with different @xmath77 .",
    "figure  [ fig3 ] shows the case of no break , @xmath78 ; for each @xmath77 , the remaining parameters @xmath74 , @xmath75 and @xmath20 are adjusted to fit the data as well as possible .",
    "it is clear that a _ good _ fit is _ not _ possible ; the basic effect of convection is to reduce the variation of @xmath0  with energy , and although this improves the fit at low energies the characteristic peaked shape of the measured @xmath0  can not be reproduced .",
    "although modulation makes the comparison with the low energy voyager data somewhat uncertain , figure  [ fig3 ] shows that the fit is unsatisfactory ; the same is true even if we use a very low modulation parameter of 300 mv in an attempt to improve the fit .",
    "this modulation is near the minimum value for the entire voyager 17 year period ( cf . the average value of 500 mv ; @xcite ) .",
    "the failure to obtain a good fit is an important conclusion since it shows that the simple inclusion of convection can not solve the problem of the low - energy falloff in @xmath0 .",
    "since the inclusion of a convective term is nevertheless of interest for independent astrophysical reasons ( galactic wind ) we can force a fit to the data by allowing a break in @xmath79 , with @xmath80 .",
    "figure  [ fig4 ] shows cases with a break : here the parameters @xmath74 , @xmath75 , @xmath76 and @xmath20 are adjusted . in the absence of convection ,",
    "the falloff in @xmath0  at low energies requires that the diffusion coefficient increases rapidly below @xmath81 gv ( @xmath82 ) reversing the trend from higher energies ( @xmath83 ) .",
    "inclusion of the convective term does not reduce the size of the _ ad hoc _ break in the diffusion coefficient , in fact it rather exacerbates the problem by requiring a larger break .        -5pt",
    "-5pt    figure  [ fig5 ] shows the predicted and measured @xmath1  ratio ; here we use the models with a break in @xmath79 since these do have the correct @xmath0  ratio in the few 100 mev / nucleon range where the @xmath84 measurements are available and are therefore appropriate for this comparison independently of the situation at higher energies . for our final evaluation",
    "we use @xmath1  data from ulysses , which has the highest statistics .",
    "figure  [ fig6 ] summarizes the limits on @xmath18 and @xmath77 , using the @xmath1  ratio at the interstellar energy of 525 mev / nucleon appropriate to the ulysses data ( @xcite ) . for @xmath85 kpc ,",
    "the predicted ratio is always too high , even for no convection ; no convection is allowed for such @xmath18 values since this increases @xmath1  still further . for @xmath86 kpc agreement with @xmath1",
    "is possible provided @xmath87 km s@xmath4 kpc@xmath4 .",
    "we conclude from figure  [ fig6]a that in the absence of convection @xmath88 , and if convection is allowed the lower limit remains but no upper limit can be set .",
    "it is interesting that an upper as well as a lower limit on @xmath18 is obtained in the case of no convection , although @xmath1  approaches asymptotically a constant value for large halo sizes and becomes insensitive to the halo dimension . from figure",
    "[ fig6]b , @xmath3 km s@xmath4 kpc@xmath4 and this figure places upper limits on the convection parameter for each halo size .",
    "these limits are rather strict , and a finite wind velocity is only allowed in any case for @xmath89 kpc .",
    "note that these results are not very sensitive to modulation since the predicted @xmath1  is fairly constant from 100 to 1000 mev / nucleon .",
    "our results can be compared with those of other studies : @xmath90 kpc ( @xcite ) , @xmath91 kpc ( @xcite ) , and @xmath92 kpc ( @xcite ) .",
    "most recently lukasiak et al .",
    "( 1994a ) found @xmath93 kpc ( for no convection ) based on voyager @xmath84 data and using the webber , lee & gupta ( 1992 ) models .",
    "we believe our new limits to be an improvement , first because of the improved @xmath84 data from ulysses , second because of our treatment of energy losses ( see section  [ diff_reacc_models ] ) and generally more realistic astrophysical details in our model .",
    "the papers cited also did not consider the low - energy @xmath0  data , which we have shown are in fact a problem for diffusion / convection models .",
    "the cosmic - ray driven wind models of zirakashvili et al .",
    "( 1996 ) have values of @xmath94 km s@xmath4 kpc@xmath4 , somewhat larger than our upper limits .",
    "since their models are different from ours in many respects this is not significant , but suggests it would be useful to carry out calculations like those in the present paper for such models to provide a critical test of their viability .",
    "ccccccc    01000 & 1 & 0.7 & 3 & 0.60 & 0.60 & 0 01010 & 1 & 0.7 & 3 & 0.60 & 0.60 & 10 01020 & 1 & 0.7 & 3 & 0.60 & 0.60 & 20 03000 & 3 & 2.0 & 3 & 0.60 & 0.60 & 0 03010 & 3 & 1.4 & 3 & 0.65 & 0.65 & 10 03020 & 3 & 1.1 & 3 & 0.70 & 0.70 & 20 10000 & 10 & 5.0 & 3 & 0.60 & 0.60 & 0 10010 & 10 & 2.5 & 3 & 0.70 & 0.70 & 10 10020 & 10 & 1.1 & 3 & 0.90 & 0.90 & 20 01100 & 1 & 0.9 & 5 & 0.60 & 0.60 & 0 01105 & 1 & 0.8 & 5 & 0.60 & 0.60 & 5 01110 & 1 & 0.8 & 5 & 0.60 & 0.60 & 10 03100 & 3 & 2.5 & 5 & 0.60 & 0.60 & 0 03105 & 3 & 2.2 & 5 & 0.60 & 0.60 & 5 03110 & 3 & 2.0 & 5 & 0.60 & 0.60 & 10 04100 & 4 & 3.5 & 5 & 0.60 & 0.60 & 0 04105 & 4 & 2.7 & 5 & 0.60 & 0.70 & 5 04110 & 4 & 2.5 & 5 & 0.60 & 0.70 & 10 05100 & 5 & 4.5 & 5 & 0.60 & 0.60 & 0 05105 & 5 & 3.2 & 5 & 0.60 & 0.70 & 5 05110 & 5 & 2.5 & 5 & 0.60 & 0.70 & 10 10100 & 10 & 7.0 & 5 & 0.60 & 0.60 & 0 10105 & 10 & 3.8 & 5 & 0.60 & 0.80 & 5 10110 & 10 & 3.0 & 5 & 0.60 & 0.80 & 10 15100 & 15 & 9.0 & 5 & 0.60 & 0.60 & 0 15105 & 15 & 3.8 & 5 & 0.60 & 0.80 & 5 15110 & 15 & 3.0 & 5 & 0.60 & 0.80 & 10 20100 & 20 & 9.0 & 5 & 0.60 & 0.60 & 0 20105 & 20 & 3.8 & 5 & 0.60 & 0.80 & 5 20110 & 20 & 3.0 & 5 & 0.60 & 0.80 & 10    cccccc    01500 & 01510 & 01511 & 1 & 1.7 & 20 02500 & 02510 & 02511 & 2 & 3.2 & 20 03500 & 03510 & 03511 & 3 & 4.6 & 20 04500 & 04510 & 04511 & 4 & 6.0 & 20 05500 & 05510 & 05511 & 5 & 7.7 & 20 10500 & 10510 & 10511 & 10 & 12 & 20 15500 & 15510 & 15511 & 15 & 15 & 20 20500 & 20510 & 20511 & 20 & 16 & 18 05501 & & & 5 & 7.7 & 0 05502 & & & 5 & 7.7 & 5 05503 & & & 5 & 7.7 & 10 05504 & & & 5 & 7.7 & 15 05505 & & & 5 & 7.7 & 20 05506 & & & 5 & 7.7 & 25 05507 & & & 5 & 7.7 & 30      the main parameters are @xmath18 , @xmath74 and @xmath40 ( @xmath20 is arbitrary since @xmath95 is constant ) .",
    "again we treat @xmath18 as the main unknown quantity .",
    "the evaluation is simpler than for convection models since the number of free parameters is smaller .",
    "the parameters of these models are summarized in table  [ table2 ] .",
    "figure  [ fig7 ] illustrates the effect on @xmath0  of varying @xmath40 , from @xmath96 ( no reacceleration ) to @xmath97 km s@xmath4 , for @xmath98 kpc .",
    "this shows how the initial form becomes modified to produce the characteristic peaked shape .",
    "reacceleration models thus lead naturally to the observed peaked form of @xmath0 , as pointed out by several previous authors ( e.g. , @xcite ) .",
    "figure  [ fig8 ] shows @xmath0  for @xmath99 kpc .",
    "our value of @xmath100 km  s@xmath4 is consistent with the value obtained by seo & ptuskin ( 1994 ) which they also derived from @xmath0 ; since for stable nuclei the leaky - box and diffusion treatments are equivalent this is a good test of the operation of our code .",
    "the value of @xmath40 is typical of the warm ionized phase of the interstellar gas ( @xcite ) .",
    "the exact low - energy form of @xmath0  depends on details of the modulation so that an exact fit here is not attempted ; note however that @xmath40 and @xmath74 can be ( and indeed were ) determined from the high - energy @xmath0  alone , and the low - energy agreement is then satisfactory 200 mev / nucleon ( cf .",
    "spectra where absolute intensity changes are important ) . ] .",
    "figure  [ fig9 ] shows @xmath1  for the same models , ( a ) as a function of energy for various @xmath18 , ( b ) as a function of @xmath18 at 525 mev / nucleon corresponding to the ulysses measurement .",
    "comparing with the ulysses data point , we conclude that @xmath101 kpc . again the result is not very sensitive to modulation since the predicted @xmath1  is fairly constant from 100 to 1000 mev / nucleon .",
    "-5pt    figure  [ fig10 ] illustrates the importance of energy losses on the @xmath1  ratio ; for reacceleration cases with @xmath99 kpc , we show the ratio with and without losses .",
    "losses attenuate the flux of stable nuclei much more than radioactive nuclei , and hence lead to an increase in @xmath1 .",
    "the effect can be simply illustrated as follows .",
    "the ionization loss rate on neutral gas is @xmath102 ev s@xmath4 , where @xmath103 is the nucleon speed , and @xmath104 is the average interstellar gas density . thus for @xmath84-nuclei of 300 mev / nucleon and for a gas disk with 0.2 kpc thickness and density 1 @xmath5 , @xmath105 @xmath5 , which gives the loss time of @xmath106 years for @xmath107 kpc .",
    "coulomb losses on the ionized gas in the halo increase the losses further ( see figure  [ fig13 ] ) ; although the density is low the wide @xmath6-extent means that the losses occur over large regions of the halo . for the same @xmath18",
    "the diffusion time is @xmath108 years so the stable @xmath109 is significantly attenuated .",
    "for the radioactive @xmath110 ( @xmath111 years ) the energy losses are negligible .",
    "hence losses significantly increase @xmath1 . as can be seen in figure  [ fig10 ] ,",
    "the relative effect is largest for large halos and becomes a dominant effect only for @xmath112 kpc .",
    "although we illustrate this for the reacceleration case , the same effect applies to diffusion / convection models .",
    "clearly if losses are ignored the predicted ratio will be too low and the derived value of @xmath18 will be too small since @xmath18 will have to be reduced to fit the observations .",
    "the proton , helium and positron spectra were presented in @xcite for the case @xmath113 kpc using the same model as used here , and the injection spectra were derived .",
    "the effect of varying the halo size is small for these spectra so we do not extend that calculation to different @xmath18 .",
    "an important constraint on any model of cosmic - ray propagation is provided by gamma - ray data which give information on the radial distribution of cosmic rays in the galaxy . for a given source distribution",
    ", a large halo will give a smaller cosmic - ray gradient .",
    "it is generally believed that supernova remnants ( snr ) are the main sources of cosmic rays ( see @xcite for a recent review ) , but unfortunately the distribution of snr is poorly known due to selection effects .",
    "nevertheless it is interesting to compare quantitatively the effects of halo size on the gradient for a plausible snr source distribution . for illustration",
    "we use the snr distribution from case & bhattacharya ( 1996 ) , which is peaked at @xmath114 kpc and has a steep falloff towards larger @xmath12 .",
    "figure  [ fig11 ] shows the effect of halo size on the resulting radial distribution of 3 gev cosmic - ray protons , for the reacceleration model . for comparison",
    "we show the cosmic - ray distribution deduced by model - fitting to egret gamma - ray data ( @xmath115 mev ) from strong & mattox ( 1996 ) , which is dominated by the @xmath116-decay component generated by gev nucleons ; the analysis by hunter et al .",
    "( 1997 ) , based on a different approach , gives a similar result .",
    "the predicted cosmic - ray distribution using the snr source function is too steep even for large halo sizes ; in fact the halo size has a relatively small effect on the distribution .",
    "other related distributions such as pulsars ( @xcite ) have an even steeper falloff . only for @xmath117 kpc",
    "does the gradient approach that observed , and in this case the combination of a large halo and a slightly less steep snr distribution could give a satisfactory fit . for diffusion / convection models",
    "the situation is similar , with more convection tending to make the gradient follow more closely the sources .",
    "a larger halo ( @xmath118 kpc ) , apart from being excluded by the @xmath110 analysis presented here , would in fact not improve the situation much since fig .  [ fig11 ] shows that the gradient approaches an asymptotic shape which hardly changes beyond a certain halo size .",
    "this is a consequence of the nature of the diffusive process , which even for an unlimited propagation region still retains the signature of the source distribution .",
    "-5pt    based on these results we have to conclude , in the context of the present models , that the distribution of sources is not that expected from the ( highly uncertain : see @xcite ) distribution of snr .",
    "this conclusion is similar to that previously found by others ( @xcite ) . in view of the difficulty of deriving the snr distribution this is perhaps not a serious shortcoming",
    "; if snr are indeed cr sources then it is possible that the gamma - ray analysis gives the best estimate of their galactic distribution .",
    "therefore in our standard model we have obtained the source distribution empirically by requiring consistency with the high - energy gamma - ray results .",
    "figure  [ fig12 ] shows the source distribution adopted in the present work , and the resulting 3 gev proton distribution , again compared to that deduced from gamma rays .",
    "the gradients are now consistent , especially considering that some systematic effects , due for example unresolved gamma - ray sources , are present in the gamma - ray results",
    ".    measurements of cosmic - ray anisotropy in the 1  100 tev range provide an independent argument for reacceleration ( e.g. , @xcite ) since the slower increase of diffusion coefficient with energy avoids the large anisotropies predicted by non - reacceleration models .",
    "our models reproduce this behaviour , the reacceleration models giving anisotropies @xmath119 at 1 tev , while the non - reacceleration models give @xmath120",
    ". the observed values ( @xmath119 ) largely reflect the local structure of the interstellar magnetic field in the part of the galaxy near the sun , and hence do not give useful constraints on the large - scale propagation which our model addresses ( see @xcite ) . in particular",
    "it is not possible to test the large - scale cosmic - ray gradients at such energies by this method .",
    "it is sufficient to note that the reacceleration models are consistent with the observations while the non - reacceleration models are not , in accord with previous authors conclusions .        -5pt",
    "we have shown that simple diffusion / convection models have difficulty in accounting for the observed form of the @xmath0  ratio without special assumptions chosen to fit the data , and do not obviate the need for an _ ad hoc _ form for the diffusion coefficient . on the other hand",
    "we confirm the conclusion of other authors that models with reacceleration account naturally for the energy dependence over the whole observed range , with only two free parameters .",
    "combining these results points rather strongly in favour of the reacceleration picture . in this case @xmath121 km s@xmath4 , with little dependence on @xmath18 .    for the first time",
    "@xmath1  has also been computed with reacceleration .",
    "we take advantage of the recent ulysses @xmath84 measurements to improve limits on the halo size .",
    "we emphasize the crucial importance of the treatment of energy losses in the evaluation of the @xmath1  ratio .",
    "the halo height with reacceleration is @xmath122 kpc .",
    "our new limits should be an improvement on previous estimates because of the more accurate @xmath84 data , our treatment of energy losses , and the inclusion of more realistic astrophysical details ( such as , e.g. , the gas distribution ) in our model .    in case reacceleration",
    "is _ not _ important , the halo size limits are still @xmath122 kpc for the case of no convection , while only the lower limit holds if convection is allowed .",
    "the upper limit on the convection velocity gradient is @xmath3 km s@xmath4 kpc@xmath4 , and this value being allowed for large @xmath18 only .",
    "the gradient of protons derived from gamma rays is smaller than expected for snr sources , the closest approach to consistency being for @xmath117 kpc ; we therefore adopt a flatter source distribution in order to meet the gamma - ray constraints .",
    "the anisotropy at @xmath123 tev predicted by our reacceleration models is consistent with observations , while the non - reacceleration model predict a larger value than observed .",
    "this reflects the general property of such models ( e.g. , @xcite ) .",
    "the large - scale propagation is however not significantly constrained by anisotropy measurements at the energies considered in this paper , since local interstellar effects may dominate .",
    "the large @xmath18 values found here would have very significant implications for gamma rays at high galactic latitudes , giving a larger inverse - compton intensity than normally considered .",
    "gamma - rays will be addressed in detail in @xcite .",
    "we are grateful to the referee for useful suggestions .",
    "we thank dr . j.",
    "j. connell for help with the ulysses @xmath84 data and for providing data prior to publication .",
    "we thank dr .",
    "d. breitschwerdt and dr .",
    "v. ptuskin for useful discussions .",
    "the propagation equation is written in the form : @xmath124 - { 1\\over\\tau_f}\\psi - { 1\\over\\tau_r}\\psi\\ , \\]]where @xmath125 is the density per unit of total particle momentum , @xmath126 in terms of phase - space density @xmath127 , @xmath128 is the source term , @xmath24 is the spatial diffusion coefficient , @xmath129 is the convection velocity , reacceleration is described as diffusion in momentum space and is determined by the coefficient @xmath130 , @xmath131 is the momentum loss rate , @xmath132 is the time scale for fragmentation , and @xmath133 is the time scale for the radioactive decay .",
    "the details of the numerical scheme is described in appendix  b.    we use particle momentum as the kinematic variable since it greatly facilitates the inclusion of the diffusive reacceleration terms .",
    "the injection spectrum of primary nucleons is assumed to be a power law in momentum for the different species , @xmath134 for the injected _ density _ or @xmath135 , a form often used ( e.g. , engelmann et al . 1990 ) . since observations are usually quoted as a _ flux _ with kinetic energy per nucleon as the kinematic variable a conversion",
    "is made before comparison with data : @xmath136 since @xmath137 , where a is the mass number , @xmath138 is the kinetic energy per nucleon , @xmath103 . ] , as expected for diffusive shock acceleration ( e.g. , @xcite ) ; the value of @xmath139 can vary with species .",
    "the injection spectrum for @xmath69 and @xmath140 was taken as @xmath141 , for the case of no reacceleration , and @xmath142 with reacceleration .",
    "these values are consistent with engelmann et al .",
    "( 1990 ) who give an injection index @xmath143 .",
    "the same indices reproduce the observed proton and @xmath144 spectra , as was shown in @xcite . for primary electrons ,",
    "the injection spectrum is adjusted to reproduce direct measurements , gamma - ray and synchrotron data ; details are given in the other papers of this series ( i , ii , iv ) .",
    "for secondary nucleons , the source term is @xmath145 $ ] , where @xmath146 , @xmath147 are the production cross sections for the secondary from the progenitor on h and he targets , @xmath148 is the progenitor density , and @xmath149 , @xmath150 are the interstellar hydrogen and helium number densities .    to compute @xmath0  and @xmath1  it is sufficient for our purposes to treat only one principal progenitor and compute weighted cross sections based on the observed cosmic - ray abundances , which we took from lukasiak et al .",
    "( 1994b ) .",
    "explicitly , for a principal primary with abundance @xmath151 , we use for the production cross section @xmath152 , where @xmath153 , @xmath154 are the cross sections and abundances of all species producing the given secondary . for the case of boron ,",
    "the nitrogen progenitor is secondary but only accounts for @xmath155 10% of the total boron production , so that the approximation of weighted cross sections is sufficient .    for the fragmentation cross sections we use the formula given by letaw , silberberg & tsao ( 1983 ) . for the secondary production cross sections we use the webber , kish & schrier ( 1990 ) and",
    "silberberg & tsao ( 1990 , see also @xcite ) parameterizations in the the form of code obtained from the transport collaboration ( @xcite ) .",
    "comparison of the results from these different versions of the cross sections gives a useful estimate of the uncertainty from this source .",
    "for the important @xmath0  ratio , we take the @xmath69 , @xmath156 , @xmath157 , @xmath158 , @xmath159 cross sections from the fit to experimental data given by heinbach & simon ( 1995 ) . since for @xmath84",
    "the values of the cross sections are particularly important we give for reference the values actually used for the abundance - weighted cross sections at 500 mev / nucleon , including interstellar @xmath160 : @xmath161 mb , @xmath162 mb . for radioactive decay , @xmath163 , where @xmath164 years for @xmath110 .    for",
    "electrons and positrons the same propagation equation is valid when the appropriate energy loss terms ( ionization , bremsstrahlung , inverse compton , synchrotron ) are used .",
    "since this paper is intended to complete the description of the full model , we include the formulae for these loss mechanisms in appendix  c.2 .",
    "a detailed description of the source function for secondary electrons and positrons was given in @xcite .",
    "the diffusion , reacceleration , convection and loss terms in eq .",
    "( a.1 ) can all be finite - differenced for each dimension ( @xmath165 ) in the form @xmath166where all terms are functions of @xmath167 .    in the crank - nicholson implicit method ( @xcite ) the updating scheme is @xmath168the tridiagonal system of equations ,",
    "@xmath169is solved for the @xmath170 by the standard method ( @xcite ) .",
    "note that for energy losses we use ` upwind ' differencing to enhance stability , which is possible since we have only _ loss _ terms ( adiabatic energy _",
    "gain _ is not included here ) .",
    "the three spatial boundary conditions @xmath171are imposed at each iteration .",
    "no boundary conditions are imposed or required at @xmath12 = 0 or in @xmath13 .",
    "grid intervals are typically @xmath172 kpc , @xmath173 kpc ; for @xmath13 a logarithmic scale with ratio typically 1.2 is used .",
    "although the model is symmetric around @xmath33 the solution is generated for @xmath174 since this is required for the tridiagonal system to be valid .",
    "since we have a 3-dimensional @xmath11 problem we use ` operator splitting ' to handle the implicit solution , as follows .",
    "we apply the implicit updating scheme alternately for the operator in each dimension in turn , keeping the other two coordinates fixed . to account for the substeps @xmath175 and @xmath176 are used instead of @xmath177 , @xmath178 .",
    "the coefficients of the crank - nicholson scheme we use are given in table  [ table3 ] .",
    "the method was found to be stable for all @xmath179 , and this property can be exploited to advantage by starting with @xmath180 ( see below ) . the standard alternating direction implicit ( adi ) method , in which the full operator is used to update each dimension implicitly in turn , is more accurate but was found to be unstable for @xmath181 .",
    "this is a disadvantage when treating problems with many timescales , but can be used to generate an accurate solution from an approximation generated by the non - adi method .    a check for convergence",
    "is performed by computing the timescale @xmath182 from eq .",
    "( a.1 ) and requiring that this be large compared to all diffusive and energy loss timescales .",
    "the main problem in applying the method in practice is the wide range of time - scales , especially for the electron case , ranging from 10@xmath183 years for energy losses to 10@xmath184 years for diffusion around 1 gev in a large halo .",
    "use of a time step @xmath185 appropropriate to the smallest time - scales guarantees a reliable solution , but requires a prohibitively large number of steps to reach the long time - scales .",
    "the following technique was found to work well : start with a large @xmath185 appropriate for the longest scales , and iterate until a stable solution is obtained .",
    "this solution is then accurate only for cells with @xmath186 ; for other cells the solution is stable but inaccurate .",
    "then reduce @xmath187 by a factor ( 0.5 was adopted ) and continue the solution .",
    "this process is repeated until @xmath186 for all cells , when the solution is accurate everywhere .",
    "it is found that the inaccurate parts of the solution quickly decay as soon as the condition @xmath188 is reached for a cell .",
    "as soon as all cells satisfy @xmath188 the solution is continued with the adi method to obtain maximum accuracy .",
    "a typical run starts with @xmath189 years and ends with @xmath185 = 10@xmath190 years for nucleons and 10@xmath191 years for electrons performing @xmath192 60 iterations per @xmath185 . in this way it is possible to obtain reliable solutions in a reasonable computer resources , although the cpu required is still considerable .",
    "all results are output as fits datasets for subsequent analysis .",
    "more details , including the software and datasets , can be found on the world wide web ( address available from the authors ) .",
    "llccc    diffusion & @xmath193 & @xmath194 & @xmath195 & @xmath196    & @xmath197 & @xmath198 & @xmath199 & @xmath198    convection & @xmath28 ( @xmath27 ) & @xmath200 & @xmath201 & @xmath202    & @xmath30 ( @xmath29 ) & @xmath202 & @xmath203 & @xmath204    & @xmath205  ( @xmath31 ) & @xmath202 & @xmath206 & @xmath207    diffusive reacceleration    & @xmath205 & @xmath208 & @xmath209 & @xmath210    energy loss & @xmath205 & @xmath202 & @xmath211 & @xmath212    fragmentation & @xmath213 & @xmath202 & @xmath214 & @xmath202    radioactive decay    & @xmath213 & @xmath202 & @xmath215 & @xmath202      as an example , the coefficients for the radial diffusion term are derived here .",
    "@xmath216setting @xmath217 , one can obtain the following expressions in terms of our standard form ( eq .  [ a.1 ] ) @xmath218      in terms of 3-d momentum phase - space density @xmath127 the diffusive reacceleration equation is @xmath219   = { 1\\over p^2}{{\\partial\\over\\partial p}}\\left [ p^2 { d_{pp}}{{\\partial f(p)\\over\\partial p}}\\right ] .\\]]the distribution is assumed isotropic so @xmath220 where @xmath221 .",
    "first we rewrite the equation in terms of @xmath222 instead of @xmath223 and expand the inner differential : @xmath224 = { { \\partial\\over\\partial p}}\\ , { d_{pp}}\\left [ { { \\partial \\psi\\over\\partial p}}-{2\\psi\\over p } \\right ] .\\]]the differencing scheme is then @xmath225 .\\]]in terms of our standard form ( eq",
    ".  [ a.1 ] ) the coefficients for reacceleration are @xmath226",
    "for nucleon propagation in the ism the losses are mainly due to ionization , coulomb scattering , fragmentation , and radioactive decay . for electrons the important processes are ionization , coulomb scattering , bremsstrahlung in the neutral and ionized medium , as well as compton and synchrotron losses .",
    "although all these processes are well - known the formulae for the different cases are rather scattered throughout the literature and hence for completeness we summarize the formulae used below .",
    "figure  [ fig13 ] illustrates the energy loss time scales , @xmath227 , for electrons and nucleons in pure hydrogen .",
    "the losses are shown for equal neutral and ionized gas number densities @xmath228 @xmath5 , and equal energy densities of photons and the magnetic field @xmath229 ev @xmath5 ( in the thomson limit ) .",
    "these gas and energy densities are chosen to characterize the average values seen by cosmic - rays during propagation .",
    "the coulomb collisions in a completely ionized plasma are dominated by scattering off the thermal electrons .",
    "the corresponding energy losses are given by ( @xcite , their eqs .",
    "[ 4.16],[4.22 ] ) @xmath230where @xmath231 is the classical electron radius , @xmath232 is the electron rest mass , @xmath233 is the velocity of light , @xmath234 is the _ projectile _ nucleon charge , @xmath103 is the nucleon speed , @xmath235 is the electron number density in plasma , @xmath236 , and @xmath237 is the electron temperature .",
    "the coulomb logarithm in the cold plasma limit is given by ( e.g. , @xcite ) @xmath238where @xmath239 is the planck constant , @xmath240 is the nucleon mass , and @xmath241 is the nucleon lorentz factor . for the appropriate number density , @xmath242 @xmath5 , and total energy @xmath243 mev ,",
    "the typical value of the coulomb logarithm @xmath244 lies within interval @xmath245 , instead of usually adopted value 20 .    for the ionization losses we use a general formula ( @xcite , their eq .  [ 4.24 ] ) @xmath246,\\]]where @xmath247 is the fine structure constant , @xmath248 is the number density of the corresponding species in the ism , @xmath249 is the characteristic velocity determined by the orbital velocity of the electrons in hydrogen , and @xmath250,\\]]where @xmath241 is the lorentz factor of the ion .",
    "the largest possible energy transfer from the incident particle to the atomic electron is defined by kinematics @xmath251}},\\]]where @xmath252 is the nucleon mass , and @xmath253 denotes the geometric mean of all ionization and excitation potentials of the atom .",
    "mannheim & schlickeiser ( 1994 ) give the values @xmath254 ev and @xmath255 ev . the shell - correction term @xmath256 , the density correction term @xmath257 , and the @xmath258 correction term ( for large @xmath234 or small @xmath22 ) in eqs .",
    "( c.3),(c.4 ) , can be neglected for our purposes .",
    "ionization losses in the neutral hydrogen and helium are given by the bethe - bloch formula ( @xcite , p.360 ) @xmath259 , \\]]where @xmath260 is the nucleus charge , @xmath248 is the gas number density , @xmath261 is the ionization potential ( we use @xmath262 ev , @xmath263 ev , though the exact numbers are not very important ) , @xmath264 is the total electron energy , @xmath241 and @xmath103 are the electron lorentz factor and speed , correspondingly .",
    "the coulomb energy losses in the fully ionized medium , in the cold plasma limit , are described by ( @xcite , p.361)@xmath265 , \\]]where @xmath266 is the electron number density . for an accurate treatment of the electron energy losses in the plasma of an arbitrary temperature",
    "see , e.g. , dermer & liang ( 1989 ) and moskalenko & jourdain ( 1997 ) .",
    "the energy losses due to @xmath267-bremsstrahlung in the cold plasma are given by the expression ( @xcite ) @xmath268 , & \\,\\gamma \\leq 2 ; \\\\",
    "\\beta ^{-1}\\left [ 6\\gamma \\ln ( 2\\gamma ) -2\\gamma -0.2900\\right ] , &   \\,\\gamma \\geq 2 .",
    "\\end{array } \\right.\\]]for the @xmath269-bremsstrahlung one can obtain ( @xcite ) @xmath270where @xmath271 } , \\\\ \\displaystyle{\\gamma^{*}=\\sqrt{(\\gamma + 1)/2 } } , \\\\ \\displaystyle{p^{*}=\\sqrt{(\\gamma -1)/2 } } , \\end{array}\\ ] ] and the asterisk denotes center - of - mass variables . the total bremsstrahlung losses in the ionized gas is the sum @xmath272 .",
    "a good approximation gives the expression ( @xcite , p.408 ) @xmath273.\\ ] ] bremsstrahlung energy losses in neutral gas can be obtained by integration over the bremsstrahlung luminosity ( @xcite , see also @xcite ) @xmath274a suitable approximation ( max 10% error near @xmath275 mev ) for eq .",
    "( c.11 ) gives the combination ( cf .",
    "eq .  [ c.10 ] )",
    "@xmath276\\sum_{s={h , he}}n_s z_s(z_s+1 ) , & \\",
    "\\gamma\\la 100 ; \\\\ \\displaystyle -c\\ , e \\sum_{s={h , he } } { \\frac{n_s m_s}{t_s } } , & \\ \\gamma\\ga 800 , \\end{array } \\right.\\]](see @xcite , p.386 , 409 ) , with a linear connection in between .",
    "here @xmath277 is the atomic mass , and @xmath278 is the radiation length ( @xmath279 g/@xmath280 , @xmath281 g/@xmath280 ) .",
    "the compton energy losses are calculated using the klein - nishina cross section ( @xcite ) @xmath282,\\]]where the background photon distribution , @xmath283 , is normalized on the photon number density as @xmath284 , @xmath285 is the energy of the background photon taken in the electron - rest - mass units , @xmath286 , @xmath287and @xmath288 is the dilogarithm @xmath289 the synchrotron energy losses are given by @xmath290where @xmath291 is the energy density of the random magnetic field ."
  ],
  "abstract_text": [
    "<S> we describe a method for the numerical computation of the propagation of primary and secondary nucleons , primary electrons , and secondary positrons and electrons . fragmentation and energy losses </S>",
    "<S> are computed using realistic distributions for the interstellar gas and radiation fields , and diffusive reacceleration is also incorporated . </S>",
    "<S> the models are adjusted to agree with the observed cosmic - ray @xmath0  and @xmath1ratios . </S>",
    "<S> models with diffusion and convection do not account well for the observed energy dependence of @xmath0 , while models with reacceleration reproduce this easily . </S>",
    "<S> the height of the halo propagation region is determined , using recent @xmath1  measurements , as @xmath2 kpc for diffusion / convection models and 4  12 kpc for reacceleration models . for convection models we set an upper limit on the velocity gradient of @xmath3 </S>",
    "<S> km s@xmath4 kpc@xmath4 . </S>",
    "<S> the radial distribution of cosmic - ray sources required is broader than current estimates of the snr distribution for all halo sizes . </S>",
    "<S> full details of the numerical method used to solve the cosmic - ray propagation equation are given . </S>"
  ]
}