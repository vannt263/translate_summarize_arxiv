{
  "article_text": [
    "in the past two decades , a number of all - sky astronomical surveys have been conducted throughout the electromagnetic spectrum , changing the way reseach is done .",
    "endeavors such as the sloan digital sky survey in the optical ( sdss ; * ? ? ?",
    "* ) , the two micron all sky survey in the near - infrared ( 2mass ; * ? ? ?",
    "* ) , the rosat all sky survey in x - ray ( rass ; * ? ? ?",
    "* ) , to name a few , have provided a wealth of information about the extragalactic sky . in the radio wavelength regime however , even though 1.4 ghz ( 21 cm ) continuum surveys were conducted with synthesis telescopes ( e.g. the nrao vla sky survey ( nvss ; * ? ? ?",
    "* ) , the first survey @xcite ) , performing a large - scale 21 cm line survey was an unconceivable project until the advent of multi - beam feed arrays .",
    "some early hi 21 cm surveys were carried out with the single pixel receivers at arecibo during the 1990s , covering a few hundred square degrees each @xcite , indicating the need for such blind hi surveys but lacking the means of achieving significant sky coverage .",
    "other blind hi surveys were made with several of the green bank telescopes @xcite and with synthesis telescopes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . even though these surveys achieved high sensitivity , they also seriously suffered from limited sky coverage .",
    "three radioastronomical facilities now have multi - beam l - band receivers that allow for large scale extragalactic surveys in the hi 21 cm line . using a thirteen beam array on the parkes telescope ,",
    "the hi parkes all sky survey ( hipass ; * ? ? ?",
    "* ) was the first such survey and covered the declination range @xmath2 @xcite .",
    "it was followed by the hi jodrell all sky survey ( hijass ; * ? ? ?",
    "* ) , which uses a four element feed array and was intended to be the northern extension of hipass . following a proposal by @xcite , a seven beam array named alfa ( arecibo l - band feed array ) finally became available at the arecibo telescope in 2004 .    making use of this instrument , the ongoing arecibo legacy fast alfa survey ( alfalfa ; * ? ? ?",
    "* ) is intended to cover 7000 deg@xmath3 of high galactic latitude extragalactic sky .",
    "observations began in early 2005 , and should take five or six years to complete .",
    "thanks to the large size of the arecibo dish and the observing strategy implemented , alfalfa provides data with eight times more sensitivity than hipass and four times better angular resolution . as highlighted in @xcite , the alfalfa survey is much more sensitive to low - mass systems than the previous largest surveys , and will push the determination the faint end of the hi mass function to significantly lower masses than previous studies made possible @xcite . in combination with other surveys such as sdss and 2mass , alfalfa will also address the issue of the `` missing satellites '' .",
    "other scientific objectives include the determination of the hi diameter function , the discovery of large hi tidal features and hi absorbers in the local universe @xcite .",
    "a challenge encountered in all the hi surveys mentioned above is to devise a technique to detect extragalactic signals out of the large data sets acquired .",
    "independent galaxy - finding algorithms were created for hipass , hijass and alfalfa . for the hipass data , the peak finding algorithm _ multifind _",
    "was used @xcite .",
    "the algorithm searches for connected pixels above a user - defined peak flux threshold in individual velocity planes ( which are cuts through a data cube at a given constant frequency ) .",
    "the detections from successive planes are then compared , groupings of objects within 5 arcminutes of each other are made , and a candidate detection is identified when a source appears on at least two adjacent velocity planes .",
    "the process is repeated for various degrees of smoothing along the spectral axis , and multiple detections are removed from the final catalog . from simulated data cubes ,",
    "_ multifind _ is found to detect @xmath4 of sources with peak flux greater than 60 mjy @xcite . when tested on real hipass data cubes",
    "however , _ multifind _ detects only @xmath5 of the galaxies visually detected , missing most of those with peak fluxes smaller than 50 mjy .",
    "therefore the algorithm could only be used to produce a catalog of the brightest galaxies in the sample @xcite .",
    "the other survey , hijass , used a slightly different approach where the signal detection process was done in two ways .",
    "first , a list of candidates is made by visually inspecting the data cubes and recording objects found above the noise level that show both spatial and spectral extent @xcite .",
    "then , a second list of possible sources is made by applying an algorithm , _ polyfind _ , which looks in the data cubes for peaks above a given threshold .",
    "these signals are then compared to templates by matched - filtering and identified as potential sources if a good fit exists between signal and template .",
    "the results of _ polyfind _ are then checked by eye and the lists of detections from the visual and automated detections combined .    in the cases of both hipass and hijass , the automated signal extraction algorithms either rely strongly on visual inspection of the data or can only be used to detect the brightest objects . for alfalfa ,",
    "a different strategy has been adopted in order to minimize the impact of these restrictions . instead of identifying galaxies on the basis of their peak flux exceeding a defined threshold ,",
    "a matched - filtering algorithm was conceived .",
    "since performing the cross - correlations required by such a method are costly in computer time , the search is done in fourier space using single - parameter templates made by a combination of hermite polynomials and gaussian functions .",
    "the advantages of this technique are many : the cross - correlation technique is sensitive to the total flux of a galaxy allowing for better sensitivity to broad and faint signals compared to peak - finding techniques , it acts robustly in presence of low frequency fluctuations of spectral baselines , and the execution time is reduced as the process does not need to be repeated for different degrees of spectral smoothing .    the remainder of the paper is structured as follows . in  2 , we give a general description of the alfalfa survey data , in  [ 1d ] and  [ 3d ] the workings of the signal extractor are explained and in  5 we present the results of simulations to quantify the performance of the extractor .",
    "while a complete account of the alfalfa data reduction pipeline ( _ lovedata _ ) will be given elsewhere ( giovanelli et al .",
    "2007 , in preparation ) , we present here some of the key aspects that influence the process of signal extraction .",
    "alfalfa observations are done in drift mode , which means that on any given observing session the telescope is set at a specific declination and fourteen spectra ( the seven beams of alfa , each with two polarizations ) are recorded every second as the sky drifts over the dish .",
    "a noise diode is fired every ten minutes to provide calibration .",
    "the `` drift map '' obtained over the course of the night is band - pass calibrated and baselined .",
    "each drift scan is then examined by a member of the team to flag parts of the spectra that are contaminated by strong radio frequency interference ( rfi ) .    when the observations are completed over a region of the sky , all the drift scans affecting that region are combined to produce evenly gridded three - dimensional data cubes .",
    "these cubes are chosen to be @xmath6 in size , with grid points separated by 1  both in ra and dec .. the third axis of the cubes , frequency , is made to have 1024 channels . in order to cover the full spectral range sampled by alfalfa , four partly overlapping cubes are therefore made for each region on the sky , respectively covering the redshift ranges : -2000 to 3300  km s@xmath7 , 2500 to 7900  km s@xmath7 , 7200 to 12800  km s@xmath7 , and 12100 to 17900  km s@xmath7 .",
    "for each data cube , two different linear polarizations are separately recorded .",
    "since the extragalactic signals are not polarized , the average of the two polarizations is used for most applications , but as explained in  [ 3d ] it is useful to retain the information separately since a difference in flux between the two individual polarization cubes can be used as one of the criteria to reject spurious detections .    for each data cube ,",
    "an array of identical size is created containing not the spectral data but a parameter describing the survey coverage at each position . when the data cubes are created , data sections flagged as affected by egregious rfi or of otherwise low quality are not used . however , low level rfi is not always easily identified and thus flagged , and can affect the gridded data and the signal extraction process . additionally , due to system malfunctions",
    ", parts of some drift scans may be missing , and therefore parts of some cubes sometimes have poorer coverage and lower sensitivity than others .",
    "this information is recorded in this additional cube and will also be used in the signal extraction process to reject unlikely detections .",
    "the signal extraction technique implemented for the alfalfa survey relies on the cross - correlation of templates with the data . as outlined earlier",
    ", the motivation behind this approach is to obtain a catalog of galaxies that goes down to as low a flux limit as possible , while at the same time remaining efficient in terms of cpu and human time . in this section",
    "we first present the theory behind the matched - filtering technique used , and we then summarize its implementation .",
    "the process described in ",
    "[ concept ] is similar to that used by @xcite to determine redshifts from galaxy spectra .",
    "we want to find the best fit to a signal @xmath8 , where @xmath9 is the channel number that runs through all the frequencies sampled ( as mentioned in  2 , @xmath9 goes from 1 to 1024 for the adopted grid format ) .",
    "we first assume that @xmath10 , that is the signal can be represented by a template function @xmath11 , of which we can change the amplitude @xmath12 , the central channel position @xmath13 , and the width @xmath14 .",
    "the best template will have values @xmath12 , @xmath13 and @xmath14 such that @xmath15 ^ 2 , \\label{chi2}\\ ] ] is minimized , where @xmath16 is the last spectral channel .",
    "now , let @xmath17 and @xmath18 be the variance of the signal and template , respectively @xmath19 and let @xmath20 be the normalized cross - correlation function , @xmath21 .",
    "\\label{cross}\\ ] ] expanding equation [ chi2 ] and including these quantities , @xmath22 can be written as : @xmath23    this expression for @xmath22 has to be minimized with respect to @xmath12 , @xmath13 and @xmath14 in order to find the best - match template for the signal @xmath8 .",
    "first , equation [ chisimple ] can be minimized with respect to @xmath12 : @xmath24 equating this to 0 gives a simple expression for the template peak height as a function of the cross - correlation function and the standard deviations of the spectrum and template functions : @xmath25 this expression for @xmath12 can now be introduced in equation [ chisimple ] to give @xmath26 , \\label{chifinal}\\ ] ] which shows that minimizing @xmath22 is equivalent to maximizing @xmath27 , the value of the cross - correlation between the data and the template of width @xmath14 centered on the spectral channel @xmath13 .",
    "because time efficiency is an issue , the signal search is not done in the radio frequency domain since calculating the summations of equation [ cross ] can be very time - consuming .",
    "it is well known that convolutions are most efficiently implemented by using the fast fourier transform algorithm and invoking the convolution theorem .",
    "let @xmath28 and @xmath29 be the discrete fourier transforms of the spectrum and template , @xmath30 then , by virtue of the convolution theorem , the fourier transform of the cross - correlation function is @xmath31 where @xmath32 indicates the complex conjugation operation .",
    "the function @xmath20 is simply retrieved by taking the inverse discrete fourier transform of @xmath33 .",
    "putting all the pieces together , the process of signal extraction goes as follows .",
    "a set of templates covering a physical range of rotation widths is selected ( the specific shape of these templates is described in  [ templates ] ) , and their fourier transforms calculated .",
    "then , the fourier transform of each spectrum is multiplied with each of the templates following equation [ ftc ] , and the inverse transform of this product computed .",
    "we thus have a set of convolution functions , one for each template . for each of these convolution functions ,",
    "the maximum value @xmath27 is determined , where @xmath13 is the spectral channel at which @xmath20 is maximized .",
    "we are then left with a set of values of @xmath27 , one for each template .",
    "the largest of these values , @xmath34 , tells us which template had the most appropriate width to model the signal .",
    "two of the parameters of the model are thus already determined : the central position , @xmath35 , and @xmath36 , the width of the template that produced @xmath34 ) .",
    "the third parameter , the peak amplitude @xmath37 , is simply calculated using equation [ amin ] .",
    "this last statement outlines one of the strengths of this method : by performing a very small number of cross - correlations with carefully chosen templates , the parameters describing a best - fit model @xmath38 to a signal @xmath8 can be accurately determined with a single free parameter , the spectral width .",
    "we have so far not specified what is the shape of the adopted templates . for the above strategy to apply",
    ", the selected templates must be characterized by a width , maximum amplitude and central position along the spectrum .",
    "the first two obvious choices are simple gaussian and top - hat functions .",
    "the gaussian has the advantage of being simple to manipulate and normalize and is very adequate to model galaxies of small rotation widths .",
    "however , for broader signals exhibiting the characteristic two - horn profile of extragalactic hi spectra , a gaussian provides a poorer fit and therefore is likely to miss very broad and shallow signals .",
    "a top - hat template would be less affected by this inadequacy , as its shape better approximates that of broad hi signals .",
    "a possible approach would be to use a hybrid template , one for example in which the narrow templates are gaussian and the broader ones top - hats , or templates made of two gaussians of increasing width and spectral separation .",
    "there are however problems with these two possibilities .",
    "the gaussian / top - hat templates would suffer from the discontinuity between the two models , and both would prove difficult to normalize while keeping track of the template width .",
    "this last point is important since the values of the cross - correlation between the spectrum and all the different templates need to be directly compared .",
    "the solution to this problem is to find a set of templates with shapes that evolve with width , but that are at the same time a homogeneous family of functions so the value of the cross - correlation can be compared from one template to the next in order to find the best match for any given signal .",
    "ideally , this family of functions would contain a gaussian as its lowest order term since it is a very appropriate template for narrow signals . at the same time",
    ", it should be able to describe a top - hat - like function for the broader signals .",
    "we therefore introduce a template model with a shape which evolves smoothly with width .",
    "to make the width - dependence tractable , we express the templates in the functional basis formed by the hermite functions , @xmath39 .",
    "these functions are the product of the hermite polynomials , @xmath40 , with a gaussian function and are most commonly known as the eigenfunctions of the one - dimensional quantum harmonic oscillator .",
    "this family of functions is a convenient choice since @xmath41 is a gaussian and because , owing to their orthogonality , any template can easily be expressed as @xmath42 , where @xmath43 carries the dependency on the width @xmath14 .",
    "since the templates should be symmetric around the central velocity , let s consider the first two symmetric hermite functions : @xmath44 @xmath45 these two functions are plotted in panel ( a ) of figure [ herm_fncs ] . since the first term is a pure gaussian ,",
    "the narrowest templates can be taken to be the first hermite function alone .",
    "for broader signals , the top - hat function can be expanded in terms of the above two functions by performing simple scalar products .",
    "we first create a top - hat function , @xmath20 , and expand it in terms of @xmath46 and @xmath47 : @xmath48 where @xmath49 and @xmath50 .",
    "see panels ( b ) and ( c ) of figure [ herm_fncs ] for an illustration .",
    "note that @xmath20 could be expanded using an infinity of terms , but keeping the first two is sufficient to get the desired template shape .",
    "then we define two different width thresholds , @xmath51 and @xmath52 .",
    "the templates having @xmath53 will be pure gaussians , while the ones with @xmath54 will be a hybrid between the pure gaussian and the expansion of the top - hat .",
    "the templates wider than @xmath52 will be @xmath55 stretched or compressed to the appropriate width .",
    "explicitly , the templates have the functional form : @xmath56 where @xmath57 , @xmath58 , and @xmath59 . from experience of measuring hi profiles of galaxies of various rotation velocities , the values of the two thresholds",
    "are set such that fwhm@xmath60  km s@xmath7 and fwhm@xmath61  km s@xmath7 .",
    "the advantage of using a set of orthogonal functions is that the normalization of the various templates is trivial , making for a smooth transition from one width interval to the next , a criterion that is essential for the amplitude of the cross - correlation functions to be compared . in figure [ templ_plot ]",
    "we present six examples of templates .",
    "the velocity in the top left corner of each panel is the fwhm of each template .",
    "the top row represents the @xmath53 case , the middle line the @xmath54 and the bottom row the widest templates which have @xmath62 .",
    "these templates provide representation of real signal which are not perfect , but approximate real data quite adequately .      in order to test this choice of template and method ,",
    "simple simulations are performed with three different signal extraction techniques : ( 1 ) the matched - filtering process described above with the hermite function templates of figure [ templ_plot ] , ( 2 ) a boxcar smoothing of the data followed by a peak search , and ( 3 ) the matched - filtering process but this time with the simulated galaxy profile serving as the template .",
    "this last technique is used as a reference , since searching for a signal with itself produces optimal results .",
    "the results are shown in figure [ ex3d_box ] , and represent 500 simulated spectra in each of which a spectral profile was injected using the templates described in  [ sim_galaxies ] .",
    "the top pannel compares the results of techniques ( 1 ) and ( 2 ) ( filled squares and open triangles , respectively ) with that of technique ( 3 ) ( labeled as @xmath63 in the figure ) . as expected",
    ", none of the two techniques can recover all of the signal like the template itself can , especially for the fast - rotating galaxies which tend to have more complicated spectral profiles .",
    "however , there is a significant difference between the two , with the `` hermite templates '' matched - filtering technique producing superior results than the boxcar smoothing method .",
    "moreover , while a boxcar smooth and peak - finding search seems like a conceptually simpler technique , it turns out to be more complicated to implement and take more computation time due to the need to repeat the process for several degrees of smoothing .",
    "therefore we conclude that while the two techniques are mathematically similar , the method proposed here is superior to the boxcar approach because of the specific choice of the template shapes , and the fourier space technique used to implement it .",
    "it is also more resilient against broad - band baseline fluctuations .",
    "the process described in the previous section is used to detect signals one spectrum at the time . however",
    "since the grid points in an alfalfa data cube are separated by 1  while the size of the arecibo beam is @xmath64 , a real detection is expected to be made in several spectra .",
    "ideally , the signal extraction process would be performed simultaneously in the three directions ( frequency , ra and dec ) by convolving 3-dimensional templates with the fourier transform of the whole data cube .",
    "this method would be most sensitive , but is unfortunately not practiced due to the large size of the arrays .",
    "this is why the search is done one spectrum at a time in fourier space , with the next step of the extraction aimed at matching detections from different spectra that correspond to the same hi source .    in the first phase of the process ( the 1-d signal extraction along the frequency axis of the data cube , see  [ 1d ] ) , an array of identical size to the data cube itself is created with value zero everywhere except at the coordinates and central spectral channel of each of the detections .",
    "the next phase is iterative .",
    "the maximum value within this array is found : this corresponds to the @xmath65 value at the center of the brightest hi source within the data cube . a small box centered on this position",
    "is then defined to contain all spectral detections that may be part of this galaxy .",
    "all the points in this box are projected in a single ra - dec plane and a two - dimensional gaussian is fitted to determine the spatial extent of the galaxy .",
    "thus , a candidate detection is obtained and logged .",
    "afterwards , all grid points in the array associated with that source are set to zero , and the second highest @xmath65 source is sought .",
    "the process repeats itself until the highest s / n value left in the grid is below the user - defined @xmath65 detection threshold .",
    "note that we reject any detection made in the first or last 10 channels of the cube , to avoid the possible spurious detections that could come from the fact that the fft algorithm assumes that the signal is periodic .    at this point",
    ", the spatial information on each source and that contained in the two individual polarization cubes can be used to reject spurious detections .",
    "since extragalactic hi signals are not polarized , the flux of a galaxy in each polarization should be statistically the same , while the noise should be uncorrelated between the two . therefore a criterion that will reject a detection if there is a significant flux difference between the two polarizations can be applied .",
    "the power of this test is limited at low @xmath65 by the fact that the presence of noise with near - gaussian properties will create a difference in flux even for a perfectly unpolarized signal .",
    "the polarization criterion is useful for bright signals and to reject bad detections arising from strong rfi , but it can only be taken as an indicator of caution for the fainter detections , where it would be most useful .    a number of other criteria are applied to select candidate detections .",
    "they are based on the knowledge of the expected extent of hi disks in galaxies , of the general properties of spectra in the 21 cm line , and of the effect of the arecibo beam on the observed properties of galaxies .",
    "a detection will be rejected if :    * the fwhm of the detection is larger than 15  along the major axis ( the relatively small number of objects of large size in the sky are easily spotted by visual inspection ) , * no spatial extent in the alfalfa grid is measured in either ra or dec , * the detection is made in fewer than four grid points , * the single - spectrum contiguous detections assigned to the same source have significantly different velocity widths , * the survey sky coverage at this spatial position is incomplete , indicating poor data quality .",
    "the sources passing those tests are considered candidate detections . at this point",
    ", the user can quickly browse through the data cube and either add to or remove from this list .",
    "a catalog of candidate detections is finally produced , containing the following parameters for each source : hi position , redshift , velocity width , hi diameters , peak flux , flux integral , noise rms and @xmath65 ratio .",
    "specialized measuring algorithms which allow , for example , baseline fitting , deblending and more detailed characterization of signal parameters , can be applied interactively to the candidate detections delivered by the signal extractor .",
    "to test the performance of the signal extraction process , simulations were made .",
    "the main goal of this exercise was to establish the completeness and reliability as a function of @xmath65 for the catalogs of candidate detections , by simulating datasets with properties mimicking those of the alfalfa data cubes .",
    "first , arrays of gaussian noise are produced and smoothed to the resolution of the survey data .",
    "then galaxy spectral profiles of varying spatial size and spectral characteristics are injected into these grids of noise arrays .",
    "finally we carry on the signal extraction process and compare the output catalog with the input information of the simulated galaxies . below we describe those steps in detail .",
    "the characteristics of noise in the alfalfa data cubes greatly impact the performance of the signal extractor .",
    "therefore , before attempting to simulate data , we first analyze the noise present in the alfalfa survey datacubes . in figure [ noise_hist ]",
    "we present the histogram of pixel values for a set of alfalfa data cubes , after smoothing to a spectral resolution of 10 km s@xmath7 , excluding spectral channels containing galactic hi .",
    "the continuous line is the best gaussian fit to the histogram , which has a standard deviation of @xmath66 mjy .",
    "the vertical dashed lines are at @xmath67 and the dotted lines at @xmath68 .",
    "the rms of the residuals of the fit is 0.01 dex within @xmath67 and 0.04 dex within @xmath68 .",
    "this means that the pixels within @xmath67 deviate from gaussian white noise by less that @xmath69 .",
    "the data cubes used to create the histogram contained galaxies , the contribution of which can be seen above the @xmath70 level where they start to dominate over the noise .",
    "the idea that the deviation from gaussianity for positive pixel values comes from galactic contributions is supported by the fact that the negative pixels follow the gaussian distribution down to the @xmath71 level .",
    "the simulations are therefore performed assuming gaussian white noise with @xmath72 mjy .",
    "data cubes of size @xmath6 with grid points separated by 1  and 1024 spectral channels are created out of gaussian white noise with the above characteristics .",
    "the cubes are then smoothed by convolving a two - dimensional gaussian with a 2  hpfw kernel and by performing 3 point hanning smoothing along the spectral direction , to reproduce the 10 km s@xmath7  resolution of the alfalfa data cubes .",
    "these cubes are the basic units in which simulated galaxies are then injected .",
    "to simulate galaxies , we use as models the 166 galaxies detected during the alfalfa precursor observations @xcite .",
    "this way , the extractor is tested on actual profiles and its performance can be assessed most reliably . in each data cube",
    "40 simulated galaxies are introduced while making sure that each galaxy is separated from its nearest neighbour by at least 20  and 200 km / s@xmath7 . for each galaxy ,",
    "the following parameters are randomly assigned : central spectral channel , right ascension and declination pixel coordinates , peak flux , velocity width and physical sizes along the major and minor axes .",
    "one of the 166 models is then randomly chosen , scaled to the assigned peak flux , stretched or compressed to the selected spectral width , and added to the grid at the randomly selected position .",
    "since sources appear in multiple grid points , the model galaxy is also added to all nearby grid points after scaling it down assuming that the integrated flux drops off from the central position according to a two - dimensional gaussian profile .",
    "we simulate the second polarization in an identical way , except that the template is scaled up or down by up to @xmath73 to simulate possible offsets in calibration , thought to be representative of the alfalfa data calibration errors .",
    "for completeness we repeat the process by simulating galaxy spectra as gaussians or as top - hat models .",
    "the performance of the signal extractor is not affected by this change of simulated spectral profile .      as a first test ,",
    "the input parameters of the simulated galaxies are compared to those recovered by the signal extractor . in figure",
    "[ params_ex ] , the input and `` detected '' values for the velocity width @xmath74 and @xmath65 ratio are plotted against each other , the line being the 1:1 relation . the overall agreement between input and output parameters is quite satisfactory , considering that the goal of the signal extractor is to detect galaxies , but not necessarily to produce the most accurate values of their parameters , something that is achieved during the next step of the data processing pipeline ( giovanelli et al .",
    "2007 , in preparation ) . as in section [ validation ]",
    ", @xmath63 is the maximum @xmath65 that could be retrieved by the signal extractor , as it was calculated using the simulated galaxy profile itself as the matched - filter .",
    "note that here and in all that follows , the @xmath65 ratio is defined as the mean flux across the signal to rms ratio , if the spectrum was smoothed to half the velocity width of the signal , up to a width of 400 km s@xmath7(where typical baseline fluctuations start to be of the same width as the galaxy profiles ) : @xmath75 where @xmath76 is the integrated flux in mjy km s@xmath7 , @xmath74 is the width of the signal in km s@xmath7  and @xmath14 is the rms noise . in the above equation , 10",
    "km s@xmath7  corresponds to the spectral resolution of the alfalfa data , after hanning smoothing .",
    "this definition of @xmath65 takes into account the fact that for the same peak flux a broader signal has more signal , something the signal extractor is sensitive to .    in figure [ sn_w ] , we plot the @xmath65 ratio of the detected galaxies against their velocity width to check if the catalog is biased against either narrow or broad signals : the top dashed line is the maximum @xmath65 ratio of the simulated data as injected , the bottom dashed line is the @xmath65 threshold of 3.8 used during the signal extraction process and the dotted line corresponds to the @xmath65 level of 5.5 , where the catalog of detections becomes reliable ( see  [ reliability ] ) .",
    "the region of the plot between the bottom dashed line and the dotted line is under - populated , especially in the region @xmath77 , but all candidate sources `` detected '' above the dotted line actually correspond to sources injected in the simulation .",
    "the crowding in the plot at @xmath78 km s@xmath7  reflects the width of the narrowest template used in the signal extraction process .",
    "the most important goal of performing simulations is to assess the reliability and completeness of the catalogs produced by the signal extractor .",
    "we define `` reliability '' as the fraction of candidate sources detected by the extractor which correspond to sources actually injected in the simulations .",
    "the complement to 1 of the reliability fraction refers to spurious detections . by `` completeness '' , we mean the fraction of the simulated sources that are recovered by the extractor .",
    "these issues are critical because they influence the survey strategy .",
    "the alfalfa catalog is built in two stages .",
    "a first catalog is made with the detections having @xmath79 , where @xmath80 is the threshold above which the probability of a detection being real is extremely high .",
    "the second step will require re - observation of the detections with @xmath81 , where @xmath82 is the limit below which most detections are spurious and the process of re - observation would yield too few confirmations to justify the extensive telescope time required to carry the observations .    by studying the reliability of the simulated catalog , the values of @xmath82 and @xmath80 can be determined .",
    "the top panel of figure [ compl_rel ] shows as a function of @xmath65 the fraction of detected sources matched by input signals in the simulations ; in each @xmath65 bin the number of simulated sources detected is divided by the total number of detections .",
    "the filled squares represent the full sample of detected galaxies , the open triangles those with @xmath83 km s@xmath7and the open diamonds the detections with @xmath84 km s@xmath7 .",
    "the reliability figure shows that any detection with @xmath85 is reliable . for detections in the @xmath86 range , @xmath87 of them",
    "are real for @xmath84 km s@xmath7but only @xmath88 for @xmath83 km s@xmath7 .",
    "detections with @xmath89 are much less reliable with an overall probability of @xmath90 that any detection is real . in the bins centered on @xmath91 and @xmath92 , detections of broader signal",
    "are more reliable than those of narrower signals .",
    "this is a reasonable result since the gaussian noise is uncorrelated between spectral channels past the 3 point hanning smoothing level , and therefore spurious detections are much more likely to be very narrow features than broad ones .",
    "considering these results , the adopted values for the two thresholds are @xmath93 and @xmath94    the bottom panel of figure [ compl_rel ] shows the completeness of the extracted catalog as a function of @xmath65 for the sample of simulated galaxies .",
    "we plot the fraction of sources injected in the simulations actually detected by the extractor .",
    "the symbols refer to the same sample of galaxies as in the top panel .",
    "the catalog of sources produced by the signal extractor is complete to better than @xmath95 for @xmath96 ( however , the vast majority of candidate detections at @xmath97 are spurious ) . for the narrowest galaxies ,",
    "the catalog becomes complete to better than @xmath98 at @xmath99 , while this level of completeness is reached at @xmath100 for the widest sources .",
    "all the above results were obtained by simulating `` ideal '' data cubes . while uniform gaussian white noise is present over most parts of the spectra , some frequency ranges and some parts of the sky coverage are affected either by residual rfi or by the edges of the bandpass where the noise rms is locally higher or the noise features start to be correlated .",
    "the presence of standing waves produced by strong continuum sources and system instabilities also affect the quality of the baselines .",
    "the signal extractor is fairly robust against these problems since it will reject detections if the two polarizations do not match , calculates the noise rms over nearby pixels only , and is insensitive to large - scale amplitude variations of the baseline larger than the maximum template width .",
    "the thresholds defined above will vary depending on data quality .",
    "we perform an additional test to verify the influence of data quality on the detection process . since the alfalfa velocity coverage starts at -2000 km s@xmath7",
    "while no galactic or extragalactic hi signals are expected to be found in the -2000 to -500 km s@xmath7  velocity range , that spectral region has the characteristics of the survey data while being `` uncontaminated '' by the presence of cosmic sources , except for the very rare possibility of oh megamasers .",
    "we compare the detections made by the signal extractor in that velocity range for 120 alfalfa data cubes to the detections coming from cubes of simulated noise ( as explained in ",
    "[ noise ] ) .",
    "histograms showing the @xmath65 distribution of these detections are presented in figure [ spurious ] .",
    "the filled histogram represents the simulated data sets and the open histogram the `` galaxy - free '' portion of the alfalfa data cubes .",
    "the two histograms are normalized to represent the same number of independent spectra processed . for each detection made in the alfalfa data cubes ,",
    "a weight is defined to characterize the data quality .",
    "the values range from 0 ( no data ) to 1 ( perfect survey coverage ) .",
    "the open histogram shows all the detections located in regions that have a weight larger than 0.55 .",
    "this value is adopted to provide the best match between the two histograms for @xmath101 where the gaussian noise component dominates . above @xmath102",
    ", there is an excess of candidate detections from the alfalfa data cubes over that of simulated data characterized by gaussian noise .",
    "this disagreement can be completely eliminated by allowing in the sample only sources found in regions with weights larger than 0.9 , but this criterion would also reject a sizeable fraction of the survey volume .",
    "the excess is believed to be caused by residual rfi , probably of low intensity level , which the flagging stages of the data processing failed to identify .",
    "much of the residual rfi is found in regions of the volume sampled by the survey which are in or in the vicinity of regions of low weight .",
    "low level rfi may however be present , and largely unidentified , in regions of high weights .",
    "we thus relax the definition of @xmath80 from the value of 5.5 , as derived from the discussion related to figure [ compl_rel ] , to the value of 6.5 ( dashed line in figure [ spurious ] ) .",
    "we estimate that at @xmath99 , spurious features will appear in the data  and be tentatively detected by the signal extractor  at the rate of one every six square degrees .",
    "this translates into a reliability of @xmath103 that candidate detections with @xmath99 correspond to real cosmic sources .",
    "visual inspection of the sources may reveal characteristics that help further increase the reliability figure .    as for @xmath82",
    ", we would like to keep a catalog of low @xmath65 candidate sources having a likelihood of being associated with cosmic sources such that follow - up corroborating observations can detect them at a rate , per unit of telescope time , which is significantly higher than that at which alfalfa blindly detects sources with @xmath79 .",
    "estimating that the latter number is of order 6 sources per hour ( see @xcite ) , and that a corroborating observation may require 2.5 minutes of telescope time ( 24 pointed observations per hour ) , it appears as if @xmath82 can be set at a level such that the estimated reliability is of order @xmath104 .",
    "inspection of figures [ compl_rel]a and [ spurious ] would indicate that @xmath105 : sources with @xmath106 can be considered fairly safe detections , better than @xmath107 reliable ; sources with @xmath108 would be kept in a separate catalog to be used for pointed , corroborating observations after completion of the survey .",
    "we have described a new signal extraction algorithm created for the alfalfa survey , which is a major on - going effort at the arecibo observatory to blindly map in the hi 21 cm line 7000 deg@xmath1 of extragalactic sky .",
    "all the software needed for the data reduction pipeline , known as the _ lovedata _ package , was created in the idl environment by members of the alfalfa collaboration .",
    "part of this package is a utility that automatically finds hi sources in the alfalfa data cubes and creates catalogs of candidate detections .",
    "the need for such a tool first stems from the sheer size of the project , and is justified by the desire to create a uniform catalog of sources , even though the data processing and analysis is carried on by a large number of individuals from multiple institutions .",
    "the strategy adopted for the alfalfa signal extractor is that of cross - correlations of templates with the spectra .",
    "this matched - filtering technique , when performed in fourier space , has the advantage of being very time - efficient .",
    "other advantages include the fact that the process is sensitive to the total flux of the galaxies , rather than to the peak flux , as is the case for algorithms that work using a peak - finding strategy , and the fact that the algorithm is quite robust against baseline and other instabilities .",
    "the templates used are built with the first two symmetrical hermite functions , which are the product of the hermite polynomials with a gaussian function .",
    "the narrowest templates with widths smaller that 60 km s@xmath7  are simple gaussians , while the wider templates are built via a truncated expansion of a top - hat function in terms of the hermite functions . this way the templates used for narrow signals have a gaussian shape , while the wider ones show the characteristic two - horned profile of most hi emission from rotating galaxies .",
    "this allows for an optimal detection rate of galaxies of all rotation widths , while having a single - parameter ( the velocity width ) set of templates that are all constructed from the same family of functions . as explained in ",
    "[ 1d ] , this condition is required for the fourier space cross - correlation technique to apply efficiently .    a set of simulations were performed to assess the performance of the signal extractor . following an analysis of the noise in the alfalfa data cubes ,",
    "simulated cubes were created and modeled galaxies pasted into them . the signal extractor recovers the velocity width and @xmath65 ratio of the input galaxies , and is not biased against either narrow or broad signals .",
    "the simulations suggest that , in the presence of gaussian noise , detections with @xmath85 are reliable to better than @xmath109 confidence , and broad detections are reliable up to the @xmath87 level at @xmath86 .",
    "the presence of low level rfi inadequately flagged during the data processing reduces the reliability of the source candidates of low @xmath65 . for alfalfa data",
    ", we estimate the reliability level to be better than @xmath107 for candidate detections with @xmath106 .",
    "these are immediately published as cataloged detections ( a first catalog of this kind is presented by * ? ? ?",
    "candidate signals with @xmath108 will be retained for future pointed follow - up observations , which should deliver corroborated detections at a rate , per unit of telescope time , equal or better than that at which the blind alfalfa survey detects sources with @xmath106 .",
    "it is not only critical to develop a tool that will allow for the reliable detection of galaxies in the alfalfa data cubes down to the smallest flux levels possible , it is just as important to understand the properties of such a tool in order to assure the highest quality and completeness for the data catalogs released and to optimally design the confirmation follow - up observations .",
    "since alfalfa is by far the most sensitive blind hi large - scale survey of the nearby universe , some of its most interesting and novel scientific results will come from the very lowest mass galaxies and otherwise faint objects it is detecting .",
    "the strategy for signal extraction proposed here will capitalize on this strength of alfalfa by allowing for the reliable detection of such interesting extragalactic systems .    it is a pleasure to acknowledge the many contributions made by riccardo giovanelli to this work , including most valuable insights throughout the redaction of this paper .",
    "many thanks also to martha haynes , brian kent , sabrina stierwalt and rebecca koopmann , who provided helpful comments during the development and testing phases of the signal extractor software .",
    "this work was supported by nsf grants ast-0607007 and ast-9397661 , and by grants from the _ fonds qubecois de la recherche sur la nature et les technologies _ and from the brinson foundation ."
  ],
  "abstract_text": [
    "<S> we present a signal extraction utility written for the purposes of the arecibo legacy fast alfa survey ( alfalfa ) . </S>",
    "<S> this survey , when completed , will have covered @xmath07000  deg@xmath1 of the high galactic latitude sky and should detect over 20,000 extragalactic objects . </S>",
    "<S> it is the most sensitive blind hi survey to date . </S>",
    "<S> the large size of the survey justifies in itself the need for an automated way of identifying signals in the data set . </S>",
    "<S> the matched - filtering signal extractor proposed is based on convolutions in the fourier domain of templates of varying widths with each spectrum . </S>",
    "<S> the chosen templates are built from a simple combination of hermite functions to mimic the shape of typical galactic hi profiles of varying widths . </S>",
    "<S> the main advantages of this matched - filtering approach are a sensitivity to the total flux of the signals ( and not only to peak flux ) , robustness against instabilities and short computing times . </S>",
    "<S> the details of the algorithm are given here , as well as results of simulations that assess the reliability and completeness of the process . </S>"
  ]
}