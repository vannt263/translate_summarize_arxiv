{
  "article_text": [
    "the optimization of machine instructions derived from source codes has long been of interest to compiler designers , processor architects , and code developers .",
    "compilers such as ` gcc ` , for example , provide a myriad of flags , each allowing the programmer to choose the `` level '' of optimization . as codes and",
    "their optimization become more complex , however , it can be harder to know a priori what modifications will benefit or hinder performance in execution .",
    "recent advances in the area have demonstrated that higher performance of a given code can be achieved through annotation scripts ( e.g. , orio [ @xcite ] ) , which directly apply code transformations such as loop reordering to the original source to generate a modified , but semantically equivalent , version of the code .",
    "the output code can then be compiled in various ways ( e.g. , by setting compiler optimization flags or by choosing different compilers ) , resulting in an executable that runs on a particular machine more or less quickly depending on the nature of the transformation , compilation , machine architecture , and original source code . given detailed knowledge of each aspect of the process , from original source to final executable , one can obtain significant speedups in execution .",
    "but missteps can result in significant slowdowns .",
    "modern high - performance computing facilities are increasingly complex , making it difficult and/or time - consuming for a scientific programmer to intimately understand or control the environment in which the source code is executed , and thereby affect its performance .",
    "for example , commercial cloud - computing services such as the amazon elastic compute cloud ( ec2 ) provide only a limited description of the available hardware and accompanying resources ; and scientific and governmental computing facilities are diverse .",
    "thus , the need arises to tune codes automatically .    in this paper",
    "we report on aspects of a performance - tuning effort being undertaken at argonne national laboratory to meet needs in scientific computing .",
    "our aim , given a target machine and source code , is to study how a suite of given transformations , together with compiler options ( e.g. , ` gcc ` flags ) , can be used to minimize code execution times under the constraint that it yields correct output . as evidenced by the success of the atlas project ( http://math-atlas.sourceforge.net/ ) ,",
    "involving a similar but more limited search set , even minor performance gains for basic computational kernels can be significant when called repeatedly .",
    "we focus on data arising from a set of exploratory benchmarking experiments described by @xcite . in the design of each experiment ( the input source code )",
    ", a subset of the possible transformation and compilation options ( inputs ) was thought to yield correct numerical outputs , and these were varied in full enumeration over the input space to obtain execution times .",
    "some of the inputs are ordinal and some categorical .",
    "such full enumerations therefore result in combinatorially huge design spaces  too big to explore in a time that is reasonable to wait for a compiled executable .",
    "we investigate the extent to which a statistical model can be used to measure the relative importance of each input for predicting execution times , to explore how each relevant input contributes to the execution time marginally and ( to the extent possible ) conditionally , and to check for any predictable patterns of constraint violations arising from unsuccessful compilation or runtime errors in the executed code .",
    "our results in section  [ secapp ] show that we can dramatically reduce the space of options in the search for fast executables : one of the five inputs is completely removed , and each of the other four has its range decreased by roughly a factor of @xmath0 .",
    "we perform this analysis on a dramatically reduced design that , together with a thrifty inferential technique , means that such information can be gleaned in an amount of time that most programmers would deem acceptable to produce a final executable .",
    "we then provide a final iterative optimization , primed with the results of that analysis , to obtain a fast executable .",
    "the remainder of the fully enumerated design is then used for validation purposes , wherein we show that our solution is preferable to alternatives out - of - sample .",
    "several aspects of this type of data make it unique in the realm of computer experiments , therefore justifying a noncanonical approach .",
    "the first is size . even when using reduced designs , these experiments are large by conventional standards .",
    "second , although some of the transformation options ( i.e. , inputs ) are ordinal ( e.g. , a loop unrolling factor ) , there is no reason to expect an a priori smooth or stationary relationship between that input and the response : for some architectures it may be reasonably smooth , and for others it may have regime changes due to , for example , being memory - bound versus being compute - bound .",
    "third , high - order interactions between the inputs are expected , a priori , which may prohibit the use of additive models .",
    "fourth , checking for valid outputs requires a classification surrogate .",
    "fifth , since ( valid ) responses are execution times , the experiment being modeled is inherently stochastic , whereas many authors define a computer experiment as one where the response is deterministic .",
    "this last point is perhaps more nuanced than it may seem at first .",
    "in actuality , many of the sources that can contribute to the `` randomness '' of an executable are known .",
    "for example , processor loads can be controlled ; interruptions from operating system maintenance threads follow schedules ; and locations in memory , which affect data movement , can be controlled .",
    "but these may more usefully , and practically , be modeled as random . however , one contributor to the nature of the `` noise '' in the experiment is of particular interest to the argonne researchers : the _ cold - cache effect_.    this effect , due to compulsory cache misses sometimes arising from initial accesses to a cache block , is also referred to as _ cold - start misses _ @xcite and can cause the first execution instance to run slower than subsequent instances",
    ". it would be useful to know whether acknowledging and controlling for this effect are necessary when searching for an optimal executable .",
    "the degree of the cold - cache effect varies greatly from problem to problem , and determining its significance is vital for designing an experimental setup ( e.g. , whether the cache needs to be warmed before each execution of a code configuration ) .",
    "although recent works [ e.g. , @xcite ] have focused on defining input spaces for performance tuning problems , formulating appropriate objectives in the presence of the cache effects and other operating system noise remains an unresolved issue , which application of our techniques can help inform . in section  [ secapp ]",
    "we show that the cold - cache effect is present but negligible for the particular problem examined .",
    "one can optimize the executable without acknowledging its effect because it is very small and does not vary as a function of the input parameters.=-1      the remainder of the paper is organized as follows .",
    "given the unique demands of our motivating problem set , we make the case in section  [ seccase ] that a new , thrifty approach to modeling computer experiments and decomposing the influence of inputs is needed .",
    "we maintain that , without using such an analysis to first significantly narrow the search space , searches for optimal transformations and compilation settings can not be performed in a time that is acceptable to practitioners .",
    "we propose that these needs are addressed by _ dynamic tree _ ( dt ) models , which ( along with previous approaches to model - based decomposition of influence ) are reviewed below and in the . in sections",
    "[ secvs ] and [ secsa ] we improve upon standard methodology for variable selection and input sensitivity analysis by leveraging the unique aspects of dts .",
    "compared with previous tree modeling approaches , our new methodology offers sequential decision making and fully bayesian evidence not previously enjoyed in these contexts . compared with the canonical gaussian process ( gp ) model for computer experiments , which serves as a straw man for many of our comparisons , our methods facilitate decompositions of input variable influence on problems that are several orders of magnitude larger than previously possible , while simultaneously avoiding assumptions of smoothness and stationarity and allowing for higher - order interactions .",
    "both sections conclude with an illustration of the methods , in both classification and regression applications , and a brief comparison study in support of these observations .",
    "section  [ secapp ] contains a detailed analysis of our motivating performance - tuning example using such methods .",
    "we conclude in section  [ secdiscuss ] with a brief discussion .",
    "we begin with a review of previous approaches to the analysis of input influence as relevant to applications in computer experiments , motivating our dynamic trees approach . these models and accompanying inferential techniques",
    "are then discussed in some detail .      in any regression analysis",
    ", one must quantify the influences on the response by individual candidate explanatory variables .",
    "this assessment should cover an array of information , attributing direction , strength , and evidence to covariate effects , both when acting independently and when interacting . for linear statistical models , various well - known tools are available for the task .",
    "in ordinary least - squares , for example , there are @xmath1 and @xmath2 tests for the effect of predictor(s ) , anova to decompose variance contributions , and leverages to measure influence in the input space .",
    "such tools are fundamental to applied linear regression analysis and are widely available in modern statistical software packages .",
    "in contrast , analogous techniques for more complicated nonparametric regression methods , such as neural networks , other basis expansions , or gps and other stochastic models , are far less well established .",
    "many related techniques exist , and we provide a detailed review in our .",
    "however , they are not part of the conventional arsenal applied to the broad engineering problems that motivate this work ",
    "optimization under uncertainty and emulation of noisy computer simulators  where modeling is further complicated by nonstationarities manifesting in varying degrees of smoothness .",
    "a  lack of fast , easy - to - apply tools ( and readily available software ) means that one typically treats the response surface model as a black - box prediction machine and neglects analyses essential for tackling the application motivating this paper . to resolve the tension between flexibility and interpretability",
    ", we present a framework that provides both .",
    "we argue that dynamic trees ( dts ) , introduced in @xcite and summarized below , are a uniquely appropriate platform for predictive modeling and analysis of covariance in complex regression and classification settings .",
    "although aspects of dt modeling are just as opaque as , say , neural networks , they inherit many advantages from the well - understood features of classic trees .",
    "they take a fast and flexible divide - and - conquer approach to regression and classification by fitting piecewise constant , linear models , and multinomial models . besides employing a prior that regularizes the nature of the patchwork",
    "fits that result , they make few assumptions about the nature of the data - generating mechanism .",
    "this approach is in contrast to gp models , which may disappoint when stationary modeling is inappropriate and which are burdened by daunting computational hurdles for large data sets .",
    "part of our argument holds for tree models in general , of which dts are just one modern example : partitioning of the covariate space , the same quality that is key to model flexibility , acts as an interpretable foundation for attribution of variable influence .",
    "distinct from most other tree methods , however , dts are accompanied by an efficient particle sequential monte carlo ( smc ) method for posterior inference and can provide full uncertainty quantification for each metric of covariance analysis , hence allowing for proper consideration of statistical evidence .",
    "dt inference is also inherently on - line and naturally suited to the analysis of sequential data .",
    "this aspect is exploited in our final optimization of the motivating computer experiment .",
    "our methodological contributions comprise two complementary analyses : _ variable selection _ and input _",
    "sensitivity analysis_. the first focuses on selecting the subset of covariates to be included in the model , in that they lead to predictions of low variance and high accuracy .",
    "the second characterizes how elements of this subset influence the response . as discussed in more detail in the , it is most common to focus on only one of these two analyses : variable selection is common in additive models , where the structure for covariance is assumed rather than estimated , whereas in more complicated functional sensitivity analysis settings , the set of covariates is taken as given .",
    "this methodological split is unfortunate , because variable selection and sensitivity analysis work best together , with sensitivities providing a higher - fidelity analysis that follows in - or - out decisions made after preselecting variables .",
    "hence , we have found that the use of dts as a platform for both analyses is a powerful tool in applied statistics and is ideal for our motivating performance - tuning application .",
    "the dynamic tree ( dt ) framework was introduced in @xcite to provide bayesian inference for regression trees that change in time with the arrival of new observations .",
    "it builds directly on work by @xcite ( @xcite ) , wherein prior models over the space of various decision trees are first developed . since the taddy et al .",
    "paper contains a survey of bayesian tree models and full explanation of the dt framework , we focus here on communicating an intuitive understanding of dts and refer the reader elsewhere for details . for those interested in using these techniques ,",
    "software is available in the ` dynatree ` [ @xcite ] package for , which also includes all the methods of this paper .",
    "consider covariates @xmath3 paired with response @xmath4 , as observed up to time @xmath1 ( the data need not be ordered , but it is helpful to think sequentially ) .",
    "a corresponding tree @xmath5 consists of a hierarchy of _ nodes _ @xmath6 associated with different disjoint subsets of @xmath7 .",
    "this structure is built through a series of recursive _ split rules _ on the support of @xmath8 , as illustrated in the top row of figure  [ treefig ] : the left plot shows top - down sorting of observations into nodes according to variable constraints , and the right plot shows the partitioning at the bottom of the tree implied by such split rules .",
    "these terminal nodes are called _ leaves _ , and , in a regression tree , they are associated with a prediction rule for any new covariate vector .",
    "that is , new @xmath9 will fall within a single leaf node @xmath10 ) , and this provides a distribution for @xmath11 . for example , a _ constant tree _ has simple leaf response functions @xmath12",
    "= \\mu_{\\eta({\\mathbf{x}}_{t+1})}$ ] , a _ linear tree _ fits the plane @xmath13 through the observations in each leaf , and a _ classification tree _ uses within - leaf response proportions as the basis for classification .     upon arrival of a new data point at  @xmath9 . ]",
    "bayesian inference relies on prior and likelihood elements to obtain a tree posterior , @xmath14^t ) \\propto { \\mathrm{p}}(y^t|{\\mathcal{t}}_t , { \\mathbf{x}}^t ) \\pi({\\mathcal{t}}_t)$ ] .",
    "given independence across partitions , tree likelihood is available as the product of likelihoods for each terminal node ; constant and linear leaves use normal additive error around the mean , while classification trees assume a multinomial distribution for each leaf s response .",
    "this is combined with a product of conjugate or reference priors for each leaf node s parameters to obtain a conditional model for leaves given the tree .",
    "chipman et al .",
    "define the probability of splitting node @xmath15 , with node depth @xmath16 , as @xmath17 .",
    "hence , the full tree prior is @xmath18 $ ] , where @xmath19 is the set of internal nodes and @xmath20 are the leaves .",
    "they show how a taxonomy of choices of @xmath21 and @xmath22 map to prior distributions over trees via their depth .    the dt model of taddy et al",
    ".  adopts this basic framework but combines it with rules for how a given tree can change upon the observation of new data .",
    "in particular , @xmath23 for a new tree is replaced with @xmath24 , where this conditional prior is proportional to chipman et al.s @xmath23 but restricted to trees that result from three possible changes to the neighborhood of the leaf containing @xmath9 : _ stay _ and keep the existing partitions , _",
    "prune _ and remove the partition above @xmath25 , or _ grow _ a new partition by splitting on this leaf .",
    "this evolution from @xmath26 to @xmath27 via @xmath9 is illustrated in figure  [ treefig ] .",
    "the original dt paper contains much discussion of tree dynamics , but the founding idea is that this process leverages the assumed independence structure of trees to introduce stability in estimation : a  new observation at @xmath9 will change our beliefs only about the local area of the tree around @xmath25 .    while the moves from @xmath26 to @xmath27 are designed to be local to new observations , inference for these models must account for global uncertainty about @xmath26 .",
    "this is achieved through use of a filtering algorithm that follows a general particle learning recipe set out by @xcite . in such methods , the posterior for @xmath26",
    "is approximated with a finite sample of potential tree _ particles _",
    "@xmath28 , each of which contain the set of tree - defining partition rules .",
    "this posterior is updated to account for @xmath29 $ ] by first _ resampling _",
    "particles proportional to the predictive probability @xmath30 and then _ propagating _ these particles by sampling from the conditional posterior @xmath31^{t+1})$ ] ( i.e. , drawing from the three moves illustrated in figure  [ treefig ] , proportional to each resulting tree s prior multiplied by its likelihood ) . hence , tree propagation is local , but resampling accounts for global uncertainty about tree structure .",
    "although dts inferential mechanics are tailored to sequential applications , such as sequential design or optimization , they can also provide a powerful tool for batch analysis .",
    "since the data ordering can be arbitrary , it can be helpful to run several independent repetitions of the smc method each with a different random pass through the data .",
    "this approach allows one to study the monte carlo error of the method , which can be mitigated by averaging inferences across repetitions .",
    "such averaging is especially important for bayes factor estimation [ @xcite ] .",
    "tree models engender basic variable selectionthrough the estimation of split locations : any variable not split on has been deselected",
    ". however , this binary determination does not provide any spectrum of variable importance , and the unavailable null distribution for tree splits can lead to inclusion of spurious variables .",
    "hence , we need measures of covariate influence that are based on analysis of response variance .",
    "combining these with the full probability model provided by dts , one can obtain a probabilistic measure of variable importance and evidence for inclusion .      following the basic logic of tree - based variable selection , variables contribute to reduction in predictive variance through each split location .",
    "we label the leaf model - dependent uncertainty reduction for each node @xmath15 as @xmath32 . grouping these by variable , we obtain the importance index for each covariate @xmath33 as @xmath34},\\ ] ] where @xmath35 is the splitting dimension of @xmath15 and @xmath36 is the set of all internal tree nodes ( i.e. , split locations ) . through efficient storage of data and split rules ,",
    "these indices are inexpensive to calculate for any given tree . given a filtered set of trees , as described in section  [ secdynatree ] , the implied sample of @xmath37 indices provides a full posterior distribution of importance for each variable ; this can form a basis for model - based selection .    for @xmath32",
    "we consider the decrease in predictive uncertainty associated with the split in @xmath15 . in regression , the natural choice is the average reduction in predictive variance , @xmath38 where @xmath39 and @xmath40 are @xmath15 s children , @xmath41 is the predictive variance at @xmath42 in the node  @xmath15 , and @xmath43 is the bounding covariate rectangle for that node .",
    "rectangles on the boundary of the tree are constrained to the observed variable support , and , from recursive partitioning , @xmath44 .    for constant leaf - node models ,",
    "each integral in ( [ eqredvar ] ) is simply the area of the appropriate rectangle multiplied by that node s predictive variance . for classification , we replace the predictive variance at each node with the predictive entropy based on @xmath45 , the posterior predicted probability of each class @xmath46 in node  @xmath15 .",
    "this leads to the entropy reduction @xmath47 , where @xmath48 .",
    "since the rectangle area calculations involve high - dimensional recursive partitioning and can be both computationally expensive and numerically unstable , a monte carlo alternative is to replace @xmath49 with @xmath50 , the number of data points in @xmath15 .",
    "we find that this provides a fast and accurate approximation .",
    "a regression tree with linear leaves presents a more complex setting , since the reduction in predictive variance is not constant over each partition . in appendix",
    "[ seclinint ] , we show that the calculations in ( [ eqredvar ] ) remain available in closed form .",
    "however , since in this case covariates also affect the response through the linear leaf model , ( [ eqj ] ) provides only a partial measure of variable importance . in section  [ secsa ]",
    "we describe other sensitivity metrics whose interpretations do not depend on leaf model specification .",
    "an @xmath51-particle posterior sample @xmath52 can be used to assess the importance of each predictor @xmath53 , through both graphical visualization and ranking of summary statistics . as a basis for deselecting variables ,",
    "we advocate estimated relevance probability , @xmath54 . , and thus @xmath55 for particle @xmath56 , may be negative for some @xmath57 because of the uncertainty inherent in a monte carlo posterior sample . ]",
    "a backward selection procedure based on this criterion , illustrated in the examples below , is to repeatedly refit the trees after deselecting variables whose relevance probability is less than a certain threshold .",
    "we use a default relevance threshold of 0.5 , such that a variable s relevance posterior must be less than 50% negative to entertain deselection .",
    "however , as we comment in section  [ secccache ] , this can be problematic for some designs , for example , with many categorical predictors . a more conservative 0.95 threshold has analogy to the familiar 5% level for evidence in hypothesis testing , and can be appropriate in such settings . for guidance and intuition",
    ", one can refer to the prior distribution on the probability that the tree splits on a particular input .",
    "note that this is not the same as a prior distribution on relevance , which does not exist under our improper leaf - model priors ; rather , the probability of splitting on a given variable is its probability of having a nonzero relevance .",
    "figure  [ fprior ] plots the average number of splits ( lighter ) and the probability of at least one split ( darker ) using the four pairs of @xmath58 values explored by @xcite , plus the ` dynatree ` default values @xmath59 , as a function of the sample size obtained uniformly in @xmath60^{10}$ ] .",
    "these quantities stabilize after about @xmath61 samples and indicate that , _ for this uniform design _ , there is about a 12% prior probability of splitting .    ultimately , the backstop for a proposed deselection is the bayes factor of the old ( larger ) model over the proposed ( smaller ) one , terminating the full procedure when proposals longer indicate a strong preference for the simpler model .",
    "reliable marginal likelihoods are available through the sequential factorization @xmath62 and lead to useful bayes factor estimates [ see @xcite ] , as we shall demonstrate .",
    "we consider data first used by @xcite to illustrate multivariate adaptive regression splines ( mars ) and then used by @xcite to demonstrate the competitiveness of dts relative to modern ( batch ) nonparametric models .",
    "the input space is ten - dimensional , however , the response , given by @xmath63 with @xmath64 additive error , depends only on five of the predictors .",
    "although the true function is additive in a certain transformation of the inputs , we do not presume to know that a priori in this illustration .",
    "a particle set of size @xmath65 was used to fit the dt model to @xmath66  1000 input - output pairs sampled uniformly in @xmath60^{10}$ ] .",
    "following @xcite , we repeated the process ten times to understand the nature of the monte carlo error on our selection procedure .",
    "the results are summarized in figure  [ ffried ] .",
    "the boxplots on the left show the cumulative 100,000 samples of the tallied relevance statistics for each variable .",
    "the first five all have relevances above zero with at least 99% posterior probability . the latter five useless variables are easily identified , since their relevance statistics tightly straddle zero .",
    "they average about 35% relevance above zero , cleanly falling below 95% or 50% thresholds .",
    "( figure  [ fprior ] is matched to this input domain . ) after removing these variables we reran the fitting procedure and calculated ( log ) bayes factors , treating the smaller model as the null ( i.e. , in the denominator ) .",
    "all ten ( log ) paths ( _ center _ panel ) eventually indicate that the larger model is not supported by the data .",
    "in fact , a decreasing trend in the bayes factor suggests that the smaller model is actually a better fit .",
    "thus , while deselecting irrelevant variables is not technically necessary , doing so becomes increasingly important as the data length grows relative to a fixed - sized ( @xmath51 ) particle cloud ( i.e. , in order to ward off particle depletion ) .",
    "the right panel in the figure shows the ( log ) bayes factor calculation that would have resulted if we had further considered the first input for deselection ( i.e. , suggesting only inputs 25 were important ) .",
    "clearly , the larger model ( in the numerator ) is strongly preferred .",
    "we turn now to the spambase data set from the uci machine learning repository [ @xcite ] .",
    "the aim is not only to illustrate our selection procedure in a classification context but also to scale up to larger  @xmath50 and @xmath67 with significant interaction effects .",
    "the data contains binary classifications of 4601 emails based on 57 attributes ( predictors ) .",
    "the left panel of figure  [ fspam ] shows the results of a monte carlo experiment based on misclassification rates obtained using random fivefold cross - validation training / testing sets .",
    "this was repeated twenty times for 100 training / testing sets total producing 100 rates .",
    "the comparators are modern , regularized logistic regression models , including fully bayesian ( `` ` b ` '' ) and maximum a posteriori ( `` ` map ` '' ) estimators via gibbs sampling [ @xcite ] , an estimator from the ` glmnet ` package [ `` ` glmn ` '' ; @xcite ] , and the em - based method [ `` ` krish ` '' ; @xcite ]",
    ". results for these comparators on an interaction - expanded set of approximately 1700 predictors are also provided .",
    "expansion is crucial to realize good performance from the logistic models .",
    "our dt contributions are ` dt ` and ` dt2 ` , each using @xmath681000 particles and 30 replicates , which took about half the execution time of the interaction - expanded logistic comparators .",
    "the ` dt2 ` estimator is the result of a single iteration of the selection procedure outlined above using a 50% threshold ( explained below ) , leveraging the @xmath69 obtained from the initial ` dt ` run .",
    "this usually resulted in 25 ( of 57 ) deselections .",
    "the subsequent bayes factor calculation(s ) indicated a preference for the small model in every case considered .",
    "notable results include the following .",
    "the dt - based estimators perform as well as the interaction - expanded linear model estimators , without explicitly using the expanded predictor set .",
    "trees benefit from a natural ability to exploit interaction  even a few three - way interactions were found that , for the other comparators in the study , would have required an enormous expansion of the predictor space . without modification",
    ", our new selection procedure simultaneously allows variables not helpful for main effects or interactions to be culled .",
    "hence , the estimator obtained after deselection ( ` dt2 ` ) is just as good as the former ( ` dt ` , using the entire set of predictors ) but with lower monte carlo error .",
    "in fact , based on the worst cases in the experiment , ` dt2 ` is the best estimator in this study .",
    "we found that marginal reductions in monte carlo error can be obtained with further deselection stages .",
    "the right panels of figure  [ fspam ] show the posterior samples of the entropy difference tallies for predictors whose median relevance was greater than zero ; also shown is the corresponding posterior means by which the samples have been ordered .",
    "a  similar plot is given for random forests in htf ( figure  10.6 ) .",
    "our ordering of importance is similar , but importance drops off quickly because our single - tree model is more parsimonious than are the additive trees of random forests . as an advantage of our approach ,",
    "the middle figure shows posterior uncertainty around these means : there is a large amount of variability , and evidence of multicollinearity shows in any given parameter s potential effect ranging from zero to very large . this observation and an effort to match the size of the predictor set selected by htf both contributed to our choice of the 50% threshold .",
    "the importance indices of section  [ secvs ] provide a computationally efficient measure of a covariate s first - order effect  variance reduction directly attributed to splits on that variable .",
    "these indices are not , however , appropriate for all applications of sensitivity analysis .",
    "first , with nonconstant leaf prediction models , such as for linear trees , focusing only on variance reduction through splits ignores potential influence in the leaf model ; for example , a covariate effect that is perfectly linear will lead to @xmath37 near zero if fit with linear trees .",
    "second , the importance indices depend on the entire sample and can not easily be focused on local input regions , say , for optimization .",
    "third , the importance indices provide a measure that is clearly interpretable in the context of tree models but does not correspond to any of the generic covariance decompositions in standard input sensitivity analysis . in this section",
    "we describe a technique for monte carlo estimation of these decompositions , referred to as _ sensitivity indices _ in the literature , that is model - free and can be constrained to subsets of the input space .",
    "the classic paradigm of input sensitivity analysis involves analysis of response variability in terms of its conditional and marginal variance .",
    "this occurs in relation to a given _ uncertainty distribution _ on the inputs , labeled @xmath70 .",
    "it can represent uncertainty about future values of @xmath42 or the relative amount of research interest in various areas of the input space [ see @xcite ] . in applications , @xmath71 is commonly set as a uniform distribution over a bounded input region .",
    "although one can adapt the type of sampling described here to account for correlated inputs in @xmath71 [ e.g. , @xcite ] , we treat only the standard and computationally convenient independent specification , @xmath72 .",
    "the sensitivity index for a set of covariates measures the variance , with respect to @xmath71 , in conditional expectation given those variables .",
    "for example , the two most commonly reported indices concern _ first - order _ and _ total _ sensitivity : @xmath73 respectively .",
    "the first - order index represents response sensitivity to variable main effects and is closest in spirit to the importance metrics of section  [ secvs ] . from the identity @xmath74 ,",
    "@xmath75 measures residual variance in conditional expectation and thus represents all influence connected to a given variable .",
    "hence , @xmath76 measures the variability in @xmath77 due to the interaction between input @xmath78 and the other inputs , and a large difference @xmath79 can trigger additional local analysis to determine its functional form .",
    "note that all moments in ( [ eqinds1 ] ) are with respect to @xmath71 ; additional modeling uncertainty about @xmath80 is accounted for in posterior simulation of the indices .",
    "we propose a scheme based on integral approximations presented by @xcite .",
    "extra steps are taken to account for an unknown response surface : `` known '' responses are replaced with predicted values .",
    "subsequent integration is repeated across each tree in a particle representation of the posterior and then averaged over all particles .",
    "although we focus on first - order and total sensitivity , full posterior indices for any covariate subset are available through analogous adaptation of the appropriate routines of @xcite .    in the remainder of this section calculations",
    "are presented for a given individual tree ; we suppress particle set indexing .",
    "everything is conditional on a given posterior realization for @xmath81 .",
    "we begin to integrate the common @xmath82 terms by recognizing that @xmath83 assuming uncorrelated inputs , an approximation can be facilitated by taking two equal - sized random samples with respect to @xmath71 .",
    "although any sampling method respecting @xmath71 may be used , we follow @xcite and use a latin hypercube design for the noncategorical inputs to obtain a cheap space - filling sample on the margins , thereby reducing the variance of the resulting indices . specifically , we create designs @xmath84 and @xmath85 each of size @xmath86 , assembled as matrices comprising @xmath67-length row - vectors @xmath87 and @xmath88 , for @xmath89 , respectively .",
    "the unconditional quantities use @xmath84 : @xmath90 where @xmath91 is the column vector @xmath92^\\top$ ] and @xmath93 .",
    "approximating the remaining components in ( [ eqinds2 ] ) involves mixing columns of @xmath85 and @xmath84 , which is where the independence assumption is crucial .",
    "let @xmath94 be @xmath85 with the @xmath78th column replaced by the @xmath78th column of @xmath84 , and likewise let @xmath95 be @xmath84 with the @xmath78th column of @xmath85 .",
    "the conditional second moments are then @xmath96 \\\\[-8pt ] \\nonumber \\widehat{{\\mathbb{e}}\\bigl\\{{\\mathbb{e}}^2\\{y|x_{-j}\\}\\bigr\\ } } & = & \\frac{1}{m-1}{\\mathbb{e}}\\bigl\\{y|m'\\bigr\\}^\\top{\\mathbb{e}}\\{y|m_j\\ } \\approx \\frac{1}{m-1}{\\mathbb{e}}\\{y|m\\}^\\top{\\mathbb{e}}\\bigl \\{y|m'_j\\bigr\\},\\hspace*{-30pt}\\end{aligned}\\ ] ] the latter approximation saving us the effort of predicting at the locations in @xmath95 .    in total , the set of input locations requiring evaluation under the predictive equations is the union of @xmath84 , @xmath85 , and @xmath97 . for designs of size",
    "@xmath86 this is @xmath98 locations for each of @xmath51 particles .",
    "together @xmath86 and @xmath51 determine the accuracy of the approximation .",
    "usually @xmath51 is fixed by other , more computationally expensive , particle updating considerations .",
    "particle - wide application of the above provides a sample from the posterior distribution for @xmath99 and @xmath100 .",
    "a byproduct of the above procedure is information that can be used to estimate main effects . for each particle and input direction",
    "@xmath78 , we apply a simple one - dimensional smoothing of the scatterplot of @xmath101 $ ] versus @xmath102 $ ] .",
    "this provides a realization of @xmath103 over a grid of @xmath104 values and therefore a draw from the posterior of the main effect curve .",
    "note that we use here the posterior means @xmath105 $ ] , as opposed to the posterior realizations for @xmath106 used in calculating sensitivity indices .",
    "average and quantile curves from each particle can then be used to visualize the posterior mean uncertainty for the effect of each input direction as a function of its value .",
    "one - dimensional curve estimation is robust to smoother choice in such a large sample size ( @xmath107 ) ; we use a simple moving average .",
    "consider again the friedman data from section  [ secvsexamples ] , using the first six inputs .",
    "ordinarily we would recommend an initial selection procedure before undertaking further sensitivity analysis to eliminate all irrelevant variables , but we keep one irrelevant input for illustrative purposes .",
    "( _ second row _ ) and @xmath100 ( _ third row _ ) indices for the friedman data using dynamic trees and gps . ]",
    "figure  [ ffriedsa ] summarizes the analysis under constant and linear dts ( dtc and dtl , resp . ) , and under a gp ( fit using ` tgp ` ) for comparison . in all three cases",
    "the number of particles ( or mcmc samples for the gp ) and samples from @xmath71 were the same : @xmath108 and @xmath109 , without replicates .",
    "the main effects for dtl and gp are essentially identical . as evidenced in the plots , dtc struggles to capture the marginal behavior of every input ; @xmath110 is particularly off .",
    "these observations carry over to the @xmath99 and @xmath100 indices .",
    "dtl displays the same average values as does the gp , but with greater uncertainty .",
    "dtc again shows less agreement and greater uncertainty . whereas dtc works well for variable selection , dtl seems better for decomposing the nature of variable influence .    with dtl and gp providing such similar sensitivity indices , why should one bother with dtl ?",
    "the answer rests in the computational expense of the two procedures .",
    "the dt fit and sensitivity calculation stages each take a few minutes . the gp version , even using a multithreaded version of ` tgp ` , takes about six hours on the same machine and requires that the two stages occur simultaneously .",
    "hence , if new @xmath111 pairs are added or a new @xmath71 is specified , the entire analysis must be rerun from scratch . with dts",
    ", the fit can be updated in a matter of seconds , and only the sensitivity stage must be rerun , leading to even greater savings . in sum , the dt analysis can give similar results to gps but is hundreds of times faster .",
    "gps also are good ( but even slower ) at classification ( gpc ) .",
    "perhaps this is why we could not find gpc software providing input sensitivity indices for comparison .",
    "figure  [ fexpclass ] shows the results of a sensitivity analysis for a three - class/2d data set [ see @xcite for details and gpc references ] . fitting a gpc model from 200 @xmath111 pairs takes about an hour , for example , with the ` plgp ` package .",
    "by contrast , fitting a dt with multinomial leaves using @xmath108 particles takes a few seconds ; and the sensitivity postprocessing steps , which must proceed separately for each class , take a couple of minutes .",
    "the map class labels and predictive entropy shown on the left panel indicate the nature of the surface .",
    "notice that the entropy is high near the misclassified points ( red dots ) .",
    "the smooth transitions are difficult to capture with axis - aligned splits .     and",
    "@xmath100 indices for each class . the black lines and boxplots correspond to input @xmath112 , and the red ones to @xmath113 . ]",
    "the plots in the right panels show the main effects and @xmath99 and @xmath100 indices for each class . all three sets of plots indicate a dominant @xmath112 influence , which conforms to intuition because that axis spans three labels whereas @xmath113 spans only two .",
    "lower @xmath114 and @xmath115 values for @xmath113 provide further evidence that its contribution to the variance is partly coupled with that of @xmath112 .",
    "we now examine the data generated by linear algebra kernels from @xcite . the execution times for these experiments",
    "were obtained on fusion , a 320-node cluster at argonne national laboratory .",
    "each compute node contained a 2.6 ghz pentium xeon 8-core processor with 36 gb of ram .",
    "we focus here on the gesummv experiment .",
    "the results obtained for the other two kernels ( matmul and tensor ) we examined are similar and are therefore omitted because of space constraints .",
    "gesummv , from the updated blas library [ @xcite ] , carries out a sum of dense matrix - vector multiplies .",
    "the tuning design variables considered consist of two loop - unrolling parameters taking integer values in @xmath116 and three binary parameters associated with performing scalar replacement , loop parallelization , and loop vectorization , respectively .",
    "argonne allowed an exceptional amount of computing resources to be assigned to these and a suite of similar performance - tuning examples in order to study aspects of the tuning apparatus and to enable initial explorations into elements of the online optimization of executables such as the one we describe below .",
    "in particular , resources were allocated for transformation , compilation , and obtaining the timings of 35 repeated ( on the same dedicated node ) execution trials at each design point in a full enumeration of the gesummv design space .",
    "these tests incurred over 30 cpu - hours ( roughly half of which were devoted to transformation or compilation and half to execution ) .",
    "although well beyond an acceptable budget for a one - off optimized compilation procedure , results from exhaustive enumerations are vital for performance benchmarking of analyses such as ours .",
    "they allow us to compare our automated procedures , made on the basis of much smaller searches , with out - of - sample quantities .",
    "they also help build a library of `` rules of thumb '' and functional and design parameter characteristics that can be useful for priming future searches whose tuning variables and input source codes are similar to those of the fully enumerated experiments .",
    "the fully enumerated gesummv problem ( as well as matmul and tensor ) is relatively small from a performance - tuning perspective , and hence is a prime candidate for our validation and benchmarking purposes . in [ @xcite ] ,",
    "problems with up to @xmath117 design points are posed , clearly indicating that practical tuning will require sampling of only a very small portion of the total design space .",
    "the gesummv experiment is summarized as follows . of the @xmath118 total design points , 199 resulted in a compilation error or an improper memory access and thus were deemed to violate a constraint on correctness .",
    "the resulting 245,035 ( successful ) runtimes were between 0.15 and 0.68 seconds , the mean and median both being 0.22 seconds .",
    "our focus here is on a carefully chosen subset of this data , described below , comprising about 1% of the full set of runs .",
    "the intention is to simulate a realistic scenario wherein variable selection and sensitivity analysis techniques can reasonably be expected to add value to an automated tuning and compilation optimization .",
    "we begin by examining the extent of the cold - cache effect by using selection techniques .",
    "we then turn to a full analysis of the sensitivity to inputs , leading to a localization and subsequent optimization .",
    "next we explore the extent to which one can learn about , and avoid , constraint violations .",
    "we conclude with an out - of - sample comparison between dts and gps .",
    "figure  [ fcoldcache ] illustrates the cold - cache effect over the fully enumerated data .",
    "the left plot shows four histograms counting the number ( out of the 7001 input locations that did not result in a constraint violation ) of times the first , second , seventeenth , and last of the trials resulted in the @xmath119th largest runtime of the 35 trials performed . while the first trial stands out as the slowest ,",
    "results for the three other trials indicate that this effect does not persist for later trials .",
    "that is , the second ( 17th or 35th ) does not tend to have the second ( 17th or 35th ) largest runtime .",
    "however , the right histogram in the figure clearly shows that lower trial numbers tend to yield the maximum execution time more frequently than do higher ones .",
    "these results make clear the existence of a marginal cold - cache effect ; indeed , a paired @xmath1-test squarely rejects the null hypothesis that no marginal effect occurs .",
    "however , our interest lies in determining whether the effect is influential enough to warrant inclusion in a model for predicting runtimes .",
    "in particular , the absolute average distance from the maximum to median runtime ( among 35 trials for each of the 7001 input configurations ) is about 0.01 , compared with the full difference between the maximum and minimum execution in the entire data set at 0.53 . given the effect s low magnitude and our limited available degrees of freedom , it is not clear whether estimating the cold - cache effect is worthwhile in statistical prediction.=1    the remainder of this subsection and section  [ secsa2 ] work with a maxmin space - filling subsampled design of size 500 from the 7001 , and just the first 5 of the 35 replicates ( together a 99% reduction in the size of the data ) .",
    "first , we consider the following experiment on a further subset of the data comprising the first trial and the last ( fifth ) trial for every input in the space - filling design ( 1000 runs in total ) .",
    "the five inputs were augmented with a sixth indicator , which is zero for those from the first trial and one for those from the fifth .",
    "if the cold - cache effect is statistically significant , then this experiment should reveal so .",
    "figure  [ frelevant ] summarizes our results , based on a constant leaf model with 1000 particles and 30 replicates .",
    "the top - left panel shows the posterior relevance samples ; the focus , for now , is on the relevance of the sixth input , which is small .",
    "the scale of the @xmath77-axis is , however , somewhat deceiving : the posterior probability that relevance is greater than zero is 0.58 , with mean relevance of @xmath120 , indicating that the cold - cache may have a tiny but possibly significant effect .",
    "it is helpful to consult the prior inclusion probabilities for further guidance here .",
    "the bottom - right figure shows the boolean predictor s relevance to be approaching 20% as the sample size gets large , nearly twice that of our earlier regression example .",
    "the bayes factor in the the right panel shows a gradually decreasing trend , signaling that the cold - cache predictor is not helpful .    before turning to sa ,",
    "having decided to ignore the cold - cache effect based on the above analysis , we observe that input three also shows low  in fact , negative  relevance . a similar bayes factor calculation",
    "( not shown ) strongly indicated that it too could be dropped from the model .",
    "the remaining four inputs have much greater , and entirely positive , posterior relevance ; bayes factors ( also not shown ) reinforce that these predictors are important to obtain a good fit .",
    "( _ second row _ ) and @xmath100 ( _ third row _ ) indices for gesummv . ]      to further inform an optimization of the automatic code tuning process , we perform a sa .",
    "figure  [ fgesummvsa ] summarizes main effects and @xmath99 and @xmath100 indices for the four remaining variables .",
    "the full reduced design ( all five trials ) was used25,000 input - output pairs total , ignoring the cold - cache effect .",
    "results for both constant and linear leaf models are shown .",
    "in contrast to our earlier results for the friedman data , the differences between linear and constant leaves are negligible . perhaps this is not surprising since both treat binary predictors identically .",
    "the @xmath99 and @xmath100 indices on the remaining predictors tell a similar , but richer , story compared with the relevance statistics .",
    "input two has the largest effect , and input four the smallest , but we also see that the effect of the inputs , marginally , is small ( since the @xmath114s are low and the @xmath115s are high ) .",
    "this result would lead us to doubt that a rule of thumb for optimizing the codes based on the main effects alone would bear fruit , namely , that inputs close to @xmath121 are most promising .",
    "although this may be a sensible place to start , intricate interactions among the variables , as suggested by the @xmath100 indices in particular , mean that a search for optimal tuning parameters may benefit from a methodical iterative approach , say , with an expected improvement ( ei ) criterion [ @xcite ] or another optimization routine . before launching headlong in that direction ,",
    "however , we first illustrate how a more localized sensitivity analysis may be performed without revisiting the computations used in the fitting procedure .",
    "the result can either be cached to prime future code optimizations having similar inputs or to initialize an iterative ei - like search on a dramatically reduced search space.=-1     and @xmath100 are similar to figure  [ fgesummvsa ] . ]",
    "figure  [ fgesummvsal ] shows the main effects from a new sensitivity analysis ( using dtc ) whose uncertainty distribution @xmath122 is constrained so that the first input is @xmath123 , the second is @xmath124 , and the third is fixed to zero ( representing a tenfold reduction in the number of possible design points ) .",
    "the relevance indices indicated importance of the fourth input , so we allowed it to vary unrestricted in @xmath125 , suspecting that localizing the first three inputs might yield a more pronounced effect for the fourth .",
    "note that only @xmath122 is restricted , not the actual input - output pairs , and that the model fitting does not need to be rerun .",
    "in contrast to the conclusion drawn from figure  [ fgesummvsa ] , the localized analysis strongly indicates that @xmath126 is required for a locally optimal solution .",
    "the other two inputs have a smaller marginal effect , locally .",
    "a finer iterative search may be useful for choosing among the @xmath127 local minima in the first two inputs .",
    "many optimization methods are viable at this stage . we prefer to stay within the smc framework , allowing thrifty dt updates to pick up where the size 500 space - filling design left off .",
    "each subsequent design point is chosen by using a tree - based ei criterion [ @xcite ] evaluated on all remaining candidates that meet criteria suggested by our final , zoomed - in , analysis , namely , all unevaluated locations from the fully - enumerated set having @xmath128 and @xmath129 \\times [ 11,24]$ ] . ignoring the irrelevant third input , this results in 98% reduction in the search space compared with the original , fully enumerated design .",
    "after 100 such updates , an evaluation of the predictive distribution on the full 7001 design led to selecting @xmath130 , giving a mean execution time of @xmath131 .",
    "-axes ) of the median of the 35 runs of each of 7001 non-`na ` evaluations , shown with the predicted execution time of @xmath132 found via localized ei ( red dot ) .",
    "the _ right _",
    "panel includes a kernel density estimate of the predicted responses at the localized design , @xmath133 and @xmath129 \\times [ 11,24]$ ] . ]",
    "figure  [ fopt ] shows how this solution is better than 98% of the median of the 35 runs from the fully enumerated set .",
    "both panels show the same histogram of those times , with a red dot indicating @xmath134 .",
    "the right panel augments with the kernel density of the predicted responses at the reduced / zoomed - in design , indicating the value of our variable selection and sensitivity pre - analysis .",
    "even choosing @xmath132 uniformly at random in this region provides an output that is better than 88% of the total options .",
    "the final ei - based optimization ices the cake .",
    "since it takes just seconds to perform , it represents an operation that , when more complete optimization is desired , can be bolted on at compile time for slight variations of the input source : say , for differently - sized matrices .",
    "the `` compiler '' could call up our reduced gesummv design and perform a quick search on the new input matrices .",
    "we return to the original , fully enumerated design to check two possibilities : ( 1 ) whether argonne engineers unknowingly created an inefficient timing experiment ( i.e. , with predictable regions of code failure ) ; and ( 2 ) whether a gp - based analysis would have led to more accurate predictions , and subsequently a better variable selection , sensitivity analysis , and optimization , if a vastly greater computational resource had been available .    for ( 1 ) , the original 7200 design points , with ( two ) classification labels indicating ` na ` values or positive real numbers ( times ) , were used to fit a dt model with multinomial leaves .",
    "otherwise the setup was similar to our earlier examples .",
    "the data has the feature that if one of the 35 trials was ` na ` , then they all were .",
    "the reason is that failures were due to the transformed code failing to compile ( precluding the code from running at all ) or resulting in a segmentation fault upon execution .",
    "other failures ( e.g. , due to hardware failures , soft faults , or the computed quantities differing more than a certain tolerance from reference quantities ) are possible in practice but were not seen in the present data .",
    "sequential updating of the dt classification model revealed a posterior distribution of the importance indices that was decidedly null .",
    "the importance probabilities ( i.e. , of having a positive index ) were @xmath135 , and @xmath136 for the five inputs , respectively .",
    "we interpret these results as meaning that the dt model detects no spatial pattern in the 2.7% of code failures compared with the successful runs .",
    "this conclusion was backed up by a simple bayes factor calculation where the null model disallowed any partitioning .",
    "these results are reassuring because the input space was designed to limit the number of correctness violations ; if relationships between the inputs and these violations were known a priori , the design space would be adjusted accordingly to prevent failures at compile or runtime .    for ( 2 )",
    ", we performed a 100-fold monte carlo experiment . in each fold ,",
    "a dt constant model and a dt linear model were trained on a random maxmin design of size 100 subsampled from the fully enumerated 7001 locations using the first five replicates . besides the smaller design , the smc setup is identical to the one described earlier in this section . then , a bayesian gp with a separable correlation function and nugget was also fit ( using the ` tgp ` package ) by using a number of mcmc iterations deemed to give good mixing .",
    "the resulting computational effort was about ten times greater than for the dt fit , owing to the @xmath137 matrices that required repeated inversion .",
    "we originally hoped to do a size 500 design as in the preceding discussion , but the @xmath138 inversions were computationally infeasible in such nested monte carlo repetition .",
    "finally , a bart model was trained using commensurate mcmc settings . for validation of the models in each fold a random maxmin testing design of size 100",
    "was subsampled from the remaining 6901 locations .",
    "rmses were obtained by first calculating the squared deviation from the posterior mean predictors to actual timings of the 35 execution replicates associated with each testing location .",
    "the square root of the average of the 350 distances was then recorded .    [ cols=\"^,^ \" , ]     figure  [ frmse ] summarizes rmses by boxplot and numbers : median and 90% quantiles .",
    "the absolute performance of the dt and gp methods are strikingly similar . in pairwise comparison , however , dtl is better than the dtc and gp comparators 85% and 71% of the time , respectively , emerging as a clear winner .",
    "therefore , thrifty sequential variable selection , sensitivity analysis , and ei - based optimization notwithstanding , a dt can be at least as good as the canonical gaussian process response model for computer experiments .",
    "this performance may be due to a slight nonstationarity or heteroskedasticity , which can not be accommodated by the stationary gp .",
    "bart was included as a comparator to further explore this aspect . as noted by [ @xcite ]",
    ", bart will tend to outperform dts ( and sometimes gps ) when there is nonstationarity or nonsmoothness in the mean , but not the variance ( i.e. , under homoskedastic noise ) .",
    "the opposite is true in the heteroskedastic noise case , and this is what we observe here . dtc and dtl have lower rmses than bart 92% and 98% of the time , respectively .",
    "these results suggest our execution - times data may benefit from methods that can accommodate input - dependent noise .",
    "the advent of fast and cheap computers defined a statistical era in the late 20th century , especially for bayesian inference . for computer experiments and other spatial data , modestly - sized data sets and clever algorithms allowed the use of extremely flexible nonparametric models .",
    "gp models typify the state of the art from that era , with many successful applications . in classification problems ,",
    "latent variables were key to exploiting computation for modeling flexibility",
    ". today , further technological advance is defining a new era , that of massive data generation and collection where computer and physical observables are gathered at breakneck pace .",
    "these huge data sets are testing the limits of the popular models and implementations .",
    "gps are buckling under the weight of enormous matrix inverses , and latent variable models suffer from mixing ( mcmc ) problems .",
    "although exciting inroads have recently been made toward computationally tractable , approximate gp ( regression ) inference in large data settings [ e.g. , @xcite , @xcite ] , their application to canonical computer experiments problems such as design and optimization remains a topic of future study . in this paper",
    "we suggest that the new method of dynamic regression trees , an update of classic partition tree techniques , has merit as an efficient alternative in nonparametric modeling .",
    "in particular , we perform many of the same experiment - analysis functions as do gp and latent variable models , at a fraction of the computational cost . by borrowing relevance statistics from classical trees and sensitivity indices from gps , the end product is an exploratory data analysis tool that can facilitate variable selection , dimension reduction , and visualization .",
    "an open - source implementation is provided in a recent update of the ` dynatree ` package for .",
    "our illustrations included data sets from the recent literature and a new computer experiment on automatic code generation that is likely to be a hot application area for statistics and other disciplines as heterogeneous computing environments become more commonplace .",
    "ultimately , the goal is to optimize code for the architecture `` just in time , '' when it arrives at the computing node . in order to be realistically achievable ,",
    "that goal will require rules of thumb , as facilitated by selection and sensitivity procedures like those outlined in this paper , and iterative optimization steps like the ei approach we illustrated .",
    "we note that the input space for these types of experiments can , in practice , be much larger than the specific ones we study ; indeed , the median size of the problems presented in [ @xcite ] is more than @xmath139 input configurations .",
    "this makes enumeration prohibitively expensive even for academic purposes , irregardless of acceptable compilation times . in those cases , variable reductions and localizations on",
    "the order of those we provide here will be crucial to enable any study of the search space , let alone a subsequent optimization .",
    "variable selection is largely equated with setting coefficients to zero .",
    "hence , the approaches are predicated on a specific , usually additive , form for the influence of covariates on response . in the analysis of computer experiments , for example",
    ", @xcite and @xcite use the nonnegative garrote [ nng , @xcite ] and @xcite apply grouped lasso .",
    "an advantage of these approaches is that they can leverage off - the - shelf software for variable selection .",
    "however , because of the complexity of the modeled processes and a need for high precision , researchers using statistical emulation for engineering processes are seldom content with a single additive regression structure for the entire input space .",
    "moreover , the consideration of interaction terms in additive models can require huge , overcomplete bases , typically leading to burdensome computation . as a result ,",
    "it is more common to rely on gp priors or other nonparametric regression techniques [ e.g. , @xcite , @xcite ] .",
    "however , such modeling significantly complicates the task of selecting relevant variables .",
    "although several approaches have been explored in recent literature [ e.g. , @xcite , @xcite , @xcite , and references therein ] , their complexity seems to have precluded the release of software for use by practitioners .",
    "an interesting middle ground is considered by @xcite , who propose an additive model comprising univariate functions of each predictor and bivariate functions for all interactive pairs .",
    "each is given a gp prior , and there is a catch - all ( higher interactions ) remainder term .",
    "this extends previous work wherein @xmath140-splines were proposed for a similar task [ e.g. , @xcite ] .",
    "stochastic - search variable selection [ ssvs , @xcite ] is used for selecting main effects and interactions . although perhaps more straightforward than performing ssvs directly on the lengthscale parameters of a gp [ @xcite ] , this approach has the added computational complexity of inverting many @xmath141 covariance matrices .    instead of a dedicated variable selection procedure ,",
    "engineering simulators typically employ some form of input sensitivity analysis .",
    "classically , as in examples from @xcite , @xcite , running the computer code to obtain a response is presumed to be cheap . when it is expensive , one must emulate the code with an estimated probability model [ see @xcite for an overview ] . in turn",
    ", researchers have proposed a variety of schemes for extension of classic sensitivity analysis to account for response surface uncertainty .",
    "gps , because of their role as the canonical choice for modeling computer experiments , are combined with sensitivity analysis in applications [ e.g. , @xcite ] .",
    "however , the associated methodology is usually based on restrictive stationarity and homoskedasticity assumptions needed to derive either empirical bayes [ @xcite ] or fully bayesian [ @xcite ] estimates of sensitivity indices .",
    "notable exceptions are presented by @xcite and @xcite . in the former , approximate bootstrap confidence intervals",
    "are derived for sensitivity indices based on a nonparametrically modeled response surface . in the latter , variability integration embedded within mcmc simulation yields samples from sensitivity indices full posterior distribution ; a similar idea forms the basis for our framework in section  [ secsa ] .",
    "partition trees [ e.g. , cart : @xcite ] provide a basis for regression that has both a simplicity amenable to selecting variables and the flexibility required for modeling computer experiments . furthermore , partition trees overcome some well - known drawbacks of the more commonly applied gp computer emulators : expensive @xmath142 matrix inversion , involving special consideration for categorical predictors and responses and allowing for the possibility of nonstationarity in the response or heteroskedastic errors .",
    "@xcite provide extensive background on general tree - based regression and argue for its wider adoption in engineering applications . in the context of this",
    "paper s goals , trees present a unique , nonadditive foundation for determining variable relevance . in their simplest form , with constant mean response at the tree leaves , variable selection is automatic : if a variable is never used to define a tree partition , it has been effectively removed from the regression . indeed , this idea motivated some of the earliest work on the use of trees , as presented by @xcite , for automatic interaction detection . in a more nuanced approach ,",
    "@xcite introduce indices of variable importance that measure squared error reduction due to tree - splits defined on each covariate . @xcite",
    "[ htf ; ( @xcite ) , chapter  10 ] promote these indices for sensitivity analysis and describe how the approach can be extended for their boosted trees .",
    "however , these techniques are purely algorithmic and lack a full probability model , hence , their use is especially problematic in analysis of computer experiments , where uncertainty quantification is often a primary objective .",
    "moreover , the htf importance indices are only point estimates of the underlying sensitivity metrics , thus , they preclude basing the variable selection criteria on posterior evidence and make it difficult to properly deduce and interpret just how each variable is contributing .",
    "researchers have attempted to overcome some of these shortcomings through the use of bayesian inference , most recently in schemes that augment the tree model to allow for better control or flexibility .",
    "@xcite describe a bayesian additive regression tree ( bart ) model , and their ` bayestree ` software includes a direct analogue of the htf importance indices ; and the method of @xcite is implemented in ` tgp ` [ see @xcite , section  3 ] .",
    "here , we derive the variance integrals from ( [ eqredvar ] ) for a model with linear leaves . dropping the node subscript ( @xmath15 , @xmath39 , or @xmath40 ) , we have @xmath143 \\\\[-8pt ] \\nonumber & = & \\frac{s^2 - \\mathcal{r}}{n - p-1 } \\biggl(|a| \\biggl(1 + \\frac{1}{n } \\biggr ) + \\int _ a { \\mathbf{x}}^\\top \\mathcal{g}^{-1 } { \\mathbf{x } } \\,d{\\mathbf{x } } \\biggr ) , \\nonumber\\end{aligned}\\ ] ] where @xmath144 is the sum of squares , @xmath145 is the regression sum of squares , @xmath146 is the number of @xmath147 pairs , @xmath148 is the gram matrix , and @xmath149 is the area of the rectangle . the remaining integral is just a sum of polynomials : with the intervals outlining the rectangle given by @xmath150 and @xmath151 the components of @xmath152 , @xmath153 & = & \\sum_{i=1}^p \\frac{g_{ii}}{3 } \\bigl(b_i^3 - a_i^3\\bigr ) \\prod _ { k\\ne i } ( b_k - a_k ) \\nonumber \\\\[-9pt ] \\\\[-9pt ] \\nonumber & & { } + 2 \\sum _ { i=1}^p \\sum_{j > i } \\frac{g_{ij}}{4}\\bigl(b_i^2 - a_i^2 \\bigr ) \\bigl(b_j^2 - a_j^2\\bigr ) \\prod_{k",
    "\\ne i , j } ( b_k - a_k ) \\\\[-2pt ] & = & |a| \\biggl ( \\sum _ { i=1}^p \\frac{g_{ii}(b_i^3 - a_i^3)}{3   ( b_i - a_i ) } + \\sum _ { i=1}^p \\sum_{j > i } \\frac{g_{ij } ( b_i+ a_i)(b_j+a_j)}{2 } \\biggr ) . \\nonumber\\end{aligned}\\ ] ]",
    "we are grateful to prasanna balaprakash for providing the data from [ @xcite ] .",
    "many thanks to the editor , associate editor , and two referees for their valuable comments , which led to many improvements ."
  ],
  "abstract_text": [
    "<S> we investigate an application in the automatic tuning of computer codes , an area of research that has come to prominence alongside the recent rise of distributed scientific processing and heterogeneity in high - performance computing environments . here , the response function is nonlinear and noisy and may not be smooth or stationary . clearly needed are variable selection , decomposition of influence , and analysis of main and secondary effects for both real - valued and binary inputs and outputs . </S>",
    "<S> our contribution is a novel set of tools for variable selection and sensitivity analysis based on the recently proposed _ </S>",
    "<S> dynamic tree _ model . </S>",
    "<S> we argue that this approach is uniquely well suited to the demands of our motivating example . in illustrations on benchmark data sets , </S>",
    "<S> we show that the new techniques are faster and offer richer feature sets than do similar approaches in the static tree and computer experiment literature . </S>",
    "<S> we apply the methods in code - tuning optimization , examination of a cold - cache effect , and detection of transformation errors .    , </S>"
  ]
}