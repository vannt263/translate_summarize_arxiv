{
  "article_text": [
    "active noise control ( anc ) can help in reducing broadband random noises such as road noise inside cars ( see _ e.g. _ refs .",
    "@xmath213@xmath3 ) , fan noise travelling in ducts ( ref .",
    "@xcite ) or noise induced by the boundary - layer pressure fluctuations around aircraft fuselages ( refs .  @xmath256@xmath3 ) .",
    "however , in the broadband random case , the noise arriving at the minimization microphones is mostly unpredictable , and the constraint of causality , which applies to the control filters , can restrain the performances of anc ( cf .  ref .",
    "@xcite ) . therefore ,",
    "in practice , anc set - ups often rely on feedforward control which involves one or several reference sensors detecting the incoming noise before it reaches the minimization microphones . in the single - channel case of noise travelling along one direction , the constraint of causality is easy to interpret in terms of acoustic propagation : the primary noise must be detected before it reaches the minimization sensor , with a time advance larger than the propagation time from the control source to the minimization microphone .",
    "the time advance must also compensate the electrical and computation delays in the control processing unit .",
    "however , in more complex cases , it is not easy to link the causality constraint to propagation delays .",
    "indeed , no design rule guarantees the causality of perfect noise cancellation without effective computation of the optimal control filters .    in this context",
    ", this paper shows that perfect noise cancellation can require control filters with an infinite non - causal response , which means that perfect feedforward control can require the detection of the incoming noise with an infinite time advance .",
    "analytical computations on simple anc set - ups show that this infinite non - causality is the theoretical result of two mechanisms : in the single - channel case of one control source and one minimization microphone , it is the consequence of strong echoes in the secondary path . in the multi - channel case , it can arise even in free field because of an unfortunate geometrical arrangement of the actuators and sensors . in the paper ,",
    "the performance of causally - constrained anc is also investigated through numerical computations .",
    "it is shown that , in practice , achieving a significant noise attenuation can require the detection of the incoming noise with a very large time advance .",
    "the study presented in this paper was motivated by the unexpected difficulties encountered when implementing multi - channel broadband anc in a large room at lma .",
    "although many successful experiments of random noise control in enclosures had been reported ( see _ e.g. _ refs .",
    "@xcite and @xcite ) , it appeared that efficient control in the lma room required feeding the reference signal to the control unit with a time advance of several seconds ( see ref .",
    "previous papers have reported that the response of optimal control filters could include a very long non - causal component ( _ e.g. _ in refs .",
    "@xcite , @xcite and @xcite ) , but , although a link between non - minimum phase responses and reverberation had been observed earlier ( see ref .",
    "@xcite ) , this has been seen in the context of anc as a purely algebraic problem .",
    "the present paper is an attempt to give an acoustic interpretation of control non - causality in order to derive design guidelines for anc set - ups .    in section  [ sec:1x1 ] of this paper ,",
    "the causality of anc is studied in the single - channel case . after recalling the case of noise cancellation in an infinite duct",
    ", it is shown that one echo in the secondary path can lead to infinitely non - causal control .",
    "optimal non - causal control and causally - constrained control are then derived for the case of a single monopole source and a single pressure microphone in the corner of two rigid walls .",
    "numerical simulations in the frequency and time domain show that , in some cases , the incoming primary noise must be detected with a very large time advance for efficient control .",
    "finally it is shown that a slight change in the actuator and sensor locations can relax the causality constraint , which suggests guidelines for the design of anc set - ups not prone to infinite non - causality .    in section  [ sec:2x2 ]",
    ", anc causality is investigated in the multi - channel case .",
    "optimal non - causal control is derived analytically for a free - field set - up including two monopole sources and two microphones , and some arrangements are shown to lead to infinitely non - causal noise cancellation .",
    "the performance of causally - constrained control is evaluated through numerical simulations involving a filtered - reference least mean square ( fxlms ) algorithm . in this 2x2 case",
    "it is shown that non - causality is critical when the condition number of the matrix of secondary paths is high at low - frequency .",
    "the inversion of acoustic paths , which is required for real - time anc , is also needed in devices for `` virtual acoustics '' which aim at a sound reproduction conveying accurate information such as the location of the recorded noise sources ( see ref .",
    "since sound reproduction is not a real - time process , the non - causality arising from the acoustic path inversion is usually not critical .",
    "however this paper shows that care must be taken for this inversion , even in the context of virtual acoustics , because the additional advance required for causal inversion can be much larger than the delays in the direct path .",
    "figure  [ fig : feedforward_set - up ] displays a standard feedforward set - up for cancellation of random noise travelling at low - frequency in a duct ( see ref .",
    "the duct is assumed to be rigid and either infinite or with anechoic terminations .",
    "a directional microphone detects the incoming noise ( and not the secondary noise from the control source ) .",
    "an adaptive controller @xmath4 filters this reference signal to generate appropriate input @xmath5 at the control source to minimize noise at the error sensor . below the first cut - off frequency of the duct",
    ", the noise @xmath6 at the error sensor can be ideally written in the frequency domain as the sum of the primary and secondary noises : @xmath7 where @xmath8 is the speed of sound , @xmath9 the air density , @xmath10 the cross - sectional area of the duct and @xmath11 the loudspeaker volume velocity .",
    "if the loudspeaker dynamics is neglected so that @xmath11 is directly the output of the control filter , the noise @xmath6 at the error sensor will be cancelled if : @xmath12 it appears that the volume velocity @xmath11 which cancels noise is the causal filtering of the signal @xmath13 if the reference sensor is located _ upstream _ of the loudspeaker ( i.e. @xmath14 ) . in practice",
    "however the secondary path @xmath15 , which has to be inverted for perfect control , includes the dynamics of the loudspeaker and the delays inherent to anti - aliasing and reconstruction filters in a digital adaptive controller .",
    "the detection sensor must therefore be located further upstream in order to provide a reference signal with an advance larger than the _ overall _ delay in the secondary path .",
    "the purpose of this paper is to show that this classical result , which can be found in the textbooks on anc ( cf .",
    "@xcite ) , does not apply to single - channel cases involving noise reflections nor to multi - channel cases even in free field : sometimes the detection sensor must provide a reference signal with an infinite advance for perfect control .",
    "in this section it is supposed that the transfer function @xmath15 between the control source and the error signal is the sum of direct propagation , with delay @xmath16 and arbitrary magnitude @xmath17 , and of one echo with delay @xmath18 ( @xmath19 ) and complex magnitude @xmath20 resulting from one ( possibly non - rigid ) acoustic reflexion or from the combination of several reflexions arriving simultaneously at the error sensor : @xmath21 if the direct sound is louder than the echo ( @xmath22 ) , the inverse of the transfer function @xmath23 can be expanded as : @xmath24\\ ] ] therefore , in the time domain , @xmath23 has an infinite impulse response including a non - causal part with finite length @xmath16 . as in the infinite duct case , the optimal control filter @xmath25 will be fully causal if the transfer function @xmath26 from the reference sensor to the error sensor includes a delay larger than the propagation time from the control source to the error sensor . when the primary noise is a pulse , the infinite time length of @xmath23 can be interpreted in a similar way to that applicable to cross - talk cancellation ( cf .",
    "@xcite ) : the expansion in ( [ causal ] ) shows that the primary noise is cancelled by the direct sound resulting from a pulse in the control source , and that the echo of the control pulse is in turn cancelled by the direct sound of a second control pulse ; and so on ( the echo of the @xmath27 control pulse is cancelled by the direct sound of a @xmath28 control pulse ) .",
    "since the direct sound is louder than its echo , an infinite but converging series of pulses is required to achieve perfect cancellation .",
    "however the echo can be _ louder _ than the direct sound ( @xmath29 ) .",
    "this may seem unlikely at first sight but a simple acoustic set - up with this feature is shown in section [ sec : corner ] .",
    "the inverse transfer function @xmath23 can then be expanded as : @xmath30\\ ] ] in this case it appears that @xmath23 has an infinite non - causal response , such that causal noise cancellation requires detection of the primary noise with an infinite time advance . with a pulse as primary noise , the theoretical non - causality of control can be interpreted from the expansion in ( [ eqn : serie ] ) : the primary noise is cancelled by the echo of a counter - pulse in the control source , and the direct sound of this counter - pulse is pre - cancelled by the echo of a previous pulse , and so on . in the end an infinite converging series of control pulses in the past is required for noise cancellation of a single primary pulse .",
    "the simple analysis above shows that anc is infinitely non - causal as soon as the echo is louder than the direct sound in the response",
    ". however equation ( [ eqn : serie ] ) also demonstrates that , if the echo is _ very much _ louder , coefficient @xmath20 is large and the series in ( [ eqn : serie ] ) converges quickly . in this case the non - causal terms for large negative times may be neglected . eventually control may be critically non - causal especially when the echo is slightly louder than the direct sound .",
    "figure [ fig : coinjsv ] shows an anc set - up where the secondary path includes an echo louder than the direct sound : two infinite rigid planes define in 3d a corner with a directional detection sensor , an omnidirectional error sensor and a control source in the bisecting plane . with the notations from figure [ fig : coinjsv ] and if the control source can be seen as a 3d monopole , which is the case of a loudspeaker at low frequency , the secondary transfer function @xmath15 from the loudspeaker volume acceleration @xmath31 to the error signal @xmath6 can be computed by taking image sources into account : @xmath32\\ ] ] with @xmath33 , @xmath34 and @xmath35 .",
    "if @xmath36 is less than @xmath37 then the first echo in the secondary path is louder than the direct path .",
    "it can be shown that this condition amounts to @xmath38 .",
    "figure [ fig : second_path_freq ] displays the secondary path as a function of frequency when @xmath39s , @xmath40 m and @xmath41 m ( in fact these distances have been slightly adjusted in the subsequent numerical simulations so that noise propagation over @xmath42 and @xmath43 takes an integer number of samples ) .",
    "figure [ fig : second_path_time ] displays the corresponding exact impulse response and its digital approximation computed by inverse fast fourier transform for a sampling frequency of @xmath44 and a frequency resolution of @xmath45 .",
    "when the incoming primary noise is a plane wave propagating along the bisecting plane , as sketched in figure [ fig : coinjsv ] , the transfer function @xmath26 from the directional reference sensor ( detecting the incident plane wave only ) to the omnidirectional error sensor ( detecting the incident _ and _ reflected waves ) is given for the primary noise by : @xmath46 in this equation @xmath47 denotes the distance between the reference sensor and the error sensor , as shown in figure [ fig : coinjsv ] . without taking the dynamics of a real loudspeaker into account , perfect noise cancellation at the error sensor will be achieved if the input to the control source is equal to the reference signal filtered by the optimal filter @xmath4 : @xmath48 with two echoes in the secondary path , no series expansion similar to that of equation ( [ eqn : serie ] ) can easily express the causality of the optimal control filter @xmath4 .",
    "however the impulse response of @xmath4 can be computed numerically by ifft .",
    "figure  [ fig : opt_temp ] displays the impulse response of @xmath4 when @xmath49 m for a sampling frequency of @xmath44 and a frequency resolution of @xmath50 . in the case without reflections , @xmath51 would have enforced the control causality but , in the corner , the response includes a very long non - causal component , with significant coefficients at negative times much larger than any propagation time between the elements of the set - up in figure [ fig : coinjsv ] .",
    "this means that noise cancellation could be achieved only by moving the detection sensor far away from the corner ( i.e. by enforcing @xmath52 ) , which may not be possible in practice ( e.g. if the primary noise source is not far away ) .      in the previous section it has been shown that _",
    "perfect _ noise cancellation can require very long non - causal filters .",
    "in practice however , the aim of anc is only to provide _ significant _ noise attenuation . to this intent",
    "the performance of causal control must be determined as a function of the advance with which the reference signal is provided to the feedforward controller .    as a first try",
    ", the quantitative effect of the causality constraint can be assessed by computing the noise attenuation achieved with the causal control filter obtained discarding the non - causal coefficients in the time response of the optimal filter . for the set - up shown in figure [ fig : coinjsv ] with @xmath40 m and @xmath41 m , figure [ fig : atten_tronq ]",
    "displays the noise attenuation achieved with this causally - truncated filter , when @xmath49 m , @xmath53 m and @xmath54 m , which amounts to providing the reference signal with an advance of respectively @xmath55s , @xmath56s and @xmath57s .",
    "figure [ fig : atten_tronq ] shows that a huge advance in the reference signal is required to achieve substantial active noise reduction with a causally - truncated control filter .",
    "however the causal truncation of the non - causal optimal control filter is _ not _ the optimal causally - constrained control filter .",
    "the causality constraint does not restrain the control performance as much as figure [ fig : atten_tronq ] suggests .",
    "the optimal causal filter depends on the predictability of the primary noise .",
    "following ref .",
    "@xcite , it can be written in the case of white noise as : @xmath58 where @xmath59 is the factorization of the secondary path frf @xmath15 into minimum - phase and all - pass components @xmath60 and @xmath61 , and @xmath62 means that the non - causal component of the quantity enclosed by the braces is discarded . as in the previous section , @xmath26 denotes the transfer function from the detection sensor to the error sensor for the primary noise and @xmath15 the secondary path transfer function .",
    "figure [ fig : atten_opt_caus ] displays the noise attenuation achieved with the causally - constrained optimal control filter when the reference signal is provided with an advance of @xmath55s , @xmath63s and @xmath56s , which amounts respectively to @xmath49 m , @xmath64 m and @xmath53 m . for this figure",
    "the factorization of @xmath15 into minimum - phase and all - pass components was performed in the frequency domain with the complex - cepstrum method ( cf .",
    "@xcite ) . for a given advance in the reference",
    ", the optimal causal filter performs much better than the causally truncated non - causal filters : with a @xmath56s advance , optimal causal control leads to a large noise reduction as in the case of causally - truncated non - causal control with a @xmath57s advance .",
    "however the reference signal must still be provided with a very large advance for efficient control .",
    "figure [ fig : opt_caus_temp ] displays the impulse response of the causal filter for @xmath49 m and @xmath53 m . for @xmath49 m it shows that the optimal causal filter is very different from the causal truncation of the optimal non - causal controller , but for @xmath53 m it confirms that , with a very large advance in the reference , the response is close to the time - shifted response of the optimal non - causal controller ( displayed in figure [ fig : opt_temp ] ) .    in practice",
    "anc implementations very often rely on adaptive transverse control filters whose coefficients are optimized recursively in the time - domain with the filtered - reference(x ) least - mean square algorithm ( cf . ref .",
    "@xcite ) . figure",
    "[ fig : atten_fxlms_aver ] displays the noise attenuation achieved with a 1024-tap control filter continuously updated with an fxlms algorithm for @xmath49 m , @xmath64 m and @xmath65 m , and primary white noise .",
    "the propagation time over @xmath65 m corresponds to the whole length of the control filter impulse response .",
    "the fxlms converged very slowly for these results . even after selecting the best convergence coefficient , several seconds",
    "were typically required before achieving noise attenuation , and leakage ( cf .",
    "@xcite ) did not improve convergence . for @xmath64 m",
    "the attenuation is of the same order of magnitude as for the optimal causal filter computed in the frequency domain .",
    "the zeroes in the attenuation are at the same frequency as the zeroes of the secondary path @xmath15 or of the reference signal spectrum @xmath66 . at these frequencies",
    "the fxlms converges with difficulties ( cf .",
    "it could be expected that detecting the reference signal at a distance larger than @xmath64 m improve control performance , as for the causally - constrained filters derived in the frequency - domain .",
    "however the poor result shown in figure [ fig : atten_fxlms_aver ] for @xmath65 m means that the optimum advance of the reference signal does depend on the length of the filter response in the case of fxlms control ; the best control performance is not achieved with the largest pre - delay when the control filter impulse response is too short .",
    "figure [ fig : fxlms_temp ] shows the impulse response of a fir control filter obtained when the adaptation process is frozen after minimization of the error signal .",
    "figure [ fig : atten_fxlms_froz ] displays the noise attenuation theoretically achieved with this specific control filter . the computation is performed in the frequency domain for purely white primary noise .",
    "the attenuation for @xmath64 m is clearly worse than the attenuation displayed in figure [ fig : atten_fxlms_aver ] for a continuously adapting control filter .",
    "therefore the permanent adaptation of the control filter helps in ensuring good performance of fxlms control , even after the residual error has apparently converged ; a linear control fir filter with permanent coefficient adaptation is in fact a non - linear control filter which sometimes performs much better than any stationary linear control filter ( see ref .",
    "@xcite ) .",
    "the series expansion in equation  ( [ eqn : serie ] ) suggests that control is critically non - causal when the echo in the secondary path response is only slightly louder than the direct sound .",
    "for the set - up of figure [ fig : coinjsv ] the first echo is as loud as the direct sound if @xmath67 . with @xmath41",
    "m this limit amounts to @xmath68 m , which is close to the value @xmath40 m chosen for the numerical simulations .",
    "figure [ fig : coin_moins_loin ] displays the impulse response of the non - causal optimal filter @xmath69 for @xmath70 m . the control filter has a very long response with only a relatively short ( but non - zero ) non - causal component .",
    "figure [ fig : coin_plus_loin ] displays the impulse response for @xmath71 m . in this case",
    "the non - causal response decays more rapidly than for the case @xmath40 m . these figures show that a small change in length @xmath42 can dramatically affect the causality of optimal control .",
    "control is highly non - causal only for the values of @xmath42 which lead to a first echo slightly louder than the direct sound .    in practice anc",
    "set - ups often involve secondary paths with complicated time response including many echoes .",
    "it is not easy to detect without measurements if a given set - up gives rise to non - causality because of reflections , even if , as the previous simulations suggest , this will be critical only for very specific arrangements .",
    "one simple step towards preventing infinite non - causality in the single - channel case with reflections is to move the control source and the error sensor as close as possible to each other . in this way the direct sound",
    "is maximized . furthermore reducing delays in the secondary path",
    "improves the convergence of adaptive algorithms such as the fxlms ( cf . ref .",
    "however in practice other constraints may impose a minimum distance in the secondary path .",
    "for example the error sensor must usually be in the far - field of the control source to achieve noise reduction over more than a very narrow area . in the end infinite non - causality",
    "must be remembered as a theoretical possibility in active control of broadband noise .",
    "figure  [ fig:2 - 2set - upjsv ] shows a set - up for anc in free field with two secondary sources and two omnidirectional minimization microphones .",
    "the incoming primary noise is assumed to be a plane wave .",
    "the loudspeakers are idealized as monopoles with volume accelerations @xmath72 and @xmath73 .",
    "the microphone # 1 is taken as the reference sensor for feedforward control . the feedback from the control sources to the reference signal @xmath13 will not be considered in the derivation of optimal control . in practice",
    "this can be done if the controller has an internal model control structure including cancellation of the feedback path ( see ref .",
    "it is also assumed that the output control filters @xmath74 , @xmath75 with input @xmath13 are directly the volume accelerations @xmath72 , @xmath73 of the control sources , the dynamics of the loudspeakers is not taken into account .    with the notations from figure  [ fig:2 - 2set - upjsv ] and with @xmath76",
    ", the total noises @xmath77 , @xmath78 at the minimization microphones can be written as : @xmath79 = \\ ; \\left [      \\begin{array}{c } 1\\\\ e^{-jkd_5\\cos\\theta}\\end{array } \\right ] x + \\frac{\\rho_0}{4\\pi}\\;\\ \\left [       \\begin{array}{cc }           \\frac{e^{-jkd_1}}{d_1 } & \\frac{e^{-jkd_2}}{d_2}\\\\          \\frac{e^{-jkd_3}}{d_3 } & \\frac{e^{-jkd_4}}{d_4 }       \\end{array } \\right ] \\left [   \\begin{array}{c } w_1\\\\w_2 \\end{array } \\right ] x\\ ] ] noise can be cancelled at both error sensors and at all frequencies if @xmath80 .",
    "the optimum control filters @xmath74 , @xmath75 are then given by : @xmath81   = -\\;\\frac{4\\pi}{\\rho_0}\\;\\frac{d_1 d_2 d_3 d_4}{d_2d_3 e^{-jk(d1+d4)}-d_1d_4e^{-jk(d2+d3 ) } }   \\left [       \\begin{array}{cc }           \\frac{e^{-jkd_4}}{d_4 } & -\\frac{e^{-jkd_2}}{d_2}\\\\          -\\frac{e^{-jkd_3}}{d_3 } & \\frac{e^{-jkd_1}}{d_1 }       \\end{array } \\right ] \\left [   \\begin{array}{c } 1\\\\e^{-jkd_5\\cos\\theta } \\end{array } \\right]\\ ] ] it can be assumed , without loss of generality because the indexes can be switched , that @xmath82 . after introducing @xmath83 and",
    "@xmath84 , equation ( [ eqn : optimal ] ) can be re - written and expanded as : @xmath85 = -\\;\\frac{4\\pi d_1 d_4}{\\rho_0 } & & \\!\\!\\!\\!\\!\\!\\left ( 1 + \\alpha e^{-jkd } -\\alpha^2 e^{-j2kd } + \\ldots\\right ) \\nonumber \\\\   & & \\left [       \\begin{array}{cc }           \\frac{e^{jkd_1}}{d_4 } & -\\frac{e^{jk(d_1+d_4-d_2)}}{d_2}\\\\          -\\frac{e^{jk(d_1+d_4-d_3)}}{d_3 } & \\frac{e^{jkd_4}}{d_1 }       \\end{array } \\right ] \\left [   \\begin{array}{c } 1\\\\e^{-jkd_5\\cos\\theta } \\end{array } \\right]\\end{aligned}\\ ] ] the causality of perfect noise cancellation can be discussed from this expression .",
    "firstly , @xmath86 is a time delay if @xmath87 , that is if the primary noise is impinging the reference microphone before all the minimization microphones . in the opposite case",
    "@xmath86 denotes a finite time advance equal to the propagation time of the primary noise between the reference microphone and the minimization microphones which receives it first .",
    "secondly , the matrix in equation ( [ eqn : optimal3 ] ) includes finite time advances . if @xmath88 one has @xmath89 and @xmath90 , which means that these time advances are always smaller than the largest propagation time in the secondary path . in this case where @xmath88 , the series expansion in equation ( [ eqn : optimal3 ] ) will also be fully causal .",
    "therefore , if @xmath88 , the single - channel result without reflections of section [ sec : duct ] generalizes : noise cancellation is causal if the incoming primary noise is detected before it impinges the first minimization microphone , with a time advance larger than the largest propagation time in the secondary path . however , if @xmath91 , the series expansion in equation ( [ eqn : optimal3 ] ) gives rise to an infinitely - long non - causal impulse response for optimal control . this can occur indeed , for example in the case @xmath92 m , @xmath93 m , and @xmath94 m . by inspecting the case @xmath95",
    ", it finally appears that noise cancellation will be infinitely non - causal in the general case if : @xmath96    figure  [ fig:4cases ] displays four arrangements with increasing distances @xmath97 and @xmath98 . at first sight",
    "it is not easy to detect significant differences between the arrangements but , according to equation  ( [ criterion ] ) , the arrangements of figure  [ fig:4cases](a ) and [ fig:4cases](b ) lead to infinitely non - causal noise cancellation .",
    "figure [ fig : rep4cases ] displays the impulse responses of the optimal control filters , computed by ifft with a sampling frequency of 16384hz , when the primary noise is a plane wave with incidence angle @xmath99 .",
    "the response for case  [ fig:4cases](a ) is non - causal but it decays rapidly for negative times .",
    "case  [ fig:4cases](b ) leads to a very long non - causal response , which illustrates the non - causality of the series in equation  [ eqn : optimal3 ] .",
    "the response for case  [ fig:4cases](c ) has a finite short - length non - causal component but the causal component is very long , which would be a problem for practical implementation , whereas the response for case  [ fig:4cases](d ) should pose no problem in practice .    the criterion given in equation  [ criterion ]",
    "can be interpreted by considering active control in the 2x2 case as the combination of control with two individual single - channel devices and of cross - talk cancellation .",
    "firstly , parameter @xmath100 can be seen as the averaged magnitude of the cross - talk at the minimization sensors .",
    "it quantifies the average ratio between the `` direct '' sound received by each of the sensor by the corresponding single - channel source and the `` cross - talk '' sound coming from the other source ; if the arrangement of sensors and actuators is fully symmetric ( _ i.e. _ @xmath101 and @xmath102 ) , @xmath20 exactly measures this ratio at the two sensors .",
    "secondly , parameter @xmath103 measures the averaged difference between the times of arrival of the `` direct '' and `` cross - talk '' sounds at the minimization microphones . if @xmath104 and @xmath88 , in average the `` direct '' sound is louder than the cross - talk and it reaches the minimization microphone before . if @xmath104 and @xmath91 , the cross - talk is not louder but it has to be cancelled before the direct sound , which requires an infinitely long non - causal response .",
    "if @xmath105 , the indexes of the sources can be switched for interpretation but , alternatively , the cross - talk can be seen as an echo louder than the direct sound if @xmath88 , and the discussion of section [ one reflection ] on control of an echo louder than the direct sound applies .",
    "although there is no acoustic reflection in the free - field set - up of figure  [ fig:2 - 2set - upjsv ] , the cross - talk can eventually be seen as an echo whose control implies non - causality if it is louder than the direct noise , as in the single - channel case with reflections .",
    "figure  [ fig : atten_tronq2x2 ] displays the noise attenuation achieved with causally - truncated control for the arrangement of figure  [ fig:4cases](b ) . for these simulations in the frequency domain , the reference signal was fed to the controller with the additional time advances @xmath106ms , @xmath107s and @xmath108s .",
    "figure  [ fig : atten_tronq2x2 ] shows that very large advances are required for large attenuations .",
    "the finite advance @xmath109 is the minimum advance required for the secondary noise to reach all the minimization microphones before the primary noise ; it compensates the finite time advances which appear in equation  ( [ eqn : optimal3 ] ) . if optimal control were not infinitely non - causal , this finite time advance would be large enough for optimal control to be perfectly causal , and an infinite noise attenuation should be achieved .",
    "the very poor attenuation shown in figure  [ fig : atten_tronq2x2 ] for @xmath109 illustrates the dramatic effect of non - causality upon control performances . in figure  [ fig : atten_tronq2x2 ]",
    "the noise attenuation is higher at minimization microphone  # 2 because of the propagation time of the primary noise between the two microphones , which is extra time for causal control .    in the multi - channel stationary case",
    ", the optimal causally - constrained control filter can be written as in equation  ( [ eq : opt - caus ] ) as a function of the minimum - phase and all - pass components of the matrix of secondary paths  @xcite . however , spectral factorization , which is an intermediate step in computing the optimal controller , is considerably more difficult to perform numerically in the multi - channel case than in the single - channel case ( cf .",
    "@xcite ) . instead ,",
    "in the context of active control , it is more efficient to compute sub - optimal controllers using adaptive algorithms in the time - domain .",
    "figure  [ fig : atten_fxlms_aver2x2 ] displays the noise attenuation achieved with a 1024-tap control filter continuously updated with an fxlms algorithm , for several additional advances @xmath110 in the reference signal .",
    "the fxlms took several seconds to converge to the results shown in figure  [ fig : atten_fxlms_aver2x2 ] . for @xmath111ms ,",
    "control performs poorly and the noise is not reduced at all at microphone  # 1 . for @xmath112ms",
    "some noise reduction is achieved at the two minimization microphones . however , in this case , the noise reduction is low at some frequencies ; it can be checked that the matrix of secondary paths is poorly conditioned at these frequencies , which is known as slowing down the convergence of the fxlms algorithm ( see  ref .",
    "@xcite ) . finally , the noise reduction is poor again for @xmath113ms . as in section",
    "[ sec : optcaus ] for the single - channel case , this shows that , when optimal control is largely non - causal , the performance of active noise control using a relatively short - length fir filter depends strongly on the timing with which the incoming noise is detected .",
    "in section [ precautions ] it was shown that , in the single - channel case , non - causality was especially critical for arrangements where a slight change in the geometry would change the control filter with a non - causal response into a control filter with a long causal response .",
    "for the multichannel case of figure  [ fig:2 - 2set - upjsv ] , the series in equation ( [ eqn : optimal3 ] ) shows that the filter impulse response is long when @xmath114 , which means that the secondary path @xmath115 is close to a singular matrix at all frequencies .",
    "therefore , in more complicated cases , the condition number of the secondary path matrix at low - frequency may be an indicator of possible non - causality .",
    "figure  [ fig : conditionnement ] displays the condition number at low - frequency ( _ i.e. _ for @xmath116 ) of the secondary path matrix @xmath115 , as a function of parameter @xmath97 when @xmath117 m and @xmath94 m .",
    "the vertical lines in the plot delimit the values of @xmath97 for which control is infinitely non - causal according to equation  ( [ criterion ] ) .",
    "the four cases shown in figures  [ fig:4cases ] and [ fig : rep4cases ] are marked out by stars in figure  [ fig : conditionnement ] .",
    "it appears that very long non - causal impulse responses were obtained for the control filters when the condition number of the secondary matrix was high . in this 2x2 case",
    ", good conditioning appears to be a protection from the critical non - causality arising from the inversion of the secondary path matrix .",
    "furthermore , for adaptive feedforward control , good conditioning of the secondary path is required for efficient convergence of the fxlms algorithm ( see ref .",
    "@xcite ) . in section [ precautions ] a connection",
    "was also made in the single - channel case with reflections between causality and fxlms convergence .",
    "from these two simple cases it may be inferred in practice that poor convergence of the fxlms algorithm may be the sign of optimal control non - causality .    as in the single - channel case , non - causality can be prevented in the case of figure  [ fig:2 - 2set - upjsv ] by bringing the loudspeakers and the error microphones in closer pairs . in this way",
    "the condition number of the secondary path matrix is reduced because the diagonal of the matrix is made dominant .",
    "regularization techniques can also be used to dampen the effect of poor matrix conditioning , e.g. by including a leakage coefficient in the fxlms adaptation formula ( see ref.@xcite ) .",
    "finally , the author believes that improving the condition number of the matrix of secondary paths also helps in preventing control non - causality in multi - channel set - ups involving more than two actuators and sensors .",
    "however , although non - causal set - ups with more channels can be built by adding sensor - actuator pairs to the set - up of figure  [ fig:4cases](b ) , a connection between causality and matrix condition number could not be made in the general multi - channel case .",
    "in this paper it has been shown that active cancellation of broadband noise can theoretically require control filters that include an infinitely non - causal impulse response . in the single - channel case",
    ", this can happen because of high - level sound reflections . in the multi - channel case",
    ", the analysis of a 2x2 set - up has shown that this can occur even in free field because of the algebraic inversion of the secondary path matrix required for perfect cancellation .",
    "the cross - talk cancellation in the multi - channel case can be seen as equivalent to the cancellation of primary noise echoes in the single - channel case .",
    "numerical simulations in the time and frequency domains have shown that , in practice , situations are possible where a significant noise reduction can not be achieved without detecting the incoming primary noise with an advance very much larger than the propagation time delays in the secondary path .",
    "the inverse of the secondary path , which can have an infinite non - causal response , is required not only for active noise cancellation but also for accurate reproduction of sound fields in applications such as `` virtual acoustic imaging '' ( see ref .",
    "@xcite ) . in these applications ,",
    "the computation of the inverse path need not be performed in real time , as is the case for anc , and a processing time can be afforded which reduces the consequences of non - causality .",
    "however , designers of virtual acoustics devices must be aware that inverse acoustic responses can include time advances very much larger than the propagation times or the reverberation time in the direct response .",
    "it is not easy to prevent a large non - causality of the inverse acoustic responses in practical complicated cases , especially in rooms with many resonant modes .",
    "the analysis of the single - channel case in a corner and of the 2x2 case in free field have shown that one possibility is to mount actuators and sensors in close pairs , so that sound reflections and cross - talk components have lower levels than the direct sounds .",
    "this approach also improves the rate of convergence of adaptive control algorithms such as the filtered - reference least mean squares .",
    "it also fits in with the current trend of designing anc devices which are decentralized , in order to reduce the complexity of systems with many channels .",
    "however the sensors must usually be in the far field of the actuators for global active control",
    ". therefore infinite non - causality can not always be prevented , and must be kept in mind as an ever possible limitation for active control of random noise .                        c. bordier , e. friot , m. winninger 2002 _ proceedings of cfa  2002 _ , lille , on cd - rom .",
    "contrle actif multivoies de bruits alatoires large bande dans un grand volume  : limitations physiques ( _ in french _ ) .",
    "figure [ fig : atten_opt_caus ] : noise attenuation with causally - constrained optimal control filters computed in the frequency domain ,  without additional advance in the reference signal , - - with a 31.25ms advance , ... with a 400ms advance .",
    "figure [ fig : opt_caus_temp ] : impulse response of causally - constrained optimal control filters computed in the frequency domain , ... without additional advance in the reference signal ,  with a 0.4s advance .",
    "figure [ fig : atten_fxlms_aver ] : noise attenuation with a 1024-coefficient control fir filter updated with an fxlms algorithm ,  without additional advance in the reference signal , - - with a 31.25ms advance , ... with a 62.5ms advance .",
    "figure [ fig : atten_fxlms_froz ] : noise attenuation with 1024-coefficient control fir filters frozen after minimization of the error signal ,  without additional advance in the reference signal , - - with a 31.25ms advance , ... with a 62.5ms advance .",
    "figure [ fig : atten_tronq2x2 ] : noise attenuation with causal truncation of optimal control filters ,  with an 8.24ms additional time advance in the reference signal , - - with a 1s advance , ... with a 2s advance .",
    "figure [ fig : atten_fxlms_aver2x2 ] : noise attenuation with a 1024-coefficient control fir filter updated with an fxlms algorithm ,  with an 8.24ms additional time advance in the reference signal , - - with a 31.25ms advance , ... with a 62.5ms advance .",
    "figure [ fig : conditionnement ] : condition number of the secondary path matrix at low - frequency as a function of geometric parameter @xmath97 , for @xmath94 m and @xmath117 m .",
    "the stars mark out the values corresponding to the arrangements diplayed in figure [ fig:4cases ] ."
  ],
  "abstract_text": [
    "<S> active cancellation of broadband random noise requires the detection of the incoming noise with some time advance . in an duct for example </S>",
    "<S> this advance must be larger than the delays in the secondary path from the control source to the error sensor . in this paper </S>",
    "<S> it is shown that , in some cases , the advance required for perfect noise cancellation is theoretically infinite because the inverse of the secondary path , which is required for control , can include an infinite non - causal response . </S>",
    "<S> this is shown to be the result of two mechanisms : in the single - channel case ( one control source and one error sensor ) , this can arise because of strong echoes in the control path . in the multi - channel case </S>",
    "<S> this can arise even in free field simply because of an unfortunate placing of sensors and actuators . in the present paper optimal feedforward control </S>",
    "<S> is derived through analytical and numerical computations , in the time and frequency domains . </S>",
    "<S> it is shown that , in practice , the advance required for significant noise attenuation can be much larger than the secondary path delays . </S>",
    "<S> practical rules are also suggested in order to prevent infinite non - causality from appearing .    </S>",
    "<S> infinite non - causality in active cancellation of random noise + emmanuel friot + cnrs - laboratoire de mcanique et dacoustique , + @xmath0 chemin joseph aiguier , @xmath1 marseille , france + e - mail : friot@lma.cnrs-mrs.fr + tel . : + 33 4 91 16 40 84 + fax : + 33 4 91 16 40 80 +   + 22 pages of text - 19 figures +   + </S>"
  ]
}