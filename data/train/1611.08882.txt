{
  "article_text": [
    "the ever - increasing size and sophistication of fpgas make them an ideal platform for high - scale system - on - chip integration .",
    "that said , this intrinsic sharing of the reconfigurable fabric also means that many different cores have the potential to affect each other , even when they are not directly connected to one another .",
    "this is because the operation of one circuit can cause subtle , yet measurable changes elsewhere on the device , through a variety of different mechanisms such as variations in power / ground voltage , capacitive or inductive coupling , etc .",
    "although potentially noisy , these effects can be used for side - channel communication .",
    "they can be leveraged intentionally , for example to implement a minimal - impact debugging tap or a no - contact watermark .",
    "these side - channel communication techniques also have important security implications if they cause information to leave an ip block unintentionally .",
    "for example , a core performing digital rights management likely contains sensitive encryption keys .",
    "thus , it is critical to identify and characterize different mechanisms and implementations of these kinds of information leaks . furthermore , testing on physical fpgas will allow us to understand the limits and potential risk .    in this paper",
    ", we investigate a side - channel communication mechanism that , to the best of our knowledge , has not been previously documented : that the value driven onto a long line influences the delay of other nearby long lines",
    ". that is , if a long line carries a logical 1 , the delay of nearby long lines will be slightly lower than when it carries a logical 0 . to demonstrate this phenomenon we build a simple transmitter / receiver pair .",
    "the transmitter consists of a long wire connecting a source lut and a sink lut .",
    "the receiver consists of three luts connected to form a ring oscillator ( ro ) , where one connection in the ro uses a long wire that is a neighbor of the transmitting long wire ( figure  [ fig : setup ] ) . when the transmitting long wire carries a logical 1 , the routing delay around the ro decreases , which results in a small increase in the ro frequency .",
    "we detect these minor differences in ro frequency by counting the number of signal changes that occur per unit time .",
    "we conduct extensive experiments on multiple xilinx prototyping boards and show that the phenomenon is location and device independent .",
    "we perform all tests in an uncontrolled physical environment and on stock prototyping boards ( i.e. , without modifications such as additional decoupling capacitors or improved voltage regulators ) .",
    "this indicates that the phenomemon can be detected even in the presence of environmental noise , which otherwise impacts ro frequency  @xcite .",
    "although we perform a variety of different experiments to characterize the behavior of this side - channel communication , we do not attempt to determine the precise electrical mechanism that causes it .",
    "that is , we have determined attributes such as when the phenomenon occurs , how strong the effect is , and how we might reduce noise in the transmission , but we have not attempted to determine if this is caused by ground bounce , capacitive coupling , etc .",
    "this is for two reasons .",
    "first , we have demonstrated this behavior on commerical fpgas and precisely determining the electrical cause would be very difficult without access to design information such as the physical layout and process - specific parameters .",
    "second , end - users of such devices can not change the physical design of the chips themselves .",
    "this is certainly true for existing devices already in the field and eliminating something such as localized power sag in new devices would likely require modifying the internal power distribution framework .",
    "rather , end - users can only change the placement and routing of their circuits .",
    "thus , characterization of the side - channel at this level is more pertinent .",
    "ring oscillator frequencies depend on process , voltage , and temperature ( pvt ) variations  @xcite , and this dependence makes them suitable for a range of applications from temperature sensing  @xcite , to side - channel receivers  @xcite .",
    "consequently , any mechanism which can be used to manipulate the frequency of ros can also be used to attack these applications .",
    "for instance , since ros are used as true random number generators ( trngs ) and physicaly uncloneable functions ( pufs ) , influencing the delays of ros by altering the power supply  @xcite or by injecting em signals  @xcite can result in low entropy and cloneability .",
    "one such mechanism that can affect the frequency of ros is crosstalk  @xcite , and delays and faults due to crosstalk can be estimated in a built - in or on - line fashion  @xcite .",
    "a switching pattern which follows the ro increases the ro s oscillation frequency by 1 - 9% compared to a pattern that opposes it , when the ro and transmitter circuits are in sync  @xcite . to achieve this synchronization",
    ", however , requires the transmitter to be connected to the output of one of the ro s stages . as a result ,",
    "as presented , this mechanism can not be used directly for side - channel communication or to reliably attack the ring oscillator , due to the high accuracy of prediction required for the frequency and phase of the oscillator .",
    "recently , more emphasis has been placed on using networks of ros to detect hardware trojans on a device  @xcite . the dynamic power consumed by hts results in a voltage drop that lowers the ro frequencies compared to the trojan - free  golden \" ic , making them detectable .",
    "our work is fundamentally different , not only because of the application domain , but because the phenomenon demonstrated decreases rather than increases ro delay and frequency .",
    "moreover , we demonstrate this phenomenon over both static and relatively slowly changing signals .",
    "prior work  @xcite has shown that static and slowing changing signals can be much more difficult to detect , requiring either very large circuits ( over 14k registers ) or long measurement times ( 2.5h ) , external measurement equipment , and special modifications to the device , including directly driving internal vdd pins , and turning off i / o and uart transmissions .    by contrast , we can distinguish between the values of signals which remain constant ( i.e. , have no switching activity ) during our period of measurement , which is as low as @xmath0 .",
    "this measurement period is also a lower yet unrealized bound for on - chip ht detection using ros  @xcite .",
    "our transmitter and receiver circuits can be implemented with a small handful of luts and wire segments , and measurements do not need external equipment or additional control over voltage or temperature conditions .",
    "in this section we describe two simple experiments , briefly demonstrating the observed phenomenon . by contrasting the two results",
    ", we motivate the choices we make for our experimental setup and the parameters that we control and test .",
    "these tests are described in greater detail in section  [ sec : setup ] .            in the most basic setup ,",
    "as shown in figure  [ fig : setup ] , we have a _ transmitting _ circuit , shown in blue , which consists of a long vertical wire , and is driven by a buffer lut ( the output mirrors the input ) .",
    "the long wire consists of one or more consecutive ` vlong ` segments , denoted with blue dots .",
    "this connection terminates at another buffer lut , the output of which is left unconnected , to minimize the amount of resources used .",
    "the _ receiving _ circuit , shown in red , is a three - stage ring oscillator .",
    "one of the ro connections uses ` vlong`s ( red squares ) that are adjacent to the transmitter s wire segments ( i.e. , in the same routing channel ) .",
    "the ring oscillator is connected to a counter , and every @xmath1 ticks of a 100mhz clock ( 21ms ) , the counter is sampled and reset . at each reset of the counter , the signal driving the transmitting circuit toggles from 0 to 1 , or vice versa .    in the first test ,",
    "both circuits use one ` vlong ` each .",
    "figure  [ fig : overview ] shows the ring oscillator counts @xmath2 on a virtex 5 device for 2048 sampling periods ( roughly 44 seconds ) .",
    "the ring oscillator counts when the transmitter carries a 1 ( red dots ) are relatively higher than the counts for a 0 ( blue x s ) , though the overall ring oscillator frequency drifts over time , likely due to variations in environmental conditions .",
    "figure  [ fig : l90 ] then repeats this experiment , but for circuits which use 5 ` vlong`s .",
    "we notice that the phenomenon is much more pronounced compared to the previous experiment , and the pattern is clearly distinguishable even despite local fluctuations .",
    "the mean and standard deviations of the ro counts for the two tests are shown in table  [ table : overview ] .",
    ".means @xmath3 and std .",
    "deviations @xmath4 for the two setups [ cols=\">,<,<,<,<,<\",options=\"header \" , ]     in this section , we describe two experiments to show that , for slowly changing signals , the phenomenon is solely dependent upon the values transmitted and not the pattern between consecutive values .",
    "as shown in figure  [ fig : timing ] , the previous experiments have all used a slowly alternating signal ( @xmath5 ) . in this experiment",
    ", we sample the ring oscillator at the same rate as before ( @xmath6 ) while greatly slowing down the alternation speed of the transmitted signal ( @xmath7 ) .",
    "rather than switching the transmitted signal every sample period , we now maintain the same value for 128 consecutive triggers  in essence , testing the effects of long sequences of zeros and ones .",
    "the results of this test are shown in the left of figure  [ fig : patterns ] . in the second experiment",
    "we transmit a pseudo - random pattern of zeros and ones by connecting a linear feedback shift register ( @xmath8 ) to the transmitter .",
    "the results of this test are shown in the right of figure  [ fig : patterns ] .    in both experiments ,",
    "the ro counter samples remain significantly higher when transmitting a one versus a zero . as shown in table  [",
    "table : pattern_counts ] , the average @xmath9 for the alternating , long runs , and random transmissions are virtually identical . however , note that even though the three patterns behave similarly , the input is not guaranteed to have a balanced number of zeros and ones ( locally for the long runs and neither locally nor globally for the lfsr ) .",
    "this presents a fundamentally different challenge for the classification discussed in section  [ sec : prediction ] .      in this experiment",
    ", we show that the dominating factor in the observed phenomenon is the duration for which the transmitter remains at a logical 1 , and _ not _ the switching activity of the circuit . to that end , as shown in figure  [ fig : timing ] ( @xmath10 ) , during each sampling period we loop the transmitter quickly through a 4-bit pattern at 100mhz .",
    "we test six different 4-bit patterns , only updating the looped pattern in - between sampling periods .",
    "for example , for the pattern 1100 , the transmitter would stay high for two 100 mhz clock ticks , then low for two clock tick , then back to high for 2 ticks , etc .",
    ", until the end of the sampling period .",
    "this is shown as @xmath10 , @xmath11 in figure  [ fig : timing ] .",
    "the six 4-bit patterns used are : @xmath12 , @xmath13 , @xmath14 , @xmath15 , @xmath16 , and @xmath17 .",
    "notice that @xmath18 and @xmath19 are similar to the slowly changing transmissions used for the majority of test described earlier , but @xmath20 through @xmath21 are very quickly changing transmissions . also notice that while @xmath20 , @xmath11 , and @xmath21 have the same switching activity ( 1 rising and 1 falling transition per 4 cycles ) , they transmit a one for different fractions of the sampling period ( 25 , 50 , and 75% respectively ) .",
    "lastly , notice that while @xmath11 and @xmath22 transmit the same fraction of ones , @xmath22 has twice the switching activity ( 2 rising and 2 falling transitions per 4 cycles rather than 1 of each ) .",
    "the top rows of table  [ table : dynamic ] show the average count differences @xmath23 between @xmath19 ( all ones ) and all other patterns @xmath24 , and the corresponding coefficient of variation .",
    "all @xmath25 s are positive , meaning that transmitting all ones results in the highest ro frequency .",
    "furthermore , @xmath26 , which exactly mirrors the ordering of the patterns in terms of their one versus zero duty cycles ( transmitting 75% ones has a higher frequency than transmitting 50% ones , etc . ) .",
    "this ordering and the fact that there is no significant difference between @xmath27 and @xmath28 supports our claim that the change in ro frequency is not affected by switching activity , but solely influenced by the amount of time that a one versus zero is transmitted .    as another note ,",
    "the measurements for all pairs of patterns differ with a statistical significance of at least @xmath29 according to the kolmogorov - smirnov test .",
    "the exception are the patterns @xmath11 and @xmath22 , which both transmit a one for an equal amount of time , in which the distributions are the same ( @xmath30 ) .",
    "previous research on hardware trojan detection  @xcite has noted that high switching activity of a circuit can affect the frequency of nearby ring oscillators .",
    "however , these efforts have found a _",
    "decrease _ in oscillation frequency , likely due to power sag or ground bounce , rather than the increase in oscillation frequency for the phenomenon reported here .    in this section",
    ", we show that we can replicate the phenomenon reported in earlier work - when the transmitter is large ( i.e. , uses multiple redundant buffers ) , generates a lot of switching activity , and does not share a long line with the receiver , the observed ro frequency is indeed reduced .    in this experiment",
    ", we construct a ring oscillator as before , using 2 ` vlong`s starting at @xmath31 , but we surround the ring oscillator with a large transmitter , consisting of a left and right vertical bank of 328 buffer stages over the span of the ro .",
    "this is partially shown in a screenshot from fpga editor ( figure  [ fig : local_routing ] ) . to ensure that the stages are placed appropriately and chained using intra - clb routing , we programmatically generated ` bel ` , ` rloc ` , and ` rloc_origin ` constraints .",
    "shown in the middle rows of table  [ table : dynamic ] , we use the same dynamic transmission pattern as in section  [ sec : dynamic ] and present the resulting @xmath25 and coefficient of variations .",
    "we now see that although all @xmath25 s are still positive ( meaning that transmitting all ones still results in the highest ro frequency ) , transmitting all zeros ( @xmath18 ) has nearly the same behavior .",
    "furthermore , the ordering of the patterns exactly mirrors their relative switching activity : @xmath32 .",
    "any patterns in the same switching activity group come from the same distribution ( @xmath33 ) , while any pair with different switching activity differs significantly ( @xmath34 ) .",
    "as shown in the bottom rows of table  [ table : dynamic ] , we repeated this experiment , this time filling the space between the top and bottom of the ring ( spanning @xmath35 to @xmath36 ) with @xmath37 luts .",
    "the results are similar , but the overall magnitude is smaller .",
    "this is to be expected since fewer than half the number of buffers are used .       for different length combinations ]    in this section , we characterize the effect of the lengths of the transmitter and receiver wires by varying @xmath38 and @xmath39 ( figure  [ fig : placement ] ) . for these tests we return to the more customary long wire transmitter & receiver setup with a slowly alternating transmission ( @xmath6 ) , as described earlier .",
    "figure  [ fig : length ] shows the relative change in frequency for different combinations of receiver and transmitter lengths . for clarity we only show the results for device 0 , but the other two devices have nearly identical results .    for a given ring oscillator length @xmath39",
    ", there are 3 distinct segments for @xmath40 as the transmitter length @xmath38 increases .",
    "the first segment occurs for @xmath41 , corresponding to transmitters in which the top and bottom buffers are separated by a vertical distance smaller than the full length of a ` vlong ` .",
    "we see that @xmath40 remains constant over this span , which is to be expected since , electrically , the entire ` vlong ` is driven even if the output tap does not take full advantage of the length .",
    "the second segment is the region where @xmath42 . here",
    ", @xmath40 increases linearly with @xmath38 , suggesting that the phenomenon roughly affects the delay of each ` vlong ` equally .",
    "the final region consists of @xmath43 , where @xmath40 remains constant .",
    "this occurs because there is no overlap between the newly added segments of the transmitter and the ring oscillator receiver .",
    "we can also identify the effect of a given transmitter length @xmath38 on receivers of different lengths @xmath39 . among receivers with @xmath44 , a smaller @xmath39 results in a larger effect .",
    "this is because the transmitter affects only the first @xmath38 ` vlong`s , which represent a larger portion of total delay in smaller ros .",
    "the opposite is true when @xmath45 : the larger the ro , the bigger the resulting effect .",
    "we believe this is because although delay of the routing scales linearly , the delay associated with the inverter and buffer luts remains constant .",
    "thus , the routing delay represents a larger fraction of the overall delay for larger ros .",
    "since this phenomenon only seems to act on routing delay , larger ros are affected more than shorter ones .          in this section ,",
    "we investigate the received effect when using multiple transmitters , @xmath46 and @xmath47 . in this experiment",
    "each transmitter and the receiver use two ` vlong ` segments ( @xmath48 ) . as seen in figure  [ fig : timing ] ( @xmath49 and @xmath50 ) , the transmitters are driven independently and cycle through all 2-bit combinations over multiple sampling periods .",
    "as seen in figure  [ fig : multiple ] , two different transmitter arrangements are tested . in the first , both transmitters are on the same side of the receiver ( rtt , where @xmath46 is at a distance @xmath51 , and @xmath47 at a distance @xmath52 ) . in the second test",
    ", the receiver is between the transmitters ( trt , where @xmath46 is at a distance @xmath53 , and @xmath47 at a distance @xmath52 ) .",
    "figure  [ fig : bbr ] shows the ring oscillator counts for the rtt experiment . here",
    ", the ro counts appear to only be affected by the value of the closer transmitting wire , @xmath47 .",
    "there is a clear distinction between @xmath54 and @xmath55 ( @xmath56 ) while the data is statistically indistinguishable with regards to @xmath46 ( @xmath57 ) . despite our findings in section  [ sec : distance ] , where a transmitter at @xmath58 is able to impact the receiver , the effects of the closer transmitting wire appear to overwhelm the influence of the further transmitter .",
    "figure  [ fig : brb ] shows the ring oscillator counts for the trt experiment . as we would expect , @xmath46 and @xmath47 have roughly equal influence on the ro .",
    "the counts are highest when both transmitters are one , lowest when they are both zero , and in - between otherwise .",
    "although even the difference between @xmath59 and @xmath60 is statistically significant ( @xmath61 , compared to @xmath62 ) due to small asymmetries in routing , the data appears too noisy to be practically distinguished .",
    "we discuss possibilities for this in section  [ sec : evaluation ] .",
    "although due to space considerations we limited our discussion thus far to vertical wires , we have verified that the phenomenon also occurs for horizontal ` hlong`s .",
    "we also confirmed that different ro types can be used : multiple inverters ( rather than one inverter and multiple buffers ) and different numbers of stages all detect this phenomenon .",
    "based on the results in section  [ sec : length ] , we suspect that maximizing the fraction of routing delay as a proportion of the overall delay ( by reducing the number of lut stages ) would help increase the sensitivity . we leave this as future work .    ]    ]    finally , we also ran some early tests on virtex 4 ( figure  [ fig : virtex4 ] ) and virtex 6 ( figure  [ fig : virtex6 ] ) devices .",
    "though the phenomenon is still present , the correlation appears to be an order of magnitude smaller than for the virtex 5 .",
    "additional future experiments are needed to determine appropriate parameters for less noisy results .",
    "nonetheless , plotting the relative change in frequency @xmath40 for different buffer and ring oscillator lengths for the virtex 6 in figure  [ fig : v6_length ] , we see that the same three part pattern remains , even though it is an order of magniture weaker .",
    "@xmath40 remains constant for parts of a ` vlong ` ( 8 , 16 ) , and increases linearly afterwards until @xmath43 , where it stays constant .",
    "the same phenomenon was verified on a second virtex 6 device , though in a third device there was a drop in @xmath40 when @xmath43 .     for different length combinations ]",
    "as mentioned earlier , the phenomenon discussed in this paper can be intentionally leveraged by fpga application developers . for example , its use as a no - contact debugging tap eliminates fan - out load for critical signals and may make it easier to incrementally add or remove debugging logic . similarly , this phenomenon could be used to check an ip watermark with minimal impact or , flipping the transmitter and receiver , as a protection scheme to unlock ip capabilities in the field .    at the same time",
    ", the risk for unintentionally leaking secrets also exists .",
    "modern ip blocks can be quite large , which makes routing through monolithic black - box ip a necessity .",
    "the high level of integration required to build complex systems is precisely why modern fpga tool - suites support ip block route - through .",
    "no matter if the interaction between long wires that we have described here is used in a constructive manner to add new capabilities or in a malicious manner to steal secrets , fpga design tools will need to be aware of the phenomenon .",
    "for example , developers may need some method to denote when wires carry information that should or should not be shared .",
    "similarly , routing tools will need to account for the capabilities or risk associated with using long wires in the same routing channel .",
    "we may also require new tools for design rule checks to identify or enforce routing proximity .",
    "knowledge of this phenomenon may also have implications for placement tools .",
    "this phenomenon also has implications for a variety of applications that rely on ring oscillators .",
    "for example , the ros in true random number generators ( trngs ) or physically unclonable functions ( pufs ) can be manipulated by the observed behavior .",
    "thus , it may be important to pack as much of this logic as possible into a single clb , eliminating the use of external routing .    in terms of mitigating this effect , fpga application designers can protect sensitive signals by intentionally occupying adjacent wires , minimizing the possibility for undue external manipulation or detection .",
    "furthermore , the physical design of the fpgas themselves , both at the architecture and the transistor level likely have a role to play .",
    "while we have characterized many aspects of this phenomenon , there are others we would like to investigate in the future . for example",
    ", both the utility and risk associated with this behavior hinges upon its use as a communication medium .",
    "thus , we would like to characterize the potential bandwidth and possible encoding schemes that can be used .",
    "similarly , further characterization of noise and multi - transmitter / multi - receiver issues is important . finally , a mechanism for synchronizing the transmitter and receiver may improve bandwidth .",
    "in this paper , we have demonstrated that the value carried by a long wire influences the delay of neighboring long wires .",
    "this effect is small , but measurable and surprisingly resilient .",
    "specifically , when a long wire carries a one , the delay observed by neighboring wires is reduced .",
    "we have shown that this interaction between long wires can be detected with very small circuits ",
    "the most basic system relies on only 5 luts to implement both the transmitter and receiver .",
    "although we have made no attempt to determine the precise electrical or magnetic mechanism that causes this behavior , we have thoroughly characterized the phenomenon in terms of when it will occur and how strongly it will present itself .",
    "we show that the behavior is present in multiple different virtex 5 devices and can be implemented in a variety of arrangements , including different locations , different orientations of the transmitter and receiver , and with competing transmitting circuits .",
    "furthermore , early results suggest the phenomenon occurs in both earlier and more recent device families .",
    "we also demonstrate that the phenomenon dominates a competing effect caused by switching activity .",
    "we have also discussed and evaluated techniques for classifying the received data both experimentally and analytically , reaching over 95% classification accuracy over a range of different transmitted signals , including those that persist for as little as @xmath0 .",
    "the observed behavior has the potential to be used for no - contact communication and may unlock new capabilities for fpga application designers .",
    "this also has implications for the correctness and security of fpga - based circuits .",
    "p.  bayon , l.  bossuet , a.  aubert , v.  fischer , f.  poucheret , b.  robisson , and p.  maurine .",
    "contactless electromagnetic active attack on ring oscillator based true random number generator . in _ international workshop on constructive side - channel analysis and secure design ( cosade ) _ , 2012 .",
    "m.  gag , t.  wegner , a.  waschki , and d.  timmermann . temperature and on - chip crosstalk measurement using ring oscillators in fpga . in _",
    "ieee international symposium on design and diagnostics of electronic circuits systems ( ddecs ) _ , 2012 .",
    "m.  lecomte , j.  j.  a. fournier , and p.  maurine . thoroughly analyzing the use of ring oscillators for on - chip hardware trojan detection . in _",
    "international conference on reconfigurable computing and fpgas ( reconfig ) _ , 2015 .",
    "a.  t. markettos and s.  w. moore .",
    "the frequency injection attack on ring - oscillator - based true random number generators . in",
    "_ international workshop on cryptographic hardware and embedded systems ( ches ) _ , 2009 .            c.  su , y .- t .",
    "chen , m .- j .",
    "huang , g .-",
    "n . chen , and c .- l .",
    "all digital built - in delay and crosstalk measurement for on - chip buses . in _ conference on design , automation and test in europe ( date )"
  ],
  "abstract_text": [
    "<S> as the capacity of fpgas grows , it is becoming increasingly common for designers to incorporate ip from a range of third - party sources . </S>",
    "<S> the monolithic nature of fpgas means that user circuits and black - box ip must share common infrastructure , such as routing resources . this physical proximity makes it easier for some cores to unintentionally leak secret data and for others to maliciously receive this information , even when there is no logical routing connection between them .    in this paper , we present a previously unexplored source of information leakage that occurs between adjacent but unconnected long wire segments . we find that wires carrying a logical 1 reduce the delay of nearby wires and this effect compounds linearly with the length and number of wires used . </S>",
    "<S> in contrast to previous research , which focuses primarily on detecting dynamic signals driven by large redundant circuits using external equipment , our work shows that the effect is measurable for small static and relatively short - lived signals , and that it can be detected using small onboard circuits . </S>",
    "<S> we are able to correctly infer the value driven onto the long wire over 95% of the time for signals that are anywhere from completely static to maintained for as little as @xmath0 .    </S>",
    "<S> we show that the phenomenon is independent of location , can be replicated on different devices , and is measurable even when multiple competing circuits are present . </S>",
    "<S> though we primarily conduct experiments on virtex 5 devices , additional experiments on virtex 4 and virtex 6 fpgas show that the phenomenon occurs across device generations .    </S>",
    "<S> = 10000 </S>"
  ]
}