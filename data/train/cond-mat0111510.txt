{
  "article_text": [
    "the study of solid - liquid equilibrium by computer simulation has a long history , going back to the classic work of alder and wainwright  @xcite on the hard - sphere system in the 1950 s .",
    "many techniques have been used to determine the pressure - temperature relation at equilibrium and other melting properties , such as the volume and entropy of fusion . in the last few years , there has been an upsurge of interest in the accurate _ ab initio _ treatment of the melting properties of real materials  @xcite , which has focused attention again on the techniques used to locate the melting transition .",
    "recent _ ab initio _ work has been based on two main approaches .",
    "the first locates the melting transition by requiring equality of the gibbs free energies , which are calculated _ ab initio _ for liquid and solid  @xcite ; we call this the ` free energy ' approach .",
    "the second proceeds by fitting a potential model to _ ab initio _ calculations and using this to simulate a system containing liquid and solid in coexistence  @xcite ; we call this the ` coexistence ' approach",
    ". if appropriate measures are taken , the two approaches should clearly give the same results .",
    "the purpose of this paper is to analyze the relation between the two approaches and to propose what these ` appropriate measures ' should be .",
    "we illustrate our analysis by presenting _ ab initio _",
    "calculations on the high - pressure melting of iron performed using the coexistence approach , which we compare with earlier free - energy results from the same _ ab initio _",
    "technique  @xcite .",
    "we shall show that , once the necessary corrections have been applied , the two approaches yield the same results .",
    "the free - energy approach has been well established for many years for calculations based on classical interaction models  ( see e.g. refs .",
    "@xcite ) . typically the procedure for",
    "the solid has been to start from the harmonic approximation at low temperatures ; the free energy of the high - temperature anharmonic system is then obtained by using the gibbs - helmholtz relation to integrate the internal energy given by molecular dynamics ( md ) simulation  @xcite .",
    "alternatively , the anharmonic free energy has sometimes been obtained by thermodynamic integration starting from a reference model such as the einstein solid  @xcite . for the liquid",
    ", a common procedure has been to obtain the free energy at one thermodynamic state from the work done in reversible expansion  @xcite to low density or heating to high temperature .",
    "the gibbs - helmholtz relation is then used to obtain the free energy at other states .",
    "we also mention an important alternative approach , known as ` gibbs - duhem ' integration , which allows the boundary between coexisting phases to be directly mapped out  @xcite .    in early work",
    ", the interaction models were parameterized by fitting to experimental data , but recent years have seen a major shift towards the calculation of melting properties  @xcite from _ ab initio _ methods based on density - functional theory ( dft )  @xcite .",
    "in dft , the total energy function of a system is determined by the approximation used for exchange - correlation energy @xmath0 .",
    "an important ambition then follows : the determination of melting properties with no statistical - mechanical or other approximations except those inherent in @xmath0 itself .",
    "this raises major new issues , because it is extremely costly to perform _ ab initio _ md ( aimd ) simulations on large systems long enough to reduce statistical errors to an acceptable level .",
    "the cost is particularly great for crystals , since extensive electronic @xmath1-point sampling may be needed .",
    "long accepted methods like reversible expansion to low density are impracticable with aimd .",
    "instead , it is essential to use empirical interaction models that closely mimic the dft system .",
    "the usual techniques are then employed to treat these models , and in some _ ab initio _ work thermodynamic integration is used to obtain the free energy difference between the model and dft systems  @xcite . in parallel with these developments , the advantages of avoiding intricate free - energy calculations by using the coexistence approach have made this route popular  @xcite .",
    "again , the simulations must be based on empirical models matched to dft data .",
    "the present work was stimulated by recent reports of _ ab initio _ or nearly _ ab initio _",
    "calculations on the melting of a number of materials , including si  @xcite , al  @xcite , cu  @xcite and fe  @xcite .",
    "our own work on al  @xcite and fe  @xcite was based on the free - energy approach , which used an inverse - power reference model , with thermodynamic integration to calculate the difference between the _ ab initio _ and reference free energies .",
    "a major effort was made to ensure that finite - size and other systematic errors were reduced to an almost negligible level .",
    "the other _ ab initio _",
    "work on fe , by two independent groups , used the coexistence approach  @xcite .",
    "the results for the melting curve differed substantially from each other and from our results , and we urgently need to understand the reasons for the disagreements .",
    "we aim to shed light on possible reasons here .",
    "we shall explore a number of technical issues .",
    "the first concerns the correction of the coexistence method for errors due to the difference between the _ ab initio _ system and the empirical model that mimics it .",
    "a second issue is the fitting of models to _ ab initio _ data .",
    "we have already discussed this in depth for the free - energy approach , so here we focus mainly on coexistence .",
    "we want to study what physical quantities should be fitted , and how to tell if the fit is good enough . a third important issue concerns finite - size errors , which arise mainly from the limited system sizes that can be handled _",
    "ab initio_. it has been claimed  @xcite that the coexistence approach suffers less from size errors than the free - energy approach .",
    "we shall demonstrate that in fact this type of error affects both approaches in essentially the same way .",
    "one thing we shall not do is to pass judgment on which method is ` better ' , since we shall argue that the answer depends on what one wishes to achieve , and that both approaches are vital .",
    "however , we shall comment on the strengths and weaknesses of both .    in the next section ,",
    "we define the problem , summarize briefly the free - energy and coexistence approaches as they have been applied in practical _ ab initio _ calculations , analyze the corrections that need to be applied in the two approaches , and discuss size errors .",
    "section  [ sec : iron ] then presents our new calculations on the high - pressure melting properties of fe using the coexistence approach .",
    "we shall compare with our earlier free - energy results and show the practical necessity of the corrections outlined in sec .",
    "[ sec : theory ] .",
    "the final section gives further discussion and summarizes our conclusions .",
    "we start by defining the problem to be addressed . at a given pressure @xmath2 ,",
    "two phases are in thermodynamic equilibrium when their gibbs free energies @xmath3 are equal .",
    "we regard @xmath4 as derived by the relation @xmath5 from the helmholtz free energy @xmath6 .",
    "the _ ab initio _ value of @xmath7 at any volume and temperature , denoted by @xmath8 , is given in classical statistical mechanics by : @xmath9 where @xmath10 is the _ ab initio _ total energy as a function of the positions @xmath11 of the @xmath12 nuclei , which range over the volume @xmath13 of the cell containing the system .",
    "for the purpose of treating phase equilibria , we need the free energy per atom @xmath14 in the thermodynamic limit @xmath15 , @xmath16 at constant number density @xmath17 .    even though the coexistence approach does not work directly with free energies",
    ", we shall show later that the errors that need to be overcome in this approach , as well as in the free - energy approach , can be formulated as free - energy errors .",
    "but the errors in calculating @xmath18 are of two kinds : electronic - structure errors , i.e. imperfections in the calculation of the _ ab initio _ total energy @xmath19 at each set of nuclear positions ; and statistical - mechanical errors , i.e. errors in calculating @xmath18 from the given @xmath19 , and in taking the thermodynamic limit .    for the purposes of this work , electronic - structure errors are irrelevant :",
    "our sole concern is the treatment of phase equilibrium using some _ given _",
    "algorithm for computing @xmath19 .",
    "the ` free energy ' and ` coexistence ' routes differ only in the way they address the statistical mechanics .",
    "our problem is therefore to assess and compare the ways that the two approaches control the purely statistical - mechanical errors .",
    "when we come to the practical calculations in sec .",
    "[ sec : iron ] , we shall compare the results of the two approaches applied using exactly the same algorithm for @xmath19 .      in the free - energy approach  @xcite",
    ", we use a reference system with total energy function @xmath20 , whose solid and liquid free energies @xmath21 are calculated for very large systems , so that finite - size errors are negligible .",
    "then the only demanding problem is the calculation of the difference @xmath22 , which is accomplished by thermodynamic integration  @xcite : @xmath23 where @xmath24 , and the thermal average @xmath25 is taken in the ensemble generated by the total - energy function @xmath26 . in practice , @xmath27 is computed as a time average in an aimd simulation whose dynamics is governed by @xmath28 .",
    "the main kinds of error are : statistical errors in the evaluation of @xmath27 ; integration errors due to inadequate numbers of @xmath29 points ; and finite - size errors . in the systems",
    "studied so far by this approach , all these errors can be brought under tight control .",
    "it is a crucial feature of this approach that @xmath18 , calculated as @xmath30 , does not depend on the choice of reference system , provided all technical tolerances are set so as to suppress the errors we have just mentioned .",
    "however , for reasons expounded in detail elsewhere  @xcite , the choice of @xmath31 has a major influence on the overall computational effort , which is minimized by reducing as much as possible the strength of the fluctuations @xmath32 , where @xmath33 .",
    "in particular , minimization of this fluctuation strength is important in ensuring that @xmath21 accounts for almost all the free energy , so that size errors in the small residue @xmath34 are negligible .",
    "this can be achieved by using a parameterized reference model whose parameters are adjusted so as to minimize @xmath35 , as in our work on the melting of fe . in this approach , it is an advantage that different reference systems can be used for solid and liquid , since for many materials it may be difficult to create @xmath31 functions that mimic @xmath19 with high precision in both phases .",
    "the coexistence approach is also based on a reference model that mimics the _ ab initio _ system .",
    "( this model is sometimes called by names such as ` optimised potential model '  @xcite , but here we give it the same name as in the free - energy approach . )",
    "various ways have been used to fit the reference model to the _ ab initio _ system .",
    "since it will be relevant later , we note that recent coexistence work on fe has used the ` force - matching ' procedure of ercolessi and adams  @xcite , in which the reference parameters are adjusted so that the _ ab initio _ atomic forces are reproduced as well as possible for representative sets of atomic positions .",
    "there are also several ways of using the reference model to simulate coexisting phases , and hence to determine the phase boundary between them . in the work of morris _ et al . _",
    "@xcite , coexisting solid and liquid al were simulated with the total number of atoms @xmath12 , volume @xmath13 and internal energy @xmath36 fixed .",
    "they showed that , provided @xmath13 and @xmath36 are appropriately chosen , the two phases coexist stably over long periods of time , and the average pressure @xmath2 and temperature @xmath37 in the system give a point on the melting curve .",
    "the underlying concept is that the mean volume per atom @xmath38 is given by : @xmath39 where @xmath40 is the fraction of the atoms in the liquid phase , with @xmath41 and @xmath42 the volumes per atom in the coexisting solid and liquid as a function of pressure . for fixed @xmath43 , the pressure @xmath2 traverses a certain range as @xmath40 goes from 0 to 1 .",
    "as @xmath40 varies in this way , the mean internal energy per atom @xmath44 also traverses some range ( here , @xmath45 and @xmath46 are the internal energies per atom in the two phases ) .",
    "provided @xmath47 lies in this range for the given @xmath43 , the simulation will yield stably coexisting solid and liquid . an alternative procedure would be to simulate at constant @xmath48 .",
    "then coexistence will be achieved for a given @xmath43 provided @xmath37 is chosen so that the corresponding @xmath2 on the melting line curve falls in the range specified by eq .",
    "( [ eqn : vol_per_atom ] ) .",
    "yet another approach was used in the work of laio _ et al . _",
    "@xcite on the high - pressure melting of fe ; this used constant - stress simulations , with enthalpy almost exactly conserved .",
    "the approach of belonoshko _ et al . _",
    "@xcite is different again . here",
    ", the @xmath49 ensemble is used .",
    "the system initially contains coexisting solid and liquid , but since @xmath2 and @xmath37 generally do not lie on the melting line , the system ultimately becomes entirely solid or liquid .",
    "this approach does not directly yield points on the melting curve , but instead provides upper or lower bounds , so that a series of simulations is needed to locate the transition point .",
    "whichever scheme is used , some way is needed of monitoring which phases are present . in the @xmath50 method of morris _",
    "et al . _",
    "@xcite , graphical inspection of particle positions appears to have been used , supplemented by calculating of radial distribution functions to confirm the crystal structure of the solid . in the @xmath49 method of belonoshko _",
    "et al . _",
    "@xcite , the primary diagnostic is the discontinuity of volume as the system transforms from solid to liquid .",
    "the coexistence calculations presented here on the high - pressure melting of fe employ the @xmath50 method applied to reference systems consisting of the ` embedded - atom model '  @xcite fitted to _",
    "ab initio _ data . for geophysical reasons , we are interested in pressures near that at the boundary between the earth s inner and outer cores , namely 330  gpa  @xcite . in this pressure region , the most stable crystal structure just below the melting curve is believed to be hexagonal close packed ( h.c.p . )  @xcite , and we assume here that melting occurs from this phase .",
    "we start with a simulation cell containing only the h.c.p .",
    "solid , with the basal plane parallel to one face of the cell , and the system is allowed to thermalize at a temperature where coexistence is expected . at some instant of time ,",
    "the simulation is stopped , and the atoms in one half of the system are held fixed ; the boundary between the two halves is taken parallel to the h.c.p . basal plane .",
    "the atoms in the other half are raised to a very high temperature , and dynamical evolution of these atoms is allowed to proceed so that melting occurs . with this half of the system molten , its temperature is now reduced to the original value , the atoms in the other half still being fixed . finally , the atoms in the fixed half are given thermal velocities and released , and the whole system is allowed to evolve freely .",
    "the system is monitored by calculation of the average number density in slices of the cell taken parallel to the boundary between solid and liquid .",
    "as we shall show , the density in the solid part is a periodic function of slice number , while in the liquid it fluctuates rather weakly about its average value .",
    "the total energy , temperature and pressure are , of course , monitored throughout the simulation .",
    "a feature of the @xmath50 method is that at equilibrium the stress in the solid phase will generally not be hydrostatic , and manual adjustment of the cell parameters is needed to achieve hydrostatic stress .",
    "we shall show in sec .",
    "[ sec : iron ] that this does not present a problem .",
    "both the free - energy and the coexistence approaches are subject to errors , which need to be assessed and corrected for",
    ". it may be too costly to perform all the _ ab initio _ calculations with the precision needed to obtain accurate melting properties , so that there are errors due to inadequate @xmath1-point sampling , incompleteness of the basis set , or other approximations . in the coexistence approach",
    ", inevitable differences between the reference and _ ab initio _ total energies will create errors in the melting properties , which need to be evaluated .",
    "the correction of errors in the free - energy approach has been extensively discussed elsewhere  @xcite , so our main concern here is correction of the coexistence approach .    assuming the _ ab initio _ energy is calculated with adequate precision , the main error comes from differences between @xmath19 and @xmath31 .",
    "the key question posed here is therefore : how are predicted melting properties changed by small changes in the total energy function ?",
    "( system - size errors will be discussed separately later . )",
    "related questions have been discussed before ( see e.g. ref .",
    "@xcite ) , so we give only a brief summary of the main points .",
    "the difference @xmath51 is denoted by @xmath52 , as in the free - energy approach .",
    "the change of any quantity resulting from the replacement of @xmath31 by @xmath19 will also be indicated by @xmath53 ; for example , the shift of melting temperature at a given pressure is called @xmath54 .",
    "the melting temperature is shifted because the liquid and solid gibbs free energies @xmath55 and @xmath56 , and hence their difference @xmath57 , are shifted .",
    "working at the given pressure , we take the variable @xmath2 as read and express the _ ab initio _ value of @xmath58 as : @xmath59 where the parameter @xmath60 is introduced so that the reference melting temperature @xmath61 can be written as a power series : @xmath62 since the gibbs free energies are equal in the two phases , this @xmath63 is the solution of @xmath64 , which is : @xmath65 expanding in powers of @xmath60 and equating powers , one obtains formulas for @xmath66 , @xmath67 , etc : @xmath68   \\ ; , \\label{eqn : tm_shift}\\end{aligned}\\ ] ] where @xmath69 is the reference entropy of fusion , @xmath70 is the liquid - solid difference of the constant - pressure specific heats , and @xmath71 is the shift of the entropy of fusion .",
    "we note particularly the implication of the formula for @xmath66 .",
    "since entropies of fusion are on the order of @xmath72 per atom , then a difference @xmath73 of 10  mev / atom implies a shift of melting temperature of _ ca .",
    "_  100  k , so that substantial errors will need to be corrected for unless the reference total energy function matches the _ ab initio _",
    "one very precisely .",
    "although we have included a formula for @xmath67 , it seems unlikely that this will be used in practice , except perhaps for a rough estimate of @xmath74 , since @xmath71 would be difficult to compute without rather extensive free - energy calculations .",
    "if simulations are done in the isothermal - isobaric ensemble , then for closely matching @xmath19 and @xmath31 , with small fluctuations of @xmath52 , the gibbs free energy shifts @xmath75 and @xmath76 can be evaluated using the well - known expansion : @xmath77 where @xmath78 , and the averages are taken in the reference ensemble .",
    "the _ ab initio _",
    "simulations presented later were performed in the isothermal - isochoric ensemble , so that the quantity that is readily evaluated is @xmath79 , the change of helmholtz free energy when @xmath31 is replaced by @xmath19 are constant volume @xmath13 .",
    "this @xmath34 is given by the same formula eqn  ( [ eqn : zwanzig ] ) , but with the averages evaluated in the isothermal - isochoric ensemble .",
    "in this case , we need to consider the relation between @xmath80 and @xmath34 , which is readily shown to be : @xmath81 where @xmath82 is the isothermal compressibility and @xmath83 is the change of pressure when @xmath31 is replaced by @xmath19 at constant @xmath13 and @xmath37 .",
    "whichever approach is used , coexistence must be treated in the thermodynamic limit . in the free - energy approach ,",
    "almost all the free energy is that of the reference system , for which size errors can be made negligible by doing simulations on very large systems .",
    "appreciable size errors remain only in the difference @xmath84 between the _ ab initio _ and reference systems . these can only be assessed and corrected for by explicitly calculating @xmath85 for systems of increasing size , as we report elsewhere for the cases of al  @xcite and fe  @xcite .",
    "similarly , in the coexistence approach , explicit coexistence simulations are performed with the model system on very large systems , so that size errors are made negligible . however , the shift of melting temperature due to the difference @xmath51 requires calculations of @xmath34 of exactly the same kind as are needed in the free - energy approach .",
    "this means that the size errors are essentially the same in the two approaches .",
    "we give a quantitative assessment of size errors in the melting properties of fe by the coexistence approach in the next section .",
    "our coexistence calculations on high - pressure fe use precisely the same dft techniques used in our free - energy work  @xcite , so we give only a brief summary here .",
    "the exchange - correlation functional @xmath0 is the generalized gradient approximation known as perdew - wang 1991  @xcite .",
    "we use the projector - augmented - wave ( paw ) implementation of dft  @xcite , a technique that shares the properties both of all - electron methods such as full - potential linearized augmented plane waves ( flapw )  @xcite and the ultrasoft pseudopotential method  @xcite .",
    "the calculations were done using the vasp code  @xcite .",
    "details of the core radii , augmentation - charge cut - offs , etc .",
    "are exactly as in our paw work on liquid fe  @xcite .",
    "our division into valence and core states is also the same : the 3@xmath2 electrons are treated as core states , but their response to the high compression is represented by an effective pair potential , with the latter constructed using paw calculations in which the 3@xmath2 states are explicitly included as valence states .",
    "the reference model for our coexistence simulations is the embedded - atom model ( eam ) recently used by belonoshko _",
    "et al . _",
    "@xcite to calculate the high - pressure melting curve of fe .",
    "this eam has the standard form  @xcite , in which the total energy @xmath86 is a sum of energies @xmath87 of atoms @xmath88 , with each @xmath89 consisting of two parts : first , a purely repulsive energy @xmath90 represented as a sum of inverse - power pair potentials @xmath91 , where @xmath92 is the interatomic separation and the sum excludes @xmath93 ; second , an ` embedding ' part @xmath94 which accounts for the metallic bonding mainly due to partial filling of the @xmath95-bands .",
    "the embedding function @xmath96 is represented as @xmath97 , and the density @xmath98 for atom @xmath88 is given by the sum over neighbours @xmath99 .",
    "the parameters in this eam were determined in ref .",
    "@xcite by fitting to full - potential linearized muffin - tin orbital ( fplmto ) energies for typical configurations of liquid iron , and they are : @xmath100  ev , @xmath101   , and @xmath102 .    the aim of our calculations is not to generate the entire melting curve , but to obtain a point on this curve at a pressure close to the value of 330  gpa at the boundary between the earth s solid inner core and liquid outer core  @xcite .",
    "our main simulations have been done on cells containing 8000 atoms , constructed as a @xmath103 h.c.p .",
    "the long axis is perpendicular to the basal plane of the crystal , and we refer to it as the @xmath104-axis .",
    "we have tested the adequacy of this system size by performing coexistence calculations on systems of up to 20,480 atoms . within the statistical errors",
    ", we were unable to detect any difference between results for coexistence pressure and temperature with this system size and those with the 8,000-atom system .",
    "the mean volume per atom for the calculations reported here was @xmath105",
    "@xmath106 , which is near the volumes of the solid and liquid in the pressure region of interest .",
    "since our calculations are performed at constant volume and constant cell shape ( see sec .  [",
    "sec : coexist ] ) , we checked that non - hydrostatic stresses do not affect the melting properties of the system . to do this",
    ", we performed the simulations with the two @xmath107 values 1.64 and 1.66 , which give the @xmath108 diagonal component of the stress tensor slightly larger or smaller than the @xmath109 and @xmath110 components in the two cases .",
    "we find that the effect on the melting temperature is undetectably small .    in preparing the coexisting solid and liquid as described in sec .",
    "[ sec : coexist ] , the system was initially equilibrated at 6100  k , and the high temperature used to ensure complete melting of half the system was @xmath111  k. once melting had been achieved , the liquid part was re - equilibrated at 6100  k before free evolution of the whole system was started .      in fig .",
    "[ fig : t ] , we show the temperature of the system as a function of simulation time for @xmath112 .",
    "we also show the three diagonal components of the stress tensor ; the off - diagonal components fluctuate around their average value of zero , so there is no shear stress on the cell .",
    "after an initial equilibration period , one sees that the temperature and the pressure settle around the values @xmath113  k and @xmath114  gpa . in fig .",
    "[ fig : density ] , we display the density profile , calculated by dividing the simulation cell into 400 slices parallel to the liquid - solid interface and counting the number of atoms present in each slice .",
    "the profile shown corresponds to the last configuration in the simulation with @xmath115 ; a similar profile is observed in the simulation with @xmath116 .",
    "it is easy to identify the solid and the liquid regions in the system : in the solid region the density is a periodic function of slice number , but in the liquid it fluctuates randomly around its average value .",
    "this confirms that we do indeed have coexisting solid and liquid in the cell . at 305  gpa ,",
    "the melting temperature reported by belonoshko with precisely the same eam is 6680  k , which agrees with our value within the combined statistical errors .",
    "we now correct the eam reference melting temperature to obtain the fully _ ab initio _ melting temperature using the techniques presented in sec .",
    "[ sec : corrections ] . in order to assess possible system - size errors , the free - energy corrections of eqs .",
    "( [ eqn : zwanzig],[eqn : deltag ] ) were calculated with systems of 64 , 150 and 288 atoms . to do this",
    ", we used the eam reference model to generate long simulations for the solid and liquid separately . from these simulations",
    "we extract typically 50 and 100 statistically independent configurations for solid and liquid respectively , for which we calculate the dft total energies @xmath117 .",
    "the differences @xmath24 are then used to compute the free - energy corrections and hence the shift of melting temperature ( see eq .",
    "( [ eqn : tm_shift ] ) ) .",
    "the temperature was set equal to the value of 6550  k that emerges from the coexistence simulations , and volumes per atom of @xmath118 and @xmath119  @xmath106/atom were also deduced from the coexistence simulations ; the pressure in both cases was 303  gpa .",
    "( the very small difference from the pressure of 305  gpa mentioned above is of no consequence . ) from these two volumes we can extract the volume change on melting , which is @xmath120 , the same value reported as by belonoshko _",
    "et al . _",
    "( the value from our _ ab initio _ free - energy work was 1.8  % at 305  gpa  @xcite . )",
    "we also calculated the entropy of melting from the relation @xmath121 ; the energy change on melting @xmath122 was calculated using the two separate simulations of solid and liquid at @xmath123 gpa and @xmath124k , and we obtained @xmath125  k@xmath126/atom ; a similar value of @xmath127 can be deduced from the work of belonoshko _ et al . _",
    "@xcite by using their value for @xmath128 and the clausius - clapeyron relation on the reported melting curve .",
    "( the value from our _ ab initio _ free - energy work was 1.07  @xmath72/atom at 305  gpa  @xcite . )",
    "the dft energies were carefully checked for electronic @xmath1-point errors , as in our free - energy work  @xcite .",
    "as expected from that work , @xmath129-point sampling for the 64-atom system underestimates the fully converged energies of liquid and solid by _ ca . _  10 and 50  mev / atom respectively . with 150 atoms ,",
    "@xmath129-point sampling gives negligible errors for the liquid , but an error of _ ca .",
    "_  @xmath130  mev / atom for the solid . with 288 atoms , we have used only @xmath129-point sampling , but the indications are that @xmath1-point errors should be negligible for both phases .    we report in table  [ tab : results ] the results for @xmath131 and @xmath132 for the three system sizes , the results being already corrected for electronic @xmath1-point errors",
    ". an important feature of these results is that there is no discernible system size effect on these corrections within the statistical errors of 5  mev or less , so that systems of 64 atoms are adequate for calculating the corrections . from eq .",
    "( [ eqn : tm_shift ] ) , this imples that the shift of @xmath133 due to size errors will not more than @xmath134  k. in order to obtain the corrections @xmath80 to the gibbs free energy , we need to include the term in @xmath135 in eq .",
    "( [ eqn : deltag ] ) .",
    "we find that the pressure differences between the eam and _ ab - initio _ systems are only 22 and 12 gpa for solid and liquid respectively , which give this term values of _ ca .",
    "_  5  mev . from table  [",
    "tab : results ] , we see that the free - energy differences between the _ ab initio _ and eam systems have the effect of stabilizing the liquid with respect to the solid by about 35  mev / atom compared with the eam . in order to obtain the correction to the melting temperature from eq .",
    "( [ eqn : tm_shift ] ) , we use the value for the entropy of melting @xmath136 of @xmath137/atom quoted above .",
    "this gives the first - order correction @xmath138  k , so that our corrected @xmath139 at 305  gpa is @xmath140  k. this result is in very close agreement with the free - energy approach , which at @xmath141  gpa gives @xmath142  k. ( this value is somewhat lower than the preliminary result of our free - energy calculations  @xcite ; the downward revision came from a careful reanalysis of the anharmonic free energy of the h.c.p .",
    "crystal , as reported in refs .",
    "@xcite . )",
    "although the eam of belonoshko _ et al . _",
    "@xcite mimics our _ ab initio _",
    "systems reasonably well , we have found that the model can be still further improved by refitting it to our _ ab initio _ energies of the solid and liquid . in doing this , we allowed only the repulsive potential and the strength of the embedding energy to change , so that only the parameters @xmath143 , @xmath144 and @xmath145 are allowed to vary .",
    "these were adjusted to minimise the @xmath146 fluctuations for the solid , while also maintaining the correct pressure .",
    "the new parameters are @xmath147  ev , @xmath148 , the parameters @xmath101    and @xmath149 retaining their original values .",
    "we then repeated the coexistence simulation using this new eam and obtained a coexistence temperature of @xmath150  k at a pressure of @xmath151 gpa .",
    "the very small free - energy corrections ( table  [ tab : results2 ] ) slightly stabilize the solid , resulting in an increase of melting temperature of _ ca .",
    "_  50  k to give @xmath152  k. the differences with the _ ab - initio _ pressures are negligible in this case , and the term in @xmath135 in eq .",
    "( [ eqn : deltag ] ) does not contribute to the free energy difference . at this pressure ,",
    "the melting temperature from our free energy approach was @xmath153  k  @xcite , so that once again we find very good agreement between the two approaches .",
    "we have advocated the aim of calculating the melting properties that follow from a chosen approximation for the exchange - correlation functional @xmath0 , with the errors due to all other approximations being made negligible .",
    "we have stressed that in the free - energy approach the total energy of the reference model does not have to agree exactly with the _ ab initio _ total energy , since this approach includes the calculation of the free energy difference between the two systems . up to now , no allowance has been made for such differences in the coexistence approach , but we have shown how corrections can be made so that the final results are again independent of the reference model .",
    "our practical results for high - pressure fe demonstrate that the two approaches then give the same melting temperatures , as would be expected .",
    "our analysis has implications for the way in which reference systems are constructed . in the free - energy approach ,",
    "the crucial requirement of a reference model is that the fluctuations of the difference @xmath52 between the _ ab initio _ and reference energies be as small as possible ; we have the freedom to use different reference models for the solid and liquid phases , and a constant offset between the _ ab initio _ and reference energies is of no consequence . in the coexistence approach",
    ", it seems clear that the model should be chosen so that the @xmath80 corrections , and the resulting shift of melting temperature away from that of the reference system , be as small as possible .",
    "this demands more of the reference system than in the free - energy approach .",
    "it is necessary but not sufficient that the @xmath52 fluctuations be small , in order that @xmath80 be small ( see eq .",
    "( [ eqn : deltag ] ) ) .",
    "in addition , a constant energy offset will shift @xmath133 , if the offset is not identical in the two phases , since the same model must simultaneously reproduce the energetics of both .",
    "this implies that force matching  @xcite may not always be a reliable way of constructing reference models : even if the reference and _ ab initio _ forces match precisely in both phases , there may still be a non - cancelling @xmath52 offset that will shift @xmath154 . in this sense ,",
    "energy matching is safer than force matching .    concerning finite - size errors",
    ", we have shown that these affect appreciably only the free - energy differences between the _ ab initio _ and reference systems , since in both approaches the calculations on the reference model will always be done on systems large enough to make size errors negligible . if anything , these errors may be more troublesome in the coexistence approach , because of the need to make the reference model fit both phases at once , so that the free - energy corrections may sometimes be larger .",
    "however , in our coexistence calculations on high - pressure fe , we have shown that these errors are unlikely to shift @xmath133 by more than @xmath155  50  k.    in commenting on the strengths and weaknesses of the two approaches , we note that they differ mainly in the way of treating the thermodynamic properties of the reference model . in both approaches ,",
    "corrections are then needed to obtain the properties of the _ ab initio _ system , and these involve _ ab initio _",
    "simulations to perform thermodynamic integration or to compute the free - energy differences of eq .",
    "( [ eqn : zwanzig ] ) .",
    "the melting properties of the reference model are probably more straightforward to calculate by the coexistence approach , since the free - energy approach requires rather intricate thermodynamic integrations .",
    "however , the heaviest computational effort comes in the calculation of the free - energy corrections , and here we believe the free - energy approach may have the advantage , since the effort can be reduced by using different reference systems for the two phases . in practice , we have found it very helpful to use both approaches , as in the work on fe reported here .",
    "the work of da is supported by a royal society university research fellowship , and the work of mjg by daresbury laboratory and gec .",
    "the computational facilities of the ucl hiperspace centre ( jrei grant jr98ucgi ) and the manchester csar service ( grant gst/02/1002 to the minerals physics consortium ) were used .",
    "the authors thank a.  laio and s.  scandolo for detailed discussions about their coexistence calculations .",
    "p. hohenberg and w. kohn , phys . rev . *",
    "136 * , b864 ( 1964 ) ; w. kohn and l. sham , phys . rev . * 140 * , a1133 ( 1965 ) ; r. o. jones and o. gunnarsson , rev . mod .",
    "phys . * 61 * , 689 ( 1989 ) ; m. c. payne , m. p. teter , d. c. allan , t. a. arias , and j. d. joannopoulos , rev .",
    "phys . * 64 * , 1045 ( 1992 ) ; m. j. gillan , contemp . phys . * 38 * , 115 ( 1997 ) ; r. g. parr and w. yang , _ density - functional theory of atoms and molecules _ , ( oxford university press , oxford , 1989 ) .",
    ".thermal average @xmath131 of the difference @xmath24 of _ ab initio _ and reference energies , and thermal average @xmath156 of the squared fluctuations of @xmath157 , with averages evaluated in the ensemble of the reference system and normalized by dividing by the number of atoms @xmath12 ( ev units ) .",
    "results from simulations with difference @xmath12 are reported for liquid and solid fe for the thermodynamic state @xmath158  gpa , @xmath159  k. reference model is the embedded - atom model of belonoshko _ et al .",
    "_  @xcite . [ cols=\"<,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> several research groups have recently reported _ ab initio _ calculations of the melting properties of metals based on density functional theory , but there have been unexpectedly large disagreements between results obtained by different approaches . </S>",
    "<S> we analyze the relations between the two main approaches , based on calculation of the free energies of solid and liquid and on direct simulation of the two coexisting phases . </S>",
    "<S> although both approaches rely on the use of classical reference systems consisting of parameterized empirical interaction models , we point out that in the free energy approach the final results are independent of the reference system , whereas in the current form of the coexistence approach they depend on it . </S>",
    "<S> we present a scheme for correcting the predictions of the coexistence approach for differences between the reference and _ ab initio _ systems . to illustrate the practical operation of the scheme , we present calculations of the high - pressure melting properties of iron using the corrected coexistence approach , which agree closely with earlier results from the free energy approach . </S>",
    "<S> a quantitative assessment is also given of finite - size errors , which we show can be reduced to a negligible size . </S>"
  ]
}