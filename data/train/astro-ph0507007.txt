{
  "article_text": [
    "detection of point sources and estimation of their coordinates , fluxes and other pertinent parameters from celestial images is a continuing challenge in modern astronomy .",
    "a number of packages performing point source extraction has been developed , among them sextractor @xcite , starfinder @xcite , daophot @xcite , and dophot @xcite .",
    "due to the specific nature of _ spitzer _ data and the data collection strategy there was a need to develop a point source extractor that would combine the best features of existing programs and extend their capabilities .",
    "_ spitzer _ data range from undersampled irac ( infrared array camera ) data with very low background to high background nearly nyquist - sampled low noise mips24 ( multiband imaging photometer at 24 @xmath1 ) data or very noisy mips70 ( multiband imaging photometer at 70 @xmath1 ) data .",
    "also for each instrument different observing strategies result in images that are background limited or confusion limited .",
    "the point source extractor has to be very flexible to accomodate this variety of data .",
    "mopex has been designed to be applicable in all these cases .",
    "point source extraction is implemented as a two step process : point source detection and profile fitting .",
    "mopex has two modes of point source extraction - single frame and multiframe . in the single frame mode point source detection and",
    "subsequent fitting is performed in the same image . in the multiframe mode point source extraction",
    "is performed in a set of input frames .",
    "however , the detection is performed in the mosaic image created by combining the set of input frames into a single mosaic image .",
    "the signal - to - noise ratio is higher in a mosaic image and this fact justifies performing detection there . since mosaicking is part of mopex@xcite , point source extraction benefits from such capabilities as creating properly resampled mosaic images , cosmic ray hits masking , etc .",
    "the difference between the single frame and multiframe modes is the way the point source fitting is performed . in the multiframe mode",
    "it is done simultaneously in all the input frames .",
    "the mosaic mode of operation is better suited for well sampled data where one can obtain a good estimate of prf in the mosaic image .",
    "also one should use the mosaic mode for data with high depth of coverage , since simultaneous point source fitting in a great number of images becomes computationally prohibitive .",
    "point source fitting requires a point response function ( prf ) .",
    "mopex can use a prf produced by some outside means , but for better performance the prf should be estimated from the data itself .",
    "mopex has such capabilities .",
    "the package provides means of estimating prf for both single and multiframe point source extraction modes .",
    "this paper deals with the single frame ( mosaic ) mode of point source extraction and prf estimation .",
    "description of the multiframe mode of mopex will be given elsewhere .",
    "the structure of this paper is as follows . in section  [ processingoverview ]",
    "we give an overview of the processing in the mosaic mode . background subtraction and noise estimation",
    "are described in section  [ background ] . in section  [ detection ]",
    "we describe the non - linear matched filtering technique used to enhance point sources .",
    "we also give a short description of the image segmentation . in section  [ extraction ]",
    "we describe the point source fitting performed using a modified simplex algorithm .",
    "passive and active deblending are also discussed there .",
    "section  [ prfestimation ] is a brief description of prf estimation in a mosaic image . in section",
    "[ real ] we present applications of mopex to two _ spitzer _ mosaic images and to a digital sky survey ( dss ) image . in section",
    "[ simulated ] we present the results of validating mopex with simulated data .",
    "appealing features of mopex are processing speed and photometric accuracy .",
    "see section  [ benchmarking ] for the timing results of mopex .",
    "the mosaic mode of operation is shown in figure  [ processingchain ] .",
    "in addition to the mosaic image there are two optional input images : the coverage map and uncertainty image .",
    "the coverage map gives the number of input frames that were combined to produce each mosaic pixel .",
    "the uncertainty image gives the uncertainty for each input image pixel .",
    "these two images are created when mosaicking is done with mopex .",
    "they are used at a various stages in the point extraction process .",
    "the coverage map is used in point source detection .",
    "the uncertainty image is used for filtering and point source fitting . normally , _",
    "spitzer _ data come with uncertainty images from which a mosaic of uncertainty images can be created .",
    "if no uncertainty images exist they can be estimated by mopex using the model consisting of three components - photon noise , read noise , and confusion noise .",
    "important steps in the processing are creating background subtracted and noise images .",
    "background subtraction is done by computing the median and subtracting it .",
    "the background subtracted image is used as an input for the filtering as well as point source fitting .",
    "the noise image is produced for the purpose of computing the signal - to - noise ratio ( snr ) of the point sources .",
    "optionally , this noise image can be used instead of the uncertainty image , if the latter is not avalaible and can not be reliably computed .",
    "an efficient sliding window technique is implemented for computing both products .    for better results filtering",
    "is done as a preliminary step before image segmentation .",
    "filtering can be a simple median subtraction or a more complicated non - linear matched filtering producing a point source probability image .",
    "non - linear matched filtering significantly increases the snr of the point sources in the filtered image and also supresses contribution of cosmic ray hits and various artifacts . only in rare cases of images with very low , almost negligible , noise level and high point source density using the product of the non - linear filtering for",
    "image segmentation can be detrimental .",
    "the result of image segmentation is the detection list with the positions of candidate point source are determined . during the estimation stage a thorough fit of the data",
    "is performed to refine the positions , determine the fluxes and deblend extracted point sources .",
    "the background subtracted image is normally used for the point source fitting .",
    "a point source subtracted image can be produced to assess the quality of point source extraction . a point response function ( prf )",
    "is required to perform linear matched filtering and data fitting .",
    "mopex included a separate task of prf estimation .",
    "we illustrate the intermediate products at various processing stages in figure  [ illustration ] using a small fragment ( 90 by 60 pixels ) of an mips70 mosaic image .",
    "the mosaic is described in more details in section  [ realmips70 ] .    in this paper",
    "we present an overview of the algorithm .",
    "one can create a custom - tailored processing chain to accomodate for any specific features of the data , as descrived , for example , in section  [ realmips24 ] .",
    "careful tuning of various stages can be performed using a number of parameters . for details on running mopex , comprehensive listing of all the processing parameters , and sample namelists one can consult the online guide .",
    "background subtracted images are used for both point source detection and fitting . a common way of estimating the background is to find for each pixel the median in a window centered around that pixel .",
    "this method will inevitably overestimate the background in the vicinity of bright sources .",
    "mopex provides a user controlled way to alleviate the bias introduced by the bright sources .",
    "one can counter - bias the median by excluding a fixed number of pixels with highest values in each window from median computation , thus offsetting the bias introduced by the presence of bright sources .",
    "this number is defined by the user and is constant througout the image to which it is applied .",
    "this step may require further optimization by automatically adjusting this number based on the crowdiness in any particular window .",
    "however , even in its present state the quality of median subtracted images satisfies the needs of point source detection .",
    "any bias in the background estimation introduced by the median filtering can be corrected at the point source fitting stage as described below in section  [ extraction ] , since the fitting includes among other fitting parameters a constant background for the fitting area . by increasing the window size",
    "one can decrease the fluctuations in the number of point sources per window and in general get a more robust estimate of the median .",
    "the problem with increasing the window size is the corresponding increase of the processing time . in order to find the median the values of the pixels in the window",
    "should be sorted .",
    "if sorting is done from scratch for each window this process becomes prohibitively slow . to speed up the process and make median filtering practical for relatively big windows , we use the sliding window approach .",
    "the pixel values are sorted in the first window which is located in a corner of the image .",
    "subsequently , as the window slides by one column the pixels from the dropped out column are removed from the sorted list of pixels and the new column is inserted in the sorted list of pixels .",
    "various data structures have been used for fast median computation ( see @xcite and references therein ) .",
    "we implemented a variant of the binary search tree method .",
    "this approach significantly speeds up the processing .",
    "the processing time scales with the linear size of the sliding window , whereas if the sorting is performed from scratch in each window the processing time scales at least as the area of the window . on a 1 ghz sparc",
    "sun workstation processing time for computing the median for a window of size 100x100 pixels is @xmath2 sec / per pixel .",
    "noise images are used for computing the snr of the point sources .",
    "noise images for each pixel give a value of background fluctuation in a window centered on the pixel .",
    "they are computed based on the assumption of gaussian distribution of pixel values around the underlying sky value .",
    "the presence of point sources results in broadening of the pixel distribution and overestimation of the noise level . just like in the background estimation",
    "this can be alleviated by excluding the highest pixel values in each window .",
    "noise estimation is an extension of median filtering .",
    "the median pixel @xmath3 is found for each window .",
    "then the noise value @xmath4 is determined as @xmath5 -   w[i_{med } - 0.34 w])/2.\\ ] ] here @xmath6 is the sorted array of pixels in the window , @xmath7 is the size of the array .",
    "the same sliding window technique is used here as in background estimation .",
    "point source detection is performed either on background subtracted images , or optionally additional filtering can be performed .      the purpose of filtering is to reduce fluctuations of the background noise and to enhance point source contributions .",
    "it is a common practice to perform linear matched filtering to reach the above goals @xcite .",
    "a matched filter can be derived @xcite on the basis of optimizing snr , likelihood ratio , or mean square error ( mse ) .",
    "standard derivation of linear matched filter involves an assumption of either a single point source or the gaussian distribution of the point sources . in reality",
    "the distribution function of point sources is highly non - gaussian . under such condition",
    "the linear filter becomes sub - optimal and the optimal filter is non - linear .",
    "the general form of a such a filter is very complicated  @xcite and its derivation involves fitting the point source distribution function with the gaussian mixture model .",
    "application of such a filter is computation - intensive . for practical purposes we take the general idea of non - linear filtering and derive a non - linear filter based on the notion of point source probability .",
    "the details of the derivation are given in appendix  [ app_matched ] .",
    "a point source probability image is computed as follows : @xmath8 where @xmath9 is the pixel value of the input image , @xmath10 is the value of pixel @xmath11 in the point source probability image and @xmath12 is an apriori probability of point source presence .",
    "quantities @xmath13 , @xmath14 , and @xmath15 are defined in appendix  [ app_matched ] .",
    "the algorithm is not sensitive to the exact value of @xmath12 which is set by default to 0.1 .",
    "figure  [ illustration]b shows the @xmath16 image corresponding to the input image in figure  [ illustration]a .",
    "convolution with the prf causes some smearing of the point sources .",
    "the smearing , however , is not of concern , since the filtered images are used for detection only .",
    "filtered images undergo a process of image segmentation .",
    "contiguous clusters of pixels with the values greater than a user - specified threshold are identified .",
    "if the number of pixels in a cluster is smaller than a user - specified threshold , the cluster is rejected .",
    "this procedure serves as an additional guard against cosmic rays affected pixels and peaks in background noise fluctuations .",
    "if the number of pixels is greater than a user - specified threshold , the cluster is subjected to further segmentation with a higher threshold ( figure  [ threshold ] ) .",
    "the process of raising threshold is very sensitive .",
    "initially the threshold @xmath17 defined in terms of a robust estimate of the background fluctuations in the filtered image .",
    "the subsequent increase of the threshold is is the essential part of passive de - blending as described below in section  [ deblending ] .",
    "the simple approach implemented in mopex is as follows . for each cluster a new value of the threshold",
    "is found based on the mean pixel value and the standard deviation of the pixel values in the cluster .",
    "the drawback of such approach is that it misses a lot of sources which are close to brigher sources .",
    "it the original clusters contains one bright and several faint sources the raised threshold will miss the faint sources .    a more complicated scheme has been implemented to facilitate passive de - blending .",
    "this scheme uses the concept of _ peak _ pixels .",
    "a pixel is declared a _",
    "peak _ pixel it its value is greater than the values of a user specified number of adjacent pixels . in this scheme",
    "the cluster is split as long as there are more than one _ peak _ pixel in it .",
    "the minimum _ peak _ pixel value in the cluster @xmath18 is determined .",
    "the effective segmentation threshold @xmath19 for the detection level @xmath20 is equal to @xmath21 this scheme ensures that no faint sources are missed in the presence of a bright neigbor .",
    "the program keeps track of threshold raising and assigns a detection level to each pixel based on the last threshold value for which this pixel was above the threshold .",
    "the original threshold corresponds to the detection level 1 .",
    "each time the threshold is raised the detection level is incremented .",
    "a detection map image can be created to visualize the image segmentation process .",
    "figure  [ illustration]c shows the detection map corresponding to the input image in figure  [ illustration]a .",
    "it has an example of a detection that was discarded because its size was smaller than the user - specified threshold ; it is circled with the white dashed line .",
    "higher levels of detection are shown with darker shades of gray . when the process of segmentation is finished the centroids of the clusters",
    "are calculated and stored in the detection list ( see figure  [ processingchain ] . )",
    "centroids that belong to the same first level detection clusters are marked in the detection table as part of the same blend .",
    "the size of the blend defines the initial @xmath22 for point source fitting below in equation  [ chi2 ] .",
    "an example of such a blend with @xmath23 is circled in figure  [ illustration]c with a black dashed line .",
    "mosaic images in general have variable coverage . applying a constant pixel",
    "value threshold results in variable effective threshold ; areas of higher coverage will have higher threshold in terms of the snr of the detected point sources . to overcome this problem",
    "the coverage map is used to attenuate the image undergoing segmentation .",
    "the input image is multiplied by the square root of the coverage before it undergoes the process of segmentation .",
    "it can be done for any input image , i.e. either the background subtracted image or the probability map .",
    "also , optionally one can specify minimum coverage to prevent detections in the areas of low coverage , which are usually very noisy and where detection can not be performed reliably even after the filtering is performed .",
    "final point source position and photometry estimation is performed for all detections on the detection list . for each point source candidate the data in the input image",
    "is fit with the prf .",
    "fitting is performed by minimizing @xmath24 :    @xmath25    here the summation is performed over pixels @xmath26 from the fitting area @xmath7 ; @xmath9 and @xmath27 are the pixel values of the input image and uncertainty image , correspondingly ; @xmath28 and @xmath29 are the flux and the position of the @xmath30 point source ; @xmath31 ) is the contribution of the @xmath30 point source to the @xmath32 pixel ; @xmath33 is the constant background within the fitting area that can be used in this formula optionally .",
    "the number @xmath34 of point sources fit simultaneously is set to 1 initially if the detection does not belong to a blend , as described in the previous section . for the detections belonging to a blend the number @xmath34 is initially set to the size of the blend .",
    "prf contribution is computed for any fractional position of the point source ; a bilinear interpolation is performed from the grid points available in the prf .",
    "the fitting area @xmath7 is a combination of rectangle areas centered on the detection positions ( figure  [ fittingarea ] ) .",
    "the size of each rectangle is specified by the user and should be set to be on the order of the size of the airy disk . if set properly , the fitting areas of the point sources belonging to one blend are partially overlapping . as a result of detection point sources with the overlapping contributions should belong to one blend .",
    "however , if the detection is done poorly , e.g. if the detection threshold is set too high , then such sources will be erroneously put in two separate blends and not fit simultaneously . if the uncertainty image is not available , the noise image can used instead .",
    "users have an option of using the background subtracted mosaic , using the original image and fitting the background for each point source , or doing both .",
    "the strategy used for minimization of @xmath24 is a hybrid of a modified simplex algorithm and the gradient descent algorithm .",
    "the simplex algorithm does not use derivatives of the functions involved in minimization .",
    "it is a desirable feature since the world coordinate transformations are very complicated functions of their arguments .",
    "we made several modifications of the algorithm , which are described in appendix  [ app_simplex ] .",
    "simplex operations are applied to the point sources positions . on the other hand",
    "the derivatives with respect to the fluxes of the point sources and the background are taken easily : @xmath35 and that justifies the choice of the gradient descent method for the fluxes and the background .    in general ,",
    "several point sources are used to fit the data simultaneously as explained in the next section .",
    "a @xmath36dimensional simplex is constructed for the position vector of each point source .",
    "the appropriate simplex operations is performed for each point source separately .",
    "after the positions of the point sources are adjusted each flux and the background are adjusted along the gradient given by the equation  [ dchi2_dflux ] .",
    "the procedure is repeated until one of the stopping criteria specified below is met .",
    "since each simplex is moved separately , it reduces the complexity of the algorithm .",
    "the reflections , etc . are performed in the @xmath36dimensional space of the position vertor for each point source , as opposed to the @xmath37 dimensional space of the vector describing the position of all @xmath34 sources .",
    "the goodness - of - fit is assessed by the values of @xmath38 .",
    "the number of the degrees of freedom @xmath39 is equal to the size of the fitting area @xmath7 minus the number of the fitting parameters , which is 3 per point source and one for the background , if it is used in the minimization .",
    "the program attempts to minimize @xmath38 to be below the user specified threshold . if the number of iterations exceeds the limit or the relative change of @xmath24 drops below the limit , fitting terminates , even though the @xmath24 is still greater than the threshold .",
    "if several point sources are within the reach of each others prf s they should be fit simultaneously .",
    "this is done if @xmath40 in equation  [ chi2 ] .",
    "this process is known as point source deblending .",
    "there are two mechanisms in mopex to perform deblending .    the first one is called passive deblending .",
    "the point sources identified at the detection stage as belonging to one blend are fit simultaneously .",
    "in this case fitting starts with the value @xmath40 .",
    "the second mechanism is called active deblending . during active deblending @xmath34",
    "is incremented during the fitting process . if @xmath38 for a point source is above the user specified threshold , the algorithm increments @xmath34 and fits the same data with more point sources .",
    "if the improvement in @xmath38 is significant , then the additional point source is accepted .",
    "otherwise the algorithm reverts to the previous solution . in case of succesful active deblending",
    "if @xmath38 is still greater than the threshold , active deblending continues untill the program reaches the user defined limit on @xmath34 .",
    "we performed simulations to test the limits of passive and active deblending . to test passive deblending a set of point sources with the same flux",
    "was added to a smooth background image .",
    "the average separation between the adjacent sources was approximately the fwhm ( full width half maximum ) of the prf .",
    "two examples of such a cluster with 10 point source is shown in figure  [ mips_sim ] .",
    "these sources were separated at the detection stage , i.e. they were detected as separate sources .",
    "they were marked as belonging to one initial cluster and were fit simultaneously .",
    "the simulation was repeated several times for a number of sources ranging from 2 to 20 . in table",
    "[ mips_sim_p ] we show the processing time and the accuracy of determining positions and fluxes .",
    "the positional error @xmath41 is defined as the average distance between the true @xmath42 and extracted @xmath43 positions of the point sources @xmath4 : @xmath44 the relative flux error @xmath45 is defined as the average ratio of the absolute difference between the true @xmath46 and extracted flux @xmath47 to the true flux : @xmath48 the processing time was measured on a 1 ghz sparc sun workstation with the fitting area of the size of 7 by 7 pixels .",
    "the processing time depends on a variety of other factors , so the numbers quoted in table  [ mips_sim_p ] can be used as a general guide only .    to test active deblending we performed similar simulations .",
    "the goal of these simulations was to test the limit in terms of the algorithm s ability to de - blend sources that can not be separated at the detection stage .",
    "we simulated images with the clusters of 2 and 3 point sources .",
    "the distance between the sources in the 2-source clusters was @xmath49 1/2 of the fwhm , the distance between the sources in the 3-source clusters was @xmath49 2/3 of the fwhm . in the bottow row of figure  [ mips_sim ]",
    "we show an example of a 2-source cluster and a 3-source cluster .",
    "the positional and flux errors were @xmath50 pixel and @xmath51 for the 2-source clusters and @xmath52 pixel and @xmath53 for the 3-source clusters .",
    "the numbers are slightly lower for the 3-source clusters .",
    "this is explained by the fact that the separation is greater for these clusters",
    ". the important figure of merit is the failure rate @xmath54 , which is the fraction of the cases for which the algorithm could not succesfully deblend the sources . for the 2-source clusters @xmath55 . for the 3-source clusters , even though the separation is greater , the failure rate increases dramatically to @xmath56 .",
    "active deblending of clusters with more than 3 sources is not reliable .",
    "an example of passive and active deblending in the real data is given in figure  [ illustration]a .",
    "the cluster of sources for which both passive and active deblending was performed is circled with the dashed line .",
    "the output is a list of point sources that specifies their world and local coordinates , fluxes , uncertainties , goodness - of - fit measure , estimated snr , and a number of other quantities that are used for quality assessment .",
    "the flux , position and background uncertanties @xmath57 and cross - correlation @xmath58 are determined by the diagonal elements of the inverse of the hessian matrix : @xmath59 where @xmath60 are the fit parameters @xmath61 , @xmath62 , @xmath63 , and @xmath33 .",
    "@xmath64    snr for point source with flux @xmath61 and position @xmath65 is computed as @xmath66 where @xmath67 is the noise image , described in section  [ background ] ; @xmath68 is defined as the effective number of pixels whose noise contributes to the measurement of the flux of the point source .",
    "one can specify an unlimited number of apertures to compute aperture photometry for each extracted point source .",
    "mopex consists of a number of modules written in c / c++ which are glued together by perl scripts .",
    "specifically , the point source extraction in the mosaic mode discussed in this paper is performed by the perl script _",
    "prf estimation is performed by the perl script _ prf_estimate.pl_. point source",
    "subtracted images are created with the perl script _",
    "apex_qa.pl_. the software parameters are input through namelists , ascii configuration files .",
    "the software is available for download at the _",
    "the documentation included in the distribution has a detailed description of the parameters used in point source extraction as well as sample namelists .",
    "here we give a brief description of prf estimation , which will be described in more details elsewhere .",
    "the first time point source extraction can be performed with a theoretical prf or even a gaussian prf .",
    "it is performed with a high detection threshold in order to find bright sources .",
    "an additional selection should be performed to find only non - confused point sources .",
    "a set of postage stamp images is cut out from the background subtracted mosaic image centered on each point source position .",
    "more accurate point source positions are estimated by fitting a gaussian to the postage stamp images .",
    "there is an option of rejecting and replacing outlier pixels and outright rejecting `` bad '' images .",
    "the postage stamp images are resampled and shifted using bicubic interpolation @xcite and combined into one final prf image .",
    "we want to emphasize here that the use of the term prf is not just an alternative way of saying point spread function ( psf ) .",
    "psf - fitting is a commonly used term .",
    "however , prf and psf are two different objects .",
    "psf is an image a point source .",
    "psf is often oversampled , i.e. the pixel size of the psf image is a fraction of the pixel size of the detector array or the mosaic image for which the psf is applicable .",
    "prf , however , is * not * an image of a point source .",
    "it is a table of values of responses of the detector array ( or mosaic ) pixels to a point source .",
    "the positions of the pixel for which the response is calculated are on a grid .",
    "normally the prf is oversampled , which means that the spacing of the grid is a fraction of the detector pixel size . the two - prf and psf - are one and the same if they are not oversampled , i.e. the pixel size of the psf is equal to the pixel size of the detector array(mosaic ) and equal to the grid spacing of the prf .",
    "the advantage of using prf vs. psf has to do with the way they are derived from the data .",
    "prf is closer to what is being observed by the detector array pixels .",
    "every processing step inevitable introduces errors in the product being calculated . the only error introduced in estimating prf is the one produced by the shift of the observed pixels to the fixed grid .",
    "estimation of the psf involves an additional step of interpolating from the bigger detector array pixels to the smaller psf pixels .",
    "this step introduces an additional error",
    ". however , for the purposes of fitting one has to reverse this and integrate the small pixels back into the bigger detector array pixels .",
    "we performed point source extraction on the mosaic images taken at 24 and 70 @xmath0 m with mips as part of the extragalactic first look survey ( fls ) @xcite .",
    "these images consist of a main shallow survey , centered on a region near the ecliptic pole ( ra[j2000]=17:18 , dec[j2000]=+59:30 ) and covering 4.4 square degrees , and deeper observations ( verification strip ) contained in the main survey but smaller in size ( 0.26 square degrees ) .",
    "the 24 @xmath0 m data was mosaicked to include both the shallow ( median coverage of 23 ) survey and the smaller verification strip ( median coverage of 116 ) .",
    "the mosaic was created with square pixels measuring half of the detector s original pixel size , i.e. 1.275  arcsec .",
    "the effective integration time for the verification strip is @xmath49426 seconds , about five times deeper than the main field with its @xmath4984 seconds .",
    "the noise at 3@xmath69 is 0.08 mjy ( verification strip ) and 0.16 mjy ( main field ) .",
    "point source extraction is performed on the mosaic image , since mips24 data is well sampled and usually have a high coverage depth as is the case for the fls data .",
    "detection and point source fitting is done in a 5 step process .",
    "the first step consists of selecting point sources for prf estimation . as an initial guess a theoretical prf produced by the _",
    "version of the tiny tim point spread function ( psf ) modeling program was used .",
    "point source extraction is performed without doing active deblending and only the brightest non - confused ( non belonging to a blend of detections ) sources ( flux @xmath70 microjy ) with the lowest @xmath24 ( @xmath71 ) are kept .",
    "a total of 27 sources are selected for prf estimation .",
    "the second step is to estimate the prf based on the selected sources .",
    "the first airy ring of the psf is at a radius of 7 mosaic pixels .",
    "we select a prf postage stamp size of 35 by 35 pixels and a circular prf with radius of 11 pixels ( beyond the first airy ring ) .",
    "the prf flux is normalized within that radius and therefore an aperture correction ( a factor of 1.156 ) needs to be applied to all fluxes @xcite .    the first bright airy ring around the brightest point sources in our mosaic image are the cause of many false detections in the mosaic image .",
    "therefore , our third step is to create a mosaic image where all the point sources with snr @xmath72 20 in the point source probability image have had their airy rings removed .",
    "this is an example of how the basic processing chain can be modified in order to accomodate specific features of the data .",
    "a total of 1224 sources are extracted .",
    "then a residual image is created where the prf used for subtracting point sources has a hole with a radius of 5 image pixels ( where the first minimum occurs in the prf ) .",
    "the detection is then done on the ringless image with a much lower detection threshold .",
    "a total of 97512 sources are detected .",
    "the final fitting is done with passive and active deblending .",
    "a total of 41559 sources ( @xmath73 sources per square degree ) with snr @xmath72 3 are extracted .",
    "figure  [ mips24 ] shows a section of the mosaic ( 1300 by 1000 pixels or 0.16 square degree in size ) that has the verification strip and the main field outside of the verification strip .",
    "the point source subtracted mosaic is also shown to assess the quality of point source extraction .      the 70 @xmath0 m data was mosaicked to contain only the verification strip ( median coverage of 35 ) .",
    "the mosaic covers 0.4 square degrees and the pixel size is 4 arcsec .",
    "the effective integration time is @xmath74 seconds .",
    "the total number of extracted point sources with fluxes @xmath75 ( @xmath76 mjy ) is @xmath77 .",
    "the processing steps here are similar to the ones used for the mips24 mosaic .",
    "the only difference is that we did not create a `` ringless '' image for the detection .",
    "the reason the airy rings did not cause any false detection is that even for the brightest sources they are below the noise level .",
    "the main reason we use the mosaic mode of point source extraction for mips70 data is that in the single frame the data is too noisy to do any dependable point source fitting and prf estimation .",
    "figure  [ mips70 ] shows the mips70 mosaic of the verification strip with and without the point sources .",
    "the white rectangle shows the fragment of the mosaic used for illustration of the processing steps in figure  [ illustration ] .",
    "we also tested mopex on a digital sky survey ( dss ) image , of size 40 arcmin across , near the standard star landolt 92 - 288 at position ra[j2000]=00:57:17.093 and dec[j2000]=+00:36:47.76 ( dss1 , plate dss27753 ) .",
    "a total of 2836 sources were detected .",
    "figure  [ dss_image ] shows the dss image and the residual image .",
    "point source extraction was done in two steps .",
    "a number of sources in the images have their responses distorted due to non - linear response and several brighter ones are saturated .",
    "also there is a number of extended sources in the field .",
    "the separation between good sources , non - linear sources and saturated sources can be done based on the @xmath78 of the fit . at the first step",
    "only 2725 good sources were detected and removed from the input image . at the second step 111",
    "non - linear sources were detected and removed from the image .",
    "a separate prf was estimated for the non - linear sources .",
    "the quality of the point source extraction and removal for the non - linear sources is obviously worse than for the good sources , but was deemed satisfactory .",
    "the fitting and removal for the saturated source can not be done succesfully .",
    "these sources are marked in the figure  [ dss_image ] with white circles .",
    "mips24 mosaics were simulated by adding point sources to the computed noise images ( main and verification ) .",
    "the simulated fluxes were randomly taken from the flux distribution as given by the number counts in the main and verifications surveys ( marleau et al .",
    "a list of true sources was created .",
    "the true sources were convolved with the prf derived previously .",
    "point source extraction done for the real data was repeated with the same steps and parameters on the simulated data .",
    "the list of the true sources used in the simulated images is matched with the list of the extracted sources .",
    "differential completeness and reliability have been measured as function of point source flux density @xmath62 .",
    "completeness @xmath79 is defined as the ratio of the number of the matched sources @xmath80 to the number of the true sources @xmath81 .",
    "reliability @xmath82 is defined as the ratio of the number of the matched sources @xmath80 to the number of the extracted sources @xmath83 : @xmath84    the results of point source extraction of the simulation data are shown in figure  [ simmain_apex ] ( main survey ) and figure  [ simver_apex ] ( verification strip ) .",
    "comparison of the profile fit fluxes from mopex with the true fluxes which are used in the simulated fls main field 24 @xmath0 m images shows a tighter relationship at faint fluxes for the deeper verification strip , as expected .",
    "source extraction is 80% complete at a flux of 0.11 ( main ) and 0.08 mjy ( verification ) . within the 80% completeness limit ,",
    "typical flux measurement errors are of the order of 10 - 15% ( depending on snr ) or less and position accuracy is equal or better than 1 arcsec .",
    "we have performed a simple comparison with another source extraction software , daophot .",
    "daophot was chosen because it is one of the best known stellar photometry package @xcite .",
    "it was run as part of iraf ( version 2.12.1 ) .",
    "the threshold ( in sigma ) for feature detection was set to 1.5 and the fluxes were computed within an aperture with radius of 13 pixels .",
    "the results of point source extraction of the simulation data with daophot are shown in figure  [ simmain_daophot ] ( main survey ) and figure  [ simver_daophot ] ( verification strip ) .",
    "the results produced by mopex are arguably better than the ones produced by daophot .",
    "the completeness and reliability of mopex extractions are higher overall .",
    "that is , the reliability of daophot extraction is slightly higher , but in our opition the gain in completeness in the much more significant than the loss in reliability .",
    "also mopex fluxes have no systematic offsets at the higher end .",
    "we have performed the timing test for mopex on a solaris machine ( sunblade 2500 ) with a cpu s clock rate of 1.5ghz and 8 gb of ram .",
    "we ran mopex on the whole 4.4 square degree region and it took only 30 min to complete the point source extraction step ( 41559 sources extracted with snr @xmath72 3 ) .",
    "we also ran daophot on this image .",
    "the daophot counterpart of point source extraction in mopex _ nstar _ took 43 min to complete .",
    "we presented point source extraction with mopex , a package for astronomical image processing developed at the _",
    "spitzer _ science center .",
    "mopex performs point source extraction in two modes : mosaic ( single frame ) and multiframe .",
    "point source extraction for well sampled data and/or data with high depth of coverage should be done in the mosaic mode .",
    "we gave a description of the processing steps of point source extraction in the mosaic mode and the main features that contributed to accurate and efficient extraction . among them",
    "is the non - linear matched filtering leading to improved detection of faint point sources .",
    "passive and active deblending allow for successful fitting of confused point sources .",
    "efficient methods of background and noise estimation and the modified simplex method contribute to the computational speed of mopex .",
    "mopex application was shown on the examples of mips24 and mips70 fls data and a digital sky survey image .",
    "these included the low - level noise mips24 verification strip , medium - level noise mips24 main field , and high - level noise mips70 verification strip . in each case",
    "successful point source extraction was evidenced by the quality of the residual images . in order to obtain quantitative evaluation of point source extraction we applied mopex to simulated mips24 data .",
    "we computed the completeness and reliability of point source extraction , as well as the photometric and astrometric accuracy .    for undersampled data with relatively low coverage point source extraction",
    "is better done in the multiframe mode by simultaneously fitting sources in the input frames instead of the mosaic image created by coadding the input frames .",
    "we will describe the multiframe mode of point source extraction in the near future .",
    "another direction of exploration is applying mopex to point source extraction in crowded fields .",
    "this will require tuning the algorithm and can potentially lead to some algorithm modification .",
    "we would like to express our gratitude to david frayer for making the mips70 mosaic and the prf , and also to dario fadda for making the mips24 mosaic .",
    "this work is performed for _ spitzer space telescope _",
    ", which is operated by the jet propulsion laboratory , california institute of technology , under a contact with the national aeronautics and space administration .",
    "here we derive an expression for a non - linear filter based on the notion of point source probability .",
    "we assume that image @xmath85 observed by the detector consists of the point source contribution @xmath86 convolved with the prf and additive noise @xmath87 : @xmath88 here @xmath89 is a translationally invariant matrix constructed from the prf : @xmath90 .",
    "the general problem is to estimate the probability of the point source being at a particular pixel _",
    "i _ given a measurement vector @xmath91 in a certain window _",
    "w _ surrounding this pixel .",
    "the size of the window _ w _ is determined by the size of the prf .",
    "we assume that the point source and background noise are characterized by the distribution functions @xmath92 and @xmath93 , correspondingly .",
    "we consider two hypotheses for the pixel _",
    "i_. the first hypothesis @xmath94 is that there is a point source at the pixel , and the second @xmath95 ( null hypothesis ) is that there is not a point source at the pixel .",
    "the probability of the @xmath96 hypothesis conditioned on the measurement @xmath91 is given by the bayesian theorem : @xmath97 where @xmath98 is the a priori probability of the @xmath96 hypothesis , @xmath99 is the probability density of observing the set of pixel values @xmath91 . assuming completeness of the hypothesis set ,",
    "i.e. @xmath100 , we obtain for @xmath99 @xmath101 the probability density of measurement @xmath91 under the null hypothesis is given simply by the noise distribution function @xmath93 .",
    "the probability density of measurement @xmath85 under the point source hypothesis is the result of integration over all possible point source contributions @xmath86 :",
    "@xmath102 combining everything we obtain for the quantity in question : @xmath103    in order to evaluate equation  [ eq5 ] we assume that both the point sources and the noise have zero - mean gaussian distribution functions with the variances @xmath104 and @xmath105 and are not correlated spatially .",
    "we also assume that there is only one point source in the window _",
    "w_. under these assumptions the integration in  [ eq4 ] can be performed to yield : @xmath106 here @xmath107 after substituting equation  [ eq6 ] in equation  [ eq5 ] we obtain the final expression for the point source probability : @xmath108",
    "the original downhill simplex algorithm described in @xcite and @xcite minimizes a function of @xmath67 variables by using the values of the function at several vertices and trying to move away from the highest vertex . in our paper",
    "the function being minimized is the goodness - of - fit measure @xmath24 defined in equation  [ chi2 ] .",
    "there are four basic ways to move a vertex : reflection , expansion , contraction and shrinkage .",
    "we adopted the simplex algorithm with a number of improvements .",
    "the changes are illustrated in figure  [ simplex ] .",
    "first , we modified reflection .",
    "if the change in @xmath24 is smaller than a user - specified threshold , it is an indication that the reflection is done almost parallel to the iso-@xmath24 lines . in this case",
    "an attempt is made to replace the reflection with a move in a perpendicular direction .",
    "the number of perpendicular directions are equal to @xmath109 .",
    "the move is performed , if it results in a @xmath24 lower than the one achieved by the reflection .",
    "another modification is that contraction and shrinkage have been replaced with the line minimization of @xmath24 along the unsuccessful reflection direction .",
    "i.e. if the reflection results in point with higher than the original @xmath24 , a point with the lowest @xmath24 is found on the line of the unsuccessful reflection .    without the modifications",
    "the algorithm in its original form very often was unable to find the global minimum and remained stuck in of the local minima and wandered away from the true point source location .",
    "@xmath110(sec ) & 0.07 & 0.15 & 0.43 & 0.90 & 1.8 & 3.3 & 5.5 & 9.3 & 15 & 20 +   + @xmath41(10@xmath111pixels ) & 0.3 & 0.5 & 0.8 & 1.7 & 2.4 & 2.6 & 2.9 & 3.5 & 4.3 & 5.1 +   + @xmath45(10@xmath111 ) & 0.5 & 0.8 & 1.1 & 1.6 & 1.9 & 2.2 & 2.4 & 2.7 & 2.9 & 3.3 +"
  ],
  "abstract_text": [
    "<S> mopex ( mosaicking and point source extraction ) is a package developed at the _ </S>",
    "<S> spitzer _ </S>",
    "<S> science center for astronomical image processing . </S>",
    "<S> we report on the point source extraction capabilities of mopex . </S>",
    "<S> point source extraction is implemented as a two step process : point source detection and profile fitting . </S>",
    "<S> non - linear matched filtering of input images can be performed optionally to increase the signal - to - noise ratio and improve detection of faint point sources . </S>",
    "<S> point response function ( prf ) fitting of point sources produces the final point source list which includes the fluxes and improved positions of the point sources , along with other parameters characterizing the fit . </S>",
    "<S> passive and active deblending allows for successful fitting of confused point sources . </S>",
    "<S> aperture photometry can also be computed for every extracted point source for an unlimited number of aperture sizes . </S>",
    "<S> prf is estimated directly from the input images . </S>",
    "<S> implementation of efficient methods of background and noise estimation , and modified simplex algorithm contribute to the computational efficiency of mopex . </S>",
    "<S> the package is implemented as a loosely connected set of perl scripts , where each script runs a number of modules written in c / c++ . </S>",
    "<S> input parameter setting is done through namelists , ascii configuration files . </S>",
    "<S> we present applications of point source extraction to the mosaic images taken at 24 and 70 @xmath0 m with the multiband imaging photometer ( mips ) as part of the _ spitzer _ extragalactic first look survey and to a digital sky survey image . </S>",
    "<S> completeness and reliability of point source extraction is computed using simulated data . </S>"
  ]
}