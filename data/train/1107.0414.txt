{
  "article_text": [
    "[ [ problem - statement - and - motivation ] ] problem statement and motivation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this paper we address the problem of understanding the success of algorithms that organize patches according to graph - based metrics .",
    "patches are local portions , or snippets , of a signal or an image .",
    "the set of patches can be organized by constructing a graph that connects patches that are similar .",
    "indeed , it is reasonably straightforward to measure the similarity between patches that are alike .",
    "the graph can then be used to extend the notion of similarity to patches that are very different .",
    "for instance , one can measure the distance between two visually different patches by computing the number of edges of the shortest path ( geodesic ) connecting them . in this work",
    "we explore a distance defined by the commute time associated with a random walk defined on the graph .",
    "algorithms that analyze patch data using graph - based metrics have led to state - of - the art techniques for classification @xcite , denoising @xcite , and studying dynamics @xcite .",
    "the graph provides a new perspective from which to analyze the similarities between patches , and consequently , the local signal or image content they contain .",
    "for example , in @xcite , properties of the graph s geometry , such as the distribution of clustering - coefficients and the average geodesic distance between two vertices , are used to separate chaos and noise , or different types of chaos . in @xcite , the geometry of the graph",
    "is analyzed by studying a random walk on it .",
    "specifically , the _ diffusion distance _",
    "@xcite ( or _ spectral distance _",
    "@xcite ) , and the _ commute time distance _ @xcite ( which is equivalent to the _ resistance distance _",
    "@xcite ) are two related graph metrics that are derived from the random walk , and that can be used to parametrize the graph s geometry .",
    "these metrics can be used to efficiently organize patches in a manner that reveals the local behavior of the associated signal or image . in our previous work @xcite , we have noticed that metrics based on a diffusion , or a random walk concentrate patches that contain rapid changes in the signal or image data .",
    "these patches contain changes associated with singularities ( edges ) , rapid changes in frequency ( textures , oscillations ) , or energetic transients contained in the underlying function .",
    "furthermore , patches that contain only the smooth parts of the image are more spread out according to such graph metrics .",
    "[ [ outline - of - our - approach - and - results ] ] outline of our approach and results + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the main contribution of this work is to provide a theoretical explanation for the above experimental observations .",
    "our approach relies on a detailed analysis of the commute time metric on prototypical graph models that epitomize the geometry observed in general patch - graphs .",
    "we assume that the set of patches is composed of two broad classes : patches within which the function varies smoothly and slowly , and patches where the function exhibits anomalies : singularities , very rapid change in local frequency , etc .",
    "we prove that a parametrization of the graph based on commute times shrinks the mutual distances between vertices that correspond to rapid local changes relative to the distances between vertices that correspond to slow local changes . in effect , our results explain why the parametrization of the set of patches based on the eigenfunctions of the laplacian @xcite can concentrate anomalous patches , which would otherwise be shattered in the space of patches .",
    "this concentration phenomenon can then be exploited for further processing of the patches ( e.g. denoising , classification , etc ) . while our results are based on a large sample analysis ,",
    "numerical experimentations on synthetic and real data indicate that the results hold for datasets that are very small in practice .",
    "[ [ organization ] ] organization + + + + + + + + + + + +    this paper is organized as follows . in the next section ,",
    "we describe the patch - based representation of a signal , and the associated patch - graph .",
    "we develop some intuition about the graph of patches by studying several examples in section [ ssec : firstlookpatchgraph ] . in section",
    "[ sec : patchgraphparam ] , we describe the embedding of the graph of patches based on commute time . the prototypical graph models that allow us to study the parametrization are defined in section [ ssec : theory ] .",
    "the main theoretical result about the embedding of the graph models are presented in section [ ss : ctestimates ] .",
    "numerical experiments confirming our theoretical analysis are presented in section [ sec : experiments ] .",
    "we finish with a discussion in section [ sec : discuss ] .",
    "for simplicity and without loss of generality , we assume that the signal of interest is formed by a sequence of samples , @xmath0 . because we want to extract @xmath1 patches from this sequence , we need @xmath2 extra samples at the end ( hence the @xmath3 samples ) .",
    "we first define the notion of a _",
    "patch_. +    we define a _ patch _ as a vector in @xmath4 formed by a subsequence of @xmath2 contiguous samples extracted from the sequence @xmath5 , @xmath6    as we collect all the patches , we form the _ patch - set _ in @xmath4 .",
    "+    the _ patch - set _ is defined as the set of patches extracted from the sequence @xmath5 , @xmath7    a main objective of this paper is to understand the organization of the patch - set and relate this organization to the presence of local changes in the signal or the image .",
    "we note that the concept of patch is related to the concept of time - delay embedding .",
    "specifically , if the sequence comprises measurements of a dynamical system , then taken s embedding theorem @xcite allows us to replace the unknown phase space of the dynamical system with a topologically equivalent phase space formed by the patch - set ( [ eqn : patchset ] ) .",
    "while in this work we do not assume that the sequence @xmath8 is an observable of a dynamical system , we are nevertheless interested in a similar goal : the organization of patches in @xmath4 .    throughout this paper ,",
    "we think about a patch , @xmath9 , in several different ways .",
    "originally , @xmath9 is simply a snippet of the time series .",
    "then , we think about @xmath9 as a point in @xmath4 . later , we also regard @xmath9 as a vertex of a graph . keeping these three perspectives in mind",
    "is critical to our approach and understanding .    in order to study the discrete structure formed by the patch - set ( [ eqn : patchset ] )",
    ", we connect patches together ( using their nearest neighbors ) and define a graph ( or network ) that we call the _ patch - graph_. +    the _ patch - graph _ ,",
    "@xmath10 , is a weighted graph defined as follows .",
    "the vertices of @xmath10 are the patches @xmath11 .",
    "each vertex @xmath9 is connected to its @xmath12 nearest neighbors using the metric @xmath13    the weight @xmath14 along the edge @xmath15 is given by @xmath16    the edges of the patch - graph encode the similarities between its @xmath17 vertices .",
    "we work with the metric @xmath18 ( defined in ( [ rho ] ) ) because it is not sensitive to changes in the local energy of the signal ( measured by @xmath19 ) .",
    "the metric @xmath18 allows us to detect changes in the signal s local frequency content , or local smoothness .",
    "the parameter @xmath20 controls the scaling of the similarity @xmath21 between @xmath9 and @xmath22 when defining the edge weight @xmath14 .",
    "in particular , @xmath14 will drop rapidly to zero as @xmath21 becomes larger than @xmath20 .",
    "an important remark about the way we measure distances on the graph is in order here .",
    "we use @xmath18 to define the graph topology defined by the edges : which patch is connected to which patch .",
    "this is appropriate since we can compare patches that are similar using @xmath18 ( e.g. two patches containing the same edge , but at different locations ) . on the other hand ,",
    "as explained in section [ sssec : commutetimes ] , we use the commute time to analyze the global geometry of the patch - graph",
    ".     samples . the color of the signals a and b encodes the local variance ( large = red , low = blue ) .",
    "c : seismogram ; the color indicates the temporal proximity to a seismic arrival , identified by vertical black lines .",
    "see text for more details .",
    "[ fig : s2ts ] ]     samples .",
    "the color of the signals a and b encodes the local variance ( large = red , low = blue ) .",
    "c : seismogram ; the color indicates the temporal proximity to a seismic arrival , identified by vertical black lines .",
    "see text for more details .",
    "[ fig : s2ts ] ]     samples .",
    "the color of the signals a and b encodes the local variance ( large = red , low = blue ) .",
    "c : seismogram ; the color indicates the temporal proximity to a seismic arrival , identified by vertical black lines .",
    "see text for more details .",
    "[ fig : s2ts ] ]    , @xmath23 , and @xmath24 pixels respectively .",
    "the color of the pixel at the center of each patch encodes the local variance of the image intensity.[fig : signalsec2im ] ]    indeed , the distance defined by @xmath18 becomes useless when we need to compare very different patches ( e.g. a patch of a uniform region vs a patch that contains an edge ) .",
    "as explained in section [ sssec : commutetimes ] , the global organization of the patches can be discovered by studying the speed at which a random walk propagates along the graph ( via hitting times ) .",
    "finally , we note that the weighted graph is fully characterized by its _ weight matrix_. +    the _ weight matrix _",
    "@xmath25 is the @xmath26 matrix with entries @xmath27 .",
    "the _ degree matrix _ is the @xmath26 diagonal matrix @xmath28 with entries @xmath29 .",
    "the goal of this section is to provide the reader with some intuition about the geometry of the patch - set and the associated patch - graph .",
    "this will help us motivate our graph models and the analysis of their geometry . at the end of the section , we provide a sketch of our plan of attack .",
    "we construct the patch - set associated with some examples of signals and images . because it is not practical to visualize the patch - set in @xmath4 when @xmath30 , we display the projection of the patch - set onto the three - dimensional space that captures the largest variance in the patch - set ( computed using principal component analysis ) .",
    "figure [ fig : s2ts ] displays three signals @xmath31 , with @xmath32 . patches of size @xmath33 samples are extracted around each time sample , which results in the maximum overlap between patches .",
    "signal a is a chirp , signal b is a row of the image lenna ( shown in fig . [",
    "fig : signalsec2im]-d ) , and signal c is a seismogram @xcite .    in order to quantify the local regularity of signals a and b , we compute the variance over each patch , and color the curve according to the magnitude of the local variance : hot ( red ) for large variance and cold ( blue ) for low variance .",
    "the color of signal c encodes the temporal proximity to the arrival of a seismic wave associated with an earthquake : hot color indicates close proximity , while cold corresponds to baseline activity . identifying arrival - times is necessary for purposes such as locating an earthquake s epicenter .",
    "this example illustrates the application of the present work to the problem of detecting seismic waves @xcite .",
    "figure [ fig : signalsec2im ] displays three images .",
    "we extract patches of size @xmath34 . here , the patches are not maximally overlapping : we collect every third patch in the horizontal and vertical directions for images d and e , while we collect every fifth patch in each direction for image f. this results in patch - sets of size @xmath35 for images d and e , and of size @xmath36 for image f. as before , the color of a pixel in the images encodes the local variance within the patch centered at that pixel .",
    "figure [ fig : pcasec2 ] shows the projections of each of the six patch - sets .",
    "distances in figure [ fig : pcasec2 ] correspond to the normalized distance @xmath18 .",
    "we observe that patches with high variance ( red - orange ) appear to be scattered all over @xmath4 .",
    "these patches correspond to regions where the image intensity varies rapidly .",
    "patches with low variance ( blue - green ) , which correspond to regions where the signal is smooth and varies very little , tend to be concentrated along one - dimensional curves ( for time series ) and two - dimensional surfaces ( for images ) .",
    "these visual observations can be confirmed when computing the actual mutual distances between patches ( data not shown ) .",
    "the organization of the patches in the patch - set can be explained using simple arguments .",
    "let us assume that the sequence @xmath8 corresponds to the sampling of an underlying differentiable function @xmath37 , and assume that @xmath38 , the derivative of @xmath37 , remains small over the interval of interest . in this case ,",
    "if two patches @xmath9 and @xmath22 overlap significantly  i.e. @xmath39 is small  then they will be close to one another in @xmath4 .",
    "indeed , the values of the coordinates of patches @xmath9 and @xmath22 will be very similar , since the signal @xmath37 varies slowly . in principle , if the sampling is fast enough , the patches should lie along a one - dimensional curve in @xmath4 . by the same argument ,",
    "when @xmath37 exhibits rapid changes , the magnitude of the derivative , @xmath40 , can be very large , and therefore temporally neighboring patches are not guaranteed to be spatial neighbors in @xmath4 .",
    "this argument allows us to understand the distribution of the patches in the signal b , or the image f.    instead of characterizing patches according to the local smoothness of the underlying function , we can also analyze the distribution of the patches according to the function s local frequency information .",
    "this will help us understand the structure of the patch - set for signal  a.     and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ]    and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ]    and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ] +     and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ]    and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ]    and [ fig : signalsec2im ] . )",
    "[ fig : pcasec2],title=\"fig : \" ]    for this type of signal , it is appropriate to measure the distance between the normalized patches , @xmath41 and @xmath42 after computing the fourier transforms ( a simple rotation of @xmath4 ) of the respective patches .",
    "this process is akin to the concept of time - frequency analysis .",
    "we expect that regions of the signal with little local frequency changes will cluster in @xmath4 : this is the case for the blue patches of the chirp a. on the contrary , when the local frequency content changes rapidly ( as in the middle of the chirp a ) , the corresponding ( red / orange ) patches will be at a large distance of one another in @xmath4 ( see figure [ fig : pcasec2]-a ) .    finally , we can try to understand the organization of the patch - set for the seismogram c. let us assume that @xmath8 is obtained by sampling a function of the form @xmath43 , where @xmath44 represents a seismic wave and @xmath45 represents baseline activity .",
    "we can expect that @xmath44 is a rapidly oscillating transient with a rich frequency content , while @xmath45 is varying slowly .",
    "now consider two patches @xmath9 and @xmath22 .",
    "it can be shown that if both patches @xmath9 and @xmath22 are extracted from the baseline function , @xmath45 , and do not contain any part of the energetic transient , then their mutual distance is expected to be small .",
    "in addition , if @xmath9 contains part of the energetic transient @xmath44 and @xmath22 is extracted from the baseline @xmath45 , then their mutual distance is expected to be large . finally ,",
    "if @xmath9 and @xmath22 are composed of two different parts of @xmath44 , then their mutual distance is also expected to be large ( provided the patches are sufficiently long and @xmath44 oscillates sufficiently fast ) .",
    "more generally , one can expect that two patches extracted from two different energetic transients @xmath46 and @xmath47 will be at a large distance from one another @xcite .     associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]   associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]   associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]     associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]   associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]   associated with signals a - f are displayed as images : @xmath14 is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath49 .",
    "dark structures along the diagonal of the @xmath25 matrix associated with the time series a - c indicate that patches that are close in time are also close in @xmath4 .",
    "[ fig : wssec2],title=\"fig : \" ]      having gained some understanding about the organization of the patch - set , we now move to the structure of the patch - graph and its weight matrix @xmath25 .",
    "figure [ fig : wssec2 ] displays the weight matrices built from the patch - sets that correspond to the time series a - c ( top ) and the images d - f ( bottom ) .",
    "note that when processing time series a - c , the columns ( or equivalently , the rows ) of @xmath25 can be identified with temporally - ordered time - samples . therefore , a large main diagonal in the weight matrix correspond to patches that are close in time and also close in @xmath4 .",
    "for instance , consider the time series a and its associated weight matrix .",
    "the dark bands near the top - left and bottom - right of the diagonal correspond to the slowly - varying oscillations near the beginning and end of the chirp ( see figure [ fig : s2ts ] ) . indeed , large entries in the diagonal of @xmath25 is a direct consequence of relatively little variation in the time series . on the other hand , the columns of @xmath25 corresponding to portions of the time series that exhibit rapid local changes ( center of figure [ fig : wssec2]-a ) tend to lack such prominent diagonal structures . for such regions of the matrix @xmath25 , the entries are no longer concentrated along the diagonal , and are shattered across all rows and columns ( see the center of @xmath25 in figure [ fig : wssec2]-a ; the columns correspond to the fastest oscillations at the center of the chirp ) .",
    "the large distances between these patches are also apparent in the lighter pixel intensities , representing relatively smaller edge - weights .",
    "note that the patches extracted from the seismic data are very far apart , as indicated by the much lighter shades of gray .",
    "it is more difficult to relate the ordering of an image s weight matrix to locations in the image itself . for the weight matrices associated with images",
    "d - f , the ordering of the columns is equivalent to the order in which the patches were collected from the image plane : first left - to - right , then top - to - bottom ( similar to a raster scan , or how one would read pages of a book ) .",
    "hence , periodically repeating dark blocks in the weight matrices associated with images d - f are indicative of image patches that are close in @xmath4 and close in the image - plane as a result of relatively little change in the image s local content .",
    "for example , the dark square - like structure that appears near the main diagonal of @xmath25 in figure [ fig : wssec2]-e , and which spans roughly one fifth of the number of columns , corresponds to the mirror s smooth , light border in image e.      the experiments in sections [ ssec : imsigexample ] and [ ssec : theweightmatrix ] highlight the fact that regions of an image , or of a signal , that contain anomalies ( e.g. singularities , edges , rapid changes in the frequency content , etc . )",
    "are scattered all over the patch - set , making their detection and identification extremely difficult ( see figures [ fig : pcasec2]-a and [ fig : pcasec2]-f ) .",
    "in contrast , patches from smooth regions appear to cluster along low dimensional curves or surfaces .",
    "because the anomalous patches are usually the most interesting ones , we need to find a new parametrization of the patch - set that concentrates the anomalies and separate them from the smooth baseline part of the image .",
    "the structure of @xmath25 in the `` rough regions '' suggest that patches that contain anomalies appear to be very well connected ( see the center of figure [ fig : wssec2]-d , which corresponds to the boa on the hat of lenna ) .",
    "this concept can be quantified by studying how fast a random walk would reach all patches in these rough regions of @xmath25 , and suggest that we should consider studying the hitting times associated with a random walk on the patch - graph . in the next section",
    "we formalize this concept and propose a parametrization of the patch - set in terms of commute time .",
    "a theoretical analysis of this approach is provided in section [ ssec : theory ]",
    "we first introduce the concept of _ fast _ and _ slow _ patches .",
    "we have noticed that patches that contain anomalies ( discontinuities , edges , fast changes in frequency , etc . ) in the original signal lead to regions of the matrix @xmath25 where the nonzero entries are scattered all around .",
    "we call such patches _ fast patches _ because , as we will see in the following , a random walk will diffuse extremely fast in such regions of the patch - graph .",
    "conversely smooth regions of the signal lead to _ slow patches _ that are associated with a small number of large entries in @xmath25 , which are concentrated along the diagonal .",
    "a random walk initialized in the slow patch region of the patch - graph will diffuse very slowly .      as explained previously",
    ", we propose to replace the euclidean distance , which leads to the scattering of the fast patches seen in figure [ fig : pcasec2 ] by a notion of distance that quantifies the speed at which a random walk diffuses on the patch - graph .",
    "we propose to use the commute time . parametrizing the graph using its commute time distance",
    "is closely related to parametrizing the graph using its diffusion distance @xcite ( see section [ sss : sdcommute ] ) .",
    "although the works @xcite do not explicitly embed vertices of the patch - graph based on the diffusion distance , they also study a random walk on the patch - graph , and define the diffusion distance in terms of this walk . in these studies ,",
    "noise is removed by evolving the diffusion process for a small time .",
    "a detailed comparison of our approach with the seminal work of @xcite is provided in section [ ssec : relatedwork ] .",
    "we note that the notion of first - passage time associated with a diffusion ( which is equivalent to the hitting time associated with a random walk ) has been used extensively to characterize the geometry of complex networks , and random media ( e.g. @xcite and references therein ) .",
    "it is therefore natural to analyze the patch - set with this distance .      in order to define the commute time between two vertices",
    ", we first need to define a random walk on the graph . in our problem , the random walk does not correspond to a physical process , but will lead to a notion of global proximity between patches .",
    "we consider a first - order homogeneous markov process , @xmath50 , defined on the vertices of the patch - graph , @xmath10 , and evolving with the transition probability matrix @xmath51 given by @xmath52 consider a slow patch @xmath9 extracted from a regular / smooth part of the signal .",
    "if the random walk starts at @xmath9 , then it can only travel along the low - dimensional structure that corresponds to the temporal neighbors of @xmath9 ( see e.g. figure [ fig : pcasec2]-a . )",
    "the existence of this narrow bottleneck is also visible in the @xmath25 matrix ( see figure [ fig : wssec2]-a ) : a random walk initialized within the fat diagonal of the upper left corner of @xmath25 ( the low frequency part of the chirp ) is trapped in this region of the matrix , and can only travel along this fat diagonal . as a result , it will take many steps for the random walk to reach another slow patch @xmath22 if @xmath53 is large .",
    "this notion can be quantified by computing the average _ hitting - time _ , @xmath54 , which measures the expected minimum number of steps that it takes for the random walk , started at vertex @xmath9 , to reach the vertex @xmath22",
    "@xcite @xmath55 where the expectation @xmath56 is computed when the random walk is initialized at vertex @xmath9 , i.e. when @xmath57 .",
    "the commute time @xcite : provides a symmetric version of @xmath58 , and is defined by @xmath59      when the random walk is reversible and the graph is fully connected , the commute time can be expressed using the eigenvectors @xmath60 of the symmetric matrix @xmath61 the corresponding eigenvalues can be labeled such that @xmath62 .",
    "each eigenvector @xmath63 is a vector with @xmath17 components , one for each vertex of the graph .",
    "hence , we write @xmath64 to emphasize the fact that we consider @xmath63 to be a function sampled on the vertices of @xmath10 .",
    "the commute time can be expressed as @xmath65 where @xmath66 is the stationary distribution associated with the transition probability matrix @xmath51 @xcite .",
    "the _ diffusion distance _",
    "@xcite between vertices @xmath22 and @xmath9 , @xmath67 , measures the distance between the transition probability distributions  computed at time @xmath68  of two random walks initialized at @xmath9 and @xmath22 , @xmath69 .",
    "the diffusion distance can also be decomposed in terms of the eigenvectors @xmath63 @xcite , @xmath70 where @xmath71 is the volume of the graph .",
    "it follows that the commute time is a scaled sum of the squares of diffusion distances computed at all times , @xmath72 the significance of this equation is that the commute time includes the short term evolution ( @xmath73 ) as well as the asymptotic regime ( @xmath74 ) of the random walk .",
    "we will come back to this analysis in section [ ssec : pgm ] .",
    "equation ( [ eqn : commutetime ] ) suggests the following embedding @xmath75 of the patch - graph @xmath10 into @xmath76 , @xmath77 if we agree to measure the distance on the graph @xmath10 using the square root of the commute time , then the mutual euclidean distance after embedding is equal to the original distance on the graph , @xmath78 the result is a direct consequence of ( [ eqn : diffusiondist ] ) and ( [ alltimes ] ) .",
    "similar ideas were first proposed in @xcite to embed manifolds and are the foundation of the parametrizations given in @xcite . in practice , we need not use all the @xmath79 coordinates in the embedding defined by ( [ eqn : mapton1 ] ) . indeed , since @xmath80 , we have that @xmath81 , and therefore , if we can accept some approximation error , we can use only the first @xmath82 coordinates of @xmath75 . as we will see in section [ ssec : pgm ] , this dimension reduction further improves the separation between slow patches and fast patches . in the remaining of the paper we will work with the embedding of @xmath10 into @xmath83 defined by @xmath84",
    "we note that we can always choose @xmath82 such that the embedding @xmath85 almost preserves the commute time , @xmath86 in fact , our experiments indicate that this approximation holds for small values of @xmath82 .",
    "after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]   after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]   after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]     after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]   after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]   after parametrizing using @xmath85 in ( [ eqn : lowdparam ] ) , with @xmath87 .",
    "the fast patches ( red and orange ) are now concentrated and have been lumped together .",
    "the slow patches ( blue - green ) remain aligned along curves ( for time - series ) and surfaces ( for images ) .",
    "[ fig : graphparams ] , title=\"fig : \" ]      figure [ fig : graphparams ] displays the embedding of the patch - sets associated with signals and images a - f using the map @xmath85 ( [ eqn : lowdparam ] ) , where @xmath88 . the blue curve in figure [ fig : graphparams]-a corresponds to the slow patches ( low frequencies of the chirp ) that are connected according to their temporal proximity . on the other hand ,",
    "red and orange patches extracted from the high frequency part of the chirp are now concentrated in a relatively small region ( compare to figure [ fig : pcasec2]-a ) .",
    "similar features are seen in the parametrizations of the patch - graphs associated with signals b - f .",
    "the embedding of the patch - graph @xmath10 defined by @xmath85 , in ( [ eqn : lowdparam ] ) , should lead to a representation of the patch - set in @xmath83 where distances correspond to commute times measured along the graph before embedding .",
    "our goal is to explain the concentration of the fast patches created by the embedding @xmath85 ( see e.g. figure [ fig : graphparams ] ) .",
    "our approach is based on a theoretical analysis of a graph model that epitomizes the characteristic features observed in patch - graphs composed of a mixture of fast and slow patches .",
    "this model is composed of two subgraphs : a subgraph of _ slow patches _ , which are extracted from the smooth regions of the signal , and a subgraph of _ fast patches _",
    ", which are extracted from the regions of the signal that contain singularities , changes in frequency , or energetic transients .",
    "we confirm our theoretical analysis with numerical experimentations using synthetic signals in section [ sec : experiments ] , and we demonstrate that our conclusions are in fact applicable to a larger class of patch - graphs . the graph models are introduced in section [ ssec : modelgraphs ] .",
    "our theoretical analysis of the embedding of the graph models is given in section [ ss : ctestimates ] .",
    "we evaluate the performance of the embedding @xmath85 when @xmath82 is small in section [ ssec : pgm ] .",
    "we define the graph models in terms of the nonzero entries in the associated weight matrix @xmath25 . without loss of generality , we assume that the number of vertices @xmath17 is even .    [ [ the - slow - graph - model ] ] the slow graph model + + + + + + + + + + + + + + + + + + + +    the large entries in a weight matrix @xmath25 of a patch - graph composed only of slow patches will have large entries when @xmath89 is small are ordered according to increasing index @xmath90 of the sequence @xmath8 .",
    "this assumption does not affect the graph s parametrization nor our theoretical conclusions , but allows us to interpret the structure in @xmath25 . ] : temporal / spatial proximity implies proximity in patch - space ( see e.g. figure [ fig : wssec2]-a , top corner ) .",
    "we therefore define the _ slow graph model _ as follows .",
    "+    the slow graph @xmath91 is a weighted graph composed of @xmath17 vertices ,    @xmath92 .",
    "the weight on the edge @xmath93 is defined by @xmath94 [ slowgraph ]    the weight @xmath95 is a positive real number that models the distance between two temporally adjacent patches .",
    "the parameter @xmath96 characterizes the thickness of the diagonal in @xmath25 .",
    "the slow graph is fully connected and each vertex has at most @xmath97 neighbors , not including self - connections ( see figure [ fig : graphmodels ] ) .",
    "hence , we require that @xmath98 .",
    "finally , note that the slow graph is distinct from a regular ring , since the first and last vertices are not connected .",
    "we do not consider a regular ring since it would imply that the underlying signal is periodic .",
    "[ [ the - fast - graph - model ] ] the fast graph model + + + + + + + + + + + + + + + + + + + +    we now consider the model for a patch - graph built from a patch - set comprising only fast patches .",
    "as demonstrated in section [ ssec : firstlookpatchgraph ] , most of the entries in @xmath25 have similar sizes , and appear to be scattered throughout the matrix : temporal / spatial proximity does not correlate with proximity in patch space .",
    "in fact , fast patches are all far away from one another .",
    "we therefore define the _ fast graph model _ as follows .",
    "+    [ fastgraph - def ] the fast graph @xmath99 is a random weighted graph composed of @xmath17 vertices , @xmath92 . the weight on the edge @xmath100 is defined by @xmath101    the weight @xmath102 is a positive real number that models the distance between two fast patches .",
    "the fast graph model is equivalent to a weighted version of the erds - renyi graph model @xcite , except that @xmath99 contains self - connections and has edge weights possibly less than one .",
    "the parameter @xmath103 controls the density of the edges ; @xmath104 corresponds to a fully connected graph ( clique ) .",
    "is composed of a slow graph @xmath105 ( blue ) and a fast graph @xmath106 ( orange ) , connected by random edges ( green).[fig : graphmodels ] ]     of the fused graph model @xmath107 is displayed as an   is encoded as a grayscale value : from white ( @xmath48 ) to black @xmath108 .",
    "the entries of @xmath25 associated with the slow graph appear in the upper - left quadrant of @xmath25 .",
    "entries associated with the fast graph appear in the lower right quadrant .",
    "random edges between the fast graph and slow graph appear in the upper right and lower left quadrants .",
    "[ fig : randgwmatrix ] ]    [ [ the - fused - graph - model ] ] the fused graph model + + + + + + + + + + + + + + + + + + + + +    the _ fused graph model _ exemplifies the patch - set associated with a signal , or an image , which exhibits regions of fast and slow changes .",
    "the fused graph combines a slow and a fast subgraph of equal size ( see figure [ fig : graphmodels ] ) .",
    "+    the fused graph @xmath109 is a weighted graph composed of a slow subgraph @xmath105 and a fast subgraph @xmath106 . in addition , edges between @xmath105 and @xmath106 are created randomly and independently with probability @xmath110 and assigned the edge weight @xmath111 . [",
    "fused ]    edges between @xmath105 and @xmath106 ensure that @xmath109 is connected ( a requirement for the validity of the parametrization ( [ eqn : mapton1 ] ) ) .",
    "these edges allow us to model patches that are extracted from regions of the image that combine edges / transients and smooth intensity .",
    "if @xmath110 is so small that no edges are created between the two subgraphs , then an edge is placed at random between the two subgraphs to ensure that the final fused graph is connected .",
    "the true patch - graph is always constructed using a @xmath12 nearest neighbor rule ( see section  [ sec : patchgraph ] ) : each patch is connected to @xmath12 other patches . in order to mimic a true patch - graph , we adjust the thickness @xmath96 of the slow subgraph to the density of the edge connection , @xmath103 , in the fast subgraph , so that on average , each vertex in the fused graph is connected to @xmath97 vertices . we know that the number of edges between distinct vertices in @xmath99 is a binomial random variable with expectation @xmath112",
    "since the total number of edges between distinct vertices of @xmath91 is equal to upper diagonals of the matrix @xmath25 . ]",
    "@xmath113 we choose @xmath114 this choice of @xmath103 guarantees that the expected number of edges in @xmath99 is equal to the number of edges in @xmath91 .",
    "furthermore , provided that @xmath115 , a short computation shows that , for large values of @xmath17 , this choice of @xmath103 also ensures that the expected degree of a vertex in @xmath99 is equal to the average degree of a vertex in @xmath91 .",
    "figure [ fig : randgwmatrix ] shows the nonzero entries in the weight matrix associated with one realization of the fused graph model using parameters @xmath116 , @xmath117 and @xmath118 .",
    "vertices @xmath9 with @xmath119 are only connected to other vertices @xmath22 if @xmath120 .",
    "this connectivity mimics the spatial ( temporal ) connectivity present in the smooth parts of an image ( signal ) .",
    "our goal is to understand the effect of the embedding @xmath85 defined by ( [ eqn : lowdparam ] ) on the fused graph .",
    "it turns out that studying the embedding of each individual subgraph ( slow and fast ) separately is much more tractable than considering the entire fused graph . to complement our theoretical study of the fast and the slow subgraphs",
    ", we provide numerical evidence in sections [ ssec : pgm ] that indicates that our understanding of the embedding of the subgraphs can be used to analyze the embedding of the fused graph . in section [ sec : experiments ] , we confirm that our theoretical analysis can be applied to true patch - graphs . instead of studying @xmath85 directly , we take advantage of the fact that the embedding @xmath85 almost preserves the commute time ( see ( [ pseudo - isometry ] ) )",
    ". we can therefore understand the effect of the embedding on the distribution of mutual distances @xmath121 within a subgraph by studying the distribution of the commute times @xmath122 on that subgraph .",
    "while it would appear that it is a straightforward affair to compute the commute time on the slow graph , the computation becomes rapidly intractable .",
    "for this reason we provide lower and upper bounds for the average commute time on the slow and fast subgraphs , respectively .",
    "this is sufficient for our needs , since the two bounds rapidly separate even for low values of @xmath17 . to estimate these bounds , we rely on the connection between commute times on a graph and effective resistance on the corresponding electrical network @xcite . specifically , we map a graph to an electrical circuit as follows : each edge with weight @xmath14 becomes a resistor with resistance @xmath123 .",
    "the vertices of the graph are the connections in the circuit . given two vertices , @xmath9 and @xmath22 in the circuit , one can compute the effective resistance between these nodes , @xmath124 .",
    "the key result @xcite is that @xmath125 , where @xmath126 is the volume of the graph .    before stating the main lemma ,",
    "let us take a moment to compute some rough estimates of the commute times on the slow and fast graphs .",
    "to get some quick answers , we consider the simplest versions of the two graph models .",
    "when @xmath127 , the slow graph @xmath128 is a _ path _ with self - connections . on a path of @xmath17 vertices",
    "_ without _ self - connections , the commute time between vertex @xmath9 and @xmath22 is equal to @xmath129 .",
    "therefore , the average commute time ( computed over all pairs of vertices ) on a path of length @xmath17 is @xmath130 .",
    "while it would make sense that adding edges to a path should decrease the commute time , this is usually not true @xcite . nevertheless , the presence of edges that allow the random walk to move forward by a distance @xmath96 at each time step lead us to conjecture that the average commute time on @xmath91 should be of the order @xmath131 .",
    "in fact , as we will see in lemma [ prop : prop2 ] , the average commute time of the slow graph is of the order @xmath132 . with regard to the fast graph , we can analyze the case where the density of edges @xmath104 .",
    "in this case , the fast graph @xmath133 is a _ complete graph _ , or _ clique _ , and every vertex is connected to every other vertex . in a complete graph ,",
    "the average commute time is @xmath134 .",
    "since the fast graph can be regarded as a complete graph whose edges have been removed with probability @xmath135 , we expect the commute time to be slightly larger than @xmath134 , since removing edges restricts the random walker s options to get from one vertex to another .",
    "again , in agreement with our intuition , lemma [ prop : prop2 ] asserts that in the fast graph , the commute time is of the order of @xmath136 { \\mathcal{o}}(n)$ ] .",
    "we are now ready to state the main lemma .",
    "our results will be stated in terms of the `` average behavior '' of the commute time on each graph , a concept that we need to define properly . in the case of the slow graph , which is deterministic , we consider the average commute time computed over all pairs of vertices .",
    "+    let @xmath137 be the average commute time between vertices in the slow graph @xmath91 @xmath138    in the case of the fast graph , the `` average behavior '' of the commute time needs to be defined more carefully .",
    "indeed , each fast graph is a realization of a stochastic process , and therefore we need to consider the _ expectation _ of the commute time .",
    "more precisely , given a realization , @xmath139 , of a fast graph , we compute the expected commute time @xmath140 $ ] as the expectation of @xmath141 over all possible random assignment of the vertices @xmath9 and @xmath22 .",
    "we then need to consider how @xmath140 $ ] varies as a function of @xmath142 .",
    "therefore , we compute a second expectation over all possible random graphs @xmath139 .",
    "the expected commute time @xmath143 on a fast graph @xmath139 generated according to ( [ fastgraph - def ] ) is defined by @xmath144\\right].\\ ] ] where the inner expectation is computed over all random assignments of the vertices @xmath145 given a realization @xmath139 of a fast graph geometry , and the outer expectation is computed over all possible realizations @xmath139 of the fast graph .",
    "+    we have @xmath146 we also have @xmath147 provided that , for all assignments of the vertices @xmath22 and @xmath9 , and for all fast graphs @xmath139 , the covariance @xmath148 between the number of edges , @xmath149 , and the effective resistance , @xmath150 , of the associated electrical circuit is nonpositive .",
    "[ prop : prop2 ]    the proofs are given in appendix [ sec : ctproofs ] .",
    "+ because @xmath96 needs to grow logarithmically with @xmath17 ( to ensure that @xmath99 is connected with high probability ; see appendix [ sssec : connectedr ] ) , we choose @xmath151 for some @xmath152 , and the upper bound on @xmath143 is negligible relative to the lower bound on @xmath137 , when @xmath17 is large .",
    "+    assume that @xmath151 for some constant @xmath152 .",
    "it follows that , as @xmath153 , the lower bound on @xmath137 grows like @xmath154 , and the upper bound on @xmath143 grows like @xmath155 .",
    "furthermore , the lower bound on @xmath137 grows faster than the upper bound on @xmath143 , and so with a probability that approaches one as @xmath156 , @xmath157 [ prop : prop21 ]    notice that @xmath158 is bounded away from zero . because the choice of @xmath96 guarantees that the fast graph is connected with a probability approaching one , @xmath159 is finite with probability approaching one . therefore the ratio @xmath160 is bounded below by zero and from above by a ratio of the bounds from lemma [ prop : prop2 ] .",
    "the ratio of bounds goes to zero , which follows from a simple , but lengthy , limit calculation .     + we can translate the corollary in terms of the mutual distance between vertices of the subgraphs after the embedding @xmath85 : @xmath161 will be more concentrated than @xmath162 .",
    "the results of section [ ss : ctestimates ] apply to the exact commute times on the graph models .",
    "however , as mentioned in section [ ssec : paramthegraph ] , it is more practical to use a truncated version of the spectral expansion of the commute time , defined by equation ( [ eqn : commutetime ] ) .",
    "we also noticed that the commute time encompasses the short term evolution ( @xmath73 ) as well as the asymptotic regime ( @xmath74 ) of the behavior of the random walk . neglecting eigenvalues @xmath63 for large",
    "@xmath163 emphasizes the long term behavior of the random walk , and we expect that it should further increase the difference between the slow and fast graphs . in this section",
    ", we confirm experimentally that approximating the commute times by truncating the expansion ( [ eqn : commutetime ] ) actually emphasizes the separation between the fast subgraph and the slow subgraph in the fused graph model . in all the numerical experiments in this section ,",
    "unless otherwise stated , we fix @xmath164 , @xmath165 , @xmath103 is chosen according to ( [ eqn : pdefined ] ) , @xmath166 , and @xmath167 . in all experiments ,",
    "we compute the eigenvalues @xmath168 of the matrix @xmath169 associated with the fast graph , the slow graph , and the fused graph .    [ [ slow - and - fast - subgraphs - two - different - dynamics - revealed - by - the - spectral - decomposition ] ] slow and fast subgraphs : two different dynamics revealed by the spectral decomposition + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we first provide a back - of - the - envelope computation of the spectrum of the slow and fast graphs . as we have noticed",
    "before , the slow graph model is a `` fat '' path .",
    "we know that the spectrum of a path without self - connections @xcite is given by @xmath170 , \\quad k =   1,2,\\ldots , n.\\ ] ] we expect therefore that the eigenvalues associated with the slow graph will decay slowly away from one for small @xmath163 .",
    "figure [ fig : modelspectra ] ( inset ) displays the eigenvalues associated with the slow graph model . as expected , the spectrum is flat around @xmath171 and exhibits the slowest decay of all the graph models .",
    "we use the similarity between the fast graph model and the erds - renyi graph to predict the spectrum of the fast graph . except for @xmath172 , all the other eigenvalues of an erds - renyi graph asymptotically",
    "follow the wigner semicircle distribution @xcite .",
    "our numerical experiments confirm this prediction : as shown in figure [ fig : modelspectra]-right , the eigenvalues of the fast graph appear to be distributed along a semicircle .",
    "the decay of the spectrum has a direct influence on the dynamics of the random walk .",
    "specifically , the spectral gap controls the _ mixing rate _ ,",
    "which measures the expected number of time - steps that are necessary to reduce the distance between the probability distribution after @xmath68 steps @xmath173 and the stationary distribution @xmath174 by a certain factor @xcite .",
    "this concept is justified by the fact that the convergence of @xmath173 is exponential @xcite , and is given by @xmath175 where @xmath176 ( which is related to the spectral gap ) , and @xmath177 is the smallest entry of the stationary distribution . since @xmath178 is much larger in the slow graph than in the fast graph , we expect that convergence to the associated stationary distribution will take longer on the slow graph than on the fast graph .",
    "[ [ the - dynamic - of - the - fused - graph - is - enslaved - by - the - slow - subgraph ] ] the dynamic of the fused graph is enslaved by the slow subgraph + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we now consider a random walk on the fused graph .",
    "if this random walk begins at @xmath9 in the fast subgraph of the fused graph , then after a small number of steps , @xmath179 , the probability of finding the random walker at any other vertex @xmath22 in the fast subgraph is close to the stationary distribution , @xmath180 . on the other hand , during the same amount of steps ,",
    "a random walk initialized in the slow subgraph will only explore a small section of the slow subgraph , and consequently , the transition probabilities will still be similar to its initial values @xmath181 . as a result , the restriction imposed by the geometry of the slow subgraph is expected to decrease the convergence rate of the transition probabilities on the fused graph .",
    "we confirm this analysis with experimental results .",
    "figure [ fig : modelspectra ] ( inset ) shows that for @xmath182 the eigenvalues associated with the fused graph and the eigenvalues associated with the slow graph exhibit slow decay away from one , thereby increasing the convergence rate given in ( [ eqn : relativepwdistance ] ) . for @xmath183 , the eigenvalues of the fused graph decay at a rate similar to that of the fast graph . finally , for @xmath184 the eigenvalues of the fused graph join those of the slow graph ( see also the histogram in figure [ fig : modelspectra]-right ) .",
    "we have observed experimentally that these transitions in the behavior of the spectrum of the fused graph are not affected by varying the parameters @xmath17 , @xmath96 , and @xmath110 .",
    "we     of the matrix @xmath169 associated with the fused ( green ) , slow ( blue ) , and fast ( orange ) graphs . left : @xmath185 as a function of @xmath163 ; right : histogram of the @xmath185.[fig : modelspectra],title=\"fig : \" ]   of the matrix @xmath169 associated with the fused ( green ) , slow ( blue ) , and fast ( orange ) graphs . left : @xmath185 as a function of @xmath163 ; right : histogram of the @xmath185.[fig : modelspectra],title=\"fig : \" ]     associated with the slow ( left ) , fast ( center ) , and fused ( right ) graphs .",
    "right : the large amplitude of the eigenvectors @xmath63 on the first half of vertices ( blue ) belonging to the slow subgraph leads to a larger separation between the fast and slow subgraphs when truncating the commute time expansion . [",
    "fig : modelvectors],title=\"fig : \" ]   associated with the slow ( left ) , fast ( center ) , and fused ( right ) graphs .",
    "right : the large amplitude of the eigenvectors @xmath63 on the first half of vertices ( blue ) belonging to the slow subgraph leads to a larger separation between the fast and slow subgraphs when truncating the commute time expansion .",
    "[ fig : modelvectors],title=\"fig : \" ]   associated with the slow ( left ) , fast ( center ) , and fused ( right ) graphs .",
    "right : the large amplitude of the eigenvectors @xmath63 on the first half of vertices ( blue ) belonging to the slow subgraph leads to a larger separation between the fast and slow subgraphs when truncating the commute time expansion . [",
    "fig : modelvectors],title=\"fig : \" ]    conclude that the slow subgraph has the largest influence on the first few ( small @xmath163 ) eigenvalues @xmath185 of the fused graph .",
    "[ [ the - eigenvectors - of - the - fused - graph - and - their - impact - on - the - commute - time ] ] the eigenvectors of the fused graph and their impact on the commute time + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the transition exhibited in the spectrum of the fused graph can also be detected in the corresponding eigenvectors @xmath63 .",
    "figure [ fig : modelvectors ] shows the eigenvectors @xmath186 corresponding to the three graph models .",
    "the first eigenvector @xmath187 has entries equal to the square root of the stationary distribution , @xmath188 , and is not used in the expansion of the commute time ( [ eqn : commutetime ] ) .",
    "as expected , the random walk spends most of its time inside the slow subgraph of the fused graph , as indicated by the larger values of @xmath187 for the first ( blue ) @xmath189 vertices ( see figure [ fig : modelvectors]-right ) .",
    "the eigenvectors @xmath190 of the fused graph exhibit large amplitude oscillations over the vertices belonging to the slow subgraph ( first half  shown in blue  of the plots in figure [ fig : modelvectors]-right ) , which resemble those found in the eigenvectors associated with the slow graph ( figure [ fig : modelvectors]-left ) . as @xmath163 increases , the eigenvectors @xmath63 of the fused graph become more and more similar to the eigenvectors of the fast graph .",
    "the impact of the eigenvectors @xmath63 on the commute time on the fused graph can be analyzed by estimating the size of the terms @xmath191 in the spectral expansion ( [ eqn : commutetime ] ) of the commute time @xmath192 .",
    "we claim that @xmath193 will be small if both vertices @xmath9 and @xmath22 are in the fast subgraph , and that @xmath192 will be large if either vertex is in the slow subgraph .",
    "we can first estimate the size of @xmath194 .",
    "we observe that the eigenvectors @xmath63 for small values of @xmath163 have large amplitude oscillations on vertices belonging to the slow subgraph , but are relatively constant on the fast subgraph ( see figure [ fig : modelvectors]-right ) .",
    "therefore , for small values of @xmath163 , each term ( [ single ] ) will be small when @xmath9 and @xmath22 both belong to the fast subgraph ( we also have @xmath195 when two vertices belong to the same subgraph ) .",
    "conversely , these terms will be large when either @xmath9 or @xmath22 belongs to the slow subgraph .",
    "while this analysis of the size of the terms ( [ single ] ) only holds for small values of @xmath163 , it turns out that these are the terms that have the largest influence in the expansion of the commute time ( [ eqn : commutetime ] ) .",
    "indeed , the spectrum of the fused graph decays slowly , and therefore the first few coefficients @xmath196 in the commute time expansion ( [ eqn : commutetime ] ) are much larger than the remainders , and therefore the terms ( [ single ] ) for small values of @xmath163 will provide the largest contribution in the expansion of the commute time .    we conclude that @xmath193 is small when @xmath9 and @xmath22 belong to the fast subgraph , and @xmath193 is large when either vertex is in the slow subgraph .",
    "furthermore , we expect that this difference will be further magnified if we replace the exact expansion of @xmath192 in ( [ eqn : commutetime ] ) by an approximation that only includes the first few values of @xmath163 .",
    "[ [ the - truncated - spectral - expansion - of - the - commute - time - increases - the - contrast - between - the - slow - and - fast - subgraphs ] ] the truncated spectral expansion of the commute time increases the contrast between the slow and fast subgraphs + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we finally come to the heart of the section : the numerical computation of the average approximate commute time defined by @xmath197 because of ( [ isometry ] ) , we expect that @xmath198 will be close to the true commute time @xmath192 .",
    "we compute @xmath198 for the three graphs : slow , fast and fused .",
    "we generated 25 realizations of the fast and fused graphs , and we estimated the expected commute time with the sample mean , given by @xmath198 in ( [ approx - commute ] ) .",
    "figure [ fig : kapparatios]-a displays @xmath199 as a function of the number of terms @xmath82 used in the embedding ( [ eqn : lowdparam ] ) , for several values of the number of vertices @xmath17 , for the slow and fast graphs .",
    "our theoretical analysis of @xmath200 , performed in corollary [ prop : prop21 ] , is only valid for large values of @xmath17 .",
    "nevertheless , our numerical simulations indicate that for very low values of @xmath17 , @xmath143 is already smaller than @xmath143 , since all ratios are below one ( see figure [ fig : kapparatios]-a ) .",
    "furthermore , we see that this ratio is even smaller for smaller values of @xmath82 .",
    "we observe similar results when the commute times @xmath201 and @xmath202 are computed within the slow the fast subgraphs of the fused graph ( see     as a function of the dimension @xmath82 of the embedding @xmath85 , for several values of the number of vertices @xmath17 .",
    "left : slow @xmath203 and fast @xmath139 graphs separately ; right : slow and fast subgraphs in the fused graph @xmath204 .",
    "[ fig : kapparatios],title=\"fig : \" ]    as a function of the dimension @xmath82 of the embedding @xmath85 , for several values of the number of vertices @xmath17 .",
    "left : slow @xmath203 and fast @xmath139 graphs separately ; right : slow and fast subgraphs in the fused graph @xmath204 .",
    "[ fig : kapparatios],title=\"fig : \" ]    . left : slow graph @xmath203 and fast graph @xmath139 .",
    "right : @xmath198 for the three types of transition between the subgraphs of the fused graph @xmath204 . note the logarithmic scale on the horizontal axes .",
    "[ fig : kappadistributions],title=\"fig : \" ] . left : slow graph @xmath203 and fast graph @xmath139 .",
    "right : @xmath198 for the three types of transition between the subgraphs of the fused graph @xmath204 . note the logarithmic scale on the horizontal axes .",
    "[ fig : kappadistributions],title=\"fig : \" ]     as function of @xmath17 . left : slow graph @xmath203 and fast graph @xmath139 .",
    "right : @xmath198 for the three types of transition between the subgraphs of the fused graph @xmath204 .",
    "[ fig : kappaboundsexperimental],title=\"fig : \" ]   as function of @xmath17 . left : slow graph @xmath203 and fast graph @xmath139 .",
    "right : @xmath198 for the three types of transition between the subgraphs of the fused graph @xmath204 .",
    "[ fig : kappaboundsexperimental],title=\"fig : \" ]    figure [ fig : kapparatios]-b ) .",
    "these results confirm that the embedding @xmath85 will further concentrate the vertices of the fast graph if @xmath82 is chosen to be much smaller than @xmath17 .",
    "we have observed experimentally that choosing @xmath205 leads to the smallest ratio of averages , not only on the graph models , but also on the general patch - graphs studied in section [ sec : experiments ] .",
    "the enslaving of the fused graph by the slow graph is clearly shown in figure [ fig : kappadistributions]-b , where the normalized histogram of @xmath198 is shown for the three types of transition between the subgraphs of the fused graph @xmath204 : slow @xmath206 slow , fast @xmath206 fast , and slow @xmath206 fast .",
    "the histogram of the slow @xmath206 fast transition is very similar to the histogram of the slow @xmath206 slow transition , clearly indicating that once the random walk is trapped in the slow subgraph , the presence of the fast subgraph does not help the random walk escape from the slow graph .",
    "we also notice that the average of @xmath198 for the fast @xmath206 fast transition is roughly two orders of magnitude smaller than the average of @xmath198 for the slow @xmath206 slow , or slow @xmath206 fast transitions .",
    "in addition , the variance of each distribution is small enough to limit the overlap between the distributions .",
    "figure [ fig : kappaboundsexperimental ] displays @xmath198 as a function of the number of vertices @xmath17 , where @xmath207 .",
    "again , this result confirms that the asymptotic analysis of the ratio @xmath200 , performed in corollary [ prop : prop21 ] , actually holds for very small values of @xmath17 . indeed , whether the slow and fast graphs are considered separately ( figure [ fig : kappaboundsexperimental]-a ) , or are the components of the fused graph ( figure [ fig : kappaboundsexperimental]-b ) , the ratio @xmath208 ( note the logarithmic scale ) .",
    "it is important to bear in mind that when analyzing images , @xmath17 is typically of the order of @xmath209 and therefore our theoretical analysis will hold without any difficulty .",
    "lastly , we again note in figure [ fig : kappaboundsexperimental]-b that the transitions slow @xmath206 fast in the fused graph have the same dynamics as the transition slow @xmath206 slow .",
    "we have confirmed experimentally that embedding the fused graph using @xmath85 shrinks the mutual distance between vertices of the fast subgraph , effectively concentrating these vertices closer to one another . as a result",
    ", the embedding helps divide the fused graph into the slow and the fast subgraphs by concentrating the vertices of the fast subgraph away from the vertices of the slow subgraph .",
    "our analysis of the embedding is based on the fact that @xmath85 approximately preserves the commute time measured on the fused graph .",
    "furthermore , we have demonstrated that a truncated version of the commute time , @xmath198 , is even more conducive to identifying vertices of the fast subgraph of the fused graph .",
    "the implication of these results is that the embedding of the true patch - graph @xmath10 using @xmath85 will concentrate the `` anomalous '' patches , which contain rapid changes in the signal , away from the baseline patches .",
    "this concentration of the fast anomalous patches happens for values of the embedding dimension @xmath82 that are of the order of @xmath210 : this choice of @xmath82 results in a low - dimensional embedding of the patch - graph .",
    "because the fast patches are more clustered after embedding , their detection  for the purpose of detection of anomalies , classification , or segmentation  will become much easier .",
    "finally , we note that our theoretical analysis can be extended to a more general context where patches are replaced by a vector of local features extracted from elements of a large dataset .",
    "the only requirement is that the graph of features exhibit a geometry similar to the fused graph @xmath204 .",
    "in this section we validate our theoretical results using synthetic signals .",
    "each signal is the realization of a stochastic process with a prescribed autocorrelation function .",
    "we study two types of stochastic processes : one that generates signals that transition from low to high local frequency , and a second one that yields signals with varying local smoothness .",
    "we argue that these signals embody the types of local changes that are of fundamental importance in many areas of image processing . for both classes of signals , we embed the patch - sets using @xmath85 in ( [ eqn : lowdparam ] ) .",
    "we study the property of the embedding by quantifying the average commute time @xmath198 , defined in ( [ approx - commute ] ) between fast    ) is shown in blue ; the high frequency portion ( @xmath211 ) is shown in orange .",
    "there are four subintervals ( @xmath212 ) .",
    "[ fig : autocorrelations1 ] ]    ) is shown in blue ; the irregular portion ( @xmath213 ) is shown in orange .",
    "there are four subintervals ( @xmath212 ) .",
    "[ fig : autocorrelations11 ] ]    and slow patches , and we compare the numerical results with the theoretical predictions given in section [ ssec : theory ] .",
    "we consider two types of models : a time - frequency signal model and a local regularity signal model .",
    "each model is characterized by an autocorrelation function .",
    "the autocorrelation function can be modified using a parameter that controls the local frequency , or the local regularity of the signal .",
    "we partition the interval @xmath214 $ ] into subintervals over which the autocorrelation parameter is kept constant .",
    "the parameter alternates between two different values creating subintervals of alternating local frequency , or alternating local regularity . the number of alternations is chosen randomly according to a homogeneous poisson process with intensity @xmath215 : there are on the average @xmath216 subintervals .",
    "a simpler version of this model has been used in @xcite to mimic the presence of edges in images . unlike the model used in @xcite ,",
    "we adjust the signal defined on each subinterval so that the result is continuous on @xmath214 $ ] . in all experiments that we report here we use @xmath217 .",
    "the autocorrelation function associated with the time - frequency signal model is given by @xmath218 where @xmath219 , @xmath220 .",
    "as the autocorrelation parameter @xmath221 increases , the range of frequencies present in the signal also increases .",
    "figure [ fig : autocorrelations1 ] displays a realization of this model where the signal s covariance parameter alternates four times between @xmath222 , and @xmath223",
    ". see appendix [ ssec : generatingzk ] for more on generating a signal from the time - frequency signal model .",
    "the autocorrelation function associated with the local regularity signal model is equal to that of fractional brownian motion , given by @xmath224 where @xmath225 is the hurst parameter .",
    "as @xmath225 decreases , the local regularity decreases .",
    "a realization of this model is shown in figure [ fig : autocorrelations11 ] where the signal s covariance parameter alternates four times between @xmath226 and @xmath227 .",
    "we use the method described in @xcite to generate the fractional brownian motion .      for each realization of a specific signal model ,",
    "we construct a patch - set of @xmath228 maximally overlapping patches .",
    "the patch size is given by @xmath229 for the time - frequency model , and @xmath230 for the local regularity model .",
    "we compute the embedding @xmath85 ( [ eqn : lowdparam ] ) and keep @xmath82 eigenvectors @xmath63 .",
    "figure [ fig : autocorrelations2 ] shows the patch - set associated with the realization of the time - frequency signal displayed in figure [ fig : autocorrelations1 ] before ( left ) and after ( right ) embedding .",
    "the scatterplot before embedding is computed using the first three principal components .",
    "figure [ fig : autocorrelations22 ] shows the patch - set associated with the realization of the local regularity signal displayed in figure [ fig : autocorrelations11 ] before ( left ) and after ( right ) embedding .",
    "the fast patches of the time - frequency signal are the orange patches extracted from the high frequency segments .",
    "the slow patches are the blue patches extracted from the low frequency sections .",
    "similarly , the fast patches of the local regularity signal are the orange patches extracted from the irregular segments , and the slow patches are the blue patches extracted from the smooth sections . for both signals ,",
    "the fast patches are scattered across the space before embedding .",
    "after embedding , the fast patches are aligned along smooth curves . this visual impression is confirmed by computing the mutual distance between patches after embedding , @xmath231 . in principle , we should report the value of the lipschitz ratio    ) before ( left ) and after ( right ) embedding .",
    "the color - code matches the color used in the plot of the signal : blue = low frequency , orange = high frequency .",
    "[ fig : autocorrelations2 ] , title=\"fig : \" ] ) before ( left ) and after ( right ) embedding .",
    "the color - code matches the color used in the plot of the signal : blue = low frequency , orange = high frequency .",
    "[ fig : autocorrelations2 ] , title=\"fig : \" ]    ) before ( left ) and after ( right ) embedding .",
    "the color - code matches the color used in the plot of the signal : blue = smooth , orange = irregular .",
    "[ fig : autocorrelations22 ] , title=\"fig : \" ] ) before ( left ) and after ( right ) embedding .",
    "the color - code matches the color used in the plot of the signal : blue = smooth , orange = irregular .",
    "[ fig : autocorrelations22 ] , title=\"fig : \" ]     for slow ( blue ) and fast patches ( orange ) for the time - frequency model ( left ) and the local regularity model ( right ) as a function of the `` roughness '' of the fast patches .",
    "the slow patches were generated using @xmath222 ( left ) and @xmath232 ( right ) .",
    "[ fig : autocorrelations3],title=\"fig : \" ]   for slow ( blue ) and fast patches ( orange ) for the time - frequency model ( left ) and the local regularity model ( right ) as a function of the `` roughness '' of the fast patches .",
    "the slow patches were generated using @xmath222 ( left ) and @xmath232 ( right ) .",
    "[ fig : autocorrelations3],title=\"fig : \" ]    @xmath233 to quantify the contraction experienced through the mapping @xmath85 .",
    "however , we have noticed that because the mutual distances @xmath234 between fast patches is always large ( as explained in section [ ssec : firstlookpatchgraph ] ) , the lipschitz ratio ends up being always small for fast patches . therefore studying the size of the lipschitz ratio associated with @xmath85",
    "does not reveal whether the map concentrates the fast patches or not , but only indicates that the sampling of the fast patches ( in the patch - set ) is coarse .",
    "for this reason we prefer to study how @xmath231 varies for pairs of slow and fast patches . based on our theoretical analysis",
    ", we expect that after the embedding the mutual distance between fast patches will becomes much shorter than the mutual distance between slow patches .",
    "we point out that the eigenvectors @xmath63 used in the embedding @xmath85 ( [ eqn : lowdparam ] ) are designed to have , on average , small gradients ( as measured along edges of the graph ) . indeed ,",
    "these eigenvectors are also the eigenvectors of the graph laplacian @xcite , and therefore minimize a rayleigh ratio that quantifies the average norm of the gradient of @xmath63 .",
    "thus , if we further restricted our computation of the commute times inside each subset of fast and slow patches to only those patches that were connected by an edge in the graph , we would expect to see smaller values and little dependence on whether or not the patch was fast or slow .",
    "however , since our theoretical analysis of section [ ssec : theory ] is based on the average commute time between all vertices belonging to the fast or slow graph models , we choose to compute the commute times between all patches , not just between patches that are connected with an edge .    for each signal model , we compute the square root of the average approximate commute time @xmath235 for pair of patches @xmath145 that are either both fast , or both slow patches .",
    "we study how @xmath198 varies as a function of the autocorrelation parameter that controls how irregular the fast patches are .",
    "@xmath198 was computed using ten realizations of each signal model .",
    "the slow patches were generated using @xmath222 and @xmath232 .",
    "as before , we used @xmath236 and @xmath237 for the time - frequency model and @xmath238 for the local regularity model .",
    "we observed that the overall shapes of the curves in ( [ fig : autocorrelations3 ] ) is invariant under variation of the parameters ( as along as the ratio of the patch length to the average subinterval length remains less than 10% ) .",
    "the dimension @xmath82 of the embedding used to compute @xmath198 was chosen so that @xmath239 , for all @xmath240 .",
    "figure [ fig : autocorrelations3 ] shows @xmath241 as a function of the frequency parameter ( left ) , and smoothness parameter ( right ) .",
    "we note that as the signal exhibits more rapid , local changes ( increasing @xmath242 , or decreasing @xmath243 ) , the associated fast patches are increasingly concentrated ( smaller @xmath244 ) through the parametrization .",
    "these experiments confirm that the theoretical analysis can be applied to the true patch - set constructed from realistic signals .",
    "using realistic graph models , probabilistic arguments , and the connection between the commute time of random walks on graphs and the embedding ( [ eqn : lowdparam ] ) , we provided a theoretical explanation for the success of the methods that analyze and process images based on graphs of patches .",
    "our results establish that the embedding of the patch - graph of an image based on the commute time between vertices of the graph reveals the presence of patches containing rapid changes in the underlying signal or image by concentrating these patches close to one another while leaving the patches extracted from the slowly changing portions of the signal organized along low - dimensional structures .        in this work",
    "we are interested in the _ local _ behavior of the image , and therefore @xmath2 should remain of the order of what we consider to be the local scale .",
    "we also note that as @xmath2 becomes large , the number of available patches ( @xmath245 ) becomes smaller , making the estimation of the geometry of the patch - set more difficult , since patches now live in high - dimension .",
    "another consequence of the `` curse of dimensionality '' is that the distance between patches becomes less informative for large values of @xmath2 .",
    "if the original signal is oversampled with respect to the true physical processes at stake , then one can coarsen the sampling of the patch - set in the image domain . in practice , it would be more advisable to coarsen the underlying continuous patch - set , which is a nontrivial question .",
    "in general , two principles guide the choice of edge weights in the patch - graph . on the one hand , patches that are very close",
    "should be connected with a large weight ( short distance ) , while patches that are faraway should have a very small weight along their mutual edge .",
    "this principle is equivalent to the idea of only trusting local distances in @xmath4 .",
    "such a requirement is intuitively reasonable if we assume that the patch - set represents a discretization of a nonlinear manifold in @xmath4 . in this situation ,",
    "we know that when the points on the manifold are very close to another , the _ geodesic distance _ is well approximated by the euclidean distance .",
    "conversely , because of the presence of curvature , the euclidean distance is a poor approximation to the geodesic distance on the manifold when points are far apart .",
    "because the only information available to us is the euclidean distance between patches , we should not trust large euclidean distances .    on the other hand , as observed in section [ ssec : firstlookpatchgraph ] ,",
    "the fast patches , which contain rapid changes , are all very far apart ( large @xmath246 ) .",
    "therefore the probability that the random walk escapes the fast patch @xmath9 and jumps to a different patch @xmath22 , which is given by @xmath247 is always much smaller than the probability of staying at @xmath9 , which is given by @xmath248 in order to avoid that the random walk be trapped at each node @xmath9 , we `` saturate '' the distance function by choosing @xmath20 to be very large . in this case , for all the nearest neighbors @xmath22 of @xmath9 , we have @xmath249 , and the transition probability is the same for all the neighbors , @xmath250 .",
    "this choice of @xmath20 promotes a very fast diffusion of the random walk locally .",
    "we note that choosing a large @xmath20 may be avoided if self - connections are not enforced ( i.e. @xmath251 ) . however , self - connections are a necessary technical requirement to prove that the markov process is aperiodic , which is required to prove the equality ( [ eqn : diffusiondist ] ) @xcite .",
    "we note that choosing @xmath20 to be very large does not entirely obliterate the information provided by the mutual distance between patches , measured when patches are projected on the sphere with @xmath21 , ( [ rho ] ) .",
    "indeed , @xmath21 is used to select the nearest neighbors of each patch , and therefore allows us to define a notion of a local neighborhood around each patch .",
    "choosing @xmath20 to be very large forces a very fast diffusion within this neighborhood , irrespective of the actual distances @xmath21 .",
    "alternatively , we could consider choosing @xmath20 to vary adaptively from one neighborhood to another .",
    "the parameter @xmath20 could be small when patches are extremely close to one another , while @xmath20 could be large when the patches are at a large mutual distance of one another .",
    "this notion is the foundation of the self - tuning weight matrix , which adjusts its weights based on a point s local neighborhood @xcite .      in general , the patch - set of an image consists of more than two homogeneous subsets .",
    "for example , one could partition an image patch - set into uniform patches , edge patches , and texture patches .",
    "our experience @xcite with a generalization of the time - frequency signal model ( section [ sec : experiments ] ) indicates that we can still separate the patches when the signal is composed of up to four different local behaviors ( specified by four different values of the parameter in the autocorrelation function ) .",
    "another extension of this work involves the embedding of a patch - set constructed from a library of images .",
    "recent studies @xcite indicate that high - contrast patches extracted from optical images organize themselves around 2-dimensional smooth sub - manifold ( @xcite ) .",
    "this idea has also been exploited to construct dictionaries that lead to very sparse representations of images ( e.g. @xcite , and references therein ) .",
    "finally , we note that our results about the embedding of the slow ( [ slowgraph ] ) , fast ( [ fastgraph - def ] ) , and the fused graph ( [ fused ] ) are very general and can be applied to datasets @xcite where the corresponding graph exhibits a similar structure . for instance , one could imagine using this idea to study social networks , where the concept of cliques would correspond to fast subgraphs .",
    "the concept of patches has proven extremely useful in many areas of image analysis : texture analysis / synthesis @xcite , image completion @xcite , super - resolution @xcite , and denoising @xcite . while these references do not explicitly construct a patch - graph",
    ", these works all compute distances between patches , and use the nearest neighbors of each patch to analyze and process patches .",
    "recent works on the analysis of time - series also use patches and construct networks of patches @xcite .",
    "all these references provide experimental evidence for the success of working on image ( or signal ) patches .",
    "in this work , we provide a theoretical justification for this experimental success .",
    "we study the effect of the embedding @xmath85 ( [ eqn : lowdparam ] ) on the organization of the patch - set .",
    "our analysis assumes that there exists a natural partition of the patch - set into two classes : patches extracted from the smooth baseline and patches that contain sudden local changes of the image intensity or signal value .",
    "it is interesting to compare and contrast our work to the work of singer , shkolnisky , and nadler @xcite who provide a different theoretical explanation for the success of patch - based denoising algorithms .",
    "the authors in @xcite treat the matrix @xmath51 as a filter , which acts on an @xmath17-dimensional column - vector - representation of the signal or the image .",
    "each multiplication of the probability distribution by @xmath51 is interpreted as the evolution of the diffusion process on the patch - graph over a time - step of duration @xmath20 .",
    "the results in @xcite rely on the convergence of a properly normalized version of @xmath51 toward the backward fokker - planck operator .",
    "the authors can compute the eigenfunctions of the operator when the signal is either a one - dimensional constant function perturbed by gaussian noise , or a one - dimensional step function also contaminated by gaussian noise .",
    "in contrast , our analysis is based on the analysis of the commute time on graphs that epitomize the patch - graph constructed from two classes of patches . in addition",
    ", we need not assume that the image is piece - wise constant .",
    "in fact , our experiments demonstrate that our analysis can be applied to detect many different types of anomalies : changes in the local frequency content , changes in local regularity , etc .",
    "furthermore , our theoretical analysis holds for finite values of the number of patches @xmath17 .",
    "it is interesting to note that singer et al .",
    "study the _",
    "mean first - passage time _ between patches extracted from the noisy step function .",
    "the mean first - passage time is derived from the hitting time , which is used to define the commute time .",
    "the authors in @xcite use an energy argument to explain the existence of a large mean first - passage time between patches extracted from either side of the step function s discontinuity .",
    "they argue that a high density of patches is associated with a lower potential energy , and consequently it will take longer for a random process to exit the well with such a low potential . finally , our results are not limited to patches of size @xmath252 , as are the results in @xcite .",
    "the energy argument in @xcite adds an interesting interpretation to our analysis . following this perspective",
    ", the slow patches can be interpreted as points sampled from a probability density function @xmath253 defined on @xmath4 with a support that is defined along a low - dimensional manifold .",
    "this localization leads to a potential @xmath254 with a deep and narrow well , from which the random walk can not escape .",
    "this argument agrees with our findings that the average commute time between slow patches is very large , and thus , the random walk spends considerably more time in the slow subgraph before being able to reach a patch that is temporally faraway .    from a more general perspective , this work presents an investigation into the diffusion process on the graphs models presented in section [ ssec : modelgraphs ] .",
    "our work is thus related to a large body of work on the analysis of complex and random networks using first - passage time ( e.g. @xcite and references therein ) .",
    "this area if usually motivated by physical problems such as transport in disordered media , neuron firing , or energy flow on power - grids instead of applications in signal processing .",
    "while we obtained estimates for the average commute time on the fast and slow graph models considered separately , it would be desirable to obtain similar estimates on the fused graph . at the moment ,",
    "our analysis of the fused graph relies on numerical simulations .",
    "we are also aware of a small discrepancy in the upper bound on @xmath143 : this bound is increasing with @xmath96 .",
    "in fact we expect that the commute time on @xmath99 should decrease as @xmath103 , and therefore @xmath96 , increases .",
    "the reason for this apparent inconsistency is that the proof of ( [ eqn : kappadc ] ) relies on a loose upper bound for the effective resistance between two vertices , which is provided by the geodesic distance on the graph @xcite .",
    "this is not a tight inequality on a graph such as @xmath99 . a more effective inequality , which could improve the upper bound ( [ eqn : kappadc ] ) , relies on the computation of the distribution of the number of paths @xmath255 of length at most @xmath256 between the two vertices .",
    "we could then use the fact that the commute time is bounded from above by a constant times the ratio @xmath257 @xcite , which would decrease the upper bound in ( [ eqn : kappadc ] ) .",
    "it is necessary that the fast graph @xmath99 be connected to be able to apply the spectral decomposition of the commute time . to ensure that the probability of @xmath99 being disconnected will vanish as @xmath17 gets large , we must choose @xmath258 @xcite . since @xmath103 is defined as a function of @xmath96 in ( [ eqn : pdefined ] ) ,",
    "any requirement on @xmath103 ultimately constrains @xmath96 .",
    "first , because the maximum degree of a vertex in @xmath91 is @xmath259 , according to ( [ eqn : flatgraph ] ) , we require    @xmath260    manipulation of this inequality leads to @xmath261 we assume that @xmath262 , so that @xmath263 it follows that @xmath264 therefore , rewriting ( [ eqn : pdefined ] ) and using the last inequality we have @xmath265 therefore , choosing @xmath266 for some @xmath152 ensures that @xmath267 , and consequently , the probability of @xmath99 being disconnected approaches zero as @xmath17 approaches infinity .",
    "in order to compute a lower bound on the average commute time , we consider a fixed pair of vertices in the slow graph , @xmath268 and @xmath269 , and compute a lower bound on the commute time @xmath270 .",
    "we can then compute the average of this lower bound over all the pairs of vertices . to obtain the lower bound on @xmath271 we use a standard tool to obtain lower bounds on commute time : the nash - williams inequality @xcite . the nash - williams inequality is usually formulated in terms of electrical networks .",
    "we prefer to present an equivalent formulation that is directly adapted to our problem .",
    "we first introduce the concept of _ edge - cutset_. +    let @xmath272 and @xmath273 be two disjoint sets of vertices .",
    "a set of edges @xmath274 is an edge - cutset separating @xmath272 and @xmath273 if every path that connects a vertex in @xmath272 with a vertex in @xmath273 includes an edge in @xmath274 .    given a weighted graph , which may contain loops , we define a random walk with the probability transition matrix @xmath275 .",
    "let @xmath269 and @xmath268 be two vertices .",
    "the commute time between vertices @xmath269 and @xmath268 , @xmath276 satisfies the following lower bound .",
    "+    if @xmath269 and @xmath268 are distinct vertices in a graph that are separated by disjoint edge - cutsets @xmath277 , then @xmath278^{-1 } \\leq \\kappa({\\mathbf{x}}_{m_0},{\\mathbf{x}}_{n_0 } ) \\qquad \\text{where $ \\{{\\mathbf{x}}_{m},{\\mathbf{x}}_{n}\\}$ is an edge in the    cutset $ e_k$},\\ ] ]    and where the volume of the graph is defined by @xmath279 .",
    "we now exhibit a sequence of edge - cutsets in the slow graph .",
    "we refer to figure [ fig : matrixtile ] for the construction of the cutsets .",
    "we define the first cutset @xmath280 .",
    "if @xmath281 , then @xmath280 needs a little more attention and is defined as the set of @xmath96 edges @xmath282 , where @xmath283 and @xmath284 are defined by @xmath285 the edge - cutset @xmath280 is shown in the figure [ fig : matrixtile ] for @xmath286 ( left ) and @xmath287 ( center ) , for @xmath288 .",
    "the removal of this set of edges prevents @xmath269 from being connected to @xmath268 .",
    "indeed , the self loop on the diagonal ( green entry ) does not allow the random walk to move toward @xmath268 .",
    "this can be also be visualized in figure [ fig : bluegraph ] , where @xmath280 is the leftmost set of edges that connect @xmath269 to that part of the graph that is connected to @xmath268 .",
    "the sum of edge weights in @xmath280 is at most @xmath289 . if @xmath290 , then @xmath280 , is defined as the other generic edge - cutsets .",
    "we now define the generic edge - cutsets @xmath291 as the set of @xmath292 edges @xmath282 such that @xmath293 as seen in figure [ fig : matrixtile]-right for @xmath294 , setting the entries of @xmath295 to zero disconnects the upper and lower part of the submatrix @xmath296 , thereby isolating @xmath269 and @xmath268 .",
    "alternatively , we also see in figure [ fig : bluegraph ] that any path from @xmath269 to @xmath268 needs to go through @xmath295 .",
    "each edge - cutset @xmath297 is a triangle with a height of size @xmath96 .",
    "therefore , after creating @xmath280 , we can fit @xmath298 such cutsets between @xmath299 and @xmath268 .",
    "the sum of the weights along the edges of each cutset @xmath300 is given by @xmath301 .",
    "in addition , the sum of edge weights in the first cutset @xmath280 is at most @xmath301 . putting everything together , the computation of the lower bound using the nash - williams lemma yields @xmath302^{-1}\\\\    & \\geq \\left [",
    "n ( 2l + 1 ) - l ( l+1 ) \\right ] w_s   \\left (    { \\left\\lfloor\\frac{(n_0 - m_0)}{l}\\right\\rfloor } \\frac{2}{l(l+1)w_s } +    \\frac{2}{l(l+1)w_s } \\right ) \\\\ & \\ge \\frac{\\left[n ( 2l + 1 ) - l ( l+1 ) \\right]}{l(l+1 ) } \\left ( 2\\left(\\frac{n_0 - m_0}{l } - 1\\right ) + 2 \\right)\\\\ & \\ge \\frac{\\left[n ( 2l + 1 ) - l ( l+1 ) \\right]}{l(l+1 ) } \\left ( 2\\frac{n_0 - m_0}{l } \\right ) \\end{split}\\ ] ] we can summarize this result in the following lemma . +    the commute time between vertices @xmath268 and @xmath269 inside @xmath91 satisfies @xmath303}{l(l+1)}\\left(\\frac{n_0-m_0}{l}\\right ) .",
    "\\label{eqn : kappagenerallb}\\ ] ] [ lemma : lemma82 ]    finally , we bound the average commute time in the slow graph .",
    "observe that the slow graph model @xmath91 has @xmath304 pairs of vertices such that @xmath305 , for @xmath306 .",
    "therefore , using the lower bound given in lemma [ lemma : lemma82 ] it follows that @xmath307}{l^2(l+1 ) }     \\sum_{j = 1}^{n-1}(n - j)j\\ ] ] but @xmath308 dividing both sides by @xmath309 and simplifying yields ( [ eqn : kappafc ] ) .",
    "of @xmath91 .",
    "the green entries on the diagonal are the self - loops .",
    "the edge - cutsets @xmath291 are shown in red for @xmath310 ( left ) , @xmath287 ( center ) , and for @xmath290 ( right ) .",
    "the submatrix @xmath296 is also shown.[fig : matrixtile],title=\"fig : \" ]   of @xmath91 .",
    "the green entries on the diagonal are the self - loops .",
    "the edge - cutsets @xmath291 are shown in red for @xmath310 ( left ) , @xmath287 ( center ) , and for @xmath290 ( right ) .",
    "the submatrix @xmath296 is also shown.[fig : matrixtile],title=\"fig : \" ]     and @xmath295 .",
    "bottom : any path from @xmath311 to @xmath312 needs to use an edge of the edge - cutset @xmath295 .",
    "[ fig : bluegraph],title=\"fig : \" ]   and @xmath295 .",
    "bottom : any path from @xmath311 to @xmath312 needs to use an edge of the edge - cutset @xmath295 .",
    "[ fig : bluegraph],title=\"fig : \" ]      our approach relies on the relationship between electrical networks and random walks on graphs @xcite .",
    "we begin by introducing the property of interest  the _ effective resistance _  and its relationship to the commute time .",
    "[ [ the - electrical - network - perspective ] ] the electrical network perspective + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for each pair of vertices @xmath313 and @xmath314 with a non zero weight @xmath14 , we assign the resistance @xmath315 to the edge @xmath316 .",
    "we note that if @xmath317 , then there is no connection between @xmath9 and @xmath22 , and no resistance to consider .",
    "now , consider applying a potential difference , or voltage , across the vertices @xmath269 and @xmath268 . as a result , some current flows across the resistors ( edges ) in the electrical network ( graph ) .",
    "we may replace the set of resistors across which some current flows by an equivalent , _ effective resistance _",
    ", @xmath318 that is connected between @xmath269 and @xmath268 . the effective resistance @xmath318 is defined by the voltage necessary to maintain a one - unit current between @xmath269 and @xmath268 .",
    "the main result in @xcite , is that the commute time between vertices @xmath269 and @xmath268 can be expressed as @xmath319    taking expectations of both sides of equation ( [ eqn : commuteitor ] ) with respect to the process of generating edges and choosing terminals in a fast graph , we obtain    @xmath320    notice that every edge in the fast graph has weight @xmath321 . therefore , @xmath126 can be expressed as @xmath322 where @xmath323 is a binomial random variable representing the number of edges connecting distinct vertices in the fast graph .",
    "we now rewrite ( [ eqn : kappafappend ] ) , using ( [ eqn : volume2 ] ) and the assumption that @xmath324 , to obtain    @xmath325\\e(r).\\ ] ]    recall that @xmath323 is distributed as a binomial random variable with parameters @xmath326 . also , the effective resistance between two nodes of a network is at most the geodesic distance between them , @xmath327 , scaled by @xmath328 @xcite .",
    "it follows that    @xmath329\\e(\\delta).\\ ] ]    the authors @xcite give a closed form expression for @xmath330 on erds - renyi graphs , which we can utilize since the fast graph s self - connections do not change the geodesic distance .",
    "this yields    @xmath329\\left[\\frac{\\log",
    "n - \\gamma_e}{\\log ( ( n-1)p+1 ) } + \\frac{1}{2}\\right],\\ ] ]    where @xmath331 is euler s constant .",
    "simplification using ( [ eqn : pdefined ] ) gives the desired result .",
    "[ [ remark ] ] remark + + + + + +    although @xmath324 is an assumption , we conjecture that it is always satisfied due to the fact that increasing the number of resistors @xmath149 in an electrical network with a fixed number of nodes is effectively like adding resistors - in - parallel , and , according to rayleigh s monotonicity law , adding edges ( increasing @xmath149 ) can only decrease the effective resistance @xcite .",
    "let @xmath332 represent a random trigonometric polynomial on @xmath333 with an autocorrelation function given by          it is clear that @xmath339 is the frequency of the fastest sinusoid making up the random signal @xmath332 , and that most of the energy is on average at frequency @xmath221 .",
    "let @xmath340 and @xmath341 be independent and identically distributed normal random variables with zero mean and unit variance .",
    "define      finally , the signal @xmath332 is defined as @xmath343 to check that the signal @xmath332 defined above has the correct autocorrelation , observe that linearity of the expectation , independence and zero mean of the random variables , and the fact that @xmath344 together imply that    @xmath345e^{-2\\pi      i k \\tau}e^{2\\pi i(j - k )",
    "t}\\\\     & = \\sum_{|j|\\leq2\\beta}\\frac{\\hat      c_j}{2}\\left[\\e(a_j^2)+\\e(b_j)^2\\right]e^{-2\\pi i j \\tau } = \\sum_{|j|\\leq2\\beta}\\hat c_je^{2\\pi i j \\tau}.\\end{aligned}\\ ] ]                                                                                      , _ the geometry of signal and image patch - sets _ , phd thesis , university of colorado , boulder , dept . of applied mathematics ,",
    "june 2011 .",
    "( available from http://ecee.colorado.edu/~fmeyer/[ecee.www.colorado.edu/fmeyer ] ) .",
    ", _ non - parametric dictionary learning for sparse image representations _ , in advances in neural information processing systems 22 , y.  bengio , d.  schuurmans , j.  lafferty , c.  k.  i. williams , and a.  culotta , eds . , 2009 , pp ."
  ],
  "abstract_text": [
    "<S> in this paper we address the problem of understanding the success of algorithms that organize patches according to graph - based metrics . </S>",
    "<S> algorithms that analyze patches extracted from images or time series have led to state - of - the art techniques for classification , denoising , and the study of nonlinear dynamics . </S>",
    "<S> the main contribution of this work is to provide a theoretical explanation for the above experimental observations . </S>",
    "<S> our approach relies on a detailed analysis of the commute time metric on prototypical graph models that epitomize the geometry observed in general patch graphs . </S>",
    "<S> we prove that a parametrization of the graph based on commute times shrinks the mutual distances between patches that correspond to rapid local changes in the signal , while the distances between patches that correspond to slow local changes expand . in effect , our results explain why the parametrization of the set of patches based on the eigenfunctions of the laplacian can concentrate patches that correspond to rapid local changes , which would otherwise be shattered in the space of patches . while our results are based on a large sample analysis , numerical experimentations on synthetic and real data indicate that the results hold for datasets that are very small in practice .    </S>",
    "<S> image patches , diffusion maps , laplacian eigenmaps , graph laplacian , commute time    62h35 , 05c12 , 05c81 , 05c90 </S>"
  ]
}