{
  "article_text": [
    "in its most general sense , the term _ photometric redshift _ refers to a redshift estimated using only medium- or broad - band photometry or imaging .",
    "most commonly , photometric redshifts are determined on the basis of galaxies colours in three or more filters ( thus giving a very coarse approximation to the spectral energy distribution , hereafter sed ) , but they could also be based on other properties which can be derived from images , such as the angular size or concentration index .",
    "the method has found successful application to deep - field and wide - field surveys , notably the hubble deep field ( e.g. * ? ? ?",
    "* ) , and the sloan digital sky survey @xcite .",
    "the most commonly used approach to photometric redshift estimation is the _ template - matching _ technique .",
    "this requires a set of ` template ' seds covering a range of galaxy types , luminosities and redshifts appropriate to the population for which photometric redshifts are required . for a particular target galaxy ,",
    "the photometric redshift is chosen to be the redshift of the most closely matching template spectrum ; this is usually defined as the template which minimizes the @xmath2 between the template and actual magnitudes .    the template spectra are usually derived from a small set of seds representing different classes of galaxy at redshift @xmath3 , which are then manually redshifted to give a discrete sampling along the redshift axis ( note that this method does not account for _ evolution _ with redshift ) . commonly used template sets are the ( cww ; * ? ? ?",
    "* ) seds which are derived observationally , or those of @xcite , derived from population synthesis models .",
    "the template - matching technique owes its popularity to the very few resources required for a basic implementation ( i.e. a handful of template seds ) , but the accuracy of the technique strongly depends on the extent to which the template spectra are representative of the target populations : for example , template seds derived from observations of low - redshift galaxy populations may be a poor match for populations at higher redshifts .",
    "the chances of success can be improved by increasing the number of templates , or by more carefully matching the templates to the populations being studied .",
    "for example , the spectroscopic catalogue of the sloan digital sky survey ( sdss ; @xcite ) could be used to produce a set of templates which are very well representative of the sdss photometric catalogue @xcite . however , in situations with such a large amount of prior redshift information about the sample , the template - matching technique is not the best approach : so - called _ empirical _ methods usually offer greater accuracy , as well as being far more efficient .",
    "in essence , empirical photometric redshift methods aim to derive a parametrization for the redshift as a function of the photometric parameters .",
    "the form of this parametrization is deduced through use of a suitably large and representative training set of galaxies for which we have both photometry and a precisely known redshift .",
    "a simple example is to express the redshift as a polynomial in the galaxy colours ( e.g. @xcite ; @xcite ) .",
    "the coefficients in the polynomial are varied to optimize the fit between the predicted and measured redshift .",
    "the photometric redshift for the galaxies for which we have no spectroscopy can then be estimated by applying the optimized function to the colours of the target galaxy .",
    "ideally the training set would be a representative subset of the actual photometric target sample ( this has the attractive side - effect of nullifying any systematics in the photometry ) .",
    "however , the training set could also be derived from a set of template spectra or from simulated catalogues ( e.g. @xcite ) .",
    "the photometry for the training set must be for the same filter set and should have the same noise characteristics as that for the target sample .",
    "the trained method can usually only be reliably applied to target galaxies within the ranges of redshift and spectral type adequately sampled by the training set .    in this paper",
    "we introduce ann__z _ _ , a software package for photometric redshift estimation using artificial neural networks ( hereafter anns ) to parametrize the redshift - photometry relation .",
    "it can be shown ( e.g. @xcite ; @xcite ) that a sufficiently complex ann is capable of approximating to arbitrary accuracy any continuous functional mapping .",
    "anns have previously found a number of applications in astronomy , including morphological classification of galaxies ( e.g. @xcite ; @xcite ) star / galaxy separation and object detection ( e.g. * ? ? ?",
    "@xcite previously demonstrated the feasibility of using anns for photometric redshift estimation , and more recently @xcite have applied the method to the hubble deep fields .",
    "the layout of this paper is as follows . in  [ sec.anns ]",
    "artificial neural networks are introduced , and the particular methods used by ann__z _ _ are explained . in  [ sec.sdss ]",
    "ann__z _ _ is applied to the sloan digital sky survey .",
    "the results are compared with rival photometric redshift estimators and various extensions to the basic technique are explained and illustrated . finally , less ideal conditions are simulated to assess the impact on the accuracy of photometric redshift estimation . in  [ sec.conc ]",
    "the results are summarised , and prospects for the application of ann__z _ _ discussed .",
    "ann__z _ _ uses a particular species of ann known formally as a _ multi - layer perceptron _ ( mlp ) .",
    "a mlp consists of a number of layers of _ nodes _ ( fig .",
    "[ fig.photz.arch ] ; see e.g. @xcite , and references therein , for background ) .",
    "the first layer contains the inputs , which in our application to photometric redshift estimation are the magnitudes , @xmath4 , of a galaxy in a number of filters ( for ease of notation we arrange these in a vector @xmath5 ) .",
    "the final layer contains the outputs ; we will usually use just one output , the photometric redshift @xmath6 , but see  [ sec.spec.type ] for an example with multiple outputs .",
    "intervening layers are described as _ hidden _ and there is complete freedom over the number and size of hidden layers used .",
    "the nodes in a given layer are connected to all the nodes in adjacent layers . a particular network architecture",
    "may be denoted by @xmath7:@xmath8:@xmath9 : @xmath10 : @xmath11 where @xmath7 is the number of input nodes , @xmath8 is the number of nodes in the first hidden layer , and so on . for example 9:6:1",
    "takes 9 inputs , has 6 nodes in a single hidden layer and gives a single output .",
    "each connection carries a weight , @xmath12 ; these comprise the vector of coefficients , @xmath13 , which are to be optimized .",
    "an _ activation function _ , @xmath14 , is defined at each node , taking as its argument @xmath15 where the sum is over all nodes @xmath16 sending connections to node @xmath17 .",
    "the activation functions are typically taken ( in analogy to biological neurons ) to be sigmoid functions such as @xmath18 $ ] , and we follow this approach here .",
    "an extra input node  the bias node  is automatically included to allow for additive constants in these functions .    for a particular input vector , the output vector of the network is determined by progressing sequentially through the network layers , from inputs to outputs , calculating the activation of each node ( hence this type of neural network is often referred to as a _ feed - forward _ network ) .",
    "given a suitable training set of galaxies for which we have both photometry , @xmath19 , and a spectroscopic redshift , @xmath20 , the ann is trained by minimizing the _ cost function _",
    "@xmath21 with respect to the weights , @xmath13 , where @xmath22 is the network output for the given input and weight vectors , and the sum is over the galaxies in the training set . to ensure that the weights are _ regularized _",
    "( i.e. that they do not become too large ) , an extra quadratic cost term @xmath23 is added to equation [ eqn.cost ] .",
    "ann__z _ _ uses an iterative quasi - newton method to perform this minimization .",
    "details of the minimization algorithm and regularization may be found in @xcite and ( * ? ? ?",
    "* appendices ) .    after each training iteration ,",
    "the cost function is also evaluated on a separate _ validation _ set .",
    "after a chosen number of training iterations , training terminates and the final weights chosen for the ann are those from the iteration at which the cost function is minimal on the _ validation _ set .",
    "this is useful to avoid over - fitting to the training set if the training set is small .",
    "the trained network may then be presented with previously unseen input vectors , and the outputs computed .      in real situations the inputs to the network (",
    "e.g. the magnitudes in this case of photometric redshift estimation ) will usually have a measurement noise associated with them .",
    "we can assess the variance these errors effect in the output using the usual chain - rule approach :    @xmath24    where the sum is over the network inputs .",
    "given a trained network , the output is an analytic function of the network weights and the input vector : @xmath25 .",
    "provided the activation functions , @xmath26 , are differentiable , the derivatives @xmath27 can be obtained through a simple and efficient algorithm @xcite .",
    "this method is used by ann__z _ _ to estimate the variance in its photometric redshifts due to the photometric noise .",
    "prior to training , ann__z _ _ randomizes the initial values of the weights . depending on the particular initialization state used , the training process will usually converge to different local minima of the cost function .",
    "a simple possibility is to train a number of networks and select one based on the best performance on the validation set .",
    "however , this is wasteful of training effort and , in fact , the sub - optimal networks can be used to improve overall accuracy : the mean of the individual outputs of a group of networks ( known as a _ committee _ ) will usually be a more accurate estimate for the true redshift than the outputs of any one committee member in isolation .",
    "using a committee also allows the uncertainty in the output due to the variance in the network weights to be estimated . for a particular target",
    "galaxy the photometric redshift prediction should ideally be robust to different intializations of the weight vector .",
    "however , it may be the case that the available photometry or training set does not constrain the redshift very well ( even for high signal - to - noise photometry , so the error estimated by the method of  [ sec.noise ] could be relatively small ) .",
    "these cases are more likely to show a large variance in the output for different initializations of the weight vector , hence using a committee may assist in their identification . ann__z _ _ allows arbitrarily large committees to be used , and estimates the contribution of the network variance to the error in the photometric redshift for each target galaxy .",
    "we have made ann__z _ _ available on the www at the following address : ` http://www.ast.cam.ac.uk/~aac ` .",
    "full instructions are provided with the package , but we provide an outline of the procedure here .",
    "_ comprises two main programs , ` annz_train ` and ` annz_test ` .",
    "[ [ section ] ] 1 +    when applying ann__z _ _ to any data set for the first time it is strongly recommended that a portion of the available training data be set aside as an evaluation set .",
    "this is used as a mock target sample to assess and tune ann__z _ _ s performance on the data .",
    "the evaluation set should therefore be chosen to match the real target sample as closely as possible in terms of its magnitude and colour distributions .",
    "[ [ section-1 ] ] 2 +    the remaining training data should be separated into training and validation sets which are supplied to the ` annz_train ` program along with a description of the required network architecture .",
    "this program performs the network training as described in  [ sec.nettrain ] .",
    "the trained network weights are saved to file .",
    "[ [ section-2 ] ] 3 +    step _ 2 _ may be repeated several times using different network initialisations to obtain a committee of trained networks .",
    "[ [ section-3 ] ] 4 +    the ` annz_test ` program can now be used to apply the trained networks to the target data .    before applying ann__z",
    "_ _ to the actual photometric target sample , the whole procedure should be run several times using the evaluation set as the target data , and varying the parameters of the training ( e.g. weight decay , training and validation set sizes , number of networks in the committee ) so as to optimize the performance .",
    "the sloan digital sky survey ( sdss ; @xcite ) combines a large , five - band ( @xmath28 ) imaging survey with a smaller spectroscopic follow - up survey .",
    "this is an ideal situation for the application of ann__z _ _ since the spectroscopic survey represents an excellent training set for the imaging survey .",
    "the selection algorithm for the sdss spectroscopic survey results in two subsets of the data : a main galaxy catalogue and a luminous red galaxy catalogue ( lrg ; * ? ? ? * ) . the main galaxy catalogue is a flux - limited sample ( @xmath29 ) with a median redshift @xmath30 @xcite , while the lrg catalogue is flux- and colour - selected to be a very uniform and approximately volume - limited sample ( it is volume limited to @xmath31 , but probes out to @xmath32 at lower completion ) .      the sdss consortium have themselves applied a range of photometric redshift techniques to their commissioning data @xcite .",
    "table [ sdss_results ] lists the estimation errors they obtained .",
    "this commissioning data was made public in the early data release ( edr ; * ? ? ?",
    "* ) . in order to allow a direct comparison of the accuracy of ann__z _ _ with the methods used by @xcite we selected the main galaxy and lrg samples from the edr . from these @xmath3330,000 galaxies we randomly selected training , validation and evaluation sets with respective sizes 15,000 , 5,000 and 10,000 .",
    "the network inputs were the dereddened model magnitudes in each of the five filters and the overall architecture was 5:10:10:1 .",
    "a committee of five such networks was trained on the training and validation sets , then applied to the evaluation set .",
    "figure [ fig.edr.5 ] shows the ann__z _ _ photometric redshift against the spectroscopic value for each galaxy in the evaluation set .",
    "the rms deviation between these is @xmath34 , which compares well with the results in table [ sdss_results ] . for clarity the estimated errors on the photometric redshifts",
    "are not shown in fig .",
    "[ fig.edr.5 ] .",
    "the results for a randomly - selected subset of 200 galaxies are shown with errorbars in figure [ fig.edr.errorbars ] . due to the high quality of the training data in this case",
    ", network variance makes only a small contribution and the errors are therefore dominated by the photometric noise .",
    "lc    cww & 0.0666 + bruzual - charlot &",
    "0.0552 + interpolated & 0.0451 + polynomial & 0.0318 + kd - tree & 0.0254 + ann__z _ _ & 0.0229    hyperz is a widely used template - based photometric redshift package . in order to more directly compare ann__z _ _ with the template - matching method , hyperz was applied to the same evaluation set using the cww template seds @xcite .",
    "it is clear from the results in fig .",
    "[ fig.edr.hyperz ] that not only is the rms dispersion in the photometric redshift considerably greater than that for ann__z _ _ , but there are also systematic deviations in the hyperz results .",
    "the sdss consortium obtained similar accuracies to hyperz in their implementation of the basic template - fitting technique ( the results labelled _ cww _ and _ bruzual - charlot _ in table [ sdss_results ] are for the respective template sets ) . with more sophisticated template - based methods they were able to improve on these errors :",
    "the result labelled _ interpolated _ was obtained by first tuning the templates using the spectroscopic sample as a training set , then producing a continuous range of templates by interpolating between the tweaked seds .",
    "however , even `` hybrid '' methods such as this still do not match the accuracy achieved by the purely empirical methods ( in the table these are : _ polynomial _ , which uses a second - order polynomial as the fitting function , and _ kd - tree _ ,",
    "in which the training set is partitioned in colour - space and a separate second - order polynomial is fitted in each cell ) .      in this section more advanced use of ann__z _ _ is demonstrated .",
    "these examples use the lrg and main galaxy data from the sdss data release 1 ( dr1 ; @xcite ) , split into training , validation and evaluation sets of respective sizes 50,000 , 10,000 and 64,175 . for these data the photometric redshift accuracy on the evaluation set when using the same basic method as in  [ sec.compare ]",
    "was @xmath35 .",
    "one of the great advantages of empirical photometric redshift methods is the ease with which we can introduce additional observables into our parametrization of the photometric redshift .",
    "this is particularly true for ann__z _ _ ; we simply add an extra input to our network architecture for each new parameter we wish to consider .",
    "_ treats these new inputs in exactly the same way as it does the galaxy magnitudes .",
    "if the additional inputs contain useful information then the ann will use this to improve the accuracy of its predictions .",
    "however , increasing the number of inputs to the ann generally leads to a reduction in the _ generalization _ capabilities of the network ( that is , its ability to make predictions for data on which it has not been trained ) .",
    "thus , the inputs should be chosen carefully as non - informative inputs may actually lead to a worsened ann performance : due to the increased dimensionality of the input space , larger training sets may be required and there will be an increased likelihood of converging to a local rather than the global minimum .    by way of example , the @xmath36-band 50 and 90 per cent petrosian flux radii were added as two extra inputs to our ann .",
    "these are the angular radii ( concentric with the galaxy brightness distribution ) containing the stated fraction of the petrosian flux , and therefore contain information on the angular size of the galaxy ( clearly a strongly distance - dependent property ) and the _ concentration index _",
    "( essentially the steepness of the galaxy brightness profile , which may help break degeneracies in the redshift - colour relationship ) . running this extended data set through ann__z _ _ ( using a committee of five 7:11:11:1 networks ) produced a redshift estimation accuracy of @xmath37 , an improvement of @xmath333 per cent compared to the results based only on the magnitudes .",
    "in this example the improvement is small ( mainly because the training sample already provided excellent redshift information ) , but it demonstrates well how straightforwardly the extra information could be included for consideration by ann__z__.      it is equally straightforward to train ann__z _ _ to make predictions for properties other than the redshift .",
    "template - matching photometric redshift techniques have the useful side effect of assigning an estimated spectral type to each galaxy , in addition to estimating the redshift .",
    "@xcite demonstrated the use of anns to determine spectral types from broad - band photometry .",
    "the spectroscopic catalogue of the sdss includes a continuous parameter ( ` eclass ` ) indicating spectral type which ranges from approximately @xmath38 ( early types ) to @xmath39 ( late types ) .",
    "a 5:10:10:2 network architecture was used to attempt the simultaneous estimation of redshift and ` eclass ` from the photometry .",
    "the accuracy of the redshift estimation was very slightly poorer , @xmath40 .",
    "the ` eclass ` was determined with an rms error of @xmath41 ( fig .",
    "[ fig.eclass ] ) .",
    "our example applications to the sdss above are somewhat idealistic , since we are training and testing on samples with identical redshift , magnitude and galaxy species distributions .",
    "furthermore , our training samples have thus far been very large . in this section",
    "less optimal training sets are used to investigate their impact on the photometric redshift accuracy .",
    "the size of training sample needed will be strongly dependent on the range of redshifts and galaxy types in the target sample .",
    "the same evaluation set of 64,175 galaxies was submitted to networks trained on randomly selected samples of ( i ) 2000 galaxies and ( ii ) 200 galaxies . in both cases these samples",
    "were split equally into the training and validation sets .",
    "committees of five 5:10:10:1 networks were used .",
    "the photometric redshift accuracies were respectively ( i ) @xmath42 and ( ii ) @xmath43 .",
    "in the first case the loss of accuracy is small , while the second case demonstrates well the problems associated with small training sets . the rarer classes of object in the target sample ( e.g. here , those at high redshift ) feature very sparsely ( if at all ) in the training set and so the network is unable to sensibly deal with these objects when they appear in the testing data .",
    "this leads to an increased number of outliers and , potentially , the introduction of systematic errors .      for increasingly faint targets , acquiring good",
    "spectroscopy becomes increasingly difficult and eventually prohibitively expensive ; this problem is the primary motivation for photometric redshifts . in practice then , the available spectroscopic training sample is likely to be somewhat brighter on average than the photometric target sets .",
    "however , the major stumbling block for empirical photometric redshift estimation techniques is the difficulty in applying them outside of the regions of parameter space which are well sampled by the training data : while the estimator ought to be able to interpolate _ within _ the training regime , extrapolating beyond is much more problematic .",
    "ideally we would like to be able to train our estimator on bright galaxies , and then confidently apply it to faint galaxies .",
    "we can improve the ann s prospects by careful pre - selection of the data set .",
    "the luminous red galaxies are a very uniform sample with respect to spectral types , since these early - type galaxies show little spectral evolution with redshift ; this might be expected to make extrapolation a more manageable task . to assess the effectiveness of ann__z _ _ in this situation the lrg sample",
    "was split roughly in half by imposing a magnitude cut at @xmath44 .",
    "the brighter subsample was further divided at random into training and validation sets of size 5000 and 2000 galaxies respectively .",
    "a committee of five 5:10:10:1 networks was trained on this data and then applied to the remaining @xmath45 lrgs ( for which the limiting magnitude is @xmath46 ) .",
    "the results are shown in fig .",
    "[ fig.lrgs ] .",
    "the overall dispersion is @xmath47 which represents only a slight loss of accuracy when compared with results using a lrg training set selected over all magnitudes ( @xmath48 ) .",
    "thus , in this particular case , ann__z _",
    "_ is able to extrapolate with some success to around a magnitude fainter than is sampled by the training data .",
    "in appropriate circumstances , ann__z _ _ is a highly competitive tool for photometric redshift estimation .",
    "however , it does rely on the existence of a sufficiently large training set which is representative of the particular populations being studied . the package s utility therefore lies particularly with large photometric surveys such as the sdss , goods @xcite or the virmos - vlt deep survey @xcite , some of which include spectroscopic surveys for subsets of the photometric catalogues ( for example , of the eventual 100 million photometric objects which the sdss expect to catalogue , 1 million will also have spectroscopy , and hence accurate redshifts ) .",
    "a major problem for empirical photometric redshift estimators is the difficulty in extrapolating to regions of the input parameter space which are not well sampled by the training data .",
    "care should be taken to match the training data to the target sample as closely as possible in terms of the magnitude and colour distributions of each .",
    "use of an evaluation set is essential when applying ann__z _ _ to a new data set : the good performance demonstrated here on the sdss data can not be guaranteed on different data sets .    a potential solution to the problem of obtaining training sets when spectroscopy is difficult to obtain is to use simulated catalogues as training data ( e.g. @xcite ) .",
    "since this requires the use of theoretical seds it introduces the disadvantages of the template - based methods , such as the need for precise calibration . however , the ann approach has advantages over standard template - matching : simulated catalogues can contain galaxies representing a large range of complex star formation histories , dust extinction models and metallicities etc . , giving fully bayesian statistics , and anns allow much more flexible weighting to be applied to the filters than is possible with the simple @xmath2-weighting of standard template - matching .",
    "we acknowledge help and advice from stefano andreon , andrew firth , rachel somerville and elizabeth stanway .",
    "the ann training program is based on code kindly provided by b.  d.  ripley .",
    "aac is supported by an isle of man department of education postgraduate studies grant .",
    "ol acknowledges a pparc research senior fellowship ."
  ],
  "abstract_text": [
    "<S> we introduce ann__z _ _ , a freely available software package for photometric redshift estimation using artificial neural networks . ann__z _ _ learns the relation between photometry and redshift from an appropriate training set of galaxies for which the redshift is already known . </S>",
    "<S> where a large and representative training set is available ann__z _ _ is a highly competitive tool when compared with traditional template - fitting methods .    </S>",
    "<S> the ann__z _ _ package is demonstrated on the sloan digital sky survey data release 1 , and for this particular data set the r.m.s . </S>",
    "<S> redshift error in the range @xmath0 is @xmath1 . </S>",
    "<S> non - ideal conditions ( spectroscopic sets which are small , or which are brighter than the photometric set for which redshifts are required ) are simulated and the impact on the photometric redshift accuracy assessed .    the package may be freely downloaded from ` http://www.ast.cam.ac.uk/~aac ` . </S>"
  ]
}