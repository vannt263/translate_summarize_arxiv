{
  "article_text": [
    "tries and suffix trees are the most popular data structures on words @xcite .",
    "trie _ is a digital tree built over , say @xmath0 , strings ( the reader is referred to @xcite for an in depth discussion of digital trees . )",
    "a string is stored in an external node of a trie and the path length to such a node is the shortest prefix of the string that is not a prefix of any other strings ( cf.=1000 figure  [ fig - trie ] ) . throughout ,",
    "we assume a binary alphabet .",
    "then each branching node in a trie is a binary node .",
    "a special case of a trie structure is a _",
    "suffix trie _ ( tree ) which is a trie built over suffixes of a _ single _ string .",
    "since 1960 tries were used in many computer science applications such as searching and sorting , dynamic hashing , conflict resolution algorithms , leader election algorithms , ip addresses lookup , coding , polynomial factorization , lempel - ziv compression schemes , and molecular biology .",
    "for example , in the internet ip addresses lookup problem @xcite one needs a fast algorithm that directs an incoming packet with a given ip address to its destination . as a matter of fact , this is the _ longest matching prefix _ problem , and standard tries are well suited for it .",
    "however , the search time is too large .",
    "if there are @xmath0 ip addresses in the database , the search time is @xmath17 , and this is not acceptable . in order to improve the search time , andersson and nilsson @xcite introduced a novel data structure called the _ level compressed trie _ or in short lc trie ( cf.=1000 figure  [ fig - trie ] ) . in the lc trie",
    "we replace the root with a node of degree equal to the size of the largest _ full subtree _ emanating from the root ( the depth of such a subtree is called the _ fillup level _ ) .",
    "this is further carried on recursively throughout the whole trie ( cf .",
    "figure  [ fig - trie ] ) .",
    "some recent experimental results reported in @xcite indicated a `` dramatic improvement '' in the search time when full subtrees are replaced by `` partially fillup subtrees '' . in this paper , we provide a theoretical justification of these experimental results by considering @xmath4-lc tries in which one replaces a subtree with the last level only @xmath4-filled by a node of degree equal to the size of such a subtree ( and we continue recursively ) . in order to understand theoretically the @xmath4-lc trie behavior , we study here the so called _",
    "level @xmath5 and the _ typical depth _ or the search time @xmath10 .",
    "the @xmath4-fillup level is the last level in a trie that is @xmath4-filled , i.e.=1000 filled up to a fraction at least @xmath4 ( e.g. , in a binary trie level @xmath18 is @xmath4-filled if it contains @xmath19 nodes ) .",
    "the typical depth is the length of a path from the root to a randomly selected external node ; thus it represents the typical search time . in this paper",
    "we analyze the @xmath4-fillup level and the typical depth in an @xmath4-lc trie in a probabilistic framework when all strings are generated by a memoryless source with @xmath20 and @xmath21 . among other results , we prove that the @xmath4-lc trie shows a rather moderate improvement over the original lc tries",
    ". we shall quantify this statement below .",
    "tries were analyzed over the last thirty years for memoryless and markov sources ( cf.=1000 @xcite ) .",
    "pittel @xcite found the typical value of the fillup level @xmath22 ( i.e. , @xmath23 ) in a trie built over @xmath0 strings generated by mixing sources ; for memoryless sources with high probability ( whp ) @xmath24 where @xmath25 is the smallest probability of generating a symbol and @xmath26 is the rnyi entropy of infinite order ( cf.=1000 @xcite ) .",
    "we let @xmath27 . in the above ,",
    "we write @xmath28 to denote @xmath29 in probability , that is , for any @xmath30 we have @xmath31 as @xmath32 .",
    "this was further extended by devroye @xcite , and knessl and szpankowski @xcite who , among other results , proved that the fillup level @xmath22 is concentrated on two points @xmath33 and @xmath34 , where @xmath33 is an integer @xmath35 for @xmath11 .",
    "the depth in regular tries was analyzed by many authors who proved that whp the depth is about @xmath36 ( where @xmath37 is the shannon entropy rate of the source ) and that it is normally distributed when @xmath11 @xcite .",
    "the original lc tries were analyzed by andersson and nilsson @xcite for unbiased memoryless source and by devroye @xcite for memoryless sources ( cf.=1000 also @xcite ) .",
    "the typical depth ( search time ) for regular lc tries was only studied recently by devroye and szpankowski @xcite who proved that for memoryless sources with @xmath11 @xmath38    in this paper we shall prove some rather surprising results .",
    "first of all , for @xmath39 we show that the @xmath4-fillup level @xmath5 is whp equal either to @xmath33 or @xmath34 where @xmath40 as a consequence , we find that if @xmath11 , the depth @xmath10 of the @xmath4-lc is for large @xmath0 typically about @xmath41    the ( full ) @xmath2-fillup level @xmath22 shown in should be compared to the @xmath4-fillup level @xmath5 presented in .",
    "observe that the leading term of @xmath5 is _ not _ the same as the leading term of @xmath22 when @xmath11 .",
    "furthermore , @xmath4 contributes only to the second term asymptotics .",
    "when comparing the typical depths @xmath42 and @xmath10 we conclude that both grow like @xmath43 with two constants that do not differ by much .",
    "this comparison led us to a statement in the abstract that the improvement of @xmath4-lc tries over the regular lc tries is rather moderate .",
    "we may add that for relatively slowly growing functions such as @xmath44 the constants in front of them do matter ( even for large values of @xmath0 ) and perhaps this led the authors of @xcite to their statements .",
    "the paper is organized as follows . in the next section we present our main results which are proved in the next two sections .",
    "we first consider a poissonized version of the problem for which we establish our findings .",
    "then we show how to depoissonize our results completing our proof .",
    "consider tries created by inserting @xmath0 random strings of 0 and 1 .",
    "we will always assume that the strings are ( potentially ) infinite and that the bits in the strings are independent random bits , with @xmath20 and thus @xmath21 ; moreover we assume that different strings are independent .",
    "we let @xmath45 : = # @xmath46 and @xmath47 , i.e.=1000 the proportion of nodes filled at level @xmath18 .",
    "note that @xmath45 may both increase and decrease as @xmath18 grows , while @xmath48    recall that the fillup level of the trie is defined as the last full level , i.e.  @xmath49 , while the height is the last level with any nodes at all , i.e.@xmath50 .",
    "similarly , if @xmath51 , the @xmath52-fillup  level @xmath5 is the last level where at least a proportion @xmath52 of the nodes are filled , i.e.@xmath53    we will in this paper study the @xmath52-fillup  level for a given @xmath52 with @xmath54 and a given @xmath1 with @xmath55 .    we have the following result , where whp means with probability tending to 1 as @xmath56 , and @xmath57 denotes the normal distribution function . theorem  [ t1 ] is proved in section  [ sdepo ] , after first considering a poissonized version in section  [ spo ] .    [ t1 ] let @xmath52 and @xmath1 be fixed with @xmath54 and @xmath55 , and let @xmath58 be the @xmath52-fillup  level for the trie formed by @xmath0 random strings as above .",
    "then , for each @xmath0 there is an integer @xmath59 such that whp @xmath60 or @xmath34 .",
    "moreover , @xmath61 for @xmath62 .",
    "thus the @xmath4-fillup level @xmath58 is concentrated on at most two values ; as in many similar situations ( cf.=1000 @xcite ) , it is easily seen from the proof that in fact for most @xmath0 it is concentrated on a single value @xmath33 , but there are transitional regimes , close to the values of @xmath0 where @xmath33 changes , where @xmath58 takes two values with comparable probabilities .",
    "note that when @xmath63 , the second term on the right hand side disappears , and thus simply @xmath64 ; in particular , two different values of @xmath65 have their corresponding @xmath33 differing by @xmath66 only .",
    "when @xmath11 , changing @xmath52 means shifting @xmath33 by @xmath67 . by theorem  [ t1 ] ,",
    "whp @xmath58 is shifted by the same amounts .    to the first order",
    ", we thus have the following simple result .    [ ct1 ] for any fixed @xmath52 and @xmath1 with @xmath54 and @xmath55 , @xmath68 in particular , @xmath69 as @xmath56 .",
    "surprisingly enough , the leading terms of the fillup level for @xmath23 and @xmath70 are quantitatively different for @xmath11 .",
    "it is well known , as explained in the introduction , that the regular fillup level @xmath22 is concentrated on two points around @xmath71 , while the partial fillup level @xmath5 concentrates around @xmath72 .",
    "secondly , the leading term of @xmath5 does not depend on @xmath4 and the second term is proportional to @xmath73 , while for the regular fillup level @xmath22 the second term is of order @xmath74 .",
    "theorem  [ t1 ] yields several consequences for the behavior of @xmath4-lc tries .",
    "in particular , it implies the typical behavior of the depth , that is , the search time .",
    "below we formulate our main second result concerning the depth for @xmath4-lc tries delaying the proof to section  [ slc ] ; cf.=1000 and @xcite for lc tries .    [ t3 ] for any fixed @xmath75 and @xmath76 we have @xmath77 as @xmath32 where @xmath78 is the entropy rate of the source .    as a direct consequence of theorem  [ t3 ] we can numerically quantify experimental results recently reported in @xcite where a `` dramatic improvement '' in the search time of @xmath4-lc tries over the regular lc tries was observed . in a regular lc trie",
    "the search time is @xmath79 with the constant in front of @xmath44 being @xmath80 @xcite . for @xmath4-lc",
    "tries this constant decreases to @xmath81 .",
    "while it is hardly a `` dramatic improvement '' , the fact that we deal with a slowly growing leading term @xmath44 , may indeed lead to experimentally observed significant changes in the search time .",
    "in this section we consider a poissonized version of the problem , where there are @xmath82 strings inserted in the trie .",
    "we let @xmath83 denote the @xmath52-fillup  level of this trie .",
    "[ t2 ] let @xmath52 and @xmath1 be fixed with @xmath54 and @xmath55 , and let @xmath83 be the @xmath52-fillup  level for the trie formed by @xmath84 random strings as above . then , for each @xmath85 there is an integer @xmath86 such that whp ( as @xmath87 ) @xmath88 or @xmath89",
    ".    we shall prove theorem [ t2 ] through a series of lemmas .",
    "observe first that a node at level @xmath18 can be labeled by a binary string of length @xmath18 , and that the node is filled if and only if at least two of the inserted strings begin with this label .",
    "for @xmath90 , let @xmath91 be the number of ones in @xmath92 , and let @xmath93 be the probability that a random string begins with @xmath92 .",
    "then , in the poissonized version , the number of inserted strings beginning with @xmath90 has a poisson distribution @xmath94 , and these numbers are independent for different strings @xmath92 of the same length .",
    "consequently , @xmath95 where @xmath96 are independent indicators with @xmath97    hence , @xmath98 so @xmath99 and , by chebyshev s inequality , @xmath100 consequently , @xmath101 is sharply concentrated , and it is enough to study its expectation .",
    "( it is straightforward to calculate @xmath102 more precisely , and to obtain a normal limit theorem for @xmath45 , but we do not need that . )    assume first @xmath103 .",
    "[ l1 ] if @xmath103 and @xmath104 then @xmath105 .",
    "let @xmath106 and define @xmath107 by @xmath108 , i.e. , @xmath109 which leads to @xmath110    let @xmath111 . by and , @xmath112 if @xmath113 , then @xmath114 and @xmath115 if @xmath116 , then @xmath117 and @xmath118 hence yields , using @xmath119 , @xmath120 by the berry  esseen theorem ( * ? ?",
    "* theorem xvi.5.1 ) , @xmath121    by and the assumption , @xmath122 this finally implies @xmath123 and the lemma follows by and .",
    "[ l2 ] fix @xmath103 . for every @xmath124",
    ", there exists @xmath125 such that if @xmath126 , then @xmath127 .",
    "a string @xmath90 has two extensions @xmath128 and @xmath129 in @xmath130 .",
    "clearly , @xmath131 , and if there are exactly 2 ( or 3 ) of the inserted strings beginning with @xmath92 , then @xmath132 .",
    "hence @xmath133 let @xmath134 and @xmath135 be as in the proof of lemma  [ l1 ] , and let @xmath136 .",
    "then @xmath137 $ ] and thus @xmath138 .",
    "moreover , by and the assumption , @xmath139 thus , if @xmath18 is large enough , we have by the standard normal approximation of the binomial probabilities ( which follows easily from stirling s formula , as found already by de moivre @xcite ) @xmath140 for some @xmath141 .",
    "hence , by , @xmath142 as needed .",
    "-    now assume @xmath103 . starting with any @xmath18 as in ,",
    "we can by lemmas [ l1 ] and  [ l2 ] shift @xmath18 up or down @xmath66 steps and find @xmath143 as in such that , for a suitable @xmath125 , @xmath144 and @xmath145 .",
    "it follows by that whp @xmath146 and @xmath147 , and hence @xmath148 or @xmath149 .",
    "this proves theorem  [ t2 ] in the case @xmath103 .",
    "the case @xmath150 follows by symmetry , interchanging @xmath1 and @xmath151 .    in the remaining case @xmath63 , all @xmath152 are equal .",
    "thus , by and , @xmath153 given @xmath65 , there is a @xmath154 such that @xmath155 .",
    "we take @xmath156 .",
    "then , @xmath157 and thus @xmath158 for some @xmath159 .",
    "similarly , @xmath160 for some @xmath161 , and the result follows in this case too .",
    "to complete the proof of theorem  [ t1 ] we must depoissonize the results obtained in theorem  [ t2 ] , which we do in this section .",
    "given an integer @xmath0 , let @xmath33 be as in the proof of theorem  [ t2 ] with @xmath162 , and let @xmath163",
    ". then @xmath164 and @xmath165 as @xmath56 . by monotonicity",
    ", we thus have whp @xmath166 , and by theorem  [ t2 ] it remains only to show that we can take @xmath167 .",
    "let us now write @xmath168 and @xmath169 , since we are working with several @xmath170 .",
    "[ l3 ] assume @xmath11 .",
    "then , for every @xmath18 , @xmath171    we have @xmath172 and thus , by and the argument in , @xmath173 which completes the proof . -    by lemma  [ l3 ] , @xmath174 . hence , by the proof of theorem  [ t2 ] , for large @xmath0 , @xmath175 and @xmath176 , and thus whp @xmath177 or @xmath34 .",
    "moreover , the estimate @xmath61 follows easily from the similar estimate for the poisson version in lemma  [ l1 ] ; we omit the details .",
    "this completes the proof of theorem  [ t1 ] for @xmath103 .",
    "the case @xmath150 is again the same by symmetry .",
    "the proof when @xmath63 is similar , now using .",
    "first , let us explain heuristically our estimate for @xmath10",
    ". by the asymptotic equipartition property ( cf.=1000 @xcite ) at level @xmath33 there are about @xmath178 strings with the same prefix of length @xmath33 as a randomly chosen one , where @xmath179 is the entropy . that is , in the corresponding branch of the @xmath52-lc trie",
    ", we have about @xmath180 strings ( or external nodes ) , where for simplicity @xmath181 . in the next level",
    ", we shall have about @xmath182 external nodes , and so on .",
    "in particular , at level @xmath10 we have approximately @xmath183 external nodes . setting this @xmath184 leads to our estimate ( [ et3 ] ) of theorem  [ t3 ] .",
    "we now make this argument rigorous .",
    "we construct an @xmath52-lc trie from @xmath0 random strings @xmath185 and look at the depth @xmath10 of a designated one of them . in principle , the designated string should be chosen at random , but by symmetry , we can assume that it is the first string @xmath186 . to construct the @xmath52-lc trie , we scan the strings @xmath185 in parallel one bit at a time , and build a trie level by level . as soon as the last level is filled less than @xmath52 , we stop ; we are now at level @xmath187 , just past the @xmath52-fillup level . the trie above this level , i.e.=1000 up to level @xmath5 , is compressed into one node , and we continue recursively with the strings attached to each node at level @xmath188 in the uncompressed trie , i.e.=1000 the sets of strings that begin with the same prefixes of length @xmath188 .",
    "to find the depth @xmath189 of the designated string @xmath186 in the compressed trie , we may ignore all branches not containing @xmath186 ; thus we let @xmath190 be the number of the @xmath0 strings that agree with @xmath186 for the first @xmath188 bits .",
    "note that we have not yet inspected any later bits .",
    "hence , conditioned on @xmath58 and @xmath190 , the remaining parts of these @xmath190 strings are again i.i.d.=1000 random strings from the same memoryless source , so we may argue by recursion .",
    "the depth @xmath189 equals the number of recursions needed to reduce the number of strings to 1 .",
    "we iterate , and let @xmath196 be the number of strings remaining after @xmath197 iterations ; this is the number of strings that share the first @xmath197 levels with @xmath186 in the compressed trie .",
    "we have @xmath198 and @xmath199 .",
    "we stop the iteration when there are less than @xmath200 strings remaining ; we thus let @xmath201 be the smallest integer such that @xmath202 . in each iteration before @xmath201 , holds with error probability @xmath203 .",
    "hence , for any constant @xmath204 , we have whp for every @xmath205 , with @xmath206 , @xmath207 or equivalently @xmath208          iterating this result once , we see that whp at most @xmath219 further iterations are needed to reduce the number to less than @xmath220 . finally , the remaining depth then whp is @xmath221 even without compression .",
    "hence we see that whp@xmath222 since @xmath223 is arbitrary , theorem  [ t3 ] follows .",
    "it remains to prove lemma  [ la ] .",
    "let @xmath224 be the number of the strings @xmath185 that are equal to @xmath186 for at least their first @xmath18 bits .",
    "the @xmath225 , and thus , for any @xmath124 , @xmath226 lemma  [ la ] thus follows from the following two lemmas , using the observation that @xmath227 .",
    "the first lemma is a large deviation estimate corresponding to corollary  [ ct1 ] .",
    "we begin with the poissonized version , with @xmath84 strings as in section  [ spo ] .",
    "let @xmath230 , and let @xmath231 be fixed with @xmath232 .",
    "then , by lemma  [ l1 ] , if @xmath228 is large enough , @xmath233 and @xmath234 for all large @xmath170 . by a chernoff bound , can be sharpened to @xmath235 and thus @xmath236 similarly , @xmath237 .    to depoissonize ,",
    "let @xmath163 as in section  [ sdepo ] and note that , again by a chernoff estimate , @xmath238 and @xmath239 .",
    "thus , with probability @xmath240 , @xmath241 and the result follows ( if we increase @xmath228 ) .        since @xmath248 , there exists @xmath249 such that if @xmath250 , then @xmath251 , and thus @xmath252 noting that @xmath253 and @xmath254 , we see that , provided @xmath223 is small enough , @xmath255 for some @xmath256 , and then and a chernoff estimate yields , when @xmath250 , @xmath257 and thus @xmath258                                                  y. reznik , on the average density and selectivity of nodes in multi - digit tries , _ proceedings of the seventh workshop on algorithm engineering and experiments and the second workshop on analytic algorithmics and combinatorics ( alenex / analco ; vancouver , 2005 ) _ , siam , 230239 , 2005 ."
  ],
  "abstract_text": [
    "<S> andersson and nilsson introduced in 1993 a _ level - compressed trie _ </S>",
    "<S> ( in short : lc trie ) in which a full subtree of a node is compressed to a single node of degree being the size of the subtree . </S>",
    "<S> recent experimental results indicated a `` dramatic improvement '' when full subtrees are replaced by `` partially filled subtrees '' . in this paper , we provide a theoretical justification of these experimental results showing , among others , a rather moderate improvement of the search time over the original lc tries . </S>",
    "<S> for such an analysis , we assume that @xmath0 strings are generated independently by a binary memoryless source ( a generalization to markov sources is possible ) with @xmath1 denoting the probability of emitting a `` @xmath2 '' ( and @xmath3 ) . </S>",
    "<S> we first prove that the so called @xmath4-fillup level @xmath5 ( i.e. , the largest level in a trie with @xmath4 fraction of nodes present at this level ) is concentrated on two values whp ( with high probability ) ; either @xmath6 or @xmath7 where @xmath8 is an integer and @xmath9 denotes the normal distribution function . </S>",
    "<S> this result directly yields the typical depth ( search time ) @xmath10 in the @xmath4-lc tries with @xmath11 , namely we show that whp @xmath12 where @xmath13 and @xmath14 is the shannon entropy rate . </S>",
    "<S> this should be compared with recently found typical depth in the original lc tries which is @xmath15 where @xmath16 . in conclusion </S>",
    "<S> , we observe that @xmath4 affects only the lower term of the @xmath4-fillup level @xmath5 , and the search time in @xmath4-lc tries is of the same order as in the original lc tries .    </S>",
    "<S> [ cols= \" < , < \" , ]     * key words * : digital trees , level - compressed tries , partial fillup , probabilistic analysis , poissonization . </S>"
  ]
}