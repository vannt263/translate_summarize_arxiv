{
  "article_text": [
    "parton density distributions are important ingredients in the calculation of hard scattering lepton - hadron and hadron - hadron cross sections . to judge the comparison of theory and experiment it is important to evaluate the experimental and theoretical uncertainties on the predicted cross sections which are often dominated by those on the input parton densities .",
    "these densities are non - perturbative and are obtained from qcd fits to a large body of scattering data .",
    "the errors which have to be propagated in such a fit are the statistical and correlated systematic errors on the measurements , errors on the input parameters ( flavour thresholds , @xmath0 etc . ) and uncertainties in the theoretical modelling ( scale errors , non - perturbative contributions like higher twists and nuclear effects , functional form of the parton densities and so on ) .    in the past",
    "the errors associated with the parton densities were often determined from the spread between different parton distribution sets .",
    "such a spread is of course by no means a representation of the experimental and theoretical uncertainty . in recent years",
    "considerable progress is made on the proper error propagation in global qcd fits because the increasing accuracy of the hera and tevatron data demands reliable estimates of the uncertainties in the theory predictions .",
    "parton density uncertainties are of course also important for the ongoing lhc simulation studies",
    ".    two methods of error propagation are presently in use .",
    "one is based on the method of statistical inference using monte carlo integration techniques  @xcite .",
    "the more conventional approach makes use of the standard methods of least squares minimisation and linear error propagation . in this report",
    "we will restrict ourselves to a description of the latter method because it is , at present , the most developed and widely used in qcd fits by the various experimental collaborations and theory groups .",
    "the justification for using least squares lies in the assumption that the measurement errors are gaussian distributed . to introduce the effect of point to point",
    "correlated systematic errors , the measurements ( @xmath1 ) are related to the theory prediction ( @xmath2 ) by @xmath3 where @xmath4 is the measurement of data point @xmath5 , @xmath6 is the model prediction depending on a set of parameters @xmath7 , @xmath8 is the uncorrelated ( statistical ) error on data point @xmath5 and @xmath9 is the correlated ( systematic ) error from source @xmath10 .    in ( [ eq : midef ] ) , @xmath11 and @xmath12",
    "denote gaussian random variables with zero mean and unit variance .",
    "these random variables are assumed to be independent of each other : @xmath13 where we have introduced the notation @xmath14 and where the symbol @xmath15 denotes an average .",
    "the probability density function of the measurements can then be written as a multivariate gaussian distribution @xmath16 with @xmath17 a normalisation constant and @xmath18 defined by @xmath19 from ( [ eq : midef ] ) and ( [ eq : delridelrj ] ) the covariance matrix @xmath20 of the measurements is given by @xmath21 optimal values for the parameters , @xmath22 , are found by maximising the probability density @xmath23 or , equivalently , by minimising @xmath18 defined by ( [ eq : chi2def ] ) .    the standard method to calculate the covariance matrix of the fitted parameters",
    "is based on the assumption that the theory prediction varies approximately linearly with @xmath7 near the minimum of @xmath18 at @xmath22 .",
    "expanding @xmath18 up to second order in the variation @xmath24 gives @xmath25 because the linear term in ( [ eq : expandchi ] ) vanishes at the minimum we find for the covariance matrix @xmath26 of the parameters @xmath27 where we have introduced the hessian matrix @xmath28 of second order derivatives .",
    "notice that the covariance matrix @xmath26 depends on the choice of @xmath29 which usually , but not always , is taken to be @xmath30 . with this choice the probability density given in ( [ eq : dpdef ] ) drops by a factor @xmath31 when the parameters @xmath7 are a distance @xmath32 away from the optimum .",
    "this corresponds to the definition of the width of a gaussian distribution .    having obtained the best values and the covariance matrix of the parameters , the covariance of any two functions @xmath33 and @xmath34 can be calculated with the standard formula for linear error propagation @xmath35 here it is assumed that both @xmath36 and @xmath37 vary approximately linearly with @xmath7 in the neighbourhood of @xmath22 . because @xmath38 it follows from ( [ eq : fgmat ] ) that the hessian ( and its inverse ) must be positive definite , that is , for arbitrary vectors @xmath39 , @xmath40 finally we remark that , for simplicity , we have tacitly assumed that all errors can be treated as offsets . notice that multiplicative ( normalisation ) errors must be treated somewhat differently  @xcite to avoid possible large biases in the fit results  @xcite .",
    "in the quadratic approximation ( [ eq : expandchi ] ) a constant value of @xmath29 traces out an ellipsoid in parameter space as illustrated in figure  [ fig : hessecontour]a .",
    "( a ) ellipsoid contours defined by constant values of @xmath18 in parameter space .",
    "( b ) hyper - sphere contours of constant @xmath18 after an orthogonal transformation of the parameters defined by the eigenvectors and eigenvalues of the hessian matrix .",
    "figure taken from  @xcite . ]    when the directions of the major axes of this ellipsoid coincide with the directions of the parameter coordinate system the hessian matrix is diagonal and the parameters are said to be uncorrelated .",
    "if this is not the case the hessian can be made diagonal by a coordinate transformation to the major axes , that is , by a rotation in parameter space around the centre @xmath22 of the ellipsoid .",
    "this transformation can be written as @xmath41 where the second equation states that @xmath42 is an orthonormal transformation ( rotation ) .",
    "the matrix @xmath42 is given by the complete set of eigenvectors of the hessian matrix as defined by the eigenvalue equation @xmath43 the errors on the transformed parameters @xmath44 are given by @xmath45 so that all eigenvalues of @xmath28 must be positive , which is another way to state that the hessian is positive definite .",
    "we mention at this point that a non - positive definite hessian encountered in a ( qcd ) fit is a sign of either numerical problems in the calculation of @xmath18 ( no smooth behaviour around the minimum ) or of large correlations between the fitted parameters ( @xmath28 can not be inverted ) . in the latter case one or more",
    "parameters should be kept fixed in the fit or a different parameterisation of the theory prediction should be considered .",
    "rescaling @xmath46 maps the ellipsoid on a hyper - sphere in @xmath47-space as indicated in figure  [ fig : hessecontour]b .",
    "notice that if @xmath36 and @xmath37 are given as functions of @xmath48 or @xmath49 , instead of @xmath7 , equation ( [ eq : fgmat ] ) transforms to the expression @xmath50 which is of course easier to compute than ( [ eq : fgmat ] ) and , perhaps , is also numerically more accurate .",
    "the spectrum of eigenvalues obtained from a typical qcd fit  @xcite is shown in the left - hand plot of figure  [ fig : hessecheck ] .",
    "left : the eigenvalue spectrum of the hessian matrix from a typical global qcd fit with ( 13,16,18 ) free parameters .",
    "taken from  @xcite .",
    "right : distribution of @xmath29 calculated by minuit  ( dashed histogram ) and by an improved calculation from  @xcite ( full histogram ) on a 10-dimensional ellipsoid defined by @xmath51 .",
    "the spread is caused by numerical errors in the calculation of the hessian matrix . ]",
    "large ( small ) values of @xmath52 correspond to an accurate ( inaccurate ) determination of the transformed parameters @xmath44 by the fit .",
    "the large range in eigenvalues ( @xmath53 ) implies that the numerical calculation of the hessian matrix must be carried out with due attention to rounding errors .",
    "this is illustrated in the right - hand plot of figure  [ fig : hessecheck ] which shows the distribution of @xmath29 calculated from the hessian by minuit  @xcite ( dashed histogram ) and by an improved algorithm  @xcite ( full histogram ) for parameter values randomly distributed on the hyper - surface @xmath51 .",
    "the improvement in the calculation of the hessian is achieved by using more sample points than minuit  in the evaluation of the second derivatives .",
    "the algorithm is included in an update of the minuit  code which can be obtained from the authors of  @xcite .",
    "minimising @xmath18 defined by ( [ eq : chi2def ] ) is impractical because it involves the inversion of the measurement covariance matrix ( [ eq : vmeasdef ] ) which , in global fits , tends to become very large . because the systematic errors of different data sets are in general uncorrelated ( but not always",
    ", see  @xcite ) this matrix takes a block diagonal form and each block could , in principle , be inverted once and for all . however , the dimension of these block matrices can still easily be larger than a few hundred . furthermore ,",
    "if the systematic errors dominate , the covariance matrix might , numerically , be uncomfortably close to a matrix with the simple structure @xmath55 , which is singular .",
    "fortunately , the @xmath18 of ( [ eq : chi2def ] ) can be cast in an alternative form which avoids the inversion of large matrices ( we refer to @xcite for a derivation ) : @xmath56 the matrix @xmath57 in ( [ eq : cteqchi ] ) has the dimension of the number of systematic sources only and can be inverted at the initialisation phase of a fitting program once the number of data points included in the fit ( i.e.  after cuts ) is known .",
    "an example of a global qcd fit with error calculations based on the covariance matrix approach can be found in  @xcite .",
    "it is remarkable that minimising ( [ eq : cteqchi ] ) is equivalent to a fit where _ both _ the parameters @xmath7 and @xmath58 are left free . in such a fit",
    "@xmath18 is defined as follows .",
    "first , the effect of the systematic errors is incorporated in the model prediction @xmath59 next , @xmath18 is defined by @xmath60 the second term in ( [ eq : xpsdef ] ) serves to constrain the fitted values of @xmath58 .",
    "the presence of this term is easily understood if one takes the view that the calibration of each experiment yields a set of ` measurements ' @xmath61  @xcite .    because @xmath62 is linear in @xmath58",
    "the minimisation with respect to the systematic parameters can be done analytically .",
    "it is easy to show , by solving the equations @xmath63 , that this leads to the @xmath18 given by ( [ eq : cteqchi ] ) which , in turn , is equivalent to ( [ eq : chi2def ] ) , see  @xcite .",
    "the relation between the optimal values of @xmath58 , the matrix @xmath57 and the vector @xmath64 of ( [ eq : cteqchi ] ) is @xmath65 a recent qcd analysis by the h1 collaboration  @xcite is based on a minimisation of ( [ eq : xpsdef ] ) with the systematic parameters left free in the fit .    in the following",
    "we will use the term ` hessian method ' to refer to qcd fits based on the minimisation of the @xmath18 defined by ( [ eq : cteqchi ] ) or ( [ eq : xpsdef ] ) , the alternative being the ` offset method ' which we will describe in the next section .",
    "there is another method to propagate the systematic errors which also has the property that the inversion of a large measurement covariance matrix is avoided . like in the previous section @xmath18",
    "is defined by ( [ eq : fpsdef ] ) and ( [ eq : xpsdef ] ) but now the systematic parameters are kept fixed to @xmath66 in the fit .",
    "this results in minimising @xmath67 where only statistical errors are taken into account to get the best value @xmath22 of the parameters . because systematic errors are ignored in the @xmath18 such a fit forces the theory prediction to be as close as possible to the data .",
    "the systematic errors on @xmath7 are estimated from fits where each systematic parameter @xmath12 is offset by its assumed error ( @xmath68 ) after which the resulting deviations @xmath32 are added in quadrature . to first order",
    "this lengthy procedure can be replaced by a calculation of two hessian matrices @xmath69 and @xmath70 @xmath71 the statistical covariance matrix of the fitted parameters is then given by @xmath72 while a systematic covariance matrix can be defined by  @xcite @xmath73 where @xmath74 is the transpose of @xmath70 .",
    "the total covariance matrix @xmath26 is given by the sum of the matrices @xmath75 and @xmath76 .    comparing equations ( [ eq : cteqchi ] ) or ( [ eq : xpsdef ] ) and ( [ eq : offsetchi ] ) it is clear that the parameter values obtained by the hessian and offset methods will , in general , be different .",
    "this difference is accounted for by the difference in the error estimates , those of the offset method being larger in most cases . in statistical language",
    "this means that the parameter estimation of the offset method is not _",
    "efficient_. the offset method has a further disadvantage that the goodness of fit can not be judged from the @xmath18 which is calculated from statistical errors only . an _",
    "ad hoc _ solution to this problem is to re - calculate , after the fit has converged , a @xmath18 with the statistical and systematic errors added in quadrature  @xcite .    for a detailed comparison of the hessian and offset methods we refer to  @xcite where it is shown that the error estimates from the two methods can differ by a large amount when the systematic errors dominate",
    "this is illustrated in figure [ fig : alekhinglue ] which shows the error bands on the gluon density obtained from a lo qcd fit to the bcdms data .",
    "the gluon density versus the bjorken scaling variable @xmath77 from a lo qcd fit to the bcdms structure function data .",
    "the dotted curves show the statistical error band .",
    "the full curves indicate the systematic error band calculated using the offset method ( a ) and the hessian method ( b ) .",
    "figure taken from  @xcite .",
    ", height=264 ]    this might also explain the difference in the error estimates on @xmath0 from recent qcd fits by h1  @xcite ( hessian method with free systematic parameters ) and zeus  @xcite ( offset method ) : @xmath78 notice however that these fits differ in many other respects like the data sets included , kinematic cuts , treatment of charm mass effects and so on .",
    "as mentioned above , the hessian method is based on the assumption that the theory prediction is approximately linear in the vicinity of @xmath22 which means that @xmath18 is a quadratic function of the parameters near the minimum . to check this quadratic dependence one can fix a parameter @xmath79 , say , and optimise the remaining parameters for different input values of @xmath79 . in this way",
    "@xmath18 is explored along the axes of the parameter coordinate system .",
    "the procedure is automatically carried out using the ` minos ' option in minuit .",
    "the lagrange multiplier method , developed in  @xcite , allows to investigate the @xmath18 profile along any relevant direction in parameter space . here",
    "the quantity @xmath80 is minimised for several fixed values of the lagrange multiplier @xmath81 . in ( [ eq : lagrangechi ] ) @xmath82 is the global @xmath18 calculated from the data included in the fit and @xmath83 is a physics quantity of interest ( _ not _ included in the fit ) , for instance , the @xmath84 production cross - section @xmath85 in @xmath86 collisions at the tevatron .",
    "the results of such a lengthy analysis obtains the @xmath18 profile as a function of @xmath83 and thus the range of @xmath83 corresponding to a given value of @xmath29 .",
    "this method does not make use of a quadratic approximation of the @xmath18 profile .    in the left - hand plot of figure",
    "[ fig : lagrange ] we show @xmath18 as function of @xmath85 from the analysis of  @xcite .",
    "left : the @xmath82 ( see text ) versus the cross - section @xmath85 of inclusive @xmath84 production at tevatron energies from the qcd analysis of  @xcite .",
    "right : optimal values of @xmath85 ( dots ) and 90% confidence levels ( bars ) for each data set included in the fit . the full line shows the best prediction for @xmath85 and the dashed lines represent the confidence bounds described in the text .",
    "figures taken from  @xcite . ]    in this analysis the 90% confidence levels of @xmath85 were obtained from the @xmath18 profiles of each data set individually , see the right - hand plot of figure  [ fig : lagrange ] .",
    "the uncertainty on @xmath85 was then defined as the intersection of these individual confidence levels ( dashed lines in figure  [ fig : lagrange ] ) giving @xmath87  nb .",
    "a similar uncertainty of 4% on the @xmath85 prediction is obtained from the hessian method provided @xmath29 in ( [ eq : hessian ] ) or ( [ eq : fgmat ] ) is set to 180 ( for a fit of 1295 data points distributed over 15 data sets ) .",
    "the origin of this large @xmath29 is unclear to us but the question which value of @xmath29 should be chosen in a global qcd analysis and which deviations from the expected @xmath18 value ( @xmath88 for a fit with @xmath89 degrees of freedom ) can be tolerated is clearly an important issue .",
    "for a discussion on this subject we refer to  @xcite .",
    "a bad @xmath18 in a global analysis may have several causes .",
    "first , it can be an indication of physics beyond the standard model .",
    "second , the theoretical modelling may be inadequate because higher order terms in the perturbative expansion are missing or non - perturbative contributions like higher twists or nuclear effects are not , or only partially , taken into account .",
    "in addition , there is always the question if the parton densities are parameterised with sufficient flexibility .",
    "third , the information on the experimental errors may be inaccurate , incomplete ( not all correlations given ) or even not be fully known .",
    "finally , the data may very well not be gaussian distributed .    concerning the latter point we refer to an analysis  @xcite of a large sample of data from the table of particle properties .",
    "it turns out that the probability distribution of this body of data is far from gaussian .",
    "this may be due to uncertainties in the error estimates provided by the experiments which , as is shown in  @xcite , can strongly affect the shape of the probability distribution of the data .",
    "error calculations in global qcd fits are of little practical use if the results are not made available in the form of parton distribution sets which contain the full information on uncertainties and correlations .",
    "to our knowledge two such sets exist at present .    the set provided by alekhin  @xcite gives as a function of @xmath77 and @xmath90 the values of the parton densities and their covariance matrix as calculated with  ( [ eq : fgmat ] ) . this allows to compute the error on any function of the parton distributions but only at a given kinematic point .",
    "it is , for instance , not possible to evaluate the errors on ( convolution ) integrals since the information on the correlation between different kinematic points is lost .",
    "notice that the errors from  @xcite are defined by the hessian method described in section  [ se : calculatechi ] .",
    "the epdflib  set  @xcite based on the qcd analysis of  @xcite gives the covariance matrix of the fitted parameters ( from the offset method described in section  [ se : offsetmethod ] ) and , as functions of @xmath77 and @xmath90 , the parton densities as well as their derivatives to all the fitted parameters . from this information the error on any function of the parton densities can be calculated with  ( [ eq : fgmat ] ) . as an example",
    "let us consider a hadron - hadron cross section which can be written as a convolution of the parton densities and a hard scattering cross section , generically , @xmath91 to calculate the error on @xmath92 with ( [ eq : fgmat ] ) it is sufficient to compute the derivatives @xmath93",
    "\\otimes \\hat{{\\sigma}}_{ij}\\ ] ] which is straight forward since both @xmath94 and the derivatives are available from epdflib .",
    "a practical example of the use of epdflib  in an analysis of dijet production at hera can be found in  @xcite .    in figure",
    "[ fig : errorbands ] we show the parton densities from epdflib  ( left hand plot ) and the relative error contributions to the gluon and singlet quark densities ( right hand plot ) .",
    "left : the parton momentum densities from the qcd analysis of  @xcite versus @xmath77 at @xmath95  gev@xmath96 .",
    "right : the errors on the gluon and quark densities from the various sources described in the text .",
    "figures taken from  @xcite . ]    the epdflib  set provides , in addition to the experimental statistical and systematic errors , information on the following sources of uncertainty :    * uncertainties due to those on the input parameters of the analysis like @xmath0 , heavy flavour thresholds , nuclear effects and so on .",
    "parton densities are provided with each of these input parameters offset by their errors .",
    "these densities can be used to either define an error band or to obtain , by interpolation , densities with varying input conditions ; * analysis error defined as the envelope of the central fit and 10 alternative fits ( vary cuts , input scale etc . ) which all gave acceptable values of @xmath18 .",
    "this error band quantifies the stability of the qcd fit ; * parton densities obtained from fits where the renormalisation and factorisation scales were independently varied in the range @xmath97 .",
    "again , these densities can be used to define an error band or be interpolated to obtain the distributions for a particular choice of scale .",
    "a simple but important check is provided by the calculation of the uncertainty on the total momentum fraction carried by quarks and gluons .",
    "this error should vanish because the momentum sum was constrained to unity in the analysis of  @xcite .",
    "indeed we find with epdflib  for the values and errors of these momentum fractions at @xmath98  gev@xmath96 @xmath99 where the error on the last integral is much smaller than that on the first two , as it should be .",
    "this example clearly illustrates the importance of taking into account the correlations between the errors on the parton densities .",
    "in this report we have presented an overview of the least squares minimisation and error propagation techniques used in many recent global qcd fits .",
    "the aim of these global analyses is to determine from a large and diverse body of scattering data the parton density distributions as well as their errors and correlations .    assuming that the measurement errors are gaussian distributed the likelihood function can be written as a multivariate gaussian distribution .",
    "this leads to a @xmath18 definition which can have different , but mathematically equivalent representations .",
    "in particular it turns out that a fit using the full covariance matrix of the data is equivalent to a fit where the systematic correlations are included in the model prediction together with the introduction of a set of free systematic parameters .",
    "error propagation based on shifting the data by the systematic errors and adding the deviations in quadrature is _ not _ equivalent to the method described above and leads to theory predictions which are as close as possible to the fitted data at the expense of larger error estimates , in particular when the systematic uncertainties dominate .",
    "several technical issues are addressed such as the numerical accuracy of the calculation of the hessian matrix , the lagrange multiplier method to explore the multi - dimensional @xmath18 profile in some physically relevant direction and the representation of the global qcd fit results in publically available parton distribution sets which contain the full information on errors and correlations .",
    "i am grateful to d.  stump for providing me with mathematical proofs of the equivalence of several @xmath18 representations and to s.  alekhin , j.  pumplin , w.k .",
    "tung and a.  vogt for discussions and comments on the manuscript .",
    "i thank the organisers for inviting me to an excellent and stimulating workshop .",
    "99 giele w t and keller s 1998 _ phys .  rev . _ * d58 * 094023 ( hep - ph/9803393 ) dagostini g 1994 _ nucl .",
    "meth . _ * a346 * 306 takeuchi t 1996 prog .",
    ". suppl . * 123 * 247 ( hep - ph/9603415 ) pumplin j _ et al _ 2001 _ preprint _ hep - ph/0101032 james f and roos m 1975 _ comput .  phys .",
    "* 10 * 343 pumplin j _ et al _ 2000 _ preprint _ hep - ph/0008191 nmc arneodo m _",
    "et al _ 1997 _ nucl .",
    "_ * b483 * 3 ( hep - ph/9610231 ) stump d _ et al _ 2001 _ preprint _ hep - ph/0101051 alekhin s i 2001 _ phys .  rev . _ * d63 * 094022 ( hep - ph/0011002 ) h1 collab .",
    "adloff c _ et al _ 2001 _ eur .",
    "j. _ * c21 * 33 ( hep - ex/0012053 ) pascaud c and zomer f 1995 _ preprint _ lal-95 - 05 botje m 2000 _ eur .",
    "j. _ * c14 * 285 ( hep - ph/9912439 ) alekhin s i 2000 _ preprint _ hep - ex/0005042 nagano k 2001 presented at dis2001 , bologna , italy , april  27may  1 2001 collins j c and pumplin j 2001 _ preprint _ hep - ph/0105207 bukhvostov a p 1997 _ preprint _ hep - ph/9705387 botje m 1999 _ preprint _ nikhef-99 - 034 zeus collab .",
    "breitweg j _ et al _ 2001 _ phys .",
    "lett . _ * b507 * 70 ( hep - ex/0102042 )"
  ],
  "abstract_text": [
    "<S> error estimates on parton density distributions are presently based on the traditional method of least squares minimisation and linear error propagation in global qcd fits . </S>",
    "<S> we review the underlying assumptions and the various mathematical representations of the method and address some technical issues encountered in such a global analysis . </S>",
    "<S> parton distribution sets which contain error information are described .     </S>"
  ]
}