{
  "article_text": [
    "the representation of an integer number @xmath3 and its decomposition into prime factors are basic mathematical operations .",
    "quantum mechanics offers a new perspective on these tasks , as well known since the seminal work of peter shor @xcite on the efficient factorization of large numbers , with a drastic impact on the security of codes .",
    "but even the counting of small numbers and their factorization may prove useful , e.g. , in the manipulation of physical number states ( and superpositions thereof ) or in the entanglement of flying qubits @xcite .",
    "a quantum algorithm to count @xmath4 particles propagating in a wire using an array of qubits ( a @xmath2-qubit register ) has been proposed recently @xcite ; a very similar scheme has been proposed by dhelon and milburn @xcite in order to find the number state distribution of a vibrational excitation in a system of trapped laser - cooled ions . besides providing the number @xmath3 in a binary form ( base 2 counting ) , a simplified version of this algorithm tests for the divisibility of @xmath3 by @xmath5 for a given @xmath6 and thus provides the power of 2 in the factorization of @xmath3 . in the present article",
    ", we generalize this algorithm to perform a base @xmath0 counting and a test for the factor @xmath7 in the decomposition of @xmath3 .    in order to accomplish this goal , we make use of a minimal formulation of the counting task in terms of the problem of distinguishing between different known quantum states in a single - shot measurement .",
    "this reduction to a few very basic elements naturally connects the counting task with the quantum fourier transformation and provides us with a constructive scheme for the setup of a ( non - demolition ) quantum counting algorithm .",
    "we study various possible ( hardware ) implementations of this algorithm , paying special attention to the case of a ternary ( base 3 ) counting system involving qutrits as elementary counting devices .",
    "we establish the relation between our quantum counting algorithm and the phase estimation algorithm and discuss several applications",
    ".     schematic representation of the quantum counting algorithm ( shown is the case of base - two counting with qubits ) .",
    "a particle number state @xmath8 is fed into a quantum wire to undergo quantum counting .",
    "the interaction between the charged particles and the qubits rotates the spin / qubit states , thereby generating the fourier transformation @xmath9 taking the initial state @xmath10 into the state @xmath11 . a suitable manipulation and readout either provides the number state @xmath12 ( this is an inverse quantum fourier transformation with a subsequent single shot measurement in the computational basis or a semi - classical quantum fourier transformation involving a sequential measurement ) or the maximal factor @xmath13 in @xmath3 ( this readout involves ` qubit - rotations ' followed by a single shot measurement).,width=302 ]    our counting algorithm is inspired by the problem of counting in mesoscopic systems@xcite and in quantum optics@xcite .",
    "a straightforward setup counting particles in a non - invasive manner requires of the order of @xmath14 individual counting elements , see below .",
    "a more sophisticated setup providing a unary counting scheme reduces this effort to an order-@xmath15 process , and a drastic further reduction to a @xmath16 scaling can be achieved when going over to a counting base @xmath0 .    the base-2 algorithm proposed in ref .",
    "involves two steps , a first ( analog ) one where a finite train of @xmath3 charged particles traversing a quantum wire , see fig .",
    "[ fig : counting ] , is coupled to an array of @xmath2 nearby qubits , thereby rotating the states of the qubits in a prescribed manner . in more abstract terms",
    ", this step corresponds to reading a number state @xmath17 in the hilbert space of number states of particles into a state @xmath18 of a @xmath2-qubit register in the hilbert space @xmath19 of the @xmath2 qubits .",
    "more generally , a superposition of number states gets entangled with the @xmath2-qubit register ( not copied , as demanded by the no - cloning theorem ) during the counting process . in a second step , the qubit state in @xmath19",
    "is manipulated and read out , providing either the maximal power of 2 contained in @xmath3 or the number @xmath3 in binary form , depending on the readout algorithm .",
    "the two steps correspond to two quantum fourier transformations of special kind : expressed in the usual ( cf .  ref .  )",
    "computational basis @xmath20 of the @xmath2-qubit register , the passage of the @xmath3 particles in the quantum wire transforms the initial state @xmath21 i.e. , the lowest fourier harmonic of the @xmath2-qubit register , into the @xmath3-th harmonic @xmath22 the quantum fourier transform of the state latexmath:[$|n\\rangle_{\\scriptscriptstyle q } =    @xmath3 is written in binary form , @xmath24 , cf .  ref .  .",
    "depending on the desired information ( precise counting or divisibility ) and the available hardware ( an operating quantum computer or a set of qubits ) , the readout of the qubit register can be done in various ways .",
    "the most efficient version for this second step of the algorithm is the application of a second ( inverse ) quantum fourier transformation @xmath25 on the qubit state @xmath11 , taking it back into the state @xmath12 .",
    "a simultaneous measurement of the @xmath2 qubits then provides the particle number @xmath3 in binary form ; in case of a superposition of particle number states , the measurement will execute a projection onto one of them .",
    "alternatively , the number state may be used in a further computation .    however , performing an inverse quantum fourier transformation on the state @xmath11 requires a quantum computer ( or at least those qubit operations required in the execution of a quantum fourier transformation ) .",
    "instead , we can make use of a procedure which is basically identical to the semi - classical fourier transform suggested by griffiths and niu @xcite , a conditional measurement algorithm involving a sequential readout , where the reading of the @xmath26-th qubit depends on the results of the previous @xmath27 measurements .",
    "this measurement still provides the full information on a pure number state ; if the initial state is a superposition of number states , the semi - classical algorithm will project the state ( upon sequential measurements of the qubits ) to one of its components .",
    "a specially efficient readout is available if we are interested in the power of 2 contained in @xmath3 rather than @xmath3 itself . in this case ,",
    "a simultaneous ( rather then conditional ) readout algorithm can be applied directly to the state @xmath11 ; this algorithm then provides a divisibility check of @xmath3 by @xmath5 , @xmath28 .    the present article deals with the generalization of this algorithm .",
    "the most obvious task to generalize is the determination of other powers of primes in @xmath3 , i.e. , to find the factorization of @xmath3 , @xmath29 .",
    "this can be achieved by going over to generalized qubits , three - level systems or qutrits , @xmath0-level systems or qudits , etc .",
    "equivalently , this corresponds to changing the representation of the number @xmath3 from binary ( base 2 ) to ternary ( base 3 ) , quinary ( base 5 ) , etc .",
    "again , the two - step algorithm first transfers the information from the physical number state @xmath8 into the computational @xmath2-qudit register ( @xmath30 ) through a particle - qudit interaction and then extracts the information in the qudit register via an inverse fourier transform ( @xmath31 ) .",
    "this readout step involves a full quantum transform on the level of each single qudit , while a semi - classical transform @xcite suffices to extract the information on the level of the @xmath2-qudit register .    in order to carry out the above program ,",
    "it is very helpful to have an abstract understanding of the counting process .",
    "indeed , a minimal abstract formulation of quantum counting in an @xmath15-dimensional hilbert space ( allowing to distinguish or count at most @xmath15 objects ) naturally leads us to two types of basis states , the computational basis ( corresponding to the states @xmath12 ) , in which the result of the counting process is measured , and the counting basis @xmath32 where the actual counting process is done  it turns out that just these two basis - sets are naturally related by the quantum fourier transformation , @xmath33 .",
    "furthermore , the abstract analysis of the counting process provides us with a recipe how the algorithm can be physically implemented .    in the following , we compare the efficiency of various quantum counting algorithms ( sec .",
    "[ sec : efficiency ] ) and then briefly repeat our previous base 2 quantum algorithm with qubits , including the sequential and single - shot readout schemes , see section [ sec : qubits ] .",
    "we then present in sec.[sec : fourier ] our basic analysis of the quantum counting process , providing a natural link between quantum counting and the quantum fourier transformation as well as a constructive scheme helping us to generalize counting to a base @xmath0 system .",
    "we then proceed with the simplest generalization to qutrits in section [ sec : qutrits ] , the problem of counting in a base-3 representation or power counting of 3 , and discuss its further generalization to qudits .",
    "to be specific , we consider an implementation with a three - level system in the form of three quantum dots and also discuss various ideas for other hardware implementations of the base-3 algorithm in section [ sec : implementations ] , a spin-1 system , serving rather as a gedanken experiment for illustration , and two practical versions of emulating a qutrit with qubits . in sec .",
    "[ sec : pea ] , we discuss an interesting correspondence between our counting algorithm and the phase estimation algorithm @xcite ( no such correspondence is yet known for our divisibility check ) and apply this insight in the proposal for a quantum voltage - detector ( an analog - digital converter ) .",
    "another application , a scheme to create multi - particle entangled states in a mach - zehnder interferometer , is discussed in sec .  [ sec : mpentanglement ] . we summarize and conclude in sec .",
    "[ sec : conclusion ] .",
    "in a broader context , the efficiency of our quantum counting algorithm has to be compared with other schemes .",
    "e.g. , the most straightforward non - invasive way of counting the number of ( charged ) particles flowing in a wire ( directed along @xmath34 ) is to use a spin - counter polarized in the @xmath35-plane and rotating the state by an incremental angle @xmath36 ( around the @xmath37-axis ) upon passage of a particle @xcite .",
    "this spin rotation is achieved through the magnetic field pulse generated by the passing charge @xcite ; see also refs .   for a related experiment in a quantum optical setup .",
    "the precise correspondence of the angle with the number of passed particles then requires an accurate measurement , to a precision of @xmath36 , of the spin - counter s final state polarization  this either necessitates a large number @xmath38 of repetitions of the counting experiment , or a single - shot readout of @xmath39 identical counters all measuring the passage of the particles : measuring the spin along the @xmath40-axis , the ( theoretical ) probability to find it pointing upwards is given by @xmath41 , where @xmath42 denotes the average of finding @xmath43 of the @xmath39 spins pointing up in a sequence of @xmath44 realizations of the entire experiment .",
    "on the other hand , the one - time measurement @xmath45 provides the experimental result @xmath46 , from which we can find the number @xmath47 $ ] . as",
    "this procedure is a statistical one , we have to determine how many spins ( measurements ) @xmath39 are needed to predict the particle number @xmath3 with certainty .",
    "we then require that the difference in probability ( we assume @xmath48 ) @xmath49^{1/2 } \\equiv [ \\langle ( m^\\uparrow-\\langle m^\\uparrow\\rangle_k)^2\\rangle_k]^{1/2}$ ] in the measurement , @xmath50^{1/2}/m$ ] . given the binomial statistics of the measurement process [ the values @xmath51 and @xmath52 are measured with probabilities @xmath53 and @xmath54",
    ", we obtain @xmath55 and combining these results , we find that @xmath56 spins are needed in order to accurately measure the particle number @xmath57 .",
    "we first provide a more detailed discussion of the base-2 counting algorithm with the setup in fig .  [",
    "fig : counting ] , where the @xmath58 particles to be counted flow in a quantum wire along @xmath34 .",
    "single electron pulses can be generated by appropriate voltage pulses @xcite or through injection from a quantum dot @xcite and the counters are conveniently thought of as individual spins , cf .",
    "we use spin states polarized along the @xmath37-axis as our computational basis , @xmath59 and @xmath60 .",
    "_ preparation _ : initially , the @xmath2 spins or qubits ( we use these terms synonymously , cf .  ref .  ) are polarized along the positive @xmath40-axis , i.e. , the initial states read @xmath61/\\sqrt{2}$ ] , @xmath62 . identifying @xmath63 and @xmath64 , the product state @xmath65 $ ]",
    "is identical with the equally weighted sum of @xmath2-qubit register states @xmath66 , @xmath67 into the state @xmath68 with @xmath69 the initial state @xmath70 of the counting setup then is given by @xmath71 and hence @xmath72 .",
    "_ counting and fourier transformation _ : assuming a transverse coupling between the charged particle and the spin , the passage of a particle rotates the spins in the @xmath34-@xmath40 plane .",
    "the couplings of the spin counters to the wire are chosen such that the @xmath26-th spin is rotated ( anti - clockwise ) by the amount @xmath73 ( a rotation by @xmath74 with @xmath75 a pauli matrix ) .",
    "the passage of @xmath3 particles then rotates the @xmath26-th spin by the amount @xmath76 and thus it ends up in the state @xmath77 /\\sqrt{2}$ ] , where we have dropped the overall phase @xmath78 .",
    "again , we identify latexmath:[$|\\!\\uparrow\\rangle_j \\leftrightarrow    @xmath64 and use the binary representation of integers @xmath80 to rewrite the product @xmath81 $ ] over qubit states as a sum over register states , @xmath82 from the comparison with the fourier transform eqs .",
    "( [ eq : y ] ) and ( [ eq : yx ] ) we find that @xmath83 , and hence the passage of the @xmath3 particles ( the counting process ) takes the state @xmath84 into the @xmath3-th harmonic @xmath11 .",
    "we call the states @xmath12 the computational basis and the transforms @xmath85 define the counting basis .",
    "the fact that the qubits in the @xmath2-qubit register reside in a product state and hence remain unentangled @xcite is a crucial element of our algorithm and in fact decisive for the next step , the readout of the result with the help of a semi - classical quantum fourier ( back ) transformation .",
    "particles by @xmath86 qubits .",
    "after passage of the particles , the initial state with all spins pointing along the @xmath40-axis and corresponding to the lowest fourier harmonic is transformed to the final state , the @xmath3-th fourier harmonic with properly rotated spins .",
    "the indivdiual counter qubits are then measured ( m ) and the binary digits @xmath87 , @xmath88 are determined in reverse order . after each measurement ,",
    "the remaining qubits are rotated ( r ) to undo the counting of the corresponding moduli : following the measurement of the first qubit , the rotations by the last ( odd numbered ) particle are undone .",
    "after measurement of the second qubit the rotation by the last odd - numbered pair is undone.,width=264 ]    _ readout and inverse fourier transformation _ : let us then turn to the second step , the semi - classical quantum fourier ( back ) transformation which provides us with the desired result , the binary representation of @xmath3 .",
    "we start with the measurement of the first spin : since this has been rotated by the angle @xmath89 , we measure it along the @xmath40-axis . if we find it pointing upward , the number s parity is even and we store a ` 0 ' in the first position @xmath90 of the binary number ; in case we find it pointing downward , the parity is odd and we store the digit ` 1 ' .",
    "besides providing the number s first binary digit , the parity , the outcome of the measurement also tells us whether the second spin ( rotated by @xmath91 ) is directed along the @xmath40-axis ( even parity ) or along the @xmath34-axis .",
    "this information allows us to measure the second spin along the correct axis ; for an even @xmath3 , we measure the spin along the @xmath40-axis ( and store a 0 ( 1 ) in @xmath92 if the spin is pointing up ( down ) ) , while for an odd - parity @xmath3 , we measure the spin along the @xmath93-axis .",
    "the iteration of the readout algorithm is straightforward : the @xmath26-th spin is measured along the direction @xmath94 with the integer @xmath95 corresponding to the binary number encoded in the @xmath27 previous measurements . the @xmath26-th position in the binary register then assumes a value @xmath96 or @xmath97 , depending on the measurement result , 0 for a spin pointing along the axis and 1 for a spin pointing opposite .",
    "this sequential measurement algorithm provides us with the binary representation of @xmath3 .    in order to render the algorithm more efficient , rather than rotating the axis of measurement ,",
    "the spins are rotated backwards by the corresponding angles .",
    "these rotations by @xmath98 are conveniently done incrementally : after measurement of the @xmath26-th spin with outcome ` 0 ' or ` 1 ' , all spins @xmath99 are rotated by @xmath100 .",
    "these rotations undo the action of odd - numbered groups of particles : the first rotation by @xmath101 acting on the qubits @xmath102 compensates for the last odd - numbered particle . the second rotation by @xmath103 acting on the qubits @xmath104 compensates for the last odd - numbered pair . the third rotation by @xmath105 acting on the qubits @xmath106 compensates for the last odd - numbered quartet , etc",
    "these rotations make the next spin to be measured point up or down , since the action of those particles giving an intermediate result has been subtracted .",
    "the entire algorithm is illustrated in fig.[fig : rotation ] for the case of @xmath107 particles counted by @xmath86 qubits .",
    "formally , the availability of a sequential readout algorithm can be derived from a suitable representation of the product state eq .",
    "( [ eq : qftps ] ) : the fraction @xmath108 in the phase @xmath109 of the @xmath26-th qubit has to be known only modulo 1 and making use of the relation @xmath110 the @xmath26-th qubit state can be written in the form @xmath111/\\sqrt{2}$ ] , where we make use of the binary representation of fractions @xmath112 , see ref .  . the final state after passage of the particles",
    "can then be written in the form @xmath113 this representation demonstrates that the state of the first qubit @xmath114 involves only the smallest digit @xmath90 of the seeked number @xmath3 , the second one involves the fraction @xmath115 , and so on .",
    "hence each qubit state requires knowledge of the states of previous qubits and its measurement adds one digit more to the binary representation of @xmath3 .",
    "_ divisibility by @xmath5 _ : a variant of the above counting algorithm provides a test for the divisibility of @xmath3 by powers of two .",
    "consider the state of the first @xmath116 spins after the passage of @xmath3 particles .",
    "if the number @xmath3 contains the factor @xmath5 , then the @xmath117 qubits will all point along the positive @xmath40-axis ( and , for @xmath28 , the @xmath118-th qubit will point down ; alternatively , if @xmath119 then all spins in the register have returned to their initial state pointing along @xmath40 ) .",
    "a single - shot measurement of the @xmath2-qubit register along the @xmath40-axis thus provides the ( maximal ) factor @xmath5 in @xmath3 .",
    "the formal proof of this statement is given in ref .  .",
    "we now reduce the problem of quantum counting to the task of distinguishing between quantum states .",
    "this reduction will quite naturally lead us to the definition of two basis sets , one serving the counting process itself by admitting a simple manipulation of phases during the counting step ( the computational basis ) and the other keeping track of the counting ( counting basis ) ; the two are related by the operation of quantum fourier transformation .",
    "we start from the premise that quantum counting corresponds to the process of associating distinct states of an auxiliary quantum system ( the counter ) to the size ( cardinality ) of a physical state .",
    "we assume that we want to count at most @xmath15 objects , hence our auxiliary quantum system shall count the objects modulo @xmath15 . during the counting process , the initial state @xmath120 of the counter is , upon passage of @xmath3 objects , transformed to the final state @xmath121 ( we can safely drop the index @xmath122 in this section ) .",
    "we define the unitary operation @xmath123 to describe the passage of one particle , @xmath124 and a simple iteration produces the state @xmath125 upon passage of @xmath3 particles .",
    "we now require that we can distinguish between the states @xmath121 and @xmath120 in a single - shot measurement , implying that the states should be orthogonal , @xmath126 .",
    "so far , we only require that we can distinguish between ` no particles ' associated with the state @xmath120 and a state with ` some particles @xmath3 ' with @xmath127 and associated with the state @xmath121 , without being able to decide between different number states with different @xmath3 s .",
    "it turns out that a setup solving this reduced task is also able to distinguish between the different particle number states @xmath121 . indeed , using eq .",
    "( [ eq : cj ] ) and the fact that @xmath126 for all @xmath128 , we find that ( we choose @xmath129 ) @xmath130 and hence the states @xmath121 are all orthogonal and distinguishable .",
    "finally , our wish to count modulo @xmath15 requires cyclicity , i.e. , @xmath131 if the dimension of our auxiliary counter system is given by @xmath15 , then the cyclicity eq .",
    "( [ eq : cyclicity ] ) follows automatically : applying @xmath132 iteratively to the counting states @xmath121 , one finds that all states @xmath133 are orthogonal to the previous states @xmath134 , @xmath135 , @xmath136 .",
    "once we arrive at @xmath137 , the last state completing the hilbert space , the further application of @xmath132 produces a state @xmath138 which has to be a superposition of the previous states , @xmath139 . however , since all matrix elements @xmath140 vanish for @xmath141 , we must have @xmath142 and since @xmath123 is unitary , we arrive at the result eq.([eq : cyclicity ] ) . otherwise , for a larger dimensionality of the auxiliary system , the condition eq .",
    "( [ eq : cyclicity ] ) has to be imposed as a separate requirement .    in the end ,",
    "the ( minimal ) auxiliary counter system is described by an @xmath15-dimensional hilbert space @xmath143 with orthonormal counting basis @xmath144 , @xmath145 and @xmath146 , and a unitary ( shift or counting ) operator @xmath123 taking one counting state to the next , @xmath147 . in a specific physical implementation , the phase @xmath148 is determined by the dynamical evolution of the system during counting .",
    "the states @xmath121 keep track of the numbers in the counting process , i.e. , due to their orthogonality they uniquely identify the cardinality of the counted set .    in order to further characterize the properties of our auxiliary counting system , we determine the eigenvalues and eigenvectors of the counting operator @xmath123 . expressed in the basis @xmath149 , the latter assumes the form @xmath150 its eigenvalues and eigenvectors are easily found : the determinant of @xmath151 is given by @xmath152 and hence the eigenvalues of @xmath123 are the @xmath15 roots of 1 on the unit circle in the complex plane shifted by @xmath153 , @xmath154 , @xmath155 . the associated eigenvector @xmath156 is given by @xmath157 . note that a phase @xmath158 simply renumbers the eigenvectors and eigenvalues by @xmath159 .",
    "the eigenstates @xmath156 of the counting operator @xmath123 show a particularly simple behavior in the counting process ",
    "they merely pick up a phase , and these phases are distributed homogeneously over the unit circle . hence , expressing the ( unknown ) counting states @xmath121 through the eigenstates @xmath156 of the counting operator @xmath123 , we obtain @xmath160 making use of the eigenstates @xmath156 , the counting step can be implemented in an extremely simple and minimally invasive manner : upon passage of a particle , each state @xmath156 shall pick up the additional phase @xmath161 $ ] and @xmath121 goes over to @xmath162 , which is just the action of @xmath123 or of counting . hence ,",
    "if we choose as our computational basis the set of orthonormal eigenstates latexmath:[$\\ {    @xmath123 , then the counting process can be implemented in a ` soft ' way , adding only phases to the computational states ( note that these are the states in which our final projective measurement will be done ) . at the same time",
    ", the counting basis , which is interconnected by the shift operator @xmath123 , is made from the states @xmath164 , which is nothing but the quantum fourier transform ( up to a phase ) of the eigenstates @xmath165 . in the further general discussion below we set @xmath166 ; the required transformation eliminating a finite @xmath148 will be discussed later .",
    "sketch for a real space counter in the form of a 3-level qutrit operating in the amplitude mode ; the interaction between the counter particle and the particle in the quantum wire is assumed to be attractive ( a slightly modified version can be found for a repulsive interaction ) .",
    "subsequent lowering of the barriers separating the quasi - classical states @xmath167 , @xmath168 , and @xmath169 upon passage of a particle moves the counter particle to the left , cf . ( a )",
    "@xmath170 ( b ) @xmath170 ( c ) .",
    "the third particle passing drags the counter particle all the way back to the initial state , cf .",
    "( d).,width=302 ]    at this point one may ask if there are other counting algorithms which do not exploit the quantum fourier transformation ",
    "the answer is yes , but such alternative schemes do not provide the ` soft ' counting involving only the addition of phases . as an example , consider the setup shown in fig.[fig : real_space_counter ] , a multi - well system ( one counter particle in a @xmath0-well potential landscape ) operating in the amplitude mode . assuming an attractive interaction @xcite , the passing particle lowers or removes the barrier between adjacent semi - classical states , allowing the counter particle to move between two wells . here",
    ", the semi - classical states localized in the individual wells play the role of the counting states @xmath121 : initializing the counter in the ( right - most ) state @xmath120 , cf .  fig .",
    "[ fig : real_space_counter ] , the first @xmath171 particles passing will push the counter particle to the left in steps of one , @xmath172 , while the @xmath0-th particle will drag the counter particle back to the right until it ends up in the initial state @xmath120 .",
    "the difference of this device with the ` soft ' counting device discussed above is in the choice of the computational basis : rather than selecting the fourier transformed states of @xmath121 , which are eigenstates of the shift operator @xmath123 and only pick up phases during the counting process , here we choose as a computational basis the counting basis itself , hence , @xmath173 . as a result , rather than adding phases during counting , we shift the counter particle in real space .",
    "obviouly , this setup is difficult to realize as quite some fine tuning is required to generate a clean shift operation ; furthermore , the shift operation in real space will generate an appreciable back action on the passing particles .",
    "on the other hand , such a counter is not supposed to evolve coherently between counting steps , hence the requirements on the coherence time are reduced .",
    "in abstract terms , the counting process can be illustrated through the counting states @xmath121 arranged in a circle with the shift operator @xmath123 transforming one state to the next .",
    "the goal then is to have for the fourier transformed basis states @xmath156 a set of ( measureable ) states which merely pick up phases when interacting with the passing particles ; these states then shall form our computational states . in this basis , the counting process ( the shift operator @xmath123 ) transforms one fourier mode into the next , cf",
    ".  fig .",
    "[ fig : circle](a ) .     ( a ) counting device for @xmath174 ( corresponding to a qudit with @xmath175 ) .",
    "the ( semi - classical ) states @xmath156 , @xmath176 , form the computational basis ; their fourier transforms @xmath121 define the counting basis . in the elementary counting step ,",
    "the shift operator @xmath123 transforms one fourier mode @xmath121 into the next @xmath133 .",
    "( b ) emulation of the @xmath174 qudit through three qubits , implementing quantum counting with @xmath177 and @xmath86 ( left ) and corresponding classical abacus ( right).,width=226 ]    so far , the abstract computational states @xmath165 have been chosen in a trivial way , without any additional structure ; correspondingly , our counting process is still a simple ( and inefficient ) one , requiring as many different states as we have objects to count .",
    "the great reduction in the ( hardware ) complexity of the counting process appears with the introduction of a counting base . introducing a counting base @xmath0 ( @xmath178 for binary ( ternary ) counting )",
    ", we have @xmath179 and can reduce the hardware requirement from @xmath15 to @xmath180 ; correspondingly , the efficiency of the algorithm increases dramatically from a linear in @xmath15 complexity to @xmath181 . to illustrate the case",
    ", we consider a simple example @xmath174 , @xmath177 , and @xmath86 , counting up to 8 with the help of 3 qubits .",
    "the primitive version involves a loop with 8 states @xmath182 .",
    "this can be reduced to three loops with two states each , @xmath183 , @xmath184 , cf .",
    "fig.[fig : circle ] .",
    "the preparation of the large loop generates the state @xmath185 , the properly prepared reduced system is in the state @xmath186/\\sqrt{2}$ ] .",
    "the counting step on the large loop adds the phase @xmath187 , @xmath188 , to the state @xmath156 in @xmath189 . on the other hand",
    ", the counting step on the small loops adds sequentially smaller phases : @xmath190 , @xmath191 , @xmath192 , @xmath193 .",
    "one easily checks that the state @xmath194\\otimes[|0\\rangle_2 + |1\\rangle_2 ]     \\otimes [ |0\\rangle_3 + |1\\rangle_3]}{\\sqrt{8}}\\\\        \\label{eq : psi_aba2 }        & = & [ |000\\rangle + |001\\rangle + |010\\rangle + |011\\rangle \\\\",
    "\\nonumber        & + & |100\\rangle + |101\\rangle + |110\\rangle + |111\\rangle]/\\sqrt{8}\\end{aligned}\\ ] ] ( the three entries refer to the qubits 1 , 2 , and 3 , e.g. , @xmath195/\\sqrt{8}\\end{aligned}\\ ] ] upon passage of one particle ; this is identical to @xmath196 upon identifying the state @xmath156 with its binary equivalent @xmath197 .",
    "hence , the complexity of the hardware used in the counting task is easily reduced by going over to a counting base ; in our case , rather than implementing an 8-level system , the same counting task can be accomplished with the help of 3 qubits .",
    "this step in reduction of complexity is nothing but going over to a ( quantum ) abacus , cf .",
    "[ fig : circle](b ) .",
    "its physical implementation involves qudits ( playing the role of the rows in the classical abacus ) ; performing one cycle in the @xmath26-th qudit shifts the state of the next qudit by one unit .    the insight provided by the ` soft counting procedure ' and the reduction in hardware provided by choosing a counting base ( base @xmath198 ) described above gives us a recipe how to construct a physical implementation of the counting process :",
    "define a quantum mechanical system with @xmath199 orthogonal states @xmath156 , @xmath200 , with an identical ( trivial ) time evolution ; these states form our computational basis and often appear in the form of semi - classical ( measureable ) states .",
    "the non - trivial time evolution of these states originates from their interaction with the particles during their passage .",
    "the coupling of the states to the particles has to be arranged in a way such that the state @xmath156 picks up a phase @xmath201 upon passage of one particle . defining the interaction hamiltonian @xmath202",
    ", this implies an equidistant distribution of the matrix elements @xmath203 ; assuming that all levels interact with the particles during equal time intervals @xmath204 , we can conclude that the spectrum of @xmath202 is equidistant .",
    "furthermore , returning back to the cyclic phase @xmath148 in the counting operator @xmath123 , we can compensate for a finite value via an energy shift in the interaction hamiltonian @xmath202 : adding a constant energy @xmath205 to @xmath202 , we redefine the counting operator operator @xmath206 and the counting basis @xmath207 , @xmath208 , and find that the new condition for the cyclicity reads latexmath:[$|\\tilde\\psi_n\\rangle = \\tilde{\\mathsf{c}}_1| \\tilde\\psi_{n-1}\\rangle = e^{-i\\theta}|\\psi_{n}\\rangle = e^{-i\\theta } e^{i\\theta}|\\psi_0\\rangle =      equidistant spectrum for the hamilonian @xmath202 describing @xmath86 qubits.,width=188 ]    as a specific example , we can examine the situation for the base 2 counting in sec .",
    "[ sec : qubits ] ; here , the hamiltonian ( more precisely , the logarithm of the shift operator , @xmath210 ) describing one count can be written in the form @xmath211 where the pauli matrix @xmath212 operates on the @xmath26-th qubit , resulting in the expected equidistant spectrum , cf .",
    "fig.[fig : spectrum ] . in this example , the energy zero is located in between 2 eigenstates and hence @xmath213 .",
    "shifting the zero - energy point to one of the eigenstates , we then can get rid of the cyclic phase @xmath148 ; e.g. , shifting the energy zero to the top - most level we identify the state @xmath214 with the computational state @xmath167 .",
    "as a first step towards the generalization to qutrits , we reformulate the base 2 counting algorithm in terms of manipulations of a particle in a double well potential with semi - classical ( computational ) states @xmath167 and @xmath168 , cf .  fig .",
    "[ fig : d_t_well](a ) , as directly realizable with a double - dot charge qubit @xcite .     lowering the barrier between the wells and changing the amplitude , or voltage pulses @xmath215 disbalancing the wells and changing the phase of the qubit s state ( and similar for qutrits).,width=226 ]    we assume the double - dot charge qubit to be aligned perpendicular to the wire , such that the two wells couple differently to the charge of the passing electrons , cf .  fig .",
    "[ fig : d_t_well](a ) .",
    "we work with the quasi - classical states @xmath216 and @xmath217 ( our computational basis ) and consider a ` phase mode operation ' of the counter , with a large barrier separating the quasi - classical states , resulting in an exponentially small tunneling amplitude @xmath218 , with @xmath219 the gap between the two true eigenstates .",
    "the qubit is manipulated by applying voltage pulses , either to lower the barrier between the two wells in order to change the amplitude ( rotation around the @xmath34-axis ; e.g. , opening a gap @xmath219 between the qubit eigenstates during the time @xmath220 moves the state @xmath167 to the state @xmath168 ) or to disbalance the two wells in order to change the phase ( rotation around the @xmath37-axis ; e.g. , lifting the right well by @xmath221 during the time @xmath222 adds a relative phase @xmath223 to the state @xmath168 ) .",
    "the algorithm involves three steps : to _ prepare _ the qubit , we start from the semi - classical state @xmath167 and apply the unitary ( amplitude - shift ) operator @xmath224 with the tunneling hamiltonian @xmath225 and the time @xmath226 to produce the balanced superposition @xmath227 , @xmath228 in a spin language this corresponds to a rotation around the @xmath34-axis by @xmath229 to produce the initial state @xmath230 .",
    "next , we let the particles pass the ( first ) counter qubit . upon _ passage of one particle _ , the semi - classical qubit states @xmath231 pick up a phase @xmath232 .",
    "the unitary operator @xmath233 $ ] then takes @xmath234 into @xmath235 ; the passage of a second particle brings the state @xmath236 back to @xmath120 , hence @xmath123 is cyclic , @xmath237 .",
    "this operation corresponds to the rotation of the spin by @xmath238 around the @xmath37-axis .",
    "the states @xmath239 and @xmath236 define the counting basis .    finally , we translate the _ measuring _ process . the application of the operator @xmath240 transforms @xmath120 back to @xmath167 and @xmath236 to @xmath168 ( up to a phase ) ; a simple check that the qubit is in the state @xmath167 tells , that the number @xmath3 of passed particles is even .",
    "the subsequent qubits @xmath241 are prepared in the same way . since it is the task of the qubits @xmath242 to detect the passage of groups of particles , these counters are more weakly coupled to the wire . in particular , the operator @xmath123 for the second qubit measures the passage of pairs , hence the phase added to the state @xmath168 is @xmath243 , and similar for the following qubits .",
    "regarding the final step of measurement , there are two variants : in order to extract the maximal factor of @xmath5 in @xmath3 , it is sufficient to apply the operation @xmath244 and then check , whether the counter resides in the state @xmath167 ; the first qubit residing in the state @xmath168 determines the power @xmath117 . on the other hand , if the goal is to find the cardinality @xmath3 , then before applying @xmath244 the qubits have to be properly prepared through a ` rotation around the @xmath37-axis ' ( rather then ` rotating the axis of measurement ' ) .",
    "these ` rotations ' are conveniently done incrementally and involve a phase shift of the quasi - classical state @xmath168 : after measurement of the @xmath26-th qubit with outcome ` 0 ' or ` 1 ' , the measured value is stored as the digit @xmath245 ( note the reversal in the sequence ) and all qubits @xmath99 are given a phase shift @xmath100 on the state @xmath168 .",
    "after application of @xmath244 , the qubit @xmath246 is measured .",
    "an interesting subtlety concerns the possible entanglement of the qubits with the passing particles during counting .",
    "the spin counter discussed in section [ sec : qubits ] is entirely unproblematic regarding this aspect , as the gauge interaction leaves the counted particle essentially unchanged . on the other hand ,",
    "a charge qubit acting as a counter can become strongly entangled with the counted particle : with the qubit charge in a quantum superposition , with 1/2 probability to be closeby the wire ( state @xmath247 ) and 1/2 probability to be further away @xmath248 , the particle passing by is first decelerated and then reaccelerated by the qubit charge .",
    "this process happens with different strengths depending on the qubit state . as a result ,",
    "the particle wave function may split after passing the qubit , with one part ( the fast one , @xmath249 ) moving ahead of the other ( the slow one , @xmath250 ) . the calculation of the probability @xmath251 to find the counter state pointing along the @xmath40-direction is given by the partial trace over the particle space ; if the two states @xmath249 and @xmath250 are distinguishable , @xmath252 , then @xmath253 independent of the phase @xmath254 picked up by the counter qubit .",
    "hence , it is crucial that the counter does not generate a wave function splitting when the particle passes by , i.e. , the counter only works properly if @xmath255 and the final state is essentially non - entangled . using the charge qubit as a measuring device ,",
    "the requirement of weak splitting boils down to the condition@xcite @xmath256 , where @xmath254 is the angle of the qubit rotation quantifying the qubit - particle interaction , @xmath257 is the fermi wave vector in the quantum wire , and @xmath258 is the width of the wave packet .    in a more quantitative analysis , we can consider the evolution of a ( lorentzian , cf .  ref .  )",
    "wave packet @xmath259 with fourier amplitudes @xmath260 \\theta ( k - k_{\\rm \\scriptscriptstyle f})$ ] subject to the scalar field of a charge qubit . for simplicity",
    ", we assume that the state @xmath167 acts with a potential @xmath261 on the wave function , while the state @xmath168 , which is further away from the wire , has no influence on the particle .",
    "furthermore , we choose the potential @xmath261 such that the qubit state is rotated by @xmath254 , i.e. , after the passage of the particle , the initial qubit state @xmath262 shall be rotated into the state @xmath263 . assuming a smooth potential @xmath261",
    ", we determine the asymptotic particle - qubit state within a semi - classical approximation and project the wave function onto the qubit state @xmath264 ; tracing over the particle degree of freedom , we find the probability @xmath265 to measure the qubit in the state @xmath264 and the second term provides the probability to observe a wrong result .",
    "note that the error probability involves the square of the small parameter @xmath266 .",
    "the base 3 counting with qutrits in the form of triple wells follows the same scheme as the base 2 counting with double - dot qubits described above .",
    "we start out with one qutrit counter , i.e. , @xmath267 , which initially resides in the state @xmath167 , cf .",
    "[ fig : d_t_well](b ) .",
    "first , the qutrit is _ prepared _ in a balanced state with equal weights in each of the three semi - classical ground states ( the phases may be chosen arbirarily ) .",
    "the ( amplitude - shift ) operators @xmath268 and @xmath269 performing this task generalize the operator @xmath268 above .",
    "the angle @xmath270 in the operator @xmath268 ( we write the matrices in the semi - classical basis ) , @xmath271\\\\            & = & \\left (            \\begin{array}{ccc }            \\cos\\chi_{10 } & i \\sin \\chi_{10 } & 0 \\\\            i \\sin \\chi_{10 } & \\cos\\chi_{10 } & 0 \\\\            0 & 0 & 1            \\end{array }            \\right),\\end{aligned}\\ ] ] is chosen such that 2/3 of the wave function is shifted to the state @xmath168 , hence @xmath272 .",
    "the matrix @xmath268 then assumes the form @xmath273 the operator @xmath269 transfers weight between states @xmath168 and @xmath169 , @xmath274 \\\\            & = & \\left (            \\begin{array}{ccc }            1 & 0 & 0\\\\            0 & \\cos\\chi_{21 } & i \\sin \\chi_{21 } \\\\",
    "0 & i \\sin \\chi_{21 } & \\cos \\chi_{21 }            \\end{array }            \\right).\\end{aligned}\\ ] ] its task is to take the state @xmath275 to the balanced state @xmath276 ( with approriate phases @xmath277 ) . choosing the time such that @xmath278 we obtain the operator @xmath279 and the balanced state @xmath280 we call the combination @xmath281 the preparation operator .",
    "the particular construction of the state @xmath120 does not produce the lowest fourier harmonic @xmath282/\\sqrt{3}$ ] ; if we insist to work with the canonical expression for the fourier transformation , we have to properly redefine the phases of the computational basis states , @xmath283 .",
    "otherwise , we can actually start our counting basis with any fourier harmonic of the computational basis or even with any other balanced state as it is produced in a convenient physical preparation step ( as we have done above ) . also note that our preparation operator @xmath284 is not acting as a fourier transformation on the other basis states but is a simpler operator that only transforms the state @xmath167 into a properly balanced state .",
    "next , we find the wave functions @xmath236 and @xmath285 after _ passage of 1 and 2 particles _ : upon passage of one particle , the semi - classical qutrit states @xmath231 pick up a phase @xmath286 .",
    "the unitary operator @xmath287\\ ] ] generates the additional counting states @xmath288 the further application of @xmath123 brings us back to @xmath120 , i.e. , @xmath123 is cyclic , @xmath289 ( i.e. , @xmath166 ) .",
    "it is easy to check that the set @xmath120 , @xmath236 , @xmath285 forms a new orthonormalized basis in the qutrit s hilbert space spanned by the semi - classical states @xmath167 , @xmath168 , @xmath169 .",
    "we come to the _ readout _ step .",
    "we define the inverse preparation operator @xmath290^{-1 } = \\mathsf{a}_{10}^\\dagger \\mathsf{a}_{21}^\\dagger$ ] ; using the explicit forms in eqs .",
    "( [ eq : qtrit_prep_10_ex ] ) and ( [ eq : qtrit_prep_21_ex ] ) we obtain the expression @xmath291 the application of @xmath292 takes the state @xmath120 back to @xmath167 , while @xmath293 are still superpositions of the semi - classical states @xmath168 and @xmath169 , @xmath294",
    "the _ divisibility test _ by 3 then involves the application of @xmath292 to the state @xmath295 obtained after passage of the @xmath3 particles and a measurement of the qutrit state ; if the qutrit resides in the state @xmath167 , then @xmath3 is divisible by 3 .",
    "finding the _ modulus of @xmath3 _ to the base 3 is slightly more involved .",
    "we have to rotate the states @xmath293 such as to recover the original states @xmath168 and @xmath169 of the computational basis . using the spin language in the two - dimensional space spanned by @xmath168 and @xmath169 ,",
    "this operation is achieved by a ` rotation ' by @xmath243 around the @xmath37-axis , followed by a rotation by @xmath229 around the @xmath34-axis .",
    "the former operation is executed by the phase operator @xmath296 , while the latter is noting but the operation @xmath269 .",
    "the combination @xmath297 then determines the modulus of @xmath3 , since @xmath298 depending on the outcome @xmath167 , @xmath168 , or @xmath169 after the measurement of the qutrit , the number @xmath3 is divisible by 3 modulo 0 , 1 , or 2 .",
    "the modulus can be found with a sequential measurement scheme : after application of @xmath292 and measurement of the state @xmath167 , the outcome tells that the modulus is 0 ( if the particle is found in state @xmath167 ) or 1 or 2 ( if the particle is not detected ) ; in the latter case the operator @xmath299 is applied and the measurement of well @xmath168 will provide the final result , with a modulus 1 if the particle is detected in state @xmath168 and a modulus 2 if it is not found ( then the particle resides in state @xmath169 ) .    in the above derivation , we have adopted those phases which naturally appear in the simplest manipulation of the three - well system  as a result , the matrix eq .",
    "( [ eq : qtrit_mod_3 ] ) is not the canonical ( inverse ) fourier transform .",
    "the following steps ( for the general case with @xmath15 counting states ) then relate the obtained matrix @xmath300 with the canonical form of @xmath301 .",
    "chosing phases @xmath302 in the definition of eigenstates @xmath156 of the counting operator @xmath123 , we interrelate the counting and computational bases through @xmath303 second , let us assume that our physical manipulations have produced a measurement operator @xmath300 such that @xmath304 then the measurement operator @xmath300 and the canonical inverse fourier transform @xmath301 are related via @xmath305 } \\mathrm{f}^{-1 }      \\mathsf{p}_{[\\alpha]}\\ ] ] with the unitary ( phase ) operators @xmath306 }                = \\left (                \\begin{array}{cccc }                e^{i\\chi_0 } & 0 & \\dots & 0\\\\                0 & e^{i\\chi_2 } & \\dots & 0\\\\                \\vdots & \\vdots & \\vdots & \\vdots\\\\                0 & 0 & \\dots & e^{i\\chi_{n-1 } }                \\end{array }                \\right)\\ ] ] with phases @xmath307 = [ \\alpha ] , [ \\beta]$ ] . for the particular situation of the qutrit ( @xmath308 ) ,",
    "the phases @xmath309 $ ] and @xmath310 $ ] are defined by the operators @xmath284 , eq .",
    "( [ eq : qtrit_psi_0 ] ) , and @xmath300 , eq.([eq : qtrit_mod_3 ] ) . using these phases in eq .",
    "( [ eq : m_pfp ] ) , one easily verifies that the expression eq .",
    "( [ eq : qtrit_mod_3 ] ) indeed corresponds to the inverse fourier transformation @xmath25 .",
    "the generalization of the algorithm to @xmath2-qutrit registers follows the same steps as above .",
    "we assume that all elements in the @xmath2-qutrit register initially reside in the state @xmath311 , i.e. , the state of the register encodes the state @xmath312 of the computational basis .",
    "the qutrits @xmath241 serve the counting of particle clusters : the qutrit @xmath26 counts groups of @xmath313 particles , hence the elementary phase shift in @xmath123 is @xmath314 .",
    "correspondingly , subsequent qutrits are each coupled to the wire a factor 3 less than the previous .",
    "let us go through the algorithm : the _ preparation _ of the @xmath26-th qutrit is identical to the first one . upon _ passage of a particle _",
    ", the semi - classical states @xmath231 in the @xmath26-th qutrit pick up phases @xmath315 .    the readout for the _ divisibility _ check involves the application of @xmath292 to all @xmath2 qutrits and subsequent test for the semi - classical state @xmath311 in each qutrit : if all qutrits @xmath316 reside in @xmath311 and the qutrit @xmath317 does not , then @xmath3 is divisible by @xmath318 .    in order to recover the _ number @xmath3 in the base 3 representation _ , the qutrit states need to be corrected for the passage of incomplete groups of particles before application of @xmath300 , eq .",
    "( [ eq : qtrit_mod_3 ] ) , except for the first one , which is directly measured after application of @xmath300 .",
    "the result @xmath319 , @xmath320 , or @xmath321 of the measurement is stored in @xmath90 . before measuring the next qutrit @xmath322 ,",
    "all counters @xmath102 need to be corrected for the modulus of @xmath3 : the states @xmath231 of the @xmath323-th qutrit are given the additional phase shifts @xmath324 .",
    "subsequently , the operator @xmath300 is applied to the qutrit @xmath322 , its state is measured , and the result @xmath319 , @xmath320 , or @xmath321 is stored in @xmath92 . iterating the process ,",
    "the result @xmath245 of the measurement of the @xmath26-th qutrit is used to correct for the passage of incomplete groups of @xmath325 particles by adding phases @xmath326 to the states @xmath231 of the qutrits @xmath327 .",
    "after application of @xmath300 to the qutrit @xmath246 , its state is measured and the result is stored in @xmath328 .",
    "let us briefly analyze the three operators @xmath284 , @xmath292 , and @xmath300 : since @xmath284 merely takes the state @xmath167 into the balanced state @xmath120 ( but does not act as a fourier transformation on the others ) , its inverse @xmath292 does not describe an inverse quantum fourier transformation . only after augmentation of @xmath292 to the measuring operator @xmath300 , cf .",
    "( [ eq : qtrit_mod_3 ] ) , we arrive at the required inverse quantum fourier transformation allowing for the readout of the individual qutrit states .",
    "the subsequent readout of the qutrit register does not require a fully quantum inverse transformation , rather , the semi - classical version using sequential measurements and manipulations ( executing the compensation for the passage of incomplete groups of particles ) is sufficient .",
    "below , we will encounter other implementations , where the preparation operator @xmath284 already acts as the complete quantum fourier transformation on the semi - classical computational states @xmath165 ; in this case the measurement operator is trivially given by @xmath329 . the reason for sticking to two different operators @xmath284 and @xmath330 in the above discussion is due to the simplicity of the preparation step when using @xmath284 .",
    "this is particularly advantageous in the case where one is interested in the divisibility of @xmath3 by a power @xmath318 , as the readout only involves the inverse operator @xmath292 . using the full fourier transformation @xmath330 for the preparation instead leads to a much more difficult hardware implementation of the preparation , cf .  the following section [ sec : qudits ] .",
    "the further generalization to base-@xmath0 counting with qudits follows the same ideas as those developed for the base-2 and base-3 counting with qubits and qutrits . in order to set up the algorithm",
    ", we have to define the three steps ` preparation through @xmath284 ' , ` counting with @xmath123 ' , and ` measurement ' with the inverse fourier transformation @xmath300 .",
    "the first two steps are clear : the preparation of the initial balanced counting state @xmath120 starts from the computational state @xmath167 and proceeds with the subsequent shift of weight in the wave function to the neighboring well , always leaving behind an amplitude with weight @xmath331 ; the individual steps involve the operators @xmath332 with the @xmath333 non - trivial @xmath334 block shifting the amplitude between the wells @xmath335 and @xmath117 , cf .",
    "( [ eq : qtrit_prep_10 ] ) .",
    "this operation is physically implemented through lowering the barrier between two neighboring wells @xmath335 and @xmath117 .",
    "similarly , the counting operator @xmath123 is given by the straightforward generalization of eq.([eq : qtrit_c ] ) involving the rotation- or phase - operators @xmath336 with @xmath337 and implemented through changing the gating bias of the well @xmath117 .",
    "the implementation of the inverse fourier transformation @xmath300 with the help of the physical operators eqs .",
    "( [ eq : a ] ) and ( [ eq : p ] ) is more difficult but still possible , since this set of operations ( gates ) is universal , i.e. , given a unitary @xmath338 matrix , it can be constructed from a product of operators made from @xmath339 and @xmath340 .",
    "the proof of this statement is similar to the proof of the universality of two - level unitary gates , cf .  ref . :",
    "given an unitary @xmath338 matrix ( or operator ) @xmath341 , the idea is to reduce @xmath341 in an iterative procedure to the unit operator by right - multiplication with amplitude and phase operators .",
    "e.g. , consider the entries @xmath342 and @xmath343 in @xmath341 ( we number rows and columns with indices from @xmath319 to @xmath171 ) .",
    "the product @xmath344 generates the new entries @xmath345 and @xmath346 and we can replace the new entry at the position @xmath347 by 0 if we choose the angles @xmath348 and @xmath349 ( if @xmath350 then @xmath351 and @xmath352 implies zero angles ) .",
    "the new @xmath353 entry reads @xmath354 . repeating this step @xmath171 times",
    "we replace the top row by zeros , except for the @xmath355 entry , which we bring to unity with an additional phase operation .",
    "hence @xmath356 elementary amplitude and phase operations take the first row to the vector @xmath357 and a total of @xmath358 elementary operations take the unitary operator @xmath341 to unity ; the desired operator then is obtained by a simple inversion .    in order to illustrate the procedure",
    ", we derive the fourier transform @xmath359 , @xmath360 for the qutrit . in the implementation of the first step we find the angles @xmath361 and @xmath362 and the product @xmath363 produces the matrix @xmath364 the angles for the second step read @xmath365 and @xmath366 and we obtain the matrix @xmath367 @xmath368 next , the angles for the third step read @xmath369 and @xmath362 and the product @xmath370 generates the second row in the form @xmath371 already  no further phase rotation is needed in this step .",
    "finally , we have to compensate for the phase of the @xmath372 matrix element , which is done by the additional rotation @xmath373 , and we arrive at the unit matrix . collecting all factors ,",
    "we obtain the measurement operator @xmath300 expressed through elementary shift and phase operators , @xmath374     [ \\mathsf{p}^{\\pi}_0\\,\\mathsf{a}^{\\chi}_{1,0}\\,\\mathsf{p}^{\\pi}_0 ]     [ \\mathsf{p}^{\\pi/2}_1\\ , \\mathsf{a}^{\\pi/4}_{2,1}][\\mathsf{p}^{3\\pi/2}_2].\\end{aligned}\\ ] ] the result eq .",
    "( [ eq : m_qutrit ] ) corresponds to the expression eq.([eq : qtrit_mod_3 ] ) up to phases .",
    "indeed , above , we have presented a minimal algorithm with a preparation step @xmath375 generating the first computational state with phases @xmath376 instead of the canonical ones [ the trivial phases @xmath377 . as a result",
    ", the final measurement operator eq.([eq : qtrit_mod_3 ] ) corresponds to the inverse fourier transform up to phases .",
    "of course one could easily introduce additional phase operations @xmath378 and remove the non - canonical phases ( with @xmath379 with @xmath380 ) , however , such additional gates only render the algorithm more involved .",
    "also , it is important to note that the divisibility check _ does not _ require the implementation of the inverse fourier transformation and hence it is worth while to know how to implement a minimal preparation operator @xmath375 .",
    "the base @xmath0 counting and factorization algorithm obviously requires a set of suitable and well operating elementary quantum devices , qubits , qutrits , or qudits . starting out from qubits and their analogy with a spin-1/2 system , the most natural generalization is to try a spin-1 system for the implementation of qutrits and possibly a spin-@xmath0 system for the qudits ; although this idea can be realized in principle for the case of a spin-1 system , the preparation and measurement algorithm is rather complex ( see below ) and should be viewed as a gedanken experiment rather than a realistic proposal .",
    "the next idea then is to generalize the concept of the double - dot charge qubit  this road has been pursued above and works fine in theory , however , the implementation of multi - dot charge qubits may turn out difficult . as an alternative",
    ", one may try to emulate a @xmath0-spin qudit ( @xmath0-level system ) by a system of spin-1/2 qubits ( two - level systems ) .",
    "provided we admit two - qubit interactions in our manipulation scheme , we then are able to define all the necessary operations required by the algorithm . hence , we can offer a scalable route for the implementation of qudits using qubits as elementary units .",
    "below , we will discuss the various issues related to the implementation of qutrits and qudits in more detail , putting our main emphasis on the understanding of the qutrits , their implementation and manipulation .",
    "the most straightforward attempt to generalize the base 2 counting with qubits ( spin-1/2 two - level systems ) to the base 3 counting with qutrits makes use of a spin-1 three - level system with the orthogonal ( computational ) basis @xmath381 , @xmath382 , and @xmath383 , where @xmath159 and @xmath384 denote the angular momentum and magnetic quantum numbers . as in the previous cases ( two - level qubit , three - level qutrit ) , we have to prepare the system in the initial counting state @xmath385 , e.g. , the lowest harmonic of the computational basis or another balanced state . the logic taking us to a valid balanced state is the following : _",
    "i ) _ we first note , that experimentally we can produce either axial states ( polarized along a direction @xmath386 ) such as @xmath387 , or planar polarized states @xmath388 , hence we will focus on these types of states . _",
    "ii ) _ as one can not construct axial states with equal weights for all basis states @xmath389 , we concentrate on the planar states .",
    "the most general planar state ( with a director parallel to @xmath390 defined by the direction angles @xmath391 and @xmath392 ) assumes the form ( in the computational basis ) @xmath393 we demand that all components have equal weights , hence @xmath394 ; choosing @xmath395 , we obtain the balanced state @xmath396 the planar state @xmath397 with a director @xmath398 pointing along the body diagonal ; other values of @xmath391 correspond to another direction @xmath399 rotated around the @xmath37-axis .    the other counting states then are obtained by rotating @xmath120 by the angle @xmath400 ( anti - clockwise ) around the @xmath37-axis , @xmath401 and @xmath402 ; physically , this rotation is achieved by ensuring that passing electrons create a local magnetic field pulse along the @xmath37-axis . to simplify our further discussion",
    ", we exchange the two axes , the one for the preparation and the one defining the counting field : our task then is to generate an initial planar polarized state @xmath403 and implement the counting step through rotation by an angle @xmath400 ( anti - clockwise ) around the axis @xmath399 .",
    "while the creation of axially polarized states is rather straightforward , creating a planar polarized state @xmath388 is non - trivial . indeed , while we can make use of a simple deterministic procedure to prepare an axially polarized state ( by switching on a magnetic field and relaxing the spin through coupling to a bath ) , the planar polarized state required here is more difficult to obtain .",
    "a simple preparation can be implemented with the help of a stern - gerlach apparatus , however , this procedure is a statistical one , with a one - half probability for a positive outcome .",
    "in fact , preparing an initial state polarized along @xmath34 , @xmath404 , using a stern - gerlach setup directed along @xmath37 , and selecting particles with a straight trajectory ( i.e. , selecting the ` middle spot ' in the stern - gerlach setup ) we obtain the desired spin state @xmath403 ( a procedure to generate a proper initial state with unit probability is discussed later ) .",
    "spin-1 qutrit .",
    "after preparation in the state @xmath403 , the system is in a state of planar ( @xmath35 ) polarization , i.e. , the spin has no component along @xmath37 . upon passage of a particle ,",
    "the polarization plane is rotated ( by the angle @xmath400 around @xmath399 ) from @xmath35 to @xmath405 , for the second particle to @xmath406 , and for the third back to @xmath35 .",
    "the divisibility test involves a measurement with a stern - gerlach apparatus with the field directed along the @xmath37-axis.,width=188 ]    with the counting state @xmath407 properly prepared , we define the counting step through a rotation by the angle @xmath400 around the axis @xmath408 , cf .  fig .",
    "[ fig : spin1 ] , @xmath409 \\\\     \\nonumber     & = & \\exp\\left[-\\frac{2\\pi i}{3\\sqrt{3 } }                \\left (                \\begin{array}{ccc }                1 & e^{-i\\pi/4 } & 0\\\\                e^{i\\pi/4 } & 0 & e^{-i\\pi/4 } \\\\                0 & e^{i\\pi/4 } & -1                \\end{array }                \\right)\\right].\\end{aligned}\\ ] ] as the three - fold iteration takes us back to the original state @xmath403 , our counting operator is cyclic and generates the complete orthogonal counting basis @xmath410 the measurement step for the divisibility check after the passage of the particles involves a second stern - gerlach experiment directed along the @xmath37-axis  if the particle moves again on the straight trajectory , its polarization was unchanged by the passage of the @xmath3 particles and hence @xmath3 is divisible by 3 .",
    "the other states @xmath411 .    as usual ,",
    "the measurement of the number s modulus ( the counting measurement ) is more involved .",
    "we then make use of the other outcomes @xmath412 and @xmath413 of the second stern - gerlach experiment and bring them to interference further down their trajectories , cf .",
    "[ fig : sg ] .",
    "testing the resulting state , e.g. , the state latexmath:[$|1,0\\rangle_y = i ( |1,1\\rangle_z +    phases ) in a third stern - gerlach apparatus polarized along the",
    "@xmath40-axis then identifies the counting state @xmath415 on the straight trajectory ( the middle spot , the number s modulus is 2 ) ; if no spin is measured , the counting state @xmath416 has been realized and the number s modulus is 1 .",
    "setup for the counting with a spin-1 qutrit . sending the initial polarized state @xmath417 into a first stern - gerlach ( sg ) apparatus with axis @xmath37 and selecting the middle ( undeflected ) trajectory",
    ", we obtain the planar state @xmath403 with probability 1/2 .",
    "the counted particles passing by rotate this state around the axis @xmath418 and generate the planar counting states @xmath403 , @xmath416 , and @xmath415 ( note that the counter particle has to be stopped and trapped during the time of interaction with the particles passing by ) .",
    "these are analyzed in a second sg apparatus with axis @xmath37if the spin is not deflected , the number @xmath3 of counted particles is divisible by 3 . combining the two deflected beams and analyzing the superposition in a further sg apparatus directed along the @xmath40-axis",
    ", we find the mudulus of @xmath3 , which is 2 if the spin is undeflected and 1 else.,width=302 ]    finally , we look for a preparation step with unit efficiency",
    ". this can be achieved by making further use of the states @xmath419 behind the first stern - gerlach device ( we still use the input state @xmath417 to the stern - gerlach apparatus ) : superimposing these two states , we obtain the component @xmath420 and rotating this planar state back to the @xmath37-axis , we have managed to transform the initial spin @xmath417 into two subsequent wave - packets with weight 1/2 , each describing the same spin state @xmath403 .",
    "hence , although we can not generate a planar state out of an axial state by simple rotation , the use of a stern gerlach apparatus and proper manipulation of all three amplitudes of the split wave function allows one to generate the desired planar state , though split into two wave - packets with weight 1/2 each .",
    "obviously , the above scheme is a very complex one and should be regarded as a ` gedanken ' experiment rather than a realistic setup .",
    "nevertheless , it is interesting to see , that a spin-1 qubit can , at least in principle , be used for the implementation of the base - three counting algorithm .",
    "the triple - dot qutrit has been discussed above in section [ sec : qutrits ] .",
    "preparation , counting , and readout can be properly implemented via voltage pulses acting on the semi - classical states ( phase shifts ) or on the barriers in between ( amplitude shifts ) .",
    "a drawback is the need to design a new device when going from base 2 to base 3 counting and , more generally , each time a new prime factor is to be tested .",
    "the emulation of qutrits ( and qudits ) through qubits described below allows one to stay with only one computational unit for all base-@xmath0 counting tasks and factorizations .",
    "the basic idea we pursue here is to emulate the qudits needed in the base-@xmath0 counting and factorization through simpler qubits .",
    "we start by combining 2 qubits into a qutrit .      an obvious way to choose three appropriate states in the product hilbert space @xmath421 of the two qubits is to make use of the decomposition into singlet and triplet sectors , @xmath422 and use the three - dimensional triplet space @xmath423 .",
    "contrary to the simple spin-1 qutrit , the emulated version using two qubits provides us with the necessary degrees of freedom to perform all of the required steps ( preparation with @xmath284 and readout with @xmath300 ) in the counting and factorization algorithm with the help of one- ( @xmath424 ) and two - qubit ( @xmath425 ) operations . referring to the previous paragraph , we start from the computational basis @xmath426 , and @xmath427 and seek for those manipulations which provide us with the counting states in the form of three orthogonal planar polarized states with balanced weights .",
    "the latter take the form eq .",
    "( [ eq : planar_n ] ) , whereas the axial states can be written as ( again in the computational basis ) @xmath428 with @xmath429 the direction of the spin axis",
    ". note that once these states are chosen , the operators @xmath430 and @xmath425 only change the relative phases in @xmath388 and @xmath387 but not the relative weights in the amplitudes .",
    "it is then our task to construct three orthogonal planar states out of the computational basis , which consists of two axial and one planar state . in this way",
    ", we can find a preparation operator @xmath284 which is congruent to the fourier transformation , i.e. , @xmath431 transforms the computational basis @xmath432 into the counting basis @xmath433 .",
    "we first note , that the planar states eq .",
    "( [ eq : planar_n ] ) always have the same weight in the components @xmath167 and @xmath169 and hence we first have to rotate the axial states of the computational bases into the @xmath35-plane .",
    "this is done with the operator @xmath434 where @xmath435 and results ( up to a phase ) in the states [ @xmath436 in eq .",
    "( [ eq : axial ] ) ] @xmath437 cf .  fig .",
    "[ fig : f_rot ] .",
    "note that the simple rotation takes the planar state @xmath168 into a planar state ( with a director along @xmath40 ) .",
    "in order to map the axial states in eq .",
    "( [ eq : axial_y ] ) to planar states we choose @xmath438 in eq .",
    "( [ eq : planar_n ] ) and obtain the candidate states @xmath439 the planar and axial states in eqs .",
    "( [ eq : planar_45 ] ) and ( [ eq : axial_y ] ) now have equal amplitudes . in order to select the appropriate phases @xmath391 in the planar states eqs .",
    "( [ eq : planar_45 ] ) , we note that the phase differences between the @xmath167 and @xmath169 components of the axial states are equal to @xmath440 ; these have to be matched with the phase differences @xmath441 in the planar states and hence we choose planar states with @xmath442 , @xmath443 the two states are characterized by directors pointing along the @xmath444-diagonals , cf .",
    "[ fig : f_rot ] . in order to map the axial states eq .",
    "( [ eq : axial_y ] ) to the planar states eq .",
    "( [ eq : planar_45_diag ] ) we make use of the two - qubit operator @xmath445 the latter adds the phases @xmath446 ( @xmath447 ) to the components @xmath167 , @xmath169 ( @xmath168 ) and hence leaves the relative phase between the components @xmath167 , @xmath169 unchanged while adding a relative shift @xmath448 to the middle one . hence choosing @xmath449",
    ", we can map the axial state @xmath450 to the planar state @xmath451 and @xmath452 to the planar state @xmath453 , cf.fig .",
    "[ fig : f_rot ] .",
    "since the component @xmath168 in the planar state @xmath454 has weight 0 , the operator @xmath455 leaves it unchanged .",
    "rotations generating the quantum fourier transformation on the triplet sector of a two - qubit system ; we denote the axial states @xmath456 and @xmath457 by double arrows and planar states ( e.g. , @xmath458    /\\sqrt{2}$ ] ) by a director .",
    "( a)@xmath170(b ) rotation by @xmath229 around the @xmath34-axis , ( b)@xmath170(c ) conditional rotation transforming the two axial states into planar ones with directors along the diagonals in the @xmath444-plane , ( c)@xmath170(d ) rotation by @xmath459 around the @xmath34-axis of three planar states to position them symmetrically around the @xmath37-axis .",
    "the last step defines the counting states which transform among one another through a rotation by the angle @xmath460 around the @xmath37-axis.,width=264 ]    hence we have arrived at three orthogonal planar states directed along @xmath40 and along the @xmath444-diagonals ; a final rotation @xmath461 with @xmath435 by @xmath462 around the @xmath34-axis then arranges the three states symmetrically around the @xmath37-axis .",
    "combining the three operations , we obtain the preparation and inverse measurement operator @xmath463 the actions of the three operations in eq .",
    "( [ eq : u_p ] ) on the computational basis states @xmath464 are illustrated in fig.[fig : f_rot ] ; the resulting counting basis is given by the three ( planar ) states @xmath465 , @xmath466 one can confirm , that the _ counting _ step involving the application of the operator @xmath467 with @xmath468 , indeed transforms the three counting states in eq.([eq : u_p_psi_0 ] ) into each other , i.e. , latexmath:[$|\\psi_n\\rangle = \\mathsf{c}_1^n    definition of @xmath75 used here and compare with the corresponding definition of @xmath123 in the following paragraph , section [ sec : effemul ] ) .",
    "although the emulation of the qutrit by the triplet sector of two qubits can be done consistently , this scheme is inefficient in scaling up to larger primes . indeed , emulating a spin-2 system within this scheme requires 4 qubits , whereby most of the hilbert space ( an eleven dimensional sector ) is not used since only the component @xmath470 out of the decomposition @xmath471 is needed .",
    "a suitably scalable case should make maximal use of the emulating qubits , i.e. , use a large fraction of the hilbert space . in choosing the appropriate subset of states in the multi - qubit hilbert space",
    ", we have to select states with an equidistant spectrum .",
    "e.g. , for the case @xmath472 and 2 qubits , we choose three consecutive states from @xmath473 , @xmath474 , @xmath475 and an elementary phase shift operator @xmath476 $ ] ; upon passage of a particle , the four states then pick up the phases @xmath477 , @xmath478 , @xmath479 , and @xmath480 . choosing @xmath481 and the first three states @xmath167 , @xmath168 , and @xmath169 , the ( relevant sector of the ) operator @xmath123",
    ", @xmath482 coincides with the expression eq .",
    "( [ eq : qtrit_c ] ) , up to an overall phase @xmath483 [ to be added to ( [ eq : c12qubits ] ) ] .",
    "the generalization of this scheme to an @xmath484-qubit emulation of a qudit is straightforward , @xmath485.\\ ] ] in addition to the shift operator @xmath123 , we need to know the form of the preparation operator @xmath284 . for the above qutrit emulation ,",
    "this operator takes the form ( see appendix [ app : up ] for the derivation ) @xmath486 with the angle @xmath487 . as",
    "this is not yet the full fourier transformation on the computational basis @xmath156 , @xmath488 , we still have to find the measurement operator @xmath300 . in order to accomplish this task ,",
    "one notes that the three counting states @xmath121 , @xmath489 are entangled , while the three computational states @xmath156 , @xmath490 are not . the inverse fourier transformation @xmath300 then has to disentangle the counting states , a criterion which helps us in finding its explicit form .",
    "in the end , the measurement operator @xmath300 is obtained in the form of a product of three unitary operations @xmath491 , @xmath492 , @xmath493 where @xmath494 and @xmath495 serve to disentangle the three counting states @xmath121 , @xmath489 , and @xmath496 is a conditional hadamard operation , turning the spin of qubit 2 into the @xmath37-axis if the qubit 1 is in the state @xmath247 .",
    "the detailed derivation of eqs .",
    "( [ eq : em_u_p ] ) and ( [ eq : muuu ] ) and the form of the operators @xmath491 , @xmath492 , is given in appendix [ app : up ] .",
    "it turns out , that our counting algorithm has much in common with the phase estimation algorithm ( pea ) ; the following discussion of the pea is formulated in a way as to make this connection apparent .",
    "the phase estimation algorithm first appeared as a part of shor s factorization algorithm @xcite ; an extended separate algorithm was presented by kitaev @xcite and later by cleve et al .",
    "the phase estimation algorithm attempts to find the ` phase ' @xmath497 in the eigenvalue @xmath498 of a unitary operator @xmath341 associated with a given eigenvector @xmath499 . in the version of refs .",
    ", this is achieved with the help of two qubit - registers , one of which ( the second ) is storing the vector @xmath499 and acts on it with the operators @xmath500 , @xmath501 , to generate the phases @xmath502 .",
    "the other ( first ) register consists of @xmath2 qubits and produces the desired phase estimate in the following manner : with all qubits initialized in the state @xmath311 , a hadamard operation generates the balanced states @xmath503 for all qubits in the first register .",
    "a controlled @xmath504 operation between the second register and the @xmath26-th qubit in the first register then puts the qubit into the state @xmath505 , hence generating the quantum fourier transform ( we express the product state through the computational basis and assume that the phase @xmath391 can be represented by @xmath2 binary digits ) @xmath506 in the first register .",
    "a final inverse fourier transformation then generates the state @xmath507 and the projective measurement of the @xmath2-qubit register in the computational basis provides us with the phase @xmath391 ; for an arbitrary phase @xmath508 we obtain a @xmath2-binary - digit estimate @xmath509 of the phase @xmath391 .    comparing this algorithm with our counting setup",
    ", we identify the action of the @xmath3 particles traversing the quantum wire with the action of the second register in the pea , with the correspondence @xmath510 .",
    "the controlled @xmath511 operation in the pea is replaced by the coupling of the wire to the qubits : the interaction of the @xmath3 particles with the last ( @xmath2-th ) qubit has to be identified with the action of the controlled @xmath341 operator in the pea , hence @xmath512 .",
    "the qubits @xmath513 are more strongly coupled to the wire , that corresponds to higher powers of the operator @xmath341 in the pea ; in fact , the @xmath26-th qubit coupling is enhanced by the factor @xmath514 and its interaction with the particles in the wire corresponds to the action of the controlled @xmath504 operator . finally , the intermediate states in eqs .",
    "( [ eq : qft ] ) and ( [ eq : pe ] ) agree with one another with the identification @xmath515 .",
    "the final states exhibit the correspondence @xmath516 .",
    "note that our divisibility algorithm has no counterpart in the pea .",
    "this analogy immediately allows us to profit from the performance analysis @xcite of the pea : assume that we wish to measure the phase @xmath391 in the pe problem to an accuracy of @xmath517 ( i.e. , we want to encode @xmath391 with @xmath518 bits ) and be sure of our measurement result with a probability @xmath519 at least , then the setup must involve @xmath520 qubits .",
    "this result can be applied to our counting algorithm . consider the case , where a non - integer number @xmath521 has passed the counter , with @xmath3 an integer and",
    "@xmath522 a real number .",
    "such a situation may occur when the interaction between the particles and the counting qubits is still finite at the moment when the readout procedure starts , corresponding to the passage of a fraction of a full charge .",
    "concentrating first on the implementation with a fully - quantum inverse fourier transformation , the performance analysis of the pea tells us that we still can measure the number to any desired precision .",
    "e.g. , if we want to be able to measure the number @xmath523 such that @xmath524 with a probability @xmath525 , we need to be able to resolve fractional charges @xmath526 , i.e. , we have to add additional qubits which measure half - charges ( turning by @xmath527 on the passage of one particle ) , quarter charges ( rotating by @xmath528 ) , etc .",
    "the entire setup then has to involve @xmath529 qubits .",
    "this result can be extended to qudits : requiring a precision @xmath530 , we need @xmath531 qudits . hence , we can trade additional qudits in the counting process against a higher probability to obtain a correct integer result .",
    "next , we consider the semi - classical inverse fourier transformation ; we demonstrate below that this semi - classical scheme exhibits the same stability as the fully - quantum version , although the passage of a fractional charge strongly affects the conditional measurement of subsequent qubits , e.g. , for @xmath532 the measurement of the first qubit gives a random input for the direction of measurement of the second qubit .",
    "however , this error does not propagate through the entire measurement scheme .",
    "instead , the measurements of higher qubits recover from false results measured for lower qubits .",
    "formally , this can be proven by comparing the two probabilities @xmath533 ( using a full quantum fourier transformation ) and @xmath534 ( using a semi - classical fourier transformation ) to find the integer number @xmath3 when a non - integer number @xmath34 has passed by the qubit register .",
    "indeed , let us calculate the probability @xmath535 to find the integer result @xmath536 upon measurement of a non - integer signal @xmath34 by the qubit register . the probability @xmath537 that the first qubit provides the value @xmath90 is given by the matrix element between the qubit state @xmath538 and the state @xmath539 to be measured ( i.e. , the projection @xmath540 for @xmath541 or @xmath542 for @xmath543 , cf .",
    "[ sec : qubits ] ) @xmath544 next , the conditional probability to measure the value @xmath92 for the second qubit is given by the product @xmath545 with @xmath546 using eq .",
    "( [ eq : n_rel ] ) , we can rewrite the first factor in @xmath547 in the simpler ( and equivalent to the second factor ) form @xmath548 the straightforward iteration of this scheme then produces the final result for @xmath535 in the product form @xmath549 where @xmath550 evaluating the product , the result eq .",
    "( [ eq : p_scf ] ) is easily rewritten in the form @xmath551 with the generalized counting state ( cf .",
    "( [ eq : fi ] ) ) @xmath552 expressing the counting state @xmath18 as a fourier transform of the computational state @xmath553 , @xmath554 , we arrive at the result @xmath555 , where @xmath556 is defined in terms of the back transformed counting state . but",
    "this is nothing else than the probability @xmath557 to find the number @xmath3 in a one - shot measurement of the qubit register after application of an inverse quantum fourier transformation on the detected state @xmath558 , hence @xmath559 .",
    "we conclude that the semi - classical and the fully - quantum fourier transformation exhibit the same stability to systematic errors introduced by incomplete ( non - integer ) counting .",
    "furthermore , we note that the semi - classical algorithm is rather robust with respect to random errors ; the latter can be handled with a classical multi - qubit error correction scheme combined with a simple majority rule , cf.ref .  .",
    "the above discussion allows us to use our counting device to measure continuous variables .",
    "the insight paves the way for its use as a quantum voltage - detector , a particular form of an analog to digital converter ( adc ) .",
    "consider a setup similar to the one in fig .",
    "[ fig : counting ] but with the wire replaced by a finite metallic object , see fig .",
    "[ fig : adc ] .     quantum voltage - detector made from @xmath2 counter qubits .",
    "a voltage @xmath560 applied over a time interval @xmath561 generates a continuous phase @xmath562 , which can be measured by the @xmath2-qubit register and translated into a binary digital output signal.,width=264 ]    assuming that the applied voltage translates into a relative shift @xmath563 ( @xmath564 ) of the most weakly ( strongly ) coupled qubit [ which is the qubit @xmath565 ( @xmath114 ) ] , the reading of the qubit array after detaching the voltage provides us with a binary digital number @xmath3 which translates into the phase @xmath391 according to @xmath566 _ provided that _ the quantity @xmath567 can be represented by an integer number . in order to handle successfully the general case with an arbitrary drive @xmath568",
    ", we have to add additional qubits in order to arrive at a digital estimate of @xmath391 : for a result with a relative precision @xmath569 and with a probability better than @xmath570 , we need a measuring device with @xmath571 qubits .",
    "the sensitivity of our quantum adc improves as @xmath572 , where @xmath561 is the time of observation ; this is because the accumulated phase increases linearly in time , while the most sensitive qubit always resolves phases of @xmath238 .",
    "the precision then is by a factor @xmath573 better than the usual classical sensitivity , which scales as @xmath573 , and agrees with standard expectations @xcite . in particular , using the straightforward algorithm described in sec .",
    "[ sec : efficiency ] to measure a voltage @xmath574 with an accuracy @xmath575 , we either need @xmath576 qubits or have to run repeated experiments over a time @xmath577 , where @xmath578 is the measuring time of the individual experiment . solving for the desired accuracy @xmath575",
    ", we obtain the scaling @xmath579 , i.e. , the precision improves only with the square - root of the overall measuring time @xmath561 , the same as for the usual classical case .",
    "another application of our counting device is the generation of multi - particle entangled states with the help of a mach - zehnder interferometer , see fig.[fig : mz ] . injecting particles into the device through the lower left arm , the splitter generates a superposition of number states in the two arms of the interferometer ; measuring the counter placed near the upper arm and selecting a particular reading projects the system to the desired",
    "entangled state .",
    "the functionality of the device has been described in detailed in ref . before . here , we use the device with our qutrit counter to generate the original ghz ( greenberger - horne - zeilinger ) state @xcite and to unveil in more detail the entanglement between the counter states and the physical number states in the quantum wire ; the generalization to other cases with more particles and counters follows the previous discussion in ref ..    consider a particle entering the mach - zehnder interferometer from the lower - left lead and propagating along one of the two leads @xmath580 or @xmath581 , see fig .",
    "[ fig : mz ] .",
    "the wave function can propagate along two trajectories , the upper arm @xmath580 where the particle picks up a phase @xmath582 and the counter is activated , or the lower arm @xmath581 accumulating a phase @xmath583 and leaving the counter state unchanged .",
    "the total wave function evaluated at the position a then assumes the form @xmath584 where @xmath561 and @xmath585 denote the transmission and reflection coefficients of the beam splitter and we have introduced a pseudo - spin notation to describe the propagation of the particles along the two arms : a pseudo - spin @xmath586 ( @xmath587 ) refers to the particle propagating in the upper ( lower ) arm .",
    "the qutrit state depends on the particle s trajectory and reads either @xmath236 if the particle has passed in the nearby upper arm or @xmath120 if the particle passed through the lower arm of the interferometer .",
    "mach - zehnder interferometer with qutrit counter .",
    "particles enter the interferometer through the left leads ( here the bottom lead ) and are measured on the right . the qutrit counter in the upper arm @xmath580",
    "detects the passage of particles .",
    "the magnetic flux @xmath588 through the loop allows to tune the phase difference when propagating along different arms . , width=264 ]    next , we inject three particles ( from the bottom left ) into the mach - zehnder ( mz ) loop .",
    "we assume the three individual wave functions describing the initial state to be well separated in space , allowing us to ignore exchange effects in our ( mz ) geometry .",
    "the wave function at the position a then reads @xmath589          \\otimes |\\psi_0\\rangle            \\\\ \\label{eq : psi3a }        & & \\qquad\\quad        + t r^2 \\,e^{i(\\varphi_u+2\\varphi_d ) }        \\bigl[|\\!\\uparrow,\\downarrow,\\downarrow \\rangle             + |\\!\\downarrow,\\uparrow,\\downarrow \\rangle         \\\\",
    "\\nonumber        & & \\qquad\\qquad\\qquad             + |\\!\\downarrow,\\downarrow,\\uparrow \\rangle \\bigr ]                 \\otimes |\\psi_1\\rangle               \\\\ \\nonumber        & & \\qquad\\quad        + t^2 r \\,e^{i(2\\varphi_u+\\varphi_d ) }        \\bigl[|\\!\\uparrow,\\uparrow,\\downarrow \\rangle             + |\\!\\uparrow,\\downarrow,\\uparrow \\rangle              \\\\ \\nonumber        & & \\qquad\\qquad\\qquad             + |\\!\\downarrow,\\uparrow,\\uparrow \\rangle \\bigr ]                 \\otimes |\\psi_2\\rangle.\\end{aligned}\\ ] ] assuming scattering coefficients for a symmetric beam splitter , e.g. , @xmath590 , @xmath591 , and @xmath592 ( with @xmath593 the transmission phase ) , the projection to the counter state @xmath120 provides one with the ghz - like state @xmath594 ; manipulation of the flux @xmath588 in the mach - zehnder loop then allows one to implement the desired entangled state .",
    "furthermore , the wave function eq.([eq : psi3a ] ) unveils the entanglement between the ( split ) number states and the counter .",
    "note that the indistinguishability of particles exploited in the above entanglement process is an ` artificial ' one defined by the qutrit detector , rather than the ` fundamental ' one of identical particles .",
    "summarizing , we have generalized the binary ( base 2 ) quantum counting algorithm and divisibility test by @xmath5 to ternary ( base 3 ) and higher counting systems .",
    "this extension is quite non - trivial in several respects : on the device level , the qubits used in the base 2 algorithm have to be replaced by qutrits for a ternary counting system and to qudits for a base @xmath0 algorithm . since the algorithm is based on two subsequent quantum fourier transformations , suitable manipulation schemes have to be defined in order to implement a quantum fourier transformation on the level of individual qubits , qutrits , and qudits .",
    "furthermore , rather than developing new hardware for every new counting base , we have discussed how to use qubits in order to emulate qudits , with particular emphasis on the qutrits .",
    "starting from binary counting with qubits , it seems not immediately clear how to generalize the concept .",
    "it turns out , that defining the quantum counting task on an elementary level through a one to one correspondence between the counting objects and distinguishable states in a hilbert space provides us with a constructive scheme how this task can be achieved .",
    "also , the analysis of the unary counting scheme naturally introduces the quantum fourier transformation as the basic operation in a non - demolitian counting process .",
    "indeed , the task of counting naturally introduces a shift operator @xmath123 in the counting space , taking one counting state @xmath18 into the next @xmath595 . when expressing these counting states through the eigenstates @xmath12 of @xmath123 , then the counting operation only adds a phase @xmath596 to each of these states . hence using these eigenstates @xmath12 , which are nothing but the fourier transforms of the counting states @xmath18 , as our computational basis provides for us a ` soft ' non - demolitian counting scheme .",
    "choosing another computational basis involves an energy exchange between the counted object and the counting system and introduces a much more severe perturbation .",
    "the aforementioned basic understanding of quantum counting has provided us with a constructive scheme for the counting algorithm : starting out with a set of measureable states ( the computational basis @xmath597 ) which evolve with a prescribed phase accumulation upon the passage of particles , we have to prepare out of them a balanced state @xmath70 which is used as the first counting state . with the appropriate phase increment picked up during counting",
    ", this first counting state evolves to the next and returns to the first one after an @xmath15-cycle .",
    "as we have seen , we do not have to enter the cycle in the lowest harmonic , any harmonic will do , and even arbitrary phases in a balanced state ( an equal - weight superposition of the computational basis states ) are acceptable . in the latter case ,",
    "the fourier transformation is modified with additional phases , which are not harmful to the algorithm , however .",
    "equipped with this general scheme , we have been able to generalize the binary algorithm to a ternary and to base-@xmath0 counting .",
    "we have seen , that one possible straightforward extension of the hardware , going from a spin-1/2 to a spin-1 system , poses severe problems due to the lack of suitable operators in the state preparation .",
    "indeed , although any superposition of two states are allowed in quantum mechanics , it might be difficult to prepare this superposition in practice .",
    "e.g. , if we want to superpose two different eigenstates of the same hamiltonian , one has to act on the states with an operator which might not be available in the given physical system ; this situation is actually encountered in the spin-1 system .",
    "however , emulating a spin-1 system through the triplet sector of two qubits provides a viable alternative : the two - qubit operation combined with single - qubit rotations provide sufficient degrees of freedom to carry out all required operations for counting , the state preparation and the inverse fourier transformation .",
    "further emulation of qudits with qubits , however , should not be done in the spin-@xmath0 sector , as this is a waist of resources . instead",
    ", a straightforward sequence of neighboring energy states will do .",
    "an important element to realize is that the fourier transformation , which we can handle semi - classically ` between ' the qudits , has to be fully quantum ` within ' the qudits . hence the larger the chosen counting basis @xmath0 is , the larger is the part of the inverse fourier transformation which is done fully quantum .",
    "we have demonstrated , that the substitution of the semi - classical inverse fourier transformation for the fully - quantum does not entail any disadvantage for the counting algorithm ; this is an important result , both with respect to the stability of the counting algorithm against systematic errors ( non - integer counting ) as well as its application in metrology .",
    "it thus appears that the conditional operation in the quantum fourier transform can be fully substituted by a measurement combined with a conditional operation in the semi - classical scheme . in both cases ,",
    "a non - integer reading may affect some of the last digits of the seeked number , but the leading digits are not compromized .",
    "furthermore , adding additional qubits ( digits ) allows to trade an extension of the hardware for a better precision in the output .    in terms of applications of our counter",
    ", we have generalized the scheme producing multi - particle entanglement in a mach - zehnder interferometer and have proposed its use as a quantum voltage - detector , a particular example of an analog - digital converter .",
    "we may speculate that our quantum counting scheme can be generalized to other broadband measurement algorithms and thus contribute to other applications in quantum metrology@xcite .",
    "we thank klaus ensslin , alexei kitaev , gerald milburn , renato renner , and peter shor for discussions and acknowledge financial support by the pauli - center at eth zurich and the russian foundation for basic research under grant no .  08 - 02 - 00767-a .",
    "motivated by our general discussion in section [ sec : fourier ] , we start out with the counting basis in the form [ we choose a balanced state @xmath120 and apply the counting operator @xmath123 in eq.([eq : c12qubits ] ) to obtain , up to an overal phase ] @xmath598 these counting states are entangled , whereas those defining the computational basis , @xmath599 , @xmath600 , are not .",
    "this feature can be conveniently exploited in finding the operators @xmath284 and @xmath300 for preparation and readout .",
    "we begin with the preparation step : rather then finding @xmath284 , we search for the inverse operator @xmath292 which disentangles the state @xmath120 . in order to accomplish this task , we have the operators @xmath601 , @xmath602 , @xmath603 , @xmath604 , and the two - qubit operator @xmath605 at our disposal . in our construction",
    "below , we will make heavy use of the conditional rotation @xmath606 this operator will generate the decisive step in the disentanglement of the qubit states .",
    "let us consider a general ( entangled ) two - qubit state @xmath607 with normalization @xmath608 .",
    "the state @xmath609 is not entangled if and only if @xmath610 or one of the states @xmath611 , @xmath612 vanishes .",
    "acting with @xmath613 on @xmath609 , @xmath614 we find that @xmath613 disentangles @xmath609 if @xmath615 and @xmath616 , see fig.[fig : u_dis ] ( here , the angles @xmath617 and @xmath618 denote the directions of the second spin described with the states @xmath619 ) .",
    "furthermore , we need the property of @xmath613 that it transforms a product state @xmath620 or @xmath621 is directed along the @xmath37-axis .",
    "action of @xmath613 in disentangling a state .",
    "the two components @xmath619 to be aligned point along the same polar angle @xmath392 .",
    "the conditional rotation by @xmath391 aligns the two components if @xmath391 matches the azimuthal angle difference , @xmath616 .",
    ", width=264 ]    in order to find the operator @xmath292 disentangling @xmath120 , we write the latter in the form @xmath622 hence @xmath623 and @xmath624 . the sequence of operations shown in fig .",
    "[ fig : up ] disentangles the state @xmath120 by aligning @xmath625 and @xmath626 along the diagonal in the @xmath35-plane and produces the state @xmath627 with @xmath628 the remaining one - qubit operations @xmath629 and @xmath630 with @xmath487 then produces the computational state @xmath631 up to a phase , @xmath632 .",
    "one easily verifies that the above sequence of operations produces the operator @xmath284 , eq.([eq : em_u_p ] ) .",
    "rotations generating the operator @xmath292 ; shown are the rotations acting on the components @xmath633 and @xmath634 in @xmath120 , cf .",
    "( [ eq : psi_0_chi ] ) ( the arrows reflect the polarization angles of the spin states ) .",
    "the first rotation ( a ) @xmath170 ( b ) by @xmath229 around the @xmath34-axis rotates @xmath635 into the direction along the @xmath40-axis .",
    "the subsequent two - qubit rotation @xmath636 , cf .",
    "( b ) @xmath170 ( c ) , aligns both components along the @xmath35-diagonal ; this step disentangles the state .",
    "the next rotation by @xmath637 around the @xmath37-axis makes the two states @xmath638 point along the @xmath40-axis and the subsequent rotation by @xmath243 around the @xmath34-axis aligns them parallel to the @xmath37-axis .",
    "the final two rotations of the qubit 1 ( not shown ) transforms the state @xmath627 into the state @xmath639 , which coincides ( up to a phase ) with the computational state @xmath640.,width=226 ]    the construction of the inverse quantum fourier transformation @xmath300 for the readout follows the same scheme , i.e. , we look for the operator @xmath300 which disentangles the counting states @xmath641 and maps @xmath285 to @xmath642 , @xmath236 to @xmath643 , and @xmath120 to @xmath599 ; this will be done in three consecutive steps , @xmath644 with @xmath491 , @xmath645 , appropriate unitary operators serving to disentangle the three counting states @xmath641 , @xmath646 , and producing the simple computational states @xmath647 , @xmath646 .",
    "rotations generating the operator @xmath494 ; shown are the operations acting on the components @xmath648 and @xmath634 in @xmath285 of qubit 2 in eq .",
    "( [ eq : dis_psi_2 ] ) ( vectors mark the polarizations of the spin states ) . the first rotation ( a ) @xmath170 ( b ) by @xmath400 around the @xmath37-axis rotates the in - plane component @xmath649 into the @xmath34-axis .",
    "the second rotation by @xmath229 around the @xmath34-axis makes @xmath635 point along the @xmath40-axis , cf .",
    "( b ) @xmath170 ( c ) .",
    "the subsequent two - qubit rotation @xmath636 , cf .",
    "( c ) @xmath170 ( d ) , aligns both components along the @xmath35-diagonal ; this step disentangles the state .",
    "the remaining rotations of qubit 2 by @xmath637 around the @xmath37-axis and by @xmath243 around the @xmath34-axis serve to prepare the operation @xmath495 and take the spin 2 back to the @xmath37-axis .",
    "the state @xmath650 merely picks up a phase , while the states @xmath120 and @xmath236 remain entangled , cf .  eqs .",
    "( [ eq : u2p0 ] ) .",
    ", width=226 ]    we start with the disentanglement of @xmath285 , which we write in the form @xmath651 and require @xmath494 to disentangle @xmath285 while leaving the fourth state @xmath650 unchanged ( up to a phase ) .",
    "this task is accomplished by the operator @xmath652 where the first expression is used in an implementation through single and two - qubit gates and the second provides the simpler overall unitary matrix , the first two rotations prepare the states @xmath625 and @xmath626 to allow the two - qubit operator @xmath636 to align them and hence disentangle the state , see fig .  [",
    "fig : u2 ] ; the remaining one - qubit operators acting on qubit 2 serve to prepare the state for the action of @xmath495 .",
    "the operator @xmath494 leaves the state @xmath653 parallel to itself , latexmath:[$\\mathsf{u}_2 |\\!\\downarrow \\downarrow \\rangle = \\exp(i\\pi/3 )    @xmath285 into the product state @xmath655 the other two states remain entangled , @xmath656 note that the state of qubit 1 is identical in the above two wave functions ( pull out a factor @xmath657 in @xmath658 ) .",
    "rotations generating the operator @xmath495 ; shown are the rotations acting on the components @xmath659 and @xmath660 in @xmath661 and @xmath662 of qubit 1 , cf .",
    "( [ eq : u2p0 ] ) ( vectors mark the polarizations of the spin states ) .",
    "the first rotation ( a ) @xmath170 ( b ) by @xmath663 around the @xmath37-axis rotates the component @xmath664 into the @xmath405-plane .",
    "the second rotation by @xmath665 around the @xmath34-axis takes the two states symmetrically around the @xmath37-axis , cf .",
    "( b ) @xmath170 ( c ) .",
    "the subsequent two - qubit rotation @xmath666 , cf .",
    "( c ) @xmath170 ( d ) , aligns both components in the @xmath444-plane ; this step disentangles the state .",
    "the remaining rotations of qubit 1 serve to align its state along the @xmath37-axis.,width=226 ]    next , the operator @xmath495 , @xmath667 where @xmath668 , takes the remaining two entangled states @xmath662 and @xmath661 into product states , @xmath669 while leaving the product states in product states , @xmath670 the action of the ( conditional ) rotations in @xmath495 leading to the disentanglement of @xmath120 and @xmath236 is shown in fig.[fig : u1 ] .    finally , the operator @xmath496 , @xmath671 acts as a hadamard operation on the qubit 2 if the qubit 1 is in the @xmath672 state and leaves the qubit 2 unchanged if the qubit 1 is in the state @xmath673 , hence @xmath496 is a controlled hadamard .",
    "the combined action @xmath300 of the operators @xmath494 , @xmath495 , and @xmath496 finally take the counting states into the computational basis states , @xmath674 which is nothing but the desired inverse fourier transformation ( up to phases ) .",
    "p.  shor , in _ proceedings of the 35th annual symposium on foundations of computer science _ , edited by s. goldwasser ( ieee computer society press , los alamitos , ca , 1994 ) , pp . 124 - 134 ; siam j.  sci",
    ".  stat .",
    "* 26 * , 1484 ( 1997 ) ; siam rev .  *",
    "41 * , 303 ( 1999 ) .",
    "assuming a repulsive interaction , a similar setup with well energies decreasing to the left can be drawn , where the passing particle brings two adjacent levels into resonance , allowing the counter particle to tunnel between two wells ; with an appropriate fine tuning of the interaction strength and passage time , the counter particle will undergo complete tunneling between two wells . such a device is required to evolve coherently during tunneling only , but may loose its phase after each completion of the tunneling step .          a potential well of depth @xmath575 and width @xmath675 induces a time delay @xmath676 and a phase shift @xmath677 .",
    "the condition @xmath678 with the shift @xmath679 between the wave packets produces the condition @xmath680 .",
    "greenberger , m.a .",
    "horne , and a.  zeilinger , in _",
    "bell s theorem , quantum theory , and conceptions of the universe _ , edited by m.  kafatos ( kluwer , dordrecht , 1989 ) , 69 - 72 ; see also e - print arxiv:0712.0921v1 ."
  ],
  "abstract_text": [
    "<S> we generalize the binary quantum counting algorithm of lesovik , suslov , and blatter [ phys .  </S>",
    "<S> rev .  </S>",
    "<S> a * 82 * , 012316 ( 2010 ) ] to higher counting bases . </S>",
    "<S> the algorithm makes use of qubits , qutrits , and qudits to count numbers in a base 2 , base 3 , or base @xmath0 representation . in operating the algorithm , </S>",
    "<S> the number @xmath1 is read into a @xmath2-qudit register through its interaction with a stream of @xmath3 particles passing in a nearby wire ; this step corresponds to a quantum fourier transformation from the hilbert space of particles to the hilbert space of qudit states . </S>",
    "<S> an inverse quantum fourier transformation provides the number @xmath3 in the base @xmath0 representation ; the inverse transformation is fully quantum at the level of individual qudits , while a simpler semi - classical version can be used on the level of qudit registers . </S>",
    "<S> combining registers of qubits , qutrits , and qudits , where @xmath0 is a prime number , with a simpler single - shot measurement allows to find the powers of 2 , 3 , and other primes @xmath0 in the number @xmath3 . </S>",
    "<S> we show , that the counting task naturally leads to the shift operation and an algorithm based on the quantum fourier transformation . </S>",
    "<S> we discuss possible implementations of the algorithm using quantum spin-@xmath0 systems , @xmath0-well systems , and their emulation with spin-1/2 or double - well systems . </S>",
    "<S> we establish the analogy between our counting algorithm and the phase estimation algorithm and make use of the latter s performance analysis in stabilizing our scheme . </S>",
    "<S> applications embrace a quantum metrological scheme to measure a voltage ( analog to digital converter ) and a simple procedure to entangle multi - particle states . </S>"
  ]
}