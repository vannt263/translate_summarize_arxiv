{
  "article_text": [
    "this paper studies one particular solution of the linear stochastic fixed - point equation ( sfpe ) @xmath0 where @xmath1 is a real - valued vector with @xmath2 , and @xmath3 are i.i.d .",
    "random variables having the same distribution as @xmath4 .",
    "this distributional equation appears in the probabilistic analysis of algorithms and has been studied in been studied in @xcite , and its homogeneous version @xmath5 has been studied extensively in the literature of weighted branching processes and multiplicative cascades ( see , e.g. , @xcite and the references therein ) .",
    "although it is well known that has multiple solutions @xcite , it is often the case that in applications ( e.g. , @xcite ) only one of them is relevant .",
    "more precisely , we are usually interested in the solution obtained by iterating the sfpe starting from a well - behaved initial condition , which can be explicitly constructed on a weighted branching process ( as explained in section [ s.preliminaries ] ) and hence is often referred to as a special endogenous solution .",
    "we refer the interested reader to @xcite for a more thorough discussion on the existence of multiple solutions to and the role of the endogenous solution(s ) in their characterization ; in particular , the recent work in @xcite treats the case of real - valued weights @xmath6 where there may be multiple endogenous solutions .",
    "the focus of this paper is to analyze the  most attractive \" endogenous solution mentioned above both for @xmath7 and @xmath8 .",
    "in particular , we consider two different weighted branching processes and compare their corresponding special endogenous solutions in the kantorovich - rubinstein distance , @xmath9 , also known as the wasserstein distance of order one ( see , e.g. , @xcite ) .",
    "although convergence to the ( unique ) endogenous solution to for nonnegative weights has been previously studied in the context of the analysis of divide and conquer algorithms using the wasserstein distance of order two @xcite , recent applications to the analysis of information ranking algorithms @xcite where the variance of @xmath4 might be infinite , suggest the use of the weaker kantorovich - rubinstein distance .",
    "moreover , motivated by the same applications to the analysis of information ranking algorithms mentioned above , we analyze a variation of the weighted branching process constructed using a generic branching vector of the form @xmath10 , i.e. , where the weight @xmath11 of a node in the tree is allowed to depend on the node s copy of @xmath12 , rather than on its _",
    "parent s _ copy as is the case with a generic branching vector of the form @xmath1 . to avoid confusion , we will refer to this variation as a weighted branching tree .",
    "using this weighted branching tree we mimic the construction of the special endogenous solution and provide conditions under which it will be close , in the kantorovich - rubinstein distance , to the special endogenous solution to constructed on a usual weighted branching process .",
    "the main results in this paper provide explicit bounds for the kantorovich - rubinstein distance between two random variables constructed according to the representation for the special endogenous solution to ; these bounds are given in terms of the kantorovich - rubinstein distance between their generic branching vectors .",
    "we then use these bounds to obtain the convergence of a sequence of such random variables in the same distance .",
    "we illustrate the main results with applications to the analysis of random graphs and information ranking algorithms .    the remainder of the paper is organized as follows",
    ". section [ s.preliminaries ] describes the weighted branching process and its variation , the weighted branching tree .",
    "section [ s.wasserstein ] contains a brief exposition of the kantorovich - rubinstein distance and some of its main properties .",
    "section [ s.main ] contains our main results , with the explicit bounds for the kantorovich - rubinstein distance given in section [ s.coupling ] .",
    "finally , section [ s.applications ] contains applications of the main results to the analysis of random graphs and information ranking algorithms .",
    "all the proofs in the paper are postponed until section [ s.proofs ] .",
    "in order to define a weighted branching process we start by letting @xmath13 be the set of positive integers and setting @xmath14 to be the set of all finite sequences @xmath15 , @xmath16 , where by convention @xmath17 contains the null sequence @xmath18 . to ease the exposition , for a sequence @xmath19 we write @xmath20 , provided @xmath21 , and @xmath22 to denote the index truncation at level @xmath23 , @xmath24 .",
    "also , for @xmath25 we simply use the notation @xmath26 , that is , without the parenthesis .",
    "similarly , for @xmath27 we will use @xmath28 to denote the index concatenation operation , if @xmath29 , then @xmath30 .",
    "next , let @xmath1 be a real - valued vector with @xmath2",
    ". we will refer to this vector as the generic branching vector .",
    "now let @xmath31 be a sequence of i.i.d .",
    "copies of the generic branching vector . to construct a weighted branching process",
    "we start by defining a tree as follows : let @xmath32 denote the root of the tree , and define the @xmath23th generation according to the recursion @xmath33 now , assign to each node @xmath34 in the tree a weight @xmath35 according to the recursion @xmath36 see figure [ f.tree ] .",
    "note that the tree s structure , disregarding the weights , is that of a galton - watson process with offspring distribution @xmath37 , provided @xmath38 .",
    "( 350,110)(0,0 ) ( 0,0 ) ( 145,105)@xmath39 ( 30,59)@xmath40 ( 145,59)@xmath41 ( 270,59)@xmath42 ( 0,0)@xmath43 ( 62,17)@xmath44 ( 129,0)@xmath45 ( 182,17)@xmath46 ( 252,0)@xmath47 ( 318,17)@xmath48    using the same notation described above , consider now constructing this process using a generic branching vector of the form @xmath10 , with @xmath49 , and a sequence of i.i.d .",
    "copies @xmath50 . as mentioned earlier",
    ", we will refer to this construction as a weighted branching tree .",
    "the difference lies in the dependence structure that now governs the nodes in the tree , since whereas in a usual weighted branching process the weight @xmath51 of node @xmath34 is independent of @xmath52 , in a weighted branching tree it may not be .",
    "another important observation is that in a weighted branching tree the weights @xmath53 are i.i.d .",
    "random variables , unlike in a weighted branching process where the weights of  sibling \" nodes are arbitrarily dependent and not necessarily identically distributed .",
    "it follows from these observations that when @xmath11 is independent of @xmath54 , the corresponding weighted branching tree is a special case of a weighted branching process .",
    "we will now explain how to construct the special endogenous solution to the linear sfpe using a weighted branching process .      for a weighted branching process with generic branching vector @xmath1 , define the processes @xmath55 and @xmath56 as follows : @xmath57    by focusing on the branching vector belonging to the root node , i.e. , @xmath58 we can see that the processes @xmath59 and @xmath60 satisfy the distributional equations @xmath61 and @xmath62 where @xmath63 are i.i.d .",
    "copies of @xmath64 and @xmath65 are i.i.d .",
    "copies of @xmath66 , all independent of @xmath1 .",
    "here and throughout the paper the convention is that @xmath67 if @xmath68",
    ".    for the homogeneous case ( @xmath7 in ) , assume the weights @xmath6 are nonnegative and redefine the @xmath59 process as @xmath69 in this case , and provided @xmath70 < \\infty$ ] , the process @xmath71",
    ", @xmath72 , defines a nonnegative martingale .",
    "it follows that @xmath73 converges almost surely , as @xmath74 , to a finite limit @xmath75 with @xmath76 \\leq 1 $ ] .",
    "taking the limit as @xmath74 in then gives that @xmath75 satisfies @xmath77 where the @xmath78 are i.i.d .",
    "copies of @xmath75 , independent of @xmath79 .",
    "hence , @xmath75 is a solution to the homogeneous version of with the generic branching vector @xmath80 .",
    "for the nonhomogeneous case @xmath81 ) , one can argue , as was done in @xcite , that provided @xmath82 < 1 $ ] and @xmath83 < \\infty$ ] for some @xmath84 , then the random variable @xmath85 converges almost surely , as @xmath86 , to a finite limit @xmath4 . taking the limit as @xmath86 in",
    "gives that @xmath4 is a solution to .",
    "we refer to the random variables @xmath75 and @xmath4 described above as the special endogenous solutions to in the homogeneous and nonhomogeneous cases , respectively .",
    "we point out that in the case of nonnegative weights , @xmath75 and @xmath4 are the unique endogenous solutions to , whereas in the real - valued case there can be other endogenous solutions , i.e. , that can be explicitly constructed using a weighted branching process ( see @xcite for more details ) .",
    "before proceeding to the main results in the paper we give a brief description of the kantorovich - rubinstein distance .",
    "this distance on the space of probability measures is also known as the minimal @xmath87 metric or the wasserstein distance of order one . for the purposes of this paper ,",
    "we consider the vector space of infinite real sequences @xmath88 having finite @xmath87 norm , i.e. , @xmath89 such that @xmath90 on some occasions , which will become clear from the context , we will work with elements of @xmath91 instead .",
    "the norm @xmath92 will always refer to the corresponding @xmath87 norm .",
    "[ d.wasserstein ] let @xmath93 denote the set of joint probability measures on @xmath94 ( @xmath95 or @xmath96 ) with marginals @xmath97 and @xmath98 .",
    "then , the kantorovich - rubinstein distance between @xmath97 and @xmath98 is given by @xmath99    we point out that @xmath9 is only strictly speaking a distance when restricted to the subset of probability measures @xmath100 where @xmath101 is the set of borel probability measures on @xmath102 .",
    "we refer the interested reader to @xcite for a thorough treatment of this distance , since definition [ d.wasserstein ] is only a special case .    any construction on the same probability space of the joint vector @xmath103 , where @xmath104 has distribution @xmath97 and @xmath105 has distribution @xmath98 , is called a _ coupling _ of @xmath97 and @xmath98 . in this notation",
    "we can rewrite @xmath9 as @xmath106,\\ ] ] where the infimum is taken over all couplings of @xmath97 and @xmath98 .",
    "it is well known that @xmath9 is a metric on @xmath107 and that the infimum is attained , or equivalently , that an optimal coupling @xmath103 such that @xmath108\\ ] ] always exists ( see , e.g. , @xcite , theorem 4.1 or @xcite , lemma 8.1 ) .",
    "this optimal coupling , nonetheless , is not in general explicitly available .",
    "one noteworthy exception is when @xmath97 and @xmath98 are probability measures on the real line , in which case we have that @xmath109 where @xmath110 and @xmath111 are the cumulative distribution functions of @xmath97 and @xmath98 , respectively , and @xmath112 denotes the pseudo - inverse of @xmath113 .",
    "it follows that the optimal coupling is given by @xmath114 for @xmath115 uniformly distributed in @xmath116 $ ] .",
    "another important property of the kantorovich - rubinstein distance is that the convergence in @xmath9 to a limit @xmath117 is equivalent to weak convergence plus convergence of the first moments .",
    "furthermore , it satisfies the useful * duality formula * : @xmath118 for all @xmath119 , where the supremum is taken over all lipschitz continuous functions @xmath120 with lipschitz constant one ( see remark 6.5 in @xcite ) .",
    "the paper contains two sets of results ; the first one provides explicit bounds for the kantorovich - rubinstein distance between two versions of the processes @xmath121 ( as defined by ) constructed on weighted branching processes , respectively weighted branching trees , using different generic branching vectors .",
    "these bounds are given in terms of the kantorovich - rubinstein distance between the two generic branching vectors .",
    "the second set of results apply the explicit bounds to a sequence of processes @xmath122 and @xmath123 for @xmath124 , to obtain the convergence in the kantorovich - rubinstein distance to the special endogenous solution to constructed on a limiting weighted branching process .",
    "let @xmath121 and @xmath125 be defined according to on two different weighted branching processes using the generic branching vectors @xmath1 and @xmath126 , respectively . as our result will show , it is enough to consider generic branching vectors of the form @xmath127 and @xmath128 where @xmath129 and @xmath130 for all @xmath131 .",
    "let @xmath97 denote the probability measure of @xmath127 and let @xmath132 denote the probability measure of @xmath128 . using @xmath133",
    ", we assume throughout the paper that @xmath134 < \\infty \\quad \\text{and } \\quad \\int_{\\mathbb r^{\\infty } } \\| { \\bf x } \\|_1 d\\hat \\mu ( { \\bf x})=e\\left [ |\\hat q| + \\sum_{i=1}^{\\infty}|\\hat{b}_i| \\right ] < \\infty.\\ ] ]    to construct the two processes on the same probability space , let @xmath135 denote any coupling of @xmath97 and @xmath132 and let @xmath136 be a sequence of i.i.d .",
    "random vectors distributed according to @xmath135 .",
    "then , use the vectors @xmath137 to construct @xmath121 , as described in section [ s.preliminaries ] , and the vectors @xmath138 to construct @xmath139 .",
    "our first result is stated below .",
    "we use the convention that @xmath140 if @xmath141 , and the notation @xmath142 $ ] to denote the expectation taken with respect to the coupling @xmath135 ; we also use @xmath143 and @xmath144 to denote the minimum and the maximum of @xmath145 and @xmath146 , respectively , and @xmath147 .",
    "[ p.couplingwbp ] for any coupling @xmath135 of @xmath97 and @xmath132 , and any @xmath72 , @xmath148\\le\\left(\\hat\\rho^{j } +   e[|q| ] \\sum_{t=0}^{j-1}\\rho^t\\hat\\rho^{j-1-t}\\right ) \\mathcal{e},\\ ] ] where @xmath149 $ ] , @xmath150 $ ] and @xmath151.$ ]    we point out that the bound provided by proposition [ p.couplingwbp ] is also a bound for the kantorovich - rubinstein distance between @xmath152 and @xmath153 , and if we take @xmath135 to be the optimal coupling of @xmath97 and @xmath132 then we have @xmath154 .",
    "it is also worth mentioning that if we let @xmath98 and @xmath155 be the probability measures of @xmath1 and @xmath126 , respectively , and assume that @xmath156 < \\infty$ ] , then @xmath157 can be small even if @xmath158 is not .",
    "this is due to the observation that , in general , large disagreements between @xmath159 and @xmath160 for values of @xmath161 for which @xmath162 and @xmath163 are negligible do not affect @xmath157 , whereas they do adversely affect @xmath158 .    our next result provides a similar bound for the case when @xmath152 and @xmath153 are constructed on weighted branching trees using the generic branching vectors @xmath164 and @xmath10 , respectively . as before , let @xmath155 and @xmath98 denote the probability measures of @xmath164 and @xmath10 .",
    "we allow the coupling used for the root nodes to be different than all other nodes , i.e. , the two trees are constructed using the sequence of i.i.d .",
    "vectors @xmath165 distributed according to a coupling @xmath135 of @xmath98 and @xmath155 , while @xmath166 is independent of the previous sequence and is distributed according to a coupling @xmath167 of @xmath168 and @xmath169 , where @xmath168 is the probability measure of @xmath12 and @xmath169 is that of @xmath170 .",
    "we have ignored @xmath171 and @xmath172 since they do not appear in the definitions of @xmath153 and @xmath152 .",
    "[ p.couplingwbt ] for any coupling @xmath135 of @xmath98 and @xmath155 and any coupling @xmath167 of @xmath168 and @xmath169 , @xmath173 \\leq   \\mathcal{e}^*\\ ] ] and for @xmath174 , @xmath175 \\leq   \\left ( e[\\hat n ] \\vee \\frac{e[n ] e[|cq|]}{\\rho } \\right ) \\left ( \\sum_{t=0}^{j-1 } \\hat \\rho^t \\rho^{j-1-t } \\right ) \\mathcal{e } + e[|q| ] \\hat \\rho^{j-1 } \\mathcal{e}^*,\\ ] ] where @xmath176 $ ] , @xmath177 $ ] , @xmath178 \\quad \\text{and } \\quad \\mathcal{e } = e_\\pi \\left [ |\\hat c \\hat q - cq| +   \\sum_{i=1}^\\infty |\\hat c 1(\\hat n \\geq i ) - c 1 ( n \\geq i ) | \\right ] .\\end{aligned}\\ ] ]      our second set of results considers a sequence of weighted branching processes ( respectively , weighted branching trees ) , each constructed using a generic branching vector having probability measure @xmath179 , @xmath180 . in other words , for weighted branching processes , @xmath179 is the probability measure of a vector of the form @xmath181 , while for weighted branching trees it corresponds to a vector of the form @xmath182 . on each of them",
    "we define the processes @xmath122 and @xmath123 according to and , and we are interested in providing conditions under which @xmath183 ( suitably scaled ) and @xmath184 will converge , as @xmath185 go to infinity , to the special endogenous solution of a linear sfpe of the form in .    the main conditions for the convergence we seek will be in terms of the sequence of probability measures @xmath186 , where @xmath187 is the probability measure of the vector @xmath188 for weighted branching processes , and of @xmath189 for weighted branching trees .    in both cases , we assume that there exists a probability measure @xmath97 such that @xmath190 .",
    "we point out that for a weighted branching process , @xmath97 is always the probability measure of a generic branching vector , since each of the @xmath187 is . however , this is not necessarily the case for a weighted branching tree , and we need to further assume that there exist probability measures @xmath191 on @xmath192 and @xmath193 on @xmath194 such that @xmath195 for all functions @xmath196",
    ". we can then identify @xmath191 with the probability distribution of @xmath11 and @xmath193 with the probability distribution of the vector @xmath197 , which fully determines @xmath54 . with this interpretation ,",
    "the limiting measure @xmath97 defines a weighted branching process with a generic branching vector of the form @xmath1 with the @xmath198 i.i.d .  and independent of @xmath12",
    "; condition implies that @xmath199 < \\infty$ ] .",
    "we refer to the case where we analyze a sequence of weighted branching processes as _",
    "case  1 _ , and to the case where we analyze a sequence of weighted branching trees as _ case  2_. for _ case  2",
    "_ , in addition to the measure @xmath187 defined above , we define @xmath200 to be the probability measure of the vector @xmath201 and @xmath168 to be the probability measure of @xmath12 .",
    "the symbol @xmath202 denotes convergence in distribution and @xmath203 denotes convergence in the kantorovich - rubinstein distance .",
    "[ t.mainhomo ] define the processes @xmath122 , @xmath180 , and @xmath121 according to .",
    "suppose that as @xmath204 , @xmath205 then , for any fixed @xmath206 @xmath207 moreover , if @xmath208 , and @xmath209 are nonnegative for all @xmath23 and @xmath210 , then for any @xmath211 such that @xmath212 and @xmath213 as @xmath204 , we have @xmath214 where @xmath215 is the a.s . limit of @xmath216 as @xmath74 .    as pointed out in section [ s.endogenoussol ] , @xmath215 is the unique endogenous solution to the sfpe @xmath217 where the @xmath218 are i.i.d .",
    "copies of @xmath215 , independent of @xmath79 .",
    "see @xcite for conditions on when the random variable @xmath219 , which satisfies @xmath220 \\leq 1 $ ] , is non - trivial , as well as characterizations of its tail behavior .",
    "furthermore , when @xmath221 = 1 $ ] we can replace the convergence in distribution with convergence in the kantorovich - rubinstein distance , i.e. , @xmath222    we now give a similar result for the nonhomogeneous equation .    [ t.mainnonhomo ] define the processes @xmath123 , @xmath180 , and @xmath223 according to .",
    "suppose that as @xmath204 , @xmath205 then , for any fixed @xmath224 , @xmath225 moreover , if @xmath226 , then for any @xmath227 such that @xmath228 as @xmath204 , we have @xmath229 where @xmath230 is the a.s . limit of @xmath85 as @xmath86 .    in the statement of the theorem , provided @xmath231 , @xmath4 is the unique endogenous solution to the sfpe @xmath232 where the @xmath233 are i.i.d .",
    "copies of @xmath4 , independent of @xmath1 .",
    "moreover , the asymptotic behavior of @xmath234 as @xmath235 can be described for several different assumptions on the generic vector @xmath1 .",
    "we refer the reader to @xcite and @xcite for the precise set of theorems .",
    "note that in _ case 1 _ , the convergence of @xmath184 as @xmath86 for a fixed @xmath23 is guaranteed whenever @xmath236 < 1 $ ] for some @xmath84 ( see lemma 4.1 in @xcite ) , and its limit , @xmath237 would be the unique endogenous solution to @xmath238 for _ case 2 _ , on the other hand , an adaptation of the proof of lemma 4.1 in @xcite would give that @xmath184 converges a.s .",
    "to @xmath239 as @xmath86 , with @xmath237 finite a.s . , provided @xmath240 < 1 $ ] for some @xmath84",
    "however , this random variable @xmath237 would not necessarily have the interpretation of being a solution to .",
    "we end this section with a result for the weighted branching tree setting that states that @xmath241 converges to zero whenever @xmath242 and the moments of @xmath243 and @xmath244 do .",
    "[ l.finalconditionswbt ] for _ case 2 _ , suppose that as @xmath204 , @xmath245 , @xmath246 \\to e[|cq|]$ ] and @xmath247 \\to e[|c|n]$ ]",
    ". then , @xmath248",
    "as mentioned in the introduction , our interest in analyzing the processes @xmath249 and @xmath250 when they are constructed on a weighted branching tree , rather than a weighted branching process , comes from applications to the analysis of random graphs and information ranking algorithms .",
    "this section provides two examples in which an application of the main results in section [ s.main ] lead to the special endogenous solution to .",
    "our first example is related to the analysis of ranking algorithms on directed graphs . in particular , we are interested in studying the distribution of the ranks produced by spectral ranking algorithms , e.g. , google s pagerank , used to rank webpages on the world wide web .",
    "more precisely , the recent work in @xcite considers a sequence of random graphs constructed according to the directed configuration model @xcite and shows that the rank of a randomly chosen node can be coupled with a random variable @xmath251 ( of the form in and built on a weighted branching tree ) where the @xmath23 refers to the number of nodes in the graph .",
    "an application of a version of theorem [ t.mainnonhomo ] then leads to the rank of a randomly chosen node having a representation in terms of the special endogenous solution to , as defined in section [ s.endogenoussol ] , as the number of nodes in the graph grows to infinity .    before stating the precise version of theorem  [ t.mainnonhomo ] that is needed in this application it will be helpful to give some details about the configuration model . the configuration or pairing model (",
    "see , e.g. , @xcite ) , produces a random graph from a given degree sequence by assigning to each node a number of half - edges equal to its degree and then randomly pairing the half - edges to form a graph .",
    "similarly , the directed configuration model generates a directed graph from a given bi - degree sequence ( sequence of in - degrees and out - degrees ) . in both cases ,",
    "the resulting graph , conditional on it not having self - loops or multiple edges , is a graph uniformly chosen at random from all simple graphs having that degree ( bi - degree ) sequence .",
    "we observe that given the degree sequence(s ) , the randomness in the graph comes from the pairing process , so it makes sense that in applications one often works on the conditional probability space given the degree sequence(s ) .",
    "it is due to this last observation that in order to obtain the convergence of the rank of a randomly chosen node on a directed configuration model one needs to apply theorem  [ t.mainnonhomo ] conditionally on the sigma - algebra generated by the bi - degree sequence .",
    "other random graph models , e.g. , the generalized random graph @xcite , require conditioning on a  weight \" sequence . moreover , the analysis of problems related to the configuration model in general ( directed or undirected ) often relies on a coupling with a weighted branching tree where the root node has a different distribution , hence the need to further tailor the theorem .",
    "in order to state a suitable theorem for the analysis of spectral algorithms on random graphs , we first need to introduce some additional notation .",
    "we consider a sequence of sigma - algebras generated by a finite set of random variables / vectors ( e.g. , the degree sequences ) .",
    "next , for each @xmath180 , and conditionally on @xmath252 , we construct a weighted branching tree using the generic branching vector @xmath182 , whose ( conditional ) probability measure we denote by @xmath179 .",
    "moreover , we allow the root branching vector , @xmath253 to have a different ( conditional ) distribution , say having a probability measure @xmath200 . in other words , the @xmath23th weighted branching tree is constructed , conditionally on @xmath252 , using the sequence of conditionally i.i.d .",
    "vectors @xmath254 distributed according to @xmath179 , and @xmath253 is conditionally independent of this sequence and is distributed according to @xmath200 .",
    "note that unconditionally , the @xmath179 and @xmath200 are random elements of @xmath255 and @xmath256 , respectively ( e.g. , the empirical measures constructed from the degree sequences ) .    in the statement of the theorem below , we assume that @xmath98 and @xmath168 are the probability measures of the vectors @xmath10 and @xmath257 , respectively , with @xmath11 independent of @xmath12 , i.e. , the limiting weighted branching tree is a delayed weighted branching process .",
    "the measures @xmath98 and @xmath168 are fixed elements of @xmath255 and @xmath256 , respectively , and hence are independent of @xmath252 . the symbol @xmath258 denotes convergence in probability .",
    "[ t.mainwbtext ] conditionally on @xmath252 , define the processes @xmath259 , @xmath180 , according to .",
    "similarly , define @xmath223 .",
    "suppose that as @xmath204 , @xmath260 then for any fixed @xmath261 @xmath262 moreover , if @xmath263e[|c| ] < 1 $ ] , then for any @xmath227 such that @xmath228 as @xmath204 , we have @xmath264 where @xmath265 is the a.s . limit of @xmath85 as @xmath86 .",
    "\\(i ) because we allow @xmath168 to be different than @xmath98 , the random variable @xmath266 appearing in the limit can be written as @xmath267 where the @xmath233 are i.i.d .",
    "copies of the special endogenous solution @xmath4 to the linear sfpe , independent of @xmath58 , and with the @xmath6 i.i.d .  and independent of @xmath257 .",
    "in other words , @xmath266 is a linear combination of i.i.d .",
    "copies of the special endogenous solution to .",
    "\\(ii ) no restrictions need to be imposed on @xmath168 , besides @xmath268 , since @xmath171 does not appear in the definitions of @xmath153 and @xmath85 .",
    "\\(iii ) an important observation is that we have replaced the convergence in the kantorovich - rubinstein distance in theorem [ t.mainnonhomo ] with weak convergence , this is due to the fact that the proof of theorem  [ t.mainwbtext ] requires that we apply proposition [ p.couplingwbt ] conditionally on @xmath252 , which if done directly starting with @xmath269 $ ] would lead to having to compute all the moments of @xmath270 $ ] , which in general may not even be finite",
    ". therefore , proposition [ p.couplingwbt ] needs to be used after having guaranteed that @xmath271 is sufficiently close to @xmath272 , hence the weaker mode of convergence .",
    "\\(iv ) the previous remark also implies that if @xmath273 a.s .",
    ", then the weak convergence in theorem  [ t.mainwbtext ] can be replaced by convergence in the kantorovich - rubinstein sense .",
    "our second example is also related to the analysis of random graphs . as mentioned earlier , when analyzing the properties of random graphs , e.g. , connectivity , existence of a giant component , typical distances , phase transitions , etc .",
    ", one of the basic techniques consists in coupling a  graph exploration process \" with a branching process .",
    "this is true for the configuration model ( directed or undirected ) as well as for other random graph models such as the erds - rnyi graph or the generalized random graph . in line with our previous example for the analysis of ranking algorithms",
    ", we show an application of theorem [ t.mainhomo ] that can be used for analyzing the properties of the configuration model .",
    "consider an undirected graph with @xmath23 nodes generated according to the configuration model . in @xcite",
    "the authors provide an asymptotic characterization , as @xmath204 , of the hop count ( length of the shortest path ) between two randomly chosen nodes in the graph .",
    "in particular , they show that conditional on the two nodes belonging to the same component , this distance grows logarithmically in @xmath23 . the main step of the proof consists in coupling a breadth - first exploration process , where starting from a randomly chosen node we sequentially uncover all nodes at distance one , then those at distance two , etc . , with a delayed branching process ( galton - watson process ) .",
    "this delayed branching process , as in our previous example , is constructed conditionally on the sigma - algebra @xmath252 generated by the degree sequence .",
    "if we denote by @xmath274 be number of individuals in the @xmath210th generation of the coupled branching process ( obtained by setting @xmath275 for all @xmath276 in ) , then the goal is to show that @xmath277)^j$ ] converges to a limit as @xmath278 .",
    "the following version of theorem  [ t.mainhomo ] provides such limit ; here @xmath179 denotes the random probability measure of the conditionally i.i.d .",
    "random variables @xmath279 and @xmath200 denotes that of @xmath280 .    [ t.mainwbthomo ] suppose there exist probability measures @xmath98 and @xmath168 such that @xmath281 as @xmath204 .",
    "let @xmath274 , @xmath180 , be the ( delayed ) branching process defined by the sequence @xmath282 , and let @xmath283 be the one defined using @xmath284 .",
    "then , there exists a coupling of @xmath285 and @xmath283 such that for any @xmath211 satisfying @xmath286 we have that @xmath287 as @xmath204 , where @xmath288 $ ] , @xmath289 $ ] , @xmath290 $ ] , and @xmath291 $ ] .",
    "in particular , theorem [ t.mainwbthomo ] can be used to obtain that @xmath292 where @xmath215 is the a.s .",
    "limit of the martingale @xmath293 as @xmath74 .",
    "our last result in the paper shows how large we can take @xmath294 in theorem [ t.mainwbthomo ] when analyzing the configuration model using a degree sequence @xmath295 of i.i.d .",
    "random variables having common probability mass function @xmath113 , a model used in @xcite to analyze the typical distance between nodes in the graph . in this context ,",
    "@xmath296 , @xmath297 and @xmath298 with @xmath299 .",
    "the measure @xmath179 corresponds to the so - called _ size - biased _ empirical distribution .",
    "the limiting probability measures are given by @xmath300}{e[d ] } , \\qquad k = 0 , 1 , 2 , \\dots,\\ ] ] where @xmath301 is distributed according to @xmath113 .",
    "[ l.sizebiased ] suppose that @xmath302 < \\infty$ ] for some @xmath303 , then @xmath304 for any @xmath305 and @xmath306 .",
    "this last section contains the proofs of all the results presented throughout the paper . for the reader s convenience they are organized according to the section in which their statements appear .",
    "we first prove proposition [ p.couplingwbp ] , which bounds the kantorovich - rubinstein distance of the linear processes on two coupled weighted branching processes , by the same distance of their generic branching vectors .",
    "define @xmath307 $ ] , where the vector @xmath308 is distributed according to @xmath135 . recall that the weights @xmath35 and @xmath309 follow the recursions @xmath310 with @xmath311 .",
    "now note that for @xmath312 we have @xmath313 = { e } \\left [ \\left| \\hat q- q\\right| \\right ] \\leq \\mathcal{e}.\\ ] ] to analyze the expression for @xmath174 , define for @xmath314 , @xmath315 and @xmath316 .",
    "we then have @xmath317 next , note that @xmath318 & \\leq \\sum_{r=1}^{\\infty }    e \\left [ \\left| \\hat b_r \\hat w^{(j-1)}_r - b_r w^{(j-1)}_{r}\\right| \\right ]   \\\\              & \\leq \\sum_{r = 1}^\\infty   \\left\\ {   e \\left [ \\left| w^{(j-1)}_{r}(\\hat b_r - b_r)\\right|+\\left|\\hat b_r\\left(\\hat w^{(j-1)}_{r } - w^{(j-1)}_{r}\\right)\\right| \\right ] \\right\\ } \\\\      & \\leq \\sum_{r = 1}^\\infty e\\left [ \\left|\\hat b_r - b_r\\right| \\right ] e",
    "\\left [ \\left| w^{(j)}_{r}\\right|\\right]+ \\sum_{r = 1}^\\infty e\\left [ |\\hat b_r| \\right]e\\left[\\left|\\hat w^{(j)}_{r } - w^{(j)}_{r}\\right|\\right ] \\\\      & \\leq    e\\left [ \\left| w^{(j-1 ) } \\right|\\right ] \\mathcal{e } + \\hat\\rho e\\left[\\left|\\hat w^{(j-1 ) } - w^{(j-1 ) } \\right|\\right ] , \\end{aligned}\\ ] ] where we used the independence of the root vectors and their offspring , the observation that the random variables @xmath319 are i.i.d .  with the same distribution as @xmath64 and @xmath320",
    "are i.i.d .  with the same distribution as @xmath321 .",
    "moreover , @xmath322\\le e\\left[\\left|q\\right|\\right]\\sum_{\\mathbf{i}\\in \\mathbb{n}_+^{j-1}}e\\left [ \\left|\\pi_{\\mathbf{i}}\\right| \\right]=e\\left[\\left|q\\right|\\right ] \\rho^{j-1}.\\ ] ] it follows that @xmath318&\\le e\\left[\\left|q\\right|\\right]\\rho^{j-1 } \\mathcal{e } + \\hat\\rho { e } \\left [ \\left| \\hat w^{(j-1 ) } - w^{(j-1 ) } \\right| \\right ] \\quad \\text{after $ ( j-1)$ iterations}\\\\      & \\le \\left(\\hat\\rho^j + e\\left [ \\left|q\\right| \\right]\\sum_{t=0}^{j-1 } \\rho^t\\hat \\rho^{j-1-t}\\right ) \\mathcal{e}.\\end{aligned}\\ ] ] this completes the proof .",
    "similarly we can prove an upper bound for weighted branching trees .",
    "we construct the processes @xmath152 and @xmath153 on two weighted branching trees using a coupled vector @xmath323 for the root nodes @xmath18 , distributed according to @xmath167 , and a sequence of i.i.d .",
    "random vectors @xmath324 , independent of @xmath325 , distributed according to @xmath135 for all other nodes .    next , for @xmath326 , @xmath327 , let @xmath328 , @xmath329 , @xmath330 , and @xmath331 , for @xmath174 , and note that @xmath332 and similarly , @xmath333 with the convention that @xmath334 if @xmath141 .",
    "let @xmath335 $ ] , where @xmath336 is distributed according to @xmath167 , and @xmath337 $ ] , where @xmath338 is distributed according to @xmath135 .",
    "it follows that @xmath313 = e_{\\pi^ * } \\left [ \\left| \\hat q - q \\right| \\right ] \\leq \\mathcal{e}^*,\\ ] ] and for @xmath174 , @xmath339 & = e\\left [ \\left|   \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } 1(i_1 \\leq \\hat n_\\emptyset ) \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{{\\bf i}|r } \\hat b^{(0)}_{\\bf i } - \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } 1(i_1 \\leq n_\\emptyset ) \\prod_{r = 1}^{j-1 } b^{(i_{r+1})}_{{\\bf i}|r } b^{(0)}_{\\bf i }    \\right| \\right ] \\\\ & \\leq \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } e\\left [ \\left| 1(i_1 \\leq \\hat n_{\\emptyset } ) \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{{\\bf i}|r } \\left ( \\hat b^{(0)}_{\\bf i } -   b^{(0)}_{\\bf i } \\right )   \\right| \\right ] \\\\ & \\hspace{5 mm } + \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } e\\left [ \\left| \\left ( 1(i_1 \\leq \\hat n_{\\emptyset } ) - 1(i_1 \\leq   n_\\emptyset )   \\right )   \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{{\\bf i}|r }   b^{(0)}_{\\bf i }    \\right| \\right ] \\\\ & \\hspace{5 mm } + \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } e\\left [ \\left| 1(i_1 \\leq n_{\\emptyset } ) \\left (   \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{{\\bf i}|r }   - \\prod_{r = 1}^{j-1 } b^{(i_{r+1})}_{{\\bf i}|r } \\right ) b^{(0)}_{\\bf i }    \\right| \\right ] \\\\ & = \\sum_{{\\bf i } \\in \\mathbb{n}_+^j }   p(\\hat n \\geq i_1 ) \\prod_{r=1}^{j-1 } e\\left [ |\\hat c| 1 ( \\hat n \\geq i_{r+1 } )   \\right ]   e_\\pi \\left [ |\\hat b^{(0 ) } - b^{(0)}| \\right ] \\\\ & \\hspace{5 mm } + \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } e_{\\pi^ * } \\left[\\left| 1(i_1 \\leq \\hat n ) - 1(i_1 \\leq n ) \\right| \\right ] \\prod_{r=1}^{j-1 } e\\left [ |\\hat c| 1 ( \\hat n \\geq i_{r+1 } )   \\right ] e\\left [ |cq | \\right ] \\\\ & \\hspace{5 mm } +   \\sum_{{\\bf i } \\in \\mathbb{n}_+^j } p(n \\geq i_1 ) e\\left [ \\left|   \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{{\\bf i}|r }   - \\prod_{r = 1}^{j-1 } b^{(i_{r+1})}_{{\\bf i}|r }     \\right| \\right ] e[|cq|],\\end{aligned}\\ ] ] where we have used the independence among the generic branching vectors of the weighted branching trees . moreover , @xmath340 = \\sum_{i=1}^\\infty p(\\hat",
    "n \\geq i ) \\left ( \\sum_{k=1}^\\infty e\\left [ |\\hat c| 1(\\hat n \\geq k ) \\right ] \\right)^{j-1 }   = e[\\hat n ] \\hat \\rho^{j-1},\\ ] ] where @xmath341 $ ] .",
    "similarly , @xmath342   = \\sum_{i=1}^\\infty e_{\\pi^ * } \\left [ 1(n < i \\leq \\hat",
    "1(\\hat n < i \\leq n ) \\right ] = e_{\\pi^ * } \\left [ |\\hat n - n| \\right].\\ ] ]    it follows that @xmath339 & \\leq e[\\hat n ] \\hat \\rho^{j-1 } e_\\pi \\left [ |\\hat b^{(0 ) } - b^{(0)}| \\right ]   + e[|cq| ]    \\hat \\rho^{j-1 }   e_{\\pi^ * } \\left [ |\\hat n - n| \\right ]   \\\\ & \\hspace{5 mm } + e[n ] e[|cq| ] \\sum_{(i_2 , i_3,\\dots , i_j ) \\in \\mathbb{n}_+^{j-1 } } e\\left [ \\left|   \\prod_{r = 1}^{j-1 } \\hat b^{(i_{r+1})}_{(1,i_2 , \\dots , i_r ) }   - \\prod_{r = 1}^{j-1 } b^{(i_{r+1})}_{(1,i_2 , \\dots , i_r ) }     \\right| \\right].\\end{aligned}\\ ] ] to analyze the last expectation let @xmath343 $ ] for @xmath344 , and @xmath345 .",
    "it follows that for @xmath344 , @xmath346 \\\\ & \\hspace{5 mm } + \\sum_{(i_2 , i_3,\\dots , i_j ) \\in \\mathbb{n}_+^{j-1 } } e\\left [ \\left| \\prod_{r = 1}^{j-2 } b^{(i_{r+1})}_{(1,i_2 , \\dots , i_r ) } \\right| \\left|   \\hat b_{(1,i_2 , \\dots , i_{j-1})}^{(i_j ) }   -   b^{(i_{j})}_{(1,i_2 , \\dots , i_{j-1 } ) }     \\right| \\right ] \\\\ & = a_{j-1 } \\sum_{i_j = 1}^\\infty e\\left [ |\\hat c| 1(\\hat n \\geq i_j )   \\right ] + \\sum_{(i_2 , i_3,\\dots , i_j ) \\in \\mathbb{n}_+^{j-1 } } \\prod_{r=1}^{j-2 } e\\left [ |c| 1(n \\geq i_{r+1 } ) \\right ] e_\\pi \\left [ \\left| \\hat b^{(i_j ) } - b^{(i_j ) } \\right| \\right ] \\\\ & = \\hat \\rho \\ , a_{j-1 } + \\rho^{j-2 } \\sum_{i=1}^\\infty e_\\pi \\left [ \\left| \\hat b^{(i ) } - b^{(i ) } \\right| \\right],\\end{aligned}\\ ] ] where @xmath347 $ ] .",
    "iterating this recursion @xmath348 times gives @xmath349 = \\sum_{t = 0}^{j-2 } \\hat \\rho^t \\rho^{j-2-t } \\sum_{i=1}^\\infty e_\\pi \\left [ \\left| \\hat b^{(i ) } - b^{(i ) } \\right| \\right ] .\\ ] ]    we conclude that for @xmath174 , @xmath339 & \\leq e[\\hat n ] \\hat \\rho^{j-1 } e_\\pi \\left [ |\\hat b^{(0 ) } - b^{(0)}| \\right ]   + e[|cq| ]    \\hat \\rho^{j-1 }   e_{\\pi^ * } \\left [ |\\hat n - n| \\right ]   \\\\ & \\hspace{5 mm } + 1(j \\geq 2 ) e[n ] e[|cq| ] \\sum_{t = 0}^{j-2 } \\hat \\rho^t \\rho^{j-2-t } \\sum_{i=1}^\\infty e_\\pi \\left [ \\left| \\hat b^{(i ) } - b^{(i ) } \\right| \\right ] \\\\ & \\leq \\left ( e[\\hat n ] \\vee \\frac{e[n ] e[|cq|]}{\\rho } \\right ) \\left ( \\sum_{t=0}^{j-1 } \\hat \\rho^t \\rho^{j-1-t } \\right ) \\mathcal{e } + e[|cq| ]    \\hat \\rho^{j-1 } \\mathcal{e}^*.\\end{aligned}\\ ] ]      we now proceed to prove the two main theorems of the paper , theorems [ t.mainhomo ] and [ t.mainnonhomo ] .",
    "_ case 1 : _ weighted branching processes .",
    "choose a coupling @xmath135 of @xmath187 and @xmath97 such that @xmath350 = d_1(\\mu,\\mu_n)$ ] .",
    "if we construct both wbps based on this optimal coupling , then by proposition  [ p.couplingwbp ] , @xmath351 & \\le   \\left(\\rho_n^{j } + e\\left [ \\left|q\\right| \\right]\\sum_{t=0}^{j-1}\\rho^t\\rho_n^{j-1-t}\\right)d_1(\\mu,\\mu_n ) \\\\          & \\leq ( e[|q| \\vee \\rho ) ( j+1 ) \\rho^{j-1 } \\left ( 1 \\vee \\frac{\\rho_n}{\\rho } \\right)^j d_1(\\mu,\\mu_n ) .",
    "\\end{aligned}\\ ] ]    for fixed @xmath174 note that @xmath352 , and hence @xmath353 as @xmath204 , which in turn implies that @xmath354\\to 0 $ ] .",
    "assume now @xmath208 , and @xmath355 are nonnegative for all @xmath356 ; suppose @xmath212 and @xmath357 as @xmath204 .",
    "first note that @xmath358 is a mean one nonnegative martingale with respect to the filtration generated by @xmath359 , @xmath360 .",
    "therefore , @xmath361 & \\leq   e\\left [ \\frac{1}{\\rho_n^{j_n}}\\left|w^{(n , j_n ) } - w^{(j_n ) } \\right|   \\right]+e\\left [ \\frac{w^{(j_n)}}{\\rho^{j_n } } \\left| \\left(\\frac{\\rho}{\\rho_n}\\right)^{j_n}-1 \\right|   \\right ] \\\\ &",
    "\\leq \\frac{(1 \\vee \\rho)}{\\rho } ( j_n+1 ) \\left(\\frac{\\rho}{\\rho_n } \\right)^{j_n } \\left ( 1 \\vee \\frac{\\rho_n}{\\rho } \\right)^{j_n } d_1(\\mu,\\mu_n ) + \\left| \\left(\\frac{\\rho}{\\rho_n}\\right)^{j_n}-1 \\right| \\\\ &",
    "\\leq   \\frac{(1\\vee \\rho)}{\\rho } ( j_n+1 )   e^{j_n(\\rho/\\rho_n-1)^+ } d_1(\\mu,\\mu_n ) + j_n \\left| \\frac{\\rho}{\\rho_n } - 1 \\right| e^{(j_n-1 ) ( \\rho/\\rho_n - 1)^+},\\end{aligned}\\ ] ] where in the last step we used the inequalities @xmath362 since @xmath363 as @xmath204 , then so does @xmath364 as @xmath204 , and we conclude that the expected value converges to zero . since by the martingale convergence theorem @xmath365 almost surely , then @xmath366 if @xmath221 = 1 $ ] then @xmath367 \\to 0 $ ] and we can replace the convergence in distribution to convergence in the kantorovich - rubinstein distance .",
    "the last statement of the theorem for weighted branching processes follows from noting that @xmath368 & \\leq    \\left| \\frac{1}{\\rho^j } - \\frac{1}{\\rho_n^j } \\right| e\\left [ |w^{(n , j)}| \\right ] + e\\left [ \\left| \\frac{w^{(n , j_n ) } } { \\rho_n^{j_n } } - \\frac{w^{(j_n)}}{\\rho^{j_n } } \\right| \\right ] \\\\ & = \\left| \\left(\\frac{\\rho}{\\rho_n}\\right)^{j}-1 \\right| + e\\left [ \\left| \\frac{w^{(n , j_n ) } } { \\rho_n^{j_n } } - \\frac{w^{(j_n)}}{\\rho^{j_n } } \\right| \\right],\\end{aligned}\\ ] ] which were already shown to converge to zero for all @xmath369 .",
    "this completes the case .",
    "_ case 2 : _ weighted branching trees .",
    "construct versions of the processes @xmath370 and @xmath371 using a sequence of coupled vectors @xmath372 according to the coupling @xmath135 satisfying @xmath373 $ ] .",
    "let the root vector @xmath374 be distributed according to @xmath167 , where @xmath375 $ ] , and be independent of all other nodes .    by proposition [ p.couplingwbt ] we have @xmath376 \\leq d_1(\\nu_n^ * , \\nu^*)$ ] and @xmath377 \\leq k j ( \\rho_n \\vee \\rho)^{j-1 } d_1(\\mu_n , \\mu ) + k \\rho_n^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) , \\qquad j \\geq 1,\\ ] ] with @xmath378 , e[|q| ] \\}$ ] .",
    "note that @xmath379 \\right| \\leq d_1(\\mu_n,\\mu).\\ ] ] the result for fixed @xmath210 follows immediately .",
    "assume now that @xmath380 , and @xmath381 are nonnegative , and recall that @xmath11 is independent of @xmath12 , and therefore @xmath97 defines a weighted branching process .",
    "this in turn implies that @xmath382 is a nonnegative martingale with respect to the filtration generated by @xmath383 , @xmath384 .",
    "it follows that @xmath385 & \\leq e\\left [   \\left| w^{(n , j_n ) } - w^{(j_n ) } \\right| \\right ]   \\frac{1}{\\rho_n^{j_n } } + \\left| \\left ( \\frac{\\rho}{\\rho_n } \\right)^{j_n } - 1   \\right|   \\\\ & \\leq k j_n   \\left ( \\frac{\\rho \\vee \\rho_n}{\\rho_n } \\right)^{j_n } d_1(\\mu_n , \\mu ) + \\frac{k}{\\rho_n } d_1(\\nu_n^ * , \\nu^ * ) + \\left| \\left ( \\frac{\\rho}{\\rho_n } \\right)^{j_n } - 1   \\right| \\\\ & \\leq k   j_n e^{j_n ( \\rho/\\rho_n - 1)^+ } d_1(\\mu_n , \\mu ) + \\frac{k}{\\rho_n } d_1(\\nu_n^ * , \\nu^ * ) + j_n \\left| \\frac{\\rho}{\\rho_n } - 1 \\right| e^{(j_n-1)(\\rho/\\rho_n-1)^+},\\end{aligned}\\ ] ] where in the last step we used the inequalities .",
    "this last expression converges to zero since @xmath386 as @xmath204 .",
    "the proof of the last statement is identical to that of _ case 1 _ and is therefore omitted .",
    "we now proceed to the nonhomogeneous case .",
    "_ case 1 : _ weighted branching processes .",
    "the result for fixed @xmath387 follows from theorem [ t.mainnonhomo ] , since @xmath388 if in addition we have @xmath231 , then , by proposition [ p.couplingwbp ] ( using the optimal coupling ) , @xmath389&\\le \\sum_{j=0}^{k_n}e\\left [ \\left|w^{(n , j)}-w^{(j)}\\right| \\right ] \\le \\sum_{j=0}^{k_n}\\left(\\rho_n^{j } + e\\left [ \\left|q\\right| \\right]\\sum_{t=0}^{j-1}\\rho^t\\rho_n^{j-1-t}\\right)d_1(\\mu_n,\\mu).\\end{aligned}\\ ] ] now note that since @xmath390 , then for any @xmath391 we have that @xmath392 for all @xmath23 sufficiently large . in this case , @xmath393      \\le \\sum_{j=0}^{\\infty}\\left((1-\\varepsilon)^{j } + e\\left",
    "[ \\left|q\\right| \\right ] j ( 1-\\varepsilon)^{j-1 } \\right)d_1(\\mu_n,\\mu)\\to 0,\\ ] ] as @xmath204 for any @xmath394 . since we also have that @xmath395 = e\\left [ \\left| \\sum_{j = k_n+1}^\\infty w^{(j ) } \\right| \\right ] \\leq \\sum_{j = k_n+1}^\\infty e[|q| ] \\rho^j = \\frac{e[|q| ] \\rho^{k_n+1}}{1-\\rho},\\ ] ] then for any @xmath228 , @xmath396    _ case 2 : _ weighted branching trees .",
    "the proof of the result for fixed @xmath387 follows from theorem [ t.mainhomo ] as before . for @xmath397 and @xmath226",
    "we use proposition [ p.couplingwbt ] ( using the optimal couplings @xmath167 and @xmath135 ) to obtain @xmath398 & \\le \\sum_{j=0}^{k_n}e\\left [ \\left|w^{(n , j)}-w^{(j)}\\right| \\right ] \\\\ & \\leq d_1(\\nu_n^ * , \\nu^ * ) + k \\sum_{j=1}^{k_n } \\left ( \\sum_{t=0}^{j-1 } \\rho_n^t \\rho^{j-1-t } d_1(\\mu_n,\\mu ) + \\rho_n^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) \\right),\\end{aligned}\\ ] ] with @xmath378 , e[|q|]\\}$ ] . using the same arguments from _ case 1 _ note that for any @xmath391 and @xmath23 sufficiently large , @xmath398 & \\le d_1(\\nu_n^ * , \\nu^ * ) + k \\sum_{j=1}^\\infty \\left ( j ( 1-\\varepsilon)^{j-1 }    d_1(\\mu_n,\\mu ) + ( 1-\\varepsilon)^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) \\right ) \\to 0,\\end{aligned}\\ ] ] as @xmath204 for any @xmath394 .",
    "the rest of proof is the same as that of _ case 1 _ and is therefore omitted .",
    "the last result we need to prove in this section is lemma [ l.finalconditionswbt ] .    from the definition of the kantorovich - rubinstein metric and the fact that the infimum is always attained ( see , e.g. , @xcite , theorem 4.1 )",
    ", there exists a coupling @xmath135 of @xmath399 such that @xmath400.\\ ] ] next , define the vectors @xmath401    we will first show that @xmath402 as @xmath204 . to this end , let @xmath403 to simplify the notation and define @xmath404 .",
    "note that implies that @xmath405 in mean , and therefore in probability .",
    "now note that @xmath406 by the converging together lemma .",
    "it remains to show that @xmath407 in mean .    by the triangle s inequality",
    "we have that @xmath408 also , by assumption , @xmath409 & = e\\left [ |\\hat q\\hat c| + \\sum_{i=1}^\\infty |\\hat c| 1(\\hat n \\geq i ) \\right ] =   e\\left [ |\\hat q \\hat c|+ | \\hat c |",
    "\\hat n \\right ] \\to e [ |cq| + |c|n ] = e\\left [ \\| { \\bf y } \\|_1 \\right]\\end{aligned}\\ ] ] as @xmath204 , and therefore @xmath410 \\to 0 $ ] ( see , e.g. , theorem 5.5.2 in @xcite ) .",
    "now note that since @xmath411 , we have @xmath412 \\leq e \\left [ \\left\\| { \\bf y}_n - { \\bf y } \\right\\|_1 1 ( q_n \\leq 1 )   \\right ]   + e[q_n ] + 2 e\\left [   \\| { \\bf y } \\|_1 1 ( q_n > 1 ) \\right],\\end{aligned}\\ ] ] where @xmath413 and @xmath414 are uniformly integrable by theorem 13.3 in @xcite , and hence @xmath415 = \\lim_{n \\to \\infty } e\\left [   \\| { \\bf y } \\|_1 1 ( q_n > 1 ) \\right ] = 0.\\ ] ]      in this last section of the paper we prove the theorems regarding our applications to the analysis of information ranking algorithms and random graphs .    by applying the same steps from the proof of theorem  [ t.mainnonhomo ] conditionally on the sigma - algebra @xmath252 ( with @xmath200 the probability distribution of the root vector , which is allowed to be different )",
    "we obtain @xmath416 & \\le \\sum_{j=0}^{k } e\\left [ \\left .",
    "\\left|w^{(n , j)}-w^{(j)}\\right| \\right| \\mathscr{f}_n \\right ] \\\\ &",
    "\\leq d_1(\\nu_n^ * , \\nu^ * ) + k_n \\sum_{j=1}^{k } \\left ( \\sum_{t=0}^{j-1 } \\rho_n^t \\rho^{j-1-t } d_1(\\mu_n,\\mu ) + \\rho_n^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) \\right),\\end{aligned}\\ ] ] where @xmath417 , e[|q|]\\}$ ] .",
    "next , for any @xmath418 define the event @xmath419 . recall that @xmath420 and note that @xmath421 + d_1(\\nu_n^ * , \\nu^ * ) , e[|q|]\\}$ ] .",
    "the result for fixed @xmath387 is obtained by first conditioning on the event @xmath422 , as will be done for the case of @xmath228 below , and therefore we omit the details .    for @xmath228 and @xmath226 , choose @xmath423 and define @xmath422 as above ; set @xmath424 + \\varepsilon , e[|cq|]\\}$ ] . then apply markov s inequality conditionally to obtain that for any @xmath425 , @xmath426   \\right ]   + p\\left ( a_{n , \\varepsilon}^c",
    "\\right ) \\\\ & \\leq \\delta^{-1 } e\\left [ 1(a_{n,\\varepsilon } ) \\left\\ { d_1(\\nu_n^ * , \\nu^ * ) +   k_n \\sum_{j=1}^\\infty ( 1-\\varepsilon)^{j-1 } d_1(\\nu_n^ * , \\nu^ * )   \\right\\ } \\right ]   \\\\ & \\hspace{5 mm } + \\delta^{-1 }   e\\left [ 1(a_{n,\\varepsilon } ) k_n \\sum_{j=1}^{\\infty }   j ( 1-\\varepsilon)^{j-1 } d_1(\\mu_n , \\mu ) \\right ]   + p\\left ( a_{n , \\varepsilon}^c",
    "\\right ) \\\\ & \\leq \\delta^{-1 } ( 1 \\vee k/\\varepsilon^2 ) e\\left [ d_1(\\nu_n^ * , \\nu^ * ) \\wedge \\varepsilon + d_1(\\mu_n , \\mu ) \\wedge \\varepsilon \\right ] + p(a_{n,\\varepsilon}^c).\\end{aligned}\\ ] ] the assumption that @xmath427 as @xmath204 and the bounded convergence theorem show that @xmath428 .",
    "this combined with the observation that @xmath429 almost surely complete the proof .",
    "we now prove the theorem for the analysis of the configuration model .",
    "let @xmath430 , @xmath431 , @xmath432 and @xmath433 .",
    "let @xmath434 be a sequence of i.i.d .",
    "uniform ( 0,1 ) random variables , independent of @xmath252 .",
    "construct the two trees using the coupled vectors @xmath435 where @xmath436 where @xmath437 .",
    "these are the optimal couplings for which @xmath438 and @xmath439 are achieved .",
    "next , by adapting proposition [ p.couplingwbt ] to allow @xmath200 to be different , we obtain for @xmath174 , @xmath440 & \\leq m_n^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) + 1(j \\geq 2 ) \\ ,",
    "m^ * \\sum_{t=0}^{j-2 } m_n^t m^{j-2-t } d_1(\\nu_n,\\nu ) , \\end{aligned}\\ ] ] where @xmath290 $ ] , @xmath288 $ ] , @xmath441 $ ] , and @xmath442 $ ] .",
    "note that @xmath443 , for @xmath174 , is a martingale with respect to the filtration @xmath444 , conditionally on @xmath252 .",
    "let @xmath445 and note that by assumption @xmath446 for any @xmath425 .",
    "now let @xmath418 and use doob s maximal inequality to obtain @xmath447 \\right ] .\\end{aligned}\\ ] ] to bound this last expectation note that for any @xmath174 , @xmath448 & \\leq   e\\left[\\left .",
    "\\frac{1}{m^ * m^{j-1 } } \\left| z^{(n , j ) } - z^{(j ) } \\right| + \\left| \\frac{m_n^ * m_n^{j-1}}{m^ * m^{j-1 } } - 1 \\right| \\frac{z^{(n , j)}}{m_n^ * m_n^{j-1 } }   \\right| \\mathscr{f}_n \\right ] \\\\    & = \\frac{1}{m^ * m^{j-1 } }   e\\left [ \\left.\\left| z^{(n , j)}-z^{(j)}\\right|\\right|\\mathscr f_n \\right ] + \\left| \\frac{m_n^ * m_n^{j-1}}{m^ * m^{j-1 } } - 1 \\right| \\\\       & \\leq \\frac{1}{m^ * } \\left ( \\frac{m_n}{m } \\right)^{j-1 } d_1(\\nu_n^ * , \\nu^ * ) + 1(j \\geq 2 ) \\frac{1}{m }   \\sum_{t=0}^{j-2 } \\left ( \\frac{m_n}{m } \\right)^t   d_1(\\nu_n,\\nu ) + \\left| \\frac{m_n^ * m_n^{j-1}}{m^ * m^{j-1 } } - 1 \\right| \\\\       & \\leq \\frac{1}{m \\wedge m^ * } \\left ( \\frac{m \\vee m_n}{m } \\right)^{j-1 } \\left ( d_1(\\nu_n^ * , \\nu^ * ) + j d_1(\\nu_n,\\nu ) \\right ) + \\left| \\frac{m_n^ * m_n^{j-1}}{m^ * m^{j-1 } } - 1 \\right| .    \\end{aligned}\\ ] ] moreover , by we have that for @xmath449 and on the event @xmath450 , @xmath451 and @xmath452 it follows that on the event @xmath450 , @xmath453 & \\leq \\left ( \\frac{e^{\\delta / m}}{m \\wedge m^ * } + \\frac{1}{m^ * } \\right )   d_1(\\nu_n^ * , \\nu^ * ) +     \\left ( \\frac{e^{\\delta / m}}{m\\wedge m^ * }    + \\frac{(m^ * + \\delta ) e^{\\delta / m}}{m^ * m } \\right )   j_n d_1(\\nu_n , \\nu).\\end{aligned}\\ ] ] hence , @xmath454,\\ ] ] for some constant @xmath455 . since @xmath456 as @xmath204 ,",
    "the bounded convergence theorem gives @xmath457    for the second statement of the theorem note that for any @xmath174 , @xmath458 where @xmath459 is a mean one nonnegative martingale conditionally on @xmath252 . by , it only remains to show that @xmath460 as @xmath204 . to this end note",
    "that for @xmath450 defined above and some constant @xmath461 , @xmath462 \\right ] \\\\ & =   \\frac{h}{\\varepsilon } e\\left [ 1(a_{n,\\delta } ) \\left ( j_n d_1(\\nu_n , \\nu ) + d_1(\\nu_n^ * , \\nu^ * ) \\right ) \\right ] \\to 0,\\end{aligned}\\ ] ] as @xmath204 , where in the second step we used doob s maximal inequality conditionally on @xmath252 .",
    "this completes the proof .",
    "the last proof verifies the conditions of theorem [ t.mainwbthomo ] for the size - biased empirical distribution .    to analyze @xmath438",
    "define @xmath463 and let @xmath464 denote the empirical distribution function of @xmath110 .",
    "then , @xmath465 where @xmath466 and @xmath467 .",
    "hence , we need to show that @xmath468 as @xmath204 for any @xmath305 .",
    "this follows from noting that for any @xmath418 , @xmath469 \\leq \\frac{1}{\\varepsilon n^{1-\\delta ' } } \\sum_{k=0}^{\\infty } \\left ( e [ ( s_n^*(k))^2 ] \\right)^{1/2 } \\\\ & = \\frac{1}{\\varepsilon n^{1-\\delta ' } } \\sum_{k=0}^{\\infty } \\left ( n { { \\rm var } \\mspace{1mu}}(y_{k,1 } ) ] \\right)^{1/2 } \\leq \\frac{1}{\\varepsilon n^{1/2-\\delta ' } } \\sum_{k=0}^{\\infty } \\left ( p(d > k )    \\right)^{1/2 } \\\\ & \\leq   \\frac{1}{\\varepsilon n^{1/2-\\delta ' } } \\left(1 + \\sum_{k=1}^{\\infty } \\left ( \\frac{e[d^{2+\\epsilon}]}{k^{2+\\epsilon } }   \\right)^{1/2 } \\right ) \\to 0,\\end{aligned}\\ ] ] as @xmath204 , where in the second inequality we used the monotonicity of the @xmath470-norm and in the last one markov s inequality .    similarly , if we let @xmath471 and @xmath472/e[d]$ ] , for @xmath473 , then , @xmath474}{e[d ] } \\right| \\\\ & \\leq \\sum_{k=0}^\\infty \\left| \\sum_{i=1}^n d_i 1(d_i >",
    "k+1 ) \\left ( \\frac{1}{l_n } - \\frac{1}{ne[d ] } \\right )   \\right| \\\\ & \\hspace{5 mm } + \\frac{1}{e[d ] } \\sum_{k=0}^\\infty \\left| \\frac{1}{n } \\sum_{i=1}^n d_i 1(d_i >",
    "k+1 ) - e[d 1(d > k+1 ) ] \\right| \\\\ & \\leq \\frac{|ne[d ] - l_n|}{l_n } \\cdot \\frac{1}{ne[d ] } \\sum_{k=0}^\\infty \\sum_{i=1}^n d_i 1(d_i >",
    "k+1 ) \\\\ & \\hspace{5 mm } + \\frac{1}{n e[d ] } \\sum_{k=0}^\\infty \\left| \\sum_{i=1}^n \\left(d_i 1(d_i >",
    "k+1 ) - e[d 1(d > k+1 ) ]",
    "\\right ) \\right| \\\\ & = \\frac{|ne[d ] - l_n|}{n } \\cdot \\frac{n}{l_n } \\cdot \\frac{1}{ne[d ] } \\sum_{i=1}^n d_i ( d_i-1)^+   + \\frac{1}{ne[d ] } \\sum_{k=0}^\\infty |s_n(k)|,\\end{aligned}\\ ] ] where @xmath475 and @xmath476 $ ] . by the weak law of large numbers @xmath477 }",
    "\\sum_{i=1}^n d_i(d_i-1)^+ \\stackrel{p}{\\longrightarrow } \\frac{e[d ( d-1)^+]}{(e[d])^2}\\ ] ] as @xmath204 , therefore it suffices to show that @xmath478 - l_n|}{n^{1-\\delta } } \\stackrel{p}{\\longrightarrow } 0 \\qquad \\text{and } \\qquad \\frac{1}{n^{1-\\delta } } \\sum_{k=0}^\\infty |s_n(k)| \\stackrel{p}{\\longrightarrow } 0\\ ] ] for @xmath479 .",
    "since @xmath480 < \\infty$ ] , the marcinkiewicz - zygmund strong law gives that , @xmath481 - l_n)}{n^{1/p } } = \\frac{1}{n^{1/p } } \\sum_{i=1}^n ( d_i - e[d ] ) \\to 0 \\qquad \\text{a.s.,}\\ ] ] as @xmath204 for any @xmath482 , in particular , for @xmath483 .",
    "for the limit involving @xmath484 let @xmath485 and follow the same steps used to analyze @xmath486 to obtain @xmath487 \\right)^{1/2 } + \\frac{1}{\\varepsilon n^{1-\\delta } } \\sum_{k = a_n}^{\\infty } e[|s_n(k)| ] \\\\ & \\leq \\frac{1}{\\varepsilon n^{1/2-\\delta } } \\sum_{k=0}^{a_n-1 } \\left ( { { \\rm var } \\mspace{1mu}}(x_{k,1 } ) \\right)^{1/2 } + \\frac{n^\\delta}{\\varepsilon } \\sum_{k = a_n}^\\infty e[|x_{k,1}| ] \\\\ & \\leq \\frac{1}{\\varepsilon n^{1/2-\\delta } } \\sum_{k=0}^{a_n-1 } \\left ( e [ d^2 1(d >",
    "k+1 ) ] \\right)^{1/2 } + \\frac{n^\\delta}{\\varepsilon } \\sum_{k = a_n}^\\infty 2 e[d 1(d > k+1)].\\end{aligned}\\ ] ] using the inequality @xmath488",
    "\\geq e[d^{2+\\epsilon } 1(d > r ) ] \\geq r^{2+\\epsilon - t } e[d^t 1(d > r)],\\ ] ] for any @xmath314 and any @xmath489 $ ] , gives that @xmath490 as @xmath204 , which converges to zero for @xmath491 .",
    "we would like to thank an anonymous referee for his or her comments , which were very helpful in improving the presentation and scope of the results ."
  ],
  "abstract_text": [
    "<S> this paper considers linear functions constructed on two different weighted branching processes and provides explicit bounds for their kantorovich - rubinstein distance in terms of couplings of their corresponding generic branching vectors . motivated by applications to the analysis of random graphs </S>",
    "<S> , we also consider a variation of the weighted branching process where the generic branching vector has a different dependence structure from the usual one . by applying the bounds to sequences of weighted branching processes , we derive sufficient conditions for the convergence in the kantorovich - rubinstein distance of linear functions . </S>",
    "<S> we focus on the case where the limits are endogenous fixed points of suitable smoothing transformations .    </S>",
    "<S> _ keywords : _ weighted branching processes , smoothing transform , coupling , kantorovich - rubinstein distance , wasserstein distance , coupling of random graphs , weak convergence .    </S>",
    "<S> _ 2000 msc : _ 60j80 , 60b10 , 60h25    coupling on weighted branching trees    ningyuan chen mariana olvera - cravioto + columbia university columbia university </S>"
  ]
}