{
  "article_text": [
    "in many high - dimensional settings , such as microarray or neuro - imaging data analysis , we aim at detecting signal among several thousands of items ( e.g. , genes or voxels ) . for such problems ,",
    "a standard error measure is the false discovery rate ( fdr ) , which is defined as the expected proportion of errors among the items declared as significant .",
    "albeit motivated by pure testing considerations , the benjamini  hochberg fdr controlling procedure  @xcite has recently been shown to enjoy remarkable properties as an estimation procedure  @xcite .",
    "more specifically , it turns out to be adaptive to the amount of signal contained in the data , which has been referred to as `` adaptation to unknown sparsity . ''    in a classification framework , while  @xcite contains what is to our knowledge the first analysis of fdr thresholding with respect to the mis - classification risk , an important theoretical breakthrough has recently been made by bogdan et al .",
    "@xcite ; see also @xcite . the major contribution of bogdan et al .",
    "@xcite is to create an asymptotic framework in which several multiple testing procedures can be compared in a sparse gaussian scale mixture model . in particular",
    ", they proved that fdr thresholding is asymptotically optimal ( as the number @xmath2 of items goes to infinity ) with respect to the mis - classification risk and thus adapts to unknown sparsity in that setting ( for a suitable choice of the level parameter @xmath3 ) .",
    "also , they proposed an optimal choice for the rate of @xmath3 as @xmath2 grows to infinity .",
    "the present paper can be seen as an extension of  @xcite .",
    "first , we prove that the property of adaptation to unknown sparsity also holds nonasymptotically , by using finite sample oracle inequalities .",
    "this leads to a more accurate asymptotic analysis , for which explicit convergence rates can be provided .",
    "second , we show that these theoretical properties are not specific to the gaussian scale model , but carry over to subbotin location / scale models .",
    "they can also be extended to ( fairly general ) log - concave densities ( as shown in the supplemental article  @xcite ) , but we choose to focus on subbotin densities in the main manuscript for simplicity . finally , we additionally supply an explicit , finite sample , choice of the level @xmath3 and provide an extensive numerical study that aims at illustrating graphically the property of adaptation to unknown sparsity .",
    "let us consider the following classification setting : let @xmath4 , @xmath5 , be @xmath2 i.i.d . variables .",
    "assume that the sample @xmath6 is observed without the labels @xmath7 and that the distribution of @xmath8 conditionally on @xmath9 is known a priori .",
    "we consider the following general classification problem : build a ( measurable ) classification rule @xmath10 , depending on @xmath6 , such that the ( integrated ) misclassification risk @xmath11 is as small as possible .",
    "we consider two possible choices for the risk @xmath12 : @xmath13 where the expectation is taken with respect to @xmath14 in ( [ defrisk - bis - debut ] ) and to @xmath15 in ( [ risk - f - debut ] ) , for a new labeled data point @xmath16 independent of @xmath17 .",
    "the risks @xmath18 and @xmath19 are usually referred to as _ transductive _ and _ inductive _ risks , respectively ; see remark  [ remrisk ] for a short discussion on the choice of the risk .",
    "note that these two risks can be different in general because @xmath20 appears `` twice '' in @xmath21 .",
    "however , they coincide for procedures of the form @xmath22 , where @xmath23 is a deterministic function .",
    "the methodology investigated here can also be easily extended to a class of _ weighted _ mis - classification risks , as originally proposed by bogdan et al .",
    "@xcite ( in the case of the transductive risk ) and further discussed in section  [ secweighting ] .",
    "the distribution of @xmath24 is assumed to belong to a specific parametric subset of distributions on @xmath25 , which is defined as follows :    a.   the distribution of @xmath26 is such that the ( unknown ) mixture parameter @xmath27 satisfies @xmath28 , where @xmath29 and @xmath30 ; b.   the distribution of @xmath8 conditionally on @xmath9 has a density @xmath31 w.r.t .",
    "the lebesgue measure on @xmath32 that belongs to the family of so - called @xmath33-subbotin densities , parametrized by @xmath34 , and defined by @xmath35\\\\[-8pt ] & & \\eqntext{\\displaystyle \\mbox{with } l_\\zeta= \\int_{-\\infty}^{+\\infty } e^{-|x|^\\zeta/\\zeta } \\,dx = 2 \\gamma(1/\\zeta ) \\zeta^{1/\\zeta-1};}\\end{aligned}\\ ] ] c.   the distribution of @xmath8 conditionally on @xmath36 has a density @xmath37 w.r.t .",
    "the lebesgue measure on @xmath32 of either of the following two types : 1 .",
    "location : @xmath38 , for an ( unknown ) location parameter ; 2 .",
    "scale : @xmath39 , for an ( unknown ) scale parameter .",
    "the density @xmath40 is hence of the form @xmath41 where @xmath42 is convex on @xmath43 ( log - concave density ) .",
    "this property is of primary interest when applying our methodology ; see the supplemental article  @xcite .",
    "the particular values @xmath44 give rise to the laplace and gaussian case , respectively .",
    "the classification problem under investigation is illustrated by figure  [ figfirstillustration ] ( left panel ) , in the gaussian    ) ; density of @xmath45 ( solid line ) ; @xmath46 , @xmath47 ( crosses ) ; a new data point @xmath48 to be classified ( open circle ) ; bayes rule ( dotted line ) ; fdr rule @xmath49 for @xmath50 ( dashed line ) .",
    "right : illustration of the fdr algorithm for @xmath50 ; @xmath51 ( solid line ) ; @xmath52 s ( crosses ) ; @xmath53 ( dashed horizontal line ) ; @xmath54 ( dashed vertical line ) . here ,",
    "@xmath55 for @xmath56 .",
    "@xmath57 ; @xmath58 ; @xmath59 . for this realization ,",
    "@xmath60 labels `` @xmath1 '' and @xmath61 labels `` @xmath0 . '' ]    location case .",
    "moreover , let us note that we will exclude in our study the laplace location model ( i.e. , the location model using @xmath62 ) .",
    "this particular model is not directly covered by our methodology and needs specific investigations ; see section 10.3 in the supplemental article  @xcite .",
    "our modeling is motivated by the following application : consider a microarray experiment for which measurements @xmath63 for @xmath2 genes are observed , each corresponding to a difference of expression levels between two experimental conditions ( e.g. , test versus reference sample ) .",
    "let @xmath7 be binary variables coded as @xmath1 if the gene is differentially expressed and @xmath0 if not .",
    "assume that each @xmath64 is @xmath65 where @xmath66 is the ( unknown ) effect for gene @xmath67 while @xmath68 quantifies the ( known ) measurement error .",
    "next , assume the bayesian paradigm that sets the following prior distribution for @xmath66 : the distribution of @xmath66 is @xmath69 conditionally on @xmath70 and @xmath71 conditionally on @xmath72 .",
    "generally , @xmath73 ( @xmath740 ) , the dispersion of the nondifferentially expressed genes , is assumed to be known while @xmath75 ( @xmath740 ) and @xmath76 ( @xmath740 ) , the shift and additional dispersion of the nondifferentially expressed genes , are unknown .",
    "let @xmath77 for @xmath78 and consider the distribution unconditionally on the @xmath66 s .",
    "this corresponds to our model ( in the gaussian case ) as follows :    * @xmath79 and @xmath80 : location model with @xmath81 ; * @xmath82 and @xmath83 : scale model with @xmath84 .    the above convolution argument was originally proposed in @xcite for a gaussian scale model : it explains how we can obtain test statistics that have the same distribution under the alternative even if the effects of the measurements are not equal .",
    "going back to our general setting , an important point is that the parameters@xmath85 in the location model , or @xmath86 in the scale model  are assumed to _ depend _ on sample size @xmath2 .",
    "the parameter @xmath87 , called the _ sparsity _",
    "parameter , is assumed to tend to infinity as @xmath2 tends to infinity , which means that the unlabeled sample only contains a small , vanishing proportion of label  @xmath1 .",
    "this condition is denoted ( [ sp ] ) . as a counterpart",
    ", the other parameter@xmath88 in the location model , or @xmath89 in the scale model  is assumed to tend to infinity fast enough to balance sparsity .",
    "this makes the problem `` just solvable '' under the sparsity constraint .",
    "more precisely , our setting corresponds to the case where the power of the bayes procedure is bounded away from @xmath0 and @xmath1 , and is denoted ( [ bp ] ) .",
    "this is motivated by sparse high - dimensional problems for which the signal is strong but only carried by a small part of the data .",
    "for instance , in the above - mentioned application to microarray data , the two experimental conditions compared can be so close that only a very small proportion of genes are truly differentially expressed ( e.g. , two groups of patients having the same type of cancer but a different response to a cancer treatment  @xcite ) .",
    "[ remrisk ] our setting is close to the semi - supervised novelty detection ( ssnd ) framework proposed in  @xcite , for which the knowledge of the distribution @xmath8 conditionally on @xmath9 is replaced by the observation of a finite i.i.d .",
    "sample with this distribution . in the latter work ,",
    "the authors use the unlabeled data @xmath6 to design a procedure @xmath90 that aims at classifying a new unlabeled data @xmath48 .",
    "this approach is in accordance with the inductive risk defined by ( [ risk - f - debut ] ) .",
    "however , in other situations closer to standard multiple testing situations , one wants to classify @xmath6 meanwhile designing @xmath90 .",
    "this gives rise to the transductive risk defined by ( [ defrisk - bis - debut ] ) .",
    "classically , the solution that minimizes the misclassification risks ( [ defrisk - bis - debut ] ) and ( [ risk - f - debut ] ) is the so - called bayes rule @xmath91 that chooses the label @xmath1 whenever @xmath92 is larger than a specific threshold .",
    "we easily check that the likelihood ratio @xmath92 is nondecreasing in @xmath93 and @xmath94 for the location and the scale model , respectively . as a consequence ,",
    "we can only focus on classification rules @xmath95 of the form @xmath96 , @xmath97 for the location model and @xmath98 , @xmath99 for the scale model .",
    "therefore , to minimize the mis - classification risks , thresholding procedures are classification rules of primary interest , and the main challenge consists of choosing the threshold @xmath100 in function of @xmath6 .",
    "the fdr controlling method proposed by benjamini and hochberg @xcite ( also called `` benjamini ",
    "hochberg '' thresholding ) provides such a thresholding @xmath100 in a very simple way once we can compute the quantile function @xmath101 , where @xmath102 is the ( known ) upper - tail cumulative distribution function of @xmath8 conditionally on @xmath9 .",
    "we recall below the algorithm for computing the fdr threshold in the location model ( using test statistics rather than @xmath103-values ) .",
    "[ algofdr ] ( 1 ) choose a nominal level @xmath104 ;    \\(2 ) consider the order statistics of the @xmath105 s : @xmath106    \\(3 ) take the integer @xmath107 when this set is nonempty and @xmath108 otherwise ;    \\(4 ) use @xmath109 for @xmath110 .    for the scale model",
    ", fdr thresholding has a similar form , @xmath111 for @xmath112 , where @xmath113 ( @xmath108 if the set is empty ) and @xmath114 .",
    "algorithm  [ algofdr ] is illustrated in figure [ figfirstillustration ] ( right panel ) , in a gaussian location setting .",
    "since @xmath115 takes its values in the range @xmath116 $ ] , it can be seen as an intermediate thresholding rule between the bonferroni thresholding [ @xmath117 and the uncorrected thresholding [ @xmath118 .",
    "finally , an important feature of the fdr procedure is that it depends on a pre - specified level @xmath104 . in this work , the level @xmath3 is simply used as a tuning parameter , chosen to make the corresponding misclassification risk as small as possible .",
    "this contrasts with the standard philosophy of ( multiple ) testing for which @xmath3 is meant to be a bound on the error rate and thus is fixed in the overall setting .",
    "let @xmath12 be the risk defined either by ( [ defrisk - bis - debut ] ) or ( [ risk - f - debut ] ) .",
    "in this paper , we aim at studying the performance of fdr thresholding @xmath119 as a classification rule in terms of the excess risk @xmath120 both in location and scale models .",
    "we investigate two types of theoretical results :    nonasymptotic oracle inequalities : prove for each ( or some ) @xmath121 , an inequality of the form @xmath122 where @xmath123 is an upper - bound which we aim to be `` as small as possible . '' typically , @xmath123 depends on @xmath124 and on the model parameters .",
    "convergence rates : find a sequence @xmath125 for which there exists @xmath126 such that for a large @xmath2 , @xmath127 for a given rate @xmath128 .    inequality ( [ equ - aim1 ] ) is of interest in its own right , but is also used to derive inequalities of type ( [ equ - aim2 ] ) , which are of asymptotic nature . property ( [ equ - aim2 ] ) is called `` asymptotic optimality at rate @xmath129 . ''",
    "it implies that @xmath130 ; that is , @xmath131 is `` asymptotically optimal , '' as defined in  @xcite .",
    "however , ( [ equ - aim2 ] ) is substantially more informative because it provides a rate of convergence .",
    "it should be emphasized at this point that the trivial procedure @xmath132 ( which always chooses the label `` @xmath0 '' ) satisfies ( [ equ - aim2 ] ) with @xmath133 [ under our setting ( [ bp ] ) ] .",
    "therefore , proving ( [ equ - aim2 ] ) with @xmath133 is not sufficient to get an interesting result , and our goal is to obtain a rate @xmath129 that tends to zero in ( [ equ - aim2 ] ) .",
    "the reason for which @xmath134 is already `` competitive '' is that we consider a sparse model in which the label `` @xmath0 '' is generated with high probability .",
    "first , section  [ secgenform ] presents a more general setting than the one of section  [ secinsetting ] .",
    "namely , the location and scale models are particular cases of a general `` @xmath103-value model '' after a standardization of the original @xmath20 s into @xmath103-values @xmath135 s .",
    "while the `` test statistic '' formulation is often considered as more natural than the @xmath103-value one for many statisticians , the @xmath103-value formulation will be very convenient to provide a general answer to our problem .",
    "the so - obtained @xmath103-values are uniformly distributed on @xmath136 under the label @xmath0 while they follow a distribution with decreasing density @xmath137 under the label @xmath1 .",
    "hence , procedures of primary interest ( including the bayes rule ) are @xmath103-value thresholding procedures that choose label @xmath1 for @xmath103-values smaller than some threshold @xmath138 . throughout the paper ,",
    "we focus on this type of procedures , and any procedure @xmath131 is identified by its corresponding threshold @xmath138 in the notation . translated into this `` @xmath103-value world , '' we describe in section [ secgenform ] the bayes rule , the bayes risk , condition ( [ bp ] ) , bfdr and fdr thresholding .    the fundamental results are stated in section  [ secgeneralresults ] in the general @xmath103-value model . following  @xcite , as bfdr thresholding is much easier to study than fdr thresholding from a mathematical point of view , the approach advocated here is as follows : first , we state an oracle inequality for bfdr ; see theorem  [ main - th ] .",
    "second , we use a concentration argument of the fdr threshold around the bfdr threshold to obtain an oracle inequality of the form ( [ equ - aim1 ] ) ; see theorem  [ main - th2 ] . at this point , the bounds involve quantities that are not written in an explicit form , and that depend on the density @xmath137 of the @xmath103-values corresponding to the label @xmath1 .    the particular case where @xmath137 comes either from a location or a scale model is investigated in section  [ secappl - locationandscale ] .",
    "an important property is that in these models , the upper - tail distribution function @xmath139 and the quantile function @xmath101 can be suitably bounded ; see section 12 in the supplemental article  @xcite . by using this property ,",
    "we derive from theorems  [ main - th ] and [ main - th2 ] several inequalities of the form ( [ equ - aim1 ] ) and ( [ equ - aim2 ] ) .",
    "in particular , in the sparsity regime @xmath140 , @xmath141 , we derive that the fdr threshold @xmath142 at level @xmath3 is asymptotically optimal [ under ( [ bp ] ) and ( [ sp ] ) ] in either of the following two cases :    * for the location model , @xmath143 , if @xmath144 and @xmath145 ; * for the scale model , @xmath34 , if @xmath144 and @xmath146 .",
    "the latter is in accordance with the condition found in @xcite in the gaussian scale model .",
    "furthermore , choosing @xmath147 ( location ) or @xmath148 ( scale ) provides a convergence rate @xmath149 ( location ) or @xmath150 ( scale ) , respectively .    at this point",
    ", one can argue that the latter convergence results are not fully satisfactory : first , these results do not provide an explicit choice for @xmath3 for a given finite value of @xmath2 .",
    "second , the rate of convergence @xmath129 being rather slow , we should check numerically that fdr thresholding has reasonably good performance for a moderately large @xmath2 .",
    "we investigate the choice of @xmath3 by carefully studying bayes thresholding and how it is related to bfdr thresholding ; see sections  [ secpfdrthresholding ] and  [ secchoicealpham ] .",
    "next , for this choice of @xmath3 , the performance of fdr thresholding is evaluated numerically in terms of ( relative ) excess risk , for several values of @xmath2 ; see section  [ secnumexp ] .",
    "we show that the excess risk of fdr thresholding is small for a remarkably wide range of values for @xmath151 , and increasingly so as @xmath2 grows to infinity .",
    "this illustrates the adaptation of fdr thresholding to the unknown sparsity regime .",
    "also , for comparison , we show that choosing @xmath3 fixed with @xmath2 ( say , @xmath152 ) can lead to higher fdr thresholding excess risk .",
    "let @xmath153 \\times\\{0,1\\ } $ ] , @xmath5 , be @xmath2 i.i.d",
    ". variables . the distribution of @xmath154 is assumed to belong to a specific subset of distributions on @xmath155 \\times\\{0,1\\}$ ] , which is defined as follows :    same as ( i ) in section  [ secinsetting ] ;    the distribution of @xmath156 conditionally on @xmath9 is uniform on @xmath136 ;    the distribution of @xmath156 conditionally on @xmath36 has a c.d.f . @xmath157 satisfying    @xmath158 $ and differentiable on $ ( 0,1)$ , $ f_m = f_m'$ is continuously decreasing with $ f_m(0^+ ) > \\tau_m > f_m(1",
    "^ -)$. \\end{tabular}\\hspace*{-62pt}\\ ] ]    this way , we obtain a family of i.i.d .",
    "@xmath103-values , where each @xmath103-value has a marginal distribution following the mixture model @xmath159 model ( [ modelpvalue ] ) is classical in the multiple testing literature and is usually called the `` two - group mixture model . ''",
    "it has been widely used since its introduction by efron et al .",
    "( 2001 ) @xcite ; see , for instance , @xcite .    the models presented in section  [ secinsetting ] are particular instances of this @xmath103-value model . in the scale model , we apply the standardization @xmath160 , which yields @xmath161 . in the location model ,",
    "we let @xmath162 , which yields @xmath163 .",
    "we can easily check that in both cases ( [ a ] ) is satisfied ( additionally assuming @xmath164 for the location model ) , with @xmath165 and @xmath166 ( scale ) and @xmath167 ( location ) , as proved in section 9.1 in the supplemental article  @xcite .",
    "a classification procedure is identified with a threshold @xmath168 $ ] , that is , a measurable function of the @xmath103-value family @xmath169 .",
    "the corresponding procedure chooses label @xmath1 whenever the @xmath103-value is smaller than @xmath138 . in the @xmath103-value setting",
    ", the transductive and inductive misclassification risks of a threshold @xmath170 can be written as follows : @xmath171 in the particular case of a deterministic threshold @xmath172 $ ] , these two risks coincide and are equal to @xmath173 the following lemma identifies a solution minimizing both risks ( [ defrisk - bis ] ) and ( [ defrisk ] ) .",
    "let @xmath12 being either @xmath174 or @xmath175 . under assumption ( [ a ] )",
    ", the threshold @xmath176 minimizes @xmath12 , that is , satisfies @xmath177 , where the minimum is taken over all measurable functions from @xmath155^m$ ] to @xmath155 $ ] that take as input the @xmath103-value family @xmath178 .",
    "the threshold @xmath179 is called the _",
    "bayes threshold _ , and @xmath180 is called the _",
    "bayes risk_. the bayes threshold is unknown because it depends on @xmath87 and on the data distribution @xmath137 .    in this paper ,",
    "all the statements hold for both risks . hence , throughout the paper , @xmath12 denotes either @xmath174 defined by ( [ defrisk - bis ] ) or @xmath175 defined by ( [ defrisk ] ) .      under assumption ( [ a ] ) , let us denote the power of the bayes procedure by @xmath181 in our setting , we will typically assume that the signal is sparse while the power @xmath182 of the bayes procedure remains away from @xmath0 or @xmath1 :    @xmath183\\nonumber\\end{aligned}\\ ] ]    @xmath184\\nonumber\\end{aligned}\\ ] ]    first note that assumption ( [ sp ] ) is very weak : it is required as soon as we assume some sparsity in the data . as a typical instance , @xmath185 satisfies ( [ sp ] ) , for any @xmath186 .",
    "next , assumption ( [ bp ] ) means that the best procedure is able to detect a `` moderate '' amount of signal . in  @xcite ,",
    "a slightly stronger assumption has been introduced ,    @xmath187\\nonumber\\vadjust{\\goodbreak}\\end{aligned}\\ ] ]    which is referred to as `` the verge of detectability . ''",
    "condition ( [ bp ] ) encompasses ( [ vd ] ) and is more suitable to state explicit finite sample oracle inequalities ; see , for example , remark  [ remdcomp ] further on .    in the location ( resp . ,",
    "scale ) model , while the original parameters are @xmath188 [ resp .",
    ", @xmath189 , the model can be parametrized in function of @xmath190 by using ( [ thres - bayes ] ) and ( [ equ - powbayes ] ) . this way ,",
    "@xmath157 is uniquely determined from @xmath190 as follows : among the family of curves @xmath191     ( thin solid curves ) .",
    "right : choice ( thick solid curve ) within the family of curves @xmath192 that fulfills ( [ thres - bayes ] ) and ( [ equ - powbayes ] ) for @xmath193 ( given by the dashed horizontal line ) and @xmath194 ( slope of the dashed oblique line ) .",
    "this gives @xmath195 .",
    "the bayes threshold @xmath196 is given by the dotted vertical line . ]",
    "( resp . , @xmath197 )",
    ", @xmath157 is the unique curve such that the pre - image of @xmath182 has a tangent of slope @xmath87 , that is , @xmath198 .",
    "this is illustrated in figure  [ figexpo ] for the laplace scale model . in this case ,",
    "@xmath199 for @xmath200 and thus @xmath201 , so that the family of curves is simply @xmath202 .    condition ( [ bp ] ) constrains the model parameters to be located in a very specific region .",
    "for instance , in the gaussian location model with , condition ( [ bp ] ) implies that @xmath203 ( see table 3 in the supplemental article @xcite ) , which corresponds to choosing @xmath204 on the `` estimation boundary , '' as displayed in figure 1 of  @xcite .",
    "@xmath205 for any @xmath206 and where @xmath207 . as introduced by  @xcite , the quantity defined by ( [ bfdr ] )",
    "is called `` bayesian fdr . ''",
    "it is not to be confounded with `` bayes fdr '' defined by  @xcite .",
    "also , under a two - class mixture model , @xmath208 coincides with the so - called `` positive false discovery rate , '' itself connected to the original false discovery rate of @xcite ; see  @xcite and section 4 of  @xcite .",
    "under assumption ( [ a ] ) , the function @xmath209 is decreasing from @xmath210 to @xmath1 , with @xmath211 $ ] . hence , the following result holds .",
    "[ lem - pfdr ] assume ( [ a ] ) and @xmath212 .",
    "then , equation @xmath213 has a unique solution @xmath214 , given by @xmath215 for @xmath216 and @xmath217 .",
    "the threshold @xmath218 is called the _ bfdr threshold _ at level @xmath3 .",
    "typically , it is well defined for any @xmath219 , because @xmath220 and @xmath165 in the subbotin location and scale models ( additionally assuming @xmath164 for the location model ) .",
    "obviously , the bfdr threshold is unknown because it depends on @xmath87 and on the distribution of the data .",
    "however , its interest lies in that it is close to the fdr threshold which is observable . when not ambiguous , @xmath218 will be denoted by @xmath221 for short .",
    "next , a quantity of interest in lemma  [ lem - pfdr ] is @xmath222 , called the _ recovery parameter _ ( associated to @xmath3 ) . as @xmath223 , considering @xmath3 or @xmath224 is equivalent .",
    "since we would like to have @xmath225 close to @xmath226 , _ the recovery parameter can be interpreted as a correction factor that cancels the difference between @xmath227 and @xmath228_. clearly , the best choice for the recovery parameter is such that @xmath229 , that is , @xmath230 which is an unknown quantity , called the _ optimal recovery parameter_. note that from the concavity of @xmath157 , we have @xmath231 and thus @xmath232 . as an illustration , for the laplace scale model , we have @xmath233 and thus the optimal recovery parameter is @xmath234 .",
    "the fact that @xmath232 suggests to always choose @xmath235 ( i.e. , @xmath236 ) into the bfdr threshold .",
    "a related result is that taking any sequence @xmath125 such that @xmath237 for all @xmath121 never leads to an asymptotically optimal bfdr procedure ; see section 13 in the supplemental article  @xcite .    ): e.c.d.f .",
    "of the @xmath103-value ( solid line ) , line of slope @xmath238 ( dotted line ) , the fdr threshold at level @xmath3 ( @xmath239-coordinate of the vertical dashed dotted line ) .",
    "right : illustration of the fdr threshold as an empirical surrogate for the bfdr threshold ; compared to the left picture , we added the c.d.f .",
    "of the @xmath103-values ( thick solid line ) , the bfdr threshold at level @xmath240 ( dotted vertical line ) and the bayes threshold ( dashed vertical line ) . in both panels",
    ", we consider the laplace scale model with @xmath241 ; @xmath242 ; @xmath243 ; @xmath185 ; @xmath244 ; @xmath245 . ]",
    "the fdr threholding procedure was introduced by benjamini and hochberg ( 1995 ) by proving that it controls the fdr ; see  @xcite . from an historical perspective",
    ", it is interesting to note that this procedure has a prior occurrence in a series of papers by eklund ( 19611963 ) ; see @xcite .",
    "as noted by many authors ( see , e.g. , @xcite ) , this thresholding rule can be expressed as a function of the empirical c.d.f .",
    "@xmath246 of the @xmath103-values in the following way : for any @xmath104 ,",
    "@xmath247\\dvtx{{\\widehat{\\mathbb{g}}_m}}(t)\\geq t/\\alpha_m \\bigr\\}.\\ ] ] we simply denote @xmath248 by @xmath249 when not ambiguous .",
    "classically , this implies that @xmath250 solves the equation @xmath251 [ this can be easily shown by using ( [ equfdr ] ) together with the fact that @xmath252 is a nondecreasing function ] .",
    "hence , according to lemma  [ lem - pfdr ] and as already mentioned in the literature ( see  @xcite ) , @xmath249  can be seen as an empirical counterpart of the bfdr threshold at level @xmath253 , in which the theoretical c.d.f .",
    "@xmath254 of the @xmath103-values has been replaced by the empirical c.d.f .",
    "@xmath246 of the @xmath103-values .",
    "next , once @xmath3 has been chosen , ( [ equfdr ] ) only involves observable quantities , so that the threshold @xmath249 only depends on the data .",
    "this is further illustrated on the left panel of figure  [ figexpofdr ] . also , as already observed in section 5.2 of  @xcite , since the bh procedure is never more conservative than the bonferroni procedure , the following modification of @xmath249",
    "can be proposed :    the _ fdr threshold _ at level @xmath3 is defined by @xmath255 where @xmath248 is defined by ( [ equfdr ] ) .",
    "we simply denote @xmath256 by @xmath142 when not ambiguous .",
    "the threshold @xmath142 is the one that we use throughout this paper .",
    "this modification does not change the risk @xmath174 , that is , @xmath257 , but can affect the risk @xmath175 , that is , @xmath258 , in general .    finally , while relation ( [ equ - fdrsupbonf ] )",
    "uses @xmath103-values whereas the algorithms defined in section  [ secthresholdingproc ] use test statistics , it is easy to check that the resulting procedures are the same .    to get a better fdr controlling procedure ,",
    "one classical approach is to modify ( [ equ - fdrsupbonf ] ) by dividing @xmath3 by a ( more or less explicit ) estimator of @xmath259 and by possibly using a step - up - down algorithm ; see , for example , @xcite .",
    "however , this method seems not helpful in our sparse setting because @xmath259 is very close to @xmath1 . as a result , we focus in this paper only on the original ( nonadaptive ) version of fdr thresholding  ( [ equ - fdrsupbonf ] ) .",
    "this section presents relations of the form ( [ equ - aim1 ] ) and ( [ equ - aim2 ] ) for the bfdr and fdr thresholds . our first main result deals with the bfdr threshold .",
    "[ main - th ] assume ( [ a ] ) and consider the bfdr threshold @xmath260 at a level @xmath212 corresponding to a recovery parameter @xmath261 .",
    "consider @xmath232 the optimal recovery parameter given by ( [ qmopt ] ) .",
    "then the following holds :    if @xmath236 , we have for any @xmath121 , @xmath262 where we let @xmath263 .",
    "in particular , under ( [ bp ] ) , if @xmath264 and @xmath265 , the bfdr threshold @xmath260 is asymptotically optimal at rate @xmath266 .",
    "we have for any @xmath121 , @xmath267 in particular , under ( [ bp ] ) , if @xmath268 and if @xmath224 is chosen such that @xmath269 @xmath260 is not asymptotically optimal .",
    "theorem  [ main - th ] is proved in section  [ secproofs ] .",
    "theorem  [ main - th](i ) presents an upper - bound for the excess risk when choosing @xmath224 instead of @xmath270 in bfdr thresholding .",
    "first , both sides of ( [ mainbornsup - gen ] ) are equal to zero when @xmath271 .",
    "hence , this bound is sharp in that case .",
    "second , assumption `` @xmath236 '' in theorem  [ main - th](i ) is only a technical detail that allows us to get @xmath272 instead of @xmath273 in the right - hand side of ( [ mainbornsup - gen ] ) ( moreover , it is quite natural ; see the end of section  [ secpfdrthresholding ] ) .",
    "third , @xmath274 has a simple interpretation as the difference between the power of bayes thresholding and bfdr thresholding .",
    "fourth , bound ( [ mainbornsup - gen ] ) induces the following trade - off for choosing @xmath3 : on the one hand , @xmath3 has to be chosen small enough to make @xmath272 small ; on the other hand , @xmath274 increases as @xmath3 decreases to zero .",
    "finally note that , in theorem  [ main - th](i ) , the second statement is a consequence of the first one because @xmath275 .",
    "theorem  [ main - th](ii ) states lower bounds which are useful to identify regimes of @xmath3 that do not lead to an asymptotically optimal bfdr thresholding ; see corollary [ cor - sub](i ) further on .    our second main result deals with fdr thresholding .",
    "[ main - th2 ] let @xmath276 , assume ( [ a ] ) and consider the fdr threshold @xmath142 at level @xmath277 .",
    "then the following holds : for any @xmath121 , @xmath278\\\\[-8pt ] & & { } + \\pi_{1,m } \\bigl\\ { \\gamma'_{m } \\wedge \\bigl(\\gamma_{m}^{\\varepsilon}+ e^{-m{\\varepsilon}^2(\\tau_m+1)^{-1 } ( c_m - \\gamma_{m}^{\\varepsilon})/4 } \\bigr ) \\bigr\\}\\nonumber\\end{aligned}\\ ] ] for @xmath279 with @xmath280 and @xmath281 .",
    "in particular , under ( [ bp ] ) and assuming :    if @xmath282 , @xmath283 and additionally @xmath284 , @xmath285 , the fdr threshold @xmath142 is asymptotically optimal at rate @xmath286 ;    if @xmath287 with @xmath288 , the fdr threshold @xmath142 is asymptotically optimal at rate @xmath289 .    theorem  [ main - th2 ] is proved in section  [ secproofs ] . the proof mainly follows the methodology of  @xcite , but is more general and concise .",
    "it relies on tools developed in . the main argument for",
    "the proof is that the fdr threshold @xmath290 is either well concentrated around the bfdr threshold @xmath291 ( as illustrated in the right panel of figure  [ figexpofdr ] ) or close to the bonferroni threshold @xmath292 .",
    "this argument was already used in  @xcite .",
    "let us comment briefly on theorem  [ main - th2 ] : first , as in the bfdr case , choosing @xmath3 such that the bound in ( [ mainbornsup2-gen ] ) is minimal involves a trade - off because @xmath293 and @xmath294 are quantities that increase when @xmath3 decreases to zero .",
    "second , let us note that cases ( i ) and ( ii ) in theorem  [ main - th2 ] are intended to cover regimes where the fdr is close to bfdr ( moderately sparse ) and where the fdr threshold is close to the bonferroni threshold ( extremely sparse ) , respectively . in particular , these two regimes cover the case where @xmath295 with @xmath296 $ ] . finally , the bounds and convergence rates derived in theorems [ main - th ] and  [ main - th2 ] strongly depend on the nature of @xmath157 .",
    "we derive a more explicit expression of the latter in the next section , in the particular cases of location and scale models coming from a subbotin density .",
    "[ remupperboundgamma ] by the concavity of @xmath157 , we have @xmath297 , which yields @xmath298 when @xmath299 is easier to use than @xmath300 , it is tempting to use ( [ boundstmstar ] ) to upper bound the excess risk in theorems [ main - th ] and  [ main - th2 ] . however , this can inflate the resulting upper - bound too much .",
    "this point is discussed in section 10.4 in the supplemental article @xcite for the case of a gaussian density ( for which this results in an additional @xmath301 factor in the bound ) .",
    "a preliminary task is to study the behavior of @xmath196 , @xmath180 and @xmath302 both in location and scale models .",
    "while finite sample inequalities are given in section  9.2 in the supplemental article  @xcite , we only report in this subsection some resulting asymptotic relations for short .",
    "let us define the following rates , which will be useful throughout the paper : @xmath303 under ( [ sp ] ) , note that the rates @xmath304 ( resp .",
    ", @xmath305 ) tend to infinity . furthermore , by using section 9.2 in the supplemental article  @xcite , we have @xmath306 in the location model and @xmath307 in the scale model .",
    "[ prop - bayes ] consider a @xmath33-subbotin density ( [ equ - subdensity ] ) with @xmath34 for a scale model and @xmath164 for a location model .",
    "let @xmath308 be the parameters of the model .",
    "let @xmath309 be equal to @xmath304 defined by ( [ rate - loc ] ) in the location model or to @xmath305 defined by ( [ rate - scale ] ) in the scale model .",
    "then , under ( [ bp ] ) and ( [ sp ] ) , we have @xmath310 and @xmath311 and @xmath312    from ( [ equirtmb ] ) and ( [ majtmb ] ) , by assuming ( [ bp ] ) and ( [ sp ] ) , the probability of a type  i error ( @xmath313 ) is always of smaller order than the probability of a type  ii error ( @xmath314 ) .",
    "the latter had already been observed in @xcite in the particular case of a gaussian scale model .",
    "[ remrisque0 ] from ( [ equirtmb ] ) and since the risk of null thresholding is @xmath315 , a substantial improvement over the null threshold can only be expected in the regime where @xmath316 , where @xmath317 is `` far '' from @xmath0 .",
    "the following result can be derived from theorem  [ main - th](i ) and theorem  [ main - th2 ] .",
    "it is proved in section 9.3 in the supplemental article  @xcite .",
    "[ cor - oracle ] consider a @xmath33-subbotin density ( [ equ - subdensity ] ) with @xmath164 for a location model and @xmath34 for a scale model , and let @xmath308 be the parameters of the model .",
    "let @xmath318 [ defined by ( [ rate - loc ] ) ] and @xmath319 in the location model or @xmath320 [ defined by ( [ rate - scale ] ) ] and @xmath321 in the scale model .",
    "let @xmath219 and denote the corresponding recovery parameter by @xmath261 .",
    "consider @xmath322 the optimal recovery parameter given by ( [ qmopt ] ) .",
    "let @xmath323 .",
    "then :    the bfdr threshold @xmath260 at level @xmath3 defined by ( [ thres - pfdr ] ) satisfies that for any @xmath121 such that @xmath324 , @xmath325\\\\[-8pt ] & & \\qquad\\leq\\pi_{1,m } \\biggl\\ { \\biggl(\\frac { c_m}{q_m}- \\frac { c_m}{q_m^{\\mathrm{opt } } } \\biggr ) \\vee\\biggl(k_m \\frac{\\log ( q_m / q_m^{\\mathrm{opt } } ) -\\log\\nu}{r_m } \\biggr ) \\biggr\\}.\\nonumber\\end{aligned}\\ ] ]    letting @xmath276 , @xmath326 and @xmath327 , the fdr threshold @xmath142 at level @xmath328 defined by ( [ equ - fdrsupbonf ] ) satisfies that , for any @xmath329 , for any @xmath121 such that @xmath330 , @xmath331\\\\[-8pt ] & & { } + \\frac{\\alpha_m / m}{(1-\\alpha_m)^2}+ \\pi_{1,m } { \\mathbf{1}\\{a=1\\ } } e^{-m(\\tau_m+1)^{-1 } \\nu{\\varepsilon}^2 c_m /4 } .\\nonumber\\end{aligned}\\ ] ]    corollary  [ cor - oracle](ii ) contains two distinct cases .",
    "the case @xmath332 should be used when @xmath333 is large , because the remainder term containing the exponential becomes small ( whereas @xmath334 is approximately constant ) . the case @xmath335 is intended to deal with the regime where @xmath333 is not large , because @xmath336 is of the order of a constant in that case .",
    "the finite sample oracle inequalities ( [ mainbornsup ] ) and ( [ mainbornsup2 ] ) are useful to derive explicit rates of convergence , as we will see in the next section .",
    "let us also mention that an exact computation of the excess risk of bfdr thresholding can be derived in the laplace case ; see section 10.2 in the supplemental article  @xcite .",
    "in this section , we provide a sufficient condition on @xmath3 such that , under ( [ bp ] ) and ( [ sp ] ) , bfdr / fdr thresholding is asymptotically optimal [ according to ( [ equ - aim2 ] ) ] , and we provide an explicit rate @xmath337 .",
    "furthermore , we establish that this condition is necessary for the optimality of bfdr thresholding .",
    "[ cor - sub ] take @xmath143 , @xmath338 for the location case and @xmath34 , @xmath339 for the scale case . consider a @xmath33-subbotin density ( [ equ - subdensity ] ) in the sparsity regime @xmath140 , @xmath340 and under ( [ bp ] ) .",
    "then the following holds :    the bfdr threshold @xmath260 is asymptotically optimal if and only if @xmath341 in which case it is asymptotically optimal at rate @xmath342    the fdr threshold @xmath142 at a level @xmath3 satisfying ( [ cond - conv - sub ] ) is asymptotically optimal at rate @xmath343 .",
    "choosing @xmath344 , bfdr and fdr thresholding are both asymptotically optimal at rate @xmath345 .    in the particular case of a gaussian scale model @xmath346 , corollary  [ cor - sub ] recovers corollaries 4.2 and 5.1 of @xcite .",
    "corollary  [ cor - sub ] additionally provides a rate , and encompasses the location case and other values of @xmath33 .",
    "we can legitimately ask whether the rate @xmath347 can be improved .",
    "we show that this rate is the smallest that one can obtain over a sparsity class @xmath348 $ ] for some @xmath349 , in the particular case of bfdr thresholding and in the laplace scale model ; see corollary 10.2 in the supplemental article  @xcite .",
    "while the calculations become significantly more difficult in the other models , we believe that the minimal rate for the relative excess risk of the bfdr is still @xmath350 in a subbotin location and scale models .",
    "also , since the fdr can be seen as a stochastic variation around the bfdr , we may conjecture that this rate is also minimal for fdr thresholding .",
    "let us consider the sparsity regime @xmath140 , @xmath351 .",
    "corollary  [ cor - sub ] suggests to choose @xmath3 such that @xmath352 .",
    "this is in accordance with the recommendation of  @xcite in the gaussian scale model ; see remark  5.3 therein . in this section",
    ", we propose an explicit choice of @xmath3 from an priori value @xmath353 of the unknown parameter @xmath354 .",
    "let us choose a value @xmath353 a priori for @xmath354 .",
    "a natural choice for @xmath3 is the value which would be optimal if the parameters of the model were @xmath355 .",
    "namely , by using ( [ qmopt ] ) in section  [ secpfdrthresholding ] , we choose @xmath356 , where @xmath357\\\\[-8pt ] & & \\eqntext{\\mbox{with $ q_m^{\\mathrm{opt } } ( \\beta_0,c_0)=m^{-\\beta_0 } c_0 / f_{m,0}^{-1}(c_0)$}}\\end{aligned}\\ ] ] by denoting @xmath358 the c.d.f .",
    "of the @xmath103-values following the alternative for the model parameters @xmath353 .",
    "for instance :    * gaussian location : @xmath359 ; * gaussian scale : @xmath360 , where @xmath361 is the solution of @xmath362 ; * laplace scale : @xmath363 , where @xmath364 is the solution of @xmath365 ,    where @xmath366 denotes @xmath367 for @xmath368 .",
    "the above choice of @xmath3 does depend on @xmath353 , which can be interpreted as a `` guess '' on the value of the unknown parameter @xmath354 .",
    "hence , when no prior information on @xmath354 is available from the data , the above choice of @xmath3 can appear of limited interest in practice . however , we would like to make the following two points :    * asymptotically , choosing @xmath369 always yields an optimal(b)fdr thresholding [ under ( [ bp ] ) ] , even if @xmath370 : by proposition  [ prop - bayes ] , we get @xmath371 and thus the asymptotic optimality is a direct consequence of corollary [ cor - sub](iii ) ; * nonasymptotically , our numerical experiments suggest that @xmath372 performs fairly well when we have at hand an a priori on the location of the model parameters : if @xmath354 is supposed to be in some specific ( but possibly large ) region of the `` sparsity@xmath373power '' square , choosing any @xmath374 in that region yields a thresholding procedure with a reasonably small risk ; see sections  5 and 14 in the supplemental article  @xcite.=-1    finally , let us note that the choice @xmath369 is motivated by the analysis of the bfdr risk , not that of the fdr risk . hence , it might be possible to choose a better @xmath3 for fdr thresholding , especially for small values of @xmath2 for which bfdr and fdr are different .",
    "because obtaining such a refinement appeared quite challenging , and as our proposed choice already performed well , we decided not to investigate this question further .",
    "[ remdcomp ] by choosing @xmath356 as in ( [ alphamopt0 ] ) , we can legitimately ask how large the constants are in the finite sample inequalities coming from corollary  [ cor - oracle ] in standard cases . to simplify the problem ,",
    "let us focus on the bfdr threshold and consider a @xmath33-subbotin location model with @xmath164 .",
    "taking @xmath140 , the parameters of the model are @xmath375\\times(0,1)$ ] .",
    "assume that the parameter sequence @xmath376 satisfies ( [ bp ] ) for some @xmath377 .",
    "then corollary 9.4 in the supplemental article @xcite provides explicit constants @xmath378 and @xmath379 such that the following inequality holds : @xmath380 as an illustration , in the gaussian case ( @xmath381 ) , for @xmath382 , @xmath383 , @xmath384 , @xmath385 and @xmath386 , we have @xmath387 and @xmath388",
    ". as expected , these constants are over - estimated : for instance , by taking @xmath389 , the left - hand side of ( [ oracleineqwithconstants ] ) is smaller than @xmath390 ( see figure  [ figgaussian - location - heatmap - c0=05 ] in the next section ) while the right - hand side of ( [ oracleineqwithconstants ] ) is @xmath391 .",
    "finally , we can check that @xmath392 becomes large when @xmath151 is close to @xmath0 or @xmath393 is close to @xmath1 .",
    "these configurations correspond to the cases where the data are almost nonsparse and where the bayes rule can have almost full power , respectively .",
    "they can be seen as limit cases for our methodology .    by using proposition  [ prop - bayes ] , as @xmath394 , @xmath395 , for an equivalent @xmath396 having a very simple form ; see section 10.1 in the supplemental article @xcite .",
    "therefore , we could use @xmath396 instead of @xmath397 .",
    "numerical comparisons between the ( b)fdr risk obtained according to @xmath397 and @xmath398 are provided in section 14 in the supplemental article @xcite . while @xmath396 qualitatively leads to the same results when @xmath2 is large ( say , @xmath399 )",
    ", the use of @xmath397 is more accurate for a small @xmath2 .",
    "in order to complement the convergence results stated above , it is of interest to study the behavior of fdr and bfdr thresholding for a small or moderate @xmath2 in numerical experiments .",
    "these experiments have been performed for the inductive risk @xmath400 defined by ( [ defrisk ] ) .",
    "the bfdr threshold @xmath401 can be approximated numerically , which allows us to compute @xmath402 .",
    "computing @xmath403 is more complicated because the fdr threshold @xmath404 is not deterministic .",
    "however , we can avoid performing cumbersome and somewhat imprecise simulations to compute     for various thresholding procedures ( rows ) and different values of @xmath2 ( columns ) . in each panel",
    ", the corresponding risk is plotted as a function of @xmath405 $ ] ( horizontal axis ) and @xmath406 $ ] ( vertical axis ) .",
    "colors range from white ( low risk ) to dark red ( high risk ) , as indicated by the color bar at the bottom .",
    "black lines represent the level set @xmath407 . the point @xmath355 is marked by `` @xmath408 . ''",
    "we chose @xmath409 and @xmath410 .",
    "see main text for details . ]",
    "@xmath403 by using the approach proposed in  @xcite and @xcite . using this methodology ,",
    "the full distribution of @xmath404 may be written as a function of the joint c.d.f . of the order statistics of i.i.d .",
    "uniform variables .",
    "let for any @xmath411 and for any @xmath412^k$ ] , @xmath413 where @xmath414 is a sequence of i.i.d .",
    "uniform variables on @xmath136 and with the convention @xmath415 .",
    "the @xmath416 s can be evaluated , for example , by using steck s recursion ; see  @xcite , pages 366369 . then , relation ( 10 ) in  @xcite entails @xmath417\\\\[-10pt ] & & \\hspace*{14pt}{}\\times\\psi_{m - k } \\bigl(1-g_m(\\alpha m / m ) , \\ldots,1-g_m\\bigl(\\alpha(k+1)/m\\bigr ) \\bigr),\\nonumber\\end{aligned}\\ ] ] where @xmath418 .",
    "for reasonably large @xmath2 ( @xmath419 in what follows ) , expression ( [ exactfdr ] ) can be used for computing the _ exact _ risk of fdr thresholding @xmath142 in our experiment .",
    "we quantify the quality of a thresholding procedure using the relative excess risk @xmath420 the closer the relative excess risk @xmath421 is to @xmath0 , the better the corresponding classification procedure is .",
    "figure  [ figgaussian - location - heatmap - c0=05 ] compares relative excess risks of different procedures in the gaussian location model ( results for the gaussian scale and the laplace scale models are qualitatively similar , see figures 5 and 6 in the supplemental article @xcite ) .",
    "each row of plots corresponds to a particular procedure , and each column to a particular value of @xmath422 .",
    "the first row corresponds to the bayes procedure defined by ( [ thres - bayes ] ) , where the model parameters are taken as @xmath423 .",
    "it is denoted by _ bayes0_. next , we consider bfdr ( rows 2 to 5 ) and fdr ( rows 6 to 9 ) thresholding at level @xmath3 , for @xmath424 ( independent of @xmath2 ) and for the choice @xmath425 defined in section  [ secchoicealpham ] .",
    "for each procedure and each value of @xmath2 , the behavior of the relative excess risk is studied as the ( unknown ) true model parameters @xmath426 vary in @xmath155 \\times[0,1]$ ] , and we arbitrarily choose @xmath427 and @xmath428 as the midpoints of the corresponding intervals , that is , @xmath429 ( similar results are obtained for other values of @xmath353 ; see figures 8 , 9 and 10 in the supplemental article @xcite ) .",
    "colors reflect the value of the relative excess risk .",
    "they range from white [ @xmath430 to dark red [ @xmath431 .",
    "black lines represent the level set @xmath407 , that is , they delineate a region of the @xmath432 plane in which the excess risk of the procedure under study is ten times less than the bayes risk .",
    "the number at the bottom left of each plot gives the fraction of configurations @xmath432 for which @xmath433 .",
    "this evaluates the quality of a procedure uniformly across all the @xmath432 values .    for @xmath434",
    ", we did not undertake exact fdr risk calculations : they were too computationally intensive , as the complexity of the calculation of function @xmath416 used in ( [ exactfdr ] ) is quadratic in @xmath2 .",
    "however , fdr risk is expected to be well approximated by bfdr risk for such a large value of @xmath2 , as confirmed by the fact that fdr and bfdr plots at a given level @xmath435 are increasingly similar as @xmath2 increases .",
    "bayes0 performs well when the sparsity parameter @xmath151 is correctly specified , and its performance is fairly robust to @xmath182 .",
    "however , it performs poorly when @xmath151 is misspecified , and increasingly so as @xmath2 increases .",
    "the results are markedly different for the other thresholding methods .",
    "bfdr thresholding and fdr thresholding are less adaptive to @xmath182 than bayes0 , but much more adaptive to the sparsity parameter @xmath151 , as illustrated by the fact that the configurations with low relative excess risk span the whole range of @xmath151 .    for @xmath356 , the fraction of configurations @xmath432 for which @xmath433 increases as @xmath2 increases .",
    "this illustrates the asymptotic optimality of ( b)fdr thresholding , as stated in corollary  [ cor - sub](iii ) , because @xmath436 .",
    "additionally , observe that the @xmath354-region around @xmath374 contains only very small values of @xmath437 , even for moderate @xmath2 .",
    "this suggests that , nonasymptotically , @xmath438 is a reasonable choice for @xmath3 , when we know a priori that the parameters lie in some specific region of the @xmath354-square .",
    "next , let us consider the case of ( b)fdr thresholding using a fixed value of @xmath439 . while our theoretical results show that choosing @xmath3 fixed with @xmath2 ( and in particular not tending to zero ) is always asymptotically sub - optimal , the results shown by figure  [ figgaussian - location - heatmap - c0=05 ] are less clear - cut .",
    "an explanation is that @xmath440 decreases only slowly to zero [ e.g. , @xmath441 for @xmath434 ] , hence the asymptotic is quite `` far '' and not fully attained by our experiments .",
    "hence , from a more practical point of view , in a classical situation where @xmath2 does not exceed , say , @xmath443 , a practitioner willing to use the ( b)fdr can consider two different approaches to calibrate @xmath444 : the first one is to take some arbitrary value , for example , @xmath445 , @xmath390 or @xmath446",
    ". the overall excess risk might be small , but the location of the region of smallest excess risk ( pictured in white in our figures ) is unknown , and depends strongly on @xmath435 and @xmath2 ( and even @xmath33 ) .",
    "in contrast , the second method @xmath438 `` stabilizes '' the region of the @xmath447-square where the ( b)fdr has good performance across all the values of @xmath2 ( and @xmath33 ) .",
    "thus , while the first method has a clear interpretation in terms of fdr , the second approach is more interpretable w.r.t .",
    "the sparsity and power parameters and is recommended when these parameters are felt to correctly parametrize the model .    finally note that , when considering the weighted mis - classification risk ( as formally defined in ( [ defw - risk ] ) and studied in section 11 in the supplemental article @xcite ) , there exists a particular choice of the weight ( as a function of @xmath2 ) such that the optimal ( b)fdr level @xmath438 does not depend on @xmath2 , making ( b)fdr thresholding with fixed values of @xmath3 asymptotically optimal , as noted by @xcite .",
    "this point is discussed in section  [ secweighting ] .",
    "[ secrelationpreviouswork ]    let us consider the sparsity range @xmath140 , with @xmath448 , for some given @xmath449 .",
    "assume ( [ bp ] ) with @xmath317 and @xmath393 defined therein .",
    "denote the set @xmath450\\times[c_-,c_+]$ ] by @xmath451 for short .",
    "the minimax risk is defined by @xmath452 where the infimum is taken over the set of thresholds that can be written as measurable functions of the @xmath103-values .",
    "obviously , @xmath453 , where @xmath454 is the bayes threshold .",
    "hence , by taking the supremum w.r.t .",
    "@xmath354 in our excess risk inequalities , we are able to derive minimax results",
    ". however , this requires a precise formulation of ( [ equ - aim2 ] ) where the dependence in @xmath151 of the constant @xmath392 is explicit . for simplicity ,",
    "let us consider the laplace scale model . by using ( 69 ) and ( 74 ) in the supplemental article  @xcite , and by taking @xmath455",
    ", we can derive that there exists a constant @xmath456 ( independent of @xmath457 , @xmath317 and @xmath393 ) such that for a large @xmath2 , @xmath458\\\\[-8pt ] & \\leq & r_m^{\\star } \\biggl ( 1+\\frac{-\\log(\\beta_-/2)}{\\beta_-(1-c_+ ) } \\frac{d'}{\\log m } \\biggr).\\nonumber\\end{aligned}\\ ] ] this entails that @xmath459 is asymptotically minimax , that is , @xmath460 this property can be seen as an analogue to the asymptotically minimaxity stated in theorem 1.1 in  @xcite and theorem 1.3 in @xcite , in an estimation context .    finally , regarding ( [ equ - minimax ? ] ) , an interesting avenue for future research would be to establish whether there are asymptotically minimax rules @xmath170 such that @xmath461 for a rate @xmath337 smaller than @xmath462 .      in our sparse setting ,",
    "where we assume that there are many more labels `` @xmath0 '' than labels `` @xmath1 , '' one could consider that mis - classifying a `` @xmath0 '' is less important than mis - classifying a `` @xmath1 . ''",
    "this suggests to consider the following weighted risk : @xmath463 for a known factor @xmath464 .",
    "this weighted risk was extensively used in  @xcite . in section 11 in the supplemental article @xcite",
    ", we show that all our results can be adapted to this risk . essentially , when considering @xmath465 instead of @xmath466 , our results hold after replacing @xmath87 by @xmath467 and @xmath224 by @xmath468 .    as an illustration ,",
    "let us consider here the case of a @xmath469-subbotin density , @xmath185 , @xmath296 $ ] , @xmath470 , where @xmath338 and @xmath339 for the location and scale cases , respectively .",
    "as displayed in table 4 in the supplemental article  @xcite , under the ( corresponding ) assumptions ( [ bp ] ) and ( [ sp ] ) , we show that a sufficient condition for fdr thresholding to be asymptotically optimal for the risk @xmath465 is to take @xmath471 , @xmath472 and @xmath473 .",
    "this recovers theorem 5.3 of  @xcite when applied to the particular case of a gaussian scale model ( for which @xmath339 ) .",
    "furthermore , we show that taking @xmath474 , that is , @xmath475 , leads to the optimality rate @xmath347 for the relative excess risk based on @xmath465 .",
    "while the order of @xmath270 is not modified when @xmath476 , it may be substantially different when @xmath477 .",
    "typically , @xmath478 leads to @xmath479 .",
    "hence , when considering @xmath480 instead of @xmath466 , the value of @xmath481 should be carefully taken into account when choosing @xmath3 to obtain a small excess risk .",
    "conversely , our result states that fdr thresholding with a pre - specified value of @xmath439 ( say , @xmath482 ) , is optimal over the range of weighted mis - classification risks using a @xmath481 satisfying @xmath483 and @xmath484 , and that choosing @xmath478 leads to the optimality rate @xmath347 .",
    "the proofs are first established for the misclassification risk @xmath485 defined by ( [ defrisk ] ) . the case of the misclassification risk @xmath486 , defined by ( [ defrisk - bis ] )",
    "is examined in section  [ secotherrisk ] .",
    "let us first state the following result .",
    "[ sharper - oipfdr ] consider the setting and the notation of theorem  [ main - th ] .",
    "then we have for any @xmath121 , @xmath487\\\\[-8pt ] & & { } + \\pi_{1,m } \\bigl(1-q_{m}^{-1}\\bigr ) \\bigl(c_m - f_m\\bigl(t_m^\\star\\bigr ) \\bigr).\\nonumber\\end{aligned}\\ ] ] furthermore , if @xmath236 , we have for any @xmath121 , @xmath488    to prove ( [ oracleequality ] ) , we use @xmath489 and @xmath27 , to write @xmath490 expression ( [ mainbornsup - improv1 ] ) is an easy consequence of ( [ oracleequality ] ) .",
    "finally , ( [ equ - interm - plus ] ) and ( [ oracleequality ] ) entail @xmath491 which yields ( [ mainbornsup - improv2 ] ) .",
    "theorem  [ main - th](i ) follows from ( [ mainbornsup - improv2 ] ) because @xmath492 by definition .",
    "let us now prove ( ii ) .",
    "first note that @xmath493 using ( [ riskfm ] ) and the upper bound @xmath494 , we obtain @xmath495 .",
    "this entails ( [ mainborninf ] ) and ( [ mainborninfasymp ] ) .      write @xmath138 instead of @xmath142 for short . to establish ( [ mainbornsup2-gen ] ) , let us first write the risk of fdr thresholding as @xmath496 , with @xmath497 and @xmath498 . in the sequel , @xmath499 and",
    "@xmath500 are examined separately .",
    "the next result is a variation of lemmas 7.1 and  7.2 in  @xcite .",
    "[ prop - bcfg ] the following bound holds : @xmath501    to prove proposition  [ prop - bcfg ] , we follow the proof of lemma 7.1 in  @xcite with slight simplifications . recall that we have by definition @xmath502 .",
    "hence , we have @xmath503 . by integrating w.r.t .",
    "the label vector @xmath504 , it is thus sufficient to prove @xmath505 let @xmath506 and @xmath507 .",
    "by exchangeability of @xmath508 , we can assume without loss of generality that the @xmath103-values corresponding to a label @xmath70 are @xmath509 for simplicity .",
    "let us denote @xmath510 the thresholding @xmath511 defined by ( [ equfdr ] ) , applied to the @xmath103-value family @xmath512 , in which each of the @xmath103-value @xmath513 has been replaced by @xmath0 .",
    "classically , we have @xmath514 where @xmath515 , where @xmath516 is the set of @xmath103-values corresponding to zero labels ; see , for example , lemma 7.1 in @xcite .",
    "since @xmath511 is nonincreasing in each @xmath103-value , setting some @xmath103-values equal to @xmath0 can only increase @xmath511 .",
    "this entails @xmath517 next , we use lemma 4.2 in  @xcite [ by taking `` @xmath518 , @xmath519 , @xmath520 '' with their notation ] , to derive that for any @xmath521 , @xmath522 bound ( [ toproveinprop - bcfg ] ) thus follows from ( [ equ - interm - t1 m ] ) .      let us consider @xmath523 the bfdr threshold associated to level @xmath524 .",
    "note that by definition of @xmath523 we have @xmath525 . here , we state the following inequalities , which , combined with proposition  [ prop - bcfg ] establishes theorem  [ main - th2 ] : @xmath526 first , ( [ erreurtype2-bonf ] ) is an easy consequence of @xmath527 .",
    "second , expression ( [ erreurtype2 ] ) derives from ( [ conc - borneinf ] ) of lemma  [ lemconc ] because @xmath528 ( by using @xmath529 ) and because .    [ lemconc ] the following bound holds : @xmath530    we prove lemma  [ lemconc ] by using a variation of the method described in the proof of theorem 1 in @xcite ( we use bennett s inequality instead of hoeffding s inequality ) . for any @xmath531 such that @xmath532 , we have @xmath533 next , by using bennett s inequality ( see , e.g. , proposition 2.8 in @xcite ) and by letting @xmath534 , for any @xmath535 , we obtain @xmath536 finally , for @xmath537 , since we have @xmath538 , we obtain ( [ conc - borneinf ] ) by using that @xmath539 for any @xmath540 .",
    "let us recall that @xmath486 and @xmath542 are equal for a deterministic threshold and thus also for the bfdr threshold .",
    "hence , theorem  [ main - th ] also holds for the risk @xmath486 , and we only have to prove theorem  [ main - th2].=-1 first note that since @xmath543 , we can work directly with @xmath249 . proving the type i error bound ( [ erreurtype1 ] ) can be done similarly : with the same notation , the type i error can be written conditionally on @xmath504 as @xmath544 by using ( [ equsansnom ] ) .",
    "hence , ( [ erreurtype1 ] ) is proved for the risk @xmath486 .",
    "next , the proof for bounding the type ii error derives essentially from the following argument , which is quite standard in the multiple testing methodology ; see , for example ,  @xcite .",
    "let us denote @xmath545\\dvtx\\alpha_m { { \\widetilde{\\mathbb{g}}_m}}(t)\\geq t\\bigr\\},\\ ] ] where @xmath546 denotes the empirical c.d.f . of the @xmath103-values where",
    "@xmath156 has been replaced by @xmath0 .",
    "then , for any realization of the @xmath103-value family , @xmath547 is equivalent to @xmath548 ; see , for example , proof of theorem  2.1 in  @xcite and section 3.2 of  @xcite .",
    "this entails that the type ii error is equal to @xmath549 [ by using the exchangeability of @xmath550 . finally , since @xmath551 and @xmath552",
    ", we have @xmath553 .",
    "hence @xmath554 and bounds ( [ erreurtype2-bonf ] ) and ( [ erreurtype2 ] ) also hold for the risk @xmath486 .",
    "we would like to thank guillaume lecu and nicolas verzelen for interesting discussions .",
    "we are also grateful to anonymous referees , an associated editor , and an editor for their very helpful comments and suggestions ."
  ],
  "abstract_text": [
    "<S> we study the properties of false discovery rate ( fdr ) thresholding , viewed as a classification procedure . </S>",
    "<S> the `` @xmath0''-class ( null ) is assumed to have a known density while the `` @xmath1''-class ( alternative ) is obtained from the `` @xmath0''-class either by translation or by scaling . </S>",
    "<S> furthermore , the `` @xmath1''-class is assumed to have a small number of elements w.r.t . </S>",
    "<S> the `` @xmath0''-class ( sparsity ) . </S>",
    "<S> we focus on densities of the subbotin family , including gaussian and laplace models . </S>",
    "<S> nonasymptotic oracle inequalities are derived for the excess risk of fdr thresholding . </S>",
    "<S> these inequalities lead to explicit rates of convergence of the excess risk to zero , as the number @xmath2 of items to be classified tends to infinity and in a regime where the power of the bayes rule is away from @xmath0 and @xmath1 . moreover , these theoretical investigations suggest an explicit choice for the target level @xmath3 of fdr thresholding , as a function of @xmath2 . </S>",
    "<S> our oracle inequalities show theoretically that the resulting fdr thresholding adapts to the unknown sparsity regime contained in the data . </S>",
    "<S> this property is illustrated with numerical experiments . </S>"
  ]
}