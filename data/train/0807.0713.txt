{
  "article_text": [
    "relativistic flows of magnetized plasmas are observed in a wide variety of astrophysical objects . at galactic scales ,",
    "accretion of matter around black holes in active galactic nuclei ( agn ) in addition results in well collimated jets emitted along the rotation axis . to explain their observed superluminal plasma motion at the parsec length scales , flows with lorentz factors of more than 10 are needed .",
    "the observed synchrotron emission indicates that these jets are pervaded by magnetic fields .",
    "even more powerful processes are at play in the highly relativistic blast waves associated with gamma ray bursts ( grbs ) . here",
    ", the plasma flows easily reach lorentz factors of 100 or even higher .",
    "the morphology and time evolution of these and other astrophysical objects often involve strong shocks and complex magnetic field topologies . to compute this kind of challenging relativistic plasma dynamics , the combination of adaptive mesh refinement ( amr ) with a robust",
    ", shock - capturing numerical method is therefore indispensible .    with growing interest in relativistic astrophysical phenomena ,",
    "various efforts are ongoing to develop numerical special relativistic hydrodynamic and magnetohydrodynamic codes .",
    "significant progress was achieved in the last decade with the development of conservative shock - capturing schemes , which use either exact riemann solvers or approximate riemann solvers , or more robust central type schemes , in relativistic hydrodynamics   ( for a contemporary review see ) and in relativistic magnetohydrodynamics .",
    "the study of relativistic hydrodynamic fluids currently starts to benefit also from using spatial and temporal adaptive techniques , or adaptive mesh refinement ( amr ) . to date",
    ", amr was incorporated only in some works , both in special relativistic magnetohydrodynamics @xcite and in general relativistic magnetohydrodynamics @xcite . at the same time , various authors , including @xcite , have shown that amr is imperative to simulate extreme astrophysical phenomena , such as those encountered in grbs .    in order to handle grb and other extreme relativistic flow regimes , the employed solver needs to be very robust under a wide variety of plasma conditions .",
    "therefore , we decided to use a conservative discretization which does not fully exploit the detailed solution knowledge of the riemann problem at each cell interface , defined by two constant states in contact .",
    "this contrasts with a true godunov scheme , which would compute the flux across cell interfaces from the exact solution to the local riemann problem . while fairly recently  @xcite , an exact riemann problem solver for the rmhd equations became available , the nonlinear iteration involved would make it a fairly computationally costly ingredient for a multidimensional code .",
    "as pointed out further , we already face a similar newton - raphson procedure to deduce primitive from conservative variables in every grid point .",
    "in fact , we follow the trend away from using exact or approximate riemann problem solvers in most codes in use to date . in the works cited above , komissarov  @xcite already used a linearized ( approximate ) riemann solver , and even fell back on an hlle variant  @xcite which only uses the fastest wave speeds .",
    "koldoba et al .",
    "@xcite and balsara  @xcite also employ an approximate , linearized riemann solver and presented numerical solutions for stringent 1d test problems .",
    "all other works mentioned   use central - type schemes , of either the local lax - friedrichs , hll , or hllc variant , suitably adopted to the relativistic mhd regime .",
    "we will use the simplest of these in our implementation , since in combination with automated grid adaptivity , we rely on convergence and robustness of the underlying discretization , while accuracy is most easily gained by raising the effective resolution employed .    the macroscopic dynamics of astrophysical objects with relativistic plasma flows are governed by the conservation of particle and momentum - energy , along with the maxwell equations to account for the involvement of the magnetic field . in sect .",
    "[ sec - eq ] , we recast the rmhd equations in conservation form .",
    "details on the implementation of the high - resolution shock - capturing scheme and the adaptive mesh refinement in our code can be found in sects .",
    "[ sec - scheme]-[sec - amr ] .",
    "the code is validated against several known 1d analytical solutions in sect .",
    "[ sec - tests ] and two multi - dimensional relativistic flow simulations are performed . in sect .",
    "[ sec - summ ] , a summary of the paper containing our main conclusions and an outlook for future applications of the code is given .",
    "we give a brief outline of the derivation of the relativistic magnetohydrodynamic ( rmhd ) equations and restrict the analysis to special relativity only . for a more extensive account",
    "we refer to  @xcite . along the way",
    ", we point out minor differences in the choice of conservative variables , as well as a possibility to exploit an entropy related variable .",
    "the dynamics follow from the maxwell equations and the conservation of particle number density and energy - stress .",
    "we will fix a lorentzian reference frame to perform the computations . due to lorentz contraction",
    "the fluid volume elements are contracted so that the particle number density is multiplied by the lorentz factor @xmath0 . here",
    ", @xmath1 is the spatial velocity three - vector .",
    "we measure in the often used scaling for which the speed of light is unity @xmath2 .",
    "the particle number conservation equation can generally be written as @xmath3 where @xmath4 is the proper mass density , i.e. , the density in that lorentz frame in which the fluid is locally at rest , @xmath5 is the four velocity that has to satisfy the constraint @xmath6 , and greek indices denote four vectors .",
    "we will use latin indices to denote three - vectors .",
    "the einstein summation convention for repeated indices is assumed .",
    "the antisymmetric dual field tensor @xmath7 can be defined in terms of the magnetic field @xmath8 and electric field @xmath9 as measured in the lorentzian reference frame by @xmath10 , @xmath11 , @xmath12 , where @xmath13 is the levi - cevita symbol .",
    "the homogeneous maxwell equations can be expressed in terms of this dual tensor as @xmath14 by subsequently assuming the fluid to be perfectly conducting , so that the comoving electric field vanishes or @xmath15 , and by introducing the four - vector @xmath16 the induction equation and @xmath17 transform to @xmath18    finally , conservation of energy and momentum follow from @xmath19 here @xmath20 are the fluid and electromagnetic energy - stress tensor , @xmath21 is the metric tensor in flat minkowski space - time , and @xmath22 is the relativistic specific enthalpy of the fluid in the local comoving frame . in the derivation of the electromagnetic tensor , use has been made of the maxwell equations .",
    "to make the equations more useful for the numerical approach based on temporally advancing conservation laws , we split the equations for the mass density ( [ eq - density ] ) , momentum and energy ( [ eq - stressenergy ] ) , and the magnetic field ( [ eq - induction ] ) in the space and time coordinates : @xmath23 in these equations , we have introduced the relativistic magnetic and total pressure @xmath24 where @xmath25 is the thermal pressure in the local comoving frame .",
    "the total relativistic specific enthalpy is given by @xmath26 the equations ( [ eq - cons1])([eq - cons8 ] ) are explicitly in conservation form .",
    "we actually combine the first and third equation as written above to arrive at @xmath27 where @xmath28 here , @xmath29 is the mass density in the inertial reference frame and @xmath30 is a measure for the enthalpy .",
    "the variable @xmath31 has a contribution from the rest mass density subtracted from the total energy density as written for the laboratory frame , and represents a small difference between our variables set and the one used in most implementations  @xcite .",
    "this makes the current set of variables reduce to the usual set employed in non - relativistic mhd computations in the limit of @xmath32 .",
    "this also helps to avoid potential numerical problems with negative pressures , in cases when the rest mass contribution is a dominant term in the energy density . in the case of an ideal equation of state with a constant polytropic index @xmath33 ,",
    "the variable @xmath34 becomes @xmath35 the quantity @xmath34 ( and @xmath36 ) reduces to the non - relativistic enthalpy , except for the inclusion of the rest mass contribution .",
    "it is noted that instead of choosing the energy density @xmath31 as a conserved variable , we can also switch to @xmath37 , where @xmath38 is the specific entropy .",
    "the energy equation is then replaced by @xmath39 expressing the conservation of entropy for ideal rmhd .",
    "this conservation law also follows from @xmath40 , so that @xmath41 leading after some algebra to the conservation of entropy .",
    "the energy equation has the distinct disadvantage that numerical calculations with small kinetic pressure compared to magnetic pressure can , depending on the @xmath42 strategy in use , easily result in negative pressure .",
    "this problem could be circumvented by switching to the entropy equation .",
    "the use of this entropy conservation law was also mentioned in  @xcite , where it is advised for use in applications without shocks . even on a fixed grid , a strategy for using this equation locally instead of the energy density law would need to be provided , explaining when positivity is preferred above strict conservation .",
    "examples of such switching strategies can be found in challenging cosmological ( non - relativistic ) hydro codes , such as in  @xcite . in the shock - dominated simulations described below , we as yet did not need to use such a switching strategy .",
    "however , the grid adaptive code employed here allows to use a related idea , but only at the time of restriction and prolongation actions . before every restriction / prolongation",
    ", we have the option to locally convert to the set of conserved variables @xmath43 , keeping both conservation and positivity garantueed in these operations .",
    "after the coarsening or refining action , we then revert to the original conservative set employed in the time integration routines .",
    "this makes this strategy particular to amr computations which can involve strong shocks , such as some of the tests presented below .",
    "while we did use this in some of our non - relativistic mhd computations so far , the tests mentioned below were performed without the need to invoke this entropy strategy .",
    "to advance the set of conservation equations ( [ eq - conseq][eq - consfluxes ] ) in time , we need to calculate the fluxes . the latter",
    "are obtained from the primitive variables @xmath44 .",
    "while the determination of the primitive variables for non - relativistic mhd is a straightforward algebraic manipulation , the transformation of the variables for the relativistic mhd equations needs a root finding algorithm .",
    "the analysis is facilitated by the introduction of the auxiliary variables @xmath45 , which are to be determined from the conservative variables @xmath46 only .",
    "once the auxiliary variables are known , the construction of the primitive variables will be straightforward .",
    "we follow the method given in @xcite to determine @xmath34 . from the definition of the conservative variables ( [ eq - consvars ] ) and @xmath45",
    ", we obtain the primitive variables @xmath47 and @xmath48 using the definition of @xmath31 in eq .",
    "( [ eq - consvars ] ) and the expression of @xmath34 ( [ eq - xidef ] ) , it follows that @xmath34 is the root of @xmath49=0 , \\label{eq - rootfinding}\\ ] ] where the second term is the kinetic pressure @xmath25 .",
    "the still unknown lorentz factor @xmath50 contains once more the variable @xmath34 as follows from eq .",
    "( [ eq - velocity ] ) : @xmath51 in the root finding algorithm , @xmath34 has to be found as a zero of eq .",
    "( [ eq - rootfinding ] ) with the help of the augmented equation ( [ eq - augmentedvar ] ) .",
    "the root @xmath34 is found by means of a newton - raphson method . in our implementation , the brackets for the newton - raphson method are found as follows : we constrain the pressure by a given lower bound @xmath52 , so that the values of @xmath34 are restricted from below by @xmath53 since @xmath54 .",
    "the velocity that follows from this bound on @xmath55 is constrained to a value below the speed of light , that means , by using eq .",
    "( [ eq - augmentedvar ] ) @xmath56 where @xmath57 represents a given threshold .",
    "if @xmath55 does not satisfy this condition , then find a new @xmath55 via a newton - raphson procedure from @xmath58 .",
    "the obtained @xmath55 is our lower bound . as a maximal bound for the bracketing we choose @xmath59 .",
    "next , we check the sign of @xmath60 and @xmath61",
    ". if they are the same , then the brackets are wrong , and a new guess for the brackets is found by successively replacing @xmath55 by @xmath62 and @xmath62 by @xmath63 .",
    "we follow this procedure till we have correct brackets .",
    "finally , we apply the newton - raphson method to find @xmath34 and @xmath64 , followed by a consistency check to ensure that @xmath65 and @xmath66 .",
    "the shock - capturing scheme used in this work needs the ( maximal ) characteristic speeds of a given state of a fluid element .",
    "since the equations are formulated in the inertial reference frame , we need to determine the characteristic wave speeds in this frame .    for each spatial dimension",
    "@xmath67 the rmhd equations ( [ eq - cons1])([eq - cons8 ] ) yields seven characteristic speeds .",
    "there is one entropy wave speed @xmath68 corresponding to the passive advection of entropy disturbances in ideal rmhd .",
    "the other characteristic wave speeds , however , come in pairs , namely , two slow magneto - acoustic waves speed @xmath69 , two alfvn wave speeds @xmath70 , and two fast magneto - acoustic wave speeds @xmath71 .",
    "the characteristic speeds are ordered according to the sequence of inequalities @xmath72 similar to the non - relativistic mhd equations .",
    "the entropy wave is just propagating with the fluid velocity @xmath73 .",
    "the alfvn disturbances propagate at speeds @xmath74 which includes relativistic corrections .",
    "the magneto - acoustic characteristic speeds follow from the quartic polynomial @xmath75}^2 \\right\\}=0,\\end{aligned}\\ ] ] and involves the relativistic hydrodynamic speed of sound @xmath76 .",
    "these magneto - acoustic wave speeds can be found algebraically , but the formulae are not numerically efficient and often susceptible to round - off errors .",
    "instead we use laguerre s method to find the four magneto - acoustic roots in the actual implementation .",
    "all roots are bound by the speed of light , so that they must lie in the interval @xmath77 -1,1 \\right[$ ] .",
    "the roots can be located close to each other , especially when they are of the order unity . making the transformation @xmath78",
    ", we obtain a quartic polynomial for @xmath79 .",
    "the roots are now better separated and are in the interval",
    "@xmath77 0.5,\\infty \\right[$ ] .",
    "if the requested accuracy is not obtained via laguerre s method , a root polishing is performed by the newton - raphson method .",
    "the above mentioned scheme for finding characteristic speeds can possibly be improved if the magneto - acoustic roots are almost degenerate . in that case root polishing by the newton - raphson procedure",
    "can unintentionally make the roots degenerate .",
    "it is then preferable to switch to maehly s procedure ( see @xcite ) .",
    "another improvement can be made by using the transformation @xmath80 to reduce the possibility of excessively large roots .",
    "another option which we implemented in our code is to compute the zeros in terms @xmath81 , which is somewhat better behaved for very large lorentz factor flows .      in the present paper ,",
    "we employ the total variation diminishing lax - fiedrichs ( tvdlf ) scheme  @xcite for relativistic mhd applications .",
    "temporal second order accuracy is achieved by the hancock predictor step @xmath82 . \\label{hancock}\\ ] ] here , @xmath83 denote the cell - center to cell - face limited slope used in the tvdlf scheme . in our work",
    "we will mostly use the rather diffusive , but stable ` minmod ' limiter @xmath84 . \\label{minmod}\\end{aligned}\\ ] ] in the full correction step , the numerical fluxes are @xmath85\\right\\ } , \\label{tvdlf}\\end{aligned}\\ ] ] where the left and right states are @xmath86 respectively .",
    "this tvdlf scheme does not use a riemann solver .",
    "the only information needed is the fastest characteristic wave speed @xmath87 .    in this second order scheme ,",
    "some improvement is obtained if the limited slopes are calculated via the primitive variables .",
    "we have best experience with @xmath88 .",
    "note the inclusion of the lorentz factor @xmath64 in the fluid velocity .",
    "we also experimented with hll and hllc solvers ( see e.g.  ) , which use more information of the riemann fan at cell interfaces , but leave their application outside the scope of this paper .",
    "it is our impression that the use of grid adaptivity makes the difference between these base solvers of secondary importance .      in our multidimensional rmhd applications ,",
    "we handle the @xmath17 constraint by adding a diffusive source term proportional to @xmath89 to the induction equation .",
    "the diffusion coefficient is determined by setting the maximum allowed diffusion time step equal to the cfl time step . on a cartesian mesh",
    ", we obtain the source term update @xmath90 where @xmath91 for stability reasons . for most applications ,",
    "a value @xmath92 is advised .",
    "this is similar to the strategy used for non - relativistic mhd on curvilinear grids in  @xcite .",
    "this type of treatment for the @xmath17 can be regarded as the parabolic variant of the hyperbolic / parabolic treatment discussed for ideal , non - relativistic mhd in dedner et al .",
    "our source treatment redistributes potential local monopole errors over a wider area than where they would normally concentrate .",
    "it should be noted that this is more meant as a means to stabilize the overall numerical scheme and to avoid potential numerical instabilities , than as a manner to annihilate discrete monopole contributions alltogether .",
    "the latter is not needed in any numerical integration , where we will always have truncation errors in the magnetic field components , even if we numerically ensure a kind of minimal @xmath42 .",
    "the hyperbolic cleaning from  @xcite in addition advects these locally occuring numerical monopole errors , while damping them in a similar fashion . in case of shock - dominated problems ( like those presented further on ) , discrete monopole errors are continuously arising at shock locations , so the damping by itself is in our opinion the most important part of the error control strategy .",
    "the same idea was first suggested in electromagnetic pic codes , by marder  @xcite , and is now also routinely used  @xcite in the only 3d global tokamak plasma simulations feasible to date , performed by the nimrod consortium .",
    "one scheme for resistive relativistic mhd has recently been presented in  @xcite , where the fluxes are handled using an hll scheme instead of our tvdlf method , while the divergence treatment there uses the generalized lagrange multiplier approach from munz et al .",
    "this in essence is the hyperbolic variant from  @xcite , and our parabolic treatment can be seen as belonging to the same family of monopole treatments . in  @xcite ,",
    "a comparison of the parabolic treatment against other popular source term strategies ( powell source terms as e.g. described in  @xcite , or only modifying the induction equation as suggested by janhunen  @xcite ) was performed for various multidimensional , non - relativistic mhd problems using amr .",
    "the most extensive comparison of magnetic divergence control in multi - dimensional , non - relativistic mhd scenarios for fixed grids can be found in tth  @xcite . in particular , the powell source term treatment was then tested against a variety of constrained transport implementations , which insist on ensuring @xmath17 to machine precision in one particular pre - chosen discretization only , as well as against an elliptic cleaning scheme .",
    "the latter strategy projects the obtained @xmath93 to a divergence free magnetic field @xmath94 , and involves the solution of a poisson equation for @xmath95 .",
    "noteworthy is that it was also found in  @xcite that one does not need to enforce its solution to machine precision either .",
    "all of these schemes were found to yield acceptable simulation results on the nine tests verified there .",
    "some of these tests were revisited in the grid adaptive computations presented in  @xcite , where only different source term treatments were compared .",
    "those that specifically only modify the induction equation are readily incorporated in the relativistic mhd regime , and they do not violate the conservation of the other than magnetic variables . in our multidimensional tests",
    "below , we quantify the remaining errors in @xmath42 for illustration purposes only : the fact thay they remain bounded at all times is the most important observation to be checked there .",
    "there are two amr versions implemented in our amrvac code , namely a modified version of the original patch approach of berger  @xcite and a hybrid block - based  @xcite strategy",
    ". we will give a brief outline of these methods and refer to the literature for details .",
    "once a procedure is given for detecting cells that are needed for resolving flow features , the amr must arrange these cells in a hierarchy of properly nested grids . in the original patch - based scheme of berger , each cell flagged for refinement",
    "is surrounded by a buffer - zone of a user given size to ensure that discontinuities and other regions that need high resolution do not propagate to coarser cells .",
    "this collection of flagged cells are then changed so that it satisfies the proper nesting : each level @xmath96 cell is in between level @xmath97 and @xmath98 .",
    "these cells are subsequently stored into a hierarchy of properly nested grids ( patches ) .",
    "the patches are then bisected till a given efficiency is reached .",
    "this efficiency is expressed as the ratio of the flagged to the total amount of cells within a patch .",
    "finally , a patch merging process is called to reduce the computational cost of too many small grids . in the amrvac code , see @xcite , the overlap of patches on the same amr level is avoided , while a minimal efficiency is enforced .    in the same amrvac code ,",
    "yet another amr scheme is implemented .",
    "this so - called hybrid block - amr method  @xcite uses , like block - based amr techniques , an equal number of grid cells for each grid in the entire grid hierarchy .",
    "the basic structure is an octree ( in three dimensions ) .",
    "however , if a block is flagged for refinement , this scheme relaxes on the standard approach where a block triggers in a @xmath99-dimensional calculation @xmath100 new sub - blocks ( children ) . this consequently introduces incomplete block families in the grid hierarchy .",
    "therefore , the hybrid method approaches the optimal fit of the grid structure in the patch scheme .",
    "however , due to fixing the number of cells per grid , the good cache performance of the common tree block - based approach is fully exploited .",
    "the procedure to identify which cells are to be triggered for refinement relies on a type of richardson extrapolation .",
    "the error estimator implemented in amrvac is a variant of the procedure given in @xcite .",
    "given the solution vector @xmath101 and @xmath102 on level @xmath96 and with a time difference @xmath103 , the error estimator will first determine @xmath104 in the following two ways :    * coarsen @xmath101 and then advance to time @xmath105 .",
    "* advance @xmath102 to time @xmath105 and then coarsen .    the resulting solution vectors are compared and , based on a certain selection of the conservative variables with mutual weighting factors , cells will be flagged in an automated fashion for refinement if a given tolerance is exceeded .",
    "in addition , user - enforced refinement is possible and the auxiliary variables , like the lorentz factor , can be exploited in the error estimator .",
    "essential in the amr strategy is the restoring of the global conservation across the entire grid hierarchy .",
    "this amounts to fixing the fluxes of coarse cells with the fluxes of the neighboring fine cells .",
    "moreover , the prolongation , restriction , and/or temporal interpolation between different grid levels need to be performed on the conservative variables . to avoid the possible introduction of negative pressure , especially in the vicinity of small ratio of kinetic to magnetic pressure , we have implemented in amrvac the option to use primitive variables during the regridding process .",
    "another option , as pointed out earlier , would be to switch to the entropy @xmath37 instead of energy during the regridding process .",
    "then the amr scheme is still conservative , but avoids the introduction of negative pressure .",
    "a direct validation of the code is provided by performing a series of riemann problem tests , where an initial discontinuity is left to evolve dynamically . for relativistic mhd , a recent contribution by  @xcite documented how one can obtain the exact ` analytic ' solution when accounting for the up to 7 wave signals that may emerge out of the @xmath106 problem .",
    "the method was demonstrated for 10 specific initial conditions , and we reproduce all these 10 cases numerically here .",
    "they collect various tests reported in recent code developments for relativistic mhd @xcite , augmented with some new riemann problems .",
    "our results are shown in figs .",
    "[ f - rp1]-[f - rp2 ] , where we overplot in all cases the exact solution generated by  @xcite .",
    "we briefly comment on each case in what follows .",
    "we typically compute with up to 8 grid levels , and use a base resolution of 60 unless stated otherwise .",
    "the exact initial conditions are fully specified in  @xcite , and we refer to that paper for details .",
    "the first two tests have @xmath107 throughout , so that only two fast signals and a tangential discontinuity emerges .",
    "the first two rows of fig .",
    "[ f - rp1 ] correspond to the shock - tube 2 , and generic shock tube test , respectively .",
    "the first has a left - going fast rarefaction , a tangential discontinuity , and a fast shock , and presents no major difficulty .",
    "the generic shock tube test has a leftgoing fast shock and rightgoing rarefaction , with a tangential discontinuity in between .",
    "we find overshoot errors at both the shock and the tangential discontinuity , which diminish only by raising the overall resolution significantly : in fig .",
    "[ f - rp1 ] this test here exploited 240 base level grid points , and we still have an erroneous variation in between shock and tangential signal in @xmath108 .",
    "the next set of 8 tests considers cases where @xmath109 .",
    "the third to fifth row in fig .",
    "[ f - rp1 ] shows the outcome for the 3 coplanar problems , where at most 5 wave signals can emerge .",
    "the third row has no @xmath110 or @xmath111velocity nor magnetic field components , and represents a typical challenge when a contact discontinuity is in close vicinity to a fast shock .",
    "our amr computation with the tvdlf scheme adequately resolves the narrow structure , with a rather unavoidable large number of grid points to represent the contact .",
    "the fourth test is a collision leading to two pairs of left and rightgoing fast and slow shocks .",
    "similar to all documented numerical solutions , we can hardly avoid to generate a central error in density @xmath4 , which should remain constant in between the two slow shocks . the final case shown in fig .",
    "[ f - rp1 ] is the relativistic analogue of the brio - wu test  @xcite .",
    "a left going rarefaction , a slow compound , a contact discontinuity , and a slow and fast shock are encountered from left to right .",
    "the correspondence with the analytic solution is satisfactory , with many grid points representing the contact jump .",
    "note that the method to generate the ` exact solution ' excludes the possibility of compound waves , in part invalidating the comparison there .",
    "the tests collected in fig .  [ f - rp2 ] reproduce tests from  @xcite and the generic alfvn test introduced by @xcite .",
    "the top row has left going fast and slow rarefactions , a contact and rightgoing slow and fast shocks . only the many grid points in the contact is arguable , but at the same time the variation is captured at the highest grid level activated .",
    "the next test has a similarly structured outcome , with an even more extreme length contraction effect at play between right - going contact , slow and fast shock .",
    "the latter are accurately captured at the correct amplitude , as best seen in the @xmath112 plot .",
    "the third row of fig .",
    "[ f - rp2 ] yields another stringent collision test analogous to the one shown in fig .",
    "[ f - rp1 ] . with no major differences in solution strategy ,",
    "the numerical result here ( with base resolution 120 ) is far less polluted by a central density error .",
    "the last two tests trigger all 7 wave signals from the initial discontinuity , with alfvn discontinuities in between the slow and fast signal pairs . at the times shown , the spacing between alfvnic and slow signals can be very close still .",
    "for the fourth row in fig .",
    "[ f - rp2 ] , the balsara test 5 case , it is expected to be down to order @xmath113 for the leftgoing alfvn discontinuity and slow rarefaction .",
    "it is seen in the @xmath114 plot how even higher effective resolution would need to be used to capture this transition exactly .",
    "still , we correctly find all wave signals .",
    "the last generic alfvn test has a similar challenge for the alfvn signals adjacent to slow shocks .",
    "the outmost left - going fast rarefaction and right - going fast shock are captured on the lowest grid resolution only for this test , which can be changed by fine - tuning the employed refining criterion . in summary ,",
    "our grid - adaptive numerical solutions show a favorable agreement with the analytic results in all cases .      in a first 2d test , we recompute the relativistic rotor problem , a test first performed in non - relativistic mhd settings , and subsequently modeled in a relativistic variant by  @xcite .",
    "we simulate the very same problem on a larger domain @xmath115 ^ 2 $ ] , in order to follow the rotor evolution at higher effective resolution to a longer time than presented originally .",
    "the polytropic index is constant at @xmath116 , while initial pressure is unity throughout .",
    "a high density circular disk with @xmath117 rotates anti - clockwise at uniform angular velocity @xmath118 within radius @xmath119 from the center of the domain .",
    "the disk discontinuously connects to a tenfold lower density , static medium .",
    "the entire domain is pervaded by a homogeneous horizontal field @xmath120 . using 7 refinement levels",
    "we acquire an effective resolution of @xmath121 .",
    "this represents locally a four times higher resolution than used in  @xcite , which compensates for the difference in order of accuracy employed ( a third order method versus our second order scheme , on smooth solutions ) .",
    "we intentionally followed the rotor evolution to twice the time reported earlier , till @xmath122 .",
    "in  @xcite , slight corrugations in density could be detected cospatial with shear flow regions at time @xmath123 , and we intended to investigate their potential role in any further nonlinear evolution .",
    "snapshots at @xmath123 and @xmath122 are shown in fig .",
    "[ f - rot ] .",
    "fast shock fronts can be detected to travel outwards into the static surroundings , and inwards towards the disk center .",
    "slow rarefactions are found in between , and the field deflections in effect brake the initial fast rotation ( @xmath124 ) .",
    "the overall evolution remains pointsymmetric . at @xmath123",
    "the field in the disk has rotated over about @xmath125 , and the in- and outwards traveling shocks can be clearly detected .",
    "we found somewhat higher instantaneous lorentz factors than those reported before , and no evidence of density corrugations . also , as shown in the second snapshot where the inward shocks have already collided , no clear indication of a shear - induced fine structure was found .",
    "the automated grid refinement does follow the density variations at the highest grid resolution throughout the computation .",
    "an impression of the location of the intermediate level 5 grids ( two more grid levels exist on top of this level ) is shown in fig .",
    "[ f - rot ] .    to illustrate the magnetic monopole control used in this particular simulation , we provide various quantitative measures for it in fig .",
    "[ f - rotdivb ] . as stated earlier , the parabolic treatment is meant to stabilize the computation and uses a discrete evaluation of the magnetic field divergence in a diffusive type source term .",
    "the errors themselves are unavoidably created continuously at the location of the strongest discontinuities . in this simulation ,",
    "even the first timestep introduces finite monopole errors at the border of the ` rotating disk ' , since we effectively break the field lines there ( e.g. the central field line gets disconnected in two locations , where from one grid point to the next we jump from static to lorentz factor 10 flow ) .",
    "these monopoles can locally and temporarily be of order unity , while the diffusive treatment then spreads and diffuses these errors during the computation . in fig .",
    "[ f - rotdivb ] , the left panel shows two domain averaged error monitors as a function of time : it can be seen that these mean values remain at @xmath126 in this computation .",
    "the fact that they do not grow without bound is the most important observation , confirming their stabilizng role .",
    "the right panel from fig .",
    "[ f - rotdivb ] is at the final time @xmath127 , and shows the instantaneous distribution of the monopoles , as evaluated in centered difference approximation .",
    "black values are locally order unity , and the largest errors necessarily coincide with the various shock wave fronts .",
    "note that our restriction and prolongation strategies do not particularly enforce solenoidal fields in any discrete sense , so grid level boundaries can temporarily be detected in such error maps .",
    "again , the role of the parabolic term then acts to diffuse such errors at their maximal rate and it is important to note that this does not affect any of the employed conservative variables adversely .    in a second 2d application , we generalize a shock - dominated time - dependent problem frequently used in benchmarking classical mhd codes to the relativistic regime .",
    "the non - relativistic test  @xcite considers a mach 1 vortex superposed on a multiple magnetic island configuration , on a doubly periodic @xmath128 ^ 2 $ ] cartesian domain .",
    "it starts from uniform density and pressure throughout , and the supersonic rotation concentrates magnetic field gradients in thin , localized current sheets from which shock fronts originate , which subsequently interact .",
    "our relativistic analogue considers a relativistically hot gas , where the internal energy dominates over the rest mass contribution , such that the relativistic sound speed approaches its maximal value @xmath129 .",
    "this is consistent with a polytropic index value @xmath130 , and we set the initial pressure @xmath131 while proper density @xmath132 .",
    "the vortex imposes a velocity field @xmath133 where @xmath134 , ensuring subluminal and supersonic velocities .",
    "the maximal initial lorentz factor is then about 7 .",
    "the magnetic field is then initialized at @xmath135 which makes the ratio of magnetic to thermal pressure attain a maximal value of @xmath136 .",
    "we simulated this problem for times beyond @xmath137 , at which time the maximal lorentz factor encountered has dropped to about @xmath138 .",
    "the simulation used a @xmath139 base resolution , with a maximal 7 refinement levels , effectively mimicking a @xmath140 resolution .",
    "the initial magnetic topology is characterized by alternating @xmath141 and @xmath142 nul - points ( where the field vanishes ) , with 4 different @xmath141 and 4 @xmath142 type nuls in the doubly periodic domain . along the @xmath143",
    "horizontal , we thus encounter two islands of closed field ( to the left and right of the central @xmath141 point ) , and this pattern repeats on @xmath144 with distinct @xmath145 phase difference . the superposed vortical velocity will immediately displace the left - central island in a diagonally upwards fashion , while distorting the right - central island diagonally downwards .",
    "the double periodicity implies that the island situated midway the horizontal boundaries gets squashed in the process , and oriented in a diagonally downwards current sheet .",
    "this violent compression will drive two shock waves , one from either side of this sheet , traveling against the original flow direction . in a similar fashion",
    ", the flow induces a strong shearing at the @xmath141 point midway the vertical sides , with similar accumulation of matter along a diagonally upward pointing sheet .",
    "there too , two shock fronts separate off the compression zone .",
    "the first panel of fig .",
    "[ f - ot ] at @xmath146 superposes the field structure on the ( logarithmic ) proper density , clearly showing the four diagonal shock fronts and the island deformations just described .",
    "these four interacting shock fronts meet up in the centre of the domain , while the sheet formed in the compressed @xmath142 configuration eventually demonstrates a spontaneous break - up forming a series of islands .",
    "this tearing type reconnection happens at about @xmath147 . in this sudden topological magnetic reconfiguration ,",
    "some of the smaller islands get accelerated towards the shock fronts traveling away from the sheared and compressed @xmath141 point . in the second panel of fig .",
    "[ f - ot ] at @xmath148 , some of these islands and the shock front deformations they cause can be seen .",
    "these and similar interactions occuring with the diagonal shock fronts converging to the sheared @xmath141 sheet , drive a second sequence of strong density variations colliding upon both the compressed @xmath142 point ( now with its island structure ) and the sheared @xmath141 sheet .",
    "a second quadruplet of shocks then propagates away from these locations .",
    "this causes intricate shock - shock interference patterns with the original 4 shock fronts .",
    "the sheared @xmath141 sheet in fact also gets torn up into an island chain structure , as seen in the third panel from fig .",
    "[ f - ot ] .",
    "eventually , also this second shock sequence meets up at the centre , while only some of the islands from the original @xmath142 and @xmath141 sheet tearing events survive as localized density enhancements or depletions .",
    "the final panel of fig .",
    "[ f - ot ] shows the by now rather complicated density distribution near time @xmath137 .",
    "the point - symmetry about the centre of the domain is preserved perfectly throughout the entire grid - adaptive computation .",
    "note that this long - term computation gives strong evidence for intricate reconnection events , which will be influenced by the numerical scheme employed : it could be of interest to benchmark several higher order schemes , in combination with varying strategies for magnetic monopole control , on this problem in particular .",
    "ultimately , deviations from perfect conductivity would need to be explicitly accounted for .    as a final illustration of the parabolic monopole treatment used in this test , fig .",
    "[ f - otdivb ] collects the temporal evolution of various domain averaged error monitors over most of the simulated period .",
    "once more , the error diffusion approach works as intended , despite the presence of very strong interacting shock fronts , the sudden appearance of magnetic island chains , and the continuously adjusting amr grid hierarchy .",
    "we provided details on our relativistic grid - adaptive mhd code , and tested it using recently available riemann problem solutions , as well as multi - dimensional setups .",
    "the latter include a new long - term simulation demonstrating shock - shock interactions and reconnection events , and this could be of interest to benchmark existing shock - capturing algorithms on long - term shock - dominated relativistic magnetized flow problems , such as those recently presented in  @xcite .    in future work",
    ", the rmhd code amrvac will be used to model agn jet propagation  @xcite and grb dynamics .",
    "the magnetic field is suggested as possible ingredient to achieve the high lorentz factor flows , such as reached by the grb fireball , and plays a crucial role in both agn and grb flow collimation .",
    "other future projects concentrate on implementing a more realistic equation of state to investigate the launching and the propagation of relativistic jet .",
    "we will discuss these astrophysical applications with more detail in future publications .",
    "we acknowledge the use of an exact relativistic riemann solver from bruno giacomazzo , for overplotting the exact solutions in fig .",
    "[ f - rp1]-[f - rp2 ] .",
    "computations have been performed on the k.u.leuven high performance computing cluster vic .",
    "zm and rk acknowledge financial support from the netherlands organization for scientific research , nwo grant 614.000.421 , and ` stichting voor fundamenteel onderzoek der materie ' fom .",
    "aloy , j.m .",
    "ibez , j.m .",
    "mart , e. mller , genesis : a high - resolution code for three - dimensional relativistic hydrodynamics , _ apjs _ , * 122 * , 151 ( 1999 ) .",
    "m. anderson , e.w .",
    "hirschmann , s.l .",
    "liebling , d. neilsen , relativistic mhd with adaptive mesh refinement , _ cqgra _ , * 23 * , 6503 ( 2006 ) .",
    "p. anninos , p.c .",
    "fragile , j.d .",
    "salmonson , cosmos++ : relativistic magnetohydrodynamics on unstructured grids with local adaptive refinement , _ apj _ , * 635 * , 723 ( 2005 ) .",
    "balsara , total variation diminishing scheme for relativistic magnetohydrodynamics , _ astrophys .",
    "ser . _ * 132 * , 83 ( 2001 ) .",
    "berger , data structures for adaptive grid generation , _ siam j. sci .",
    "comput . _ * 7 * , 904 ( 1986 )",
    "berger and p. colella , local adaptive mesh refinement for shock hydrodynamics , _ j. comput",
    ". phys . _ * 82 * , 64 ( 1989 ) .",
    "j. bergmans , r. keppens , d.e.a .",
    "van odyck , and a. achterberg , simulations of relativistic astrophysical flows , in `` adaptive mesh refinement  theory and applications '' , eds .",
    "t. plewa , t. linde , and v.g .",
    "weirs , lect . not .",
    ". eng . * 41 * , 223 ( 2005 ) .",
    "m. brio and c .- c .",
    "wu , an upwind differencing scheme for the equations of ideal magnetohydrodynamics , _",
    "j. comput .",
    "_ * 75 * , 400 ( 1988 ) .",
    "bryan , m.l .",
    "norman , j.m .",
    "stone , r. cen , and j.p .",
    "ostriker , a piecewise parabolic method for cosmological hydrodynamics , _ comput .",
    "commun . _ * 89 * , 149 ( 1995 ) .",
    "a. dedner , f. kemm , d. krner , c .- d .",
    "munz , t. schnitzer , m. wesenberg , hyperbolic divergence cleaning for the mhd equations , _ j. comput .",
    "phys . _ * 175 * , 645 ( 2002 ) .",
    "l. del zanna and n. bucciantini , an efficient shock - capturing central - type scheme for multidimensional relativistic flows .",
    "i. hydrodynamics , _ astron",
    ". astrophys . _ * 390 * , 1177 ( 2002 ) .",
    "l. del zanna , n. bucciantini , and p. londrillo , an efficient shock - capturing central - type scheme for multidimensional relativistic flows .",
    "magnetohydrodynamics , _ astron",
    ". astrophys . _ * 400 * , 397 ( 2003 ) .",
    "r. donat , j.a .",
    "font , j.m .",
    "ibez , and a. marquina , a flux - split algorithm applied to relativistic flows , _ j. comput",
    "_ , * 146 * , 58 ( 1998 ) .",
    "f. eulderink and g. mellema , special relativistic jet collimation by inertial confinement , _ astron . astrophys . _",
    "* 284 * , 654 ( 1994 ) .",
    "b. einfeld , on godunov - type methods for gas dynamics , _ siam j. numer .",
    "* 25 * , 294 ( 1988 ) j.a . font , j.m .",
    "ibez , a. marquina , j.m .",
    "mart , multidimensional relativistic hydrodynamics : characteristic fields and modern high - resolution shock - capturing schemes , _ astron .",
    "_ * 282 * , 304 ( 1994 ) .",
    "b. giacomazzo and l. rezzolla , the exact solution of the riemann problem in relativistic magnetohydrodynamics , _ journal of fluid mechanics _ * 562 * , 223 ( 2006 ) .",
    "b. giacomazzo and l. rezzolla , whiskymhd : a new numerical code for general relativistic magnetohydrodynamics , _ cqgra _ * 24 * , s235 ( 2007 ) .",
    "a. harten , p.d .",
    "lax , b. van leer , on upstream differencing and godunov - type schemes for hyperbolic conservation laws , _ siam rev . _ * 25 * , 35 ( 1983 ) v. honkkila and p. janhunen , hllc solver for ideal relativistic mhd , _",
    "j , comput .",
    "_ * 223 * , 643 ( 2007 ) .",
    "janhunen , a positive conservative method for magnetohydrodynamics based on hll and roe methods , _ j. comput . phys . _",
    "* 160 * , 649 ( 2000 ) .",
    "r. keppens , m. nool , g. tth , and j.p .",
    "goedbloed , adaptive mesh refinement for conservative systems : multi - dimensional efficiency evaluation , _ comp .",
    "comm . _ * 153 * , 317 ( 2003 ) .",
    "r. keppens , z. meliani , b. van der holst , and f. casse , extragalactic jets with helical magnetic fields : relativistic mhd simulations , _ astron .",
    "_ , accepted for publication _",
    "( astro - ph arxiv:0802.2034 ) _ s.s .",
    "komissarov , a godunov - type scheme for relativistic magnetohydrodynamics , _ mnras _ * 303 * , 343 ( 1999 ) .",
    "komissarov , multi - dimensional numerical scheme for resistive relativistic mhd , _ mnras _ * 382 * , 995 ( 2007 ) .",
    "koldoba , o.a .",
    "kuznetsov , and g.v .",
    "ustyugova , an approximate riemann solver for relativistic magnetohydrodynamics , _ mnras _ * 333 * , 932 ( 2002 ) .",
    "t. leismann , l. antn , m.a .",
    "aloy , e. mller , j.m .",
    "mart , j.a .",
    "miralles , and j.m .",
    "ibez , relativistic mhd simulations of extragalactic jets , _ astron .",
    "astrophys . _",
    "* 436 * , 503 ( 2005 ) .",
    "b. marder , a method for incorporating gauss law into electromagnetic pic codes , _",
    "j. comput .",
    "_ * 68 * , 48 ( 1987 ) .",
    "mart and e. mller , numerical hydrodynamics in special relativity , _ living rev . in relativity _ * 6 * , 7 ( 2003 ) .",
    "z. meliani , r. keppens , f. casse , d. giannios , amrvac and relativistic hydrodynamic simulations for gamma - ray burst afterglow phases , _ mnras _ * 376 * , 1189 ( 2007 ) a. mignone and g. bodo , an hllc riemann solver for relativistic flows - i. hydrodynamics , _ mnras _ * 364 * , 126 ( 2005 ) .",
    "a. mignone and g. bodo , an hllc riemann solver for relativistic flows - ii .",
    "magnetohydrodynamics , _ mnras _ * 368 * , 1040 ( 2006 ) .",
    "a. mignone , g. bodo , s. massaglia , t. matsakos , o. tesileanu , c. zanni , and a. ferrari , pluto : a numerical code for computational astrophysics , _ astrophys .",
    "ser . _ * 170 * , 228 ( 2007 ) .",
    "munz , p. omnes , r. shneider , e. sonnendrcker , u. voss , divergence correction techniques for maxwell solvers based on a hyperbolic model , _ j. comput",
    ". phys . _ * 161 * , 484 ( 2000 ) .",
    "picone and r.b .",
    "dahlburg , evolution of the orszag - tang vortex system in a compressible medium .",
    "supersonic flow , _ phys .",
    "fluids b _ * 3 * , 29 ( 1991 ) . k.g .",
    "powell , p.l .",
    "roe , t.j .",
    "linde , t.i .",
    "gombosi , d.l .",
    "de zeeuw , a solution - adaptive upwind scheme for ideal magnetohydrodynamics , _ j. comput .",
    "phys . _ * 154 * , 284 ( 1999 ) .",
    "w.h . press ,",
    "teukolsky , w.t . vetterling , and b.p .",
    "flannery , numerical recipes in fortran , cambridge univ .",
    "press , cambridge ( 1992 ) .",
    "d. ryu , j.p .",
    "ostriker , h. kang , and r. cen , a cosmological hydrodynamic code based on the total variation diminishing scheme , _ astrophys .",
    "j. _ * 414 * , 1 ( 1993 ) .",
    "sovinec , a.h .",
    "glasser , t.a .",
    "gianakon , d.c .",
    "barnes , r.a .",
    "nebel , s.e .",
    "kruger , d.d .",
    "schnack , s.j .",
    "plimpton , a. tarditi , m.s .",
    "chu , the nimrod team , nonlinear magnetohydrodynamics simulation using high - order finite elements , _ j. comput .",
    "phys . _ * 195 * , 355 ( 2004 ) .",
    "g. tth , the @xmath149 constraint in shock - capturing magnetohydrodynamics codes , _ j. comput",
    ". phys . _ * 161 * , 605 ( 2000 ) .",
    "g. tth and d. odstril , comparison of some flux corrected transport and total variation diminishing numerical schemes for hydrodynamic and magnetohydrodynamic problems , _",
    "j. comput .",
    "phys . _ * 128 * , 82 ( 1996 ) .",
    "b. van der holst and r. keppens , hybrid block - amr in cartesian and curvilinear coordinates : mhd applications , _ j. comput",
    "_ * 226 * , 925 ( 2007 ) .",
    "p. wang , t. abel , w. zhang , relativistic hydrodynamic flows using spatial and temporal adaptive structured mesh refinement , _ astroph _ , astro - ph/0703742 ( 2007 ) w. zhang and a.i .",
    "macfadyen , ram : a relativistic adaptive mesh refinement hydrodynamics code , _ apjs _ , 164 , 255 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> a robust second order , shock - capturing numerical scheme for multi - dimensional special relativistic magnetohydrodynamics on computational domains with adaptive mesh refinement is presented . </S>",
    "<S> the base solver is a total variation diminishing lax - friedrichs scheme in a finite volume setting and is combined with a diffusive approach for controlling magnetic monopole errors . </S>",
    "<S> the consistency between the primitive and conservative variables is ensured at all limited reconstructions and the spatial part of the four velocity is used as a primitive variable . </S>",
    "<S> demonstrative relativistic examples are shown to validate the implementation . </S>",
    "<S> we recover known exact solutions to relativistic mhd riemann problems , and simulate the shock - dominated long term evolution of lorentz factor 7 vortical flows distorting magnetic island chains .    ,    , and </S>"
  ]
}