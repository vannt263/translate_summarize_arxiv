{
  "article_text": [
    "ecological data analysis has been very productive in the second part of the 20th century .",
    "many original multivariate data analysis methods have been developed , particularly those designed to tackle the fundamental issue of ecology : the description of the relationships between species and their environment .",
    "these methods study the relationships between species and their environment through two data tables , called a `` pair of ecological tables . ''",
    "the first of these two tables contains environmental variables ( in columns ) recorded in a set of sampling sites ( rows ) .",
    "these variables are usually quantitative , physico - chemical properties , for example , and they can also be categorical .    the second table of the pair is the species table , containing species data recorded at the same sampling sites",
    ". this can be the number of organisms , their presence / absence , or an abundance level .",
    "the rows in this table correspond to the sampling sites , and its columns correspond to the species . @xcite present a short review of linear ordination methods for studying species  environment relationships , and the paper by @xcite features a comparison of the advantages and disadvantages of recent methods .",
    "ecologists are also interested in the _ changes _ in the relationships between species and environment [ @xcite ] .",
    "indeed , variations of these relationships can be important , for example , from the point of view of species conservation or for global change studies . when sampling is repeated in time ( or in space )",
    ", one gets a sequence of tables , also called a  @xmath0-table . when a pair of ecological tables is repeated , the result is a pair of @xmath0-tables , or two data cubes .",
    "one sequence of tables makes one data cube , and a sequence of pairs of tables makes a pair of data cubes ( a species data cube plus an environmental data cube ) .",
    "analyzing the relationships between the two cubes can give useful insights into the evolution of species  environment relationships .",
    "from the point of view of statistical methods , two approaches can be contrasted : the descriptive strategy and the predictive strategy .",
    "the aim of the first one is an objective description of the data set and of the relationships between its components .",
    "the second approach is orientated toward the prediction of `` explained '' ( or `` dependent '' ) variables by `` explanatory '' ( or `` independent '' ) ones .",
    "this distinction implies an asymmetry of predictive methods and a symmetry of descriptive ones .",
    "indeed , descriptive methods do not differentiate between `` explained '' and `` explanatory '' variables .",
    "this difference has consequences on computational constraints : predictive methods have a matrix inversion step that is not present in descriptive methods .",
    "this matrix inversion step has negative consequences on the data sets that can be analyzed : it means that `` explanatory '' variables must be independent ( in the statistical sense ) , that is , that they must be linearly independent , because the rank of their correlation matrix must not be less than its dimension .",
    "this also implies that the number of cases ( samples ) must not be less than the number of explanatory variables .",
    "this constraint is particularly important since the advent of bioinformatics , with the huge data sets provided by high throughput molecular biology methods like dna microarrays and dna fingerprints .",
    "these methods can produce extremely large data tables with very low information density .",
    "there are potentially thousands of variables , corresponding , for example , to electrophoresis bands or to dna sequence tags .",
    "conversely , descriptive methods can be used without constraint on the ratio between the number of samples and the number of variables .",
    "the main body of this paper is restricted to this approach .",
    "figure  [ fig1 ] shows a diagram describing the methods that we are going to present , with the corresponding data structures .",
    "abbreviations are given in the rest of this introduction .",
    "in the context of ecological data analysis , the distinction between predictive and descriptive methods is particularly important in two cases : when samples ( the rows of data tables ) belong to groups , and in the case of a pair of ecological tables .",
    "when _ groups of samples _ are involved , linear discriminant analysis ( lda ) [ @xcite ] is a classical example of a predictive approach . between - group",
    "analysis ( bga ) [ @xcite ; @xcite ] is a descriptive method analogous to lda , but it can be used even when the number of samples is less than the number of variables .",
    "it can be seen simply as the pca of the table of group means . within - group",
    "analysis ( wga ) [ @xcite ] is the reverse of between - group analysis : it is the pca of the residuals between initial data and group means .",
    "it removes the effect of the grouping variable and analyzes the remaining variability .",
    "the standard for the analysis of _ one pair _ of ecological tables is canonical correspondence analysis ( cca ) [ @xcite , not to be confused with canonical correlation analysis ( cancor ) ] .",
    "canonical correspondence analysis can be seen as a particular form of correspondence analysis ( ca ) [ @xcite ; @xcite ] or of multiple correspondence analysis ( mca ) [ @xcite ] , where sample scores are constrained to be a linear combination of environmental variables .",
    "it belongs to the predictive approach , and involves a regression step ( including a matrix inversion ) .",
    "it is therefore restricted to the case where explanatory variables ( usually environmental parameters ) are linearly independent and not too many . redundancy analysis ( rda ) [ @xcite ] is similar to canonical correspondence analysis , but it is a constrained pca instead of a constrained correspondence analysis .    on the other hand",
    ", co - inertia analysis ( coia ) [ @xcite ; @xcite ] belongs to the descriptive approach .",
    "it a simple and robust alternative to canonical correspondence analysis when the number of samples is low compared to the number of explanatory ( environmental ) variables .",
    "co - inertia analysis can be seen as the pca of the table of cross - covariances between the variables of the two tables .",
    "other advantages are detailed in @xcite .",
    "@xmath1-table analysis methods are used to analyze _ series _ of tables .",
    "they belong to three families : statis [ @xcite ; @xcite ] , multiple factor analysis ( mfa ) [ @xcite ] , and multiple co - inertia analysis ( mcoia ) [ @xcite ] . partial triadic analysis ( pta ) [ @xcite ] is one of the simplest analyses of the statis family , and it can be seen as the pca of a series of pcas .",
    "multivariate analysis methods for _ pairs of data cubes _ are not widespread .",
    "two of them are based on co - inertia : the first one is called between - group co - inertia analysis ( bgcoia ) [ @xcite ] , and the second one is the statico method [ @xcite ; @xcite ] . in this paper",
    "we present a new method called costatis , and we compare it with bgcoia and statico .",
    "the name statico means `` statis and co - inertia , '' while costatis means `` co - inertia and statis . ''",
    "statis is a french abbreviation for `` structuration des tableaux",
    " trois indices de la statistique '' ( organization of three way tables in statistics ) .",
    "the comparison of the three methods is done on the same data set as the one used by @xcite and by @xcite .",
    "bgcoia and statico have already been presented in biological journals , so we briefly present their methodological bases .",
    "the costatis method has never been presented before , so we explain it here .",
    "we compare the results of the three methods from a rather practical point of view , on their respective graphical outputs for the same data set , and on their global properties .",
    "functions for the r software [ @xcite ] to perform computations and graphical displays for the three methods are available in the ade4 package [ http://pbil.univ-lyon1.fr/ade4/ see @xcite ; @xcite ] . all the computations and graphical displays can be redone interactively online , thanks to this reproducibility page : http://pbil.univ - lyon1.fr / saoasopet/.",
    "the three data cube coupling methods presented here are based on three different basic analyses : between - group analysis , co - inertia analysis and partial triadic analysis . in this section",
    "we give a short summary of these basic analyses in the framework of the duality diagram .",
    "we start the section by presenting a description of the example data set .",
    "we present the results of the three data cube coupling methods using graphical displays obtained on the same data set",
    ". this data set is the one used by @xcite and by @xcite .",
    "numerical data are printed in both papers , and they are also available in the r package `` ade4 , '' in the `` meau '' data set . a picture of these data as two data cubes is given in figure  [ fig2 ] .",
    "they are arranged in two tables : one table with 24 rows and 10 columns , containing the environmental variables , and one table with 24 rows and 13 columns , containing the species data .",
    "the rows of both tables correspond to 6 sampling sites ordered upstream - downstream along a small stream , the maudret ( south - east of france , in the vercors massif ) .",
    "site 6 is a control , located on another stream , the bourne , into which the maudret flows .",
    "these 6 sites are sampled 4 times , in spring , summer , autumn and winter .",
    "the 10 environmental variables are physico - chemical measures : water temperature , flow , ph , conductivity , oxygen , biological oxygen demand ( bod5 ) , oxidability , ammonium , nitrates and phosphates .",
    "most of these variables are related to water pollution .",
    "indeed , there is a large summer mountain resort ( autrans ) located between sites 1 and 2 , and its influence is predominant .",
    "the 13 columns of the species data table correspond to 13 ephemeroptera species ( mayflies ) , which are known to be highly sensitive to water pollution .",
    "these species are as follows :    eda @xmath2 _ ephemera danica _",
    ", bsp @xmath2 _ baetis sp .",
    "_ , brh @xmath2 _ baetis rhodani _ , bni @xmath2 _ baetis niger _ , bpu @xmath2",
    "_ baetis pumilus _ , cen @xmath2 _ centroptilum _ , ecd @xmath2 _ ecdyonurus _ , rhi @xmath2 _ rhithrogena _ , hla @xmath2 _ habrophlebia lauta _",
    ", hab @xmath2 _ habroleptoides modesta _ , par @xmath2 _ paraleptophlebia _ , cae @xmath2 _ caenis _ , eig @xmath2 _ ephemerella ignita_.    the goal of the analysis of this data set is to enlighten the relationships between ephemeroptera species distribution and the quality of water .",
    "more precisely , data analysis methods should help discover how these relationships vary in the space ",
    "time experimental setup ( i.e. , according to seasons during one year and along the stream ) .      the duality diagram [ @xcite ; holmes ( @xcite ) ] will be used in this paper to present several methods , so we explain it here first for a simple principal component analysis ( pca ) .",
    "let @xmath3_{(n , p)}$ ] be the data table ( environmental variables table , for example ) , with @xmath4 rows ( sampling sites ) and @xmath5 columns ( variables ) .",
    "@xmath6 is the transpose of @xmath7 .",
    "let @xmath8 be the diagonal matrix ( @xmath9 ) of site weights : @xmath10 , and let @xmath11 be a metric on  @xmath12 .",
    "the duality diagram of the general analysis of the data table is as follows :    @xmath13^{\\mathbf{d}_p } & \\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar [ d]^{\\mathbf{x}\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar[u]^{\\mathbf{x}^t } & \\fbox{$\\mathbb{r}^n$ } \\ar [ l]^{\\mathbf{d}_n } \\\\ } \\end{array } % \\ ] ]    this is called a `` duality diagram '' because @xmath14 and @xmath15 are the dual spaces of @xmath16 and @xmath17 , and because the dual operators @xmath18 and @xmath19 share the same spectrum .",
    "this diagram is completely defined by the `` triplet notation '' : ( @xmath20 ) , and the total inertia of this statistical triplet is @xmath21    the generalized pca ( gpca ) of this triplet corresponds to the spectral decomposition of @xmath22 .",
    "when @xmath8 is the matrix of uniform row weights ( @xmath23 ) , and @xmath11 is the identity ( euclidean metric ) , then this analysis is a simple pca , and if the variables are centered , the inertia is the sum of their variances .    this duality diagram can be seen as a picture of the underlying mathematical objects used in the theoretical description of the analysis .",
    "it has several functions , like making it easier to remember the characteristics of particular methods ( mnemonic ) , finding out the matrices that are needed to perform computations ( for example , doing one way around the diagram gives the matrix from which eigenvalues and eigenvectors should be extracted ) , or where particular objects ( like row scores and variable loadings ) can be found and how to compute them .",
    "@xcite give a detailed description of the use of the duality diagram in multivariate ecological data analysis and in the ade4 package for the r environment .",
    "between - group analyses [ doldec andchessel ( @xcite ) ; @xcite ] are a particular class of analyses , similar in their aim to linear discriminant analysis , but comprising no matrix inversion step .",
    "they consist in the summary ( for example , by a pca ) of the table of group means . in a second step ,",
    "the rows of the initial table are projected in this pca to get row scores for all observations .",
    "the advantage is that there is no constraint on the number of observations compared to the number of variables , and no problem with numerous and/or correlated variables , as it is the case in lda .",
    "there are several types of between - group analyses , corresponding to the initial analysis after which between - group analysis is computed .",
    "this can be , for example , a pca , a correspondence analysis , or a multiple correspondence analysis .    in between - group analysis",
    ", samples belong to @xmath24 groups , namely , @xmath25 , with group counts @xmath26 , and @xmath27 . between - group",
    "analysis is the analysis of triplet @xmath28 , where @xmath29 is the @xmath30 matrix of group means : @xmath31_{(g , p)}.\\ ] ] the term @xmath32 is the mean of variable @xmath33 in group @xmath0 . in matrix notation , if @xmath34 is the matrix of class indicators , @xmath35_{(n , g)}$ ] , with @xmath36 if @xmath37 and @xmath38",
    "if @xmath39 , then we have @xmath40    matrix @xmath41 is the diagonal matrix of ( possibly nonuniform ) group weights , and @xmath42 is the transpose of @xmath34 .",
    "the corresponding duality diagram is the following : @xmath13^{\\mathbf{d}_p } & \\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar [ d]^{\\mathbf{x}_b\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{g}^*}$ } \\ar[u]^{\\mathbf{x}_b^t } & \\fbox{$\\mathbb{r}^g$ } \\ar [ l]^{\\mathbf{d}_{g } } \\\\ } \\end{array } % \\ ] ]    between - group analysis is therefore the analysis of the table of group means , leading to the diagonalization of matrix @xmath43 .",
    "it s aim is to highlight the differences between groups , and row scores maximize the between - group variance .",
    "the statistical significance of these differences can be tested by a permutation test , with a criterion equal to the between / total variance ratio .",
    "row scores of the initial data table can be computed by projecting the rows of table @xmath7 on the principal component subspaces .",
    "the first presentation of co - inertia analysis dates back to @xcite , but almost ten years later , @xcite gave a more detailed presentation and compared it with canonical correspondence analysis . just as inertia is a sum of variances , co - inertia is a sum of squared covariances , and co - inertia analysis describes the co - structure between two ecological data tables by summarizing as well as possible the squared covariances between species and environment .",
    "here is a short description of this analysis .",
    "let @xmath7 be the first table ( environment variables table ) , with @xmath4 rows ( sampling sites ) and @xmath5 columns ( variables ) , and let @xmath44 be the second table ( species data ) , with the same @xmath4 rows and @xmath45 columns ( species ) .",
    "@xmath6 and @xmath46 are the transpose of @xmath7 and  @xmath44 .",
    "let @xmath8 be the diagonal matrix ( @xmath9 ) of site weights : @xmath47 , and let @xmath11 and @xmath48 be two metrics on @xmath12 and @xmath49 respectively . before doing the co - inertia analysis , we need to analyze each table separately .",
    "the duality diagrams of the separate analyses of the two data tables are as follows : @xmath13^{\\mathbf{d}_p } & \\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar [ d]^{\\mathbf{x}\\ , , } \\\\ \\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar[u]^{\\mathbf{x}^t } & \\fbox{$\\mathbb{r}^n$ } \\ar [ l]^{\\mathbf{d}_n } \\\\ } \\end{array}\\hspace*{4pt } % \\begin{array}{c } \\xymatrix@l=8pt { \\fbox{$\\mathbb{r}^q$ } \\ar[r]^{\\mathbf{d}_q } & \\fbox{$\\mathbb{r}^{{q}^*}$ } \\ar [ d]^{\\mathbf{y}\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar[u]^{\\mathbf{y}^t } & \\fbox{$\\mathbb{r}^n$ } \\ar [ l]^{\\mathbf{d}_n } \\\\ } \\end{array } % \\ ] ]    a generalized pca of these triplets corresponds to the spectral decomposition of @xmath22 and @xmath50 .",
    "when @xmath51 is the matrix of uniform row weights ( @xmath23 ) , and @xmath52 and @xmath48 are identity ( euclidean metrics ) , then these analyses are simple pca .    co - inertia analysis is defined by the duality diagram obtained by merging these two separate diagrams .",
    "this will be possible when they have the same spaces @xmath53 and @xmath54 in common , which implies that the rows of the two tables must be identical .",
    "the `` coupled diagram '' of co - inertia analysis is therefore @xmath55_{\\mathbf{d}_p } & \\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar [ l]_{\\mathbf{x}^t } \\ar[r]^{{\\mathbf{y}}^t } & \\fbox{$\\mathbb{r}^q$ } \\ar [ d]^{\\mathbf{d}_q\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar[r]_{\\mathbf{x } } & \\fbox{$\\mathbb{r}^n$ } \\ar [ u]_{\\mathbf{d}_n } & \\fbox{$\\mathbb{r}^{{q}^*}$ } \\ar[l]^{\\mathbf{y } } \\\\ }",
    "\\end{array } % \\ ] ]    co - inertia analysis is the eigenanalysis of matrix @xmath56 ( starting in @xmath12 ) .",
    "this is equivalent to the following `` crossed diagram '' : @xmath13^{\\mathbf{d}_p } & \\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar [ d]^{\\mathbf{y}^t\\mathbf{d}_n\\mathbf{x}\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{q}^*}$ } \\ar[u]^{\\mathbf{x}^t\\mathbf{d}_n\\mathbf{y } } & \\fbox{$\\mathbb{r}^q$ } \\ar[l]^{\\mathbf{d}_q } \\\\ } \\end{array } % \\ ] ]    this diagram highlights the fact that co - inertia analysis is the analysis of a cross product table , and its triplet notation is ( @xmath57 ) .",
    "if the columns of both tables are centered , then the total inertia of each table is simply a sum of variances : @xmath58 and @xmath59 . and",
    "the co - inertia between @xmath7 and @xmath44 is in this case a sum of squared covariances : @xmath60    co - inertia analysis maximizes the covariance between the row scores of the two tables [ @xcite ] .",
    "co - inertia is high when the values in both tables are high simultaneously ( or when they vary inversely ) and low when they vary independently or when they do not vary .",
    "this is interesting from an ecological point of view : co - inertia analysis will show species that are abundant when some environmental variables are particularly high ( or low ) , and it will discard species that are not influenced by these environmental variable .",
    "this is the meaning of the co - structure between the two data tables .",
    "the above `` coupled diagram '' shows the similarity of co - inertia analysis with canonical correlation analysis ( cancor ) .",
    "indeed , the only difference between the co - inertia analysis and canonical correlation analysis duality diagram [ @xcite , p. 352 ; @xcite ] comes from the metrics on @xmath12 and @xmath49 : @xmath55_{\\mathbf{v}^{-1}_{11 } } & \\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar[l]_{\\mathbf{x}^t } \\ar[r]^{{\\mathbf{y}}^t } & \\fbox{$\\mathbb{r}^q$ } \\ar [ d]^{\\mathbf{v}^{-1}_{22}\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar[r]_{\\mathbf{x } } & \\fbox{$\\mathbb{r}^n$ } \\ar [ u]_{\\mathbf{d}_n } & \\fbox{$\\mathbb{r}^{{q}^*}$ } \\ar[l]^{\\mathbf{y } } \\\\ } \\end{array } % \\ ] ]    canonical correlation analysis uses the mahalanobis metric on @xmath61 and  @xmath49 , whose matrices are the inverse of the covariance matrices @xmath62 and @xmath63 .",
    "this leads to the canonical correlation analysis triplet : ( @xmath64 ) .",
    "canonical correlation analysis row scores maximize their correlation , but this can be achieved with very small variances . by maximizing the covariance instead of the correlation , co - inertia analysis ensures that the scores do not have very small variances , and therefore have a good percentage of explained variance in each space .",
    "this diagram also clarifies the link between co - inertia analysis and instrumental variable methods like principal component analysis with respect to instrumental variables ( pcaiv ) [ @xcite ] , and particularly canonical correspondence analysis and redundancy analysis , which are primordial in ecological data analysis : @xmath55_{\\mathbf{v}^{-1}_{11 } } & \\fbox{$\\mathbb{r}^{{n}^*}$ } \\ar[l]_{\\mathbf{x}^t } \\ar[r]^{{\\mathbf{y}}^t } & \\fbox{$\\mathbb{r}^q$ } \\ar [ d]^{\\mathbf{d}_q\\ , . } \\\\",
    "\\fbox{$\\mathbb{r}^{{p}^*}$ } \\ar[r]_{\\mathbf{x } } & \\fbox{$\\mathbb{r}^n$ } \\ar [ u]_{\\mathbf{d}_n } & \\fbox{$\\mathbb{r}^{{q}^*}$ } \\ar[l]^{\\mathbf{y } } \\\\ } \\end{array } % \\ ] ]    in instrumental variables methods , the mahalanobis metric is used in only one of the two spaces , most often the environmental variables space  ( @xmath12 ) .",
    "this corresponds to the situation where one wants to explain species distribution by linear combinations of environmental variables , and this leads to the usual pcaiv triplet : ( @xmath65 ) .",
    "partial triadic analysis [ @xcite ] belongs to the statis family of the @xmath0-table analysis methods [ see , for example , the special issue of the journal _ comput .",
    "statist . data anal . _ * 18*(1 ) ( 1994 ) , or @xcite ] .",
    "the statis family can be thought of as providing a pca of a set of pca s . in ordinary pca ,",
    "the data table is summarized by a vector ( principal component ) , and in statis methods , the @xmath0-table is summarized by a matrix . partial triadic analysis is the most simple of these methods , but it is also the most restrictive one . its aim is to analyze a series of @xmath0 tables having the same rows and the same columns .",
    "this means that the same variables must be measured at the same sampling sites , several times .",
    "partial triadic analysis , like any statis - like method , follows three steps : interstructure , compromise and intrastructure ( also called `` trajectories '' ) .",
    "the interstructure step provides the coefficients of a special linear combination of the data tables , leading to an optimal summary called the `` compromise . ''",
    "the second step computes the pca of this linear combination .",
    "the intrastructure step is a projection of the rows and columns of each table of the series into the multidimensional space of the compromise analysis .",
    "the interstructure is based on the concepts of `` vector variance '' and `` vector covariance '' [ @xcite ] .",
    "it constructs a matrix of scalar products between tables ( the vector covariance matrix ) that can be written simply @xmath66 , where @xmath67 is the @xmath0th table from the series .",
    "the eigenanalysis of this vector covariance matrix gives a first eigenvector , and the components @xmath68 of this first eigenvector are used as weights to compute the compromise .",
    "alternatively , a `` vector correlation '' matrix can be used , that rescales the tables : @xmath69 .",
    "@xmath70 is the vector variance of table @xmath0 : @xmath71 .",
    "it is simply the usual variance of the vector obtained by putting all the columns of table @xmath67 one below the other .",
    "the compromise @xmath72 is a linear combination of the initial tables , weighted by the components of the first eigenvector of the interstructure : @xmath73 .",
    "the inertia of this compromise is maximized , and its main property is that it maximizes the similarity with all the initial tables , as measured by the sum of their squared dot product , @xmath74 . when the tables are normed , the dot product is the @xmath75 coefficient .",
    "the weight of each table is proportional to its inertia , so tables that are different from the others will be downweighted .",
    "this property ensures that the compromise will resemble all the tables of the sequence `` as closely as possible '' in a least square sense .",
    "the analysis of this compromise , for example , by a pca , gives two - dimensional representations ( principal axes maps ) that can be used to interpret its structure .",
    "the intrastructure is obtained by projecting the rows and columns of each table of the series in the analysis of the compromise ( i.e. , the rows are projected on the principal axes , and the columns are projected on the principal components ) .",
    "this step is done in the same way as the projection of supplementary elements in a simple pca [ see , for example , @xcite , page  14 ] .",
    "let @xmath76 be the matrix of the eigenvectors of the analysis of the compromise .",
    "the scores of the rows of table @xmath67 are @xmath77 , and the coordinates of its columns are @xmath78 , where @xmath79 is the diagonal matrix of the inverse of the square root of the eigenvalues of the analysis of the compromise .",
    "the advantage of partial triadic analysis is that it highlights the `` stable structure '' in a sequence of tables .",
    "the compromise step displays this stable structure ( when it exists ) , and the intrastructure step shows how each table moves away from  it .",
    "in this section we present three methods for analyzing a pair of data cubes : bgcoia , statico and costatis .",
    "the principle of each method is briefly explained , and the result obtained on the example data set is detailed .",
    "figure  [ fig3 ] shows a comparison of the three approaches .",
    "bgcoia is a  between - group co - inertia analysis .",
    "it is therefore simply computed by doing a co - inertia analysis on the two tables of group means , considering each table as a group [ @xcite ] . in statico",
    ", we first use co - inertia analysis @xmath0 times to compute the sequence of @xmath0 cross - covariance tables , and then partial triadic analysis to analyze this new @xmath0-table . in costatis , we first use two partial triadic analyses to compute the compromises of the two @xmath0-tables , and then co - inertia analysis to analyze the relationships between these two compromises .          let @xmath24 be the number of groups .",
    "the table of group means for environmental variables is obtained by computing the means of each variable within each group .",
    "this gives a new table , with @xmath24 rows and @xmath5 columns .",
    "the same computations are done for the species data table , leading to a  second new table with @xmath24 rows and @xmath45 columns .",
    "a simple co - inertia analysis is performed on these two new tables .",
    "the rows of the initial tables can be projected into this analysis to help interpret the results [ @xcite ] .",
    "the main advantage of this method is its simplicity , from both theoretical and practical points of view .",
    "the two data cubes are reduced to two tables by taking the means of the columns of each elementary table of the cubes .",
    "co - inertia analysis is then applied to the two resulting tables .",
    "the fact that it is a between - group analysis can be used to give more importance to the spatial or the temporal effect in a space  time experimental design .",
    "tables can correspond to dates or to sampling sites and , depending on the importance that should be given to space or time processes , one or the other of the two possibilities can be used . on the example data set used here , @xcite considered that one table corresponds to one sampling site , so we use the same setup .",
    "note that the symmetric method , within - group co - inertia analysis ( wgcoia ) based on co - inertia analysis and within - group analysis [ @xcite ] can also be used to analyze one effect after removing the other , which results in four possible setups and four different analyses ( between dates , between sites , within dates and within sites ) .",
    "figure  [ fig4 ] shows the results of the between - group co - inertia analysis ; it corresponds to figure  4 of @xcite .",
    "figure  [ fig4]a is the principal axes map of the rows of the cross product table ( ephemeroptera species ) , figure  [ fig4]b is the principal axes map of the columns ( environmental variables ) , and figure  [ fig4]c is the principal axes map of the sites",
    ". figures  [ fig4]a and  [ fig4]b are obtained directly with the row scores and column loadings of the cross product table , while figure  [ fig4]c is obtained by projecting the rows of the two sequences of tables as supplementary elements into the co - inertia analysis space .",
    "the 48 points on figure  [ fig4]c correspond to the 6 sites , sampled 4 times , and there is one set of points for the environmental variables table sequence ( open circles ) and one set of points for the ephemeroptera species table sequence ( black circles ) .",
    "the columns of these two sequences of tables ( environmental variables at each date and ephemeroptera species at each date ) could also be projected into the co - inertia analysis , but this has not been done here .",
    "the four points corresponding to the four sampling dates for each site are grouped to form a star , and the barycenter of these four points is labeled with the number of the site ( white background label for the environmental variables table sequence , gray background label for the ephemeroptera species table sequence ) .    the interpretation of figure  [ fig4]c is simple .",
    "the first axis ( figure  [ fig4]b , horizontal ) is a pollution gradient from left ( unpolluted situation : high concentration of oxygen and high ph ) to right ( highly polluted situation : high concentrations of amonium and phosphates , high conductivity and oxydability , high biological oxygen demand ) .",
    "the second axis ( figure  [ fig4]b , vertical ) is an upstream - downstream physical gradient : discharge ( `` flow '' ) increases downstream ( upward on the figure ) .",
    "most ephemeroptera species are more abundant in unpolluted situations ( figure  [ fig4]a , horizontal ) , and some species are characteristic of the lower part of the stream ( bsp , eig , ecd ) , while others ( bpu , hla , eda ) are characteristic of the upper part , or of site 6 ( figure  [ fig4]a , vertical ) .",
    "figure  [ fig4]c shows that the spatial component of the phenomenon is more important than the temporal aspect . the first axis ( figure  [ fig4]c , horizontal ) opposes unpolluted sites ( site 1 , upstream the autrans summer mountain resort , and site 6 ) to highly polluted sites ( site 2 , just downstream autrans , and receiving the ouputs of the sewer system ) .",
    "sites 3 , 4 and 5 are less and less polluted .",
    "this corresponds to the natural restoration process : the pollution is gradually resorbed along the stream .",
    "figure  [ fig4]c also shows that the biological processes are very linked to the physico - chemical variations of water quality along the stream : the two ordinations of sites are very similar .",
    "the statico method is based on the partial triadic analysis of a sequence of cross product tables ( see figure  [ fig3 ] )",
    ". starting from the sequence of paired ecological tables , each cross product table is computed using the pair of tables at each date .",
    "all the tables of the sequence do not need to have the same number of rows , but they need to have the same number of columns across dates .",
    "this means that the number of sampling sites can vary from one date to another , but the number of environmental variables ( @xmath5 ) must be the same for all the dates , and the number of species  ( @xmath45 ) must also be the same for all dates .",
    "therefore , all the cross product tables have the same number of rows ( @xmath5 ) and columns ( @xmath45 ) . they contain the covariances between the columns of the two tables .",
    "let ( @xmath80 ) and ( @xmath81 ) be the pair of triplets at date @xmath0 .",
    "@xmath67 is the table of environmental variables measured at date @xmath0 , and @xmath82 is the table of species observed at the same date . @xmath11 and @xmath48 are the same for all the dates and @xmath83 is the same for both tables .",
    "let @xmath84 be the @xmath0th cross product table : @xmath85 .",
    "the co - inertia analysis triplet at date @xmath0 is ( @xmath86 ) and the statico method is the partial triadic analysis of the @xmath0-table made by this series of cross product tables .",
    "the interstructure step gives optimal weights @xmath87 such that the inertia of the triplet @xmath88 is maximum with the constraint @xmath89 .",
    "the compromise of the statico method @xmath90 is a weighted mean of the cross product tables using weights @xmath87 : @xmath91 [ @xcite ] .",
    "the analysis ( pca ) of this compromise gives a graphical display of the environmental variables ( rows of @xmath92 ) and of the species ( columns of @xmath92 ) .",
    "finally , the intrastructure step projects the rows and columns of each table of the sequence in the analysis of the compromise , with usual supplementary element projection technique [ @xcite ] .",
    "this gives a display of the environmental variables at each date , of the species at each date , and two displays of the sampling sites at each date ( one from the point of view of environmental variables and one from the point of view of species ) .",
    "the results of the statico method are presented in figures  [ fig5][fig7 ] .",
    "figure  [ fig5 ] is a compound graph that sums up the first two steps of the statico method : interstructure and compromise .",
    "figure  [ fig6 ] shows the intrastructure step for environmental variables and ephemeroptera species ( i.e. , the projection of the columns of the tables of the two sequences as supplementary elements in the compromise analysis ) , and figure  [ fig7 ] is the intrastructure step for the sites ( i.e. , the projection of the rows of the tables of the two sequences ) .",
    "the statico method is a partial triadic analysis on the sequence of cross product tables , so the compromise is also a cross product table , with the 13 ephemeroptera species in rows and the 10 environmental variables in columns .",
    "sites have disappeared from this table , but they can be projected as supplementary elements to help interpret the results of the analysis .",
    "the interstructure plot ( figure  [ fig5]a ) shows that autumn and summer are the two most important seasons for defining the compromise , while winter and spring are slightly less important .",
    "the compromise plots ( figure  [ fig5]b and  c ) are very similar to the bgcoia plots ( figure  [ fig5]a and  b ) .",
    "they show that the first axis ( horizontal ) is also a  pollution gradient : clean water on the right , and pollution on the left .",
    "the second axis ( vertical ) is also an upstream  downstream physical gradient : discharge ( `` flow '' ) and temperature ( `` temp '' ) increase downstream ( downward on the figure ) .",
    "nitrates ( `` nitr '' ) also increase along the whole stream instead of having a maximum at site 2 like other pollution variables , and this is why they are located here .",
    "the sensitivity of all ephemeroptera species to pollution and the specificity of some species ( bpu , hla , eda upstream and bsp , eig , ecd downstream ) are also found again .",
    "the `` typological value '' plot ( figure  [ fig5]d ) shows that autumn has the highest influence in the construction of the compromise , while spring has the lowest .",
    "figure  [ fig6 ] shows the intrastructure step for environmental variables ( figure  [ fig6]a ) and ephemeroptera species ( figure  [ fig6]b ) .",
    "it is drawn using the projection of the columns of the two sequences of tables as supplementary elements in the compromise analysis .",
    "autumn is clearly the season where the structures are the strongest ( arrows are much longer at this date ) , both for environmental variables and for ephemeroptera species .",
    "conversely , spring is the season where the structures are the weakest ( arrows are all very short ) .",
    "this confirms the interpretations made on figure  [ fig5 ] .",
    "however , although the structures may vary in intensity , they are preserved across dates : the first axis is always a pollution gradient , and the second one is always an upstream  downstream opposition .",
    "figure  [ fig7 ] shows the intrastructure step for the sites .",
    "it is drawn using the projection of the rows of the two sequences of tables as supplementary elements in the compromise analysis .",
    "it is very similar to figure  [ fig4]c , but it is split according to seasons instead of sites .",
    "the environmental variable plot ( figure  [ fig5]a ) and the ephemeroptera species plot ( figure  [ fig7]b ) are placed side by side .",
    "this presentation insists on the comparison between the four seasons , showing mainly the distortions of the upstream  downstream gradient across seasons .",
    "the differences among the seasons are shown clearly in figure  [ fig7 ] . in spring",
    ", sites are lined up on the upstream - downstream gradient and only site 2 moves slightly to the left . in summer , pollution is highest at site 2 , and restoration occurs along sites 3 , 4 and 5 . in autumn , pollution is maximum because stream flow is at its minimum ( pollutant concentrations are maximum ) . in winter , pollution has almost disappeared , because autrans is a summer mountain resort , but the upstream  downstream gradient is still disturbed .",
    "figure  [ fig7]b shows the same structures , because the pollution has a negative impact on ephemeroptera species abundance ( horizontal axis ) and because of the upstream  downstream preferences of particular species ( vertical axis ) .",
    "costatis is a new method that is also based on @xmath0-table methods and on co - inertia , but it benefits from the advantages of both statico and bgcoia .",
    "indeed , it has the same optimality properties of k - table analyses as statico ( i.e. , the maximizing properties of the compromise ) , but it has the simplicity of bgcoia .",
    "costatis is simply a co - inertia analysis of the compromises of two @xmath0-table analyses ( see figure  [ fig3 ] ) .",
    "the first step of costatis consists in performing two partial triadic analyses : one on the environmental variables @xmath0-table , and one on the species @xmath0-table .",
    "the second step is simply a co - inertia analysis of the compromises of these two partial triadic analyses .",
    "this means that the number of tables does not have to be the same for the two series of tables , but that the number of species , of environmental variables , and of sampling sites must be the same for all the tables .",
    "@xmath93 is the ( @xmath94 ) compromise of the partial triadic analysis of environmental variables , and @xmath95 is the ( @xmath96 ) compromise of the partial triadic analysis of species data .",
    "these compromises are weighted means of the tables of the original sequences , with weights equal to the components of the first eigenvector of the interstructure of the two partial triadic analyses .",
    "the inertias of the triplets @xmath97 and @xmath98 are maximum under the constraints @xmath89 and @xmath99 .",
    "the co - inertia analysis of these two compromises decomposes the total co - inertia : @xmath100 and maximizes the co - inertia between species and environmental variable scores .",
    "an additional step can be implemented , like in the statico method : it is possible to project the rows and columns of all the tables of the two sequences as supplementary elements into the multidimensional space of this co - inertia analysis .",
    "each compromise represents the `` stable structure '' of the corresponding sequence : @xmath72 is the stable structure of the environmental tables sequence , and @xmath101 is the stable structure of the species tables sequence .",
    "costatis brings to light the relationships between these two stable structures , and it discards the conflicting variations between the whole sequences .",
    "it is therefore very easy to interpret ( like a standard co - inertia analysis ) , yet it retains the optimality properties of the compromises of the two partial triadic analyses .",
    "costatis results are presented in figure  [ fig8 ] .",
    "costatis is a co - inertia analysis , and it is therefore possible to use a permutation test to assess the statistical significance of the relationships between the two tables , just like in a usual co - inertia analysis .",
    "the result of this permutation test on the maudret data set gave a @xmath5-value of 1% .",
    "the co - inertia analysis is done on the compromises of two @xmath0-table analyses . here , we used two partial triadic analyses , but the results of these two analyses are not presented .",
    "we show only the plots of the co - inertia analysis , under the form of two biplots : one for environmental variables ( figure  [ fig8]a ) , and one for ephemeroptera species ( figure  [ fig8]b ) .",
    "these two biplots could , in fact , be superimposed on the same figure , but the outcome was cluttered .    presenting the results in this way underlines the fact that costatis is looking for the relationships ( co - structure ) between the stable structures extracted from two series of tables .",
    "figure  [ fig8]a shows the results for the environmental variables . the same structure as the one detected by statico and bgcoia is observed .",
    "axis 1 is the pollution gradient ( pollution on the left ) and axis 2 is the upstream  downstream opposition ( downstream is upward ) .    the four dates for each site are projected on this plot and , like in the bgcoia plot ( figure  [ fig4]c ) , the four points corresponding to the four sampling dates of each site are grouped to form a star .",
    "the gravity center of these four points is labeled with the number of the site .",
    "the four points of site 2 are on the left , as pollution is higher in this site for the four dates ( except for site 3 in winter ) .",
    "pollution decreases downstream along sites 3 , 4 and 5 , and is the lowest at site 6 .",
    "the second biplot is presented in figure  [ fig8]b .",
    "it shows the ephemeroptera species , with the same opposition between upstream and downstream characteristic species . in the same way as in figure  [ fig8]a ,",
    "the four dates for each site are projected on the plot and the corresponding four points are grouped to form a star .",
    "the gravity center of these four points is labeled with the number of the site .",
    "the position of sites corresponds to the abundance of the species in these sites : sites 2 and 3 have the lowest number of ephemeroptera , so they are far on the left .",
    "site 1 has the highest number of species `` eda , '' and sites 5 and 6 have the highest number of species `` bsp , '' `` brh '' and `` eig.''=-1    the first axis common to these two biplots ( i.e. , the first costatis axis ) maximizes the covariance between the coordinates of the `` compromise variables '' and the `` compromise species . ''",
    "the result is that it displays the relationships between the stable structures extracted from two data sets . on this example , this relationship is the fact that the pollution gradient affects the abundance of ephemeroptera species .",
    "the second axis represents the upstream - downstream opposition , and the relationships between ecological preferences of ephemeroptera species and physical variables or stream morphology .",
    "the three methods presented here uncover the same features in the example data set .",
    "this is a small data set , but with strong structure , and strong structures often are clear with any method .",
    "however , the three methods used to analyze even a data set with clear structure can have advantages and drawbacks . the advantages of these methods can be summarized as follows :    bgcoia : : :    it is the most straightforward method .",
    "it is simple to apply and    outputs are easy to interpret . it can be used to favor one point of    view ( for example , space vs. time ) , by choosing the factor of    between - group analysis .",
    "it can also be used in conjunction with wgcoia    to study an effect ( time ) after removing the other ( space ) .",
    "statico : : :    the main advantage of this method is the optimality of the compromise    ( maximization of the similarity with all the initial tables ) . it gives    a compromise of co - structures , which means that it displays the stable    component of species ",
    "environment relationship variations .",
    "it benefits    from the three - steps computation scheme of statis - like methods    ( interstructure , compromise , intrastructure ) , and graphical outputs    can be very detailed .",
    "costatis : : :    this method benefits from the advantages of the two others : optimality    of the partial triadic analysis compromises , ease of use , simplicity    of co - inertia analysis graphical outputs .",
    "costatis is the co - inertia    analysis of two compromises , so it looks for the relationships between    two stable structures .",
    "this is different from the statico point of    view ( co - structure of two compromises vs. compromise of a series of    co - structures ) .",
    "the three methods can also be compared from the perspective of the possible objectives of a data cube coupling strategy .",
    "the first objective is to find a `` consensus '' in the relationships between species and environment .",
    "this consensus should be independent from the repetitions ( time or space ) , and the three methods achieve this in different ways .    in costatis , a consensus is extracted first , separately and independently for environmental variables and species .",
    "the relationships between  these two summaries are then investigated by a co - inertia analysis . in statico , species ",
    "environment relationships are first analyzed at each date , and a  stable summary of these relationships is then computed .    if species  environment relationships are weak , or present only at some dates , they may disappear after the first step of costatis ( the two separate partial triadic analyses ) and the final co - inertia analysis permutation test may be nonsignificant .",
    "conversely , if species ",
    "environment relationships are very strong , chronological structures may disappear in statico .",
    "costatis should therefore be preferred when species  environment relationships are strong and chronological structures are not of primary importance .",
    "another objective of data cube coupling strategy , complementary to the first one , can be the search for a description of the evolution of species  environment relationships ( like seasonal variations or long term changes ) , rather than a description of the stable part of these relationships . in this case",
    ", statico may be more appropriate than costatis , as it computes a  consensus of species  environment relationships at each date , and only after builds a time consensus .",
    "bgcoia is slightly different , because it makes easy a choice in the initial analysis between a spatial or a chronological setup .",
    "it should be used only when there are good reasons to give the priority to space or to time .",
    "but on the other hand , wgcoia can be used after the bgcoia , to remove the primary effect ( space or a time ) chosen in bgcoia .",
    "great care must be taken in the choice of the factor defining the groups for the bgcoia method .",
    "@xcite explain why they chose a between - site ( as opposed to between - season ) co - inertia analysis on the example data set .",
    "in hydrobiology , seasonal variations are mostly linked to water temperature , and the corresponding between - season structures are trivial ( summer  winter opposition ) . but in other situations , a between - date analysis could be an interesting strategy .",
    "this choice of the grouping factor , combined with the possibility to use wgcoia after a bgcoia gives four different analyses ( between - site , between - date , within - sites and within - date ) that can be used to explore complex data sets .    for @xmath0-table methods ,",
    "the way of organizing the @xmath0-table in a series of _ k _ tables is also important . for a three - way array ( sites@xmath102variables@xmath102dates ) ,",
    "there are three ways to cut the data cube into a series of tables .",
    "however , only two are really interesting .",
    "indeed , the option `` one table @xmath2 one variable '' is not coherent with the aim of the analysis : a compromise between physico - chemical variables would have no meaning .",
    "so we have to choose between `` one table @xmath2 one date '' ( as done in the present paper ) or `` one table @xmath2 one site . ''",
    "this choice is dictated by the objectives of the study and also by the fact that the method will try to compute a compromise as a linear combination of the tables .",
    "this means that this compromise should be meaningful .",
    "a third point of comparison between data cube coupling methods is the numerical constraints put on the parameters of the @xmath0-table , that is , the number of species , of environmental variables , of sampling sites , and of dates . from this point of view , bgcoia , statico and costatis share the same constraints on the species and environmental variables , which should always be identical : same species and same environmental variables for all dates .",
    "but the constraints are different for dates and sampling sites . in costatis",
    ", the two series of tables can have different numbers of dates ( and even different dates ) , while the sampling sites must be the same for all the tables at all dates .",
    "in statico , the two series of tables must have the same dates , but sites can differ among dates ( although they must be equal for the two tables of a pair ) .",
    "constraints from the experimental design can therefore influence the choice of the method .",
    "moreover , the constraints on species and environmental variables come from the choice of the @xmath0-table analysis in costatis and statico ( a partial triadic analysis )",
    ". extensions of these methods can be imagined , that would use another variant of statis - like analyses instead of partial triadic analysis . for example , using statis on operators ( the classical act method ) [ @xcite ] would lead to a `` site costatis '' method allowing the use of both different species and different environmental variables .",
    "we could also define a `` species statico '' allowing the use of different environmental variables among dates , and a `` variable statico '' allowing the use of different species among dates .",
    "this possibility of having varying species , environmental variables , dates , and sampling sites makes the use of the three methods much more flexible , but only costatis allows the use of different species and different environmental variables .",
    "however , it should be used with care , as this flexibility might be obtained at the expense of loosing some of the structures in the data set .",
    "a drawback common to all these methods is the relative complexity of exploratory multivariate data analysis . in this area ,",
    "the `` ade4 '' package for the r environment [ @xcite ] tries to make things easier .",
    "simple function syntax and structured objects have been privileged .",
    "in addition , a graphical user interface is available in the `` ade4tkgui '' package [ http://pbil.univ-lyon1.fr/ade4tkgui/ , @xcite ] , and @xmath0-table methods will be implemented in this interface . moreover ,",
    "all the computations and graphical displays in this article can be redone interactively online , thanks to this reproducibility page : http://pbil.univ-lyon1.fr/saoasopet/[http://pbil.univ-lyon1 . ]",
    "http://pbil.univ-lyon1.fr/saoasopet/[fr/saoasopet/ ] .",
    "the availability of methods able to analyze data sets with a complex organization , like pairs of data cubes , is important because it allows to take into account this organization and to analyze the data sets globally .",
    "there are alternatives to these methods , like analyzing stacked tables , or performing several separate analyses , like time series analysis for each variable , or functional data analysis on each table .",
    "but the analysis is facilitated by taking into account the data structure as dictated by the experimental design .",
    "exploring species  environment relationships is not an easy task , and adding spatial and temporal influences makes it even more difficult , but this is a  necessary step toward the comprehension of ecosystem functioning .",
    "the author would like to thank the editor , the associate editor , thibaut jombart , and an anonymous referee for many useful comments and suggestions that helped improve the first version of this paper.=-1              doldec , s. and chessel , d. ( 1987 ) .",
    "rythmes saisonniers et composantes stationnelles en milieu aquatique",
    ". i. description dun plan dobservations complet par projection de variables .",
    "_ acta oecologica , oecologia generalis _ * 8 * 403426 .",
    "escoufier , y. ( 1987 ) .",
    "the duality diagramm : a means for better practical applications . in _ development in numerical ecology _",
    "( p. legendre and l. legendre , eds . ) . _",
    "nato advanced institute , serie g _ 139156 .",
    "springer , berlin .",
    "r development core team ( 2009 ) .",
    "_ r : a language and environment for statistical computing_. r foundation for statistical computing , vienna , austria .",
    "available at http://www.r-project.org .",
    "isbn 3 - 900051 - 07 - 0 .",
    "simier , m. , blanc , l. , pellegrin , f. and nandris , d. ( 1999 ) .",
    "approche simultanee de @xmath0  couples de tableaux : application  ltude des relations pathologie vgtale  environnement .",
    "_ * 47 * 3146 .",
    "stanimirova , i. , walczaka , b. , massart , d. l. , simeonov , v. , saby , c. a. and di crescenzo , e. ( 2004 ) .",
    "statis , a three - way method for data analysis .",
    "application to environmental data . _ chemometrics and intelligent laboratory systems _ * 73 * 219233 .",
    "tenenhaus , m. and young , f. ( 1985 ) .",
    "an analysis and synthesis of multiple correspondence analysis , optimal scaling , dual scaling , homogeneity analysis and other methods for quantifying categorical multivariate data .",
    "_ psychometrika _ * 50 * 91119 .",
    "thioulouse , j. and chessel , d. ( 1987 ) . les analyses multitableaux en ecologie factorielle .",
    "i :  de  la typologie detat  la typologie de fonctionnement par lanalyse triadique .",
    "_ acta oecologica , oecologia generalis _ * 8 * 463480 ."
  ],
  "abstract_text": [
    "<S> a pair of ecological tables is made of one table containing environmental variables ( in columns ) and another table containing species data ( in columns ) . </S>",
    "<S> the rows of these two tables are identical and correspond to the sites where environmental variables and species data have been measured . </S>",
    "<S> such data are used to analyze the relationships between species and their environment . </S>",
    "<S> if sampling is repeated over time for both tables , one obtains a sequence of pairs of ecological tables . </S>",
    "<S> analyzing this type of data is a way to assess changes in species - environment relationships , which can be important for conservation ecology or for global change studies . </S>",
    "<S> we present a new data analysis method adapted to the study of this type of data , and we compare it with two other methods on the same data set . </S>",
    "<S> all three methods are implemented in the ade4 package for the r environment .    . </S>"
  ]
}