{
  "article_text": [
    "new time - domain surveys have begun exploring everything from nearby extrasolar planets to the most distant known stellar explosions , and a veritable zoo of time - variable astrophysical phenomena in the space between ( e.g. , @xcite ) .",
    "the volume of data and sheer breath of inquiry of existing surveys will eventually be dwarfed by the large survey synoptic telescope ( lsst ; @xcite ) , which will track the brightness variations of @xmath120 billion sources throughout the universe . the rapidly increasing rate at which we acquire and process observations for these surveys requires sophisticated algorithms capable of discovering and classifying new sources as well as , or better than , human experts .",
    "machine - learning methods provide a promising avenue for the necessary abstraction of the discovery and classification process .",
    "the algorithms defining these methods are data driven , built to learn relationships between observables and parameters of interest without relying on parametric physical models .",
    "the learning is achieved using objects with known properties ( such as a variable star classification or a galaxy redshift ) , which is called the training set .",
    "once a machine - learning model has been trained , it can be rapidly applied to new data providing predictions of the quantities of interest . as",
    "more data are obtained , and the quality and scope of the training set are improved , the machine can refine its knowledge and model of the dataset , providing ever more accurate predictions .",
    "furthermore , unlike humans , machine - learning models can nearly instantaneously and automatically produce predictions about new data via a fully scalable process .",
    "the application of these statistical machine - learning approaches to photometric light curves has enabled high - fidelity classifications of stellar variables ( e.g. , @xcite ) .",
    "spectroscopic observations are typically required , however , for the precise measurement of fundamental stellar properties , particularly metallicity ( ) and surface gravity ( ) .",
    "there is now a decades - long history of studies using photometric measurements , which are relatively cheap to obtain , to estimate stellar properties that are typically inferred from spectroscopic measurements , which are expensive .",
    "it is well established that photometric colors are particularly useful for estimating , capable of producing a typical scatter of @xmath50.01 dex relative to spectroscopic measurements , even in cases where only a single photometric color is available ( e.g. , @xcite ) .",
    "photometric estimates of surface gravity and metallicity , on the other hand , have proven more challenging ( e.g. , @xcite ) .",
    "it was first recognized by @xcite that stellar atmospheres with enhanced metal content produce less flux in the blue portion of the optical .",
    "many studies have leveraged this fact to photometrically estimate metallicity ( or ) using broadband , blue photometric colors , typically including either the johnson @xmath6- or sdss @xmath7-band .",
    "broadband colors are capable of producing a typical scatter of @xmath30.20 dex when restricted to fg stars @xcite , and @xmath30.30 dex when no color restrictions are adopted ( see @xcite ) .",
    "the most precise photometric estimates of stellar properties are determined using narrow- and medium - band filters , which are designed to be sensitive to both metal- and surface gravity - dependent spectral features .",
    "the most prominent technique uses the @xmath8 strmgren filters ( see @xcite for a review ) , which has been demonstrated to produce a scatter of @xmath30.10 dex for  relative to spectroscopic observations for fg stars @xcite .",
    "the @xmath8 filters do not , however , provide precise estimates for late - type ( km ) stars , and modern wide - field surveys [ e.g. , sloan digital sky survey ( sdss ; @xcite ) , pan - starrs1 @xcite , the dark energy survey ( des ; @xcite ) , lsst ] almost exclusively use broadband filters in order to facilitate extragalactic science goals .",
    "recently , significant progress was made regarding the photometric estimation of  for stars with @xmath9 k @xmath5  @xmath10 k , following the recognition that stellar brightness variations on timescales of several hours arise from granulation , which , in turn , correlates with surface gravity @xcite .",
    "this method , which produces a scatter of 0.060.10 dex in$ ] , which we give in units of dex . ] @xcite , requires high - quality ( @xmath10.01 millimag precision ) , high - cadence ( every 30 min ) , monitoring from space - based telescopes , such as the _ kepler _ satellite @xcite .",
    "wide - field , ground - based surveys will never achieve this precision , however , while high - cadence , high - quality _ kepler_-like light curves are only available for a few hundred thousand stars that are restricted to a small number of specific sight lines .",
    "given the proliferation of wide - field ( @xmath11 ) , broadband , photometric surveys , our understanding of stellar evolution and the formation of the milky way would greatly benefit from the reliable determination of temperature , surface gravity , and metallicity for the hundreds of millions of stars observed by these surveys .    here , we present a new machine - learning framework and model capable of inferring the fundamental stellar atmospheric parameters , , , and , from de - reddened photometric colors and time - domain observations alone .",
    "we train our algorithms using targets from our large ( @xmath19,000 sources ) , systematic spectroscopic survey of variable stars . for the sources in our survey we measure , , and  using well - established techniques that have been adapted from the sdss survey .",
    "our final models enable the precise measurement of these parameters for variable stars without ( expensive ) spectroscopic measurements .",
    "to facilitate the construction of a large training set , we conducted a systematic , spectroscopic survey of variable sources in , an equatorial , @xmath1315 deg@xmath12 field that was repeatedly imaged by the sdss .",
    "observations were conducted with hectospec @xcite , a multi - object spectrograph on the 6.5-m multi - mirror telescope ( mmt ) .",
    "[ [ section ] ]    the sdss repeatedly scanned an equatorial region of the southern galactic cap , known as  ( @xmath13 , @xmath14 ) during the first @xmath19 yr of the survey . these repeated scans , conducted in each of the @xmath15 filters , cover a wide range of galactic latitudes ( @xmath16 ) , and have enabled numerous time - domain studies . the @xmath1decade long , multi - color observations of , provide a superb testing ground for the eventual observations from lsst .      as a byproduct of a search for standard stars in ,",
    "researchers at the university of washington constructed a publicly available variable source catalog ( uwvsc ; @xcite ) .",
    "the uwvsc contains 67,507 unresolved , variable candidates with @xmath17 20.5 mag , at least 10 observations in both the @xmath18 and @xmath19 bands , and a light curve with a root - mean - scatter ( rms ) @xmath20 0.05 mag and @xmath21 per degree of freedom @xmath20 3 in _ both _ the @xmath18 and @xmath19 bands .",
    "we adopt the uwvsc as the basis for our spectroscopic survey of variability for several reasons : ( i ) it is one of the largest existing catalogs of variable stars , ( ii ) it is the closest publicly - available analog to the data set that will ultimately be delivered by the lsst , and ( iii ) low galactic latitudes are included ( see below ) .",
    "maximizing the efficiency of hectospec requires a large density of targets ( @xmath22 ) . as a result",
    ", we elected to focus our survey on the lowest galactic latitudes in , the @xmath125 deg@xmath12 region with @xmath23 , which corresponds to galactic latitudes @xmath24 .",
    "hectospec fibers are positioned in a radial configuration extending inwards from the outer edge of the fov .",
    "while this configuration allows the robotic fiber positioners to rapidly reconfigure the observational setup , a disadvantage of this design is that the radial fiber configuration results in a geometry where targets can conflict with one another requiring two fibers to cross , which is not possible .",
    "thus , while 300 fibers are available for observations , in practice , typically only @xmath1175200 science targets can be observed in a single pointing .    given the dual goals of the survey to obtain a minimally - biased spectroscopic view of variability and to improve photometric classifiers of variable stars we employ additional selection criteria beyond the spatial location of the variable sources .",
    "we require all targets to have a mean _ observed _ @xmath25 mag , which should result in a snr @xmath26 10 for 10 min exposures . of the 26,419 uwvsc sources within the spatial bounds of our survey ,",
    "14,994 have @xmath25 mag . our ability to characterize the variability of a given source improves as the number of observations increases , and so we also require all potential targets to have @xmath26 24 observations in each of the @xmath18 , @xmath19 , and @xmath27 bands .",
    "this further culls the final target list to 9635 unique sources .      for each field to be observed , the hectospec targeting software assigns fibers based on the user - supplied relative priority of each individual target .",
    "this scheme , which assigns fibers to as many sources in the highest priority category as possible before assigning as many fibers in the second highest category and so on , allows us to ensure that the brightest and best observed sources are the most likely to be observed . in the end",
    ", we adopted 11 levels of prioritization , which are summarized in table  [ tbl - hecto_targs ] . generally speaking",
    ", we assigned higher rank ( priority 1 corresponds to the highest rank ) to brighter sources with more observations .",
    "we elevated the priority of targets of interest , sources that stand out regardless of their brightness or the total number of times they were observed .",
    "three different categories were identified as high - priority : ( i ) high - amplitude sources , which we define as those having a median of absolute deviation ( mad ) , a robust measure of the scatter about the median , in the @xmath19 band @xmath20 0.15 mag , ( ii ) sources that are likely periodic , 16.5 were selected as likely periodic variables . ] and ( iii ) sources with light curves that are consistent with the variability signature of quasars . as sources similar to quasars ( see @xcite for a definition of @xmath28 ) . ]",
    "this later group is of interest because quasars are difficult to find at low galactic latitudes ( e.g. , @xcite ) , yet they serve as ideal probes of the interstellar medium . finally , we note that the 3 spectroscopically - confirmed quasars in the uwvsc that match our targeting criterion were excluded from the target list .",
    "each target was assigned a relative priority based on its brightness and total number of observations .",
    "targets with priority 2.5 ( see below ) were repeated in the target list .",
    "the detailed criteria for the priorities we assigned to each target are as follows :    * priority 1 targets are those determined to be quasar - like , likely periodic variables , or bright sources with either mean _ observed _ @xmath7 , @xmath18 , or @xmath29 mag , or @xmath30 mag , or @xmath31 mag .",
    "mag means that the observed mean magnitude in @xmath7 , @xmath18 , or @xmath32 mag , or @xmath33 mag , or @xmath34 mag .",
    "a source only needs to be brighter than these limits in a single band for inclusion in a given priority level . ] * priority 2 targets are those outside the main stellar locus in color - color space ( see fig .",
    "[ fig : targ_cc ] ) or those with @xmath35 mag .",
    "* priority 2.5 targets are either extremely bright , @xmath36 mag , or quasar - like , or likely periodic variables , or high - amplitude variables . note that inclusion as a priority 2.5 target is the only way a source could be added to the target catalog more than once .",
    "* priority 3 targets have been observed @xmath3730 times in the @xmath19 band and have @xmath38 mag . *",
    "priority 4 targets have @xmath38 mag .",
    "* priority 5 targets have been observed @xmath3730 times in the @xmath19 band and have @xmath39 mag . *",
    "priority 6 targets have @xmath39 mag .",
    "* priority 7 targets have been observed @xmath3730 times in the @xmath19 band and have @xmath40 mag .",
    "* priority 8 targets have @xmath40 mag .",
    "* priority 9 targets have been observed @xmath3730 times in the @xmath19 band and have @xmath41 mag .",
    "* priority 10 targets have @xmath41 mag .    while priority",
    "2.5 sources were potentially observed twice , in practice this rarely happened since the observations were not complete for sources with priority 1 .",
    "furthermore , the repeated observations of a few targets provides a check of the systematic differences of observations made through different fibers . in total there were 10,129 total potential targets selected for hectospec observations ( see table  [ tbl - hecto_targs ] ) .",
    "[ fig : targ_cc ] shows the distribution of potential targets in a @xmath42 , @xmath43 color - color ( @xmath44 cc ) diagram .",
    "the distribution of targets reasonably reflects that of  as a whole ( compare with fig .  4 in @xcite ) , with one exception :",
    "a paucity of sources in region ii .",
    "the magnitude cuts significantly reduce the number of candidate quasars , which are additionally more difficult to identify at low galactic latitudes .",
    "crllllrrcc 1 & & @xmath45 & @xmath46  qso @xmath46 p & & & 423 & 315 &   & 74.5 + 2 & ( @xmath47 & @xmath48 ) & @xmath46  ( @xmath49 ) & & & 1189 & 844 &  & 71.0 + 2.5 & & @xmath50 & @xmath46  qso @xmath46 p & @xmath46 @xmath51 & & 497 & 190 &   & 38.2 + 3 & @xmath52 & @xmath53 & @xmath54  @xmath55 & @xmath56 & & 1092 & 750 &   & 68.7 + 4 & @xmath52 & @xmath53 & @xmath54  @xmath55 & @xmath57 & & 448 & 244 &   & 54.5 + 5 & @xmath58 & @xmath59 & @xmath54  @xmath55 & @xmath56 & & 1930 & 1222 &   & 63.3 + 6 & @xmath58 & @xmath59 & @xmath54  @xmath55 & @xmath57 & & 758 & 452 &   & 59.6 + 7 & @xmath60 & @xmath61 & @xmath54  @xmath55 & @xmath56 & & 749 & 423 &   & 56.5 + 8 & @xmath60 & @xmath61 & @xmath54  @xmath55 & @xmath57 & & 342 & 208 &   & 60.8 + 9 & @xmath62 & @xmath63 & @xmath54  @xmath55 & @xmath56 & & 1872 & 911 &   & 48.7 + 10 & @xmath62 & @xmath63 & @xmath54  @xmath55 & @xmath57 & & 829 & 355 &   & 42.8 + total & & & & & & 10129 & 5914 &   & 58.4 +    , @xmath43 color - color diagram showing the @xmath110k potential hectospec targets .",
    "crosses show targets that were actually observed by hectospec , while the circles show targets that were not observed .",
    "the grey shaded area shows the region in color - color space considered outside the main stellar locus for targeting purposes .",
    "all sources in this region were assigned priority 1 or 2 .",
    "the distribution of targets reasonably reflects the entire uwvsc sample ( see @xcite ) , with the exception of low - redshift quasars , which are less prevalent due to the magnitude cuts and low galactic latitude of the hectospec fields .",
    "the six regions identified in @xcite are outlined by the dashed lines . for each region , the variability is believed to be dominated by the following : * i *  white dwarfs , * ii *    low - redshift ( @xmath64 ) quasars , * iii *  white dwarf - m star binary stars , * iv *  rr lyrae stars , * v *  normal stars , * vi *  high - redshift ( @xmath65 ) quasars . most of the high - amplitude variables are located off the main stellar locus.,width=326 ]    limited telescope access and fiber conflicts ( see above ) prevented the acquisition of spectra for each of the 10,129 targets .",
    "after optimizing fiber configurations over the 40 observation fields we used to cover the survey area , we could , at most , obtain 7038 total spectra ; our actual yield was 5914 ( see table  [ tbl - hecto_targs ] ) .",
    "hectospec is a 300 fiber multi - object spectrograph with a circular , 1@xmath66 diameter field of view ( fov ) .",
    "spectra were obtained using the 270 groove mm@xmath67 grating , which provides a dispersion of 1.2    pixel@xmath67 and a resolution of @xmath16.2    full - width half - max , suitable for measuring basic stellar properties .",
    "hectospec is operated in service mode , and observations for our program were carried out during june and july 2011 .",
    "each field was to be observed with 2@xmath68300 s exposures , which would allow for the rejection of cosmic rays and provide a snr @xmath37 10 even for the faintest targets . at the discretion of the service observers , the exposure times for a few fields were extended during non - photometric conditions ( table  [ tbl - hecto_obs ] ) . in total , 33 of our 40 planned fields were observed , which yielded 5914 spectra of 5825 unique sources .",
    "lrrrcccc 2011 - 06 - 08.441 & 3 & 20:16:38.47 & @xmath6900:50:03.32 & 600.0 & 1.185 & 0.65 & 198 + 2011 - 06 - 08.456 & 5 & 20:06:50.02 & @xmath7000:46:59.29 & 600.0 & 1.175 & 0.65 & 201 + 2011 - 06 - 09.391 & 17 & 20:28:29.76 & @xmath7000:49:04.43 & 600.0 & 1.243 & 0.86 & 190 + 2011 - 06 - 09.376 & 8 & 20:13:19.60 & @xmath7000:47:10.78 & 600.0 & 1.256 & 0.86 & 194 + 2011 - 06 - 10.328 & 23 & 20:23:02.66 & @xmath6900:46:10.10 & 600.0 & 1.566 & 0.91 & 186 + 2011 - 06 - 10.343 & 24 & 20:19:19.46 & @xmath6900:46:29.35 & 600.0 & 1.438 & 0.91 & 196 + 2011 - 06 - 10.358 & 25 & 20:18:42.43 & @xmath7000:46:53.25 & 600.0 & 1.328 & 0.91 & 210 + 2011 - 06 - 10.373 & 26 & 20:14:04.20 & @xmath6900:47:16.61 & 600.0 & 1.281 & 0.91 & 205 + 2011 - 06 - 10.389 & 27 & 20:16:57.74 & @xmath6900:02:43.31 & 600.0 & 1.232 & 0.91 & 184 + 2011 - 06 - 10.410 & 29 & 20:11:25.30 & @xmath6900:50:06.78 & 600.0 & 1.199 & 0.77 & 181 + 2011 - 06 - 10.424 & 30 & 20:13:00.47 & @xmath6900:05:46.31 & 600.0 & 1.178 & 0.77 & 197 + 2011 - 06 - 10.439 & 31 & 20:11:11.16 & @xmath7000:44:17.84 & 600.0 & 1.167 & 0.77 & 198 + 2011 - 06 - 10.454 & 32 & 20:09:20.93 & @xmath7000:00:31.04 & 600.0 & 1.186 & 0.77 & 195 + 2011 - 06 - 10.468 & 33 & 20:08:17.09 & @xmath6900:44:33.51 & 600.0 & 1.218 & 0.77 & 196 + 2011 - 06 - 11.347 & 1 & 20:20:47.66 & @xmath7000:09:52.50 & 600.0 & 1.387 & 1.11 & 159 + 2011 - 06 - 11.318 & 34 & 20:08:45.75 & @xmath7000:46:24.12 & 600.0 & 1.517 & 1.11 & 203 + 2011 - 06 - 11.333 & 38 & 20:05:09.17 & @xmath6900:43:20.15 & 600.0 & 1.425 & 1.11 & 197 + 2011 - 06 - 12.354 & 10 & 20:35:48.40 & @xmath6900:15:04.47 & 600.0 & 1.403 & 1.01 & 147 + 2011 - 06 - 12.368 & 12 & 20:38:19.51 & @xmath6900:47:04.24 & 600.0 & 1.349 & 1.01 & 142 + 2011 - 06 - 12.382 & 13 & 20:30:01.50 & @xmath6900:42:20.61 & 600.0 & 1.270 & 1.01 & 156 + 2011 - 06 - 12.396 & 14 & 20:30:59.07 & @xmath7000:45:14.06 & 600.0 & 1.214 & 1.01 & 180 + 2011 - 06 - 12.411 & 15 & 20:04:11.70 & @xmath7000:16:40.64 & 600.0 & 1.175 & 1.01 & 178 + 2011 - 06 - 12.427 & 16 & 20:34:01.51 & @xmath7000:40:20.90 & 900.0 & 1.172 & 1.01 & 169 + 2011 - 06 - 12.447 & 18 & 20:28:37.06 & @xmath6900:00:15.05 & 900.0 & 1.176 & 1.01 & 164 + 2011 - 06 - 12.276 & 2 & 20:15:40.00 & @xmath7000:32:00.15 & 600.0 & 2.075 & 1.01 & 166 + 2011 - 06 - 12.293 & 4 & 20:07:29.05 & @xmath6900:27:51.98 & 900.0 & 1.758 & 1.01 & 177 + 2011 - 06 - 12.310 & 6 & 20:21:19.85 & @xmath6900:18:10.56 & 600.0 & 1.671 & 1.01 & 167 + 2011 - 06 - 12.324 & 7 & 20:32:28.04 & @xmath6900:14:29.42 & 600.0 & 1.602 & 1.01 & 143 + 2011 - 06 - 12.339 & 9 & 20:37:43.70 & @xmath7000:41:47.41 & 600.0 & 1.490 & 1.01 & 150 + 2011 - 06 - 14.290 & 19 & 20:26:28.18 & @xmath6900:42:38.26 & 600.0 & 1.908 & 1.01 & 170 + 2011 - 06 - 14.305 & 20 & 20:24:48.79 & @xmath7000:03:39.71 & 600.0 & 1.679 & 1.01 & 166 + 2011 - 06 - 14.275 & 37 & 20:04:25.10 & @xmath7000:49:48.15 & 600.0 & 1.854 & 1.01 & 179 + 2011 - 07 - 08.427 & 21 & 20:25:25.79 & @xmath7000:48:02.16 & 840.0 & 1.252 & 0.89 & 170 +      the hectospec observations were reduced using standard procedures : bias subtraction , flat fielding , bad - pixel masking , and cosmic - ray rejection were performed by the ` specroad ` reduction pipeline .",
    "in addition to standard processing , ` specroad ` performs a throughput correction for each fiber , followed by a correction to a known red - light leak in the detector ( see @xcite ) and a correction for absorption due to the atmospheric a and b bands .",
    "the final step of the pipeline estimates the redshift of each spectrum using the ` iraf ` task ` doskyxcsao ` , which cross - correlates the spectrum against several template spectra of stars , galaxies , and quasars .",
    "all spectra were flux - calibrated using a spectrum of the spectrophotometric standard star bd@xmath7028 4211 , taken on ut 2011 06 12 .",
    "visual inspection of the spectra at this stage revealed that several sources had a sharp kink around @xmath18100    with continua rising at redder wavelengths .",
    "this effect is due to the red - light leak in the hectospec detector .",
    "while ` specroad ` has a red - light leak correction method , many spectra remain affected by this known systematic issue following the pipeline reduction . for bright blue sources , hectospec observations",
    "are also affected by second - order scattered light redward of @xmath17000  , though the magnitude of this effect is significantly less than that of the red - light leak .",
    "we developed a custom procedure to correct the continua of our targets redward of 7000  .",
    "first , the spectral energy distribution ( sed ) of each source is determined from the median magnitude in each of the @xmath15 filters , and , for sources detected by the two micron all sky survey ( 2mass ; @xcite ) , the single - epoch 2mass @xmath71 measurements . a spectral match for each source",
    "is then identified based on a fit of the sed to the spectra in the pickles stellar library @xcite .",
    "a low - order spline is fit to the hectospec spectral continuum redward of 7000  , and a multiplicative factor is determined to warp the spline fit to the same shape as the pickles star continuum .",
    "we fit splines of order @xmath72 , and use the bayes information criterion ( bic ) to select the optimal model of the hectospec spectral continuum .",
    "once the correction factor is determined , each hectospec spectrum is warped so that the continuum reward of 7000   matches that of the most photometrically similar pickles star .",
    "this procedure leaves considerable uncertainty regarding the true continuum redward of 7000   , however , this should not greatly affect the final results of this study . the segue stellar parameters pipeline ( sspp ; see below ) relies exclusively on spectral features blueward of 8000    to determine stellar parameters , so warping the continuum redward of 7000    does not significantly alter the output from the sspp .",
    "to confirm this was the case , we artificially decreased the snr of the spectra redward of 7000    using several different prescriptions , including setting the snr@xmath73 , and found that the sspp output was not significantly altered .",
    "for full details on the sspp procedures see @xcite . here",
    ", we provide a brief overview of the sspp methodology .",
    "the sspp relies on external measurements of the radial velocity ( rv ) of a star in order to shift all spectra to a zero - velocity rest frame .",
    "it has been shown that input rvs incorrect by as much as 200  do not significantly alter the output of the sspp . following the shift to a common rest frame",
    ", the sspp then measures line indices for several prominent stellar absorption features ( e.g. , h@xmath74 , h@xmath75 , ca ii h&k , na i , etc . ) . to measure these indices , continuum fits",
    "are made both globally , over the entire spectrum , and locally , from a line - free region blueward of the absorption feature to a line - free region redward of the absorption feature .",
    "a specific line index is then calculated for each continuum - fitting method by integrating the continuum - normalized flux over a pre - defined wavelength interval .",
    "the calculated line indices , along with continuum - normalized spectra covering different wavelength ranges and the sdss photometric colors , are fed to multiple parameter estimation methods ( e.g. , neural networks , synthetic spectral matching , ca ii k line index technique , etc . ) , which each provide an estimate of , , and .",
    "each of the estimation methods is tuned to apply only to stars in a restricted range of @xmath76 colors and snr , over which the method is shown to be reliable .",
    "the individual measurements of , , and  are robustly combined to provide the final adopted values , and corresponding uncertainties , of the stellar parameters . the number of methods employed to produce the final adopted parameters is also returned . for high signal - to - noise ratio",
    "( snr ) spectra with 4500 k @xmath77 7500 k , the sspp measures , , and  with typical uncertainties of 157 k , 0.29 dex , and 0.24 dex , respectively @xcite . while processing spectra , the sspp flags stars for which it can not provide reliable estimates of the stellar parameters , such as very hot stars , white dwarfs and m giants .",
    "the spectra we obtained with hectospec provide a good match with those obtained by sdss , making the sspp an ideal tool for estimating stellar parameters .",
    "sdss spectra cover a wavelength range from 38009200    with a resolving power of @xmath781800 , while hectospec covers 37009100    with a resolving power of @xmath781000 .",
    "we use a slightly adapted version of the sspp , which accounts for the lower resolution of hectospec as compared to sdss , to estimate , , and  for each of the sources observed during our survey .",
    "the results from the sspp are summarized in table  [ tbl - sspp_hecto ] .",
    "we supplement our 5914 hectospec spectra with 3121 additional sdss spectra of stellar uwvsc sources .",
    "each of these 9035 spectra were processed with the sspp , and estimates of , , and  were obtained for 5994 of those sources .",
    "the remaining sources had some peculiarity ( most often low snr or @xmath79 k ) such that the sspp could not provide estimates of the fundamental atmospheric properties .",
    "lccrrcrrcrrc 4172970 & 4 & nnnnn & 5499.7 & 94.7 & 7 & 3.94 & 0.18 & 6 & 0.01 & 0.12 & 5 + 4583821 & 5 & nnnnn & 4487.8 & 120.3 & 3 & 4.19 & 0.26 & 2 & -0.95 & 0.08 & 1 + 4651452 & 2 & nnbnx & -9999.0 & -9999.0 & 0 & -9999.00 & -9999.00 & 0 & -9999.00 & -9999.00 & 0 + 4777216 & 9 & nnnnx & -9999.0 & -9999.0 & 0 & -9999.00 & -9999.00 & 0 & -9999.00 & -9999.00 & 0 + 5302673 & 9 & nnnnn & 5986.7 & 161.8 & 4 & 3.93 & 0.79 & 2 & -0.76 & 0.09 & 1 +",
    "in fig .  [ fig : loggvteff ] , we show the distribution of  against  for all sources in our sample with sspp estimates of these parameters . also shown are the loci of dwarf , giant , and supergiant stars , denoted by their respective luminosity classes , v , iii , and ii .",
    "these locations , which are based on the tabulation of @xcite , are only approximate and serve as a rough guide for any individual source . from fig .",
    "[ fig : loggvteff ] it is immediately clear that our sample of variable stars has few giants and supergiants . for a magnitude - limited survey",
    "it is not obvious that this should be the case , since giants are several mag brighter than dwarfs .",
    "it is also interesting that most sources have temperatures between @xmath140006000 k. the pile up on the red end of this range is artificial and the result of the sspp , which does not provide temperature estimates for stars cooler than 4000 k. from fig .",
    "[ fig : loggvteff ] we conclude that the majority of variable stars are g and k dwarfs , with the caveat that a significant population of even cooler m type stars may constitute a significant fraction of the observed variables ( see e.g. , @xcite ) .",
    "k ) with dwarf - like surface gravity (  @xmath80 ) .",
    "the apparent trend of  against both  and  is a by - product of the magnitude - limited observations obtained by sdss.,width=326 ]    the sources shown in fig .",
    "[ fig : loggvteff ] are color coded via their sspp measured metallicity",
    ". there is a general trend for warmer , low - gravity stars to have lower metallicity than the cooler , dwarf stars .",
    "we interpret this effect to be a result of the magnitude - limited observations of : low - metallicity dwarf stars in the halo are too faint to be detected , which biases the cooler stars to solar - like .",
    "sdss probes a larger volume for giant stars , and given the fixed area of , this means that halo giants will outnumber those found in the disk , biasing low - surface - gravity sources toward lower metallicities .",
    "we characterize the photometric variability of every uwvsc source in each of the @xmath15 filters via the 66 light - curve features defined in @xcite . in total",
    "there are 334 features ( 66 for each of the @xmath15 filters , as well as the 4 sdss colors ) , that the machine learning model can use to map photometric variability to , , and .    in figures  [ fig : feats1 ]  and  [ fig : feats2 ] , we show the fundamental atmospheric parameters plotted against eight of the most important light - curve features for automated variable star classification , as determined in @xcite .",
    "the features , each measured from @xmath18 band observations , are : the amplitude of variations @xmath81 , the best - fit period @xmath82 , the standard deviation @xmath83 , the mad of the lomb - scargle residuals divided by the mad of the raw light curves , ` scatter_res_raw ` ( see @xcite ) , the stetson variability index @xmath84 ( see @xcite ) , the light - curve skewness @xmath85 , and the quasar and non - quasar variability metrics , @xmath28 and @xmath86 , respectively ( see @xcite ) . if it is possible to estimate , , and  from light curves alone , then one would expect that at least some of the important light curve features correlate with the atmospheric parameters . from figures  [ fig : feats1 ]  and",
    "[ fig : feats2 ] it is clear that no obvious one - to - one correlations exist between the light - curve features and the stellar parameters .",
    "there are , however , some clear clumps that emerge from the data .",
    "for instance , rr lyrae variables stand out as the warm (  @xmath87 k ) , low surface gravity (  @xmath88 ) , low metallicity (  @xmath89 ) sources with @xmath90 , @xmath91 , and @xmath92 d. , @xmath86 , and @xmath82 @xcite . ]",
    "the existence of these clumps suggest that higher - dimensional models may be capable of parsing the multidimensional light curve feature space in order to predict fundamental stellar parameters .",
    "in order to maximize the efficacy of our model , it is essential that the training set contain only sources with reliable estimates of , , and .",
    "while the sspp returns a set of internal flags designed to identify sources with unreliable parameter estimates , some sources flagged as `` nnnnn , '' meaning no flags were raised while processing , clearly have incorrect estimates .",
    "for instance , within our sample four `` nnnnn '' sources were identified as extremely metal poor ( emp ) stars with  @xmath93 dex .",
    "visual inspection of these sources shows that none of them are genuine emp stars : two are white dwarfs , for which the sspp is known not to perform well @xcite , one has an unusual continuum that is suggestive of an m star binary , and the fourth is a borderline candidate emp star with low snr ( @xmath94 10.9 ) .",
    "it has been shown that some sources with sspp estimates of  just below @xmath693 dex are not in fact emp stars @xcite .    in order to further cull the training set to exclude sources with unreliable parameter estimates , we visually examined the sspp diagnostic plots for each star in our spectroscopic sample .",
    "in addition to providing the sspp estimates , these diagnostics display the observed spectrum plotted over a model spectrum of a star with the adopted sspp parameters .",
    "these plots enable a quick visual analysis to determine the reliability of the estimated parameters .",
    "while visually inspecting each of the 9035 spectra , one of six visual inspection flags were assigned to each source : `` n ''  spectrum appears normal , sspp estimates are valid ; `` x ''  no sspp parameters were estimated ( typically due to snr @xmath5 10 ) ; `` q ''  spectrum shows broad emission lines consistent with a quasar ; `` f ''  parameters are estimated but the model spectrum clearly does not match the observed spectrum ; `` m ''  the star shows clear evidence for tio and vo absorption , consistent with an m type star ; and `` c ''  the model and observed spectrum are well matched redward of @xmath14500  , but poorly matched in the spectral region around ca ii h&k .",
    "virtually all sources with visual examination flag `` c '' are late - type stars (  @xmath95 k ) , with low snr in the blue portion of the spectrum , which leads to the poor match between the observed and model spectra around ca ii h&k . based on the quality of the match between these spectra redward of 4500  , we consider the estimates for these sources reliable . in the end , we adopt all sources with visual examination flags of either `` n '' or `` c , '' a total of 5881 sources , as the training set for our machine learning model .",
    "there are many machine - learning methods that can be used to perform supervised regression , including : artificial neural networks , support vector machines , decision trees , and random forest , which have all been successfully applied to large multidimensional datasets ( see @xcite for detailed examples of the application of these tools ) .",
    "we employ the use of random forest regression  ( rfr ) , which is both fast and easy to interpret . additionally , random",
    "forest has been shown to be the optimal machine - learning method for a variety of astrophysical problems ( e.g. , @xcite ) .",
    "a detailed description of the random forest algorithm can be found in @xcite .",
    "briefly , the random forest method aggregates the results from several decision trees to provide a low - bias , low - variance estimate of the properties of interest .",
    "in particular , at each node of the tree the new splitting parameter can only be selected from a random subset of ` mtry ` features in the entire feature set .",
    "for the case described here , after hundreds of trees have been constructed , each with different structure , the output from each of those trees is averaged to provide a robust estimate of , , and .",
    "finally , we note that each parameter estimate comes from a separate model , one for each of , , and .",
    "we adopt the root mean - square error ( rmse ) as the figure of merit ( fom ) for selecting the parameters of one model over another .",
    "when applied to the training set , the rmse is defined as : @xmath96 where @xmath97 is the total number of objects in the training set , @xmath98 is the predicted value of the property of interest , and @xmath99 is the spectroscopic value of the property of interest .",
    "the splitting parameter of each non - terminal rfr node is optimized to minimize the rmse , making this a natural choice for the fom .",
    "the rmse for the entire training set is measured using @xmath100-fold cross validation ( cv ) . in @xmath100-fold cv ,",
    "1/@xmath100 of the training set is withheld during model construction , and the remaining @xmath101 fraction of the training set is used to predict the parameters of interest for the withheld data .",
    "this procedure is then repeated @xmath100 times , resulting in every training set source being withheld exactly once , so that predictions are made for each source in the training set enabling a measurement of the rmse .",
    "we endeavor to improve stellar parameter estimates from photometric observations by supplementing sdss photometric colors with time - domain information . while the acquisition of photometric light curves used to be very costly , similar to spectroscopy , recent advances in both the construction of large - format charge - coupled devices ( ccds ) and in computational processing and data storage have enabled an unprecedented exploration of the time domain over wide fields .",
    "currently , several surveys repeatedly image @xmath2010,000 deg@xmath12 ( e.g. , @xcite ) , with several more ( e.g. , @xcite ) planned prior to lsst .",
    "we begin by examining the utility of supplementing photometric colors with light - curve features in order to estimate fundamental stellar parameters . since many variable star classes correspond to specific locations within the hertzsprung - russell diagram ( e.g. , rr lyrae stars , cepheid stars , mira variables ; see @xcite ) , it seems reasonable to expect that light - curve features , in addition to colors , could , at the very least , improve estimates of .",
    "furthermore , the observed correlation between metallicity and periodic - light - curve features for some variables ( e.g. , cepheids , see @xcite ) , suggests that time - domain observations can improve estimates of  for at least some stars .",
    "note , however , we do not directly classify variables as part of the present framework .",
    "one potential complication for our approach is binarity : many of the variables in the uwvsc are actually two stars orbiting each other , which leads to a more complicated spectrum than those from a single star . in practice , however , the light from many of these systems will be dominated by a single star , in which case our method should remain valid . alternatively , if the flux contribution is comparable from the two sources , then they have similar mass , and hence similar , while the metallicity will be identical as the stars were formed from the same molecular cloud .",
    "thus , we do not expect binaries to significantly alter the results from this study .    as an initial test to determine whether light - curve features can be used to estimate , , and  for variable sources",
    ", we construct three rfr models for each of these three atmospheric parameters .",
    "the feature set for the first model contains only the median observed sdss photometric colors ( @xmath102 , @xmath103 , @xmath104 , and @xmath105 ) , which have been corrected for reddening according to the dust maps of @xcite",
    ". the feature set for the second model contains only the 330 ( 66 features from each of the @xmath15 bands ) light - curve features described in the text , while the third model uses all 334 ( both colors and light - curve ) features . in some cases , correlated features can hurt the performance of random forest models ( see e.g. , @xcite ) . in order to avoid correlations to the features measured for each of the five sdss filters ,",
    "our feature set includes the 66 features from @xcite measured on the @xmath18 band light curves , along with the difference between the values of these features in the remaining filters .",
    "for instance , rather than including the amplitude of variations in each filter @xmath106 , our feature set includes @xmath107 , @xmath108 , @xmath109 , @xmath110 , and @xmath111 .",
    "the results of this initial test , as well as those for our final optimized model , are shown in fig .",
    "[ fig : model_compare ] . from the second column of fig .",
    "[ fig : model_compare ] , it is obvious that the 330 light - curve features alone are a poor predictor of , , or .",
    "the first column shows colors may be used to estimate  with a scatter similar to that produced from sspp measurements of actual spectra .",
    "colors - only estimates of  and  are significantly worse than what can be gleaned from low - resolution spectra , however .",
    "the third column shows that using both colors and light - curve features provides modest gains relative to models trained using only color information .",
    "these models have not been optimized , however , and with 330 light - curve features and a median of only 33 observations per source it is likely that these models have been over - fit . as the fourth column shows , reducing the total number of features and optimizing the rfr parameters provides the best estimates for , , and , as we discuss in more detail below .",
    "the importance of the many model construction decisions that a scientist must make can plainly be seen in fig .",
    "[ fig : model_compare ] : when using light - curve features and excluding color information to predict , rfr produces very biased results in which almost all sources are predicted to have  @xmath112 dex . using this model",
    ", it would be virtually impossible to identify newly observed low - metallicity stars .",
    "below we describe how we prune the feature sets used to predict , , and , and how we adjust the rfr tuning parameters to construct the optimal machine - learning model .",
    "for variable - star classification , each of our adopted 66 light - curve features provides useful information for discriminating between the variability classes @xcite .",
    "nevertheless , the use of all 330 light - curve features adds noise to the model and reduces its overall accuracy .",
    "the inclusion of too many features can hinder the performance of the model , needlessly making it more complicated while increasing the likelihood of over - fitting the data .",
    "feature selection is a challenging problem : there is an exceedingly large number of combinations that include a subset of the 334 total features .",
    "we wish to determine which subset @xmath113 of the 334 features produces the best model to predict stellar parameters .",
    "searching over all possible subsets is computationally intractable as it would require @xmath114 rfr models .",
    "we simplify the model selection process using the well - known forward - feature selection approximation method @xcite .",
    "the forward - feature selection method begins with an empty feature set and iteratively adds features one at a time , selecting the feature that best improves the model , as judged by the fom , at each step . due to the randomness of rfr , this procedure is repeated five times , and the features with the highest median importance are selected as the final feature set for our model .    before proceeding with forward feature selection for each of our three models , we must identify one feature that is automatically included in the final feature set .",
    "one of the advantages of random forest , over other algorithms , is that during the model construction process the relative importance of each feature is naturally and automatically measured , since a subset of features are excluded as splitting parameters in each non - terminal node of the tree @xcite .",
    "thus , we perform rfr using the full feature set , and adopt the most important feature determined by the random forest algorithm as the initial feature for forward selection . for each of the , , and  models the most important feature is @xmath103 .",
    "from there , we aim to only add features that improve the fom of the model . to do so",
    ", we calculate the cross - validated fom of all possible models with a single feature added to @xmath103 , and select the model with the smallest rmse .",
    "we repeat this process until a model with 50 features has been constructed . truncating the model at 50 features",
    "significantly reduces the computation time relative to forward selection over all 334 features .",
    "while the selection of 50 features is arbitrary , in practice , this choice extends the procedure well beyond the optimal number of features as measured by the fom ( see below ) , meaning that it has no effect on our final models .",
    "the forward selection procedure requires the creation of @xmath115 rfr models , which , though large , is tractable , unlike a complete search over all possible model combinations .",
    "( ` color_gr ` in the figure ) and iteratively add the feature that most improves the regression model as measured by the improvement in the fom .",
    "boxes show the cross - validated range of rmse following the addition of the feature to the model .",
    "the vertical dashed line shows the smallest median rmse .",
    "features above the dash - dot line , which is defined by the first feature with larger median rmse than the previous feature , are those that are selected for the optimal feature set .",
    "the procedure was rerun 5 times and the feature names are color coded according to the number of times they were selected in the optimal feature set : 0 ( black ) , 1 ( red ) , 2 ( blue ) , 3 + ( green ) . for brevity ,",
    "only the first 40 selected features are shown.,width=336 ]    .,width=336 ]    , width=336 ]    figures  [ fig : teff_ff ] ,  [ fig : logg_ff ] ,  and  [ fig : feh_ff ] show the results from the forward feature selection process for , , and , respectively .",
    "there is an improvement in the performance of the rfr model when the feature set is pruned .",
    "an important thing to note from figures  [ fig : teff_ff][fig : feh_ff ] is that the feature selection method is robust , since the ordering of features does not change significantly from run to run .",
    "the final selected features are selected in most of the runs , while only a few features are selected just once or twice .",
    "the occasional inclusion of a low - ranking feature in an individual run is the result of correlations between the features .",
    "random - forest methods feature three important tuning parameters : ( i ) ` ntree ` , the total number of decision trees used to construct the forest , ( ii ) ` mtry ` , the number of features that are used as potential splitting criterion in each non - terminal node of the tree , and ( iii ) ` nodesize ` , the minimum number of training set objects , meaning further splitting is not allowed , in a tree s terminal nodes . to optimize the random forest tuning parameters , we perform a grid search over ` ntree ` , ` mtry ` , and ` nodesize ` .    for rfr",
    "the `` rule - of - thumb '' values are ` mtry ` = @xmath116 , where @xmath97 is the total number of features used in the model , and ` nodesize ` = 5 . `",
    "ntree ` is specified by the user , during forward feature selection we selected ` ntree ` = 100 . broadly speaking , adjusting the tuning parameters adjusts the smoothness of the model , as they affect the complexity of the random forest .",
    "now that we have engineered an optimal feature set , we aim to determine which values of the training parameters will produce the optimal rfr models to predict , , and .        to optimize the random forest tuning parameters , we perform a grid search over ` ntree ` , `",
    "mtry ` , and ` nodesize ` . selected results from this grid search are shown in fig .",
    "[ fig : model_select ] . generally , we find that the precise choice of tuning parameters does not significantly affect the output of the models , as measured by the fom .",
    "the behavior of the models as ` mtry ` is adjusted is typical for non - parametric classifiers : small values of ` mtry ` are over - smoothed , high - bias and low - variance models , while large values of ` mtry ` lead to under - smoothed , low - bias and high - variance models .",
    "following forward - feature selection and the tuning of the rfr model parameters , we have constructed an optimized model for the prediction of , , and  from photometric light curves .",
    "we show the results of the final , optimized rfr models for predicting , , and  in fig .",
    "[ fig : final_model ] .",
    "the cross - validated rmse , a measure of the scatter between the predicted and true values of the parameters of interest , is 165 k , 0.39 dex , and 0.33 dex for , , and , respectively .",
    "our models show dramatic improvements of @xmath178% , 24% , and 33% for , , and , respectively , over the naive model , where the predicted value for all sources is equal to the sample population mean .",
    "our models further show an improvement of @xmath379% over optimized rfr models trained with single - epoch photometric colors ( see fig .",
    "[ fig : model_compare ] ) .",
    "the predictive power of the models improves significantly when examining subsets of the full training set .",
    "in addition to showing the cross - validated predictions for all sources in the training set , fig .  [",
    "fig : final_model ] also highlights the predicted values for the subset of sources where the sspp can be considered most reliable , namely , stars that did not raise any flags during either automated or visual inspection with 4500 k @xmath117 7500 k ,  @xmath118 , and snr @xmath119 .",
    "the validation set of bright stars upon which sspp was trained contained few examples outside this parameter space @xcite , which is why the predictions for hot and cool stars , as well as supergiants , are less reliable than those for main - sequence dwarfs .",
    "furthermore , the predictive accuracy of the sspp degrades rapidly as the snr declines @xcite . for this `` pristine sample ''",
    "the rmse is @xmath1125 k , 0.37 dex , and 0.27 dex for , , and , respectively .",
    "_ this is comparable to the typical uncertainties associated with a low - resolution spectrum _",
    "@xcite , and it represents a @xmath31220% improvement over colors - only models . finally , we remind the reader that the cross - validated rmse reflects the performance of the framework for sources that are similar to those in our training set . thus ,",
    "the application of this model to cool m stars or hot white dwarfs , stars for which the sspp can not provide reliable stellar parameters , will yield predictions that are significantly worse than the rmse .",
    "many , though not all , of the sources that fall outside our training set can be eliminated by adopting color cuts to select sources with 4500 k @xmath5",
    "@xmath5 9000 k , the temperature range over which the sspp is valid .    while the focus of this work concerns the use of variability information to estimate stellar parameters",
    ", we note that for  the scatter in our colors - only model , @xmath1145 k , is superior to all but one  measurement method in the sspp @xcite .",
    "this method is also vastly superior to the sspp methods that rely only on color , which have typical scatter of @xmath1200 k. while future studies are certainly necessary , this suggests that efforts to automatically determine  ( potentially for any stellar system , variable or otherwise ) should consider our rfr model .    despite producing a scatter similar to estimates from low - resolution spectra , the regression models for  and  produce biased predictions , as can be seen in fig .",
    "[ fig : final_model ] .",
    "there are at least three different factors contributing to this bias , which we discuss further in ",
    "[ sec : bias ] .",
    "an expanded training set containing more stars with low metallicity or low surface gravity , and having more precise spectroscopic determinations of the stellar parameters , will improve the future performance of model while also reducing the bias in the final predictions .",
    "some physical effects ( e.g. , reddening , correlation between the parameters ) , however , may always prove difficult to overcome (  [ sec : bias ] ) .",
    "additionally , the incorporation of machine learning regression tools capable of estimating uncertainties for their final predictions ( e.g. , @xcite ) would help to identify sources with the most biased predictions .",
    "the typical uncertainties for stellar parameters of bright stars ( snr @xmath120 50 ) determined by the sspp are @xmath121 k , @xmath122 dex , and @xmath123 ) = 0.24 $ ] dex , over the temperature range 4500 k @xmath124  @xmath124 7500 k @xcite . while these uncertainties are similar to the rmse values reported above for the pristine sample of our dataset , the methods used to determine the scatter as well as the underlying samples differ between this work and the sspp . here , we address those differences to determine how well our method compares to low - resolution spectroscopy .    the final reported uncertainties for the sspp are determined by adding internal and external uncertainties in quadrature .",
    "the external uncertainties dominate the error budget and are determined via a comparison of the sspp parameters with parameters determined via high - resolution spectroscopy for a common sample of 125 stars @xcite .",
    "the scatter is determined via a gaussian fit to the residuals ( e.g. , @xmath125",
    "@xmath69  @xmath126 ) .",
    "this method assumes that the tails of the distribution are gaussian , which is difficult to assess with only 125 stars .",
    "thus , we prefer the rmse , which makes no assumptions about the underlying distribution of uncertainties . in the case where the underlying distribution is gaussian ,",
    "then the rmse is approximately equal to the gaussian standard deviation .",
    "using the parameters from the sspp and the high - resolution - spectroscopic analysis , which are available in @xcite , we report the rmse for the sspp in table  [ tab : sample - compare ] .    lcccc  ( k ) & & 125 & 282 & 289 +  ( dex ) & & 0.37 & 0.35 & 0.31 +  ( dex ) & & 0.27 & 0.25 & 0.21 +    for  and , the rmse for the pristine sample of our dataset and the sspp are remarkably similar ( see the middle two columns of table  [ tab : sample - compare ] ) .",
    "this comparison may be misleading , however , if the sample of stars in this study and those in the sspp validation set are different .",
    "this scenario is likely given that the sources in this study are specifically selected from the population of variable stars .",
    "thus , we employ a weighted bootstrap resampling method to better compare the stars from the sspp validation set to those in this study . for both samples",
    ", we estimate the stellar population density individually in , , and  using a non - parametric gaussian kernel density estimator ( kde ) , where the kde bandwidth has been determined via scott s rule @xcite .",
    "we then perform a weighted bootstrap resampling of the sspp validation set , where the weights are determined via the ratio of the kde estimate for our pristine sample to the kde estimate of the sspp validation set .",
    "the weights ensure that the bootstrap distribution of sspp validation sources better matches the distribution of variable stars in our study .",
    "for each of the stellar parameters , we obtain 1000 bootstrap samples of the rmse , and the mean of these rmse values are reported in table  [ tab : sample - compare ] . within the constraints of the currently available data , our weighted - bootstrap resampling produces a better comparison between our method and the sspp .",
    "ideally , future efforts to compare our method to parameters derived from low - resolution spectra would include a large sample of stars ( @xmath127 ) which have high- and low - resolution spectroscopic observations in addition to well sampled light curves .",
    "table  [ tab : sample - compare ] shows that the rmse for the sspp samples is significantly worse than the method presented in this paper .",
    "the high - resolution analysis presented in @xcite , and adopted by @xcite , contains two sets of spectra , labeled `` het , '' for those obtained with the hoberly - eberly telescope , and `` others , '' for those obtained with other high - resolution instruments .",
    "the het sample shows an approximately constant @xmath1@xmath69200 k bias relative to sspp  measurements , while the others sample shows an approximately constant @xmath140 k bias relative to the sspp .",
    "when combined , these biases partially offset , leading to an overall scatter of @xmath1140 k , as adopted in @xcite . if we remove these approximately constant offsets from these respective samples , and reject 3-@xmath128 outliers , we find that the rmse for the sspp measurements relative to the high - resolution analysis is @xmath1180 k.",
    "we echo the sentiment presented in @xcite that further high - resolution spectra , across the entire temperature range for the sspp , should be obtained to further investigate this potential bias between high - resolution analyses and the sspp .",
    "from table  [ tab : sample - compare ] , we see that the bootstrap sample of the sspp validation set results in an rmse scatter that is @xmath118% and 24% better than the method in this paper for  and , respectively",
    ". thus , low - resolution spectroscopic observations are superior to our machine learning method . nevertheless , our method , which produces a scatter that is only @xmath120% worse than low - resolution spectroscopy , remains competitive and very attractive as we embark upon the lsst era .",
    "furthermore , we argue below (  [ sec : bias ] ) that it should be possible to further refine and improve our machine - learning method .",
    "while broadband photometric methods will likely never serve as a replacement for low - resolution spectroscopy when it comes to measuring detailed atmospheric abundances ( e.g. , @xcite ) , we have demonstrated that the combination of light curves and colors can produce reliable estimates of the fundamental atmospheric parameters , , and .      as a final step in the construction of our model ,",
    "we provide predictions of , , and  for each of the sources in the uwvsc .",
    "we exclude spectroscopically confirmed quasars from sdss ( see @xcite ) , and note that there may be additional quasars that have not yet been spectroscopically identified ( see @xcite ) . for the remaining sources , which will virtually all be stellar",
    ", our model predictions are provided for follow - up studies of stripe 82 sources .",
    "we note that , similar to quasars , the predictions for sources outside the parameter space of our training set will likely be incorrect .",
    "the development of automated tools , similar to the sspp , capable of measuring stellar parameters for hot ( e.g. , wolf - rayet stars ) , cold ( e.g. , pulsating red giants , flaring m - dwarfs ) , and very high surface gravity stars ( e.g. , white dwarfs ) , is essential for extending our model to cover the full range of variability types found across the hertzsprung - russell diagram .",
    "our final predictions for uwvsc sources that are neither spectroscopically confirmed quasars nor sources with sspp measured parameters ( see  [ sec : sspp ] ) are provided in table  [ tbl - final_preds ] .",
    "should any other researchers wish to design their own models using the training set from this study , we will happily make the data available upon request .",
    "rrrrrr 429 & 1.145510 & -0.887604 & 4215 & 4.02 & -0.89 + 1606 & 3.407860 & -0.997584 & 4388 & 4.00 & -0.91 + 1970 & 0.599323 & 0.584808 & 5413 & 3.51 & -1.88 + 1990 & 4.362962 & 0.295144 & 4196 & 3.90 & -0.80 + 3219 & 0.826910 & 0.848085 & 5069 & 3.97 & -1.09 + 3271 & 0.653706 & 0.496230 & 6233 & 3.79 & -1.73 + 3352 & 0.347327 & 0.084452 & 7482 & 3.46 & -1.27 + 4058 & 1.636241 & -0.297831 & 4405 & 3.45 & -0.86 + 4357 & 0.054138 & 0.234712 & 4229 & 3.99 & -0.80 + 4400 & 0.592502 & -1.232759 & 4223 & 4.00 & -0.90 +",
    "there are three different effects that contribute to the bias present in the final predictions from the rfr models ( see fig .  [",
    "fig : final_model ] ) .",
    "the first is a consequence of using non - parametric , data - driven models : there is a natural regression to the mean wherein sources near the extremes of the population distributions are predicted to have values closer to the sample mean than their true values @xcite .",
    "the second is a biasing of the regression slope toward zero due to noise associated with the spectroscopically determined values of the stellar parameters , an effect known as regression dilution bias @xcite .",
    "the third is a subtle physical effect associated with the correlation between color ( i.e. , ) and  and  in our training set sample .",
    "all non - parametric , data - driven regression methods experience regression to the training - set mean . for random forest regression ,",
    "each decision tree predicts a parameter value for an unlabeled source that is equal to the mean value of that parameter for all training set sources that end up in the same terminal node of the tree as the unlabeled source .",
    "the final prediction for the parameter of interest is the mean of the values predicted by each of the individual trees .",
    "this methodology leads to two important consequences : the first is that random forest regression can not make predictions outside the range of values contained within the training set , and the second is that sources located near the extrema of the training set will have predictions biased toward the training set mean . for instance",
    ", the star with the lowest surface gravity in our training set has @xmath129 dex , but during cross validation the best possible prediction for  for this source is 1.39 , the mean  value for the next six lowest surface gravity stars . ,",
    "meaning that every single tree prediction is the result of averaging the  values for _ at least _ 6 training set sources . ]",
    "percentile of the training set distributions .",
    "notice that virtually all of the model - inferred predictions lie inside the inter @xmath130 percentile , which is strongly biased towards high  and high .",
    "this regression to the mean results in predictions for sources near the low ( high ) end of the distribution to be over- ( under- ) predicted , which biases the regression slope towards zero.,width=345 ]    to further illustrate the results of this bias , a scatter plot showing both the spectroscopic and model - predicted values of  against  is shown in fig .",
    "[ fig : reg_to_mean ] .",
    "the red dashed lines show the extrema of the training set distributions : the random forest regression model is incapable of predicting values outside this area .",
    "even more revealing is the inter @xmath130 percentile of the training set distributions , shown via solid grey lines . the right side of fig .",
    "[ fig : reg_to_mean ] shows that virtually all random forest regression predictions are encompassed by the inter 95% of the training set distribution .",
    "thus , sources with low ( high ) values of  or  will have predictions that are biased above ( below ) the true values of those parameters .",
    "one way to improve this bias would be to reduce the imbalance that currently exists within the training set .",
    "the scarcity of sources with low surface gravity or low metallicity makes it difficult for the model to predict similar values for unlabeled sources .",
    "a reduction in the imbalance in the training set would effectively expand the size of the grey rectangle shown in fig .",
    "[ fig : reg_to_mean ] , lowering the bias in predictions for sources near the extrema of the training set distribution .",
    "it is possible that this reduction in the bias could lead to increased variance in the model predictions , potentially increasing the rmse . in an ideal scenario ,",
    "the training set sample would be fully representative of the population of sources for which predictions are required , but this is often difficult to achieve in practice .",
    "the second factor contributing to the final - model bias is the result of both the light - curve features and the spectroscopically - measured parameter values being noisy .",
    "the uncertainties associated with these measurements leads to a flattening of the regression slope , an effect known as regression dilution bias ( e.g. @xcite ) .",
    "moving forward , it will be impossible to completely eradicate this bias since infinitely precise light - curve feature measurements and spectroscopic parameter measurements will never be available .",
    "nevertheless , there are some improvements that could be made to mitigate against this bias .    light curve features , particularly those that measure periodicity - the most important features for variable star classification @xcite - are strongly dependent upon both the observational cadence and photometric noise properties of a survey .",
    "there is empirical evidence that the uncertainty on the light - curve feature measurements decreases if the total number of observations increases or the photometric accuracy improves @xcite . with the caveat that the samples are relatively small",
    ", this also appears to be true in the present study : for  and  we find that the rmse for the subsample of pristine sources with more than 40 @xmath18-band observations is @xmath115% better than for pristine sources with fewer than 30 @xmath18-band observations .",
    "the improvement is less dramatic in  ( @xmath15% ) , but we find a @xmath120% improvement for sources with clearly identified periodicity .",
    "this portends well for lsst , which will obtain @xmath11000 observations per star , significantly more than the sdss light curves in the present study , which have a median of 33 @xmath18-band observations .",
    "more precise spectroscopic measurements can be obtained , either via high - resolution spectroscopy or an automated method that improves upon the sspp . however , as the nature of our sample is selected due to its variability , the true values of  or  can not be precisely measured in a single instant ( i.e.  the time of spectroscopic observation ) , because they are variable .",
    "one possible , though expensive , way to reduce this bias is via repeated observations of a subset of stars in the training sample , which can then be used to estimate a multiplicative factor to correct the regression dilution bias @xcite .",
    "the third , and possibly most significant , contribution to the observed bias in the final predictions for  and  is the importance of the color features . figures  [ fig : logg_ff ]  and  [ fig : feh_ff ] show that the four color features are among the most powerful discriminants for predicting  and , while fig .",
    "[ fig : loggvteff ] shows that the cooler stars ( @xmath131 k ) in our training set are most likely to have a dwarf - like surface gravity ( @xmath132 ) and sub - solar metallicity (  @xmath133 ) , while warm stars ( @xmath134 k ) are most likely to have giant - like gravity ( @xmath135 ) and be metal poor (  @xmath136 ) .    to further illustrate the importance of photometric colors",
    ", we once again show our final model predictions in figure  [ fig : color_bias ] , with the individual sources colored via their spectroscopically determined .",
    "it is immediately clear from this figure that almost without exception warm stars are predicted to have low  and low , while the opposite is true for cooler stars .",
    "the photometric colors essentially restrict the random forest regression predictions of  and  to a narrow range of values , which can only be slightly refined by the light curve features . in other words , once the model recognizes a source as cool , it is incapable of then identifying it as either a low surface gravity or low - metallicity star .        to test this hypothesis we constructed a random forest regression model to predict  on the subset of sources within our training set with @xmath137 , roughly corresponding to @xmath138 k. the model was constructed without photometric colors , i.e.  using only the time - domain features .",
    "the performance of this model is worse ( @xmath139% ) than the final optimized model presented in  [",
    "sec : final_results ] .",
    "the same is true for weighted random forest regression models .",
    "we conclude that the 66 light - curve features adopted for this study are incapable of clearly distinguishing between low surface gravity sources and dwarf - like surface gravity sources at similar .",
    "[ fig : color_bias ] shows that the  predictions are affected by a similar phenomenon , though the effect is less pronounced in that case .    while the light - curve features are incapable of clearly separating supergiants from dwarfs at similar temperatures , it is important to remember that the addition of light - curve features does improve the overall performance of the models , by as much as @xmath320% . moving forward , the best way to alleviate the photometric - color bias",
    "would be via the creation of new features capable of separating high and low  ( ) sources at similar temperatures , though we note that feature construction is a very difficult problem .",
    "we believe the optimal approach to improve the feature set would be to perform a full classification of the variables in stripe 82 , similar to the classification of sources in the all sky automated survey @xcite .",
    "following classification , domain experts on the class of stars comprising the low  ( ) and high  ( ) stars could help to identify new features capable of separating these variables at similar temperatures .",
    "adding these features to the regression models should significantly improve its overall predictive power .",
    "we have presented a new machine - learning framework that is capable of predicting , , and  from photometric observations alone .",
    "the framework was built following a systematic spectroscopic survey of variable sources .",
    "targets for the spectroscopic survey were selected from the uwvsc , a publicly available catalog of sdss light curves for  variable sources .",
    "the survey was designed to be agnostic toward variability class : all bright ( @xmath41 mag ) , well - observed ( @xmath140 epochs ) sources were included as potential targets .",
    "spectroscopic observations were carried out using the multi - fiber hectospec instrument on the mmt . in sum",
    ", we obtained 5914 hectospec spectra of 5825 unique sources , which we supplemented with 3121 sdss spectra of stellar sources in the uwvsc .",
    "we applied an adapted version of the sspp to each of the 9035 spectra in our combined sample to determine , , and .",
    "the sspp produced reliable estimates of these parameters for 5994 sources ; the remaining sources suffered some peculiarity ( most often low snr or @xmath79 k ) that prevented reliable estimates of their stellar parameters .    to characterize the photometric behavior of uwvsc sources",
    ", we measured 66 light - curve features in each of the @xmath15 bands .",
    "our machine - learning framework utilizes the random forest algorithm to perform a non - parametric regression between , , and  and these photometric light - curve features .",
    "thus , we have developed a method capable of measuring these parameters without the need for spectroscopic observations .",
    "our final , optimized models determine , , and  with an rmse of 165 k , 0.39 dex , and 0.33 dex , respectively .",
    "when we restrict our sample to the subset of sources for which the sspp is most reliable the rmse decreases to @xmath1125  k , 0.37  dex , and 0.27  dex , respectively .",
    "this scatter is comparable to what is achieved with low - resolution spectra , and it represents an improvement of @xmath31220% over machine learning models trained solely with photometric colors .",
    "the model predictions of  and  are biased as a result of three different effects : ( i ) regression to the mean , ( ii ) regression dilution bias , and ( iii ) a physical effect associated with the correlation between photometric colors and  and  in our training set .",
    "we discussed possible methods to alleviate these biases in the future .",
    "we view the results presented herein as an important step towards the goal of extracting the most impactful information from photometric time - domain surveys .",
    "the uwvsc contains @xmath167k sources , in contrast , lsst is expected to discover at least 50 million variable stars @xcite .",
    "the vast majority of these sources will be prohibitively faint for spectroscopic observations on anything smaller than a 30-m class telescope .",
    "this necessitates the development of novel software applications : as a demonstration of our framework , we presented estimates of , , and  for all uwvsc sources ( see  [ sec : final_preds ] ) .    as we embark upon the burgeoning age of celestial cinematography ( the lsst will , in essence , make a 10 yr movie , sampled every 3 days , of everything in the southern sky ) , it is essential that we develop advanced tools for discovery .",
    "more data does not always equate to better information nor expanded knowledge : sophisticated new tools are required to decipher the complex data stream from lsst . based on the results shown here , it is not unreasonable to think that lsst may be considered a pseudo - spectrographic engine",
    ". our machine - learning framework will allow fundamental parameters to be determined without the need for additional spectroscopy .",
    "the method can be leveraged for a huge advantage given the high data rates of upcoming surveys and the difficulty involved for spectroscopic follow - up .",
    "once the atmospheric parameters are determined additional fundamental properties , namely mass @xmath141 , luminosity @xmath142 , and radius @xmath143 , can be ( probabilistically ) inferred ( e.g. , @xcite ) . in this way the most detailed maps of the milky way ever constructed will be charted , which promises to reveal and solve several mysteries regarding the formation of the galaxy .",
    "this work has made extensive use of the online data and tools made available by the sdss collaboration .",
    "we are particularly grateful to  .",
    "ivezi and collaborators at the university of washington for making their calibrated light curves of stripe 82 sources publicly available .",
    "we thank bd bue for a fruitful conversation concerning regression bias .",
    "we also thank the anonymous referee for several useful comments that have helped to improve this paper .",
    "a.a.m . acknowledges support for this work by nasa from a hubble fellowship grant : hst - hf-51325.01 , awarded by stsci , operated by aura , inc .",
    ", for nasa , under contract nas 5 - 26555 . j.s.b . acknowledges support from an nsf - cdi grant 0941742 .",
    "jae gratefully acknowledges support from an alfred p. sloan research fellowship .",
    "part of the research was carried out at the jet propulsion laboratory , california institute of technology , under a contract with nasa .",
    "observations reported here were obtained at the mmt observatory , a joint facility of the university of arizona and the smithsonian institution .                                  , b.  l. , abbott , t.  m.  c. , angstadt , r. , et  al .",
    "2012 , http://dx.doi.org/10.1117/12.926216[in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 8446 , society of photo - optical instrumentation engineers ( spie ) conference series ]                    , n. , burgett , w. , chambers , k. , et  al .",
    "2010 , http://dx.doi.org/10.1117/12.859188[in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 7733 , society of photo - optical instrumentation engineers ( spie ) conference series ]"
  ],
  "abstract_text": [
    "<S> a fundamental challenge for wide - field imaging surveys is obtaining follow - up spectroscopic observations : there are @xmath0 photometrically cataloged sources , yet modern spectroscopic surveys are limited to @xmath1few@xmath2 targets . as we approach the large synoptic survey telescope ( lsst ) era , new algorithmic solutions are required to cope with the data deluge . here we report the development of a machine - learning framework capable of inferring fundamental stellar parameters ( , , and ) using photometric - brightness variations and color alone . </S>",
    "<S> a training set is constructed from a systematic spectroscopic survey of variables with hectospec / mmt . in sum , </S>",
    "<S> the training set includes @xmath19000 spectra , for which stellar parameters are measured using the segue stellar parameters pipeline ( sspp ) . </S>",
    "<S> we employed the random forest algorithm to perform a non - parametric regression that predicts , , and  from photometric time - domain observations . </S>",
    "<S> our final , optimized model produces a cross - validated root - mean - square error ( rmse ) of 165  k , 0.39  dex , and 0.33  dex for , , and , respectively . examining the subset of sources for which the sspp measurements are most reliable </S>",
    "<S> , the rmse reduces to 125  k , 0.37  dex , and 0.27  dex , respectively , comparable to what is achievable via low - resolution spectroscopy . for variable stars this represents a @xmath312@xmath4% improvement in rmse relative to models trained with single - epoch photometric colors . as an application of our method </S>",
    "<S> , we estimate stellar parameters for @xmath154,000 known variables . </S>",
    "<S> we argue that this method may convert photometric time - domain surveys into pseudo - spectrographic engines , enabling the construction of extremely detailed maps of the milky way , its structure , and history . </S>"
  ]
}