{
  "article_text": [
    "computer - aided modeling is becoming an essential tool in designing new experiments and in testing theoretical models against the observational data .",
    "for example , because of the cost of any space - based telescope , nowadays it is not even conceivable to plan a mission without first simulating the performances either of the instruments and/or of the observing mode .",
    "it is obvious to stress that the reliability of such simulations depends critically on the possibility to reproduce realistic physical scenarios .",
    "a wide assumption , which is often made because of its simplicity , is that the processes underlying a given physical phenomenon obey gaussian , and therefore linear , statistics .",
    "however , although as practical as this assumption could be , it is not applicable for most of the physical systems which , on the contrary , are expected to be characterized by nonlinear behaviours . some examples :    *",
    "the high spatial resolution observations of sky images are revealing a lot of details of the sky emission which are not of easy interpretation ( e.g. @xcite ) .",
    "for istance , in the far infrared spectral domain , the studies of source properties imply the disentangling of the source emission and position from those of a much stronger background whose spatial structure is highly non - gaussian .",
    "this task becomes crucial for most space - borne surveys of the extragalactic sky and of star - forming regions in the galaxy for which it is of interest to simulate the far - ir and sub - mm emission of the galaxy and the source confusion in the beam .",
    "their nature is intrinsically non - gaussian and to match their observed properties an appropriate method must be used . * the interpretation of the new flow of data on the cosmic microwave background ( cmb ) spatial distribution , from present and future experiments ( boomerang , maxima , map and planck ) , is involving a large theoretical effort ( see e.g. @xcite and references therein ) .",
    "studies of the spatial structure of the cmb provide fundamental clue on the physical processes generating the primordial density fluctuations which are thought to be at the origin of the present - day structures .",
    "there are deep theoretical motivations , both in the framework of inflationary models and in cosmological defects scenarios , to consider the initial density perturbations obeying non - gaussian statistics . in any case",
    ", the subsequent growth of these density fluctuations , triggered by the gravitational potential , makes the late time evolution nonlinear .",
    "the testing of these predictions requires algorithms able to discerne the true statistical nature of the observed fields . some of their properties can be analytically recovered but the bulk of non - gaussian random fields characteristics can be inferred only through simulations ( see e.g. , @xcite ) .",
    "the aim of this paper is to provide a general and mathematical approach to the problem of generating non - gaussian random fields when a correlation structure is given either by a theoretical model or by the statistical analysis of experimental data .",
    "some numerical procedures to perform simulations of such fields are also presented .",
    "the arguments are outlined on a quite general basis in view of applications in a wide astrophysical context .",
    "the reason to fix the correlation structure is that this is the simplest way to obtain non - trivial ( i.e. non - pure noise ) fields ( see below ) .",
    "the problem can be formalized as follows .",
    "a real , random field @xmath0 can be defined as a collection of random variables @xmath1 at points with coordinates @xmath2 in a _ n_-th dimensional `` parameter space '' . in other words , for each `` position '' @xmath3 , @xmath4 , where @xmath5 is a vector characterized by a multidimensional distribution function @xmath6 and a multidimensional probability density function @xmath7 . according to the particular problem at hand , @xmath8 may correspond to a set of spatial / angular coordinates ( spatial random fields ) , to time ( time processes ) , to a mix of these two ( spatio - temporal random fields ) or even to more general situations .    in many practical situations they are of interest the",
    "so called _ scalar _ random fields , where @xmath9 .",
    "this means that for a specific @xmath3 , @xmath10 is characterized by a scalar random variable @xmath11 with one - dimensional distribution function ( df ) @xmath12 and one - dimensional probability density function ( pdf ) @xmath13 . in this paper",
    "we will consider only this kind of random fields .",
    "the more general case of vector - valued random fields represents a more complex problem and will not be addressed in this work ( for more details about this topic see @xcite ) .",
    "the main problem in the numerical simulation of a generic @xmath0 is that , in general , given two arbitrary `` positions '' , say @xmath14 and @xmath15 , @xmath16 and @xmath17 are not independent one of the other .",
    "as well known from the standard theory of random processes ( e.g. @xcite ) , the practical applications to generate random fields requires to put some constraints .",
    "the most common choice is that , specified the distribution function @xmath12 , @xmath0 be completely characterized by the covariance function , @xmath18 , with @xmath19,\\ ] ] where @xmath20 $ ] stands for expected value .",
    "the reason is that @xmath18 represents the simplest form of mutual relationship between the elements of @xmath0 .    in astronomical applications ,",
    "very often it is possible to adopt some simplifying conditions . in particular",
    ", it is possible to assume that @xmath0 is isotropic .",
    "this means that the covariance function depends on the length of the vector @xmath21 but not on its direction : @xmath22 .",
    ", @xmath23^{1/2}= ( \\sum_{i=1}^n a_i^2)^{1/2}$ ] provides its length ( norm ) . here",
    "@xmath24 means the transpose of vector @xmath25 . ] in other words , @xmath0 is characterized by a spherical symmetry .",
    "this property is very useful since it allows to characterize @xmath0 through the correlation function @xmath26,\\ ] ] where @xmath27 , and @xmath28 and @xmath29 are , respectively , the mean and the variance corresponding to the distribution @xmath12 .",
    "although the isotropic case is of large interest in astronomical applications , here we prefer to adopt a more general formalism , suited for all homogeneous fields .",
    "indeed , in this case , the covariance function depends on @xmath21 .",
    "according to this definition , @xmath30 , in equation ( [ eq : rho ] ) has to be replaced by @xmath31 .",
    "most of the techniques for simulating a non - gaussian , scalar , random field @xmath0 , with a prescribed correlation function , @xmath32 , and a prescribed one - dimensional marginal @xmath12 , are more or less explicitly based on the two following steps :    * generation of a zero - mean , unit - variance , scalar , gaussian random field @xmath33 with a prefixed correlation structure @xmath34 ; * mapping ( transformation ) @xmath35 according to @xmath36,\\ ] ] where @xmath37 $ ] represents an appropriate function .",
    "this operation is named _ memoryless transformation _ since the value of @xmath0 at an arbitrary @xmath3 depends only on the value of @xmath38 .",
    "the rationale behind such a procedure is that the direct generation of a generic @xmath0 , with a specific @xmath39 , is a very difficult operation .",
    "the gaussian case represents a useful exception .",
    "hence , it results much easier to obtain @xmath0 by transforming a precomputed @xmath33 .",
    "however , after the mapping ( [ eq : map ] ) , in general @xmath34 does not coincide with @xmath32 .",
    "therefore , it is necessary to transform an @xmath33 characterized by an appropriate @xmath34 whose functional form depends on @xmath32 .",
    "it is well known from elementary statistics that for a mapping @xmath40 , with @xmath41 the standard one - dimensional gaussian variable , the pdf of the random variable @xmath11 can be obtained from that of the random variable @xmath41 via a change of variable technique . in the general case",
    "that the tranformation @xmath42 is not one - to - one , if the equation @xmath43 has a numerable set of @xmath44 real solutions @xmath45 , and if @xmath46_{x = x_j}$ ] , @xmath47 exist , then @xmath13 is given by @xcite @xmath48 in correspondence to the values @xmath49 , where equation ( [ eq : transform ] ) does not have real solutions , it happens that @xmath50 .",
    "furthermore , the correlation function @xmath32 is given by @xcite @xmath51 ~[g(x_2 ) - \\mu_r ] ~\\phi(x_1 , x_2 ; \\rho_x({{\\mbox{\\boldmath $ \\tau$}}}))~dx_1 ~dx_2,\\ ] ] where , @xmath52 and @xmath53 , and @xmath54    at first sight , from these equations",
    "it may seem that , given the appropriate function @xmath42 and the covariance function @xmath34 , obtained via the inversion of equation ( [ eq : change ] ) , it is possible to generate an @xmath0 characterized by an arbitrary @xmath32 .",
    "in reality , given a generic @xmath42 , there is no guarantee that equation ( [ eq : change ] ) can be inverted .",
    "furthermore , it is possible to show @xcite that @xmath32 can take values only in the interval @xmath55,\\ ] ] where @xmath56 with @xmath57 providing the smallest value of the random variable @xmath11 satisfying the condition that @xmath58 . in particular , @xmath59 only for symmetric distributions .",
    "for example , @xmath60 in case of the exponential pdf : @xmath61 .",
    "this shows that , in general , for a fixed @xmath42 it is not possible to obtain a @xmath62 presenting values external to the interval ( [ eq : interval ] ) .",
    "another problem stems from the fact that the function @xmath34 , necessary to obtain the target @xmath32 via equation ( [ eq : change ] ) , must be a non - negative definite function must share this property since , according to the wiener - khinchin theorem , the power - spectrum of a process is provided by the fourier transform of the corresponding correlation function . ] otherwise the generation of the aimed @xmath0 is prevented since @xmath34 does not represent any correlation function .    in principle , equation ( [ eq : change ] ) can be used to obtain @xmath34 in a closed form , but in reality such an approach can be followed only in a limited number of cases",
    ". indeed , very often the transformation ( [ eq : change ] ) has a very complex form and can be inverted only via a numerical approach .",
    "certainly one of the most effective method for generating @xmath0 is represented the analytical handling of equations ( [ eq : change1 ] ) and ( [ eq : change ] ) .",
    "unfortunately , this is also the most difficult approach to pursue ; only in a limited number of cases it has been possible to find out the analytical relationship between @xmath34 and @xmath32 .",
    "some useful examples are presented below ( see also figure [ fig : fields ] ) :      if @xmath33 is a homogeneous , zero - mean , unit - variance gaussian fields with a correlation function @xmath34 , the random fields obtained via @xmath63 are called lognormal fields since they are characterized by the one - dimensional marginal lognormal pdf @xmath64 it is possible to show @xcite that the moments of order @xmath65 of @xmath66 are given by @xmath67= e^{k \\mu + k^2 \\sigma^2 /2}.\\ ] ] in particular , the mean and the variance are @xmath68 respectively .",
    "furthermore , it is possible to show that the relationship between @xmath69 and @xmath34 can be expressed in the form    @xmath70    from this equation it is trivial to see that , when @xmath71 , the lower bound of @xmath69 is @xmath72 .      if @xmath73 , @xmath74 , is a collection of independent zero - mean , unit - variance gaussian fields with the same correlation function @xmath34 , the random fields obtained via @xmath75 are called gamma fields .",
    "that is because the corresponding one - dimensional marginal pdf is a gamma distribution with @xmath76 degrees of freedom @xmath77 where @xmath78 is the gamma function .",
    "it can be shown that the moments of order @xmath65 of @xmath79 are given by @xmath80= \\frac{\\gamma(m+k)}{\\gamma(m)}= \\prod_{i=0}^{k-1 } ( m + i ) , \\qquad k > -m.\\ ] ] in particular , the mean and the variance are @xmath81 it can also be shown @xcite that , idependently from the value of @xmath76 , the relationship between @xmath82 and @xmath34 can be expressed in the form @xmath83 the class of the gamma fields is interesting since it contains , as particular cases , both the chi - square and the exponential fields .    from equation ( [ eq : corrg ] )",
    "it appears that the lower bound of @xmath82 is zero . in other words , through the mapping ( [ eq : sumg ] ) it is not possible to obtain @xmath84 characterized by correlation functions with negative values . here , however , it is necessary to stress that such a limit is not intrinsic to the gamma fields , but only to the transformation ( [ eq : sumg ] ) .",
    "in fact , through different mappings it is possible to generate @xmath84 with correlation functions having negative values ( see below ) .      given two independent gamma fields , say @xmath84 and @xmath85 , characterized by the same correlation function @xmath86 , the random fields obtained via @xmath87 are called beta fields because their one - dimensional marginal pdf is a beta@xmath88 distribution @xmath89 it can be shown that the moments of order @xmath65 of @xmath90 are given by @xmath91= \\frac{\\gamma(m+k ) \\gamma(m+n)}{\\gamma(m ) \\gamma(m+n+k)}.\\ ] ] in particular , the mean and the variance are @xmath92 respectively .",
    "it can be also shown @xcite that the relationship between @xmath93 and @xmath34 can be expressed in the form @xmath94 , \\qquad n+m > 1,\\ ] ] where @xmath95 , \\qquad 0 \\leq \\rho \\leq 1 , ~q\\in\\{1,2,\\ldots\\},\\ ] ] with the end values @xmath96 and @xmath97 .",
    "the class of the beta fields is basic for describing variables bounded at both sides .",
    "for example , @xmath98 corresponds to the uniform field .    as well as for the gamma fields ,",
    "also for the beta fields obtained through mapping ( [ eq : beta ] ) it happens that the lower bound of @xmath93 is zero .",
    "again , this limit is not intrinsic to the beta fields but only to the particular mapping used .",
    "in case one is interested in a @xmath0 characterized by an @xmath12 not reproducible through a function @xmath42 available in analytical form and/or that does not permit an easy calculation of @xmath34 , it is necessary to resort to numerical methods . regarding this , the following presents three methods that can be useful in astronomical applications .",
    "the most obvious method is based on the numerical inversion of equation ( [ eq : change ] ) .",
    "whenever possible , this is the method to use since , contrary to the procedures presented below , it is able to provide exact results ( within the limits of the numerical computation ) . in particular , this inversion operation is feasible when @xmath42 is a monotonic increasing , real function . indeed , in this case the relationship between @xmath32 and @xmath34 can always be inverted .    in the case of distributions @xmath99 with no atoms ( a concentration of a finite probability mass at a point ) , a very useful kind of monotonic increasing functions @xmath42 is represented by the mapping @xmath100 \\},\\ ] ] where @xmath101 denotes the gaussian distribution function and @xmath102 the inverse distribution function of @xmath0 .",
    "indeed , through @xmath103 the generation of fields @xmath0 , with arbitrary one - dimensional marginal distribution functions , is possible .",
    "furthermore , it can be shown @xcite that via the mapping ( [ eq : map1 ] ) it is possible to obtain @xmath0 characterized by @xmath32 fully exploiting the interval ( [ eq : interval ] ) with @xmath104 that can be simplified to the form @xmath105 - \\mu_r^2}{\\sigma_r^2}.\\ ] ]    figure [ fig : rho ] shows the relationship between @xmath106 and the @xmath107 , concerning some well known @xmath108 , obtained via equations ( [ eq : map1 ] ) and ( [ eq : change ] ) . from this figure",
    "it is possible to realize some interesting points that can also be proved via theoretical arguments @xcite :    * @xmath32 is an increasing function of @xmath34 ; * @xmath109 ; * the difference between @xmath32 and @xmath34 are not significant for a broad range of values of these functions .    as explained in section [ sec :",
    "notes ] , once @xmath34 has been calculated , it is necessary to check that this function is non - negative definite .",
    "a possibility consists in evaluating the fourier transform of @xmath34 and verifying that it presents no negative values .",
    "the only concern regarding the numerical inversion of equation ( [ eq : change ] ) is that , in general , this operation requires the calculation of a large number of double integrals . in certain situations ,",
    "that could represent a computationally too expensive problem , and therefore it is necessary to resort to other numerical techniques .",
    "an alternative approach for the simulation of a non - gaussian @xmath0 is based on the expansion of the field in hermite polynomials .",
    "these polynomials can be defined through the rodriguez s formula @xmath110 and have the important property of being orthogonal relative to the standard gaussian distribution , so that @xmath111 where @xmath112 is the kronecker function .    an explicit expression for @xmath113",
    "is given by @xcite @xmath114 where @xmath115 means the largest integer @xmath116 .",
    "a field @xmath0 can be expanded according to @xmath117 where the coefficients @xmath118 are unknown and must be determined . in the practical applications ,",
    "also the `` optimal '' value @xmath119 has to be determined .",
    "one possibility for obtaining the coefficients @xmath118 , for a fixed @xmath119 , is to minimize the objective function @xcite @xmath120\\ ] ] that yields the conditions @xmath121= 0 , \\qquad k=0,1 , \\ldots n_h,\\ ] ] so that @xmath122 , \\qquad k=0,1,\\ldots , n_h,\\ ] ] because of equation ( [ eq : hnormal ] ) . here",
    ", the important point is that the coefficients @xmath118 are independent from the structure of @xmath33 since , for a specific position @xmath3 , the value of @xmath123 depends only on @xmath38 .",
    "that allows us to estimate such coefficients by means of @xmath124,\\ ] ] where @xmath41 is the standard gaussian random variable , and @xmath11 is the random variable distribuited according to the marginal distribution required for @xmath0 .",
    "following this approach , the procedure implemented in the subroutine _ hermcoeff _ in figure [ fig : code2 ] is :    1 .   generation of a large ( column ) array of independent and uniform random deviates @xmath125^t$ ] ; 2 .",
    "mapping of @xmath126 in two arrays @xmath127^t = f_x^{-1}({{\\bf u}})$ ] and @xmath128^t= f_r^{-1}({{\\bf u}})$ ] . here",
    ", @xmath129 is an array of independent standard gaussian random deviates , whereas @xmath130 is an array of independent random deviates distributed according to @xmath12 ; 3 .",
    "calculation of the arrays @xmath131^t$ ] with @xmath132 , @xmath133 ; 4 .",
    "calculation of the coefficients @xmath118 according to @xmath134    the `` optimal '' value for @xmath119 can be determined on the basis of the value of the parameter @xmath135 provided by the criterion @xmath136,\\ ] ] where @xmath137 $ ] is a measure of the distance between @xmath13 and the pdf , @xmath138 , relative to the random deviates @xmath139    although this approach also presents the problem that @xmath140 , here the situation is easier than the method considered in the previous section . indeed ,",
    "because of the orthogonality of the hermite polynomials @xcite , and in particular because of the so called kibble - slepian formula @xcite , we have that @xcite @xmath141 therefore , @xmath34 can be obtained by the numerical inversion of a polynomial function .",
    "it is better to recall that , before using it , such @xmath34 must be tested to be a non - negative definite function .",
    "once @xmath118 , @xmath142 , and @xmath34 have been determined , @xmath0 can be obtained by equation ( [ eq : hexpansion ] ) that is implemented in the subroutine _",
    "field_herm _ shown in figure [ fig : code2 ] .    some notes on the use of the subroutine _ hermcoeff _ :    * the input parameters are the length of the arrays @xmath129 and @xmath130 , the pdf @xmath13 , the target correlation function @xmath32 , and the parameter @xmath135 for the convergence criterion .",
    "the output quantities are the number @xmath119 of terms for the hermite expansion , the vector @xmath143 containing the values of the coefficients of the expansion , and the correlation function @xmath34 of the gaussian random field @xmath33 to be used in the subroutine _ field_herm _ ; * typical value for @xmath144 is several thousands ; * for the stopping criterion , @xmath137 \\leq \\epsilon$ ] , it is necessary to choose a distance measure between @xmath13 and the corresponding approximation @xmath138 .",
    "such a choice , as well as the value of the parameter @xmath135 , is very situation dependent .",
    "one possibility is to calculate the difference between the corresponding histograms .",
    "take note , however , that this method can be troublesome in case of very skewed distributions . in this case",
    "it is advisable to resort to the methods of pdf estimation that do not make use of binning of the data as , for example , the kernel and the johnson empirical distributions methods @xcite .    some conveniences concerning the algorithm :    * in case of isotropic random fields ,",
    "it is possible to work with an one - dimensional correlation function @xmath145 ; * once the coefficients @xmath146 of the expansion have been determined , these can be used for simulating an unlimited number of random fields @xmath0 ; * the algorithm works also in case of very skewed distributions ( see figure [ fig : hermite ] ) .",
    "one inconvenience in using this algorithm is that @xmath13 is only approximated and in particular situations this fact can be troublesome .",
    "for example , in case of strictly positive random fields @xmath0 , it could happen that @xmath147 presents some negative values .",
    "however , if the approximation is good enough ( e.g. only a few values violate the constraints ) , the solution to this kind of problem can be very simple ( es . the reflection of the negative values to positive values ) .",
    "figure [ fig : code1 ] shows the subroutine _ field_idf _ implementing an algorithm based on an idea by @xcite .",
    "the rationale behind this code is simple and is based on an iterative procedure . as explained in section [ sec : notes ] , the mapping ( [ eq : map1 ] ) deforms @xmath148 , and consequentely the corresponding power spectrum @xmath149 , in a complex way .",
    "however , if one applies the transformation ( [ eq : map1 ] ) to an initial @xmath150 , characterized by a power spectrum @xmath151 set equal to the target @xmath152 , it is possible to recover information on the relationship between @xmath151 and @xmath152 from the power spectrum @xmath153 of @xmath154 . a new gaussian field @xmath155 , characterized by a power spectrum @xmath156 , is then built with the aim that , after mapping ( [ eq : map1 ] ) , @xmath157 is closer to @xmath152 than @xmath153 .",
    "this operation is carried out at line @xmath158 of the code where the power spectrum of @xmath159 is assumed to be given by @xmath160 with @xmath161 through this step , @xmath162 is modified according to the fractional difference , @xmath163 , between @xmath152 and @xmath164 .",
    "the entire procedure can be repeated @xmath165 times until that @xmath166 is a good approximation of @xmath167 .",
    "the code presented in figure [ fig : code1 ] has been modified with respect to the original version of yamazaki & shinozuka .",
    "the main difference referes to the implementation of steps @xmath168 , @xmath169-@xmath170 , @xmath171-@xmath172 .",
    "the task of these steps is to constrain the range of the permitted values for @xmath163 .",
    "indeed , strictly speaking , the use of such a factor is correct only within the hypothesis that the map ( [ eq : map1 ] ) is linear .",
    "the consequence is that in many situations @xmath163 appears as a highly oscillating function with large extremes even in cases where the target @xmath152 , and therefore the starting @xmath173 , is a smooth function .",
    "because of this fact , in general the algorithm of yamazaki & shinozuka converges only with moderately non - gaussian fields .",
    "our modification is based on the idea that , although some values of @xmath163 could be too large , they are still able to provide indications concerning the direction of the corrections to make in @xmath162 , via equation ( [ eq : siter ] ) , for improving the results of the iterative process . that suggests the following procedure :    1 .",
    "once @xmath163 was computed , the subset @xmath174 of the indices @xmath175 has to be identified for which @xmath176 is larger than a threshold @xmath177 , where @xmath178 is an appropriate value ; 2 .   set @xmath179 . in this way",
    ", it is possible to obtain a smoothed version of @xmath163 that maintains the original information on the direction of the correction for each frequency @xmath175 ; 3 .   if after this operation it happens that @xmath180 \\geq { \\rm dist}[s_r^{(i-1)}({{\\bf k}}),s_r({{\\bf k}})]$ ] , where @xmath181 $ ] indicates a distance measure between the two arguments , it is necessary to rescale the parameter @xmath178 according to a prescribed schedule .",
    "this point makes it possible to avoid troublesome oscillations of the algorithm .    from our simulations",
    ", it appears that after these modifications the algorithm converges also in situations where the original method fails .",
    "some notes on the use of the subroutine _ field_idf _ :    * the first two input quantities are the phase angles , @xmath182 , and the power spectrum , @xmath183 , of a zero - mean , unit - variance , and gaussian random field . here , the important point is that @xmath184 is set equal to the target @xmath152 .",
    "+ the third input quantity is the initial value , @xmath185 , of the parameter @xmath178 .",
    "typically , @xmath186-@xmath187 , but such a choice is not so critical for the final results . + for the fourth input quantity , @xmath135 , see below ; * in the stopping criterion ,",
    "@xmath137 \\leq \\epsilon$ ] , any measure of distance can be used between @xmath164 and @xmath152 .",
    "an interesting suggestion comes from @xcite that in their work use the quantity @xmath188= \\frac{\\sum_{{{\\bf k } } } \\vert s_r^{(i)}({{\\bf k } } ) - s_r({{\\bf k } } ) \\vert}{\\sum_{{{\\bf k } } } s_r^{(i)}({{\\bf k}})}.\\ ] ] typical value for @xmath135 are of order of @xmath189-@xmath190 ; * the scaling , @xmath191 $ ] , of the parameter @xmath178 can follow any schedule . in our simulations",
    "we have halved the value whenever required by the convergence check .    in the context of the astronomical applications ,",
    "some limitations concerning the algorithm are :    * the target power spectrum @xmath152 must be a smooth function .",
    "that means to work with the expected power spectra of the fields ( nb . in certain engineering applications",
    "this is a demanded point ) .",
    "such requirement is due to the fact that the generation of @xmath0 , according to the procedure implemented in the algorithm of figure [ fig : code1 ] , in practice constitutes an optimization problem .",
    "since the rougher a function , the larger is the corresponding number of degrees of freedom that must be accounted for by an optimization procedure , a non - smooth @xmath152 will be hardly a solvable problem with the present algorithm ; * although the algorithm is more robust than the original version of yamazaki & shinozuka , it still presents convergence difficulties in case of pdfs very different from the gaussian one ( see figure [ fig : fields_err ] ) .",
    "in particular , the most serious problems concerns very skewed distributions . the reason can be understood from the figures [ fig : gauss_chi]a - d , where the mapping ( [ eq : map1 ] ) is presented for four distributions @xmath192 with @xmath193-@xmath194 .",
    "the first two distributions represent situations that the algorithm is not able to solve , the third one corresponds to a difficult case , whereas the last distribution can be easily handled with .",
    "it is easy to see that the most problematic situations concern the mappings where a large portion of the domain of the gaussian random variable is projected onto an almost constant value .",
    "the reason is that at the _",
    "i_-th iteration of the algorithm , the updated @xmath195 is calculated on + the basis of @xmath196 .",
    "however , although @xmath197 , it can happen that @xmath198 since @xmath199 \\ } \\approx f^{-1}_r",
    "\\ { f_x [ x^{(i-1)}({{\\bf t } } ) ] \\}$ ] . in this case",
    ", the subsequent iterations will be not able to further improve the result .",
    "+ another problem was recently identified by @xcite : after the first iteration the field @xmath196 is no longer strictly gaussian and therefore the mapping ( [ eq : map1 ] ) will not give a @xmath195 with the correct marginal distribution .",
    "these authors provide a modified version of the original algorithm of yamazaki & shinozuka where , after the first iteration , @xmath101 is substituted by an empirical distribution of @xmath196 .",
    "actually , such a method works well also in case of very skewed distributions and/or non - smooth target power spectra .",
    "unfortunately , it is very expensive with respect to computational time which makes its use problematic in practical situations ( e.g. simulation of sizeable random fields ) ; * in the case of homogeneous and isotropic _",
    "n_-dimensional random fields , it is necessary to work in the _ n_-dimensional fourier domain .",
    "furthermore , the entire procedure must be restarted for each new simulation .    in spite of these problems ,",
    "the algorithm described in this section maintains a certain interest since , contrary to other techniques , it can be easily adapted for the simulation of vector - valued random fields @xcite .",
    "in all the methods presented in the previous sections , the mean and the variance of @xmath0 are fixed by @xmath12 . however , without modifying the correlation structure , one can force @xmath0 to have a given mean @xmath200 and a variance @xmath201 by means of the following transformation @xmath202",
    "as already reported in the introduction , the numerical simulation of non - gaussian random fields can be used in understanding many both experimental and theoretical physical problems .",
    "hot topics in astrophysics and cosmology , where the techniques described in this work find quick applications , can be easily identified as :    * the simulation of continuous maps to match the properties of sky backgrounds .",
    "for instance , very deep maps of the extragalactic ir sky from space are plagued by the presence of galactic cirrus emission and at very small scales from source confusion ; * the generation of non - gaussian initials conditions for the _",
    "n_-body simulations ( see figure [ fig : points ] ) .",
    "indeed , these conditions can be obtained by interpreting a non - gaussian random fields as a density field . in reality , such approach is not new .",
    "however , in the past the initials conditions were simulated by using only specific distributions functions as , for example , the lognormal @xcite and the chi - square @xcite ones ; * the reconstruction of the missing parts of experimental maps ( e.g. angular distribution of _ iras _ galaxies ) .",
    "indeed , it is sufficient to transform the non - gaussian field in a gaussian one via the inverse of the mapping ( [ eq : map1 ] ) , to carry out the desired reconstruction through one among the many techniques available for the gaussian case ( e.g. @xcite ) , and then to trasform back the resulting field via the mapping ( [ eq : map1 ] ) .",
    "this techniques is described in detail in @xcite but , again , it is specialized to the lognormal case .",
    "the approach presented in this paper is going to be used to simulate the fir sky as it will be observed by the herschel satellite @xcite . to mock extragalactic catalogues , built on the basis of theoretical modeling of the expected number of fir sources , the emission from `` local '' ( galactic and interplanetary ) backgrounds has to be added , in order to reproduce realistic observing conditions ( @xcite and @xcite ) . here , as an example , the reproduction of a typical galactic background , starting from an observed sky region , is briefly outlined .",
    "figure [ fig : simula]a shows a sky map , observed by the isophot camera @xcite on board of the iso satellite @xcite at 175@xmath203 m , with a projected size of roughly @xmath204 @xcite .",
    "the histogram of its values ( see figure [ fig : simula]b ) shows that the reproduction of such map requires the use of non - gaussian techniques . in particular , we have choosen the `` change of variable method '' with the following adjustments :    * the pdf of the pixel values of the original image is estimated via the johnson parametric method ( for details see @xcite ) .",
    "with such an approach it is possible to build the mapping ( [ eq : map1 ] ) , as well as its inverse , in closed form .",
    "that results in a much less expensive numerical cost than in case of the use of the more popular histogram ( see figure [ fig : simula]b ) ; * to infer the correlation function @xmath34 , necessary for the numerical generation of the gaussian random field we prefer not to invert equation ( [ eq : change ] ) .",
    "instead , we choose a set of forty - one equidistant values for @xmath106 in the range @xmath205 $ ] , to determine the corresponding values of @xmath107 via the numerical integration of equation ( [ eq : change ] ) , and then interpolate the resulting points via a cubic - spline . in this way , again , a lot of computational effort is saved .",
    "the result is shown in figure [ fig : simula]c .",
    "one of the possible simulations of the original map is shown in figure [ fig : simula]d .",
    "in this paper we have considered numerical simulation of non - gaussian , scalar random fields @xmath0 , with prescribed correlation structure @xmath145 and one - dimensional marginal probability distribution @xmath108 , based on the transformation @xmath206 of a gaussian random field @xmath33 . in general , the definition of a function @xmath42 , able to map the standard random gaussian variable @xmath41 in a random variable @xmath11 with the required @xmath108 , is not a difficult task .",
    "problems are found when the simulated fields _ has _ to have a desired correlation structure , since in general @xmath207 .",
    "the determination of the appropriate @xmath34 is achieved using various techniques .",
    "the most effective method is that providing a closed relationship between @xmath34 and @xmath32 .",
    "unfortunately , this approach can be followed only in a very limited number of cases .",
    "therefore , in the practical applications , very often it is necessary to resort to numerical techniques .    here ,",
    "we have presented three approaches : the `` change of variable method '' , the `` hermite expansion method '' and the  method of yamazaki & shinozuka \" .",
    "whenever possible , the first one has to be adopted since , contrary to the other two , it is able to provide exact results .",
    "the only limitation concerning this method is that typically it requires the calculation of a large number of double integrals . in certain sitations that could be computationally too expensive . in this case",
    ", it is more convenient to use the `` hermite expansion method '' since more robust and versatile than the  method of yamazaki & shinozuka \" .",
    "this last method maintains a certain interest since it can be easily generalized for the numerical generation of vector - random fields .",
    "the authors warmly thank george deodatis , sabino matarrese and radu popescu for helpful discussions on the algorithms presented in this work .",
    "p.a . acknowledges support from the alexander von humboldt stiftung and thanks the ir - group of the max - planck institut fr extraterrestrische physik for hospitality .",
    "this work was partially financed by the italian space agency ( asi ) under contract ars-98 - 226 .",
    "andreani , p. , lutz , d. , poglitsch , a. , & genzel , r. , 2000 , in the proceedings of the  the promise of first ",
    "symposium , esa special publication ( esa sp-460 ) .",
    "editors g.l .",
    "pilbratt , j. cernicharo , a.m. heras , t. prusti andreani , p. , et al .",
    "2001 , in preparation blinnikov , s. , & moessner , r. 1998 , , 130 , 193 coles , p. , & jones , b. 1991 , , 248 , 1 colombi , s. 1994 , , 435 , 536 contaldi , c.r . , & magueijo , j. 2001 , _ submitted _ ( astro - ph/0101512 ) declercq , d. 1998 , ph.d .",
    "thesis , univ .",
    "cergy - pontoise ( downloadable from www.etis.ensea.fr/~declercq/research.html ) deodatis , g. , & micaletti , r.c .",
    "2000 , _ submitted _ dole , h. , et al .",
    "2001 , , in press , ( astro - ph/0103434 ) grad , h. 1949 , communications in pure and applied mathematics , 2 , 325 grigoriu , m. 1995 , applied non - gaussian processes ( new york : prentice hall ) grigoriu , m. 1998 , journal of engineering mechanics , 124 , 121 hasofer , a.m , ditlevsen , o. , & tarp - johansen , n.j .",
    "1998 , proceedings of icossar97 , kyoto , november 1997 ( rotterdam : balkema ) ( downloadable from www.bkm.dtu.dk/ ~od / papers.phtml ) herbstmeier , u. 1998 , , 332 , 739 kessler , m.f . , et al .",
    "1996 , , 315 , l27 lemke , d. , klaas , u. , & abolins , j. 1996 , , 315 , l64 matarrese , s. , verde , l. , & jimenez , r. 2000 , , 541 , 10 moscardini , l. , matarrese , s. , lucchin , f. , & messina , a. 1991 , , 248 , 424 ogorodnikov , v.a .",
    ", & prigarin , s.m .",
    "1996 , numerical modelling of random processes and fields : algorithms and applications ( utrecht : vsp ) papoulis , a. 1991 , probability , random variables , and stochastic processes ( new york : mcgraw - hill ) pilbratt , g. 2001 , _ the first esa cornerstone mission _ , in the extragalactic infrared background and its cosmological implications , august 2000 manchester , eds .",
    "m. harwit & m.g .",
    "hauser , iau symp .",
    "204 , in press popescu , r. , deodatis , g. , & prevost , h. 1998 , prob .",
    ", 13 , 1 sakamoto , s. , & ghanem , r. 1999 , proceedings of the 13th asce engineering mechanics , the john hopkins university , baltimore , md , june 13 - 16 ( downloadable from rongo.ce.jhu.edu/emd99/sessions/sessions/allsessions.htm ) rybicki , g.b .",
    ", & press , w.h .",
    "1992 , , 398 , 169 scoccimarro , r. 2000 , , 542 , 1 sheth , r.k .",
    "1995 , , 277 , 933 slepian , d. 1972 , siam j. math .",
    ", 3 , 606 vanmarke , e. 1984 , random fields : analysis and synthesis ( cambridge : the mit press ) verde , l. , wang , l. , heavens , a.f . , & kamionkowski , m. 2001 , , 313 , 141 vio , r. , fasano , g. , lazzarin , m. , & lessi , o. 1994 , , 289 , 640 yamazaki , f. , & shinozuka , m. 1988 , journal of engineering mechanics , 114 , 1183"
  ],
  "abstract_text": [
    "<S> in this paper we will consider the problem of the numerical simulation of non - gaussian , scalar random fields with a prescribed correlation structure provided either by a theoretical model or computed on a set of observational data . </S>",
    "<S> although , the numerical generation of a generic , non - gaussian random field is a trivial operation , the task becomes tough when constraining the field with a prefixed correlation structure . at this </S>",
    "<S> regards , three numerical methods , useful for astronomical applications , are presented . the limits and capabilities of each method </S>",
    "<S> are discussed and the pseudo - codes describing the numerical implementation are provided for two of them . </S>"
  ]
}