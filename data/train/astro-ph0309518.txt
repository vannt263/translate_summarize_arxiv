{
  "article_text": [
    "the broad , skewed emission line around 6.4 kev observed in the seyfert 1 galaxy mcg6 - 30 - 15 was first resolved with asca @xcite . a widely accepted model for the production of this line is one where hard x - rays are reprocessed by the innermost regions of a cold , thin accretion disc around a super - massive black hole .",
    "x - ray photons emitted from this material suffer large gravitational redshifts , special relativistic beaming and doppler shifts , combining to give a characteristic shape which is in good agreement with the data .",
    "in addition , a number of alternative models were considered by @xcite , but a convincing rival candidate was not found .",
    "the extended red wing of this line @xcite has provided the first direct observational probes of the strong gravity environment near a black hole and has been used to constrain parameters such as the inclination of the accretion disc and the black hole s",
    "spin @xcite .",
    "the geometry of the illuminating source of hard x - rays , or corona , is a critical variable in such calculations , as illustrated by the work of @xcite , where the authors assumed that the x - ray source was planar , hugging a disc which extended down to the innermost stable circular orbit in the kerr metric . within this framework",
    ", they showed that the line profile obtained during a 4 day asca observation of mcg6 - 30 - 15 in 1994 constrained the spin parameter of the black hole to be @xmath1 with about @xmath2 confidence .",
    "the central regions of an accretion disc are , however , likely to be subject to a large number of magnetohydrodynamical instabilities with the result that a planar geometry for the hard x - ray source is a poor approximation .",
    "an alternative approach was taken by @xcite .",
    "they were able to fit the same data by assuming a schwarzschild black hole where the x - ray source was a point - like flare located a few gravitational radii above the hole on the symmetry axis of the disc .",
    "the bulk of the emitted radiation would then come from material on plunge trajectories within the innermost stable orbit radius . shortly afterwards",
    ", @xcite showed that a geometry of this type predicts a large absorption edge in the spectrum , due to the line emitting matter being highly ionised .",
    "as no such edge has been observed , the data seem to favour the kerr model , although tentatively .    of particular interest for the future",
    "are time - dependent scenarios , where a flash of radiation sweeps over the disc producing line emission in different locations and causes the line shape to change with time @xcite .",
    "future x - ray satellites such as _ constellation - x _ offer the possibility of observing these time - dependent spectra , or reverberation maps @xcite .",
    "however , analyses of such data depend on the coronal flaring pattern , and most previous work has concentrated on predicting the spectra which result from one or two dominant flaring events in the corona .",
    "a more likely scenario , however , is one where the line profiles in reverberation maps result from an ensemble of overlapping flares , distributed in time as well as space , and so a treatment of more complicated coronal configurations such as these is vital .",
    "here we aim to develop a technique for acquiring knowledge of this pattern from spectral data , constraining the distribution of flares in the corona based on the shape of a spectral line .",
    "we consider an ensemble of coronal flares of arbitrary number , instead of assuming that a single flare dominates the emission .",
    "in general , models are commonly fitted to data via the @xmath3 statistic , the best fit parameters corresponding to the minimum of a gaussian distribution . with noisy data",
    "this can result in over - fitting where many different parameter values produce a similarly good fit to the data . in this case",
    "some form of regularisation is often applied , such as the maximum entropy method @xcite .",
    "this amounts to making some extra basic assumptions about the object one is trying to infer , in order to pick out a preferred model from a group which are not distinguished by the data alone .",
    "the exact physics of a magnetically flaring corona is complicated , and so rather than trying to treat it directly , we can make some progress by making some very general , minimal assumptions about its nature .",
    "given the idea that individual x - ray flares provide the illumination for the production of the iron line , we attempt to infer the parameters of a set of discrete , point - like sources , which are equally likely to be found at any point over the disc .",
    "we assume that the number of these sources is poisson distributed , so that if the data can be satisfied with a lower number of flares then it will .",
    "finally , we assume an exponentially decaying distribution for the strengths of these sources , so that stronger flares are not favoured in the reconstruction .",
    "this set of assumptions corresponds to a technique known as ` massive inference ' @xcite and is quite general .",
    "it can be applied to any situation which can be modelled as arising from a number of point source like objects , however abstract their physical interpretation might be .    in this paper",
    "we begin by introducing the massive inference technique and its numerical implementation , in sections  [ sec : mass - infer - prior ] and [ sec : computational - method ] . in section  [ sec : line - prof - calc ]",
    "we then discuss the physical details of our model for the forward problem , that of predicting the iron line shape as a function of the coronal geometry and other system parameters . after describing the calculation with which we compute the line profile due to a single flare we proceed to discuss how these lines can be combined to yield a transfer function which maps the parameters of interest to a composite line profile , in section  [ sec : transfer - functions ] .",
    "we then show some examples of the technique s application to simulated data : to reverberation maps in section  [ sec : time - depend - invers ] and time - averaged spectral lines in section  [ sec : time - indep - invers ] .",
    "the transfer function for the latter case is analysed in section  [ sec : linear - dependence ] before treating data from an _ xmm - newton _ observation of mcg6 - 30 - 15 in section  [ sec : application - xmm - data ] . finally , in section  [ sec :",
    "conclusion ] we give our conclusions and discuss the application of our technique to possible future data .",
    "it is standard practice in scientific data analysis to fit the parameters of a model to a dataset using a @xmath3 minimisation .",
    "often , especially at high levels of noise , a unique minimum is not clearly preferred by the data and there is ambiguity between different sets of parameters .",
    "we can still progress in a such a problem though , by making extra assumptions about the parameters , which are believed to hold independently of the data .",
    "these are encoded in a ` prior ' probability distribution , which modifies the previous gaussian distribution to one where a clearly defined minimum exists , and so a ` best ' answer can be found , although it is of course still dependent upon the validity of the extra assumptions .",
    "a well known example of this idea is the ` maximum entropy method ' @xcite , which has been used extensively in many areas of physics and astronomy , most notably in image processing . here ,",
    "the parameters are the fluxes collected in a set of pixels . by assuming that the fluxes are all positive and additive , one arrives at the conclusion that the image , in the absence of any data , has a prior probability distribution given by @xmath4 where @xmath5 is the entropy defined as @xmath6 and where @xmath7 is the number of pixels in the image , @xmath8 ( the @xmath9 element of the vector @xmath10 ) is the flux in the @xmath11th pixel and the @xmath12 represent our ` best guess ' at the answer in the absence of any data  often a uniform distribution .",
    "@xmath13 represents the weight we wish to give the maximum entropy assumption relative to the data .",
    "maximising the entropy essentially corresponds to imposing the least possible prejudice on the image , and the best image is the one which strikes the optimum compromise between satisfying the data , by minimising the @xmath3 statistic , and maximising the entropy .    in this work , instead of using a maximum entropy prior , we instead follow the ` massive inference ' route , which can be expected to be particularly appropriate to the case of a small number of point - like sources . to provide a rigorous framework in which we can combine our prior assumptions with line profile data",
    ", we use a precise statement of conditional probability  bayes theorem . according to bayes theorem ,",
    "a hypothesis @xmath10 given some data @xmath14 has a _ posterior _ probability distribution @xmath15 given by the product of the _ likelihood _ @xmath16 and the _ prior _ @xmath17 normalised by the _ evidence _ @xmath18 @xmath19",
    "we assume gaussian random errors , so that the likelihood takes the form @xmath20_{i } \\",
    ", \\hbox{\\bf \\em h}_{ii } \\ , [ { \\hbox{\\bf \\em d}}-{\\mathcal{r}}({\\hbox{\\bf \\em h}})]_i,\\end{aligned}\\ ] ] where @xmath21 is the number of data points in the vector @xmath14 and the covariance matrix @xmath22 is diagonal because the errors are independent . in this work ,",
    "the hypothesis @xmath10 is comprised of the number , strengths and locations of a group of x - ray flares , and the data @xmath14 are the iron line x - ray fluxes received in each energy bin around @xmath23 kev .",
    "@xmath24 is the transfer function which provides a map from the parameter space to the data , so that @xmath25 are the ( noiseless ) ` mock data ' corresponding to a set of parameters @xmath10 .",
    "the prior probability @xmath26 $ ] consists of the product of three separate priors for each of @xmath7 ( the number of flares ) , @xmath27 ( an @xmath7 element vector of flare positions ) and @xmath28 ( an @xmath7 element vector of flare strengths ) .",
    "@xmath7 is assigned either a poisson distribution @xmath29 with mean @xmath0 , or a wider , geometric distribution @xmath30 depending on how accurately the mean number of flares @xmath0 can be estimated @xcite . in practice",
    "we always use the latter , with an additional , exponentially decaying prior on @xmath0 itself .",
    "the flare positions are assigned a prior which is constant over the allowed locations ( in practice covering the central regions of the accretion disk ) and zero otherwise .",
    "their strengths an exponentially decaying distribution @xmath31 where the decay constants @xmath32 are chosen internally based on the overall scale of the data , and so do not feature in the analysis .",
    "this form avoids extremely strong flares being favoured in the posterior .",
    "the full posterior probability distribution can then be written @xmath33_{i } \\",
    ", \\hbox{\\bf \\em h}_{ii } \\ , [ { \\hbox{\\bf \\em d}}-{\\mathcal{r}}({\\hbox{\\bf \\em h}})]_i \\ ] ]    finding the value of @xmath10 which maximises this distribution will give the ` best ' set of parameters for a given dataset .",
    "this , however , is only a fraction of the total amount of information contained in the answer . in this work",
    "we gain a knowledge of the full posterior distribution by sampling with a simulated annealing algorithm @xcite described in more detail in section  [ sec : computational - method ] .",
    "we can then calculate any moment of the distribution , such as the mean and standard deviation , rather than just finding the best - fitting model .    as mentioned above",
    ", this form of posterior is quite general  in this paper , the ` locations ' of the sources are the spacetime coordinates of coronal flaring events , but this need not be the case . the physical interpretation of the parameter space is entirely determined by the form of the transfer function @xmath24 which provides a map from @xmath10 to the data ( without noise ) @xmath34 in section  [ sec : line - prof - calc ] we consider the detailed physics which is included in this object , although the end result of the calculation is simply a linear mapping from the three objects contained in @xmath10 ( ie @xmath7 , @xmath27 and @xmath28 ) to the data @xmath14 .",
    "the ` forward problem ' which we attempt to invert in this paper is that of predicting the shape of the iron k@xmath0 spectral line at 6.4 kev .",
    "we perform explicit ray - tracing in kerr gravity which accounts for all relativistic beaming and doppler shifting effects , using the geodesic equations given in the appendix .",
    "we adopt a ` lamp - post ' geometry , where a point source orbits above an optically thick , geometrically thin accretion disc , consisting of particles on circular , time - like prograde geodesics in the equatorial plane .",
    "its coordinates are @xmath35 in a cylindrical polar system , where @xmath36 and @xmath37 are boyer - lindquist coordinates and @xmath38 and @xmath39 are related to the boyer - lindquist coordinates via @xmath40 , @xmath41 . except where explicitly stated otherwise , the ` radius ' of the source refers to its value of @xmath38 , the distance from the rotation axis of the black hole . as the source",
    "is located above the plane , it is not in free - fall , rather , it remains above the same point on the disc throughout its motion .",
    "the precise details of its trajectory are also given in the appendix .",
    "the disc material orbits with a period given by @xmath42 where , in the first part of this equation we use conventional ( s.i . ) units ( where @xmath43 is dimensionless ) , and in the second part , @xmath44 is measured in units of @xmath45 and @xmath46 in units of @xmath47 .",
    "the disc s inner radius is chosen to be that of the marginally stable orbit and the disc extends outward to @xmath48 .",
    "we set the black hole s angular momentum parameter @xmath49 to 0.998 so that the accretion disc allows emission within @xmath50 @xcite . in all the plots in this paper",
    ", the disc rotates in an anti - clockwise sense .",
    "we assume the source emits isotropically in its rest frame a power - law spectrum with a specific luminosity @xmath51 erg s@xmath52 hz@xmath52 .",
    "in practice we enforce this by choosing the initial directions of the emitted photons such that they each pass through the centre of one pixel of a healpix sphere .",
    "we can then compute the incident flux at any point on the disc , as measured in the rest frame of the disc matter @xcite , to be @xmath53 where @xmath54 is the redshift suffered by a photon arriving at that point and @xmath55 is the frequency as measured by an observer co - moving with the disc . to find the flux that leaves the disc , we use the following semi - analytical approximation for the effect of the photons incident energy and angle on the number emitted as iron k@xmath0 line radiation , which are derived from the monte carlo simulations of the detailed atomic physics occurring in a cold , non - ionised disc @xcite : @xmath56 where @xmath57 and where @xmath58 is measured in kev and @xmath59 is the threshold for triggering fluorescent emission . above @xmath60 kev this approximation breaks down , but there is a negligible contribution from this region to the total flux .",
    "we obtain the following expression for the flux of iron k@xmath0 line photons leaving the disc @xmath61 we assume that the iron line radiation leaves the disc isotropically and is collected in a grid of @xmath62 equal area pixels ( modelling those of a ccd detector ) in an asymptotically flat region of spacetime ( in practice @xmath63 ) , at a location inclined at @xmath64 to the disc , in keeping with appropriate parameters for mcg6 - 30 - 15 . to calculate the change in intensity @xmath65 of radiation on its journey from the disc to the observer we use the liouville invariant ( e.g. misner et al . 1973 )",
    "@xmath66 where the change in frequency is computed for each pixel in the detector by integrating photon trajectories backwards in time until they hit the disc or are lost into the black hole @xcite .",
    "the power collected in one pixel in the finite frequency range @xmath67 is then @xmath68 where we have made the position dependence of the emissivity over the disc explicit and assumed isotropic emission from the disc .",
    "we integrate over the entire solid angle subtended by the disc at the observer by summing the contribution from each pixel . the contribution to the total flux of each photon",
    "is then binned in both energy and arrival time , to build up a time - dependent spectrum .      by following the procedure outlined in the previous section",
    ", we can generate the time - dependent spectrum produced by a single flaring event at a given location in spacetime .",
    "we can now obtain the transfer function @xmath24 which maps the coordinates of an arbitrary number of flaring events to the data @xmath14 .",
    "if the corona itself is optically thin ( so that it has a negligible effect on the iron line emission ) , then we can simply superpose the spectrum coming from each individual flare , accounting for the time delays due to both the different source positions and the different time at which each flare becomes active . in this way",
    ", the transfer function becomes linear , although this is not a requirement for the inversion algorithm to work .    in this work we concentrate on the radial and azimuthal locations of the sources rather than their heights .",
    "rather , we fix the height at a value which corresponds to a characteristic scale height of the corona which in practice is set to 2 or 5@xmath69 , although it would be simple to extend these models to include the heights of the flares as well .",
    "the time lag arising from a difference in the @xmath36 coordinate of the source is handled trivially by simply shifting the total spectrum obtained from a single flare along the time axis by an appropriate amount .",
    "the delays coming from different values of @xmath38 and @xmath37 are handled by finding the earliest time at which photons from a particular source arrive at the observer for each source position .",
    "the entire spectrum is then shifted by this amount in the full transfer function .",
    "figure  [ fig : timedepgf ] shows the resulting spectrum when the transfer function acts on a set of four flares , the coordinates of which are given in the caption .",
    "these spectra show the same qualitative features as those in the work of @xcite , who gave the first examples of such time - dependent spectra .    while the aim of this paper is to present an inversion method for reverberation maps , data of this nature is not yet available .",
    "rather , the best example of a broad iron line to date , seen in mcg6 - 30 - 15 , requires integration times so long that only basic variability analyses are viable @xcite . in this case to get a mean error of @xmath70 , observations of hundreds of kiloseconds have been necessary @xcite . a recent estimate of the mass of mcg6 - 30 - 15 gives an upper limit of @xmath71 @xcite , corresponding to a characteristic time - scale ( @xmath72 ) of 49 seconds .",
    "for radii in the range @xmath73 , equation  [ eq : orbit_times ] implies orbit time - scales of less than one hour , which means that observations made with current telescopes such as _ xmm - newton _ and _ chandra _ span many orbital periods .",
    "this clearly calls for a modification of the technique as stated above , which we can accomplish by integrating over both @xmath36 and @xmath37 to yield a time - averaged spectrum for each radius of a flare , modelled as the ring it sweeps out over time , assuming it persists for an entire orbit . in practice , we can average the emissivity @xmath74 over @xmath75 to obtain an axisymmetric profile and use a single time bin extending over the full duration of flux detection . in this case",
    "we can plot the entire transfer function , as shown in figure  [ fig : ringgf ] .",
    "in reality , of course , we do not expect a perfectly axisymmetric system , due to the turbulent and non - linear nature of the disc and corona . to begin to probe these effects one can imagine an intermediate scenario , where a time - averaged spectrum is obtained over an interval much shorter than the orbit time for a flare , or one where flaring events occur in ` flashes ' which persist for times much less than the orbital period . in this case , we lose all the temporal information in the system but we can retain the azimuthal positions of the sources .",
    "the transfer function then consists of a time - averaged spectrum for each value of the pair @xmath76 taken by a flare . in figure",
    "[ fig : pointgfrad1 ] we show spectra for a source at a small radius @xmath77 , for all values of @xmath75 .",
    "figure  [ fig : pointgfrad25 ] shows the equivalent plot for a larger value of @xmath38 .",
    "averaging the spectra from these graphs over @xmath37 would produce cross - sections of figure  [ fig : ringgf ] at the corresponding radii .",
    "the eventual goal of this work is to construct a framework for determining patterns of coronal flaring activity from iron k@xmath0 line spectra .",
    "we can assess the validity of conclusions drawn within this framework by testing the technique with data generated from a known distribution of flares .",
    "we operate on this distribution ( known as the ` truth ' ) with the transfer function @xmath24 to yield the ` mock data ' @xmath78 . to complete the process",
    "we add a known amount of gaussian noise @xmath79 , to obtain the simulated data @xmath80 .",
    "( 8,3 ) ( 0,2.25)(2,1)1",
    ". choose @xmath81 ( 6,2.25)(2,1)2 .",
    "act with @xmath24 ( 6,0)(2,1)3 . add noise ( 0,0)(2,1)[l]4 . obtain inference ( @xmath10 ) ( 4,2.25)@xmath24 ( 5.7,1.6)@xmath82 noise ( 4.1,0.7)mass . inf .",
    "( 1.3,1.6)compare ( 2.5,2.75)(1,0)3 ( 7,2.4)(0,-1)1.5 ( 5.75,0.5)(-1,0)2 ( 1,1.6)(0,1)0.75 ( 1,1.6)(0,-1)0.75    given these simulated data we can construct an inference @xmath10 via the massive inference method , which can then be compared with the truth @xmath83 .",
    "a graphical summary of this process is shown in figure  [ fig : dataprocess ] .",
    "sampling of the posterior is achieved with a markov chain monte carlo algorithm , using a simulated annealing cooling schedule .",
    "each consecutive sample is chosen according to a ` temperature ' parameter , which is increasingly restrictive in terms of the changes it allows as the system cools .",
    "the samples are initially spread over a large region of parameter space , but as the temperature drops , they become more concentrated around regions of high posterior probability .",
    "the algorithm can store an ensemble of several flare configurations , each evolving independently , and the system is cooled as slowly as computation time allows . in this way , we maximise the number of samples taken and minimise the chance that the samples are trapped within local minima .    there is no formal convergence test for the massive inference method .",
    "rather , one can vary both the rate at which the algorithm anneals and the size of the ensemble of simultaneously evolving parameter sets , and check that they all converge to a single distribution .",
    "a representation of convergence for a simple example involving only two flares is shown in figure  [ fig : convboth ] .",
    "the flares are located at radii of 5 and 13 @xmath84 .",
    "figure  [ fig : conv_chi2 ] shows the misfit between the mock and simulated data as the algorithm progresses from its initial , hot state to the final cool state .",
    "the decrease in temperature is visible as the tapering of the curve s overall envelope of variation , while the convergence is reflected in the approach of @xmath3 ( per degree of freedom ) toward the final value of @xmath85 . in figure",
    "[ fig : conv ] we plot a projection of the sampled posterior into a plane showing the radial coordinate of each flare , together with a contour plot of the true posterior , showing that the samples are indeed concentrated around its peak .",
    "we now present some examples of the application of our technique to simulated reverberation maps , obtained by adding noise to spectra such as that shown in figure  [ fig : timedepgf ] .",
    "we quote noise levels as mean signal - to - noise ratios ( snr ) , the ratio of the noise to the average over all pixels in which the flux is non - zero . for a particular example of simulated data with a mean snr of 1 , which we take as our starting point for illustrating the technique , the inferred number of flares is given in figure  [ fig:7flares - hist ] , where a strong peak is visible at the true number of 7 .",
    "the locations of the flare ensemble above the accretion disc ( their @xmath76 coordinates ) are shown in figure  [ fig:7flares - xy ] , where each sample of the posterior is plotted as a set of @xmath7 grey circles , where @xmath7 is the number of flares corresponding to that particular sample . in reality , the inner 20@xmath69 of the disc are covered by a 20 radii @xmath86 18 azimuths polar grid of flare positions , but to help visualise the results , we have displaced each grey circle in a random direction from the centre of its grid cell by a radius obtained by sampling from a gaussian distribution with a standard deviation equal to the radius of the thicker , black circles , whose centres mark the location of each flare in the true configuration .",
    "the radius of each grey circle is proportional to the strength of the flare for that sample and is normalised such that the strongest flare s radius matches that of the thicker circles marking the truth .",
    "in addition , we plot two circles centred on the origin , which mark the inner radius of the accretion disc and the radius @xmath87 which corresponds to the outer limit of the polar grid , but not the accretion disc itself ( @xmath88 ) .",
    "the samples are clustered around the true positions in all cases but one , showing that the system copes well with a problem of this complexity , at this level of noise in the data .",
    "figure  [ fig:7flares - ty ] shows the inferred distribution of times at which each flaring event occurred , as a projection onto the @xmath89-@xmath90 plane ( the observer is located above the negative @xmath91 axis , nearest the bottom of the plot ) . for the flare closest to the black hole",
    "whose @xmath90-@xmath91 position was least accurately inferred , the samples time coordinates are centred around the true value of 6 @xmath92 .",
    "it is very difficult to pick out 7 distinct spectra by eye in the simulated data shown in figure  [ fig:7flares - data ] , and yet the algorithm is able to do so , and give the locations of the flares with a good degree of accuracy .",
    "we show two more examples in figures  [ fig:11flares ] and [ fig:3flares ] , one for a configuration of 11 flares and a mean snr = 2 , and one for poorer quality data ( snr = 0.5 ) with fewer flares in the truth .",
    "figure  [ fig:11flares-3d ] shows a 3-d representation of the locations in spacetime of the true and inferred distributions of flaring events .",
    "the vertical axis measures time , not the height of the flares , which is fixed at 5@xmath69 .",
    "the light grey samples on the disc and at the side of the plot correspond to the @xmath90-@xmath91 and @xmath89-@xmath90 projections like those shown in figures  [ fig:7flares - xy ] and [ fig:7flares - ty ] for the case of seven flares .",
    "the truth is plotted here as a set of wire - frame cubes with a side length equal to twice the standard deviation of the gaussian distribution from which the amount of radial displacement of each dark grey sample was taken .",
    "the noisy data and a histogram of the inferred number of flares are shown in figures  [ fig:11flares - data ] and [ fig:11flares - hist ] .",
    "it is clear that at least 11 flares were chosen each time in order to fit the data and higher numbers become increasingly unlikely , reflecting the prior probability distribution on @xmath7 .",
    "information from figures  [ fig:11flares-3d ] and [ fig:11flares - hist ] can be combined by plotting the latter in colour . instead of grey circles",
    ", we can use a different colour for each value of @xmath7 in the histogram .",
    "we avoid certain colours being obscured by others plotted over the top by randomising the order in which they are drawn , thus giving a visual impression of the histogram , which can be useful in revealing spatial bias of different values of @xmath7 .",
    "colour versions of all relevant plots in this paper are available onlinerg200 ] .",
    "figure  [ fig:3flares ] shows an inversion performed for data at a higher noise level ( mean snr = 0.5 ) . in both 3-d plots , the thick arrow drawn in the plane of the disc is directed towards the observer .    as the level of noise",
    "is increased , the quality of the inferences decreases  flares begin to be missed or show up in incorrect places .",
    "rather than perform a detailed analysis of the limits of performance of the above time - dependent setup , we now consider those of time - averaged spectra , where we focus on just the @xmath38 and @xmath37 coordinates of the flares .",
    "the reason for this two - fold .",
    "firstly , the behaviour of the system for demanding noise levels in time - averaged data is a scenario more likely to be of interest in the short to medium term , given the quality of current data .",
    "secondly , obtaining the locations of a set of flares in time is a relatively easy problem compared to that of revealing their spatial locations , simply because the structure induced in the data for a single flare at different times is far more distinctive than at different positions .",
    "it was described in section  [ sec : transfer - functions ] that the former is achieved by simply translating the spectrum from one flare along the time axis in the data - space by an amount corresponding to its time - delay , whereas the spectral differences that come from changes in spatial location are far more subtle .",
    "it is therefore clearer to focus on the time - averaged scenarios described in the next section .",
    "we can recast the above system in a form which does not depend on time by summing the spectra over their entire duration , and removing all reference to time from the transfer function . in this way",
    ", we obtain a 2-dimensional problem , where we aim to recover the @xmath38 and @xmath37 coordinates of each source , which take values in the range 1.5  15@xmath69 and 0  360@xmath93 over a grid of 40 radii @xmath86 36 azimuths . in doing this",
    ", we have reduced the number of degrees of freedom ( d.o.f . ) in the data by almost two orders of magnitude , and as a result we readily find noise levels at which the system struggles to produce correct inferences .",
    "+    figure  [ fig : point3flares - samples ] shows the set of samples of the posterior probability distribution for an inference based on the data of figure  [ fig : point3flares - data ] .",
    "the true distribution contains three flares at the locations shown by the thick black circles in figure  [ fig : point3flares - samples ] .",
    "in addition to being spread out over many cells of the polar grid of different @xmath76 values , the inference is also clustered around a region above the rear , receding part of the disc , in which there is no flare in the truth .",
    "the mock data do provide a satisfactory fit to the simulated data , however , which implies that , at this level of noise , we are probing degenerate regions of the transfer function .",
    "we note further that the samples of @xmath7 shown in figure  [ fig : point3flares - hist ] peak very strongly at the true number of three , so that the extra cluster of samples in figure  [ fig : point3flares - samples ] does not imply the presence of a fourth flare , rather an additional possibility for the location of one of the three .",
    "+    we can quantify the linear - dependence present in the transfer function by performing a singular value decomposition , yielding the singular values marked by the squares in figure  [ fig : svals ] .",
    "the gradient of this line determines the decrease in noise that is necessary , on average , in order to detect the presence of extra flares as they are added into the true distribution .",
    "the ` flare - space ' singular vectors ( in the space of all possible flare configurations ) always form a linearly - independent basis , with which we can represent any flare pattern . however",
    ", their relative magnitudes are given by the singular values , which means that for a given finite noise level , a certain ( large ) fraction are effectively zero , removing this ability to span flare - space and represent an arbitrary pattern .",
    "degenerate regions arise when the projection of some of a particular flare pattern lies in these zero directions and fails to result in detectable features in the data .",
    "a useful measure of the overall effect of this is shown in figure  [ fig : totsvec ] , where we have summed each singular vector , weighted by the singular values , and projected the result onto the polar grid covering the inner regions of the accretions disc .",
    "a grey circle is drawn at the centre of each grid cell , whose shading gives the overlap of the average singular vector with the cell .",
    "the radii of the circles increase linearly with radius to provide a suitable covering of the disc , for ease of visualisation only .",
    "the plot reveals those cells which , on average , produce the same type of structure in the data and which require higher levels of noise to distinguish between them .",
    "this explains the patterns seen in the inferred flare locations shown in figure  [ fig : point3flares - samples ] as the algorithm explores the contours of figure  [ fig : totsvec ] with approximately equal frequency , in its search to fit the data .",
    "this plot also reveals the effective spatial resolution of the technique , as a function of position on the disc .",
    "two adjacent flares placed in cells corresponding to a high gradient in figure  [ fig : totsvec ] will be easier to resolve than two placed in a region where the gradient is small .    as described in section  [ sec : transfer - functions ] , we can reduce the level of complexity in the transfer function still further by calculating the time - averaged spectra which arise from axisymmetric distributions of emissivity due to ` ring - shaped ' flares , modelling time - averaged point - like flares which persist over an entire orbit or more .",
    "we generate these axisymmetric emissivity profiles by averaging the illumination pattern due to a single flare over all values of @xmath37 , resulting in a 1-d problem where we attempt to recover just the radius @xmath38 of the ring .    performing this procedure results in a transfer function whose singular values",
    "are given by the circles in figure  [ fig : svals ] .",
    "they drop much more quickly than for the 2-d version , giving a difference of one order of magnitude for just 5 flares .",
    "this trend is reflected in the picture of the 1-d transfer function shown in figure  [ fig : ringgf ] , where the line profile shows only modest variation as a function of radius . to illustrate the difficulty in performing inference calculations with this system",
    ", we show the results of many such calculations for a wide range of noise , in figure  [ fig : ring3flares ] , where we plot the mean strength of the samples in each radial bin . at high noise levels ( snr @xmath94 1 )",
    "none of the three flares present in the truth was located in the inference . for noise levels comparable to the 2-d calculation of figure  [ fig : point3flares ] ,",
    "the innermost flare was detected , but it required a further drop of about a factor of 10 in noise before all three flares could be detected .",
    "we now apply the technique to the results of a 325 ks observation of mcg6 - 30 - 15 made with _ xmm - newton _ , described fully in @xcite .",
    "we take the spectral line to be the difference between their model 4 for the underlying continuum , and the data .",
    "the average noise level is approximately 15% , which corresponds to a mean snr @xmath94 7 .",
    "given the results of figure  [ fig : ring3flares ] , it seems highly doubtful that any meaningful inferences can be made within the 1-d axisymmetric , time - averaged framework at the level of noise .",
    "we choose instead to apply the 2-d system , but with the following large caveat .",
    "recent estimates of the mass of mcg6 - 30 - 15 give values close to @xmath95 giving a characteristic time - scale of 49 seconds , which , as discussed in section  [ sec : transfer - functions ] , corresponds to an orbital period of less than one hour even for a relatively slow flare , orbiting at @xmath96 .",
    "it is clear from these time - scales that we can not hope to attribute structure in the line profile to particular non - axisymmetric features in the results of any inference calculation , although such results may be useful in giving an indication of the general radii at which flares could be active .",
    "in addition , we make no attempt in this work to model the form of the underlying continuum spectrum , and so are completely reliant on such a model to define a given spectral line shape .",
    "models for the continuum , while providing a good overall fit , still allow considerable variation of the slope in the vicinity of the iron line , thus altering the shape",
    ". detailed predictions of flaring activity based on the precise details of this line profile can therefore be easily changed with a different continuum model , and should not be taken as clear evidence of a particular flare distribution .",
    "this paper is intended to demonstrate the type of calculation which will become possible with the advent of high quality , time - dependent spectral data .",
    "the application of our techniques to this _ xmm - newton _ observation is a check , to make sure we obtain a plausible picture from current data which is consistent with previous studies of this object .",
    "figure  [ fig : xmm - samples ] shows the results of applying the 2-d system to these data .",
    "the posterior samples are concentrated in two regions , and the histogram for the number of flares ( not shown ) has a very strong peak at @xmath97 .",
    "the solid line in figure  [ fig : xmm - data ] shows the mock data from this inferred flare pattern , which provides a good fit with the data below @xmath98 kev .",
    "the structure above @xmath99 kev is due to iron k@xmath100 emission @xcite , which we do not include in our transfer function ( although it would be simple to do so ) .",
    "for this reason , we ignore the points above 7 kev when calculating the value of @xmath3 for this fit , which is 0.98 per degree of freedom .",
    "that the flaring regions are contained within a few gravitational radii of the central black hole , which leads to a very steep emissivity profile in this region , is consistent with the existing picture of this object based on previous studies .    whether the precise azimuthal distribution of flares has",
    "a direct physical significance , given the time - scales involved , is doubtful .",
    "however , it is important to assess the uniqueness of this prediction  to what extent would the result change with a different realisation of the noise in the data ? to address this issue , we can perform a further simulation based on the results of figure  [ fig : xmm - samples ] as follows . by taking a truth consisting of the mean flare - strength in each grid cell",
    ", we can generate mock data to which we add an amount of noise corresponding to that in the original data in figure  [ fig : xmm - data ] .",
    "we can then perform repeated applications of the inversion technique for different random seeds in our noise generator .",
    "figure  [ fig : xmm - truth ] shows the results of two such calculations .",
    "the thick circles show the ` truth ' consisting of the results of figure  [ fig : xmm - samples ] , and the grey circles show the samples of the posterior probability . in figure",
    "[ fig : xmm - truth - good ] we obtain very similar results to the original inference , but in figure  [ fig : xmm - truth - bad ] we see some differences .",
    "again , we can interpret this result within the singular vectors of figure  [ fig : totsvec ]  the ` erroneous ' samples are continuously connected along regions of high degeneracy . for this reason , we should interpret the results of figure  [ fig : xmm - samples ] as indicating the presence of flares anywhere within the two regions in figure  [ fig : xmm - truth - bad ] .",
    "figure  [ fig : xmm - truth - data ] shows the noisy data for the two different realisations of noise and the solid and dashed lines are the mock data corresponding to figures  [ fig : xmm - truth - good ] and [ fig : xmm - truth - bad ] respectively .",
    "another way of seeing how similar the two different flaring patterns are , when considered in the context of the singular vectors , is to evaluate the components of the two patterns on the singular vector basis . the solid line in figure  [ fig : svdproj ]",
    "gives the projection of the ` real ' results of figure  [ fig : xmm - samples ] onto the singular vectors , and the circles and dotted line correspond to those for figures  [ fig : xmm - truth - good ] and [ fig : xmm - truth - bad ] respectively .",
    "it is through projections like these that we can assess the true similarity of structure in the data that different patterns of flaring activity can produce .",
    "we have presented a new way of analysing line profile data which constrains the number , positions and strengths of hard x - ray sources in an accretion disc s corona .",
    "the method makes use of the ` massive inference ' prior probability distribution which is based on an assumption of discrete , point - like sources .    by applying it to simulated noisy reverberation maps",
    ", we found that the technique performs well , making the most of the rich information content of such data .",
    "the algorithm was able to disentangle the complicated signatures of combinations of flare events , rather than concentrating on scenarios where it can be assumed that one or two dominant flares are responsible for the observed data @xcite .",
    "indeed , if there is only a single large flare present , such a conclusion will be reached by our method .",
    "reverberation mapping of relativistic spectral lines is still some way off , and so we modified our system to treat time - averaged spectra at similar levels of noise to those obtained by current instruments such as _ xmm - newton _ and",
    "_ chandra_. in doing so we lost all the temporal information in the transfer function and reduced the problem to that of inferring the set of radial and azimuthal coordinates of the flares .",
    "the relative information loss in the data , however , was greater than in the parameter space , and the resulting inference problem was more challenging . at realistic levels of noise , we found some ambiguity in the inferred spatial locations of the flare , but less in the inferred number present in the ensemble .",
    "this ambiguity was quantified using a singular value decomposition , which yielded a ` map ' of the disc showing the relative ease with which different regions of the disc could be differentiated , and gave a limit on the spatial resolution of the technique .",
    "we reduced the problem still further , considering data collected on time - scales greater than the orbital period of each flare . in this case",
    "we averaged the illumination pattern of a flare over the azimuthal coordinate @xmath37 to obtain a 1-d transfer function based on ` ring - like ' sources , and attempted to constrain the radii of these rings .",
    "this problem proved to be very difficult , requiring very low levels of noise to obtain useful results .",
    "this very high level of degeneracy in the transfer function is due to the line profile being affected only weakly by the position of the source , the dominant contribution coming from the relativistic effects occurring during the photons subsequent journey from disc to observer .    as a consistency check",
    ", we applied the technique to a recent observation of the iron k@xmath0 line in mcg6 - 30 - 15 made by _ xmm - newton _ over 325 ks .",
    "this long integration time means that , given the mass of the central black hole of @xmath71 , it is not possible to resolve any structure in the data due to non - axisymmetric illumination of the disc , and that the 1-d ring - based transfer function is most appropriate .",
    "however , given the difficulties present in the highly degenerate ring - based system described above , we applied the 2-d time - averaged algorithm to this data , allowing some azimuthal structure in the corona .",
    "we found two regions of flaring activity , one at a radius of @xmath101 on the near side of the disc which is responsible for the bulk of the highly redshifted emission below 5 kev , and one on the approaching side at @xmath102 which is more beamed and produces the tall peak close to 6.4 kev .",
    "further simulations for different realisations of random noise illustrated explicitly that this result must be interpreted with the singular vector map of figure  [ fig : totsvec ] in mind , spreading out the regions occupied by the samples to cover those in figure  [ fig : xmm - truth - bad ] .",
    "this approach showed that , within the assumptions underlying the method ( mainly that different locations of x - ray flares in the strong - gravity region of the central black hole account for structure in the line profile ) , the results of figure  [ fig : xmm - samples ] are quite robust . physically , however , we should not expect to be able to pick out any particular azimuthal region based on a 325 ks observation .",
    "in fact , by including a relatively weak , narrow component in the line in order to account for the tall peak near 6.4 kev , it is possible to achieve a very good fit with the data based on an azimuthally averaged illumination pattern @xcite .",
    "in addition , the uncertainty that comes from defining a spectral line shape relative to a given model for the underlying continuum radiation , means that the above results ( other than the loose condition that the flares are contained within @xmath103 ) can be changed very easily by making different assumptions about the continuum . for these reasons",
    ", we do not claim that the results of figure  [ fig : xmm - samples ] are a meaningful prediction for mcg6 - 30 - 15 , rather , it is reassuring to obtain a pattern contained within a few gravitational radii of the central black hole , and gives an indication of the sort of results which may become viable with higher quality data .",
    "it is with the advent of high - quality , time - dependent spectral data , like that promised by missions such as _ constellation - x _ , that inversion techniques such as those described here offer the possibility of mapping the hard x - ray emission within a few gravitational radii of a black hole .",
    "the authors are grateful to andy fabian for providing the data used in this research .",
    "rg is grateful to steve gull , john skilling and giovanni miniutti for some very useful discussions , and was supported by a pparc studentship .",
    "y. , fabian a.  c. , iwasawa k. , lasenby a.  n. , reynolds c.  s. , 1997 , , 288 , l11",
    "a.  c. , nandra k. , reynolds c.  s. , brandt w.  n. , otani c. , tanaka y. , inoue h. , iwasawa k. , 1995 , , 277 , l11    a.  c. , vaughan s. , 2003 , , 340 , l28",
    "a.  c. , vaughan s. , nandra k. , iwasawa k. , ballantyne d.  r. , lee j.  c. , de rosa a. , turner a. , young a.  j. , 2002 , , 335 , l1    i.  m. , fabian a.  c. , 1991 , , 249 , 352    gull s. , 1989 , developments in maximum entropy data analysis . j.skilling ( ed ) , kluwer academic publishers , dordtrecht    s.  f. , daniell g.  j. , 1978 , , 272 , 686    hestenes d. , 1966 , space - time algebra .",
    "gordon and breach , new york    hestenes d. , sobczyk g. , 1984 , clifford algebra to geometric calculus .",
    "reidel , dordrecht    k. , fabian a.  c. , reynolds c.  s. , nandra k. , otani c. , inoue h. , hayashida k. , brandt w.  n. , dotani t. , kunieda h. , matsuoka m. , tanaka y. , 1996 , , 282 , 1038    k. , fabian a.  c. , young a.  j. , inoue h. , matsumoto c. , 1999 , , 306 , l19",
    "a. , 1991 , , 376 , 90    lasenby a. , doran c. , gull s. , 1998 , phil .",
    ". a , 356 , 487    y. , yu q. , 2001 , , 561 , 660    a. , karas v. , matt g. , 2000 , , 312 , 817    g. , perola g.  c. , piro l. , 1991 , , 247 , 25    g. , fabian a.  c. , goyder r. , lasenby a.  n. , 2003 , , 344 , l22    r. , fabian a.  c. , 2002 , , 329 , 209    c.  s. , begelman m.  c. , 1997 , , 488 , 109    c.  s. , young a.  j. , begelman m.  c. , fabian a.  c. , 1999 , , 514 , 164    d.  c. , iwasawa k. , fabian a.  c. , 2002 , , 333 , 687    skilling j. , 1998 , massive inference and maximum entropy . maximum entropy and bayesian methods , kluwer academic publishers , dordtrecht    skilling j. , 1999 , massinf programmers notes , http://www.maxent.co.uk    y. , nandra k. , fabian a.  c. , inoue h. , otani c. , dotani t. , hayashida k. , iwasawa k. , kii t. , kunieda h. , makino f. , matsuoka m. , 1995 , , 375 , 659    s. , edelson r. , 2001 , , 548 , 694    j. , reynolds c.  s. , begelman m.  c. , reeves j. , molendi s. , staubert r. , kendziorra e. , 2001 , , 328 , l27    a.  j. , reynolds c.  s. , 2000 , , 529 , 101    a.  j. , ross r.  r. , fabian a.  c. , 1998 , , 300 , l11",
    "the gravitational calculations in this paper were performed using geometric algebra , within a new formulation of gravity theory recently developed by @xcite . in this appendix",
    "we translate some of the results of these calculations into conventional notation , but mention only in passing the motivation for casting the problem in this form . for a detailed account of the tools and ideas which lead to these results ,",
    "see @xcite , @xcite and @xcite .",
    "we begin with an orthonormal tetrad with components on the boyer - lindquist coordinate frame given by @xmath104 where @xmath105 we can then parametrise a photon s momentum with the direction - cosines @xmath0 and @xmath100 and the energy parameter @xmath106 as follows @xmath107 this form is based on the ( principal ) null vector @xmath108 , on which we perform two orthogonal rotations by the angles @xmath0 and @xmath100 . in this way",
    ", the vanishing norm of the vector is built into its parametrisation , removing a degree of freedom from the calculation from the outset .",
    "in addition , we obtain a simple picture of the momentum vector in terms of _ rotors _ ( see e.g. @xcite ) .",
    "this form of @xmath109 yields the following first derivatives of the coordinates @xmath110 : @xmath111 substituting @xmath109 into the geodesic equation results in the following expressions for @xmath112 , @xmath113 and @xmath114 : @xmath115\\\\    \\dot{\\alpha } & = &    \\frac{\\phi}{\\rho^3\\cos\\beta}\\bigg[\\sin\\alpha\\bigg(\\frac{1}{2r{\\sqrt{\\delta}}}\\left(\\delta(\\rho^2 - 4r^2)+\\rho^2(r^2-a^2)\\right)-2ra\\sin\\theta\\sin\\beta\\bigg){\\nonumber}\\\\    & & \\phantom{\\frac{\\phi}{\\rho^3\\cos\\beta}[]}\\quad - \\cos\\theta\\cos\\alpha\\sin\\beta\\bigg(2a{\\sqrt{\\delta}}+\\frac{\\sin\\beta}{\\sin\\theta}\\left(2(r^2+a^2)-\\rho^2\\right)\\bigg)\\bigg]\\\\    \\dot{\\beta } & = &    \\frac{\\phi}{\\rho^3}\\bigg[\\cos\\theta\\sin\\alpha\\left(2a{\\sqrt{\\delta}}+    \\frac{\\left(r^2+a^2\\right ) + a^2\\sin^2\\theta}{\\sin\\theta}\\sin\\beta\\right){\\nonumber}\\\\    & & \\phantom{\\frac{\\phi}{\\rho^3}[]}\\quad-\\cos\\alpha\\sin\\beta\\left(\\frac{r\\left(\\delta+a^2\\sin^2\\theta\\right)-m\\left(r^2-a^2\\cos^2\\theta\\right ) } { { \\sqrt{\\delta}}}\\right ) + 2ra\\sin\\theta\\sin\\beta\\bigg]\\end{aligned}\\ ] ] these equations complete a first order set of 7 equations for the coordinates @xmath116 and the parameters @xmath106 , @xmath0 and @xmath100 , which is sufficient to determine photon s trajectory and is numerically very stable .",
    "a further advantage of this approach is that we have not yet made any use of the three conserved killing quantities ; the energy @xmath117 , angular momentum @xmath118 and carter constant @xmath119 . in terms of spacetime position and our three photon momentum parameters ,",
    "they are given by @xmath120 by evaluating these quantities explicitly at various points along a photon trajectory we can test that the integration is proceeding correctly .",
    "we apply the same basic idea to calculate the circular , timelike trajectories in the equatorial plane which model the flow of accreting matter , except now we can use a single parameter @xmath121 , as follows : @xmath122 where the geodesic equations are satisfied by @xmath123 more commonly , these trajectories are written as @xmath124 and the constant of proportionality is obtained by imposing the condition @xmath125 .",
    "the two notations are related via @xmath126 in order to model the motion of a source orbiting with the disk matter , but at a general height @xmath127 above the equatorial plane , we can define a trajectory ( no longer geodesic ) as follows @xmath128 effectively lifting a circular geodesic vertically out of the equatorial plane . the expression for @xmath121 given by equation  ( [ bltanhu ] ) generalises to @xmath129 in order to measure the angle at which a photon leaves the source and hits the disk we must define a co - moving 3-frame attached to @xmath130 ( @xmath131 being a special case where @xmath132 . together with equation  ( [ vpart ] ) , the vectors @xmath133 , @xmath134 and @xmath135 , where @xmath136 form a convenient orthonormal tetrad .",
    "[ lastpage ]"
  ],
  "abstract_text": [
    "<S> the relativistically broadened iron k-@xmath0 line at 6.4 kev observed in the seyfert 1 galaxy mcg6 - 30 - 15 has provided a probe of the strong - gravity environment near a black hole , in particular suggesting that it is rapidly spinning . </S>",
    "<S> an important variable in such analyses is the geometry of the illuminating source . </S>",
    "<S> we present a new technique which constrains this geometry based on the spectral line shape , based on a model of discrete , point - like flaring regions in the x - ray corona . </S>",
    "<S> we apply it to simulated reverberation maps and give examples of successful reconstructions of complex coronal flaring patterns . for time - averaged spectral lines </S>",
    "<S> the problem is highly degenerate , and so its inversion more challenging . </S>",
    "<S> we quantify this degeneracy and give a measure of the spatial accuracy of the method in this case , before checking that it is consistent with the existing picture of mcg6 - 30 - 15 by applying it to recent data from _ xmm - newton_.    [ firstpage ]    accretion discs  black hole physics  </S>",
    "<S> line : profiles  x - rays : general . </S>"
  ]
}