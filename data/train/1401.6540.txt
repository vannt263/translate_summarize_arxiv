{
  "article_text": [
    "quantum error correction ( qec ) is one of the most important tools to reduce the effects of decoherence in quantum systems that process information .",
    "several different protocols have been developed since qec was first introduced @xcite , but particular attention has been given to stabilizer codes @xcite . among them ,",
    "the surface code @xcite is perhaps the most promising for large - scale implementations @xcite .",
    "its main virtues are : ( i ) qubits are disposed in a planar array , only requiring local measurement operations ; and ( ii ) early estimates based on stochastic error models indicated a very large threshold value , @xmath0 @xcite , for the single - qubit error probability @xmath1 . for @xmath2 , the probability of successful encoding tends to 1 as the number of physical qubits is increased .    despite the large theoretical effort that has been devoted to characterizing the threshold of the surface code @xcite",
    ", the true nature of the transition has been hard to assess due to the large hilbert space that the code demands .",
    "some criticism has also been raised by the use of simplified error models in these studies , since , for more traditional qec schemes , error models that take into account correlations can substantially alter or even remove error thresholds @xcite . in this paper",
    "we make significant progress on both issues .",
    "we consider more general bit - flip error models with and without disorder and correlations .",
    "we derive an exact mapping of a complete qec quantum evolution with arbitrary syndrome onto a two - dimensional ising model with complex temperature .",
    "exact results are then obtained for what we call the `` one - cycle threshold '' .",
    "our main conclusion is a positive one : a fidelity threshold exists in most cases , although its value is not universal , depending on the noise model . for a representative case , the analytical prediction for the threshold location based on the mapping",
    "is supported by monte carlo simulations .",
    "the remaining of the paper is organized as follows . in sec .",
    "[ sec : threshold ] we discuss the difference between intrinsic and effective thresholds , which is crucial for the understanding of our results .",
    "the next two sections are mainly a review : sec .",
    "[ sec : surfacecode ] contains a concise description of the surface code and sec .",
    "[ sec : evolution ] describes the code s evolution , syndrome extraction , and error correction within one cycle in very general terms .",
    "the description of our work begins in sec .",
    "[ sec : fidelity ] , where some basic assumptions and definitions are provided and a suitable expression for the fidelity is presented .",
    "this is followed by a discussion in sec .",
    "[ sec : decoding ] of decoding and the thermodynamic limit in the determination of the threshold .",
    "a realistic error model that induces bit - flip errors is introduced in sec .",
    "[ sec : errormodel ] and consists of an effective action involving single - qubit and two - qubit interaction terms . using this error model and considering the full quantum evolution of the physical qubits , in sec .",
    "[ sec : mapping ] we map the fidelity calculation after one qec cycle onto the evaluation of correlation functions of a two - dimensional ising model . in sec .",
    "[ sec : cases ] we discuss several scenarios based on that mapping , including cases with homogeneous and inhomogeneous couplings . in sec .",
    "[ sec : numerics ] we present the result of monte carlo simulations of the fidelity threshold and confirm the analytical prediction based on the mapping for the homogeneous coupling case .",
    "conclusions are provided in sec .",
    "[ sec : conclusions ]",
    "two qec strategies can be used for any stabilizer code . in the so - called active",
    "qec , stabilizer operators are measured and , based on their syndromes , a recovery operation is chosen and implemented . in passive qec ,",
    "the physical qubits are subjected to a hamiltonian that enforces an energy gap between the code word subspace and the rest of the hilbert space of the physical qubits . typically , the hamiltonian consists of a sum over all stabilizer operators multiplied by a negative constant .",
    "protection in this case requires neither measurements nor recovery operations .",
    "while the surface code is an example of active qec , the toric code @xcite is its passive counterpart .",
    "now , consider adding to the toric code a perturbation ( e.g. , the environmental noise ) that acts directly on the physical qubits and competes with the code s intrinsic hamiltonian .",
    "several authors have shown that beyond a certain critical value of the perturbation s coupling constant , the toric hamiltonian is no longer capable of protecting the code word subspace ; topological order is completely lost and so is the spectral gap separating the ground state subspace from the excited states @xcite . in this context , it is clear that the critical value of the coupling constant provides an intrinsic threshold : any perturbation larger than the threshold renders the code completely ineffective even when the code distance is increased .",
    "it is natural to assume that different types of perturbations will have distinct thresholds .    in this paper",
    "we extend the concept of intrinsic thresholds to active qec . while for passive qec the intrinsic threshold due to environmental noise reveals itself as a clear - cut quantum phase transition , in active qec the situation is a more subtle because the outcome of the qec cycle depends on the syndromes , their decoding , and the recovery operation .",
    "thus , it is natural to look for the intrinsic threshold in the most favorable situation , one that is not affected by a particular decoding strategy for codes .",
    "this happens in the case of a nonerror syndrome , when no recovery operation is recommended .    for any other syndrome",
    ", the threshold must be less favorable because there can be a certain amount of uncertainty as to which recovery operation is more effective .    within this approach , we distinguish two kinds of thresholds :    * an intrinsic one , which depends only on the interaction between the physical qubits and the environment and is independent of any decoding procedure . * an effective one , which depends on the interaction between the physical qubits and the environment and on the decoding procedure .",
    "this distinction is valid for any stabilizer code .",
    "the effective threshold is always equal or smaller than the intrinsic threshold .",
    "the effective threshold can always be increased by improving the decoding procedure until it reaches the intrinsic value .",
    "thus , perfect decoding makes the effective threshold equal to the intrinsic one in the limit when the code distance goes to infinity .    in the context of the surface code",
    ", the existence of an intrinsic threshold has been demonstrated by associating the threshold to a phase transition of a classical statistical spin model with quenched disorder @xcite .",
    "the proof assumes that physical qubits are subjected to independent depolarizing noise sources uncorrelated in time . in this paper",
    "we show that an intrinsic threshold also exists for a noise source where spatial correlations among physical qubits are induced by their interaction with a common environment . the threshold in this case",
    "is associated to a finite - temperature phase transition of a two - dimensional ising model , with the coupling constant between physical qubits and the environment playing the role of the inverse temperature of the model .",
    "in a qec stabilizer protocol , information is encoded into a much larger hilbert space than the minimum space physically required .",
    "different sectors of this large hilbert space are labeled by different values of observables associated to operators known as stabilizer . a judicial choice for the stabilizers",
    "can then be used to diagnose the most common type of error for a given quantum evolution .",
    "based on the outcomes ( syndromes ) of measurements of stabilizer operators , a forceful return to the logical hilbert space is performed .    ) and stars ( @xmath3 ) .",
    "the product of single - qubit operators along the dashed - dotted lines @xmath4 ( vertical ) and @xmath5 ( horizontal ) define the logical operators @xmath6 and @xmath7 , respectively.,width=226 ]    the surface code consists of a two - dimensional array of qubits placed on the edges of a square lattice , see fig .",
    "[ fig : surfacecode ] .",
    "these physical qubits can be implemented with josephson junctions @xcite , cold atoms @xcite , trapped ions @xcite , rydberg atoms @xcite , or semiconductor quantum dots @xcite .",
    "the stabilizers of the code are the plaquette operators @xmath8 and the star operators @xmath9 where @xmath10 are the pauli operators @xmath11 and @xmath12 of qubit @xmath13 .",
    "the logical operations are defined as strings of physical qubit operations : @xmath14 and @xmath15 where @xmath16 is a path that cuts through the lattice from left to right and @xmath17 is a path that goes from top to bottom @xcite .",
    "finally , the codewords can be written as @xmath18 and @xmath19 where @xmath20 and @xmath21 is the ferromagnet state in the @xmath12 component of the physical qubits . here",
    ", @xmath22 denotes the number of star operators on the lattice and @xmath23 is the total number of physical qubits .",
    "the product @xmath24 is independent of the particular choice of @xmath17 and uniquely defines @xmath25 ( thus , hereafter we will drop the path subscript in the logical operators ) .",
    "the logical space is a two - dimensional hilbert space where all plaquettes and stars , when measured , return the value @xmath26 ; by convention , this set is called the zero charge sector .",
    "all other sets define sectors with nonzero charge and are characterized by the number of @xmath27 syndrome values for the plaquette and star operators .",
    "to make the discussion more concise , and without loss of generality for the case of bit - flip errors , let us assume that the system is initially prepared in the logical state @xmath28 and is not entangled with the environment @xmath29 , @xmath30 the logical qubit and the environment evolve under a unitary evolution operator @xmath31 for a time @xmath32 , @xmath33 since we are assuming only bit - flip errors , stars will remain always with eigenvalue @xmath34 under this evolution . on the other hand",
    ", plaquettes may have eigenvalue @xmath35 .",
    "let us call @xmath36 a set of plaquettes that return a nontrivial syndrome , thus indicating an error .",
    "when the stabilizers are measured , the system s state vector is projected by the operator @xmath37 where @xmath38 is the set of plaquettes with eigenvalue @xmath26 .",
    "the decoding procedure associates to a syndrome a certain recovery operation . in the surface code",
    ", this corresponds to choosing a string @xmath39 made of a product of @xmath40 operators that connect the plaquettes in @xmath41 pairwise or to the boundaries .",
    "this recovery operation results in the unnormalized state vector @xmath42 a small but important simplification can be made : notice that @xmath43 where in the second line the product over plaquettes is unconstrained .",
    "therefore , @xmath44 the presence of the projector @xmath45 on the right - hand side of eq .",
    "( [ eq : psiqec ] ) implies that @xmath46 contains only qubit states with all plaquettes positive , i.e. , it can be represented by a superposition of the two logical states @xmath47 and @xmath48 .",
    "the amplitude of each state depends on the choice of @xmath49 .",
    "a good choice will favor @xmath47 .",
    "even though there is a large number of strings @xmath50 compatible with the syndrome @xmath36 , they can be sorted into two distinct classes related by the logical operator @xmath51 .",
    "the product @xmath52 , implicit in the evolution of the logical qubit in eq .",
    "( [ eq : psiqec ] ) , generates all possible strings within a class .",
    "therefore , the particular choice of @xmath53 to represent a class is irrelevant to the calculation of the fidelity of the code . after choosing a string @xmath39 ,",
    "we can assign @xmath54 to represent the elements of the other class .",
    "thus , if the recovery operation @xmath55 brings the logical qubit state back to @xmath47 , its counterpart @xmath56 takes it to the state @xmath48 .",
    "we can then write the ( unnormalized ) state vector at the end of the qec cycle as @xmath57 [ notice the partial contraction in the expectation values appearing on the right - hand side of eq .",
    "( [ eq : psidecomp ] ) ; environmental degrees of freedom remain non contracted . ] in the case of a bad recovery operation , the roles of @xmath55 and @xmath56 are swapped .",
    "the fact that one can not be completely sure of the efficacy of the recovery operation is the reason why the effective threshold is always equal or smaller than the intrinsic threshold .",
    "the fidelity of the code after one qec cycle with syndrome set @xmath58 is defined as @xmath59 maintaining maximum fidelity at the end of the qec cycle implies @xmath60 while complete loss of fidelity results in @xmath61 .    in the evaluation of the fidelity",
    ", an important simplifying hypothesis can be used .",
    "it is physically reasonable to assume that the environment s excitations can be suppressed by some `` cooling '' mechanism ( e.g. , lowering the temperature , applying a polarizing field , etc ) .",
    "this assumption was previously discussed in refs .",
    "@xcite . assuming this resetting of the environment at the end of the qec cycle , we can rewrite eq .",
    "( [ eq : psidecomp ] ) as @xmath62 and @xmath63 for each syndrome outcome characterized by the set @xmath64 . as a result , after some simple manipulations @xcite , we can write @xmath65 when the couping between the physical qubits and the environment is sufficiently weak , one can expand the evolution operator @xmath31 in terms of strings of operators @xmath66 of increasing length .",
    "each string represents a certain number of bit - flip events , with that number defining the length of the string . looking at eq .",
    "( [ eq : a ] ) , one recognizes that the shortest string in the expansion that gives a nonzero contribution to @xmath67 corresponds exactly to the string of @xmath66 operators in @xmath49 .",
    "therefore , the order of the leading contribution to @xmath67 is equal to the smallest possible length of @xmath49 .",
    "similarly , the leading contribution to @xmath68 has an order equal to the smallest possible length of @xmath69 . therefore , in the weak - coupling limit , whenever @xmath49 is shorther than @xmath70 , one expects @xmath71 . in the strong coupling limit",
    ", on the other hand , any perturbative expansion fails ; in those circumstances , we expect @xmath67 and @xmath72 to have similar magnitudes on a finite lattice .",
    "the dependence of @xmath67 and @xmath72 on the lenghts of @xmath49 and @xmath69 , respectively , give us a hint to the appropriate decoding procedure and thermodynamic limit we need to adopt in order to define a fidelity threshold .",
    "the expression for the fidelity given in eq . ( [ eq : fidelity ] ) is only valid under the assumption that the decoding of the syndromes is flawless , such that @xmath73 . in practice ,",
    "finding a recovery operation @xmath74 that fulfills this inequality for any given syndrome set @xmath64 is a difficult task .",
    "a rich literature exists on decoding algorithms for the surface code ; see , for instance , @xcite and references therein , where a number of strategies have been proposed . here , we do not attempt to improve on the existing strategies .",
    "we offer instead a prescription where the inequality is always satisfied in the limit of infinite code distance ( i.e. , infinite lattice sizes ) . as we argue below , when the inequality holds , the fidelity threshold obtained from from eq .",
    "( [ eq : fidelity ] ) is equal to the intrinsic threshold .",
    "however , since it is not possible to guarantee that the decoding is flawless in practice , at times we will have @xmath75 .",
    "therefore , an effective fidelity threshold that takes into account the possibility of flawed recovery operations should always be smaller than the intrinsic one .",
    "our prescription for enforcing @xmath76 begins by recognizing that the amplitudes @xmath77 and @xmath78 are functions of the lattice size used to encode the logical qubit .",
    "therefore , it is important to define what we call the _ thermodynamic limit_. let us start with a fixed and finite set @xmath64 containing an even number of plaquettes and assume that the limit is taken by constructing a sequence of lattices of increasing size .",
    "consider the smallest lattice that can contain the set @xmath64 as the initial element of the sequence .",
    "the next element in the sequence is constructed from the previous one by adding rows and columns to all four boundaries of the lattice . as a consequence , _",
    "the distance from any plaquette in @xmath64 to the boundaries increases with increasing lattice sizes_. we now choose a string @xmath74 made of a product of @xmath40 operators that connect pairwise the plaquettes in @xmath64 without reaching the boundaries . by this choice",
    ", the string operator @xmath79 used in the computation of @xmath72 always reaches the boundaries while @xmath80 does not . as the lattice grows , the length of @xmath79 surpasses that of @xmath74 .",
    "as described in sec .",
    "[ sec : fidelity ] , in the weak coupling limit , @xmath72 is strongly suppressed in comparison to @xmath81 . thus our choice of @xmath74 ensures that , in the limit of infinite lattice size , the inequality @xmath82 is satisfied .",
    "the prescription needs to be slightly modified when @xmath64 contains an odd number of plaquettes .",
    "after connecting all but one plaquette with strings pairwise , we connect the unpaired plaquette ( presumably the most remote one ) by a string to the closest boundary .",
    "we then keep that boundary fixed and construct the sequence of lattices by adding columns to the left and right boundaries but adding rows only to the opposite boundary .",
    "thus , the one string in @xmath74 reaching a boundary will keep its length fixed , while the counterpart of that string in @xmath79 will reach the opposite boundary with an increasing length .",
    "this guarantees that @xmath82 is also satisfied .    with this definition of the thermodynamical limit at hand",
    ", we define the one - cycle threshold for the surface code as the largest value of coupling between the physical qubits and the environment such that , in the _ thermodynamic limit _ , @xmath83 _ for any _ finite set @xmath64 .",
    "in particular , the intrinsic threshold corresponds to the non - error syndrome , namely , when @xmath64 is an empty set .",
    "a proof that an intrinsic threshold always exists for the error model defined in sec .",
    "[ sec : errormodel ] is given in appendix [ sec : appendixa ] .",
    "our prescription for the thermodynamic limit also allows us to show in sec .",
    "[ sec : mapping ] that , for an error model with only nearest - neighbor qubit interactions , the fidelity threshold derived from eq .",
    "( [ eq : fidelity ] ) is independent of the syndrome set @xmath64 and thus equal to the intrinsic threshold .    in our prescription for the thermodynamic limit we first fix the syndrome set @xmath64 and then take the lattice size to infinity .",
    "thus , the density of plaquettes with eigenvalues @xmath27 tends to zero .",
    "this procedure is quite adequate for our goal of establishing the intrinsic threshold irrespective of the syndrome @xmath64 , as we argue in sec .",
    "[ sec : cases ] .",
    "an alternative definition of the thermodynamic limit , commonly used in numerical investigations using stochastic error models , would keep the density of plaquettes with eigenvalues @xmath27 fixed as the lattice size is increased .",
    "therefore , the set @xmath64 would be different and larger for each new lattice size and a recalculation of the amplitudes @xmath81 and @xmath72 would be required at each new step .",
    "thus , in addition to being much harder to be analyzed , such a prescription does not guarantee that the inequality @xmath84 is satisfied in the thermodynamic limit . therefore , it is not suitable for determining a fidelity threshold from eq .",
    "( [ eq : fidelity ] ) .",
    "in realistic implementations , the physical qubits interact with a variety of environmental degrees of freedom @xcite .",
    "for instance , frequently one can not neglect the interaction of qubits with bosonic environments @xcite .",
    "these can come directly from phonons and electromagnetic fluctuations generated by electronic components , or indirectly from interactions with spin or charge impurities .",
    "it is also possible that imperfections in qubit design cause spurious coupling between single - qubit states .",
    "finally , it is also possible that qubits couple to a spin ( or pseudo - spin ) bath . for these cases and others , the effect of a time evolution under the influence of the environment can be recast as an effective action for the physical qubits by integrating out the environmental degrees of freedom .",
    "thus , at the end of a qec cycle , an effective evolution operator of the form @xmath85 can be derived and employed in the calculation of matrix elements and probability amplitudes involving physical qubits .",
    "the exact form of @xmath86 depends on the particular type of interaction and the nature of the physical qubits and the environment . here , we consider the two - term expression @xmath87 the parameters @xmath88 and @xmath89 incorporate environmental fields and qubit - qubit interactions , respectively , and can be either real or imaginary numbers .",
    "their magnitudes set the strength of the coupling between physical qubits and the environment .",
    "this form is exact for qubits coupled linearly to free bosonic baths and local fields @xcite .",
    "we note that @xmath89 can also represent direct interactions between qubits that are not environment mediated .",
    "let us write expressions for the amplitudes @xmath67 and @xmath72 as sums over configurations of the variables @xmath90 .",
    "we begin by replacing each state @xmath91 in eq .",
    "( [ eq : ferro ] ) by @xmath92 , where @xmath93 , we have @xmath94 up to a normalization factor . here",
    "@xmath95 stands for @xmath96 .",
    "the sum in eq .",
    "( [ eq : codeword1new ] ) is restricted to the configurations @xmath95 that satisfy the constraint @xmath97 for all stars ( i.e. , vertices ) in the lattice .",
    "we substitute eq .",
    "( [ eq : codeword1new ] ) in the definitions of the amplitudes @xmath67 and @xmath72 [ eqs .",
    "( [ eq : a ] ) and ( [ eq : b ] ) ] and use eq .",
    "( [ eq : ueff ] ) to arrive at @xmath98 and @xmath99 the operator @xmath100 now represents a string of variables @xmath101 compatible with the syndrome represented by the set of plaquettes @xmath64 .    the sums in eqs .",
    "( [ eq : amplitudea ] ) and ( [ eq : amplitudeb ] ) are very difficult to evaluate ( see ref .",
    "below , we provide an exact solution to this problem for a particular but significant case .     and corresponding plaquette variables @xmath102 and @xmath103.,width=226 ]",
    "let us consider the case where @xmath89 describes only nearest - neighbor interactions . to overcome the restriction in the sums in eqs .",
    "( [ eq : amplitudea ] ) and ( [ eq : amplitudeb ] ) , we introduce plaquette variables @xmath104 , with @xmath105 , such that @xmath106 ( see fig .",
    "[ fig : massfield ] ) .",
    "the subscript @xmath107 refers to the physical qubit @xmath107 while @xmath108 and @xmath109 indicate the plaquettes sharing the link @xmath107 .",
    "even though the variables @xmath104 can be positive or negative , they automatically satisfies the constraint of positive star eigenvalues .",
    "this parameterization is well known in the lattice gauge field literature @xcite .",
    "thus , starting from the error model defined in eq .",
    "( [ eq : heff ] ) and introducing these new variables , it is straightforward to show that , for nearest - neighbor qubits @xmath107 and @xmath110 in the bulk ( i.e. , not at the top or bottom edges ) , @xmath111 and @xmath112 where the plaquettes @xmath113 and @xmath114 are next - to - nearest neighbors containing the links @xmath107 and @xmath110 , respectively [ see fig .",
    "[ fig : links](a ) ] . notice that the same product @xmath115 appears again when we consider the contribution from the other pair of nearest - neighbor links @xmath116 and @xmath117 belonging to these plaquettes .",
    "thus , we can define @xmath118 such that @xmath119 as well as @xmath120 such that @xmath121 where @xmath122 are nearest - neighbor plaquettes and @xmath123 are next - to - nearest neighbors .",
    "the new parameters are functions of @xmath88 and @xmath89 .",
    "notice that for homogeneous fields and couplings in the bulk , @xmath124 and @xmath125 , we get @xmath126 and @xmath127 .",
    "a little more work is needed to understand the constraint of positive stars at the bottom and top boundaries ( see fig . [",
    "fig : surfacecode ] ) .",
    "a star at these boundaries is formed by the product of three qubits ; for instance , @xmath128 .",
    "one of these qubits belongs to the bulk and can be written in terms of plaquette variables , @xmath129 .",
    "therefore , we obtain @xmath130 and , consequently , @xmath131 .",
    "this can be repeated for all qubits at the boundary . as a result ,",
    "the product of any pair @xmath132 at the boundaries is a constant @xmath35 ( here @xmath108 denotes the plaquette where the boundary link @xmath107 is located . )",
    "thus , for sites at the top @xmath133 and bottom @xmath134 boundaries , we can write @xmath135 and @xmath136 where @xmath137 and @xmath109 is the nearest - neighbor plaquette to @xmath108 that contains the link @xmath110 . similarly to the bulk case , pairwise interactions between a qubit at the boundary and another in the bulk contribute twice to terms containing solely one plaquette variable . as a result ,",
    "@xmath138 where @xmath139 .",
    "here , @xmath116 and @xmath140 are the next - to - nearest neighboring links to @xmath107 along the edge and @xmath110 and @xmath141 are links belonging to the same plaquette where @xmath107 is located [ see fig .",
    "[ fig : links](b ) ] .    combining eqs .",
    "( [ eq : hbulk ] ) , ( [ eq : jbulk ] ) , and ( [ eq : hjboundary ] ) we obtain @xmath142 thus , we can completely eliminate the qubit variables .    ) .",
    "( b ) links and plaquette involved in eq . ( [ eq : hjboundary]).,width=226 ]    we can now go back to eqs .",
    "( [ eq : amplitudea ] ) and ( [ eq : amplitudeb ] ) and switch the restricted sums over qubit variables @xmath95 to unrestricted sums over plaquette variables @xmath104 .",
    "there are two distinct situations to consider , depending on the number of plaquettes in the syndrome .    for syndromes with an even number of plaquettes",
    ", the choice of strings in @xmath143 will involve either no link at the top or bottom boundaries or an even number of links on the same boundary .",
    "therefore , we can write @xmath144 and @xmath145 since any logic operator @xmath51 will link top to bottom boundaries .    for syndromes with an odd number of plaquettes , at least one string in @xmath143 will have to end in one of the boundaries . by applying the operator",
    "@xmath51 one generates a string ending on the opposite boundary .",
    "then , @xmath146 and @xmath147 [ if the unpaired plaquette is linked to the top boundary by @xmath148 , then one picks the subscript @xmath133 on the right - hand side of eq .",
    "( [ eq : sxodd ] ) .",
    "the opposite goes for eq .",
    "( [ eq : xodd ] ) . ]    to obtain new expressions for the amplitudes @xmath67 and @xmath72 in terms of the variables @xmath104 , @xmath149 , and @xmath150 , one inserts eqs .",
    "( [ eq : sxeven ] ) and ( [ eq : xeven ] ) or eqs .",
    "( [ eq : sxodd ] ) and ( [ eq : xodd ] ) into eqs .",
    "( [ eq : amplitudea ] ) and ( [ eq : amplitudeb ] ) and sum over all configurations of the variables @xmath150 , @xmath149 , and @xmath104 . in order to simplify the result",
    ", we introduce the ( unnormalized ) correlation function @xmath151 where @xmath152 and @xmath153 notice that since @xmath86 contains only two - body interaction terms , the following symmetry relation is satisfied : @xmath154 where @xmath155 is the number of plaquettes in @xmath64 . using eqs .",
    "( [ eq : sxeven ] ) , ( [ eq : xeven ] ) , ( [ eq : sxodd ] ) , and ( [ eq : xodd ] ) in conjunction with eqs .",
    "( [ eq : cp ] ) and ( [ eq : trs ] ) allows us to obtain concise relations for the amplitudes @xmath67 and @xmath72 . for @xmath155",
    "even , we get @xmath156 and @xmath157 for @xmath155 odd , there are two situations to consider .",
    "when the bottom is closest boundary to the most remote plaquette in @xmath64 , we get @xmath158 and @xmath159 while when the closest boundary is the top one , @xmath160 and @xmath161",
    "as argued in sec . [ sec : decoding ] , our prescription of the thermodynamic limit guarantees that @xmath162 as the lattice size grows and therefore we can use eq .",
    "( [ eq : fidelity ] ) to evaluate the fidelity . equations ( [ eq : ising - gen - aeven ] ) to ( [ eq : ising - gen - bodd_t ] ) are exact expressions , valid for any lattice size and for any finite set @xmath64 , provided that the effective interaction between physical qubits involves only nearest neighbors .",
    "thus , the behavior of @xmath81 and @xmath72 is completely determined by @xmath163 and its associated correlation function @xmath164 .",
    "since the boundary - field ising model defined by @xmath163 has a finite - temperature critical point , the fidelity threshold can be understood as this phase transition point .",
    "let us now show that this interpretation is valid . to simplify the argument ,",
    "suppose that either @xmath165 and @xmath166 or @xmath167 and @xmath168 , in which case the ising model defined in eq .",
    "( [ h_eff-2 ] ) can always be transformed into a ferromagnetic model ( when @xmath168 ) or two decoupled ferromagnetic models ( when @xmath165 ) by an appropriate change in the signs of the the variables @xmath102 beloging to one of the sublattices .",
    "consider the case where @xmath155 is even .",
    "for temperatures above the critical value ( i.e. , for small enough coupling constants ) , the @xmath104 spin system of eq .",
    "( [ h_eff-2 ] ) is in a disordered ( paramagnetic ) phase . in the thermodynamic limit , because both boundaries become infinitely distant from the plaquettes in @xmath64 , @xmath164 will not depend on boundary fields @xmath149 and @xmath150 , namely , @xmath169 .",
    "notice that even though spatial correlations among the spins @xmath170 in the set @xmath64 decay exponentially in space , they are finite even in the infinite - lattice limit because their are locked in their positions . therefore , @xmath171 and @xmath172 , independently of @xmath64 . as a result , @xmath173 .",
    "conversely , for low temperatures ( i.e. , large enough coupling constants ) , the spin system is in an ordered ( ferromagnetic ) phase .",
    "we can then distinguish two situations : ( i ) @xmath174 , when there is an even number of domain walls running parallel to the top and bottom boundaries ; ( ii ) @xmath175 , when the number of domain walls is odd . in both situations the domain walls are rather costly energetically ( the cost scales with @xmath176 , the number of columns in the lattice ) .",
    "thus , for low enough temperatures and @xmath177 , we can assume that @xmath178 is governed by spin configurations with no domain wall , whereas @xmath179 is governed by configurations with just one domain wall .",
    "in addition , since correlations decay exponentially in space in the ordered phase as well , @xmath180 , where @xmath181 , with each @xmath182 , depending on which side of the domain wall the site @xmath141 is located . therefore , since we have an even number of plaquettes in @xmath64 , @xmath183 . for @xmath179",
    ", on the other hand , because the domain wall can cut across the plaquettes in @xmath64 in many different ways with similar energy costs , this amplitude results from a sum of many similar terms with alternating signs .",
    "@xmath179 is strongly suppressed with respect to @xmath178 and , as a result , @xmath184 and @xmath185 , independently of the location of the plaquettes in the set @xmath64 , as long as they are in finite number .",
    "let us now consider cases where @xmath155 is odd and assume that the most remote plaquette in @xmath64 is closer to the top boundary ( it is straightforward to extend the discussion to the opposite situation ) .    for temperatures higher than the critical one ,",
    "the spin system is in a disordered ( paramagnetic ) phase . in the thermodynamic limit",
    ", the bottom boundary will become infinitely distant to the plaquettes in @xmath64 and @xmath186 will not depend on the boundary field @xmath149 : @xmath187 . as a result , from eqs .",
    "( [ eq : ising - gen - aodd_t ] ) and ( [ eq : ising - gen - bodd_t ] ) we see that @xmath172 , independently of @xmath64 , while @xmath67 takes a nonzero finite value determined by the residual spatial correlations between the spin variables @xmath188",
    ". therefore , @xmath189 .",
    "the argument for the low - temperature limit follows closely that developed in sec .",
    "[ sec : cases ] when the number of plaquettes is even . in",
    "the ordered ( ferromagnetic ) phase , @xmath178 is governed by spin configurations with no domain walls .",
    "then , @xmath190 and @xmath191 .",
    "the correlation functions @xmath179 , on the other hand , are dominated by spin configurations with a single domain wall running parallel to the top and bottom boundaries and result from a sum of terms with alternating signs with roughly the same energy costs . as a result",
    ", they are suppressed in magnitude in comparison to @xmath178 .",
    "thus , using eqs .",
    "( [ eq : ising - gen - aodd_t ] ) and ( [ eq : ising - gen - bodd_t ] ) , we concluded that @xmath192 and @xmath193 .      for both @xmath155 even and odd , the abrupt change in behavior of the correlation function @xmath164 as",
    "the critical temperature is crossed is what renders the transition from @xmath194 to @xmath195 sharp and what defines the location of the threshold value for the coupling constants .",
    "we stress that this transition is not the same as that originally discussed in ref .",
    "@xcite , where the error model was a purely stochastic one with no correlations . by virtue of the stochastic nature of the errors , their problem mapped onto a spin glass on the nishimori line .",
    "instead , the transition we obtain bares close resemblance to that for the toric code in the presence of a transverse field @xcite . for the error model",
    "we adopt , if the coupling constants in @xmath163 are homogeneous , the spin system @xmath104 does not behave as a spin glass .",
    "we now discuss in more detail the critical behavior of the boundary - field ising model in some special situations and how that behavior affects the surface code threshold .",
    "consider @xmath196 and @xmath197 and real , corresponding to a single - qubit relaxation channel . in this case",
    "( [ h_eff-2 ] ) is reduced to the ferromagnetic square lattice ising model with a boundary field .",
    "in particular , @xmath198 and @xmath199 are determined by the partition function of this model @xcite .",
    "it is known that the free energy has two different terms : a boundary and a bulk contribution .",
    "although the boundary magnetization has a different exponent than the bulk one , the critical temperature for the ferromagnetic transition is defined by the bulk transition temperature @xcite , @xmath200 . in the high - temperature paramagnetic phase , @xmath201 ,",
    "the direction of the boundary fields is irrelevant .",
    "hence , in this fully @xmath202 symmetric phase , we find that @xmath203 in the thermodynamic limit . below the critical temperature , @xmath204",
    ", the boundary fields explicitly break the @xmath202 symmetry , leading to two distinct values for @xmath199 when @xmath205 and @xmath206 . in this phase ,",
    "@xmath207 in the thermodynamic limit and we find @xmath208 .",
    "the transition is exponentially sharp since the boundary free energy is proportional to the number of sites at the edge . for other syndromes ,",
    "a very similar discussion can be made . in the thermodynamic limit , the transition to a regime where the code can correct happens simultaneously for all syndromes since the critical point",
    "is entirely controlled by @xmath209 .     and",
    "its significance to the one - cycle qec fidelity threshold . here @xmath210 . in the gray regions",
    "quantum information can not be recovered.,width=264 ]    this analysis can be extended to complex @xmath211 @xcite . in this more general situation ,",
    "the transition point between the @xmath202 symmetric phase and the broken symmetry phase is defined by the curve @xmath212 , where @xmath213 .",
    "[ fig : hr_hi_full ] . for a purely dynamical problem , when @xmath211 is imaginary ( e.g. , when a uniform external magnetic field acts on the physical qubits ) , @xmath214 . in this case",
    "the critical point corresponds to @xmath215 , which is consistent with the code providing infinite protection in the thermodynamic limit .",
    "now , consider @xmath216 and @xmath217 .",
    "this case applies to qubits coupled linearly to a gapless bosonic bath @xcite .",
    "the hamiltonian in eq .",
    "( [ h_eff-2 ] ) can be broken into two independent square - lattice ising models with nearest - neighbor interactions .",
    "hence , the discussion from the previous paragraph can be immediately applied .",
    "note that @xmath218 is doubled with respect to its value for the physical qubit interactions , i.e. , @xmath219 .",
    "let @xmath196 and @xmath220 be real and random .",
    "the harris criterion can not be applied since , for the clean ising model , the specific heat critical exponent vanishes and the model is marginal to disorder @xcite .",
    "we therefore discuss some specific cases .",
    "if @xmath220 has the same sign for all bonds , we expect bond disorder to be perturbative and simply yield a transition temperature roughly given by the typical value of @xmath220",
    ". this can be put on firm grounds by considering a simple toy model with two possible values for the bond , @xmath221 or @xmath222 , with equal probability @xcite . in this case",
    "the transition temperature is given by @xmath223 .",
    "an interesting situation arises when there is bond dilution , namely , when some of the @xmath220 are equal to zero . in the case of a square lattice",
    ", the percolation threshold happens when half of the bonds are missing .",
    "thus , if at least half of the qubits do not suffer the action of the local magnetic field @xmath88 , the probability of having an infinite cluster tends to zero and the @xmath202 broken phase does not exist .",
    "the implication to qec is that quantum information can _ always _ be recovered if at least half of the qubits do not fail during a qec cycle .",
    "thus , only a severe random event that causes most of the qubits to malfunction during the computation will lead to a failure in the computation .",
    "this can be relevant to the design of other planar codes as well ( which can be engineered to have high percolation thresholds ) .",
    "the scenario dramatically changes when we allow bonds with different sign @xcite .",
    "a gaussian distribution is likely a realistic assumption for this case @xcite , but most of the physics can already be discussed using the toy - model bond distribution @xmath224 .",
    "there are three renormalization group fixed points for this model in the @xmath225 plane @xcite ( see fig .",
    "[ fig : nishimori - diag ] ) . on top of the well - known nishimori line",
    ", there is an unstable fixed point , @xmath226 , that separates the @xmath202 broken phase from the unbroken phase . for @xmath227 and @xmath228 the physics is controlled by the stable fixed point of the model @xmath229 , hence we fall back to the discussion of the homogeneous model and get the usual paramagnetic - ferromagnetic transition .",
    "conversely , for @xmath230 and @xmath231 the transition is controlled by the fixed point with @xmath232 .",
    "little is known about this fixed point , but it is believed that it separates the ferromagnetic phase from a spin glass phase at @xmath233 .",
    "the existence of the @xmath202 broken phase is not in question , but the nature of the unbroken phase , where we expect the fidelity to be higher , is not clear and needs further investigation .        finally , let us consider @xmath216 and @xmath234 real and random : all the discussion from the previous paragraphs can be immediately transported to this case , the main difference being that there are two independent lattices .",
    "hence , as a function of disorder or coupling strength , one can have two different transition temperatures and thus a more complicated threshold situation may arise .",
    "some of the results described above were independently confirmed by monte carlo simulations .",
    "here , we present the case of a constant and real @xmath235 for nearest neighbors , @xmath236 , and nonerror syndromes . to insert the constraint @xmath237 into the metropolis algorithm ,",
    "an alternative representation of the stabilizers was necessary .",
    "the stabilizer operator was rewritten as the product of an even number @xmath238 of logical operators such that their product is equivalent to the stabilizer , namely , @xmath239 ( see ref .",
    "@xcite for details of this formulation and more extensive numerical results ) . working directly with the original spin ( i.e. , physical qubit ) variables",
    ", we used this representation to numerically evaluate the amplitudes @xmath198 and @xmath199 and the ratio @xmath240 .",
    "data for the case of nearest - neighbor interactions are shown in fig .",
    "[ fig : x ] .",
    "notice that the larger the lattice , the sharper the transition becomes .",
    "the mapping onto the unconstrained ising model predicts that the critical coupling @xmath241 should be equal to half of that for a regular two - dimensional ising system , namely , @xmath242 .",
    "this is in excellent agreement with the numerical value of @xmath243 obtained in our monte carlo simulations through a finite - size scaling analysis",
    ".     evaluated through monte carlo sampling for three system sizes : @xmath244 ( @xmath245 qubits , circles ) , @xmath246 ( @xmath247 qubits , diamonds ) , and @xmath248 ( @xmath249 qubits , triangles ) .",
    "the solid lines are guides to the eyes.,width=264 ]",
    "in this paper , we have argued that a stabilizer code , such as the surface code , when coupled to an environment , has an intrinsic fidelity threshold .",
    "this threshold can be determined by focusing on the nonerror syndrome sector after the physical qubits have evolved in time under an effective action intermediated by the environment . for other syndrome sectors",
    ", the decoding of the syndrome into a recovery operation limits the error correction capabilities of the code . as a result , the effective fidelity threshold should be smaller than the intrinsic threshold . to show that a threshold exists nevertheless for any syndrome",
    ", we provide a prescription where the decoding always work in the infinite lattice size limit .",
    "when bit - flip errors are considered , this prescription allows us to derive an expression for the fidelity of the surface code in terms of two amplitudes that involve expectation values of a constrained classical spin model .    for the case of an effective action involving at most nearest - neighbor interactions , we map the spin model onto an unconstrained ising model with boundary fields .",
    "this mapping allows us to predict the exact value of the fidelity threshold for several important practical situations .",
    "we find that a fidelity threshold is almost always present , for both homogeneous and inhomogeneous noise sources , but the actual critical value of the coupling constant between qubit and environment depends on particular features of the model .",
    "thus , the threshold is not universal . for the case of homogeneous coupling to the environment , the analytical prediction for the threshold location based on the exact mapping",
    "is confirmed by an independent monte - carlo simulation .",
    "when the effective interaction between physical qubits goes beyond nearest neighbors , the mapping no longer works , but the threshold can still be computed by direct numerical simulations of the constrained spin model",
    ". a recent work by two of the authors @xcite shows that the threshold decreases with increasing interaction range , as originally predicted in ref .",
    "@xcite .",
    "we are grateful to robert raussendorf for inspiring discussions .",
    "we thank jos hoyos neto and barbara terhal for useful conversations .",
    "was partially supported by inct - iq and cnpq .",
    "p.j . and e.r.m .",
    "were supported in part by the office of naval research and the national science foundation under grant no .",
    "i.s.t . acknowledges support from iarpa and pitp .",
    "let us consider the case of nonerror syndrome and assume that the environment is reset to its ground state at the end of the qec cycle .",
    "the final state of the physical qubits is given by the state vector @xmath250 where @xmath251 @xmath252 is the ferromagnetic @xmath12 state , and the projector of positive stars and plaquettes is @xmath253 since `` no errors '' were identified , there is no need to apply a recovery operation : @xmath254 ( i.e. , the identity operator ) .    introducing the amplitudes @xmath255 and @xmath256 we can express the fidelity without any ambiguity as @xmath257 in order to evaluate the amplitudes , it is convenient to move to the @xmath11 basis @xmath258 . since @xmath259",
    "we arrive at @xmath260 and @xmath261 where we used that @xmath262 ^ 2 = \\prod_{\\lozenge } ( 1 + a_{\\lozenge})$ ] . substituting @xmath263 and recalling that , for bit - flip errors",
    ", @xmath86 is diagonal in the @xmath11 basis , we can write @xmath264 and @xmath265 where @xmath266 .    at this point the sums over states @xmath267 contain all possible @xmath11 spin configurations of the physical qubits . however , the projectors in eqs .",
    "( [ eq : a0 ] ) and ( [ eq : b0 ] ) will restrict these configurations . in order to proceed , we can explicitly write that any state @xmath267 that satisfies the projectors can be written in one of the two forms : @xmath268 where @xmath269 is the ferromagnetic state in the @xmath11 direction , @xmath270 is a logical @xmath12 following a path @xmath271 , and @xmath272 is a product over a set of plaquettes . in order for the basis @xmath273 to be complete , all possible products of plaquettes have to be used when generating the states @xmath274 .",
    "notice that only one path @xmath271 should be used for generating the states @xmath275 ; summing over more than one path will render the basis overcomplete . in principle",
    "the choice of @xmath271 should not be important in the evaluation of the fidelity ( choosing @xmath271 amounts to choosing a gauge ; for each state @xmath274 there is a state @xmath275 and different @xmath271 s just define different correspondences between those states ) .",
    "now consider the infinite - lattice limit .",
    "when the spin model of eq .",
    "( [ eq : heff ] ) has a well - defined phase transition at a finite temperature , in the `` high - temperature '' ( disordered ) phase , which here corresponds to small coupling constant values , states of type @xmath274 and @xmath275 have the same `` partition function '' , namely , @xmath279 . as a result , @xmath280 and @xmath281 for coupling constant values below the critical point . in the `` low - temperature '' ( ordered )",
    "phase , states @xmath275 are energetically more costly than states @xmath274 @xcite , resulting in @xmath282 in the thermodynamic limit .",
    "therefore , for coupling constant values above the critical point , @xmath283 and @xmath284 .                                                  the allowed @xmath5 paths can be obtained from that shown in fig .",
    "[ fig : surfacecode ] by pulling it up or down at the sites on horizontal edges . similarly , allowed @xmath4 paths are generated from that shown in fig .",
    "[ fig : surfacecode ] by pulling it to left or to the right at the sites on horizontal edges .",
    "b. m. mccoy and t. t. wu , phys . rev . * 162 * , 436 ( 1967 ) ; d. b. abraham , phys .",
    "* 44 * 1165 ( 1980 ) ; h. au - yang and m. e. fisher , phys .",
    "b * 21 * 3956 ( 1980 ) ; a. maciolek and j.stecki , _ ibid_. * 54 * 1128 ( 1996 )",
    ".            a. honecker , j. l. jacobsen , m. picco , and p. pujol , in proceedings of the nato advanced research workshop on statistical field theories , edited by a. cappelli and g. mussardo ( kluwer academic , dordrecht , 2002 ) ; arxiv / cond - mat/0112069 ."
  ],
  "abstract_text": [
    "<S> the surface code is a promising alternative for implementing fault - tolerant , large - scale quantum information processing . </S>",
    "<S> its high threshold for single - qubit errors under stochastic noise is one of its most attractive features . </S>",
    "<S> we develop an exact formulation for the fidelity of the surface code that allows us to probe much further on this promise of strong protection . </S>",
    "<S> this formulation goes beyond the stochastic single - qubit error model approximation and can take into account both correlated errors and inhomogeneities in the coupling between physical qubits and the environment . for the case of a bit - flipping environment , we map the complete evolution after one quantum error correction cycle onto the problem of computing correlation functions of a two - dimensional ising model with boundary fields . </S>",
    "<S> exact results for the fidelity threshold of the surface code are then obtained for several relevant types of noise . </S>",
    "<S> analytical predictions for a representative case are confirmed by monte carlo simulations . </S>"
  ]
}