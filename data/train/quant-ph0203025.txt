{
  "article_text": [
    "one of the most difficult problems in theoretical physics is also conceptually the simplest .",
    "how does one calculate the dynamical time evolution or even the ground state of an interacting many - body quantum system ?",
    "in essence , this is a natural part of practically any comparison of quantum theory with experiment .",
    "the difficulty is that the hilbert space of all but the most trivial cases can be enormous .",
    "this implies that a finite computer is needed to to solve problems that can easily become nearly infinite in dimensionality , if treated using an orthogonal basis expansion .    in this paper",
    ", we formally introduce and give examples of techniques for treating general bosonic many - body quantum systems , which we call gauge p representations .",
    "these are an extension of the phase - space method called the positive - p representation @xcite , and have been recently used in the context of interacting bose gases @xcite .",
    "the advantages of the new technique are the following .",
    "\\(1 ) the elimination of certain types of mathematical terms known as boundary - term corrections , which have caused problems in the positive - p representation for over a decade @xcite .",
    "this is the main focus of the present paper .",
    "\\(2 ) greatly reduced sampling error in computations .",
    "gauge p representations have been used recently to reduce the sampling error in kerr oscillator simulations @xcite .",
    "\\(3 ) the extension of allowable problems to imaginary - time canonical ensemble calculations .",
    "these problems will be treated elsewhere .",
    "related extensions to the positive - p representation  although restricted to the scalar interacting bose gas problem  have also been introduced recently .",
    "different procedures have been introduced by carusotto , castin , and dalibard @xcite , and by plimak , olsen , and collett @xcite .",
    "these methods implicitly assume the absence of boundary term corrections .",
    "this paper unifies and substantially generalizes all these recent advances .",
    "it also shows how the gauge method can be used to solve the long - standing problem of boundary - term corrections in the positive p representation .",
    "comparisons to the other methods are given in an appendix .",
    "owing to the work of wilson @xcite , and many others @xcite , we know that large hilbert space problems can often be treated using stochastic or monte carlo techniques for the ground - state , particle masses , and finite - temperature correlations .",
    "this is the basis for much work in computational quantum statistical mechanics , and in qcd as well .",
    "however , wilson s and other related methods are restricted to static or ` imaginary - time ' calculations , rather than quantum - dynamical problems .",
    "methods like these that use orthogonal basis sets have not proven useful for quantum dynamics ; owing to the notorious phase problem that occurs when trying to sum over families of paths in real - time feynman path integrals .",
    "for this reason , the many - body quantum time - evolution problem is often regarded as inherently insoluble due to its exponential complexity .",
    "in fact , it was this very problem that motivated the original proposal of feynman @xcite to develop quantum computers .",
    "in these ( usually conceptual ) devices , the mathematical problem is solved by a physical system consisting of evolving ` qubits ' or two - state physical devices .",
    "fortunately , this method of doing calculations is not the only one , since no large enough quantum computer exists at present@xcite .",
    "historically , an alternative route is the use of quasi - probability representations of the quantum state , which either implicitly or explicitly make use of a non orthogonal basis .",
    "the term quasi - probability is used because there can be no _ exact _ mapping of all quantum states to a classical phase space with a positive distribution @xcite that also preserves all the marginal probabilities .",
    "these methods include the wigner @xcite ( w ) , glauber - sudarshan ( p ) @xcite , and husimi ( q ) @xcite representations .",
    "the classical phase - space representations can be classified according to the operator ordering that stochastic moments correspond to : the w is symmetrically ordered , the q is anti - normally ordered , while the p representation is normally ordered .",
    "apart from numerous laser physics and quantum optics calculations , these methods have also been used to some extent in quantum statistical mechanics : for example , the theory of bec phase fluctuations @xcite .",
    "none of these methods result in a stochastic time evolution with a positive propagator when there are nonlinearities . to achieve this ,",
    "a better approach is to use a non - classical phase space of higher dimension .",
    "a complex higher - dimensional ` r representation ' was proposed in glauber s seminal paper on coherent state expansions @xcite .",
    "the first probabilistic method of this type was the positive - p representation @xcite ( + p ) , which has proved capable of performing stochastic time - domain quantum calculations in some many - body quantum systems @xcite .",
    "this uses a basis of coherent states that are not orthogonal , thus allowing freedom of choice in the construction of the representation .",
    "the positive - p representation of a quantum state is therefore the most versatile out of a large group of quasi - probability distributions developed to aid quantum mechanical calculations .",
    "it has been successfully applied to mesoscopic systems such as quantum solitons @xcite and the theory of evaporative cooling @xcite , which correctly reproduces the formation of a bec  as observed in experiment @xcite .",
    "quasi - probability distributions of this type are computationally superior to direct density matrix methods , which are susceptible to computational complexity blow - up for large hilbert spaces .",
    "provided certain boundary terms vanish , the usual procedure is to generate a fokker - planck equation ( which will vary depending on the distribution chosen ) from the master equation , and then to convert this to a set of stochastic langevin equations . for some simple cases , it may even be possible to arrive at appealing results directly from the fokker - planck equation ( fpe ) .",
    "the resulting stochastic equations can be thought of just as quantum mechanics written in different variables .",
    "they have two main advantages over orthogonal basis - state methods , as follows .",
    "first , the whole quantum dynamics can be written exactly in terms of a small number of stochastic equations . in a one - mode case",
    ", there is just one complex variable for p and q and w , and two complex variables for + p. although a simulation requires us to average over many realizations of the stochastic process , this is often more practical than solving the infinite set of deterministic equations required to solve directly for all the elements of a density matrix .",
    "such an infinite set may be truncated , but this is only a good approximation for a system with few particles , and no more than a few modes .",
    "second , for a many - mode problem the hilbert space dimension is @xmath0 for the case of @xmath1 particles distributed over @xmath2 modes .",
    "this gives exponential growth as a function of the number of modes .",
    "however , the number of quasi - probability dynamical equations grows only _ linearly _ with the number of modes , rather than _ exponentially _ in the case of direct methods .",
    "other stochastic methods , known as quantum - trajectory methods , can be used to reduce the @xmath3 dimensionality of an @xmath4 density matrix problem to that of the @xmath5-dimensional underlying hilbert space  but this is clearly insufficient to solve the complexity problem inherent in the exponential growth of the hilbert space dimension .",
    "there are , however , some caveats when using these distributions .",
    "in particular , the vanishing of boundary terms is an important fundamental issue with quasi - probability distributions , and it is this issue that we focus on mostly in this paper . to get an overall picture , consider that once we have a time - evolution problem there are five typical requirements that are encountered in deriving stochastic equations for quasi - probability representations of many - body systems .",
    "these requirements occur in closed ( unitary evolution ) systems , in open systems ( in general described by a master equation ) , or even using a distribution to solve for the canonical ensemble in imaginary time . as such , these requirements are generic to the use of stochastic equations with operator representations :    \\(1 ) _ positive distribution_. a well - behaved positive distributions for all quantum states , including especially the chosen initial condition , is essential for a general algorithm . for example , a number state has a highly singular p distribution , and a w distribution that is negative in some regions of phase space @xcite , making either distribution impossible to interpret probabilistically for these states .",
    "the r distribution is inherently complex .",
    "such problems do not occur for the q or + p representation  these are positive , and well - behaved for all quantum states @xcite .",
    "\\(2 ) _ ultraviolet convergence_. while normally - ordered representations are well behaved at large momentum , non - normally - ordered representations of quantum fields  such as the q or w representations  typically face the problem of ultraviolet divergence in the limit of large momentum cutoff @xcite .",
    "this means that almost any observable quantity will involve the simulation of a ( nearly ) infinitely noisy classical field , leading to diverging standard deviations in two or more space dimensions , even for linear systems .",
    "this rules out the q and w distributions for quantum field simulations in higher than one - dimensional environments .",
    "\\(3 ) _ second - order derivatives_. only fpes with second or infinite - order derivatives can be translated into stochastic equations @xcite .",
    "normally - ordered methods such as the p and + p representations can handle most commonly occurring nonlinearities and two - body interactions , with only second - order derivatives .",
    "non - normally ordered representations of quantum fields often lead to third- or higher - order partial derivatives in the fokker - planck equation with no stochastic equivalent .",
    "for example , the wigner representation gives such problems for almost any nonlinear term in the master equation .",
    "\\(4 ) _ positive - definite diffusion_. a fokker - planck equation must have positive - definite diffusion , to allow simulation with stochastic processes @xcite .",
    "when the master equation has nonlinear terms , this does not occur with any of the classical representations .",
    "however , the + p representation is guaranteed to always produce positive - definite diffusion @xcite , provided no higher derivative terms occur .",
    "\\(5 ) _ vanishing boundary terms_. in the derivation of the fokker - planck equations , it is assumed that certain boundary terms arising in partial integration can be neglected .",
    "this is not always the case .",
    "boundary terms due to power - law tails can occur when there are moving singularities that can escape to infinity in finite time . in the + p method , such trajectories may cause systematic errors in stochastic averages @xcite , especially for non - integrable dynamical systems .",
    "these problems are exponentially suppressed when linear damping rates are increased , but can be large at low damping .",
    "the + p method is often the representation of choice , because it satisfies conditions one to four .",
    "gauge representations ( g ) combined with stochastic methods to be treated in this paper , share these advantages with the + p representation . however , they can also satisfy the fifth requirement  for an appropriate gauge choice  hence allowing all of the mathematical problems in simulating time evolution to be treated .",
    "for this reason , the present paper will focus on solving boundary - term issues encountered with the + p representation for certain nonlinear master equations .",
    "the overall picture is summarized in table  [ thetable ] , as applied to the two - boson anonlinear absorber cases treated here in sec .",
    "[ d12pd ] :    we emphasize that the particular examples treated here have a small particle number and extremely low ( or zero ) linear damping . as such",
    ", they are soluble using other techniques , which allows us to test the accuracy of gauge techniques .",
    "our purpose is to demonstrate the success of the stochastic gauge method in simple cases where boundary terms arise within the + p representation . in this way",
    ", we can understand more complex situations where no exact result is known .",
    "we will first derive and describe the stochastic gauge method in secs .",
    "[ gauges ] and  [ gf ] , and subsequently work through two examples : first , solving the boundary - value problem for the driven one- and two - photon absorber in sec .",
    "[ d12pd ] .",
    "second , in sec .",
    "[ las ] we will consider the one - mode laser at extremely low power , which exhibits boundary term errors when very non - optimal starting conditions are used .",
    "this example will show that gauge methods can also be used to remove errors from this system , but some judgment must be employed to avoid choosing a pathological initial distribution . in the appendix , we compare the methods derived here with recent related extensions of the positive - p representation by carusotto and co - workers @xcite , plimak _ et al . _",
    "@xcite , and deuar and drummond @xcite .    [ cols=\"^,^,^,^,^,^,^,^ \" , ]     finally , we point out a sixth requirement of containing the _ growth of sampling error _ : the averages calculated from the stochastic langevin equations correspond to quantum mechanical expectation values only in the limit of infinitely many trajectories .",
    "provided boundary terms do not occur , the averages will approach the correct values  within an acceptable sampling error  for sufficiently many trajectories . if this number should increase rapidly with time , the simulation will only be of use for a limited period @xcite .",
    "the problem of growing sampling error can occur even when there are no boundary terms , and may be regarded as the ultimate frontier in representation theory , just as similar issues dominate the theory of classical chaos .",
    "this is less of a fundamental issue , since the sampling error can always be estimated and controlled by increasing the number of trajectories .",
    "this is simply a matter of moving to a clustered , parallel computational model , or repeating the calculation many times . nevertheless , it is of great practical significance .",
    "the sampling error problem requires careful gauge optimization , and remains an open area for investigation .",
    "an intelligent choice of gauge can often vastly outweigh a brute force computational approach , in terms of sampling error .",
    "in gauge representations , the density matrix to be computed is expanded in terms of a coherent state basis . for definiteness",
    ", we shall focus on the coherent states of the harmonic oscillator , which are useful in expanding bose fields ; but other choices are clearly possible .",
    "the expansion kernel is more general than that used in the positive - p representation . in order to define the notation ,",
    "we start by introducing a set of boson annihilation and creation operators @xmath6 , @xmath7 .",
    "the operator @xmath8 is therefore the boson number operator for the @xmath9th mode or site .",
    "boson commutation relations of @xmath10=\\delta _ { ij } $ ] hold for the annihilation and creation operators .",
    "if @xmath11 is a complex @xmath2-dimensional vector with @xmath12 , and @xmath13 is an @xmath2-dimensional vector of annihilation operators , then the bargmann coherent state @xmath14 is defined by @xmath15 \\left| 0\\right\\rangle",
    "= \\exp \\left [ |\\bm { \\alpha } |^{2}/2\\right ] \\left| \\bm { \\alpha } \\right\\rangle \\ , , \\ ] ]    where @xmath16 is the usual normalized coherent state which is a simultaneous eigenstate of all the annihilation operators .",
    "the inner product of two bargmann coherent states is @xmath17 \\ , \\ , .\\ ] ]    it is important to notice here that @xmath14 is an analytic function of the complex vector @xmath18 .",
    "the following identities therefore follow immediately :    @xmath19    since @xmath14 is an analytic function , the notation @xmath20 is interpreted here as an analytic derivative , which can be evaluated in either the real or imaginary directions,@xmath21    since the coherent states are an over - complete basis set , any operator can be expanded in more than one way using coherent states . for example , the simplest resolution of the identity operator is    @xmath22    thus , introducing a second @xmath2-dimensional vector @xmath23 , we can expand any operator @xmath24 directly as@xmath25    here , we have introduced@xmath26      the possibility of expanding any operator in terms of coherent states leads to the idea that such an expansion can be used to calculate observable properties of a quantum density matrix @xmath27 . historically ,",
    "this was first proposed by glauber and sudarshan @xcite , who suggested a diagonal expansion of the form@xmath28 unlike the direct expansion given above , this has no off - diagonal elements .",
    "surprisingly , expansions of this type always exist , as long as the function @xmath29 is defined to allow highly singular generalized functions and non - positive distributions @xcite .    as these",
    "do not have a stochastic interpretation , the positive - p representation was introduced @xcite , which is defined as@xmath30 for an @xmath2-mode system .",
    "it is always possible to obtain an explicitly positive - definite distribution of this type @xcite , with the definition @xmath31 \\nonumber \\\\   &   & \\quad \\times \\quad \\left\\langle \\frac{\\bm { \\alpha } + \\bm { \\beta ^{*}}}{2}\\right| \\widehat{\\rho } \\left| \\frac{\\bm { \\alpha } + \\bm { \\beta ^{*}}}{2}\\right\\rangle \\ , \\ , .\\ \\",
    "\\label{canonicalp } \\end{aligned}\\ ] ] this form always exists , as do an infinite class of equivalent positive distributions .",
    "even simpler ways to construct the positive - p representation are available in some cases .",
    "for example , if the glauber - sudarshan representation exists and is positive , then one can simply construct@xmath32 the stochastic time evolution of the positive - p distribution does not generally preserve the above compact forms , and may allow less compact positive solutions instead .",
    "however , to obtain a time - evolution equation , it is necessary to use partial integration , with the assumption that boundary terms at infinity can be neglected .",
    "it is these less compact solutions , occurring during time evolution with a nonlinear fokker - planck equation , that lead to power - law tails in the distribution  and hence boundary - term problems caused by the violation of the assumption that these terms vanish .",
    "a technique for constructing an even more general positive distribution is to introduce a quantum complex amplitude @xmath33 , which can be used to absorb the quantum phase factor .",
    "this leads to the result that any hermitian density matrix @xmath27 can be expanded in an over - complete basis @xmath34 , where @xmath35 , and @xmath36 \\ , \\ , .\\label{lambda - defn } \\end{aligned}\\ ] ]",
    "we define the gauge representation @xmath37 as a real , positive function that satisfies the following equation :    @xmath38 d^{4m+2}\\overrightarrow{\\alpha } \\ , \\nonumber \\\\   & = & \\frac{1}{2}\\int g(\\overrightarrow{\\alpha } ) \\left [ \\widehat{\\lambda } ( \\overrightarrow{\\alpha } ) + \\text{h.c.}\\right ] d^{4m+2}\\overrightarrow{\\alpha } \\ , .\\end{aligned}\\ ] ]    the last line above follows from the fact that @xmath27 is",
    "a hermitian density matrix and @xmath37 is real . here , @xmath39 is used as an abbreviation for hermitian conjugate .",
    "the use of a complex weight in the above gauge representation is similar to related methods introduced recently for interacting bose gases @xcite , except that we multiply the weight by a normalized ( positive - p ) projector , in order to simplify the resulting algebra .    as an existence theorem that shows that this representation always exists ,",
    "consider the complex solution @xmath40 obtained from eq .",
    "( [ o - canonical ] ) , with a phase @xmath41 , and simply define@xmath42)\\ , \\ , .\\ ] ]    in this type of gauge representation , @xmath37 is a positive distribution over a set of hermitian density - matrix elements @xmath43 .",
    "it is simple to verify that , by construction @xmath44    for the case of @xmath45 , this representation reduces to the positive - p representation , and the kernel @xmath34 is a projection operator .",
    "since the positive - p representation is a complete representation , it follows that another way to construct the gauge p representation is always available , if one simply defines @xmath46    as a simple example , a thermal ensemble with @xmath47 bosons per mode gives a diagonal p distribution that is gaussian , so that @xmath48 \\delta ^{2m}(\\bm { \\alpha } -\\bm { \\beta ^{*}})\\delta ^{2}(\\omega -1)\\ , \\ , .\\ ] ]    one advantage of the proposed representation is that it allows more general expansions than the positive - p distribution , and also includes the case of the complex p representation  which has proved useful in solving for non - equilibrium steady - states in quantum systems .",
    "the utility of these methods arises when they are used to calculate time ( or imaginary time  for which the positive - p distribution can not be used ) evolution of the density matrix .",
    "this occurs via a liouville equation of generic form    @xmath49    where the liouville superoperator typically involves pre- and post - multiplication of @xmath27 by annihilation and creation operators . as an example",
    ", the equation for purely unitary time evolution under a hamiltonian @xmath50 is @xmath51 \\ , \\ , .\\ ] ]    effects of the annihilation and creation operators on the projectors are obtained using the results for the actions of operators on the bargmann states , @xmath52 \\widehat{\\lambda } ( \\overrightarrow{\\alpha } ) \\nonumber \\\\ \\widehat{\\lambda } ( \\overrightarrow{\\alpha } ) & = & \\omega \\",
    ", \\partial _ { \\omega } \\ ,",
    "\\widehat{\\lambda } ( \\overrightarrow{\\alpha } ) \\ , \\ , .\\end{aligned}\\ ] ] for brevity , we use @xmath53 to symbolize either @xmath54 or @xmath55 for each of the @xmath56 complex variables @xmath57 .",
    "this is possible since @xmath34 is an analytic function of @xmath58 , and an explicit choice of the derivative will be made later .    using the operator identities given above , the operator equations can be transformed to an integro - differential equation,@xmath59 d^{4m+2}\\overrightarrow{\\alpha } \\ , \\ , .\\end{aligned}\\ ] ] here the anti - normal ordered notation @xmath60 indicates an ordering of all the derivative operators to the right . as an example , in the hamiltonian case , if the original hamiltonian @xmath61 is normally - ordered ( annihilation operators to the right ) , then @xmath62 \\ , \\ , .\\ ] ] if no terms higher than second order occur , this procedure gives a differential operator with the following general expansion :    @xmath63    where , to simplify notation , the latin indices @xmath64 will from now on be summed over @xmath65 , since no derivatives with respect to @xmath33 are used as yet .",
    "v is a term not involving derivative operators with respect to any of the variables in @xmath66 the drift term @xmath67 that is normally found using the positive - p representation is labeled with the superscript @xmath68 to identify it .    at this stage ,",
    "the usual procedure in representation theory is to integrate by parts , provided boundary terms vanish .",
    "this gives a normally - ordered differential operator acting on the distribution itself , of form    @xmath69 g(\\overrightarrow{\\alpha } ) \\ , .\\ ] ]    this type of generalized fokker - planck equation can be treated formally using techniques developed by graham , involving time - symmetric curved - space path integrals @xcite . for computational purposes",
    ", we require special choices of the analytic derivatives to obtain a positive - definite diffusion , so that the path integrals have equivalent stochastic equations @xcite .",
    "we emphasize here that the equations resulting are quite different to those obtained from the direct insertion of a coherent state identity into a feynman path integral  which results in severe convergence problems @xcite .",
    "the usual positive - p representation equations are obtained at this stage  provided there is no potential term  and can be transformed to stochastic equations using the techniques described in the following section .",
    "in gauge representations , the time evolution of the representation is modified from the usual positive - p representation equations , by the introduction of a number of arbitrary and freely defined functions on the phase space .",
    "this freedom of choice is , of course , not present with an orthogonal basis , and is due to the non - orthogonal nature of a coherent basis set .",
    "although we do not investigate other cases , it is worth noting that a similar gauge freedom is implicitly present whenever a non - orthogonal expansion is used  even if it involves different states from the choice of coherent states made here ( e.g. , the fock state wave functions in refs .",
    "@xcite ) .",
    "we first introduce the diffusion gauges , which were implicitly present in the original positive - p representation , but were only recognized recently as allowing improvements in the sampling error .",
    "these gauges occur via the non - unique decomposition of the complex diffusion matrix @xmath70 , which determines the stochastic correlations in the final equations .",
    "arbitrary functional parameters can therefore be inserted into the final stochastic equations in the noise coefficients , which may lead to further optimization of the simulation .",
    "this is because the decomposition of the complex diffusion matrix @xmath71 , which is needed to define a stochastic process , does not specify the resulting noise matrix @xmath72 completely .",
    "it has been recently shown by plimak , olsen and collett @xcite that for the kerr oscillator using a decomposition different from the obvious diagonal one leads to impressive improvements in the signal - to - noise ratio of the simulation ( briefly described in appendix  [ plimaka ] ) .",
    "this somewhat surprising result leads us to try to quantify the amount of freedom of choice available from this source .",
    "since @xmath73 , it can always be diagonalized by a complex orthogonal transformation @xmath74 where @xmath75 is the diagonal matrix whose square gives the eigenvalues of @xmath70 .",
    "thus @xmath76 can be considered the canonical , or `` obvious '' choice of decomposition , unique apart from the @xmath77 signs of the diagonal terms . however , for any orthogonal @xmath78 , if @xmath79 is a valid decomposition of @xmath70 , then so is the matrix @xmath80 .",
    "hence , any matrix in the whole orthogonal family @xmath81 is a valid decomposition .",
    "this can be easily quantified using a basis @xmath82 of the @xmath83 independent antisymmetric @xmath84 matrices @xmath85  .",
    "one simply introduces @xmath86 as an example , for a one - mode case there is one complex gauge function introduced this way , which is @xmath87 .",
    "the resulting transformation is @xmath88 where the antisymmetric matrix @xmath89 is proportional to a pauli matrix,@xmath90 \\ , \\ , .\\ ] ] hence , if the noise was diagonal in the canonical form , the transformed ( but equivalent ) noise matrix becomes @xmath91 \\ , \\ , .\\ ] ]    now , the @xmath77-dimensional ( complex ) orthogonal matrix family contains @xmath83 free complex parameters , so there are @xmath83 diffusion gauge functions @xmath92 that one can choose arbitrarily .",
    "this represents a large class of specific gauges that can be used directly in simulations , as opposed to the conditions on noise correlations usually given elsewhere @xcite .    as pointed out by graham @xcite",
    ", there is a close similarity between the theory of curved - space metrics , and path integrals with a space - varying diffusion matrix . in the present context ,",
    "the space is complex , and we have a family of gauges that are generated on taking the matrix square root of the diffusion matrix .",
    "we have not yet used this matrix square root , but this decomposition will be applied to obtain positive - definite equations via the choice of analytic derivatives made in the following sections .",
    "the above holds for square noise matrices @xmath93 , but one is also free to add more noise coefficients in the manner @xmath94 $ ] .",
    "then @xmath95 and all the @xmath96 coefficients in the @xmath97 matrix @xmath98 are additional arbitrary complex functions .",
    "the freedom in @xmath93 is the same as before [ i.e. @xmath99 independent complex gauge functions ] , with the proviso that @xmath93 is now given by @xmath100 where the square of @xmath101 gives the eigenvalues of the modified matrix @xmath102",
    ". the matrix @xmath93 would be unchanged if @xmath103 were set to zero , although this choice of @xmath104 does not appear to be useful ; it just adds extra noise . in general",
    "it is not clear whether or not any advantage can be gained by introducing the additional off - square gauge functions contained in @xmath104 .",
    "if @xmath72 is given a functional form dependent on the phase - space variables , it may lead to additional terms in the stratonovich form of the equations , which are considered later in this section .",
    "in this situation one must be careful not to introduce additional boundary - term errors arising from an excessively rapid growth of the noise gauges .",
    "there is a subtlety here which one must take some care with .",
    "the complex noise matrix @xmath72 is not the matrix that usually appears in the theory of stochastic equations . instead",
    ", this matrix is subsequently transformed into an ` equivalent ' stochastic form , by taking advantage of the analyticity of the bargmann states .",
    "this means that the effect of the diffusion gauges on the final equations also makes use of the non - uniqueness of the coherent basis set itself .",
    "while the diffusion gauges can control sampling error due to the correlations of noise terms , they can not eliminate boundary terms due to singular trajectories in the drift equations .",
    "the extra variable @xmath33 allows the @xmath105 identity to be used to convert any potential term @xmath106 to a derivative term , and also to introduce a stochastic gauge to stabilize the resulting drift equations .",
    "this defines an infinite class of formally equivalent fokker - planck equations , in a similar way to related procedures in qed and qcd . to demonstrate this",
    ", we introduce @xmath77 arbitrary complex drift gauge functions @xmath107 $ ] , to give a new differential operator @xmath108 whose form differs from the original @xmath109 by terms that vanish identically when applied to the kernel @xmath34,@xmath110 \\left [ \\omega \\partial _",
    "{ \\omega } -1\\right ] \\ , .\\ ] ] the total differential operator @xmath108 has an anti - normal fokker - planck form . extending the drift and diffusion matrices to include the extra variable @xmath33 ,",
    "we can write this  summing repeated @xmath111 indices over @xmath112  as @xmath113 \\ , .\\ ] ] the _ total _ complex drift vector is @xmath114 ; where @xmath115    the new diffusion matrix @xmath116 with elements @xmath117 is not diagonal , but it can be factorized .",
    "explicitly , it is now a square @xmath118 complex matrix , given by    @xmath119 \\nonumber \\label{gaugediffusion1 } \\\\   & = & \\left [ \\begin{array}{cc } 0 & \\omega \\mathbf{g}\\\\ 0 & b \\end{array}\\right ] \\left [ \\begin{array}{cc } 0 & 0\\\\ \\omega \\mathbf{g}^{t } & b^{t } \\end{array}\\right ] = \\underline{\\underline{b}}\\ , \\underline{\\underline{b}}^{t}\\ , \\ , .\\end{aligned}\\ ] ]    thus , we now have a new stochastic noise matrix with one added dimension,@xmath120 \\ , \\ , .\\ ] ]    the operator ( [ lag ] ) was chosen to give this form for @xmath121 , so that the only change in noise is for the @xmath33 variable .",
    "it is always possible to transform these second - derivative terms into a positive semi - definite diffusion operator on a real space , which is a necessary requirement for a stochastic equation . when @xmath122 , divide @xmath123 into its real and imaginary parts .",
    "a similar procedure is followed for @xmath124 .",
    "recalling that the original kernel was analytic , thus allowing for more than one choice of derivatives , the choice for @xmath125 can now be made definite by choosing it so that the resulting drift and diffusion terms are always real,@xmath126 hence , the gauge differential operator can now be written explicitly as @xmath127 \\",
    ", , \\ ] ] where the indices @xmath128 cover the @xmath129-dimensional phase - space of the real and imaginary parts of @xmath58 , so that @xmath130 , and @xmath131 .",
    "the diffusion matrix @xmath132 is now positive semi - definite , since , by construction @xmath133 \\ , \\ , \\ , .\\ ] ]    so that the diffusion matrix is the square of a real matrix  explicitly ,    @xmath134   \\left [ \\begin{array}{cc } 0 & 0\\\\ \\left ( \\underline{\\underline{b}}^{x}\\right ) ^{t } & \\left ( \\underline{\\underline{b}}^{y}\\right ) ^{t } \\end{array}\\right ] \\ , \\ , \\ , .\\ ] ]    as @xmath108 is now explicitly real as well as positive - definite by construction , it can be applied to the hermitian conjugate kernel as well , resulting in the final time - evolution equation ,    @xmath135 d^{\\,4m+2}\\widetilde{\\alpha } \\ , \\ , .\\end{aligned}\\ ] ]    on integrating by parts , _ provided boundary terms vanish _ , at least one solution will satisfy the following ( normally - ordered ) positive - definite fokker - planck equation  with the differential operators on the left , each acting on all terms to the right ,    @xmath136 g\\ , .\\ ] ]    this implies that we have an equivalent set of ito stochastic differential equations available , with @xmath77 _ real _ gaussian noises @xmath137 , which are@xmath138 the noises obey @xmath139 , and are uncorrelated between time steps .",
    "numerical simulations are usually done in the stratonovich calculus , due to superior convergence properties @xcite , so the equivalent _ complex _ stratonovich equation allows us to write efficient algorithms , @xmath140 dt+b_{ak}dw_{k}\\ , \\",
    ", , \\label{sde0 } \\end{aligned}\\ ] ] where @xmath141 . the derivative terms above are the stratonovich correction in the drift , corresponding to related terms obtained in curved - space path integrals .",
    "these gauge terms are now utilized to stabilize coherent - state paths entering into highly non - classical regions of phase space .",
    "this allows one to benefit from the over - completeness of coherent states , in reducing the sampling error and eliminating boundary terms .",
    "the procedure for calculating observable moments is slightly different for the gauge representation than for the positive p. any moment can be written in terms of the normally ordered operator products @xmath142 , and their expectation values are given by @xmath143 which differs from the positive - p situation whenever @xmath33 differs from unity .",
    "the average norm @xmath144 is always preserved if there is no potential term ( @xmath145 ) , since the resulting equation for the weight variable is@xmath146 the decorrelation property of ito equations @xcite then implies that @xmath147      we turn briefly here to the question of gauge classification and properties . just as in qed , the over - complete nature of the coherent - state expansion means that many equivalent , stable gauges exist .",
    "however , they may not be equivalent in terms of boundary terms .",
    "these are determined by the tails of the distribution function , which depends intimately on the gauge chosen for the time evolution .",
    "it is essential that the distribution tails are sufficiently bounded to eliminate boundary terms arising in partial integration .",
    "it is sufficient to bound tails better than any inverse power law , for which it is conjectured to require ( as a necessary condition ) that all deterministic trajectories are bounded over any finite time interval @xcite . this issue is discussed in greater detail below , and in ref .",
    "@xcite .",
    "the main criteria for a useful gauge are the elimination of boundary terms and the reduction of sampling error .",
    "however , there is an enlarged space of variables for the fokker - planck equation here .",
    "for this reason , it is possible to stabilize trajectories in the usual positive - p phase space , while introducing new gauge - induced boundary terms in the @xmath33 space .",
    "when it comes to the formation of boundary terms , the phase of @xmath33 is generally innocuous provided the gauge is periodic in this variable , but the gauge distribution must be strongly bounded as @xmath148 to prevent new boundary terms from arising .",
    "we can classify gauges according to their real or imaginary nature , and their functional dependence ; which can be on just the phase - space variables , just the quantum phase , or on both .",
    "this gives rise to nine gauge types , depending on the following criteria .",
    "gauges are in general complex functions , which leads to the following classification of gauge complexity :    1 .",
    "real gauge 2 .",
    "imaginary gauge 3 .",
    "complex gauge    in general , we find that trajectories can be stabilized by real , imaginary or complex gauges , provided they have some @xmath149 phase - space dependence .",
    "it is worthwhile to note that the imaginary and real parts of the gauges affect the behavior of sampling error differently . in the ito calculus ,",
    "the evolution of the weight @xmath33 due to the gauges is simply @xmath150 .",
    "typically , i.e. , when there are no significant correlations between the phase of @xmath151 ( or @xmath152 ) and @xmath33 , the weight factor appearing in moment calculations is just approximately @xmath153 $ ] . as a general rule , sampling errors are partially due to stochastic fluctuations in the phase - space trajectories , and partially due to stochastic fluctuations in the weight function .",
    "thus there is a trade - off ; a gauge that is strongly stabilizing may reduce phase - space fluctuations at the expense of increased weight variance , and vice versa .    to understand the different types of gauges in somewhat greater detail",
    ", we consider the evolution of the weight variance for real and imaginary gauges , in a simple case where gauge and weight are decorrelated , with @xmath45 initially .",
    "let @xmath154 and @xmath155  , then @xmath156 if we consider the evolution of the squares of these terms , the ito rules of stochastic calculus give @xmath157^{2}\\rangle   & = & \\langle \\left ( \\omega ' g'_{k}-\\omega ' ' g''_{k}\\right ) ^{2}\\rangle dt\\ , \\ , , \\nonumber \\\\ d\\langle [ \\omega ' ' ] ^{2}\\rangle   & = & \\langle \\left ( \\omega ' g''_{k}+\\omega ' ' g'_{k}\\right ) ^{2}\\rangle dt\\ , \\ , .\\label{wvariance } \\end{aligned}\\ ] ] suppose for simplicity that the @xmath158 and @xmath33 are approximately uncorrelated , then we have two cases to consider .    1 .   real gauge:@xmath157^{2}\\rangle   & = & \\langle [ \\omega ' ] ^{2}\\rangle d\\tau \\ , \\ , , \\end{aligned}\\ ] ] where @xmath159 .",
    "this initially leads to linear growth in the variance , and hence in the sampling error .",
    "the real part of the gauge will cause noise directly in @xmath160 , producing asymetric spreading in @xmath160 , which can lead to a few rare very highly weighted trajectories for times @xmath161 .",
    "the effect of the real gauge may become misleading once the distribution becomes highly skewed , as the rare trajectories that are important for moment calculations may be missed if the sample is too small . at long times , if @xmath162 is constant and uncorrelated with @xmath33 , then the growth becomes exponential , with @xmath163^{2}\\rangle = e^{\\tau } $ ] .",
    "2 .   imaginary gauge:@xmath157^{2}\\rangle   & = & \\langle [ \\omega ' ' ] ^{2}\\rangle d\\tau \\ , \\ , , \\nonumber \\\\ d\\langle [ \\omega ' ' ] ^{2}\\rangle   & = & \\langle [ \\omega ' ] ^{2}\\rangle d\\tau \\ , \\ , .\\end{aligned}\\ ] ] where @xmath164 .",
    "this leads initially to quadratic growth in the variance of @xmath165 , and hence a slower growth in the sampling error .",
    "if @xmath162 is constant and remains uncorrelated with @xmath33 , then the growth is given by @xmath163^{2}\\rangle = \\cosh ( \\tau ) $ ] , @xmath166^{2}\\rangle = \\sinh ( \\tau ) $ ] .",
    "an imaginary gauge will cause mutual canceling of trajectories that have weights of randomly positive and negative sign once @xmath167 .",
    "this can also have deleterious effects for small samples , if the average sample weight becomes negative  of course , this can not be true over the entire stochastic population .",
    "the generic behavior is more complex than in the examples given above , due to correlations between the gauge and the normalization .    clearly",
    "any type of gauge tends to cause growth in the norm variance .",
    "however , there is an exception to this rule : the norm - preserving gauges .",
    "this class of gauges is of special interest as they generate trajectories having an invariant normalization , so that @xmath168\\equiv 0 $ ] . from the equation for the norm variance , eq .",
    "( [ wvariance ] ) , it follows that a necessary and sufficient condition for a norm - preserving gauge is that @xmath169 . if @xmath170 initially , this implies that @xmath171 , where @xmath172 is a real function . unless @xmath173 , norm - preserving gauges are generally functions of both the phase - space variables and the weight @xmath33  .",
    "a preliminary study of these gauges has shown that these gauges can greatly reduce sampling error , although gauge - induced boundary terms are also possible @xcite , depending on the choice of @xmath172 .      from the above analysis",
    ", we see that gauges can functionally depend on any phase - space variable , as well as the generalized quantum phase variable or weight @xmath33  .",
    "this leads to three functional types :    1 .",
    "autonomous ( depends on @xmath33 only ) 2 .",
    "space dependent ( depends on phase - space only ) 3 .",
    "mixed ( depends on all components of @xmath58 including @xmath33 )    autonomous gauges appear to be the least useful since they do not affect @xmath151 or @xmath152 behavior , but gauges of either purely space - dependent or mixed type can be used .",
    "a possible caveat with mixed gauges is that they may be much harder to analyze , as two - way couplings will occur between the normal phase - space variables @xmath151 , @xmath152 and the weight .",
    "the nonlinear absorber is an example of a nonlinear master equation that can give either correct or incorrect results when treated with the usual positive - p representation methods , if the boundary terms are ignored .",
    "generally , problems only arise when the linear damping has exceptionally small values or the number of bosons per mode is small ( see fig .  [ 2pd - varn ] ) , so this is not a practical problem in optics",
    ". however , for other physical systems such as a bec this may be significant .",
    "it is a well - studied case , and a detailed treatment can be found in ref .",
    "it also has the merit that exact solutions can be readily found using other means . by analyzing this example",
    "we can ensure that the modifications to the drift equations obtained from gauge terms , do eliminate boundary terms and give correct results .",
    "consider a cavity mode driven by coherent radiation , and damped by a zero temperature bath that causes both one and two photon losses .",
    "we have scaled time so that the rate of two - photon loss is unity . without this nonlinear process , nothing unusual happens .",
    "the scaled one - photon loss rate is @xmath174 , and @xmath175 is the scaled ( complex ) driving field amplitude .",
    "the master equation is@xmath176 + \\frac{\\gamma } { 2}(2\\hat{a}\\hat{\\rho } \\hat{a}^{\\dagger } -\\hat{a}^{\\dagger } \\hat{a}\\hat{\\rho } -\\hat{\\rho } \\hat{a}^{\\dagger } \\hat{a})\\nonumber \\\\   &   & \\ , \\ , + \\ , \\ , \\frac{1}{2}(2\\hat{a}^{2}\\hat{\\rho }",
    "\\hat{a}^{\\dagger 2}-\\hat{a}^{\\dagger 2}\\hat{a}^{2}\\hat{\\rho } -\\hat{\\rho } \\hat{a}^{\\dagger 2}\\hat{a}^{2})\\ , \\ , .\\label{12pdmaster } \\end{aligned}\\ ] ]    following the treatment of sec .",
    "[ gauges ] , we arrive at the gauge representation stratonovich stochastic equations @xmath177dt+i\\alpha dw\\ , \\ , , \\nonumber \\\\ d\\beta   & = & [ \\varepsilon ^{*}-\\beta ( \\alpha \\beta + i\\overline{g}+(\\gamma -1)/2)]dt+i\\beta d\\overline{w}\\ , \\ , , \\nonumber \\\\",
    "d\\omega   & = & s_{\\omega}dt + \\omega \\left [ gdw+\\overline{g}d\\overline{w}\\ , \\ , \\right ] \\ , \\ , \\ , \\ , .\\label{baseeq } \\end{aligned}\\ ] ] here @xmath178 is the appropriate stratonovich correction term [ given by the derivative terms in eq .",
    "( [ strat ] ) ] , which depends on the particular gauges chosen .    with no gauge ( @xmath179 ) , the positive - p stratonovich equations are recovered,@xmath180dt+i\\alpha dw\\ , \\",
    ", , \\nonumber \\label{12pdposp } \\\\ d\\beta   & = & [ \\varepsilon ^{*}-\\beta ( \\alpha \\beta + \\{\\gamma -1\\}/2)]dt+i\\beta d\\overline{w}\\ , \\ , .\\end{aligned}\\ ] ]    we will concentrate on the various simplifications of this model , which correspond to existing literature , and simpler analysis .      the nonlinearity seen here can occur directly in the form of a nonlinear collisional damping term in a many - body system , so that it can be referred to generically as ` two - boson absorption ' .",
    "this type of damping is common both to nonlinear photonic and atomic interactions .",
    "it is of nearly the same form as for an ` imaginary - time ' thermal equilibrium state calculation for the usual model of an alkali - metal bose gas or bec @xcite . there , for example , the interaction energy between identical bosons of mass @xmath181 and @xmath182-wave scattering length @xmath183 in @xmath70-dimensional space is given by @xmath184 provided that @xmath183 is much smaller than other characteristic lengths of the system ( which is usually the case ) .",
    "the master equation for an imaginary - time calculation is @xmath185 where @xmath186 is the thermal canonical ensemble density matrix , @xmath187 is the chemical potential , @xmath188 is the number operator for the entire system , and @xmath189 is an inverse temperature . apart from the fact that it is not trace - preserving ,",
    "this is a nonlinearity very similar to that occurring in the nonlinear absorber master equation .    while boundary - term discrepancies only occur with this nonlinearity for low occupations per mode ( see also fig .",
    "[ 2pd - varn ] ) , for a many - mode system at finite temperature one expects a large number of modes to have just such a low occupation .",
    "thus , it is important to check that boundary terms are indeed eliminated .",
    "note that the gauge representation simulation is efficient over a wide range of occupation numbers .",
    "see , for example , fig .",
    "more details of applications to both real and imaginary time many - body systems with many modes will be given elsewhere .",
    "in its simplest form , corresponding to @xmath190 , only two - boson absorption takes place .",
    "we expect that for a state @xmath191 all even boson number components will decay to vacuum , and all odd - numbered components will decay to @xmath192 , leaving a mixture of vacuum and one - boson states at long times .",
    "the positive - p representation has been found to give erroneous results @xcite due to the existence of moving singularities @xcite , which cause power - law tails in the distribution leading to boundary terms .",
    "the moment usually concentrated on in this system is the number of bosons @xmath193 , which corresponds to the statistical average of @xmath194 in the positive - p representation .",
    "this has a convenient closed equation ( stratonovich ) , @xmath195 with @xmath196 , @xmath197 , and @xmath198 .",
    "let us examine the behavior of the above equation , when @xmath199 , i.e. , in the standard , un - gauged formulation . the deterministic part of the evolution has a repellor at @xmath200 , and an attractor at @xmath201 .",
    "the noise is finite , and of standard deviation @xmath202 at the attractor .",
    "we can see that the deterministic part of the evolution has a single trajectory of measure zero which can escape to infinity along the negative real axis , @xmath203 where @xmath204 .",
    "this moving singularity is known to cause the power law behavior of the fokker - planck solution at large @xmath205 , which means that integration by parts is not in fact valid  which leads to incorrect results .",
    "indeed , it can be easily seen that in the steady - state limit , all trajectories in a simulation will head toward @xmath201 , making @xmath206 .",
    "quantum mechanics , however , predicts that if we start from a state @xmath207 , the steady state will be @xmath208 for a coherent state @xmath209 input , say , this will be @xmath210 thus we can expect that the positive p simulation will give correct results only when @xmath211 .    to correct the problem we have to change the phase - space topology in some way to prevent the occurrence of moving singularities",
    "we have found that a good gauge for a two - boson absorber nonlinearity in general is @xmath212 this replaces the @xmath213 term in eq .",
    "( [ 2pdeq ] ) , which may become repulsive from zero , with @xmath214 which is always a restoring force , and so never leads to super - exponential escape .    with the gauge ( [ goodgauge ] ) ,",
    "the stratonovich equations become @xmath215d\\tau/2+i(n-|n|)dw^{+}\\ , \\",
    ", \\right\\ } \\ , \\ , .\\nonumber \\end{aligned}\\ ] ] phase - space trajectories have changed now , but",
    "since it has all come from the same master equation , it still describes the same system .",
    "consider the equations for the polar decomposition of @xmath216 , @xmath217 this is exact , and shows that now we have an attractor on the circle @xmath218 , and a repellor at @xmath200 , with free phase diffusion in the tangential direction .",
    "once trajectories reach the attractor , only phase diffusion occurs .",
    "some more complicated evolution is occurring in the @xmath33 variable . in any case , there are now no moving singularities anywhere in the phase space , and simulations correspond exactly to quantum mechanics .",
    "figure [ 2pd - exact+posp+gauge ] compares results for a truncated number - state basis calculation , a positive - p calculation , and a `` circular '' gauge ( [ goodgauge ] ) calculation for an initial coherent state of @xmath219 .",
    "figure  [ 2pd - varn ] compares steady - state values for exact , positive - p , and gauge calculations for various initial coherent states in a wide range .",
    "it is seen that the gauge calculation is correct to within the small errors due to finite sample size .",
    ", width=325 ]     obtained by gauge simulations ( _ double triangles _ ) compared to exact analytic results from eq .",
    "( [ exss ] )  ( _ solid line _ ) and positive - p simulations ( _ circles _ ) for a wide range of initial coherent states .",
    "size of uncertainty in gauge results due to finite sample size is indicated by vertical extent of ` double - triangle ' symbol .",
    "steady state was observed to have been reached in all simulations by @xmath220 or earlier ( compare with fig .",
    "[ 2pd - exact+posp+gauge ] and [ 12pd ] ) , hence this is the time for which the simulation data is plotted .",
    "simulation parameters : 100 000 trajectories ; step size = 0.01 .",
    "[ 2pd - varn],width=325 ]      if we now turn on the one - boson decay as well , but still do not have any driving , we expect that all states will decay to the vacuum on two time scales @xmath221 and @xmath222 .",
    "if @xmath223 , nothing interesting happens , however if @xmath224 , we should first see a rapid decay to a mixture of vacuum and one - boson states due to the two - boson process , and then a slow decay of the one - boson state to the vacuum on a time scale of @xmath225 .",
    "in this case the positive - p equations display different behavior depending on whether @xmath226 is above or below the threshold @xmath227 .",
    "below threshold , we have an attractor at @xmath228 , and a repellor at @xmath200 , while above threshold , the attractor is at @xmath200 , and the repellor at @xmath229 . in either case",
    ", there is a singular trajectory along the negative real axis , which can cause boundary - term errors .",
    "it turns out that the steady state calculated this way is erroneous while @xmath230 , and there are transient boundary - term errors while @xmath231 @xcite .",
    "the false steady state below threshold lies at the location of the attractor : @xmath232 .",
    "let us try to fix this problem using the same circular gauge ( [ goodgauge ] ) as before .",
    "the equation for @xmath233 is now @xmath234/2)d\\tau \\ , \\",
    ", , \\ ] ] while the @xmath235 and @xmath33 evolution is unchanged .",
    "so , above threshold we are left with only an attractor at @xmath200 , while below threshold we have a repellor at @xmath200 surrounded by an attracting circle at @xmath236 .",
    "this phase space again has no moving singularities .",
    "the results of simulations for the parameter @xmath237 are shown in fig .",
    "[ 12pd ] . the gauge simulation tracks the exact results .",
    "we have chosen @xmath238 so that a system with two widely differing time scales is tested .",
    "the circular gauge avoids the false results of the positive - p simulation .",
    "note also that the gauge simulation remains efficient for a wide range of occupation numbers  from @xmath239 , where the positive p is also accurate , to @xmath240 where it is totally incorrect .    ;",
    "_ circles _ : positive - p simulation .",
    "_ solid line _ : circular gauge simulation ; _ dashed line _ : exact calculation ( truncated number - state basis ) .",
    "gauge simulation parameters : @xmath241 trajectories ; step size varies from @xmath242 to @xmath243 ; initial coherent state @xmath244 with @xmath245 bosons .",
    "[ 12pd],width=325 ]      the other type of situation to consider is when we have a driving field as well as two - boson damping . in these considerations",
    "we have set the one - boson damping rate to zero ( @xmath246 ) , since this process never causes any of the simulation problems anyway , but leaving it out simplifies analysis .",
    "failure of the positive - p representation method has been found in this limit as well @xcite , and is evident in fig .",
    "the equation for @xmath1 is no longer stand - alone in this case , and we must simulate all three complex variables as in eq .",
    "( [ baseeq ] ) , the @xmath247 equation being the same as in the undriven case ( [ 2pdeqs ] ) .",
    "a treatment of the singular trajectory problem with the same circular gauge  ( [ goodgauge ] ) leads again to correct results , as seen in fig .",
    "[ tpde ] .    .",
    "_ circles _ : positive p simulation ( @xmath248 trajectories ) ; _ solid line _ : circular gauge simulation ( @xmath241 trajectories ) ; _ dashed line _ :",
    "exact calculation ( truncated number - state basis ) .",
    "step size @xmath249 . initial vacuum state .",
    "[ tpde],width=325 ]",
    "let us now consider the second quantum system for which systematic errors have been seen with the positive - p representation .",
    "we will see that the problem here is somewhat different than in the previous case .",
    "the difference is that for two - boson damping , boundary - term errors occur even when we choose an optimal ( i.e. , compact ) initial distribution to represent our starting state , whereas here systematic errors occur only for unreasonably broad initial distributions .",
    "nevertheless , since normally it is assumed that the initial condition can be of arbitrary breadth it is instructive to investigate how this problem can be tackled with stochastic gauge methods .",
    "we have found that stochastic gauges can be used to increase the allowable breadth to include all reasonable starting conditions , but once one tries to increase the initial spread too much , it becomes unlikely that any gauge will remove systematic errors , without introducing too much sampling ( i.e. random ) error instead .",
    "ito stochastic differential equations for a simple photonic or atomic laser model that can be derived from the positive - p distribution are @xcite@xmath250 in appropriate scaled variables , with the complex gaussian noise @xmath251 obeying @xmath252 . in terms of physical parameters , we have @xmath253 where @xmath254 is the scaled time , and @xmath255 is a scaling parameter that equals the number of gain atoms in a simple photonic laser model .",
    "both @xmath256 the gain parameter and @xmath257 , the noise parameter , are real and positive .",
    "since this time we are again interested in the ( scaled ) boson number @xmath258 , its evolution can be written as a closed equation @xmath259 where now the _",
    "real _ gaussian noise obeys @xmath260 , and the deterministic stationary points in the stratonovich calculus are @xmath261 we find that the stationary point at @xmath262 is an attractor , and at @xmath263 we have a repellor .",
    "defining @xmath264 , we get @xmath265 which shows that we again have a singular trajectory escaping to infinity in finite time along the negative real axis for @xmath266 .",
    "let us consider the usual case of vacuum initial conditions .",
    "a vacuum can be represented by @xmath267 but also by gaussian distributions of any variance @xmath268 , around the above , @xmath269 note : the distribution of @xmath270 is non - gaussian , but has a standard deviation of @xmath271 in both the real and imaginary directions .",
    "it has been found by schack and schenzle @xcite that for the single - mode laser model , a positive - p simulation of pumping from a vacuum will give correct answers if the usual @xmath272-function initial condition ( [ deltap ] ) is used , but will have systematic errors if the initial condition used has a sufficiently large variance ( see fig .  [ oml ] ) .",
    "we emphasize here that this is not a real problem in practical cases , as the variance required to cause systematic errors is typically extremely large , once the scaling needed to obtain the usual ( approximate ) laser model is taken into account .    this can be understood because if we have a sufficiently broad initial distribution , the region of phase space that includes the singular trajectory will be explored by the distribution .",
    "even if initially @xmath273 , the region @xmath266 may be subsequently explored due to the presence of the noise terms .",
    "apart from the obvious @xmath272-function initial condition , one might want to try the canonical distribution of eq .",
    "( [ canonicalp ] ) , which is a standard positive - p representation construction @xcite .",
    "it will not cause problems as its variance is @xmath274 , which for any realistic case will be very small ( i.e. , @xmath273 ) .",
    "schack and schenzle discovered anomalous results when they chose @xmath275 , due to an erroneous procedure of scaling the equations  while not scaling the canonical initial condition in @xmath276 .",
    "nevertheless , since any @xmath277 is supposed to represent the same state , insight into what can be achieved using gauge methods is gained if we analyze the systematic errors for such a relatively large @xmath277 .      the fokker - planck equation corresponding to eq .",
    "( [ sseqns ] ) is @xmath278\\tilde{\\alpha } + \\frac{\\partial } { \\partial \\tilde{\\beta } } [ \\tilde{n}-g]\\tilde{\\beta } + 2q\\frac{\\partial ^{2}}{\\partial \\tilde{\\alpha } \\partial \\tilde{\\beta } } \\right\\ } p\\ , \\ , .\\ ] ] we now introduce gauges using the same method as in sec .",
    "[ gauges ] . this leads to the ito stochastic equations @xmath279/2\\ , \\ , .\\end{aligned}\\ ] ] it is convenient to define a transformed gauge function @xmath280 , which is also arbitrary , such that @xmath281 changing to @xmath270 and @xmath282 variables we obtain the stratonovich equation @xmath283 with @xmath284 being the appropriate stratonovich correction [ given by the derivative terms in eq .",
    "( [ strat ] ) ] for a particular gauge function @xmath280 .",
    "consider the deterministic evolution of the real part , @xmath285 , of @xmath286 , @xmath287 + 2\\tilde{n}_{y}\\text{im } [ \\tilde{g}]\\ , \\ , .\\ ] ] the moving singularity is due to the @xmath288 leading term for negative values of @xmath285 .",
    "we now consider criteria for choosing the drift gauges as follows .",
    "\\(1 ) it is desirable to keep the gauge terms to a minimum because whenever they act the weights of trajectories become more randomized  see sec .",
    "[ gcomplex ] .",
    "thus , let us restrict ourselves to functions @xmath280 that are only nonzero for @xmath289 .",
    "\\(2 ) this immediately leads to another restriction on @xmath280 : to be able to use the efficient numerical algorithms in the stratonovich calculus , we must be able to calculate the correction term @xmath290 , which depends on derivatives of @xmath291 .",
    "this immediately suggests that @xmath280 must always be continuous , hence , in particular , @xmath292 .",
    "for ease of analysis , let us start with a simple form for the gauge , @xmath293 .",
    "this restriction immediately implies @xmath294 , hence@xmath295 & \\text { if } \\",
    "\\text{re } [ \\tilde{n}]<0\\\\ 0 & \\text { if } \\",
    "\\text{re } [ \\tilde{n}]\\geq 0 \\end{array}\\ , \\ , , \\right.\\ ] ] and @xmath296 + \\tilde{n } + |\\tilde{n}| ) /2 .",
    "$ ] when @xmath297 < 0 $ ] , zero otherwise .",
    "\\(3 ) the next necessary condition , to remove moving singularities , is that the @xmath288 term is canceled , hence : @xmath298    \\(4 ) now , if @xmath299 there are no systematic errors , but the sampling error very quickly obscures everything because @xmath300 still heads to @xmath301 exponentially due to the @xmath302 term .",
    "this takes it into regions of everincreasing @xmath303 , and weights quickly become randomized . for slightly larger parameters @xmath75 , the @xmath285 evolution takes trajectories to a point lying far into the negative @xmath300 region where the two leading terms balance . here",
    "the trajectories sit , and quickly accumulate weight noise .",
    "it is clear that for an optimum simulation all stationary points of @xmath285 in the nonzero gauge region must be removed . in this system",
    "this condition is @xmath304    an example has been plotted in fig .",
    "[ oml ] where we have parameters @xmath305 , @xmath306 ( leading to @xmath307 and @xmath308 ) .",
    "we are considering an initial condition of @xmath309 , which is already much larger than the canonical variance for physically likely parameters .",
    "typical values of @xmath270 initially will be of order @xmath310 here .",
    "a good choice of gauge has @xmath311 .",
    "the use of this gauge clearly restores the correct results .    , @xmath312 .",
    "_ dashed line _ : ( correct ) positive p simulation with @xmath313-function initial conditions ( [ deltap ] ) @xmath314 and @xmath241 trajectories . _",
    "dotted - dashed line _ : erroneous positive - p simulation with gaussian initial conditions ( [ varini ] ) @xmath315 initially , and @xmath241 trajectories .",
    "_ dotted line _ : positive - p simulation with @xmath316 , and @xmath317 trajectories . _",
    "solid line _ : gauge calculation for @xmath315 with @xmath318 , which corrects the systematic error of the positive p. only @xmath319 trajectories , so as not to obscure other data .",
    "step size in all cases is 0.005 .",
    "[ oml],width=325 ]      as we increase the spread of the initial distribution beyond @xmath320 , it becomes increasingly difficult to find a gauge that will give reasonable simulations .",
    "( for example we have tried a wide variety of what seemed like promising gauges for @xmath321 , with the above values of parameters @xmath322 and @xmath256 , and none have come close to success ) .",
    "the problem is that while we can remove systematic errors , large random noise appears and obscures whatever we are trying to calculate .",
    "trajectories that start off at a value of @xmath270 lying significantly beyond @xmath263 require a lot of modification to their subsequent evolution to ( 1 ) stop them from escaping to @xmath301 and ( 2 ) move them out of the gauged region of phase space so that they do not accumulate excessive weight noise .",
    "if there are many of these , the trade - off between the gauge size and length of time spent in the gauged region does not give much benefit anymore .",
    "nevertheless , one may be sure that if this is the case , results will at worst be noisy and unusable , rather than being systematically incorrect .",
    "we stress again that this whole matter of non - optimal initial conditions is not a major hurdle to dynamical simulations because a compact starting distribution is generally found very easily .",
    "the positive - p representation is well suited to complex quantum mechanical problems , such as many - body systems , but has been known for about a decade to have systematic errors in some cases of its use  due to non - vanishing boundary terms .",
    "the gauge p representation , a variant on the usual positive - p representation , can be used to eliminate boundary terms and consequently all the systematic errors that were encountered previously .",
    "it can also reduce sampling error in a simulation , and allows ` imaginary time ' calculations of thermal equilibrium states .",
    "the fact that correct results are immediately obtained in every case where systematic errors were found with the positive - p method , is strong evidence that these previous problems were indeed due to boundary terms caused by moving singularities in the analytically continued deterministic equations . of course",
    ", boundary terms can occur for other reasons ( for example , if the noise term grows too rapidly with radius ) , so caution is still needed in the gauge choice .",
    "the technique appears to be broadly applicable , and only requires the recognition of what instabilities in the stochastic equations could lead to problems .",
    "it does not require detailed knowledge of what the boundary terms are , provided instabilities are removed .",
    "however , we remark here that the general specification of necessary and sufficient conditions to eliminate boundary terms remains an open problem , and clearly requires growth restrictions on the gauge terms , both in phase space and quantum - amplitude space .",
    "care is also required with the choice of the gauge and initial distribution . however , using unsuitable gauges or initial conditions may only lead to large sampling errors , not systematic errors , provided the gauge is chosen to eliminate boundary corrections in the first place .",
    "sampling error then allows for a confident assessment of the magnitude of inaccuracies in a simulation , which can be supplemented by numerical analysis of the distribution tails .",
    "the main conclusion we come to is that this method does , in the cases studied , provide a complete solution to the problem of simulation of a many - body quantum system in phase space , under conditions where previous direct simulation techniques were not practicable .",
    "all known technical requirements on the path to obtaining a stochastically equivalent description to quantum mechanics , which is applicable to both large and small particle numbers , have been satisfied by this method .",
    "for this reason , we believe that gauge simulations can be used to simulate many quantum systems without systematic errors when carrying out more difficult calculations , where no exact result is known .",
    "these conclusions must be supplemented by the detailed study of relevant gauges for particular quantum systems .",
    "we note , however , that the mathematical techniques employed here for generating stochastic gauges , may well be useful for other representations as well as the gauge p representation described here .",
    "numerical calculations were carried out using open software from the xmds project @xcite .",
    "thanks to the australian research council and the alexander von humboldt - stiftung for providing research support .",
    "we thank damian pope for suggesting the name stochastic gauges .",
    "recently , carusotto , castin , and dalibard @xcite ( ccd ) have made related extensions to the positive - p representation .",
    "these were derived for the particular case of an interacting scalar bose gas , and led to a number of conditions for an ito stochastic evolution to be equivalent to a master equation evolution .",
    "it can be shown quite simply that the equations ( [ gaugeeq ] ) generated by the gauge p representation for this hamiltonian satisfy the ccd conditions .",
    "we conjecture that these provide the most general possible solution to the stochastic problem posed by these authors .",
    "in particular , @xmath323 $ ] , using the above paper s formalism .",
    "our methods can also treat a much larger class of hamiltonians and master equations than considered in the ccd treatment .      as an example , following the ccd procedure @xcite for a one - mode two - boson absorber master equation , as in eq .",
    "( [ 12pdmaster ] ) with @xmath190 , one arrives at the conditions @xmath324 where ( referring back to the notation in this present paper ) , @xmath325 = & f dt + db \\ , \\ , .\\end{aligned}\\ ] ] it can be seen that the positive - p equations ( [ 12pdposp ] ) satisfy these conditions , while producing the erroneous evolution seen in fig .",
    "[ 2pd - exact+posp+gauge ] . in summary ,",
    "the methods of the ccd paper do not obviate the need to choose gauges that eliminate boundary terms .      in ref .",
    "@xcite , plimak , olsen and collett have found that for some systems ( the kerr oscillator @xmath326 , in particular ) , the most obvious ( diagonal ) choice of noise matrix @xmath72 may not be the optimal one .    for example , for the above hamiltonian , one finds that the diffusion matrix ( in @xmath327 ) variables is @xmath328 = bb^{t}\\ , \\ , .\\ ] ] following the procedure in eq .",
    "( [ transform - b ] ) , an equivalent but broader choice of noise matrix @xmath72 can be any of @xmath329 \\ , \\ , , \\ ] ] with the usual diagonal decomposition given by @xmath330 .    however , in ref .",
    "@xcite it was found that for a positive - p simulation , different decompositions with nonzero constant @xmath331 gave the lowest sampling error for coherent state initial conditions . in their notation , they introduce @xmath332 , and consider the case of real @xmath333 ( i.e. , imaginary @xmath331 ) only .      in ref .",
    "@xcite , the sampling error in a kerr oscillator simulation  equivalent to a one - mode bec model , apart from linear terms  was reduced substantially by using a representation similar to the gauge p representation formally introduced here .",
    "the basic differences were the following .    1 .   instead of a complex gauge @xmath33 ,",
    "a phase factor @xmath334 with a real @xmath335 variable , was used .",
    "the normalization with respect to the behavior of @xmath335 was carried out explicitly inside the kernel , rather than post - simulation in the moments as in eq .",
    "( [ moments ] ) .",
    "this type of representation is a norm - preserving gauge p representation , as discussed earlier .",
    "a parametrized family of gauges led to stable trajectories ( as opposed to the large sampling error present with a positive - p simulation ) .",
    "however , some systematic errors were seen due to boundary terms .",
    "these boundary terms occurred because of the stochastic growth of the gauge term in @xmath247 space , when @xmath335 approached @xmath336 . with the gauge p representation introduced in this paper , a wide range of gauges",
    "do not lead to any systematic errors @xcite , provided gauge growth is controlled .",
    "we note here that the norm - preserving gauges have the property that , in the present notation , @xmath337f_{k } $ ] .",
    "however , while the growth of @xmath160 is stabilized , there is growth in the variance of @xmath338 .",
    "this means that the function @xmath172 must behave as a decreasing function of @xmath338 in order to ensure that the distribution is bounded sufficiently in the weight - function space to avoid finite boundary terms .",
    "the detailed requirements and conditions for this type of gauge will be treated elsewhere .",
    "10 s. chaturvedi , p. d. drummond , and d. f. walls , j. phys . a * 10 * , l187 ( 1977 ) ; p.  d.  drummond and c.  w.  gardiner , j.  phys .",
    "a * 13 * , 2353 ( 1980 ) .",
    "p.  deuar and p.  d.  drummond , comput .",
    ".  comm . *",
    "142 * , 442 ( 2001 ) .",
    "p.  d.  drummond and p. deuar ( to be published ) .",
    "a.  m.  smith and c.  w.  gardiner , phys .",
    "a * 39 * , 3511 ( 1989 ) .",
    "r.  schack and a.  schenzle , phys .",
    "a * 44 * , 682 ( 1991 ) .",
    "a.  gilchrist , c.  w.  gardiner , and p.  d.  drummond , phys .",
    "3014 ( 1997 ) . i. carusotto , y. castin , and j. dalibard ,  phys .",
    "a * 63 * , 023606 ( 2001 ) .",
    "i. carusotto and y. castin , j. phys .",
    "b * 34 * , 4589 ( 2001 ) .",
    "l. i. plimak , m. k. olsen , and m. j. collett , phys .",
    "a * 64 * , 025801 ( 2001 ) .",
    "k.  g.  wilson , phys .",
    "d * 10 * , 2445 ( 1974 ) ; m. creutz , phys .",
    "d * 21 * , 2308 ( 1980 ) .",
    "e. l. pollock and d. m. ceperley ,  phys .",
    "b * 30 * , 2555 ( 1984 ) ; d.  m.  ceperley , rev .  mod",
    "* 67 * , 279 ( 1995 ) ; d.  m.  ceperley , rev .  mod .  phys . *",
    "71 * , s438 ( 1999 ) .",
    "r.  p.  feynman , int .",
    "j.  theor .",
    "* 21 * , 467 ( 1982 ) .",
    "the current maximum size is 7 quantum bits in a dissipative , non - scalable technology , giving a hilbert - space dimension of 128 without error correction .",
    "see  l. m. k. vandersypen , m. steffen , g. breyta , c. s. yannoni , m. h. sherwood , and i. l. chuang , nature * 414 * , 883 ( 2001 ) .",
    "j. von neumann , _ mathematical foundations of quantum mechanics _ translated from the german edition by robert t. beyer ( princeton university press , princeton , n.j . , 1983 ) .",
    "e.  p.  wigner , phys .  rev . *",
    "40 * , 749 ( 1932 ) .",
    "r.  j.  glauber , phys .",
    "rev . * 131 * , 2766 ( 1963 ) .",
    "e.  c.  g.  sudarshan , phys .",
    "* 10 * , 277 ( 1963 ) .",
    "k.  husimi , proc .",
    "* 22 * , 264 ( 1940 ) .",
    "k.  e.  cahill and r.  j.  glauber , phys .",
    "rev . * 177 * , 1882 ( 1969 ) .",
    "m.  j.  steel , m.  k.  olsen , l.  i.  plimak , p.  d.  drummond , s.  m.  tan , m.  j.  collett , d.  f.  walls , and r.  graham , phys .",
    "a * 58 * , 4824 ( 1998 ) .",
    "s.  j.  carter , p.  d.  drummond , m.  d.  reid , and r.  m.  shelby , phys .  rev .  lett . * 58 * , 1841 ( 1987 ) ; p.  d.  drummond and s.  j.  carter , j.  opt .",
    "b * 4 * , 1565 ( 1987 ) ; p.  d.  drummond , r.  m.  shelby , s.  r.  friberg , and y.  yamamoto , nature * 365 * , 307 ( 1993 ) .",
    "s.  j.  carter and p.  d.  drummond , phys .",
    "lett * 67 * , 3757 ( 1991 ) .",
    "m.  j.  werner , phys .",
    "rev .  a * 54 * , r2567 ( 1996 ) .",
    "p.  d.  drummond and j.  f.  corney , phys .",
    "a * 60 * , r2661 ( 1999 ) .",
    "m.  h.  anderson , j.  r.  ensher , m.  r.  matthews , c.  e.  wieman , and e.  a.  cornell , science * 269 * , 198 ( 1995 ) .",
    "c.  c.  bradley , c.  a.  sackett , j.  j.  tollett , and r.  g.  hulet , phys .",
    "lett . * 75 * , 1687 ( 1995 ) .",
    "k.  b.  davis , m.  -o .",
    "mewes , m.  r.  andrews , n.  j.  van  druten , d.  s.  durfee , d.  m.  kurn , and w.  ketterle , phys .  rev",
    "* 75 * , 3969 ( 1995 ) .",
    "j.  r.  klauder and e.  c.  g.  sudarshan , _ fundamentals of quantum optics _",
    "( benjamin , new york , 1970 ) .",
    "l. arnold , _ stochastic differential equations : theory and applications _",
    "( wiley , new york , 1974 ) ; c. w. gardiner , _ handbook of stochastic methods _ , 2nd ed .",
    "( springer , berlin , 1985 ) .",
    "r. graham , z. phys .",
    "b * 26 * , 281 ( 1977 ) ; h. leschke and m. schmutz , z. phys .",
    "b * 27 * , 85 ( 1977 ) .",
    "s. caratzoulas and p. pechukas , j. chem . phys . *",
    "104 * , 6265 ( 1996 ) .",
    "p.  d.  drummond and i.  k.  mortimer , j.  comput .",
    "phys . * 93 * , 144 ( 1991 ) .",
    "p.  deuar and p.  d.  drummond ( to be published ) . for a recent treatment , see , e.g. , a.  j.  leggett , rev .",
    "phys * 73 * , 307 ( 2001 ) .",
    "i.  j.  d.  craig and k.  j.  mcneil , phys .",
    "a * 39 * , 6267 ( 1989 ) .",
    "k.  j.  mcneil and i.  j.  d.  craig , phys .",
    "a * 41 * , 4009 ( 1990 ) . c.  w.  gardiner , a.  gilchrist , and p.  d.  drummond , in _ using the positive p representation _ , edited by f.  ehlotzky , lecture notes in physics , vol .  420 ( springer - verlag , berlin , 1993 ) , p.  239 . and ",
    "http://www.physics.uq.edu.au/xmds/ [ http://www.physics.uq.edu.au/xmds/ ]"
  ],
  "abstract_text": [
    "<S> p representation techniques , which have been very successful in quantum optics and in other fields , are also useful for general bosonic quantum dynamical many - body calculations such as bose - einstein condensation . </S>",
    "<S> we introduce a representation called the gauge p representation which greatly widens the range of tractable problems . </S>",
    "<S> our treatment results in an infinite set of possible time - evolution equations , depending on arbitrary gauge functions that can be optimized for a given quantum system . in some cases </S>",
    "<S> , previous methods can give erroneous results , due to the usual assumption of vanishing boundary conditions being invalid for those particular systems . </S>",
    "<S> solutions are given to this boundary - term problem for all the cases where it is known to occur : two - photon absorption and the single - mode laser . </S>",
    "<S> we also provide some brief guidelines on how to apply the stochastic gauge method to other systems in general , quantify the freedom of choice in the resulting equations , and make a comparison to related recent developments . </S>"
  ]
}