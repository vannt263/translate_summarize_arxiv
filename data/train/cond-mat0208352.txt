{
  "article_text": [
    "we shall assume here that there exist a finite number of relevant collective coordinates @xmath0 where @xmath1 is a small number , and we consider the dependence of the free energy @xmath2 on these parameters .",
    "practical examples of appropriate choices of these variables will be given below .",
    "the exploration of the fes is guided by the forces @xmath3 . in order to estimate these forces efficiently ,",
    "we introduce an ensemble of @xmath4 replicas of the system , each obeying the constraint that the collective coordinates have a pre - assigned value @xmath5 , and each evolved independently at the same temperature @xmath6 .",
    "since the @xmath4 replicas are statistically independent , the estimate of thermodynamic observables ( e.g. the forces on the constraints ) is improved with respect to an evaluation on a single replica , and it can be parallelized in a straightforward manner .",
    "the constraints are imposed on each replica via the standard methods of constrained molecular dynamics@xcite by adding to the lagrangean a term @xmath7 , where @xmath8 are lagrange multipliers .",
    "averaging over the time and over the replicas we can evaluate the derivative of the free energy relative to the @xmath9 s as @xmath10@xcite . for the sake of simplicity we neglect here the small kinematic correction term discussed in ref .",
    "@xcite , although this can easily be added .",
    "taking a cue from the work of gear and kevrikidis@xcite , we use these forces , determined by a microscopic dynamics , to define a coarse - grained dynamics in the space of the @xmath11 s . in our case",
    "the definition of this dynamics is rather arbitrary and designed only to explore the fes efficiently .",
    "the dynamics is defined from the discretized evolution equation : @xmath12 in eqn .",
    "( [ dyn ] ) we have introduced the scaled variables @xmath13 and the scaled forces @xmath14 , where @xmath15 is the estimated size of the fes well in the direction @xmath11 , @xmath16 is the modulus of the n - th dimensional vector @xmath17 and @xmath18 is a dimensionless stepping parameter . it should be stressed that eqn .",
    "( [ dyn ] ) has the form of a steepest descent equation in the direction given by the forces @xmath19 , and does not imply any real dynamical evolution . the index @xmath20 is only used to label the states . after the collective coordinates are updated using eqn .",
    "( [ dyn ] ) , a new ensemble of replicas of the system with values @xmath21 is prepared , and new forces @xmath22 are calculated for the next iteration . at the same time",
    "the driving forces are evaluated from the microscopic hamiltonian in short standard microscopic molecular dynamics runs .",
    "since there is no dynamical continuity between the @xmath4 replicas at different iterations , one can use large values of @xmath18 and move very efficiently in the space of the collective coordinates .",
    "clearly eqn .",
    "( [ dyn ] ) alone can not guarantee an efficient exploration of the fes , nor is it useful to determine the fes .",
    "this task can be achieved if we replace the forces in eqn .",
    "( [ dyn ] ) with a history - dependent term@xcite :    @xmath23    where the height and the width of the gaussian w and @xmath18 are chosen in order to provide a reasonable compromise between accuracy and efficiency in exploring the fes , as we will show below .",
    "the component of the forces coming from the gaussian will discourage the system from revisiting the same spot and encourage an efficient exploration of the fes . as the system diffuses though the fes",
    ", the gaussian potentials accumulate and fill the fes well , allowing the system to migrate from well to well . after a while",
    "the sum of the gaussian terms will almost exactly compensate the underlying fes well .",
    "a typical example of this behaviour is shown in figure 1 , in which a dynamics in eqn .",
    "( [ dyn ] ) is used to explore a one - dimensional potential energy surface ( pes ) @xmath24 with three wells .",
    "the dynamics starts from a local minimum that is filled by the gaussians in @xmath25 20 steps .",
    "then the dynamics escapes from the well from the lowest energy saddle point , filling the second well in @xmath25 80 steps .",
    "the second highest saddle point is reached in @xmath25 160 steps , and the full pes is filled in a total of @xmath25 320 steps .",
    "hence , in the case of this example , since the form of the potential is known , it can be verified that , for large t and if the width of the gaussians is sufficiently small with respect to the length of a typical variation of v , @xmath26 modulus an additive constant .",
    "the same property can be verified for any multidimensional potential if the variables @xmath27 are allowed to vary in a finite region .",
    "hence , we assume that eqn .",
    "( [ fes ] ) holds also if the method is used to explore the fes , and that the free energy can be estimated from eqn .",
    "( [ fes ] ) for large t. this procedure resembles the algorithm recently proposed by wang and landau@xcite , in which a time - dependent bias is introduced in order to modify the density of states to produce locally flat hystograms .",
    "we observe an interesting isomorphism between our dynamics and the ordered deposition of the beads of a polymer chain on the fes .",
    "in fact we can regard @xmath28 as the position of a monomer in the n - dimensional parameter space .",
    "each monomer is held at a distance @xmath29 from the previous one and monomers repell each other with the gaussian term of eqn .",
    "( [ gauss ] ) . neglecting terms of order @xmath30 each monomer is placed by eqn .",
    "( [ dyn ] ) in the position of free enegy minimum compatible with the requirement of minimum overlap with previous beads .",
    "hence , the polymer chain generated in this manner fills the wells in the fes .",
    "this isomorphism helps to clarify how our approach works and why it can be made more precise by reducing @xmath31 .    the efficiency of the method in filling a well in the pes ( or in the fes )",
    "can be estimated by the number of gaussians that are needed to fill the well .",
    "this number is proportional to @xmath32 , where n is the dimensionality of the problem .",
    "hence , the efficiency of the method scales exponentially with the number of dimensions involved .",
    "if n is large , the only way to obtain reasonable efficiencies is to use gaussians with a size comparable to that of the well . on the other hand , a sum of gaussians can only reproduce features of the fes on a scale larger than @xmath33 .",
    "a judicious choice of @xmath34 , w and @xmath18 will ensure the right compromise between accuracy and sampling efficiency , and the optimal height and width of the gaussians are determined by the typical variations of the fes .",
    "if prior information on the nature of the free - energy well is not available , the scaling parameters @xmath35 are chosen by performing short coarse - grained dynamic runs without bias potential ( see eqn .",
    "( [ dyn ] ) ) .",
    "in such a case the system moves around the minimum .",
    "the scaling parameters are chosen so that the elongations have approximately the same value in all directions .",
    "this amounts to an empirical form of preconditioning which makes the fes minimum nearly spherical in n dimensions and easy to fill with n - dimensional gaussians .",
    "the metastep length @xmath31 determines the efficiency of the method in a manner that is exponential in @xmath1 and it should be made as large as possible .",
    "however , the dynamics in eqn .",
    "( [ dyn ] ) is able to reconstruct details of the fes only on the length scale of @xmath31 .",
    "moreover , an over - large value of @xmath31 would cause the system to jump irregularly from one basin to the other .",
    "the value of @xmath31 is chosen requiring the metatrajectory to remain localized in the fes minimum if the bias potential is not applied . with this choice of @xmath31 , a single step of the dynamics in eqn .",
    "( [ dyn ] ) can not lead a system from a fes minimum to another , and the initial state at each new iteration can be generated from the last md step of the previous iteration without creating major overlaps . since the shake algorithm is used to impose a new set of @xmath36 values , large forces on the constraints are generated at the beginning of each microscopic dynamics , and the initial part of the trajectory has to be discarded for the calculation of @xmath37 .",
    "the height of the gaussians @xmath38 can be estimated as follows .",
    "we notice that we want to reach a situation in which the modified fes is flat .",
    "in such a case the forces coming from the fes and that coming from the gaussian approximately balance each other . if we require the maximum value of the gaussian forces to be smaller than the typical fes force , we arrive at the relation @xmath39 with @xmath40 . in all cases so far studied a value of @xmath41 close to @xmath42  allows a fast escape from the local minima in the fes without significant loss of the underlying structure .    in the future adaptive ways of determining all these parameters",
    "should be considered in order to adapt the procedure in an optimal manner to the local shape of the fes .",
    "we first discuss an application of the method to the dissociation of a nacl molecule in water .",
    "the most stable state is the dissociated one , while the undissociated contact ion pair corresponds to a metastable local minimum .",
    "here we shall study how the system escapes from this metastable state .",
    "we model the system using the amber95 force field@xcite , and solvate the nacl complex in 215 tip3p water molecules with periodic boundary conditions . the electrostatic interaction between classical atoms",
    "is taken into account by the p3 m method@xcite . as collective coordinates",
    ", we use the distance @xmath43 between na and cl , and , in order to take into account the dynamics of the solvation shell during the dissociation , we also use the electric fields @xmath44 and @xmath45 on the na and on the cl due to the water molecules within @xmath46 @xmath47 of the ions . @xmath44 and @xmath45 depend significantly on the hydration pattern around the na and on the cl ion .",
    "if , for example , a hydrogen bond to one of the two ions is formed or broken , the field on the ion changes by several kcal / mol .",
    "a dynamics of the form ( [ dyn ] ) was performed on the system , with @xmath48 and @xmath49 kcal / mol .",
    "the scaling parameters @xmath15 were 0.53  , 32 and 32 kcal / mol for @xmath43 , @xmath44 and @xmath45 respectively .",
    "the forces in eqn .",
    "( [ dyn ] ) were evaluated by short md runs with a time step of 0.7 fs performed on 6 replicas of the system .",
    "the replicas were then equilibrated for 200 md steps at 300 k , and the forces evaluated by averaging over the following 500 md steps .",
    "starting from a distance of 2.6  , corresponding to a contact pair , the ions dissociate after 120 coarse - grained iterations .",
    "the dynamics was then continued for another 350 steps imposing a maximum separation of the ion pair of 5  , in order to study the structure of the free energy surface around the transition state ( see figure 2 ) .",
    "seven recrossings for the coarse - grained dynamics were observed .",
    "the transition state is located @xmath50  , @xmath51 kcal / mol and @xmath52 kcal / mol ( see figure 2 ) .",
    "the overall topology of the fes confirms the importance of the solvent degrees of freedom for describing the reaction , since the transition region is in transverse orientation relative to the axis of the coordinates@xcite , and hence neither the distance nor the fields alone can provide an exhaustive description of the dissociation .",
    "the transition barrier ( s in figure 2 ) , estimated with thermodynamic integration@xcite along @xmath43 , is of 3.3 kcal / mol .",
    "the one - dimensional free energy as a function of @xmath43 can also be obtained by integrating the three - dimensional fes ( @xmath53 ) with respect to @xmath44 and @xmath45 as @xmath54 $ ] .",
    "this leads to a barrier of 3.4 kcal / mol .",
    "hence , the method is able to reproduce the one - dimensional free energy profile estimated with thermodynamic integration .",
    "we have verified that these collective coordinates identify the transition state and the reaction coordinate also in the dynamical sense@xcite . to this effect we prepared a set of replicas of the system with the critical values of the collective",
    "we then followed the procedure described in ref.@xcite , assigning to the particles values of the velocity chosen from a maxwellian distribution at 300 k , and following the trajectory backwards and forwards in time . by this procedure",
    ", we found that , within a time scale of 200 fs , the overwhelming majority of the replicas fell into one of the two basins of attraction without any recrossing .",
    "moreover , the time - reversed dynamics leads systematically to the opposite basin of attraction@xcite .",
    "finally , if we prepare the systems with the shake algorithm@xcite for a given value of the collective coordinates , and if the particle velocities are not reassigned before letting the system evolve freely , the time needed to go in either of the attraction basins is of the order of a few ps , and several recrossings are observed .",
    "this is due to the fact that the shake algorithm imposes zero velocities in the direction of the constraint and it is only after thermalization , which takes place in a time scale of picoseconds , that the collective coordinates acquire sufficient velocity to evolve towards the fes minima .",
    "this is a strong confirmation that we have identified the correct transition state .    in order to characterize the solvent structure during the dissociation ,",
    "we have computed the na - water pair correlation function at the transition state s. the coordination number , obtained by integrating the pair correlation function up to a distance of 3  , is 5.28 .",
    "this value is consistent with the picture depicted in ref .",
    "@xcite , in which the sodium at the transition state is shown to be typically only five - fold coordinated .",
    "as a second application , we used our method to explore the free energy surface of an alanine dipeptide as a function of the backbone dihedral angles @xmath55 and @xmath56 @xcite . the system is described by the all - atom amber95 force field @xcite and solvated in 287 tip3p water molecules .",
    "the parameters of the coarse - grained dynamics of eqn .",
    "( [ dyn ] ) are @xmath48 and @xmath57 kcal / mol , while the scaling parameters @xmath15 are @xmath58 for both @xmath55 and @xmath56 .",
    "the other settings are the same as for the simulation of the na - cl complex .",
    "the fes of alanine dipeptide in water has been studied in detail by other authors@xcite , who identified several minima .",
    "our dynamics ( [ dyn ] ) is able to capture the overall features of the fes extremely quickly .     and",
    "@xmath56 for an alanine dipeptide in water after 40 , 100 and 200 steps of coarse - grained dynamics ( [ dyn ] ) .",
    "the zero of the free energy corresponds to the the state @xmath59 , located at @xmath60 and @xmath61 .",
    "the contours are plotted every 0.2 kcal / mol .",
    "the state @xmath62 is located at @xmath63 and @xmath64 and 1.3 kcal / mol .",
    "finally , the transition state between @xmath59 and @xmath62 is located at @xmath65 and @xmath66 and 3.3 kcal / mol .",
    "if the dynamics is continued , less favourable areas of the phase space are explored ( e.g. the region with @xmath67 ) , but the free energy differences reported here are unchanged within the accuracy of the calculation .",
    ", width=272 ]    starting from a configuration close to the state @xmath62@xcite , the dynamics fills this attraction basin in approximately 45 steps .",
    "the minimum is localized at @xmath68 and @xmath69 .",
    "the estimated free energy at the saddle point is 2 kcal / mol higher than the free energy in @xmath62 .",
    "this compares to a value of 2.1 kcal / mol obtained in ref .",
    "@xcite by thermodynamic integration .",
    "our estimate is obtained with 45 steps of coarse - grained dynamics on 6 replicas , corresponding to a total of only @xmath70 ps of mycroscopic dynamics .",
    "after another 150 steps , the dynamics fills the attraction basin of the state @xmath59 , which corresponds to the equilibrium configuration of the system , and recrosses to @xmath62 .",
    "finally , the dynamics visits the @xmath71 region of the configuration space after @xmath72 steps . in figure 3",
    "we plot the free energy as a function of @xmath55 and @xmath56 after 40 , 100 and 200 steps of coarse - grained dynamics .",
    "also small details of the free energy landscape , like the location of the saddle points and the presence of secondary minima ( e.g. the state @xmath73 @xcite ) , can be detected graphically after a few steps of coarse - grained dynamics .",
    "the one - dimensional free energy profile as a function of @xmath56 obtained by analytic integration of the fes reproduces the profile obtained in ref .",
    "@xcite within 0.2 kcal / mol for all the values of @xmath56 .",
    "concerning the choice of the collective coordinates for this system , it should be remarked that the dihedral angles @xmath55 and @xmath56 do _ not _ provide a complete description of the dialanine isomerization reaction@xcite , and the real reaction coordinate should take into account also the solvent degrees of freedom .",
    "still , our results show that the method is able to reproduce the overall feature of the fes even if relevant degrees of freedom are not explicitly included in the collective coordinate space .",
    "this shows that the neglected degrees of freedom , although relevant for determining the reaction coordinate , are associated with relatively small barriers and are sampled efficiently during the microscopic dynamics for each value of @xmath55 and @xmath56 , in spite of the relatively short runs .",
    "this is due to the use of the replicas and to the ability of the dynamics to retrace the same region of parameter space during the dynamics .",
    "the method is based on the combination of the ideas of coarse - grained dynamics@xcite in the space defined by a few collective coordinates , and on the introduction of a history - dependent bias@xcite . constructing a dynamics on a free energy surface that depends on a few collective coordinates , we simplify enormously the complexity of the problem , which depends exponentially on the number of degrees of freedom .",
    "the fes is much smoother than the underlying potential energy surface and it is topologically simpler , with a greatly reduced number of local minima .",
    "the history - dependent bias prevents the system from vistiting regions it has already explored .",
    "this term is crucial for the efficiency of the method : for example , a langevin dynamics in the space of the collective coordinates would provide scant information on the underlying fes and it would be slower in locating global minima . this has been checked by performing a langevin dynamics for the dissociation of a nacl molecule in water , with the same collective variables introduced in section 2 and adding to eqn .",
    "( [ dyn ] ) a gaussian noise at a temperature @xmath6 that is gradually reduced@xcite .",
    "the number of evaluations of the forces required to converge to the minimum of the fes ( i.e. the dissociated state ) is well above 1000 , if the temperature is decresed with a logarithic schedule , as required in order to ensure quasi - ergodicity in the collective coordinate space@xcite . a history dependent bias potential as defined in eqn .",
    "( [ gauss ] ) but applied in a regular md simulation without coarse graining the dynamics would be efficient in finding escapes from the local minima , at it has been shown elsewhere@xcite , but it would not provide _ quantitative _ informations about the fes .",
    "in particular , equation ( [ fes ] ) holds only because the dynamic is performed in the collective coordinates space using the derivatives of the free energy .",
    "hence , both the coarse - grained dynamics on the fes and the history - dependent bias are essential ingredients of the method , and only their combination allows an efficient and accurate determination of the fes .",
    "another advantage of our search algorithm is that it can be easily parallelized over the @xmath4 replicas , thus optimally exploiting present - day computer architectures and , moreover , does not require a very accurate determination of the forces .",
    "in fact , in model calculations on an analytic pes , we have found that the algorithm is effective even for noise levels as large as 20 - 30 % of the forces , since the height and the width of the gaussians is such that the coarse - grained dynamics explores a region of space of the size of a gaussian several times .",
    "and the system is only _ discouraged _ ( and not _ prevented _ ) from revisiting the same spot of configuration space .",
    "hence , the errors in the forces tend to even out during the evolution .",
    "the dynamics ( [ dyn ] ) is `` self - healing '' , i.e. it is in principle capable to compensate the effect of complitely wrongly located gaussians or of a wrong additional bias potential .",
    "we can therefore use quite short runs and a small number of replicas to evaluate the forces .",
    "this is at variance with thermodynamic integration@xcite and the blue moon ensemble method@xcite , where a very precise determination of the forces is needed and where treating multidimensional reaction coordinates is a daunting task .",
    "other techniques , like the umbrella sampling or bias potential methods @xcite , allow an accurate estimate of the free energy surface in many dimensions .",
    "the drawback of these methods is that they are efficient only if a good approximation for the fes is known _ a priori _ , while this is not required in our method .",
    "a last advantage of the method is its ability to provide qualitative information on the free energy of a system in a very short time .",
    "for example , the overall topology of a free energy surface can be determined by very few coarse - grained dynamics steps using `` large '' gaussians .",
    "subsequently , our `` qualitative '' knowledge of the fes can be improved using smaller gaussians , eventually reducing the dimensionality of the problem by exploiting the topological information obtained with the large gaussians .",
    "mp would like to thank yannis kevrikidis for a very illuminating discussion on the coarse - grained method , and david chandler for having patiently shared his understanding of the statistical mechanics of transition paths .",
    "al thanks joost vandevondele for many precious suggestions ."
  ],
  "abstract_text": [
    "<S> we introduce a novel and powerful method for exploring the properties of the multidimensional free energy surfaces of complex many - body systems by means of a coarse - grained non - markovian dynamics in the space defined by a few collective coordinates . </S>",
    "<S> a characteristic feature of this dynamics is the presence of a history - dependent potential term that , in time , fills the minima in the free energy surface , allowing the efficient exploration and accurate determination of the free energy surface as a function of the collective coordinates . </S>",
    "<S> we demonstrate the usefulness of this approach in the case of the dissociation of a nacl molecule in water and in the study of the conformational changes of a dialanine in solution .    </S>",
    "<S> epsf    molecular dynamics and the monte carlo simulation method have had a very deep influence on the most diverse fields , from materials science to biology , and from astrophysics to pharmacology . yet in spite of their success , these simulation methods suffer from limitations that reduce the scope of their applications . </S>",
    "<S> a severe constraint is the limited time scale that present - day computer technology and sampling algorithms explore . in particular , there are many circumstances where the free energy surface ( fes ) has several local minima separated by large barriers . </S>",
    "<S> examples of these situations include conformational changes in solution , protein folding , first order phase transitions , and chemical reactions . in such circumstances a simulation started in one </S>",
    "<S> minimum will be able to move spontaneously to the next minimum only under very favourable circumstances . a host of methods </S>",
    "<S> have been suggested in order to lift this restriction and to explore the fes @xcite , or to characterize the transition state @xcite . </S>",
    "<S> here we find a new solution to this problem by combining the ideas of coarse - grained dynamics@xcite on the fes@xcite with those of adaptive bias potential methods@xcite obtaining a procedure that allows the system to escape from local minima in the fes and , at the same time , permits a quantitative determination of the fes as a by - product of the integrated process . </S>"
  ]
}