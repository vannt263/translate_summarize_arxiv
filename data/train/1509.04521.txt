{
  "article_text": [
    "typical space applications require reorienting a spacecraft or a satellite from a given initial configuration to a given final configuration over a given duration of time . examples of such manoeuvres include positioning star sensors ( attitude estimation sensors ) towards deep space , pointing a camera in the desired direction for imaging purposes , positioning solar panels for effective tracking of the sun for optimal energy harvesting , etc  @xcite .",
    "such orientation maneuvers are popularly known as attitude maneuvers , and the class of attitude maneuvers that optimize a certain performance objective are termed optimal attitude maneuvers . in most applications ,",
    "attitude control problems are subjected to additional constraints due to actuator saturation and/or forbidden regions of the state space .",
    "control constraints are omnipresent  for instance , a momentum delivering device fitted on - board a spacecraft , e.g. , a thruster , or a reaction wheel , has limitations in terms of maximum torque produced and maximum momentum delivered . in case a spacecraft is fitted with a flexible structure like solar panels , it must inevitably have a restriction of its maximum momentum for the protection of such equipments ; such restrictions translate to state constraints in an optimal control problem .",
    "the class of constrained control problems involving orientation manoeuvres provides a rich supply of interesting and complex control problems related to space applications .",
    "few computationally tractable solutions to such problems are known today , and in this article we propose a new and promising technique to solve a class of such constrained optimal control problems .",
    "in general , computationally tractable solutions to optimal control problems subject to nonlinear dynamics are difficult to arrive at @xcite . constrained",
    "optimal attitude control problems are vastly more challenging than standard optimal control problems on euclidean spaces because ( a ) the attitude kinematic equations evolve on the manifold @xmath1 , and classical techniques developed specifically for dynamics on euclidean spaces , therefore , no longer directly apply , and ( b ) the presence of state and control constraints in the optimal control problem typically leads to two point boundary value problems ( which represents first order necessary optimality conditions , ) subject to inequality constraints , and these problems can not be solved using conventional indirect techniques such as shooting methods @xcite . in this article",
    "we provide an algorithmic solution to one such class of constrained optimal attitude control problems subject to state and control constraints , where the attitude kinematics in discrete time are treated directly on the lie group @xmath1 and are derived using discrete mechanics @xcite .",
    "constrained optimal attitude control problems treated in the literature typically fall into one of two categories : one that considers only control constraints and the other that considers state constraints in addition to control constraints .",
    "attitude control problems with control constraints have been discussed under the framework of optimal control with various performance indices involving minimization of time , fuel , and energy .",
    "a considerable body of work on the time - optimal attitude control problems exist  @xcite .",
    "fuel or energy optimal maneuvers are also of great interest since on - board energy sources are limited and precious , and there is therefore a natural necessity for using them in an optimal way  @xcite .",
    "early works on energy optimal control @xcite and fuel optimal control @xcite tackled the continuous - time optimal attitude control problem , arriving at first order necessary conditions for optimality via the pontryagin maximum principle .",
    "the resulting boundary value problems were typically solved using shooting or neighborhood extremal methods , both of which suffer from high sensitivity to initial data . in recent years , attitude control problems with joint state and control constraints have been attacked from various directions . attitude manoeuvres with joint state and control constraints , considering a linearized dynamics model is addressed in @xcite . in these works",
    "the problem is recast as a nonlinear optimization problem , and solved using direct multiple shooting methods or sequential quadratic programming @xcite . constrained",
    "attitude control problems with attitude kinematics represented in quaternion form was explored in @xcite using pseudospectral methods , and in @xcite using particle swarm optimization .",
    "representation of the attitude kinematics in quaternion form has a serious disadvantage of non - uniqueness ; consequently , boundary conditions defined for attitude kinematics do not have a unique representation in quaternions , which presents a problem during computations .",
    "another commonly used attitude representation is euler angles , which suffers from the defect of singularity @xcite . in order to avoid issues such as singularity and non - uniqueness ,",
    "geometric techniques have been developed to solve constrained attitude control problems @xcite .",
    "one such approach to attitude control problems in continuous time with control constraints is discussed in @xcite .",
    "projection operators were used there to find a search direction on the underlying lie group , while employing newton s method to solve the continuous time two point boundary value problem obtained via the pontryagin maximum principle on manifolds @xcite .",
    "a different geometric technique to attitude control problem with state and control constraints is addressed in @xcite where the authors attempted to handle state inequality constraints using penalty functions . as is well known , penalty functions",
    "do not _ enforce _ the state inequality constraints , but add penalties to the cost functions if the constraints are violated .",
    "this constrained optimal control problem leads to a two point boundary value problem that represents first order necessary optimality condition .",
    "the boundary value problem is then solved by employing indirect single shooting method .",
    "none of the these works discussed the issue of digital implementation , a key aspect of which is the process of discretization of the boundary value problems in time : euler s step and its derivatives are insufficient since these do not account for nor respect the underlying manifold structure of @xmath1 .    in this article",
    "we tackle the issue of discretization up front by deriving a discrete time model via discrete mechanics  @xcite , and then employing variational analysis to arrive at first order necessary conditions for optimality .",
    "discrete time models obtained via discrete mechanics are more accurate than other standard discretization schemes such as euler s step because they preserve certain invariance properties like kinetic energy , momentum , etc , of the system , and the computations can be done directly on the manifold @xmath1 , ( because this discretization respects the manifold @xmath1 , ) thereby eliminating the problems associated with parametric representations of attitude .",
    "the presence of state inequality constraints in our attitude control problem makes it challenging because the resulting boundary value problems obtained using variational analysis are subject to inequality constraints on the states .",
    "such constrained boundary value problems can not in general be solved using classical multiple shooting methods precisely because of those inequality constraints .",
    "a non - classical multiple shooting technique has recently been proposed in  @xcite for solving constrained boundary value problems arising in optimal control problems with state constraints . there",
    "the complementary slackness conditions arising due to inequality constraints on the states are represented in the form of equality constraints using the fischer - burmeister function  ( * ? ? ?",
    "* equation ( 2.7 ) )  a technique that can be highly inefficient in terms of computation because all the inequality constraints are considered at each iteration irrespective of them being active or not .",
    "in contrast , we propose a multiple shooting algorithm that deals with state inequality constraints in such a way that the dimension of the boundary value problem remains the same even when the state inequality constraints are active , making it more efficient in terms of time and memory complexity .",
    "we reiterate that the thrust of our contribution is towards computational tractability of optimal attitude manoeuvres .",
    "the advantages of our technique are five fold : first , the discrete time model derived via discrete mechanics avoids the need for discretization at later stages , and eliminates issues associated with parametric representations of the attitude kinematic .",
    "second , an indirect multiple shooting method , which provides more accurate solution to the problem unlike direct techniques , is employed to solve the optimal control problem .",
    "integration steps of the discrete kinematic equations represented by rotation matrices are calculated at each discrete instant , which provide exact attitude trajectories for manoeuvres unlike other standard schemes @xcite .",
    "third , the multiple shooting method that we employ here is more robust to initial guesses as compared to indirect single shooting methods that are comparable in terms of accuracy @xcite .",
    "fourth , the proposed algorithm , being a multiple shooting method , can be implemented on a parallel architecture for fast computation .",
    "fifth , the discrete time model obtained using discrete mechanics results in a boundary value problem that can be reduced to difference equations with momentum and co - momentum dynamics only .",
    "the dimension of this reduced difference equation model is half of the original one , which further contributes to savings in terms of time and memory .",
    "moreover , scaling of the co - state variables such that the co - states are invariant to step length selected for a given manoeuvre , improves the radius of convergence of the multiple shooting algorithm .",
    "this article unfolds as follows : in  [ s : dis_mod ] we employ discrete mechanics to derive a discrete time model of the attitude dynamics . in  [ s : ocdtad ] the energy optimal control problem is posed as a discrete time optimal control problem , and first order necessary conditions are obtained using variational analysis",
    ". then we discuss scaling of the variables and reduction of the dynamics to momentum and co - momentum variables in ",
    "[ s : smr ] .  [ s : msm ] contains an introduction to multiple shooting methods , and provides a solution to the system of difference equations represented in momentum variables presented in ",
    "[ s : smr ] .",
    " [ s : nsr ] provides the numerical experiments for large angle manoeuvres with momentum and control constraints .",
    "we conclude in  [ s : cfd ] with a brief discussion of future work .",
    "the proofs of our results are presented in a consolidated fashion in the appendices .",
    "this section contains the modeling of the attitude dynamics of the spacecraft using discrete mechanics @xcite . in most optimal control problems involving mechanical systems ,",
    "some sort of discretization is performed in order to employ numerical techniques . in the case of discrete mechanics ,",
    "the variational description is directly discretized , and discrete time equations are obtained .",
    "this approach is advantageous in comparison to usual discretizations of continuous time models because it preserves certain invariants of the system such as momentum and energy .    for ease of understanding , a quick introduction to discrete mechanics",
    "is given here , followed by discrete time modeling of the attitude dynamics of the spacecraft .",
    "consider a mechanical system with the configuration space @xmath2 as a smooth manifold .",
    "then the velocity vectors lie on the tangent bundle @xmath3 of the manifold @xmath2 and the lagrangian for the system can be defined as @xmath4  @xcite . in discrete mechanics ,",
    "the velocity phase space @xmath3 is replaced by @xmath5 which is locally isomorphic to @xmath3 .",
    "let us consider an integral curve @xmath6 in the configuration space such that @xmath7 and @xmath8 , where @xmath9 represents the integration step .",
    "then , the discrete lagrangian @xmath10 which is an approximation of the action integral along the integral curve segment between @xmath11 and @xmath12 can be defined as  @xcite @xmath13 pick @xmath14 , ( this quantity plays the role of step length ) and consider a grid of the time domain @xmath15 as @xmath16 and the corresponding discrete path space @xmath17 .",
    "the discrete trajectory @xmath18 is such that @xmath19 .",
    "now , defining the discrete action sum @xmath20 as @xmath21 assuming @xmath22 and @xmath23 fixed , define the variations @xmath24 as @xmath25 which vanishes at the end points @xmath26 .",
    "a discrete path @xmath27 is a stationary point of the discrete action sum @xmath20 if @xmath28 for all @xmath24  @xcite .",
    "this is equivalent to saying that the points @xmath29 of the path @xmath27 satisfies the discrete euler - lagrange equations , i.e. , @xmath30 where @xmath31 is the derivative of the function with respect to the @xmath32th argument .",
    "+ notice that involves @xmath33 at @xmath34th instant of time , which means that the difference equations obtained are of second order .",
    "to arrive at the discrete time model with first order difference equations , one needs to use the discrete time analogue of the hamiltonian formulation . to this end ,",
    "recall that the continuous time legendre transform is a map @xmath35 from the lagrangian state space @xmath3 to the hamiltonian phase space @xmath36 .",
    "similarly , the discrete time legendre transforms @xmath37  @xcite can be defined as @xmath38 which are maps from the discrete lagrangian state space @xmath39 to the discrete hamiltonian phase space @xmath40 .",
    "the map @xmath41 is the forward discrete legendre transform which relates @xmath42 to @xmath43 , and the map @xmath44 is the backward discrete legendre transform which relates @xmath42 to @xmath45 . let the discrete lagrangian map @xmath46 be defined as @xmath47 ; it defines the evolution of the dynamics on the discrete state space",
    ". then the corresponding discrete hamiltonian map @xmath48 can be defined in the following equivalent ways  @xcite : @xmath49 this is clear from the commuting diagram shown in figure [ fig : comdiag ] .",
    "\\(1 ) @xmath50 ; ( 4 ) [ below right of=1 ] @xmath51 ; ( 2 ) [ above right of=4 ] @xmath52 ; ( 3 ) [ below left of=1 ] @xmath53 ;    \\(5 ) [ below right of=2 ] @xmath54 ; ( 1 ) edge node [ left ] @xmath55 ( 3 ) edge node[right ] @xmath56 ( 4 ) edge node[above ] @xmath57 ( 2 ) ( 2 ) edge node [ left ] @xmath55 ( 4 ) edge node[right ] @xmath56 ( 5 ) ( 3 ) edge node [ above ] @xmath58 ( 4 ) ( 4 ) edge node [ above ] @xmath58 ( 5 ) ;    the discrete hamiltonian map is defined in coordinates as follows : @xmath59      we now apply the ideas introduced in  [ ss : dis_intro ] to obtain the discrete equations of the attitude dynamics of a spacecraft .",
    "first , the lagrangian in continuous time is described , and then an approximation of the continuous time lagrangian is taken to define the discrete lagrangian . thereafter , the discrete time attitude dynamics is obtained using discrete hamiltonian formulation .",
    "consider a rigid body with a point , typically chosen to be center of mass , fixed on it .",
    "in order to define the orientation of a rigid body , two coordinate systems are considered with the origin at that fixed point .",
    "one frame fixed to the rigid body is known as the body frame , and the other is a frame fixed in space , known as the spatial frame .",
    "let @xmath60 be the position of the mass element in the body frame .",
    "then the position of the mass element in reference frame @xmath61 is related to the body frame coordinates @xmath60 by the rotation matrix @xmath62 as @xmath63 .",
    "let @xmath64 be the region occupied by the body in its reference frame .",
    "let @xmath65 be the density of the rigid body in the body coordinates at point @xmath60 .",
    "then the kinetic energy of the rigid body is  @xcite : @xmath66 which can be rewritten , in view of the left - invariance of the kinetic energy @xcite , as @xmath67 we know that the spatial angular velocity vector @xmath68 can be represented in terms of the body angular velocity vector @xmath69 as @xmath70 then @xmath71 let @xmath72 be a vector space homeomorphism .",
    "then , from we arrive at the kinematic relation @xmath73 the lie algebra of @xmath1 .",
    "so , the kinetic energy can be represented in terms of the spatial frame angular velocity as @xmath74 where @xmath75    the body moment of inertia matrix @xmath76 is related to @xmath77 by the following equation  @xcite : @xmath78 if the dissipative and potential forces are absent , then the lagrangian @xmath79 for the system is given by  @xcite @xmath80 by the kinematic relation @xmath81 given above , we know that @xmath82 .",
    "so , the lagrangian can be written as @xmath83 we now proceed to discretize the lagrangian . considering discrete time instants @xmath84 such that @xmath85 and the approximation @xmath86   $ ]  @xcite , the discrete lagrangian @xmath87 is defined as : @xmath88 where @xmath89 .",
    "note that under the discretization technique employed , the discrete lagrangian , like its continuous counterpart , is invariant under the action of the so(3 ) group .",
    "this property will be useful later when momentum equations will be derived and the rotation sequence constructed based on the momentum history .",
    "our objective is to come up with first order difference equations describing the attitude dynamics of the spacecraft . by the left trivialization of the cotangent bundle of a lie group ,",
    "@xmath90 can be represented as @xmath91 , where @xmath92 denotes the dual of the lie algebra @xmath93  @xcite .",
    "we now proceed to find the discrete time hamiltonian map @xmath94 such that @xmath95 in order to find @xmath96 and @xmath97 , the variations in @xmath98 are defined in terms of @xmath99 , and the expressions @xmath100 and @xmath101 are evaluated using the duality product on @xmath93  @xcite . + for a given @xmath102 and @xmath103 , the variation in @xmath98 can be defined as @xmath104 then the duality product of @xmath105 and @xmath106 is defined as @xmath107 hence , @xmath108 which means that @xmath109 is a symmetric matrix .",
    "its skew - symmetric part is , therefore zero , and this leads to @xmath110 similarly , the duality product of @xmath111 and @xmath112 gives , @xmath113 and @xmath114 which means that @xmath115 is a symmetric matrix with its skew - symmetric part equal to zero .",
    "therefore , @xmath116 leading to the following update equation for the momentum : @xmath117 in the presence of control , modifies to @xmath118 where @xmath119 is the control input at @xmath34th instant of time .",
    "the rigid body equations in discrete time are finally obtained as : @xmath120",
    "we state the optimal control problem arising in executing energy optimal attitude manoeuvres of a spacecraft . the spacecraft is assumed to have three actuators , aligned along the three principal moment of inertia axes .",
    "each actuator has its individual saturation limits .",
    "the objective is to find the energy optimal control profile for orienting the spacecraft from an initial configuration to a desired configuration in a given duration of time , while obeying pre - specified momentum bounds .",
    "first we pose this requirement as an optimal control problem , and then derive the first order necessary optimality conditions using variational analysis . later  [ ssec : msmad ] the boundary value problem obtained as the first order necessary conditions will be solved using a novel multiple shooting method .",
    "our objective is to find the energy optimal control law to manoeuvre a spacecraft from the initial configuration @xmath121 to the final configuration @xmath122 in @xmath123 discrete time steps satisfying the following constraints :    1 .",
    "@xmath124 2 .",
    "@xmath125    this problem can be posed as an optimal control problem in discrete time as follows : @xmath126 subject to @xmath127 note that the optimal control problem has both control and state inequality constraints . while the individual control inputs are constrained in magnitude ,",
    "the performance measure reflects a 2-norm on the control action at each stage .",
    "we represent the variations of @xmath128 in terms of variations in @xmath129 and then the first order necessary conditions are derived .    * * representation of the variations : * + using the variations for the matrix @xmath130 is defined as @xmath131 using the property @xmath132 , simplifies to @xmath133 where @xmath134 similarly , for a given @xmath135 we define the variation in @xmath136 as @xmath137 the implicit equation @xmath138 in gives the relation between momentum and change in orientation at @xmath34th time instant .",
    "so , the relation between the variations in momentum @xmath139 and @xmath140 can be obtained from the implicit equation as  @xcite @xmath141 which can be further simplified using @xmath142{i_{3\\times 3}}-a\\right\\}x\\right)^\\wedge $ ] to @xmath143 + lemmainvfkjd [ lemma : invfkjd ] the matrix @xmath144 is invertible if @xmath145 where @xmath146 , and @xmath147 + we present a proof of lemma [ lemma : invfkjd ] in appendix [ app : invfkjd ] .",
    "armed with lemma [ lemma : invfkjd ] , we represent the vector @xmath148 in terms of the variations in momentum i.e. @xmath139  @xcite as @xmath149 where @xmath150 * * necessary optimality conditions : * + let @xmath151 and @xmath152 be the lagrange multipliers corresponding to the equality constraints @xmath153 and @xmath154 respectively . similarly let @xmath155 and @xmath156 be the lagrange multipliers corresponding to the inequality constraints @xmath157 .",
    "let us justify why the lagrange multiplier @xmath151 is chosen corresponding to the rotational kinematics @xmath153 .",
    "rotational kinematics can be rewritten as @xmath158 , where @xmath128 can be identified by its skew symmetric part , which in turn can identified by a vector in @xmath159  @xcite .",
    "+ claimfskew [ claim : fskew ] consider the equality @xmath160 .",
    "if we assume that the step length @xmath9 is small enough such that the relative orientation @xmath161 between two adjacent time instances @xmath162 and @xmath163 is less than @xmath164 i.e. , @xmath165 then the aforementioned equality is satisfied if and only if the skew symmetric parts of both sides are identical .",
    "+ the augmented performance index can be defined as @xmath166 where @xmath167 + using , and , the infinitesimal variation of the augmented performance index is defined as @xmath168 where @xmath169 together with the complementary slackness conditions @xmath170 employing the property that @xmath171{i_{3\\times 3}}-a\\right)x\\right\\}^\\wedge $ ] and that the variation on the boundary is zero , i.e. , @xmath172 , we rearrange the terms of the expression @xmath173and get the following expression after standard algebraic manipulations : @xmath174 by first order necessary condition of optimality , @xmath175 along all possible variations @xmath176 , and we obtain the co - state equations from as : @xmath177 and the optimality condition for the control as @xmath178 from we know that if @xmath179 lies in the interior of the feasible region @xmath180 , then @xmath181 .",
    "so , by we have @xmath182 . on the other hand if @xmath183 then by and we have @xmath184 . similarly for @xmath185 , we have @xmath186 .",
    "hence , the optimal control can be written in a compact form as @xmath187    we represent the state and co - state dynamics in terms on momentum and co - state corresponding to momentum variables .",
    "this technique will reduce the model of the system and hence the algorithm will perform better in terms of memory and time requirement .",
    "the orientation boundary constraints @xmath188 can be represented in terms of @xmath189 which in turn can be computed for a given @xmath129 using the implicit form @xmath190 we represent orientation constraints first in terms of @xmath128 and then we discuss a technique for computing @xmath128 for a given value of @xmath129 .",
    "we represent the boundary constraints on orientation @xmath188 in terms of @xmath128 . then using we reconstruct the orientation @xmath98 variables",
    ", we see that @xmath191 can be represented in terms of @xmath128 for @xmath192 as @xmath193 the boundary constraints of orientation can be rewritten as : @xmath194 to represent the constraints in vector form , we have nine equations . from",
    "we know that the number of free variables corresponding to orientation kinematics are actually three : @xmath195 .",
    "so , the boundary conditions have to be represented by three independent constraints .",
    "let us define the maps @xmath196 and @xmath197 .",
    "then the boundary condition is satisfied if @xmath198 we need to compute the gradient of the orientation constraints w.r.t .",
    "momentum @xmath129 .",
    "this can be done as follows : from we know that @xmath199 leading to @xmath200 after algebraic manipulations we get @xmath201 and using the property @xmath202 we conclude that @xmath203 therefore , the gradient of the orientation constraints w.r.t .",
    "momentum @xmath129 is @xmath204    we notice that the orientation constraints can be computed only when we construct the matrix @xmath128 for a given value of the momentum vector @xmath129 .",
    "similarly , the gradient of the orientation constraints can be computed only when we find the derivative of @xmath128 w.r.t .",
    "@xmath205 for @xmath206 and @xmath207      in order to calculate the orientation constraints , @xmath128 is obtained in terms of @xmath129 .",
    "we know that @xmath128 can be obtained from @xmath129 by solving the implicit equation . to solve this implicit form , we choose quaternions to parameterize the matrix @xmath128 .",
    "let @xmath209 and the inertia matrix @xmath210 and @xmath77 are defined as : @xmath211 let @xmath212 be the momentum of the body at the @xmath34th instant , and @xmath213 ; then can be represented in the form of nonlinear algebraic equations as follows : @xmath214 for a fixed value of momentum @xmath129 , the system of equation has quaternions as unknown parameters which can be numerically found using newton s method at each instant of time . since @xmath128 is represented in terms of quaternions , we first need to find the variations of the quaternions in terms of the momentum vector @xmath129 ; these can be obtained by taking derivative of w.r.t . @xmath129",
    "as @xmath215 resulting in @xmath216 where @xmath217 the matrix @xmath218 can be obtained by solving the linear system .",
    "the derivative of the matrix @xmath128 w.r.t .",
    "@xmath205 is obtained using the chain rule as @xmath219 we now discuss the reduction of the difference equation model , to the momentum and comomentum dynamics respectively and later the reduced model is scaled by change of variables so as to make the model invariant under change in the step length @xmath9 .",
    "invariance of the difference equation model means that for a particular manoeuvre the optimal trajectory and corresponding lagrange multipliers remain identical for different step lengths @xmath9 .",
    "this matter is quite essential because it largely affects the region of convergence and order of convergence of the algorithm  @xcite .",
    "first we discuss about model reduction and later scaling of the reduced model by appropriate change of variable .",
    "let us define a new variable @xmath220 then can be written as @xmath221 where @xmath222 . from",
    "we conclude @xmath223 such that @xmath224 .",
    "so and can be further reduced to the system of difference equations @xmath225 assume for the moment that for a manoeuvre the @xmath32th element of the control vector @xmath226 saturates ( i.e. , @xmath227 ) at the @xmath34th instant of time . clearly , from @xmath228 if the step length @xmath9 is small , @xmath229 will take very large values , which makes the difference equations stiff .",
    "to avoid this situation , we define a variable @xmath230 , and modify the difference equation to @xmath231 where @xmath232 note that @xmath128 and its gradient with respect to momentum can be obtained as discussed in  [ ssec : rotmtm ] . in the following section we employ multiple shooting method to solve the system of difference equations with boundary conditions and constraints .",
    "shooting methods were mainly developed for solving ordinary differential equations or difference equations with given boundary conditions .",
    "an initial guess is taken for the unknown initial values of the differential or difference equation variables .",
    "then the variables are computed at the terminal time and compared with a known value of the variables at the boundaries .",
    "then the initial guess is improved at each iteration to match with the known boundary values .",
    "the multiple shooting methods , the time domain is divided into sub - intervals ( time domain decomposition ) , and the boundary value problems are solved for each sub - interval with the condition that the boundary values at the common points of the adjacent intervals are the same .",
    "multiple shooting methods are generalizations of the single shooting method in the sense that multiple shooting with a single time interval is equivalent to the shooting method  @xcite . + multiple shooting methods have many advantages over single shooting methods .",
    "the former are more stable , and hence can be applied to stiff problems , and the time domain decomposition allows one to introduce the initial guess to the problem with prior knowledge .",
    "multiple shooting methods allow one to compute the solution of the differential equation at individual intervals , which can be very efficient in computation using parallel architecture  @xcite .",
    "multiple shooting methods constitute generalizations of the single shooting method , in which two point boundary value problems are solved at each iteration for the subintervals of time domain simultaneously .",
    "let @xmath233 let the time domain be decomposed into @xmath123 sub - interval as @xmath234 and let us consider @xmath235 variables @xmath236 known as the multiple shooting variables .",
    "these multiple shooting variables are the guessed initial values of the dependent variable @xmath61 defined in at the specified time instants .",
    "we now define initial value problems for each sub - interval as @xmath237 \\rightarrow { \\mathds{r}}^{n } \\text{\\;with}\\\\ & x^{k}(\\tau_{k})=s^{k } \\text{\\ ; for\\ ; } k=0,1,\\ldots,(n-1).\\end{aligned}\\ ] ] note that the solution @xmath238 to the initial value problems can be a solution to the boundary value problem only if the solution @xmath239 of the interval @xmath240 $ ] matches with the initial condition for the next interval i.e. @xmath241 .",
    "this condition is known as the matching condition . these matching conditions for each interval can be combined together and can be represented in stacked form as @xmath242 with @xmath243 the solution of initial value problem , and @xmath244 .",
    "the algebraic equations can be solved using newton type algorithms for multi - variable functions is described in algorithm [ alg : msm ] .",
    "choose appropriate initial guess @xmath245 and the error tolerance bound @xmath246 .",
    "* stopping criterion : * stop .",
    "calculate @xmath247 by solving the linear system @xmath248 .",
    "update the value of @xmath249 * goto * * stopping criterion*.      the system dynamics with the boundary conditions and @xmath250 have to be solved with additional inequality constraints @xmath251 along with the complimentary slackness conditions defined by @xmath252 where @xmath253 first we consider the case in which state constraints are not active ( i.e. , @xmath254 for all @xmath34 ) .",
    "then is trivially satisfied .",
    "if state constraints are not active , then the necessary conditions are defined by with @xmath254 for all @xmath34 , and .",
    "we now represent the matching and boundary condition for the system of difference equations and in terms of @xmath255 and @xmath256 and solve the system of nonlinear algebraic equations comprises of matching conditions .",
    "the system of difference equations along with the boundary conditions will result in the following set of matching conditions , which can be solved using newton s root finding algorithm with quadratic convergence rate  @xcite .",
    "+ solve : @xmath257 where @xmath258 let @xmath259 be the jacobian matrix of the matching conditions @xmath260 .",
    "assuming @xmath261 to be the solution of the system @xmath260 at the @xmath262th iteration of the newton s root finding algorithm , the @xmath263th iteration is given by @xmath264 where @xmath265 is a solution of the linear system @xmath266    it is important to note that newton s update @xmath267 is not necessarily unique ; @xmath267 is unique if and only if @xmath268 is invertible .",
    "invertibility of the matrix @xmath259 is proved for a special case ( when only momentum dynamics are considered ) in appendix [ app : nsgrad ] .",
    "notice that @xmath226 defined in is not differentiable , but it is lipschitz continuous .",
    "so , we take its generalized gradient  @xcite , defined by @xmath269 the resulting nonlinear algebraic equations can be solved using the non - smooth version of newton s method in @xcite , and this is illustrated with the help of the flowchart shown in figure [ fig : newton ] .",
    "= [ diamond , draw , fill = blue!20 , text width=5em , text badly centered , node distance=3 cm , inner sep=0pt ] = [ rectangle , draw , fill = blue!20 , text width=12em , text centered , rounded corners , minimum height=5em ] = [ draw , -latex ] = [ draw , ellipse , fill = red!20 , node distance=3 cm , minimum height=2em ] ( init ) initialize @xmath60 and the error tol @xmath246 ; ( start ) start ; ( evaluate ) evaluate the matching conditions @xmath270 and its gradient @xmath271 ; ( update ) update @xmath272 ; ( decide ) is @xmath273 ? ; ( solve ) evaluate @xmath274 by solving the linear system : + @xmath275 ;    ( stop ) stop ; ( init )  ( evaluate ) ; ( evaluate )  ( decide ) ; ( decide )  node [ near start ] no ( solve ) ; ( solve )  ( update ) ; ( update ) |- ( evaluate ) ; ( decide )  node yes(stop ) ; ( start )  ( init ) ;      here we discuss the general case in which momentum constraints are active . by the complementary slackness conditions",
    ", it is clear that if the momentum constraints are not active , then @xmath276 for all @xmath277 and @xmath278 on the other hand , if the slack variable @xmath279 , then the momentum variable @xmath205 corresponding to the slack variable @xmath280 lies on the boundary ( i.e. , @xmath281 )  @xcite .",
    "the original newton s root finding algorithm can not handle momentum inequality constraints ; we propose a modified strategy for handling the momentum inequality constraints .",
    "the algorithm has three phases :    1 .",
    "* projection of the states to the feasible region * : after each newton s iteration , the momentum variables @xmath282 are projected onto the feasible domain .",
    "* identification of active constraints : * active constraints can be identified by computing @xmath283 from . if @xmath284 , then the inequality constraint corresponding to the state @xmath205 is active ; else it is inactive .",
    "* enforcing active constraints : * when @xmath285 , then the equation with @xmath286 in is trivially satisfied .",
    "so , the matching condition @xmath287 will be replaced with the corresponding active constraint @xmath288 for the next iteration .",
    "let @xmath289 be a vector in the augmented space ; the feasible region @xmath290 is defined as @xmath291 it is clear that @xmath292 is the intersection of the two half spaces @xmath293 and @xmath294 , hence a convex set .",
    "let @xmath295 be the projection onto the feasible region @xmath290 , and @xmath296 represents the active constraints , which is a collection of equality state constraints , active inequality state constraints and co - state constraints corresponding to inactive inequality state constraints .",
    "our modified multiple shooting method is described in algorithm [ mmsm ] , and is illustrated with the help of the flowchart given in figure [ fig : mnewton ] .    1",
    "choose appropriate initial guess @xmath60 and the error tolerance bound @xmath246 . *",
    "projection : * compute @xmath297 where @xmath298 . using ,",
    "update co - states @xmath299 compute the slack variable using as @xmath300 define active constraints @xmath301 evaluate the matching conditions @xmath302 and its gradient @xmath303 , where @xmath304 . stop .",
    "calculate @xmath305 by solving the linear system @xmath306 .",
    "update the value of @xmath307 * goto * * projection*.    = [ diamond , draw , fill = blue!20 , text width=5em , text badly centered , node distance=3 cm , inner sep=0pt ] = [ rectangle , draw , fill = blue!20 , text width=12em , text centered , rounded corners , minimum height=3em ] = [ rectangle , draw , fill = blue!20 , text width=17em , text centered , rounded corners , minimum height=3em ] = [ draw , -latex ] = [ draw , ellipse , fill = red!20 , node distance=3 cm , minimum height=2em ] ( init ) initialize @xmath60 and the error tol @xmath246 ; ( start ) start ; ( project)evaluate @xmath308 ; ( updtcst)define active constraints @xmath296 and @xmath309 ; ( evaluate ) evaluate the matching conditions @xmath302 and its gradient @xmath303 ; ( update ) update @xmath310 ; ( solve ) evaluate @xmath305 by solving the linear system : + @xmath311 ; ( decide ) is @xmath312 ? ; ( stop ) stop ; ( init )  ( project ) ; ( project )  ( updtcst ) ; ( updtcst ) ",
    "( evaluate ) ; ( evaluate ) ",
    "( decide ) ; ( decide ) -| node [ near start ] no ( solve ) ; ( solve ) ",
    "( update ) ; ( update ) |- ( project ) ; ( decide )  node yes(stop ) ; ( start )  ( init ) ;",
    "the following data have been considered for the simulations : principal moment of inertia of the satellite @xmath313= , sampling time ( @xmath314 ) = , range of angles ( @xmath315 ) can vary between [ , ] about any axis , maximum torque or control bound ( @xmath316 ) = , maximum momentum ( @xmath317 ) = , time duration ( @xmath318 ) can range from to .",
    "an open loop optimal control profile is obtained for a maneouvre of reorienting the satellite for @xmath319 about axis @xmath320 from initial momentum @xmath321 = to desired momentum @xmath322 = in . the optimal control profile along with the momentum and co - state vectors",
    "is shown in figure  [ fig : crot90_111_19 ] .",
    "about @xmath320 axis with initial momentum @xmath321 = , desired momentum @xmath322 = , time duration = .,scaledwidth=80.0% ]    it is clear from the figure  [ fig : crot90_111_19 ] that the control saturates when the absolute values of the co - state vectors corresponding to the momentum are more than the control bounds .",
    "if the momentum saturates , then the control along that axis goes to zero .",
    "a tractable solution to a class of optimal control of spacecraft attitude maneuvers under control and momentum constraints has been presented .",
    "we used discrete mechanics to discretize the continuous time model , which has many advantages over the conventional discretization schemes like euler s steps .",
    "in particular , the model so obtained preserves conserved quantities of the body like momentum and energy .",
    "it is efficient in terms of numerics because the model reduces to the momentum dynamics only .",
    "a new multiple shooting algorithm has been proposed to solve the system of difference equations obtained as first order necessary conditions using variational analysis .",
    "this algorithm can be used to solve optimal control problems with state inequality constraints . in future , convergence results for the modified multiple shooting methods",
    "will be explored .",
    "the proposed multiple shooting method uses newton s root finding algorithm at each step for finding the roots of the matching conditions .",
    "newtons s method has a quadratic rate of convergence in a neighborhood of the true solution , and therefore it is worth exploring the convergence rates of our algorithm in a neighborhood of the matching conditions .",
    "it is important to note that our algorithm can handle box constraints only ; an extension to more general constraints is under development .",
    "if @xmath323 then the matrix @xmath144 is invertible . if @xmath324 then @xmath144 is invertible if and only if the matrix @xmath325 is invertible .",
    "using banach lemma  @xcite , the matrix @xmath325 is invertible if @xmath326 @xmath327 then @xmath328 .",
    "now we show that if @xmath329 then condition @xmath330 is true .",
    "let us choose the quaternions @xmath331 as a parametrization for the rotation matrix @xmath128 where @xmath332 and @xmath333 , the vector @xmath334 represent the unit vector corresponding to vector @xmath335 then @xmath336 where @xmath337 the optimization problem defined in is a linear programming problem and hence the optimum value will be attained on the vertices of the feasible region . without loss of generality , assume that @xmath338 then @xmath339 given that @xmath329 and @xmath332 , one can conclude that @xmath340 substituting the value of @xmath341 to gives @xmath342",
    "this claim can be proved using the rodrigues s formula .",
    "let @xmath343 and @xmath344 then there exist vectors @xmath345 such that @xmath346 where @xmath347 is a unit vector corresponding to the vector @xmath348 . using the rodrigues s",
    "formula  @xcite @xmath349 we obtain , the skew - symmetric parts of @xmath350 and @xmath351 as @xmath352 given that @xmath353 and since we know that @xmath354 , from we have @xmath355 + if @xmath356 then from @xmath357 iff @xmath358 which means @xmath359 because @xmath360 using the exponential map one can conclude that @xmath361 +   + if @xmath362 then from @xmath363 which is true iff @xmath364 the map",
    "@xmath365 -\\frac{\\pi}{2 } , \\frac{\\pi}{2 } [ \\rightarrow ] -1,1 [ $ ] is bijective .",
    "given that @xmath366 , we conclude from that @xmath367 . hence @xmath368 from and it is clear that @xmath369 .",
    "using the exponential map , one can conclude that @xmath361",
    "let us discuss a case in which , only momentum dynamics is considered . in this case , matching conditions modifies to @xmath370 where @xmath371 we define the gradient of the matching conditions as @xmath372 where @xmath373 @xmath374    theoremnsgrad [ thm : nsgrad ] the jacobian matrix @xmath375 is non - singular if there exist a time instant @xmath34 such that the control @xmath226 is not saturated .",
    "the matrix @xmath375 is similar to the upper triangular matrix @xmath376 which is obtained using the elementary row transformations .",
    "@xmath377 note that the matrix @xmath378 is invertible if and only if @xmath379 is invertible for @xmath380 , and @xmath381 is invertible .",
    "first we prove that @xmath379 is invertible , @xmath382    lemmainvl [ lemma : invl ] the matrix @xmath383 is invertible if and only if the matrix @xmath144 is invertible .    a proof of lemma [ lemma : invl ] is provided in appendix [ app : invl ] . by lemma  [ lemma : invl ] and",
    "lemma  [ lemma : invfkjd ] , we know that the matrix @xmath384 is invertible . hence , from it is easy to conclude that the matrix @xmath379 is invertible .",
    "let us define the inverse of the matrix @xmath379 as @xmath385 where @xmath386 taking the first order approximation in @xmath9 , the matrix @xmath381 can be approximated as @xmath387 where @xmath388 such that @xmath389 now it is clear from that the matrix @xmath381 is invertible if the matrix @xmath245 is invertible . as the matrix @xmath390 is invertible , so the matrix @xmath391 is invertible for all i = 0,1,  ,n .",
    "so , it is enough to prove that the matrix @xmath392 is invertible for @xmath245 being invertible .",
    "note that the matrix @xmath393 is a negative semi - definite matrix for @xmath394 assuming that there exist a time instant @xmath34 such that the control @xmath226 is not saturated means that @xmath395 is negative definite .",
    "so , it is concluded that the matrix @xmath392 is negative definite and hence invertible .",
    "we know that @xmath396 . then using the implicit equation @xmath397 the matrix @xmath383 can be rewritten as @xmath398 by it is obvious to conclude that the matrix @xmath144 is invertible if and only if the matrix @xmath383 is invertible ."
  ],
  "abstract_text": [
    "<S> this article solves an optimal control problem arising in attitude control of a spacecraft under state and control constraints . </S>",
    "<S> we first derive the discrete - time attitude dynamics by employing discrete mechanics . </S>",
    "<S> the orientation transfer , with initial and final values of the orientation and momentum and the time duration being specified , is posed as an energy optimal control problem in discrete - time subject to momentum and control constraints . </S>",
    "<S> using variational analysis directly on the lie group @xmath0 we derive first order necessary conditions for optimality that leads to a constrained two point boundary value problem . </S>",
    "<S> this two point boundary value problem is solved via a novel multiple shooting technique that employs a root finding newton algorithm . </S>",
    "<S> robustness of the multiple shooting technique is demonstrated through a few representative numerical experiments . </S>"
  ]
}