{
  "article_text": [
    "the fields of astrophysics and cosmology have benefited from the recent development of a numerical technique for effectively lagrangian integration of the equations of hydrodynamics .",
    "this moving - mesh technique , first proposed by @xcite and recently implemented in the cosmology code arepo @xcite and later for relativistic astrophysics in the tess code @xcite , has had considerable success in improving upon results from lagrangian smoothed particle hydrodynamics ( sph ) methods and eulerian adaptive mesh refinement ( amr ) techniques .",
    "both tess and arepo are three - dimensional and parallel , and have implemented solvers for the magnetohydrodynamic and viscous hydro equations .",
    "a related finite - element approach has also recently been developed which employs the same moving voronoi mesh @xcite .",
    "the numerical method has also been adapted for use with alternate , non - voronoi meshes tailored to disks and jets @xcite , as the general idea does not depend sensitively on the shape of the zones .    in general",
    ", a moving mesh can be advantageous for capturing highly supersonic flows , or situations which require precise preservation of contact discontinuities .",
    "one of the most highly - prized advantages to the moving voronoi mesh is its ability to capture fluid instabilities at relatively low resolution @xcite .",
    "it has also been suggested that the voronoi mesh would be ideal for capturing turbulent flow , as the scale - by - scale structure of eddies within eddies seems naturally suited to a lagrangian treatment @xcite .    however , this method is not without its detractors .",
    "a major concern regarding the voronoi method is the noise introduced at the grid scale .",
    "first , the extremely well - preserved contact discontinuities can produce jagged edges at the grid scale , which might potentially introduce numerical issues similar to those produced by contact steepeners , which were first introduced to artificially enhance contact discontinuities @xcite .",
    "a much larger source of noise , however , comes from the mesh motion itself . this has been directly observed in simulations of driven turbulence .",
    "when the mesh is moved , a large amount of power is introduced artificially at the grid scale , hampering the code s ability to resolve the inertial range of turbulence at a given resolution @xcite .",
    "the cause of this noise is easily understood .",
    "it is produced whenever two neighboring mesh points are given significantly different velocities . in this case ,",
    "mesh topology can change very abruptly , either producing diffusion when a face flips and overtakes a substantial fraction of a zone , or producing noise when a face rotates quickly about its center , moving fluid around artificially even when there is no flux through the face .",
    "such noise will always plague voronoi codes like tess and arepo , as long as there is shear in the mesh at the smallest scales . in this work",
    ", we report on a very simple way to reduce this noise , while still retaining all the advantages of the moving mesh .",
    "simply , rather than moving the mesh - generating points with the local fluid velocity @xmath0 , this velocity field is smoothed on some length scale , @xmath1 : @xmath2 $ ] , and the mesh points are moved with the velocity @xmath3 , rather than the local fluid velocity . in the examples presented here , the length scale @xmath1 is of order the grid scale .",
    "note that in general , one always has complete freedom when choosing the mesh velocity field @xmath3 ; if @xmath4 everywhere , the method reduces to an eulerian fixed - grid scheme . by smoothing @xmath3 ,",
    "the code remains lagrangian on large scales , but behaves like a comoving eulerian code on small scales .",
    "the idea of using a smoothed velocity field to move mesh points has previously been proposed in the context of sph , in the form of a technique called x - sph .",
    "it is worth noting that both tess and arepo already employ mesh - regularization techniques with the goal of keeping the voronoi tessellation regular ( i.e. the voronoi cells are  rounder \" and have fewer neighbors on average ) .",
    "this work aims to treat a different problem with a distinct solution ; the mesh velocity field is smoothed with the goal of reducing noise from rapid mesh adjustments . in doing so , there is also the side - benefit that the mesh tends to remain more regular .",
    "however , the reason for the smoothed mesh - motion is a reduction in small - scale noise .",
    "this adaptation is simple , and it can provide improvement to the original method , as we shall demonstrate with several code tests . it is recommended that every voronoi code use a smoothed velocity field for the mesh motion , otherwise such codes are succeptible to the aforementioned numerical noise , and the code s ability to accurately capture instabilities and turbulence ( which can have shear on all scales ) may be in question .    .",
    "the upper panel uses a fixed mesh , which diffuses the eddies . in the center panel ,",
    "the mesh is moving , and the spiral shapes formed are sharper and more pronounced .",
    "however , significant noise is introduced at the grid scale which is enhanced by the unstable shear motion , producing jagged structures .",
    "the lower panel uses the smoothed mesh motion , which significantly reduces this noise , while still maintaining contact discontinuities and capturing the growth of the instability to high accuracy ( see figures [ fig : kh ] and [ fig : growth ] ) . ]",
    "the moving voronoi mesh technique has been articulated in other works @xcite , and we shall not repeat all of the details here . essentially , it is a finite volume method in which the finite volumes are calculated from a voronoi tessellation of a given set of mesh - generating marker points .",
    "these marker points can be given an arbitrary mesh velocity @xmath5 , though typically their motion is set to the local fluid velocity , @xmath6 .",
    "motion of the marker points results in mesh motion , which is accounted for by adjusting the flux through each voronoi face , based on the face s velocity .",
    "note that the velocity of a face does not have to mimic the velocity of nearby marker points .",
    "in particular , if two neighboring marker points have significantly different velocities , this can result in a relative face velocity in a totally different direction from the velocity of the marker points .",
    "this generally results in a face which moves counter to the flow , which is not desirable .",
    "it can result in diffusive mixing if the face overtakes a significant fraction of one of the zones during a timestep .",
    "it can also result in noise if the face rotates about its center considerably over a timestep , an action which is not accounted for by any compensating fluxes .",
    "this problem can be mitigated by reducing the relative velocity of neighboring marker points .",
    "in other words , instead of setting @xmath3 equal to the local velocity , this velocity field is first processed through some smoothing operation , @xmath7 $ ] , so that neighboring marker points have similar velocities , while large - scale fluid motion is still properly subtracted off by the smoothed velocity field of the mesh .    in principle",
    ", there is freedom in the choice of the operator @xmath8 . in this work ,",
    "a very simple operation is employed .",
    "other smoothing operators are certainly possible ; the choice of @xmath8 presented here is mainly a proof - of - concept .",
    "first , the marker point velocities are set equal to the local fluid velocity , @xmath9 .",
    "next , an averaging operation is performed : @xmath10 , where @xmath11 represents a weighted average of the velocities of neighboring marker points ( weighted by the area of the face shared in the voronoi tessellation ) , and @xmath12 is an adjustable constant chosen based on how aggressively the mesh is to be smoothed .",
    "it is then possible to perform this substitution iteratively until the velocity field @xmath3 has the desired smoothness . in the examples presented in this work",
    ", @xmath13 is chosen with five iterations , but other smoothing operators could be chosen which may have more desirable properties .",
    ", to be compared with figure 2 of mcnally et al .",
    "( 2012 ) ) .",
    "both panels ran at a resolution of @xmath14 .",
    "the upper panel uses the standard mesh motion , while the lower panel uses smoothed mesh motion .",
    "naively one might incorrectly interpret the upper panel as being more accurate ; the image  looks \" more realistic , as it appears to capture details that the lower panel misses .",
    "however , since this is a smooth problem , there is a highly accurate reference solution found in mcnally et al .",
    "( 2012 ) , calculated using the high - order pencil code at high resolution .",
    "their result does not exhibit the small - scale features found in the upper panel .",
    "rather , these are secondary instabilities , which are artificially seeded by mesh noise . ]",
    "( definitions and reference solution found in ) . calculations",
    "used a mesh with @xmath15 zones , and the effect of smoothing is tested by varying the number of iterations in the smoothing operator .",
    "grid noise suppresses the growth of the instability , but by smoothing the mesh motion the growth rate is more accurately captured . ]",
    "the kelvin - helmholtz instability was at first cited as one of the best arguments for using a moving voronoi mesh .",
    "@xcite showed that the eddies formed in the instability are much more vividly captured when moving the mesh than when the mesh is kept fixed , since a fixed mesh introduces advection errors which diffuse the eddies .",
    "figure [ fig:50 ] shows a very low - resolution ( @xmath16 ) kelvin - helmholtz calculation at @xmath17 based on the initial conditions given in @xcite ( springel s figure 32 ) .",
    "the same calculation is performed on a fixed mesh ( top panel ) , standard moving mesh with @xmath9 ( center ) , and finally smoothed mesh motion with @xmath18 $ ] ( lower panel ) .",
    "it is clear by looking at the top and center panels that moving the mesh results in a dramatic reduction in diffusion , and much sharper contact discontinuities .",
    "the fixed mesh exhibits diffusion which comes from advection errors to which the moving mesh is less susceptible .",
    "however , upon closer inspection , the standard moving mesh exhibits a different problem .",
    "small - scale structures appear to form in the eddies , which may be evidence for spurious noise or numerical instability ( similar features can be seen in @xcite , figure 32 ) . at first glance ,",
    "it might seem as though these small structures could actually be real ; i.e. that they might be secondary instabilities that moving - mesh codes can capture , but which are diffused away by fixed - grid codes . in this section we will demonstrate that this is not the case .",
    "that is , secondary instabilities do exist , but in these examples they are seeded artificially by the grid - scale noise described in the previous section .",
    "the unstable nature of the flow enhances the noise and makes convergence slow .",
    "however , when the mesh motion is smoothed ( lower panel of figure [ fig:50 ] ) , the noise is reduced and the result is more accurate . because the smoothing operation is not significantly diffusive , one does not have to sacrifice the sharpness of the contact discontinuities .",
    "the calculation with smoothed mesh motion can be shown to be correct , using the smooth kelvin - helmholtz test proposed by @xcite .",
    "these authors started with a smooth initial condition , and evolved it using the 6th - order pencil code @xcite at a resolution of @xmath19 .",
    "this resolution study was careful and thorough , and therefore this is likely the closest one will come to having an exact solution to this problem ( relative errors in their results were of the order @xmath20 or smaller everywhere on the grid ; far too small to see by eye ) .",
    "figure [ fig : kh ] shows a snapshot of the tess code performing this problem at a resolution of @xmath14 .",
    "the upper panel uses standard mesh motion , and the lower panel employes smoothed mesh motion . to the careless eye , the upper panel  looks \" more correct , as it seems as if it is picking out more details than the lower panel .",
    "however , the true , converged solution ( figure 2 in @xcite ) does not exhibit these detailed features .",
    "these are secondary instabilities seeded by numerical noise .",
    "moreover , it is very difficult to eliminate these errors with high resolution ; increasing the resolution introduces the noise on smaller scales , which excites faster - growing modes .",
    "the amplitude of these errors eventually trends to zero with high resolution , but slowly .    fortunately",
    ", smoothing the velocity field of the mesh significantly reduces this problem .",
    "figure [ fig : growth ] shows that the growth of the instability is more accurately captured when using smoothed mesh motion .       zones .",
    "there is a clear inertial range extending over roughly an order of magnitude in k. the inertial range shows a steep scaling somewhere between @xmath21 and @xmath22 . at small scales , there is significant power at the dissipation scale , indicating noise induced by mesh motion .",
    "this noise is reduced and the inertial range is extended when using a smoothed velocity field for the mesh . ]     ( proportional to perimiter squared over area ) .",
    "zone data is taken from a @xmath23 run of the smooth kh test at @xmath17 .",
    "@xmath24 describes a circle , while @xmath25 for a regular hexagon .",
    "smoothed mesh motion reduces the number of zones in the tail , around @xmath26 , by nearly an order of magnitude . ]",
    "the smoothed mesh motion is important in any problem which exhibits shear on all scales . in a turbulent cascade ,",
    "there is always shear on all scales , and therefore substantial grid noise will be produced when using a voronoi mesh to follow such a flow . if the mesh is moved , but with a smoothed prescription for the mesh motion , the mesh follows the largest eddies , and this large - scale flow is effectively subtracted off .",
    "meanwhile , the dynamics of the smallest eddies are calculated in an effectively eulerian manner ( in the smallest eddy s center - of - momentum frame ) .",
    "thus , the turbulence is captured in a natural way , but without introducing the noise produced by shearing the grid on the smallest scales .",
    "this can be illustrated in two - dimensional simulations of driven turbulence .",
    "the fluid is stirred on large scales using a driving field generated via a stochastic process .",
    "this method for large - scale driving is identical to the one employed by @xcite .",
    "the resultant turbulence is subsonic ( mach @xmath27 ) .",
    "a snapshot of the 2d turbulence is shown in figure [ fig : turb ] , where a passive scalar is included to reveal the structures generated from the turbulent fluid motions .",
    "this passive scalar was initialized as a step function .",
    "the advantage gained in smoothing the mesh motion can be seen most clearly in the power spectrum ( figure [ fig : power ] ) .    in the power spectrum , there is a clear inertial range , extending from the driving scale at @xmath28 to a bottleneck at small scales . in 2d , on scales smaller than the driving scale , the power spectrum is set by an enstrophy cascade from large to small scales .",
    "simple scaling arguments give a scale dependence of @xmath21 for the power spectrum in the inertial range @xcite , but it has been suggested that the nonlocality of 2d turbulence may cause this slope to depend on the fluid reynolds number @xcite . the important question is not of slope of the spectrum but on the extent of the inertial range and the size of the bottleneck at the dissipation scale . clearly , the smoothed mesh motion reduces the power in this bottleneck , and increases the extent of the resolved inertial range .",
    "this could potentially be further improved with a different choice of @xmath8 .",
    "the noise introduced by the voronoi mesh motion at small scales can hamper the convergence properties of codes which employ this moving - mesh technique .",
    "calculations which are sensitive to the detailed development of instabilities and turbulence should employ some mechanism for reducing or eliminating this noise , such as the smoothed mesh motion described in this work .",
    "more generally , when performing astrophysical or cosmological calculations using a moving voronoi mesh , if a certain qualitative behavior depends on whether the mesh motion is turned on , it is not necessarily the case that the moving - mesh version gives the correct answer . in the case of the smooth kelvin - helmholtz example of figure [ fig : kh ]",
    ", it may be very tempting to assume that these small structures are subtle details being picked out by the mesh motion .",
    "however , the resolution study by @xcite clearly demonstrated that this was not the case .",
    "this strongly suggests that the same is true of the non - smooth version shown in figure [ fig:50 ] .",
    "given this , the smoothed mesh motion presented here provides a more accurate solution for the kelvin - helmholtz problem , without sacrificing the advantages gained by moving the mesh ; this improvement came from subtracting noise , not from adding diffusion .",
    "the turbulence calculations ( figures [ fig : turb ] and [ fig : power ] ) provide more evidence for this ; the mesh noise is clearly exhibited in the high - k end of the power spectrum .",
    "this loud bottleneck at small scales is reduced by smoothing the mesh motion .",
    "it should also be noted that while mesh smoothing is a distinct operation from the  mesh steering \" techniques used in arepo and tess ( including the mesh - steering method of @xcite ) , it can help to accomplish similar goals .",
    "figure [ fig : shape ] shows the distribution of zone shapes , defining the  shape factor \"      @xmath30 represents how far off zones are from being perfectly round ( @xmath31 in the limiting case of a circle , and @xmath32 for a regular hexagon , but @xmath30 can potentially attain much larger values for non - round shapes and large aspect ratios ) .",
    "the figure shows that with standard mesh motion , mesh steering already does a reasonable job keeping zones round .",
    "however , smoothed mesh motion improves on this a bit , reducing the number of zones with @xmath33 by nearly an order of magnitude .",
    "finally , it should be noted that the smoothing operator @xmath34 presented in section [ sec : smooth ] is not unique ; undoubtedly there are other operations one can perform to smooth the velocity field @xmath3 on small scales , which may improve performance further .    this research was supported in part by nasa through grant nnx10af62 g issued through the astrophysics theory program and fermi grant nnx13a093 g and by the nsf through grant ast-1009863 .",
    "we are grateful to jim stone , colin mcnally and jonathan zrake for helpful comments and discussions .",
    "c. , peskin c.  s. , 1985 , in fritts m.  j. , crowley w.  p. , trease h. , eds , lecture notes in physics , berlin springer verlag vol .",
    "238 of lecture notes in physics , berlin springer verlag , a lagrangian method based on the voronoi diagram for the incompressible navier stokes equations on a periodic domain ."
  ],
  "abstract_text": [
    "<S> we describe a technique for improving the performance of hydrodynamics codes which employ a moving voronoi mesh </S>",
    "<S> . currently , such codes are susceptible to high - frequency noise produced by rapid adjustments in the grid topology on the smallest scales . </S>",
    "<S> the treatment for this grid noise is simple ; instead of moving the mesh - generating marker points with the local fluid velocity , this velocity field is smoothed on small scales , so that neighboring marker points generally have similar velocities . </S>",
    "<S> we demonstrate significant improvement gained by this adjustment in several code tests relevant to the physics which moving - mesh codes are designed to capture . </S>"
  ]
}