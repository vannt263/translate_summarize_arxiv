{
  "article_text": [
    "the core magnetic field ( mf ) of the earth is sustained by the dynamo action taking place in its outer core . here",
    ", the variations in chemical composition and in temperature of the liquid metal allows convection to develop .",
    "since the fluid is electrically conducting , it interacts non - linearly with the magnetic field .",
    "while the flow is advecting the mf , this latter is constraining the fluid motions through the lorentz forces .",
    "the evolution of the fluid velocity field ( vf ) and the magnetic field are therefore entirely connected to one another through energy exchanges between them .",
    "studying such a system is difficult in many aspects . from a numerical point of view , simulating directly the dynamic of the outer core is a challenging task . because of the strong regime of turbulence that the magnetohydrodynamic ( mhd ) flow exhibits , the separation between the smallest and the largest scales of the system is extremely broad . yet , to properly describe the evolution of both the vf and the mf , all these scales should be considered in simulations since they interact non - linearly together .",
    "but this is , with the actual computation power available , impossible .    from an experimental point of view , observing directly the evolution of the outer core is also impossible .",
    "nevertheless , measurements of the mf from ground observatories or satellites may allow to indirectly infer some dynamical properties of the flow and the mf in the core .",
    "in particular , because of the low conductivity of the mantle ( @xcite ) , a knowledge of the core mf at the earth s surface is sufficient to evaluate it at the level of the core - mantle boundary ( cmb ) . at this very specific location ,",
    "the mf is coupled to the outer core vf through the frozen flux equation ( a simplified version of the induction equation introduced by @xcite , and in which the diffusion effects are neglected ) . by inverting this equation",
    "it is therefore possible to evaluate the vf at the cmb .",
    "unfortunately , the problem is ill - posed for different reasons .",
    "first , the two components of the velocity field are connected to the radial component of the secular variation ( sv ) through a unique equation .",
    "then , the available secular variation given by mf models such as grimm 2 of @xcite is only resolved at large scales whereas any scale of the velocity field can contribute to this resolved sv . finally ,",
    "as it is the case for the sv , only the large scale core mf can be determined at the earth surface , yet interactions between the unknown small scale mf with the vf can generate large scale sv ( see @xcite ) .    as shown by @xcite , to resolve the non - uniqueness of the velocity field in this inverse problem , constraints have to be imposed to the flow behavior .",
    "different formulations have been proposed over the past decades .",
    "this includes tangential - geostrophy , tangential - magnetostrophy , columnar flow , helical flow , or purely toroidal flow ( see @xcite and @xcite for an exhaustive review of the different constraints usually applied and their physical implications )",
    ". nevertheless , these physical constraints are not sufficient to provide a unique flow solution ( see @xcite and references therein ) , and additional regularization assumptions have to be introduced in the problem ( see @xcite ) .",
    "although identified for more than twenty years ( @xcite ) , it is only recently that the effects of the unknown small scale mf on the large scale sv have been modeled in the inversion of the frozen flux approximation .",
    "in particular two methods have given promising results , namely the ensemble approach of @xcite , and the iterative method of @xcite .",
    "the philosophy of these two approaches is quite distinct from one another .",
    "whereas in the method of @xcite an ensemble of magnetic field containing small scales is generated and directly used to evaluate an ensemble of velocity field , in the method of @xcite the effects of the unknown magnetic field is transposed into a modeling error which is iteratively estimated . in this study",
    ", we propose a development of these approaches in the context of bayesian modeling .",
    "the article is therefore constructed in the following manner .    in section [ governingequations ] , after describing the principle of derivation of the frozen flux equation , we recall the issue raised in the inversion of this equation by the truncated nature of the available mf .",
    "we then describe how to isolate the large scales of the mf and present the approximated dynamical equation , referred as filtered frozen flux ( fff ) equation , which determines the evolution of these large scales . at the end of the section we present how to formulate the inverse problem in a bayesian framework when variations of the mf around the prescribed one are allowed to occur . in section [ numericalmethod ] tests on synthetic data",
    "are performed . in the first one , we evaluate the improvement brought by using the fff equation in the inverse problem . in the second test , the bayesian formalism developed in section [ governingequations ] is considered to recover the velocity field from a set of artificially generated data , and the results are compared to the flow obtained with three other approaches .",
    "the methodology we developed is then used to determine the velocity field and its underlying uncertainties for the epoch @xmath0 .",
    "finally we present our conclusions in section [ conclusion ] .",
    "in this section we introduce briefly the hypothesis necessary to derive the frozen flux approximation . for a more detailed description see @xcite .    outside the core ,",
    "the geodynamo s mf @xmath1 is irrotational , it can therefore be expressed through a potential @xmath2 according to the relation : @xmath3 as mentioned previously , the low conductivity of the mantle ( @xcite ) allows to evaluate the mf and therefore its radial component @xmath4 at the level of the core mantle boundary .",
    "there its evolution is prescribed by the induction equation : @xmath5 with @xmath6 the horizontal divergence operator , @xmath7 the two - dimensional velocity field , @xmath8 the magnetic diffusivity , and @xmath9 a radial unitary vector . because for the earth , on short period of time the dissipation effects are dominated by advection effects ( see @xcite ) and since our study is limited to single epoch inversion , the fluid can be considered as a perfect conductor .",
    "@xcite showed that under this assumption , known as the frozen flux ( ff ) approximation , the induction equation can be simplified as : @xmath10      to perform a consistent inversion of the frozen - flux equation at the cmb , in addition to imposing a certain behavior to the flow and to regularizing it ( see @xcite ) , every scale composing the secular variation and the magnetic field have to be known .",
    "unfortunately , in the actual models describing the spatio - temporal evolution of the earth s magnetic field derived from satellite and observatory data , the resolution of both the sv and the mf is limited . for the grimm 2 model of @xcite , for example , the fields do not excess the degree @xmath11 when expanded in spherical harmonics .",
    "so if @xmath12 corresponds to the spherical harmonics ( sh ) coefficient at degree @xmath13 and order @xmath14 associated with the scalar potential @xmath2 , such as : @xmath15 where @xmath16 is the core radius , and @xmath17 is the schmidt semi - normalized sh , then according to equation ( [ potential ] ) , the available mf @xmath18 , and its unknown part @xmath19 are respectively given by : @xmath20 with @xmath21 the cut - off scale ( which is equal to @xmath11 for the mf provided by the grimm 2 model ) .",
    "note that the total radial component of the mf corresponds to the sum of these two quantities .    to account for the truncated nature of the available mf and sv",
    ", the frozen flux approximation has to be rewritten as : @xmath22 where the advection term , on the right hand side of equation ( [ truncatedff1 ] ) , is decomposed into two parts , one depending on the resolved magnetic field and the other function of the undetermined field . @xcite were the first to highlight the issue raised by the unknown part of the mf in the inversion of the ff equation .",
    "nevertheless , because at this epoch the uncertainties on sv measurements were large , the contribution of the term @xmath23 could be neglected in the inverse problem . the recent increase in quality of both the measurements and models describing the evolution of the core mf ( see @xcite ) invalidate this latter statement , and @xcite showed that the unresolved part of the mf could not be neglected anymore .      to model the effects of the unresolved part of the magnetic field on the large scale secular variation , assumptions on this unknown field behavior have to be made .",
    "in particular one can prescribe to it a certain energy spectrum .",
    "this operation can be performed , for instance , by extrapolating the spectrum associated with the resolved scales which is defined by : @xmath24 the resulting spectrum @xmath25 can then be used to statistically model the unknown mf @xmath19 .",
    "following the development of @xcite where the field is assumed to be isotropically distributed , the covariance of the coefficients @xmath26 is directly proportional to the extrapolated spectrum through the relation : @xmath27 = \\frac { e_{b^>}(l)}{(l+1)(2l+1)}\\delta(l - l^\\prime ) \\delta(m - m^\\prime ) \\ , \\label{variances}\\ ] ] where @xmath28 $ ] corresponds to the mathematical expectation .",
    "the issue with such a modelization is that no universal spectrum of the geodynamo s mf at the core mantle boundary is available .",
    "nevertheless , different formulations have been proposed over the past decades , but unfortunately most of them strongly differ from one another .",
    "an illustration of this statement is given in figure [ filteredextendedspectra ] where the spectrum of the mf prescribed by the grimm 2 model for the epoch @xmath0 ( between sh degree @xmath29 ) together with three different extrapolations ( thin lines ) are plotted .",
    "in this example , the laws derived by @xcite , @xcite and @xcite were used to extrapolate the resolved scale spectrum .",
    "they respectively read : @xmath30 with @xmath31 and @xmath32 .",
    "the constants @xmath33 , @xmath34 and @xmath35 were determined by fitting the resolved magnetic field spectrum between the degree @xmath36 .",
    "( between sh degree @xmath29 ) and its filtered ( thick lines ) and non filtered ( thin lines ) extrapolations .",
    "the laws used to extrapolate the large scale spectrum were taken from @xcite ( plus symbols ) , @xcite ( circles ) and @xcite ( triangles ) . ]",
    "as it is confirmed in figure [ filteredextendedspectra ] the three extrapolated spectra are presenting distinct behaviors .",
    "furthermore , the law proposed by @xcite predicts a strong concentration of energy at small scales . if this latter formulation was to be the closest one from reality , the unresolved mf would have to be modeled at very high degree ( up to @xmath37 ) , which is nowadays numerically impossible",
    "we propose therefore to reduce the impact of the small scale magnetic field on the large scale secular variation by applying a filter on the magnetic field and by determining the dynamical equation governing the evolution of the resulting filtered field .",
    "as it is the case for the earth s dynamo , the degree of turbulence in astrophysical or geophysical systems is most of the time extremely high .",
    "this implies that the fields are populated by a great variety of scales .",
    "capturing all these scales in observations or in numerical simulations is usually impossible .",
    "therefore , focusing on the large scales , and their dynamics , is probably the best solution to study such systems .",
    "this approach has been widely followed in the context of hydrodynamic ( hd ) and magnetohydrodynamic ( mhd ) turbulence ( see @xcite ) . to extract the large scales from a given field ,",
    "one has to filter it . in hd or mhd turbulence",
    "three different filters are generally used , the top - hat or the gaussian filter for studies in cartesian space , or the sharp cut - off filter in spectral space .",
    "while the top - hat or gaussian filter are continuous filters , the cut - off filter truncate the field above a certain predefined scale .",
    "in spherical coordinates the top - hat filter is usually preferred ( @xcite ) since until recently no equivalent of the gaussian filter existed for such geometries ( see however @xcite ) . in our study",
    ", we decided to consider the isotropic filter developed by @xcite .",
    "the principle of derivation of this filter is detailed in appendix [ appa ] . applying this filter to a scalar field @xmath38 leads to :",
    "@xmath39 where @xmath40 is the filtered field , the @xmath41 symbol denotes the convolution product over the sphere between convolution kernel @xmath42 and the scalar field @xmath43 . according to the convolution theorem ( see @xcite ) , in spectral space equation ( [ convolution ] ) becomes : @xmath44 where @xmath45 and @xmath46 are respectively the filtered and the total sh coefficients associated with @xmath43 , and @xmath47 is convolution kernel expressed in spectral space at degree @xmath13 . since for the filter developed by @xcite , @xmath42 is zonal , only its coefficients at order @xmath48 are different from zero .",
    "as shown in appendix [ appa ] equation ( [ spectralfilter ] ) , equation ( [ spectralconvolution ] ) can be expressed as : @xmath49 where @xmath50 corresponds to the filter width . with this formulation one",
    "can directly connect the spectrum of the scalar field @xmath51 to the spectrum of its filtered part @xmath52 as : @xmath53    we then applied this filter to the three different extrapolated spectra presented in the previous section ( see equations ( [ buffett])-([voohries ] ) ) . in figure [ filteredextendedspectra ]",
    "the non filtered ( thin lines ) , and the filtered ( thick lines ) spectra are plotted .",
    "the width of the filter has been set to @xmath54 km in order to preserve the large scale fields and to suppress the small scale ones .",
    "one can observe that most of the energy that was contained in the small scales of the initial fields has now vanished in the filtered fields .",
    "furthermore , the variations between the different extrapolated filtered spectra are now much less pronounced than in the non filtered case .      applying the spatial filter presented in the preceding section to the velocity and the magnetic field",
    "allows to decompose them into an averaged part @xmath55 and @xmath56 , and a fluctuating part @xmath57 and @xmath58 such as : @xmath59 since the spatial filter considered here is homogeneous and time invariant , it commutes with all the differential operators encountered in the induction equation . therefore applying this filter to the frozen flux approximation ( equation ( [ frozenflux ] ) ) leads to : @xmath60    following the decomposition introduced by @xcite , the part of the subgrid stress tensor which allows interactions between the tangential components of the velocity field and the radial component of the mf reads : @xmath61 now equation ( [ filteredfrozenflux ] ) can be rewritten as : @xmath62 the subgrid stress tensor @xmath63 , through the averaged product @xmath64 , incorporates interactions between averaged and fluctuating part of the fields , thus equation ( [ fff ] ) is not closed in the sense that it does not only contains large scale quantities . to close this equation , expressions of the fluctuating quantities depending on the averaged ones have to be derived .    as mentioned in appendix",
    "[ appa ] , the filtered velocity and magnetic field are both solutions of the diffusion equations : @xmath65 where the filtered and total fields are respectively @xmath66 and @xmath67 , and @xmath68 and @xmath69 , and the product between @xmath70 and the two diffusion coefficients @xmath71 and @xmath72 determines the width of the filter . note that since @xmath71 is the diffusion coefficient applied to each term of the frozen flux equation it has to be applied to the mf but not necessarily to the vf . to link fluctuating to filtered fields , taylor expansions at the first order in @xmath70 of @xmath7 , @xmath73 , and @xmath74 , using relations ( [ diffusionu ] ) to ( [ diffusionub ] )",
    "are performed , leading to : @xmath75    by analogy to the usual gaussian filters used in large eddy simulations , one can define the following characteristic lengths : @xmath76 letting @xmath77 , injecting equations ( [ approxu ] ) and ( [ approxb ] ) into equation ( [ approxub ] ) , and keeping only the first order terms , one gets :    @xmath78    which can be reduced to : @xmath79 so the subgrid stress tensor @xmath63 in its approximated closed form reads : @xmath80 the filtered frozen flux equation can now be written for the filtered secular variation @xmath81 truncated at degree @xmath82 as : @xmath83 with @xmath84 .",
    "in our study , the extrapolated filtered magnetic field @xmath85 is extended up to the spherical harmonic degree @xmath86 . above this scale , the filtered magnetic field ( for @xmath87 km )",
    "is extremely weak ( see figure [ filteredextendedspectra ] ) and its influence on the large scale secular variation is neglected .",
    "the problem of determining the velocity field at the cmb knowing the exact mf and the sv together with its uncertainties is an ill - posed inverse problem : in a discrete approximation , the number of unknown is twice as large as the number of equations .",
    "one of the most common methods to tackle this problem consists in minimizing an energy functional composed of two main terms ; a quantity measuring the discrepancies between the model and the data , balanced , through a regularization parameter , with a quantity expressing a prior knowledge on the expected solution .",
    "this method has been widely used to evaluate the flow at the cmb and for a review of the different parametrization employed see @xcite .",
    "another option consists in formulating the problem in a bayesian framework .",
    "the solution becomes then the full posterior distribution of the velocity field given the secular variation .",
    "this method allows the estimation of a model for the flow together with the quantification of its uncertainties .",
    "when variations around the prescribed mf are allowed to occur , the inverse problem becomes more complicated . for models of the earth s core mf derived from satellite or observatory data ,",
    "the nature of these variations is diverse . at large scales",
    "they can be due to a leakage of the external and lithospheric field into the core field , whereas at small scales , the entire mf is undetermined because of the dominance of the lithospheric field at the earth s surface .",
    "recent models such as grimm 2 ( @xcite ) are able to separate at large scales ( between sh degree @xmath29 ) the external from the core field , but not the lithospheric field from the core field . as a consequence ,",
    "the large scale lithospheric field becomes a source of uncertainty on the geodynamo s mf .    to parametrize the unresolved part of the mf in the inverse problem different approaches have been recently developed .",
    "this includes the ensemble method of @xcite and the iterative algorithm of @xcite . in this study",
    "we propose to extend these methods to the context of bayesian modeling , following the development of @xcite .",
    "furthermore , in addition to parametrizing the unresolved mf , we also consider the uncertainties on the large scale mf due to the lithospheric field .",
    "from now on , in order to simplify the notations , the filtered mf and vf as well as the filtered and truncated sv will be written as : @xmath88    in this section , the distribution we want to characterize is the posterior distribution of the velocity field given the secular variation @xmath89 .",
    "but since we want to account for the unknown small scale magnetic field together with the uncertainties on the large scale field , this distribution can not be expressed directly .",
    "nevertheless , it can be obtained by marginalizing the joint posterior distribution of the velocity field and the magnetic field as following : @xmath90    according to @xcite the distribution on the right hand side of relation ( [ posterior1 ] ) can be decomposed into : @xmath91 with @xmath92 the joint prior distribution of the vf and the mf , @xmath93 the distribution of the sv , which is constant with respect to both @xmath94 and @xmath95 , and finally @xmath96 the likelihood distribution . because @xmath94 and @xmath95 are a priori assumed to be independent random variables their joint distribution can be split into two distributions such as : @xmath97 the prior distribution of the vf @xmath98 is assumed to be gaussian with the following general form : @xmath99}{(2\\pi)^{\\frac{d}{2 } }     vf vector , which in our case is twice as large as the dimension of the mf and sv , and @xmath100 the velocity covariance matrix chosen to enforce the spatial smoothness of the flow . for this purpose",
    "we impose that : @xmath101 the right hand - side of equation ( [ norm ] ) is composed of two different norms on @xmath94 , namely the bloxham s `` strong norm '' ( @xcite ) for the first one and the standard @xmath102-norm for the second one .",
    "the domain of integration @xmath103 is the surface of the sphere describing the cmb , and the balance factor @xmath104 is chosen to be small enough not to modify the correlation length induced by the bloxham norm .",
    "furthermore , the covariance is rescaled such as the averaged standard deviation of the velocity field intensity is @xmath105km / yr . this implies that at any location of the core - mantle boundary , the probability for the flow intensity to excess the value of @xmath106km / yr , an upper limit calculated by @xcite , is of the order of @xmath107 .",
    "as for the velocity field , the magnetic field @xmath95 is also assumed to be normally distributed , but with a mean @xmath108 corresponding to the resolved mf , and a covariance @xmath109 .",
    "its prior distribution can therefore be expressed as : @xmath110}{(2\\pi)^{\\frac{d}{4}}|\\sigma_{b}|^{\\frac{1}{2 } } } \\label{bprior } \\ . \\ ] ] in this equation the two parts of the mf @xmath111 have different behaviors .",
    "the truncated field @xmath112 is taken from the grimm 2 model with @xmath113 = b_0 $ ] whereas the unknown mf @xmath114 is characterized by the averaged value @xmath115 = 0 $ ] .",
    "since in the grimm 2 model , the core field and the litospheric field are overlapping at large scales , this latter field can be viewed as a source of uncertainties on @xmath112 .",
    "we propose therefore to use the theoretical spectrum of the litospheric field given by @xcite to build the covariance matrix @xmath116 for the resolved scales magnetic field .",
    "this spectrum reads : @xmath117 with @xmath118 the averaged crust magnetization , @xmath119 km the equivalent magnetized layer thickness , and the constants @xmath120 , @xmath121 , and @xmath122 km .",
    "the two functions @xmath123 and @xmath124 are given by : @xmath125 letting the truncated mf @xmath112 being linked to its spectral counterpart @xmath126 through the relation @xmath127 , where the operator @xmath128 projects the coefficients in physical space , and the operator @xmath129 filters the field , and assuming that the litospheric field is isotropically distributed , the covariance of the truncated mf is : @xmath130 \\\\   & \\!\\ ! = \\!\\ ! & \\!\\ !",
    "e \\left[pf\\left ( g_{l , m}^ < - g_{l , m}^0\\right ) \\left ( g_{l , m}^ < - g_{l , m}^0\\right)^tf^tp^t\\right ] \\\\   & \\!\\!= \\!\\!&\\!\\ ! pf \\frac{e_b^l(l)}{(l+1)(2l+1)}f^tp^t \\label{lsmfcovariance}\\ , \\end{aligned}\\ ] ] where @xmath131 are the spherical harmonics coefficients associated with @xmath108 .",
    "the extrapolated sh coefficients of the mf @xmath26 are assumed to individually have a @xmath132 mean and a variance depending on the extrapolated spectrum @xmath133 from @xcite as shown in equation ( [ variances ] ) .",
    "therefore , in physical space , the mf also has a @xmath132 mean at any spatial location and a covariance given by : @xmath134 by combining @xmath116 with @xmath135 , one gets the total covariance @xmath109 for the mf .",
    "the last distribution to characterize is the likelihood distribution which measures the discrepancies between the model ( the filtered frozen flux equation ) and the data ( the secular variation ) .",
    "it reads : @xmath136 } { ( 2\\pi)^{\\frac{d}{4}}|\\sigma_{\\gamma}|^{\\frac{1}{2 } } } \\ , \\label{likelyhood}\\ ] ] where the operator @xmath137 , when applied to @xmath95 , allows to calculate the non linear term of the filtered frozen flux equation @xmath138 , and the covariance matrix @xmath139 is the sv posterior covariance of the grimm 2 model .",
    "all the distributions entering the velocity field posterior distribution being detailed , this latter can be evaluated .",
    "the integral given in equation ( [ posterior1 ] ) has already been calculated by @xcite , so we only present the result which reads : @xmath140 \\label{likelihood1}\\end{aligned}\\ ] ] with : @xmath141 by multiplying the density ( [ likelihood1 ] ) with the prior distribution ( [ prioru ] ) one gets the posterior distribution : @xmath142   \\label{posteriortotj}\\nonumber\\end{aligned}\\ ] ] since this expression does not allow to easily apprehend the effects arising from the modelization of the mf variations on the posterior distribution of the velocity field , we decided to rewrite it into a more intuitive form .",
    "it reads : @xmath143   \\nonumber \\\\   & \\times & \\frac{1 } { |\\sigma_u|^{\\frac{1}{2}}}\\exp\\left[-\\frac{1}{2 }    u^t \\sigma_u^{-1 } u \\right ]   \\times   \\frac{1}{p(\\gamma ) } \\label{posteriortot1}\\\\ \\sigma_{\\tilde{\\gamma } } & = & \\sigma_{\\gamma } + a_{u } \\sigma_b a_{u}^t \\ .\\end{aligned}\\ ] ] this formulation is very similar to the posterior distribution of the velocity field in the case where the magnetic field is exactly know .",
    "indeed this latter distribution can be obtained by simply replacing the covariance matrix @xmath144 by @xmath139 .",
    "one can therefore observe that accounting for the small scale magnetic field and the lithospheric field when formulating the inverse problem in a bayesian framework leads to an increase of the secular variation uncertainties through the quantity @xmath145 .",
    "because of the dependency of this latter term on the velocity field @xmath94 , the maximum of the posterior distribution can not be analytically calculated as already mentioned by @xcite .",
    "nevertheless , it is numerically possible to extract the main statistical characteristics of this posterior distribution using a markov chain monte carlo method ( see @xcite ) .",
    "the algorithm we chose to explore the posterior distribution and the results we obtained are presented in the next section .",
    "the sv , mf and vf are expressed in physical space , therefore the surface of the cmb has been discretized by recursively dividing an initial icosahedron ( see figure [ mesh ] ) . the grid construction and its properties , as well as the approximation of the differential operators are explicited in appendix [ appb ] .",
    "given that the grid is composed of @xmath146 nodes , the vectors @xmath95 , @xmath147 , and @xmath148 are given by : @xmath149          to evaluate the fff model , an inversion of this equation was performed using grimm 2 as well as artificially generated data .",
    "the large scale magnetic field was taken from the grimm 2 model at the epoch @xmath150 , whereas the small scales were randomly generated for sh degree lying between @xmath151 and @xmath152 according to the exponential law ( [ buffett ] ) .",
    "the mf was then filtered ( with @xmath153 km ) such as its smallest scales , which can not be properly represented on the grid , exhibited a low energy level .",
    "this mf is referred as @xmath108 . to create a sv associated with this mf",
    ", we drew randomly a velocity field and used it to advect the mf with the ff equation ( [ frozenflux ] ) .",
    "the velocity field was decomposed into a poloidal and a toroidal part such as : @xmath154 in spectral space , the spherical harmonics coefficients for the poloidal and toroidal field respectively read @xmath155 and @xmath156 . in order to promote interactions between small and large scales , @xmath155 and @xmath156",
    "were extended up to spherical harmonic degree @xmath157 with the following statistical properties : @xmath158 =   e[\\psi_{l , m } ] = 0 \\quad \\forall l , m\\ ] ] @xmath159 & = & c l^{-14/3 } |m|^{-11/3}\\delta_{l l^{\\prime } }   \\delta_{m m^{\\prime } } \\\\",
    "e[\\psi_{l , m } \\psi_{l^\\prime , m^\\prime } ] & = & c   l^{-14/3 } |m|^{-11/3}\\delta_{l l^{\\prime } }   \\delta_{m m^{\\prime } } \\\\ e[\\phi_{l ,",
    "m } \\psi_{l^\\prime , m^\\prime } ] & = & 0   \\quad \\forall l , l^{\\prime},m , m^{\\prime}\\ , \\end{aligned}\\ ] ] where @xmath160 is a normalization constant .",
    "the choice of a @xmath161 power law imposed onto the poloidal and toroidal field correlation allowed to generate a flow with similar statistical properties than a two - dimensional turbulent flow ( see @xcite ) .    to directly simulate the advection of the mf",
    ", a fourth order runge - kutta scheme had been implemented .",
    "the integration time was taken to be @xmath162 year , and the computation was performed on a grid refined @xmath163 times ( with @xmath164 nodes ) .     with an artificial velocity field . ]    in figure [ dtbadvected ] , the spectrum of the resulting secular variation is plotted . as it can be observed , the energy of the sv is maximum at scales lying between @xmath165 and @xmath166 indicating that the mf is strongly affected by the velocity field at these scales .    to mimic the situation encountered when using models fitting satellite data where both the mf and sv can not be entirely taken into account , the artificial fields were truncated at degree 40 .",
    "the resulting mf and sv are respectively referred as @xmath167 and @xmath168 .",
    "these fields were then used as an input for the inversion of the fff equation .",
    "two different filter widths were tested , @xmath54 km , and @xmath169 km . in the latter case",
    "the equation reduces then to the usual ff approximation .",
    "since the statistical properties of the velocity field were exactly known , they were directly injected in the prior information @xmath170 .",
    "no measurement errors on the secular variation and the magnetic field had been generated , therefore the likelihood and the mf prior distributions respectively read : @xmath171 multiplying together these two distributions and marginalizing the result with respect to @xmath95 leads to : @xmath172 with @xmath173 the subgrid stress tensor evaluated with @xmath168 .",
    "the posterior distribution of the velocity field is then proportional to : @xmath174 the bayesian formulation of the problem being described , the discrete velocity field that maximizes the posterior distribution could be determined for the two cases . to do this ,",
    "a particular solution of the equation @xmath175 was calculated .",
    "in addition , the null space of the operator @xmath176 defined such as @xmath177 was parametrized .",
    "the final solution corresponded then to the sum of the particular solution with the null - space one which minimized the prior information on the vf .",
    "the grid used to realize the computation was composed of @xmath178 nodes ( approximately @xmath179 times less than the one taken to advect the mf ) .",
    "for the results to be comparable , the three different velocity fields were truncated at sh degree @xmath180 .",
    "furthermore the artificially generated field as well as the field obtained by inverting the ff approximation ( @xmath169 ) , were filtered with @xmath54 km .                    on the left side of figure [ artificialspectra ] the poloidal and toroidal spectra respectively defined by :",
    "@xmath181 are plotted for the three velocity fields .",
    "the behavior of the spectra associated with the artificial field ( full line ) is correctly reproduced at large scale ( @xmath182 ) by both the ff ( crosses ) and the fff ( circles ) flow models , whereas at sh degree close to the cutoff @xmath183 , the discrepancies between the exact spectra and the spectra of the inverted fields become larger .",
    "nevertheless , the spectra of the difference between exact and inverted fields , displayed on the right side of figure [ artificialspectra ] , show that the use of the fff equation allows to reproduce more accurately the artificial field at almost any scale .",
    "to quantify the spatial error of the two inverted fields , the following quantities were computed : @xmath184 where the integration domain is the surface of the cmb , @xmath94 is the exact filtered velocity field , @xmath185 and @xmath186 are respectively the filtered velocity field obtained by inverting the ff and the fff equations .",
    "the result of these computations shows that although the energy associated to the error fields is weak in comparison to the total energy of the exact flow , performing an inversion of fff approximation reduces the global error on the vf .      in this part",
    "we present a method to sample the posterior distribution @xmath187 given in equation ( [ posteriortot1 ] ) .",
    "since this distribution exhibits a complex form with respect to the velocity field @xmath94 , directly drawing sample from it is impossible .",
    "nevertheless , by building an appropriate markov chain on the vf one can map the distribution ( for a complete description of markov chain monte carlo methods see @xcite ) . for this study we chose an algorithm of the metropolis - hastings type to construct the chain .",
    "the principle of the method is the following :    a.   in the initial step , a vf @xmath188 with @xmath189 is generated .",
    "no particular property have to be imposed on this field , but choosing a field which is as close as possible to the one maximizing the target distribution will allow the chain to converge faster .",
    "b.   from @xmath188 a field @xmath190 is constructed according to some arbitrary transition kernel @xmath191 .",
    "c.   the next step consists in accepting or rejecting the move from @xmath188 to @xmath190 .",
    "therefore , an acceptance probability @xmath192 is defined . in the case of the metropolis - hastings algorithm",
    "this probability is expressed as : @xmath193 d.   the process returns then to step ( b ) with @xmath190 if the move from @xmath188 to @xmath190 is accepted , and with @xmath188 otherwise .    the ensemble is then assumed to be representative of the posterior distribution , once its averaged field as converged towards a fixed vector .",
    "note that this algorithm has already been employed by @xcite for sampling the posterior distribution given in equation ( [ posteriortotj ] ) , but with a different parametrization of the magnetic field and the velocity field .",
    "in particular , only the uncertainties on the large scale mf were considered in these two studies .    as already mentioned previously , analytically calculating",
    "the maximum of the posterior distribution @xmath187 is not feasible .",
    "we therefore decided to approximate it by taking the averaged vf of the ensemble generated by the markov chain , such as : @xmath194      to evaluate our method , we created an artificial set of data , and performed the inversion of the fff equation using these data .",
    "we also compared our results to the ones obtained with alternative approaches .",
    "the construction of the synthetic fields was performed as following :    * * artificial magnetic field * + the large scale mf ( between spherical harmonic degree @xmath29 ) was taken from the grimm 2 model at the epoch @xmath195 .",
    "its spectrum ( the thick black line in the top of figure [ artificialspectra2004 ] ) was then extrapolated up to degree @xmath86 according to the formulation ( [ buffett ] ) of @xcite . from this small scale spectrum , and under the assumption of isotropy and @xmath132 mean of the field ,",
    "a mf was randomly generated and added to the grimm 2 large scale field . in figure [ artificialspectra2004 ] ( top ) the spectrum of the small scale mf is represented by the plus symbols .",
    "* * artificial velocity field * + the coefficients , in spectral space , of the poloidal ( @xmath196 ) and toroidal ( @xmath197 ) fields were assumed to be isotropically distributed with a @xmath132 mean and a covariance @xmath198 derived from the following power law spectrum : @xmath199 where the value of the amplitude @xmath200 was chosen such as the averaged velocity intensity at the cmb was of @xmath201 km.yr@xmath202 . a velocity field extending up to degree @xmath203 was then randomly drawn accordingly to these statistical properties . *",
    "* artificial secular variation * + to generate an artificial large scale sv ( extending up to degree @xmath204 ) , the mf was advected by the vf through the non - linear term of the frozen flux approximation ( [ frozenflux ] ) .",
    "the energy spectrum of the resulting sv is presented with the thick line in figure [ artificialspectra2004 ] ( bottom ) .",
    "the next step of this evaluation was to recover the velocity field according to the magnetic field and the secular variation .",
    "but for this inverse problem to be more realistic , uncertainties were added to the data . a large scale lithospheric field ( @xmath29 ) was randomly generated accordingly to the theoretical spectrum @xmath205 of @xcite ( see equation [ litosphericspectrum ] ) and added to the artificial mf .",
    "this contaminated field was then truncated at degree @xmath204 .",
    "it is referred as @xmath108 and its energy spectrum is plotted on top of figure [ artificialspectra2004 ] with circles .",
    "the uncertainties on the secular variation were built by randomly drawing a field from a gaussian distribution with a @xmath132 mean and a covariance given by the posterior covariance matrix of the grimm 2 secular variation @xmath206 .",
    "the resulting field was then superimposed on the artificial field . the spectrum associated with the total sv",
    "is shown with circles on the bottom of figure [ artificialspectra2004 ] .",
    "( thick line ) , extrapolated mf ( plus symbols ) and grimm 2 mf contaminated with a randomly generated litospheric field ( circles ) .",
    "bottom : secular variation energy spectra .",
    "artificially generated sv ( thick line ) , error field ( plus symbols ) and combination of the two fields ( circles).,title=\"fig : \" ]   ( thick line ) , extrapolated mf ( plus symbols ) and grimm 2 mf contaminated with a randomly generated litospheric field ( circles ) .",
    "bottom : secular variation energy spectra .",
    "artificially generated sv ( thick line ) , error field ( plus symbols ) and combination of the two fields ( circles).,title=\"fig : \" ]    except for the prior distribution of the velocity field @xmath98 , all the distributions derived in section [ baysian ] are consistent to describe the posterior distribution of the velocity field in this test .",
    "we recall that they read : @xmath207 where @xmath208 corresponds to the normal distribution centered in @xmath209 and with covariance @xmath210 , and @xmath211 is the covariance of the mf in which are included the uncertainties due to the lithospheric field and the modelization of the unresolved mf . for this evaluation phase",
    ", the prior distribution of the vf was given by : @xmath212 with @xmath198 the covariance of the vf derived from the power laws ( [ powerlawartificial ] ) .",
    "the estimation of the flow with respect to the artificial mf and sv was then realized with the four algorithms presented below .",
    "* * mcmc method * + in this approach the full posterior distribution of the velocity field @xmath187 is explored with the metropolis - hastings algorithm described in the beginning of the section .",
    "the transition kernel @xmath191 entering the algorithm ( step b ) is derived from the prior distribution of the vf as following : @xmath213}{(2\\pi)^{\\frac{d}{2 } } |\\tilde{\\sigma}_u|^\\frac{1}{2 } }   \\label{transition}\\ , \\ ] ] where the factor @xmath214 allows to rescale the covariance @xmath198 in order to limit the distance of the move from one field to the other . since",
    "this kernel is symmetric with respect to @xmath190 and @xmath188 , the acceptance probability @xmath192 of equation ( [ acceptance ] ) reduces to : @xmath215 the initial field was set to @xmath132 and an ensemble of @xmath216 vf @xmath217 was generated .",
    "we then approximated the flow maximizing the posterior distribution through the averaging operation : @xmath218 * * least square method * + in this method , the magnetic field @xmath95 is assumed to be exactly known such as : @xmath219 as a consequence , the posterior distribution of the velocity field becomes proportional to : @xmath220   \\nonumber \\\\   & \\times & \\exp\\left[-\\frac{1}{2 }    u^t \\tilde{\\sigma}_u^{-1 } u \\right ] \\label{leastsquare}\\ , \\end{aligned}\\ ] ] where @xmath221 is the operator allowing to evaluate the non linear term of the fff equation when it is applied to @xmath94 .",
    "the maximum of this distribution can be calculated analytically and corresponds to the usual least square solution : @xmath222 * * ensemble method * + this approach was developed by @xcite and consists in generating an ensemble of magnetic field and calculating their associated velocity field . in this test",
    ", the ensemble of mf was randomly drawn from the distribution @xmath223 given in equation ( [ priorbtest ] ) .",
    "in total we generated @xmath224 magnetic fields @xmath225 ( with @xmath226 ) extending up to degree @xmath86 .",
    "each velocity field @xmath217 were then determined by the relation : @xmath227 where the operator @xmath228 now depends on each realization @xmath229 of the magnetic field .",
    "the flow solution of the complete inverse problem is given by : @xmath230 * * iterative method * + in this approach , @xcite proposed to determine the cmb velocity field through the following iterative process : @xmath231 where @xmath232 is the index of the iteration , and the covariance @xmath233 is given by : @xmath234 with @xmath235 the operator depending on the velocity field @xmath188 , and which allows to evaluate the non linear term of the fff equation when it is applied to @xmath95 . in the numerical implementation of this method , the initial field @xmath236 was taken as the one solution of the least square approach . + note that this algorithm provides an estimation of the maximum of the posterior distribution given in equation ( [ posteriortot1 ] ) if the quantity @xmath237 is assumed to vary slowly with respect to @xmath94 .",
    "in the previous section we mentioned the algorithm of @xcite which also allows to take into account the variations of the mf in the inverse problem .",
    "we decided not to implement it in this evaluation since it is an approximation of the method proposed by @xcite .    to compare the different approaches , the artificial velocity field @xmath94",
    "is decomposed into a toroidal ( @xmath197 ) and a poloidal ( @xmath196 ) field , with @xmath156 and @xmath155 their respective spectral counterpart .",
    "the same operation is performed on the velocity fields @xmath238 given by the four inversion methods .",
    "their toroidal and poloidal parts are then referred as @xmath239 and @xmath240 in physical space , and @xmath241 and @xmath242 in spectral space .    to measure the accuracy , scale by scale , of the various fields , we define the poloidal and toroidal error fields as : @xmath243 and their associated energy spectra : @xmath244    in figure [ errorspectra2004 ] the spectra of the error fields ( symbols ) are plotted together with the poloidal and toroidal spectra of the artificial velocity field ( solid lines ) .",
    "the first observation one can make is that above the sh degree @xmath245 , the energy associated with the poloidal and toroidal error is of the same order than the energy of the artificial fields .",
    "this implies that above this degree , the estimation of the flow is not reliable whatever the method employed to determine it . at large scale , the performance of the different approaches varies strongly .",
    "whereas the flow obtained with the least square method ( triangles ) is the one which deviates the most from the artificial flow , the velocity fields evaluated with the iterative method ( circles ) and the mcmc algorithm ( plus symbols ) are the ones presenting the lowest error intensities . in between , in terms of accuracy , lies the ensemble method ( crosses ) .",
    "it can be noted that at degree @xmath246 and between @xmath246 and @xmath247 for respectively the ensemble and the least square method , the energy associated with the toroidal error field is larger than the energy of the artificial field itself .",
    "this is not the case anymore when using the iterative or mcmc approaches .        to evaluate the different models in physical space , the coefficients associated with the poloidal and toroidal error fields ( equations [ poloerror2004]-[toroerror2004 ] ) were truncated at degree @xmath245 , since at smallest scales the uncertainties are maximal , and projected in real space .",
    "figure [ errorfield2004 ] shows the intensity of these fields at the level of america for the four approaches .",
    "although the locations of the errors are similar , their intensities differs strongly from one flow to the other .",
    "a computation of the averaged energy associated with the poloidal and toroidal error fields ( see table [ tableerror ] ) shows that globally the best approximation of the artificial velocity field is provided by the mcmc algorithm , followed in order by the iterative , ensemble and least square methods .",
    "note that the differences between the mcmc and iterative approach are very low , and since the computation time required to sample the full posterior distribution is much larger than the one to approximate its maximum using the iterative method , if one wants to determine the flow without its underlying uncertainties , using the algorithm of @xcite is certainly more appropriate .",
    ".averaged energy of the error in km@xmath248yr@xmath249 associated with the different inverted velocity fields .",
    "these values have to be compared with the averaged energies of the artificial poloidal and toroidal fields which are respectively of @xmath250 km@xmath248yr@xmath249 and @xmath251 km@xmath248yr@xmath249 . [ cols=\"<,^,^,^,^\",options=\"header \" , ]     , of the difference between the artificial velocity field and the velocity fields evaluated with the following approaches : mcmc ( top left ) , iterative from @xcite ( top right ) ensemble from @xcite ( bottom left ) and least square ( bottom right ) . ]    since the mcmc algorithm provides an information on the flow uncertainties , we extracted the standard deviation of the velocity intensity @xmath252 , from the variance @xmath253 as following : @xmath254 p(u|\\gamma ) \\mathrm{d}u\\ ] ] where the term @xmath255 means that only the diagonal elements of the matrix lying within the brackets are kept . at each node of the discrete cmb , the vf @xmath94",
    "is composed of a polar and an azimuthal component , so to get the variance associated with the velocity intensity @xmath256 , the variance of each component has to be summed up . in figure [ sdevaluation ]",
    "the quantity @xmath257 , corresponding to the @xmath258 confidence interval on the flow intensity , is displayed at the level of @xmath259 .",
    "this picture presents a pessimistic view of the uncertainties to be expected when evaluating the flow maximizing the posterior distribution .",
    "because the probability for the real flow to lie within the tails of the posterior distribution is very low , the predicted error will globally be larger than the effective one .",
    "nevertheless , locations where the differences between the solution flow and the real one are important corresponds to areas of high posterior variance .",
    "confidence interval on the velocity intensity in km.yr@xmath202 according to the mcmc flow ensemble . ]    finally , we wanted to measure the impact of the velocity field prior information on the solution of the inverse problem .",
    "we therefore realized a simulation with the iterative algorithm of @xcite , in which only the covariance matrix of the velocity field @xmath198 of equation ( [ iterativelesur ] ) has been modified .",
    "instead of being the covariance imposed to generate the artificial velocity field , this latter was replaced by the covariance @xmath260 defined in equation ( [ norm ] ) and derived from the bloxham s `` strong norm '' .",
    "we then calculated , as previously , the averaged energy of the error field using the velocity field we obtained .",
    "it is of @xmath261 km@xmath248yr@xmath249 and @xmath262 km@xmath248yr@xmath249 for respectively the poloidal and toroidal part of the error .",
    "this shows us that the choice of the prior information on the velocity field influences in a significant manner the results of the inverse problem .",
    "nevertheless , it can be noticed that the intensity of the error in this case remains lower than the intensity of the error for the flow resulting from the least square approach , showing the importance of modeling the possible variations of the mf .      in the simulation we realized , the mf and the sv as well as the covariance for the sv ,",
    "are given up to sh degree @xmath204 by the grimm 2 model of @xcite for the epoch @xmath0 .",
    "for the magnetic field , the covariance associated with its large scales ( @xmath263 ) is derived from the theoretical spectrum of the litospheric field of @xcite as shown in equations ( [ litosphericspectrum])-([lsmfcovariance ] ) , whereas the extrapolation of the mf spectrum proposed by @xcite is used to build the covariance matrix of the small scale mf ( @xmath264 ) as presented in equation ( [ ssmfcovariance ] ) .",
    "the velocity field is extended up to sh degree @xmath203 , and its prior distribution is given by the relation ( [ prioru ] ) .",
    "the width of the filter has been set to @xmath54 km , and the initial field of the markov chain @xmath238 , is the velocity field solution of the least square approach : @xmath265 with @xmath266 .    as for the synthetic test of section [ mcmcevaluation ] ,",
    "the transition kernel @xmath191 was derived from the prior distribution of the vf as shown in equation ( [ transition ] ) .",
    "the metropolis - hastings algorithm was then numerically simulated on a discrete cmb refined 4 times .",
    "an ensemble of @xmath267 vf @xmath94 mapping the posterior distribution have been generated .",
    "the velocity field @xmath268 maximizing the posterior , is approximated by taking the average field of the ensemble we created .     and its intensity for the epoch @xmath0 .",
    "]    in figure [ vf2005 ] , the vector field @xmath268 and its intensity are displayed in different locations of the core mantle boundary .",
    "many features of the flow we obtained have already been reported in previous studies .",
    "in particular , the eccentric and planetary scale anticyclonic gyre observed by @xcite and @xcite is also present in the flow we calculated .",
    "this observation reinforces the hypothesis that the fluid motions in the outer core can be well - described by the compressible quasi - geostrophic assumption , a constraint a priori applied in both studies .",
    "nevertheless , according to our results , deviations from quasi - geostrophy ( qg ) have also to be expected .",
    "indeed , under this hypothesis , the flow is forced to be symmetric with respect to the equator outside the tangential cylinder , a condition which is not fulfilled everywhere in our case .",
    "although the symmetric part of the velocity field is dominant in our simulation ( @xmath269 of the energy of the total vf is concentrated in its symmetric components ) certain patterns , such as the flow crossing the equator below india or the larger intensity of the westward drift in the southern hemisphere are violating this property .",
    "the flow we obtained also exhibits a much smoother spatial behavior than the ones presented by @xcite .",
    "this is certainly due to the choice we made to characterize a priori the velocity field . through the bloxham s `` strong norm ''",
    ", we imposed a very steep spectrum ( in @xmath270 ) to both the poloidal and toroidal field , as a consequence the intermediate scales of the vf were probably over - damped in our simulation .     for the epoch @xmath0 and its associated uncertainties on the intensity @xmath271 in km.yr@xmath202 ( left ) and orientation @xmath272 in degree ( right ) .",
    "]    possessing the full posterior distribution of the vf allows to extract many useful information on the flow .",
    "in particular the uncertainties on the velocity field intensity and orientation ( with respect of course to the prescribed modelization ) can be evaluated at any spatial location on the grid . to compute the standard deviation of the velocity field intensity @xmath271 we followed the protocol given in section [ mcmcevaluation ] , whereas the standard deviation of the velocity orientation @xmath272 , is derived from the formula : @xmath273 p(u|\\gamma ) \\mathrm{d}u \\ , \\ ] ] where @xmath274 is the angle , in degree , between the velocity field @xmath94 and @xmath268 .",
    "the quantities @xmath271 and @xmath272 , are displayed in figure [ uncertainties2005 ] ( on the left for the @xmath271 and on the right for the @xmath272 ) .",
    "this figure first shows that a strong ( resp .",
    "weak ) uncertainty on the intensity coincides with a strong ( resp .",
    "weak ) uncertainty on the orientation of the flow .",
    "secondly one can notice that the uncertainties are not homogeneously distributed on the surface of the cmb . while the planetary scale eccentric gyre seems to be very robust , the vf at the level of the pacific ocean is much more uncertain .",
    "it is known that in this latter area the magnetic field activity is moderate ( @xcite ) . as a consequence",
    "the secular variation is low , and its associated uncertainties , due to the inaccuracy of the measurements and to the interactions between the unresolved mf and the vf , may be larger than the signal itself .",
    "it is therefore very difficult to evaluate the velocity field in this region .",
    "nevertheless , this maps shows that there is a large part east of australia and around the longitude of new - zealand where the vf can be accurately estimated .",
    "another particular feature can be noticed at the level of the north - atlantic ocean , where the uncertainties on both the flow intensity and orientation are very large . as already questioned by @xcite ,",
    "the robustness of the clockwise gyre usually observed in this area by models assuming tangential - geostrophy seems to be very weak according to our results .",
    "( thick line ) , and with the spectral uncertainties ( circles).,title=\"fig : \" ]   ( thick line ) , and with the spectral uncertainties ( circles).,title=\"fig : \" ]    since we are using truncated mf and sv it may be interesting to investigate the spectral properties of the posterior vf .",
    "the poloidal @xmath196 and toroidal @xmath197 part of the vf @xmath94 are expanded in spherical harmonics .",
    "the resulting fields are respectively referred as @xmath155 and @xmath156 .",
    "the same operation is performed on @xmath275 , with @xmath276 and @xmath277 its poloidal and toroidal sh coefficients . in figure [ spectraluncertainty ]",
    "are plotted the spectra associated with @xmath276 and @xmath277 as well as the variance on these coefficient summed up over the order @xmath14 and rescaled by the factor @xmath278 .",
    "we can observe that the largest scales of the flow are dominated by the toroidal field .",
    "a computation of the poloidal and toroidal energy shows that more than @xmath279 of the total energy is of toroidal nature .",
    "the other information which can be extracted from figure [ spectraluncertainty ] is that , as for the synthetic test we realized previously , above the sh degree @xmath245 , the intensity of the flow uncertainties becomes larger than the intensity of the flow itself . as a consequence",
    "the evaluation of the small scale velocity field can not be considered as reliable .",
    "it has to be emphasized that all the results we obtained are conditioned by the choice of the prior information imposed to the flow , and should not be considered as absolute . in particular the globally low level of uncertainties on the flow solution is certainly a consequence of the strong regularization we employed .",
    "in this study we have presented a new method to determine the velocity field at the earth s core mantle boundary according to an outer core magnetic field and secular variation model .",
    "we showed that using an appropriate dynamical equation to prescribe the large scale magnetic field evolution in the inverse problem , permitted to reduce the modeling errors arising from the truncated nature of the available fields .",
    "we also demonstrated that the bayesian formalism we developed to account for the large scale uncertainties on the magnetic field and to model the unresolved small scale mf , allowed to properly describe the inverse problem as soon as the information introduced a priori were accurate . through the evaluation of our method and the comparison with other approaches",
    ", we could indirectly confirm that the unresolved part of the magnetic field contributed significantly to the observed secular variation , and that its modelization was necessary to obtain a more accurate description of the flow at the core mantle boundary .",
    "when we applied our method to real data , provided by the grimm 2 model for the epoch @xmath0 , we could recover many features of the flow already observed in previous studies where a different prior information on the velocity field had been considered .",
    "in particular we could retrieve the planetary - scale eccentric gyre characteristic of flow evaluated under the compressible quasi - geostrophy assumption ( see @xcite ) . nevertheless , according to our simulation , the flow is crossing the equator below india and the intensity of the westward drift is the larger in the southern hemisphere , indicating that the equatorial symmetry imposed by the quasi - geostrophy hypothesis is broken . through this observation",
    "one can conclude that deviations from quasi - geostrophy should be allowed to occur when this latter constraint is imposed in the inverse problem .",
    "another specificity of the velocity field we obtained is its very smooth spatial behavior .",
    "this property is certainly induced by the prior distribution of the velocity field we chose , since this latter imposes a very steep spectrum to both the poloidal and toroidal part of the velocity field .",
    "finally , thanks to the ensemble of velocity field we generated to map the posterior distribution , we could evaluate the uncertainties associated with the flow solution of the inverse problem . according to our results , whereas on the one hand , the robustness of the flow is questioned in many area , and particularly in almost the entire pacific ocean , and in the northern part of the atlantic ocean , on the other hand , the planetary - scale eccentric gyre seems to be a very robust structure . from the evaluation of the uncertainties in spectral space , we concluded that the flow at the cmb could only be accurately estimated at large scales ( between spherical harmonics degree @xmath280 and @xmath281 ) .",
    "in cartesian space , applying a gaussian filter to a scalar or a vector field , or letting the field evolve through a diffusion process can be interpreted as being similar operations .",
    "indeed , the kernel of the gaussian filter is : @xmath282 where @xmath283 corresponds to the spatial dimension , @xmath50 is the filter width , and @xmath167 is a constant usually set to @xmath284 .",
    "the solution of the diffusion equation : @xmath285 where @xmath286 is a diffusion coefficient and @xmath287 the time , is the convolution between the scalar field @xmath288 , and the green function : @xmath289 so if one sets @xmath290 , diffusing a scalar field through equation ( [ diffusion ] ) is equivalent to filtering that field with the convolution kernel expressed in ( [ cartesiankernel ] ) .",
    "based on this observation , @xcite derived a gaussian - like filter on the surface of a sphere of radius @xmath16 , by determining the convolution kernel of the spherical diffusion equation : @xmath291 which reads : @xmath292 where @xmath293 is the spherical harmonic of degree @xmath13 and order @xmath48 .",
    "so in spectral space , the filtering operation of a scalar field @xmath43 expanded in spherical harmonics : @xmath294 simply reduces to the operation : @xmath295",
    "the grid describing the core mantle boundary is obtained by recursively subdividing an initial icosahedron as explained in @xcite . for each grid refinement procedure",
    ", a node is added in the middle of the geodesic arc linking every two neighboring points .",
    "the refinement degree @xmath296 of the grid corresponds to the number of time this procedure has been applied .",
    "therefore @xmath297 corresponds to the icosahedron itself which possess @xmath298 nodes , and @xmath299 spherical triangle cells . as the refinement degree increases , the number of grid points and cells increases as : @xmath300    to approximate differential operators , a voronoi - based finite volume method is chosen .",
    "this approach has been widely used in advection - diffusion problems such as in @xcite and has proven to be efficient to tackle these kind of problems . since in finite volume methods , differential operators are converted to surface integrals , control volumes ( or voronoi cells ) surrounding each grid points have to be defined .     of the different spherical triangles",
    "@xmath302 and @xmath303 denote respectively the unit vectors normal and tangential to the voronoi cell contour .",
    "b ) spherical triangle formed by the three nodes @xmath304 , @xmath305 and @xmath306 .",
    "@xmath307 corresponds to the gravity center of the triangle , and @xmath308 , @xmath309 , and @xmath310 are the area of the three sub - triangles . ]",
    "as shown in figure [ operators ] a ) , each grid point is surrounded by @xmath284 ( or @xmath311 when the point corresponds to a generator of the initial icosahedron ) nodes in its direct neighborhood . from this cluster of node",
    ", one can build an ensemble of spherical triangle cells @xmath312 all connected together by the common vertex @xmath304 .",
    "taking the gravity center @xmath307 of each cell allow then to draw a hexagonal ( or pentagonal ) volume control around the central node @xmath304 .",
    "@xcite have shown that moving the grid points in a manner that they coincide with the gravity center of their control volume , allows to improve the accuracy of the differential operators to the second - order .",
    "the procedure employed here is the constrained centroidal voronoi tessellations(ccvt ) developed by @xcite .",
    "the principle of this procedure as we implemented it , known as the lloyd s method , is the following :    1 .   starting with an initial distribution of nodes on the sphere , taken here as the different subdivision of the icosahedron , as explained previously in this part .",
    "2 .   building the voronoi cells associated with each grid point .",
    "moving each node to the gravity center of the cell it is belonging to .",
    "4 .   returning to step 2 until some convergence criteria is reached . in our case",
    ", we imposed that the averaged geodesic distance between the node and the gravity center of the voronoi cell has to be smaller than @xmath313 .",
    "the horizontal divergence and curl applied to a vector field @xmath314 , and the gradient applied to a scalar field @xmath196 can be expressed in their integral form as : @xmath315 where the control surface as an area @xmath103 , delimited by the contour @xmath316 , and the unit tangential and normal vector to the contour are respectively @xmath317 and @xmath318 .    on the discrete sphere ,",
    "vector and scalar fields are known on the nodes , therefore , to differentiate them , one need to approximate them on the contour of the voronoi cells .",
    "first the different quantities are evaluated on the corners of the cells : @xmath319 where the areas @xmath308 , @xmath309 , @xmath310 are shown in figure [ operators ] b ) .",
    "then , following the notation of figure [ operators ] a ) the discrete approximation of the different differential operators becomes : @xmath320 where @xmath321 corresponds to the area of the control volume , @xmath322 is the geodesic length between the points @xmath323 and @xmath324 , and @xmath325 is the number of vertices of the control volume . note that when the subscript @xmath326 then @xmath327 ."
  ],
  "abstract_text": [
    "<S> the inverse problem which consists of determining the flow at the earth s core mantle boundary according to an outer core magnetic field and secular variation model , has been investigated through a bayesian formalism . to circumvent the issue arising from the truncated nature of the available fields , we combined two modelization methods . in the first step , </S>",
    "<S> we applied a filter on the magnetic field to isolate its large scales by reducing the energy contained in its small scales , we then derived the dynamical equation , referred as filtered frozen flux equation , describing the spatio - temporal evolution of the filtered part of the field . in the second step , we proposed a statistical parametrization of the filtered magnetic field in order to account for both its remaining unresolved scales and its large scale uncertainties . </S>",
    "<S> these two modelization techniques were then included in the bayesian formulation of the inverse problem . to explore the complex posterior distribution of the velocity field resulting from this development </S>",
    "<S> , we numerically implemented an algorithm based on markov chain monte carlo methods . after evaluating our approach on synthetic data and comparing it to previously introduced methods , we applied it on real data for the single epoch @xmath0 . </S>"
  ]
}