{
  "article_text": [
    "in recent years , fourier - based methods , originally introduced by moulinec _ et al . _",
    "@xcite , have become ubiquitous for computing numerically the properties of composite materials , with applications in domains ranging from linear elasticity  @xcite , viscoplasticity [ instead of ` thermoplasticity ' ]  @xcite , and crack propagation  @xcite to thermal and electrical  @xcite and also optical properties  @xcite .",
    "the success of the method resides in its ability to cope with arbitrarily complex and often very large microstructures , supplied as segmented images of real materials , for example , multiscale [ instead of ` multistage ' ] nanocomposites  @xcite , austenitic steel  @xcite , granular media  @xcite or polycrystals [ instead of ` polycrystal ' ]  @xcite .",
    "this technique allows maps of the local fields to be computed in realistic microstructures .",
    "such fields are representative of the material behavior if the resolution is small enough , and if the system size is large enough , compared with the typical length scale of the heterogeneities .",
    "contrary to finite - element methods ( fem ) where matrix pre - conditioning often necessitates additional memory occupation , fast - fourier - transform ( fft ) methods are limited only by the amount of ram or fast - access computer memory required to store the fields .",
    "the use of an image and of its underlying equispaced grid , however , comes with drawbacks not seen in fem .",
    "first , fft methods will ultimately be less efficient when dealing with highly porous media such as foams , where voids need to be discretized .",
    "second , interfaces are crudely rendered when using voxel grids , although smoothness can be somewhat recovered by introducing intermediate properties between phases  @xcite .",
    "this matter is the most important one for ideal microstructure models where interfaces are completely known ; less so when dealing with experimental images where such information is usually absent .",
    "third , the representation of the fields in terms of harmonic functions introduces oscillations around interfaces , which is akin to gibbs s phenomenon .",
    "high - frequency artifacts are conspicuous in many field maps where oscillations are visible .",
    "fourth , the fourier representation presupposes periodicity ; that is , the microstructure is seen as the elementary cell of an infinite , periodic medium .",
    "however , finite - size effects associated to periodic boundary conditions are generally smaller than that of uniform boundary conditions used in fem  @xcite .    in the present work , use is made of an alternative discretization of the green function , leading to a revisit of some previously developped fft algorithms .",
    "specifically , their performances in terms of accuracy and speed are investigated .",
    "our paper is organized as follows : the numerical problem and fft algorithms are presented in secs .",
    "[ sec : prob ] and  [ sec : fftmethods ] , respectively .",
    "an alternative discretization is introduced in section [ sec : green ] .",
    "the accuracy of the local fields is investigated in section [ sec : local ] and the convergence properties of fft schemes , using the modified and unmodified green functions , are studied in section [ sec : results ] .",
    "finally , a specific implementation of the fft method using the modified green function is proposed in section [ sec : speed ] .",
    "[ sec : ls ] this work investigates the numerical computation of the electric field @xmath0 and current @xmath1 ( @xmath2 , ... , @xmath3 ) , in a @xmath3-dimensional cubic domain @xmath4^d$ ] of width @xmath5 for @xmath6 or @xmath7 .",
    "the fields verify  ( chapter 2 in  @xcite ) @xmath8 where @xmath9 is the electric potential and @xmath10 is the local conductivity tensor of the material phase at point @xmath11 .",
    "thereafter , for simplicity , all media are locally linear and isotropic so that @xmath12 , with @xmath13 a scalar field . only binary composite media are considered in this study , in which inclusions have variable conductivity @xmath14 , and where conventionally @xmath15=1 in the matrix .",
    "edges of @xmath16 are aligned with the cartesian axis of unit vectors @xmath17 .",
    "periodic boundary conditions are employed , in the form @xmath18 where @xmath19 denotes anti - periodicity , @xmath20 is the outer normal along the boundary @xmath21 of @xmath16 and @xmath22 is the applied electric field .",
    "they ensure that the current and the electric field verify equation  ( [ eq : edp ] ) along the boundary @xmath21 of the periodic medium .",
    "note that @xmath22 represents a macroscopic electric field so that @xmath23 , where @xmath24 is the volume average over @xmath16 .",
    "all fft methods proceed from lippmann - schwinger s equation  ( @xcite p.  251 ) @xmath25 where @xmath26 is an arbitrary reference conductivity , @xmath27 and @xmath28 are the associated polarization field and green operator , respectively , and @xmath29 is the convolution product .",
    "an equivalent ` dual ' formulation stems from writing the problem in terms of the electric current as @xmath30 where @xmath31 is the reference resistivity , and @xmath32 is the prescribed macroscopic current .",
    "the green operator associated to the governing equation for the current reads @xmath33\\delta_{ij}-\\sigma^0g^0_{ij}(\\mathbf{x})\\right\\rbrace,\\ ] ] where @xmath34 is dirac s distribution and @xmath35 is the kronecker symbol .",
    "thus , for all @xmath36 , @xmath37 in particular , @xmath38 and equation  ( [ eq : ls2 ] ) enforces @xmath39 . the fft algorithms considered in this paper rest on evaluating the convolution product in equation ( [ eq : ls1 ] ) or ( [ eq : ls2 ] ) in the fourier domain , using fft libraries .",
    "although most of fft methods have been introduced in the context of elasticity , their adaptation to conductivity problems is straightforward .",
    "hereafter , all fft algorithms are formulated in this setting .",
    "[ subsec : fftalg ] equation ( [ eq : ls1 ] ) is the basis of the simplest method , the ` direct ' scheme  @xcite .",
    "iterations consist in applying the following recursion : @xmath40,\\ ] ] where @xmath41 is the electric field at iteration @xmath42 .    over time ,",
    "refined fft algorithms with faster convergence properties have been devised , notably the ` accelerated '  @xcite and ` augmented - lagrangian '  @xcite schemes .",
    "both algorithms can be encapsulated in the formula  @xcite @xmath43-\\mathbb{h}^0\\ast \\mathbf{e}^k}{\\alpha(\\sigma+\\beta\\sigma^0)}\\ ] ] where @xmath44 for the augmented - lagrangian scheme and @xmath45 , @xmath46 for the ` accelerated ' one .",
    "our formula differs from equation  ( 13 ) in  @xcite because of a different definition of @xmath26 .",
    "another scheme , the so - called ` polarization ' scheme where @xmath47 is prescribed instead of @xmath48 , can be described by an equation similar to ( [ eq : alphabeta ] )  @xcite .",
    "the alternative ` variational ' algorithm  @xcite relies on two distinct ideas .",
    "first , equation  ( [ eq : ls1 ] ) is written as : @xmath49\\ast p_j= \\overline{e}_i.\\ ] ] upon discretization , this equation is transformed into a linear system @xmath50 , which is solved by conjugate - gradient descent . the operator @xmath51 is never computed . instead",
    ", ffts are used to provide @xmath52 for any @xmath27 , which is sufficient for applying the descent method .",
    "second , the discretization employed amounts to using constant - per - voxel trial polarization fields .",
    "this leads to a rule for computing @xmath53 on voxels that lie on interfaces , and to a representation of the green operator as a slowly converging series for which approximations are available  @xcite .",
    "other fft methods have been proposed , including an alternative ` conjugate - gradient ' scheme  @xcite different from the variational one , and yet another one in which the convolution product is carried out in the direct space  @xcite . for conciseness ,",
    "these and the ` polarization ' scheme will not be considered further .",
    "the dual formulation ( [ eq : ls2 ] ) allows one to derive dual algorithms for all fft methods .",
    "for instance , substituting @xmath54 , @xmath28 , and @xmath26 by @xmath55 , @xmath56 , and @xmath57 in equation  ( [ eq : alphabeta ] ) , the dual augmented - lagrangian scheme reads : @xmath58-\\mathbb{g}^0\\ast \\mathbf{j}^k}{1/\\sigma+\\rho^0}.\\ ] ]    all of these methods involve a reference conductivity @xmath26 , or a reference resistivity @xmath57 . whereas the final result is in principle independent of these quantities , their values [ instead of ` value ' ] have a dramatic influence on the convergence properties of the algorithms .",
    "notably , optimal convergence of the accelerated scheme is obtained with the choice  @xcite @xmath59 where the use of a negative reference conductivity ( devoid of physical meaning ) is warranted by the arbitrary character of the reference medium . in this connection , we point out that in ref .",
    "@xcite , which addresses the analogous elasticity problem , the reference stiffness moduli have their sign changed , which avoids dealing with negative values .",
    "for the  direct \" scheme , optimal convergence properties were studied in the context of elasticity  @xcite . adapting the method used in the latter reference to the conductivity problem , it is straightforward to show that the corresponding optimal choice is @xmath60 a result to be used extensively below .",
    "in practice , the domain @xmath16 is discretized as a two - dimensional ( 2d ) pixel image , or three - dimensional ( 3d ) voxel image .",
    "the convolution product @xmath61 in  ( [ eq : ls1 ] ) is evaluated in the fourier domain as @xmath62 where the fourier mode components take on values @xmath63 ( @xmath2 , ... , @xmath3 ) , and @xmath5 is measured in pixel / voxel size units .",
    "the vector @xmath64 is the fourier transform @xmath65 where the sum is over all pixels / voxels @xmath11 in @xmath16 .",
    "classically , the fourier transform of the green operator used in ( [ eq : greenfour ] ) is approximated by its continuum expression @xmath66 where the integration is over the infinite domain and @xmath67 .",
    "we call hereafter this version of the green operator the ` continuous ' green operator .",
    "this name is choosen as a matter of convenience as the operator @xmath28 is only the discretization , on a regular grid , in the fourier domain , of the continuum green operator .    on the other hand , intrinsically discrete schemes can be considered .",
    "for instance , in the context of continuum mechanics , modified green operators have been introduced , where partial derivatives are approximated by centered  @xcite or forward  @xcite differences . in the conductivity problem",
    ", the latter discretization amounts to solving a resistor network problem  @xcite @xmath68 where @xmath1 represents the current along the bond pointing in the direction @xmath69 from point @xmath11 , and @xmath9 is the potential at node @xmath11 .",
    "the same fields are used as approximations of the exact solution in a continuous medium .",
    "the nodes in the network are mapped to the corners of each voxel and the bonds are mapped to the edges ( see figure  [ fig : schema ] ) . in this setting , the electric field and current are estimated at edge centers , which turns ( [ eq : rn ] ) into the centered scheme @xmath70 here again , derivatives are approximated by differences over points separated by one voxel size , unlike in  @xcite .",
    "discretizations  ( [ eq : rn2 ] ) and  ( [ eq : rn ] ) are equivalent up to a translation of @xmath71 and @xmath72 by a vector @xmath73 , provided that @xmath74 is constant in each voxel ( see figure  [ fig : schema ] ) . for simplicity , we use  ( [ eq : rn ] ) hereafter .",
    "the ` discrete ' green operator @xmath75 entering the corresponding lippmann - schwinger equation reads  @xcite @xmath76 where @xmath77 and @xmath78 is the complex conjugate . in the fourier domain , the ` discrete ' gradient , divergence and laplacian operators amount to multiplications by @xmath79 , @xmath80 and @xmath81 , respectively , instead of @xmath82 , @xmath82 and @xmath83 when using the continuum green operator  @xmath28 .",
    "likewise , the terms ` divergence - free ' and ` compatible ' depend on the employed discretization . in the long - wavelength limit @xmath84 , these differences disappear and equation  ( [ eq : greendisc ] ) reduces to ( [ eq : greencont ] ) . in the dual setting ,",
    "the discrete green operator associated to the current is defined , mutatis mutandis , as in equation  ( [ eq : greendual ] ) .",
    "hereafter , the operator @xmath75 is referred to as the ` discrete ' green operator .",
    "2d pixel at point @xmath11 with superimposed resistor network ( see equation  [ eq : rn ] ) ; here @xmath85 is oriented from top to bottom and @xmath86 left to right .",
    ", width=226 ]    the representation of the problem in terms of a resistor network result in several useful properties .",
    "first , contrary to the variational algorithm  @xcite , the solution does not depend on the choice for the reference material @xmath26 .",
    "second , the operator @xmath75 is a smooth periodic function , where contrary to @xmath28 , high - frequencies are cut out in the fourier domain .",
    "this is expected to result in better convergence properties .",
    "third , the discretization in ( [ eq : rn ] ) enforces local current conservation , which makes kirchhoff s law hold at each node .",
    "consequently , the outward flow of @xmath55 along a closed surface , defined as a sum of currents over the bonds that pierce the surface , is zero .",
    "as long as they converge , all numerical schemes must deliver the same results for a given choice of green operator .",
    "conversely , choosing one green operator will select one particular approximation to the solution of the problem considered .",
    "it is the purpose of this work to assess the advantages , from the numerical viewpoint , in the context of electrical conductivity , of using @xmath75 in place of @xmath28 .    in this paper , the direct ( ds ) , accelerated ( as ) , augmented - lagrangian ( al ) , and variational ( var ) schemes are investigated .",
    "we also consider the dual versions of ds and al , denoted by @xmath87 and @xmath88 , respectively .",
    "all of these make use of the continuous green operator @xmath28 .",
    "same algorithms , but with the _ discrete _ green operator @xmath89 instead of @xmath28 are also examined .",
    "they are referred to with a ` tilde ' notation as @xmath90 , @xmath91 , @xmath92 , @xmath93 , @xmath94 , and @xmath95 .",
    "we emphasize that the results presented here for the variational approaches var and @xmath93 make use of the green operators @xmath28 and @xmath75 rather than of the more complex discretization proposed in  @xcite . also , in the latter approaches , definite - positiveness of matrix @xmath51 ( see sec .  [",
    "sec : fftmethods ] ) is not guaranteed in the conjugate - gradient procedure .",
    "this specific issue has not been considered further as numerical experiments that we performed indicate that the latter schemes nevertheless converge .",
    "the ` four - cell ' microstructure is one of the few periodic structures for which an exact solution  @xcite is available .",
    "we consider the special case , represented in figure  [ fig:4cells ] , where the elementary cell is made of a single square inclusion of surface fraction @xmath96% . because of the presence of corners ,",
    "fields are singular in the infinite - contrast limit , which makes this case a good benchmark for numerical methods . in this section , numerical results for the current computed with either the continuous green operator @xmath28 or the discrete operator @xmath89 are compared with the exact solution .",
    "the inclusion is highly conducting , with a contrast ratio @xmath97 .",
    "elementary periodic domain @xmath98 with four - cell microstructure .",
    "the inclusion has conductivity @xmath14 and the matrix has conductivity @xmath15 .",
    ", width=302 ]    the behavior of the electric current near the singular corner at point @xmath99 is illustrated in figure  [ fig : localfieldmaps ] .",
    "maps of the vertical component @xmath100 obtained with @xmath28 ( top ) and @xmath89 ( bottom ) are displayed for increasing resolutions ( left to right ) .",
    "only the small region @xmath101 around the corner is shown .",
    "numerical artifacts in the highly - conducting phase are conspicuous when using the continuous green operator @xmath28 .",
    "they consist of high - frequency oscillations all over the conducting region , particularly near the horizontal interface  @xcite , where the represented field component should be continuous .",
    "such oscillations are almost absent when using @xmath89 .    [ cols=\"^,^,^,^ \" , ]      + @xmath93 & n / a & @xmath102 & n / a + & + @xmath87 & @xmath103 ( @xmath104 ) & @xmath105 & @xmath105 + @xmath88 & @xmath106 ( @xmath107 ) & @xmath108 & @xmath109 + @xmath94 & @xmath103 ( @xmath110 ) & @xmath111 & @xmath112 + @xmath95 & @xmath113 ( @xmath114 ) & @xmath115 & @xmath116 +      a more thorough study was carried out for the boolean models , in which the optimal reference conductivity @xmath26 or resistivity @xmath57 was measured as a function of the contrast .    in order to avoid unnecessary long computations , the reference was first manually optimized on a low - resolution grid of size @xmath117 ( in 2d ) or @xmath118 ( in 3d ) .",
    "the optimized reference was then tested on a full - resolution grid of size @xmath119 ( 2d ) or @xmath120 ( 3d ) . in all but a few cases ,",
    "the number of iterations to convergence found with the low - resolution and high - resolution grids was nearly the same .",
    "the number of iterations found on the full - resolution grid was kept if the difference was less than @xmath121 ; otherwise , the reference was optimized again , this time on the full - resolution grid , to provide a definitive number of iterations .",
    "manual optimization of the reference parameters was carried out following a rough dichotomy procedure , disregarding for simplicity the possibility of concurrent local optima .",
    "the convergence criterion was set to @xmath122 in these calculations .",
    "our findings are summarized in the third and fourth columns of table  [ tab : ref ] , where the formulas given essentially represent high - contrast behaviors in the regimes @xmath123 or @xmath124 . indeed , in some cases",
    ", the low - contrast behavior may differ from that given ( see succeeding text ) .",
    "at the exception of scheme @xmath91 in the 3d boolean medium , for which @xmath125 tends to a constant at high contrast notice the symmetry between both high - contrast regimes , the behaviors we observed are of the following types :    @xmath126    where @xmath127 , and @xmath128 and @xmath129 are numerical constants of various signs ( see table i ) .",
    "these forms generalize equations ( [ eq : opteyre ] ) and ( [ eq : optdirect ] ) .",
    "they apply to the ` primary ' schemes , and similar ones hold for the ` dual ' schemes with @xmath74 substituted by @xmath130 .",
    "when nonzero , the coefficient @xmath131 , of order @xmath132 , is of unclear origin .",
    "the coefficients reported in the table were determined by nonlinear least - square fitting on our data .",
    "additional fitting attempts with functional forms other than ( but related to ) those retained indicate that the first digit of the coefficients is significative , whereas the error on the second one is hard to evaluate .",
    "different coefficients @xmath133 and @xmath134 are provided when our results do not support an equality @xmath135 . however",
    ", our results strongly suggest that @xmath135 for the 2d boolean system whenever equation  ( [ eq : lin ] ) applies , while this symmetry does not carry over to the 3d case , except for the ds , where @xmath136 ( exact ) in two and three dimensions .",
    "although the optimum may in some cases be of the same form with the continuous and discrete green operators , there are other cases such as with as and @xmath91 , for which the optimal forms look strongly dissimilar .",
    "moreover , comparing columns 2 and 3 of the table for the contrast @xmath97 indicates that the optima found somewhat depend on the microstructure .",
    "the behaviors gathered in the table are supported by figure  [ fig : fits ] , which presents plots of our 2d and 3d data and the corresponding fitting curves .",
    "the ` primary ' and ` dual ' schemes are addressed in separate plots .",
    "the signs indicated in the table can not be read from the figures , where absolute values are displayed in logarithmic scale . in the 2d boolean model , the data for the primary schemes and for their dual are numerically quite close in this mode of representation , so that the left and right plots superimpose almost exactly .",
    "interestingly , the plots reveal the unique non - trivial behavior of the discrete schemes @xmath92 and @xmath95 in the low - contrast region @xmath137 , where they behave as @xmath138 even though the linear behavior reported in table  [ tab : ref ] takes place at higher contrasts . on the other hand",
    ", the continuous schemes al and @xmath88 @xmath139 instead of ` @xmath140 ' @xmath141 $ ] essentially behave as a square root for all contrasts ( up to a small corrective term in 2d cases ) .",
    "as already noticed in the discussion of the table , the discrete 3d ` accelerated ' scheme @xmath91 with its intriguing asymptotic behavior ( constant on both sides of the contrast range ) stands as an outlier .",
    "for it no fit has been attempted .",
    "we emphasize that in all cases examined with the ` accelerated ' schemes , the optimal square - root estimate ( [ eq : opteyre ] ) exact in scheme as yields poor convergence when applied to @xmath91 .",
    "2d ( top ) and 3d ( bottom ) boolean models .",
    "absolute value of the normalized optimal conductivity @xmath142 vs.  @xmath143 ( left ) , and optimal resistivity @xmath144 vs.  @xmath145 ( right ) , for the schemes indicated .",
    "symbols : fft results .",
    "solid : numerical fits ( see table  [ tab : ref]).,title=\"fig:\",width=253 ]   2d ( top ) and 3d ( bottom ) boolean models .",
    "absolute value of the normalized optimal conductivity @xmath142 vs.  @xmath143 ( left ) , and optimal resistivity @xmath144 vs.  @xmath145 ( right ) , for the schemes indicated .",
    "symbols : fft results .",
    "solid : numerical fits ( see table  [ tab : ref]).,title=\"fig:\",width=253 ]     2d ( top ) and 3d ( bottom ) boolean models .",
    "absolute value of the normalized optimal conductivity @xmath142 vs.  @xmath143 ( left ) , and optimal resistivity @xmath144 vs.  @xmath145 ( right ) , for the schemes indicated .",
    "symbols : fft results .",
    "solid : numerical fits ( see table  [ tab : ref]).,title=\"fig:\",width=253 ]   2d ( top ) and 3d ( bottom ) boolean models .",
    "absolute value of the normalized optimal conductivity @xmath142 vs.  @xmath143 ( left ) , and optimal resistivity @xmath144 vs.  @xmath145 ( right ) , for the schemes indicated .",
    "symbols : fft results .",
    "solid : numerical fits ( see table  [ tab : ref]).,title=\"fig:\",width=253 ]    in 2d , the formula @xmath146 indifferently optimizes the discrete and continuous @xmath93 and var schemes .",
    "we observed similar convergence rates , up to @xmath7% difference in the number of iterations , for these algorithms within the range @xmath147 .",
    "however , outside of this range , the convergence of the var scheme deteriorates . the small sensitivity with respect to the reference material @xmath148 in this method",
    "is supported by other studies  @xcite .",
    "we also investigated the sensitivity to the choice of @xmath26 in the ` direct ' discrete schemes . in the 2d boolean model and for the discrete scheme @xmath90 , the choice",
    "@xmath149 proves optimal , which matches the exact result relative to ds .",
    "however , with @xmath90 , nearly optimal 2d results are also obtained with choices @xmath150 .",
    "by contrast , in 3d , the number of iterations may be extremely sensitive to the choice of @xmath26 .",
    "figure  [ fig : convref ] illustrates this .",
    "it represents the number of iterations versus @xmath26 for @xmath90 in the 3d boolean model , with contrast @xmath151 .",
    "no convergence is observed for @xmath152 , and the optimal choice is about @xmath153 .     3d boolean model .",
    "number of iterations vs.  reference conductivity @xmath26 for the direct scheme with discrete green operator ( @xmath90 ) .",
    "the contrast ratio is @xmath151 .",
    "the convergence criterion is @xmath122 .",
    "the value @xmath154 is represented by the vertical dotted line .",
    "the solid line between data points is a guide to the eye .",
    ", width=377 ]      this section examines convergence performance for the 2d and 3d boolean models , expressed by the number of iterations @xmath155 as a function of the contrast ratio @xmath127 .",
    "figure ( [ fig : conv ] ) illustrates the performance of the various fft schemes considered , in calculations optimized by using the reference conductivity or resistivity discussed in the previous section .",
    "schemes using @xmath28 are represented by filled symbols and the @xmath156 marker , whereas discrete schemes using @xmath89 are represented by empty symbols and the @xmath157 marker .",
    "c   2d and 3d boolean models ( top and bottom ) .",
    "number of iterations vs.  contrast for various fft algorithms .",
    "the convergence criterion is @xmath122 .",
    "solid lines between data points are guides to the eye.,title=\"fig:\",width=415 ] +   +   2d and 3d boolean models ( top and bottom ) .",
    "number of iterations vs.  contrast for various fft algorithms .",
    "the convergence criterion is @xmath122 .",
    "solid lines between data points are guides to the eye.,title=\"fig:\",width=415 ]    we recover known results of linear scaling @xmath158 for ds and @xmath87 , and of square - root scaling @xmath159 for as  @xcite .",
    "similar convergence rates are observed for al and @xmath88 , and for var [ instead of ` for the var ' ] . as a rule ,",
    "given the fft method , the ` primary ' scheme always converges better than the ` dual ' one when @xmath160 , while the opposite holds when @xmath161 .",
    "for instance , at very strong contrast ratio @xmath162 , the convergence of the dual ` augmented - lagrangian ' scheme @xmath88 is much faster than that of the primary one al .    as to discrete schemes , they are much more efficient than their continuous counterparts . for discrete schemes ,",
    "@xmath163 is either a bounded or slowly increasing function of @xmath164 , which shows that using the discrete green operator @xmath89 definitely provides a dramatic improvement of convergence . by optimizing the choice between the ` primary ' or ` dual ' versions of the discrete algorithm at hand depending on whether @xmath160 or @xmath161 , one can even achieve _ convergence in a finite number of iterations _ in the infinite - contrast limit .",
    "overall , the figure shows that among all schemes the discrete version @xmath91 of the as is the better converging one in 2d and 3d .",
    "in applications dealing with large microstructures ( typically , multiscale materials ) fast and memory - efficient implementations of fft methods are required .",
    "one common way of minimizing both cpu speed and memory storage is to recompute the green operator at each iteration .",
    "as long as the green operator is easy to compute , this strategy is usually faster than storing a very large tensor field .",
    "this is used in the craft  @xcite and morph - hom  @xcite softwares . as an example ,",
    "a low - cost implementation of ds is as follows :    initialization : set @xmath165 .    1 .   set @xmath166a_i(\\mathbf{x})$ ] ; 2 .   set @xmath167 ; 3 .   set @xmath168 for @xmath169 and @xmath170 ; 4 .   set @xmath171 ; 5 .   compute convergence criterion ; if convergence is reached , set @xmath172 and stop ; otherwise goto ( i ) .    in this algorithm ffts are computed _ in - place_. step ( iii ) consists of a loop over all modes @xmath173 with @xmath174 computed on - the - fly . in total , memory space is allocated for one vector field @xmath175 plus the microstructure . vector @xmath175 successively stores the polarization field in the real space [ step ( i ) ] and in the fourier domain [ step ( ii ) ] and the electric field @xmath54 in the fourier domain [ step ( iii ) ] and real space [ step ( iv ) ] . the convergence criterion in step ( v ) must be modified , as checking for current conservation by computing criterion @xmath176 with in - place computations is now impractical .",
    "monitoring the differences over two iterations of the first and second moments of the electric and current fields provides practical crieria that are less accurate , but easier to compute .    on the other hand ,",
    "the use of the discrete green operator @xmath89 allows for a more efficient implementation of the ds .",
    "consider the rewriting of equation  ( [ eq : ls1imp ] ) as @xmath177\\ ] ] where @xmath178 is the periodic part of the potential associated to @xmath41 , so that @xmath179 , and where @xmath180 is , symbolically , the inverse laplacian .",
    "equation ( [ eq : dsimp ] ) defines @xmath181 as a unique periodic function up to an irrelevant constant .",
    "when @xmath182 , @xmath178 converges to the potential up to a linear correction @xmath183 . the electric field and current follow from @xmath184 . in the discrete",
    "setting , equivalent to a resistor network , knowledge of a field on adjacent nodes or bonds is sufficient to compute its local divergence or gradient .",
    "thus , the action of the @xmath185 and @xmath186 operators in equation  ( [ eq : dsimp ] ) can be computed in the real space .",
    "this suggests the following alternative implementation of the discrete direct scheme ( @xmath90 ) :    initialization : set @xmath187 .    1 .   at each point @xmath11 ,",
    "set @xmath188 where + @xmath189[\\overline{e}-\\textnormal{\\textbf{grad}}\\ , a(\\mathbf{x})]$ ] ; compute @xmath176 as defined in ( @xmath190 ) ; 2 .",
    "set @xmath191 ; 3 .   set @xmath192 for @xmath169 and @xmath193 otherwise ; 4 .   set @xmath194 ; 5 .   if @xmath195 set @xmath196 , @xmath197 and stop ; otherwise goto ( i ) .",
    "this algorithm exactly implements the @xmath90 scheme .",
    "however , only a scalar field , rather than a vector field , is now allocated in memory .",
    "laplacian inversion is the sole computation performed in the fourier domain .",
    "it takes the form of a division by @xmath81 in step ( iii ) . the field",
    "@xmath198 successively stores the divergence of the polarization field @xmath199 in the real space [ step ( i ) ] and fourier domain [ step ( ii ) ] and , later on , the periodic part of the potential @xmath200 in the fourier domain [ step ( iii ) ] and in the real space [ step ( iv ) ] .",
    "multithreading parallelization in step ( i ) necessitates some care as this step is non - local .",
    "nevertheless , this new implementation reduces the number of ffts per iteration from @xmath201 ( in 2d ) or @xmath202 ( in 3d ) down to @xmath203 .",
    "furthermore , the amount of storage is also reduced by a factor @xmath3 ( @xmath204 floats instead of @xmath205 ) , if we neglect the storage required for the microstructure .",
    "the total cpu time spent using ` direct ' , ` augmented - lagrangian ' and ` accelerated ' schemes is plotted in figure  [ fig : cputime ] as a function of contrast , the scheme ( @xmath90 ) being implemented as outlined earlier .",
    "these tests were carried out with convergence criterion @xmath206 , on the previously considered 3d boolean microstructure discretized on a grid of size @xmath120 ( 16.8 million points ) .",
    "computations were performed in double precision , on a @xmath207-core intel xeon machine , each core running at @xmath208 ghz with @xmath209 bogomips and @xmath210 kb of l2 cache .",
    "best performance is achieved for the @xmath90 scheme when @xmath211 , and with @xmath91 when @xmath212 . using these optimal schemes at infinite contrast ,",
    "convergence is completed in @xmath213 s for insulating inclusions , and in @xmath214 s for infinitely - conducting inclusions .",
    "this strategy has been implemented in the multithreaded fortran code morph - hom developped at mines paristech  @xcite .",
    "cpu time vs. contrast ratio @xmath143 for various fft algorithms , on the 3d boolean microstructure .",
    "the convergence criterion is @xmath215 with @xmath216.,width=415 ]",
    "use of a modified green operator in fft - based schemes has been advocated , in the context of the electrical response of heterogeneous conducting media .",
    "the modification consists in making the operator consistent with the underlying voxel grid , which requires only a very simple adaptation of previously existing algorithms but leads to two major improvements .",
    "first , employing the modified operator leads to much more accurate local fields , particularly in the highly conducting or insulating inclusions and in the vicinity of interfaces .",
    "second , the convergence rate is found to be much faster compared with previous methods , in particular for highly - contrasted media .",
    "quite remarkably the ` direct ' scheme usually considered to be the worst - converging one improves tremendously , as far as cpu time is concerned , by formulating the problem in terms of iterations on the electrostatic potential rather than on the electric field . however , using the modified green operator requires carefully adjusting the reference conductivity @xmath26 , since the latter has a strong influence on convergence properties .",
    "approximate expressions for @xmath26 have been derived numerically , and studied , for the boolean models of microstructure considered in this work .",
    "it has already been noticed in the past that using ` discrete ' versions of green operators leads to promising methods  @xcite . demonstrating that dramatic speed - up improvements follow",
    ", the present work strongly supports this view .",
    "based on previous experience  @xcite , it is expected that our conclusions carry over to continuum mechanics .",
    "the authors are grateful to h.  moulinec for kindly providing some field maps for comparison purposes , which has been a very helpful assistance in this study .",
    "the research leading to the results presented has received funding from the european union s seventh framework programme ( fp7 / 2007 - 2013 ) for the fuel cells and hydrogen joint technology initiative under grant agreement 303429 .",
    "moulinec h , suquet p. a fast numerical method for computing the linear and non linear mechanical properties of the composites .",
    "_ comptes rendus de lacadmie des sciences , srie ii _ 1994 ; * 318*(11):14171423 .",
    "willot f. , pellegrini y - p , idiart mi , ponte  castaeda p. effective - medium theory for infinite - contrast two - dimensionally periodic linear composites with strongly anisotropic matrix behavior : dilute limit and crossover behavior .",
    "_ physical review b _ 2008 ; * 78*(10):104111 .",
    "willot f , jeulin d. elastic and electrical behavior of some random multiscale highly - contrasted composites .",
    "_ international journal for multiscale computational enginneering : special issue on multiscale modeling and uncertainty quantification of heterogeneous materials _ 2011 ; * 9*(3):305326 .",
    "jean a , willot f , cantournet s , forest s , jeulin d. large - scale computations of effective elastic properties of rubber with carbon black fillers . _ international journal for multiscale computational engineering _ 2011 ; * 9*(3):271303 .",
    "belkhabbaz a , brenner r , rupin n , bacroix b , fonseca j. prediction of the overall behavior of a 3d microstructure of austenitic steel by using fft numerical scheme . _ procedia engineering _ 2011 ; * 10*:18831888 .    prakash a , lebensohn r. simulation of micromechanical behavior of polycristals : finite element versus fast fourier transforms . _",
    "modelling and simulation in materials science and engineering _ 2009 ; * 17*(6):064010 .",
    "rollett a , lebensohn r , groeber m , choi y , li j , rohrer gs .",
    "stress hot spots in viscoplastic deformation of polycristals .",
    "_ modelling and simulation in material science and engineering _ 2010 ; * 18*(7):074005 .",
    "lebensohn r , castelnau o , brenner r , gilormini p. study of the antiplane deformation of linear 2-d polycrystals with different microstructures .",
    "_ international journal of solids and structures _ 2005 ; * 42*(20):54415459 .",
    "dunant c , bary b , giorla a , pniguel c , sanahuja j , toulemonde c. , tran a , willot f , yvonnet j. a critical comparison of several numerical methods for computing effective properties of highly heterogeneous materials . _ advances in engineering software _ 2013 ; * 58*:112 .",
    "kanit t , forest s , galliet i , mounoury v , jeulin d. determination of the size of the representative volume element for random composites : statistical and numerical approach .",
    "_ international journal of solids and structures _ 2003 ; * 40*(1314):36473679 .",
    "michel jc , moulinec h , suquet p. a computational scheme for linear and non - linear composites with arbitrary phase contrast . _ international journal for numerical methods in engineering _ 2001 ; * 52*(1 - 2):139160 .",
    "monchiet v , bonnet g. a polarization - based fft iterative scheme for computing the effective properties of elastic composites with arbitrary contrast .",
    "_ international journal for numerical methods in engineering _ 2012 ; * 89*(11):14101436 .",
    "moulinec h , silva f. comparison of three accelerated fft - based schemes for computing the mechanical response of composite materials .",
    "_ international journal for numerical methods in engineering _ 2014 ; * 97*(13):960985 .",
    "[ instead of volume and page numbers left blank ]    brisard s , dormieux l. combining galerkin approximation techniques with the principle of hashin and shtrikman to derive a new fft - based numerical method for the homogenization of composites . _ computational methods for applied mechanical engineering _ 2012 ; * 217*(220):197212 .",
    "zeman j , vodrejc j , novak j , marek i. accelerating a fft - based solver for numerical homogenization of a periodic media by conjugate gradients . _ journal of computational physics _ 2010 ; * 229*(21):80658071 .",
    "yvonnet j. a fast method for solving microstructural problems defined by digital images : a space lippmann  schwinger scheme .",
    "_ international journal for numerical methods in engineering _ 2012 ; * 92*(2):178205 .",
    "moulinec h , suquet p. a numerical method for computing the overall response of nonlinear composites with complex microstructure .",
    "_ computer methods in applied mechanics and engineering _ 1998 ; * 157*(1):6994 .",
    "willot f , pellegrini yp . fast fourier transform computations and build - up of plastic deformation in 2d , elastic - perfectly plastic , pixelwise - disordered porous media . in : _",
    "continuum models and discrete systems cmds 11 _ , jeulin d , forest s ( eds ) . cole des mines : paris , 2008 ; 443449 .",
    "glbart l , mondon - cancel r. non - linear extension of fft - based methods accelerated by conjugate gradients to evaluate the mechanical behavior of composite materials .",
    "_ computational materials science _ 2013 ; * 77*:430439 ."
  ],
  "abstract_text": [
    "<S> a modified green operator is proposed as an improvement of fourier - based numerical schemes commonly used for computing the electrical or thermal response of heterogeneous media . </S>",
    "<S> contrary to other methods , the number of iterations necessary to achieve convergence tends to a finite value when the contrast of properties between the phases becomes infinite . </S>",
    "<S> furthermore , it is shown that the method produces much more accurate local fields inside highly conducting and quasi - insulating phases , as well as in the vicinity of phase boundaries . </S>",
    "<S> these good properties stem from the discretization of green s function , which is consistent with the pixel grid while retaining the local nature of the operator that acts on the polarization field . finally , a fast implementation of the ` direct scheme ' of moulinec _ et al . _ </S>",
    "<S> ( 1994 ) that allows for parsimonious memory use is proposed .    </S>",
    "<S> fft methods ; numerical homogenization ; heterogeneous media ; electrical conductivity    _ nota bene _ : </S>",
    "<S> the present document constitutes a ` postprint ' version of the published paper , in which a few errors in the proofs ( on the present pages 2 , 5 , 15 and 17 ) have been corrected and an incomplete reference on p.  22 has been completed . </S>",
    "<S> these minor corrections are marked out in red . </S>",
    "<S> results are unchanged . </S>"
  ]
}