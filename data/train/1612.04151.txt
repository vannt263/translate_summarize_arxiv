{
  "article_text": [
    "in medical image analysis , registration is a crucial step to analyze two images taken at different times or coming from different sensors or situations .",
    "the problem of image registration can intuitively formulated in the following way : given two images , called _ source _ and _ target _ images , respectively , find an appropriate transformation between the two images , such that it maps the source image onto the target one .",
    "the differences between the two images can derive from different conditions , and for analyzing them we want to make images more similar each other after transformation , for an overview see e.g. @xcite .",
    "in particular , in @xcite , zitov and flusser gave an overview of image registration , and presented different methods to solve this problem .",
    "some methods for image registration are based on landmarks .",
    "the _ landmark - based image registration _",
    "process is based on two finite sets of landmarks , i.e. scattered data points located on images , where each landmark of the source image has to be mapped onto the corresponding landmark of the target image ( see @xcite ) .",
    "the landmark - based registration problem can thus be formulated in the context of multivariate scattered data interpolation . in landmark - based image registration ,",
    "the deformed results are sensitive to the displacements of landmarks .",
    "if the displacement of one landmark is far enough from neighborhood landmarks , the deformation will be large and the geometrical structure will change after transformation . in such case , topology violation could thus occur .",
    "one of the most used methods in landmark - based image registration is the radial basis functions ( rbfs ) method , useful to handle various geometric deformations .",
    "rbfs are functions whose values depend on the distance between points and centers @xcite .",
    "this important property allows the use of rbfs in interpolation problems , such as image registration .",
    "rbfs can be classified in two groups : ( i ) globally supported such as thin - plate spline ( tps ) and gaussian , and ( ii ) compactly supported such as gneiting s , wendland s and wu s functions , see @xcite , respectively .    in general ,",
    "globally supported rbfs ( gsrbfs ) can guarantee the bending energy be small but the deformed field will occur in the whole image after transformation ; conversely , compactly supported rbfs ( csrbfs ) make the influence of the deformation local : around a landmark in 2d images on a circle whereas in 3d images on a sphere . in @xcite , authors analyzed different computational properties of gsrbfs and csrbfs for landmark - based image registration .",
    "however , if gsrbfs or csrbfs are chosen to solve the registration problem , topology should be preserved .",
    "for some rbfs the presence of a shape parameter is an important characteristic .",
    "in fact , a large shape parameter leads to flat basis functions , whereas a small shape parameter results in peaked rbfs @xcite .",
    "therefore , we can use it to control influences on the registration result @xcite .    in @xcite evaluation of topology preservation for different csrbfs in case of landmark - based image registration",
    "was performed .",
    "the authors compared topology preservation of different csrbfs using two criteria : locality parameter and positivity of determinant of the corresponding jacobian matrices for different transformations .",
    "locality parameter is the optimal support size of different csrbfs under topology preservation condition . in @xcite",
    ", we instead evaluated the performances of topology preservation for a gsrbf family such as matrn functions in landmark - based image registration .",
    "the family of gneiting s functions was proposed by gneiting in 2002 for the first time @xcite .",
    "gneiting s functions are oscillatory compactly supported functions and it is known in scattered data interpolation that they achieve good approximation results @xcite .",
    "then , they were used also in image registration , obtaining accurate results @xcite . for this reason in this paper",
    "we analize the topology preservation of gneiting s transformations under the two criteria given above and compare the numerical results with those obtained in the paper @xcite using wendland s and wu s functions .",
    "the paper is organized as follows .",
    "section 2 introduces the landmark - based image registration problem .",
    "section 3 gives definitions of two kinds of gneiting s functions and of the associated transformations . in section 4",
    "we evaluate topology preservation of gneiting s functions in the case of one - landmark .",
    "computations and numerical results are presented .",
    "section 5 deals the four - landmarks schematic diagram case and the landmark - based registration in brain images . finally ,",
    "in section 6 , we report the conclusions and the future work on the topic .",
    "in this paper , we only consider the 2d case . for landmark - based image registration",
    ", we define a couple of landmark sets @xmath0 and @xmath1 corresponding to the source and target images , respectively .",
    "the registration can be described as follows .",
    "the aim is to find a proper transformation @xmath2 between @xmath3 and @xmath4 , such that @xmath5    for image registration , we can interpolate displacements to fulfill the deformation . as we mentioned in section [ sec1 ] , the influence of deformed field is limited by csrbfs . here the displacements can be displayed by a csrbf interpolant @xmath6 , of the form    @xmath7    where @xmath8 stands for a csrbf , @xmath9 is the euclidean distance between @xmath10 and @xmath11 , and the coefficient @xmath12 can be calculated by solving two linear systems . in this way",
    "we obtain the transformation @xmath13 .    following @xcite , when functions @xmath8 are strictly positive definite , the matrix is invertible since all the eigenvalues are positive",
    ". therefore , we have a unique solution of the two linear systems . hence in this paper , all of the csrbfs we consider are strictly positive definite . in the following we list two examples of wendland s ( @xmath14 ) and wu s ( @xmath15 ) functions , i.e. , @xmath16 @xmath17 where @xmath18 is the truncated power function and @xmath19 , @xmath20 being the support function size .",
    "we remark that the larger ( smaller ) @xmath20 is , the larger ( smaller ) the field is .",
    "we will use these functions to compare numerical results of topology preservation obtained by gneiting s transformations .",
    "in this section we introduce the definitions of gneiting s transformations . in 2002 , gneiting obtained a family of oscillating compactly supported functions @xcite . starting with a function @xmath21",
    "that is strictly positive definite and radial on @xmath22 , for @xmath23 , and using turning bands operator @xcite , we get @xmath24 the latter is strictly positive definite and radial on @xmath25 @xcite . in order to obtain gneiting s functions , we start with wendland s functions , for example @xmath26.\\end{aligned}\\ ] ] using the turning bands operator",
    ", we thus obtain the functions @xmath27 which are strictly positive definite and radial on @xmath28 provided @xmath29 . from this family",
    "we list two specific gneiting s functions in @xmath30 , i.e. , @xmath31 @xmath32 under the landmark - based image registration context we define gneiting s transformation as follows .",
    "[ def1 ] given a set of source landmark points @xmath3= \\{@xmath33 } , and the corresponding set of target landmark points @xmath4=\\{@xmath34 } , gneiting s transformation @xmath35 is such that each its component @xmath36 assumes the following form @xmath37 with @xmath38 = @xmath39 and @xmath40 = @xmath41 @xmath42    according to definition [ def1 ] , the transformation function @xmath43 is calculated for each @xmath44 and the coefficients @xmath12 are obtained by solving two systems of linear equations .",
    "from @xcite , under injectivity of map , the necessary conditions to preserve topology are that the function @xmath45 is continuous and the jacobian determinant is positive at each point .    in this case , the source landmark @xmath46 is shifted by @xmath47 along the @xmath48-axis direction and by @xmath49 along the @xmath50-axis direction to the target landmark @xmath51 .",
    "the coordinates of transformation are    @xmath52 ,    @xmath53 ,    where @xmath54 is any csrbf .",
    "the positivity of the jacobian determinant requires @xmath55 i.e. @xmath56 or , equivalently , + @xmath57 where @xmath54 stands for @xmath58 and @xmath59 .",
    "if we set @xmath60 , the value of @xmath61 minimizing the determinant in 2d is @xmath62 ; thus we get @xmath63 with the condition ( [ wc1 ] ) , one can show that all principal minors of the jacobian are positive .",
    "it follows that the transformations defined by equation ( [ li1 ] ) preserve the topology if ( [ wc1 ] ) holds .",
    "the minimum of @xmath64 depends on the localization parameter and therefore on the support size of the parameter @xmath20 of gneiting s functions .    in the next subsections we compute the minimum support size of locality parameter of gneiting s functions and , satisfying",
    ".      considering gneiting s function ( [ li3 ] ) with support size @xmath20 , we look for the minimum value of @xmath20 such that is satisfied . since @xmath66 the value of @xmath67 minimizing ( [ gne7_1 ] ) is @xmath68 thus , evaluating ( [ gne7_1 ] ) at ( [ gne7_2 ] ) and replacing its outcome in",
    ", we obtain that the support size must be @xmath69      focusing now on gneiting s function ( [ li4 ] ) , whose support size is always @xmath20 , we search for the minimum @xmath20 satisfying ( [ wc1 ] ) . here",
    "we have @xmath71 while the value of @xmath67 minimizing is given by @xmath72 evaluating ( [ gne5_1 ] ) at ( [ gne5_2 ] ) and substituting its result in ( [ wc1 ] ) , we obtain @xmath73    table [ tab_1 ] gives the locality parameters for the two gneiting s functions ( [ li3 ] ) and ( [ li4 ] ) , which are compared with those of wendland s and wu s functions ( see @xcite ) . as we mentioned in section [ sec1 ] ,",
    "the advantage of having small locality parameter is that the influence of deformed area at each landmark turns out to be small .",
    "this property allows us to have a greater local control . from table",
    "[ tab_1 ] , we get that the locality parameter of function @xmath14 and @xmath15 are very similar",
    ". moreover , the latter are smaller than those of gneiting s functions .",
    "this means that the deformed field of wendland s and wu s transformations in one - landmark case is similar and its corresponding transformed area is smaller than the one of gneiting s functions .",
    "[ ! htb ]    llll @xmath14 & @xmath15 & @xmath65 & @xmath70 + @xmath74 & @xmath75 & @xmath76 & @xmath77 +      let us consider a grid @xmath78\\times[0,1]$ ] and compare then the results obtained by distortion of the grid in the shift case of the landmark @xmath79 in @xmath80 .    in figure 4.1",
    "we show results assuming as a support size the minimum @xmath20 such that ( [ wc1 ] ) is satisfied , while in figure 4.2 we take a value of @xmath20 which does not satisfy the topology preservation condition . in both examples , @xmath81 .",
    "figure 4.1 shows that for @xmath20 minimum , all transformations can preserve topology well . from figure 4.2 appears instead that , if the topology preservation is not satisfied , the transformed image is deeply misrepresented above all around the shifted point .",
    "this is especially true for gneiting s transformations , because the chosen parameter @xmath82 of gneiting s functions is much smaller than locality parameters of wendland s and wu s functions .",
    "[ 1_landmark_c_si ]        \\(a ) wendland @xmath14 , @xmath83        \\(b ) wu @xmath15 , @xmath84        \\(c ) gneiting @xmath65 , @xmath85        \\(d ) gneiting @xmath70 , @xmath86        \\(a ) wendland @xmath14 , @xmath82        \\(b ) wu @xmath15 , @xmath82        \\(c ) gneiting @xmath65 , @xmath82        \\(d ) gneiting @xmath70 , @xmath82    [ 1_landmark_c_no ]",
    "for more extended deformations , we consider much larger supports which are able to cover whole image . here",
    ", the influence of each landmark extends to the entire domain , therefore global deformations will be generated . in the following we compare topology preservation properties of large extended deformations , and we can set locality parameter large to fulfill this purpose . for this aim , we consider four inner landmarks in a grid , located so as to form a rhombus at the center of the figure , and assuming that only the lower vertex is downward shifted of @xmath87 @xcite .",
    "the landmarks of source and target images are    @xmath88    and    @xmath89    respectively , with @xmath90 .    in this case",
    ", we explicitly write the two components of a generic transformation @xmath91 obtained by a transformation of four points @xmath92 , @xmath93 , @xmath94 and @xmath95 , i.e. @xmath96 and @xmath97 we transform @xmath98 to @xmath99 , with @xmath100 , to obtain the coefficients @xmath101 and @xmath102 . to do that , we need to solve two systems of four equations in four unknowns , whose solutions are given by    @xmath103    and @xmath104}\\delta,}\\\\   c_{2,2 } & = & \\displaystyle{\\frac{\\alpha}{(1+\\beta)^2 - 4\\alpha^2}\\delta,}\\\\ c_{2,3 } & = & \\displaystyle{-\\frac{1+\\beta-2\\alpha^2}{(1-\\beta)[(1+\\beta)^2 - 4\\alpha^2]}\\delta,}\\\\ c_{2,4 } & = &   c_{2,2 } , \\end{array}\\end{aligned}\\ ] ] where @xmath105 for simplicity , we denote @xmath106    then the determinant of the jacobian is @xmath107 for analyzing the positivity of the determinant of the jacobian matrix , we calculate the minimum value at position @xmath108 , with @xmath109 . in the following ,",
    "we analyze the value of the jacobian determinant at @xmath108 , with @xmath109 , for these four csrbfs . because , in this case , we choose a very large parameter @xmath20 , in order to get the value of the jacobian determinant , we consider @xmath110 to be infinitesimal and omit terms of higher order .",
    "the approximation of gneiting s function @xmath65 , obtained by using taylor s expansion , is given by @xmath111 while its first derivative can be approximated as @xmath112 thus , the values of @xmath113 and @xmath114 are @xmath115 @xmath116 using now numerical estimates of @xmath113 and @xmath114 , we get @xmath117 from which it follows @xmath118 therefore we can compute the jacobian determinant at @xmath108 , for @xmath109 , as    @xmath119    evaluating singularly the four partial derivatives @xmath120 and",
    "@xmath121 replacing then the four partial derivatives in ( [ det_gau ] ) , we obtain @xmath122      gneiting s function @xmath70 can be approximated as @xmath123 while its first derivative is @xmath124 then , @xmath113 and @xmath114 can approximatively be represented as follows @xmath125 @xmath126 in order to evaluate @xmath127 , from approximations of @xmath113 e @xmath114 we deduce @xmath128 so we can obtain @xmath129 referring now to ( [ det_gau ] ) , we can compute the following four partial derivatives for @xmath70 , i.e. , @xmath130 and @xmath131 then , replacing such derivatives in ( [ det_gau ] ) , we get @xmath132    we compare the approximations of ( [ gne_7 ] ) and ( [ gne_5 ] ) with the ones acquired by the work @xcite .",
    "figure [ global ] shows the same values of @xmath133 , with @xmath109 , when one uses as csrbf transformations based on wendland s , wu s and gneiting s functions .",
    "this indicates that functions @xmath14",
    ", @xmath134 , @xmath65 and @xmath70 have the same behavior .",
    "the equations obtained in @xcite using wendland s and wu s functions and those deduced in ( [ gne_7 ] ) and ( [ gne_5 ] ) guarantee the jacobian determinant is positive for any @xmath109 .",
    "this means all these transformations can easily preserve topology .",
    ", with @xmath109 , by varying csrbfs.,width=283 ]      in this subsection , a schematic diagram of four landmarks and a real case of brain images are evaluated .",
    "firstly , we consider a grid @xmath78\\times[0,1]$ ] and compare results obtained by its distortion , which is created by the shift of one of the four landmarks distributed in rhomboidal position .",
    "the source landmarks are @xmath135 and are respectively transformed in the following target landmarks @xmath136 taking @xmath137 as support size , we obtain figure 5.2 in case of csrbfs .",
    "\\(a ) wendland @xmath14 , @xmath138        \\(b ) wu @xmath15 , @xmath138        \\(c ) gneiting @xmath65 , @xmath138",
    "\\(d ) gneiting @xmath70 , @xmath138    [ 4punti ]    in agreement with theoretical results , figure 5.2 confirms that all these functions can preserve topology and all of them present very similar deformations , with the exception of the @xmath65 function . in this case",
    ", we can see that , even if the support is very large , the image is only deformed slightly on local area .",
    "this is the best result obtained .",
    "we can conclude that among these four functions , @xmath65 can lead to good result in case of high landmarks density , i.e. when distance among landmarks is very small and each of them influences the whole image .",
    "furthermore , it not only preserves topology , but also changes shape very slightly in the whole image when support is relatively large .    actually , @xcite reported the properties of @xmath65 and @xmath70 functions in the case of a large number of landmarks for square shift and scaling , and also for circle contraction and expansion .",
    "numerical results showed that these two functions have good performances in those cases .    in figure 5.3",
    ", we show the case for @xmath82 in which topology preservation is not satisfied .",
    "the transformed images are deeply misrepresented mainly close to the shifted point .",
    "\\(a ) wendland @xmath14 , @xmath139        \\(b ) wu @xmath15 , @xmath139        \\(c ) gneiting @xmath65 , @xmath139        \\(d ) gneiting @xmath70 , @xmath139    [ 4punti_no ]    moreover , a real medical case of landmark - based image registration is displayed in figure 5.4 , which focuses on two brain images .",
    "the image ( a ) is the source image with the corresponding landmarks marked by , whereas ( b ) is the target image with the landmarks . in this case , we choose two different support sizes for @xmath65 in order to observe the various topology behaviours .",
    "more precisely , when @xmath140 which is relatively a large value , the transformed image can preserve topology well .",
    "however , the opposite situation occurs when @xmath20 is smaller , for instance equal to 2 .",
    "-1 cm        -0.3 cm    [ brain_case ]",
    "for image registration , we should guarantee that images preserve their original structure and they are not folded after deformation .",
    "hence the transformations we use should be preserved topologically .    in this paper",
    ", we evaluated the topology preservation of two kinds of gneiting s functions , and compared the results with wendland s and wu s functions in one- , four - landmark and medical brain image cases . in the first case ,",
    "all functions have very similar performances .",
    "conversely , in four - landmark and brain image cases , gneiting s functions have better performances , especially the @xmath65 function provides the best registration result .",
    "the authors are very grateful to the anonymous referees for their detailed and valuable comments which helped to greatly improve the paper .",
    "the second and third authors acknowledge support from the gncs - indam .",
    "r. cavoretto and a. de rossi , landmark - based image registration using gneiting s compactly supported functions , in : t.e .",
    "simos et al .",
    "( eds . ) , proceedings of the icnaam 2012 , aip conf .",
    "proc . , * 1479 * , melville , new york , 13351338 ( 2012 ) .",
    "r. cavoretto , a. de rossi , h. qiao , b. quatember , w. recheis and m. mayr , computing topology preservation of rbf transformations for landmark - based image registration , in : j .- d .",
    "boissonnat et al .",
    ", curves and surfaces 2014 , lncs , vol . *",
    "9213 * , springer international publishing , 96108 ( 2015 ) ."
  ],
  "abstract_text": [
    "<S> the purpose of image registration is to determine a transformation such that the transformed version of the source image is similar to the target one . in this paper </S>",
    "<S> we focus on landmark - based image registration using radial basis functions ( rbfs ) transformations , in particular on the topology preservation of compactly supported radial basis functions ( csrbfs ) transformations . in @xcite the performances of gneiting s and wu s functions are compared with the ones of other well known schemes in image registration , as thin plate spline and wendland s functions . </S>",
    "<S> several numerical experiments and real - life cases with medical images show differences in accuracy and smoothness of the considered interpolation methods , which can be explained taking into account their topology preservation properties . here </S>",
    "<S> we analyze analytically and experimentally the topology preservation performances of gneiting s functions , comparing results with the ones obtained in @xcite , where wendland s and wu s functions are considered .    </S>",
    "<S> image registration , landmarks , radial basis functions , gneiting s functions , elastic registration </S>"
  ]
}