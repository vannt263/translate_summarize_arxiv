{
  "article_text": [
    "barrier options are derivatives with a pay - off that depends on whether a reference entity has crossed a certain boundary .",
    "common examples are the knock - in and knock - out call and put options that are activated or des - activated when the underlying crosses a specified barrier - level . barrier and",
    "barrier - type options belong to the most widely traded exotic options in the financial markets .",
    "whereas knowledge of the marginal risk - neutral distribution of the underlying at maturity suffices to obtain arbitrage free prices of european call and put options , the valuation of barrier options requires specification of the risk - neutral law of the underlying price process , as it depends on the first - passage distribution of this process .",
    "at least as important as the calculation of prices is the evaluation of the sensitivities of the prices to various model - parameters ( the greeks ) for which the law of the process is also required .",
    "a class of models that has been shown to be capable of generating a good fit of observed call and put option price data is formed by the infinite activity lvy models , such as extended koponen or kobol @xcite , variance gamma @xcite , normal inverse gaussian @xcite and generalised hyperbolic processes @xcite .",
    "this class of models has been extensively studied and we refer for background and further references to the books by boyarchenko and levendorski @xcite , cont and tankov @xcite and schoutens @xcite . in this paper",
    "we consider barrier options driven by lvy processes with a completely monotone lvy densities on each half - axis ( which we call _ generalised hyper - exponential _ ) .",
    "this class contains many of the lvy models used in financial modelling as the forementioned ones and also jump - diffusions with double - exponential jumps , as shown in section [ sec : model ] .",
    "the calculation of first - passage distributions and barrier option prices in ( specific ) lvy models has been investigated in a number of papers .",
    "geman and yor @xcite calculated prices and deltas of double barrier options under the black - scholes model . for",
    "spectrally one - sided lvy processes with a gaussian component rogers @xcite derived a method to evaluate first - passage distributions .",
    "kou and wang @xcite , lipton @xcite and sepp @xcite followed a transform approach to obtain barrier prices for a jump - diffusion with exponential jumps . in the setting of",
    "infinite activity lvy processes with jumps in two directions cont and voltchkova @xcite investigated discretisation of the associated integro - differential equations ; boyarchenko and levendorski @xcite employed fourier methods to investigate barrier option prices for lvy processes of regular exponential type ; asmussen et al .",
    "@xcite priced an equity default swap under a cgmy model , by fitting a hyper - exponential density to the cgmy lvy density . in this paper",
    "we adopt the latter approach . as first step",
    "we obtain , in a lvy model with hyper - exponential jumps , analytical formulas for the laplace transform in time of knock - in and knock - out barrier option prices by exploiting the availability of an explicit wiener - hopf factorisation . using these results",
    "we also establish analytical formulas for the corresponding sensitivities with respect to the initial price ( delta and gamma ) and the time of maturity ( theta ) up to one laplace transform in time .",
    "the actual barrier option prices and sensitivities are then obtained by numerically inverting these single laplace transforms , using abate and white s algorithm @xcite , yielding fast and accurate results . since hyper - exponential lvy processes",
    "are dense in the class of generalised hyper - exponential lvy processes , the idea is to approximate the barrier option prices and sensitivities in a generalised hyper - exponential model by those in an appropriately chosen hyper - exponential lvy model . at this point",
    "it is worth remarking that for a general lvy process the wiener - hopf factors are not available in analytically tractable form ( as they are expressed in terms of the one - dimensional distributions that are generally not available ) and , furthermore , even if the wiener - hopf factors have been obtained still a three - dimensional laplace / fourier inversion would be needed to obtain the knock - in and out call option prices ( see e.g. @xcite ) .",
    "following the approach described in the previous paragraph barrier option prices and sensitivities under a generalised hyper - exponential lvy model can , at least in principle , be approximated arbitrarily closely .",
    "indeed , we will prove that , when a sequence of hyper - exponential lvy processes weakly converge to a given generalised hyper - exponential lvy process of infinite activity , the corresponding first - passage times converge in distribution , and the barrier option prices and smoothed sensitivities converge pointwise to those of the limiting model .",
    "we illustrated this approximation procedure by implementing it for the exponential variance gamma ( vg ) and normal inverse gaussian ( nig ) models , with parameters calibrated to stoxx50e options .",
    "using a least - squares algorithm to minimize the root mean square error of the approximating density with respect to the target density over a grid , using 7 upward and downward phases , we determined the parameters of the approximating hyper - exponential lvy densities ; the resulting hyper - exponential lvy processes we employed as approximations to the vg and nig processes .",
    "we calculated the prices and sensitivities of european and american digital options and down - and - out put options following this approach , and also by monte carlo simulation .",
    "we found a general agreement between the results , with relative errors in the range of 0.5 - 2.5% for prices and deltas , some distance away from the barrier .",
    "numerical experiments showed that closer to the barrier errors may be larger , especially for the delta , suggesting that a more accurate approximation of the target density by a hyperexponential density would be needed to reduce the size of the error , which could be achieved by increasing the number of phases or by employing one of the methods from the approximation theory of real valued functions .",
    "the phenomenon of larger errors in the vicinity of the barrier was also observed by kudryatsev and kudryatsev and levendorski @xcite when approximating first touch digital option prices under a nig lvy model using the kou model .",
    "it would be desirable to analyze the dependence of the error on the different parameters and the distance to the barrier , and how the presented approach compares to alternative approaches such as finite difference schemes , but , in the interest of brevity , these questions are left for future research .    the remainder of the paper is organized as follows . in section [ sec : model ] the ` generalised hyper - exponential lvy model ' is defined and it is shown that many of the existing lvy models used in quantitative finance are contained in this class .",
    "results on the wiener - hopf factorisation and first passage times for processes from this class can be found in section [ sec : wh ] .",
    "analytical results for the laplace transforms in time of barrier option prices are obtained in section [ sec : ltbarrier ] . using these results explicit expressions",
    "are derived in section [ sec : sens ] for the laplace transforms of the theta , delta and gamma of the barrier an digital options . in section",
    "[ sec : numerical ] numerical results are presented for prices and sensitivities of barrier options in a vg and a nig model respectively , with convergence results presented in section [ sec : convsens ] . some proofs are relegated to the appendix .",
    "let @xmath0 be a lvy process , that is , a stochastic process with independent and homogeneous increments , normalised such that @xmath1 , defined on some appropriate probability space @xmath2 . for background on the fluctuation theory of lvy processes and the application of lvy processes in quantitative finance we refer to bingham @xcite and cont and tankov @xcite , respectively  sato @xcite and bertoin @xcite are general treatments of the theory of lvy processes .",
    "assume that @xmath3 satisfies @xmath4=\\te{(r - d)t}$ ] for all @xmath5 , where @xmath6 and @xmath7 are non - negative constants representing the risk - free rate of return and the dividend yield , and consider the model for the risk - neutral evolution of the stock price @xmath8 given by @xmath9 as a consequence of the independent increments property of @xmath3 , @xmath10 is a martingale ( under the measure @xmath11 and with respect to its natural filtration ) .",
    "we will restrict ourselves to the following class of lvy processes :    * definition . *",
    "a lvy process is said to be _ generalised hyper - exponential _ ( and we will denote this class of processs by @xmath12 ) if its lvy measure admits a density @xmath13 of the form @xmath14 where @xmath15 are completely monotone functions on @xmath16 and @xmath17 denotes the indicator of a set @xmath18 .    in view of bernstein s",
    "theorem a lvy process @xmath3 is a member of the class @xmath12 if and only if its lvy density @xmath13 is of the form @xmath19 for some measures @xmath20 on @xmath16 and @xmath21 respectively . the mass of the interval @xmath22 $ ] , under the measure @xmath23 corresponds to the frequency of positive exponential jumps of mean sizes between @xmath24 and @xmath25 .",
    "a similar statement holds true for the negative jumps and @xmath26 . in the case",
    "that the measure @xmath23 is a convex combination of point - masses , the locations @xmath27 and sizes @xmath28 of the point - masses respectively correspond to average size @xmath29 and frequency @xmath30 of the exponential jumps .",
    "below we show that many of the lvy processes employed in financial modelling are generalised hyper - exponential by explicitly calculating the corresponding measures @xmath31 . in particular , the class @xmath12 contains the time changes of brownian motion by a generalised hyper - exponential subordinator .",
    "let @xmath32 be a brownian motion and @xmath33 an independent generalised hyper - exponential subordinator .",
    "then , for @xmath34 , @xmath35 is a lvy process in the class @xmath12 .    denoting by @xmath36 the lvy density of @xmath33 and",
    "@xmath37 the measure in the representation , theorem 30.1 in sato ( 1999 ) implies that the lvy density @xmath13 of @xmath3 is given by @xmath38 an interchange of the order of integration yields that @xmath39 and the claim follows .",
    "the following result gives necessary and sufficient conditions on the measures @xmath40 such that @xmath13 in is a lvy density :    let @xmath41 be a measure on @xmath42 and set @xmath43 .",
    "then @xmath13 defined in is a lvy density if and only if @xmath44    by interchanging the order of integration it can be verified that @xmath45 further we note that @xmath46 is bounded below and above by @xmath47 and @xmath48 , respectively . in view of these calculations we read off that @xmath13 in satisfies the integrability condition @xmath49 k(x)\\td x < \\infty$ ] ( which is the requirement for @xmath13 to be a lvy density ) if and only if holds .    in the following examples we explicitly determine the measures @xmath31 .",
    "* examples .",
    "* we shall write @xmath50 for the density @xmath13 restricted to the positive half - axis .",
    "@xmath51 * double exponential model * ( kou @xcite ) for a jump - diffusion model where the jumps follow a double exponential distribution , @xmath23 is a point - mass located at the reciprocal of the mean jump sizes : @xmath52 where @xmath53 .    @xmath51 * hyper - exponential model * ( e.g. @xcite ) this model is an extension of kou s model by allowing for exponential jumps with a finite number of different means . for @xmath54 and @xmath55 with @xmath56",
    "we thus get @xmath57    @xmath51 * kobol / cgmy model * ( @xcite ) in the kobol model ( also called cgmy model ) , the measure @xmath41 has a continuous density @xmath13 , and it holds that @xmath58 where @xmath59 . the form of @xmath23 invokes the definition of the gamma function @xmath60 in particular , for the variance gamma model , we set @xmath61 and get @xmath62 and @xmath63 .",
    "@xmath51 * meixner model * ( e.g. @xcite ) the lvy density of a meixner lvy process is given by @xmath64 where @xmath65 , @xmath66 , so that we find that @xmath67    @xmath51 * normal - inverse gaussian ( nig ) * ( barndorff nielsen @xcite ) in the nig model , the measure @xmath41 has a density which reads as @xmath68/\\a)^2 - 1)^{1/2}\\mbf 1_{\\{u\\ge \\a-\\b\\}}\\td u,\\ ] ] where @xmath69 , @xmath70 and @xmath71 is the mcdonald function .",
    "the form of @xmath23 is based on the following representation ( see @xcite ) of @xmath71 @xmath72    @xmath51 * generalised hyperbolic ( gh ) * ( eberlein et al .",
    "@xcite ) the gh process can be respresented as time change of brownian motion by a generalised inverse gaussian ( gig ) subordinator .",
    "the lvy density of gig is a generalised gamma convolution which means in particular that it is of the form .",
    "first passage distributions are an essential element in the valuation of barrier options . in this section",
    "we briefly review elements of the first passage theory for lvy processes that will be needed in the sequel .",
    "the distributions of the running supremum and the running infimum of @xmath3 are linked to the distribution of @xmath73 via the famed wiener - hopf factorisation of the lvy exponent of @xmath3 , denote by @xmath74 $ ] . for @xmath75 , let @xmath76 denote the imaginary part of @xmath77 .    * definition . *",
    "a _ wiener - hopf factorisation of _",
    "@xmath78 is a pair of functions @xmath79 that satisfies , for @xmath80 and @xmath81 , the relation @xmath82 where , for fixed @xmath81 , @xmath83 are continuous and non - vanishing on @xmath84 and analytic on @xmath85 with @xmath86 , and @xmath87    denote by @xmath88 and @xmath89 the running supremum and infimum of @xmath3 up to time @xmath90 , @xmath91 and let @xmath92 , @xmath93 be the respective fourier - laplace transforms @xmath94\\td t,\\quad\\quad \\phi^-_q(u ) = \\int_0^\\infty q\\te{-q t}e[\\te{\\ie u \\unl x(t)}]\\td t.\\ ] ] it is not hard to verify that @xmath95 satisfy the condition .",
    "rogozin @xcite established the following result :    @xmath96 is the unique wiener - hopf factorisation of @xmath78 .",
    "if the lvy measure has support in both half - axis the factorisation is generally not explicitly known , except if the lvy measure of @xmath3 is of a particular form .",
    "the observation that the wiener - hopf factorisation and related first passage distributions are tractable for a random walk in the case that the jump distribution on the positive half - axis follows an exponential distribution can already be found in feller @xcite .",
    "see also the books borovkov @xcite and asmussen @xcite for background on the wiener - hopf factorisation for random walks .",
    "mordecki @xcite and lipton @xcite calculated the laplace transforms of first passage time distributions for a lvy process with hyper - exponential jumps .",
    "asmussen et al .",
    "@xcite derived explicitly the wiener - hopf factorisation if the jump distributions of the lvy process are of phase - type .    in the sequel",
    "we will employ the known factorisation results for a jump - diffusion with lvy density ( also to be called a _",
    "hyper - exponential jump - diffusion ( hejd ) _ ) given by @xmath97 where @xmath98 with @xmath99 .",
    "the corresponding lvy exponent then reads as @xmath100 the function @xmath78 in can be analytically extended to the complex plane except the finite set @xmath101 , and this extension will also be denoted by @xmath78 . denoting by @xmath102 , @xmath103 and @xmath104 , @xmath105 the roots of @xmath106 with positive and negative real parts respectively",
    ", the wiener - hopf factors @xmath107 and @xmath108 are explicitly given as follows : @xmath109 note that as a consequence of the intermediate value theorem and the fact that @xmath110 is a rational function with real coefficients and single poles , it follows that the roots of the equation @xmath106 are all real and distinct if @xmath111 . performing a partial fraction decomposition and termwise inverting the terms yields that the time - laplace transforms of the distributions of @xmath88 and @xmath89 are given by , it is still possible to perform a partial fraction decomposition which results in similar but slightly different expressions  see remark 4 in @xcite . ]",
    "@xmath112    where the coefficients @xmath113 and @xmath114 are given by @xmath115      for a generalised hyper - exponential lvy process @xmath3 the wiener - hopf factorisation is in general not known explicitly .",
    "however , due to its special form , its lvy density can be approximated arbitrarily closely by a hyper - exponential density ( by approximating the measures @xmath31 by sums of point - masses ) , and for the resulting hyper - exponential lvy process the wiener - hopf factorisation is explicitly given in the previous section .",
    "as hyper - exponential lvy processes are ` dense ' in the class @xmath12 , the wiener - hopf factorisation of @xmath3 can be approximated arbitrarily accurately using this idea .",
    "more formally , a sequence of approximating processes @xmath116 can be explicitly constructed as follows .",
    "denote by @xmath13 and @xmath117 the lvy density and the diffusion coefficient of @xmath3 , respectively .",
    "fix a sequence @xmath118 of positive numbers converging to zero , and , for every @xmath119 , let @xmath120 and @xmath121 be two finite partitions of @xmath16 with vanishing mesh of @xmath16 is an increasing set of times @xmath122 .",
    "the mesh of @xmath123 is defined as @xmath124 . ] and let @xmath125 , @xmath126 be two finite sets of positive weights , shortly to be determined .",
    "set the approximating density equal to @xmath127 for a given @xmath119 , the partitions @xmath128 and @xmath129 and the weights @xmath130 , @xmath131 are chosen such that the mass of @xmath13 in the tails and the @xmath132 distance between the target density @xmath13 and the approximating density @xmath133 on a closed bounded set not containing zero is smaller than @xmath134 , that is , @xmath135 for some open bounded set @xmath136 with @xmath137 .",
    "these requirements can be fulfilled since @xmath13 has finite mass on the set @xmath138 and takes the special form .",
    "set @xmath139 equal to the lvy process with lvy density @xmath133 and gaussian coefficient @xmath140 @xmath141 and with drift @xmath142 chosen such that @xmath143 = \\te{r - d}$ ] .",
    "the approximating processes @xmath139 constructed in this way can be shown to converge weakly to @xmath3 .",
    "endowed with the skorokhod topology .",
    "a proof of this fact is given in appendix [ sec : weak ] , lemma [ lem : weak ] . ]",
    "convergence of the barrier option prices corresponding to log price @xmath139 rests on the fact , lemma [ lem : weakxx ] . ]",
    "that the weak convergence of @xmath139 to @xmath144 carries over to convergence of the running supremum , infimum and the crossing times @xmath145 as summarised in the following result .",
    "[ prop : convwh ] let @xmath3 be generalised hyper - exponential and let @xmath139 be as defined . for @xmath146 , @xmath147 converges in distribution to @xmath148 as @xmath149 .",
    "in particular , if @xmath3 is not of type a , it holds for @xmath150 and @xmath151 that @xmath152 as @xmath149 .",
    "in this section we employ the wiener - hopf factorisation results to derive the values of single barrier options in a hyper - exponential lvy model . we will restrict ourselves to down - and - out and down - and - in digital and put options , but related options ( such as up - and - in call options ) can be derived similarly .",
    "a digital option is a derivative that pays @xmath153 euro if the price of the underlying asset has up or down - crossed a level @xmath154 before a maturity time @xmath155 , with pay - off occuring either directly at the moment of crossing or at the maturity time @xmath155 .",
    "we will derive the values of down - and - out and down - and - in digital options and denote by @xmath156 and @xmath157 the respective prices corresponding to payment at maturity .",
    "we also consider the american version of the down - and - out digital option ( denoted by @xmath158 ) that pays out at the moment of crossing the barrier .",
    "the following result gives the laplace transforms of the digital prices when @xmath159 .",
    "denote by @xmath160 the laplace transform of @xmath161 : @xmath162    [ prop : digital ] if @xmath81 and @xmath163 it holds that @xmath164 where @xmath165 .",
    "* proof of proposition [ prop : digital ] : * since the riskless rate of return is assumed to be constant and equal to @xmath6 , it follows by standard no - arbitrage pricing arguments that the price of the down - and - in digital option is given by @xmath166,\\ ] ] where we switched to log - scale .",
    "also , if we denote @xmath167 then @xmath168.\\ ] ] taking now the laplace transforms of these expressions in @xmath155 and combining with the first - passage distributions given in section [ sec : wh ] we find if @xmath169 : @xmath170\\td t = \\i_0^\\infty\\te{-(q+r)t}p[t(h ) \\leq t]\\td t \\\\ & = & \\frac{1}{q+r}\\int_{-h}^\\infty\\sum_{j=1}^{k^-}a_j^-(-\\rho_j^-)\\te{\\rho_j^- y}\\td y = \\frac{1}{q+r}\\sum_{j=1}^{k^-}a_j^-\\te{-\\rho_j^-",
    "h},\\\\ \\wh{adid}(q ) & = & \\i_0^\\infty\\te{-qt } e[\\te{-rt(h)}\\mbf 1_{\\{\\unl x(t ) \\leq h\\}}]\\td t   = e\\le[\\i_0^\\infty\\te{-qt - rt(h)}\\mbf 1_{\\{t(h)\\leq t\\}}\\td t\\ri]\\\\ & = & \\frac{1}{q}e[\\te{-(q+r)t(h ) } ] = \\frac{q+r}{q}\\i_0^\\infty\\te{-qt}\\{\\te{-rt}p[t(h ) \\leq t]\\}\\td t.\\end{aligned}\\ ] ] the last identity follows by noting that @xmath171 .",
    "a down - and - out put pays out at maturity @xmath155 the strike @xmath172 less the value of the asset @xmath173 ( if this difference is positive ) with the added feature that the put is worthless if the price of the asset has been below a level @xmath154 by time @xmath155 . in the next result we derive the laplace transform in the maturity @xmath155 of down - and - out put @xmath174 .",
    "the value of the down - and - in put is presented in appendix [ app : dip ] .",
    "[ prop : barrier ] let @xmath81 and write @xmath175 .",
    "then it holds that @xmath176 where , if @xmath177 , @xmath178 and , if @xmath179 , @xmath180 with @xmath181 and @xmath182 .",
    "it is easy to check that , in the case of exponential upward and downward jumps ( @xmath183 ) , this result agrees those obtained before by kou and wang @xcite and sepp @xcite .    by the standard theory of no - arbitrage - pricing it follows that an arbitrage free price for the down - and - out barrier option is given by @xmath184\\\\ \\nn & = & \\te{-rt}kp[\\unl x(t ) > h , x(t)<\\ell ] \\\\ & \\phantom{= } & - \\te{-rt}s_0e[\\te{x(t)}\\mbf 1_{\\{\\unl x(t ) > h , x(t)<\\ell\\ } } ] , \\label{eq : dop}\\end{aligned}\\ ] ] where @xmath167 and @xmath185 .",
    "denoting by @xmath186 an independent random time with an exponential distribution with parameter @xmath187 , the laplace transform @xmath188 of @xmath189 can be compactly represented as @xmath190\\td t\\\\ \\nn & \\phantom{= } & -   s_0\\int_0^\\infty\\te{-(q+r)t}e[\\te{x(t)}\\mbf 1_{\\{\\unl x(t ) > h,\\ x(t)<\\ell\\}}]\\td t\\\\ & = & \\frac{k}{q+r } p[\\unl x(\\t ) > h,\\ x(\\t)<\\ell ] - \\frac{s_0}{q+r}e[\\te{x(\\t)}\\mbf 1_{\\{\\unl x(\\t ) > h,\\ x(\\t)<\\ell\\ } } ] .",
    "\\label{eq : whdop}\\end{aligned}\\ ] ] to calculate the quantities @xmath191\\\\ g(y , b ) & : = & e[\\te{b\\ovl x(\\t)}\\mbf 1_{\\{\\ovl x(\\t ) < y\\}}]\\end{aligned}\\ ] ] we shall appeal to the following two key properties : @xmath192 and @xmath193 are independent and the pairs @xmath194 and @xmath195 are identically distributed . in view of ( a ) it follows that @xmath196\\\\ & = & \\int_{-\\min\\{k,0\\}}^{-h}\\te{-by } e[\\te{b(x(\\t)-\\unl x(\\t))}\\mbf 1_{\\{x(\\t)-\\unl x(\\t)<k+y\\ } } ] p(-\\unl x(\\t)\\in\\td y)\\\\ & = & \\int_{-\\min\\{\\ell,0\\}}^{-h } \\te{-by } g(\\ell+y , b ) f_{-\\unl x(\\t)}(y)\\td y + g(\\ell ,",
    "b)p[\\unl x(\\t ) = 0],\\end{aligned}\\ ] ] where we used property ( b ) in the last line . inserting the explicit form of the distribution of @xmath197",
    ", we find that for @xmath198 @xmath199\\\\ & = & \\sum_{i=1}^{k^+}\\frac{\\rho_i^+}{b-\\rho_i^+}a_i^+(\\te{(b-\\rho_i^+)y } - 1 ) + 1 - \\sum_{i=1}^{k^+}a_i^+.\\end{aligned}\\ ] ] the next step is to integrate @xmath200 against @xmath201 . if @xmath202 , this yields @xmath203 and in the case that @xmath204 , it holds that @xmath205 it is then a straightforward matter of some calculus to arrive at the stated expressions .",
    "the analytical formulas for the barrier and digital prices in the previous section suggest the possibility of calculating the corresponding sensitivities by direct differentiation . in this section",
    "we make this idea precise by providing regularity results .",
    "the delta and gamma sensitivities of the option price with respect to the initial stock price @xmath206 will be denoted by @xmath207 where @xmath208 is the value function of the option under consideration ( digital or down - and - out put ) .",
    "the sensitivity @xmath209 with respect to the maturity @xmath155 ( the theta ) is defined by a function that satisfies @xmath210 for all @xmath146 .",
    "if @xmath211 is continuously differentiable with respect to @xmath155 then this definition is equivalent to @xmath212 the first result in this direction concerns the theta of a digital option :    [ lem : sens ] let @xmath3 be a general lvy process not of type a. then , for @xmath81 , @xmath213 and @xmath146 , @xmath214    since the map @xmath215 given by @xmath216 is an increasing function with @xmath217 it holds that @xmath218 further , lemma 49.3 in sato(1999 ) implies that @xmath219 for @xmath169 , @xmath150 , for lvy processes @xmath3 not of type a , so that @xmath220 is continuous .",
    "if we denote by @xmath161 a density of @xmath220 it follows that @xmath221 . in view of the form of the pay - off of the digital we deduce that @xmath222 and the assertion follows",
    "the second equation follows from the relation between @xmath157 and @xmath158 given in proposition [ prop : digital ] .    in the case of a gaussian component @xmath223 general results are available in the literature regarding the smoothness and regularity of the solutions of partial integro - differential equations that imply , by the feynman - kac representation , that the value functions of the barrier options are smooth ( see bensoussan & lions @xcite and garroni & menaldi @xcite ) .",
    "more specifically , for a hyper - exponential lvy process with @xmath223 it holds that @xmath220 with @xmath224 is element of @xmath225 and @xmath226 satisfies @xmath227 . in view of the probabilistic representations and",
    ", this result directly implies that the delta and gamma of @xmath157 and @xmath228 are well defined .",
    "the laplace transforms of the delta and gamma of @xmath157 are given as follows :    [ prop : ddstar ] suppose @xmath3 is a hyper - exponential lvy process with @xmath229 and let @xmath81 and @xmath230 .",
    "it holds that @xmath231    letting @xmath232 the fundamental theorem of calculus implies that @xmath233 where the change of the order of integration is justified ( by fubini s theorem ) since @xmath234 and the last equality follows since @xmath235 is continuously differentiable as a function of @xmath206 .",
    "the form of the delta follows now from proposition [ prop : digital ] .",
    "the result for the gamma follows by a similar reasoning as above , where the interchange of integration is now justified since @xmath236 is dominated by an integrable function ( on @xmath237 ) .    to show the latter fact we note first that since @xmath157 is smooth enough it satisfies the partial integro - differential equation that reads in terms of the greeks of @xmath157 as @xmath238(t , s ) + i(t , s ) = 0,\\ ] ] for @xmath239 with boundary values @xmath240 for @xmath241 $ ] and @xmath242 if @xmath243 and zero else . here",
    "@xmath244 is the non - local part of the generator , given by @xmath245 since @xmath246 and the measure @xmath247 has finite mass , it thus follows that @xmath248 , @xmath249 is for @xmath250 equal to @xmath251 , which is finite in view of the form of the delta .",
    "similarly , it follows that @xmath252 and the proof is complete .",
    "given the sensitivities of @xmath157 , those of @xmath158 are calculated as follows :    [ cor : ddstar ] let @xmath229 .",
    "for @xmath81 and @xmath230 it holds that @xmath253    _ of corollary [ cor : ddstar ] : _ the assertions follow the relation between @xmath157 and @xmath158 given in proposition [ prop : digital ] , and using that @xmath254 is the laplace transform of @xmath255 .    following an analogous approach ,",
    "similar formulas can be derived for the sensitivities of down - and - out put options ; the results are reported in appendix [ app : sdip ] .",
    "when the stock log - price process is modelled by a generalised hyper - exponential lvy process , we use the following algorithm to compute single barrier option prices and corresponding sensitivities :    * algorithm *    1 .   approximate the target lvy density by a hyper - exponential density .",
    "2 .   calculate the laplace transforms of prices and sensitivities using + the formulas in sections [ sec : ltbarrier ] and [ sec : sens ] .",
    "3 .   apply a laplace inversion algorithm to the result of step 2 .    * comments *    ad 1 .",
    "similarly as in asmussen et al .",
    "@xcite we specified the form of the density ( [ eq : ka ] ) by fixing the number of exponentials @xmath256 and the mean jump sizes @xmath257 and then using a least squares algorithm to determine the values of the remaining parameters @xmath258 , @xmath259 and @xmath260 , @xmath261 that minimize the squared distance between the density ( [ eq : ka ] ) and the target density . to improve the accuracy of the fit",
    "one could employ methods from the approximation theory of real valued functions , or alternatively follow the approach developed by feldmann and whitt @xcite .",
    "the roots of the characteristic exponent that appear in the formulas of the laplace transforms were calculated using laguerre s method ( see e.g. numerical recipes @xcite ) .",
    "the quantity of interest @xmath211 can be expressed in terms of the laplace transform @xmath262 by the bromwich integral @xmath263 to evaluate the integral we employed the algorithm investigated by abate and whitt @xcite , which is based on approximation of the integral by euler summation with the trapezoidal rule that leads to the series @xmath264 where @xmath265+\\frac{e^{a/2}}{2t}\\sum_{k=1}^n(-1)^k \\mbox{re}\\left[\\wh v\\left(\\frac{a+2k\\pi \\ie}{2t}\\right)\\right].\\ ] ] abate and whitt @xcite recommend the values @xmath266 , @xmath267 , @xmath268 , where @xmath269 should be increased if necessary .",
    "see @xcite for a discussion about the role these parameters play in controlling the error .",
    "we have implemented the above algorithm in the context of a variance gamma ( vg ) model and a normal inverse gaussian ( nig ) model to calculate the prices and the sensitivities of digital barrier options and down - and - out put options .",
    "the parameters of the vg and nig models were determined by calibrating the models to market quoted stoxx50e call prices on 16 june 2006 , using the fft algorithm proposed by carr and madan @xcite .",
    "this procedure yielded the following parameter values @xmath270 , @xmath271 and @xmath272 for the variance gamma model and @xmath273 , @xmath274 , @xmath275 for the normal inverse gaussian model .",
    "we employed these parameters in the subsequent calculations of barrier option prices and sensitivities .",
    "as an initial step , the lvy densities of the vg and nig processes were approximated by hyper - exponential densities of the form ( [ eq : ka ] ) with 14 different exponentials , 7 upward phases ( @xmath276 ) and 7 downward phases ( @xmath277 ) .",
    "note that the parameters @xmath278 and @xmath279 are equal to the reciprocals of the mean sizes of upward and downward jumps of the ( hyper - exponential ) log - price , respectively .",
    "the values of @xmath278 and @xmath279 were fixed as in table [ table : nig ] .",
    "the remaining parameters @xmath280 , @xmath281 , and the @xmath258 , @xmath259 were determined by using a least squares algorithm to minimize the sums of squares of the difference between the target density and the hyper - exponential density ( [ eq : ka ] ) over a time - grid inside the interval @xmath282 $ ] .",
    "the resulting parameter values of the hyper - exponential density are specified in table [ table : nig ] .",
    "+    we simulated paths of variance gamma and normal inverse gaussian processes by employing the representations of these processes as random time changes of a brownian motion by an independent gamma and an independent inverse gaussian subordinator , respectively .",
    "the sensitivities were calculated by approximating the derivative by a finite difference and subsequently evaluating this using monte carlo simulation .",
    "tables [ table : nigdop ] and [ table : vgdd ] and figures [ fig : nig ] and [ fig : vg ] report prices and greeks for down - and - in digital and down - and - out put options calculated by using algorithm 1 and monte - carlo simulation .",
    "the options are priced at different spot levels that are expressed as a percentage of the spot price on june 16th 2006 ( @xmath283 ) .",
    "the value of the sensitivities is expressed as a fraction of @xmath206 . down - and - in digital options are priced under the vg model with barrier level @xmath154 set at @xmath284 , and down - and - out puts under the nig model with a barrier @xmath154 and a strike @xmath172 set respectively at @xmath284 and @xmath285 .",
    "the results show a general agreement between the monte carlo simulation results and those from the semi - analytical approximation .",
    "the relative errors for the prices are less than 0.6% for vg and about 2% for nig , and for the delta about 2% - 2.5% for both , if , for nig , we stay some distance away from the barrier .",
    "we also observe that , close to the barrier , the result for the gamma falls outside the confidence interval . in the case of the nig lvy model , the larger errors close to the barrier",
    "may be explained by the fact that the option price is not smooth under this model whereas it is for the approximating hyper - exponential model ( see @xcite for an analysis of the smoothness of option prices under an nig or , more generally , a regular lvy process ) .    the convergence of monte carlo estimators of quantities involving first passage is known to be very slow , requiring a small mesh of the time grid .",
    "since this effect is magnified when calculating the numerical derivatives , a large number of paths and time - steps was needed to obtain convergence . for the monte carlo calculations we used @xmath286 paths and @xmath287 time steps per year , which made the calculation of the greeks using monte carlo computationally demanding and time - consuming . in a c++ programme on a 3189 mhz",
    "computer the valuation of all option prices and sensitivities took @xmath288 seconds for a digital option and @xmath289 seconds for a down - and - out put option , compared to a couple of hours when using monte carlo .",
    "here we should remark that we did not employ any special methods that could considerably have improved the speed of convergence of the monte carlo simulation , such as malliavin weights , likelihood ratio methods or sampling techniques such as the bridge ( see e.g. glasserman @xcite ) .",
    "we noted that if the spot price was close to the barrier the monte carlo estimators of the greeks tended to be unstable .",
    "a generalised hyper - exponential lvy process can , as we have shown in section [ sec : genhyp ] , be approximated arbitrarily closely by a hyper - exponential jump - diffusion , by specifying appropriate values for the parameters of the latter process .",
    "under such a model analytical expressions were derived in sections [ sec : ltbarrier ] and [ sec : sens ] for the values @xmath157 , @xmath156 , @xmath158 , @xmath228 of digital and the down - and - out put options , and the corresponding sensitivities .",
    "the results in section [ sec : numerical ] provided numerical evidence to show that a good approximation of prices and sensitivities in a @xmath12 lvy model can be obtained by carrying out the computations in a suitably chosen approximating hyper - exponential jump - diffusion model . in this section we provide further justification for the algorithm by proving a convergence result , that is , for a given @xmath12 lvy process @xmath3 and a sequence of @xmath290 processes @xmath139 weakly converging to @xmath3 ( as constructed in section [ sec : genhyp ] ) , we will show that the corresponding prices @xmath291 , @xmath292 , @xmath293 , @xmath294 of digital and down - and - out put options converge pointwise to those in the limiting model @xmath3 , as @xmath149 :    [ prop : convbar ] suppose that @xmath3 is @xmath12 and is not of type a and let @xmath211 be any of @xmath295 with @xmath296 the corresponding approximation .",
    "then for @xmath297 , it holds that @xmath298    _ of proposition [ prop : convbar ] _ the convergence of @xmath299 to @xmath300 is a direct consequence of the convergence of @xmath301 ( proposition [ prop : convwh ] ) .",
    "further , by interchanging the order of integration it follows that the value function @xmath158 can be written as @xmath302 thus , in view of the dominated convergence theorem and again proposition [ prop : convwh ] it follows that @xmath303 .",
    "also , since @xmath304 is a continuous bounded function , lemma [ lem : weakxx ] implies that @xmath305 = dop^{(n)}(t;s_0)$ ] converges to @xmath306 as @xmath149 .",
    "note that proposition [ prop : convbar ] implies that the finite difference approximations of the sensitivities of the digital and down - and - out put options also converge pointwise as @xmath149 for any spot price @xmath206 away from the barrier @xmath154 and any maturity @xmath146 . to rigorously prove pointwise convergence of the sensitivities , uniform estimates",
    "would be needed of the errors in .",
    "it is worth noting that , while for lvy processes with positive gaussian component first - passage probabilities and value - functions of barrier options are smooth up to the barrier , such is not necessarily the case for a lvy process without gaussian component , especially at the barrier where the spatial derivatives may be infinite .",
    "however , when suitably _ smoothed _ , the sensitivities do converge pointwise :    [ cor : sens ] for some @xmath307 let @xmath308 , where @xmath309 is a @xmath310 probability density with support in @xmath311",
    ". then it holds that @xmath312 for @xmath313 , as @xmath149 .",
    "a similar statement holds true for the theta , replacing smoothing in space by smoothing in time . note",
    "that , if @xmath314 is @xmath315 on @xmath316 , then @xmath317 , @xmath159 , can be made arbitrarily small by choosing @xmath318 small enough ( similar remarks apply to the other greeks )    in view of the definition of @xmath319 and integration by parts it follows that @xmath320 by the dominated convergence theorem and proposition [ prop : convbar ] it thus follows that the rhs of converges to @xmath321 as @xmath149 .",
    "the convergence of the gamma follows by a similar reasoning .",
    "in this paper we developed an efficient algorithm to compute prices and sensitivities of barrier options driven by an exponential lvy model of generalised hyper - exponential type .",
    "we showed that the latter class contains many of the lvy models that are employed in mathematical finance .",
    "we first approximated the target lvy measure by a hyper - exponential one .",
    "subsequently , for log - price processes in this class , jump - diffusions with hyper - exponential jumps , we derived analytical expressions for the prices and sensitivities ( greeks ) of digital , knock - in and knock - out option prices , up to a single laplace transform .",
    "inversion of this laplace transform yielded fast and accurate results for the option prices and sensitivities .",
    "we proved convergence of this algorithm . to provide a numerical illustration we implemented the algorithm for the vg and nig lvy models , approximating the nig and vg lvy densities by hyper - exponential ones with 7 upward and 7 downward phases .",
    "compared with monte carlo simulation results we found relative errors of about 0.5 - 2.5% for prices and deltas some distance away from the barrier .",
    "what the rate of convergence of this algorithm is when increasing the number of terms in the approximation , and how this rate depends on the quality of the approximation of the target density , the parameters and the distance to the barrier , are open questions that are left for future research .",
    "* appendix *",
    "the arbitrage free prices of the corresponding up - and - in digitals ( contracts that pays out @xmath322 if an upper barrier is crossed , either at @xmath155 or at the moment @xmath323 of up - crossing ) are given by @xmath324 , \\quad auid(t , s_0,h ) = e[\\te{-rt^+(h)}\\mbf 1_{\\{\\ovl s(t ) > h\\}}],\\ ] ] where @xmath325 denotes the running supremum of @xmath8 up to @xmath155 .",
    "their respective laplace transforms in @xmath155 follow by applying the formulas of the down - and - in digital options to the process @xmath326 : @xmath327      the laplace transform @xmath328 of the arbitrage free price of the down - and - in put option @xmath329 with strike @xmath172 and barrier @xmath154 can be decomposed as @xmath330 - \\frac{s_0}{q+r}e[\\te{x(\\t)}\\mbf 1_{\\{\\unl x(\\t ) < h , x(\\t)<k\\}}]\\\\ & = & \\frac{k}{q+r}d^{(0)}(h , k ) - \\frac{s_0}{q+r}d^{(1)}(h , k),\\end{aligned}\\ ] ] where @xmath331 , @xmath332 and @xmath333 is defined as @xmath334.\\ ] ] reasoning as in proposition [ prop : barrier ] we find that @xmath335p(-\\unl x(\\t)\\in\\td y).\\end{aligned}\\ ] ] after some calculations we arrive at @xmath336",
    "[ prop : sdop1 ] suppose @xmath3 is a hyper - exponential lvy process with @xmath229 and let @xmath81 and @xmath337 .",
    "\\(i ) it holds that @xmath338 .",
    "\\(ii ) if @xmath339 , it holds that @xmath340 , \\\\",
    "\\wh\\gamma_{dop}(q ) & = & \\sum_{j=1}^{k^-}a_j^-(\\rho_j^-)^2(\\rho_j^--1 ) s_0^{\\rho_j^- - 2 } [ kb^{(0)}_{j } - b^{(1)}_j],\\end{aligned}\\ ] ] where @xmath341\\\\ & + & \\frac{1}{b-\\rho_j^-}[h^{b-\\rho_j^- } - k^{b-\\rho_j^-}].\\end{aligned}\\ ] ] ( iii ) if @xmath342 , it holds that @xmath343 \\\\   & \\phantom{= } & + \\sum_{i=1}^{k^+}a_i^+(\\rho_i^+)^2 s_0^{\\rho_i^+ - 1 } [ kg^{(0)}_{i } - g^{(1)}_i ] + \\d_+\\d_- , \\\\",
    "\\wh\\gamma_{dop}(q ) & = & \\sum_{j=1}^{k^-}a_j^-(\\rho_j^-)^2(\\rho_j^--1 ) s_0^{\\rho_j^- - 2 } [ kf^{(0)}_{j } - f^{(1)}_j ] \\\\ & \\phantom{= } & +   \\sum_{i=1}^{k^+}a_i^+(\\rho_i^+)^2(\\rho_i^+-1 ) s_0^{\\rho_i^+ - 2 } [ kg^{(0)}_{j } - g^{(1)}_j],\\end{aligned}\\ ] ] where @xmath344 and @xmath345 and @xmath346,\\\\ g^{(b)}_i & = & \\frac{k^{b-\\rho_i^+}}{b-\\rho_i^+}\\le [ \\sum_{j=1}^{k^-}a_j^-\\frac{\\rho_i^+}{\\rho_j^--\\rho_i^+ } + 1 \\ri].\\end{aligned}\\ ] ]    _ of proposition [ prop : sdop1 ] . _",
    "the formula of the laplace transform of the theta is a consequence of integration by parts and the fact that @xmath347 is continuously differentiable on @xmath16 .",
    "those of the laplace transforms of the delta and the gamma follow by differentiating the expressions in proposition [ prop : barrier ] , following a reasoning analogous to the one in proposition [ prop : ddstar ] .",
    "let @xmath3 be a generalised hyper - exponential lvy process and define @xmath139 as in section [ sec : wh ] .",
    "refer to jacod and shiryaev ( * ? ? ?",
    "vi ) for background on the skorokhod topology and weak convergence of stochastic processes .",
    "let @xmath348 denote the space of real valued right - continuous functions with left - limits on @xmath349 .      .  with regard to corollary vii.3.6 in jacod and shiryaev (",
    "vi ) it follows that it is equivalent to show that @xmath350 converges in distribution to @xmath351 , and that the latter assertion follows if it holds that @xmath352 for any continuous bounded function @xmath353 that is zero around zero , as @xmath149 . as a consequence of the definitions of @xmath133 and @xmath140 given in and it is not hard to verify that these three conditions are indeed satisfied .      .",
    "it follows from proposition vi.2.4 and remark vi.2.3 in jacod and shiryaev @xcite that for each fixed @xmath155 such that @xmath354 , the function @xmath355 given by @xmath356 is continuous ( in the skorokhod topology ) .",
    "in particular , if @xmath357 in the skorokhod topology , then @xmath358 , as @xmath149 . in view of the fact that lvy processes are continuous at each fixed time a.s . , it holds that @xmath359 , and the asserted convergence follows in view of lemma [ lem : weak ] .",
    "_ of proposition [ prop : convwh ] . _ the convergence of @xmath147 is proved in lemma [ lem : weakxx ] .",
    "if @xmath3 is not of type a , it is shown in lemma 49.3 in sato(1999 ) that @xmath360 and @xmath361 are continuous random variables on @xmath16 ( with possibly an atom in zero if @xmath3 is of bounded variation ) .",
    "the statement thus follows in view of the continuity theorem .",
    "since @xmath362 , also follows ."
  ],
  "abstract_text": [
    "<S> in this paper we propose a transform method to compute the prices and greeks of barrier options driven by a class of lvy processes . </S>",
    "<S> we derive analytical expressions for the laplace transforms in time of the prices and sensitivities of single barrier options in an exponential lvy model with hyper - exponential jumps . </S>",
    "<S> inversion of these single laplace transform yields rapid , accurate results . </S>",
    "<S> these results are employed to construct an approximation of the prices and sensitivities of barrier options in exponential _ generalised hyper - exponential _ ( ghe ) lvy models . </S>",
    "<S> the latter class includes many of the lvy models employed in quantitative finance such as the variance gamma ( vg ) , kobol , generalised hyperbolic , and the normal inverse gaussian ( nig ) models . </S>",
    "<S> convergence of the approximating prices and sensitivities is proved . to provide a numerical illustration , </S>",
    "<S> this transform approach is compared with monte carlo simulation in the cases that the driving process is a vg and a nig lvy process . </S>",
    "<S> parameters are calibrated to stoxx50e call options .    _ </S>",
    "<S> keywords : _ lvy processes , first passage time , wiener - hopf factorization , barrier options , european and american digital options , sensitivities , laplace transform .    </S>",
    "<S> _ acknowledgements : _ this research was supported by the nuffield foundation grant no . </S>",
    "<S> nuf - nal/00761/g and epsrc grant ep / d039053/1 . </S>",
    "<S> the research was in part carried out while the authors were based at king s college london . </S>",
    "<S> we would like to thank kenichi kurasawa and denis wallez for fruitful conversations , patrick howard for his support and john crosby , lane hughston , alex mijatovic , and two anonymous referees for useful suggestions that improved the paper . </S>"
  ]
}