{
  "article_text": [
    "the need to sample random vectors of correlated binary variables arises in various statistical application ; examples are estimation of the posterior mean in bayesian variable selection @xcite , small - sample properties of estimators in longitudinal studies ( * ? ? ?",
    "* for a recent review ) , stochastic binary optimization in combinatorics @xcite , simulation of ferromagnetic materials @xcite , performance of neural networks @xcite and market segmentation analysis @xcite among others .",
    "let @xmath0 denote the binary space . in some cases , such as small - sample analysis in longitudinal studies ,",
    "we need a parametric family @xmath1 explicitly for sampling data on @xmath2 with specified mean and correlations .",
    "in other cases , the parametric family serves as a proxy for a more complex distribution we can not directly sample from .",
    "suppose we have two functions @xmath3 and @xmath4 and we want to compute the expected value @xmath5 with @xmath6 .",
    "if @xmath7 is too large for enumeration of the state space we have to rely on monte carlo algorithms , the vast majority of which involve sampling markov transitions with invariant measure @xmath8 , the standard approach being the metropolis - hastings kernel ( * ? ? ?",
    "* ch . 7 ) . for a transition from @xmath9",
    ", we sample @xmath10 from an auxiliary kernel @xmath1 and accept the step to @xmath11 with probability @xmath12/[\\tilde\\pi(\\v x){\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{(}}}\\flushleft{}}\\v\\gamma\\mid \\v x)]}\\ ] ] or return @xmath13 otherwise .",
    "random walks on @xmath2 are easy to implement but often suffer from slow mixing ; independent proposals @xmath14 provide fast - mixing if @xmath15 is reasonably high on average , in other words if @xmath1 is sufficiently close to @xmath8 @xcite .",
    "this rationale complements other approaches to fast mixing such as parallel chains ( * ? ? ? * among others ) or self - avoiding dynamics @xcite .",
    "+ the vast field of potential applications in monte carlo algorithms encourages the study of families with @xmath16 parameters which , like the multivariate normal , accommodate all valid combinations of means and correlations .",
    "this paper elaborates some theoretical background on random binary vectors , proves the range of possible correlations for a particular class of parametric families , connects to existing work in the literature and provides broad numerical insight concerning the range of dependencies achievable in practice .",
    "it is structured as follows .    in section [ sec : properties ] , we introduce suitable notation and review results relating binary distributions to its moments .",
    "section [ sec : families from glms ] elaborates on parametric families which have , by definition , conditional distributions that are generalized linear regressions .",
    "we show that they accommodate the whole range of possible correlations .",
    "section [ sec : log cond family ] motivates the use of the logistic link function as an approximation to the ising - type exponential quadratic family . in section [ sec : sampling ] , we discuss how to adjust the parametric families to specified marginals .",
    "finally , in section [ sec : numerical experiments ] we perform numerical experiments to compare competing approaches for sampling correlated binary data in high dimensions .",
    "we write @xmath0 for the binary space and denote by @xmath17 the generic dimension . given a vector @xmath18 and an index set @xmath19 , we write @xmath20 for the sub - vector indexed by @xmath21 and @xmath22 for its complement . for @xmath23 we use the more explicit notation @xmath24 .",
    "unless otherwise defined , @xmath8 denotes an arbitrary probability mass function on @xmath2 .",
    "we denote by @xmath25 the expected value with respect to @xmath26 and write @xmath27 for an event @xmath28 .",
    "let @xmath29 be a mean vector .",
    "we call @xmath30 the product family or the mass function of @xmath7 independent bernoulli variables .      for a set @xmath31",
    ", we refer to @xmath32 as the cross - moment indexed by @xmath21 .",
    "note that @xmath33 which means that cross - moments and marginal probabilities indexed by @xmath31 are identical .",
    "higher order cross - moments coincide with first order cross - moments .",
    "the range of possible cross - moments is limited by the following constraints .",
    "[ prop : bin bounds ] the cross - moments of binary data fulfill the sharp inequalities @xmath34    the lower bound follows from @xmath35 the upper bound is the monotonicity of the measure .",
    "for the special case @xmath36 , proposition [ eq : bin bounds ] is a well - known result and has been invoked in several articles dealing with correlated binary data . for the general case , we remark that a mapping @xmath37^{\\abs{i}}\\to[0,1],\\ f_{i}(m_{i_1},\\dots , m_{i_{\\abs{i}}})=m_{i}$ ] , which assigns a cross - moment @xmath38 for @xmath31 as function of the marginals @xmath39 for @xmath40 , is quite similar to a @xmath41-dimensional copula and the inequalities are exactly the frchet - hoeffding bounds ( * ? ? ?",
    "[ def : cross - moment matrix ] we say a @xmath42 symmetric matrix @xmath43 with entries in @xmath44 is a _ cross - moment matrix of binary data _ if @xmath45 is positive definite and condition holds for all @xmath31 with @xmath36 .",
    "we derive the family of distributions which , under the constraints that @xmath8 has given cross - moments , maximizes the entropy @xmath46 $ ] .",
    "the following proposition is just a special case of a more general concept @xcite .",
    "[ prop : maxent ] let @xmath47 be a family of index sets such that @xmath48 is a valid set of cross - moments .",
    "the maximum entropy distribution having the specified cross - moments has the form @xmath49 $ ] .",
    "define the lagrange multipliers @xmath50 $ ] and differentiate @xmath51/\\partial \\pi(\\v\\gamma)=-\\log[\\pi(\\v\\gamma)]-1+\\sum_{i\\in \\mathcal i}a_{i}\\prod_{i\\in i}\\gamma_i$ ] .",
    "solving the first order condition and normalizing completes the proof .      for a set @xmath31 ,",
    "we define @xmath52^{-1/2 } $ ] and refer to @xmath53 as the ( generalized ) correlation coefficient indexed by @xmath21 .",
    "a @xmath42 positive definite matrix @xmath54 with entries in @xmath55 $ ] and @xmath56 is not the correlation matrix of a binary distribution for every mean vector @xmath29 .",
    "in fact , @xmath54 is a correlation matrix if and only if @xmath57 is valid in the sense of definition [ def : cross - moment matrix ] , where the dot means point - wise multiplication and @xmath58 .",
    "@xcite elaborate alternative conditions for compatibility between correlations and means , but these do not seem easier to express or to check .    in the context of binary data ,",
    "the notion of `` strong correlations '' refers to correlation coefficients which are at the boundary of the feasible range with respect to the mean vector .",
    "note that the absolute value of the correlation coefficient does , in itself , not tell whether the correlation is easy or difficult to model .",
    "the following statement relates the notions of uncorrelated and independent variables .",
    "let @xmath13 be a @xmath7-dimensional binary random vector . for @xmath59 ,",
    "entries are uncorrelated if and only if they are independent . for @xmath60",
    ", entries might be mutually uncorrelated but not independent .",
    "let @xmath61 . by definition @xmath62 .",
    "further , we obtain @xmath63 and , analogously , @xmath64 . finally , we have @xmath65 . for @xmath66 ,",
    "let for instance @xmath67 and @xmath68 .",
    "the entries are mutually uncorrelated , but not independent since @xmath69 .",
    "the following representation by @xcite allows to write a binary distribution in terms of its generalized correlation coefficients .    [",
    "prop : bahadur ] let @xmath8 be a binary distribution with mean @xmath29 . then ,",
    "@xmath70.\\ ] ]    we give the proof by @xcite using the notation introduced above .",
    "the set @xmath71 forms an orthonormal basis on @xmath72 with respect to the inner product @xmath73 therefore , every function @xmath74 has a unique representation @xmath75 .",
    "compute the inner products @xmath76u_i^{\\pi}(\\v\\gamma){\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{^}}}\\flushleft{}}\\prod_{\\v m}(\\v\\gamma ) = { \\mathbb{e}_{\\pi}\\left(u_i^{\\pi}(\\v \\gamma ) \\right)}=c_i^{\\pi } $ ] to obtain the desired form @xmath77 .",
    "using proposition [ prop : bahadur ] , we may bound the @xmath78 distance between two binary distribution with the same mean in terms of nearness of their correlation coefficients .",
    "let @xmath8 and @xmath79 be binary distributions with mean @xmath29 .",
    "for @xmath80 , @xmath81 where @xmath82 .",
    "since @xmath83 for all @xmath31 , applying proposition [ prop : bahadur ] yields @xmath84 using that @xmath85 for all @xmath86 , we obtain the bound @xmath87^{1/2}[m_i^{p-1}+(1-m_i)^{p-1 } ] \\leq 2^{(1-\\min\\set{p,2})\\abs{i}}.\\ ] ] finally , we have @xmath88 , since by definition @xmath89 for all @xmath31 with @xmath90 .    [",
    "corr : cross moments ] let @xmath8 and @xmath1 be binary distributions with cross - moment matrix @xmath91 .",
    "then we have @xmath92 .    with regard to the metropolis - hastings kernel mentioned in the introductory section , the factor @xmath93 in corollary [ corr :",
    "cross moments ] is the gain of a more complex proposal distribution @xmath94 with @xmath95 over a simple product model @xmath96 with @xmath97 .",
    "the following result shows how the cross - moments of the proposal distribution affect the auto - covariance of the independent metropolis - hastings sampler .",
    "let @xmath8 and @xmath1 be binary distributions with mean @xmath29 and denote by @xmath98 $ ] the metropolis - hastings kernel with invariant measure @xmath8 and proposal distribution @xmath1 where @xmath99 is defined in .",
    "the auto - covariance between @xmath100 and @xmath101 is @xmath102 with @xmath103 where @xmath104 .",
    "we plug the definition of the kernel into the expected value and obtain @xmath105\\pi(\\v x ) \\\\ & = m_{ij}^{\\pi}+\\sum_{\\v \\gamma,\\,\\v x\\in\\b^{d } } ( \\gamma_ix_j - x_ix_j ) { \\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{(}}}\\flushleft{}}\\v\\gamma)\\pi(\\v x)\\lambda_{{\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{}}}}\\flushleft{}}(\\v\\gamma,\\v x ) \\\\ & = m_im_j+\\frac{1}{2}(m_{ij}^{\\pi}-m_{ij}^{{\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{}}}}\\flushleft{}})+\\frac{1}{2}\\sum_{\\v \\gamma,\\,\\v x\\in\\b^{d } } ( \\gamma_ix_j - x_ix_j ) \\abs{{\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{(}}}\\flushleft{}}\\v\\gamma)\\pi(\\v",
    "x)-{\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{(}}}\\flushleft{}}\\v x)\\pi(\\v\\gamma)},\\end{aligned}\\ ] ] where we used @xmath106 .",
    "the triangle inequality @xmath107 = 2\\sum_{\\v \\gamma\\in\\b^{d}}\\abs{\\pi(\\v\\gamma)-{\\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{(}}}\\flushleft{}}\\v\\gamma)}.\\end{aligned}\\ ] ] yields the bound on @xmath108 .      for some applications , it suffices to model structured dependencies , such as exchangeable @xmath109 , moving average @xmath110 or autoregressive @xmath111 correlations for @xmath112 .",
    "there is a long series of articles concerned with efficient approaches to sampling binary vectors for structured correlations @xcite . in this paper",
    ", we focus on the problem of sampling binary data with arbitrary cross - moment matrix .",
    "we want to construct a parametric family @xmath1 for sampling independent random vectors with specified mean and correlations . sampling in high dimensions , however , requires the computation of conditional distributions @xmath113 , and it is therefore convenient to define the parametric family directly in terms of its conditionals .",
    "let @xmath114 $ ] be a monotonic function and @xmath115 a @xmath42 real - valued lower triangular matrix .",
    "we refer to @xmath116^{\\gamma_i}\\left[1-\\link(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)\\right]^{1-\\gamma_i},\\end{aligned}\\ ] ] as the @xmath117-conditionals family .",
    "[ cor : mu product ] let @xmath114 $ ] be a monotonic bijection and @xmath118 a mean vector . for @xmath119 $ ] we have @xmath120 .    by construction",
    ", it is straightforward to sample @xmath121 and evaluate @xmath122 point - wise as summarized in procedure [ algo : sampling ] .",
    "alternatively , one could sample from an auxiliary distribution @xmath123 on @xmath124 which allows to compute @xmath125 and define a parametric family @xmath126 through the mapping @xmath127 .",
    "we come back to this idea in section [ sec : gaussian ] .",
    "@xmath128 @xmath129 , @xmath130}$ ] + * if @xmath131 * then @xmath132 + @xmath133 + @xmath134 * *    [ algo : sampling ]    @xcite discusses the @xmath135-conditionals family with a truncated linear link function @xmath136 .",
    "the linear structure allows to compute the parameters by simple matrix inversion ; on the downside , the linear function is truncated and fails to accommodate complicated correlation structures .",
    "therefore , @xcite elaborates on conditions that guarantee the linear conditionals family to be valid for special correlation structures .",
    "@xcite propose a @xmath135-conditionals family with a logistic link function @xmath137 $ ] .",
    "however , they only analyze the special case of autoregressive correlation structure . in section",
    "[ sec : log cond family ] , we further motivate the use of the logistic link function which indeed allows to model any feasible correlation structure as states the following theorem .",
    "[ thm : mean+corr ] let @xmath138 $ ] be a monotonic , differentiable bijection and @xmath91 a @xmath42 cross - moment matrix .",
    "there is a unique @xmath42 real - valued lower triangular matrix @xmath139 such that @xmath140 .    besides the logistic function invoked above ,",
    "popular link functions include the complementrary log - log function with @xmath141 $ ] and the probit function with @xmath142 @xcite .",
    "we derive two auxiliary results to structure the proof of theorem [ thm : mean+corr ] .",
    "[ lem : ext cross - moments ] for a cross - moment matrix @xmath91 with mean vector @xmath143 , we have @xmath144    note that @xmath145 because the covariance matrix @xmath146 is positive definite .",
    "dividing by @xmath147 we obtain @xmath148 which yields @xmath149 = \\det(\\m m ) \\det \\begin{pmatrix } \\m i & \\m m^{-1}\\v m \\\\",
    "0\\t & ( 1-\\v m\\t\\m m^{-1}\\v m ) \\end{pmatrix } \\\\[1ex ] & = \\det(\\m m)(1-\\v m\\t\\m m^{-1}\\v m)>0.\\end{aligned}\\ ] ] therefore , all principal minors are positive .",
    "[ lem : bijective ] let @xmath138 $ ] be a monotonic , differentiable bijection , and denote by @xmath150 the open ball with radius @xmath151 .",
    "let @xmath8 be a binary distribution with cross - moment matrix @xmath91 .",
    "we write @xmath143 and @xmath152 for the mean vector .",
    "there is @xmath153 such that the function @xmath154 is a differentiable bijection .",
    "we set @xmath155 for @xmath156 , the partial derivatives of @xmath157 are @xmath158 we have @xmath159 since @xmath117 is strictly monotonic .",
    "then the jacobian is positive for all @xmath160 , @xmath161 \\geq \\eta_r^{d+1}\\ , \\det \\begin{pmatrix } \\m m & \\v m \\\\",
    "\\v m\\t & 1 \\end{pmatrix } > 0,\\end{aligned}\\ ] ] where we applied lemma [ lem : ext cross - moments ] in the last inequality .",
    "we proceed by induction over @xmath7 . for @xmath162 , @xmath163 is a scalar and we define the @xmath135-conditionals family @xmath164 via corollary [ cor : mu product ] .",
    "suppose that we have already constructed a @xmath135-conditionals family @xmath165 with @xmath42 lower triangular matrix @xmath166 and cross - moment matrix @xmath167 .",
    "we can add a new dimension to the @xmath135-conditionals model @xmath165 without changing @xmath167 , since @xmath168^{\\xi_{d+1}}\\times\\\\ & \\qquad \\left[1-\\link(a_{d+1,d+1}+\\textstyle\\sum_{j=1}^{d } a_{d+1,j}\\xi_j)\\right]^{1-\\xi_{d+1 } } \\\\ = & \\ \\sum_{\\v\\gamma\\in\\b^d } { \\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{_}}}\\flushleft{}}{\\m a(d)}^{\\link}(\\v\\gamma ) \\bigg\\ { \\link(a_{d+1,d+1}+\\textstyle\\sum_{j=1}^{d } a_{d+1,j}\\gamma_j ) \\begin{pmatrix } \\v\\gamma\\v\\gamma\\t & \\v\\gamma \\\\ \\v\\gamma\\t   & 1 \\end{pmatrix}+\\\\ & \\qquad \\left[1-\\link(a_{d+1,d+1}+\\textstyle\\sum_{j=1}^{d } a_{d+1,j}\\gamma_j)\\right ] \\begin{pmatrix } \\v\\gamma\\v\\gamma\\t & \\v0 \\\\ \\v0\\t   & 0 \\end{pmatrix } \\bigg\\ } \\\\ = & \\ \\sum_{\\v\\gamma\\in\\b^d } { \\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{^}}}\\flushleft{}}{\\link}_{\\m a(d)}(\\v\\gamma ) \\link(a_{d+1,d+1}+\\textstyle\\sum_{j=1}^{d } a_{d+1,j}\\gamma_j ) \\begin{pmatrix } \\m 0    & \\v\\gamma \\\\ \\v\\gamma\\t   & 1 \\end{pmatrix}+\\\\ & \\qquad \\begin{pmatrix } \\m m(d ) & \\v0 \\\\",
    "\\v0 \\t   & 0 \\end{pmatrix}\\end{aligned}\\ ] ] for reasons of symmetry , it suffices to show that there is @xmath169 such that @xmath170 where the r.h.s . denotes the @xmath171th column of the augmented cross - moment matrix .",
    "there is @xmath172 so that @xmath173 with @xmath174\\t,1)$ ] which implies that a solution is contained in a sufficiently large open ball @xmath175 .",
    "we apply lemma [ lem : bijective ] to complete the inductive step and the proof .",
    "we denote by @xmath176 the logistic conditionals family , that is the @xmath135-conditionals family with logistic link function @xmath177 $ ] .",
    "this parametric family has been proposed by @xcite , and in more general terms suggested by @xcite . in this section ,",
    "we motivate why the logistic link function arises somewhat naturally in the context of @xmath135-conditional families .",
    "let @xmath139 be a @xmath42 real - valued lower triangular matrix .",
    "we refer to @xmath178 as the exponential quadratic family with @xmath179 $ ] .    if @xmath180 , then @xmath181 and @xmath182 .",
    "the exponential quadratic family is a natural way to design a parametric family and plays a central role in physics and life science being the well - studied ising model on a weighted complete graph .",
    "it links to information theory @xcite , log - linear theory for contingency tables ( * ? ? ?",
    "* ch . 5 ) and graphical models ( * ? ? ?",
    "finding its mode is an np - hard problem and intensively studied in the field of operation research ( * ? ? ?",
    "* for a recent review ) .",
    "proposition [ prop : maxent ] states that the exponential quadratic family is the maximum entropy distribution on @xmath183 having a given cross - moment matrix .",
    "it appears to be the binary analogue of the multivariate normal distribution which is the maximum entropy distribution on @xmath184 having a given covariance matrix @xcite .",
    "we can read the parameters @xmath185 as lagrange multipliers or , if @xmath186 , as conditional log odd - ratios since @xmath187.\\ ] ] we might interpret the constant conditional log odd - ratios as analogue of the constant conditional correlations of the multivariate normal distribution @xcite .",
    "despite these similarities to the multivariate normal distribution , we can not easily sample from the exponential quadratic family nor explicitly relate the parameter @xmath139 to the cross - moment matrix @xmath91 .",
    "the reason is that the lower dimensional marginal distributions are difficult to compute ( * ? ? ?",
    "* ( iii ) ) .",
    "the marginal distribution of the exponential quadratic family is @xmath188\\right).\\ ] ]    we can not repeat the marginalization since the multi - linear structure is lost . in fact , the following result shows that the logistic conditionals family is precisely constructed such that the non - linear term in the above expression vanishes .",
    "let @xmath139 be a @xmath42 lower triangular matrix .",
    "the logistic conditionals family can be written as @xmath189\\right).\\end{aligned}\\ ] ]    straightforward calculations yield @xmath190^{\\gamma_i}[1-\\logistic(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]^{1-\\gamma_i}\\right ) \\\\ & \\textstyle= \\sum_{i=1}^d\\left(\\gamma_i\\log[\\logistic(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]+ ( 1-\\gamma_i)\\log[1-\\logistic(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]\\right ) \\\\ & \\textstyle= \\sum_{i=1}^d\\left(\\gamma_i\\,\\logistic^{-1}[\\logistic(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]+ \\log[1-\\logistic(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]\\right ) \\\\ & \\textstyle= \\sum_{i=1}^d\\left(\\gamma_i(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)- \\log[1+\\exp(a_{ii}+\\sum_{j=1}^{i-1}a_{ij}\\gamma_j)]\\right ) \\\\ & \\textstyle= \\sum_{i=1}^d\\sum_{j=1}^i",
    "a_{ij}\\gamma_i\\gamma_j-\\sum_{i=1}^d \\log[1+\\exp(a_{ii}+\\sum_{j=1}^{i-1 } a_{ij}\\gamma_j ) ] \\\\ & \\textstyle= \\v\\gamma\\t\\m",
    "a\\v\\gamma-\\sum_{i=1}^d \\log[1+\\exp(a_{ii}+\\sum_{j=1}^{i-1 } a_{ij}\\gamma_j)],\\end{aligned}\\ ] ] where we used @xmath191=-\\log[1+\\exp(x)]$ ] in the third line .",
    "the full conditional probability of the @xmath7-dimensional exponential quadratic family is a logistic regression term .",
    "the conditional distribution of the exponential quadratic family is @xmath192    since we can not repeat the marginalization for lower dimensions , we can not assess the lower dimensional conditional probabilities which are necessary for sampling .",
    "we can , however , derive a series of approximate marginal probabilities that produce a logistic conditionals family which is , for low correlations , close to the original exponential quadratic family .",
    "this idea goes back to @xcite .",
    "let @xmath193 $ ] be a second order approximation .",
    "we may approximate the marginal distribution @xmath194 by an exponential quadratic family @xmath195 with parameters @xmath196 where @xmath197 denotes the @xmath7th column of @xmath139 without @xmath198 .",
    "we write the marginal distribution of the exponential quadratic family as @xmath199\\right)\\big].\\end{aligned}\\ ] ] using the identity @xmath200 = \\textstyle\\log\\big(\\exp(\\frac{1}{2}x)\\big[\\exp(-\\frac{1}{2}x)+\\exp(\\frac{1}{2}x)\\big]\\big ) = \\textstyle\\frac{1}{2}x+\\log\\big[2\\cosh(\\frac{1}{2}x)\\big]\\ ] ] and approximate the non - quadratic term by the second order polynomial @xmath201\\approx c_1+c_2 \\v a_{*}\\t\\v\\gamma_{-d}+c_3 ( \\v a_{*}\\t\\v\\gamma_{-d})^2.\\ ] ] we rewrite the inner products @xmath202\\v\\gamma_{-d}$ ] and rearrange the quadratic terms .",
    "we can iterate the procedure to construct a logistic conditionals family which is close to the original exponential quadratic family .",
    "however , the function @xmath203 $ ] behaves like a quadratic function around zero and like the absolute value function for large @xmath204 .",
    "thus , a quadratic polynomial can only approximate @xmath203 $ ] well for small values of @xmath205 which means that exponential quadratic families with strong dependencies is hard to approximate .",
    "@xcite propose a taylor approximation which fits well around @xmath206 and works for weak correlations .",
    "the parameters are @xmath207),\\frac{1}{2}\\tanh(\\frac{1}{2}a_{dd}),\\frac{1}{8}\\,\\mathrm{sech}^2(\\frac{1}{2}a_{dd})\\big)$ ] .",
    "if @xmath208 full probabilities are known , we easily sample from the corresponding multinomial distribution @xcite . for a valid set of cross - moments @xmath209 , @xmath210",
    ", @xcite proposes to compute the full probabilities using a variant of the iterative proportional fitting algorithm @xcite .",
    "while there are no restrictions on the range of dependencies , we have to enumerate the entire state space which limits this versatile approach to low dimensions .    in the sequel",
    ", we do not consider methods for structured correlations nor approaches which require enumeration of the state space .",
    "first , we show how to compute the parameter @xmath139 of a @xmath135-conditionals model for a given cross - moment matrix @xmath91 .",
    "secondly , we review an alternative approach to sampling binary data based on the multivariate normal distribution @xcite .",
    "the proof of theorem [ thm : mean+corr ] suggests an iterative procedure to adjust the parameter @xmath139 to a given cross - moment matrix @xmath91 .",
    "we add new cross - moments @xmath211 to the @xmath42 a lower triangular matrix @xmath139 by solving the non - linear equation @xmath212 via newton - raphson iterations @xmath213^{-1}[f(\\v a^{(k)})-\\v m]$ ] where @xmath214(\\v\\gamma\\t,1)\\t \\\\ f'(\\v a)&=\\textstyle\\sum_{\\v\\gamma\\in\\b^{d } }",
    "{ \\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{_}}}\\flushleft{}}{\\m a}^{\\link}(\\v\\gamma)\\link'[(\\v\\gamma\\t,1)\\v a](\\v\\gamma\\t,1)\\t(\\v\\gamma\\t,1)\\end{aligned}\\ ] ] for dimensions @xmath215 , the exact computation of the expectations becomes expensive , and we replace @xmath157 and @xmath216 by their monte carlo estimates @xmath217(\\v x_k\\t,1 ) \\\\",
    "\\hat f'(\\v a)&=\\textstyle\\sum_{k=1}^n { \\centering{\\colorbox{yellow}{\\parbox{0.9\\textwidth}{_}}}\\flushleft{}}{\\m a}^{\\link}(\\v\\gamma)\\link'[(\\v x_k\\t,1)\\v a)](\\v x_k\\t,1)\\t(\\v x_k\\t,1 ) \\end{aligned}\\ ] ] where @xmath218 are drawn from @xmath219 .",
    "some remarks are in order .    *",
    "if the smallest eigenvalue of @xmath220 approaches zero or a cross - moment @xmath221 approaches the bounds , the parameter @xmath185 may become very large in absolute value .",
    "the limited numerical accuracy available on a computer inhibits sampling from such extreme cases .",
    "* we might encounter numerical trouble in the course of the fitting procedure . in order to circumvent problems",
    ", we set @xmath222 for all @xmath223 and compute a sequence of solutions @xmath224 to the cross - moments @xmath225 .",
    "we stop if the parameters fail to converge which ensures that the mean of the @xmath135-conditionals family is always @xmath226 . *",
    "if we have data available instead of cross - moments , we would rather fit the family via component - wise likelihood maximization which is usually faster than the method of moments and can even be parallelized @xcite .",
    "* for the linear link function @xmath227 , we obtain @xmath228\\v a = \\begin{pmatrix } \\m m    & \\v m \\\\ \\v m\\t & 1 \\end{pmatrix}\\v a\\end{aligned}\\ ] ] which always has a solution by virtue of lemma [ lem : ext cross - moments ] ; to construct a mass function , however , we have to fall back to the truncated version @xmath136 , and the range of feasible cross - moments is hard to assess @xcite .",
    "@xcite propose to dichotomize a multivariate gaussian distribution for sampling multivariate binary data .    for a vector @xmath229 and a @xmath42 correlation matrix @xmath230",
    "we define the gaussian copula family @xmath231 where @xmath232}(x_1),\\dots,\\ind_{(-\\infty , a_d]}(x_d)\\right)$ ] .    for all @xmath31 , the marginals are @xmath233 \\scriptscriptstyle ( -\\infty , a_i ]     & \\scriptstyle \\hspace{-.7em } i\\in i \\\\[-.5em ] \\scriptscriptstyle ( -\\infty,\\infty ) & \\scriptstyle \\hspace{-.7em } i\\notin i \\end{cases}}\\ , \\varphi_{\\g \\sigma}(\\v v)\\,d\\v v=\\phi_{\\g \\sigma}^{(i)}(\\v a_i),\\end{aligned}\\ ] ] where @xmath234 is the marginal cumulative distribution function of the multivariate gaussian .",
    "we set @xmath235 for @xmath236 to adjust the mean . in order to compute the parameter @xmath230 that yields the desired cross - moments @xmath91",
    ", we may use a fast series approximations @xcite to solve @xmath237 for @xmath238 via newton - raphson iterations @xmath239/\\varphi_{\\sigma_{ij}^r}(a_i , a_j)$ ] ; @xcite suggests the bivariate @xcite distribution as a proxy for @xmath240 which might provide a good starting value @xmath241 .    while we always obtain a solution in the bivariate case , it is well - known that the resulting matrix @xmath230 is not necessarily positive definite due to the range of the gaussian copula which allows to attain the bounds for @xmath242 , but not for higher dimensions . in that case , we can replace @xmath230 by @xmath243 where @xmath244 is smaller than any eigenvalue of @xmath230 .",
    "alternatively , we can project @xmath230 into the set of correlation matrices ; see @xcite and follow - up papers for algorithms that compute the nearest correlation matrix in frobenius norm .",
    "the point - wise evaluation of @xmath245 requires the computation of multivariate normal probabilities , that is high - dimensional integrals with the respect to the density of the multivariate normal distribution .",
    "this is a computationally challenging task in itself ( see e.g. * ? ? ?",
    "* ) , and the gaussian copula family is therefore not easily incorporated into the markov chain monte carlo algorithms briefly discussed in the introduction .",
    "in this section , we compare the @xmath135-conditionals family with truncated linear and logistic link function to the gaussian copula family .",
    "we draw random cross - moment matrices of varying dimension and difficulty , fit the parametric families and record how well the desired correlation structure can be reproduced on average .",
    "we first sample the mean @xmath246 .",
    "for the off - diagonal elements , we have to ensure that the covariance matrix @xmath146 is positive definite and that the constraints are all met .",
    "we alternate the following two steps .    * permutations @xmath247 for @xmath248 with uniform @xmath249 where we denote by @xmath250 the set of all permutations on @xmath251 .",
    "* replacements @xmath252}$ ] for all @xmath253 with uniform @xmath254 where the bounds @xmath255 are subject to the constraints @xmath256 and @xmath257 .",
    "the replacement step needs some consideration .",
    "we denote by @xmath258 the inverse of the @xmath259 upper sub - matrix of @xmath91 and define @xmath260 such that @xmath261 ( m_{dd}-\\sum_{i\\in d\\setminus\\set d}\\tau_i).$ ] if we replace @xmath262 by @xmath263 we have to ensure that @xmath264=\\det(\\m m)+m_{di}(m_{di}n_{ii}+2\\tau_{i})-x_i(x_in_{ii}+2\\tau_{i})>0 $ ] which means @xmath265 with @xmath266^{-1/2}$ ] . therefore , the lower and upper bounds , @xmath267 and @xmath268 , respect all constraints on @xmath263 .",
    "we rapidly update the value of the determinant @xmath264 $ ] and proceed with the next entry .",
    "we perform @xmath269 permutation steps and run @xmath270 sweeps of replacements between permutations .",
    "the result is approximately a uniform draw from the set of feasible cross - moments matrices .",
    "however , sampling according to these cross - moments might not be possible in higher dimensions because the cross - moment matrix is likely to contain extreme cases which are beyond the scope of the parametric family or not workable for numerical reasons .",
    "we introduce a parameter @xmath271 $ ] which governs the difficulty of the sampling problem by shrinking the upper and lower bounds @xmath272 and @xmath273 of the uniform distributions to @xmath274/2 $ ] and @xmath275/2 $ ] , respectively .",
    "let @xmath91 be a cross - moments matrix and let @xmath276 denote the cross - moment matrix with mean @xmath143 and uncorrelated entries @xmath277 for all @xmath112 . for a parametric family @xmath278 , we define the figure of merit @xmath279 where @xmath280 denotes the sampling cross - moment matrix of the parametric family with parameter @xmath281 adjusted to the desired cross - moment matrix @xmath91 .",
    "the norm @xmath282 might be any non - trivial matrix norm ; in our numerical experiments we use the spectral norm @xmath283 , where @xmath284 delivers the largest eigenvalue , but we found the frobenius norm @xmath285 to provide qualitatively the very same picture .      for fitting the logistic conditionals family when @xmath215 , we replace the exact terms by monte carlo estimates where we use @xmath286 random samples .",
    "we estimate the cross - moment matrix of the parametric family @xmath1 by @xmath287 where we use @xmath288 samples from @xmath1 .",
    "this concerns only the logistic and linear conditionals families ; for the gaussian copula family , we can explicitly compute the sampling cross - moments as @xmath289 , where @xmath230 is the adjusted correlation matrix of the underlying multivariate normal distribution made feasible via .",
    "we loop over @xmath290 levels of difficulty @xmath271 $ ] in @xmath291 dimensions @xmath292 , and generate at each time @xmath293 cross - moments matrices .",
    "we denote by @xmath294 the ordered figures of merit of the random cross - moment matrices .",
    "we report the median and the quantiles @xmath295 , depicted as underlying gray areas for @xmath296 equidistant values of @xmath297 $ ] .",
    "figures 1 - 3 show the results grouped by parametric families ; the @xmath298-axis with the scale on the left represents the figure of merit @xmath299 $ ] , the @xmath205-axis represents the level of difficulty @xmath271 $ ] , and the @xmath300$]-gray - scale on the right refers to the level of the quantiles .",
    "+    @xmath301@xmath302@xmath303 +       @xmath301@xmath302@xmath303 +      +    @xmath301@xmath302@xmath303 +        while theorem [ thm : mean+corr ] suggests that the scope of the logistic conditionals family is far beyond competing approaches , we can not , in practice , expect a binary parametric family with @xmath304 dependency parameters to produce just any desired correlation structure .",
    "however , the practical scope of the logistic family is limited only by the available numerical accuracy while the scope of competing methods is also limited by their mathematical structure .",
    "the truncated linear conditionals family is fast to compute but its quality deteriorates rapidly with growing complexity .",
    "the gaussian copula family is guaranteed to have the correct mean but it is less flexible than the logistic conditionals family ; besides , it does not allow for point - wise evaluation of its mass function .",
    "the logistic conditionals family is computationally demanding but by far the most versatile option .",
    "these findings confirm similar comparisons carried out against the backdrop of particular applications @xcite .",
    "this work is part of the author s ph.d .",
    "thesis at crest under supervision of nicolas chopin whom i would like to thank for numerous discussions on this topic .",
    "i thank ioannis kosmidis for his comments on a prior version of this paper ."
  ],
  "abstract_text": [
    "<S> we discuss a class of binary parametric families with conditional probabilities taking the form of generalized linear models and show that this approach allows to model high - dimensional random binary vectors with arbitrary mean and correlation . </S>",
    "<S> we derive the special case of logistic conditionals as an approximation to the ising - type exponential distribution and provide empirical evidence that this parametric family indeed outperforms competing approaches in terms of feasible correlations . </S>"
  ]
}