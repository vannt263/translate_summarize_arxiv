{
  "article_text": [
    "adaptive mesh refinement(amr ) cosmological hydrodynamics simulations play an important role in the study of structure formation of different scales from galaxy clusters to first stars in the past ten years .",
    "its ability to achieve very high resolution in large scale simulations with relatively small computer resources has helped us to understand the first stars formed in our universe .",
    "the possible effects of magnetic fields have been largely ignored .",
    "it is well established that magnetic fields are present on different scales , from intracluster medium to interstellar medium .",
    "the origin and evolution of these magnetic fields and their role on the structure formation are still unclear .",
    "so , it is imperative to include magnetic fields into current hydrodynamics amr cosmology code . in this paper",
    ", we present the newly developed mhd version of the enzo , which is wildly used in the study of first stars @xcite .",
    "the mhd equations in the comoving coordinates are :    @xmath0 & = & - \\frac{\\dot{a}}{a}(\\rho v^{2}+3p+\\frac{b^{2}}{2 } ) \\nonumber \\\\    & & - \\frac{\\rho}{a } \\bf{v}\\cdot \\nabla \\phi \\\\ \\frac{\\partial \\bf{b}}{\\partial t } - \\frac{1}{a } \\nabla \\times ( \\bf{v } \\times \\bf{b } ) & = &   -\\frac{\\dot{a}}{2a}\\bf{b}\\end{aligned}\\ ] ]    with @xmath1 where all variables have their usual meaning , a is the expansion parameter . to track the pressure more accurately in the supersonic region ,",
    "we have also implemented the modified entropy equation given in @xcite and the internal energy equation given in @xcite in our code .",
    "the mhd solver used for all the test problems here is a high - order godunov - type finite - volume numerical solver developed by s.t .",
    "li @xcite .",
    "this solver was recently successfully used to study magnetic jet problems @xcite .",
    "we used a constrained transport(ct ) scheme flux ct @xcite to maintain divergence - free magnetic fields . for the amr hierarchy in enzo",
    ", we used a modified divergence - free reconstruction scheme original proposed by @xcite including second order accurate divergence - free restriction and prolongation for magnetic fields .",
    "details of the ct and amr of magnetic fields in the mhd enzo can be found in @xcite .",
    "the mhd module has been tested and shown to be compatible with other physics packages installed in enzo , such as radiative cooling , star formation and feedback .",
    "the mhd caustic test is taken from @xcite which generalizes the hd test of @xcite .",
    "the initial sinusoidal velocity field in the x - direction has the peak value @xmath2 , the initial density and pressure has been set to be uniform with @xmath3 and @xmath4 .",
    "then caustics will be formed because of the compression by the velocity field .",
    "an initial uniform magnetic field of @xmath5 in code units in the y direction was added to the simulation .",
    "figure [ fig : caustic ] compares the density and @xmath6 at @xmath7 of unigrid and amr runs .",
    "amr run had 256 cells in the root grid and 2 level refinements by 2 .",
    "the amr solution is indistinguishable from a uniform grid solution with 1024 cells .",
    "pancake is another standard test problem of cosmological hydrodynamics simulation @xcite .",
    "we have run the collapse of a one - dimension pancake in a purely baryonic universe with @xmath8 and @xmath9 .",
    "initially , at @xmath10 , which corresponds to @xmath11 in this test , a sinusoidal velocity field with the peak value @xmath12 in the normalized unit has been imposed in a box with the comoving size @xmath13 , so that the shock forms at @xmath14 .",
    "the initial baryonic density and pressure have been set to be uniform with @xmath3 and @xmath15 in the normalized code units .",
    "we applied initial uniform magnetic fields @xmath16 in the simulation .",
    "we did the calculations with unigrid with 1024 cells and amr run with 256 cells of root grid and 2 level refinements .",
    "figure [ fig : pancake ] shows the density and @xmath6 at @xmath17 .",
    ".,title=\"fig : \" ] .,title=\"fig : \" ]    , title=\"fig : \" ] , title=\"fig : \" ]      cluster formation is one of the problems most widely studied by enzo @xcite .",
    "we have done this problem and compared with results from enzo - ppm to test our new code in large scale structure formation .",
    "the simulation is a @xmath18cdm model with parameters @xmath19 , @xmath20 , @xmath21 , @xmath22 , @xmath23 .",
    "the survey volume is 256 @xmath24 mpc on a side .",
    "the simulations were computed from a @xmath25 root grid and 2 level nested static grids in the lagrangian region where the cluster forms which gives an effective root grid resolution of @xmath26 cells ( 0.5 @xmath24 mpc ) and dark matter particles of mass @xmath27 .",
    "amr is allowed only in the region where the galaxy cluster forms , with a total of 8 levels of refinement beyond the root grid , for a maximum spatial resolution of 7.8125 @xmath24kpc .",
    "we first present the results of no initial magnetic fields and compare them with the results from enzo - ppm .",
    "the cluster parameters from the mhd code is almost identical to those from enzo - ppm .",
    "the virial radii are 2.229mpc from hydro and 2.226mpc from mhd while the virial masses are @xmath28 for hydro and @xmath29 for mhd .",
    "figure [ fig : cluster2 ] compare the projections of the baryon density and temperature .     of adiabatic simulations .",
    "the images cover the inner 4 @xmath24mpc of cluster centers .",
    "the left panels show results from the ppm solver and the right panels show results from the mhd solver .",
    "the units of density and temperature are @xmath30 and kelvin respectively . ]",
    "we have performed simulation with initial magnetic fields , @xmath31 , @xmath32 with radiative cooling , star formation and star formation feedback .",
    "figure [ fig : cluster4 ] shows the images of baryon density , temperature , magnetic energy density and faraday rotation measurement of the cluster center .",
    "the rotation measurement is integral along the projection direction .    ) , temperature ( logarithmic , kelvin ) , magnetic energy density ( logarithmic , @xmath33 ) and rotation measurement ( @xmath34 ) of the inner 1@xmath24mpc of cluster center .",
    "the initial magnetic field is @xmath32 at @xmath17 . ]",
    "another simulation we performed is without initial magnetic field but with the biermann battery effect .",
    "the induction equation is modified by adding an additional battery term@xcite :    @xmath35    where c is speed of light , @xmath36 is the pressure of electron , @xmath37 is the electron number density , e is the electron charge , @xmath38 is the hydrogen mass and @xmath39 is the ionization fraction .",
    "we took @xmath40 constant in space in our simulation .",
    "we performed this computation with radiative cooling .",
    "figure [ fig : cluster5 ] shows the projection of logarithmic baryon density and the magnetic energy density of the cluster center .    ) and magnetic energy density ( logarithmic , @xmath33 ) of the simulation with biermann battery effect of the inner 1@xmath24mpc of cluster center . ]",
    "we have introduced our mhd module for enzo and presented some test results . with this new module , we have the ability to perform amr mhd cosmology simulations .",
    "this module uses high accuracy tvd mhd solver and employs ct and amr divergence - free magnetic fields reconstruction scheme to guarantee divergence - free of magnetic fields .",
    "mhd simulations using this mhd module can use all the exist physics packages in enzo .",
    "it is widely believed that the magnetic fields should have little effects in the formation of the first stars , since maybe there were no magnetic fields at all .",
    "but even there are no magnetic fields from the early universe , the biermann battery effect should have generated some very small fields during the collapse to form those stars .",
    "if the first generation stars spin very fast , these small seed fields could be maintained and amplified by dynamo effect .",
    "then the magnetic fields in the first stars may pollute the environment by their explosion and play a part in the formation of next generation stars .",
    "this would be investigated in the near future ."
  ],
  "abstract_text": [
    "<S> magnetic fields play an important role in almost all astrophysical phenomena including star formation . </S>",
    "<S> but due to the difficulty in analytic modeling and observation , magnetic fields are still poorly studied and numerical simulation has become a major tool . </S>",
    "<S> we have implemented a cosmological magnetohydrodynamics package for enzo which is an amr hydrodynamics code designed to simulate structure formation . </S>",
    "<S> we use the tvd solver developed by s. li as the base solver . </S>",
    "<S> in addition , we employ the constrained transport ( ct ) algorithm as described by d. balsara . for interpolation magnetic fields to fine grids we used a divergence free quadratic reconstruction , also described by balsara . </S>",
    "<S> we present results from several test problems including mhd caustics , mhd pancake and galaxy cluster formation with magnetic fields . </S>",
    "<S> we also discuss possible applications of our amr mhd code to first star research .     </S>",
    "<S> address = department of physics and cass , university of california , san diego , san diego , ca , altaddress = theoretical astrophysics , los alamos national laboratory , los alamos , nm     address = department of physics and cass , university of california , san diego , san diego , ca     address = department of physics and cass , university of california , san diego , san diego , ca     address = mathematical modeling and analysis , los alamos national laboratory , los alamos , nm     address = theoretical astrophysics , los alamos national laboratory , los alamos , nm </S>"
  ]
}