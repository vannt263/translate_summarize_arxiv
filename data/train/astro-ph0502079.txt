{
  "article_text": [
    "most of our knowledge of the universe at far infrared wavelengths has been obtained with photoconductive detectors , particularly as used in the infrared astronomy satellite ( iras ) and the infrared space observatory ( iso ) .",
    "these detectors have been selected because they provide excellent performance at relatively elevated operating temperatures ( compared with those needed to suppress thermal noise in bolometers ) .",
    "similar considerations led to development of high performance photoconductor arrays for the multiband imaging photometer for spitzer ( mips ) , namely a ge : ga array and a stressed ge : ga array operating at 70 and 160  respectively which were built at the university of arizona .",
    "to provide complementary measurements at 24  , the instrument also includes a si : as blocked impurity band ( bib ) array , built at boeing north america ( bna ) under contract to the infrared spectrograph ( irs ) team .    in the bib or impurity band conduction ( ibc ) architecture ,",
    "the high impedance required to minimize johnson noise is provided by a thin , high - purity layer of silicon .",
    "the infrared absorption occurs in a second layer , which can be relatively strongly doped . due to the separation of these two functions",
    ", the detector layers can be optimized separately .",
    "thus , these devices can be designed and built to have fast response , high resistance to cosmic ray irradiation induced responsivity shifts , high quantum efficiency , and good photometric behavior .",
    "because the processing necessary for high performance silicon ibc devices has only relatively recently become possible there is relatively little experience with them in space astronomy missions .",
    "an early - generation detector array was used in the short wavelength spectrometer ( sws ) in iso @xcite .",
    "initially , the device showed degradation due to damage by large ionizing particle exposures when the satellite passed through the trapped radiation belts .",
    "once the operating conditions were adjusted to minimize these effects , the sws detectors showed the expected virtues of this type of device even though they did not achieve their preflight sensitivity expectations @xcite .    at wavelengths",
    "longer than 40  , photoconductors are typically built in germanium because of the availability of impurity levels in this material that are much more shallow than those in silicon . achieving the appropriate structure and",
    "simultaneously the stringent impurity control for germanium ibc devices has proven difficult . as a result",
    ", all far infrared space astronomy missions have used simple bulk photoconductors .",
    "mips uses bulk gallium doped germanium ( ge : ga ) detectors , both unstressed and stressed .",
    "in such detectors , the same volume of material determines both the electrical and photo - absorptive properties , making the optimization less flexible than with si ibc detectors .",
    "consequently , their behavior retains some undesirable properties that can be circumvented through the more complex architecture of ibc devices . nonetheless , generally satisfactory performance is possible and has been achieved in past space astronomy missions .",
    "the 60 and 100  bands in iras @xcite utilized 15 ge : ga photoconductors each . the detectors were read out with transimpedance amplifiers that used junction field effect transistor ( jfet ) first stages mounted in a way that isolated them thermally .",
    "this allowed these transistors to be heated , resulting in low noise and stable operation @xcite .",
    "detector calibration was maintained by flashing reverse bolometer stimulators mounted in the center of the telescope secondary mirror , and cosmic ray effects were erased by boosting the detector bias to breakdown @xcite .",
    "the intrinsic performance of the detectors was limited by the johnson noise of the transimpedance amplifier ( tia ) feedback resistors and by other noise sources associated with the readout .",
    "the in - flight performance was similar to expectations from pre - flight calibrations .",
    "the isophot instrument @xcite carried a @xmath0 array of unstressed ge : ga detectors operating from 50 to 105  and a @xmath1 array of stressed devices operating from 120 to 200  .",
    "the readout was by a capacitive transimpedance metal oxide semiconductor field - effect transistor ( mosfet ) amplifier whose processing had been adjusted to improve its performance at low temperatures @xcite .",
    "calibration was assisted with a stimulator built into the instrument , which could be viewed by adjusting the position of a scan mirror . in practice ,",
    "the unstressed focal plane never achieved the performance level anticipated from laboratory measurements of its noise equivalent power ( nep ) .",
    "the performance of the stressed devices was substantially better , due in part to the relatively large fast response component of these devices ( compared with the slow component ) and their better thermal isolation from the readout amplifiers .",
    "the long wavelength spectrometer ( lws ) instrument on iso @xcite used a single ge : be detector , five ge : ga detectors , and four stressed ge : ga detectors .",
    "the readouts were based on jfets , mounted with thermal isolation and heated to a temperature where they operated with good stability and low noise .",
    "the readout circuit was an integrating source follower and neps of @xmath2 were measured in the laboratory @xcite .",
    "calibration was assisted with built in stimulators that were flashed between spectral scans .",
    "on orbit , it was found that frequent small glitches , probably associated with cosmic ray hits , limited the maximum integration times to shorter values than had been anticipated and also required a lower operating voltage @xcite . with these mitigations ,",
    "the neps were found to be @xmath34 higher in orbit than expected from ground test data @xcite .    in mips ,",
    "the ge : ga detectors are carefully isolated thermally from their readouts and operated at sufficiently cold temperatures that their dark currents are low and stable .",
    "the mosfet - based readouts use a specialized foundry process that provides them with good dc stability even at the low operating temperature of @xmath31.5k .",
    "this feature , combined with the capacitive tia ( ctia ) circuit , maintains the detector bias accurately . a scan mirror ( based on a design provided by t.  de graauw ) modulates the signals on a pixel so measurements can be obtained from the relatively well - behaved @xcite fast component of the detector response .",
    "responsivity variations are tracked with the aid of frequent stimulator flashes . finally , the instrument operations force observers to combine many short observations of a source into a single measurement .",
    "the high level of redundancy in the data helps identify outlier signals and also improves the calibration by simple averaging over variations .",
    "the efficacy of this operational approach is confirmed by the on - orbit results .",
    "details on the design and construction of mips can be found in @xcite .",
    "the inflight performance of mips is described by @xcite .",
    "this paper describes the approaches for reduction and calibration of the mips data .",
    "section  [ sec_challenge ] details the challenges of using si and ge detectors in a space astronomy mission .",
    "section  [ sec_design ] gives a summary of the design and operational features of mips that address these challenges .",
    "section  [ sec_overview ] gives an overview of the three stages of mips data reduction .",
    "these stages are discussed in more detail in the following three sections .",
    "section  [ sec_ramps_to_slopes ] details the processing steps to turn the integration ramps into measured slopes .",
    "section  [ sec_slope_cal ] discusses the corrections to transform the slopes into calibrated fluxes . section  [ sec_redund ] gives a brief overview of the use of the inherent redundancy in the observations to further improve the reduction .",
    "section  [ sec_inflight ] gives the results of initial testing of these reduction techniques with flight data .",
    "finally , section  [ sec_summary ] provides a summary .",
    "at high backgrounds , such as might be encountered in an airborne instrument , far infrared photoconductors behave relatively well , with rapid adjustment of the detector resistance appropriate to a change in illumination level . as the background is decreased , the adjustment to equilibrium levels occurs in a multistep process with multiple associated time constants as discussed below .",
    "thus , the detectors can be used in a straightforward manner at high backgrounds but precautions must be taken at low ones to track the calibration . for a more detailed discussion",
    "see @xcite .    the fast response component in these detectors results from the current conducted within the detector volume associated with the drift of charge carriers freed by absorption of photons .",
    "the speed of this component is controlled by the propagation of a zone boundary with drift velocity @xmath4 , so that the time constant is given by the free carrier lifetime divided by the photoconductive gain .",
    "this time is very fast ( microseconds or shorter ) in comparison to normal detection standards .",
    "however , as charge moves within the detector , the electrical equilibrium must be maintained .",
    "for example , charge carriers generated by photoionization are removed from the detector when they drift to a contact .",
    "they are replaced by injection of new charge carriers from the opposite contact , but the necessity for new charge can only be conveyed across the detector at a characteristic time proportional to the `` dielectric relaxation time '' , basically its capacitive or @xmath5 time constant : @xmath6 here , @xmath7 is the dielectric constant of the material and @xmath8 is the mobility for the charge carrier of interest , @xmath9 is the permittivity of free space , @xmath10 is the density of free carriers , and @xmath11 is the charge of the electron .",
    "the slow response components arise from this phenomenon .",
    "the form of this time constant makes explicit the dependence on illumination level through the density of free charge carriers , @xmath12 . in fully illuminated detectors ( for example , the integrating cavities used for the 160  array ) and at the low backgrounds appropriate for space - borne operation , @xmath13 can be tens of seconds . in transverse contact detectors , such as those used for the mips 70  array ,",
    "the part of the detector volume near the injecting contact may be poorly illuminated and have large resistance .",
    "the detector therefore adjusts to a new equilibrium only at the large dielectric time constant of this layer , which can be hundreds of seconds at low backgrounds .",
    "the initial shift of charge in the detector can set up a space charge that reduces the field in the bulk of the device , leading to a reduction of responsivity following the initial fast response . from its appearance on a plot of response versus time ,",
    "this behavior is described as `` hook '' response .",
    "as the field is restored at a characteristic rate of @xmath13 , the response grows slowly to a new equilibrium value .",
    "see @xcite for detailed modeling of these effects .    in space applications ,",
    "ionizing particles such as cosmic rays also affect the calibration of these detectors .",
    "the electrons freed by a cosmic ray hit can be captured by ionized minority impurities , reducing the effective compensation and increasing the responsivity .",
    "the shifts in detector characteristics can be removed by warming it to a temperature that re - establishes thermal equilibrium , and then cooling it back to proper operating conditions . between such anneal cycles , the responsivity needs to be tracked to yield calibrated data .",
    "all successful uses of far infrared photoconductors at low backgrounds have included local relative calibrators of reverse bolometer design that allow an accurately repeatable amount of light to be put on the detector .",
    "these stimulators allow frequent measurement of the relative detector responsivity .",
    "in general , this strategy is most successful when the conditions of measurement are changed the least to carry out the relative calibration .",
    "the mips instrument includes such calibrators , which are flashed approximately every two minutes . based upon data obtained at a proton accelerator and in space ,",
    "the average increase in response over a two minute period in the space environment can be 0.5% to 1% , so the calibration interval allows tracking the response accurately .",
    "although the detectors in the silicon array are expected to perform well photometrically , the array as a system shows a number of effects that must be removed to obtain calibrated data .",
    "the array is operated well below the freezeout temperature for the dopants in the silicon readout ( the readout circuit uses a different foundry process from that developed for the ge detectors ) .",
    "therefore , the array must be operated in a continuous read mode to avoid setting up drifts in the outputs that would degrade the read noise .",
    "the flight electronics and software are designed to maintain a steady read rate of once per half mips second ( see  [ sec_data_collection ] ) . when the array is first turned on",
    ", the transient effects of the readout cause a slow drift in the outputs .",
    "much of this effect can be removed by annealing the array , which is the standard procedure for starting the mips 24  operations .",
    "the array shows an effect termed `` droop . ''",
    "the output of the device is proportional to the signal it has collected , plus a second term that is proportional to the average signal over the entire array .",
    "in addition , the 24  array has a number of smaller effects ( e.g. , rowdroop , electronic nonlinearities , etc . ) which are described later in this paper .",
    "the design and operation of mips is summarized here , paying special attention to those areas which answer the challenges outlined above and , therefore , produce data that can be reduced successfully .",
    "mips has three instrument sections , one for 24  imaging , one for 70  imaging and low resolution spectroscopy , and one for 160  imaging .",
    "light is directed into the three sections off a single axis scan mirror .",
    "the 24  section uses a @xmath14 pixel si : as ibc array and operates in a fixed broad spectral band extending from 21 to about 27  ( the long wavelength cutoff is determined by the photo - absorptive cutoff of the detector array ) . after",
    "light enters this arm of the instrument from a pickoff mirror , it is brought to a pupil on a facet of the scan mirror .",
    "it is reflected off this mirror into imaging optics that relay the telescope focal plane to the detector array at a scale of @xmath15 per pixel corresponding to a @xmath16 sampling of the point spread function , where @xmath17 is the telescope aperture .",
    "the surface area of a 24  pixel is @xmath18 @xmath19 .",
    "the field of view provided by this array is @xmath20 .",
    "a reverse bolometer stimulator in this optical train allows relative calibration signals to be projected onto the array .",
    "the scan mirror allows images to be dithered on the array without the overheads associated with moving and stabilizing the spacecraft .",
    "it also enables an efficient mode of mapping ( scan mapping ) in which the spacecraft is scanned slowly across the sky and the scan mirror is driven in a sawtooth waveform that counters the spacecraft motion , freezing the images on the detector array during integrations .",
    "the 70  section uses a @xmath21 pixel ge : ga array sensitive from 53 to 107  .",
    "a cable failure external to the instrument has disabled half of the array and the following description reflects this situation .",
    "the light from the telescope is reflected into the instrument off a second pickoff mirror .",
    "it is brought to a pupil at a second facet of the scan mirror and from there passes through optics that bring it to the detector array .",
    "for this arm of the instrument , there are actually three optical trains that can relay the light to the array ; the scan mirror is used to select the path to be used for an observation .",
    "one train provides imaging over a field @xmath22 , with a pixel scale of @xmath23 corresponding to a @xmath24 sampling of the point spread function .",
    "the physical size of a 70  pixel is @xmath25 mm@xmath26 and 2  mm long in the direction of the optical axis .",
    "this train provides imaging over a fixed photometric band from 55 to 86  .",
    "the scan mirror feeds this mode when it is in position to feed the other two arrays , so imaging can be done on all three arrays simultaneously .",
    "a second train also provides imaging in the same band , but with the focal plane magnified by a factor of two to @xmath27 per pixel .",
    "this mode is provided for imaging compact sources where the maximum possible angular resolution is desired : the pixel scale corresponds to @xmath28 at the center wavelength of the filter band .",
    "the third train brings the light into a spectrometer , with spectral resolution of @xmath29 from @xmath30  . in this spectral energy distribution ( sed ) instrument mode",
    ", light is directed to a reflective `` slit '' and then to a concave reflective diffraction grating that disperses the light and images the spectrum onto a portion of the 70  array .",
    "the slit is 16  pixels long and 2  pixels wide , corresponding to @xmath31 on the sky .",
    "the dispersion is 1.73  pixel@xmath32 .",
    "reverse bolometer stimulators are provided for calibration , and the scan mirror provides the dithered and scan mapping modes of operation at 70  as have been described for the 24  array .",
    "the 160  section shares the pickoff mirror and scan mirror facet with the 24  band .",
    "after the light has been reflected off the scan mirror , the telescope focal plane is reimaged and divided , with part going to the si : as array and part going to a stressed ge : ga array , operating in a fixed filter band from 140 to 180  .",
    "this array has @xmath33 pixels , arranged to provide an imaging field @xmath20 long in the direction orthogonal to the scan mirror motion with the two rows of detectors spaced such that there is a gap one pixel wide between the two rows .",
    "this pixel size provides @xmath16 sampling of the point spread function .",
    "the physical size of a 160  pixel is @xmath34 mm@xmath35 .",
    "reverse bolometer stimulators are included in the optical train , and the scan mirror provides modes similar to those with the other two arrays .",
    "a key aspect of the calibration of the mips ge arrays is the frequent use of stimulators @xcite to track responsivity variations .",
    "the emitters in these devices are sapphire plates blackened with a thin deposition of bismuth , which also acts as an electrical resistor .",
    "the emitters are suspended in a metal ring by nylon supports and their electrical leads .",
    "when a controlled current is run through the device , the sapphire plate is rapidly heated by ohmic losses in the metallized layer . the thermal emission is used to track changes in detector response in a relative manner ; hence these devices are described as stimulators rather than calibrators . because of the large responsivity of the detector arrays , it is necessary to operate these stimulators highly inefficiently to ensure accurate control without blinding the detectors .",
    "they are mounted inside cavities that are intentionally designed to be inefficient ( e.g. , black walls , small exit holes ) .",
    "this allows the stimulators to be run at high enough voltage to be stable and emit at a reasonable effective temperature .",
    "the constant - amplitude stimulator flashes provide a means of tracking the responsivity drift inherent in the ge detectors .",
    "figure  [ fig_stim_repeat ] illustrates the importance of tracking the responsivity variations of ge detectors with as fine a time resolution as feasible .",
    "the repeatability of the stimulator measurements is a function of both the background seen by the detector element as well as the amplitude of the stimulator ( stim ) signal above the background .",
    "the repeatability of a measurement of the stim signal improves with decreasing background and increasing stim amplitude . for both the 70 and 160  arrays , in ground testing stim amplitudes of greater than @xmath37500  dn / s above the background yielded a repeatability of better than @xmath31%  on most backgrounds . setting the stim amplitudes at this level provides a balance between repeatability of the stims and the range of backgrounds accessible to observation without saturation . at this level",
    ", well over 95%  of the sky should be observable without saturating stim flash measurements at both 70 and 160  .",
    "additional complications at 160  include a strong illumination gradient in the stim flash illumination pattern from one end of the array to the other as well as a large increase in the responsivity of the array with exposure to cosmic rays .",
    "it is not possible to set the stim amplitude at the optimum 7500  dn / s across the whole array due to a factor of four gradient in the stim amplitude across the array .",
    "the on - orbit stim amplitude was set to provide an optimal amplitude over the majority of the 160  pixels .",
    "the degradation in stim repeatability on the low illumination region can be mitigated by an observing strategy that dithers the image such that the same region of the sky spends equal amounts of time on both regions of the detector .",
    "both of the ge arrays show calibration shifts with even small exposure to ionizing radiation .",
    "the effects of ionizing particles were tested using characterization arrays ( see  [ sec_lab_test ] ) at the university of california , davis accelerator .",
    "the proton beam was attenuated to reduce the particle impact rate to a level similar to that expected on orbit .",
    "the energy of the particles was such that each impact was strongly ionizing , depositing much more energy in the detector volume than is expected from a typical cosmic ray .",
    "thus , these tests served as a worst - case model of the detector response to cosmic - rays on orbit .",
    "the detector responsivity slowly increased with time under exposure to the proton beam .",
    "the rate of responsivity increase on the 70  array was comparable to that observed under typical illumination conditions ( cf .",
    "[ fig_stim_repeat ] ) without the proton beam , suggesting that accumulated transient response from the background and signals inside the cold test chamber and the photon flux at the accelerator contribute similarly to the responsivity increase .",
    "if the particle impacts at the accelerator really represent a worst - case scenario , this suggests that the on - orbit responsivity increase of the 70  array may be dominated by photon flux rather than cosmic ray effects .",
    "in contrast , the 160  array showed a large responsivity increase with increasing radiation dose .",
    "if they are of modest size , such responsivity shifts can be determined and removed during calibration through use of the stimulator observations . however ,",
    "when the shifts are large , they are also highly unstable and can result in substantial excess noise .",
    "three methods were tested to remove such effects : re - thermalization of the detectors by heating them ( anneals ) , exposing the detectors to a bright photon source , and boosting the detector bias above breakdown .",
    "our experiments indicated that the latter two methods produced little benefit .",
    "although the instrument design permits use of all three techniques , we remove radiation damage to the ge arrays by periodically thermally annealing the detectors .",
    "there are four mips observing modes , all of which have been designed to provide a high level of redundancy to ensure good quality data ( especially for the ge arrays ) .",
    "the photometry mode is for point and small sources . as an example of the redundancy inherit in mips observations , a visualization of a single photometry mode cycle is shown in fig .",
    "[ fig_phot70 ] for 70  .",
    "the scan map mode provides efficient , simultaneous mapping at 24 , 70 , and 160  by using a ramp motion for the scan mirror to compensate for continuous telescope motion , effectively freezing images of the sky on the arrays .",
    "a visualization of a small portion of a scan leg is shown in fig .",
    "[ fig_scanmode ] .",
    "the sed mode provides 53 to 107  spectra with a resolution r @xmath36 .",
    "the total power mode ( tpm ) is for making absolute measurements of extended emissions .",
    "the pacing of the mips data collection is based on a `` mips second . ''",
    "a mips second is approximately 1.049 seconds , and has been selected to synchronize the data collection with potential sources of periodic noise , such as the computer clock or the oscillators in the power supplies .",
    "to first order , this design prevents the down - conversion of pickup from these potential noise sources into the astronomical signals .",
    "the data are taken in data collection events ( dces ) ; at the end of a dce , the array is reset before taking more data .",
    "dces are currently limited to 3 , 4 , 10 , or 30 mips seconds for the 24  array and 3 , 10 , or 10 mips seconds for the 70 and 160  arrays .    during a dce ,",
    "each pixel generates a voltage ramp on the array output , as the charge from incoming photons is accumulated on the input node of its integrating amplifier .",
    "these ramps are the basic data collected by all three arrays .",
    "the 24  array is non - destructively read out every 1/2 mips second while the 70 and 160  arrays are non - destructively read out every 1/8 mips second .",
    "all the samples are downlinked for the 70 and 160  arrays , but this is not possible for the 24  array due to bandwidth restrictions .",
    "the 24  array has two data modes , sur and raw .",
    "most 24  data are taken in sur mode in which the ramps are fitted to a line , and only the fitted slope and first difference ( the difference between the first two reads in the ramp ) are downlinked .",
    "the raw mode downlinks the full 24  ramps , but this mode is used only for engineering observations .",
    "there are three natural steps in reducing data from integrating amplifiers : ( 1 ) converting the integration ramps to slopes ; ( 2 ) further time - domain processing of the slope images ; and ( 3 ) processing of dithered images in the spatial domain . for detectors",
    "that do not have time - dependent responsivities , only the first and last steps are usually important .",
    "this is strongly not the case for the mips ge arrays and also mildly not so for the mips si array .",
    "as a result , mips processing includes all three steps .",
    "first , the integration ramps are converted into slopes ( dn / s ) while removing instrumental signatures with time constants on the order of the dce exposure times (  [ sec_ramps_to_slopes ] ) .",
    "second , the slopes are calibrated and instrumental signatures with time constants longer than the dce exposure times are removed (  [ sec_slope_cal ] ) .",
    "third , the redundancy inherent in the mips observing modes allows a second pass at removing instrumental signatures (  [ sec_redund ] ) .",
    "the algorithms used in the first two steps have mostly been determined .",
    "the main algorithms used by the third step are being optimized with actual data taken on orbit .",
    "portions of the reduction algorithms described in this paper were presented in a preliminary form by @xcite .",
    "we made extensive use of laboratory testing and theoretical investigations in choosing and ordering the relevant steps .",
    "figure  [ fig_flowchart ] is a graphical representation of the specific tasks in each of the three processing steps .",
    "three versions of the 70 and 160  arrays were constructed : a flight array , a flight spare array , and a characterization array . before integration into the instrument ,",
    "the basic performance of the flight and flight spare arrays was measured ( i.e. , read noise , dark current , nep , etc . ) .",
    "the characterization arrays were then installed in the two specialized dewars previously used for the flight and flight spare array testing .",
    "these arrays are used to determine the detailed behaviors of the 70 and 160  detectors .",
    "this knowledge was then used to design observations with the flight arrays to remove specific ge detector effects .",
    "the ability to do extensive testing on the characterization arrays has been crucial to the development of the data reduction algorithms for the ge arrays detailed in this paper .",
    "in addition to testing at the array level , testing at the instrument level was carried out using the low background test chamber ( lbtc ) .",
    "the lbtc was constructed to allow for testing of the full mips instrument and , thus , had a number of independently controlled stimulators including pinhole stimulators providing point sources for testing .",
    "the lbtc allowed for the imaging performance of the full instrument to be tested as well as providing for extensive testing of the 24  array .",
    "additional details of the laboratory testing can be found in @xcite .",
    "we also carried out detailed numerical modeling of the behavior of the ge arrays .",
    "this modeling allowed effects found in the laboratory testing to be investigated in more detail .",
    "for example , the modeling was able to show that the difference in hook behaviors between the 70 and 160  arrays was due to their different illuminations @xcite .",
    "the numerical modeling was also crucial to the understanding of the behavior of small signals on the detectors .",
    "for example , this modeling was able to determine that the stim flash latents ( see  [ sec_sflash_latent ] ) were additive , not multiplicative .",
    "this understanding then guided the efforts to remove this signal .",
    "the first part of the processing fits the ramps to produce slopes for each dce .",
    "the processing for the ge ( 70 and 160  ) and si ( 24  ) raw mode data is similar , differing only in the instrumental signatures removed .",
    "first , reads which should be rejected from the linear fits are identified .",
    "reads are rejected if they represent missing data , autoreject reads , or saturated data .",
    "second , the ramps are corrected for instrumental effects . these are dark current ( si only ) , rowdroop ( si only ) , droop ( si only ) , electronic nonlinearities , and stim flash latents ( ge only ) .",
    "third , jumps in the ramps usually caused by cosmic rays are identified . in the process , reads that are abnormally noisy are identified as noise spikes . finally , all the continuous segments in each ramp are fit with lines and the resulting slopes averaged to produce the final slope for each pixel .",
    "an example of a 24  ramp is given in fig .",
    "[ fig_24ramp ] .",
    "the 70 and 160  ramps are very similar to the 24  ramp , except they do not have droop .",
    "the graphical representation of the data processing shown in fig .  [ fig_flowchart ] gives the ordering of the reduction steps .",
    "the processing for the si sur mode data is necessarily different as the ramps are fit on - board and only the slope and first difference images are downlinked .",
    "the following subsections will describe the si and ge raw mode processing followed by a description of the necessary differences for the si sur mode processing .",
    "there are two reasons to automatically reject ( autoreject ) reads ; to avoid reset signatures and to not use the ramps beyond 2 mips seconds for stim flash dces .",
    "all mips arrays are reset at the beginning of a ramp , and this has been seen to leave a signature in the first few reads .",
    "in general , this reset signature only affects the first read .",
    "the first read is automatically rejected for all three arrays .",
    "this is even true for sur data for which the line fit is done on - board spitzer .",
    "the 70 and 160  arrays can be operated with a reset in the middle of the dce to improve performance .",
    "when this mode is used , the reset signature has been seen to last for 4 reads and these 4 reads are then automatically rejected . in a stim flash dce",
    "only the first 2 mips seconds of a ramp are valid .",
    "after 2 mips seconds , the stim is turned off and after 2.5 mips seconds , a reset is applied .",
    "finally , all reads that are below or above the allowed limits for the mips analog - to - digital converters ( adc ) ( soft saturation ) or saturating the 70 and 160  readout circuits ( hard saturation ) are flagged as low or high saturation , respectively .",
    "all three mips arrays display nonlinearities that have been traced to the electronics . for the 24  array",
    "these nonlinearities are mainly due to a gradual debiasing which occurs as charge accumulates in each pixel during an exposure . for the 70 and 160  arrays ,",
    "the readout circuits have been constructed to keep the same bias voltage across the detectors even as charge accumulates . nevertheless , electronic nonlinearities arise due to the simplified ctia circuit .",
    "the behavior of the electronic nonlinearities was determined from extensive ground - based testing on the flight arrays .",
    "for the 24  array , the functional form was characterized from raw mode data ramps ; a typical case is shown in figure  [ fig_24ramp ] .",
    "the ramps for most of the pixels can be nearly perfectly described by quadratic polynomial fits ; the linear component of the fit gives directly the linearized signal .",
    "for the 70 and 160  arrays , the electronic nonlinearities have been shown generally to have a quadratic shape with significant deviations .",
    "corrections were tabulated as a lookup table to allow for the semi - arbitrary forms . for the 24 , 70 , and 160  arrays ,",
    "the maximum nonlinearity at full well ( adc saturation ) ranges over the array from @xmath37 , @xmath38 , and @xmath39 , respectively .",
    "the main reason discontinuities or jumps appear in mips ramps is cosmic rays .",
    "cosmic rays strike the ge detectors ( 70 and 160  arrays ) at a rate of one per pixel per twelve seconds .",
    "the rate on the si detector ( 24  array ) is much lower , due to its smaller pixels .",
    "it is also possible to get a ramp jump due to an anomaly we have termed a readout jump .",
    "ground - based testing has shown that the entire output of one of the 32 readouts ( 4 @xmath40 8 pixels ) on the 70  array occasionally jumps up and then jumps back down by the same dn amount approximately 1 second later .",
    "jumps in the ramps are detected using a combination of two methods .",
    "first , @xmath41",
    "2-point differences are constructed from the @xmath42 reads and outliers are flagged as potential ramp jumps using an iterative sigma clipping algorithm .",
    "these potential jumps are tested to see if they are noise spikes or actual ramp jumps by fitting lines to the segments on either side of the potential jump .",
    "if the two fitted lines imply a jump that is smaller than the expected noise , then the jump is actually a noise spike , not a cosmic ray or readout jump .",
    "second , a more sensitive test for ramp jumps is performed @xcite .",
    "this method works by assuming each read in a ramp segment has a ramp jump after it and fitting lines to the resulting two subsegments on either side .",
    "the most significant ramp jump in the segment implied from the two line fits is then tested to see if it is larger than the noise .",
    "if so , then this read is labeled as a ramp jump .",
    "the process can be repeated on the subsequent ramp segments until no more jumps are found or a preset number of iterations have been performed . as this second method is more sensitive than the first , but significantly more computationally intensive , we combine the two methods to achieve the best sensitivity to ramp jumps with the least computation time .",
    "we explored the signatures of cosmic rays in ramps using several hours worth of 70 and 160  array data that were subject to constant illumination .",
    "we then extracted those ramps where we detected ramp jumps ( assumed to be due to energetic particle impacts ) and assessed the effects on the ramp after the impact . on the 70  array we find two main effects : a steepening of the ramp that lasts for a few reads and a persistent responsivity increase of @xmath43 after a big hit ( see fig .",
    "[ figure : slope - change - after - radhit ] ) .",
    "this is consistent with the slow responsivity increase observed during the radiation run .",
    "these results dictate our strategy for dealing with cosmic ray hits on this array : several reads after a hit should be rejected from slope fitting to ensure that the fast transient does not bias the slope measurement , while the small responsivity increase after large hits will be tracked by the stim flash measurements .",
    "the 160  array response to cosmic rays is somewhat different .",
    "we detected no fast transient within the ramp , but the slope of the ramp after a hit was often different from the slope before the hit .",
    "this slope change typically did not persist into the next dce , after a reset had occurred , as shown in figure  [ figure : slope - change - after - radhit ] .",
    "thus , we were unable to detect a persistent responsivity increase due to particle impacts , in contrast to the accelerator data (  [ sec_anneals ] ) .",
    "given that we are unable to predict how the slope will change after a particle hit and that the slope returns to its previous value after the next reset ( usually the next dce ) , the conservative strategy for dealing with particle impacts on this array is to simply ignore all data between a particle hit and the next reset .",
    "slopes are determined for each ramp by fitting lines to all the good segments in a ramp .",
    "the slope for a ramp is then the weighted average of the slopes of the ramp segments .",
    "the weight of each segment is determined from the uncertainty in the segment slope as discussed in the next paragraph .",
    "each good segment of a ramp is identified as containing only good reads and not containing any ramp jumps .",
    "lines are fit to these segments with the standard linear regression algorithm .    calculating the uncertainties on the fitted slope and zero point",
    "is not as straightforward .",
    "the uncertainties on each read have both a correlated and random component .",
    "the correlated component is due to photon noise , as the reads are a running sum of the total number of photons detected .",
    "the random component is the read noise .",
    "we have derived equations for the linear fit uncertainties for the correlated component following the work of @xcite .",
    "the details of this derivation are given in appendix  [ app_fit_unc ] .",
    "the slope and zero point uncertainties are calculated for the correlated and random read uncertainties separately and then combined in quadrature to get the final uncertainties .        the calibration of the 70 and 160  arrays is directly tied to the stim flashes measured approximately every two minutes .",
    "the brightness of these stim flashes is set as high as possible to ensure the best calibration ( cf .  ",
    "[ sec_stims ] ) .",
    "these stim flashes produce a memory effect , called a stim flash latent , that is persistent for a brief time .",
    "intensive measurements of stim flash latents have been performed at the university of arizona on the 70 and 160  characterization arrays .",
    "we determined the time constants , amplitudes , variations with the background , and repeatability of the stim flash latents as well as the accuracy of the correction and the effects on the calibration of sources observed during the latent .    to characterize the decay behavior of the latents",
    ", we fit an exponential law to the time signal of each array pixel .",
    "each cycle is divided by the stim amplitude value , to have dimensionless data ( fraction signal / stim ) .",
    "the function @xmath44 used to fit the latent is a double exponential : @xmath45 where @xmath46 is the time after the stim is turned off , @xmath47 is the background level , @xmath48 and @xmath49 give the component amplitudes , and @xmath50 and @xmath51 give the time constants .    at 70  ,",
    "only a single exponential is needed ( thus @xmath52 ) .",
    "the amplitude @xmath48 is always less than 3% of the stim amplitude , and in most of the cases below 0.5% . the time constant @xmath50 ranges from 5s to 20s . as a function of increasing background , @xmath48 increases and @xmath50 decreases .",
    "the latents are repeatable to 15% or better .",
    "an example of the stim latent of one pixel on the 70  characterization array is given in fig .",
    "[ fig_slatent ] .    at 160  ,",
    "the latency effect is more pronounced than at 70  .",
    "the amplitude @xmath48 is less than 5% of the stim amplitude .",
    "the time constant @xmath50 ranges from 5 to 20s .",
    "the amplitude @xmath49 is less than 3% .",
    "the time constant @xmath51 equals 20s at high background , and is negligible at low background .",
    "the amplitude @xmath48 and time constant @xmath50 are almost insensitive to the background .",
    "the latents are repeatable to 20% or better .",
    "[ fig_slatent ] also gives an example of the stim latent of one pixel on the 160  characterization array .",
    "in general , the stim flash latents are negligible @xmath330 seconds after the stim is turned off .",
    "in the first 30 seconds , the calibration of a point source might be overestimated by 1% at 70  and 12% at 160  if no correction is applied . to correct for the stim latent contribution to the pixel signal",
    ", we apply a time - dependent correction at the ramp level .",
    "we subtract the latent contribution , which is obtained by integrating eq .",
    "[ eq : latent ] . on pre - flight data ,",
    "the amplitude of the latents after correction is reduced by a factor of @xmath32 at 70  and @xmath34 at 160  .",
    "the rowdroop effect manifests itself as an additive constant to each individual pixel and is proportional to the sum of the number of counts measured by all pixels on its row , where a row is in the cross - readout direction .",
    "this effect is not completely understood , and is similar to ( but separate from ) the droop phenomenon ( see  [ sec_droop ] ) .",
    "the additive signal imparted to each pixel on a row is constant and exhibits no gradient or dependence with pixel position , thus , it is not related to a charge ",
    "bleed , or `` mux  bleed '' effect .",
    "the rowdroop contributes a small amount to the flux of an individual pixel , and will only significantly affect pixels on rows with high - intensity sources .",
    "an example of rowdroop from ground - based testing is shown in fig .",
    "[ fig_rowdroop ] .",
    "using images of pinhole sources obtained in ground testing , we have computed the row droop constant of proportionality , @xmath53 .",
    "this is the factor that gives the fraction of the total counts in a row which is the result of row droop and should be subtracted from each pixel in that row .",
    "we find that the constant of proportionality for the mips 24  array is @xmath54 .",
    "thus , the rowdroop contributes @xmath55% of the total number of counts on a row .",
    "the rowdroop is corrected for on a read - by - read basis .",
    "droop is a constant signal added to each pixel by the readouts .",
    "the exact cause of droop is unclear .",
    "this extraneous signal , akin to a dc offset , is directly proportional to the total number of counts on the entire array at any given time .",
    "we have measured the constant of proportionality from ground test data .",
    "the droop coupling constant was measured to be @xmath56 , which agrees well with the 0.32 determined by bna .",
    "the droop correction algorithm first computes the mean signal on the array , which is then multiplied by the droop coupling constant to derive the droop signal , as given by @xmath57 where @xmath58 is the droop signal , @xmath59 is the signal on each pixel ( comprising both the actual incident flux and the droop ) , @xmath60 is the number of pixels , and @xmath61 is the droop coupling constant .",
    "the resultant droop signal is then subtracted from the original signal on each pixel .    under normal circumstances ,",
    "the uncertainty associated with this process is at the @xmath43 level , limited mainly by the uncertainty on the coupling constant .",
    "however , greater uncertainties arise when pixels are saturated ; since adc saturation occurs well before hard detector saturation , droop signal will still accumulate for an incident flux above the adc saturation level . in this case",
    ", the actual signal ramp must be extrapolated beyond the saturation point .",
    "the droop signal is determined by extrapolating a fit to the unsaturated portion of the ramp . as with the rowdroop correction ,",
    "the droop correction is done on a read - by - read basis for raw mode 24  data .",
    "dark subtraction is done at each read using a dark calibration image containing the full dark ramp for each pixel .",
    "this step serves both to remove the ( small ) dark current contribution and the offset ramp starting points , so that each ramp starts near zero .",
    "the majority of the 24  data are taken in the sur mode instead of the raw mode . in the sur mode",
    ", a line is fit to the data ramp on - board the spacecraft .",
    "the resulting slope and first difference ( difference between the first two reads of the data ramp ) images are downlinked instead of the full ramp .",
    "the first difference frame effectively increases the dynamic range of the sur mode as signals that saturate somewhere in the ramp , but after the second read , will have a valid measurement in the first difference frame . to reduce the data downlinked , any first difference value that is from a ramp which does not saturate is set to zero .",
    "this increases the compressibility of the first difference frame .",
    "there can be degeneracy of sur slope values due to the possibility of saturation .",
    "the possible slope value for a given pixel reaches a maximum at full well , the point of adc saturation .",
    "after that point , as the data ramp reaches saturation at the last few reads , the slope value will begin to decrease because the on - board sur algorithm does not reject saturated reads . in cases of extreme saturation , the slope becomes quite small , and can eventually become zero if saturation occurs within the first few reads .",
    "the first difference value is provided to break this degeneracy .",
    "we have employed a conservative threshold value for the first difference , above which a pixel is flagged as being likely saturated .",
    "adc saturation occurs at + 32768 dn ( see figure  [ fig_24ramp ] for an example of a saturated raw ramp ) . assuming a linear ramp , the first difference for a ramp that just saturates on the final read would be @xmath62 , where @xmath63 is the total number of reads in the data ramp .",
    "for example , there are 60 reads in a 30 second dce , yielding an ideal saturation threshold of @xmath64 dn / read . to be more conservative",
    ", we actually employ a threshold value of 1000 dn / read for a 30 second exposure time and scale this for other exposure times . since the data ramps are not linear , the actual first difference threshold is larger than our chosen default value , so most cases of saturation will be flagged .",
    "the only exception being saturation at the first read , in which case both the slope and the first difference would be zero . for all pixels that have been flagged for saturation , the first difference value should be used in place of the slope .      the rowdroop and droop subtraction is done in the same way for sur mode as for raw mode , except that the corrections are performed on the slope and first difference images .      because the sur data do not preserve the actual data ramps , the linearity correction made somewhat complicated .",
    "nevertheless , the quadratic behavior of the ramps can be used to analytically determine the linearization of the sur slope values .",
    "this correction depends on the observed sur slope value , exposure time , and known quadratic nonlinearity .",
    "note that saturation invalidates this method , as the sur slope - fitting algorithm does not reject saturated reads . in this case",
    ", no linearity correction is applied .",
    "the next step in the mips data reduction is to calibrate the slope images while removing instrumental effects with time constants longer than the dce exposure times .",
    "the instrumental effects corrected at this stage include latents ( 24  ) , responsivity drift ( 70 and 160  ) , pixel - to - pixel responsivity variations , the telescope illumination pattern , and flux nonlinearities ( 70 and 160  ) . the graphical representation of the data processing shown in fig .",
    "[ fig_flowchart ] gives the ordering of the reduction steps .",
    "since the time dependent responsivity of the ge arrays requires additional calibration steps than is usual for more common array detectors , we give the mathematical basis of our ge slope calibration in  [ sec_slope_math ] .      ignoring the 70 and 160  flux nonlinearities ,",
    "an uncalibrated slope image can be represented by @xmath65 r(i , j , t_n)\\ ] ] where @xmath66 is the science image of interest , @xmath67 represents the telescope and instrument optics ( the mean of @xmath67 is one ) , @xmath68 is the dark current , and @xmath69 is the instantaneous responsivity of the array ; @xmath70 represent the pixel coordinates and @xmath71 the time of the @xmath42th dce .",
    "calibration involves isolating @xmath66 , the flux from the sky@xmath72object in the above equation .",
    "the term @xmath73 is the equivalent of a traditional flat - field term . as @xmath74 is a rather sensitive function of time for the 70 and 160  detectors , however , a global `` flat - field ''",
    "can not be determined , but must be derived for each dce separately .",
    "the stimulators provide the means to monitor @xmath74 and all science observations will be bracketed by stim flashes .",
    "stim flash images will be equivalent to science frames with the addition of a stimulator illumination pattern : @xmath75 r(i , j , t_n)\\ ] ] where @xmath76 is the illumination pattern introduced on the array by the stim flash with the mean of @xmath76 equal to one .",
    "mips observations include the requirement that each stimulator flash will be preceded by a background exposure with the identical telescope pointing ; thus for the @xmath77 stimulator dce there exists a background dce taken at time @xmath78 , @xmath79 r(i , j , t_n - \\epsilon).\\ ] ] if we assume that the responsivity of the array @xmath69 does nt change dramatically between times @xmath80 and @xmath81 , i.e.  @xmath82 , we can construct for each stimulator flash a background subtracted stim flash : @xmath83 with background subtracted stim flashes determined from eq .",
    "[ eq : bksubstim ] for all stim flashes in the data set , an instantaneous stim can be determined for any time , @xmath71 , by interpolation from bracketing stim flashes : @xmath84\\ ] ] where @xmath85 $ ] is some interpolating function on background subtracted stims for times @xmath80 bracketing @xmath71 .",
    "analysis of ge characterization array data indicates that a weighted linear fit ( weighted by the uncertainty in the stim flash frames ) to two stim flashes on either side of the data frame ( a total of four stim flashes ) provides the optimal strategy for determining the instantaneous stim amplitude ( repeatability to @xmath31%  on most backgrounds ) . dividing science frames , eq .",
    "[ eq : sciframe ] , by the interpolated instantaneous stim , eq .",
    "[ eq : inst_stim ] , produces @xmath86/s(i , j).\\ ] ] while we have removed the time dependent responsivity variation , the data of interest , @xmath87 , are still modified by the optical response and the dark current ; in addition , we have introduced the stimulator illumination pattern into our data .",
    "fortunately , since the time dependence has been removed , we can remove these other instrumental signatures through carefully accumulated calibration data .",
    "first , the dark correction , @xmath68 , can be determined from a sequence of exposures as above , with the additional constraint that the scan mirror be positioned such that no light from the `` sky '' falls on the detector",
    ". thus the data and stim flashes in a dark current data sequence are represented by @xmath88 and @xmath89 r(i , j , t_n),\\ ] ] respectively .",
    "the dark data are corrected for responsivity variations exactly as described above and the individual frames combined to produce an average dark current , @xmath90 .",
    "subtracting this dark current from science frames that have been corrected for responsivity variations , eq .",
    "[ eq : rescor ] yields @xmath91 our responsivity , dark corrected science frame .",
    "what remains is to correct for the telescope optics , @xmath67 , and the stim illumination pattern , @xmath76 .",
    "correcting for the combined illumination pattern of the telescope and stim involves a standard series of mips exposures , i.e. data frames interspersed with stim flashes . as such , they may be represented by equations of the form eq .",
    "[ eq : sciframe ] , where the @xmath92 represent dithered images of `` blank '' sky fields . calibrating the sequence by correcting for responsivity variations and dark current as above results in a series of images @xmath93 since by construction , the @xmath92",
    "are dithered images of `` smooth '' regions , if a large number of @xmath92 are acquired , they may be median combined to remove point sources ( and extended sources if dithered `` sufficiently '' ) , cosmic rays , etc .",
    "resulting in @xmath94 where @xmath67 and @xmath76 are constant regardless of telescope pointing .",
    "hence the median only affects the changing sky image as the telescope is dithered .",
    "the constant @xmath95 in equation [ eq : illcor ] may be set to one resulting in the illumination correction frame @xmath96 the responsivity corrected , dark subtracted data ( equation [ eq : darkrescor ] ) are now divided by the illumination correction resulting in @xmath97 and we have recovered the quantity of interest , the astronomical sky @xmath66 .",
    "suitable observations of standard stars can then be used to convert instrumental counts to physical units ( e.g. janskies ) .",
    "the dark , flat field , and illumination correction calibration images described above will be obtained throughout the life of the mission .",
    "example preflight calibration images are shown in figs .",
    "[ fig_24cal]-[fig_160cal ] .",
    "simulations indicate that high s / n flat field and illumination correction images ( @xmath98 rms ) can be obtained with dithered observations of `` smooth '' areas of the sky : @xmath360100  dces at 24  and @xmath3200  dces at 70  are required . at 160  , the situation is less ideal , with simulations indicating as many as 500  dces may be required to produce flats to better than 1%  rms .",
    "si ibc arrays are known to have considerable latency , where the signal induced by bright illumination persists after the illumination has terminated .",
    "ideally , if one knows the position of a source exposed on the array and the latency decay behavior , these artifacts can be subtracted from an image .",
    "we have characterized the latent behavior from ground test data .",
    "several different conditions were explored , including varying brightnesses of the illuminating source , varying brightnesses of the background , initial bias boosts , and changing the number of resets via different exposure times .",
    "a bias boost can flush out most of the trapped charge , but resets are not nearly as effective .",
    "since bias boosts will only be done in the first dce of each observation , we correct for latent residuals in the data processing .",
    "the latent decay curve can be described by single exponential , given by @xmath99 where @xmath100 is the slope in the absence of a latent , @xmath101 is the initial value of the latent , and @xmath102 is the latent time constant . based on the limited ground data , the latent parameters ( @xmath101 and @xmath102 ) appear to be functions of background levels , number of resets and possibly location on the array . in general , the latent contribution is about @xmath3 1% of the initial source brightness @xmath35 sec after that source has shut off .",
    "higher background yield slightly higher values for @xmath101 and lower values of @xmath102 .",
    "the value of @xmath102 is in the range of @xmath103 seconds .",
    "both the 70 and 160  arrays exhibit nonlinearities that are dependent on the incident point source flux as well as the background .",
    "these are termed flux nonlinearities and have been observed in data taken with the characterization array as well as the flight array . as is usual for the ge arrays , each pixel shows flux nonlinearities with a different dependence on source flux and background . correcting for this effect",
    "can be broken into two pieces : ( 1 ) removing the pixel to pixel differences in the nonlinearity followed by ( 2 ) the application of a global nonlinearity correction as a function of the source brightness and background .",
    "the pixel to pixel variations in the flux non - linearity may be mapped by analyzing the ratio of two stim flashes , where one is the standard on orbit calibrating stim flash .",
    "measured differences in the ratio from pixel to pixel can be used to correct each pixel to the same flux non linearity for the given background and source ( second stim flash ) amplitude .",
    "repeating the measurement for a variety of second stim flash amplitudes ( up to saturation for each pixel ) and backgrounds will map out the correction .",
    "the second , global , stage of the correction can be characterized by observations of calibration stars with a range of known brightness ratios on similar backgrounds .",
    "the combination of these two tasks outlined above should provide a good measurement of the flux nonlinearity correction for a range of backgrounds .",
    "this correction will improve continuously during the mission as the range of backgrounds and calibration stars expands .",
    "the absolute calibration of mips will rely on a well determined anchor at 10.6  using the fundamental calibrators @xmath104  boo , @xmath104  tau , and @xmath105  gem @xcite .",
    "three independent methods will be used to extrapolate the calibration at 10.6  to the mips bands : ( 1 ) solar analogs , ( 2 ) a star atmospheric models , and ( 3 ) semi - empirical models of k giants .",
    "grids of stars for each method have been observed from the ground and tied to the fundamental calibrators at 10.6  . for the solar analog stars , on orbit observations at 24 , 70 , and 160",
    "are being compared with extrapolations of empirical measurements of the sun extrapolated into the mips bands .",
    "a grid of a stars has been observed in all three bands on orbit and compared to extrapolations of a star atmosphere models to the mips bands .",
    "while the solar analog and a star calibrators will be observed in the mips 160  band , the k giant calibrators will be the only ones detectable at high signal - to - noise in that band .",
    "on orbit observations of the k giant calibrators are being compared to theoretical extrapolations of model atmospheres , eg .",
    "@xcite extrapolated to longer wavelengths using the engelke function @xcite .",
    "absolute flux calibrators will be observed throughout the lifetime of the mission .",
    "the last step in the reduction of mips data is to use the redundancy inherent in the observing modes to improve the removal of instrumental signatures .",
    "this step is mainly for the 70 and 160  data due to the challenging aspects of ge detector calibration .",
    "we define the level of redundancy to be the number of different pixels that measure the same point on the sky .",
    "our approach will be to look for known instrumental signatures ( as a function of time ) in the difference between what a particular pixel detects and what all the other pixels detected for the same sky locations .",
    "this is possible because the observing strategy has been designed so that each point on the sky will be observed multiple times by different pixels .",
    "table  [ tab_redund ] shows the minimum level of redundancy for each mips observing mode .",
    "many mips observations are taken with multiple cycles resulting in significantly higher redundancies .",
    "it is recommended to have a minimum redundancy of four .",
    "lccc photometry , compact & 14 & 10 & 2 + photometry , large & 10 & 6 & 1 + photometry , compact super resolution & 14 & 8 & 6 + photometry , large super resolution & 10 & 8 & + scan map , slow & 10 & 10 & 1 + scan map , medium & 10 & 10 & 1 + scan map , fast & 5 & 5 & 0.5 + sed & & 2 & + total power & 1 & 1 & 1      the basic algorithm for using redundancy to refine the instrumental signature removal is as follows .    1 .",
    "create a mosaic of all the images in question . during the mosaic creation ,",
    "use a sigma rejection algorithm to remove data that are deviant from the majority of the observations .",
    "2 .   use the mosaic as a `` truth '' image of what each image should have measured .",
    "3 .   for each pixel , subtract the actual from the `` truth '' measurements to create a measurement of the time history differences .",
    "4 .   examine the difference time history for known instrumental signatures .",
    "while many instrumental signatures could be present , we plan to concentrate on stim latent residuals and systematic differences between `` extended '' sources and point sources .",
    "actual on - orbit data will guide the details and number of instrumental signatures that are corrected using redundancy .",
    "5 .   correct for all instrumental signatures that are found to be significant .",
    "iterate steps 1 - 5 until no new significant instrumental signatures are found .",
    "the input to this algorithm is calibrated slope images .",
    "the output product of this algorithm is enhanced images .",
    "a useful side product will be the mosaicked image of the object .      to use the redundancy to remove additional instrumental signatures we must first coadd all related observations into a single mosaic . because the mips optical train is made up of purely off - axis reflective elements there",
    "exist scale changes and rotations across the re - imaged focal plane . to coadd images taken at different places on the array , it is crucial to correct the data for these distortions .",
    "we used the code v optical models for spitzer / mips to estimate the distortions present in the images from the three mips detectors .",
    "the results from code v allow us to determine distortion polynomials which can then be used to correct for the distortions .",
    "we estimated the distortions by setting up a grid of equally spaced points in the field of view at a specific scan mirror angle .",
    "the chief ray from each object point was traced through the system to where it was imaged on the focal plane . in a perfect optical system",
    "the image points would map perfectly from the object with a possible change in magnification .",
    "the difference between the ideal location and the actual location is the distortion .",
    "for example , figure  [ fig_70um_dist ] is a vector plot of the distortions present in the 70  narrow field array .",
    "the equally spaced grid of points present the focal plane points and the ends of the vectors correspond to the object points , after a plate scale factor was applied .",
    "the difference in the points ( the length of the vector ) is caused by the distortions .",
    "lc 24   & 2.84 + 70  wide & 0.2 + 70  narrow & 7.70 + 160   & 7.78 +    table  [ tab_dist_det ] lists the scale change of the field of view of the different mips arrays . the scale change is defined as ( maximum length of distorted field - minimum length of the distorted field)/(minimum length of the distorted field ) . from a distortion standpoint , it is useful to look closely at individual pixels to see how distortion changes the area imaged on the pixel .",
    "figure  [ fig_70um_close ] is a plot of a distorted pixel in the 70  narrow field array .",
    "one can see that the distorted pixel changes shape from a square to a somewhat trapezoidal shape .",
    "the ratio of the distorted to undistorted pixel area is 1.19 .",
    "table  [ tab_dist_pix ] lists information on how distortion affects the area imaged on individual pixels on the different arrays .",
    "the distorted pixel area ratio is defined as ( distorted pixel area)/(undistorted pixel area ) .",
    "lccccc 24   & 0.9998 & 0.0282 & 0.9406 & 1.0613 + 70  wide & 1.0027 & 0.0042 & 0.9973 & 1.0148 + 70  narrow & 1.0129 & 0.0664 & 0.8913 & 1.1929 + 160   & 0.9781 & 0.0361 & 0.9007 &",
    "1.0137 +    following the procedure of converting the pixel coordinates to world coordinates outlined in @xcite , the distortion correction is applied to the pixel coordinates before any other transformations .",
    "the distortion correction is accounted for by distortion polynomials .",
    "the distortion polynomials give the additive correction to map the distorted pixel coordinates , @xmath106 to the distortion corrected pixel coordinates @xmath107 .",
    "thus , @xmath108 and @xmath109 , where @xmath110 and @xmath111      the ability to remove additional instrumental signatures is dependent on creating a high resolution mosaicked image .",
    "for the mosaicked image to be of sufficient resolution , the mosaicked pixel sizes must be smaller than the original input pixels .",
    "while many mosaicking programs compensate for undersampling by making use of dithered data , the mips data are well sampled and do not require this compensation . instead , our focus is co - adding the related calibrated images into a single image without interpolating between pixels .",
    "therefore , we always work on the coordinates of the corners of a pixel , transforming them from the input image coordinate system to the output mosaicked coordinate system .",
    "the output mosaic image is on a single tangent plane . in the transformation of the pixel corners in the input image pixels to their location on the output mosaic image",
    "the corners are corrected for distortion , converted to right ascension and declination , and then projected onto the tangent plane defined by the right ascension and declination of the mosaic center .",
    "figure  [ fig_mosaic ] is an example of three images which overlap each other on the mosaicked plane . in the process of establishing the location of the image pixel corners on the mosaicked plane ,",
    "the link and overlap coverage between the input pixel and the output pixels it falls on is determined .",
    "a critical step in removing residual instrumental signatures based on the co - added mosaic image depends on correctly linking each mosaic pixel with each image pixel that overlaps it ( and vice versa ) and accurately determining the degree of overlap .",
    "essentially each output sub - sampled mosaic pixel becomes a cube of data , with each plane in this cube representing the information in each overlapping image pixel . the surface brightness and uncertainty associated with each mosaic pixel",
    "is found by weighted averaging the overlapping planes of data . in the surface brightness case ,",
    "the weighting is based on the overlap coverage and uncertainty associated with the input image pixel .",
    "the information in each mosaic pixel is based on multiple observations of a single area on the sky .",
    "this redundancy of data can be used to identify cosmic rays or any single image pixel measurement that deviates from the expected mean of multiple observations and expected noise .",
    "for example , for a 70  photometry observing mode cycle , if one of the pixels suffers from a much larger stim latent than the other observations , it will stand out and be identified as an outlier . as an outlier , it will not be used in creating the mosaicked image .",
    "after all the outliers have been determined , then the links between the output mosaic pixel and the input image pixels are used to tally the number of times an image pixel was flagged as an outlier .",
    "if the majority of the time an image pixel was flagged as deviant , then this pixel is flagged in the original data as an outlier .",
    "if a sufficiently large number ( about 1% ) of the input image pixels are flagged as outliers then the mosaic step is repeated .",
    "the final output is a mosaic image that can then be used as the `` truth '' image of what each image should have measured . following the steps outlined in section  [ sec_redund_algorithm ] this truth image",
    "is used to remove residual instrumental signatures .",
    "with the successful launch of the spitzer space telescope in august 2003 , these reduction algorithms were tested against mips flight data of astronomical sources . this testing has validated the algorithms described in this paper , but has also shown that a number of modifications will be needed to handle the realities of flight data .",
    "the initial results of this testing are summarized here and in @xcite , but a full accounting will be a subject of a future paper when the final mips reduction algorithms are known .    there were two significant changes in the instrument operations which are not easily correctable by reduction algorithms .",
    "the 70  @xmath112 array was found to suffer from a cable short induced sometime between ground testing and flight .",
    "this short injects a large amount of noise into one half of the 70  @xmath112 array resulting in a useful array of only @xmath113  pixels .",
    "the 160  @xmath112 array was found to suffer from a `` blue - leak '' caused by an unintended reflection from the blocking filter which passes through the bandpass filter .",
    "this `` blue - leak '' results in an approximately factor of 15 image leak for stellar sources .",
    "this leak means that asteroids are now the primary calibrators for 160  @xmath112 .",
    "other than bright stars , the leak signal is below the confusion limit for most science targets as they have much smaller blue/160  @xmath112 ratios . at 24  @xmath112",
    ", the pre - flight reduction algorithms were found to work well with only three changes needed .",
    "first , the row droop correction does not seem necessary , but extensive testing has yet to be completed .",
    "second , an additive offset in the second read of every ramp was found which produced a low level ( 1 - 2% ) gradient in final mosaics .",
    "a straightforward correction for this has been implemented using raw and sur data for calibration .",
    "third , scan mirror angle dependent flat fields are needed due to contamination of the scan mirror by small particles .",
    "this contamination is seen as dark spots in individual images which move with scan mirror angle , but not spacecraft offsets . with these three modifications to the preflight algorithms , mips",
    "is producing high quality 24  @xmath112 images which are well calibrated .    at 70  @xmath112 ,",
    "flight data has validated the basic structure of the preflight reduction algorithms but significant modification is required to account for time dependent behaviors .",
    "the stim flash latents were found to grow in amplitude quickly after anneals . with a similar timescale , the residual background time dependence ( after correction using the stim flash amplitudes ) was seen to grow .",
    "these two facts required hand reductions to remove the stim flash latents and background variations to produce good quality mosaics at 70  @xmath112 . these two effects are prime candidates for removal using redundancy , but the effectiveness of automatic removal has not been demonstrated yet .    at 160  @xmath112 ,",
    "the basic preflight algorithms have been validated from comparison with flight data .",
    "some differences in detector behavior were seen in flight data .",
    "for example , the stim flash latents have a faster time constant than in preflight data . at this time",
    ", the nonlinearities in the 70 and 160  @xmath112 arrays have not been well enough characterized with flight data to validate this section of the preflight algorithms .",
    "finally , the cosmic ray rate seen in the ge arrays has been seen to be about a factor of two over preflight predictions , 1 cosmic ray every 12 or so seconds .",
    "the ramp jump detection has been seen to work well and line segment fitting removes the majority of the effects of these cosmic rays .",
    "some residual effects remain and additional characterization may lead to algorithms to remove these additional effects .",
    "the effectiveness of the algorithms described in this paper as well as the design of mips is attested by the point - spread - functions ( psfs ) constructed from flight data at 24 , 70 , and 160  @xmath112 shown in fig .",
    "[ fig_psf ] .",
    "these psfs all clearly have a well - defined first airy ring with the 24  psf also exhibiting a well - defined second airy ring .",
    "all three psfs are well represented by the predictions of tinytim models @xcite adapted to mips . in addition , there are many papers written using mips flight data for the spitzer special astrophysical journal supplement issue ( 2004 , apjs , 154 ) .",
    "this paper has described the preflight data reduction algorithms for all three arrays for the mips instrument on spitzer .",
    "these algorithms have been guided by extensive laboratory testing of the si ( 24  ) and ge ( 70 and 160  ) arrays .",
    "in addition , numerical modeling of the ge arrays has provided important insights into their behavior .",
    "the design and operation of the mips instrument has been summarized to give sufficient background for understanding the data reduction algorithms .",
    "the design and operation of the mips instrument is mainly driven by the needs of the ge arrays .",
    "as ge detectors display significant responsivity drift over time due mainly to cosmic ray damage , the mips observing modes include frequent observations of an internal illumination source .",
    "in addition , most mips operating modes have been designed to provide significant redundancy to increase the robustness of the mips observations against detector effects .",
    "the data reduction for the mips arrays is divided into three parts .",
    "the first part converts the data ramps into slope measurements and removes detector signatures with time constants less than approximately 10 seconds .",
    "these detector signatures at 24  include saturation , dark current , rowdroop , droop , electronic nonlinearities , and cosmic rays . at 70 and 160  ,",
    "the detector signatures removed include saturation , electronic nonlinearities , stim flash latents , and cosmic rays .",
    "the resulting slopes are determined from linear fits and their uncertainties are computed accounting for both the random and correlated nature of the data ramp uncertainties .",
    "the second part of the mips data reduction converts the slopes to calibrated slopes and removes detector signatures with time constants larger than approximately 10 seconds . at 24",
    ", this translates to applying a flat field , correcting for object latents , and applying the flux calibration . at 70 and 160",
    ", this step includes subtracting the dark , flat fielding using an instantaneous flat field , correcting for the flux nonlinearities , and applying the flux calibration . a flat field specific to each 70 and 160  image is required to correct for the time - dependent responsivity of the ge arrays .",
    "it is constructed from the frequent stim flashes and a previously determined illumination correction .",
    "the third data reduction step is to use the spatial redundancy inherit in the mips observing modes to improve the removal of instrumental signatures .",
    "this step is only applied to the ge data .",
    "known instrumental signatures are searched for in the difference between what a specific pixel and what all other pixels from the same sky locations detected . if instrument signatures are detected , they are removed and the process is repeated .",
    "this method is iterative in nature and will require care to avoid introducing spurious signals into the data .",
    "the design of this portion of the data reduction algorithms is necessarily the least developed because only after spitzer launches will it be known which instrumental signatures are important to correct with this method .",
    "finally , initial testing using flight data from mips has validated these data reduction algorithms , but some modification is necessary to account for the realities of flight .",
    "a future paper will describe these modifications in detail once they have been devised and tested .",
    "we wish to thank j.  w.  beeman and e.  e.  haller for their contributions to the design and building of the mips instrument .",
    "this work was supported by nasa jpl contract 960785 .",
    "when a detector is non - destructively read out multiple times before resetting the resulting data ramps represent correlated measurements .",
    "this is because measurement @xmath114 is equal to @xmath115 where @xmath116 is number of photons detected in the time between @xmath117 and @xmath114 .",
    "this statement ignores the effects of read noise , which produces uncorrelated uncertainties on the @xmath117 measurements .",
    "while fitting lines to data with correlations is a complex subject , the form of the correlations in the case of non - destructive readouts allows analytic equations to be derived for the linear fit parameters and uncertainties .",
    "we present a derivation of equations for linear fit parameters and their uncertainties for the case of a data ramp with correlated reads and no read noise .",
    "this derivation is based on a similar derivation by @xcite for nicmos data ramps but is slightly more general . as part of this derivation , it can be seen that the linear fit parameters derived assuming either random or correlated uncertainties are equivalent .",
    "this is not the case for the uncertainties on the fit parameters , which is the main motivation for this derivation .",
    "the basics of fitting a line to data with random uncertainties are given in @xcite .",
    "we repeat their results here , as the derivation for correlated uncertainties draws directly from this work . in fitting data to a line of the form @xmath118 the fit parameters and their uncertainties are @xmath119 where @xmath120 is the number of ( @xmath121 ) measurements , @xmath122 is the uncertainty on each measurement of @xmath117 , @xmath123 these equations assume that the measurements of @xmath117 are independent .    to determine the linear fit terms for a line fit to correlated data ramps , the assumption that the @xmath117 measurements are independent is not correct .",
    "the standard formulae need to be modified to sum over terms that are independent .",
    "the modifications start with realizing that @xmath124 is the independent quantity in the absence of read noise .",
    "any equation in the standard derivation that relies on the independence of @xmath117 needs to be modified to only depend on @xmath116 .",
    "thus , @xmath125 and using a similar derivation , @xmath126 the standard equations ( [ eq_a_random ] & [ eq_b_random ] ) can then used to determine the best fit values of @xmath127 and @xmath47 for the case of correlated uncertainties .",
    "in fact , the values of @xmath127 and @xmath47 derived assuming correlated or uncorrelated uncertainties are exactly the same . the differences between the two types of uncertainties arises in determining @xmath128 and @xmath129 .    to derive @xmath128 and @xmath129 for a data ramp with correlated measurements we start with equations 6.19 and 6.20 of @xcite . converting from @xmath117 to @xmath116 as the independent variable gives @xmath130 \\\\     & = & \\sum_{i=2}^n \\left [ \\sigma(p_i)^2 \\left (       \\frac{\\partial z}{\\partial p_i } \\right)^2 \\right ] \\\\\\end{aligned}\\ ] ] where @xmath131 is either @xmath127 or @xmath47 .",
    "the partial derivatives needed are then @xmath132 and @xmath133 thus , @xmath134      the assumption that the uncertainties can be calculated separately for the correlated and random measurement uncertainties was tested via monte carlo simulations .",
    "simulations for cases similar to that expected for the 70  array are plotted in figure  [ fig_fit_cor_ex ] .",
    "as can be seen from these plots , equations  [ eq_sigma_a ] and [ eq_sigma_b ] give very good estimates of the actual uncertainties .",
    "beeman , j.  w.  & haller , e.  e.  2002 , , 4486 , 209 beichman , c.  a. , neugebauer , g. , habing , h.  j. , clegg , p.  e. , & chester , t.  j.  1988 , nasa rp-1190 , vol .  1 bevington , p.  r.  & robinson , d.  k.  1992 , data reduction and error analysis for the physical sciences ( new york : mcgraw - hill , inc . ) burgdorf , m.  j. , et al .",
    "1998 , adv . in space research , 21 , 5 church , s.  e. , griffin , m. j. , price , m.  c. , ade , p.  a. , emergy , r.  j. , and swinyard , b. m.  1993 , proc .",
    "spie , 1946 , 116 cohen , m. , walker , r. g. , barlow , m. j. , & deacon , j. g. 1992 , , 104 , 1650 cohen , m. , witteborn , f. c. , walker , r. g. , bregman , j. d. , & wooden , d. h. 1995 , , 110 , 275 cohen , m. , witteborn , f. c. , carbon , d. f. , davies , j. k. , wooden , d. h. , & bregman , j. d. 1996a , , 112 , 2274 cohen , m. , witteborn , f. c. , bregman , j. d. , wooden , d. h. , salama , a. , & metcalfe , l. 1996b , , 112 , 241 de graauw , t.  et al .",
    "1996 , , 315 , l49 dierckx , b. , vermeiren , j. , cos , s. , faymonville , r. , and lemke , d.  1992 , proc .",
    "esa symposium on photon detectors for space astronomy ( see n94 - 15025 ) , pp .",
    "405 - 408 engelke , c.  w.  1992 , , 104 , 1248 gordon , k.  d.  et al .",
    "2004 , , 5487 , 177 greisen , e.  w.  & calabretta , m.  r.  2002 , , 395 , 1061 haegel , n.  m. , simoes , j.  c. , white , a.  m. , & beeman , j.  w.  1999 , , 38 , 1910 haegel , n.  m. , schwartz , w.  r. , zinter , j. , white , a.  m. , & beeman , j.  w.  2001 , , 40 , 5748 heim , g.  b.  et al .",
    "1998 , , 3356 , 985 heras , a.  m. , et al .  2000 , experimental astronomy , 10 , 177 hesselroth , t. , ha , e.  c. , pesenson , m. , kelly , d.  m. , rivlis , g. , & engelbracht , c.  w. 2000 , , 4131 , 26 kessler , m.  f.  et al .",
    "1996 , , 315 , l27 krist , j.  1993 , asp conf .",
    "ser .  52 : astronomical data analysis software and systems ii , 2 , 536 lemke , d. , et al .",
    "1996 , , 315 , l64 low , f.  j. , beichman , c.  a. , gillett , f.  c. , houck , j.  r. , neugebauer , g. , langford , d.  e. , walker , r.  g. , & white , r.  h.  1984 , optical engineering , 23 , 122 neugebauer , g. , et al .",
    "1984 , , 278 , 1 rieke , g.  h. 2002 , detection of light , 2nd edition ( cambridge , england : cambridge university press ) rieke , g.  h. , montgomery , e.  f. , lebofsky , m.  j. , & eisenhardt , p.  r.  1981 , , 20 , 814 rieke , g. h. , lebofsky , m. j. , & low , f. j. 1995 , , 90 , 900 rieke , g.  h. , et al .",
    "2004 , , 154 , 25 schnurr , r. , thompson , c.  l. , davis , j.  t. , beeman , j.  w. , cadien , j. , young , e.  t. , haller , e.  e. , & rieke , g.  h.  1998 , , 3354 , 322 sparks , w.  b.  1998 , nicmos instrument science report , space telescope science institute , 98 - 008 swinyard , b.  m.  et al .",
    "1996 , , 315 , 43 swinyard , b. , clegg , p. , leeks , s. , griffin , m. , lim , t. , & burgdorf , m.  2000 , experimental astronomy , 10 , 157 valentijn , e.  a.  & thi , w.  f.  2000 , experimental astronomy , 10 , 215 young , e.  t.  et al .",
    "1998 , , 3354 , 57 young , e.  t.  et al .",
    "2003 , , 4850 , 98"
  ],
  "abstract_text": [
    "<S> we describe the data reduction algorithms for the multiband imaging photometer for spitzer ( mips ) instrument . </S>",
    "<S> these algorithms were based on extensive preflight testing and modeling of the si : as ( 24  ) and ge : ga ( 70 and 160  ) arrays in mips and have been refined based on initial flight data . </S>",
    "<S> the behaviors we describe are typical of state - of - the - art infrared focal planes operated in the low backgrounds of space . </S>",
    "<S> the ge arrays are bulk photoconductors and therefore show a variety of artifacts that must be removed to calibrate the data . the si array , while better behaved than the ge arrays , does show a handful of artifacts that also must be removed to calibrate the data . </S>",
    "<S> the data reduction to remove these effects is divided into three parts . </S>",
    "<S> the first part converts the non - destructively read data ramps into slopes while removing artifacts with time constants of the order of the exposure time . </S>",
    "<S> the second part calibrates the slope measurements while removing artifacts with time constants longer than the exposure time . </S>",
    "<S> the third part uses the redundancy inherit in the mips observing modes to improve the artifact removal iteratively . for each of these steps </S>",
    "<S> , we illustrate the relevant laboratory experiments or theoretical arguments along with the mathematical approaches taken to calibrate the data . </S>",
    "<S> finally , we describe how these preflight algorithms have performed on actual flight data . </S>"
  ]
}