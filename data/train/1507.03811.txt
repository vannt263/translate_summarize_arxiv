{
  "article_text": [
    "emotion recognition deals with the problem of inferring the emotion ( i.e. fear , anger , surprise , etc . )",
    "given a sequence of face images .",
    "due to strong inter - subject variations , especially in some kind of emotions ( such as fear or sadness ) , and the difficulty to extract reliable feature representations because of illumination changes , biometric differences , and head pose changes , emotion recognition is a challenging problem .",
    "nonetheless , recognition of face expressions and emotions is of great interest in many fields such as assistive technologies  @xcite ,  @xcite , socially assistive robotics  @xcite , computational behavioral science  @xcite ,  @xcite ,  @xcite , and the emerging field of audience measurement  @xcite .",
    "a vast literature on affective computing  @xcite ,  @xcite ,  @xcite , has shown that an emotion can be identified by a subset of detected action units .",
    "this suggests that face emotion results as combination of movements of various facial muscles .",
    "therefore in this paper we assume that a composition of multiple concurrent signals yields to a face emotion .",
    "we use a restricted set of appearance features  computed on a frame - per - frame basis  that may be correlated with one or more of these concurrent signals . given a sequence of face images corresponding to an emotion , the extraction of these appearance features yields to a set of time series , one for each appearance feature . considering that face emotions are not instantaneous , we aim at using the dynamics regulating each sequence of appearance features to recognize among different emotions .",
    "we propose to model a sequence of face appearance feature as the output of a linear time invariant ( lti ) system .",
    "motivated by the success of works in action recognition  @xcite ,  @xcite , that represent action - dynamics in terms of hankel matrices , in this paper we explore the use of hankel matrices to represent emotion - dynamics .",
    "we adopt a multi - scale haar - like feature based appearance representation to obtain a set of time series ( one for each spatial scale and haar - like feature ) .",
    "hence we represent a sequence of face images by means of an ensemble of hankel matrices where each hankel matrix embeds the dynamics of one of the extracted haar - like feature time series .",
    "nearest - neighbor classifier combined with a majority vote schema is used for classification purposes .",
    "we validated our work on the publicly available extended cohn - kanade dataset  @xcite .",
    "our experiments show that there is a clear advantage in adopting a dynamics - based emotion representation over using the raw measurements .",
    "furthermore , our experiments highlight that the dynamics of different appearance features contribute differently to the emotion recognition .",
    "overall , our novel emotion representation permits to achieve state - of - the - art accuracy values in comparison to works that use accurate face landmarks .",
    "the plan of the work is as follows . in section  [ sec : rw ]",
    ", we present works that are related to our emotion - dynamics representation . in section  [ sec : ar ]",
    "we describe how we extract a multi - scale face appearance description ; section [ sec : adr ] introduces the hankel matrix - based representation and describes how to build an ensemble of hankel matrices to describe face appearance dynamics ; section  [ sec : ec ] presents details about the adopted classification framework .",
    "finally , in sections  [ sec : er ] and  [ sec : cfw ] , we present experimental results , and conclusions and future directions respectively .",
    "face detection @xcite , face recognition  @xcite ,  @xcite and facial expression analysis  @xcite have been deeply studied in past years , resulting in a vast literature reviewed in  @xcite ,  @xcite . in this section ,",
    "we focus on works that embed the temporal structure of the face image sequence in the feature representation or in the emotion model .",
    "dynamics - based emotion recognition has been proposed in  @xcite where horizontal and vertical movements of tracked landmarks of different face parts such as eyebrows , eyelids , cheeks , and lip corners jointly with spatio - temporal appearance features are used to describe a sequence of face images .",
    "temporal changes in the face appearance are described by means of the complete local binary patterns from three orthogonal planes ( lbp - top ) @xcite and classification is performed by svm . while  @xcite attempts to embed information about the dynamics at a feature representation level , works such as  @xcite ,  @xcite account for the temporal structure of the sequences of descriptors in the emotion model . in  @xcite , restricted boltzmann machine with local interactions ( lrbm ) is used to capture the spatio - temporal patterns in the data .",
    "rbm is used as a generative model for data representation instead of feature learning , and data need to be pre - aligned . in  @xcite time - series kernel methods",
    "are used for emotional expression estimation using landmark data only .",
    "the work shows that emotion recognition may be done by adopting either the dynamic time warping ( dtw ) kernel or the global alignment ( ga ) kernel  @xcite ,  @xcite . in  @xcite ,",
    "a bayesian approach is used to model dynamic facial expression temporal transitions .",
    "facial appearance representation is computed in terms of local binary patterns ( lbp ) , and an expression manifold is derived for multiple subjects .",
    "a bayesian temporal model ( similar to hmm with a non parametric observation model ) of the manifold is used to represent facial expression dynamics .",
    "works such as  @xcite ,  @xcite use landmarks located on face parts such as eyes , eyebrows , nose and mouth to describe an emotion . in @xcite , a constrained local model ( clm ) is used to estimate facial landmarks and extract a sparse representation of corresponding image patches .",
    "emotion classification is performed by least - square svm .",
    "wang et al .",
    "@xcite propose to use interval temporal bayesian network ( itbn ) to capture the spatial and temporal relations among the primitive facial events .",
    "hankel matrices have been already adopted for action recognition in @xcite , which adopts a hankel matrix - based bag - of - words approach , and in @xcite , which models an action as a sequence of hankel matrices and uses a set of hmm trained in a discriminative way to model the switching between lti systems . in  @xcite , we have showed how the dynamics of tracked facial landmarks can be modeled by means of hankel matrices and can be used for facial expression analysis . whilst it is possible to obtain a reasonably accurate estimate of the face region  @xcite , getting a reliable estimation of facial landmarks is still an open problem despite the remarkable progress described in @xcite , @xcite .",
    "the adoption of appearance feature extracted from the detected face region to describe an emotion , as done indeed in  @xcite ,  @xcite ,  @xcite ,  @xcite , might be a convenient choice .",
    "therefore , in this paper we adopt appearance features to represent a face expression .",
    "in contrast to  @xcite , we do not model landmark trajectories but we use an ensemble of hankel matrices to describe the dynamics of sequences of appearance features computed at multiple spatial scales .",
    "we demonstrate that , without an accurate estimation of facial landmarks , our novel representation can achieve state - of - the - art accuracy in emotion recognition .",
    "given a face image , we need to extract a proper appearance representation for the shown face expression . considering the success of haar - like features in face detection we adopt this kind of features to build our face appearance descriptor .",
    "haar - like features resemble haar wavelets and have been developed by viola and jones for face detection @xcite .",
    "a haar - like feature is computed by considering adjacent rectangular regions in a detection window .",
    "the pixel intensities in each region are summed up and the difference between these sums yields the haar - like feature . in @xcite ,",
    "haar - like features are compared against a threshold and used to detect the face ; therefore they are used as weak classifiers and a high number of features are considered in order to build a strong classifier .",
    "the key advantage of a haar - like feature over most other features is that it can be calculated in constant time due to the use of integral images .",
    "a number of haar - like features have been used in literature @xcite , @xcite , and haar - like features and/or simple variations have been formerly used in literature for emotion recognition @xcite,@xcite,@xcite within boosting approaches .            in this paper",
    "we only use the six most common features depicted in figure [ fig : haar ] .",
    "intuitively , a multi - scale approach might account for different intensity of the emotion , which may change from subject - to - subject .",
    "therefore we extract haar - like features at different spatial scales . in this preliminary work ,",
    "we do not model the weights of each extracted feature ; modeling these weights / performing feature selection remains a topic of future investigations .",
    "the main steps we perform to extract our face appearance representation are :    * we detect the face region ( as shown in fig .",
    "[ fig : steps ]  ( a ) ) ; * within the face region , we consider a set of uniformly sampled points ( red dots in fig .",
    "[ fig : steps ]  ( b ) ) ; * we center windows of varying spatial scales at each of these sampled points ( fig . [",
    "fig : steps ]  ( c ) shows the windows centered at a representative point on the subject s nose .",
    "each color indicates a different scale . ) ; * we extract our haar - like features from each of the selected windows .",
    "whenever the sliding window exceeds the size of the face region ( especially along the boundary ) , the window is cropped so to consider only the pixels within the face area . in our implementation ,",
    "the white and black rectangular regions of each haar - like feature are computed in proportion to the window size , therefore the cropping does not affect the computation of the haar - like features .    ( a ) ( b ) ( c )",
    "in this section , first we briefly review lti systems and hankel matrix , then we describe our ensemble of hankel matrices for emotion - dynamics representation .      in a lti system ,",
    "two linear equations regulate the behavior of the system : @xmath0 the first equation is known as the _ state equation _ and involves the variable @xmath1 , which represents the @xmath2-dimensional internal state of the lti system .",
    "the second equation is known as the _ measurement equation _ and provides a link between the state of the system @xmath3 and the @xmath4-dimensional observable measurement @xmath5 . in such equations the matrices @xmath6 and @xmath7 are constant over time , and @xmath8 is uncorrelated zero mean gaussian measurement noise .",
    "it is well known @xcite that , given a sequence of output measurements @xmath9 $ ] from eq .",
    "[ eq : system ] , its associated truncated block - hankel matrix is @xmath10 where @xmath11 is the maximal order of the system , @xmath12 is the temporal length of the sequence , and it holds that @xmath13 .    the hankel matrix embeds the observability matrix @xmath14 of the system , since @xmath15 , where @xmath16 $ ] is a matrix formed by the sequence of internal states of the lti system .    as previously done in  @xcite ,  @xcite , we normalize the hankel matrix @xmath17 as follows : @xmath18 and compare two hankel matrices @xmath19 and @xmath20 by the following similarity score : @xmath21 which can be easily derived from the dissimilarity score in  @xcite .",
    "we have experimentally found that our similarity score is numerically more stable and fast to compute than the dissimilarity score .",
    "such score can be regarded as an approximation of the cosine of the subspace angle between the spaces spanned by the columns of the hankel matrices . as such",
    ", it can convey the degree to which two hankel matrices may correspond to the same dynamical system .",
    "the simple and fast appearance feature extraction described in section [ sec : ar ] yields to a set of time series @xmath22 where @xmath23 is the time series corresponding to the @xmath24-th haar - like feature at the @xmath25-th spatial scale ( @xmath26 is the number of haar - like features , and @xmath27 is the number of scales ) .",
    "each element @xmath28 of this time series is a vector of features computed at the uniformly sampled points and representing the @xmath29-th face in the face image sequence .",
    "we use the set of time series @xmath30 to build an ensemble of hankel matrices @xmath31 where each hankel matrix @xmath32 is built upon the time series @xmath33 and , therefore , is associated with the @xmath24-th haar - like feature and the @xmath25-th spatial scale . before calculating the hankel matrix , the sequence @xmath33 is made zero mean .",
    "we note the following :    * each vector @xmath28 is an ordered set of appearance features extracted from different parts of the face region .",
    "the set of hankel matrices @xmath32 captures the dynamics of the haar - like features over the whole face ; * each hankel matrix is built upon a single haar - like feature ; * each hankel matrix is built upon a single scale ; * modeling separately haar - like features at different spatial scales has computational advantages in terms of memory and time complexity ; * hankel matrices can be obtained by a simple and fast reordering of the elements in the vector @xmath28 . therefore , from a computational point of view , the adoption of hankel matrices over other time series representation is particularly appealing .",
    "to test the effectiveness of our novel representation we have adopted the simple and widely used nearest - neighbor classifier ( nn ) .",
    "we compare hankel matrices by using the similarity score in eq .",
    "[ eq : score ] . given an ensemble of hankel matrices",
    ", each hankel matrix contributes to the emotion classification by voting for a class ( predicted by nn ) .",
    "comparison of hankel matrices is done on equal terms of haar - like feature and scale ( we compare only hankel matrices that share the same scale and haar - like feature ) .",
    "decision on the predicted class is performed considering a majority vote schema .",
    "other classification frameworks might be used , such as an lti system codebook based representation similar to that proposed in @xcite , or a state - based approach similar to that in @xcite .",
    "alternatively , system identification techniques such as the ones applied in  @xcite ,  @xcite can be adopted at the cost of an increased overall time complexity .",
    "even if stronger classification frameworks might be adopted as well , nn allows us to study the effectiveness of our representation without introducing further classifier - dependent parameters .",
    ".accuracy in emotion classification on the ck+ dataset .",
    "red font indicates the best accuracy value per emotion , while bold font highlights the second best performance . * * different validation protocol ( 10-fold cross validation ) [ cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ table : acc ]     & * contempt * & * disgust * & * fear * & * happy * & * sadness * & * surprise * + & * 86.67 * & 0 & 2.22 & 2.22 & 0 & 6.67 & 2.22 + * contempt * & 0 & * 83.33 * & 0 & 0 & 5.56 & 5.56 & 5.56 + * disgust * & 0 & 0 & * 96.61 * & 0 & 1.69 & 0 & 1.69 + * fear * & 12 & 4 & 0 & * 52 * & 24 & 4 & 4 + * happy * & 0 & 0 & 0 & 0 & * 100 * & 0 & 0 + * sadness * & 7.14 & 3.57 & 0 & 0 & 3.57 & * 71.43 * & 14.29 + * surprise * & 0 & 1.20 & 0 & 0 & 1.20 & 0 & * 97.59 * +",
    "we have performed experiments in emotion recognition on the widely adopted extended cohn - kanade dataset ( ck+ )  @xcite .",
    "this dataset provides facial expressions of 210 adults .",
    "participants were instructed to perform several facial displays representing either single or combinations of action units . based on the coded action units and by means of a validation procedure of the assigned label",
    ", the segmented recording of the participants emotions were classified into 7 categories ( in brackets the number of available samples ) : _ angry ( 45 ) , contempt ( 18 ) , disgust ( 59 ) , fear ( 25 ) , happy ( 69 ) , sadness ( 28 ) , surprise ( 83)_. in total there are 327 sequences of the 7 annotated emotions , performed by 118 different individuals .",
    "the number of frames of these sequences ranges in @xmath34 $ ] with an average value of about @xmath35 .",
    "the dataset provides landmark tracking results obtained by active appearance model , which we use in our experiments only to detect the face region .",
    "we adopted the validation protocol suggested in  @xcite , which is leave - one - subject - out cross validation .",
    "when extracting the haar - like features , we sample the center location uniformly with a step equals to 10% of the size of the detected face region , yielding a 81 dimensional vector for each haar - like feature .",
    "the spatial scales ( size of the window used to calculate the haar - like feature ) are also computed in proportion to the face region size and the percentage ranges in @xmath36 .",
    "the order of each hankel matrix has been empirically set to 2 . to extract the haar - like features we have modified the implementation used in @xcite , @xcite .",
    "we have performed an extensive validation of the dynamics - based emotion representations whose results are reported in table [ table : acc ] . the table reports the per - class classification accuracy values for each of the emotion classes , and the average accuracy . the table is divided in * 4 * parts . the first part presents accuracy values in classification when the raw features are adopted ( namely haar - like features ) . in this case , as the face image sequences have different lengths , dynamic time warping ( dtw ) is used to align the sequences and nearest - neighbor classifier is used over the aligned sequences . for a fair comparison , also when adopting the raw features , different haar - like features and spatial scales are compared separately and a majority vote schema is used to predict the final class .",
    "the second part of the table presents results when an ensemble of hankel matrices is used .",
    "both the first and second part of the table report performance when a single haar - like feature is used , when a pair of haar - like features is used and , finally , when all the six haar - like features are used .    by comparing the first and second part of the table",
    ", there is a clear advantage in using an ensemble of hankel matrices to represent the emotions over using directly the haar - like features . on average , the increase of performance in using the dynamics - based representation with respect to the raw measurements",
    "is of about 60.3% .",
    "looking at the performance of each single haar - like feature , the most informative one is the concentric squared regions ( the last of the six features ) .",
    "therefore we have performed experiments to study the performance of this feature when coupled with another haar - like feature .",
    "as the table shows , there is an improvement with three of the five haar - like features .",
    "there is no improvement when the haar - like feature is coupled with the first haar - like feature and a degradation of the performance when coupled with the vertical bands haar - like feature .",
    "what is striking is that in all the experiments , the emotion happy is always correctly recognized 100% of times .",
    "this suggests that our ensemble of hankel matrices can be appropriate for smile detection .",
    "a further improvement of the performance is obtained when all the haar - like features are used together , at the cost of an higher computational complexity .",
    "we suspect that not all the features are actually contributing to the recognition of the emotion , and feature and scale selection techniques may help to achieve more accurate results .",
    "the third part of the table reports accuracy values of state - of - the - art methods adopting only appearance features .",
    "the class for which our method seems to fail the most is the emotion _",
    "fear_. if we ignore this class , our method achieves even better accuracy values of the most competitive method in @xcite . for completeness , the fourth part of the table reports the performance of techniques adopting accurate estimation of facial landmarks ( provided together with the dataset ) . even if these methods are not directly comparable with the ones that use only appearance information , we note that our appearance - based representation competes already very well against these techniques .",
    "finally , table [ table : cm ] reports the confusion matrix of our method .",
    "the class _ fear _ is confused mostly with the class _ happy_. some confusion is also present between the classes _ sadness _ and _ surprise_. we believe that these ambiguities might be probably solved with fine - grained appearance descriptors , such as the local directional number ( ldn ) pattern introduced in  @xcite .",
    "in this paper we have proposed to use an ensemble of hankel matrices to represent the dynamics of face appearance features , where each hankel matrix embeds the dynamics of a single appearance feature at a given spatial scale .",
    "we have tested our novel emotion representation on a widely used publicly available benchmark ( ck+ ) .",
    "our experiments demonstrate that , on equal terms of classification framework and feature representations , the dynamics - based emotion representation achieves about 60.3% of increase in the accuracy values with respect of using directly the raw measurements .",
    "overall , our approach achieves competitive performance with respect to more sophisticated machinery or methods that use accurate shape information .",
    "our formulation is general and it is not limited to the adopted face appearance representation .",
    "we therefore aim at extending our work by considering other appearance features .",
    "moreover , we believe that feature and scale selection techniques ( i.e. boosting ) might led to an increase of the accuracy of our approach . in this paper , we have focused on the problem of classifying segmented emotion sequences . in future works we aim at tackling with the problem of emotion intensity estimation and emotion detection in face image sequences . in this sense",
    ", we will explore how face appearance feature dynamics correlate with the intensity of face emotions and if they can help in detecting subtle changes in face expressions .",
    "chew , s.w . ,",
    "lucey , p. , lucey , s. , saragih , j. , cohn , j.f . ,",
    "sridharan , s. : person - independent facial expression detection using constrained local models . in : conf . and",
    "w.orkshop on automatic face & gesture recognition ( fg ) .",
    "915920 . ieee ( 2011 )                  jeni , l.a . ,",
    "girard , j.m . ,",
    "cohn , j.f .",
    ", de  la  torre , f. : continuous au intensity estimation using localized , sparse facial feature space . in : conf . on automatic face & gesture recognition ( fg ) .",
    "ieee ( 2013 )    lacava , p.g . ,",
    "golan , o. , baron - cohen , s. , myles , b.s .",
    ": using assistive technology to teach emotion recognition to students with asperger syndrome a pilot study . remedial and special education 28(3 ) , 174181 ( 2007 )            lo  presti , l. , la  cascia , m. : tracking your detector performance : how to grow an effective training set in tracking - by - detection methods . in : int .",
    "conf . on computer vision theory and applications ( visapp ) .",
    "pp . 18 ( 2015 )    lo  presti , l. , la  cascia , m. : using hankel matrices for dynamics - based facial emotion recognition and pain detection . in : int .",
    "conf . on computer vision and pattern recognition workshops ( cvprw ) .",
    "pp . 18 ( 2015 )",
    "lorincz , a. , jeni , l.a . , szab , z. , cohn , j.f . , kanade , t. : emotional expression classification using time - series kernels . in : conf . on computer vision and pattern recognition workshops ( cvprw ) .",
    "ieee ( 2013 )    lucey , p. , cohn , j.f . , kanade , t. , saragih , j. , ambadar , z. , matthews , i. : the extended cohn - kanade dataset ( ck+ ) : a complete dataset for action unit and emotion - specified expression . in : conf . on computer vision and pattern recognition workshops ( cvprw ) .",
    "94101 . ieee ( 2010 )    lucey , p. , cohn , j.f . ,",
    "prkachin , k.m . , solomon , p.e . ,",
    "matthews , i. : painful data : the unbc - mcmaster shoulder pain expression archive database . in : conf . and",
    "w. on automatic face & gesture recognition ( fg ) .",
    "5764 . ieee ( 2011 )      rabbitt , s.m . ,",
    "kazdin , a.e .",
    ", scassellati , b. : integrating socially assistive robotics into mental healthcare interventions : applications and recommendations for expanded use .",
    "clinical psychology review 35 , 3546 ( 2015 )          sariyanidi , e. , gunes , h. , cavallaro , a. : automatic analysis of facial affect : a survey of registration , representation and recognition .",
    "eee trans . on pattern analysis and machine intelligence ( pami ) ( 2014 )            wang , z. , wang , s. , ji , q. : capturing complex spatio - temporal relations among facial muscles for facial expression recognition .",
    "in : conf . on computer vision and pattern recognition ( cvpr ) .",
    "34223429 . ieee ( 2013 )      yang , p. , liu , q. , metaxas , d.n . : boosting coded dynamic features for facial action units and facial expression recognition . in : conf . on computer vision and pattern recognition ( cvpr ) .",
    "ieee ( 2007 )    zeng , z. , pantic , m. , roisman , g.i . ,",
    "huang , t.s .",
    ": a survey of affect recognition methods : audio , visual , and spontaneous expressions .",
    "ieee trans . on pattern analysis and machine intelligence ( pami )",
    "31(1 ) , 3958 ( 2009 )    zhao , g. , pietikainen , m. : dynamic texture recognition using local binary patterns with an application to facial expressions .",
    "ieee trans . on pattern analysis and machine intelligence ( pami )",
    "29(6 ) , 915928 ( 2007 )"
  ],
  "abstract_text": [
    "<S> in this paper , a face emotion is considered as the result of the composition of multiple concurrent signals , each corresponding to the movements of a specific facial muscle . </S>",
    "<S> these concurrent signals are represented by means of a set of multi - scale appearance features that might be correlated with one or more concurrent signals . </S>",
    "<S> the extraction of these appearance features from a sequence of face images yields to a set of time series . </S>",
    "<S> this paper proposes to use the dynamics regulating each appearance feature time series to recognize among different face emotions . to this purpose , an ensemble of hankel matrices corresponding to the extracted time series </S>",
    "<S> is used for emotion classification within a framework that combines nearest neighbor and a majority vote schema . </S>",
    "<S> experimental results on a public available dataset shows that the adopted representation is promising and yields state - of - the - art accuracy in emotion classification .    ; face processing ; lti systems ; hankel matrix ; classification </S>"
  ]
}