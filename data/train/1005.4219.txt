{
  "article_text": [
    "photonic crystals ( phcs ) are modern artificially structured systems of a broad interest from many viewpoints of fundamental research and applications  @xcite .",
    "studying their electromagnetic properties is significantly important for developing phc - based promising applications such as purely optical integrated circuits  @xcite , artificial metamaterials with high tunability  @xcite , high - sensitivity phc biosensors  @xcite , or devices based on phenomena not accessible in conventional media  @xcite .",
    "it is also necessary for accounting for structural colors of wings of butterflies or beetles , feathers of birds , or iridescent plants  @xcite .",
    "owing to the phc periodicity , the plane - wave expansion ( pwe ) method is conventional for calculating phc modes and photonic band structures .",
    "its essence is the fourier expansion of electromagnetic fields and material parameters , which is not only a counterpart of the pwe method for electronic crystals , but it also advantageously follows the classical coupled - wave theory developed for diffraction gratings during last several decades  @xcite .",
    "one of the most important discoveries of the grating theory are the fourier factorization ( ff ) rules for expanding the ratios of the discontinuous permittivity and the discontinuous electric field  @xcite .",
    "the three ff theorems were first formulated for one - dimensional ( 1d ) gratings and then generalized to two - dimensional ( 2d ) systems  @xcite , arbitrary periodic reliefs  @xcite , anisotropic  @xcite and slanted  @xcite periodic structures , their various combinations  @xcite , and other applications  @xcite .",
    "as will be demonstrated in this paper , the ff rules establish suitable principles for an accurate solution of maxwell s equations in the plane - wave basis , which considerably enhances the numerical performance compared to previously used implementations .    in the case of 2d - periodic structures ,",
    "the ff rules were first applied to `` zigzag '' fourier expansions  @xcite , which yielded an improvement for rectangular dots or holes , but were not sufficient for the staircase approximation of round elements .",
    "after that a coordinate transform was applied to treat individually the normal and tangential components of the electric field on 1d sinusoidal - relief gratings , which enabled the application of the correct rule for each field component  @xcite .",
    "later  @xcite utilized the normal  tangential field separation to 2d phcs composed of circular and elliptical holes .",
    "similarly , schuster and colleagues  @xcite applied this method to 2d gratings , and also suggested more general distributions of polarization bases  @xcite .",
    "these approaches , always dealing with linear polarizations , enabled a significant improvement of the convergence properties , but ignored the fact that the transformation matrix between the cartesian and the normal  tangential component bases of polarization became discontinuous at the center and along the boundaries of the periodic cell , which slowed down the resulting convergence . to overcome these discontinuities ,",
    "a distribution of more complex ( i.e. , generally elliptic ) polarization bases was recently suggested to improve optical simulations of 2d gratings  @xcite .",
    "here we are dealing with 2d phcs made as 2d - periodic elements of the circular cross - section , for which we implement the pwe method by using ff with complex polarization bases . from the mathematical point of view this complexity only requires complex - valued jones vectors , so that the generalization from the previous method of david is surprisingly simple .",
    "both methods are compared with respect to their convergence properties , together with the classical method of ho  @xcite ( where the electric permittivity is expanded without any coordinate transform ) , to show that the method presented here yields the best performance .",
    "two studied configurations of 2d phcs , with square ( a ) and hexagonal ( b ) symmetry , with denoted square and rectangular unit cells , respectively .",
    "the corresponding first brillouin zones of the reciprocal space are depicted in ( c ) and ( d ) , respectively , where the emphasized triangles denote irreducible fractions .",
    "note that for calculations we use a rectangular unit supercell ( solid rectangle ) rather than a hexagonal primitive cell ( dashed hexagon ) in the case of the hexagonal lattice ( b ) so that the corresponding first brillouin zone is the solid rectangle instead of the dashed hexagon in ( d ) , which creates a folded band structure , from where we choose values corresponding to the usual convention.,width=415 ]    we study a 2d phc composed of infinite cylinders with a circular cross - section with either square [ fig .",
    "[ fig : config](a ) ] or hexagonal [ fig .",
    "[ fig : config](b ) ] periodicity . while the structure is invariant along the @xmath1-axis , the periodicity is assumed in the @xmath2- and @xmath3-axes directions . for the square symmetry the unit cell has the dimensions @xmath4 , and",
    "for the hexagonal symmetry it can be chosen as an @xmath5-by-@xmath6 rectangle .",
    "the corresponding first brillouin zones of the reciprocal space are depicted in figs .",
    "[ fig : config](c ) and  [ fig : config](d ) , together with the symmetry points @xmath7 , x , m , and @xmath7 , m , k , respectively . according to this 2d - periodic structure",
    "we define and expand the relative permittivity function @xmath8 where @xmath9 are its fourier coefficients and @xmath10 and @xmath11 are the reciprocal lattice vectors .",
    "maxwell s equations for the @xmath12-polarization ( where the electric field @xmath13 is in the @xmath2@xmath3 plane whereas the magnetic field @xmath14 is along the @xmath1-axis ) are @xmath15 where @xmath16 is the photon frequency , and @xmath17 and @xmath18 are the permittivity and permeability of vacuum , or @xmath19",
    "\\left[\\begin{array}{c}e_x\\\\ e_y\\end{array}\\right ] = -i\\omega\\mu_0 h_z , & \\label{eq : maxwell2a}\\\\   & \\varepsilon\\left[\\begin{array}{c}e_x\\\\ e_y\\end{array}\\right ] =             { \\displaystyle \\frac{1}{i\\omega\\varepsilon_0 } } \\left[\\begin{array}{c}\\partial_y\\\\ -\\partial_x\\end{array}\\right]h_z.&\\label{eq : maxwell2b}\\end{aligned}\\ ] ] note that here we do not study the @xmath20-polarization ( for which the electric field @xmath13 is along the @xmath1-axis ) because in that case the ho method satisfies the correct fourier factorization rules .",
    "assuming an in - plane anisotropy of the relative permittivity function , defining a scaled electrical displacement @xmath21 , @xmath22 = \\bm{\\varepsilon}\\left[\\begin{array}{c}e_x\\\\ e_y\\end{array}\\right ] =            \\left[\\begin{array}{ll}\\varepsilon_{xx } & \\varepsilon_{xy}\\\\ \\varepsilon_{yx } & \\varepsilon_{yy } \\end{array}\\right ]            \\left[\\begin{array}{c}e_x\\\\ e_y\\end{array}\\right],\\ ] ] defining a 2-by-2 matrix of electrical impermittivity @xmath23 , and substituting eq .",
    "( [ eq : maxwell2b ] ) into eq .",
    "( [ eq : maxwell2a ] ) yields @xmath24 where @xmath25 are the components of the electrical impermittivity , @xmath26 is the light speed in vacuum , and the factor @xmath27 is calculated as the eigenvalues of the operator on the left - hand side of eq .",
    "( [ eq : eigen ] ) .    according to the floquet  bloch theorem , in the reciprocal space the magnetic field undergoes the fourier expansion @xmath28 where @xmath29 , @xmath30 .",
    "analogously , the fourier components of @xmath31 , @xmath32 , @xmath33 , @xmath34 are denoted @xmath35 , @xmath36 , @xmath37 , @xmath38 .",
    "then , as demonstrated in appendix , the operators of the partial derivatives @xmath39 , @xmath40 become the diagonal matrices @xmath41 , @xmath42 , the operators of multiplication by functions such as @xmath43 or @xmath44 become matrices denoted @xmath45\\!]$ ] or @xmath46\\!]$ ] , and the field components @xmath31 , @xmath32 , @xmath47 become column vectors denoted @xmath48 $ ] , @xmath49 $ ] , @xmath50 $ ] . using these definitions , the multiplications in eq .  ( [ eq : d - field ] ) can be treated either by the laurent ff rule , @xmath51=[\\![\\varepsilon_{xx}]\\!][e_x]$ ] etc . , or by the inverse ff rule , @xmath51=[\\![1/\\varepsilon_{xx}]\\!]^{-1}[e_x]$ ] .",
    "schematic description of the polarization distributions in models a  ( a ) , b  ( b ) , c  ( c ) , and c  ( d ) within the first quadrant of the periodic cell , as functions of the polar coordinates @xmath52 . in ( a ) the @xmath53@xmath54 cartesian basis is uniform ; in ( b ) the polarization vectors are normal ( @xmath55 ) and tangential ( @xmath56 ) to the cylindrical element and constant along lines coming from the center ; in ( c ) and ( d ) the @xmath55 , @xmath56 polarizations are in general elliptic which enables their continuity.,width=491 ]    in this article we compare several models corresponding to different ff approaches .",
    "first , model  a assumes the solution in the basis of the @xmath53 and @xmath54 polarizations uniform within the periodic cell [ fig .",
    "[ fig : polarization](a ) ] , where in accordance with the ho method  @xcite we choose the laurent rules @xmath57 = [ \\varepsilon e_x ] = [ \\ ! [ \\varepsilon ] \\!][e_x],\\label{eq : laurent1}&\\\\   & { [ } \\tilde{d}_y ] = [ \\varepsilon e_y ] = [ \\ ! [ \\varepsilon ] \\!][e_y].\\label{eq : laurent2}&\\end{aligned}\\ ] ] the components of the electric impermittivity in eq .",
    "( [ eq : eigen ] ) then becomes @xmath58\\!]^{-1}$ ] for the cases of @xmath44 , @xmath59 , and zero for the cases of @xmath60 , @xmath61 , or @xmath62\\!]_{\\rm a } = \\left [ \\begin{array}{ll}[\\ !",
    "[ \\varepsilon ] \\!]^{-1 } & { [ \\![0]\\ ! ] } \\\\ { [ \\![0]\\ ! ] } & [ \\ ! [ \\varepsilon ]",
    "\\!]^{-1 } \\end{array}\\right].\\ ] ] in fig .",
    "[ fig : polarization](a ) we depict the uniform polarization basis within the first quadrant of the square periodic cell , @xmath63 , @xmath64 , where @xmath65 is the distance between the cell s center and its boundary ( a function of the polar coordinate  @xmath66 ) .",
    "we also denote @xmath67 the radius of the cylindrical element .      according to li  @xcite",
    "the laurent rule is valid ( for the reason of uniform convergence ) for multiplying functions that possess no concurrent discontinuities , whereas the inverse rule is used for functions whose product is continuous . obviously , neither the laurent rule nor the inverse rule is correct for both products in eqs .",
    "( [ eq : laurent1 ] ) and  ( [ eq : laurent2 ] ) , because both pairs of functions have concurrent discontinuities and both products @xmath33 and @xmath34 are discontinuous as well . on the other hand , by an appropriate change of the polarization bases at all points ( using a space - dependent jones matrix transform @xmath68 ) , @xmath69 = \\mathbf{f } \\left[\\begin{array}{l}e_u\\\\e_v\\end{array}\\right],\\ ] ] we can treat independently the normal ( @xmath70 ) and tangential ( @xmath71 ) components of the fields by the correct rules , @xmath72&=&[\\![1/\\varepsilon]\\!]^{-1}[e_u],\\label{eq : du1}\\\\   { [ } \\tilde{d}_v]&=&[\\![\\varepsilon]\\!][e_v].\\label{eq : dv1}\\end{aligned}\\ ] ] the field components @xmath73 , @xmath74 are normal to the discontinuities of the relative permittivity function , while @xmath75 , @xmath76 are tangential .",
    "the ff rules used in eqs .",
    "( [ eq : du1 ] ) and  ( [ eq : dv1 ] ) are justified simply because @xmath75 and @xmath74 are continuous .",
    "a suitable distribution of the matrix @xmath68 within the periodic cell can obviously be the rotation  @xcite @xmath77,\\ ] ] where the polar angle @xmath78 is in the first cell distributed according to the polar coordinates @xmath52 , and then periodically repeated over the entire 2d space .",
    "this enables defining the matrices @xmath79\\!]$ ] , @xmath80\\!]$ ] from the corresponding 2d - periodic functions @xmath81 , @xmath82 .",
    "distribution of the rotation and ellipticity of the basis polarization vector @xmath55 for the presented models .",
    "the rotation for models  b and  c is in ( a ) [ ( e ) for the hexagonal periodicity ] ; the ellipticity for model  c is in  ( b ) [ ( f ) for the hexagonal periodicity ] ; and the rotation and ellipticity for model  c are in ( c ) and  ( d ) , respectively .",
    "the color scales for both the rotation and the ellipticity are on the right ( in degrees ) .",
    "the structure discontinuities ( the circular boundaries of the periodic elements ) are plotted as black or white circles .",
    "notice that @xmath55 is always linear along and normal to the circle.,width=302 ]    let @xmath55 and @xmath56 be the two columns of the matrix @xmath68 , both being mutually orthogonal basis vectors of linear polarization  @xcite . from the above definitions we see that @xmath55 is a polarization vector normal to the structure discontinuities , whereas @xmath56 is tangential .",
    "in fig .  [",
    "fig : polarization](b ) we depict the distribution of the @xmath55@xmath56 basis within the first quadrant of the periodic cell ; the polarization vectors are constant along the lines of the constant azimuth ( @xmath83 ) and rotate as @xmath66 increases . the distribution of the rotation of @xmath55 within the square periodic cell is displayed in fig .",
    "[ fig : cells](a ) , from where it is obvious that the matrix function @xmath84 has no discontinuities concurrent with the electric field , so that we can use both laurent and inverse rules for the transformation of polarization , e.g. , @xmath85}\\\\{[e_y]}\\end{array}\\right ] = [ \\![\\mathbf{f}]\\!]\\left[\\begin{array}{c}{[e_u]}\\\\ { [ e_v]}\\end{array}\\right],&\\\\ & { [ \\![}\\mathbf{f}]\\ ! ] = \\left[\\begin{array}{cc}{[\\![c]\\ ! ] } & { [ \\![-s]\\!]}\\\\ { [ \\![s]\\ ! ] } & { [ \\![c]\\!]}\\end{array}\\right].&\\end{aligned}\\ ] ] combining eqs .",
    "( [ eq : du1 ] ) , ( [ eq : dv1 ] ) , and ( [ eq : f_transform ] ) yields @xmath86}\\\\{[e_y]}\\end{array}\\right ] = [ \\![\\mathbf{f}]\\ ! ] \\left[\\begin{array}{ll } { [ \\![\\frac{1}{\\varepsilon}]\\ ! ] } & { [ \\![0]\\!]}\\\\ { [ \\![0]\\ ! ] } & { [ \\![\\varepsilon]\\!]^{-1}}\\end{array}\\right ] { [ \\![\\mathbf{f}^{-1}]\\ ! ] } \\left[\\begin{array}{c}{[\\tilde{d}_x]}\\\\{[\\tilde{d}_y]}\\end{array}\\right],\\ ] ] from where we derive the electric impermittivity in the reciprocal space ( corresponding to model  b ) @xmath87\\!]_{\\rm b } & = & [ \\![\\mathbf{f}]\\ ! ] \\left[\\begin{array}{ll } { [ \\![\\frac{1}{\\varepsilon}]\\ ! ] } & { [ \\![0]\\!]}\\\\ { [ \\![0]\\ ! ] } & { [ \\![\\varepsilon]\\!]^{-1}}\\end{array}\\right ] { [ \\![\\mathbf{f}^{-1}]\\ ! ] }   \\nonumber \\\\ & = & \\left [ \\begin{array}{lr } { } [ \\![\\frac{1}{\\varepsilon}]\\!][\\![c^2]\\!]+[\\![\\varepsilon]\\!]^{-1}[\\![s^2]\\ ! ] , & [ \\![\\frac{1}{\\varepsilon}]\\!][\\![cs]\\!]-[\\![\\varepsilon]\\!]^{-1}[\\![cs]\\!]\\\\ { } [ \\![\\frac{1}{\\varepsilon}]\\!][\\![cs]\\!]-[\\![\\varepsilon]\\!]^{-1}[\\![cs]\\ ! ] , & [ \\![\\frac{1}{\\varepsilon}]\\!][\\![s^2]\\!]+[\\![\\varepsilon]\\!]^{-1}[\\![c^2]\\ ! ] \\end{array } \\right ] , \\label{eq : etab_detail}\\end{aligned}\\ ] ] whose components are immediately applicable to eq .",
    "( [ eq : eigen ] ) .",
    "the above approach ( model  b ) only deals with linear polarizations and thus suffers from the fact that the matrix function @xmath84 has a singularity at the center of the periodic cell and other discontinuities along the cell boundaries .",
    "this slows down the convergence of the numerical implementation , as will be evidenced below .    as suggested in the previous work for the case of diffraction by 2d gratings  @xcite",
    ", we can make @xmath68 continuous by using complex functions @xmath88 and @xmath89 or , in other words , by defining @xmath55 ,  @xmath56 as complex vectors corresponding to generally elliptic polarizations , @xmath90,\\quad   \\mathbf{v}=\\left[\\begin{array}{c}-\\zeta^\\ast\\\\ \\xi^\\ast \\end{array}\\right]\\ ] ] ( which are still orthogonal ) . by means of rotation  @xmath91 and ellipticity  @xmath92 we define the first basis vector @xmath93                         \\left[\\begin{array}{c}\\cos\\mathcal{e } \\\\",
    "i\\sin\\mathcal{e } \\end{array}\\right],\\ ] ] where @xmath94}{d(\\phi)-r}\\right\\ } & ( r > r ) .",
    "\\end{array}\\right.\\label{eq : cff : ellipticity}\\end{aligned}\\ ] ] here @xmath67 denotes the radius of the circular element and @xmath95 is the distance from the cell s center to its edge . in eq .",
    "( [ eq : cff : u1 ] ) the jones vector on the right represents a polarization ellipse ( with ellipticity  @xmath92 ) oriented along the @xmath2 coordinate , the matrix in the middle rotates this polarization by the azimuth  @xmath91 , and the factor  @xmath96 preserves the continuity of the phase at the center and along the boundaries of the cell . this continuity can be easily checked by evaluating the limits @xmath97,\\ ] ] which is the vector of left circular polarization ( independent of  @xmath66 ) .    the distribution of the @xmath55@xmath56 polarization basis within the first quadrant of the periodic cell is schematically depicted in fig .",
    "[ fig : polarization](c ) , where the azimuth of the polarization ellipse is constant along the lines coming from the cell s center , which is similar to model  b ; hence , fig .",
    "[ fig : cells](a ) serves for both model  b and model  c. however , the ellipticity is now zero ( corresponding to linear polarization ) only on the boundaries of the circular element , has the maximum value ( @xmath98 for circular polarization ) at the cell s center and along its boundaries , and continuously varies ( with a smooth sine dependence ) in the intermediate ranges [ fig .  [ fig : cells](b ) ] .",
    "finally we obtain a smooth and completely continuous matrix function @xmath84 , which is analogously used to calculate the impermittivity in the reciprocal space @xmath99\\!]_{\\rm c } = \\left [ \\begin{array}{lr } { [ \\![\\frac{1}{\\varepsilon}]\\!]}[\\![\\xi\\xi^\\ast]\\!]+{[\\![\\varepsilon]\\!]}^{-1}[\\![\\zeta\\zeta^\\ast]\\ ! ] , & { [ \\![\\frac{1}{\\varepsilon}]\\!]}[\\![\\xi\\zeta^\\ast]\\!]-{[\\![\\varepsilon]\\!]}^{-1}[\\![\\xi\\zeta^\\ast]\\!]\\\\ { [ \\![\\frac{1}{\\varepsilon}]\\!]}[\\![\\xi^\\ast\\zeta]\\!]-{[\\![\\varepsilon]\\!]}^{-1}[\\![\\xi^\\ast\\zeta]\\ ! ] , & { [ \\![\\frac{1}{\\varepsilon}]\\!]}[\\![\\zeta\\zeta^\\ast]\\!]+{[\\![\\varepsilon]\\!]}^{-1}[\\![\\xi\\xi^\\ast]\\ ! ] \\end{array } \\right].\\ ] ]    in the case of the hexagonal periodicity we define @xmath55 and the other periodic quantities inside one hexagon ( half the area of the rectangular unit cell ) where we can use formally the same equations as above , except for @xmath100},\\ ] ] which is now the distance from the hexagon s center to its edge . here",
    "@xmath5 is the hexagon s shortest width ( equal to the width @xmath101 of the rectangular cell ) .",
    "after periodic repeating over the entire 2d space , the azimuth and ellipticity distributions of the basis vector @xmath55 become those displayed in figs .",
    "[ fig : cells](e ) and  [ fig : cells](f ) , respectively .",
    "note that although the color distribution in fig .",
    "[ fig : cells](e ) is discontinuous along the hexagon s boundaries , the vector @xmath55 is actually continuous , because the color difference is only due to the @xmath102 change .",
    "moreover , the vector @xmath55 in the limit @xmath103 corresponds to left circular polarization , so that its azimuth becomes irrelevant .      to analyze a more complicated situation",
    ", we consider a phc with square periodicity where circular elements are densely arranged near each other , i.e. , where the radius @xmath67 is almost the half width @xmath104 of the periodic cell .",
    "then the convergence properties of @xmath68 becomes worse , which affects all the derived quantities .",
    "for this reason we again redefine the polarization distribution , as suggested in fig .",
    "[ fig : polarization](d ) . for the modified model  c",
    "we define @xmath55 to be still same inside the circle ( @xmath105 ) , but different outside . assuming the rotation and ellipticity along the boundary of the square cell @xmath106 ( where `` @xmath107 '' denotes rounding towards the nearest integer )",
    ", we define the rotation and ellipticity outside the circle ( @xmath108 ) as @xmath109\\cos { \\textstyle\\frac{\\pi[r+d(\\phi)-2r ] } { d(\\phi)-r } } \\right\\},\\\\   \\mathcal{e}(r,\\phi)&= & { \\textstyle\\frac{\\mathcal{e}_{\\rm b}(\\phi)}{2 } } \\left\\ { 1+\\cos{\\textstyle\\frac{\\pi[r+d(\\phi)-2r]}{d(\\phi)-r } } \\right\\}.\\end{aligned}\\ ] ] assuming otherwise the same eqs .",
    "( [ eq : impermittivity ] ) , ( [ eq : uv ] ) , ( [ eq : cff : u1 ] ) , and ( [ eq : d1 ] ) , we obtain for @xmath110\\!]_{\\rm c'}$ ] formally the same matrix as in eq .",
    "( [ eq : etac ] ) , except that the functions @xmath88 and  @xmath89 are now derived from different azimuth and ellipticity distributions of  @xmath55 [ displayed in figs .",
    "[ fig : cells](c ) and  [ fig : cells](d ) , respectively ] .",
    "note that @xmath55 is again continuous along the cell s boundaries ; to evaluate its precise limits [ when @xmath111 , @xmath112 or @xmath113 , @xmath114 is now more complicated .",
    "amplitude distribution of the scaled magnetic field @xmath115 within one cell of the real space for samples s1 ( a ) , s2 ( b ) and  h  ( c ) .",
    "the color scale , same for each sample , is in the top left corner of ( a ) .",
    "the subfigures represent eigenmodes distinguished by the symmetry point letters ( @xmath7 ,  x ,  m ) and band numbers ( 14 ) .",
    "the structure discontinuities ( boundaries of the rods or holes ) are plotted as white or black circles.,width=502 ]",
    "we examine the numerical performances of all the presented models on three samples of 2d phcs , for which we calculate the eigenfrequencies @xmath116 ( where the band number @xmath117 stands for the lowest eigenfrequency , @xmath118 for the second lowest , etc . ) and the corresponding eigenvectors @xmath50_\\kappa$ ] of eq .",
    "( [ eq : eigen ] ) .",
    "all convergences will be presented according to the maximum fourier harmonics retained inside the periodic medium ( @xmath119 , @xmath120 defined in appendix ) , which will be kept same for the @xmath2 and @xmath3 directions ( @xmath121 ) .",
    "first , sample  s1 is a square array of cylindrical rods of the circular cross - section with the diameter @xmath122  nm , square period @xmath123  nm , relative permittivity of the rods @xmath124 , and relative permittivity of the surrounding medium corresponding to vacuum ( @xmath125 ) . for clarity",
    "we display the first several eigenmodes at the points of symmetry @xmath7 , x , m in fig .  [",
    "fig : amplitudes](a ) .",
    "the color scale of the modes corresponds to the scaled amplitude distribution of the magnetic field @xmath115 within one cell of the real space ( calculated by model  c with @xmath126 ) .",
    "each eigenmode is denoted by the symmetry point letter and the band number ( e.g. , x2 denotes the second band at the point  x ) . by comparing the calculated eigenfrequencies and the amplitude distributions we find that the pairs of eigenmodes @xmath127@xmath128 and m2m3 constitute frequency doublets , i.e.",
    ", the frequencies for one pair are very close to each other ( differences are due to numerical errors ) .",
    "note that although the amplitudes @xmath115 of the two eigenmodes within a doublet seem identical [ e.g. , the doublet @xmath127@xmath128 in fig .",
    "[ fig : amplitudes](a ) ] , the two actual eigenmodes , which are complex - valued distributions @xmath129 , are indeed different , being two linearly independent eigenvectors of a degenerate eigenvalue .",
    "similarly , for sample  s2 we assume exactly the same parameters except the diameter of the rods , now being @xmath130  nm . this corresponds to densely arranged elements ( the distance between two adjacent rods is only 100  nm ) .",
    "the amplitude distributions for the same bands at the same symmetry points are displayed in fig .",
    "[ fig : amplitudes](b ) ( calculated by model  c with @xmath126 ) , where we again observe the frequency doublets in the same bands .",
    "finally , for sample  h we consider a hexagonal array of cylindrical holes of the circular cross - section with the diameter @xmath131  nm , hexagonal periodicity @xmath123  nm ( corresponding to the rectangular cell of the dimensions @xmath132 , @xmath133 ) , relative permittivity of the holes corresponding to vacuum ( @xmath134 ) , and relative permittivity of the substrate medium ( surrounding holes ) @xmath135 .",
    "since the lowest ( nonzero ) eigenfrequencies at the @xmath7 and k points are quite high , we confine ourselves only to the first three eigenmodes at the point  m , whose amplitude distributions ( within the rectangular cell ) are displayed in fig .",
    "[ fig : amplitudes](c ) .",
    "convergence properties of normalized eigenfrequencies ( @xmath136 ) calculated for selected bands of sample  s1 .",
    "the modes @xmath137 , @xmath127 are on the left part of the figure ; x1 , x4 in the middle ; and m2 , m4 on the right .",
    "the models a , b , and  c are compared to each other , plotted as crosses , squares , and circles , respectively.,width=491 ]      we carefully compared the numerical effectivity of the presented models for all the defined samples , and below we present the convergence results for selected bands .    for sample  s1 the difference among the performances of models a , b , and  c",
    "was found as follows : the values of model  b always converge much faster than those of model  a , which is a result expected from previous reports  @xcite .",
    "the values of model  c converge significantly faster than those of model  b for the modes @xmath127 , @xmath128 , x1 , x4 , and m2m4 .",
    "this can be explained by the discontinuities of the matrix function @xmath84 along the boundaries and at the center of the periodic cell , which are responsible for the gibbs phenomenon appearing in the partial fourier sums in eq .",
    "( [ eq : etab_detail ] ) . on the other hand , both models b and  c exhibit similar convergence properties for the modes @xmath137 , x2 , x3 , and  m1 , where the amplitude distribution has almost circular symmetry and is nearly zero near the cell s boundary [ fig .  [",
    "fig : amplitudes](a ) ] , so that the discontinuities do not manifest themselves .    a few examples of compared convergences are displayed in fig .",
    "[ fig : conv_square ] , where a considerable improvement owing to model  c is visible everywhere except for the @xmath137 mode .",
    "nevertheless , according to the scale of the frequency axis at the mode @xmath137 no improvement by model  c is necessary since model  b already yields the 5-digits precision .",
    "for the modes @xmath127 , x1 , and x4 the precision is improved by at least one order .",
    "convergence properties of normalized eigenfrequencies ( @xmath136 ) calculated for the modes m1 ( left ) , m2 ( middle ) , and m3 ( right ) of sample  h. the models a , b , and  c are plotted as crosses , squares , and circles , respectively.,width=491 ]    for sample  h the convergence of model  a is also much slower than those of models b and  c. in fig .",
    "[ fig : conv_hex ] the values of model  a are even beyond the displayed range of the graphs for the modes m2 and  m3 .",
    "model  c yields the best results for the modes m1 and  m2 . on the other hand , models b and  c",
    "converge similarly for the mode  m3 ; obviously a higher range of  @xmath120 would be required to compare the convergences more adequately .",
    "all the eigenmodes @xmath137@xmath128 , x1x4 , and m1m4 of sample  s2 were carefully analyzed with respect to the convergence properties of models a , b , c , and c. here the values of model  c , as expected , converge fastest for all the modes except m1 , whereas model  a is again the worst .",
    "the eigenmode of the mode m1 is again circularly symmetric and has negligible values near the cell s boundaries [ fig .",
    "[ fig : amplitudes](b ) ] , so that model  b is not affected by the discontinuities of the polarization transform and yields precise values . on the other hand , model  c",
    "is found inappropriate for this sample ( yielding even worse convergence than model  b ) because the rapid variation of the ellipticity of @xmath55 near the cell boundaries between two adjacent elements ( which are very close to each other ) requires more fourier components than the weak discontinuity of the linear polarization @xmath55 in model  b. this problem is removed in model  c , as obvious from figs .",
    "[ fig : polarization](d ) and  [ fig : cells](d ) .",
    "convergence properties of normalized eigenfrequencies ( @xmath136 ) calculated for the modes x1 ( left ) , x2 ( middle ) , and x3 ( right ) of sample  s2 .",
    "the models a , b , c , and  c are plotted as crosses , squares , circles , and triangles , respectively.,width=491 ]    three examples of convergences ( for the modes x1x3 ) are shown in fig .",
    "[ fig : conv_dense ] , which clearly justifies the suitability of model  c. notice again that the values of model  a are in two cases ( modes x1 and x2 ) beyond the displayed range of the graphs ( with error higher by about two orders ) . in the case of the mode",
    "x3 the values of model  a do not differ so much , which can be explained by nearly zero values of the eigenmode  x3 at all points of phc discontinuities , which is obviously not the case of the modes x1 and x2 [ fig .",
    "[ fig : amplitudes](b ) ] .",
    "we have derived three models with respect to different methods of applying the ff rules and compared their numerical performances .",
    "model  a ( equal to the ho method ) exhibits the worst convergence properties .",
    "model  b gives the best performance in a few cases where the eigenmode is circularly symmetric and has a negligible amplitude near the cell s boundaries ( then the problems coupled with polarization discontinuities vanish in zero fields ) .",
    "model  c was found to converge significantly faster than model  b for phcs without dense arrangement of elements . on the other hand , for dense phcs , where model  c was found inappropriate ,",
    "the best results were yielded by model  c , which combines the best properties of models b and  c. we can conclude that the method of ff with complex polarization bases , represented here by models c and  c , produces an enhancement of the pwe method , provided that we choose an appropriate distribution of the polarization basis according to the sample under study .",
    "the method can be straightforwardly generalized to phcs composed of elements of an arbitrary cross - section .",
    "it is possible by replacing the constant value of the element s radius  @xmath67 with a function  @xmath138 , and by a further generalization of the azimuth @xmath139 and ellipticity @xmath140 of the vector  @xmath55 to make it again normal to and linear at the element boundaries ( and continuous in the entire 2d space ) .",
    "moreover , the method can also be used to phc - based devices such as phc waveguides by applying the demonstrated methodology to the device supercell ( similarly as we were here dealing with the rectangular cell of the hexagonal phc ) .",
    "it is particularly advantageous for devices where high accuracy is required , e.g. , for analyzing defect modes near photonic band edges  @xcite , and for large devices for which the available computer memory enables calculations with only a few fourier harmonics , e.g. , phc - based fibers with large cladding .",
    "this work is part of the research plan msm 0021620834 financed by the ministry of education of the czech republic and was partially supported by a marie curie international reintegration grant ( no .",
    "224944 ) within the 7th european community framework programme and by the grant agency of the czech republic ( no .  202/09/p355 and p204/10/p346 ) .",
    "one of the authors ( r.a . )",
    "thanks koki watanabe and mathias vanwolleghem for fruitful discussions .",
    "here we follow the matrix formation procedures and notation as explained by visnovsky and yasumoto  @xcite .",
    "let @xmath141 be one component of the pseudo - periodic electric field inside the medium described by the 2d - periodic function @xmath142 .",
    "their fourier expansions are written @xmath143 we will here derive the matrix expressions of the fundamental relations @xmath144 i.e. , the relations of multiplication by a function and applying partial derivatives . assuming the expansions of the new functions @xmath145 we rewrite eqs .",
    "( [ eq : b : fund_h])([eq : b : fund_gy ] ) using the convolution rule , and applying the partial derivatives as follows : @xmath146 assuming furthermore a finite number of the retained fourier coefficients , i.e. , using the summation @xmath147 , we can renumber all the indices so that instead of a couple of two sets @xmath148 and @xmath149 we have a single set of indices @xmath150 , with @xmath151 , related @xmath152 where `` @xmath153 '' denotes the operation of integer division and `` @xmath154 '' the remainder ( the modulo operation ) .",
    "then we can rewrite eqs .",
    "( [ eq : b : fund_h2])([eq : b : fund_gy2 ] ) into the matrix relations @xmath155 & = & [ \\![\\varepsilon]\\!][f],\\\\ \\left[g_x\\right ] & = & -i\\mathbf{p}\\,[f],\\\\ \\left[g_y\\right ] & = & -i\\mathbf{q}\\,[f],\\end{aligned}\\ ] ] where @xmath156 $ ] , @xmath157 $ ] , @xmath158 $ ] , and @xmath159 $ ] are column vectors whose @xmath160th elements are the fourier @xmath161 $ ] elements of the functions @xmath162 , @xmath163 , @xmath164 , and @xmath165 , indexed by @xmath166 defined in eq .",
    "( [ eq : b : index_alpha ] ) , and where @xmath58\\!]$ ] , @xmath167 , and @xmath168 are matrices whose elements are defined @xmath169\\!]_{\\alpha\\beta } & = & \\varepsilon_{m(\\alpha)-m(\\beta),n(\\alpha)-n(\\beta)},\\\\ p_{\\alpha\\beta } & = & p_{m(\\alpha)}\\delta_{\\alpha\\beta},\\\\ q_{\\alpha\\beta } & = & q_{n(\\alpha)}\\delta_{\\alpha\\beta},\\end{aligned}\\ ] ] where the indices on the right hand parts are defined by eqs .",
    "( [ eq : b : index_n ] ) and  ( [ eq : b : index_m ] ) and where @xmath170 denotes the kronecker delta . as a summary we can say that the multiplication by a function is in the reciprocal space represented by the matrix  @xmath58\\!]$ ] ( in the sense of the limit @xmath171 ) , which is a generalization of the toeplitz matrix used for 1d periodicity , and that the partial derivatives are represented by the diagonal matrices  @xmath41 and  @xmath42"
  ],
  "abstract_text": [
    "<S> we demonstrate an enhancement of the plane wave expansion method treating two - dimensional photonic crystals by applying fourier factorization with generally elliptic polarization bases . by studying three examples of </S>",
    "<S> periodically arranged cylindrical elements , we compare our approach to the classical ho method in which the permittivity function is simply expanded without changing coordinates , and to the normal vector method using a normal  tangential polarization transform . </S>",
    "<S> the compared calculations clearly show that our approach yields the best convergence properties owing to the complete continuity of our distribution of polarization bases . </S>",
    "<S> the presented methodology enables us to study more general systems such as periodic elements with an arbitrary cross - section or devices such as photonic crystal waveguides . </S>",
    "<S> + @xmath0**published in optics express 18 [ 26 ] , 2751127524 ( 2010 ) * *    10    j.  d. joannopoulos , r.  d. meade , and j.  n. winn , _ photonic crystals : molding the flow of light _ </S>",
    "<S> ( princeton univ . , 1995 ) .    </S>",
    "<S> e.  yablonovitch , `` inhibited spontaneous emission in solid - state physics and electronics , '' phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 58 * , 20592062 ( 1987 ) .    k.  m. ho , c.  t. chan , and c.  m. soukoulis , `` existence of a photonic gap in periodic dielectric structures , '' phys </S>",
    "<S> . rev . </S>",
    "<S> lett . * 65 * , 31523155 ( 1990 ) .    </S>",
    "<S> j.  d. joannopoulos , p.  r. villeneuve , and s.  fan , `` photonic crystals : putting a new twist on light , '' nature ( london ) * 386 * , 143149 ( 1997 ) .    </S>",
    "<S> s .- y . </S>",
    "<S> lin , e.  chow , v.  hietala , p.  r. villeneuve , and j.  d. joannopoulos , `` experimental demonstration of guiding and bending of electromagnetic waves in a photonic crystal , '' science * 282 * , 274276 ( 1998 ) .    </S>",
    "<S> s.  noda , `` recent progresses and future prospects of two- and three - dimensional photonic crystals , '' j. lightwave technol . * 24 * , 45544567 ( 2006 ) .    </S>",
    "<S> j.  p. hugonin , p.  lalanne , t.  p. white , and t.  f. krauss , `` coupling into slow - mode photonic crystal waveguides , '' opt . </S>",
    "<S> lett . * 32 * , 26382640 ( 2007 ) .    </S>",
    "<S> s.  datta , c.  t. chan , k.  m. ho , and c.  m. soukoulis , `` effective dielectric constant of periodic composite structures , '' phys . </S>",
    "<S> rev . </S>",
    "<S> b * 48 * , 1493614943 ( 1993 ) .    </S>",
    "<S> f.  genereux , s.  w. leonard , h.  m. van driel , a.  birner , and u.  gosele , `` large birefringence in two - dimensional silicon photonic crystals , '' phys . </S>",
    "<S> rev . </S>",
    "<S> b * 63 * , 161101(r ) ( 2001 ) .    a.  a. krokhin , p.  halevi , and j.  arriaga , `` long - wavelength limit ( homogenization ) for two - dimensional photonic crystals , '' phys . </S>",
    "<S> rev . </S>",
    "<S> b * 65 * , 115208 ( 2002 ) .    </S>",
    "<S> e.  reyes , a.  a. krokhin , and j.  roberts , `` effective dielectric constants of photonic crystal of aligned anisotropic cylinders and the optical response of a periodic array of carbon nanotubes , '' phys . </S>",
    "<S> rev . </S>",
    "<S> b * 72 * , 155118 ( 2005 ) .    </S>",
    "<S> n.  skivesen , a.  tetu , m.  kristensen , j.  kjems , l.  h. frandsen , and p.  i. borel , `` photonic - crystal waveguide biosensor , '' opt . </S>",
    "<S> express * 15 * , 31693176 ( 2007 ) , http://www.opticsinfobase.org/oe/abstract.cfm?uri=oe-15-6-3169 .    </S>",
    "<S> i.  d. block , n.  ganesh , m.  lu , and b.  t. cunningham , `` sensitivity model for predicting photonic crystal biosensor performance , '' ieee sens . </S>",
    "<S> j. * 8 * , 274280 ( 2008 ) .    </S>",
    "<S> h.  kosaka , t.  kawashima , a.  tomita , m.  notomi , t.  tamamura , t.  sato , and s.  kawakami , `` superprism phenomena in photonic crystals , '' phys . rev . </S>",
    "<S> b * 58 * , r10096r10099 ( 1998 ) .    </S>",
    "<S> a.  a. krokhin and e.  reyes , `` homogenization of magnetodielectric photonic crystals , '' phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 93 * , 023904 ( 2004 ) .    </S>",
    "<S> h.  benisty , `` dark modes , slow modes , and coupling in multimode systems , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> b * 26 * , 718724 ( 2009 ) .    </S>",
    "<S> p.  vukusic and j.  r. sambles , `` photonic structures in biology , '' nature ( london ) * 424 * , 852855 ( 2003 ) .    </S>",
    "<S> s.  kinoshita and s.  yoshioka , `` structural colors in nature : the role of regularity and irregularity in the structure , '' chemphyschem * 6 * , 14421459 ( 2005 ) .    </S>",
    "<S> r.  petit ( ed . ) , _ electromagnetic theory of gratings _ </S>",
    "<S> ( springer , berlin , 1980 ) .    m.  neviere and e.  popov , _ light propagation in periodic media : diffraction theory and design _ ( marcel dekker , new york , 2003 ) .    </S>",
    "<S> d.  maystre , `` rigorous vector theories of diffraction gratings , '' prog </S>",
    "<S> . opt . * 21 * , 167 ( 1984 ) .    </S>",
    "<S> l.  li , `` use of fourier series in the analysis of discontinuous periodic structures , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 13 * , 18701876 ( 1996 ) .    </S>",
    "<S> l.  li , `` new formulation of the fourier modal method for crossed surface - relief gratings , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 14 * , 27582767 ( 1997 ) .    </S>",
    "<S> e.  popov and m.  neviere , `` grating theory : new equations in fourier space leading to fast converging results for tm polarization , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 17 * , 17731784 ( 2000 ) .    </S>",
    "<S> l.  li , `` reformulation of the fourier modal method for surface - relief gratings made with anisotropic materials , '' j. mod . opt . * </S>",
    "<S> 45 * , 13131334 ( 1998 ) .    </S>",
    "<S> b.  chernov , m.  neviere , and e.  popov , `` fast fourier factorization method applied to modal analysis of slanted lamellar diffraction gratings in conical mountings , '' opt . commun . * 194 * , 289297 ( 2001 ) .    k.  watanabe , r.  petit , and m.  neviere , `` differential theory of gratings made of anisotropic materials , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 19 * , 325334 ( 2002 ) .    k.  watanabe , `` numerical integration schemes used on the differential theory for anisotropic gratings , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 19 * , 22452252 ( 2002 ) .    </S>",
    "<S> l.  li , `` fourier modal method for crossed anisotropic gratings with arbitrary permittivity and permeability tensors , '' j. opt . </S>",
    "<S> a * 5 * , 345355 ( 2003 ) .    </S>",
    "<S> p.  boyer , e.  popov , m.  neviere , and g.  tayeb , `` diffraction theory in tm polarization : application of the fast fourier factorization method to cylindrical devices with arbitrary cross section , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 21 * , 21462153 ( 2004 ) .    </S>",
    "<S> n.  bonod , e.  popov , and m.  neviere , `` light transmission through a subwavelength microstructured aperture : electromagnetic theory and applications , '' opt . commun . * 245 * , 355361 ( 2005 ) .    </S>",
    "<S> n.  bonod , e.  popov , and m.  neviere , `` fourier factorization of nonlinear maxwell equations in periodic media : application to the optical kerr effect , '' opt . commun . * 244 * , 389398 ( 2005 ) .    </S>",
    "<S> a.  david , h.  benisty , and c.  weisbuch , `` fast factorization rule and plane - wave expansion method for two - dimensional photonic crystals with arbitrary hole - shape , '' phys . rev . </S>",
    "<S> b * 73 * , 075107 ( 2006 ) .    </S>",
    "<S> t.  schuster , j.  ruoff , n.  kerwien , s.  rafler , and w.  osten , `` normal vector method for convergence improvement using the rcwa for crossed gratings , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 24 * , 28802890 ( 2007 ) .    </S>",
    "<S> p.  gotz , t.  schuster , k.  frenner , s.  rafler , and w.  osten , `` normal vector method for the rcwa with automated vector field generation , '' opt . </S>",
    "<S> express * 16 * , 1729517301 ( 2008 ) , http://www.opticsinfobase.org/oe/abstract.cfm?uri=oe-16-22-17295 .    </S>",
    "<S> r.  antos , `` fourier factorization with complex polarization bases in modeling optics of discontinuous bi - periodic structures , '' opt . </S>",
    "<S> express * 17 * , 72697274 ( 2009 ) , http://www.opticsinfobase.org/oe/abstract.cfm?uri=oe-17-9-7269 .    </S>",
    "<S> r.  m.  a. azzam and n.  m. bashara , _ ellipsometry and polarized light _ </S>",
    "<S> ( north holland , amsterdam , 1997 ) .    </S>",
    "<S> s.  mahmoodian , c.  g. poulton , k.  b. dossou , r.  c. mcphedran , l.  c. botten , and c.  m. de sterke , `` modes of shallow photonic crystal waveguides : semi - analytic treatment , '' opt . </S>",
    "<S> express * 17 * , 1962919643 ( 2009 ) , http://www.opticsinfobase.org/oe/abstract.cfm?uri=oe-17-22-19629 .    </S>",
    "<S> s.  mahmoodian , r.  c. mcphedran , c.  m. de sterke , k.  b. dossou , c.  g. poulton , and l.  c. botten , `` single and coupled degenerate defect modes in two - dimensional photonic crystal band gaps , '' phys . </S>",
    "<S> rev . </S>",
    "<S> a * 79 * , 013814 ( 2009 ) .    </S>",
    "<S> k.  b. dossou , c.  g. poulton , l.  c. botten , s.  mahmoodian , r.  c. mcphedran , and c.  m. de sterke , `` modes of symmetric composite defects in two - dimensional photonic crystals , '' phys . </S>",
    "<S> rev . </S>",
    "<S> a * 80 * , 013826 ( 2009 ) .    </S>",
    "<S> s.  visnovsky and k.  yasumoto , `` multilayer anisotropic bi - periodic diffraction gratings , '' czech . j. phys . </S>",
    "<S> * 51 * , 229247 ( 2001 ) . </S>"
  ]
}