{
  "article_text": [
    "in recent years , there has been increasing interest in the optical properties of nanomaterials .",
    "nanostructured materials have potential applications in photovoltaics and photoelectrochemical cells@xcite as well as uses as optical sensors@xcite . quantum confinement and surface effects play a crucial role in the electronic properties of these materials@xcite , while their large number of atoms makes them much more challenging to treat with conventional electronic structure methods than their bulk counterparts .",
    "it is therefore vital to develop efficient ways of computing optical properties of large scale systems to high accuracy .",
    "time - dependent ( td ) density - functional theory ( dft)@xcite has become a very successful method in recent years in determining excitation energies and optical spectra of molecules and nanoclusters @xcite . for",
    "many commonly used approximations to the exchange - correlation functional , the energies of local excitations in a variety of systems are typically being predicted to within a few tenths of an ev , while non - local excitations are often significantly underestimated@xcite .",
    "tddft is appealing for large scale applications since it shows a greater flexibility in computational cost than more complicated many - body techniques like the @xmath0 approximation and the bethe salpeter equation @xcite . for local and semi - local exchange - correlation functionals , which already deliver a good description for excitations where the electron - hole interaction is not significant ,",
    "tddft is considerably cheaper computationally than many - body techniques .",
    "more sophisticated functionals , which come at greater computational cost , can recover the full solution to the bethe - salpeter equation@xcite , thus allowing a balance between accuracy and computational effort in tddft calculations .",
    "continuous improvement in tddft algorithms over recent years@xcite means that calculations on hundreds of atoms are now computationally feasible .",
    "however , even though tddft in many commonly used approximations to the exchange correlation functional is computationally cheaper than more advanced methods of calculating optical spectra , it still exhibits a cubic scaling behaviour with system size in conventional implementations , putting a severe limitation on the system sizes that can be studied . in ground - state calculations with density - functional theory ( dft)@xcite , the development of _ linear - scaling _ methods@xcite has been specifically aimed at enabling the treatment of large scale systems with up to hundreds of thousands of atoms@xcite .",
    "linear - scaling dft calculations have been performed on large biomolecules and nanoparticles@xcite .",
    "thus ideally , one would like to extend the ideas of linear scaling which have proved to be so successful in ground state dft to excited state calculations in tddft .",
    "fully linear - scaling formulations of tddft have been known for almost a decade @xcite .",
    "however , these formulations rely on propagating the td kohn - sham equations explicitly in time . the time - dependent response of the system to an external field can be determined at any instance , which , after a fourier transform into the frequency domain , contains information about the frequency dependent - response and thus the optical spectrum @xcite . to ensure stability of the solution , the time step to integrate the td kohn - sham equations is chosen to be quite small ( typically of the order of @xmath1 fs ) and thus the number of time steps required to obtain a meaningful spectrum becomes prohibitively large for many practical applications@xcite .",
    "furthermore , in time domain tddft implementations , one loses any explicit information on individual excitations , as well as the ability to compute dipole - forbidden states . only the spectrum as a whole",
    "can be resolved @xcite .    for many of the applications mentioned above , one is mainly interested in the low energy optical response of the system , with energies in the region of visible and low energy ultraviolet light .",
    "additionally , properties of individual excitations such as oscillator strengths and response density distributions are important for analysing the spectrum and optimising spectral response for specific applications .",
    "a method which lends itself naturally to computing low energy excitations of a system is the linear response formalism @xcite , in which the tddft equations are cast into an effective eigenvalue equation that can be solved for its lowest eigenvalues @xcite .",
    "this formalism can also be made linear scaling @xcite , making it ideal for the large scale nanostructured systems we have in mind .    in this paper , we present a fully linear - scaling implementation of tddft in the linear response formalism , suitable for calculating the low energy excitation energies and spectrum of large systems",
    ". we will first give a brief overview of both linear - scaling dft in the @xmath2 code @xcite ( section [ chapter_onetep ] ) and linear response tddft ( section [ chapter_linear_response ] ) , mentioning only features that are important for our formalism .",
    "we will then present an outline of various aspects of the linear - scaling tddft formalism , making use of a double representation approach to represent the occupied and unoccupied kohn - sham space ( sections [ chapter_linear_scaling]-[chapter_unocc ] ) .",
    "we will present results on a number of test systems ( sections [ chapter_pentacene]-[chapter_chlorophyll ] ) , as well as a demonstration of the linear scaling of the computational effort with system size ( sections [ chapter_nanorod ] and [ chapter_nanotube ] ) .",
    "our conclusions are summarised in section [ chapter_conclusion ] .",
    "all linear - scaling dft formalisms are developed around the idea of exploiting nearsightedness@xcite : this principle states that for any system with a band gap , the single particle density matrix decays exponentially with distance @xcite .",
    "a variety of different linear scaling methods based on this principle have been developed in recent years and have been reviewed extensively @xcite .    in @xmath2",
    "the density matrix is expressed through a set of optimisable localised functions @xmath3 referred to as nonorthogonal generalised wannier functions ( ngwfs ) @xcite .",
    "the ngwfs are expanded in an underlying basis of periodic sinc functions ( psincs ) @xcite equivalent to a set of plane waves .",
    "the density matrix is then written in separable form @xcite @xmath4 where we assume an implicit summation over repeated greek indices . in the following sections",
    ", we will use latin indices to denote objects in the canonical representation and greek indices to denote objects involving the localised set of functions , while subscripts and superscripts in curly brackets are labels , rather than free indices .",
    "thus , @xmath5 are the elements of the valence density matrix in the representation of duals of ngwfs .",
    "locality is imposed through a spatial cutoff on the density matrix and a strict localisation of the ngwfs .",
    "the total energy of the system is minimised both with respect to the density matrix and the ngwfs .",
    "the underlying psinc basis of the ngwfs allows the method to achieve an accuracy equivalent to plane - wave methods @xcite .",
    "the _ in situ _ optimisation of the ngwfs during the calculation ensures that only a minimal number of @xmath3 are needed to span the occupied subspace .    in a @xmath2 calculation",
    ", there is no reference to individual kohn - sham eigenstates in their canonical representation .",
    "eigenstates can be obtained in a post - processing step by a single diagonalisation of the dft hamiltonian in ngwf representation . due to the minimal size of the set of ngwfs needed to represent the occupied subspace ,",
    "this diagonalisation is generally cheap , but does not scale linearly with system size .",
    "occupied states are accurately represented by @xmath3 , however , unoccupied states are reproduced increasingly poorly with increasing energy @xcite . in general",
    ", the specific optimisation of @xmath3 in order to represent the occupied space leads to poor representation of the conduction space manifold .",
    "this shortcoming was addressed recently @xcite in a method where a second set of ngwfs @xmath6 is optimised in a non - self - consistent calculation following the determination of the ground - state .",
    "the method uses a hamiltonian that projects out the occupied states and minimises the energy with respect to a second conduction density matrix @xmath7 and the set of ngwfs @xmath6 in order to represent the low energy subspace of the conduction manifold .",
    "the conduction density matrix is then expressed using the conduction ngwfs : @xmath8 here , we use the subscript @xmath9 to denote conduction kohn - sham states and @xmath10 to denote the number of kohn - sham conduction states that @xmath7 is optimised to represent .",
    "the optimisation of both @xmath7 and @xmath11 scales linearly with system size . as in the ground - state calculation",
    ", the individual kohn - sham eigenstates can be calculated from a single diagonalisation of the hamiltonian in conduction ngwf representation if needed .",
    "the obtained conduction states are shown to be in excellent agreement with traditional plane - wave dft implementations@xcite .",
    "thus the ngwf approach allows the representation of both the occupied space and a low energy subset of the unoccupied space to plane - wave accuracy using two independently optimised sets of localised functions .",
    "the underlying psinc basis allows for a systematic improvement of the ngwfs and the individual optimisations ensure that only a minimal set of @xmath3 and @xmath6 have to be used in order to represent the valence and conduction space .",
    "in contrast to methods making use of a single set of localised orbitals , the double ngwf approach also allows for keeping a strict localisation on @xmath3 representing the valence space , while for @xmath6 a larger localisation radius can be chosen .",
    "these features make the conduction and valence ngwfs ideal for the application to the linear response tddft formalism , provided only low energy excitations are of interest .",
    "the main limitation of the ngwf representation is that the localised functions @xmath12 do not form a very natural representation of high energy delocalised and unbound conduction states .",
    "this limitation however is generally shared with other localised basis set methods and we expect the ngwf representation to perform no worse for these states than gaussian basis sets , with the advantage that the set of @xmath12 is significantly smaller in size .      in recent years , a number of reviews on different aspects of tddft have been published@xcite . in general",
    ", one differentiates between two main formalisms : the linear response formalism , which can be cast into an effective eigenvalue equation and the time propagation formalism , in which the time - dependent kohn - sham equations are propagated explicitly .",
    "linear response tddft has become the method of choice for calculating low energy excitations and spectra and is now widely used @xcite . in the linear response regime , the excitation energies can be expressed as the solution to the eigenvalue equation @xcite    @xmath13    where the elements of the block matrices @xmath14 and @xmath15 can be expressed in canonical kohn - sham representation as @xmath16 here , @xmath9 and @xmath17 denote kohn - sham conduction and valence states and * k * is the coupling matrix with elements given by @xmath18   \\\\",
    "\\times \\psi^{\\textrm{\\scriptsize{ks}}*}_{c}(\\textbf{r})\\psi^{\\textrm{\\scriptsize{ks}}}_{v}(\\textbf{r})\\psi^{\\textrm{\\scriptsize{ks}}*}_{v'}(\\textbf{r}')\\psi^{\\textrm{\\scriptsize{ks}}}_{c'}(\\textbf{r}').\\end{aligned}\\ ] ] in the above expressions , we have omitted all spin indices for convenience and are limiting ourselves to the calculation of singlet states only .",
    "furthermore , the coupling matrix is taken to be static , a simplification that is known as the adiabatic approximation .",
    "@xmath19 is the exchange - correlation energy and its second derivative , evaluated at the ground - state density @xmath20 of the system , is known as the tddft exchange - correlation kernel . as in ground state dft",
    ", its exact functional form is not known .",
    "a commonly made choice is to use @xmath21 , which is known as the adiabatic local density approximation ( alda ) .",
    "a further simplification to the tddft eigenvalue equation can be achieved by making use of the tamm - dancoff approximation ( tda ) @xcite . in this approximation , we assume the off - diagonal coupling matrix elements @xmath22 to be small .",
    "the matrix equation then simply reduces to @xmath23 a matrix eigenvalue problem of half the size of the original one .",
    "more crucially , the tddft eigenvalue equation in the tda is hermitian , while the original equation is not @xcite .",
    "generally speaking , the tda gives good excitation energies but violates oscillator strength sum rules @xcite .",
    "however , due to its hermitian properties , the tda lends itself to solutions involving standard matrix eigenvalue solvers and will therefore be considered for the rest of this work .    in principle",
    ", the matrix @xmath14 can be built explicitly and eq .",
    "[ eval_eqn ] can be diagonalised to give all excitation energies of the system .",
    "clearly , this is not possible with linear scaling effort , as the dimensions of @xmath14 grow as @xmath24 with system size and the matrix is not sparse in the canonical representation . since every matrix element involves a double integral over product kohn - sham states , constructing @xmath14 scales as @xmath25 .",
    "however , in the limit of large systems when one is only interested in a comparatively small number of eigenvalues , it is much more advantageous to use iterative methods instead of direct diagonalisation to calculate the eigenvalues of @xmath14 . in order to do",
    "so one needs to define the action of @xmath14 on an arbitrary trial vector @xmath26 . following the formalism introduced by hutter @xcite we define @xmath27 where @xmath28 is the first order response density associated with the trial vector @xmath26 . defining the self - consistent field potential @xmath29 as a reaction to the response density as @xmath30 the action * q * of the tddft operator @xmath14 on the arbitrary trial vector * x * can be simply written as @xmath31 here , @xmath32 is given by @xmath33 one",
    "can then express the lowest excitation energy @xmath34 of a system in terms of @xmath35 @xmath36 which can be minimised variationally with respect to @xmath26 .    the formulation of the lowest tddft eigenvalue in terms of a variational principle as outlined in eq .",
    "[ omega_canonical ] is only valid in the tamm - dancoff approximation , as it requires the tddft eigenvalue matrix to be hermitian .",
    "however , the full non - hermitian tddft eigenvalue matrix consists of blocks of hermitian matrices and exploiting this structure , a more generalised version of the variational principle of eq .",
    "[ omega_canonical ] can be formulated @xcite .",
    "while it is beyond the scope of this paper , we point out that the linear - scaling tddft method developed in the next sections can be readily extended to the full tddft eigenvalue equation by making use of the generalised version of the variational principle .",
    "although the approach above is outlined in the canonical representation , it can be reformulated in terms of local orbitals or other basis functions . in many quantum chemistry codes",
    ", @xmath37 is constructed in a gaussian basis set representation , making use of highly optimised methods to perform four centre gaussian integrals @xcite .",
    "plane wave implementations typically make use of a mixed representation of canonical orbitals for the occupied states and plane waves for the virtual states @xcite .",
    "the main advantage of all these iterative methods is that no explicit construction , storage and diagonalisation of @xmath14 is required , which is prohibitive for large system sizes .",
    "however , the different basis set implementations mentioned above still make reference to individual kohn - sham states , thus calculating @xmath38 still shows an asymptotic scaling of @xmath39 with system size . to improve the scaling",
    ", one has to avoid any reference to the canonical representation@xcite .",
    "@xmath2 provides a set of optimised ngwfs @xmath11 spanning the low energy conduction space and @xmath40 spanning the valence space .",
    "together , they form a suitable representation to expand quantities like @xmath41 and @xmath42 . in the following section , for all expressions including the sets of localised ngwfs",
    ", we will differentiate between covariant and contravariant quantities by using lower and upper case greek indices respectively . for quantities involving the canonical kohn - sham states ,",
    "this differentiation is unneccessary since the kohn - sham orbitals form an orthogonal basis . for a more in depth treatment of tensors in electronic structure theory ,",
    "see @xcite .",
    "the kohn - sham orbitals are used in this section to derive the appropriate expressions in ngwf representation , as well as to highlight the equivalence to the canonical representation .",
    "note however , that there is no explicit reference to the canonical representation in the final expressions .",
    "starting with the response density , we can write @xmath43 here , the sum of the conduction states goes over all the states for which @xmath11 was optimised .",
    "we have again assumed an implicit summation over repeated greek indices . in principle , one has to sum over an infinite number of conduction states .",
    "however , for the lowest few optical energies in the system , @xmath41 is well described by a relatively small number of unoccupied states .",
    "this approximation can be rigorously tested by including a larger subset of the conduction space manifold in the optimisation of the conduction density matrix @xmath7 . in the spirit of the linear scaling dft formalism the above expression can be rewritten as @xmath44 where the effective response density matrix @xmath45 is defined as @xmath46 the above definition is analogous to the definitions of the valence and conduction density matrices in ngwf representations , where @xmath47    eq .",
    "[ kernel ] defines the full response density matrix in mixed conduction - valence ngwf representation .",
    "each tddft excitation energy can be written as a functional of a specific response matrix and thus @xmath48 plays the same role in the linear - scaling linear response formulation as the eigenvector * x * does in the canonical formulation outlined in the previous section .",
    "similarly to the response density , @xmath32 can be rewritten as @xmath49 furthermore , the diagonal part of @xmath35 consisting of kohn - sham conduction - valence eigenvalue differences becomes : @xmath50 it is now convenient to introduce a shorthand notation for the matrix elements of different quantities in terms of the different types of ngwfs .",
    "we denote the kohn - sham hamiltonian in conduction and valence ngwf representations as @xmath51 and @xmath52 respectively and the self consistent field response in mixed conduction - valence ngwf representation as @xmath53 : @xmath54    by inserting eq .",
    "[ diag_part ] and eq .",
    "[ scf_part ] into eq .",
    "[ y_canonical ] , multiplying with @xmath55 and @xmath56 from the left and right respectively and summing over the @xmath9 and @xmath17 indices , one can remove all references to the canonical representation from @xmath38 . using the definition of the response density matrix @xmath48",
    ", the result of the tddft operator acting on a trial response matrix @xmath48 in ngwf representation reduces to the simple form @xmath57    note that in the linear - scaling formalism employed in @xmath2 , @xmath51 , @xmath52 , @xmath7 , @xmath58 and @xmath53 are all sparse matrices for sufficiently large system sizes @xcite .",
    "furthermore , the response potential @xmath59 is a functional of the response density only .",
    "constructing @xmath41 from eq .",
    "[ response_dens_eq ] only requires information from density matrix elements @xmath45 for which @xmath60 and therefore scales linearly with system size even for fully dense @xmath48 . evaluating @xmath29 from eq .",
    "[ vscf_defined ] also scales linearly for any semi - local exchange - correlation functional . thus constructing @xmath53 scales linearly with system size for fully dense @xmath48 .",
    "however , in evaluating the matrix operations in eq .",
    "[ operator ] , linear scaling can only be achieved if the response density matrix is truncated , just like the density matrix in linear - scaling dft .",
    "if this truncation can be performed , the response density matrix becomes sparse for sufficiently large systems and evaluating the action of the tddft operator on an arbitrary response matrix @xmath48 scales linearly with system size .",
    "using the action of the tddft operator in ngwf representation defined in equation [ operator ] , one can then rewrite the lowest excitation energy of the system as @xmath61}{\\textrm{tr}\\left[\\textbf{p}^{\\{1\\}\\dagger}\\textbf{s}^{\\chi}\\textbf{p}^{\\{1\\}}\\textbf{s}^\\phi\\right]}\\right\\}.\\ ] ] here , @xmath62 and @xmath63 denote the conduction and valence ngwf overlap matrices given by @xmath64 and @xmath65 . using the definitions of the involved quantities , as well as the invariance of the trace operation under cyclic permutation , it is trivial to show that eq .",
    "[ functional_ngwf ] is equivalent to eq .",
    "[ omega_canonical ] in the canonical representation .",
    "once the minimum excitation energy has been calculated through the variational principle of eq .",
    "[ functional_ngwf ] , its related oscillator strength ( in atomic units ) can be calculated as @xmath66    while in the above discussion on the linear scalability of calculating @xmath67 we have assumed semi - local exchange - correlation kernels , the formalism is equally valid for hybrid functionals . for hybrid functionals ,",
    "one can split @xmath37 into @xmath68 containing the local part of the functional and @xmath69 containing the fraction of exact exchange .",
    "@xmath68 can be evaluated trivially in linear - scaling effort , while the expression for @xmath69 reduces to @xmath70 where @xmath71 denotes the fraction of hartree - fock exchange .",
    "we note that eq .",
    "[ hf_exchange ] is closely related to a term that needs to be evaluated in ground state dft using hybrid functionals , where it can be calculated in linear - scaling effort @xcite .",
    "thus the evaluation of the action @xmath67 can be made to scale linearly with system size even for hybrid exchange - correlation kernels .      in order to calculate the @xmath72 lowest excitation energies of a system with response density matrices @xmath73 and corresponding @xmath74 , we define the function @xmath75}{\\textrm{tr}\\left[\\textbf{p}^{\\{1\\}^\\dagger}_i\\textbf{s}^{\\chi}\\textbf{p}^{\\{1\\}}_i\\textbf{s}^\\phi\\right]}\\right]\\ ] ] which can be minimised with respect to @xmath76 under the constraint @xmath77=\\delta_{ij}.\\ ] ] again using the expression for @xmath76 and the invariance of the trace under cyclic permutations , it is clear that the above constraint is equivalent to the requirement that eigenvectors of the canonical tddft eigenvalue problem ( eq . [ eval_eqn ] ) are orthonormal to each other .",
    "when @xmath78 is minimised , @xmath79 span the same subspace as the @xmath72 lowest eigenvectors of the tddft operator * a*. in this work , the minimisation of @xmath78 is achieved using a conjugate gradient algorithm with gram - schmidt orthonormalisation .",
    "differentiating @xmath78 with respect to @xmath80 one can find the ( covariant ) gradient orthogonal to all current ( contravariant ) trial response matrices @xmath81",
    "@xcite @xmath82 ( s^{\\chi})_{\\alpha\\gamma}(p^{\\{1\\}}_{j})^{\\gamma\\delta}(s^{\\phi})_{\\delta\\beta}\\end{aligned}\\ ] ] operating on the left and right with the inverse conduction and valence overlap matrices , the covariant gradient can be transformed into a contravariant gradient @xmath83 ( p^{\\{1\\ } } _ { j})^{\\alpha\\beta}\\end{aligned}\\ ] ] which can be used as a steepest descent search direction for a conjugate gradient algorithm .",
    "the exact form of the conjugate gradient algorithm used here has been outlined elsewhere @xcite ( with the difference that we do not make use of any preconditioner ) .",
    "here we just focus on how to choose a suitable starting guess for @xmath84 . since we do not have individual kohn - sham states available in the linear scaling formalism of the ground state calculation , we can not initialise @xmath80 to conduction - valence product kohn - sham states close to the band gap , which would otherwise form reasonable starting guesses .",
    "instead we initialise the set of @xmath85 to random starting configurations ( for other possible initialisation schemes , see @xcite ) . however , from eq .",
    "[ kernel ] it can be seen that any valid response density matrix must be invariant under the operation @xmath86 this operation can be understood as a projection into conduction and valence kohn - sham states in their ngwf representation .",
    "response density matrices that violate invariance under this projection contain elements that would correspond to forbidden transitions between two occupied or two unoccupied states , or contain contributions from unoptimised and thus badly represented high energy conduction states .",
    "the invariance requirement follows from an expansion of the density matrix idempotency constraint to first order for a given perturbation@xcite and must thus be fulfilled for all first order response density matrices .",
    "the need to enforce the idempotency constraint explicitly via the projection of eq .",
    "[ invariance ] can be viewed as the price to be paid for moving away from a formulation involving the canonical representation .",
    "the invariance requirement can be enforced by projecting the starting guess response matrices with @xmath87 and @xmath88 from the left and the right respectively . from eq .",
    "[ operator ] it can be seen that @xmath67 , the result of the tddft operator acting on a valid trial response density matrix , automatically shows the same invariance property as @xmath48 .",
    "therefore all gradients @xmath89 constructed using a valid set of @xmath90 obey the invariance requirement by construction .",
    "thus , every conjugate gradient derived from @xmath89 will have the specified invariance property and updating a valid response matrix with a gradient will preserve the invariance of that matrix under the projection ( eq . [ invariance ] ) .",
    "the orthogonality condition of eq .",
    "[ ortho ] is enforced using a gram - schmidt procedure , which has a nominal scaling of o(n@xmath91 , with @xmath92 and @xmath93 being the number of conduction and valence ngwfs respectively .",
    "both @xmath92 and @xmath93 grow as @xmath94 with system size , giving an overall scaling of @xmath24 with system size for the orthonormalisation procedure .",
    "however , if @xmath48 is truncated and thus sparse , the scaling of the gram - schmidt orthonormalisation reduces to @xmath94 , with a prefactor dependent on the square of the number of excitation energies @xmath95 .    thus , the whole algorithm outlined above scales linearly in memory with the number of excitation energies @xmath72 to solve for .",
    "since the @xmath72 individual resonse density matrices @xmath90 have to be kept orthogonal to each other using a gram - schmidt procedure , the asymptotic scaling of computational cost with the number of excitation energies is @xmath96 .",
    "however , for a fixed number of states required , the algorithm scales as @xmath94 with system size in both memory requirements and computational cost .",
    "since the algorithm developed in the previous sections only exhibits true linear - scaling properties if all involved density matrices @xmath58 , @xmath7 and @xmath48 can be truncated , one has to justify that the truncations are indeed possible .",
    "the truncation of @xmath58 originates from the nearsightedness principle @xcite and forms the basis of any linear - scaling dft implementation . in insulating systems",
    ", @xmath58 can be shown to decay exponentially with distance@xcite .",
    "for the conduction states , @xmath7 is only expected to exhibit an exponential decay if there is a second energy gap in the conduction band and @xmath7 spans the manifold of conduction states between the two bandgaps . in this case , the same argument to show exponential decay of the ground - state density matrix can be applied to @xmath7 @xcite .",
    "furthermore , by the same argument , the joint density matrix spanning the manifold defined by both @xmath58 and @xmath7 must be exponentially localised .",
    "the joint density matrix can be written as a block diagonal matrix with @xmath58 and @xmath7 as its diagonal entries .",
    "any response density matrix @xmath48 due to the application of a small perturbation described in this work corresponds to the off - diagonal blocks of said joint density matrix .",
    "however , the application of a small perturbation can not break the disentanglement of the joint manifold of @xmath58 and @xmath7 from the rest of the conduction manifold and thus can not break the exponential localisation of the joint block density matrix .",
    "the joint block density matrix can only be exponentially localised if all its constituent blocks are exponentially localised .",
    "we thus conclude that , in the special case described here , the tddft response density matrix @xmath48 is indeed expected to be exponentially localised .    the desired property of exponential localisation of the conduction density matrix and thus of the response density matrix",
    "can most likely be realised in 1d systems and molecular crystals , where the bands show little dispersion .",
    "however , it is evident from the above considerations that one can not present a generalised argument that @xmath48 can be truncated for all systems .",
    "this limitation is not unique to the linear response formulation of tddft presented here , but applies to linear - scaling time domain tddft as well , where the time - dependent response density matrix is truncated without a general formal justification .",
    "it was however noted by yam _ et al_.@xcite and chen _",
    "et al_.@xcite , that for a number of systems studied the first order response density matrix retained the localisation of the ground - state density matrix to a good degree and thus could be truncated . in general , we expect this finding to be true for the relatively localised excited states of a variety of systems . whether a truncation of @xmath48 can be achieved for very delocalised high - energy excitations",
    "is doubtful .",
    "however , since the method presented here is mainly aimed at low energy excitations of large systems , we expect that the truncation of both @xmath97 and @xmath48 can indeed be carried out in practice for a certain class of systems and a linear scaling of computation time with system size can be achieved .",
    "truncation of @xmath48 adds an additional complication to the algorithm in that the invariance relation of eq .",
    "[ invariance ] only holds approximately .",
    "thus the gradient @xmath98 derived from a truncated @xmath48 only approximately preserves the invariance property and the accumulation of errors can lead to instabilities in the convergence . to measure the variations of @xmath48 from valid response matrices obeying the projection operation of eq .",
    "[ invariance ] , we define the positive - semidefinite norm @xmath99 $ ] : @xmath100=\\textrm{tr}\\left[\\left(\\textbf{p}^{\\{1\\}\\dagger}\\textbf{s}^{\\chi}\\textbf{p}^{\\{1\\}}\\textbf{s}^{\\phi}-\\textbf{p}^{\\{1\\ } ' \\dagger}\\textbf{s}^{\\chi}\\textbf{p}^{\\{1\\}'}\\textbf{s}^{\\phi } \\right)^2\\right]\\ ] ] where @xmath101 is constructed by applying the projections @xmath87 and @xmath88 to @xmath48 from the left and right respectively , enforcing that the resulting matrix @xmath101 has the same sparsity pattern as @xmath48 . for fully dense matrices @xmath48 initialised in the way described in the previous section , @xmath99 $ ] vanishes to numerical accuracy .",
    "for truncated response density matrices , @xmath99 $ ] can be forced to remain smaller than some threshold by iteratively applying the projection of eq .",
    "[ invariance ] to @xmath48 after each tddft iteration , thus stabilising the algorithm .",
    "the purpose of the algorithm described in this work is to enable the calculation of excitations that mainly consist of kohn - sham transitions into well - bound unoccupied states and are well described by @xmath11 and @xmath97 .",
    "however , even low energy excitations largely made up of well bound kohn - sham transitions often have significant contributions from high energy conduction states and including these unoccupied states in the calculation becomes important to achieve convergence .",
    "while in principle it is always possible to optimise @xmath11 for a larger number of unoccupied states , it is in practice not desirable to attempt to achieve a precise description of very delocalised , unbound states within a framework of localised orbitals .",
    "optimising @xmath12 for high energy conduction states generally comes at the cost of an increased ngwf localisation radius , which leads to a decrease of computational efficiency .",
    "a more efficient approach is to optimise @xmath11 for the subset of bound , low energy conduction states that form the most important contributions to the low energy excitations and to include the unbound continuum states in an approximate fashion . in order to do so , we redefine the conduction density matrix as a projector onto the entire unoccupied subspace : @xmath102 here , @xmath103 , the cross - overlap matrix between the two sets of ngwfs , and @xmath11 is specifically optimised for a low energy , well - bound subspace of the unoccupied space .",
    "we notice that under the above redefinition , @xmath97 is only strictly idempotent if @xmath104 is complete , a condition that is never realised in practice . thus initialising @xmath48 in the manner described in [ chapter_algorithm ] no longer guarantees for the invariance relation in eq .",
    "[ invariance ] to be met , even if no density matrix truncation is applied . to stabilise the convergence of the algorithm , the invariance projection in eq .",
    "[ invariance ] has to be applied iteratively to @xmath48 after each tddft conjugate gradient iteration in order to keep @xmath99 $ ] below a certain threshold .",
    "in this section , we will assess the performance of the method outlined above , as implemented in the @xmath2 code . in section [ chapter_pentacene ]",
    "we perform a detailed comparison of our method with well established conventional tddft codes , demonstrating the accuracy of the approach introduced here . in [ chapter_fullerene ]",
    "we demonstrate the scaling of the method with respect to the number of excitations converged , while [ chapter_chlorophyll ] contains a comparison with experimental data . in [ chapter_nanorod ]",
    "we show the behaviour of the method under the truncation of the response density matrix . finally ,",
    "in [ chapter_nanotube ] we demonstrate that the method does scale fully linearly with system size .    unless specified otherwise , all calculations are carried out using the lda exchange correlation functional for the ground - state dft calculations and alda for the tddft calculations , both in the perdew - zunger parameterisation@xcite .",
    "norm conserving pseudopotentials@xcite are used throughout this work . unless specified otherwise , the localisation region for conduction and valence ngwfs were chosen by converging the conduction energy and ground state energy with respect to the conduction and valence ngwf radii .      as the first test system we chose pentacene ( c@xmath105h@xmath106 ) , as its moderate size allows for detailed comparisons to traditional tddft methods .",
    "the simulation box was chosen to be @xmath107 and the kinetic energy cutoff was 750 ev .",
    "the atomic positions were optimised at the lda level@xcite . in order to assess the accuracy of the tddft method we first performed a calculation in which the unoccupied subspace was limited",
    "to only contain states for which @xmath104 was specifically optimised .",
    "for this calculation , a minimal set of 1 ngwf per h and 4 ngwfs per c atom was chosen for both the occupied and the unoccupied state representations .",
    "the ngwf radius for both valence ngwf species was chosen to be @xmath108 , while @xmath109 was chosen for the conduction ngwfs .",
    "the conduction density matrix was optimised for the 10 lowest unoccupied states , covering all of the bound unoccupied states .",
    "this put the dimensions of the tddft operator at @xmath110 in a canonical representation and @xmath111 in a representation of conduction and valence ngwfs .",
    "the results obtained were compared to a calculation performed using the octopus code @xcite ( modified to allow for calculations within the tamm - dancoff approximation ) . for the octopus calculation , a grid spacing of @xmath112 , equivalent to the onetep grid , was used , while the basis was defined on this grid as the union of atom centered spheres with a radius of @xmath113 .",
    "the calculation was performed using the casida calculation mode within the tamm - dancoff approximation and the number of unoccupied states was limited to 10 in order to ensure a very high level of convergence for these states . for the 10 lowest excited states , we found a good agreement between the two methods , with a root mean squared ( rms ) difference of 30 mev in excitation energies and an identical ordering of states .",
    "thus , the iterative solution to the tddft equation in onetep gives results that are comparable to the explicit construction and diagonalisation of the eigenvalue equation in octopus if the unoccupied subspace is truncated to the same size .",
    ".results for the excited states of pentacene , as calculated using onetep with the projection onto the entire unoccupied subspace , in comparison with results generated by nwchem .",
    "results are shown for the 10 lowest excitations , as well as two selected higher energy states , one dark and one bright ( labelled ( d ) and ( b ) respectively ) .",
    "the first three columns correspond to onetep calculations using three different ngwf representations , where * a * denotes the minimal set of ngwfs for the conduction space , * b * uses 2 ngwfs per h and * c * uses 5 ngwfs per h. the nwchem calculations are performed using an aug - cc - pvtz basis .",
    "energies are given in ev , oscillator strengths in brackets . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     .,scaledwidth=45.0% ]    while the two methods agree well for a conduction space truncated to contain the 10 lowest , well bound states , the tddft eigenvalue energies need to be converged with respect to the size of the conduction space .",
    "here , we make use of the projector onto the unoccupied subspace defined in [ chapter_unocc ] for the onetep calculations . in order to assess the convergence with the size of our representation , we form three different choices of ngwf representation for @xmath11 : a minimal set containing 1 ngwf per h and 4 per c and two sets where we augmented the h atoms to have 2 and 5 ngwfs respectively .",
    "the reason for doing so is that the minimal representation of ngwfs already gives a very good description of the bound unoccupied states , while the additional functions on h lead to a better description of the very delocalised unbound states . for the minimal representation",
    ", the ngwfs were optimised for the 10 bound states , while the increased variational freedom in the two larger sets meant we could explicitly optimise 4 more lightly bound conduction states as well , leading to a total number of 14 optimised conduction states .",
    "table [ table_pentacene2 ] summarises the results of the onetep calculations using the projector method with the three different ngwf representations , as well as a benchmark calculation performed in the quantum chemistry software package nwchem @xcite .",
    "the nwchem calculations were performed using an aug - cc - pvtz gaussian basis set , corresponding to 46 basis functions per c atom and 23 basis functions per h atom .",
    "this put the size of the active unoccupied space in the nwchem calculations at 1196 conduction states .",
    "comparing the onetep results to the reference calculation , we find that the minimal ngwf set using the projector method produces results that show an rms difference of just 16mev for the first 10 states compared to the nwchem results .",
    "it does however predict a significantly lower oscillator strength for the bright state .",
    "the ngwf set containing 2 localised functions per h atom gives results within 0.02 ev of the nwchem results and a very good agreement on oscillator strengths throughout .",
    "comparisons to the largest ngwf set used show that the lowest 10 states are essentially converged in both energy and oscillator strength for the medium set , while the bright state is predicted to be 0.03ev lower than the nwchem benchmark result for the largest onetep representation .",
    "we thus note that in order to achieve results that are comparable to gaussian basis set calculations using a relatively large aug - cc - pvtz basis , it is enough to use a @xmath12 containing just 2 ngwfs per h and 4 per c. we also note that some low energy states , namely the lowest and fourth lowest excitation , drop significantly in energy when introducing the the whole unoccupied subspace into the calculation by means of a projector ( up to 0.16 ev for the fourth state ) .",
    "while a decomposition of @xmath48 into kohn - sham transitions shows that no single transition into the unbound and unoptimised conduction states makes up more than 0.1% of the total tddft response density matrix , their collective effect is to significantly lower the energy of certain states .",
    "however , the approximate description of these states via a projector onto the unoccupied subspace leads to very good results , even if only a very small number of ngwfs is used .",
    "the benchmark tests show that our results are well converged with basis set size and the representation of the unoccupied subspace .",
    "however , the nature of the localisation constraint on the ngwfs means that we need to assess the convergence of the method with respect to the conduction ngwf radius as well .",
    "figure [ pentacene_convergence ] shows the convergence of three selected excited states with respect to the conduction ngwf radius for the medium sized basis set corresponding to 2 ngwfs per h atom .",
    "the ngwfs were optimised for 14 conduction states and the projector onto the unoccupied subspace was used .",
    "we note that the excitations corresponding to the 6th and 9th lowest states in table [ table_pentacene2 ] are well converged even for relatively small ngwf radii .",
    "however , in order to converge the excited state labelled as ( d ) in table [ table_pentacene2 ] , one needs to go to much larger ngwf radii .",
    "a breakdown of the corresponding response density matrices into kohn - sham transitions shows that the excited state labelled ( d ) is to 99% composed of a transition from the homo into the 9th unoccupied kohn - sham state .",
    "this unoccupied state is very lightly bound and delocalised and thus naturally shows an increased sensitivity to the localisation constraint imposed on the conduction ngwfs .",
    "however , even this very sensitive excitation is well converged for an ngwf radius of @xmath114 .      as a second test system ,",
    "we use buckminsterfullerene ( c@xmath115 ) which has already been studied extensively both experimentally and using _ ab initio _ simulation techniques .",
    "here , we focus on how the iterative solution of the tddft eigenvalue equations scales with the number of excitations converged .",
    "calculations were performed in a simulation cell of @xmath116 , using a kinetic energy cutoff of 800 ev .",
    "a minimal number of 4 ngwfs was chosen for both conduction and valence representations , while the ngwf radius was chosen to be @xmath117 and @xmath118 respectively .",
    "the conduction ngwfs were explicitly optimised for a total of 30 states , while the rest of the conduction space is included into the calculation via the projector onto the unoccupied subspace .",
    "c@xmath115 shows a high number of dark transitions in the low energy range , transitions for which the oscillator strength is very small . thus to reproduce the main features of the spectrum up to an energy of 4.8 ev , 150 excitations had to be converged . the spectrum for fullerene is shown in fig .",
    "[ spectrum_fullerene ] .",
    "the most prominent features of the spectrum are the strong excitation peaks at 3.46 ev and 4.42 ev , which are in good agreement to the tddft energies and oscillator strengths obtained in @xcite using a gradient - corrected functional and a 6 - 31g+s gaussian basis set . while the results obtained by onetep predict slightly lower energies for the main two peaks compared to @xcite , we note that the gaussian basis set used in those calculations is relatively small , such that the authors estimate the errors introduced for the main excitations as being of the order of up to 0.1 ev .",
    "finally , the energies for the main peaks in the spectrum as calculated in onetep are also in perfect agreement with the 3.5 ev and 4.4 ev obtained in time - propagation tddft calculations using a basis of linear combinations of atomic orbitals by tsolakidis _ et al _ @xcite .",
    "experimentally , the peaks are reported to be at 3.78ev and 4.84 ev @xcite , in reasonable agreement with the tddft results .",
    "generated from the 150 lowest excitation energies .",
    "an artificial smearing width of 0.03 ev was used in generating this plot .",
    "the positions and oscillator strengths of three major excitations were taken from @xcite and are plotted here using the same artificial gaussian smearing to produce a reference spectrum .",
    "the two spectra were scaled according to their relative oscillator strengths.,scaledwidth=45.0% ]    the main purpose of the c@xmath115 benchmark test is to demonstrate the scaling of computational cost of the tddft calculation with the number of converged excitation energies @xmath72 .",
    "figure [ timings_fullerene ] shows the total calculation time versus the number of converged excitation energies as well as the total time taken in applying the tddft operator on the trial vector ( eq . [ operator ] ) .",
    "the cost of applying the tddft operator scales linearly with the number of excitation energies , as one would expect .",
    "however , it can be seen that for larger numbers of excitations , the @xmath96 scaling of the gram - schmidt orthonormalisation begins to dominate over the application of the tddft operator and the total calculation time deviates from the linear trend .    .",
    "the red line is a parabolic fit to the total calculation time while the blue line is a linear fit to the total time taken to apply the tddft operator on the set of trial vectors .",
    "the non - linear behaviour of the total calculation time due to the orthogonalisation of multiple excitations is clearly visible.,scaledwidth=45.0% ]      in many ways , chlorophyll a ( c@xmath119h@xmath120mgn@xmath121o@xmath122 ) provides an ideal application for the method outlined in this work .",
    "although it is too small to fully exploit all advantages of linear scaling with system size in both the dft and tddft calculation , its size represents the upper limit of systems that can be comfortably studied using plane wave tddft implementations @xcite .",
    "due to its importance in photosynthesis , chlorophyll has been studied in great detail both experimentally and in theoretical work using tddft .",
    "calculations on chlorophyll were performed using a kinetic energy cutoff of 800 ev .",
    "a minimal number of 4 ngwfs per n , h , c , o and mg atom and 1 ngwf per h atom was chosen for the set of valence ngwfs , while for the conduction ngwfs , 13 and 5 where chosen per atom respectively .",
    "for the valence ngwfs , a radius of @xmath118 was chosen throughout , while for the conduction ngwfs , a radius of @xmath123 was chosen .",
    "the 15 lowest unoccupied states were explicitly optimised and the projector unto the unoccupied subspace was used in order to approximately represent the high energy conduction states .",
    "the resulting spectrum produced by the 12 lowest excitation energies in comparison to the experimental spectrum of chlorophyll in diethyl ether @xcite can be found in fig .",
    "[ spectrum_chlorophyll ] .",
    "we predict the first bright peak of the spectrum at 2.06 ev , while the second bright peak is found to be at 2.80 ev .",
    "we compare the results obtained in onetep with those obtained by sundholm @xcite using an alda functional and a sv(p ) gaussian basis set .",
    "we note that this gaussian basis calculation predicts the two main peaks of the spectrum to be lower by 50mev . however , the sundholm calculations are carried out using the whole tddft eigenvalue equations while our calculations are based on the tamm - dancoff approximation , so a discrepancy between the two sets of results of the order of less than 0.1 ev is to be expected . with reference to the experimental results ,",
    "the onetep tddft calculations show a blue shift of the first peak , while the second peak at 2.80 ev is slightly red - shifted compared to the experimental spectrum .",
    "a similar result can be seen in the spectrum produced by rocca _",
    "_ @xcite using the pbe exchange correlation functional and a plane - wave basis set , its overall shape being in very good agreement with tddft calculations presented here .",
    "the main point that can be taken from the tddft calculation presented here is that almost the whole visible spectrum of chlorophyll a , from 1.8 to 3.0 ev , can be generated by just calculating the first 12 excited states of the tddft superoperator .",
    "since the number of states required is very small compared to the dimensions of the tddft operator , iterative methods based on linear response theory are much more efficient than calculations based on the time propagation of the time dependent kohn - sham equations .",
    "thus , systems like chlorophyll a , where the low energy spectrum is completely dominated by a few very strong excitations and there is only a very small number of dark , dipole forbidden states , provide a perfect application for the method discussed in this work .",
    "the accuracy of the method with truncated density matrices is tested on a gaas nanorod . a number of these nanorods with different terminations",
    "have already been studied in some detail @xcite . for our purposes here , we choose a nanorod with hydrogen termination , consisting of a total of 996 atoms and having a length of @xmath124 .",
    "the calculations were performed at a kinetic energy cutoff of 400 ev and a minimal number of 4 ngwfs per ga and as atom and 1 ngwf per hydrogen atom was chosen for both sets of ngwfs .",
    "an ngwf localisation radius of @xmath125 was chosen for all ngwfs . since the purpose of the calculations on the nanocrystal was to establish the magnitude of errors introduced by the response density matrix only , we performed all calculations with fully dense conduction and valence density matrices and only truncated @xmath48 to different degrees .",
    "the nanorods studied here exhibit a large dipole moment and thus a strong electrostatic potential along their long axes , causing the homo and lumo to be strongly localised to opposite ends of the rod .",
    "thus for any semi - local approximation to the exchange - correlation kernel , one would expect the lowest excitation energy of the system to correspond to a charge transfer state across the rod .",
    "when calculating the lowest eigenvalue for the system using a fully dense response density matrix , this charge transfer state is exactly what we obtain .",
    "however , once a density matrix cutoff is introduced , the tddft algorithm converges to an excited state fully localised on the as terminated end of the rod and considerably higher in energy ( see fig . [ gaas_excitations ] ) .        in fig .",
    "[ plot_gaas ] , the energy convergence of the localised excited state is plotted with respect to the density matrix truncation used .",
    "we find that although a density matrix cutoff does not allow us to converge charge - transfer type excitations , the more localised excitation on the as terminated end of the rod is determined to a high degree of accuracy . a density matrix truncation radius of @xmath126 introduces an error of less than 5 mev compared to the excitation calculated with the full density matrix , suggesting that calculating localised excitations with a truncated density matrix is indeed possible .",
    "the fact that the charge transfer states are predicted to be the lowest excited states in our calculations using a full density matrix is an artefact of the local nature of the alda kernel , which leads to a significant underestimation of any long range excitation@xcite .",
    "more sophisticated non - local functionals would correct this short - coming and push the charge transfer states significantly higher in energy . in a calculation with a truncated density matrix",
    "these corrected states would still be missing .",
    "we note however , that our alda calculations with a truncated density matrix allow us to retain those excitations that are well described by local functionals and correspond to those observed experimentally as lowest excitations in the system . thus excluding charge transfer states from a calculation",
    "might indeed be desired in certain systems , especially since they often correspond to states much higher in energy than the lowest excitation if appropriate functionals are used .",
    "we have shown that excluding these states can be achieved naturally in the linear - response tddft formulation presented here by applying a suitable truncation on the response density matrix .      to demonstrate the linear scaling of the method with the number of atoms , a test system of a single - walled ( 10,0 ) carbon nanotubes ( cnts ) in periodic boundary conditions is chosen .",
    "supercell sizes of 640 , 920 , 1240 , 1600 and 1920 atoms are chosen , corresponding to segments of 127 , 193 , 257 , 321 and 386 @xmath127 in length . due to the periodic boundary conditions in place ,",
    "all supercells simulate an infinitely long ( 10,0 ) cnt .",
    "there are well - known problems associated with using local exchange - correlation kernels in infinite systems , which are widely discussed in the community @xcite .",
    "furthermore , the very delocalised nature of excitations in the infinite system means that the cnt is not an ideal candidate for introducing a cutoff on the response density matrix , as seen in the previous section .",
    "the calculation performed here should therefore be regarded as a demonstration of linear - scaling capabilities only , while the previous sections provide a general demonstration for the accuracy of the method .",
    "the calculations were performed at a kinetic energy cutoff of 700 ev and only the lowest excitation energy was converged . as in previous sections , a minimal representation of 4 ngwfs per c atom was used for both the conduction and the valence ngwf sets .",
    "a localisation radius of @xmath118 and @xmath123 was selected for the valence and conduction ngwfs respectively .",
    "the number of unoccupied states included explicitly in the calculation was chosen such that all bound states were included and thus was scaled up linearly as the supercell size was increased .",
    "for the largest segment of 1920 atoms , this corresponds to a tddft operator of dimension @xmath128 in canonical representation and @xmath129 in conduction - valence ngwf representation , prohibitively large for any non - iterative treatment of the eigenvalue problem . in order to achieve full linear scaling in both the ground state and the tddft calculation ,",
    "a cutoff radius of @xmath130 was applied to both the valence and the conduction density matrix .    .",
    ", scaledwidth=45.0% ]    the calculation time for a single iteration of the tddft conjugate gradient algorithm with respect to the different supercell sizes of ( 10,0 ) cnts can be found in fig . [ cnt_timing ] .",
    "calculations have been performed for both a fully dense response matrix and a response matrix that has been truncated at @xmath131 .",
    "it can be seen that with a moderate response matrix truncation of @xmath131 , the calculation time of a tddft iteration scales fully linearly with system size .",
    "however from fig .",
    "[ cnt_timing ] it is also evident that even for fully dense response matrices , the algorithm exhibits a near linear scaling behaviour up to the largest supercell sizes .",
    "thus for system sizes tested here , the construction of the response potential matrix @xmath132 , which only depends on the density and thus scales linearly even for fully dense @xmath48 , dominates the computation time of the tddft algorithm . for even larger system sizes , it is expected that the cubic scaling associated with the fully dense matrix operations performed to construct the tddft gradient and conjugate search directions will start to strongly influence computation times , making a truncation of @xmath48 necessary .",
    "however , it is evident that the algorithm presented here exhibits an excellent scaling up to large system sizes ( 1920 atoms ) even without enforcing the truncation of the response density matrix .",
    "we have presented a linear - scaling tddft algorithm in the linear response formalism .",
    "we have demonstrated the accuracy of the method on a number of test systems by comparing to results in the literature obtained with conventional methods .",
    "the method presented in this work is ideal for systems in which the low energy excitation spectrum is dominated by a few very strong transitions and only a relatively small number of dark states . for these systems ,",
    "the advantages of an iterative treatment of the eigenvalue problem can be fully exploited and the method is expected to outperform standard time - evolution tddft algorithms . for systems with a very large number of dipole forbidden states , or nanocrystals with an indirect band gap , calculations become more demanding since a much larger number of states need to be converged in order to produce a meaningful spectrum . however , while the orthogonality requirement of different excited states means that the algorithm can not scale linearly but rather quadratically with the number of excitation energies converged , we note that the prefactor in the quadratic term is generally small , as demonstrated in the calculations on buckminsterfullerene .    furthermore , we have demonstrated that the method scales truly linearly with system size if all density matrices in the formalism can be treated as fully sparse .",
    "we have shown the validity of truncating the response density matrix on gaas nanorods for localised excitations , thus giving an example of a realistic system that can be studied while making full use of the advantages of the linear - scaling algorithm presented .",
    "while we find that the truncation of the response density matrix prevents us from calculating long - range charge transfer states , we note that these states are badly represented in local approximations to the tddft exchange - correlation kernel in any case .",
    "a response density matrix truncation can thus provide an effective way of excluding unwanted charge transfer type states from the calculation .",
    "while we have shown that truncations of the response matrix are not always possible for excitations of arbitrary systems , we note that the algorithm shows excellent scaling even for fully dense response density matrices up to a system size of over 2000 atoms .",
    "thus , we expect the method to enable large scale computations of optical excitations in important areas such as biophysics and nanoscience",
    ".    the authors would like to thank keith refson , leonardo bernasconi and dominik jochym for helpful discussions .",
    "the authors would also like to thank jian - hao li for performing a number of benchmark tests of the method implemented in the @xmath2 code .",
    "all calculations reported in this work were performed using the imperial college high performance computing service .",
    "tjz was supported through a studentship in the centre for doctoral training on theory and simulation of materials at imperial college funded by epsrc under grant number ep / g036888/1 .",
    "ndmh acknowledges the support of epsrc grants ep / g05567x/1 and ep / j015059/1 , a leverhulme early career fellowship , and the winton programme for the physics of sustainability .",
    "pdh acknowledges the support of a royal society university research fellowship .",
    "99 a. j. nozik , appl .",
    ". lett . * 30 * , 567 ( 1977 ) .",
    "m. grtzel , nature * 414 * , 338 ( 2001 ) .",
    "d. a. tryk , a. fujishima , and k. honda , electrochim .",
    "acta * 45 * , 2363 ( 2000 ) .",
    "m. walter , e. warren , j. mckone , s. w. boettcher , q. mi , e. a. santori , and n. s. lewis , chem . rev . * 110 * , 6446 ( 2010 ) .",
    "j. shi , y. zhu , x. zhang , w. r. g. baeyens , and a. m. garca - campaa , trends anal .",
    "* 23 * , 351 ( 2004 ) .",
    "l. brus , j. phys .",
    "90 * , 2555 ( 1986 ) .",
    "e. runge , and e. k. u. gross , phys .",
    "lett . * 52 * , 997 ( 1984 ) .",
    "m. a. l. marques , and e. k. u. gross , annu .",
    "phys . chem . *",
    "55 * , 427 ( 2004 )",
    ". m. e. casida , and m. huix - rotllant , annu .",
    "phys . chem . * 63 * , 287 ( 2012 ) .",
    "g. onida , l. reining , and a. rubio , rev .",
    "phys . * 74 * , 601 ( 2002 ) .",
    "m. j. g. peach , p. benfield , t. helgaker , and d. j. tozer , j. chem .",
    "128 * , 044118 ( 2008 ) .",
    "l. reining , v. olevano , a. rubio , and g. onida , phys .",
    "88 * , 066404 ( 2002 ) .",
    "d. rocca , r. gebauer , y. saad , and s. baroni , j. chem .",
    "phys . * 128 * , 154105 ( 2008 ) .",
    "p. hohenberg , and w. kohn , phys . rev . *",
    "136 * , b864 ( 1964 ) .",
    "w. kohn , and l. j. sham , phys .",
    "rev . * 140 * a1133 ( 1965 ) .",
    "s. goedecker , rev .",
    "* 71 * , 1085 ( 1999 ) .",
    "d. r. bowler , and t. miyazaki , rep .",
    ". phys . * 75 * , 036503 ( 2012 ) . n. d. m. hine , p. d. haynes , a. a. mostofi , c .- k .",
    "skylaris , and m. c. payne , comput .",
    "commun . * 180 * , 1041 ( 2009 ) .",
    "skylaris , p. d. haynes , a. a. mostofi , and m. c. payne , j. chem . phys . * 122 * , 084119 ( 2005 ) . c. yam , s. yokojima , and g. chen , phys .",
    "b. * 68 * , 153105 ( 2003 ) .",
    "j. hutter , j. chem .",
    "* 118 * , 3928 ( 2003 ) .",
    "l. bernasconi , s. tomi , m. ferrero , m. rrat , r. orlando , r. dovesi , and n. m. harrison , phys .",
    "b * 83 * , 195325 ( 2011 ) .",
    "s. tretiak , c. m. isborn , a. m. n. niklasson , and m. challacombe , j. chem .",
    "130 * , 054111 ( 2009 ) .",
    "`` linear scaling solution of the time - dependent self - consistent - field equations '' , m. challacombe , arxiv:1001.2586 ( 2010 ) .",
    "w. kohn , phys .",
    "lett . * 76 * , 3168 ( 1996 ) . w. kohn , int .",
    "j. quant . chem .",
    "* 56 * , 229 ( 1995 )",
    ". l. he , and d. vanderbilt , phys .",
    "b * 86 * , 5341 ( 2001 ) .",
    "skylaris , a. a. mostofi , p. d. haynes , o. dieguez , and m. c. payne , phys .",
    "b * 66 * , 035119 ( 2002 ) .",
    "a. a. mostofi , p. d , haynes , c .- k .",
    "skylaris , and m. c. payne , j. chem . phys . *",
    "119 * , 8842 ( 2003 ) .",
    "r. mcweeny , rev .",
    "32 * , 335 ( 1960 ) .",
    "skylaris , p. d. haynes , a. a. mostofi , and m. c. payne , phys .",
    "status solidi b * 243 * , 973 ( 2006 ) .",
    "l. e. ratcliff , n. d. m. hine , and p. d. haynes , phys . rev .",
    "b * 84 * , 165131(2011 ) .",
    "s. hirata , and m. head - gordon , chem .",
    ". lett . * 314 * , 291(1999 ) .",
    "d. rocca , z. bai , r .- c .",
    "li , and g. galli , j. chem . phys . *",
    "136 * , 034111 ( 2012 ) .",
    "m. sierka , a. hogekamp , and r. ahlrichs , j. chem . phys . * 118 * , 9136 ( 2003 ) .",
    "e. v. tsiper , j. phys .",
    "b : at . mol",
    ". opt . phys . *",
    "34 * , l401 ( 2001 ) .",
    "e. artacho , and l. milns del bosch , phys .",
    "a * 43 * , 5770 ( 1991 ) .",
    "m. head - gordon , p. e. malsen , and c. a. white , j. chem",
    ". phys . * 108 * , 616 ( 1998 ) .",
    "n. d. m. hine , p. d. haynes , a. a. mostofi , and m. c. payne , j. chem .",
    "phys . * 133 * , 114111(2010 ) .",
    "e. schwegler , and m. challacombe , j. chem . phys . *",
    "105 * , 2726 ( 1996 ) . c. k. gan , p. d. haynes , and m. c. payne , comp .",
    "134 * , 33 ( 2001 ) .",
    "f. furche , j. chem .",
    "phys . * 114 * , 5982 ( 2001 ) . c. brouder , g. panati , m. calandra , c. mourougane , and n. marzari , phys .",
    "046402 ( 2007 ) . g. chen , and s. mukamel , j. phys .",
    "* 100 * , 11080 ( 1996 ) .",
    "j. p. perdew , and a. zunger , phys .",
    "b * 23 * , 5048 ( 1981 ) .",
    "n. troullier , and j. l. martins , phys .",
    "b * 43 * , 1993 ( 1991 ) .",
    "n. d. m. hine , m. robinson , p. d. haynes , c .- k .",
    "skylaris , m. c. payne , and a. a. mostofi , phys .",
    "b * 83 * , 195102 ( 2011 ) .",
    "a. castro , h. appel , m. oliveira , c. a. rozzi , x. andrade , f. lorenzen , m. a. l. marques , e. k u. gross , and a. rubio , physica status solidi ( b ) * 243 * , 2465 ( 2006 ) m. valievm e. j. bylaska , n. govind , k. kowalski , t. p. straatsma , h. j. j. van dam , d. wang , j. nieplocha , e. apra , t. l. windus and w. a. de jong , comput .",
    ". commun . * 181 * , 1477 ( 2010 ) c. lee , w. yang , and r. parr , phys .",
    "b * 37 * , 785 ( 1988 ) .",
    "a. d. becke , j. chem . phys . * 98 * , 5648 ( 1993 ) .",
    "a. tsolakidis , d. snchez - portal , and r. m. martin , phys .",
    "b * 66 * , 235416 ( 2002 ) .",
    "r. bauernschmitt , r. ahlrichs , f. h. heinrich , and m. m. kappes , j. am .",
    "soc . * 120 * , 5052 ( 1998 ) .",
    "h. du , r. c. a. fuh , j. li , l. a. corkan , and j. s. lindsey , photochem .",
    "photobiol . * 68 * , 141 ( 1998 ) ; http://omlc.ogi.edu/spectra/photochemcad/html/123.html .",
    "d. sundholm , chem .",
    ". lett . * 302 * , 480 ( 1999 ) .",
    "p. w. avraam , n. d. m. hine , p. tangney , and p. d. haynes , phys .",
    "b * 83 * , 241402(r ) ( 2011 ) .",
    "p. w. avraam , n. d. m. hine , p. tangney , and p. d. haynes , phys .",
    "b * 85 * , 115404 ( 2012 ) ."
  ],
  "abstract_text": [
    "<S> we present an implementation of time - dependent density - functional theory ( tddft ) in the linear response formalism enabling the calculation of low energy optical absorption spectra for large molecules and nanostructures . </S>",
    "<S> the method avoids any explicit reference to canonical representations of either occupied or virtual kohn - sham states and thus achieves linear - scaling computational effort with system size . </S>",
    "<S> in contrast to conventional localised orbital formulations , where a single set of localised functions is used to span the occupied and unoccupied state manifold , we make use of two sets of _ in situ _ optimised localised orbitals , one for the occupied and one for the unoccupied space . </S>",
    "<S> this double representation approach avoids known problems of spanning the space of unoccupied kohn - sham states with a minimal set of localised orbitals optimised for the occupied space , while the _ in situ _ optimisation procedure allows for efficient calculations with a minimal number of functions . </S>",
    "<S> the method is applied to a number of medium sized organic molecules and a good agreement with traditional tddft methods is observed . </S>",
    "<S> furthermore , linear scaling of computational cost with system size is demonstrated on ( 10,0 ) carbon nanotubes of different lengths . </S>"
  ]
}