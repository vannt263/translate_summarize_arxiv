{
  "article_text": [
    "two plausible alternative explanations to the observed accelerating expansion of our universe are dynamical dark energy @xcite and modified gravity @xcite . in both classes of theories ,",
    "a scalar field has been used as the most common dynamical origin of the acceleration of the universe .",
    "this , however , comes at a price : in many theories , especially modified gravity and coupled dark energy theories , dark energy evolves on cosmological time scales only when the scalar field leads to a long range interaction which could violate various gravitational bounds . to avoid this problem ,",
    "screening mechanisms have been designed to dynamically screen the scalar - mediated fifth force in dense or high - curvature environments .",
    "screening the effects of a scalar interaction in the presence of matter can be realised in the following ways .",
    "let @xmath5 be the environment dependent background configuration and let us expand the scalar lagrangian to second order , = - ( ) ^2 - ( ) ^2 -(_0 ) _ m , where @xmath6 is the normalisation of the scalar , @xmath7 is the mass depending on the background value of the scalar field , and @xmath8 the coupling to the overdensity @xmath9 . the fifth force is screened if either @xmath10 becomes small , or @xmath7 or @xmath6 become large .",
    "hence there are three known screening mechanisms to evade the local gravity constraints : the vainshtein mechanism @xcite in the dvali - gabadadze - porrati ( dgp ) @xcite and galileon @xcite models where @xmath6 is large enough to reduce the effective coupling @xmath11 below observational levels , the chameleon mechanism @xcite where the mass @xmath7 is large enough to render the range of the scalar interaction smaller than distances probed experimentally and finally in dilaton @xcite and symmetron @xcite theories the coupling @xmath10 itself is smaller than observed .",
    "these mechanisms all utilise the nonlinearities of the effective scalar lagrangian to prevent the fifth - force from propagating freely .",
    "the nonlinearities for the vainshtein case stem from the derivative self - couplings of the scalar degree of freedom , while the chameleon , and the dilaton and symmetron use the non - linearities of the potential and the coupling to matter respectively . in a companion paper @xcite , we have presented a systematic study of generic dilaton and symmetron theories in the nonlinear regime of structure formation , using @xmath0-body simulations based on a unified parameterisation scheme @xcite .",
    "this paper will concentrate on chameleons .",
    "in particular , we have generalised the original chameleon models and the parameter space of these new models is analysed making use of @xmath0-body simulations .",
    "the structure formation in general chameleon models is different from that in gr within the compton wavelength of the scalar degree of freedom , which is the inverse of the effective mass of the scalar field @xmath12 @xcite . indeed",
    "the density contrast of matter perturbations increases anomalously there .",
    "this implies that the power spectrum differs from its gr counterpart .",
    "it turns out that the scale characterising modified gravity , i.e. the scalar mass now , is large enough to prevent significant effects on linear scales .",
    "the main consequences of modified gravity appear in the non - linear regime where numerical methods have to be used .",
    "the analysis of the structure growth of the screened modified gravity models with no higher derivative terms in the lagrangian , e.g. chameleons , is rendered easier by the fact that these models can be fully parameterised by two time - dependent functions , @xmath13 and @xmath14 , i.e. the mass of the scalar field and its coupling to matter as a function of the scale factor .",
    "this method works even on fully nonlinear scales @xcite where the screening effects on smaller scales , for instance for galaxy halos , can therefore be powerfully analysed .    in this work ,",
    "we study the nonlinear structure formation using @xmath0-body simulations for the general chameleon theories that we define here and which are parametrised by two @xmath13 and @xmath14 functions @xcite .",
    "technically , we use a variant of the ecosmog code @xcite , which is based on a public adaptive mesh refinement ( amr ) code ramses @xcite , to solve and evolve the @xmath0-body system .",
    "although chameleon theories , even in the nonlinear regime , have been studied extensively in the literature ( e.g. , @xcite ) , those studies are mostly for specific models in a very restricted parameter space . as an example , simulations for @xmath15 gravity",
    "have thus far only been done for the hu - sawicki model @xcite which is equivalent to a chameleon theory with the coupling strength @xmath14 fixed to @xmath16 .",
    "our study here , for the first time , allows @xmath14 to have a time evolution in our chameleon models and the model of @xcite.].our parameterisation allows us to follow a more systematic approach to vary the different chameleon parameters and study the effects quantitatively . in particular , we find that the chameleon mechanism is considerably more efficient than the dilaton and symmetron mechanisms in restoring gr in high - density regions and at earlier times .",
    "our results here show that linear perturbation theory fails almost whenever it predicts a deviation from @xmath2cdm , and point out the portion of the chameleon parameter space that is relevant to cosmology today and in the near future .",
    "the layout of this paper is as follows : in   [ sect : mod_grav ] we review scalar - type theories and show how they can be parameterised simply ; in   [ sect : chameleon ] we briefly describe the generalised chameleon model and the possible effects of varying each model parameter ; the equations that will be used in the @xmath0-body simulations are summarised in   [ sect : nbody_eqns ] , various tests of our code are presented in   [ sec : code_test ] and then the cosmological simulations used in this work are discussed in ",
    "[ sect : simulations ] ; finally we summarise and conclude in   [ sect : summary ] .    to make things clearer , throughout the paper we use the units @xmath17 except where we use @xmath18 explicitly .",
    "an overbar ( subscript @xmath19 ) denotes the background ( present - day ) value of a quantity and subscript @xmath20 means @xmath21 .",
    "@xmath22 , where @xmath23 is the reduced planck mass and @xmath24 is newton s constant , are used interchangeably for convenience .",
    "in this section we briefly describe the essential features of modified gravity theories with a scalar degree of freedom ( dof ) and how the effects of such a dof can be screened locally to restore general relativity ( gr ) .",
    "more detailed descriptions can be found in our previous publications and here we keep the discussion short to make the paper self contained , and familiar readers can skip this section .    [",
    "sect : mod_grav ]      the einstein - hilbert action for the scalar field @xmath25 in a generic scalar - tensor theory has the following form in the einstein frame , @xmath26\\nonumber\\\\ & & + \\int { \\rm d}^4x \\sqrt{-\\tilde g } { \\cal l}_m(\\psi_m^{(i)},\\tilde g_{\\mu\\nu}),\\end{aligned}\\ ] ] in which @xmath27 is the determinant of the metric tensor @xmath28 and @xmath29 is the ricci scalar .",
    "we label the @xmath30th matter field by @xmath31 .",
    "the quantities @xmath32 and @xmath33 denote respectively the metric tensor in the jordan frame and its determinant , and they are connected to @xmath28 and @xmath27 via the following conformal transformation , g_=a^2()g _ ,  g = a^8 ( ) g.    in the einstein frame , the equation of motion ( eom ) of the scalar field has an extra term because here @xmath25 explicitly couples to matter , and we get [ eq : eom ] = -t + , in which @xmath34 is the trace of the energy momentum tensor @xmath35 , @xmath36 are the energy density and pressure of matter , @xmath37 and the coupling strength between @xmath25 and matter is given by @xmath38 .",
    "( [ eq : eom ] ) is equivalent to that of a normal quintessence field , with the bare scalar field potential replaced by a new effective potential @xmath39 in the simplest cases , @xmath40 has a global minimum in the cosmological background dominated by dust matter for which @xmath41 and @xmath42 .",
    "the value of the scalar field at the minimum depends on the actual value of @xmath43 , i.e. , @xmath44 .",
    "the mass of the scalar field at @xmath45 , which is defined by @xmath46 must be positive because an imaginary @xmath12 can lead to violently unstable evolution of the perturbation of the scalar field .    when matter is described by dust fluid ( with radiation negligible ) so that there is no anisotropic stress , the line element in the weak - field limit can be expressed as ds^2=-(1 + 2 ) dt^2 + ( 1 - 2)dx^2 , where @xmath47 is the gravitational potential .",
    "this reduces to the modified geodesic equation for matter particles [ eq : geodesic ] = -^i(+a ( ) ) .",
    "we can understand eq .",
    "( [ eq : geodesic ] ) as the motion of a massive particle in an effective gravitational potential _ eff+a ( ) , and this is why the theory is considered as a modified gravity theory .    as an example , let us consider a point mass @xmath48 embedded in a homogeneous background density as the source of gravity .",
    "the effective gravitational potential could be obtained by solving the scalar eom @xcite , as [ eq : klsol ] _",
    "the second term in the brackets represents a yukawa - type deviation from newtonian gravity ( the fifth force ) , and this deviation can be of order unity if @xmath49 and @xmath50 . however , because both @xmath51 and @xmath12 are functions of the field itself and thus depend on local matter density , it is possible that near massive bodies nonlinear effects make @xmath52 or @xmath53 . in such cases , the modification of gravity is strongly suppressed , which helps to evade local constraints on the fifth force . because the suppression of modified gravity here depends on the massive body itself , we call this _ self_-screening .",
    "self - screening is not the only mechanism to suppress the fifth force in modified gravity theories .",
    "indeed , this suppression often also very strongly depends on the _ environment _ of the body . in the case of chameleon theories , as shown in @xcite , the fifth force is effectively screened provided that the newtonian potential @xmath54 at the edge of a massive body follows the relation @xmath55 where @xmath56 is the minimum of @xmath40 inside the body and @xmath57 are the minimum of @xmath40 and the coupling strength far away . in general , @xmath58 , and @xmath54 in eq .",
    "( [ eq : sc ] ) determines the _ self_-screening due to the massive body while @xmath59 ( via also @xmath60 ) characterises the _ environmental_-screening .",
    "note that although @xmath51 is often chosen to be constant in chameleon theories , this does not necessarily have to be the case .",
    "as we shall see shortly , a rough estimate of the local constraints on the fifth force indicates that @xmath61 around the global minimum of @xmath40 .",
    "the scalar field dynamically tracks @xmath45 , around which it oscillates rapidly @xcite , and the time average @xmath62 then acts as a very slowly - varying cosmological constant . in this simplified case",
    ", we can determine the cosmic evolution of the scalar field in terms of @xmath13 and @xmath14 in background , as @xcite @xmath63 where we have assumed @xmath64 , as required by the stringent experimental constraints on the time variation of fermion masses , which is proportional to @xmath65 .",
    "@xmath66 is the scalar field value at the initial time @xmath67 , when the average matter density in the universe is of the same order as that in typical test bodies in laboratories today .",
    "similarly , we have @xmath68 where @xmath69 .    given @xmath70 and @xmath71 , it is straightforward to derive @xmath72 as a function of @xmath25 , @xmath73",
    ". similarly , @xmath74 can be reconstructed easily from @xmath14 and @xmath71 . as a result , the full nonlinear dynamics of the theory can be reconstructed elegantly using the background evolutions of @xmath12 and @xmath51 .",
    "this ` tomography ' @xcite has turned out to be very useful as a generic parameterisation of modified gravity theories and the systematic simulations to study their cosmological implications @xcite .",
    "we can then express the screening condition , eq .",
    "( [ eq : sc ] ) , as [ eqq ] _ a_in^a_out _ m(a)da _ outm_pl^2_n , in which for simplicity we have considered constant matter densities @xmath75 outside and inside the dense body , and @xmath76 is defined by @xmath77 and @xmath78 .",
    "one can use the fact that the milky way must be screened .",
    "so if the milky way is not screened to provide environmental screening for the sun , then the latter will not be self - screened either . ] to make a rough estimate about the screening condition .",
    "the averaged matter density inside the milky way is @xmath79 times that of the cosmic mean , which implies that @xmath80 ; its newtonian potential at its surface is @xmath81 . on the other hand , approximately the environmental matter density for the milky way",
    "can be taken as close to the cosmic mean , which gives us @xmath82 . using these numbers , eq .",
    "( [ eqq ] ) implies that @xmath83 . a similar bound",
    "can be deduced from the timing of binary systems @xcite and the distance indicators for stars in dwarf galaxies @xcite .",
    "hence , for a given modified gravity model to be screened locally , the fifth force can only act on scales of and below a few megaparsecs in a cosmological setting . because @xmath12 itself is dimensional , in the rest of the paper we shall use the dimensionless quantity , to parameterise modified gravity theories .",
    "@xmath84 is proportional to the range of the fifth force , = 2998  h^-1mpc . even in gr ,",
    "length scales of order megaparsec are already in the nonlinear regime and can not be accurately described with linear perturbation theory .",
    "the nonlinearity in the equations for modified gravity only makes this situation even worse , and previous experiences @xcite show that linear perturbation theory can be misleading whenever it predicts a deviation from gr .",
    "this has motivated us to analyse the large - scale structure formation in the chameleon theory more reliably , using @xmath0-body simulations .",
    "in the original chameleon theory proposed in @xcite , the coupling function and the scalar field bare potential take the following forms respectively : @xmath85 here @xmath86 is a dimensionless model parameter and @xmath87 is a parameter with mass dimension four . the chameleon screening mechanism is graphically illustrated in fig .",
    "[ fig : chameleon ] . in high matter - density regions",
    "the contribution from the matter coupling to @xmath88 is large and the chameleon field @xmath25 is trapped in the small - field regime ( , @xmath89 ) such that the fifth force , proportional to @xmath90 , is very weak$ ] . in this case",
    ", the variation of @xmath25 from the inside to the outside of a massive dark matter halo is at most @xmath91 , while the variation of the newtonian potential is typically @xmath92 or even larger , which means the fifth force is much weaker than standard gravity .",
    "indeed , the smallness of @xmath25 is a generic consequence of the chameleon effect . ] ; in low matter - density regions , in contrast , @xmath25 is big and so is @xmath90 , resulting in a cosmologically interesting fifth force .",
    "the essential features of the original chameleon theory include an exponential coupling function @xmath93 and a runaway potential .",
    "as discussed above , a coupled scalar field , if heavy enough ( namely @xmath94 ) , can have its time evolution fully specified by @xmath13 and @xmath14 , both of which are determined as functions of @xmath95 by the background cosmology . for the chameleon theory listed in @xcite",
    ", it has been shown that @xmath96 where @xmath97 .    as a straightforward generalisation of the chameleon idea , in this paper we shall consider a power - law form of both @xmath13 ( as in eq .",
    "( [ eq : m_original ] ) ) and @xmath14 : @xmath98 where @xmath99 is a new model parameter to describe the generalised chameleon theory . using the tomographic mapping",
    "discussed above , we find that @xmath100,\\nonumber\\end{aligned}\\ ] ] where we have used a subscript @xmath101 to denote the value of a quantity at the initial time @xmath102 , and @xmath103 as defined above . as we take the limit @xmath104 , the chameleon field is driven to @xmath89 and the above equation reduces to @xmath105    in order to study the nonlinear evolution of @xmath25 , we have to know @xmath106 , where a subscript @xmath20 denotes derivative with respect to @xmath25 , which governs the dynamics of the scalar field ( see the @xmath0-body equations below ) .",
    "for this we find @xmath107^{\\frac{3+s}{2r - s-3}}\\left[\\frac{\\xi^2m_{\\rm pl}}{\\varphi}\\right]^{\\frac{3+s}{2r - s-3}},\\\\end{aligned}\\ ] ] in which eq .",
    "( [ eq : v_varphi_of_a ] ) can be used in background cosmology and linear perturbation analysis to replace @xmath108 . as @xmath109 and @xmath110 are all positive , to make sure that the quantities in eq .",
    "( [ eq : v_varphi_of_varphi ] ) are well defined we will require @xmath111 and @xmath112 in what follows .",
    "we also require that @xmath113 , since @xmath114 during the matter - dominated era and @xmath115 in the radiation era , so that one may have @xmath116 at early times if @xmath117 .",
    "with @xmath106 , one could easily integrate to obtain @xmath73 analytically and we have @xmath118^{\\frac{2r-2s-6}{2r - s-3 } } \\ \\\\end{aligned}\\ ] ] for @xmath119 and @xmath120\\ \\\\end{aligned}\\ ] ] for @xmath121 .",
    "the perturbation of the dark energy density , @xmath122 , appears in the source for the poisson equation ( see below ) , but it is generally very small and can be safely neglected .",
    "given @xmath71 and @xmath14 , it is straightforward to find @xmath74 . for our parameterisation using @xmath123 , we find that @xmath124\\nonumber\\\\ & & \\times\\left[\\frac{\\varphi}{m_{\\rm pl}}\\right]^{\\frac{2r-2s-3}{2r - s-3}}\\end{aligned}\\ ] ] and @xmath125^{-\\frac{s}{2r - s-3}}.\\end{aligned}\\ ] ] as a result , both @xmath126 and @xmath51 are power - law functions of @xmath25 .",
    "as shown above , our generalised chameleon theory is specified by four model parameters , namely , @xmath127 and @xmath84 .",
    "the effect of varying these four parameters on the structure formation can be understood without solving the system explicitly .",
    "the parameter @xmath128 , which is the coupling strength at @xmath129 , controls the overall amplitude of the coupling throughout the entire evolution history .",
    "the larger @xmath128 is , the stronger the fifth force is , thus the strong clustering of matter relative to that in @xmath2cdm ( in which @xmath130 ) .",
    "the parameter @xmath131 , which is the power index of @xmath13 , determines the time evolution of the effective mass of the scalar field without changing @xmath132 , which is the mass at @xmath129 .",
    "the smaller @xmath131 is ( @xmath97 ) , the lighter the scalar field is at @xmath133 , and so the longer the range of the fifth force is . due to the tomography mapping",
    ", this also implies that the scalar field is less heavy in high - density regions , leading to a weaker chameleon screening and a stronger clustering of matter .",
    "recall from the above that we restrict ourselves to @xmath113 .",
    "the parameter @xmath99 , which is the power index of @xmath14 , determines the time evolution of the coupling function .",
    "the more negative @xmath99 is , the weaker the coupling between matter and the scalar field at @xmath133 becomes ; because of the tomography relation , this also means a stronger suppression of the fifth force in high - density regions , and therefore weaker matter clustering .",
    "note that here we restrict ourselves to @xmath134 to avoid the _",
    "anti_-chameleon effect : this can be seen by looking at eq .",
    "( [ eqa ] ) , which shows that the coupling is stronger in high density regions , or eq .",
    "( [ eq : beta_new ] ) , which shows that the coupling is stronger at earlier times .",
    "the situation is worse if @xmath135 , which implies that @xmath93 decreases with @xmath25 by eq .",
    "( [ eqb ] ) , and there is no longer any minimum for @xmath40 .    the parameter @xmath84 , which is simply @xmath136 , essentially sets the effective mass @xmath12 of the scalar field ( and thus the effective range of the fifth force ) at @xmath129 .",
    "in all the chameleon simulations we study in this work , @xmath137 .",
    "the larger @xmath84 is , the lighter the scalar field is and the stronger the fifth force becomes .    in what follows",
    ", we will find that the @xmath0-body simulations confirm this analysis and also quantify these effects .",
    "this section serves to introduce the @xmath0-body poisson and chameleon equations for the sake of completeness . for this we list the equations to be solved and describe the code units used in our simulations , both of which can be found in @xcite .      the relevant equations which determine the dynamics of the chameleon and gravity fields are @xmath138 where we work in the quasi - static limit by dropping all terms involving time derivatives .",
    "the validity of the quasi - static approximation was tested explicitly in @xcite , which compared the time and spatial derivatives and found that the former is indeed negligible .",
    "note that , rigorously speaking , @xcite only tested that @xmath139 is negligible , where @xmath140 is the scalar field value averaged over the quick oscillations , rather than @xmath141 itself , which can be as large as @xmath142 due to the oscillations .",
    "the oscillations themselves , however , largely cancel out and it is the averaged effect that we observe  in this sense we believe that the test of @xcite is accurate .",
    "we have checked , using our linear perturbation code , that the effects on cosmological observables ( such as @xmath143 ) differ by less than @xmath144 in the two cases where we respectively follow the oscillations accurately and average over them @xcite .",
    "it is tempting to try to solve the full time - dependent scalar field eom @xcite in modified gravity simulations , but notice that to follow the time evolution one has to resolve the oscillations very well .",
    "it does not seem so difficult at the background level , where @xmath145 , meaning that to accurately resolve the oscillations one needs a factor of @xmath146 coarse time steps .",
    "however , even in a _ mildly _ high - density region one could have @xmath147 , requiring @xmath148 time steps to accurately follow the time evolution during the course of an @xmath0-body simulation . for comparison ,",
    "the simulations in this paper uses a few hundred coarse time - steps so fully solving the eom represents a huge increase in the computational cost of a simulation .",
    "using fewer time steps would mean that some sort of average has been done implicitly , in the same sense as it is done in the quasi - static approximation .",
    "a full treatment of this issue is beyond the scope of this work , but rigorous test of the quasi - static approximation for modified gravity theories is something we plan to pursue in the future .",
    "the code units are based on ( but not exactly ) the supercomoving coordinates of @xcite .",
    "they can be summarised as follows ( tilded quantities are expressed in the code unit ) : @xmath149 where @xmath150 is the physical coordinate , @xmath151 is the physical time , @xmath18 is the speed of light , @xmath152 the critical density at present , @xmath153 today s fractional energy density for matter , @xmath154 the particle velocity and @xmath47 the newtonian potential . besides , @xmath155 is the simulation box size in unit of @xmath156mpc .",
    "the average matter density is @xmath157 in the code unit .",
    "note that all these code quantities are dimensionless .      in cosmological simulations",
    ", the chameleon field @xmath25 is generally extremely small ( , @xmath158 ) and must be positive to make the logarithmic in eq .",
    "( [ eq : v_varphi_of_varphi ] ) well defined . to prevent the numerical value of @xmath25 from becoming negative during the computation and therefore causing divergence problems",
    ", we follow @xcite to define a new variable @xmath159 instead of using @xmath25 itself . throughout the cosmic evolution and from one spatial position to another",
    ", @xmath25 can change by several orders of magnitude , but @xmath160 remains @xmath161 , making the numerical problems easier to avoid when using @xmath162 .    using the quantities defined above , the poisson equation , eq .",
    "( [ eq : newton ] ) , can be written as @xmath163 and , after some manipulation , the chameleon equation of motion eq .",
    "( [ eq : sf ] ) reads @xmath164^{-\\frac{s}{2r - s-3}}a^{-1-s}\\\\ & & -\\frac{3}{\\tilde{c}^2}\\omega_m\\beta_0\\left[\\frac{e^u}{\\bar{\\varphi}}\\right]^{-\\frac{3+s}{2r - s-3}}a^{-1-s}.\\nonumber\\end{aligned}\\ ] ]    before being implemented into the @xmath0-body code , the above equations must be discretised . for the poisson equation",
    "this is straightforward and we have @xmath165 = \\frac{3}{2}\\omega_ma\\left(\\tilde{\\rho}_{i , j , k}-1\\right),\\ \\ \\\\end{aligned}\\ ] ] where @xmath166 denotes the value of @xmath167 in the @xmath168-th cell of the simulation grid . the discretised nonlinear chameleon equation can be obtained in a similar way though it involves longer derivation , @xmath169 with the operator @xmath170 defined as    @xmath171\\nonumber\\\\ & & + \\frac{1}{h^2}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k}-u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right)+b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^2}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1}-u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right)+b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right]\\nonumber\\\\ & & + \\frac{3}{\\tilde{c}^2}\\omega_m\\beta_0\\left[\\frac{e^{u_{i , j , k}}}{\\bar{\\varphi}}\\right]^{-\\frac{3+s}{2r - s-3}}a^{-1-s}-\\frac{3}{\\tilde{c}^2}\\omega_m\\beta_0\\tilde{\\rho}\\left[\\frac{e^{u_{i , j , k}}}{\\bar{\\varphi}}\\right]^{-\\frac{s}{2r - s-3}}a^{-1-s}.\\end{aligned}\\ ] ]    here @xmath172 , @xmath173 and @xmath174 is the cell size in the simulation grid . is also used in this paper to denote @xmath175 , but there should be no confusion since it is easy to understand its actual meaning based on the context . ]    in our simulation , eq .",
    "( [ eq : sf_discrete ] ) will be solved using the newton gauss - seidel relaxation method , described as @xmath176 where    @xmath177\\nonumber\\\\ & & -\\frac{\\tilde{c}^2}{2h^2}\\big[b_{i+1,j , k}+b_{i-1,j , k}+b_{i , j+1,k}+b_{i , j-1,k}+b_{i , j , k+1}+b_{i , j , k-1}+6b_{i , j , k}\\big]\\nonumber\\\\ & & + 3\\omega_ma_2e^u_{i , j , k}a^2\\left[a^{2r-3}+\\frac{2r-3}{s}\\frac{u_{i , j , k}}{\\bar{\\varphi}}\\right]^{-\\frac{3}{2r-3}}-\\frac{1}{\\xi^2}e^{u_{i , j , k}}a^2\\left[a^{2r-3}+\\frac{2r-3}{s}\\frac{u_{i , j , k}}{\\bar{\\varphi}}\\right]^{-\\frac{2r}{2r-3}}\\nonumber\\\\ & & -3\\omega_ma_2\\tilde{\\rho}a^{-2}e^{u_{i , j , k}}.\\end{aligned}\\ ] ]",
    "[ tab : test_models ]    .the parameter values for the seven models used in the code test . [ cols=\"<,^,^,^,^\",options=\"header \" , ]     [ tab : models_chameleon ]      the most direct way to see the effect of modified gravity on the clustering of matter is to look at the matter power spectrum @xmath178 . for this",
    "we have measured the @xmath178 for our generalised chameleon theories and the @xmath2cdm paradigm using powmes @xcite , and calculated the relative difference @xmath179 .",
    "the results are shown in figs .",
    "[ fig : pk_z0 ] and [ fig : pk_z1 ] .    in figs .",
    "[ fig : pk_z0 ] and [ fig : pk_z1 ] , we can see that both the linear perturbation results ( the smooth curves ) and the simulation predictions ( symbols ) follow the trend as we have expected ( see   [ subsect : effect_param ] ) .",
    "the linear perturbation prediction significantly overestimates the relative growth with respect to that in @xmath2cdm model in all cases , similar to what we found in the dilaton , symmetron and @xmath15 gravity simulations @xcite . in particular",
    ", we notice from these figures that , linear perturbation theory fails whenever it predicts a deviation from @xmath2cdm , and this can happen on scales as large as @xmath3mpc@xmath180 .",
    "this result casts strong doubts on all the efforts which have been made to constrain chameleon - type theories using linear theory predictions , and shows once again the crucial role played by nonlinear simulations .",
    "it may seem to be surprising that linear theory breaks down on large scales which can be well described by it in standard cosmology , and the reason is that the chameleon theory itself is nonlinear , and this nonlinearity is in addition to the usual nonlinearity in real matter distributions .",
    "consequently , in the fifth - force calculation different fourier modes of the density field strongly couple and the fifth force for large - scale modes depends on the matter perturbation on smaller scales . in linear perturbation theory ,",
    "such mode coupling has been suppressed . another way to understand",
    "the point is the following : in linear theory , the fifth force ( is assumed to ) depend only on the background matter density , while in nonlinear simulations it actually depends on the matter density inside overdensities which is generally higher than the background density and therefore makes it more suppressed due to the chameleon mechanism .",
    "note that the agreement between linear perturbation theory and @xmath0-body simulation results is up to smaller scales at @xmath181 than at @xmath129 , but this is most likely because both approaches predict smaller deviations from @xmath2cdm at earlier times when the matter density is higher overall , rather than because linear theory works better at higher redshifts when density perturbations are small .",
    "indeed , a direct comparison between figs .",
    "[ fig : pk_z0 ] and [ fig : pk_z1 ] confirms that the ( nonlinear ) chameleon effect is much stronger at early times .",
    "the upper left panel of fig .",
    "[ fig : pk_z0 ] shows the effect of varying @xmath128 while all the other parameters are fixed to their baseline values ( c.f .",
    "table  [ tab : models_chameleon ] ) .",
    "as shown , @xmath179 increases when @xmath128 rises .",
    "specifically , we increase and decrease @xmath128 around @xmath182 ( which is the value of the baseline model ) by 50% in models a1 and a2 respectively , and find strong variations in the linear theory predictions of @xmath179 . the simulation result of @xmath179 , however , is smaller than @xmath183 down to @xmath184mpc@xmath180 even at @xmath129 .",
    "this small deviation is beyond the precision of all current cosmological probes . recall that @xmath128 here is chosen to have the same value as that in the dilaton simulations of @xcite , where @xmath179 can be more than @xmath185  this shows clearly that the chameleon screening is much more efficient in restoring gr in dense regions .",
    "the upper right panel of fig .",
    "[ fig : pk_z0 ] shows the effects of varying @xmath131 while other parameters are all fixed to the baseline values .",
    "the result is again consistent with the analysis in ",
    "[ subsect : effect_param ] , namely , @xmath179 grows as @xmath131 drops because a smaller @xmath131 means a less massive scalar field in the past or , thanks to the tomography mapping , in dense regions . for example",
    ", the chameleon screening in model b1 is less efficient than that in b3 at @xmath133 , making gravity relatively stronger in the former during most of the the evolution history , which is why the accumulated effect on matter clustering is much more significant in b1 .",
    "the lower left panel of fig .",
    "[ fig : pk_z0 ] illustrates the effect of varying @xmath99 while other parameters are fixed to the baseline values .",
    "as expected , @xmath179 drops as @xmath99 decreases , which is because a smaller coupling in the past or in dense regions necessarily means a weaker fifth force and therefore a decrease in the matter clustering . as we mentioned above , to avoid the unwanted anti - chameleon effect we have to choose @xmath186 , which means that the baseline model , with @xmath187 , gives the _ largest possible _ deviation from @xmath2cdm , which is @xmath188 at @xmath184mpc@xmath180",
    " this clearly implies that @xmath99 is practically unconstrained except that @xmath186 .    finally , in the lower right panel of fig .",
    "[ fig : pk_z0 ] we have shown the effect of varying @xmath84 with all other parameters fixed . since @xmath84 is inversely proportional to @xmath132 , an increase in @xmath84 results in a smaller scalar field mass throughout the evolution history and therefore more structures form due to the weaker suppression of the fifth force .",
    "this is exactly what we see in this panel .",
    "overall , figs .",
    "[ fig : pk_z0 ] and [ fig : pk_z1 ] indicate that observational data on the matter clustering at present and in the near future will hardly place any strong constraints on the chameleon - type modified gravity theories .",
    "one therefore has to look at other cosmological probes , such as the halo mass functions and void properties , to detect any observable signatures of these theories .",
    "we will study the former in the next subsection and leave the latter to future work .",
    "note that the models we study in this work generally have a much stronger chameleon effect compared to the @xmath15 models simulated in @xcite , which are the hu - sawicki model @xcite with @xmath189 and @xmath190 respectively and @xmath191 , see @xcite or @xcite . here",
    "we will quote the results rather than give a thorough review . ] . from eqs .",
    "( 12 , 13 , 18 ) of @xcite , it is straightforward to find @xmath192 from this expression we can immediately learn two things .",
    "first , the @xmath84 parameter in the hu - sawicki @xmath15 model is given by @xmath193 taking @xmath194 , @xmath195 and @xmath196 , we have @xmath197 .",
    "second , @xmath13 is a power - law function @xmath198 with @xmath199 for @xmath200 , while for @xmath201 then @xmath13 stays almost a constant .",
    "in addition to these , it is well known that @xmath15 gravity is a special case of chameleon theories with @xmath202 and @xmath187 .",
    "judging form the values of @xmath203 and @xmath128 , it may seem that the hu - sawicki model with @xmath196 should lead to smaller deviation from @xmath2cdm than the baseline model .",
    "it looks even more so if one considers that @xmath204 for small @xmath95 , and this seems to be inconsistent with the simulations .",
    "note here , however , that @xmath199 only happens for @xmath205 when the fifth force is negligible anyway , and at @xmath206 @xmath12 stays around @xmath132 so that the fifth force is indeed less suppressed than in the baseline model here .",
    "we measured the dark matter halo mass functions from our simulations using the publicly available code ahf @xcite , which is efficiently parallelised using mpi and openmp .",
    "we define the halo mass as the total mass contained in @xmath207 , the radius at which the average matter density inside drops below 200 times the critical density . for each model",
    ", we have calculated the binned relative difference in mass function with respect to that of the @xmath2cdm model ( see @xcite for details ) .    in figs .",
    "[ fig : mf_z0 ] and [ fig : mf_z1 ] we show the ratios between the chameleon and @xmath2cdm mass functions from our simulations at @xmath129 and @xmath181 respectively . from these figures",
    "it can be seen clearly that the fifth force leads to an overall enhancement of the formation of dark matter halos , and the effect is stronger on the low - mass end of the mass function .",
    "the maximum @xmath208 is around 50% for the models we simulated . at @xmath129 , halos with mass @xmath209 are generally well screened , while at @xmath181 , smaller halos with mass @xmath210 can also be well screened in some , if not all , cases .",
    "the effects of varying the different chameleon parameters are generally the same as what we have expected or have seen in the plots of @xmath179 , namely , @xmath208 increases as @xmath211 and @xmath84 increases or @xmath131 decreases .",
    "different from the case of matter power spectra , however , the mass functions in chameleon theories show larger deviations from that of @xmath2cdm , particularly in the low - mass end .",
    "a nontrivial feature in fig .  [ fig : mf_z0 ] is the turnover on @xmath208 for models b1 , b2 , d1 and d2 . without loss of generality ,",
    "let us take model d2 as an example and compare to the @xmath15 model with @xmath212 ( f6 ) simulated in @xcite . in both cases ,",
    "the largest halos in the simulation box are well - screened , both by themselves and by their environment ( because large halos tend to be produced out of very dense regions ) .",
    "when the halo mass decreases , the self - screening becomes weaker and the halo has a higher probability of living in average , or even underdense , regions  the weakened screening means more matter clustering and production of more halos .",
    "of course , there is a limited supply of matter to be incorporated into halos , and when more large halos are formed there will be fewer small halos surviving the mergers and accretions , that has caused the turn - over .",
    "this is the same as what is found for the f6 model in @xcite ( see fig .",
    "11 therein ) and also complies with the analytical results of @xcite .",
    "the chameleon effect in the rest of our simulated models is too strong so that even low mass halos get screened to a certain extent , making the growing trend with mass at the low mass end disappear .",
    "this can be seen by looking at the d2 model in fig [ fig : mf_z1 ] : the turnover disappears simply because the chameleon is more efficient at higher redshifts .",
    "also note that at @xmath181 the suppression of the fifth force is so strong that the deviation from @xmath2cdm almost vanishes for most models , which is the same as we have seen in the @xmath179 plots above .",
    "to summarise , in this paper we have brought together two essential techniques for the systematic studies of the nonlinear structure formation in generic modified gravity theories of the chameleon type : a simple parameterisation scheme which covers all known chameleon theories using only four parameters and a modified version of the ecosmog code to run high - resolution simulations efficiently .",
    "this allows us , for the first time , to get an overall picture about the behaviour of general chameleon - type theories and the part of its parameter space which is relevant for cosmology .",
    "the powerful tomography mapping @xcite enables us to characterise the chameleon theory and its generalisations using only a few parameters . in our case , there are two parameters describing the present value of the scalar field mass ( @xmath84 ) and its time evolution ( @xmath131 ) , and another two parameters describing the current value of the coupling strength ( @xmath128 ) and its time evolution ( @xmath99 ) .",
    "these 4 parameters cover most chameleon theories studied in the literature @xcite , and also the cases with varying ( field - dependent ) coupling to _ nonlinear _ structure formation which have not been thoroughly investigated so far .    following the logic of @xcite , here we focus on the qualitative and quantitative behaviour of the generalised chameleon theory .",
    "we are interested not only in how varying the parameters changes the predictions of cosmological observables , but also in how large the changes could be such that we can decide which portion of the 4d parameter space would be of interest to cosmologists and therefore merits further ( and more detailed ) investigations in the future . as a by product , we want to compare the efficiencies of the different screening mechanisms that have been explored by theorists  the chameleon , dilaton and symmetron mechanisms .    to this end",
    ", we have simulated a total of 12 models which form an extensive span in the parameter space .",
    "starting from a default model with @xmath213 , we let each of the 4 parameters vary and take a few different values as summarised in table  [ tab : models_chameleon ] . in this way",
    ", we can see clearly the effect of changing every parameter .      1",
    ".   increases @xmath128 , which results in an overall increase in the coupling strength between matter and the scalar field ; 2 .   increases @xmath99 , which makes the coupling strength reduce more slowly as the matter density increases ; 3 .   increases @xmath84 , which increases the range of the fifth force overall , or 4",
    ".   decreases @xmath131 , which makes the fifth force less exponentially suppressed in high - density regions .",
    "there are a few noticeable features which can be seen from the nonlinear matter power spectrum predicted by our simulations .",
    "the first is that , as in the cases of dilaton @xcite and @xmath15 gravity @xcite models where the screening is strong , linear perturbation theory fails for general chameleon theories wherever it predicts a deviation from @xmath2cdm .",
    "the scale at which linear theory breaks down can be as large as @xmath214mpc@xmath180 : this is typically the scale where it is assumed to be valid .",
    "this casts doubts about the reliability of the works in which linear theory predictions are used to constrain modified gravity theories such as chameleon , dilaton , symmetron and @xmath15 gravity .",
    "another feature of the chameleon theory is its efficiency of screening .",
    "the model parameters here , such as @xmath128 and @xmath84 , are chosen to be roughly the same as those in our previous dilaton and symmetron simulations @xcite , but whilst the nonlinear matter power spectra in those models can differ from those in @xmath2cdm by more than @xmath215% , chameleon theories generally predict much smaller deviations ( @xmath216 ) , indicating that the chameleon screening could restore gr much more easily . for the same reason , the effect of the fifth force also diminishes more quickly backwards in time , compared to the symmetron and dilaton cases @xcite ",
    "indeed at redshift @xmath181 the fifth force is almost completely screened in all our simulated models except for b1 , which has @xmath217 , meaning that the scalar field mass @xmath12 increases more slowly with matter density .",
    "the result implies that the strength of the fifth force is very sensitive to @xmath131 , which is , of course , as expected .",
    "similar features can also be seen from the dark matter halo mass functions . here",
    "we find that , compared with the dilaton and symmetron theories @xcite , the deviations from @xmath2cdm are more suppressed in the high - mass end , which can be because large halos are more efficient in self - screening and also tend to be more screened by the environment because they are more likely to live in high - density environments .",
    "this is qualitatively similar to what we see in @xmath15 gravity simulations @xcite .",
    "notice that the time evolution of the halo mass function shows the same pattern as the nonlinear matter power spectra , namely that at @xmath181 the deviation from @xmath2cdm is very small .",
    "the high efficiency in chameleon screening means that our choices of the parameter values might be too conservative : a deviation from the @xmath2cdm matter power spectrum of @xmath216 can hardly be detected with precision in the near future , especially because the deviations are mostly on small scales where baryonic physics and other effects could already be important .",
    "consequently , we think that future simulations of chameleon - type theories should be done for less conservative choices of parameters , namely larger values of @xmath218 and smaller values for @xmath131 .",
    "we hope that this work can serve as a useful guidance for such future works .",
    "acd is supported in part by stfc .",
    "bl acknowledges supports by the royal astronomical society and durham university .",
    "haw thanks the research council of norway frinat grant 197251/v30 for support and durham university for the hospitality where part of this work was carried out .",
    "gbz is supported by a dennis sciama fellowship at the university of portsmouth .",
    "pb is partially supported by anr blanc 2010 041301 .",
    "the simulations and the post - process of the simulation data were performed on the sciama machine at the university of portsmouth and on the cosma supercomputer at durham university ."
  ],
  "abstract_text": [
    "<S> in this work we systematically study the linear and nonlinear structure formation in chameleon theories of modified gravity , using a generic parameterisation which describes a large class of models using only 4 parameters . </S>",
    "<S> for this we have modified the @xmath0-body simulation code ecosmog to perform a total of @xmath1 simulations for different models and parameter values , including the default @xmath2cdm . </S>",
    "<S> these simulations enable us to explore a significant portion of the parameter space . </S>",
    "<S> we have studied the effects of modified gravity on the matter power spectrum and mass function , and found a rich and interesting phenomenology where the difference with the @xmath2cdm paradigm can not be reproduced by a linear analysis even on scales as large as @xmath3 @xmath4 , since the latter incorrectly assumes that the modification of gravity depends only on the background matter density . </S>",
    "<S> our results show that the chameleon screening mechanism is significantly more efficient than other mechanisms such as the dilaton and symmetron , especially in high - density regions and at early times , and can serve as a guidance to determine the parts of the chameleon parameter space which are cosmologically interesting and thus merit further studies in the future . </S>"
  ]
}