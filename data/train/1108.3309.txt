{
  "article_text": [
    "all authors contributed extensively to the work presented in this paper .",
    "the authors declare no competing financial interests .",
    "supplementary information accompanies this paper at www.nature.com/naturephotonics .",
    "reprints and permission information is available online at http://www.nature.com/reprints . correspondence and requests for materials should be addressed to j.l.ob ."
  ],
  "abstract_text": [
    "<S> entanglement is the quintessential quantum mechanical phenomenon understood to lie at the heart of future quantum technologies and the subject of fundamental scientific investigations . </S>",
    "<S> mixture , resulting from noise , is often an unwanted result of interaction with an environment , but is also of fundamental interest , and is proposed to play a role in some biological processes . </S>",
    "<S> here we report an integrated waveguide device that can generate and completely characterize pure two - photon states with any amount of entanglement and arbitrary single - photon states with any amount of mixture . </S>",
    "<S> the device consists of a reconfigurable integrated quantum photonic circuit with eight voltage controlled phase shifters . </S>",
    "<S> we demonstrate that for thousands of randomly chosen configurations the device performs with high fidelity . </S>",
    "<S> we generate maximally and non - maximally entangled states , violate a bell - type inequality with a continuum of partially entangled states , and demonstrate generation of arbitrary one - qubit mixed states .    </S>",
    "<S> mechanics is known to allow fundamentally new modes of information processing@xcite , simulation@xcite , and communication @xcite as well as enhanced precision of measurement and sensing @xcite . </S>",
    "<S> single photons provide a particularly promising physical system with which to develop such quantum technologies@xcite  due to their low noise , high speed transmission and ease of manipulation at the single photon level  and have long been a leading approach to exploring fundamental quantum science . </S>",
    "<S> the ability to precisely prepare , control and measure multi - photon states therefore holds considerable scientific and technological interest .    </S>",
    "<S> recently it has been shown that it is possible to miniaturize quantum optical circuits using optical fibre @xcite and integrated waveguide chips @xcite . </S>",
    "<S> monolithic waveguide circuits are inherently stable and can be many orders of magnitude smaller than their bulk optical equivalents , enabling the fabrication of multi - purpose , reconfigurable quantum circuits of unprecedented size and complexity . </S>",
    "<S> control of a single phase shifter in this architecture has been used to manipulate time bin qubits @xcite and up to four photons in two spatial modes@xcite , however , the large - scale reconfigurability required to generate arbitrary multi - photon states , including mixture and entanglement , has so far been out of reach .    </S>",
    "<S> here we report an integrated quantum photonic device comprised of a two - qubit entangling gate , several hadamard - like gates , and eight variable phase shifters , and demonstrate that it can be reconfigured with high fidelity across the complete space of possible configurations . </S>",
    "<S> we use this device to generate all four bell states and perform quantum state tomography on them , to realise a bell inequality  manifold \" obtained from a continuum of measurement settings and states with a variable amount of entanglement  and to prepare and measure arbitrary single - photon mixed states .     </S>",
    "<S> ( where @xmath0 is the usual hadamard gate ) and @xmath1 rotations , that together implement @xmath2 , and two @xmath3 gates and a controlled - sign or cz gate , that together implement a cnot . </S>",
    "<S> * b * waveguide implementation of the circuit composed of directional couplers and voltage controlled thermo - optic phase shifters drawn as orange triangles . </S>",
    "<S> directional couplers with splitting ratio @xmath4 are marked with a dot , all other couplers have @xmath5.,width=326 ]    * a reconfigurable quantum photonic circuit *    the device described here is a silica - on - silicon entangling circuit , shown in fig . [ </S>",
    "<S> fig : chip ] . two photonic qubits </S>",
    "<S> @xmath6 and @xmath7 are encoded in pairs of waveguides  path or dual rail encoding . </S>",
    "<S> these two qubits are input in the logical zero state @xmath8 _ i.e. _ a single photon in each upper waveguide  and are then acted upon by the quantum circuit shown in fig .  </S>",
    "<S> [ fig : chip ] .        </S>",
    "<S> the first part of this circuit enables arbitrary state preparation of each qubit . </S>",
    "<S> the central part of the circuit implements a maximally entangling postselected controlled - not ( cnot ) logic gate @xcite  the canonical two - qubit entangling gate . </S>",
    "<S> the cnot gate is a postselected linear optical gate that works with probability 1/9 @xcite . </S>",
    "<S> the final stage of the circuit is the mirror image of the first stage and is followed by measurement in the computational basis , which together enables projective measurement of each qubit in an arbitrary basis </S>",
    "<S> .    the initial and final stages of the device can be reconfigured , and are each implemented using two mz interferometers , each composed of two voltage - controlled thermal phase shifters and two directional couplers @xcite . </S>",
    "<S> this architecture allows reconfigurable single - qubit unitary operations to be performed : in general any unitary in @xmath9 can be realised using three phase shifters and an mz interferometer @xcite as @xmath10 . </S>",
    "<S> here we use two phase shifters per mz to realise @xmath11 on each of the two input qubits , and @xmath12 on each output qubit of the cnot gate . </S>",
    "<S> this is adequate for arbitrary , separable two - qubit state preparation and measurement , up to a global phase . </S>",
    "<S> explicitly , the entire circuit shown in fig .  </S>",
    "<S> [ fig : chip ] implements the unitary matrix @xmath13 \\cdot \\hat{u}_{cnot } \\cdot \\\\ \\left [   \\hat{u}_{i}\\left(\\phi_{1 } , \\phi_{2 } \\right ) \\kron \\hat{u}_{i}\\left(\\phi_{3 } , \\phi_{4 } \\right ) \\right ] \\end{aligned}\\ ] ] where @xmath14 and @xmath15 are set by the external control voltages .    </S>",
    "<S> * benchmarking of reconfigurability *    this circuit can be reconfigured to perform a number of different tasks , including arbitrary two - qubit pure ( entangled ) state preparation , arbitrary one - qubit ( mixed ) state preparation , state tomography , process tomography , _ etc . </S>",
    "<S> _ , as detailed below . </S>",
    "<S> in order to characterize the precision and accuracy with which the device can be reconfigured we injected single photons into the device via a polarization maintaining optical fibre array , and measured interference fringes across each of the eight phase shifters on the chip , finding an average contrast c = 0.988 @xmath16 0.008 . </S>",
    "<S> ( see methods for details . ) </S>",
    "<S> an example of a pair of such fringes is shown in fig . </S>",
    "<S> [ fig : dip]*a*. from these measurements , we estimate the average accuracy in phase across all eight heaters to be @xmath17 radians ( see supplementary information ) .    </S>",
    "<S> in addition to high - fidelity classical interference , as demonstrated in fig . [ </S>",
    "<S> fig : dip]a , the cnot gate in the middle of the circuit shown in fig [ fig : chip ] relies on high - fidelity quantum interference@xcite . </S>",
    "<S> fig . </S>",
    "<S> [ fig : dip]b shows a hong - ou - mandel dip@xcite measured at a single mz interferometer ( that containing @xmath18 ) on the chip . </S>",
    "<S> we produced degenerate photon pairs , sharing the same spectral and polarization mode , via type - i spontaneous parametric downconversion@xcite ( see methods ) which were injected into the chip as shown in fig . </S>",
    "<S> [ fig : chip ] . </S>",
    "<S> the phase in the interferometer was then set to @xmath19 , rendering it equivalent to a @xmath20 reflectivity beamsplitter , and the two - photon coincidence count @xmath21 across the outputs of the interferometer was measured as a function of an off - chip optical delay between the arrival times of the two photons . </S>",
    "<S> the visibility of the dip @xmath22 was measured to be @xmath23 , taking into account the measured rate of accidental coincidences@xcite . </S>",
    "<S> birefringence , mode mismatch , and other such imperfections in the circuit could limit the visibility of this dip . </S>",
    "<S> the high visibility of the hom dip therefore indicates the high quality of the device .    </S>",
    "<S> having observed high - fidelity classical and quantum interference at individual mz interferometers on the chip , we then used a stochastic method to characterise the operational performance of the quantum circuit as a whole , across the full space of possible configurations . </S>",
    "<S> we chose , at random , @xmath24 vectors @xmath25 representing possible configurations of the device @xmath26\\ ] ] with @xmath27 . injecting photon pairs as before , </S>",
    "<S> the probability - theoretic fidelity @xmath28 between experimentally measured coincidence probabilities at the output of the device @xmath29 and the ideal theoretical values @xmath30 was calculated for each @xmath25 . </S>",
    "<S> the statistical distribution of these fidelities is shown in fig . </S>",
    "<S> [ fig : histogram]a . the average fidelity across @xmath24 configurations ( equivalent to many truth tables in many bases ) was measured to be 0.990@xmath160.009 with 96% of configurations @xmath25 producing photon statistics with @xmath31 0.97 . </S>",
    "<S> this result depends on simultaneous high fidelity quantum and classical interference , as well as accurate and precise joint control of all eight phase controllers . </S>",
    "<S> poor performance of any of these component parts would result in lower fidelity output for some subset of @xmath32 . </S>",
    "<S> the high fidelity operation observed in these tests of reconfigurability bodes well for the operations described below .    . </S>",
    "<S> 96% of phase settings produced statistics corresponding with theory to @xmath31 0.97.,width=326 ]    * generating and characterising entanglement *    entangled states of quantum systems are the fundamental resource in quantum information and represent the most nonclassical implication of the formalism of quantum mechanics . </S>",
    "<S> the circuit shown in fig . </S>",
    "<S> [ fig : chip ] can be used to prepare a continuum of entangled , partially entangled , and separable states with only computational - basis product states as input .    in order to demonstrate this ability , we first prepared and analysed each of the four maximally entangled bell states . </S>",
    "<S> inputting the @xmath33 state as before , the state preparation stage of the circuit was used to generate each of the superposition states @xmath34 , @xmath35 , where @xmath36 , at the input of the cnot gate . </S>",
    "<S> the corresponding bell states ( @xmath37 and @xmath38 respectively ) are ideally produced by the cnot gate .    </S>",
    "<S> we used the arbitrary single - qubit measurement capability of the circuit to perform maximum - likelihood quantum state tomography ( qst)@xcite on these four states : phase shifters @xmath39 were used to implement each of the 16 measurements necessary to reconstruct the density operator of the state . </S>",
    "<S> the measured density matrices of all four bell states are shown in fig . </S>",
    "<S> [ fig : bells ] , with quantum state fidelities @xmath40 of @xmath41 , @xmath42 , @xmath43 , and @xmath44 respectively .    , @xmath45 , @xmath46 and @xmath47 ( * a*,*b*,*c*,*d * respectively . ) , width=278 ]        * a bell - type inequality manifold *    the clauser , horne , shimony , and holt ( chsh)@xcite test of local hidden - variable models of quantum mechanics requires that the sum @xmath48 satisfies the bell - chsh inequality @xmath49 for any local hidden - variable model , where @xmath50 , @xmath51 are measurement operators chosen by two observers , alice and bob .    </S>",
    "<S> the bell - chsh experiment provides a well - known test for the presence of entanglement that we use here to examine the performance of the device , as it is reconfigured across a large parameter space . </S>",
    "<S> specifically , we use @xmath52 and the cnot gate to prepare the state @xmath53,\\ ] ] where @xmath54 . by changing @xmath55 </S>",
    "<S> it is thus possible to tune continuously between two orthogonal maximally entangled states : for @xmath56 , @xmath57 is a product state , and with @xmath58 , @xmath57 is the maximally entangled state @xmath59 ( up to a global phase ) . in the course of this preparation , we pass through a continuum of partially entangled states . in order to evaluate @xmath60 we make four two - qubit measurements on the state emerging from the cnot gate , which correspond to combinations of observables chosen by alice and bob . </S>",
    "<S> while alice s two measurement settings , @xmath61 , do not change , bob s two measurement settings are varied continuously , as @xmath62 . </S>",
    "<S> we measured @xmath63 for @xmath64 $ ] and @xmath65 $ ] , with step size @xmath66 , producing the `` bell manifold '' shown in fig . </S>",
    "<S> [ fig : chsh ] . we measured maximum and minimum values of @xmath60 of @xmath67 and @xmath68 respectively . </S>",
    "<S> errors were again determined by a monte - carlo technique , assuming poissonian statistics .    in order to quantitatively </S>",
    "<S> compare the theoretical manifold with experimental data , we used the quantity @xmath69 where @xmath70 are experimentally measured values of the bell - chsh sum , @xmath71 is the average over @xmath70 , and @xmath72 are the theoretical values of @xmath60 shown in fig . </S>",
    "<S> [ fig : chsh]a . in the ideal case , @xmath73 . for the data shown in fig . </S>",
    "<S> [ fig : chsh]b , @xmath74 .    * generating and characterising mixture *    mixture is often associated with noise or decoherence in quantum processes and its deliberate and controlled implementation is critical for characterisation of devices ; furthermore it has been shown that quantum computing can be performed despite mixture @xcite . </S>",
    "<S> more significantly , recent work has suggested that decoherence may play an important role in biological processes that exhibit quantum coherence @xcite ; photonic waveguide systems show great promise for simulating these processes @xcite , however , such simulations will require the controlled introduction of mixture .    </S>",
    "<S> by tracing over one of the two output photons , our device can prepare an arbitrary state of a single qubit including any amount of mixture@xcite . </S>",
    "<S> the amount of entanglement in the two qubit state prepared by the first stage of the device determines the degree of mixture , which can range from zero ( a pure state ) to one ( a maximally mixed state ) .    in general the state @xmath75 </S>",
    "<S> is generated after the cnot gate in the circuit , where @xmath55 , @xmath76 , @xmath77 , @xmath78 are complex parameters related to @xmath52 . </S>",
    "<S> tracing out the second qubit , we find the reduced density operator of qubit a , @xmath79 by choosing @xmath55 , @xmath76 , @xmath77 , @xmath78 , via setting @xmath52 , the amount of mixture in this reduced density matrix can be continuously varied between 0 and 1 .    </S>",
    "<S> we chose 119 target states with various amounts of mixture , at random by the hilbert - schmidt measure@xcite , then generated each state and reconstructed its density matrix by maximum likelihood state tomography using phase shifters @xmath80 and @xmath81 . </S>",
    "<S> fig . </S>",
    "<S> [ fig : mixedstates ] shows the fidelity of these reconstructed states . </S>",
    "<S> the average quantum state fidelity across all 119 states was measured to be @xmath82 , with 91% of states having fidelity @xmath83 . </S>",
    "<S> we then chose 63 specific mixed states that mapped out the symbol ` @xmath84 ' inside the bloch sphere , and generated them with high fidelity ( fig . </S>",
    "<S> [ fig : mixedstates ] , inset ) .    </S>",
    "<S> we note that the device shown in fig . 1 could be used to generate mixture by applying random voltages to phase shifters on a single qubit , without the need for entanglement . </S>",
    "<S> we chose to use the entanglement approach as a more demanding test of our device , demonstrating sufficient control to obtain the data shown in fig . </S>",
    "<S> 6 . </S>",
    "<S> an advantage of using the entanglement approach in practical applications is that it does not require pseudo-/quantum - random number generators .    </S>",
    "<S> * discussion * + quantum information science and technology with photons will require circuits that are complex , stable and highly reconfigurable in a straightforward manner . </S>",
    "<S> high fidelity production and measurement of states of arbitrary entanglement and mixture will be essential for characterisation of quantum devices , and will provide a reliable means to test the unique properties of quantum physics . </S>",
    "<S> the generation of mixed states may also be important in quantum photonic analogues of biochemical systems that rely on decoherence @xcite .    </S>",
    "<S> although on - chip polarization encoding is possible@xcite , the inherent interferometric stability of integrated optics makes path encoding of qubits a natural choice , with the further advantage that encoding of higher - dimensional qudits@xcite is immediately possible . </S>",
    "<S> this is in contrast with bulk optics , where two - level polarization encoding is more natural , and stable path encoding requires a considerable resource overhead . </S>",
    "<S> furthermore , this architecture could be used to manipulate hyper - entanglement @xcite encoded with multiple degrees of freedom @xcite . </S>",
    "<S> circuits such as the one presented here could be used in conjunction with adaptive ( classical ) algorithms to bypass the need for calibration of the phase shifters in particular applications . </S>",
    "<S> for example , repeated measurement and feedback onto the voltage - controlled phase shifters based on comparison of the output state with a desired target state could be used to reconfigure the circuit via a genetic algorithm .     </S>",
    "<S> drawn in the bloch sphere using 63 mixed states , again generated and characterized on - chip . </S>",
    "<S> these states are chosen from the real plane of the sphere for clarity . </S>",
    "<S> note that each point is derived from a different bipartite partially entangled state.,width=326 ]    * methods * + _ device : _ the waveguide device was fabricated on a silicon wafer , upon which a 16@xmath85 m layer of undoped silica was deposited to form the lower cladding of the waveguides . </S>",
    "<S> 3.5-@xmath85m - wide waveguides were then patterned in a 3.5-@xmath85 m layer of silica doped with germanium and boron oxides . </S>",
    "<S> a 16-@xmath85 m layer of silica , doped with phosphorous and boron so as to be index - matched with the lower layer , constitutes the upper cladding . </S>",
    "<S> resistive heaters and corresponding electric contacts were then patterned in metal on top of the chip using standard lithographic techniques . </S>",
    "<S> dimensions of the chip are 70 mm @xmath86 3 mm .    </S>",
    "<S> _ photon source : _ degenerate pairs of 808 nm photons were generated by focusing a 404 nm , 60mw laser onto a 2 mm thick , bisumuth borate @xmath87 ( bibo ) nonlinear crystal , phase matched for type i spontaneous parametric down conversion ( opening angle of 3 degrees ) .    photon pairs were spectrally filtered using 3 nm full - width at half maximum interference filters . </S>",
    "<S> the interference filters were designed with central wavelength 808 nm and were tilted to ensure that photon pairs were identically filtered . </S>",
    "<S> photons were then collected into polarisation maintaining fibre ( pmf ) using 11 mm aspheric lenses . </S>",
    "<S> typical two - photon coincidence count rates of 100khz were achieved using @xmath88 efficient , silicon based avalanche photo - diode single photon counting modules ( spcm ) . </S>",
    "<S> the photons were then launched into the waveguide chip by butt - coupling arrays of pmf with 250@xmath85 m spacing ( matched to the input and output waveguide pitch ) . </S>",
    "<S> photons were collected from the output of the chip also using arrays of polarisation maintaining fibre and detected with fibre coupled spcms . </S>",
    "<S> a typical facet - to - facet coupling efficiency of @xmath88 was achieved .    </S>",
    "<S> _ calibration of phase shifters : _ each thermal phase shifter @xmath89 has a nonlinear phase voltage relationship : @xmath90 where @xmath91 is the voltage applied across phase shifter @xmath92 and @xmath89 is the resulting phase shift . </S>",
    "<S> @xmath93 , @xmath94 , @xmath95 and @xmath96 are real numbers associated with the response of a particular heater . </S>",
    "<S> each phase shifter can be seen to occupy one particular mz interferometer in the circuit . @xmath97 and </S>",
    "<S> @xmath98 can be seen as acting on a single , lossy mz interferometer .    </S>",
    "<S> each phase shifter in the circuit was calibrated as follows : bright light from an 810 nm 1.3mw laser was injected into one input port of each mz , and the intensity at each output port was measured as a function of the voltage applied across the heater , which was swept linearly between 0v and 7v . </S>",
    "<S> this produced classical interference fringes , distorted by the nonlinear phase - voltage relationship ( [ eqn : phasevoltage ] ) . </S>",
    "<S> we then fitted the function @xmath99 to each set of experimental data with @xmath6 , @xmath100 , @xmath55 , @xmath76 , @xmath77 and @xmath78 as fitting parameters . </S>",
    "<S> this yields the complete ( approximate ) phase - voltage relationship for each heater . </S>",
    "<S> no evidence of crosstalk between phase shifters ( due to thermal effects or otherwise ) was observed in these experiments .    _ </S>",
    "<S> single - photon fringes : _ we measured single photon fringes for each phase shifter using photon pairs from the source . injecting photons from one arm of the source into the chip , we counted coincidences between single photon events from a particular output of the interferometer , and those from the other arm of the source . </S>",
    "<S> this approach largely mitigates the contribution of spcm dark counts . </S>",
    "<S> the fit shown in fig . </S>",
    "<S> [ fig : dip ] has the form @xmath101 where @xmath100 is the fringe contrast and @xmath6 is the amplitude . </S>",
    "<S> each fringe is normalized with respect to its amplitude for clarity .    </S>",
    "<S> 10 url # 1`#1`urlprefix[2]#2 [ 2][]#2    & _ _ ( , ) .    . </S>",
    "<S> _ _ * * , ( ) .    . </S>",
    "<S> _ _ * * , ( ) .    . </S>",
    "<S> _ _ * * , ( ) .    & . </S>",
    "<S> _ _ * * , ( ) .    , & . </S>",
    "<S> _ _ * * , ( ) . .    </S>",
    "<S> _ _ * * , ( ) .    , & . </S>",
    "<S> _ _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ * * , ( ) .    , & . </S>",
    "<S> _ _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & </S>",
    "<S> _ _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ * * , ( ) . .    , </S>",
    "<S> & . _ </S>",
    "<S> _ * * , ( ) .    </S>",
    "<S> _ et  al . _ . _ </S>",
    "<S> _ * * , ( ) .    </S>",
    "<S> _ et  al . _ . _ </S>",
    "<S> _ * * , ( ) .    </S>",
    "<S> , , , & . </S>",
    "<S> _ _ * * , ( ) .    , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) .    & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) .    , & . </S>",
    "<S> _ _ * * , ( ) .    & . </S>",
    "<S> _ _ * * , ( ) .    </S>",
    "<S> _ et  al . _ . _ </S>",
    "<S> _ * * , ( ) .    </S>",
    "<S> , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) . .    & </S>",
    "<S> _ _ * * , ( ) .    </S>",
    "<S> _ et  al . _ . _ </S>",
    "<S> _ * * , ( ) .    </S>",
    "<S> _ et  al . _ . _ </S>",
    "<S> _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ ( ) .    & . </S>",
    "<S> _ _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ * * , ( ) .    , , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) .    , , & . </S>",
    "<S> _ _ * * , ( ) . </S>"
  ]
}