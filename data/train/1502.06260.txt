{
  "article_text": [
    "hyperspectral imaging techniques have been widely applied in various fields such as astronomy @xcite , remote sensing @xcite , and biomedical imaging @xcite . unlike ordinary imaging systems ,",
    "hyperspectral imagers capture a three - dimensional ( 3d ) datacube , _",
    "i.e. _ , a 2d array of vectors that contain the spectral information at each spatial location . inspired by compressive sensing ( cs )  @xcite , researchers have adopted joint sensing and reconstruction paradigms that measure a subset of the 3d spectral datacube  @xcite and utilize cs inversion algorithms to retrieve a 3d estimate of the underlying hyperspectral images .",
    "this sensing paradigm follows the traditional benefits of cs - reduced data rates and system complexity at the expense of computational algorithmic development and postprocessing .",
    "the coded aperture snapshot spectral imaging ( cassi )  @xcite systems are examples of cs hyperspectral imaging systems .",
    "the cassi paradigm encodes each of the datacube s spectral channels with a unique 2d pattern , which is the underlying operating principle behind code division multiple access ( cdma ) .",
    "cassi systems form an image onto a coded aperture placed at an intermediate image plane to spatially modulate the datacube with high - frequency patterns ( fig .",
    "[ fig : cassi_old ] ) .",
    "a disperser placed in a pupil plane behind the coded aperture spectrally shifts the coded image , effectively granting each spectral channel onto its own unique coding pattern when multiplexed onto a monochrome sensor . unlike other hyperspectral imaging techniques  @xcite",
    ", cassi can obtain a discrete 3d estimate of the target spectral datacube from as little as a single 2d measurement .",
    "such operation renders the system s forward model highly underdetermined ; inversion requires use of cs algorithms  @xcite .",
    "compressive hyperspectral imaging requires the signal under estimation to be sparse in a basis that is incoherent with the system sensing matrix  @xcite .",
    "the reconstruction is accomplished using optimization algorithms , such as gradient projection for sparse reconstruction ( gpsr )  @xcite or two - step iterative shrinkage / thresholding ( twist )  @xcite .",
    "gpsr assumes sparsity of the entire datacube in a fixed ( wavelet ) basis , while twist is based on a piecewise - constant spatial intensity model ( when the total variation norm is used ) for hyperspectral images .",
    "distinct from the above optimization algorithms , blind cs algorithms  @xcite have been applied to cassi systems by learning dictionaries from the measurements .",
    "blind cs inversion strategies seek to recover 3d patches of the hyperspectral datacube jointly with the shared dictionary ( inferred from the measurements ) .",
    "each patch is a sparse combination of the dictionary atoms .",
    "since the dictionary is _ unknown _ _ a priori _ , this is called _ blind _ cs  @xcite .",
    "this blind cs model shares statistical strengths among similar image patches at different spatial locations .",
    "additionally , this cs approach is task - driven since the learned dictionary is appropriate for different tasks  @xcite . in this paper",
    ", we propose a new blind cs model that imposes _ compressibility _",
    "@xcite , rather than sparsity , on the recovered dictionary coefficients .",
    "specifically , we use _ global - local shrinkage _",
    "priors @xcite on the dictionary coefficients for each patch , under a bayesian dictionary learning framework .",
    "this setting drives the reconstructed dictionary coefficient vector to contain many small ( _ i.e. _ , close to zero ) components while allowing for a few large components , but avoiding explicit sparsity enforcement .",
    "this model is feasible for high - dimensional hyperspectral signals since it can extract more information from the limited ( _ in situ _ learned ) dictionary atoms .",
    "the quality of the reconstructed hyperspectral images relies on the conditioning of the sensing matrix .",
    "more accurate recovery is possible with additional measurements of the same scene @xcite or by using digital micromirror ( dmd ) arrays  @xcite ; however , these methods increase system cost and energy consumption .",
    "this paper features a blind cs algorithm that employs the rgb image of the target scene ( as _ side information _ ) and demonstrates substantial improvements on reconstruction quality with a single cassi measurement .",
    "particularly , the proposed algorithm learns a joint dictionary from a single cassi measurement and the corresponding rgb image ( of the same scene ) and then reconstructs the hyperspectral datacube .",
    "since the rgb image is strongly correlated with the hyperspectral images , this joint model will dramatically aid the dictionary learning algorithm , thereby improving the reconstruction .",
    "furthermore , we propose a new camera using spatial - light modulation ( slm )  @xcite for an active coding compressive spectral imager , to jointly modulate the spatial and spectral information of the scene on the intermediate image plane .",
    "this technology differs from cassi and dmd - modulated cs imagers in that no dispersive element is required for multiplexing the spectral channels .",
    "the reminder of the paper is organized as follows .",
    "section  [ sec : hardware ] reviews the mathematical model of cassi and introduces the new camera .",
    "section  [ sec : algorithm ] develops the new blind cs algorithm to reconstruct hyperspectral images .",
    "experimental results are presented in section  [ sec : results ] , and section  [ sec : col ] summarizes the paper .",
    "in this section , we first review the cassi imaging process and then introduce the new camera . finally , a shared mathematical model for both cameras is proposed .",
    "a common cassi design  @xcite in fig .",
    "[ fig : cassi_old ] adapts the available hardware to encode and multiplex the 3d spatiospectral information @xmath0 onto a 2d detector .",
    "this modulation process is based on physically shifting the hyperspectral datacube multiplied by the binary coding pattern @xmath1 via chromatic dispersion .",
    "the coding pattern consists of an array of square , binary ( 100% or 0% transmission ) apertures , which provide full or zero photon transmission .",
    "the camera s disperser ( in traditional hyperspectral cs  @xcite , this is a prism or diffraction grating ) laterally displaces the image as a function of wavelength @xmath2 of the coded aperture pattern , where @xmath3 is the lateral wavelength - dependent shift and @xmath4 represents the disperser s central wavelength . as previously mentioned , this coding process can be considered a form of cdma , whereby each channel is modulated by an independent coding pattern on the detector plane .",
    "the detector integrates the spectrally - shifted planes along the spectral axis .",
    "information can be recovered by separating channels based on their projected coding patterns .",
    "this multiplexing process can be represented as the following mathematical forward model : @xmath5 where @xmath6 is the continuous form of the detector measurement , representing the sum of dispersed coded images .",
    "since the detector array has been spatially pixelated by the detector pixel pitch @xmath7 , the discreatized detector measurement becomes : @xmath8 finally , the discrete measurement for each pixel can be illustrated as : @xmath9 where @xmath10 is the spatially encoding pattern , @xmath11 represents the discretized spectral density of @xmath0 , and @xmath12 is the noise .",
    "here we use an slm to encode the 3d spatial - spectral information on a 2d gray - scale detector - a similar cdma strategy to cassi for snapshot hyperspectral imaging .",
    "an slm is an array of micro cells placed on a reflective layer ; each cell has a nematic liquid crystal that adds pixel - level phase to the incident light as a function of voltage , thereby changing the polarization state on a per - pixel basis @xcite .",
    "each layer of the lc can be considered as a thin optical birefringence material ; the orientation and the relative refractive index difference between the fast and slow axes determines the effective birefringence .",
    "since most birefringent phase modulators are nominally sensitive to wavelength , this element can assign wavelength - dependent transmission patterns to multiplex every spectral channels for the compressive measurement .",
    "the hyperspectral slices can be separated from the coded data via cs inversion algorithms .",
    "a schematic of this slm - based cassi system is shown in fig .",
    "[ fig : system ] . an objective lens ( l1 )",
    "images the scene from a remote distance , and then the collimation lens ( l2 ) and imaging lens ( l3 ) relay the image through the polarizing beamsplitter and the achromatic quarter - wave retarder onto the slm .",
    "the retarder serves to increase the contrast of the slm polarization array by compensating the extra phase retardation in the liquid crystal device .",
    "the spatiospectral coding function is implemented on the slm as an 8-bit , pseudo random , pixel - level grayscale phase retardation pattern .",
    "the phase retardation manifests as wavelength - dependent ampitude modulation upon re - entry through the polarizing beamsplitter toward the camera .",
    "finally , the modulated image is projected by the imaging lens ( l4 ) onto the detector plane and then recorded by the detector .",
    "the following mathematical forward model can be used to describe the multiplexing process of the compressive sampling : @xmath13 where @xmath14 are the wavelength dependent transmission patterns provided by the slm , which can be calibrated by analyzing its electrically - controlled birefringence .",
    "since the detector array is spatially pixellated , the @xmath15 detector measurement is given by : @xmath16 where @xmath17 represents the discretized transmission patterns .",
    "[ fig : systemsetup ] is a photograph of the experimental setup .",
    "the setup includes a 60 mm objective lens ( jenoptik ) , a 75 mm achromatic relay lens ( edmound optics ) , a polarization beam splitter ( newport ) , an achromatic quarter wave plate ( newport ) , a liquid crystal based slm ( pluto , holoeye ) , two 75 mm imaging lenses ( pentax ) , and a monochrome ccd camera ( pike f-421 , avt ) with 2048@xmath182048 pixels that are 7.4 @xmath19 m square . a 450 - 680 nm band pass filter ( badder ) is mounted on the objective lens to block unwanted ultra - violet and infrared light ( the slm and camera are optimized for visible - range operation ) .",
    "the slm provides strong modulation and effective multiplexing to fulfill the requirement of compressive sensing .",
    "this modulator is based on a reflective liquid crystal on silicon ( lcos ) microdisplay technique@xcite , which has a 1920@xmath181080-pixel active area with an 8 @xmath19 m pixel pitch .",
    "the effect of the 8-bit , pseudo - random voltage pattern on the spectral channels can be estimated by recording the system response generated by the slm .",
    "[ fig : slmresponse ] records the transmission under the monochromatic illumination and homogeneously - applied voltage on the modulator .",
    "we average the transmission across the center area of the slm and calculate its relative transmisson .",
    "a potential advantage of this slm is that we can change the code easily to get different modulations .",
    "we assume that the system operator provides one - to - one mapping ( 1:1 magnification of the slm pixels onto the detector ) between the micro - display and the detector array .",
    "theoretically , the system operator @xmath14 can be estimated by using slm s calibration data and the applied voltage on the slm .",
    "however , one might account the error in the real system projection .",
    "for example , optical aberrations and sub - pixel alignment discrepancies between the detector and slm might break the ideal mapping and image some of the slm pixels onto several detector pixels .",
    "therefore , part of the transmission code might deviate from the ideal value , which results in an inaccurate system operator .",
    "since the system operator dominates the quality of the object estimation in this inverse problem , a careful calibration of the @xmath14 is required .",
    "a better representation of the system response can be acquired by recording the transmission pattern illuminated by each spectral band .",
    "the revised system operator @xmath14 includes all the possible coding patterns generated by the slm , which can contribute to the data reconstruction .",
    "here we combine the tungsten light source ( lsh - t250 , horiba ) with a monochromator ( ihr320 , horiba ) to quantize the spectral dimension into bands of finite width .",
    "each band has a 7.5 - 8 nm full width at half maximum ( fwhm ) .",
    "the scene s spectral irradiance is recorded by a fiber optics spectrometer ( usb2000 , ocean optics ) ; these values are taken as ground truth in the experiments presented later in the paper . the number of spectral channels and their central wavelengths are determined by the grating period ( 1800 periods / mm ) and the optical path length of the monochromator .",
    "to better represent the continuous light source , two adjacent spectral bands are separated by the monochromator s fwhm . at this calibration resolution ,",
    "the system s spectrally - sensitive bandwidth ( 450 - 680 nm ) has been discretized into @xmath20 spectral channels .",
    "importantly , the spectral resolution of the reconstructed data is determined by the monochromator s resolving power during calibration ; smaller fwhm values result in larger numbers of calibrated and reconstructed spectral channels .",
    "compared to the spectral imagers that are reliant upon dispersive elements to spatially shear the physical code ( in cassi ) , this slm based spectral imager can easily improve the spectral resolution without revising the main camera s optical design .      assuming we are measuring a hyperspectral datacube @xmath21 , where @xmath22 signifies the number of spectral channels of spatial extent @xmath23 .",
    "we can interpret both cassi and slm - cassi measurements as a summation of the 3d hadamard product of the datacube with the different modulation codes , @xmath24 . here",
    ", the @xmath25 is a shifted version of the same code as in cassi  @xcite ; however , each spectral modulation pattern of @xmath25 depends on the slm response in slm - cassi . for each pixel , both ( [ eq : cassi ] ) and ( [ eq : slm - cassi ] ) can be represented as : @xmath26 the pixel - wise modulation of cassi results in feasible patch - based reconstruction algorithms .    since the slm - cassi sensing",
    "paradigm reconstructs @xmath27 spectral images from a single measurement @xmath28 , the compression ratio of the cassi and slm - cassi systems discussed above is @xmath22 .",
    "the compressive sampling process in both spectral imaging systems can be represented by the same matrix described in the following section .",
    "in this section , we develop a new blind bayesian cs model to reconstruct hyperspectral images from cassi or slm - cassi measurements .",
    "the proposed model is a generalized framework which can also be used in denoising and inpainting problems , among others  @xcite .",
    "we decompose the 3d hyperspectral datacube into @xmath29 small patches with size @xmath30 . in vector form , these patches are denoted @xmath31 , with @xmath32 .",
    "we seek a dictionary @xmath33 with @xmath34 atoms such that @xmath35 , based on the captured image @xmath28 . for each patch",
    ", we have the corresponding 2d measurement patch @xmath36 and the 3d mask ( coding ) patch @xmath37 . considering the vectorized format of the measurement for @xmath38 patch @xmath39 , and the corresponding mask patches @xmath40 ( each @xmath41 is the vector form of @xmath42 2d slice in @xmath43 ) , we have the measurement model @xmath44,\\\\ { \\bf y } & = & [ { \\boldsymbol{y}}_1 , \\dots , { \\boldsymbol{y}}_n],\\quad { \\bf x } = [ { \\boldsymbol{x}}_1 , \\dots , { \\boldsymbol{x}}_n],\\end{aligned}\\ ] ] where @xmath45 represents the additive gaussian noise , and we model it as @xmath46 , with @xmath47 denoting the noise precision .",
    "we place a diffuse gamma prior on @xmath47 @xmath48 where @xmath49 are hyperparameters . taking account of the dictionary learning model , ( [ eq : meamodel ] ) can be written as : @xmath50 where @xmath51 is a vector of coefficients describing the decomposition of the signal @xmath52 in terms of dictionary atoms .",
    "given the measurement set @xmath53 and the forward matrices @xmath54 , we aim to jointly learn @xmath55 , and the noise precision parameter @xmath47 to recover @xmath56",
    ". one key difference of our model compared to other blind cs work  @xcite is that each patch has a unique @xmath57 , which is inspired from our cameras since the mask is generated randomly and @xmath57 also takes account of the system calibration .",
    "we model each dictionary atom as a draw from a gaussian distribution , @xmath58 , \\nonumber \\\\ { \\boldsymbol{d}}_k & \\sim & { \\cal n}(0 , \\frac{1}{p } { \\bf i}_p ) , ~~\\forall k = 1,\\dots , k.\\end{aligned}\\ ] ] the coefficients @xmath59 are assumed drawn from the marginalized distribution @xmath60 where @xmath61 denotes the inverse - gamma distribution .",
    "the parameter @xmath62 is a `` global '' scaling for all coefficients of the @xmath38 patch , and @xmath63 is a `` local '' weight for the @xmath64th coefficient of that patch .",
    "we place a gamma prior @xmath65 on @xmath63 , where one may set the hyperparameters @xmath66 to ensure that most @xmath63 are small .",
    "this encourages most @xmath59 to be small . by maximizing the log posterior to obtain a point estimate for the model parameters",
    ", one observes that the log of the prior in ( [ eq : double ] ) corresponds to adaptive lasso regularization @xcite .",
    "equivalently to ( [ eq : double ] ) , the model for @xmath59 may be represented in the hierarchical form @xmath67 where latent variables @xmath68 are included in the generative model , instead of marginalizing them out as in ( [ eq : double ] ) . a vague / diffuse gamma prior is placed on the scaling parameters @xmath69 . despite introducing the latent variables @xmath68 ,",
    "the form in ( [ eq : basic ] ) is convenient for computation , and with an appropriate choice of @xmath66 , most @xmath68 are encouraged to be large .",
    "the large @xmath70 corresponds to small @xmath59 ; this model imposes that most @xmath59 are small , @xmath71 it imposes _ compressibility_. note that ( [ eq : skn ] ) is different from the model used in  @xcite , where a single @xmath72 is used for all patches ; here , we impose different compressibility for each patch by inferring a unique @xmath69 , thus providing flexibility .    in order to automatically infer the number of necessary dictionary atoms , we can replace ( [ eq : ywds ] ) with @xmath73,\\quad \\nu_k\\sim{\\cal n}(0 , \\eta_k^{-1}),\\\\ \\eta_k & = & \\prod_{j=1}^k \\tilde{\\eta}_j ,   ~~\\forall k=1,\\dots , k;\\quad { \\tilde\\eta}_j \\sim { \\rm ga}(e_0 , f_0).\\end{aligned}\\ ] ] the multiplicative gamma prior ( mgp )  @xcite used above is developed to stochastically increase the precision @xmath74 as @xmath64 increases . during inference",
    ", we observe that as @xmath64 increases , @xmath75 tends to zero .",
    "this results in an approximate ordering of @xmath75 by weight . based on this weight",
    ", we can infer the importance of the columns of @xmath76 .",
    "the other use of the @xmath75 s is to avoid over - fitting during the learning procedure .",
    "we can update a fraction of @xmath76 by the weight of @xmath75 and discard the atoms with small weights to reduce the computational cost ( refer to the appendix for the inferred @xmath75 and learned dictionary @xmath76 ) .      the full statistical model of the proposed blind cs approach is : @xmath77 , ~~~{\\boldsymbol{d}}_k \\sim   { \\cal n}(0 , \\frac{1}{p}{\\bf i}_p),\\\\ s_{k , n } & \\sim & { \\cal n}(0 , \\tau_n^{-1 } \\alpha_{k , n}^{-1 } \\alpha_0^{-1 } ) , \\label{eq : skn_alpha0}\\\\ \\alpha_{k , n } & \\sim & { \\rm invga}(1 , ( 2\\phi_{k , n})^{-1 } ) , \\\\ { \\boldsymbol \\lambda } & = & { \\rm diag}[\\nu_1 , \\dots , \\nu_k],\\\\ \\nu_k & \\sim&{\\cal n}(0 , \\eta_k^{-1 } ) , ~~ \\eta_k = \\prod_{j=1}^k \\tilde{\\eta}_j,\\\\ \\tau_n & \\sim & { \\rm ga}(a_0 , b_0),~~~ \\alpha_0 \\sim { \\rm ga}(c_0 , d_0),\\\\ { \\tilde\\eta}_j & \\sim & { \\rm ga}(e_0 , f_0),~~~{\\phi}_{k , n } \\sim   { \\rm ga}(g_0 , h_0),\\end{aligned}\\ ] ] where broad priors are placed on the hyperparameters @xmath78 , _",
    "i.e. _ , @xmath79 . note in ( [ eq : skn_alpha0 ] ) , the coefficients are also scaled to the noise precision @xmath47 .",
    "let @xmath80 denote the parameters to be inferred .",
    "the log of the joint posterior may be expressed as : @xmath81 the terms in ( [ eq : d ] ) are widely employed in optimized - based dictionary learning  @xcite .",
    "the first term imposes an @xmath82 fit between the model and the observed data @xmath83 and the second term imposes an @xmath82 regularization on the dictionary atoms .",
    "the third term regularizes the relative importance of the aforementioned two terms in ( [ eq : d ] ) via the weighting @xmath47 ( updated during the inference ) .",
    "the terms in ( [ eq : s ] ) impose both compressibility ( via the global - shrinkage parameter @xmath69 and local - shrinkage parameter @xmath70 ) and an @xmath82 regularization on @xmath59 .",
    "finally , the terms in ( [ eq : lambda ] ) impose both @xmath82 regularization and shrinkage on @xmath75 .",
    "the shrinkage manifested by ( [ eq : s ] ) is the most distinct aspect of the proposed model relative to previous optimization - based ( and bayesian - based @xcite ) approaches .",
    "these other approaches effectively impose sparsity through @xmath84 regularization on @xmath85 .",
    "this is done by replacing terms in ( [ eq : s ] ) with @xmath86 . to solve an optimization - based analog to the proposed approach ,",
    "one seeks to minimize the objective function @xmath87 the parameters @xmath47 and @xmath88 are typically set by hand ( e.g. , via cross - validation ) .",
    "one advantage of the bayesian framework is that we infer posterior distributions for @xmath47 and @xmath88 ( in our model this is ( @xmath89 ) , along with similar posterior estimates for all model parameters without cross - validation .",
    "we also note that if we replace ( [ eq : s ] ) by the spike - slab prior as used in @xcite , the model will reduce to bpfa . as opposed to this spike - slab prior , which imposes sparsity directly , our shrinkage prior imposes compressibility , and it is more appropriate to the high dimensional hyperspectral image patches . the _ global - local _ shrinkage prior used here can extract more useful information from the limited dictionary atoms .",
    "other forms of shrinkage priors like gaussian scale model and laplace scale mode can be found in  @xcite . aiming to better mimic the marginal behavior of discrete mixture priors , the global - local shrinkage priors  @xcite have been developed to offer sufficient flexibility in high - dimensional settings , which inspires our model .      due to local conjugacy ,",
    "we can write the conditional posterior distribution for all parameters of our model in closed form , making the following markov chain monte carlo ( mcmc ) inference based on gibbs sampling a straightforward procedure .    1 .",
    "sampling @xmath90 : @xmath91^{-1 } , \\nonumber\\\\ { \\boldsymbol{\\mu}}_{d_k } & = & \\alpha_0 { \\bf \\sigma}_{d_k } \\nu_k\\sum_{n=1}^n s_{k , n } { \\boldsymbol{\\psi}}_n^t { \\boldsymbol{y}}_{n ,- k } , \\nonumber\\\\ { \\boldsymbol{y}}_{n ,- k } & = & { \\boldsymbol{y}_n - { \\boldsymbol{\\psi}}_n { { \\bf d}}\\boldsymbol{\\lambda s}}_n +   { \\boldsymbol{\\psi}}_n{\\boldsymbol{d}}_k \\nu_k s_{k , n}. \\nonumber\\end{aligned}\\ ] ] 2 .   sampling @xmath59 : @xmath92 3 .",
    "sampling @xmath69 : @xmath93 4 .",
    "sampling @xmath70 : @xmath94 where @xmath95 denotes the inverse - gaussian distribution .",
    "sampling @xmath63 : @xmath96 where @xmath97 is the generalized inverse gaussian distribution @xmath98 and @xmath99 is the modified bessel function of the second kind @xmath100 6 .",
    "sampling @xmath101 : @xmath102 where @xmath103 denotes the number of nonzero entries in @xmath104 , and  - \" refers to the conditioning parameters of the distributions .    the update equations of mgp related parameters @xmath105 can be found in  @xcite ( also listed in the appendix ) . in applications where speed is important",
    ", we can use all conditional posteriors including those above to derive a variational bayes ( vb ) inference algorithm for our model , which loosely amounts to replace conditioning variables with their corresponding moments .",
    "details of the vb procedure can be found in the appendix ."
  ],
  "abstract_text": [
    "<S> a blind compressive sensing algorithm is proposed to reconstruct hyperspectral images from spectrally - compressed measurements . </S>",
    "<S> the wavelength - dependent data are coded and then superposed , mapping the three - dimensional hyperspectral datacube to a two - dimensional image . </S>",
    "<S> the inversion algorithm learns a dictionary _ in situ _ from the measurements via _ global - local shrinkage _ priors . by using rgb images as _ side information _ of the compressive sensing system , </S>",
    "<S> the proposed approach is extended to learn a coupled dictionary from the joint dataset of the compressed measurements and the corresponding rgb images , to improve reconstruction quality . </S>",
    "<S> a prototype camera is built using a liquid - crystal - on - silicon modulator . </S>",
    "<S> experimental reconstructions of hyperspectral datacubes from both simulated and real compressed measurements demonstrate the efficacy of the proposed inversion algorithm , the feasibility of the camera and the benefit of side information .    </S>",
    "<S> compressive sensing , hyperspectral image , side information , bayesian shrinkage , dictionary learning , blind compressive sensing , computational photography , coded aperture snapshot spectral imaging ( cassi ) , spatial light modulation . </S>"
  ]
}