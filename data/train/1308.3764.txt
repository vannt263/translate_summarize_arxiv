{
  "article_text": [
    "quantum teleportation  @xcite plays a central role in the transfer and manipulation of quantum states .",
    "it was originally proposed for discrete - variable ( dv ) two - level systems  @xcite , and later extended to continuous - variable ( cv ) systems in an infinite - dimensional hilbert space  @xcite . in optics ,",
    "experimental realizations have followed for both systems .",
    "dv teleportation has been performed for qubits represented by photons , albeit probabilistically and post - selectively  @xcite .",
    "in contrast , cv teleportation has been performed deterministically for quadrature variables of electromagnetic fields , however , with a relatively low fidelity due to the finite level of resource squeezing  @xcite .",
    "recently , ref .",
    "@xcite reported a `` hybrid '' experiment  cv teleportation of qubits  and overcame the previous limitations both in the dv and the cv regime .",
    "not only deterministic qubit teleportation was realized there , but it was also demonstrated that tuning the feedforward gain in cv teleportation enables one to faithfully transfer qubit information even with finite squeezing , eventually leading to higher fidelities .",
    "the usefulness of gain tuning for teleporting dv states is well - known .",
    "however , a full gain optimization is a non - trivial problem . an accurate model for the hybrid teleportation scheme",
    "is required to obtain the optimal gain for every experimental setup and figure of merit . thus far",
    ", gain - tuned teleportation of qubits or single photons has been theoretically analyzed in refs .",
    "@xcite using the heisenberg picture and the wigner function . however , these models are specifically adapted to investigate the optimal gains for certain figures of merit , such as the value of the clauser - horne - type inequality , visibility , or the negativity of the wigner function .",
    "thus , they can not be directly applied to more general cases .",
    "a different model , employing a more general density - matrix formalism , has been developed in refs .",
    "@xcite by introducing the so - called transfer operator .",
    "though the transformation of dv states can be intuitively and explicitly described in this model , these calculations assumed an ideal loss - free condition when the input state and the resource squeezing are perfectly pure .",
    "the extension of this model to the realistic situation including losses is hindered by the complexity of taking into account the impurity of squeezing in the density - matrix formalism .",
    "here we present a general formalism to explicitly describe cv teleportation of dv states with gain tuning .",
    "the key element of our formalism is to define the transformation of each density matrix element in the teleportation channel using wigner functions .",
    "the density matrix of the teleportation output is then given by independently transforming each density matrix element of the initial state .",
    "the experimental losses in the input state and squeezing can be included in the wigner functions , and hence realistic experimental conditions can be simulated .    our formalism can be straightforwardly applied to various hybrid teleportation experiments to investigate the optimal gain tuning for a given figure of merit . in this paper",
    ", we apply the formalism to two types of hybrid teleportation experiments .",
    "first , the cv teleportation of photonic qubits in ref .",
    "@xcite is modeled .",
    "we investigate the gain dependence of fidelity considering experimental inefficiencies , and we show that our model is in good agreement with the experimental results .",
    "second , cv teleportation of dv entanglement is proposed and modeled . such an experiment can be readily implemented with current technology and it would allow for a more efficient transfer of dv entanglement than previous teleportation schemes .",
    "we derive a sufficient condition to teleport dv entanglement , and we prove that , provided the experimental losses are within a certain range , dv entanglement can be teleported for any non - zero squeezing by optimally tuning the gain .    this paper is organized as follows .",
    "our general formalism is derived in secs .",
    "[ sec : theory ] and [ sec : vac_single ] .",
    "first , cv teleportation is generally modeled in the wigner - function formalism and the effect of gain tuning is discussed in sec .",
    "[ sec : theory ] .",
    "section  [ sec : vac_single ] then focuses on cv teleportation of dv states , deriving the formalism to describe the transformation of density matrices .",
    "this formalism is applied to two specific cases in the following two sections .",
    "section  [ sec : qubit_tele ] considers cv teleportation of a photonic qubit , investigating the optimal gains to achieve maximal fidelity . in sec .",
    "[ sec : swapping ] , an experiment for cv teleportation of dv entanglement is proposed and modeled based on our formalism , including a discussion on the condition for teleporting entanglement . finally , sec .",
    "[ sec : conclusion ] concludes this paper .",
    "wigner functions are useful tools to describe gaussian states and operations , including the effect of photon losses , in a simpler way compared to density matrices .",
    "the aim of this section is to derive an input - output relation for cv teleportation in the wigner - function formalism , including parameters for gain , squeezing level , and loss on the squeezing .",
    "our results can be regarded as a generalization of those in refs .",
    "@xcite , which do not include all these parameters at the same time . from the derived formula , we show that the effect of a non - unit - gain teleportation channel is closely related to that of an attenuation and an amplification channel .",
    "we start with following the standard braunstein - kimble protocol  @xcite in the non - unit gain regime .",
    "the schematic of cv teleportation is depicted in fig .",
    "[ fig : schematic_teleportation ] . the initial step for a sender `` alice '' and",
    "a receiver `` bob '' is to share a two - mode einstein - podolsky - rosen ( epr ) entangled state .",
    "it can be approximately generated by suitably mixing at a beam splitter two impure single - mode squeezed states of squeezed quadrature variance @xmath0/2 $ ] and anti - squeezed quadrature variance @xmath1/2 $ ] , where @xmath2 , @xmath3 is a squeezing parameter , and @xmath4 denotes loss ( @xmath5 ) .",
    "the wigner function of the epr state is written as a function of quadratures of alice s mode @xmath6 and bob s mode @xmath7 : @xmath8 here @xmath9 and @xmath10 is the covariance matrix with @xmath11 , @xmath12 , @xmath13 an identity matrix , and @xmath14 a pauli matrix .",
    "alice then mixes her part of the epr state and the input state @xmath15 , where @xmath16 , by a 50:50 beam splitter : @xmath17 .",
    "the resulting overall wigner function is @xmath18 where @xmath19 for @xmath20 .",
    "alice measures @xmath21 and sends the results @xmath22 to bob , who displaces his part of the epr state with feedforward gain @xmath23 as @xmath24 .",
    "the final teleported state is obtained by integrating over all possible measurement results @xmath25  @xcite , @xmath26 \\left ( \\frac{\\xi_\\text{out}}{g } \\right ) .",
    "\\label{imperfect_epr_gc}\\end{aligned}\\ ] ] here @xmath27 denotes convolution , and @xmath28 $ ] is a normalized gaussian of variance @xmath29 equation  ( [ imperfect_epr_gc ] ) shows that the cv teleportation channel for a given @xmath30 is equivalent to a thermalization process described by a gaussian convolution @xmath31(\\xi)$ ] followed by a rescaling @xmath32 in phase space . for @xmath33 , @xmath34 is obtained in the limit of @xmath35 at @xmath36 ; otherwise the performance is limited by @xmath4 , as is indicated by @xmath37 in the limit of @xmath35 .",
    "note that for @xmath33 , eq .",
    "( [ imperfect_epr_gc ] ) becomes equivalent to eq .",
    "( 6 ) in ref .",
    "@xcite , and for @xmath33 and @xmath36 , it is simplified to @xmath38(\\xi_\\text{out})$ ] and coincides with eq .",
    "( 4 ) in ref .  @xcite . the special case of @xmath39 in eq .",
    "( [ imperfect_epr_gc ] ) was also derived and used in ref .",
    "@xcite . in this sense ,",
    "the input - output relation of eq .",
    "( [ imperfect_epr_gc ] ) generalizes all previous ones in the wigner - function formalism .",
    "the process of non - unit - gain teleportation , described in eq .",
    "( [ imperfect_epr_gc ] ) , can be explained by a combination of unit - gain teleportation , pure attenuation , and pure amplification ( `` pure '' indicates the optimal attenuation or amplification with minimum excess noise  @xcite ) .",
    "the pure attenuation is a channel which applies `` beam - splitter loss '' of @xmath40 ( @xmath41 ) to the input state .",
    "it can be written as @xmath42 in the heisenberg picture , where each @xmath43 denotes an annihilation operator of the output , input , and auxiliary vacuum mode , respectively . in the wigner - function formalism , the input - output relation is given by  @xcite @xmath44\\left(\\frac{\\xi_\\text{out}}{\\sqrt{\\epsilon}}\\right ) .",
    "\\label{eq : att_channel}\\end{aligned}\\ ] ] in contrast , the pure - amplification channel amplifies the input signal as @xmath45 ( @xmath46 ) , described in the wigner - function formalism by  @xcite @xmath47\\left(\\frac{\\xi_\\text{out}}{\\sqrt{\\gamma}}\\right ) .",
    "\\label{eq : amp_channel}\\end{aligned}\\ ] ] all eqs .",
    "( [ imperfect_epr_gc ] ) , ( [ eq : att_channel ] ) , and ( [ eq : amp_channel ] ) represent gaussian channels composed of a gaussian convolution and phase - space rescaling .",
    "importantly , two successive gaussian channels of convolution of @xmath48 followed by a rescaling @xmath49 ( @xmath50 ) can be reduced to one gaussian channel of @xmath51 and @xmath52 with @xmath53 and @xmath54 . in the case of @xmath55 , eq .",
    "( [ imperfect_epr_gc ] ) can be decomposed into two successive gaussian channels of @xmath56 , @xmath57 and @xmath58 , @xmath59 .",
    "this means that below - unit - gain teleportation can be regarded as a sequence of unit - gain teleportation ( convolution of @xmath60 ) and pure attenuation [ eq .  ( [ eq : att_channel ] ) at @xmath61 . for a given @xmath62 , the thermalization effect of @xmath60",
    "is minimized at the gain of @xmath63 , where @xmath64 takes its minimum value of @xmath65=l$ ] .",
    "interestingly , this gain depends only on @xmath3 ( not on @xmath4 ) , and the minimum @xmath64 is equal to the lower bound of @xmath66 in the unit - gain regime ( @xmath37 for @xmath36 and @xmath35 , as mentioned above ) . when @xmath33 and thus @xmath67 , the teleportation channel at @xmath68 is equivalent to a pure - attenuation channel at @xmath69 .",
    "otherwise @xmath70 is always positive and the thermalization effect is unavoidable . a similar discussion can be made for @xmath71 . by decomposing eq .",
    "( [ imperfect_epr_gc ] ) into two successive gaussian channels of @xmath72 , @xmath73 and @xmath74 , @xmath75 , above - unit - gain teleportation can be regarded as a sequence of pure amplification [ eq .",
    "( [ eq : amp_channel ] ) at @xmath76 and unit - gain teleportation ( convolution of @xmath77 ) . the minimum value of @xmath78 is achieved at the gain of @xmath79 . for @xmath33 ,",
    "the teleportation channel at @xmath80 becomes equivalent to a pure - amplification channel at @xmath81 .",
    "the equivalence to pure - attenuation and pure - amplification channels at @xmath33 has been derived using different methods in refs .",
    "@xcite .",
    "thus far , we have only discussed one simple cv teleportation channel , as expressed by eq .",
    "( [ imperfect_epr_gc ] ) . however , an actual experimental situation is typically more complex .",
    "for example , in single - mode cv teleportation experiments  @xcite , an input state is first attenuated ( loss ) , next teleported , and finally attenuated again by the measurement ( finite measurement efficiency ) ; the overall channel thus should be written as three consecutive gaussian channels .",
    "however , such a complex channel , composed of consecutive cv teleportation , pure attenuation , and amplification , can be described by only one input - output relation , similar to eq .",
    "( [ imperfect_epr_gc ] ) .",
    "the reason is that two consecutive gaussian channels can be reduced to one gaussian channel , as mentioned above ; thus any number of consecutive gaussian channels can be simplified to just one , written as @xmath82\\left(\\frac{\\xi_\\text{out}}{g_\\text{tot}}\\right ) , \\label{eq : overall_channel}\\end{aligned}\\ ] ] with only two parameters @xmath83 and @xmath84 to characterize the overall channel property .",
    "this is of great convenience to describe various types of cv teleportation experiments in an accurate and compact fashion . besides the example of single - mode cv teleportation , eq .",
    "( [ eq : overall_channel ] ) is also applicable to the case when cv teleportation is performed successively  @xcite .",
    "the next step is to derive the transformation of dv states in a cv teleportation channel by applying the input - output relation of eq .",
    "( [ imperfect_epr_gc ] ) to such states .",
    "discrete - variable states of particular interest are the following two types of a qubit .",
    "one is a singe - rail encoded qubit , @xmath85 expressed in the photon number basis ( @xmath86 ) , where the photon number directly represents the logical `` 0 '' and `` 1 '' ( see , _",
    "e.g. _ , refs .",
    "@xcite ) . the other is a dual - rail encoded qubit , @xmath87 where the logical `` 0 '' and `` 1 '' are represented by the mode ( x or y ) in which the photon is present ( see , _ e.g. _ , refs .",
    "continuous - variable teleportation of these states can be expressed by a transformation between non - gaussian wigner functions using eq .",
    "( [ imperfect_epr_gc ] ) .",
    "however , below we may convert our representation from wigner functions to density matrices in order to describe the transformation more intuitively and conveniently .",
    "the formalism derived below is applicable to various types of hybrid teleportation experiments .    in order to calculate the density matrix corresponding to a given wigner function",
    ", we start with introducing the following function of an operator @xmath88 : @xmath89 this is a generalized version of the wigner function for an arbitrary , not necessarily hermitian , operator @xmath88 .",
    "when @xmath88 is a density operator , this function describes the wigner function of the corresponding state . for @xmath90 ( photon number basis , @xmath91 ) , eq .",
    "( [ eq : moyal_function ] ) can be expressed by the laguerre function @xmath92  @xcite as @xmath93 , \\label{photon_num_wigner}\\end{aligned}\\ ] ] where @xmath94 and @xmath95 . in the case of @xmath96",
    ", we need to replace @xmath97 , @xmath98 and @xmath99 in the right hand side of eq .",
    "( [ photon_num_wigner ] ) . when an input state @xmath100 is expanded in the photon number basis as @xmath101 , the corresponding wigner function",
    "can also be expanded as @xmath102 . by using eq .",
    "( [ imperfect_epr_gc ] ) and linearity of convolution , the wigner function of the teleported state @xmath103 can be written as @xmath104 where we define @xmath105 \\left ( \\frac{\\xi}{g } \\right ) .",
    "\\label{eq : teleported_a}\\end{aligned}\\ ] ] the wigner functions in eq .",
    "( [ outuput_wigner_photon_basis_decomp ] ) can be converted to their corresponding density matrices . from @xmath106 ,",
    "each density matrix element @xmath107 is obtained by  @xcite @xmath108 next we define a transition operator @xmath109 as @xmath110 describing a map from an operator to an operator : @xmath111 .",
    "this map describes the transition of a density matrix element @xmath88 through the cv teleportation channel of eq .",
    "( [ imperfect_epr_gc ] ) . by substituting eq .",
    "( [ eq : transition_operator ] ) into eq .",
    "( [ eq : element_after_teleportation ] ) , we get @xmath112 thus , the output density matrix is obtained by replacing @xmath113 for any given input density matrix @xmath101 . in this picture , the final density matrix at the output is a combination of each density matrix element teleported independently .    before applying this transition - operator formalism to qubits ,",
    "we derive the expression of @xmath114 for @xmath115 , where the coefficient @xmath116 represents the transition probability for a component @xmath117 to be transformed into @xmath118 by teleportation . to calculate this , we obtain the following functions from eq .",
    "( [ photon_num_wigner ] ) and ( [ eq : teleported_a ] ) , @xmath119 , \\label{wigner_00 } \\\\",
    "w^{\\ket{1}\\bra{0}}_\\text{out}(\\xi ) \\!&=\\!w^{\\ket{0}\\bra{1}}_\\text{out}(\\sigma_z\\xi ) \\!=\\!\\frac{\\sqrt{2 }   v^t\\xi g}{\\lambda^2 \\pi }   \\exp\\!\\left[-\\xi^t\\xi/\\lambda \\right ] , \\label{wigner_01 } \\\\",
    "w^{\\ket{1}\\bra{1}}_\\text{out}(\\xi ) \\!&=\\!\\frac{\\left ( 2g^2\\xi^t \\xi+\\lambda(\\lambda-2g^2)\\right)}{\\lambda^3 \\pi } \\exp\\!\\left[-\\xi^t\\xi/\\lambda \\right ] .",
    "\\label{wigner_11}\\end{aligned}\\ ] ] here we introduced a new parameter @xmath120 for simplicity .",
    "the condition @xmath121 can be proven from eq .",
    "( [ gamma ] ) , and the equality is attained if and only if @xmath33 and @xmath122 . by substituting the above functions and eq .",
    "( [ photon_num_wigner ] ) into eq .",
    "( [ eq : transition_coef ] ) , we obtain @xmath123\\ !",
    "\\delta_{j , k } , \\label{photon_dis_11}\\end{aligned}\\ ] ] where @xmath124 is the discrete kronecker delta function .",
    "all the coefficients above are non - negative .",
    "it can be seen that the diagonal elements @xmath125 and @xmath126 ( off - diagonal elements @xmath127 and @xmath128 ) of the input state contribute only to the diagonal elements @xmath129 ( off - diagonal elements @xmath130 and @xmath131 ) in the output state .",
    "the formulas derived above enable us to describe cv teleportation of qubits fully in terms of density matrices .",
    "for the single - rail qubit in eq .",
    "( [ single_rail_qubit ] ) , the teleportation process is then expressed by @xmath132 defining @xmath133 . in the case of the dual - rail qubit in eq .",
    "( [ dual_rail_qubit ] ) , each mode is transmitted through a teleportation channel independently . thus , we extend the single - mode transition operator to a two - mode transition operator , @xmath134 , for any two - mode state @xmath135 as @xmath136 in general , the two teleportation channels @xmath137 and @xmath138 are characterized by different parameters @xmath139 according to eq .",
    "( [ imperfect_epr_gc ] ) .",
    "thus , teleportation of a dual - rail qubit can be described by @xmath140 where @xmath141 ( @xmath142x , y ) .",
    "equations  ( [ eq : cvqt_single_rail ] ) and ( [ eq : cvqt_dual_rail ] ) , together with the coefficients given by eqs .",
    "( [ photon_dis_00])-([photon_dis_11 ] ) , give the output density matrices as functions of squeezing parameter @xmath3 , loss @xmath4 , and gain @xmath143 ; and hence gain tuning for teleporting dv states can be investigated in detail from these results .",
    "one advantage of our formalism compared to the transfer - operator formalism  @xcite is that an actual , realistic experiment can be more accurately modeled by taking into account the impurity of squeezing .",
    "in addition , our formalism is applicable to more complex channels than a simple teleportation channel by replacing the parameters @xmath144 for each @xmath145 by @xmath146 [ namely , eq .  ( [ imperfect_epr_gc ] )",
    "is replaced by eq .",
    "( [ eq : overall_channel ] ) ] .",
    "it can also be straightforwardly extended to the multi - qubit situation where all or some parts of the qubits are teleported .",
    "possible applications are various hybrid teleportation experiments , such as cv teleportation of a multi - qubit system , sequential cv teleportation of qubits , and entanglement swapping  @xcite using a dv entangled state and cv teleportation .",
    "continuous - variable teleportation of a dual - rail qubit is one of the most important and fundamental examples of optical hybrid quantum information processing , as was experimentally demonstrated recently  @xcite .",
    "the ideal situation of this experiment has been modeled already by the transfer - operator formalism on the assumption that the input qubit state and the resource squeezed states are perfectly pure  @xcite .",
    "this assumption is , however , not true in the actual experiment . here we model this teleportation experiment more accurately by taking into account the impurity of the input state as well as the squeezed states ( all measurement inefficiencies can be incorporated into the initial losses as shown in appendix b ) . since fidelity is used as a figure of merit in ref .",
    "@xcite , we investigate the optimal gain to obtain the maximum fidelity under various experimental conditions .",
    "the theoretical results here are shown to be in good agreement with the experimental results in ref .",
    "@xcite .",
    "we start with describing the output density matrix of teleportation by using transition operators .",
    "the experimental dual - rail qubit input can be modeled by a mixed state of the pure qubit in eq .",
    "( [ dual_rail_qubit ] ) and a two - mode vacuum state as @xmath147 where @xmath148 is the fraction of the qubit ( @xmath149 ) . as is mentioned in sec .",
    "[ sec : vac_single ] , cv teleportation of this qubit requires two parallel teleportation channels , which have different parameters @xmath144 in general .",
    "however , we may assume the same @xmath144 for the two teleportation channels when both rails of the qubit  @xcite are teleported by the same cv teleporter , as in ref .",
    "this assumption greatly simplifies the description of the experiment in the following two aspects .",
    "firstly , for an arbitrary qubit @xmath150 , its density matrix @xmath151 in eq .",
    "( [ input_density ] ) can be decomposed into a tensor product @xmath152 \\otimes \\ket{0}_\\text{y}\\!\\bra{0 } \\label{eq : decomposed_input}\\end{aligned}\\ ] ] via a beam - splitter transformation defined by a unitary operator @xmath153 satisfying @xmath154 and @xmath155 ( @xmath156 denotes a creation operator of mode @xmath157 ) . secondly , when the teleportation channels for both rails have the same @xmath144 , the basis transformation @xmath158 and the teleportation map @xmath159 of eq .",
    "( [ eq : cvqt_dual_rail ] ) commute for any two - mode state @xmath160 : @xmath161\\hat{u}^\\dagger .",
    "\\label{eq : commutation_tu}\\ ] ] this is proven in appendix a. these two properties together mean that the density matrix of the teleported state @xmath162 satisfies @xmath163 \\!\\otimes\\!\\hat{t}_\\text{y}^{00}. \\label{eq : decomposed_output}\\end{aligned}\\ ] ] equations ( [ eq : decomposed_input ] ) and ( [ eq : decomposed_output ] ) indicate that , after the transformation @xmath153 , dual - rail qubit teleportation can be interpreted as parallel teleportation of a single photon with loss ( mode x ) and a vacuum ( mode y ) . from eqs .",
    "( [ photon_dis_00 ] ) and ( [ photon_dis_11 ] ) , it is shown that @xmath164 in eq .",
    "( [ eq : decomposed_output ] ) has only diagonal density matrix elements .",
    "the matrix elements of @xmath165 can be obtained by the inverse transformation @xmath166 of eq .",
    "( [ eq : decomposed_output ] ) .",
    "since @xmath166 preserves the total photon number , i.e. , @xmath167 for @xmath168 , @xmath103 has non - zero @xmath169 elements only when @xmath170 . as a result",
    ", the element of @xmath103 belongs to either the vacuum subspace spanned by @xmath171 , or the single - photon subspace spanned by @xmath172 , or the two - photon subspace spanned by @xmath173 , and so on . here",
    ", the single - photon subspace is the original qubit subspace where the quantum information is encoded .",
    "now the fidelity between @xmath151 and @xmath103 can be calculated to assess the performance of teleportation .",
    "two types of fidelity are introduced in ref .",
    "one is the overall transfer fidelity @xmath174 which is directly calculated from @xmath175 and @xmath176 as  @xcite @xmath177 ^ 2 .",
    "\\label{fidelity}\\end{aligned}\\ ] ] this fidelity reflects the entire two - mode hilbert space , taking into account the vacuum and multi - photon contributions .",
    "thus , @xmath174 describes the performance of a `` deterministic '' teleportation that does not pre - select or post - select specific parts of the quantum states . since the fidelity between @xmath151 and @xmath103 is equal to the fidelity between @xmath178 and @xmath179  @xcite , it is straightforwardly calculated from eqs .",
    "( [ eq : decomposed_input ] ) and ( [ eq : decomposed_output ] ) as @xmath180 ^ 2 , \\label{eq : fstate}\\end{aligned}\\ ] ] with coefficients @xmath181 given by eqs.([photon_dis_00 ] ) and ( [ photon_dis_11 ] ) . the other fidelity in ref .",
    "@xcite is an indicator to assess the qubit components alone : @xmath182 where @xmath150 is the pure input qubit in eq .",
    "( [ dual_rail_qubit ] ) and @xmath183 is the matrix obtained by extracting and renormalizing the qubit subspace spanned by @xmath184 .",
    "@xmath185 can be calculated as the fidelity between @xmath186 and @xmath187 .",
    "the latter is obtained by extracting the terms with one photon in total from @xmath179 and then renormalizing .",
    "thus we obtain @xmath188 where @xmath189\\\\ { p}_\\text{flip}&=t_{00\\to11}\\left[\\eta t_{11\\to00}+(1-\\eta)t_{00\\to00}\\right ] \\label{eq : pflip}\\end{aligned}\\ ] ] are the probabilities that the photon number is transferred correctly ( @xmath190 ) or flipped ( @xmath191 ) .",
    "the sum @xmath192 gives the probability of obtaining the qubit at the output .",
    "note that both fidelities , @xmath174 in eq .",
    "( [ eq : fstate ] ) and @xmath185 in eq .",
    "( [ eq : fqubit ] ) , are independent of the qubit coefficients @xmath193 and @xmath194 in eq .",
    "( [ dual_rail_qubit ] ) .",
    "this indicates that the optimal gain is also independent of the initial qubit state .",
    "now we discuss the dependence of fidelities @xmath174 and @xmath185 on the four experimental parameters @xmath195 using eqs .",
    "( [ eq : fstate ] ) and ( [ eq : fqubit ] ) . here",
    "@xmath196 and @xmath4 are experimental losses , constant for each experimental setup .",
    "therefore only the @xmath143 and @xmath3 dependences of the fidelities are plotted for fixed @xmath197 values ( e.g. in ref .",
    "@xcite , @xmath198 and @xmath199 are given , while @xmath200 and @xmath201 are varied ) .",
    "first the @xmath143 dependence of @xmath174 at @xmath202 is plotted for various @xmath197 values in fig .",
    "[ sfig : f_state_gain_ps ] . here",
    "the parameters @xmath203 reflect one of the experimental settings in ref .",
    "it can be seen that gain tuning greatly improves @xmath174 from the unit - gain regime at a certain gain below unity . however , the optimal gain @xmath204 to give the maximum @xmath174 differs according to @xmath197 .",
    "note that generally @xmath174 is higher for more mixed input states , leading to a higher @xmath174 for @xmath205 than @xmath206 .",
    "the @xmath3 dependence of @xmath204 and the maximum fidelity @xmath207 at this gain is shown in figs .",
    "[ sfig : f_state_g_opt_ps ] and [ sfig : f_state_g_opt_fidelity_ps ] for various @xmath197 values . for @xmath33",
    ", we can see @xmath208 in the limit of @xmath35 , but @xmath209 does not reach unity for @xmath210 .",
    "more interestingly , in the case of @xmath210 and @xmath211 , there is an optimal squeezing level @xmath212 which gives the maximum @xmath209 [ _ e.g. _ , @xmath213 for @xmath214 .",
    "this result agrees with the fact that the highest value of @xmath209 was obtained at @xmath215 among @xmath216 in the experiment of ref .",
    "@xcite .",
    "next we examine @xmath185 in the same way .",
    "figure  [ sfig : f_qubit_gain_ps ] shows the @xmath143 dependence of @xmath185 at @xmath202 for various @xmath197 values .",
    "it is notable that @xmath185 reaches unity for certain conditions even though the squeezing parameter @xmath3 is finite .",
    "one condition is @xmath217 and @xmath218 , when the teleportation is equivalent to a pure attenuation channel . here",
    "the teleportation only increases the vacuum component of the initial qubit state of eq .",
    "( [ input_density ] ) , which leads to @xmath219 and thus @xmath220 in eq .",
    "( [ eq : pflip ] ) .",
    "the other condition is @xmath221 and @xmath222 , when the initial pure qubit is amplified and transformed into the mixture of a qubit and more - than - one photon states .",
    "this condition also gives @xmath220 since @xmath223 and @xmath224 in eq .",
    "( [ eq : pflip ] ) . in most of the realistic conditions of @xmath211 and @xmath210 ,",
    "the peak at @xmath225 vanishes and @xmath185 is maximal when the gain is close to @xmath68 . for @xmath210 , the maximum @xmath185",
    "is limited below unity due to the inevitable thermalization effect of teleportation , as mentioned in sec .",
    "[ sec : vac_single ] .",
    "thus , the loss on the resource epr state limits the experimental @xmath185 to at best 0.90 in ref .",
    "the @xmath3 dependence of the optimal gain @xmath226 , the maximum fidelity @xmath227 , and the probability @xmath228 at this gain are plotted in figs .",
    "[ sfig : f_qubit_g_opt_ps ] and [ sfig : f_qubit_g_opt_fidelity_ps ] ( we fixed @xmath229 ) . in fig .",
    "[ sfig : f_qubit_g_opt_ps ] , @xmath230 for @xmath33 ( for any @xmath231 ) .",
    "the finite loss of @xmath232 leads to only a small discrepancy between @xmath233 and @xmath234 ; for @xmath232 , @xmath233 is closer to @xmath234 for smaller @xmath148 .",
    "thus , in most cases , choosing @xmath122 regardless of @xmath197 is nearly optimal for faithful qubit information transfer .",
    "figure  [ sfig : f_qubit_g_opt_fidelity_ps ] shows that @xmath228 increases with increasing @xmath3 , but the increment of @xmath227 is small .",
    "@xmath227 is mainly limited by @xmath4 ( not by @xmath3 ) which defines the minimal thermalization effect of teleportation .",
    "finally , we directly compare the theoretical @xmath103 in eq .",
    "( [ eq : decomposed_output ] ) and the experimental @xmath103 in ref .",
    "@xcite for the purpose of demonstrating the validity of our model .",
    "one of the experimental results along with its theoretically calculated simulation result for the same parameters @xmath235 is illustrated in figs .",
    "[ sfig : experiment_result_tele ] and [ sfig : simulation_result_tele ] ; they are in good agreement .",
    "the fidelities between theoretical and experimental @xmath103 for 24 conditions of @xmath235 in ref .",
    "@xcite are calculated to give an average value of @xmath236 .",
    "this value is calculated using only @xmath237 elements for @xmath170 on the assumption that the non - zero @xmath237 elements for @xmath238 in the experimental @xmath103 are attributed to the imperfect measurement scheme  @xcite ( otherwise the fidelity drops to @xmath239 ) .",
    "the effect of two - photon input states of around 6% are also taken into account ( see appendix c ) .",
    "this high fidelity demonstrates that our theory accurately models the experiment .",
    "in a typical teleportation experiment , a specific set of quantum states , which is known to the experimentalists , is prepared and used as test states for the teleporter .",
    "however , the genuine quantum nature of teleportation lies in the fact that it can teleport arbitrary unknown quantum states .",
    "such quantum nature can manifest itself directly when one half of an entangled pair is teleported . in this case , for example , a qubit that is to be teleported is indeed in a completely random state on its own while being maximally entangled with another qubit .",
    "the entanglement is then transferred via teleportation , thus revealing the quantum nature of teleportation .",
    "such teleportation of entanglement , usually referred to as entanglement swapping , has been proposed and experimentally realized separately in dv  @xcite and cv  @xcite optical systems . here",
    "an interesting question arises for our hybrid system : can cv teleportation transfer dv entanglement ? the original proposal of this hybrid entanglement swapping was made in ref .",
    "@xcite as cv teleportation of polarization entanglement between photons .",
    "the condition for violating the clauser - horne - type inequality by photon - counting measurement was discussed , but its experimental demonstration has not been reported yet .    here",
    "we propose another type of hybrid entanglement - swapping experiment in a readily implementable form .",
    "the main difference from the original proposal in ref .",
    "@xcite is that the polarization - entangled photons and photon - counting measurements are replaced by a single photon split at a beam splitter and homodyne measurements , respectively .",
    "the demonstration of our proposal will give a distinct proof of the fact that cv teleportation operates non - classically on the dv subspace of @xmath240 .",
    "in addition , this hybrid scheme allows for a more efficient transfer of dv entanglement than previous dv schemes  @xcite , and thus has applications in practical quantum communication  @xcite .",
    "our proposal is illustrated in fig .",
    "[ fig : swapping_scheme_ps ] . at the first stage ,",
    "a heralded single photon is generated based on the method in refs .",
    "the photon incident on a 50:50 beam splitter yields maximally entangled single - rail qubits @xmath241 .",
    "the qubit of mode y is then teleported to mode z via the cv teleporter in ref .",
    "the two - mode density matrix of modes x and z can be obtained by the homodyne - tomography method in ref .",
    "finally , entanglement in the final state can be assessed by a violation of the positivity after partial transposition  @xcite .",
    "below we model the proposed experiment in the transition - operator formalism , and derive a sufficient experimental condition to observe the entanglement after teleportation .",
    "we also deduce the optimal gain to maximize the transferred entanglement , which is quantified by the logarithmic negativity  @xcite .",
    "experimentally , the initial single - photon state becomes a state mixed with vacuum corresponding to a loss fraction of @xmath196 .",
    "the entangled state @xmath242 after the 50:50 beam splitter can thus be modeled by @xmath243 cv teleportation from mode y to z replaces @xmath244 in eq .",
    "( [ input_density_swap ] ) by its corresponding transition operator @xmath245 ( @xmath246 ) .",
    "the final density matrix is thus written as @xmath247 the success of entanglement swapping can be confirmed by witnessing entanglement in @xmath248 .",
    "it is known that the positivity of the partial transposition ( ppt ) of @xmath248 ( namely , partial transposition for just one subsystem , x or z ) is a necessary condition for @xmath248 to be separable  @xcite .",
    "the partial transposition of eq .",
    "( [ output_density_swap ] ) for mode x is @xmath249 where @xmath250 ( @xmath251 ) is defined as @xmath252 with coefficients @xmath253 , given by @xmath254 here @xmath255 can be proven for all @xmath256 and @xmath257 ( @xmath258 , @xmath259 ) .",
    "this means that the set of eigenvalues of @xmath260 is equivalent to the sum of sets of eigenvalues of each @xmath250 ( @xmath261 ) .",
    "when at least one of @xmath250 has a negative eigenvalue , @xmath260 fails to be positive , in which case we know that @xmath248 is entangled .",
    "since @xmath262 is always positive , the sign of the following eigenvalues @xmath263 of each @xmath250 ( @xmath264 ) determines the positivity , @xmath265 since @xmath266 , we focus on the condition @xmath267 . from eqs .",
    "( [ photon_dis_00 ] ) , ( [ photon_dis_10 ] ) , ( [ photon_dis_11 ] ) and ( [ abcd ] ) , this condition can be calculated as @xmath268 with @xmath66 defined by eq .",
    "( [ gamma ] ) .",
    "this is the necessary and sufficient condition for @xmath250 to have a negative eigenvalue . since eq .",
    "( [ entanglement_condition ] ) is independent of @xmath269 , this inequality is also the necessary and sufficient condition for @xmath260 to have at least one negative eigenvalue . in other words ,",
    "when the experimental setting @xmath195 satisfies eq .",
    "( [ entanglement_condition ] ) , entanglement in @xmath248 can be verified by a violation of the ppt criterion . when @xmath143 can be chosen arbitrarily , eq .",
    "( [ entanglement_condition ] ) is most easily satisfied by choosing @xmath270 , when the right hand side takes its minimum value @xmath271 . at this gain ,",
    "( [ entanglement_condition ] ) is reduced to @xmath272 independent of the parameter @xmath3 .",
    "therefore @xmath148 and @xmath4 are the critical parameters in this experiment . as long as @xmath148 and @xmath4 satisfy eq .",
    "( [ entanglement_condition_eta_l ] ) , ppt of @xmath273 can be violated for any non - zero @xmath3 at the optimal gain @xmath274 .",
    "the range of @xmath275 satisfying eq .",
    "( [ entanglement_condition ] ) is plotted in fig .",
    "[ sfig : entangle_condition_ps ] for various @xmath197 values . for @xmath222 , eq .",
    "( [ entanglement_condition ] ) gives @xmath276 and the range does not depend on @xmath4 .",
    "for @xmath211 , the violation range gets smaller with an increasing @xmath4 , and finally vanishes when eq .",
    "( [ entanglement_condition_eta_l ] ) is violated .",
    "in addition , the degree of entanglement in @xmath248 can be assessed by the logarithmic negativity ( ln ) , given by  @xcite @xmath277 , \\label{eq : def_lognega}\\ ] ] where @xmath278 .",
    "this quantifies the degree to which @xmath279 fails to be positive ; the state is entangled when @xmath280 , and a maximally entangled state gives @xmath281 .",
    "the value of @xmath282 can be directly calculated by inserting @xmath283 of eq .",
    "( [ eq : eigenvalue_rhok ] ) into eq .",
    "( [ eq : def_lognega ] ) .",
    "figures  [ sfig : log_neg_g_opt_ps ] and [ sfig : log_neg_g_opt_log_neg_ps ] each show the @xmath3 dependence of the optimal gain @xmath284 that maximizes @xmath285 and the maximum value @xmath286 for various @xmath197 values .",
    "@xmath284 is always larger than @xmath270 . by increasing @xmath3 ,",
    "@xmath286 monotonically increases and approaches the ln of the initial state , but the upper bound is limited by loss @xmath4 .    finally , the viability of this experiment is examined based on current technologies . when @xmath232 is assumed as reported in ref .",
    "@xcite , eq .",
    "( [ entanglement_condition_eta_l ] ) requires an input efficiency of @xmath287 .",
    "since heralded single - photon sources with efficiency up to @xmath288 have been already reported  @xcite , the verification of entanglement is possible . as an example , for @xmath289 , the maximum ln of @xmath290 is obtained at @xmath291 after teleportation for an initial state with ln @xmath292 .",
    "the theoretical density matrices @xmath293 and @xmath248 under this condition are illustrated in fig .",
    "[ sfig : swapping_input ] and [ sfig : swapping_output ] .",
    "it can be seen that the original dv entanglement , which manifests itself as four elements in the subspace @xmath294 , is transformed into the other elements in the subspace @xmath295 ( @xmath296 ) due to the thermalization effect on mode y in teleportation .",
    "we have developed a general formalism to describe the transformation of dv states by a cv teleportation channel .",
    "this formalism can be used to model various hybrid teleportation experiments and investigate the optimal gain tuning for a given figure of merit .",
    "the key element of our formalism is a transition operator @xmath145 , which describes how each density matrix element is transformed by the cv teleportation channel .",
    "this operator includes two parameters @xmath144 that characterize the channel properties . by appropriately choosing @xmath144",
    ", we can describe experimental imperfections such as loss on the input state and impurity of squeezing , and we can also analyze more complex teleportation channels composed of consecutive cv teleportation , pure attenuation and amplification .    we have applied our formalism to cv teleportation of a dual - rail qubit , and discussed the optimal gain to obtain the maximum fidelity under various experimental conditions .",
    "the validity of our model is confirmed by the good agreement between our theoretical prediction and the actual experimental results in ref .",
    "we have also proposed and modeled cv teleportation of dv entanglement in the form of a split single photon .",
    "it has been proven that , provided the efficiency of the input qubits and the loss on the resource squeezing satisfy a certain condition , dv entanglement can be teleported for any non - zero squeezing level by optimally tuning the gain .",
    "this experiment can be thus readily realized with current technology .",
    "this work was partly supported by the scope program of the mic of japan , pdis , gia , g - coe , and apsa commissioned by the mext of japan , first initiated by the cstp of japan , and ascr - jsps .",
    "s.t . and m.f .",
    "acknowledge financial support from alps .",
    "p.v.l . acknowledges support from the bmbf in germany through quorep and hipercom .",
    "here we prove eq .",
    "( [ eq : commutation_tu ] ) by deriving the wigner functions corresponding to the density matrices of both left and right hand sides of eq .",
    "( [ eq : commutation_tu ] ) . for this purpose",
    "we define the wigner function of @xmath293 as @xmath297 . on the right hand side of eq .",
    "( [ eq : commutation_tu ] ) , @xmath298 is first applied to the input state . by the definition of @xmath299 and eq .",
    "( [ imperfect_epr_gc ] ) , this process transforms the wigner function into @xmath300 the beam - splitter transformation @xmath153 is then applied ( @xmath301 , @xmath302 ) .",
    "this process transforms the arguments @xmath303 and @xmath304 in eq .",
    "( [ eq:2modew_tele ] ) as follows , @xmath305 on the left hand side of eq .",
    "( [ eq : commutation_tu ] ) , the input state is first transformed into @xmath306 by the operator @xmath153 , which is then transformed into @xmath307 by the teleportation process .",
    "equation ( [ eq : commutation_lhs ] ) becomes equal to eq .",
    "( [ eq : commutation_rhs ] ) by replacing the integration variable @xmath308 in eq .",
    "( [ eq : commutation_lhs ] ) by @xmath309 .",
    "thus , the wigner functions of the left and right hand sides in eq .",
    "( [ eq : commutation_tu ] ) are equivalent .",
    "this fact proves eq .",
    "( [ eq : commutation_tu ] ) .",
    "here we show how to take into account the measurement inefficiencies at the detectors for modes u , v , and output in fig .  [",
    "fig : schematic_teleportation ] when they are no longer negligible . in conclusion",
    ", these measurement inefficiencies can be incorporated into the input efficiency ( @xmath148 ) and the loss on the epr state ( @xmath4 ) on the assumption that all these detector efficiencies are the same ( @xmath310 ) .",
    "we use the following lemma to prove this fact : symmetric losses on two modes after a beam splitter is equivalent to the same amount of symmetric losses on two modes before their combination .",
    "first , the measurement loss @xmath311 in modes u and v can be incorporated in the input loss @xmath196 and the loss on mode a. next , the measurement loss @xmath311 on the output state adds loss to mode b as well as to the amplitude of displacement . the losses on modes a",
    ", b can be incorporated in the initial loss @xmath4 .",
    "the loss on the displacement amplitude attenuates the effective feedforward gain from @xmath143 to @xmath312 . in our analysis in secs .",
    "[ sec : qubit_tele ] and [ sec : swapping ] , all these measurement inefficiencies are included in @xmath148 and @xmath4 .",
    "the gain reduction is neglected , but this effect only changes the scales of the gain axes in figs .  [",
    "fig : tele_simulation_results ] and [ fig : entangle_swapping_cond_log_neg ] .",
    "in the simulation of sec .  [ sec : qubit_tele ] , we have assumed that the initial dual - rail qubit has no multi - photon terms . however , the experimental qubit state usually has non - zero multi - photon terms as in ref .",
    "the input state in ref .",
    "@xcite has around 6% of two - photon terms in the subspace of @xmath313 , which can not be neglected .",
    "this effect can be taken into account by the following method .",
    "extending eq .",
    "( [ eq : decomposed_input ] ) , we can assume that the input state with two - photon terms is modeled by @xmath314 by appropriately choosing @xmath315 and @xmath316 , this @xmath317 simulates well the experimental input state , yielding an average fidelity of @xmath318 for the six input states in ref .",
    "@xcite . in the transition - operator formalism",
    ", the teleported state for this @xmath151 is given by @xmath319 \\!\\otimes\\!\\hat{t}_\\text{y}^{00}\\right\\}\\hat u,\\end{aligned}\\ ] ] where @xmath320 . in order to calculate each element of @xmath103 , the expression of the coefficient @xmath321 of @xmath322",
    "is needed in addition to eqs .",
    "( [ photon_dis_00 ] ) and ( [ photon_dis_11 ] ) .",
    "this can be calculated from eqs .",
    "( [ imperfect_epr_gc ] ) , ( [ gamma ] ) , and ( [ photon_num_wigner ] ) as @xmath323 \\delta_{j , k}. \\label{photon_dis_22}\\end{aligned}\\ ] ] using the results above , the two - photon effect of the input state can be considered for the derivation of the density matrices ( @xmath151 , @xmath103 ) and the fidelity ( @xmath174 , @xmath185 ) ."
  ],
  "abstract_text": [
    "<S> we present a general formalism to describe continuous - variable ( cv ) quantum teleportation of discrete - variable ( dv ) states with gain tuning , taking into account experimental imperfections . here the teleportation output is given by independently transforming each density matrix element of the initial state . </S>",
    "<S> this formalism allows us to accurately model various teleportation experiments and to analyze the gain dependence of their respective figures of merit . </S>",
    "<S> we apply our formalism to the recent experiment of cv teleportation of qubits [ s. takeda _ </S>",
    "<S> et al . _ , </S>",
    "<S> nature * 500 * , 315 ( 2013 ) ] and investigate the optimal gain for the transfer fidelity . </S>",
    "<S> we also propose and model an experiment for cv teleportation of dv entanglement . </S>",
    "<S> it is shown that , provided the experimental losses are within a certain range , dv entanglement can be teleported for any non - zero squeezing by optimally tuning the gain . </S>"
  ]
}