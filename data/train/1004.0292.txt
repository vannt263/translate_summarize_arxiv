{
  "article_text": [
    "eigenproblems arise in many scientific applications and in some cases , only a limited set of eigenpairs is needed . for example , to calculate all - to - all propagators in lattice quantum chromodynamics ( qcd ) @xcite , it is known that the contribution of some low - lying eigenvalues of a large sparse hermitian matrix called  hermitian fermion matrix \" is dominant .    for such eigenproblems , the implicitly restarted lanczos method or generally , the implicitly restarted arnoldi method ( iram ) @xcite is one of the conventional choices . on the other hand , to find eigenvalues in a given region and corresponding eigenvectors with contour integrations , the sakurai - sugiura ( ss ) method @xcite has been proposed .",
    "the ss method translates a problem of finding eigenvalues in a domain surrounded by an integration path into a problem of solving systems of linear equations for some matrices with shifts corresponding to quadrature points of the contour integration .",
    "therefore solving shifted linear systems efficiently plays an important role of high performance of the ss method . in this paper , we improve the ss method by reducing computational cost for solving shifted linear systems .    to solve such shifted linear systems efficiently , there are some ways .",
    "one is solving each linear system in parallel since all shifted linear systems arising in the ss method can be solved independently .",
    "this high parallelism is one of the important feature of the ss method .",
    "another way is reducing matrix - vector multiplications in a krylov subspace linear solver .",
    "we consider the latter in this paper .    to that end , we propose following two ideas : first we adopt a krylov subspace method for shifted linear systems @xcite which needs matrix - vector multiplications only for one seed linear system to solve all shifted linear systems because of shift invariance of krylov subspace .",
    "moreover we show that the shifted cg method , which needs no more than one matrix - vector multiplication in each iteration , can be applied to solve such shifted linear systems if a coefficient matrix of a seed linear system is hermite although coefficient matrices of the other shifted systems are non - hermite .",
    "we show the detail in section 2 .",
    "second , in section 3 , we consider appropriate configurations of quadrature points for less iterations for a krylov subspace solver because the number of iterations depends on a shift parameter corresponding to each quadrature point .",
    "section 4 shows some numerical test to investigate the properties of the proposed method and its efficiency by comparison with parpack @xcite , the software package to solve eigenvalue problems with iram in parallel , with a hermitian fermion matrix of lattice qcd and section 5 concludes .",
    "we consider an eigenvalue problem @xmath3 where @xmath4 is a hermitian matrix and @xmath5 is an eigenpair of @xmath6 .",
    "let @xmath7 be a positively oriented closed jordan curve in the complex plane and introduce a contour integration @xmath8 where @xmath9 is an @xmath10 unit matrix and @xmath11 is any nonzero vector . according to the residue theorem",
    ", @xmath12 has only the contribution corresponding to eigenvalues inside @xmath7 .    in the moment",
    "based method @xcite , a moment @xmath13 is defined and let the hankel matrix @xmath14 and the shifted hankel matrix @xmath15 be @xmath16^{m}_{i , j=1},\\quad h^{<}_m \\equiv [ \\mu_{i+j-1}]^{m}_{i , j=1},\\ ] ] respectively , where @xmath17 is the number of eigenvalues inside @xmath7 . here let @xmath18 \\in \\mathbb{c}^{n\\times m}$ ] , eigenvalues of the pencil @xmath19 are given by @xmath20 and an eigenvector corresponding to @xmath21 is given by @xmath22 where @xmath23 is an eigenvector of ( @xmath24 ) .",
    "on the other hand , in a rayleigh - ritz type approach @xcite , constructing an orthonormal basis @xmath25 via the orthogonalization of @xmath26 , approximate eigenvalues are given by the ritz values of a projected matrix pencil @xmath27 where @xmath28 and @xmath29 , respectively , and corresponding eigenvectors are given by @xmath30 where @xmath31 is an eigenvector of @xmath27 .",
    "the rayleigh - ritz projection method is rather accurate than the moment - based method , however there is trade - off between accuracy and memory consumption .    to calculate ( [ s_k ] ) numerically ,",
    "the @xmath32-point trapezoidal rule is applied and we approximate @xmath12 by @xmath33 where @xmath34 and @xmath35 are a quadrature point and a weight , respectively , and @xmath36 is a normalized quadrature point satisfying the condition @xmath37 with a shift parameter @xmath38 and a scale parameter @xmath39 . in the case of an integration on a circle @xmath40 with a center @xmath41 and a radius @xmath42 , a quadrature point and a weight are defined by @xmath43 and @xmath44 respectively . here",
    "let @xmath45 and suppose @xmath46 , we can rewrite ( [ s_hat_k ] ) as @xmath47 by means of a filter function defined by @xmath48 in the case of a unit circle , it has been shown that @xmath49 @xcite and it suppresses as @xmath50 outside the circle .",
    "this means that @xmath51 has nonnegligible contribution corresponding to the eigenvalues outside the circle due to the approximation of the contour integration .",
    "when we construct @xmath52 $ ] , @xmath53 should be more than @xmath17 .",
    "note that a block version of the ss method is proposed in @xcite , i.e. @xmath26 is extended to @xmath54 with @xmath55 different arbitrary nonzero vectors @xmath56 . using this method ,",
    "we can obtain @xmath55 degenerate eigenvalues and it is known that the accuracy is higher than just increasing @xmath53 .      to calculate ( [ s_hat_k ] ) , shifted linear systems such that @xmath57 should be solved for each quadrature point @xmath34 . in",
    "what follows , we propose some ideas to reduce the computational cost to solving ( [ linear_eq ] ) with the shifted cg method @xcite .",
    "it is known that there is a shift invariance of krylov subspace @xmath58 with any shift @xmath59 such that @xmath60 in a krylov subspace linear solver such as the cg method , matrix - vector multiplications should be performed to update a residual vector @xmath61 .",
    "because of ( [ shift ] ) , a residual vector @xmath62 corresponding to a matrix @xmath63 can be given by @xmath64 with some scalar @xmath65 , namely once a residual vector of a seed linear system @xmath66 is calculated with matrix - vector multiplications , residual vectors of any other shifted linear systems @xmath67 , what is more , corresponding solution vectors are given without additional matrix - vector multiplications .",
    "suppose the computational cost of matrix - vector multiplications is dominant , the computational cost of the ss method is drastically reduced by @xmath68 .",
    "in addition , we show that only one matrix - vector multiplication in each iteration is needed to solve shifted linear systems when a coefficient matrix consists of a hermitian matrix with any shift .",
    "consider the bicg method to solve a system of linear equations with a coefficient matrix @xmath69 .",
    "the bicg method needs two matrix - vector multiplications in each iteration to update a residual vector @xmath70 and its shadow residual vector @xmath71 .",
    "when @xmath6 is hermite , we find that @xmath72 because of the shift invariance ( [ shift ] ) , @xmath73 is calculated by @xmath66 without matrix - vector multiplications and accordingly , the computational cost is reduced by half , if @xmath74 . applying this technique to the shifted bicg method",
    ", we can solve many shifted linear systems with only one matrix - vector multiplication in each iteration . if a shift @xmath75 for the seed system is real , @xmath76 , i.e. the seed system and its shadow system are coincident . in this case",
    ", we can apply the cg method to solve the seed system .",
    "this means that any shifted linear systems with arbitrary complex shift can be solved with the shifted cg method when a coefficient matrix corresponding to a seed system consists of a hermitian matrix with some real shift . for the above reason , we adopt the shifted cg method in this paper .",
    "empirically , the number of iterations for the shifted cg method depends on distribution of eigenvalues near zero . in terms of shifted matrix @xmath77",
    ", the number of iterations for the shifted cg method tends to increase if the number of eigenvalues of @xmath6 close to @xmath34 becomes larger .",
    "[ iter ] shows the distribution of eigenvalues for the hermitian fermion matrix which we use in section 4 and the contour of the number of iterations for the shifted cg method to solve a shifted matrix @xmath77 with tolerance for the relative residual @xmath78 .",
    "actually , the number of iterations for the shifted cg method gets larger as @xmath34 becomes closer to the real axis and its absolute value of real part becomes larger , which is consistent with the expectation from the distribution of eigenvalues as mentioned above .",
    "then to reduce the number of iterations for the shifted cg method , quadrature points should be as far from the real axis as possible as accuracy of eigenpairs is enough for applications .    in order to control the number of iterations for the shifted cg method and accuracy of eigenpairs",
    ", we introduce a new integration path as follows : let @xmath79 be two horizontal lines such that @xmath80 where @xmath41 is real .",
    "then @xmath81 equally - spaced quadrature points @xmath82 and @xmath83 are located on @xmath84 and @xmath85 , respectively . using this integration path , distance between a quadrature point and the real axis depends only on @xmath86 unlike the case of @xmath40 . in this case , a set of weights for a integration @xmath87 is defined by solving following linear equations , @xmath88    fig .",
    "[ filter ] shows filter functions @xmath89 defined by ( [ filter_func ] ) for @xmath90 quadrature points on @xmath79 with @xmath91 . for comparison , @xmath89 in the case of @xmath40",
    "is also shown . in the case of @xmath40",
    ", @xmath89 has a plateau in [ -1,1 ] and exponentially suppresses in the other region .",
    "however in the case of @xmath79 , there is no plateau and the slope of dumping parts depends on @xmath92 which controls the size of the gap between @xmath84 and @xmath85 .",
    "therefore it is expected that the accuracy of eigenvalues is the highest right in the middle of @xmath79 and gets lower at the edges , so we accept the eigenvalues only in the rectangular formed by @xmath93 quadrature points near the center @xmath41 where @xmath94 is an even number .    note that when we introduce more than two integration paths lying next to each other @xmath95 which have the same @xmath32 , @xmath42 and @xmath92 , quadrature points can be reused by just shifting them from one integration path @xmath96 to another @xmath97 by @xmath98 points .",
    "this is advantage of using the integration path @xmath79 .",
    "a hermitian fermion matrix is defined as @xmath99 where @xmath100 is a hopping parameter and @xmath101 is a complex non - symmetric sparse matrix explained in @xcite .",
    "@xmath102 is one of the dirac @xmath41 matrices .",
    "we employ the lattice size @xmath103 which corresponds to a @xmath104 dimensional matrix with @xmath105 nonzero components .",
    "our choice of @xmath106 is rather close to the critical value @xmath107 .",
    "our experiments are carried out on a single node of t2k - tsukuba which has totally 648 nodes providing 95.4 tflops of computing capability .",
    "each node has 4 sets of a 2.3 ghz quad - core amd opteron model 8356 processor and a 8 gbytes ddr2 - 667 memory .",
    "let us first compare the efficiency of the ss method between the conventional integration path @xmath40 and the new integration path @xmath79 by calculating low - lying 6 eigenvalues and corresponding eigenvectors . in both cases , we set @xmath108 , @xmath109 , @xmath90 and @xmath110 . the gap size between @xmath84 and @xmath85",
    "is varied as @xmath111 .",
    "we employ the shifted cg method with the stopping criterion for the relative residual @xmath78 choosing a shift @xmath112 for the seed .",
    "eigenpairs are obtained with the rayleigh - ritz projection method .",
    "c|c|ccc path & @xmath40 & + @xmath92 & - & 0.2 & 0.6 & 1.0 + # matvec & 4352 & 4268 & 3560 & 2886 + time [ sec ] & 399.1 & 424.8 & 355.5 & 293.2 + res@xmath113 & 1.8@xmath114 & 5.2@xmath115 & 3.1@xmath116 & 1.5@xmath117 + res@xmath118 & 2.8@xmath115 & 1.8@xmath119 & 1.2@xmath120 & 3.0@xmath121 + res@xmath122 & 4.0@xmath115 & 1.9@xmath119 & 1.6@xmath120 & 3.3@xmath121 + res@xmath123 & 2.9@xmath115 & 3.0@xmath119 & 7.1@xmath115 & 1.1@xmath121 + res@xmath124 & 5.6@xmath114 & 2.5@xmath119 & 4.0@xmath115 & 6.7@xmath116 + res@xmath125 & 7.8@xmath119 & 6.6@xmath115 & 1.6@xmath116 & 5.8@xmath121 +    [ result1 ]    we show the efficiency and the accuracy of the ss method with @xmath40 and @xmath79 in table  [ result1 ] , where @xmath126 , @xmath127 is the residual for the @xmath128-th smallest eigenvalue @xmath21 . in the case of @xmath79",
    ", we obtain the lower accuracy of eigenpairs toward the edges of the integration interval as expected in sec .  3 .",
    "we also find that accuracy of eigenpairs is increased at the cost of the number of matrix - vector multiplications as @xmath92 becomes smaller .",
    "this allows us to choose an optimal value of @xmath92 to minimize the computational cost for the required precision of eigenpairs .",
    "we observe similar efficiency between the @xmath40 and @xmath79 cases .",
    "an intriguing finding is that the elapsed time for @xmath79 with @xmath129 is larger than that of @xmath40 even if the number of matrix - vector multiplications of the former is less than that of the latter .",
    "the reason is that the vector operations in the shifted cg method require nonnegligible computational cost compared to the matrix - vector multiplication which contains only 51 nonzero components in each row in our case .",
    "we also compare the efficiency between parpack and the ss method with @xmath40 and @xmath79 by calculating 20 low - lying eigenvalues and corresponding eigenvectors .",
    "the parameters of the ss method are chosen to satisfy the tolerance @xmath130 and the stopping criterion for parpack @xmath131 . for the ss method with @xmath40",
    "we employ 4 circles with @xmath90 , @xmath110 choosing @xmath132 and @xmath133 , each of which contains 5 eigenvalues .",
    "the ss method with @xmath79 uses 6 pair of lines with @xmath90 , @xmath110 , @xmath134 , @xmath135 and @xmath129 .",
    "the other setup for the ss method is the same as the previous experiment . for parpack",
    "the number of the arnoldi vectors is chosen to be four times the number of eigenvalues , i.e. 80 , in the regular mode .",
    "c|ccc & ss ( @xmath40 ) & ss ( @xmath79 ) & parpack + # matvec & 7542 & 6680 & 7384 + total # quad .",
    "points & 128 & 102 & - + total time [ sec ] & 1159.4 & 1020.7 & 1277.4 + time for matvec [ sec ] &",
    "421.2 & 365.5 & 406.1 + @xmath136 & 7.7@xmath115 & 2.6@xmath115 & 2.8@xmath119 + @xmath137 & 1.4@xmath119 & 7.7@xmath138 & 3.6@xmath139 +    [ result2 ]    table [ result2 ] shows the efficiency and the accuracy of three methods . @xmath136 and @xmath137 are the maximum and minimum value of @xmath140 , respectively .",
    "there are two important points .",
    "one is that the ss method shows similar or better efficiency and accuracy in comparison with parpack thanks to the shifted cg method which reduces the number of matrix - vector multiplications by about 1/100 .",
    "another is that the ss method with @xmath79 needs less numbers of matrix - vector multiplications and quardrature points compared to the @xmath40 case .",
    "this is because the @xmath79 case requires less number of iterations for the shifted cg method and allows us to reuse the quadrature points .",
    "we introduce a shifted krylov subspace method to reduce the computational cost for the ss method .",
    "moreover we propose a new integration path along straight lines which decreases both the number of iterations for a krylov subspace solver and the number of quadrature points .",
    "we calculate some low - lying eigenvalues and corresponding eigenvectors of a hermitian fermion matrix with the ss method and parpack .",
    "we show that the ss method becomes efficient comparable with parpack thanks to the shifted cg method and our new integration path is more efficient than the conventional one on a circle .",
    "investigating more efficient integration paths and quadrature rules to reduce computational cost for the ss method is our future plan .",
    "numerical calculations for the present work have been carried out on the t2k - tsukuba computer under the  interdisciplinary computational science program \" of center for computational sciences , university of tsukuba .",
    "this work is supported in part by grants - in - aid for scientific research from the ministry of education , culture , sports , science and technology ( nos .",
    "18540250 , 20105002 , 21105502 and 21246018 ) .",
    "99 j. foley , k. j. juge , a. @xmath141 cais , m. peardon , s. m. ryan and j. skullerud , practical all - to - all propagators for lattice",
    "qcd , comput.phys.commun . , * 172 * ( 2005 ) , 145 - 162 .",
    "d. sorensen , implicit application of polynomial filters in a k - step arnoldi method , siam j. matrix anal .",
    "appl . , * 13 * ( 1992 ) , 357 - 385 t. sakurai and h. sugiura , a projection method for generalized eigenvalue problems using numerical integration , j. comput .",
    "appl . math .",
    ", * 159 * ( 2003 ) , 119 - 128 .",
    "b. jegerlehner , krylov space solvers for shifted linear systems , arxiv : hep - lat/9612014v1 .",
    "k. j. maschhoff and d. c. sorensen , p_arpack : an efficient portable large scale eigenvalue package for distributed memory parallel architectures , http://www.caam.rice.edu / software / arpack/. t. sakurai and h. tadano , cirr : a rayleigh - ritz type method with contour integral for generalized eigenvalue problems , hokkaido mathematical journal , * 36 * ( 2007 ) , 745 - 757 .",
    "t. ikegami , t. sakurai , u. nagashima , a filter diagonalization for generalized eigenvalue problems based on the sakurai - sugiura projection method , j. comput .",
    ", * 233 * ( 2010 ) , 1927 - 1936 . t. sakurai , h. tadano , y. kuramashi , application of block krylov subspace algorithms to the wilson - dirac equation with multiple right - hand sides in lattice qcd , comput .",
    "* 181 * ( 2010 ) , 113 - 117 ."
  ],
  "abstract_text": [
    "<S> we consider a quadrature - based eigensolver to find eigenpairs of hermitian matrices arising in lattice quantum chromodynamics . to reduce the computational cost for finding eigenpairs of such hermitian matrices , we propose a new technique for solving shifted linear systems with complex shifts by means of the shifted cg method </S>",
    "<S> . furthermore using integration paths along horizontal lines corresponding to the real axis of the complex plane , the number of iterations for the shifted cg method is also reduced . </S>",
    "<S> some numerical experiments illustrate the accuracy and efficiency of the proposed method by comparison with a conventional method .    </S>",
    "<S> _ @xmath0graduate school of pure and applied sciences , university of tsukuba , tsukuba , ibaraki 305 - 8571 , japan + @xmath1graduate school of systems and information engineering , university of tsukuba , tsukuba , ibaraki 305 - 8573 , japan + @xmath2center for computational sciences , university of tsukuba , tsukuba , ibaraki 305 - 8577 , japan _ </S>"
  ]
}