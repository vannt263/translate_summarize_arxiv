{
  "article_text": [
    "let @xmath2 be a polytope in @xmath3 .",
    "euler - maclaurin formulas are expressions which may be used to approximate riemann sums of smooth functions @xmath4 such as @xmath5 in terms of integrals involving @xmath0 .",
    "such formulas may be traced back to the work of l. euler and c. maclaurin in the first half of the xix century . partly due to its connections to other areas of mathematics ,",
    "this topic has attracted great interest recently , see for instance berline - vergne  @xcite , brion - vergne  @xcite , cappell - shaneson  @xcite , guillemin - sternberg  @xcite , guillemin - sternberg - weitsman  @xcite , guillemin - stroock  @xcite , guillemin - wang  @xcite , karshon - sternberg - weitsman  @xcite , shaneson  @xcite , tate @xcite , and vergne  @xcite .",
    "let us also mention that in ( * ? ? ?",
    "* section  5 , theorem 5.9 ) charles and v ngoc obtained an asymptotic expansion for a sum over integral points of a convex polytope as a consequence of a trace formula , and computed explicitly the first term of this expansion .",
    "our interest in euler - maclaurin formulas originates mainly in the applications they have in spectral theory of differential operators , see for instance the recent articles of burns - guillemin - wang  @xcite and zelditch  @xcite .",
    "euler - maclaurin formulas are also connected to major problems in number theory , see eg .",
    "lagarias  @xcite . at least in dimension one , these formulas have many other applications in other areas , for instance in numerical analysis and computational mathematics , see e.g. berrut  @xcite and tausch  @xcite , in actuarial sciences , for instance simple approximations in terms of annuities with annual payments are available based on euler - maclaurin formulas ( see @xcite and the references therein ) , and in the study of the casimir effect problem , see for instance @xcite . in @xcite , costin and garoufalidis describe applications of euler - maclaurin formulas to linear difference equations with a small parameter , and to the study of knotted 3-dimensional objects .",
    "recently , tate  @xcite obtained concrete euler - maclaurin formulas to approximate riemann sums of the form ( [ eq : sum ] ) for smooth functions on lattice polytopes in any dimension , building primarily on the work of berline and vergne  @xcite .",
    "as a consequence of this general result and its rather involved proof , tate obtained a fully explicit formula for riemann sums over delzant polygons ( figure  [ fig : polytopes ] ) , that is delzant polytopes in dimension 2 .",
    "this case is already of interest because such delzant polygons arise as images of the moment maps of 4-dimensional toric manifolds .",
    "let us briefly explain how toric manifolds enter the picture .",
    "let @xmath6 be a compact connected symplectic toric manifold , @xmath7 the underlying moment map , and @xmath8 the associated delzant polytope .",
    "assume that there exists a prequantum line bundle @xmath9 , that is a holomorphic , hermitian line bundle which chern connection has curvature @xmath10 , and consider the space @xmath11 of holomorphic sections of @xmath12 ; @xmath13 is the hilbert space of geometric quantization .",
    "a standard result states that the dimension of @xmath13 is equal to the number @xmath14 of integer points in the polytope @xmath15 ( see @xcite for a nice exposition in the case @xmath16 . ] ) , that is the so - called ehrhart polynomial @xcite of this polytope .",
    "an analogous result for toric varieties was one of the motivations behind works by khovanski  @xcite , followed by khovanski and pukhlikov  @xcite ( see also kantor and khovanski  @xcite ) , providing formulas for sums of values of @xmath0 on lattice points of a lattice polytope , where @xmath0 is of the form polynomial times exponential . + more generally , let @xmath17 be commuting self - adjoint berezin - toeplitz operators ( each @xmath18 acts on the space @xmath13 defined above ; for more details , see for instance @xcite and references therein ) whose principal symbols are the components of the moment map @xmath7 .",
    "a result recently obtained by charles , pelayo and v ngoc  ( * ? ? ?",
    "* theorem @xmath19 ) states that the joint spectrum @xmath20 ( consisting of joint eigenvalues ) of @xmath21 coincides , up to @xmath22 , with the set @xmath23 where @xmath24 is any vertex of the delzant polytope @xmath8 and the sequence of functions @xmath25 admits a @xmath26-asymptotic expansion of the form @xmath27 , where each @xmath28 is smooth .",
    "thus , given any smooth function @xmath29 , the trace of the operator @xmath30 is equal to @xmath31 where @xmath32 is defined by the formula @xmath33 ( the particular case @xmath34 corresponds to the computation of the dimension of @xmath13 , see discussion above ) .",
    "the right - hand side of this equality is of the form ( [ eq : sum ] ) , up to a multiplicative factor @xmath35 , and can thus be evaluated thanks to euler - maclaurin formulas .",
    "the goal of this paper is double .",
    "firstly , we recover some of tate s results by elementary methods  different from those used in  @xcite  starting from a result due to guillemin and sternberg  @xcite , which was itself derived by elementary means .",
    "more precisely , we obtain explicit euler - maclaurin formulas to approximate ( [ eq : sum ] ) for compactly supported functions @xmath0 on wedges in @xmath3 , intervals , polygons , and polytopes @xmath2 in @xmath36 , where the coefficients in the asymptotic expansion are sums of differential operators involving only derivatives of @xmath0 in directions normal to the faces of @xmath2 .",
    "secondly , we provide explicit examples in dimension 2 ; the first one is fully explicit , in the sense that the asymptotic expansion of ( [ eq : sum ] ) is finite and that we provide all of its coefficients , while for the second one we provide some numerical evidence of the correctness of this asymptotic expansion .",
    "the only reason to restrict ourselves to intervals , polygons and @xmath1-polytopes , is because of technical difficulties due to our method of proof .",
    "we hope to be able to extend our techniques to higher dimensions in future works . however , we believe that the methods and results presented here are themselves already interesting , understandable in the sense that they only involve elementary computations , and may serve as a comprehensive introduction to the more general topic of euler - maclaurin formulas over lattice polytopes in any dimension as treated in  @xcite . furthermore ,",
    "despite the simplicity of the computations involved in the cases that we treat , we have not seen them explicitly written anywhere , which constitutes another reason to think that this proof is worth presenting on its own .",
    "the structure of the paper is as follows : in section  [ mainm ] we will state our main result , and the remaining sections of the paper are devoted to its proof and further refinements . in the case of polygons",
    "@xmath2 , our approach leads to formulas in which the coefficients in the asymptotic expansion can be explicitly calculated , and we do so in section  [ n2case ] . in the appendix , we recall some of tate s notation and results and provide a comparison with ours .",
    "let @xmath37 and let @xmath38 be the integer lattice in @xmath39 .",
    "let @xmath40 and @xmath41 be the corresponding dual spaces .",
    "let @xmath42 denote the pairing of @xmath41 with @xmath39 .",
    "the subset @xmath43 given by the inequalities @xmath44 is called an _ integer @xmath45-wedge _ if for every @xmath46 the constant @xmath47 is an integer and the vector @xmath48 is a primitive lattice vector in @xmath41 .",
    "let @xmath49 be the subspace of @xmath50 spanned by the @xmath48 s .",
    "we say that @xmath51 is _ regular _ if @xmath52 is a lattice basis of the lattice @xmath53 .    when @xmath54 , define the diffeomorphism @xmath55 , such that @xmath56 has coordinates @xmath57 , @xmath58 , in the standard orthonormal basis of @xmath3 .",
    "let @xmath59 be the facet of @xmath51 defined by @xmath60 for @xmath61 , set @xmath62 and let the constant @xmath63 be defined as the jacobian of the diffeomorphism @xmath64 , and write @xmath65 let @xmath66 be the dual basis of @xmath67 .",
    "the constant @xmath63 is the inverse of the volume of the parallelotope generated by the vectors @xmath68 for @xmath69 such that @xmath70 , that is , the primitive outwards vectors defining the face @xmath71 ( see figure [ fig : kalpha ] ) .",
    "we introduce the following notation :    * @xmath72 ; * @xmath73 is given by @xmath74 if @xmath75 , @xmath76 if @xmath70 ; * if @xmath77 , @xmath78 is the @xmath79-tuple of vectors @xmath80 * @xmath81 stands for the number of indices @xmath69 such that @xmath75 .",
    "we define @xmath82 , @xmath83 as follows : @xmath84 , @xmath85 , @xmath86 if @xmath87 and @xmath88 with @xmath89 the @xmath90-th bernoulli number .",
    "let @xmath91    a regular @xmath92-wedge is an example of an @xmath92-dimensional delzant polytope .",
    "let @xmath93 be an @xmath92-dimensional polytope .",
    "we say that @xmath2 is _ delzant _ if it is a simple and regular polytope is _ simple _ if there are exactly @xmath92 edges meeting at each vertex of @xmath2 ; it is _ regular _ if the primitive vectors in the direction of the edges span a basis of @xmath94 , i.e. for each vertex @xmath24 of @xmath2 , the edges of @xmath2 which intersect at @xmath24 lie on rays @xmath95 , @xmath96 , where @xmath97 is a lattice basis of @xmath38 . ] .",
    "suppose that @xmath2 has @xmath98 facets .",
    "then @xmath2 is defined by @xmath98 equations : @xmath99 where @xmath100 . for @xmath101 , we denote by @xmath102 the set of faces of codimension @xmath103 of @xmath2 .",
    "the following theorem gives asymptotic euler - maclaurin formulas for riemann sums .",
    "it holds in any dimension for wedges , and in dimensions @xmath104 , @xmath105 , and @xmath1 for polytopes .",
    "the case of @xmath106-dimensional polytopes is more complicated to handle with our techniques , and we leave it to future works ( see remark  [ xx ] ) .",
    "the first assertion of the theorem is the same as  ( * ? ? ?",
    "* proposition  3.1 ) ( see the appendix for a comparison ) , and the second one is similar to  ( * ? ? ? * theorem  5.1 ) .",
    "in fact , the uniqueness result  ( * ? ? ?",
    "* theorem  5.3 ) implies that the operators that we construct are the same , but what differs is the way we obtain them .",
    "[ keyt ] let @xmath107 .",
    "then the following hold .    * if @xmath51 if a regular @xmath92-dimensional wedge in @xmath3 , @xmath108 where the integral is taken over @xmath51 if the intersection is empty , and the integral over a single point means evaluation at this point .",
    "the sign @xmath109 indicates equality modulo @xmath110 . *",
    "if @xmath93 , @xmath111 , is an @xmath92-dimensional delzant polytope with vertices in @xmath94 , for every @xmath112 and every face @xmath113 with @xmath114 , there exists a linear differential operator @xmath115 of degree @xmath116 depending only on @xmath71 and involving only derivatives of @xmath0 in directions normal to @xmath71 such that @xmath117    theorem  [ keyt ] will follow from combining several upcoming results :    * proposition  [ keylemma ] ; * theorem  [ theo : w ] ; * theorem  [ h2 ] .",
    "some of the results of the paper are more general than theorem  [ keyt ] , but we leave them to later sections for simplicity .",
    "our proof of theorem  [ keyt ] is different from the proof of tate s general result in ( * ? ? ?",
    "* theorem  5.1 ) , self - contained , and elementary ( in the sense that it relies only on freshman calculus ) .",
    "we expect to extend part ( ii ) of theorem  [ keyt ] to higher dimensions in future works .    in the case where @xmath2 is a polygon , we give concrete expressions for the coefficients in the formula in theorem  [ keyt ] , see theorem  [ lemma : polydim2 ] .",
    "-dimensional wedge.,width=151 ]",
    "the following approximation result was recently proven by guillemin - sternberg @xcite .",
    "let @xmath51 be a regular integer @xmath45-wedge defined by .",
    "let @xmath118 be the perturbed set defined by @xmath119 , @xmath46 , where @xmath120 . then ,",
    "if @xmath107 , we have that @xmath121 where @xmath122 and @xmath123 is the todd function , on the variable @xmath124 , for every @xmath125 .",
    "the sign @xmath109 indicates equality modulo @xmath110 .",
    "[ lm : wedgegs ]      now let @xmath126 be an @xmath92-dimensional delzant polytope with vertices in @xmath38 and exactly @xmath98 facets .",
    "then @xmath2 is defined by the inequalities @xmath127 where @xmath47 is an integer and @xmath128 is a primitive vector perpendicular to the @xmath129-facet of @xmath2 , and pointing outwards from @xmath2 .",
    "because @xmath2 is simple by assumption , every codimension @xmath130 face of @xmath2 is defined by a collection of equalities @xmath131 , @xmath132 , where @xmath71 is a subset of @xmath130 elements of the set @xmath133 .",
    "let @xmath134 denote the @xmath130-wedge @xmath135 because @xmath2 is regular , each @xmath130-wedge @xmath134 is regular .    guillemin and sternberg have recently shown @xcite the following euler - maclaurin formula .",
    "[ regsim : gs ] let @xmath2 be a delzant polytope with vertices in @xmath94 .",
    "let @xmath136 be the perturbed polytope defined by the equations @xmath137 , @xmath100 . then , if @xmath107 , we have @xmath138 where @xmath139 and @xmath123 is the todd function on the variable @xmath124 , for every @xmath140 .",
    "a general asymptotic euler - maclaurin formula for riemann sums over lattice polytopes ( simple or not ) was given by tate @xcite .",
    "as far as we know , theorem [ regsim : gs ] does not follow from tate s formula .",
    "other euler - maclaurin formulas have been obtained by berline - vergne @xcite , brion - vergne @xcite , cappell - shaneson @xcite , karshon - sternberg - weitsman @xcite , and zelditch @xcite among other authors .",
    "let @xmath51 be a regular integer @xmath92-wedge defined by . recall that @xmath66 is the dual basis of @xmath67 and @xmath59 is the facet of @xmath51 defined by @xmath141 then @xmath142 generates the edge @xmath143 .",
    "for any integer @xmath103 , we introduce the operator @xmath144 defined by @xmath145 with the convention that the integral is taken over @xmath51 if the intersection is empty , and that integrating a function over the vertex means evaluating it at the vertex .",
    "@xmath63 is a constant depending only on the face @xmath146 , of which we gave an interpretation earlier .",
    "[ keylemma ] if @xmath107 , we have that @xmath147    the idea of the proof is the following : first , we compute the full asymptotic expansion given by lemma [ lm : wedgegs ] in the case of the standard @xmath92-wedge @xmath148 . then , we perform a change of variables to deal with the case of a general regular @xmath92-wedge .",
    "we start by writing the expansion of @xmath149 ; we recall that @xmath150 write @xmath151 where @xmath152 .",
    "the coefficient @xmath153 of @xmath154 in @xmath155 is equal to @xmath156 with @xmath157 hence @xmath158    from this result , we deduce a formula for the case of the standard wedge .",
    "remember that @xmath159 thus @xmath160 where @xmath161 and @xmath162 . from this",
    "we obtain a general formula when @xmath163 : @xmath164 this finally yields @xmath165 this gives the desired formula in the case of the standard wedge .",
    "let us now turn to the general case .",
    "let @xmath51 be the regular @xmath92-wedge defined by ( [ for:1 ] ) .",
    "define the diffeomorphism @xmath166 , such that @xmath56 has the following coordinates in the standard orthonormal basis of @xmath3 : @xmath167 then @xmath168 is the standard wedge ; moreover , @xmath169 is a diffeomorphism from @xmath170 to @xmath171 for each subset @xmath172 of @xmath173 .",
    "we have that @xmath174 with @xmath175 .",
    "but we know from the previous case that @xmath176 therefore , it only remains to prove that for every @xmath177 , @xmath178 first , we have to express the quantity @xmath179 in terms of @xmath0 . since @xmath180 , we have @xmath181 but @xmath182",
    "so @xmath183 .",
    "it follows that @xmath184 by induction , we find @xmath185 now , we have to understand integrals of the form @xmath186 from the previous discussion @xmath187 hence @xmath188 where @xmath63 is the jacobian of the diffeomorphism @xmath189 , which was to be proved .",
    "another way to write this result is the following : we can eliminate the constants @xmath63 by normalizing the measure on the face @xmath190 ; we set @xmath191",
    "in order to deduce a formula for polygons and @xmath1-dimensional polytopes , we need to rewrite the asymptotic expansion in proposition  [ keylemma ] in a suitable form .",
    "some of the results of this section apply for general @xmath37 , and when this is the case we present the most general version of the result .",
    "the final results require that we restrict to @xmath192 , or @xmath1 .",
    "recall that for @xmath193 , @xmath194 denotes the set of faces of codimension @xmath98 of @xmath51 . in order to simplify the notation , we set @xmath195 for @xmath196 .",
    "our objective is to write a formula of the following kind : @xmath197 where @xmath198 is a differential operator associated to the face @xmath71 , with good properties in a sense that we will precise later .",
    "let @xmath199 .",
    "there exists a subset @xmath200 of @xmath173 such that @xmath201 ; the family @xmath202 is a basis of the linear subspace spanned by @xmath71 . a first expression for @xmath198 is @xmath203 observe that if @xmath204 , then @xmath205 . if @xmath206 , then @xmath198 involves the integral @xmath207 when @xmath208 , the situation is a little bit more complicated , because we integrate directional derivatives of @xmath0 involving the vectors @xmath209 .",
    "but we would like to keep only quantities that depend on the face @xmath71 and nothing else ; this is why we decompose the vectors @xmath209 as follows : @xmath210 where @xmath211 is the outward primitive normal to the facet @xmath212 .",
    "next , we expand the quantity @xmath213 as a linear combination of @xmath214 terms involving the vectors @xmath215 and @xmath216 .",
    "more precisely , write equation ( [ eq : vi ] ) as @xmath217 where @xmath218 , @xmath219 if @xmath220 and @xmath221 , @xmath222 if @xmath223 . moreover , set @xmath224 and define integers @xmath225 , @xmath226 as follows : @xmath227 if @xmath228 ,  , @xmath229 if @xmath230",
    ". then @xmath231 which can be written by multilinearity as @xmath232 we now want to get rid of the vectors @xmath233 , @xmath220 when they appear in the quantity @xmath234 if @xmath235 all belong to @xmath172 , then only the normal vectors @xmath236 appear , and we have nothing to do ; this constitutes @xmath237 favorable cases . in unfavorable cases , we use the following lemma .    [ lemma : int ] for any function @xmath238 and for every @xmath220 , we have @xmath239 where @xmath240 is the face of codimension @xmath241 defined by @xmath242 .",
    "let the elements of @xmath243 be denoted by @xmath244 .",
    "one has @xmath245      when @xmath246 , applying lemma  [ lemma : int ] to functions of the form @xmath247 and repeating this as many times as necessary , we can get rid of all the vectors @xmath233 , @xmath220 in the expression of @xmath248 and keep only integrals over faces of codimension greater than @xmath98 of derivatives of @xmath0 applied to vectors that are normal to the hyperplanes defining the faces .    before we state and prove our result , let us introduce some useful notation . let @xmath249 be the cone generated by the set @xmath250 if @xmath251 is a non - empty subset of @xmath39 , let @xmath252 be the vector subspace generated by the elements of the form @xmath253 , @xmath254 .",
    "the following two lemmas hold in any dimension ( not just @xmath105 and @xmath1 ) .",
    "[ lemma : depend ] decompose the vectors @xmath142 , @xmath255 , as in equation ( [ eq : vi ] ) .",
    "choose another set of vectors @xmath256 such that    * @xmath257 , @xmath258 belongs to @xmath259 * the family @xmath260 is a primitive lattice basis ,    and write , for @xmath255 , @xmath261 then for @xmath223 , we have @xmath262 .    in other words , this means that the scalars @xmath263 only depend on the face @xmath71 ; when @xmath71 will be considered as a face of a polytope instead of a wedge , then the contribution coming from each wedge will display the same coefficient .    by definition of the vectors @xmath233 , @xmath236 , @xmath264 , one has @xmath265 hence ,",
    "the @xmath98 coefficients @xmath263 , @xmath223 , are obtained by solving the linear system ( [ eq : zeta ] ) of @xmath98 equations .",
    "now , we express the vector @xmath258 in the basis @xmath266 : @xmath267 since the vector @xmath258 belongs to @xmath268 , all the scalar products @xmath269 , @xmath270 , vanish .",
    "this implies that for every @xmath270 , @xmath271 .",
    "thus , the matrix @xmath272 of change of basis from @xmath273 to @xmath274 is of the form @xmath275 where @xmath276 since @xmath273 and @xmath277 are primitive lattice bases , we have @xmath278 , and hence for every @xmath255 , @xmath279 . but",
    "@xmath142 and @xmath258 belong to @xmath249 , so @xmath280 .",
    "this yields that for @xmath281 , we have @xmath282 .",
    "[ lemma : dependmu ] decompose the vectors @xmath142 , @xmath255 , as in equation ( [ eq : vi ] ) , and fix @xmath220 . set @xmath283 , and choose another set of vectors @xmath284 such that",
    "* @xmath285 , @xmath258 belongs to @xmath286 * the family @xmath287 is a primitive lattice basis .    and",
    "write , for @xmath255 , @xmath288 then we have @xmath289 .",
    "in other words , this means that the scalar @xmath290 only depends on the face @xmath291 .    by definition of the vectors @xmath292 , @xmath293 , @xmath294 , one has @xmath295 which can be written in matrix form @xmath296 where @xmath297 are the column vectors given by @xmath298 and @xmath299",
    "is the symmetric matrix whose generic coefficient is @xmath300 , @xmath301 .",
    "similarly , the constants @xmath302 satisfy the system of equations @xmath303 and @xmath304 thanks to the proof of the previous lemma , we know that there exists scalars @xmath305 , @xmath306 , @xmath307 such that @xmath308 hence we have @xmath309 as well as @xmath310 and @xmath311 using these relations , equations ( [ eq : ek ] ) become @xmath312 while equation ( [ eq : ei ] ) becomes @xmath313 considering the linear combination ( [ eq : ei ] ) - @xmath314([eq : ek ] ) , we replace equation ( [ eq : ei ] ) by the new equation ( we do no write the details of the computations ) @xmath315 together with equations ( [ eq : ek ] ) , this means that the coefficients @xmath302 are solutions of the system @xmath316 where @xmath299 and @xmath317 are as before , @xmath318 is defined as @xmath319 but with the coefficients @xmath302 instead of @xmath320 , and @xmath49 is the column vector whose entries are @xmath321 , @xmath322 comparing this to ( [ eq : s1 ] ) yields @xmath323 , and in particular @xmath324 .",
    "[ theo : w ] assume that @xmath111 . for every @xmath112 and every face @xmath199 with @xmath325 ,",
    "there exists a linear differential operator @xmath115 of degree @xmath326 depending only on @xmath71 ( in the sense introduced in the previous lemmas ) and involving only derivatives of @xmath0 in directions normal to the face @xmath71 such that @xmath327    to compute @xmath115 , we apply the previous technique to faces of codimension smaller than @xmath98 and gather their contribution as integrals over @xmath71 .",
    "it follows from lemma  [ lemma : depend ] and lemma  [ lemma : dependmu ] that @xmath115 depends only on the face @xmath71 ; let us briefly explain how .",
    "if @xmath328 , we have to handle two types of faces : the two edges ( @xmath329 ) and the vertex ( @xmath330 ) of the wedge .",
    "there is not much to say about the case of the vertex .",
    "when we integrate over an edge , and we apply our technique , we will find    * constants @xmath331 in front of derivatives of @xmath0 evaluated at the vertex , and there is nothing to prove , * constants @xmath332 in front of integrals of derivatives of @xmath0 on @xmath71 , and lemma  [ lemma : depend ] ensures that it only depends on the face @xmath71 .",
    "if @xmath333 , we have three types of faces , namely planes ( @xmath329 ) , edges ( @xmath330 ) and the vertex ( @xmath334 ) .",
    "the difference with the previous case is that when we consider integrals over a plane , we obtain integrals over edges belonging to this plane , each one displaying a factor @xmath331 ; lemma  [ lemma : dependmu ] ensures that it only depends on the given edge .",
    "[ xx ]    1 .   in dimension @xmath106 and higher ,",
    "the situation is more complicated , and lemma [ lemma : depend ] and lemma [ lemma : dependmu ] are not enough to obtain a similar theorem . indeed",
    ", think of the following situation : we take @xmath335 and want to evaluate @xmath336 we start by expanding @xmath337 and we apply lemma [ lemma : int ] to obtain @xmath338 we have to apply the method one more time for each of these integrals .",
    "for instance , we put @xmath339 and to compute this integral , we write @xmath340 which yields , again thanks to lemma  [ lemma : int ] @xmath341 + hence , in the expression of @xmath172 , we obtain the term @xmath342 does the factor only depend on the face @xmath343 ? we think that our previous lemmas are not enough to give an answer to this question .",
    "2 .   in principle , one should be able to obtain explicit expressions for the operators @xmath344 , but this leads to computations involving a very large number of constants , so it is not reasonable to try to write such an expression .",
    "however , if we restrict ourselves to dimension @xmath105 , we can be fully explicit , as we will see later .",
    "as in section  [ sec : intro ] , let @xmath93 be a delzant polytope with vertices in @xmath94 in dimension @xmath111 with equations @xmath345 , @xmath100 .",
    "recall that for @xmath346 , @xmath347 denotes the set of faces of codimension @xmath45 of @xmath2 .",
    "we introduce as in theorem  [ theo : w ] the operators @xmath115 associated to a face @xmath71 of the polytope ( remembering that it only depends on the face as part of the polytope ) . for any integer @xmath103",
    ", we define the operator @xmath348 by @xmath349    [ h2 ]    if @xmath107 , we have that @xmath350    [ thm : main ]    notice first that @xmath351 where @xmath90 is the number of vertices of @xmath2 and @xmath352 is the regular wedge which is the intersection of the @xmath92 facets @xmath353 , @xmath264 , intersecting at the vertex @xmath68 .",
    "cover @xmath2 by open sets @xmath354 , @xmath355 , such that @xmath354 contains the vertex @xmath68 and does not intersect any other facet than the @xmath353 , @xmath264 .",
    "choose a partition of unity associated to this open covering and write @xmath356 where @xmath357 has support included in @xmath354 . then @xmath358",
    "now , from formula ( [ eq : expansionwedge ] ) , we know that for @xmath359 @xmath360 hence it is enough to check that for all @xmath103 @xmath361 this amounts to show that for each face @xmath71 of the polytope @xmath362 but this is clear because @xmath115 is linear and because @xmath363 .",
    "we would like to compute explicitly the operators @xmath364 ; unfortunately , as already said , this seems to be quite complicated in all generality .",
    "however , we can give nice formulas in dimension @xmath105 .",
    "let @xmath2 be a regular integer polygon defined by . in this case",
    ", we only have two types of faces : vertices ( codimension @xmath105 ) and edges ( codimension @xmath104 ) . let @xmath365 ( resp .",
    "@xmath317 ) be the set of edges ( resp .",
    "vertices ) of @xmath2 .",
    "if @xmath366 belongs to @xmath365 , let @xmath367 be the associated outward primitive normal vector ; if @xmath24 belongs to @xmath317 , let @xmath368 be the integral basis of @xmath369 such that the two edges meeting at @xmath24 are contained in the half - lines @xmath370 , @xmath371 ; we denote by @xmath372 the edge generated by @xmath373 .",
    "define the quantities @xmath374 and @xmath375 .",
    "now , let @xmath366 be an edge , and let @xmath376 be the cone generated by the set @xmath377 . given a generator @xmath378 of @xmath379 ,",
    "there exists a vector @xmath380 such that @xmath381 is a primitive lattice basis of @xmath382 .",
    "the quantity @xmath383 does not depend on the choice of @xmath380 .",
    "the lemma follows from lemma [ lemma : depend ] , but its proof is very simple , so we present it next .",
    "choose another vector @xmath384 such that @xmath385 is a primitive lattice basis of @xmath382 .",
    "write @xmath386 ; then , one has @xmath387 .",
    "the matrix of the change of the basis is of the form @xmath388 because its determinant must be @xmath389 , we have @xmath390 .",
    "since both @xmath391 and @xmath392 belong to @xmath376 , the only possibility is @xmath393 .",
    "[ lemma : polydim2 ] in theorem [ thm : main ] the operators @xmath348 are given by :    * @xmath394 ; + * @xmath395 ; + * @xmath396 ; + * if @xmath397 , then @xmath398 where @xmath399 and @xmath400 is equal to @xmath401 * if @xmath397 , @xmath402 is equal to @xmath403    theorem  [ lemma : polydim2 ] recovers the formula in ( * ? ? ?",
    "* corollary @xmath404 ) . to compare the two formulas ,",
    "one may notice that tate does not separate the even and odd cases , and that in the odd case nearly every coefficient in tate s formula vanishes because of the properties of the bernoulli numbers .",
    "we have to compute the operators @xmath115 as in section [ subsection : expwedge ] .",
    "we start by the case @xmath405 .",
    "let @xmath24 be a vertex and let @xmath51 be the wedge formed by this vertex and the two incident edges .",
    "define the vectors @xmath406 as before , and let @xmath407 ( resp .",
    "@xmath408 ) be the edge generated by @xmath409 ( resp .",
    "@xmath410 ) .",
    "we have @xmath411 if @xmath412 is the outward primitive vector normal to the edge @xmath372 , we write @xmath413 where @xmath414 ( resp .",
    "1 ) if @xmath415 ( resp .",
    "2 ) . taking the scalar product with @xmath236 and @xmath416",
    ", we find @xmath417 now , thanks to lemma [ lemma : int ] , we have ( being careful that the vector @xmath418 is the opposite of the vector @xmath419 in this lemma ) @xmath420 adding the contributions from each vertex , we obtain the desired formula .    now , let @xmath421 ; then @xmath422 we write @xmath423 by lemma [ lemma : int ] , we have @xmath424 and hence we obtain @xmath425 by a straightforward induction , this yields @xmath426    the case @xmath427 works in a similar way .",
    "let us describe two examples in the @xmath105-dimensional case .",
    "the first one is fully explicit , in the sense that we choose a function for which the asymptotic expansion given in theorem [ thm : main ] is finite , and we provide every coefficient of the latter .",
    "the second one is more involved and we compute the first three terms of the asymptotic expansion and give numerical computations of the remainder .",
    "let @xmath2 be the triangle with vertices @xmath428 , @xmath429 and @xmath430 and let @xmath431 be the function defined by @xmath432 ( multiplied by a cutoff function so that it is compactly supported ) .",
    "then @xmath433 therefore , we have @xmath434 using standard formulas for sums of integers and squares of integers , one can check that @xmath435 let us compare this with theorem  [ lemma : polydim2 ] . with the notation of this lemma , we have @xmath436 so the zeroth order terms agree .",
    "let us give names to the vertices and edges of @xmath2 as follows : we put @xmath437 , @xmath438 and @xmath439 , and we let @xmath372 denote the edge joining the vertices @xmath440 ( or @xmath441 ) and @xmath442 ( or @xmath443 ) .",
    "then we have @xmath444 and hence @xmath445 furthermore , we have @xmath446 with @xmath447 and @xmath448 we have @xmath449 , @xmath450 , @xmath451",
    ". moreover @xmath452 and thus @xmath453 .",
    "this yields @xmath454 now , one can check that @xmath455 and @xmath456 .",
    "we obtain @xmath457 and therefore @xmath458    finally , we have @xmath459 because the derivatives of @xmath0 of order greater than @xmath105 vanish .",
    "let us present another example .",
    "we choose @xmath2 as in the previous paragraph , and consider the function @xmath460 we want to evaluate the sum @xmath461 let us compute the coefficients @xmath462 , @xmath463 , of the asymptotic expansion given in theorem [ thm : main ] .",
    "firstly , we have @xmath464 secondly , notice that @xmath465 and hence @xmath466 finally , since @xmath467 and @xmath468 we obtain @xmath469 ( we deliberately keep this fraction as it is , which will make sense in view of the next result ) .",
    "moreover , we have @xmath470 and @xmath471 thus @xmath472 we deduce from the previous results that @xmath473 we can now compute @xmath474 in figure [ fig : comparison ] , we compare the value of @xmath475 to the numerical value of @xmath476 , for @xmath477 . in figure",
    "[ fig : error ] , we numerically evaluate the quantity @xmath478 more precisely , we plot the value of @xmath479 as a function of @xmath480 .",
    "the remainder @xmath481 displays a behavior in @xmath482 , as expected .     and @xmath476 as functions of @xmath483 . ]     as a function of @xmath480 .",
    "notice the behavior in @xmath482 of @xmath481 . ]",
    "we believe that one should be able to prove item ( ii ) in theorem [ keyt ] in dimensions @xmath484 with the same elementary method we use in this paper ( since a similar result was already stated in tate s article in any dimension ) . however , in dimensions @xmath484 the computations appear to be complicated ( but still elementary ) and will be the object of future works ( see also remark  [ xx ] ) .",
    "we devote this appendix to comparing tate s formula for riemann sums over regular wedges ( * ? ? ? * proposition @xmath485 ) and the first assertion of theorem [ keyt ] of the present paper .",
    "firstly , we need to recall some of the notation and definitions used in tate s article @xcite ; most of them come from section @xmath1 of the latter .",
    "+ let @xmath251 be a finite dimensional real vector space , of dimension @xmath486 , and @xmath487 be a lattice in @xmath251 .",
    "let @xmath488 be a unimodular cone ( a wedge ) in @xmath251 and @xmath365 be the integral basis of @xmath487 generating @xmath488 .",
    "then @xmath489 is the set of families of non - negative integers with @xmath490 elements ; an element @xmath491 is of the form @xmath492 .",
    "if @xmath366 belongs to @xmath365 , define @xmath493 in such a way that @xmath494 and @xmath495 if @xmath496 . for @xmath497 , let @xmath498 be the set of @xmath491 such that for all @xmath499 , @xmath500 ; then @xmath491 can be written @xmath501 . if @xmath502 is a subset of @xmath365 , set @xmath503 moreover , set @xmath504 . for @xmath505 , set @xmath506 and @xmath507 .    for @xmath508 and for @xmath497 nonempty , set @xmath509 with @xmath510 , where @xmath82 is the @xmath92-th bernoulli number .",
    "moreover , for @xmath511 , set @xmath512 finally , define the differential operator @xmath513 as @xmath514 with @xmath515 .                using the previous comparison ,",
    "@xmath519 becomes with our notation : @xmath520 hence , formula ( [ formula ] ) becomes @xmath521 which coincides with our formula for wedges ( first assertion of our main theorem [ keyt ] ) .    _",
    "acknowledgements_. ap was supported by nsf career grant dms-1055897 and nsf grant dms-0635607 .",
    "work on the topic of this paper started when ap was a postdoctoral fellow at mit ( 2007 - 2008 ) and during this period he was supported by an nsf postdoctoral fellowship .",
    "he would like to thank victor guillemin for many useful discussions on this paper , and on many other topics related to symplectic geometry and spectral theory , during his stay at mit . finally , we thank michle vergne for comments on a preliminary version of this manuscript .",
    "m. d. hamilton : the quantization of a toric manifold is given by the integer lattice points in the moment polytope .",
    "_ toric topology _",
    ", 131140 , contemp .",
    ", 460 , amer .",
    "soc . , providence , ri , 2008 .",
    "kantor and a.g .",
    "khovanski : une application du thorme de riemann - roch combinatoire au polynme dehrhart des polytopes entiers de @xmath522 .",
    "_ comptes rendus de lacadmie des sciences .",
    "srie i. mathmatique _ ,",
    "* 317 * , no . 5 , 501507 , 1993 .",
    "a. g. khovanski and a. v. pukhlikov : the riemann - roch theorem for integrals and sums of quasipolynomials on virtual polytopes .",
    "_ rossiskaya akademiya nauk .",
    "algebra i analiz _ , * 4 * , no .",
    "4 , 188216 , 1992 .                      * yohann le floch * + school of mathematical sciences + tel aviv university + ramat aviv + tel aviv 6997801 , israel .",
    "+ _ e - mail : _ ylefloch@post.tau.ac.il + * lvaro pelayo * + university of california , san diego + department of mathematics + 9500 gilman dr , # 0112 + la jolla , ca 92093 + united states of america + _ e - mail _ : alpelayo@ucsd.edu"
  ],
  "abstract_text": [
    "<S> recently there has been a renewed interest in asymptotic euler - maclaurin formulas , partly due to applications to spectral theory of differential operators . </S>",
    "<S> using elementary means , we recover such formulas for compactly supported smooth functions @xmath0 on intervals , polygons , and @xmath1-dimensional polytopes @xmath2 , where the coefficients in the asymptotic expansion are sums of differential operators involving only derivatives of @xmath0 in directions normal to the faces of @xmath2 . </S>",
    "<S> our formulas apply to wedges of any dimension . </S>",
    "<S> this paper builds on , and is motivated by , works of guillemin , sternberg , and others , in the past ten years . </S>"
  ]
}