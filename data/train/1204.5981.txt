{
  "article_text": [
    "we consider the following increasingly stronger fragments of first - order logic :    1 .",
    "primitive positive first - order ( @xmath1 ) 2 .",
    "positive horn ( @xmath2 ) 3 .   positive equality - free first - order ( @xmath3 ) ; and , 4 .",
    "positive first - order logic ( @xmath4 )    the _ model checking problem _ for a logic @xmath5 takes as input a sentence of @xmath5 and a structure @xmath6 and asks whether @xmath6 models @xmath7 .",
    "the structure @xmath6 is often assumed to be a fixed parameter and called the template ; and , unless otherwise stated , we will assume implicitly that we work in this so - called _ non - uniform _ setting .",
    "for the above first three fragments , the model checking problem is better known as the _ constraint satisfaction problem _ csp@xmath8 , the _ quantified constraint satisfaction problem _ qcsp@xmath8 and its extension with disjunction which we shall denote by qcsp@xmath9 .",
    "much of the theoretical research into csps is in respect of a large complexity classification project ",
    "it is conjectured that csp@xmath8 is always either in p or np - complete @xcite .",
    "dichotomy _ conjecture remains unsettled , although dichotomy is now known on substantial classes ( e.g. structures of size @xmath10 @xcite and smooth digraphs @xcite ) .",
    "various methods , combinatorial ( graph - theoretic ) , logical and universal - algebraic have been brought to bear on this classification project , with many remarkable consequences .",
    "a conjectured delineation for the dichotomy was given in the algebraic language in  @xcite .",
    "complexity classifications for qcsps appear to be harder than for csps . just as csp@xmath8 is always in np",
    ", so qcsp@xmath8 is always in pspace .",
    "no overarching polychotomy has been conjectured for the complexities of qcsp@xmath8 , as @xmath6 ranges over finite structures , but the only known complexities are p , np - complete and pspace - complete ( see @xcite for some trichotomies ) .",
    "it seems plausible that these complexities are the only ones that can be so obtained .",
    "distinct templates may give rise to the same model - checking - problem or preserve acceptance ,    * ( @xmath5-*equivalence * ) for any sentence @xmath11 of @xmath5 , @xmath12 models @xmath13 @xmath14 @xmath6 models @xmath13 * ( @xmath5-*containment * ) for any sentence @xmath11 of @xmath5 , @xmath12 models @xmath13 @xmath15 @xmath6 models @xmath13 .",
    "we will see that containment and therefore equivalence is decidable , and often quite effectively so , for the four logics we have introduced .",
    "for example , when @xmath5 is @xmath1 , any two bipartite undirected graphs that have at least one edge are equivalent .",
    "moreover , there is a canonical _ minimal _ representative for each equivalence class , the so - called _",
    "core_. for example , the core of the class of bipartite undirected graphs that have at least one edge is the graph @xmath16 that consists of a single edge .",
    "the core enjoys many benign properties and has greatly facilitated the classification project for csps ( which corresponds to the model - checking for @xmath1 ) : it is unique up to isomorphism and sits as an induced substructure in all templates in its equivalence class .",
    "a core may be defined as a structure all of whose endomorphisms are automorphisms . to review , therefore , it is well - known that two templates @xmath12 and @xmath6 are equivalent iff there are homomorphisms from @xmath17 to @xmath18 and from @xmath18 to @xmath17 , and in this case there is an ( up to isomorphism ) unique core @xmath19 equivalent to both @xmath12 and @xmath6 such that @xmath20 and @xmath21 .",
    "the situation for @xmath2 and qcsp is somewhat murkier .",
    "it is known that non - trivial @xmath12 and @xmath6 are equivalent iff there exist integers @xmath22 and @xmath23 and surjective homomorphisms from @xmath24 to @xmath18 and from @xmath25 to @xmath17 ( and one may give a bound on these exponents )  @xcite . however , the status and properties of `` core - ness '' for qcsp were hitherto unstudied .",
    "we * might * call a structure @xmath18 a _ q - core _ if there is no equivalent @xmath17 of strictly smaller cardinality",
    ". we will discover that * this * q - core is a more cumbersome beast than its cousin the core ; it need not be unique nor sit as an induced substructure of the templates in its class .",
    "however , in many cases we shall see that its behaviour is reasonable and that  like the core  it can be very useful in delineating complexity classifications .",
    "the erratic behaviour of q - cores sits in contrast not just to that of cores , but also that of the _ @xmath26-@xmath27-cores _ of  @xcite , which are the canonical representatives of the equivalence classes associated with @xmath28 , and were instrumental in deriving a full complexity classification  a tetrachotomy  for qcsp@xmath0 in @xcite .",
    "like cores , they are unique and sit as induced substructures in all templates in their class .",
    "thus , primitive positive logic and positive equality - free logic behave genially in comparison to their wilder cousin positive horn .",
    "in fact this manifests on the algebraic side also  polymorphisms and surjective hyper - endomorphisms are stable under composition , while surjective polymorphisms are not .    continuing to add to our logics , in restoring equality",
    ", we might arrive at positive logic .",
    "two finite structures agree on all sentences of positive logic iff they are isomorphic  so here every finite structure satisfies the ideal of `` core '' .",
    "when computing a / the smallest substructure with the same behaviour with respect to the four decreasingly weaker logics  positive logic , positive equality - free , positive horn , and primitive positive  we will obtain possibly decreasingly smaller structures . in the case of positive equality - free and primitive positive logic , as pointed out , these are unique up to isomorphism ; and for the @xmath26-@xmath27-core and the core , these will be induced substructures . *",
    "a * q - core will necessarily contain the core and be included in the u - x - core .",
    "this phenomenon is illustrated on table  [ tab : different - cores ] and will serve as our running example .",
    ".different notions of `` core '' ( the circles represent self - loops ) . [ cols=\"^,^,^,^\",options=\"header \" , ]     the paper is organised as follows . in section  [ sec : csp ] , we recall folklore results on csp . in section  [ sec : mylogic ] , we recall results on coreness and spell out containment for @xmath28 that were only implicit in  @xcite . in section  [ sec : qcsp ] , we move on to qcsp and recall results on the decidability of containment from  @xcite together with new lower bounds before initiating a study of the notion of core for qcsp .",
    "unless otherwise stated , we consider structures over a fixed relational signature @xmath29 . we denote by @xmath30 the domain of a structure @xmath12 and for every relation symbol @xmath31 in @xmath29 of arity @xmath22 , we write @xmath32 for the interpretation of @xmath31 in @xmath12 , which is a @xmath22-ary relation that is @xmath33 .",
    "we write @xmath34 to denote the cardinality of the set @xmath30 .",
    "a homomorphism ( resp . , strong homomorphism ) from a structure @xmath12 to a structure @xmath6 is a function @xmath35 such that @xmath36 , if ( resp . , iff ) @xmath37 .",
    "we will occasionally consider signatures with constant symbols .",
    "we write @xmath38 for the interpretation of a constant symbol @xmath39 and homomorphisms are required to preserve constants as well , that is @xmath40 .",
    "containment for @xmath1 is a special case of conjunctive query containment from databases  @xcite .",
    "we state and prove these results for pedagogical reasons , before moving to the case of @xmath28 .",
    "let us fix some notation first . given a sentence @xmath11 in @xmath1 , we denote by @xmath41 its _ canonical database _ , that is the structure with domain the variables of @xmath11 and whose tuples are precisely those that are atoms of @xmath11 . in the other direction ,",
    "given a finite structure @xmath12 , we write @xmath42 for the so - called _ canonical conjunctive query _ of @xmath12 , the quantifier - free formula that is the conjunction of the positive facts of @xmath12 , where the variables @xmath43 correspond to the elements @xmath44 of @xmath12 .. ] it is well known that there is a homomorphism from @xmath41 to a structure @xmath12 if , and only if , @xmath45 . moreover , a winning strategy for @xmath46 in the ( hintikka ) @xmath47-game is precisely a homomorphism from @xmath41 to @xmath12 .",
    "note also that @xmath12 is isomorphic to the canonical database of @xmath48 .",
    "let @xmath12 and @xmath6 be two structures .",
    "the following are equivalent .    for every sentence @xmath11 in @xmath1 , if @xmath49 then @xmath50 .",
    "the exists a homomorphism from @xmath12 to @xmath6 .",
    "@xmath51 .    where @xmath42 denotes the _ canonical conjunctive query _ of @xmath12 .",
    "a homomorphism corresponds precisely to a winning strategy in the @xmath52-game and ( ii ) and ( iii ) are equivalent .",
    "clearly , ( i ) implies ( iii ) since @xmath53 .",
    "we now prove that ( ii ) implies ( i ) .",
    "let @xmath54 be a homomorphism from @xmath12 to @xmath6 .",
    "if @xmath49 , then there is a homomorphism @xmath55 from @xmath41 to @xmath12 . by composition",
    ", @xmath56 is a homomorphism from @xmath41 to @xmath6 . in other words",
    ", @xmath56 is a winning strategy witnessing that @xmath50 .",
    "it is well known that the core is unique up to isomorphism and that it is an induced substructure  @xcite .",
    "it is usually defined via homomorphic equivalence , but because of the equivalence between ( i ) and ( ii ) in the above theorem , we may define the core as follows .    *",
    "the * _ core _ @xmath6 of a structure @xmath12 is a minimal substructure of @xmath12 such that for every sentence @xmath11 in @xmath1 , @xmath49 if and only if @xmath50 .",
    "let @xmath12 and @xmath6 be two structures .",
    "the following are equivalent .    for every sentence @xmath11 in @xmath1 , @xmath49 if and only if @xmath50 .",
    "there are homomorphisms from @xmath12 to @xmath6 and from @xmath6 to @xmath12 .",
    "the core of @xmath12 and the core of @xmath6 are isomorphic .    as a preprocessing step",
    ", one could replace the template @xmath12 of a csp by its core @xmath6 ( see algorithm 6.1 in  @xcite ) . however , the complexity of this preprocessing step would be of the same order of magnitude as solving a constraint satisfaction problem .",
    "this drawback , together with the uniform nature of the instance in constraints solvers , means that this preprocessing is not exploited in practice to the best of our knowledge .",
    "the notion of a core can be extended and adapted suitably to solve important questions related to data exchange and query rewriting in databases  @xcite .",
    "it is also very useful as a simplifying assumption when classifying the complexity : with the algebraic approach , it allows to study only idempotent algebras  @xcite .",
    "for @xmath28 , it is no longer the homomorphism that is the correct concept to transfer winning strategies .",
    "a _ surjective hypermorphism _",
    "@xmath57 from a structure @xmath12 to a structure @xmath6 is a function from the domain @xmath30 of @xmath12 to the power set of the domain @xmath58 of @xmath6 that satisfies the following properties .    *",
    "( * total * ) for any @xmath59 in @xmath30 , @xmath60 . * ( * surjective * ) for any @xmath61 in @xmath58 , there exists @xmath59 in @xmath30 such that @xmath62 . *",
    "( * preserving * ) if @xmath63 holds in @xmath12 then @xmath64 holds in @xmath6 , for all @xmath65 @xmath66 .    a _ strategy _ for @xmath46 in the ( hintikka ) @xmath52-game , where @xmath67 , is a set of mappings @xmath68 with one mapping @xmath69 for each existentially quantified variable @xmath70 of @xmath11 .",
    "the mapping @xmath69 ranges over the domain @xmath30 of @xmath12 ; and , its domain is the set of functions from @xmath71 to @xmath30 , where @xmath71 denotes the universally quantified variables of @xmath13 preceding @xmath70 .",
    "we say that @xmath68 is _ winning _ if for any assignment @xmath72 of the universally quantified variables of @xmath11 to @xmath30 , when each existentially quantified variable @xmath70 is set according to @xmath69 applied to @xmath73 , then the quantifier - free part @xmath74 of @xmath11 is satisfied under this overall assignment @xmath54 . when @xmath74 is disjunction - free , this amounts to @xmath54 being a homomorphism from @xmath75 to @xmath12 .",
    "[ lemma : strategy : transfert : mylogic ] let @xmath12 and @xmath6 be two structures such that there is a surjective hypermorphism from @xmath12 to @xmath6 .",
    "then , for every sentence @xmath11 in @xmath28 , if @xmath49 then @xmath50 .",
    "let @xmath57 be a surjective hypermorphism from @xmath12 to @xmath6 and @xmath11 be a sentence of @xmath28 such that @xmath49 .",
    "for any element @xmath61 of @xmath6 , let @xmath76 .",
    "we fix an arbitrary linear order over @xmath30 and write @xmath77 to denote the smallest antecedent of @xmath61 in @xmath30 under @xmath57 .",
    "let @xmath68 be a winning strategy in the @xmath52-game .",
    "we construct a strategy @xmath78 in the @xmath79-game as follows .",
    "let @xmath80 be an assignment to the universal variables @xmath71 preceding an existential variable @xmath70 in @xmath11 , we select for @xmath81 an arbitrary element of @xmath82 where @xmath83 is an assignment such that for any universal variable @xmath84 preceding @xmath70 , we have @xmath85 . this strategy is well defined since @xmath57 is surjective ( which means that @xmath86 is well defined ) and total ( which means that @xmath87 ) .",
    "note moreover that using @xmath88 in the definition of @xmath86 means that a branch in the tree of the game on @xmath6 will correspond to a branch in the tree of the game on @xmath12 .",
    "it remains to prove that @xmath78 is winning .",
    "we will see that it follows from the fact that @xmath57 is preserving .",
    "assume first that @xmath11 is a sentence of @xmath2 .",
    "let @xmath75 be the canonical database of the quantifier - free part @xmath74 of @xmath11 .",
    "the winning condition of the @xmath79-game can be recast as a homomorphism from @xmath75 .",
    "composing with @xmath57 the homomorphism from @xmath75 to @xmath12 ( induced by the sequence of compatible assignments @xmath86 to the universal variables and the strategy @xmath68 ) , we get a surjective hypermorphism from @xmath75 to @xmath6 .",
    "the map from the domain of @xmath75 to @xmath6 induced by the sequence of assignments @xmath89 and the strategy @xmath78 is a range restriction of this surjective hypermorphism and is therefore a homomorphism ( we identify surjective hypermorphism to singletons with homomorphisms ) .    when @xmath11 is not a sentence of @xmath2 , we write its quantifier - free part in disjunctive normal form as a disjunction of conjunctions - of - atoms @xmath90 .",
    "the winning condition can now be recast as a homomorphism from some @xmath91 .",
    "the above argument applies and the result follows .",
    "consider the structures @xmath92 and @xmath93 from table  [ tab : different - cores ] .",
    "the map @xmath57 given by @xmath94 is a surjective hypermorphism from @xmath92 to @xmath93 . the map @xmath55 given by @xmath95 is a surjective hypermorphism from @xmath93 to @xmath92 .",
    "the two templates are equivalent w.r.t .",
    "@xmath28 .    we extend the notion of canonical conjunctive query of a structure @xmath12 . given a tuple of ( not necessarily distinct ) elements",
    "@xmath96 , define the quantifier - free formula @xmath97 to be the conjunction of the positive facts of @xmath98 , where the variables @xmath99 correspond to the elements @xmath100 .",
    "that is , @xmath101 appears as an atom in @xmath102 iff @xmath103 holds in @xmath12 .",
    "when @xmath98 enumerates the elements of the structure @xmath12 , this definition coincides with the usual definition of canonical conjunctive query .",
    "note also that there is a strong homomorphism from the canonical database @xmath104 to @xmath12 given by the map @xmath105 .",
    "let @xmath12 be a structure and @xmath106 .",
    "let @xmath98 be an enumeration of the elements of @xmath12 .",
    "@xmath107    observe that @xmath108 .",
    "indeed , we may take as witness for the variables @xmath109 the corresponding enumeration @xmath110 of the elements of @xmath12 ; and , for any assignment @xmath111 to the universal variables @xmath112 , it is clear that @xmath113 holds .",
    "[ lemma : canonical : sentence : mylogic ] let @xmath12 and @xmath6 be two structures .",
    "if @xmath114 then there is a surjective hypermorphism from @xmath12 to @xmath6 .",
    "let @xmath115 be witnesses for @xmath43 .",
    "assume that an enumeration @xmath116 of the elements of @xmath6 is chosen for the universal variables @xmath117 .",
    "let @xmath111 be the witness s.t . @xmath118 .",
    "let @xmath57 be the map from the domain of @xmath12 to the power set of that of @xmath6 which is the union of the following two partial hyperoperations @xmath54 and @xmath55 ( _ i.e. _ @xmath119 for any element @xmath120 of @xmath12 ) , which guarantee totality and surjectivity , respectively .    *",
    "( * totality * ) @xmath121 * ( * surjectivity * ) @xmath122 .",
    "it remains to show that @xmath57 is preserving .",
    "this follows from @xmath123 .",
    "let @xmath31 be a @xmath22-ary relational symbol such that @xmath124 holds in @xmath12 .",
    "let @xmath125 .",
    "we will show that @xmath126 holds in @xmath6 .",
    "assume for clarity of the exposition and w.l.o.g .",
    "that from @xmath127 to @xmath128 the image is set according to @xmath54 and from @xmath129 to @xmath130 according to @xmath55 : i.e. for @xmath131 , @xmath132 and for @xmath133 , there is some @xmath134 such that @xmath135 and @xmath136 .",
    "by definition of @xmath137 the atom @xmath138 appears in @xmath139 .",
    "it follows from @xmath123 that @xmath126 holds in @xmath6 .",
    "[ theo : containment : mylogic ] let @xmath12 and @xmath6 be two structures .",
    "the following are equivalent .    for every sentence @xmath11 in @xmath28 , if @xmath49 then @xmath50 .",
    "the exists a surjective hypermorphism from @xmath12 to @xmath6 .    @xmath140    where @xmath141 is a canonical sentence of @xmath28 that is defined in terms of @xmath12 and @xmath142 and that is modelled by @xmath12 by construction .",
    "by construction @xmath143 , so ( i ) implies ( iii ) . by lemma  [ lemma :",
    "strategy : transfert : mylogic ] , ( ii ) implies ( i ) . by lemma  [ lemma :",
    "canonical : sentence : mylogic ] , ( iii ) implies ( i ) .",
    "let @xmath26 and @xmath27 be two subsets of @xmath30 and a surjective hypermorphism @xmath54 from @xmath12 to @xmath12 that satisfies @xmath144 and @xmath145 .",
    "let @xmath6 be the substructure of @xmath12 induced by @xmath146",
    ". then @xmath57 and @xmath55 , the range and domain restriction of @xmath54 to @xmath58 , respectively , are surjective hypermorphisms between @xmath12 and @xmath6 witnessing that @xmath12 and @xmath6 satisfy the same sentence of @xmath28 .",
    "note that in particular @xmath54 induces a retraction of @xmath12 to a subset of @xmath27 ; and , dually a retraction of the complement structure   of @xmath6 to a subset of @xmath26 .",
    "additional minimality conditions on @xmath26 , @xmath27 and @xmath147 ensure that @xmath6 is minimal .",
    "it is also _",
    "unique _ up to isomorphism and within @xmath6 the set @xmath26 and @xmath27 are _ uniquely determined_. consequently , @xmath6 is called * the * @xmath26-@xmath27-core of @xmath12 ( for further details see  @xcite ) and may be defined as follows .",
    "* the * @xmath26-@xmath27__core _ _ @xmath6 of a structure @xmath12 is a minimal substructure of @xmath12 such that for every sentence @xmath11 in @xmath28 , @xmath49 if and only if @xmath50 .",
    "the map @xmath148 is a surjective hypermorphism from @xmath92 to @xmath92 with @xmath149 and @xmath150 .",
    "the substructure induced by @xmath151 is @xmath93 .",
    "it can be checked that it is minimal .",
    "the @xmath26-@xmath27-core is just like the core an induced substructure .",
    "there is one important difference in that @xmath26-@xmath27-cores should be genuinely viewed as a minimal equivalent substructure induced by _ two _ sets . indeed ,",
    "when evaluating a sentence of @xmath28 , we may assume w.l.o.g .",
    "that all @xmath152 variables range over @xmath26 and all @xmath46 variables range over @xmath27 .",
    "this is because for any play of @xmath152 , we may extract a winning strategy for @xmath46 that can even restrict herself to play only on @xmath27  ( * ? ? ?",
    "* lemma 5 ) . hence , as a _ preprocessing step _ , one could compute @xmath26 and @xmath27 and restrict the domain of each universal variable to @xmath26 and the domain of each universal variable to @xmath27 . _",
    "the complexity of this processing step is no longer of the same magnitude _ and is in general much lower than solving a qcsp@xmath0 .",
    "thus , even when taking into account the uniform nature of the instance in a quantified constraints solver , this preprocessing step might be exploited in practice .",
    "this could turn out to be ineffective when there are few quantifier alternation ( as in bilevel programming ) , but should be of particular interest when the quantifier alternation increases .",
    "another interesting feature is that storing a winning strategy over @xmath26 and @xmath27 together with the surjective hypermorphism @xmath54 from @xmath12 to @xmath12 , allows to recover a winning strategy even when @xmath152 plays in an unrestricted manner .",
    "this provides a _ compression mechanism _ to store certificates .",
    "in primitive positive and positive horn logic , one normally considers equalities to be permitted . from the perspective of computational complexity of csp and qcsp , this distinction is unimportant as equalities may be propagated out by substitution . in the case of positive horn and qcsp ,",
    "though , equality does allow the distinction of a trivial case that can not be recognised without it .",
    "the sentence @xmath153 is true exactly on structures of size one .",
    "the structures @xmath154 and @xmath155 , containing empty relations over one element and two elements , respectively , are therefore distinguishable in @xmath156 , but not in @xmath2 .",
    "since we disallow equalities , many results from this section apply only to _ non - trivial _ structures of size @xmath157 .",
    "note that equalities can not be substituted out from @xmath158 , thus it is substantially stronger than @xmath28 .    for @xmath2 ,",
    "the correct concept to transfer winning strategies is that of _ surjective homomorphism from a power_. recall first that the _ product _ @xmath159 of two structures @xmath12 and @xmath6 has domain @xmath160 and for a relation symbol @xmath31 , @xmath161 ; and , similarly for a constant symbol @xmath39 , @xmath162 .",
    "the _ @xmath163th power _",
    "@xmath164 of @xmath12 is @xmath165 ( @xmath163 times ) .",
    "[ lemma : strategy : transfert : qcsplogic ] let @xmath12 and @xmath6 be two structures and @xmath166 such that there is a surjective homomorphism from @xmath164 to @xmath6 .",
    "then , for every sentence @xmath11 in @xmath2 , if @xmath49 then @xmath50 .    for @xmath167 , the proof is similar to lemma  [ lemma : strategy : transfert : mylogic ] . a projection from @xmath164 to @xmath12",
    "is a surjective homomorphism .",
    "this means that for every sentence @xmath11 in @xmath2 , if @xmath168 then @xmath49 . for the converse",
    ", one can consider the `` product strategy '' which consists in projecting over each coordinate of @xmath164 and applying the strategy for @xmath12 .",
    "for further details see  ( * ? ? ?",
    "* lemma 1&2 ) .",
    "[ ex : bip ] consider an undirected bipartite graphs with at least one edge @xmath169 and @xmath16 the graph that consists of a single edge .",
    "there is a surjective homomorphism from @xmath169 to @xmath16 .",
    "note also that @xmath170 ( where @xmath171 stands for disjoint union ) which we write as @xmath172 .",
    "thus , @xmath173 ( as @xmath174 distributes over @xmath171 ) . hence , if @xmath169 has no isolated element and @xmath163 edges there is a surjective homomorphism from @xmath175 to @xmath169 .",
    "this examples provides a lower bound for @xmath163 which we can improve .",
    "[ prop : lowerbound : powerepimorphism ] for any @xmath176 , there are structures @xmath12 and @xmath6 with @xmath177 and @xmath178 such that there is only a surjective homomorphism from @xmath179 to @xmath6 provided that @xmath180 .",
    "we consider a signature that consists of a binary symbol @xmath181 together with a monadic predicate @xmath31 .",
    "consider for @xmath12 an oriented cycle with @xmath163 vertices , for which @xmath31 holds for all but one .",
    "consider for @xmath6 an oriented cycle with @xmath163 vertices , for which @xmath31 does not hold , together with a self - loop on which @xmath31 holds .",
    "the square of @xmath12 will consists of @xmath177 oriented cycles with @xmath163 vertices : one cycle will be a copy of @xmath12 , all the other will be similar but with two vertices on which @xmath31 does not hold ( this is depicted on figure  [ fig : power : cycles ] in the case @xmath182 : white vertices do not satisfy @xmath31 while black ones do ) .",
    "it is only for @xmath183 that we will get as an induced substructure of @xmath179 one copy of an oriented cycle on which @xmath31 does not hold as in @xmath6 .",
    "there is also a _ canonical @xmath2-sentence _ which turns out to be in @xmath184-form , that is with a quantifier prefix of the form @xmath185 .",
    "we consider temporarily structures with @xmath163 constants @xmath186 ; let @xmath187 in @xmath188 describe the position of these constants in a structure @xmath12 ; and , write @xmath189 for the corresponding structure with constants .",
    "we consider the canonical conjunctive query of the structure with constants @xmath190 , ( where @xmath191 denote the product ) , identifying the constants with some variables @xmath192 and using variables @xmath109 for the other elements .",
    "we turn this quantifier - free formula into a sentence by adding the prefix @xmath193 . keeping this in mind",
    ", we can also give the following direct definition , but it dilutes the intuition somewhat .    [ def : canonical : pi2:sentence ] let @xmath12 be a structure and @xmath106 .",
    "let @xmath98 be an enumeration of the elements of @xmath194 .",
    "@xmath195 } \\ldots \\land   w_m = v_{{\\ensuremath{\\mathbf{t}}},{\\ensuremath{\\mathbf{t}}}[m ] }    .\\ ] ]    observe that we may propagate the equalities out of @xmath196 to obtain an equivalent sentence : e.g. we remove @xmath197}$ ] and replace every occurrence of @xmath198}$ ] by @xmath199 .",
    "observe also that @xmath200 . indeed , assume that @xmath201 is the assignment chosen for the universal variables @xmath112 .",
    "there is a natural projection from @xmath190 to @xmath189 which is a homomorphism .",
    "this homomorphism corresponds precisely to a winning strategy for the existential variables @xmath109 .",
    "[ theo : containment : qcsplogic ] let @xmath12 and @xmath6 be two non - trivial structures .",
    "the following are equivalent .    for every sentence @xmath11 in @xmath2 , if @xmath49 then @xmath50 .",
    "there exists a surjective homomorphism from @xmath202 to @xmath6 , with @xmath203 .    @xmath204    where @xmath205 is a canonical sentence of @xmath2 with quantifier prefix @xmath206 that is defined in terms of @xmath12 and modelled by @xmath12 by construction .",
    "\\(ii ) implies ( i ) by lemma  [ lemma : strategy : transfert : qcsplogic ] .",
    "( i ) implies ( iii ) since @xmath12 models @xmath205 .",
    "( iii ) implies ( ii ) by construction of @xmath205 .",
    "we may chose for the universal variables @xmath112 an enumeration of @xmath6 .",
    "the winning strategy on @xmath6 induces a surjective homomorphism from @xmath202 ( for further details see  ( * ? ? ?",
    "* theorem 3 ) and comments on the following page ) .",
    "following our approach for the other logics , we now define a minimal representative as follows .",
    "* a * _ q - core _ @xmath6 of a structure @xmath12 is a minimal substructure of @xmath12 such that for every sentence @xmath11 in @xmath2 , @xmath49 if and only if @xmath50 .",
    "consider @xmath93 and @xmath207 from table  [ tab : different - cores ] .",
    "the map @xmath208 is a surjective homomorphism from @xmath93 to @xmath207 .",
    "the square of @xmath207 is depicted on figure  [ fig : squarea2 ] ; and , a surjective homomorphism from it to @xmath93 is depicted on figure  [ fig : surjhom : squarea2:a3 ] .",
    "thus @xmath93 and @xmath207 are equivalent w.r.t .",
    "one can also check that @xmath207 is minimal and is therefore a q - core of @xmath93 , and _ a posteriori _ of @xmath92 .",
    "the behaviour of the q - core differs from its cousins the core and the @xmath26-@xmath27-core .",
    "the q - core of a @xmath210-element structure @xmath12 is not always an induced substructure of @xmath12 .",
    "consider the signature @xmath211 involving a binary relation @xmath181 and two unary relations @xmath31 and @xmath212 .",
    "let @xmath12 and @xmath6 be structures with domain @xmath213 with the following relations .",
    "@xmath214 since @xmath6 is a substructure of @xmath12 , we have @xmath215 .",
    "conversely , the square of @xmath216 contains an edge that has no vertex in the relation @xmath31 and @xmath212 , which ensures that @xmath217 ( see figure  [ fig : qcores ] ) .",
    "observe also that no two - element structure @xmath218 , and _ a fortiori _ no two - element substructure of @xmath12 agrees with them on @xmath2 .    indeed , if a structure @xmath218 agrees on @xmath2 with @xmath6 , it agrees also on @xmath1 .",
    "thus , the core of @xmath6 is also the core of @xmath218 and must appear as an induced substructure of @xmath218 .",
    "this core is the one - element substructure of @xmath6 induced by 1 . in order to have a surjective homomorphism from a power of @xmath218 to @xmath6 ,",
    "this power must contain a non - loop , and so does @xmath218 .",
    "this non - loop must in @xmath218 be adjacent to another vertex ( this is a @xmath2-expressible property that holds in @xmath6 @xmath219 ) .",
    "the structure @xmath218 would therefore be a two element structure satisfying @xmath220 a power of @xmath218 would therefore be connected , which is not the case of @xmath6 , preventing the existence of any surjective homomorphism .",
    "we do not know whether the q - core of a structure is unique .",
    "we will explore in the following section q - cores over some special classes and show that it behaves well in these cases .",
    "a boolean structure @xmath18 has domain @xmath221 .",
    "the results of this section apply to arbitrary ( not necessarily finite ) signatures .",
    "we give the following lemma ultimately for illustrative purposes ( the gist of its proof will be reused several times ) . the _ ph - type _",
    "@xmath222 of @xmath223 is the set of all formulae @xmath224 in one free variable @xmath70 from @xmath2 such that @xmath225 ( ph stands for positive horn ) .",
    "[ lem : switch - aut ] if @xmath18 is a boolean structure such that the ph - types @xmath226 and @xmath227 in @xmath18 coincide , then @xmath18 has an automorphism swapping @xmath228 and @xmath229 .",
    "suppose there is no such automorphism , then we may assume there exists a conjunction of atoms @xmath230 , involving only variables @xmath70 and @xmath84 , such that @xmath231 but @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\theta(1,0)$ ] .",
    "now , @xmath233 iff @xmath234 , since @xmath228 and @xmath229 are of the same ph - type .",
    "if @xmath233 then @xmath235 but @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\forall x \\theta(x,1)$ ] ( contradiction ) . similarly ,",
    "if @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\theta(0,0)$ ] then @xmath236 but @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\exists x \\theta(1,x)$ ] ( contradiction ) .",
    "[ thm : boolean ] let @xmath17 and @xmath18 be boolean structures that are equivalent w.r.t .",
    "@xmath2 . then @xmath17 and @xmath18 are isomorphic .",
    "we consider the ph - types @xmath237 and @xmath238 of @xmath228 and @xmath229 in @xmath17 , respectively ( likewise with @xmath18 superscripts for @xmath18 ) .",
    "case i. @xmath239 .",
    "it follows that @xmath240 , since @xmath241 iff @xmath242 iff @xmath243 iff @xmath244 etc . in this case",
    "the function @xmath245 given by @xmath246 and @xmath247 is an isomorphism , as in the proof of lemma  [ lem : switch - aut ] .",
    "( of course , @xmath248 and @xmath249 is also an isomorphism . )",
    "@xmath237 and @xmath238 are incomparable .",
    "let @xmath250 be in @xmath237 but not in @xmath238 ; and let @xmath251 be in @xmath238 but not in @xmath237 .",
    "let @xmath252 be the witness of @xmath253 in @xmath18 ; and let @xmath254 be the witness of @xmath255 in @xmath18 .",
    "since @xmath256[l]{\\ensuremath{\\models}}/ \\ } \\exists x \\theta_0(x ) \\wedge \\theta_1(x)$ ] , @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\exists x \\theta_0(x ) \\wedge \\theta_1(x)$ ] and @xmath257 .",
    "we claim @xmath258 ( @xmath259 , @xmath260 ) is an isomorphism from @xmath17 to @xmath18 .",
    "if not , then we may assume there exists an atom ( maybe with variables identified ) @xmath230 such that @xmath261 but @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\theta(z(0),z(1))$ ] .",
    "now , @xmath262 iff @xmath263 iff @xmath264 iff @xmath265 iff @xmath266 . the proof is completed as in that of lemma  [ lem : switch - aut ] .",
    "@xmath267 but @xmath268 . let @xmath251 be in @xmath238 but not in @xmath237 .",
    "let @xmath254 be the witness of @xmath255 in @xmath18 .",
    "@xmath254 is unique since @xmath232[l]{\\ensuremath{\\models}}/ \\ }",
    "\\forall x \\theta_1(x)$ ] .",
    "let @xmath252 be the other element of @xmath18 .",
    "we claim @xmath258 is an isomorphism from @xmath17 to @xmath18 .",
    "if not , then there exists a conjunction of atoms @xmath230 such that ( we lose the ) either @xmath261 but @xmath232[l]{\\ensuremath{\\models}}/ \\ } \\theta(z(0),z(1))$ ] , or @xmath231 but @xmath256[l]{\\ensuremath{\\models}}/ \\ } \\theta(z(0),z(1))$ ] .",
    "in fact , we can still deal with both cases at once , since @xmath269 iff @xmath270 iff @xmath271 and @xmath234 .",
    "the proof concludes as in lemma  [ lem : switch - aut ] .    in the extended logic @xmath156",
    ", it follows that every structure of size at most @xmath272 satisfies the ideal of core .",
    "for @xmath2 we can only say the following .",
    "every boolean structure @xmath18 is either a q - core , or its q - core is the substructure induced by either of its elements . in particular , * the * q - core of @xmath18 is unique up to isomorphism and is an induced substructure of @xmath18 .",
    "if @xmath18 generates the same qcsp as a one - element structure @xmath17 with domain @xmath273 , then it is clear that the ph - types @xmath274 , @xmath275 and @xmath237 coincide .",
    "this gives uniqueness and induced substructure in this case .",
    "otherwise , the only possibility  to violate the statement  is for @xmath18 to have as q - core a non - induced substructure .",
    "but this is impossible by theorem  [ thm : boolean ] .",
    "lemma  [ lem : switch - aut ] does not extend to structures of size three .",
    "there exists @xmath276 of size three such that every element of @xmath276 has the same ph - type and yet @xmath276 has no non - trivial automorphism ( @xmath277 and @xmath278 ) .",
    "however , @xmath276 is not a q - core .",
    "let @xmath29 be a fixed relational signature that consists of @xmath279 unary relation symbols @xmath280 .",
    "a structure over such a signature is deemed _",
    "unary_.    let @xmath281 be a string of length @xmath279 over the alphabet @xmath282 .",
    "we write @xmath283 as an abbreviation for the quantifier - free formula @xmath284=1 } m_i(x)$ ] .",
    "each element @xmath59 of a unary structure @xmath12 corresponds to a word @xmath281 , which is the largest word bitwise such that @xmath285 .",
    "let @xmath286 be the bitwise @xmath287 of the words associated to each element .",
    "the unary structure @xmath12 satisfies the _ canonical universal sentence _ @xmath288 ( note that @xmath286 is also the largest word bitwise among such satisfied universal formulae ) .",
    "the q - core of a unary structure @xmath12 is the unique substructure of @xmath12 defined as follows .",
    "the q - core of @xmath12 is the core @xmath289 of @xmath12 if they share the same canonical universal sentence and the disjoint union of @xmath289 with a single element corresponding to @xmath286 where @xmath288 is the canonical universal sentence of @xmath12 .",
    "a positive horn sentence over a unary signature is logically equivalent to a conjunction of formulae that do not share any variables .",
    "each conjunct is either a universal formulae of the form @xmath290 or an existential formulae of the form @xmath291 .",
    "the core @xmath289 is a substructure of the q - core , so we need only enforce that the q - core and @xmath289 satisfy the same canonical universal sentence .",
    "this is achieved with the optional addition of an element corresponding to @xmath286 where @xmath292 is the canonical universal sentence of @xmath12 .",
    "we say that a ph - sentence is a _ proper ph - sentence _ ,",
    "if it has at least one universally quantified variable @xmath293 that occurs in some atom in the quantifier - free part .",
    "generally , we will say that a sentence is _ proper _ if any variable @xmath293 occurs in some atom and we will be always working with such sentences unless otherwise stated ( otherwise , we would simply discard @xmath293 and consider the equivalent sentence with one less variable ) .",
    "we will say that a proper ph - sentence @xmath74 induced from a proper ph - sentence @xmath13 by the removal of some conjuncts is a _ proper subsentence _ of @xmath74 .",
    "let @xmath29 be a signature that consists of finitely many relation symbols @xmath294 of respective arity @xmath295 .",
    "we will consider the set of minimal proper ph - sentences w.r.t .",
    "@xmath29 , that is all formulae of the form @xmath296 where the tuple @xmath297 is a permutation of the variables @xmath298 where @xmath293 has been transposed with some other variable .",
    "there are @xmath299 such formulae .",
    "let @xmath12 be a @xmath29-structure .",
    "the following are equivalent .    1",
    ".   @xmath12 does not satisfy any proper ph - sentence .",
    "2 .   @xmath12 does not satisfy any of the @xmath300 minimal proper ph - sentences w.r.t .",
    "3 .   @xmath301 contains an isolated element .",
    "the first point implies trivially the second .",
    "we show the converse .",
    "note that any proper ph - sentence @xmath13 contains as a proper subinstance a sentence of the form @xmath302 , where the @xmath303 represent some arbitrary quantifiers . by assumption , the structure @xmath12 models @xmath304",
    "thus , it follows that @xmath12 models the weaker sentence @xmath305 @xmath306 ( the same strategy for selecting a witness for @xmath307 will work ) and the even weaker sentence where some universal quantifiers are turned to existential ones , namely those for which @xmath308 is universal ( the strategy for these new existential variable can be chosen arbitrarily ) .",
    "so , @xmath12 does not model the negation of this last sentence which is @xmath309 , which is a subinstance of @xmath13 . by monotonicity , @xmath12 does not model",
    "@xmath13 either .",
    "we now prove that the second point implies the third .",
    "let @xmath310 be the @xmath311th minimal proper ph - sentence w.r.t .",
    "@xmath29 . let @xmath120 be a witness for the unique existential variable of @xmath312 that @xmath12 does not satisfy @xmath310 .",
    "it is a simple exercise to check that @xmath313 is an isolated element of @xmath301 .",
    "conversely , if @xmath314 is an isolated element of @xmath301 then @xmath315 is a witness that @xmath301 does not satisfy any minimal proper ph - sentence @xmath310 .",
    "consequently , there exists some @xmath316 witnessing that @xmath12 does not satisfy @xmath310 and we are done .    in the case of directed graphs ,",
    "the minimal proper ph - sentences are @xmath317 and @xmath318 .",
    "a directed graph which does not satisfy them will satisfy their negation @xmath319 and @xmath320 . a witness for",
    "the existential @xmath293 in the first sentence will be a _ source _ , and in the second sentence a _ sink _ , respectively    so a directed graph has a source and a sink if , and only if , it does not satisfy any proper ph - sentence , if and only if , its square has an isolated element .",
    "* the * q - core of a structure @xmath12 that does not satisfy any proper ph - sentence is the unique substructure of @xmath12 may be found as follows .",
    "the q - core of @xmath12 is the core @xmath289 of @xmath12 , if @xmath321 contains an isolated element , and the disjoint union of @xmath289 and an isolated element , otherwise .    by assumption @xmath12",
    "does not satisfy any proper ph - sentence .",
    "consequently a minimal structure @xmath289 ( both w.r.t . domain size and number of tuples ) which satisfies the same ph - sentences as @xmath12 will satisfy the same pp - sentences as @xmath12 and none of the proper ph - sentences either .",
    "it follows that @xmath289 must contain the core of @xmath12 ( and can be no smaller ) . if this core satisfies no proper ph - sentence then we are done and by the previous theorem @xmath301 has an isolated element .",
    "otherwise , we must look for a structure that contains the core of @xmath12 and does not satisfy any proper universal sentence . adding tuples to @xmath12",
    "can clearly not force this property by monotonicity of qcsp .",
    "thus , the minimal ( and unique ) such structure will be obtained by the addition of an isolated element .",
    "note that in this second case we have also a substructure of @xmath12 .",
    "it follows that checking whether a structure with an isolated element is a q - core is of the same complexity as checking whether it is a core .",
    "recall that the latter is known to be a co - np - complete decision problem ( the induced sub - structure that ought to be a core is given via an additional monadic predicate @xmath322 ) , see @xcite .",
    "we show that the former is also co - np - complete ( we also assume a monadic predicate as in this particular case the q - core is an induced substructure ) , by showing inter - reducibility of both problem .    ( hardness ) let @xmath323 be the input to the core problem ( we assume that it is not trivial and that @xmath322 does not contain any isolated element ) .",
    "if @xmath301 has an isolated element ( it can be done in polynomial time as @xmath300 does not depend on @xmath324 ) then we reduce to @xmath325 , and to @xmath326 otherwise , where @xmath327 consists of the disjoint union of @xmath12 with an isolated element and @xmath328 is the union of @xmath322 with this new element .",
    "( co - np - complete algorithm ) let @xmath329 be the input to the q - core problem such that @xmath327 has an isolated element .",
    "we check whether the alleged q - core ( the substructure of @xmath327 induced by @xmath330 ) elevated to the @xmath22th power has an isolated element .",
    "if it does not we answer no . if the alleged q - core has more than one isolated element we answer also no .",
    "otherwise , we remove at most one isolated element from @xmath328 to derive @xmath331 and reduce to the core question w.r.t . @xmath332 .",
    "graphs are relational structures with a single symmetric relation @xmath181 .",
    "we term them _ partially reflexive _",
    "to emphasise that any vertex may or may not have a self - loop .",
    "tree _ may contain self - loops but no larger cycle @xmath333 for @xmath334 .",
    "pseudotree _ contains at most one cycle @xmath333 for @xmath334 .",
    "( resp . , _ pseudoforest _ ) is the disjoint union of p.r .",
    "trees ( resp . ,",
    "pseudotrees ) .    since forests ( resp . , pseudoforests )",
    "are closed under substructures , we can be assured that a q - core of a forest ( resp . ,",
    "pseudoforest ) is a forest ( resp . ,",
    "pseudoforest ) .",
    "it is clear from inspection that the q - core of forest ( resp . , pseudoforest , cycle ) is unique up to isomorphism , but we do not prove this as it does not shed any light on the general situation .",
    "the doubting reader may substitute `` a/ all '' for `` the '' in future references to q - cores in this section .",
    "the complexity classifications of  @xcite were largely derived using the properties of equivalence w.r.t .",
    "@xmath2 . this will be the central justification for the following propositions .",
    "let @xmath335 and @xmath336 be the reflexive and irreflexive @xmath311-cliques , respectively .",
    "let @xmath337:=\\{1,\\ldots , n\\}$ ] . for",
    "@xmath338 $ ] and @xmath339 , let @xmath340 $ ] be the @xmath311th entry of @xmath341 .",
    "for @xmath342 , let @xmath343 be the path with domain @xmath337 $ ] and edge set @xmath344=1 \\}$ ] for a tree @xmath345 and vertex @xmath346 , let @xmath347 be the shortest distance in @xmath345 from @xmath348 to a looped vertex ( if @xmath345 is irreflexive , then @xmath347 is always infinite ) .",
    "let @xmath349 be the maximum of @xmath350 .",
    "a tree is _ loop - connected _ if the self - loops induce a connected subtree .",
    "a tree @xmath345 is _ quasi - loop - connected _ if either 1 . )",
    "it is irreflexive , or 2 . )",
    "there exists a connected reflexive subtree @xmath351 ( chosen to be * maximal * ) such that there is a walk of length @xmath349 from every vertex of @xmath345 to @xmath352 .",
    "it is not true that , if @xmath353 is a forest , then either @xmath353 admits a majority polymorphism , and qcsp@xmath354 is in nl , or qcsp@xmath354 is np - hard .",
    "however , the notion of q - core restores a clean delineation .",
    "let @xmath353 be a forest .",
    "then either the q - core of @xmath353 admits a majority polymorphism , and qcsp@xmath354 is in nl , or qcsp@xmath354 is np - hard .",
    "we assume that graphs have at least one edge ( otherwise the q - core is @xmath355 ) .",
    "irreflexive forests are a special case of bipartite graphs , which are all equivalent w.r.t .",
    "@xmath2 , their q - core being @xmath16 when they have no isolated vertex ( see example  [ ex : bip ] ) and @xmath356 otherwise .    we assume from now on that graphs have at least one edge and one self - loop .",
    "the one vertex case is @xmath357 .",
    "we assume larger graphs from now on .",
    "if the graph contains an isolated element then its q - core is @xmath358 .",
    "assume from now on that the graph does not have an isolated element .",
    "we deal with the disconnected case first .",
    "if the graph is reflexive , then its q - core is @xmath359 .",
    "otherwise , the graph is properly partially reflexive in the sense that it embeds both @xmath360 and @xmath355 .",
    "if the graph has an irreflexive component then its q - core is @xmath361 .",
    "if the graph has no irreflexive component , then its q - core is @xmath362 where @xmath363 is the longest walk from any vertex to a self - loop . to see this last case gives an equivalent qcsp",
    ", we may consider power surjective homomorphisms , together with the fact that the q - core must not satisfy @xmath364 .",
    "we now follow the classification of @xcite .",
    "if a forest contains more than one tree , then the q - core is among those formed from the disjoint union of exactly two ( including the possibility of duplication ) of @xmath355 , @xmath365 , @xmath366 , @xmath16 .",
    "each of these singularly admits a majority polymorphism , therefore so does any of their disjoint unions .",
    "we now move on to the connected case , it remains to consider trees @xmath367 .",
    "if @xmath367 is irreflexive , then its q - core is @xmath16 or @xmath355 , which admit majority polymorphisms .",
    "if @xmath367 is loop - connected , then it admits a majority polymorphism @xcite .",
    "if @xmath367 is quasi - loop - connected , then it is qcsp - equivalent to one of its subtrees that is loop - connected @xcite which will be its q - core . in all other cases qcsp@xmath368 is np - hard , and @xmath367 does not admit majority @xcite .",
    "a _ pseudotree _ is a graph that involves at most one cycle .",
    "a _ pseudoforest _ is the disjoint union of a collection of pseudotrees .",
    "let @xmath353 be an irreflexive pseudoforest .",
    "then either the q - core of @xmath353 admits a majority polymorphism , and qcsp@xmath354 is in nl , or qcsp@xmath354 is np - hard .",
    "we follow the classification of @xcite . if @xmath353 is bipartite , then its q - core is either @xmath16 , @xmath355 , @xmath356 ( see @xcite ) and this admits a majority polymorphism . otherwise its q - core contains an odd cycle , which does not admit a majority polymorphism , and qcsp@xmath354 is np - hard .",
    "we may use theorem  [ theo : containment : mylogic ] to provides a first algorithm ( algorithm  [ algo : naiveqcore ] ) .",
    "this does not appear very promising if we wish to use q - cores as a preprocessing step .",
    "we will propose and illustrate a general and less naive method to compute q - cores by computing @xmath26-@xmath27-core and cores first .",
    "another nice feature of cores and @xmath26-@xmath27-cores which implies their uniqueness is the following : any substructure @xmath218 of @xmath12 that agrees with it on @xmath1 ( respectively on @xmath28 ) will contain the core ( respectively the @xmath26-@xmath27-core ) .",
    "consequently , the core and the @xmath26-@xmath27-core may be computed in a _",
    "greedy fashion_. assuming that the q - core would not satisfy this nice property , why should this concern the q - core ?",
    "well , we know that * any * q - core will lie somewhere between the @xmath26-@xmath27-core and the core that are induced substructures : this is a direct consequence of the inclusion of the corresponding fragments of first - order logic and their uniqueness .",
    "moreover , according to our current knowledge , checking for equivalence appears , at least on paper , much easier for @xmath28 than @xmath2 : compare the number of functions from @xmath30 to the power set of @xmath58 ( @xmath369 ) with the number of functions from @xmath370 to @xmath58 ( @xmath371 ) where @xmath22 could be as large as @xmath372 and can certainly be greater than @xmath373 ( see proposition  [ prop : lowerbound : powerepimorphism ] ) .",
    "so it make sense to bound the naive search for q - cores .",
    "furthermore , we know that the @xmath26-@xmath27-core can be identified by specific surjective hypermorphisms that act as the identity on @xmath27 and contain the identity on @xmath26  @xcite which makes the search for the @xmath26-@xmath27-core somewhat easier than its definition suggest ( see algorithm  [ algo : uxcore ] ) .",
    "observe also that @xmath27 must contain the core @xmath218 of the @xmath26-@xmath27-core @xmath6 , which is also the core of the original structure @xmath12 ( this is because @xmath54 induces a so - called retraction of @xmath12 to the substructure @xmath374 induced by @xmath27 ) .",
    "thus we may compute the core greedily from @xmath27 .",
    "next , we do a little bit better than using our naive algorithm , by interleaving steps where we find a substructure that is @xmath2-equivalent , with steps where we compute its @xmath26-@xmath27-core ( one can find a sequence of distinct substructures @xmath6 , @xmath375 and @xmath376 such that @xmath6 is a @xmath26-@xmath27-core , which is @xmath2-equivalent to @xmath375 , whose @xmath26-@xmath27-core @xmath376 is strictly smaller than @xmath6 , see example  [ example : interleaving : uxcore : qretract ] ) . algorithm  [ algo : boundedsearchqcore ] describes this proposed method informally when we want to compute * one * q - core ( of course , we would have no guarantee that we get the smallest q - core , unless the q - core can be also greedily computed , which holds for all cases we have studied so far ) .    in algorithm  [ algo :",
    "boundedsearchqcore ] , we have purposely not detailed line  [ algo : line : q - retractioncheck ] .",
    "we could use the characterisation of @xmath2-containment via surjective homomorphism from a power of theorem  [ theo : containment : qcsplogic ] as in algorithm  [ algo : naiveqcore ] .",
    "alternatively , we can use a refined form of ( iii ) in this theorem and use the canonical sentences in @xmath184-form @xmath377 and @xmath378 , with @xmath379 and @xmath380 ( see definition  [ def : canonical : pi2:sentence ] ) .",
    "the test would consists in checking that @xmath6 satisfies @xmath378 ( where we may relativise to universal variables to @xmath381 and existential variables to @xmath27 ) and @xmath375 satisfies @xmath377 .",
    "this is correct because we know that we may relativise every universal variable to @xmath26 within @xmath6 .",
    "thus , it suffices to consider @xmath184-sentences with at most @xmath382 universal variables .",
    "[ example : interleaving : uxcore : qretract ] we describe a run of algorithm  [ algo : boundedsearchqcore ] on input @xmath383 . during the initialisation , we compute its @xmath26-@xmath27-core @xmath384 and discover that @xmath149 and @xmath385 .",
    "we compute @xmath386 , the core of the substructure induced by @xmath27 .",
    "note that @xmath387 is isomorphic to @xmath388 .",
    "next the algorithm guesses a substructure @xmath375 of @xmath6 that contains @xmath218 : _",
    "e.g. _ it drops the self - loop around vertex @xmath210 to obtain a structure isomorphic to @xmath389 and checks successfully equivalence w.r.t .",
    "@xmath2 ( there is a surjective homomorphism from @xmath389 to @xmath388 ; and , conversely we can use the surjective homomorphism from @xmath390 to @xmath391 composed with that from the former to @xmath389 ) .    next",
    "the algorithm computes the @xmath392-@xmath393-core @xmath376 of @xmath375 which is @xmath207 ( witnessed by @xmath394 , @xmath395 , @xmath396 ) and sets @xmath397 .",
    "the algorithm stops eventually and outputs @xmath207 as it is minimal .",
    "we have introduced a notion of q - core and demonstrated that it does not enjoy all of the properties of cores and @xmath26-@xmath27-core . in particular , there need not be a unique minimal element size in the equivalence class of structures agreeing on ph - sentences",
    ". however , we suspect that the notion of q - core we give is robust , in that the q - core of any structure @xmath18 is unique up to isomorphism ; and , that it sits inside any substructure of @xmath6 that satisfies the same sentence of @xmath2 , making it computable in a greedy fashion . thus , the nice behaviour of q - cores is almost restored , but `` induced substructure '' in the properties of core or @xmath26-@xmath27-core must be replaced by the weaker `` substructure '' .",
    "generalising the results about q - cores of structures with an isolated element to disconnected structures is already difficult .",
    "just as the ph - theory of structures with an isolated element is essentially determined by their pp - theory , so the ph - theory of disconnected structures is essentially determined by its @xmath398 fragment ( see @xcite ) ."
  ],
  "abstract_text": [
    "<S> the constraint satisfaction problem ( csp ) and its quantified extensions , whether without ( qcsp ) or with disjunction ( qcsp@xmath0 ) , correspond naturally to the model checking problem for three increasingly stronger fragments of positive first - order logic . </S>",
    "<S> their complexity is often studied when parameterised by a fixed model , the so - called template . </S>",
    "<S> it is a natural question to ask when two templates are equivalent , or more generally when one `` contain '' another , in the sense that a satisfied instance of the first will be necessarily satisfied in the second . </S>",
    "<S> one can also ask for a smallest possible equivalent template : this is known as the core for csp . </S>",
    "<S> we recall and extend previous results on containment , equivalence and `` coreness '' for qcsp@xmath0 before initiating a preliminary study of cores for qcsp which we characterise for certain structures and which turns out to be more elusive . </S>"
  ]
}