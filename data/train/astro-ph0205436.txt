{
  "article_text": [
    "there is now a wealth of data from cosmic microwave background ( cmb ) observations and growing amount of information on large scale structure from a wide range of sources .",
    "we would like to extract the maximum amount of information from this data , usually conveniently summarized by estimates of a set of cosmological parameter values . with high quality data one can constrain a large number of parameters , which in principle allows us not only to put estimates and error bars on various quantitative parameters , but also to address more fundamental qualitative questions :",
    "do we observe primordial gravitational waves ?",
    "do the neutrinos have a cosmologically significant mass ?",
    "is the universe flat ?",
    "are the standard model parameters those that best account for the data ?",
    "in addition we can also assess the consistency of the different data sets with respect to a cosmological model .",
    "recent work involving parameter estimation from the cmb includes refs .",
    "@xcite . in this paper",
    "we employ markov chain monte carlo ( mcmc ) techniques  @xcite , as advocated for bayesian cmb analysis in ref .",
    "@xcite and demonstrated by refs .",
    "@xcite . by generating a set of mcmc chains",
    "we can obtain a set of independent samples from the posterior distribution of the parameters given the data . from a relatively small number of these samples one can estimate the marginalized posterior distributions of the parameters , as well as various other statistical quantities .",
    "the great advantage of the mcmc method is that it scales , at its best , approximately linearly with the number of parameters , allowing us to include many parameters for only small additional computational cost .",
    "the samples also probe the shape of the full posterior , giving far more information that just the marginalized distributions .    throughout",
    "we assume models with purely adiabatic gaussian primordial perturbations in the growing mode ( our approach could easily be generalized to include isocurvature modes ) , three neutrino species , non - interacting cold dark matter , and standard general relativity .",
    "we compute all theoretical ( cmb and matter power spectrum ) predictions numerically using using the fast boltzmann code camb  @xcite ( a parallelized version of cmbfast  @xcite ) .",
    "our results are therefore limited by the accuracy of the data and could be generalized very easily to include any additional parameters that can be accounted for by modification of a boltzmann code .    in section  [ cmbonly ]",
    "we present constraints from the latest cmb data , illustrating the mcmc method .",
    "we defer a brief introduction to the mcmc method and a description of our implementation and terminology to appendix  [ mcmc ] .",
    "the method of importance sampling is also illustrated in section  [ cmbonly ] , and is described in detail appendix  [ importance ] , where we explain how it can be used to take into account different priors on the parameters , new data , and for accurate but fast estimation given a good approximation to the theoretical model predictions .",
    "we add large scale structure , supernova and nucleosynthesis constraints in section  [ alldata ] so that more parameters can be constrained .",
    "we compare flat models with ` inflationary ' priors ( 9 cosmological parameters ) and then a more general models ( 11 cosmological parameters ) .",
    "this includes constraints on the neutrino mass , equation of state of the dark energy , and the tensor amplitude .",
    "in addition our results show the sensitivity of constraints on the standard parameters to variations in the underlying model .",
    "we use the results of the cobe  @xcite , boomerang  @xcite , maxima  @xcite , dasi  @xcite , vsa  @xcite and cbi  @xcite observations in the form of band power estimates for the temperature cmb power spectrum .",
    "these data are plotted in fig .",
    "[ cmbdata ] .",
    "the very small angular scale results from cbi have been discussed extensively in  @xcite and do not fit the linear predictions of standard acoustic oscillation models .",
    "therefore for the purposes of this paper we assume that the small scale power observed by cbi has its origin in non - linear or non - standard small scale effects that we do not attempt to model , and so use only the mosaic ( rather than deep pointing ) data points throughout .",
    "in addition we use only the first 8 points ( @xmath2 ) from the odd binning of the mosaic fields since above that the noise in the band powers becomes much larger than the prediction for the class of models we consider .    for cobe we use the offset - lognormal band - powers and covariance matrix from radpack  @xcite . for dasi ,",
    "vsa and cbi we also use the offset - lognormal band powers and integrate numerically over an assumed gaussian calibration uncertainty . for boomerang , maxima",
    "we assume top hat window functions and uncorrelated gaussian band - power likelihood distributions , and marginalize analytically over the calibration and beam uncertainties assuming they are also gaussian  @xcite . we assume a correlated calibration uncertainty of @xmath3 on the cbi and vsa data ( neglecting the @xmath4 uncorrelated difference in calibration ) , but otherwise assume all the observations are independent . using the sets of samples",
    "obtained it is a simple matter to account for small corrections when the required information is publicly available ( see appendix  [ importance ] ) .",
    "the base set of cosmological parameters we sample over are @xmath5 and @xmath6 , the physical baryon and cdm densities relative to the critical density , @xmath7 , the hubble parameter , @xmath8 measuring the spatial curvature , @xmath9 , the redshift at which the reionization fraction is a half , @xmath10 , measuring the initial power spectrum amplitude and @xmath11 , the spectral index of the initial power spectrum .",
    "we derive @xmath12 , the ratio of the critical density in the form of dark energy , from the constraint @xmath13 ( where @xmath14 is the total matter density in units of the critical density ) . throughout",
    "we use at least the priors that @xmath15 , @xmath16 , @xmath17 , @xmath18 , and that the age of the universe , @xmath19 , is @xmath20 .",
    "the significance of this base set is that this defines the bayesian priors : there is a flat prior on each parameter of the base set .",
    "we discuss later how we assess the significance of these priors , and highlight our main results , which are largely independent of the priors .",
    "( we choose @xmath21 as a base parameter since the hst key project provides a direct constraint on this quantity , whereas there are no direct constraints on , e.g. @xmath12 ; see appendix  [ constraints ] for discussion ) .",
    "the above additional constraints on @xmath21 , @xmath12 , @xmath22 and the age have little effect on the joint results since the cut - off values are well into the tails of the distribution .",
    "however for the purpose of the monte - carlo it is very convenient to be able to quickly reject models in the extreme tails without having to compute the theoretical predictions .      [ cols=\"^,^ \" , ]     an mcmc sampler provides an efficient way to generate a list of samples from a probability distribution ( see appendix  [ mcmc ] for an explanation ) .",
    "all that is required is a function for calculating the probability given a set of parameter values .",
    "a single sample is a coordinate in the n - d parameter space , and the sampling method ensures that the number density of samples is asymptotically proportional to the probability density . as an illustration , in the left hand panel of figure  [ cmbonly ] we show the values of @xmath23 , and @xmath12 , for samples collected from an mcmc run using the cmb data and base parameters discussed in the previous paragraphs .",
    "note that although @xmath24 is not one of our base set of parameters , it is simple to find probabilities as a function of @xmath24 by taking the parameter values of each sample and deriving the corresponding values of @xmath24 .",
    "since the mcmc method produces samples from the full posterior , it follows that the number density of samples in this two - dimensional plane is proportional to the probability density of the two parameters ( marginalized over all the other parameters ; note that this refers to the fully marginalized probability density rather than any conditional or projected probability density ) .",
    "the familiar direction of cmb degeneracy along the flat universe line is apparent .",
    "the colors of the dots indicate the hubble constant value for each sample , as given in the color bar .",
    "this shows that the high @xmath24 tail of samples are due entirely to low @xmath21 regions of parameter space , illustrating the point made in e.g.  @xcite that a hubble constant prior alone combined with the cmb can put useful limits on @xmath24 and @xmath12 without the need for supernova constraints .",
    "the likelihood as a function of position in the @xmath24-@xmath12 plane from cmb data alone is shown by the red contours in the right hand panel of figure  [ cmbonly ] .",
    "note that compared to some other cmb only plots the contours close slightly at high @xmath24 , which is due to our lower limit on the hubble constant of @xmath25 .",
    "the 2-d likelihoods shown are calculated from the samples by estimating the probability density at a grid of points using a gaussian weighting kernel and then using interpolation to draw the contour lines .",
    "this produces a plot very similar to that obtained using a grid integration calculation of the marginalized posterior ( assuming there are no small scale features in the posterior ) .",
    "extra data can be taken into account quickly by re - weighting the samples , a technique known as _ importance sampling _",
    "( described in detail in appendix  [ importance ] ) .",
    "the posterior is simply re - calculated at each sample position , and a weight assigned to the sample according to the ratio of the new posterior to the old posterior .",
    "for example , using a gaussian hst key project  @xcite prior on the hubble constant @xmath26 we obtain the blue contours plotted on the right hand panel of figure  [ cmbonly ] . by using the weighted number of points as a function of @xmath22 we find the marginalized result @xmath27 , and",
    "therefore that the universe is close to flat ( given our assumptions ) .",
    "using importance sampling we have checked that the cmb datasets are consistent using the hyperparameter method , as described in appendix  [ consistency ] .",
    "above we illustrated the mcmc method in the @xmath24-@xmath12 plane for a 7 parameter cosmological model . since there is good observational evidence and theoretical motivation for flat models , we now fix @xmath28 giving 6 base parameters .",
    "the only parameters that can be reasonably disentangled are @xmath29 and @xmath11 , from the heights of the 2nd and 3rd acoustic peaks relative to the first .",
    "these constraints are given in the first two rows of table  [ cmbflatpars ] and are in accordance with previous similar analyses and nucleosynthesis constraints  @xcite .",
    "however note that these two parameters remain significantly correlated , so that more detailed information is contained in the result @xmath30 , @xmath31 .",
    "qualitatively , having ` used up ' constraints from the 2nd and 3rd acoustic peak heights to find @xmath32 and @xmath11 we might estimate that there remain three more pieces of information in the cmb data , from the large scale ( cobe ) amplitude , the first peak height and the first peak position .",
    "we have four remaining parameters e.g. parameterised by @xmath0 , @xmath24 , @xmath21 and @xmath33 ( @xmath33 is the optical depth to reionization using @xmath34 $ ] , where @xmath35 is the number density of electrons and @xmath36 is the thompson scattering cross - section . for flat models with cosmological constant @xmath37 ( to a few percent over the region of interest ) , though we do not use this in our analysis . ] , and @xmath0 is the root mean square mass perturbation in @xmath38 spheres today assuming linear evolution ) .",
    "since @xmath32 and @xmath11 are not too correlated with these parameters , we marginalize over them and explore the remaining four dimensional parameter space .    from the set of samples it is straightforward to perform an independent component analysis to identify the well determined orthogonal parameter combinations . calculating the eigenvectors of the correlation matrix in the logs of @xmath39 , @xmath24 and @xmath21 we find the two combinations given in the bottom two rows of table  [ cmbflatpars ] .",
    "the errors are too large on any third constraint to be worth quoting .",
    "we expect @xmath0 to be roughly degenerate with @xmath40 because the cmb power on scales smaller than the horizon size at reionization ( @xmath41 ) is damped by a factor @xmath42 , and @xmath43 scales with the power in the primordial perturbation .",
    "we find that marginalized values of @xmath44 and @xmath45 are independent of @xmath33 to better than 2 per cent for @xmath46 ( @xmath47 ) .",
    "as demonstrated in appendix  [ constraints ] these constraints are almost independent of the choice of base parameters ( which define the prior ) .",
    "if we marginalize over @xmath0 and @xmath9 we find the principle component @xmath48 , consistent with the constraint found and discussed in ref .",
    "however since this quantity is significantly correlated with the amplitude we have quoted a tighter constraint ( @xmath49 ) in table  [ cmbflatpars ] by including the @xmath39 dependence in our results .",
    "is unity . ]    while restricted to this relatively small parameter space we take this opportunity to investigate the impact of the new vsa and cbi results . using importance sampling we compare the results with and without the vsa / cbi data in table  [ cmbflatpars ] . for simplicity",
    "we assume the same power law approximation for the combination of @xmath39 , @xmath21 and @xmath24 as derived above .",
    "the peaks move by a fraction of the error , and the error bars are fractionally smaller .",
    "the cmb data alone can only provide a limited number of constraints , so before extending the parameter space to make full use of the monte - carlo method it is useful to include as much relatively reliable data as possible .",
    "care must be taken , since some published parameter constraints assume particular values for parameters that we wish to vary . as a simple example",
    ", the supernova cosmology project has made available constraints in @xmath24-@xmath12 space , which could only be used if the dark energy is a cosmological constant .",
    "fortunately the full supernova data are available , which we use ( described below ) .",
    "however is is not always practical to use the full observed data and it may be best to simply increase the error bars to encompass systematic effects due to other parameters .",
    "this ensures that the resulting mcmc chains will cover all of the relevant parameter space , and can then be importance sampled later with a tighter constraint .",
    "if the chains are generated too tightly constrained one can not recover information about the excluded parameter space .",
    "nucleosynthesis constraints suggest @xmath50  @xcite , and we assume the gaussian prior @xmath51 , ( 1@xmath52 ) which is somewhat broader than the error quoted in ref .",
    "@xcite to allow for differences with other estimations .",
    "we include type 1a supernovae data from  @xcite , using the effective magnitudes and errors from the 54 supernovae that they included in the primary fit ( fit c ) .",
    "we marginalize analytically with a flat prior on the intrinsic magnitudes , which is equivalent to evaluating the likelihood at the best fit value ( see appendix  [ marge ] ) .",
    "we neglect the small correlations but multiply the log likelihood by @xmath53 to account for the effective degrees of freedom quoted in ref .",
    "we use the galaxy power spectrum from the first 147,000 redshifts of the 2df galaxy redshift survey , using the scales @xmath54 where non - linear effects were found to be negligible  @xcite .",
    "we assume that this is directly proportional to the matter power spectrum at @xmath55 , in other words that the bias and evolution are scale independent and also that the redshift space distorted power spectrum is proportional to the real space power spectrum ( on the large scales used ) .",
    "we assume a flat prior on the proportionality constant and marginalize analytically as described in appendix  [ marge ] .",
    "we also use the hst key project prior on the hubble constant as discussed earlier .",
    "the top contours in the right hand panel of figure  [ cmbonly ] shows the effect of the full set of constraints on the basic 7 parameter model , with the combined constraint on the curvature becoming @xmath56 .",
    "for the 6 parameter flat models the extra data constrains most of the parameters rather well .",
    "table  [ cmbflatpars ] shows that the new constraints are very consistent with those from the cmb alone . the @xmath45 constraint on @xmath0 of table  [ cmbflatpars ] is slightly changed and becomes @xmath57 almost independently of @xmath24 .",
    "the marginalized results on all parameters are shown in table  [ inflationtable ] .",
    "the hubble parameter is shifted to slightly lower values relative to the hst key project constraint we used .",
    "the matter and dark energy densities are spot on the popular @xmath58 model , although with error bars of @xmath59 at 68 per cent confidence .",
    "the combination @xmath60 is slightly tighter but has the same central value as quoted in ref .  @xcite using 2df data alone and assuming @xmath61 .",
    "the @xmath0 result depends on the range used for the reionization redshift @xmath9 since the data used mostly constrains the combination @xmath39 rather than @xmath0 on its own .",
    "our prior of @xmath62 should be reasonably conservative , however we also quote the result for @xmath39 .",
    "looking at the maximum and minimum values contained in the 95 percent confidence region of the full n - dimensional space ( see appendix c ) we find @xmath63 .",
    "this may be compared to values of @xmath0 found by other independent methods and could in principle be combined with these methods to estimate the optical depth ( e.g. see ref .",
    "@xcite ) . if @xmath64 and @xmath65 then our result is very consistent with the new lower cluster normalisation found by refs .",
    "@xcite and just consistent with the cosmic shear measurements of refs .",
    "@xcite . the high clustering amplitude required to fit the small scale clustering observed by cbi of @xmath66 ( ref .",
    "@xcite ) is in the tail of the distribution and may require an optical depth rather larger than expected in simple models .",
    "by using subsets of the chains we have checked that the monte - carlo sampling noise is negligible at the accuracy quoted .",
    "the results are monte - carlo marginalized over all of the other parameters and also analytically or numerically marginalized over the calibration type uncertainties discussed in section  [ cmbonly ] .",
    "we now demonstrate the power of the monte - carlo method by using the above data to constrain a larger number of parameters , using the proposal density described in appendix  [ mcmc ] to exploit the differing computational costs of changing the various parameters .",
    "we consider separately the case of inflationary models , which are flat , and more general models less constrained by theoretical prejudice . in both cases we include @xmath67 , the fraction of the dark matter that is in the form of massive neutrinos , and allow for an effective constant equation of state parameter with @xmath68 and @xmath69 $ ] that gives a constant equation of state . ]",
    "@xmath70 for the dark energy , and assume that @xmath71 .",
    "the simplest single - field inflationary models predict a flat universe and can be described quite accurately by the slow - roll approximation .",
    "the shape and amplitude of the initial curvature perturbation depends on the shape of the inflationary potential , often encoded in ` slow - roll parameters ' which are assumed to be small , plus an overall normalization which depends on the hubble rate when the modes left the horizon during inflation .",
    "the initial scalar and tensor power spectra are parameterized as usual by and @xmath72 , where @xmath73 is the initial curvature perturbation and @xmath74 is the transverse traceless part of the metric tensor .",
    "these definitions ensure @xmath75 corresponds to scale invariant . ]",
    "@xmath76 where @xmath11 and @xmath77 are the conventional definitions of the spectral indices . at the lowest order approximation the slow - roll initial power spectra",
    "are determined from the inflationary potential @xmath78 by the slow - roll parameter parameters @xmath79 , @xmath80 by  @xcite @xmath81 \\\\ a_s & = & \\frac{h^2}{\\pi \\epsilon_1 { m_{\\text{pl}}}^2 } \\quad\\quad\\quad n_t = -2\\epsilon_1 = -\\frac{a_t}{8 a_s}\\end{aligned}\\ ] ] where quantities are evaluated when @xmath82 ( we use @xmath83 ) . for our analysis",
    "we use the parameterization of equations   and define @xmath84 .",
    "we also impose the slow - roll constraint that spectral index of the tensor modes is given by @xmath85 .",
    "our results will be consistent with inflationary models in the region of parameter space in which @xmath86 , @xmath87 , but elsewhere can be interpreted more generally ( the results are not very sensitive to the tensor spectral index ) . from the definition",
    "it is clear that @xmath88 , and except in contrived models one also expects @xmath89 , though we do not enforce this .",
    "simple ekpyrotic models are consistent with this parameterization when there are no tensor modes  @xcite .",
    "if there were evidence for tensor modes ( @xmath90 ) then this would be direct evidence against simple ekpyrotic models .",
    "figure  [ inflation1d ] shows the fully marginalized posterior constraints on the various parameters using the cmb , supernovae , hst , and nucleosynthesis constraints , with and without the 2df data , generated from 7700 weakly correlated samples .",
    "we generate samples without the 2df or cbi data , and then importance sample including cbi to compute results with and without the 2df data .",
    "the constraints on @xmath60 and @xmath91 are sharpened significantly on adding in 2df .",
    "the large shift in the @xmath0 distribution comes from the exclusion of the high @xmath67 parameter space due to the new constraint on the shape of the matter power spectrum ( see discussion of degeneracy below ) .",
    "it is important to check that the parameters are really being constrained , in the sense that the results are relatively insensitive to the priors , so in addition to the marginalized posterior we also plot the mean likelihood of the samples .",
    "these will differ in general , particularly when the result is sensitive to the parameter space volume available , which can change as the result of choosing different priors ( see appendix  [ constraints ] ) .",
    "in most of the 1-d plots the two methods are in good agreement indicating that the likelihood is well constrained in n - d space and the priors are not biasing our results .",
    "however the marginalized value of @xmath0 is brought down by the @xmath92 phase space ( since massive neutrinos damp the small scale power ) , even though the best fits to the data occur where the neutrinos are very light ( the correlation is shown in the bottom right hand panel of figure  [ inflation2d ] . ) similarly the marginalized value of @xmath11 is slightly increased by the phase space with @xmath90 ; this increases the cmb power on large scales , and hence requires a higher spectral index for the scalar modes ( bottom left panel of figure  [ inflation2d ] ) .",
    "we also show in figure  [ inflation2d ] that a small degeneracy between the hubble constant and the matter density remains ( top left ) after the @xmath93 constraint from the galaxy power spectrum shape is combined with the @xmath94 cmb constraint ( table  [ cmbflatpars ] ) .",
    "geometrical information from the cmb peak position and the snia work together to constrain @xmath95 , but this remains slightly correlated with @xmath24 ( top right ) .",
    "the results from the 6 and 9 parameter analyses can be compared using the 68 per cent limits given in table  [ inflationtable ] and the plots in figure  [ full1d ] .",
    "many of the results are quite robust to the addition of the extra three degrees of freedom .",
    "the biggest change is in @xmath39 which is brought down by contributions from non - zero @xmath91 .    as discussed in appendix  [ constraints ] , parameter confidence limits from the full n - d distribution",
    "can also easily be calculated from a list of samples .",
    "we show the marginalized and n - d parameter constraints with the inflationary assumptions in table  [ inflationtable ] .",
    "where @xmath96 ( we use @xmath97 ) .",
    "] as expected , the n - d limits are much wider than those from the marginalized distributions , most being more than twice as wide .",
    "the combined datasets provide good constraints on the neutrino mass , despite the large parameter space .",
    "the massive neutrino fraction @xmath67 translates into the neutrino mass via @xmath98 where the last equality follows from our assumption that there are three neutrinos of approximately degenerate mass , as indicated by the small mass - squared differences detected by the neutrino oscillation experiments  @xcite . at @xmath99 confidence",
    "we find the marginalized result @xmath100 and the more conservative n - d result @xmath101 .",
    "the tightness of the constraint is predominantly due to the 2df data , as shown in figure  [ inflation1d ] , via the damping effect of massive neutrinos on the shape of the small scale matter power spectrum .",
    "the result is consistent with the weaker limits found in refs .",
    "@xcite under more restricted assumptions .",
    "the marginalized result is only slightly affected by the large parameter space : computing chains with @xmath102 and @xmath103 we obtain the marginalized @xmath99 confidence result @xmath104 ( the n - d limit is much less sensitive to the parameter space , and the result does not change significantly ) . thus the simplest model where all the neutrino masses are very small is still a good bet .",
    "the result for the quintessence parameter @xmath95 is consistent with @xmath102 , corresponding to a cosmological constant .",
    "the marginalized limit is @xmath105 at @xmath99 confidence , consistent with ref",
    ".  @xcite .",
    "if we neglect the quintessence perturbations it is a simple matter to relax the assumption that @xmath106 ; for flat models with no tensors or massive neutrinos we find the marginalized result @xmath107 at @xmath99 confidence , and the n - d result @xmath108 with the best fit close to @xmath102 , broadly consistent with ref .",
    "note that including quintessence perturbations leads to a tighter constraint on @xmath95 due to the increased large scale power .",
    "although perturbations are required for consistency with general relativity , it is possible that a quintessence model may be approximated better by a constant @xmath95 model neglecting perturbations than one including the perturbations .",
    "the constraint on the tensor mode amplitude ( encoded by @xmath79 ) is weak , as expected due to the large cosmic variance on large scales . in table",
    "[ inflationtable ] we also show the result for @xmath109 , the ratio of the large scale cmb power in tensor and scalar modes . for comparison , with perfect knowledge of all the other parameters and a noise - free sky map ,",
    "the cmb temperature power spectrum cosmic variance detection limit is @xmath110 .",
    "the method we have used could be generalized for a more accurate parameterization of the initial power spectrum , for example going to second order in the slow - roll parameters  @xcite , which in general introduces a running in the spectral index .",
    "the current data is however clearly consistent with the simplest scale invariant power spectrum with no tensor modes . as a check",
    "we have generated chains for flat models with a cosmological constant , no massive neutrinos or tensors , but allowing for a running spectral index , and found the @xmath111-confidence marginalized result @xmath112 at @xmath113 where @xmath114 .",
    "this corresponds to the running spectral index @xmath115 .",
    "we now relax the constraint on the curvature , and allow the tensor spectral index to be a free parameter ( we assume @xmath116 ) .",
    "we parameterize the power spectra of the initial curvature and tensor metric perturbations as in the inflationary case on the right hand side . ] , except that we now report results for @xmath117 rather than a slow - roll parameter , and choose the scalar and tensor pivot scales @xmath118 , @xmath119 ( the standard cmbfast  parameterization ) .    in figure  [ full1d ]",
    "we show the parameter constraints that we get using about 10000 weakly correlated samples importance sampled to include the 2df data and cbi .",
    "for comparison we plot the equivalent constraints with the @xmath120 and @xmath121 parameter models .",
    "the additional freedom in the curvature broadens some of the constraints significantly , though the @xmath24 and @xmath32 constraints are quite robust .",
    "the tensor spectral index is essentially unconstrained , the difference between the mean likelihood and marginalized 1d plots being due to the assumed flat prior on the tensor amplitude  at very small amplitudes @xmath77 could be anything and still be undetectable .",
    "the @xmath99 marginalized limit on the curvature is @xmath122 .",
    "slightly open models fit the data marginally better on average , though a flat universe is well within the @xmath111 confidence contour .",
    "the limit on the equation of state parameter is slightly weakened to @xmath123 , and neutrino mass is now @xmath124 at @xmath99 confidence .",
    "we have explored the posterior distribution in various parameter spaces , deriving parameter constraints in the different models .",
    "since we obtain only upper limits on @xmath91 , @xmath95 and @xmath117 there is no evidence for massive neutrinos , @xmath125 or tensor modes using current data .",
    "one can make a more quantitative comparison of the different models by comparing how well each fits the data . as discussed in appendix  [ constraints ] a natural measure is the mean likelihood of the data obtained for the different models .",
    "equivalently , if one chose a random sample from the possible parameter values , on average how well would it fit the data ?",
    "we find that the six , nine and eleven parameter models have mean likelihoods ratios @xmath126 using all the data .",
    "so by moving away from the basic model we have not increased the goodness of fit on average ( rather the reverse ) , which is not surprising given how well the basic model fits the data .",
    "most of the distributions of the additional parameters peak at their fixed values .",
    "we also considered the probability of each model , found from marginalizing out _ all _ parameters ( the ` evidence ' as e.g. explained in ref .",
    "@xcite ) . since the 9 and 11 parameter models are totally consistent with the 6 parameter model",
    "then it is already clear that using this method will favor the 6 parameter model for any choice of prior .",
    "the numerical evidence ratio depends very strongly on the prior , and without a well motivated alternative to the null hypothesis ( that there are only 6 varying parameters ) , its value is not useful .",
    "the mean likelihood of the samples ( above ) uses the posterior as the prior , which is at least not subjective , and has a convenient interpretation in terms of goodness of fit .",
    "whilst certainly not ruled out , at the moment there is no evidence for observable effects from the more complicated models we have considered .",
    "nonetheless , when considering parameter values , it is important to assess how dependent these are on the assumptions , and this can be seen by comparing the results we have presented .",
    "we conclude that at the moment simple inflationary models with small tilt and tensor amplitude ( e.g. small field models with a nearly flat potential ; or observationally equivalently , ekpyrotic models ) account for the data well . on average the fit to the data",
    "is not improved by adding a cosmologically interesting neutrino mass or by allowing the dark energy to be something other than a cosmological constant .",
    "in this paper we have demonstrated the following benefits of sampling methods for cosmological parameter estimation :    * the practicality of exploring the full shape of high - dimensional posterior parameter distributions using mcmc . *",
    "the use of principle component analysis to identify well constrained non - linear combinations of parameters and identify degeneracies .",
    "* simple calculation of constraints on any parameters that can be derived from the base set ( e.g. age of the universe , @xmath0 , @xmath127 , etc . ) . * use of the mean likelihood of the samples as an alternative to marginalization to check robustness of results and relative goodness of fit . * the calculation of extremal values within the n - d hyper - surface to better represent the range of the full probability distribution . * the use of importance sampling to quickly compare results with different subsets of the data , inclusion of new data , and correction for small theoretical effects .",
    "our monte - carlo code and chains are publicly available at http://cosmologist.info/cosmomc .    with the current cosmological data we found that the monte - carlo approach works well , though simply picking the best fit sample does not identify best - fit model to high accuracy ( and therefore we do not quote these numbers ) , and there are potential difficulties investigating posterior distributions with multiple local minima ( although this is not a problem given the parameters and data used here ) .",
    "we investigated a 6-d cosmological parameter space and found , for the first time , a concise description of the cmb constraints on the matter power spectrum normalization , in addition to tight constraints on @xmath128 and @xmath11 in agreement with previous analyses .",
    "the new information from the cbi and vsa interferometers is in good agreement with the older data points and we find that our results are negligibly changed on removing this information .    on adding in constraints from a wide range of cosmological data we evaluated constraints on the above 6 parameter model as well as extending to more complicated 9 and 11 parameter models .",
    "many of the constraints on the base set of parameters were fairly robust to the addition of this extra freedom , for example the matter density changed from @xmath129 for the basic 6 parameter model to @xmath130 for the 11 parameter model ( 68 per cent confidence ) . on the other hand",
    "the value for the matter power spectrum normalization on @xmath131 scales is quite dependent on the neutrino mass , and allowing for a significant neutrino mass decreases the mean value of @xmath0 ( the constraint on the amplitude could be improved by better constraints on the small scale cmb amplitude and the reionization redshift . )",
    "parameters affecting or sensitive to the late time evolution tend to be rather degenerate , and constraints on these are considerably weakened on adding additional freedom in the model .",
    "we find that the 9 parameter model is quite well constrained by the amount of data used and obtain upper limits on a number of interesting cosmological parameters , given our assumptions of a flat universe with slow - roll inflation constraints .",
    "in particular we find the marginalized constraint @xmath132 on the neutrino mass and @xmath133 for the equation of state parameter ( 95 per cent confidence ) .",
    "there is no evidence for tensor modes , though the constraint is currently quite weak , with the constraint on the ratio of the large scale cmb power being @xmath134 .",
    "this constraint could be sharpened considerably by restricting the allowed range of scalar spectral indices and neutrino masses .    in the 11 parameter space",
    "the limits are weakened slightly and the standard cosmology of @xmath102 and @xmath28 is near the peak of the posterior probability .",
    "the tensor spectral index is essentially unconstrained as expected given that the only information comes from the large scale ( cobe ) cmb data .",
    "while a detailed investigation of the effect of using all the different combinations of cosmological constraints is beyond the scope of this paper we do show the effect of removing the second most powerful constraint ( the galaxy power spectrum ) on the 9 parameter model in figure  [ inflation1d ] .",
    "the limits on most of the parameters are affected remarkably little .",
    "the neutrino mass is the most affected , with the upper limit doubling on removing 2df .",
    "the neutrino mass is correlated with the matter power spectrum shape parameter ( roughly @xmath60 ) and amplitude , and these constraints are correspondingly weakened on removing 2df .",
    "as new better data become available our general method should also be applicable into the future .",
    "due to the enormously decreased number of likelihood evaluations in the mcmc method compared to other approaches , theoretical predictions can be computed essentially exactly , and one can account for the available data in detail .",
    "we thank the members of the leverhulme collaboration for many useful discussions , in particular ofer lahav , carolina dman , oystein elgaroy , jerry ostriker and jochen weller .",
    "we are grateful to david mackay and steve gull for encouraging the use of mcmc .",
    "we thank anze slozar , keith grainge , alexandre rfrgier and kev abazajian for helpful suggestions .",
    "we thank george efstathiou for making his cmbfit code available to us .",
    "al thanks the leverhulme trust for support .",
    "slb acknowledges support from selwyn college and pparc and thanks the aspen center for physics where part of this work was done .",
    "we thank pparc and hefce for support of the cosmos facility .",
    "the algorithm that we use for generating samples from the posterior distribution using a markov chain is the metropolis - hastings algorithm . for an introduction and overview of mcmc methods",
    "see ref .",
    "a markov chain moves from a position in parameter space @xmath135 to the next position @xmath136 with transition probability @xmath137 , where @xmath138 labels a vector of parameter values .",
    "the metropolis - hastings transition kernel @xmath137 is chosen so that the markov chain has a stationary asymptotic distribution equal to @xmath139 , where @xmath139 is the distribution we wish to sample from .",
    "this is done by using an arbitrary _ proposal density _",
    "distribution @xmath140 to propose a new point @xmath141 given the chain is currently at @xmath142 . the proposed new point",
    "is then accepted with probability @xmath143 so that @xmath144 .",
    "this construction ensures that detailed balance holds , @xmath145 and hence that @xmath139 is the equilibrium distribution of the chain .",
    "if the chain is started in a random position in parameter space it will take a little time , _ burn in _ , to equilibrate before it starts sampling from the posterior distribution .",
    "after that time each chain position is a _ correlated _ sample from the posterior .",
    "the correlation is particularly obvious if the proposal is not accepted as then there are two or more samples at exactly the same point .",
    "however by using only occasional chain positions ( thinning the chain ) one can give the chain time to move to an uncorrelated position in parameter space , and independent samples are then obtained .",
    "small residual correlations between samples are unimportant for almost all calculations , though they do make the monte - carlo error on the results harder to assess .    for the cases we consider the chains equilibrate rapidly , at worst after thousand or so points .",
    "the results can be checked easily by using a longer burn in and comparing results .",
    "we thin the chain positions by a factor of 25 - 50 depending on the number of parameters , leaving weakly correlated samples that we use for importance sampling ( see appendix  [ importance ] ) .",
    "if the proposal density is symmetrical it cancels out when working out the acceptance probability , which then becomes just the ratio of the posteriors .",
    "this is the case when the proposal density is independent of the current position of the chain , which is the case we consider .",
    "the choice of proposal density can have a large effect on how the algorithm performs in practice .",
    "in general it is best to have a proposal density that is of similar shape to the posterior , since this ensures that large changes are proposed to parameters along the degeneracy directions .",
    "fortunately with cosmological data we have a reasonable idea of what the posterior might look like , and so choosing a sensible proposal density is not difficult .",
    "if posteriors from models with common parameters are much easier to compute it can be beneficial to use a proposal density that changes only a subset of the parameters on each iteration , ensuring that consecutive posterior evaluations only differ in a subset of the parameters .",
    "proposing a change to a random subset of the parameters also increases the acceptance rate , especially in high dimensions , giving faster piecewise movement around parameter space . in the case of cmb parameter estimation ,",
    "models that differ only by a different normalization of the theoretical cmb power spectrum are very quick to compute once the @xmath146 values for a single model have been calculated .",
    "similarly changing parameters that govern calibration uncertainties in the data can also be very quick .",
    "however changing parameters that govern the perturbation evolution , for example @xmath128 , @xmath147 , etc , will be much slower as in general it requires a detailed recalculation of the linear physics .",
    "if we are comparing cmb data with theoretical models , the most general way to compute the theoretical @xmath146 power spectrum is using a fast boltzmann code such as camb  @xcite ( a parallelized version of cmbfast  @xcite ; we discuss less accurate and general schemes below ) . since the perturbation evolution is assumed to be linear , any parameters governing the initial power spectra of the scalar and tensor perturbations will be fast to compute once the transfer function for each wavenumber has been computed .",
    "parameters governing the initial power spectrum are therefore ` fast ' parameters .",
    "we therefore use a proposal density that makes changes only within the subsets of the fast and slow parameters , at least when we do not have an approximate covariance matrix available for the posterior .",
    "we made the fairly arbitrary choice to change a subset of one to three parameters at a time , cycling through the parameters to be changed in random order , which gives a high acceptance rate ( @xmath148 ) for the cases we considered .",
    "after one initial run one can transform to a set of parameters which diagonalize the covariance matrix before doing subsequent runs , allowing efficient exploitation of degeneracy information as long as the posterior is reasonably gaussian .",
    "the above scheme is sufficient for parameter estimation from current data , however as more data becomes available the posterior may become highly non - gaussian or disjoint , in which case it may become necessary to use more sophisticated schemes using simulated annealing , hybrid monte carlo , or schemes using cross - chain information  @xcite .",
    "however when the posterior is not disjoint one can often transform to a set of base parameters which are relatively independent , in which case a simple monte - carlo scheme should continue to work well ( see appendix  [ constraints ] for further discussion ) .",
    "given a set of samples from a distribution @xmath149 , one can estimate quantities with respect to a different similar distribution @xmath150 , by weighting the samples in proportion to the probability ratios .",
    "this effectively gives a collection of non - integer weighted samples for computing monte - carlo estimates .",
    "for example the expected value of a function @xmath151 under @xmath150 is given by @xmath152 given a set @xmath153 of @xmath154 samples from @xmath149 a monte - carlo estimate is therefore @xmath155 for this to work it is essential that @xmath156 is never very small , and for a good estimate without massively oversampling from @xmath149 one needs @xmath157 everywhere where @xmath150 is significantly non - zero .",
    "if @xmath150 is non - zero over only a very small region compared to @xmath149 it will be necessary to proportionately oversample from @xmath149 .",
    "if the distributions are not normalized , so that @xmath158 , the ratio of the normalizing constants can be estimated using @xmath159 and hence @xmath160    in bayesian analysis it can be useful to compute the ratio of the evidences @xmath161 , given as above by @xmath162 where the samples @xmath153 are drawn from @xmath163 . assuming the distributions are sufficiently similar , the evidence under @xmath150 can therefore easily be computed from the probability ratios at a sample of points under @xmath149 , and a known evidence under @xmath149 . in many cases",
    "only the ratio is of interest  the ratio is larger than one if on average the probability of the samples under @xmath150 is higher than under @xmath149 . in the case where the distributions are very different",
    "one may need to introduce a series of intermediate distributions that are all not too dissimilar to each other , and perform monte carlo simulations for each .",
    "the evidence ratio one requires is then just the product of that for all the intermediate distributions .",
    "many more general schemes are described in  @xcite , though in this paper we only consider importance sampling to similar or subset distributions .",
    "the simplest application of importance sampling is to adjust results for different priors .",
    "for example if one computes a chain with flat priors on the parameters , one may wish to importance sample to several different distributions with different priors on various parameters .",
    "this will work well as long as the prior does not skew the distribution too much or give non - zero weight to only a very small fraction of the models .",
    "mcmc runs produce correlated samples from the probability distribution . to obtain independent samples",
    "one thins out the chain by a sufficiently large factor that the chain has had time to move to a randomly different point between the thinned samples .",
    "depending on how one implements the mcmc , the shape of the posterior and the number of dimensions the thinning factor can be quite large , typically of the order ten to a thousand .    by performing monte - carlo simulations with a good approximation to the true probability distribution one can use importance sampling to correct the results with an accurate calculation of the probabilities",
    ". this can be useful if computing the probabilities accurately is much slower than computing an approximation , since one only ever importance samples _ independent _ samples .",
    "the burn - in and random walking stages of the monte - carlo involve a much larger number of probability evaluations , so using a fast approximation when generating the chain saves a lot of time .",
    "calculating the posterior from cmb data requires a calculation of the theoretical cmb power spectra , @xmath146 . using accurate codes like camband cmbfast  is typically _ much _ slower than computing the likelihoods from the data once",
    "the @xmath146 are known ( assuming one uses a radical data - compression scheme , e.g. see ref .",
    "@xcite ) . in the not so distant future",
    "we will require to high accuracy @xmath146 up to @xmath164 , including second order effects such as lensing , and also the matter power spectrum at various redshifts .",
    "without access to a fast supercomputer this may be prohibitive .    with a small number of parameters it is possible to use a grid of models and interpolate to generate accurate @xmath146 quickly ,",
    "however as the number of parameters grows the computational cost of computing the grid grows exponentially .",
    "also , as second order effects such as gravitational lensing become important , fast grid generation schemes such as the @xmath165-splitting scheme of ref .",
    "@xcite become much more difficult to implement accurately .",
    "however these may still be useful as a fast approximation , as long as the independent samples are corrected with a more accurate calculation .",
    "@xcite describe a scheme for generating @xmath146s very quickly from a small number of base models , a set of optimized parameters , and an accurate calculation of how the @xmath146 vary with these parameters .",
    "this gives a very fast approximator over a restricted range of parameters that may prove useful combined with importance sampling correction .",
    "it is also possible to use fast semi - analytic schemes .",
    "typically these are based on a smallish grid of base models , from which the @xmath146s in general models are computed quickly on the fly by accounting for changes in the angular diameter distance to last scattering , differing perturbation growth rates , etc .",
    "these approximate schemes can be made quite accurate at at small scales , with significant errors mainly at low @xmath166 , precisely where the cosmic variance is large .",
    "so whilst an approximate scheme may produces small systematic errors in the likelihood , if the error is of the same order as the cosmic variance or less , the probabilities given the data are bound to be sufficiently similar for importance sampling to be valid .",
    "a particular approximate @xmath146 generator we have tried is cmbfit  @xcite , which uses of combination of base @xmath146 grids and analytic fits .",
    "this achieves quite good few percent level accuracy at high @xmath166 , though larger systematic errors at low @xmath166 .",
    "however the code is fast , and we found that importance sampling the results with an exact calculation of the @xmath146 gives good results , and removes systematic biases introduced by the low @xmath166 approximations .",
    "such an approach can be generalized for more general late time evolution , for example models with quintessence where the effect on small scales is due almost entirely to changes in the background equation of state .",
    "an alternative scheme based on grids of the transfer functions for each wavenumber can produce more accurate results , like the recently released dash  @xcite .",
    "however this is not much faster than generating the @xmath146s exactly using camb  on a fast multi - processor machine , and relies on a large pre - computed grid ( which introduces its own limitations ) .",
    "the only real advantage over cmbfit is that more general initial power spectrum parameterization could be accounted for easily  something that is impossible with schemes based on grids of @xmath146s .    even without a fast semi - analytic scheme",
    ", there are a variety of small corrections that can be applied post hoc .",
    "for example lensing affects the cmb @xmath146 at the few percent level , so one may wish to compute chains without including the lensing , then importance sample to correct the results using an accurate calculation including the lensing . for small scales at high precision one",
    "may also wish to run camb  at a high - accuracy setting to check that numerical errors in the default output are not affecting the results .",
    "also chains could be generated to lower @xmath166 and the effect of the high-@xmath166 constraints accounted for by importance sampling .",
    "for example we generated the chains using @xmath167 , and then for the nearly independent samples re - computed the power spectra up to @xmath168 for importance sampling with the cbi data .",
    "similar methods could be applied for the matter power spectrum using approximate fittings , see e.g. refs .",
    "however when a fast multi - processor machine is available , and one is interested in a very large number of parameters , it is much simpler to monte - carlo using camb  to generate the cmb power spectra and matter power spectrum , which is what we did for the results we present .",
    "the great advantage of this approach is that it generalizes trivially if one wishes to include changes in the physics , for example different quintessence models , or changes in the initial power spectrum .",
    "assuming that one has some new data which is broadly consistent with the current data , in the sense that the posterior only shrinks , one can use importance sampling to quickly compute a new posterior including the new data .",
    "we have made our mcmc chains publicly available , so these can be used to rapidly compute new posteriors from new data without incurring any of the considerable computational cost of generating the original chain .",
    "for example if you have a new constraint on @xmath0 , you just need to loop over the samples adjusting the weights of the samples proportional to the likelihood under the new constraint .",
    "using importance sampling has the added benefit of making it very easy to assess how the new data is changing the posterior .",
    "the great advantage of the monte - carlo approach is that you have a set of samples from the full parameter space . to answer any particular question",
    "one can examine the points and compute results reliably , taking full account of the shape of the posterior in @xmath154 dimensions .",
    "however for human consumption it is usual to summarize the results as a set of parameter values and error bars .",
    "one way to do this is to use the samples for a principle component analysis to identify the degeneracy directions , as we demonstrated in section  [ cmbonly ] . by quoting constraints on a set of orthogonalized parameters one retains most of the information in the original distribution , as long as it is sufficiently gaussian ( or gaussian in the log , or some other function ) .",
    "however ultimately one is usually interested in the values of some fundamental parameters , and it is also useful to find constraints on these alone .",
    "the simplest approach is to compute the marginalized 1-dimensional distributions for each parameter , essentially counting the number of samples within binned ranges of parameter values .",
    "note that this is extremely hard to do using a brute - force numerical grid integration calculation as it scales exponentially with the number of dimensions , but is quite trivial from a set of monte - carlo samples .",
    "one can then quote the value at the maximum or mean of the 1d distribution , along with extremal values of the parameter which contain a fraction @xmath169 of the samples , where @xmath169 defines the confidence limit .",
    "the extremal values could be chosen so that there were the same number of outliers at both ends of the distribution , or such that the value of the _ marginalized _ probability is the same at each limit .",
    "this is a good way of summarizing the current state of knowledge as long as you have included everything you know , including using a believable prior over parameter space .",
    "however , frequently one wants to use the parameter estimates to assess consistency with new data or theories , and the prior can be very hard to define .",
    "for example , on putting in a top hat prior on the age and @xmath21 , the _ marginalized _ prior probabilities are _ not _ flat , even if all of the other priors are flat broad top hats .",
    "this is because the marginalized distribution includes the effect of the amount of parameter space available at each point , which can depend quite strongly on the value of the parameter .",
    "likewise it is possible to have a region in parameter space which fits the data rather well , but because the region is small the marginalized probability of those parameter values can be very low .",
    "when assessing consistency with new data ( or theories ) , one really wants to know whether the posterior for the new data intersects the @xmath154-dimensional posterior for the current data in a region where both are likely .",
    "for example one could define the region of parameter space enclosing a fraction @xmath169 of the points with the highest likelihood as the @xmath154-dimensional confidence region , and then see whether this region intersects with the corresponding region for the new data .",
    "it is clearly sub - optimal to try to perform this comparison using only 1d parameter values and limits , however if one quotes the extremal values of each parameter contained in the @xmath154-dimensional confidence region it is at least possible to assess whether the @xmath154-dimensional regions _ might _ overlap .",
    "at least if the new data is outside these limits it is a clear indication that there is an inconsistency , whereas using the marginalized limits it shows no such thing ( just that if there is a consistent region it makes up a small fraction of the original parameter space  something one would hope for if the new data is informative ! )",
    "however it is of course easily possible for the 1d likelihood limits to be consistent but the full @xmath154-dimensional regions to be highly inconsistent .    in",
    "order to be as informative as possible it can be useful to quote both the marginalized and likelihood limits , though of course one should study the full set of samples to make use of as much information as possible . when there are strong degeneracies one can quote the constraints on the well - determined orthogonalized parameters .",
    "often it is useful to show the projected shape of the distribution in one or two dimensions .",
    "the marginalized distribution , proportional to the number of samples at each point in the projected space , gives the probability density in the reduced dimensions , ignoring the values of the parameters in the marginalized dimensions , and is therefore usually the quantity of interest .",
    "however this looses all the information about the shape of the distribution in the marginalized directions , in particular about the goodness of fit and skewness with respect to marginalized parameters .",
    "useful complementary information is given by plotting the likelihood of the best fit model at each point , for example see ref .",
    "however it is not so easy to compute this using a small set of monte - carlo samples  mean values within each bin can be obtained quite accurately from a small number of samples , but getting a good value for the maximum in each bin requires a much larger number .",
    "instead we plot the mean likelihood of the samples at each value of the parameter , which is easy to compute from the samples .",
    "it shows how good a fit you could expect if you drew a random sample from the marginalized distribution at each point in the subspace .    from a distribution @xmath139",
    "one can derive the ( marginalized ) distribution of a derived parameter vector of interest @xmath170 by @xmath171 assuming flat priors on @xmath138 the expected mean likelihood of samples with @xmath172 is @xmath173 frequently @xmath174 is a projection operator into a subspace of @xmath138 ( for example @xmath175 for marginalization down to the first parameter ) .",
    "if this is the case and @xmath139 is a multivariate gaussian distribution , the marginalized distribution @xmath176 is also a gaussian ( readily proved using fourier transforms ; the covariance is given by the projected covariance matrix ) .",
    "since the square of a gaussian is a gaussian it follows that @xmath177 , and hence the mean likelihood is proportional to the marginalized distribution @xmath176 .",
    "this also follows trivially if @xmath149 is separable with respect to the subspace . in the case of gaussian or separable distributions",
    "the mean likelihood curve is therefore proportional to the marginalized distribution and the two curves look the same .",
    "differences in the curves therefore indicate non - gaussianity , for example when one of the marginalized parameters is skewing the distribution in a particular direction ( for example the effect of massive neutrinos @xmath92 on the @xmath0 curve in figure  [ inflation1d ] ; if @xmath67 was fixed at it s maximum likelihood value the marginalized result for @xmath0 would change significantly in the direction of the mean likelihood curve ) .",
    "the converse does not hold of course , it is possibly to have a non - gaussian distribution where both curves are the same .",
    "if the priors on the parameters are not flat this will also show up as differences in the curves even if the likelihood distribution is gaussian .",
    "in our analysis we chose a particular set of base parameters which were assigned flat priors .",
    "this choice was fairly arbitrary , and there are other possible choices .",
    "for example one might instead use @xmath12 as a base parameter and derive @xmath21 from the constraint @xmath178 in this case the prior on @xmath21 is given by @xmath179 and so the prior on @xmath21 is proportional to @xmath180 if the prior on @xmath12 is flat . using @xmath21 as a derived parameter therefore tends to give results which favor lower @xmath21 values and higher @xmath24 values . using importance sampling",
    "it is straightforward to adjust results from one set of base parameters to another by weighting the samples by the corresponding ratio of the priors and then importance sampled . ] .",
    "for the results of the parameter estimation to be meaningful it is essential that the priors on the base set are well justified , or that the results are independent of the choice . in figure  [ prioreff ]",
    "we show the effect on the posterior constraints from the cmb data from the 6 parameter analysis using different base sets .",
    "the distributions shift by a fraction of their width , though this can have quite a large effect on the high - significance limits of weakly constrained parameters ( for example the @xmath99 confidence limit is @xmath181 with @xmath21 a base parameter , @xmath182 with @xmath12 a base parameter ) .    for well constrained parameters",
    "the prior effectively becomes flatter over the region of interest and the effect is much less significant . as shown on the right of figure  [ prioreff ] the posteriors of four parameters that are well constrained by the cmb are almost independent of the choice of prior .    as shown in figure  [ prioreff ]",
    "plotting the mean likelihood of the samples gives a clear indication of the direction in which results may be biased relative to a different choice of prior .",
    "it is also clear that by choosing @xmath21 as a base parameter we are getting more samples in the region of interest for comparison with other data . in particular using @xmath12 as a base parameter gives a sharp cut - off at the higher values of @xmath21 , which are allowed by the hst prior .",
    "one slight disadvantage of using @xmath21 rather than @xmath12 is that the correlation of @xmath21 with some of the other base parameters is significant , which may make the monte - carlo sampling less efficient .",
    "however since we use the covariance matrix to rotate to a set of orthogonalized parameters after one short initial run this is not a major problem .",
    "[ prioreff ]    the efficiency of the mcmc implementation can be improved by using a set of parameters for which the posterior is as symmetric as possible  @xcite .",
    "it may therefore be a good idea to transform to a better set of base parameters , for example one could transform to a set of orthogonalized parameters derived from a principle component analysis using some less constraining data .",
    "however when performing a non - linear transformation of parameters it is also necessary to transform the flat priors on the parameters to obtain equivalent results . if one assumes flat priors in the transformed parameters it is wise to check that this does not induce a strong prior bias on the cosmological parameters of interest",
    "to consider whether an enlarged parameter space is justified , one ideally wants to compare the evidences @xmath183 with the different parameter sets . in some cases , for example when using hyperparameter weights on experiments , it may be possible to define a prior on the extra parameters in which case one can compute the evidence ratio directly .",
    "the ratio does however depend quite strongly on the prior put on the parameters , which in general it is not straightforward to quantify .",
    "if one puts a broad prior on a parameter , but the likelihood is much narrower , the probability of the data is down - weighted because the likelihood takes up a much smaller region of parameter space .",
    "one simple , but non - bayesian , way to get round this is to set the prior equal to the normalized posterior for computing the evidence , in which case one compare the values of @xmath184 this is just the expected probability of the data in the posterior distribution , which can be estimated trivially from a set of monte - carlo samples as the mean likelihood of the samples . for gaussian distributions",
    "this is the exponential mean of the chi - squareds under the posterior distribution , and is thus a smeared - out version of the common practice of quoting the chi - squared of the best fit .",
    "the smearing out helps to down - weight extra parameters which have to be fine tuned to obtain better fits . if the mean likelihood is bigger with the extra parameters it suggests they are improving the fit to the data on average .",
    "although we know no way to use the value rigorously for hypothesis testing , it seems nonetheless to be useful as a rule of thumb measure of goodness of fit .",
    "it is important to assess whether the datasets being used are consistent , or whether one or more is likely to be erroneous .",
    "this can be done by introducing hyperparameter weights on the different datasets  @xcite when performing the analysis .",
    "if a dataset is inconsistent , its posterior hyperparameter will have a low value , and the dataset then only contributes weakly to the posterior probability of the parameters . in the case",
    "that the likelihoods are of gaussian form it is a simple matter to marginalize over the hyperparameters analytically given a simple prior . to assess whether the introduction of hyperparameters is justified ( i.e. whether the data are inconsistent with respect to the model ) , one can compare the probability of obtaining the data in the two hypotheses : @xmath185 , no hyperparameters are needed ; @xmath186 , hyperparameters are needed because one or more datasets are inconsistent . using a maximum entropy prior assuming that on average the hyperparameter weights are unity , ref .",
    "@xcite gives @xmath187 where @xmath165 labels the datasets , each containing @xmath188 points .",
    "given a set of independent samples from @xmath185 it is straightforward to compute an estimate of the evidence ratio using eq .  .",
    "if the datasets are inconsistent the importance sampling estimate would be very inaccurate as the probability distributions would be significantly different",
    ". however this should be clear when one computes the estimate since the probability ratios will vary wildly . if one suspects that one of the datasets is inconsistent it would be better to start with sampling from @xmath186 , and",
    "confirm that the evidence ratio supports using the hyperparameters .",
    "an even simpler way of assessing consistency of the datasets might be to compare the mean likelihood of the samples in the region of overlap of the posterior distributions to the overall mean likelihood under the original posterior .",
    "if the mean likelihood of the samples in the region of overlap is much less than the original mean , it is an indication than the regions of high likelihood under each dataset do not overlap well in @xmath154-dimensions , and hence there may be an inconsistency . in practice",
    "the samples in the region of overlap can be found by importance sampling additional datasets .",
    "the mean likelihoods should always be computed with respect to the same , original , dataset ( or group of datasets ) .",
    "however importance sampling may fail to identify inconsistencies in particular cases when the distributions have multiple maxima .",
    "frequently one has data in which there is an unknown calibration uncertainty , or an unknown normalization .",
    "these parameters can be marginalized over analytically following  @xcite as long as the likelihoods are gaussian , and the prior on the amplitude parameter is gaussian or flat .",
    "typically one has a marginalization of the form @xmath189\\ ] ] where @xmath190 and @xmath191 are vectors , @xmath192 is the noise covariance matrix , and @xmath193 is the prior .",
    "for example for the supernovae data @xmath190 is assumed to be a vector of equal constants giving the intrinsic magnitudes of the supernovae , and @xmath191 is a vector of the theoretical minus the observed effective magnitudes .",
    "if the prior @xmath194 it clearly can not be normalized , however the marginalization is trivial giving @xmath195 in the case that @xmath190 is a constant ( independent of the data and parameters ) , one has @xmath196 where @xmath197 this is exactly the same as the best - fit one obtains by minimizing the likelihood w.r.t .",
    "@xmath198 , and so in this case the maximization technique of ref .",
    "@xcite is exactly equivalent to full marginalization .",
    "for example , in the case of the supernovae data , marginalization with a flat prior over the magnitudes is equivalent to using the best - fit magnitude . in general",
    "this is not true as the logarithmic dependence @xmath199 can depend on the parameters .",
    "for example with the 2df data @xmath190 would be the predicted matter power spectrum values , and @xmath198 would be the unknown amplitude relative to the galaxy power spectrum at @xmath200 ."
  ],
  "abstract_text": [
    "<S> we present a fast markov chain monte - carlo exploration of cosmological parameter space . </S>",
    "<S> we perform a joint analysis of results from recent cmb experiments and provide parameter constraints , including @xmath0 , from the cmb independent of other data . </S>",
    "<S> we next combine data from the cmb , hst key project , 2df galaxy redshift survey , supernovae ia and big - bang nucleosynthesis . </S>",
    "<S> the monte carlo method allows the rapid investigation of a large number of parameters , and we present results from 6 and 9 parameter analyses of flat models , and an 11 parameter analysis of non - flat models . </S>",
    "<S> our results include constraints on the neutrino mass ( @xmath1 ) , equation of state of the dark energy , and the tensor amplitude , as well as demonstrating the effect of additional parameters on the base parameter constraints . in a series of appendices we describe the many uses of importance sampling , including computing results from new data and accuracy correction of results generated from an approximate method . </S>",
    "<S> we also discuss the different ways of converting parameter samples to parameter constraints , the effect of the prior , assess the goodness of fit and consistency , and describe the use of analytic marginalization over normalization parameters . </S>"
  ]
}