{
  "article_text": [
    "in many applications of x - ray diffraction ( xrd ) techniques to the study of crystal properties , a key step in the data processing chain is an effective and adaptive noise filtering @xcite .",
    "a correct noise removal can facilitate the separation of the useful crystallographic information from the background signal , and the estimation of crystal structure and domain size .",
    "important issues of xrd data filtering are performances in noise suppression , capability to preserve the peak position , computational cost and , finally , the possibility of being used as a blackbox tool .",
    "different digital filters have been applied to xrd data , in spatial and frequency domains .",
    "simple procedures are based on polynomial filtering ( and fitting ) in the spatial domain @xcite .",
    "a standard practice when working in frequency domain is to use fourier smoothing .",
    "it consists in removing the high - frequency components of the spectrum @xcite .",
    "since the truncation of high - frequency components can be problematic in the case of high level noise , a different approach based on the wiener fourier ( wf ) filter has been proposed to clean xrd data @xcite",
    ". a different approach , which makes use of the singular value decomposition ( svd ) , has been successfully applied to time - resolved xrd data to reduce noise level @xcite .    in this work",
    "we describe an application of the hankel lanczos singular value decomposition ( hlsvd ) algorithm to filter xrd intensity data .",
    "the proposed filter is based on a subspace - based parameter estimation method , called hankel singular value decomposition ( hsvd ) @xcite , which is currently applied to nuclear magnetic resonance spectroscopy data for solvent suppression @xcite .",
    "the hsvd method computes a `` signal '' subspace and a `` noise '' subspace by means of the svd of the hankel matrix @xmath0 , whose entries are the noisy signal data points .",
    "its computationally most intensive part consists of the computation of the svd of the matrix @xmath1 recently , several improved versions of the algorithm have been developed in order to reduce the needed computational time @xcite . in this paper , we choose to apply the hsvd method based on the lanczos algorithm with partial reorthogonalization ( hlsvd  pro ) , which is proved to be the most accurate and efficient version available in the literature .",
    "a comparison in terms of numerical reliability and computational efficiency of hsvd with its lanczos - based variants can be found in ref .",
    "@xcite .",
    "a criterion is presented to facilitate the separation of noise from the useful crystallographic signal .",
    "it enables the design of a blackbox filter to be used in the processing of xrd data . here",
    ", the filter is applied to nanocrystalline xrd data .",
    "nanocrystals are characterized by chemical and physical properties different from those of the bulk @xcite . at a scale of a few nanometers",
    ", metals can crystallize in a structure different from that of bulk . nowadays",
    ", different branches of science and engineering are benefiting from the properties of nanocrystalline materials @xcite .",
    "in particular , recent xrd experiments have shown that intensities , measured as a function of the scattering angle , could be useful to extract structural and domain size information about nanocrystalline materials .",
    "synthetic xrd datasets are generated by computing the x - ray scattered intensity from nanocrystalline samples of different size and properties by using an analytic expression ( see eq .",
    "( [ eq : debye ] ) in section 3 ) .",
    "synthetic datasets are processed and filter performance is studied when considering different levels of noise .",
    "numerical tests on real xrd data of au nanocrystalline samples of different size and properties show the robustness of the proposed filter and its capability to extract easily and efficiently the useful crystallographic information .",
    "these characteristics make this filter an interesting and user  friendly tool for the interactive processing of xrd data .",
    "the paper has the following structure .",
    "section 2 is devoted to the theoretical aspects of the proposed approach .",
    "the dataset used to study the filter properties is described in section 3 .",
    "numerical results are reported in section 4 .",
    "finally , some conclusions are drawn in section 5 .",
    "let us denote with @xmath2 the samples of the diffracted intensity signal collected at angles @xmath3 , @xmath4 .",
    "they are modelled as the sum of @xmath5 exponentially damped complex sinusoids @xmath6 + e_n                            \\ ; , \\label{eq : model}\\ ] ] where @xmath2 and @xmath7 , respectively , represent the measured and modelled intensities at the _ n - th _ scattering angle @xmath8 , with @xmath9 the sampling angular interval and @xmath10 the initial scattering angular position , @xmath11 is the amplitude , @xmath12 the phase , @xmath13 the damping factor and @xmath14 the frequency of the _ k - th _ sinusoid , @xmath15 , with @xmath5 the number of damped sinusoids , and @xmath16 is complex white noise with a circular gaussian distribution .",
    "it is worth noting that the value of @xmath5 increases or decreases by 2 in order to guarantee that the modelled intensity is real .",
    "the @xmath17 data points defined in ( [ eq : model ] ) are arranged into a hankel matrix @xmath0 of dimensions @xmath18 , with @xmath19 and @xmath20 @xmath21_{l \\times m}. \\label{eq : matrix}\\ ] ] the svd of the hankel matrix is computed as @xmath22 where @xmath23 , @xmath24 , @xmath25 , @xmath26 and @xmath27 are orthogonal matrices and the superscript h denotes the hermitian conjugate .",
    "the svd is computed by using the lanczos bidiagonalization algorithm with partial reorthogonalization @xcite .",
    "this algorithm computes two matrix - vector products at each step . exploiting the structure of the matrix ( [ eq : matrix ] ) by using the fft",
    ", the latter computation requires @xmath28 rather than @xmath29 .    in order to obtain the `` signal '' subspace",
    ", the matrix @xmath0 is truncated to a matrix @xmath30 of rank @xmath5 @xmath31 where @xmath32 , @xmath33 , and @xmath34 are defined by taking the first @xmath5 columns of @xmath26 and @xmath27 , and the @xmath35 upper - left matrix of @xmath36 , respectively . as subsequent step , the least ",
    "squares solution of the following over - determined set of equations is computed @xmath37 where @xmath38 and @xmath39 are derived from @xmath33 by deleting its first and last row , respectively .",
    "the @xmath5 eigenvalues @xmath40 of the matrix @xmath41 are used to estimate the frequencies @xmath42 and the damping factors @xmath43 of the model damped sinusoids from the relationship @xmath44 , \\label{eq : eigen}\\ ] ] with @xmath15 .",
    "the values so obtained are inserted into the model eq .",
    "( [ eq : model ] ) which yields the set of equations @xmath45 + e_n                            \\ ; , \\label{eq : model_eigen}\\ ] ] with @xmath46 . the least - squares solution of ( [ eq : model_eigen ] ) provides the amplitude @xmath47 and phase @xmath48 estimates of the model sinusoids .",
    "the hlsvd  pro filter was applied to synthetic as well as real xrd data . in this section ,",
    "the generation of xrd intensity profiles and the experimental setup for the acquisition of real data are described .",
    "both synthetic and real xrd data refer to au nanocrystalline samples .",
    "nanocrystals are made of clusters of three different structure types : cuboctahedral @xmath49 , icosahedral @xmath50 , and decahedral @xmath51 .",
    "for each fixed structure type @xmath52 ( @xmath53 ) the size @xmath54 of clusters follows a log - normal distribution @xmath55 }                            \\ ; , \\label{eq : nano_size_distr}\\ ] ] with mode @xmath56 and logarithmic width @xmath57 .",
    "structural distances for the different structure types @xmath52 are generally studied independently of the actual nanomaterial . the nearest distance between atoms in the crystals",
    "is chosen as a reference length and arbitrarily set to @xmath58 , a constant in various structures @xmath52 and for all sizes @xmath54 of the clusters .",
    "actual distances in nanoclusters are then recovered by applying a correction factor @xmath59 for strain , supposed to be uniform and isotropic . a convenient description of the strain factor as a function of the structure type and cluster size is @xmath60 given in terms of the four parameters @xmath61 $ ] .",
    "intensities scattered by nanoclusters with size @xmath54 and structure type @xmath52 are computed by using the diffractional model based on the debye function method @xcite : @xmath62 } { 2 \\pi q u^{{\\mathcal x},n}_{i , j } a_{\\mathcal x } ( n ) }                        \\right \\ }                            \\ ; , \\label{eq : debye}\\ ] ] where @xmath63 is the incident x - ray intensity , @xmath64 the debye - waller factor , @xmath65 the atomic form factor ; @xmath66 ^ 2 $ ] , @xmath67 and @xmath68 are , respectively , the dimensionless and the usual scattering vector length with @xmath69 being the f.c.c .",
    "bulk lattice constant ; @xmath70 is the number of atoms in the cluster , @xmath71 the distance between the _ i - th _ and _ j - th _ atom , @xmath72 the strain factor .",
    "the total scattered intensity is computed as @xmath73 where @xmath74 denotes the size of the largest cluster of type @xmath52 , @xmath75 is the number fraction of each structure type ( @xmath76 ) , and @xmath77 is the value of log - normal size distribution ( [ eq : nano_size_distr ] ) .",
    "it is worth noting that both intensities in ( [ eq : debye ] ) and ( [ eq : tot_i ] ) are actually functions of the scattering angle @xmath78 being @xmath79 .",
    "experimental xrd intensity profiles are collected by counting , at each scattering angle @xmath3 , the number of scattered photons giving the diffracted intensity signal @xmath2 . for such events data",
    "are affected by poisson noise .",
    "since the number of photons scattered at each angle @xmath3 is large , the poisson - distributed noise can be approximated by a gaussian - distributed noise as required in section [ sec : hsvd ] .",
    "noisy synthetic xrd intensity profiles were built by generating poisson distributed random profiles with intensity @xmath80 ( [ eq : tot_i ] ) taken as the mean value of the poisson process . as a measure of the noise level ,",
    "the noise - to - signal ratio ( nsr ) was defined as follows : @xmath81 where @xmath82 denotes a poisson process with mean value @xmath80 .",
    "figure [ fig_1 ] displays xrd intensity profiles with increasing nsrs .",
    "they were obtained by setting @xmath83 nm and @xmath84 nm in eq .",
    "( [ eq : debye ] ) .",
    "the set of parameters used to compute the synthetic profiles are summarized in table [ table_0 ] .",
    "different nsr values were obtained by scaling the scattered intensity ( [ eq : tot_i ] ) by a factor @xmath85 .",
    "figure [ fig_2 ] shows the nsr of the synthetic profiles as a function of the scaling factor f ranging from 0 to 2 .",
    "this range contains the nsr values usually measured in experimental profiles    we also considered real data in order to validate our method .",
    "three different samples were prepared with a resultant mean diameter of 2.0 , 3.2 and 4.1 nm , respectively ( as measured by tem ) .",
    "the size distributions were approximately characterized by the same width ( fwhm @xmath86 1 nm ) for all three systems .",
    "powder xrd studies were realized on the xrd beam line at the brazilian synchrotron light facility ( lnls  campinas , brazil ) using 8.040 kev photons at room temperature . for further details",
    "see ref . @xcite .",
    "noisy synthetic xrd patterns were generated corresponding to nanocrystalline samples of increasing size from 2 to 4 nm , and poisson - distributed noise with increasing nsr from 2% to 10% .",
    "the hlsvd ",
    "pro filter was then applied to the noisy synthetic xrd signals in order to study its properties under controlled conditions . a key step in the filtering procedure",
    "is the selection of the number @xmath5 of damped sinusoids characterizing the model function of the hlsvd  pro filter . here",
    ", a possible approach is presented , which is based on the following frequency selection criterion : the singular values @xmath87 , @xmath88 ,",
    "are plotted vs. the corresponding frequencies @xmath14 of the sinusoids in eq .",
    "( [ eq : model ] ) .",
    "this choice facilitates a direct comparison of the results of the proposed filter with those obtained by other filters based on a frequency approach .",
    "it was observed that , generally , crystallographic xrd intensity signals show a clear transition from a low - frequency region , characterized by high singular values @xmath89 to a high - frequency region with small singular values .",
    "the index @xmath5 of the frequency @xmath90 corresponding to the transition , provides the number of damped sinusoids to be used in the hlsvd  pro filter .",
    "figure [ fig_3 ] displays an example of application of the hlsvd  pro filter .",
    "a noisy synthetic xrd intensity profile is shown at the top of the figure .",
    "it corresponds to x - ray scattering from a au sample having a 3 nm size with a poisson - like noise with nsr=10% .",
    "the filtered signal shown in the middle of the figure was obtained by setting @xmath91 in the hlsvd  pro filter .",
    "this value was estimated by visually inspecting the plot of the singular values @xmath87 vs the frequencies @xmath14 ( see top of fig .",
    "( [ fig_4 ] ) ) .",
    "specifically , a transition from high to small @xmath87 was observed at frequency @xmath92 rad@xmath93 which represents the @xmath94 frequency in the set of the sorted frequencies starting from the smallest one .",
    "for a comparison , the discrete fourier transform ( dft ) of the noisy synthetic xrd signal is reported at the bottom of fig .",
    "( [ fig_4 ] ) .",
    "again , a phenomenon of transition from high to small singular values occurs in the same region of the spectrum , as observed at the top of figure .",
    "however , the transition frequency is much more difficult to localize than in the hlsvd  pro filter case .",
    "this makes troublesome the application of dft and wf filters to clean noisy xrd data .",
    "it is worth noting that this difference between the hlsvd  pro and fourier frequency based filters is relevant when the filter is intended to be used during interactive xrd data analysis . in this case",
    "the successful application of a blackbox filter easy - to - use becomes crucial .",
    "coming back to fig .",
    "( [ fig_3 ] ) , the difference between the values of noisy and filtered profiles is shown at the bottom . to quantify the performance of the filter ,",
    "the filtered signal was compared with the noiseless synthetic xrd signal ( see fig .",
    "( [ fig_5 ] ) ) . this can be done only with synthetic signals as experimental xrd data without noise are not available .",
    "the filter performance was evaluated using the measure @xmath95 to give a statistical significance to these measures a monte carlo experiment was carried out .",
    "more precisely , the hlsvd ",
    "pro was applied to 1000 noisy synthetic profiles generated by starting from the same sample size , with different nsrs . for each filtered profile ,",
    "the measure @xmath96 of filter performance was estimated by calculating the mean value and the standard deviation .",
    "table [ table_1 ] summarizes the outcome of the aforementioned monte carlo experiments . for each sample size and nsr ,",
    "the mean and standard deviation are obtained using @xmath97 synthetic xrd intensity profiles with different noise realizations having the same nsr .",
    "the sensitivity to the number @xmath5 of sinusoids of the hlsvd ",
    "pro filter was also studied .",
    "this number was slightly varied around the optimal @xmath5 value selected by using the frequency criterion .",
    "the performance results were compared in order to validate the choice of the optimal @xmath5 value . in particular , @xmath5 was increased and decreased by 2 , as discussed in section i. the results of such a comparison are summarized in table [ table_2 ] and show that the proposed frequency criterion provides the value of @xmath5 corresponding to the best performance of the hlsvd ",
    "pro filter .",
    "the filter was also applied to real xrd intensity profiles of au samples of size 2 , 3.2 and 4.1 nm .",
    "figure [ fig_6 ] shows at top the profile of a 3.2 nm au sample with @xmath98 computed as @xmath99 , where @xmath100 and @xmath80 are vectors with the measured error and the intensity values , respectively .",
    "since in the case of xrd signals the noise follows the poisson distribution , @xmath100 is given by @xmath101 . the result obtained by hlsvd ",
    "pro is displayed in the middle of the figure . at bottom",
    "the plot of singular values is depicted vs. the frequency .",
    "components with a frequency higher than @xmath102 rad@xmath103 , due to noise , were removed .",
    "denoising a real xrd profile of 500 intensity data samples , as typical ones used in the present study , requires about 11 seconds , using matlab 7 on a machine with a intel xeon 1.80 ghz processor and a 512 kb cache size .",
    "a filter based on the hlsvd ",
    "pro method has been presented .",
    "it has been applied to filter xrd patterns of nanocluster powders .",
    "the filter performance has been studied on synthetic and real xrd patterns with different nsrs .",
    "results show that the proposed filter is robust and computationally efficient .",
    "a further advantage is its user - friendliness that makes it a useful blackbox tool for the processing of xrd data .",
    "we thank a. cervellino , c. giannini and a. guagliardi for kindly providing us with experimental xrd data .",
    "b.  mierzwa , j. pielaszek , _ smoothing of low - intensity noisy x - ray diffraction data by fourier filtering : application to supported metal catalyst studies _ ,",
    "1em plus 0.5em minus 0.4emjournal of applied crystallography , * 30 * , 544 - 546 , 1997 .",
    "a.  hieke , h.d . d \" orfler , _ methodical developments for x - ray diffraction measurements and data analysis on lytropic liquid crystals applied to k - soap / glyceral systems _ , 1em plus 0.5em minus 0.4emcolloid polym .",
    "sci . , * 277 * , 762 - 776 , 1999 .",
    "m.  schmidt , s. rajagopal , z. ren , k. moffat , _ application of singular value decomposition to the analysis of time - resolved macromolecular x - ray data _ , 1em plus 0.5em minus 0.4embiophysical journal , * 84 * , 2112 - 2129 , 2002 .",
    "s.  rajagopal , m.schmidt , s. anderson , h. ihee , k. moffat , _ analysis of time - resolved crystallographic data by singular value decomposition _ , 1em plus 0.5em minus 0.4emacta crystallographica , * d60 * , 860 - 871 , 2004 .",
    "h. barkhuijsen , r. de beer , d. van ormondt , _ improved algorithm for noniterative time - domain model fitting to exponentially damped magnetic resonance signals _ ,",
    "1em plus 0.5em minus 0.4emjournal of magnetic resonance , * 73 * , 553 - 557 , 1987 .",
    "t.  laudadio , n.  mastronardi , l.  vanhamme , p.  van hecke and s.  van huffel , _ improved lanczos algorithms for blackbox mrs data quantitation _ ,",
    "1em plus 0.5em minus 0.4emjournal of magnetic resonance , * 157 * , 292 - 297 , 2002 .",
    "siegel , e. hu , d.m .",
    "cox , h. goronkin , l. jelinski , c.c .",
    "koch , j. mendel , m.c .",
    "roco , d.t .",
    "shaw , _ nanostructure science and technolgy . a worldwide study _ , 1em plus 0.5em minus 0.4emthe interagency working group on nanoscience , engineering and technolgy , http://itri.loyola.edu/nano .",
    "a.  cervellino , c.  giannini and a.  guagliardi , _ determination of nanoparticle structure type , size and strain distribution from x - ray data for monoatomic f.c.c .- derived non - crystallographic nanoclusters _ , 1em plus 0.5em minus 0.4emjournal of applied crystallography , * 36 * , 1148 - 1158 , 2003 .",
    ".values of parameters used in eq .",
    "( [ eq : debye ] ) to compute synthetic xrd intensity profiles .",
    "the wavelength and the @xmath104 bulk lattice constant were set to @xmath105 nm and @xmath84 nm , respectively . [ cols=\"^,^,^,^\",options=\"header \" , ]      summarizes the parameters used in eq .",
    "( [ eq : debye ] ) to compute the diffraction intensities .",
    "they are characteristics of au samples .",
    "the wavelength and bulk lattice constant have been set to @xmath83 nm and @xmath84 nm , respectively . from the upper to the lower profile",
    ", the nsr increases from @xmath106 to @xmath107 ( see fig .",
    "[ fig_2 ] and text for details).,title=\"fig:\",scaledwidth=95.0% ] +      ) synthetic xrd intensity profile as a function of the scattering angle @xmath78 ; ( middle ) filtered xrd intensity profile .",
    "the hlsvd ",
    "pro filter removes signal components with frequency above @xmath108 rad@xmath103 ( see fig .",
    "( [ fig_4 ] ) ) ; ( bottom ) difference between measured and filtered profiles.,title=\"fig:\",scaledwidth=95.0% ] +    : ( top ) amplitude of eigenvalues @xmath87 vs. frequency @xmath14 , @xmath88 . the frequency @xmath108 rad@xmath103 was used to separate ( filter ) high frequency components due to noise ; ( bottom ) portion of the dft amplitude spectrum of the noisy synthetic xrd intensity profile .",
    "both plots refer to the xrd intensity profile shown at the top of fig .",
    "( [ fig_3 ] ) .",
    ", title=\"fig:\",scaledwidth=95.0% ] +    : ( top ) noiseless synthetic xrd intensity profile as a function of the scattering angle @xmath78 ; ( bottom ) difference between noiseless and filtered ( see middle plot of fig .",
    "( [ fig_3 ] ) ) profiles.,title=\"fig:\",scaledwidth=95.0% ] +    ; ( middle ) filtered xrd intensity profile .",
    "the hlsvd ",
    "pro filter removes signal components with frequency above @xmath102 rad@xmath103 ; ( bottom ) amplitudes of eigenvalues @xmath87 vs frequency @xmath14 , @xmath109 .",
    ", title=\"fig:\",scaledwidth=95.0% ] +"
  ],
  "abstract_text": [
    "<S> a filter based on the hankel lanczos singular value decomposition ( hlsvd ) technique is presented and applied for the first time to x - ray diffraction ( xrd ) data . </S>",
    "<S> synthetic and real powder xrd intensity profiles of nanocrystals are used to study the filter performances with different noise levels . </S>",
    "<S> results show the robustness of the hlsvd filter and its capability to extract easily and efficiently the useful crystallographic information . </S>",
    "<S> these characteristics make the filter an interesting and user - friendly tool for processing xrd data </S>",
    "<S> .    singular value decomposition , lanczos methods , x - ray diffraction </S>"
  ]
}