{
  "article_text": [
    "a highest - density region ( hdr ) for a measurement of interest is a region where the underlying density function exceeds some nominal threshold . given a random sample from that density , hdr estimation typically involves determination of regions where an estimated density is high .",
    "kernel density estimation is the most common approach , but its performance is heavily dependent on the choice of the bandwidth parameter .",
    "automatic selection of a good bandwidth for hdr estimation is the overarching goal of this article .",
    "figure [ fig : hdrvise ] illustrates the bandwidth selection issue for hdr estimation .",
    "the left panel shows five kernel density estimates based on random samples of size 1000 from the normal mixture @xmath0 density [ density 4 of marron and wand ( @xcite ) ] . in each case",
    "the bandwidth is chosen to minimize the integrated squared error ( ise ) . in the right panel",
    "the same random samples are used , but , instead , the bandwidths are chosen to minimize an error appropriate for estimation of the 20% hdr ( defined formally in section [ sec : asyrisk ] ) .",
    "this region is shown as a thick horizontal line at the base of the plot .",
    "it is clear from figure [ fig : hdrvise ] that optimality for hdr estimation is quite different from ise - optimality .",
    "low ise requires that the two curves be close to each other over the whole real line .",
    "however , good estimation of the 20% hdr only requires that the 20% hdrs of the kernel density estimates are close to the true region .",
    "in particular , the sharp mode of the underlying density has no bearing upon the hdr and there is no need to estimate it well .",
    "for this density it is apparent that a bandwidth considerably larger than ise - optimal bandwidth is best for estimation of the 20% hdr .        in this article",
    "we study an asymptotic risk associated with kernel - based hdr estimation and use our theory to develop a plug - in type bandwidth selector .",
    "attractive asymptotic properties of our bandwidth selector are established and good performance is illustrated on simulated data . a self - contained function for use in the ` r ` environment [ r development core team ( @xcite ) ] is made available on the internet .",
    "the hdr estimation problem has an established literature .",
    "contributions include hartigan ( @xcite ) , mller and sawitzki ( @xcite ) , polonik ( @xcite ) , hyndman ( @xcite ) , tsybakov ( @xcite ) , ballo , cuesta - albertos and cuevas ( @xcite ) , ballo ( @xcite ) , cadre ( @xcite ) , jang ( @xcite ) , rigollet and vert ( @xcite ) and mason and polonik ( @xcite ) . mason and polonik ( @xcite ) provide a thorough literature review for the problem .",
    "alternative terminology includes estimation of the _ density contours _",
    ", _ density level sets _ and _ excess mass regions_. this literature is , however , mainly concerned with theoretical results unconnected with the bandwidth selection problem . jang ( @xcite ) is an applied paper on the use of hdr estimation for astronomical sky surveys .",
    "however , the bandwidths used there are chosen via classical ise - based plug - in strategies .",
    "the present paper is , to our knowledge , the first to derive theory and bandwidth selection rules that are specifically tailored to the hdr estimation problem .",
    "while our proposed practical bandwidth selector relies on asymptotic approximations , its development comes at a time when sample sizes in applications that benefit from smoothing techniques are becoming very large .",
    "the area of application that led to this research , flow cytometry , typically has sample sizes in the hundreds of thousands .",
    "the astronomical application in jang ( @xcite ) involves sample sizes in the tens of thousands .",
    "another hdr application is approximation of the highest posterior density region of a parameter in a bayesian analysis , where only a sample from that density is available . in this situation , the sample ,",
    "most typically obtained using markov chain monte carlo methods , can arbitrarily large in size .",
    "section [ sec : asyrisk ] presents an approximation to the hdr asymptotic risk .",
    "numerical studies support its use for bandwidth selection . in section",
    "[ sec : bwsel ] we describe plug - in strategies for bandwidth selection .",
    "asymptotic performance results are established and a simulation study demonstrates practical efficacy .",
    "we conclude with an example on daily temperature maxima in melbourne , australia .",
    "proofs are deferred to an .",
    "let @xmath1 be a probability density function on the real line . for @xmath2 ,",
    "define @xmath3 we call @xmath4 the @xmath5% _ highest - density region _ of @xmath1 [ cf .",
    "hyndman ( @xcite ) ] .",
    "if @xmath6 is a sequence of independent random variables with density @xmath1 , the kernel estimator of @xmath7 based on @xmath8 is @xmath9 where @xmath10 satisfies @xmath11 , and is called a _ kernel _ and @xmath12 is called the _",
    "bandwidth_. let @xmath13 denote the plug - in estimator of @xmath14 , so that @xmath15 the corresponding plug - in estimator of @xmath16 is then @xmath17 .    given two borel subsets @xmath18 and @xmath19 of @xmath20 , we define their proximity through a measure on their symmetric difference @xmath21 . the particular measure @xmath22 we consider is given by @xmath23 for all borel subsets @xmath24 of @xmath20 .",
    "the error @xmath25 is then then the probability of an observation from @xmath1 lying in precisely one of @xmath26 and @xmath16 .",
    "compared with lebesgue measure , @xmath22 puts more weight on regions where the data will tend to be denser .",
    "it also has the advantage of admitting a simple monte carlo approximation .",
    "this is important in higher - dimensional settings where exact computation of @xmath27 is difficult .",
    "in theorem [ thm : mainthm ] , we derive a uniform - in - bandwidth asymptotic expansion for the _ risk _ @xmath28 , which can facilitate a theoretical , optimal choice of bandwidth ( cf . corollary [ cor : opth ] ) .",
    "this in turn motivates practical bandwidth selection algorithms whose performance is studied in theorems [ thm : hath ] and [ thm : hathho ] .",
    "we will make use of the following conditions on the underlying density , bandwidth sequence and kernel :    1 .",
    "@xmath1 is uniformly continuous on @xmath20 .",
    "there exist finitely many points @xmath29 such that @xmath30 for @xmath31 , and moreover there exists @xmath32 such that @xmath1 is twice continuously differentiable in @xmath33 $ ] with @xmath34 and @xmath35 for @xmath36 .",
    "2 .   let @xmath37 and @xmath38 be nonnegative sequences such that @xmath39 , such that @xmath40 and such that @xmath41 as @xmath42 . then @xmath43 is a sequence with @xmath44 for all @xmath45 .",
    "the kernel @xmath46 is nonnegative , continuously differentiable , of bounded variation , and satisfies @xmath47 and @xmath48 .",
    "moreover , @xmath49 is of bounded variation , and satisfies @xmath50 .",
    "assumption ( a1 ) in particular implies that @xmath1 has a @xmath51-exponent with @xmath52 at level @xmath14in other words , there exists @xmath53 such that @xmath54 for sufficiently small @xmath55 .",
    "this type of assumption is common in the literature for this problem [ cf .",
    "polonik ( @xcite ) , rigollet and vert ( @xcite ) ] .",
    "although there are many parts to condition ( a3 ) , none is very restrictive . under ( a1 )",
    ", @xmath14 is the unique positive real number satisfying @xmath56 .",
    "in fact , in the course of the proof of theorem [ thm : mainthm ] below , we will show that under conditions ( a1 ) , ( a2 ) and ( a3 ) , @xmath57 has an analogous property : that is , with probability one , for all @xmath45 sufficiently large , @xmath57 is the unique positive real number satisfying @xmath58    let @xmath59 and @xmath60 denote the standard normal distribution function and density function , respectively , and write @xmath61 .",
    "define the quantities @xmath62 & & \\hspace*{122pt } { } + \\frac{1}{f_{\\tau } } \\sum_{j=1}^r \\{f'(x_{2j } ) - f'(x_{2j-1})\\ } \\biggr ] , \\nonumber\\\\[-9pt]\\\\[-9pt ] d_2 & = & r(k)f_\\tau \\biggl\\{\\sum_{j=1}^{2r } \\frac{1}{|f'(x_j)| } \\biggr\\}^{-2 } \\sum_{j=1}^{2r } \\frac{1}{f'(x_j)^2 } \\quad\\mbox{and } \\nonumber\\\\[-1pt ] d_{3,j } & = & \\frac{r(k)f_{\\tau } } { |f'(x_j)| } \\biggl\\{\\sum_{k=1}^{2r } \\frac{1}{|f'(x_k)| } \\biggr\\}^{-1},\\qquad j=1,\\ldots,2r.\\nonumber\\end{aligned}\\ ] ]    [ thm : mainthm ] assume , and .",
    "then @xmath63 + o \\biggl(\\frac{1}{(nh)^{1/2 } } + h^2 \\biggr)\\end{aligned}\\ ] ] as @xmath42 , uniformly for @xmath64 $ ] , where @xmath65 and @xmath66    the nature of this result is somewhat different from the results in the existing literature which have tended to focus ( sometimes in more general settings ) on the order in probability or almost surely of @xmath25 or related measures [ e.g. , ballo , cuesta - albertos and cuevas ( @xcite ) , ballo ( @xcite ) ] .",
    "more recent works have derived results on the limiting behavior of suitably scaled and/or centered versions of @xmath25 [ e.g. , cadre ( @xcite ) , mason and polonik ( @xcite ) ] .",
    "rigollet and vert ( @xcite ) provide a finite sample upper bound for the risk , uniformly over certain hlder classes , with an unspecified constant in the bound . while these theoretical results are certainly of considerable interest , our aim in providing the asymptotic expansion in theorem [ thm : mainthm ] is to facilitate practical bandwidth selection algorithms for this problem",
    " see section [ sec : bwsel ] .    in the course of the proof of theorem [ thm : mainthm ]",
    ", it is shown that @xmath67 so that each @xmath68 is positive .",
    "moreover @xmath69 and @xmath70 are nonnegative , and are positive for at least one @xmath71",
    ". indeed , @xmath69 and @xmath70 are certainly positive whenever @xmath72 , where the weights @xmath73 sum to 1 .",
    "however , this condition on @xmath74 is far from necessary for @xmath69 and @xmath70 to be positive .",
    "it is easily seen from theorem [ thm : mainthm ] that for any sequence of bandwidths satisfying  ( a2 ) , if @xmath75 is not bounded away from zero and infinity then @xmath76 along a subsequence . on the other hand ,",
    "if @xmath75 is bounded away from zero and infinity , then @xmath77 is bounded .",
    "notice that all such sequences are permitted by the condition ( a2 ) . focusing our attention on bandwidth sequences of order @xmath78 and substituting @xmath79",
    ", we have @xmath80.\\ ] ] writing this limit as @xmath81 , we see that @xmath82 is continuous on @xmath83 with @xmath84 as @xmath85 and as @xmath86 , so @xmath82 attains its minimum .",
    "if @xmath71 is such that @xmath69 and @xmath70 are positive , then it can be shown ( cf .",
    "the proof of corollary  [ cor : opth ] below ) , that @xmath87 has a unique minimum .",
    "this unique minimizer represents the asymptotically optimal bandwidth for estimating the risk in a small neighborhood of  @xmath88 .",
    "although we typically expect the minimum of @xmath82 to be unique , the complicated nature of the function @xmath82 and the coefficients @xmath68 , @xmath69 and @xmath70 make it difficult to prove this assertion without additional conditions .",
    "the following corollary gives the desired result in one restricted case ; however , we anticipate that the result in fact holds much more widely .",
    "[ cor : opth ] assume and .",
    "assume further that in we have @xmath89 and the underlying density @xmath1 is symmetric about some point on the real line .",
    "then there exists a unique @xmath90 , depending on @xmath1 and @xmath46 but not @xmath45 , such that any sequence of bandwidths @xmath91 that minimizes @xmath92 satisfies @xmath93 as @xmath42 .",
    "the additional hypotheses on @xmath1 imply that @xmath68 , @xmath69 and @xmath70 do not depend on @xmath71 , and in fact in the presence of ( a1 ) and ( a3 ) , the conclusion of the corollary also holds under this ( weaker ) condition , as can be seen from the proof .",
    "theorem [ thm : mainthm ] yields the asymptotic risk approximation @xmath94\\\\[-8pt ] & & \\hspace*{18.8pt } { } + b_{3,j } h^2 \\{2\\phi(b_{2,j } n^{1/2}h^{5/2 } ) - 1\\ } \\biggr].\\nonumber\\end{aligned}\\ ] ]    in section [ sec : bwsel ] we use the right - hand side of ( [ eq : asyrisksim ] ) to develop plug - in bandwidth selection strategies .",
    "however , it is prudent to first assess the quality of this approximation to the risk .",
    "we now do this through some numerical examples .    for a given @xmath1 , @xmath95 and @xmath96 ,",
    "the risk @xmath97 is very difficult to obtain exactly .",
    "instead , we work with a monte carlo approximation , @xmath98 } \\triangle r_\\tau \\bigr),\\ ] ] where @xmath99},\\ldots,\\widehat{r}_{h,\\tau } ^{[m]}$ ] are @xmath100 simulated realisations of @xmath26 . for large @xmath100 ( [ eq : riskmc ] ) serves as reasonable proxy for @xmath101 and is henceforth referred to as the `` exact '' risk .     and its asymptotic approximation for the five of the marron and wand ( @xcite ) density functions .",
    "the panels in the first row are the density functions , and panels in the same column correspond to the same density function . in each panel in the second and third row , the `` exact '' risk , obtained by averaging 100 realisations of @xmath102 , is shown as a solid black curve . the dashed curve is the asymptotic risk approximation corresponding to the right - hand side of ( [ eq : asyrisksim ] ) .",
    "vertical lines pass through the minima of the `` exact '' risk ( solid line ) and the asymptotic risk ( broken line ) .",
    "the second row has @xmath103 and @xmath104 , while the third row has @xmath105 and @xmath106 . ]",
    "figure [ fig : hdrvahdr ] compares the asymptotic risk approximation with its `` exact '' counterpart for @xmath1 corresponding to densities 2 , 4 , 6 , 8 and 10 of marron and wand ( @xcite ) , and @xmath107 and @xmath108 .",
    "the kernel @xmath46 is set to @xmath60 throughout , and the monte carlo sample size is @xmath109 . for most of these densities",
    "the asymptotic risk approximation is quite good for @xmath104 in the bandwidth range of interest .",
    "density 4 is the main exception ; it appears that larger sample sizes are required for the leading terms to be dominant . in particular , for this density , the difficulty appears to be caused by very large values of @xmath110 at the crossing points of @xmath111 ( for density 4 , the level @xmath111 is very close to the rapid transition from shallow to steep gradient seen in the corresponding upper panel in figure [ fig : hdrvahdr ] ) . for several densities",
    ", the estimand @xmath112 corresponds to the fine detail of @xmath1 .",
    "it is perhaps surprising that even with the larger sample size , the asymptotic risk approximation is not always that accurate , though in some cases the approximation is very good indeed .",
    "in this section , we assume that , as in corollary [ cor : opth ] , there exists a unique @xmath90 such that any optimal bandwidth sequence satisfies @xmath113 . in this case , @xmath114 minimizes the asymptotic risk given by @xmath115.\\ ] ] in order to find a practical bandwidth selector , we seek an estimator @xmath116 of @xmath114 . the natural way to construct such an estimator is by using estimators @xmath117 , @xmath118 and @xmath119 of @xmath120 , @xmath121 and @xmath122 , respectively , to obtain plug - in estimators @xmath123 , @xmath124 and @xmath125 of @xmath68 , @xmath69 and @xmath70 , respectively .",
    "these in turn can be used to find @xmath126 , where @xmath127.\\ ] ] with probability one , the solution to this minimization problem will be unique for large @xmath45 provided that @xmath128 and this solution can easily be found numerically .",
    "our final bandwidth selector is then @xmath129 .",
    "note that we have not yet described how to construct the estimators @xmath117 , @xmath118 and  @xmath119 .",
    "again , we propose plug - in estimators based on estimates of @xmath14 as well as @xmath130 and @xmath74 for @xmath31 .",
    "we assume the kernel @xmath46 is smooth , and will construct kernel estimators @xmath131 , @xmath132 and @xmath133 of @xmath14 , @xmath130 and @xmath74 , respectively , where @xmath134 is an estimator of @xmath88 described below . for the time being , we will use the same kernel @xmath46 in all cases ; this requirement will be dropped later on . even at this stage",
    "it will , however , be important to note that we can use different bandwidths @xmath135 , @xmath136 and @xmath137 . recall [ e.g. , wand and jones ( @xcite ) , page 49 ] that , under appropriate conditions , if @xmath138 as @xmath42 then @xmath139 and that this order can not be improved for a nonnegative kernel . here",
    "we have used the notation @xmath140 as @xmath42 to mean @xmath141 .",
    "finally , we observe that if @xmath135 satisfies ( a2 ) , then with probability one , for all sufficiently large @xmath45 there exist @xmath142 such that @xmath143 for each @xmath71 , and we use @xmath134 to estimate @xmath88 .",
    "our theoretical study of the performance of this bandwidth selector requires some additional conditions :    1 .",
    "@xmath1 has four continuous derivatives in an open set containing each @xmath88 ; 2 .",
    "@xmath144 , @xmath145 and @xmath146 as @xmath42 ; 3 .",
    "@xmath46 has a bounded third derivative , @xmath147 is of bounded variation and @xmath148 .",
    "[ thm : hath ] assume and .",
    "assume further that @xmath149 is unique and that @xmath128",
    ". then @xmath150 as @xmath42 . moreover , recalling that @xmath151 , we have @xmath152    examining the proof of theorem [ thm : hath ] reveals that the rate of convergence to zero of the relative error of @xmath153 is determined by the rate at which we can estimate @xmath74 for @xmath31 .",
    "this suggests that we might be able to obtain a faster rate of convergence by using a higher order kernel to estimate @xmath74 [ and in fact @xmath130 ] .",
    "recall that we call @xmath46 an _",
    "@xmath155th order kernel _ if :    1 .",
    "@xmath156 ; 2 .",
    "@xmath157 for @xmath158 ; 3 .",
    "@xmath159 and @xmath160 .",
    "higher order kernels refer to @xmath161 .",
    "the usual objection to the use of higher order kernels , namely that such a kernel can not be nonnegative , is less significant when the aim is to estimate derivatives of a density rather than the density itself .",
    "let the kernels used to estimate @xmath130 and @xmath74 be denoted @xmath162 and @xmath163 , respectively , and continue to denote the respective bandwidths by @xmath136 and @xmath137 .",
    "an improved rate of convergence of the relative error of our bandwidth selector can be obtained by replacing conditions ( a4 ) , ( a5 ) and ( a6 ) with the following :    1 .",
    "@xmath1 has 12 continuous derivatives in an open set containing each @xmath88 .",
    "@xmath144 , @xmath164 and @xmath165 as @xmath42 .",
    "3 .   @xmath162 is a @xmath166th order kernel and has a bounded second derivative with @xmath162 and @xmath167 of bounded variation and satisfying @xmath168 .",
    "moreover , @xmath163 is a @xmath169th order kernel and has a bounded third derivative with @xmath163 , @xmath170 and @xmath171 of bounded variation and satisfying @xmath172 for the bandwidth selector obtained in a similar way to @xmath173 , but using the kernels @xmath162 and @xmath163 to estimate @xmath130 and @xmath74 , respectively , in the definitions of @xmath120 , @xmath121 , @xmath122 , @xmath68 , @xmath69 and @xmath70 .",
    "[ thm : hathho ] assume , and .",
    "assume further that @xmath149 is unique and that @xmath128 .",
    "then @xmath174 as @xmath42 . moreover , writing @xmath175 , we have @xmath176    it is clear that theorem [ thm : hath ] represents a relatively weak conclusion under relatively weak conditions , while theorem [ thm : hathho ] represents a stronger conclusion under strong conditions .",
    "intermediate results are also possible but seem to be of little practical interest .      we confine our development of a practical consistent bandwidth selector to the scenario where @xmath1 satisfies weaker smoothness conditions of theorem [ thm : hath ] . our end - product is a fast - to - compute bandwidth selector for hdr estimation that possesses the asymptotic properties conveyed by theorem [ thm : hath ] , performs well in simulations and is readily implemented in  ` r ` . indeed , as detailed below , an ` r ` function for our procedure is available on the internet .",
    "the pilot bandwidths @xmath135 , @xmath136 and @xmath137 are estimated using direct plug - in strategies with two levels of kernel functional estimation .",
    "chapter 3 of wand and jones ( @xcite ) provides details on this general approach to bandwidth selection . in the case of @xmath135",
    "the approach is similar to those proposed by park and marron ( @xcite ) and sheather and jones ( @xcite ) .",
    "direct plug - in bandwidth selection strategies for density functions and their derivatives involve estimation of functionals of the form @xmath177 kernel estimators of @xmath178 take the form @xmath179 where @xmath180 is a sufficiently smooth 2nd - order kernel function , and @xmath181 is a bandwidth parameter .",
    "multi - level plug - in strategies use the fact that the asymptotically optimal @xmath82 , with respect to the mean squared error of @xmath182 , is @xmath183^{1/(r+3)}$ ] . to get the algorithm started we also require _ normal scale _ estimates of @xmath178 , based on the assumption that @xmath1 is a @xmath184 density .",
    "normal scale estimates of @xmath178 take the form @xmath185 throughout we take @xmath186 , the standard normal kernel .",
    "the full algorithm is :    1 .",
    "the inputs are the random sample @xmath8 and parameter @xmath187 specifying the required hdr .",
    "2 .   let @xmath188 be a robust estimate of scale .",
    "( the interquartile range for the standard normal density is approximately @xmath189 , so this factor ensures approximate unbiasedness for normally distributed data . )",
    "estimate @xmath190 , @xmath191 and @xmath192 using normal scale estimates .",
    "explicit expressions for these are @xmath193 , @xmath194 and @xmath195 .",
    "4 .   estimate @xmath196 , @xmath190 and @xmath191 using kernel estimates @xmath197 , @xmath198 and @xmath199 where @xmath200 , @xmath201 and @xmath202 . 5 .",
    "estimate @xmath203 , @xmath196 and @xmath190 using kernel estimates @xmath204 , @xmath205 and @xmath206 where @xmath207^{1/7}$ ] , @xmath208^{1/9}$ ] and @xmath209^{1/11}$ ] .",
    "obtain direct plug - in bandwidths @xmath210 for estimation of @xmath211 by replacing @xmath212 in the optimal expression , with respect to asymptotic mean integrated squared error , by @xmath213 .",
    "explicit expressions are @xmath214^{1/5}$ ] , @xmath215^{1/7}$ ] and @xmath216^{1/9}$ ] .",
    "obtain pilot of estimates of @xmath1 , @xmath217 and @xmath218 via gaussian kernel estimates based on these bandwidths : @xmath219 , @xmath220 and @xmath221 .",
    "use @xmath222 to obtain pilot estimates of @xmath14 , @xmath223 and @xmath224 .",
    "substitute the estimates from steps [ step6 ] and [ step7 ] into the expressions for @xmath68 , @xmath69 and @xmath70 to obtain estimates @xmath225 , @xmath226 and @xmath227 .",
    "the selected bandwidth for gaussian kernel estimation of the @xmath228 hdr is @xmath229 where @xmath230 , where @xmath231 was defined in ( [ eq : hatcopt ] ) .",
    "binned approximations to @xmath182 [ cf .",
    "gonzlez - manteiga , sanchz - sellero and wand ( @xcite ) ] are strongly recommended to allow fast processing of large samples .",
    "an ` r ` function ` hdrbw ( ) ` that implements the above algorithm has been included in the package ` hdrcde ` [ hyndman ( @xcite ) ] which supports hdr estimation .",
    "we ran a simulation study in which the performance of @xmath232 was compared with an established ise - based selector : least squares cross validation [ rudemo ( @xcite ) , bowman ( @xcite ) ] which we denote by @xmath233 .",
    "the number of replications in the simulation study was 250 .",
    "the hdr estimation error @xmath234 was used throughout the study . figures [ fig : bwsimd4n1000 ] ( @xmath104 ) and [ fig : bwsimd4n100000 ] ( @xmath106 ) summarise the results for the situation where the true @xmath1 is the normal mixture density from section [ sec : intro ] and figure [ fig : hdrvise ] .",
    "the improvement gained from using the hdr - tailored bandwidth selector is apparent from the graphics , especially for the lower values of @xmath96 .",
    "wilcoxon tests applied to the error ratios showed statistically significant improvement of @xmath173 at the 5% level for @xmath235 and @xmath236 when @xmath106 . for @xmath104 , @xmath173 performed better for @xmath237 , while @xmath233 did better for @xmath238 .",
    "this latter result is not a big surprise since good estimation of @xmath112 requires good estimation of the finger - shaped modal region and this , in turn , requires good ise performance .     and @xmath239 for @xmath237 and @xmath236 and 250 samples of size 1000 generated from density 4 of marron and wand ( @xcite ) .",
    "the upper panels are scatterplots of the errors @xmath25 for @xmath240 on the vertical axes and @xmath241 on the horizontal axes .",
    "the lower panels are kernel density estimates of @xmath242 . ]     and @xmath239 for @xmath237 and @xmath236 and 250 samples of size 100000 generated from density 4 of marron and wand ( @xcite ) .",
    "the upper panels are scatterplots of the errors @xmath25 for @xmath240 on the vertical axes and @xmath241 on the horizontal axes .",
    "the lower panels are kernel density estimates of @xmath243 . ]",
    "we performed similar simulation comparisons for the remaining densities 110 of marron and wand ( @xcite ) .",
    "for @xmath104 the performance of @xmath173 was better than @xmath233 for densities 15 ; whereas @xmath233 did better for densities 610 .",
    "this suggests that the asymptotics on which @xmath173 relies have not `` kicked in '' at @xmath104 for these more intricate density functions .",
    "we suspect that more sophisticated pilot estimation might improve matters for hdr - based bandwidth selection for lower sample sizes .",
    "the @xmath106 simulations show superior performance of @xmath173 , especially @xmath238 where it is the `` winner '' for 9 out of the 10 density functions .",
    "the overarching conclusion is that for common density estimation situations @xmath173 is better than @xmath233 .",
    "we conclude with an application to data on daily maximum temperatures in melbourne , australia , for the years 19811990 .",
    "these data were used in hyndman ( @xcite ) to illustrate hdr principles .",
    "we revisit them armed with the automatic hdr estimation technology described in section [ sec : pracalg ] . of interest",
    "are the conditional densities of tomorrow s temperature _ given _",
    "today s temperature is within a fixed interval .",
    "the intervals for the `` today s temperature '' values are , in degrees celsius , @xmath244 figure [ fig : melbmaxhdr ] shows the kernel    . ]",
    "estimates of the 20% , 50% and 80% hdrs with bandwidths chosen using the rule @xmath173 as detailed in section [ sec : pracalg ] .",
    "some interesting bimodality in `` tomorrow s temperature '' is apparent when conditioned on today s temperature being in the 3040 degrees celsius range .",
    "throughout the proof , it is convenient to write @xmath245 and @xmath246 and adopt the convention that @xmath247 and @xmath248 for all @xmath249 . observe that @xmath250 so that @xmath251 the main idea of the proof is that the dominant contribution to @xmath97 comes from a union of @xmath252 small intervals , one near each @xmath88 , where @xmath253 is close to @xmath254 . in each of these intervals",
    ", we can represent @xmath255 by a sample mean of independent and identically distributed random variables and a small additional remainder term , and hence apply a normal approximation to deduce the result .",
    "for clarity of exposition , we now split the proof into several steps :    [ step1 ] as a preliminary step , let @xmath256 be another uniformly continuous density , and let @xmath257 .",
    "writing @xmath258 for the supremum norm on the real line , we show that there exists @xmath259 such that for all @xmath55 sufficiently small , we have @xmath260 whenever @xmath261 . to see this ,",
    "let @xmath262 and choose @xmath263 .",
    "the inverse function theorem [ burkill and burkill ( @xcite ) , theorem 7.51 ] gives that for @xmath264 with @xmath265 sufficiently small , we can write @xmath266\\ ] ] with @xmath267 as @xmath268 .",
    "it follows that when @xmath55 is sufficiently small , and @xmath269 , we have @xmath270 thus @xmath271 .",
    "a very similar argument yields the upper bound @xmath272 , and this completes step [ step1 ] .",
    "now , for @xmath32 small enough that @xmath1 has two continuous derivatives in @xmath273 $ ] , let @xmath274 denote the supremum norm restricted to @xmath275 .",
    "it will be helpful in step [ step4 ] to note that a small modification of the above argument may be used to prove that if @xmath276 and @xmath277 are sufficiently small , and if @xmath278 as @xmath279 , then @xmath280 as @xmath281 we show that for each fixed @xmath32 , @xmath282\\\\[-8pt ] & & \\qquad { } + \\sum_{j=1}^r \\int_{x_{2j-1}+\\delta } ^{x_{2j}-\\delta } f(x ) \\mathbb{p}\\bigl(\\widehat{f}_h(x ) < \\widehat{f}_{h,\\tau } \\bigr ) \\,dx = o(n^{-1})\\nonumber\\end{aligned}\\ ] ] as @xmath42 .",
    "in fact , we claim ( and it will be straightforward to see ) that the error term is of the stated order uniformly for @xmath64 $ ] .",
    "indeed , we make a similar claim for every error term in each expression below where the bandwidth @xmath95 appears , but we do not repeat this assertion in future occurrences . as in step [ step1 ] , observe that under ( a1 ) , if @xmath283 is sufficiently small , then there exists @xmath55 such that @xmath284 for @xmath285 $ ] and @xmath286 for @xmath287 $ ] . by reducing @xmath32 if necessary , for @xmath285 $ ] , @xmath288 where",
    "we have used the result of step [ step1 ] in the last inequality , and @xmath24 is the constant defined in that step .",
    "a very similar argument yields the same upper bound for @xmath289 when @xmath290 $ ] .",
    "now , since @xmath1 is uniformly continuous under ( a1 ) , @xmath291 as @xmath42 .",
    "the inequality ( [ eq : basicineq ] ) , together with the observation ( [ eq : bias ] ) on the bias of @xmath292 , yields that for @xmath45 sufficiently large , @xmath293 for some @xmath294 . here",
    ", the final inequality is an application of corollary 2.2 of gin and guillou ( @xcite ) ( a consequence of talagrand s inequality ) to the vapnik ",
    "cervonenkis class of functions @xmath295 [ cf .",
    "dudley ( @xcite ) , theorems 4.2.1 and 4.2.4 ] .",
    "equation ( [ eq : nonmargin ] ) follows immediately , and this completes the proof of step [ step2 ] .",
    "[ step3 ] we show that ( [ eq : nonmargin ] ) continues to hold if @xmath296 is replaced by a sequence @xmath297 converging to zero , provided that @xmath298 slowly enough that @xmath299 and @xmath300 . in order to complete the proof of step [ step3 ]",
    ", it suffices to show that there exists @xmath32 such that @xmath301 we may assume @xmath32 is small enough that @xmath1 has two continuous derivatives in  @xmath302 .",
    "this enables a straightforward modification to the argument in ( [ eq : bias ] ) using a taylor expansion , leading to @xmath303 now there exists a constant @xmath304 small enough that if we take @xmath305 , then we have @xmath306 when @xmath307 .",
    "moreover , @xmath308 , so that for @xmath45 sufficiently large , the same argument as in step [ step2 ] yields @xmath309 this completes the proof of step [ step3 ] .",
    "[ step4 ] we seek asymptotic expansions for @xmath310 and @xmath311 . to this end ,",
    "for uniformly continuous densities @xmath256 that are twice continuously differentiable in @xmath302 , and for @xmath312 , we define @xmath313 the reason for making this definition is that by examining the behavior of @xmath314 under small changes of its arguments from @xmath315 , we will be able to study the difference @xmath316 in ( [ eq : probbound ] ) below .",
    "first , for @xmath55 sufficiently small , @xmath317 as @xmath318 .",
    "a very similar argument shows that the error term is of the same order as @xmath319 .",
    "observe that when @xmath320 and @xmath321 are sufficiently small , @xmath322 has a nonzero derivative in a neighborhood of each @xmath88 .",
    "it follows that for sufficiently small values of @xmath323 , we can write @xmath324,\\ ] ] where @xmath325 .",
    "moreover , provided that @xmath326 and @xmath327 as @xmath328 , we have that @xmath329 as @xmath330 .",
    "thus we can write @xmath331 as @xmath332 . assuming that @xmath333 and that the above conditions on @xmath82 hold , we have from ( [ eq : partial1 ] ) and ( [ eq : partial2 ] ) that @xmath334\\\\[-8pt ] & = & - \\{\\tilde{f}_{\\tau } - f_{\\tau } \\ } f_{\\tau } \\sum_{j=1}^{2r } \\frac{1}{|f'(x_j)| } + f_{\\tau } \\sum_{j=1}^{2r } \\frac{g(x_j)}{|f'(x_j)| } + \\sum_{j=1}^r \\int_{x_{2j-1}}^{x_{2j } } g(x ) \\,dx \\nonumber\\\\ & & { } + o \\biggl\\ { \\biggl(\\sum_{j=1}^{2r } |g(x_j)| \\biggr)^2 + \\|g'\\|_{i_\\delta,\\infty}\\sum_{j=1}^{2r } |g(x_j)| \\biggr\\}\\nonumber\\end{aligned}\\ ] ] as @xmath332 .",
    "we want to apply ( [ eq : puttogether ] ) with @xmath335 , so that @xmath336 . in order to do this , we must recall observation ( [ eq : bias ] ) on the bias of @xmath292 , and the fact that @xmath337 from an application of corollary 2.2 of gin and guillou ( @xcite ) .",
    "it follows that @xmath338 .",
    "similarly , @xmath339 , and a further application of corollary 2.2 of gin and guillou ( @xcite ) gives @xmath340 .",
    "thus @xmath341 .",
    "this in turn implies that with probability one , for @xmath45 sufficiently large , @xmath57 is the unique solution to @xmath342 , or equivalently @xmath343 , as claimed in section [ sec : asyrisk ] .",
    "it remains to note that @xmath344 and @xmath345    it follows that we can now substitute @xmath336 in ( [ eq : puttogether ] ) to deduce that @xmath346 equation ( [ eq : probbound ] ) shows that we can write the difference @xmath347 as a sample mean of independent and identically distributed random variables and a small additional remainder term .",
    "notice from the bandwidth condition on @xmath348 in ( a2 ) that @xmath349 .",
    "next , observe that @xmath350 where @xmath120 is given in ( [ eq : d1d2d3 ] ) .",
    "thus , in order to prove that @xmath351 it suffices by ( [ eq : puttogether ] ) and step [ step1 ] to show that for any @xmath352 , @xmath353 but this follows by cauchy  schwarz , because step [ step1 ] may be used to show that @xmath354 , and also @xmath355 we therefore deduce ( [ eq : expexpansion ] ) .    in a very similar way",
    ", we can also use ( [ eq : puttogether ] ) and the fact that @xmath356 where @xmath121 is given in ( [ eq : d1d2d3 ] ) , to deduce that @xmath357    [ step5 ] we can use the results of step [ step4 ] to shrink the region of interest still further . from the result of step [ step3 ]",
    "we can write @xmath358 for brevity , we write @xmath359 . now , for each @xmath31 , we see that for @xmath45 sufficiently large , @xmath360 is a strictly monotone function of @xmath361 $ ] , with a unique zero @xmath362 , say . moreover ,",
    "@xmath363 fix a sequence @xmath364 diverging to infinity and let @xmath365 \\setminus[t_j^ * - t_n , t_j^ * + t_n]$ ] .",
    "we claim that @xmath366\\\\[-8pt ] & & \\hspace*{26.6pt } { } + \\int_{i_{2j}^n } \\bigl|\\mathbb{p}\\bigl(\\widehat{f}_h(x_{2j}^t ) <",
    "\\widehat{f}_{h,\\tau } \\bigr ) - { \\mathbh}{1}_{\\{t \\geq0\\}}\\bigr| \\,dt \\biggr\\ } \\rightarrow0\\nonumber\\end{aligned}\\ ] ] as @xmath42 .",
    "now there exists @xmath367 such that for all @xmath368 and @xmath45 sufficiently large , we have @xmath369 .",
    "thus there exists @xmath370 such that for all @xmath45 sufficiently large , @xmath371 & & \\qquad\\leq\\mathbb{p } \\biggl ( \\biggl|\\frac{\\widehat{f}_h(x_{2j-1}^t ) - \\mathbb{e}\\{\\widehat{f}_h(x_{2j-1}^t)\\}}{\\operatorname{var}^{1/2 } \\{\\widehat{f}_h(x_{2j-1}^t)\\ } } \\biggr| \\geq",
    "c_4 t_n \\biggr)\\\\[-0.8pt ] & & \\qquad\\quad { } + \\mathbb{p } \\biggl ( \\biggl|\\frac{\\widehat{f}_{h,\\tau } - \\mathbb{e}(\\widehat{f}_{h,\\tau } ) } { \\operatorname{var}^{1/2 } ( \\widehat{f}_{h,\\tau } ) } \\biggr| \\geq c_4t_n \\biggr ) \\rightarrow0,\\end{aligned}\\ ] ] uniformly for @xmath372 . since also @xmath373 uniformly for @xmath374 , we deduce ( [ eq : ijn ] ) .",
    "[ step6 ] we also require an asymptotic expansion for @xmath375 , for @xmath376 $ ] .",
    "in fact , provided @xmath364 diverges sufficiently slowly , we have @xmath377 uniformly for @xmath378 $ ] , where @xmath122 is given at ( [ eq : d1d2d3 ] ) .",
    "this follows from the expansion ( [ eq : puttogether ] ) and the fact that provided @xmath364 diverges sufficiently slowly , @xmath379 & & \\qquad= \\frac{1}{h } \\int_{-\\infty}^\\infty k(z)k \\biggl(\\frac{(nh)^{-1/2}t + hz}{h } \\biggr)f(x_j - hz ) \\,dz \\\\[-0.8pt ] & & \\qquad= \\frac{1}{h}f_{\\tau } r(k ) + o(h^{-1}),\\end{aligned}\\ ] ] uniformly for @xmath378 $ ] .",
    "[ step7 ] to complete the proof of theorem [ thm : mainthm ] , it suffices by ( [ eq : continuation ] ) and ( [ eq : ijn ] ) to show that there exists a sequence @xmath364 diverging to infinity such that @xmath380 & & \\hspace*{64.4pt } { } + \\int_{t_{2j}^ * - t_n}^{t_{2j}^ * + t_n } \\bigl|\\mathbb{p}\\bigl(\\widehat{f}_h(x_{2j}^t ) < \\widehat{f}_{h,\\tau } \\bigr ) - { \\mathbh}{1}_{\\{t \\geq0\\}}\\bigr| \\,dt \\biggr\\ } \\\\[-0.8pt ] & & \\qquad= \\sum_{j=1}^{2r } \\biggl[\\frac{b_{1,j}\\phi(b_{2,j } n^{1/2}h^{5/2})}{(nh)^{1/2 } } + b_{3,j } h^2 \\{2\\phi(b_{2,j } n^{1/2}h^{5/2 } ) - 1\\ } \\biggr]\\\\[-0.8pt ] & & \\qquad\\quad { } + o \\biggl(\\frac{1}{(nh)^{1/2 } } + h^2 \\biggr).\\end{aligned}\\ ] ] for @xmath381 , let @xmath382 and let @xmath383 , where @xmath384.\\end{aligned}\\ ] ] by ( [ eq : puttogether ] ) and ( [ eq : probbound ] ) , we can write @xmath385 , where @xmath386 . since @xmath387 uniformly for @xmath376 $ ] , we choose @xmath364 to diverge to infinity so slowly that :    * @xmath388 , uniformly for @xmath376 $ ] ; * @xmath389 , uniformly for @xmath376 $ ] ; * @xmath390 , uniformly for @xmath391 $ ] , where @xmath392 ; * @xmath393 .    then @xmath394 uniformly for @xmath378 $ ] . here",
    "we have used the berry  esseen inequality to reach the penultimate line .",
    "a very similar argument yields a lower bound of the same order .",
    "the proof of step [ step7 ] , and hence the proof of theorem [ thm : mainthm ] , is now completed by the observation that @xmath395.\\end{aligned}\\ ] ]      we may restrict attention to the case where @xmath75 is bounded away from zero and infinity . the important point to note",
    "is that under the hypotheses of the corollary , @xmath68 , @xmath69 and @xmath70 do not depend on @xmath71 , so we write them as @xmath396 , @xmath397 and @xmath398 , respectively .    by making the substitution @xmath399 ,",
    "there exist positive constants @xmath400 and @xmath401 such that @xmath402 , where @xmath403 . since @xmath404 is continuous with @xmath405 as @xmath406 and @xmath86 , it attains its minimum in @xmath83 . to show this minimum is unique",
    ", it suffices to show that @xmath407 has a unique zero in @xmath83 , where @xmath408 now we have @xmath409 there are therefore two cases to consider : if @xmath410 , then @xmath411 is strictly convex , so since @xmath412 and @xmath413 as @xmath86 , we see that @xmath411 has a unique zero in @xmath83 . on the other hand , if @xmath414 , then there exists @xmath415 such that @xmath416 for @xmath417 and @xmath418 for @xmath419 .",
    "but if @xmath414 then @xmath420 , for sufficiently small @xmath421 , so from @xmath422 , it again follows that @xmath411 has a unique zero .",
    "write @xmath423 for the unique minimum of @xmath404 in @xmath83 , and let @xmath424 .",
    "we conclude that any optimal bandwidth sequence @xmath91 , in the sense of minimizing @xmath28 , must satisfy @xmath425 as @xmath42 .",
    "we require a bound on @xmath426 for @xmath31 . to this end , let @xmath427 be another density satisfying the same conditions as  @xmath1 . from step [ step4 ] of the proof of theorem [ thm : mainthm ] , we see that for sufficiently small values of @xmath428 , there exist precisely @xmath252 values @xmath429 such that @xmath430 .",
    "moreover , provided @xmath431 as @xmath328 , we have @xmath432 as @xmath433 . substituting @xmath434 , so that @xmath435 and @xmath436 , we have @xmath437 .",
    "it follows that @xmath438 , the crucial fact being that @xmath439 .",
    "similarly , @xmath440 and @xmath441 for @xmath31 .",
    "thus @xmath442 , @xmath443 and @xmath444 .",
    "we deduce that for any @xmath445 , we have @xmath446 , uniformly for @xmath447 $ ] , and a standard taylor expansion argument then gives that @xmath448 .",
    "both conclusions of the theorem follow immediately .",
    "let @xmath449 , where @xmath296 is small enough that @xmath1 has 12 continuous derivatives in @xmath450 $ ] . under the conditions of the theorem",
    ", we may integrate by parts twice and apply a taylor expansion to obtain @xmath451 this expression for the bias can be combined with the standard fact that @xmath452 and the bound on @xmath426 from the proof of theorem [ thm : hath ] to yield @xmath453 .",
    "similar computations give @xmath454 .",
    "the rest of the proof mirrors the proof of theorem [ thm : hath ] .",
    "the authors are grateful to tarn duong , inge koch , steve marron and richard nickl for their comments on aspects of this research , and to the organizers of a workshop on statistical research held at the keystone resort , colorado , usa , on 4th8th june , 2007 ."
  ],
  "abstract_text": [
    "<S> we study kernel estimation of highest - density regions ( hdr ) . </S>",
    "<S> our main contributions are two - fold . </S>",
    "<S> first , we derive a uniform - in - bandwidth asymptotic approximation to a risk that is appropriate for hdr estimation . </S>",
    "<S> this approximation is then used to derive a bandwidth selection rule for hdr estimation possessing attractive asymptotic properties . </S>",
    "<S> we also present the results of numerical studies that illustrate the benefits of our theory and methodology .    and    .    </S>"
  ]
}