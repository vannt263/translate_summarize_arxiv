{
  "article_text": [
    "two types of hydrodynamic codes are currently in use for cosmological applications : mesh based codes pioneered by vishniac and co - workers ( chiang , ryu , & vishniac 1989 ; ryu , vishniac , & chiang 1990 ) and cen and co - workers ( cen 1990 ; cen 1992 ) and used by several groups including a tvd (  total vaviation diminishing \" ) variant ( ryu 1993 ) or a ppm (  piecewise parabolic method \" ) variant ( bryan 1995 ) , and , alternatively , particle based smooth particle hydrodynamics codes (  sph \" ) used by a variety of groups ( evrard 1988 ; hernquist & katz 1989 ; steinmetz 1996 ; owen 1998a ) .",
    "the latter codes can concentrate computational resources into the highest density regions of greatest interest , but they suffer in low density regions , at caustics , and , due to the large computational overhead , they have relatively small particle number and hence have relatively poor mass resolution which can induce two body relaxation even in the high density regions ( @xcite ; @xcite ) .    but the mesh codes also have , along with their virtues of accurate treatment of shocks and caustics , good mass resolution , known accuracy and convergence properties etc , quite serious weaknesses , the primary among them being poor spatial resolution in the high density regions . a detailed comparison of five codes ",
    "three independent mesh codes and two independent sph codes comparing the virtues and details of the two approaches was presented in kang ( 1994b ) .",
    "another major such comparative project was completed recently ( frenk 1998 ) with a still wider range of codes being tested .",
    "what is the accuracy of a mesh code in resolving structures comparable to or smaller than the mesh size ?",
    "a quantitative assessment of this in the cosmological context was presented by cen ( 1992 ) for an aerodynamics - based cosmological hydrodynamic code , which has an effective artificial viscosity of known properties .",
    "anninos & norman ( 1996 ) did some very interesting convergence tests on x - ray clusters by varying numerical resolution using a multi - grid eulerian hydrocode .",
    "bryan & norman ( 1998 ) examined resolution effect on various quantities related to simulated x - ray clusters using ppm eulerian code ( bryan 1995 ) .",
    "owen ( 1998b ) have studied various scaling properties in scale - free ( @xmath2 ) , adiabatic sph simulations . in the present paper",
    "we examine the tvd shock capturing code originally developed by harten ( 1984 ) and reformulated with gravity for high mach number , cosmological applications by ryu ( 1993 ) .",
    "this code has been used by cen , ostriker and co - workers to study the properties of x - ray clusters of galaxies and lyman alpha clouds , and is being used for work on galaxy formation .",
    "the primary result , which we find , can be stated simply . in general",
    ", the code smooths structure with a gaussian filter @xmath14 such that @xmath15 where @xmath7 is the cell size and @xmath16 is the number which we are interested in fixing through empirical experiments . smoothing separately in the three directions , @xmath17 .",
    "alternatively phrased , an object of true gaussian radius @xmath18 will have computed radius @xmath19 @xmath20 where @xmath21 where the coefficient @xmath22 comes from the fact that our fitted radius ( i.e. , core ) is defined at a location where the density drops to half the central value .",
    "an important , new finding from the current study is that the tvd shock - capturing code has different resolutions in different regions .",
    "we find that the code has a resolution of @xmath23 cells ( i.e. , @xmath24 ) near shock fronts , while its resolution in non - shocking , high density regions is lower than in the shock fronts , @xmath25 .",
    "since the scheme has been optimized for capturing shocks ( rather than , for example , contact discontinuities ) , we should not be surprised by this variation .",
    "the paper is organized as follows :  2 describes the computations to derive the empirical resolution of the code , ",
    "3 presents an application of the results to previous published simulations using the tvd code and  4 gives conclusions .",
    "an extremely difficult aspect of this problem is to design a test , with a known , analytically computable solution , that is also sufficiently realistic to have a bearing on the problems of astrophysical interest : in this case the properties of x - ray clusters .",
    "n. kaiser and also s. white have pointed out to us that , if the initially assumed spectrum of density perturbations were a power law , with @xmath26 being the most appropriate choice , then for @xmath27 , some strict scaling relations must hold in a perfect simulation . specifically , if one were to look at a given population , e.g. , the most massive @xmath28 of the bound objects in the universe , then ( see kaiser 1986 ) in an adiabatic calculation , their characteristic sizes should scale as @xmath29 and their average temperatures scale as @xmath30 . in our recent simulations of various specific models for the growth of structure",
    "we did not find that these scaling laws were very well satisfied . examining figures ( 11 ) and ( 12 ) of kang ( 1994a ; kcor hereafter )",
    "we see that the expected scaling law for the temperature is satisfied to sufficient accuracy ( given the observed statistical fluctuations due to the relatively small computed sample of clusters ) , but the cluster radius evolution is significantly less steep than is expected .",
    "there are a variety of potential explanations for these facts .",
    "three of the most plausible ones are as follows .",
    "the actual spectrum of the studied cdm model is not fit by @xmath2 with sufficient precision to make self - similarity an expected outcome .",
    "resolution corrections due to numerical inaccuracy are redshift dependent and account for the departure from the expected scaling .",
    "the displayed sample was chosen to be of fixed luminosity : @xmath31erg / s , which is not a sample defined in a scale free way .    to see which , if any , of these explanations is true , and to better enable us to make appropriate resolution corrections , we computed two new simulations of a power law spectrum @xmath26 of initial density perturbations with ( @xmath0 cells , @xmath1 particles ) and ( @xmath1 cells , @xmath32 particles ) , respectively .",
    "a simulation box of size of @xmath33mpc comoving is used in both simulations , giving a cell size and nominal resolution of ( @xmath34kpc comoving , @xmath35kpc comoving ) , respectively .",
    "other parameters , in the familiar notation , were chosen to be @xmath36 , @xmath37 , @xmath38 , @xmath39 to correspond well to prior work . to ensure that the  truth \" remains the same in the two simulations ,",
    "the initial realizations in the two simulations are exactly the same , with the power spectrum being cut off at the nyquist frequency of the @xmath1 box for both simulations ( a smooth but rather sharp filter , @xmath40^{1/4}$ ] , is applied to the power law spectrum to minimize real space oscillations but maintain the power law slope as closely as we can ) .",
    "figure 1 shows the redshift dependence of the temperature ( equally weighted ) of the absolutely brightest clusters defined in scale - free fashion : the most massive clusters ( within a radius of @xmath41mpc comoving ) which contain 20% of total mass in the universe at each epoch .",
    "the temperature of each cluster is the x - ray emission - weighted average over the indicated sphere .",
    "note that the selection method of clusters at different redshifts used here is somewhat different from that used in kcor , which was not scale - free : only the bright clusters with luminosity @xmath31  erg / s were selected at each redshift .",
    "nevertheless one sees a behavior of the temperature of the set of brightest clusters qualitatively similar to what was shown in kcor ( figure 13 in kcor ) : in both cases the temperature scales with redshift approximately as expected : @xmath42 .",
    "we plot , in figure 2 , @xmath43 versus redshift . here",
    ", @xmath43 is the average radius of top 20% ( in mass ) clusters in each model at each redshift within which the average density of each cluster is @xmath44 [ @xmath45 is the global mean at @xmath46 .",
    "as @xmath43 is much larger than the cell size at all times shown , resolution effects should be minimal .",
    "we see that the agreement between the simulation and the analytic prediction ( kaiser 1986 ) is satisfactory .",
    "now let us turn to the core radii .",
    "these are much smaller than @xmath43 and may be unresolved in our simulation .",
    "figure 3 shows the redshift dependence of the average cluster core radius for the same set of clusters ( top 20% in mass ) .",
    "each cluster core is found by fitting the simulated cluster emissivity profile to the following equation @xmath47 ^ 2}\\ ] ] as in kcor ( see figure 12 there ) we see that the cluster core radius does not scale with redshift as predicted analytically .",
    "comparison shows that the departure from the expected scaling is as great for the power law model as for the real cdm - like spectrum , indicating that spectral curvature is not an important factor over the redshift range ( @xmath48 ) considered .",
    "furthermore , the scaling behaviors are similar when we select the clusters in this powerlaw simulation using the same criterion as in kcor .",
    "thus , both explanations ( 1 ) and ( 3 ) are false and it is likely that the problem is due to the redshift dependence of numerical resolution .",
    "let us now examine the ansatz mentioned in the introduction .",
    "we fit the computed core radius @xmath19 ( in comoving units ) with an equation of the form @xmath49 the first term on the right hand side represents the true core size for the _ actual _ model computed and the second term is @xmath50 , where @xmath7 is the comoving cell size of a simulation .",
    "there are two variables to be solved at each epoch .",
    "since the two simulations have identical initial conditions , @xmath18 should be the same in the two simulations for clusters selected in the same , scale - free way .",
    "this allows us to solve the above equation for @xmath51 at each redshift and then @xmath52 , both of which are displayed in figure 4 .",
    "two points are immediately evident .",
    "first , the resolution of the simulation is indeed _ redshift dependent _ , as seen in the dependence of @xmath16 on @xmath53 , ranging from @xmath54 at redshift one to a @xmath55 at redshift zero .",
    "second , the derived  true \" core size , @xmath18 , at first sight , strongly disagrees with the naive analytical expectation , which states @xmath56 ( where @xmath57 is a constant thought to be @xmath58 ) .",
    "both of these points deserve a thorough understanding .",
    "we address the second point first .",
    "first we note that the assumed power law spectrum has no characteristic scale and presumably would give @xmath59 .",
    "however , the actual simulation does not possess a perfect @xmath60 power law spectrum .",
    "in fact , the actual input power spectrum to the simulation is @xmath61 for @xmath62~h~$]mpc@xmath63 comoving ( where the lower limit is due to the limited box size and the upper limit is , @xmath64 , the nyquist frequency for the @xmath1 simulation box ) and zero otherwise .",
    "figure 5 shows the linear r.m.s .",
    "density fluctuations as a function of top - hat comoving radius for the actual smoothed , truncated power law spectrum ( solid curve ) , which is used in the simulations .",
    "an ideal , untruncated @xmath60 power law spectrum would have the the fluctuation spectrum as indicated by the dashed line .",
    "we see that the truncated power law spectrum introduces a natural turnover scale around @xmath65mpc in the density fluctuation spectrum .",
    "therefore , in the actual simulations under consideration , a core can only develop _ at a size @xmath66_mpc _ or greater .",
    "_ this explains why the derived true core size shown in figure 4 is constant ( within the small noise ) from @xmath67 to @xmath68 , simply because the true core size for an untruncated power law spectrum at @xmath69 ( with the adopted normalization of @xmath36 ) either happens to be @xmath70mpc or is still smaller than @xmath71mpc .",
    "thus , at all higher redshifts , the derived  true \" core size represents what is introduced due to the truncation of the power , resulting in a nearly constant core size over the redshift range examined here .    as a consequence ,",
    "a more conservative approach is possible to obtain a bound on our resolution ( i.e. , on @xmath16 ) .",
    "if we assume that the true core radius is zero at all redshift , i.e. , @xmath72 , then the measured core radius is entirely due to finite numerical resolution ( either in the initial conditions or in the subsequent hydrodynamic simulations ) .",
    "we find a redshift dependent bound on the resolution : at @xmath67 , @xmath73 and @xmath68 , @xmath74 .",
    "let us now turn to the first point : is the derived value of @xmath16 and its redshift dependence reasonable ?",
    "it is not hard to explain results with regard to this .",
    "a shock - capturing code such as the one examined here is designed to resolve shocks .",
    "in fact , the code is shown to be able to resolve a shock in about 1 - 2 cell ( top - hat ) ( ryu 1993 ) , which is consistent with what is found here in resolving early clusters since at these early times the regions which dominate x - ray emission are just undergoing shocking .",
    "on the other hand , the code is also known to be able to resolve contact discontinuities or non - shocking , large density gradients at a lower resolution of 2 - 3 cells ( top - hat ) ( ryu 1993 ) .",
    "this is again in agreement with the found resolution for clusters at lower redshifts ( @xmath75cells [ gaussian ] ) , where shocks are far outside of cluster centers and cumulative diffusion with time tends to smooth the high density central cluster regions .    as a final and quite significant check we show , in figure 6 , the result taken from frenk ( 1998 ) , where the solid dots are the density profile ( spherically averaged ) of a cluster in a controlled volume of a cdm universe computed by the same tvd code used here with @xmath76 cells and nominal resolution ( i.e. , cell size ) of @xmath77kpc .",
    "the open circles and solid curve represent a fit to the average profile of all the simulations from frenk ( 1998 ) , which is dominated by a few highest resolution simulations in the inner region ( @xmath78mpc ) .",
    "the dashed curve is the smoothed profile of the solid curve by a gaussian with @xmath79 ( i.e. , with @xmath80 ) .",
    "we see the result computed in the core regions by our code does in fact correspond well to a gaussian smoothed version of the true density profile if the smoothing length is taken to be @xmath81 cells .",
    "this particular simulated cluster is probably more advanced than any cluster in the current simulations .",
    "therefore , a larger value of @xmath16 is entirely to be expected , but is consistent with the bound on @xmath16 obtained above .",
    "let us now apply the derived results on core radii to our previous computations of x - ray clusters of galaxies which had a box size of @xmath82mpc and a cell size of @xmath83kpc . from figure 6b of kang ( 1994 ) for the @xmath27 scdm model",
    "we have obtained the luminosity - weighted average core radius at each redshift , @xmath84 .",
    "then , we use equation ( 1 ) to compute @xmath85 at each redshift , given @xmath16 as shown in figure 4 .",
    "since this scdm model has comparable amplitudes of the density fluctuations on the relevant scales and comparable abundance of clusters of galaxies compared to the power law model tested here , it seems appropriate to directly use @xmath16 as shown in figure 4 .    in order to make meaningful assessments we need to have an estimate of error on the derived @xmath16 .",
    "we obtain the error on @xmath16 by finding individual @xmath16 for each pair of clusters found in the two different resolution simulations . for clusters selected in a self - similar way",
    "as indicated above , we find that 4 out of 4 clusters in the high resolution simulation have the counterparts in the low resolution simulation at @xmath68 , 5 out of 5 at @xmath86 , 6 out of 6 at @xmath87 , 6 out of 9 at @xmath88 , and 12 out of 15 at @xmath89 .",
    "we do not include clusters that are not paired in the two simulations in computing the errors on @xmath16 .",
    "we find the @xmath90 statistical error of @xmath16 to be @xmath91 at redshift @xmath92 , respectively , with the dispersion being @xmath93 .",
    "the identification of each pair of clusters is unambiguous with 3-d r.m.s displacement being less than one simulation cell at all epochs examined .",
    "if a cluster s average velocity dispersion with some large radius ( a few times the core radius ) is fixed and the emissivity profile is assumed to be that as in equation ( 3 ) , then one can show that approximately @xmath94 . further assuming that the luminosity function has a slope of @xmath95 , i.e. , @xmath96 , as indicated by both simulations and observations ( see figures 1 - 4 of kang 1994 ) , we are able to correct the number of bright x - ray clusters . figure 7 shows the computed core radii , the corrected core radii , the computed number of x - ray clusters brighter than @xmath97 erg / sec , and corrected number of x - ray clusters brighter than @xmath97 erg / sec , in the scdm model , from redshift zero to one .",
    "the errorbars on @xmath98 and @xmath99 are obtained by propagating errorr through the following equations : @xmath100 , @xmath101 and @xmath102 ( see below for a discussion on errors ) . the most significant result from this exercise is that the apparent positive evolution of bright x - ray clusters previously found in the scdm model seems due to the fact that the lower redshift clusters are relatively more underresolved .",
    "correcting this redshift - dependent resolution effect seems to show that the bright clusters are consistent with no evolution ( or weak evolution ) up to redshift one , in better agreement with observations and semi - analytic studies ( henry 1992 ) .",
    "figure 8 shows the same results for the @xmath9cdm model ( cen & ostriker 1994 ) .",
    "since the @xmath9cdm model is significantly different from the power law model computed here , it is somewhat tricky as to how to apply @xmath16 derived here to the @xmath9cdm model .",
    "we make the following observation .",
    "since a @xmath103 power law model has approximately the same cluster abundance as the @xmath9cdm model ( e.g. , cen 1998 ) , it seems most appropriate to apply the @xmath16 at @xmath67 in the power law model to clusters at @xmath68 in the @xmath9cdm model . for clusters in the @xmath9cdm model at higher",
    "redshift we simply use our best estimates of @xmath16 by extrapolation .",
    "note that the corrected zero redshift luminosity weighted x - ray core radii in the ( scdm,@xmath9cdm ) models are @xmath104kpc , respectively .",
    "this errorbars on @xmath18 are estimated based on the errors on @xmath19 .",
    "this is to be compared with observations by jones & forman ( 1992 ) of @xmath11kpc .    for both models we see that our previous computations have overestimated the core radii by factors of @xmath105 and underestimated the number of bright clusters by a varying factor from about 3 to 10 .",
    "we were aware of the resolution issue when we wrote kang ( 1994 ) and cen & ostriker ( 1994 ) and thus treated the computed numbers of bright clusters as lower bounds to the true numbers .",
    "thus , the present exercise has the primary effect of strengthening our previous conclusion that the cobe normalized cdm model overpredicts the number of bright x - ray clusters by a very large factor ( @xmath13 )",
    ". the @xmath9cdm model , revised to include corrections described here , would be approximately consistent with observations [ note that we found a plotting error in our previous published results : the vertical values of the simulated results in figure 1 of both kang ( 1994 ) and cen & ostriker ( 1994 ) are too large by a factor of @xmath106 ; our revised statement above with regard to the number of bright clusters in the two models includes the correction of this error ] .",
    "finally , let us estimate the systematic errors associated with the corrected luminosity of a cluster using the resolution correction method described here .",
    "assuming that @xmath94 and taking the form @xmath107 , we have @xmath108 . taking the @xmath68 solid square in figure 7 as an example ( which has largest extrapolation among our results ) with @xmath25 and @xmath109 , we have @xmath110 ; i.e. , the correction ( due to systematic error ) on the x - ray luminosity of clusters at @xmath68 is as large as the computed value , it thus appears that systematic errors associated with extrapolated x - ray cluster luminosity is still very large for the published simulations .",
    "but , we note that , if we trust the derived values of @xmath18 , then in new simulations at a dynamic range of @xmath111 now achievable with the same box size ( @xmath112mpc ) as the previously published ones , the resolution correction would be small with @xmath113 , i.e. , 38% correction ( systematic error ) , and relatively reliable . the associated errorbar on @xmath114 ( statistical error ) would be @xmath115 for the clusters in the scdm model at @xmath68 .",
    "the clusters in the @xmath9cdm model at @xmath68 , @xmath116 would be @xmath117 .",
    "hence a @xmath118 percent upper bound ( including both systematic and statistical errors ) would have an upward correction on computed value of only @xmath119 and @xmath120 , respectively , for clusters at @xmath68 in the new simulations of scdm and @xmath9cdm models .",
    "corrections for clusters at higher redshifts would be still smaller .",
    "a larger simulation box would diminish the statistical errorbars , while higher resolution would further reduce systematic errorbars .",
    "to summarize our results , we find an effective gaussian smoothing length of approximately 1.7 cells except in regions where the density gradients are caused by shocks ( for which the tvd code is optimized ) where the smoothing length is approximately @xmath4 cells .",
    "density profiles can be deconvolved with the smoothing length when the correction is small : @xmath121 , where @xmath8 .",
    "but results are not to be trusted if the computed core radii of clusters are less than @xmath122 .    applying the derived resolution effect to our previous x - ray cluster simulations",
    "we find that our previous computations underestimate the number of bright clusters by a varying factor from about 3 to 10 .",
    "we estimate that the error on the corrected clusters luminosities are still very large , thus the correction is not reliable .",
    "in addition , the redshift evolutions of bright clusters in the models are altered to varying extent .",
    "our previous conclusion that the cobe normalized cdm model overpredicts the number of bright x - ray clusters by a very large factor is greatly strengthened .",
    "finally , we note that , with new simulations at a dynamic range of @xmath111 now achievable with the same box size ( @xmath112mpc ) as the previously published ones , the resolution correction would be small [ @xmath123 , respectively ] and relatively reliable .",
    "we are happy to acknowledge support from grants nagw-2448 , nag5 - 2759 , ast91 - 08103 and asc93 - 18185 and useful conversations with l. hernquist , n. kaiser , u. pen and s. white .",
    "it is a pleasure to acknowledge pittsburg supercomputing center for allowing us to use cray c90 supercomputer .",
    "we would like to thank the hospitality of itp during our stay when this work is completed , and the financial support from itp through the nsf grant phy94 - 07194 .",
    "some of the computation was performed at the princeton sgi origin 2000 which is supported by grant from the ncsa alliance center .",
    "dum anninos , p. , & norman , m.l .",
    "1996 , apj , 459 , 12 bryan , g.l . ,",
    "cen , r. , norman , m.l . ,",
    "ostriker , j.p . , & stone , j.m .",
    "1994 , apj , 428 , 405 bryan , g.l . , norman , m.l . , stone , j.m . ,",
    "cen , r. , & ostriker , j.p .",
    "1995 , comp .",
    "comm . , 89 , 149 bryan , g.l . , & norman , m.l .",
    "1998 , apj , 495 , 80 cen , r. 1992 , apjs , 78 , 341 cen , r. , liu , f. , jameson , a. , & ostriker , j.p .",
    "1990 , apjl , 362 , l41 cen , r. , & ostriker , j.p .",
    "1994 , apj , 429 , 4 , lcdm cen , r. 1998 , apj , in press chiang , w.h . , ryu , d. , and vishniac , e.t .",
    "1989 , apj , 339 , 603 evrard , a.  e. 1988 , mnras , 235 , 911 frenk , c.s .",
    "1998 , in preparation henry , j.p . ,",
    "gioia , i.m . ,",
    "maccacaro , t. , morris , s.l . ,",
    "stocke , j.t . , & wolter , a. 1992 , , 386 , 408 hernquist , l. & katz , n.  s. 1989 , apjs , 64 , 715 jones , c. , & forman , w. 1992 , in  clusters and superclusters of galaxies \" , ed .",
    "fabian ( kluwer , netherland ) , p49 kang , h. , cen , r. , ostriker , j.p .",
    ", & ryu , d. 1994a , apj , 428 , 1 ( kcor ) kang , h. , ostriker , j.p . , cen , r. , ryu , d. , hernquist , l. , evrard , a.e . ,",
    "bryan , g.l .",
    ", & norman , m.l .",
    "1994b , apj , 430 , 83 kuhlman , b , melott , a.l . , & shandarin , s. 1996 , , 470 , l41 owen , j.m .",
    ", villumsen , j.v . , sharpiro , p.r . , & martel , h. 1998a , apjs , 116 , 155 owen , j.m . ,",
    "weinberg , d.h .",
    ", evrard , e. , hernquist , l. , & katz , n. 1998b , apj , 503 , 160 ryu , d. , vishniac , e.t . , and chiang , w.h . 1990 , apj , 354 , 389 ryu , d. , ostriker , j.p . , kang , h. , & cen , r.y .",
    "1993 , apj , 414 , 1 steinmetz , m. 1996 , mnras , 278 , 1005 steinmetz , m. , & white , s.d.m .",
    "1997 , mnras , 288 , 545"
  ],
  "abstract_text": [
    "<S> we perform a variety of tests to determine the numerical resolution of the cosmological tvd eulerian code developed by ryu ( 1993 ) . </S>",
    "<S> tests include @xmath0 and @xmath1 simulations of a @xmath2 spectrum to check for self - similarity and comparison of results with those from higher resolution sph and grid - based calculations ( frenk 1998 ) . </S>",
    "<S> we conclude that in regions where density gradients are not produced by shocks the code degrades resolution with a gaussian smoothing ( radius ) length of @xmath3 cells . at shock </S>",
    "<S> caused gradients ( for which the code was designed ) the smoothing length is @xmath4 cells . finally , for @xmath5 model fit clusters , we can approximately correct numerical resolution by the transformation @xmath6 , where @xmath7 is the cell size and @xmath8 . </S>",
    "<S> when we use these corrections on our previously published computations for the scdm and @xmath9cdm models we find luminosity weighted , zero redshift , x - ray cluster core radii of @xmath10kpc , respectively , which are marginally consistent with observed ( jones & forman 1992 ) values of @xmath11kpc . </S>",
    "<S> using the corrected core radii , the cobe normalized scdm model predicts the number of bright @xmath12erg / s clusters too high by a factor of @xmath13 and the @xmath9cdm model is consistent with observations .    </S>",
    "<S> # 1 # 1 ,     0.5 cm    princeton university observatory , princeton , nj 08544    0.5 cm    ( cen,jpo)@astro.princeton.edu </S>"
  ]
}