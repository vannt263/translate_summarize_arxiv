{
  "article_text": [
    "magnetic field plays an important role in structuring the thermodynamic and hydrodynamic behaviors of the plasma in the solar atmosphere .",
    "three dimensional magnetic fields , especially in the higher solar atmosphere , provide crucial information toward understanding various solar activities , such as filament eruptions , flares , and coronal mass ejections ( cmes ) . however , there are some difficulties in measuring the coronal magnetic field .",
    "the emissions and field strength are much weaker in the corona than that in the photosphere and chromosphere , while the temperature is much higher producing a wide line width that covers the splitting by the zeeman effect . additionally , the observed intensities are integrations along the line - of - sight direction due to the optically thin nature of the coronal plasma , and thus bright photospheric and chromospheric features obscure the emission originating in the corona .",
    "although measurement of magnetic fields in the chromosphere and the corona has considerably improved in recent decades @xcite , further developments are needed before accurate data are routinely available . since photospheric magnetic fields are widely observed by various ground - based and space - borne instruments , and since the magnetic fields are in a low @xmath1 ( the ratio between the gas pressure and the magnetic pressure ) environment in the upper chromosphere , the transition region , and the lower corona @xcite , a force - free field extrapolation technique provides an alternative way to infer the magnetic fields in the upper solar atmosphere .",
    "the force - free magnetic field is described by the equations as follows : @xmath2 where @xmath3 is the torsion function that represents the proportionality between the electric current density and the magnetic field . combining equations ( [ eqn1 ] ) and ( [ eqn2 ] ) , one obtains @xmath4 , which indicates that @xmath3 is always constant along a given field line . setting @xmath5 yields the current - free potential field . for constant @xmath3 over space , equations ( [ eqn1 ] ) and ( [ eqn2 ] )",
    "describe the linear force - free field . in the general nonlinear force - free field ( nlfff ) that is closer to realistic coronal magnetic fields",
    ", @xmath3 varies from one field line to another .",
    "solutions to the fully nonlinear problem can be calculated using numerical algorithms such as the grad - rubin , upward integration , mhd relaxation ( magnetofrictional ) , optimization , and boundary element ( green s function like ) methods ( @xcite , and references therein ) . a limited class of axisymmetric semi - analytical nlfffs also exist @xcite , and these",
    "are usually adopted as the standard test model of the above mentioned numerical algorithms , as has been done in @xcite .",
    "many authors have shown that the force - free function @xmath3 appearing in equation  ( [ eqn1 ] ) changes in active regions ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , thus the nlfff model is necessary to construct the magnetic configuration for active regions , especially those with eruptive activities .",
    "nlfff models have been adopted to study various magnetic field structures and properties in the solar atmosphere .",
    "for instance , @xcite found a twisted flux rope before eruptive activities and @xcite obtained a flux rope as the magnetic structure of a filament using the grad - rubin method . with the mhd relaxation method",
    ", @xcite and @xcite constructed non - potential magnetic field models for solar active regions and a flare / cme event , respectively .",
    "the mhd relaxation method is implemented in spherical geometry .",
    "a flux rope is usually present in this model since the flux rope is inserted into a potential field beforehand . using the optimization method",
    ", @xcite found that a flux rope and magnetic arcades coexisted in a solar filament and they further computed the twist number of the flux rope and studied the eruption mechanism .",
    "@xcite studied the evolution of free magnetic energy and relative magnetic helicity in activity productive active regions with the same optimization method .",
    "it is worth mentioning some extrapolation methods without the force - free field assumption , for example , the non - force - free extrapolation of coronal magnetic field based on the principle of minimum dissipation rate ( e.g. , @xcite ) and the magnetohydrostatic modeling of the corona ( e.g. , @xcite ) .",
    "those methods should be more applicable when the force - free state is no longer valid .",
    "most of the nlfff procedures are implemented in the cartesian coordinates .",
    "these procedures are not well suited for larger domains , since the spherical nature of the solar surface can not be neglected when the field of view is too large . however , in a critical test of nlfff codes , @xcite concluded that the field of view should be as large as possible to include more information of magnetic field line connections .",
    "in addition to the above reason , when we apply the optimization method for the nlfff extrapolation to any realistically observed active region , an apriori requirement is that the magnetic field on the boundary is isolated @xcite .",
    "however , this requirement may not be satisfied in a realistic observation due to the limitation of the field of view .",
    "therefore , it appears prudent to implement a nlfff procedure in spherical geometry for use when large - scale boundary data are available , such as from the helioseismic and magnetic imager ( hmi ; @xcite ) on board the _ solar dynamic obseratory _ ( _ sdo _ ) .",
    "furthermore , studies of magnetic field structures of large scale solar phenomena , such as trans - equatorial magnetic loops , large filaments , and cmes , are also likely to benefit from nlfff procedures in the spherical geometry",
    ".    a nlfff procedure in the spherical geometry based on the optimization method has been implemented by @xcite , which has been further developed by @xcite and @xcite . another nlfff procedure in the spherical geometry based on the same method has been implemented by j. mctiernan in the fortran 90 language and released in the `` nlfff '' package available through solar software ( ssw ) . although @xcite have already tested the nlfff code implemented by @xcite with the low and lou analytical solution , we test again j. mctiernan s version of the nlfff code in this paper carefully .",
    "it is not only meaningful for the code itself before we apply it to real observations , but also an independent validation for the nlfff method in spherical geometry .",
    "we then apply the nlfff procedure to a group of active regions observed on 2012 january 23 by _ sdo_/hmi .",
    "an m8.7 class flare occurred in noaa 11402 , one among the active region group . with this study , we first compare the extrapolated ( both potential and nlfff ) magnetic loops with extreme ultraviolet ( euv ) observations by the atmospheric imaging assembly ( aia ; @xcite ) on board _",
    "sdo_. this comparison indicates whether the nlfff model reconstructs the magnetic configuration better than the potential field model .",
    "additionally , this comparison can be used to evaluate how well the model field lines approximate the observed coronal loops , thereby enabling a determination of whether the model is consistent with observations .",
    "furthermore , the spherical modeling technique enables the study of the non - potentiality of large magnetic loops and the magnetic surroundings of an active region , especially in a place where many active regions interact with each other .",
    "finally , such a study can show how a flare , together with the associated filament eruption and cme , changes the magnetic configuration permanently both on the photosphere and in the corona .",
    "this paper is organized as follows .",
    "we first describe the procedure implementation in section  [ sec : optimization ] .",
    "the testing of the procedure using the low and lou analytical solution , and comparisons between the nlfff extrapolations in the cartesian and spherical coordinates are presented in section  [ sec : testing ] .",
    "then , we apply the nlfff extrapolation in spherical geometry to _ sdo_/hmi observations and compare the nlfff models with euv loops observed by _",
    "sdo_/aia in section  [ sec : observation ] .",
    "a summary and discussions are finally presented in section  [ sec : conclusion ] .",
    "@xcite proposed an optimization method to reconstruct the nlfff by minimizing an objective functional that combines lorentz forces and the divergence of the magnetic field .",
    "if the functional is minimized to zero , equations ( [ eqn1 ] ) and ( [ eqn2 ] ) are satisfied simultaneously .",
    "the optimization procedure in the spherical geometry has been implemented by @xcite and @xcite , where the objective functional is defined as @xmath6 r^2 \\sin\\theta \\mathrm{d}r \\mathrm{d}\\theta \\mathrm{d}\\phi ~,\\label{eqn : obj}\\ ] ] where @xmath7 is a weighting function and @xmath8 is a wedge - shaped volume for numerical computation .",
    "the weighting function is adopted to minimize the effects of the lateral and top boundaries , where the data are not available in practical observations .",
    "the wedge - shaped volume is defined by six boundaries with @xmath9 $ ] , @xmath10 $ ] , and @xmath11 $ ] .",
    "the whole computational box is resolved by the grids of @xmath12 .    for test cases with ideal boundary conditions , the vector field on all six boundaries",
    "can be specified by analytical solutions , which requires equal weights for all grid points in @xmath8 with @xmath13 everywhere . however , in more realistic cases , the vector field is known only on the lower boundary . in these instances the boundary conditions on the remaining four sides and top boundaries are typically specified by potential fields based on extrapolations of the photospheric line - of - sight field . because the potential field on the five boundaries does not match the nlfff assumption exactly , the objective functional @xmath14 can not decrease to zero .",
    "for these non - ideal cases we introduce a buffer region for the lateral and top boundaries , where the weighting function decreases from 1 to 0 with a cosine profile , from the inner volume @xmath15 to the edges , in the buffer region with @xmath16 grid points .",
    "thus , the inner physical domain @xmath15 with weights of 1 spans @xmath17 grid cells .",
    "the weighting function above enables departures of the field from the force - free and solenoidal state in the buffer region , which allows the magnetic field in the inner physical domain @xmath15 to evolve to a more force - free state than the code without a weighting function does .",
    "this is because that those field lines with one of their footpoints on the lateral and top boundaries are half free , i.e. , being allowed to change during the optimization procedure .",
    "the final state of the force - free field depends on the initial condition and the iteration history of the optimization procedure .    in this paper",
    ", we experiment with the optimization procedure in the solar software ( ssw ) , which is implemented both in the cartesian and spherical geometries and includes the weighting function , to reconstruct large scale coronal magnetic fields .",
    "this version of the optimization procedure that is fulfilled in the cartesian coordinate system without weighting function has been tested in @xcite and @xcite .",
    "the author of the code is j. mctiernan . in the version that we adopt here",
    ", the procedure includes the weighting function as an input file .",
    "in this section , we test the optimization procedure as described in section  [ sec : optimization ] using the @xcite solution . the subsections are arranged as follows .",
    "we first describe the settings of the low and lou solution that is used as the standard test model in section  [ sec : lowlou ] .",
    "secondly , the potential field source surface ( pfss ) models that are used as initial conditions for the optimization method are discussed in section  [ sec : pfss ] .",
    "thirdly , our testing results both for the ideal and noisy boundary conditions are presented in section  [ sec : test ] .",
    "finally , we compare the extrapolation results derived by the nlfff code in the cartesian coordinates and spherical coordinates , respectively , in section  [ sec : comparison ] .",
    "the low and lou solutions describe a set of nlfffs in axially symmetric geometries associated with point sources placed at the origin .",
    "let us define the heliocentric coordinate system that is denoted by @xmath18-@xmath19 ( also referred as the physical coordinate system ) , where @xmath18 is the center of the sun and @xmath19 are the cartesian components .",
    "if the origin of the local coordinate system , @xmath20-@xmath21 , for the low & lou solution is placed at ( @xmath22,0,@xmath23 ) and the local @xmath24-axis is parallel to the physical @xmath25-axis , the relation between the local coordinates and the physical ones is given by @xmath26 where @xmath27 is the angle counterclockwise measured from @xmath28-axis to @xmath29-axis if viewed against @xmath25-axis .",
    "although the transformation is modified a little as shown in equation  [ eqn4 ] from equation  ( 13 ) of @xcite , the coordinate system is identical to that depicted in figure 2 of @xcite .",
    "we adopt the nlfff solution with the eigenfunction of @xmath30 in the local coordinate system .",
    "@xmath30 is a solution of a nonlinear ordinary differential equation , corresponding to parameters @xmath31 and @xmath32 of equation ( 5 ) of @xcite .",
    "the final low & lou solution in the physical volume with @xmath33 $ ] , @xmath34 $ ] , and @xmath35 $ ] is calculated with the parameters @xmath36 , @xmath37 , and @xmath38 , and resolved by @xmath39 grid points .",
    "all the three components @xmath40 , @xmath41 , and @xmath42 have been multiplied with a normalization constant to ensure that the maximum of @xmath43 equals 500 g. some sample field lines of the low & lou solution are shown in figure  [ fig : lowlou](a ) , where the central view point is located at @xmath44 = [ 90^\\circ,180^\\circ]$ ] , i.e. , an observer is observing along the @xmath45-axis .",
    "a potential ( current - free ) field obeys the equation @xmath46 , so that the magnetic field can be expressed as the gradient of a scalar potential , i.e. @xmath47 . since @xmath48 , the scalar potential obeys the laplace equation @xmath49 .",
    "@xcite introduced a spherical source surface at a distance @xmath50 from the sun s center , where the field lines are radial , to simulate the effect of the solar wind on the magnetic field .",
    "therefore , the field vectors are purely radial at @xmath50 , which indicates that @xmath51 is a constant on the source surface .",
    "this constant can be selected as 0 .",
    "together with the photospheric boundary condition , which is traditionally provided by a map of the radial magnetic field , the laplace equation can be solved in the spherical coordinate system ( @xmath52 ) , where @xmath53 stands for colatitude .",
    "the solution in the domain @xmath54 is @xmath55y_l^m(\\theta,\\phi ) , \\label{eqn5 } \\end{array}\\ ] ] where the coefficients @xmath56 and @xmath57 are determined by the boundary conditions at @xmath58 and @xmath50 .",
    "the spherical harmonic functions @xmath59 , where @xmath60 are normalization constants based on @xmath61 and @xmath62 , and @xmath63 are associated legendre functions",
    ". please refer to the appendix in @xcite for a detailed deduction of the coefficients and the final magnetic field .",
    "further information about spherical harmonic expansion of the laplace equation can also be found in @xcite and @xcite . using the radial magnetic field observed at @xmath58 and the source surface assumption at @xmath50 as the boundary condition , together with the spherical harmonic expansion in the domain @xmath54 , we finally obtain the pfss model . throughout this paper , the harmonic coefficients of the pfss model",
    "are computed by the `` pfss '' package available in ssw .    for the purpose of initializing the test runs based on the low and lou solution",
    ", we construct pfss fields using the radial component of the magnetic field from the low and lou solution at the lower boundary .",
    "these fields are shown in figure  [ fig : lowlou](b ) .",
    "the principal order of the spherical harmonic series , @xmath64 , is set to 7 .",
    "the solutions are smooth enough that higher @xmath61 values are not needed to resolve the functional form of the low and lou solutions at these radii .",
    "we compute the correlation coefficient between the computed radial field ( @xmath65 ) and the analytical radial field ( @xmath40 ) and the normalized error ( defined as @xmath66 ) on the bottom boundary as a measurement of the agreement between them . the correlation coefficient and normalized error of @xmath65 and @xmath40 are @xmath67 and @xmath68 , respectively , which indicates that the radial components of the analytical magnetic field are well reconstructed by the pfss model .      in this section , we will perform numerical experiments with the optimization procedure written by j. mctiernan in spherical geometry , with the aim of recovering the low and lou analytical solution described in section  [ sec : lowlou ] using different kinds of boundary conditions .",
    "each experiment is initialized with potential fields calculated using the pfss model described in section  [ sec : pfss ] .",
    "the nlfff extrapolations are performed in a wedged - shaped domain bounded by @xmath33 $ ] , @xmath69 $ ] , and @xmath70 $ ] .",
    "this domain is resolved by @xmath71 grid points .",
    "for the ideal boundary test cases , we arrange the following three different boundary conditions :    case 1 : : :    the analytical vector magnetic fields from the @xmath30    solution of @xcite are specified on all the six surfaces for the    boundary condition .",
    "case 2 : : :    the low and lou fields are specified only on the bottom layer , and the    others are specified by the pfss . no weighting function is used for    lowering the boundary effect .",
    "case 3 : : :    with similar boundary conditions used in case 2 , but a buffer zone    with 6 grid points toward the top and lateral boundaries is adopted ,    where the weighting function decreases from 1 to 0 with a cosine    profile .",
    "the computation domain is the same size as case 2 , but with    the buffer inside the case 2 boundary .    in order to measure the convergence degree of the computed magnetic field",
    ", we define the integral of the lorentz force and the magnetic field divergence divided by the volume as follows : @xmath72 @xmath73 the magnetic field and the length units are gauss and mm , respectively .",
    "the two integrals should be 0 for perfect force - free and divergence - free field .",
    "the objective functional defined in equation  ( [ eqn : obj ] ) divided by volume @xmath8 is the summation of @xmath74 and @xmath75 , i.e. , @xmath76 .",
    "we use the figures of merit defined in @xcite and @xcite to quantify the degree of agreement between the analytical magnetic field @xmath77 and the extrapolated @xmath78 .",
    "the vector correlation metric is defined as @xmath79 the cauchy - schwartz metric : @xmath80 the normalized vector error metric : @xmath81 and the mean vector error metric : @xmath82 here , @xmath83 and @xmath84 .",
    "the summations run over all the points @xmath85 in the volume of interest , and @xmath86 is the total number of points . if the two vector fields are identical , then @xmath87 and @xmath88 ; @xmath89 and @xmath90 if @xmath91 at each point . unlike the vector correlation and cauchy - schwarz metrics , @xmath92 and @xmath93 if the two vector fields are perfectly matched with each other . for a consistent comparison with the other metrics , we list @xmath94 and @xmath95 in the following tables , so that all the metrics reach unity if the two vector fields are identical .",
    "additionally , the magnetic energy in magnetic field @xmath78 normalized to that in the analytical magnetic field @xmath77 is defined as @xmath96 where @xmath97 when the two fields are identical .    all the aforementioned metrics for the low and lou solution , the pfss model with @xmath98 , and the three test cases with ideal boundary conditions are listed in table  [ tbl : lowlou ] . the total energy contained in the corresponding magnetic field and that contained in the low and lou solution",
    "is also listed in the last column of table  [ tbl : lowlou ] .",
    "the pfss model has lower @xmath99 and @xmath100 metrics , but larger @xmath101 and @xmath102 metrics compared with the low and lou solution .",
    "the pfss magnetic energy is only @xmath103 of the reference one .",
    "however , using the potential field as the initial condition , the nlfff with all the six boundary vector magnetic fields are provided ( case 1 ) is recovered to the low and lou solution with very high accuracy as shown in table  [ tbl : lowlou ] . for a more practical case , in which only the bottom vector magnetic fields are known , while the others are specified by the pfss model , and we do not use the weighting function ( case 2 ) , the results show that @xmath74 and @xmath75 are one order of magnitude larger than that of the low and lou solution .",
    "however , the @xmath99 , @xmath100 , @xmath101 , and @xmath102 metrics are better than that of the pfss model .",
    "the magnetic energy in case 2 is recovered to @xmath104 of the energy in the low and lou solution .",
    "if a weighting function decreasing from 1 to 0 with a cosine profile is adopted in the buffer zone ( case 3 ) , @xmath74 , @xmath75 , and the magnetic energy have similar values as that in case 1 . the @xmath99 , @xmath100 , @xmath101 , and @xmath102 metrics are worse than that in case 1 but better than that in case 2 .",
    "therefore , a weighting function for those boundaries where data are missing improves the nlfff extrapolation .",
    "@xcite , @xcite , and @xcite pointed out that vector magnetic fields on a closed surface that fully encloses any force - free domain have to satisfy the force - free and torque - free conditions . in practical observations , only data on the bottom boundary",
    "are available .",
    "therefore , the force - free and torque - free conditions are required in a well isolated region in a force - free magnetic field . in an isolated region ,",
    "all field lines originating from the bottom boundary fall back on it again .",
    "the isolation condition requires that the flux is in balance , an area with strong magnetic fields ( active region ) is surrounded by weak fields ( quiet sun ) , and no flux interconnects to other active regions .",
    "however , the flux balance is a necessary condition for the isolation of the magnetic field , but it is not a sufficient one , which implies that it is better to enlarge the field of view than to cut a smaller region in order to fulfill the isolation condition . on the photosphere the force - free and torque - free conditions are not well fulfilled in an isolated region since the plasma @xmath1 is close to unity @xcite . thus , the forced photospheric boundaries need to be preprocessed .",
    "@xcite proposed a preprocessing routine to remove the net magnetic force and net magnetic torque , and to smooth the magnetic field , while keeping the changes of the magnetic field within the noise level .",
    "@xcite further developed the preprocessing routine into the spherical geometry .",
    "following the idea of @xcite , we have written a version of the preprocessing code and applied it to the following analysis .",
    "we add gaussian - distributed random noise to the bottom boundary of the low and lou solution to simulate realistic observations . for each component of the magnetic field ( @xmath40 , @xmath41 , or @xmath42 ) at position @xmath85 , a noisy component @xmath105 ( @xmath106 or @xmath107 )",
    "is added to the original magnetic field , where @xmath108 is the level of noise for that component , and @xmath109 is the random number in the range of @xmath110 to @xmath111 for position @xmath85 .",
    "for all the grid points , @xmath109 has a gaussian distribution . by choosing the noise level @xmath108",
    ", we have two different test cases here :    noisy model 1 : : :    @xmath112 ,    @xmath113 , and    @xmath114 . noisy model 2 : : :    @xmath115 ,    @xmath116 , and    @xmath117",
    ".    the two noisy models are similar to noisy model ii of @xcite , i.e. , adding additional noises independent of the magnetic field strength .",
    "we only choose a different strategy to determine the noise level for each component of the magnetic field .",
    "the difference between noisy model 1 and noisy model 2 is that the latter has a noise level that is twice as large as that of the former .    for each of the two noisy models , we apply the preprocessing procedure to remove the net magnetic force and net magnetic torque , and to smooth the magnetic field .",
    "the preprocessed bottom boundaries are submitted to the optimization procedure for nlfff extrapolations .",
    "the other settings are the same as the test case 3 with an ideal bottom boundary , i.e. , the initial condition and the boundary condition for the other five boundaries ( other than the bottom one ) are specified by the pfss model . the extrapolation is also performed in the wedged shaped domain bounded by @xmath33 $ ] , @xmath69 $ ] , and @xmath70 $ ] , which is resolved by @xmath118 grid points . for comparison ,",
    "the two noisy boundaries without preprocessing are also submitted for additional nlfff extrapolations .",
    "the metrics for the extrapolation results are shown in the last four rows in table  [ tbl : lowlou ] .",
    "it shows that all the metrics for both noisy models 1 and 2 are improved after preprocessing of the bottom boundary . since the normalized vector error metric @xmath101 and the mean vector error metric @xmath102 are more sensitive to the difference of two sets of vector fields , we focus on the changes of these two metrics for the two noisy models before and after the preprocessing .",
    "the changes of @xmath101 and @xmath102 show that if the noises are larger in the bottom boundary , the preprocessing could improve the extrapolation results more significantly .",
    "we cut a cubic box in the low and lou analytical magnetic field .",
    "the bottom surface of the box is tangent with the solar surface at @xmath119 = [ 1.0 r_\\sun , 78.0^\\circ , 180.0^\\circ]$ ] .",
    "the length of each side , @xmath61 , is determined by @xmath120 , where @xmath121 is a free parameter indicating the angle of the box side viewed from the center of the sun .",
    "for example , figure  [ fig : cartesian ] shows the case where @xmath122 .",
    "we prepare three cases with @xmath123 , @xmath124 , and @xmath125 . for each case",
    ", we do two nlfff extrapolations in the spherical and cartesian coordinates , respectively .",
    "the bottom boundary for the nlfff extrapolation in the spherical geometry is the analytical magnetic field at @xmath126 and bounded by the longitude and latitude lines at the four extremities of the bottom surface of the cubic box .",
    "the bottom boundary for the cartesian extrapolation is also the analytical magnetic field at @xmath126 , but the geometry of the magnetic fields are projected to the tangent bottom surface of the cubic box , while the vector components are kept in the heliographic coordinates .",
    "the other five boundaries for both cases are given by the potential field .",
    "such a way to prescribe the boundary condition mimics real observations , since we only have real observations on the bottom boundary at present and people usually assume that the heliographic components are equivalent to the cartesian components when the field of view is small .",
    "we adopt a buffer zone with 6 grid points for the weighting function .",
    "the preprocessing procedure is not applied to the boundaries .",
    "the nlfff extrapolations are performed in the cubic box and the wedge shaped region for the cartesian and spherical coordinate cases , respectively .",
    "the metrics for both the extrapolations in the cartesian and spherical geometries are listed in table  [ tbl : cartesian ] .",
    "the force - free measure , @xmath74 , and the divergence - free measure , @xmath75 , are computed in the corresponding computation domain , i.e. , the cubic box for the cartesian case and the wedged shaped region for the spherical one .",
    "all the other metrics are computed in the inner region ( excluding the six - grid buffer region ) of the corresponding cubic box .",
    "note that even for the spherical extrapolations , only the magnetic field in the inner region of the corresponding cubic box is extracted for computing the metrics .",
    "all the metrics in table  [ tbl : cartesian ] show that the nlfff code in the spherical geometry performs better than that in the cartesian one when the field of view of the bottom boundary is larger than @xmath0 .",
    "in order to apply the nlfff model to observations , we need vector magnetic field measurements in a relatively large field of view and the initial condition that is often from the pfss model , which is computed by the boundary condition from a global radial magnetic field . the _ sdo_/hmi provides us such magnetic fields with its full disk , high resolution , and high cadence vector magnetograms .      _",
    "sdo_/hmi observes the full sun with a @xmath127 ccd , whose spatial sampling is @xmath128 per pixel .",
    "it obtains raw filtergrams at six different wavelengths and six polarization states ( i.e. , @xmath129 , where @xmath130 , and @xmath8 ) in the fe 1 6173   spectral line .",
    "it takes 135 s to acquire each set of the filtergrams for deriving the vector magnetic field .",
    "all the filtergrams are averaged over 12 minutes to increase the signal to noise ratio and to remove the p - mode signals .",
    "the four stokes parameters , @xmath131 , and @xmath8 , at the six wavelengths are computed from the raw data after necessary calibrations , such as flat field correction , dark frame subtraction , and so on .    the vector magnetic field , together with other thermodynamical parameters ,",
    "are computed by the code of very fast inversion of the stokes vector ( vfisv ; @xcite ) , which fits the synthesized stokes profiles to the observed ones by a least square fitting method .",
    "vfisv adopts a line synthesized model that is based on the milne - eddington atmosphere , where all the physical parameters are constant along the line of sight , except for the source function , which depends linearly on the optical depth .",
    "vfisv has been optimized for the hmi data preprocessing ; for instance , the damping constant has been set to 0.5 and the filling factor to 1 .",
    "therefore , the atmosphere is assumed to be uniformly filled with magnetic fields in each pixel .",
    "the transverse components of vector magnetic fields suffer from the so - called @xmath132 ambiguity .",
    "the @xmath132 ambiguity for the hmi data in this study has been resolved by an improved version of the minimum energy method @xcite .",
    "as described in @xcite , in weak - field areas , the minimization may not return a good solution due to large noise .",
    "therefore , in order to get a spatially smooth solution in weak - field areas , we divide the magnetic field into two regions , i.e. , strong - field region and weak - field region , which is defined to be where the field strength is below 200 g at the disk center , and 400 g on the limb .",
    "the values vary linearly with distance from the center to the limb .",
    "the ambiguity solution in the strong - field area is derived by the annealing in the minimization method and released in the data series `` hmi.b_720s_e15w1332_cea '' .",
    "magnetic field azimuths in the weak - field area are finally determined by the potential - field acute - angle method after the annealing .",
    "this is different from the original minimum energy method , which uses a neighboring - pixel acute - angle algorithm to revisit the weak - field area .",
    "if a magnetic field vector is observed far from the solar disk center , the projection effect distorts the geometric shape of observed data , and the line - of - sight and the two transverse components ( @xmath133 , and @xmath134 ) decomposed in the image plane coordinates deviate from the heliographic east  west , south  north , and vertical components ( @xmath135 , and @xmath136 ) .",
    "therefore , correction for the projection effect must include two aspects .",
    "one corrects the geometric shape of the observed data , which is often called remapping @xcite . the other transforms the magnetic field components in the image plane to those in the heliographic plane @xcite .",
    "the heliographic components @xmath135 , and @xmath136 are equivalent to the spherical components @xmath137 , and @xmath40 .    figure  [ fig : vector ] shows two sets of remapped and reprojected vector magnetic fields observed by hmi at 02:58 ut and 04:10 ut on 2012 january 23 . the joint science operations center ( jsoc ) series name for the data is `` hmi.me_720s_e15w1332 '' .",
    "more detail about the data are described in http://jsoc.stanford.edu/jsocwiki/vectormagneticfield .",
    "an m8.7 class flare peaked at 03:38 ut in active region noaa 11402 on the same day .",
    "there are three additional active regions , noaa 11401 , 11405 , and 11407 that interacted with noaa 11402 in this area .",
    "the field of view covering all the active regions is about @xmath138 . due to the large field of view",
    ", the nlfff in the spherical geometry is necessary for studying the magnetic field configuration of the flaring active region and the magnetic connections between these active regions .",
    "because vector - field measurements are not available for the side and top boundaries of a localized domain , one needs to make assumptions about these fields before performing a nlfff extrapolation . here , we assume the lateral and upper boundaries of the computational domain are current - free , and make use of the well - known pfss model to calculate the boundary conditions . in order to include as much information of magnetic field connections as possible and conform to the requirement of the `` pfss '' package , we need a global radial magnetic field as the bottom boundary for pfss computations .",
    "but for realistic observations up to now , we could only get the full disk magnetogram , or the full disk vector magnetic field , in the best situation .",
    "it means that there are at least the following problems to be solved in order to construct a global radial magnetic field .",
    "first , we do not have magnetic field observations on the backside of the sun . therefore",
    ", the global magnetic field is usually constructed by the synoptic map , which is made by consecutive slices of magnetograms when each of them passes the central meridian .",
    "the slices of magnetograms are remapped on the heliographic plane , and are arranged side by side according to their carrington coordinates .",
    "a synoptic map implicitly neglects the differential rotation of the solar surface , and only has a temporal resolution of the carrington rotation period , i.e. , approximately 27 days . in order to study the change of large - scale magnetic structures on the time scale much less than the carrington rotation period",
    ", @xcite constructed a so - called `` magnetic frame '' consisting of two components , i.e. , a classic synoptic map inserted with a remapped magnetogram observed at a short time range .",
    "secondly , the magnetic field in the polar region of the sun is not presently well observed .",
    "the poles are blocked periodically due to the tilt angle of about @xmath139 between the sun s equatorial plane and the ecliptic plane .",
    "the radial fields in the polar region are approximately transverse to lines of sight as observed by instruments near the ecliptic plane , which introduces high noises . however , the large - scale polar magnetic fields are essential to build the pfss model ; therefore , they are important for the nlfff modeling .",
    "@xcite proposed a new two - dimensional spatial / temporal interpolation and flux transport model to interpolate the desired data .",
    "when we use the observed data ( synoptic map or synoptic frame ) as the boundary condition for the nlfff extrapolation in the following sections , we adopt the new interpolation method to fill the magnetic field in the polar regions .",
    "finally , a synoptic map or synoptic frame still lacks some basic physics of the magnetic field behavior on the solar surface , such as the differential rotation and the evolution of the magnetic field during a carrington rotation . @xcite and @xcite developed a flux - dispersal model and a data - assimilation procedure to address the aforementioned problems .",
    "the flux - dispersal model advects the magnetic flux across the solar surface and incorporates all the ingredients that are necessary for the magnetic flux evolution , such as the differential rotation , meridional flow , convective dispersal , flux emergence , flux fragmentation , and flux cancellation .",
    "_ sdo_/hmi or the michelson doppler imager ( mdi ) line - of - sight magnetograms are assimilated into the model when the data are available .",
    "we apply the pfss model to two different kinds of photospheric radial magnetic field data as described above .",
    "one is the synoptic frame @xcite and the other is an evolving flux dispersal model @xcite that makes use of magnetograms assimilated into the model .",
    "these global magnetic maps are used to construct the pfss models that are used for the initial fields , and for the boundary conditions on the sides and top for both the selected observation times . the steps to construct the global radial magnetic field for each observation time are detailed as follows .",
    "first , the two vector magnetic fields as shown in figure  [ fig : vector ] are interpolated to @xmath140 grid points uniformly distributed in latitude and longitude with a grid spacing of about @xmath141 per pixel .",
    "the vector magnetic fields are then preprocessed to remove the net magnetic force , torque , and noises using the preprocessing method in the spherical geometry as discussed in section  [ sec : test ] .",
    "secondly , the synoptic map for the carrington rotation 2119 ( 2012 january 9 to february 6 ) is interpolated onto a uniform @xmath142 pixel grid in latitude and longitude .",
    "the synoptic map is produced by line - of - sight magnetic field observations , which have been converted to the radial component by assuming that the magnetic field is radial .",
    "this synoptic map is used for both the observations at 02:58 ut and 04:10 ut , as we assume that the magnetic field outside the group of active regions did not change too much during this period . the synoptic map is aligned with the vector magnetic fields by a correlation method .",
    "then , the region where the _",
    "sdo_/hmi data are available is replaced by the preprocessed radial magnetic field .",
    "these new maps , or synoptic frames , are shown in figures  [ fig : global](a ) and [ fig : global](c ) for the observations at 02:58 ut and 04:10 ut , respectively .    as an alternative",
    ", we prepare another version of the global radial magnetic field using an evolving flux dispersal model . for the observation at 02:58 ut , the surface radial magnetic field of the flux dispersal model at 00:04 ut is interpolated to @xmath142 grid points , and aligned with the radial component of the preprocessed _",
    "sdo_/hmi vector magnetic field at 02:58 ut . additionally , we combine the aligned flux dispersal field with the _",
    "sdo_/hmi radial field to include more accurate information where the observed data are available .",
    "compared to the magnetic frame , the flux dispersal model inserted with the observed data can be sampled every 6 hr and thus may provide a more consistent bottom boundary , since the flux dispersal model has considered the differential rotation , meridional flow and other necessary factors . for the observation at 04:10 ut , we use the flux dispersal model at 06:04 ut . figures  [ fig : global](b ) and [ fig : global](d ) show the flux dispersal model inserted with the _",
    "sdo_/hmi magnetogram for the observations at 02:58 ut and 04:10 ut , respectively .",
    "the pfss models based on the two different boundary conditions at the two different times are computed with @xmath143 .",
    "when the radius is large , a smaller @xmath64 is used .",
    "the correlation coefficients between the radial fields of the pfss models ( @xmath65 ) on the bottom boundary and the corresponding global radial fields ( @xmath40 ) for all the four cases are between @xmath144 to @xmath145 .",
    "the normalized errors of @xmath65 and @xmath40 ( defined as @xmath146 ) are between @xmath147 to @xmath148 .",
    "figure  [ fig : pfss ] shows a sample set of field lines traced through the pfss models , which will later serve both as the side and top boundary conditions as well as the initial conditions for the nlfff extrapolation in spherical geometry . comparing the pfss models at two observation times , we find that the pfss models computed with the magnetic frame have evolved less than those computed with the flux - dispersal model with the inserted magnetogram .",
    "the reason is that the synoptic map used for the two observation times is the same .",
    "comparing the pfss models with the two different boundaries at each time , we find that the polar fields computed with the magnetic frames are stronger than that with the other boundary , and this is why the `` hairy sun '' images in figure  [ fig : pfss ] look different . the force - free , divergence - free measures , and the magnetic energy for the pfss models are listed in table  [ tbl : hmi ] .",
    "they have the same value for the two different boundaries for each observation time .",
    "the nlfff models for both the observation times are derived via the optimization method with the boundary and initial conditions specified by the _",
    "sdo_/hmi vector magnetic fields and the pfss models applied to both the synoptic frame and the flux - dispersal model .",
    "table  [ tbl : hmi ] lists the force - free , divergence - free measures , and the magnetic energy contained in these models .",
    "as discussed in section  [ sec : bcic ] , using different boundaries for the pfss model does not affect the force - free , divergence - free measures , and magnetic energy for the derived pfss model .",
    "however , as we use these pfss models for the nlfff extrapolation , the flux - dispersal model gives better force - free , divergence - free measures , and larger magnetic energy than that computed from the synoptic frame for both the observation times .",
    "since the potential field magnetic energy is the same , the free magnetic energy derived from the flux - dispersal model at 02:58 ut ( @xmath149 ergs ) is thus larger than that from the synoptic frame ( @xmath150 ergs ) .",
    "similarly , the magnetic energy at 04:10 ut from the flux - dispersal model ( @xmath151 ergs ) is also larger than that from the synoptic frame ( @xmath152 ergs ) .",
    "the difference in free energies between the two times , which we assume corresponds to the energy released by the m8.7 flare , is @xmath153 ergs or @xmath154 ergs for the flux - dispersal model or the synoptic frame as the boundary conditions , respectively .",
    "the errors listed in table  [ tbl : hmi ] are estimated by a pseudo monte carlo experiment .",
    "for each of the four cases in table  [ tbl : hmi ] , we add some gaussian - distributed random noise to the global radial magnetic field . in order to focus on the effects of the two global magnetic field models , i.e. , the synoptic map and the flux - dispersal model , the random errors",
    "are not added to the vector magnetic field . the error level ( the standard deviation of the random noises ) is selected to be 10 g @xcite .",
    "we create 10 noisy global radial magnetic fields for each case as listed in table  [ tbl : hmi ] , combine them with the magnetogram observed by _",
    "sdo_/hmi , and do the pfss and the nlfff extrapolations .",
    "the metrics listed in table  [ tbl : hmi ] are the mean values derived from the extrapolation results computed from the 10 noisy and 1 original boundaries .",
    "the errors are estimated as the standard deviations .",
    "we plot the pfss and nlfff models in figure  [ fig : nlfff ] in the wedge shaped field of view for the two observation times .",
    "note that only the nlfff extrapolations from the flux - dispersal model are plotted , since this model yields smaller force - free and divergence - free metrics . in these figures ,",
    "the viewer is located above the center of the computational domain . for each observation time in figure  [ fig : nlfff ] , the field lines of pfss and nlfff models are integrated from the same footpoints .",
    "we find that some field lines of the nlfff at 02:58 ut before the m8.7 flare expanded wider and higher than the pfss model at the same time .",
    "a quantitative analysis is given below .",
    "such a difference is not so obvious for the models at 04:10 ut . as for the magnetic connections between different active regions",
    ", we find that noaa 11401 plays a central role in this active region group .",
    "noaa 11402 and noaa 11401 form a long loop arcade .",
    "some field lines emanating from noaa 11401 fall into noaa 11405 .",
    "there are also some field lines emanating from the negative polarity of noaa 11401 and 11407 open to the interplanetary space .    in order to evaluate whether the nlfff models are consistent with the observed coronal loops , and to gauge how much better the nlfff models are when compared with the associated pfss models , we plot the magnetic field lines over the _ sdo_/aia euv images as shown in figure  [ fig : aia ] .",
    "the center of the view point is located at @xmath155 , where @xmath156 and @xmath157 are the longitude and latitude of the center of the solar disk , respectively . the composite euv image from three aia channels ( 211  , 193  , and 171  , whose characteristic @xmath158 correspond to 6.3 , 6.1 , and 5.8 , respectively ) at 02:58 ut in figure  [ fig : aia](a ) shows that the magnetic loops in active region noaa 11402 are highly nonpotential , since the distance between the footpoints are less than the height of the loops , and the core region is much brighter than the surroundings , which is an indication of large electric current .",
    "the pfss field lines in figure  [ fig : aia](c ) have an obvious deviation from the observed euv loops , since the projection of the field lines leans towards the west , while the loops towards the east .",
    "the spatial correspondence between the overall shape of the nlfff field lines and the euv loops is much improved as shown in figure  [ fig : aia](d ) .",
    "therefore , the qualitative comparison between the model magnetic field lines and the observed euv loops indicates that the nlfff model provides a more consistent field for this active region .",
    "we recognize that the qualitative nature of this comparison is not ideal , however it remains the best option in the absence of a more reliable quantitative alternative .    after the m8.7 flare , the high euv loops became invisible , while the post - flare loop system was more conspicuous as shown in figure  [ fig : aia](b ) .",
    "the difference between the magnetic field lines of the pfss and nlfff models at 04:10 ut is not so obvious as shown in figures  [ fig : aia](e ) and",
    "( f ) , which is consistent with the fact that the electric current has been ejected along with the flare and filament eruption .",
    "the nlfff at 04:10 ut contains less free magnetic energy than that at 02:58 ut as listed in table  [ tbl : hmi ] , which provides additional evidence that the overall magnetic field configuration relaxed to a more potential state after the flare .    in order to give a quantitative comparison between the pfss and nlfff field lines , we measure the distance of field line footpoints and the maximum height of a field line .",
    "the ratio between them tells roughly the shape of a field line .",
    "the sample field lines are the same as those in figures  [ fig : nlfff ] and [ fig : aia ] , but emanating from the active region noaa 11402 .",
    "the distance is measured along the great circle on the solar surface .",
    "figure  [ fig : dvsh ] shows the footpoint distance versus the maximum height of the field line for both the pfss and nlfff models before and after the m8.7 flare . for the field lines higher than 50 mm above the solar surface at 02:58 ut , there are quite some nlfff field lines whose maximum heights are greater than their footpoint distances , but there are very few pfss field lines having this property . such a behavior becomes weaker for the field lines at 04:10 ut . therefore , we have a quantitative measurement that some nlfff field lines in the flare productive region expanded higher than the pfss field lines before the flare .",
    "we test a nlfff optimization code in the spherical geometry with the low and lou analytical solution .",
    "it is found that the analytical solution can be recovered to a high level of accuracy if vector data on all boundaries are provided . for a more realistic simulation",
    ", we only provide the vector magnetic field on the bottom .",
    "the results show that a weighting function for the lateral and top boundaries and a pre - processing for the noisy bottom boundary are necessary for a reliable nlfff extrapolation .",
    "analytical tests also show that the nlfff code in the spherical geometry performs better than that in the cartesian one when the field of view of the bottom boundary is large , say , @xmath0 .",
    "we apply the nlfff model to an active region observed by _",
    "sdo_/hmi both before and after an m8.7 flare .",
    "the initial condition for the nlfff optimization method in the spherical geometry is computed by the pfss model .",
    "pfss uses a global radial magnetic field as its boundary condition , which can be derived by different methods , such as the synoptic frame or the flux - dispersal model . for each observation time",
    ", we compare the two results computed with different initial conditions derived by the pfss model using the synoptic frame and the flux - dispersal model , respectively .",
    "the results show that nlfff extrapolations using the flux - dispersal model as the boundary condition ( to compute their initial conditions ) have slightly lower , therefore better , force - free and divergence - free metrics , and contain larger free magnetic energy",
    ". however , if we consider the errors as listed in table  [ tbl : hmi ] and discussed in section  [ sec : result ] , the metrics are marginally comparable .    we compare the extrapolated magnetic field lines both from the nlfff and pfss models with the euv observations by _ sdo_/aia .",
    "the comparison shows that nlfff performs better than pfss not only for the core field of the flare productive region but also for the large euv loops higher than 50 mm . on the one hand ,",
    "nlfff bears larger magnetic energy than pfss . on the other hand ,",
    "the euv loops in active region noaa 11042 , where the m8.7 flare occurred , have non - potential shapes .",
    "nlfff field lines reproduce these euv loops better than pfss before the flare . in this active region group",
    ", we have both closed and open field lines , both bipolar and quadrupolar magnetic configurations .",
    "thus , it is a good example for us to further study the flare itself and its associated filament eruption and cme . after the flare , the difference between nlfff and pfss becomes smaller than that before the flare .",
    "compared to previous studies on nlfff extrapolations in spherical geometry ( e.g. , @xcite ) , the following additional experiments are conducted in this study .",
    "first , we quantitatively compare the extrapolation results derived by the nlfff codes both in the spherical and cartesian coordinates using the low and lou analytical solution .",
    "these comparisons show that geometrical factors need to be taken into account when the field of view of the bottom boundary is large .",
    "next , we have initialized the nlfff calculations with global pfss extrapolations , in light of the fact that the active regions are rarely isolated and the global pfss extrapolations provide some information about the connectivity of field lines between the active region of interest and points outside of the computational domains considered here",
    ". additionally , we test the sensitivity of the resulting nlfff models on the surface fields , and perform comparisons between nlfff extrapolations based on different surface fields ( the synoptic frame and flux - dispersal model ) .",
    "finally , we apply the nlfff extrapolation in spherical geometry to _ sdo_/hmi observations and compare the magnetic field lines with euv coronal loops observed by _ sdo_/aia .",
    "we conclude that the nlfff model performs better than the pfss model , especially for highly non - potential active regions before eruptive activities .    due to the limitation of computation resources",
    ", we adopt a spatial resolution of @xmath141 ( note that @xmath141 is the longitude or latitude difference ) per grid point for this study . since we focus on the overall property of the core field region , such as the magnetic energy and the large scale magnetic loops , such a resolution is adequate .",
    "however , the _ sdo_/hmi has a much higher resolution , which is approximately equivalent to @xmath159 per pixel . in future research",
    ", if one needs to explore the small - scale structure , it would be better to interpolate the initial condition to a higher resolution , combine it with the _ sdo_/hmi vector magnetic fields , and then perform the nlfff extrapolation to increase the spatial resolution .",
    "recently , @xcite added a new term in the optimization method to deal with measurement errors and missing data on the bottom boundary .",
    "@xcite has tested this optimization method in the cartesian geometry with the _ sdo _ observations , and @xcite applied the spherical version to observations from the synoptic optical long - term investigations of the sun ( solis ) .",
    "the new optimization method has the advantage to deal with measurement errors and minimize the force - free and divergence - free terms , while it takes much longer time for computation than the traditional optimization method .",
    "although the nlfff extrapolation techniques have been improved in various ways , it is still a challenge to validate all these magnetic field models with coronal observations .",
    "the authors thank the anonymous referee for helpful comments .",
    "data are courtesy of _ sdo _ and the hmi and aia science teams . y. guo thanks",
    "j. w. zhao very much for the invitation to stanford university .",
    "y. guo and m. d. ding were supported by nkbrsf under grant 2011cb811402 , and by nsfc under grants 10878002 , 10933003 , and 11203014 .",
    "t. wiegelmann was supported by dlr grant 50 oc 0904 .",
    "l l l l l l l + & @xmath160 & @xmath161 & @xmath162 & @xmath163 & @xmath164 & @xmath165 & @xmath166 + model @xmath167 & & & & & & + low & lou ( 1990 ) & 0.03 & 0.01 & 1 & 1 & 1 & 1 & 1 + pfss ( @xmath98 ) & 0.01 & 0.01 & 0.85 & 0.83 & 0.51 & 0.45 & 0.82 + case 1 & 0.00 & 0.00 & 1.00 & 1.00 & 0.99 & 0.99 & 1.01 + case 2 & 0.34 & 0.11 & 0.98 & 0.90 & 0.78 & 0.61 & 0.92 + case 3 & 0.01 & 0.00 & 0.99 & 0.95 & 0.86 & 0.72 & 1.01 + noisy model 1 & 0.24 & 0.16 & 0.99 & 0.94 & 0.81 & 0.68 & 0.97 + preprocessed 1 & 0.04 & 0.02 & 0.99 & 0.95 & 0.85 & 0.72 & 1.00 + noisy model 2 & 0.91 & 0.61 & 0.97 & 0.90 & 0.72 & 0.59 & 0.99 + preprocessed 2 & 0.11 & 0.06 & 0.99 & 0.94 & 0.84 & 0.71 & 1.00 +   +   +    l l l l l l l l + & @xmath160 & @xmath161 & @xmath168 & @xmath169 & @xmath170 & @xmath171 & @xmath172 + model @xmath167 & & & & & & + cartesian ( @xmath123 ) & 96.92 & 57.91 & 0.80 & 0.65 & 0.42 & 0.33 & 0.68 + spherical ( @xmath123 ) & 0.36 & 0.21 & 0.95 & 0.89 & 0.71 & 0.63 & 1.06 + cartesian ( @xmath173 ) & 21.98 & 18.02 & 0.89 & 0.80 & 0.50 & 0.40 & 0.98 + spherical ( @xmath173 ) & 0.16 & 0.12 & 0.98 & 0.94 & 0.82 & 0.72 & 0.99 + cartesian ( @xmath122 ) & 6.62 & 5.80 & 0.90 & 0.80 & 0.42 & 0.37 & 1.64 + spherical ( @xmath122 ) & 0.09 & 0.07 & 0.98 & 0.92 & 0.79 & 0.65 & 0.93",
    "+   +   +   +    l l l l l",
    "l l l l l l + & time & & @xmath174 & @xmath175 & @xmath176 & @xmath177 & & @xmath178 & @xmath179 & @xmath180 + date & ( ut ) & boundary & & & + 2012 jan 23 & 02:58 & synoptic frame & @xmath181 & @xmath182 & @xmath183 & @xmath184 & & @xmath185 & @xmath186 & @xmath187 + 2012 jan 23 & 02:58 & flux - dispersal@xmath188 & @xmath189 & @xmath190 & @xmath183 & @xmath184 & & @xmath191 & @xmath186 & @xmath192 + 2012 jan 23 & 04:10 & synoptic frame & @xmath193 & @xmath194 & @xmath195 & @xmath196 & & @xmath197 & @xmath198 & @xmath199 + 2012 jan 23 & 04:10 & flux - dispersal@xmath188 & @xmath200 & @xmath201 & @xmath195 & @xmath196 & & @xmath202 & @xmath198 & @xmath203 +   +   +   +    $ ] , @xmath204 $ ] , and @xmath205 $ ] .",
    "all the metrics in table  [ tbl : lowlou ] are computed in this domain .",
    "( b ) potential field source surface model computed with the boundary of the low and lou solution .",
    "( c ) nonlinear force - free field computed with the noisy boundary 1 ( see texts for details ) .",
    "( d ) nonlinear force - free field computed with the preprocessed noisy boundary 2.,scaledwidth=100.0% ]     = [ 78^\\circ , 180^\\circ]$ ] .",
    "blue lines mark the boundary of the wadge shaped region .",
    "cyan lines represent a cubic box that is tangent to the solar surface at @xmath119 = [ 1 r_\\sun , 78^\\circ , 180^\\circ]$ ] .",
    "red , green , and black lines represent open field lines rooted on negative polarities , open field lines rooted on positive polarities , and closed field lines , respectively .",
    "( a ) the view angle is @xmath44 = [ 100^\\circ , 170^\\circ]$ ] .",
    "( b ) the view angle is @xmath44 =   [ 70^\\circ , 90^\\circ]$].,scaledwidth=100.0% ]            .",
    "panels ( a)(d ) and those in figure  [ fig : global ] have a one - to - one correspondence .",
    "red , green , and black lines represent open field lines rooted on negative polarities , open field lines rooted on positive polarities , and closed field lines , respectively.,scaledwidth=100.0% ]     in the domain of @xmath33 $ ] , @xmath206 $ ] , and @xmath207 $ ] .",
    "the yellow lines indicate the magnetic field lines , whose maximum heights are less than @xmath208 .",
    "the cyan lines are for other closed magnetic field lines .",
    "the red lines represent open magnetic field lines .",
    "( b ) the nlfff model computed by the vector magnetic field observed at 02:58 ut and the pfss model in panel  ( a ) .",
    "( c ) the pfss model extracted from panel ( d ) of figure  [ fig : pfss ] in the domain of @xmath33 $ ] , @xmath206 $ ] , and @xmath209 $ ] .",
    "( d ) the nlfff model computed by the vector magnetic field observed at 04:10 ut and the pfss model in panel  ( c ) .",
    ", scaledwidth=100.0% ]    .",
    "( d ) field lines of the nlfff model at 02:58 ut overlaid on the euv image . ( e ) field lines of the pfss model at 04:10 ut overlaid on the euv image .",
    "( d ) field lines of the nlfff model at 04:10 ut overlaid on the euv image . , scaledwidth=70.0% ]    ( a ) , [ fig : nlfff](b ) , [ fig : aia](c ) and [ fig : aia](d ) , but in the region @xmath210 $ ] and @xmath211 $ ] .",
    "( b ) the magnetic field lines are computed with the data at 04:10 ut , and integrated from the same footpoints as shown in figures  [ fig : nlfff](c ) , [ fig : nlfff](d ) , [ fig : aia](e ) and [ fig : aia](f ) , but in the region @xmath210 $ ] and @xmath212 $ ] .",
    ", scaledwidth=100.0% ]"
  ],
  "abstract_text": [
    "<S> we test a nonlinear force - free field ( nlfff ) optimization code in spherical geometry using an analytical solution from low and lou . </S>",
    "<S> several tests are run , ranging from idealized cases where exact vector field data are provided on all boundaries , to cases where noisy vector data are provided on only the lower boundary ( approximating the solar problem ) . </S>",
    "<S> analytical tests also show that the nlfff code in the spherical geometry performs better than that in the cartesian one when the field of view of the bottom boundary is large , say , @xmath0 . </S>",
    "<S> additionally , we apply the nlfff model to an active region observed by the helioseismic and magnetic imager ( hmi ) on board the _ solar dynamics observatory _ ( _ sdo _ ) both before and after an m8.7 flare . for each observation time , we initialize the models using potential field source surface ( pfss ) extrapolations based on either a synoptic chart or a flux - dispersal model , and compare the resulting nlfff models . </S>",
    "<S> the results show that nlfff extrapolations using the flux - dispersal model as the boundary condition have slightly lower , therefore better , force - free and divergence - free metrics , and contain larger free magnetic energy . by comparing </S>",
    "<S> the extrapolated magnetic field lines with the extreme ultraviolet ( euv ) observations by the atmospheric imaging assembly ( aia ) on board _ sdo _ , we find that the nlfff performs better than the pfss not only for the core field of the flare productive region , but also for large euv loops higher than 50 mm . </S>"
  ]
}