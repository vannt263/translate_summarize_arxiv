{
  "article_text": [
    "diffusion processes have found many applications in the modeling of continuous - time phenomena , for problems related to a variety of scientific areas , ranging from economics to biology , from physics to engineering . here , we use diffusion processes as building blocks for the definition of models for survival and event history analysis .",
    "this idea is not new ( see , e.g. , the reviews in @xcite ( @xcite , @xcite ) ) .",
    "however , in this paper , we are able to considerably extend the flexibility of the diffusion models used , by adopting powerful markov chain monte carlo techniques .    diffusion models for survival analysis have been proposed because , as summarized in @xcite , `` when modelling survival data it may be of interest to imagine an underlying process leading up to the event in question . ''",
    "such a process might , for example , represent the development of a disease .",
    "two types of models have been considered in the literature : models where the event happens when a diffusion process hits some barrier and models where the hazard rate is some suitable function of the diffusion .",
    "for the former type of model , we refer the reader to @xcite , @xcite and references therein . here , we are interested in the latter .",
    "@xcite proposed a model where the hazard rate is a quadratic function of an ornstein  uhlenbeck diffusion process .",
    "this model has since been considered by several authors , including @xcite , @xcite , @xcite and @xcite . for given values of the parameters of the ornstein  uhlenbeck process ,",
    "survival distributions and hazards are studied .",
    "@xcite focuses on survival distributions conditioned on initial covariate values ; @xcite and @xcite use hazards based on quadratic functions of ornstein  uhlenbeck processes in order to model heterogeneity among groups and individuals , and to study the relative hazard functions and survival distributions ; @xcite derives quasi - stationary distributions . obtaining such analytical results for hazard functions other than quadratic functions , or for more complex diffusion processes , is not feasible .    in our paper , we adopt a bayesian approach and show how these models can be efficiently treated by means of markov chain monte carlo techniques for general choices of diffusion processes and hazard functions .",
    "for instance , by the proposed methods , it is possible to deal with latent diffusion models which are stochastic perturbations of common survival models .",
    "we also consider the case of multiple groups of observations , typical of clinical trials , and we show how to efficiently deal with covariates .",
    "we illustrate the methods via simulation studies and applications to real - world data .    it should be mentioned that other classes of bayesian nonparametric and semi - parametric models for survival analysis have been proposed in the literature . among the most important , we mention the models based on _ neutral to the right random probabilities _ , whose cumulative hazard rates are processes with independent increments ( see @xcite and @xcite for the definition and properties of these random measures , and , e.g. , @xcite , @xcite , @xcite , @xcite and @xcite for applications in survival analysis ) , and all models falling within the framework of _ multiplicative intensity models _ , whose hazard rates are mixtures of known kernels where the mixing measure is a weighted gamma process ( see @xcite , @xcite , @xcite and references therein ) .",
    "the paper is organized as follows . in section  [ prelim ] ,",
    "we recall the essentials of diffusion processes and introduce the model ; we also outline how , in the described framework , it is possible to consider stochastic perturbations of common survival models . in section",
    "[ mcmc - algorithm ] , we describe the mcmc scheme and gives the details of a suitable hastings - within - gibbs algorithm , showing its implementation by means of a toy example . in section  [ pnc - section ] , we present improved versions of the algorithm , based on reparametrizations of the model . in section  [ sec :",
    "multiple_groups ] , we discuss a straightforward generalization of the framework developed in the previous sections and deal with the case of multiple groups of observations ; this is also illustrated by application to a data set from a clinical trial , one that has been considered in a number of papers in the context of survival analysis , the famous paper by cox ( @xcite ) being among the earliest . in section [ sec : covariates ] , we describe how covariates can be efficiently included in the proposed models and give an illustrative application to the lung cancer data set analyzed by @xcite . finally , in sections [ sigma - unknown ] and [ sec : discussion ] , we discuss possible extensions of the models considered .",
    "let @xmath0 be a random variable with values in @xmath1 . denote by @xmath2 the space of continuous functions from @xmath3 to @xmath4 and by @xmath5 its cylinder @xmath6-algebra .",
    "given @xmath7 , consider the scalar diffusion process @xmath8 , solution of a _",
    "stochastic differential equation _ ( sde ) of the form @xmath9\\\\[-8pt ] x_0&=&x_0,\\nonumber\\end{aligned}\\ ] ] driven by the standard scalar brownian motion @xmath10 .",
    "the brownian motion @xmath11 and the diffusion process @xmath12 are random elements of @xmath13 . the diffusion coefficient @xmath6 is assumed constant and known , for the moment . the more technically difficult case of unknown @xmath6",
    "is postponed to section  [ sigma - unknown ] .",
    "the drift @xmath14 is assumed to be jointly measurable in @xmath15 and @xmath16 , and to satisfy the regularity conditions ( locally lipschitz , with linear growth bound ) that guarantee the existence of a weakly unique global solution to ( [ sde ] ) .",
    "see , for example @xcite , chapter v.24 .",
    "let @xmath17 be the law of @xmath18 and , for a given @xmath16 , denote by @xmath19 the law of the diffusion @xmath12 , solution of ( [ sde ] ) .",
    "by girsanov s theorem , the radon  nikodym derivative of @xmath19 with respect to @xmath17 is given by @xmath20 where @xmath15 is an element of @xmath13 .",
    "see , for example , @xcite , chapter v.27 .    similarly , for a finite @xmath21 , denote by @xmath22,\\mathbb{r})$ ] the space of continuous functions from @xmath23 $ ] to @xmath4 and by @xmath24 its cylinder @xmath6-algebra .",
    "then , @xmath25}:=\\{b_t\\dvt 0\\leq t\\leq t\\}$ ] and @xmath26}=\\{x_{t}\\dvt 0\\leq t\\leq t\\}$ ] are random elements of @xmath27,\\mathbb{r}),\\mathcal{c}^t)$ ] .",
    "let @xmath28 be the law of @xmath29}$ ] and , for a given @xmath16 , denote by @xmath30 the law of @xmath26}$ ] .",
    "then , by girsanov s theorem , the radon  nikodym derivative of @xmath30 with respect to @xmath28 is given by @xmath31}\\bigr)=\\exp\\biggl\\{\\int_0^t\\frac{\\beta(x_t,\\theta)}{\\sigma^2}\\,\\mathrm{d}x_t -\\frac{1}{2}\\int_0^t\\frac{\\beta(x_t,\\theta)^2}{\\sigma^2}\\,\\mathrm{d}t\\biggr\\}\\ ] ] and , for each @xmath21 , the measures @xmath30 are absolutely continuous .    given the diffusion @xmath12 , let us consider the random distribution function @xmath32 on @xmath3 , defined as @xmath33 where @xmath34 is some suitable non - negative and continuous function with @xmath35 almost surely .",
    "the function @xmath34 plays the role of the hazard function and @xmath36 is the random hazard rate at time @xmath37 associated with the random distribution @xmath32 .",
    "two features of the random measure @xmath32 have to be noted .",
    "the first is that the hazard inherits the markov property of the diffusion process so that the hazard at a future time @xmath38 depends only on the hazard at the present time @xmath37 .",
    "indeed , the markov property seems a sensible choice to make at the level of the hazard .",
    "the second is that the cumulative hazard is a process with positively correlated increments , being the integral of a continuous process .",
    "the latter feature is natural in many contexts and it introduces to the model a concern with the stochastic process that clearly must lie behind the occurrence of events . in words , a high increment of the cumulative hazard over the time interval",
    "@xmath39 $ ] means that the underlying stochastic process has reached a region of high risk and this is likely to yield a high increment of the cumulative hazard over a close ( disjoint ) time interval .",
    "the strength of this positive correlation , and thus the smoothness of the cumulative hazard , depends on the choice of the hazard function @xmath40 and of the diffusion process  @xmath12 : the rougher the diffusion , the weaker the correlation , and vice versa ; see also the comments in section  [ sec : discussion ] .",
    "note that the property we have just highlighted differentiates the models we are considering from models based on neutral to the right random probabilities , whose cumulative hazards are processes with independent increments and thus have an erratic behaviour .",
    "let us now consider a sequence of event times @xmath41 which are , conditionally on @xmath32 , independent and identically distributed ( i.i.d . )  with common distribution @xmath32 . from ( [ ddrm ] )",
    ", it follows that the distribution of @xmath42 , given @xmath43 , has density , with respect to the @xmath44-dimensional lebesgue measure @xmath45 , given by @xmath46\\exp\\biggl\\{-\\sum_{j=1}^{n}\\int_0^{y_j } h(x_t ) \\,\\mathrm{d}t\\biggr\\}.\\ ] ] censored observations can easily be dealt with in this setting . in the present paper , we shall restrict our attention to independent right - censored schemes .",
    "if we let @xmath47 be the observed event times and let @xmath48 be the right - censored event times , then the likelihood becomes @xmath49\\exp\\biggl\\{-\\sum_{j=1}^{m}\\int_0^{y_j } h(x_t ) \\,\\mathrm{d}t-",
    "\\sum_{j = m+1}^{n}\\int_0^{y_j + } h(x_t ) \\,\\mathrm{d}t\\biggr\\}.\\end{aligned}\\ ] ]    we are thus considering a latent diffusion model for survival analysis , where the survival times are modeled via an underlying diffusion process which determines the hazard rate . as highlighted by @xcite , this model can also be interpreted as a random barrier hitting model .",
    "indeed , the event occurs when the cumulative hazard strikes a random barrier @xmath50 , which is exponentially distributed with mean 1 and is stochastically independent of @xmath12 .      in the framework we have described",
    ", one possibility is to consider stochastic perturbations of common survival models .",
    "heuristically , the idea is that if we can express the hazard @xmath51 of a given model as a solution of an ordinary differential equation @xmath52 for some suitable function @xmath53 , then we may be able to use @xmath53 , or some modification of it , to model the drift of an sde . starting from this sde",
    ", we can thus consider a latent diffusion model whose hazard function is a stochastic perturbation of @xmath51 .",
    "we shall illustrate this by means of some examples .",
    "the simplest case is offered by the gompertz model .",
    "the gompertz hazard @xmath54 , for @xmath55 , is a solution of the ordinary differential equation @xmath56 .",
    "consider , thus , the latent diffusion model based on the sde having drift @xmath57 for @xmath58 , @xmath59 and with hazard function @xmath60 .",
    "for @xmath61 , the sde ( [ eq : sde_gompertz ] ) reduces to the ordinary differential equation written above , for which the gompertz hazard is a solution , and the latent diffusion model reduces to the gompertz model .",
    "hence , the latent diffusion model based on the sde  ( [ eq : sde_gompertz ] ) with hazard function @xmath60 can be seen as a stochastic perturbation around a central gompertz model .",
    "this constitutes a simple example of a latent diffusion model , for which the law of @xmath62 , and thus also the law of the hazard , is known . in the other examples we shall now give ,",
    "the sde can not be explicitly solved , but the latent diffusion models based on them can be treated by the techniques described in the present paper .",
    "let us consider the weibull model , whose hazard @xmath63 for @xmath64 is a non - trivial solution of the ordinary differential equation @xmath65 .",
    "consider , thus , the latent diffusion model based on the sde @xmath66 where @xmath67 and with hazard function @xmath60 . for @xmath61 , the sde ( [ eq : sde_weibull ] ) reduces to the ordinary differential equation written above , for which the weibull hazard is a solution ( @xmath68 here plays the role of @xmath69 ) .",
    "hence , the latent diffusion model based on the sde ( [ eq : sde_weibull ] ) , with hazard function @xmath60 , can be seen as a stochastic perturbation around a central weibull model . for values of @xmath68 in the interval @xmath70 , which correspond to @xmath71 ,",
    "the sde ( [ eq : sde_weibull ] ) has a non - explosive solution .",
    "this solution is weakly unique ( see , e.g. , @xcite ) . in sections [ sec : realdata ] and",
    "[ sec : appl_covariates ] , we shall implement this latent diffusion model in some illustrative applications to real - world data .    using the simple idea outlined above , it is possible to develop other latent diffusion models , such as stochastic perturbations of log - logistic models and exponential - power models . the log - logistic hazard ( @xmath72 for @xmath64 ) and the exponential - power hazard ( @xmath73 for @xmath64 )",
    "can , in fact , be written as solutions of @xmath52 for suitable functions @xmath53 ( when @xmath74 for the log - logistic and @xmath75 for the exponential - power ) .",
    "let us give a further example , which generalizes the pareto model .",
    "the pareto hazard @xmath76 , for @xmath77 and @xmath78 , is a solution of the equation @xmath79 ^ 2 $ ] .",
    "now , the sde having drift @xmath80 , for @xmath58 , @xmath81 provides a stochastic perturbation around the pareto hazard , but , unfortunately , this sde can not be used for our purposes since it has an explosive solution . on the other hand , we can modify ( [ sde_pareto_expl ] ) , for example , by inclusion of @xmath62 in the diffusion coefficient , in order to obtain another sde , @xmath82 that also provides a stochastic perturbation around the pareto hazard , but has a non - explosive solution .",
    "the latter sde can thus be transformed into one of constant diffusion coefficient , which can , in turn , be used in the latent diffusion model .",
    "note that the solution of ( [ sde_pareto ] ) , and that of the corresponding sde with constant coefficient , are almost surely positive and so we can take as hazard function @xmath34 the identity function , obtaining a particularly natural perturbation of the pareto . it is worth recalling that an sde with general diffusion coefficient @xmath83 , @xmath84 can , in fact , be transformed into an sde of unit diffusion coefficient for the process @xmath85 , by applying the 11 transformation @xmath86 , where @xmath87 is any anti - derivative of @xmath88 ( we are assuming that @xmath89 is differentiable for any @xmath90 ) ; see , for example , @xcite .",
    "this approach opens up to a number of possible stochastic perturbations of commonly used hazards .",
    "let @xmath91 be the prior density , with respect to @xmath92 , of the @xmath93-dimensional parameter @xmath0 which appears in the drift of the diffusion process @xmath12 , solution of ( [ sde ] ) .",
    "fix a finite time horizon @xmath21 of interest , with @xmath94}$ ] , where @xmath95}:=\\max\\{y_1,\\ldots , y_n\\}$ ] . the choice of @xmath21 will be discussed in section [ pnc - section ] .",
    "then , the joint posterior distribution of @xmath0 and @xmath26}$ ] has density , with respect to the product measure @xmath96 , given by @xmath97}\\vert y_1,\\ldots , y_n\\bigr)=c p_{\\theta}(\\theta ) g\\bigl(x_{[0,t]}\\vert \\theta\\bigr ) l\\bigl(y_1,\\ldots , y_n\\vert x_{[0,y_{[n]}]}\\bigr),\\ ] ] where @xmath98 is a normalizing constant and @xmath99}|\\theta):=\\frac{\\mathrm{d}\\mathbb{p}_{t,\\theta}}{\\mathrm{d}\\mathbb { w}_{t,\\sigma}}(x)$ ] is given by girsanov s formula  ( [ girsanov ] ) .",
    "a gibbs sampling algorithm for sampling from ( [ posterior ] ) alternates between    1 .",
    "simulation of @xmath0 , conditional on the observations and the current path of @xmath26}$ ] ; 2 .",
    "simulation of @xmath26}$ ] , conditional on the observations and the current value of @xmath0 .",
    "note that the parameter @xmath0 and the observations @xmath42 are conditionally independent , given the non - observed process @xmath26}$ ] .",
    "in particular , from ( [ posterior ] ) , the conditional distribution of @xmath0 given @xmath26}$ ] has density , with respect to @xmath92 , proportional to @xmath100}\\vert \\theta)$ ] .",
    "the update of the parameter is particularly straightforward when a conjugate prior @xmath91 is chosen so that it is possible to analytically derive the conditional distribution of @xmath0 given @xmath26}$ ] and sample directly from it .",
    "the second step is computationally more demanding . from ( [ posterior ] ) , the conditional distribution of @xmath26}$ ] , given parameter and observations , has density , with respect to @xmath28 , proportional to @xmath99}\\vert \\theta ) l(y_1,\\ldots , y_n\\vert x)$ ] and can not be sampled directly . an appropriate metropolis ",
    "hastings step is thus required .",
    "implementation of the algorithm will necessary involve a discretization of the diffusion sample path .",
    "when the sde can not be solved , it is possible to use _ euler  maruyama approximation _ ; see , for example , chapter 9 in @xcite .",
    "alternatively , it may be possible to simulate the diffusion path by means of the exact algorithm described in @xcite , thus avoiding approximation errors .",
    "we now give the details of the hastings - within - gibbs algorithm for latent diffusion models .",
    "just as an example , consider a latent diffusion model with base diffusion which is solution of the sde @xmath101 with @xmath102 and @xmath103 , where @xmath104 is some real - valued function for @xmath105 .",
    "let the drift @xmath106 be such that the regularity conditions mentioned in section [ prelim ] are satisfied .",
    "let the prior for @xmath107 be multivariate gaussian with mean vector and variance matrix , respectively , given by @xmath108 \\quad\\mbox{and}\\quad\\sigma=\\left [ % \\matrix { \\lambda_{11}&\\lambda_{12}&\\cdots & \\lambda_{1d}\\cr \\lambda_{12}&\\lambda_{22}&\\cdots & \\lambda_{2d}\\cr \\vdots&\\vdots&\\ddots&\\vdots\\cr \\lambda_{1d}&\\lambda _ { 2d}&\\cdots & \\lambda_{dd } } % \\right]^{-1}.\\end{aligned}\\ ] ] then , the distribution of @xmath0 , given the diffusion @xmath26}=x_{[0,t]}$ ] , is still gaussian , with mean and covariance matrix , respectively , given by @xmath109 \\quad\\mbox{and}\\quad\\sigma_x=\\left [ % \\matrix { l_{11}&l_{12}&\\cdots & l_{1d}\\cr l_{12}&l_{22}&\\cdots & l_{2d}\\cr \\vdots&\\vdots&\\ddots&\\vdots\\cr l_{1d}&l_{2d}&\\cdots & l_{dd } } % \\right]^{-1},\\ ] ] where , for @xmath105 and @xmath110 , @xmath111 the update of @xmath0 can thus be performed by sampling directly from this conditional distribution .",
    "the update of the diffusion @xmath26}$ ] is less straightforward and requires an appropriate metropolis ",
    "hastings step .",
    "it is possible , for example , to carry out an independence sampler with proposal distribution given by a brownian motion starting at @xmath112 . to improve the acceptance rate of the move that updates the diffusion path , we apply the following updating strategy .",
    "let @xmath113 . instead of proposing a new diffusion path on the whole interval",
    "@xmath23 $ ] , we propose to change the trajectory only on a subinterval @xmath114 $ ] , keeping the rest of the diffusion fixed . to ensure continuity of the diffusion path , the proposal distribution for the new trajectory on the subinterval @xmath114 $ ] is a brownian bridge @xmath115}(x_{t_{i}},x_{t_{i+2}})=\\{\\mathit{b",
    "b}_t(x_{t_{i}},x_{t_{i+2}})\\dvt t_i\\leq t\\leq t_{i+2}\\}$ ] , having as starting and ending points , respectively , the values @xmath116 and @xmath117 of the current diffusion .",
    "the proposed diffusion path @xmath118}$ ] is then given by @xmath119)x_t+ 1(t \\in [ t_i , t_{i+2}])bb_t(x_{t_{i}},x_{t_{i+2}})\\dvt t \\in[0,t]\\}$ ] , where @xmath120 is the realization of the brownian bridge @xmath115}(x_{t_{i}},x_{t_{i+2}})$ ] .",
    "this move is accepted with probability @xmath121}(x_{t_{i}},x_{t_{i+2}})|\\theta ) } { g(x_{[t_i , t_{i+2}]}|\\theta ) } \\frac{l(y_1,\\ldots , y_n|x_{[0,y_{[n]}]}^ * ) } { l(y_1,\\ldots , y_n|x_{[0,y_{[n]}]})},\\ ] ] where @xmath122}\\vert \\theta)$ ] is given by girsanov s formula restricted to the interval @xmath114 $ ] , that is , @xmath123}\\vert \\theta\\bigr)=\\exp\\biggl\\{\\int_{t_i}^{t_{i+2}}\\frac{\\theta ^{\\mathsf { t } } f(x_t)}{\\sigma^2}\\,\\mathrm{d}x_t- \\frac{1}{2}\\int_{t_i}^{t_{i+2}}\\frac{(\\theta^{\\mathsf { t } } f(x_t))^2}{\\sigma^2}\\,\\mathrm{d}t\\biggr\\}.\\end{aligned}\\ ] ] the procedure is iterated for @xmath124 .",
    "note that the different blocks @xmath114 $ ] overlap so that there are no time instants where the diffusion is kept fixed . for the same reason , the last block @xmath125 $ ] is updated by means of a brownian motion @xmath126}(x_{t_{m-2}})$ ] starting at @xmath127 so that the value of the diffusion at @xmath21 may vary .",
    "the acceptance coefficient of the move that updates the last block is the same as in ( [ acptcoeff ] ) , with @xmath114=[t_{m-2},t]$ ] and @xmath128}(x_{t_{m-2}})$ ] in place of @xmath129}(x_{t_{i}},x_{t_{i+2}})$ ] , where @xmath128}(x_{t_{m-2}})$ ] is the realization of the brownian motion @xmath126}(x_{t_{m-2}})$ ] .",
    "this idea of updating smaller intervals at a time has been used in @xcite for the simulation of non - gaussian time series models and later applied for the simulation of discretely observed diffusions , for example , by @xcite .    in section [ simulation - p - e ] , we shall illustrate the implementation of this algorithm by means of a toy example .",
    "note that in this section and in the following , we are considering base diffusions having drift linear in the parameter @xmath16 simply for purposes of exposition .",
    "we show here the implementation of the algorithm described in section [ mcmc - section ] , by means of a toy example .",
    "consider the model based on the diffusion process satisfying the sde @xmath130 with hazard function @xmath131 .",
    "we simulate observations from this model for values of the parameters @xmath132 and @xmath133 , and censoring time @xmath134 . in particular , we sample one realization @xmath15 of the diffusion process satisfying ( [ sde - model ] ) , with @xmath132 and @xmath133 .",
    "we then simulate 200 i.i.d .",
    "observations from the corresponding distribution @xmath135 and censor the observations at a common cut - off @xmath134 . the diffusion is sampled at intervals of length @xmath136 , using euler ",
    "maruyama approximation .",
    "figure [ fig : descrittiva ] shows the corresponding hazards ( the squared diffusion ) and a histogram of sampled data .",
    "the hazard function has a typical shape , first ( mainly ) increasing and then ( mainly ) decreasing .",
    "we choose as time horizon of interest @xmath137 .",
    "we then run the hastings - within - gibbs algorithm under the following specifications .",
    "the prior for @xmath138 is gaussian , as in section [ mcmc - section ] , with @xmath139 , @xmath140 , @xmath141 and @xmath142 .",
    "the starting values of the parameters are @xmath143 and the starting diffusion is a brownian motion , starting at @xmath144 .",
    "the diffusion path is updated on subintervals of length 0.2 at a time .",
    "the algorithm is run for 200000 iterations and the first 2000 are discarded as burn - in .",
    "figure [ fig : risultati ] shows the estimates of survival distribution , density and hazard function , based on the mcmc output , together with pointwise approximate @xmath145 highest posterior bands .",
    "the true survival distribution and hazard function are also displayed to demonstrate the good fit of the mcmc estimates .",
    "figure [ fig : risultati ] also shows autocorrelation functions for @xmath146 and @xmath68 series .    .",
    "right : histogram of data sampled from @xmath147 with censoring at @xmath134 . ]",
    "( solid ) , together with its posterior mean ( dashed ) and pointwise approximate @xmath145 highest posterior bands ( dotted ) .",
    "upper - right : true density ( solid ) , together with its posterior mean ( dashed ) and pointwise approximate @xmath145 highest posterior bands ( dotted ) .",
    "lower - left : true hazard function @xmath148 ( solid ) , together with its posterior mean ( dashed ) and pointwise approximate @xmath145 highest posterior bands ( dotted ) .",
    "lower - right : autocorrelation functions for @xmath146 series ( dotted ) and @xmath68 series ( dashed ) . ]",
    "the mcmc algorithm described in the previous sections might have poor mixing properties when we consider a finite - time horizon @xmath21 significantly larger than the maximum of the data .",
    "this problem is evident in figure [ fig : descrittiva - c - pnc ] .",
    "this figure shows the histogram of 200 i.i.d .",
    "observations from the distribution @xmath149 , where @xmath150 is a new realization of the diffusion process satisfying the same sde used in section [ simulation - p - e ] ; also , the hazard function @xmath40 and the censoring time @xmath98 are the same . in this simulation , we have fixed a longer time horizon @xmath151 and have then run the algorithm under the same specifications of section [ simulation - p - e ] .",
    "figure [ fig : descrittiva - c - pnc ] displays autocorrelation functions for @xmath146 and @xmath68 series , which are not exponentially decreasing . with the same data set , but choosing a shorter time horizon ( such as @xmath137 , as in the previous section ) , the algorithm does not exhibit strong serial correlation in the draws of @xmath146 and @xmath68 .",
    "the worsening of the mixing properties of the algorithm when @xmath21 becomes significantly larger than the maximum of the data was also observed for the data set simulated in section [ simulation - p - e ] .    to avoid this problem",
    ", we propose a modification of the algorithm which has good mixing properties , regardless of the choice of time horizon , and is , in fact , completely robust with respect to @xmath21 .",
    "the algorithm is based on a simple reparametrization of the model . indeed , the performance of mcmc methods , particularly when using gibbs samplers , depends crucially on the parametrization of the unknown quantities in the hierarchical structure .",
    "the issue of reparametrization of the posterior distributions in order to improve convergence properties of the algorithms has received much attention .",
    "see , for example , @xcite , @xcite , @xcite and @xcite ( @xcite ) .     with censoring at @xmath134",
    ". right : autocorrelation functions for @xmath146 series ( dotted ) and @xmath68 series ( dashed ) . ]    instead of using the natural parametrization of the model in terms of @xmath152 , the so - called _ centered parametrization _",
    ", we parametrize it in terms of @xmath153 , where @xmath154}\\bigr)x_t+1\\bigl(t > y_{[n]}\\bigr)\\bigl[b_t - b _ { y_{[n]}}\\bigr],\\qquad t\\geq0.\\end{aligned}\\ ] ] in the terminology used by @xcite , this is called a _ partially non - centered parametrization _ , the fully _ non - centered parametrization _ being , in this case , @xmath155 .",
    "the diffusion @xmath12 can then be reconstructed as a function of @xmath0 , @xmath156 and @xmath157 , by @xmath158},$   \\cr \\mathrm{d}x_t=\\beta(x_t,\\theta)\\,\\mathrm{d}t+\\sigma \\,\\mathrm{d}\\widetilde{x}_t , & \\quad $ t\\geq y_{[n]}.$ } \\end{aligned}\\ ] ] the joint posterior distribution of @xmath0 and @xmath156 has density , with respect to the product measure @xmath159 , given by @xmath160}]}\\vert \\theta\\bigr ) l\\bigl(y_1,\\ldots , y_n\\vert { x}_{[0,y_{[n]}]}\\bigr),\\ ] ] where @xmath161}]}\\equiv\\tilde{x}_{[0,y_{[n]}]}$ ] , @xmath98 is a normalizing constant and @xmath162}]}\\vert \\theta)= \\frac{\\mathrm{d}\\mathbb{p}_{y_{[n]},\\theta}}{\\mathrm{d}\\mathbb{w}_{y_{[n]},\\sigma } } ( x_{[0,y_{[n]}]})$ ] is given by girsanov s formula ( [ girsanov ] ) .",
    "note , in particular , that ( [ posterior - pnc ] ) characterizes the posterior distribution of @xmath156 , and thus the posterior distribution of the diffusion @xmath12 , over the whole positive half - line .",
    "it thus also highlights that @xmath163}]}$ ] acts as sufficient statistics .",
    "it is possible to simulate from ( [ posterior - pnc ] ) by means of a gibbs sampler quite similar to the one described in section [ mcmc - section ] .",
    "however , the algorithm is now completely robust to the choice of @xmath21 since the update of the parameter @xmath0 , conditionally on @xmath156 , only involves @xmath164}]}$ ] . in the first step , in fact",
    ", we now simulate @xmath0 conditionally on @xmath164}]}$ ] . in the second step ,",
    "we simulate @xmath156 over the time interval of interest , @xmath23 $ ] , conditionally on @xmath0 and the observations . in this case",
    ", we use a proposal distribution which is a brownian motion starting at @xmath112 over the time interval @xmath165}]$ ] and a brownian motion starting at @xmath166 over the time interval @xmath167},t]$ ] . on @xmath165}]$ ] , we again follow the updating strategy with the overlapping brownian bridges that was described in section [ mcmc - section ] . when reconstructing the diffusion @xmath168}$ ] from @xmath0 and @xmath169}$",
    "] , we are careful to preserve the continuity of the diffusion path at time @xmath95}$ ] .",
    "details are omitted .",
    "figures [ fig : risultati - c - pnc-1 ] and [ fig : risultati - c - pnc-2 ] compare mixing and mcmc estimates obtained with the algorithms based on the centered parametrization and on the partially non - centered parametrization for the data set corresponding to figure [ fig : descrittiva - c - pnc ] . the specifications of the two algorithms are as in section [ simulation - p - e ] . note that the hazard function is bathtub shaped .",
    "hazard functions with such a shape are quite common in survival analysis ( think , for instance , of human mortality ) .",
    "series ( dotted ) and @xmath68 series ( dashed ) , obtained with the algorithm based on the centered parametrization ( left ) and with the algorithm based on the partially non - centered parametrization ( right ) . ]     ( solid ) , together with its posterior mean ( dashed ) and pointwise approximate @xmath145 highest posterior bands ( dotted ) , obtained with the algorithm based on the centered parametrization ( left ) and with the algorithm based on the partially non - centered parametrization ( right ) .",
    "bottom : true hazard function @xmath170 ( solid ) , together with its posterior mean ( dashed ) and pointwise approximate @xmath145 highest posterior bands ( dotted ) , obtained with the algorithm based on the centered parametrization ( left ) and with the algorithm based on the partially non - centered parametrization ( right ) . ]    as we shall see in section [ sec : covariates ] , another reparametrization of the model , one that turns out to be useful in the presence of covariates , is the fully _ non - centered parametrization _ in terms of @xmath171 .",
    "the diffusion @xmath12 can be reconstructed as a function of @xmath0 and @xmath11 , simply by the sde @xmath172 the joint posterior distribution of @xmath0 and @xmath11 has density , with respect to the product measure @xmath159 , given by @xmath173}]}\\bigr),\\ ] ] where @xmath98 is a normalizing constant and @xmath174}]})=l(y_1,\\ldots , y_n\\vert x_{[0,y_{[n]}]})$ ] is as in ( [ likelyhood ] ) .",
    "note that , similarly to what has been observed for the partially non - centered parametrization , ( [ posterior - nc ] ) also characterizes the posterior distribution of the diffusion @xmath12 over the whole positive half - line .",
    "moreover , the gibbs sampler that simulates from ( [ posterior - nc ] ) is also completely robust with respect to the choice of the time horizon @xmath21 . in the first step ,",
    "we simulate @xmath0 conditionally on @xmath175}]}$ ] and the observations .",
    "note , in particular , that the conditional distribution of @xmath0 , given @xmath25}$ ] and the observations , now has density , with respect to @xmath92 , proportional to @xmath176}]})$ ] .",
    "in the second step , we simulate @xmath11 over the time interval of interest , @xmath23 $ ] , conditionally on @xmath0 and the observations . for proposal distribution",
    ", we use a brownian motion starting at @xmath166 and we employ the updating strategy based on overlapping brownian bridges . in this case , when updating the brownian motion path @xmath177 over the subinterval @xmath114 $ ] , we need to reconstruct the corresponding diffusion path @xmath15 over the subinterval @xmath178 $ ] in order to preserve the continuity of the diffusion path at time @xmath179 .",
    "details are omitted .",
    "we now discuss a straightforward generalization of the framework developed in the previous sections and deal with the case of multiple groups of observations , where the observations within each group are taken under homogeneous conditions .",
    "consider , for example , the case in which different treatments are being administered to different groups of patients in a clinical trial .    given @xmath7 , let @xmath180 } , \\ldots , x^{[q]}$ ] be @xmath181 stochastically independent diffusion processes satisfying ( [ sde ] ) and @xmath182},h } , \\ldots , f_{x^{[q]},h}$ ] the relative random distributions , as in ( [ ddrm ] ) .",
    "now , consider @xmath181 sequences of observations @xmath183})_n , \\ldots , ( y_n^{[q]})_n$ ] such that the random variables in @xmath184})_n , \\ldots,(y_n^{[q]})_n)$ ] are conditionally independent , given @xmath182},h } , \\ldots , f_{x^{[q]},h}$ ] , and the random variables in @xmath185})_n$ ] have common distribution @xmath186},h}$ ] for @xmath187 .",
    "the joint distribution of @xmath188},\\ldots , y_{n_1}^{[1]},\\ldots,$ ] @xmath189},\\ldots , y_{n_q}^{[q]}$ ] , given @xmath180}=x^{[1 ] } , \\ldots,$ ] @xmath190}=x^{[q]}$ ] , has density , with respect to @xmath45 ( where @xmath191 ) , given by @xmath192},\\ldots , y_{n_1}^{[1]};\\ldots;y_1^{[q]},\\ldots , y_{n_q}^{[q]}\\big\\vert x_{[0,y_{[n _ { 1}]}]}^{[1 ] } , \\ldots , x_{[0,y_{[n _ { q}]}]}^{[q]}\\bigr)= \\prod_{k=1}^{q}l\\bigl(y_1^{[k]},\\ldots , y_{n_k}^{[k]}\\big\\vert x_{[0,y_{[n _ { k}]}]}^{[k]}\\bigr),\\end{aligned}\\ ] ] where @xmath193}:=\\max\\{y_1^{[k]},\\ldots , y_{n_k}^{[k]}\\}$ ] and @xmath194},\\ldots , y_{n_k}^{[k]}\\vert x_{[0,y_{[n _ { k}]}]}^{[k]})$ ] is as in ( [ likelyhood ] ) . using the partially non - centered parametrization described in section [ pnc - section ] , the joint posterior distribution of @xmath0 and @xmath195 } , \\ldots,\\widetilde{x}^{[q]}$ ] has density , with respect to the product measure @xmath196 , given by @xmath197 } , \\ldots,\\tilde{x}^{[q]}\\big\\vert y_1^{[1]},\\ldots , y_{n_1}^{[1]};\\ldots ; y_1^{[q]},\\ldots , y_{n_q}^{[q]}\\nonumber \\bigr ) \\\\[-8pt]\\\\[-8pt ] & & \\quad = c",
    "p_{\\theta}(\\theta ) \\biggl[\\prod_{k=1}^{q}g\\bigl(x_{[0,y_{[n _ { k}]}]}^{[k]}\\vert \\theta\\bigr ) l\\bigl(y_1^{[k]},\\ldots , y_{n_k}^{[k]}\\big\\vert x_{[0,y_{[n _ { k}]}]}^{[k]}\\bigr)\\biggr],\\nonumber\\end{aligned}\\ ] ] where @xmath98 is a normalizing constant and @xmath198}]}^{[k]}\\vert \\theta)=\\frac{\\mathrm{d}\\mathbb{p}_{y_{[n _ { k}]},\\theta}}{\\mathrm{d}\\mathbb{w}_{y_{[n _ { k}]},\\sigma}}(x_{[0,y_{[n _ { k}]}]}^{[k]})$ ] is given by girsanov s formula ( [ girsanov ] ) .",
    "the contributions of the @xmath181 groups of observations factorize in ( [ posterior - p - e ] ) and a simple modification of the mcmc algorithm presented in the previous sections may be used to deal with this case .",
    "let @xmath199 be the time horizons of interest for the @xmath181 groups , with @xmath200}$ ] for @xmath187 .",
    "the hastings - within - gibbs algorithm for sampling from ( [ posterior - p - e ] ) alternates between    1 .",
    "simulation of @xmath0 , conditional on the current paths of @xmath201}]}^{[1 ] } , \\ldots,$ ] @xmath202}]}^{[q]}$ ] ; 2 .   for each @xmath203 in @xmath204 ,",
    "simulation of @xmath205}^{[k]}$ ] , conditional on the observations @xmath206},\\ldots , y_{n_k}^{[k]}$ ] and the current value of @xmath0 .",
    "consider , for example , a latent diffusion model with @xmath181 stochastically independent diffusion processes , @xmath180 } , \\ldots , x^{[q]}$ ] , satisfying the sde ( [ sde - model - general ] ) .",
    "choose the same multivariate gaussian prior for @xmath0 that was used in section [ mcmc - section ] .",
    "then , the distribution of @xmath0 , given @xmath201}]}^{[1]}=x_{[0,y_{[n _",
    "{ 1}]}]}^{[1 ] } , \\ldots,$ ] @xmath202}]}^{[q]}=x_{[0,y_{[n _ { q}]}]}^{[q]}$ ] , is still gaussian , with mean vector and covariance matrix as in ( [ mean - var - full - cond1 ] ) , but with @xmath207}}f_i\\bigl(x^{[k]}_t\\bigr)\\,\\mathrm{d}x^{[k]}_t\\biggr]+\\sum_{j=1}^{d}\\lambda_{ij}\\mu_j , \\\\",
    "l_{ij}&:= & \\frac{1}{\\sigma^2}\\biggl[\\sum_{k=1}^q\\int_0^{y_{[n _ { k}]}}f_i\\bigl(x^{[k]}_t\\bigr)f_j\\bigl(x^{[k]}_t\\bigr)\\,\\mathrm{d}t\\biggr]+\\lambda_{ij}\\end{aligned}\\ ] ] for @xmath105 , @xmath110",
    ". the update of the parameter @xmath0 can thus be performed by sampling directly from this conditional distribution .",
    "the second step may be carried out by @xmath181 repetitions of the updating mechanism described in sections  [ mcmc - section ] and [ pnc - section ] .",
    "note that we are here considering a simple hierarchical structure , where inference on the separate groups is linked only at the level of the finite - dimensional parameter @xmath0 .",
    "for some applications , this might allow too little borrowing of strength for inference across groups of patients . in section [ sec : covariates ]",
    ", we shall instead describe a more complex hierarchical structure , suitable in the presence of covariates and allowing for a much stronger borrowing of strength for inference across individuals .",
    "in this section , we show the implementation of the latent diffusion model for multiple groups of observations via an illustrative application to a small data set from a clinical trial , one that has been considered in a number of papers in the context of survival analysis , among them @xcite , @xcite , @xcite and @xcite in the non - bayesian literature and @xcite , @xcite and @xcite in the bayesian literature . in the trial , reported by @xcite , 6-mercaptopurine ( 6-mp )",
    "was compared to a placebo in the maintenance of remission in acute leukemia .",
    "the following lengths of remission in weeks were recorded for 42 patients , half of which treated with the 6-mp drug and half with the placebo ( a @xmath208 sign indicates a censored observation ) :    1 .   6 , 6 , 6 , 6@xmath208 , 7 , 9@xmath208 , 10 , 10@xmath208 , 11@xmath208 , 13 , 16 , 17@xmath208 , 19@xmath208 , 20@xmath208 , 22 , 23 , 25@xmath208 , 32@xmath208 , 32@xmath208 , 34@xmath208 , 35@xmath208 , 2 .",
    "@xmath209    we thus consider a model for two groups of observations , namely the 6-mp drug group and the placebo group . as latent diffusion model , we shall use the stochastic perturbation around the weibull described in section [ sec : perturbations_common_models ] . recall that this model has base diffusion satisfying the sde @xmath210 and hazard function @xmath60 .",
    "we express the data as fractions of one year and choose as time horizons of interest @xmath211 , corresponding to 9 months ( 39 weeks ) .",
    "we take @xmath212 and @xmath213 to be a priori independent , with a gaussian prior distribution for @xmath212 , mean @xmath214 , variance @xmath215 , and a uniform prior over @xmath216 $ ] for @xmath213 . moreover , we set @xmath217 and @xmath218 .",
    "we then run the hastings - within - gibbs algorithm based on the partially non - centered parametrization .",
    "the update of @xmath212 is performed by sampling directly from the conditional distribution @xmath212 , given @xmath219}]}^{[1]},\\widetilde { x}_{[0,y_{[n_2]}]}^{[2]}$ ] , which is still gaussian with mean @xmath220 and variance @xmath221 , where @xmath222}}\\bigl(\\bigl(\\operatorname{sign}\\bigl(x^{[j]}_t\\bigr)\\bigr ) \\bigl|x^{[j]}_t\\bigr|^{\\theta_2}\\bigr)\\,\\mathrm{d}x^{[j]}_t\\biggr]\\quad\\mbox{and}\\quad l:=\\frac{1}{\\sigma^2}\\biggl[\\sum_{j=1}^2\\int _ 0^{y_{[n_j]}}\\bigl(\\bigl|x^{[j]}_t\\bigr|^{\\theta_2}\\bigr)^2\\,\\mathrm{d}t\\biggr].\\end{aligned}\\ ] ] for the update of @xmath213 , we use an independence sampler with a beta proposal distribution , with parameters @xmath223 .",
    "the update of @xmath195}$ ] and @xmath224}$ ] is carried out as described in the previous sections .",
    "the algorithm is run for 200000 iterations and the first 2000 are discarded as burn - in .",
    "figure [ fig : surv - frereich ] displays the mcmc estimates of the survival distributions of the two groups , 6-mp drug and placebo , together with the relative kaplan  meier curves . note that the mcmc estimates of the two survival distributions are closer to one another than the two kaplan  meier curves , thus indicating borrowing of strength for inference among the two groups .",
    "hence , the latent diffusion model , which gains much flexibility over a fully parametric model by introducing randomness around it , does not suffer from the opposite problem of being too data - driven .",
    "figure  [ fig : surv - frereich ] also displays the mcmc estimates of the hazards of the two groups",
    ".    we could now verify the efficacy of 6-mp drug treatment as proposed in @xcite .",
    "in particular , under the hypothesis that the 6-mp drug is inefficient , we would regard all patients as belonging to a single group , instead of two .",
    "we could then implement the latent diffusion model based on the stochastic perturbation of the weibull , but with just one diffusion process . let m@xmath225 denote the model where all patients belong to a single group ( corresponding to the hypothesis @xmath226 of null efficacy of the 6-mp drug ) and let m@xmath227 denote the model considered above ( corresponding to the hypothesis @xmath228 of efficacy of the 6-mp drug ) .",
    "if the a priori probabilities of hypotheses @xmath226 and @xmath228 are set equal to 0.5 , the bayes factor @xmath229 gives the posterior odds in favor of @xmath226 .",
    "as expected , the computed bayes factor ( @xmath230 ) provides strong evidence for the efficacy of the 6-mp drug .",
    "highest posterior bands for the group of patients treated with 6-mp drug ( solid ) and for the group of patients treated with the placebo ( dashed ) , together with corresponding kaplan  meier curves . right : posterior mean hazards for the group of patients treated with 6-mp drug ( solid ) and for the group of patients treated with the placebo ( dashed ) . ]",
    "covariates can be included in the latent diffusion models described in a very natural way , as directly influencing the underlying diffusion .",
    "for instance , if @xmath231 is a vector of @xmath232 covariates measured at time 0 , we can use the model based on the diffusion satisfying the sde @xmath233\\\\[-8pt ]   x_0 & = & x_0(\\mathbf { z},\\theta).\\nonumber\\end{aligned}\\ ] ] in particular , following suggestions of @xcite and@xcite for barrier hitting models , those covariates which represent measures of how far the underlying process that leads to the event has advanced ( such as staging measures in cancer ) may be taken to influence the starting point of the diffusion . those covariates which instead represent causal influence on the development of the process",
    "may be taken to influence the drift of the diffusion .",
    "let @xmath234 take values @xmath235},\\ldots,\\mathbf",
    "{ z}^{[q]}$ ]",
    ". then , ( [ eq : sde_covariates ] ) gives @xmath181 different diffusions , @xmath236 } } ] } , \\ldots , x^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]}$ ] , driven by the same brownian motion @xmath11 , with @xmath237}}]}&=&\\beta \\bigl(x_t^{{[\\mathbf { z}=\\mathbf { z}^{[k ] } } ] } , \\mathbf { z}^{[k]},\\theta\\bigr)\\,\\mathrm{d}t+\\sigma \\,\\mathrm{d}b_t,\\qquad t\\geq0 , \\\\",
    "x_0 & = & x_0\\bigl(\\mathbf { z}^{[k]}\\bigr)\\end{aligned}\\ ] ] for @xmath187 .",
    "denote by @xmath238}}]},h } , \\ldots , f_{x^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]},h}$ ] the relative random distributions , as in ( [ ddrm ] ) .",
    "moreover , denote by @xmath239}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}$ ] the survival times of the @xmath240 individuals having covariates @xmath241}$ ] for @xmath187 . the survival times @xmath242}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}$ ] , conditionally on @xmath243}}]},h}$ ] , are i.i.d . with common distribution @xmath244}}]},h}$ ] .",
    "since the @xmath181 diffusions are driven by the same brownian motion , it is here more natural to use the fully non - centered parametrization of the model , described in section [ pnc - section ] . in particular",
    ", the joint distribution of @xmath245}}]},\\ldots , y_{n_1}^{{[\\mathbf { z}=\\mathbf { z}^{[1 ] } } ] } , \\ldots , y_1^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]},\\ldots , y_{n_q}^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]},$ ] given @xmath246 and @xmath7 , has density , with respect to @xmath45 ( where @xmath191 ) , given by @xmath247}}]},\\ldots , y_{n_1}^{{[\\mathbf { z}=\\mathbf { z}^{[1 ] } } ] } ; \\ldots;y_1^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]},\\ldots , y_{n_q}^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]}\\big\\vert \\theta , b_{[0,y_{[n]}]},\\mathbf { z}^{[1]},\\ldots,\\mathbf { z}^{[q]}\\bigr ) \\\\ & & \\quad= \\prod_{k=1}^{q}l\\bigl(y_1^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\big\\vert \\theta , b_{[0,y_{[n_k]}]},\\mathbf { z}^{[k]}\\bigr),\\end{aligned}\\ ] ] where @xmath95}:=\\max\\{y_1,\\ldots , y_n\\}$ ] , @xmath248}:=\\max\\{y_1^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\}$ ] and @xmath249}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\big\\vert \\theta , b_{[0,y_{[n_k]}]},\\mathbf { z}^{[k]}\\bigr)=l\\bigl(y_1^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\big\\vert x_{[0,y_{[n_k]}]}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\bigr)\\end{aligned}\\ ] ] is as in ( [ likelyhood ] ) . the joint posterior distribution of @xmath0 and @xmath11 has density , with respect to the product measure @xmath159 , given by @xmath250}}]},\\ldots , y_{n_1}^{{[\\mathbf { z}=\\mathbf { z}^{[1 ] } } ] } ; \\ldots;y_1^{{[\\mathbf { z}=\\mathbf { z}^{[q]}}]},\\ldots , y_{n_q}^{{[\\mathbf { z}=\\mathbf { z}^{[q ] } } ] } ; \\mathbf { z}^{[1]},\\ldots,\\mathbf { z}^{[q]}\\bigr)\\nonumber \\\\[-8pt]\\\\[-8pt ] & & \\quad = c p_{\\theta}(\\theta)\\prod_{k=1}^{q } l\\bigl(y_1^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]},\\ldots , y_{n_k}^{{[\\mathbf { z}=\\mathbf { z}^{[k]}}]}\\big\\vert \\theta , b_{[0,y_{[n_k]}]},\\mathbf { z}^{[k]}\\bigr).\\nonumber\\end{aligned}\\ ] ]    note that this model is structurally different from the model for multiple groups of observations described in section [ sec : multiple_groups ] since the distributions of the survival times are here linked at the level of the brownian motion , allowing a much stronger borrowing of strength for inference across individuals who share a common value of even just one of the @xmath232 covariates .    as usual , we denote by @xmath21 the time horizon of interest , @xmath94}$ ] .",
    "the hastings - within - gibbs algorithm for sampling from ( [ eq : post_covariates ] ) alternates between    1 .",
    "simulation of @xmath0 , conditional on the current path of @xmath175}]}$ ] , the observations and the covariates ; 2 .",
    "simulation of @xmath25}$ ] , conditional on the current value of @xmath0 , the observations and the covariates .    in particular , the update of the brownian motion @xmath25}$ ] can be carried out via the updating strategy based on overlapping brownian bridges , as described in section [ pnc - section ] .      in this section ,",
    "we illustrate how to efficiently handle the model with covariates via an application to a data set concerning 272 patients diagnosed with non - small cell lung cancer .",
    "the data set is described in detail in @xcite .",
    "survival times are measured in months from the time of diagnosis ( with 17% of censoring ) and some covariates are recorded at the time of diagnosis . just to give an illustration of the model",
    ", we shall consider here two covariates : sex ( @xmath251 : male and @xmath252 : female ) and hoarseness ( @xmath253 : absent and @xmath254 : present ) .",
    "using , for instance , the model based on the stochastic perturbation around the weibull , we can include these covariates as follows : @xmath255 note that , following the suggestion of @xcite , we have modeled the covariate hoarseness , which only represents a measure of how far the lung tumor has advanced , as influencing the starting point of the diffusion ; we have instead taken the covariate sex to influence both the starting point and the drift of the diffusion , in order to account for possible differences between males and females , both in the hazards at time of diagnosis and in the hazard dynamics .",
    "the covariate combinations determine four different diffusions , @xmath256}}$ ] , @xmath257}}$ ] , @xmath258}}$ ] and @xmath259}}$ ] , driven by the same brownian motion . according to this model ,",
    "the hazard at time 0 ( the time of diagnosis ) of patients suffering from hoarseness is @xmath260 times that of patients not suffering from hoarseness and the hazard at time 0 of female patients is @xmath261 times that of male patients ; moreover , @xmath262 gives a measure of the different progression rate of the cancer in female patients with respect to male patients .",
    "we express the data as fractions of a quadrennium and choose as time horizon @xmath21 the maximum of the observations , corresponding to about 37 months . in order to avoid dependencies among the @xmath263 parameters and among the @xmath264 parameters ,",
    "we reparametrize them in terms of @xmath265 and @xmath266 , with @xmath267 and @xmath268 , where we have denoted by @xmath269 and @xmath270 the percentage of females patients and the percentage of patients suffering from hoarseness , respectively .",
    "we take all of the parameters to be a priori independent , with gaussian priors with mean @xmath166 and variance @xmath271 for all parameters except @xmath272 , for which we use a uniform prior over @xmath216 $ ] .",
    "moreover , we set @xmath218 .",
    "we then run the hastings - within - gibbs algorithm based on the non - centered parametrization of the model .",
    "the update of the parameters is performed via independence samplers having proposal distributions equal to the priors .",
    "the algorithm is run for 200000 iterations and the first 2000 are discarded as burn - in .",
    "figure [ fig : surv - haz - lungcancer - all ] shows posterior mean survival distributions , together with kaplan  meier curves , for male patients without hoarseness at time of diagnosis ( @xmath273 , solid line ) , for male patients with hoarseness ( @xmath274 , dotted and dashed line ) , for female patients without hoarseness ( @xmath275 , dashed line ) and for female patients with hoarseness ( @xmath276 , dotted line ) .",
    "the four survivals are also plotted separately in figure [ fig : surv - lungcancer-4plots ] with @xmath145 highest posterior bands .",
    "figure [ fig : surv - haz - lungcancer - all ] also displays the posterior mean hazard functions for the four covariate combinations . in particular , the posterior mean hazard at time 0 of patients suffering from hoarseness is 2.2 times bigger than that of patients not suffering from hoarseness , whereas the hazard at time  0 of female patients is 0.6 times that of male patients .",
    "note that even though we have only considered categorical covariates in this illustrative application , quantitative covariates can also be included in the model ; however , it may be necessary to categorize these covariates in order to have a sufficient number of observations for each of the diffusion processes .",
    "this , of course , requires larger data sets .    ,",
    "solid line ) , for male patients with hoarseness ( @xmath274 , dotted and dashed line ) , for female patients without hoarseness ( @xmath275 , dashed line ) and for female patients with hoarseness ( @xmath276 , dotted line ) .",
    "right : the same for posterior mean hazard functions . ]",
    "highest posterior bands , together with kaplan  meier curve , for male patients without hoarseness .",
    "upper - right : the same for male patients with hoarseness .",
    "lower - left : the same for female patients without hoarseness .",
    "lower - right : the same for female patients with hoarseness .",
    "an important generalization of the models we have considered thus far consists of considering diffusion processes with unknown diffusion coefficient @xmath6 since @xmath6 describes a natural measure of prior uncertainty .",
    "we briefly discuss how to deal with this case .",
    "let @xmath277 be a real random variable .",
    "given @xmath7 and @xmath278 , consider the scalar diffusion process @xmath12 solution of the sde ( [ sde ] ) and denote by @xmath279 the law of @xmath26}$ ] .",
    "let @xmath280 be the prior density , with respect to @xmath281 , of @xmath277 ( for simplicity , we take @xmath0 and @xmath277 to be stochastically independent a priori ) .",
    "let us consider , for instance , the centered parametrization of the model .",
    "the joint posterior distribution of @xmath282})$ ] has density , with respect to @xmath283 , given by @xmath284}\\vert y_1,\\ldots , y_n\\bigr)=c p_{\\theta}(\\theta ) p_{\\sigma}(\\sigma ) g\\bigl(x_{[0,t]}\\vert \\theta , \\sigma\\bigr ) l\\bigl(y_1,\\ldots , y_n\\vert x_{[0,y_{[n]}]}\\bigr),\\ ] ] where @xmath98 is a normalizing constant and @xmath99}\\vert\\theta , \\sigma):=\\frac{\\mathrm{d}\\mathbb{p}_{t,\\theta , \\sigma}}{\\mathrm{d}\\mathbb{w}_{t,\\sigma}}(x_{[0,t]})$ ] is given by girsanov s formula ( [ girsanov ] ) .",
    "the quadratic variation of a diffusion processes , having diffusion coefficient @xmath6 , satisfies @xmath285 therefore , the conditional distribution of @xmath277 , given the diffusion @xmath26}$ ] , degenerates to a point mass and @xmath277 is completely determined by the diffusion path . in practice , we can not simulate the diffusion path in continuous time , but just at discrete time instants .",
    "in any case , the finer the discrete - time approximation @xmath286 of the diffusion @xmath26}$ ] , the stronger the dependence between @xmath286 and @xmath277 .",
    "consider the algorithm for the simulation from ( [ posterior - sigma ] ) that alternates between :    1 .",
    "simulation of @xmath0 , conditional on the current value of @xmath277 and the current path of @xmath26}$ ] ; 2 .",
    "simulation of @xmath277 , conditional on the current value of @xmath0 and the current path of @xmath26}$ ] ; 3 .",
    "simulation of @xmath26}$ ] , conditional on the observations and the current values of @xmath0 and @xmath277 .",
    "the finer the approximation of the diffusion path , the worse the convergence of the algorithm becomes . in the limiting case @xmath287 ( i.e. , if the diffusion process could be simulated in continuous time ) , this scheme would be reducible ; see @xcite . an alternative way to see",
    "this problem is to note that the collection of measures @xmath288 are mutually singular and , therefore , so are the measures @xmath289 .    in this case , the need for a different parametrization of the model is thus compelling .",
    "following @xcite , we parametrize the model in terms of @xmath290 , where @xmath291 . by it s formula ,",
    "@xmath292 the distribution of @xmath293}$ ] depends on @xmath277 , but any realization of @xmath293}$ ] contains only finite information about @xmath277 .",
    "analogous reparametrizations are derived starting from the ones described in section [ pnc - section ] .",
    "mcmc algorithms based on these reparametrizations can be obtained as simple modifications of the ones previously described .",
    "consider the toy example described in section [ simulation - p - e ] and assume the same model , but let the diffusion process have an unknown diffusion coefficient .",
    "let the prior for this coefficient be exponential with mean 1 .",
    "figure [ fig : risultati - c - sigma ] displays the results obtained with the mcmc algorithm based on the reparametrization @xmath290",
    ". specifications of the algorithm are as in section [ simulation - p - e ] .",
    "note that the mixing for @xmath6 is slow relative to the very good mixing for @xmath146 and @xmath68 , but this does not prevent good estimates of the survival distribution , density and hazard being obtained .",
    "slow mixing for @xmath6 could probably be improved by a further reparametrization of the model .    , but for the model with unknown diffusion coefficient .",
    "the lower - right plot also displays the autocorrelation function for @xmath6 series ( dotted - dashed line ) . ]    alternatively to the case of an unknown diffusion coefficient , it would be possible to consider models based on diffusion processes having @xmath294 , but with hazard function @xmath295 , where @xmath296 is a random parameter .",
    "a reparametrization of the model would also be necessary in this case .",
    "in this paper , we have described latent diffusion models for survival analysis and have shown that these models can be efficiently treated by means of mcmc techniques .",
    "we have dealt with the case of multiple groups of observations , typical of clinical trials , and we have shown how covariates can be efficiently included in the models .",
    "we have outlined how , in the described framework , it is possible to consider stochastic perturbations of common survival models . in particular , we have used a stochastic perturbation of the weibull model in some illustrative applications to small data sets , with multiple groups of observations and with covariates .",
    "applications to larger data sets , where the potential of a latent diffusion model may be fully expressed , will be the object of future work .",
    "all analyses presented are computationally feasible within r ( see @xcite ) .",
    "another generalization of the model we intend to explore regards random probabilities based on jump diffusion processes . as observed in section [ prelim ] , the cumulative hazard functions associated with random probabilities based on diffusions are smooth , being the integrals of continuous processes . by replacing the diffusion process with a jump diffusion process , it would be possible to capture sudden changes in the behavior of cumulative hazards that might be due to some kind of shock experienced by the population .",
    "hazards modeled through stochastic processes with jumps have been studied , for instance , by @xcite .",
    "we would like to thank robin henderson and piercesare secchi for useful comments , and omiros papaspiliopoulos and alexandros beskos for their help with programming .",
    "we are also grateful to the associate editor and two anonymous referees for their constructive comments .",
    "the second author acknowledges funding from the ec marie curie training site human potential program in order to visit the department of mathematics and statistics , lancaster university and from the centre for research in statistical methodology ( crism ) , university of warwick .",
    "beskos , a. , papaspiliopoulos , o. , roberts , g.o . and fearnhead , p. ( 2006 ) .",
    "exact and computationally efficient likelihood - based estimation for discretely observed diffusion processes .",
    "_ j. r. stat .",
    "methodol . _ * 68 * 333382 .",
    "ishwaran , h. and james , l.f .",
    "computational methods for multiplicative intensity models using weighted gamma processes : proportional hazards , marked point processes and panel count data .",
    "_ j. amer .",
    "assoc . _ * 99 * 175190 .        laud , p.w . ,",
    "damien , p. and smith , a.f.m .",
    "bayesian nonparametric and covariate analysis of failure time data . in",
    "_ practical nonparametric and semiparametric bayesian statistics_. _ lecture notes in statist . _ * 133 * 213225 .",
    "new york : springer .",
    "papaspiliopoulos , o. , roberts , g.o . and skld , m. ( 2003 ) . non - centered parameterizations for hierarchical models and data augmentation ( with discussion ) . in _ bayesian statistics _ * 7 * 307326 .",
    "new york : oxford univ . press .",
    "yashin , a.i .",
    "dynamics of survival analysis : conditional gaussian property versus the cameron  martin formula . in _ statistics and control of stochastic processes",
    "_ 466485 .",
    "new york : optimization software ."
  ],
  "abstract_text": [
    "<S> we consider bayesian hierarchical models for survival analysis , where the survival times are modeled through an underlying diffusion process which determines the hazard rate . we show how these models can be efficiently treated by means of markov chain monte carlo techniques . </S>"
  ]
}