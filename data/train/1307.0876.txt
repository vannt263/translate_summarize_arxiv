{
  "article_text": [
    "we consider a bounded domain  @xmath0 and a set @xmath1 of perforations within this domain .",
    "the perforations are supposedly small and in extremely large a number .",
    "the parameter  @xmath2 stands here for a typical distance between the perforations .",
    "we denote by  @xmath3 the perforated domain ( see figure  [ fig : perforation ] ) .",
    "we then consider the following problem : find @xmath4 , solution of @xmath5 where @xmath6 is a given function , assumed sufficiently regular on @xmath7 .",
    "it is important to note that the homogeneous dirichlet boundary condition on @xmath8 ( and hence on the boundary @xmath9 of the perforations ) is a crucial feature of the problem we consider .",
    "our academic enterprise is motivated by various physically relevant problems , for instance in fluid mechanics , atmospheric modeling , electrostatic devices ,  a different boundary condition , such as a neumann boundary condition , would lead to completely different theoretical considerations and , eventually , a different numerical approach .",
    "the consideration of   can also be seen as a step toward the resolution of the stokes problem on perforated domains . in that latter case ,",
    "homogeneous dirichlet boundary conditions on the perforations are typical for many applicative contexts .",
    "contains perforations @xmath1 .",
    "the perforated domain is @xmath3 .",
    "the boundary of @xmath10 is the union of @xmath11 ( the part of the boundary of the perforations that is included in @xmath12 ) and of @xmath13 .",
    "[ fig : perforation ] ]    our purpose here is to propose and study a dedicated multiscale finite element method ( msfem ) . to this end",
    ", we consider the variant of msfem using _ crouzeix - raviart type _",
    "finite elements  @xcite which we have employed and studied for a prototypical multiscale elliptic problem in  @xcite and we adapt the approach for the particular setting under consideration here .",
    "the major adaptation we perform ( and thus one of the added values with respect to our earlier work  @xcite ) is the addition of _ bubble functions _ to the finite element basis set .",
    "let us briefly comment upon the motivation for these two ingredients : crouzeix - raviart type finite element on the one hand , and addition of bubble functions on the other hand .",
    "the motivation for using crouzeix - raviart type finite elements stems from our wish to devise a numerical approach as accurate as possible for a limited computational workload . in general",
    ", it is well known that , for the construction of multiscale finite elements , boundary conditions set on the edges ( facets ) of mesh elements for the definition of the basis functions play a critical role for the eventual accuracy and efficiency of the approach .",
    "using crouzeix - raviart type elements ( see  @xcite for their original introduction ) gives a definite flexibility .",
    "in short , the continuity of our multiscale finite element basis set functions accross the edges of the mesh is enforced only in a weak sense by requiring that the average of the jump vanishes on each edge .",
    "this `` weak '' continuity condition leads to some natural boundary conditions for the multiscale basis functions ( see section  [ ssec : msfem ] ) .",
    "the nonconforming approximation obtained in this manner proves to be very effective , see  @xcite .",
    "the above issue regarding boundary conditions on the mesh elements is all the more crucial when dealing with perforated computational domains .",
    "indeed , we want the approach we construct to be as insensitive as possible to the possible intersections between element edges and perforations .",
    "the long term motivation for this is the wish to address problems where the perforations can be very heterogeneously distributed ( think , say , of nonperiodic , or even random arrays of perforations ) .",
    "ad hoc _ construction of a mesh that ( essentially ) avoids intersecting the perforations is then prohibitively difficult .",
    "the second ingredient of our approach is the addition of bubble functions to the finite element space . as illustrated using a simple one - dimensional analysis in section  [ ssec:1d ] , and demonstrated with an extensive set of numerical tests in section  [ sec : numerical - tests ] for all msfem type approches we implemented , the addition of bubble functions is definitely benefitial for the overall accuracy of the approach .",
    "the literature on the types of problems and techniques considered here is of course too vast to be recalled here .",
    "a quite general review is contained in our earlier work  @xcite .",
    "we however wish to mention here the references  @xcite for the general background on msfem , and the works  @xcite specifically addressing problems on perforated domains , either from a theoretical or a numerical standpoint .",
    "the outline of our article is as follows .",
    "as already briefly mentioned , the rest of this introduction , namely section  [ ssec:1d ] , is devoted to the study of a simple one - dimensional situation . from section  [ sec : presentation2d ] on",
    ", we work in two dimensions throughout the article , both for the analysis and for the numerical tests of the final section .",
    "we however emphasize that , of course , the approach can be applied to the three - dimensional context and that , most likely , the theoretical analysis we provide here can also be extended to the three dimensional case ( note that our analysis in  @xcite was performed in both the two and three dimensional settings )",
    ". we will not proceed in this direction here .",
    "in addition and for simplicity , we assume that @xmath7 is a polygonal domain .",
    "section  [ sec : presentation2d ] presents our finite element approach and the main result of numerical analysis ( theorem  [ theo : main ] ) we are able to prove , under restrictive assumptions made precise below ( in particular , periodicity of the perforations is assumed , although , in practice , the approach is _ not _ restricted to this setting ) .",
    "section  [ sec : preliminaries ] prepares the ground for the proof of this main result , performed in section  [ sec : proof ] .",
    "our final section  [ sec : numerical - tests ] then presents a comprehensive set of numerical experiments .",
    "when using our msfem approach on a perforated domain , there are essentially three `` parameters '' : ( i ) the boundary conditions imposed to define the msfem basis functions , ( ii ) the addition , or not , of bubble functions and ( iii ) the possible intersections of the perforations with the edges ( facets ) of mesh elements .",
    "assessing the validity of our approach requires to compare it with the other existing approaches for all possible combinations of the above three `` parameters '' . this is what we complete in section  [ sec : numerical - tests ] .",
    "our tests demonstrate that the combination of crouzeix - raviart type finite elements and bubble functions allows to outperform all the other existing approaches on the problem considered here in a way that is essentially insensitive to intersections of the mesh with the perforations .      in order to illustrate the specificity of multiscale perforated problems , and to already discover some interesting features",
    ", we first consider an academic one - dimensional setting .",
    "consider the one - dimensional version of the boundary value problem   for  @xmath14 , @xmath1 the set of segments @xmath15 with @xmath16",
    ". we suppose that the gaps between the perforations are of length at most @xmath2 , that is @xmath17 , @xmath18 , @xmath19 ,  , @xmath20 .",
    "other than that , we do not put any assumption on the geometry of these one - dimensional perforations . note that in particular ( and in contrast to the analysis we perform later on in this article ) we do _ not _ assume any periodicity of the perforations .",
    "the weak form of our problem then reads : find @xmath21 such that @xmath22 where , we recall , @xmath23 denotes the perforated domain and where @xmath24 we now divide @xmath7 into @xmath25 segments @xmath26 $ ] , @xmath27 , by the nodes @xmath28 , define the mesh size @xmath29 note that the domain @xmath30 may be not connected .",
    "we nevertheless assume that @xmath31 is equal to the _ same _ constant @xmath32 on all the connected components of @xmath33 .    in the one - dimensional setting ,",
    "the crouzeix - raviart type boundary condition that we consider in this work simply amounts to a continuity condition at the mesh nodes .",
    "this is why we require that @xmath34 in the above definition of @xmath35 .",
    "this observation holds for many variants of msfem , including the oversampling variant , which , alike the crouzeix - raviart variant we introduce here , uses non - conforming finite elements . in this respect",
    ", the one - dimensional setting is not typical .",
    "the galerkin approximation of the solution to problem   is then introduced as the solution @xmath36 to @xmath37 readers familiar with the msfem approach will notice that @xmath35 contains more functions than the usual msfem basis set , which would consist here in taking @xmath38 ( rather than an arbitrary constant @xmath32 ) on @xmath33 .",
    "a convenient generating family for the space @xmath35 may be constructed as follows .",
    "first we associate a function @xmath39 to any internal node @xmath40 by solving @xmath41 note that this construction yields @xmath42 if the node @xmath40 lies inside a perforation ( see fig .  [",
    "fig : phi_i ] ) .",
    "second , we associate a function @xmath43 to any segment @xmath26 $ ] by solving ( see fig .  [",
    "fig : psi_i ] ) @xmath44 the functions @xmath39 ( @xmath45 ) and @xmath46 ( @xmath47 ) are linearly independent ( except for the trivial case when @xmath42 ) , and we obviously have @xmath48 in turn , any @xmath49 can be written @xmath50 .",
    "we thus have @xmath51 which implies that the space @xmath35 is of dimension at most @xmath52 .",
    "( solid line : domain @xmath53 ; dashed line : perforations @xmath54 ) . left : case when @xmath55 . right : case when @xmath56 , for which @xmath42 .",
    "[ fig : phi_i],title=\"fig : \" ]   ( solid line : domain @xmath53 ; dashed line : perforations @xmath54 ) . left : case when @xmath55 .",
    "right : case when @xmath56 , for which @xmath42 .",
    "[ fig : phi_i],title=\"fig : \" ]     ( solid line : domain @xmath53 ; dashed line : perforations @xmath54 ) . left : case when @xmath55 .",
    "right : case when @xmath56 . in both cases , @xmath57 .",
    "[ fig : psi_i],title=\"fig : \" ]   ( solid line : domain @xmath53 ; dashed line : perforations @xmath54 ) . left : case when @xmath55 .",
    "right : case when @xmath56 . in both cases , @xmath57 .",
    "[ fig : psi_i],title=\"fig : \" ]    it is interesting to note that the functions  @xmath43 , which act as _ bubble functions _ , are necessary to generate an efficient approximation space .",
    "the reason is evident in the one - dimensional situation , since , in the absence of such a bubble ( or of a basis function playing a similar role ) , there is no way to recover a good approximation quality between two consecutive perforations if no node is actually present there .",
    "the numerical solution would systematically vanish in such a region ( see fig .",
    "[ fig : phi_i ] , right part ) . in higher dimensions ,",
    "the phenomenon is less accute ( since perforations , unless of a particular shape , can not isolate regions of the space from the neighborhood ) but it is still , to some extent , relevant . we will observe the definite added value of bubble functions in our numerical tests of section  [ sec : numerical - tests ] .    we then have the following ( simple ) numerical analysis result .",
    "assume that the right - hand side @xmath58 in   satisfies @xmath59 .",
    "then the galerkin solution @xmath60 of   satisfies the error estimate @xmath61 where @xmath62 is the energy norm associated to the bilinear form @xmath63 : @xmath64    the factor  @xmath2 in the right - hand side of   needs to be understood as follows .",
    "it turns out that , for the category of problems   we consider , the exact solution  @xmath65 ( and thus , correspondingly , its numerical approximation  @xmath60 ) is of size  @xmath2 in @xmath66 norm for @xmath2 small , as is proved by homogenization theory and will be recalled for the periodic setting in section  [ ssec : homogenization ] below ( see   and  ) .",
    "once this scale factor is accounted for , the estimate   shows that the numerical approach is first order accurate in the meshsize  @xmath67 , with a prefactor @xmath68 that is _ independent _ of the size  @xmath2 of the geometric oscillations .",
    "we see from   and   that @xmath69 consequently , @xmath60 is the orthogonal projection of @xmath65 on @xmath35 , where by _ orthogonality _ we mean orthogonality for the scalar product defined by the bilinear form  @xmath63 .",
    "we therefore have @xmath70 proving   therefore amounts to proving the inequality for at least one function @xmath71 .",
    "we take @xmath71 such that @xmath72 , @xmath73 , and @xmath74 on each @xmath33 , where @xmath75 is the @xmath76-orthogonal projection of @xmath58 on the space of piecewise constant functions .",
    "consider then the interpolation error @xmath77 .",
    "we remark that @xmath78 denoting by @xmath79 and @xmath80 , we have @xmath81 note that the integration by parts here does not give rise to any boundary or jump terms because @xmath82 vanishes at all the points @xmath83 , @xmath84 and also at the grid points @xmath40 where @xmath85 is discontinuous .",
    "we now apply the cauchy - schwarz and poincar inequalities on each segment @xmath86 and note that the constant in the latter inequality scales as the length of the segment , that is at most @xmath2 ( this fact is obvious in dimension @xmath87 ; see   and appendix  [ sec : proof_poincare ] below for a general argument ) . we thus deduce from   that @xmath88 factoring out @xmath89 , and using a standard finite element approximation estimate of @xmath90 , we deduce that @xmath91 collecting this bound with  , we obtain  .",
    "as mentioned in the introduction , we assume henceforth that the ambient dimension is @xmath92 and that @xmath7 is a polygonal domain .",
    "we define a mesh @xmath93 on @xmath7 , i.e. a decomposition of @xmath7 into polygons each of diameter at most @xmath67 , and denote @xmath94 the set of all the internal edges of @xmath93 .",
    "note that we mesh @xmath7 and not the perforated domain @xmath53 .",
    "this allows us to use coarse elements ( independently of the fine scale present in the geometry of @xmath53 ) , and leaves us with a lot of flexibility . the mesh does not have to be consistent with the perforations @xmath54 .",
    "some nodes may be in @xmath54 , and likewise some edges may intersect @xmath54 .",
    "we also assume that the mesh does not have any hanging nodes",
    ". otherwise stated , each internal edge is shared by exactly two elements of the mesh .",
    "in addition , @xmath93 is assumed a regular mesh in the following sense : for any mesh element @xmath95 , there exists a smooth one - to - one and onto mapping @xmath96 where @xmath97 is the reference element ( a polygon of fixed unit diameter ) and @xmath98 , @xmath99 , @xmath100 being some universal constant independent of  @xmath101 , to which we will refer as the regularity parameter of the mesh .",
    "this assumption is used e.g. in the proof of lemma  [ lem : trace ] below . to avoid some technical complications",
    ", we also assume that the mapping @xmath102 corresponding to each @xmath95 is affine on every edge of @xmath103 . again",
    ", this assumption is used e.g. in the proof of lemma  [ lem : trace ] . in the following and to fix the ideas",
    ", we will have in mind a mesh consisting of _ triangles _ , which satisfies the minimum angle condition to ensure the mesh is regular in the sense defined above ( see e.g.  ( * ? ? ?",
    "* section  4.4 ) ) .",
    "we will repeatedly use the notation and terminology ( triangle ,  ) of this setting , although the approach carries over to quadrangles .",
    "the idea behind the msfem  la crouzeix - raviart is to require the continuity of the ( here highly oscillatory ) finite element functions in the sense of averages on the edges .",
    "we have extensively studied this approach in  @xcite . for the specific setting we address here ,",
    "we add another feature to the numerical approach . based in particular on the intuition provided by the one - dimensional case examined in the previous section , we add _ bubble functions _ to our discretization space .    [",
    "[ functional - spaces ] ] functional spaces + + + + + + + + + + + + + + + + +    to construct our msfem space , we proceed as in our previous work  @xcite .",
    "we introduce the space @xmath104 = 0 \\text { for all } e\\in \\mathcal{e}_h , \\quad u=0 \\text { in $ b_{\\varepsilon}$ and on $ \\partial \\omega$ } \\end{array } \\right\\},\\ ] ] where  @xmath105 $ ] denotes the jump of  @xmath65 across an edge . note that , as is standard , the condition @xmath106 on @xmath107 makes sense as @xmath7 is a polygonal domain and @xmath107 belongs to the mesh edges .",
    "we next introduce the subspace @xmath108 of @xmath109 and define the msfem space  la crouzeix - raviart @xmath110 as the orthogonal complement of @xmath111 in @xmath109 , where by orthogonality we mean orthogonality for the scalar product defined by @xmath112 we use a broken integral in the definition of @xmath113 since @xmath114 .",
    "[ [ notation ] ] notation + + + + + + + +    for any @xmath115 , we denote by latexmath:[\\[\\label{eq : def_h1h }    norm associated with the form @xmath113 .    likewise , for any @xmath117",
    ", we denote by @xmath118 strong form and basis functions of @xmath35 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider any element @xmath119 ( the three edges of which are denoted @xmath120 , @xmath121 ) .",
    "taking in the definition of @xmath35 a function @xmath122 that vanishes on @xmath123 , we note that any function @xmath49 satisfies @xmath124 for all @xmath125 such that @xmath126 in @xmath54 , @xmath127 for all @xmath128 ( if @xmath129 , the condition @xmath127 is replaced by @xmath130 on @xmath120 ) and @xmath131 .",
    "this can be rewritten as @xmath132 for some scalar constants @xmath133 , @xmath134 ( on purpose , we have made the dependence of these constants explicit with respect to the mesh element @xmath101 ) . hence , the restriction of any @xmath49 to @xmath101 is in particular a solution to the boundary value problem @xmath135 the flux along each edge interior to @xmath7 is therefore a constant , the constant being possibly different on the two sides of the edge .",
    "the above observation shows that @xmath35 is a finite dimensional space .",
    "we now construct a basis for @xmath35 , which consists of functions associated to a particular mesh element or a particular internal edge .",
    "note that no basis function is associated to edges belonging to @xmath107 .",
    "first , for any mesh element @xmath101 that is not a subset of the perforations @xmath54",
    "( i.e. @xmath136 ) , we consider the variational problem @xmath137 ,   \\",
    "\\psi \\in h^1(t ) ,   \\\\ \\noalign{\\vskip 3pt } {",
    "\\displaystyle}\\psi = 0 \\ \\text{in $ t \\cap b_{\\varepsilon}$ } , \\",
    "\\int_{\\gamma_i } \\psi = 0 \\text { for each $ \\gamma_i$ } \\end{array } \\right\\}.\\ ] ] using the poincar inequality recalled in  ( * ? ? ?",
    "* lemma 9 ) and standard analysis arguments , we see that this problem has a unique minimizer .",
    "we then introduce the function @xmath138 which vanishes in @xmath123 and is equal to this minimizer in @xmath101 .",
    "we easily deduce from the optimality condition that @xmath139 and satisfies @xmath140 with , for each edge @xmath120 of @xmath101 , @xmath141 and @xmath142 on @xmath120 for some constant @xmath143 .",
    "second , for any internal edge @xmath144 that is not a subset of the perforations @xmath54 , we denote @xmath145 and @xmath146 the two triangles sharing this edge , set @xmath147 , and consider the variational problem @xmath148 this set is not empty due to the fact that @xmath149 .",
    "again , this problem has a unique minimizer .",
    "we introduce the function @xmath150 which vanishes in @xmath151 and is equal to this minimizer in @xmath152 .",
    "we easily deduce from the optimality condition that @xmath153 and satisfies @xmath154 with , for each edge @xmath155 , @xmath156 and @xmath157 on @xmath158 for some constant @xmath159 and @xmath160 and @xmath161 on @xmath144 for some constant @xmath162 ( with an a priori different constant on the two sides of @xmath144 ) .    for any mesh element @xmath163 ( resp . any internal edge @xmath164 ) , we set @xmath165 ( resp .",
    "@xmath166 ) .    in the one - dimensional case ,",
    "the functions @xmath167 and @xmath168 that we have defined are equal to the basis functions of section  [ ssec:1d ] ( see figures  [ fig : phi_i ] and  [ fig : psi_i ] ) .",
    "the functions @xmath167 and @xmath168 that we have constructed belong to @xmath35 .",
    "in addition , @xmath169 forms a linearly independent family .",
    "we have @xmath170 conversely , let @xmath49 . we know that @xmath65 satisfies  .",
    "we introduce @xmath171 \\phi_e\\ ] ] and note that it satisfies , for any @xmath119 , @xmath172 with @xmath173 and @xmath174 is a constant on @xmath144 , for each edge @xmath175 .",
    "this implies that @xmath176 , and thus @xmath177    [ [ numerical - approximation ] ] numerical approximation + + + + + + + + + + + + + + + + + + + + + + +    the msfem approximate solution of our problem   is defined as the solution  @xmath36 to @xmath178 where @xmath113 is defined by  .",
    "the main theoretical result we obtain in this article addresses the numerical analysis of the approach presented above , in the particular case of periodic perforations in dimension  2 , with a sufficient regularity ( made precise in the statement of the theorem below ) of the right - hand side  @xmath58 of  .",
    "[ theo : main ] let @xmath65 be the solution to   for @xmath92 , with periodic perforations and with @xmath179 .",
    "we assume that , loosely speaking , the slopes of the mesh edges are rational numbers .",
    "more precisely , we assume that the equation of any internal edge @xmath144 of the mesh writes @xmath180 for some @xmath181 , some @xmath182 and @xmath183 that are coprime , with latexmath:[\\[\\label{hyp : mesh }    considered in the mesh and of the mesh size @xmath67 .",
    "then the msfem approximation @xmath60 , solution to  , satisfies @xmath185 for some universal constant  @xmath100 independent from @xmath67 , @xmath2 and @xmath58 , but depending on the geometry of the mesh and other parameters of the problem .    as will be evident from the theoretical ingredients recalled below ( see   and comments following this estimate ) , the right - hand side of   needs to be understood as follows .",
    "the size of the exact solution  @xmath65 ( and thus that of the corresponding approximation  @xmath60 ) is  @xmath2 in @xmath66 norm . taking this scale factor into account ,",
    "the actual rate of convergence for the numerical approach we design is therefore given by @xmath186 .",
    "our assumption on the rationality of the slopes in the mesh is necessary , in the current state of our understanding , to treat traces of periodic functions on the edges of the mesh . in full generality ,",
    "such traces are almost periodic functions .",
    "our proof perhaps carries over to this case , however at the price of unnecessary technicalities ( we refer e.g. to  @xcite for works on boundary layers in homogenization , where such non - periodic situations are dealt with ) . in the case of rational slopes",
    "we restrict ourselves to , these traces are periodic , and the uniform bound   we additionally assume enables us to uniformly bound their periods from above , rending the proof much easier . we emphasize that our assumption does not seem to us very restrictive in practice .",
    "it is useful to compare our error estimate   with estimates for other existing msfem - type approaches established for similar problems .",
    "first , we are not aware of any other numerical analysis of a msfem - type approach for problems set on perforated domains . to the best of our knowledge",
    ", this work is the first one proposing and analyzing a msfem - type approach specifically adapted to such problems .",
    "second , as pointed out above , this work is a follow up on our previous work  @xcite where we have studied a crouzeix - raviart type msfem approach on the problem @xmath187 = f   \\text { in $ \\omega$ } , \\quad u^{\\varepsilon}= 0 \\text { on $ \\partial \\omega$},\\ ] ] the main difference between that method and the one presented here being the addition of bubble functions in the msfem space . for problem  ,",
    "we have compared in  ( * ? ? ?",
    "* remark 3.2 ) our error estimate with those obtained for other msfem - type approaches .    in the absence of perforations ,",
    "our problem simply writes @xmath188 assuming a triangular mesh is used , our discretization space @xmath35 then becomes the standard crouzeix - raviart space  @xcite ( see  ( * ? ? ?",
    "* remark 1.1 ) ) , complemented by bubble functions defined by   with @xmath189 . in turn ,",
    "the msfem approach with linear boundary conditions ( as well as the oversampling variant ) then becomes the standard p1 fem .",
    "the next two sections are devoted to the proof of theorem  [ theo : main ] .",
    "numerical results are gathered in section  [ sec : numerical - tests ] .",
    "we consider the unit square @xmath190 and some smooth perforation @xmath191 .",
    "we next scale @xmath192 and @xmath190 by a factor @xmath2 and then periodically repeat this pattern with periods @xmath2 in both directions .",
    "the set of perforations is therefore @xmath193 and the perforated domain is @xmath194 .",
    "we denote by @xmath195 the solution to   to emphasize the dependency upon  @xmath2 . we know from the classical work  @xcite that , provided @xmath58 vanishes on the boundary of @xmath7 ( see below the easy adaptation to a more general case ) , we have @xmath196 where @xmath197 denotes the corrector , that is the solution to the problem @xmath198 in the unit cell  @xmath190 .",
    "we refer to  @xcite for more background on homogenization theory .",
    "note that   is _ not _ restricted to the two - dimensional case . in the sequel , we will use the fact that @xmath199 which follows from the fact that @xmath200 for some @xmath201 ( see e.g.  ( * ? ? ?",
    "* theorem 6.14 ) ) . in view of  (",
    "* corollary 8.11 ) , we also have @xmath202 , but we will not need this henceforth .    clearly , shows that , for @xmath2 small , the dominant behaviour of the solution  @xmath195 to   is simple .",
    "it is obtained by a simple multiplication of the right - hand side  @xmath58 by the corrector function .",
    "otherwise stated , the particular setting yields an homogenized problem where the differential operator has disappeared .",
    "the corrector problem   formally agrees with intuition : at the scale of the geometric heterogeneities , the right - hand side  @xmath58 of   is seen as a constant function ( thus the right - hand side of  ) and the approximation of the solution  @xmath195 is obtained by the simple multiplication mentioned above .",
    "additionally , the `` size '' of the solution  @xmath195 is proportional to  @xmath203 in @xmath76 norm and  @xmath2 in @xmath66 norm , a fact that will need to be borne in mind below when performing the analysis and the numerical experiments .",
    "it is easy to modify   in order to accomodate the more general situation where the right - hand side  @xmath179 does not necessarily vanish on the boundary of @xmath7 , provided the domain @xmath7 is smooth .",
    "we then have the weaker estimate @xmath204 where @xmath205 we recall that , in dimension @xmath92 , the injection @xmath206 is continuous .",
    "the proof of   is postponed until appendix  [ sec : proof_hom ] .",
    "a key ingredient for that proof , and for other proofs throughout this article , is the following poincar inequality in the perforated domain @xmath10 : there exists a constant @xmath100 independent of @xmath2 such that @xmath207 the proof of   is postponed until appendix  [ sec : proof_poincare ] .",
    "following the same arguments , we also see that there exists a constant @xmath100 independent of @xmath2 such that @xmath208 where , we recall , the notation @xmath209 has been defined in  .",
    "the condition @xmath210 = 0 $ ] ( present in the definition of @xmath109 ) is actually not needed for   to hold , given that @xmath211 on @xmath54 .      before we get to the proof of theorem  [ theo : main ] , we first need to collect here some standard trace theorems ( which were already used and proved in  @xcite ) and results on the convergence of oscillating functions",
    ". we refer to the textbooks  @xcite for more details .",
    "remark that only lemma  [ lem : malin ] is restricted to the two - dimensional setting .",
    "first we recall the definition , borrowed from e.g.  ( * ? ? ?",
    "* definition b.30 ) , of the @xmath212 space .    for any open domain @xmath213",
    ", we define the norm @xmath214 where @xmath215 and define the space @xmath216    [ [ trace - inequalities ] ] trace inequalities + + + + + + + + + + + + + + + + + +    we have the following trace results :    [ lem : trace ] there exists @xmath100 ( depending only on the regularity of the mesh ) such that , for any @xmath217 and any edge @xmath218 , we have @xmath219 under the additional assumption that @xmath173 , we have @xmath220 and @xmath221    these bounds are classical results ( see e.g.  @xcite ) and are proved in  ( * ? ? ?",
    "* section 4.2 ) .",
    "the following result is a direct consequence of   and  :    [ coro : trace ] consider an edge @xmath222 , and let @xmath223 denote all the triangles sharing this edge",
    ". there exists @xmath100 ( depending only on the regularity of the mesh ) such that @xmath224 \\ , \\|^2_{l^2(e ) } \\leq c h \\sum_{t",
    "\\in t_e }   \\| \\nabla v \\|^2_{l^2(t)}\\ ] ] and @xmath225 \\ , \\|^2_{h^{1/2}(e ) } \\leq c ( 1+h ) \\sum_{t \\in t_e }   \\| \\nabla v \\|^2_{l^2(t)}.\\ ] ]    [ [ averages - of - oscillatory - functions ] ] averages of oscillatory functions + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we shall also need the following classical result .    [ lem : malin ] let @xmath226 be a @xmath227-periodic function with zero mean .",
    "let @xmath228 be a function defined on the interval @xmath229 $ ] that vanishes at least at one point of @xmath229 $ ] .",
    "then , for any @xmath230 , @xmath231    the proof is simple and essentially based upon an integration by parts .",
    "let @xmath232 be a primitive of @xmath233 : @xmath234 the function @xmath232 is @xmath227-periodic ( as the average of @xmath233 over its period vanishes ) and bounded , with @xmath235 .",
    "supposing that the function @xmath58 vanishes at the point @xmath236 $ ] , we write @xmath237 hence @xmath238 by a similar computation , @xmath239 the above two bounds imply the result .",
    "to prove theorem  [ theo : main ] , it is possible to follow the same arguments as in our earlier work  @xcite . we follow here a different path , so as to show that other strategies are possible .",
    "note that we use here and in  @xcite the same technical ingredients , including those recalled in section  [ ssec : ingredients ] and an interpolation argument , see step 1c below .",
    "let @xmath65 be the solution to the reference problem   with the right - hand side  @xmath58 , and let @xmath75 be the @xmath76-orthogonal projection of @xmath58 on the space of piecewise constant functions .",
    "we recall the following standard finite element interpolation result : there exists @xmath100 independent of @xmath67 and @xmath58 such that @xmath240 we introduce @xmath241 \\ \\phi_e(x),\\ ] ] where the functions @xmath167 and @xmath168 have been defined in section  [ ssec : msfem ] by   and   respectively .",
    "we recall that , if @xmath163 ( resp .",
    "@xmath164 ) , then @xmath165 ( resp .",
    "@xmath166 ) .",
    "we see from   that @xmath71 .",
    "we next decompose the exact solution @xmath65 of   in the form @xmath242 by definition of @xmath167 and @xmath168 , we have , for all edges @xmath222 and all triangles @xmath217 , that @xmath243 the estimate   is proved by estimating @xmath244 in step 1 below and next @xmath245 in step 2 .    in what follows ,",
    "we use the shorthand notation @xmath246 for all functions @xmath233 .",
    "the notation @xmath100 stands for a constant that is independent from @xmath247 , @xmath67 , @xmath58 and @xmath65 , and that may vary from one line to the next .",
    "[ [ step-1-estimation - of - u - v_h ] ] step 1 : estimation of @xmath248 : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    using the approximation of @xmath65 given by the homogenization result  , we write @xmath249 we now use the fact that @xmath250 on @xmath251 .",
    "we hence have that @xmath252 and likewise for the last term of  .",
    "equalities of the type   will often be used in the sequel .",
    "we thus write   as @xmath253 the fourth term in the above right - hand side vanishes . indeed , on each edge  @xmath144 , we know from   that @xmath254 is constant and @xmath255 .",
    "the third term can be written @xmath256 \\",
    "n \\cdot \\nabla ( w_\\varepsilon f).\\ ] ] indeed , @xmath257 ( see  ) and @xmath179 , hence @xmath258 has a well - defined trace on @xmath259 .",
    "we are thus left with @xmath260 \\",
    "n \\cdot \\nabla ( w_\\varepsilon f ) .",
    "\\label{eq : decompo_error}\\end{aligned}\\ ] ] we now successively bound the three terms of the right - hand side of  . loosely speaking :    *",
    "the first term is small because of the homogenization result  , that states that @xmath261 is indeed an accurate approximation of @xmath65 . *",
    "the second term is small because , at the leading order term in @xmath247 , the first factor in the integrand is equal to @xmath262 which is small due to  . * estimating the third term is more involved .",
    "an essential ingredient is the fact that @xmath197 is a periodic function .",
    "we are thus in position to apply our lemma  [ lem : malin ] .",
    "[ [ step-1a ] ] step 1a + + + + + + +    the first term of   is easily estimated as follows : @xmath263 where we have used the discrete cauchy - schwarz inequality in the second line and the homogenization result   in the third line .    [ [ step-1b ] ] step 1b + + + + + + +    we next turn to the second term of the right - hand side of  , that we write as follows , using the corrector equation   and  : @xmath264 we thus obtain @xmath265 is defined by   and where , in the last line , we have used  ,   and  . we deduce that @xmath266 step 1c + + + + + + +    the final stage of step 1",
    "is devoted to bounding the third term of the right - hand side of  .",
    "\\nonumber \\\\ & \\leq & c \\ , { \\varepsilon}\\left ( \\sqrt { \\frac{{\\varepsilon}}{h } } \\ , \\| f \\|_{h^1(\\omega ) } + \\sqrt{{\\varepsilon}h } \\ , \\| \\nabla f \\|_{h^1(\\omega ) }   \\right )    \\label{eq : terme3_1}\\end{aligned}\\ ] ]",
    "\\ , \\| \\nabla f \\|_{l^2(\\omega ) } , \\label{eq : terme3_2}\\end{aligned}\\ ] ] where we have used  ,   of corollary  [ coro : trace ] and   of lemma  [ lem : trace ] .",
    "we are now left with the third term of the right - hand side of  .",
    "this term has a prefactor @xmath203 and all we have to prove is that the term itself is bounded . using again  ,   of lemma  [ lem : trace ] and   of corollary  [ coro : trace ] , we obtain @xmath294 \\ w_\\varepsilon \\",
    "n \\cdot \\nabla f \\right| \\\\ & \\leq & c \\varepsilon^2 \\sum_{e\\in \\mathcal{e}_h } \\| \\nabla f \\|_{l^2(e ) } \\ , \\| \\ , [ [ \\phi ] ] \\ , \\|_{l^2(e ) } \\nonumber \\\\ & \\leq & c \\varepsilon^2   \\left ( \\sum_{e\\in \\mathcal{e}_h } \\| \\nabla f \\|^2_{l^2(e ) } \\right)^{1/2 }   \\left ( \\sum_{e\\in \\mathcal{e}_h } \\| \\ , [ [ \\phi ] ] \\ , \\|^2_{l^2(e ) } \\right)^{1/2 } \\nonumber \\\\ & \\leq & c \\varepsilon^2   \\left ( \\frac{1}{h } \\sum_{t\\in \\mathcal{t}_h } \\| \\nabla f \\|^2_{h^1(t ) } \\right)^{1/2 }   \\left ( h \\sum_{t\\in \\mathcal{t}_h } \\| \\nabla \\phi \\|^2_{l^2(t ) } \\right)^{1/2 } \\nonumber \\\\ & \\leq & c \\varepsilon^2 \\| \\nabla f\\|_{h^1(\\omega ) } \\ , | \\phi |_{h^1_h(\\omega_{\\varepsilon})}. \\label{eq : terme3_3}\\end{aligned}\\ ] ]    collecting  , , and  , we obtain that the third term of the right - hand side of   satisfies @xmath295 \\",
    "n \\cdot \\nabla ( w_\\varepsilon f ) \\right| \\leq   c { \\varepsilon}\\left (   \\sqrt { \\frac{{\\varepsilon}}{h } } \\ , \\| f \\|_{h^1(\\omega ) } + \\sqrt{{\\varepsilon}h } \\",
    ", \\| \\nabla f \\|_{h^1(\\omega ) }   \\right . \\\\",
    "+   h \\| \\nabla f \\|_{l^2(\\omega ) }   + \\varepsilon \\| \\nabla f\\|_{h^1(\\omega ) } \\big ) | \\phi |_{h^1_h(\\omega_{\\varepsilon})}. \\label{eq : bound_3}\\end{gathered}\\ ] ]    [ [ conclusion - of - step-1 ] ] conclusion of step 1 : + + + + + + + + + + + + + + + + + + + + +    collecting  ,  ,   and  , we deduce that @xmath296 this concludes the first step of the proof .",
    "[ [ step-2-estimation - of - u_h - v_h ] ] step 2 : estimation of @xmath297 : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    denoting by @xmath298 , where @xmath60 is the solution to   and @xmath277 is defined by  , we observe that @xmath299 where , we recall , @xmath113 is defined by  . the first term is estimated using  . the main part of this step is thus devoted to estimating the second term of  .    since @xmath300",
    ", we deduce from the discrete variational formulation   that @xmath301 since @xmath302 on @xmath251 , we can take the integral in the third term of   only on @xmath303 . using   for the fourth term",
    ", we obtain that @xmath304    we now successively bound the three terms of the right - hand side of  .",
    "the first term is estimated simply using homogenization theory , since it is not specifically related to the discretization .",
    "we write , as in  , @xmath305 \\ , n \\cdot \\nabla ( w_{\\varepsilon}f),\\ ] ] and we note that @xmath306 = 0 $ ] .",
    "we therefore can use the same arguments as in step 1c , and obtain , similarly to  , @xmath307 \\",
    "n \\cdot \\nabla ( w_\\varepsilon f ) \\right| \\\\ \\leq   c { \\varepsilon}\\left (   \\sqrt { \\frac{{\\varepsilon}}{h } } \\ , \\| f \\|_{h^1(\\omega ) }   +   ( \\varepsilon + h ) \\| \\nabla f\\|_{h^1(\\omega ) } \\right ) | \\phi_h |_{h^1_h(\\omega_{\\varepsilon})}.",
    "\\label{eq : bound_3new}\\end{gathered}\\ ] ]    we next turn to the third term of the right - hand side of  , which is estimated using the cauchy - schwarz inequality , the fact that the second factor is bounded and the first factor satisfies a poincar inequality . indeed , using the regularity   of @xmath197 and the poincar inequality   satisfied by @xmath308 , we have @xmath309 collecting  , , and  , we deduce that @xmath310 , and using  , we deduce that @xmath311    [ [ conclusion ] ] conclusion + + + + + + + + + +    we deduce from  , and the triangle inequality that @xmath312 which is the desired estimate  .",
    "this concludes the proof of theorem  [ theo : main ] .",
    "we now solve   for some particular settings , comparing our approach with other existing msfem type methods . as pointed out in the introduction",
    ", we numerically explore the influence of three parameters :    * \\(i ) the boundary conditions imposed to define the msfem basis functions and ( ii ) the addition , or not , of bubble functions .",
    "to do so , in section  [ sec : num - comp ] , we compare the approach we propose with other existing approaches , considering two versions of each approach , one with and the other without bubble functions . *",
    "\\(iii ) the possible intersections of the perforations with the edges of mesh elements .",
    "we address this question in section  [ sec : num - rob ] , and check there the robustness of our approach with respect to the location of the perforations : the fact that the mesh intersects , or does not intersect , the perforations has a very little influence on the ( good ) accuracy of our approach , in contrast to other approaches .",
    "we eventually turn in section  [ sec : non - per ] to a non - periodic test - case , where we again show the excellent performance of our approach .",
    "we mention that , in all our numerical experiments , we actually do not directly solve   but a penalized version of this problem : find @xmath313 such that @xmath314 with the following penalization parameters : @xmath315 where @xmath316 is the fine - scale mesh size used to precompute the highly oscillatory basis functions ( see  @xcite for more details on the penalization approach and on the above choice of @xmath317 and @xmath318 ) . in practice",
    ", the chosen fine - scale mesh size always satisfies @xmath319 .",
    "note that , because we use a penalized approach , we do not have to mesh @xmath53 , which could be cumbersome and could possibly request elements of small size ( comparable to the small size @xmath247 present in the geometry of @xmath53 ) . in addition , if we were working with a mesh of @xmath53 , we might face difficulties with the oversampling variant of the msfem approach that we compare here with our approach . indeed , edges of the oversampling domain may intersect the perforations .",
    "properly defining the msfem basis functions in such a case would not be straightforward .",
    "for these two reasons , we consider a penalization approach .",
    "we solve   on the domain @xmath320 , with the right - hand side  @xmath321 , and we take @xmath1 the set of discs of radius @xmath322 periodically located on the regular grid of period @xmath323 . for the reference solution , we use a mesh of size @xmath324 .",
    "the approaches we compare our approach with are the following four respective approaches :    * the standard q1 finite element method on the coarse mesh of size @xmath67 .",
    "of course , we do not expect that method to perform well for this multiscale problem and we only consider it as a `` normalization '' . * the msfem with linear boundary conditions .",
    "although this method is now a bit outdated , it is still considered as the primary msfem approach , upon which all the other variants are built . * the msfem with oscillatory boundary conditions .",
    "this variant ( in the form presented in  @xcite ) is restricted to the two - dimensional setting .",
    "it uses boundary conditions provided by the solution to the oscillatory ordinary differential equation obtained by taking the trace of the original equation on the edge considered .",
    "the approach performs fairly well on a number of cases , although it may also fail .",
    "* the variant of msfem using oversampling . this variant is often considered as the `` gold standard '' , although it includes a parameter ( the oversampling ratio ) , the value of which should be carefully chosen . when this parameter is taken large ,",
    "the method becomes ( possibly prohibitively ) expensive .",
    "in addition , we consider for each of those approaches , and for our specific crouzeix - raviart type approach , two variants : one with , and the other without a specific enrichment of the basis set elements using bubble functions .",
    "for all approaches but the crouzeix - raviart type approach that we propose , the bubble @xmath325 on the quadrangle @xmath326 is defined as the solution to @xmath327 for the crouzeix - raviart approach , the bubble function @xmath325 has been defined in section  [ ssec : msfem ] by  .",
    "other variants of the msfem approach have also been proposed , such as the petrov - galerkin variant with oversampling  @xcite .",
    "we do not consider this variant here , and refer to our previous work  @xcite for some elements of comparison ( in a slightly different context ) .",
    "for a given mesh size @xmath67 , the cost for computing the basis functions ( offline stage ) varies from one msfem variant to the other .",
    "however , for a fixed @xmath67 , all methods without ( respectively , with ) bubble functions essentially share the same cost to solve the macroscopic problem on @xmath7 ( online stage ) .",
    "more precisely , for a given cartesian mesh , and when using variants including the bubble functions , there are 1.5 times more degrees of freedom in our crouzeix - raviart approach than in the three alternative msfem approaches mentioned above . since a logarithmic scaling is used for the x - axis in the figures below , this extra cost does not change the qualitative conclusions we draw below .",
    "the numerical results we have obtained in the regime where the meshsize @xmath67 is of the order of , or larger than , the parameter @xmath247 are presented on  figure  [ fig : errors ] . for all values of the meshsize",
    "@xmath67 , and for both @xmath76 and broken @xmath66 norms , a definite superiority of our approach over all other approaches is observed , and the interest of adding bubble functions to the basis set is , for each approach , also evident .",
    "a side remark is the following . on figure  [ fig : errors ] , we observe that , when using bubble functions , the error decreases as @xmath67 increases .",
    "this might seem counterintuitive at first sight .",
    "note however that , when @xmath67 increases , the cost of computing each basis function increases , as we need to solve a local problem ( discretized on a mesh of size @xmath316 controlled by the value of @xmath247 ) on a larger coarse element .",
    "in contrast to traditional fem , increasing @xmath67 does not correspond to reducing the overall computational cost .",
    "for msfem approaches , increasing @xmath67 actually corresponds to decreasing the online cost but increasing the offline cost .",
    "the regime of interest is that of moderate values of @xmath67 , for which the offline stage cost is acceptable .",
    "we only show the right part of figure  [ fig : errors ] ( corresponding to large values of @xmath67 , leading to a prohibitively expensive offline stage ) for the sake of completeness",
    ".    , left , and @xmath66-broken , right ) errors with various approaches in the regimes @xmath328 and @xmath329 : fem  the standard q1 finite elements , no os  msfem with linear boundary conditions , osc  msfem with oscillatory boundary conditions , os  msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , cr  the msfem approach  la crouzeix - raviart we propose .",
    "results for all these methods are represented by solid lines .",
    "the dashed lines correspond to the variants of these methods where we enrich the finite element spaces using bubble functions .",
    "[ fig : errors],title=\"fig : \" ] , left , and @xmath66-broken , right ) errors with various approaches in the regimes @xmath328 and @xmath329 : fem  the standard q1 finite elements , no os  msfem with linear boundary conditions , osc  msfem with oscillatory boundary conditions , os  msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , cr  the msfem approach  la crouzeix - raviart we propose .",
    "results for all these methods are represented by solid lines .",
    "the dashed lines correspond to the variants of these methods where we enrich the finite element spaces using bubble functions .",
    "[ fig : errors],title=\"fig : \" ]    to get a better understanding of the approaches with bubble functions , we have run a series of tests in a regime different from that of figure  [ fig : errors ] , where the meshsize @xmath67 is of the order of , or larger than , the parameter @xmath247 . on figure",
    "[ fig : errors_regime ] , we present results corresponding to the regime @xmath331 .",
    "this is performed only for the purpose of analyzing the behaviour of the methods and this is of course not the practical regime where we want to use msfem approaches .",
    "it is however useful to observe how the various numerical approaches behave in that regime .",
    "we consider the same problem as above , with @xmath332 instead of 0.03 , and where the meshsize @xmath67 ranges from @xmath333 to @xmath334 , so that indeed @xmath67 is smaller ( and even much smaller ) than @xmath247 .",
    "the reference solution is again computed on a mesh of size @xmath324 .",
    "as expected , we then observe that all errors uniformly decrease when @xmath67 decreases , in contrast to the situation displayed on figure  [ fig : errors ] and commented upon above .",
    "we then recover the classical behavior of numerical approaches in the limit of fine discretizations .",
    ", left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] , in the regime when @xmath331 .",
    "[ fig : errors_regime],title=\"fig : \" ] , left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] , in the regime when @xmath331 .",
    "[ fig : errors_regime],title=\"fig : \" ]    for the sake of completeness , we have also considered another oversampling ratio for the msfem oversampling approach we compare our approach with .",
    "recall indeed that , on figures  [ fig : errors ] and  [ fig : errors_regime ] , we have considered an oversampling ratio equal to 3 .",
    "we now additionally consider the method with an oversampling ratio equal to 2 .",
    "results are reported on figure  [ fig : over ] . as expected , the accuracy of msfem increases when the oversampling ratio increases . the artificial dirichlet boundary conditions used to define basis functions are then further away from the relevant part of the mesh element , and their potentially poor behavior close to the boundary has a smaller influence .",
    "of course , as the oversampling ratio increases , the cost of computing these basis functions increases .",
    "we observe that , with the msfem approach  la crouzeix - raviart we propose , we obtain a better accuracy ( again both in @xmath66 and @xmath76 norms ) than with the msfem approach that uses an oversampling ratio of 3 ( i.e. , that computes basis functions by solving local problems on quadrangles of size @xmath330 ) .    , left , and @xmath66-broken , right )",
    "errors with various approaches ( dashed lines : using bubble functions ; solid lines : without bubble functions ) : os  msfem with various oversampling ratios , cr  the msfem approach  la crouzeix - raviart we propose .",
    "[ fig : over],title=\"fig : \" ] , left , and @xmath66-broken , right ) errors with various approaches ( dashed lines : using bubble functions ; solid lines : without bubble functions ) : os  msfem with various oversampling ratios , cr  the msfem approach  la crouzeix - raviart we propose .",
    "[ fig : over],title=\"fig : \" ]    figures  [ fig : errors ] ,  [ fig : errors_regime ] and  [ fig : over ] show that , for any of the numerical approaches we have considered , the relative @xmath76 error is always smaller than the relative @xmath66 error .",
    "the former presumably converges with a better rate ( in terms of @xmath247 and @xmath67 ) than the latter , although establishing sharp @xmath76 error estimates for msfem - type approaches is quite involved ( see e.g.  @xcite ) .      in this section and in the following one ,",
    "we perform a series of tests with a different , specific purpose . as a major motivation for advocating our approach",
    "is the flexibility of crouzeix - raviart type finite elements in terms of boundary conditions , we expect our approach to be particularly effective ( and therefore considerably superior to other approaches ) when some edges of the mesh happen to intersect perforations of the domain . the more such intersections , the more important the difference . in order to check this expected behaviour",
    ", we design the following test .",
    "we solve   on the domain @xmath320 , with a constant right - hand side  @xmath335 , and we take @xmath1 the set of discs of radius @xmath336 periodically located on the regular grid of period @xmath337 .",
    "we compute the reference solution , and consider 3 variants of msfem : the linear version , the oversampling version and the crouzeix - raviart version .",
    "the last three approaches are implemented in the variant that includes bubble functions in the basis set and they are run on a mesh of size @xmath338 .",
    "we now perform two sets of numerical experiments .",
    "they are identical except for what concerns the relative position of the mesh with the perforations .",
    "the difference between the two sets of tests is that , from one set of tests to the other one , the perforations are shifted by @xmath339 in the directions @xmath340 and @xmath341 . in our test  1 , no edge intersects any perforation , while , on our test  2 , many edges actually intersect perforations .",
    "to some extent , the situation of test 1 is the best case scenario ( where as few edges as possible intersect the perforations ) and the other situation is the worst case scenario .",
    "the numerical solutions computed for each of the situations considered is shown on figures  [ fig : decalage - test1 ] and  [ fig : decalage - test2 ] , for test  1 and test  2 respectively .",
    "the numerical errors observed , computed both in @xmath76 and @xmath66-broken norms , are correspondingly displayed on tables  [ table : test1 ] and  [ table : test2 ] respectively .",
    "more than the actual values obtained for each case , this is the trend of difference between table  [ table : test1 ] and table  [ table : test2 ] that is the practically relevant feature .",
    "a comparison between the two tables indeed show that , qualitatively and in either of the norms used for measuring the error , the linear version and the oversampling version of msfem are both much more sensitive to edges intersecting perforations than the crouzeix - raviart version of msfem .",
    "in particular , the gain of our approach with respect to the linear version of msfem is much higher in our test 2 ( which is , from the geometrical viewpoint , the worst case scenario ) than in test 1 .",
    "this confirms the intuition of a better flexibility of our approach .",
    "this also allows for expecting a much better behaviour of that approach for nonperiodic multiscale perforated problems for which it is extremely difficult , practically , to avoid repeated intersections of perforations with mesh edges .",
    "this is confirmed by our numerical experiments of section  [ sec : non - per ] .    ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test1],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test1],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test1],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test1],title=\"fig : \" ]    ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test2],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test2],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test2],title=\"fig : \" ] ) , msfem with linear boundary conditions , msfem with oversampling ( where the size of the quadrangles used to compute the basis functions is @xmath330 ) , proposed msfem  la crouzeix - raviart .",
    "[ fig : decalage - test2],title=\"fig : \" ]      a major motivation for using msfem approaches is to address non - periodic cases , for which homogenization theory does not provide any explicit approximation procedure .",
    "we have tested several such examples , two of them being shown on figure  [ fig : ex - non - per ] . for each of them , the domain @xmath342 is meshed using quadrangles of size @xmath67 , with @xmath343 .",
    "the reference solution is again computed on a mesh of size @xmath324 .     according to the uniform distribution .",
    "left : perforations are made from 100 rectangles , the width and height of which are uniformly distributed between 0.02 and 0.05 .",
    "right : perforations are made from 60 rectangles , the width ( resp .",
    "the height ) of which is uniformly distributed between 0.02 and 0.04 ( resp .",
    "0.02 and 0.4 ) .",
    "[ fig : ex - non - per],title=\"fig : \" ]   according to the uniform distribution . left : perforations are made from 100 rectangles , the width and height of which are uniformly distributed between 0.02 and 0.05 .",
    "right : perforations are made from 60 rectangles , the width ( resp .",
    "the height ) of which is uniformly distributed between 0.02 and 0.04 ( resp .",
    "0.02 and 0.4 ) .",
    "[ fig : ex - non - per],title=\"fig : \" ]    errors are shown on figure  [ fig : errors - non - per3 ] ( resp . figure  [ fig : errors - non - per5 ] ) for the test - case shown on the left ( resp .",
    "right ) part of figure  [ fig : ex - non - per ] ( we have obtained similar results for several other test cases not shown here for the sake of brevity ) .",
    "we again see that our approach provides results at least as accurate as , and often more accurate than the msfem approach with oversampling on quadrangles of size @xmath330 .",
    "our approach outperforms all the other variants of msfem that we have tested .",
    "these results confirm the definite interest of the variant we introduce in this article",
    ".    , left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] for the test - case shown on the left - part of figure  [ fig : ex - non - per ] .",
    "[ fig : errors - non - per3],title=\"fig : \" ] , left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] for the test - case shown on the left - part of figure  [ fig : ex - non - per ] .",
    "[ fig : errors - non - per3],title=\"fig : \" ]    , left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] for the test - case shown on the right - part of figure  [ fig : ex - non - per ] .",
    "[ fig : errors - non - per5],title=\"fig : \" ] , left , and @xmath66-broken , right ) errors with the same approaches as on figure  [ fig : errors ] for the test - case shown on the right - part of figure  [ fig : ex - non - per ] .",
    "[ fig : errors - non - per5],title=\"fig : \" ]    * acknowledgments . * the work of the first two authors is partially supported by onr under grant n00014 - 12 - 1 - 0383 and by eoard under grant fa8655 - 13 - 1 - 3061 .",
    "the third author acknowledges the hospitality of inria .",
    "we thank william minvielle for his remarks on a preliminary version of this article .",
    "we collect in this appendix the proof of two technical results used in section  [ sec : proof ] , namely the poincar inequality   and the homogenization result  .",
    "consider the unit square @xmath344 in dimension @xmath345 , and some smooth perforation @xmath191 .",
    "there exists a constant @xmath346 such that , for any @xmath347 with @xmath348 on @xmath349 , we have @xmath350 let @xmath351 be the perforated unit cell after translation by the vector @xmath352 .",
    "we scale @xmath353 by a factor @xmath247 and repeat this pattern periodically ( with a period @xmath247 in all directions ) for a finite number of times .",
    "we hence introduce @xmath354 for some @xmath355 and @xmath356 in @xmath357 , that we can also write as @xmath358 where @xmath359 is the quadrangle @xmath360 and @xmath361 is the set of perforations @xmath362 . summing the inequality   for all cells and next scaling the geometry , we obtain that , for any @xmath363 with @xmath348 on @xmath364 , we have @xmath365 where @xmath366 is the same constant as in  .",
    "consider now @xmath367 .",
    "there exists a set @xmath102 of the form   such that @xmath368 ( it is sufficient to include @xmath53 into a sufficiently large perforated quadrangle ) .",
    "we now introduce @xmath369 , defined on @xmath370 by @xmath371 and readily see that @xmath372 and @xmath373 on @xmath364 . the function @xmath369",
    "thus satisfies  .",
    "we hence obtain @xmath374 this completes the proof of  .",
    "let @xmath375 be a smooth function on @xmath376 that vanishes on @xmath107 , satisfies @xmath377 on @xmath376 and is equal to 1 in @xmath378 . using the fact that @xmath7 is smooth , it is easy to see that such a function can be constructed for each  @xmath230 and we can suppose that it satisfies @xmath379 for some universal constant @xmath380 .",
    "set @xmath381 , where @xmath382 , with @xmath197 the solution to  .",
    "we compute @xmath383 on @xmath10 , where we have used   in the first line and the fact that @xmath384 on @xmath385 in the last line . using the regularity   of @xmath197 and the properties   of @xmath375",
    ", we deduce that @xmath386 where @xmath387 is defined by  .",
    "we now notice that @xmath388 and @xmath389 vanish on @xmath390 , hence @xmath348 on @xmath251 .",
    "an integration by parts thus yields @xmath391 inserting   in  , we obtain @xmath392 .",
    "we conclude by using the triangle inequality @xmath393 where both terms in the above right - hand side are bounded by @xmath394 .",
    "this yields the desired bound  .",
    "t. arbogast , _ mixed multiscale methods for heterogeneous elliptic problems _ , in _ numerical analysis of multiscale problems _ , i.g .",
    "graham , t.y .",
    "hou , o. lakkis and r. scheichl , eds . ,",
    "lecture notes in computational science and engineering , vol .",
    "83 , springer , pp .",
    "243 - 283 , 2011 .",
    "l. carballal perdiz , _",
    "etude dune mthodologie multichelles applique  diffrents problmes en milieu continu et discret _ ( in french ) , thse de luniversit toulouse iii , 2010 , http://thesesups.ups - tlse.fr/1170/.      d. cioranescu and f. murat , _ a strange term coming from nowhere _ , in _ topics in the mathematical modelling of composite materials _ , a. cherkaev and r. kohn , eds .",
    ", progress in nonlinear differential equations and their applications , vol .",
    "31 , birkhuser , pp .  45 - 93 , 1997 .                          t.y .",
    "hou , x .- h . wu and y. zhang , _ removing the cell resonance error in the multiscale finite element method via a petrov - galerkin formulation _ , communications in mathematical sciences , 2(2):185 - 205 , 2004 ."
  ],
  "abstract_text": [
    "<S> we follow up on our previous work  @xcite where we have studied a multiscale finite element ( msfem ) type method in the vein of the classical crouzeix - raviart finite element method that is specifically adapted for highly oscillatory elliptic problems . </S>",
    "<S> we adapt the approach to address here a multiscale problem on a perforated domain . </S>",
    "<S> an additional ingredient of our approach is the enrichment of the multiscale finite element space using bubble functions . </S>",
    "<S> we first establish a theoretical error estimate . </S>",
    "<S> we next show that , on the problem we consider , the approach we propose outperforms all dedicated existing variants of msfem we are aware of . </S>"
  ]
}