{
  "article_text": [
    "in this paper , we propose a simple analytical approximation for backward stochastic differential equations ( bsdes ) .",
    "these equations were introduced by bismut ( 1973 )  @xcite for the linear case and later by pardoux and peng ( 1990 )  @xcite for the general case , and have earned strong academic interests since then .",
    "they are particularly relevant for the pricing of contingent claims in constrained or incomplete markets , and for the study of recursive utilities as presented by duffie and epstein ( 1992 )  @xcite .",
    "for a recent comprehensive study with financial applications , one may consult yong and zhou ( 1999 )  @xcite , ma and yong ( 2000 )  @xcite and references therein .",
    "the importance of bsdes , or more specifically non - linear fbsdes which have non - linear generators coupled with some state processes satisfying the forward sdes , has risen greatly in recent years also among practitioners .",
    "the collapse of major financial institutions followed by the drastic reform of regulations make them well aware of the importance of counterparty risk management , credit value adjustments ( cva ) in particular . even in a very simple setup ,",
    "if there exists asymmetry in the credit risk between the two parties , the relevant dynamics of portfolio value follows a non - linear fbsde as clearly shown by duffie and huang ( 1996 )  @xcite .",
    "we have recently found that the asymmetric treatment of collateral between the two parties also leads to a non - linear fbsde  @xcite .",
    "furthermore , in may 2010 , regulators were forced to realize the importance of mutual interactions and feedback loops in the trading activities among financial firms , shocked by the astonishing flash crash of the dow jones index by almost @xmath0 points .",
    "once we take the feedback effects from the behavior of major players into account , we naturally end up with complicated coupled fbsdes .",
    "unfortunately , however , an explicit solution for a fbsde is only known for a simple linear example . in the last decade ,",
    "several techniques have been introduced by researchers , but they tend to be quite complicated for practical applications .",
    "they either require one to solve non - linear pdes , which are very difficult in general , or resort to quite time - consuming simulation .",
    "although regression based monte carlo simulation has been rather popular among practitioners for the pricing of callable products , the appropriate choice of regressors and attaining numerical stability becomes a more subtle issue for a general fbsde .",
    "in fact , in clear contrast to the pricing of callable products , one can not tell if the price goes up or down when one improves the regressors , which makes it particularly difficult to select the appropriate basis functions .    in this paper",
    ", we present a simple analytical approximation scheme for the non - linear fbsdes coupled with generic markovian state processes .",
    "we have perturbatively expanded the non - linear terms around the linearized fbsde , where the expansion can be made recursively to an arbitrary higher order . in each order of approximation , the required calculations are equivalent to those for standard european contingent claims . in order to carry out the perturbation scheme , we need to express the backward components explicitly in terms of the forward components for each order of approximation . for that purpose , we propose to use the asymptotic expansion of volatility for the forward components , which is now widely adopted to price various european contingent claims and compute optimal portfolios ( see , for examples @xcite and references therein for the recent developments and review . ) . in the case",
    "when the underlying processes have known distributions , of course , we can directly proceed to a higher order approximation without resorting to an asymptotic expansion .",
    "we have also studied a perturbation scheme in the pde framework , or in the so - called four step scheme  @xcite , for the generic fully - coupled non - linear fbsdes .",
    "we have shown that our perturbation method renders the original non - linear pde into the series of classical linear parabolic pdes , which are easy to handle with standard techniques .",
    "we then provided the corresponding probabilistic framework by using the equivalence between the two approaches .",
    "we have shown that , also in this case , the required calculations in a given order are equivalent to those for the classical european contingent claims . as a by - product , by applying the asymptotic expansion method to the corresponding probabilistic model ,",
    "it was actually found possible to derive an _ analytic expression _ for the solution of the non - linear pde up to a given order of perturbation .",
    "therefore , our method can be interpreted as a practical implementation of the four step scheme in the perturbative approach .",
    "the organization of of the paper is as follows : in section 2 , we will explain our new approximation scheme with perturbative expansion for generic decoupled fbsdes .",
    "then , in section 3 , we shall apply it to the two concrete examples to demonstrate how it works and test its numerical performance .",
    "one of them allows a direct numerical treatment by a simple pde and hence it is easy to compare the two methods . in the second example , we will consider a slightly more complicated model .",
    "we compare our approximation result to the detailed numerical study recently carried out by gobet et al .",
    "( 2005 )  @xcite using a regression - based monte carlo simulation . in section 4 ,",
    "we explain how to use standard asymptotic expansion procedures to express the backward components explicitly when the forward components do not have known distributions . in section 5 , we will give an extension of our method to the fully coupled non - linear fbsdes under the pde framework , and then formulate the equivalent probabilistic approach in section 5 .",
    "appendix contains slightly different scheme for coupled non - linear fbsdes which may be useful for the actual application .",
    "let us briefly describe the basic setup .",
    "the probability space is taken as @xmath1 and @xmath2 denotes some fixed time horizon .",
    "@xmath3 , @xmath4 is @xmath5-valued brownian motion defined on @xmath6 , and @xmath7 stands for @xmath8-augmented natural filtration generated by the brownian motion .",
    "we consider the following forward - backward stochastic differential equation ( fbsde ) dv_t&=&-f(x_t , v_t , z_t)dt+z_tdw_t + v_t&=&(x_t ) where @xmath9 takes the value in @xmath10 , and @xmath11 is assumed to follow a generic markovian forward sde dx_t=_0(x_t)dt+(x_t)dw_t  . here",
    ", we absorbed an explicit dependence on time to @xmath12 by allowing some of its components can be a time itself .",
    "@xmath13 denotes the terminal payoff where @xmath14 is a deterministic function of @xmath15 .",
    "the following approximation procedures can be applied in the same way also in the presence of coupon payments . @xmath16 and",
    "@xmath17 take values in @xmath5 and @xmath18 respectively , and `` @xmath19 '' in front of the @xmath20 represents the summation for the components of @xmath21-dimensional brownian motion . throughout this paper",
    ", we are going to assume that the appropriate regularity conditions are satisfied for the necessary treatments .      in order to solve the pair of @xmath22 in terms of @xmath23",
    ", we extract the linear term from the generator @xmath24 and treat the residual non - linear term as the perturbation to the linear fbsde .",
    "we introduce the perturbation parameter @xmath25 , and then write the equation as [ mod_bsde1 ] dv_t^()&=&c(x_t)v_t^()dt - g(x_t , v_t^(),z_t^())dt+z_t^()dw_t + v_t^()&=&(x_t )  , [ mod_bsde2 ] where @xmath26 corresponds to the original model by   as simply a parameter convenient to count the approximation order . the actual quantity that should be small for the approximation",
    "is the residual part @xmath27 . ]",
    "f(x_t , v_t , z_t)=-c(x_t)v_t+g(x_t , v_t , z_t )  .",
    "usually , @xmath28 corresponds to the risk - free interest rate at time @xmath29 , but it is not a necessary condition .",
    "one should choose the linear term in such a way that the residual non - linear term becomes as small as possible to achieve better convergence .",
    "a possible linear term @xmath30 in the driver @xmath24 can be absorbed by the measure change and hence the simple reinterpretation of the drift term of the forward components @xmath31 results in the form ( [ mod_bsde1 ] ) .",
    "see also the discussion in appendix .",
    "now , we are going to expand the solution of bsde ( [ mod_bsde1 ] ) and ( [ mod_bsde2 ] ) in terms of @xmath25 : that is , suppose @xmath32 and @xmath33 are expanded as v_t^()&= & v_t^(0)+v_t^(1)+^2 v_t^(2)+ + z_t^()&= & z_t^(0)+z_t^(1)+^2 z_t^(2)+ .",
    "once we obtain the solution up to the certain order , say @xmath34 for example , then by putting @xmath26 , _",
    "t= _ i=0^k v_t^(i ) , _",
    "t= _ i=0^k z_t^(i ) is expected to provide a reasonable approximation for the original model as long as the residual term is small enough to allow the perturbative treatment . as we will see , @xmath35 and @xmath36 , the corrections to each order can be calculated recursively using the results of the lower order approximations .",
    "for the zero - th order of @xmath25 , one can easily see the following equation should be satisfied : dv_t^(0)&=&c(x_t)v_t^(0)dt+z_t^(0)dw_t v_t^(0)&=&(x_t )  .",
    "it can be integrated as v_t^(0)=e[v0formula ] which is equivalent to the pricing of a standard european contingent claim .",
    "since we have e^-_0^t c(x_s)ds(x_t)=v_0^(0)+_0^t e^-_0^u c(x_s)dsz_u^(0)dw_u it can be shown that , by applying malliavin derivative @xmath37 , _",
    "t(e^-_0^t c(x_s)ds(x_t))=_t^t _ t ( e^-_0^u c(x_s)dsz_u^(0))dw_u + e^-_0^t c(x_s)dsz_t^(0 )  .",
    "thus , by taking conditional expectation @xmath38 $ ] , we obtain z_t^(0)=e  .",
    "now , let us consider the process @xmath39 .",
    "one can see that its dynamics is governed by [ 1stv ] d(v_t^()-v_t^(0))&=&c(x_t)(v_t^()-v_t^(0 ) ) -g(x_t , v_t^(),z_t^())dt+(z_t^()-z_t^(0))dw_t + v_t^()-v_t^(0)&=&0  .",
    "now , by extracting the @xmath25-first order terms , we can once again recover the linear fbsde dv_t^(1)&=&c(x_t)v_t^(1)dt - g(x_t , v_t^(0),z_t^(0))dt+z_t^(1)dw_t + v_t^(1)&=&0  , which leads to v_t^(1)=e   straightforwardly . by the same arguments in the zero - th order example",
    ", we can express the volatility term as z_t^(1)=e  . from these results",
    ", we can see that the required calculation is nothing more difficult than the zero - th order case as long as we have explicit expression for @xmath40 and @xmath41 .",
    "we can proceed the same way to the second order correction . by extracting the @xmath25-second order terms from @xmath42",
    ", one can show that dv_t^(2)&=&c(x_t)v_t^(2)dt-(g(x_t , v_t^(0),z_t^(0))v_t^(1 ) + _ z g(x_t , v_t^(0),z_t^(0))z_t^(1))dt+z_t^(2)dw_t + v_t^(2)&=&0 is a relevant fbsde , which is once again linear in @xmath43 . as before",
    ", it leads to the following expression straightforwardly : v_t^(2)&=&e +   + z_t^(2)&=&e  .",
    "+ in the above calculation , we have assumed the driver function is differentiable .",
    "if this is not the case , we need to approximate it using some smooth function or apply integration- by - parts technique for generalized wiener functionals ( e.g. a composite functional of dirac delta fucntion and a smooth wiener functional ) .    in exactly the same way",
    ", one can derive an arbitrarily higher order correction . due to the @xmath25 in front of the non - linear term @xmath27 ,",
    "the system remains to be linear in the every order of approximation .",
    "however , in order to carry out explicit evaluation , we need to give malliavin derivative explicitly in terms of the forward components . we will discuss this issue in the next .",
    "firstly , let us introduce a @xmath44 matrix process @xmath45 , for @xmath46 $ ] , as the solution for the following forward sde : [ ysde1 ] d(y_t , u)^i_j&=&_k=1^d ( _ k ^i_0(x_u)(y_t , u)^k_j du+ _",
    "k ^i(x_u)(y_t , u)^k_j dw_u ) + ( y_t , t)^i_j&=&^i_j  , [ ysde2 ] where @xmath47 denotes the differential with respect to the @xmath34-th component of @xmath12 , and @xmath48 denotes kronecker delta .",
    "now , for malliavin derivative , we want to express , for @xmath46 $ ] , ein terms of @xmath23 , where @xmath49 is a some deterministic function of @xmath12 , in general . thank to the known chain rule of malliavin derivative , we have _ t(e^-_t^uc(x_s)dsg(x_u))&=&_i=1^d\\{e^-_t^u",
    "c(x_s)ds_i g(x_u ) ( _ t x^i_u ) + & & -e^-_t^u c(x_s)dsg(x_u)(_t^u _",
    "i c(x_s)(_t x^i_s)ds)}. thus , it is enough for our purpose to evaluate @xmath50 . since we have ( _ t x^i_u)=_k=1^d(_t^u _",
    "k^i_0(x_s)(_t x^k_s)ds+ _ t^u _ k^i(x_s)(_t x^k_s)dw_s ) + ^i(x_t ) it can be shown that @xmath51 follows the next sde : d(_tx_u^i)&=&_k=1^d(_k^i_0(x_u)(_t x_u^k)du+_k^i(x_u)(_tx_u^k)dw_u ) + ( _ t x^i_t)&=&^i(x_t )  .",
    "thus , comparing to eqs .",
    "( [ ysde1 ] ) and ( [ ysde2 ] ) , we can conclude that ( _ t x_u)=y_t , u ( x_t )  .",
    "[ mdy ] as a result , combining the sde for @xmath45 and the markovian property of @xmath12 , one can confirm that the conditional expectation eis actually given by a some function of @xmath23 .",
    "therefore , in principle , both of the backward components can be expressed in terms of @xmath23 in each approximation order .",
    "in fact , this is an easy task when the underlying process has a known distribution . in the next section ,",
    "we present two such models , and demonstrate how our approximation scheme works .",
    "we will also compare our approximate solution to the direct numerical results obtained from , such as pde and monte carlo simulation .",
    "however , in more generic situations , we do not know the distribution of @xmath12 .",
    "we will explain how to handle the problem in this case using the asymptotic expansion method for the forward components in sec.[asymptotic ] .",
    "as the first example , we consider a toy model for a forward agreement on a stock with bilateral default risk of the contracting parties , the investor ( party-@xmath52 ) and its counterparty ( party-@xmath53 ) .",
    "the terminal payoff of the contract from the view point of the party-@xmath52 is ( s_t)=s_t - k where @xmath54 is the maturity of the contract , and @xmath55 is a constant . we assume the underlying stock follows a simple geometric brownian motion : ds_t = rs_t dt+s_t dw_t where the risk - free interest rate @xmath21 and the volatility @xmath56 are assumed to be positive constants .",
    "the default intensity of party-@xmath57 @xmath58 is specified as h_1= , h_2=+h where @xmath59 and @xmath60 are also positive constants . in this setup ,",
    "the pre - default value of the contract at time @xmath29 , @xmath61 , follows   dv_t&=&rv_t dt - h_1(-v_t,0)dt+h_2(v_t,0)dt+z_tdw_t + & = & ( r+)v_t dt+h(v_t,0)dt + z_t dw_t + v_t&=&(s_t )  .",
    "now , following the previous arguments , let us introduce the expansion parameter @xmath25 , and consider the following fbsde : dv_t^()&=&v_t^()dt -g(v_t^())dt+z_t^()dw_t + v_t^()&=&(s_t ) + ds_t&=&s_t(rdt+dw_t )  , where we have defined @xmath62 and @xmath63 .      in the zero - th order , we have dv_t^(0)&=&v_t^(0)dt+z_t^(0)dw_t + v_t^(0)&=&(s_t )  .",
    "hence we simply obtain v_t^(0)&=&e + & = & e^-(t - t)(s_t e^r(t - t)-k ) and z_t^(0)=e^-(t - t)s_t  .      in the first order",
    ", we have dv_t^(1)&=&v_t^(1)dt - g(v_t^(0))dt+z_t^(1)dw_t + v_t^(1)&=&0  .",
    "thus , we obtain v_t^(1)&=&e + & = & -e^-(t - t)h_t^t edu + & = & -e^-(t - t)h_t^t c(u;t , s_t)du  , where c(u;t , s_t)&=&s_te^r(t - t)n(d_1(u;t , s_t))-kn(d_2(u;t , s_t ) ) + d_1(2)(u;t , s_t)&=&(()^2 ( u - t ) )  , and @xmath64 denotes the cumulative distribution function for the standard normal distribution .",
    "we can also derive z_t^(1)=-e^-(t - t)hs_t_t^t n(d_1(u;t , s_t))du  .",
    "finally , let us consider the second order value adjustment . in this case ,",
    "the relevant dynamics is given by dv_t^(2)&=&v_t^(2)dt - g(v_t^(0))v_t^(1)dt+z_t^(2)dw_t + v_t^(2)&=&0  .",
    "as a result , we have v_t^(2)&=&e + & = & e^-(t - t)h^2 _ t^t _ u^t eds du which can be evaluated as v_t^(2)=e^-(t - t)h^2 _ t^t _ u^t _ -d_2(u;t , s_t)^(z)c(s;u , s_u(z , s_t))dzdsdu  , where we have defined s_u(z , s_t)=s_t e^(r-^2)(u - t)+z and ( z)=e^-z^2  .      for this simple model",
    ", we can directly evaluate the contract value @xmath61 by numerically solving the pde : v(t , s)+ ( rsv(t , s)+^2 s^2 v(t , s ) ) -v(t , s)=0 with the boundary conditions v(t , s)&=&s - k + v(t , m)&=&e^-(+h)(t - t)(me^r(t - t)-k ) , mk + v(t , m)&=&e^-(t - t)(me^r(t - t)-k ) , mk  .    in fig .",
    "[ cva ] , we have plot the numerical results of the forward contract with bilateral default risk with various maturities with the direct solution from the pde .",
    "we have used & & r=0.02,=0.01 , h=0.03 , + & & = 0.2,s_0=100  , where the strike @xmath55 is chosen to make @xmath65 for each maturity .",
    "we have plot @xmath66 for the first order , and @xmath67 for the second order .",
    "note that we have put @xmath26 to compare the original model .",
    "one can observe how the higher order correction improves the accuracy of approximation . in this example , the counterparty is significantly riskier than the investor , and the underlying contract is quite volatile  . even in this situation ,",
    "the simple approximation to the second order works quite well up to the very long maturity .      in this subsection",
    ", we consider the valuation of self - financing portfolio under the situation where there exists a difference between the lending and borrowing interest rates . here",
    ", we consider the problem under the physical measure .",
    "the dynamics of the self - financing portfolio is governed by  @xcite dv_t&=&rv_tdt-\\{(r - r)(-v_t,0)-z_t}dt + z_t dw_t + v_t&=&(s_t ) + ds_t&=&s_t(dt+dw_t ) where @xmath21 and @xmath68 are the lending and the borrowing rate , respectively .",
    "@xmath69 denotes the risk premium . for simplicity",
    ", we assume all of the @xmath21 , @xmath68 , @xmath70 and @xmath56 are positive constants . here",
    ", @xmath71 represents the amount invested in the risky asset , i.e. stock @xmath72 .",
    "let us choose the terminal wealth function as ( s_t)=(s_t - k_1,0)-2(s_t - k_2,0 )  .",
    "this spread introduces both of the lending and borrowing activities , which makes the problem more interesting .",
    "the setup explained here is in fact exactly the same as that of adopted by gobet et al .",
    "( 2005 )  @xcite .",
    "they have carried our detailed numerical studies for the above problem and evaluate @xmath73 by regression - based monte carlo simulation . in the following , we will apply our perturbative approximation scheme to the same problem and test its accuracy .    as usual , let us introduce the expansion parameter as dv_t^()&=&rv_t^()dt - g(v_t^(),z_t^())dt+z_t^()dw_t + v_t^()&=&(s_t )  , where we have defined the non - linear perturbation function as g(v , z)=(r - r)(-v,0)-z  .",
    "now , we are going to expand @xmath32 in terms of @xmath25 .",
    "in the zero - th order , the bsde reduces to dv_t^(0)&=&rv_t^(0)dt+z_t^(0)dw_t + v_t^(0)&=&(s_t )  , which allows us to obtain v_t^(0)&=&e + & = & e^-r(t - t)(c(k_1,s_t)-2c(k_2,s_t ) )  , where we have defined c(k_i , s_t)&=&s_te^(t - t)n(d_1(k_i , s_t))-k_i n(d_2(k_i , s_t ) ) + d_1(2)(k_i , s_t)&=&\\ { ( ) ^2 ( t - t ) }   for @xmath74 .",
    "the volatility term is given by z_t^(0)=e^(-r)(t - t)s_t(n(d_1(k_1,s_t))-2n(d_2(k_2,s_t ) ) )  .",
    "now , in the first order , we have dv_t^(1)&=&rv_t^(1)dt - g(v_t^(0),z_t^(0))dt+z_t^(1)dw_t + v_t^(1)&=&0  . as before , we can easily integrate it to obtain v_t^(1)=e  .",
    "now , using the zero - th order results , one can show g(v_t^(0),z_t^(0))&=&e^-r(t - t)(r - r)\\{k_1n(d_2(k_1,s_t))-2k_2n(d_2(k_2,s_t))}^+ + & -&e^-r(t - t)(-r)s_te^(t - t)\\{n(d_1(k_1,s_t))-2n(d_1(k_2,s_t ) ) }  , which leads to v_t^(1)&=&e^-r(t - t)_t^t du \\",
    "+ by setting s_u(s_t , z)=s_te^(u - t)(-^2 ( u - t)+z ) we can write the first order correction as & & v_t^(1)=e^-r(t - t)_t^t du_dz ( z ) + & & \\{(r - r)^+",
    ". + & & -.(-r)s_u(s_t , z)e^(t - u ) }  .",
    "+ the volatility term can also be derived easily as z_t^(1)&=&s_t v_t^(1)(s_t ) + & = & e^-r(t - t)_t^t du_dz(z )  , where we have defined ( u , z)&=&1  k_1n(d_2(k_1,s_u(s_t , z)))-2k_2n(d_2(k_2,s_u(s_t , z)))0 + & = & 0  .      finally , in the second order , the relevant fbsde is given by dv_t^(2)&=&rv_t^(2)dt-(g(v_t^(0),z_t^(0))v_t^(1 ) + g(v_t^(0),z_t^(0))z_t^(1))dt+z_t^(2)dw_t + v_t^(2)&=&0  .",
    "using the fact that g(v , z)&=&-(r - r)_\\{-v0 } + g(v , z)&=&_\\{-v0}-we obtain & & v_t^(2)=e^-r(t - t)_t^t du_u^t ds _",
    "dz_1_dz_2 ( z_1)(z_2 )  . here , we have defined s_s(u,)&=&s_s(s_u(s_t , z_1),z_2 ) and also ( s , u,)&=&1 k_1n(d_2(k_1,s_s(u,)))-2k_2n(d_2(k_2,s_s(u,)))0 + & = & 0  .",
    "if one needs , it is also straightforward to derive the volatility component .",
    "gobet et al .",
    "( 2005 )  @xcite have carried out the detailed numerical study for the above problem using the regression - based monte carlo simulation .",
    "they have used & & = 0.05 , = 0.2,r=0.01 , r=0.06 + & & t=0.25 , s_0=100 , k_1=95,k_2=105  .",
    "after trying various sets of basis functions , they have obtained the price as @xmath75 with standard deviation @xmath76 .",
    "now , let us provide the results from our perturbative expansion .",
    "we have obtained & & v_0^(0)=2.7863 + & & v_0^(1)=0.1814 + & & v_0^(2)=-0.0149 using the same model inputs .",
    "thus , up to the first order , we have @xmath77 , which is already fairly close , and once we include the second order correction , we have @xmath78 , which is perfectly consistent with their result of monte carlo simulation . note",
    "that , we have derived analytic formulas with explicit expressions both for the contract value and its volatility .",
    "in this section , we consider the situation where the forward components @xmath79 consist of the generic markovian processes . in this case",
    ", we can not express @xmath35 and @xmath36 in terms of @xmath79 exactly , which prohibits us from obtaining the higher order corrections in a simple fashion as we have done in the previous section .",
    "however , notice the fact that what we have to do in each order of expansion is equivalent to the pricing of generic european contingent claims and hence we can borrow known techniques adopted there . in the following",
    ", we will explain the use of asymptotic expansion method , now for the forward components .",
    "although it is impossible to obtain the exact result , we can still obtain analytic expression for @xmath80 up to a certain order of the volatilities of @xmath79 .",
    "for the details of asymptotic expansion for volatility , please consult with the works  @xcite , for example .",
    "let us introduce a new expansion parameter @xmath81 , which is now for the asymptotic expansion for the forward components .",
    "we express the relevant sde of generic markovian process @xmath82 as dx_u^()=_0(x_u^(),)du+_a(x_u^(),)dw_u^a  . here , we have used einstein notation which assumes the summation of all the paired indexes .",
    "for example , in the above equation , the second term means _",
    "a(x_u^(),)dw_u^a=_a=1^r _ a(x_u^(),)dw_u^a  .",
    "we assume _",
    "a(x,0)=0 [ delassumption ] for @xmath83 .",
    "intuitively speaking , it suggests that @xmath84 counts the order of volatility .",
    "suppose that , in the @xmath85-th order of @xmath25 , we succeeded to express @xmath86 and @xmath87 in terms of @xmath88 .",
    "then , in the next order , we can express the backward components as v_t^(i)&=&e + z_t^(i)&=&ewith some function @xmath49 . if there is no need to obtain @xmath89 , we can just run monte carlo simulation for @xmath90 to evaluate these quantities in a standard way .",
    "however , if we want to obtain higher order corrections , we need somehow to express the @xmath80 in terms of @xmath88 .",
    "what we are going to propose here is to expand the backward components around @xmath91 : v_t^(i)&=&v_t^(i,0)+v_t^(i,1)+^2 v_t^(i,2)+o(^2 ) + z_t^(i)&=&z_t^(i,0)+z_t^(i,1)+^2 z_t^(i,2)+o(^2 ) and express each @xmath92 and @xmath93 in terms of @xmath88 up to a certain order `` @xmath94 '' of @xmath84 . although we can proceed to arbitrarily higher order of @xmath84",
    ", we will present explicit expressions up to the second order in this paper . for the interested readers ,",
    "the work  @xcite provides the systematic methods to obtain higher order corrections .",
    "+ thank to the well - known chain rule for malliavin derivative , what we have to do is only expanding the two fundamental quantities , @xmath95 and @xmath51 for @xmath46 $ ] , in terms of @xmath81 .",
    "firstly , let us introduce a simpler notation , dx_u^()&=&_0(x_u^(),)du+_a(x_u^(),)dw_u^a + & : = & _ ( x_u^(),)dw_u^  , where @xmath96 runs through @xmath97 to @xmath21 with the convention @xmath98 and @xmath99 for @xmath100 .",
    "we set the time @xmath29-value of @xmath90 as @xmath15 .",
    "thus our goal is to express @xmath101 and @xmath102 as functions of @xmath15 .",
    "we first introduce a @xmath44 matrix process @xmath103 defined as d(y_t , u^())^i_j&=&_k^i_(x_u^(),)(y_t , u^())^k_jdw_u^ + ( y_t , t^())^i_j&=&^i_j  , where @xmath47 denotes the differential with respect to the @xmath34-th component of @xmath12 .",
    "since we have ( x_u^())^i = x^i+_t^u ^i_0(x_s^(),)ds+_t^u ^i_a(x_s^(),)dw_s^a applying a malliavin derivative @xmath104 with @xmath105 gives _",
    "t,(x_u^())^i= _ t^u _ k_0^i(x_s^(),)_t,(x_s^())^kds + _ t^u_k^i_a(x_s^(),)_t,(x_s^())^kdw_s^a+ ^i_(x , )  . thus one can show that d(_t,(x_u^())^i)&=&_k^i_(x_u^ ( ) , )",
    "_ t,(x_u^())^kdw_u^ + _ t,(x_t^())^i&=&^i_(x , )  . therefore , for @xmath106 , we conclude that _ t , a ( x_u^())^i=(y^()_t , u)^i_j^j_a(x , )  , [ yandm ] which implies that the asymptotic expansion of @xmath107 can be obtained from that of @xmath103 .",
    "therefore , in the following , we first carry out the asymptotic expansion for @xmath12 and @xmath108 .",
    "we are now going to expand for @xmath46 $ ] as x_u^()=x_u^(0)+d_t , u+^2 e_t , u+o(^2 )  , and y_t , u^()=y_t , u+h_t , u+o ( )  , where d_t , u=.|_=0 , e_t , u=.|_=0  , and y_t , u = y_t , u^(0 ) , h_t , u=.|_=0  .",
    "since @xmath111 for @xmath100 , we have dx_u^(0)&=&_0(x_u^(0),0)du + d(y_t , u)^i_j&=&_k^i_0(x_u^(0),0)(y_t , u)^k_j du with the initial conditions @xmath112 and @xmath113 , which allows us to express @xmath114 and @xmath45 as deterministic functions of @xmath15 .",
    "it is also convenient for later calculations to notice that @xmath115 is the solution of d(y^-1_t , u)^i_j&=&-(y_t , u^-1)^i_k_j_0^k(x_u^(0),0)du [ yinv ] with @xmath116 .      by applying @xmath117 ,",
    "we can easily obtain d(_x_u^())^i&=&(_(x_u^(),))^i_j_(x_u^())^jdw_u^+_^i_(x_u^(),)dw_u^ + d(_y^()_t , u)^i_j&=&\\ { _ k ^i_(x_u^(),)(_y^()_t , u)^k_j + _ kl^i_(x_u^(),)(_x_u^())^l ( y_t , u^())^k_j + & & + _ k_^i_(x_u^(),)(y_t , u^())^k_j}dw_u^  .",
    "+ putting @xmath91 , they leads to dd^i_t , u&=&_j^i_0(x_u^(0),0)d^j_t , udu+_^i_(x_u^(0),0)dw_u^ + d(h_t , u)^i_j&=&(_k^i_0(x_u^(0),0))(h_t , u)^k_j du + _ kl^i_0(x_u^(0),0))d^l_t , u(y_t , u)^k_j du + & & + ( _ k_^i_(x_u^(0),0))(y_t , u)^k_j dw_u^  .",
    "now , by using eq.([yinv ] ) , one can show that & & d^i_t , u=(y_t , u)^i_j_t^u(y_t , s^-1)^j_k__^k(s)dw_s^ + & & ( h_t , u)^i_j=(y_t , u)^i_k_t^u(y^-1_t , s)^k_l \\{(_mn^l_0(s))d^n_t , s(y_t , s)^m_jds+ ( _ m_^l_(s))(y_t , s)^m_jdw_s^ } + where we have defined the shorthand notation that ^i_j(s):=^i_j(x_s^(0),0 ) , which will be used in the following calculations , too .",
    "applying @xmath118 to the sde of @xmath90 gives us d(_^2 x_u^())^i&=&\\ { ( _ ( x_u^(),))^i_j_^2 ( x_u^())^j + _ jk^i_(x_u^(),)_(x_u^())^j_(x_u^())^k + & & + 2_j_^i_(x_u^(),)_(x_u^())^j+ _",
    "^2 ^i_(x_u^(),)}dw_u^  .",
    "thus , putting @xmath91 , we obtain de^i_t , u&=&(_0(x_u^(0),0))^i_je^j_t , udu+_jk^i_0(x_u^(0),0)d^j_t , ud^k_t , udu + & & + 2_j_^i_(x_u^(0),0)d^j_t , udw_u^+_^2^i_(x_u^(0),0)dw_u^  .",
    "now we can integrate it as e^i_t , u=(y_t , u)^i_j_t^u(y^-1_t , s)^j_k\\ { _ lm^k_0(s)d^l_t , sd^m_t , sds+(2_l_^k_(s)d^l_t , s + _ ^2^k_(s))dw_s^}.",
    "+ we do not need the second order terms for @xmath103 .      for convenience ,",
    "let us define ( _ a^i)^()_t , u=(_t x_u^())^i_a and its expansion as ( _ a^i)^()_t , u=(_a^i)^(1)_t , u+^2 ( _ a^i)^(2)_t , u+o(^2 )  , where ( _ a^i)_t , u^(1)=. ( _ a^i)^()_t , u|_=0,(_a^i)_t , u^(2)=.(_a^i)^()_t , u|_=0  .",
    "note that , the zero - th order term @xmath119 vanishes , due to the assumption ( [ delassumption ] ) .    from ( [ yandm ] ) , we can easily show that ( _ a^i)^(1)_t , u&=&(y_t , u)^i_j(_^j_a(x,0 ) ) + ( _ a^i)^(2)_t , u&=&(y_t , u)^i_j(_^2 ^j_a(x,0))+ 2(h_t , u)^i_j(_^j_a(x,0 ) )  .",
    "now , we try to express v_t^(i,)=_t^t edu as a function of @xmath121 using the previous results . for that purpose ,",
    "we first need to carry out asymptotic expansion for r_t , u^():=e^-_t^u c(x_s^())dsg(x_u^ ( ) , )   to obtain r^()_t , u = r^(0)_t , u+r^(1)_t , u+^2 r^(2)_t , u+o(^2 )  , where r^(1)_t , u=.r^()_t , u|_=0  , r^(2)_t , u=.r^()_t , u|_=0  .",
    "then , we can take the conditional expectation straightforwardly .",
    "we have r^(0)_t , u = e^-_t^u c(x_s^(0))dsg(x_u^(0),0 ) which is a deterministic function of @xmath15 .",
    "it is easy to obtain _",
    "r^()_t , u&=&e^-_t^u c(x_s^())ds \\{-g(x_u^(),)_t^u _",
    "i c(x_s^())(_x_s^())^ids + & & + ( _ i g(x_u^(),))(_x_u^())^i+_g(x_u^ ( ) , ) }  , which leads to r^(1)_t ,",
    "u = e^-_t^u c(x_s^(0))ds\\ { ( _ i g(x_u^(0),0))d_t , u^i+_g(x_u^(0),0)- g(x_u^(0),0)_t^u_i c(x_s^(0))d^i_t , sds}. +      in the same way , we can show that r^(2)_t , u&=&e^-_t^u c(x_s^(0))ds\\{(_ijg(x_u^(0),0))d^i_t , ud^j_t , u+2(_i_g(x_u^(0),0))d^i_t , u + & & + ( _ i g(x_u^(0),0))e^i_t , u+_^2 g(x_u^(0),0 ) + & & + ( _ t^u _ ic(x_s^(0))d^i_t , sds)^2g(x_u^(0),0 ) + & & -2(_t^u _",
    "i c(x_s^(0))d^i_t , sds)(_j g(x_u^(0),0)d^j_t , u + _ g(x_u^(0),0 ) ) + & & -(_t^uds ) g(x_u^(0),0 ) }  .",
    "evaluation of the conditional expectation can be easily done by simply applying ito - isometry .",
    "let us first define ^i_t , u&=&(y_t , u)^i_j_t^u ( y_t , s^-1)^j_k(_^k_0(s))ds + ^i_t , u&=&(y_t , u)^i_j_t^u ( y_t , s^-1)^j_k(_^k_a(s))dw^a_s and then we have @xmath123 .",
    "since the first one is a deterministic function , we have , for @xmath124 , & : = & e + & = & ^i_t , u^j_t , s+  , where = ( y_t , u)^i_k(y_t , s)^j_l_t^us ( y^-1_t , v)^k_m(y^-1_t , v)^l_n ( _ ^m_a(v))(_^n_a(v))dv  .",
    "then , similarly , we can express & & _ t , u^i:=e + & & = ( y_t , u)^i_j_t^u ( y_t , s^-1)^j_k \\{_lm^k_0(s ) + 2_l_^k_0(s)^l_t , s+_^2^k_0(s)}ds  .",
    "+ using these results , we have & & ^(0)_t , u:=e = e^-_t^u c(x_s^(0))dsg(x_u^(0),0 ) + & & ^(1)_t , u:=e + & &  = e^-_t^u c(x_s^(0))ds\\ { ( _ i g(x_u^(0),0))^i_t ,",
    "u+_g(x_u^(0),0 ) -g(x_u^(0),0)_t^u _",
    "i c(x_s^(0))^i_t , sds }  , + and also & & ^(2)_t , u:=e = e^-_t^u c(x_s^(0))ds\\ { + & & _ ijg(x_u^(0),0)+ 2(_i_g(x_u^(0),0))^i_t , u+_i g(x_u^(0),0)^i_t , u +",
    "_ ^2 g(x_u^(0),0 ) + & & + g(x_u^(0),0)_t^u_t^u_i c(x_s^(0))_jc(x_v^(0))dsdv + & & -2_jg(x_u^(0),0)_t^u _ i c(x_s^(0))ds + & & -2_g(x_u^(0),0)_t^u _",
    "i c(x_s^(0))^i_t , sds + & & -g(x_u^(0),0)_t^u ds}. now , we are able to express @xmath122 as a function of @xmath15 up to the second order of @xmath84 as desired : v_t^(i,)=_t^t \\ { _ t , u^(0)+^(1)_t , u+ ^2  ^(2)_t , u}du + o(^2 )  .      finally , we are going to express z_t^(i,)=_t^t edu as a function of @xmath121 .",
    "let us introduce the two quantities : ( _ a^())_t , u&=&e^-_t^u c(x_s^())ds_i g(x_u^(),)(_t x_u^())^i_a + ( _ a^())_t , u&=&-e^-_t^uc(x_s^())dsg(x_u^ ( ) , ) ( _ t^u _ i c(x_s^())(_t x_s^())^i_a ds ) .",
    "then , we have _",
    "t(e^-_t^u c(x_s^())dsg(x_u^(),))=(_a^())_t , u + ( _ a^())_t , u . similarly to the previous section , we try to obtain the expressions as ( _ a^())_t , u&=&(_a^(1))_t , u+^2 ( ^(2)_a)_t , u+o(^2 ) + ( _ a^())_t , u&=&(_a^(1))_t , u+^2 ( ^(2)_a)_t , u+o(^2 ) where both of the zero - th order terms vanish .",
    "we have & & _ ( ^()_a)_t , u = e^-_t^u c(x_s^())ds\\ { -(_t^u _ i c(x_s^())(_x_s^())^ids ) _ jg(x_u^(),)(_t x_u^())^j_a + & &  + ( _ ijg(x_u^(),))(_x_u^())^j(_t x_u^())^i_a + ( _ i_g(x_u^(),))(_t x_u^())_a^i+ ( _ i g(x_u^(),))(__t x_u^())^i_a } . + thus , we obtain ( _ a^(1))_t , u&:=&.(_a^())_t , u|_=0 + & = & e^-_t^u c(x_s^(0))ds_ig(x_u^(0),0)(_a^i)^(1)_t , u",
    ". similarly we can show that ( ^(2)_a)_t , u&:=&.(^()_a)_t , u|_=0 + & = & -2(_t^u _ ic(x_s^(0))d_t , s^ids)(_a^(1))_t , u + & & + e^-_t^u c(x_s^(0))ds  . +    in the same way , for @xmath126 , we have & & _ ( ^_a)_t , u = e^-_t^u c(x_s^())dsg(x_u^ ( ) , ) ( _ t^u ( _ ic(x_s^()))(_x_s^())^ids ) ( _ t^u ( _ j",
    "c(x_s^()))(_t x_s^())^j_a ds ) + & & -e^-_t^u c(x_s^())ds\\{_g(x_u^(),)+(_i g(x_u^(),))(_x_u^())^i}(_t^u _ i c(x_s^())(_t x_s^())_a^i ds ) + & & -e^-_t^u c(x_s^())dsg(x_u^ ( ) , ) _",
    "+ thus we can show that ( ^(1)_a)_t , u&:=&.(^_a)_t , u|_=0 + & = & -e^-_t^u c(x_s^0)dsg(x_u^(0),0)_t^u(_i c(x_s^(0)))(_a^i)^(1)_t , sds and similarly & & ( ^(2)_a)_t , u=. ( ^_a)_t , u|_=0 + & & = -2(_t^u ( _ i c(x_s^(0)))d_t , s^i ds)(^(1)_a)_t , u + & & -e^-_t^u c(x_s^(0))ds\\ { 2(_g(x_u^(0),0)+(_i g(x_u^(0),0 ) ) d_t , u^i ) _ t^u ( _ j c(x_s^(0 ) ) ) ( ^j_a)^(1)_t , sds + & & + g(x_u^(0),0)_t^uds }  .    for the evaluation of the conditional expectation , let us define , for @xmath127 , & & ( _ t , u)^i_j:=e + & & = ( y_t , u)^i_k_t^u ( y^-1_t , s)^k_l\\ { ( _ mn^l_0(s))^n_t , s+ ( _ m_^l_0(s))}(y_t , s)^m_jds + & & ( ) ^(1)_t , u:=e=(y_t , u)^i_j(_^j_a(x,0 ) )   + & & ( _ a^i)^(2)_t , u:=e=(y_t , u)^i_j(_^2 ^j_a(x,0))+2(_t , u)^i_j(_^j_a(x,0 ) ) . using these expressions ,",
    "one show that ( ^(1)_a+^(1)_a)_t , u&:=&e + & & = e^-_t^u c(x_s^(0))ds\\ { ( _ i g(x_u^(0),0 ) ) ( _ a^i)^(1)_t , u -g(x_u^(0),0)_t^u ( _ i c(x_s^(0 ) ) ) ( _ a^i)^(1)_t , sds } , + and in the same way that & & ( ^(2)_a + ^(2)_a)_t , u:=e + & & = -2(_t^u ( _ i c(x_s^(0)))_t , s^ids)(^(1)_a+^(1)_a)_t , u + & & + e^-_t^u c(x_s^(0))ds\\ { ( _ i g(x_u^(0),0))(_a^i)^(2)_t , u+2(_ijg(x_u^(0),0))^j_t , u(_a^i)^(1)_t , u + 2(_i_g(x_u^(0),0))(_a^i)^(1)_t , u + & & -2_t^u ( _ j c(x_s^(0)))(_a^j)^(1)_t , sds + & & -g(x_u^(0),0)_t^uds  } .",
    "now that we are able to express @xmath128 as a function of @xmath121 as ( z_a^(i,))_t=_t^t \\ { ( _ a^(1)+^(1)_a)_t , u + ^2 ( ^(2)_a+^(2)_a)_t , u}du+o(^2 )  .",
    "+ this completes the goal of asymptotic expansion for @xmath120 and @xmath125 , which are now expressed as functions of @xmath15 as desired .",
    "in this section , we will study the perturbation scheme under the pde ( partial differential equation ) framework following the so - called four step scheme  @xcite .",
    "we will see that our perturbative method makes the four step scheme tractable for the generic situations , which only requires standard techniques for the classical parabolic linear pde . in the next section",
    ", we will explain the equivalent perturbation method in the probabilistic framework .",
    "let us consider the following generic coupled non - linear fbsde : dv_t&=&-f(t , x_t , v_t , z_t)dt+z_tdw_t + v_t&=&(x_t ) + dx_t&=&_0(t , x_t , v_t , z_t)dt+(t , x_t , v_t , z_t)dw_t + x_0&=&x  .",
    "[ fbsde_org ] here , we made the dependence on @xmath29 explicitly to clearly distinguish it from the stochastic @xmath12 components .",
    "as before , we assume that @xmath9 , @xmath16 , @xmath12 take value in @xmath10 , @xmath5 and @xmath129 respectively , and @xmath130 denotes a @xmath21 dimensional standard brownian motion .    following the arguments of the four step scheme of ma and yong  @xcite ,",
    "let us postulate that @xmath61 is given by the function of @xmath29 and @xmath23 as v_t = v(t , x_t ) almost surely for @xmath131 $ ] .",
    "then , applying it@xmath132 s formula , we obtain dv_t&= & _ t v(t , x_t ) dt + & & + \\{_i v(t , x_t)_0^i(t , x_t , v(t , x_t),z_t)+_ijv(t , x_t)(^i^j ) ( t , x_t , v(t , x_t),z_t)}dt + & & + _",
    "i v(t , x_t)^i ( t , x_t , v(t , x_t),z_t)dw_t  .",
    "thus , in order that @xmath133 is the right choice , it should satisfy [ t_pde ] & & v(t , x)=(x ) + [ pde_org ] & & _ t v(t , x)+\\ { _ i v(t , x)^i_0(t , x , v(t , x),z(t , x))+_ijv(t , x ) ( ^i^j)(t , x , v(t , x),z(t , x ) ) } + & & + f(t , x , v(t , x),z(t , x))=0 + [ z_pde ] & & z(t , x)=_iv(t , x)^i(t , x , v(t , x),z(t , x ) )  , where the last equation arises to match the volatility term . + in the four step scheme , one first needs to find the solution @xmath134 satisfying the eq.([z_pde ] ) . and",
    "secondly , one has to solve the pde ( [ pde_org ] ) to obtain @xmath135 , which then allows one to run @xmath12 as a standalone markovian process in the third step .",
    "and then finally , one will obtain the backward components by setting @xmath136 and @xmath137 .",
    "the crucial point in the above four step scheme is whether one can finish the step @xmath52 and @xmath53 successfully . even if one finds the solution for @xmath138 , the second step requires to solve the non - linear pde ( [ pde_org ] ) , which is very difficult in general . in the remainder of this section ,",
    "let us study how our perturbation method works to achieve this goal .",
    "+ we consider , as before , the original system eq  ( [ fbsde_org ] ) as a linear decoupled fbsde with perturbations of non - linear generator and feedbacks of the order of @xmath25 . we write it as &",
    "& dv_t^()=c(t , x^()_t)v_t^()dt - g(t , x_t^(),v_t^(),z_t^())dt+z_t^()dw_t + & & v_t^()=(x_t^ ( ) ) + & & dx_t^()=(r(t , x_t^())+(t , x_t^(),v_t^(),z_t^()))dt + & & + ( ( t , x_t^())+(t , x_t^(),v_t^(),z_t^()))dw_t + & & x_0^()=x   [ p_fbsde ] and the corresponding pde : [ p_pde ] & & v^()(t , x)=(x ) + & & _ t v^()(t , x)+\\ { _ i v^()(t , x)^i_0(t , x , v^(),z^())+_ijv^()(t , x ) ( ^i^j)(t , x , v^(),z^ ( ) ) } + & & + f(t , x , v^(),z^())=0 + & & z^()(t , x)=_i v^()(t , x)^i(t , x , v^()(t , x),z^()(t , x ) )  , where f(t , x , v^(),z^())&=&-c(t , x)v^()(t , x)+g(t , x , v^()(t , x),z^()(t , x ) ) + _ 0(t , x , v^(),z^())&=&r(t , x)+(t , x , v^()(t , x),z^()(t , x ) ) + ( t , x , v^(),z^())&=&(t , x)+(t , x , v^()(t , x),z^()(t , x ) )  .",
    "we suppose that the solution of the above pde can be expanded perturbatively in such a way that v^()(t , x)&=&v^(0)(t , x)+v^(1)(t , x)+^2 v^(2)(t , x)+ + z^()(t , x)&=&z^(0)(t , x)+z^(1)(t , x)+^2 z^(2)(t , x)+  , and then try to solve @xmath139 order by order .",
    "if the non - linear terms are small enough , we can expect to obtain a good approximation by putting @xmath26 in the above expansion to a certain order .",
    "in the zero - th order , the pde ( [ p_pde ] ) reduces to & ( _ t + ( t , x))v^(0)(t , x)=0 & + & v^(0)(t , x)=(x ) & [ pde_v0 ] and z^(0)(t , x)=_i v^(0)(t , x)^i(t , x )  .",
    "[ pde_z0 ] here , we have defined the operator @xmath140 as ( t , x)=r^i(t , x)_i+(^i^j)(t , x)_ij - c(t , x )  .",
    "this is a standard parabolic pde and can be handled in the usual way .",
    "one can easily check that @xmath141 and @xmath142 solves the fbsde ( [ p_fbsde ] ) when @xmath143 .      by extracting @xmath25-first order terms from the pde ,",
    "we obtain & ( _ t+(t , x))v^(1)(t , x)+g^(1)(t , x)=0 & + & v^(1)(t , x)=0 & [ pde_v1 ] and z^(1)(t , x)=_i v^(1)(t , x)^i(t , x)+_i v^(0)(t , x)^i(0)(t , x )  .",
    "[ pde_z1 ] here , we have defined g^(1)(t , x)=_i v^(0)(t , x)^i(0)(t , x)+_ijv^(0)(t , x ) ( ^i^j(0))(t , x)+g^(0)(t , x ) and the following notations : ^(0)(t , x)&=&(t , x , v^(0)(t , x),z^(0)(t , x ) ) + ^(0)(t , x)&=&(t , x , v^(0)(t , x),z^(0)(t , x ) ) + g^(0)(t , x)&=&g(t , x , v^(0)(t , x),z^(0)(t , x ) )  . as a result",
    ", we once again obtained a linear parabolic pde .",
    "hence @xmath144 can also be solved , at least numerically , in a standard fashion .      in the second order",
    ", one can show @xmath145 and @xmath146 should satisfy & ( _ t + ( t , x))v^(2)(t , x)+g^(2)(t , x)=0 & + & v^(2)(t , x)=0 & [ pde_v2 ] and z^(2)(t , x)&=&_i v^(2)(t , x)^i(t , x)+_i v^(1)(t , x)^i(0)(t , x ) + & & + _",
    "i v^(0)(t , x)(v^(1)(t , x)_v+z^(1)(t , x)_z)^i(0)(t , x )  .",
    "[ pde_z2 ] here , @xmath147 is given by g^(2)(t , x)&= & _ i v^(1)(t , x)^i(0)(t , x)+_i v^(0)(t , x ) ( v^(1)(t , x)_v+z^(1)(t , x)_z)^i(0)(t , x ) + & & + _ ijv^(1)(t , x)(^i^j(0))(t , x)+_ijv^(0)(t , x ) ( ^i(0)^j(0))(t , x ) + & & + _ ijv^(0)(t , x)^i(t , x ) ( v^(1)(t , x)_v+z^(1)(t , x)_z)^j(0)(t , x ) + & & + ( v^(1)(t , x)_v+z^(1)(t , x)_z)g^(0)(t , x )  , where the partial differentials with respect to @xmath133 and @xmath138 are taken by considering @xmath148 and @xmath27 as functions of @xmath149 .",
    "it is still a linear parabolic pde .",
    "although we can proceed to higher orders in the same way and solve @xmath150 , there is another way with a clearer representation .",
    "let us define v^[i](t , x)=_j=0^i ^j v^(j)(t , x ) , z^[i](t , x)=_j=0^i^j z^(j)(t , x )  . and the operator ^[k](t , x)&=&\\{^l_0(t , x , v^[k](t , x),z^[k](t , x))_l+ ( ^l^m)(t , x , v^[k](t , x),z^[k](t , x))_lm } + then , one can easily check that the pde for @xmath151}$ ] with @xmath152 can be expressed as [ master - pde ] & ( _ t + ^[i-1](t , x))v^[i](t , x)+f(t , x , v^[i-1](t , x),z^[i-1](t , x))=0 & + & v^[i](t , x)=(x )   and [ master - z ] z^[i](t , x)=_lv^[i](t , x)^l(t , x , v^[i-1](t , x),z^[i-1](t , x ) )  .",
    "it is straightforward to confirm the consistency with the summation of each @xmath153 for @xmath154 up to the error terms of @xmath155 , which is due to the additional @xmath25 in front of the non - linear terms .",
    "note that , in an arbitrary order , the pde has a linear parabolic form .",
    "+ the above formulation clearly shows that the perturbative treatment of non - linear effects of the original system allows us to obtain a series of linear parabolic pdes with the same structure . solving the pde for the zero - th order , and then recursively replacing the backward components by the solution of the previous expansion order",
    ", we can obtain an arbitrary higher order of the approximation .",
    "we have now seen the perturbation method in the pde framework can work even for the fully - coupled non - linear fbsdes . in this section , we will provide a corresponding perturbation scheme under the probabilistic framework . as we will see , it is nothing more difficult than the decoupled case studied in sec .",
    "[ decoupled_approx ] , and reduces to the standard calculations for the european contingent claims . as a by - product , applying the asymptotic expansion method explained in sec .",
    "[ asymptotic ] , we can also show that it is possible to obtain an analytic expression for the non - linear pde in the four step scheme up to the given order of expansion .",
    "we try to solve the same fbsde ( [ fbsde_org ] ) treated in the pde framework .",
    "suppose that we have somehow obtained a solution of @xmath156}(t , x ) , z^{[i-1]}(t , x))$ ] .",
    "then , let us consider the following fbsde : dv^[i]_t&=&-f(t , x_t^[i],v^[i-1](t , x^[i]_t),z^[i-1](t , x_t^[i]))dt+z^[i]_tdw_t + v_t^[i]&=&(x^[i]_t ) + dx^[i]_t&=&_0(t , x^[i]_t , v^[i-1](t , x^[i]_t),z^[i-1](t , x_t^[i]))dt + & & + ( t , x^[i]_t , v^[i-1](t , x_t^[i]),z^[i-1](t , x_t^[i]))dw_t + x_0^[i]&=&x  .",
    "[ grading - fbsde ] here , one can immediately check that the solution of the above fbsde @xmath157 } , z_t^{[i]})$ ] , as a function of @xmath158})$ ] , actually satisfies the pde in the four step scheme given in ( [ master - pde ] ) and ( [ master - z ] ) by setting v^[i](t , x)=v^[i](t , x),z^[i](t , x)=z^[i](t , x ) .",
    "hence the solution of the above fbsde can be interpreted as the @xmath159-th order approximation of the original fbsde in ( [ fbsde_org ] ) .",
    "therefore , if we can solve the above fbsde in probabilistic way , we can proceed to an arbitrarily higher order of approximation by simply updating the backward components of the non - linear terms recursively .",
    "we can also say that it is a probabilistic way to solve the non - linear pde ( [ fbsde_org ] ) order by order of @xmath25 .",
    "one can check that the above fbsde is actually decoupled and linear by writing it explicitly as & & dv_t^[i]= c(t , x_t^[i])v_t^[i]dt - g(t , x^[i]_t , v^[i-1](t , x^[i]_t),z^[i-1](t , x^[i]_t))dt+z_t^[i]dw_t + & & v_t^[i ] = ( x_t^[i ] ) + & & dx_t^[i]= ( r(t , x_t^[i])+(t , x_t^[i],v^[i-1](t , x_t^[i ] ) , z^[i-1](t , x_t^[i])))dt + & & + ( ( t , x_t^[i])+(t , x_t^[i],v^[i-1](t , x_t^[i]),z^[i-1](t , x_t^[i])))dw_t + & & x_0^[i]=x  , and hence , we can straightforwardly integrate it as [ fbsde - vi ] & & v_t^[i]=e + [ fbsde - zi ] & & z_t^[i]=e  .",
    "the result is equivalent to the pricing of standard european contingent claims , and also has the same form appeared in sec .",
    "[ decoupled_approx ] .",
    "thus , we can apply the asymptotic expansion method given in sec .",
    "[ asymptotic ] to the forward components @xmath160}$ ] in the same way .",
    "this will give us the analytical result of @xmath157},z_t^{[i]})$ ] as a function of @xmath158})$ ] , up to a given order of volatility parameter , say @xmath161 .",
    "then we can set v^[i](t , x)=v_t^[i](t , x),z^[i](t , x)=z_t^[i](t , x )  .",
    "up to the error terms of @xmath162 , and can move on to the higher order of approximations   ( and also @xmath26 ) , the actual order of error terms are of @xmath163 in this example . ] .      here",
    ", let us summarize the procedures of our perturbation method .",
    "firstly , in the zero - th order , the corresponding fbsde is given by dv_t^[0]&=&c(t , x_t^[0])v_t^[0]dt+z_t^[0]dw_t + v_t^[0]&=&(x_t^[0 ] ) + dx_t^[0]&=&r(t , x_t^[0])dt+(t , x_t^[0])dw_t + x_0^[0]&=&x  .",
    "this can be integrated as v_t^[0]&=&e + z_t^[0]&=&ewhich can be solved either exactly , or analytically up to the certain order of volatility by the asymptotic expansion method .",
    "then we set v^[0](t , x)=v^[0](t , x )  , z^[0](t , x)=z^[0](t , x ) , and then put them back in the backward components of ( [ grading - fbsde ] ) with @xmath164 .",
    "we then obtain ( [ fbsde - vi ] ) and ( [ fbsde - zi ] ) with @xmath164 .",
    "we can express @xmath165}$ ] and @xmath166}$ ] in terms of @xmath29 and @xmath167}$ ] by using the asymptotic expansion method , and use them to define @xmath168}(t , x),z^{[1]}(t , x))$ ] in turn .",
    "now , we can move to ( [ fbsde - vi ] ) and ( [ fbsde - zi ] ) with @xmath169 .",
    "we repeat the same procedures to the desired order of approximation .",
    "+ _ remark _ : although we have considered one - dimensional process for @xmath9 , it is straight forward to extend the method for higher dimensional cases . once we take the basis of @xmath12 in such a way that the linear drift term @xmath9 is diagonal , we can proceed without any difficulty .",
    "the mixing from the other components of @xmath9 always appears in the lower order of @xmath25 , which keeps the diagonal form of drift term intact in an arbitrary order .",
    "in this paper , we have presented a simple perturbation scheme for non - linear decoupled as well as coupled fbsdes . by considering the interested system as a decoupled linear fbsde with non - linear perturbation terms",
    ", we succeeded to provide the analytic approximation method to an arbitrarily higher order of expansion .",
    "we have shown that the required calculations in each order are equivalent to those for standard european contingent claims .",
    "we have applied the method to the two simple models and compared them with the numerical results directly obtained from the pde and regression - based monte carlo simulation . both of the examples clearly demonstrated the strength of our method .",
    "we have also shown that the use of the asymptotic expansion method for forward components allows us to proceed to the higher order of perturbation even if the forward components do not have known distributions .    in the last part of the paper ,",
    "we have studied the perturbative method in the pde framework based on the so - called four step scheme .",
    "we have shown that our perturbative treatment renders the original non - linear fbsde into the series of linear parabolic pdes , which are straightforward to handle .",
    "furthermore , by the equivalence of the two approaches , we were also able to provide the corresponding perturbative method in probabilistic framework which is explicitly consistent with the four step scheme up to a given order of expansion .",
    "the perturbation theory presented in this paper may turn out to be crucial to investigate various interesting problems , such as those given in the introduction , which have been preventing analytical treatment so far .",
    "the application of the new method to the important financial problems is one of our ongoing research topics .",
    "finally , let us remark on the further extension to the cases including jumps .",
    "although , in this work , we have only considered the dynamics driven by brownian motions , the same approximation scheme can also be applied to more generic cases .",
    "although it will be more difficult to obtain explicit expressions in terms of forward components , if we choose the specific forward processes with appropriate analytical properties , we should be able to proceed in the similar way .",
    "particularly , the separation of the original system into the decoupled linear fbsde and the non - linear perturbation terms can be done in a completely parallel fashion .",
    "as we have briefly mentioned in section  [ decoupled_approx ] , there are the situations where the driver contain the linear term in volatility @xmath16  .",
    "although it is possible to absorb it by the measure change , there may be the situation where its direct treatment improves the numerical performance than inducing the drift modification in the forward components .",
    "consider the situation where the backward component follows the following bsde : dv_t=(c(t , x_t)v_t+(t , x_t)z_t)dt - g(t , x_t , v_t , z_t)dt+z_tdw_t  .",
    "also in this case , the recursive procedures can be carried out in the same way by simply replacing the factor ( -_t^s c(u , x_u)du ) by ( t , s)=(-_t^s ( c(u , x_u)+||(u , x_u)||^2)du-_t^s ( u , x_u)dw_u )  .",
    "for example , the results of section  [ decoupled_zeroth ] can now be expressed as v_t^(0)&=&e + z_t^(0)&=&e  .",
    "higher order and coupled cases can be expressed similarly . in general , it is difficult to say which method performs better , since both of them have errors of the same order of @xmath170 at a given expansion .",
    "in the appendix , we provide another method which is more closely related to that of sec.[decoupled_approx ] for generic coupled fbsdes .",
    "we consider the same coupled fbsde as in sec .",
    "[ four - step - prob ] : & & dv_t^()=c(x_t^())v_t^()dt - g(x_t^(),v_t^(),z_t^())dt+z_t^()dw_t + & & v_t^()=(x_t^ ( ) ) + & & dx_t^()=r(x_t^())dt+(x_t^(),v_t^(),z_t^())dt + ( ( x_t^())+(x_t^(),v_t^(),z_t^()))dw_t + & & x_0^()=x  . here , we absorbed a possible explicit time dependency to @xmath12 .",
    "as in sec.[decoupled_approx ] , we are going to expand the backward as well as forward components in terms of @xmath25 .",
    "suppose that we have v_t^()&=&v_t^(0)+v_t^(1)+^2 v_t^(2)+ + z_t^()&=&z_t^(0)+z_t^(1)+^2 z_t^(2)+ + x_t^()&=&x_t^(0)+x_t^(1)+^2 x_t^(2)+  .",
    "now , let us derive each term separately .",
    "in the zero - th order , the original equation reduces to a linear and decoupled fbsde , which will going to serve as the center of expansion : dv_t^(0)&=&c(x_t^(0))v_t^(0)dt+z_t^(0)dw_t + v_t^(0)&=&(x_t^(0 ) ) + dx_t^(0)&=&r(x_t^(0))dt+(x_t^(0))dw_t + x_0^(0)&=&x  .",
    "@xmath171 is now the standard markovian process completely decoupled from the backward components .",
    "we can easily solve the backward components as v_t^(0)&=&e + z_t^(0)&=&e  . as explained in the previous section",
    ", we can express @xmath172 and @xmath173 in terms of @xmath174 by the help of the asymptotic expansion for volatility even if the process of @xmath171 does not have known distribution .",
    "now let us consider the dynamics of @xmath39 and @xmath175 .",
    "following the same arguments in sec.[decoupled_approx ] , one can show straightforwardly that & & dv_t^(1)=c(x_t^(0))v_t^(1)dt - g^(1)(t)dt+z_t^(1)dw_t + & & v_t^(1)=^(1)(t ) + & & dx_t^(1)=_x r(x_t^(0))x_t^(1)dt+^(0)(t)dt + ^(1)(t)dw_t + & & x_0^(1)=0  , where we have used shorthand notations : ^(1)(t)&=&^(1)(x_t^(0),x_t^(1 ) ) = _ x ( x_t^(0))x_t^(1 ) + g^(0)(t)&=&g(x_t^(0),v_t^(0),z_t^(0 ) ) + g^(1)(t)&=&g^(1)(x_t^(0),x_t^(1),v_t^(0),z_t^(0 ) ) = g^(0)(t)-(_x c(x_t^(0))x_t^(1))v_t^(0 ) + ^(0)(t)&=&(x_t^(0),v_t^(0),z_t^(0 ) ) + ^(0)(t)&=&(x_t^(0),v_t^(0),z_t^(0 ) ) + ^(1)(t)&=&^(1)(x_t^(0),x_t^(1),v_t^(0),z_t^(0))=^(0)(t)+_x ( x_t^(0))x_t^(1 ) .",
    "note that , since we have obtained @xmath172 and @xmath173 as the functions of @xmath174 , the pair @xmath176 consists of a markovian process , which is indeed decoupled from @xmath177 .",
    "this means that we have ended up with the decoupled linear fbsde also for the first order correction .",
    "hence , one can easily solve the backward components as [ v1_couple ] & & v_t^(1)=e + [ z1_couple ] & & z_t^(1)=eas a result , we have obtained @xmath178as well as @xmath179 as the functions of @xmath174 and @xmath180 .",
    "we can continue to the higher order corrections in the same way . by considering @xmath181 and @xmath182 , and then extracting the @xmath25-second order terms",
    ", one can show that & & dv_t^(2)=c(x_t^(0))v_t^(2)dt - g^(2)(t)dt+z_t^(2)dw_t + & & v_t^(2)=^(2)(t ) + & & dx_t^(2)=_x r(x_t^(0))x_t^(2)dt+^(2)(t)dt+^(2)(t)dw_t + & & x_0^(2)=0  .",
    "here we have defined ^(2)(t)&=&^(2)(x_t^(0),x_t^(1),x_t^(2 ) ) + & = & _ x(x_t^(0))x_t^(2)+_ij(x_t^(0))x_t^i(1)x_t^j(1 ) + & & g^(2)(t)=g^(2)(x_t^(0),x_t^(1),x_t^(2),v_t^(0),v_t^(1),z_t^(0),z_t^(1 ) ) + & & = \\{_x g^(0)(t)x_t^(1)+ g^(0)(t)v_t^(1)+_z g^(0)(t)z_t^(1 ) } + & & -(_x c(x_t^(0))x_t^(2)+_ijc(x_t^(0))x_t^i(1)x_t^j(1))v_t^(0 ) -(_x c(x_t^(0))x_t^(1))v_t^(1 ) . + and also for the process",
    "@xmath183 , we have defined ^(2)(t)&=&^(2)(x_t^(0),x_t^(1),x_t^(2),v_t^(0),v_t^(1),z_t^(0),z_t^(1 ) ) + & = & \\{_x ^(0)(t)x_t^(1)+ ^(0)(t ) v_t^(1)+_z ^(0)(t)z_t^(1 ) } + & & + _ ijr(x_t^(0))x_t^i(1)x_t^j(1 ) and ^(2)(t)&=&^(2)(x_t^(0),x_t^(1),x_t^(2),v_t^(0),v_t^(1),z_t^(0),z_t^(1 ) ) + & = & _ x ( x_t^(0))x_t^(2)+ _",
    "ij(x_t^(0))x_t^i(1)x_t^j(1 ) + & + & \\{_x^(0)(t)x_t^(1)+^(0)(t)v_t^(1)+ _",
    "z^(0)(t)z_t^(1 ) }  .    one can check that the pair @xmath184 consists of a markovian process and it is decoupled from the backward components .",
    "hence , once again , we have obtained the decoupled linear fbsde , which is solvable as before : v_t^(2)&=&e + z_t^(2)&=&e  . in completely the same way",
    ", we can proceed to an arbitrarily higher order correction . in each expansion order @xmath159",
    ", the set @xmath185 follows markovian process decoupled from the backward components , and also the fbsde continues to be linear thank to the @xmath25 in front of the non - linear terms .",
    "+   + _ remark _ : for simplicity of the presentation , we have used the common perturbation parameter @xmath25 both for the non - linearity in backward components as well as the feedback effects in the forward components . however , as one can easily expect , it is also possible to introduce multiple perturbation parameters .      for completeness ,",
    "let us check the consistency to the result of sec .",
    "[ four - step - prob ] . in the zero - th order ,",
    "the corresponding fbsdes are exactly equal . in the first order ,",
    "we have obtained v_t^[1]&=&e[1st_order_n ] and @xmath166}$ ] as its malliavin derivative in sec .",
    "[ four - step - prob ] .",
    "now , in order to compare it to the current method , let us consider v_t^[1]-v_t^(0 ) and extract @xmath25 first order terms by expanding @xmath167}=x_t^{(0)}+\\ep x_t^{(1)}$ ] .",
    "since the second term of ( [ 1st_order_n ] ) has already @xmath25 in the front , we simply get a contribution from there as e. from the first term , we have to expand @xmath186}$ ] in the terminal payoff and also in the discount : ewhere we have used the gateaux derivative  .",
    "second term can be interpreted that there is a change in value by -(_x c(u , x_u^(0))x_u^(1))v_u^(0 ) at each point of time @xmath187 , which is summed and discounted back to the current time . by summing the above two terms",
    ", one can easily confirm its equivalence to the result of the previous section .",
    "applying malliavin derivative automatically tells the consistency of volatility terms . using the same arguments",
    ", one can check the consistency between the current method and that of sec .",
    "[ four - step - prob ] .",
    "although we have solved @xmath188 separately , the sum @xmath189 can be shown equivalent to @xmath190}$ ] up to the error terms @xmath155 .",
    "shiraya , k. , takahashi , a. , and toda , m , 2009 , `` pricing barrier and average options under stochastic volatility environment , '' carf working paper f-242 , available at http://www.carf.e.u-tokyo.ac.jp/workingpaper/ , forthcoming in journal of computational finance .",
    "takahashi , a. , takehara , k. , and toda , m. , 2011 , `` a general computation scheme for a high - order asymptotic expansion method , '' carf working paper f-242 , available at http://www.carf.e.u - tokyo.ac.jp / workingpaper/."
  ],
  "abstract_text": [
    "<S> in this work , we have presented a simple analytical approximation scheme for generic non - linear fbsdes . by treating the interested system as the linear decoupled fbsde perturbed with non - linear generator and feedback terms </S>",
    "<S> , we have shown that it is possible to carry out a recursive approximation to an arbitrarily higher order , where the required calculations in each order are equivalent to those for standard european contingent claims . </S>",
    "<S> we have also applied the perturbative method to the pde framework following the so - called four step scheme . the method is found to render the original non - linear pde into a series of standard parabolic linear pdes . due to the equivalence of the two approaches , </S>",
    "<S> it is also possible to derive approximate analytic solution for the non - linear pde by applying the asymptotic expansion to the corresponding probabilistic model . </S>",
    "<S> two simple examples are provided to demonstrate how the perturbation works and show its accuracy relative to known numerical techniques . </S>",
    "<S> the method presented in this paper may be useful for various important problems which have eluded analytical treatment so far .    </S>",
    "<S> *p *        * keywords :* bsde , fbsde , four step scheme , asymptotic expansion , malliavin derivative , non - linear pde , cva </S>"
  ]
}