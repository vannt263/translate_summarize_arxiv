{
  "article_text": [
    "the theoretical understanding of the detailed dynamics of black hole interactions with matter is today a key research activity , both in the gravitational wave  @xcite and high - energy astrophysics  @xcite communities .",
    "such research targets the interpretation of data obtained ( or anticipated ) in a number of distinct observational windows , from high resolution spectra of regions suspected of harboring black holes , e.g. , with satellite experiments like the rossi x - ray timing explorer ( rxte )  @xcite , to broad band gravitational wave detection efforts , e.g. , the laser interferometric gravitational observatory ( ligo )  @xcite . computations within the newtonian paradigm have reached high levels of sophistication ( see , e.g. ,  @xcite ) , offering important clues and support for further development of astrophysical models .",
    "clearly , computations within the framework of general relativity would be highly desirable .",
    "several efforts are underway for meeting the difficult challenge of solving the einstein equations in full generality ( e.g. ,  @xcite ) .",
    "yet the task before the computational scientists is daunting , as the underlying theory is rich in conceptual and technical complications .",
    "this attribute of relativistic gravity , led in the pre-60 s period to a certain confusion with respect to the physical content of the theory , e.g. , as to whether gravitational waves exist at all .",
    "the conundrum was finally resolved with the introduction and masterly manipulation of the characteristic initial value problem ( civp ) by bondi and sachs  @xcite .",
    "important features of the civp suggest it may be serve as a valuable tool in the effort of studying interesting black hole spacetimes ( a review of the development of algorithms based on the civp is given in  @xcite ) .",
    "we highlight , in particular , the long term stability of non - linear numerical evolution schemes based on null coordinates , shown for regular spacetimes in axisymmetry  @xcite , and black hole spacetimes in full 3d  @xcite . additionally , the schemes are of low computational cost per spacetime point , an issue which acquires significance when stability problems are controlled .",
    "both features ultimately derive from the gauge properties of the null foliation , which captures directly the wave degrees of freedom as a propagation equation for a complex function , with all other relevant equations converted into ode s to be integrated along the characteristic surface .",
    "the civp formulation of the einstein equations hence offers , with the inclusion of appropriate matter dynamics ( e.g. , in the form of perfect fluid hydrodynamics ) , among others , the possibility of accurate studies of generic black - hole - matter interactions .",
    "the aim of this paper is to present and test a general formulation of the general relativistic hydrodynamic ( grh ) equations for ideal fluids , appropriate for numerical work , which is suited , but not restricted , to integration on spacetimes foliated with null hypersurfaces .",
    "the _ form invariance _ of the approach with respect to the nature of the foliation implies that existing work on highly specialized techniques for fluid dynamics can be adopted with minimal modifications . in our program of studying black hole matter interactions we have already used such techniques in estimating gravitational radiation from bulk fluid accretion  @xcite in the black hole perturbation limit .",
    "the developments here constitute a first step in extending that program into the fully non - linear regime .",
    "the paper contains four main sections .",
    "section  [ sec : formalism ] presents the essential formal elements of a new prescription for solving grh , i.e. , a choice of conserved and primitive variables and their relationship , along with a diagonalization of the jacobian matrix and explicit expressions for its eigenvalues and eigenvectors . in section  [ sec : general-1d ] we formulate the problem of coupled evolution of matter and geometry fields in spherical symmetry .",
    "the analog of the tolman - oppenheimer - volkoff ( tov ) equation is constructed and integrated along the null cone .",
    "those solutions are used for consistency and convergence tests .",
    "those are demonstrated , along with some relevant details of the numerical implementation , in section  [ sec : alg - tests ] . that section also discusses the important issue of shock - capturing , explored for fluid data posed on a null surface ( in flat spacetime ) . in section  [ sec : accretion ]",
    "we turn to black hole spacetimes and spherical accretion .",
    "the test fluid limit is used as a test - bed , and we proceed to a preliminary study of self gravitating accretion .",
    "we use geometrized units ( @xmath0 ) and the metric conventions of  @xcite .",
    "boldface letters ( and capital indices ) denote vectors ( and their components ) in the fluid state space .",
    "the traditional approach for relativistic hydrodynamics on spacelike hypersurfaces is based on wilson s pioneering work  @xcite . in this formalism",
    "the equations were originally written as a set of advection equations .",
    "this approach sidesteps an important guideline for the formulation of non - linear hyperbolic systems of equations , namely the preservation of their _",
    "conservation form_. this feature is necessary to guarantee correct evolution in regions of sharp entropy generation .",
    "nevertheless , in the absence of such features , non - conservative formulations are equivalent to conservative ones .",
    "the approach is then simpler to implement and has been widely used over the years in a number of astrophysical scenarios . on the other hand , a numerical scheme in conservation form",
    "allows for shock - capturing , i.e. , it guarantees the correct rankine - hugoniot ( jump ) conditions across discontinuities . writing the relativistic hydrodynamic equations as a system of conservation laws , identifying the suitable vector of unknowns and building up an approximate riemann solver",
    "has permitted the extension of modern _ high - resolution shock - capturing _",
    "( hrsc in the following ) schemes from classical fluid dynamics into the realm of relativity  @xcite .",
    "the main theoretical ingredients to construct such a scheme in full general relativity can be found in  @xcite .",
    "an up - to - date collection of different applications of hrsc schemes in relativistic hydrodynamics is presented in  @xcite .",
    "we will return to these schemes in section  [ sec : alg - tests ] below .",
    "non finite - difference methods have also been applied recently to compute relativistic flows , most notably , _ pseudo - spectral methods _ and _ smoothed particle hydrodynamics _ ( sph ) techniques .",
    "although pseudo - spectral methods have enhanced accuracy in smooth regions of the solution , the correct modeling of discontinuous solutions is still their main drawback  @xcite .",
    "recently , however , progress has been achieved in this direction by using multi - domain decomposition techniques  @xcite . on the other hand , sph , as any other particle method , suffers from being dissipative when resolving steep gradients  @xcite . in spite of this",
    ", it has recently proven to work in the ultra - relativistic regime  @xcite .",
    "additionally , it has been shown that it is possible to generalize sph methods to hyperbolic systems other than the euler equations  @xcite    procedures for integrating various forms of the hydrodynamic equations on _ null hypersurfaces _ have been presented before  @xcite ( see  @xcite for a recent implementation ) .",
    "this approach is geared towards smooth isentropic flows . a lagrangian method , applicable in spherical symmetry , has been presented by  @xcite .",
    "recent work in  @xcite includes an eulerian , non - conservative , formulation for general fluids in null hypersurfaces and spherical symmetry , including their _ matching _ to a spacelike section .",
    "here we show that the grh equations can be formulated in a conservative and _ form invariant _ way ( i.e. , irrespective of the spacelike or null nature of the foliation ) for an arbitrary three dimensional spacetime and any perfect fluid with polytropic equation of state .",
    "we consider the relativistic conservation equations ( continuity equation and bianchi identities ) upon introducing an explicit coordinate chart @xmath1 , i.e. , @xmath2 where the scalar @xmath3 represents a foliation of the spacetime with hypersurfaces ( coordinatized by @xmath4 ) , with the matter current and stress energy tensor for a perfect fluid given by @xmath5 , @xmath6 , where @xmath7 is the pressure , @xmath8 is the fluid four velocity and @xmath9 is the relativistic specific enthalpy .",
    "we do not restrict the foliation to be spacelike ( that is , the level surfaces of @xmath3 may be also null ) .",
    "we define the coordinate components of the four - velocity @xmath10 .",
    "the velocity components @xmath11 , together with the rest - frame density and internal energy , @xmath12 and @xmath13 , provide a unique description of the state of the fluid and will be called ( following common usage ) the _ primitive _ variables .",
    "they constitute a vector in a five dimensional space @xmath14 . the index @xmath15 is taken to run from zero to four , coinciding for the values ( 1,2,3 ) with the coordinate index @xmath16 . we define the initial value problem for equations  ( [ initial1],[initial2 ] ) in terms of another vector in the same fluid state space , namely the _ conserved variables _ , @xmath17 , individually denoted @xmath18  @xcite , @xmath19 with those definitions the equations will take the standard conservation law form@xcite , @xmath20 where @xmath21 is the volume element associated with the four - metric and we defined the flux vectors @xmath22 and the source terms @xmath23 ( which depend only on the metric , its derivatives and the undifferentiated stress energy tensor ) , @xmath24    the state of the fluid is uniquely described using either vector of variables , i.e. , @xmath25 or @xmath26 , and one can be obtained from the other , as will be shown later , via the definitions  ( [ eq : d])-([eq : e ] ) and the use of the normalization condition for the velocity vector , @xmath27    specification of @xmath25 on the initial hypersurface , together with an equation of state ( eos ) @xmath28 , followed by a recovery of the primitive variables leads to the computation of the fluxes and source terms . hence , the first time derivative of the data is obtained , which then leads to the formal propagation of the solution forward in time .",
    "no continuity of the data is required , since in practice the evolution is achieved with the ( possibly approximate ) solution of local riemann problems .",
    "utilizing the machinery of modern hydrodynamical methods , i.e. , hrsc schemes , to integrate the previous equations requires the investigation of their local characteristic structure .",
    "we proceed here with this analysis . for this purpose",
    "we temporarily ignore the inhomogeneous part of the system .    introducing the jacobian matrices @xmath29 the system can be written in quasi - linear form as @xmath30    the characteristic speeds ( eigenvalues ) and eigenvectors of the system , in the @xmath31-th direction",
    ", are then given by the solution of the algebraic problems ( we now omit the vector indices of the fluid space ) @xmath32 where @xmath33 denotes the characteristic speed in the direction @xmath31 , @xmath34 the corresponding eigenvector and @xmath35 denotes the unit matrix .",
    "the strong coupling of the elements of the @xmath36 matrix via the normalization condition hinders the analysis of the eigenvalue problem in terms of the conserved variables @xmath37 . the customary method to proceed ( see  @xcite ) , is to analyze the problem in terms of the primitive variables . indeed ,",
    "the suitable choice of the primitive variables , such that the eigenvalue problem may be solved explicitly , is of great practical value .    with a choice of primitive variables @xmath38 , the quasi - linear system  ( [ b - system ] )",
    "is rewritten as @xmath39 where @xmath40    hence , upon analyzing the algebraic system @xmath41 elementary algebra establishes that @xmath42 and the eigenvectors of matrix @xmath43 are given by @xmath44 .",
    "we now proceed to diagonalize our system , with the choice of primitive variables @xmath45 , and specializing the derivation to the case of a perfect fluid eos , @xmath46 , with @xmath47 being the ( constant ) adiabatic index of the fluid . the procedure can be generalized to an arbitrary eos and details will be given elsewhere .",
    "the matrices @xmath48 are in this case    @xmath49 \\ , , \\ ] ]    @xmath50 \\ , , \\ ] ]    with @xmath51 . for a given coordinate direction , which we label ` 1 ' ( e.g. , the @xmath52 direction )",
    ", the matrix @xmath53 reads    @xmath54 \\ , , \\ ] ]    where the following shorthand notation is used @xmath55 the _ eigenvalues _ of that matrix are @xmath56 and @xmath57 \\ , , \\label{lambdapm}\\end{aligned}\\ ] ] where all the metric information is encoded in the expressions @xmath58 and @xmath59 , @xmath60 additionally , @xmath61 and @xmath62 is the local sound speed satisfying @xmath63 with @xmath64 and @xmath65 .",
    "a complete set of _ right - eigenvectors _ is given by @xmath66 @xmath67 @xmath68 @xmath69 \\\\ \\\\",
    "-\\frac{\\rho}{\\varepsilon}u^0bu^2h + \\rho\\gamma[a(u^0c^2-ag^{02})+u^2k ] \\\\ \\\\ -\\frac{\\rho}{\\varepsilon}u^0bu^3h + \\rho\\gamma[a(u^0c^3-ag^{03})+u^3k ] \\\\",
    "\\\\   -\\frac{\\rho}{\\varepsilon}(u^0)^2{\\tilde b } + \\rho\\gamma[2u^0k - aag^{00 } ] \\\\ \\end{array } \\right ] \\ , , \\ ] ] with the definitions @xmath70 note that the @xmath71 dichotomy in the last two eigenvectors is implicit in the corresponding non - degenerate ( @xmath71 ) eigenvalues through the variables @xmath72 , @xmath73 and @xmath74 .",
    "the spectral decomposition given above applies to a chosen direction @xmath31 .",
    "since @xmath31 is arbitrary , to obtain similar expressions for the remaining directions , it suffices to specialize them accordingly , e.g. , obtain the eigenvalues from expressions  ( [ lambda0 ] ) and ( [ lambdapm ] ) with substitution of the desired direction , and permutation of the corresponding eigenvectors .",
    "so far the developments have been completely general .",
    "we specialize here the discussion to null coordinate systems .    for the eos",
    "commonly accepted , the propagation speeds of fluid signals are always sub - luminal . in addition , the bulk flow is always assumed to be a timelike vector field .",
    "hence , the cauchy initial value problem for the fluid is well defined for data given on a null hypersurface ( see fig .",
    "[ fig : cones ] ) .    while the numerical algorithm updates the vector of conserved quantities ( @xmath75 ) , we make extensive use of the _ primitive _ variables ( @xmath76 ) .",
    "those would appear repeatedly in the solution procedure : in the characteristic fields , in the solution of the riemann problem and in the computation of the numerical fluxes ( see below ) .",
    "hence , it is necessary to specify a procedure for recovering them from the conserved quantities . in the spacelike case",
    "the relation between the two sets of variables is implicit .",
    "an example of an iterative algorithm to recover the primitive variables in this situation can be found in  @xcite . in the null case ,",
    "the procedure of connecting primitive and conserved variables turns out to be _ explicit _ for a polytropic eos .",
    "this is a direct consequence of the condition @xmath77 which characterizes null foliations  @xcite and leads to algebraic simplifications in the normalization expression @xmath78 .",
    "assuming , hence , a perfect fluid eos , the internal energy , @xmath13 , can be directly obtained in terms of the conserved quantities as the positive solution to a binomial equation , more precisely @xmath79 where @xmath80 once @xmath13 is known the rest of the _ primitive _ variables follow , e.g. , @xmath81 , @xmath82 , and @xmath83    having an explicit relation between conserved and primitive quantities has an impact on the efficiency of the numerical code , as it eliminates an iterative process that is required , at least once per each spacetime point .",
    "it is however unavoidable for general , e.g. , tabulated , eos .",
    "we consider here the general spherically symmetric spacetime , with perfect fluid matter , following the formalism of tamburino - winicour  @xcite , with a minor extension to cover the case of a worldtube immersed in matter .",
    "the einstein equations sufficient for obtaining the spacetime development are grouped as @xmath84 where the @xmath85 coordinate is defined by the level surfaces of a null scalar ( i.e. , a scalar @xmath85 satisfying @xmath86 ) . the @xmath87 coordinate is chosen to make the spheres of rotational symmetry have area @xmath88 .",
    "the @xmath89 coordinates in this geometry are simply taken to be the angular coordinates @xmath90 propagated along the generators of the null hypersurface , i.e. , they parameterize the different light rays on the null cone .",
    "the first two equations contain only radial derivatives and are to be integrated along the null surface .",
    "the last equation  ( [ g3 ] ) is a _ conservation _ condition to be imposed on the world - tube @xmath47 ( see fig .",
    "[ fig : cones ] ) .",
    "equation  ( [ g2 ] ) may be substituted for by the equivalent expression @xmath91 , where the indices @xmath92 run over the remaining coordinates @xmath89 . to proceed with the integration , an additional choice of gauge",
    "must be made _ on the worldtube_. this condition fixes the only remaining freedom in the coordinate system , namely the rate of flow of coordinate time at the world - tube .",
    "we present here the explicit expressions we use , including the matter terms . adopting the bondi - sachs form of the metric element , @xmath93 the geometry",
    "is completely described by the two functions @xmath94 and @xmath95 ( we will also interchangeably use the variable @xmath96 ) .",
    "the @xmath97 and @xmath98 hypersurface equations are given by @xmath99 the latter being equivalent ( modulo the four - velocity normalization condition ) to @xmath100 the comma in the above equations indicates , as usual , partial differentiation .",
    "boundary conditions @xmath101 for the radial integrations are provided by the equation  ( [ g3 ] ) which explicitly reads , @xmath102 with the adoption of a suitable gauge condition . for each choice one",
    "obtains a pair of ode s along the worldtube . for example , with the choices @xmath103 one obtains @xmath104 respectively , where @xmath105 and @xmath106 denote the integration constants at @xmath107 .",
    "all the above conditions are equivalent in vacuum , and since our present computations place the worldtube in very low density regions , we do not analyze the issue further .",
    "the hydrodynamic equations reduce , within our symmetry assumptions , to : @xmath108 where @xmath109 is the four dimensional volume element .",
    "the precise form of the flux terms is obtained with direct use of the general formulae  ( [ eq : fluxes ] ) and the christoffel symbols @xmath110 are derived explicitly for metric  ( [ eq : bondi - sachs ] ) .    in summary ,",
    "the initial value problem consists of equations  ( [ eq : beta],[eq : v],[worldtube1]-[eq : er ] ) together with initial and boundary data for the fluid variables @xmath111 on the initial slice @xmath112 ( at time @xmath113 ) and the metric values of @xmath114 and @xmath115 at the woldtube .",
    "those equations and initial data are sufficient for obtaining the spacetime in a domain to the future of the initial hypersurface , which is radially bounded by the worldtube .",
    "we present here the equations describing a spherically symmetric equilibrium configuration in null coordinates .",
    "such solutions constitute an excellent test - bed for consistency and accuracy checks of our algorithms .",
    "for the simplest derivation , it will be advantageous to use a slightly different form of the metric element . with the redefinition @xmath116 , it reads",
    ", @xmath117 in analogy with the spacelike foliated case , the stationarity in all metric and fluid variables reduces the number of non - trivial equations to the following coupled pair , @xmath118 where it is easily recognized that equation  ( [ mom - tov ] ) is the radial momentum balance equation  ( [ eq : sr ] ) .",
    "this system of equations is solved as a system of ode s .    in the special case of a `` stellar configuration '' ,",
    "solutions are obtained by starting , e.g. , with initial conditions @xmath119 at the center of the star and integrating outwards until the pressure crosses the zero level  @xcite . following that recipe , the direct integration of eq .",
    "( [ eq : beta ] ) , with the boundary condition @xmath120 at the origin , completes the metric element .",
    "fields of a representative solution , which we use in the next section for code testing are presented in fig .",
    "[ fig : tov - sols ] .      in special cases the tov equations can be integrated explicitly in terms of simple functions .",
    "a widely known example is the _ constant density _ star ( @xmath121 ) , derived here in ingoing null coordinates , @xmath122 where @xmath123 , @xmath124 and @xmath125 , with @xmath126 being the radius of the star .",
    "the general formalism outlined in the previous two sections can form the basis for a variety of numerical approaches . concerning the grh equations , in the original wilson s scheme  @xcite ,",
    "a combination of finite - difference upwind techniques with artificial viscosity terms were used to damp spurious oscillations , extending the classic treatment of shocks introduced by von neumann ( see , e.g. ,  @xcite ) into the relativistic regime .",
    "artificial viscosity based methods , though , were later shown to fail at the threshold of the ultra - relativistic regime , once the lorenz factor exceeds a value of 2 .",
    "explicit hrsc codes , following the so - called  godunov approach \" , appeared as a much more solid alternative .    since the early nineties",
    ", it has been gradually demonstrated ( see , e.g. ,  @xcite and references therein ) , that methods exploiting the hyperbolic character of the hydrodynamic equations are optimally suited for accurate integrations , even well inside the ultra - relativistic regime . as mentioned previously , these schemes are commonly known as _ high - resolution shock - capturing _ schemes . in a hrsc scheme",
    ", the knowledge of the characteristic fields ( eigenvalues ) of the equations , together with the corresponding eigenvectors , allows for accurate integrations , by means of either exact or approximate riemann solvers , along the fluid characteristics . these solvers , which constitute the kernel of our numerical algorithm , compute , at every interface of the numerical grid , the solution of local riemann problems ( i.e. , the simplest initial value problem with discontinuous initial data ) .",
    "hence , hrsc schemes automatically guarantee that physical discontinuities appearing in the solution , e.g. , shock waves , are treated consistently ( the _ shock - capturing _ property ) .",
    "hrsc schemes are also known for giving stable and sharp discrete shock profiles .",
    "they have also a high order of accuracy , typically second order or more , in smooth parts of the solution .",
    "we proceed now to describe the highlights of our implementation .",
    "the grid structure is , in summary , as follows : an equidistant radial grid @xmath127 , with spacing @xmath128 , denotes the location of cell centers on which the conserved variables and metric element components reside .",
    "the interface locations @xmath129 are used for the reconstruction of variables and the solution of the riemann problems .",
    "appropriate number of _ ghost - zones _ are added on the boundaries of the grid to allow imposition of boundary conditions . in particular , the worldtube conditions  ( [ worldtube1]-[worldtube2 ] ) are discretized in time along the first ghost - zone at @xmath130 , where @xmath131 denotes the last cell center inside the domain . the timestep is variable and consistently computed to satisfy the courant condition for the hydrodynamic equations .",
    "the geometric equations , being ode s in spherical symmetry , do not impose any timestep restriction .    our numerical implementation of the coupled system is broadly based on the notion of operator splitting , i.e. , the integration of the initial value problem in steps , by successive applications of split components of the overall evolution operator .",
    "we describe here , schematically , the procedure .",
    "the set of equations , comprised of the three hydrodynamical equations in spherical symmetry , and the hypersurface equations governing the geometry , are written as @xmath132 the ordering of the equations reflects the sequence in which they are solved in the code .",
    "we denote the metric variables collectively as @xmath133 , while @xmath48 stands for the set of algebraic relations connecting conserved and primitive variables ( with the mediation of the metric ) . the velocity normalization condition is included with this set .",
    "the first step in the solution process involves an advection of the conserved variables @xmath37 , from the initial data hypersurface @xmath134 to the hypersurface @xmath135 .",
    "the computation of the fluxes * f * uses the metric as it is given in @xmath134 , along with the primitive variables that are assumed to have been computed on @xmath134 in the previous iteration .",
    "the advection may be performed by any modern numerical scheme for the propagation of non - linear waves , i.e. , by any hrsc scheme .",
    "these schemes , being written in conservation form , are particularly well suited for this purpose .",
    "hence , all conserved quantities in the differential equations are also conserved in their finite - differenced versions .",
    "more precisely , the time update of @xmath136 is done according to the following algorithm : @xmath137 the index @xmath138 represents the time level , while the time discretization interval is indicated by @xmath139 .",
    "the  hat \" in the fluxes is used to denote the so - called numerical fluxes which , in a hrsc scheme , are computed according to some generic flux - formula , of the following functional form : @xmath140 notice that the numerical flux is computed at cell interfaces ( @xmath141 ) .",
    "indices @xmath142 and @xmath126 indicate the left and right sides of a given interface .",
    "the sum extends to @xmath7 , the total number of equations .",
    "finally , quantities @xmath143 , @xmath144 and @xmath87 denote the eigenvalues , the jump of the characteristic variables and the eigenvectors , respectively , computed at the cell interfaces according to some suitable average of the state vector variables .    in our code",
    ", the numerical integration of the hydrodynamic equations can be performed using two different approximate riemann solvers .",
    "these are the roe solver  @xcite , widely employed in fluid dynamic simulations , with arithmetically averaged states ( for the use of the roe mean in a relativistic roe solver see  @xcite ) and the marquina solver , recently proposed in  @xcite ( see also  @xcite ) .",
    "after the update of the transport terms the fluid variables are subsequently corrected for the effect of the source terms .",
    "any stable ode integrator is usable here .",
    "our choice is a second order runge - kutta method .",
    "a point of interest here is that the source terms @xmath145 depend on both fluid and metric variables , and , in particular , on time derivatives of the latter .",
    "this implies that a second order capturing of the effect of those derivatives requires storing an additional time level of metric variables .",
    "the geometry equations comprise a system of radial ode s , in which the right - hand - side depends on both the metric and the stress - energy tensor , a system to be solved on the hypersurface @xmath146 .",
    "initial conditions are provided on the world - tube .",
    "hence , the integration can not proceed without the recovery of the primitive variables on @xmath135 , using the expressions given in section  [ primitives ] .",
    "it can be seen that those expressions involve the metric ( which is to be solved for ) .",
    "furthermore , one must worry about the preservation of the velocity normalization condition , which strongly depends on the metric at a given point .",
    "this differential - algebraic entangling of metric and fluid variables , generic to any attempt to solve general fluid spacetimes using conservative formulations , is approached in the following way :    the ode integrator for equation  ( [ gr - ode ] ) is chosen to belong to the implicit class . our present choice is the second order euler method . the metric variables in the new radial location @xmath147 are obtained iteratively ( @xmath148 denotes the iteration index ) . inside the @xmath148-iteration loop the intermediate metric variables @xmath149 are used to obtain intermediate primitive variables @xmath150 , which then leads to updated values for the source term @xmath151 . in addition , the zeroth component of the velocity vector is adjusted so that the primitive velocity field @xmath8 is normalized .",
    "this process can be described as @xmath152 ( the time level index has been suppressed here for clarity ) . in practice",
    "the number of required iterations is about four or five .",
    "the completion of this procedure furnishes simultaneously the metric and the primitive variables at the new radial location , at the new time level .",
    "we proceed now to establish the feasibility of our proposal by performing numerical integrations of the grh equations on null surfaces . using the characteristic fields derived previously , we show here with two numerical examples the capabilities of existing hrsc schemes to integrate discontinuous solutions described in characteristic spacetime foliations .",
    "the initial data are given on a null slice ( advanced or retarded time ) of minkowski space , and the evolution is compared to the suitably transformed exact solution .",
    "the shock tube ( a particular case of the riemann problem ) is one of the standard tests to calibrate numerical schemes in classical fluid dynamics .",
    "the initial setup of this experiment consists of a zero velocity fluid having two different thermodynamical states on either side of an interface .",
    "when this interface is removed , the fluid evolves in such a way that four constant states occur .",
    "each state is separated by one of three elementary waves : a shock wave , a contact discontinuity and a rarefaction wave .",
    "this time - dependent problem has an exact solution  @xcite , to which the numerical integration can be compared .",
    "in addition , it provides a severe test of the shock - capturing properties of any numerical scheme . in recent years",
    ", the shock tube problem began being used as a test of ( special ) relativistic hydrodynamical codes ( see , e.g. ,  @xcite and references therein ) .",
    "the analytic solution of the riemann problem , also available in relativistic hydrodynamics since  @xcite , allows for a rapid and unambiguous comparison with the numerical evolutions .    for our numerical demonstrations we consider two different initial setups . in case 1 the initial state of the fluid",
    "is specified by @xmath153 , @xmath154 on the left side of the interface and @xmath155 , @xmath156 on the right side . for numerical reasons , the pressure of the right state",
    "is set to a small finite value ( @xmath157 ) .",
    "case 2 is as case 1 but with the left and right states reversed .",
    "we use a perfect fluid eos with @xmath158 .      in fig .",
    "[ fig : shock1 ] we plot the results for case 1 .",
    "the left panels show the whole domain , with the @xmath159-coordinate ranging from 0 to 1000 .",
    "the right panels show a zoomed up view of the most interesting domain ( @xmath160 $ ] ) .",
    "we use a numerical grid of 2000 zones and , hence , a rather coarse spatial resolution ( @xmath161 ) .",
    "> from top to bottom , fig .",
    "[ fig : shock1 ] displays the internal energy ( @xmath13 ) , the velocity ( @xmath162 ) and the density ( @xmath12 ) .",
    "the thick dotted line represents the initial discontinuity .",
    "the solid line shows the exact solution after an advanced time @xmath163 and the dotted line indicates the numerical solution at this same time . in order to compute the exact solution in our new coordinates",
    "we have followed the procedure outlined in  @xcite applying the appropriate time transformation , i.e. , @xmath164 .",
    "clearly , the agreement between the exact ( solid lines ) and numeric solution is remarkable .",
    "the solution is characterized by an ( outgoing ) shock wave ( moving to the right ) and an ( ingoing ) rarefaction wave ( moving to the left ) .",
    "one important point to notice is that features of the solution moving towards the left are more developed than those moving to the right .",
    "this is visible in the respective locations of the head of the rarefaction and the shock wave with respect to the initial discontinuity .",
    "the appearance of the rarefaction wave differs from the standard  spacelike \" one ( see , e.g. , fig .  2 of  @xcite ) , due to the intervening time transformation .",
    "the internal energy and the density show an additional elementary wave , a contact discontinuity between the shock and rarefaction waves . across the contact discontinuity pressure and velocity are constant , while the density exhibits a jump .    in the right panels we note that the largest discrepancies are found at the tail of the rarefaction , in the form of an  undershooting \" in density and internal energy and an  overshooting \" in velocity .",
    "this is a typical feature of the numerical solution of the shock tube problem and it is not related to the null coordinates used here .",
    "we note that the constant state between the shock wave and the contact discontinuity is well resolved despite the coarse resolution used .",
    "for comparison purposes , the interested reader is referred to  @xcite , where similar results were obtained ( in a spacelike approach ) employing a grid resolution 200 times finer .      in fig .",
    "[ fig : shock2 ] the results for the  mirror \" version of the shock tube problem 1 are plotted . as in fig .",
    "[ fig : shock1 ] , the left panels show the whole domain , with the @xmath159-coordinate ranging from 0 to 1000 whereas the right panels show a closed - up view of the most interesting region ( @xmath165 $ ] ) .",
    "we use the same grid resolution as in case 1 .",
    "the initial data are now evolved up to a final time @xmath166 . again",
    ", those features of the solution moving towards the left are more developed than those moving towards the right .",
    "the  tower \" in the density is now considerably wider than in case 1 as well as the intermediate constant state in the internal energy between the shock and the contact discontinuity ( almost not noticeable in case 1 ) .",
    "this constant state is much more accurately resolved than in case 1 despite the use of the same resolution .",
    "the two corners of the rarefaction wave are also very well resolved .",
    "the major numerical deviations from the exact solution appear now at the post contact discontinuity region , with the density and the internal energy being slightly under and over estimated there .",
    "we should comment on the different ways in which the shock is captured in cases 1 and 2 .",
    "whereas in case 1 the shock is spread out in a number of grid zones ( @xmath167 ) , in case 2 it is sharply resolved in 2 - 3 cells ( out of the 2000 zones used ) .",
    "this is shown in fig .",
    "[ fig : shock3 ] .",
    "those differences ultimately derive from the fact that a retarded ( or advanced ) time formulation of a riemann problem ( assuming , for the discussion , the initial discontinuity located at @xmath168 ) breaks the commutation between the operation of reflection symmetry ( between positive and negative values of @xmath159 ) and that of time evolution .",
    "the significance of this effect in applications involving shocks and its possible exploitation for ultrarelativistic outflows will be studied elsewhere .",
    "we also include in fig .",
    "[ fig : shock4 ] the evolution of the outgoing shock of case 1 at two different times , @xmath169 and @xmath170 . for this run",
    "we are using @xmath171 zones with the @xmath159-coordinate ranging from 0 to 2000 .",
    "hence , the spatial resolution is again @xmath161 .",
    "the initial discontinuity is placed at @xmath172 .",
    "the solution was left to evolve for a time considerably longer than before in order to find out if the numerical representation of the shock had more time to accommodate itself into a sharper profile . from fig .",
    "[ fig : shock4 ] we find this not to be the case .",
    "the initial spreading present in the numerical solution remains constant in time .",
    "it is noteworthy to mention the independence of the number of points in which the shock is resolved from the total number of zones used .",
    "the tov solutions presented before constitute a good test - bed for confirming both the consistency and the accuracy of the algorithm .",
    "the availability of semi - analytic solutions to the stationary problem means that there is a host of _ error functions _ that can be constructed by subtracting the evolved solution at a fixed total time @xmath173 from the initial profile . as an example , using the exact density profile @xmath174 , the quantity @xmath175 measures the deviations produced by the numerical evolution .    as our present implementations are geared towards black hole spacetimes ( with topology of @xmath176 rather than regular @xmath177 spacetimes ) , in order to benefit from this test - bed without undue boundary complications , we consider only a _ portion _ of the spacetime , excluding the domain around @xmath178 .",
    "initial data for the fluid and the metric are obtained with the solution of the tov equations along the past null - cone of the center of symmetry .",
    "the integration then proceeds in the regular fashion described above , but restricted to a domain inside the star , e.g. , in the sample shown in fig .",
    "[ fig : tov - sols ] this extends between @xmath179 and @xmath180 . in the plots given in fig .",
    "[ fig : conv ] we consider the convergence of such functions and their @xmath181 norms to zero , as the grid spacing is reduced . the norm is found to converge to third order .",
    "this can be seen in the insert of fig .",
    "[ fig : conv ] , where the final values of the norm at @xmath182 ( about eight light crossing times ) are plotted against grid size .",
    "this implies that the local error is second order .",
    "the constant density solution is obtained with the assumption of an ad - hoc ( and largely unphysical ) equation of state and hence it is not possible to evolve such data with the formalism developed here , but it is straightforward to test the integration of the hypersurface equations against the exact solution .",
    "we have confirmed that the integrated metric agrees along the hypersurface with the exact value to second order in the radial grid spacing .",
    "we proceed now in applying the formalism , in spherical symmetry , to the problem of interaction of matter with a black hole . in recent work  @xcite the interaction of a scalar field with a black hole",
    "was investigated , partly as a probe into the concept of `` singularity excision ''  @xcite .",
    "following that same concept in spirit , in a previous investigation , we studied fluid interactions with the black hole geometry , _ in the test - fluid limit_. we dubbed stationary coordinates that are regular at the horizon of an exact stationary black hole solution as _ horizon adapted coordinate systems _  @xcite . in those coordinates the flow solution is smooth and regular at the black hole horizon .",
    "the steepness of the hydrodynamic quantities dominates the solution only near the real singularity .",
    "this approach is now being applied in successively more general ( and astrophysically interesting ) fluid configurations  @xcite .",
    "we extend here this line of work by first performing test - fluid computations in the spirit of  @xcite for the null eddington - finkelstein coordinate system .",
    "this is next further generalized to account for self - gravitating accretion flows .",
    "we study spherical accretion of a perfect fluid onto a ( static ) black hole .",
    "the fluid is taken to have a sufficiently low density so that during the accretion process the mass of the black hole remains unchanged .",
    "stationary solutions to this idealized problem can be computed exactly , up to algebraic equations .",
    "this was first derived for newtonian flows by bondi  @xcite .",
    "the extension to general relativity was due to michel  @xcite",
    ". the solution can easily be re - derived for coordinates other than the original schwarzschild system employed by michel ( the details can be found in  @xcite ) .",
    "we use next this exact solution to quantify the accuracy of our numerical integrations .",
    "the significance of the test lies in its capturing of large curvature gradients near the black hole ( i.e. , it is a strong field computation ) , which translates into the existence of large source terms in the hydrodynamic equations .",
    "we use ingoing eddington - finkelstein @xmath183 coordinates for which the line element reads @xmath184 where @xmath185 is the mass of the black hole .",
    "the expressions for the characteristic fields of the hydrodynamic equations are then specialized using the above metric components .",
    "we use a polytropic eos with @xmath47 ( the adiabatic exponent of the gas ) equal to @xmath186 .",
    "the numerical domain extends from any given non - zero radius inside the horizon , @xmath187 , to some outer radius @xmath188 ( outside and far from the black hole horizon ) . in the particular simulation",
    "reported here we choose @xmath189 ( inside the black hole horizon , located at @xmath190 ) and @xmath191 .",
    "we use a uniform ( equally spaced ) numerical grid of 200 zones .",
    "the test proceeds as follows : we set the semi - analytic solution as initial data throughout the domain , and then evolve these data , maintaining the exact solution as a constant inflow boundary condition at the outer boundary .",
    "representative results are summarized in figs .",
    "[ fig : accretion1]-[fig : fixed ] .    in figure",
    "[ fig : accretion1 ] we display only the solution up to a radius of @xmath192 , in order to focus on the most interesting , strong field region , around the black hole horizon .",
    "the figure displays the primitive variables , ( @xmath193 ) , as functions of the ingoing eddington - finkelstein radial coordinate .",
    "these figures show the capturing of the steady - state spherical accretion solution .",
    "the solid lines represent the exact solution , while the filled circles indicate the numerical one .",
    "the latter has been evolved up to a time @xmath194 .",
    "the agreement between the exact and numerical solutions is very good for all fields .",
    "this is more clearly seen in fig .",
    "[ fig : accretion2 ] where we plot the relative errors of the primitive variables .",
    "the largest errors appear at the innermost zones .",
    "the maximum error never exceeds 2% , for the internal energy , or 1% , for the density , even with the relatively coarse grid of 200 points .",
    "the quality of the results for the velocity is excellent , with the maximum relative error being about 0.1% .    in fig .",
    "[ fig : fixed ] the convergence properties are captured more quantitatively .",
    "the squared difference of the density from the exact result , integrated over the entire domain ( the @xmath181 norm ) , is plotted as a function of advanced time , for a total time of 200 . after an initial rise ,",
    "the error settles into a final state , the level of which is converging to third order with the radial grid size .",
    "we note in passing that no secular instabilities of any kind arise during the computation , for total number of iterations of the order of @xmath195 .",
    "besides the intrinsic value of the test as an exact strong field solution , an important practical aspect merits mentioning here : very low density spherical inflow solutions constitute a good _ background _ flow , useful in computations where the primary dynamics of interest involves high density concentrations around the black hole .      in our last numerical demonstration",
    "we investigate the accretion of a self - gravitating perfect fluid onto a non - rotating black hole .",
    "the setup of the simulation is as follows : boundary values corresponding to a black hole of given mass @xmath196 are specified at the world - tube , located at @xmath197 .",
    "the interior to that radius is filled first with low density data which do not interact with the black hole geometry in the timescales of interest . the dynamically interesting fluid component",
    ", typically a high density distribution ( compared to the background ) of compact support with sufficiently strong self - gravity , is added next .",
    "the data to be specified are @xmath198 and are , in short , completely arbitrary , with one exception : for the setup to correspond to a spacetime with a trapped region , i.e. , with a horizon , the added fluid mass should not exceed @xmath196 .",
    "the velocity profile is borrowed from the bondi accretion solution and , hence , corresponds to an inwards monotonically increasing velocity .",
    "the initial data for the density are specified with explicit profiles , e.g. , flat or gaussian radial distributions . in our simulations",
    "we consider a gaussian spherical shell surrounding the central black hole , with density parameterized according to @xmath199 where @xmath200 is the background density .",
    "the rest of parameters take the values : @xmath201 , @xmath202 and @xmath203 .",
    "the grid extends from @xmath204 to @xmath205 .",
    "finally , the internal energy is obtained assuming an initially isentropic distribution of pressure @xmath206 ( which would be valid at later times only for equilibrium configurations ) .",
    "the results of the simulation are plotted in figs .",
    "[ fig : sga1 ] , [ fig : sga2 ] and  [ fig : sga3 ] . in fig .",
    "[ fig : sga1 ] we display the evolution of the primitive variables @xmath207 , from top to bottom , as a function of the ingoing eddington - finkelstein radial coordinate , @xmath87 . the configuration is radially advected ( accreted ) towards the hole in the first @xmath208 .",
    "once the bulk of the accretion process ends , we are left with a quasi - stationary background solution ( basically equivalent to the bondi solution ) . in fig .",
    "[ fig : sga2 ] we plot the evolution of the logarithm of the riemann scalar curvature .",
    "we note that the initial shell has associated with it a non - negligible curvature . at late times",
    "the solution is again dominated by the curvature of the central black hole .",
    "the location of the apparent horizon of the black hole can be easily computed during the evolution .",
    "for the simplified case of spherical symmetry , this location is just given by the zero of the @xmath106 metric component .",
    "our results show that the accretion process initiates a rapid increase of the mass of the apparent horizon .",
    "this is depicted in fig .",
    "[ fig : sga3 ] .",
    "the horizon almost doubles its size during the first @xmath208 ( this is enlarged in the insert of fig .",
    "[ fig : sga3 ] ) .",
    "once the main accretion process has finished , the mass of the horizon slowly increases , in a quasi - steady manner , whose rate depends on the mass accretion rate imposed at the world - tube , @xmath47 , of the integration domain .",
    "the numerical solution can be evolved as far as desired into the future .",
    "the equations of general relativistic hydrodynamics have been written directly in terms of components of the fluid fields in an arbitrary coordinate patch .",
    "the system of equations has been diagonalized in the general case , aiming at the subsequent use of advanced numerical methodology .",
    "the conservation form of the equations is preserved to the degree possible , whereas the formulation does not require a spacelike foliation for its implementation .",
    "we may ask whether there is any unexpected element in the developments here . the formulation of the hydrodynamic equations as a cauchy problem , ( well ) posed on a null spacetime surface , is intuitively expected and has been formulated before as mentioned in the text .",
    "the writing of the equations as a system of conservation laws on an arbitrary foliation is implicit in their abstract representation .",
    "it is further expected that for any non - degenerate choice of primitive fields , the system will be hyperbolic and diagonalizable . what does appear to be more of a happy algebraic coincidence rather than a general feature is the possibility of _ explicitly _ solving for the eigenfields .",
    "indeed , choices of variables close to the ones presented here do not allow explicit diagonalization .",
    "we are aware of two cases in the literature where similar explicit resolutions as the ones reported here have been achieved . in the first case the authors made an explicit assumption of a spacelike foliation  @xcite ( see also  @xcite ) , while the second  @xcite appears motivated by a choice of variables specific to a non - relativistic riemann solver ( the roe solver ) , and leads to expressions considerably more complicated than the ones presented here .",
    "we have developed a number of test - beds by recomputing known solutions in our coordinates .",
    "the performance of the algorithm was satisfactory in each instance , which establishes the overall feasibility of the approach .",
    "the practical value of this demonstration is that advanced schemes developed for the hydrodynamic equations by a large community of researchers ( encompassing computational astrophysics ) will be available with minimal modifications to this more specialized field .",
    "a further point of interest is that it is demonstrated here , implicitly , that the newtonian pedigree of the field of hydrodynamics is essentially bypassed in the formulation of the relativistic equations as conservation laws .",
    "our variables have no connection , in the null case , to the instantaneous rest frame ( eulerian ) observers defined by the normal to a spacelike hypersurface .",
    "the selection of computations in the last section is geared towards highlighting the suitability of our approach to the study of black holes interacting with matter . in a representative computation , we have shown how a non - trivial increase of the mass of the black hole horizon can be achieved naturally in the present framework .",
    "this can be contrasted with the considerably harder task of achieving long term black hole evolutions in a spacelike approach , as it is seen , for example , in  @xcite .",
    "extending the present setup to three - dimensional spacetimes appears to be an important target for the near future . in this respect ,",
    "the feasibility of extending the vacuum civp with the inclusion of matter sources has recently been reported  @xcite .",
    "we thank ed seidel for supporting this project since its inception and jos m@xmath209 .",
    "ibez for many useful discussions .",
    "most computations were performed at the origin 2000 supercomputer of the aei .",
    "p.p would like to thank sissa for hospitality while parts of this work were being completed .",
    "j.a.f acknowledges financial support from a tmr grant from the european union ( contract nr .",
    "erbfmbict971902 ) .    # 1#2#3 phys .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 phys .",
    "d , * # 1 * , # 2 ( # 3 ) # 1#2#3 phys .",
    "b , * # 1 * , # 2 ( # 3 ) # 1#2#3 phys . reports , * # 1 * , # 2 ( # 3 ) # 1#2#3 physica , * # 1 * , # 2 ( # 3 ) # 1#2#3 j. comput . phys . ,",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 j. math .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 computer phys .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 class .",
    "quantum grav . ,",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 computers math .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 math .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 astrophys .",
    "j. , * # 1 * , # 2 ( # 3 ) # 1#2#3 astrophys . j. suppl .",
    ", * # 1 * , # 2 ( # 3 ) # 1#2#3 acta astronomica , * # 1 * , # 2 ( # 3 ) # 1#2#3 sov .",
    ", * # 1 * , # 2 ( # 3 ) # 1#2#3 siam j. sci .",
    "* # 1 * , # 2 ( # 3 ) #1#2#3 astron .",
    "astrophys . ,",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 mon . not .",
    "* # 1 * , # 2 ( # 3 ) # 1#2#3 proc .",
    "london , ser . a , * # 1 * , # 2 ( # 3 ) # 1#2#3 i.j.m.p .",
    "c * # 1 * , # 2 ( # 3 )                                                                contrast those definitions with the usual spacelike approach , in which the normal to a time - slice along with the projection operator are applied to the stress - energy tensor to obtain its eulerian , `` instantaneous rest frame '' , components .",
    "we make here the clarification that the name conservation law , used for the system of equations  ( [ eq : cons - law ] ) is a well established misnomer , as the quantities @xmath17 are not strictly conserved in a general spacetime .",
    "we present equations and solutions corresponding to an _ ingoing _ null foliation , in keeping with the applications that follow .",
    "a trivial change in variables produces the outgoing version , which would be more appropriate e.g. , for global studies of relativistic stars ."
  ],
  "abstract_text": [
    "<S> we introduce a formulation of eulerian general relativistic hydrodynamics which is applicable for ( perfect ) fluid data prescribed on either spacelike or null hypersurfaces . </S>",
    "<S> simple explicit expressions for the characteristic speeds and fields are derived in the general case . </S>",
    "<S> a complete implementation of the formalism is developed in the case of spherical symmetry . </S>",
    "<S> the algorithm is tested in a number of different situations , predisposing for a range of possible applications . </S>",
    "<S> we consider the riemann problem for a polytropic gas , with initial data given on a retarded / advanced time slice of minkowski spacetime . </S>",
    "<S> we compute perfect fluid accretion onto a schwarzschild black hole spacetime using ingoing null eddington - finkelstein coordinates . </S>",
    "<S> tests of fluid evolution on dynamic background include constant density and tov stars sliced along the radial null cones . </S>",
    "<S> finally , we consider the accretion of self - gravitating matter onto a central black hole and the ensuing increase in the mass of the black hole horizon .    </S>"
  ]
}