{
  "article_text": [
    "the problem of packing rigid objects , and spheres in particular , is a fundamental problem which appears across disciplines @xcite . in general",
    ", the objects could have arbitrary shapes and the ambient space can be an abstract space @xmath0 . given the space and the objects , the main question is that of finding the densest packings .    in coding theory one is interested in finding an optimal representation of @xmath1 symbols in binary strings of length @xmath2 , that is",
    "@xmath3 is the hamming space of dimension @xmath2 .",
    "this optimal coding contains as many as possible symbols and ensures that after transmitting through a noisy channel , which at most flips @xmath4 variables , one can recover the original messages .",
    "the ratio between the characteristic length of the symbols @xmath5 and length of the transmitted strings @xmath2 defines the rate of coding ( or packing ) .",
    "the _ maximum rate of coding _ is denoted by @xmath6 .",
    "indeed people are interested to know the asymptotic form of @xmath6 when @xmath7 and @xmath8 remains constant .",
    "so far there is a considerable difference between the best lower and upper bounds for @xmath6 @xcite .",
    "this means that for large @xmath2 the best lower and upper bounds for the number of symbols differ by a factor of order @xmath9 .",
    "physically , one can consider the set of symbols as a system of identical particles in the hamming space of dimension @xmath2 , interacting by a hard core potential of range @xmath10 @xcite .",
    "the aim is then to study the physical states of different densities . clearly for small densities",
    "the system is in the liquid phase respecting the translational symmetry . in this case",
    "it is easy to calculate , for example , the entropy . at higher densities",
    "the liquid entropy becomes incorrect ( negative ) signaling the onset of other stable phases , either crystalline or glassy @xcite .    in this study",
    "we formulate the packing problem as a _ constraint satisfaction problem_. we consider @xmath1 variables ( the physical particles or the strings of symbols ) which take values in @xmath0 and for each pair of the variables we consider a constraint that forbids overlapping assignments of the two variables .",
    "a packing is thus an assignment of the variables that satisfies all the constraints .",
    "this representation differs substantially with the so called _ lattice gas _ models where binary variables ( representing occupied or empty positions ) are defined one each point of the space @xmath0 .",
    "the _ cavity method _ provides analytical and numerical tools which can be extremely useful in solving optimization problems ( or constraint satisfaction problems ) over random structures @xcite . in certain cases",
    "it is known to provide sampling results which can not be obtained by monte carlo markov chains in subexponential times [ e.g. optimization problems in the one - step replica symmetry breaking ( 1rsb ) phase ] . as an optimization tool it often outperforms linear programming methods @xcite .",
    "the development of such algorithm is , however , by no means obvious due to the choice of the representation of the problem and to the need of writing the cavity equations in an algorithmically efficient form .    as we shall discuss in this paper , insights from the application of the cavity method",
    "will turn out to be also useful in the study of the type of packing problems we are interested in .    in this paper",
    "we study the cavity equations for the packing problem in the replica symmetric ( rs ) and in the one - step replica symmetry breaking ( 1rsb ) approximations @xcite .",
    "these equations are called _ belief propagation _ ( bp ) and _ survey propagation _ ( sp ) equations , respectively @xcite . in the rs approximation , besides a liquid solution we find a crystalline phase where with higher probability spheres are found in one of the sublattices ( even or odd ) of the hamming space .",
    "this phase has already been observed in monte carlo simulations of ref .",
    "both the liquid and crystalline solutions predict a maximum rate of packing that behaves asymptotically like the best known lower bound @xcite . the same result has been obtained in ref .",
    "@xcite where the liquid entropy is computed in the hypernetted chain approximation . to discuss the exactness of the cavity free entropy we also consider some interpolation techniques which connect the cavity free entropy to the true entropy of the system @xcite .    in the 1rsb case",
    ", we provide an approximate solution of the sp equations to calculate the configurational entropy , defined as the ( log of ) the number of pure states or clusters in the solution space .",
    "this quantity acquires a nonzero value at a clustering transition where the liquid entropy is still positive .",
    "the maximum rate of packing that is achievable still coincides with the one obtained in the rs approximation .",
    "finally we design a message passing algorithm based on the bp equations which allows us to find dense packings in not too large dimensions .",
    "these packings are typically hard to find by other simple methods like monte carlo based algorithms .",
    "unfortunately the computation time and memory increase exponentially with the space dimension @xmath2 , making larger dimensions very difficult to explore . to partially overcome this problem we introduce an approximate update rule for the message passing algorithm which",
    "is restricted to a subspace and makes the computation more efficient .",
    "this improvement , together with the distributive nature of the algorithm , could help to run the algorithm in larger dimensions .",
    "we also discuss another iterative algorithm that , given a packing configuration of spheres with diameter @xmath10 , finds another packing for larger diameter @xmath11 by increasing the space dimension @xmath2 .",
    "this is a polynomial time algorithm generating maximum packings in an ultrametric space .",
    "when applied to our problem , we find crystalline packings predicted by the rs cavity equations for even sphere diameters .",
    "the structure of the paper is as follows . in sec .",
    "[ 1 ] we define the problem more precisely and give a summary of known results . in secs .",
    "[ 2 ] and [ 3 ] we present the bp and sp equations and study their consequences for the hard sphere packing problem . in sec .",
    "[ 4 ] we study the packing algorithms and sec . [ 5 ] is devoted to extension to the @xmath12-ary hamming spaces .",
    "finally the concluding remarks are given in sec .",
    "[ 6 ] . in the first two appendixes we give the details of calculations for checking the stability of the bp solutions and deriving the sp equations .",
    "the interpolation methods and some of their properties are presented in appendix [ inter - app ] .",
    "consider @xmath1 hard spheres of diameter @xmath10 indexed by @xmath13 and a hamming space of dimension @xmath2 .",
    "the set of points in this space are denoted by @xmath14 with size @xmath15 .",
    "we index the points in this space by @xmath16 .",
    "a point can be represented by a binary vector of @xmath2 elements @xmath17 .",
    "the hamming space can be partitioned into two subspaces : even and odd .",
    "points in the even subspace have an even number of @xmath18 s ( even parity ) and those in the odd subspace have an odd number of @xmath18 s ( odd parity ) . the hamming distance @xmath19 between two",
    "points @xmath16 and @xmath20 is equal to the number of different elements in the binary representation of the two points . for each point",
    "@xmath16 we define the set @xmath21 as @xmath22    the aim is to find a non - overlapping configuration of spheres such that @xmath23 , for any two spheres @xmath24 and @xmath25 .",
    "the above problem is a constraint satisfaction problem with @xmath26 constraints to satisfy .",
    "we index these constraints by @xmath27 . a configuration @xmath28 that satisfies all the constraints",
    "is called a solution of the problem . the partition function",
    "@xmath29 counts the number of such solutions , @xmath30 where @xmath31 is an indicator function for constraint @xmath27 ; it is @xmath18 if @xmath23 and @xmath32 otherwise .",
    "the maximum rate of packing is defined as @xmath33 with @xmath34 and @xmath35 is the maximum number of spheres such that @xmath36 .",
    "let us here mention some known lower and upper bounds for @xmath6 .",
    "the gilbert and varshamov ( gv ) lower bound @xcite states that @xmath37 resulting in the following lower bound for the maximum rate of packing @xmath38 where @xmath39 notice that @xmath40 is also the shannon rate for a binary symmetric channel with error probability @xmath41 .",
    "a better lower bound is obtained with graph theoretical methods @xcite and gives @xmath42}{n},\\ ] ] where @xmath43 is a constant . as far as we know , this is the best lower bound reported for the maximum rate of packing .",
    "however , it still behaves asymptotically like @xmath44 .",
    "the authors in ref . @xcite use the liquid entropy of the system of hard spheres to find a maximum rate of packing that is very close to the above lower bound @xmath45}{n}.\\ ] ]    .,width=377 ]    on the other side , we have the hamming upper bound @xcite @xmath46 resulting in @xmath47 the best upper bound for @xmath6 is obtained by the linear programming methods @xcite .",
    "an overestimate of this linear programming bound is @xmath48 in fig .",
    "[ f1 ] we have compared the above bounds to show the large gap between the best lower and upper bounds .",
    "the basic objects in the cavity method are the cavity marginals or messages passed along the edges of the interaction graph @xcite . in our problem",
    "the messages are @xmath9-component vectors with elements @xmath17 .",
    "there are two kinds of messages : ( i ) the cavity bias @xmath49 represents the warning that variable @xmath24 sends to @xmath25 ; @xmath50 says that point @xmath51 is ( not ) forbidden by @xmath24 for variable @xmath25 .",
    "( ii ) the cavity field @xmath52 is sum of warnings that @xmath24 receives in absence of @xmath25 ; @xmath53 gives the number unsatisfied constraints , in the absence of @xmath25 , if variable @xmath24 takes state @xmath16 .",
    "the cavity biases are @xmath54    in the rs framework we assume that all the packings or solutions belong to the same cluster of solutions in the configuration space .",
    "suppose the interaction graph is a tree and @xmath55 is a solution of the problem in the absence of variable @xmath25 .",
    "then we represent the cavity bias @xmath49 by @xmath56 . notice that according to our definitions a cavity solution uniquely determines the cavity message @xmath49 .",
    "the histogram of cavity biases among the solutions is given by @xmath57 assuming a tree interaction graph one can write equations governing the cavity probabilities @xmath58 : @xmath59 where @xmath60 denotes the set of variables interacting with variable @xmath24 .",
    "the above equations are called bp equations @xcite .    in the bethe approximation the entropy density of the system is written as @xmath61,\\ ] ] where @xmath62 and @xmath63 are the entropy shifts by adding variable @xmath24 and interaction @xmath27 , respectively . for these quantities",
    "we have @xmath64 in words , @xmath65 is the probability that variable @xmath24 can occupy at least one point in the hamming space and @xmath66 is the probability that interaction @xmath27 is satisfied .    using the above equations for hard spheres we obtain @xmath67 and",
    "@xmath68 now we can try different solutions to the bp equations .",
    "the liquid solution is obtained by taking @xmath69 for any @xmath24 and @xmath25 . evaluating @xmath65 and @xmath66 at the liquid solution we can write the bp entropy @xmath70 where @xmath71 .",
    "this entropy vanishes at @xmath72 for large @xmath2 it gives @xmath73 in fig .",
    "[ f2 ] we compare this quantity with some known exact results and lower bounds in small dimensions",
    ". the maximum rate of packing predicted by the liquid solution of the bp equation is @xmath74}{n}.\\ ] ] where we have used @xmath75}.\\ ] ] we check the stability of the liquid solution in appendix [ sbp - liquid - app ] ; we find no continuous glass transition as long as @xmath76 which is the case for @xmath77 as @xmath78 is exponentially small in this region .",
    "( bp ) with some lower bounds ( lb ) from @xcite .",
    "up to @xmath79 all the lower bounds are exact.,width=377 ]      in some situations the spheres may prefer one of the sublattices of the hamming space to the other @xcite .",
    "indeed for even values of @xmath10 , a sphere at the origin forbids more points from the odd sublattice than the even one . for high densities",
    "the neighboring spheres will be at distance @xmath10 from the origin , i.e. , they occupy points that again belong to the even sublattice .",
    "the above observation suggests that we could have ordered states in which nearly all the spheres are in the even or odd sector of the hamming space . here",
    "we will consider this situation by assigning different messages @xmath80 and @xmath81 to points in the even and odd sublattices , respectively .",
    "again we use the fact that all the points in one sublattice are equivalent . now",
    "the bp equations are @xmath82},\\\\ \\nonumber \\eta^o=\\frac{(1-v^{o}_d \\eta^e - v^{e}_d \\eta^o)^{n-2}}{2^{n-1}[(1-v^{e}_d \\eta^e - v^{o}_d \\eta^o)^{n-2}+(1-v^{e}_d \\eta^o - v^{o}_d \\eta^e)^{n-2}]},\\end{aligned}\\ ] ] where @xmath83 and @xmath84 are given by @xmath85 notice that @xmath86 and @xmath87 can not be a solution of the above equations unless for @xmath88 . indeed to have such a solution we need @xmath89 , which holds only when @xmath88 .",
    "we will look for other solutions where @xmath90 . in this case",
    "we have @xmath91     shows that a crystal solution appears by increasing the number of spheres.,width=377 ]    let us introduce the rescaled variables @xmath92 , @xmath93 , @xmath94 and @xmath95 . using the normalization condition @xmath96 , we obtain an equation for @xmath97 , @xmath98^{n-2 } = ( 1-p^e ) [ 1-v^e_d p^e - v^o_d ( 1-p^e)]^{n-2}.\\ ] ] for large @xmath2 and @xmath10 a nontrivial solution appears at @xmath99 ; see fig .",
    "[ f3 ] . at this point ,",
    "the two sides of eq . [ crys - equ ] have the same slope at @xmath100 .",
    "thus we find @xmath101 the entropy of the crystalline phase is obtained given @xmath65 and @xmath66 , @xmath102 , \\\\",
    "z_{ij } & = 1-p^e(v^e_d p^e+v^o_d p^o)-p^o(v^e_d p^o+v^o_d p^e).\\end{aligned}\\ ] ] to get a simple expression for the entropy",
    "we do the following approximation : @xmath103 and @xmath104 .",
    "notice that when @xmath10 is even , @xmath105 and from eq .",
    "[ crys - equ ] we see that for large @xmath1 , @xmath106 should be much smaller than @xmath97 . in this approximation",
    "the entropy reads @xmath107 this entropy vanishes at @xmath108 for large @xmath2 the leading term is @xmath109 for @xmath7 the ratio @xmath110 approaches to a constant and we recover asymptotically the bound provided with the liquid solution . in fig . [ f4 ] we have compared the liquid and crystal entropies for a given @xmath2 and even @xmath10 . later in sec .",
    "[ 42 ] we will introduce an iterative algorithm constructing the above crystalline packings .",
    "in the 1rsb framework we assume that there are an exponentially large number @xmath111 of clusters of solutions .",
    "a cluster of solutions consists of packing solutions in the configuration space that are connected to each other by paths of finite hamming distances in the thermodynamic limit . in each cluster",
    "we could have _ frozen _ and _ unfrozen _ variables .",
    "suppose the interaction graph is a tree and consider all cavity solutions ( in absence of variable @xmath25 ) that belong to a given cluster ; in a tree graph , fixing the boundary variables is equivalent to fixing the cluster of solutions .",
    "it may happen that in all the solutions of a cluster , variable @xmath24 takes only one state , say @xmath16 .",
    "then the survey bias @xmath112 will be @xmath113 and we say variable @xmath24 is a completely frozen variable in that cluster",
    ". we could have partially frozen variables that are frozen on a subset @xmath114 of the hamming space . in this case",
    "we represent the survey bias by @xmath115 ignoring the degeneracy of each state . in general we could write @xmath116 where @xmath117 is the number of times that variable @xmath24 appears in state @xmath16 . a variable that takes all possible values",
    "is called an unfrozen variable and its survey bias is represented by @xmath118 .",
    "the survey biases defined above depend on the cluster of solutions and change from one cluster to another . for an edge @xmath27 of the interaction graph",
    ", we define the histogram of the survey biases among the clusters @xmath119 notice that compared with the rs case here we have the extra option @xmath118 .",
    "the survey fields are determined by the survey biases : @xmath120 in words , @xmath121 is the minimum number of unsatisfied constraints , in the absence of @xmath25 , if sphere @xmath24 takes position @xmath16 .",
    "here we need only to know if @xmath122 is zero or greater than zero .",
    "so we change the field s definition to @xmath123 the aim is to write an equation for @xmath124 .",
    "the value of @xmath125 is determined by the normalization condition .",
    "variable @xmath24 sends the survey bias @xmath126 to variable @xmath25 if its survey field is @xmath127 that is if the only choices for variable @xmath24 are the states in @xmath128 .",
    "we write this probability as @xmath129 where @xmath130 is the event that at least one of the @xmath121 is zero .",
    "we have also the condition that variable @xmath24 dose not receive contradictory biases .",
    "it means that the cavity field @xmath131 should not be equal to @xmath132 .",
    "this probability is given by @xmath133 ; so we obtain @xmath134 one can use the standard tools in the probability theory to find the above probabilities in terms of @xmath135 s .",
    "the result is the so called sp equation and is derived with more details in appendix [ sp - app ] .",
    "here we simplify the analysis by assuming that all partially frozen surveys are zero , that is , only completely frozen and unfrozen surveys are taken into account .",
    "this would be a reasonable approximation when @xmath1 approaches @xmath35 .",
    "we also expect to obtain a larger complexity within this approximation . in this ansatz",
    "the sp equation reads @xmath136 where @xmath137 is the union volume of @xmath138 , @xmath139 , @xmath140 and @xmath141 .",
    "in our problem all the edges of the interaction graph are equivalent . moreover , due to the translational symmetry , the surveys @xmath142 do not depend on @xmath16 .",
    "considering these simplifications , the sp equation can be rewritten in a more compact form as @xmath143 where @xmath144 here @xmath145 is the total number of configurations that @xmath146 distinct points can take in the hamming space such that the union volume @xmath147 is equal to @xmath148 .",
    "more precisely we have @xmath149 to obtain more explicit results we consider a naive approximation where @xmath150 .",
    "this is a good approximation for small @xmath151 .",
    "we also approximate @xmath152 by @xmath153 to compensate the error made by overestimating the union volume @xmath137 for large @xmath146",
    ". then the sp equation reads @xmath154 summing over @xmath146 we get @xmath155 let us see where the above equation admits a nontrivial solution @xmath156 . to this end",
    "we will consider the following scalings : @xmath157 and @xmath158 .",
    "for @xmath159 we expect to have @xmath160 and @xmath161 . replacing these in the above equation and expanding for small @xmath162 we obtain @xmath163 to have a solution for @xmath164 we need @xmath165 with @xmath166 increasing @xmath1 , the frozen variables appear for the first time at @xmath167 , where @xmath168 and therefore @xmath169 this gives the clustering transition , when the solution space splits into an exponentially large number of clusters .",
    "we can compute the complexity in the bethe approximation as @xmath170.\\ ] ] as before , @xmath171 and @xmath172 are the complexity shifts by adding variable @xmath24 and interaction @xmath27 .",
    "the complexity is zero for small densities of the particles where we expect to have a single cluster of solutions .",
    "as we increase @xmath1 , we encounter the clustering transition at @xmath173 , where @xmath174 becomes nonzero .",
    "the complexity is a decreasing function of @xmath1 and finally vanishes at @xmath35 .",
    "here we shall focus on the most numerous clusters , which are not necessarily the relevant ones .",
    "more accurate results can be obtained by a large deviation study of the problem , which involves computing the complexity of different clusters @xcite .",
    "to compute the complexity we need the two quantities @xmath171 and @xmath172 . again for the sake of simplicity we only work with the completely frozen surveys . in this approximation",
    "we get @xmath175 and the link contribution is @xmath176 using our notation in the previous subsection we can write a more compact form of the complexity for uniform surveys @xmath177 -\\frac{n-1}{2}\\ln[1 - 2^{n}v_d \\eta^2].\\end{aligned}\\ ] ] in the naive approximation , where we approximate @xmath147 by @xmath178 , we find @xmath179-\\frac{n-1}{2}\\ln[1 - 2^{n}v_d\\eta^2].\\ ] ] the complexity vanishes when @xmath180 using again the scalings @xmath181 and @xmath182 , the above equation can be rewritten as @xmath183}.\\ ] ] expanding the left side for the exponentially small @xmath184 we obtain @xmath185 notice that @xmath164 approaches to zero for large @xmath2 as @xmath186 , so the above equation suggests @xmath187 using eqs .",
    "[ sp4 ] and [ sigman ] we can find the complexity in the naive approximation . in fig .",
    "[ f5 ] we have compared this complexity with the bp entropy for @xmath188 and @xmath189 , where the naive approximation is expected to work .",
    "we see the jump in the complexity that happens at the clustering transition @xmath167 .",
    "moreover , the complexity is always smaller than the rs entropy , as it should be ; it is the sum @xmath190 that gives the total entropy of the system . here",
    "@xmath191 is the internal entropy of the clusters .     and",
    "@xmath189.,width=377 ]    let us summarize the main approximations we used in the above calculations : first , the sp equation ignores the soft part of the messages and works only with the hard fields .",
    "we know that this could give an underestimate of the clustering transition but works well in predicting the satisfiability - unsatisfiability ( sat - unsat ) transition in some constraint satisfaction problems .",
    "next , we neglected the partially frozen states and considered only the completely frozen and unfrozen parts to write a simpler expression for the sp equation .",
    "this approximation seems reasonable as for maximum packings the spheres should be strongly localized by their neighborhood .",
    "and finally , we resorted to another approximation by replacing the union volume of @xmath146 distinct spheres with @xmath178 .",
    "one can improve on this by using an annealed approximation of @xmath147 , @xmath192,\\ ] ] where @xmath193 is the probability that a point in the hamming space is outside the @xmath146 spheres centered at @xmath194 , @xmath140 , @xmath195 .",
    "further , we can approximate @xmath145 by @xmath196^v[(1-v_d)^m]^{2^n - v}.\\end{aligned}\\ ] ] the annealed volume is approximately given by @xmath197 when @xmath198 .",
    "moreover , the completely frozen approximation we used , suggests that the main contribution in the sp equation comes from small values of @xmath146 , see appendix [ sp - app ] .",
    "therefore , we do not expect to observe exponentially large deviations in @xmath167 and @xmath199 beyond the naive approximation .",
    "exact solutions are always useful in that we obtain some insights about more complex problems @xcite . as a simple example which can be treated exactly , we consider the packing problem in an ultrametric space .",
    "an ultrametric space is a metric space where for any three points @xmath200 and @xmath201 we have @xmath202 .",
    "consider a rooted binary tree @xmath203 with @xmath2 generations .",
    "the number of points at generation @xmath204 is @xmath205 .",
    "the space of points is given by the @xmath9 leaves of this tree .",
    "the distance @xmath206 between two points @xmath207 and @xmath208 is defined as the number of generations that one should go up in the tree to find the first common ancestor .     and @xmath209 .",
    "filled and empty spheres show valid packings for @xmath210 and @xmath189 , respectively.,width=302 ]    the problem is to find a packing of @xmath1 hard spheres such that for any two spheres @xmath211 .",
    "the packing problem is trivial for @xmath210 , so we can start from this simple case and try to find packings for larger @xmath10 .",
    "let us start with a binary tree of @xmath212 generations and @xmath213 leaves , @xmath214 .",
    "we put one sphere at each point of this ultrametric space to obtain a packing of @xmath215 spheres with diameter @xmath210 ; see fig .",
    "this is the densest configuration of hard spheres for the above parameters .",
    "the idea is to increase @xmath10 by @xmath18 and add the minimum number of necessary generations to find a new packing with the new diameter for the spheres . indeed in an ultrametric space we need only one additional generation to remove all the overlaps in the previous configuration . after adding the new generation we are free to put each sphere in one of its two descendants .",
    "one can continue the above process to find a valid packing for an arbitrary value of @xmath10 .",
    "it turns out that these are the densest configurations of the spheres with the parameters @xmath2 and @xmath10 ; the packing indeed partitions the whole space into regions occupied by the spheres .",
    "therefore , given @xmath2 and @xmath10 , the number of packings and maximum number of spheres read @xmath216 the maximum rate of packing will be @xmath217 it is interesting that this is exactly the shannon rate for a binary erasure channel with error probability @xmath41 .",
    "the above example is one of the exactly solvable packing problems that one can compare the exact @xmath35 with the bp one computed at the liquid solution : @xmath218 here @xmath219 but we find asymptotically @xmath220 .",
    "here we can use the same strategy as above to find packings of hard spheres in the hamming space .",
    "the points of an @xmath2-dimensional hamming space can be represented by the leaves of a binary tree @xmath203 .",
    "a configuration of @xmath1 spheres , @xmath221 , is a packing of hard spheres with diameter @xmath10 if it satisfies the following set of constraints @xmath222 where @xmath223 is the hamming distance of points @xmath224 and @xmath225 .",
    "we define the energy @xmath226=\\sum_{i",
    "< j}[1-i_{ij}(\\sigma_i,\\sigma_j)]$ ] as the number of unsatisfied constraints .",
    "the _ conflict graph _",
    "@xmath227 represents a graph of @xmath1 nodes where edge @xmath27 is present if the corresponding constraint is not satisfied . to find a packing we do the following steps :    * we start with @xmath215 spheres occupying all the leaves of @xmath214",
    "this is the densest configuration of spheres that satisfies @xmath228 .",
    "we use @xmath229 to represent this configuration of spheres . * for @xmath230 , we start with @xmath231 and find @xmath232 such that all the constraints in @xmath233 are satisfied . set @xmath234 and @xmath235 , then * * if @xmath236 , add a new generation to @xmath203 , that is @xmath237 and @xmath238 . *",
    "* for each sphere find the best value of @xmath239 and call the new configuration @xmath240 . if @xmath241 return @xmath242 and @xmath243 .",
    "all the lower bounds are exact.,width=377 ]    notice that every time we add a new generation we have to solve an optimization problem to find the best configuration , @xmath244 . given @xmath245 and @xmath246 , we need to find the ground state of the following energy function @xmath247= \\sum_{(ij ) \\in \\mathcal{g}(\\underline{\\sigma}^{t-1,\\delta n_t})}\\delta_{s_i , s_j}.\\ ] ] the aim is to assign different values to the new components @xmath248 and @xmath249 when edge @xmath27 belongs to the conflict graph . in our numerical simulations we use simulated annealing to solve the above optimization problem .",
    "we observe that for even @xmath245 the change in the number of generations @xmath246 is @xmath18 ; i.e. , the conflict graph is a bipartite graph connecting only spheres in different sublattices , odd and even .",
    "consequently , for even @xmath10 all spheres are in the same sublattice of the hamming space , as expected from the crystalline phase of sec .",
    "[ 22 ] . in fig .",
    "[ f7 ] we have compared the packings constructed by the above algorithm with the known lower bounds . we also checked the fraction of _ locally frozen _",
    "spheres in these packings .",
    "a locally frozen sphere is one that , fixing the other spheres , can not be locally displaced without violating some of the constraints .",
    "figure [ f8 ] displays this quantity as a function of @xmath10 .",
    "we see that for even @xmath10 a considerable fraction of the spheres are frozen .",
    "this indicates that finding such packings is very difficult by a random sequential adding algorithm @xcite where spheres are added randomly one by one .",
    "let us again write the general bp equations for the packing problem : @xmath250 to solve these equations one starts with random initial values for the cavity messages and updates the messages iteratively to reach a fixed point .",
    "at the fixed point we have the local marginals given by @xmath251    one can find a packing configuration by decimation , fixing the spheres one by one according to the above local marginals ; after each decimation one has to run again the bp equations to obtained the new marginals . here",
    "we take another approach , by using the local marginals to converge the equations to a polarized fixed point defining a packing configuration .",
    "we found it useful here to add also some additional random potential @xmath252 to break the high level of symmetry present in the problem .",
    "the modified bp equations read @xmath253^{r}e^{\\beta w_i(\\sigma_i)}\\prod_{k\\in v(i ) \\setminus j } \\left ( \\sum_{\\sigma_k}i_{ik}(\\sigma_i,\\sigma_k)\\eta_{k\\to i}(\\sigma_k ) \\right),\\\\   \\eta_{i}(\\sigma_i ) & \\propto [ \\eta_i(\\sigma_i)]^{r } e^{\\beta w_i(\\sigma_i)}\\prod_{j\\in v(i ) } \\left ( \\sum_{\\sigma_j}i_{ij}(\\sigma_i,\\sigma_j)\\eta_{j\\rightarrow i}(\\sigma_j ) \\right),\\end{aligned}\\ ] ] where cavity messages are biased toward their local marginals .",
    "these are the reinforced bp ( rbp ) equations @xcite and the positive parameter @xmath254 is called the reinforcement parameter .",
    "the next step is to write the above rbp equations in the limit @xmath255 , assuming the messages scale like @xmath256 .",
    "the resulting reinforced max - sum equations are @xmath257    we solve these equations by iteration starting from random initial messages and zero reinforcement .",
    "the reinforcement parameter @xmath254 is increased gradually as @xmath258 . at the end ,",
    "the states that maximize the @xmath259 define a packing configuration .",
    "the time complexity of this algorithm grows as @xmath260 ^ 2 $ ] .",
    "we checked the algorithm by finding some packings given in @xcite : for instance , maximum packings with parameters @xmath261 , @xmath262 , @xmath263 , @xmath264 .",
    "the main difficulty with large dimensions and number of spheres is the computation time and memory .",
    "one way to reduce both time and memory is to work with restricted search spaces .",
    "for example , we may take an initially random search space @xmath265 of size @xmath266 for each sphere . given these search spaces we run the reinforced max - sum equations to obtain the cavity and local messages .",
    "then for each sphere we replace a part of its search space with new states .",
    "the above steps are repeated to find better search spaces and maybe a packing .",
    "more precisely , the algorithm starts by initially randomly selected search spaces @xmath267 .",
    "then we do the following steps :    * run the reinforced max - sum equations : the messages are updated for sufficiently large number of iterations @xmath268 using the restricted search spaces @xmath265 . for example , we use @xmath269 if we increase the reinforcement parameter by @xmath270 . * update the search spaces : compute the local messages @xmath271 and sort them in a decreasing order to put the good states at the beginning of the list . replace a number of states at the end of this list with other states close to the best one . in our simulations we replace half of the search spaces .    in this way we could , for example , find the maximum packings for @xmath261 and @xmath262 with a search space of dimension @xmath272 and @xmath273 , respectively .",
    "this also allowed us to find some packings in larger dimensions , for instance @xmath274 , @xmath275 .",
    "these are the best known packings ( maybe maximum ) with those parameters . and in some cases we find denser packings with larger sphere diameters : @xmath276 , @xmath277 .",
    "the above results can easily be extended to the @xmath12-ary hamming spaces @xmath278 .",
    "there are @xmath279 points in this space represented by vectors of @xmath2 elements in @xmath280 .",
    "as before , the hamming distance @xmath19 gives the number of different elements in two vectors @xmath16 and @xmath20 .",
    "therefore the number of points at distance less than @xmath10 from a point is given by @xmath281 in the asymptotic limit @xmath282 and @xmath283 finite , we get @xmath284}$ ] where @xmath285    in this section we shall only discuss the results obtained within the replica symmetric approximation .",
    "the bp equations remain the same as in eq .",
    "[ bp ] , so we write directly the bp entropy computed at the liquid solution , i.e. , @xmath286 : @xmath287 this entropy vanishes at @xmath288 which gives a rate of packing that is not asymptotically different from the gilbert - varshamov ( gv ) one , @xmath289}{n}.\\ ] ]    but , we know that for @xmath12-ary alphabets and @xmath12 large enough , the rate of packing could asymptotically exceed the gv bound @xcite .",
    "these packings , known as algebraic - geometry codes in coding theory , result in the following lower bound when @xmath12 is a square : @xmath290 and if @xmath291 there exists always an interval in which @xmath292 .",
    "we believe that these are some crystalline or ordered solutions that only happen for large values of @xmath12 .",
    "the fact that at @xmath293 the rate is smaller than @xmath18 indicates that the above packings are restricted to a subspace of @xmath0 which is exponentially smaller than @xmath279 .",
    "moreover , comparing @xmath294 with the rate of packing in an ultra - metric space suggest that this subspace is effectively ultrametric ; see sec . [ 41 ] .",
    "more precisely , an ultra - metric subspace of size @xmath295 where each sphere occupies @xmath296 points would result to the same rate of packing as @xmath294 .",
    "we remind that in ultrametric spaces both the bp and gv bounds are asymptotically exact .",
    "notice that also for @xmath297 one obtains @xmath298 .",
    "indeed the number of points that their hamming distance from a given point is equal to their ultrametric distance is @xmath299 $ ] , which is exponentially large as long as @xmath300 .",
    "this is an upper bound for the size of an ultrametric subspace .",
    "moreover , given diameter @xmath10 , we need only a subspace that is ultra - metric up to distances less than @xmath10 .",
    "let us define @xmath301 as the probability that a point belongs to an ultrametric subspace .",
    "a naive estimation of @xmath301 can be obtained by @xmath302 note that @xmath303 is exponentially smaller than @xmath304 , thus asymptotically @xmath305 . in this case , each sphere will occupy only @xmath306 points of the subspace , so we recover the gv rate of packing . the above argument says the gap between the typical and maximal ultra - metric subspaces is very large , assuming the tv bound comes from packings in an optimal ultrametric subspace .",
    "in summary , we have written the bp and sp equations to study the hard sphere packing problem in the hamming space . within these approximations",
    "we obtained a maximum rate of packing that is asymptotically the same as the lower bound of gilbert and varshamov . in the rs approximation we also found a crystalline phase where for even values of @xmath10 the spheres prefer to be in one sector of the hamming space .",
    "the bp solutions were stable with respect to continuous glass transitions as long as @xmath307 .",
    "this suggests that phase transitions , if any , would be of discontinues type .",
    "we have also introduced two new algorithms . first a message passing algorithm based on the bp equations which finds dense packings of hard spheres in finite dimensions .",
    "an approximate scheme is used to reduce the time and memory complexity of the algorithm , which can still be improved and hopefully lead to new packing results .",
    "an almost identical algorithm can be used in continuous spaces . as a proof of concept we used it to find some known local dense packings in two - dimensional euclidean space .",
    "second , we introduced an iterative algorithm to find packings of hard spheres starting from small diameters and dimensions . for even diameters the algorithm generates packings with all spheres in one subspace of the hamming space , as expected from the crystalline solution of the bp equations .",
    "there are still some points that need more effort to be clarified .",
    "it is of extreme relevance to establish the relation between the exact maximum rate of packing and the one provided by the bp equations .",
    "this means , for instance , that we need to study some interpolating functions between the exact and the bp entropy .",
    "preliminary results are discussed in appendix [ inter - app ] .",
    "we expect the bp bound to be asymptotically exact in the binary hamming space",
    ".    finally , it would be nice if one could obtain the algebraic - geometry lower bound for the maximum rate of packing in the @xmath12-ary hamming spaces with some physical arguments .",
    "these are probably crystalline solutions that can not be captured within the rsb formalism as the rs entropy is expected to be larger than that of the glassy solutions in the rsb phase .    as a concluding remark",
    ", we should mention that the 1rsb study presented here is not complete ; the sp equations only consider the hard or frozen part of the cavity messages .",
    "a more complete study of the 1rsb approximation also takes the soft part of the messages into account and asks for the stability of these solutions @xcite .",
    "we would like to thank c. baldassi , a. braunstein , h. cohn , s. franz , s. torquato , and f. zamponi for their help and useful discussions .",
    "ar and rz acknowledge the erc grant optinf 267915 .",
    "the liquid solution of the bp equations would be stable as long as the ferromagnetic ( linear ) and spin glass ( nonlinear ) susceptibilities are finite @xcite .",
    "these conditions can be expressed in terms of the maximum eigenvalue of the response matrix @xmath308 : @xmath309 that has been evaluated at the liquid solution .",
    "then the stability conditions read @xmath310 where @xmath311 is the maximum eigenvalue ( in absolute value ) of @xmath308 .",
    "more precisely , for @xmath312 and @xmath313 we would have no continuous phase transition to an ordered and spin glass phase , respectively .",
    "notice that these conditions do not exclude discontinuous phase transitions .",
    "the response matrix @xmath308 is symmetric with real eigenvalues and orthogonal eigenvectors . using the translational symmetry by even vectors we write the eigenvectors as @xmath314 where @xmath315 is",
    "the binary vector representing a point in the hamming space and @xmath316 is a binary wave vector .",
    "the eigenvalues are obtained by plugging the above expression in the eigenvalue equation @xmath317 then for the eigenvalues we obtain @xmath318 the above expression is independent of @xmath16 and for simplicity we choose @xmath319 . consider the maximum wave vector @xmath320 .",
    "the corresponding eigenvalue is @xmath321 obviously , the maximum eigenvalue is bounded by @xmath322 .",
    "let us approximate the maximum eigenvalue by the largest contribution at @xmath323 , @xmath324 notice that for large @xmath2 this is still asymptotically equivalent to the trivial bound @xmath325 .",
    "using the sterling approximation for large @xmath2 we get @xmath326 which according to eq .",
    "[ bpst0 ] gives @xmath327",
    "let us start from eq .",
    "[ sp0 ] and find a more suitable form of the sp equation , @xmath328 where @xmath329 . using the inclusion - exclusion theorem we write @xmath330 here",
    "@xmath331 is the probability of having @xmath332 , @xmath333 , @xmath334 , @xmath335 .",
    "the probability in the numerator can be rewritten in the same way as @xmath336 in the above equation we have probabilities like @xmath337 which , using the normalization condition , can be rewritten as @xmath338 plugging these into our expression for the numerator , eq .",
    "[ app - num ] , we find @xmath339 notice that the last term in the first bracket is canceled with the first term in the second bracket .",
    "this cancellation indeed happens for any two subsequent brackets . simplifying the above expression",
    "we find @xmath340 now we should write a more explicit relation for @xmath331 . first note that @xmath341 \\eta_{k\\rightarrow i}^{\\sigma_1',\\dots,\\sigma_{m'}'}\\right),\\ ] ] where @xmath342 is the intersection of sets @xmath343 .",
    "this is the probability that no variable in @xmath344 sends a survey that forbids state @xmath194 for variable @xmath24 . here",
    "@xmath345 is an indicator function for condition @xmath346 . and in general @xmath347 where @xmath348 using the above probabilities in eqs .",
    "[ app - prob0 ] and [ app - prob1 ] , we obtain the sp equation , @xmath349 with @xmath350",
    "in any approximation it is important to know how well the method approximates the correct behavior . considering the bp approximation , we know that it is exact at least on tree interaction graphs . on loopy graphs , the bp approximation may overestimate or underestimate the correct entropy .",
    "this in general depends on the nature of the interactions and configuration space .",
    "the liquid solution of the bp equations is indeed equivalent to treating all the constraints independently and replacing a check @xmath31 with its average value when both @xmath224 and @xmath225 are free . to model this solution , on each interaction edge @xmath27 we introduce auxiliary variables @xmath351 besides the original variables .",
    "the new variables will serve as independent copies of variables @xmath352 on edge @xmath27 .",
    "clearly if we want to recover the exact partition function we should force all the copies to be the same as their originals . summing all together we write the following interpolating partition function : @xmath353 }",
    "\\right),\\end{aligned}\\ ] ] with an inverse temperature @xmath354 scaling as @xmath355",
    ". then we have @xmath356 and @xmath357 .",
    "the above interpolating function can be defined for any constraint satisfaction problem that admits a uniform liquid solution .",
    "notice that without the normalization factor @xmath358 we would obtain a replicated partition function @xmath359 that is a convex and decreasing function of @xmath354 .",
    "in fact @xmath360 , providing a simple upper pound for the true partition function for any @xmath354 .",
    "to get a good upper bound one needs to solve the replicated problem for the largest possible @xmath354 . adding the normalization factor destroys the upper bound property but it is necessary if we want to recover @xmath361 at @xmath362 .",
    "let us define variables @xmath363 as @xmath364 taking the @xmath146th derivative of @xmath365 with respect to @xmath354 we obtain @xmath366 with @xmath367 one can easily check that at @xmath362 and for @xmath368 @xmath369 indeed , it is at @xmath370 that for the first time we encounter closed loops connecting three spheres in a diagrammatic expansion of the partition function .",
    "so for @xmath368 we have @xmath371 which means the interpolating partition function is nearly flat at @xmath362 .",
    "this is also true for @xmath372 where all distances @xmath373 should be zero .    for @xmath370",
    "we have @xmath374 where @xmath375 is the interpolating partition function of three spheres : @xmath376,\\ ] ] here @xmath377 is the number of points at distance @xmath204 from a given point and @xmath378 is the number of points at distance @xmath379 from @xmath194 and distance @xmath380 from @xmath381 when @xmath382 .",
    "more precisely , we have @xmath383 and finally @xmath384 is the number of pairs @xmath385 that satisfy the following conditions : @xmath386 , @xmath387 , and @xmath388 given @xmath382 .",
    "this number can be written as @xmath389 in fig .",
    "[ f9 ] we have plotted the typical behavior of @xmath390 for some value of @xmath2 and @xmath10 . despite the fact that @xmath390 is decreasing with @xmath354 we find that the first nonzero term in the taylor expansion is positive , signaling the nonperturbative nature of @xmath390 with respect to @xmath354 .",
    "let us label the edges of an interaction graph by @xmath391 .",
    "define @xmath392 as the empty set and @xmath393 as the set of the first @xmath245 edges .",
    "now we introduce the following sequence of partition functions @xmath394 clearly , the original partition function is given by @xmath395 and + @xmath396 where the average is taken with respect to the uniform and independent distribution of @xmath397 and @xmath398 .",
    "suppose we add edge @xmath399 connecting nodes @xmath400 .",
    "then @xmath401 where @xmath402 is the probability of satisfying constraint @xmath403 when the interaction set is given by @xmath404 . and",
    "@xmath405 is the same probability when the interaction set is @xmath392 .",
    "moreover , @xmath406 when the interaction graph @xmath407 is a tree .",
    "we rewrite the final entropy as @xmath408    for hard spheres @xmath409 may have different signs depending on the interaction graph .",
    "for example , suppose the interaction graph is a chain of size @xmath410 and we add the interaction between the end points .",
    "the probability of finding the end points at distance @xmath254 can be obtained in a recursive way as @xmath411 using our expression for @xmath378 in eq .",
    "[ ql ] . in this case",
    ", having @xmath412 is enough to know if the bp entropy is an over- or underestimation .",
    "figure [ f10 ] displays this quantity for different values of @xmath410 .",
    "we observe that @xmath412 is always negative for small @xmath10 , but for large @xmath10 and small @xmath410 its sign alternates as expected for antiferromagnetic interactions .",
    "looking again at the bp entropy shows that in general the correction in eq .",
    "[ corrections ] is relevant only if divided by @xmath1 it is still exponential in dimension @xmath2 .",
    "the corrections are irrelevant for instance if @xmath413 s behave as independent random numbers with a symmetric distribution and @xmath414 .",
    "this is what we expect to happen in high dimensions .",
    "it is instructive here to compare the above hard sphere problem with a system of attractive interactions where the constraints @xmath31 are satisfied if @xmath415 .",
    "figure [ f11 ] displays @xmath412 in a chain of attractive interactions ; @xmath412 is positive for small @xmath410 but approaches an exponentially small negative value for large @xmath410 and @xmath10 . in this case",
    ", we expect to have asymptotically @xmath416 .",
    "this is similar to the griffiths inequalities @xcite for ferromagnetic systems",
    ". actually , using the fortuin - kasteleyn - ginibre ( fkg ) inequalities @xcite one can prove the above statement for soft attractive interactions , where @xmath417 and @xmath418 :      consider the following measure on configurations @xmath419 where @xmath3 , @xmath420 this measure satisfies the conditions of the fkg inequality ; @xmath421 is a partially ordered set and @xmath422 is convex , that is given two configurations @xmath423 and @xmath424 @xmath425 where @xmath426 and @xmath427 .",
    "these are bitwise max and min functions .",
    "one can use induction to show that @xmath428 which proves the convexity of @xmath422 for the soft attractive interactions .",
    "having these conditions the fkg inequality says that for decreasing ( increasing ) functions @xmath429 and @xmath430 @xmath431 where the averages are taken with respect to the measure @xmath422 .",
    "a function @xmath429 is decreasing if @xmath432 for any @xmath433 .",
    "the latter is a bit - wise inequality .",
    "now consider decreasing functions @xmath434 $ ] and @xmath435 $ ] where @xmath32 is the zero member of @xmath0 . according to the fkg inequality we have @xmath436 i[d(\\sigma_j,0)\\le l ]",
    "\\rangle \\ge \\langle i[d(\\sigma_i,0)\\le 0 ] \\rangle \\langle i[d(\\sigma_j,0)\\le",
    "l ] \\rangle,\\ ] ] which means @xmath437\\ge p_0[d(\\sigma_i,\\sigma_j)\\le l]$ ] for any @xmath438 and @xmath204 . in other words",
    ", it is more likely to find two spheres closer to each other compared to the uniform measure . as a result , for the soft attractive interactions bp provides a lower bound for the log - partition function .",
    "actually for the soft interactions @xmath439 the partition function reads @xmath440^n.\\ ] ] one can exactly solve the problem in the thermodynamic limit and compare the results with the bp predictions to confirm the above statement for the attractive interactions . in the case of repulsive interactions",
    "the bp and exact results asymptotically coincide ."
  ],
  "abstract_text": [
    "<S> in this paper we study the hard sphere packing problem in the hamming space by the cavity method . </S>",
    "<S> we show that both the replica symmetric and the replica symmetry breaking approximations give maximum rates of packing that are asymptotically the same as the lower bound of gilbert and varshamov . </S>",
    "<S> consistently with known numerical results , the replica symmetric equations also suggest a crystalline solution , where for even diameters the spheres are more likely to be found in one of the subspaces ( even or odd ) of the hamming space . </S>",
    "<S> these crystalline packings can be generated by a recursive algorithm which finds maximum packings in an ultra - metric space . </S>",
    "<S> finally , we design a message passing algorithm based on the cavity equations to find dense packings of hard spheres . </S>",
    "<S> known maximum packings are reproduced efficiently in non trivial ranges of dimensions and number of spheres . </S>"
  ]
}