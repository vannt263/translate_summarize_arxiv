{
  "article_text": [
    "in scientific computation of systems with large number of degrees of freedom , an efficient choice of basis functions becomes desirable in order to reduce the computational cost . in this paper , we focus on the choice of efficient basis sets for the kohn - sham density functional theory ( ksdft )  @xcite , which is the most widely used electronic structure theory for condensed matter systems .",
    "the methods and concepts illustrated here are also useful for other applications .    in ksdft ,",
    "the quantities of interest are the electron energy @xmath0 and the atomic force @xmath1 . here",
    "we denote by @xmath2 the atomic positions , where @xmath3 is the number of atoms .",
    "the atomic force is expressed in terms of the derivatives of the electron energy with respect to the atomic positions as @xmath4 .",
    "this is an important quantity in many applications including structure optimization and first principle molecular dynamics .",
    "the electron energy is a functional of a set of kohn - sham orbitals @xmath5 where @xmath6 is the number of electrons in the system .",
    "to illustrate the idea with minimal technicality , let us consider for the moment a system of non - interacting electrons at zero temperature .",
    "the energy functional for non - interacting electrons takes the form @xmath7 the first term and the second term in   are the kinetic energy and the potential energy of the system , respectively .",
    "the energy @xmath0 as a function of atomic positions is given by the following minimization problem @xmath8 we denote by @xmath9 the minimizer .",
    "it can be readily shown that @xmath9 are the lowest @xmath6 eigenfunctions of the hamiltonian operator @xmath10 , which takes the form @xmath11 using the hamiltonian operator , the electron energy has an alternative expression without the explicit dependence on the orbitals @xmath5 : @xmath12 \\equiv \\operatorname{tr}[g_0(h(r ) ) ] ,    \\label{eqn : ematrix}\\ ] ] where @xmath13 is the heaviside function : @xmath14 if @xmath15 and is @xmath16 otherwise . here",
    "@xmath17 is the chemical potential , which takes value between the @xmath6-th and @xmath18-th eigenvalues of @xmath19 to control the number of electrons . since all the quantities depend on the atomic positions @xmath20 , to simplify the notation we drop the dependence of @xmath20 unless otherwise specified .",
    "if we approximate the eigenfunctions @xmath21 by linear combination of a set of basis functions @xmath22 , the hamiltonian operator @xmath19 is discretized into a finite dimensional matrix @xmath23 ( here and in the following , we will use the linear algebra notation : @xmath24 ) .",
    "the number of basis functions @xmath25 is therefore called the _ discretization cost_. the electron energy and the force can be expressed in terms of the discretized hamiltonian operator as @xmath26,\\\\    f_{\\phi , i } & = -\\frac{\\partial e_{\\phi}}{\\partial    r_i } \\\\    & = - \\operatorname{tr}\\left [ g_0'(\\phi^{{\\mathrm{t } } } h \\phi ) \\phi^{{\\mathrm{t}}}\\frac{\\partial    h}{\\partial r_i } \\phi    \\right ] - 2 \\operatorname{tr}\\left [ g_0'(\\phi^{{\\mathrm{t } } } h \\phi )     \\phi^{{\\mathrm{t } } } h \\frac{\\partial \\phi}{\\partial r_i } \\right ] .",
    "\\end{split}\\ ] ] @xmath27 is the @xmath28-th component of the force . in",
    "what follows the second equation in is also written in a compact form as @xmath29 - 2 \\operatorname{tr}\\left [ g_0'(\\phi^{{\\mathrm{t } } } h \\phi )     \\phi^{{\\mathrm{t } } } h \\frac{\\partial \\phi}{\\partial r } \\right ] .",
    "\\end{split }    \\label{}\\ ] ]    choosing basis functions @xmath30 adaptively with respect to the atomic positions @xmath20 has obvious computational advantages , as it allows the possibility to reduce the discretization cost by a significant amount while maintaining the accuracy for the evaluation of the electron energy and atomic forces .",
    "since the electron energy is defined variationally as in  , an accurate basis set should minimize the electron energy .",
    "however , choosing the basis functions adaptively gives arise to some difficulties in the evaluation of the force   which requires the calculation of @xmath31 .",
    "in electronic structure theory , the contribution from @xmath31 is referred to as the pulay force  @xcite .",
    "we will henceforth adopt this terminology .",
    "the pulay force originates from the incompleteness of the basis set , and has been found to be important to obtain the force with reliable accuracy for structure optimization or first principle molecular dynamics  @xcite .",
    "the calculation of the pulay force can be quite expensive even if the basis functions @xmath30 have analytical expressions , and the calculation of the pulay force becomes almost intractable if the basis functions are defined implicitly such as in the adaptive mesh method  @xcite .",
    "we would like to systematically reduce the pulay force so that the approximation @xmath32\\ ] ] becomes adequate .",
    "the key observation in this paper is that minimizing the electron energy and reducing the pulay force can be simultaneously achieved by the following optimization procedure @xmath33    \\label{eqn : mine}\\ ] ] here @xmath34 is an admissible subset of the space spanned by a set of _ primitive basis functions _ which are independent of @xmath20 .",
    "later @xmath34 will be referred to as the _ admissible set_. we select from @xmath34 a small number of @xmath20-dependent _ optimized basis functions _",
    "@xmath22 which give rise to the lowest electron energy in @xmath34",
    ". the euler - lagrange equation for the minimization problem   reads @xmath35 where the matrix @xmath36 is a lagrangian multiplier and is symmetric .",
    "when the first optimality condition is satisfied , we find @xmath37 =     2\\operatorname{tr}\\left [ \\lambda \\phi^{{\\mathrm{t } } } \\frac{\\partial \\phi}{\\partial r}\\right ]    = \\operatorname{tr}\\left[\\lambda \\frac{\\partial(\\phi^{{\\mathrm{t } } } \\phi)}{\\partial r }    \\right ] = 0.\\ ] ] the last equality comes from the orthonormal constraint on the optimized basis functions @xmath30 .",
    "the reason why   holds can be understood from the variational structure of the original problem  , which is related to the hellmann - feynman theorem in quantum mechanics . as a result",
    ", the pulay force vanishes in the atomic force even if the optimized basis functions are far from being a complete basis set .",
    "the choice of the primitive basis functions is crucial .",
    "although the optimized basis functions are always incomplete due to the small number of basis functions used , the primitive basis set should be systematically improvable towards a complete basis set .",
    "each primitive basis function should be local in order to be suitable for large scale parallel calculation . in our previous work",
    "@xcite , the primitive basis set is constructed using a discontinuous galerkin ( dg ) framework .",
    "the dg primitive basis set allows the usage of basis functions that are discontinuous across element surfaces .",
    "each dg primitive basis function is local in the real space , and thus gives full flexibility in the choice of the optimized basis functions . the locality constraint in the real space can therefore be naturally applied to the optimized basis functions , giving rise to the _ optimized local basis set_.    we remark that a large primitive basis set also presents practical difficulties for the optimization procedure . in this paper",
    "we propose a preconditioned newton - gmres method to obtain the optimized local basis functions .",
    "numerical results using a one dimensional model problem validate the performance of the optimized local basis functions : the electron energy and the force can be accurately calculated along the trajectory of the molecular dynamics without systematic drift , using a very small number of basis functions per atom .    improving the quality of the basis functions via variational",
    "optimization has been previously studied in the electronic structure theory .",
    "however , to the best of our knowledge all the optimized basis functions presented so far use atom - centered primitive basis functions , such as atomic orbitals or gaussian - type orbitals . since atomic orbitals or gaussian - type orbitals depend on the atomic positions and do not form a complete basis set , the pulay force never vanishes .",
    "the pulay force of all the primitive basis functions should be computed for each atomic configuration . moreover ,",
    "optimization for each atomic configuration is generally considered to be an expensive procedure , and the optimized basis functions are usually obtained for specific reference systems instead .",
    "for example , junquera _ et al _",
    "@xcite proposed to optimize the shape and cutoff radii of a set of numerical atomic orbitals ; ozaki  @xcite proposed using the optimal linear combination of a set of numerical atomic orbitals ; blum _ et al _",
    "@xcite used a greedy method to select basis functions from a large pool of numerical atomic orbitals .",
    "the drawback of this procedure is that the quality of the basis functions depends heavily on the choice of the reference system .",
    "the transferability of these basis sets obtained for specific reference systems should be tested carefully for a variety of systems .",
    "optimized basis functions without the choice of reference systems have also been studied before .",
    "talman  @xcite proposed to optimize a set of numerical atomic orbitals for all the atoms simultaneously .",
    "rayson and briddon  @xcite tried to find the optimal linear combination of gaussian - type orbitals , where the optimization process loops over each atom in the system .",
    "these methods share similar spirit as the present work , and can be regarded as approximate strategies towards achieving optimality in practice .",
    "our current work avoids the subtle issue of transferability by means of an optimization procedure for any given system , which could be advantageous for complex systems where manually constructed transferable basis functions are difficult to be obtained .",
    "the dg primitive basis set is a complete basis set , and the optimized local basis functions are local by construction .",
    "the dg primitive basis set is independent of the atomic positions , and the pulay force vanishes when the optimality condition is reached .",
    "the rest of the paper is organized as follows . in section  [ sec : opt ] , we introduce the optimized local basis set for ksdft .",
    "numerical examples are presented in section  [ sec : numer ] , followed by discussion and conclusion in section  [ sec : conclusion ] . to make the paper self - contained , we briefly recall the finite temperature kohn - sham density functional theory in [ sec : dg ] .",
    "as introduced in our previous work @xcite , using a discontinuous galerkin method ( the interior penalty method @xcite ) , the effective energy functional in kohn - sham density functional theory is given by @xmath38    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } }      + { \\left\\langle v_{{\\mathrm{eff } } } , \\rho \\right\\rangle}_{{\\mathcal{t } } } \\\\      & + \\alpha \\sum_{i } f_i { \\left\\langle{\\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big ] } ,        { \\big[\\hspace{-0.7 mm } \\big [ \\psi_i \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } } + \\sum_{\\ell } \\gamma_{\\ell } \\sum_{i } f_i      { \\left\\lvert{\\left\\langleb_{\\ell } , \\psi_i\\right\\rangle}_{{\\mathcal{t}}}\\right\\rvert}^2 \\\\      & + \\beta^{-1 } \\sum_i \\bigl ( f_i \\ln f_i + ( 1-f_i ) \\ln ( 1 - f_i )      \\bigr ) .",
    "\\end{aligned}\\ ] ] this is a discretization method for the helmholtz free energy for a system at temperature @xmath39 , see [ sec : dg ] for details of formulation of kohn - sham density functional theory in finite temperature . here",
    "@xmath40 is a collection of quasi - uniform rectangular partitions of the computational domain : @xmath41 and @xmath42 be the collection of surfaces that correspond to @xmath40 . @xmath43 and @xmath44 are inner products in the bulk and on the surface respectively . the notations",
    "@xmath45 and @xmath46    \\hspace{-0.7 mm } \\big]}$ ] are used for the standard average and jump operators across surfaces in the interior penalty method .",
    "we refer to @xcite for more details .",
    "let @xmath30 be a chosen set of basis functions @xmath47 , where each @xmath48 is supported in @xmath49 and @xmath50 is the total number of basis functions in @xmath49 .",
    "the corresponding approximation space @xmath51 is given by @xmath52 the approximated kohn - sham orbitals are the solutions to the minimization problem @xmath53 where @xmath54 is chosen to be slightly larger than the number of electrons @xmath6 in the system in order to compensate for the finite temperature effect ( see [ sec : dg ] for more detailed explanation ) .",
    "we propose the optimized local basis functions which give rise to a specific choice of @xmath30 , in order to achieve accuracy for both the helmholtz free energy and the force while using a small number of basis functions . following the spirit of   introduced for the model problem in the introduction , the optimized local basis function set @xmath30 solves the following minimization problem @xmath55 where @xmath34 is the _",
    "admissible set_. to define the admissible set , we take for each element @xmath49 a set of basis functions @xmath56 .",
    "each @xmath57 is compactly supported in @xmath49 , and they satisfy the orthonormality condition @xmath58 for example , @xmath59 can be polynomials restricted to the set @xmath49 up to a certain order .",
    "other forms of primitive basis functions can be chosen as well , without changing the discussion that follows .",
    "the discretized hamiltonian in the dg formulation takes the form",
    "@xmath60    \\hspace{-0.7 mm } \\big ] } ,        { \\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla u_{k , j } \\big\\ }    \\hspace{-0.7 mm } \\big\\}}\\right\\rangle}_{{\\mathcal{s } } } \\\\      & -\\frac{1}{2}{\\left\\langle{\\big\\ { \\hspace{-0.7 mm } \\big\\ { \\nabla u_{k',j ' } \\big\\ }    \\hspace{-0.7 mm } \\big\\ } } ,        { \\big[\\hspace{-0.7 mm } \\big [ u_{k , j } \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } } + \\alpha      { \\left\\langle{\\big[\\hspace{-0.7 mm } \\big [ u_{k',j ' } \\big ]    \\hspace{-0.7 mm } \\big ] } ,        { \\big[\\hspace{-0.7 mm } \\big [ u_{k , j } \\big ]    \\hspace{-0.7 mm } \\big]}\\right\\rangle}_{{\\mathcal{s } } } \\\\      & + { \\left\\langleu_{k',j ' } , v_{{\\mathrm{eff } } } u_{k , j}\\right\\rangle}_{{\\mathcal{t } } } + \\sum_\\ell      \\gamma_{\\ell } { \\left\\langleu_{k',j'},b_\\ell\\right\\rangle}_{{\\mathcal{t } } } { \\left\\langleb_\\ell ,        u_{k , j}\\right\\rangle}_{{\\mathcal{t}}}.    \\end{aligned}\\ ] ]    the optimized local basis functions should be local in the real space in order to facilitate large scale computation . since @xmath59 are compactly supported in @xmath49 , the locality constraint on the optimized local basis functions is naturally imposed by requiring each function in the admissible set to be linear combinations of @xmath59 for the same @xmath61 , _ _",
    "@xmath62 where @xmath63 is the number of elements .    inside each element @xmath49",
    ", we select @xmath64 optimized local basis functions from the admissible set .",
    "@xmath64 is much smaller than @xmath50 .",
    "the optimized local basis functions are denoted by @xmath65 , and are represented by the linear combination of the primitive basis functions @xmath66 with slight abuse of notation , we use @xmath67 also for the column vector of the coefficients in the primitive basis functions : @xmath68 if we write @xmath69 the optimized local basis set @xmath30 represented in the primitive basis set takes the form @xmath70 because of the block diagonal structure , the orthonormality constraint @xmath71 is equivalent to the orthonormal constraint for each @xmath72 , _ _",
    "i.e. _ _  , @xmath73 . here",
    "each block @xmath74 is a rectangular matrix of size @xmath75 , where @xmath76 is the number of grid points in the element , and @xmath64 is the number of basis functions .",
    "@xmath77 is an @xmath78 identity matrix .    under the basis set @xmath30 ,",
    "the discretized hamiltonian becomes @xmath79 with @xmath19 given by .",
    "the helmholtz free energy can be written without the explicit dependence on @xmath80 and @xmath81 : @xmath82 where the function @xmath83 , which is a finite temperature version of @xmath84 , is defined as @xmath85 note that the derivative of @xmath83 is the fermi - dirac function @xmath86 hence , the minimization problem   becomes @xmath87,\\\\    & \\text{s.t . }",
    "\\quad \\phi_k^t\\phi_k = i_k,\\quad k=1,\\cdots , m .",
    "\\end{split}\\ ] ] the atomic force is then given by @xmath88 where @xmath89 is the single particle density matrix associated to the discretized hamiltonian @xmath23 .",
    "@xmath90 can be evaluated using standard diagonalization techniques by computing the eigenvalues and eigenvectors of the reduced hamiltonian @xmath91 .",
    "this is asymptotically the most time consuming step which scales as @xmath92 where @xmath6 is the number of electrons in the system . for the 1d system considered in this manuscript ,",
    "@xmath90 is solved by the matlab diagonalization subroutine _",
    "eig_. for systems of large size , the diagonalization routine can be replaced by the recently developed low order scaling selected inversion methods  @xcite to reduce the computational cost .",
    "the pulay force vanishes in the last equality when the first order optimality of the optimization problem is reached , following the same reasoning as in  .",
    "the euler - lagrange equation with respect to the minimization problem   reads @xmath93 where the @xmath36 is a block diagonal matrix @xmath94 which is the lagrange multiplier for the orthonormal constraints .",
    "due to the block diagonal structure of @xmath30 , we can write the first order optimality condition   as @xmath95 define the remainder for the @xmath96-th element as @xmath97 we solve @xmath98 for @xmath99 .",
    "in order to solve the nonlinear system  , we propose a preconditioned newton - gmres method as follows .",
    "denote by @xmath100 the jacobian matrix . at the @xmath101-th iteration",
    ", the newton step solves the following linear system for the correction term @xmath102 to make the optimization feasible in practice , we take the following approximation .",
    "we neglect the derivative of @xmath103 with respect to @xmath30 in the jacobian .",
    "the most important reason for this approximation is that the numerical evaluation of such derivative is quite expensive . in practice",
    "we find that the residue of the euler - lagrange equation decays fast in the first few newton iterations , and slows down when the residue becomes small , suggesting that the derivative of @xmath90 with respect to the basis functions can be important especially for the small residue case .",
    "numerical results indicate that the accuracy of the helmholtz free energy and the force can already be improved by one order of magnitude after a few newton iterations .",
    "further improvement that includes the approximate form of the derivative of @xmath90 will be considered in the future work . using this approximation ,",
    "the correction equation can be written explicitly as @xmath104 for @xmath99 .",
    "we solve the linear system   using a preconditioned gmres method .",
    "the gmres method  @xcite is a robust way for solving ill - conditioned linear equations .",
    "the preconditioner should give an approximate solution efficiently for the following equation @xmath105 for any right hand side @xmath106 . to this end",
    "we first neglect the interaction between different elements : @xmath107 the equations of @xmath108 for different elements become decoupled . can be therefore solved independently in each element .",
    "second , we note that there are degeneracy issues solving .",
    "this is because in the subspace spanned by the basis @xmath51 , only the low - lying eigenfunctions of the discrete hamiltonian affect the free energy much , while the eigenfunctions with large eigenvalues do not contribute much due to small occupation number .",
    "therefore , if we change the subspace @xmath51 in the direction of these high energy eigenfunctions , it does not change much the energy , which causes degeneracy .",
    "we propose the following pruning method to solve the degeneracy problem . instead of solving ,",
    "we restrict to the basis functions contributed to the low - lying eigenfunctions by the following procedure . given density matrix @xmath90 , for each element @xmath109",
    ", we take a singular value decomposition of the diagonal block of @xmath110 : @xmath111 with the singular values sorted in descending order . then according to magnitude of the singular values ,",
    "we write @xmath112 , where the singular vectors in @xmath113 correspond to high singular values above a certain threshold , and the ones in @xmath114 correspond to low singular values below the threshold .",
    "the basis functions in the element can be separated into two accordingly : @xmath115 we now only update the correction term corresponding to the high singular values by solving @xmath116 where @xmath117 the approximate solution of the preconditioning equation   is therefore given by @xmath118    as will be seen in the numerical examples in section  [ sec : numer ] , the preconditioned newton - gmres method is able to obtain the optimized local basis functions efficiently with a small number of iterations .",
    "the accuracy and efficiency of the optimized local basis functions is illustrated using a one - dimensional model problem as follows .",
    "the number of atoms in the one - dimensional model problem is denoted by @xmath3 , the positions of electrons by @xmath119 , and the positions of ions by @xmath120 .",
    "the electronic and ionic degrees of freedom are separated by the born - oppenheimer approximation .",
    "the effective kohn - sham hamiltonian of the electrons for a given atomic configuration @xmath20 is @xmath121 the effective electron - ion interaction and electron - electron interaction is modeled by the summation of a series of gaussian functions @xmath122 @xmath123 and @xmath124 characterize the height and the width of the potential well around each atom , respectively . for simplicity ,",
    "the effective hamiltonian does not depend on the electron density , and hence self - consistency iteration is not involved .",
    "the self - consistent iteration will be added in the future work .",
    "the ion - ion interaction is modeled by a harmonic potential with periodized nearest - neighbor interaction @xmath125 with @xmath126 being the length of the computational domain .",
    "the force on atom @xmath28 is @xmath127 the finite temperature ksdft is used here and the helmholtz free energy for the electrons @xmath128 is given by .",
    "the finite temperature effect is usually negligible in insulating systems with large band gap , but becomes important for the stability in metallic systems with small or vanishing band gap .",
    "the accuracy is measured in terms of the error of the helmholtz free energy per atom and the error of the force . for a given atomic configuration ,",
    "the helmholtz free energy per atom and the force are calculated independently using the optimized local basis functions and the benchmark plane wave basis functions . except for the unit of temperature which is kelvin ,",
    "atomic units are used throughout this section unless otherwise specified . in particular , the unit of energy is hartree , the unit of force is hartree / bohr , and the electron mass @xmath129 , electron charge @xmath130 and the planck constant @xmath131 are set to be unity .",
    "the detailed choices of the parameters in the simulation are as follows . except in the last example where we test for different system sizes ,",
    "the number of atom is taken to be @xmath132 .",
    "the average distance between adjacent atoms is @xmath133 au , and the size of each element is also set to be @xmath133 au .",
    "the initial guess of the optimized local basis functions uses the adaptive local basis functions proposed in our previous work  @xcite .",
    "the adaptive local basis functions use a small buffer region outside each element .",
    "the buffer size is @xmath134 au in the present calculation .",
    "we compare the electron energy and the forces produced by the optimized local basis functions with those obtained from a planewave calculation with kinetic energy cutoff at @xmath135 ry , or @xmath136 planewaves per atom .",
    "the change of the helmholtz free energy and the force is less than @xmath137 au if the kinetic energy cutoff for the planewave calculation is further increased .",
    "@xmath138 legendre - gauss - lobatto ( lgl ) grid points per element are used to discretize the optimized local basis functions as well as the adaptive local basis functions .",
    "the change of the helmholtz free energy and the force is less than @xmath137 au if the number of lgl integration points is further increased .",
    "therefore the numerical integration error is negligible , and the error in the calculated helmholtz free energy and the force faithfully represents the error due to the usage of adaptive local basis functions or optimized local basis functions .",
    "the electron temperature is @xmath139 k. the penalty parameter @xmath140 in the dg hamiltonian is @xmath141 .",
    "the choice of parameters for the potential energy surface is @xmath142 .",
    "if one electron is assigned to each atom ( spin degeneracy is neglected ) , then the band gap at the equidistant configuration is around @xmath143 k , which is much larger than the electron temperature ( @xmath139 k ) . in what follows this system",
    "is referred to as the insulating system . if four electrons are assigned to each atom , the band gap is is essentially zero ( @xmath144 k ) .",
    "the energy levels around the fermi surface are fractionally occupied due to the thermal effect .",
    "this system is referred to as the metallic system .    in the optimization of the local basis functions ,",
    "the maximum number of newton iterations is set to be @xmath145 , and the maximum number of iterations for the preconditioned gmres solver for the newton s equation is set to be @xmath146 .",
    "we find that the error for solving the linear system   using @xmath146 preconditioned gmres iterations is less than @xmath147 .",
    "the threshold value for the significant part of the basis functions is set to be @xmath148 to avoid degeneracy .",
    "the preconditioning step is solved by direct @xmath149 decomposition method inside each element .",
    "we first illustrate the performance of the optimized local basis set in the static case . @xmath136",
    "atomic configurations are generated from equidistant configuration with small random perturbations .",
    "the accuracy of using the optimized local basis set is measured by the mean absolute value of the error ( mean error ) of the helmholtz free energy per atom and the mean error of the force of a fixed atom . besides the optimized local basis functions , the error of using the adaptive local basis functions  @xcite is presented as well to illustrate the effectiveness of the optimization procedure .    for the insulating system , the relative error of the force",
    "is already @xmath150 with as small as @xmath145 basis functions per atom using the optimized local basis functions ( table  [ tab : ins1 ] ) .",
    "when compared to the adaptive local basis functions with the same number of basis functions per atom , the error of the helmholtz free energy per atom is reduced by @xmath151 times , and the error of the force is reduced by @xmath152 times after the optimization procedure .",
    "it is illuminating to see the difference between the adaptive local basis functions and the optimized local basis functions .",
    "since any unitary transformation of the basis functions in each element does not change the total energy of the system , the basis functions should first be rotated according a certain criterion .",
    "here we rotate the basis functions in an element according to the ritz values of the hamiltonian in the same element .",
    "take the first element for example , the hamiltonian operator is denoted by @xmath153 , and the basis functions in the first element is denoted by @xmath154 .",
    "we solve the following eigenvalue problem @xmath155 where @xmath156 is a diagonal matrix with values sorted in ascending order .",
    "then we compare the rotated basis functions @xmath157    \\label{}\\ ] ] for adaptive and optimized local basis functions in fig .",
    "[ fig : phiplot ] .",
    "it is found that the optimized local basis functions are very close to the adaptive local basis functions , indicating that the adaptive local basis functions is already very accurate in computing the total energy of the system .",
    "the agreement between the adaptive local basis functions and the optimized local basis functions is very well for basis functions of low energy ( fig .",
    "[ fig : phiplot ] ( a ) ) , and the difference enlarges for basis functions or higher energy .",
    "this can be understood as that the adaptive local basis functions include contributions from unoccupied states with relatively high energy level , while the optimized local basis functions reduce the contribution from such unoccupied states by the optimization procedure .",
    "similar results are found for metallic systems ( table  [ tab : met1 ] ) .",
    "more basis functions are needed in this case since there are more electrons in the metallic system than those in the insulating system studied here .",
    "the relative error of the force is @xmath158 with @xmath159 basis functions per atom using the optimized local basis functions .",
    "when compared to the adaptive local basis functions using the same number of basis functions , the error of the helmholtz free energy per atom is reduced by @xmath133 times and the error of the force is reduced by @xmath160 times using the optimized local basis functions .",
    "the optimized local basis functions therefore greatly improve the accuracy with the same number of basis functions .",
    ".mean error of the helmholtz free energy per atom , the absolute error of the force of the first atom , and the relative error of the force of the first atom .",
    "this system is an insulating system with @xmath161 electron per atom ( spin neglected ) .",
    "@xmath145 basis functions per atom are used for both the adaptive local basis functions and the optimized local basis functions . [ cols=\"^,^,^,^\",options=\"header \" , ]     finally , we compare the performance of the adaptive local basis functions and the optimized local basis functions for systems of increasing size with @xmath162 atoms , respectively .",
    "the system is randomly perturbed by @xmath163 au from the crystalline configuration , with a defect introduced at one atom of the potential .",
    "the computational time for constructing the adaptive local basis functions ( red dashed line with star ) and for constructing the optimized local basis functions ( blue solid line with triangle ) are compared in fig .  [",
    "fig : large ] ( a ) plotted in logarithmic scale .",
    "@xmath134 newton steps and @xmath146 gmres iterations are used for the outer iteration and the inner iteration respectively in the optimization procedure .",
    "since the optimized local basis functions use the adaptive local basis functions as an initial guess , the computational time for the optimized local basis functions also includes that for the adaptive local basis functions .",
    "the computational time for constructing both the adaptive local basis functions and the optimized local basis functions are linear thanks to the locality of the basis functions .",
    "the construction of the optimized local basis functions is @xmath164 times more expensive than the construction of the adaptive local basis functions , indicating that the optimization procedure should be further improved in order to generate a practically efficient optimized local basis set .",
    "the error of the helmholtz free energy per atom and the error of the force on the first atom are shown in fig .",
    "[ fig : large ] ( b ) and ( c ) , respectively . it is found that the helmholtz free energy obtained by the optimized local basis functions is stably @xmath165 times more accurate than that obtained by the adaptive local basis functions .",
    "the ratio of improvement of the force has a much larger dependence on the realization of the atomic configuration which ranges from @xmath166 times , with the average ratio of improvement being around one order of magnitude .",
    "the optimized local basis set is able to accurately compute the electron energy and the force using a small number of basis functions .",
    "now we show that the optimized local basis functions can also be used in molecular dynamics .",
    "we illustrate the performance of the optimized local basis functions for molecular dynamics using the same metallic system as in section  [ subsec : static ] with @xmath145 electrons and @xmath159 basis functions per atom .    in the born - oppenheimer approximation , the equations of motion for atom @xmath28 are given by @xmath167 the mass of the ions @xmath168",
    "is set to be @xmath169 which is close the mass of sodium in the atomic unit .",
    "@xmath170 is the hellman - feynman force in   for atom @xmath28 .",
    "the equations of motion conserve the total energy given by @xmath171 the numerical conservation of the total energy is quantified by the drift of @xmath172 , which is defined as the relative difference of @xmath172 along the trajectory , _ _",
    "i.e. _ _   @xmath173    velocity - verlet scheme  @xcite is used to propagate the equations of motion for the atoms with the time step @xmath174 femtoseconds ( fs ) .",
    "the simulation length is @xmath175 steps and the total length of the simulation is @xmath176 picoseconds ( ps ) . to ensure the time - reversibility of the numerical scheme , the optimized local basis functions use the adaptive local basis functions as the initial guess at every time step .",
    "however , this is not a necessary requirement and can be improved by other time - reversible schemes such as the extended lagrangian born - oppenheimer method  @xcite .",
    "the initial configurations of the atoms are perturbed by @xmath163 au away from the equilibrium equidistant configuration , and the initial kinetic energy of the atoms is @xmath177 k with the mean velocity of all atoms ( _ _ i.e. _ _  the velocity of the centroid ) being zero .",
    "the error of the force and the error of the helmholtz free energy per atom are well within @xmath178 and @xmath179 , respectively ( see fig .  [",
    "fig : dynmet ] ( a ) and ( b ) ) , which is consistent with the behavior of errors in the static calculation .",
    "the helmholtz free energy obtained from the optimized local basis functions is systematically higher than that in the benchmark planewave simulation .",
    "the sources of the systematic shift are the penalty parameter @xmath140 in the dg formulation , and that the minimization procedure is restricted to an admissible set of the space spanned by the primitive functions . nonetheless , the mean deviation of the force is unbiased , indicating that the structure of the trajectory obtained using the optimized local basis functions is well preserved .",
    "the drift of the conserved quantity   is also well controlled within @xmath180 ( fig .",
    "[ fig : dynmet ] ( c ) ) .",
    "the system is metallic with @xmath145 electrons and @xmath159 basis functions per atom .",
    "the mean deviation of the force is unbiased .",
    ", title=\"fig:\",scaledwidth=32.0%,scaledwidth=32.0% ]   ps .",
    "the system is metallic with @xmath145 electrons and @xmath159 basis functions per atom .",
    "the mean deviation of the force is unbiased .",
    ", title=\"fig:\",scaledwidth=32.0%,scaledwidth=32.0% ]   ps .",
    "the system is metallic with @xmath145 electrons and @xmath159 basis functions per atom .",
    "the mean deviation of the force is unbiased .",
    ", title=\"fig:\",scaledwidth=32.0%,scaledwidth=32.0% ]",
    "we have developed the optimized local basis set to solve models in the kohn - sham density functional theory for both insulating and metallic systems .",
    "the optimized local basis functions form an accurate basis set for computing the electron energy as well as the atomic force with a small number of basis functions per atom .",
    "when the optimality condition is achieved , the optimized local basis functions give the lowest energy among all the basis functions in an admissible set determined by the primitive basis functions .",
    "the force is accurately described by the hellmann - feynman force , and the contribution of the derivative of the basis functions ( _ _ i.e. _ _  the pulay force ) vanishes automatically .",
    "the concept of the optimized local basis functions is quite general , and the methods developed in this paper are useful for other problems such as selecting basis functions and evaluating parameter - dependent functions as well .    to obtain the optimized local basis functions in practice , we proposed a preconditioned newton - gmres method .",
    "the resulting optimized local basis functions are tested using a one - dimensional model problem .",
    "we find that the optimized local basis functions accurately compute the helmholtz free energy and the force using a very small number of basis functions per atom for both insulating and metallic systems .",
    "when applied to the molecular dynamics simulation , the optimized local basis functions do not exhibit any systematic drift in terms of the force or the total energy for the ionic degrees of freedom .",
    "therefore the optimized local basis functions are able to give the correct statistical and dynamical properties along the molecular dynamics trajectory , and can be used for long time molecular dynamics simulation .",
    "the optimized local basis set provides an implementable criterion to eliminate the artificial effect in the force due to the change of the basis functions and to maintain a small set of basis functions , which makes the optimized local basis set an ideal tool in the molecular dynamics simulation .",
    "however , the construction of the optimized local basis functions is found to be already more expensive than other choices such as adaptive local basis functions , indicating that the optimization procedure should be further improved especially when applied to kohn - sham density functional theory in 3d .",
    "the more efficient scheme may be achieved by including a feasible approximation of the derivative of the density matrix with respect to the basis function , a more efficient preconditioner for the gmres iteration , or even a more efficient gradient method instead of a newton - type method .",
    "these will be our future work .",
    "* acknowledgment : *    w.  e and l.  l. are partially supported by doe under contract no .",
    "de - fg02 - 03er25587 and by nsf under contract no .",
    "l.  y. is partially supported by an alfred p. sloan research fellowship and an nsf career award dms-0846501 .",
    "the authors thank the hospitality of shanghai jiao tong university where part of the work was done .",
    "in this appendix , we briefly described the basic formulation of the kohn - sham density functional theory @xcite and its finite temperature generalization . in the kohn - sham density functional theory ,",
    "the ground state electron energy is written as @xmath181 { \\,\\mathrm{d}}x,\\end{gathered}\\ ] ] where the kohn - sham orbitals are the solutions to the minimization problem @xmath182 with slight abuse of the notation , we denote by @xmath80 both the arguments in the minimization problem  , and the solutions to the minimization problem , _",
    "_ i.e. _ _  the kohn - sham orbitals .",
    "the electron density is @xmath183 .",
    "we have neglected the spin degeneracy .",
    "the first term of   is the kinetic energy .",
    "the second and third terms come from pseudo - potential , which we have taken the kleinman - bylander form  @xcite .",
    "the pseudopotential is given by @xmath184 for each @xmath185 , @xmath186 is a function supported locally in the real space around the position of one of the atoms , @xmath187 or @xmath188 , and we have used the dirac bra - ket notation .",
    "the fourth term is the coulomb interaction between electrons , and the fifth term is the exchange - correlation functional , for which the local density approximation ( lda )  @xcite is adopted .",
    "the proposed method can also be used for more complicated exchange - correlation functionals such as the generalized gradient approximation ( gga ) functionals  @xcite .",
    "the ground state electron energy defined in   is applicable to insulating systems with large band gap , but is difficult to evaluate for zero - gap metallic systems . for metallic system ,",
    "finite temperature ksdft becomes the standard tool  @xcite , in which the helmholtz free energy is considered instead .",
    "for given finite temperature @xmath189 , the helmholtz free energy is given by @xmath190 { \\,\\mathrm{d}}x + \\beta^{-1 } \\sum_i \\bigl ( f_i \\ln f_i + ( 1    - f_i ) \\ln(1 - f_i ) \\bigr).\\end{gathered}\\ ] ] correspondingly @xmath80 and @xmath81 are the solutions to the minimization problem @xmath191 here @xmath192 is the inverse temperature @xmath193 . the number of eigenstates @xmath54 is chosen to be slightly larger than the number of electrons @xmath6 in order to compensate for the finite temperature effect , following the criterion that the occupation number @xmath194 is sufficiently small ( less than @xmath195 . @xmath196 $ ] are the occupation numbers which add up to the total number of electrons @xmath197 , and the electron density @xmath198 . compared to  ,",
    "the only extra term is the last term , which characterizes the entropic contribution .    the kohn - sham equation , or the euler - lagrange equation associated with reads @xmath199 \\psi_i = \\bigl ( - \\tfrac{1}{2 } \\delta + v_{{\\mathrm{eff}}}[\\rho ]    + \\sum_{\\ell } \\gamma_{\\ell } { \\lvertb_{\\ell}\\rangle } { \\langleb_{\\ell}\\rvert } \\bigr ) \\psi_i     = \\lambda_i \\psi_i,\\ ] ] where the effective one - body potential @xmath200 is given by @xmath201(x ) = v_{{\\mathrm{ext}}}(x ) + \\int \\frac{\\rho(y)}{{\\left\\lvertx - y\\right\\rvert}}{\\,\\mathrm{d}}y    + { \\epsilon_{\\mathrm{xc}}}'[\\rho(x)].\\ ] ] the occupation numbers are given by @xmath202 which is the fermi - dirac distribution evaluated at @xmath203 .",
    "here @xmath204 is the chemical potential , which is chosen so that @xmath205 satisfies @xmath206 note that is a nonlinear eigenvalue problem , as @xmath200 depends on @xmath207 , which is in turn determined by @xmath208 .",
    "the electron density is self - consistent if both   and   are satisfied . after obtaining the self - consistent electron density ,",
    "the helmholtz free energy can be expressed as @xmath209 { \\,\\mathrm{d}}x - \\int { \\epsilon_{\\mathrm{xc}}}'[\\rho(x ) ] \\rho(x ) { \\,\\mathrm{d}}x.\\end{gathered}\\ ] ] the goal of finite temperature kohn - sham density functional theory is to calculate the free energy @xmath210 , the self - consistent electron density @xmath207 and also the chemical potential @xmath204 given the number of electrons , the temperature and the atomic configuration .",
    "the helmholtz free energy @xmath211 plays the role of the electron energy @xmath0 in section  [ sec : intro ] , and the force is defined as the negative gradient of the helmholtz free energy @xmath212 .",
    "the helmholtz free energy is applicable to both the insulating and the metallic systems . as @xmath213",
    ", the helmholtz free energy @xmath210 reduces to the ground state electron energy @xmath214 .",
    "therefore   is also called the zero temperature ksdft .",
    "as @xmath205 is given by the fermi - dirac distribution , we have @xmath215 using these , we can rewrite as ( see _ e.g. _ @xcite ) @xmath216 ) ) ) + \\mu n   \\\\    - \\frac12 \\iint \\frac{\\rho(x ) \\rho(y)}{{\\left\\lvertx - y\\right\\rvert } } { \\,\\mathrm{d}}x { \\,\\mathrm{d}}y +    \\int{\\epsilon_{\\mathrm{xc}}}[\\rho(x ) ] { \\,\\mathrm{d}}x - \\int { \\epsilon_{\\mathrm{xc}}}'[\\rho(x ) ] \\rho(x ) { \\,\\mathrm{d}}x.\\end{gathered}\\ ] ] one can verify by straightforward calculations that @xmath217 if @xmath207 and @xmath204 are the self - consistent solution of the kohn - sham equation  . taking derivative of with respect to @xmath204",
    ", we have @xmath218 therefore , the atomic force takes the form @xmath219 .",
    "\\end{aligned}\\ ] ] this is known as the hellman - feynman theorem at finite temperature .",
    "the kohn - sham density functional theory is usually solved by using the self - consistent iteration , where at each iteration , the electron density @xmath220 is obtained from effective hamiltonian @xmath221 .",
    "given an effective potential @xmath200 , and hence the effective hamiltonian @xmath222 we find @xmath220 from @xmath223 where @xmath208 s are eigenfunctions of @xmath221 , and the definition of @xmath81 follows   and .",
    "note that the @xmath208 and @xmath81 s minimize the variational problem @xmath224 with the orthonormality constraints @xmath225 ."
  ],
  "abstract_text": [
    "<S> we develop a technique for generating a set of optimized local basis functions to solve models in the kohn - sham density functional theory for both insulating and metallic systems . </S>",
    "<S> the optimized local basis functions are obtained by solving a minimization problem in an admissible set determined by a large number of primitive basis functions . using the optimized local basis set </S>",
    "<S> , the electron energy and the atomic force can be calculated accurately with a small number of basis functions . the pulay force is systematically controlled and is not required to be calculated , which makes the optimized local basis set an ideal tool for ab initio molecular dynamics and structure optimization . </S>",
    "<S> we also propose a preconditioned newton - gmres method to obtain the optimized local basis functions in practice . </S>",
    "<S> the optimized local basis set is able to achieve high accuracy with a small number of basis functions per atom when applied to a one dimensional model problem </S>",
    "<S> .    electronic structure , kohn - sham density functional theory , optimized local basis set , discontinuous galerkin , trace minimization , molecular dynamics , pulay force , gmres , preconditioning    71.15.ap , 31.15.e- , 02.70.dh    65f15 , 65z05 </S>"
  ]
}