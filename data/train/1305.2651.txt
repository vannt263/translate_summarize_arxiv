{
  "article_text": [
    "this paper focuses on a two - layer inner loop / outer loop hierarchical control structure where the ultimate objective is to stabilize the overall system .",
    "the actuator and plant represent a cascade , depicted in fig .",
    "[ hierarchical_ol ] , wherein an actuator output , denoted by @xmath0 , characterizes an overall force , moment , or generalized effect produced by the actuators , and is referred to as a _ virtual control input_. in the hierarchical control strategy , an outer loop controller sets a desired value for this virtual control input , denoted by @xmath1 , and it is the responsibility of the inner loop to generate control inputs @xmath2 that drive @xmath0 close to @xmath1 .",
    "this control approach is employed in a number of automotive , aerospace , and marine applications , such as @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "hierarchical control has become commonplace in industrial applications , as it offers two key advantages over its centralized counterpart :    1 .",
    "plug - and - play integration of new design features ( for example , a new inner loop ) without requiring a complete system redesign ; 2 .",
    "reduction in overall computational complexity , in terms of the number of inputs and/or states considered by each controller .",
    "the use of mpc for constrained hierarchical control has been a natural choice in instances when constraint satisfaction was critical and/or multiple control objectives were traded off . only recently , however , has an effort been made to provide theoretical stability guarantees for the hierarchical system .",
    "in many recent papers , including @xcite , @xcite , @xcite , @xcite , and @xcite , the inner loop is updated at a faster rate than the outer loop , and the inner loop is designed to reach a steady - state , wherein @xmath3 , within a single outer loop time step .",
    "this strategy represents an effective way of guaranteeing stability under large time - scale separation , but numerous systems , including those described in @xcite , @xcite , and @xcite ( which address a flight control application ) , and @xcite , @xcite , and @xcite ( which address a thermal management system ) , do not exhibit such a demonstrable time scale separation .",
    "our approach differs from that of @xcite , @xcite , and @xcite in that it drives the inner loop states to those of a _ reference model _ rather than to the steady state values corresponding to @xmath1 .",
    "our stability formulation relies on @xmath4-contractive terminal constraint sets for the outer and inner loop , in addition to rate - like constraints that ensure that the optimized mpc trajectories do not vary too much from one instant to the next .",
    "the contractive nature of the terminal constraint allows mpc - optimized control input trajectories to vary from one time step and the next .",
    "the work presented in this paper is an extension of an original ifac conference paper ( @xcite ) and builds upon it through two key mechanisms :    * allowance for inexact ( approximate ) inner loop reference model matching ; * greater flexibility in the decay of contraction rates within the mpc optimization .",
    "in this paper , we consider two interconnected systems , as depicted in fig . [ hierarchical_basic ] , whose dynamics in discrete time",
    "are given by : @xmath5 where @xmath6 represents the virtual control input , @xmath7 represents the plant states , which are driven by the virtual control input , @xmath0 , whereas @xmath8 represents the actuator states , which are driven by the real control inputs , @xmath9 , where @xmath10 .",
    "the control inputs , @xmath2 are subject to a saturation constraint set @xmath11 , such that @xmath12 at every time instant .",
    "we assume that :    * _ assumption 1 : _ the pair @xmath13 is stabilizable . * _ assumption 2 : _ the pair @xmath14 is controllable . * _ assumption 3 : _ without loss of generality , the actuator dynamics of ( [ ssr_d ] ) are written in block controllable canonical form ( ccf ) described in @xcite .    the assumption of stabilizability is clearly essential to any problem",
    "whose objective is stabilization of the origin .",
    "the stronger assumption of inner loop controllability ( assumption 2 ) allows us to generate an inner loop error system and control law that appropriately places all of the poles of the closed inner loop to satisfy the reference model specifications .",
    "our approach relies on the design of an inner loop _ reference model _ , which describes the ideal input - output behavior from @xmath1 to @xmath0 .",
    "we will proceed to derive an error system describing the difference between the inner loop and reference model states , and we will show how closed - form control laws can be used to achieve exact or sufficiently accurate reference model matching near the origin of this system , ultimately resulting in local stability of the overall system .",
    "mpc is used to enlarge the region of attraction of the overall system to include states under which the closed - form control laws hit saturation constraints .",
    "the specific control algorithm incorporates both outer and inner loop terminal constraint sets , wherein closed - form control laws are used to achieve reference model matching ( or approximate matching ) behavior .",
    "farther from the origins of the outer and inner loops , mpc is used to drive the system into these constraint sets , explicitly accounting for saturation constraints .",
    "this reference model is given by : @xmath15 where @xmath16 , @xmath17 , and @xmath18 .",
    "we assume that :    * _ assumption 4 : _ the reference model is stable , i.e. , @xmath19 ( @xmath20 represents the @xmath21 eigenvalue of @xmath22 ) ; * _ assumption 5 : _ the reference model does not share any zeros with unstable poles of @xmath23 .    because assumptions 4 and 5 are on the reference model , which is freely chosen by the control system designer",
    ", they do not restrict the applicability of the proposed control design .",
    "we use the reference model to analyze the closed - loop behavior of the inner loop through the following error system : @xmath24 where @xmath25 and it follows that @xmath26 . for notational convenience throughout the paper , because the reference model is embedded in the outer loop , we will introduce the augmented outer loop state , @xmath27^{t}$ ] , which results in augmented outer loop dynamics given by : @xmath28 where : @xmath29 , \\\\ \\nonumber b_{1}^{aug } & = & \\left[\\begin{array}{cc } b_{1}^{t } & 0 \\end{array}\\right]^{t } , \\\\ \\nonumber b_{f}^{aug } & = & \\left[\\begin{array}{cc } 0 & b_{f}^{t } \\end{array}\\right]^{t}.\\end{aligned}\\ ] ]      an mpc optimization is carried out whenever the outer _ or _ inner loop states are outside of predetermined @xmath4-contractive terminal constraint sets @xmath30 and @xmath31 respectively .",
    "a closed - form terminal control law is active once the inner _ and _ outer loop states have reached the terminal sets .",
    "the block diagram of the closed - loop system when mpc is active is given in fig . [ hierarchical_mpc ] , whereas the closed - loop system under closed - form terminal control laws conforms to the block diagram of fig .",
    "[ hierarchical_basic ] .    whenever the mpc optimization is carried out ,",
    "an optimal control trajectory is computed for an @xmath32 step prediction horizon , along with a corresponding state trajectory .",
    "the outer loop virtual control and state trajectories are given by : @xmath33 , \\\\",
    "\\mathbf{x_{1}^{aug}}(k ) & = & \\left[\\begin{array}{ccc}\\mathbf{x_{1}^{aug}}(k|k ) & \\ldots & \\mathbf{x_{1}^{aug}}(k+n|k ) \\end{array } \\right].\\end{aligned}\\ ] ] the inner loop control and state trajectories are given by : @xmath34 , \\\\",
    "\\mathbf{\\tilde{x}}(k ) & = & \\left[\\begin{array}{ccc}\\mathbf{\\tilde{x}}(k|k ) & \\ldots & \\mathbf{\\tilde{x}}(k+n|k ) \\end{array } \\right].\\end{aligned}\\ ] ] the notation @xmath35 denotes the chosen / predicted value of a variable at step @xmath36 when the optimization is carried out at time @xmath37 ( @xmath38 ) .",
    "the mathematical description of the outer loop control law is : @xmath39 here , @xmath40 is the terminal control gain and @xmath41 is the optimized control input sequence from the outer loop mpc optimization , given by : @xmath42 subject to the dynamics of ( [ ol_aug_dynamics ] ) and constraints : @xmath43 and cost function : @xmath44 here , @xmath45 , @xmath46 , @xmath47 , and @xmath48 are design parameters , which are summarized in table [ mpc_parameters ] .",
    "@xmath49 is the set of all feasible @xmath50 trajectories . for the results in this paper ,",
    "there are no restrictions to the form of the stage cost , @xmath51 .",
    "the mathematical description of the inner loop control law is : @xmath52 where @xmath53 here , @xmath54 is the optimized control input sequence from the inner loop mpc optimization , given by : @xmath55 subject to the dynamics of ( [ il_error_dynamics ] ) and constraints : @xmath56 where @xmath11 reflects the actuator saturation limits of @xmath2 and @xmath57 is the set of all feasible control input @xmath58 trajectories .",
    "the inner loop cost function is given by : @xmath59 here , @xmath60 , @xmath61 , @xmath47 , and @xmath62 are design parameters , which are summarized in table [ mpc_parameters ] .",
    "as with the outer loop , there are no restrictions to the form of the stage cost , @xmath63 .    the terms @xmath64 and @xmath65 impose the requirement that trajectories @xmath66 and @xmath67 calculated at any two subsequent time steps must be sufficiently close to each other , and that the required proximity of trajectories decrease over time , until @xmath68 and @xmath69 , respectively .",
    "formulas for the required values for @xmath48 and @xmath62 are given in the proof of proposition [ convergence ] ; required values depend on the contraction rates @xmath45 and @xmath60 , system dynamics , horizon length ( @xmath32 ) , and @xmath47 .",
    "key mpc design parameters , including those that are essential for our stability formulation , are provided in table [ mpc_parameters ] .",
    "[ mpc_sequence ] provides a graphical depiction of the sequence of operations that occur in a single time instant when mpc is active .",
    "computationally , the outer loop mpc must consider @xmath70 states and @xmath71 control inputs , whereas the inner loop must consider @xmath72 states and @xmath73 control inputs .",
    "both optimizations are individually computationally simpler than their centralized counterparts , which must consider @xmath70 states and @xmath73 control inputs",
    ". the resulting computational simplification can be especially significant when the algorithm is applied to systems with complex outer loops ( @xmath74 ) and several actuators for a given virtual control ( @xmath75 ) , which is commonplace in industry .",
    ".key mpc design parameters [ cols=\"^,^\",options=\"header \" , ]",
    "in this section , we will first derive control laws that , in the absence of constraints , will lead to overall system stability .",
    "having derived these control laws , we will then show that there exist @xmath4- contractive sets @xmath30 and @xmath31 , as described in @xcite , such that once @xmath76 and @xmath77 enter @xmath78 , they remain there ( and in fact are driven further into the sets at the next instant ) .",
    "we consider two options for inner loop terminal control design , namely :    * _ exact reference model matching _ - we design the inner loop control law such that @xmath79 , which guarantees that @xmath80 asymptotically tracks @xmath81 . *",
    "_ approximate reference model matching _ - the inner loop control law is designed such that the closed inner loop is stable and a small gain condition is satisfied .      in the case of exact reference model matching , in order to derive a model - matching controller , we assume that the reference model is cast in a specific form that is compatible with the actuator dynamics ; specifically , we assume that :    * _ assumption 6 . _",
    "@xmath22 in ( [ ref_model ] ) is written in the same block ccf as @xmath82 ( as described in @xcite ) .    * _ assumption 7 . _",
    "taking @xmath83 and @xmath84 as the set of rows of @xmath85 and @xmath86 , respectively , that contain nonzero entries ( which also correspond to the full rows of @xmath82 and @xmath22 ) , we assume that @xmath87 , i.e. , each nonzero row of @xmath86 is also a nonzero row of @xmath85 .    these assumptions , in conjunction with assumptions 1 - 5 , place restrictions on @xmath22 and @xmath86 that ensure that a stabilizing , reference model - matching inner loop control law can be designed . in particular , it is possible to design outer and inner loop terminal control laws with desirable properties , according to the following proposition :    [ terminal_control ] ( terminal control laws for exact matching ) : given that assumptions 1 - 7 hold ,",
    "there exist control laws @xmath88 and @xmath89 which , when substituted into ( [ ol_aug_dynamics ] ) and ( [ il_error_dynamics ] ) , yield : @xmath90 where @xmath91 , and render the origin of the overall system , @xmath92 , asymptotically stable .",
    "since the pair @xmath13 is controllable and the reference model does not share zeros with unstable poles of @xmath23 , it follows that the pair @xmath93 is stabilizable .",
    "thus , @xmath40 can be designed to ensure that @xmath91 .    to show the second part of the proposition , recall that the inner loop dynamics are expressed in ( [ il_error_dynamics ] ) by : @xmath94 it follows from the block ccf of @xmath82 , @xmath85 , in conjunction with assumptions 6 and 7 ( which impose a suitable block ccf structure on @xmath22 and @xmath86 ) , that we can choose @xmath95 and @xmath96 to satisfy : @xmath97 which , when substituted into the inner loop dynamics , yields : @xmath98 to see this , let @xmath83 be the indices corresponding to the nonzero rows of @xmath85 , and let @xmath84 be the indices corresponding to the nonzero rows of @xmath86 . because assumption 7 requires that that @xmath99 , it possible to achieve @xmath100 .",
    "furthermore , let @xmath36 represent any zero row of @xmath85 ( and also @xmath86 ) .",
    "it follows from block ccf ( imposed by assumption 6 ) and assumption 7 that @xmath101 , making it possible to achieve @xmath102 .    because @xmath91 and @xmath19 , it follows that both the closed inner and outer loops ( [ full_cl_dynamics ] ) are input - to - state stable ( iss ) under the aforementioned control laws . for small gain analysis ,",
    "it is convenient to recast the system block diagram of fig .",
    "[ hierarchical_basic ] in the nonminimal representation of fig .",
    "[ hierarchical_rm_analysis ] , where offsetting copies of the reference model are embedded in both the inner and outer loops .",
    "closed outer loop stability guarantees a finite @xmath103 gain , @xmath104 , from @xmath105 to @xmath1 , and exact inner loop reference model matching guarantees an @xmath103 gain of @xmath106 , from @xmath1 to @xmath105 .",
    "therefore , the small gain condition , @xmath107 , is satisfied , and in conjunction with outer and inner loop iss , this proves asymptotic stability of @xmath92 .",
    "@xmath108          for many systems , such as non - minimum phase systems and high - order , high relative degree systems , exact reference model matching is unrealistic .",
    "exact matching is not essential , however , as shown in the following proposition :    [ terminal_control_inexact ] ( terminal control laws for inexact matching ) : given that assumptions 1 - 5 hold , there exist control laws @xmath88 and @xmath89 which , when substituted into ( [ ol_aug_dynamics ] ) and ( [ il_error_dynamics ] ) , yield : @xmath109 where @xmath91 and @xmath110 . furthermore , suppose that @xmath40 , @xmath95 , and @xmath96 are designed so that the @xmath103 gains from @xmath105 to @xmath1 and @xmath1 to @xmath105 , denoted @xmath104 and @xmath111 , respectively , satisfy the small gain condition , @xmath112 .",
    "then the origin of the overall system , @xmath92 , is asymptotically stable .",
    "since the pair @xmath13 is controllable and the reference model does not share zeros with unstable poles of @xmath23 , it follows that the pair @xmath93 is stabilizable .",
    "thus , @xmath40 can be designed to ensure that @xmath113 . from assumption 2 ,",
    "the pair ( @xmath114 ) is controllable , and therefore there exists @xmath115 such that @xmath116 .",
    "thus , both the inner and outer closed - loop dynamics of ( [ full_inexact_cl_dynamics ] ) , are input - to - state stable ( iss ) . by the hypotheses of proposition [ terminal_control_inexact ] , the small gain condition ,",
    "i.e. , @xmath107 , is satisfied .",
    "together with iss , this proves asymptotic stability of @xmath92 .",
    "@xmath108    since @xmath91 and @xmath110 it follows ( @xcite ) that there exist quadratic lyapunov functions , @xmath117 and @xmath118 , where @xmath119 and @xmath120 are positive definite symmetric matrices , such that when @xmath121 and @xmath89 : @xmath122 @xmath123 for some @xmath124 , @xmath125 , @xmath126 , @xmath127 , and @xmath128 ( @xmath129 under exact reference model matching ) .",
    "this fact will be important in demonstrating the existence and construction of @xmath4-contractive terminal constraint sets .",
    "now , we show that @xmath4-contractive sets , @xmath30 and @xmath31 , conforming to the definition in @xcite , exist for the outer and inner loops . to guarantee that such sets exist , we make the following trivial assumption regarding the feasible control input set , @xmath11 :    * _ assumption 8 .",
    "_ @xmath130 lies in the interior of @xmath11 .",
    "we now demonstrate the existence of @xmath4-contractive sets through the following proposition :    [ lambda_contractive ] ( existence of @xmath4-contractive sets ) : under assumptions 1 - 8 , there exist sets @xmath131 and @xmath132 , along with scalars @xmath133 and @xmath134 such that if : @xmath135 then : @xmath136    to construct @xmath30 , take : @xmath137 where @xmath138 .",
    "it follows from the continuity of @xmath139 that there exists some @xmath133 , @xmath140 , @xmath141 such that : @xmath142 it follows from ( [ lyap_lambda_inexact ] ) , ( [ g_1_def ] ) , and ( [ epsilon ] ) that if : @xmath143 and @xmath144 , then : @xmath145 to see this , note that ( [ lyap_lambda_inexact ] ) can be rearranged as : @xmath146 and noting that @xmath147 when @xmath148 , it follows that : @xmath149    to construct @xmath31 , take : @xmath150 where @xmath151 .",
    "it follows from ( [ lyap_alpha_inexact ] ) and the continuity of @xmath152 that if @xmath153 and @xmath154 , then : @xmath155 for some @xmath134 .",
    "it remains to select @xmath156 and @xmath157 such that @xmath158 , and @xmath159 satisfies ( [ v_tilde_limits ] ) whenever @xmath153 .    to ensure that @xmath160 , note that the inner loop terminal control law ( [ inner_terminal ] ) can be written as : @xmath161 and that @xmath162 it follows from ( [ inner_control_norms ] ) and assumption 8 that one can choose @xmath163 and @xmath164 such that whenever @xmath165 and @xmath166 , @xmath160 . from the quadratic structure of @xmath139 , it follows that @xmath165 whenever @xmath167 where @xmath168 is the smallest eigenvalue of @xmath119",
    "therefore , taking @xmath169 guarantees that @xmath170 whenever @xmath148 .",
    "similarly , from the quadratic structure of @xmath152 , it follows that @xmath166 whenever @xmath171 where @xmath172 is the smallest eigenvalue of @xmath120 .",
    "therefore , taking @xmath173 guarantees that @xmath174 whenever @xmath175 .",
    "( [ v_1_star_constraint ] ) and ( [ v_2_star_constraint1 ] ) together guarantee that @xmath160 whenever @xmath176 .",
    "finally , @xmath157 needs to be selected so that @xmath159 satisfies ( [ v_tilde_limits ] ) whenever @xmath153 .",
    "manipulation of ( [ v_tilde_limits ] ) shows that this is the case when @xmath177 and it follows from the quadratic structure of @xmath152 that ( [ first_v_tilde_eq ] ) is satisfied whenever @xmath178 substituting ( [ v_1_star_constraint ] ) for @xmath156 , it follows that by taking @xmath179 one guarantees that ( [ v_tilde_limits ] ) is satisfied whenever @xmath153 . in order to simultaneously ensure that @xmath160 , we take : @xmath180    @xmath108    the proof of proposition [ lambda_contractive ] is constructive in the sense that it provides the method by which one can construct @xmath30 and @xmath31 , and determine suitable values for @xmath45 and @xmath60 , respectively .",
    "it is also possible to derive constraint sets @xmath30 and @xmath31 under inexact , but sufficiently accurate reference model matching .",
    "the existence of @xmath4-contractive constraint sets and the conditions under which they are guaranteed to exist are given in the following proposition :    [ lambda_contractive_inexact ] ( existence of @xmath4-contractive sets with inexact reference model matching ) : suppose that assumptions 1 - 5 and assumption 8 hold .",
    "furthermore , suppose that @xmath139 and @xmath152 , along with scalars @xmath181 , @xmath182 , @xmath183 , @xmath184 , and @xmath185 from ( [ lyap_lambda_inexact ] ) and ( [ lyap_alpha_inexact ] ) , along with matrices @xmath186 and @xmath40 , satisfy the following inequality : @xmath187 where @xmath172 and @xmath168 are the minimum eigenvalues of @xmath120 and @xmath119 , respectively .",
    "then there exist sets @xmath131 and @xmath132 , along with scalars @xmath133 and @xmath134 such that if : @xmath135 then : @xmath136    the construction of @xmath30 is done identically to proposition [ lambda_contractive ] , taking : @xmath188 where @xmath138 . equations ( [ epsilon])-([last_g1 ] ) remain unchanged and follow the same derivation as in proposition [ lambda_contractive ] .    for the construction of @xmath31 , we take : @xmath189 where @xmath151 .",
    "it follows from the continuity of @xmath152 that there exists some @xmath134 , @xmath190 , @xmath191 such that : @xmath192 it follows from ( [ lyap_alpha_inexact ] ) , ( [ g_2_def_inexact ] ) , and ( [ epsilon_inexact ] ) that if : @xmath193 and @xmath153 , then : @xmath194    it remains to select @xmath156 and @xmath157 such that @xmath158 , and @xmath159 satisfies ( [ v_tilde_limits ] ) whenever @xmath153 .",
    "this derivation is exactly the same here as in proposition [ lambda_contractive ] , and ( [ inner_control_rewritten])-([v_2_star_constraint1 ] ) all hold .",
    "finally , @xmath156 needs to be selected so that @xmath195 and @xmath196 satisfy ( [ v_des_limits ] ) whenever @xmath148,and @xmath157 needs to be selected so that @xmath159 satisfies ( [ v_tilde_limits ] ) whenever @xmath153 .",
    "for @xmath157 , the derivation is the same as in proposition [ lambda_contractive ] and the requirement is given by : @xmath197 for @xmath156 , we begin by noting that if : @xmath198 then ( [ v_des_limits ] ) is satisfied . to see this ,",
    "note first that whenever @xmath144 , it follows from the quadratic form of @xmath139 that : @xmath199 from which it follows from substitution into ( [ v1_inexact ] ) that : @xmath200 noting that @xmath201 , we can see immediately that ( [ v_des_limits ] ) is satisfied .",
    "combining ( [ v2_inexact ] ) and ( [ v1_inexact ] ) with the requirements of ( [ v_1_star_constraint ] ) and ( [ v_2_star_constraint ] ) gives the following two nonlinear equations that must be solved for @xmath156 and @xmath157 : @xmath202 @xmath203 ( [ v_1_star_constraint_inexact ] ) and ( [ v_2_star_constraint_inexact ] ) will only admit a solution if : @xmath204 noting that the only requirements on @xmath205 and @xmath206 are that @xmath207 and @xmath208 , @xmath205 and @xmath206 in ( [ inexact_constraint_epsilon ] ) can be replaced with @xmath181 and @xmath182 , and ( [ inexact_constraint_epsilon ] ) can be rearranged to yield the constraint : @xmath209 completing the proof .",
    "@xmath108    the proof of proposition [ lambda_contractive_inexact ] follows similar arguments to that of proposition [ lambda_contractive ] , with the exception that now @xmath156 and @xmath157 , which define the boundaries of @xmath30 and @xmath31 , must satisfy two coupled equations , and a solution to these coupled equations only exists when ( [ small_gain_constraint_inequality ] ) is satisfied .",
    "qualitatively speaking , satisfaction of ( [ small_gain_constraint_inequality ] ) depends on two factors :    1 .",
    "free response speed of the outer and inner loop systems , indicated by @xmath181 and @xmath182 ; 2 .",
    "level of coupling between the outer and inner loop systems , indicated by @xmath183 , @xmath184 , and @xmath185 .",
    "the results of section [ lambda_contractive ] provide a means by which outer and inner loop control laws can be designed to yield local stability of the origin of the overall system , i.e. , @xmath210 , @xmath211 .",
    "the mpc optimizations of ( [ mpc_outer_opt])-([mpc_outer_cost ] ) and ( [ mpc_inner_opt])-([mpc_inner_cost ] ) are employed in order to expand the region of attraction beyond the intersection of @xmath30 and @xmath31 . in order to guarantee convergence to @xmath30 and @xmath31",
    ", the mpc optimizations must not only impose a terminal constraint but must also ensure that optimized trajectories do not differ too much from one time step to the next in order to ultimately guarantee persistent feasibility of the optimization .",
    "this assurance is accomplished through the imposition of rate - like constraints presented in this section .",
    "these rate - like constraints , @xmath46 and @xmath61 , which limit the variation of @xmath50 and @xmath58 trajectories from one time instant to the next .",
    "we begin with the following proposition , which follows from examination of the time series representation of the @xmath76 trajectory :    [ ol_robustness_to_v_tilde_variation ] ( robustness of outer loop mpc to variation in @xmath212 ) : suppose that , given @xmath213,\\ ] ] a trajectory @xmath214,\\ ] ] is computed that yields @xmath215 .",
    "then there exists @xmath216 such that if @xmath217 and @xmath218 , then @xmath219 .    at step",
    "@xmath37 the outer loop dynamics over the mpc horizon can be expressed as : @xmath220 for @xmath221 .",
    "an analogous expression exists at step @xmath222 .",
    "when @xmath223 , the difference between the predicted trajectories at steps @xmath37 and @xmath222 is then given by : @xmath224 which , in the case that @xmath217 , leads to the inequality : @xmath225 since @xmath226 , it follows that there exists @xmath227 such that if @xmath215 and @xmath228 , then @xmath219 .",
    "thus , by taking : @xmath229 we guarantee that @xmath230 .",
    "@xmath108    the proof relies on a time series representation of the @xmath76 trajectory , which demonstrates that the step - to - step variation in @xmath231 can be upper bounded by restricting the variation in @xmath212 .",
    "we arrive at a very similar conclusion regarding the robustness of the inner loop mpc to variation in @xmath232 :    [ il_robustness_to_x_f_variation ] ( robustness of inner loop mpc to variation in @xmath232 ) : suppose that , given @xmath233,\\ ] ] a trajectory @xmath234,\\ ] ] is computed that yields @xmath235 . then there exists @xmath236 such that if @xmath237 and @xmath238 , then @xmath239 .    taking @xmath240 yields @xmath241 .",
    "thus , @xmath242 since @xmath243 , there exists @xmath244 such that if @xmath235 and @xmath245 , then @xmath246 from ( [ x2_traj ] ) and ( [ x_tilde_inthere ] ) it follows that by taking @xmath247 , we guarantee that @xmath239 .",
    "@xmath108    it is possible to convert the state constraints of propositions [ ol_robustness_to_v_tilde_variation ] and [ il_robustness_to_x_f_variation ] to input constraints ( on @xmath50 and @xmath58 ) , which are easily enforced and will always result in a feasible optimization problem ( as opposed to state constraints , which are not in general guaranteed to result in a feasible constrained optimization ) .",
    "these input constraints are given in the following propositions :    [ ol_robustness_to_u_variation ] ( converting constraints on @xmath212 to constraints on @xmath58 ) : there exists @xmath248 such that if @xmath249 , @xmath250 , then @xmath251 , @xmath252 .",
    "for this proof , it is convenient to express the inner loop dynamics as : @xmath253 from which it from a time series expansion that : @xmath254 and @xmath255 it follows that if we take : @xmath256 then we have @xmath257 .",
    "@xmath108    the proof uses the time series expression of the inner loop dynamics to demonstrate that one can restrict the step - to - step variation in @xmath58 and achieve the required bound on the step - to - step variation in @xmath212 .",
    "constraints on @xmath232 can similarly be converted to constraints on @xmath50 , as presented in the following proposition :    [ il_robustness_to_v_des_variation ] ( converting constraints on @xmath232 to constraints on @xmath50 ) : there exists @xmath258 such that if @xmath259 , @xmath260 , then @xmath237 .",
    "recall that the reference model dynamics are given by : @xmath261 from which it follows that : @xmath262 and @xmath263 if we take : @xmath264 then we have @xmath237 .    @xmath108",
    "in this section , we show how the constraints derived in sections 4 and 5 result in persistent feasibility of the mpc optimization problem and asymptotic stability of the overall system , with a region of attraction that is identical to the set of states for which the initial optimization problem is feasible .      because the rate - like constraints can not be applied at step @xmath265 ( since there is no step @xmath266 against which to compare ) , we make the following initial feasibility assumption for step @xmath265 :    _ initial feasibility assumption _ : there exists a set @xmath267 , such that if @xmath268^{t } \\in x$ ] , then @xmath269 and @xmath270 can be chosen and are chosen such that @xmath271 and the mpc optimization problem is feasible . given this assumption , we now state the persistent feasibility result .",
    "[ feasibility ] ( persistent feasibility ) : suppose that the initial conditions satisfy @xmath268^{t } \\in x$ ] .",
    "then both the outer and inner loop mpc optimizations are feasible at every step , @xmath272 .",
    "feasibility at @xmath265 is guaranteed by the initial feasibility assumption .",
    "_ outer loop mpc feasibility for @xmath273 _ : by inner loop constraint ( [ mpc_inner_constraints ] ) , combined with proposition [ ol_robustness_to_u_variation ] , we guarantee that @xmath251 for @xmath274 . thus , if we take @xmath275 for @xmath250 , then we achieve : @xmath276 by construction of @xmath30 and @xmath31 , taking @xmath277 results in @xmath278 .    _ inner loop mpc feasibility for @xmath273 _ : by outer loop constraint ( [ mpc_outer_constraints ] ) , combined with proposition [ il_robustness_to_v_des_variation ] , we guarantee that @xmath279 for @xmath250 . thus ,",
    "if we take @xmath280 for @xmath250 , then we achieve : @xmath281 given that @xmath282 , applying @xmath283 yields @xmath235 .",
    "@xmath108    the proof follows from the rate - like constraints imposed on @xmath66 and @xmath67 .",
    "specifically , if the variations in @xmath50 and @xmath58 are sufficiently small from step @xmath37 to @xmath222 , then the optimization problem remains feasible at step @xmath222 .",
    "having shown that the optimization problems are persistently feasible , the next step is to show that the control laws do in fact result in finite - time convergence to @xmath30 and @xmath31 .",
    "this is given in the following proposition :    [ convergence ] ( convergence to @xmath30 , @xmath31 ) : suppose that the initial conditions satisfy @xmath268 \\in x$ ] .",
    "then there exists a scalar integer @xmath284 such that , after applying the mpc algorithm for @xmath285 steps , we have @xmath286 and @xmath287 .    by the inner and outer loop rate - like constraints , we have : @xmath288 for the outer loop , it follows that : @xmath289 which , after collecting constant terms into one lumped constant , @xmath119 , can be rewritten compactly as : @xmath290 because @xmath291 , there exists a positive scalar @xmath292 such that for any two vectors @xmath293 and @xmath294 , @xmath295 . to guarantee that @xmath296 , it suffices to ensure that : @xmath297    it follows through manipulation of ( [ ol_convergence_1 ] ) , using ( [ ol_convergence_2 ] ) , that whenever @xmath298 @xmath296 .    through the same process",
    ", one can show that there exists @xmath62 for which @xmath175 . specifically , for the inner loop : @xmath299 which , after collecting constant terms into one lumped constant @xmath120 can be rewritten compactly as : @xmath300 because @xmath301 , there exists a positive scalar @xmath302 such that for any two vectors @xmath303 and @xmath304 , @xmath305 . to guarantee that @xmath306 , it suffices to ensure that : @xmath307    it follows through manipulation of ( [ il_convergence_1 ] ) , using ( [ il_convergence_2 ] ) , that whenever @xmath308 @xmath309 .    taking @xmath310 completes the proof .",
    "@xmath108    the proof relies on the fact that the variation in @xmath311 and @xmath312 is not only limited , but is also required to decay over time ( through the use of @xmath313 in ( [ mpc_outer_constraints ] ) and ( [ mpc_inner_constraints ] ) ) .",
    "we now state our main result , namely asymptotic stability of the origin of the overall system , with region of attraction @xmath314 :    [ stability ] ( asymptotic stability ) : under the mpc controller , specified by ( [ mpc_outer_law])-([mpc_inner_cost ] ) , the origin , @xmath315 , @xmath316 , is asymptotically stable with region of attraction @xmath314 .    propositions [ terminal_control ] and [ terminal_control_inexact ] establish the local asymptotic stability of the origin , @xmath317 , under the terminal control laws , @xmath121 and @xmath318 . because these terminal control laws are active whenever @xmath148 and @xmath175 , and because @xmath319 , it follows that the origin of the overall system , @xmath320 , @xmath316 , is ( locally ) asymptotically stable with region of attraction @xmath321 .    from proposition",
    "[ convergence ] , we know that , under the proposed control law , if @xmath322^{t } \\in x$ ] , then there exists @xmath285 for which @xmath286 and @xmath287 .",
    "it follows that @xmath210 , @xmath211 has region of attraction @xmath314 .",
    "@xmath108    the proof contains two parts .",
    "first , local asymptotic stability with region of attraction @xmath323 is shown by demonstrating that both the inner and outer loop systems are input - to - state stable ( iss ) and the small gain condition is satisfied within this ( invariant ) region of attraction . through the use of mpc , the region of attraction is enlarged to @xmath314 .",
    "in this paper , we reviewed a novel alternative approach to hierarchical mpc that relies on an inner loop reference model rather than a multi - rate approach for achieving overall system stability .",
    "this new approach broadens the class of systems for which overall stability of a hierarchical mpc framework can be guaranteed by allowing the inner closed loop to track the output of a prescribed reference model rather than requiring the inner loop to reach a steady state at each outer loop step .",
    "this paper presented proofs that were omitted in other works by the authors due to space constraints .",
    "c. vermillion , a. menezes , i. kolmanovsky stable hierarchical model predictive control using an inner loop reference model and @xmath4-contractive terminal constraint sets .",
    "_ automatica _ , accepted provisionally for publication in december , 2012 , re - submitted in february , 2013 .",
    "p. falcone , f. borrelli , h. tseng , j. asgari , d. hrovat .",
    "a hierarchical model predictive control framework for autonomous ground vehicles .",
    "_ proceedings of the american control conference _ ,",
    "seattle , wa , 2008 .",
    "h. lin and p. antsaklis .",
    "a necessary and sufficient condition for robust asymptotic stabilizability of continuous - time uncertain switched linear systems .",
    "_ proceedings of the ieee conference on decision and control _ , paradise island , bahamas , 2004 .",
    "y. luo , a. serrani , s. yurkovich , d. doman , m. oppenheimer .",
    "dynamic control allocation with asymptotic tracking of time - varying control input commands .",
    "_ proceedings of the american control conference _ , portland , or , 2005 .",
    "y. luo , a. serrani , s. yurkovich , m. oppenheimer .",
    "model predictive dynamic control allocation scheme for reentry vehicles .",
    "_ journal of guidance , control , and dynamics _ , vol .",
    "30 , no . 1 , 2007 , pp .",
    "100 - 113 .",
    "p. mhaskar , n. el - farra , c. mcfall , p. christofides , and j. davis . integrated fault - detection and fault - tolerant control of process systems .",
    "_ american institute of chemical engineers journal _ , vol .",
    "2129 - 2148 , 2006 .              c. vermillion , j. sun , k. butts model predictive control allocation for overactuated systems - stability and performance .",
    "_ proceedings of the ieee conference on decision and control _ , new orleans , la , 2007 .    c. vermillion , j. sun , k. butts model predictive control allocation - design and experimental results on a thermal management system .",
    "_ proceedings of the american control conference _ , st .",
    "louis , mo , 2009 .    c. vermillion , j. sun , k. butts predictive control allocation for a thermal management system based on an inner loop reference model - design , analysis , and experimental results . _ ieee transactions on control systems technology _ , pp .",
    "772 - 781 , vol .",
    "19 , issue 4 , 2011 ."
  ],
  "abstract_text": [
    "<S> this paper presents a hierarchical model predictive control ( mpc ) framework that is presented in @xcite and @xcite , along with proofs that were omitted in the aforementioned works . </S>",
    "<S> the method described in this paper differs significantly from previous approaches to guaranteeing overall stability , which have relied upon a multi - rate framework where the inner loop ( low level ) is updated at a faster rate than the outer loop ( high level ) , and the inner loop must reach a steady - state within each outer loop time step . </S>",
    "<S> in contrast , the method proposed in this paper is aimed at stabilizing the origin of an error system characterized by the difference between the inner loop state and the state specified by a full - order reference model . </S>",
    "<S> this makes the method applicable to systems with reduced levels of time scale separation . </S>",
    "<S> this paper reviews the fundamental results of @xcite and @xcite and presents proofs that were omitted due to space limitations .    model predictive control , hierarchical control , control of constrained systems , decentralization . </S>"
  ]
}