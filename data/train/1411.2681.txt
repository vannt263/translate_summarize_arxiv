{
  "article_text": [
    "the statistical analysis of problems where the sample data are functions is often called functional data analysis ( fda ) .",
    "this is a relatively new statistical field which involves several specific challenges , most of them are associated with the infinite - dimensional nature of the data .",
    "we are concerned here with one of these specific challenges , namely , the choice of a suitable distance criterion between the data . in what follows , unless otherwise stated , we will consider problems where the sample data are real functions @xmath4 $ ] .    not surprisingly , a considerable part of the current fda theory has been developed assuming that the data functions belong to the space @xmath5 $ ] , that is , the distance between two data @xmath6 and @xmath7 is given by @xmath8 .",
    "this distance presents obvious advantages , derived from the fact that @xmath5 $ ] is a hilbert space .",
    "thus , some extremely important tools , as the existence of orthogonal bases ( and the corresponding expansions for the data in orthogonal series ) are available in @xmath5 $ ] . as a useful by - product , some crucial methodologies , such as principal components analysis or linear regression ( and even partial least squares ) , can be partially adapted to the functional setting .",
    "another widely used metric is associated with the supremum norm @xmath9 , which is well - defined in the space @xmath10 $ ] of real continuous functions @xmath11\\rightarrow",
    "r}$ ] ; thus the metric is @xmath12 for @xmath13 $ ] .",
    "although the hilbert structure is lost here , the advantages of the supremum metric are also well - known : first , @xmath14 is easy to interpret in terms of vertical distance between the functions .",
    "second , the structure of the space of probability measures on @xmath15,\\vert\\cdot\\vert_\\infty)$ ] is also well understood , and carefully analyzed , for example , in the classical book by @xcite .    for general accounts on the fda theory we refer to the books by @xcite , @xcite , @xcite , @xcite , @xcite and the recent survey paper by @xcite .      in what follows we analyze , from both the theoretical and practical point of view , a metric between functions especially aimed at capturing the `` visual distance '' between the graphs .",
    "this metric will be particularly suitable in fda problems where the data are functions with wiggly graphs showing very sharp peaks . in those situations the classical metrics ( @xmath16 or @xmath14 )",
    "could be unsuccessful in capturing a `` practically meaningful '' notion of distance between the graphs .",
    "for example , a small lateral shift in a very sharp peak ( perhaps due to a registration error ) could lead to an enormous @xmath14-distance . likewise ,",
    "if two graphs differ in just one such narrow peak , the @xmath16-distance between them might be very small , which could be unsuitable in many cases .",
    "the spectrograms , either obtained from magnetic resonance ( @xmath17h - nmr or @xmath18c - nmr ) or by mass spectrometry , provide a good example of such situations .",
    "just as an example to motivate our point , let us consider the @xmath18c - nmr spectrum of a compound , namely the o - xylene ( @xmath19 ) ; see figure [ xylene ] , left .",
    "it shows the typical spiky pattern , with sharp and narrow peaks , strongly localized ( we will consider below other examples of much more complex organic compounds were the peaks are present but not all the information is concentrated around them ) .",
    "the peaks in this spectrum are located at the points 136.42 , 129.63 , 125.85 , 19.66 ppm .",
    "this information has been obtained from the data base http://sdbs.db.aist.go.jp , ( national institute of advanced industrial science and technology , date of access august 23 , 2015 ) .",
    "now , we might want to consider the @xmath20c - nmr spectrum of another closely related compound , the m - xylene , an isomer of the previous one : see the right panel of figure [ xylene ] .",
    "although the general aspect of both spectra is very similar , there are clearly some differences . in the case of m - xylene ,",
    "the peaks are located at 137.74 , 129.96 , 128.21 , 126.13 , 21.31 ppm .",
    "a `` reasonable '' metric defined to measure the distance between these graphics should provide a small value ( thus reflecting their close affinity ) , by taking into account their `` visual '' proximity , that is , the distance between the graphics in all directions ( not only in the vertical one ) .",
    "moreover , for this type of graphics , we would also like to detect the presence of additional very narrow peaks ( far away from the others ) , contributing a small area but carrying a relevant information on the compound .",
    "the @xmath16 distance does not seem useful for such purpose .",
    "see also the figure [ disthaus ] below and the discussion following definition ( [ hh ] ) .",
    "c - nmr spectra of the o - xylene ( left ) and m - xylene.,title=\"fig:\"]c - nmr spectra of the o - xylene ( left ) and m - xylene.,title=\"fig : \" ]    as explained in depth by @xcite , in order to reach meaningful conclusions , handling of spectrum data needs a crucial pre - processing stage .",
    "this typically includes , among others , the following steps : _ remove random noise _ , _ normalization _ , _ peaks detection _",
    "( to identify locations on the scale that correspond to specific molecules ) and _ peak matching _ ( to match peaks in different samples , that correspond to the same peak ) . for this purpose , there is an increasing amount of software available .",
    "in particular , several packages can be downloaded from the web page of the software r ( http://www.r-project.org/ ) in order to deal with spectrum - type data ; for example , maldiquant , readmzxmldata and alfq .",
    "this paper could be seen as a further suggestion in this line of research .",
    "the rest of this paper is organized as follows : the study of the proposed visual metric ( including the definition , computation and topological properties of the distance ) is considered in section [ thedistance ] . in section [ classification ]",
    "we focus on some theoretical aspects of the use of this metric in the supervised classification problem .",
    "a small simulation study is provided in section [ simul ] .",
    "two real data examples of mass spectra classification are considered in section [ real ] .",
    "finally , some concluding remarks are given in section [ conclu ] .",
    "the proofs are given in an appendix .",
    "the starting point is the standard definition ( see , e.g. , @xcite , p. 117 ) of the hausdorff ( or pompeiu - hausdorff ) distance between two compact non - empty sets , @xmath21 : @xmath22 where @xmath23 denotes the @xmath24-parallel set @xmath25 and @xmath26 denotes ( with a slight notational abuse ) the closed ball centered at @xmath27 with radius @xmath24 ; the open ball will be denoted @xmath28 .",
    "also , @xmath29 .    unlike other notions of proximity between sets",
    ", @xmath30 is a true metric ( i.e. it has the properties of identifiability , symmetry and triangular inequality ) in the class of compact non - empty sets . the hausdorff distance has been extensively used in different problems of image analysis ( especially in pattern recognition ) , which appear in the literature under different names ( shape comparison , object matching , etc . ) .",
    "the strong intuitive motivation behind the definition of @xmath30 has motivated the study of other variants of the same idea as well as other closely associated notions .",
    "some references are @xcite , @xcite , @xcite .",
    "however , our aim here is rather to use the hausdorff metric as a tool for defining distance between functions , very much in the spirit of some ideas in approximation theory ; see , for example , @xcite .    the basic idea behind the metric we are going to consider is quite simple : given two non - negative functions @xmath31 and @xmath32 , defined on @xmath33 $ ]",
    ", the distance between @xmath31 and @xmath32 is measured in terms of the hausdorff metric between the corresponding hypographs .",
    "however , we must take care of some technical aspects in order to properly establish this definition .",
    "let us recall that a function @xmath34\\rightarrow { \\mathbb r}$ ] is said to be _ upper semicontinuous at @xmath35 if @xmath36 .",
    "a function @xmath31 is said to be upper semicontinuous ( usc ) if it fulfils the above condition at every point @xmath35 .",
    "_    given a non - negative function @xmath31 defined on @xmath33 $ ] , the _ hypograph of @xmath31 is the set @xmath37 , 0 \\leq   y \\leq f(x)\\big\\}.\\ ] ] denote by @xmath38 the space of non - negative usc functions defined on @xmath33 $ ] . the following proposition , whose proof can be found in @xcite , establishes some useful properties of usc functions . _    [ propusc ] let @xmath34\\rightarrow \\mathbb{r}$ ] be a non - negative usc function .",
    "* let @xmath39 $ ] be a compact set .",
    "then , there exists @xmath40 such that @xmath41 . *",
    "the hypograph @xmath42 is compact .",
    "we are now ready to define our visual metric : for @xmath31 , @xmath43 we define @xmath44 it is easily seen that this is a true metric in @xmath1 . in particular , if @xmath45 , the usc assumption guarantees that we must have @xmath46 .",
    "let us denote by @xmath2 the space of usc non - negative functions endowed with the metric ( [ hh ] )",
    ".     corresponds to the length of the double arrow joining both curves . ]",
    "figure [ disthaus ] aims at illustrating the heuristic meaning of the @xmath0-metric between two spectrum - type curves @xmath47 ( solid line ) and @xmath48 ( dotted line ) . in this case , the distance @xmath49 is the length of the double arrow joining two close peaks in the curves .",
    "the corresponding values for the  classical \" distances are @xmath50 , @xmath51 .",
    "so , @xmath0 succeeds in reflecting the visual proximity between both curves .    in order to gain some additional insight on the meaning of the distance @xmath0 and their relations with other usual metrics ,",
    "let us note that    * convergence in @xmath0 does not imply pointwise convergence .",
    "consider @xmath52}(x)$ ] and the sequence @xmath53 if @xmath54 and @xmath55 if @xmath56 $ ] .",
    "it is clear that @xmath57 but @xmath58 .",
    "the reciprocal implication is not true either .",
    "take @xmath59 @xmath60 $ ] and @xmath61 .",
    "we have @xmath62 for all @xmath27 but @xmath63 where @xmath64 and @xmath65 for @xmath66 . *",
    "convergence in @xmath67 does not imply convergence in @xmath68 : consider @xmath69}$ ] and @xmath59 @xmath60 $ ] .",
    "the reciprocal is also false : take @xmath70}(x)\\quad i=1,\\dots,2^n$ ] , and the functions @xmath71}(x),\\ ] ] it is clear that @xmath72 , however , for all @xmath73 , @xmath74 . *",
    "a natural question is : why to use usc functions ?",
    "since in many applications , the functional data appear as continuous functions , one might think that we might restrict our discussion to the continuous case .",
    "however there are , at least , good reasons for considering usc functions : first , in some practical examples ( though not , typically , in the case of spectra ) one has to deal with non - continuous samples and , especially , with jump discontinuities .",
    "second , we need upper semicontinuity to get a complete space ( which in turn is essential for a more convenient mathematical handling ) .",
    "take for example the sequence of functions @xmath75 for @xmath76 $ ] .",
    "this is a cauchy sequence in our space @xmath2 , but clearly does not converge to any continuous function on [ 0,1 ] .",
    "hence , we need to enlarge the space to include usc if we want to get completeness .",
    "as mentioned above , the hausdorff distance has some applications in image processing .",
    "hence its numerical calculation has motivated some interest in the literature .",
    "see @xcite and @xcite , just to mention a couple of recent references .",
    "the matlab function hausdorffdist computes the hausdorff distance between two finite sets of points in @xmath77 .",
    "we are concerned here with the particular case in which the sets are the hypographs of functions , especially when these functions are specified only by their values in a given grid of @xmath33 $ ] .",
    "our aim here is to approximate the value of @xmath78 in such cases , which arise very often in practical applications .",
    "first let us observe that , given two functions @xmath31 and @xmath32 in @xmath38 , from the definitions of @xmath0 and @xmath30 we have : @xmath79 .",
    "however , the boundaries @xmath80 and @xmath81 do play a relevant role in the calculation of @xmath78 . in fact , the following proposition shows that we can restrict the calculation to appropriate subsets of these boundaries .",
    "[ prophaus ] let @xmath82 , then    the proofs of all results are given in the appendix .",
    "in particular , the proof of proposition [ prophaus ] , will require lemma [ lemhaus ] whose proof can also be found in the appendix .",
    "_ an algorithm to compute @xmath68 _ + if we have @xmath83 and @xmath84 , and if we assume that @xmath31 and @xmath32 are continuous , then proposition [ prophaus ] , together with proposition [ propdh ] in the appendix , gives us a simple algorithm of order @xmath85 to approximate @xmath86 .",
    "just compute @xmath87 where , if @xmath88 then @xmath89 and if @xmath90 , then @xmath91 . from lemma [ lemhaus ] , if @xmath92 then @xmath93 .      the distance @xmath0 has been considered in @xcite in the context of density estimation : in particular , convergence rates are obtained , under some smoothness conditions , for @xmath94 , where @xmath95 denotes a sequence of kernel density estimators of the density @xmath31 .",
    "different versions of the same idea are considered in @xcite , p. 282 .",
    "they are defined in terms of epigraphs ( rather than hypographs ) and are therefore applied to lower semicontinuous ( rather than upper semicontinuous ) functions .",
    "some relevant applications are given in the framework of optimization theory to give bounds for approximately optimal solutions of convex lower semicontinuous functions .",
    "another related approach to the idea of defining the distance between two functions in terms of the distance between their graphs is considered in @xcite for the so - called _ segment functions .",
    "@xcite extends these ideas to the setting of multifunctions . _",
    "the metric space is particularly `` well - behaving '' in some important aspects that are summarized next .",
    "[ topo ] ( a ) the space @xmath2 is complete and separable .",
    "also , any bounded and closed set in @xmath2 is compact .",
    "in particular , @xmath2 is locally compact .",
    "\\(b ) let @xmath96 such that @xmath57 then ; @xmath97 } f(x)= \\lim_{n\\rightarrow + \\infty } \\max_{x \\in [ 0,1 ] } f_n(x).\\ ] ]    the proof of this result is given in the appendix .",
    "let us now briefly comment on the meaning and usefulness of these properties .",
    "* among the three properties established in theorem [ topo ] ( a ) , completeness is perhaps the most basic one .",
    "it is essential to study convergence of sequences or series in @xmath2 by just looking at the corresponding cauchy property .",
    "this property is also required in the proof of some key results as banach s fixed point theorem for contraction mappings ; see @xcite * separability is a most crucial property in a metric space in order to define on it well - behaving probability measures .",
    "a nice discussion on this topic can be found in @xcite , pp .",
    "although this discussion applies , in principle , to banach spaces , the main arguments can be also translated to a metric space .",
    "for example , separability is required to ensure that a probability measure @xmath98 defined on @xmath2 is _ tight , in the sense that for all @xmath99 there exists a compact set @xmath100 such that @xmath101 .",
    "this is a far - reaching property , that can be found in the basis of many standard probability calculations .",
    "thus , the separability property allows us to express any @xmath1-valued random element as a limit of a sequence of simple ( finite - valued ) random elements .",
    "also , separability is needed to guarantee a proper behaviour of product measurable structures : in particular , the borel @xmath102-algebra of the product space is the product of the individual borel @xmath102-algebras of the factors ; see proposition 1.5 in @xcite .",
    "also , let us recall that separability of a metric space is equivalent to the property that this space is second - countable ( e.g. , @xcite , pp . 116 - 118 ) , which is important in many probability arguments : for example , to show that any probability measure in a locally compact metric space is a radon measure , see @xcite , th . 7.8 .",
    "_ + finally , separability is also required for the consistency theorem for @xmath3-nn classification rules mentioned in subsection [ acfd ] . * as for local compactness , let us recall that , in the case of banach spaces , this property is equivalent to the finite - dimensionality of the space . in our case , we do nt have a vector structure , so that we only have a metric space ( not a normed one ) .",
    "however , the local compactness allows us to use some `` natural '' properties that we often use in the finite - dimensional spaces .",
    "for example , to show that any real integrable function defined on @xmath1 can be approximated by a sequence of continuous compact - supported functions ( see @xcite , proposition 7.9 ) .",
    "an application of this can be found in section [ ppp ] .",
    "let us observe that the local compactness does not hold for @xmath103 .",
    "in order to see this , observe that for every @xmath99 , the sequence @xmath104 is included in the ball ( with the distance @xmath105 ) centered at the null function , of radius @xmath24 .",
    "however , this sequence does not have any convergent subsequence ; indeed , the only possible limit would be the function @xmath65 for @xmath106 , @xmath107 , but @xmath108 for all @xmath109 .",
    "[ acfd ] we will briefly consider here some theoretical aspects of the supervised classification problem , focusing especially on the case of @xmath3-nn ( nearest neighbors ) classifiers .    _",
    "the ( functional ) supervised classification problem _",
    "we focus on the problem of supervised classification with functional data ; see e.g. , @xcite for an overview .",
    "more precisely , we are concerned with statistical problems for which the available data consist of an iid `` training sample '' @xmath110 .",
    "the @xmath111\\}$ ] are independent trajectories , belonging to a function space @xmath112 , drawn from a stochastic process @xmath113\\}$ ] which can be observed from two probability distributions , @xmath114 and @xmath115 ( often referred to as `` populations '' in statistical language ) .",
    "the @xmath116 are binary random variables indicating the membership of the trajectory @xmath117 to @xmath114 or @xmath115 , that is , the population from which the observation @xmath117 has been drawn .",
    "it is assumed that the conditional distributions of @xmath118 , @xmath119 ( that is , @xmath114 and @xmath115 ) are different .    _",
    "@xmath3-nn classifiers : why to use them in the functional setting _    in a model of this type ,",
    "the aim is typically to classify ( either in @xmath114 or in @xmath115 ) a new observation @xmath120 , for which the corresponding value of @xmath121 is unknown .",
    "a classification rule ( or classifier ) is a measurable function @xmath122 defined on the space @xmath112 of trajectories .",
    "usually , the classification rules are constructed using the information provided by the training sample data @xmath123 .    in this work",
    "we will limit ourselves to use the @xmath3-nn classifiers : an observation @xmath27 is classified into @xmath114 if the majority among the @xmath3 observations @xmath117 ( in the training sample ) closest to @xmath27 , fulfils @xmath124 ; ties are randomly broken .",
    "of course , `` closest '' refer to some metric defined in the space @xmath112 on which the @xmath117 take values : each metric leads to a different @xmath3-nn classification rule . in the functional infinite dimensional case ,",
    "the choice of this metric is particularly relevant .",
    "the values @xmath125 are the smoothing parameters , similar to others which appear in non - parametric procedures : see @xcite for background .",
    "as we will see below , they must fulfil some minimal conditions regarding the speed of convergence to infinity .",
    "of course , the choice of @xmath3 for any specific sample size @xmath109 can have some influence on the performance of the @xmath3-nn classifier .",
    "however , as we will see in section [ real ] , the choice of the metric in the `` feature space '' ( where @xmath120 takes values ) can be even more important .",
    "the reasons for choosing @xmath3-nn classifiers can be summarized in the following terms : simplicity , ease of interpretability , good general performance and generality .",
    "indeed , @xmath3-nn is a sort of all - purposes `` benchmark procedure '' , not so easy to beat in practice .",
    "the available experience ( see @xcite , @xcite and references therein ) suggests that , @xmath3-nn classifiers tend to show a stable performance , not far from the best method found in every specific problem . moreover , they have a sound intuitive basis , so they are easily interpretable in all cases ( unlike other classification methods ) and they can be used in very general settings , when @xmath120 takes values in any metric space .",
    "we now consider some theoretical issues regarding consistency of @xmath3-nn classifiers in the framework of our space @xmath2 .    _",
    "the notion of consistency _",
    "let us denote by @xmath126 a sequence of @xmath3-nn classifiers defined in the usual way , as indicated at the end of the previous subsection .",
    "we will say that this sequence is _ weakly consistent ( see , e.g. , @xcite for more details ) if the misclassification probability @xmath127 converges ( in probability , as @xmath128 ) to the optimal value @xmath129 , which corresponds to the optimal rule @xmath130 , where @xmath131 .",
    "it is readily seen that the weak consistency condition is equivalent to @xmath132 _    in the finite dimensional case , that is when random variable @xmath120 takes values in @xmath133 , it is well - known from a classical result due to @xcite , that any sequence of @xmath3-nn classifiers is ( weakly ) consistent provided that @xmath134 and @xmath135 .",
    "this result is _ universal , in the sense that it does not impose any condition of the distribution of the random pair @xmath136 . _    _ the infinite - dimensional case .",
    "the besicovitch condition _",
    "let @xmath136 be the random element generating the data in a supervised functional classification problem , where @xmath120 is @xmath1-valued and @xmath121 takes values in @xmath137 .",
    "denote by @xmath138 the distribution of @xmath120 , @xmath139 .",
    "it is natural to ask whether the above mentioned universal consistency of the finite - dimensional @xmath3-nn classifiers still holds for the functional ( infinite - dimensional ) case .",
    "the answer is negative .",
    "there is , however , an additional technical condition which ( together with @xmath134 , @xmath135 ) , ensures weak consistency for the @xmath3-nn functional classifiers .",
    "while this condition is not in general trivial to check , it always holds whenever the regression function @xmath140 is continuous .",
    "the corresponding theory has been first developed by @xcite .",
    "in particular , the mentioned sufficient condition for consistency established by these authors is the following differentiability - type assumption ( on the distribution of @xmath136 ) , called _ besicovitch condition : _    @xmath141    here , @xmath142 denotes the closed @xmath143-ball centered at @xmath144 in the space of trajectories of the process @xmath144 . a weaker , slightly simpler version of this property , almost identical to the conclusion of lebesgue differentiation theorem , would be as follows , @xmath145    conditions ( [ besicovitch2 ] ) and ( [ besicovitch1 ] ) are clearly reminiscent of the conclusion of the classical lebesgue differentiation theorem ( see @xcite ) .",
    "clearly ( [ besicovitch2 ] ) implies ( [ besicovitch1 ] ) .",
    "it can be also seen that the @xmath138-a.s .",
    "continuity of @xmath146 is a sufficient condition for ( [ besicovitch2 ] ) .",
    "as mentioned above , ( * ? ?",
    "2 ) have proved that condition ( [ besicovitch2 ] ) together with @xmath134 and @xmath135 , ensures the weak consistency of a sequence of @xmath3-nn classifiers when @xmath120 takes values in a separable metric space . on the other hand ,",
    "@xcite have used ( [ besicovitch1 ] ) as a sufficient condition for the consistency of kernel classification rules .",
    "they also need some supplementary conditions on the sequence @xmath147 of smoothing parameters and the space @xmath1 : they require that the existence of a sequence of non - decreasing totally bounded subsets , @xmath148 , such that @xmath149 and a condition that relates the bandwidth @xmath150 with the metric entropy of the subsets @xmath151 .",
    "the following result shows that , in our case , the consistency holds for a class of `` regular '' distributions which is dense in the space of all distributions . in other words",
    ", the result shows that the assumption of continuity for the regression function @xmath152 ( which guarantees consistency for @xmath3-nn classifiers ) is in fact not very restrictive , as any possible distribution for @xmath136 may be arbitrarily approximated by another one which fulfils this continuity condition .",
    "[ ppp ] let us consider a binary supervised classification problem based on observations from @xmath136 , where @xmath120 is @xmath1-valued and @xmath121 is the binary variable indicating the class ( 0 or 1 ) .",
    "let @xmath126 be a sequence of @xmath3-nn classifiers such that @xmath153 and @xmath135",
    ".    whatever the distribution @xmath154 of @xmath136 there is another distribution @xmath98 , arbitrarily close to @xmath154 in the weak topology , under which the regression function @xmath155 is continuous with compact support and the sequence @xmath126 is weakly consistent .",
    "a simulation experiment has been carried out to illustrate a simple situation in which our `` visual distance '' could be especially suitable .",
    "the underlying model is very simple : the functional data are just `` corrupted '' trajectories of the absolute value of a brownian bridge ( absbb ) on @xmath33 $ ] . in the population @xmath114",
    "the absbb trajectories are perturbed by just adding to them a spiky function identically null on @xmath33 $ ] except for a triangular peak with basis 0.04 and height 1 , whose center is randomly chosen on the interval @xmath156 $ ] for some @xmath157 .",
    "the trajectories from @xmath115 are similarly constructed except that the center of the noise peak is randomly selected on @xmath158 $ ] for some @xmath159 .",
    "we have performed this experiment for two choices of @xmath160 .",
    "the first case ( model 1 , table [ tablesim1 ] left ) corresponds to the choice @xmath161 . in the second one ( model 2 , table [ tablesim1 ]",
    "right ) , we have taken @xmath162 , @xmath163 .",
    "table [ trajec ] shows two trajectories drawn from model 1 , ( in solid line , the trajectory drawn from @xmath114 ) .    in both examples",
    "the training samples are of size 100 ( 50 trajectories drawn from each population ) .",
    "the outputs of the tables correspond to the average missclassification proportions ( over 500 trajectories ) of test samples of size 100 ( 50 generated from each population ) .",
    "the trajectories are discretized on a grid of 100 equispaced points .    as for the choice of @xmath3 ,",
    "we have checked a reasonable range ( according to the sample size ) of values , in order to check  robustness \" with respect to @xmath3 .",
    "we limit ourselves to odd values of @xmath3 , from 3 to 9 , just to avoid ties in the classifier output .",
    "[ tablesim1 ]    .misclassification rates over 500 replications for different values of @xmath3 under model 1 ( left panel ) and model 2 ( right ) .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]     in this case the @xmath0-based classifiers are outperformed by those based on the supremum distance @xmath14 but are clearly better than those based on @xmath16 .",
    "it is curious to note the unstable behavior of @xmath16 , which is almost competitive in the cancer example but gets the worst performance both in the simulation study and in the coffee data example . on the other hand",
    ", @xmath14 ranked clearly the last one in the cancer example .",
    "the @xmath0-based methodology is never the worst one in the considered examples .",
    "again , more detailed experiments are needed to confirm or refute this provisory findings .",
    "the choice of a distance is particularly relevant when dealing with functional data . not only some classifiers ( as those of @xmath3-nn type or others based on depth measures ) are defined in terms of distances , but also the theoretical properties ( regarding consistency , convergence rates or asymptotic distributions ) must be necessarily established in terms of a given distance in the sample space .",
    "of course , in the finite - dimensional case , the use of different norms in the euclidean sample space can lead to different results in a classification problem . however , the case for considering different norms in this finite - dimensional situation is not very strong , due to the well - known fact that all the norms are equivalent in finite - dimensional normed spaces .",
    "our generic suggestion here is to consider geometrically motivated distances in functional data . the specific proposal we make ,",
    "@xmath78 is just one possibility ; several other alternatives might be considered .",
    "the book by @xcite could suggest some ideas in this regard . while our theoretical and practical results with the distance @xmath0 are encouraging ,",
    "it is also quite clear that this metric suffers from some limitations : first , we are restricted to non - negative functions .",
    "second , the extension of this idea to functions of several variables would probably involve considerable computational difficulties .",
    "third , much more theoretical development is needed ; in particular , the study of probability measures on the space @xmath2 is essential if we want to use theoretical models combined with the distance @xmath0 .",
    "in fact , this need for a deeper mathematical development is a common feature for most chapters of the , still young , fda theory .",
    "* proof of proposition [ prophaus ] *        we have , by definition of @xmath68 : @xmath167 assume @xmath168 .",
    "otherwise the result is trivial .",
    "let us suppose by contradiction that there is no pair @xmath169 such that ( [ hauslem1 ] ) is fulfilled . in any case , the compactness of @xmath42 and @xmath170 guarantees the existence of @xmath171 and @xmath172 fulfilling ( [ hauslem1 ] ) but , according to our contradiction argument , either @xmath27 or @xmath173 must be an interior point .",
    "for example , if @xmath174 , then @xmath175 . we will see that @xmath176 . for every @xmath177 $ ] such that @xmath178 let us denote @xmath179 and @xmath180 the intersection points of @xmath181 and the line @xmath182 ; with @xmath183 . from the assumption on @xmath27 , @xmath184 .",
    "this entails that @xmath185 and , since @xmath170 is a hypograph ( which implies that if @xmath186 then the segment joining @xmath187 and @xmath188 is included in @xmath170 ) it is clear that @xmath189 , for all @xmath177 $ ] with @xmath190 .",
    "therefore , if we move upwards the point @xmath171 to @xmath191 ( recall that from the usc assumption , @xmath192 ) , we have @xmath193 and then @xmath194",
    ". we can not have @xmath195 since @xmath196 and @xmath197 .",
    "so , we must have @xmath198 with @xmath199 . as a consequence",
    ", we must also have a point @xmath165 such that @xmath200 .",
    "this contradicts the assumption we made about the non - existence of such a pair @xmath201 .",
    "let us suppose that we are in the first case . by lemma [ lemhaus ]",
    "we can assume that @xmath210 .",
    "since @xmath204 and @xmath42 is a hypograph it must be @xmath211 , then @xmath212 from where it follows that @xmath205 . if we are in case 2 , again by lemma [ lemhaus ] , we can assume @xmath213 , as @xmath204 and @xmath170 is a hypograph it must be @xmath214 , then @xmath215 . from where it follows that @xmath205 .",
    "the inequality @xmath216 follows directly from the definition of @xmath68 .",
    "again , assume @xmath168 .",
    "by lemma [ lemhaus ] @xmath164 , @xmath165 , and @xmath223 .",
    "so it is enough to prove that @xmath224 and @xmath225 . since @xmath31 is continuous and @xmath164 , there are four possibilities : ( and the same holds for @xmath165 ) :    * @xmath217 is in the left border : @xmath226 with @xmath227 .",
    "* @xmath217 is in the right border : @xmath228 with @xmath229 .",
    "* @xmath217 is in the lower border : @xmath230 with @xmath231 .",
    "* @xmath217 is in the upper border : @xmath231 y @xmath232 .",
    "we now prove that @xmath217 can only be in case 4 .",
    "it is clear that case 3 is not possible because both functions are non - negative .",
    "cases 1 and 2 are also excluded following the ideas used in lemma [ lemhaus ] .",
    "for example , let us suppose that we are in case 1 ( see figure [ hausdist3 ] ) .",
    "first observe that @xmath233 ; otherwise there would exist @xmath234 , then , the segment joining the points @xmath235 and @xmath236 ( which is included in @xmath170 ) intersects @xmath237 . but",
    "this contradicts @xmath197 .",
    "so we conclude @xmath238 .",
    "however @xmath239 leads to a contradiction with the definition of @xmath86 .",
    "also , @xmath240 leads to another contradiction .",
    "indeed , if this were the case , we would have two points ( @xmath241 and @xmath242 ) on the vertical axis @xmath243 which are equidistant to the hypograph @xmath170",
    ". then we have three possibilities :              \\(a ) to state the local compactness we will in fact prove a slightly stronger property : we will show that any closed and bounded set in @xmath2 is compact .",
    "indeed , this would imply that the closed balls are compact .",
    "since the family of balls with center at a given point is a local base , the local compactness will follow",
    ".    since we are in a metric space compactness is equivalent to sequential compactness .",
    "let us take @xmath252 a bounded sequence ; we will prove that this sequence has necessarily a convergent subsequence . to see this , note that the corresponding sequence of compact sets @xmath253 is bounded .",
    "so it has convergent subsequence , which we may denote again by @xmath253 , in the hausdorff metric ( since the closed and bounded sets are compact in the space of compact sets with the hausdorff metric ) .",
    "denote by @xmath254 the limit of that subsequence .",
    "therefore it is enough to prove that @xmath255\\rightarrow [ 0,\\infty)\\mbox { , such that } c = h_{f}.      \\label{hfc}\\end{aligned}\\ ] ]    let us take @xmath256 and @xmath257 converging to @xmath258 ; note that there exists at least one such sequence because @xmath259 .",
    "now , since the @xmath253 are hypographs the vertical segment @xmath260 $ ] joining the points @xmath261 and @xmath262 is included in @xmath253 .",
    "so @xmath263 , implies @xmath264\\subset c.\\ ] ] indeed , since @xmath253 is a hypograph , @xmath265 .",
    "then if we take @xmath266 we obtain @xmath267 and @xmath268 .",
    "let us now define @xmath34\\rightarrow [ 0,\\infty)$ ] by @xmath269 since @xmath270 is bounded , @xmath31 is well defined as a real - valued function .",
    "let us prove that @xmath271 . since @xmath254 is closed , we have , by ( [ inc ] ) , @xmath272 .",
    "moreover , if @xmath256 , taking @xmath273 with @xmath257 , @xmath274 , we obtain @xmath275 .    it remains to prove that @xmath31 is usc .",
    "suppose by contradiction that there exists @xmath276 $ ] such that @xmath277 .",
    "then , we can take a constant @xmath278 and a sequence @xmath279 , @xmath280 for all @xmath109 such that @xmath281 for @xmath109 large enough , say @xmath282 . by the definition of @xmath31 , for every @xmath283 we can take a sequence @xmath284 ( dependent on @xmath109 ) , such that @xmath285 .",
    "given a partition @xmath296 and a set @xmath297 of rational numbers , let us define @xmath298\\\\          \\max\\{q_i , q_{i+1}\\ } & \\text { if } x = x_i \\quad 1 \\leq i \\leq n-2      \\end{cases}\\ ] ] it is immediately seen that this function is usc and bounded .",
    "let us see that the ( numerable ) set of all functions defined by [ dens ] , for all possible partitions @xmath295 and rational values @xmath299 is dense in @xmath38 with respect to @xmath68 .",
    "let @xmath31 be a non - negative usc function and take @xmath286 .",
    "consider @xmath300 a partition of the form @xmath292 where @xmath293 are rational numbers and such that @xmath301 . by proposition [ propusc ]",
    "there exists @xmath302 } f(x)$ ] .",
    "let us take @xmath297 rational numbers such that @xmath303 and @xmath304 for all @xmath305",
    ". for this partition and this set of rational numbers let us define @xmath306 as in ( [ dens ] ) .",
    "now we claim that @xmath307 .",
    "indeed , it is clear that @xmath308 for all @xmath309 $ ] so that @xmath310 , and @xmath311 given @xmath312 , there exists @xmath313 such that @xmath314 .",
    "now , choose @xmath315 such that @xmath316 and @xmath317 .",
    "we have @xmath318 and then @xmath319 .",
    "since @xmath320 was an arbitrary point in @xmath321 we finally get @xmath322 .",
    "\\(b ) by proposition [ propusc ] ( i ) we know that there exists @xmath323 $ ] such that @xmath324 } f(x)$ ] . as @xmath57 there exist @xmath325 such that @xmath326",
    ". then , @xmath327 } f_n(x)$ ] and , since @xmath328 , we obtain @xmath97 } f(x ) = f(z)\\leq \\liminf_{n\\rightarrow + \\infty }   \\max_{x\\in[0,1 ] } f_n(x ) \\leq \\limsup_{n\\rightarrow + \\infty }   \\max_{x\\in [ 0,1 ] } f_n(x).\\ ] ] finally , let us prove that @xmath329 } f_n(x ) \\leq \\max_{x\\in [ 0,1 ] } f(x)$ ]",
    ". denote @xmath330 } f_n(x)$ ] .",
    "there exists @xmath331 $ ] such that @xmath332 with @xmath333 } f_n(x)$ ] .",
    "taking if necessary a subsequence , we can assume that @xmath334 $ ] .",
    "since @xmath335 we have @xmath336 then @xmath337 }",
    "f(x)\\geq z_0 $ ] .",
    "this result is just a direct corollary from th . 2 in @xcite ( recall that the continuity of @xmath152 is a sufficient condition for ( [ besicovitch2 ] ) ) , combined with the fact that the regression function @xmath338 ( i.e. , the regression function under @xmath154 ) can be approximated by a continuous compact supported function ; we use here the local compactness of @xmath1 ( see @xcite , proposition 7.9 ) .",
    "indeed , note that the joint distribution of @xmath136 is completely determined by @xmath155 and by the marginal distribution @xmath138 of @xmath120 .",
    "then , given @xmath154 , one can construct @xmath98 by just approximating @xmath338 by a continuous compact - supported function @xmath339 which , without loss of generality , can be taken @xmath340 . then , the distribution @xmath98 determined by @xmath341 and the marginal distribution @xmath138 of @xmath120 is arbitrarily close to @xmath154 ( just taking @xmath341 close enough to @xmath146 ) . indeed , given any borel set @xmath342 , consider the sets @xmath343 and @xmath344",
    ". then , @xmath345 and @xmath346 which can be made arbitrarily close .",
    "alt , h. , bra , p. , godau , m. , knauer , c. , and wenk , c. ( 2003 ) .",
    "computing the hausdorff distance of geometric patterns and shapes .",
    "in _ discrete and computational geometry , pp .",
    "6576 , b. aronov , s. , basu , j. pach and m. sharir eds .",
    "springer berlin heidelberg .",
    "_      ballo , a. , cuevas , a. and fraiman , r. ( 2011a ) .",
    "classification methods for functional data . in _ the oxford handbook of functional data analysis , pp . 259297 , f. ferraty and y. romain eds .",
    "oxford university press , oxford .",
    "_      barba , i. , mir - casas , e. , pladevall , e. , sebastin , r. , berrendero , j.r . ,",
    "torrecilla , j.l . ,",
    "cuevas , a. and garca - dorado , d. ( 2015 ) .",
    "high fat diet induces metabolic changes associated to increased oxidative stress in male hearts .",
    "_ manuscript .",
    "_          coombes , k.r . , baggerly , k.a . and morris , j.s .",
    "pre - processing mass spectrometry data . in _ fundamentals of data mining in genomics and proteomics , pp . 79102 , w. dubitzky , m. granzow and d. berrar eds .",
    "springer , new york ."
  ],
  "abstract_text": [
    "<S> a functional distance @xmath0 , based on the hausdorff metric between the function hypographs , is proposed for the space @xmath1 of non - negative real upper semicontinuous functions on a compact interval . </S>",
    "<S> the main goal of the paper is to show that the space @xmath2 is particularly suitable in some statistical problems with functional data which involve functions with very wiggly graphs and narrow , sharp peaks . </S>",
    "<S> a typical example is given by spectrograms , either obtained by magnetic resonance or by mass spectrometry . on the theoretical side , we show that @xmath2 is a complete , separable locally compact space and that the @xmath0-convergence of a sequence of functions implies the convergence of the respective maximum values of these functions . </S>",
    "<S> the probabilistic and statistical implications of these results are discussed in particular , regarding the consistency of @xmath3-nn classifiers for supervised classification problems with functional data in @xmath0 . on the practical side </S>",
    "<S> , we provide the results of a small simulation study and check also the performance of our method in two real data problems of supervised classification involving mass spectra .    </S>",
    "<S> # 1    0    0    1    0    * on visual distances for spectrum - type functional data *    _ key words : supervised classification , functional data analysis , hausdorff metric . </S>"
  ]
}