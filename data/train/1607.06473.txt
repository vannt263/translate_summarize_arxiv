{
  "article_text": [
    "quantum annealing ( qa ) aims to solve computational problems by using a guided quantum drive .",
    "the dynamics is generated by a time - dependent hamiltonian along a trajectory that ends at a final target hamiltonian whose ground state contains the solution of the problem  @xcite .",
    "qa is based on the adiabatic theorem , which guarantees that if the hamiltonian is changed sufficiently slowly , transitions to excited states are suppressed during the adiabatic evolution , thus preparing states that are close to the target ground state .",
    "unfortunately , the adiabatic condition that ensures that the system remains in the instantaneous ground state leads to long time scales for the solution of the hard computational problem .",
    "the adiabatic trajectory is not the only path to reaching the ground state of a final hamiltonian encoding the solution of the computational problem .",
    "more generally , one could imagine many other paths , including those where the hamiltonian is varied rapidly , that land at the desired state or , of practical interest , reach low energy states .",
    "in fact , it has been already found that for certain hard instances of problems , fast , nonadiabatic paths can sometimes prevent the system from getting stuck at local minima , thus improve the search results  @xcite . the variational quantum algorithm ( vqa )",
    "is an example where one searches for such possible paths , using optimization of the outcome via the variation of a fixed number of parameters . a hybrid machine , combining classical optimization and quantum evolution , optimizes the variational parameters .",
    "such hybrid variational approaches have proven useful in the context of quantum state preparation  @xcite .",
    "recently , ref .",
    "@xcite introduced a variational quantum eigensolver ( vqe ) for applications in quantum chemistry .",
    "this idea was further explored in @xcite and experimentally tested in @xcite . in a related approach @xcite , farhi _ et al .",
    "_ introduced a quantum approximate optimization algorithm ( qaoa ) for combinatorial optimization problems based on a parameterized square - pulse ansatz for dynamical evolution of the solver .    in this paper",
    ", we make a connection between vqa and optimal control theory  @xcite .",
    "vqa is essentially an adaptive feedback control @xcite of a quantum system with the objective function encoding the solution of a computational problem , see fig .",
    "[ fig : vqa](a ) .",
    "it utilizes a hybrid system comprised of a classical computer that searches for the optimal variational protocol using measurements done on a quantum machine , which generates the final states for variational protocols , via a closed - loop learning method @xcite .        using pontryagin s minimum principle of optimal control , we show that the optimal protocol for vqa has a `` bang - bang '' form .",
    "our results put the bang - bang ansatz of qaoa on a rigorous ground in contrast to vqa with a continuous - time evolution .",
    "a comparison of the performance of the optimal nonadiabatic bang - bang protocol with quantum adiabatic algorithm ( qaa ) demonstrates that the former reduces error in the final state by orders of magnitude .",
    "furthermore , we perform a quantitative analysis of the characteristics of these optimal protocols .",
    "we numerically find a system - size independent distribution function for the duration of individual pulses , which may facilitate the development of effective algorithms for the classical optimizer .",
    "consider a computational optimization problem such as finding a sequence of @xmath0 bits that minimizes a certain function of all of the bits . to solve this problem with vqa",
    ", we consider a system of @xmath0 qubits with a parameterized hamiltonian @xmath1 generically , we can cast the problem into generating a state @xmath2 that minimizes a certain cost function such as the expectation value of an operator @xmath3 with respect to @xmath2 .",
    "a common example is finding the ground state of a disorderd classical ising hamiltonian @xcite , where the operator @xmath3 is a hamiltonian diagonal in the computational basis . in the context of quantum chemistry",
    ", vqe considers the operator @xmath3 to be the hamiltonian of a molecule @xcite .",
    "the essence of vqa , as depicted in fig .",
    "[ fig : vqa ] , is finding the time - dependent parameters @xmath4 over a time period @xmath5 such that @xmath6 minimizes a cost function @xmath7 .",
    "generically , the controls @xmath4 belong to a permissible set determined by the experimental setup .",
    "a common such set is given by simple bounds as seen in eq .",
    "the ideal solution could be a unique state @xmath8 [ as depicted in fig.[fig : vqa](b ) ] that is the ground state of the target hamiltonian or more generally a set of states in the hilbert space with an optimal figure of merit .",
    "one can either fix the initial state @xmath9 or add it to the list of the variational parameters ( here we fix it motivated by experimental constraints ) . generally , the longer the total time @xmath5 , the closer we can get to an ideal solution .",
    "one way to view this is to consider the reachable set of all the final states one can reach by using one of the infinite number of permissible controls .",
    "the reachable set , naturally , grows with @xmath5 ( in fact , if @xmath10 is allowed , the reachable set for @xmath11 is strictly a subset of the reachable set for @xmath12 ) . as seen in fig .",
    "[ fig : vqa](b ) , there could be a critical time beyond which the reachable set includes the target state and an exact solution is possible .",
    "there is no advantage in increasing @xmath5 beyond this critical time .",
    "generically , for smaller @xmath5 , where the reachable set does not include the target state , the optimal protocols are highly constrained as they should prepare the closest point(s ) of the reachable set to the target . for times longer than the critical time mentioned above , we expect an infinite number of protocols to produce the target and the evolution has extra time to meander in the hilbert space .",
    "our strategy is to fix @xmath5 and find the best variational protocol @xmath4 .",
    "if the solution is not acceptable , we can increase @xmath5 .",
    "next we present how pontryagin s minimum principle from optimal control theory determines the form of optimal @xmath4 functions .",
    "the parameters in hamiltonian   are generically constrained by their range : @xmath13 during the evolution @xmath14 .",
    ".   implies that , by assumption , each @xmath15 can be tunned in the above range independently of the values of the other control parameters . for fixed initial state @xmath9 ,",
    "the coupling constants @xmath4 uniquely determine the final wave function .",
    "consequently the cost function , which we take as an arbitrary function of the final state , is a functional of @xmath4 @xmath16={\\cal f}(|\\psi(t)\\rangle).\\ ] ]    the pontryagin s minimum principle  @xcite is directly applicable here . briefly",
    ", this theorem states that for a set of dynamical variables @xmath17 evolving from given initial values @xmath18 with the equations of motions @xmath19 , where @xmath20 are a set of control functions , the control functions @xmath21 that minimize an arbitrary function @xmath22 $ ] of the final values of the dynamical variable satisfy @xmath23 at any point in time and for each of the control functions .",
    "the optimal - control hamiltonian is defined as @xmath24 for conjugate variables @xmath25 that evolve as @xmath26 with boundary conditions @xmath27 $ ] . here",
    "the `` @xmath28 '' superscript indicates the optimal solution corresponding to @xmath21 .",
    "an important consequence of eq .",
    "is that if the equations of motion for @xmath17 , and consequently the optimal - control hamiltonian @xmath29 , are linear in @xmath30 , generically , the optimal protocol is bang - bang , i.e. , at any time during the evolution we have @xmath31 or @xmath32 .",
    "this follows from the fact that at any point in time we need to choose @xmath15 to minimize @xmath33 .",
    "if the sign of the coefficient of @xmath15 in the optimal - control hamiltonian is positive ( negative ) , we should then choose the smallest ( largest ) @xmath15 from the permissible range  .",
    "in other words , the optimal protocol for each control function involves a sequence of sudden jumps between its minimum and maximum permissible values .",
    "the only caveat for the above argument is the possibility that the coefficient of a particular @xmath15 in @xmath33 vanishes over a finite interval ( since the sign of this coefficient determines whether we should choose the minimum or maximum value ) .    in the quantum mechanical context , if the physical hamiltonian is linear in the controls , the equations of motion and consequently the optimal - control hamiltonian will also be linear , giving rise to bang - bang protocols as verified in several recent studies on optimal topological quantum computing  @xcite . to find the protocol @xmath20 that minimizes the cost function in our case , we expand the wave function in a complete orthonormal basis , e.g. , the computational basis @xmath34 as @xmath35 and treat the real and imaginary parts of the amplitudes @xmath36 as dynamical variables , which evolve according to the schrdinger equation @xmath37,\\\\ \\dot{a}^i_z&=&{1\\over 2}\\sum_{\\alpha , z ' } g_\\alpha \\left[-\\left(h_\\alpha^{zz'}+h_\\alpha^{z'z}\\right)a^r_{z ' }",
    "-i\\left(h_\\alpha^{zz'}-h_\\alpha^{z'z}\\right)a^i_{z ' } \\right],\\end{aligned}\\ ] ] where @xmath38 and @xmath39 .",
    "clearly , these equations of motion are linear in the control functions @xmath15 and the cost function   is a function of only the final values of the dynamical variables .",
    "thus , the argument above holds and the optimal protocol is generically bang - bang regardless of the number of variational parameters .      from practical point of view , it is important to assess the validity of the closed system findings in the presence of decoherence .",
    "again , a straightforward application of the pontryagin principle extends the above results for a closed system evolution to an open quantum system with markovian dynamics described by a lindblad equation @xmath40+\\sum_\\beta f_\\beta(t)\\left(2f_\\beta \\ \\rho \\",
    "f^\\dagger_\\beta-\\left\\{f^\\dagger_\\beta f_\\beta,\\ \\rho\\right\\}\\right ) \\label{eqlindblad}\\ ] ] where the optimal protocol @xmath41 , if controllable , are of type bang - bang .",
    "this is due to the linearity of the dynamical equation ( [ eqlindblad ] ) .",
    "a decoherence operator @xmath42 can represent either noise in the hamiltonian parameters ( in which case , @xmath42 is hermitian  @xcite ) or an engineered bath  @xcite . in the former case ,",
    "@xmath43 s are constant rates of noise processes and in the latter , @xmath44 s are control knobs that the pontryagin s minimum principle says should vary in bang - bang form for an optimal protocol . in the rest of the paper , we only focus on closed systems schrdinger dynamics .",
    "we now focus on a canonical problem in combinatorial optimization , namely the sherrington - kirkpatrick ( sk ) ising spin glass @xcite with the energy function @xmath45 where @xmath46 and @xmath47 are independent gaussian random variables with zero mean and variance @xmath48 , and each @xmath49 spin can take the values @xmath50 . the goal is to minimize @xmath51 over all the @xmath52 spin configurations .",
    "a multitude of practical combinatorial optimization problems map to this model .",
    "the computational cost of finding the minimum with classical algorithms is exponential in @xmath53 .    in analogy with the simple instances of quantum annealing , we focus on the case with only one control function @xmath54 and use the following parameterized hamiltonian : @xmath55b,\\ ] ] with the operator @xmath56 representing a transverse field , which generates quantum fluctuations .    for the initial state , we choose the ground states of @xmath57 .",
    "it is easy to prepare product state @xmath58 commonly used in other schemes such as the qaa . here",
    "@xmath59 and @xmath60 .",
    "we would like to minimize the cost function @xmath61 . in the adiabatic scheme , a smooth ramp such as @xmath62",
    "is applied for @xmath14 and we can generate large overlap with the ground state of @xmath51 in the limit of large @xmath5 . here , we allow for arbitrary time dependence of the control function in the fixed range @xmath63 . according to the general argument above , the optimal solution is bang - bang .",
    "as discussed in the introduction , in vqa a classical optimization algorithm commands a quantum system to find the optimal protocol variationally from measurement of the cost function for many protocols .",
    "this requires many repetitions and it is to our advantage to use the shortest possible time @xmath5 for which the final state has an acceptable overlap with the ground state of @xmath51 ( projective measurement is ultimately used in generating the ground state ) . in the adiabatic scheme ,",
    "we only need one shot but there are important restrictions from the small energy gaps along the adiabatic trajectory ( vqa is insensitive to instantaneous ground states and spectral gaps ) , which can lead to exceedingly long time scales , over which quantum coherence can not be even approximately sustained .",
    "furthermore , the presence of noise or modulation in the control fields places important limitations on adiabatic schemes due to the emergence of the recently proposed noise - induced anti - adiabaticity in the long - time limit  @xcite .    given the limitations of adiabatic scheme ,",
    "a quantum approximate algorithm has been introduced for solving combinatorial optimization problems  @xcite in the spirit of vqa .",
    "the algorithm of ref .",
    "@xcite uses an ansatz @xmath64 where the evolution operators are given by @xmath65 and @xmath66 .",
    "the integer @xmath67 is a parameter characterizing a variational ansatz .    for a given @xmath67 ,",
    "the goal of the algorithm is to find a set of variational parameters that minimizes the expectation value of @xmath68 , which ensures that the state @xmath69 approaches the ground state of @xmath51 .",
    "physically , the ansatz describes time evolution for a total time @xmath70 , and a sequence of sudden switching between the hamiltonians @xmath57 and @xmath51 .",
    "while this ansatz with a finite @xmath67 is an intelligent guess , the result that we derived using pontryagin s minimum principle implies that given bounded independent control of hamiltonian terms , the ansatz ( [ eq : ansatz ] ) is the true choice for a vqa approach to optimization .",
    "so far we have not discussed how large @xmath67 is or even if it is finite .",
    "this requires an analysis of the characteristic time scales of the pulses , which we carry out in what follows .",
    "we start by verifying for small system sizes and short annealing times that the optimal annealing protocol is indeed bang - bang , by using a metropolis monte carlo ( mc ) algorithm , which makes no assumptions about the nature of the protocol .",
    "we divide the total time @xmath5 into @xmath71 slices and use a piece - wise constant protocol with @xmath71 pieces of duration @xmath72 .",
    "the method approaches an unbiased optimization , i.e. , it explores all permissible controls and chooses the optimal one , if the protocols obtained converge upon increasing @xmath71 .",
    "we then proceed by carrying out a mc simulation starting from random initial protocols , without any assumption regarding the bang - bang nature of the protocol . in each step ,",
    "we slightly change the control parameter @xmath73 in a randomly chosen discretized time interval .",
    "if the cost function gets smaller , we accept the attempt ; if the cost function gets larger , we accept the attempt with probability @xmath74 , where @xmath75 is a fictitious temperature that is gradually reduced to zero .    in fig .",
    "[ fig : protocol](a ) , we show the optimal protocol obtained from such mc simulation for a fixed instance of hamiltonian ( [ eq1 ] ) with @xmath76 spins and total time @xmath77 .    ) with @xmath76 spins and total annealing time @xmath77 .",
    "different colors represent different initial protocols .",
    "the plots are for @xmath78 , but the optimal protocol does not change upon increasing @xmath71 .",
    "( b ) a typical protocol obtained for a given instance of hamiltonian ( [ eq1 ] ) with @xmath76 spins and @xmath79 , using a classical optimization solver .",
    "we start from a uniform initial protocol with @xmath71 slices such that @xmath80.,width=328 ]    indeed , the mc simulation converge to a bang - bang protocol for different initial protocols in agreement with the pontryagin s minimum principle . despite the convergence for short total time",
    ", the mc simulations often fail to converge for longer times and larger systems , signaling the difficulty of implementing vqa without any a priori knowledge about the form of the optimal protocol .",
    "however , based on the mathematical proof of the bang - bang nature of the optimal protocols , we can parameterize the protocol similar to qaoa @xcite and use the durations of the pulses as variational parameters to be optimized with the interior - point minimization method ( ipmm ) , increasing @xmath67 to achieve convergence .",
    "we have checked that ipmm results are indeed in agreement with mc results , e.g. , fig .",
    "[ fig : protocol](a ) ( it also runs much faster ) . in fig.[fig : protocol](b ) , we show a typical optimized protocol obtained with ipmm for a certain instance of hamiltonian ( [ eq1 ] ) with @xmath76 spins and @xmath79 . guided by mc results , we choose around @xmath81 variational parameters , which proved to be adequate ( we converged to a smaller number of bangs than we allowed in the ansatz ) .",
    "we now turn to the critical question of the time scales of the pulses .",
    "we observe numerically and then argue analytically that the typical time scale of each bang is independent of the system size , and is only determined by some characteristic energy scale of hamiltonian ( [ eq1 ] ) .",
    "therefore , from a complexity theory perspective , this result implies that the hardness of the optimization problem should translate into the number of pulses and/or the hardness of the protocol optimization . in fig .",
    "[ fig : distribution ] we plot the distribution of the time scales of each bang @xmath82 for system sizes @xmath83 and 7 . for each system size , we fix the total annealing time to be @xmath79 , and average over 50 instances of the hamiltonian ( [ eq1 ] ) .     and 7 . the total annealing time is fixed to be @xmath79 , leading to an average success rate around @xmath84 , depending on the system sizes .",
    "each curve is averaged over 50 instances of hamiltonian ( [ eq1]).,width=302 ]    we find that the distributions for the bang time collapse for different system sizes , and peak at almost the same value .",
    "this observation suggests a universal average distribution of the bang times for the near optimal protocols , and a typical time scale ( peak or average value ) that is independent of the system size .",
    "although we have only considered a few system sizes , the dependence on @xmath53 is extremely weak and we expect our results to extrapolate to large @xmath53 .    as shown in the appendix , the typical time scale of the interval @xmath85 is given by the first root for @xmath86 of the following function : @xmath87 \\label{eqn20}\\ ] ] where @xmath88 is the energy of configuration @xmath89 , @xmath90 is the configuration @xmath89 with the @xmath91-th spin flipped , @xmath92 is the conjugate momentum of @xmath93 , and @xmath94 is the beginning of a bang with @xmath95 . while we can not derive analytically the average first root for @xmath86 from eq .  , one can see that the only time dependence in eq .",
    "( [ eqn20 ] ) within the current interval is in @xmath96 .",
    "thus , the energy difference @xmath97 , which has zero mean ( as both @xmath88 and @xmath98 clearly have zero mean ) and variance @xmath99 , sets the characteristic time scale proportional to @xmath100 observed in fig .  [",
    "fig : distribution ] .",
    "importantly , this time scale is finite , distinguishing our bang - bang type optimal protocol from the trotterization of generic protocols , where the duration of individual pulses must be taken to zero . while the above scaling argument suggests system size independence , an analytical derivation of the distribution in fig .",
    "[ fig : distribution ] has remained elusive .",
    "finally we comment on the performance of our protocols .",
    "the cost function we minimize is the expectation value @xmath101 . minimizing the energy expectation value results in larger overlap with the ground state of @xmath51 .",
    "as expected , the time scales for our protocols are significantly shorter than those of the adiabatic algorithm with similar success rate . a comparison between the optimal bang - bang protocols and linear ramps @xmath102 is shown in fig .",
    "[ fig : error ] .",
    "the energy @xmath101 and the errors @xmath103 are averaged over the 20 instances ( out of 50 generated realizations ) with the highest success rates , for the optimal bang - bang protocol and linear qaa ramp respectively .",
    "remarkably , we find that for the same amount of time , the nonadiabatic bang - bang protocol on average beats the linear ramp ( commonly used in qaa ) by orders of magnitude .",
    "of course , in practice one needs to include the overhead of searching for the optimal solution , and understand how it scales as function of system size .",
    "we have shown that the optimal vqa with bounded linear control parameters is of the bang - bang form .",
    "we verified this prediction by finding numerically the optimal protocol that minimizes the energy of a sk spin glass .",
    "moreover , we find that the optimal nonadiabatic bang - bang protocol reduces error by orders of magnitude when compared to qaa within the same running time .",
    "we argue that the characteristic time scale between bangs is fixed by the energy scales in the problem and is independent of system size , which we confirmed numerically .",
    "the finding that the time scale for each pulse is size - independent would constrain the number of variational parameters to scale with the running time allotted for the protocol .",
    "our results , that the bang - bang protocols are optimal and the bang time is size - independent , inform the search for effective hybrid classical - quantum machine learning schemes for solving combinatorial optimization problems .",
    "here we show that the pontryagin s minimum principle can tell about not only the form of optimal solution for vqa but also when the pulses should be switched on and off .",
    "we analyze the dynamical equations for the sk model studied in the main text .    using the computational basis @xmath104",
    ", we represent the wave function as @xmath105 .",
    "the initial state with all the spins in the @xmath106 direction corresponds to @xmath107 , and the schrdinger equation reads @xmath108\\sum_{k=1}^n a_{\\bar { z}(k)}(t),\\ ] ] with @xmath109 , where @xmath110 represents a flipped spin with respect to @xmath111 and @xmath88 is the energy function we would like to minimize . in terms of the real and imaginary parts of @xmath112 , we can then write @xmath113\\sum_{k=1}^n i_{\\bar { z}(k)}(t),\\\\ \\partial_t i_z(t)&=&-g(t)c_zr_z(t)-[1-g(t)]\\sum_{k=1}^n r_{\\bar { z}(k)}(t).\\end{aligned}\\ ] ] introducing conjugate momenta @xmath114 and @xmath115 respectively for the real and imaginary parts of @xmath36 , the explicit form of the optimal - control hamiltonian is given by @xmath116\\\\ & + [ 1-g(t)]\\sum_{k=1}^n \\left[p_z(t)i_{\\bar { z}(k)}(t)-q_z(t)r_{\\bar { z}(k)}(t)\\right]\\bigg\\}. \\end{split}\\ ] ]    the equations of motion for the conjugate momenta are @xmath117 and @xmath118 , which can be written explicitly as @xmath119\\sum_{k=1}^n q_{\\bar { z}(k)}(t),\\\\ \\partial_t q_z(t)&=&-g(t)c_zp_z(t)-[1-g(t)]\\sum_{k=1}^n p_{\\bar { z}(k)}(t),\\end{aligned}\\ ] ] where we have used the relationships @xmath120 and @xmath121 .",
    "the cost function @xmath122=\\sum_z|a_z(t)|^2c_z\\ ] ] leads to the following boundary conditions at @xmath123 for the conjugate momenta : @xmath124 clearly @xmath54 uniquely determines @xmath36 . from @xmath125 and",
    "the expression above , we can find @xmath126 and @xmath127 , solve the equations of motion backward in time and determine the conjugate momenta as a function of time .",
    "therefore , @xmath54 also uniquely determines @xmath114 and @xmath115 .",
    "the potryagin s minimum principle states that the optimal protocol @xmath128 satisfies @xmath129 where @xmath130 are the corresponding optimal solution . as argued in sec .",
    "[ sec : pontryagin ] , @xmath128 is bang - bang and can only take two values of @xmath131 and @xmath132 .",
    "which value will depend on the sign of @xmath133 given by the expression @xmath134\\\\ & -\\sum_{k=1}^n \\left[p^*_z(t)i^*_{\\bar { z}(k)}(t)-q^*_z(t)r^*_{\\bar { z}(k)}(t)\\right]\\bigg\\}. \\end{split } \\label{eq : coeff}\\ ] ]      let us first combine @xmath135 and @xmath136 into one complex momentum @xmath137 as we argued above , the optimal protocol is bang - bang with @xmath138 . in any interval with @xmath85 , we can write @xmath139 where @xmath94 is the beginning of the current bang @xmath95 .      the above equation allows for an estimation of the typical time scale of the interval @xmath85 .",
    "suppose at some @xmath94 , @xmath54 switches from 0 to 1 , i.e. a bang starts .",
    "from the discussion above , we know that at @xmath142 we must have @xmath143 .",
    "the time when the bang stops corresponds to the next @xmath86 when @xmath144 .",
    "more explicitly , in the interval @xmath85 , eq . ( [ eq : coeff ] ) can be written as : @xmath87,\\ ] ] which is exactly eq .   in sec .",
    "[ sec : numerical ] .",
    "p. omalley , r. babbush , i. kivlichan , j. romero , j. mcclean , r. barends , j. kelly , p. roushan , a. tranter , n. ding , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , a. fowler , e. jeffrey , a. megrant , j. mutus , c. neill , c. quintana , d. sank , a. vainsencher , j. wenner , t. white , p. coveney , p. love , h. neven , a. aspuru - guzik , j. martinis .",
    "rev . a * 6 * , 031007 ( 2016 ) ."
  ],
  "abstract_text": [
    "<S> we use pontryagin s minimum principle to optimize variational quantum algorithms . </S>",
    "<S> we show that for a fixed computation time , the optimal evolution has a bang - bang ( square pulse ) form , both for closed and open quantum systems with markovian decoherence . </S>",
    "<S> our findings support the choice of evolution ansatz in the recently proposed quantum approximate optimization algorithm . focusing on the sherrington - kirkpatrick spin glass as an example </S>",
    "<S> , we find a system - size independent distribution of the duration of pulses , with characteristic time scale set by the inverse of the coupling constants in the hamiltonian . </S>",
    "<S> we numerically demonstrate that our optimal nonadiabatic bang - bang protocols can outperform quantum annealing by orders of magnitude within the same running time . </S>",
    "<S> the optimality of the bang - bang protocols and the characteristic time scale of the pulses inform the search for effective hybrid ( classical and quantum ) machine learning schemes for tackling combinatorial optimization problems . </S>"
  ]
}