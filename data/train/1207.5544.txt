{
  "article_text": [
    "in this appendix we apply the described security method to the explained version of the cow protocol  @xcite . in particular , we consider signal blocks carrying @xmath0  bits of information . since a single bit comprises two modes , one has @xmath65 different temporal modes described by their creation and annihilation operators @xmath88 and @xmath89 , respectively , with @xmath90 .",
    "we assume that the @xmath91-th bit relates to the modes with @xmath92 .    _",
    "real and assumed measurement description._at first let us concentrate on the real measurement model @xmath93 and the way how we describe it in the security part , denoted as @xmath43 in the main text . for the real measurement setup we assume inefficient photon number resolving detectors that suffer from state - independent dark counts .",
    "the inefficiency of @xmath93 is modelled by a global beamsplitter ( bs ) of transmittance @xmath94 located in front of a perfectly efficient scheme , labelled as @xmath95 , that still suffers from dark counts .",
    "this is schematically drawn in the first line of fig .",
    "[ fig : measurements ] . in a second step ,",
    "one models the efficient scheme @xmath95 as a map @xmath96 , sometimes called squashing or filter operation  @xcite , in front of the assumed description @xmath43 .",
    "let us emphasize that the security simulation is valid for any true measurement scheme that can be modelled as a physical map @xmath97 followed by the measurement @xmath43 as shown in the third line of the figure .",
    "there are three different types of outcomes for the so far abstract outcome label `` @xmath98 '' . for a data line measurement",
    "we use @xmath99 , with @xmath100 , to denote a single photon detection in temporal mode @xmath99 only . the corresponding measurement operator @xmath101 is given by @xmath102 with @xmath103 representing the dark count probability of bob s detectors and @xmath104 .",
    "in addition to a data line measurement bob can also perform coherence measurements on subsequent bits employing the monitoring line .",
    "for instance , whenever he tests the coherence between bits @xmath91 and @xmath105 he effectively mixes the modes @xmath106 and , at the same time , @xmath107 . for each pair of modes",
    "there are two single photon events , denoted as @xmath108 , that can be distinguished , depending on whether the single excitation is registered in the bright ( @xmath109 ) or in the dark ( @xmath110 ) detector . as an outcome label for the coherence measurements we use @xmath111 , where @xmath112 denotes the first of the two interfering modes . in this case",
    "the measurement operators are given by @xmath113 with @xmath114 .",
    "let us emphasize that in these coherence measurements it is still necessary to check that all other modes are empty .",
    "finally , note that each measurement setting has also other possible outcomes , _",
    "e.g. _ ,  no click \" or more than a single photon detection event .",
    "all these cases are grouped ( via classical post - processing ) into a single inconclusive outcome described by @xmath115 .    as the modelled measurement operators @xmath43 we use @xmath116 where @xmath117 is the auxiliary state that describes the inconclusive outcome .",
    "these measurement operators @xmath43 act on a @xmath118 dimensional hilbert space .",
    "both measurement sets can be made equivalent by an appropriate map @xmath119 such that @xmath120 $ ] holds for all possible states @xmath121 and measurement outcomes `` @xmath98 '' as schematically shown in fig .",
    "[ fig : measurements ] .",
    "this map @xmath119 is given as follows .",
    "first one measures the total number of photons @xmath122 within an arriving block . whenever one finds @xmath123 one outputs the auxiliary state @xmath117 .",
    "if @xmath124 then with probability @xmath125 the single photon state stays untouched , otherwise the auxiliary state is thrown again .",
    "finally , for @xmath126 the map creates the completely mixed single photon state @xmath127 with probability @xmath128 and @xmath117 otherwise .",
    "this map is physical because we explicitly describe it in terms of measurements and conditional signal state preparations .",
    "_ source state and reduced density matrix._ the following discussion provides the source states for both cases of pure or phase randomized cow block signals .",
    "these states determine the reduced density matrix @xmath129 which belongs to the available information .",
    "let us consider first the case of pure signal states .",
    "in the cow protocol analyzed alice sends to bob either the sequence @xmath130 or @xmath131 , with @xmath132 , depending on whether her raw key bit value is  @xmath133 \" or  @xmath83 \" .",
    "let us start with the scenario where alice sends to bob only one bit value , occurring with equal a priori probability .",
    "this corresponds to a block size @xmath134 .",
    "then the source state is given by @xmath135 and its reduced density matrix becomes @xmath136.\\ ] ]    suppose now that alice sends to bob @xmath0 bits according to this scheme .",
    "if @xmath137 denotes the @xmath0-bit string being sent and @xmath138 refers to the corresponding signal state , then one obtains @xmath139 in particular , from the last expression one finds that the reduced density matrix @xmath129 is given by @xmath140    next , let us turn to the case of phase randomized blocks . since randomizing the phase of a block is equivalent to measuring the total number of photons contained in it , the true signals states are of the form @xmath141 here @xmath142 stands for the projector onto the @xmath122-photon subspace of the @xmath65 different modes .",
    "the outcome of such a photon number measurement follows a poisson distribution @xmath143 with mean @xmath144 .",
    "the projected @xmath122-photon signal states @xmath145 can be expressed as @xmath146 where the summation runs over all natural numbers @xmath147 that satisfy @xmath148 .",
    "these states fulfill the relation @xmath149 with @xmath150 being the hamming distance between the bit strings @xmath57 and @xmath151 , _",
    "i.e. _ , the number of places they differ .    using the framework of mixed signal states",
    "as explained in the main text one must now choose an overall purification of all signal states @xmath145 .",
    "for our simulation we select @xmath152 which can be seen as a coherent storage of the total photon number @xmath122 in the shield system @xmath50 .",
    "let us remark that this choice satisfies @xmath153 , with @xmath154 being the fidelity of mixed states , which is also the maximal possible overlap between two signal states  @xcite .",
    "we find , therefore , that the source state in this scenario is given by @xmath155 with @xmath156 .",
    "this means that the reduced density matrix @xmath129 , with @xmath157 , can be expressed as @xmath158 with @xmath159 given by @xmath160    in our simulation we only use partial information of the reduced density matrix @xmath129 .",
    "in particular , we transform @xmath50 to @xmath161 by making a shield measurement that distinguishes the different photon number cases mentioned in the main text such that one obtains @xmath162 where @xmath163 denotes an auxiliary system for all higher photon numbers .",
    "let us point out that considering the reduced state given by eq .",
    "( [ eq : tagged_rhoa ] ) can be understood as `` tagging '' the @xmath52 signal states  @xcite .",
    "_ announcement maps and phase operator._the specific announcements @xmath4 of the cow protocol can be phrased in terms of appropriate maps @xmath164 on the quantum state .",
    "together with a chosen `` phase setting '' measurement this provides a concrete expression for the averaged phase error operator @xmath165 used in eq .",
    "( [ eq : phase_error_operator ] ) .",
    "as explained in the protocol description , bob announces two consecutive even or odd time slots where he registered his single photon event .",
    "suppose , for instance , that he announces @xmath166 .",
    "these are the first arrival times of the modes associated with bits @xmath167 and @xmath168 sent by alice . in such cases , alice and",
    "bob agree to call the outcome in the first time instance  `` @xmath133 '' while the later event is  `` @xmath83 '' .",
    "this announcement can be modelled as a filter operation @xmath169 given by @xmath170 if bob measures system @xmath171 in the standard basis @xmath172 he obtains the real outcome he has observed .",
    "the pre - factor @xmath173 which appears in eq .",
    "( [ f1s ] ) takes into account that whenever bob sees a single photon click in either @xmath174 or @xmath175 he announces this particular @xmath4 with just @xmath176 probability , _",
    "i.e. _ , @xmath177 .",
    "suppose bob has actually declared @xmath166 .",
    "then , alice has to look on her bit string to determine whether she can conclusively infer bob s bit value . for that , only her bits @xmath167 and @xmath168 matter . as shown in fig .",
    "[ fig : announcements ] , if these two bits are equal it means that she had sent to bob either two full or two empty pulses . in this scenario",
    ", she can not infer bob s bit value and they discard this result .",
    "however , if these bits differ then she knows bob s sifted bit value precisely ( in the error free case ) and she tells bob to keep it .",
    "such a conclusive announcement by alice can similarly be modelled as a filter operation @xmath178 acting on her qubits @xmath91 and @xmath105 , _",
    "i.e. _ , @xmath179 with @xmath180 again a measurement in the standard basis @xmath181 provides alice with her real outcomes .    in order to determine the phase error @xmath182 we assume that both parties perform measurements in the @xmath183-basis , _ i.e. _",
    ", they project the output signals from their filter operations onto the states @xmath184 .",
    "then , the symmetrized phase error @xmath185 can be expressed as @xmath186 \\nonumber\\\\ & = & \\frac{1}{2 } p(v ) - \\frac{1}{2 } \\operatorname{tr } ( \\sigma_x \\otimes \\sigma_x p(v ) \\sigma_{{\\rm \\bar a \\bar b},v}^{m } ) \\nonumber\\\\ & = & \\frac{1}{2 } p(v ) - \\operatorname{tr } ( x^\\prime_{\\rm a}\\otimes x^\\prime_{\\rm b }   \\rho^m_{\\rm ab}),\\end{aligned}\\ ] ] with @xmath187 denoting the pauli matrix @xmath188 . in the last line of eq .  ( [ spit ] )",
    "we have defined the operators @xmath189 with @xmath190 .",
    "similar arguments apply to the cases where bob announces subsequent even outcome pairs or the special instances at the borders of the blocks .",
    "we find that the averaged phase error @xmath191 can be written as @xmath192 with an operator @xmath193 . here",
    "@xmath194 denotes the operator composed by the previously defined @xmath195 acting on qubits @xmath91 and @xmath105 and the identity operator acting on the remaining qubits ( @xmath196 means the first and last qubit ) . on bob s side",
    "the operators @xmath197 are given by @xmath198 with addition being carried out modulo @xmath65 .",
    "_ channel model._in this section we present the employed channel model of the cow experiment used in our numerical simulations .",
    "note , however , that the results presented in this article can be applied as well to any other quantum channel , as they only depend on the observed detection probabilities in both the data and monitoring lines .",
    "in particular , we characterize the losses in the channel with a bs of transmittance @xmath199 .",
    "this parameter can be related with a transmission distance @xmath99 measured in km for the given qkd scheme as @xmath200 where @xmath71 represents the loss coefficient of the channel ( _ e.g. _ , an optical fiber ) measured in db / km .",
    "together with the efficiency of the detectors the overall system transmittance is given by @xmath201 the total system loss in db is used as the x - axis in the secret key rate figures , _",
    "i.e. _ , @xmath202 .",
    "the channel misalignment is parametrized with an error probability @xmath203 that a signal hits bob s detectors in the wrong time slot within the same bit . for simplicity , we assume that @xmath203 is a constant independent of the distance and we use @xmath204 for simulation purposes .",
    "this effect is modelled by a completely positive trace - preserving map @xmath205 that incoherently flips the signal states within the same bit slot as @xmath206 and @xmath207 with probability @xmath203 . here",
    "we consider that the input signals have been already affected by system losses .",
    "we have , therefore , that whenever alice sends to bob a corresponding cow signal state with coherent state @xmath208 in temporal mode @xmath99 , the probability that bob observes a single photon detection event in this mode only ( within the whole signal block ) is given by @xmath209m_d\\}=\\epsilon(1-\\epsilon)^{2m-1}e^{-\\eta_{\\rm sys}\\lambda } \\nonumber \\\\   & & + ( 1-\\epsilon)^{2m}(1-e_{\\rm d})\\eta_{\\rm sys}\\mu{}e^{-\\eta_{\\rm sys}\\lambda},\\end{aligned}\\ ] ] where @xmath210 represents the output signal of the bs characterizing the total system loss , @xmath211 , and @xmath212 .",
    "similarly , when alice sends to bob a vacuum state in temporal mode @xmath99 bob can observe a single photon detection event in this mode only with probability @xmath213 the total probability that bob observes an inconclusive detection event in the data line is then given by @xmath214    in the monitoring line we include an additional misalignment effect that reduces further the interferometric visibility .",
    "in particular , we assume that whenever two equal coherent states interfere at a @xmath62 bs then the outcome signal can exit the bs through the wrong output port with error probability @xmath215 . in our simulations we use @xmath216 .",
    "here we distinguish two possible scenarios , depending on whether the signals which interfere at the bs were prepared by alice in the same quantum state or not .",
    "let us assume that the first signal corresponds to bit @xmath167 while the later to bit @xmath168 .",
    "that is , bob interferes modes @xmath106 and , at the same time , @xmath107 .",
    "let us consider first the situation where both signals were generated in the same state @xmath131 . in this scenario",
    ", we find that bob observes a single photon detection event in temporal mode @xmath174 only ( and no click in the remaining modes of the block ) with probability @xmath217 , \\nonumber \\\\",
    "p_{2l-1,-}&=&\\epsilon(1-\\epsilon)^{2m-1}e^{-\\eta_{\\rm sys}\\lambda}+(1-\\epsilon)^{2m}\\eta_{\\rm sys}\\mu{}e^{-\\eta_{\\rm sys}\\lambda } \\nonumber \\\\ & & \\times\\left[2(1-e_{\\rm d})^2e_{\\rm m}+e_{\\rm d}(1-e_{\\rm d})\\right],\\end{aligned}\\ ] ] where the superscript @xmath108 indicates whether the single excitation is registered in the bright ( @xmath109 ) or in the dark ( @xmath110 ) detector of the monitoring line .",
    "similarly , we have that the probability that bob sees a single photon detection in temporal mode @xmath218 only is given by @xmath219 , \\nonumber \\\\",
    "p_{2l,-}&=&\\epsilon(1-\\epsilon)^{2m-1}e^{-\\eta_{\\rm sys}\\lambda}+(1-\\epsilon)^{2m}\\eta_{\\rm sys}\\mu{}e^{-\\eta_{\\rm sys}\\lambda } \\nonumber \\\\ & & \\times\\left[2e_{\\rm d}^2e_{\\rm m}+e_{\\rm d}(1-e_{\\rm d})\\right].\\end{aligned}\\ ] ] the case where both signals were generated in the same state @xmath130 is completely analogous .",
    "one only needs to interchange eqs .",
    "( [ trd1 ] ) and ( [ trd2 ] ) .",
    "finally , let us consider the situation where both signals are prepared in a different quantum state . in this scenario",
    "the probabilities are given by @xmath220\\!,\\end{aligned}\\ ] ] and @xmath221\\!.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> distributed - phase - reference quantum key distribution stands out for its easy implementation with present day technology . since many years , a full security proof of these schemes in a realistic setting has been elusive . for the first time , we solve this long standing problem and present a generic method to prove the security of such protocols against general attacks . to illustrate our result we provide lower bounds on the key generation rate of a variant of the coherent - one - way quantum key distribution protocol . </S>",
    "<S> in contrast to standard predictions , it appears to scale quadratically with the system transmittance .    _ </S>",
    "<S> introduction._ quantum key distribution ( qkd ) is on the verge to become a standard tool for secure communications  @xcite . in its original proposal qkd </S>",
    "<S> is based on the transmission of single photons </S>",
    "<S> . however , since true single photon sources are not available yet most experimental prototypes and all current commercial products of qkd use weak laser pulses . </S>",
    "<S> a main drawback of these systems is that some signals contain more than one photon prepared in the same quantum state </S>",
    "<S> . this fact severely limits the distances that can be achieved by these techniques due to the photon number splitting attack  @xcite .    to enhance the performance of practical qkd systems , </S>",
    "<S> several approaches have been proposed . </S>",
    "<S> one solution is to send a strong reference pulse together with the quantum signals  @xcite . </S>",
    "<S> a second approach is based on the decoy state method , where the transmitter sends states with different intensities  @xcite . </S>",
    "<S> both schemes provide a secret key generation rate that scales linearly with the system transmittance  @xcite . </S>",
    "<S> a third alternative is to use distributed - phase - reference ( dpr ) qkd protocols . </S>",
    "<S> they differ from standard qkd schemes in that the receiver now performs joint measurements onto subsequent signals , often given in the form of coherence measurements  @xcite . </S>",
    "<S> this approach includes the differential - phase - shift @xcite and the coherent - one - way ( cow ) @xcite protocols . in the former , </S>",
    "<S> the sender prepares coherent states of equal intensity but modulates their phases ; in the cow protocol all pulses share a common phase but their intensities vary . a complete security proof of dpr - qkd in a realistic setting has been missing since many years . </S>",
    "<S> security has only been proven so far against restricted types of attacks  @xcite , or assuming the use of ideal single photon sources  @xcite .    in this letter we present a generic method to prove security of practical dpr - qkd against general attacks . </S>",
    "<S> this solves a long standing open question in the field of quantum communications @xcite . </S>",
    "<S> we illustrate our result by providing non - trivial lower bounds for a variant of the original cow protocol  @xcite , which maintains all the practical advantages . </S>",
    "<S> our analysis suggests that practical dpr - qkd might not be as robust against imperfections as initially foreseen , _ </S>",
    "<S> i.e. _ , its key rate appears to scale quadratically with the system transmittance .    _ </S>",
    "<S> security discussion._ the challenge in dpr - qkd is to prove security against general , also termed coherent attacks . </S>",
    "<S> usually such attacks are known to be of no advantage to the eavesdropper ( eve ) in comparison to collective attacks by virtue of the de finetti theorem  @xcite . </S>",
    "<S> this theorem applies , for instance , when the underlying quantum state shared by the legitimate users ( alice and bob ) is permutationally invariant . in standard </S>",
    "<S> qkd this is typically ensured by performing simultaneous random permutations on the classical measurement results . </S>",
    "<S> dpr - qkd defines however a fixed ordering of the signals by its coherence measurement and , therefore , it is not possible to permute the classical outcomes without destroying vital information  @xcite . </S>",
    "<S> however , such a predicament can be circumvented by grouping the entire signal stream into blocks . </S>",
    "<S> more specifically , consider that alice and bob group their signals into subsequent blocks of size @xmath0 , where the length @xmath0 is optimized for the expected behaviour . </S>",
    "<S> when permuting these blocks one preserves the coherence information within them while the information between the blocks is destroyed . </S>",
    "<S> still this is enough to apply the de finetti argument on the level of blocks . as a result </S>",
    "<S> , the state shared by alice and bob after distributing a large number @xmath1 of signals satisfies @xmath2 and security against collective attacks on these signal blocks implies security against coherent attacks in the original setting .    </S>",
    "<S> suppose that the state shared by alice , bob and eve after transmitting an @xmath0 block signal is @xmath3 . </S>",
    "<S> let us first consider the effect of public announcements by alice and bob based on their classical measurement results . </S>",
    "<S> this announcement , labelled as @xmath4 , allows both parties to distinguish between conclusive events that contribute to the sifted key and inconclusive ones that are discarded . on the level of quantum states </S>",
    "<S> this is described by suitable maps @xmath5 . </S>",
    "<S> given an announcement @xmath4 , that happens with probability @xmath6 , the three parties share the state @xmath7 determined by @xmath8 .    for each announcement </S>",
    "<S> @xmath4 one can use a one - way classical post - processing key rate formula  @xcite . </S>",
    "<S> if system @xmath9 denotes a qubit and alice s raw key is obtained by projecting this system onto the orthogonal states @xmath10 , then a lower bound on the secret key rate is given by @xmath11 . here </S>",
    "<S> @xmath12 represents the binary entropy , @xmath13 is the symmetrized bit error between the key measurements of alice and bob , and @xmath14 denotes the corresponding error , typically called phase error , when alice performs a measurement in a mutually unbiased basis and bob in his other different setting . </S>",
    "<S> this last parameter is used to upper bound eve s knowledge on the sifted key generated by alice . note that @xmath14 does not need to be measured directly </S>",
    "<S> , it only needs to be estimated . when bob s measurements are similar qubit measurements like the ones of alice then the expression above represents the shor - preskill key rate formula  @xcite .    to consider that the output system @xmath9 is a qubit implies that alice can , at best , distill one secret bit per block </S>",
    "<S> nevertheless this restriction should not have a significant impact on the key rate in a long distance regime , since bob observes , if any , most often only one single conclusive event per @xmath0 arriving signals due to the high losses in the channel ( given that @xmath0 is not too big ) .    instead of estimating separate phase errors </S>",
    "<S> @xmath14 , it is often easier to combine all conclusive announcements @xmath15 into an averaged version . </S>",
    "<S> let @xmath16 denote the total sifted key gain . </S>",
    "<S> then , we have that the secret key rate per block can be bounded by @xmath17 \\\\ \\nonumber & \\geq & \\inf_{\\rho_{\\rm abe}^m } g \\left [ 1-h_2 ( \\bar e_c ) - h_2 ( \\bar \\delta /g ) \\right ] \\\\ \\label{eq : bound_average } & \\geq & g \\left [ 1-h_2 ( \\bar e_c ) -h_2 ( \\bar \\delta^{\\rm </S>",
    "<S> max}/g ) \\right].\\end{aligned}\\ ] ] here one uses concavity of @xmath12 to lower bound @xmath18 by the averaged ( conditional ) error rates @xmath19 and @xmath20 . </S>",
    "<S> the last step takes into account that @xmath21 and @xmath22 are observed quantities and that the optimization is attained at the largest phase error @xmath23 compatible with the obtained data since @xmath12 increases in @xmath24 $ ] .    </S>",
    "<S> _ phase error estimation._ the main difficulty to compute eq .  </S>",
    "<S> ( [ eq : bound_average ] ) is to upper bound the average phase error @xmath25 . </S>",
    "<S> this parameter can be expressed as an expectation value on the original bipartite state @xmath26 using adjoint maps @xmath27 \\\\   </S>",
    "<S> \\label{eq : phase_error_operator } & = & \\operatorname{tr}[\\rho_{\\rm ab}^m \\sum_{v \\in \\mathcal{v}_{\\rm c } } \\lambda^{{\\rm a}\\dag}_v \\otimes \\lambda^{{\\rm b}\\dag}_v(f_{\\delta_v } ) ] = \\operatorname{tr}(\\rho_{\\rm ab}^m f_{\\bar \\delta}).\\end{aligned}\\ ] ] here @xmath28 denote the corresponding phase error operators on the state @xmath29 . </S>",
    "<S> partial knowledge of alice and bob about the state @xmath30 can be parsed as known expectation values @xmath31 for certain operators </S>",
    "<S> @xmath32 . </S>",
    "<S> this means that the search for the maximum phase error @xmath23 can be cast into the form of a semidefinite program  @xcite , @xmath33 such special convex optimization problems can be solved efficiently using standard tools to obtain the exact optimum , even for large dimensions .    _ available information and its description._ </S>",
    "<S> let us be more precise about which expectation values @xmath34 are known in a prepare and measure scheme , where alice sends potentially mixed states @xmath35 with a priori probability @xmath36 . </S>",
    "<S> this state preparation can be formulated in an entanglement based version as follows  @xcite : alice first creates a source state @xmath37 , where @xmath38 denote purifications of the signal states @xmath35 to a shield system @xmath39  @xcite . </S>",
    "<S> afterwards , she measures her bit system @xmath40 in the standard basis , thereby producing the correct signal state at site @xmath41 which is sent to bob . </S>",
    "<S> eve transforms the overall source state to the final tripartite state @xmath3 with @xmath42 . on the receiving side , bob performs a measurement modelled by @xmath43 . as a result , </S>",
    "<S> both alice and bob observe the expectation values of @xmath44 . </S>",
    "<S> moreover , since eve is restricted to interact only with bob s system , the reduced density matrix @xmath45 is fixed and directly given by the source state . </S>",
    "<S> this information can be added by including expectation values of @xmath46 , where @xmath47 denotes a tomographic complete operator set on @xmath48 . </S>",
    "<S> both sets of observables constitute the previously denoted set  @xmath32 .    </S>",
    "<S> the signal states and performed measurements in practical dpr - qkd are described by operators on an infinite dimensional fock space of several modes . in order to apply the de finetti argument  </S>",
    "<S> @xcite , and to numerically obtain an upper bound on the phase error using eq .  </S>",
    "<S> ( [ eq : phase_error_sdp ] ) , it is necessary to formulate this problem in a manageable , finite dimensional form . </S>",
    "<S> clearly , system @xmath49 is finite . for bob s measurements one can employ the squash model argument  @xcite . here </S>",
    "<S> the real measurement is notionally decomposed into a two step procedure by first applying a map that transforms any incoming signal to a finite dimensional output state on which a specified target measurement @xmath43 is performed afterwards . </S>",
    "<S> since this map can be even given to eve , its output state only lowers the key generation capabilities of alice and bob , and one readily works in finite dimensions . for our simulations </S>",
    "<S> we assume that bob has at his disposal inefficient photon number resolving detectors with state independent dark counts . also , we consider that only the single photon events within the whole block are finally considered as conclusive . in this case </S>",
    "<S> the map outputs either a single photon , measured with the perfect detection scheme , or an auxiliary state that triggers all inconclusive events .    for the shield system </S>",
    "<S> @xmath50 one uses only partial information of the reduced state . in the case of phase randomized signal blocks , an example that we consider later , a purification is given by storing the total photon number of the block in the shield system @xmath51 . </S>",
    "<S> using only tomography on the subspace spanned by all @xmath52 , together with an ancilla state @xmath53 for all other cases , the shield system can effectively be described in finite dimensions .    </S>",
    "<S> _ description of the protocol._ to illustrate our results we analyze the security of a variant of the cow protocol  @xcite . </S>",
    "<S> the basic setup is shown in fig .  </S>",
    "<S> [ cowfig ] .    </S>",
    "<S> alice uses a laser , followed by an intensity modulator ( i m ) , to prepare a sequence of coherent states @xmath54 and @xmath55 . on the receiving side </S>",
    "<S> , bob employs an optical switch to distribute each pair of incoming pulses into the data or the monitoring line  @xcite . </S>",
    "<S> the data line measures the arrival time of the pulses in detector @xmath56 and creates the raw key . </S>",
    "<S> whenever bob sees a  click \" in this detector in say time instance  @xmath57 , he decides at random whether to publicly announce a detection event in time instances @xmath57 and @xmath58 or @xmath57 and @xmath59 . </S>",
    "<S> the first case is associated with a bit value  0 \" , while the second one corresponds to a bit value  1 \" . </S>",
    "<S> if the state sent by alice in these time instances is @xmath54 ( @xmath55 ) then she assigns to it a bit value  0 \" (  1 \" ) and tells bob to keep his result . </S>",
    "<S> otherwise , the result is discarded and does not contribute to the sifted key . </S>",
    "<S> let us illustrate this procedure with a simple example drawn in fig .  </S>",
    "<S> [ cowfig ] , and assume that bob observes a click in @xmath60 in time @xmath57 . if he announces the pair @xmath57 and @xmath58 , then this result is discarded . note that in this case alice sent @xmath61 and hence she can not infer in which time slot bob saw a  click \" . on the contrary , if bob reports @xmath57 and @xmath59 , then both parties assign to it a bit value  1 \" . the monitoring line checks for eavesdropping by measuring the coherence between subsequent even and odd pulses sent by alice . </S>",
    "<S> this is done by interfering adjacent pairs of pulses in a @xmath62 beamsplitter and measuring the output states in detectors @xmath63 and  @xmath64 .    in the security analysis </S>",
    "<S> we assume that alice and bob discard coherence information between consecutive signal blocks . </S>",
    "<S> moreover we consider that the sifted key is created only from signals within the same block . </S>",
    "<S> to guarantee this , one could discard those detection events where bob declares time instances that belong to different blocks . </S>",
    "<S> alternatively , one could change bob s public announcement slightly . for example </S>",
    "<S> , one can reorder the @xmath65 possible detection time slots of a given block to form a closed chain with the first and last time instances connected . </S>",
    "<S> now , if bob observes a  click \" in the data line in say the first time slot he announces a detection event in time instances one and three or one and @xmath66 with equal probability , and similar for the other cases . this strategy preserves the original symmetry in bob s announcement and we use it in our simulations .    _ </S>",
    "<S> simulation._ for simulation purposes , we consider that bob s detectors are identical and have a dark count rate of @xmath67 . </S>",
    "<S> the channel model includes an intrinsic error rate of @xmath68 in the data line together with an additional misalignment in the monitoring line that reduces the interferometric visibility to @xmath69 . </S>",
    "<S> more details on this channel model and on the adapted security discussion to the cow protocol are given in the appendix . </S>",
    "<S> we study two different scenarios : ( a ) the case where all different @xmath0-signals blocks share the same phase , and ( b ) the scenario where each block is phase randomized . </S>",
    "<S> the resulting lower bounds on the secret key rate per pulse , _ </S>",
    "<S> i.e. _ , @xmath70 , are illustrated in fig .  </S>",
    "<S> [ fig_rates ] . for comparison , </S>",
    "<S> this figure includes as well a lower bound on the secret key rate for a coherent - state version of the standard bb84 protocol  @xcite with and without phase randomization  @xcite . for a given total system loss , _ </S>",
    "<S> i.e. _ , including the losses in the channel and in bob s detection apparatus , we optimize the lower bound over the respective signal strength @xmath71 of alice s source which is of order @xmath72 . as expected , we find that case ( b ) performs better than that where all blocks share a common phase , since the signal states are less distinguishable for an eavesdropper without a global phase . </S>",
    "<S> we obtain that the tolerable system loss for the cow protocol is , respectively , @xmath73 db ( a ) , and @xmath74 db ( b ) . </S>",
    "<S> the bit error and visibility at these cutoff points are , respectively , @xmath75 and @xmath76 ( a ) , and @xmath77 and @xmath78 ( b ) . </S>",
    "<S> let us remark that the lower bound with @xmath79 even holds for threshold detectors  @xcite .    </S>",
    "<S> our simulations reveal that a main limiting factor in dpr - qkd seems to be the dark count rate of bob s detectors . for given experimental parameters </S>",
    "<S> , there is an optimal finite block size that allows a maximum tolerable total system loss . </S>",
    "<S> if one increases the block size further this does not translate into an improved lower bound or distance . </S>",
    "<S> this is due to the fact that , in the high loss regime , large sized blocks suffer from a higher dark count probability _ per block _ than smaller sized blocks , and this reduces the achievable secret key rate . </S>",
    "<S> a similar effect was already observed in the security analysis for the differential - phase - shift protocol with true single photon sources  @xcite . for a dark count rate per pulse of </S>",
    "<S> @xmath67 the optimal block size in the cow scheme turns out to be @xmath80 , _ </S>",
    "<S> i.e. _ , @xmath81 optical pulses . </S>",
    "<S> also , this figure shows that a coherent - state version of the bb84 protocol without decoy states can deliver notably higher key rates per signal than the analyzed cow protocol assuming the same channel model . </S>",
    "<S> the reason for this might be threefold : ( 1 ) the small optimal block size in the cow scheme ; ( 2 ) considering blocks , it can be shown that certain multi - photon pulses are completely insecure ; ( 3 ) most importantly , while in the bb84 the phase error is measured directly , in the cow protocol it has to be estimated .    _ </S>",
    "<S> possible improvements._ to further improve the lower bounds shown in fig .  </S>",
    "<S> [ fig_rates ] there are several alternatives . </S>",
    "<S> since a main limitation seems to come from dark counts , one may consider security in the fully calibrated device scenario where these errors are not attributed to eve . as a quantitative bound on the performance of this scenario we investigated the case of a zero dark count rate , in which all key rate bounds shown in fig .  [ fig_rates ] </S>",
    "<S> shift by about @xmath82 db , though the difference between the cow and the bb84 protocol remains . </S>",
    "<S> additionally , one can evaluate different public announcements in a similar spirit like the sarg protocol  @xcite . </S>",
    "<S> we considered different declarations , but unfortunately none of them enhanced the resulting key rate  @xcite . </S>",
    "<S> another possibility is to include , for instance , an extra monitoring line on bob s side to additionally check the coherence between subsequent pulses . </S>",
    "<S> the state distribution part of this protocol is then very similar to the one of the original cow scheme  @xcite with an additional decoy signal composed by two vacuum pulses as proposed in ref .  </S>",
    "<S> @xcite . </S>",
    "<S> this hardware change improves the maximum tolerable system loss by about @xmath83  db .    </S>",
    "<S> another hardware change might be to include additional phase differences in the signal stream , such that the signals states get closer to the one used in a bb84 protocol . </S>",
    "<S> finally , one may ask whether different security techniques might provide better lower bounds . </S>",
    "<S> for instance , one could consider more valid detection events per block . </S>",
    "<S> this needs however much larger block sizes such that one obtains at all a reasonable fraction of two or more click events in the long distance limit . </S>",
    "<S> another alternative would be to bound the rate by the individual phase errors , _ </S>",
    "<S> i.e. _ , directly using eq .  </S>",
    "<S> ( [ eq : bound_individual ] ) . </S>",
    "<S> this could give a benefit if , for example , bits at the boundary are much easier to infer by eve than bit values originating from events well inside the block . </S>",
    "<S> moreover , it might be of advantage if eve s information is estimated by using different , possibly not mutually unbiased basis measurements . here the more general key rate formula of ref .  </S>",
    "<S> @xcite could be used . </S>",
    "<S> clearly another option would be to abandon the block idea . </S>",
    "<S> however even in this case eve could always attack the signals block - wise . </S>",
    "<S> though a coherence measurement across blocks would then reveal the eavesdropper , any coherence measurement within them would be still fine . hence when considering only an average visibility this effect will become less and less important . </S>",
    "<S> all these alternatives definitely deserve further investigations , but we do not expect a dramatic improvement .    _ </S>",
    "<S> conclusion._ we have presented a generic method to prove security of practical dpr - qkd against general attacks . with the explicit example of a variant of the cow protocol , we have shown that these schemes are indeed secure for certain distances at given rates . </S>",
    "<S> its performance , however , seems to be less robust against practical imperfections than originally expected .    </S>",
    "<S> we would like to thank h .- </S>",
    "<S> k . </S>",
    "<S> lo , n.  ltkenhaus , v.  scarani , l.  sheridan and n.  walenta for stimulating discussions about the topic and technicalities , and l.  m. eriksson for comments on the presentation of the paper . t.m . </S>",
    "<S> , m.c . , and l.p.t . </S>",
    "<S> especially thank the group of applied physics , university of geneva , for hospitality and support during their stay at this institution , where parts of this research have been conducted . </S>",
    "<S> this work has been supported by the eu ( marie curie cig 293993/enfoqi ) , the bmbf ( chist - era project quasar ) , the national research foundation and the ministry of education , singapore , the national centre of competence in research qsit , the swiss nanotera project qcrypt and the fp7 marie - curie iaap qcert project .    </S>",
    "<S> 99    n. gisin _ </S>",
    "<S> et al . _ , rev . </S>",
    "<S> mod . </S>",
    "<S> phys . * 74 * , 145 ( 2002 ) ; v. scarani _ et al . </S>",
    "<S> _ , rev . </S>",
    "<S> mod . </S>",
    "<S> phys . * 81 * , 1301 ( 2009 ) .    </S>",
    "<S> b. huttner _ </S>",
    "<S> et al . _ , </S>",
    "<S> phys . </S>",
    "<S> rev . </S>",
    "<S> a * 51 * , 1863 ( 1995 ) ; g. brassard , _ et al . </S>",
    "<S> _ , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> * 85 * , 1330 ( 2000 ) .    c. h. bennett , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 68 * , 3121 ( 1992 ) ; m. koashi , phys . rev . lett . * 93 * , 120501 ( 2004 ) ; k. tamaki _ </S>",
    "<S> et al . _ , </S>",
    "<S> phys . </S>",
    "<S> rev . </S>",
    "<S> a * 80 * , 032302 ( 2009 ) .    </S>",
    "<S> w .- y . </S>",
    "<S> hwang , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> * 91 * , 057901 ( 2003 ) ; h .- k . </S>",
    "<S> lo , x. ma , and k. chen , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 94 * , 230504 ( 2005 ) ; x .- b . </S>",
    "<S> wang , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 94 * , 230503 ( 2005 ) .    </S>",
    "<S> k. inoue , e. waks , and y. yamamoto , phys . rev . </S>",
    "<S> lett . * 89 * , 037902 ( 2002 ) ; k. inoue , e. waks , and y. yamamoto , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 68 * , 022317 ( 2003 ) ; h. takesue _ et al . </S>",
    "<S> _ , new j. phys . </S>",
    "<S> * 7 * , 232 ( 2005 ) ; e.diamanti _ et al . </S>",
    "<S> _ , opt . express * 14 * , 13073 ( 2006 ) ; h. takesue _ et al . </S>",
    "<S> _ , nature photonics * 1 * , 343 ( 2007 ) .    </S>",
    "<S> n. gisin _ </S>",
    "<S> et al . _ , preprint arxiv : quant - ph/0411022 ( 2004 ) ; d. stucki _ et al . </S>",
    "<S> _ , appl . </S>",
    "<S> . lett . * 87 * , 194108 ( 2005 ) ; d. stucki _ et al . </S>",
    "<S> _ , new j. phys . _ 11 _ , 075003 ( 2009 ) .    </S>",
    "<S> e. waks , h. takesue , and y. yamamoto , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 73 * , 012344 ( 2006 ) ; c. branciard , n. gisin and v. scarani , new j. phys . * </S>",
    "<S> 10 * , 013031 ( 2008 ) ; y .- b . </S>",
    "<S> zhao _ </S>",
    "<S> et al . _ , </S>",
    "<S> phys . </S>",
    "<S> rev . </S>",
    "<S> a * 78 * , 042330 ( 2008 ) .    </S>",
    "<S> m. curty _ </S>",
    "<S> et al . _ , </S>",
    "<S> quant . </S>",
    "<S> inf . comp . </S>",
    "<S> * 7 * , 665 ( 2007 ) ; t. tsurumaru , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 75 * , 062319 ( 2007 ) ; m. curty , k. tamaki , and t. moroder , phys . rev . </S>",
    "<S> a * 77 * , 052321 ( 2008 ) ; h. gomez - sousa , m. curty , quant . </S>",
    "<S> inf . comp . </S>",
    "<S> * 9 * , 62 ( 2009 ) .    c. branciard _ </S>",
    "<S> et al . _ , </S>",
    "<S> quant . </S>",
    "<S> inf . comp . </S>",
    "<S> * 7 * , 639 ( 2007 ) .    </S>",
    "<S> k. wen , k. tamaki , and y. yamamoto , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 103 * , 170503 ( 2009 ) .    </S>",
    "<S> c. c. w. lim , n. walenta , and h. zbinden , private communication .    </S>",
    "<S> r.  renner , phd thesis , ijqi * 6 * , 1 ( 2008 ) ; r.  renner , nature physics * 3 * , 645 ( 2007 ) .    </S>",
    "<S> sequential attacks  @xcite against dpr - qkd also show that its key generation rate differs from the one obtained if one assumes only collective attacks .    </S>",
    "<S> m.  tomamichel , and r. renner , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 106 * , 110506 ( 2011 ) .    </S>",
    "<S> p.  w. shor , and j. preskill , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 85 * , 441 ( 2000 ) .    </S>",
    "<S> l. vandenberghe , and s. boyd , siam review * 38 * , 49 ( 1996 ) .    c. h. bennett , g. brassard , and n. d. mermin , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 68 * , 557 ( 1992 ) ; t.  moroder , m.  curty , and n.  ltkenhaus , phys . rev . a 74 , 052301 ( 2006 ) ; h.  hseler , and n.  ltkenhaus , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 80 * , 042304 ( 2009 ) .    </S>",
    "<S> a shield system refers to an ancillary system that is inaccessible to the eavesdropper . </S>",
    "<S> moreover let us point out that though a single purification @xmath38 is unique up to local unitary , here one requires that all signals @xmath35 are purified to the same shield system @xmath84 , which is not unique anymore . while certain collective purifications are clearly better than others , any choice is valid .    </S>",
    "<S> n. j. beaudry , t. moroder , and n. ltkenhaus , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> * 101 * , 093601 ( 2008 ) ; t. tsurumaru , and k. tamaki , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 78 * , 032302 ( 2008 ) ;    in our simulation we consider , for simplicity , an active measurement choice by bob . in practice , this can be replaced by a passive optical coupler to select between data and monitoring line , together with an unbalanced mach - zehnder interferometer for the coherence measurement .    c. h. bennett and g. brassard , in _ proceedings of ieee international conference on computers , systems , and </S>",
    "<S> signal processing _ , bangalore , india ( ieee press , new york , 1984 ) , pp . </S>",
    "<S> 175 - 179 .    </S>",
    "<S> d. gottesman _ </S>",
    "<S> et al . _ , </S>",
    "<S> quant . </S>",
    "<S> inf . comp . * 5 * , pp . </S>",
    "<S> 325 - 360 ( 2004 ) .    </S>",
    "<S> h .- k . </S>",
    "<S> lo , and j. preskill , quant . </S>",
    "<S> inf . </S>",
    "<S> comput . </S>",
    "<S> * 8 * , 431 ( 2007 ) </S>",
    "<S> .    in the easiest setting bob may want to use threshold detectors , _ </S>",
    "<S> i.e. _ , simple click / no - click detectors , instead of photon number resolving detectors . using similar arguments like in ref .  </S>",
    "<S> @xcite , it can be shown that , for 2-bit blocks , bob s measurement apparatus can be described with a squash model and the security analysis applies directly . the resulting secret key rate , however , is almost identical to the case where he uses photon number resolving detectors , only slightly higher in the low loss regime where the probability to obtain a valid detection event is also higher .    v. scarani _ et al . </S>",
    "<S> _ , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 92 * , 057901 ( 2004 ) .    </S>",
    "<S> in particular , we have examined two further cases . in the first one , whenever bob sees a  click \" in detector @xmath60 in time instance @xmath85 ( @xmath86 ) he always declares a detection event in time instances @xmath57 and @xmath58 ( @xmath57 and @xmath59 ) . </S>",
    "<S> detection events not situated in the border of the blocks are treated as described in the main text . in the second strategy , </S>",
    "<S> detection events produced in the border of the blocks are only announced by bob with probability @xmath87 . </S>",
    "<S> both methods deliver lower key rates than the one described in the main text .    </S>",
    "<S> m. a. nielsen , and i.  l. chuang , quantum computation and quantum information ( cambridge university press ) ( 2000 ) . </S>"
  ]
}