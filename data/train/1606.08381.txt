{
  "article_text": [
    "the valuation of options are of utmost importance to be able to offset the risk arising from the unexpected price changes in the financial markets",
    ". especially , international investors may incur considerable financial losses due to the fluctuations in the currency prices .",
    "therefore , options on foreign exchange rate are commonly used to mitigate this vulnerability . in this paper , we focus on the pricing of european call , butterfly spread and digital options which are popular among the practitioners .    since the value of an option is affected by the performance of its underlying , it becomes crucial to examine the price dynamics of the considered security .",
    "the celebrated black - scholes model  @xcite is unsuccessful in predicting the volatility smirk due to the assumption of constant volatility .",
    "in particular , the model gives poor results for the options on exchange rate  @xcite .",
    "this important shortcoming can be overcame by regarding volatility as a source of randomness as suggested in heston stochastic volatility model . under heston framework ,",
    "the volatility is treated as a square - root process which enables us to obtain more accurate prices for the european currency options  @xcite .",
    "indeed , assuming the volatility of the exchange rate is non - constant over time seems a more realistic approach in today s financial markets .",
    "albeit heston model provides a semi analytical solution for european vanilla options , numerical methods are generally required especially for more complex options .",
    "option pricing problems are usually solved with the monte carlo methods .",
    "although its implementation is straightforward , it requires large number of realizations to achieve high accuracy .",
    "moreover , only one option price can be evaluated for a given initial data .",
    "therefore , the simulations can be too costly which leads us to the discretization methods based on the solution of partial differential equations ( pdes ) .",
    "option pricing problems under heston model can be represented as a two - dimensional diffusion - convection - reaction pde with variable coefficients  @xcite .    in the heston pde",
    ", the diffusion matrix contains cross - diffusion terms as a result of the correlation between the volatility and the underlying security .",
    "additionally , the initial and boundary data are non - smooth for different options .",
    "therefore , the numerical solution of the heston pde is more challenging than the constant coefficient diffusion - convection - reaction equations .",
    "the most commonly used method for option pricing is the finite - differences ( fds ) .",
    "alternating direction implicit ( adi ) fd @xcite and compact fd schemes @xcite are constructed for efficient and accurate discretization of the mixed derivatives in the cross diffusion term , which require sufficiently smooth initial and boundary conditions .",
    "the first application of the finite element method ( fem ) for option pricing under heston model goes back to 2000 @xcite .",
    "the radial basis @xcite and spectral methods @xcite for option pricing models are more accurate than the fd methods , but have the drawback of requiring the inversion of full system matrices .    in this paper , we apply the symmetric interior penalty discontinuous galerkin ( sipg ) @xcite method with upwinding for the convection part @xcite to solve heston s option pricing model for european , butterfly spread and digital options .",
    "the discontinuous galerkin finite element methods ( dgfem ) emerged as an alternative to the classical continuous finite element methods in the last twenty years .",
    "the basis functions in dgfem are discontinuous along the inter - element boundaries in contrast to the classical fems .",
    "the dgfem has a number of desirable properties like the weakly enforcement of the boundary conditions , hp - refinement ( space and order ) and ease of parallelization .",
    "the stability of discontinuous galerkin ( dg ) methods are handled via the penalty term which penalizes the jumps of the solution on the element boundaries in contrast to the classical stabilized fems such as streamline upwind / petrov - galerkin ( supg ) method with additional stabilization terms .",
    "we want to remark that recently different dg methods are applied for option pricing models @xcite .",
    "an interesting feature of heston model is the occurrence of sharp layers or discontinuities for vanishing volatility . in the case of european call options , for instance , extremely high foreign interest rates",
    "makes the problem convection - dominated  @xcite when the underlying volatility is very small . in such cases ,",
    "the naive approach is to refine the spatial mesh uniformly , which increases the degrees of freedom and refines the mesh unnecessarily in regions where the solutions are smooth . in fd methods ,",
    "predefined non - uniform grids @xcite are used to resolve accurately the discontinuities or the sharp layers . in practice ,",
    "the location of the interior or boundary layers for convection dominated problems are usually not known a priori .",
    "adaptive fems can detect the layers using a posteriori error estimators by refining the mesh locally .",
    "due to the local nature of the basis functions of the dgfems , the sharp layers and the singularities of the solution can be detected easily using the adaptive techniques @xcite which are robust , i.e. independent of the pclet number ( ratio of convection to diffusion ) .",
    "option pricing models have non - smooth initial data , with the discontinuous first derivatives of the payoff functions .",
    "the most popular time discretization method in option pricing is the crank - nicolson method , which leads undesired oscillations for non - smooth initial data .",
    "the instability of the crank - nicolson method is remedied by applying in the first four steps the implicit backward euler method and then continuing with crank - nicolson method as time integrator , known as rannacher smoothing @xcite .",
    "rannacher smoothing was used for different option pricing models @xcite , which we apply here to the heston model .",
    "the paper is organized as follows : in the next section , we introduce heston s model for option pricing , and give strong and variational forms of heston pde .",
    "space discretization via sipg method and time discretization by crank - nicolson method with rannacher smoothing are described in section  [ sec : dg ] . in section [ sec : numex ] , we present numerical results for the valuation of european call , butterfly spread and digital call options .",
    "we also solve a convection dominated problem for european call options using adaptive dgfem .",
    "the paper ends with some conclusions .",
    "the heston stochastic volatility model suppose that the volatility of the underlying security is driven by a square - root process  @xcite . due to this assumption , the model is successful in modeling the smile effect observed in the option prices .",
    "another main advantage of the model is that a semi - analytical price can be easily derived for the european vanilla options , which makes the model more favorable for practitioners . on the other hand , like the monte - carlo method",
    ", only a single value of the option can be evaluated for a given data .    in section [ model ] , we describe heston dynamics , and give the semi - analytical solutions for the value of european vanilla options . in section [ hestonpde ] ,",
    "heston s two - dimensional diffusion - convection - reaction equation with variable coefficients is presented .",
    "the variational formulation is introduced in section [ variationalform ] , which is needed for the implementation of dgfem in the text examples .      in the heston stochastic volatility model , the value of the underlying security @xmath0",
    "is governed by the stochastic differential equation  @xcite @xmath1 and the variance @xmath2 follows the square - root process @xmath3 where @xmath4 and @xmath5 are correlated standard brownian motions such that @xmath6=\\rho dt,\\ ] ] with @xmath7 being a constant correlation coefficient . here , @xmath8 is the domestic interest rate , @xmath9 is the foreign interest rate , @xmath10 is the mean reversion rate , @xmath11 is the long - run mean level of @xmath12 and @xmath13 is the volatility of the volatility ( vol of vol ) .",
    "if the parameters in ( [ variance ] ) satisfy the well - known feller condition @xmath14 the variance process @xmath2 turns out to be strictly positive , which is fulfilled in most cases .",
    "+ let @xmath15 be the price of a european call option at time @xmath16 with an exercise price @xmath17 and maturity @xmath18 .",
    "considering the dynamics defined in ( [ stock])-([variance ] ) , the semi - analytical solution for the price @xmath15 is given by  @xcite : @xmath19 where @xmath20 denotes the time to maturity and for @xmath21 @xmath22d\\omega,\\\\ f_k(\\omega;\\ln(s),v)&= \\exp\\{c_k(\\tau,\\omega))+d_k(\\tau,\\omega)v+i\\omega\\ln(s)\\},\\\\ c_k(\\tau,\\omega)&=(r_d - r_f)i\\omega\\tau+\\frac{\\kappa\\theta}{\\sigma^2}\\left[(b_k-\\rho\\sigma i\\omega+d_k)\\tau-2\\ln\\left(\\frac{1-h_ke^{d_k\\tau}}{1-h_k}\\right)\\right],\\\\ d_k(\\tau,\\omega)&=\\frac{b_k-\\rho\\sigma i\\omega+d_k}{\\sigma^2}\\left(\\frac{1-e^{d_k\\tau}}{1-h_ke^{d_k\\tau}}\\right),\\\\ h_k&=\\frac{b_k-\\rho\\sigma i\\omega+d_k}{b_k-\\rho\\sigma i\\omega - d_k},\\\\ d_k&=\\sqrt{(\\rho\\sigma i\\omega - b_k)^2+(-1)^{{k}}\\sigma^2i\\omega+\\sigma^2\\omega^2 } , \\\\",
    "b_k&=(k-2)\\rho\\sigma+\\kappa.\\end{aligned}\\ ] ] analogously , the price of the put option @xmath23 can be stated as @xmath24 resulting from the put - call parity .",
    "one can also derive a semi - analytical solution for the price of the digital call options . by considering the same arguments used for european vanilla options , the semi - analytical solution for the price of a digital call option can be expressed as  @xcite : @xmath25 where @xmath26 is the price of the digital call option with strike price @xmath17 and maturity @xmath27      as a direct application of feyman - kac theorem , the no - arbitrage price of a european option under heston model can be characterized by a two - dimensional diffusion - convection - reaction equation with variable coefficients .",
    "let @xmath28 be the price of a european option at time @xmath16 and let @xmath29 denote the payoff received at maturity @xmath18 .",
    "then , the option price @xmath28 under heston model satisfies the following linear two - dimensional variable coefficient diffusion - convection - reaction equation  @xcite @xmath30 with the terminal condition @xmath31 where @xmath32 @xmath33 @xmath34,$ ] and @xmath35    applying the so called log transformation @xmath36 and @xmath20 with @xmath37 pde is converted to the following equation    @xmath38    where @xmath39 @xmath40 @xmath41,$ ] and @xmath42 note that due to the substitution @xmath43 pde ( [ pdex1 ] ) can also be regarded as a forward equation with the following initial condition @xmath44    we consider an open bounded domain @xmath45 with the boundary @xmath46 , where on @xmath47 the dirichlet and on @xmath48 the neumann boundary conditions are prescribed , respectively .",
    "then , the log transformed pde given in ( [ pdex1 ] ) is expressed as a diffusion - convection - reaction equation    [ convdiff_x ] @xmath49    where @xmath50 is the outward unit normal vector , @xmath51 , throughout this paper , is the spatial element . in ,",
    "the diffusion matrix and convective field are given by @xmath52    although , the transformed pde ( [ pdex1 ] ) is defined on the computational domain @xmath53 , dgfem must be performed on a bounded spatial region @xmath54 for the numerical simulations .",
    "we introduce the weak formulation of heston s model as parabolic convection - diffusion - reaction equation ( [ convdiff_x ] ) .",
    "let @xmath55 be the space consisting of all square integrable functions on @xmath45 , @xmath56 denote the hilbert space of all functions having square integrable first - order partial derivatives , and @xmath57 .",
    "the weak form of is obtained by multiplying with a test function @xmath58 and integrating by parts over the domain @xmath45 .",
    "then , for a.e .",
    "@xmath59 $ ] , we seek a solution @xmath60 satisfying    [ cont_weak ] @xmath61    where @xmath62 is the arc - length element on the boundary . in , @xmath63 is the bilinear form given by @xmath64    we assume that the matrix @xmath65 is positive definite , i.e. @xmath66 and @xmath67 which is usually satisfied .",
    "there exist constants @xmath68 , @xmath69 and @xmath70 for all @xmath71 and @xmath72 , so that the bilinear form @xmath63 is continuous and weakly coercive @xcite : @xmath73 the first inequality accounts to the continuity of the bilinear form and the second is the grding inequality .",
    "the weakly coercive bilinear form @xmath74 can be transformed into a coercive one using the substitution @xmath75 ( * ? ? ?",
    "then , there exist a unique solution and the following energy estimate holds @xmath76 } ||u(t)||_{l^2}^2 +   c_1 \\int_0^t ||u(t)||_h^2 \\le ||u(0)||_{l^2}^2 + \\frac{1}{c_1 } \\int_0^t ||f(t)||_2 ^ 2.\\ ] ]",
    "the symmetric interior penalty galerkin ( sipg ) method is the commonly used dg method , which enforces boundary conditions weakly @xcite .",
    "let the mesh @xmath77 be a partition of the domain @xmath45 into a family of shape regular elements ( triangles ) .",
    "we set the mesh - dependent finite dimensional solution and test function space by @xmath78 where the functions in @xmath79 are discontinuous along the inter - element boundaries .",
    "these discontinuities leads to the fact that on an interior edge @xmath80 shared by two neighboring triangles @xmath81 and @xmath82 , there are two different traces from either triangles .",
    "thus , for convenient , we define the jump and average operators of a function @xmath83 on @xmath80 by @xmath84\\!\\right]$}}:= u|_{k_i}\\mathbf{n}_{k_i } + u|_{k_j}\\mathbf{n}_{k_j}\\ ; , \\quad { \\mbox{$\\left\\{\\!\\!\\left\\ { u \\right\\}\\!\\!\\right\\}$}}:=\\frac{1}{2}(u|_{k_i } + u|_{k_j}).\\ ] ] on a boundary edge @xmath85 , we set @xmath86\\!\\right]$}}:= u|_{k}\\mathbf{n}$ ] and @xmath87 .",
    "in addition , we form the sets of inflow and outflow edges by @xmath88 @xmath89 where @xmath90 denotes the outward unit vector on an element boundary @xmath91 .",
    "moreover , we denote by @xmath92 and @xmath93 the sets of interior and dirichlet boundary edges , respectively so that the union set @xmath94 . then , in space sipg discretized semi - discrete system of the pde reads as : for a.e .",
    "@xmath95 $ ] , for all @xmath96 , find @xmath97 such that    [ dg ] @xmath98    with the ( bi)linear forms :    @xmath99\\!\\right]$}}\\cdot{\\mbox{$\\left[\\!\\left [ w_{h } \\right]\\!\\right]$ } } - { \\mbox{$\\left\\{\\!\\!\\left\\ { a \\nabla w_{h } \\right\\}\\!\\!\\right\\}$}}{\\mbox{$\\left[\\!\\left [ u_{h } \\right]\\!\\right]$ } } - { \\mbox{$\\left\\{\\!\\!\\left\\ { a   \\nabla u_{h } \\right\\}\\!\\!\\right\\}$ } } { \\mbox{$\\left[\\!\\left [ w_{h } \\right]\\!\\right]$}}\\right)ds   \\\\ & + \\sum \\limits_{k \\in { \\xi_{h } } } \\left ( \\int\\limits_{\\partial k^-\\setminus\\partial\\omega } b \\cdot \\mathbf{n}_k ( u_{h}^{out}-u_{h } )   w_{h } ds -   \\int\\limits_{\\partial k^-\\cap \\gamma^{- } } b\\cdot \\mathbf{n}_k u_{h } w_{h } ds \\right ) , \\\\ l_{h } ( w_{h})= &   \\sum \\limits_{e \\in { \\gamma_{h}^n } } \\int_{e } u^n w_{h } d\\mathbf{z } + \\sum \\limits_{e \\in { \\gamma_{h}^d } } \\int_{e } u^d\\left ( \\frac{\\sigma_e}{h_{e}}w_{h } - a \\nabla w_{h } \\right)ds\\\\ &   - \\sum \\limits_{k \\in { \\xi_{h}}}\\int\\limits_{\\partial k^-\\cap \\gamma^{- } } b\\cdot \\mathbf{n}_k u^d w_{h } ds,\\end{aligned}\\ ] ]    where @xmath100 denotes the trace of @xmath101 on an edge @xmath80 from outside the triangle @xmath17 .    the penalty parameter @xmath102 should be selected sufficiently large to ensure the coercivity of the bilinear form ( * ? ? ?",
    "it ensures that the dg stiffness matrix is positive definite . at the same time",
    "it should not be too large since the stiffness matrix becomes ill - conditioned for large penalty parameters .",
    "here we follow @xcite to estimate the penalty parameter , above a threshold value the bilinear form is coercive and the scheme is stable and convergent . from the uniform ellipticity ( positive definiteness ) of the diffusion matrix @xmath103 , it follows that there exist two constants @xmath104 and @xmath105 such that the following inequality holds @xmath106 then , one can obtain the penalty parameter @xmath102 as @xcite @xmath107 where @xmath11 denotes the smallest angle over all triangles in @xmath108 .",
    "the solution of sipg semi - discretized heston model is given as @xmath109 where @xmath110 and @xmath111 , @xmath112 , @xmath113 , are the basis functions spanning the space @xmath79 and the unknown coefficients , respectively .",
    "the number @xmath114 denotes the local dimension of each dg element with @xmath115 for 2d problems , and @xmath116 is the number of dg elements ( triangles ) . substituting into and choosing @xmath117 , @xmath118 , we obtain the following semi - linear system of ordinary differential equations ( odes ) for the unknown coefficient vector @xmath119 @xmath120 where @xmath121 is the mass matrix and @xmath122 is the stiffness matrix , with the entries @xmath123 and @xmath124 , @xmath125 . for the time discretization , we consider a subdivision of @xmath126 $ ] into @xmath127 time intervals @xmath128 $ ] of length @xmath129 , @xmath130 , with @xmath131 .",
    "we solve with rannacher smoothing @xcite applying four steps backward euler method with the step size @xmath132 and continuing with the crank - nicolson method with the step size @xmath133 , thus the same coefficient matrix is formed @xcite : @xmath134 the coefficient matrix is factorized by lu decomposition at the initial time step and used in all successive time steps , which makes the time integration efficient .",
    "in this section , heston pde is solved numerically for different types of options to show the accuracy and efficiency of the sipg method .    as the first test example",
    ", we consider european call options for which semi - analytical solutions can be obtained .",
    "the second test example is the convection dominated european call option pricing model solved by the adaptive dgfem .",
    "it is widely known that heston pde can be viewed as convection - dominated for low volatilities ; the numerical solutions exhibit oscillations around @xmath135 in the case of european call options , the heston pde becomes convection dominated especially for high foreign interest rates .",
    "we show also the performance of the sipg discretization with rannacher smoothing in time for butterfly and digital options with more non - smooth initial data than the european option .",
    "it is worth mentioning that there is no a consensus in the literature regarding the boundary conditions  @xcite .",
    "the main contentious issue is that some proposes to impose a boundary condition at @xmath136 if the feller - condition is disregarded , see for instance  @xcite . from the computational standpoint , when the parameters @xmath137 @xmath13 and @xmath11 of the squared - root process @xmath2 are not chosen according to condition @xmath138 @xmath2 can become zero for some points in time .",
    "thereby , an appropriate boundary condition at @xmath136 is required to solve heston s diffusion - convection - reaction equation ( [ convdiff_x ] ) . on the other hand , from the financial standpoint",
    ", the feller condition is not violated ; therefore , some discuss that it suffices to define a boundary condition at @xmath139 @xmath140 and @xmath141 . in that case ,",
    "pde ( [ convdiff_x ] ) is subject to an outflow boundary at @xmath142 see e.g. @xcite . the other controversy stems from the fact that one can find many different types of boundary conditions when pricing an option .",
    "therefore , it is not certain at which boundary condition heston s pde should be used to achieve highly accurate solutions . for a detailed discussion on boundary conditions in option pricing ,",
    "we refer to  @xcite .      to illustrate that sipg provides accurate solutions for heston s model",
    ", we consider the valuation of european call options due to the fact that its semi - analytical benchmark price can easily be derived , as mentioned in section [ model ] .",
    "let @xmath143 be the price of a european call option at time @xmath144 and let @xmath145 denotes its payoff @xmath146 with @xmath17 being the strike price of the option .",
    "we consider the diffusion - convection - reaction equation ( [ convdiff_x ] ) under the non - homogenous dirichlet boundary conditions  @xcite : @xmath147 with the initial condition @xmath148 .",
    "we note that for numerical simulations , the unbounded computational domain @xmath149 transformed to a bounded one @xmath150\\times [ -2,2]$ ] with a mesh and time step size @xmath151 @xmath152 .",
    "the parameters are set as in table [ dirichlet_parameters ]  @xcite .",
    "l*9cr @xmath10 & @xmath11 & @xmath13 & @xmath7 & @xmath8 & @xmath9 & @xmath18 & @xmath153&@xmath154 + 1.0 & 0.09 & 0.4 & -0.7 & 0.05 & 0.01 & 1 & 100 & 0.25 +    in table [ relativeerror_call ] , the numerical solutions obtained by the sipg are compared with semi - analytical ( closed form ) solutions given in section [ model ] .",
    "as it can be seen from the relative errors in table [ relativeerror_call ] , sipg turns out to provide highly accurate prices for the call option with different strike prices .",
    "one can also observe from table [ relativeerror_call ] that , the sipg method requires less cpu time ( in seconds ) than the monte carlo method using @xmath155 number of sample paths .",
    ".comparison with the closed form solutions and monte carlo simulation for different strike prices , @xmath156 : linear ( quadratic ) dg elements .",
    "[ relativeerror_call ] [ cols=\"<,>,>,^,>,^ \" , ]",
    "the numerical results provided in section  [ sec : numex ] demonstrate that dgfems are a very effective and accurate method for solving option pricing problems under heston model .",
    "the non - smooth boundary and initial conditions for various option pricing models can be handled in a natural way by the dgfems in combination with the rannacher smoothing in time , as compared with other discretization techniques used in the literature for option pricing .",
    "s.  l. heston , a closed - form solution for options with stochastic volatility with applications to bond and currency options , review of financial studies 6  ( 2 ) ( 1993 ) 327343 .",
    "http://dx.doi.org/10.1093/rfs/6.2.327 [ ] .",
    "b.  dring , m.  fourni , c.  heuer , high - order compact finite difference schemes for option pricing in stochastic volatility models on non - uniform grids , journal of computational and applied mathematics 271 ( 2014 ) 247  266 . http://dx.doi.org/10.1016/j.cam.2014.04.016 [ ] .",
    "d.  tangman , a.  gopaul , m.  bhuruth , numerical pricing of options using high - order compact finite difference schemes , journal of computational and applied mathematics 218  ( 2 ) ( 2008 ) 270280 . http://dx.doi.org/10.1016/j.cam.2007.01.035 [ ] .",
    "l.  v. ballestra , g.  pacelli , pricing european and american options with two stochastic factors : a highly efficient radial basis function approach , journal of economic dynamics and control 37  ( 6 ) ( 2013 ) 1142  1167 .",
    "http://dx.doi.org/10.1016/j.jedc.2013.01.013 [ ] .",
    "e.  pindza , k.  c. patidar , e.  ngounda , implicit - explicit predictor - corrector methods combined with improved spectral methods for pricing european style vanilla and exotic options , electron .",
    "40 ( 2013 ) 268293 .",
    "d.  n. arnold , f.  brezzi , b.  cockburn , l.  d. marini , unified analysis of discontinuous galerkin methods for elliptic problems , siam journal on numerical analysis 39  ( 5 ) ( 2002 ) 17491779 .",
    "http://dx.doi.org/10.1137/s0036142901384162 [ ] .",
    "j.  hozman , valuing barrier options using the adaptive discontinuous galerkin method , in : programs and algorithms of numerical mathematics 16 , acad .",
    "czech repub .",
    "prague , 2013 , pp . 9499 .",
    "d.  p. nicholls , a.  sward , a discontinuous galerkin method for pricing american options under the constant elasticity of variance model , communications in computational physics 17 ( 2015 ) 761778 .",
    "http://dx.doi.org/10.4208/cicp.190513.131114a [ ] .",
    "d.  schtzau , l.  zhu , a robust a - posteriori error estimator for discontinuous galerkin methods for convection-diffusion equations , applied numerical mathematics 59  ( 9 ) ( 2009 ) 2236  2255 . http://dx.doi.org/10.1016/j.apnum.2008.12.014 [ ] .",
    "s.  ikonen , j.  toivanen , efficient numerical methods for pricing american options under stochastic volatility , numerical methods for partial differential equations 24  ( 1 ) ( 2008 ) 104126 ."
  ],
  "abstract_text": [
    "<S> we consider interior penalty discontinuous galerkin finite element ( dgfem ) method for variable coefficient diffusion - convection - reaction equation to discretize the heston pde for the numerical pricing of european options . </S>",
    "<S> the mixed derivatives in the cross diffusion term are handled in a natural way compared to the finite difference methods . </S>",
    "<S> the advantages of dgfem space discretization and cranck - nicolson method with rannacher smoothing as time integrator for heston model with non - smooth initial and boundary conditions are illustrated in several numerical examples for european call , butterfly spread and digital options . </S>",
    "<S> the convection dominated heston pde for vanishing volatility is efficiently solved utilizing the adaptive dgfem algorithm . </S>",
    "<S> numerical experiments illustrate that dgfem is highly accurate and very efficient for pricing financial options .    option pricing , heston model , discontinuous galerkin method , adaptive grid    65m60 , 91b25 , 91g80 </S>"
  ]
}