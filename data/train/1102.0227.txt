{
  "article_text": [
    "early - universe inflation @xcite has become one of the key elements of the standard cosmological model @xcite . in this paradigm",
    "the universe went through a phase of accelerated expansion , which , in the simplest scenario is , driven by a scalar field , namely the inflaton .",
    "the predictions of inflation have been confirmed by the high - precision measurements of cmb @xcite and the large scale structure surveys @xcite . combining these observations with supernova @xcite , weak gravitational lensing @xcite and lyman-@xmath0 forest data @xcite , we find that the current universe is undergoing another cosmic acceleration @xcite",
    ". this could be due to a cosmological constant @xcite or another scalar field @xcite .",
    "it is hence important to understand the dynamics of scalar field(s ) in a perturbed friedmann - robertson - walker ( frw ) background @xcite . in many cases these scalar fields",
    "are almost homogeneous . thus linear or second - order perturbation theory is enough to describe such a system . however , there are exceptions .",
    "something that we can not avoid in any successful inflationary model is the decay of the inflaton after inflation .",
    "this could start with preheating , a nonperturbative violent process due to parametric resonance or tachyonic growth of fluctuations @xcite .",
    "the typical comoving scale of preheating is much smaller than current cosmological scales .",
    "however , cosmological - scale comoving curvature fluctuations can also be generated via , e.g. , preheating modulated by a field that is light during inflation but becomes heavy at the end of inflation  @xcite .",
    "moreover , the stochastic background of gravity waves ( gws ) generated during preheating @xcite is , in principle , observable .",
    "in particular , gws from preheating after hybrid inflation may be observable with the next generation of gw probes @xcite , although this depends on the parameters in this model .",
    "see also @xcite , where the parameter space is systematically explored . for more models suggesting potential observables from preheating , the reader is referred to refs .",
    "@xcite .    to make quantitative predictions of the observables from preheating ,",
    "one often needs to run full nonlinear lattice simulations . in the previously mentioned gw calculations ,",
    "the evolution of scalar fields is done in configuration space using the public available code latticeeasy @xcite or unreleased codes with similar techniques .",
    "the linear metric perturbations are evolved either in configuration space @xcite or in fourier space @xcite . in these treatments , a traceless - transverse ( tt ) `` tensor mode '' is defined in fourier space @xcite : @xmath1_{ij , lm}h_{lm,\\vect{k}}\\ , \\label{ttdef_fourier}\\ ] ] where @xmath2 are the metric perturbations in synchronous gauge @xcite .",
    "the fourier - space matrix form of the tt projector , @xmath3 , is given by @xmath4_{ij , lm}\\equiv p_{il}\\left(\\vect{k}\\right)p_{mj}\\left(\\vect{k}\\right ) -   \\frac{1}{2 } p_{ij}\\left(\\vect{k}\\right ) p_{lm}\\left(\\vect{k}\\right)\\ , \\ ] ] where @xmath5 here @xmath6 is the kronecker delta .",
    "if not otherwise stated , repeated indices are implicitly summed over .",
    "the latin indices run from 1 to 3 ( spatial indices ) .",
    "the greek indices run from 0 to 3 ( temporal and spatial indices ) .",
    "one could also define the tt component in configuration space : @xmath7 where @xmath8 here @xmath2 is decomposed into two scalar components ( @xmath9 and @xmath10 ) , one vector component ( @xmath11 ) and one tensor component ( @xmath12 ) .",
    "the tracelessness of @xmath12 can be confirmed by taking the trace of eq .   and",
    "by using eq .  .    in the continuous case",
    ", definition   is equivalent to definition  .",
    "but this is not so for a periodic and cubical box with length @xmath13 and @xmath14 grid points , in which the spatial derivatives in eq .",
    "are replaced by finite difference .",
    "this is discussed in detail in .",
    "the discrepancy between definitions   and   leads to scalar - tensor mixing : the scalar part of the energy - momentum tensor , calculated in configuration space using discrete derivatives ( finite difference ) , can produce gw in fourier space defined by eq .  . at scales where the scalar components dominate , it is difficult to suppress this `` noise '' or distinguish it from the physical gw . simulations with very high resolution ( @xmath15 ) , which might solve the problem ,",
    "are not favored , practically , as they are numerically expensive and often limited by the machine memory . in the new code hlattice that i will present in the paper , i define , evolve , and",
    "extract scalar , vector , and tensor modes consistently in configuration space .",
    "even though the discrepancy between real ( continuous ) physics and the numerical ( discrete ) model can not be completely removed in any numerical calculations , in hlattice the scalar , vector and tensor parts of the metric perturbations are only sourced , respectively , by the scalar , vector , and tensor parts of the energy - momentum tensor .    in other public available lattice codes , such as latticeeasy , defrost @xcite , and cudaeasy @xcite ,",
    "the scalar fields are evolved in a frw background , and metric perturbations are ignored .",
    "but at linear level one can approximately take the energy - momentum tensor of the scalar fields as a source , and evolve gw outside the simulation .",
    "( therefore , the scalar - tensor mixing effect is a problem in post - processing .",
    "it should not be regarded as a problem of these lattice codes . )",
    "since this is a linear treatment , the tt component separation could be done at the end of the calculation  @xcite . except for ref .",
    "@xcite , which i will discuss separately in , the previous works on gws from preheating are all based on this ( or a similar ) approach . in these calculations ,",
    "the feedback of metric perturbations to the dynamics of scalar fields is ignored or partially ignored .",
    "hlattice is the first code released that consistently evolve all components of metric perturbations together with the scalar fields .",
    "using hlattice i find the metric feedback , as conjectured in previous works , is indeed not a dominating effect , at least for the models studied in this paper .    in some situations , in order to capture some small effects @xcite or energy - insensitive modes @xcite , we need to evolve the system of scalar fields and metric perturbations accurately .",
    "in hlattice i use a sixth - order symplectic integrator for global evolution , and a fourth - order runge - kutta integrator @xcite with refined time steps for the noncanonical terms only .",
    "the advantage of doing so is that no extra memory cost is required . with this integrator the fractional energy noise of the system",
    "can be suppressed to @xmath16 .",
    "this enables us to check the conservation of the total hamiltonian , including the tiny contribution from energy carried by gravity waves .",
    "this is the first time that we can use the constraint equation to accurately check the numerical accuracy in calculations of gw from preheating .",
    "this paper is organized as follows . in i",
    "introduce the hlattice code ; in i use hlattice to calculate gw from preheating .",
    "i discuss and conclude in .",
    "the system that we consider contains @xmath17 canonical scalar fields @xmath18 with a potential @xmath19 .",
    "the action reads @xmath20 where @xmath21 , @xmath22 being the spacetime metric ; @xmath23 is the reduced planck mass , related to newton s gravitational constant @xmath24 via @xmath25 ; @xmath26 is the ricci scalar @xcite .",
    "the spacetime metric can be written in synchronous gauge @xcite : @xmath27 natural units @xmath28 are used .    in the context of inflation , we are interested in an expanding and spatially flat universe , where the metric @xmath29 is often written as @xmath30 in a finite volume @xmath31 , we choose @xmath32 to be the `` scale factor , '' given by @xmath33 the hubble parameter is defined as @xmath34 where a dot denotes the derivative with respect to time coordinate @xmath35",
    ".    we will consider weak gravitational fields that satisfy the condition @xmath36 .",
    "for a problem that requires long - time integration , a growing nonphysical gauge mode might spoil this condition .",
    "this specific case is discussed in .    in hlattice",
    "i choose to evolve the following variables @xmath37 where @xmath38 is the @xmath39 matrix @xmath29 .",
    "the matrix function @xmath40 should be understood as @xmath41 where @xmath42 is the @xmath39 identity matrix . to the linear order , we have @xmath43    it follows from eq .   that the traceless part of @xmath44 , which we define as @xmath45 , satisfies @xmath46 this implies that @xmath47 for arbitrary @xmath48 .",
    "this significantly simplifies the procedure to expand an arbitrary function of @xmath44 to a given order in @xmath2 we just need to replace @xmath44 with @xmath49 and cut the taylor expansions in @xmath45 at the same order . in the rest of this subsection , we will do this for the metric and for the action .",
    "let us first calculate the volume weight @xmath50 . using the fact that @xmath51 , we find a simple and exact expression : @xmath52 where @xmath53 is the trace of @xmath44 .",
    "writing the @xmath39 matrix @xmath45 as @xmath54 , we can rewrite the @xmath39 matrix @xmath29 as @xmath55    by taking the inverse of @xmath38 we obtain @xmath56    we can substitute , for example , @xmath57 with @xmath58 . with such substitutions and ignoring @xmath59 terms , we can write @xmath60 as functions of @xmath44 : @xmath61 the difference between the left - hand side and the right - hand side of each equation is less than or equal to @xmath62 .",
    "it is obvious that such approximations are not unique , as one can add arbitrarily more higher - order terms on the right - hand side of each equation .",
    "the specific choice i made in eqs .   is based on three criteria :    * simplicity ; * less @xmath62 residual error terms ; * under a coordinate transformation @xmath63 ( @xmath64 , @xmath65 is a constant ; the metric transforms as @xmath66 ) , the approximated expression of @xmath60 scales as @xmath67 , just as the exact @xmath60 should .",
    "the last requirement enforces the gradient energy density @xmath68 , with the approximations of @xmath60 in eqs .",
    "being used , to remain exactly invariant .",
    "this allows us to perform a spatial coordinate transformation @xmath69 without producing any extra error terms .",
    "this can be used to optimize the hlattice code . in hlattice , after every few evolution steps the coordinate redefinition @xmath69 is performed , where @xmath65 is chosen to be the scale factor _ at the moment_. after such a transformation , the scale factor is redefined to be @xmath70 and @xmath44 is made small .",
    "the exponential functions in eqs .   can thus be evaluated via the approximation @xmath71",
    "^ 2\\right\\}^2\\ , \\",
    "{ \\rm for}\\ |x|\\ll 1 .",
    "\\label{exapp}\\ ] ] for a program built with fortran code , the evaluation of the right - hand side of is about twice as fast as that of @xmath72 .",
    "this significantly improves the performance of hlattice .",
    "confusion should be avoided here .",
    "the frw background is intrinsically different from a minkowski background . in the calculation , by adaptively changing the coordinate system , it is possible to keep the scale factor close to @xmath70 and to keep @xmath44 small .",
    "however , when deriving the theoretical formulas , we should work in a fixed coordinate system and _ can not _ assume that @xmath44 is small .",
    "the action   can be written as @xmath73 where @xmath74 is the _ kinetic energy of the scalar fields _ , @xmath75 @xmath76 is the _ gradient energy of the scalar fields _",
    ", @xmath77 @xmath78 is the _ potential energy of the scalar fields _",
    ", @xmath79 @xmath80 is the _",
    "`` kinetic energy '' of gravity _ , approximated to second order in @xmath2 by @xmath81 and @xmath82 is the _",
    "`` gradient energy '' of gravity _ , approximated to second order in @xmath2 by @xmath83 where @xmath84 . in eq .",
    "i have approximated the local volume weight @xmath85 with a global scale factor @xmath32 .",
    "this is valid since the integrand in eq .",
    "is of second order in @xmath2 . in eq .",
    "such a replacement is not allowed , as the integrand is of zeroth order . with the bilinear approximation",
    ", hlattice can not capture the gravity self - interaction , which in principle can be important on small scales .",
    "this is discussed in .",
    "equations  ( [ kgdef]-[ggdef ] ) are obtained using the same technique that i used to derive eqs .  ,",
    "i.e. , rewriting @xmath44 as @xmath86 and cutting the taylor expansions of @xmath45 at the second order .",
    "the simplicity of the final expression of @xmath80 is the main reason why i have used @xmath44 as fundamental variables in hlattice .",
    "it is also easy to verify that the right - hand sides of eqs .",
    "( [ kfdef]-[ggdef ] ) are all exactly invariant under the spatial - coordinate redefinition @xmath69 .      in this subsection",
    "i answer or attempt to answer the following questions :    * what exactly is calculated in a lattice simulation ?",
    "* how do we choose a discretization scheme to include metric perturbations ? * how do we define the scalar , vector , and tensor on the lattice ?    before answering these questions , let us briefly review the lattice theory and the discrete fourier transformation ( dft ) .",
    "i label a grid point in the lattice with three integer numbers @xmath87 and apply the periodic boundary condition ( pbc ) @xmath88 where @xmath89 is a fixed integer representing the resolution of the simulation ; @xmath90 represents all physical quantities including the scalar fields , the metric , and their temporal / spatial derivatives .",
    "given the pbc , we only need to evolve @xmath91 in a cubical fundamental box containing @xmath14 grid points ( @xmath92 ) . in",
    "what follows i will use the notation @xmath93 to denote the summation over grid points in this fundamental box .",
    "the dft is defined as @xcite @xmath94 where @xmath95 is the imaginary unit and @xmath96 are arbitrary integers .",
    "unless otherwise stated , the overhead tilde sign represents variables in fourier space .",
    "it is easy to verify that in fourier space @xmath97 also satisfies the pbc @xmath98 moreover , if a field satisfies the pbc in fourier space , it also satisfies the pbc in configuration space .",
    "thus in what follows we no longer distinguish between the two pbcs .",
    "similarly we define a fourier - space fundamental box with @xmath99 .    the _ standard dft wave vector _",
    "is defined as @xmath100 where @xmath13 is the coordinate length of each edge of the fundamental box in configuration space .",
    "the amplitude of @xmath101 is @xmath102    i will use the subscripts `` disc '' and `` cont '' to distinguish between quantities evaluated on the discrete lattice or in a continuum .",
    "these subscripts are often omitted when it does not give rise to ambiguity .      in latticeeasy , defrost , and cudaeasy , the metric perturbations are ignored .",
    "scalar fields are evolved in configuration space .",
    "the lattice - version equation of motion ( eom ) of the scalar fields is @xmath103 where @xmath104 is the discrete laplacian operator .    in this subsection",
    "we will discuss an idealized case where the temporal differential operator @xmath105 can be perfectly integrated .",
    "moreover , the numerical errors in @xmath32 and other background quantities are assumed to be negligible .",
    "these assumptions can be quite close to the reality , if a high - order integrator is used in the lattice code .",
    "the only spatial operator that appears in the eom is the laplacian operator @xmath104 , which can be directly defined without referring to any first - order discrete derivatives .",
    "for example , in latticeeasy @xmath104 is defined as @xmath106 where @xmath107 is the coordinate distance between neighboring points in configuration space . by taking the dft of the above equation , we obtain its equivalent form in fourier space , @xmath108 where @xmath109 because both @xmath110 and @xmath111 satisfy the pbc , their ratio @xmath112 should also .",
    "this can be explicitly checked in eq .  .",
    "the reader should keep in mind that eq .",
    "is a consequence of the latticeeasy definition of discrete @xmath104 . in other lattice codes",
    "the definition of discrete @xmath104 ( and hence @xmath113 ) can be different .",
    "using eq .",
    "we rewrite the eom , eq .   in",
    "fourier space : @xmath114\\left.\\dft{\\phi}_\\ell\\right\\vert_{j_1,j_2,j_3 } \\nonumber \\\\",
    "+ \\left.\\dft{\\left(\\frac{\\partial v}{\\partial \\phi_\\ell}\\right)}\\right\\vert_{j_1,j_2,j_3 } = 0\\ . \\label{diseomdft}\\end{aligned}\\ ] ]    equation   is the equation being integrated on the lattice . comparing it to the continuous - case eom for a mode @xmath115 , we find that the only discrepancy comes from the difference between the dft of @xmath116 and the continuous fourier transformation of it .",
    "this discrepancy is model dependent and difficult to quantify in the nonlinear regime .",
    "however , in the linear regime , as i will show below , this discrepancy vanishes .    in the linear regime",
    ", we can rewrite the lattice - version eom in configuration space as @xmath117 where @xmath118 represents the lattice average @xmath119 .",
    "the field perturbation @xmath120 is defined as @xmath121    the fourier - space version of eq .",
    "is @xmath114\\left.\\dft{\\delta\\phi}_\\ell\\right\\vert_{j_1,j_2,j_3 } \\nonumber \\\\",
    "+ \\langle\\frac{\\partial^2 v}{\\partial\\phi_{\\ell'}\\partial\\phi_\\ell}\\rangle\\left.\\dft{\\delta\\phi}_{\\ell'}\\right\\vert_{j_1,j_2,j_3 } = 0\\ , \\label{diseomptdft}\\end{aligned}\\ ] ] which is _ identical _ to the continuous - case eom for a linear mode with wavenumber @xmath122 .",
    "if we interpret @xmath113 as the physical wavenumber , in the limit that a perfect integrator is used , all the linear modes will be correctly solved on the lattice . in other words , in a lattice code with a good integrator , the difference between a discrete system and a continuum does not matter in the linear regime .",
    "what has been discussed above is well known to the lattice community . however , in many previous works , @xmath123 in the fundamental box is interpreted as the physical wavenumber @xcite .",
    "this is usually not a serious problem . with a good definition of discrete @xmath104 , @xmath113 should be close to @xmath123 in the fundamental box . however , there are exceptions where the difference between @xmath113 and @xmath123 is relevant .",
    "one specific case is the calculation of gws that i will discuss later .",
    "we have seen that defining the discrete @xmath104 in configuration space is equivalent to defining a kernel @xmath112 in fourier space .",
    "first of all , the kernel should satisfy the pbc .",
    "second , since the linear modes on the lattice behave like linear modes with @xmath122 in a continuum , we should restrict @xmath124 to be positive to avoid nonphysical tachyonic growth .",
    "third , for practical purpose , in configuration space the discrete operator @xmath104 should involve only a few neighbors .",
    "thus the functional form of @xmath125 is limited to be a low - order polynomial of @xmath126 , @xmath127 , and @xmath128 .",
    "finally , we want to choose a @xmath124 that is close to @xmath129 , as we want the nonlinear - regime mode - mode coupling on the lattice to mimic the real physics in a continuum .    using eq .  , the reader can verify that the latticeeasy discrete @xmath104 satisfies all the above conditions . moreover , in configuration space",
    "it is accurate to the linear order of @xmath130 : @xmath131 while this discretization scheme is simple and reasonably accurate , there may be various reasons to improve it . for example , the discretization scheme in defrost improves the isotropy of @xmath104 without much additional computational cost @xcite . in defrost the default discrete @xmath104 is defined as @xmath132 where @xmath133 , @xmath134 , @xmath135 , and @xmath136 .    for hlattice , which includes metric perturbations ,",
    "however , the discretization problem is much more complicated , for the reasons that i list below .    * the governing equations for the metric perturbations are rather complicated .",
    "it is possible that nonphysical tachyonic growth arises in metric perturbations even when the discrete @xmath104 is negative definite . *",
    "the field eoms now involve first - order derivatives of the fields , whose discrete forms should be properly defined and should be consistent with the lattice @xmath104 . * with the metric perturbations , the gradient energy terms ( @xmath76 and @xmath82 ) are much more complicated .",
    "this prevent us from choosing complicated discretization schemes , whose computational cost would be intolerable .    to address the first point , i run hlattice for empty spacetime with initial small noises in the metric , and verify that the noises do not grow .",
    "i propose that such a null test should be done for any discretization schemes of gravity .    following the last two points , in the first released version of hlattice ( hlattice  v1.0 )",
    "i have used the simplest discrete @xmath137 that is accurate to the linear order of @xmath130 : @xmath138    the equivalent fourier - space form can be achieved by taking dft of eqs .  .",
    "the result is : @xmath139 the above equations can be written in a more compact form @xmath140 where the effective wave vector @xmath141 is @xmath142    thus the fourier - space kernel for @xmath143 is + @xmath144 either taking the inverse dft of eq .   or repeatedly using eq .  , we obtain the configuration - space definition of discrete @xmath104 in hlattice  v1.0 : @xmath145 this discrete @xmath104 is also negative definite and accurate to linear order of @xmath130 .",
    "however , with this definition of @xmath104 , if the metric backreaction is negligible and @xmath89 is an even number , a grid point on the lattice will never interact with its neighbors .",
    "the fourier - space point of view is that @xmath113 in eq .",
    "satisfies a stronger pbc : @xmath146 which indicate that we are only studying modes within a smaller fundamental box .",
    "the higher modes ( interaction between neighboring points ) are not included in this discretization scheme .",
    "being unsatisfied with the discretization scheme in hlattice  v1.0 , i introduced a new discretization scheme in the current version of hlattice , hlattice  v2.0 .",
    "the discrete derivatives are defined as @xmath147\\ , \\nonumber \\\\",
    "\\left.\\partial_2\\right\\vert_{i_1,i_2,i_3 } f & \\equiv & \\frac{1}{12\\delta}\\left[8\\left(f_{i_1 , i_2 + 1 , i_3 } - f_{i_1,i_2 - 1,i_3})\\right.\\right .",
    "\\label{derv2 } \\\\ & & \\left.\\left.-(f_{i_1,i_2 + 2,i_3}-f_{i_1,i_2 - 2,i_3}\\right)\\right]\\ , \\nonumber \\\\",
    "\\left.\\partial_3\\right\\vert_{i_1,i_2,i_3 } f & \\equiv & \\frac{1}{12\\delta}\\left[8\\left(f_{i_1 , i_2 , i_3 + 1 } - f_{i_1,i_2,i_3 - 1})\\right.\\right .",
    "\\nonumber \\\\ & & \\left.\\left.-(f_{i_1,i_2,i_3 + 2}-f_{i_1,i_2,i_3 - 2}\\right)\\right]\\ , \\nonumber\\end{aligned}\\ ] ] whose fourier - space form is @xmath148 where the effective wave vector @xmath141 is @xmath149 this discrete @xmath137 is two - orders more accurate : @xmath150 .    explicitly written in configuration space , the discrete @xmath104 in hlattice",
    "v2.0 is @xmath151 \\label{hl2nabla2}\\end{aligned}\\ ] ]    finally , i summarize all the discretization schemes in table  [ tbldisc ] .",
    ".discretization schemes of lattice codes .",
    "the `` accuracy '' is defined as @xmath152 .",
    "[ tbldisc ] [ cols=\"<,<,<,<\",options=\"header \" , ]",
    "in this section i use hlattice to calculate gravitational waves from tachyonic preheating after hybrid inflation @xcite . following @xcite ,",
    "i assume a real inflaton field @xmath153 and a complex field @xmath154 .",
    "the potential reads @xmath155 where @xmath156 .    for illustration purpose ,",
    "i fix the parameters that have been used in figure  4 of @xcite : @xmath157 , and @xmath158 , where @xmath159 is the critical point where inflation ends . at the beginning of the simulation ,",
    "the initial metric perturbations are all set to zero and @xmath160 is defined to be @xmath70 .",
    "the @xmath161 field is initialized with random gaussian fluctuations with `` vacuum - fluctuation '' amplitude @xmath162 and @xmath163 , where @xmath164 , as @xmath161 is massless at the beginning of simulation .",
    "this is an approximation using the classical lattice simulation to mimic how these quantum vacuum modes become classical due to the tachyonic instability . since the growth of @xmath165 is exponential , this approximation",
    "is expected to be good .",
    "another problem is that , physically , gravity should not respond to these unrenormalized vacuum modes , while on the classical lattice it does respond to them .",
    "however , since @xmath161 is light and the lattice uv cutoff is not too high , the nonphysical @xmath2 excited by these initial @xmath161 fluctuations is negligible .",
    "the inflaton @xmath153 is set to be initially homogeneous , for two reasons : ( i ) at the beginning , the dominating physics is the tachyonic growth of @xmath161 fluctuations .",
    "later @xmath153 fluctuations are excited and enhanced by the inhomogenous @xmath166 field .",
    "the vacuum flutuations in @xmath153 remain irrelevant here .",
    "( ii ) the renormalization problem is more severe for the @xmath153 field , as at the beginning the energy fluctuations are more sensitive to @xmath153 fluctuations .",
    "the gw energy spectrum computed using hlattice is shown in .",
    "the fractional energy of gws per e - fold , @xmath167 , is defined as @xmath168 where @xmath90 is the gw frequency and @xmath169 is the energy density of the gw . here",
    "the critical density , defined as @xmath170 , in a spatially flat universe is the same as the mean energy density .",
    "i have converted the gw energy spectrum to present - day observables in .",
    "@xmath171 is defined by replacing all quantities by today s observables in eq .  .",
    "i have used eqs .",
    "( 35 - 36 ) in ref .",
    "@xcite to convert the simulation output to present - day observables .",
    "see also ref .",
    "@xcite for a more detailed derivation of these formulas .",
    "gravity waves from tachyonic preheating after hybrid inflation calculated using hlattice v1.0 with metric perturbations and fixed spatial coordinates .",
    "the simulation resolution is @xmath172 .",
    "the model and parameters are the same as those that have been used in figure  4 of @xcite . here",
    "@xmath173 is the fractional energy of gw ( per efold in frequency @xmath90 ) that would be observed today ( assuming radiation domination after preheating ) ; @xmath9 is the current hubble parameter in unit of @xmath174 .",
    "the outputs are plotted from bottom to top per unit time step @xmath175 , where @xmath176 is the critical point where inflation ends .",
    "the lattice simulation is initiated at @xmath177 , where i define @xmath178 and the box size of simulation @xmath179 . ]    in this model , gw are produced during two stages .    in the first stage",
    ", @xmath153 can be approximated as @xmath180 .",
    "the mass square of the @xmath161 field is approximately @xmath181 the infrared modes @xmath182 first start to grow .",
    "as @xmath35 increases , more and more modes become tachyonic and begin to grow .",
    "bubbles of @xmath161 field are created in this process , producing gravity waves on roughly the same scales @xcite .",
    "this can be seen from the lower part of .    in the second stage",
    ", @xmath153 condensate is broken due to the coupling between @xmath153 and @xmath161 .",
    "the estimation is no longer valid .",
    "the typical scales of inhomogeneity rapidly shift towards @xmath183 , producing gw waves on these scales . at low @xmath184 the gw spectrum saturates at a stationary level , as shown in the upper part of .",
    "the saturated low - frequency part of gw is what we are interested in , as it can potentially be observed with future gw probes such as bbo @xcite .     the comparison between energy carried by gw and numerical energy noise .",
    "the simulation is the same one as that described in .",
    "all the quantities are evaluated at the end of the simulation where @xmath185 .",
    "the solid red line is @xmath186 , where @xmath187 is the total gradient energy of @xmath153 and @xmath161 fields , and @xmath188 the total energy carried by them .",
    "the dot - dashed cyan line is @xmath189 , where @xmath82 is the `` gradient energy '' of gravity defined in .",
    "the dashed black line is @xmath190 , where @xmath191 is the energy carried by gw .",
    "the dotted blue line is @xmath192 , with @xmath193 being the total hamiltonian given by eq .  .",
    "]    when gravity is included , the constraint equation is always @xmath194 regardless of the matter content of the system . this constraint equation can be used to estimate the numerical energy noises . in i",
    "plot the energy carried by gw and the total hamiltonian @xmath193 , both divided by the energy carried by the scalar fields for comparison . the contribution of energy carried by gw saturates to @xmath195 , while the final numerical energy noise is @xmath196 . in other words ,",
    "energy conservation has been checked at the level of about 0.1% of the energy carried by gw .    comparing the `` gradient energy '' of gravity @xmath82 shown in to the energy carried by gw",
    ", we can estimate @xmath197 for the dominating modes . in this example , the relative contribution of gw due to an imperfect tt projector could be as high as @xmath198 , i.e. , about @xmath199 times larger than the physical gw spectrum shown in .",
    "this provides a possible explanation for why the gw spectra found in previous works ( see @xcite and references therein ) are generally larger than what i have obtained using hlattice .",
    "however , the discrepancy could also be due to the fact that i have included the expansion of the universe , which is ignored in ref .",
    "@xcite . finally , due to the memory limitation",
    ", i can not achieve the same high spatial resolution as in ref .",
    "@xcite , which the authors found is also important for this model .    the feedback from metric perturbations , however , is found to be irrelevant for this model .",
    "no significant difference has been found in the power spectra of the scalar fields between simulations with and without metric perturbations .",
    "the example we have shown in the previous section , although being observationally interesting , is physically complicated .",
    "the gw energy spectrum has two peaks due to different physics at two stages .",
    "mode - mode coupling in a wide range of scales becomes important in the nonlinear regime , which can hardly be captured by a simulation with @xmath172 . the result shown in needs to be further studied with a simulation with much higher resolution if hlattice can be mpi - parallelized .    to better understand the scalar - tensor mixing problem ,",
    "it is better to take a simple example that has been well studied and well understood , and can be fully captured by a simulation with resolution @xmath172 . here",
    "i take the example of preheating after chaotic inflation , @xmath200 the parametric - resonance bands and floquet exponents for this model have been studied in detail in ref .",
    "i choose the parameter @xmath201 and @xmath202 .",
    "this set of parameters has been studied in refs .",
    "@xcite . for @xmath203 the floquet exponent @xmath204",
    "is shown in figure  [ muk ] .",
    "the dominating mode and the boundary of the first resonance band , and the dominating mode in the second resonance band are labeled with dashed sky - blue , green and cyan lines , respectively .",
    "for @xmath205 in the preheating model @xmath206 with @xmath207 , where @xmath208 is the conformal time in units of @xmath209 and @xmath184 is the comoving wave number in units of @xmath210 .",
    "here @xmath211 and @xmath212 are the conformal field values ; @xmath213 is the amplitude of background @xmath214 oscillations in the linear regime .",
    "the dashed sky - blue , green and cyan lines are three characteristic scales that will be compared to the simulation results.[muk ] ]    i initialize the fields with `` vacuum - amplitudes '' random gaussian fluctuations with a cutoff @xmath215 ( where @xmath216 does not significantly differ from @xmath217 ) .",
    "this covers the resonance band shown in figure  [ muk ] .",
    "the simulation resolution is @xmath172 .",
    "the box size at the beginning of the simulation is @xmath218 , where @xmath219 is the latticeeasy default initial background value of @xmath153 , and @xmath220 is the initial hubble parameter .",
    "the scale factor @xmath160 is defined to be @xmath70 at the beginning of the simulation . here , in order to compare my result with the previous works , i have used the same simulation configurations that have been used in refs .",
    "@xcite . for this model , it is better to use conformal time as a time variable . in this simulation",
    "i thus do not include the backreaction of metric fluctuaions , which requires the coordinate @xmath35 to be the physical time .",
    "the output of gw energy spectra is shown in figure  [ gwcomp ] . in the ir part , both the gw projected by @xmath221 and that by @xmath222 agree with the results found in previous works  @xcite . on the intermediate scales ,",
    "the gw mapped by @xmath222 is significantly higher than that by @xmath221 , though @xmath216 and @xmath217 are close to each other . in this example , only @xmath223-@xmath224 of the @xmath225 wave vectors are in the trustable region , the shaded region of the lower panel in figure  [ gwcomp ] , where the difference between @xmath222 and @xmath221 is negligible .",
    "this is also @xmath226 dependent .",
    "for a problem with smaller @xmath226 , the trustable region can be even smaller .",
    "we have shown in that at the linear level a mode on the lattice exactly follows the eom with @xmath122 and that @xmath221 can completely remove the scalar and vector components defined by the discrete derivatives .",
    "therefore , we may argue that we should trust @xmath221 rather than @xmath222 .",
    "however , this argument becomes vague in the nonlinear regime .",
    "more discussion along this line is given in .",
    "nevertheless , what has been explicitly shown here is that caution needs to be taken for most of the modes on the lattice .     with @xmath201 and @xmath202 .",
    "the simulation uses the hlattice  v2.0 discretization scheme and ignores metric feedback .",
    "the box size is @xmath227 .",
    "the blue solid line and red dashed line are gw projected with @xmath221 and with @xmath222 , respectively . in both cases",
    "a cutoff @xmath228 in fourier space has been used . in the upper panel",
    "the output at @xmath229 , @xmath230 , ... , @xmath231 are shown from the bottom to top . in the lower panel",
    "only the outputs in the nonlinear regime ( from bottom to top , @xmath232 , @xmath233 , ... , @xmath231 ) are shown .",
    "the shaded regions in the lower panel are the regions containing 1% ( dark ) and 3% ( dark and light ) of the @xmath217 modes in the fundamental box ( @xmath234 ) . in both panels",
    "the characteristic scales shown in are plotted with the same color code.[gwcomp],title=\"fig : \" ]   with @xmath201 and @xmath202 .",
    "the simulation uses the hlattice  v2.0 discretization scheme and ignores metric feedback .",
    "the box size is @xmath227 .",
    "the blue solid line and red dashed line are gw projected with @xmath221 and with @xmath222 , respectively . in both cases",
    "a cutoff @xmath228 in fourier space has been used . in the upper panel",
    "the output at @xmath229 , @xmath230 , ...",
    ", @xmath231 are shown from the bottom to top . in the lower panel",
    "only the outputs in the nonlinear regime ( from bottom to top , @xmath232 , @xmath233 , ... , @xmath231 ) are shown .",
    "the shaded regions in the lower panel are the regions containing 1% ( dark ) and 3% ( dark and light ) of the @xmath217 modes in the fundamental box ( @xmath234 ) .",
    "in both panels the characteristic scales shown in are plotted with the same color code.[gwcomp],title=\"fig : \" ]    in the energy spectra of the @xmath166 field are plotted , where @xmath235 is defined as @xmath236 $ ] .",
    "( i have used the wavenumber @xmath184 instead of the frequency @xmath237 to avoid ambiguity in the nonlinear regime , where @xmath237 is ill - defined . )",
    "the growth of @xmath235 in the linear regime ( @xmath238 ) agrees excellently with the theoretical expectation shown in . in the nonlinear regime ,",
    "the energy spectrum still peaks around the resonance band until @xmath239 .",
    "energy cascading becomes important at @xmath240 .",
    "when the energy is peaked in a narrow band , energy cascading is efficient .",
    "the energy spectrum is soon smoothed at @xmath241 .",
    "uv cascading slowly goes on after @xmath241 .",
    "however , due to the finite resolution of the simulation , uv cascading gradually becomes nonphysical on the lattice .",
    "when the energy spectrum becomes flat , uv cascading will be strongly affected by the lattice uv cutoff and should no longer be trusted .",
    "physically , uv cascading in a continuum will continue until it is cut off by the quantum effect at very high energy scales where @xmath242 is comparable to the background energy density . in this sense ,",
    "the classical lattice simulation can not predict a `` final shape '' of the spectrum .",
    "the hope is that , however , other physics such as reheating will take place to stop the cascading at some diffusion scale .",
    "field for the preheating model @xmath206 with @xmath201 and @xmath202 .",
    "here @xmath184 is the effective wavenumber @xmath113 ; @xmath235 is defined as @xmath236 $ ] ; @xmath243 is the mean energy density .",
    "the simulation uses the hlattice  v2.0 discretization scheme and ignores metric feedback .",
    "the box size is @xmath227 .",
    "the gray lines from light to dark correspond to @xmath244 , @xmath199 , @xmath245 , @xmath230 , ... , @xmath231 .",
    "the characteristic scales shown in figure  [ muk ] are plotted with the same color code.[pwcomp ] ]",
    "in it was shown that a tt projector @xmath222 leads to a numerical noise in gw , which , depending on the tensor - to - scalar ratio and the uv cutoff used in the calculation , may or may not be negligible .",
    "this theoretical prediction has been confirmed in , where the difference between gw amplitudes calculated with different tt projectors is explicitly shown .",
    "it is also shown that the default tt projector in hlattice , @xmath221 , can perfectly remove the scalar and vector components defined by the discrete form of eq .  . since defining the discrete derivatives and",
    "@xmath3 is a complicated part of the code , it is better to check if the actual code agrees with this theoretical prediction . in i",
    "show a null test . in the null test , a random gaussian field @xmath10 with a scale - invariant spectrum and r.m.s .",
    "amplitude @xmath246 is generated on a lattice with resolution @xmath172 .",
    "this field is shown in the upper - left panel of each sub - figure . when generating the random field @xmath10 , a cutoff @xmath247 is used in sub - figure ( a2 ) and ( b2 ) , and @xmath248 in ( a3 ) and ( b3 ) .",
    "the discrete derivatives @xmath249 are calculated using either the hlattice  v1.0 discretization scheme ( left column , sub - figures a1-a3 ) or the hlattice  v2.0 discretization scheme ( right column , sub - figures b1-b3 ) .",
    "one component @xmath250 is shown in the upper - right panel of each sub - figure .",
    "the dft of @xmath251 projected under @xmath222 are inverse fourier transformed back to configuration space .",
    "the component @xmath250 after the tt projection is shown in the lower - left panel of each sub - figure .",
    "similarly , @xmath250 after tt projection with @xmath221 is shown in the lower - right panel of each sub - figure .",
    "( a1 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details .",
    "[ nulltest],title=\"fig:\"](b1 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details .",
    "[ nulltest],title=\"fig : \" ] + ( a2 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details . [",
    "nulltest],title=\"fig:\"](b2 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details .",
    "[ nulltest],title=\"fig : \" ] + ( a3 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details . [",
    "nulltest],title=\"fig:\"](b3 ) ; the upper - right panel is a 2d slice of @xmath250 , where @xmath252 ; the lower - left panel is a 2d slice of @xmath250 after tt projection under @xmath222 ; the lower - right panel is a 2d slice of @xmath250 after tt projection under @xmath221 . in sub - figures ( a1-a3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figure ( b1-b3 ) , the discrete @xmath253 is defined in eqs .  .",
    "in sub - figures ( a2 ) and ( b2 ) , a fourier - space cutoff @xmath247 is applied when generating the @xmath10 field , while this cutoff is @xmath248 for sub - figures ( a3 ) and ( b3 ) .",
    "see the text for more details .",
    "[ nulltest],title=\"fig : \" ]    we have confirmed that in the code the scalar component @xmath254 vanishes under the tt projector @xmath221 .",
    "( the @xmath255 level noise is due to the round - off errors in the dft and inverse dft calculations . ) with the same cutoff in sub - figures ( a3 ) and ( b3 ) , the difference between @xmath222 and @xmath221 is much smaller in hlattice  v2.0 .",
    "this again confirms that @xmath256 defined by eqs .",
    "is a better approximation to @xmath257 .",
    "although the projector @xmath221 perfectly matches the configuration - space definition of gws , caution still needs to be taken when we obtain different result using @xmath222 and @xmath221 .",
    "the source of gws , @xmath258 , in fourier space is a convolution , @xmath259 where @xmath260 .",
    "the discrete kronecker delta @xmath261 is @xmath70 when @xmath262 ( @xmath263 ) and zero otherwise .",
    "we see that while the discrete @xmath137 is mapped to @xmath264 , the mode - mode coupling is described by @xmath217 in the @xmath265 function .",
    "the danger of interpreting @xmath216 as the physical wave vector is that the mode - mode coupling may be inaccurately described .",
    "an ultimate solution to avoid the ambiguity in the tt projector might be to evolve everything in fourier space without involving a discrete @xmath137 approximation .",
    "the difficulty , however , is that calculating @xmath266 in fourier space generally involves convolutions , which is expensive for large @xmath89 .",
    "an attempt in this direction is the pspectre code by easther et al .",
    "@xcite .    during preheating ,",
    "the source terms @xmath258 are comparable to the background energy density . in hlattice the higher - order gravity self - interaction terms",
    "@xmath267 in the lagrangian are ignored .",
    "this is valid at least on large scales where the average @xmath82 is much smaller than the background energy density . on smaller scales",
    "this might not be a good approximation . in ref .",
    "@xcite the authors integrate discretized einstein equations , and find gw enhanced by an order of magnitude when gravity self - interactions are included . however , the nonlinear enhancement that they find is on large scales ( see figs .  2 and 3 in @xcite ) .",
    "this is a puzzling result .",
    "note that @xcite suffers from the same scalar - tensor mixing problem .",
    "also , as discussed in , the discretization of gravity is not a trivial problem .",
    "the authors of @xcite find that their result is sensitive to the initial conditions of the metric .",
    "this is a hint that numerical tachyonic instabilities might exist in their discretization scheme for gravity , because physically a weak gravitational field should not have chaotic feature .",
    "moreover , numerical noises could arise if the integrator is not accurate enough .",
    "ideally their results can be checked by adding all the gravity self - interaction terms into hlattice . however , this will significantly complicate the code and make the simulations much more expensive .",
    "i leave this for future work .    in hlattice",
    "the scalar fields are all assumed to be canonical . an earlier version of hlattice , before metric perturbations were incorporated , can simulate noncanonical scalar fields as well .",
    "the noncanonical operators are similarly integrated using a runge - kutta subintegrator .",
    "i will merge the two versions together in the future versions of hlattice .",
    "the purpose is to accurately study gw produced in preheating with noncanonical scalar fields @xcite .    as a general lattice code with a superior accurate integrator",
    ", hlattice can be used in many other fields of cosmology .",
    "it can be used to study scalar metric perturbations , such as the comoving curvature perturbations studied in @xcite , or nonlinear problems for stochastic inflation models @xcite .",
    "if vector fields can be incorporated , it can also be used to study the electroweak phase transition . to make the code more productive",
    ", i release the source code to the community at http://www.cita.utoronto.ca/@xmath268zqhuang/hlat .",
    "s. weinberg , in _ gravitation and cosmology : principles and applications of the general theory of relativity , by steven weinberg , pp .",
    "isbn 0 - 471 - 92567 - 5 .",
    "wiley - vch , july 1972 .",
    "_ , edited by weinberg , s. ( john wiley & sons , inc . , 111 river street , hoboken , nj 07030 - 5774 , 1972 ) ."
  ],
  "abstract_text": [
    "<S> the nonlinear dynamics of preheating after early - universe inflation is often studied with lattice simulations . in this work </S>",
    "<S> i present a new lattice code hlattice . </S>",
    "<S> it differs from previous public available codes in the following three aspects : ( i ) a much higher accuracy is achieved with a modified sixth - order symplectic integrator ; ( ii ) scalar , vector , and tensor metric perturbations in synchronous gauge and their feedback to the dynamics of scalar fields are all included ; ( iii ) the code uses a projector that completely removes the scalar and vector components defined by the discrete spatial derivatives . </S>",
    "<S> such a generic code can have wide range of applications . </S>",
    "<S> as an example , gravity waves from preheating after inflation are calculated with a better accuracy . </S>"
  ]
}