{
  "article_text": [
    "a description of the ipta data challenge and the data sets can be found at _ http://www.ipta4gw.org/_. the first round consisted of three parts - datasets 1,2 , and 3 , each with one open data set for testing purposes and one closed data set as a blind challenge .",
    "the datasets were arranged in increasing order of difficulty , starting with evenly sampled data with bright gravitational wave signals and moving on to unevenly sampled data with weak gravitational wave signals .",
    "the ipta data challenges are similar to the mock lisa data challenges  @xcite , the main difference being that the people that put this challenge together have real detectors to work with as well .",
    "my approach to the analysis was to use bayesian inference and markov chain monte carlo sampling to produce posterior distributions for the gravitational wave amplitude and the pulsar timing noise .",
    "the bayesian approach requires a noise model - which fixes the form of the likelihood - a signal model , and priors on the model parameters . for stationary , gaussian noise",
    "the likelihood is given by @xmath3 where @xmath4 is the covariance matrix , which depends on the noise in the detectors ( in this case the individual earth - pulsars arms ) and the amplitude of the stochastic gravitation wave background , and @xmath5 denotes the residuals after a signal model @xmath6 has been subtracted from the data @xmath7 . here",
    "@xmath8 label which detector ( earth - pulsar arm ) , and latin indices @xmath9 label the data samples .",
    "this expression for the likelihood applies to any collection of gravitational wave detectors with stationary , gaussian noise , and is widely used in theoretical studies of ground - based and space - based gravitational wave detectors  @xcite .",
    "it applies to any data representation , including time domain , frequency domain and wavelet domain . for evenly sampled time domain data with colored noise",
    "it is best to transform to the frequency domain where @xmath10 , as this leads to substantial savings when computing the likelihood : @xmath11 versus @xmath12 floating point operations .    in the current",
    "setting we are looking for a stochastic gravitational wave signal , so we do nt have a deterministic signal model for the gw component of the data . instead , we are looking for correlations in the signals between earth - pulsar pairs @xmath13 , which depend on the angle @xmath14 between the line of sight to each pulsar and follow the hellings - downs  @xcite correlation curve @xmath15 , which has the form @xmath16 we do however have a deterministic timing model that accounts for effects such as the pulsar spin - down , sky location and proper motion , and a host of other effects , such as relativistic time delays due to the earth s motion about the sun .",
    "the leading terms in the timing model have the form @xmath17 the parameters @xmath18 are used to fit the pulsar spin - down , @xmath19 and @xmath20 account for the sky location and leading order time dilation effects , which introduce periodic variations with @xmath21 , @xmath22 and @xmath23 account for pulsar proper motion , while @xmath24 and @xmath25 account for second order time dilation effects and the eccentricity of the earth s orbit .",
    "the publicly available tempo2  @xcite software package fits a more involved timing model to each individual pulsar using a chi - squared goodness of fit .",
    "taking the tempo2 residuals and subtracting the raw data that was provided for the open data sets reveals a clear excess of power with a spectral slope of @xmath26 , in addition to a wide bump around @xmath27 from the @xmath19 and @xmath22 terms , along with a narrow spike at @xmath28 from the @xmath24 term",
    ".    a naive approach would be to take the tempo2 timing residuals and compare the the cross correlation between pulsar pairs to the hellings - downs correlation curve .",
    "the problem with this approach is that the tempo2 fitting procedure introduces spurious features in the residuals , potentially removing or at least masking any gravitational wave signal that might be present .",
    "a better approach is to combine the fitting of the timing model with the cross - correlation analysis .",
    "i tried this approach , but the results were not entirely satisfactory .",
    "for some reason the recovered gw amplitude always tended to get biased high .",
    "i suspect that i might be missing some important contributions to the timing model .",
    "i plan to re - visit this approach in an effort to understand why it did nt work as expected .    simply ignoring the features introduced by tempo2 and using a model that only accounts for the gw signal and white noise in datasets 1 and 2 , or the red and white noise of dataset 3 , leads to gw amplitudes that appear to be biased high ( based on analysis of the open data sets ) .",
    "the one caveat here is that i am not 100% sure about wether the quoted amplitudes for the gw signal refer to the astrophysical signal or the effective level registered in the detector .",
    "the astrophysical level @xmath29 is related to the observed level in an earth - pulsar link @xmath30 by @xmath31 ( the two - thirds factor comes from sky and polarization averaging ) .",
    "this corresponds to an amplitude ratio bias of @xmath32 .",
    "if the factor of two - thirds was not included , then my results for the gw amplitude need to be multiplied by a factor of 1.225 . in any case , this factor is not large enough to account for the bias that i saw with the naive analysis , which showed a @xmath33 amplitude bias . to check my analysis codes in a more controlled fashion",
    ", i wrote my own simulation software , using the same approach for generating stochastic backgrounds that we used in the mock lisa data challenges  @xcite ( based on a adding together the response to independent stochastic signals from different patches of the sky using a fine healpix sky grid ) .",
    "this simulation confirmed that the two - thirds factor should be included , and using my own simulated data , with no tempo2 processing , i was able to perfectly recover the injected gw amplitude and spectral slope , and the pulsar noise levels .",
    "since the tempo2 fitting is done on a per - pulsars basis , the errors in the timing models should be uncorrelated between pulsars .",
    "i therefore decided to model the timing model errors as an additional , uncorrelated red noise contribution to each pulsar , described by a spectral amplitude @xmath34 and slope @xmath35 .",
    "for dataset 1 we were told that all the pulsars shared the same white noise level , so for that analysis the model i used had @xmath36 parameters ( since there are @xmath37 pulsars in the simulated array ) . for dataset 2",
    "the white noise level in each pulsar was different , so the model had @xmath38 parameters .",
    "for dataset 3 there is an additional red noise component , but i assumed that this was already taken care of by the red noise model that i introduced to account for the tempo2 fitting noise , so again the model had 110 parameters . moreover , if i understood the statement about the red noise level that was injected , it is essentially irrelevant to the analysis , as it lies below the fiducial 100 ns white timing noise for frequencies above 10 nhz ( here i am using the fact that 100 ns white timing noise corresponds to a spectral density of @xmath39 , and the red noise was quoted at @xmath40 , which cross at @xmath41 , which is at the very edge of the frequency band for a 5 year data set , and in a region where the fit to the pulsar spin - down removes any meaningful signal ) . in most runs i fixed the gravitational wave spectral slope at the expected value of @xmath42 to improve the amplitude recovery .    with the model established , the next step is to decide on how to compute the likelihood .",
    "the simplest and most robust approach is to implement ( [ like ] ) in the time domain , following the approach of van haarsteren _",
    "et al . _",
    "the downside of this approach is that the matrix inversion is very computationally expensive for an @xmath43 by @xmath43 matrix with @xmath44 rows and columns .",
    "since the correlation matrices are positive definite , they can be inverted by way of cholesky factorization .",
    "the matrix determinant is given by product of the squares of the diagonal elements of the cholesky decomposition .",
    "i used the _ lapack _ routines dpotrf and dpotri to perform the factorization and inversion .",
    "the codes were run on multi - core mac pro workstations , where an interesting side - effect of having the _ lapack _ routines as built in functions is that the matrix inversion is automatically parallelized , taking up an average of 4 cores . even with the parallel processing , each likelihood evaluation took @xmath45 seconds , making it difficult to produce long markov chains .",
    "to adequately explore the posterior distribution we need many samples in the chains , with the required number of samples scaling roughly linearly with the model dimension .",
    "the combination of the large model dimension and the high cost of generating the chains leads to long runs times ( or the need to secure larger computing resources ! ) . to shorten the `` burn - in '' phase of the analysis ( where the chains locate the region of high posterior mass ) ,",
    "i first ran on each pulsar individually using a three parameter model consisting of the white noise level , the gravitational wave amplitude ( the slope was fixed at @xmath46 ) , and the low frequency cut - off in the spectrum .",
    "the spectral estimates from the individual pulsar runs were used as a starting point for the full run on the pulsar network .",
    "the low frequency cut - off parameter requires some explanation .",
    "the time domain auto - correlation function for time lags @xmath47 , @xmath48 , forms a fourier pair with the frequency domain spectrum @xmath49 : @xmath50 setting @xmath51 for power - law power spectra leads to improper correlation functions . as van haarsteren _",
    "et al . _",
    "@xcite point out , the correlation function should not depend very strongly on @xmath52 so long as @xmath53 , as the fitting of the pulsar spin - down model removes the part of the spectrum that causes the divergence in the limit @xmath54 .",
    "however , i found that the value of @xmath52 did affect the analysis quite significantly , so i made it a parameter to be determined from the data .",
    "the chains generally favored values around @xmath55 .",
    "the correlation functions used in the full analysis have the form @xmath56 for white noise with amplitude @xmath57 , and @xmath58 for a gw signal with amplitude @xmath59 at @xmath27 and spectral slope @xmath60 . here",
    "@xmath61 , and the sum over @xmath62 needs to extend to @xmath63 if @xmath52 is allowed to go as high as @xmath64 .",
    "the injected gw signals have spectral slope @xmath46 .",
    "an expression similar to ( [ gw ] ) applies to the un - correlated red noise , but with @xmath15 replaced by @xmath65 .    in the runs where i included a timing model of the form ( [ time ] ) for each pulsar , the mcmc alternated between updating the parameters in the correlation matrix ( which costs of order @xmath12 floating point operations ) , and updating the parameters in the timing model ( which costs of order @xmath66 floating point operations ) . because the timing model updates are so much cheaper , it made sense to do many timing updates for each correlation matrix update .",
    "so while the timing model involves many more parameters than the spectral model , we are able to spend many more iterations exploring the much larger timing model parameter space for little additional computational cost .",
    "however , as i remarked earlier , the runs that used the timing model did not do as good a job of recovering the amplitude of the gw signal as did the runs with an uncorrelated red noise model .    in an attempt to speed up the calculation of the likelihood ,",
    "i also considered frequency domain implementations of the likelihood calculation ( [ like ] ) . transforming the data to",
    "the frequency domain turned out to be a highly non - trivial exercise due to the very red spectra and the uneven data sampling .",
    "either one of these issues is easy to overcome on its own , but in tandem they are a bitch .",
    "the approach i settled on combined several techniques that have been used previously in pulsar timing data analysis . to handle the unevenly sampled data i used an tempered mcmc algorithm to fit the timing residuals to a sum of sines and cosines using the log likelihood @xmath67\\right)^2/\\delta t^2 \\ , , \\ ] ] with @xmath68 ns ( the choice of @xmath69 is largely irrelevant since i used a tempered mcmc ) . to avoid the gibbs phenomenon from the finite - time window function and the very red spectra",
    ", i set @xmath70 with @xmath71 .",
    "i found that @xmath72 worked well , and that somewhat larger and smaller values also worked .",
    "the sum over frequencies has to be extended beyond the usual nyquist frequency because of the un - even time - sampling . using the fourier coefficients @xmath73 and @xmath74 directly gave reasonable results , but i found that it was better to re - map the data onto the true time interval with uniform time sampling , then transform the data with a standard fft . to avoid the gibbs phenomena i applied a zero phase shift double difference filter in the time domain : @xmath75 = d[i-1]+d[i+1]-d[i]$ ] , and compenstated by dividing the fourier amplitudes derived from the @xmath76 sequence by the transfer function @xmath77 . applying this filtering procedure to the full data set leads to aliasing of high frequency power to low frequencies , so i used the fit derived from ( [ c2 ] ) to first split the data into high - passed and low - passed components .",
    "the low frequency part was transformed with the filter , while the high frequency part was transformed without the filter .",
    "the results were then added together to give the complete fourier transform .",
    "the sum over frequencies in ( [ like ] ) was restricted to the range @xmath78 $ ] .",
    "the lowest frequency bin was dropped as the fitting of the pulsar spin - down model takes out most of the very low frequency power , and including the @xmath64 frequency bin was found to bias the gw amplitude low .",
    "i dropped the highest frequencies in part because they contain no information about the gw amplitude , and also because the interpolation of the data becomes less trustworthy one short time scales .",
    "for unevenly sampled data , the fourier components are not strictly orthogonal , and @xmath79 . to keep the analysis simple i ignored this complication and assumed orthogonality .    for the priors i used uniform distributions in the log of the spectral amplitudes , and uniform distributions in the spectral slope parameters .",
    "i used a very wide prior range , and found that the distributions stayed well within these ranges , with the exception of the time domain analysis of the closed dataset3 data , where the low end of the gw prior was seen to cut - off the distribution , which suggests that the gw level was not confidently detected in that analysis .",
    "i found that in most of the challenge data sets the gw amplitude was sufficiently high that there was no question about wether a detection had been made .",
    "the one exception was the closed data from dataset3 . the gw amplitude flirted with zero during the time and frequency domain runs , indicating that a pure noise model may have greater bayesian evidence . to test this",
    "i ran a trans - dimensional reversible jump markov chain monte carlo ( rjmcmc ) algorithm on the frequency domain data that allowed for transitions between a gw + noise model and a pure noise model .",
    "the ratio of the time that the chains spent in each model provides the bayes factor , or evidence ratio for the two models .",
    "if our prior belief is that the two models are equally likely , then this ratio is the betting odds for one model versus the other .",
    "as we shall see , the odds turned out to favor the gw model by a fairly comfortable margin ( but perhaps by not enough to send a paper to nature if this was real data ) .",
    "i begin by showing results from the frequency domain analysis .",
    "the gw spectral slope was held fixed at @xmath80 for the analyses shown in figures 1 - 7 .",
    "figure 1 shows the posterior distributions for the level of the white timing noise ( in seconds ) and the dimensionless gravitational wave amplitude @xmath59 using the open data from dataset 1 .",
    "the white noise level came out a little above the injected value of @xmath81 s , while the gravitational wave amplitude peaked very close to the injected value of @xmath82 .",
    "figure 2 shows the same quantities , but now for the closed dataset 1 data .",
    "this time the white noise level was a fraction below 100 ns .",
    "the gw amplitude distribution peaked at @xmath83 , which is significantly lower than the level seen in the open data set .",
    "figure 3 shows the posterior distributions for the dimensionless gravitational wave amplitude for dataset2 for both the open and closed data .",
    "the posterior distribution peaks very near the injected value of @xmath82 for the open data set , and the distribution for the closed data set peaks a little higher at @xmath84 .    [ cols=\"^,^ \" , ]     returning to the frequency domain analysis , and now letting the spectral slope of the gw spectrum vary , i found the posterior distributions for the spectral slope @xmath60 and the gw amplitude @xmath59 shown in figure 8 . as expected , the spread in the amplitude distribution is wider than when @xmath60 was held fixed .",
    "the distribution for @xmath60 is biased a little high relative to the injected value of @xmath46 , which may be due to the procedure used to perform the fourier transform , or more likely , to interplay with the red noise model used to account for the timing model errors .",
    "i was able to get reasonable results from the time domain and frequency domain analyses .",
    "there does appear to be a bias in the time domain estimates for the gravitational wave amplitude , which i attribute to a mis - match between the spectral model ( a simple power law ) and what is likely present in the data ( a power law that flatens out at low frequencies ) .",
    "this should be easy to fix with a suitable change to the spectral model .",
    "i remain puzzled as to why a simultaneous fit to the timing model and the gravitational wave correlation function did not produce better results",
    ". this could be due to an implementation error , or it may be that the this approach is flawed in some more serious way .",
    "the frequency domain analysis suggests that modeling the errors in the timing model as red `` modeling '' noise is quite effective .",
    "i am still a little uneasy about the frequency domain analysis as the procedure i used to transform the data was fairly byzantine .    as a general rule",
    "i do nt like to specify the model used in the analysis in too rigid a fashion .",
    "i prefer to let the data select the best model . in future",
    "i would like to use a full rjmcmc analysis that is able to transition between models .",
    "for example , when i look at the distributions for some of the red noise parameters it is clear that they are poorly constrained by the data .",
    "a rjmcmc analysis would automatically discard these parameters from the model .",
    "this approach may also cure some of the ills of the timing model analysis , where again it was clear that many of the timing model parameters were poorly constrained .",
    "i have some ideas about how to speed up the interminably slow time domain analysis .",
    "there the bottle neck comes from having to invert a large non - sparse matrix .",
    "suppose however that we have found an approximate form for the matrix .",
    "we can then use the cholesky factors to transform to a data representation where the a samples are approximately uncorrelated in time and space ( _ i.e. _ in both @xmath13 and @xmath85 ) . in this transformed representation `` nearby '' correlation matrices will be almost diagonal , and fast perturbative methods can be used to compute their inverse .",
    "this work was supported by nasa grant nnx07aj61 g .",
    "g.  hobbs , f.  jenet , k.  j.  lee , j.  p.  w.  verbiest , d.  yardley , r.  manchester , a.  lommen and w.  coles _ et al .",
    "_ , s.  babak , j.  g.  baker , m.  j.  benacquista , n.  j.  cornish , j.  crowder , s.  l.  larson , e.  plagnol and e.  k.  porter _",
    "et al . _ , class .",
    "grav .   * 25 * , 184026 ( 2008 )"
  ],
  "abstract_text": [
    "<S> this is a very brief summary of the techniques i used to analyze the ipta challenge 1 data sets . </S>",
    "<S> i tried many things , and more failed than succeeded , but in the end i found two approaches that appear to work based on tests done using the open data sets . </S>",
    "<S> one approach works directly with the time domain data , and the other works with a specially constructed fourier transform of the data . </S>",
    "<S> the raw data was run through tempo2 to produce reduced timing residuals for the analysis . </S>",
    "<S> standard markov chain monte carlo techniques were used to produce samples from the posterior distribution function for the model parameters . </S>",
    "<S> the model parameters include the gravitational wave amplitude and spectral slope , and the white noise amplitude for each pulsar in the array . </S>",
    "<S> while red timing noise was only included in dataset 3 , i found that it was necessary to include effective red noise in all the analyses to account for some of the spurious effects introduced by the tempo2 timing fit . </S>",
    "<S> this added an additional amplitude and slope parameter for each pulsar , so my overall model for the 36 pulsars residuals has 110 parameters . as an alternative to using an effective red noise model , i also tried to simultaneously re - fit the timing model model while looking for the gravitational wave signal , but for reasons that are not yet clear , this approach was not very successful . </S>",
    "<S> i comment briefly on ways in which the algorithms could be improved . </S>",
    "<S> my best estimates for the gravitational wave amplitudes in the three closed ( blind ) data sets are : ( 1 ) @xmath0 ; ( 2 ) @xmath1 ; and ( 3 ) @xmath2 . </S>"
  ]
}