{
  "article_text": [
    "ions and electrons trapped in the earth s magnetic field may affect our technology and our daily lives in significant ways .",
    "energetic plasma particles may penetrate satellites and disable them temporarily or permanently .",
    "they can also pose serious health hazards for astronauts in space .",
    "spectacles like the aurora are created by particles that enter the earth s atmosphere at polar regions ; on the other hand , aircraft personnel and frequent flyers may accumulate a significant dose of radiation due to the same particles.@xcite all of these effects are enhanced at periods of solar maximum , the next one being expected to happen between 2012 and 2014 .",
    "occasional extreme solar events may induce currents in the ionosphere , which in turn induce significant currents on power lines , causing power outages.@xcite such events can also disrupt communications , radio and gps .",
    "thus , understanding and predicting the processes in the earth s magnetosphere have practical importance .",
    "this paper aims to outline one of these processes , charged - particle motion and associated adiabatic invariants , for physics students and instructors who wish to use it in lectures .",
    "the emphasis is on numerical computation and visualization of trajectories . for a more comprehensive discussion",
    "advanced texts on plasma physics@xcite can be consulted .",
    "other authors have also suggested using topics from plasma research to enhance undergraduate curriculum .",
    "lopez@xcite provides examples of how space physics can be incorporated in undergraduate electromagnetism courses , and mcguire@xcite shows how computer algebra systems can be used to follow particle trajectories in electric dipole and ( separately ) in magnetic dipole fields .",
    "photographs of plasma experiments , such as those provided by huggins and lelek@xcite and by the ucla plasma lab web site@xcite are also helpful for understanding space plasma behavior .    a schematic view of the earth s magnetosphere .",
    "the solar wind comes from the left .",
    "( courtesy of kenneth r. lang,@xcite reproduced with permission . ) ]    figure  [ fig : magnetosphere ] shows a schematic description of the earth s magnetosphere , which is the region in space where the magnetic field of the earth is dominant .",
    "charged particles trapped in the magnetosphere form the radiation belts , the plasmasphere , and current systems such as the ring current , tail current , and field - aligned currents .",
    "the earth radius  @xmath0 ( 6378.137 km ) is a natural length scale for the magnetosphere . near the earth ,",
    "up to 3 - 4@xmath0 , the field can be very well approximated with the field of a dipole .",
    "however , at larger distances , the effects of the solar wind cause significant deviations from the dipole .",
    "the solar wind is a stream of plasma carrying magnetic field from the sun .",
    "when the solar wind encounters the earth s magnetosphere , the two systems do not mix .",
    "this is because of the `` frozen - in flux '' condition@xcite which dictates that plasma particles stay attached to magnetic field lines , except at special locations such as polar cusps .",
    "the solar wind influences the magnetosphere by applying mechanical and magnetic pressure on it , compressing it earthward on the side facing the sun ( the `` dayside '' ) .",
    "this compression is stronger when the sun is more active . on the opposite side ( the `` nightside '' ) , the field",
    "is extended over a very large distance , forming the magnetotail .",
    "wolf@xcite provides a review of the complex and time - dependent interactions between magnetic fields , induced electric fields and plasma populations .",
    "the van allen radiation belts form a particularly significant plasma population due to their high energy and their proximity to earth .",
    "they can be found from 1000 km above the ground up to a distance of 6@xmath0 .",
    "these belts are composed of electrons with energies up to several mevs and of protons with energies up to several hundred mevs .",
    "the dynamics of these particles is the main focus of this paper .",
    "this paper is organized as follows : section  [ sec : nleqs ] introduces the relativistic equation of motion for a particle in an electric and magnetic field and describes the cyclotron , bounce and drift motions .",
    "it also shows some typical particle trajectories under the dipolar magnetic field , approximating the earth s field .",
    "section  [ sec : firstinv ] introduces the concept of adiabatic invariants and derives the first adiabatic invariant associated with the particle motion .",
    "section  [ sec : gceqs ] gives the approximate equations of motion for the guiding center of a particle , obtained by averaging out the cyclotron motion .",
    "section  [ sec : secondthirdinv ] presents and derives the second and third invariants associated with the bounce and drift motions , respectively . section  [ sec : exercises ] lists some exercises building on the concepts described in the paper .",
    "two of these exercises describe non - dipole fields that are used for modeling different regions of the magnetosphere .",
    "the motion of a particle with charge @xmath1 and mass @xmath2 in an electric field @xmath3 and magnetic field @xmath4 is described by the newton - lorentz equation : @xmath5 here @xmath6 is the relativistic factor and @xmath7 is the particle speed .",
    "suppose that @xmath8 .",
    "then , because of the cross product , the acceleration of the particle is perpendicular to the velocity at all times , so the speed of the particle ( and the factor @xmath9 ) remains constant .",
    "further suppose that the magnetic field is uniform .",
    "then , particles move on helices parallel to the field vector .",
    "the circular part of this motion is called the `` cyclotron motion '' or the `` gyromotion '' .",
    "the `` cyclotron frequency '' @xmath10 and the `` cyclotron radius '' @xmath11 are respectively given by @xmath12 where @xmath13 is the uniform field strength and @xmath14 is the component of the velocity perpendicular to the field vector .",
    "if there are not any other forces , the parallel component of the velocity remains constant .",
    "the combined motion traces a helix.@xcite    if the electric field is not zero , we can write it as @xmath15 , where @xmath16 is parallel to @xmath4 , and @xmath17 is perpendicular to it . if @xmath18 , particles accelerate with @xmath19 along the field line and they are rapidly removed from the region . therefore , the existence of a trapped plasma population implies that the parallel electric field must be negligible .",
    "the perpendicular component of the electric field will move particles with an overall drift velocity , known as the e - cross - b - drift , which is perpendicular to both field vectors : @xmath20 the particle will move with with the velocity @xmath21 , plus the cyclotron motion described above .",
    "the drift velocity @xmath21 is independent of particle mass and charge .",
    "therefore , in an inertial frame moving with @xmath21 , the e - cross - b - drift will vanish for all types of particles .    for the remainder of this paper we take @xmath22 ,",
    "that is , the acceleration due to the electric field is not taken into consideration .",
    "this is not because electric fields are unimportant ; on the contrary , they play an important role in the complex dynamics of plasmas . the first reason for leaving out electric field effects is described above : if the field is uniform and constant , we can transform to another frame that cancels it .",
    "even if the field is nonuniform and time - dependent , electric drifts can be vectorially added to magnetic drifts in order to obtain the overall drift .",
    "drift velocities due to different fields are independent .",
    "the second reason is the need for simplicity ; a static magnetic field provides sufficient real - life context for the discussion of guiding - center and adiabatic invariant concepts in general - purpose lectures .",
    "the final reason is that this paper focuses on the region occupied by radiation belts , and in this region the magnetic term of  ( [ eq : nleqs ] ) is the dominant force.@xcite    now we consider motion under the influence of a magnetic dipole .",
    "the field @xmath23 of a magnetic dipole with moment vector @xmath24 at location @xmath25 is given by:@xcite @xmath26,\\ ] ] where @xmath27 , @xmath28 and @xmath29 .",
    "for earth , we take @xmath30 , antiparallel to the @xmath31-axis , because the magnetic north pole is near the geographic south pole.@xcite    at the magnetic equator ( @xmath32 , @xmath33 ) the field strength is measured to be @xmath34 .",
    "substitution shows that @xmath35 .",
    "then in cartesian coordinates , the field is given by : @xmath36.\\ ] ]    ( color online ) trajectories of two 10mev protons in the earth s dipole field .",
    "the dipole moment is in the @xmath37 direction .",
    "both panels show the same trajectories from different viewing angles.,title=\"fig : \" ] ( color online ) trajectories of two 10mev protons in the earth s dipole field .",
    "the dipole moment is in the @xmath37 direction .",
    "both panels show the same trajectories from different viewing angles.,title=\"fig : \" ]    figure  [ fig : proton_full ] shows trajectories of two protons with 10mev kinetic energy , a typical energy for radiation belts.@xcite the trajectories are calculated with the scipy module using the python language.@xcite one proton is started at @xmath38 and the other at @xmath39 .",
    "both start with an equatorial pitch angle ( angle between the velocity and field vectors ) @xmath40 so that @xmath41 , @xmath42 and @xmath43 .",
    "both are followed for 120 seconds .",
    "the motion is again basically helical , but the nonuniformity of the field introduces two additional modes of motion on large spatial and temporal scales .",
    "these are called `` the bounce motion '' and `` the drift motion '' .",
    "the bounce motion proceeds along the field line that goes through the helix ( the `` guiding line '' ) .",
    "the motion slows down as it moves toward locations with a stronger magnetic field , reflecting back at `` mirror points '' .",
    "the bounce motion is much slower than the cyclotron motion .",
    "the drift motion takes the particle across field lines ( perpendicular to the bounce motion ) . in general ,",
    "drift motion is faster at larger distances , as observed in figure  [ fig : proton_full ] .",
    "particles in dipole - like fields are trapped on closed `` drift shells '' as long as they are not disturbed by collisions or interactions with em waves .",
    "the drift motion is much slower than the bounce motion .    under a dipolar field ,",
    "the bounce motion period @xmath44 and the drift motion period @xmath45 are approximately given as:@xcite @xmath46 \\\\",
    "\\label{eq : driftperiod}\\tau_{\\rm d } & \\approx & \\frac{2\\pi qb_0r_{\\rm e}^3}{mv^2}\\frac{1}{r_0}\\left[1-\\frac{1}{3}(\\sin \\alpha_{\\rm eq})^{0.62}\\right],\\end{aligned}\\ ] ] where @xmath47 is the equatorial distance to the guiding line and @xmath48 is the equatorial pitch angle .",
    "both approximations have an error of about 0.5% .",
    "if the parameters of an oscillating system are varied very slowly compared to the frequency of oscillations , the system possesses an `` adiabatic invariant '' , a quantity that remains approximately constant . in the hamiltonian formalism",
    ", the adiabatic invariant is the same as the action variable:@xcite @xmath49 where @xmath1 , @xmath50 are canonical variables and the integral is evaluated over one cycle of motion satisfying @xmath51 .",
    "the integral should be evaluated at `` frozen time '' , that is , the slowly varying parameter is considered constant during the integration cycle .",
    "there are three separate periodic motions of a charged particle in a dipole - like magnetic field .",
    "this means there are three adiabatic invariants for the particle s motion .",
    "the canonical momentum for a charged particle in a magnetic field with vector potential @xmath52 is @xmath53 . to obtain the first adiabatic invariant @xmath54",
    ", we integrate the canonical momentum over one cycle of the cyclotron orbit : @xmath55 here @xmath56 is the line element of the particle trajectory . even though the path does not exactly close , we evaluate the integral as if it does .",
    "stokes theorem states that : @xmath57 where the right - hand side integral is taken over the surface bounded by the closed path of the left - hand side integral .",
    "using stokes theorem with @xmath58 , the integral @xmath54 takes the form : @xmath59 the second equation follows from substituting @xmath11 from  ( [ eq : cycrad ] ) .",
    "it is assumed that the cycle is sufficiently small so that @xmath4 is considered uniform over the area bounded by the gyromotion .",
    "this assumption is essential for the existence of adiabatic invariants .",
    "the area element @xmath60 is antiparallel to @xmath4 because of the sense of gyration of the particles ; hence the negative sign of the second term .",
    "customarily , one takes @xmath61 as the first invariant , which differs from @xmath54 only in some constant factors .",
    "the parameter @xmath62 is called the `` magnetic moment '' because it is equal to the magnetic moment of the current generated by the particle moving on this circular path .",
    "the adiabatic invariance of @xmath62 explains the existence of mirror points .",
    "as the particle moves along the field line toward points with larger @xmath63 , the perpendicular speed @xmath14 must increase in order to keep @xmath62 constant .",
    "however , @xmath14 can be at most @xmath7 , the constant total speed",
    ". the particle stops at the point where @xmath64 and falls back ( see section  [ sec : gceqs ] ) .",
    "the left panel of figure  [ fig : firstinv ] shows the magnetic moment @xmath62 for the two protons shown in figure  [ fig : proton_full ] .",
    "the values are oscillating with the local cyclotron frequency because instantaneous values of @xmath14 and @xmath63 are used .",
    "the actual adiabatic invariant is the average of these oscillations and it is constant in time .",
    "the top right panel shows the oscillations of @xmath62 vs. time for a shorter interval .",
    "comparison with the @xmath31 vs. time plot below , it can be seen that these oscillations are correlated with the bounce motion .",
    "oscillations of @xmath62 have a small amplitude near the mirror point because there the parallel motion slows down and the overall motion becomes more adiabatic . near",
    "the equatorial plane ( @xmath65 ) parallel motion is fastest , the motion is less adiabatic , and @xmath62 oscillates with a larger amplitude .",
    "the proper way of calculating the first invariant would remove all oscillations : after following the full trajectory , find the times @xmath66 where @xmath67 ( or @xmath68 ) by searching along discrete path points and by interpolating .",
    "the difference between any successive time points is half a gyroperiod .",
    "then take the average of @xmath62 over that time interval using the path points . repeating this procedure for all time intervals",
    ", we get a constant set of @xmath62 values ( apart from numerical errors ) .",
    "the `` guiding center '' is the geometric center of the cyclotron motion .",
    "if the magnetic field is uniform the guiding center moves with constant velocity parallel to the field line . in nonuniform field geometries , there is a sideways drift in addition to the motion along the field lines , as seen in the dipole example in figure  [ fig : proton_full ] .",
    "calculation of the guiding center motion requires that the motion is helical in the smallest scale , and that the field does not change significantly within a cyclotron radius .",
    "this condition can be expressed as @xmath69 the magnetic moment is an adiabatic invariant under this condition .",
    "northrop@xcite and walt@xcite give detailed derivations of the equations of guiding - center motion .",
    "in order to derive the acceleration of the guiding center , the particle position @xmath25 is substituted with : @xmath70 where @xmath71 is the position of the guiding center .",
    "the vector @xmath72 lies on the plane perpendicular to the field , oscillates with the cyclotron frequency , and its length is equal to the cyclotron radius .    assuming that the cyclotron radius is much smaller than the length scale of the field",
    ", we can expand @xmath73 around @xmath71 to first order in a taylor series : @xmath74    this expansion is substituted into the newton - lorenz equation  ( [ eq : nleqs ] ) and the equation is averaged over a cycle , eliminating rapidly oscillating terms containing @xmath72 and its derivatives .",
    "the resulting acceleration of the guiding center is given by : @xmath75    taking the dot product of both sides of the equation with @xmath76 , the local magnetic field direction , will yield the equation of motion along the field line .",
    "the first term becomes identically zero because it is perpendicular to the field vector .",
    "then : @xmath77 where @xmath78 is the speed along the field line . replacing @xmath79 and defining @xmath80 as the distance along the field line",
    ", this equation can be written as : @xmath81 here @xmath82 is the field strength along the field line .",
    "the factors @xmath62 and @xmath9 can be taken inside the derivative because they are constants .",
    "this expression shows that the quantity @xmath83 acts like a potential energy in the parallel direction .",
    "the negative sign indicates that the parallel motion is accelerated toward regions with smaller field strength .",
    "the motion of the guiding center perpendicular to field lines can be determined by taking the cross product of eq .",
    "( [ eq : gcaccel ] ) with the field direction vector .",
    "the resulting equation is then iterated to obtain an approximate solution for the drift velocity across field lines .",
    "@xmath84 this drift velocity is actually the sum of two separate drift velocities : the gradient drift that arises from the nonuniformity of the magnetic field , and the curvature drift that occurs because the field lines are curved . for an example of pure gradient drift motion ,",
    "see exercise  [ ex : graddrift ] in section  [ sec : exercises ] .",
    "equation  ( [ eq : driftvelocity ] ) shows that electrons and ions drift in opposite directions .",
    "this creates a net current around the earth , called `` the ring current '' .",
    "gradient and curvature drifts are the only drifts seen in static magnetic fields .",
    "external electric fields , external forces such as gravity , and time dependent fields create additional drift velocities.@xcite    combining these , we obtain the following equations of motion for the guiding center : @xmath85    these equations are more complicated than the simple newton - lorentz equation , and they require computing @xmath86 and @xmath87 at each integration step .",
    "still , they have the advantage that we can follow the overall motion with relatively large time steps because we do not need to resolve the cyclotron motion .",
    "this reduces the cumulative error , as well as the total computation time .",
    "( color online ) guiding - center trajectories for the particles shown in figure  [ fig : proton_full ] . the cyclotron motion is averaged out.,title=\"fig : \" ] ( color online ) guiding - center trajectories for the particles shown in figure  [ fig : proton_full ] .",
    "the cyclotron motion is averaged out.,title=\"fig : \" ]    figure  [ fig : proton_gc ] shows the solution of the guiding - center equations for the same protons shown in figure  [ fig : proton_full ] under a dipolar magnetic field ( python source code provided in supplement).@xcite    it should be noted that the guiding - center equations are approximate because only terms first order in cyclotron radius are used in their derivation . for particles with larger cyclotron radii ( higher kinetic energies ) , there may be a noticeable difference between guiding - center and full - particle trajectories ( see exercise  [ ex : gcandfull ] in section  [ sec : exercises ] ) .",
    "the second adiabatic invariant is associated with the bounce motion , and it is calculated by integrating the canonical momentum over a path along the guiding field line : @xmath88 where @xmath89 is the line element along the field line .",
    "the adiabatic integrals are evaluated in a `` frozen '' system : it is assumed that the drift is stopped , so the motion moves back and forth along a single guiding field line .",
    "using stokes theorem , the second term can be converted to an integral over a surface bounded by the bounce path @xmath90 which is zero because the bounce motion goes along the same path in both parts of the cycle so that the enclosed area vanishes .",
    "then , the second adiabatic invariant can be written as @xmath91 where @xmath80 is the path length along the field line , and @xmath92 , @xmath93 are locations of the mirror points where the particle comes back .    at the mirror point",
    "the parallel speed @xmath78 vanishes so that @xmath94 . from the invariance of the magnetic moment @xmath62 it follows that @xmath95 where @xmath96 is the field strength at the mirror point .",
    "substituting @xmath97 and solving for @xmath78 gives @xmath98 the integral @xmath99 is an adiabatic invariant in general ( even if there are electric fields or slow time - dependent fields ) .",
    "if the speed is constant , @xmath100 can be used as an adiabatic invariant .",
    "the integral @xmath100 depends only on the magnetic field , not on the particle velocity , so it can be used to compute the drift path using the field geometry only ( see exercises  [ ex : evaluatei]-[ex : driftpath ] in section  [ sec : exercises ] ) .",
    "the second invariant values in time , calculated using the guiding - center trajectories in fig .",
    "[ fig : proton_gc ] .",
    "lower curve is for the proton starting at 2 @xmath0 distance , upper curve for the proton starting at 4 @xmath0 . ]",
    "figure  [ fig : secinv ] shows that the value of the second invariant @xmath100 , evaluated using the guiding - center trajectories shown in figure  [ fig : proton_gc ] , stays constant in time .",
    "the integral is evaluated not using the definition of @xmath100 in eq .",
    "( [ eq : secinv ] ) , but using the dynamical form @xmath101 where the integral is evaluated over a half period .",
    "the limits of the integrals are determined by interpolation between two points where the parallel speed changes sign .",
    "the values do not oscillate because the adiabatic invariant is calculated as an average over a cycle .",
    "the drift path is found by averaging the bounce motion . in a dipolar field",
    "all drift paths are circular due to the symmetry of the field .",
    "the third invariant , associated with the drift motion , is defined as an integral along the drift path : @xmath102 where @xmath56 is a line element on the drift path .",
    "this can be written as @xmath103 in the first term @xmath104 , the drift speed , is the magnitude of the expression given in eq .",
    "( [ eq : driftvelocity ] ) .",
    "the second term is obtained by using stokes theorem as above .",
    "an order of - magnitude comparison shows that the first term of @xmath105 can be neglected because it is much smaller than the second term : from eq .",
    "( [ eq : driftvelocity ] ) the order of magnitude of the drift speed can be written as @xmath106 where @xmath63 is the typical field strength at the drift path and @xmath107 is the typical distance from the origin .",
    "similarly , from eq .",
    "( [ eq : cycrad ] ) , the cyclotron radius has the order of magnitude @xmath108 then , the order - of - magnitude ratio of the terms in eq .",
    "( [ eq : thirdinv2 ] ) is @xmath109 according to the adiabaticity condition eq .",
    "( [ eq : adbcondition ] ) , @xmath110 must be very small .",
    "therefore the first term of eq .",
    "( [ eq : thirdinv2 ] ) is ignored and we have @xmath111 where @xmath112 is the magnetic flux through the drift path .",
    "the third adiabatic invariant is useful as a conservation law when the magnetosphere changes slowly , i.e. , over longer time scales compared to the drift period .",
    "the use of three invariants gives more accurate results for the motion of particles over long periods .",
    "numerical solution of equations of motion are less accurate because of accumulated numerical errors .",
    "roederer@xcite discusses in detail how drift shells can be constructed geometrically using the invariants ( see exercise  [ ex : driftpath ] in sec .",
    "[ sec : exercises ] ) .",
    "furthermore , as three invariants uniquely specify a drift shell , the invariants themselves can be used as dynamical variables when investigating the diffusion of trapped particles.@xcite",
    "this section lists some further programming exercises with varying difficulty . the code given in the supplement@xcite",
    "can be modified to solve some of the exercises .    1",
    ".   * uniform magnetic field . * follow charged particles under a uniform magnetic field @xmath113 where @xmath114 .",
    "verify that the particles follow helices with cyclotron radius and frequency as given in eqs .",
    "( [ eq : cycfreq ] , [ eq : cycrad ] ) .",
    "experiment with particles with different mass and charge values .",
    "2 .   [ ex : graddrift ] * gradient drift . * consider a magnetic field given as @xmath115 .",
    "the field has a gradient in the @xmath116-direction , but no curvature .",
    "set @xmath117 and @xmath118 .",
    "follow the trajectory of a particle with mass @xmath119 and @xmath120 initialized with velocity @xmath121 at the origin .",
    "note that the sideways drift arises from the fact that the cyclotron radius is smaller at stronger fields .",
    "* equatorial particles . *",
    "consider a particle in a dipolar magnetic field , located at the equatorial plane ( @xmath65 ) with zero parallel speed . as the field strength is minimum at the equator with respect to the field line",
    ", there is no parallel acceleration and the particle stays on the equatorial plane at all times . using the dipole model , follow an equatorial particle and verify that the center of the motion stays on a contour of constant @xmath63 , as implied by the conservation of the first adiabatic invariant .",
    "4 .   * explore the drift motion .",
    "* run the programs in the supplement to trace protons and electrons using the dipole model .",
    "initialize particles with different energies , starting positions and pitch angles .",
    "verify that electrons and protons drift in opposite directions , and electrons have a much smaller cyclotron radius than protons with the same kinetic energy .",
    "estimate the periods of bounce and drift motions and compare them with eqs .",
    "( [ eq : bounceperiod ] , [ eq : driftperiod ] ) . 5 .",
    "[ ex : gcandfull ] * accuracy of the guiding - center approximation . * simulate the full particle and guiding center trajectories with the same initial conditions and plot them together .",
    "shift the initial position of the particle properly so that the guiding center runs through the middle of the helix .",
    "+ repeat with protons with 1kev , 10kev , 100kev and 1mev kinetic energies . at higher energies",
    ", the guiding - center trajectory lags behind the full particle because the omitted high - order terms become more significant as the cyclotron radius increases .",
    "* different numerical methods . *",
    "solve the full particle and guiding center equations using different numerical schemes,@xcite such as verlet , euler - cromer , runge - kutta and bulirsch - stoer .",
    "verify the accuracy of the solution by checking the conservation of kinetic energy and adiabatic invariants .",
    ".   * field line tracing . * plot the magnetic dipole field line starting at position @xmath122 . for any vector field @xmath123",
    ", a field line can be traced by solving the differential equation @xmath124 where @xmath80 is the arclength along the field line .",
    "[ ex : evaluatei ] * compute @xmath100 . *",
    "compute the second invariant @xmath100 ( eq .  [ eq : secinv ] ) under a dipolar field for a guiding center starting at position @xmath125 and an equatorial pitch angle @xmath48 .",
    "the integral should be taken along a field line , which can be traced as described above . from the first adiabatic invariant one finds @xmath126 and the limits of the integral",
    "are found by solving @xmath127 .",
    "[ ex : ialongdrift ] * second invariant along the drift path . *",
    "produce a guiding - center trajectory under the dipole field . by interpolation ,",
    "determine the points @xmath128 where the trajectory crosses the @xmath65 plane .",
    "compute the second invariant @xmath100 at these equatorial points and plot .",
    "verify that the values are constant as shown in fig .",
    "[ fig : secinv ] . 10 .",
    "[ ex : driftpath ] * drift path tracing using the second invariant . *",
    "pick a starting location @xmath129 and mirror field @xmath96 , and evaluate the second invariant @xmath130 as described above . compute the gradient @xmath131 numerically using central differences : @xmath132\\\\ \\partial_y i & \\approx & \\frac{1}{2\\delta}\\left[i(x_0,y_0+\\delta , b _ { \\rm m } ) - i(x_0,y_0-\\delta , b _ { \\rm m})\\right],\\end{aligned}\\ ] ] where @xmath133 is a small number ( e.g. 0.01@xmath0 ) .",
    "+ the second invariant is constant along the drift path , so for a finite step @xmath134 , it holds that @xmath135 .",
    "use this relation to trace successive steps along the drift shell .",
    "this method is more accurate than following a particle or a guiding center",
    "* * the double - dipole model.**@xcite the dipole ceases to be a good approximation for the magnetic field of the earth as we go farther in space .",
    "the double - dipole model , although unrealistic , introduces a day - night asymmetry that vaguely mimics the deformation of the magnetosphere by the solar wind .",
    "it can be used to capture some basic features of particle dynamics in the outer magnetosphere , if only qualitatively .",
    "+ the model has one dipole ( earth ) at the origin , pointing in the negative @xmath31-direction , and an image dipole at @xmath136 . if both dipoles are identical , the magnetic field is given by : @xmath137 where @xmath138 is given by eq .",
    "( [ eq : dipolefield ] ) .",
    "+ the domains of each dipole are separated by the plane @xmath139 .",
    "this plane simulates the magnetopause , the boundary between the magnetosphere and the solar wind . for slightly better realism",
    ", the image dipole can be multiplied by a factor larger than 1 so that the magnetopause becomes curved .",
    "also , the two dipoles can be tilted by equal and opposite angles with respect to the sun - earth line ( @xmath116-axis ) , to simulate the fact that the dipole moment of the earth is tilted .",
    "1 .   starting at various latitudes , plot the magnetic field lines of eq .",
    "( [ eq : ddfield ] ) on the @xmath140 plane .",
    "observe the compression of field lines on the dayside and extension on the nightside .",
    "note that no field line crosses the @xmath139 plane .",
    "multiply the image dipole term by 1.5 and repeat .",
    "2 .   follow several guiding - center trajectories starting position @xmath116 between @xmath141 and @xmath142 , @xmath33 , and pitch angles between @xmath143 and @xmath144 ( smaller pitch angle creates a longer bounce motion ) . with small pitch angles ,",
    "the particle should come closer to earth on the day side .",
    "repeat with a pitch angle of @xmath145 .",
    "now the particle goes away from the earth on the dayside .",
    "explain these observations using the conservation of first and second adiabatic invariants .",
    "3 .   the double - dipole field can break the second invariant for some trajectories .",
    "the reason of this breaking is that the field strength has a local maximum on the dayside around the equatorial plane .",
    "particles with sufficiently small mirror fields are diverted to one side of the equatorial plane because they can not overcome this field maximum , as seen in fig .",
    "[ fig : protondsb ] . + a proton with 200kev kinetic energy , initialized on the right edge at @xmath146 with @xmath144 pitch angle in a double - dipole field . ]",
    "+ start an electron guiding center at position @xmath147 , @xmath148 with kinetic energy @xmath149 with an equatorial pitch angle @xmath150 and follow its guiding center for 1000 seconds with time step 0.01 . on the dayside",
    "the trajectory will temporarily move above or below the equatorial plane . using the method used in fig .",
    "[ fig : secinv ] , plot the second invariant @xmath100 versus time . the second invariant will be constant between breaking points , but its value will differ from the initial value .",
    "the reason is that near the breaking points bounce motion slows down and the adiabaticity condition does not hold .",
    "however , the first invariant is not broken .",
    "+ this phenomenon , named drift - shell bifurcation,@xcite can be one of the causes of particle diffusion in the magnetosphere",
    ". * magnetotail current sheet . * on the tail region of the magnetosphere , magnetic field lines are heavily stretched , and a sheet of current is flowing through them.@xcite the field in the magnetotail can be represented by the simple form : @xmath151 in this problem we set @xmath152 , @xmath153 and @xmath154 .",
    "the field lines trace parabolas on the @xmath140 plane , which can be seen by integrating the equation @xmath155 .",
    "the parameter @xmath156 is the scale of the current sheet thickness .",
    "the truncation of the field at @xmath157 simulates the finite size of the tail region .",
    "+ the field vector points to opposite directions on both sides of the equatorial plane @xmath65 .",
    "when a charged particle is released from above , it moves toward the weaker region near @xmath158 where the adiabaticity condition does not hold .",
    "the helix becomes a `` serpentine orbit '' that moves in and out of the equatorial plane .",
    "the chaotic dynamics of these orbits is extensively studied.@xcite + ( color online ) types of orbits created by a particle with mass @xmath159 and charge @xmath160 near a current sheet .",
    "( a ) speiser orbits of transient particles , ( b ) cucumber orbits of quasitrapped particles and ( c ) ring orbits of trapped particles .",
    "note the different scales of axes.,title=\"fig : \" ] ( color online ) types of orbits created by a particle with mass @xmath159 and charge @xmath160 near a current sheet .",
    "( a ) speiser orbits of transient particles , ( b ) cucumber orbits of quasitrapped particles and ( c ) ring orbits of trapped particles .",
    "note the different scales of axes.,title=\"fig : \" ] + figure  [ fig : speiser ] shows the three types of orbits that can exist in such a model.@xcite `` speiser orbits '' approach the equatorial plane and later go beyond @xmath157 and leave the tail region .",
    "`` cucumber orbits '' alternate between helical and serpentine orbits . these do not form closed orbits because of the breaking of the first invariant at the equatorial plane .",
    "`` ring orbits '' alternate between oppositely - directed fields ; they do not have a helical section",
    "evaluate @xmath161 for @xmath162 and determine the direction of gradient - curvature drift .",
    "2 .   by trial and error , find initial conditions that create the types of orbits shown in fig .",
    "[ fig : speiser ] .",
    "space plasmas provide many case studies which , after proper simplification , can be used in the undergraduate physics curriculum .",
    "we have presented one such case , the basic theory of charged - particle motion under the dipole .",
    "this paper focuses on visualization and concrete computation , with the hope that students will modify or rewrite the code to run their own numerical experiments on particle motion in magnetic fields . in my opinion ,",
    "numerical simulations provide at least two important pedagogical benefits : first , even if the required analytical tools are beyond the students level , they can use simulations to obtain a qualitative understanding .",
    "second , the process of coding the simulation forces students to understand the problem at a basic and operational level .    the main body of this article or the exercises can be incorporated in lectures , or they can be given as advanced assignments to interested students .",
    "a natural place for this subject is a course on electromagnetism and/or plasma physics .",
    "when the basics are introduced , the instructor can discuss related subjects such as plasma confinement , radiation belts , or space weather .    in advanced mechanics courses , adiabatic invariants",
    "are usually presented with an abstract formalism .",
    "charged particle motion provides a natural and concrete case where adiabatic invariants are relevant and indispensable .",
    "the subject can also be incorporated in courses on computational physics .",
    "accuracy and stability of different numerical integration schemes may be presented using charged particle motion .",
    "the widely separated time scales of the motion would be a challenge for most of the schemes .",
    "electric potential differences across the magnetosphere are of the order of 100kv which , over a distance of about @xmath165 , yield an electric field strength of the order of @xmath166 .",
    "the magnetic field of the earth has strength @xmath167 on the magnetic equatorial plane , where @xmath168 is the distance measured in @xmath0 .",
    "a typical radiation - belt proton with 10mev energy has speed @xmath169 .",
    "then , in si units , @xmath170",
    ". therefore the electric drift can be neglected near the earth where @xmath171 .",
    "alternatively one can say that low - energy particles that could be affected by electric drifts have already drifted away , leaving behind the trapped high - energy particles .",
    "we are using the geocentric solar ecliptic ( gse ) coordinate system .",
    "the earth is at the origin , the @xmath116-axis points to the sun , the @xmath31-axis is set so that the dipole moment vector is on the @xmath172-plane , and the @xmath173-axis is perpendicular to both axes .",
    "see supplementary material at @xmath163https://sites.google.com / site / mkaanozturk / programs@xmath164 for the python source code that solves the newton - lorentz and the guiding - center equations and displays them .",
    "w. j. hughes , `` the magnetopause , magnetotail and magnetic reconnection '' in _ introduction to space physics _ , edited by margaret g. kivelson and cristopher t. russell ( cambridge university press , 1995 ) , pp .",
    "227 - 287 .",
    "jrg bchner , lev m. zelenyi , `` regular and chaotic charged particle motion in magnetotaillike field reversals 1 .",
    "basic theory of trapped motion '' , journal of geophysical research , * 94 * , a9 , 11821 - 11842 ( 1989 ) ."
  ],
  "abstract_text": [
    "<S> i outline the theory of relativistic charged - particle motion in the magnetosphere in a way suitable for undergraduate courses . </S>",
    "<S> i discuss particle and guiding center motion , derive the three adiabatic invariants associated with them , and present particle trajectories in a dipolar field . </S>",
    "<S> i provide twelve computational exercises that can be used as classroom assignments or for self - study . </S>",
    "<S> two of the exercises , drift - shell bifurcation and speiser orbits , are adapted from active magnetospheric research . </S>",
    "<S> the python code provided in the supplement can be used to replicate the trajectories and can be easily extended for different field geometries . </S>"
  ]
}