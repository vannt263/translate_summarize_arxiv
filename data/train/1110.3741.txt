{
  "article_text": [
    "anomaly detection is an important problem that has been studied in a variety of areas and used in diverse applications including intrusion detection , fraud detection , and image processing @xcite .",
    "many methods for anomaly detection have been developed using both parametric and non - parametric approaches .",
    "non - parametric approaches typically involve the calculation of dissimilarities between data samples . for complex high - dimensional data , multiple dissimilarity measures corresponding to different criteria",
    "may be required to detect certain types of anomalies .",
    "for example , consider the problem of detecting anomalous object trajectories in video sequences .",
    "multiple criteria , such as dissimilarity in object speeds or trajectory shapes , can be used to detect a greater range of anomalies than any single criterion . in order to perform anomaly detection using these multiple criteria",
    ", one could first combine the dissimilarities using a linear combination .",
    "however , in many applications , the importance of the criteria are not known in advance .",
    "it is difficult to determine how much weight to assign to each dissimilarity measure , so one may have to choose multiple weights using , for example , a grid search .",
    "furthermore , when the weights are changed , the anomaly detection algorithm needs to be re - executed using the new weights .    in this paper",
    "we propose a novel non - parametric _ multi - criteria _ anomaly detection approach using _ pareto depth analysis _ ( pda ) .",
    "pda uses the concept of pareto optimality to detect anomalies without having to choose weights for different criteria .",
    "pareto optimality is the typical method for defining optimality when there may be multiple conflicting criteria for comparing items .",
    "an item is said to be pareto - optimal if there does not exist another item that is better or equal in all of the criteria .",
    "an item that is pareto - optimal is optimal in the usual sense under some combination , not necessarily linear , of the criteria .",
    "hence , pda is able to detect anomalies under multiple combinations of the criteria without explicitly forming these combinations .",
    "the pda approach involves creating _ dyads _ corresponding to dissimilarities between pairs of data samples under all of the dissimilarity measures .",
    "sets of pareto - optimal dyads , called _ pareto fronts _ , are then computed .",
    "the first pareto front ( depth one ) is the set of non - dominated dyads .",
    "the second pareto front ( depth two ) is obtained by removing these non - dominated dyads , i.e.  peeling off the first front , and recomputing the first pareto front of those remaining .",
    "this process continues until no dyads remain . in this way , each dyad is assigned to a pareto front at some depth ( see figure [ bi_sample ] for illustration ) .",
    "nominal and anomalous samples are located near different pareto front depths ; thus computing the front depths of the dyads corresponding to a test sample can discriminate between nominal and anomalous samples .",
    "the proposed pda approach scales _ linearly _ in the number of criteria , which is a significant improvement compared to selecting multiple weights via a grid search , which scales exponentially in the number of criteria . under assumptions",
    "that the multi - criteria dyads can be modeled as a realizations from a smooth @xmath0-dimensional density we provide a mathematical analysis of the behavior of the first pareto front .",
    "this analysis shows in a precise sense that pda can outperform a test that uses a linear combination of the criteria .",
    "furthermore , this theoretical prediction is experimentally validated by comparing pda to several state - of - the - art anomaly detection algorithms in two experiments involving both synthetic and real data sets .",
    "the rest of this paper is organized as follows .",
    "we discuss related work in section [ related ] . in section [ prealg ]",
    "we provide an introduction to pareto fronts and present a theoretical analysis of the properties of the first pareto front .",
    "section [ detection ] relates pareto fronts to the multi - criteria anomaly detection problem , which leads to the pda anomaly detection algorithm .",
    "finally we present two experiments in section [ exp ] to evaluate the performance of pda .",
    "several machine learning methods utilizing pareto optimality have previously been proposed ; an overview can be found in @xcite .",
    "these methods typically formulate machine learning problems as multi - objective optimization problems where finding even the first pareto front is quite difficult .",
    "these methods differ from our use of pareto optimality because we consider _ multiple _ pareto fronts created from a finite set of items , so we do not need to employ sophisticated methods in order to find these fronts .",
    "@xcite introduced a method for gene ranking using pareto fronts that is related to our approach .",
    "the method ranks genes , in order of interest to a biologist , by creating pareto fronts of the data samples , i.e.  the genes . in this paper",
    ", we consider pareto fronts of _ dyads _ , which correspond to dissimilarities between _ pairs _ of data samples rather than the samples themselves , and use the distribution of dyads in pareto fronts to perform multi - criteria anomaly detection rather than ranking .",
    "another related area is multi - view learning @xcite , which involves learning from data represented by multiple sets of features , commonly referred to as `` views '' . in such case ,",
    "training in one view helps to improve learning in another view .",
    "the problem of view disagreement , where samples take different classes in different views , has recently been investigated @xcite .",
    "the views are similar to criteria in our problem setting . however , in our setting , different criteria may be orthogonal and could even give contradictory information ; hence there may be severe view disagreement .",
    "thus training in one view could actually worsen performance in another view , so the problem we consider differs from multi - view learning .",
    "a similar area is that of multiple kernel learning @xcite , which is typically applied to supervised learning problems , unlike the unsupervised anomaly detection setting we consider .    finally , many other anomaly detection methods have previously been proposed . @xcite and @xcite both provide extensive surveys of different anomaly detection methods and applications .",
    "nearest neighbor - based methods are closely related to the proposed pda approach .",
    "@xcite proposed to use the distance between a sample and its @xmath1th - nearest neighbor as the anomaly score for the sample ; similarly , @xcite and @xcite proposed to the use the sum of the distances between a sample and its @xmath1 nearest neighbors .",
    "@xcite used an anomaly score based on the local density of the @xmath1 nearest neighbors of a sample . @xcite and",
    "@xcite introduced non - parametric adaptive anomaly detection methods using geometric entropy minimization , based on random @xmath1-point minimal spanning trees and bipartite @xmath1-nearest neighbor ( @xmath1-nn ) graphs , respectively .",
    "@xcite proposed an anomaly detection algorithm k - lpe using local p - value estimation ( lpe ) based on a @xmath1-nn graph .",
    "these @xmath1-nn anomaly detection schemes only depend on the data through the pairs of data points ( dyads ) that define the edges in the @xmath1-nn graphs .",
    "all of the aforementioned methods are designed for _ single - criteria _ anomaly detection . in the _ multi - criteria _ setting , the single - criteria algorithms must be executed multiple times with different weights , unlike the pda anomaly detection algorithm that we propose in section [ detection ] .",
    "the pda method proposed in this paper utilizes the notion of pareto optimality , which has been studied in many application areas in economics , computer science , and the social sciences among others @xcite .",
    "we introduce pareto optimality and define the notion of a pareto front .",
    "consider the following problem : given @xmath2 items , denoted by the set @xmath3 , and @xmath0 criteria for evaluating each item , denoted by functions @xmath4 , select @xmath5 that minimizes @xmath6 $ ] . in most settings , it is not possible to identify a single item @xmath7 that simultaneously minimizes @xmath8 for all @xmath9 .",
    "a minimizer can be found by combining the @xmath0 criteria using a linear combination of the @xmath10 s and finding the minimum of the combination .",
    "different choices of ( non - negative ) weights in the linear combination could result in different minimizers ; a set of items that are minimizers under some linear combination can then be created by using a grid search over the weights , for example .",
    "a more powerful approach involves finding the set of pareto - optimal items .",
    "an item @xmath7 is said to _ strictly dominate _ another item @xmath11 if @xmath7 is no greater than @xmath11 in each criterion and @xmath7 is less than @xmath11 in at least one criterion .",
    "this relation can be written as @xmath12 if @xmath13 for each @xmath14 and @xmath15 for some @xmath14 .",
    "the set of pareto - optimal items , called the _ pareto front _ , is the set of items in @xmath3 that are not strictly dominated by another item in @xmath3 .",
    "it contains all of the minimizers that are found using linear combinations , but also includes other items that can not be found by linear combinations .",
    "denote the pareto front by @xmath16 , which we call the first pareto front .",
    "the second pareto front can be constructed by finding items that are not strictly dominated by any of the remaining items , which are members of the set @xmath17 .",
    "more generally , define the @xmath14th pareto front by @xmath18 for convenience , we say that a pareto front @xmath19 is _ deeper _ than @xmath20 if @xmath21 .",
    "the distribution of the number of points on the first pareto front was first studied by barndorff - nielsen and sobel in their seminal work  @xcite .",
    "the problem has garnered much attention since ; for a survey of recent results see  @xcite .",
    "we will be concerned here with properties of the first pareto front that are relevant to the pda anomaly detection algorithm and thus have not yet been considered in the literature .",
    "let @xmath22 be independent and identically distributed  ( i.i.d . )  on @xmath23 with density function @xmath24 .",
    "for a measurable set @xmath25 , we denote by @xmath26 the points on the first pareto front of @xmath22 that belong to @xmath27 . for simplicity",
    ", we will denote @xmath16 by @xmath28 and use @xmath29 for the cardinality of @xmath28 . in the general pareto framework ,",
    "the points @xmath22 are the images in @xmath23 of @xmath2 feasible solutions to some optimization problem under a vector of objective functions of length @xmath30 . in the context of this paper",
    ", each point @xmath31 corresponds to a dyad @xmath32 , which we define in section [ detection ] , and @xmath33 is the number of criteria .",
    "a common approach in multi - objective optimization is linear scalarization  @xcite , which constructs a new single criterion as a convex combination of the @xmath30 criteria .",
    "it is well - known , and easy to see , that linear scalarization will only identify pareto points on the boundary of the convex hull of @xmath34 , where @xmath35 .",
    "although this is a common motivation for pareto methods , there are , to the best of our knowledge , no results in the literature regarding how many points on the pareto front are missed by scalarization .",
    "we present such a result here .",
    "we define @xmath36 the subset @xmath37 contains all pareto - optimal points that can be obtained by some selection of weights for linear scalarization .",
    "we aim to study how large @xmath38 can get , compared to @xmath28 , in expectation . in the context of this paper ,",
    "if some pareto - optimal points are not identified , then the anomaly score  ( defined in section [ score ] )  will be artificially inflated , making it more likely that a non - anomalous sample will be rejected .",
    "hence the size of @xmath39 is a measure of how much the anomaly score is inflated and the degree to which pareto methods will outperform linear scalarization .",
    "pareto points in @xmath40 are a result of non - convexities in the pareto front .",
    "we study two kinds of non - convexities : those induced by the geometry of the domain of @xmath22 , and those induced by randomness .",
    "we first consider the geometry of the domain .",
    "let @xmath41 be bounded and open with a smooth boundary @xmath42 and suppose the density @xmath43 vanishes outside of @xmath44 .",
    "for a point @xmath45 we denote by @xmath46 the unit inward normal to @xmath47 .",
    "for @xmath48 , define @xmath49 by @xmath50 .",
    "given @xmath51 it is not hard to see that all pareto - optimal points will almost surely lie in @xmath52 for large enough @xmath2 , provided the density @xmath43 is strictly positive on @xmath53 . hence it is enough to study the asymptotics for @xmath54 for @xmath48 and @xmath51 .",
    "[ thm : asym ] let @xmath55 with @xmath56 .",
    "let @xmath48 be open and connected such that @xmath57 then for @xmath51 sufficiently small , we have @xmath58 where @xmath59 .",
    "the proof of theorem [ thm : asym ] is postponed to appendix [ proofs ] .",
    "theorem [ thm : asym ] shows asymptotically how many pareto points are contributed on average by the segment @xmath48 .",
    "the number of points contributed depends only on the geometry of @xmath47 through the direction of its normal vector @xmath60 and is otherwise independent of the convexity of @xmath47 . hence , by using pareto methods , we will identify significantly more pareto - optimal points than linear scalarization when the geometry of @xmath47 includes non - convex regions .",
    "for example , if @xmath61 is non - convex  ( see left panel of figure [ fig : theory ] ) and satisfies the hypotheses of theorem [ thm : asym ] , then for large enough @xmath2 , all pareto points in a neighborhood of @xmath62 will be unattainable by scalarization .",
    "quantitatively , if @xmath63 on @xmath62 , then @xmath64 , as @xmath65 , where @xmath66 and @xmath67 is the @xmath68 dimensional hausdorff measure of @xmath62 .",
    "it has recently come to our attention that theorem [ thm : asym ] appears in a more general form in an unpublished manuscript of @xcite .",
    "we now study non - convexities in the pareto front which occur due to inherent randomness in the samples .",
    "we show that , even in the case where @xmath44 is convex , there are still numerous small - scale non - convexities in the pareto front that can only be detected by pareto methods .",
    "we illustrate this in the case of the pareto box problem for @xmath69 .",
    "[ thm : small ] let @xmath22 be independent and uniformly distributed on @xmath70 ^ 2 $ ] . then @xmath71    the proof of theorem [ thm : small ] is also postponed to appendix [ proofs ] .",
    "a proof that @xmath72 as @xmath73 can be found in  @xcite .",
    "hence theorem [ thm : small ] shows that , asymptotically and in expectation , only between @xmath74 and @xmath75 of the pareto - optimal points can be obtained by linear scalarization in the pareto box problem .",
    "experimentally , we have observed that the true fraction of points is close to @xmath76 .",
    "this means that at least @xmath77 ( and likely more ) of the pareto points can only be obtained via pareto methods even when @xmath44 is convex .",
    "figure [ fig : theory ] gives an example of the sets @xmath28 and @xmath38 from the two theorems .",
    "assume that a training set @xmath78 of nominal data samples is available .",
    "given a test sample @xmath79 , the objective of anomaly detection is to declare @xmath79 to be an anomaly if @xmath79 is significantly different from samples in @xmath80 .",
    "suppose that @xmath81 different evaluation criteria are given .",
    "each criterion is associated with a measure for computing dissimilarities .",
    "denote the dissimilarity between @xmath82 and @xmath83 computed using the measure corresponding to the @xmath84th criterion by @xmath85 .",
    "we define a _ dyad _ by @xmath86^t \\in   \\mathbb{r}_{+}^k , i \\in \\{1,\\ldots , n\\ } , j \\in \\{1,\\ldots , n\\ } \\setminus i$ ] .",
    "each dyad @xmath32 corresponds to a connection between samples @xmath82 and @xmath83 .",
    "therefore , there are in total @xmath87 different dyads . for convenience ,",
    "denote the set of all dyads by @xmath88 and the space of all dyads @xmath89 by @xmath90 . by the definition of strict dominance in section [ prealg ] , a dyad @xmath32 strictly dominates another dyad @xmath91 if @xmath92 for all @xmath93 and @xmath94 for some @xmath84 .",
    "the first pareto front @xmath16 corresponds to the set of dyads from @xmath88 that are not strictly dominated by any other dyads from @xmath88 .",
    "the second pareto front @xmath95 corresponds to the set of dyads from @xmath96 that are not strictly dominated by any other dyads from @xmath96 , and so on , as defined in section [ prealg ] . recall that we refer to @xmath19 as a _",
    "deeper _ front than @xmath20 if @xmath21 .      for each sample @xmath97",
    ", there are @xmath98 dyads corresponding to its connections with the other @xmath98 samples .",
    "define the set of @xmath98 dyads associated with @xmath97 by @xmath99 .",
    "if most dyads in @xmath99 are located at shallow pareto fronts , then the dissimilarities between @xmath97 and the other @xmath98 samples are small under _ some _ combination of the criteria .",
    "thus , @xmath97 is likely to be a nominal sample .",
    "this is the basic idea of the proposed multi - criteria anomaly detection method using pda .",
    "we construct pareto fronts @xmath100 of the dyads from the training set , where the total number of fronts @xmath101 is the required number of fronts such that each dyad is a member of a front .",
    "when a test sample @xmath79 is obtained , we create new dyads corresponding to connections between @xmath79 and training samples , as illustrated in figure [ bi_sample ] .",
    "similar to many other anomaly detection methods , we connect each test sample to its @xmath1 nearest neighbors .",
    "@xmath1 could be different for each criterion , so we denote @xmath102 as the choice of @xmath1 for criterion @xmath14 .",
    "we create @xmath103 new dyads , which we denote by the set @xmath104 , corresponding to the connections between @xmath79 and the union of the @xmath102 nearest neighbors in each criterion @xmath14 .",
    "in other words , we create a dyad between @xmath79 and @xmath83 if @xmath83 is among the @xmath102 nearest neighbors nearest neighbors in multiple criteria , then multiple copies of the dyad corresponding to the connection between the test sample and the training sample are created . ] of @xmath79 in any criterion @xmath14 .",
    "we say that @xmath105 is _ below _ a front @xmath106 if @xmath107 , i.e.  @xmath105 strictly dominates at least a single dyad in @xmath106 .",
    "define the depth of @xmath108 by @xmath109 therefore if @xmath110 is large , then @xmath111 will be near deep fronts , and the distance between @xmath79 and the corresponding training sample is large under _ all _ combinations of the @xmath0 criteria . if @xmath110 is small , then @xmath111 will be near shallow fronts , so the distance between @xmath79 and the corresponding training sample is small under _ some _ combination of the @xmath0 criteria .      in k - nn based anomaly detection algorithms such as those mentioned in section [ related ] ,",
    "the _ anomaly score _ is a function of the @xmath1 nearest neighbors to a test sample . with multiple criteria",
    ", one could define an anomaly score by scalarization . from the probabilistic properties of pareto fronts discussed in section",
    "[ theory ] , we know that pareto methods identify more pareto - optimal points than linear scalarization methods and significantly more pareto - optimal points than a single weight for scalarization and [ thm : small ] require i.i.d .  samples , but dyads are not independent .",
    "however , there are @xmath112 dyads , and each dyad is only dependent on @xmath113 other dyads .",
    "this suggests that the theorems should also hold for the non - i.i.d .",
    "dyads as well , and it is supported by experimental results presented in appendix [ exp_sup ] . ] .",
    "this motivates us to develop a _ multi - criteria anomaly score _ using pareto fronts .",
    "we start with the observation from figure [ bi_sample ] that dyads corresponding to a nominal test sample are typically located near shallower fronts than dyads corresponding to an anomalous test sample . each test sample",
    "is associated with @xmath114 new dyads , where the @xmath14th dyad @xmath105 has depth @xmath110 . for each test sample @xmath79 ,",
    "we define the anomaly score @xmath115 to be the mean of the @xmath110 s , which corresponds to the average depth of the @xmath114 dyads associated with @xmath79 . thus the anomaly score can be easily computed and compared to the decision threshold @xmath116 using the test @xmath117    training phase :    testing phase :    pseudocode for the pda anomaly detector is shown in algorithm [ alg ] . in appendix",
    "[ implement ] we provide details of the implementation as well as an analysis of the time complexity and a heuristic for choosing the @xmath102 s that performs well in practice . both the training time and the time required to test a new sample using pda are _ linear _ in the number of criteria @xmath0 . to handle multiple criteria , other anomaly detection methods , such as",
    "the ones mentioned in section [ related ] , need to be re - executed multiple times using different ( non - negative ) linear combinations of the @xmath0 criteria . if a grid search is used for selection of the weights in the linear combination , then the required computation time would be exponential in @xmath0 .",
    "such an approach presents a computational problem unless @xmath0 is very small . since pda scales _ linearly _ with @xmath0 , it does not encounter this problem .",
    "we compare the pda method with four other nearest neighbor - based single - criterion anomaly detection algorithms mentioned in section [ related ] . for these methods ,",
    "we use linear combinations of the criteria with different weights selected by grid search to compare performance with pda .",
    "first we present an experiment on a simulated data set .",
    "the nominal distribution is given by the uniform distribution on the hypercube @xmath70 ^ 4 $ ] .",
    "the anomalous samples are located just outside of this hypercube .",
    "there are four classes of anomalous distributions .",
    "each class differs from the nominal distribution in one of the four dimensions ; the distribution in the anomalous dimension is uniform on @xmath118 $ ] .",
    "we draw @xmath119 training samples from the nominal distribution followed by @xmath120 test samples from a mixture of the nominal and anomalous distributions with a @xmath121 probability of selecting any particular anomalous distribution . the four criteria for this experiment correspond to the squared differences in each dimension .",
    "if the criteria are combined using linear combinations , the combined dissimilarity measure reduces to weighted squared euclidean distance .",
    "the different methods are evaluated using the receiver operating characteristic ( roc ) curve and the area under the curve ( auc ) .",
    "the mean aucs ( with standard errors ) over @xmath120 simulation runs are shown in table .",
    "a grid of six points between @xmath122 and @xmath123 in each criterion , corresponding to @xmath124 different sets of weights , is used to select linear combinations for the single - criterion methods . note that pda is the best performer , outperforming even the best linear combination .",
    "we now present an experiment on a real data set that contains thousands of pedestrians trajectories in an open area monitored by a video camera @xcite .",
    "each trajectory is approximated by a cubic spline curve with seven control points @xcite .",
    "we represent a trajectory with @xmath84 time samples by @xmath125 where @xmath126 $ ] denote a pedestrian s position at time step @xmath127 .",
    "we use two criteria for computing the dissimilarity between trajectories .",
    "the first criterion is to compute the dissimilarity in _",
    "walking speed_. we compute the instantaneous speed at all time steps along each trajectory by finite differencing , i.e.  the speed of trajectory @xmath62 at time step @xmath127 is given by @xmath128 .",
    "a histogram of speeds for each trajectory is obtained in this manner .",
    "we take the dissimilarity between two trajectories to be the squared euclidean distance between their speed histograms .",
    "the second criterion is to compute the dissimilarity in _",
    "shape_. for each trajectory , we select @xmath120 points , uniformly positioned along the trajectory .",
    "the dissimilarity between two trajectories @xmath62 and @xmath129 is then given by the sum of squared euclidean distances between the positions of @xmath62 and @xmath129 over all @xmath120 points .",
    "the training sample for this experiment consists of @xmath130 trajectories , and the test sample consists of @xmath131 trajectories .",
    "table shows the performance of pda as compared to the other algorithms using @xmath120 uniformly spaced weights for linear combinations . notice that pda has higher auc than the other methods under _ all _ choices of weights for the two criteria . for a more detailed comparison ,",
    "the roc curve for pda and the attainable region for k - lpe ( the region between the roc curves corresponding to weights resulting in the best and worst aucs ) is shown in figure [ roc_curves ] along with the first @xmath120 pareto fronts for pda .",
    "k - lpe performs slightly better at low false positive rate when the best weights are used , but pda performs better in all other situations , resulting in higher auc .",
    "additional discussion on this experiment can be found in appendix [ traj_add ] .",
    "in this paper we proposed a new multi - criteria anomaly detection method .",
    "the proposed method uses pareto depth analysis to compute the anomaly score of a test sample by examining the pareto front depths of dyads corresponding to the test sample .",
    "dyads corresponding to an anomalous sample tended to be located at deeper fronts compared to dyads corresponding to a nominal sample . instead of choosing a specific weighting or performing a grid search on the weights for different dissimilarity measures ,",
    "the proposed method can efficiently detect anomalies in a manner that scales linearly in the number of criteria .",
    "we also provided a theorem establishing that the pareto approach is asymptotically better than using linear combinations of criteria .",
    "numerical studies validated our theoretical predictions of pda s performance advantages on simulated and real data .",
    "we thank zhaoshi meng for his assistance in labeling the pedestrian trajectories .",
    "we also thank daniel dewoskin for suggesting a fast algorithm for computing pareto fronts in two criteria .",
    "this work was supported in part by aro grant w911nf-09 - 1 - 0310 .",
    "before presenting the proofs of theorems [ thm : asym ] and [ thm : small ] we need a preliminary result .    [",
    "lem : num_pts ] for any @xmath132 and @xmath25 measurable , we have @xmath133    since @xmath22 are i.i.d , we have @xmath134 . conditioning on @xmath135 we obtain @xmath136 . the proof is completed by noting that @xmath137    by selecting @xmath51 smaller , if necessary , we can write as @xmath138 where @xmath139 for @xmath140 . since @xmath47 is smooth , we can approximate @xmath62 near @xmath141 by a hyperplane with normal @xmath142 . by the assumption that @xmath143 we can make @xmath51 smaller , if neceessary , so that @xmath144 is approximately a simplex with side lengths @xmath145 .",
    "hence @xmath146 substituting this into , we have @xmath147 we can now do an asymptotic analysis of the inner integral which is a special case of the general equation @xmath148 , a , b>0.\\ ] ] making the change of variables @xmath149 and simplifying , we obtain @xmath150 where @xmath151 we can , of course , choose @xmath152 small enough so that @xmath153 is finite and positive . recalling the definition of the gamma function , @xmath154 , we see that @xmath155 note that we are keeping track of @xmath156 terms because @xmath157 may become large at different points of @xmath62 , whereas @xmath158 is uniformly bounded independent of @xmath159 along @xmath62 .",
    "applying this to with @xmath160 completes the proof .    since @xmath22 are i.i.d .",
    ", we have @xmath161 . for",
    "@xmath162 ^ 2 $ ] let @xmath163 be the event that @xmath164 and @xmath165 .",
    "conditioning on @xmath163 we have @xmath166 define @xmath167 ^ 2 \\ ; | \\ ; 0 <",
    "u < x , \\ ;   y < v < 2y -\\frac{uy}{x}\\right\\},\\ ] ] and @xmath168 ^ 2 \\ ; | \\ ; x < u < 1 , \\ ;",
    "0 < v < 2y -\\frac{uy}{x}\\right\\}.\\ ] ] let @xmath169 be the event that @xmath27 and @xmath170 each contain at least one sample from @xmath171 . if @xmath169 occurs , then @xmath172 is in the interior of the convex hull of @xmath28 and hence @xmath173 .",
    "let @xmath174 denote the event that none of the samples from @xmath171 fall in @xmath175 .",
    "if @xmath174 occurs , then we clearly have @xmath176 .",
    "it follows that @xmath177 conditioned on @xmath163 , the samples @xmath178 remain independent .",
    "the conditional density function of each remaining sample is @xmath179 .",
    "let @xmath180 ( resp .",
    "@xmath181 ) denote the event that no samples from @xmath171 are drawn from @xmath27 ( resp .",
    "@xmath170 ) . then @xmath182 and @xmath183 .",
    "noting that @xmath184 , we see that @xmath185 and @xmath186 substituting this into , we obtain @xmath187 and @xmath188 a short calculation ( change variables to @xmath189 and @xmath190 ) shows that @xmath191 applying this result to the bounds above completes the proof .",
    "independence of @xmath22 is built into the assumptions of theorems [ thm : asym ] and [ thm : small ] , but it is clear that dyads ( as constructed in section [ detection ] ) are not independent .",
    "each dyad @xmath192 represents a connection between two independent samples @xmath82 and @xmath83 . for a given dyad @xmath192",
    ", there are @xmath193 corresponding dyads involving @xmath82 or @xmath83 and these are clearly not independent from @xmath192 .",
    "however , all other dyads are independent from @xmath192 .",
    "so while there are @xmath112 dyads , each dyad is independent from all other dyads except for a set of size @xmath113 . since theorems [ thm : asym ] and [ thm : small ] deal with asymptotic results , this suggests they should hold for the dyads even though they are not i.i.d . in this section",
    "we present some experimental results that support this non - rigorous statement .",
    "we first drew samples uniformly in @xmath70 ^ 2 $ ] and computed the dyads corresponding to the two criteria @xmath194 and @xmath195 , which denote the absolute differences between the @xmath7 and @xmath196 coordinates , respectively .",
    "the domain of the resulting dyads is again the box @xmath70 ^ 2 $ ] , as shown in figure , so this experiment tests theorem [ thm : small ] . in this case ,",
    "theorem [ thm : small ] suggests that @xmath40 should grow logarithmically .",
    "figure shows the sample means versus number of dyads and a best fit logarithmic curve of the form @xmath197 , where @xmath198 denotes the number of dyads . a linear regression on @xmath199 versus @xmath200 gave @xmath201 which falls in the range specified by theorem [ thm : small ] .",
    "we next looked to find criteria that induce domains other than boxes in order to test theorem [ thm : asym ] .",
    "a somewhat contrived example involves the criteria @xmath202 and @xmath203 , which , when applied to uniformly sampled data on @xmath70 ^ 2 $ ] , yields dyads sampled on a diamond domain , as shown in figure . in this case ,",
    "theorem [ thm : asym ] suggests that @xmath39 should grow as @xmath204 .",
    "figure shows the sample means versus number of dyads and a best fit curve of the form @xmath205 . a linear regression on @xmath206 versus @xmath200 gave @xmath207 and @xmath208 .",
    "although this example may not be practical , it is simply meant to illustrate the applicability of theorem [ thm : asym ] for non - independent samples . in each experiment , we varied the number of dyads between @xmath209 to @xmath210 in increments of @xmath209 and computed the size of @xmath40 after each increment .",
    "we ran each experiment @xmath211 times to compute the sample means shown in figure [ dyad_data ] .",
    "pseudocode for the pda anomaly detector was presented as algorithm [ alg ] in section [ score ] .",
    "the training phase involves creating @xmath212 dyads corresponding to all pairs of training samples . computing all pairwise dissimilarities in each criterion",
    "requires @xmath213 floating - point operations ( flops ) , where @xmath214 denotes the number of dimensions involved in computing a dissimilarity .",
    "the pareto fronts are constructed by non - dominated sorting . in section [ fastsort ]",
    "we present a fast algorithm for non - dominated sorting in two criteria ; for more than two criteria , we use the non - dominated sort of @xcite that constructs all of the pareto fronts using @xmath215 comparisons in the worst case .",
    "the testing phase involves creating dyads between the test sample and the @xmath216 nearest training samples in criterion @xmath84 , which requires @xmath217 flops . for each dyad @xmath105",
    ", we need to calculate the depth @xmath110 .",
    "this involves comparing the test dyad with training dyads on multiple fronts until we find a training dyad that is dominated by the test dyad .",
    "@xmath110 is the front that this training dyad is a part of . using a binary search to select the front and another binary search to select the training dyads within the front to compare to",
    ", we need to make @xmath218 comparisons ( in the worst case ) to compute @xmath110 .",
    "the anomaly score is computed by taking the mean of the @xmath114 @xmath110 s corresponding to the test sample ; the score is then compared against a threshold @xmath116 to determine whether the sample is anomalous . as mentioned in the section [ score ] , both the training and testing phases scale linearly with the number of criteria @xmath0 .",
    "we present here a fast algorithm for non - dominated sorting in two criteria .",
    "the standard algorithm of @xcite takes @xmath219 time and requires @xmath219 memory , where @xmath220 is the number of dyads . in our experience ,",
    "the memory requirement is the largest obstacle to applying pareto methods to large data sets .",
    "our algorithm runs in @xmath221 time on average and requires @xmath222 memory .",
    "it is based on the following observation : if the data set is sorted in ascending order in the first criterion , then the first point is pareto - optimal , and each subsequent pareto - optimal point can be found by searching for the next point in the sorted list that is not dominated by the most recent addition to the pareto front . for two criteria ,",
    "there are on average @xmath223 pareto fronts , and finding each front with this algorithm requires visiting at most @xmath2 points , hence the @xmath221 average complexity .",
    "the worst case complexity is @xmath219 occurring when each pareto front consists of a single point .",
    "pseudocode for the algorithm is shown in algorithm [ fast_ndom ] .",
    "it has recently come to our attention that an @xmath224 algorithm exists for the canonical anti - chain partition problem  @xcite , which is equivalent to non - dominated sorting in two criteria , and can also be used to quickly construct the pareto fronts .",
    "the parameters to be selected in pda are @xmath225 , which denote the number of nearest neighbors in each criterion .",
    "we connect each test sample @xmath79 to a training sample @xmath83 if @xmath83 is one of the @xmath102 nearest neighbors of @xmath79 in terms of the dissimilarity measure defined by criterion @xmath14 .",
    "we now discuss how these parameters @xmath225 can be selected . for simplicity , first assume that there is only one criterion , so that a single parameter @xmath1 is to be selected .",
    "pda is able to detect an anomaly if the distribution of its dyads with respect to the pareto fronts differs from that of a nominal sample .",
    "specifically the mean of the depths of the dyads ( the @xmath110 s ) corresponding to an anomalous sample must be higher than that of a nominal sample .",
    "if @xmath1 is chosen too small , this may not be the case , especially if there are training samples present near an anomalous sample , in which case , the dyads corresponding to the anomalous sample may reside near shallow fronts much like a nominal sample . on the other hand ,",
    "if @xmath1 is chosen too large , many dyads may correspond to connections to training samples that are far away , even if the test sample is nominal , which also makes the mean depths of nominal and anomalous samples more similar .",
    "we propose to use the properties of @xmath1-nearest neighbor graphs ( @xmath1-nngs ) constructed on the training samples to select the number of training samples to connect to each test sample .",
    "we construct symmetric @xmath1-nngs , i.e.  we connect samples @xmath14 and @xmath226 if @xmath14 is one of the @xmath1 nearest neighbors of @xmath226 or @xmath226 is one of the @xmath1 nearest neighbors of @xmath14 .",
    "we begin with @xmath227 and increase @xmath1 until the @xmath1-nng of the training samples is connected , i.e.  there is only a single connected component . by forcing the @xmath1-nng to be connected ,",
    "we ensure that there are no isolated regions of training samples .",
    "such isolated regions could possibly lead to dyads corresponding to anomalous samples residing near shallow fronts like nominal samples , which is undesirable . by keeping @xmath1 small",
    "while retaining a connected @xmath1-nng , we are trying to avoid the problem of having too many dyads so that even a nominal sample may have many dyads located near deep fronts .",
    "this method of choosing @xmath1 to retain connectivity has been used as a heuristic in other unsupervised learning problems , such as spectral clustering @xcite . note that by requiring the @xmath1-nng to be connected , we are implicitly assuming that the training samples consist of a single class or multiple classes that are in close proximity .",
    "if the training samples contain multiple well - separated classes , such an approach may not work well .",
    "now let s return to the situation pda was designed for , with @xmath0 different criteria . for each criterion",
    "@xmath14 , we construct a @xmath102-nng using the corresponding dissimilarity measure and increase @xmath102 until the @xmath102-nng is connected .",
    "we then connect each test sample to @xmath103 training samples .",
    "note that we are choosing each @xmath102 independent of the other criteria , which is probably not an optimal approach . in principle , an approach that chooses the @xmath102 s jointly could perform better ; however , such an approach would add to the complexity .",
    "we choose _ separate _",
    "@xmath102 s for each criterion , which we find is necessary to obtain good performance when different dissimilarities have varying scales and properties .",
    "there are , however , pathological examples where the independent approach could choose @xmath102 s poorly , such as the well - known example of two moons .",
    "these examples typically involve multiple well - separated classes , which may be problematic as previously mentioned . how to choose the @xmath102 s when the training samples contain multiple well - separated classes is beyond the scope of this paper and is an area for future work .",
    "we find the proposed heuristic to work well in practice , including for both examples presented in section [ exp ] .",
    "$ ] . the automatically selected parameters @xmath228 $ ] are very close to the optimal parameters @xmath229$].,width=8 ]    figure [ traj_pda ] shows some abnormal trajectories and nominal trajectories detected using pda .",
    "recall that the two criteria used are walking speed and trajectory shape .",
    "anomalous trajectories could have anomalous speeds or shapes ( or both ) , so some anomalous trajectories in figure [ traj_pda ] may not look anomalous by shape alone .",
    "we find that the heuristic proposed in section [ param ] for choosing the @xmath102 s performs quite well in this experiment , as shown in figure [ auc_heatmap ] .",
    "specifically , the auc obtained when using the parameters chosen by the proposed heuristic is very close to the auc obtained when using the optimal parameters , which are not known in advance .",
    "as discussed in section [ traj ] , it is also higher than the aucs of all of the single - criterion anomaly detection methods , even under the best choice of weights .",
    "y.  jin and b.  sendhoff ( 2008 ) .",
    "pareto - based multiobjective machine learning : an overview and case studies .",
    "_ ieee transactions on systems , man , and cybernetics , part c : applications and reviews _ * 38*(3):397415 .",
    "v.  sindhwani , p.  niyogi , and m.  belkin ( 2005 ) .",
    "a co - regularization approach to semi - supervised learning with multiple views . in _ proceedings of the workshop on learning with multiple views , 22nd international conference on machine learning_.",
    "e.  eskin , a.  arnold , m.  prerau , l.  portnoy , and s.  stolfo ( 2002 ) .",
    "a geometric framework for unsupervised anomaly detection : detecting intrusions in unlabeled data . in _ applications of data mining in computer security_. kluwer : norwell , ma .",
    "k.  deb , s.  agrawal , a.  pratap , and t.  meyarivan ( 2000 ) . a fast elitist non - dominated sorting genetic algorithm for multi - objective optimization : nsga - ii . in _ proceedings of the 6th international conference on parallel problem solving from nature_."
  ],
  "abstract_text": [
    "<S> we consider the problem of identifying patterns in a data set that exhibit anomalous behavior , often referred to as anomaly detection . in most anomaly detection algorithms , the dissimilarity between data samples </S>",
    "<S> is calculated by a single criterion , such as euclidean distance . however , in many cases there may not exist a single dissimilarity measure that captures all possible anomalous patterns . </S>",
    "<S> in such a case , multiple criteria can be defined , and one can test for anomalies by scalarizing the multiple criteria using a linear combination of them . if the importance of the different criteria are not known in advance , the algorithm may need to be executed multiple times with different choices of weights in the linear combination . in this paper , we introduce a novel non - parametric _ multi - criteria _ anomaly detection method using _ pareto depth analysis _ ( pda ) . </S>",
    "<S> pda uses the concept of pareto optimality to detect anomalies under multiple criteria without having to run an algorithm multiple times with different choices of weights . </S>",
    "<S> the proposed pda approach scales _ linearly _ in the number of criteria and is provably better than linear combinations of the criteria . </S>"
  ]
}