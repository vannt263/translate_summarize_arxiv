{
  "article_text": [
    "we have developed a code to fully solve for the dynamics of a general relativistic spacetime which is inhomogeneous but spherically symmetric , with a source given by matter and radiation .",
    "exact solutions of the einstein field equations exist for such a geometry if the matter is purely dust ( lematre - tolman - bondi models ) , or pure radiation ( so called lematre models )  @xcite , but in the case where both sources are present an exact solution is not possible in general ( see also @xcite for the set of equations in the case of @xmath0 perfect fluids ) . because the dust is geodesic and the radiation not ( except in the homogeneous sub - case ) the dust and radiation are non - comoving , making the total effective fluid anisotropic .",
    "there are a variety of circumstances where a model such as this is important to investigate , for example :    relativistic effects during decoupling : :    the non - linear evolution of cosmological perturbations during    decoupling leads to important deviations from gaussianity in the cmb    as well as the late time matter power spectrum ( see e.g.  @xcite ) .",
    "furthermore , non - linear dynamics of the photon - baryon plasma coupled    through gravity to the dark matter will lead to subtle changes to the    baryon acoustic oscillations and the corresponding peak in the galaxy    power spectrum .",
    "general relativistic aspects of deviations from    canonical linear theory can be studied in a model setup such as this ,    and can be used to place limits on the accuracy of perturbation    theory , although the simplification of spherical symmetry means that    we could not produce a comprehensive measurement prediction .",
    "void models of dark energy : :    one of the key constraints on void models for dark energy ( see  @xcite    for a comprehensive review ) arise from combined constraints from the    cmb combined with local measurements of @xmath1 ( see , e.g. ,    @xcite ) . it was argued in  @xcite that those constraints only apply    to adiabatic voids in which the radiation is assumed to be homogeneous    while that of the matter is inhomogeneous .",
    "furthermore , observations    such as the kinetic sunyaev - zeldovich effect and the baryon acoustic    oscillation feature in the matter power spectrum depend strongly on    the decoupling time ; as this may not be homogeneous , predictions of    these effects can alter dramatically depending on the initial    radiation profile . to understand this",
    "we need a fully relativistic    modelling of a spherically symmetric spacetime which allows for    non - comoving matter and radiation at the background level .",
    "inhomogeneous big - bang nucleosynthesis : :    the possibility of an inhomogeneous big - bang nucleosynthesis ( bbn )    with a varying baryon to photon and/or neutron to proton ratio on    scales comparable to particle diffusion horizon at bbn has been widely    studied in the literature , with the inhomogeneities often modelled    assuming spherical symmetry ( see , e.g. , @xcite for a review ) .",
    "the    solution presented here can be exploited to study the case of    isocurvature inhomogeneities and to consistently couple the particle    physics dynamics to the expansion of the locally inhomogeneous    universe .    in the first iteration of the model presented here",
    "we make two approximations .",
    "the baryons and dark matter are described as a single dust fluid , which is a poor approximation during decoupling when the baryons are tightly coupled to the photons through compton scattering .",
    "the radiation is treated as a perfect fluid . in general",
    "however , in the einstein - boltzmann equations for the radiation fluid , higher moments such as the anisotropic pressure can not be neglected in an inhomogeneous spacetime .",
    "our current focus is however on a model in which the length - scale associated with the spherical inhomogeneity is much larger than the horizon size at matter - radiation equality .",
    "this allows us to disregard the dragging of baryons by the photons until decoupling .",
    "moreover , since such models develop significant shear only at late times and on large scales , neglecting the higher moments should be a reasonable approximation to begin with ( anisotropic pressure is sourced by the energy density of the radiation times the shear ) .    both of these approximations will be removed in later iterations of the code .",
    "the paper is organized as follows . in section  [ sec : model ]",
    "we present the system of equations describing a spherically symmetric spacetime with a source of dust and radiation .",
    "the numerical implementation is described in section  [ sec : num ] . in section  [ sec : ex ] we show concrete physical examples which are also used to test the accuracy of the code . section  [ sec : conc ] concludes .",
    "we shall write the einstein field equations using the orthonormal frame formalism   see  @xcite which we refer to for definitions and notation . the original derivation can be found in  @xcite , which we reproduce here .",
    "the line - element has the form ds^2 = - n^2 d^2 + ( ) ^-2 dr^2 + ( ) ^-2 ( d^2 + ^2 d^2 ) . @xmath2 and @xmath3 are frame coefficients and depend on @xmath4 and @xmath5 .",
    "( we reserve @xmath6 for proper time . )",
    "the killing vector fields are given by @xcite : _",
    "_ -  _ ,  _ +  _ .",
    "the orthonormal frame vectors are : _ 0 = n^-1 _ , _ 1 = _ r ,",
    "_ 2 = _ , _ 3 = _ , where @xmath7 .",
    "@xmath8 , @xmath2 and @xmath3 are functions of @xmath4 and @xmath5 .",
    "spherical symmetry leads to the following restrictions on the orthonormal frame components of the kinematic variables   the shear , vorticity and acceleration : _",
    "= ( -2 , , ) , _ = 0 , _ = ( _ 1,0,0 ) , where _ 1 = _",
    "1 n. the spatial commutation functions simplify to : a_= ( a_1 , a_2 , 0 ) , n _",
    "= (    ccc 0 & 0 & n_13 + 0 & 0 & 0 + n_13 & 0 & 0    ) , where a_1 = _ 1 , a_2 = n_13 = - 12 ; and the matter components simplify to : q_= ( q_1,0,0 ) , _ = ( -2_+,_+,_+ ) .",
    "the frame rotation @xmath9 is zero . to compare with the setup in  @xcite",
    ", we identify : @xmath10 ( see @xcite for the notation ) .",
    "now , @xmath11 only appears in the equations together with @xmath12 in the form of the gauss curvature of the spheres ^2k : = 2(_2 - 2 n_13 ) n_13 , which simplifies to ^2k = ( ) ^2 .",
    "thus there is no dependence on @xmath13 in the equations .",
    "the spatial curvatures also simplify to : ^3s _ = ( -2,, ) , with @xmath14 and @xmath15 given by : @xmath16    we will drop the index from @xmath17 and write them as @xmath18 .",
    "to summarize , so far there are ten variables n ,  ,  ,  h ,  ,  a ,  ,  q_1 ,  p ,  _ + .",
    "the evolution of @xmath8 , @xmath19 and @xmath20 are yet to be specified .",
    "a temporal gauge choice determines @xmath8 , and a fluid model determines @xmath19 and @xmath20 .    before the matter is specified and the gauge chosen , we now have the following underdetermined system .",
    "@xmath21 the constraint equations are the gauss and codazzi constraints , and the definition of @xmath22 : @xmath23 where the spatial curvatures are given by @xmath24      we shall study models with two perfect fluids ( dust and radiation ) with stress energy tensors @xmath25 we require that each fluid satisfy the twice - contracted bianchi identities ( [ b1])([b2 ] ) . we choose the temporal gauge to be comoving with the dust : @xmath26 , and set the lapse to @xmath27 .",
    "we use @xmath28 to denote the dust density , and @xmath29 for the radiation tilt : u^=(_0+v_1 ) ,  = ( 1-v^2)^1/2",
    ". then the radiation density measured in the dust frame is given by = ^(1+^2 v^2 ) .",
    "after the matter is specified and the gauge chosen , we now have the following closed system : @xmath30 \\\\   \\label{e0_v }      \\e_0 v & = - \\frac{(1-v^2)^2}{4 g_- \\mu } \\e_1 \\mu      - \\frac{8v^3}{9 g_+ g_- } \\e_1 v          - \\frac{(1-v^2)v}{g_- } \\left [ - 2 \\sp + \\frac23 v a \\right],\\end{aligned}\\ ] ] where @xmath31 .",
    "the constraint equations are @xmath32    we have made two key assumptions in the above equations : that the radiation is a perfect fluid , and that the baryons and dark matter can be treated as a single dust fluid , which is only valid in the free - streaming case .    in order to relax the perfect fluid approximation for radiation mentioned in the introduction",
    ", one should add the evolution of the quadrupole and higher multipoles ( see , e.g. , section vi in @xcite for the equations ) .",
    "it implies modifying the evolution equation for the radiation density , which would receive a source term from the anisotropic pressure part of the radiation ( the quadrupole ) ; the evolution equation for this is sourced by the octopole , and so on .",
    "this significantly increases the complexity of the system ( and increases the number of terms which need to be regularized or kept with small numerical errors ) , and will be left to future iterations of the code .    to describe baryons and dark matter as two separate , non - comoving , fluids , two new variables ( a density and relative velocity ) enter the system , adding two evolution equations and a few extra terms to the other equations .",
    "the appropriate terms for coupling baryons to photons come from the boltzmann equation ( again see , e.g. , @xcite ) .",
    "( at very early times when the baryons and dark matter become relativistic approximating these components as dust breaks down . )",
    "including these effects will also be left to future versions of the code .      in this section",
    "we develop the luminosity distance and redshift relation for a dust observer at the centre to an object on the dust congruence @xmath33 .",
    "consider the observer at the centre receiving an incoming photon at the present time @xmath34 .",
    "let @xmath35 denote the location of the incoming photon at time @xmath6 .",
    "it is governed by ( from @xmath36 ) x_(t ) = - n |_(t , x_(t ) ) , with initial condition @xmath37 , and @xmath38 denotes the derivation along the null geodesic .",
    "let @xmath39 be the 4-vector of an incoming radial null geodesic ( @xmath40 ) : @xmath41 which satisfies the null geodesic equation k_a;b k^b = 0 .",
    "the components @xmath42 and @xmath43 both give the same equation for @xmath44 , the photon energy : [ epsilon_null_geo ] ( n^-1 - ) = n^-1 + n. assuming @xmath45 and using ( [ evo_ex ] ) , we get ( n^-1 - ) = - ( h-2 ) . for a single ray of light , we consider @xmath46 , abbreviated to @xmath47 .",
    "then [ evo_epsilon ] ( t ) = - n(t ) ( h-2 ) ( t , x_(t ) ) .",
    "the redshift of the incoming light , @xmath48 , is defined in terms of the energy of the photon by 1+z(t ) = .",
    "the actual value of @xmath49 does not matter here , so we set it to 1 in the numerical computation .",
    "the angular diameter distance is determined by considering the divergence of the null vector field : @xmath50 .",
    "the expansion @xmath51 works out to be ( after using ( [ epsilon_null_geo ] ) to simplify ) : = - ( n^-1 - ) . let @xmath52 denote the beam cross - section area . then n^-1 = , which implies that [ ra_ey ] ; @xmath53 is proportional to the angular - diameter distance @xmath54 .",
    "the angular - diameter distance is then @xmath55 .",
    "the luminosity distance is given by @xmath56 .",
    "to convert the system into a pde system suitable for numerics there are a number of issues to consider .",
    "first we use different variables and use the constraints to eliminate spatial derivative terms in the evolution equations ( [ e0_sp ] ) and ( [ e0_a ] )  @xcite .",
    "ideally one should find a change of variables which regularizes all the terms .",
    "however , it is not known whether it exists for the system under investigation , and we failed to regularize some terms ( specifically , @xmath57 ) in the evolution equations of the radiation fluid variables . on the other hand ,",
    "the resulting equations ( see below ) are still more suitable for numerical evolution than the original equations , and we checked that numerical errors remain under control ( as shown later with a few examples ) , so we will use them .",
    "a coordinate singularity at origin requires us to avoid evaluating singular terms in the equations , so , as we discuss below , we will stagger the grid one - half grid width away from the origin ( also mentioned in  @xcite ) .",
    "the change of variables is the following : = , h _ = h-2 ,",
    "h _ = h+ , = a+ .",
    "we refrain from assigning a new letter for the variable @xmath58 .",
    "the evolution equations ( with lapse @xmath27 ) in @xmath59 coordinates become : @xmath60 \\\\",
    "\\partial_\\tau h_{\\perp } & = -n \\bigg [ \\frac32 h_{\\perp}{}^2 - \\frac12\\left ( \\apey^2 - 2 \\frac{\\apey}{\\eyinv}\\right )                                          + \\frac16 \\mu + \\frac49 \\frac{\\mu}{g_+ } v^2 \\bigg ]",
    "\\\\           \\partial_\\tau \\apey & = -n \\left [ h_{\\perp } \\apey +   \\frac23 \\frac{\\mu}{g_+ } v \\right ] \\\\          \\partial_\\tau \\rho & = -n ( h_{\\| } + 2h_{\\perp})\\rho \\\\           \\partial_\\tau \\mu & = n \\bigg [ -\\frac43 \\frac{v}{g_+ } \\ex \\partial_r",
    "\\mu                                  -\\frac43 \\frac{g_-}{g_+^2 } \\mu \\ex \\partial_r v \\notag\\\\                                  & \\qquad -\\frac43 \\frac{\\mu}{g_+ } \\left ( g_+ ( h_{\\| } + 2h_{\\perp } ) - 2v\\apey                          + 2 \\frac{v}{\\eyinv } + \\frac23 v^2(h_{\\|}-h_{\\perp } ) \\right ) \\bigg ] \\\\          \\partial_\\tau v & = n \\bigg [ - \\frac{(1-v^2)^2}{4g_- } \\ex \\frac{\\partial_r \\mu}{\\mu }                                  - \\frac89 \\frac{v^3}{g_+ g_- } \\ex   \\partial_r v \\notag\\\\                          & \\qquad -\\frac{2(1-v^2)v}{3g_- } \\left ( h_{\\|}-h_{\\perp } + v\\apey - \\frac{v}{\\eyinv } \\right ) \\bigg].\\end{aligned}\\ ] ] the constraints are @xmath61       and  [ sec : evo ] . ]",
    "we specify the initial condition at early times ( before last scattering ) , and evolve the spacetime to the present day .",
    "this is the first stage of simulation . for the sake of simplicity , we focus on simulating models with homogeneous bang time ( the analysis of the impact of an inhomogeneous bang time is left for a future work ) .",
    "we thus need to specify initial condition at early times rather than at the present day in order to fulfill this requirement . in the second stage of the simulation , we evolve backward from present day to last scattering to obtain the redshift and luminosity distance from the centre .",
    "see fig .",
    "[ fig : spacetime ] .",
    "we now describe our specification of the initial condition . from the evolution and constraint",
    "equations above , we see that there are eight variables and three constraints .",
    "one way to specify the initial condition is to specify five of the variables and use the constraint to compute the other three .",
    "for example , one can specify the four  physical \" quantities @xmath62 set @xmath2 ( which is equivalent to a gauge choice ) , and then use the constraints to compute @xmath63 ,  @xmath58 , and @xmath29 .      in this section",
    "we describe the numerical evolution in the first and second stages ( see fig .",
    "[ fig : spacetime ] ) . in the first stage",
    "we compute the spacetime region we are interested in . for this",
    "we have the following boundary considerations :    inner boundary : :    we require the solution to be smooth .",
    "this implies that the variables    must be either odd or even functions of @xmath5 .",
    "specifically ,    @xmath63 , @xmath58 and @xmath29 are odd ,    while @xmath2 , @xmath64 ,    @xmath65 , @xmath28 and @xmath66 are    even .",
    "this takes care of the inner boundary condition at    @xmath67 . to avoid",
    "evaluating singular terms in the evolution    equations we stagger the grid from the origin ; i.e. we move the grid    one - half grid point from the origin .",
    "outer boundary : :    we can avoid specifying outer boundary conditions by transforming to    null coordinates , using the ` zooming ' technique in  @xcite . to    implement this",
    ", new reference coordinates @xmath68 are    used , with @xmath69 , and @xmath70 .",
    "the coordinate @xmath5 is given by the evolution equation _",
    "t r = _ t r _ + ( _ t r _ - _ t r _ ) , [ dtr ] where [ dtr_first ] _ t r _ = 0 , _",
    "t r _ = - n ( ) _ , and we choose @xmath71 initially . by the chain rule ,",
    "the change of coordinates from @xmath59 to @xmath68 changes the partial derivatives as follows : _",
    "= _ t - _ x , _ r = ( _ x r)^-1 _ x. the evolution equations ( with lapse @xmath72 ) in @xmath68 coordinates are then given by : @xmath73 +    \\frac{\\partial_t r}{\\partial_x r } \\partial_x h_{\\| } \\\\",
    "\\partial_t h_{\\perp } & = -n \\bigg [ \\frac32 h_{\\perp}{}^2 - \\frac12\\left ( \\apey^2 - 2 \\frac{\\apey}{\\eyinv}\\right )                      + \\frac16 \\mu + \\frac49 \\frac{\\mu}{g_+ } v^2 \\bigg ] +    \\frac{\\partial_t r}{\\partial_x r } \\partial_x h_{\\perp }   \\\\      \\partial_t \\apey & = -n \\left [ h_{\\perp } \\apey +   \\frac23 \\frac{\\mu}{g_+ } v \\right ]   +    \\frac{\\partial_t r}{\\partial_x r } \\partial_x \\apey \\\\",
    "\\partial_t \\rho & = -n ( h_{\\| } + 2h_{\\perp})\\rho +    \\frac{\\partial_t",
    "r}{\\partial_x r } \\partial_x \\rho \\\\",
    "\\partial_t \\mu & = n \\bigg [ -\\frac43 \\frac{v}{g_+ } \\frac{\\ex}{\\partial_x r } \\partial_x \\mu                  -\\frac43 \\frac{g_-}{g_+^2 } \\mu \\frac{\\ex}{\\partial_x r } \\partial_x v \\notag\\\\                  & \\qquad -\\frac43 \\frac{\\mu}{g_+ } \\left ( g_+ ( h_{\\| } + 2h_{\\perp } ) - 2v\\apey              + 2 \\frac{v}{\\eyinv } + \\frac23 v^2(h_{\\|}-h_{\\perp } ) \\right ) \\bigg ] +    \\frac{\\partial_t r}{\\partial_x r } \\partial_x \\mu \\\\",
    "\\partial_t v & = n \\bigg [ - \\frac{(1-v^2)^2}{4g_- } \\frac{\\ex}{\\partial_x r } \\frac{\\partial_x \\mu}{\\mu }                  - \\frac89 \\frac{v^3}{g_+ g_- } \\frac{\\ex}{\\partial_x r }   \\partial_x v \\notag\\\\              & \\qquad -\\frac{2(1-v^2)v}{3g_- } \\left ( h_{\\|}-h_{\\perp } + v\\apey - \\frac{v}{\\eyinv } \\right ) \\bigg ]               +   \\frac{\\partial_t r}{\\partial_x r }    \\partial_x v. \\label{numevo_end}\\end{aligned}\\ ] ] the constraints are @xmath74    in the second stage we compute the distance redshift relation for an observer located at @xmath75 and @xmath67 .",
    "this requires extrapolating ( with 4th order accuracy ) the final data from the first stage to @xmath67 , including the fractions @xmath76 and @xmath77 .",
    "on the past lightcone of the central observer , the coordinate @xmath5 is given by the evolution equation ( [ dtr ] ) , where [ dtr_second ] _ t r _ = - n ( ) _ , _ t r _",
    "= n ( ) _ .",
    "we also require one additional evolution equation for the redshift @xmath48 : [ dt_epsilon ] _ t ( 1+z ) = - n h _ , the angular - diameter distance @xmath54 is directly proportional to @xmath78 , so we simply set @xmath79 .",
    "we use the classical 4th order runge - kutta method to evolve the equations .",
    "we use the 4th order accurate central finite differencing to evaluate spatial derivatives on the interior grid points , while near the null boundary we use 4th order accurate skewed finite differencing .",
    "we use a uniform grid .",
    "constraints are monitored but are not used to correct the evolution other than that which was already used to modify the evolution equations .",
    "the cfl condition puts an upper bound on the time - step : |t| < , where = \\",
    "{ + | | } .",
    "note that @xmath80 is negative for backward evolution in the second stage .",
    "we now consider some example spacetimes and show the accuracy of the code .",
    "in particular , we focus on cosmological void models , which are spherically symmetric spacetimes with a large - scale under - density at the centre at recent epoch . they have been considered to explain the dimming of snia without introducing a dark - energy component ( see , e.g. , @xcite for a review , and references therein ) .     as a function of redshift , with @xmath81 being matter density @xmath28 , radiation density @xmath66 , hubble rate @xmath82 , and area distance @xmath83 .",
    "_ left : _ same of left panel for @xmath84 using different numbers of points for the @xmath5-grid .",
    "_ right : _ numerical output for the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) , which should be zero .",
    "they are shown for central and asymptotic regions . ]        as a function of redshift , with @xmath81 being matter density @xmath28 , radiation density @xmath66 , hubble rate @xmath82 , and area distance @xmath83 .",
    "_ left : _ same of left panel for @xmath84 using different numbers of points for the @xmath5-grid . _",
    "right : _ numerical output for the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) , which should be zero .",
    "they are shown for central and asymptotic regions . ]        as a function of redshift , with @xmath81 being matter density @xmath28 , radiation density @xmath66 , hubble rate @xmath82 , and area distance @xmath83 . _",
    "left : _ same of left panel for @xmath84 using different numbers of points for the @xmath5-grid .",
    "_ right : _ numerical output for the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) , which should be zero .",
    "they are shown for central and asymptotic regions . ]",
    "the specification of initial conditions in those models goes as follows . since inhomogeneities are larger than a few hundreds of mpc in size ( in comoving units ) , while the sound horizon , setting the largest scale seen in the pre - decoupling part , is around 150 mpc , the evolution up to a time @xmath85 ( pre - decoupling ) is described by a different flrw model along each worldline .",
    "indeed , as long as the gradient of inhomogeneities is small in any causally connected patch of the universe , the evolution of horizon - size regions can be described by the mean of the flrw equations .    at @xmath85",
    ", we set the shear @xmath86 to zero , and specify @xmath87 and @xmath88 .",
    "for example , one can choose gaussian profiles : _",
    "m(t_,r ) = ( _ m)_(t _ ) + [ ( _ m)_(t _ ) - ( _ m)_(t _ ) ] e^-r^2/w_m^2 [ profile ] and similarly for @xmath89 , where the label  in \" is used for the worldline at the origin , while  out \" stands for spatial infinity ( with @xmath5 being the radial coordinate and @xmath90 being the width of the inhomogeneity ) . in this case ,",
    "initial conditions reduce to specifying 6 parameters at early times : @xmath91 . however , we tested the code with other more complicated profiles ( see below ) .",
    "we compute @xmath92 at @xmath85 by integrating between @xmath93 and @xmath94 with flrw evolution along each worldline and ( an important condition ) setting the bang time to zero .",
    "we fix the gauge taking @xmath2 to be constant .",
    "the other functions are then derived by solving the constraint equations .      in fig .",
    "[ fig : flrw ] we test the accuracy of the code in the limit where both matter and radiation are homogeneous . in this case , we can make use of the standard analytic solution of einstein equations ( setting the cosmological constant @xmath95 ) to compute relevant quantities and compare to the code output . in fig .",
    "[ fig : flrw]a , @xmath28 , @xmath66 , @xmath82 , and @xmath54 are computed along the lightcone of the central observer .",
    "the agreement is at a level below @xmath96 up to @xmath97 ( and a significant part of the errors is due to the redshift interpolation rather than inaccuracy of the solution ) . in this example",
    "we choose the today parameters to be @xmath98 , @xmath99 with the radiation set by @xmath100 k and the effective number of relativistic degrees of freedom given by @xmath101 .",
    "as mentioned above , the solution is 4th order accurate .",
    "we explicitly show this in fig .",
    "[ fig : flrw]b by plotting @xmath84 obtained considering different numbers of @xmath5-grid points .",
    "the scaling of the inaccuracy has to be constant in time for a stable solution and given by @xmath102 , where @xmath103 is the number of points in the @xmath5-grid and @xmath19 is the order of the accuracy .",
    "it is clear that @xmath104 with a fairly constant ratio between the different curves . with a few thousand points",
    "we reach the current noise level of the code ( see blue curve ) .",
    "the constraint equations ( [ numcon_start])([numcon_end ] ) are satisfied at a level better than @xmath105 at all times , see fig .",
    "[ fig : flrw]c . we show them along the central worldline ( which is the one typically having largest errors due to spurious effects related to the boundary conditions ) and along a worldline far from the centre in an  asymptotic \" region ( where the errors are typically the smallest ) .      ) ([numcon_end ] ) computed along the central worldline .",
    "the scaling of the gauss constraint with the number of points in the r - grid is shown ( similar results can be obtained for the other two constraints ) .",
    "_ central : _ shear @xmath86 and peculiar velocity @xmath29 as a function of redshift for the flrw and the inhomogeneous ( including radiation ) models quoted in the text .",
    "_ right : _ comparison between full ( including radiation ) and pure dust ( ltb ) solutions . for the latter ,",
    "we show also the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) which are explicitly violated , although at a level much lower than the actual differences between the two solutions . ]       ) ([numcon_end ] ) computed along the central worldline .",
    "the scaling of the gauss constraint with the number of points in the r - grid is shown ( similar results can be obtained for the other two constraints ) .",
    "_ central : _ shear @xmath86 and peculiar velocity @xmath29 as a function of redshift for the flrw and the inhomogeneous ( including radiation ) models quoted in the text .",
    "_ right : _ comparison between full ( including radiation ) and pure dust ( ltb ) solutions . for the latter ,",
    "we show also the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) which are explicitly violated , although at a level much lower than the actual differences between the two solutions . ]       ) ([numcon_end ] ) computed along the central worldline .",
    "the scaling of the gauss constraint with the number of points in the r - grid is shown ( similar results can be obtained for the other two constraints ) .",
    "_ central : _ shear @xmath86 and peculiar velocity @xmath29 as a function of redshift for the flrw and the inhomogeneous ( including radiation ) models quoted in the text .",
    "_ right : _ comparison between full ( including radiation ) and pure dust ( ltb ) solutions . for the latter ,",
    "we show also the constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) which are explicitly violated , although at a level much lower than the actual differences between the two solutions . ]",
    "now we want to repeat the accuracy analysis in an inhomogeneous scenario , and see how the full solution with two fluids compares to pure - dust ltb models normally adopted in the literature . for the sake of concreteness",
    "we choose a model ( other examples give similar results ) which leads to parameters on the today surface being @xmath106 , @xmath107 , @xmath108 , @xmath109 k , and @xmath110 k. the inhomogeneity profile is modelled through a gaussian with a width corresponding to @xmath111 .",
    "the constraint equations ( [ numcon_start])([numcon_end ] ) are satisfied at a level better than @xmath112 , as shown for the central worldline in fig .  [",
    "fig : comparison]a .",
    "the accuracy is clearly lower than in the homogeneous case , but the scaling is again constant and not far from 4th order ( see ratio between solid lines ) .",
    "physical quantities which become non - zero in the inhomogeneous scenario are the shear @xmath86 and the peculiar velocity @xmath29 .",
    "they indeed get large values in this model , peaking at redshift corresponding to the size of the inhomogeneity . in the homogeneous scenario ,",
    "on the other hand , the shear has to be zero and radiation is comoving with matter ( i.e. , @xmath113 ) .",
    "see fig .",
    "[ fig : comparison]b .",
    "the numerical error on @xmath86 and @xmath29 never becomes relevant , although the growing of @xmath86 suggests that some improvements in the computation of @xmath48-scalings can be made ( indeed the right part of the plot is where we set initial conditions , thus the inaccuracy should be the smallest ) .    in fig .",
    "[ fig : comparison]c we compare such two - fluid solution to a pure dust solution . as we mentioned above , in order to make equations more tractable , we specify initial conditions such that @xmath2 was set to a constant .",
    "it implies we are using hyperspherical coordinates . on the other hand",
    "this makes it inconvenient to compare with ltb models , whose common choice of reduced - circumference polar coordinates means @xmath2 depends on @xmath5 ( e.g. , @xmath114 for flrw ) .",
    "therefore , it is not straightforward to simplify this model to an ltb model .",
    "moreover , simply setting @xmath66 and @xmath29 to zero would violate the codazzi constraint . in order to satisfy the codazzi constraint",
    ", we should set @xmath82 to constant , which means we have no control over the bang time .",
    "we proceed with specifying for the pure dust case .",
    "we use the same input as for the two - fluid model except for replacing @xmath115 in the initial condition at @xmath116 and setting @xmath117 in all equations . in this way we explicitly violate constraints in eqs .",
    "( [ numcon_start])([numcon_end ] ) .",
    "however , this violation is much smaller than the actual differences between the two solutions as shown .",
    "we plot @xmath118 as a function of redshift , with @xmath81 being matter density @xmath28 , hubble rate @xmath82 , and area distance @xmath54 .",
    "the ltb solution is a good approximation up to @xmath119 , while at @xmath120 we find @xmath121 .",
    "this is larger than the radiation contribution to the energy density at such redshift ( which is about 3% ) .",
    "those results are similar to what found in fig .",
    "12 of @xcite , telling us that the computation of the full solution by matching an ltb spacetime to an flrw spacetime at @xmath122 ( as often done in the literature ) might not be accurate enough to be exploited for cmb computations ( this topic will be discussed in a forthcoming paper ) .      in figs .",
    "[ fig : inhomrad ] and [ fig : modelsvsz ] we explore the evolution of the matter density , hubble rate , and angular diameter distance for a few examples of the full solution .",
    "we set the radiation and matter spatial profiles at initial time @xmath123 s. the simplest case is a gaussian as in eq .",
    "( [ profile ] ) .",
    "we consider two models having a few gpc width and provide identical parameters at @xmath116 ( listed in section  [ sec : ltb ] ) , the first with homogeneous radiation at early times ( red ) , i.e. with @xmath124 , and the second with @xmath125 ( blue ) .",
    "the first case sketches the class of models often considered in the literature to fit snia data without dark - energy , while a void model with early - times inhomogeneity in the radiation profile can potentially fit also bbn  @xcite and cmb  @xcite data .",
    "it s interesting to note in fig .",
    "[ fig : inhomrad]b how in the first case ( adiabatic scenario ) the matter density contrast @xmath126 is highly homogeneous at early times , while in the second case the picture starts inhomogeneous ( isocurvature scenario ) .",
    "they are set to give the same physical picture today and have the same redshift evolution for the matter profile , but the @xmath82 and @xmath54 at early times can be slightly different ( see fig .",
    "[ fig : modelsvsz ] ) because of the radiation inhomogeneity .",
    "alongside , we consider a case where the width is one order of magnitude smaller ( i.e. about 300 mpc ) and a sinusoidal function with periodic over / under - densities @xmath127\\,\\cos(r / w)^2 $ ] with @xmath128 .",
    "note that in the latter case , since obviously the matter density parameter @xmath129 tends to 1 in the matter dominated epoch , the oscillations look damped as a function of @xmath48 .",
    "inhomogeneity ( blue ) , at early times . ]        inhomogeneity ( blue ) , at early times . ]    .",
    "_ right : _ same as in the left panel , but for the angular diameter distance .",
    "note the difference in the comoving distance of @xmath130gpc at @xmath131 brought on by changing the radiation profile in the initial conditions . ]       .",
    "_ right : _ same as in the left panel , but for the angular diameter distance .",
    "note the difference in the comoving distance of @xmath130gpc at @xmath131 brought on by changing the radiation profile in the initial conditions . ]",
    "we have developed a numerical scheme for simulating spherically symmetric spacetimes with a comoving dust and a tilted radiation fluid .",
    "this scheme avoids boundary conditions by using a new zooming technique improved from that of  @xcite with null boundaries .",
    "the numerical evolution equations are given by ( [ numevo_start])([numevo_end ] ) and ( [ dtr ] ) . equation ( [ dtr_first ] ) is used for the first stage , and ( [ dtr_second ] ) for the second .",
    "the second stage contains one additional evolution equation ( [ dt_epsilon ] ) for the redshift .",
    "using fourth - order runge - kutta method and fourth - order finite differencing to evaluate spatial derivatives , the scheme is fourth - order convergent .",
    "stability of the scheme is not proven , but numerical errors can be monitored by plotting the constraints ( [ numcon_start])([numcon_end ] ) . some examples were given to demonstrate the numerical scheme , from which we have confirmed stability .",
    "we then considered models with radiation and compared them to the pure dust ltb case , which demonstrates the importance of including radiation for the evaluation of the area distance at large redshift .",
    "we then showed how radiation inhomogeneity can also affect the model , and quantities such as the area distance at large redshift .",
    "the key limitation of the model is that we have approximated the radiation as a perfect fluid , effectively truncating the boltzmann hierarchy at the monopole term .",
    "when the shear is significant this induces corrections to the radiation density @xmath132 ( see , e.g. eqs .",
    "( 86 ) and ( 89 ) in  @xcite ) .",
    "the effects associated with this are interesting to investigate in their own right , and are also important for accurately modelling a spherical object with matter and radiation .",
    "further work is also needed to treat the baryons accurately by adding in the coupling to the photons through compton scattering . in a future development",
    ", we will examine these effects on the constraints on void models , and in particular the combined bounds from the cmb+@xmath1 which significantly constrain pure dust models .",
    "we would like to thank a. nagar , s. perez bergliaffa and f. teppa pannia for useful discussions .",
    "mr acknowledges the research grant funded by the istituto nazionale di fisica nucleare within the _ astroparticle physics project _",
    "( infn grant code : fa51 ) .",
    "bolejko , k. , krasiski , a. , hellaby , c. , & clrier , m .-",
    "n . , structures in the universe by exact methods : formation , evolution , interactions .   cambridge monographs on mathematical physics , cambridge university press ( 2009 )"
  ],
  "abstract_text": [
    "<S> we present new numerical cosmological solutions of the einstein field equations . </S>",
    "<S> the spacetime is spherically symmetric with a source of dust and radiation approximated as a perfect fluid . </S>",
    "<S> the dust and radiation are necessarily non - comoving due to the inhomogeneity of the spacetime . such a model can be used to investigate non - linear general relativistic effects present during decoupling or big - bang nucleosynthesis , as well as for investigating void models of dark energy with isocurvature degrees of freedom . </S>",
    "<S> we describe the full evolution of the spacetime as well as the redshift and luminosity distance for a central observer . after demonstrating accuracy of the code </S>",
    "<S> , we consider a few example models , and demonstrate the sensitivity of the late time model to the degree of inhomogeneity of the initial radiation contrast . </S>"
  ]
}