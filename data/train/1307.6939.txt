{
  "article_text": [
    "the problem of computing a large similar common subset of two point sets arises in many areas of computer science , from computer vision and pattern recognition to bio - informatics  @xcite .",
    "most of the recent related work concerns the design of efficient algorithms to compute rigid transformations for establishing correspondences between two point sets in @xmath1 subject to minimization of a distance measure .",
    "comparatively little attention has been devoted to extremal matching problems related to random point sets , such as the following problem : _ presented with two random point sets , how do we expect matching weight to vary with data set size ? _    the seminal work in extremal random matching is , arguably , the 1984 paper of ajtai , komls and tusndy  @xcite , whose deep result found many applications in the following years .",
    "for two infinite point sets @xmath2 and @xmath3 chosen independently and uniformly at random from @xmath4 ^ 2 $ ] , they derived asymptotic bounds on the sequence @xmath5 , where @xmath6 is the optimal matching weight between @xmath7 and @xmath8 .",
    "a short time later , leighton and shor  @xcite addressed the related problem of determining the expectation of the _ maximum _ cost of any edge in the matching ( instead of the sum ) .",
    "shor  @xcite subsequently applied the akt result to obtain bounds on the average - case analysis of several algorithms .",
    "talagrand  @xcite introduced the notion of majorizing measures and , as an illustration of this powerful technique , derived the theorem of ajtai et al .",
    "rhee and talagrand  @xcite explored the two - dimensional _ upward matching _ problem , in which points from @xmath2 must be matched to points of @xmath3 that have greater @xmath9- and @xmath10-coordinates .",
    "they have also explored a similar problem in the cube  @xcite . in  @xcite",
    "talagrand gave insight into the exact behavior of expected matching weight for dimensions @xmath11 under arbitrary norms .",
    "our main goal in this paper is to continue the investigations started in @xcite and @xcite into the probability theory of some classical combinatorial optimization problems on hierarchically separated trees ( hsts ) .",
    "the notion of the hierarchically ( well-)separated tree was introduced by bartal  @xcite .",
    "a @xmath12-hst is a rooted weighted tree with two additional properties : ( 1 ) edge weights between nodes and their children are the same for any given parent node , and ( 2 ) the ratio of incident edge weights along a root - leaf path is @xmath12 ( so edges become lighter by a factor of @xmath12 as one approaches leaves ) . in what follows , we only consider hsts that are balanced ( those for which the branching factor of all nodes other than the leaves is the same , denoted by @xmath13 ) and uniform ( having every leaf at the same depth @xmath14 ) .",
    "we also require @xmath15 .",
    "for the sake of brevity , we describe an hst with these parameters as a @xmath16-hst .",
    "bartal showed @xcite that arbitrary metric spaces on @xmath0 points can be @xmath17-probabilistically approximated by a collection of hsts ; the factor of the approximation ( here @xmath18 ) indicates the maximum factor by which a randomly chosen tree from the collection will overestimate , in expectation , the distance between any pair of points .",
    "fakcharoenphol , rao and talwar  @xcite improved bartal s result to apply to @xmath19-probabilistically approximated by a collection of hsts .",
    "this implies that our bounds for hsts translate to other metric spaces .",
    "general hsts are well suited to approximating arbitrary euclidean metric spaces . in this paper",
    "we consider only balanced uniform hsts , but even these are useful in approximating `` well - behaved '' spaces . to start ,",
    "let us consider a set @xmath20 of @xmath0 equally spaced points on the interval @xmath21 $ ] . for simplicity ,",
    "let us assume the points are placed at the midpoints of the subintervals @xmath22 , [ 1/n,2/n ] , \\ldots , [ ( n-1)/n , 1]$ ] . for @xmath0 a power of two",
    ", we can draw a full binary tree of height @xmath23 whose leaves are collocated with @xmath20 .",
    "figure [ fig : firsthst ] shows the tree for @xmath24 .",
    "the edge weight ratio is set to @xmath25 , and the edges incident on the root are given weights of @xmath26 ; the tree then has a diameter of @xmath27 .",
    "( root ) at ( 0 , 0 ) [ circle , fill ] ;    \\(11 ) at ( -0.8 , -0.5 ) [ circle , fill ] ; ( 12 ) at ( 0.8 , -0.5 ) [ circle , fill ] ;    \\(21 ) at ( -1.2 , -1 ) [ circle , fill ] ; ( 22 ) at ( -0.4 , -1 ) [ circle , fill ] ; ( 23 ) at ( 0.4 , -1 ) [ circle , fill ] ; ( 24 ) at ( 1.2 , -1 ) [ circle , fill ] ;    \\(31 ) at ( -1.4 , -1.5 ) [ circle , draw ] ; ( 32 ) at ( -1.0 , -1.5 ) [ circle , draw ] ; ( 33 ) at ( -0.6 , -1.5 ) [ circle , draw ] ; ( 34 ) at ( -0.2 , -1.5 ) [ circle , draw ] ; ( 35 ) at ( 0.2 , -1.5 ) [ circle , draw ] ; ( 36 ) at ( 0.6 , -1.5 ) [ circle , draw ] ; ( 37 ) at ( 1.0 , -1.5 ) [ circle , draw ] ; ( 38 ) at ( 1.4 , -1.5 ) [ circle , draw ] ;    at ( -1.4 , -1.7 ) @xmath28 ; at ( -1.0 , -1.7 ) @xmath29 ; at ( -0.6 , -1.7 ) @xmath30 ; at ( -0.2 , -1.7 ) @xmath31 ; at ( 0.2 , -1.7 ) @xmath32 ; at ( 0.6 , -1.7 ) @xmath33 ; at ( 1.0 , -1.7 ) @xmath34 ; at ( 1.4 , -1.7 ) @xmath35 ;    at ( -0.7 , -0.15 ) 1/4 ; at ( -1.3 , -0.65 ) 1/8 ; at ( -1.6 , -1.15 ) 1/16 ;    ( root )  ( 11 ) ; ( root )  ( 12 ) ;    \\(11 )  ( 21 ) ; ( 11 )  ( 22 ) ; ( 12 )  ( 23 ) ; ( 12 ) ",
    "( 24 ) ;    \\(21 )  ( 31 ) ; ( 21 ) ",
    "( 32 ) ; ( 22 ) ",
    "( 33 ) ; ( 22 )  ( 34 ) ; ( 23 )  ( 35 ) ; ( 23 )  ( 36 ) ; ( 24 )  ( 37 ) ; ( 24 )  ( 38 ) ;    this tree defines a metric on the leaves of @xmath20 : the distance between two leaves is the length of the path connecting them .",
    "it is clear that the distance between the two leaves @xmath36 and @xmath37 in the tree is greater than or equal to the euclidean distance between the points @xmath36 and @xmath37 ; thus it is said that the tree metric _ dominates _ the euclidean metric on these points . while the tree metric is close to the euclidean distance for many point pairs ( consider the two extreme points ) , other point pairs",
    "are assigned an exaggerated distance .",
    "consider the two middle points : their euclidean distance is @xmath38 , but their distance in the tree is nearly @xmath39 .",
    "we obtain results with a more complex technique .",
    "let us embed @xmath20 into the interval @xmath40 $ ] equipped with a torus distance metric : the distance between two points @xmath9 and @xmath10 is defined as @xmath41",
    ". thus the interval wraps around  the points 0 and 2 are coincident  but for two points inside @xmath21 $ ] , the torus metric agrees with the euclidean metric .",
    "define @xmath42 .",
    "we can repeat our construction from above : choose one of the points to be the `` first '' leaf , and build a binary tree whose leaves are collocated with @xmath43 . in this way we obtain a set of @xmath0 trees",
    "; one such tree is shown in figure [ fig : secondhst ] .",
    "now , for a fixed pair of points @xmath36 and @xmath37 from @xmath20 , some trees will greatly overestimate the distance between @xmath36 and @xmath37 , but most of the trees will give a fairly close value to the euclidean distance . choosing a tree at random will provide an approximation that is accurate with high probability ; one can show that the expected distance in the tree is no more than @xmath44 times the actual euclidean distance . a tight bound on tree distances , therefore , translates into a bound on the euclidean distances that is tight to within a factor of @xmath23 .",
    "our construction easily generalizes to higher dimensions",
    ". given @xmath0 points equally spaced in @xmath21^d$ ] , we can embed them into a set of @xmath45 points in @xmath40^d$ ] equipped with a torus metric .",
    "the resulting tree will now have a branching factor of @xmath46 .",
    "furthermore , the restriction to equispaced points is , for many applications , not essential : points on @xmath4^d$ ] can be discretized to an equispaced grid of points .",
    "the most convenient such grid is the one formed by cutting the hypercube into @xmath0 parts along every dimension , forming @xmath47 smaller hypercubes , and taking the midpoint of each cube .",
    "this setup introduces some error , which depends on the coarseness of the discretization ; the optimal error is often negligible when compared to the cost of the problem . for more on the application of hsts to problems on metric spaces ,",
    "we refer the reader to the papers by bartal @xcite and fakcharoenphol et al .",
    "the method of successive grid approximations and its utility are examined in greater depth in indyk and thaper s paper @xcite on applying the earth - mover distance to fast image retrieval .",
    "clearly , every hst determines a metric space on its leaves . in the present paper",
    "we study some combinatorial optimization problems on metric spaces of balanced hsts .",
    "we extend the results of abrahamson  @xcite and abrahamson et al .",
    "@xcite , which considered the bichromatic random matching problem on hsts .",
    "they showed    [ bichromatic_matching][1 , 2 ] let @xmath48 be a balanced hst ; let @xmath49 and @xmath50 be two randomly chosen @xmath0-element submultisets of the set of leaves of @xmath51 ; and define @xmath52 then there exist positive constants @xmath53 and @xmath54 such that @xmath55    we will presently add to these results the cases of ( 1 ) monochromatic matching on hsts , ( 2 ) monochromatic and bichromatic tsp , and ( 3 ) monochromatic and bichromatic msts . in all these problems we look at an edge - weighted graph @xmath56 that is induced by the randomly chosen leaves of the hst .",
    "the edge weight of two points will be their distance in the tree .",
    "we will estimate the expected total weight of some subgraphs of @xmath57    the remainder of this paper is laid out as follows .",
    "section [ defs ] contains the formal definitions of the problems we consider .",
    "section [ monomatching ] gives the bound on monochromatic matching .",
    "we consider the monochromatic tsp and mst problem in section [ mono_tsp ] ; the bichromatic mst problem in section [ bi_mst ] ; and the bichromatic tsp in section [ bi_tsp ] . in section  [ concentration ]",
    "we demonstrate the very tight concentration of the cost of our monochromatic optimization problems around their mean . in section [ conclusion ]",
    "we offer our conclusions and ideas for future work .",
    "given an hst @xmath58 and a submultiset @xmath59 of its leaves , we let @xmath56 be the complete graph with vertex set @xmath60 here @xmath61 contains the elements of @xmath62 and if there are multiple copies of a leaf in @xmath62 we distinguish them in @xmath61 by indexing the different copies . for every @xmath63",
    "the weight of the path from @xmath64 to @xmath65 is denoted by @xmath66 note that we will have distinct vertices of @xmath56 that are at a distance zero from each other , when these are copies of the same leaf of @xmath67    first we define the monochromatic versions of the problems we will consider .",
    "( our definitions follow yukich @xcite . )    * minimum matching problem ( @xmath68 ) : * the minimum matching on @xmath61 has cost given by @xmath69 where @xmath70 denotes the weight of the edge @xmath71 and the minimum is taken over all possible perfect matchings of @xmath57 if @xmath0 is odd , one of the vertices is excluded from the matching , and so the minimum matching on @xmath61 is the minimum of the minimum matchings on the @xmath0 subsets @xmath72 .    * traveling salesman problem ( @xmath73 ) : * a closed tour or hamiltonian cycle is a simple cycle that visits each vertex of @xmath61 exactly once .",
    "we denote by @xmath74 the length of the shortest closed tour @xmath51 on @xmath61 .",
    "thus @xmath75 where the minimum is taken over all tours @xmath51 .",
    "* minimum spanning tree problem ( @xmath76 ) : * let @xmath77 be the cost of the shortest spanning tree on @xmath61 , namely @xmath78 where the minimum is taken over all spanning trees @xmath79 .    in the bichromatic versions of the above problems we first choose two submultisets of the leaves of @xmath58 ;",
    "let us call these @xmath80 and @xmath81 then @xmath56 will be the complete bipartite graph with two @xmath0-element color classes @xmath49 and @xmath82 where , as before , @xmath49 will contain every element of @xmath83 @xmath50 will contain every element of @xmath84 and , if necessary , we index the multiple copies of the leaves .",
    "the edge weights again are determined by the distance of the endpoints in @xmath67    the bichromatic versions of the above problems are defined very similarly to the monochromatic cases . since @xmath56 is bipartite , every edge that will be included in the solution of any of the optimization problems above will be a red - blue edge : the set of matchings @xmath85 , the set of tours @xmath51 , and the set of spanning trees @xmath79 are now restricted to those subgraphs in which each edge is bichromatic . for completeness",
    "we list these problems below .",
    "* bichromatic minimum matching problem ( @xmath86 ) : * the minimum matching on @xmath61 has cost given by @xmath87 where @xmath70 denotes the weight of the edge @xmath71 and the minimum is taken over all possible perfect bichromatic matchings of @xmath57 if @xmath0 is odd , one of the vertices is excluded from the matching , and so the minimum matching on @xmath61 is the minimum of the minimum bichromatic matchings on the @xmath0 subsets @xmath72 .    * bichromatic traveling salesman problem ( @xmath88 ) : * a bichromatic tour or is a simple cycle that visits each vertex of @xmath61 exactly once and alternates colors along each edge .",
    "the minimum tour length is given by @xmath89 where the minimum is taken over all bichromatic tours @xmath51 .",
    "* bichromatic minimum spanning tree problem ( @xmath90 ) : * the minimum bichromatic spanning tree cost is given by @xmath91 where the minimum is taken over all bichromatic spanning trees @xmath79 .",
    "let @xmath58 be an hst and @xmath92 be a set of points assigned to the leaves of @xmath58 . for each vertex @xmath93",
    ", we define @xmath94 to be the number of points assigned to the descendants of @xmath64 in @xmath58 .",
    "we consider a node to be a descendant of itself , so that when @xmath64 is a leaf , @xmath94 is simply the number of points assigned to @xmath64 .    for a non - leaf vertex @xmath64 with children",
    "@xmath95 , we have @xmath96    for a pair of matched points @xmath97 in @xmath98 , belonging to distinct leaves @xmath99 and @xmath100 in @xmath58 , we will say the pair @xmath97 results in a _ transit _ at vertex @xmath64 when @xmath64 is the lowest common ancestor of @xmath99 and @xmath100 , that is , the path between @xmath99 and @xmath100 passes through @xmath64 .",
    "we will also use @xmath101 to denote the total number of transits at vertex @xmath64 in an optimal matching .",
    "given an integer @xmath102 we define @xmath103 to be the parity of @xmath102 , i.e. 1 when @xmath102 is odd and 0 when @xmath102 is even .",
    "[ transit ] let @xmath58 be an hst , and let @xmath92 be a submultiset of the leaves of @xmath67 the number of transits at any non - leaf vertex @xmath64 in a minimum matching @xmath98 is @xmath104 where @xmath105 are the children of @xmath64 .",
    "* proof : * first consider a vertex @xmath64 at height 1 and its children @xmath95 . for each @xmath106 ,",
    "only @xmath107 instances need to look for a match elsewhere in the tree , since an even number of the instances can be paired off in the leaf .",
    "the number of remaining unmatched points will therefore be @xmath108 .",
    "these points can now be paired off at @xmath64 ; if this quantity is odd , there will be one point left over .",
    "the number of pairs that transit through @xmath64 is thus @xmath109    we will now modify the hst in the following way .",
    "each point resident at a leaf of the tree will be transferred to its parent , and the leaves will be removed .",
    "thus each vertex @xmath64 that was formerly at depth 1 will become a leaf , and every remaining vertex will retain its previous @xmath2-value .",
    "it is clear that the number of transits at every vertex @xmath65 in this new tree remains the same , since any unmatched point at @xmath106 would have had to search above @xmath64 in any case , and these points will transit at the same vertex as they would have before .",
    "successive applications of the argument in the preceding paragraph will reduce the tree to a single node , showing that @xmath110 for every vertex @xmath64 in the original tree .",
    "the above argument also shows that @xmath111 : the number of transits at @xmath64 is upper - bounded by the number of children of @xmath64 , regardless of the number of descendants @xmath64 has in the hst .    [ lemma : half_stronger ] let @xmath64 be a non - root vertex in level @xmath112 of an hst @xmath58 .",
    "then @xmath113 \\leq \\frac 12,\\ ] ] so that @xmath114 \\leq \\frac12 $ ] .",
    "if @xmath0 , the number of points chosen , is at least @xmath115 , then @xmath113 \\geq \\frac 14,\\ ] ] so that @xmath114 \\geq \\frac 14 $ ] .",
    "* proof : * denote the total number of leaves of @xmath58 by @xmath116 observe , that the number of leaves of @xmath58 that are descendant of @xmath64 is exactly @xmath117 set @xmath118 .",
    "let us start with an empty multiset of points and add points one by one . some of these points will belong to leaves that are descendants of @xmath64 , while others will not . for @xmath119 ,",
    "define @xmath120 to be the number of the first @xmath121 points that belong to descendants of @xmath64 , and let @xmath122 .",
    "the variables @xmath123 form a markov process where each transition changes state with probability @xmath124 and remains at the current state with probability @xmath125 ; this gives us the transition matrix @xmath126}$ ] .",
    "the initial state of the process is @xmath127 $ ] .",
    "we can diagonalize @xmath128 as @xmath129 , where @xmath130}$ ] and @xmath131}$ ] .",
    "after @xmath0 points have been chosen , the state of the system will be @xmath132 + @xmath133,$ ] and @xmath134 = \\frac12 - \\frac12 ( 1 - 2r)^n$ ] .",
    "set @xmath135 .",
    "notice that @xmath136 can not be negative , since @xmath137 and @xmath138 .",
    "this shows the first statement of the lemma . for the lower bound",
    ", we wish to show @xmath139 .",
    "when @xmath140 , the worst case is clearly for @xmath141 and @xmath142 , which gives us @xmath143 and the second statement is proved .",
    "( the proof actually gives a tighter lower bound of @xmath144 , but @xmath26 is good enough for our purposes . )",
    "we now have    [ corr : expectation ] let @xmath145 be a balanced hst , and let @xmath64 be one of its non - leaf vertices in level @xmath146 . then @xmath147 \\leq \\frac 14 ( b-1),\\ ] ] and if @xmath148 , @xmath147 \\geq \\frac 18 ( b-1).\\ ] ]    * proof : * take the expectation of @xmath101 as given by lemma  [ transit ] .",
    "the values of @xmath114 $ ] and @xmath149 $ ] are bounded by lemma  [ lemma : half_stronger ] .",
    "[ thm : sum ] let @xmath145 be a balanced hst , and let @xmath92 be a randomly chosen @xmath0-element submultiset of its leaves .",
    "the value of @xmath150 $ ] , the expected weight of the optimal matching of @xmath92 , obeys @xmath151 \\leq b_{b , \\l } \\sum_{k=1}^{\\d } ( b\\lambda)^k\\ ] ] for some positive constant @xmath152 depending only on @xmath13 and @xmath12 .",
    "if @xmath153 , then @xmath151 \\geq a_{b , \\l } \\sum_{k=1}^{\\d } ( b\\lambda)^k\\ ] ] for some positive constant @xmath154 depending only on @xmath13 and @xmath12 .",
    "* proof : * consider the contribution of level @xmath155 ( where @xmath156 ) to the value of @xmath98 .",
    "level @xmath155 contains @xmath157 vertices , and the expected number of transits at each of these vertices is between @xmath158 and @xmath159 , by corollary  [ corr : expectation ] .",
    "the weight of a match at level @xmath155 is @xmath160 ; this is bounded from below by @xmath161 and from above by @xmath162 .",
    "the total contribution of levels @xmath163 can therefore be bounded from above by @xmath164 and bounded from below , when @xmath153 , by @xmath165 choose @xmath166 and @xmath167 .",
    "we have not counted the contribution of the root , but it is negligible , at most the constant @xmath168    let us perform a walk on the tree , starting at the root , and visiting each leaf in order from left to right .",
    "this walk will use each edge twice . at level @xmath112",
    "there are @xmath169 edges , and their cost is @xmath170 . therefore the total cost will be @xmath171 note the similarity to the bounds in theorem  [ thm : sum ] . the lower bound in theorem  [ thm : sum ] shows that the upper bound is , in fact , tight .",
    "now we have    [ log ] let @xmath145 be a balanced hst , let @xmath92 be a randomly chosen @xmath0-element submultiset of its leaves , and let @xmath172",
    ". then @xmath151 \\leq c_{b , \\l } \\sum_{k=1}^{h } ( b\\lambda)^k\\ ] ] for some positive constant @xmath173 depending only on @xmath13 and @xmath12 .",
    "note that the upper index of the summation has changed from @xmath14 to @xmath174 .",
    "* proof : * if @xmath175 then there is nothing to prove .",
    "hence , we may assume that @xmath176 and consider the case @xmath177 for @xmath0 a power of @xmath13 .",
    "each node at depth @xmath174 will have an average of one element of @xmath92 in its subtree .",
    "the worst case occurs when each node at depth @xmath174 has _",
    "exactly _ one element : otherwise , elements can be paired off in the subtrees without looking above level @xmath174 . thus the situation is the same as locating points at level @xmath174 instead of at level @xmath14 . more generally , when @xmath0 is not a power of @xmath13 , the average number of elements of @xmath92 in each subtree will still be @xmath178 , giving us the same result ( with a different constant ) .",
    "the bound then comes from applying theorem  [ thm : sum ] to a tree of height @xmath174 .",
    "relaxing the index of the second summation in theorem  [ thm : sum ] from @xmath14 to @xmath174 , we conclude    [ thm : mono_matching ] let @xmath145 be a balanced hst , let @xmath92 be a randomly chosen @xmath0-element submultiset of its leaves , and let @xmath172 . then @xmath179 \\leq b'_{b , \\l } \\sum_{k=1}^{h } ( b\\lambda)^k\\ ] ] for some positive constants @xmath180 depending only on @xmath13 and @xmath12 .    thus given an hst with branching factor @xmath13 and weight ratio @xmath181 , we can classify the expected matching cost for large @xmath0 based on the value of @xmath182 :    * if @xmath183 , the expected cost is bounded by a constant . * if @xmath184 , the expected cost is @xmath185 . *",
    "if @xmath186 , the expected cost is @xmath187 . when @xmath177 , this is equivalent to @xmath188 .",
    "in the proof , we saw that the level @xmath189 ) of the tree turned out to be crucial to the tight bound on the matching cost ; most of the cost came from the tree edges above this level , while the edges below had a negligible effect .",
    "this phenomenon will also emerge with the problems we consider later .",
    "we will employ a more general technique , which we call _ lifting _ , to achieve similar results .",
    "let us first consider the tsp .",
    "we construct the tour as follows : we build a tree @xmath190 that contains each edge @xmath191 , where @xmath36 is the parent vertex of @xmath192 , if and only if some descendant of @xmath192 is identified with a point of @xmath92 .",
    "the tour @xmath193 is formed by visiting the leaves of @xmath190 in order ; it is clear that the weight of @xmath193 is exactly twice the weight of @xmath190 , since each edge of @xmath190 will be traversed exactly twice to form the tour @xmath193 .",
    "it is fairly evident that an optimal tour on @xmath92 and the root of the hst can be formed in this way .",
    "suppose we have a tour that does not have this form ; then there are two leaves @xmath194 and @xmath64 that are out of order in the tour . switching the positions of @xmath194 and @xmath64 in the tour",
    "can only decrease the total cost .    observe that even though the root is not always needed to create a tour on @xmath92 , it will be needed with high probability .",
    "more precisely , the probability that it will _ not _ be needed is the same as the probability that all @xmath0 chosen leaves of @xmath51 have the same ancestor at level 1 of the tree ; this probability is @xmath195 , which is at most @xmath25 for @xmath196 . in the following ,",
    "we presume that the root is needed ; this only changes the true values of the expectations by a constant factor , which we can ignore .",
    "we now consider the cost of this tour .",
    "let @xmath64 be a non - root vertex in @xmath51 , and let @xmath112 be its level in the tree ( with the root being at level 0 ) .",
    "the probability that a randomly chosen leaf of @xmath51 is a descendant of @xmath64 is @xmath197 .",
    "since @xmath0 points will be chosen , the probability that the parent edge of @xmath64 is needed in @xmath193 is @xmath198 since there are @xmath169 vertices in level @xmath112 and each of their parent edges has weight @xmath199 , the total contribution of level @xmath112 to the weight of @xmath193 is @xmath200 hence :    let @xmath145 be a balanced hst , and let @xmath92 be a randomly chosen @xmath0-element submultiset of its leaves .",
    "then the expected cost of a tour on @xmath92 and the root of @xmath51 is @xmath201.\\ ] ]    since removing the root from the tour can only decrease its cost , we have    @xmath202 \\leq 2 \\cdot \\sum_{\\ell=1}^{\\d } \\left[(b\\lambda)^\\ell \\cdot   \\left(1 - \\left(1 - \\frac{1}{b^\\ell}\\right)^n\\right)\\right].\\ ] ]    [ tsp_upper ] @xmath202 \\leq 2 \\cdot \\sum_{\\ell=1}^{\\d } ( b\\lambda)^\\ell.\\ ] ]    by the inequality @xmath203 , when @xmath140 we have @xmath204 hence    given that the root is necessary in the tour , @xmath202 \\geq 2 \\cdot ( 1 - 1/e ) \\cdot \\sum_{\\ell=1}^{h } ( b\\lambda)^\\ell\\ ] ] where @xmath205 .    since the root is necessary with probability at least @xmath25 ,    [ tsp_lower ] @xmath202 \\geq ( 1 - 1/e ) \\cdot \\sum_{\\ell=1}^{h } ( b\\lambda)^\\ell\\ ] ] where @xmath205 .",
    "our goal now is to reconcile these two corollaries . a new notion , which we term `` lifting '' ,",
    "will aid us here ; it will also help us later on with the bichromatic problems .",
    "given an hst @xmath206 and an @xmath0-point multiset @xmath92 with @xmath207 , we define the _ lifting of @xmath92 _ , written @xmath208 , to be the multiset formed from the level-@xmath209 ancestor of each point in @xmath92 .",
    "stated otherwise , if we define @xmath210 to be the ancestor of the point @xmath64 that lies in level @xmath211 of the tree , then @xmath212 where each point in level @xmath211 is included as many times as it has descendants in @xmath92 .    for convenience",
    "we define @xmath177 .",
    "let @xmath64 be a vertex of @xmath58 that sits in level @xmath213 then @xmath214 where @xmath215 denotes the distance of @xmath9 and @xmath10 in @xmath67    the claim follows easily from the definition of the edge weights in an hst .",
    "from this claim follows    [ projection ] assume that a balanced hst @xmath206 has depth @xmath216 let @xmath92 be an @xmath0-element multiset of the leaves . then @xmath217    * proof : * @xmath218    the lifting lemma enables us to use a three - part strategy on these problems when @xmath219 :    1 .",
    "lift the points from the leaves to level @xmath174 .",
    "this incurs a certain cost , say @xmath220 .",
    "2 .   solve the problem with the points placed at level @xmath174 .",
    "let us say the cost is @xmath221 .",
    "if we can show @xmath222 , the cost of the original problem is @xmath223 .",
    "we come now to our main result for the monochromatic tsp .",
    "[ tsp_thm ] @xmath202 = \\theta\\left(\\sum_{\\ell=1}^{h } ( b\\lambda)^\\ell\\right)\\ ] ] where @xmath205 .",
    "* proof : * assume @xmath177 , since otherwise the theorem follows directly from corollaries [ tsp_upper ] and [ tsp_lower ] .",
    "the lower bound is evident from corollary [ tsp_lower ] . from lemma",
    "[ projection ] , the cost of lifting the points residing at the leaves to level @xmath174 is @xmath224 since the points are now at level @xmath174 of the hst , we will treat @xmath174 as the new height : by corollary  [ tsp_upper ] , the cost of this tour on the lifted points is @xmath225 .",
    "the sum of these two costs is @xmath225 .",
    "the tour so constructed is not in fact the optimal tour , but instead a `` lazier '' one : above level @xmath174 the tour is unchanged , but below level @xmath174 there are @xmath0 direct circuits , one between each point and its ancestor in level @xmath174 .",
    "the cost of the optimal tour is therefore @xmath226 . since , by corollary [ tsp_lower ]",
    ", the cost above level @xmath174 is @xmath227 , the theorem is proved .",
    "let us turn to the mst problem .",
    "as observed above , with probability at least @xmath25 , the root is needed to form the mst ; in what follows we assume that the root is part of the mst .",
    "let @xmath79 be a rooted tree with positive edge weights , and let @xmath228 be its root . assume further that every leaf lies in level @xmath155 of the tree . let us denote by @xmath229 the total edge weight of the path connecting the leaves @xmath194 and @xmath64 .",
    "these distances clearly determine a metric space @xmath230 on the leaf set of @xmath231 for any @xmath232 let @xmath233 denote the subtree of @xmath79 rooted at @xmath234    [ connectedness ] let @xmath92 be a submultiset of the leaves of @xmath231 denote by @xmath51 the minimum spanning tree on @xmath92 with distances determined by @xmath235 also , for an arbitrary non - root vertex @xmath236 , let @xmath237 be the forest spanned by the vertices of @xmath238 then the forest @xmath237 is either connected or empty .    * proof : * assume on the contrary that some @xmath237 is disconnected and non - empty .",
    "let @xmath239 and @xmath240 be two of its components .",
    "we will change @xmath51 in the following way : delete the edge that connects @xmath239 to @xmath241 and connect @xmath239 to @xmath240 by an edge .",
    "this new tree has a smaller total edge weight , since we can connect @xmath239 and @xmath240 by keeping the edges of the @xmath242 path from @xmath239 to @xmath9 and deleting the other edges .",
    "we can say more about the structure of the minimum spanning tree if we impose another condition on @xmath79 :    assume that all edges that connect a parent with its children have equal weight .",
    "then one of the minimum spanning trees is a path .",
    "* proof : * let us first consider the case when @xmath79 is a star tree . in this case , the distance between any two distinct leaves is the same , so there is an mst which is a path .",
    "when @xmath79 is not a star tree , we apply the lemma inductively to the subtrees rooted at the children of @xmath228 ; each subtree has an mst that is a path .",
    "stitching together these msts creates an mst of @xmath79 that is a path . to see its minimality ,",
    "note that if it were not optimal , the suboptimal pieces could be replaced by optimal ones .",
    "we know that the mst can be formed piecewise in this way from lemma  [ connectedness ] .",
    "the following lemma is immediate .",
    "for any hst @xmath79 , it holds that @xmath243    * proof : * by the preceding lemma , we may take the mst to be a path .",
    "the first inequality follows from the fact that removing an edge from a hamiltonian tour yields a spanning tree . to see the second inequality , observe that the tsp solution and the mst differ only in that the former is a cycle and the latter is a chain ; the tsp tour is obtained by adding one edge to the mst .",
    "this edge has weight at most @xmath244 .",
    "notice that @xmath245 , which we consider constant .",
    "the bounds ( expectation and , later , concentration inequalities ) obtained for the tsp will therefore apply to the mst problem as well .",
    "@xmath246- \\e[mst(w ) ] \\le diam(f).\\ ] ]    thus theorem [ tsp_thm ] also applies to msts , viz . ,    [ mst_thm ] @xmath247 = \\theta\\left(\\sum_{\\ell=1}^{h } ( b\\lambda)^\\ell\\right)\\ ] ] where @xmath205 .",
    "we now turn our attention to the bichromatic problems .",
    "it turns out that the bichromatic mst problem is substantially different from the bichromatic tsp .",
    "consider the following problem : @xmath79 is a star graph centered at @xmath228 and has @xmath248 leaves , @xmath249 , with @xmath248 even .",
    "assume that at half the leaves @xmath250 there are @xmath251 red points and one blue point , and at each of the other leaves there are @xmath252 blue points and one red point .",
    "we stipulate that the distance of two points residing at the same leaf is zero , and the distance between any other pair of points is one .",
    "it is easy to see that the optimal cost of the bichromatic tsp is @xmath253 while for a bichromatic spanning tree we will have a total edge length of @xmath254 .",
    "the following observation will be crucial ; the reader may find it intuitive , but we state it here to refer to it later .    [ bi - mono ] let @xmath255 be a monochromatic problem and @xmath256 be the corresponding bichromatic problem .",
    "writing @xmath257 for the cost of the optimal solution to @xmath258 on the point set @xmath92 , and writing @xmath259 for the cost of optimal solution to @xmath256 on the sets @xmath49 and @xmath50 , we have @xmath260    let @xmath49 and @xmath50 be two multisets of @xmath0 points chosen uniformly at random from the leaves of an hst @xmath206 . to form the bichromatic mst",
    ", we must connect each red point @xmath261 to its nearest blue neighbor , and similarly , we must connect each blue point @xmath262 to its nearest red neighbor . since these two cases are symmetric , we will assume without loss of generality that we are concerned with connecting a red point @xmath261 to a blue neighbor",
    ".    we will write @xmath263 for the closest opposite - colored point in the tree .",
    "( in fact , more than one point may be the `` closest '' ; we can disambiguate by making @xmath263 the leftmost closest point . )",
    "it is evident that @xmath263 is the blue point @xmath36 that minimizes the height of the highest node @xmath174 in the path from @xmath261 to @xmath36 .",
    "if @xmath36 is at the same leaf as @xmath261 , the cost will be zero .",
    "otherwise , if @xmath174 is in level @xmath112 , the cost of the path from @xmath261 to @xmath174 will be @xmath264 , while the cost of the path from @xmath174 to @xmath36 will also be between @xmath265 and @xmath266 .",
    "thus the cost that @xmath261 contributes to the bichromatic mst is between @xmath267 and @xmath268 .",
    "we can illustrate this process by coloring the nodes of the mst as follows .",
    "we color a node violet if it has both red and blue points in its subtree .",
    "if it has no points in its subtree , we leave the node white .",
    "otherwise , the node is colored red or blue , depending on which color of points appears in its subtree .",
    "see figure [ fig : colortree ] for an example ( the colors are represented by the letters r , b , v , w ) .",
    "( root ) at ( 0 , -0.4 ) [ circle , draw ] v ;    \\(1 ) at ( -1.5 , -1.2 ) [ circle , draw ] r ; ( 2 ) at ( 0 , -1.2 ) [ circle , draw ] v ; ( 3 ) at ( 1.5 , -1.2 ) [ circle , draw ] v ;    \\(11 ) at ( -2 , -2 ) [ circle , draw ] r ; ( 12 ) at ( -1.5 , -2 ) [ circle , draw ] w ; ( 13 ) at ( -1 , -2 ) [ circle , draw ] r ; ( 21 ) at ( -0.5 , -2 ) [ circle , draw ] r ; ( 22 ) at ( 0 , -2 ) [ circle , draw ] b ; ( 23 ) at ( 0.5 , -2 ) [ circle , draw ] b ; ( 31 ) at ( 1 , -2 ) [ circle , draw ] w ; ( 32 ) at ( 1.5 , -2 ) [ circle , draw ] v ; ( 33 ) at ( 2 , -2 ) [ circle , draw ] b ;    at ( -2 , -2.3 ) r ; at ( -1 , -2.3 ) r ; at ( -0.5 , -2.3 ) r ; at ( 0 , -2.3 ) b ; at ( 0.5 , -2.3 ) b ; at ( 1.5 , -2.3 ) r ; at ( 1.5 , -2.5 ) b ; at ( 2 , -2.3 ) b ;    ( root ) ",
    "( 1 ) ; ( root )  ( 2 ) ; ( root )  ( 3 ) ; ( 1 )  ( 11 ) ; ( 1 )  ( 12 ) ; ( 1 )  ( 13 ) ; ( 2 )  ( 21 ) ; ( 2 )  ( 22 ) ; ( 2 )  ( 23 ) ; ( 3 )  ( 31 ) ; ( 3 )  ( 32 ) ; ( 3 )  ( 33 ) ;    the cost of the bichromatic mst is then obtained by finding the cost from each point @xmath269 to its nearest ( ancestral ) violet node @xmath270 .",
    "there is a caveat with this formulation : the resulting structure may not be connected .",
    "( this will occur , for example , when each subtree of the root receives @xmath271 red points and @xmath271 blue points . )",
    "this difficulty is easily remedied by including the edges of the _ monochromatic _ mst on @xmath272 as part of the bichromatic mst .",
    "the cost of the monochromatic mst does not increase the asymptotic cost of the bichromatic mst , since the former is easily seen to cost no more than the latter by observation  [ bi - mono ] .",
    "we can now state    [ initial_bichromatic_mst ] let @xmath49 and @xmath50 be two uniformly chosen multisets of @xmath0 leaves from the hst @xmath206 .",
    "the expected cost of the bichromatic mst on @xmath49 and @xmath50 is @xmath273),\\ ] ] where @xmath274 is the cost of the path from a point @xmath36 to its lowest violet ancestor in @xmath58 , and @xmath275 is the expected cost of the monochromatic mst of @xmath276 .",
    "now we turn to the task of estimating @xmath277 $ ] .",
    "let the first red point @xmath278 be located , without loss of generality , at the leftmost leaf @xmath279 of the hst .",
    "we define the function @xmath280 to be the probability that the smallest element of an @xmath0-element randomly chosen submultiset of @xmath281 falls in the range @xmath282 . then    * the probability that its leaf @xmath279 is violet is the probability that one of the blue points is also located at @xmath279 , which is @xmath283 . *",
    "the probability that @xmath279 is not violet , but its parent _ is _ violet , is the probability that @xmath279 has no blue point but one of its siblings does .",
    "this probability is @xmath284 . * the probability that @xmath279 and its parent are not violet , but its grandparent _ is _ violet , is @xmath285 , etc . , etc .",
    "@xmath286    * proof : * one can visualize the elements of the multiset as lattice points in the @xmath0-dimensional cube with edge length @xmath287 then the total number of points is @xmath288 the chosen points must belong to a sub - cube with edge length @xmath289 ; however , we have to discard those lattice points that have only large entries .",
    "these lattice points belong to a sub - cube of volume @xmath290    in general , the probability that the red point will have its lowest violet ancestor in the @xmath112-th level from the _ bottom _ of the tree , @xmath291 , is @xmath292    clearly @xmath293 . under stronger conditions , a similar lower bound holds ( lemma [ p_bound ] below ) .",
    "before we prove it , we must make a brief digression to talk about the behavior of the expression @xmath294 for @xmath124 fixed .",
    "it is well known that it approaches @xmath295 as @xmath296 .",
    "but since our earlier results did not rely on @xmath0 going to infinity , we would like to avoid that here as well .",
    "fortunately , the expression is bounded between exponentials even for relatively small values of @xmath0 .",
    "[ e_bound ] let @xmath297 .",
    "then for @xmath298 , @xmath299 and for @xmath300 , @xmath301    * proof : * the upper bounds follow from the elementary inequality @xmath302 for @xmath303 .",
    "( the simplest proof : the expression @xmath304 has its unique global minimum at @xmath305 , shown by taking derivatives .",
    "the value of this minimum is 0 . )",
    "now we show the lower bounds .",
    "we use the taylor series @xmath306 valid for @xmath307 . @xmath308 simplifying @xmath309 shows that it is equivalent to @xmath298 .",
    "thus for @xmath298 , we have @xmath310 .",
    "exponentiating both sides gives the first statement .",
    "similarly , @xmath311 simplifying @xmath312 shows that it is equivalent to @xmath300 .",
    "thus for @xmath300 , we have @xmath313 . exponentiating both sides",
    "gives the second statement .",
    "we now return to the lower bound on @xmath314 .",
    "[ p_bound ] when @xmath315 and @xmath316 , @xmath317    * proof : * for brevity , we write @xmath318 .",
    "the smallest that @xmath319 can be is @xmath320  that is , @xmath319 can not be smaller than @xmath38 .",
    "consider the fraction @xmath321 .",
    "it is less than 1 , and its value increases as @xmath319 decreases . thus @xmath322 ( we have used proposition [ e_bound ] to show @xmath323 .",
    "notice that @xmath316 implies @xmath324 . )",
    "so @xmath325 and @xmath326    accordingly , given @xmath315 , we have    @xmath327 & = & \\theta\\big(0 \\cdot p(b^\\d , n , 1 , 1 ) + 2\\lambda^\\d / ( 1 - \\l ) \\cdot p(b^\\d , n , 2 , b ) + \\\\ & & 2\\lambda^{\\d-1 } / ( 1 - \\l ) \\cdot p(b^\\d , b , b+1 , b^2 ) + 2\\lambda^{\\d-2 } / ( 1 - \\l ) \\cdot p(b^\\d , n , b^2 + 1 , b^3 ) + \\ldots + \\\\ & & 2\\lambda^1 / ( 1 - \\l ) \\cdot p(b^\\d , n , b^{\\d-1 } + 1 , b^\\d)\\big ) \\\\ & = & \\theta\\left(\\sum_{\\ell=1}^\\d 2\\l^{(\\d    - \\ell ) + 1 } / ( 1 - \\l ) \\cdot ( 1 - b^{(\\ell - \\d ) - 1})^n\\right ) \\\\ & = & 2\\l^\\d \\cdot \\theta\\left(\\sum_{\\ell=1}^\\d \\l^{1 - \\ell } \\cdot ( 1 - b^{(\\ell - \\d ) - 1})^n\\right)\\end{aligned}\\ ] ]    for fixed @xmath13 and @xmath12 .",
    "our next task is to show that the expression @xmath328 that appears above is bounded between constants .",
    "[ bela ] let @xmath137 and @xmath329 be fixed , let @xmath315 , and let @xmath330 . define @xmath331 .",
    "then there is a constant @xmath332 such that @xmath333 for all @xmath334 .",
    "* proof : * defining @xmath335 as above , we have @xmath336 when @xmath337 , we have @xmath338 thus @xmath339 , and we have @xmath340 .    we have shown that @xmath340 can fail to hold only when @xmath341 .",
    "we need to see what this means in terms of @xmath112 : @xmath342 thus @xmath340 is true with the possible exceptions of when @xmath343 .",
    "set @xmath344 .",
    "we next consider the behavior of the expression @xmath345 .",
    "it will be more convenient to substitute @xmath346 .",
    "[ tom_ineq ] let @xmath347 and @xmath348 .",
    "then @xmath349    * proof : * if @xmath350 the proof is trivial , so let us assume @xmath351 . dividing and taking roots , we obtain the equivalent statement @xmath352{z / n}$ ] .",
    "we will prove @xmath353{\\frac z n}.\\ ] ] the first inequality of these three follows from the well - known fact @xmath354 , here taking @xmath355 .",
    "the second is equally simple , since @xmath356 implies @xmath357 ( here we take @xmath358 and @xmath359 ) .",
    "only the third inequality remains to be proved .",
    "we will show that the minimum value of @xmath360{z / n } = ( z / n)^{1/n}$ ] as a function of @xmath0 ( considering @xmath319 constant ) is @xmath361 .",
    "several manipulations will make this task easier .",
    "first , set @xmath362",
    ". then @xmath363 where @xmath364 .",
    "it is equivalent to minimize its logarithm , @xmath365 this expression has derivative @xmath366 the derivative is zero when @xmath367 .",
    "this value of @xmath9 does , in fact , give a minimum , since the second derivative @xmath368 is positive .",
    "we conclude that the minimum value of @xmath369 is @xmath370 as desired .",
    "let @xmath137 and @xmath329 be fixed , and let @xmath315 .",
    "then @xmath371    * proof : * let @xmath0 be sufficiently large .",
    "we define @xmath331 .",
    "notice @xmath372 . by lemma [ tom_ineq ] with @xmath346",
    ", we have @xmath373 . for @xmath374 , we have @xmath375 , so that @xmath376 .",
    "set @xmath332 as in lemma [ bela ] .",
    "we see that each of the first @xmath332 terms @xmath377 is at most @xmath378 , so their sum is @xmath379 . for @xmath380 ,",
    "we have @xmath381 , so that the sum @xmath382 converges faster than a geometric series with common ratio @xmath181 ; this part of the sum is @xmath383 .",
    "both these quantities are @xmath384 .",
    "we can now state    for @xmath315 , @xmath385 = o((b\\lambda)^\\delta).\\ ] ]    * proof : * @xmath386 & = & n \\cdot 2\\l^\\d \\cdot \\theta\\left(\\sum_{\\ell=1}^\\d \\l^{1 - \\ell } \\cdot ( 1 - b^{(\\ell - \\d ) - 1})^n\\right ) \\\\ & = & n \\cdot 2\\l^\\d \\cdot o(b^\\d /",
    "n ) \\text { \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\ , ( by the previous corollary)}\\\\ & = & o(\\l^\\d b^\\d).\\end{aligned}\\ ] ]    applying this result to proposition  [ initial_bichromatic_mst ] gives our main result for the bichromatic mst .",
    "[ bichrom_mst ] let @xmath49 and @xmath50 be two uniformly chosen multisets of @xmath0 leaves from the hst @xmath206 .",
    "the expected cost of the bichromatic mst on @xmath49 and @xmath50 is @xmath387 where @xmath388 .",
    "this is the same ( up to constant factors depending on @xmath13 and @xmath12 ) as the expected cost for the monochromatic mst on @xmath276 .",
    "* proof : * suppose @xmath315 . by proposition [ initial_bichromatic_mst ] ,",
    "the expected cost is @xmath389 + \\sum_{i=1}^\\d ( b\\lambda)^i \\right)$ ] ; by observation [ bi - mono ] , it is @xmath390 .",
    "we need only to show @xmath391 = o\\left(\\sum_{i=1}^\\d ( b\\lambda)^i \\right)$ ] .",
    "but by the previous proposition , @xmath391 = o((b\\lambda)^\\delta)$ ] , and the last term in the summation is @xmath392 .",
    "thus the total cost is also @xmath393 .    if @xmath394 , we lift the points up to level @xmath211 . by the above argument",
    ", the expected cost of the bichromatic mst on the lifted points is @xmath395 .",
    "the lifting cost is @xmath396 , and as before , such a term is already present in the summation .",
    "as before , we start by considering the case when @xmath79 is a star with edge weight @xmath397 let @xmath0 red points and @xmath0 blue points be uniformly distributed at random among the leaves of @xmath231 we will call a leaf _ easy _ if it has been assigned equal numbers of red and blue points ; otherwise , we will call the leaf _",
    "hard_. note that a hard leaf can be either monochromatic or bichromatic .",
    "our optimal traveling salesman tour is produced by the following algorithm :    * connect the points at every easy leaf into a path that begins at a red point and ends at a blue point .",
    "these paths have zero cost . *",
    "connect the paths at the easy leaves into one long red - blue path .",
    "if there are @xmath155 easy leaves , the total cost of this is @xmath398 * at each hard leaf , find the longest possible red - blue path , depending on whether we have more red or more blue points .",
    "+ since one color outnumbers the other , each of these paths can have the same color at both its endpoints .",
    "we delete the inner points of all such paths , leaving only the two same - colored endpoints .",
    "hence , after this process , some points are isolated , while the other points are all arranged into a long path .",
    "* connect the isolated points into a long red - blue path , and then glue the two long paths together to get the traveling salesman tour .",
    "as we found with the bichromatic mst , this algorithm can be easily extended to find the optimal tsp tour for general hsts ( not just star trees ) . to this end",
    ", it is useful to consider a version that works when the numbers of red and of blue points are different . in such a case",
    ", we can only have a path of minimum cost , hence , in steps 3 and 4 one has to modify the method to first connect as many isolated red - blue points together into a red - blue path as possible , and then connect this long path to the path containing the points of the easy leaves .",
    "notice that in step 3 , the cost of connecting the isolated points into a red - blue path is twice the cost of the bichromatic matching on these points minus @xmath397 clearly , the discrepancy of the point distribution plays an important role here , just as it did in the case of bichromatic matching in @xcite .",
    "we say that the random variable @xmath3 has distribution @xmath399 if @xmath400 where @xmath401 and @xmath402 for every @xmath403 , with the @xmath404 independent . for a vertex @xmath64 in level @xmath112",
    ", the discrepancy has the form @xmath405 , where @xmath406 and @xmath407 , the numbers of red and blue points in @xmath64 s subtree , are independent variables with distribution @xmath408 .",
    "we now consider the expected behavior of this discrepancy .",
    "we prove two bounds : one will be useful in the case of a star tree , while the other will be used in the bound for general hsts .",
    "[ abs_bound ] let @xmath2 be the difference of two i.i.d .",
    "@xmath409 variables . for fixed @xmath36 , @xmath410    [ abs_bound_2 ] let @xmath2 be the difference of two i.i.d .",
    "@xmath409 variables , with @xmath411 and @xmath412 .",
    "then @xmath413 for some constant @xmath414 .    *",
    "proof : * we denote by @xmath415 the standard deviation of the random variable @xmath3 . from @xmath416",
    "we obtain @xmath417 . here",
    "we used the fact @xmath418 , since it is the difference of two random variables with the same distribution . since @xmath419 , the upper bounds on @xmath420 follow .",
    "the lower bound will take more work .",
    "recall hlder s inequality , @xmath421 setting @xmath422 , we obtain @xmath423 , and thus @xmath424 by definition ,",
    "we can write @xmath2 as the sum @xmath425 , where the @xmath426 s are i.i.d .  with @xmath427 it is clear that @xmath428 .",
    "consider the expansion @xmath429 .",
    "any term with an odd power of an @xmath426 , such as @xmath430 or @xmath431 , will have zero expectation , by independence and the fact @xmath432 .",
    "thus the only terms with nonzero expectation will be the terms @xmath433 and @xmath434 with @xmath435 . since @xmath436 and @xmath437 for @xmath435 , we have @xmath438 thus @xmath439^{3/2}}{\\sqrt{\\theta(n^2 ) } } = \\omega(\\sqrt n),\\ ] ] proving lemma [ abs_bound ] .",
    "note that without the @xmath440 term in the denominator , this function would behave as @xmath441 . to see when the @xmath442 term will dominate ,",
    "we set @xmath443 and obtain @xmath444 for @xmath445 we have @xmath446 , and for @xmath412 ( as it always is for us ) we have @xmath447 ; thus @xmath448 will imply @xmath449 . when @xmath411 , then , this bound is at least @xmath450 , and lemma [ abs_bound_2 ] is proved .",
    "[ np_remark ] for a vertex in level @xmath112 of the tree , @xmath451 ; thus when @xmath452 , we have @xmath411 .",
    "let us now apply lemma [ abs_bound ] to the problem of finding the expected tsp cost for a star tree .",
    "let the number of red ( resp .",
    "blue ) points assigned to leaf @xmath453 be @xmath454 ( resp .",
    "@xmath455 ) .",
    "then @xmath2 in lemma  [ abs_bound ] will be @xmath456 for the leaf @xmath457 as described initially , we make as long a path as possible in each leaf ; these paths have zero cost .",
    "our task is now to connect these paths into a tour .",
    "if @xmath458 , then our tour must visit the leaf exactly @xmath459 times . if @xmath460 , then the cost depends on whether their value is zero or not : if it is zero , then there is no cost , while if the value is nonzero , the leaf must be visited once .",
    "thus the cost contributed by leaf @xmath453 is either @xmath461 or @xmath459 .",
    "the extra @xmath462 does not matter much ; by observation  [ bi - mono ] , the cost of the optimal _ monochromatic _ tour is less than or equal to the cost of the optimal bichromatic tour",
    ". thus we can add the cost of the monochromatic tour to the bichromatic tour and only increase its cost by a constant factor . since @xmath463 by lemma  [ abs_bound ] , we obtain    let @xmath49 and @xmath50 be two multisets of size @xmath0 of the leaves of the star tree @xmath464 .",
    "consider @xmath13 fixed , and assume that @xmath0 is large .",
    "the expected cost of the optimal bichromatic tour on @xmath49 and @xmath50 is @xmath465    the case of a general hst can be handled similarly , this time using lemma [ abs_bound_2 ] .",
    "let @xmath64 be a non - leaf vertex in the hst .",
    "as described above , we make as long a path as possible in the subtree rooted at @xmath64 .",
    "the endpoints of this path , and the leftover points , must now look upward to find neighbors in the tour .",
    "let the number of red ( resp .",
    "blue ) points assigned to a non - leaf node @xmath64 be @xmath406 ( resp .",
    "@xmath407 ) .",
    "if @xmath466 , our tour must use @xmath64 exactly @xmath467 times . if @xmath468 , then the cost depends on whether their value is zero or not : if it is zero , then there is no cost , while if the value is nonzero , the leaf must be used once .",
    "thus the cost contributed by @xmath64 is either @xmath405 or @xmath467 .    as before ,",
    "the extra @xmath462 does not matter : using observation  [ bi - mono ] , we can add the cost of the monochromatic tour to the bichromatic tour and only increase its cost by a constant factor .",
    "[ bichrom_tsp ] let @xmath49 and @xmath50 be two multisets of size @xmath0 of the leaves of the hst @xmath206 .",
    "consider @xmath13 and @xmath12 fixed , and define @xmath205 .",
    "then the expected cost of the optimal bichromatic tour on @xmath49 and @xmath50 is @xmath469    * proof : * let @xmath64 be a node in level @xmath470 . by lemma [ abs_bound_2 ] and remark [ np_remark ] , the expected contribution of @xmath64 to",
    "the cost of the tour is @xmath471 .",
    "the total cost of level @xmath112 , obtained by multiplying by @xmath169 , is therefore @xmath472 ; summing up over levels @xmath473 and adding in the cost of the monochromatic mst gives us bounds of @xmath474 for the portion of the tour above level @xmath174 .",
    "but in fact @xmath475 because @xmath476 for @xmath477 .",
    "( the inequality simplifies to @xmath478 ; recall @xmath479 . )",
    "we have shown , then , that the expected cost of the tour above level @xmath174 is @xmath480    if @xmath481 we are done .",
    "if instead @xmath177 , we must first lift the points to level @xmath174 ; the cost is @xmath482 , but as above , @xmath483 .",
    "we conclude this section by remarking that our results can also be applied to the corresponding classical probabilistic optimization problems on the @xmath484-dimensional euclidean hypercube .",
    "this is accomplished by using hsts that dominate the distances in a sufficiently dense grid of the cube .",
    "it is easy to see that this process produces upper bounds for the expected costs which are tight up to a constant factor , except in the case of the 2-dimensional bichromatic matching problem . for more details on the dominating hsts ,",
    "see @xcite .",
    "many of the ideas in this section stem from those of yukich  ( * ? ? ?",
    "* chapter 6 ) , who in turn used methods of talagrand  @xcite , rhee  @xcite and steele  @xcite . given a hierarchically separated tree @xmath51 with branching factor @xmath13 and",
    "weight ratio @xmath181 satisfying @xmath485 and @xmath486 , we investigate the probability that the matching length of a random point set @xmath2 deviates widely from its expectation .",
    "we will consider both the monochromatic case and the bichromatic case .",
    "as it turns out , we have much better concentration results for the former than for the latter , since in the monochromatic case we can use an isoperimetric inequality which , it seems , can not be applied to the bichromatic problems .",
    "first we briefly discuss azuma s inequality , which will be of use to us in both cases .",
    "let @xmath487 be a finite probability space with the filtration ( in this case a sequence of partitions of @xmath488 ) @xmath489let @xmath2 be a random variable .",
    "for each @xmath490 we define the _ martingale difference _ @xmath491 and assume that @xmath492 we have the following well - known result :    [ azuma ] for all @xmath493 , @xmath494 where @xmath495      in this section we investigate the monochromatic case .",
    "first we will consider the minimum matching problem , then the closely related tsp and mst problems .",
    "we need a combinatorial lemma .",
    "[ top ] assume that @xmath155 points are assigned to vertices of @xmath496 with @xmath155 even .",
    "then the minimum matching for this point set has total cost at most @xmath497 where @xmath498 is the sum of the edge lengths of the first @xmath499 levels of @xmath500    * proof : * let @xmath501 and @xmath502 be two points below level @xmath503 that are matched in the minimum matching .",
    "denote their ancestors at level @xmath112 by @xmath504 and @xmath505 respectively",
    ". then @xmath506 by lemma  [ projection ] .",
    "if one of the points , say @xmath507 is at level @xmath508 we still have the same inequality .",
    "it is easy to see that no edge of the tree is used more than once in a minimum matching .",
    "hence , the minimum matching length is at most @xmath509 since we have @xmath510 pairs to be matched .",
    "it is easy to see that @xmath511 this implies that the minimum matching length is at most @xmath512    we are now going to use isoperimetric methods in order to prove strong concentration inequalities . toward this end ,",
    "let @xmath513 be the finite probability space with the atoms of @xmath488 corresponding to the leaves of @xmath51 , with each atom having equal probability .",
    "we define @xmath514 to be the @xmath0-fold product space on @xmath488 , and we denote by @xmath515 its probability measure .    given @xmath516 the hamming distance @xmath58 between @xmath2 and @xmath3 is the number of coordinates in which @xmath2 and @xmath3 disagree : @xmath517    with the following lemma we show that if two @xmath0-tuples are close in hamming distance , the corresponding minimum matching costs are close to each other . this property is called the _ smoothness _ of the minimum matching functional .",
    "[ smoothness ] let @xmath518 if @xmath519 then @xmath520 where @xmath521 is as defined in lemma  [ top ] .",
    "* proof : * assume that we have a minimum matching for @xmath522 and then delete / add @xmath155 points in order to make @xmath523 we construct a matching ( not necessarily minimum ) for @xmath2 that will satisfy the inequality of the lemma .",
    "there are three kinds of matched pairs in @xmath524 first , there are those that are unaffected  that is , both points belong to @xmath2 as well",
    ". we will keep them matched in the new matching .",
    "second , there are matched pairs from which we deleted one point each .",
    "the remaining points of these pairs became unmatched , as well as the points of @xmath525 since @xmath526 we have @xmath155 unmatched points ( here @xmath155 must be even ) .",
    "we find a minimum matching for these points ; the cost is at most @xmath527 by lemma  [ top ] . in this way",
    ", we constructed a matching for @xmath2 having total length at most @xmath528 and the lemma is proved .",
    "let us consider the smoothness of the tsp functional on hsts .",
    "earlier we saw that @xmath529 which is a constant .",
    "hence , the concentration we show below for the tsp holds for the mst as well .",
    "first we need an analogue of lemma  [ top ] .",
    "[ top - tsp ] assume that @xmath155 points are assigned to vertices of @xmath496 with @xmath155 even .",
    "then the traveling salesman tour for this point set has total cost at most @xmath530 where @xmath498 is the sum of edge lengths of the first @xmath499 levels of @xmath500    * proof : * the proof is very similar to the proof of lemma  [ top ] , so we emphasize the differences only .",
    "first , the tsp tour that connects all the vertices in level @xmath155 has total length @xmath531 we use the projection lemma again to get that for points below level @xmath155 we have to add at most an extra cost of @xmath532 since there are @xmath155 points , we can have at most @xmath533 extra cost .",
    "this adds up to @xmath534    with this we are prepared to show the smoothness of the tsp .",
    "[ smoothness - tsp ] let @xmath518 if @xmath519 then @xmath535    * proof : * assume that we have an optimal tour @xmath536 for @xmath522 and then delete / add @xmath155 points in order to make @xmath523 we construct a tour ( not necessarily optimal ) for @xmath2 that will satisfy the inequality of the lemma .",
    "notice that even if we delete points from @xmath537 , the optimal cost of the tour @xmath538 that skips the deleted points , going through only the remaining points in their original order , is at most as large as the cost of @xmath539 this follows from the triangle inequality : say , @xmath540 are in this order in the optimal tour , and then we delete @xmath541 then @xmath542 next , we construct an optimal tour @xmath543 through the new points , with cost at most @xmath544 by lemma  [ top - tsp ]",
    ". then we delete one edge from @xmath538 and one edge from @xmath545 this way we get two paths .",
    "we will get a new tour by connecting the endpoints of the paths ; this has cost at most twice the diameter , which is at most @xmath546 the total additional cost is therefore @xmath547    it will be convenient to introduce a new notation @xmath279 for a smooth functional",
    ". we will assume that @xmath548 if @xmath549 with @xmath550 a constant .",
    "we further assume that @xmath551 notice that by lemmata  [ smoothness ] and  [ smoothness - tsp ] we have the smoothness conditions for @xmath85 , @xmath73 and @xmath76 , albeit with different values for @xmath552 we showed in previous sections that for these functionals the expectation has the above form .",
    "as it turns out , smoothness and expectation value are the most important properties we need for showing strong concentration about the mean .",
    "the isoperimetric inequality we need is standard , but for completeness we present the proof . for a subset @xmath553",
    ", we define @xmath554 let us fix a set @xmath555 such that @xmath556 . for a number @xmath557",
    "we define @xmath558 we will show , with the aid of azuma s inequality , that @xmath559 tends to zero very fast as we increase @xmath560 let @xmath561 this is the expected hamming distance of a randomly chosen @xmath0-tuple of @xmath514 from @xmath562 then by azuma s inequality , @xmath563 ( here we have used the fact that changing one coordinate results in a change of at most 1 in the hamming distance . )    next we give a bound for @xmath564 observe that when @xmath565 we have @xmath566 thus @xmath567 for all @xmath568 setting @xmath569 in the above inequality , we have @xmath570 which implies @xmath571 hence @xmath572    some consideration of the cases @xmath573 and @xmath574 , after necessary modifications of the parameters , produces the following _ isoperimetric inequality _",
    ", valid for all @xmath557 independently of @xmath564    [ iso_ineq ] if @xmath575 satisfies @xmath576 then @xmath577    we are going to use the _ median _ of the @xmath279 functional : @xmath578 let @xmath579 then @xmath580 applying lemma  [ smoothness ] , we obtain @xmath581 where @xmath582 one can also prove a similar inequality using the set @xmath583 to bound the probability @xmath584 putting the two together , we see    @xmath585    in the cases that interest us most , we can find the inverse of @xmath586 and hence we can apply the isoperimetric inequality ( proposition [ iso_ineq ] ) to prove strong concentration around the expected value .",
    "first , we consider the case when @xmath587 then @xmath588 in this case , using the isoperimetric inequality , we have    @xmath589 @xmath590 with the constants @xmath192 and @xmath591 where @xmath592    now suppose @xmath593 then @xmath594 where @xmath595 is a constant depending only on @xmath13 and @xmath181 .",
    "the inequality @xmath596 using that @xmath597 implies the inequality @xmath598 this in turn implies    @xmath599    @xmath600 for @xmath593    since @xmath601 for any random variable @xmath602 integrating these inequalities over the non - negative reals produces an upper bound for @xmath603 in the next section we will look at some important special cases .",
    "it is particularly interesting to consider the case @xmath604 since it relates the functionals in question on an hst with functionals on the unit cube of some dimension .",
    "when @xmath605 for some positive integer @xmath606 the hst approximates the @xmath484-dimensional unit cube in euclidean space .",
    "let us first consider the case @xmath607 : we encounter such a tree @xmath51 when approximating the @xmath21 $ ] interval .",
    "for this case @xmath608 and therefore @xmath609 it is easy to see ( using , e.g. , numerical approximation ) that @xmath610    consequently , we have @xmath611 since @xmath612 this means that we do nt have an especially useful concentration result for this special case .",
    "inspecting cases , one finds the following inequality for the case @xmath607 and @xmath613 : @xmath614 where @xmath192 is a real constant . while the constants can be improved somewhat ( partly due to the fact that the constants are not the best possible for this case ) , this inequality allows @xmath615 to be spread out over an interval of length @xmath616 however , the probability of @xmath615 falling outside this interval is very small : even a deviation of @xmath617 results in a probability less than @xmath618    on the other hand , the bounds that we have derived will provide very good concentration inequalities for the case @xmath619 as above , we need to estimate an integral to get a bound for @xmath620 @xmath621 as can be shown by numerical approximation .",
    "we thus have the following concentration inequality : @xmath622 where @xmath623 is a real constant .",
    "notice that @xmath624 hence , whenever @xmath613 and @xmath625 the exponent of @xmath557 above is larger than @xmath626 in other words , in these cases all the considered monochromatic optimization problems exhibit sub - gaussian behavior .",
    "the case @xmath605 can be used to approximate the @xmath279 functional in the @xmath484-dimensional unit cube . in general , when @xmath605 the inequality has the following form : @xmath627 for some real constant @xmath628      in this case we lack a counterpart to lemma  [ smoothness ] .",
    "what we have instead is that a change at one point changes the length of the red - blue matching by at most one unit ( the diameter of @xmath51 is a constant , and after normalization it is one unit )",
    ". we can apply azuma s inequality , giving us @xmath629 this is clearly weaker than the very strong concentration results we obtained for the monochromatic matching problems .",
    "in general we can not expect any better than that .",
    "let s consider the star tree with two leaves .",
    "the difference of the red and blue points at one of the leaves is approximately normal if @xmath0 is large , since the red and the blue points have approximately normal distribution when @xmath0 is large .",
    "this implies that the discrepancy can not have a sub - gaussian behavior .",
    "in this paper , we considered five optimization problems  monochromatic matching , and monochromatic and bichromatic versions of the mst problem and the tsp  on points randomly distributed among the leaves of a balanced hierarchically separated tree .",
    "these investigations continued the work of abrahamson @xcite and his collaboration with csaba and shokoufandeh @xcite , in which the bichromatic matching problem was considered .",
    "we were able to come up with tight upper and lower bounds to these five problems that resemble those obtained in @xcite and @xcite for bichromatic matching .",
    "we also obtained concentration inequalities for the monochromatic problems ; in passing , we noted that the bichromatic problems present substantial difficulty .",
    "it will be useful to extend these results to more general metric spaces than we have considered here .",
    "for instance , bartal s original definition of hst @xcite did not enforce an exact ratio of @xmath181 between parent and child edges , but rather that the ratio was at most @xmath181 .",
    "one can also try to embed arbitrary metric spaces into an hst , turning optimization problems in continuous sets into hst optimization problems . here",
    ", of course , we must account for some distortion .",
    "these applications constitute a great part of the utility of hsts , but we leave their consideration for future work .",
    "jeff abrahamson , bla csaba , and ali shokoufandeh .",
    "optimal random matchings on trees and applications . in _ proceedings of the 12th international workshop on randomization and computation , _",
    "random 08 , pages 254 - 265 , berlin , heidelberg , 2008 .",
    "springer - verlag .",
    "jittat fakcharoenphol , satish rao , and kunal talwar .",
    "a tight bound on approximating arbitrary metrics by tree metrics . in _ proceedings of the 35th annual acm symposium on theory of computing , _",
    "stoc 03 , pages 448 - 455 , new york , ny , usa , 2003 .",
    "f. t. leighton and p. shor , tight bounds for minimax grid matchings , with applications to the average case analysis of algorithms . in proceedings of the 18th annual acm symposium on theory of computing , stoc86 , pages 91 - 103 , new york , ny , usa , 1986 ."
  ],
  "abstract_text": [
    "<S> we derive tight bounds on the expected weights of several combinatorial optimization problems for random point sets of size @xmath0 distributed among the leaves of a balanced hierarchically separated tree . </S>",
    "<S> we consider _ monochromatic _ and _ bichromatic _ versions of the minimum matching , minimum spanning tree , and traveling salesman problems . </S>",
    "<S> we also present tight concentration results for the monochromatic problems . </S>",
    "<S> * keywords : * hierarchically separated tree , euclidean optimization , metric space </S>"
  ]
}