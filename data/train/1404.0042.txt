{
  "article_text": [
    "the odds ratio is a measure of association widely used in epidemiology that can be estimated using logistic regression . on the other hand ,",
    "when one wants to communicate a risk ratio , the logistic regression is not recommended if the outcome is common , see @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite among others .",
    "if one wants to estimate the adjusted risk ratio , a log - binomial model is preferable to a logistic model .",
    "the log - binomial model assumes that the distribution of the outcome @xmath0 is the bernoulli distribution @xmath1 where @xmath2 , and @xmath3 includes variables denoting exposures , confounders , predictors and product terms .",
    "usually @xmath4 and therefore @xmath5 is the intercept .",
    "since @xmath6 , we have to impose the constraints @xmath7 , @xmath8 , on the values of @xmath9 which complicates its maximum likelihood estimation . @xcite and @xcite have suggested a poisson model without the constraints , that is , @xmath10 to approximate the log - binomial maximum likelihood estimator and they consider a robust sandwich variance estimator to estimate the standard errors . model ( [ zou_poisson ] ) can be fitted with standard statistical packages like r , stata or sas .",
    "nevertheless , if @xmath11 is the estimate obtained fitting the poisson model then @xmath12 can be greater than zero . on the other hand , @xcite , and @xcite have proposed a different approximation using an _ expanded dataset _ and a maximun likelihood estimator .    in this article",
    "we consider a bayesian analysis of the log - binomial regression model ( [ modelo ] ) . in this context @xcite",
    "have proposed to incorporate the constraints @xmath7 , @xmath8 as part of the likelihood function for log - binomial regression models and they have shown that the bayesian approach provides estimates similar to the maximum likelihood estimates and produces smaller mean squared errors .",
    "posterior computations can be carried out using the winbugs code that appears in @xcite ; however , winbugs can lead to a poor convergence and a high monte carlo error .",
    "furthermore , the instrumental distribution implemented in winbugs to simulate each full conditional distribution has not account for the constraints in an efficient way : the constraints must be evaluated _ a posteriori _ each time a simulation from the instrumental distribution is proposed and this simulation is rejected if the new proposed value of the parameter does not satisface the @xmath13 constraints .",
    "in this paper we overcome these two drawbacks using an mcmc method based on a reparameterization and an instrumental distribution that directly generates values of the parameters in the constrained parameter space .",
    "to introduce the problems that can arise we consider the following example discussed in @xcite .",
    "the data are @xmath14 and @xmath15 , so that @xmath16 we have used the winbugs code proposed by @xcite and provided in the appendix with the prior distribution @xmath17 .",
    "we have run a markov chain with 10000 iterations and an adaptive phase of 500 iterations using the method _ updatermetnormal _ , and the last 9500 iterations have been used to carry out the inferences .    figures ( [ fig_ejemplo_1_beta1 ] ) and ( [ fig_ejemplo_1_beta2 ] ) , first row , show a poor convergence of the chains that may be explained in part by the high posterior correlation ( -0.97 ) between @xmath5 and @xmath18 and by the constraints .",
    "the same results were obtained increasing the adaptive phase to 2000 and using the last 8000 iterations . if we consider orthogonal covariates , that is @xmath19 instead of @xmath15 , the autocorrelation functions show a moderate improvement ( figures ( [ fig_ejemplo_1_beta1 ] ) and ( [ fig_ejemplo_1_beta2 ] ) , second row ) , but a slow convergence again .",
    "a better performance would be attained with a reparameterization for which the new parameters were approximately uncorrelated given the data .",
    "this reparameterization may be obtained using the estimated covariance matrix of the maximum likelihood estimator of @xmath9 . however ,",
    "very often neither the maximum likelihood estimate nor the estimated covariance matrix can be calculated and this is the first problem we consider . to avoid this drawback",
    "we propose a reparameterization based on a poisson model , see zou ( @xcite ) .",
    "let @xmath20 be the estimated covariance matrix of the maximum likelihood estimator @xmath11 obtained fitting the poisson model ( [ zou_poisson ] ) and let @xmath21 be the upper triangular factor of the choleski decomposition of @xmath22 .",
    "the likelihood function associated with the log - binomial regression model ( [ modelo ] ) is @xmath23 where @xmath24 and @xmath7 , @xmath8 .",
    "the reparameterization we propose is @xmath25 .",
    "if @xmath26 is the prior distribution then the posterior distribution of @xmath9 is @xmath27 and hence , given the data @xmath28 , the distribution of @xmath25 is @xmath29 where now , @xmath30 , @xmath31 , @xmath8 and @xmath32    using winbugs we can simulate a markov chain with stationary distribution @xmath33 and therefore this chain can be used to carry out bayesian inference on @xmath34 .",
    "if the posterior distribution of @xmath9 is approximately the multivariate normal distribution @xmath35 restricted to @xmath36 , then the distribution @xmath33 is approximately the multivariate normal distribution with mean @xmath37 and covariance matrix @xmath38 , restricted to @xmath39 .",
    "therefore , winbugs would get a better convergence if it is used to simulate from @xmath40 instead of directly simulating from the posterior distribution of @xmath9 .    for model ( [ toy ] )",
    "we have used winbugs to simulate from @xmath40 .",
    "we have run a chain with 10000 iterations and an adaptive phase of 500 iterations using the method _ updatermetnormal _ , and the last 9500 iterations have been used to carry out the inferences .",
    "after that , we have transformed the simulations using @xmath34 .",
    "figures ( [ fig_ejemplo_1_beta1 ] ) and ( [ fig_ejemplo_1_beta2 ] ) , third row , show a better convergence of the chains compared with the chains obtained from winbugs when the target was @xmath41 .",
    "this improvement is due to the reparameterizacion based on the poisson model .    on the other hand ,",
    "the methods implemented with winbugs to simulate from @xmath41 or from @xmath40 have the drawback that the instrumental distribution of the metropolis - hastings step used to simulate each full conditional distribution has not account for the constraints .",
    "therefore , the constraints must be evaluated _ a posteriori _ each time a simulation from the instrumental distribution is proposed .",
    "this can increase the computational time and the _ probability of rejecting _ in the metropolis - hastings steps .",
    "this is the second problem we consider . to overcome it we propose an instrumental distribution designed to efficiently explore the parameter space .",
    "we propose a metropolis - within - gibbs algorithm that generates a markov chain with stationary distribution @xmath40 and therefore it can be used to carry out bayesian inference on @xmath34 .",
    "it is based on an efficient simulation from the full conditional distributions . for @xmath42 and @xmath43",
    "such that @xmath44 , the full conditional distribution is @xmath45 .",
    "the set @xmath46 is a key ingredient for our metropolis - within - gibbs algorithm . in the following proposition , that is proved in the appendix",
    ", it is established that the set @xmath47 is an interval of the real line .    if @xmath48 then the set @xmath47 is the interval @xmath49 where @xmath50 and @xmath51 with the convention that @xmath52",
    "if @xmath53 and @xmath54 if @xmath55 .    to get an appropriate instrumental distribution we argue that the multivariate normal distribution @xmath56 restricted to @xmath39 is an approximation to the distribution @xmath33 and hence , the distribution @xmath57 restricted to @xmath58 would be an appropriate instrumental distribution to perform the metropolis - hastings step .",
    "however , the simulation from a truncated normal distribution can increase the computational time .",
    "instead , we propose the cauchy distribution with location @xmath59 and scale @xmath60 truncated to @xmath47 with density @xmath61 where @xmath62 if @xmath63 and @xmath64 otherwise . to simulate @xmath65 from this instrumental distribution",
    "we simulate @xmath66 and compute @xmath67 the instrumental distribution ( [ cauchy ] ) reduces the autocorrelation , as it is shown in the examples .",
    "the proposed metropolis - within - gibbs algorithm has been implemented in r and it is provided in the appendix .",
    "figures ( [ fig_ejemplo_1_beta1 ] ) and ( [ fig_ejemplo_1_beta2 ] ) , last row , show the results obtained using our mcmc algorithm with 10000 iterations .",
    "our algorithm produces a satisfactory acceptance rate and a quickly decreasing autocorrelation .",
    "this improvement , compared with the winbugs code used to simulate from @xmath33 is due to the proposed instrumental distribution ( [ cauchy ] ) .",
    "in this section we present three examples to illustrate our mcmc algorithm . for each example",
    "we have used winbugs to simulate from @xmath41 and from @xmath40 running a chain with an adaptive phase of 500 iterations out of a total of 10000 iterations for the method _ updatermetnormal _ and after that we have transformed the simulations from @xmath40 using @xmath34 .",
    "we have also used our mcmc algorithm with 10000 iterations and the simulations have been transformed using @xmath34 . we have used uniform prior distributions .",
    "the efficiency of each algorithm has been measured in terms of the effective sample size and the computational speed .",
    "we consider the data on the relation between receptor level and stage to 5-year survival in a cohort of 192 women with breast cancer , see table ( [ greenland ] ) , discussed in @xcite . in this example",
    "the percentage of deaths was 28.13% .",
    "figure ( [ fig - greeland ] ) , first row , shows the autocorrelation functions for the parameters @xmath68 , @xmath69 , @xmath70 and @xmath71 , obtained from winbugs with target @xmath41 ( dotted ) , @xmath33 ( dashed ) and using our algorithm ( vertical lines ) .",
    "our algorithm has a satisfactory acceptance rate and a quickly decreasing autocorrelation function .",
    "the effective sample sizes are shown in table ( [ tabla - ess - breast ] ) .",
    "the results show that our method converges faster than the chains obtained with winbugs . regarding the computational speed , winbugs and our mcmc algorithm took seven seconds",
    ". table ( [ tabla - res - breast ] ) shows the estimation of the risk ratios obtained with our mcmc algorithm .",
    "we use the data from a 1986 cohort study conducted at the baystate medical center , springfield massachusetts , see @xcite .",
    "the study was designed to identify risk factors associated with an increased risk of low birth weight ( weighing less than 2500 grams ) .",
    "data were collected on 189 pregnant women , 59 of whom had low birth weight infants .",
    "we have studied the association between the low birth weight and uterine irritability ( ui : yes / no ) , smoking status during pregnancy ( smoke : yes / no ) , mother s race ( race : white , black , other ) , previous premature labours ( ptl@xmath72 : yes / no ) , and mother s age ( age : @xmath73 , ( 18,20 ] , ( 20,25 ] , ( 25,30 ] and @xmath74 ) .    figures ( [ fig1-pesonacer ] ) and ( [ fig2-pesonacer ] ) , first row , show the autocorrelation functions for the parameters @xmath75 , @xmath76 , obtained from winbugs with target @xmath41 ( dotted ) , @xmath33 ( dashed ) and using our algorithm ( vertical lines ) .",
    "the effective sample sizes are shown in table ( [ tabesspesonacer ] ) .",
    "again , the results show that our method converges faster than winbugs ( regarding the computational speed , our mcmc algorithm and winbugs took 20 seconds ) .",
    "table ( [ tabsummarypesonacer ] ) shows the estimates of the risk ratios obtained with our mcmc algorithm .",
    "we have simulated data form the log - binomial regression model @xmath77 where @xmath78 and @xmath79 has been simulated as follows . for @xmath80",
    "* @xmath81 where @xmath82 for @xmath83 , @xmath84 for @xmath85 and the distribution of @xmath86 is the bernoulli distribution @xmath87 * we have simulated @xmath88 from a multivariate normal distribution with mean @xmath89 , @xmath90 and @xmath91 .",
    "then we have calculated @xmath92 and @xmath93 , @xmath83 , and @xmath94 .",
    "finally , @xmath95    the value of the parameters @xmath96 and @xmath97 used to simulate the data @xmath28 were @xmath98 and @xmath99 respectively .",
    "thus , @xmath100 may represent an exposure , @xmath101 , @xmath102 , @xmath103 and @xmath104 confounders and @xmath105 , @xmath106 and @xmath107 predictors . with this value of @xmath9",
    "we have computed @xmath24 and we have simulated the outcome @xmath108 , @xmath109 , obtaining @xmath110 .",
    "figure ( [ fig1 ] ) shows the autocorrelation functions obtained from winbugs with target @xmath41 ( dotted ) , @xmath33 ( dashed ) and using our algorithm ( vertical lines ) .",
    "for some parameters the autocorrelation functions obtained from winbugs are virtually identical , and for other parameters , winbugs with target @xmath33 converges faster than winbugs with target @xmath41 .",
    "for all the parameters our proposed mcmc method produced a satisfactory acceptance rate ( see figures [ fig2 ] and [ fig3 ] ) and it was superior to the method implemented with winbugs .",
    "regarding the computational speed , our mcmc algorithm took between 86 and 87 seconds while winbugs took between 163 and 193 seconds .",
    "the effective sample sizes are shown in table ( [ tabla_2 ] ) .",
    "table ( [ tabsummaryejemplosimulado ] ) shows the estimation of the risk ratios obtained with our mcmc algorithm .",
    "the posterior mean and the 95% ci for @xmath68 were 0.379 and ( 0.354 , 0.405 ) , respectively .",
    "despite recent efforts made by several authors , logistic regression is still used frequently in cohort studies and clinical trials with common outcome and equal follow - up times , even if one wants to communicate a risk ratio .",
    "it is well known that the more frequent the outcome is the more the odds ratio overestimates the risk ratio when it is greater than 1 ( or underestimates it if it is less than 1 ) .    if one wants to estimate an adjusted risk ratio , the log - binomial model is preferable to the logistic one but the constrained parameter space makes difficult to find the maximum likelihood estimate .",
    "bayesian methods implemented with winbugs can work with a constrained parameter space in a natural way .",
    "moreover , @xcite have shown that bayesian methods produce smaller mean squared errors than likelihood based methods .",
    "however , winbugs can lead to a high monte carlo error .    to avoid this drawback ,",
    "we have proposed an efficient mcmc algorithm to estimate risk ratios from a bayesian point of view using log - binomial regression models .",
    "our method is based on two strategies : first , a reparameterization based on a poisson model , and second , an appropriate cauchy instrumental distribution .",
    "it converges to the posterior distribution faster than the methods implemented with winbugs .",
    "regarding the computational speed , our mcmc algorithm is similar to winbugs for moderate sample sizes and faster for large sample sizes .",
    "furtheremore , the possibility of easily carrying out the estimations using our r functions is an important added value .",
    "this research was supported by the sneca foundation programme for the generation of excellence scientific knowledge under project 15220/pi/10 .",
    "chu , h. , cole , sr .",
    "estimation of risk ratios in cohort studies with common outcomes : a bayesian approach .",
    "epidemiology , 21 : 855 - 862 .",
    "deddens , j.a . , petersen , m.r . ,",
    "lei , x. ( 2003 ) .",
    "estimation of prevalence ratios when proc genmod does not converge .",
    "proceedings of the 28th annual sas users group international conference , seattle , washington .",
    "deddens , j.a . , petersen , m.r .",
    "( 2008 ) approaches for estimating prevalence ratios .",
    "occupational and environmental medicine , 65:501 - 506 .",
    "greenland , s. ( 2004 ) .",
    "model - based estimation of relative risks and other epidemiologic measures in studies of common outcomes and in case - control studies .",
    "american journal of epidemiology , 160 : 301305    hosmer , d. w. and lemeshow , s. ( 2000 ) .",
    "applied logistic regression , 2nd edition .",
    "new york : john wiley and sons .",
    "mcnutt , la .",
    ", wu , c. , xue , x. and hafner , jp . ( 2003 ) .",
    "estimating the relative risk in cohort studies and clinical trials of common outcomes .",
    "american journal of epidemiology , 157 : 940943 .",
    "petersen , m.r .",
    ", deddens , j.a .",
    "re : `` easy sas calculations for risk or prevalence ratios and differences '' .",
    "american journal of epidemiology,163:1158 1159 .",
    "spiegelman , d. and hertzmark , e. ( 2005 ) .",
    "easy sas calculations for risk or prevalence ratios and differences .",
    "american journal of epidemiology , 162:199200 .",
    "a modified poisson regression approach to prospective studies with binary data .",
    "american journal of epidemiology , 159:702706 .",
    "x<<-model.ini$x;n<<-nrow(x);beta = model.ini$coeff sigma<<-summary(model.ini)$cov.unscaled l<<-chol(sigma ) z<<-x%*%t(l ) model.ini.0<<-glm(y ~ z-1,family = poisson , x = true ) theta.hat<<-solve(t(l))%*%beta;k<<-ncol(z )                datos<-rbind(cbind(rep(1,12),rep(1,12),c(rep(1,2),rep(0,10 ) ) ) , cbind(rep(1,55),rep(2,55),c(rep(1,5),rep(0,50 ) ) ) , cbind(rep(2,22),rep(1,22),c(rep(1,9),rep(0,13 ) ) ) , cbind(rep(2,74),rep(2,74),c(rep(1,17),rep(0,57 ) ) ) , cbind(rep(3,14),rep(1,14),c(rep(1,12),rep(0,2 ) ) ) , cbind(rep(3,15),rep(2,15),c(rep(1,9),rep(0,6 ) ) ) )                                    , model ( [ toy ] ) .",
    "autocorrelation functions and traces obtained from winbugs ( first row , based on @xmath122 , second row , based on orthogonal covariates , third row , based on @xmath40 ) , and using our algorithm ( last row ) . ]    , model ( [ toy ] ) .",
    "autocorrelation functions and traces obtained from winbugs ( first row , based on @xmath122 , second row , based on orthogonal covariates , and third row , based on @xmath40 ) , and using our algorithm ( last row ) . ]    , @xmath69 , @xmath70 and @xmath71 from left to right .",
    "first row : autocorrelation functions obtained from winbugs with target @xmath41 ( dotted ) and @xmath33 ( dashed ) ; and using our algorithm ( vertical lines ) .",
    "second row : posterior densities obtained from winbugs with target @xmath33 ( dashed ) and obtained with our algorithm ( solid ) .",
    "third row : traces based on our algorithm . ]    , @xmath123 from left to right .",
    "first row : autocorrelation functions obtained from winbugs with target @xmath41 ( dotted ) and @xmath33 ( dashed ) ; and using our algorithm ( vertical lines ) .",
    "second row : posterior densities obtained from winbugs with target @xmath33 ( dashed ) and obtained with our algorithm ( solid ) .",
    "third row : traces based on our algorithm . ]    , @xmath124 from left to right .",
    "first row : autocorrelation functions obtained from winbugs with target @xmath41 ( dotted ) and @xmath33 ( dashed ) ; and using our algorithm ( vertical lines ) .",
    "second row : posterior densities obtained from winbugs with target @xmath33 ( dashed ) and obtained with our algorithm ( solid ) .",
    "third row : traces based on our algorithm . ]",
    "4299.5 & 5058.5 & 4930.9 & 4979 & 4466.4 & 5495.6 & 5546.3 & 5677.3 & 5557 + 1911 & 1854.2 & 1822.1 & 2002 & 1899.7 & 1951.8 & 1914.5 & 2052 & 2136 + 1405.4 & 1684.7 & 1934.6 & 1818 & 1841.3 & 1799.6 & 975 & 1141.7 & 2050 +"
  ],
  "abstract_text": [
    "<S> in cohort studies binary outcomes are very often analyzed by logistic regression . </S>",
    "<S> however , it is well - known that when the goal is to estimate a risk ratio , the logistic regression is inappropriate if the outcome is common . in these cases , </S>",
    "<S> a log - binomial regression model is preferable . on the other hand , </S>",
    "<S> the estimation of the regression coefficients of the log - binomial model is difficult due to the constraints that must be imposed on these coefficients . </S>",
    "<S> bayesian methods allow a straightforward approach for log - binomial regression models , produce smaller mean squared errors and the posterior inferences can be obtained using the software winbugs . </S>",
    "<S> however , the markov chain monte carlo ( mcmc ) methods implemented in winbugs can lead to a high monte carlo error . to avoid this drawback </S>",
    "<S> we propose an mcmc algorithm that uses a reparameterization based on a poisson approximation and has been designed to efficiently explore the constrained parameter space .    _ * keywords * _ : bayesian inference , binomial regression models , epidemiology , markov chain monte carlo , risk ratio . </S>"
  ]
}