{
  "article_text": [
    "gravitational collapse is a common feature of many gaseous astrophysical systems , and specialized methods are required in order to follow collapse in time - dependent hydrodynamic simulations .",
    "these numerical issues are particularly important in studies of star formation .",
    "as gravitational collapse develops , material converges to a central point from all directions to create a large density peak . for simulations that follow the formation of multiple self - gravitating prestellar cores within large - scale clouds , the true structures that form as a consequence of core collapse are generally so small that the profile surrounding each collapse center becomes un - resolvable for grid - based codes , even if adaptive mesh refinement ( amr ) is adopted .",
    "for example , stellar radii are @xmath0 , whereas that of a giant molecular cloud ( gmc ) is @xmath1 . with a dynamic range @xmath2 ,",
    "it is not possible to spatially resolve a central post - shock protostar at the same time as capturing the large scale flows that lead to its formation , when multiple collapse centers are simultaneously present . when the central density in a collapsing region becomes too large , gradients in gas pressure and gravity from the central cell to the neighboring cells",
    "can not be resolved , such that correct mass and momentum fluxes can not be computed by the numerical solvers .",
    "a simulation can not continue under these conditions .",
    "the huge dynamic range involved in gravitational collapse can also lead to difficulties due to the time step restriction by the courant condition @xcite .",
    "the time - scale set by self - gravity varies @xmath3 , so that an increase by a factor of @xmath4 in density relative to ambient conditions ( as would apply within the centers of collapsed cores ) implies a decrease in the time step by a factor @xmath5 .",
    "a practical way to deal with the above difficulties , for numerical models that are focused on large - scale dynamics , is to establish a minimum spatial resolution and introduce sink particles .",
    "when gravitational collapse occurs , the unresolved high density peaks are eliminated from the grid and replaced with sink particles .",
    "after a sink is created , the material can flow smoothly toward the center of collapse , with the profile remaining well resolved near the sink .",
    "subsequent to the creation of sinks , gas and sink particles are integrated simultaneously , including mutual gravitational forces .",
    "provided that the flow onto sinks is supersonic , introducing them will not affect the dynamics of the upstream flow .",
    "accretion onto sinks should be implemented in a way that conserves total mass and momentum of the system .",
    "@xcite first introduced sink particle techniques in a smoothed particle hydrodynamics ( sph ) code . @xcite and @xcite implemented sink particles in the grid - based codes orion and flash , respectively , and extensively discuss tests of their methods . in the past several years",
    ", similar implementations have been made for a number of other well - established codes , such as enzo @xcite , ramses @xcite , and gadget @xcite .",
    "@xcite , @xcite , @xcite , @xcite adopt the same methodology , including the criteria for creation of sink particles and the accretion rate onto sink particles .",
    "@xcite used an early version of the implementation in flash described by @xcite . in these implementations , @xcite , @xcite , @xcite , @xcite ,",
    "@xcite mainly focus on star formation simulations ; @xcite , @xcite create sink particles to replace super - massive black holes in cosmological simulations .    in this paper",
    ", we present details of our implementation and tests of sink particles in the grid - based code _",
    "athena _ @xcite . in section 2",
    ", we begin by introducing the eulerian code and outlining our methods for implementing sink particles .",
    "we physically motivate criteria we adopt for creating sinks , and describe our methods for treating gravity , accretion , merging , and orbit integration of sink particles . in section 3 , we present a series of tests of our methods .",
    "these include orbits of two particles , collapse of self - gravitating spheres with a range of initial conditions ( including self - similar solutions , and converging supersonic flows ) .",
    "we demonstrate galilean invariance of our methods . to illustrate the capabilities of our methods for typical applications , in section 4 we consider evolution of a turbulent medium with a large - scale supersonic flow converging to create a dense slab .",
    "we follow the fragmentation of the slab into multiple cores , and the subsequent evolution of the system as sink particles are created and grow .",
    "finally , section 5 summarizes our presentation .",
    "for the simulations presented in this paper we use the three - dimensional ( 3d ) code _ athena _",
    "( @xcite ) . _",
    "athena _ is a grid - based code that uses higher order godunov methods to evolve the time - dependent equations of compressible hydrodynamics and magnetodynamics ( mhd ) , allowing for self - gravity , radiative heating and cooling , and other microphysics , on either a cartesian or cylindrical @xcite grid . in this paper",
    ", we only refer to the hydrodynamics and self - gravity capabilities of the code , with cartesian coordinates .",
    "the hydrodynamics equations solved are the mass , momentum , and energy equations : @xmath6 @xmath7 @xmath8 = \\rho\\textbf{\\em v } \\cdot",
    "\\mathbf{\\nabla}(\\phi + \\phi_{\\rm ext}),\\ ] ] and the poisson equation , @xmath9 where @xmath10 is a diagonal tensor with @xmath11 , and @xmath12 is the gas pressure , @xmath13 is the total energy density @xmath14 @xmath15 is the gravitational potential of the gas , and @xmath16 is an external gravitational potential . in this paper , we shall consider isothermal flows , in which the energy equation ( [ eng_eq ] ) is replaced by the relation @xmath17 . here",
    "@xmath18 is the square of the isothermal sound speed , for @xmath19 the temperature and @xmath20 the mean mass per - particle .    to solve the poisson equation under varying boundary conditions , we adopt two different gravity solvers . for periodic boundary conditions in all directions",
    ", we use the fast fourier transformation ( fft ) method . for boundary conditions that are periodic in - plane @xmath21 and open in the @xmath22-direction",
    ", we use the fft method developed by @xcite . for open boundaries in all directions ,",
    "we use a new solver based on the method described in @xcite , which employs ffts in a zero - padded domain eight times as large as the computational box ( see appendix ) .    _",
    "athena _ also includes static mesh refinement ( smr ) , but we do not refer to these capabilities in the current work .",
    "implementation of our sink particle algorithm with smr will be discussed in a future publication .",
    "different criteria for the creation of sink particles have been discussed in the past decade .",
    "a density threshold @xcite is the simplest criterion for creation of a sink particle .",
    "high density regions may form in astronomical systems as a consequence of different physical processes , most importantly strong supersonic shocks and gravitational collapse .",
    "if a high density region is not gravitationally bound , it might subsequently be destroyed by large scale motions that induce rarefactions .",
    "thus , care must be taken to select an appropriate density threshold , and to include additional criteria that must be satisfied before creating sink particles @xcite .    using amr simulations",
    ", @xcite showed that grid - scale numerical noise could grow to cause artificial self - gravitating fragmentation if the local jeans scale ( @xmath23 ) is not resolved by at least four cells .",
    "this criterion gives a density threshold @xmath24 for @xmath25 the simulation cell size .",
    "the implementation of @xcite sets the threshold density for sink particle creation in a cell to @xmath26 .",
    "@xcite and @xcite adopt criteria that first checks whether density exceeds a threshold density and then checks if the zone in question is a local gravitational potential minimum .",
    "@xcite and @xcite perform a series of checks including a density threshold check , a converging flow check , a local gravitational potential minimum check , and additional checks that evaluate whether a region is strongly self - gravitating .",
    "the converging - flow check of @xcite requires that the flow surrounding a candidate zone is converging along all directions , stricter than the condition @xmath27 .    for simulations involving gravitational collapse , a sink particle",
    "should only be created at the center of a region that is collapsing . as the sink particle creation criteria of @xcite do not specifically limit particle creation to a single collapse center",
    ", they adopt the approach of merging the spurious sink particles within a given collapsing region so that one final sink particle is created inside each potential well .",
    "the extra criteria checks for a local potential minimum or a gravitationally bound state adopted by @xcite , @xcite and @xcite further limit the initial creation of sink particles , so that only one sink particle is created for each local potential minimum .",
    "we shall adopt similar criteria to @xcite to ensure that single sink particles are created inside regions that are collapsing .",
    "our choice of density threshold , @xmath28 , for sink particle creation is motivated by the well - known solution for self - gravitating collapse first obtained by @xcite and @xcite ( hereafter lp ) .",
    "for collapse of an initially - static , gravitationally - unstable isothermal sphere , lp showed that a singular density profile @xmath29 is reached .",
    "numerical studies with a range of initial conditions have shown that the lp asymptotic solution is in fact an `` attractor '' for isothermal core collapse , no matter how the collapse is initiated @xcite .",
    "some of the above models start from static unstable configurations , and others from static , stable configurations that are subjected to an imposed compression , either from enhanced external pressure or a converging velocity field , or a core - core collision .",
    "these models all show that collapse starts from outside and propagates in , and that the central velocity is comparable to the value @xmath30 at the time of singularity formation , when the density profile approaches the inverse - square lp asymptotic solution @xmath31 .",
    "@xcite showed that the collapse of cores forming inside converging supersonic flows also approaches the lp solution , whether the flow is spherically symmetric or is turbulent , with no special symmetry .",
    "@xcite also showed that the duration of collapse ( starting when the core is @xmath32 times the ambient density ) is typically a free - fall time at the mean core density .",
    "when collapse occurs , the lp profile would result in a density @xmath33 at a distance @xmath34 from the center .",
    "we take this as the density threshold ( @xmath28 ) for sink particle creation .",
    "we note that this value is 14.4 times the value @xmath26 of equation ( [ rho_tr ] ) .",
    "a potential concern is that this might lead to artificial fragmentation .",
    "however , we find ( see section 4.3 ) that using the threshold from equation ( [ lp_rho ] ) , no additional particles are created compared to cases in which we instead adopt equation ( [ rho_tr ] ) ( @xmath26 ) for the sink particle density threshold .",
    "after a sink particle is created , all cells centered at @xmath35 become part of a `` sink region '' ( see below ) , such that the density of cells exterior to the sink region satisfy the truelove criterion , with @xmath36 .",
    "our standard choice of density threshold is given by equation ( [ lp_rho ] ) .",
    "however , we have also tested other choices , as discussed in section 4.3 , and found similar results .      surrounding each sink",
    "particle is a sink control volume where the gas flow can not be resolved . as a sink particle moves from one cell to another , the control volume moves with the sink particle , such that the sink particle is always located within the central zone of the cubic control volume .",
    "the sink control volume is generally set to @xmath37 although we find similar results for value @xmath38 and @xmath39 .",
    "the effective radius of the control volume is @xmath40 , with @xmath41 for a control volume @xmath42 .",
    "as gravity is unresolved at the same scale , the same control volume is adopted for the particle - mesh algorithm we use to compute the sink particle s gravity ( see section 2.4 ) .",
    "once a control volume has been created , it acts similar to ghost zones bounding the simulation domain . at every time step",
    ", the density , momentum , and energy of the cells inside each control volume are reset using outflow boundary conditions from the active grid ( i.e. via extrapolation from surrounding non - sink zones ) .",
    "if the density of a cell with integer indexes @xmath43 exceeds @xmath28 , and its distance to any existing sink particle is larger than @xmath44 , a `` temporary '' control volume is created surrounding it .",
    "this temporary control volume has same size as the real control volume for a sink particle .",
    "we then check if the central cell is a potential minimum inside this control volume @xcite .",
    "if the potential minimum test is satisfied , we apply further tests .      as in @xcite but less restrictive , we test whether the candidate sink cell at the center of the control volume is surrounded by a converging flow : @xmath27 . under most circumstances , the tests for high density , a gravitational potential minimum , and a converging flow would guarantee the region surrounding this cell is under gravitational collapse .",
    "however , under the special circumstance of a strong shock produced by a converging flow , all of the above criteria might be met , but a region would still disperse if the converging flow were not sustained until the region becomes gravitationally bound @xcite ; this would occur when the volume of the high - density post - shock region becomes sufficiently large .      as a last check before sink particle creation , we test whether the total energy inside the temporary control volume is negative @xcite : @xmath45 where @xmath46 is the gravitational potential energy , @xmath47 is the thermal energy , and @xmath48 is the kinetic energy .",
    "the control - volume gravitational energy is calculated as @xmath49 where @xmath50 is the potential difference between the cell with integer index @xmath43 and the potential at the `` edge '' of the local potential well , @xmath51 . for @xmath51 , we compute the average value of the potential in all zones immediately outside the temporary control volume .",
    "the thermal energy and kinetic energy are calculated as follows : @xmath52    @xmath53    here @xmath54 is the velocity of the center of mass of the control volume .",
    "if a cell passes all the checks above , a sink particle is created and a permanent control volume is tagged around it .",
    "the initial mass and momentum of the sink particle are set by the sums over all zones within the control volume .",
    "note that the cells within the sink control volume are not modified either at the moment of sink creation or by subsequent accretion because they are effectively ghost zones ; their values are updated at the same time as other boundary conditions ( see section 2.2.2 ) .",
    "also , as noted above , the sink control volume is redefined whenever the sink particle moves to a new zone within the computational grid .",
    "however , the particle can move within a given cell without redefining the sink control volume .",
    "a key aspect of any sink particle implementation is to ensure that the gas accretion rate onto sinks is accurate .",
    "@xcite use the bondi - hoyle accretion formula to approximate the accretion rate , with the sound speed and flow velocity set by host cell values .",
    "the density @xmath55 in the bondi - hoyle formula is set based on the mean density in a local accretion zone ( see their section 2.4 ) .",
    "@xcite take a simpler approach , removing mass from any cell within the control volume to the sink particles if the density in that cell exceeds @xmath26 .",
    "motivated by the concept of the sink region as `` internal '' ghost zones , in our algorithm the accretion rates of mass and momentum to each sink particle are calculated based on the fluxes returned by the riemann solver at the interfaces between the control volume and the surrounding computational grid .",
    "tests to confirm that the accretion rate agrees with analytic solutions are discussed in section 3 .",
    "as sink particles cross the border of one cell to enter the next cell , the mass and momentum differences between the new and old ghost zones are combined with the fluxes returned by the riemann solver to conserve the mass and momentum of the whole simulation domain , including both gas and particles .",
    "once they have been created , sink particle position and velocities must be integrated in time . to do this",
    ", we use the leapfrog method ( e.g. * ? ? ?",
    "* ) , with updates over time @xmath56 given by : @xmath57 or @xmath58 here @xmath59 and @xmath60 are the `` drift '' and `` kick '' operators respectively , and @xmath59 updates a particle s position without changing its momentum , while @xmath60 does the opposite ; @xmath61 is the time evolution operator for an interval @xmath56 . both drift - kick - drift ( dkd , equation ( [ dkd ] ) ) and kick - drift - kick ( kdk ,",
    "equation ( [ kdk ] ) ) schemes are implemented .",
    "for all the simulations presented in this work , the kdk scheme is adopted because it is superior to the dkd scheme for variable time step @xcite .",
    "the time step of the whole simulation is also restricted by the sink particle velocities : sink particles can not travel further than one grid zone in one time step .",
    "velocity updates of the sink particles are set based on the gravitational field at the particle s ( smoothed ) location .",
    "this gravitational field must include a contribution from all the other particles , as well as from the gas .",
    "we use the triangular - shaped - cloud ( tsc ) scheme @xcite to calculate the gravity produced by each particle as well as the force each particle feels . in this method the mass of each sink particle is smoothed to the @xmath62 cells surrounding it , where @xmath63 is the number of cells used in one direction .",
    "the weights along the @xmath64 direction are expressed as follows : @xmath65 here @xmath66 is the @xmath64-distance between the sink particle and the center of the cell where it resides along the @xmath64 dimension .",
    "the index @xmath67 ranges from @xmath68 to @xmath69 and the cell with @xmath70 is where the sink particle resides .",
    "taking @xmath71 , equation ( [ pm_weight ] ) reduces the tsc weights described in @xcite : @xmath72 analogous weights are defined along the @xmath73 and @xmath22-dimensions , giving @xmath74 and @xmath75 .    the weight of the mass in any of the @xmath62 zones of the smoothing volume surrounding the particle is a product of the weights from the @xmath64 , @xmath73 , and @xmath22 dimensions .",
    "after the weights of a sink particle are computed , the particle s mass @xmath76 is applied to the grid . within each particle",
    "s smoothing volume , the particle s effective density at zone @xmath77 is given by @xmath78 .",
    "outside of the sink s control volume , the density is equal to that of the gas .",
    "after the combined gas+particle density is defined , the solution @xmath15 of the poisson equation is obtained via ffts ( using the fftw package , see www.fftw.org ) . for each zone within the sink control volume , the gravitational field @xmath79",
    "is computed taking differences of the potential . the gravitational force on each sink particle is computed using the same weights as in equation ( [ pm_weight ] ) : @xmath80 where @xmath81 and @xmath82 run from @xmath68 to @xmath69 .    with a tsc smoothing volume of @xmath62 zones ,",
    "the effective radius for smoothing by the tsc algorithm is @xmath83 . for @xmath84 and @xmath85 ,",
    "@xmath86 is @xmath87 and @xmath88 respectively . with larger @xmath86 ,",
    "sink particles masses are smoothed to a larger volume , and the gravity is softened more .",
    "a smaller value of @xmath86 gives more accurate gravity near a particle .",
    "however , the hydrodynamic fluxes are better resolved if the radius @xmath89 of the sink control volume ( see section 2.2.2 ) is larger .",
    "we have tested different combinations of @xmath89 and @xmath86 with @xmath90 for the test problems described in section 3.1 and 3.2 .",
    "we find that different @xmath89 give nearly the same accretion rate .",
    "to maximize resolution , we therefore adopt @xmath71 and @xmath91 as our standard choice .",
    "sink particles in our algorithm represent unresolved star / disk / envelope structures . because the gas structure and gravity is not resolved within the control volume of each sink particle , the detailed interaction of star / disk / envelope systems that collide or pass near each other can not directly be followed .",
    "we therefore take a conservative approach and merge two sink particles whenever their control volumes overlap .",
    "a new sink particle is created at the center of mass of the two previous sink particles , with total mass and momentum conserved .",
    "we note that provided the effective mass distribution of each sink remains spherically - symmetric and concentrated at a very small scale , it would be safe to adopt less - strict merger criteria in methods that compute interparticle forces directly rather than using particle - mesh gravity ; in this case close particle - particle interactions require sub - time - stepping ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . because torques on the gas are not well resolved when the sink region has only @xmath92 zones , we do not presently track the spin angular momentum of the sink particles",
    "to test the tsc algorithm and the leapfrog integrator , we consider a problem in which two particles with equal mass orbit their common center in circular orbits .",
    "the initial circular speed of the two particles is @xmath93 , where @xmath94 is the gravitational constant , @xmath95 is the mass of each sink particle , and @xmath96 is the distance between two sink particles .",
    "the gravity between sink particles and gas is disabled , so that sink particles only feel gravity from each other .",
    "figure [ fig : circular ] shows the trajectory of one particle for @xmath97 orbits for @xmath98 ( top panels ) and @xmath99 ( bottom panels ) with resolutions @xmath100 and @xmath101 from left to right . here , @xmath102 is the simulation box size , corresponding to either 5 or 3.3 times the interparticle separation @xmath96 ( which is the semimajor axis for the reduced - particle kepler orbit ) .",
    "vacuum boundary conditions are used for the gravity solver .",
    "as long as the gravity is well resolved , the combination of the tsc scheme and leapfrog integration gives accurate orbits .",
    "for @xmath98 , the radius of the orbit is @xmath103 and @xmath104 for resolution @xmath100 and @xmath101 respectively . for @xmath105 resolution with @xmath106 ,",
    "the cubic smoothing volumes for each particle are separated by only @xmath107 zones , such that the gravitational potential is not well approximated by a point mass . for resolution @xmath108 and @xmath101 ,",
    "this distance ranges @xmath109 and @xmath110 respectively .",
    "we find that for @xmath108 , the orbits are a bit coarse , whereas for @xmath101 , the orbits are nearly perfect .",
    "correspondingly , for the @xmath111 cases , the orbit radius is @xmath112 and @xmath113 at resolution @xmath100 and @xmath101 , with circular orbits well represented at the higher resolutions . we conclude that provided the orbit radius is resolved by @xmath114 zones , quite accurate orbits are obtained , with somewhat lower quality orbits at smaller separations . however , even for orbit radii as small as 3 zones ( or @xmath115pc for typical simulations of core / star formation in molecular clouds ) , orbits are approximately circular . by comparison , we note that @xcite have found that resolution of a vortex in their hydrodynamic simulations on a cartesian grid requires a radius of 15 grid cells .      to confirm that our algorithms yield the correct accretion rate , we compare our numerical results with analytic solutions .",
    "in particular , we compare to the family of self - similar accretions solutions analyzed by @xcite .",
    "the density profile for a generalized singular isothermal sphere is @xmath116 for @xmath117 , equilibrium is not possible because gravity exceeds the gas pressure gradient everywhere ; for these initial conditions , a sphere would globally collapse everywhere .",
    "the case @xmath118 with zero velocity everywhere corresponds to an unstable hydrostatic equilibrium .",
    "@xcite analyzes a family of self - similar solutions in which the density profile in the outer parts approaches equation ( [ rho_shu ] ) , while the inner part approaches a free - fall profile with @xmath119 .",
    "the outer part has @xmath120 , while in the inner part the velocity approaches free - fall @xmath121 . for any value of @xmath122 ,",
    "the central accretion rate is constant , such that the central mass @xmath123 , and we can define a dimensionless accretion rate @xmath124 .",
    "we have tested a series of values of @xmath122 ranging from @xmath125 to @xmath126 , the same as the values in table 1 of @xcite .",
    "the initial density and velocity profiles are the solution of equations ( 11)-(12 ) in @xcite , obtained using a four - step runge - kutta integration scheme . for code units ,",
    "we adopt an arbitrary density @xmath127 , together with length scale , @xmath128 and time scale @xmath129 . for all of the tests in this section ,",
    "the simulation domain size is @xmath130 , and the resolution is @xmath131 .",
    "vacuum boundaries are used for the gravity solver .",
    "the initial radial density and velocity profiles are truncated at @xmath132 . outside this radius ,",
    "the initial density is set to @xmath133 , and the initial velocity is set to zero . to convert the self - similar solutions to initial density and velocity profiles input to the simulation , we choose an initial time @xmath134 such that in the case @xmath135 , the initial radius of the expansion wave is 11% of the box size and 29% of the initial radius of the sphere . in the case",
    "@xmath135 , the total mass of the sphere within @xmath136 is @xmath137 .",
    "a sink particle is introduced at the center of the sphere at the beginning of the simulation , with its initial mass set to the mass of the initial profile within @xmath138 ( equations ( 8) , ( 10 ) in @xcite ) .",
    "note that the uniform density outside the sphere leads to `` outside - in '' collapse because of the imbalance of gravity and gas pressure at the truncation radius",
    ". this process will not affect the initial `` inside - out '' accretion to the central sink particle , however .",
    "figure [ fig : accretion_hist ] shows the accretion history of the central sink particle for the cases @xmath139 ( crosses ) and @xmath126 ( open circles ) .",
    "the solid lines are the analytic solutions from shu ( 1977 ) .",
    "before effects from the outer boundary conditions begin to affect the accreting region , the simulation evidently reproduces the analytical solutions extremely well . for the case",
    "@xmath135 , the particle mass at @xmath140 , near the end of the linear stage , has reached 46% the sphere s initial mass , increasing by a factor three from its initial value . for each value of @xmath122 , we compute the accretion rate in the simulation using a fit to the sink particle s mass versus time during the stage when this evolution is linear .    figure [ fig : singular_accretion ] shows the accretion rates for models based on shu s solutions with different values of @xmath122 .",
    "the line shows the values from the analytic solution of @xcite , and the solid black dots are based on measurements from our numerical simulations .",
    "the 3d simulations reproduce nearly exactly the predicted accretion rate from the analytic solutions .",
    "figure [ fig : singular_2d_structure ] shows a sample cross - section of the density and velocity field near the center of the collapsing singular sphere for @xmath139 . since @xmath122 is close to @xmath141 , the simulated sphere recovers shu s famous `` expansion - wave '' solution : the outer part retains a static singular isothermal equilibrium profile before the expansion wave arrives , and the inner part is free - falling towards the center . figure",
    "[ fig : singular_rhov_profile ] shows the radial density profiles and velocity profiles from the simulation at different instants during the collapse .",
    "the filled circles are the profiles from the numerical simulation and the solid lines are the corresponding analytic solutions .",
    "our simulation reproduces the analytic solutions .",
    "the `` expansion wave '' is clearly seen from both the density and velocity profiles . in both density and velocity profiles",
    ", it is seen that gas very near the boundaries collapses , and the outer density is slightly altered from @xmath142 .",
    "this behavior is due to conditions near the boundaries , but this process does not affect the collapse in the interior .      to confirm that the accretion is properly computed for moving particles , we consider tests in which both the particle and surrounding gas are initialized with a bulk flow across the grid .",
    "the initial conditions of these models are exactly same as the @xmath139 case in section 3.2 , but with an additional uniform bulk flow of speed @xmath143 and @xmath144 . if the update of the mass and momentum of the sink particle is correct , it will continue to move with the surrounding gas sphere at the same velocity",
    ". the mass accretion rate onto the sink particle should also be the same for different bulk flow speeds .",
    "for this problem , periodic boundaries are adopted for both gas and the gravity solver .",
    "for all of the tests in this section , the simulation size is @xmath130 , and the resolution is @xmath131 .",
    "we note that the boundary conditions in section 3.2 are open , different from what we adopt in this section . here",
    ", we adopt periodic boundary conditions so that the sphere may pass through the boundary of the simulation domain ( for large mach number cases ) .",
    "because of the difference in boundary conditions , the accretion rate is different from that in section 3.2 ; however we shall show that the accretion rates are all consistent with each other for different mach numbers .",
    "figure [ fig : lp_mv ] shows the speed and mass of the sink particle versus time , for all tests . for the case of zero bulk advection ,",
    "the speed of the particle remains zero all the time . for @xmath145 ,",
    "the mean speed of the sink particle agrees with the bulk speed , with small oscillations . during an interval @xmath146 ,",
    "the time for the sink particle to cross a zone , the control volume does not move . however , as discussed in section 2.2.2 , the sink control volume must be reset when the particle crosses a zone boundary . during the time interval @xmath146 ,",
    "the mass and momentum fluxes into the control volume are not exactly symmetric , because the gravitational potential is not symmetric if the particle is offset from its zone center .",
    "the downwind material enters the control volume with relatively larger momentum than the upwind material , and addition of net positive momentum accelerates the sink particle .",
    "the speed of the sink particle therefore temporarily increases . as the particle crosses the border of one cell to enter the next cell ,",
    "the sink control volume is shifted , and mass and momentum differences from cells entering and leaving the control volume are applied to the particle to conserve mass and momentum . as a consequence ,",
    "the particle s speed is reduced immediately after crossing a cell edge . at late times , the fractional change in the momentum becomes small , so the oscillation amplitude drops .",
    "figure [ fig : lp_mv ] shows that the mass of the sink particle increases at the same rate for all the tests , at varying @xmath147 . at early stages , before material originating near the sphere s boundaries accretes to the sink particle , differences in the accretion rate are completely negligible , and and differences remain very small even after material originating near the boundaries reaches the center .",
    "we conclude that our sink particle algorithm satisfies galilean invariance , with the accretion rate the same whether or not the flow and the grid are in relative motion .",
    "to test our algorithm for the the creation of a sink particle , together with the accretion after formation , we run 3d simulations of the evolution of a bonnor - ebert sphere ( * ? ? ?",
    "* ; * ? ? ?",
    "* hereafter be ) and compare the results to a 1d spherically - symmetric simulation conducted with another code .",
    "we consider a be sphere with a radius slightly larger than the critical radius , @xmath148 for @xmath149 , where @xmath150 is the edge density .",
    "the density inside the sphere is everywhere twice as large as the equilibrium value .",
    "exterior the sphere , the density is set to @xmath151 .",
    "the initial velocity is everywhere set to zero for the initial conditions .",
    "the gas boundary conditions are outflow .",
    "the resolution is @xmath131 , and the box size is @xmath152 ^ 3 $ ] .",
    "figure [ fig : be_2d_structure ] shows the cross - section of the density and velocity field across the center of the be sphere immediately before the central sink particle is created .",
    "evidently , the inner part collapses inwards , following the `` outside - in '' collapse described by @xcite .",
    "because the outer boundary of the sphere is not in equilibrium ( for this isothermal simulation , we do not have a hot confining medium ) , the outer part of the sphere expands outwards at the same time . only the very late accretion to the sink particle",
    "is affected by the early expansion of the outer parts of the sphere .",
    "figure [ fig : be_mass_flux ] shows the accretion rate and the mass of the sink particle from our 3d simulation , in comparison with the 1d simulation of @xcite obtained with the _ zeus _ code .",
    "the solid lines are from the 3d simulation and the dashed lines are from the 1d simulation . the accretion rates immediately after the creation of the particle differ , but the accretion rates at later stages are almost exactly the same .",
    "the peak accretion rate is higher for 1d than 3d because it is measured closer to the sink particle ( 0.5 zones vs. 1.5 zones ) .",
    "in addition , the point of singularity formation can not be resolved as well on a 3d cartesian grid as 1d spherically - symmetric grid .",
    "however , it is evident that the 3d code captures the overall accretion history very well .    to further check the results of the model evolution , figure",
    "[ fig : be_rhov_comp ] compares the density and velocity profiles for 3d and 1d simulations at the instant of the sink particle creation .",
    "the density profiles both approach the larson - penston singular solution ( equation ( [ lp_den ] ) ) , while the velocity profiles approach the limit @xmath153 , in the inner part .",
    "figure [ fig : be_3d_rhov_profile ] shows the radial density and velocity evolution for the 3d simulation for this test .",
    "the solid lines show the profiles before the sink particle is created , the dashed lines show the profiles at the instant of the sink particle creation , and the dotted lines show the profiles during the envelope infall stage ( see * ? ? ?",
    "profiles are separated by time @xmath154 .",
    "the collapse of the inner part ( and the expansion of the outer part ) is clearly seen .",
    "the density approaches the singular lp profile @xmath142 ( equation ( [ lp_den ] ) ) at the instant of collapse , and the corresponding velocity profile is flat in the inner part , approaching @xmath155 .",
    "after the creation of the sink particle , the inner density and velocity profiles approach free - fall .",
    "@xcite presented a unified model for dense molecular core formation and evolution , based on spherically - symmetric simulations .",
    "in that work , dense cores are not present as either stable or unstable density concentration in the initial conditions , but are built by the convergence of supersonic flows .",
    "post - shock compressed gas accumulates over time in stagnant , shock - bounded regions .",
    "when the core accumulates enough mass , it becomes gravitationally supercritical and collapses , leading to formation of a protostar at the center .",
    "this is followed by a stage of infall of the envelope onto the protostar , and subsequent accretion of ambient material .    to ensure the accretion rate of sink particles is accurate for cores formed by supersonic flows , we run a simulation of a 3d spherical converging supersonic flow , and compare to the accretion rate obtained by @xcite using a 1d spherically - symmetric simulation .",
    "the initial density is uniform everywhere , with a value @xmath127 ( this represents a typical density within gmcs ) .",
    "the flow in the initial conditions converges to the center everywhere at mach @xmath141 .",
    "the size of the simulation box is @xmath156 .",
    "this size is chosen so that it is large enough for the post - shock compressed region to grow until it collapses .",
    "the simulation is run with @xmath131 cells .",
    "for the 1d spherical symmetric simulation , the initial density and velocity profiles are the same as 3d but the model is run with @xmath157 zones . for the 1d simulation , a sink cell is introduced at the center after collapse occurs , with an outflow boundary condition next to the sink cell @xcite .",
    "figure [ fig : cvg_mass_flux ] shows the accretion rate and the mass of the protostar versus time during the envelope infall stage , comparing the 3d and 1d simulation results .",
    "the accretion rate is nearly same for the two cases , and the mass history of the `` protostar '' is comparable . for the 1d simulation , the accretion rate will decrease to exactly the inflow value @xmath158 at late time . for 3d",
    "simulation , however , we can not create an ideal spherical converging flow given our cubic domain , such that the accretion rate decreases after @xmath159 .",
    "note that the peak of the accretion rate for the 1d model is smaller than the value in @xcite for mach @xmath141 , due to lower resolution here .",
    "the most generic configuration for converging supersonic flow is planar , and @xcite presented a set of 3d numerical simulations with this geometry  combined with turbulent perturbations  to study the core building and collapse .",
    "the models of @xcite represent a localized region within a giant molecular cloud , in which there is an overall convergence in the velocity field ( produced by the largest - scale motions in the cloud ) , combined with a turbulent power spectrum in which linewidth increases with size .",
    "since sink particle techniques were not employed in @xcite , each model simulation was stopped when the most evolved core collapsed . to demonstrate the capabilities for following multiple core collapse and evolution when sink",
    "particles are introduced , here we rerun a sample simulation from the @xcite suite .    as in @xcite",
    ", we adopt the isothermal approximation .",
    "the isothermal sound speed at a temperature @xmath19 is @xmath160 if the density within clouds were uniform , the spatial scale relevant for gravitational instability would be the jeans length @xmath161 evaluated at the mean density @xmath127 .",
    "the corresponding jeans mass is @xmath162 the jeans time at the mean cloud density is @xmath163 since we consider a planar converging flow , another relevant quantity is the total surface density integrated along the @xmath22 direction , @xmath164 for @xmath165 .    for this test",
    ", the supersonic flow converges to the central plane from @xmath166 and @xmath167 directions at mach number @xmath168 , for total relative mach number 10 . for both the whole domain initially and the inflowing gas subsequently",
    ", we apply perturbations following a gaussian random distribution , with a fourier power spectrum of the form @xmath169 for @xmath170 , where @xmath171 is the resolution and @xmath102 is the size of the simulation box in @xmath64 and @xmath73 .",
    "the power spectrum is appropriate for supersonic turbulence as observed in gmcs @xcite .",
    "the perturbation velocity fields are pre - generated with resolution @xmath172 in a box of size @xmath173 .",
    "the perturbation fields are advected inward from the @xmath22-boundaries at inflow speed @xmath174 : at time intervals @xmath175 , slices of the pre - generated perturbation fields for @xmath176 and @xmath177 are read in to update values in the ghost zones at the @xmath22-boundaries .",
    "we set the amplitude of the turbulent power spectrum at the large scale to @xmath178 , which corresponds to the low amplitude case in @xcite .",
    "the resolution is @xmath179 , with domain size @xmath180 .",
    "figure [ fig : protostar_formation ] shows evolution of the surface density ( equation ( [ surfd_def ] ) ) projected in the @xmath22-direction after the most evolved core collapses and creates a sink particle ( marked as `` 1 '' in the images ) .",
    "the instants for the four images from top left to the bottom rights are : @xmath181 , @xmath182 , @xmath183 and @xmath184 .",
    "the time interval between these images is @xmath185 the black dots and numbers mark the sink particles formed prior to the time of each snapshot for the first three plots . in the last frame ,",
    "the magenta curves show the trajectories of sink particles and the black triangles show where these sinks were created . over time ,",
    "some of the sinks merge , and the large white solid dots show the final set of post - merger sink locations at @xmath186 .",
    "the numbers marking sinks in the images indicates the sequence of their creation . in the top right figure ,",
    "the sink number 7 is missing since it has merged with the sink 1 .",
    "similarly , in the lower left , several of the sinks have already undergone mergers , and their corresponding numbers are not shown ( 5 , 6 , 7 , 10 , 11 ) .",
    "filamentary features dominate the moderate ",
    "density structure in all images .",
    "these structures grow from the initial turbulent perturbations , which are then amplified by self - gravity ( see fig.1 in @xcite ) .",
    "the localized collapse of these filamentary structures leads to the formation of protostars .",
    "filaments also become more stratified over time as they acquire more material and contract perpendicularly under their self - gravity .",
    "the bottom right panel in figure [ fig : protostar_formation ] shows the trajectories of all sinks , as well as their merging history .",
    "there were 12 sinks created during this simulation , and four survive at final time .",
    "all of the other 8 have merged with other nearby sinks due to close encounters .",
    "figure [ fig : mass_t ] shows the mass of sinks versus time .",
    "the solid lines show the four sinks that survive up until late stages .",
    "the dotted lines are sinks that undergo mergers with other more massive sinks . each sink forms at the center of a dense core , and the solid dots show the gravitationally bound core masses calculated using the grid - core finding algorithm @xcite immediately before the formation of the corresponding sink particle .",
    "the mass of every sink particle grows smoothly to reach and exceed the bound core mass , and keeps increasing until it merges with other sinks . as indicated in the figure , the final masses of sink particles are all much larger than the bound core masses at the initial instant of sink formation , which are in the range @xmath187 .",
    "the formation of sinks is divided into three groups .",
    "protostars 1 , 2 , 3 , 4 and 5 form at the earliest time ; sinks 6 , 7 , 8 , 9 and 10 form a bit later ; and sinks 11 and 12 form during the late accretion stage .",
    "sinks forming at earlier stages are more likely to survive to the end , and their masses grow significantly via mergers and late accretion . for example , the merging history for protostar 1 is : @xmath188 , the merging history for protostar 2 is : @xmath189 , and the merging history for protostar 3 is : @xmath190 .    at late stages",
    ", the masses of these surviving sink particles are very high : @xmath191 , @xmath192 , @xmath193 and @xmath194 .",
    "these correspond to tens of @xmath195 if @xmath196 . in part",
    ", these sinks may end up with very high mass because the turbulence has low amplitude and is purely decaying . as consequence",
    ", matter is not prevented from accreting into the potential wells that develop . in reality ,",
    "outflows , radiative feedback , and other energy injection would limit gas accretion onto protostars . in addition , some stars could be ejected due to close gravitational encounters , before acquiring a high mass .",
    "these physical issues will be addressed in a future publication ; it is straightforward to implement localized feedback with rates set by the mass , age , accretion rate , etc , of each sink . here",
    ", our goal is simply to test the proper implementation of sink particle algorithms and to demonstrate that these enable robust long - term evolution .",
    "we note that for the present algorithm ( and similarly for other sink particle implementations ) , the minimum particle mass depends on the grid resolution , on the minimum density threshold for sink creation , and on the size of the sink particle control volume .",
    "the sink particle density threshold we adopt here is @xmath197 . with resolution @xmath198 , @xmath199 , and",
    "the mass within the central cell of the sink region is @xmath200 .",
    "the total initial sink particle mass are larger , due to non - negligible density in the surrounding sink cells .",
    "we find ( see figure [ fig : mass_t ] ) that the initial sink masses in this test simulation are in the range @xmath201 . with @xmath202 , this ranges from @xmath203 times the minimum mass .",
    "as discussed in section 2.2.1 , different density thresholds have been adopted for sink particle creation by different groups , motivated by different physical and computational considerations .",
    "figure [ fig : mass_comp ] shows a comparison of sink particle mass versus time for different sink particle creation criteria .",
    "the solid lines are based on criteria of exceeding the lp density threshold ( equation ( [ lp_rho ] ) ) and satisfying the local potential minimum check .",
    "the tracks marked by pluses adopt additional criteria : the converging flow check and gravitationally bound state check .",
    "the dotted lines adopt the truelove density instead of the ( higher ) lp density as a threshold , and apply a check for a local gravitational potential minimum .",
    "we find no differences between the sink masses for the first two sets of criteria . for the third set of criteria , the sink masses at birth are much lower than in the first case , because of the lower density threshold . compared to initial sink masses of @xmath204 using the lp density criterion , initial sink masses are @xmath205 using the truelove density criterion .",
    "however , these sinks evolve to follow tracks identical to those found with the other two sink criteria choices .",
    "analogous comparisons at different mach numbers show that no additional particles are created by artificial fragmentation when using our standard criteria , even though the lp density threshold is higher than the truelove density threshold .",
    "we conclude that a proper density threshold and local potential minimum check are probably sufficient criteria for sink particle creation . by choosing a density threshold given by the lp solution , and requiring that the zone is at a local potential minimum",
    ", we can ensure that the region surrounding a cell is under gravitational collapse .",
    "we note that in the study of @xcite , there was no implementation of sink particles . there",
    ", the authors showed that artificial fragmentation may occur in amr simulations if the ratio of the jeans length to the grid scale is too small .",
    "however , in simulations where sink particles are introduced , the formal requirements on resolution need not be identical to the case when there are no sink particles .",
    "previous authors @xcite showed that they were able to avoid artificial fragmentation by capping the density at the truelove value ( see equation [ rho_tr ] ) .",
    "however , we find that when a slightly higher density criterion ( motivated by lp collapse ) is adopted for sink particle creation , there is still no artificial fragmentation , and in fact the mass evolution follows similar tracks as it does when the truelove density threshold is used ( see fig . [",
    "fig : mass_comp ] ) .",
    "the similarity among the mass evolution tracks for different sink particle creation criteria suggests that the class of sink particle methods currently in use provides reliable results for core collapse and accretion .",
    "we have presented an implementation of sink particles to the grid - based eulerian hydrodynamics code _ athena_. a standard particle - mesh method is adopted to calculate gravity forces by and on the sink particles , with the poisson equation solved via fft methods .",
    "we use the mass and momentum fluxes from the riemann solver to update the mass and momentum of sink particles .",
    "criteria for sink particle creation are similar to those used by other authors , although we suggest that a higher density threshold is motivated by the larson - penston profile that is known to develop as a generic stage of self - gravitating collapse .",
    "the larson - penston density threshold we adopt for sink creation in our method is a factor 14 larger than the `` truelove '' density threshold adopted in other sink implementations ; our method also differs from other implementations in that the sink region surrounding each particle consists of ghost zones rather than active zones .",
    "outside the sink region , the density is below the truelove value .",
    "our tests show similar results whether we use higher or lower density thresholds for sink formation ; additional testing in the future can explore whether artificial fragmentation is avoided in all cases .",
    "we validate our method and implementation with a series of tests .",
    "these tests include comparison of accretion rates with analytic solutions for self - similar collapse of isothermal spheres , and comparison of accretion rates and solution profiles with 1d spherically - symmetric collapse of bonnor - ebert spheres and cores formed by converging supersonic flows .",
    "we demonstrate galilean invariance of our accretion solutions onto sink particles .    to demonstrate application of our method , we present sample results for a simulation of planar converging supersonic flows with turbulence .",
    "filaments form , and local collapse produces sink particles which then accrete material from filaments . the mass smoothly increases to exceed the mass of the initial bound core in which a sink formed .",
    "sinks forming at early stages merge with other smaller sinks if sink regions ( of standard size @xmath92 zones ) overlap . in the context of these converging flow tests",
    ", we have investigated various criteria that have been adopted for creation of sink particles .",
    "we find that a ( large enough ) density threshold and local gravitational potential minimum check give the same results as more strict sets of criteria in this case ( and in other tests we have conducted ) .    the implementation of sink particles we present enables study of a wide range of astrophysical applications involving gravitational collapse of a gaseous medium .",
    "in particular , robust and accurate methods for implementing sink particles make it possible to track sequential formation of multiple protostars over long periods under realistic environmental conditions . as such , sink particles represent a crucial numerical tool for addressing key unsolved problems in star formation , including the origin of the stellar initial mass function .",
    "the implementation of sink particles we describe here will be made available to the community in an upcoming release of the _ athena _ code .",
    "we are grateful to aaron skinner for his contributions to code development for particle implementation , to christoph federrath for helpful discussions , and to the referee for comments that helped us to improve the manuscript .",
    "this work was supported by grant nnxi0af60 g from nasa s astrophysics theory program .",
    "computations made use of the hpcc deepthought cluster administrated by the oit at the university of maryland , as well as the borg cluster in the department of the astronomy .",
    "in this section , we provide details for the solution of poisson s equation with vacuum boundary conditions . let @xmath206 be the green s function solution for the poisson equation @xmath207 , so that the potential produced by a density field @xmath208 is : @xmath209 for potential @xmath15 at ( @xmath210 ) within a domain @xmath211 with dimensions @xmath212 , the corresponding discrete sum is : @xmath213 here @xmath214 and @xmath215 are the integer indices for the corresponding coordinates @xmath216 respectively .",
    "@xmath217 is a convolution of @xmath218 and @xmath208 .    because @xmath219 is a function in the domain @xmath220\\times[-l_y , l_y ] \\times[-l_z , l_z]$ ] , and @xmath221 is a function in the domain @xmath222\\times[0,l_y]\\times[0,l_z]$ ] ,",
    "if we define @xmath223 for @xmath224 , or @xmath225 , equation ( [ phi_xyz ] ) can be re - written as : @xmath226    we may define periodic functions with period @xmath227 and @xmath228 in @xmath229 and @xmath22 directions respectively , such that @xmath221 and @xmath230 agree with these periodic functions for @xmath231 , y \\in [ -l_y , l_y]$ ] and @xmath232 $ ] . then from the fourier convolution theorem , equation ( [ phi_xyz_n ] ) can be expressed in terms of the respective transforms @xmath233 and @xmath234 of @xmath230 and @xmath221 from the fourier convolution theorem : @xmath235 note the summation index for @xmath236 can be either from @xmath237 or @xmath238 because @xmath233 and @xmath234 are periodic .",
    "the same applies to @xmath239 and @xmath240 indices . in our implementation within _ athena",
    "_ , equation ( [ phi_conv ] ) is further decomposed into a sum over even and odd terms to save memory .                                                                                     at box resolutions @xmath241 @xmath100 and @xmath101 zones from left to right .",
    "the bottom panels show orbits of diameter @xmath99 at the same resolutions .",
    "each panel shows the trajectory of one particle for @xmath97 orbits.,scaledwidth=90.0% ]     ( crosses ) and @xmath126 ( open circles ) from @xcite .",
    "the analytic accretion solutions for self - similar flows are shown by the solid lines .",
    "the accretion rates from our simulations are consistent with the analytical solutions during early stages .",
    "the enhancement of accretion rates in the later stages is due to the collapse of the outer part of the initial sphere , which is affected by boundary conditions . in the units given , the initial sphere masses for the cases @xmath135 and @xmath242 are 18.9 and 40.7 , respectively .",
    "we fit the linear part of this and other accretion histories to derive the accretion rates plotted in figure [ fig : singular_accretion ] .",
    ", scaledwidth=90.0% ]     ( see equation ( [ rho_shu ] ) ) .",
    "the solid line shows the analytical accretion rates derived by @xcite , via direct integration of isothermal fluid equations for self - similar models .",
    "the solid dots are from accretion rates measured in our 3d simulations.,scaledwidth=80.0% ]    ) .",
    "the color scale represents an @xmath243 slice through the density ( @xmath244 ) .",
    "the direction and length of arrows indicate the direction and magnitude of the local velocity , with scale as indicated in the upper left .",
    "the `` expansion wave '' is evident in the plot , with collapse in the inside ( @xmath245 ) and a near - static solution in the outside ( @xmath246 ) .",
    "the location of the expansion wave for the initial conditions was @xmath247.,scaledwidth=90.0% ]    ) isothermal sphere .",
    "the time interval between profiles is constant , equal to @xmath248 , with successive profiles moving to lower density and velocity over time . in both panels ,",
    "the solid lines are the analytic solutions obtained by integrating equations ( 11)-(12 ) in @xcite . for the @xcite expansion wave solution ,",
    "the outer part of each profile is static ( the equilibrium singular isothermal sphere ) , and the inner part of each profile approaches free fall , with @xmath119 and @xmath249 .",
    "the dot dash line in the left panel shows the singular isothermal sphere density profile .",
    "the velocity profiles are plotted in linear - log scale to show the propagation of the `` expansion wave '' .",
    "the dashed lines in the right panel indicate the position of the `` expansion wave '' front .",
    "the consistency of our numerical solution with the @xcite solution is evident .",
    ", scaledwidth=90.0% ]    ) with bulk motion across the grid , demonstrating galilean invariance .",
    "horizontal curves , left scale : the temporal evolution of the speed of the sink particle for different cases . from bottom to top , the bulk advection speed is @xmath250 , @xmath251 and @xmath252 .",
    "the time - averaged particle speeds remain constant , and equal to that of the bulk flow .",
    "diagonal curves , right scale : the temporal evolution of the mass of the central sink particle for the four different cases .",
    "the accretion rate is same for static , subsonic , and supersonic advection cases , confirming galilean invariance of our algorithms.,scaledwidth=90.0% ]     slice through the volume density ( @xmath253 , for @xmath150 the initial density at the outer edge of the sphere ) .",
    "the direction and length of arrows indicate the direction and magnitude of the local velocity , with scale as indicated in the upper left .",
    "the inner part of the sphere is collapsing , with velocity increasing inward to approach @xmath155 . because we do not have a hot , high - pressure confining medium ,",
    "the outer part of the sphere also expands.,scaledwidth=90.0% ]        ) ; solid line on left ) .",
    "units are normalized using the initial density at the edge of the sphere , @xmath150 .",
    "the initial outer radius of the sphere is @xmath254 , and the initial density in the region exterior to the sphere is @xmath151.,scaledwidth=90.0% ]     for the lower and @xmath255 for the upper curve in the left panel , and the opposite in the right panel ) , the dashed lines are at the instant of sink particle creation , and the dotted lines are during the infall stage ( @xmath256 for the upper and @xmath257 for the lower curve in each panel ) .",
    "the time unit is @xmath258 for @xmath150 the initial density at the edge of the sphere .",
    "the behavior in each stage is consistent with previous results from spherically - symmetric simulations @xcite .",
    "the time interval between profiles is @xmath259.,scaledwidth=90.0% ]        -direction ( color scale @xmath260 ) for a planar converging flow simulation with inflow mach number @xmath261 , and supersonic turbulence .",
    "the four panels from top left to bottom right show snapshots at four instants : @xmath181 , @xmath182 , @xmath183 , and @xmath184 .",
    "the top left panel shows the surface density when the first sink `` 1 '' is created .",
    "the numbers in panels mark the time sequence of sink formation .",
    "the black solid dots in the first three frames show instantaneous locations of sink particles . in the final panel ,",
    "the four white large solid dots show the surviving sinks after mergers .",
    "the magenta curves shows the trajectories of all sinks from birth ( marked with triangles ) to the end of the simulation .",
    "the area of the projected domain is @xmath262 ( see equation ( [ lj_def])).,scaledwidth=90.0% ]    ) and equation ( [ tj_def ] ) for definition of @xmath263 and @xmath264 respectively ) .",
    "the solid black lines show the sinks that survive to late times .",
    "the dotted lines show the sinks that are eventually merged into larger particles .",
    "the solid black dots show the gravitationally bound dense core masses immediately before the creation of the corresponding sink particle at its center.,scaledwidth=90.0% ]"
  ],
  "abstract_text": [
    "<S> we describe implementation and tests of sink particle algorithms in the eulerian grid - based code _ athena_. introduction of sink particles enables long - term evolution of systems in which localized collapse occurs , and it is impractical ( or unnecessary ) to resolve the accretion shocks at the centers of collapsing regions . </S>",
    "<S> we discuss similarities and differences of our methods compared to other implementations of sink particles . </S>",
    "<S> our criteria for sink creation are motivated by the properties of the larson - penston collapse solution . </S>",
    "<S> we use standard particle - mesh methods to compute particle and gas gravity together . </S>",
    "<S> accretion of mass and momenta onto sinks is computed using fluxes returned by the riemann solver . </S>",
    "<S> a series of tests based on previous analytic and numerical collapse solutions is used to validate our method and implementation . </S>",
    "<S> we demonstrate use of our code for applications with a simulation of planar converging supersonic turbulent flow , in which multiple cores form and collapse to create sinks ; these sinks continue to interact and accrete from their surroundings over several myr . </S>"
  ]
}