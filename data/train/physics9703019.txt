{
  "article_text": [
    "computer simulations of molecular dynamics ( md ) have become an invaluable tool applied to numerous problems in chemical physics @xcite and biophysics @xcite . normally molecular movements are simulated by the method of point particles @xcite , i.e. motion of each atom is computed by newton s equations while molecular structures are maintained by harmonic potentials that keep bond lengths and bond angles close to their standard values . the maximum time step with which newton s equations can be numerically integrated",
    "is limited to rather small values ( 1 fsec for systems containing explicit hydrogen atoms ) , in order to reproduce bond - length oscillations accurately .",
    "this time step is annoyingly small for simulations of macromolecules , notably biopolymers .",
    "the unique molecular properties of biopolymers result from specific concerted atom movements , conformational transitions , which can occur over a very broad time range : from picoseconds to seconds . because of the necessarily small time step ,",
    "interesting motions , for the most part , remain beyond the reach of even the fastest computers .",
    "this presents the central problem in methodology in the field .",
    "twenty years ago ryckaert et al @xcite proposed an approach to this problem which is now called constraint dynamics .",
    "they found a simple and efficient way to impose holonomic constraints upon atom - atom distances in a system of point particles governed by newton s equations .",
    "their well - known algorithm , shake , and a few other techniques based upon the same idea @xcite are now often used to fix bond lengths , increasing the time step limit to 2 fsec for systems with explicit hydrogens .",
    "constraint dynamics has been extensively reviewed @xcite .",
    "these simple algorithms can be applied to any molecules regardless of their size , chemical structure etc . however , although it seemed initially that the method could fix not only bond lengths but also , by triangulation , could constrain bond angles , dihedral angles , rigid planar groups etc .",
    "@xcite , this was found to be true only for very small molecules . in large complex polymers like proteins even bond angles can not be fixed in this way @xcite .",
    "the intrinsic limitation of constraint dynamics can be qualitatively understood from the underlying physical model . imposing",
    "a distance constraint implies that a reaction force is introduced which is applied along a line joining two atoms .",
    "reactions must be calculated at each time step to balance all other forces in the system , which for large molecules presents a difficult problem because they are all coupled and form a system of algebraic equations solved by iterations . with only bond lengths to hydrogens",
    "fixed reactions are coupled in small groups and iterations converge rapidly . with all bond lengths fixed reactions",
    "are coupled globally and looping becomes possible .",
    "in general , in this case , the convergence is not guaranteed @xcite , but , in practice , it remains acceptable .",
    "when bond angles are triangulated coupling is much stronger and convergence becomes too slow .",
    "efforts to overcome these limitations continue @xcite ; in particular , it was shown that an exact non - iterative calculation of reactions is possible , in principle @xcite , but , so far , this is practical only for water molecules @xcite and for linear unbranched chains in which case the problem can be reduced to inversion of a banded matrix @xcite .    despite these difficulties",
    "it remains desirable to model chain molecules within the so - called standard geometry approximation @xcite , that is with standard fixed conformations of individual chemical groups and with rotations around single bonds as the only motion considered .",
    "rotatable torsion angles completely define molecular conformations and present a convenient minimum set of generalized coordinates which are directly used in static conformational analysis and monte - carlo simulations of polymers . in principle ,",
    "md simulations in the space of generalized , rather than cartesian , coordinates are also possible by using one of the appropriate general formalisms of the classical mechanics . in this way",
    "all limitations imposed by the fast vibrations of bond lengths , bond angles etc . would be eliminated automatically .",
    "this approach was first applied to liquid butane with one internal degree of freedom @xcite and soon after pear and weiner pioneered simulations of linear chains of up to 15 bonds based upon the newton - euler equations of rigid body dynamics @xcite .",
    "interest in this line of research next decreased because of its complexity and because it initially appeared that constraint dynamics could solve all problems , but the difficulties encountered have led to a revival of work .    to date",
    "several research groups have reported attempts to find a suitable technique for md simulations in generalized coordinates .",
    "both methods of rigid body dynamics and the lagrange - hamilton formalism @xcite were employed .",
    "these methods often have little in common in their analytical formulations , but they all may be reasonably referred to as _ internal coordinate molecular dynamics _ ( icmd ) .",
    "the full set of internal coordinates includes not only torsions , but also bond lengths and bond angles , and in some approaches these variables may also be free , if desired .",
    "the term _ internal coordinate molecular dynamics _ underlines the main distinction of these approaches from conventional md , i.e. they all consider molecular motion in the space of generalized internal coordinates rather than in the usual cartesian coordinate space .",
    "none of the icmd techniques has yet been sufficiently well developed to reach its main goal , that is , to compute long - duration macromolecular trajectories with acceptable accuracy but at a lower cost than the classical md with bond length constraints . compared with the pure newtonian dynamics",
    "there are two obvious problems with icmd .",
    "the first is the derivation of equations of motion for large molecules .",
    "this task seemed too complicated at the beginning @xcite , but several acceptable solutions have been proposed , which represent the main achievement of the early reports on the subject @xcite .",
    "the second problem is the cost of additional calculations to be performed in order to obtain generalized accelerations .",
    "this must be low enough to be compensated by an increase in the step size . among these calculations",
    "the necessity to invert the mass matrix of the system is an evident obstacle .",
    "this matrix is diagonal for the newton s equations but for internal coordinates it is a full positive definite matrix , therefore , a direct inversion scales as @xmath1 with the number of degrees of freedom and this quickly becomes impractical when n exceeds  100 .",
    "fortunately , a solution of this problem was found some time ago in robot mechanics @xcite , namely , there are several recursive techniques that allow one to compute exact generalized accelerations for @xmath2 calculations if the system can be treated as a tree of articulated rigid bodies .",
    "two such algorithms have been employed recently @xcite for icmd and it was shown that , as in newtonian dynamics , the cost of the time step can be made close to that of the evaluation of forces @xcite .    in spite of this progress",
    "the capabilities of icmd still are not obvious because it is unclear how much the time step can be increased in practically interesting cases .",
    "the uncertainty is caused by two different reasons .",
    "first , biopolymers with only torsion degrees of freedom are very complex , heterogeneous and essentially unharmonic systems in which it is usually impossible to distinguish the fastest motions _ a priori _ by intuition .",
    "for instance , in simulations of small peptides time steps can be increased up to 15 - 20 fsec @xcite and one might expect that a considerable increase of the step size should be possible for larger molecules as well .",
    "surprisingly , the first simulations of torsion dynamics of proteins reported recently @xcite encountered a step size barrier of only 2 fsec , the same as in the constraint dynamics with fixed bond lengths . this unusual effect of molecular size",
    "still have no clear explanation .",
    "most of the uncertainty , however , results from unresolved numerical problems involved in integration of icmd equations of motion",
    ". their analytical form does not give a possibility to employ common symplectic md integrators and that is why various general - purpose predictor - corrector schemes were usually employed .",
    "it is well - known , however , that in md applications such algorithms tend to loose stability with lower step sizes .",
    "in addition , it was shown that they poorly conserve momenta when applied to equations of motion in generalized coodrinates @xcite .",
    "this study presents an attempt to overcome the numerical difficulties in icmd reported in ref .  .",
    "these difficulties originate from the general form of the equations of motion which depends only upon the choice of coordinates , and so they could not be overcome by simple remedies .",
    "that is why an essentially new analytical formulation of icmd has been developed with new equations which are essentially hamiltonian , but have a slightly different form .",
    "surprisingly , they turned out to be much simpler than in other analytical icmd formulations .",
    "numerical integration in the space of conjugate hamiltonian variables eliminates all earlier problems associated with poor conservation of momenta @xcite and results in trajectories as stable as those obtained with newtonian md .",
    "this paper principally presents an analytical background , but includes representative tests in order to obtain reliable estimates of the step size in a few important simulation modes and to make sure that there are no hidden numerical problems that can undermine the method .",
    "it turns out that for protein torsion dynamics with all explicit hydrogens the optimal time step is 4 fsec , two times larger than with only bond lengths fixed and the same as that for rigid water simulations @xcite .",
    "this value is probably determined by fast collisions and rotations of hydrogen atoms because without explicit hydrogens or with weighted inertia of hydrogen - only rigid bodies the possible time step is beyond 10 fsec .",
    "the computer cost of a time step for the torsion dynamics is similar to that of usual constraint dynamics with fixed bond lengths .",
    "it is , therefore , a method of choice for long simulations in which the accuracy of the standard geometry approximation is acceptable .",
    "it should be also stressed that icmd qualitatively differs from the constraint dynamics in its efficiency with respect to the number of constraints : additional constraints in icmd result in an increased speed of calculations .",
    "let @xmath3 denote the position vector of atom @xmath4 .",
    "the conformation of the molecule is specified by the set of @xmath5 such vectors \\{@xmath6 .",
    "kinetic energy @xmath7 where overdot denotes time derivative ; the potential energy @xmath8 and the lagrangian @xmath9 assuming that the set of generalized coordinates is defined @xmath10 , so that @xmath11 the lagrangian equations of motion are @xmath12 now consider how molecular conformation is specified by bond lengths , bond angles and dihedrals .",
    "if in fig.1 the cartesian coordinates are given for atoms @xmath13 , @xmath14 and @xmath15 , @xmath16 is computed from @xmath17 , @xmath18 and @xmath19 given the values of dihedral @xmath20 , planar angle @xmath21 and bond length @xmath22 @xmath23 similarly , @xmath24 is computed from @xmath18 , @xmath25 and @xmath16 , and so on .",
    "this procedure needs global coordinates of the first three atoms for initialization , but for the moment we skip this point to consider it later .",
    "the above process is not just an algorithm for computing \\{@xmath26 from @xmath27 , but also a definition of a specific ordering of atoms and internal coordinates in the molecule .",
    "this ordering is indispensable for transformation of @xmath28 into \\{@xmath26 ; it is implicit in eq.(4 ) but is revealed when derivatives @xmath29 need to be computed .",
    "for example , when dihedral @xmath20 in fig.1 is varied then by definition @xmath17 , @xmath18 and @xmath19 are not affected while @xmath16 moves , as well as the following atoms .",
    "the infinitesimal displacements of atoms in response to variation of internal coordinates correspond to the motion of a tree : the very first three atoms form the base , internal coordinates close to the base move almost the whole molecule while variables in a specific branch move only the upper part of that branch .",
    "of course , there is no distinction between the base and the tip of the tree in the real motion : when the base gets its six degrees of freedom it becomes equivalent to any of the branches .",
    "let @xmath30 denote the set of atoms in the molecule that move when internal coordinate @xmath31 is varied .",
    "than we have @xmath32 @xmath33 and eq.(5 ) gives @xmath34    in order to make the following step it is necessary to assume that there are no loops in the molecule . internal coordinate description of flexible loops is a separate problem which needs special treatment , but without loops the whole set @xmath30 moves as a single rigid body if only @xmath35 is varied .",
    "if @xmath35 is a bond lengths @xmath30 is translated along the bond so that for any atom @xmath36 where @xmath37 is the unit vector of the bond .",
    "if on the other hand @xmath35 is an angle or a dihedral , rotation of @xmath30 occurs : @xmath38 where the cross denotes a vector product , while the unit vector @xmath37 and the position vector @xmath39 specify the axis of rotation .    for a translational variable eq.(9 ) gives @xmath40 where @xmath41 is the total momentum of the set of atoms @xmath30 .",
    "it is straightforward to show that , in the case of a translational variable , @xmath42 equals to the sum of the forces applied to atoms of set @xmath30 projected upon vector @xmath37 , and so eq . ( 12 ) is nothing but the corresponding projection of the newton equation . for a rotational variable",
    "we have @xmath43 where @xmath44 is the total angular momentum of atoms of set @xmath30 around the fixed point in space given by the current value of vector @xmath39 .",
    "again it is easy to show that , for a rotational variable , @xmath45 equals the projection upon @xmath37 of the sum of the torques around point @xmath39 applied to atoms of set @xmath30 , and therefore eq.(13 ) is a projection of the newton equations for the torques .    in order to shorten the notation",
    "let us introduce indicator @xmath46 such that    @xmath47    and unite eqs.(12 ) and ( 13 ) @xmath48 now we need to transform eq.(15 ) so that a full time derivative appears on the left .",
    "we have @xmath49 and @xmath50 where @xmath51 is the total angular momentum of set @xmath30 around moving point given by vector @xmath39 .",
    "although @xmath44 and @xmath51 refer to the same physical quantity distinction between them must be made because these are two different time functions .",
    "@xmath44 is angular momentum around a fixed node ; it equals to @xmath51 at the given moment of time but it has a different time derivative : @xmath52 and , accordingly , the two values diverge immediately afterwards .",
    "the newton equation ( 13 ) is valid for @xmath44 but not for @xmath51 .",
    "substitution of eqs.(16 ) and ( 17 ) into eq.(15 ) gives @xmath53=-\\frac{\\partial u}{\\partial\\theta_i}+s_i{\\bf\\dot e } _",
    "i{\\bf q}_i - s_i{\\bf p}_i\\left({\\bf e}_i\\times{\\bf\\dot r}_i\\right)+\\left ( 1-s_i\\right){\\bf\\dot e}_i{\\bf p}_i\\ ] ] now consider more carefully the term in the brackets on the left . by a simple transformation we get @xmath54=\\frac { \\partial k}{\\partial\\dot\\theta_i}=\\frac{\\partial l}{\\partial\\dot\\theta _",
    "i}\\ ] ] i.e. this is nothing but the conjugate momentum corresponding to variable @xmath35 and eq.(19 ) is just one of the hamiltonian equations .",
    "we have , therefore @xmath55 where @xmath56 are the coefficients of the mass matrix of the system .",
    "eqs.(19 ) and ( 21 ) present the resultant equations of motion to be integrated by a computer .",
    "this is done in two steps . at first the r.h.s . of eq.(19 )",
    "is evaluated and the time step is made for momenta . at the same time",
    "momenta propagated from the previous step are substituted into the r.h.s . of eq.(21 ) and the linear system is solved by inverting the mass matrix , which is done by using the recursive algorithm by rodriguez et al @xcite .",
    "this algorithm has been developed within the context of the newton - euler approach to rigid body dynamics , where each its step has a physical interpretation and corresponds to a special decomposition of reactions in hinges between rigid bodies . here",
    "these interpretations are lost , but due to the same structure of matrix @xmath57 it still can be applied just as a formal mathematical procedure .",
    "the generalized velocities thus obtained are used to make the time step in generalized coordinates .",
    "a specific example of an integrator for eqs .",
    "( 19 ) and ( 20 ) employed in the numerical tests reported below is detailed in the appendix .",
    "eq.(19 ) is rather simple and presents no computational problems .",
    "all terms on the right are familiar functions of atom coordinates and atom velocities .",
    "it is clear that in an unbranched chain molecule sets @xmath30 can be ordered so that @xmath58 therefore all @xmath41 can be computed starting from the tip of the chain , moving to the base and at the ith variable adding only the contribution from subset @xmath59 . in order to compute @xmath51 angular momenta of sets @xmath30",
    "are first computed with respect to the zero of global coordinates in the same way as momenta .",
    "after that @xmath51 are computed by moving the ith node of rotation to @xmath39 the total force applied to atoms of set @xmath30 is computed similarly to @xmath41 and the total torque - similarly to @xmath51 .",
    "it can be noted that the recurrent calculations of derivatives of the conformational energy used in this field for a long time @xcite are nothing but the above summation of forces and torques . due to these algorithms computations of forces in icmd",
    "is in fact similar to the classical md , contrary to the common oppinion @xcite .",
    "generalization of the above procedure for a branched chain is straightforward .",
    "these computations present only technical difficulties and there is no need to detail them here .",
    "the computer time necessary to evaluate the non - potential terms in eq.(19 ) is negligible .",
    "it seems reasonable to call eqs.(19 ) and ( 21 ) quasi - hamiltonian because of the meaning of the parameters involved .",
    "one should note that there is already some confusion in the classification of equations of motion in internal coordinates .",
    "it certainly has little sense to base such classification upon the method used for the derivation of equations because their final form depends only upon the choice of coordinates .",
    "for example , by substituting eq .",
    "( 21 ) into eq .",
    "( 19 ) we can get the earlier equations for generalized accelerations @xcite which are equivalent to any other equations for accelerations of internal coordinates @xcite . inversely , eq .",
    "( 19 ) may be obtained by separating a full time derivative in the corresponding equations for generalized accelerations derived by any appropriate technique .",
    "let us consider now the generalized coordinates that position in space the first three atoms in the molecule .",
    "these coordinates may be called external and they affect positions of all other atoms , therefore @xmath60 and @xmath61 are the total momentum and angular momentum around a node which is yet to be specified . in the absence of external field @xmath62 therefore for external variables the r.h.s . of eq.(19 ) includes only inertial terms .",
    "all these terms become zero , however , if variable @xmath31 can be defined so that the corresponding @xmath37 and @xmath39 are fixed in space . for instance , if the cartesian coordinates of the first atom are used as the first three translational coordinates eq.(19 ) gives @xmath63 where @xmath64 is the total momentum of the molecule .",
    "thus , the conservation of the total momentum appears to be explicitly present in equations of motion and , more importantly , in their finite - difference approximations .",
    "the same property is implicit in the newton equations . on the face of it",
    ", this might seem rather minor , but it appears to be somehow related with the numerical stability with large step sizes . in the newton s case , among the principal first integrals of mechanics only the total energy is affected by the numerical approximation errors , while the conservation of momenta commonly is `` ideal '' , that is it depends only upon the length of the floating point numbers in the computer .",
    "in contrast , in the numerical integration of standard icmd equations for generalized accelerations all first integrals are similarly affected by approximation errors .",
    "the importance of this qualitative difference has been recognized in our earlier study @xcite where it was possible to significantly improve the numerical stability with large step sizes by enforcing conservation of momenta . by using eqs .",
    "( 19 ) and ( 20 ) ideal numerical conservation can be ensured with an appropriate choice of the external coordinates , and we will see below that in this way one manages to obtain the quality of numerical trajectories comparable to that of classical md .",
    "the above considerations dictate the following procedure for positioning the first three atoms in a molecule .",
    "fig.1 shows the global coordinate frame @xmath65 and the local frame @xmath66 that is bound with the molecule .",
    "the origin of the local frame coincides with the first atom ( atom @xmath13 in fig.1 ) .",
    "the second atom ( @xmath14 ) always rests on axis @xmath67 and the third atom ( @xmath15 ) always rests in plane @xmath68 .",
    "the second atom moves along @xmath69 axis if its bond lengths ( bond @xmath13-@xmath14 in fig.1 ) is not fixed . similarly , the third atom moves in @xmath70 plane if bond @xmath14-@xmath15 and/or bond angle @xmath13-@xmath71-@xmath15 are variable . with these conventions ,",
    "the six rigid body degrees of freedom of frame @xmath66 with respect to the global coordinates @xmath65 complement the internal degrees of freedom in the molecule to the full set required .",
    "frame @xmath66 is considered to rotate around the zero of the global coordinates , with variations of the first three generalized coordinates , @xmath72 , @xmath73 and @xmath74 , corresponding to rotations around axes @xmath75 , @xmath76 and @xmath77 , respectively . in this case",
    "@xmath78 , @xmath79 and @xmath80 obtained from eq.(21 ) are the components @xmath81 @xmath82 and @xmath83 of the angular velocity of frame @xmath66 .",
    "they are used to integrate the kinematic equations for the quaternion that controls orientation of frame @xmath66 @xcite .",
    "vector @xmath84 is the total angular momentum around the global coordinate origin therefore eq.(19 ) guarantees conservation of the angular momentum .",
    "one can note , however , that since the first atom is moved by variations @xmath85 , @xmath73 and @xmath86 the cartesian coordinates of the first atom can no longer be taken as independent .",
    "we can still select the three global translational variables so that variations @xmath87 , @xmath88 and @xmath89 correspond to translations of all atoms along global axes @xmath75 , @xmath76 and @xmath77 .",
    "in this case @xmath90 , @xmath91 and @xmath92 obtained from eq.(21 ) refer to @xmath93 , @xmath94 and @xmath95 components of velocity of the point that is rigidly connected with @xmath96 frame , but instantaneously coincides with the zero of coordinates as the center of rotation .",
    "the velocity of the first atom is then computed from its position vector @xmath97 and vectors @xmath98 and @xmath99 .",
    "it is clear that in this case vector @xmath100 still is the total momentum of the molecule .",
    "the formal validity of the analytical formulation of icmd method described in the sections above has been checked in numerous tests with biopolymers of different size and chemical structure .",
    "these calculations clearly confirmed the expected superiority of this new method over our previous formulation @xcite .",
    "in particular , results of the tests obtained with enforced conservation of momenta @xcite have been considerably improved , especially as regards the magnitude of the total energy drift ( data not shown ) .",
    "the results of a few representative calculations are shown in fig .",
    "2 . following many previous methodological md studies a single protein molecule in vacuum was considered here , and the time step comparisons are made by using the conservation of the total energy to access the accuracy of the numerical trajectory . the protein molecule chosen is the immunoglobulin binding domain of streptococcal protein g @xcite ( pgb , file 1pgb in the protein database @xcite ) which is a 56 residue @xmath4/@xmath101 protein subunit .",
    "pgb is somewhat larger than the commonly used test proteins , but it does not have neither s - s bridges nor proline residues , so that no complications connected with the treatment of the flexible rings are involved .",
    "two indicators of the conservation of the total energy are used : the module of the drift and the relative fluctuation which is computed as @xmath102 where @xmath103 and @xmath104 are the average total and kinetic energies , respectively .",
    "the value of the drift is calculated by a linear regression during 1 psec intervals along the trajectory and averaged .    in figs .",
    "2(a - d ) the icmd simulations are compared with the classical md . for the usual md the popular package amber @xcite with force field amber94 @xcite was used , with distance dependent dielectric constant , @xmath105 , and no truncation of non - bonded interactions . in calculations with fixed bond lengths the shake algorithm @xcite was employed with a tolerance of 10@xmath106 .",
    "icmd trajectories were computed by a new program ( dy ) with the same force filed and all internal coordinates as variables .",
    "special care has been taken to ensure identity of the force filed implementations in the two programs and identity of the starting states .",
    "the equilibration was more or less standard and included minimization of the crystal structure followed by a 12.5 psec run starting from maxwell distribution at 300 k with periodic temperature control and a step size of 0.5 fsec .",
    "after that the step size was reduced to 0.25 fsec and a short trajectory of 150 fsec was calculated , with the final part stored and used for generating initial data .",
    "the final point was used as the starting state for a test trajectory of 10 psec , with initial half - step velocities taken at appropriate time intervals from coordinates .",
    "these last preparations were necessary to provide smooth starts of leapfrog integrators used in amber and dy with different time step sizes .",
    "the same starting states were imported from amber to dy where internal coordinates and generalized velocities were computed from atomic coordinates and velocities .",
    "the test trajectory was repeatedly computed with gradually growing step size first in cartesian and next in internal coordinates .",
    "figures 2(a , b ) present results obtained in calculations with completely free molecular models , i.e. with no constraints .",
    "the agreement between the two sets of simulations is close to ideal .",
    "note that the commonly used value of the time step ( 1 fsec ) corresponds to a relative fluctuation of @xmath107 = 0.1 , which can be reasonably used as a reference level of acceptable accuracy .",
    "results of analogous test with bond lengths constraints applied to hydrogen atoms are shown in figs .",
    "2(c , d ) .",
    "again one can note a remarkable agreement between the two different methods .",
    "the relative fluctuation of 0.1 corresponds to the well - known time step size level of 2 fsec .",
    "a similar agreement was observed in simulations with all bond lengths fixed , and it should be added that absolute values of all energy components were very close in all comparative tests ( results not shown ) .",
    "these results demonstrate that icmd simulations are as accurate as traditional md and that both techniques suffer from similar time step limitations .",
    "figures 2(a- d ) , therefore , give an appropriate reference to which standard geometry icmd simulations may be compared .",
    "the results of icmd tests performed with the set of variables corresponding to the standard geometry approximation are shown in figs .",
    "2(e , f ) . compared to figs . 2(c , d )",
    "both the relative fluctuation and the drift of the total energy are considerably reduced .",
    "the time step size corresponding to the relative fluctuation of 0.1 is 4 fsec , that is two times larger than for all- atom models with fixed bond lengths .",
    "this value is close to the well - known step size limit for dynamics of rigid water molecules @xcite , suggesting that the limitation is probably due to the fast rotation of hydorgen atoms in hydrogen - only rigid bodies like hydroxyl or methyl groups .",
    "one can note that the observed increase in the step size is rather moderate compared to earlier estimates obtained in simulations with smaller molecules @xcite .",
    "the apparent reason is that these fast rotations should mainly occur in protein cores , and so the test molecule must be sufficiently large and must include a large number of hydrogen - only rigid bodies for these limitations to be detected .    figures 2 ( g , h ) present an additional proof of the fact that , in the above icmd tests , the time steps are limited by rotation of hydrogens and illustrates one simple possibility to get rid of this limitation .",
    "it is clear that rigid body rotation can be slowed down by artificially increasing its inertia .",
    "imagine , for instance , that in ethane ( ch@xmath108-ch@xmath108 ) both carbon atoms are no longer point masses , but rather spheres that rotate together with the neighboring hydrogens .",
    "rotation of hydrogens will be slowed down but the overall motion of the molecule will be perturbed only slightly because atom masses do not need to be changed .",
    "this rather general trick can be employed at all levels for balancing the time scales of different motions in any hamiltonian system .",
    "note , for instance , that a similar approach is applied to electron degrees of freedom in the car - parrinello method @xcite and that the so called weighted mass md @xcite is also based upon this idea .",
    "results presented in fig .",
    "5 ( g , h ) were obtained with point masses of atoms in the rotation nodes of hydrogen - only rigid bodies replaced by spheres with the same mass and fixed moments of inertia equal to 15 ( atom mass unit)@xmath109 @xmath110 . as a result , both the drift and the relative fluctuation are significantly reduced compared to fig .",
    "2(e , f ) .",
    "the time step size that corresponds to the relative fluctuation of 0.1 is about 11 - 12 fsec .",
    "some comparative data on the computer cost of simulations in amber and in dy in different modes are given in the appendix .",
    "overall table 1a shows that icmd is complementary to the traditional md .",
    "as expected , for unconstrained simulations and for the two usual modes of bond length constraints amber is somewhat faster than dy .",
    "on the other hand , in the standard geometry simulations the cost of a time step in icmd is roughly the same as in constraint dynamics with fixed bond length to hydrogens .",
    "thus , the observed increase in the step size is obtained essentially for no cost , and in terms of computer time per picosecond icmd gives the best score .",
    "in recent years there has been a slow but steady progress in the development of techniques for icmd .",
    "as shown here , improved icmd methodology now makes possible simulations of torsion dynamics of biopolymers that fulfill the same strict criteria upon accuracy and stability as classical md .",
    "overall icmd simulations within the standard geometry approximation are at least two times faster than constraint dynamics .    it should be kept in mind , however , that the numerical tests presented here mainly serve to confirm the validity of the proposed equations .",
    "they do not prove that the method can be freely used in calculations of the physical properties of molecules .",
    "it is known that even constraints upon bond lengths can , in certain cases , cause significant perturbations @xcite , and that fixing bond angles may significantly affect the conformational statistics via the so - called metric tensor @xcite .",
    "effects of each type of constraint upon the measured properties should , therefore , be thoroughly studied .",
    "these reservations , however , are not that important for many applications in structural refinement of biopolymers @xcite , in conformational searches and in simulations of protein folding .",
    "this study was initially motivated and partially based upon unpublished results obtained in collaboration with v. e. dorofeyev @xcite .",
    "i wish to thank dr .",
    "r. lavery for useful discussions , without his support this work could have not be finished .",
    "i also would like to thank dr .",
    "g. rodriguez of the jet propulsion laboratory for making the set of his reprints available for me in russia .",
    "to simplify notation let us consider the case of a single variable .",
    "let @xmath111 and @xmath112 denote the generalized coordinate and the corresponding conjugate momentum .",
    "( 19 ) may be rewritten as @xmath113 where @xmath114 and @xmath115 denotes the inertial term .",
    "calculation of @xmath116 may be denoted as @xmath117 , calculation of @xmath115 as @xmath118 , etc .",
    "the on - step values are denoted as @xmath119 , etc . and the half - step values as @xmath120 , etc",
    ". then the sequence of steps in the leapfrog integrator is expressed as @xmath121 @xmath122 @xmath123 @xmath124 @xmath125 @xmath126 where @xmath127 denotes the step size .",
    "the steps enclosed in the brace are repeated iteratively until convergence of eq .",
    "the iterative cycle involves two stages with non - trivial calculations given by eqs ( 7a ) and ( 9a ) .",
    "the half - step coordinates are corrected in eq .",
    "( 6a ) therefore the inversion of the mass matrix is implicitly involved in eq.(9a ) , which makes the algorithm relatively costly and leaves some room for possible improvements .",
    "some estimates of the cpu time made in the course of the numerical tests are given in table 1a .",
    "the measurements were made on a silicon graphics crimson r4000 - 50 work station .",
    "dy was complied by a standard c - compiler with the lowest level of optimization . in all calculations",
    "a relative tolerance of 10@xmath128 was used as the criterion of convergence of eq.(6a ) .",
    "the cost of the matrix inversion calculations scales roughly linearly with the number of variables therefore it is much less expensive in the standard geometry calculations .",
    "the average number of iterations depends upon the molecular model and also upon the step size . with the optimal time steps it was minimal in the standard geometry simulations ( 3.9 ) and",
    "maximal in simulations with fixed bond lengths to hydrogens ( 9.5 ) .",
    "thus the standard geometry approximation is the cheapest both because of the reduced number of variables and faster convergence .",
    "evaluation of forces takes similar time in amber and in dy ."
  ],
  "abstract_text": [
    "<S> conventional molecular dynamics simulations macromolecules require long computational times because the most interesting motions are very slow compared with the fast oscillations of bond lengths and bond angles that limit the integration time step . </S>",
    "<S> simulation of dynamics in the space of internal coordinates , that is with bond lengths , bond angles and torsions as independent variables , gives a theoretical possibility to eliminate all uninteresting fast degrees of freedom from the system . </S>",
    "<S> this paper presents a new method for internal coordinate molecular dynamics simulations of macromolecules . </S>",
    "<S> equations of motion are derived which are applicable to branched chain molecules with any number of internal degrees of freedom . </S>",
    "<S> equations use the canonical variables and they are much simpler than existing analogs . in the numerical tests the internal coordinate dynamics are compared with the traditional cartesian coordinate molecular dynamics in simulations a 56 residue globular protein . for the first time it has been possible to compare the two alternative methods on identical molecular models in conventional quality tests . </S>",
    "<S> it is shown that the traditional and internal coordinate dynamics require the same time step size for the same accuracy and that in the standard geometry approximation of aminoacids , that is with fixed bond lengths , bond angles and rigid aromatic groups , the characteristic step size is 4 fsec , that is two times higher than with fixed bond lengths only . </S>",
    "<S> the step size can be increased up to 11 fsec when rotation of hydrogen atoms is suppressed .    </S>",
    "<S> @xmath0present address . </S>",
    "<S> email : alexey@ibpc.fr </S>"
  ]
}