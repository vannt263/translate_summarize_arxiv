{
  "article_text": [
    "multiple - input multiple - output ( mimo ) technology is becoming one of the most promising solutions for the next - generation wireless communication to meet the urgent demands of high - speed data transmissions and explosive growing numbers of user terminals , such as the traditional mobile equipments and the new internet of things ( iot ) devices @xcite .",
    "compared with conventional mimo mechanisms , massive mimo is capable of achieving higher reliabilities , increased throughputs and improved energy efficiency by employing less complicated signal processing techniques , e.g. , maximum - ratio combining / maximum - ratio transmission ( mrc / mrt ) , with inexpensive and low - power components @xcite . despite of the advantages , massive mimo is also facing significant challenges on the way towards practical applications .",
    "how to obtain precise channel state information ( csi ) while consuming limited resources is most critical and fundamental .    in existing massive mimo studies , time - division duplex ( tdd )",
    "is more widely considered than frequency - division duplex ( fdd ) because it is potentially easier and more feasible to obtain csi @xcite .",
    "thanks to the channel reciprocity , a tdd system exploits uplink pilot training to estimate channels which can be used in both uplink and downlink data transmissions within a coherence interval where the interval length is determined by the mobility of user equipment . compared with the downlink one , the uplink pilot training saves a large amount of resources to estimate the channels of a large - scale antenna array because each pilot sequence can be used to estimate the channels between all base station antennas and a single - antenna user equipment .",
    "however , the uplink channel estimation has to deal with pilot contamination issues as the user number grows .",
    "it is reported in @xcite that pilot contamination reduces the system performance but can not be suppressed by increasing the number of antennas .",
    "generally , the length of pilot sequence should be equal to or greater than the number of users to guarantee the orthogonality of pilot patterns among different users , in order to avoid pilot contamination . in a massive mimo system , due to the large user number ,",
    "orthogonal pilot sequences become very long , causing significant overhead for channel estimation and thus degrading the effective system throughput .",
    "when the channel varies with time due to medium to high mobility , i.e. , relatively short coherence interval , the pilot overhead issue gets more severe as channel estimation needs to be done frequently .",
    "there are some efforts in the literature to reduce pilot overhead in the massive mimo cellular system serving a large number of users within a finitely long coherence interval .",
    "proposed a semi - orthogonal pilot design in @xcite and @xcite to transmit both data and pilots simultaneously where a successive interference cancellation ( sic ) method was employed to reduce the contaminations of interfering pilots .",
    "investigated the performance of a pilot reuse scheme in the single - cell scenario which distinguishes users by the angle of arrival and thereby reuses pilot patterns @xcite . a time - shifted pilot based scheme was proposed in @xcite and it was then extended to the finite antenna regime in @xcite to cope with the multi - cell scenario",
    "nevertheless , all the research introduced above focused on point - to - point ( p2p ) communications .",
    "few work has studied the pilot scheme design and optimization in massive mimo relaying systems , especially for one - way multipair communications .",
    "the relaying technique is an emerging cooperative technology capable of scaling up the system performance by orders of magnitude , extending the coverage and reducing power consumption@xcite . combining with massive mimo technologies whereby",
    "the relay station ( rs ) is equipped with large scale antenna arrays , the performance of a relaying system can be dramatically improved @xcite . moreover , in spite of the conventional half - duplex ( hd ) system , the full - duplex ( fd ) relaying technique has attracted more interests recently due to the simultaneous uplink ( multi - access of the sources to rs ) and downlink ( broadcasting of rs to the destinations ) data transmissions , whereby the overall system performance is further improved @xcite .",
    "however , similar to the p2p system , the multiuser relaying system also suffers from the critical channel estimation overhead within limited coherence time intervals . for a relaying system",
    ", it may be even worse as both source and destination users need to transmit pilots within the coherence interval , where the coherence interval determined by user pairs may be shorter than or at best equal to that by each user .",
    "further , different from the p2p cellular system , the throughput of the whole relaying system is determined by the weaker one between the uplink and downlink connections .",
    "thus , it is critical to co - consider both uplink and downlink transmissions when designing the pilot scheme for the relaying system , while previous work in the literature did not take this into consideration .",
    "this paper investigates the pilot and data transmission scheme in multipair massive mimo relaying systems for both hd and fd communications . due to the massive antennas equipped on rs , the source - relay and relay - destination channels are asymptotically orthogonal to each other , and thereby the transmission phase of pilots and data",
    "can be shifted to overlap each other to reduce the overhead of pilot transmission and accordingly to improve the system performance .",
    "based on this consideration , a transmission scheme with pilot - data overlay in both hd and fd communications is proposed in this paper . here , the main contributions of the paper are summarized as follows :    * * pilot - data overlay transmission scheme design : * a transmission scheme with pilot - data overlay in both hd and fd multipair massive mimo relaying systems is proposed and designed . in the hd overlay scheme , destination pilots are transmitted simultaneously with source data transmission , such that the effective data transmission duration is increased . moreover ,",
    "both source and destination pilots are transmitted along with data transmission in the fd system and thus the effective data transmission duration can be further increased .",
    "however , pilot and data contaminate each other at the rs due to the simultaneous transmission .",
    "nevertheless , by exploiting the asymptotic orthogonality of massive mimo channels , this paper demonstrates that the received data and pilots can be well separated from each other with only residues of additive thermal noise by applying the mrc processing .",
    "after all , the effective data transmission duration is extended within the limited coherence time interval and therefore the overall system performance is improved . * * closed - form achievable rates and comparison with conventional schemes : * this paper derives _ closed - form expressions _ of the ergodic achievable rates of the considered relaying systems with the proposed scheme .",
    "the derived expression reveals that the loop interference ( li ) in the fd overlay scheme can be effectively suppressed by the growing number of rs antennas and no error propagation exists with the proposed scheme , which is a critical issue in @xcite where a semi - orthogonal pilot design is applied to the p2p system .",
    "numerical results show that the superiority of the proposed scheme persists even with 25 db li . for quantitative comparison between the proposed scheme and conventional ones , asymptotic achievable rates at both ultra - high and -low snrs",
    "are derived and the superiority of the proposed scheme is proved theoretically .",
    "* * power allocation design : * this paper designs an optimal power allocation for the fd overlay scheme to minimize the interference between pilot and data transmissions by properly regulating the source and relay data transmission power for a fixed pilot power and proposes a successive convex approximation ( sca ) approach to solve the non - convex optimization problem .",
    "simulation results indicate that the proposed approach further improves the achievable rate compared with the equal power allocation .",
    "in addition , the proposed approach is computationally efficient and converges fast . with typical configurations ( e.g. , total data transmission power at 20 db )",
    ", simulation shows that the proposed approach converges to a relative error tolerance at @xmath0 after a few , say 4 , iterations .",
    "_ organization : _ the rest of this paper is organized as follows .",
    "the channel and signal models are presented in section [ sec : systemmodel ] within which the conventional and overlay scheme is presented and proposed , respectively . in the following section [ sec : channelestimation ] , channel estimations of the proposed scheme applying to both hd and fd relaying systems",
    "are elaborated in details and the system achievable rates are derived theoretically in section [ sec : achievablerateanalysis ] .",
    "section [ sec : asymptoticanalysis ] and [ sec : powerallocation ] extend the analyses to the asymptotic scenario and power allocation consideration , respectively .",
    "the results presented in section [ sec : numericalresults ] reveal the performance comparisons numerically .",
    "section [ sec : conclusion ] concludes our works .",
    "_ notations : _ the boldface capital and lowercase letters are used to denote matrices and vectors , respectively , while the plain lowercase letters are scalars . the superscript @xmath1 , @xmath2 and @xmath3 stands for the conjugate , transpose and conjugate - transpose of a vector or matrix , respectively .",
    "@xmath4 represents the identity matrix of size @xmath5 .",
    "the operator @xmath6 , @xmath7 and @xmath8 denotes the euclidean norm of a vector , the frobenius norm and the trace of a matrix , respectively . for statistical vectors and matrices , @xmath9 and @xmath10",
    "are utilized to represent the expectation and variance , respectively .",
    "moreover , @xmath11 is used to denote the almost sure convergence and the notation @xmath12 represents the complex gaussian random vector @xmath13 with zero mean and covariance matrix @xmath14 .",
    "finally , the postfix @xmath15 $ ] denotes the corresponding signal in the @xmath16th coherence interval .",
    "as depicted in fig . [ fig : systemmodel ] , this paper considers both hd and fd one - way relaying systems where @xmath17 pairs of single - antenna source and destination users are served by rs equipped with @xmath5 ( @xmath18 ) antennas . in the following sections , the noise power is normalized to 1 .",
    "let @xmath19 , @xmath20 and @xmath21 be the transmission power of pilots , source and forward data , respectively .",
    "the channel matrices from sources and destinations to rs are denoted by @xmath22 and @xmath23 , which are concisely named as source and destination channels , respectively , where the @xmath24 column of either matrix , @xmath25 or @xmath26 , stands for the channel vector from the @xmath24 corresponding user to rs .",
    "both channel matrices are decomposed as @xmath27 and @xmath28 , where the large - scale fading matrices @xmath29 and @xmath30 are both diagonal with the @xmath24 entries as @xmath31 and @xmath32 , respectively , and the small - scale fading matrices @xmath33 and @xmath34 are constructed by independent identically distributed ( i.i.d . )",
    "@xmath35 random variables ( rvs ) .",
    "the leakage channel of the fd communication is modeled as @xmath36 which consists of the large - scale fading factor denoted by @xmath37 and the small - scale fading matrix constructed by i.i.d .",
    "@xmath35 rvs , where @xmath38 is the leakage power gain after li cancellations @xcite .",
    "according to the experiments on mimo fd self - interference cancellation presented in @xcite , the received leakage power can be suppressed to a level almost comparable to the noise floor regardless of the transmission power ( see fig . 10 of @xcite ) .",
    "therefore , the average li power , @xmath39 , is assumed to be a constant in the following analysis .",
    "further , it is assumed that the same frequency band is reused for both uplink and downlink transmissions , and they obey the reciprocity , i.e. , the channel matrices are consistent within a coherence time interval for both uplink and downlink communications .",
    "this subsection considers the conventional pilot - data transmission scheme for both hd and fd communications .    with regard to the hd system shown by fig .",
    "[ fig : phasediagram](a ) , tdd is selected as the working mode where the source and destination users firstly transmit training pilots to help rs estimate csi , following which the sources send uplink data to rs , and then the data is forwarded to destination users @xcite .",
    "similarly , the fd system depicted in fig . [ fig : phasediagram](b ) shows that the csi is also estimated first and the data is transmitted subsequently .",
    "yet the fd rs forwards data to destinations simultaneously with source data transmission by some negligible processing time delay@xcite .    in conventional mimo systems ,",
    "the pilot scheme is always designed by utilizing orthogonal pilot sequences to prevent the inner - cell pilot contamination which requires the length of pilot sequences to be not smaller than the number of users .",
    "therefore , @xmath40 , where @xmath41 is the length of orthogonal pilot sequences .",
    "the overhead of channel estimation is at least @xmath42 of each terminal , where @xmath43 is the length of coherence time interval in terms of the number of symbol duration@xcite . in the massive mimo relaying system , this overhead is extremely large because the number of users becomes large with the increasing antenna number while the coherence interval is , to some extent , fixed mainly depending on the mobility of terminals .",
    "therefore , especially for the massive mimo with a relatively short @xmath43 , most of the effective resource would be occupied by pilots , which makes the massive mimo transmission inefficient . in order to reduce the pilot overhead and accordingly",
    "improve the data transmission efficiency , this paper proposes a pilot - data transmission overlay scheme in the following subsection .",
    "this paper proposes a pilot - data overlay transmission scheme for both hd and fd one - way relaying systems .",
    "the general design of the proposed scheme is explained in this subsection while the detailed signal transmissions will be described mathematically in sections [ sec : channelestimation ] and [ sec : achievablerateanalysis ] .    with respect to the hd relaying system",
    ", the pilot - data overlay is depicted in fig .",
    "[ fig : phasediagram](c ) . to concisely describe signal transmissions , we separate a coherence interval into four phases denoted by a , b , c and d. during phases a and b ,",
    "pilots are transmitted from users to rs , while in c and d , the sources and rs conduct data transmissions , respectively . within phase",
    "a , all source users send piece - wisely orthogonal pilot sequences to assist rs in estimating channels while destination users keep mute , thus source channels can be estimated at rs without being contaminated .",
    "subsequently , destination users start transmitting pilots in phase b , while sources can send uplink data to rs simultaneously .",
    "the rs observes both source data and destination pilots in this phase . with the source channel estimated in phase",
    "a and the quasi - orthogonality of source and destination massive mimo channels , the rs detects the source data and then is able to cancel it from the received signal , from which obtains the estimates of the destination channels .",
    "thereafter , sources keep sending uplink data in phase c and rs forwards downlink data to destination users in phase d. in the following coherence intervals , the hd relaying system repeats these communication procedures .    regarding the fd pilot - data overlay scheme ,",
    "the communication procedure is shown in fig . [",
    "fig : phasediagram](d ) . in the first coherence interval ,",
    "the pilot transmissions during phases a and b are correspondingly the same as those of the hd scheme . in phase c , due to the ability of fd ,",
    "the rs receives the source data as well as forwarding the downlink data to destinations .",
    "different from the hd overlay scheme , the downlink data forwarding during phase d is exactly overlapped by the source pilot transmission in phase a of the subsequent coherence interval .",
    "the subsequent phases of the second coherence interval correspondingly repeats those of the first interval . as for the third and following coherence intervals , the communication procedures are identical to those of the second interval .",
    "[ rmk : overhead ] the pilot transmission overhead can be calculated by @xmath44 , where @xmath45 and @xmath46 for the conventional and proposed schemes , respectively .",
    "hence , it is straightforward to obtain the overheads of the conventional and proposed schemes to be @xmath47 and @xmath48 , respectively .",
    "it is obvious that @xmath49 , especially for the massive mimo scenario where @xmath17 can be large .",
    "[ rmk : throughput ] for a non - buffered relaying system where the number of forwarding data exactly equals to that of the source data , the portion of data transmission within a coherence interval can be calculated as @xmath50 in the hd overlay system , where @xmath51 .",
    "compared to that , it is further increased to @xmath52 in the fd system , where @xmath53 is the total number of successive coherence intervals used for communications and the approximation is taken when @xmath53 is large .",
    "fd almost doubles the efficiency of hd data transmission due to the fd property and the proposed pilot - data overlay structure .",
    "note that the source pilot transmission is not indented to overlap the downlink data transmission of the previous coherence interval in the hd mode .",
    "it is argued that a tdd rs can not receive source pilots when the transceiver is working in the transmission mode .",
    "therefore , the fd overlay scheme economizes more resources for data transmissions than the hd one .",
    "in this section , the mathematical formulations of channel estimations with the proposed scheme are presented for both duplex relaying systems .      in the proposed pilot - data overlay structure , the source channel estimations during the first coherence interval for both duplex systems are identical ( see figs . [",
    "fig : phasediagram](c ) and [ fig : phasediagram](d ) ) .    in the first coherence interval ,",
    "the rs receives source pilots without contamination during phase a while the transmitter of rs and all destination users keep mute .",
    "supposing source users send the pilot matrix @xmath54 to rs with power @xmath19 per user , where the @xmath55th row of the matrix , @xmath56 , is the pilot sequence sent by the @xmath55th source user and @xmath57 due to orthogonality , the received signal at rs can be expressed as @xmath58 = \\sqrt{k\\rho_\\mathrm{p}}\\mathbf{g}_\\mathrm{s}[1]\\bm{\\phi } + \\mathbf{n}^\\mathrm{a}[1]\\ ] ] where @xmath59 $ ] is the additive white gaussian noise ( awgn ) matrix constructed by @xmath35 rvs . by employing the mmse criteria , the estimate of source channels",
    "can be obtained as @xmath60 = \\frac{1}{\\sqrt{k\\rho_\\mathrm{p}}}\\mathbf{r}^\\mathrm{a}[1]\\bm{\\phi}^{{\\mathrm{h}}}\\mathbf{\\tilde{d}}_\\mathrm{s}[1]\\ ] ] where @xmath61\\triangleq(\\mathbf{i}_k+\\frac{1}{k\\rho_\\mathrm{p}}\\mathbf{d}_\\mathrm{s}^{-1})^{-1}$ ] . due to the property of mmse estimation",
    ", the channel matrix can be decomposed into two independent components as @xmath62 = \\mathbf{\\hat{g}}_\\mathrm{s}[1 ] + \\mathcal{e}_\\mathrm{s}[1]\\ ] ] where @xmath63 $ ] is the error matrix constructed by columns mutually independent of the corresponding column entries of @xmath64 $ ] , mathematically , @xmath65 = \\mathbf{\\hat{g}}_{\\mathrm{s}k}[1 ] + \\bm{\\varepsilon}_{\\mathrm{s}k}[1]\\ ] ] where @xmath66 $ ] and @xmath67 $ ] are the @xmath55th ( @xmath68 ) column vector of @xmath64 $ ] and @xmath63 $ ] , respectively , @xmath66\\sim{{\\mathcal{cn}}}(\\mathbf{0 } , \\sigma_{\\mathrm{s}k}^2[1]\\mathbf{i}_m)$ ] , @xmath67\\sim{{\\mathcal{cn}}}(\\mathbf{0 } , \\varepsilon_{\\mathrm{s}k}^2[1]\\mathbf{i}_m)$ ] , @xmath69= k\\rho_\\mathrm{p}\\beta_{\\mathrm{s}k}^2/(1+k\\rho_\\mathrm{p}\\beta_{\\mathrm{s}k})$ ] , and @xmath70\\triangleq\\beta_{\\mathrm{s}k}-\\sigma_{\\mathrm{s}k}^2[1]$ ] .      according to remark [ rmk : throughput ] and fig .",
    "[ fig : phasediagram](c ) , the scenario of hd source pilot transmission ( phase a ) is identical for all coherence intervals and hence the hd source channel estimation is fully addressed in subsection [ sec : sourcechannelestimationfirstinterval ]",
    ". however , the story differs regarding the fd where the transmitter of rs is working on forwarding the downlink data ( phase d ) while the receiver is receiving source pilots simultaneously ( phase a ) in the second coherence interval and after .",
    "therefore , the rs receives both the source pilots and downlink data leakages , which means that the source pilot is contaminated by li .",
    "this subsection considers the source channel estimation of the fd mode in the second and succeeding coherence intervals and characterizes the estimation errors introduced by both awgn and li .    without loss of generality ,",
    "take the @xmath16th ( @xmath71 ) coherence time interval for instance .",
    "the received source pilots at rs can be expressed as @xmath72 = & \\underbrace{\\sqrt{k\\rho_\\mathrm{p}}\\mathbf{g}_\\mathrm{s}[\\iota]\\bm{\\phi}}_{\\text{desired signal } } + \\\\                                          & \\underbrace{\\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota-1]\\mathbf{g}_\\mathrm{li}\\mathbf{\\hat{g}}_\\mathrm{d}[\\iota-1]\\mathbf{x}^\\mathrm{d}[\\iota-1]}_{\\text{li } } + \\underbrace{\\mathbf{n}^\\mathrm{a}[\\iota]}_{\\text{awgn } }      \\end{split}\\ ] ] where @xmath19 and @xmath21 represent the transmission power of source pilots and rs forwarding data , respectively , @xmath73 $ ] ( given by ( [ eq : destinationchannest ] ) ) denotes the mrt precoding matrix of the forwarding data @xmath74 $ ] with a power normalization factor @xmath75 $ ] , and @xmath76\\in\\mathbb{c}^{m\\times k}$ ] is the noise matrix constructed by @xmath35 rvs . for detailed descriptions of the li term and the expression of @xmath75 $ ] refer to sections [ sec : downlinkanalysis ] and [ sec : analysisofuplinkphasec ] . by applying mmse channel estimation ,",
    "the estimate of the source channels is obtained by @xmath77=\\frac{1}{\\sqrt{k\\rho_\\mathrm{p}}}\\mathbf{r}^\\mathrm{a}[\\iota]\\bm{\\phi}^\\mathrm{h}\\mathbf{\\tilde{d}}_\\mathrm{s}[\\iota]\\ ] ] where @xmath78\\triangleq\\left(\\mathbf{i}_k+\\frac{\\rho_\\mathrm{d}\\beta_\\mathrm{li}+1}{k\\rho_\\mathrm{p}}\\mathbf{d}_\\mathrm{s}^{-1}\\right)^{-1}$ ] .",
    "similarly , the channel matrix can also be decomposed into mutually independent two components as follows : @xmath79 = \\mathbf{\\hat{g}}_\\mathrm{s}[\\iota ] + \\mathcal{e}_\\mathrm{s}[\\iota]\\ ] ] where @xmath80 $ ] denotes the error matrix of estimations . with regard to the @xmath55th columns of matrices",
    "@xmath81 $ ] and @xmath80 $ ] , there exist @xmath82\\sim\\mathcal{cn}\\left(\\mathbf{0 } , \\sigma_{\\mathrm{s}k}^2[\\iota]\\mathbf{i}_m\\right)$ ] and @xmath83\\sim\\mathcal{cn}\\left(\\mathbf{0 } , \\varepsilon_{\\mathrm{s}k}^2[\\iota]\\mathbf{i}_m\\right)$ ] , where @xmath84\\triangleq{k\\rho_\\mathrm{p}\\beta_{\\mathrm{s}k}^2}/(\\rho_\\mathrm{d}\\beta_\\mathrm{li}+1+k\\rho_\\mathrm{p}\\beta_{\\mathrm{s}k})$ ] and @xmath85\\triangleq\\beta_{\\mathrm{s}k}-\\sigma_{\\mathrm{s}k}^2[\\iota]$ ] , respectively , for @xmath55 from @xmath86 to @xmath17 .      in this subsection , the communication in phase b is formulated during which the source data and destination pilots are transmitted simultaneously .",
    "to simplify the description , the source data is separated into two successive parts as @xmath87 $ ] , where @xmath88 is the source data transmitted within phase b and @xmath89 is within phase c. here , @xmath90 is the total length of the source data to transmit by each user within a coherence interval . without loss of generality ,",
    "we assume @xmath91 .",
    "the source data @xmath92 is transmitted alongside destination pilots transmission .",
    "the following elaboration reveals that @xmath92 can be exactly detected from the received signal and the contamination to destination channel estimation can be suppressed by applying source data cancellation with a large number of rs antennas , due to the orthogonality between uplink and downlink channels .    at first",
    ", the rs detects the source data from the interfered received signal which can be expressed as @xmath93 = \\sqrt{\\rho_\\mathrm{s}}\\mathbf{g}_\\mathrm{s}[\\iota]\\mathbf{s}^\\mathrm{b}[\\iota ] + \\sqrt{k\\rho_\\mathrm{p}}\\mathbf{g}_\\mathrm{d}[\\iota]\\bm{\\psi } + \\mathbf{n}^\\mathrm{b}[\\iota]\\ ] ] where @xmath94 denotes the destination pilot matrix transmitted at power @xmath19 per user and @xmath95 $ ] is the awgn matrix consisting of @xmath35 rvs .",
    "the mrc is applied to combine signals received by the rs antennas , where the combiner is @xmath81 $ ] given by ( [ eq : sourcechannest ] ) .",
    "hence , the combined signal is @xmath96 = \\mathbf{\\hat{g}}_\\mathrm{s}^{{\\mathrm{h}}}[\\iota]\\mathbf{r}^\\mathrm{b}[\\iota].\\ ] ] therefore , by employing the law of large numbers @xcite , proposition [ prp : sourcedatadetectionsb ] summarizes the source data detection .",
    "[ prp : sourcedatadetectionsb ] with mrc processing , the source data @xmath97 $ ] can be exactly detected from @xmath98 $ ] , if a large number of reception antennas are equipped at rs , i.e. , @xmath99 .",
    "see appendix [ apdx : prf : prp : sourcedatadetectionsb ] .",
    "hereby , it is ready to estimate the destination channel by canceling the detected source data from the received signal to reduce pilot contaminations . by recalling the received signal from ( [ eq : receivedsignalsb ] ) and subtracting the product of the detected source signal and the hermitian of the estimated source channels , we obtain the mmse estimation of the destination channels as @xmath100 = \\frac{1}{\\sqrt{k\\rho_\\mathrm{p}}}\\left(\\mathbf{r}^\\mathrm{b}[\\iota]-\\sqrt{\\rho_\\mathrm{s}}\\mathbf{\\hat{g}}_\\mathrm{s}[\\iota]\\mathbf{s}^\\mathrm{b}[\\iota]\\right)\\bm{\\psi}^{{\\mathrm{h}}}\\mathbf{\\tilde{d}}_\\mathrm{d}[\\iota]\\ ] ] where @xmath101\\triangleq\\left(\\mathbf{i}_k+\\frac{\\rho_\\mathrm{s}\\sum_{i=1}^{k}\\varepsilon_{\\mathrm{s}i}^2[\\iota]+1}{k\\rho_\\mathrm{p}}\\mathbf{d}_\\mathrm{d}^{-1}\\right)^{-1}$ ] . and the mmse estimation follows @xmath102",
    "= \\mathbf{\\hat{g}}_{\\mathrm{d}}[\\iota ] + \\mathcal{e}_{\\mathrm{d}}[\\iota]\\ ] ] where @xmath103 $ ] and @xmath104 $ ] are independent of each other .",
    "particularly , the @xmath55th columns of both matrices , @xmath105 $ ] and @xmath106 $ ] , are mutually independent random vectors , following distribution @xmath107\\mathbf{i}_m)$ ] and @xmath108\\mathbf{i}_m)$ ] , respectively , where @xmath109\\triangleq k\\rho_\\mathrm{p}\\beta_{\\mathrm{d}k}^2/\\left(\\rho_\\mathrm{s}\\sum_{i=1}^{k}\\varepsilon_{\\mathrm{s}i}^2[\\iota]+1 + k\\rho_\\mathrm{p}\\beta_{\\mathrm{d}k}\\right)$ ] and @xmath110\\triangleq\\beta_{\\mathrm{d}k}-\\sigma_{\\mathrm{d}k}^2[\\iota]$ ] , for @xmath55 from @xmath86 to @xmath17 .    the covariance factor of the source channel estimate ,",
    "@xmath84 $ ] , is independent of the coherence interval index @xmath16 .",
    "in addition , the factor of destination channel estimate , @xmath109 $ ] , only depends on the source channel estimation errors , which are independent of @xmath16 . from this phenomenon",
    ", it is interesting to note that no error propagation exists for the proposed pilot - data transmission scheme in both duplex relaying systems , which differs from the semi - orthogonal pilot design proposed in @xcite where csi estimation errors accumulate as the increase of @xmath16 .",
    "this section characterizes the performance of the proposed pilot - data transmission scheme by evaluating achievable rates of the considered massive mimo relaying systems . for the multipair communication ,",
    "the normalized system achievable rate is defined as an average of sum rates among all user pairs over the entire transmission time , that is @xmath111.\\ ] ] the individual achievable rate in the decode - and - forward ( df ) relaying system is given by @xmath112 = \\min\\{\\mathcal{r}^\\mathrm{ul}_k[\\iota ] , \\mathcal{r}^\\mathrm{dl}_k[\\iota]\\},\\ ] ] where @xmath113 $ ] and @xmath114 $ ] denote the uplink and downlink rates between user pair @xmath55 and rs in the coherence interval @xmath16 , respectively . here",
    "we employ the technique developed by @xcite to approximate the ergodic achievable rate for per - link communication , i.e. , @xmath113 $ ] and @xmath114 $ ] . in this technique",
    ", the received signal is separated into desired signal and effective noise terms , where the former term is the product of transmitted signal and the expectation of channels while the latter one consists of uncorrelated interferences and awgn .",
    "hence , only the statistical , other than instantaneous , csi is required to evaluate the achievable rate .",
    "the rate calculated by this technique is the lower bound of the exact one , and numerical results presented in both @xcite and @xcite show that it is tolerably close to the genie result produced by monte - carlo simulation .",
    "consequently , the per - link ergodic achievable rate within a coherence interval is bounded by @xmath115 = \\tau_\\mathrm{d}[\\iota]\\log_2(1+\\gamma_k^{\\mathrm{pl}}[\\iota])\\ ] ] where @xmath116 $ ] denotes the data transmission time within the coherence interval @xmath16 and the effective signal to noise ratio is defined as @xmath117\\triangleq\\mathcal{s}_k^{\\mathrm{pl}}[\\iota ] / ( \\mathcal{i}_k^{\\mathrm{pl}}[\\iota ] + \\mathcal{n}_k^{\\mathrm{pl}}[\\iota])$ ] . here ,",
    "@xmath118 $ ] , @xmath119 $ ] and @xmath120 $ ] represent the power of the desired signal , uncorrelated interference and awgn , respectively .      here",
    "the downlink achievable rates for both hd and fd schemes are analyzed . by applying the mrt processing at the rs to the downlink data @xmath121\\in{{\\mathbb{c}}}^{k\\times t_\\mathrm{d}}$ ] and transmitting to the destination channels with power @xmath21 ,",
    "the received signal at destination users is obtained , for user @xmath55 ( @xmath68 ) , as @xmath122 = \\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota]\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_\\mathrm{d}[\\iota]\\mathbf{x}[\\iota ] + \\mathbf{z}_k[\\iota]\\ ] ] where @xmath123\\in{{\\mathbb{c}}}^{1\\times t_\\mathrm{d}}$ ] is the awgn vector consisting of @xmath124 rvs and @xmath125 $ ] is the factor to normalize the average transmit power , i.e. , letting @xmath126\\mathbf{\\hat{g}}_\\mathrm{d}[\\iota]\\|^2\\}=1 $ ] , thus @xmath125=\\sqrt{1\\big/\\left(m\\sum_{i=1}^{k}\\sigma_{\\mathrm{d}i}^2[\\iota]\\right)}$ ] . to separate the desired signal from the interference and noise , ( [ eq : downlinkreceivedsignal ] ) can be rewritten as @xmath127=\\underbrace{\\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota]{{\\mathbb{e}}}\\left\\{\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}k}[\\iota]\\right\\}\\mathbf{x}_k[\\iota]}_{\\text{desired signal } } + \\underbrace{\\mathbf{\\breve{z}}_k[\\iota]}_{\\text{effective noise}}\\ ] ] where the effective noise is defined by @xmath128 \\triangleq & \\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota]\\left(\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}k}[\\iota]-{{\\mathbb{e}}}\\left\\{\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}k}[\\iota]\\right\\}\\right)\\mathbf{x}_k[\\iota]\\\\          & + \\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota]\\sum_{i=1,i\\neq k}^{k}\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}i}[\\iota]\\mathbf{x}_i[\\iota ] + \\mathbf{z}_k[\\iota ] .",
    "\\end{split}\\ ] ] therefore , the effective sinr of the received signal at the @xmath55th destination user can be expressed as @xmath129 = \\frac{\\rho_\\mathrm{d}\\alpha^2[\\iota]\\left|{{\\mathbb{e}}}\\left\\{\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}k}[\\iota]\\right\\}\\right|^2}{\\rho_\\mathrm{d}\\alpha^2[\\iota]{{\\mathbb{v}\\mathrm{ar}}}\\left\\{\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}k}[\\iota]\\right\\ } + \\mathrm{mi}_k^{\\mathrm{dl}}[\\iota ] + 1}\\ ] ] where the power of the downlink multipair interference ( mi ) is defined by @xmath130\\triangleq\\rho_\\mathrm{d}\\alpha^2[\\iota]\\sum_{i=1,i\\neq k}^{k}{{\\mathbb{e}}}\\left\\{\\left|\\mathbf{g}_{\\mathrm{d}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{\\hat{g}}_{\\mathrm{d}i}[\\iota]\\right|^2\\right\\}.\\ ] ]    [ thm : downlinkachievablerate ] by employing the mrt processing , the achievable rate of the downlink data forwarded to the destination user @xmath55 ( @xmath68 ) in both hd and fd , for a finite number of rs transmitter antennas @xmath5 , can be characterized by @xmath131 = t_d\\log_2\\left(1+\\gamma_k^{\\mathrm{dl}}[\\iota]\\right)\\ ] ] where @xmath132 = \\frac{m\\sigma_{\\mathrm{d}k}^4[\\iota]}{(\\beta_{\\mathrm{d}k}+1/\\rho_\\mathrm{d})\\sum_{i=1}^{k}\\sigma_{\\mathrm{d}i}^2[\\iota]}.\\ ] ]    see appendix [ apdx : prf : thm : downlinkachievablerate ] .      in the proposed pilot - data overlay scheme ,",
    "the uplink data is transmitted in two successive phases where the first part of data is transmitted during phase b and the remaining is sent within phase c. for the two duplex systems , the phase b communication is similar while the phase c differs .",
    "the following description first conducts the rate analysis of phase b for both duplex systems , and then perform the phase c analysis distinguished by each mode .      the @xmath55th row of @xmath98 $ ] in ( [ eq : datadetectionsb ] )",
    "can be rewritten as @xmath133=\\underbrace{\\sqrt{\\rho_\\mathrm{s}}{{\\mathbb{e}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}\\mathbf{s}^\\mathrm{b}_k[\\iota]}_{\\text{desired signal}}+\\underbrace{\\mathbf{\\breve{n}}^\\mathrm{b}_k[\\iota]}_{\\text{effective noise}}\\ ] ] where the effective noise is @xmath134\\triangleq & \\sqrt{\\rho_\\mathrm{s}}\\left(\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]-{{\\mathbb{e}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}\\right)\\mathbf{s}^\\mathrm{b}_k[\\iota]\\\\          & + \\sqrt{\\rho_\\mathrm{s}}\\sum_{i=1,i\\neq k}^{k}\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}i}[\\iota]\\mathbf{s}^\\mathrm{b}_i[\\iota]\\\\          & + \\sqrt{k\\rho_\\mathrm{p}}\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{d}}[\\iota]\\bm{\\psi }           + \\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{n}^\\mathrm{b}[\\iota ] .",
    "\\end{split}\\ ] ] then , the effective sinr of the received signal during phase b can be expressed by @xmath135=\\frac{\\rho_\\mathrm{s}\\left|{{\\mathbb{e}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}\\right|^2}{\\rho_\\mathrm{s}{{\\mathbb{v}\\mathrm{ar}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}+\\mathrm{mi}_k^\\mathrm{ul}[\\iota]+\\mathrm{pi}_k^\\mathrm{ul}[\\iota]+\\mathrm{an}_k^\\mathrm{ul}[\\iota]}\\ ] ] where the power of uplink mi , destination pilot interference ( pi ) and awgn are respectively defined as @xmath136&\\triangleq\\rho_\\mathrm{s}\\sum_{i=1,i\\neq k}^k{{\\mathbb{e}}}\\left\\{\\left|\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}i}[\\iota]\\right|^2\\right\\ } \\\\",
    "\\label{eq : uplinkpi }      \\mathrm{pi}_k^\\mathrm{ul}[\\iota]&\\triangleq\\rho_\\mathrm{p}{{\\mathbb{e}}}\\left\\{\\left\\|\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{d}}[\\iota]\\right\\|^2\\right\\}\\\\      \\label{eq : uplinkan }      \\mathrm{an}_k^\\mathrm{ul}[\\iota]&\\triangleq{{\\mathbb{e}}}\\left\\{\\left\\|\\mathbf{\\hat{g}}_{\\mathrm{s}k}[\\iota]\\right\\|^2\\right\\}.\\end{aligned}\\ ] ]      regarding the uplink data transmission during phase c , only mi interferes for the hd communication while for the fd , li also exists .",
    "the received signal at rs during phase c can be expressed as @xmath137=\\sqrt{\\rho_\\mathrm{s}}\\mathbf{g}_\\mathrm{s}[\\iota]\\mathbf{s}^\\mathrm{c}[\\iota]+\\mathbf{l}^\\mathrm{c}[\\iota]+\\mathbf{n}^\\mathrm{c}[\\iota]\\ ] ] where @xmath138\\triangleq\\sqrt{\\rho_\\mathrm{d}}\\alpha[\\iota]\\mathbf{g}_\\mathrm{li}[\\iota]\\mathbf{\\hat{g}}_\\mathrm{d}^{{\\mathrm{h}}}[\\iota]\\mathbf{x}^\\mathrm{c}[\\iota]$ ] is the li for the fd relaying while for hd , it is zero , and @xmath139 $ ] is the awgn matrix . by applying mrc to the @xmath55th source data with similar manipulations to the combined signal as in ( [ eq : receivedsignaldecomposesb ] ) , the effective sinr of the received signal during phase c is obtained as @xmath140=\\frac{\\rho_\\mathrm{s}\\left|{{\\mathbb{e}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}\\right|^2}{\\rho_\\mathrm{s}{{\\mathbb{v}\\mathrm{ar}}}\\left\\{\\mathbf{\\hat{g}}_{\\mathrm{s}k}^{{\\mathrm{h}}}[\\iota]\\mathbf{g}_{\\mathrm{s}k}[\\iota]\\right\\}+\\mathrm{mi}_k^\\mathrm{ul}[\\iota]+\\mathrm{li}_k^\\mathrm{ul}[\\iota]+\\mathrm{an}_k^\\mathrm{ul}[\\iota]}\\ ] ] where @xmath141 $ ] and @xmath142 $ ] are respectively defined by ( [ eq : uplinkmi ] ) and ( [ eq : uplinkan ] ) , and the power of li is defined as @xmath143\\triangleq\\begin{cases }      0 , & \\text{hd}\\\\      \\rho_\\text{d}\\alpha^2[\\iota]{{\\mathbb{e}}}\\left\\{\\left\\|\\mathbf{\\hat{g}}_{\\text{s}k}^\\text{h}[\\iota]\\mathbf{g}_{\\text{li}}[\\iota]\\mathbf{\\hat{g}}_\\mathrm{d}[\\iota]\\right\\|^2\\right\\ } , & \\text{fd}.      \\end{cases}\\ ] ]    finally , the uplink achievable rates of pilot - data overlay relaying systems are given by theorem [ thm : uplinkachievablerate ] .",
    "[ thm : uplinkachievablerate ] with mrc processing , the uplink achievable rate of source user @xmath55 ( @xmath144 ) during coherence interval @xmath16 in both hd and fd systems , for a finite antenna number @xmath5 , can be characterized by @xmath145=k\\log_2(1+\\gamma_k^\\mathrm{b}[\\iota])+(t_\\mathrm{d}-k)\\log_2(1+\\gamma_k^\\mathrm{c}[\\iota])\\ ] ] where @xmath146 = \\frac{m\\sigma_{\\mathrm{s}k}^2[\\iota]}{\\sum_{i=1}^{k}\\beta_{\\mathrm{s}i}+\\left(\\rho_\\mathrm{p}\\sum_{i=1}^{k}\\beta_{\\mathrm{d}i}+1\\right)/\\rho_\\mathrm{s}}\\ ] ] and @xmath147 = \\begin{cases }              \\frac{m\\sigma_{\\mathrm{s}k}^2[\\iota]}{\\sum_{i=1}^{k}\\beta_{\\mathrm{s}i } + 1/\\rho_\\mathrm{s } } , & \\text{hd}\\\\              \\frac{m\\sigma_{\\mathrm{s}k}^2[\\iota]}{\\sum_{i=1}^{k}\\beta_{\\mathrm{s}i } + \\left(\\rho_\\mathrm{d}\\beta_\\mathrm{li}+1\\right)/\\rho_\\mathrm{s } } , & \\text{fd}.          \\end{cases}\\ ] ]    see appendix [ apdx : prf : thm : uplinkachievablerate ]    having the numerator and denominator of the fd case in ( [ eq : gammauplinkc ] ) both divided by @xmath5 , it is observed that the li term , @xmath148 , vanishes as the number of rs antennas tending infinity , i.e. , @xmath149 .",
    "this is consistent with the observation on li discovered in @xcite but for a different pilot - data transmission scheme .",
    "this section analyzes the asymptotic performance of the proposed scheme at high and low snr regions in comparison to the conventional pilot scheme under the assumption that a large number of user pairs are served by large - scale rs antennas . in following asymptotic derivations",
    ", it is assumed that the transmit power of all data and pilot is identical , i.e. , @xmath150 .",
    "firstly , the asymptotic performance at the high snr region is analyzed with the proposed pilot scheme . by setting @xmath151 , the effective sinrs denoted by ( [ eq : gammauplinkb ] ) , ( [ eq : gammauplinkc ] ) and ( [ eq : gammadownlink ] ) can be written as    @xmath152=&\\frac{m\\beta_{\\text{s}k}}{\\sum_{i=1}^{k}\\beta_{\\text{s}i}+\\sum_{i=1}^{k}\\beta_{\\text{d}i}}\\\\          \\label{eq : asymphighsnrgammauplinkc }          \\lim_{\\rho\\to\\infty}\\gamma_k^\\mathrm{c}[\\iota]=&\\frac{m\\beta_{\\text{s}k}}{\\sum_{i=1}^{k}\\beta_{\\text{s}i } }      \\end{aligned}\\ ] ]    and @xmath153=\\frac{m\\beta_{\\text{d}k}}{\\sum_{i=1}^{k}\\beta_{\\text{d}i}}.\\ ] ] in the above derivations , the channel estimate covariance factors are calculated as @xmath154=\\beta_{\\mathrm{s}k}$ ] and @xmath155=\\beta_{\\text{d}k}$ ] .",
    "on the other hand , the low snr region is considered by assuming @xmath156 .",
    "it is straightforward to obtain the effective sinrs of the uplink data transmission at low snr as @xmath157 = \\lim_{\\rho\\to 0}\\gamma_k^\\mathrm{c}[\\iota ] = mk\\rho^2\\beta_{\\text{s}k}^2\\ ] ] where @xmath158=k\\rho\\beta_{\\text{s}k}^2 $ ] . with similar manipulations ,",
    "the downlink effective sinr expressed by ( [ eq : gammadownlink ] ) can be reformulated as @xmath159 = \\frac{mk\\rho^2\\beta_{\\text{d}k}^4}{\\sum_{i=1}^{k}\\beta_{\\text{d}i}^2}\\ ] ] where @xmath160=\\beta_{\\text{s}k}-k\\rho\\beta_{\\text{s}k}^2 $ ] and @xmath161=k\\rho\\beta_{\\text{d}k}^2 $ ] .",
    "by respectively substituting the above asymptotic effective sinrs into ( [ eq : uplinkachievablerate ] ) and ( [ eq : downlinkachievablerate ] ) , the asymptotic per - link achievable rates are obtained , and hence the asymptotic overall system rate by summing them up .    for comparisons , the asymptotic achievable rates with the conventional pilot scheme at both high and low",
    "snrs are presented as follows :    @xmath162    note that @xmath163 is used to indicate the conventional scheme in this section .    by comparing the achievable rates of two pilot schemes via the effective sinrs computed above , corollary [ cry : asymptoticresults ]",
    "is drawn to confirm the advantages of the proposed scheme .",
    "[ cry : asymptoticresults ] with a large number of user pairs served by rs , the proposed pilot - data overlay transmission scheme outperforms the conventional one in multipair hd and fd massive mimo relaying systems for both high and low snrs .",
    "see appendix [ apdx : prf : cry : asymptoticresults ] .",
    "[ rmk : indepentofcointerval ] according to corollary [ cry : asymptoticresults ] , it is interesting to stress that the conclusion is independent of the coherence interval length @xmath43 and the number of successive coherence intervals used for continuous communications @xmath53 . therefore , the proposed scheme is always superior to , at least not worse than , the conventional scheme for both low and high snrs , regardless of the coherence interval length .",
    "by analyzing the effective sinrs of the fd relaying system , one can find that the self - interference between uplink and downlink data transmissions , and hence the impact upon pilots sending , is a major factor that limits the system achievable rate .",
    "therefore , making a tradeoff between uplink and downlink data transmission is necessary to improve the overall system performance .",
    "the power allocation is performed in the fd relaying system to optimize the transmit power of both source and forwarding data to control interference among uplink , downlink and pilot transmissions .",
    "note that this paper only considers balancing the source and rs data transmission power level while the power allocation for each individual source user is not taken into account .",
    "in addition , this paper assume the total power consumption of all data transmission to be constrained under a fixed pilot transmit power .",
    "in other words , data transmission power @xmath164 and @xmath165 are balanced with respect to a given @xmath166 to achieve the maximal overall system rate .    to begin with",
    ", the power allocation problem is formulated as @xmath167 \\\\          & \\text{subject to : } & & \\mathcal{r}_k[\\iota ] = \\min\\left\\{\\mathcal{r}_k^{\\text{ul}}[\\iota ] , \\mathcal{r}_k^{\\text{dl}}[\\iota]\\right\\}\\\\          & & & \\mathcal{l}t_d\\left(k\\rho_\\text{s } + \\rho_\\text{d}\\right ) = e_\\mathrm{d}\\\\          & & & k=1,2,\\cdots , k \\text { and } \\iota=1,2,\\cdots,\\mathcal{l }      \\end{aligned}\\ ] ] where @xmath168 $ ] , @xmath169 $ ] and @xmath170 $ ] denote the uplink , downlink and end - to - end ( e2e ) achievable rate between the @xmath55th user pair and rs within the @xmath16th coherence time interval , respectively , and @xmath171 is the total data transmission energy .",
    "the operator @xmath172 in the above formulation is due to the df relaying expressed in ( [ eq : userpairachievablerate ] ) , where the e2e achievable rate is determined by the minimum of the corresponding uplink and downlink rates . to remove the minimum operator , the first constraint of problem ( [ opt : fd : powalloc1 ] ) can be reformulated equivalently to @xmath173 & \\leq \\mathcal{r}_k^{\\text{ul}}[\\iota]\\\\          \\mathcal{r}_k[\\iota ] & \\leq \\mathcal{r}_k^{\\text{dl}}[\\iota ] .",
    "\\end{aligned}\\ ] ] by examining @xmath168 $ ] and @xmath169 $ ] with respect to @xmath164 and @xmath165 , it is clear that these two inequality constraints are non - convex and thus it is difficult to solve ( [ opt : fd : powalloc1 ] ) directly .    to cope with this problem , a successive convex approximation ( sca ) approach @xcite",
    "is proposed in this paper by replacing constraint ( [ opt : fd : constraintsineq1 ] ) with linear inequalities .",
    "that is to approximate both uplink and downlink rates by their first - order taylor series in the @xmath174th iteration with the known power allocation @xmath175 via @xmath176(\\bm{\\rho})=\\mathcal{r}^{\\text{ul , dl}}_k[\\iota](\\bm{\\rho}^{(i)})+\\nabla^\\text{t}\\mathcal{r}^{\\text{ul , dl}}_k[\\iota](\\bm{\\rho}^{(i)})(\\bm{\\rho}-\\bm{\\rho}^{(i)})\\ ] ] where @xmath177^\\text{t}$ ] and the superscript @xmath178 denotes the corresponding value at the @xmath174th iteration . substituting ( [ opt : fd : constraintsineq2 ] ) into ( [ opt : fd : constraintsineq1 ] ) , the optimization problem can be reformulated in the @xmath174th iteration as @xmath179 \\\\          & \\text{subject to : } & & \\mathcal{r}^{(i)}_k[\\iota ] \\leq \\mathcal{r}^{\\text{ul}}_k[\\iota](\\bm{\\rho}^{(i)})+\\nabla^\\text{t}\\mathcal{r}^{\\text{ul}}_k[\\iota](\\bm{\\rho}^{(i)})(\\bm{\\rho}-\\bm{\\rho}^{(i)})\\\\          & & & \\mathcal{r}^{(i)}_k[\\iota ] \\leq \\mathcal{r}^{\\text{dl}}_k[\\iota](\\bm{\\rho}^{(i)})+\\nabla^\\text{t}\\mathcal{r}^{\\text{dl}}_k[\\iota](\\bm{\\rho}^{(i)})(\\bm{\\rho}-\\bm{\\rho}^{(i)})\\\\          & & & \\mathcal{l}t_d\\left(k\\rho_\\text{s } + \\rho_\\text{d}\\right ) = e_\\mathrm{d}\\\\          & & & k=1,2,\\cdots , k \\text { and } \\iota=1,2,\\cdots,\\mathcal{l}.      \\end{aligned}\\ ] ] it is obvious that ( [ opt : fd : powalloc2 ] ) is a linear programming ( lp ) which can be solved efficiently by utilizing , e.g. , the conventional interior - point method @xcite .",
    "the lp in ( [ opt : fd : powalloc2 ] ) is solved repeatedly in iterations with @xmath174 increased by 1 each time , until the increment of @xmath175 is smaller than a set error tolerance .",
    "after all , the @xmath175 in the last iteration is the optimal power allocation @xmath180 that leads to the maximum sum rate .",
    "the sca approach is summarized by algorithm [ algtm : fd : sca ]",
    ".    the complexity and convergence analyses of the proposed sca approach will be discussed in the numerical results of the next section .",
    "solve optimization problem ( [ opt : fd : powalloc1 ] ) @xmath17 , @xmath5 , @xmath53 , @xmath19 , @xmath181 , @xmath31 and @xmath32 optimized power allocation @xmath182 and @xmath183 initialize @xmath184 and set @xmath185 initialize @xmath186 solve the lp in ( [ opt : fd : powalloc2 ] ) and obtain the optimizer @xmath180 stop * loop * @xmath187 @xmath188 output @xmath182 and @xmath183 .",
    "in this section , the performance of the proposed pilot - data overlay transmission scheme and the power allocation approach are studied by simulation and numerical evaluation for both hd and fd relaying systems . unless otherwise specified , by default , the rs is equipped with 128 antennas serving 10 pairs of users , @xmath189 is set to be 3 db over the noise floor , the processing delay of the fd relaying for",
    "the conventional pilot scheme is 1 symbol slot , the coherence time interval is set to be 40 time slots , the transmission power of pilots , source data and forwarding data satisfy @xmath190 db , and the monte carlo results are obtained by taking the average of 1000 random simulations with instantaneous channels .",
    "firstly , the system achievable rates under different snrs are evaluated and the performance is compared between the proposed and conventional schemes for both hd and fd relayings .",
    "the performance comparisons are shown in fig .",
    "[ fig : achievableratesnr ] where the snr varies from -30 db to 30 db . in the figure ,",
    "the lines represent the rates obtained by monte carlo simulation while the markers denote the ergodic achievable rate lower bound computed by the closed - form expressions with statistical csi ( refer to as theorem [ thm : downlinkachievablerate ] and [ thm : uplinkachievablerate ] ) .",
    "the comparison shows that the relative performance gap between monte carlo and the closed - form results is small , e.g. , 1.76 bits / s / hz for fd and 0.82 bits / s / hz for hd at 0 db of snr , which implies that our closed - form ergodic achievable rate expression is a good predictor for the system performance .",
    "in addition , fig .",
    "[ fig : achievableratesnr ] shows that the proposed scheme outperforms the conventional one in both high and low snr regions , which verifies corollary [ cry : asymptoticresults ] , where about 7.5 bits / s / hz and 2.5 bits / s / hz improvements are observed in the high snr region for the fd and hd systems , respectively . on top of that",
    ", the fd mode is shown exceeding the hd in system rates by about 13.6 bits / s / hz in high snrs with the proposed scheme , which verifies remark [ rmk : throughput ] .",
    "next , the performance of the massive mimo system versus the growing number of rs antennas is depicted in fig .",
    "[ fig : achievableratenumant ] .",
    "it is obvious that the rate gap between the proposed and conventional schemes increases as the number of rs antennas grows . with more rs antennas ,",
    "the source and destination channels are closer to be orthogonal to each other , and thus less interferences reside in the combined signal leading to improved performance of the proposed scheme .",
    "as expected , the increase of the li power degrades the fd performance and fig .",
    "[ fig : achievableratenumant ] shows the superiority of the proposed scheme in the fd system as the li power equals to both as small as 0 db and as large as 25 db .",
    "further , even as few as 20 antennas are deployed on rs , the proposed scheme still outperforms the conventional one , which verifies that the proposed scheme is feasible and superior even in medium scale mimo relaying systems .        as discussed in section [ sec : powerallocation ] , further performance improvement of the proposed scheme can be obtained by balancing the tradeoff between pilot overhead and channel estimation accuracy where the estimation precision decreases due to the data interference as the percentage of data transmission time within a coherence interval increases .",
    "therefore , the length of the coherence interval and the snr of the received pilots are two crucial system parameters that affect the channel estimation overhead and accuracy , respectively . here , the performance improvement of the proposed scheme is verified with respect to the length of coherence intervals . according to fig .",
    "[ fig : achievableratecotime ] , the achievable rate of the proposed scheme always outperforms the conventional one for coherence interval from 20 to 300 time slots at both high and low snrs , which verifies the conclusion in remark [ rmk : indepentofcointerval ] .",
    "nonetheless , the gap between the two schemes decreases with the increase of the interval length due to the reduction of relative pilot transmission overhead within a longer coherence interval .        in practical systems ,",
    "the network operator would prefer to serve more user pairs to improve the overall performance of the entire system at long coherence intervals , especially when a large number of antennas exist@xcite .",
    "therefore , the performance of both pilot schemes by varying the number of user pairs is examined at a fixed coherence interval . as shown in fig .",
    "[ fig : achievableratenumuser ] , the maximal rate is achieved when 12 user pairs are communicating simultaneously in the fd system by utilizing the proposed transmission scheme while only 8 user pairs are served with the conventional scheme whose sum rate rapidly deceases with the increase of user numbers .",
    "moreover , the proposed scheme outperforms the conventional one even with 2 user pairs served by the fd relaying system , which affirms the robustness of the proposed scheme when small number of users access to the network .",
    "in the hd mode , similar performance comparisons are observed .",
    "as expected , the growing number of user pairs also enlarges the rate gap between two pilot schemes .",
    "particularly , when the number of user pairs equals to the half length of coherence interval , i.e. , @xmath191 , all hd and conventional fd curves touch zero rates due to no time resource left for data transmission , except the fd overlay system still working in the high - throughput state .",
    "therefore , the comparisons reveals that both hd and fd relaying systems employing the pilot - data overlay scheme achieve higher system rates and serve more user pairs than those with the conventional pilot scheme .",
    "further , the fd overlay system emerges to be superior to all other systems in the extreme scenario .",
    "finally , the performance of the proposed power allocation approach is evaluated for the fd overlay relaying . in the simulation ,",
    "the pilot power is fixed to be 10 db per user and the total data transmission power per coherence interval varies from -10 db to 60 db for both optimal and equal power allocations .",
    "additionally , @xmath192 is set in the equal power allocation .",
    "[ fig : achievableratesnrpowalloc ] shows the comparison of the system rates between the two allocation schemes while the convergence of the proposed approach at various cases are depicted in fig .",
    "[ fig : convergitenumpowalloc ] . fig .",
    "[ fig : achievableratesnrpowalloc ] shows that the optimal power allocation achieves better performance than the equal power allocation for both low and high transmission powers , especially at moderate power region , where the rate increment becomes more noticeable .",
    "the rate of equal power allocation starts decreasing when the data transmission power increases to an extreme large value while the proposed scheme maintains a fixed high performance .",
    "such rate decrement of equal power allocation is due to more pilot contamination when data transmission power is large yet pilot power is fixed .",
    "in contrast , the optimal power allocation scheme can adaptively adjust the data transmission power to control the interference between pilot and data transmissions and therefore always achieve the best performance . in fig .",
    "[ fig : convergitenumpowalloc ] , the number of iterations is mostly below 4 if the relative error @xmath184 in algorithm [ algtm : fd : sca ] is set to be @xmath193 , indicating the low complexity of the proposed approach .",
    "[ fig : convergitenumpowalloc ] shows that the proposed sca approach always converges fast in solving the power allocation problem .",
    "channel estimation overhead is a critical limitation on improving performance of the multiuser massive mimo systems . dealing this problem ,",
    "this paper has proposed a pilot - data overlay transmission scheme in both hd and fd one - way multipair massive mimo relaying systems .",
    "the proposed scheme has exploited the orthogonality of source - relay and relay - destination channels with massive mimo setups at the rs and redesigned the pilot and data transmission scheme to increase the effective data transmission period , which improves the achievable rate performance of the system in practice .",
    "the asymptotic analysis in both low and high snrs with infinite number rs antennas has been conducted in this paper and it has proven the superiority of the proposed scheme theoretically . finally , a power allocation problem algorithm based on sca has been proposed for the fd system , which further increases the achievable rate of the relaying system .",
    "( the law of large numbers)[lm : lawlargenumbers ] @xcite let @xmath194 and @xmath195 are two mutually independent @xmath196 random vectors consisting of i.i.d .",
    "@xmath197 and @xmath198 rvs , respectively",
    ". then @xmath199 and @xmath200 .",
    "without loss of generality , we focus on the data detection of the @xmath55th source user , where @xmath68 . by highlighting the @xmath55th row of @xmath207 and normalizing its power , ( [ eq : datadetectionsb ] ) can be rewritten as follows : @xmath208 where @xmath209 and @xmath210 are the @xmath174th rows of @xmath92 and @xmath211 , respectively . the derivation @xmath212 attributes to the decomposition of source channels depicted by eq .",
    "( [ eq : sourcechannelvectordecompositionfirstinterval ] ) .",
    "moreover , because @xmath213 is independent of @xmath214 , @xmath215 ( @xmath216 ) and @xmath217 , by dividing both denominators and numerators by @xmath5 and applying lemma [ lm : lawlargenumbers ] , the almost surely convergence in the last equality holds due to @xmath99 .",
    "therefore , @xmath218 can be exactly detected from @xmath219 .        where @xmath221 is independent of @xmath222 .",
    "@xmath223 where @xmath224 exploits lemma [ lm : fourthordermoment ] and the independence between @xmath222 and @xmath221 .",
    "mi defined by ( [ eq : midownlink ] ) can be calculated as follows : @xmath225 where @xmath226 exploits lemma [ lm : fourthordermoment ] . by substituting ( [ eq : proofdownlinke ] ) and",
    "( [ eq : proofdownlinkmi ] ) into ( [ eq : gammadownlinkorigin ] ) , the desired result comes out .",
    "the expectation , variance and uplink mi terms in both ( [ eq : gammauplinkoriginb ] ) and ( [ eq : gammauplinkoriginc ] ) can be calculated by employing the same manipulations as theorem [ thm : downlinkachievablerate ] does .",
    "the pi term is derived as @xmath227 where @xmath228 exploits the independence between @xmath229 and @xmath230 .",
    "the li term is obtained by @xmath231 where @xmath232 and @xmath233 exploit the independences among @xmath234 , @xmath235 and @xmath236 and the fact that @xmath237 , and @xmath238 takes @xmath239 .",
    "finally , the awgn term is straightforwardly derived as @xmath240 . by substituting above equations into ( [ eq : gammauplinkoriginb ] ) and ( [ eq : gammauplinkoriginc ] ) , theorem [ thm : uplinkachievablerate ] is obtained .",
    "here starts the proof with the high snr case . for the downlink , because @xmath241 and @xmath242 , it is obvious that @xmath243 for the uplink , the difference of the rates between the proposed and conventional schemes is evaluated as : @xmath244 where @xmath245 and @xmath246 .",
    "hence , @xmath247 holds , if and only if @xmath248 which is equivalent to @xmath249 where the left - hand - side term is @xmath5-dependent while the right - hand - side term is a fixed finite value . in massive mimo systems",
    ", it is always assumed that @xmath250 and therefore ( [ eq : hd : prf : highsnruplink3 ] ) holds with finite @xmath251 and @xmath252 . hence , ( [ eq : hd : prf : highsnruplink ] ) holds , with respect to any @xmath55 within @xmath86 to @xmath17 .",
    "therefore , the proposed scheme outperforms the conventional one for high snrs in half - duplex communications by combining ( [ eq : hd : prf : highsnrdownlink ] ) and ( [ eq : hd : prf : highsnruplink ] ) .    on the other hand , regarding low snrs ,",
    "it is obvious that @xmath253 therefore , the achievable rate of the proposed scheme is greater than those of the conventional one due to the multiplication factor @xmath242 .",
    "f.  rusek , d.  persson , b.  k. lau , e.  g. larsson , t.  l. marzetta , o.  edfors , and f.  tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee signal process . mag .",
    "_ , vol .  30 , no .  1 ,",
    "pp . 4060 , jan .",
    "2013 .                  l.  you , x.  gao , x",
    "xia , n.  ma , and y.  peng , `` pilot reuse for massive mimo transmission over spatially correlated rayleigh fading channels , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol . 1276 , no .  6 , pp . 115 , jun",
    "2015 .",
    "h.  q. ngo , e.  g. larsson , s.  member , and s.  member , `` large - scale multipair two - way relay networks with distributed af beamforming large - scale multipair two - way relay networks with distributed af beamforming , '' _ ieee commun .",
    "_ , vol .",
    "17 , no .  12 , pp .",
    "22882291 , dec .",
    "2013 .",
    "y.  dai and x.  dong , `` power allocation for multi - pair massive mimo two - way af relaying with robust linear processing , '' _ arxiv preprint arxiv:1508.06656 _ , pp .",
    "114 , aug .",
    "[ online ] .",
    "available : http://arxiv.org/abs/1508.06656    h.  q. ngo , h.  a. suraweera , m.  matthaiou , and e.  g. larsson , `` multipair full - duplex relaying with massive arrays and linear processing , '' _ ieee j. sel .",
    "areas commun .",
    "_ , vol .",
    "32 , no .",
    "9 , pp . 17211737 , sept .",
    "2014 .",
    "l.  j. rodriguez , n.  h. tran , and t.  le - ngoc , `` optimal power allocation and capacity of full - duplex af relaying under residual self - interference , '' _ ieee wireless commun .",
    "_ , vol .  3 , no .  2 ,",
    "pp . 233236 , apr .",
    "2014 .",
    "e.  bjrnson , l.  sanguinetti , j.  hoydis , and m.  debbah , `` optimal design of energy - efficient multi - user mimo systems : is massive mimo the answer ? '' _ ieee trans . on wireless commun .",
    "_ , vol .  14 , no .  6 , pp . 3059  3075 , jun",
    ". 2015 .",
    "e.  bjrnson , e.  g. larsson , and m.  debbah , `` massive mimo for maximal spectral efficiency : how many users and pilots should be allocated ? '' _ ieee trans .",
    "on wireless commun .",
    "_ , vol .  15 , no .  2 , pp .",
    "1293  1308 , feb ."
  ],
  "abstract_text": [
    "<S> we propose a pilot - data transmission overlay scheme for multipair massive multiple - input multiple - output ( mimo ) relaying systems employing either half- or full - duplex ( hd or fd ) communications at the relay station ( rs ) . in the proposed scheme , </S>",
    "<S> pilots are transmitted in partial overlap with data to decrease the channel estimation overhead . </S>",
    "<S> the rs can detect the source data with minimal destination pilot interference by exploiting the asymptotic orthogonality of massive mimo channels . </S>",
    "<S> then pilot - data interference can be effectively suppressed with assistance of the detected source data in the destination channel estimation . due to the transmission overlay , </S>",
    "<S> the effective data period is extended , hence improving system throughput . </S>",
    "<S> both theoretical and simulation results confirm that the proposed pilot - data overlay scheme outperforms the conventional separate pilot - data design in the limited coherence time interval scenario . </S>",
    "<S> moreover , asymptotic analyses at high and low snr regions demonstrate the superiority of the proposed scheme regardless of the coherence interval length . because of simultaneous transmission </S>",
    "<S> , the proper allocation of source data transmission and relay data forwarding power can further improve the system performance . </S>",
    "<S> hence a power allocation problem is formulated and a successive convex approximation approach is proposed to solve the non - convex optimization problem with the fd pilot - data transmission overlay .    </S>",
    "<S> massive mimo ; multipair relaying ; full - duplex ; pilot - data transmission overlay ; power allocation . </S>"
  ]
}