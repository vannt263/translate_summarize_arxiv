{
  "article_text": [
    "western musical scales are based on the _ equal temperament _ ( et ) ,",
    "a system of tuning in which adjacent notes differ by a constant frequency ratio of @xmath0  @xcite . tuning musical instruments in equal temperament by ear used to be a challenging task which was carried out by iterating cyclically over certain interval sequences .",
    "today this task is performed much more accurately with the help of electronic tuning devices which automatically recognize the tone , measure its frequency , and display the actual pitch deviation from the theoretical value . however ,",
    "if one uses such a device to tune a piano or a harpsichord exactly in equal temperament , the instrument as a whole will eventually sound as if it were out of tune , even though each string is tuned to the correct frequency .",
    "this surprising effect was first explained by o.  l.  railsback in 1938 , who showed that this perception is caused by inharmonic corrections in the overtone spectrum  @xcite .",
    "professional aural tuners compensate this inharmonicity by small deviations , a technique known as _",
    "stretching_. the stretch depends on the specific amount of inharmonicity and can be visualized in a tuning chart ( see fig .",
    "[ figrailsback ] ) .",
    ".,width=491 ]    since the inharmonicity changes from instrument to instrument , it is difficult to compute the appropriate stretch by means of electronic tuning methods .",
    "some appliances allow the user to preselect typical average stretches for certain classes and sizes of instruments .",
    "more advanced tuning devices measure the individual overtone spectra of all notes and compute the necessary stretch by correlating higher harmonics .",
    "although the latter method gives fairly good results and is increasingly used by professional piano tuners , many musicians are still convinced that electronic tuning can not compete with high - quality aural tuning by a skilled piano technician .",
    "this raises the question why aural tuning is superior to electronic methods .",
    "when measuring the frequencies of an aurally well - tuned piano one finds that the tuning curve is not smooth : rather it exhibits irregular fluctuations from note to note on top of the overall stretch ( see fig .",
    "[ figrailsback ] ) . at first glance",
    "one might expect that these fluctuations are randomly distributed and caused by the natural inaccuracy of human hearing .",
    "however , as we will argue in the present paper , these fluctuations are probably not totally random ; they might instead reflect to some extent the individual irregularities in the overtone spectra of the respective instrument and thus could play an essential role in high - quality tuning .",
    "apparently our ear can find a better compromise in the highly complex space of spectral lines than most electronic tuning devices can do .",
    "as a first step towards a better understanding of these fluctuations , we suggest that a musical instrument can be tuned by minimizing an appropriate entropy functional .",
    "this hypothesis anticipates that a complex sound is perceived as ` pleasant ' , ` harmonic ' or ` in tune ' if the corresponding neuronal activity is ordered in such a way that the shannon entropy of the excitation pattern is minimal .",
    "the hope is that such an entropy - based optimization allows one to find a better compromise between slightly detuned harmonics than a direct comparison of selected spectral lines .",
    "r70 mm        harmonic modes of a string  @xcite .",
    "sound waves produced by musical instruments involve many fourier components .",
    "the simplest example is the spectrum of a vibrating string  @xcite .",
    "depending on the excitation mechanism , one finds not only the fundamental mode with the frequency @xmath1 but also a large number of higher partials ( overtones ) with frequencies @xmath2 . for an ideal string",
    "the frequencies of the higher partials are just multiples of the fundamental frequency , i.e. @xmath3 such a linearly organized spectrum of overtones is called _ harmonic_.    since harmonic overtones are ubiquitous in nature , our sense of hearing prefers intervals with simple frequency ratios for which the spectra of overtones partially coincide .",
    "examples are the octave ( 2:1 ) , the perfect fifth ( 3:2 ) , and the perfect fourth ( 4:3 ) , which play an important role in any kind of music . on the other hand",
    ", music is usually based on scales of notes arranged in _ octave - repeating _ patterns .",
    "since the frequency doubles from octave to octave , it grows exponentially with the index of the notes .",
    "this exponentially organized structure of octave - repeating notes is in immediate conflict with the linear spectrum of the harmonics .",
    "a _ musical scale _ can be seen as the attempt to reconcile these conflicting schemes , defining the frequencies in such a way that the harmonics of a given note coincide as much as possible with other notes of the scale in higher octaves . as demonstrated in fig .",
    "[ figscale ] , this leads quite naturally to _ heptatonic scales _ with seven tones per octave , on which most musical cultures are based . in traditional western music the seven tones ( the white piano keys ) are supplemented by five halftones ( black keys ) , dividing an octave in twelve approximately equal intervals .    as the twelve intervals establish a compromise between the arithmetically ordered harmonics and the exponentially organized musical scale , their sizes",
    "are not uniquely given but may vary in some range .",
    "over the centuries this freedom has led to the development of various tuning schemes , known as _",
    "intonations _ or _",
    "temperaments _ , which approximate the harmonic series to a different extent .",
    "one extreme is the _ just intonation _ , which is entirely built on simple rational frequency ratios . as shown in fig .",
    "[ figscale]b , the just intonation shares many spectral lines with a suitable harmonic spectrum . however , this tuning scheme is not equidistant on a logarithmic representation , breaking translational invariance under key shifts ( transpositions ) .",
    "therefore , the just intonation is in tune only with respect to a specific musical key ( e.g. c major ) , while it is out of tune in all other musical keys .",
    "hz and the corresponding series of harmonics .",
    "( b ) just intonation in c - major with octave - repeating patterns of non - equidistant pitches .",
    "( c ) equally tempered intonation with constant pitch differences .",
    "the upper part of the figure shows a zoom of the octave c4-c5 .",
    "as can be seen , the heptatonic scale ( the white piano keys , thick lines ) of the just intonation ( b ) matches perfectly with the harmonics in ( a ) , while the half tones ( black keys , thin lines ) do not lock in .",
    "contrarily the equal temperament ( c ) deviates in all tones except a440 but it is equidistant and therefore invariant under shifts ( transpositions ) of the musical key .",
    ", width=566 ]    with the increasing complexity of western music and the development of advanced keyboard instruments such as harpsichords , organs and pianos , more flexible intonations were needed , where the musical key can be changed without renewed tuning . searching for a better compromise between purity ( rational frequency ratios ) and temperament independence ( transposition invariance ) various tuning schemes",
    "have been developed , including the famous meantone temperament in the renaissance and the well - tempered intonation of the baroque era . since the 19@xmath4 century western music is predominantly based on the aforementioned equal temperament , which is fully invariant under key shifts . in equal temperament ,",
    "frequencies of neighboring tones differ by the irrational factor @xmath0 so that they are equidistant in a logarithmic representation ( see fig .  [ figscale]c )",
    ". however , this invariance under key shifts comes at the price that all intervals ( except the octave ) are slightly out of tune , but apparently our civilization learned to tolerate these discrepancies .",
    "of an upright piano .",
    "the two parts of the data correspond to the two diagonally crossed bass and treble sections of the strings .",
    "right : power spectrum of the leftmost string .",
    "the red arrow marks the fundamental frequency of 27.5 hz .",
    "the blue arrows indicate particularly weak partials which are suppressed due to the position of the hammer.,width=566 ]    the harmonic series of overtones @xmath5 is valid only for ideal oscillators whose evolution is governed by a linear second - order partial differential equation . in realistic musical instruments",
    "there are higher - order corrections in the force law which lead to small deviations from the harmonic spectrum .",
    "the degree of inharmonicity is characteristic of each instrument and accounts for much of the color and texture of its sound .",
    "inharmonicity in string instruments is caused by the circumstance that a realistic string is an intermediate between an ideal string and a stiff bar .",
    "an ideal string vibrates according to the differential equation @xmath6 with a linear dispersion @xmath7 , while a stiff bar is known to evolve according to a fourth - order differential equation @xmath8 with a quadratic dispersion @xmath9 .",
    "therefore , the stiffness of realistic strings causes lowest - order corrections of the form @xmath10 so that the spectrum of a string is given by @xmath11 where @xmath1 denotes the fundamental frequency and @xmath12 is the frequency of the @xmath13 partial .",
    "the dimensionless number @xmath14 is the so - called _ inharmonicity coefficient _ which depends on the length , diameter , tension and material properties of the string . in a piano",
    "the value of @xmath14 varies typically between 0.0002 for bass strings up to 0.4 for treble strings ( see left panel in fig .",
    "[ figpiano ] ) .",
    "strong inharmonicity can be recognized as an unpleasant dulcimer - like sound .",
    "an important part in the art of piano construction is to keep the inharmonicity as small as possible .",
    "as mentioned before , intervals with simple rational frequency ratios are perceived as pleasant . in this context",
    "it is important to note that the human ear , when hearing two different tones simultaneously , can not evaluate the frequency ratio of the fundamental modes directly : rather it recognizes coincidences in the corresponding overtone spectra .",
    "for example , if we hear an octave , say a2-a3 , our ear compares the partials 2,4,6 , ... of the lower tone with the partials 1,2,3 ... of the upper one , perceiving the octave as being ` in tune ' when the two harmonic series lock in ( see fig .",
    "[ octave ] ) .    in the presence of inharmonic corrections , however , it is no longer possible to match the two series exactly . in this case",
    "our ears search for the best possible compromise , minimizing the frequency differences between almost coinciding low - lying partials .",
    "these tiny differences are heard as so - called _ beats _ , a superposition of enveloping modulations of a few hertz which an aural tuner tries to make as slow as possible . as demonstrated in fig .",
    "[ figstretch ] , in an octave such a compromise can be achieved by slightly increasing the pitch of the upper tone .",
    "this means that we perceive an interval as correctly tuned if it is slightly out of tune in the mathematical sense .",
    "this correction , called _ stretch _ , plays a major role in the practice of tuning , even when the inharmonicity of the instrument is small .",
    "today high - priced electronic tuning systems are available which can compute the appropriate stretch for individual instruments . to this end",
    "some of the tones are recorded and the inharmonicity coefficients of the strings are estimated by identifying the partials in the corresponding spectra . the stretch is then computed e.g. by selecting sequences of octaves and stretching them in such a way that the fourth partial of the lower tone coincides with the second partial of the upper ( 4:2-tuning ) . more specifically , enumerating the piano keys by @xmath15 and denoting by @xmath16 the @xmath13 partial of the @xmath17 string , this 4:2 method provides @xmath18 equations for the octave stretches of the form @xmath19 where @xmath20 is the ratio of the @xmath13 partial to the fundamental frequency of the string . by taking the logarithm this turns into a system of @xmath18 linear equations for the @xmath21 unknown fundamental frequencies @xmath22 .",
    "the remaining 12 unknowns are determined by the reference pitch a440 and the choice of the temperament .",
    "equal temperament can be approximated by introducing a quadratic penalty function for the change of adjacent interval ratios . by solving these equations",
    "one can translate the measured partials directly into a tuning curve . if the inharmonicity coefficient is a piecewise smooth function ( like the one shown in fig .",
    "[ figpiano ] ) , the tuning curve will be piecewise smooth as well .",
    "likewise one can use a 6:3 tuning scheme , which produces an even larger stretch .",
    "the overall magnitude of the stretch is therefore not strictly defined but rather a matter of taste .",
    "some devices even interpolate between 4:2 and 6:3 stretching in order to get a more acceptable compromise .    computing the stretch by direct comparison of partials as described above yields piecewise smooth tuning curves .",
    "however , as mentioned in the introduction , aural tuners produce tuning curves with pronounced fluctuations on top of the overall stretch , especially in the bass and in the treble .",
    "one of the main messages of this work is the conjecture that these fluctuations are not random but to some extent essential for a good tuning result .",
    "the fluctuations may have different reasons . on the one hand ,",
    "each partial couples differently to the resonator of the instrument ( the soundboard of the piano ) , leading to additional frequency shifts so that the inharmonic spectrum deviates slightly from the predicted form in eq .",
    "( [ inharmonicity ] ) .",
    "another reason is the highly irregular intensity of the partials . as shown in the right panel of fig .",
    "[ figpiano ] , the spectrum of a piano string may consist of dozens of partials , but even adjacent partials may differ in their power by more than a magnitude .",
    "even worse , some of the partials ( indicated by blue arrows in the figure ) are strongly suppressed if the hammer hits the string at a node of the corresponding vibrational mode .",
    "this suggest that in realistic situations the perception of being in tune does not only depend on the frequency of the partials but also on their amplitude .",
    "as tuning can be understood as the search for a compromise in matching higher partials , it will significantly depend on the acoustic and psychoacoustic properties of the inner ear .",
    "psychoacoustics is a research field on its own ( see e.g. @xcite ) and plays an important role e.g. in lossy data compression methods such as mp3 . here we only sketch a few basic elements which are essential for the method presented below .",
    "let us first consider the frequency range of the ear .",
    "starting point is a sound wave , which can be described as a time - dependent pressure variation @xmath23 .",
    "its complex - valued fourier transform is given by @xmath24 where @xmath25 .",
    "the corresponding power spectrum @xmath26 describes the energy density of the spectral line at frequency @xmath27 . as a technically useful measure one defines the logarithmic _ sound pressure level _ ( spl ) @xmath28 measured in decibels ( db ) , where @xmath29 refers to the hearing threshold .",
    "depending on the frequency the spl will be correlated with a certain mechanical response in the inner ear .",
    "since the physical transmission mechanism is highly complex , one usually approximates this relationship by certain weighting functions .",
    "below 55 db the most commonly used one is the so - called _ a - weighting _ according to the international standard iec 61672:2003 with the filter function @xmath30 which defines the a - weighted sound pressure level ( spla ) @xmath31 in units of a - weighted decibels ( dba ) .",
    "the spla can be considered as a rough measure of frequency - dependent energy deposition in the cochlea .",
    "the receptor cells in the inner ear convert the excitation pattern into a certain neuronal response which causes the auditory perception in the brain .",
    "the neuronal processing is even more complex and not yet entirely understood .",
    "for this reason one uses a psychoacoustic measure for the perceived intensity , the so - called loudness @xmath32 , which is an empirical psychological quantity averaged over many test persons .",
    "according to the literature this relationship is well approximated by a piecewise exponential function and a power law : @xmath33 not only the sensitivity of the ear is frequency - dependent but also its ability to discriminate between different frequencies . in the literature",
    "different measures for the frequency resolution are reported , of which the so - called _ just noticeable difference ( jnd ) _ plays the role of a lower bound  @xcite .",
    "jnd _ is usually approximated by @xmath34",
    "we now suggest a simple entropy - based tuning scheme for musical instruments .",
    "it is motivated by the observation that tuning can be understood as the search for the best possible compromise in matching higher partials , and the main idea is that this compromise is characterized by a local minimum of the entropy of the intensity spectrum .",
    "this is highly plausible since the entropy of two spectral lines decreases as they begin to overlap ( see fig .",
    "[ figentropy ] ) .     gives a constant value @xmath35 .",
    "when the two partials begin to overlap ( audible as _ beats _ ) , the entropy decreases and reaches a minimum ( @xmath36 in this example ) if they coincide.,width=585 ]    r90 mm        to test this idea we individually recorded all keys of an aurally tuned piano , computed their power spectra and reorganized them in logarithmic bins in order to account for the finite frequency resolution of the inner ear .",
    "furthermore , we removed the pitch differences , resetting the tune of all tones to equal temperament .",
    "then we applied the following simple zero - temperature monte - carlo scheme of statistical physics ( see fig .",
    "[ mc ] , technical details are given in the appendix ) :    * add the a - weighted power spectra of all 88 tones and compute the entropy .",
    "* randomly change one the of the pitches and compute the entropy again .",
    "* if the entropy is lower accept the pitch change , otherwise restore the previous value .",
    "this simple procedure is iterated until no further improvement is obtained , meaning that the algorithm has found a local minimum of the entropy .",
    "note that by adding up all tones , the method is inherently sensitive to all intervals , not only to octaves .",
    "fig .  [ figresults ] shows the resulting tuning curve of a typical run compared with the actual curve produced by an aural tuner for an upright piano . as can be seen ,",
    "not only the overall stretch is predicted correctly but even the fluctuations of the two curves are highly correlated , especially in the bass and the treble .",
    "apparently the entropy - based tuning method is capable of generating the same individual deviations from the average stretch as an aural tuner .",
    "this is surprising and not yet understood , but it indicates that these fluctuations are reproducible and may play an essential role in the practice of tuning .",
    "the implementation of the method is very easy .",
    "the tones are recorded , fourier - transformed , mapped pointwise by the psychoacoustic filtering functions as described above , binned logarithmically , added up , and finally plugged into the entropy functional .",
    "an explicit identification of higher partials and the measurement of the inharmonicity is not needed .",
    "the method is expected to take automatically any anomalous spectral properties of the instrument into account .    however , the method suggested here is still in an immature state .",
    "it could be modified in various respects and a systematic study is still outstanding . moreover ,",
    "the method was tested so far with only one instrument .",
    "the main open questions are the following :    * apparently there are many local minima , so that the algorithm outlined above produces similar but not reproducible results .",
    "* the monte - carlo results presented above were based on the a - weighted spectra ( spla ) in eq .",
    "( [ form3 ] ) . if one uses instead the loudness defined in eq .",
    "( [ form4 ] ) , one obtains unreasonably stretched tuning curves in the bass . *",
    "the spectra were logarithmically binned in units of one cent .",
    "this models a frequency resolution of one cent , which is smaller than the just notable difference ( _ jnd _ ) .",
    "however , convolving the spectra with a frequency - dependent gaussian according to the expected _ jnd _ in eq .",
    "( [ jnd ] ) does not improve the results . *",
    "more advanced monte carlo techniques such as simulated annealing have not yet been tested . * instead of adding up the spectra of _ all _ piano keys",
    ", we tried to work with subsets of octaves , fifths and fourths , imitating the practice of aural tuners .",
    "this destabilizes the method , probably driving the pitches out of equal - tempered into just intonation .",
    "apparently the summation over all keys allows the system as a whole to stay in equal temperament .    regarding possible technological realizations , it could be interesting to develop electronic tuning devices using a hybrid method , which first compute an approximate tuning curve by matching higher partials , and then optimize the fluctuations of the pitches by searching for a suitable local minimum in the vicinity .",
    "+ * acknowledgments * + the author thanks for the warm hospitality at the universidade federal do rio grande do sul ( ufrgs ) in porto alegre , brazil , where parts of this work have been done .",
    "this work was supported financially by the german academic exchange service ( daad ) under the joint brazil - germany cooperation program probral .",
    "[ [ data - recording - and - preprocessing ] ] data recording and preprocessing + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    1 .",
    "record the piano keys @xmath37 in wav format .",
    "extract the binary pcm amplitudes and convert them to a series of floating point numbers @xmath38 with an index @xmath39 , where @xmath40 hz is the sample rate and @xmath41 is the recording time .",
    "2 .   apply a fast fourier transform ( e.g. package fftw3 ) to obtain the spectra @xmath42 indexed by @xmath43 , where @xmath44 ( the other half of the data is complex conjugate ) .",
    "the @xmath45 component corresponds to the frequency @xmath46 .",
    "3 .   for each @xmath47 coarse - grain",
    "the power spectrum @xmath48 by logarithmic binning . to this end",
    "define an array @xmath49 corresponding to the frequencies @xmath50 hz with @xmath51 running from zero ( 10 hz ) to 12000 ( 10 khz ) .",
    "let @xmath52}\\ ,   |\\tilde y^{(k)}_q|^2 \\,,\\ ] ] where @xmath53 $ ] denotes rounding to an integer .",
    "note that in this representation adjacent bins differ by a frequency ratio of one cent .",
    "4 .   map the intensities @xmath54 to the corresponding a - weighted sound pressure levels ( spla ) @xmath55 .",
    "5 .   after this preprocessing the pitch of a tone can be increased or lowered by @xmath56 cents through a shift of the array index @xmath57 .",
    "this allows us to tune the instrument virtually on the computer .",
    "remove the recorded pitch deviations by tuning the first partial to equal temperament , i.e. @xmath58 hz , where @xmath59 is the index of a440 .",
    "this means that the recorded stretch corrections are initially eliminated .",
    "[ [ monte - carlo - dynamics ] ] monte - carlo dynamics + + + + + + + + + + + + + + + + + + + +    1 .",
    "change one of the pitch differences randomly by @xmath60 cent .",
    "2 .   compute the sum @xmath61 of the spla over all keys .",
    "3 .   normalize @xmath62 such that @xmath63 .",
    "4 .   compute the shannon entropy @xmath64 .",
    "5 .   if the entropy decreases , keep the pitch change , otherwise restore the old pitch .",
    "this procedure is repeated until no further changes take place .",
    "99 j. g. roederer , _ introduction to the physics and psychophysics of music _ , springer , new york ( 1973 ) .",
    "o. l. railsback , _ scale temperament as applied to piano tuning_. journal of the acoustical society of america 9 ( 3 ) : 274 ( 1938 ) .",
    "figure taken from : http://en.wikipedia.org/wiki/file:railsback2.png ( march 2012 ) . figure taken from : http://en.wikipedia.org/wiki/file:harmonic-partials-on-strings ( march 2012 ) .",
    "n. h. fletcher and t. d. rossing , _ the physics of musical instruments _ , springer , new york ( 1991 ) .",
    "h. fastl and e. zwicker , _ psychoacoustics : facts and models _ , springer , new york ( 2007 ) . c. j. plack , a. j. oxenham , and r. f. richard , eds . _ pitch : neural coding and perception_. springer , new york ( 2005 ) .",
    "b. c. moore and b. r. glasberg , _",
    "thresholds for hearing mistuned partials as separate tones in harmonic complexes_. j. acoust .",
    ", 80 , 479483 ( 1986 ) ."
  ],
  "abstract_text": [
    "<S> the human sense of hearing perceives a combination of sounds ` in tune ' if the corresponding harmonic spectra are correlated , meaning that the neuronal excitation pattern in the inner ear exhibits some kind of order . </S>",
    "<S> based on this observation it is suggested that musical instruments such as pianos can be tuned by minimizing the shannon entropy of suitably preprocessed fourier spectra . </S>",
    "<S> this method reproduces not only the correct stretch curve but also similar pitch fluctuations as in the case of high - quality aural tuning . </S>"
  ]
}