{
  "article_text": [
    "biological systems may sometimes be in steady state , as when synthesis or growth is balanced by degradation or loss .",
    "typically , this holds only for a limited time period .",
    "it may also sometimes be reasonable to assume an explicit separation of time scales , in which a sub - system is operating fast compared to the rest of the system .",
    "the fast components may then be treated as if they are at steady state relative to the slow components . in either context , steady - state analysis is required .",
    "the framework introduced here provides a systematic way to calculate steady states , with broad applicability to biochemical systems .",
    "we start from a graph , @xmath0 , consisting of vertices , @xmath1 , with labelled , directed edges @xmath2 and no self loops , @xmath3 ( figure  [ f-1]a ) .",
    "the vertices represent components of a system , on which a dynamics is defined by treating each edge as if it were a first - order chemical reaction under mass - action kinetics , with the label as rate constant .",
    "this gives a system of linear , ordinary differential equations ( odes ) , @xmath4 where @xmath5 is a column vector of component concentrations and @xmath6 is the laplacian matrix of @xmath0 .",
    "such matrices were introduced by kirchhoff @xcite and resemble discretisations of the laplacian operator ( see the appendix ) .",
    "since material is neither created nor lost , the total concentration , @xmath7 , remains constant at all times , so that @xmath8 , where @xmath9 is the all - ones column vector and @xmath10 denotes transpose .",
    "nonlinearity can be encoded either in the vertices or , more commonly , in the labels .",
    "labels are real numbers , @xmath11 , which may be algebraic expressions over a set of symbols , @xmath12 .",
    "symbols may be rate constants , @xmath13 , or concentrations , @xmath14 $ ] , of chemical species @xmath15 .",
    "for instance , @xmath15 may be a slow component in a time - scale separation .",
    "all calculations are in terms of symbols , whose numerical values do not have to be known in advance , thereby avoiding problems of parameter estimation .",
    "labels must have dimensions of @xmath16 and be positive , @xmath17 .",
    "a crucial restriction is that if a concentration symbol , @xmath14 $ ] , appears in a label in @xmath0 , then @xmath15 must be an external species and not correspond to a vertex in @xmath0 .",
    "this `` uncoupling condition '' is essential to preserve linearity and is the key requirement for applications of the framework .",
    "the laplacian , @xmath6 , is a @xmath18 matrix over @xmath19 .",
    "the interest lies in the steady states of ( [ e - lap ] ) , for which @xmath20 , or , equivalently , @xmath5 is in the kernel of the laplacian , @xmath21 .",
    "the kernel can be determined in two steps , first for a strongly connected graph and then for any graph .",
    "a strongly connected graph is one in which any two distinct vertices can be joined by a series of edges in the same direction .",
    "while this depends only on the edge structure and not on the labels , the sign of a label determines the direction of flux . for strongly - connected graphs with positive labels ,",
    "the dimension of @xmath22 is one , @xcite . in this case",
    ", tutte s matrix - tree theorem ( mtt ) describes a basis element , @xmath23 , @xcite . to calculate @xmath24 ,",
    "take the product of all the labels on a spanning tree of @xmath0 rooted at vertex @xmath25 and add the products over all such trees ( figure  [ f-1]b , box ) .",
    "a spanning tree is a fundamental concept in graph theory ; it is a subgraph of @xmath0 that contains each vertex of @xmath0 ( spanning ) which has no cycles when edge directions are ignored ( tree ) ; it is rooted at @xmath25 if @xmath25 is the only vertex with no outgoing edges in the tree .",
    "spanning - tree calculations are shown in figure  [ f-1]b and figures  1 and 2 of the appendix .    the kernel could have been calculated using determinants .",
    "the significance of the mtt is that it expresses @xmath24 as a polynomial in the labels with positive coefficients ( figure  [ f-1]b ) .",
    "this resolves the alternating signs that arise with determinants and ensures that steady - state concentrations remain positive , so long as the labels are positive .",
    "being able to algorithmically calculate steady states in terms of labels is the essence of the framework .",
    "the mtt has been frequently rediscovered in biology in various guises , @xcite .",
    "if @xmath5 is any steady - state , then , since @xmath26 , we know that @xmath27 , where @xmath28 .",
    "the undetermined @xmath29 reflects the amount of matter in the system .",
    "it can be removed by normalising in different ways : @xmath30 in 1 , one of the vertices , by convention vertex @xmath9 , is chosen as a reference . in 2 , @xmath31 plays a similar role , with @xmath32 .    equation ( [ e - elim ] ) shows that the @xmath33 components in the system can be eliminated in favour of rational expressions , @xmath34 or @xmath35 , the labels of which may involve the concentrations of other components .",
    "this dramatic simplification is a consequence of strong connectivity and is central to the time - scale separation applications discussed below .",
    "if @xmath0 is an arbitrary graph , it can be decomposed into strongly connected components ( sccs ) , which inherit from @xmath0 a directed graph structure , @xmath36 , that has no directed cycles ( figure  [ f-1]c ) .",
    "since there is no net flux of material into the initial sccs in @xmath36 , it can be shown that only the terminal sccs contribute to any steady state ( appendix ) .",
    "for each terminal scc , @xmath37 , let @xmath38 be the vector which , for vertices in that scc , agrees with the values coming from the mtt applied to that scc in isolation , while for any other vertex , @xmath39 , @xmath40 .",
    "these vectors form a basis for the kernel of the laplacian : @xmath41 where @xmath42 is the number of terminal sccs . by construction",
    ", if @xmath25 is any vertex , @xmath43 a description of @xmath22 appears in the appendix of @xcite .",
    "the construction given here goes further in using the mtt to give explicit expressions for the basis elements in terms of the labels .",
    "four applications are discussed next .",
    "the first stands apart from the rest in not being a time - scale separation .",
    "it illustrates the wide scope of the framework .",
    "the remaining applications show how the mtt systematises the eliminations arising from time - scale separation . in each case",
    "the framework integrates classical and modern analyses of biochemical systems .",
    "the intention is not to reveal new results in each area but to show that , rather than being different calculations , they are all the same calculation , made manifest in the labelled , directed graphs that appear in figures  [ f-2 ] to [ f-5 ] .",
    "following these applications , an extension to the framework is introduced that allows for synthesis and degradation of components ( figure  [ f-6 ] ) .",
    "some specialised results for thermodynamic equilibrium are outlined in the appendix .",
    "for a reversible chemical reaction between species @xmath44 and species @xmath45 , @xmath46 mass - action kinetics implies a haldane relationship @xcite at equilibrium , @xmath47^{\\alpha_1 } \\cdots [ s_k]^{\\alpha_k}}{[p_1]^{\\beta_1 } \\cdots [ p_l]^{\\beta_l } } = \\frac{k^+}{k^-}\\ , .",
    "\\label{e - hald}\\ ] ] formula ( [ e - hald ] ) may also be deduced from thermodynamics and , here , kinetics is consistent with thermodynamics . however",
    ", a network of reactions may have kinetic equilibria that do not satisfy thermodynamic constraints @xcite .",
    "the condition of `` detailed balance '' was introduced to avoid such paradoxes @xcite .",
    "this plays an important role at equilibrium , as explained in the next section .    in a seminal paper @xcite ,",
    "horn and jackson , sought to extend thermodynamic properties like ( [ e - hald ] ) to steady states far from equilibrium . under mass - action kinetics ,",
    "any reaction network gives rise to a system of nonlinear odes , @xmath48 . to disentangle the nonlinearity ,",
    "the expressions that appear on either side of a reaction were treated as new entities called `` complexes '' , so that a chemical reaction network , @xmath49 , with @xmath50 species , gave rise to a labelled , directed graph , @xmath51 , on @xmath33 complexes ( figure  [ f-2 ] ) .",
    "the nonlinear function @xmath52 on species is replaced by the linear laplacian , @xmath53 , on complexes , with the labels being just the rate constants of the corresponding reactions . here",
    ", the nonlinearity is entirely encoded in the vertices .",
    "( horn and jackson defined the function on complexes without being aware of its interpretation as a graph laplacian . ) the two functions , one acting on species and the other on complexes , are linked by a linear function @xmath54 and a nonlinear function @xmath55 ( figure  [ f-2 ] , caption ) .",
    "these encode the stoichiometry of the species in the complexes in such a way that that the diagram in figure  [ f-2 ] commutes , @xmath56 .",
    "only @xmath57 is nonlinear , revealing a substantial linearity within the dynamics , arising from the graph - theoretic structure .",
    "this decomposition is the starting point of crnt , @xcite .",
    "formula ( [ e - klap ] ) applies to @xmath53 and plays a fundamental role . if @xmath58 is positive , @xmath59 , then , by definition ,",
    "so is @xmath60 .",
    "hence , a positive steady state , with @xmath61 , can arise in only one of two ways : either @xmath62 or , if not , then @xmath63 . in the first case",
    ", @xmath58 is said to be `` complex balanced '' .",
    "it then follows from ( [ e - klap ] ) that @xmath64 where @xmath65 .",
    "let @xmath66 and @xmath67 be two complexes in the same terminal scc of @xmath51 , say @xmath68 .",
    "suppose that the multiplicity of species @xmath25 in @xmath66 is @xmath69 and in @xmath67 is @xmath70 . using ( [ e - rho ] ) and the definition of @xmath57 ( figure  [ f-2 ] , caption ) , @xmath71 the term on the right depends only on the rate constants and this `` quasi - thermostatic '' property @xcite generalises the haldane relationship in ( [ e - hald ] ) . with the mtt",
    ", the generalised `` equilibrium constants '' can now be explictly calculated in terms of the rate constants .",
    "horn and jackson showed further that complex balancing satisifies other properties expected of thermodynamic equilibria , justifying it as a non - equilibrium generalisation of detailed balancing @xcite .",
    "formula ( [ e - klap ] ) has also provided modern insights .",
    "for instance , ( [ e - ghal ] ) shows that complex - balanced steady states are generated by polynomials with only two terms ( binomials ) , @xmath72 and therefore form a toric algebraic variety @xcite , similar to those arising from log - linear models in algebraic statistics @xcite .",
    "this , and other recent results , @xcite , have introduced methods of algebraic geometry to the analysis of molecular reaction networks .",
    "formula ( [ e - klap ] ) remains useful even without a complex - balanced steady state . in the simplest case",
    ", @xmath73 contains only one additional basis element compared to @xmath74 . if @xmath58 is a positive steady state , then @xmath75 where @xmath76 is the additional basis element and @xmath28 . because @xmath76 may be non - zero at any complex , the haldane - style formulas in ( [ e - ghal ] )",
    "can no longer be deduced , except in the case where @xmath66 and @xmath67 are not in any terminal scc .",
    "if @xmath66 and @xmath67 also differ only in a single species @xmath13 , so that @xmath77 for @xmath78 , then @xmath79 depends only on the rate constants @xmath80 and exhibits `` absolute concentration robustness '' .",
    "this is the shinar - feinberg theorem @xcite , which has particular applications to bifunctional enzymes , where the robustness is suppored by experimental evidence @xcite .",
    "reversible binding of ligands to a substrate is a feature of many cellular processes , such as gene regulation , @xcite , and protein allostery , @xcite .",
    "the linear framework may be readily applied by assuming that the time - scale of binding is well - separated between faster upstream interactions , such as ligand dimerisation , and slower downstream processes that react to the binding , such as gene expression ( figure  [ f-3 ] ) .",
    "consider a substrate that may exist in multiple states .",
    "these may , for instance , be states of dna looping or nucleosome organisation at a promoter or conformational states in an allosteric protein .",
    "ligands may bind reversibly to the substrate with potentially overlapping site preferences , cooperativity and dependence on substrate state .",
    "a labelled , directed graph can be constructed as follows ( figure  [ f-3 ] ) .",
    "the vertices correspond to microstates , consisting of the patterns of ligand binding in each substrate state .",
    "the edges correspond to transitions between substrate states , with ligand binding unaltered , or to binding or unbinding of the ligands , with substrate state unaltered . of these edges ,",
    "ligand binding has a label of the form @xmath81 $ ] , where @xmath13 is a rate constant and @xmath82 $ ] is a concentration , taken either at steady state or as slowly varying when @xmath83 is a slow variable ; all other edges have only a rate constant as label . provided",
    "the substrate is not a ligand for itself , so that the uncoupling condition is satisfied , and the graph is strongly connected , as is the case in most applications , the mtt allows the microstates to be eliminated in favour of the ligands .",
    "most quantities of biological interest can be calculated in terms of the resulting expressions ( figure  [ f-3 ] and the appendix ) .",
    "an important special case is when the system can reach thermodynamic equilibrium ( appendix ) . in this case",
    ", detailed balance ( db ) provides a simpler alternative to the mtt . according to db , which follows from the fundamental reversibility of microscopic dynamics at equilibrium @xcite , each edge is reversible and any pair of reversible edges , @xmath2 and @xmath84 , is independently at kinetic equilibrium .",
    "hence , given any steady state @xmath5 , @xmath85 , irrespective of any other edges that impinge on @xmath25 or @xmath86 .",
    "since each edge is reversible , the graph is strongly connected .",
    "starting from a reference microstate , @xmath9 , and taking a path of reversible edges to @xmath86 , we find that @xmath87 . just as in ( [ e - elim ] )",
    ", each @xmath88 can be eliminated in favour of rational expressions in the labels . at equilibrium ,",
    "db cuts down the rooted trees of the mtt to a single path from @xmath9",
    ".    there may be many such paths .",
    "however , the rate constants are not free to vary arbitrarily .",
    "db requires that they yield the same @xmath89 no matter what path is taken from @xmath9 to @xmath86 .",
    "these constraints may be summarised in the `` cycle condition '' : for any cycle of reversible edges , the product of the rate constants on clockwise edges equals the product on counterclockwise edges ( figure  [ f-3]a ) .",
    "this condition is necessary and sufficient for @xmath89 to be independent of the path taken and for every equilibrium state to satisfy db ( appendix ) .",
    "equilibrium ligand binding has usually been analysed by statistical mechanical methods , @xcite , as in protein allostery , @xcite , and gene regulation , @xcite .",
    "the linear framework gives identical results from a more kinetic perspective .",
    "its main advantge is that it also applies away from equilibrium .",
    "for instance , in the yeast phosphate control system , nucleosome organisation at the _ pho5 _ promoter influences its gene regulation function ( grf ) in response to the transcription factor pho4 , @xcite .",
    "nucleation and disassembly of nucleosomes is a dissipative process .",
    "however , the grf may still be calculated from the appropriate graph ",
    "figure  4b in @xcite  using the mtt .",
    "the linear framework is well suited to the modern programme of unravelling complex grfs , @xcite",
    "the fundamental basis of enzymology is that enzymes act through intermediate enzyme - substrate complexes , @xcite , ( figure  [ f-4 ] ) . under _ in - vitro _",
    "conditions , in which substrate is in excess , a time - scale separation may be assumed , with the intermediate complexes quickly reaching steady state , while conversion of substrate to product takes place more slowly .",
    "this is the quasi - steady state approximation , a version of which goes back to michaelis and menten , @xcite .",
    "a labelled , directed graph can be constructed in which the vertices correspond to the intermediates and the free enzyme , with edges derived from the reaction mechanism .",
    "the labels can be chosen so that the differential equations of the linear laplacian dynamics coincide with the full nonlinear odes . since free substrate and free product are distinct from the intermediate complexes and the enzyme , the uncoupling condition is readily satisfied .",
    "because intermediates eventually break up to release enzyme , the graphs are naturally strongly connected .",
    "the mtt and formula ( [ e - elim ] ) can then be used to eliminate the intermediates and the free enzyme in favour of substrates and products , from which the enzymatic rate function can be calculated ( figure  [ f-4 ] and appendix ) .    in the biochemical literature ,",
    "such calculations are done by the king - altman procedure , @xcite , which is a restatement of the mtt .",
    "king - altman has been widely used to calculate rate functions for complex enzymatic mechanisms with multiple ligands , affectors and intermediates , @xcite .",
    "the linear framework both encompasses this and shows how it can be integrated into the analysis of multi - enzyme systems , as described next .",
    "many proteins are covalently modified by the attachment of small chemical or peptide moieties , such as phosphate or ubiquitin , to specific residues , @xcite .",
    "ptm may involve multiple types of modifiers on multiple sites .",
    "different global patterns of modification , or `` modforms '' , may have different downstream effects , while the distribution of modforms is dynamically regulated by forward modifying and reverse demodifying enzymes acting in opposition , @xcite , ( figure  [ f-5 ] ) .",
    "ptm is believed to implement adaptive cellular information processing on physiological time scales , as , for instance , in `` ptm codes '' , @xcite .",
    "the linear framework enables quantitative analysis despite the resulting dynamical and combinatorial complexity @xcite .",
    "consider a single substrate , @xmath90 , that supports multiple types of modification at multiple sites by multiple forward and reverse enzymes .",
    "combinatorial explosion may lead to enormous numbers of modforms , depending on the numbers of sites and types of modification .",
    "a directed graph can be formed in which the vertices are the modforms and there is an edge between two modforms if there is some enzyme ( there may be several ) that catalyses the corresponding change in modification state .",
    "it is typically the case that any modification can be eventually undone by some other enzyme , so this modform graph is naturally strongly connected .",
    "the labels emerge from a separation of time scales .",
    "the donor molecules , such as atp in the case of phosphorylation , and their breakdown products , such as adp and phosphate , are assumed to be kept at constant concentration over the time scale of the modification dynamics by cellular processes that are not explicitly modelled .",
    "the modifier species can then be ignored as dynamical variables and enzyme reaction schemes can be simplified to involve only formation and breakdown of intermediate complexes and conversion between intermediate complexes ( figure  [ f-5 ] ) .",
    "realistic enzyme mechanisms may be assumed that vary for different substrate modforms .",
    "the mechanisms can be analysed using the linear framework , as explained in the previous section , yielding expressions from which the labels for the modform graph can be assembled ( figure  [ f-5 ] , caption ) .",
    "the uncoupling condition becomes restrictive here , since it requires that no substrate is also a modifying or demodifying enzyme .",
    "the differential equations arising from the laplacian dynamics then recapitulate the full nonlinear odes .",
    "because the modform graph is strongly connected , the mtt can be applied to eliminate the modforms in favour of the enzymes .",
    "this is hierarchical elimination : the intermediates are first eliminated in favour of the modforms and the enzymes ; the modforms are then eliminated in favour of the enzymes .",
    "we deduce that , despite the overwhelming combinatorial complexity arising from multisite modifications , the number of algebraically independent quantities at steady state is just the number of enzymes .",
    "this is usually very much smaller than the number of modforms .",
    "all other steady state concentrations are rational expressions in the free enzyme concentrations , with the expressions coming from ( [ e - elim ] ) . as for the enzymes ,",
    "the total amount of each enzyme is conserved , which gives sufficiently many algebraic equations for the free enzyme values to be determined .",
    "we see that the steady states of a ptm system can be calculated algebraically , without the need for numerical simulation , and without prior knowledge of any parameter values .",
    "this may be done irrespective of the number of modifications , the number of modification sites and the complex details of the enzyme mechanisms .",
    "this capability has yielded several insights , @xcite .",
    "for instance , it has identified the first biochemical mechanism capable of implementing a `` ptm code '' and shown that its information capacity is potentially unlimited , @xcite .",
    "the linear framework also provides a foundation for new types of analysis .",
    "an aspect of the applications above is that synthesis and degradation were ignored .",
    "this is tantamount to another assumption of time - scale separation , since cellular components are always being turned over .",
    "we now analyse what happens when this assumption is dropped .",
    "consider , as before , a labelled , directed graph , @xmath0 , on vertices @xmath1 .",
    "allow each vertex , @xmath25 , to have a partial labelled edge leading in , @xmath91 , and out , @xmath92 , corresponding to zero - order synthesis or first - order degradation of @xmath25 , respectively ( figure  [ f-6]a ) . by allowing @xmath93 or @xmath94",
    ", each vertex may have any combination of synthesis and degradation , including neither or both .",
    "the degradation label @xmath95 has the usual units of ( time)@xmath96 but the synthesis label @xmath97 must have units of ( concentration)(time)@xmath96 . call this `` partial graph '' @xmath98 . as before , there is a linear dynamics on @xmath98 , which may be described by the system of differential equations @xmath99 here , @xmath100 is a diagonal matrix with @xmath101 and @xmath102 is a column vector with @xmath103 .",
    "note that , unlike ( [ e - lap ] ) , the equations in ( [ e - nlap ] ) are non - homogeneous : if @xmath5 is a steady state of ( [ e - nlap ] ) , it does not follow that @xmath104 is also a steady state .",
    "because @xmath105 , if @xmath5 is a steady state of ( [ e - nlap ] ) , then @xmath106 which reflects the fact that synthesis and degradation must be in overall balance",
    ".    when there is neither synthesis nor degradation , a general graph may have several degrees of freedom at steady state , reflected in the size of the basis in ( [ e - klap ] ) .",
    "these free quantities are ultimately determined by the initial conditions . with synthesis and degradation ,",
    "some of these degree of freedom may be lost , as the total amount of matter is no longer conserved .",
    "this is reflected in the loss of homogeneity in ( [ e - nlap ] ) .",
    "the system may not reach a steady state unless synthesis and degradation can find a balance .",
    "construct a new labelled , directed graph @xmath107 by adding a vertex @xmath108 to @xmath0 ( figure  [ f-6]b ) . for each partial edge @xmath91 with @xmath109 or @xmath92 with @xmath110 ,",
    "introduce the edges @xmath111 or @xmath112 in @xmath107 , respectively .",
    "unlike @xmath98 , @xmath107 is a directed graph with positive labels , whose laplacian dynamics are governed by ( [ e - lap ] ) .",
    "it is easy to see that @xmath113 is a steady state of @xmath98 if , and only , @xmath114 is a steady state of @xmath107 .",
    "the condition for vertex @xmath108 to be at steady state in @xmath107 corresponds exactly to equation ( [ e - sd ] ) for synthesis and degradation to be in balance in @xmath98 .",
    "this enables a complete description of the steady states of @xmath98 but we focus here on the case that is most relevant to the applications .",
    "if @xmath107 is strongly connected , so that the mtt gives @xmath115 as a basis element for the kernel of @xmath116 , then @xmath98 has a unique steady state @xmath5 for which @xmath117 the single degree of freedom in @xmath107 has been used in ( [ e - star ] ) to ensure that @xmath118 .",
    "notice that @xmath107 may be strongly connected even though @xmath0 itself is not ( figure  [ f-6 ] ) , so that ( [ e - star ] ) applies to a broader class of graphs than does the mtt itself .",
    "equation ( [ e - star ] ) may be used to revisit the applications above to understand the impact of synthesis and degradation .",
    "it also opens up for analysis a broad range of new biological contexts .",
    "for instance , regulated degradation is a frequently used mechanism in several signal transduction pathways , such as the wnt / beta - catenin and death - receptor pathways , @xcite , which also make abundant use of reversible ligand binding and post - translational modification .",
    "analysis of these using the linear framework is work in progress .",
    "time - scale separation , leading to elimination of internal complexity , has been a fundamental method for analysing biochemical systems , from the earliest days of single - enzyme biochemistry through molecular biology to modern studies of multi - component systems .",
    "the framework shows that these calculations , which were previously considered distinct , are , in fact , the same .",
    "moreover , they are all linear .",
    "the linearity hinges on the uncoupling condition , which allows nonlinearity in the dynamical variables to be traded for algebraic complexity in the labels .",
    "the fact that uncoupling is feasible in so many different contexts indicates a remarkable degree of linearity concealed within nonlinear biochemistry , a surprising insight that is amplified by the results of crnt in figure  [ f-2 ] .",
    "the framework brings systematic techniques , clarity and pedagogical coherence to the field and lays a foundation for developing new methods of analysis .    one intriguing direction to explore",
    "is the extension of the framework from the steady state to the dynamics .",
    "the problem of whether time - scale separation yields a good approximation of the dynamics can be studied by the method of singular perturbation , @xcite . however ,",
    "this has only been undertaken for a limited number of biological examples .",
    "the framework provides the means to formulate such an analysis in a far more general way .",
    "in contrast to simulations , for which all details most be specified in advance , the framework yields results that hold irrespective of the underlying molecular complexity .",
    "it is , therefore , well suited for distilling biological principles without becoming mired in the molecular details , a much needed facility for modern biology .",
    "matrices similar to the laplacian in equation ( [ e - lap ] ) were first introduced for unlabelled , undirected graphs by gustav kirchhoff in his 1847 paper , @xcite , whose title , in english translation , _ `` on the solution of the equations obtained from the investigation of the linear distribution of galvanic currents '' _ , suggests its origins in his well - known studies of electrical circuits . in this form",
    ", the laplacian may be seen as a discrete version of the continuous laplacian operator but the same name is used for different versions and normalisations , @xcite .",
    "the concept of a spanning tree and a result similar to the matrix tree theorem also make their appearance in kirchhoff s paper .",
    "this seems to be the first of many subsequent matrix tree theorems ; see ( * ? ? ?",
    "* chapter  5 ) for historical references .",
    "several deep properties of graphs emerge from the spectral theory of laplacian matrices @xcite .",
    "bill tutte , one of the founders of modern graph theory , extended the concepts to directed graphs and proved the version of the mtt used here , @xcite .",
    "we sketch a proof of equation ( [ e - klap ] ) which gives a basis for the kernel of the laplacian .",
    "while the essential ideas are introduced we leave it to the reader to fill in some of the details .",
    "let @xmath0 be an arbitrary labelled , directed graph on the vertices , @xmath1 .",
    "as always , we assume that @xmath0 has no self loops .",
    "choose @xmath21 .",
    "let @xmath119 be the acyclic directed graph on the strongly connected components ( sccs ) of @xmath0 , as in figure  [ fs-1]c .",
    "suppose that the vertices of @xmath119 are @xmath120 and that @xmath121 is an initial scc that is not also terminal . by construction",
    ", there must be some vertex , @xmath122 , with an edge leaving @xmath121 , @xmath123 , where @xmath124 .",
    "if @xmath125 , there is a positive flux of material along this edge . for @xmath5",
    "to be a steady state , this flux must be balanced by some flux coming into @xmath126 .",
    "this can only arise from some edge @xmath127 with @xmath128 .",
    "taking all such vertices , recursively , yields a subset of vertices that can be the only source of the balancing flux into @xmath126 .",
    "however , because @xmath126 is an initial scc , this subset is entirely contained in @xmath121 . since this scc has only a limited amount of material , it can not indefinitely balance the outgoing flux on the edge @xmath123 .",
    "it follows that @xmath129 .",
    "however , if @xmath130 then there is positive flux coming into @xmath126 along the edge @xmath123 . this can only be balanced by an edge @xmath131 with @xmath132 .",
    "arguing recursively in a similar way as above yields a similar contradiction .",
    "we conclude that @xmath133 .",
    "but then @xmath134 for any vertex @xmath86 with @xmath135 .",
    "since @xmath121 is strongly connected , it is then easy to see that @xmath134 for any @xmath136 .",
    "it follows that @xmath5 has no support on any initial scc that is not also terminal .",
    "( the support of @xmath5 is the subset of vertices , @xmath25 , such that @xmath137 . )",
    "it is now easy to argue by induction over those sccs that are not terminal to show that the support of @xmath5 contains only vertices that are in terminal sccs .",
    "consider each terminal scc , @xmath37 , as a labelled , directed graph , @xmath138 , in its own right , in isolation from the rest of @xmath0 .",
    "assume that @xmath138 has @xmath139 vertices .",
    "let @xmath140 be the vector obtained from @xmath5 by restricting @xmath5 to those vertices lying in @xmath37 . since @xmath5 has no support outside the terminal sccs and there are no edges between the terminal sccs , it should be clear that @xmath141 .",
    "let @xmath142 is the vector coming from the mtt applied to @xmath143 . since @xmath37 is strongly connected and @xmath144 , it must be that @xmath145 , for some @xmath146",
    ". now let @xmath38 be the vector constructed for equation ( [ e - klap ] ) , @xmath147 since the terminal sccs are disjoint , the vectors , @xmath148 , are linearly independent by construction .",
    "evidently , @xmath149 .",
    "hence , these vectors form a basis for the kernel of the laplacian , @xmath150 which proves equation ( [ e - klap ] ) .",
    "consider the labelled , directed graph , @xmath0 , arising from the binding of multiple ligands to multiple sites on a substrate that may exist in multiple states , as discussed in the paper .",
    "the microstates are assumed to be encoded in some way , as in figure  [ f-3 ] , and are enumerated simply as @xmath1 .",
    "edges correspond either to changes in state of the substrate , with ligand binding unaltered , or to ligand binding or unbinding , with substrate state unaltered . assuming that the system can reach thermodynamic equilibrium , each edge is reversible and edges",
    "can therefore be treated in pairs , @xmath151 a ligand binding edge is assumed to have a label , @xmath152 $ ] , where @xmath153 is a rate constant and @xmath154 $ ] is the concentration of one of the ligands , treated either at steady state or as slowly varying . for all other edges , the label is a rate constant .    if @xmath5 is a steady state of @xmath0in other words , if @xmath21then @xmath5 satisfies db if each reversible edge is independently at kinetic equilibrium . in other words , whenever there is a reversible edge , the forward and reverse fluxes are balanced , @xmath155 the cycle condition on @xmath0 states that , for any cycle of reversible edges , the product of the rate constants on the edges going clockwise is equal to the product of the rate constants on the edges going counterclockwise .",
    "we want to show that the cycle condition holds on @xmath0 if , and only , if every steady state satisfies db .",
    "suppose first that @xmath5 satisfies db .",
    "since the net flux through any reversible edge is zero , the net flux around any cycle of reversible edges is also zero .",
    "we know from ( [ e - kp ] ) that @xmath156 where @xmath157 .",
    "choose any cycle of reversible edges and pick any two vertices on it , say @xmath158 and @xmath159 .",
    "the cycle can be broken into a pair of directed paths from @xmath158 to @xmath159 .",
    "applying ( [ e - kuv ] ) repeatedly on each path gives two expressions for @xmath160 in terms of @xmath161 .",
    "equating these expressions , cancelling ligand concentrations and clearing denominators , yields the cycle condition .",
    "since the cycle was chosen arbitrarily , this proves the first part .",
    "now suppose the cycle condition holds .",
    "let @xmath5 be any steady state .",
    "we need to show that @xmath5 satisfies db .",
    "we construct an alternative steady state @xmath162 , which we show to satisfy db , and then prove that @xmath163 .",
    "assume that the reference microstate , @xmath9 , has no ligands bound , and set @xmath164 .",
    "for any other microstate @xmath86 , choose some path of reversible edges from @xmath9 to @xmath86 and use ( [ e - kuv ] ) to express @xmath165 in terms of @xmath166 .",
    "now choose some other path from @xmath9 to @xmath86 and obtain a second expression for @xmath165 in terms of @xmath166 .",
    "the two paths together form a cycle of reversible edges , to which the cycle condition applies . reorganising",
    "the cycle condition and putting in the appropriate ligand concentrations shows that the two path expressions give the same result for @xmath165 .",
    "hence , this quantity is well defined , irrespective of the path chosen .",
    "we have unambiguously defined a state , @xmath162 , of @xmath0 but we have yet to show that it is a steady state .",
    "consider any reversible edge between the microstates @xmath25 and @xmath86 .",
    "choose a pair of reversible paths from @xmath9 to @xmath25 and from @xmath9 to @xmath86 .",
    "together with the reversible edge between @xmath25 and @xmath86 , this gives a cycle of reversible edges . applying the cycle condition ,",
    "it is easy to see that , in the state @xmath162 , the reversible edge between @xmath25 and @xmath86 must be in kinetic equilibrium .",
    "this not only implies that @xmath162 is a steady state but also that @xmath162 satisfies db .",
    "but now , @xmath0 is strongly connected and so @xmath26 . hence , @xmath167 for some @xmath28 . since @xmath164 , @xmath168",
    "hence , @xmath163 and therefore @xmath5 satisfies db .",
    "this completes the proof .",
    "if the reference vertex , @xmath9 , has no ligands bound , then , in any steady state @xmath5 , the quantity @xmath169 is a monomial in the ligand concentrations and the power to which @xmath154 $ ] appears is the number of @xmath170 molecules bound in microstate @xmath25 .",
    "hence , the concentration of states in which @xmath170 is bound is given by @xmath171(\\partial x_{tot}/{\\partial [ l_u]})\\ ] ] and the `` fractional saturation '' , or average concentration of states bound by @xmath170 , is the logarithmic derivative , @xmath172}{x_{tot}}\\right)\\frac{\\partial x_{tot}}{\\partial [ l_u ] } \\ , .",
    "\\label{e - fs}\\ ] ] more complex aggregate concentrations can be worked out in a similar way .",
    "db implies that any steady state @xmath173 of @xmath0 gives , by restriction , a steady state @xmath174 of any subgraph , @xmath175 .",
    "if @xmath175 and @xmath42 are subgraphs that are disjoint ( no vertex in common ) , which together span @xmath0 , we get the sum formula @xmath176    if ligands bind independently , so that the site - specific rate constants are independent of the microstate in which ligand binds , then the graph may be decomposed into a product of the graphs for single site binding .",
    "the product of two graphs is defined as follows .",
    "suppose that @xmath0 is a labelled , directed graph on the vertices @xmath177 and that @xmath178 is a labelled , directed graph on the vertices @xmath179 .",
    "the product @xmath180 is the labelled , directed graph on the vertices @xmath181 in which there is an edge @xmath182 whenever there is an edge @xmath183 in @xmath0 and , symmetrically , there is an edge @xmath184 whenever there is an edge @xmath185 in @xmath178 .",
    "there are no edges in @xmath180 other than these .",
    "this construction captures the fact that a change in state of either factor is independent of the state of the other factor .",
    "the steady state of a product may be obtained from those of its factors as follows .",
    "define the normalised total steady state by @xmath186 , where @xmath5 is any steady state .",
    "it follows from equation  [ e - elim ] that @xmath187 is independent of @xmath5 , although it may depend on the choice of reference vertex . with @xmath188 as the reference in @xmath180 , it is not difficult to prove the product formula , @xmath189 independent binding allows @xmath187 to be factorised .",
    "the details of the calculation of the enzymatic rate formula in figure  [ f-4 ] are shown in figure  [ fs-1 ] .",
    "the rate of product formation is given by @xmath190}{dt } = k^+_{p+1}[y_p ] - k^-_{p+1}[p][e ] \\ , .",
    "\\label{e - ert}\\ ] ] using the ordering in figure  [ fs-1 ] , in which vertex @xmath191 corresponds to @xmath192 , the elimination formula in equation ( [ e - elim ] ) gives @xmath193 = ( \\rho_p/\\rho_{tot})e_{tot}$ ] and @xmath194 = ( \\rho_{p+1}/\\rho_{tot})e_{tot}$ ] .",
    "hence , @xmath190}{dt } = ( k^+_{p+1}\\rho_p - k^-_{p+1}[p]\\rho_{p+1})\\left(\\frac{e_{tot}}{\\rho_{tot}}\\right ) \\ , .",
    "\\label{e - cir}\\ ] ] the spanning trees of an isolated cycle are easily enumerated ( figure  [ fs-1]c ) and the mtt shows that @xmath195 and @xmath196+\\beta_i[p]$ ] , for @xmath197 , where @xmath198 are polynomials in the rate constants .",
    "hence , @xmath199 + \\left(\\sum_{i=1}^p \\beta_i\\right)[p ] \\ , .",
    "\\label{e - rt}\\ ] ] comparing the spanning trees for vertices @xmath200 and @xmath191 reveals substantial cancellation when calculating the pre - factor in ( [ e - cir ] ) ( figure  [ fs-1]c ) .",
    "this simplifies to the difference between the product of the labels going clockwise around the cycle and the product of the labels going counterclockwise , @xmath201\\rho_{p+1 } = \\underbrace{k^+_1[s]k^+_2 \\cdots k^+_{p+1}}_{\\mbox{\\small labels on cw edges } } \\;\\ ; - \\;\\ ; \\underbrace{k^-_1k^-_2 \\cdots k^-_{p+1}[p]}_{\\mbox{\\small labels on ccw edges } } \\ , .",
    "\\label{e - cw}\\ ] ] note that the term on the right in ( [ e - ert ] ) is the steady - state net flux around the isolated cycle in figure  [ fs-1]b .",
    "when this is zero , ( [ e - cw ] ) shows that the product of the clockwise labels equals the product of the counterclockwise labels .",
    "this gives another proof of the cycle condition , discussed in  [ s - te ] , which holds at thermodynamic equilibrium .",
    "combining ( [ e - rt ] ) and ( [ e - cw ] ) and normalising appropriately yields the rate formula @xmath190}{dt } = \\frac{\\left[v_s\\left(\\frac{[s]}{k_s}\\right ) - v_p\\left(\\frac{[p]}{k_p}\\right)\\right]e_{tot}}{1 + \\left(\\frac{[s]}{k_s}\\right ) + \\left(\\frac{[p]}{k_p}\\right ) } \\ , , \\label{e - mmr}\\ ] ] where @xmath202 , @xmath203 , @xmath204 , @xmath205 are rational expressions in the rate constants .",
    "this is the reversible michaelis - menten formula @xcite .",
    "note that this has the same form irrespective of the number of intermediates .",
    "t.  s. najdi , c.  r. yang , b.  e. shapiro , g.  w. hatfield , and e.  d. mjolsness .",
    "application of a generalised mwc model for the mathematical simulation of metabolic pathways regulated by allosteric enzymes .",
    ", 4:33555 , 2006 .",
    "l.  neumann , c.  pforr , j.  beaudoin , a.  pappa , n.  fricker , p.  h. krammer , i.  n. lavrik , and r.  eils .",
    "dynamics within the cd95 death - inducing signaling complex decide life and death of cells .",
    ", 6:352 , 2010 .",
    "s.  prabhakaran , r.  a. everley , i.  landrieu , j.  m. wieruszeski , g.  lippens , h.  steen , and j.  gunawardena .",
    "comparative analysis of erk phosphorylation suggests a mixed strategy for measuring phospho - form distributions .",
    ", 7:482 , 2011 .",
    ", gives rise to a system of linear differential equations by treating each edge as a first - order chemical reaction under mass - action kinetics , with the label as rate constant .",
    "the corresponding matrix is the laplacian of @xmath0 . *",
    "( b ) * in a strongly connected graph ( note the difference to the one in * a * ) , there are spanning trees rooted at each vertex , the roots being circled .",
    "the mtt gives an element of @xmath22 according to the formula in the box , as explained in the text . for more examples of spanning trees",
    "see figures  1 and 2 of the appendix . * ( c ) * in a general directed graph , @xmath0 , two distinct vertices are in the same strongly connected component ( scc ) if each can be reached from the other by a path of directed edges .",
    "the sccs form a directed graph , @xmath119 , in which two sccs are linked by a directed edge if some vertex of the first scc has an edge to some vertex of the second scc .",
    "@xmath119 has no directed cycles , allowing initial and terminal sccs to be identified .",
    "[ f-1 ] ]    , is shown ( bottom right ) for a substrate @xmath90 existing in two states of modification , @xmath206 and @xmath207 , which are inter - converted by enzymes @xmath192 and @xmath208 .",
    "each enzyme uses the classical michaelis - menten reaction mechanism , with enzyme - substrate complexes , @xmath209 and @xmath210 .",
    "mass - action kinetics gives a system of nonlinear differential equations , @xmath48 , where @xmath211 is the concentration of species @xmath25 .",
    "the component functions @xmath212 are listed .",
    "the network gives rise to the labelled , directed graph @xmath51 on complexes ( top right ) .",
    "the nonlinear function @xmath52 may be decomposed into the linear laplacian , @xmath53 , as defined in figure  [ f-1]a , and two linking functions , a linear function @xmath213 and a nonlinear function @xmath57 . formally ,",
    "if @xmath69 denotes the multiplicity of species @xmath25 in complex @xmath66 , then , for @xmath214 , @xmath215 is the corresponding mass - action expression , @xmath216 and if @xmath217 is the basis element of @xmath218 corresponding to complex @xmath66 , then @xmath219 is the list of multiplicities in @xmath220 , @xmath221 . with these definitions ,",
    "the diagram in the centre commutes : @xmath222 .",
    "[ f-2 ] ]     in any steady state @xmath5 of the laplacian dynamics on the graph . in this example , reactions are asumed to take place at thermodynamic equilibrium , without dissipative changes , such as nucleosome reorganisation . *",
    "( b ) * protein allostery , @xcite .",
    "an allosteric dimer is shown in two quaternary states , relaxed and tense .",
    "ligand can bind to each monomer on a fast time - scale compared to catalytic activity of the protein .",
    "the labelled , directed graph has both quaternary state changes ( relaxed to tense and vice versa ) and ligand binding and unbinding , with the corresponding reactions being assumed to take place at themodynamic equilibrium .",
    "labels have been omitted for clarity . for allosteric enzymes ,",
    "the overall rate is assumed to be proportional to the fraction of sites that are bound by ligand ( the fractional saturation ) , which can be directly calculated as described in the appendix .",
    "[ f-3],scaledwidth=90.0% ]     converting substrate @xmath90 into product @xmath223 via the intermediate complexes @xmath224 . with the indicated separation of time scales ,",
    "a labelled , directed graph can be contructed with vertices @xmath225 , corresponding to @xmath224 , respectively , and an additional vertex @xmath191 , corresponding to the free enzyme , @xmath192 .",
    "the two edges leading out of @xmath191 , representing the formation of intermediate complexes , acquire algebraic expressions as labels , while all other edges have the corresponding rate constants . with this choice of labels the linear laplacian dynamics on the graph",
    "recapitulates the full nonlinear dynamics of the reactions .",
    "the mtt can be used to be used to calculate the rate of product formation , @xmath226 - k^-_{p+1}[p][e]$ ] , as explained in the som , leading to the reversible michaelis - menten formula , @xcite.[f-4 ] ]     and @xmath227 , methyltransferase @xmath228 , phosphatase @xmath208 and demethylase @xmath229 .",
    "the system is coupled upstream to core metabolism that renews the donor molecules ( for methylation , sam is s - adenosyl methionine , sah is s - adenosyl homocysteine and ch@xmath230o is formaldehyde ) and downstream to the biological processes influenced by ptm .",
    "assuming time - scale separations as shown , the ptm system gives rise to a directed graph on the modforms , one edge of which , from @xmath231 to @xmath232 , is highlighted in the box .",
    "this edge is catalysed by @xmath233 and @xmath227 through the individual reaction mechanisms shown , in which the modifier species can be ignored because of the time - scale separation .",
    "@xmath233 acts sequentially , producing only @xmath232 from @xmath231 ; @xmath227 can produce both @xmath232 and @xmath234 in a random , distributive manner as well as the doubly phosphorylated @xmath235 processively .",
    "also shown are the corresponding graphs on the intermediate complexes , constructed as in figure  [ f-4 ] , with labels omitted for clarity . using the mtt yields expressions whose coefficients , @xmath236 , may be regarded as the reciprocals of generalised michaelis - menten constants .",
    "the appropriate label on the edge @xmath237 can then be assembled as a linear combination of the steady - state concentrations of @xmath233 and @xmath227 , with coefficients that are generalised catalytic efficiencies .",
    "see @xcite for further details .",
    "[ f-5],scaledwidth=90.0% ]    a is augmented with partial edges denoting synthesis and degradation to form the partial graph @xmath98 . for clarity ,",
    "only those partial edges with non - zero labels are shown . under mass - action kinetics",
    ", @xmath98 gives rise to a non - homogenous system of linear odes .",
    "* ( b ) * by introducing a new vertex , @xmath108 , the labelled , directed graph , @xmath107 , can be formed , which , in this case , is strongly connected , with the corresponding laplacian .",
    "using the mtt to calculate @xmath238 , as shown ( the spanning trees are enumerated in figure  2 of the som ) , the unique steady state of @xmath98 can be calculated as @xmath239 , for @xmath240 .",
    "[ f-6],scaledwidth=90.0% ]    . *",
    "( b ) * the corresponding labelled , directed graph .",
    "note that its orientation is different from that shown in figure  [ f-4 ] .",
    "note that only the two outgoing edges from vertex @xmath191 have algebraic expressions for labels . *",
    "( c)*. enumeration of the spanning trees rooted at vertex @xmath200 ( top ) , corresponding to @xmath241 , and vertex @xmath191 ( bottom ) , corresponding to @xmath192 .",
    "the spanning trees for any root may be constructed by choosing a gap between adjacent vertices , with the edges running in opposite directions to the root on either side of the gap . using the labels in * b * and the mtt formula from figure  [ f-1]b",
    ", it can be checked that only @xmath242 has no occurrences of @xmath243 $ ] or @xmath244 $ ] , while each @xmath24 , for @xmath245 , has either one @xmath243 $ ] or one @xmath244 $ ] but not both .",
    "this proves equation ( [ e - rt ] ) .",
    "considering the depicted trees in vertical pairs , it can similarly be checked that the pre - factor in equation ( [ e - cir ] ) reduces to the two terms coming from the last pair of trees , giving the formula in equation ( [ e - cw ] ) .",
    "[ fs-1],scaledwidth=90.0% ]"
  ],
  "abstract_text": [
    "<S> key insights in molecular biology , such as enzyme kinetics @xcite , protein allostery @xcite and gene regulation @xcite , emerged from quantitative analysis based on time - scale separation , allowing internal complexity to be eliminated and resulting in the well - known formulas of michaelis - menten , monod - wyman - changeux and ackers - johnson - shea . in systems biology , steady - state analysis has yielded eliminations that reveal emergent properties of multi - component networks @xcite . here </S>",
    "<S> we show that these analyses of nonlinear biochemical systems are consequences of the same linear framework , consisting of a labelled , directed graph on which a laplacian dynamics is defined , whose steady states can be algorithmically calculated . </S>",
    "<S> analyses previously considered distinct are revealed as identical , while new methods of analysis become feasible . </S>"
  ]
}