{
  "article_text": [
    "with the development of new simulation methods and the increase in available computational power , molecular dynamics has become an important tool in the simulation of matter in the condensed state@xcite . in its earliest applications ,",
    "molecular dynamics methods were employed to simulate systems of interacting particles with a constant density and energy , using a simulation cell with a fixed volume and shape and with a constant number of particles inside . for extended systems ,",
    "periodic boundary conditions were introduced to reduce finite cell - size effects .",
    "the calculations with constant energy , volume and number of particles are expected to simulate the thermodynamic properties of the micro - canonical ensemble . however , in laboratory conditions , one often controls the intensive variables temperature @xmath0 and pressure @xmath1 , instead of the extensive variables @xmath2 and @xmath3 .",
    "therefore molecular dynamics methods were developed to simulate systems at constant temperature or pressure@xcite . in the case of constant pressure simulations , the size and shape of the simulation cell must be allowed to change . in order to do so , an `` extended system '' is constructed which includes degrees of freedom for the cell .",
    "a microscopic simulation of the structural , mechanical , and dynamical response of material systems to external stress of interest in tribology , material fatigue and wear , crack propagation , stress induced phase and structural transformations , lubrication and hidrodynamical phenomena , is more conveniently done with varying cell shapes .",
    "the dynamics of the cell is fictitious .",
    "therefore there are many reasonable choices for the equations of motion of the variables associated with the cell .",
    "traditionally the dynamical variables were the cartesian components of the vectors defining the periodicity of the simulation cell .",
    "the early choices for the equations of motion had some invariance problems , and more complicated equations of motion have been proposed to avoid those problems .",
    "here we suggest the use of the dot products between the vectors defining the simulation cell as the variables for the cell dynamics .",
    "we show that using the new variables avoids in a natural way the problems previously encountered .",
    "to simulate a system at constant pressure , one must allow for variations of the volume and shape of the simulation cell .",
    "andersen@xcite proposed to use the volume @xmath3 of a cubic simulation cell as a dynamical variable in an extended hamiltonian , thus allowing for volume fluctuations driven by the dynamical imbalance between the imposed external pressure , @xmath4 , and the actual instantaneous internal pressure , @xmath5 , as given by the virial theorem .",
    "as the simulation cell is periodically repeated , the dynamics associated with the cell is fictitious . in the extended lagrangian for the dynamics ,",
    "andersen included a fictitious kinetic energy term associated with the rate of change of volume ,    @xmath6    where @xmath7 is a fictitious `` mass '' associated with the cell .",
    "he also added the term @xmath8 , which is the potential from which the constant external pressure acting on the cell is derived . during the simulations",
    ", the volume @xmath3 fluctuates about an average value such that , in the limit of long simulation times , the time average of the calculated internal pressure is equal to the chosen external pressure , @xmath9 .",
    "here we use an overline to indicate the limit of a time average for long calculation times . in those simulations",
    "it is the enthalpy @xmath10 that is approximately conserved , not the internal energy , and andersen showed that , assuming ergodicity , his simulation method samples the isoshape - isobaric - isoenthalpic ensemble to an accuracy of @xmath11 when calculating ensemble averages of intensive parameters ( @xmath12 for extensive parameters ) , where @xmath13 is the number of particles in the simulation cell .",
    "andersen s method is best suited to study equilibrium properties of fluids , for which the shape of the cell is irrelevant . to study shear flow ( viscosity ) in fluids or to study solids",
    "it is not enough to change volume with constant shape .",
    "for example , a given cell shape may be compatible with the periodicity of one crystal structure and be incompatible with another solid phase , and so the fixed cell shape may artificially prevent the appearance of thermodynamically more stable phases . in order to study structural phase transitions , parrinello and rahman@xcite extended andersen s method to allow for changes in both the volume and the shape of the cell .",
    "they used as dynamical variables the cartesian components @xmath14 of the three vectors @xmath15 defining the periodicity of the simulation cell . here",
    "@xmath16 are the three orthonormal vectors that define a cartesian coordinate system . to generate the dynamics , a fictitious kinetic energy of the cell @xmath17 is included in the lagrangian , where @xmath18 is again a fictitious mass . in the limit of large @xmath13 ,",
    "the equipartition principle tells us that the kinetic energy of the 9 variables of the cell is small compared with the kinetic energy of the @xmath19 variables associated with the particles positions , and the method simulates the isobaric - isoenthalpic ensemble .",
    "as the kinetic energy of the cell is fictitious , it can be chosen in many reasonable ways that simulate the same ensemble in the limit of large number of particles , @xmath13 , and large simulation times . however , different choices of the fictitious cell kinetic energy yield different dynamics , and one can ask which is better or more convenient .",
    "several authors have pointed out some shortcomings of the original method of parrinello and rahman : it is not invariant under modular transformations ( defined below ) , the consistency between the condition of mechanical equilibrium and the virial theorem is only verified in the large @xmath13 limit , and it has spurious cell rotations@xcite .    for a given periodic system , there are infinite equivalent choices of the basic simulation cell .",
    "if @xmath20 are three vectors commensurate with the periodic system , then the transformation @xmath21 , with @xmath22 an integer matrix with @xmath23 , gives another set of vectors describing the periodicity .",
    "it is desirable that the dynamics should not depend on the particular choice that is made , i.e. , the equations of motion should be formally invariant with respect to the interchange between equivalent cells ( modular transformations)@xcite .",
    "this characteristic improves the physical content of the simulation , by eliminating symmetry breaking effects associated with the fictitious part of the dynamics@xcite . of course ,",
    "in the thermodynamic limit ( @xmath24 ) these effects vanish , but they may be important in computer simulations , which may use only a small number of particles .",
    "that is often the case in first - principles molecular dynamics@xcite .    for long simulation times and constant applied pressure ,",
    "the dynamics for the cell should yield @xmath25 , with @xmath26 the internal stress in cartesian coordinates given by the stress theorem , which is a generalization of the virial theorem@xcite .",
    "a weaker condition that is easily checked is that this should be verified in particular when the cell is restricted to undergo isoshape fluctuations@xcite .",
    "andersen s method obeys this condition , while the same is true for the parrinello - rahman dynamics only in the large @xmath13 limit@xcite .",
    "the orientation in space of the simulation cell is irrelevant for the structural and thermodynamical description of the system ( principle of material - frame indifference@xcite ) .",
    "however , it is included in the dynamics if one uses the components of the cell edges as dynamical variables , and spurious cell rotations have been obtained in actual simulations with the parrinello - rahman method , namely in the simulation of molecules , whose internal degrees of freedom sometimes cause the internal stress to be asymmetrical@xcite .",
    "these rotations not only are physically irrelevant , but may complicate the analysis of the simulations results .",
    "methods to eliminate them have been proposed , such as constraining the matrix of the lattice vectors to be symmetrical@xcite or upper triangular@xcite ( geometrical constraints ) , or by symmetrization of the infinitesimal strain at each time step ( dynamical constraint)@xcite .",
    "[ metricmd ]",
    "if @xmath27 , @xmath28 and @xmath29 are three linearly independent vectors that define the periodic simulation cell and form a right - handed triad , then all the properties of the simulated system depend only on the symmetrical metric tensor , @xmath30 and not on the orientation of the three vectors in space . in our new simulation method ,",
    "we use the 6 independent components of the metric tensor as the dynamical variables for the cell .",
    "the three diagonal elements of the metric give information about the lengths of the lattice vectors , and the three independent off - diagonal elements contain the additional information about the angles between those vectors .",
    "the covariant components of the tensor @xmath31 are related to the matrix @xmath32 , the transformation matrix between cartesian and lattice coordinates , by the relation @xmath33 where @xmath34 is the transpose of @xmath35 .",
    "the one - forms @xmath36 associated with the lattice vectors @xmath20 , which are ( except for a factor of @xmath37 ) the reciprocal lattice vectors , are related to the contravariant components of the metric tensor , @xmath38 and the volume of the unit cell is given by @xmath39    the position @xmath40 of the @xmath41 atom in the simulation cell can be defined by its lattice coordinates @xmath42 , @xmath43 where we use the einstein summation convention for tensorial quantities .",
    "the distance between any two points can be calculated from the metric and the lattice coordinates , and therefore they completely define the geometry of the simulation cell .    in the parrinello - rahman formalism , the calculation of the total distance traveled by a particle can be misleading . because the unphysical motion due to the rigid rotation of the cell should be discarded",
    ", one can not in general simply use a two - point formula to calculate , for example , the mean square displacement of a particle .",
    "the correct formula for the distance is naturally expressed in terms of the metric :    @xmath44    for a fixed cell ( i.e. , for a fixed @xmath45 ) , the newton s equations of motion can be derived from the lagrangian @xmath46 where the summation is over all @xmath13 atoms in the cell , @xmath47 is the mass of atom @xmath48 , and the potential energy per cell @xmath49 includes interactions between atoms in different cells .",
    "@xmath49 is a function of the @xmath50 lattice coordinates of the atomic positions and the 6 independent components of the metric tensor . in the examples of a latter section ,",
    "@xmath49 is either the born - oppenheimer energy from a first - principles pseudopotential local - density calculation or the potential energy of the lennard - jones model .",
    "the momentum canonically conjugate to @xmath51 is @xmath52 and the corresponding hamiltonian is    @xmath53    to construct the extended lagrangian for the cell dynamics , we must choose the fictitious kinetic energy of the cell , @xmath54 , and , for simulations with applied pressure , add the term @xmath55 .",
    "a simple non - negative scalar that is quadratic in the time derivatives of all the components of @xmath31 is @xmath56 where @xmath57 is a fictitious cell `` mass '' which has the dimensions of mass times length squared .",
    "the positivity of this term is shown in appendix a. instead of @xmath58 , we choose the slightly modified expression , which is again a scalar , quadratic in @xmath59 , but with a different densitary character , @xmath60 where *  * @xmath61 is a fictitious cell `` mass '' with the dimensions of mass times length@xmath62 . alternatively , we may view @xmath63 as an effective `` mass '' tensor .",
    "although @xmath64 gives slightly more complicated equations of motion for the cell , it has the advantage of reducing to andersen s @xmath65 ( see eq .",
    "[ kander ] ) in the case of isoshape fluctuations of the cell , if we make the identification @xmath66 , and so the dynamics that it generates obeys the virial theorem in that limit@xcite .",
    "since we are using the metric , the orientation of the cell never appears in the equations .",
    "it can also be verified that @xmath64 is invariant with respect to modular transformations of the @xmath20 .",
    "the fictitious lagrangian for the extended system in the presence of an applied external pressure is @xmath67 and the equations of motion for the atomic coordinates are @xmath68 where @xmath69 are the covariant components of the force ( which can be viewed as the components in reciprocal lattice coordinates multiplied by @xmath70 ) .",
    "this equation for the scaled atomic coordinates is identical to the one obtained from parrinello - rahman s lagrangian , since it does not depend on the choice of @xmath54 .",
    "it should be stressed that this does nt imply that the dynamics of the atoms is the same , because in order to convert from the scaled dynamics to the actual atomic dynamics we have to use the metric , which is determined by the cell s dynamics",
    ". hence the importance of a fictitious cell dynamics which does nt introduce unphysical symmetry - breaking effects@xcite .",
    "the coupling of the atomic motion to the cell s motion is made through the second term on the r.h.s .",
    "[ atoms ] , which is independent of the orientation and state of rotation of the cell ; from this , the physical irrelevance of the orientation of the cell is evident .",
    "the equation of motion for the cell variables is derived with the help of the relation @xmath71 , giving    @xmath72    where the contravariant components of the internal stress are ( see appendix b ) @xmath73 the instantaneous internal pressure averaged over the cell is @xmath74 , and it can also be obtained from @xmath75@xcite or @xmath76 : @xmath77    defining the momentum canonically conjugate to the metric tensor @xmath78    the conserved extended hamiltonian can be written as    @xmath79    in the following sections it will be convenient to define a symmetrical covariant internal stress tensor as @xmath80 which contains the contributions from the potential energy @xmath49 to @xmath81 .",
    "[ anisotropicstress ]",
    "a constant applied anisotropic stress is in general non - conservative , and thus there is no conserved extended hamiltonian in a constant anisotropic stress simulation@xcite .",
    "of course some experimental situations are essentially non - conservative , and therefore best simulated by an appropriate non - conservative dynamics@xcite . in this section",
    "we will present a conservative dynamics , but one should keep in mind that the simulation should be taylored to the problem .",
    "molecular dynamics simulations with an applied anisotropic stress were first proposed by parrinello and rahman@xcite .",
    "ray and rahman@xcite later showed that the original formulation was valid only in the limit of small deformations , and they proposed an extension valid for finite deformations , in which it is the thermodynamic tension ( defined below ) , not the stress , that is kept constant , and the quantity that is approximately conserved during the simulation is the generalized enthalpy of thurston@xcite .",
    "this approach is based on the fact that , if the external stress is allowed to change when the cell deforms , so as to keep the thermodynamic tension constant , the virtual work of the stress upon deformations of the cell is conservative , and so that stress is derivable from a potential , which can be used to construct an extended hamiltonian . the thermodynamic tension is given by@xcite @xmath82 where @xmath83 and @xmath84 are the reference lattice and its volume , and @xmath85 is the external stress in cartesian coordinates .",
    "for @xmath86 , @xmath87 and @xmath85 coincide .",
    "the virtual work @xmath88 done by an external stress on the faces of the cell during an infinitesimal deformation of the cell in the state @xmath35 is@xcite ,    @xmath89    where @xmath90 is the strain tensor for the lattice @xmath35 measured from the reference lattice @xmath83 .",
    "we see that @xmath91 is the thermodynamic variable conjugate to the strain .",
    "thus , for fixed @xmath87 , the differential is exact , and so we can integrate @xmath88 over a finite deformation , to obtain the elastic energy    @xmath92    the generalized enthalpy of thurston is given by@xcite @xmath93 where @xmath2 is the energy of the system . for our metric - based formulation ,",
    "it is desirable to use the metric , instead of the strain , as the thermodynamic variable . in order to find what is the conjugate variable",
    ", we have to express @xmath88 in terms of infinitesimal variations of the metric tensor",
    ". this can be done for a symmetrical ( i.e. , torque - free ) external stress , which does no work in pure rotations of the cell .",
    "the result is given in eq .",
    "( 3.5 ) of ref@xcite , and , expressed in tensorial notation is a simple expression , @xmath94 the thermodynamic variable conjugate to the metric is therefore the external stress in contravariant lattice coordinates . keeping @xmath95 constant when the cell deforms thus leads to a conservative external stress , derived from the potential @xmath96 where @xmath97 is some reference metric .",
    "since @xmath98 is fixed , one can drop the constant term @xmath99 from the definition of @xmath100 , obtaining @xmath101 which is independent of a reference configuration and quite compact when compared with the definition of @xmath87 in eq .",
    "[ thermotension ] .",
    "the condition that @xmath102 is constant is equivalent to requiring @xmath103 to be constant because its cartesian coordinates are @xmath104 as can be seen using eq .",
    "[ tensord ] from appendix b@xcite .",
    "nevertheless , to a given @xmath98 does nt correspond a unique thermodynamic tension , because @xmath83 is arbitrary .",
    "all the physical information is contained in @xmath98 and @xmath45 , except for the ( arbitrary ) choice of axes .",
    "the thermodynamic tension fixes the choice of axes and also a reference state , through @xmath83 .",
    "notice that from the transformation law for the contravariant components of the stress , @xmath105 $ ] obtained from eq .",
    "[ tensord ] keeping @xmath106 constant , we can conclude that @xmath100 as given by eq .",
    "[ ucell3 ] is invariant under modular transformations@xcite .    to grasp the physical meaning of @xmath102 ,",
    "let s consider the force acting on the face of the cell opposing edge @xmath107 .",
    "using eqs .",
    "[ ucell3 ] and [ metric2 ] , we obtain ( in cartesian coordinates ) @xmath108 showing how the force on the face @xmath107 is related to the stress .",
    "the new extended lagrangian can be obtained from @xmath109 given by eq .",
    "[ l2 ] , by replacing @xmath110 by the new @xmath100 , eq .",
    "[ ucell3 ] .",
    "the equation of motion for the atoms , eq . [ atoms ] , remains unchanged , and the equation of motion for the cell is obtained from eq .",
    "[ cell ] by replacing @xmath111 by @xmath112 : @xmath113 the conserved hamiltonian is @xmath114    in specific applications , it may be desirable to impose a constant external pressure , @xmath4 , plus a constant thermodynamic tension .",
    "note that the stress tensor associated with a constant pressure is @xmath115 , and so constant pressure is not a particular case of constant thermodynamic tension .",
    "the generalization is straightforward , and in this case , when considering only isoshape fluctuations of the cell , the equation of motion for the cell becomes    @xmath116    where @xmath117 is andersen s cell mass .",
    "this equation shows that the off - diagonal elements of @xmath118 are restricted to be zero , and the diagonal elements are restricted to take equal values , at all times : by imposing a fixed cell shape , we have arrived at an isotropic total stress , as should be expected on physical grounds . in equilibrium @xmath119 , and",
    "so the average of each diagonal component of @xmath120 equals @xmath121 , which implies @xmath122 , where the r.h.s .",
    "is the total external pressure .",
    "this shows that our method obeys the virial theorem in the case of isoshape fluctuations of the cell ( the proof in ref.@xcite mentioned in section [ anisotropicstress ] was for applied pressure only ) .",
    "[ optimization ]",
    "a problem encountered in the simulation of materials is the determination of the equilibrium structure of a crystal at a given pressure ( or anisotropic stress ) predicted by a given model @xmath123 of its total energy .",
    "this can , in principle , be achieved by the minimization ( under the appropriate constraint ) of @xmath49 , which is quite difficult because it is a multivalleyed function of many variables .",
    "a practical strategy is to use a simulated annealing to bring the configuration to a deep valley , followed by a search of a minimum in that valley .",
    "the annealing step can be carried out by the variable cell shape molecular dynamics described previously coupled to a thermostat , brownian dynamics forces , or a periodic rescaling of the velocities .",
    "the local minimization can be done efficiently if one has the gradient of the function to be minimized .",
    "if we want to obtain the crystal structure at zero temperature and for an applied pressure of @xmath4 , we must minimize its enthalpy , @xmath124 the gradient of the enthalpy with respect to atomic positions is @xmath125 which is minus the covariant components of the force on that atom .",
    "notice that in molecular dynamics it is the contravariant components , @xmath126 that appear in the equation of motion .",
    "the gradient of the enthalpy with respect to the metric is @xmath127 the minimum is obtained when the forces are zero and when the mixed stress tensor divided by the volume is the pressure times the identity tensor , @xmath128 as desired .",
    "if we want to obtain the crystal structure for a fixed thermodynamic tension , then we must minimize the generalized enthalpy , @xmath129 the gradient of the generalized enthalpy with respect to the atomic lattice coordinates is still minus the covariant force on the atoms , and the gradient with respect to the metric is @xmath130 which is zero when the internal stress is equal to the desired applied stress , @xmath131 .",
    "[ applications ]",
    "in this section , we apply the method to the study of structural phase transitions and structural optimization . the isobaric - isoenthalpic ensemble , besides being somewhat unusual@xcite , is not the most adequate to study transitions induced by pressure or stress , because it does not allow for the exchange of heat with the surroundings .",
    "there are several methods described in the literature to perform simulations at constant temperature by connecting the system to a `` heat bath''@xcite . in our examples we use langevin molecular dynamics@xcite ,",
    "but first we checked that in our simulations the generalized enthalpy was conserved in the absence of the heat bath .",
    "in the course of a simulation of a structural transformation the release of heat of transformation must be dissipated to the heat bath , this takes some time and therefore the temperature of the system may rise to values quite above those of the heat bath .    as our first example we simulated a silicon crystal under a constant pressure using first - principles molecular dynamics .",
    "pioneering examples of first - principles molecular dynamics with variable cell shape include the optimization of the structure parameters of mgsio@xmath132 under pressure@xcite and the structural transition of silicon under pressure@xcite . in the first case",
    "the dynamical variable for the cell was the strain tensor , in the second the lattice vectors .    in our simulation of si ,",
    "the energy , forces and stresses were calculated within the local - density approximation , using a pseudopotential@xcite and a plane - wave basis set with a cutoff of 16  ry@xcite .",
    "the simulation cell contained 8 atoms , initially disposed in a diamond structure , with lattice constant @xmath133  a.u .",
    "the applied pressure was 25 gpa .",
    "the equations of motion were integrated with a beeman algorithm@xcite .",
    "the time step was @xmath134  a.u .",
    ", and the cell `` mass '' @xmath135  a.u .",
    "langevin dynamics with a viscosity damping constant of @xmath136 , where @xmath137 is the atomic mass of silicon , was used to simulate a heat bath with a temperature of 300k .",
    "it is well - known that silicon undergoes several phase transformations with increasing pressure , and its pressure - volume phase diagram has been extensively studied@xcite .",
    "starting from a diamond lattice , the structure changes at @xmath13811 gpa into @xmath139-sn , and between 13 and 16 gpa transforms into simple hexagonal .",
    "other densely packed phases appear at around 38 gpa . in the first @xmath140  ps ( 200 steps ) of the simulation , we observed ( fig .",
    "1 ) that the volume of the simulation cell was fluctuating around a value that corresponds to the volume of the metastable diamond structure of si at 25 gpa ( @xmath141 a.u .  for the 8 atoms of the conventional cubic unit cell ) .",
    "there was then a rapid drop in the volume , accompanied by a rapid rise in the ionic temperature to around 3500k ( well above the melting point ) .",
    "the simulation was interrupted after 1000 steps , well before equilibrium with the thermal bath was reached . after the transition , the volume of the cell oscillated around 650  a.u .",
    ", slightly below the volume of the stable simple hexagonal structure at that pressure , but above the density of the close - packed structures .",
    "remembering that at atmospheric pressure si contracts upon melting , and considering the high temperatures of the simulation , our results indicate that at high pressures , the liquid phase may still be denser than the solid phase .",
    "for the purpose of illustrating a molecular dynamics method the origin of the forces is irrelevant , therefore we used a lennard - jones model , with the constants adjusted to simulate argon , for the other examples in this article , as the computational demands are much lower . in our second example , we started with a cubic simulation cell with 32 argon atoms in an fcc lattice , and increased one diagonal contravariant component of the external stress , @xmath142 , linearly with time from zero to @xmath143 a.u .",
    "for the first 4000 simulation steps , and held thereafter @xmath142 at that value .",
    "all other applied stress components were kept at zero .",
    "this corresponds to a situation of uniaxial compression . during the first 10000 steps of the simulation the system is kept in contact with a heat bath at 10  k , at which point we minimize the generalized enthalpy",
    "( eq .  [ gen_enth ] ) using a method by davidon@xcite .",
    "the minimization is obtained in 96 steps which is approximately the number of variables , indicating that the heat bath kept the system near a quadratic region of the potential .    during the compression",
    "the system yields for an applied stress of @xmath144  gpa ( after @xmath145 steps ) , and due to the rearrangement of the atoms , the applied stress drops to a minimum of @xmath146  gpa and then rises again gradually , as the thermodynamic tension is increased . after the structural rearrangement ,",
    "the argon is still in a distorted fcc lattice , but the stress is now applied in a [ 110 ] direction instead of the initial [ 100 ] direction , and the area on which the force is applied is @xmath147 times larger .",
    "the yield was accompanied by a rapid rise in the ionic temperature up to @xmath148  k. the heat was gradually dissipated , and at around step 4000 the temperature was back to 10  k.    figure  [ fig_stress ] shows the evolution of two of the contravariant lattice components of the internal stress , @xmath142 and @xmath149 , compared with the corresponding imposed external stress components . at",
    "first the internal stress oscillates around the external values , in particular it accompanies the rise in applied stress .",
    "when the system yields we observe a dramatic increase in the amplitude of the stress oscillations , which are then damped with time . finally , in the minimization step the internal and external stress are identical within the precision demanded in the minimization ( @xmath150 ) .",
    "the contravariant components of the stress tensor are not what we are used to call stress ( their dimensionality is energy per area ) , so we show in figure  [ fig_stress_cart ] the evolution of the cartesian components @xmath151 of the applied and internal stress , where we chose the @xmath152 axis to be in the direction of the applied stress .",
    "one can see that the cartesian components of the applied stress are not constant when the contravariant components of the stress are constant , and that the oscillations of the internal stress are magnified , but they track each other , and they are identical at the end of the enthalpy minimization , as desired .",
    "the yield is also apparent in the plot of the potential component of the generalized enthalpy ( eq .",
    "[ gen_enth ] ) as a function of time ( fig .",
    "[ fig_enth ] ) .",
    "first we observe an increase of the enthalpy during load due to the work done on the system by the uniaxial stress .",
    "when the system yields there is a strong decrease of the potential component of the enthalpy even while we continue loading the system , showing that energy is transfered to the kinetic components , and later dissipated to the heat bath . only near the end of the loading cycle",
    "do we see the enthalpy rising again . during the annealing steps there is a rapid initial decrease of the enthalpy , meaning that the minimization procedure rapidly reaches the valley of the multi - variable function , but then takes some time to reach the minimum .    the best way to observe",
    "the yield is from the plot of the evolution of the lattice constants ( fig .",
    "[ fig_latt ] ) . from the initial slopes",
    "one could extract the young and poisson moduli for the system .",
    "after the yield we see that the three lattice constants are different from each other , and that they are rapidly determined by the minimization procedure . at the end of the simulation and after the inspection of the angles",
    "we obtain a monoclinic simulation cell , which is in reality a supercell of the orthorhombic system one should expect when loading an fcc crystal in the [ 110 ] direction .",
    "a movie of the simulation shows that the @xmath153 planes parallel to the uniaxial stress become distorted close - packed planes by compression along the direction of the stress and expansion along the perpendicular direction .",
    "a similar simulation was performed by ray and rahman in ref.@xcite .",
    "they found an fcc to close - packed transition , with the final structure presenting stacking - faults .",
    "our final example is of a structural optimization under pressure .",
    "we start from conditions quite away from equilibrium , perform 2000 steps in contact with an heat bath , and then switch to a gradient minimization .",
    "our target pressure is 0.3  gpa and we simulate 16 argon atoms with a lennard - jones potential .",
    "the final structure is close - packed and corresponds to a stacking of close - packed planes that is neither fcc nor hcp . during part of the simulation",
    "the temperature is well above melting , so the memory of the initial configuration is lost .",
    "the evolution of the potential contribution to the enthalpy is shown in fig .",
    "[ fig_iso ] . in the inset of that figure that magnifies the minimization part of the simulation",
    ", one can see that we obtain the enthalpy of lennard - jones argon at that pressure .",
    "the true minimal structure is not reached because the energy cost of the stacking faults is too small , so the procedure only finds a deep local minimum .    in principle",
    "the calculation of the energies , forces and stresses can be carried out within the metric formalism , and therefore one never needs to construct the lattice vectors , that is the matrix @xmath35 .",
    "our code for the lennard - jones interaction was written to test the present formalism and is fully implemented in the metric language .",
    "it never uses the matrix @xmath35 .",
    "our pseudopotential plane - wave code is based on sverre froyen s berkeley code , which stored atomic positions and @xmath48-vectors in lattice and reciprocal lattice coordinates respectively , that is in contravariant and covariant coordinates .",
    "in fact the stress was calculated by applying the chain rule @xmath154 , so it was easy to convert the program to the present formalism .",
    "the calculations involving the separable non - local pseudopotential projectors are easier to perform in cartesian coordinates , so for that specific case we construct from the metric @xmath31 a triangular @xmath35 and proceed in cartesian coordinates .",
    "the arbitrary choice of the orientation of @xmath35 has , of course , no effect in the results of the calculation .",
    "our plane - wave code also has a old , but convenient , symmetry recognition package that only works for the conventional orientation of the unit cell .",
    "if one wants to perform simulations with fixed symmetry , than one has to put `` by hand '' the desired orientation of @xmath35 before using the package . replacing those two parts of the code to avoid using the matrix @xmath35 is a straightforward , but tedious job , it is much easier to use the tested old subroutines and construct a matrix @xmath35 whenever it is needed .    [ conclusions ]",
    "we have shown that the metric is a very convenient dynamical variable to use in molecular dynamics simulations with variable cell - shape . as the cell part of the dynamics is fictitious",
    ", there is no unique choice of the kinetic energy . to be included in a lagrangian or hamiltonian formulation .",
    "the use of the tensorial notation in a metric formalism , with the requirement that the energy functions must be scalars , restrict our choice of those functions .",
    "the simplest expression for the cell kinetic energy has several properties that were not present in early expressions , namely absence of rigid rotations and invariance with respect to modular transformations . with a convenient choice of the densitary character of the kinetic energy ,",
    "the virial theorem is also satisfied for isoshape fluctuations . for anisotropic stress , the simplicity of eq .",
    "[ ucell3 ] contrasts with the definition of thermodynamic tension , ( eq . [ thermotension ] ) and its dependence on a reference cell .    from our kinetic and potential functions for the cell metric , we derived the equations of motion for variable cell shape molecular dynamics under the conditions of constant applied pressure and anisotropic applied thermodynamic stress .",
    "we also showed that the optimization of structures under both conditions can be naturally expressed in the metric language .",
    "simulations of silicon with first - principles forces and argon with empirical lennard - jones forces were used to illustrate the applications of our equations of motion and minimization procedures to the study of systems under applied pressure or stress .",
    "this work was supported by praxis xxi grants 2/2.1/fis/467/94 , 2/2.1/fis/26/94 and bd5037/95 , and by the us department of energy grant no .",
    "defg02 - 91-er45439 .",
    "to prove that @xmath155 is non - negative , we have to show that @xmath156 is non - negative . using eq .",
    "[ metric2 ] and the usual properties of the trace , we find that    @xmath157,\\ ] ]    where @xmath158 .",
    "writing the rightmost @xmath159 as @xmath160 and using @xmath161 , we arrive at the desired result",
    ". it will be useful to derive this result in the hamiltonian formalism :    defining @xmath162 , where some @xmath35 compatible with @xmath31 was chosen , and defining    @xmath163    where @xmath164 , we can write the kinetic energy of the cell as    @xmath165    where @xmath166 is a new generalized momentum for the cell .",
    "the canonically conjugate coordinate is @xmath167 , as can be seen using the poisson brackets relations between canonically conjugate variables ( in this last expression , @xmath168 is viewed as a 9x9 matrix with indices @xmath169 and @xmath170 ) .",
    "the relation between the variables ( q , p ) and the variables @xmath171 is similar to the relation between @xmath172 and @xmath173 .    from eq .",
    "[ kcell2b ] , it is clear that @xmath155 is positive and contributes with 6 distinct quadratic terms to the energy , and so the equipartition theorem applies to the degrees of freedom of the cell when they are in contact with a heat bath .",
    "the stress is not a true tensor , but a tensorial density@xcite , thus transforming differently from tensors under a change of coordinates whose jacobian is not unity .",
    "the transformation of a tensorial density @xmath174 from cartesian to lattice coordinates is given by@xcite          where @xmath2 is the internal energy , @xmath177 is the velocity of the atom @xmath178 , and @xmath179 is the ( symmetrical ) lagrangian strain corresponding to a rotation - free infinitesimal homogeneous deformation given by @xmath180@xcite , from the state @xmath31 to the state @xmath181 . in order to convert to lattice coordinates , we use eq .",
    "[ tensord ] and apply the chain rule @xmath182 together with the relation @xmath183@xcite .",
    "the result is      where @xmath185 and @xmath49 are the kinetic and the potential energy of the atoms in the cell , respectively , and the factors of two arise from formally treating @xmath45 and @xmath186 as independent variables .",
    "the kinetic energy is given by the first term in the r.h.s .",
    "[ l1 ] or [ h1 ] . using these expressions",
    ", we find , with the help of the relation @xmath187 , that      and so it must be made clear whether it is the @xmath189 or the @xmath190 that are kept constant when taking the derivatives in eq .",
    "[ virial1 ] .",
    "it is easily seen that , in order to obtain the correct kinetic internal stress ( see eq .",
    "[ stresst ] ) when transforming eq .",
    "[ virial1 ] back to cartesian coordinates , the @xmath191 must be kept constant , and thus we conclude that        we note that , because @xmath193 is a scalar capacity@xcite , and @xmath194 is a tensorial density , the product @xmath195 that appears in eq . [ cell ] is a true tensor , and thus has the same densitary character as the pressure term in the same equation , @xmath111 .                                                                when the infinitesimal deformation is not rotation - free , @xmath196 can be written as @xmath197 , where @xmath198 describes a pure infinitesimal rotation and @xmath199 describes a rotation - free infinitesimal deformation ( @xmath200 and @xmath201 are respectively the symmetrized and anti - symmetrized @xmath202 ) .",
    "the relation between @xmath202 and the lagrangian strain @xmath90 is @xmath203 . for small deformations",
    ", @xmath90 is the symmetrical version of @xmath202 ."
  ],
  "abstract_text": [
    "<S> we propose a new variable cell - shape molecular dynamics algorithm where the dynamical variables associated with the cell are the six independent dot products between the vectors defining the cell instead of the nine cartesian components of those vectors . </S>",
    "<S> our choice of the metric tensor as the dynamical variable automatically eliminates the cell orientation from the dynamics . </S>",
    "<S> furthermore , choosing for the cell kinetic energy a simple scalar that is quadratic in the time derivatives of the metric tensor , makes the dynamics invariant with respect to the choice of the simulation cell edges . choosing the densitary character of that scalar allows us to have a dynamics that obeys the virial theorem . </S>",
    "<S> we derive the equations of motion for the two conditions of constant external pressure and constant thermodynamic tension . </S>",
    "<S> we also show that using the metric as variable is convenient for structural optimization under those two conditions . </S>",
    "<S> we use simulations for ar with lennard - jones parameters and for si with forces and stresses calculated from first - principles of density functional theory to illustrate the applications of the method .    </S>",
    "<S> [ intro ] </S>"
  ]
}