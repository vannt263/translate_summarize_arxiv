{
  "article_text": [
    "phylogenetic networks are a generalization of phylogenetic trees that are gaining growing acceptance by biologists due to their importance in representing reticulate evolution @xcite",
    ". certain types of networks , such as neighbornets  ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) and median networks  ( see e.g. * ? ? ?",
    "* ) are now commonly used in the literature .",
    "moreover , there has recently been much focus on developing ways to construct special classes of networks to explicitly model evolution  ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "even so , there are still several aspects of phylogenetic network theory that remain to be more fully explored .",
    "one such aspect is how to transform one network into another one by using a collection of specified network operations  ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* for some results in this direction ) which we consider in this paper .",
    "transformations of phylogenetic trees have been studied for several years , and have applications to tree search algorithms and comparing trees  ( cf .",
    "e.g. * ? ? ?",
    "* chapters 4 and 30 ) .",
    "probably the best known and simplest way to transform one phylogenetic tree into another is to use a _ nearest - neighbor interchange ( nni ) operation _ which we now recall . for a set @xmath0 of three or more species or taxa , a _",
    "phylogenetic tree ( on @xmath0 ) _ is a tree in which every vertex has degree 1 or 3 with leaf set @xmath0 .",
    "a pair of distinct trees differ by one nni operation if one tree can be obtained from the other by swapping two of the four subtrees adjacent with an interior edge ( figure  [ fig : nni ] ) .",
    "note that the nni operation is _ reversible _ , i.e. there is a unique nni operation ( or _ reverse _ operation ) that can be applied to get back to the original tree . a well - known result concerning the nni operation states that given any pair of phylogenetic trees @xmath1 on @xmath0 , it is possible to transform @xmath2 into @xmath3 by some sequence of nni operations @xcite .",
    "this implies that nni operations can be used to explore all possible phylogenetic trees on a set @xmath0 , a useful fact that underpins several algorithms for reconstructing phylogenetic trees .",
    "we now turn to the analogous problem for phylogenetic networks .",
    "more specifically , we shall consider the problem of transforming _ unrooted phylogenetic networks ( on x ) _ , or _",
    "networks _ , into one another .",
    "such networks are connected graphs in which every vertex has degree 1 or 3 and whose leaf set is @xmath0 @xcite , and they have been used to model genome fusion @xcite . in figure",
    "[ fig : nni : real ] , we present an example of such a network @xmath4 that was referred to as the `` ring of life '' in a study concerning the genome fusion origin of eukaryotes ( * ? ? ?",
    "* figure 1 ) . based on that network ,",
    "whose construction employed whole genomes spanning the diversity of life , the authors concluded that the eukaryotic nuclear genome has resulted from a fusion of a relative of a protobacterium ( @xmath5 ) and a relative of an archeal ecocyte ( e ) . note that if a network is a tree , then it is necessarily a phylogenetic tree on @xmath0 , and so networks generalize phylogenetic trees .",
    "properties of networks have been studied in @xcite , and they can be generated by software such as t - rex  ( cf . * ? ? ?",
    "* ) and splitstree  ( cf . * ? ?",
    "? * ; * ? ? ?",
    "in this paper , we show that it is possible to extend results concerning nni operations on phylogenetic trees in a natural way to networks , which we expect could lead to applications to network search algorithms and comparison of networks .",
    "our starting point is to extend nni operations to networks .",
    "this is based on the observation that the tree @xmath3 in figure  [ fig : nni ] can be obtained from @xmath2 by replacing the length 3 path @xmath6 highlighted in bold with the path @xmath7 whilst preserving all other edges .",
    "this definition immediately extends to give what we shall call an nni operation on networks .",
    "in particular , we start again with a path @xmath6 in a network @xmath8 on @xmath0 for which neither @xmath9 nor @xmath10 is an edge , and obtain a new network @xmath11 on @xmath0 by replacing this path with the path @xmath7 ( figure  [ fig : nni ] ) .",
    "note that @xmath11 has the same number of vertices as the original network , and that , just as with phylogenetic trees , the nni operation is reversible .",
    "in the first of our main results we show that , just as with phylogenetic trees , we can transform any network @xmath8 on @xmath0 to any other network @xmath11 on @xmath0 with the same number of vertices as @xmath8 by just using nni operations ( theorem  [ transform2 ] ) .",
    "we illustrate this in figure  [ fig : nni : real ] : here network @xmath4 is transformed into the network @xmath12  which can be considered as an alternative ring of life hypothesis  by applying a sequence of two nni operations .",
    "even so , it is not possible to explore all alternative ways to potentially represent the ring of life using only nni operations . to see this , note that we can not transform the tree @xmath2 in figure  [ fig : ring ] to the network @xmath4 in figure  [ fig : nni : real ] using only nni operations since , even though these networks are on the same leaf set , they have a different number of vertices and nni operations",
    "must preserve this number .    in our second main result ( theorem  [ transform1 ] )",
    "we show that we need only one additional operation and its reverse to be able to transform any network on @xmath0 into any other network on @xmath0 .",
    "we call these operations _ triangle operations _ or _ @xmath13 operations _ and picture them in figure  [ fig : twoops ] ; they involve either inserting or removing a triangle ( or , more technically , a length three cycle ) from a network .",
    "we illustrate this result in figure  [ fig : ring ] .",
    "the tree @xmath2 in this figure is one of the phylogenetic trees presented in ( * ? ? ?",
    "* figure 1 ) .",
    "it is one of the five most probable trees computed using the method of conditioned reconstruction .",
    "the ring of life network @xmath4 can be obtained from @xmath2 by applying one @xmath14  operation and two nni operations as illustrated in figure  [ fig : ring ] .",
    "we now summarize the rest of the paper . after presenting some preliminaries concerning graphs in the next section ,",
    "we show that it is possible to construct any network starting either from a tree or from a rather simple graph with just two vertices ( called a generator ) . in section  [ sec : transforming ] , we then present the two main results stated above , which we prove using some new connections between networks and the theory of so - called cubic graphs that we discovered as part of this work .",
    "using our results , in section  [ sec : space ] we also define a generalization of tree space , and see how this can be used to give some new metrics that can be used to compare networks .",
    "we conclude in section  [ sec : discussion ] with a brief discussion of future directions and open problems , including some potential consequences for network searching algorithms .",
    "we begin with some technical preliminaries concerning graphs , which give the underlying structure for phylogenetic networks .",
    "we assume throughout the paper that @xmath0 is a set of species or taxa with three or more elements .",
    "a _ multigraph _ @xmath15 is an ordered pair @xmath16 , with @xmath17 a set of vertices and @xmath18 a multiset of edges each being an unordered pair of elements in @xmath17 .",
    "note that we assume that multigraphs do not contain loops ( i.e. edges that connect vertices to themselves ) unless otherwise stated , but they may contain _ parallel edges _ ( i.e. edges with multiplicity greater than 1 ) . if @xmath15 contains no parallel edges we shall call it a _",
    "graph_. we also assume that all multigraphs are connected .",
    "for example , in figure  [ fig : ops](i ) we picture a connected multigraph with two vertices and three parallel edges .",
    "assume for the reminder of this section that @xmath15 is a multigraph .",
    "an edge whose removal disconnects @xmath15 is called a _ bridge _ of @xmath15 ; if @xmath15 contains no such edge , then @xmath15 is called _",
    "bridgeless_. a _ blob _ in @xmath15 is a maximal connected induced submultigraph of @xmath15 that does not contain a bridge .",
    "for example , the cycle in the network @xmath4 in figure  [ fig : nni : real ] is a blob and so is the subgraph of the network in figure  [ fig : generator : real](i ) with all labelled vertices and their adjacent edges removed .",
    "a triangle in @xmath15 is called _ isolated _ if it does not share an edge with any other triangle in @xmath15 , in which case the triangle is a blob of @xmath15 .",
    "we say that @xmath15 is _ level-@xmath19 _ , @xmath20 an integer , if a tree can be obtained from @xmath15 by removing at most @xmath19 edges from each blob of @xmath15 . in this case",
    ", each blob of @xmath15 is at most level-@xmath21 , @xmath22 .",
    "the proofs of our main results are closely related to some theorems in the theory of cubic graphs .",
    "we say that @xmath15 is _ cubic _ if every vertex in @xmath15 has degree three .",
    "note that a cubic multigraph necessarily has an even number of vertices .",
    "following @xcite , we call a multigraph @xmath15 a _ 1 - 3 graph _ if all vertices in @xmath15 have degree either 1 or 3 .",
    "these graphs naturally arise when studying phylogenetic trees as every vertex in such a tree has degree 1 or 3 .",
    "note that in a cubic or a 1 - 3 graph an isolated triangle can not share a vertex with any other triangle in that graph and any parallel edges must have multiplicity two except in the ( necessarily unique ) level-2 cubic graph .",
    "finally we introduce the concept a generator since , as we shall see later , they can be viewed as the building blocks of networks .",
    "generator _ is either ( i ) an element of @xmath0 , ( ii ) a loop with a single vertex , or ( iii ) a bridgeless , cubic multigraph .",
    "note that this is an unrooted equivalent for the definition of a generator for directed networks presented in @xcite . in case of ( i ) and",
    "( ii ) , they are the ( unique ) generator with level-0 and level-1 , respectively . also , for any integer @xmath23 , a generator is level-@xmath19 if and only if it has @xmath24 vertices .",
    "our first results concern the construction of networks by using simple operations .",
    "we shall first show that is it possible to construct any network starting from a phylogenetic tree using just nni and @xmath13  operations .",
    "this is a key step in proving that we can transform any network into any other using just nni and @xmath13  operations .",
    "note that the t - rex algorithm mentioned in the introduction  @xcite also builds networks from trees , but it does this somewhat differently by adding in new edges to a pre - computed tree that optimize some function .",
    "although somewhat technical , we include a proof for the first construction result since it nicely illustrates the type of considerations that are required to show that we can transform one network into another using only nni and @xmath13  operations . for an illustration of this theorem see figure  [ fig : ring ] ( which we consider in reverse ! ) .",
    "[ thm : construct ] suppose that @xmath8 is a graph such that @xmath0 is contained in its vertex set .",
    "then @xmath8 is a network on @xmath0 if and only if there is a phylogenetic tree @xmath2 on @xmath0 and a finite sequence of nni and @xmath25 operations that can be applied one after the other , starting with @xmath2 , to obtain @xmath8 .",
    "if @xmath2 is a phylogenetic tree on @xmath0 and @xmath8 is obtained from @xmath2 by a sequence of nni and @xmath26  operations , then it is straightforward to see that @xmath8 is a network on @xmath0 since applying each of these operations to a network results in a network .",
    "conversely , since each of the @xmath27 and nni operations preserve the leaf set of a network , it suffices to show that we can reduce any 1 - 3 graph to a binary tree by using a sequence of these two operations .    to prove this , we adapt the proof presented in @xcite for showing that every connected cubic graph different from a 4-clique ( i.e. , a graph with 4 vertices and all of the 6 possible edges ) can be reduced ( in terms of number of vertices ) using the rules p1 and p7 considered in that paper .",
    "suppose that @xmath8 is a 1 - 3 graph which is not a tree .",
    "let @xmath28 be a shortest cycle in @xmath8 .",
    "* case i : * @xmath28 is not a triangle .    in this case ( and as exemplified by performing the nni operation on network @xmath12 that reverses the one that transforms @xmath29 to @xmath12 in figure  [ fig : nni : real ] ) , we can reduce the number of vertices of @xmath28 by 1 , by applying an nni operation to a path @xmath6 where @xmath30 is not a vertex in @xmath28 ( and hence @xmath31 is not an edge in @xmath28 ) and @xmath32 and @xmath33 are two edges in @xmath28 .",
    "note that this is possible since @xmath9 and @xmath10 can not be edges in @xmath8 as this would contradict the minimality of @xmath28 .",
    "we can therefore repeat this application of the nni operation until we are in case ii .",
    "* case ii : * @xmath28 is a triangle .",
    "* case ii , 1 : * @xmath28 is isolated , and so we can apply the @xmath34 operation .",
    "* case ii , 2 : * @xmath28 has an edge in common with another triangle .",
    "let @xmath35 be the two ( necessarily distinct ) vertices in the two triangles that are not contained in the common edge .",
    "let @xmath36 and @xmath37 denote the vertices adjacent with that edge .",
    "note that @xmath38 is not an edge in @xmath8 since otherwise @xmath8 would be isomorphic to a 4-clique , which is not possible as @xmath15 has at least three degree 1 vertices ( since @xmath39 ) .",
    "we distinguish now between two cases : @xmath35 have a neighbor distinct from @xmath36 and @xmath37 in common , or not .",
    "* case ii , 2.1 : * let @xmath40 be the vertex which is a common neighbor of @xmath41 and @xmath42 .",
    "note that the vertex @xmath43 adjacent to @xmath44 that is not @xmath41 or @xmath42 must have degree 3 , otherwise @xmath8 would have only one vertex with degree 1 as it is a 1 - 3 graph which is impossible .",
    "we can now perform the operations in figure  [ fig : movedown1 ] ( just as in ( * ? ? ?",
    "* case ii/2.1 ) ) .",
    "* case ii , 2.2 : * let @xmath45 and @xmath46 be the vertices that are adjacent to @xmath41 and @xmath42 , respectively .",
    "then at least one of @xmath45 or @xmath46 must have degree 3 , otherwise @xmath8 would have only two vertices with degree 1 implying that @xmath0 has two elements which is impossible . without loss of generality , we many assume that the degree of @xmath46 is 3 . now , we can reduce @xmath8 as in figure  [ fig : movedown2 ] ( just as in ( * ? ? ?",
    "* case ii/2.2 ) ) .",
    "we now describe a second approach to constructing networks which is based on generators .",
    "although we do not require this result later on , it is of independent interest and it also illustrates how other operations could be potentially used for transforming networks .    before proceeding , as an illustration of the concept of generators , in figure  [ fig : generator : real](i ) we picture a network that was referred to as the `` rings of life '' in @xcite .",
    "the authors interpreted the bottom right ring as a central system that contains the root of life and connects the two other rings . as we can see this network has a more complicated internal structure than the ring of life network @xmath4 in figure  [ fig : nni : real ] .",
    "this structure is further revealed if we remove all the pendant labelled edges and suppress any remaining degree 2 vertices . in this case",
    "we obtain the level-3 generator which is pictured in the far right of figure  [ fig : generator : real ] .",
    "we now explain how level-@xmath19 generators , @xmath47 , can be constructed starting with the multigraph in figure  [ fig : ops](i ) using just the two simple operations in figure  [ fig : ops](ii ) which we call the _",
    "@xmath48 _ and _ @xmath49 operations _ , respectively .",
    "we illustrate the @xmath48 operation in figure  [ fig : generator : real](ii ) , where it is used to build the level-3 generator underlying the rings of life network pictured in figure  [ fig : generator : real](i ) . this could be useful in exhaustively exploring alternative network hypotheses such as the rings of life example in figure  [ fig : generator : real ] .",
    "note that the @xmath48 operation , which connects two edges by adding an additional edge , was introduced in 1891 by j.  de vries ( see , e.g. * ? ? ?",
    "* ) , and the @xmath49 operation , which is applied to one edge , was considered in ( * ? ? ?",
    "* figure 4 ) where it was called operation 3 .",
    "the following result implies that any level-@xmath19 generator , @xmath47 , can be constructed using just @xmath48 and @xmath49 operations .",
    "it can be regarded as an analogue of the approach given in ( * ? ? ?",
    "* section 2 ) for constructing generators for rooted networks .",
    "as we will not require this result later , we give its proof in appendix a.    [ thm : generators ] suppose that @xmath15 is a multigraph and @xmath23 .",
    "then @xmath15 is a level-@xmath19 generator if and only if @xmath15 can be constructed from the theta graph in figure  [ fig : ops](ii ) via performing a sequence of @xmath50 @xmath49 or @xmath48 operations .",
    "we remark that using this result it is in principle possible to explicitly construct ( and therefore directly count ) all level-@xmath19 generators .",
    "for example , it can be checked in this way that there is one level-1 generator , two level-3 generators , and six level-4 generators .",
    "however , this could probably be done more efficiently using the results in @xcite .",
    "we now briefly explain how generators can be used to construct networks ; full details are given in appendix b. the construction is based on the fact that if @xmath8 is a network and @xmath15 is a blob in @xmath8 , then @xmath15 is either a level-0 generator ( i.e.a vertex ) , or the graph obtained from @xmath15 by suppressing all degree 2 vertices is a level-@xmath19 generator , @xmath51 ( see lemma  [ lem : generator ] ) .",
    "it follows that we can build any network @xmath8 from the collection of generators corresponding to the blobs of @xmath8 by gluing together the generators one - by - one along new edges onto a growing network until we obtain @xmath8 .",
    "we illustrate this process in figure  [ fig : generator ] .",
    "we now turn our attention to the other main results of this paper . in the first result",
    "we see that somewhat surprisingly we can transform any network to any other network with the same number of vertices using only nni operations . for an illustration of this result ,",
    "see figure  [ fig : nni : real ] .",
    "[ transform2 ] suppose that @xmath52 are two networks on @xmath0 with the same number of vertices",
    ". then @xmath8 can be transformed into @xmath11 by a finite sequence of nni operations .",
    "suppose that @xmath52 are networks on @xmath0 .",
    "we put @xmath53 if , starting with @xmath8 , there is a sequence of nni operations ( possibly of length 0 ) that can be applied to obtain @xmath11 . note that @xmath54 is an equivalence relation on the set @xmath55 of all networks on @xmath0 .    now , suppose @xmath52 are networks on @xmath0 with vertex sets @xmath56 and @xmath57 , respectively , such that with @xmath58 .",
    "the proof that @xmath53 must hold is almost identical to that in ( * ? ? ?",
    "* theorem ii ) .",
    "however , we shall present a sketch proof for the sake of completeness .    as in the proof of (",
    "* theorem ii ) we use three observations which can be proven in essentially the same way as the analogous results for cubic graphs as indicated in brackets .",
    "* observation 1 ( cf . * ? ? ?",
    "* lemma  4.2 ) : * if @xmath8 is a network on @xmath0 that is not a phylogenetic tree , then @xmath53 for @xmath11 a network on @xmath0 which contains an isolated triangle .",
    "it is straightforward to check that observation  1 holds by employing an argument similar to that used in the proof of theorem  [ thm : construct ] case i ( note that as in that theorem we require @xmath39 for this to hold ) .",
    "the argument presented in @xcite is similar but no reference is given to @xcite .",
    "* observation 2 ( cf . * ? ? ?",
    "* lemma  4.3 ) : * if @xmath8 is a network on @xmath0 , and @xmath59 , then @xmath60 , for the networks @xmath61 and @xmath62 obtained from @xmath8 by performing a @xmath26  operation at @xmath41 and @xmath42 , respectively .    to see that observation 2 holds , it suffices to assume that @xmath41 is adjacent to @xmath42 ; in this situation the operation indicated in figure  [ fig : obs2 ] ( adapted from * ? ? ?",
    "* figure 12 ) can be applied to see that @xmath60 holds .",
    "* observation 3 ( cf . * ? ? ?",
    "* lemma  4.4 ) : * suppose that @xmath63 is a network on @xmath0 with an isolated triangle , and @xmath8 is obtained by performing a @xmath64  operation on the vertices of this triangle . if @xmath11 is obtained by performing one nni operation on @xmath8 , then there is a network @xmath65 on @xmath0 with @xmath66 , such that @xmath11 can be obtained by performing a @xmath64  operation on @xmath65 .    to see that observation 3 holds ,",
    "assume that the nni operation performed on @xmath8 to obtain @xmath11 is on the path @xmath6 , and that @xmath67 is the vertex in @xmath8 obtained by applying the @xmath34 operation to the vertices of an isolated triangle in @xmath63 .",
    "it is straightforward to see that observation 3 holds in case @xmath68 . in case",
    "@xmath69 ( or @xmath70 ) the way to obtain the network @xmath65 is indicated in figure  [ fig : obs3 ] ( adapted from * ? ? ?",
    "* figure 14 ) .    using these three observations",
    "we now prove that @xmath53 , using induction on @xmath71 .",
    "we shall use the fact that if @xmath8 is a network on @xmath0 , then @xmath72 , with equality holding if and only if @xmath8 is a phylogenetic tree on @xmath0 .",
    "first note that if @xmath73 , then both @xmath8 and @xmath11 are trees , and so @xmath53 @xcite .",
    "so , suppose that @xmath74 holds for all networks @xmath63 and @xmath65 on @xmath0 with @xmath75 holding for some @xmath76 .",
    "assume that @xmath52 are two networks on @xmath0 such that @xmath77 .    by observation  1",
    ", we can assume that @xmath52 have isolated triangles @xmath78 and @xmath79 , respectively .",
    "let @xmath80 be the networks obtained by performing an @xmath34  operation on @xmath8 and @xmath11 on the vertices of the triangles @xmath78 and @xmath79 , respectively .",
    "by induction , there exists a sequence @xmath81 with network @xmath82 obtained from @xmath83 by an nni operation , @xmath84 .",
    "now , by observation  3 , it follows that there is a sequence @xmath85 so that @xmath86 , @xmath87 has an isolated triangle @xmath88 with @xmath89 , @xmath90 , and @xmath83 is the network obtained by performing an @xmath34  operation on the vertices of the triangle @xmath88 in @xmath87 .",
    "in particular , @xmath91 and the @xmath34  operation applied to the vertices of the triangle @xmath92 in @xmath93 gives the network @xmath94 .",
    "but then there must exist vertices @xmath35 in @xmath95 so that the networks @xmath93 and @xmath11 can be obtained from @xmath96 by performing a @xmath26  operation at @xmath41 and @xmath42 , respectively . by observation  2 ,",
    "@xmath53 follows , as required .    using the last theorem we can now prove our second main result , namely that we can transform any network on @xmath0 to any other network on @xmath0 by just using nni and @xmath13  operations .",
    "[ transform1 ] suppose that @xmath8 and @xmath11 are networks on @xmath0 .",
    "then , starting with @xmath8 , there exists a finite sequence of nni and @xmath97 operations that can be applied to obtain @xmath11 .    by theorem  [ thm :",
    "construct ] , there are phylogenetic trees @xmath98 on @xmath0 that can be obtained from networks @xmath52 on @xmath0 , respectively , by applying a sequence of nni and @xmath13  operations",
    ". therefore the theorem follows from the fact that there is a sequence of nni operations that can be applied , starting with @xmath2 , to obtain @xmath3 , as shown in @xcite .",
    "for phylogenetic trees , nni operations lead naturally to the concept of _ tree space _  ( see e.g. * ? ? ? * ) . in its simplest form , for @xmath0",
    "fixed , this space can be thought of as the set of all phylogenetic trees on @xmath0 with two trees being neighbors if and only if they differ by one nni operation . in other words ,",
    "tree space is a graph with vertices being the phylogenetic trees on @xmath0 and edges corresponding to pairs of such trees which differ by one nni operation . as a consequence of the fact that any phylogenetic tree on @xmath0 can be transformed into any other by a sequence of nni operations",
    ", it follows that this graph is connected .",
    "this is important for optimization algorithms that search tree space using nni operations since it implies that , in principle , every tree could be visited .    using the operations introduced in this paper",
    ", we can define network space in a similar manner . indeed",
    ", we can consider a graph with vertices consisting of all networks on @xmath0 and edges corresponding to pairs of networks which differ by either one nni operation or one @xmath13  operation .",
    "note that this space is well defined since nni and @xmath13  operations are both reversible .",
    "we illustrate part of this network space for @xmath99 in figure  [ fig : space ] .",
    "by theorem  [ transform1 ] it follows that network space is connected , just as with tree space .",
    "in fact , tree space is actually a subgraph of network space , as it consists of all of the level-0 networks ( i.e. phylogenetic trees ) and the nni operation is just the usual nni operation for trees .",
    "moreover , theorem  [ transform2 ] shows that network space has some additional structure since , for any non - negative integer @xmath100 , the set @xmath101 of all networks on @xmath0 with @xmath102 vertices forms a `` tier '' in the space in the sense that any pair of networks in that tier can be joined by edges corresponding only to nni operations ( figure  [ fig : space ] ) .",
    "moreover , two tiers @xmath101 and @xmath103 are adjacent if and only if @xmath104 , that is , the difference between the number of vertices for the networks in tier @xmath101 and that in tier @xmath103 is exactly two . in particular , there exists a network @xmath8 in @xmath101 and a network @xmath11 in @xmath103 such that @xmath8 and @xmath11 differ by precisely one @xmath13  operation .",
    "note that partitioning network space into tiers is not equivalent to dividing up the set of networks according to their level .",
    "this alternative way to partition rooted networks has been considered in @xcite and also in @xcite where an alternative space of level-1 networks is defined .",
    "tree spaces have been extensively studied in the literature , and they have various important properties , many of which have direct bearing on the development and performance of tree search algorithms . as an example of this , tree space naturally gives rise to the well - known nni metric on trees which is the shortest path between any pair of trees in tree space , or equivalently , the least number of nni operations required to transform one tree into another  ( cf . * ? ? ?",
    "* and the references therein ) . as a consequence of our results we can define new metrics on the set @xmath55 of all networks on @xmath0 which arise from network space in a similar way .",
    "more specifically , for @xmath105 we define the distance @xmath106 between @xmath8 and @xmath11 to be the minimal number of nni operations required to transform @xmath8 into @xmath11 , and for @xmath107 we let the distance @xmath108 between @xmath8 and @xmath11 be the minimal number of @xmath97 and nni operations needed to transform @xmath8 into @xmath11 . by theorems  [ transform2 ] and  [ transform1 ]",
    "we immediately obtain the following result .",
    "[ metrics ] the distance @xmath109 is a metric on the set @xmath55 . in addition , for any non - negative integer @xmath100 , the distance @xmath110 is a metric on the set @xmath101",
    ".    it would be interesting to better understand properties of these metrics such as ways to compute or find bounds on the size of the distance between any pair of networks .",
    "note that the nni distance between a pair of phylogenetic trees is np - hard to compute in general @xcite , and so as tree space is contained in network space it is unlikely that there will be a polynomial time algorithm to compute the metric @xmath109 in general .",
    "however , understanding properties of @xmath109 could yield clues as to how search algorithms on networks may work , as illustrated by the recent work on ricci - ollivier curvature of tree space based on the _ subtree prune and regraft ( spr ) _ operation @xcite .",
    "in this paper we have shown that it is possible to transform any network into any other network through using a sequence of two elementary operations , one of which is a generalized version of the nni operation on trees .",
    "this allows us to consider spaces of networks which generalize spaces of trees , and which could serve as search spaces for network construction algorithms .",
    "the nni and @xmath13  operations are well - known in the theory of cubic graphs , where the nni operation has been called a _ whitehead move _",
    "@xcite or a _ slide transformation _ @xcite , and the @xmath13  operation is known as the _ @xmath111 rule _ @xcite and _ @xmath13-reduction _ @xcite .",
    "we believe that links between the theories of networks and cubic graphs could be potentially of great interest since by using theoretical tools for cubic graphs and associated structures , it should be possible to obtain new approaches to understand and construct phylogenetic networks . for example , spaces of cubic graphs appear in algebraic geometry @xcite and techniques from that area have proven useful in phylogenetics ( e.g. in understanding phylogenetic invariants  @xcite ) . as another illustration of these possibilities , we note that properties of cubic graphs were recently used by @xcite to help count rooted phylogenetic networks .",
    "although we have focused on unrooted networks ( in which each vertex has degree 1 or 3 ) , our results serve to illustrate the possibilities for developing similar results for spaces of more complicated networks . for example , it would be very interesting to see how our results could be extended to rooted networks .",
    "some results in this direction are presented in @xcite .",
    "our previous work on spaces of level-1 rooted networks  @xcite suggests that this will probably be somewhat more technical .",
    "however , as algorithms are now being developed for performing likelihood and bayesian searches on rooted networks @xcite , it seems to be well worth while trying to understand general properties of rooted network spaces .    in light of our results , it is also of interest to consider how network optimization searches could be performed based on a combination of either fixing network size ( e.g. for unrooted networks using only nni operations ) and/or level ( cf .",
    "@xcite for a search strategy on rooted networks which fixes level using non - local operations ) . in regards to this",
    ", we could also consider other types of operations such as generalizations of the spr and _ tree bisection and reconnection ( tbr ) _ operations on trees @xcite .",
    "note that , in contrast to nni operations , these generalizations will not necessarily be local , and that there are other operations already defined for cubic graphs  ( cf .",
    "e.g. * ? ? ?",
    "* ) which could also yield interesting network operations .",
    "of course , there are pros and cons in deciding which operations to consider . for example , for tree space , nni neighborhoods are smaller than spr or tbr neighborhoods  ( cf .",
    "e.g. * ? ? ?",
    "* ) which , in practical terms , means that searches based on the latter operations can be more computationally expensive . however , spr and tbr operations can potentially yield algorithms that are less likely to become trapped in local optima .",
    "thus it would be interesting to better understand neighborhoods in network spaces , and to use their structure to develop new search algorithms .",
    "another technical issue in this respect is that network spaces are in general infinite , as it is always possible to increase the level of any network by adding in vertices and edges ( e.g. using the @xmath13  operation ) .",
    "hence it could be useful to develop ways to determine bounds for the level of _ any _ network for any given data set ( maybe using concepts such as the bayesian information criterion ( bic )  @xcite ) , and then only search spaces of networks with bounded level for that data set .",
    "this would at least give a finite search space , such as the space of level-1 networks that we defined in @xcite .",
    "suppose that @xmath15 is a multigraph and that @xmath23 .",
    "if , starting with the theta graph , @xmath15 is constructed via a sequence of @xmath50 @xmath49 or @xmath48 operations then it is straightforward to see that @xmath15 is a level-@xmath19 generator .",
    "conversely , suppose that @xmath15 is a level-@xmath19 generator .",
    "we proceed by using induction on the level of @xmath15 .",
    "if @xmath112 , then @xmath15 is the theta graph , and so the base case clearly holds .",
    "so , suppose that any level-@xmath21 generator , @xmath113 , can be constructed using @xmath114 @xmath48 or @xmath49 operations .",
    "if @xmath15 contains a parallel edge connecting two distinct vertices @xmath41 and @xmath42 , say , then it must contain the subgraph pictured in figure  [ fig : configs](i ) .",
    "but then by performing a reverse @xmath49 operation on this pair of parallel edges ( i.e. , deleting one of the two parallel edges and suppressing the resulting degree two vertices ) we obtain a bridgeless , cubic multigraph @xmath115 ( as @xmath15 is a level-@xmath19 generator for some @xmath116 , and hence a bridgeless , cubic multigraph ) .",
    "note that this operation decreases the level of @xmath15 by one and so , by induction , @xmath115 can be constructed using @xmath117 @xmath48 or @xmath49 operations . by induction",
    "the theorem therefore holds in this case .",
    "so , suppose @xmath15 does not contain any parallel edges , i.e. @xmath15 is a graph .",
    "then by the main theorem in ( * ? ? ?",
    "* part ( t8 ) ) , it follows that either ( a ) @xmath15 is a 4-clique , or ( b ) there is a bridgeless , cubic multigraph @xmath115 so that @xmath15 can be obtained from @xmath115 by performing either an @xmath48 operation or an operation of the form in figure  [ fig : configs](ii ) .",
    "if case ( a ) holds , then we can perform a single reverse @xmath48 operation on @xmath15 to obtain the theta graph , and the theorem is then easily seen to hold . in case ( b ) holds and @xmath15 can be obtained from @xmath115 by performing an @xmath48 operation , the theorem also follows by induction .",
    "so , suppose that ( b ) holds and that @xmath15 can be obtained from @xmath115 by using an operation as in figure  [ fig : configs](ii ) .",
    "but this operation is equivalent to first performing an @xmath49 operation and then an @xmath48 operation , starting with @xmath115 .",
    "since the graph @xmath118 obtained from @xmath115 by performing just the @xmath49 operation is clearly a bridgeless cubic multigraph with level @xmath117 , and @xmath15 is obtained by performing an @xmath48 operation on @xmath118 , this case again follows by induction .",
    "we show how generators can be used to construct networks .",
    "we begin with a simple observation ( see figure  [ fig : generator ] ) .",
    "[ lem : generator ] suppose that @xmath8 is a network and @xmath15 is a blob in @xmath8 .",
    "then @xmath15 is either a level-0 generator , or the graph obtained from @xmath15 by suppressing all degree 2 vertices ( one - by - one until this is no longer possible ) is a level-@xmath19 generator , @xmath51 .",
    "suppose that @xmath15 is a blob in @xmath8 and that @xmath15 is not a level-0 generator ( i.e. a vertex ) .",
    "then , as @xmath15 is a blob , every vertex in @xmath15 must have degree 2 or 3 .",
    "if every vertex in @xmath15 has degree 2 , then @xmath15 must be a cycle .",
    "therefore if we suppress all but one degree 2 vertex of @xmath15 we obtain a loop with a single vertex , i.e. the level-1 generator .",
    "if @xmath15 contains some vertex with degree 3 , then the multigraph @xmath115 obtained by suppressing all vertices in @xmath15 of degree 2 must be a bridgeless cubic multigraph ( since @xmath15 has no bridges ) , i.e. @xmath115 is a level-@xmath19 generator , for some @xmath47 .    in light of lemma",
    "[ lem : generator ] it follows that we can construct any network @xmath8 from some collection of generators . to see this ,",
    "let @xmath119 be the collection of generators ( one for each blob in @xmath8 ) which is obtained by subjecting each blob in @xmath8 to the vertex suppression process described in the statement of that lemma , if necessary .",
    "then it is straightforward to check that to construct @xmath8 from @xmath119 , we can start with some generator in @xmath119 and then continue to graft generators @xmath15 in @xmath119 that have not been previously selected onto a growing multigraph @xmath63 ( which possibly contains loops ) until we obtain @xmath8 by applying one of the following operations .",
    "( a ) if @xmath63 is the level-0 generator @xmath41 or the level-1 generator with vertex @xmath41 , then to attach a new generator @xmath15 to @xmath63 add in the edge @xmath38 , where @xmath42 is the unique vertex in @xmath15 if @xmath15 is level-0 or level-1 , or @xmath42 is a new vertex which is added to @xmath15 so as to subdivide some edge in @xmath15 .",
    "( b ) if @xmath63 is neither the level-0 nor the level-1 generator , then subdivide some edge in @xmath63 by adding in a new vertex @xmath41 , and then , to attach a new generator @xmath15 , add in the edge @xmath38 where @xmath42 is as in ( a ) .",
    "note that this process can be regarded as an unrooted analogue of theorem 3.1 in @xcite which describes a similar way to construct directed phylogenetic networks from rooted generators .",
    "we thank simone linz for interesting discussions on spaces of phylogenetic networks , and lars jermiin and his colleagues for helpful comments on an earlier version of this manuscript .",
    "we also thank the institute for mathematical sciences , singapore , for inviting us to a workshop in july 2015 , where some of the topics presented in this paper were discussed ."
  ],
  "abstract_text": [
    "<S> phylogenetic networks are a generalization of phylogenetic trees that are used to represent reticulate evolution . </S>",
    "<S> unrooted phylogenetic networks form a special class of such networks , which naturally generalize unrooted phylogenetic trees . in this paper </S>",
    "<S> we define two operations on unrooted phylogenetic networks , one of which is a generalization of the well - known nearest - neighbor interchange ( nni ) operation on phylogenetic trees . </S>",
    "<S> we show that any unrooted phylogenetic network can be transformed into any other such network using only these operations . </S>",
    "<S> this generalizes the well - known fact that any phylogenetic tree can be transformed into any other such tree using only nni operations . </S>",
    "<S> it also allows us to define a generalization of tree space and to define some new metrics on unrooted phylogenetic networks . to prove our main results , we employ some fascinating new connections between phylogenetic networks and cubic graphs that we have recently discovered . </S>",
    "<S> our results should be useful in developing new strategies to search for optimal phylogenetic networks , a topic that has recently generated some interest in the literature , as well as for providing new ways to compare networks .    </S>",
    "<S> phylogenetic network , local transformation , network space , nni operation , network metric </S>"
  ]
}