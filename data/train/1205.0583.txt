{
  "article_text": [
    "the presence of a pore or a pit in a surface can affect nucleation in a profound way  @xcite .",
    "page and sear  @xcite used the 2d ising model to demonstrate that nucleation of a new phase can be much faster in a pore than on a flat surface of the same material , because nucleation can start at energetically - preferred binding sites in a pore corner .",
    "further , for given thermodynamic conditions , they showed that there exists a pore width that maximizes nucleation rate .",
    "the existence of this maximum follows immediately from the fact that as one makes a 2d pore wider , the rate for nucleation _ into _ the pore is reduced , while the rate for nucleation _ out of _ the pore ( into solution ) is enhanced .",
    "here we show that similar arguments in three dimensions suggest simple strategies for patterning a surface in order to best speed nucleation from solution .",
    "in making this claim , we present an analysis of nucleation in the ising model that complements several previous studies .",
    "we calculate rates and free energy profiles for nucleation in the 2d ising model in the bulk , at flat surfaces , and in the presence of rectangular pores , and in the 3d ising model in the presence of cuboidal pores .",
    "we first calibrate our free energy sampling procedure by following ref .",
    "@xcite and comparing free energy profiles for bulk nucleation in the 2d ising model with the predictions of classical nucleation theory ( cnt ) modified to accommodate nucleus shape fluctuations .",
    "as did ref .",
    "@xcite , we find excellent agreement between theory and simulation over a wide range of conditions .",
    "we next show that a flat surface can enhance nucleation , provided that this surface exerts a sufficiently large attraction ( explicit or effective ) for the nucleating phase .",
    "otherwise , nucleation happens in the bulk .",
    "while intuitively reasonable , and described qualitatively by cnt , we argue that the need for such an attraction is obscured in the spin - spin representation of the ising model , and is made clear only in the lattice gas ( particle - vacancy ) one .",
    "we then revisit the study of ref .",
    "@xcite by calculating free energy profiles for pore nucleation in the 2d ising model .",
    "these profiles support and complement the nucleation rates presented in that work , showing the existence of a pore size optimum for speeding nucleation from solution .",
    "we end with our main results , rates and free energy landscapes for nucleation in the 3d ising model in the presence of a cuboidal pore .",
    "we find that nucleation profiles display single or double barriers , depending on pore size and aspect ratio .",
    "pores of well - chosen aspect ratio can dramatically speed nucleation relative to a planar surface made of the same material , while badly - chosen pores provide no such enhancement .",
    "for a given pore , the minimum barrier to nucleation is achieved when one of its two horizontal dimensions attains a critical length , largely irrespective of the other dimension , provided that the latter is large enough .",
    "this observation implies that patterning a surface in a raster - like fashion is a better strategy for speeding nucleation than e.g. scoring long grooves in it .",
    "we note at the outset that there are important limitations to our study in terms of its relevance to real systems .",
    "we have chosen to work with the ising model , a prototypical description of phase change and nucleation  @xcite , because it captures important effects of fluctuations and geometry crucial to many physical processes .",
    "insights derived from it are often transferrable to many different physical systems  @xcite .",
    "in particular , the result that there exists a pore size and shape in three dimensions that minimizes free energy barriers to nucleation follows immediately from geometrical considerations , in much the same way as the result that in two- and three - dimensional bulk space there exists a free energy barrier to nucleation .",
    "we expect therefore that this result should be relevant to three - dimensional systems generally",
    ". however , we do not represent important physical processes that may , in real systems , act to mask the existence of such an optimum . by representing the nucleating phase as a",
    "lattice - based , structureless one , we can not capture potentially important effects like the mismatch in registry between a crystal and its template  @xcite .",
    "furthermore , our simulation protocol ( grand - canonical monte carlo ) is an efficient way of mapping free energy profiles , but ignores effects of mass transport and particle correlations that may be crucially important near real pores and surfaces . with these caveats in mind",
    ", we proceed to our study .",
    "we consider homogeneous and heterogeneous nucleation in the 2- and 3-dimensional ising model on a square or cubic lattice . because we have in mind the nucleation of particles from solution",
    ", we find it convenient to work in the lattice gas ( particle - vacancy ) representation .",
    "regardless of dimension , the energy function of our system is @xmath0 here @xmath1 if site @xmath2 is vacant , and @xmath3 if site @xmath2 is occupied by a particle .",
    "the first two terms are the usual bulk ones : @xmath4 is the strength of the nearest - neighbor coupling , and @xmath5 is a chemical potential that can be tuned to favor particles or vacancies .",
    "the first sum runs over all distinct nearest - neighbor bulk bonds , and the second sum runs over all bulk sites .",
    "the third term describes interactions between particles and walls : this sum runs over all bonds connecting wall sites to bulk sites .",
    "wall sites are considered to be particles , i.e. @xmath6 . our simulations were done in the lattice gas representation , but we will use regular ising ( spin - spin ) variables where convenient . for reference : via the usual mapping , @xmath7 , where @xmath8 , the bulk lattice gas maps ( ignoring constant terms ) to the bulk ising model    @xmath9    where @xmath10 and @xmath11 . here",
    "@xmath12 is the coordination number of the @xmath13-dimensional square or cubic lattice .",
    "we carried out simulations using a standard grand canonical metropolis monte carlo ( mc ) procedure  @xcite .",
    "each trial move consisted of an attempted change of state of a randomly - chosen lattice site .",
    "trial moves resulting in an energy change @xmath14 were accepted with probability @xmath15 , where @xmath16 .",
    "to study homogeneous nucleation in 2d , we used a system of @xmath17 sites with periodic boundary conditions in both directions . to model a wall we use periodic boundaries in the horizontal direction only , and created a closed boundary along the top and bottom of the box by filling all sites in the first row of the lattice with particles .",
    "following the protocol of ref .",
    "@xcite , we also simulated rectangular pores in a system of @xmath18 sites .",
    "the depth of a pore was fixed at 30 sites and its width was allowed to vary .",
    "an analogous protocol was used in 3d simulations to generate cuboidal pores of fixed depth and a range of different length - to - width aspect ratios .    to calculate free energy landscapes for nucleation we used standard umbrella sampling  @xcite protocols , and for the calculation of nucleation rates we used forward flux sampling ( ffs ) @xcite .",
    "brief details of both methods are given in appendix  [ apx : umbrella_sampling ] .",
    "by way of calibration , it is instructive to compare nucleation free energy barriers calculated by umbrella sampling with the predictions of classical nucleation theory  @xcite ( cnt ) .",
    "@xcite showed that sampled free energy barriers in the 2d ising model are in excellent agreement with the predictions of the cnt - like expression @xmath19 here @xmath20 is the excess free energy of a droplet of @xmath21 ` up ' spins in a background of ` down ' spins .",
    "the first term of this expression is the conventional bulk reward for growth of a circular droplet .",
    "@xmath22 is the bulk free energy difference between the two bulk phases , equal to @xmath23 at low temperature . at higher temperature ( still below the critical one )",
    "the viable bulk phases are less dense than the all - up and all - down spin limits . here",
    "we expect @xmath24 to be a reasonable approximation , where @xmath25 is the magnetization difference between bulk phases . for the conditions considered in this section",
    ", these estimates differed by at most about @xmath26 ; we therefore set @xmath27 .",
    "the second term of   is the surface tension penalty for growth of a circular droplet .",
    "@xmath28 is the inter - phase surface tension . in 2d ,",
    "the ising model surface tension ( at @xmath29 ) in the direction of either lattice vector is known from the onsager solution  @xcite , and is @xmath30 because a non - square droplet can not be accommodated perfectly on a square lattice , it is also useful to consider the orientationally - averaged effective droplet surface tension @xmath31 derived by shneidman et al .",
    "@xcite : @xmath32 here @xmath33 and @xmath34 is the surface tension in the direction of the unit cell diagonal @xcite . in what follows",
    "we compare our simulations with the predictions of   using @xmath28 defined both by eqns .   and .",
    "the third term of   accounts for shape fluctuations of the droplet , and can be derived from field theoretic considerations of nucleation rates  @xcite .",
    "the shape fluctuation parameter @xmath35 in 2d  @xcite . one important contribution of ref .",
    "@xcite was to recognize that this term can be considered a contribution to the free energy of a droplet .",
    "without such a contribution , cnt and umbrella sampling are in quantitative disagreement .",
    "the final term of   accounts for the fact that the conventional cnt expression has no clear origin of free energy , because it does not resolve the monomer constituents of droplets .",
    "instead , one can fix the origin of free energy profiles in the 2d ising model by requiring that   returns the free energy of ( say ) clusters of size 1 .",
    "the latter quantity can be calculated exactly in the ising model , so fixing @xmath36  @xcite .",
    "in we compare free energy profiles computed from umbrella sampling simulations with  .",
    "panels ( a ) and ( c ) show droplet free energy profiles for various values of @xmath37 , for magnetic field strengths @xmath38 and @xmath39 .",
    "open circles denote the result of umbrella sampling simulations ; solid lines are obtained using with the shneidman et al .",
    "effective surface tension . as per ref .",
    "@xcite , the theoretical prediction fits the simulation data well across the range of conditions studied .",
    "panels ( b ) and ( d ) compare free energy barriers obtained from simulation and theory in the plots directly above them . here",
    "the dotted lines indicate the barrier height predictions of the uncorrected cnt expression ,   with @xmath40 . in all cases",
    "the uncorrected theoretical prediction underestimates the barrier height .",
    "upward pointing triangles show the barrier height prediction of   using the onsager solution for the surface tension .",
    "agreement between it and simulation is good at high temperature , but not at low temperature , where droplets are anisotropic .",
    "also shown are averaged droplet profiles for critical nuclei at the extreme values of @xmath37 at each value of @xmath41 .",
    "these were obtained by averaging over all configurations for which @xmath42 during umbrella sampling .",
    "snapshots are scaled relative to the size of the largest cluster shown ( which occurs when @xmath43 and @xmath39 ) .",
    "droplets are noticeably non - circular at low temperatures .    .",
    "nucleation in the absence of a particle - wall attraction is as in the bulk : curves for @xmath44 , 0.2 and 0.4 coincide with the bulk curve ( dashed red line ) .",
    "the nucleation barrier and critical nucleus are reduced for large enough particle - wall attraction .",
    "the arrow marks the lattice gas particle - wall attraction @xmath45 that is equivalent to the ising model representation in the presence of an inert wall ( @xmath46 ; see main text for discussion ) .",
    "snapshots above are representative of critical nuclei at the particle - wall interactions specified . ]      with confidence in our sampling protocol ( appendix  [ apx : umbrella_sampling ] ) established , we next turn to the question of how a planar surface affects nucleation .",
    "shows free energy barriers to nucleation for the 2d lattice gas ( ) in the presence of a flat wall , for a range of particle - wall interaction strengths @xmath47 .",
    "we set @xmath48 ( equivalent to @xmath49 in the ising model representation ) and @xmath50 .",
    "under these conditions the particle ( up spin ) phase is thermodynamically preferred to the initial vacancy ( down spin ) phase . in the absence of a particle - wall attraction ,",
    "particles are effectively repelled by the wall , for reasons of entropy ( sites available in the bulk exceed those available near the wall ) and geometry ( the nucleus shape that minimizes the surface - to - area ratio in two dimensions , a circle , can form only in the bulk ) . for particle - wall attractions",
    "not strong enough to overcome the entropic penalty of wall confinement , nuclei again grow in the bulk of the simulation box .",
    "( sampling was initialized using wall - hugging droplets generated using large @xmath51 ; when bulk nucleation was preferred , droplets moved away from the wall ) . for sufficiently large attractions nuclei",
    "_ do _ grow at the wall , and the free energy barrier to nucleation and the size of the critical nucleus are smaller than their bulk counterparts .",
    "a substantial particle - wall attraction is needed to counter the favorable entropy associated with bulk nucleation : in other words , a surface will enhance nucleation only if it possesses a sufficiently strong attraction for the nucleating phase .    while this observation is intuitively reasonable",
    ", we note that it is much more apparent in the lattice gas representation than the ising one .",
    "the authors of refs .",
    "@xcite studied nucleation using the ising hamiltonian augmented by a bulk - wall interaction @xmath52 , for the particular case @xmath53 ( i.e. an energetically inert wall ) .",
    "although @xmath54 means that the wall has no energetic preference for either phase , the _ repulsion _ between unlike spins in the bulk leads to an effective attraction between the nucleating phase ( in those papers the up - spin phase ) and the wall   in energy .",
    "by contrast , if a bulk up phase lies in contact with an inert wall , flipping down a spin in contact with the wall costs a greater amount , @xmath55 : the wall stabilizes , energetically , the phase that wets it . in the lattice gas representation , by contrast , an energetically inert wall favors the vacancy phase over the particle phase .",
    "a particle - wall attraction of strength one - half of the particle - particle bulk coupling is required to restore the symmetry intrinsic to the ising model . ] .",
    "carrying through the ising - lattice gas transformation , it can be shown that an ising model in contact with an energetically inert wall @xmath56 is equivalent to a lattice gas in contact with a wall that possesses a substantial interaction for particles , i.e. with @xmath57 @xcite .",
    "this limit is marked by an arrow in . in both cases",
    ", one must engineer a substantial attraction between the nucleating phase and a wall before nucleation happens at the wall in preference to in bulk ( a result confirmed by simple scaling arguments : see appendix  [ sec : plane ] ) . in the lattice gas representation",
    "the coupling @xmath51 might be regarded as a literal wall - particle attraction ; in ising language , the attraction between up spins and the wall can be regarded as an effective one , mediated by ` solvent ' ( the down - spin phase ) .",
    "if a surface is sufficiently attractive , then , it can render nucleation faster than in the bulk .",
    "nucleation in a pore made out of that surface can be faster still , because pore corners provide a convenient initiation site for the new thermodynamic phase  @xcite .",
    "further , for given thermodynamic conditions , ref .",
    "@xcite demonstrated that there exists a pore size that maximizes nucleation rate .",
    "the existence of this maximum follows from the fact that as one makes a pore bigger , the rate for nucleation _ into _ the pore is reduced , while the rate for nucleation _ out of _ the pore ( into solution ) is enhanced . in  ( a )",
    "we show free energy profiles for nucleation in a 2d pore .",
    "these profiles complement the nucleation rate calculations of ref .",
    "@xcite , confirming the existence of a double barrier to pore - mediated nucleation into solution .",
    "under our umbrella sampling protocol , nucleation first occurs within the pore ( starting in one of the corners due to the greater number of favorable energetic contacts there ) , and is followed by nucleation from a filled pore into the bulk . as highlighted in the boxed region ,",
    "free energy profiles for narrow pores show local metastable minima during the post - critical filling of a pore .",
    "each minimum corresponds to a filled row of the pore .        as described in ref .",
    "@xcite , the barrier to nucleation within the pore increases with increasing pore width , while the barrier to nucleation out into solution shows the opposite trend ( see panel ( b ) ) .",
    "it should be noted that the pore width that maximizes nucleation _ rate _ can not be determined directly from the intersection of the two curves : one must compute droplet nucleation rates explicitly .",
    "the inset shows the two nucleation rates , @xmath58 , in units of monte carlo steps per bulk lattice site , computed using forward flux sampling  @xcite . in agreement with the results of ref .",
    "@xcite we find that the overall nucleation rate ( the reciprocal of the sum of the ` in ' and ` out ' pore nucleation timescales ) is largest for a pore approximately 12 sites wide .    a simple cnt - like approximation confirms that , given a sufficiently strong particle - wall attraction , there must exist a pore size that maximizes nucleation rate ( this argument is that of ref .",
    "@xcite , modified to account for variable particle - wall surface tension ) . approximating the in - pore nucleus as a quarter - circle droplet of radius @xmath59 growing from the corner of a pore of width @xmath60 ( see ( a ) ) suggests a free energy cost for the nucleus of @xmath61 (",
    "here @xmath62 is the droplet - wall surface tension ) . assuming that the pore is narrow ( so that the function @xmath63 does not reach its turning point for @xmath64 ) then the barrier to nucleation goes as @xmath65 , which _ increases _ ( sub - linearly ) with pore width @xmath60 .",
    "for nucleation out of a filled pore ( ( b ) ) , by a semi - circular droplet radius @xmath59 , the free energy profile can be approximated as @xmath66 , which gives a pore width - dependent nucleation barrier of @xmath67 .",
    "_ decreases _ linearly with @xmath60 ( note that the ` out ' barriers seen in fig .",
    "[ fig : ising_pore ] are indeed approximately linear in @xmath60 ) .",
    "an optimum pore width arises naturally from the competition between these two processes .",
    "we stress , however , that the degree of attenuation of the nucleation barrier due to the pore depends on the particle - pore attraction , and can range from nothing at all ( for small @xmath51 ) , to total ( for large @xmath51 ) .",
    "the analysis of ref .",
    "@xcite can be straightforwardly extended to treat cuboidal pores .",
    "we studied heterogeneous nucleation in a three - dimensional lattice gas of @xmath68 sites , for @xmath69 , in the presence of a cuboidal pore of dimensions @xmath70 embedded in a surface .",
    "both the pore and the surface possessed stickiness parameter @xmath71 . for a fixed pore depth of @xmath72 sites we computed nucleation free energy profiles .",
    "demonstrates that , in general , there exists a barrier to filling a pore ( @xmath73 , ( a ) ) , and for growing a droplet from a filled pore into solution ( @xmath74 , ( b ) ) .",
    "for very large pores , however , droplets can attain criticality in the pore , and no barrier to growing into solution exists .",
    "very small pores , by contrast , can not be filled without substantial free energy cost , and offer no enhancement of nucleation relative to a planar surface .",
    "when such pores are present , nuclei grow on the surrounding flat substrate ( made of the same material as the pore ) .",
    "\\(c ) shows a contour plot of the larger of the ` in ' and ` out ' barriers , @xmath75 , as a function of a pore s horizontal dimensions .",
    "all pores provide a significant attenuation of the free energy barrier to nucleation relative to bulk , because the pore and its surrounding surface is attractive ( here the bulk nucleation barrier is @xmath76 ) .",
    "however , @xmath77 varies dramatically with pore geometry .",
    "achieving maximum attenuation of the nucleation barrier requires making only one of the pore s horizontal dimensions the ` correct ' size , provided that the second is large enough .",
    "consequently , the region of optimal pore geometry forms a well - defined band on the contour plot . panels ( d)-(f ) show complementary contour plots of nucleation rates , computed using forward flux sampling .",
    "the band seen in panel ( c ) corresponds , to within a lattice site , to a ridge in panel ( f ) , along which the overall rate of nucleation is maximized .    a selection of cuts along the contour plots ( corresponding to varying either the size or shape of a pore )",
    "are shown in . as is evident from panels ( b ) and ( c ) , the nucleation barrier and rate are not strongly dependent on the larger of a pore s dimensions , as long as that dimension is large enough .",
    "this can be understood by noting that nucleation within a pore occurs at a corner ; as a droplet grows , it is stabilized energetically when it encounters the closer of the two other pore walls .",
    "provided that the distance to the further wall is large enough , that distance does not strongly affect the ability of the nucleus to grow out into solution .",
    "this observation suggests that it is preferable to pattern a surface by repeating in it copies of a well - chosen pore ( a small pore that effects a substantial reduction in nucleation free energy barrier , such as the @xmath78 pore ) , rather than e.g. etching long grooves in it .",
    "consider , as one possible choice , the best square pore ( @xmath79 ; see ( a ) ) .",
    "the larger of the in- and out barriers to nucleation for that pore is @xmath80 . for a substrate row of ( large )",
    "length @xmath81 , we therefore expect the nucleation timescale associated with repeated , closely - spaced copies of the square to be @xmath82 . by comparison ,",
    "the barrier to nucleation for a periodic groove of the same width , built by imposing periodic boundaries in the @xmath83-direction of a box of length 30 , is @xmath84 , and so we expect the nucleation timescale for a groove of length @xmath81 to be @xmath85 .",
    "we therefore expect that replacing a single long groove of width 5 by an array of square pores of the same width will increase nucleation rate by a factor of @xmath86 .",
    "rate calculations done using forward flux sampling are consistent with this estimate",
    ".      illustrates the range of behaviors associated with different pore shapes and sizes .",
    "for some pores , nucleation happens in a single step : 1 ) droplets are not stable within very small pores ; instead , a critical nucleus appears on the surrounding surface ( top left ) ; or 2 ) droplets can attain criticality within very large pores ( top right ) . for other pores",
    ", nucleation happens in two steps : 3 ) small filled pores are metastable with respect to both solution and the nucleated phase ( bottom left ) ; and 4 ) filled , moderately - sized pores are stable with respect to solution , and metastable with respect to the nucleated phase ( bottom right ) .",
    "we have studied homogeneous and heterogeneous nucleation in the 2d and 3d ising models .",
    "our key result is the extension of the work of ref .",
    "@xcite to calculate rates and free energy profiles for nucleation in the 3d ising model in the presence of cuboidal pores .",
    "pores of well - chosen aspect ratio can dramatically speed nucleation relative to a planar surface made of the same material , while badly - chosen pores provide no such enhancement .",
    "further , for given thermodynamic conditions , and a sufficiently strong pore - particle attraction , there exists a pore size and aspect ratio ideal for promoting nucleation . summarizes the importance of pore choice in reducing free energy barriers to nucleation .",
    "a sufficiently attractive surface can dramatically reduce the nucleation barrier relative to that in bulk .",
    "for the parameters considered here , the bulk free energy nucleation barrier is about @xmath87 , while the barrier in the presence of an attractive wall ( @xmath71 ) is about @xmath88 .",
    "a pore made from the same material can reduce the barrier even further : the barrier is about @xmath89 for the optimally - sized square pore ( ( a ) ) .",
    "however , a badly - chosen pore offers no improvement over a planar surface : although small droplets appear first within the pore of ( b ) , the critical nucleus forms instead on the surface surrounding it .",
    "we thank richard sear , seunghwa ryu and wei cai for valuable correspondence .",
    "l.o.h . was supported by the center for nanoscale control of geologic co@xmath90 , a u.s .",
    "d.o.e . energy frontier research center , under contract no .",
    "de - ac0205ch11231 .",
    "this work was done at the molecular foundry , lawrence berkeley national laboratory , supported under contract no .",
    "de - ac02 - 05ch11231 .",
    "this research used resources of the national energy research scientific computing center , which is supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "several implementations of umbrella sampling  @xcite for the study of nucleation are described in the literature  @xcite .",
    "we used a hybrid of the following two methods . in the first method ( method a ) we measured the distribution of sizes of all connected clusters in the simulation box  @xcite .",
    "we carried out ` hard wall ' umbrella sampling simulations  @xcite , constraining the simulation to a ` window ' ( of length 10 and with an overlap of 5 with its next neighbor ) by rejecting any spin flip that made the largest cluster in the simulation box larger or smaller than the window s limits . within each window",
    "we recorded histograms of the density of clusters of all sizes that fall within the window s bounds , measuring @xmath91 , where @xmath92 is the number of clusters of size @xmath21 in the simulation box , and @xmath93 is its volume .",
    "we combined data from all windows using the weighted histogram analysis method ( wham )  @xcite , giving the free energy @xmath94 .",
    "we checked this sampling procedure by reproducing , for the 3d ising model , the curves shown in fig . 5 of ref .  @xcite and fig . 1 of ref",
    ".  @xcite .",
    "while simple to implement , the hard wall umbrella sampling technique can become inefficient when there exist steep gradients in free energy .",
    "in this situation the sampling within a window is largely confined to the region adjacent to the wall lower in free energy , leaving the other end of the window badly sampled .",
    "although it is possible to circumvent this problem by increasing the number of sampling windows ( or their degree of overlap ) , this increases the computational cost of the method . a common solution ( and the second method considered , method b ) is to constrain the size @xmath95 of the largest cluster using a harmonic bias potential , @xmath96  @xcite .",
    "here @xmath97 designate the different sampling windows , @xmath98 is a spring constant , and @xmath99 is the cluster size at the center of window @xmath2 .",
    "the width of a window is determined by the strength of the spring constant @xmath98 which can be softened or stiffened according to the local free energy gradient in order to improve sampling .",
    "we generated histograms @xmath100 by adding 1 to a register @xmath101 if , after every trial move , the largest cluster in the system was of size @xmath95 ( regardless of how many clusters of that size there were ) .",
    "to generate overlapping histograms we used a window spacing of @xmath102 and a spring constant of @xmath103 .",
    "sampling was done for a minimum of @xmath104 mc sweeps within each window .",
    "an mc sweep consisted of @xmath105 attempted trial moves , where @xmath105 was the number of lattice sites in the bulk of the simulation box , i.e. sites that are not part of a wall or pore .",
    "we updated and recorded cluster size distributions after every trial move , so maximizing the efficiency of our simulations .",
    "we used umbrella integration  @xcite to unbias the results of umbrella sampling simulations , and used wham  @xcite to check this procedure and resolve fine details of certain free energy curves ( see appendix  [ apx : umbrella_integration ] ) .",
    "this procedure gives the ` free energy ' @xmath106 .    unlike method",
    "a , which measures the distribution of sizes for all clusters , method b instead samples the probability that the _ largest _ cluster is of size @xmath95 . as pointed out by maibaum  @xcite , a free energy penalty is incurred whenever @xmath95 is constrained to sizes smaller than the average cluster size , @xmath107 , seen in unconstrained simulations ( that do not result in nucleation ) . shows a comparison between the two umbrella sampling methods at conditions of deep ( a ) and shallow ( b ) supercooling . here",
    "@xmath108 is defined as @xmath109 and @xmath110 for methods a and b respectively . at deep supercooling",
    "the average cluster size at small @xmath21 is 5 ; consequently , a spurious increase in @xmath108 is seen in the free energy curve obtained using method b for @xmath111  @xcite .",
    "in contrast , at shallow supercooling the average cluster size at small @xmath21 is 1 , and the methods agree .    although small-@xmath21 artifacts can be present using method b , it is important to note that the shape of the free energy curve is correct for @xmath112 .",
    "we can therefore take advantage of the improved sampling that method b provides by using it to sample large clusters , and using method a to gather statistics for small clusters ( which is typically cheap to do ) .",
    "the curves reported in the text were stitched together using both methods , with the method b results shifted vertically to match the small - cluster data obtained using method a. comparison with the cnt - like predictions in section  [ section : ising_bulk ] and the results of ref .",
    "@xcite allow us to confirm that this scheme works .    to complement our free energy sampling we calculated nucleation rates directly using the forward flux sampling ( ffs ) method  @xcite .",
    "ffs is reasonably insensitive to the choice of reaction coordinate  @xcite , and we verified that consistent results were obtained using as a reaction coordinate 1 ) the size of the largest cluster in our simulation box and 2 ) the total number of particles .",
    "all interfaces were spaced 10 particles apart , and 10000 crossings were stored at each .",
    "rates were measured in units of monte carlo steps per bulk site .",
    "to measure nucleation rates in the presence of pores we followed the protocol outlined in ref .",
    "@xcite and decomposed the overall nucleation rate into two parts : the rate for pore filling @xmath113 ; and the rate for nucleation out of an already filled pore @xmath114 .",
    "these rates define the mean timescales for the two nucleation processes , @xmath115 and @xmath116 , which can be combined to give the overall nucleation time , @xmath117 , and hence the overall nucleation rate @xmath118 .",
    "we combined data from each window using the weighted histogram analysis method ( wham )  @xcite and/or umbrella integration  @xcite .",
    "wham takes as its input an overlapping sequence of probability distributions , and effects a self - consistent iteration to reconstitute the underlying free energy curve .",
    "umbrella integration , by contrast , assumes gaussian probability distributions within each window , and takes as input only the mean and variance of the sampled distribution .",
    "it also does not require windows to overlap .",
    "it is therefore computationally cheaper to implement than wham .",
    "for example , the contour plots shown in   were made from 210 sets of simulations , each comprising 200 individual sampling windows . using umbrella integration it was possible to compute all of the 210 free energy curves in less than 10 seconds . by contrast , wham took north of 20 minutes to process an individual free energy curve .        as the authors of the method caution  @xcite , umbrella integration misses features of a free energy curve if the sampling within windows is non - gaussian , as happens when a pore fills layer by layer .",
    "in such cases , wham reveals subtle local features ( metastable minima ) in the free energy profile : see e.g. the @xmath119 profile in ( a ) , enlarged in for clarity .",
    "umbrella integration does not . however , umbrella integration gets correct the overall shape of the free energy profile , including the positions and heights of the large free energy barriers ( corresponding to the initial nucleation event within the pore , and nucleation of a droplet out of the filled pore ) .",
    "we therefore used umbrella integration to broadly survey free energy landscapes in figs  [ fig : hot_spot][fig : hot_spot_breakdown ] , and used wham to resolve subtle features of particular curves .",
    "the requirement that a wall attract a nucleating phase before bulk nucleation is suppressed is consistent with a classical nucleation theory - like scaling argument .",
    "we can estimate the barrier for nucleation at a wall by considering a droplet whose shape is the portion of a circle of radius @xmath120 that lies above a surface when the surface - circle intersections subtend an angle @xmath121 at the center of the circle ( see , inset ) .",
    "when @xmath122 the circle just touches the wall and we have nucleation in the bulk ; when @xmath123 the droplet is a semi - circle ; when @xmath124 we consider the droplet to wet the wall .",
    "we estimate the free energy of the droplet as @xmath125 the first three terms account for droplet area @xmath126 ; curved droplet perimeter @xmath127 ; and wall - contacting droplet perimeter @xmath128 .",
    "@xmath62 is the wall - droplet surface tension .",
    "the final term ( @xmath129 if @xmath130 , and is zero if @xmath122 ) accounts for the fact that there are more ways of placing a droplet in the bulk than at the wall of the system , i.e. there is an entropic cost associated with moving a cluster from the bulk to the wall .",
    "maximizing with respect to @xmath120 gives the critical radius @xmath131 substituting this expression into gives the free energy barrier to nucleation : [ eqn : free_energy_wall ] g_s(r_c , ) & = & + & + & ( ) n_box . upon setting @xmath122",
    ", we recover the conventional bulk solution ,   with @xmath132 .",
    "the droplet makes a contact angle with the surface of @xmath133 .",
    "balancing surface tensions using young s equation  @xcite gives @xmath134 .",
    "using these results in gives a contact angle - dependent free energy barrier @xmath135 where @xmath136 this is the turnbull estimate for the free energy of a 2d droplet at a surface  @xcite . in terms of surface tensions",
    "the function @xmath137 reads @xmath138.\\ ] ] to compare this estimate with the results of simulation we added to the difference between the numerical value for the bulk free energy barrier , calculated via umbrella sampling , and the uncorrected cnt prediction , i.e. @xmath139 where @xmath140 .",
    "this modification assumes that the ill - defined origin of our cnt - like expression can be fixed by requiring that in the bulk limit it returns the results of computer simulations ( see section [ section : ising_bulk ] ) .",
    "this modification is ad - hoc and uncontrolled .",
    "we take onsager s solution for the ising model surface tension , , as an approximation   given in  @xcite . ] for the droplet - solution surface tension : @xmath141.\\ ] ] note that @xmath4 is the lattice gas coupling , not the ising one . to estimate a value for the droplet - wall surface tension",
    ", we note that the two terms in the onsager surface tension account for the energy per unit length of a planar interface ( first term ) , and the free energy per unit length of fluctuations normal to that interface ( second term )  @xcite . to see this , consider an interface of horizontal length @xmath81 between up- and down spins in a 2d ising model ( at @xmath29 ) , where the vertical position of the interface at the @xmath142 lattice site across it ( @xmath143 is @xmath144 .",
    "the energy cost of fluctuations normal to the interface is therefore @xmath145 , and the associated partition function is z_interface & = & _ \\{u_n } e^-2 k _",
    "n |u_n+1-u_n| + & = & ( _ u=-^^-2 k | u |)^l + & = & ^l ( k ) . the free energy per unit",
    "length associated with perpendicular fluctuations of the interface , @xmath146 , is therefore the second term in ( recall that @xmath147 ) .",
    "we now guess that when the wall is attractive enough that a droplet remains in close contact with it , the wall - droplet interface acts _ as if _ the wall can fluctuate .",
    "clearly this is not true microscopically , and is likely to be a poor approximation if the droplet surface moves appreciable away from the wall .",
    "we nonetheless conjecture that the surface tension between the droplet and the wall can be approximated as @xmath148 we shall use eqns .   and to relate the surface tensions entering to the particle - wall attraction @xmath51 used in our simulations .        finally , our cnt - like prediction for the barrier to nucleation in the presence of a surface is g_max=(g^s_max , g_bulk^sim ) , i.e. we take the bulk barrier whenever the barrier to nucleation at the surface is larger than it ( by virtue of the entropic penalty of wall confinement ) .",
    "( a ) shows a comparison between theoretical ( solid line ) and simulated ( circles ) free energy barriers .",
    "both calculations show that nucleation only occurs at the wall when the particle - wall attraction is strong enough to offset the entropic penalty of removing the droplet from the bulk .",
    "moreover , the quantitative agreement between the two methods is reasonable , which is surprising in light of the crude nature of the approximations we have made .",
    "( b ) shows the umbrella sampling free energy barrier as a function of the particle - wall interaction strength .",
    "( c ) shows the contact angle computed from young s equation , which is @xmath149 whenever bulk nucleation is preferred .",
    "the numbered snapshots show the average profiles of critical nuclei at different values of the reduced surface tension .",
    "those on the left are generated using the contact angle from the solution to young s equation , while those on the right are averages from umbrella sampling simulations . in all cases",
    "the agreement between theory and simulation is good .",
    "here we have made a pictorial comparison between droplet shapes predicted by theory and computed by simulation ; previous work demonstrates quantitatively that cnt can predict the ising model droplet contact angle  @xcite ."
  ],
  "abstract_text": [
    "<S> motivated by the question of how to pattern a surface in order to best speed nucleation from solution , we build on the work of page and sear [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> 97 , 65701 ( 2006 ) ] and calculate rates and free energy profiles for nucleation in the 3d ising model in the presence of cuboidal pores . </S>",
    "<S> pores of well - chosen aspect ratio can dramatically speed nucleation relative to a planar surface made of the same material , while badly - chosen pores provide no such enhancement . for a given pore </S>",
    "<S> , the maximum nucleation rate is achieved when one of its two horizontal dimensions attains a critical length , largely irrespective of the other dimension ( provided that the latter is large enough ) . </S>",
    "<S> this observation implies that patterning a surface in a raster - like fashion is a better strategy for speeding nucleation than e.g. scoring long grooves in it . </S>"
  ]
}