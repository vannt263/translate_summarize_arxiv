{
  "article_text": [
    "we consider the problem of computing the partition function of the finite - size two - dimensional ( 2d ) ferromagnetic ising model in an external magnetic field . applying factor graph duality to address",
    "the problem has been investigated in  @xcite .",
    "it was demonstrated in  @xcite that monte carlo methods based on the dual factor graph work very well for the ising model at low temperature . in contrast , monte carlo methods in the original graph , suffer from critical slowing down at low temperature  @xcite .",
    "monte carlo methods in the dual factor graph were also proposed in  @xcite to estimate the partition function of 2d ising models in the absence of an external field . in  @xcite ,",
    "an importance sampling scheme was proposed on the dual factor graph to compute the partition function of the 2d ising model and the 2d potts model , when the models are under the influence of an external magnetic field .",
    "the importance sampling scheme of  @xcite was specifically designed for models that are in a strong external field .    in the present paper",
    ", we continue this investigation to extend the results of  @xcite to models with a mixture of strong and weak coupling parameters , and show that in order to have efficient monte carlo methods in the dual factor graph , not all the coupling parameters need to be strong ( corresponding to models at low temperature ) , but only a restricted subset of them . as in  @xcite , the proposed importance sampling schemes operate in the dual of the forney factor graph representing the model .",
    "our numerical results show that the schemes can efficiently estimate the partition function in a wide range of model parameters .    in our schemes ,",
    "samples are drawn in the dual domain , therefore , as was pointed out in  @xcite , the proposed schemes do not suggest a direct method to draw samples according to the boltzmann distribution . for more details , see  ( * ? ? ?",
    "* section  ii.2 ) ,  @xcite .",
    "the paper is organized as follows . in section  [ sec : ising ] , we review the ising model and its graphical model representation in terms of forney factor graphs .",
    "section  [ sec : nfgd ] discusses dual forney factor graphs and the normal factor graph duality theorem .",
    "sections  [ sec : ising ] and  [ sec : nfgd ] mainly follow the introductory sections of  @xcite . section  [ sec : is ] describes the proposed importance sampling schemes and the corresponding algorithms .",
    "generalizations to the @xmath0-state potts model are briefly discussed in section  [ sec : potts ] .",
    "numerical experiments are reported in section  [ sec : num ] .",
    "let @xmath1 be a collection of discrete random variables arranged on the sites of a 2d lattice , as illustrated in fig .",
    "[ fig:2dgrid ] , where interactions are restricted to adjacent ( nearest - neighbor ) variables .",
    "suppose each random variable takes on values in some finite alphabet @xmath2 .",
    "let @xmath3 represent a possible realization of @xmath4 , @xmath5 stand for a configuration @xmath6 , and let @xmath7 stand for @xmath8 .    in a 2d ising model ( a.k.a .",
    "lenz - ising model , see  @xcite for an introduction and  @xcite for a historical review ) , @xmath9 and the energy of a configuration @xmath5 is given by the hamiltonian  @xcite @xmath10 - [ x_k \\ne x_{\\ell}]\\big)\\\\   - \\sum_{m = 1}^n h_m\\cdot\\big([x_m = 1 ] - [ x_m = 0]\\big)\\end{gathered}\\ ] ] where @xmath11 contains all the pairs ( bonds ) @xmath12 with non - zero interactions , and @xmath13 $ ] denotes the iverson bracket  @xcite , which evaluates to @xmath14 if the condition in the bracket is satisfied and to @xmath15 otherwise .",
    "the real coupling parameter @xmath16 controls the strength of the interaction between adjacent variables @xmath17 .",
    "the real parameter @xmath18 corresponds to the presence of an external magnetic field and controls the strength of the interaction between @xmath19 and the field .    in this paper , the focus is on ferromagnetic ising models characterized by @xmath20 , for each @xmath21 . in ferromagnetic ising models , configurations",
    "in which adjacent variables take the same values , have low energy levels . in thermal equilibrium ,",
    "the probability that the model is in configuration @xmath5 , is given by the boltzmann distribution @xmath22    here , @xmath23 is the partition function ( the normalization constant ) @xmath24 and @xmath25 where @xmath26 denotes the temperature and @xmath27 is boltzmann s constant  @xcite . the helmholtz free energy is defined as @xmath28    the helmholtz free energy is an important quantity in statistical physics as all macroscopic thermodynamic properties of a model follow from differentiating @xmath29 ( as a function of the temperature ) ; see  ( * ? ? ?",
    "* chapter 2 ) . in the rest of this paper , we assume @xmath30 . for",
    "each adjacent pair @xmath31 , let @xmath32 - [ x_k \\ne x_{\\ell}]\\big)}\\ ] ] and for each @xmath33 @xmath34 - [ x_m = 0]\\big)}\\ ] ]    we can then define @xmath35 as @xmath36    the corresponding forney factor graph ( normal graph ) for the factorization in  ( [ eqn : factorf ] ) is shown in  fig .",
    "[ fig:2dgrid ] , where the boxes labeled `` @xmath37 '' are equality constraints  @xcite . in forney factor graphs variables",
    "are represented by edges .    from ( [ eqn : factorf ] ) ,",
    "@xmath23 in ( [ eqn : prob ] ) can be expressed as @xmath38    at high temperature ( i.e. , small @xmath39 ) , the boltzmann distribution  ( [ eqn : prob ] ) approaches the uniform distribution .",
    "therefore , to estimate @xmath23 and other quantities of interest ( e.g. , the mean magnetization ) , monte carlo methods in the original graph usually perform well  @xcite .    in this paper , we consider a curious case where a restricted subset of the coupling parameters of the model is strong ( i.e. , large @xmath39 ) . to compute an estimate of @xmath23 in this case",
    ", we propose importance sampling schemes that operates in the dual of the forney factor graph representing the factorization in  ( [ eqn : factorf ] ) .",
    "we can obtain the dual of the forney factor graph in  fig .",
    "[ fig:2dgrid ] , by replacing each variable @xmath40 with its dual variable @xmath41 , each factor @xmath42 with its 2d discrete fourier transform ( dft ) , each factor @xmath43 with its one - dimensional ( 1d ) dft , and each equality constraint with an xor factor , cf .",
    "note that , @xmath44 also takes on values in @xmath2 . after suitable modifications , we can construct the ( modified ) dual forney factor graph as in  fig .",
    "[ fig:2dgriddm ] , with xor factors as @xmath45\\ ] ] where @xmath46 denotes the sum in gf(@xmath47 ) , with factors attached to each xor factor as @xmath48 and with factors attached to each equality constraint as @xmath49    here , @xmath50 is the coupling parameter associated with each bond ( the bond strength ) . for more details on constructing the dual factor graph of the 2d ising and potts models , see  @xcite .    in the dual domain",
    ", we denote the partition function by @xmath51 and the number of edges by @xmath52 . for the models that we study here , the normal factor graph duality theorem states that @xmath53 see  @xcite ,  ( * ? ? ?",
    "* theorem 2 ) .",
    "( 81,66)(0,0 ) ( 0,60)(4,4)@xmath37 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 8,63)(0,0)[bc]@xmath54 ( 12,60)(4,4 ) ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath37 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 32,63)(0,0)[bc]@xmath55 ( 36,60)(4,4 ) ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath37 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 56,63)(0,0)[bc]@xmath56 ( 60,60)(4,4 ) ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath37 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4 ) ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4 ) ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4 ) ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4 ) ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath37 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4 ) ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath37 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4 ) ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath37 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4 ) ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath37 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4 ) ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4 ) ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4 ) ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4 ) ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath37 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4 ) ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath37 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4 ) ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath37 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4 ) ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath37 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4 ) ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4 ) ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4 ) ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4 ) ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath37 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4 ) ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath37 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4 ) ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath37 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4 ) ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath37 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    ( 77,72.2)(1,0 ) ( 0,60)(4,4)@xmath57 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 12,60)(4,4)@xmath37 ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath57 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 36,60)(4,4)@xmath37 ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath57 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4)@xmath37 ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath57 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4)@xmath37 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4)@xmath37 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4)@xmath37 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4)@xmath37 ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath57 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4)@xmath37 ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath57 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4)@xmath37 ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath57 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4)@xmath37 ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath57 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4)@xmath37 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4)@xmath37 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4)@xmath37 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4)@xmath37 ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath57 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4)@xmath37 ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath57 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4)@xmath37 ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath57 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4)@xmath37 ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath57 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4)@xmath37 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4)@xmath37 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4)@xmath37 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4)@xmath37 ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath57 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4)@xmath37 ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath57 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4)@xmath37 ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath57 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4)@xmath37 ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath57 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    ( 8,63)(0,0)[bc]@xmath58 ( 32,63)(0,0)[bc]@xmath59    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    in this paper , the focus is on ferromagnetic models , therefore all the factors as in  ( [ eqn : isingkerneldual ] ) are positive . since in a 2d ising model , the value of @xmath23 is invariant under the change of sign of the external field  @xcite , without loss of generality , we assume @xmath61",
    ". with this assumption , all the factors as in  ( [ eqn : isingkerneldual2 ] ) will also be positive . in section  [ sec : is ] , we use the dual representation of the 2d ising model to give an alternative proof for the invariance of @xmath23 under the change of sign of the external field .",
    "in this section , we propose two importance sampling schemes in the dual forney factor graph to compute an estimate of @xmath23 , as in ( [ eqn : partfunction ] ) .",
    "our importance sampling schemes operate in the dual forney factor graph of the 2d ising model in an external magnetic field , see  fig .",
    "[ fig:2dgriddm ] . as in  @xcite",
    ", we partition the set of random variables @xmath62 , into @xmath63 and @xmath64 , with the condition that the random variables in @xmath64 are linear combinations ( involving the xor factors ) of the random variables in @xmath63 .",
    "note that , a valid configuration in the dual graph can be generated by assigning values to @xmath63 , followed by computing @xmath64 as linear combinations of @xmath63 .",
    "two examples of such a partitioning are illustrated in figs .",
    "[ fig:2dgriddpart3 ] and  [ fig:2dgriddpart ] , where we let @xmath63 be the set of all the variables associated with the thick edges , and @xmath64 the set of all the variables associated with the remaining thin edges .",
    "accordingly , we let @xmath65 , a subset of @xmath11 , contain all the indices of the bonds marked by the thick edges , and @xmath66 .    for a valid configuration @xmath67 ,",
    "suppose @xmath68 , where @xmath69 contains all the thick edges attached to the small unlabeled boxes , which represent variables that are involved in factors as in  ( [ eqn : isingkerneldual2 ] ) , and @xmath70 contains all the variables associated with the thick bonds .",
    "we show that @xmath71 , the hamming weight of @xmath72 , is always even , where the hamming weight of a vector is the number of non - zero components of that vector  @xcite .",
    "( 77,71.6)(0,0 ) ( 0,60)(4,4)@xmath57 ( 8,54)(3,3 ) ( 12,60)(4,4)@xmath37 ( 24,60)(4,4)@xmath57 ( 32,54)(3,3 ) ( 36,60)(4,4)@xmath37 ( 48,60)(4,4)@xmath57 ( 56,54)(3,3 ) ( 60,60)(4,4)@xmath37 ( 72,60)(4,4)@xmath57 ( 80,54)(3,3 ) ( 0,50)(4,4)@xmath37 ( 24,50)(4,4)@xmath37 ( 48,50)(4,4)@xmath37 ( 72,50)(4,4)@xmath37 ( 0,40)(4,4)@xmath57 ( 8,34)(3,3 ) ( 12,40)(4,4)@xmath37 ( 24,40)(4,4)@xmath57 ( 32,34)(3,3 ) ( 36,40)(4,4)@xmath37 ( 48,40)(4,4)@xmath57 ( 56,34)(3,3 ) ( 60,40)(4,4)@xmath37 ( 72,40)(4,4)@xmath57 ( 80,34)(3,3 ) ( 0,30)(4,4)@xmath37 ( 24,30)(4,4)@xmath37 ( 48,30)(4,4)@xmath37 ( 72,30)(4,4)@xmath37 ( 0,20)(4,4)@xmath57 ( 8,14)(3,3 ) ( 12,20)(4,4)@xmath37 ( 24,20)(4,4)@xmath57 ( 32,14)(3,3 ) ( 36,20)(4,4)@xmath37 ( 48,20)(4,4)@xmath57 ( 56,14)(3,3 ) ( 60,20)(4,4)@xmath37 ( 72,20)(4,4)@xmath57 ( 80,14)(3,3 ) ( 0,10)(4,4)@xmath37 ( 24,10)(4,4)@xmath37 ( 48,10)(4,4)@xmath37 ( 72,10)(4,4)@xmath37 ( 0,0)(4,4)@xmath57 ( 8,-6)(3,3 ) ( 12,0)(4,4)@xmath37 ( 24,0)(4,4)@xmath57 ( 32,-6)(3,3 ) ( 36,0)(4,4)@xmath37 ( 48,0)(4,4)@xmath57 ( 56,-6)(3,3 ) ( 60,0)(4,4)@xmath37 ( 72,0)(4,4)@xmath57 ( 80,-6)(3,3 )    ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    ( 4,60)(4,-3)4 ( 4,60)(4,-3)4 ( 4,60)(4,-3)4 ( 4.1,59.9)(4,-3)4 ( 4.1,60.1)(4,-3)4 ( 3.9,59.9)(4,-3)4 ( 28,60)(4,-3)4 ( 28,60)(4,-3)4 ( 28,60)(4,-3)4 ( 28.1,59.9)(4,-3)4 ( 28.1,60.1)(4,-3)4 ( 27.9,59.9)(4,-3)4 ( 52,60)(4,-3)4 ( 52,60)(4,-3)4 ( 52,60)(4,-3)4 ( 52.1,59.9)(4,-3)4 ( 52.1,60.1)(4,-3)4 ( 51.9,59.9)(4,-3)4 ( 76,60)(4,-3)4 ( 76,60)(4,-3)4 ( 76,60)(4,-3)4 ( 76.1,59.9)(4,-3)4 ( 76.1,60.1)(4,-3)4 ( 75.9,59.9)(4,-3)4 ( 4,40)(4,-3)4 ( 4,40)(4,-3)4 ( 4,40)(4,-3)4 ( 4.1,39.9)(4,-3)4 ( 4.1,40.1)(4,-3)4 ( 3.9,39.9)(4,-3)4 ( 28,40)(4,-3)4 ( 28,40)(4,-3)4 ( 28,40)(4,-3)4 ( 28.1,39.9)(4,-3)4 ( 28.1,40.1)(4,-3)4 ( 27.9,39.9)(4,-3)4 ( 52,40)(4,-3)4 ( 52,40)(4,-3)4 ( 52,40)(4,-3)4 ( 52.1,39.9)(4,-3)4 ( 52.1,40.1)(4,-3)4 ( 51.9,39.9)(4,-3)4 ( 76,40)(4,-3)4 ( 76,40)(4,-3)4 ( 76,40)(4,-3)4 ( 76.1,39.9)(4,-3)4 ( 76.1,40.1)(4,-3)4 ( 75.9,39.9)(4,-3)4 ( 4,20)(4,-3)4 ( 4,20)(4,-3)4 ( 4.1,19.9)(4,-3)4 ( 4.1,20.1)(4,-3)4 ( 3.9,19.9)(4,-3)4 ( 28,20)(4,-3)4 ( 28,20)(4,-3)4 ( 28,20)(4,-3)4 ( 28.1,19.9)(4,-3)4 ( 28.1,20.1)(4,-3)4 ( 27.9,19.9)(4,-3)4 ( 52,20)(4,-3)4 ( 52,20)(4,-3)4 ( 52,20)(4,-3)4 ( 52.1,19.9)(4,-3)4 ( 52.1,20.1)(4,-3)4 ( 51.9,19.9)(4,-3)4 ( 76,20)(4,-3)4 ( 76,20)(4,-3)4 ( 76,20)(4,-3)4 ( 76.1,19.9)(4,-3)4 ( 76.1,20.1)(4,-3)4 ( 75.9,19.9)(4,-3)4 ( 4,0)(4,-3)4 ( 4,0)(4,-3)4 ( 4,0)(4,-3)4 ( 4.1,-0.1)(4,-3)4 ( 4.1,0.1)(4,-3)4 ( 3.9,-0.1)(4,-3)4 ( 28,0)(4,-3)4 ( 28,0)(4,-3)4 ( 28,0)(4,-3)4 ( 28.1,-0.1)(4,-3)4 ( 28.1,0.1)(4,-3)4 ( 27.9,-0.1)(4,-3)4 ( 52,0)(4,-3)4 ( 52,0)(4,-3)4 ( 52,0)(4,-3)4 ( 52.1,-0.1)(4,-3)4 ( 52.1,0.1)(4,-3)4 ( 51.9,-0.1)(4,-3)4 ( 76,0)(4,-3)4 ( 76,0)(4,-3)4 ( 76,0)(4,-3)4 ( 76.1,-0.1)(4,-3)4 ( 76.1,0.1)(4,-3)4 ( 75.9,-0.1)(4,-3)4 ( 2,54)(0,1)6 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 74,50)(0,-1)6 ( 2,34)(0,1)6 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 74,30)(0,-1)6 ( 2,14)(0,1)6 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 74,10)(0,-1)6 ( 4,2)(1,0)8 ( 16,2)(1,0)8 ( 28,2)(1,0)8 ( 40,2)(1,0)8 ( 52,2)(1,0)8 ( 64,2)(1,0)8 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2    ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2    ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2    ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2    ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2    ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2    ( 4,62)(1,0)8 ( 16,62)(1,0)8 ( 28,62)(1,0)8 ( 40,62)(1,0)8 ( 52,62)(1,0)8 ( 64,62)(1,0)8 ( 4,42)(1,0)8 ( 16,42)(1,0)8 ( 28,42)(1,0)8 ( 40,42)(1,0)8 ( 52,42)(1,0)8 ( 64,42)(1,0)8 ( 4,22)(1,0)8 ( 16,22)(1,0)8 ( 28,22)(1,0)8 ( 40,22)(1,0)8 ( 52,22)(1,0)8 ( 64,22)(1,0)8    * lemma 1 .",
    "* if @xmath73 is a valid configuration in the dual forney factor graph of the 2d ising model , then @xmath74 is even .",
    "_ we consider @xmath75 , the component - wise xor of @xmath69 , as @xmath76 .",
    "each xor factor imposes the constraint that all its incident variables sum to @xmath15 in gf(@xmath47 ) . in @xmath75 ,",
    "each @xmath77 can thus be expanded as the xor of the corresponding variables associated with the bonds , furthermore , the variables on the bonds each appears twice in this expansion .",
    "we conclude that @xmath78 , i.e. , @xmath71 is even .",
    "@xmath79    in lemma @xmath14 , the choice of the boundary conditions ( free or periodic ) is immaterial .",
    "lemma @xmath14 implies that the value of @xmath80 , and equivalently the value of @xmath23 , are invariant under the change of sign of the external magnetic field .",
    "indeed , regardless of the sign of the external field @xmath18 , i.e. , assigned to all positive or to all negative values , @xmath81 takes on the same positive value , see  ( [ eqn : isingkerneldual2 ] ) . in the following , we present two slightly different algorithms for estimating the partition function . both algorithms use importance sampling and",
    "follow the same procedure : to draw @xmath82 at each iteration @xmath83 , we first draw a sample @xmath84 according to a suitably defined auxiliary probability mass function , we then update @xmath85 in order to generate @xmath86 .",
    "since @xmath87 is a linear combination of @xmath88 , at each iteration , @xmath85 can be updated in a straightforward manner .",
    "( 77,71.6)(0,0 ) ( 0,60)(4,4)@xmath57 ( 8,54)(3,3 ) ( 12,60)(4,4)@xmath37 ( 24,60)(4,4)@xmath57 ( 32,54)(3,3 ) ( 36,60)(4,4)@xmath37 ( 48,60)(4,4)@xmath57 ( 56,54)(3,3 ) ( 60,60)(4,4)@xmath37 ( 72,60)(4,4)@xmath57 ( 80,54)(3,3 ) ( 0,50)(4,4)@xmath37 ( 24,50)(4,4)@xmath37 ( 48,50)(4,4)@xmath37 ( 72,50)(4,4)@xmath37 ( 0,40)(4,4)@xmath57 ( 8,34)(3,3 ) ( 12,40)(4,4)@xmath37 ( 24,40)(4,4)@xmath57 ( 32,34)(3,3 ) ( 36,40)(4,4)@xmath37 ( 48,40)(4,4)@xmath57 ( 56,34)(3,3 ) ( 60,40)(4,4)@xmath37 ( 72,40)(4,4)@xmath57 ( 80,34)(3,3 ) ( 0,30)(4,4)@xmath37 ( 24,30)(4,4)@xmath37 ( 48,30)(4,4)@xmath37 ( 72,30)(4,4)@xmath37 ( 0,20)(4,4)@xmath57 ( 8,14)(3,3 ) ( 12,20)(4,4)@xmath37 ( 24,20)(4,4)@xmath57 ( 32,14)(3,3 ) ( 36,20)(4,4)@xmath37 ( 48,20)(4,4)@xmath57 ( 56,14)(3,3 ) ( 60,20)(4,4)@xmath37 ( 72,20)(4,4)@xmath57 ( 80,14)(3,3 ) ( 0,10)(4,4)@xmath37 ( 24,10)(4,4)@xmath37 ( 48,10)(4,4)@xmath37 ( 72,10)(4,4)@xmath37 ( 0,0)(4,4)@xmath57 ( 8,-6)(3,3 ) ( 12,0)(4,4)@xmath37 ( 24,0)(4,4)@xmath57 ( 32,-6)(3,3 ) ( 36,0)(4,4)@xmath37 ( 48,0)(4,4)@xmath57 ( 56,-6)(3,3 ) ( 60,0)(4,4)@xmath37 ( 72,0)(4,4)@xmath57 ( 80,-6)(3,3 )    ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    ( 4,60)(4,-3)4 ( 4,60)(4,-3)4 ( 4,60)(4,-3)4 ( 4.1,59.9)(4,-3)4 ( 4.1,60.1)(4,-3)4 ( 3.9,59.9)(4,-3)4 ( 28,60)(4,-3)4 ( 28,60)(4,-3)4 ( 28,60)(4,-3)4 ( 28.1,59.9)(4,-3)4 ( 28.1,60.1)(4,-3)4 ( 27.9,59.9)(4,-3)4 ( 52,60)(4,-3)4 ( 52,60)(4,-3)4 ( 52,60)(4,-3)4 ( 52.1,59.9)(4,-3)4 ( 52.1,60.1)(4,-3)4 ( 51.9,59.9)(4,-3)4 ( 76,60)(4,-3)4 ( 76,60)(4,-3)4 ( 76,60)(4,-3)4 ( 76.1,59.9)(4,-3)4 ( 76.1,60.1)(4,-3)4 ( 75.9,59.9)(4,-3)4 ( 4,40)(4,-3)4 ( 4,40)(4,-3)4 ( 4,40)(4,-3)4 ( 4.1,39.9)(4,-3)4 ( 4.1,40.1)(4,-3)4 ( 3.9,39.9)(4,-3)4 ( 28,40)(4,-3)4 ( 28,40)(4,-3)4 ( 28,40)(4,-3)4 ( 28.1,39.9)(4,-3)4 ( 28.1,40.1)(4,-3)4 ( 27.9,39.9)(4,-3)4 ( 52,40)(4,-3)4 ( 52,40)(4,-3)4 ( 52,40)(4,-3)4 ( 52.1,39.9)(4,-3)4 ( 52.1,40.1)(4,-3)4 ( 51.9,39.9)(4,-3)4 ( 76,40)(4,-3)4 ( 76,40)(4,-3)4 ( 76,40)(4,-3)4 ( 76.1,39.9)(4,-3)4 ( 76.1,40.1)(4,-3)4 ( 75.9,39.9)(4,-3)4 ( 4,20)(4,-3)4 ( 4,20)(4,-3)4 ( 4,20)(4,-3)4 ( 4.1,19.9)(4,-3)4 ( 4.1,20.1)(4,-3)4 ( 3.9,19.9)(4,-3)4 ( 28,20)(4,-3)4 ( 28,20)(4,-3)4 ( 28,20)(4,-3)4 ( 28.1,19.9)(4,-3)4 ( 28.1,20.1)(4,-3)4 ( 27.9,19.9)(4,-3)4 ( 52,20)(4,-3)4 ( 52,20)(4,-3)4 ( 52,20)(4,-3)4 ( 52.1,19.9)(4,-3)4 ( 52.1,20.1)(4,-3)4 ( 51.9,19.9)(4,-3)4 ( 76,20)(4,-3)4 ( 76,20)(4,-3)4 ( 76,20)(4,-3)4 ( 76.1,19.9)(4,-3)4 ( 76.1,20.1)(4,-3)4 ( 75.9,19.9)(4,-3)4 ( 4,0)(4,-3)4 ( 4,0)(4,-3)4 ( 4,0)(4,-3)4 ( 4.1,-0.1)(4,-3)4 ( 4.1,0.1)(4,-3)4 ( 3.9,-0.1)(4,-3)4 ( 28,0)(4,-3)4 ( 28,0)(4,-3)4 ( 28,0)(4,-3)4 ( 28.1,-0.1)(4,-3)4 ( 28.1,0.1)(4,-3)4 ( 27.9,-0.1)(4,-3)4 ( 52,0)(4,-3)4 ( 52,0)(4,-3)4 ( 52,0)(4,-3)4 ( 52.1,-0.1)(4,-3)4 ( 52.1,0.1)(4,-3)4 ( 51.9,-0.1)(4,-3)4 ( 2,54)(0,1)6 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 74,50)(0,-1)6 ( 2,34)(0,1)6 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 74,30)(0,-1)6 ( 2,14)(0,1)6 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 74,10)(0,-1)6 ( 4,2)(1,0)8 ( 16,2)(1,0)8 ( 28,2)(1,0)8 ( 40,2)(1,0)8 ( 52,2)(1,0)8 ( 64,2)(1,0)8 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2    ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2    ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2    ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2    ( 76,0)(4,-3)4 ( 80,0.85)(0,0)[bc ] ( 83.75,-2.5)(0,0)[bc ]    ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2    ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2    ( 4,62)(1,0)8 ( 16,62)(1,0)8 ( 28,62)(1,0)8 ( 40,62)(1,0)8 ( 52,62)(1,0)8 ( 64,62)(1,0)8 ( 4,42)(1,0)8 ( 16,42)(1,0)8 ( 28,42)(1,0)8 ( 40,42)(1,0)8 ( 52,42)(1,0)8 ( 64,42)(1,0)8 ( 4,22)(1,0)8 ( 16,22)(1,0)8 ( 28,22)(1,0)8 ( 40,22)(1,0)8 ( 52,22)(1,0)8 ( 64,22)(1,0)8      the partitioning used in algorithm 1 is illustrated in fig .",
    "[ fig:2dgriddpart3 ] .",
    "hence , @xmath63 contains all the variables associated with the edges attached to the small unlabeled boxes , which are involved in factors as in  ( [ eqn : isingkerneldual2 ] ) , as well as all the variables associated with the thick bonds , which are involved in factors as in  ( [ eqn : isingkerneldual ] ) .",
    "let us define    rcl _",
    "1(*x*_b ) & & _ k",
    "_ b _ k(x_k ) [ eqn : partl1 ] + _ 1(*x*_a ) & & _ k _ a _",
    "k(x_k)_m = 1^n _ m(x_m ) [ eqn : partg1 ]    we use the following probability mass function as the auxiliary distribution in our importance sampling scheme @xmath89    the partition function @xmath90 , is analytically available as    rcl z_q_1 & = & _ * x*_a _ 1(*x*_a ) + & = & 2^n + 2|_a| ( _ k = 1^|_a| j_k - _ m = 1^n",
    "h_m ) [ eqn : zq ]    where @xmath91 is the cardinality of @xmath65 .",
    "note that @xmath92 .",
    "the product form of ( [ eqn : partg1 ] ) suggests that at each iteration @xmath83 , to draw a sample @xmath93 according to @xmath94 , two separate subroutines are required , one to draw the @xmath95-part , and the other to draw the @xmath96-part . to draw the @xmath95-part",
    ", we apply the following subroutine .    *",
    "* repeat * * _ draw _ @xmath97 $ ] * @xmath98 * to * @xmath99 * @xmath100 * @xmath101 *   * @xmath102 *   *   * * until * @xmath103 _ is even _    the criteria to accept @xmath104 is based on lemma 1 .",
    "the quantity @xmath105 is equal to @xmath106 . to draw the @xmath96-part ,",
    "the following subroutine is applied .",
    "* _ draw _ @xmath107 $ ] * * for * @xmath108 * to * @xmath91 * @xmath109 * @xmath110 *   * @xmath111 *   * * end for *    here , @xmath112 is equal to @xmath113 .",
    "we can then generate @xmath114 as a concatenation of @xmath104 and @xmath115 , in any predetermined order .",
    "one can design an algorithm with no rejections by adopting a different choice of partitioning on the dual graph , as depicted in fig .",
    "[ fig:2dgriddpart ] .",
    "the only difference between the partitionings in figs .",
    "[ fig:2dgriddpart3 ] and  [ fig:2dgriddpart ] , is that in fig .",
    "[ fig:2dgriddpart ] one of the edges attached to the small unlabeled boxes ( indicated by  thin edge \" ) is excluded from @xmath63 . for simplicity ,",
    "let us assume that the excluded edge ( variable ) is involved in @xmath116 .",
    "we thus define    rcl _",
    "2(*x*_b ) & & _",
    "n(x_n ) _ k _ b _ k(x_k ) [ eqn : partl ] + _ 2(*x*_a ) & & _ k _ a _ k(x_k)_m = 1^n-1 _ m(x_m ) [ eqn : partg ]    similarly , the auxiliary distribution @xmath117 is as @xmath118 where @xmath119 is also analytically available .",
    "again , the product form of ( [ eqn : partg ] ) suggests that at each iteration @xmath83 , two separate subroutines are required to draw @xmath93 according to @xmath120 .    to draw the @xmath95-part , we apply the following subroutine , which has no rejections .",
    "* _ draw _ @xmath121 $ ] * * for * @xmath98 * to * @xmath122 * @xmath100 * @xmath101 *   * @xmath102 *   * * end for * * _ set _",
    "@xmath123    drawing the @xmath96-part can be treated in an analogous way as in algorithm 1 ( with the same subroutine ) .",
    "after this , we can generate @xmath114 from @xmath104 and @xmath115 .",
    "each of two algorithms will provide independent samples @xmath124 according to its auxiliary distribution . as previously mentioned , after generating @xmath114 , updating @xmath125 is easy .",
    "the samples are then used in the following importance sampling scheme to estimate @xmath126 ,    * * for * @xmath127 * to * @xmath128 * _ draw _ @xmath129 _ according to _ @xmath130 * _ update _ @xmath125 * * end for * * _ compute _",
    "@xmath131    here , @xmath132 and @xmath133 are selected in accordance with the applied algorithm ( algorithm 1 or algorithm 2 ) , and @xmath134 denotes the corresponding partition function .",
    "it follows that @xmath135 is an unbiased ( and consistent ) estimator of @xmath136 . indeed @xmath137",
    "= \\frac{z_\\mathrm{d}}{z_q}\\ ] ]    since @xmath134 is analytically available , the proposed importance sampling scheme can yield an estimate of @xmath80 , which can then be used to estimate @xmath23 in  ( [ eqn : partfunction ] ) , using the normal factor graph duality theorem , cf .",
    "section  [ sec : nfgd ] .    the accuracy of the estimator  ( [ eqn : estr ] ) depends on the fluctuations of @xmath138 .",
    "if @xmath138 varies smoothly , @xmath135 will have a small variance . from  ( [ eqn : partl1 ] )",
    ", we expect to observe a small variance in if for each @xmath139 , @xmath50 is large . with the exception of one factor ,",
    "similar behavior is expected in algorithm 2 , see section  [ sec : discuss ] .",
    "a few comments on the proposed schemes are in order .    *",
    "a good strategy in algorithm 2 is therefore to exclude a variable ( an edge ) involved in a factor with a large @xmath18 , see  ( [ eqn : partl ] ) .",
    "we will apply this strategy in the numerical experiments of section  [ sec : numising1 ] .",
    "* we emphasize that our choices of partitioning in figs .",
    "[ fig:2dgriddpart3 ] and  [ fig:2dgriddpart ] are not unique .",
    "[ fig:2dgriddpart2 ] shows another example of a partitioning on the dual factor graph .",
    "moreover , model parameters and their spatial distributions suggest which choices are expected to perform better in practice .",
    "e.g. , a suitable partitioning for models in a strong external field is discussed in  @xcite . *",
    "the proposed schemes are applicable to the ising model in the absence of an external magnetic field as well .",
    "e.g. , partitionings in figs .",
    "[ fig:2dgriddpart3 ] to  [ fig:2dgriddpart2 ] are valid even if the external field is not present .",
    "we will consider ising models in the absence of an external field in our numerical experiments in section  [ sec : numising2 ] .",
    "+ that being the case , to observe fast convergence in the dual domain , not all the coupling parameters need to be strong , but a restricted subset of them .",
    "therefore , the schemes of this paper can be regarded as supplementary to the schemes presented in  @xcite , where the focus was on models at low temperature ( corresponding to models in which all the coupling parameters are strong ) . *",
    "if a restricted subset of the coupling parameters is relatively strong , ideas from annealed importance sampling  @xcite can be employed , see  appendix  i.    ( 77,71.6)(0,0 ) ( 0,60)(4,4)@xmath57 ( 8,54)(3,3 ) ( 12,60)(4,4)@xmath37 ( 24,60)(4,4)@xmath57 ( 32,54)(3,3 ) ( 36,60)(4,4)@xmath37 ( 48,60)(4,4)@xmath57 ( 56,54)(3,3 ) ( 60,60)(4,4)@xmath37 ( 72,60)(4,4)@xmath57 ( 80,54)(3,3 ) ( 0,50)(4,4)@xmath37 ( 24,50)(4,4)@xmath37 ( 48,50)(4,4)@xmath37 ( 72,50)(4,4)@xmath37 ( 0,40)(4,4)@xmath57 ( 8,34)(3,3 ) ( 12,40)(4,4)@xmath37 ( 24,40)(4,4)@xmath57 ( 32,34)(3,3 ) ( 36,40)(4,4)@xmath37 ( 48,40)(4,4)@xmath57 ( 56,34)(3,3 ) ( 60,40)(4,4)@xmath37 ( 72,40)(4,4)@xmath57 ( 80,34)(3,3 ) ( 0,30)(4,4)@xmath37 ( 24,30)(4,4)@xmath37 ( 48,30)(4,4)@xmath37 ( 72,30)(4,4)@xmath37 ( 0,20)(4,4)@xmath57 ( 8,14)(3,3 ) ( 12,20)(4,4)@xmath37 ( 24,20)(4,4)@xmath57 ( 32,14)(3,3 ) ( 36,20)(4,4)@xmath37 ( 48,20)(4,4)@xmath57 ( 56,14)(3,3 ) ( 60,20)(4,4)@xmath37 ( 72,20)(4,4)@xmath57 ( 80,14)(3,3 ) ( 0,10)(4,4)@xmath37 ( 24,10)(4,4)@xmath37 ( 48,10)(4,4)@xmath37 ( 72,10)(4,4)@xmath37 ( 0,0)(4,4)@xmath57 ( 8,-6)(3,3 ) ( 12,0)(4,4)@xmath37 ( 24,0)(4,4)@xmath57 ( 32,-6)(3,3 ) ( 36,0)(4,4)@xmath37 ( 48,0)(4,4)@xmath57 ( 56,-6)(3,3 ) ( 60,0)(4,4)@xmath37 ( 72,0)(4,4)@xmath57 ( 80,-6)(3,3 )    ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    ( 4,60)(4,-3)4 ( 4,60)(4,-3)4 ( 4.1,59.9)(4,-3)4 ( 4.1,60.1)(4,-3)4 ( 3.9,59.9)(4,-3)4 ( 28,60)(4,-3)4 ( 28,60)(4,-3)4 ( 28.1,59.9)(4,-3)4 ( 28.1,60.1)(4,-3)4 ( 27.9,59.9)(4,-3)4 ( 52,60)(4,-3)4 ( 52,60)(4,-3)4 ( 52.1,59.9)(4,-3)4 ( 52.1,60.1)(4,-3)4 ( 51.9,59.9)(4,-3)4 ( 76,60)(4,-3)4 ( 76,60)(4,-3)4 ( 76.1,59.9)(4,-3)4 ( 76.1,60.1)(4,-3)4 ( 75.9,59.9)(4,-3)4 ( 4,40)(4,-3)4 ( 4,40)(4,-3)4 ( 4.1,39.9)(4,-3)4 ( 4.1,40.1)(4,-3)4 ( 3.9,39.9)(4,-3)4 ( 28,40)(4,-3)4 ( 28,40)(4,-3)4 ( 28.1,39.9)(4,-3)4 ( 28.1,40.1)(4,-3)4 ( 27.9,39.9)(4,-3)4 ( 52,40)(4,-3)4 ( 52,40)(4,-3)4 ( 52.1,39.9)(4,-3)4 ( 52.1,40.1)(4,-3)4 ( 51.9,39.9)(4,-3)4 ( 76,40)(4,-3)4 ( 76,40)(4,-3)4 ( 76.1,39.9)(4,-3)4 ( 76.1,40.1)(4,-3)4 ( 75.9,39.9)(4,-3)4 ( 4,20)(4,-3)4 ( 4,20)(4,-3)4 ( 4.1,19.9)(4,-3)4 ( 4.1,20.1)(4,-3)4 ( 3.9,19.9)(4,-3)4 ( 28,20)(4,-3)4 ( 28,20)(4,-3)4 ( 28.1,19.9)(4,-3)4 ( 28.1,20.1)(4,-3)4 ( 27.9,19.9)(4,-3)4 ( 52,20)(4,-3)4 ( 52,20)(4,-3)4 ( 52.1,19.9)(4,-3)4 ( 52.1,20.1)(4,-3)4 ( 51.9,19.9)(4,-3)4 ( 76,20)(4,-3)4 ( 76,20)(4,-3)4 ( 76.1,19.9)(4,-3)4 ( 76.1,20.1)(4,-3)4 ( 75.9,19.9)(4,-3)4 ( 4,0)(4,-3)4 ( 4,0)(4,-3)4 ( 4.1,-0.1)(4,-3)4 ( 4.1,0.1)(4,-3)4 ( 3.9,-0.1)(4,-3)4 ( 28,0)(4,-3)4 ( 28,0)(4,-3)4 ( 28.1,-0.1)(4,-3)4 ( 28.1,0.1)(4,-3)4 ( 27.9,-0.1)(4,-3)4 ( 52,0)(4,-3)4 ( 52,0)(4,-3)4 ( 52.1,-0.1)(4,-3)4 ( 52.1,0.1)(4,-3)4 ( 51.9,-0.1)(4,-3)4 ( 76,0)(4,-3)4 ( 76,0)(4,-3)4 ( 76.1,-0.1)(4,-3)4 ( 76.1,0.1)(4,-3)4 ( 75.9,-0.1)(4,-3)4 ( 2,54)(0,1)6 ( 2,50)(0,-1)6 ( 74,54)(0,1)6 ( 74,50)(0,-1)6 ( 2,34)(0,1)6 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 74,30)(0,-1)6 ( 2,14)(0,1)6 ( 2,10)(0,-1)6 ( 74,14)(0,1)6 ( 74,10)(0,-1)6 ( 4,2)(1,0)8 ( 16,2)(1,0)8 ( 52,2)(1,0)8 ( 64,2)(1,0)8 ( 0,52)(-1,0)2 ( 72,52)(-1,0)2    ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2    ( 0,12)(-1,0)2 ( 72,12)(-1,0)2    ( 14,4)(0,1)2 ( 62,4)(0,1)2    ( 14,64)(0,1)2 ( 62,64)(0,1)2    ( 4,62)(1,0)8 ( 16,62)(1,0)8 ( 52,62)(1,0)8 ( 64,62)(1,0)8    ( 28,42)(1,0)8 ( 40,42)(1,0)8    ( 38,44)(0,1)2    ( 4,22)(1,0)8 ( 16,22)(1,0)8    ( 52,22)(1,0)8 ( 64,22)(1,0)8    ( 14,24)(0,1)2 ( 62,24)(0,1)2    ( 26,14)(0,1)6 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 50,10)(0,-1)6 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2    ( 28,2)(1,0)8 ( 40,2)(1,0)8    ( 14,44)(0,1)2 ( 62,44)(0,1)2    ( 38,24)(0,1)2    ( 38,64)(0,1)2    ( 38,4)(0,1)2    ( 26,54)(0,1)6 ( 26,50)(0,-1)6    ( 50,54)(0,1)6 ( 50,50)(0,-1)6    ( 24,52)(-1,0)2 ( 48,52)(-1,0)2    ( 28,62)(1,0)8 ( 40,62)(1,0)8 ( 4,42)(1,0)8 ( 16,42)(1,0)8 ( 52,42)(1,0)8 ( 64,42)(1,0)8 ( 28,22)(1,0)8 ( 40,22)(1,0)8    ( 77,73)(0,0 ) ( 0.5,60.5)(3,3)@xmath57 ( 3.5,60.5)(4,-3)4 ( 7.5,54.5)(3,3 ) ( 3.5,62)(1,0)8.5 ( 12,60)(4,4)@xmath37 ( 16,62)(1,0)3 ( 22,62)(1,0)2.5 ( 19,60.5)(3,3)@xmath57 ( 24.5,60.5)(3,3)@xmath57 ( 27.5,60.5)(4,-3)4 ( 31.5,54.5)(3,3 ) ( 27.5,62)(1,0)8.5 ( 36,60)(4,4)@xmath37 ( 40,62)(1,0)3 ( 46,62)(1,0)2.5 ( 43,60.5)(3,3)@xmath57 ( 48.5,60.5)(3,3)@xmath57 ( 51.5,60.5)(4,-3)4 ( 55.5,54.5)(3,3 ) ( 51.5,62)(1,0)8.5 ( 60,60)(4,4)@xmath37 ( 64,62)(1,0)3 ( 70,62)(1,0)2.5 ( 67,60.5)(3,3)@xmath57 ( 72.5,60.5)(3,3)@xmath57 ( 75.5,60.5)(4,-3)4 ( 79.5,54.5)(3,3 ) ( 2,54)(0,1)6.5 ( 0,50)(4,4)@xmath37 ( 0.5,45)(3,3)@xmath57 ( 2,50)(0,-1)2 ( 2,45)(0,-1)1.5 ( 26,54)(0,1)6.5 ( 24,50)(4,4)@xmath37 ( 24.5,45)(3,3)@xmath57 ( 26,50)(0,-1)2 ( 26,45)(0,-1)1.5 ( 50,54)(0,1)6.5 ( 48,50)(4,4)@xmath37 ( 48.5,45)(3,3)@xmath57 ( 50,50)(0,-1)2 ( 50,45)(0,-1)1.5 ( 74,54)(0,1)6.5 ( 72,50)(4,4)@xmath37 ( 72.5,45)(3,3)@xmath57 ( 74,50)(0,-1)2 ( 74,45)(0,-1)1.5 ( 0.5,40.5)(3,3)@xmath57 ( 3.5,40.5)(4,-3)4 ( 7.5,34.5)(3,3 ) ( 3.5,42)(1,0)8.5 ( 12,40)(4,4)@xmath37 ( 16,42)(1,0)3 ( 22,42)(1,0)2.5 ( 19,40.5)(3,3)@xmath57 ( 24.5,40.5)(3,3)@xmath57 ( 27.5,40.5)(4,-3)4 ( 31.5,34.5)(3,3 ) ( 27.5,42)(1,0)8.5 ( 36,40)(4,4)@xmath37 ( 40,42)(1,0)3 ( 46,42)(1,0)2.5 ( 43,40.5)(3,3)@xmath57 ( 48.5,40.5)(3,3)@xmath57 ( 51.5,40.5)(4,-3)4 ( 55.5,34.5)(3,3 ) ( 51.5,42)(1,0)8.5 ( 60,40)(4,4)@xmath37 ( 64,42)(1,0)3 ( 70,42)(1,0)2.5 ( 67,40.5)(3,3)@xmath57 ( 72.5,40.5)(3,3)@xmath57 ( 75.5,40.5)(4,-3)4 ( 79.5,34.5)(3,3 ) ( 2,34)(0,1)6.5 ( 0,30)(4,4)@xmath37 ( 0.5,25)(3,3)@xmath57 ( 2,30)(0,-1)2 ( 2,25)(0,-1)1.5 ( 26,34)(0,1)6.5 ( 24,30)(4,4)@xmath37 ( 24.5,25)(3,3)@xmath57 ( 26,30)(0,-1)2 ( 26,25)(0,-1)1.5 ( 50,34)(0,1)6.5 ( 48,30)(4,4)@xmath37 ( 48.5,25)(3,3)@xmath57 ( 50,30)(0,-1)2 ( 50,25)(0,-1)1.5 ( 74,34)(0,1)6.5 ( 72,30)(4,4)@xmath37 ( 72.5,25)(3,3)@xmath57 ( 74,30)(0,-1)2 ( 74,25)(0,-1)1.5 ( 0.5,20.5)(3,3)@xmath57 ( 3.5,20.5)(4,-3)4 ( 7.5,14.5)(3,3 ) ( 3.5,22)(1,0)8.5 ( 12,20)(4,4)@xmath37 ( 16,22)(1,0)3 ( 22,22)(1,0)2.5 ( 19,20.5)(3,3)@xmath57 ( 24.5,20.5)(3,3)@xmath57 ( 27.5,20.5)(4,-3)4 ( 31.5,14.5)(3,3 ) ( 27.5,22)(1,0)8.5 ( 36,20)(4,4)@xmath37 ( 40,22)(1,0)3 ( 46,22)(1,0)2.5 ( 43,20.5)(3,3)@xmath57 ( 48.5,20.5)(3,3)@xmath57 ( 51.5,20.5)(4,-3)4 ( 55.5,14.5)(3,3 ) ( 51.5,22)(1,0)8.5 ( 60,20)(4,4)@xmath37 ( 64,22)(1,0)3 ( 70,22)(1,0)2.5 ( 67,20.5)(3,3)@xmath57 ( 72.5,20.5)(3,3)@xmath57 ( 75.5,20.5)(4,-3)4 ( 79.5,14.5)(3,3 ) ( 2,14)(0,1)6.5 ( 0,10)(4,4)@xmath37 ( 0.5,5)(3,3)@xmath57 ( 2,10)(0,-1)2 ( 2,5)(0,-1)1.5 ( 26,14)(0,1)6.5 ( 24,10)(4,4)@xmath37 ( 24.5,5)(3,3)@xmath57 ( 26,10)(0,-1)2 ( 26,5)(0,-1)1.5 ( 50,14)(0,1)6.5 ( 48,10)(4,4)@xmath37 ( 48.5,5)(3,3)@xmath57 ( 50,10)(0,-1)2 ( 50,5)(0,-1)1.5 ( 74,14)(0,1)6.5 ( 72,10)(4,4)@xmath37 ( 72.5,5)(3,3)@xmath57 ( 74,10)(0,-1)2 ( 74,5)(0,-1)1.5 ( 0.5,0.5)(3,3)@xmath57 ( 3.5,0.5)(4,-3)4 ( 7.5,-5.5)(3,3 ) ( 3.5,2)(1,0)8.5 ( 12,0)(4,4)@xmath37 ( 16,2)(1,0)3 ( 22,2)(1,0)2.5 ( 19,0.5)(3,3)@xmath57 ( 24.5,0.5)(3,3)@xmath57 ( 27.5,0.5)(4,-3)4 ( 31.5,-5.5)(3,3 ) ( 27.5,2)(1,0)8.5 ( 36,0)(4,4)@xmath37 ( 40,2)(1,0)3 ( 46,2)(1,0)2.5 ( 43,0.5)(3,3)@xmath57 ( 48.5,0.5)(3,3)@xmath57 ( 51.5,0.5)(4,-3)4 ( 55.5,-5.5)(3,3 ) ( 51.5,2)(1,0)8.5 ( 60,0)(4,4)@xmath37 ( 64,2)(1,0)3 ( 70,2)(1,0)2.5 ( 67,0.5)(3,3)@xmath57 ( 72.5,0.5)(3,3)@xmath57 ( 75.5,0.5)(4,-3)4 ( 79.5,-5.5)(3,3 )    ( 8,63)(0,0)[bc]@xmath58 ( 32,63)(0,0)[bc]@xmath59    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60",
    "in a 2d potts model each random variable takes on values in @xmath140 , where @xmath0 is an integer satisfying @xmath141 .",
    "the energy of a configuration @xmath5 is given by the hamiltonian @xmath142 - \\sum_{m = 1}^n \\ !",
    "h_m\\cdot[x_m = 0 ]   \\ ] ]    here , the real coupling parameter @xmath16 controls the strength of the interaction between adjacent variables @xmath17 and the real parameter @xmath18 corresponds to the presence of an external magnetic field .",
    "following  @xcite , we can obtain the ( modified ) dual forney factor graph of the 2d potts model in an external field as in  fig .",
    "[ fig:2dgridpotts ] , where the unlabeled normal - size boxes represent factors as @xmath143 and the unlabeled small boxes have the following form @xmath144    in this paper , we only consider ferromagnetic potts models in a positive external field , characterized by and , respectively .",
    "therefore , all the factors as in ( [ eqn : pottskernelduals ] ) and  ( [ eqn : pottskerneldual2 ] ) will be positive .    to design importance sampling algorithms for the 2d potts model , we need the following lemma .    * lemma 2 .",
    "* if @xmath73 is a valid configuration in the dual forney factor graph of the 2d potts model , then @xmath145    again , to draw the @xmath96-part , we can apply the following subroutine .",
    "* _ draw _ @xmath107 $ ] * * for * @xmath108 * to * @xmath91 * @xmath146 * @xmath110 *   * _ draw _ @xmath147 _ randomly from _ @xmath148 *   * * end for *    here , @xmath149 is equal to @xmath150 . to draw the @xmath95-part",
    ", we can apply the following .",
    "* _ draw _ @xmath121 $ ] * * for * @xmath98 * to * @xmath122 * @xmath151 * @xmath101 *   * _ draw _ @xmath152 _ randomly from _ @xmath148 *   * * end for * * _ set _    here , @xmath153 is equal to @xmath154 . setting @xmath155",
    "is done according to  ( [ eqn : dep ] ) .    after generating @xmath93 , we will update @xmath125 to create a valid configuration @xmath156 .",
    "the samples are used in the importance sampling scheme to estimate @xmath157 .",
    "everything as in fig .",
    "[ fig : ferextern1 ] , but with @xmath158 $ ] for @xmath139 , using algorithm 2 on the dual factor graph . ]    everything as in fig .",
    "[ fig : ferextern1 ] , but with @xmath158 $ ] for @xmath139 , using algorithm 2 on the dual factor graph . ]",
    "the importance sampling schemes of section  [ sec : is ] are applied to estimate the free energy  ( [ eqn : freeenergy ] ) per site , i.e. , @xmath159 , of 2d ising models of size @xmath160 .",
    "all simulation results show @xmath159 vs.  the number of samples for models with periodic boundary conditions , where to create periodic boundary conditions extra edges ( with appropriate factors ) are added to connect the sites on opposite sides of the boundary . in this case ,",
    "@xmath161 .",
    "we consider 2d ferromagnetic ising models in an external field with spatially varying model parameters in section  [ sec : numising1 ] , and 2d ferromagnetic ising models with spatially varying coupling parameters in the absence of an external field in section  [ sec : numising2 ] .",
    "we will also compare the efficiency of the importance sampling scheme and uniform sampling .",
    "this comparison was carried out for models in a strong external field in  @xcite . in the absence of an external field , applying monte carlo methods ( gibbs sampling and uniform sampling ) in the dual domain to 2d ising models is also discussed in  @xcite . in section  [ sec : numpotts ] , we consider 2d potts models of size @xmath160 with periodic boundary conditions",
    ".    comparisons with gibbs sampling  @xcite and the swendsen - wang algorithm  @xcite are discussed in  appendix  ii .      in all the experiments ,",
    "we set @xmath162 $ ] for @xmath163 , and set @xmath164 $ ] .    in the first experiment , we set @xmath165 $ ] for @xmath139 .",
    "simulation results for one instance of the ising model obtained from algorithm 2 are shown in fig .",
    "[ fig : ferextern1 ] , where the estimated free energy per site is about @xmath166 . in the second experiment ,",
    "@xmath167 $ ] for @xmath139 .",
    "for one instance of the model , simulation results obtained from algorithm 2 are shown in fig .",
    "[ fig : ferextern2 ] .",
    "the estimated free energy per site is about @xmath168 .",
    "estimated free energy per site vs.  the number of samples for a @xmath169 ferromagnetic ising model with periodic boundary conditions , where @xmath170 $ ] for @xmath163 , and @xmath171 $ ] for @xmath139 .",
    "the plot shows ten different sample paths obtained from importance sampling . ]",
    "estimated free energy per site vs.  the number of samples for a @xmath169 ferromagnetic ising model with periodic boundary conditions , where @xmath170 $ ] for @xmath163 , and @xmath171 $ ] for @xmath139 .",
    "the plot shows ten different sample paths obtained from importance sampling . ]",
    "we consider 2d ising models in the absence of an external magnetic field , and set @xmath172 $ ] for @xmath139 , in both experiments .",
    "we set @xmath173 $ ] for @xmath163 , in the first experiment .",
    "[ fig : fer1 ] shows simulation results obtained from importance sampling ( solid lines ) and from uniform sampling ( dashed lines ) for one instance of the ising model . from fig .",
    "[ fig : fer1 ] , the estimated free energy per site is about @xmath174 .",
    "as was pointed out in  @xcite , uniform sampling could be employed for models at very low temperature ( i.e. , very large @xmath50 ) , however , for a wider range of model parameters , it has problems with slow and erratic convergence .    in the second experiment ,",
    "we set @xmath175 $ ] for @xmath163 . fig .  [",
    "fig : fer2 ] shows simulation results obtained from importance sampling for one instance of the model . from fig .",
    "[ fig : fer2 ] , the estimated @xmath159 is about @xmath176 .    estimated free energy per site vs.  the number of samples for a @xmath169 4-state potts model in an external field , and with periodic boundary conditions , with @xmath177 $ ] for @xmath163 , @xmath178 $ ] for @xmath139 , and @xmath179 $ ] .",
    "the plot shows ten different sample paths obtained from importance sampling in the dual factor graph . ]      in a 2d @xmath180-state potts model , we set @xmath181 $ ] for @xmath163 and @xmath182 $ ] for @xmath139 . the external field is set to @xmath183 $ ] .",
    "simulation results obtained from importance sampling in the dual factor graph are shown in fig .",
    "[ fig : ferpottsext ] where the estimated free energy per site is about @xmath184 .",
    "it is numerically advantageous to replace each factor  ( [ eqn : isingkerneldual2 ] ) in the dual factor graph by @xmath185 and each factor  ( [ eqn : isingkerneldual ] ) by @xmath186 the required scale factor to recover @xmath80 , can then be computed by multiplying all the local scale factors in terms of @xmath187 and @xmath188 .",
    "note that @xmath189 , therefore the factors in  ( [ eqn : isingkerneltanh2 ] ) tend to constant if @xmath50 is large for @xmath139 , which explains the reason for the fast convergence of the importance sampling schemes in this case . if all the model parameters ( i.e. , @xmath50 and @xmath18 ) are large , ( [ eqn : isingkerneltanh1 ] ) and  ( [ eqn : isingkerneltanh2 ] ) both tend to constant factors . in this case ,",
    "uniform sampling is also expected to exhibit good convergence in the dual domain .",
    "two importance sampling schemes were presented for estimating the partition function of the 2d ferromagnetic ising model .",
    "both schemes are described in the dual forney factor graph representing the model . after introducing auxiliary importance sampling distributions ,",
    "the methods operate by simulating a subset of the variables , followed by doing the computations using the remaining variables .",
    "the schemes can efficiently compute an estimate of the partition function in a wide range of model parameters . with our choices of partitioning ,",
    "this is particularly the case when a subset of the coupling parameters of the model is strong .",
    "the methods of this paper should be compared to the method introduced in  @xcite , where the emphasis is on models in a strong external field .",
    "depending on the value of the model parameters and their spatial distributions , different choices of partitioning yield schemes with different convergence properties .",
    "our schemes once combined with annealed importance sampling are capable of handling more demanding cases , see appendix i. the schemes of this paper are applicable to the three - dimensional ising model too ; see  @xcite for a similar approach . for duality results in the context of statistical physics ,",
    "see  @xcite ,  ( * ? ? ?",
    "* chapter 16 ) ,  ( * ? ? ?",
    "* chapter 10 ) .",
    "we explain how to employ annealed importance sampling in the dual factor graph to estimate the partition function of the 2d ising model , when @xmath50 , for @xmath139 is relatively strong . for simplicity , we assume that the coupling parameters associated with the thick edges , the coupling parameters associated with the thin edges , and the external magnetic field are all constant , denoted by @xmath190 , @xmath191 , and @xmath192 , respectively",
    ".    we thus denote the partition function by @xmath193 , and express @xmath193 using a sequence of intermediate partition functions by varying @xmath191 in @xmath194 levels as @xmath195    here , unlike typical annealing schemes used in the original domain , @xmath196 is an increasing sequence , where @xmath197 .    if @xmath198 is large enough , @xmath199 can be estimated efficiently via the proposed importance sampling schemes of section  [ sec : is ] . as for the intermediate steps , a sampling technique that leaves the target distribution invariant ( e.g. , metropolis algorithms , gibbs sampling  @xcite ) ,",
    "is required at each level .",
    "these intermediate target probability distributions correspond to the intermediate partition functions .",
    "the number of levels @xmath194 should be sufficiently large to ensure that the intermediate target distributions are close enough , and estimating @xmath199 is feasible .",
    "see  @xcite for more details .",
    "we compare the performance of monte carlo methods in the original and in the dual factor graphs to compute the free energy per site , i.e. , @xmath159 , of 2d ising models in the absence of an external field and with constant coupling parameter @xmath39 .    for different values of @xmath39 , the convergence of gibbs sampling  @xcite and the swendsen - wang algorithm  @xcite in the original factor graph ,",
    "is compared to the convergence of uniform sampling and gibbs sampling in the dual factor graph .",
    "we have considered the baseline ( uniform sampling ) in the dual domain .",
    "clearly , convergence of uniform sampling can be significantly improved by applying our proposed importance sampling schemes .",
    "let @xmath35 , where @xmath200 .",
    "we use the following methods to compute an estimate of the partition function as @xmath201      suppose samples @xmath202 are drawn uniformly and independently from @xmath203 .",
    "then @xmath204 is an unbiased estimator for @xmath23 .",
    "i.e. , @xmath205 = z\\ ] ]      let @xmath206    suppose samples @xmath202 are drawn from @xmath203 according to @xmath207 .",
    "then @xmath208 is an unbiased estimator for @xmath209 .",
    "i.e. , @xmath210 = 1/z\\ ] ]    in our numerical experiments , drawing samples according to @xmath207 is done using gibbs sampling or the swendsen - wang algorithm .",
    "these samples are then used in  ( [ eqn : ot ] ) to compute an estimate of @xmath23 .",
    "estimated free energy per site vs.  the number of sample for a @xmath211 ising model with periodic boundary conditions , with @xmath212 .",
    "the plot shows five different sample paths obtained from gibbs sampling ( solid lines ) , and five different sample paths obtained from uniform sampling ( dashed lines ) in the dual factor graph . ]",
    "estimated free energy per site vs.  the number of sample for a @xmath211 ising model with periodic boundary conditions , with @xmath212 .",
    "the plot shows five different sample paths obtained from gibbs sampling ( solid lines ) , and five different sample paths obtained from uniform sampling ( dashed lines ) in the dual factor graph . ]",
    "estimated free energy per site vs.  the number of sample for a @xmath211 ising model with periodic boundary conditions , with @xmath213 .",
    "the plot shows five different sample paths obtained from gibbs sampling ( solid lines ) , and five different samples paths obtained from uniform sampling ( dashed lines ) in the dual factor graph . ]",
    "estimated free energy per site vs.  the number of sample for a @xmath211 ising model with periodic boundary conditions , with @xmath213 .",
    "the plot shows five different sample paths obtained from gibbs sampling ( solid lines ) , and five different samples paths obtained from uniform sampling ( dashed lines ) in the dual factor graph . ]",
    "we consider 2d ising models of size @xmath214 , with periodic boundary conditions .",
    "note that , such a small value of @xmath99 , allows us to compute the exact value of the free energy via direct enumeration .    in the first experiment",
    ", we set @xmath212 ( relatively high temperature ) . in this case , the exact value of the free energy per site ( up to five decimal points ) is @xmath215 .",
    "[ fig : c11 ] shows simulation results obtained from the swendsen - wang algorithm ( solid lines ) and uniform sampling ( dashed lines ) in the original factor graph , and fig .",
    "[ fig : c12 ] shows simulation results obtained from gibbs sampling ( solid lines ) and uniform sampling ( dashed lines ) in the dual factor graph .    in the second experiment , @xmath213 ( relatively low temperature ) , where the exact value of the free energy per site ( up to five decimal points ) is @xmath216 .",
    "simulation results obtained from the swendsen - wang algorithm ( solid lines ) and uniform sampling ( dashed lines ) in the original factor graph are shown in fig .",
    "[ fig : sw ] . simulation results obtained from gibbs sampling ( dashed lines ) and uniform sampling ( solid lines ) in the dual factor graph are shown in fig .",
    "[ fig : c2 ] . in both cases ( i.e. , gibbs sampling in the dual factor graph and the swendsen - wang algorithm in the original factor graph ) , we have used  ( [ eqn : ot ] ) to compute an estimate of @xmath23 .    at high temperature ( i.e. , small @xmath39 )",
    ", we observe faster mixing with monte carlo methods in the original factor graph .",
    "in sharp contrast , uniform sampling and gibbs sampling in the dual factor graph converge extremely well at low temperature ( i.e. , large @xmath39 ) , while monte carlo methods in the original factor graph suffer from slow convergence .",
    "indeed , convergence of monte carlo methods in the dual factor graph improves as @xmath39 increases .",
    "finally , jerrum and sinclair have proposed a randomized algorithm to estimate the partition function of the 2d ising model , which is polynomial - time for _ all _ temperatures  @xcite .",
    "their algorithm uses the high temperature expansion of the partition function , which coincides with the dual domain representation of the ising model in terms of forney factor graph .",
    "however , the computational complexity of their algorithm is @xmath217 .",
    "also their proposed markov chain seems to be different from the schemes of this paper  ( * ? ? ?",
    "* section 4 ) .",
    "the computational complexity of our proposed algorithms is @xmath218 per sample , which makes the total computational complexity @xmath219 .",
    "the author would like to thank hans - andrea loeliger and justin dauwels for their helpful comments .",
    "the author is grateful to pascal vontobel for pointing out  @xcite to him , and for proofreading an earlier draft of this paper .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` partition function of the ising model via factor graph duality , '' _ proc .",
    "2013 ieee int . symp . on information theory , _",
    "istanbul , turkey , july 712 , 2013 , pp ."
  ],
  "abstract_text": [
    "<S> we consider the problem of estimating the partition function of the two - dimensional ferromagnetic ising and potts models in an external magnetic field . the estimation is done via importance sampling in the dual of the forney factor graph representing the models . </S>",
    "<S> we present importance sampling schemes that can efficiently compute an estimate of the partition function in a wide range of model parameters . </S>",
    "<S> emphasis is on models in which a subset of the coupling parameters is strong . </S>"
  ]
}