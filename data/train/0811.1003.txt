{
  "article_text": [
    "peer - to - peer ( p2p ) activity continues to represent a very significant fraction of overall internet traffic , 44% by one recent account @xcite .",
    "bittorrent @xcite is a widely deployed p2p file - sharing network which has recently played a significant role in the network neutrality debate . under bittorrent",
    ", peers join  swarms \" ( or  torrents \" ) where each swarm corresponds to a specific data object ( file ) . the process of finding the peers in a given swarm to connect to is typically facilitated through a centralised  tracker \" .",
    "recently , a trackerless bittorrent client has been introduced that uses distributed hashing for query resolution @xcite .    for file sharing ,",
    "a peer is typically uploads upload pieces (  chunks \" ) of the file to other peers in the swarm while downloading his / her missing chunks from them .",
    "this chunk swapping constitutes a transaction - by - transaction incentive for peers to cooperate ( i.e. , trading rather than simply download ) to disseminate data objects .",
    "large files may be segmented into several hundred chunks , all of which the peers of the corresponding warm must collect , and in the process disseminate their own chunks before they can reconstitute the desired file and possibly leave the file s swarm .",
    "in addition to the framework in which data objects are segmented into chunks to promote cooperation through swapping , there is a system whereby the rate at which chunks are uploaded is assessed for any given transaction , and peers that allocate inadequate bandwidth for uploading may be  choked \" @xcite . choking",
    "may also be applied to peers who , by employing multiple identities ( sybils ) , abuse bittorrent s system of allowing newly arrived peers to a swarm to just download a few chunks ( as they clearly can not trade what they simply do not as yet possess ) .",
    "bittorrent can also rehabilitate peers by ( optimistically ) unchoking them . in the following",
    ", we do not directly consider upload bandwidth and related choking issues .    in this paper , we motivate a deterministic epidemiological model of file dissemination for peer - to - peer file - sharing networks that employ bittorrent - like incentives , a generalisation of that given in @xcite .",
    "our model is different from those explored in @xcite for bittorrent , and we compute different quantities of interest . our epidemiological framework , similar to that we used for the spread of multi - stage worms @xcite , could also be adapted for network coding systems . in @xcite , the authors propose a  fluid \" model of a single torrent / swarm ( as we do in the following ) and fit it to ( transient ) data drawn from aggregate swarms .",
    "the connection to branching process models @xcite is simply that ours only tracks the number of active peers who possess or demand the file under consideration , i.e. , a single swarm .",
    "though our model is significantly simpler than that of prior work , it is derived directly from an intuitive transaction - by - transaction markov process modelling file - dissemination of the p2p network and its numerical solutions clearly demonstrate the effectiveness of the aforementioned incentives .",
    "a basic assumption in the following is that peers do not distribute bogus files ( or file chunks ) @xcite .",
    "this paper is organised as follows .",
    "the markovian model is developed in detail in section [ stoch - sec ] .",
    "a proof of its fluid limit is described in section [ fluid - limit - sec ] ( and in the appendix ) including lyapunov stability and settling time results .",
    "the behaviour of the limiting ode is studied in section [ odebeh ] for specific examples . in section [ incentives - sec ] ,",
    "we derive conditions under which the bittorrent - like system has improved performance ( smaller mean time to completely acquire the file by a peer ) compared to a system of pure client - server ( no chunk - swapping ) interactions .",
    "a diffusion approximation is given in [ diff - sec ] .",
    "the paper concludes with a discussion of open problems in section [ concl - sec ] .",
    "we fix a set @xmath0 ( a file ) which is partitioned into @xmath1 ( on the order of hundreds ) pieces called chunks .",
    "consider a large networked  swarm \" of @xmath2 nodes called peers .",
    "each peer possesses a certain ( possibly empty ) subset @xmath3 of @xmath0 .",
    "as time goes by , this peer interacts with other peers , the goal being to enlarge his set @xmath3 until , eventually , the peer manages to collect all @xmath1 chunks of @xmath0 .",
    "the interaction between peers can either be a download or a swap ; in both cases , chunks are being copied from peer to peer and are assumed never lost .",
    "a peer will stay in the network as long as he does not possess all chunks . after collecting everything , sooner or later a peer departs or switches off . by splitting the desired file into many chunks",
    "we give incentives to the peers to remain active in the swarm for long time during which other peers will take advantage of their possessions .",
    "we here describe how two peers , labelled @xmath4 , interact .",
    "the following types of interactions are possible :    1 .",
    "* download : * peer @xmath3 downloads a chunk @xmath5 from @xmath6 .",
    "this is possible only if @xmath3 is a strict subset of @xmath6 .",
    "if @xmath7 then , after the downloading @xmath3 becomes @xmath8 and but @xmath6 remains @xmath6 because it since it gains nothing from @xmath3 .",
    "denote this interaction as : @xmath9 the symbol on the left is supposed to show the type of interaction and the labels before it , while the symbol on the right shows the labels after the interaction .",
    "swap : * peer @xmath3 swaps with peer @xmath6 . in other words , @xmath3 gets a chunk @xmath10 from @xmath6 and @xmath6 gets a chunk @xmath5 from @xmath3 . it is required that @xmath10 is not an element of @xmath3 and @xmath5 not an element of @xmath6 .",
    "we denote this interaction by @xmath11 where @xmath12 , @xmath13 .",
    "we thus need @xmath14 and @xmath15 .",
    "the set of all combinations of @xmath1 chunks , which partition @xmath0 , is denoted by @xmath16 , where @xmath17 and the empty set is included .",
    "we write @xmath18 ( respectively , @xmath19 ) when @xmath3 is a subset ( respectively , strict subset ) of @xmath6 .",
    "we ( unconventionally ) write @xmath20 if @xmath21 , we use @xmath22 instead of @xmath23 ; if @xmath24 is a singleton , we often write @xmath25 instead of @xmath26 . if @xmath18 we use @xmath27 instead of @xmath28 .",
    "we say that @xmath29 if this is not the case , we write @xmath30 .",
    "note that @xmath30 if and only if two peers labelled @xmath3 , @xmath6 can swap chunks .",
    "the space of functions ( vectors ) from @xmath16 into @xmath31 is denoted by @xmath32 .",
    "the stochastic model will take values in this space .",
    "the deterministic model will evolve in @xmath33 .",
    "we let @xmath34 be the vector with coordinates @xmath35 for @xmath36 or @xmath33 we let @xmath37 . if @xmath38 then the @xmath39-face @xmath40 of @xmath33 is defined by @xmath41 .",
    "we follow the logic of stochastic modelling of chemical reactions or epidemics and assume that the chance of a particular interaction occurring in a short interval of time is proportional to the number of ways of selecting the peers needed for this interaction @xcite .",
    "accordingly , the interaction rates _ must _ be given by the formulae described below .",
    "consider first finding the rate of a download @xmath42 , where @xmath19 , when the state of the system is @xmath43 .",
    "there are @xmath44 peers labelled @xmath3 and @xmath45 labelled @xmath6 .",
    "we can choose them in @xmath46 ways .",
    "thus the rate of a download @xmath42 that results into @xmath3 getting _ some _ chunk from @xmath6 should be proportional to @xmath46 .",
    "however , we are interested in the rate of the _ specific _ interaction @xmath47 , that turns @xmath3 into a specific set @xmath48 differing from @xmath3 by one single chunk @xmath49 ; there are @xmath50 chunks that @xmath3 can download from @xmath6 ; the chance that picking one of them is @xmath51 .",
    "thus we have : @xmath52 where @xmath53 .",
    "consider next a swap @xmath54 and assume the state is @xmath55 . picking two peers",
    "labelled @xmath3 and @xmath6 ( provided that @xmath30 ) from the population is done in @xmath46 ways",
    ". thus the rate of a swap @xmath54 is proportional to @xmath46 .",
    "so if we _ fix _ two chunks @xmath56 and specify that @xmath57 , then the chance of picking @xmath5 from @xmath58 and @xmath10 from @xmath59 is @xmath60 .",
    "thus , @xmath61 where @xmath62 .",
    "having defined the rates of each individual interaction we can easily define rates @xmath63 of a markov chain in continuous time and state space @xmath32 as follows .",
    "define functions @xmath64 by :    [ lllmmmm ] @xmath65 ~{{\\text{\\large $ \\mathfrak 1$}}}(a \\sqsubset a ' )              \\label{lll } \\\\",
    "& \\mu_{a , b}(x )         : = \\gamma   \\frac{x^a x^b}{|a \\setminus b| |b \\setminus a| } ~{{\\text{\\large $ \\mathfrak 1$}}}(a \\not \\sim b ) .",
    "\\label{mmm}\\end{aligned}\\ ] ]    consider also constants @xmath66 and @xmath67 for @xmath68 , i.e. , @xmath69 .",
    "the transition rates of the closed conservative markov chain are given by : @xmath70 where @xmath55 ranges in @xmath32 .",
    "a little justification of the first two cases is needed : that @xmath71 is straightforward .",
    "it corresponds to a swap , which is only possible when @xmath72 .",
    "the swap rate was defined by ( sr ) . to see that @xmath73 we observe that a peer labelled @xmath3 can change its label to @xmath74 by downloading a chunk from some set @xmath75 that contains @xmath48 , so we sum the rates ( dr ) over all these possible individual interactions to obtain the first line in .",
    "we can think of having poisson process of arrivals of new peers at rate @xmath76 , and that each arriving peer is labelled @xmath3 with probability @xmath77 .",
    "peers can depart , by definition , only when they are labelled @xmath0 and it takes an exponentially distributed amount of time ( with mean @xmath78 ) for a departure to occur .",
    "we shall let @xmath80 denote the generator of the chain , i.e.@xmath81 , when @xmath82 is an appropriate functional of the state space .",
    "[ bittorrent[@xmath83 ] given @xmath84 ( initial configuration ) , @xmath85 ( number of chunks ) , @xmath86 ( arrival rates ) , @xmath53 ( download rate ) , @xmath87 ( swap rate ) , @xmath66 ( departure rate ) we let bittorrent[@xmath83 be a markov chain @xmath88 with transition rates and @xmath89 .",
    "we say that the chain ( network ) is if @xmath90 for at least one @xmath3 and @xmath91 ; it is if @xmath92 for all @xmath3 ; it is if it is closed and @xmath93 ; it is if it is closed and @xmath94 .    in a conservative network",
    ", we have @xmath95 if @xmath96 and",
    "so @xmath97 for all @xmath98 . here",
    ", the actual state space is the simplex @xmath99 where @xmath100 .",
    "it is easy to see that the state @xmath101 is reachable from any other state , but all rates out of @xmath101 are zero .",
    "hence a conservative network has @xmath101 as a single absorbing state .    in a dissipative network",
    ", we have @xmath102 for all @xmath98 . here",
    "the state space is @xmath103 where @xmath100 .",
    "it can be seen that a dissipative network has many absorbing points .    in an open network",
    ", there are no absorbing points . on the other hand",
    ", one may wonder if certain components can escape to infinity .",
    "this is not the case :    if @xmath104 then the open bittorrent[@xmath105 is positive recurrent markov chain .",
    "( sketch ) if @xmath104 , @xmath106 the markov chain is irreducible . the remainder of the proof is based on a the construction of a simple lyapunov function : @xmath107 for which it can be shown that there is a bounded set of states @xmath108 such that @xmath109 perhaps the easiest way to see this is by appealing to the stability of the corresponding ode limit ; see theorem [ odeapprox ] below and @xcite .",
    "let us take the special case where the file consists of a single chunk @xmath111 .",
    "the state here is @xmath112 .",
    "the rates are : @xmath113 if @xmath114 , this is the stochastic version of the classical ( closed ) kermack - mckendrick ( or susceptible - infective - removed ( sir ) ) model for a simple epidemic process @xcite .",
    "its absorbing points are states of the form @xmath115 . in epidemiological terminology",
    ", @xmath116 is the number of infected individuals , whereas @xmath117 is the number of susceptible ones .",
    "contrary to the epidemiological interpretation , infection _ is _ desirable , for infection is tantamount to downloading the file .",
    "analysing the markov chain in its original form is complicated .",
    "we thus resort to a first - order approximation by an ordinary differential equation ( ode ) .",
    "let @xmath118 be the vector field on @xmath33 with components @xmath119 defined by @xmath120 where @xmath121 consider the differential equation @xmath122 consider the sequence of stochastic models bittorrent[@xmath123 for @xmath124 and let @xmath125 be the corresponding jump markov chain .",
    "[ odeapprox ] there is a has a unique smooth ( analytic ) solution to ( [ ode0 ] ) , denoted by @xmath126 for @xmath98 .",
    "also , if there is an @xmath127 such that @xmath128 as @xmath129 , then for any @xmath130 , @xmath131    let @xmath132 be the set of vectors @xmath133 , @xmath134 , @xmath135 , @xmath136 , where @xmath137 and @xmath138 , @xmath139 . from",
    ", we have that @xmath95 if @xmath140 .",
    "introduce , for each @xmath141 , a unit rate poisson process @xmath142 on the real line , and assume that these poisson processes are independent .",
    "consider the markov chain @xmath143 for the bittorrent[@xmath144 .",
    "its rates are of the form @xmath145 where @xmath146 is a polynomial in @xmath147 variables of degree @xmath148 , and which can be read directly from ; its coefficients depend on the parameters @xmath149 , @xmath150 , @xmath151 , @xmath152 .",
    "we can represent @xcite @xmath143 as : @xmath153 consider now the markov chain @xmath154 corresponding to to bittorrent[@xmath155 .",
    "the transition rates for @xmath154 are @xmath156 and @xmath157 , otherwise . here , @xmath146 is the polynomial defined through and and we now assume that its variables range over the reals . therefore , @xmath154 can be represented as @xmath158 define @xmath126 by the ( deterministic ) integral equation @xmath159 and assume that it is unique for all @xmath98 .",
    "fix a time horizon @xmath160 and let @xmath161 we then have : @xmath162",
    "\\\\ + \\sum_{\\zeta \\in \\nn } \\zeta \\int_0^t \\big ( q_\\zeta(x_{\\nn , s}/n ) - q_\\zeta(x_s ) \\big ) ds\\end{gathered}\\ ] ] suppose that @xmath163 .",
    "then , for all @xmath164 , @xmath165 so , if we let @xmath166,\\ ] ] we have , by the gronwall - bellman lemma , that @xmath167 let @xmath168 we recall that , as @xmath129 , @xmath169 if @xmath170 , we have @xmath171 ( definition of @xmath172 ) and so @xmath173 , implying that @xmath174 which converges to zero , a.s . ,",
    "since @xmath175 we have @xmath176 so we have @xmath177 a.s .    to show that @xmath126 , defined via , satisfies",
    "the ode @xmath178 with @xmath179 given by is a matter of straightforward ( but tedious ) algebra , see the appendix .",
    "uniqueness and analyticity of the solution of the ode is immediate from the form of the vector field ( its components are polynomials of degree 2 and hence locally lipschitzian ) .    to show that the trajectories do not explode , we consider the function @xmath180 it is a matter of algebra to check that @xmath181 which ( since @xmath106 ) is negative and bounded away from zero for @xmath55 outside a bounded set of @xmath33 containing the origin .",
    "we then apply the lyapunov criterion for odes to conclude that @xmath126 is defined for all @xmath98 and this justifies the fact that we could choose an arbitrary time horizon @xmath182 earlier in the proof .    [ [ comment ] ] _ comment : _ + + + + + + + + + +    the quantities defined in , have physical meanings as follows : @xmath183 it is helpful to keep these in mind because they aid in writing down the various parts of @xmath118 , again , see the appendix .",
    "concerning the ode @xmath178 we consider again three cases , just as in the stochastic model : an open system ( @xmath184 for at least one @xmath3 and @xmath106 ) , a closed dissipative system ( @xmath92 for all @xmath3 and @xmath106 ) , and a closed conservative system ( @xmath92 for all @xmath3 and @xmath93 ) .",
    "qualitatively , the behaviour is different in each case . in this section",
    ", we will try to exemplify this behaviour by means of examples .",
    "absence of bittorrent incentives means that the file is not split into chunks , i.e.  @xmath110 .",
    "thus , the markov chain is @xmath185 , i.e.two-valued @xmath186 .",
    "the rates for this case were reported earlier in . to find the fluid limit , we use and , keeping in mind the interpretation of each of the terms in .    for @xmath187",
    ", we have : the number of peers from which an @xmath188-peer can download from is @xmath189 ; the number of peers that can swap with an @xmath188-peer is @xmath190 ; since no peer can assume value @xmath188 after an interaction , we have @xmath191 .",
    "hence , in the formula for for @xmath192 only the first parenthesis survives : @xmath193 for @xmath194 we have : @xmath195 , @xmath196 , @xmath197 .",
    "thus , @xmath198 here , by simply letting @xmath199 and @xmath200 , the ode is @xmath201 if @xmath202 ( closed conservative system ) , we have @xmath203=constant , say @xmath204 , and @xmath205 the solution of which is the logistic function ,    [ cols=\"<,^ , > \" , ]     assume @xmath206 . notice that the integral curves are monotonic as long as they start from a point @xmath207 with @xmath208 .",
    "they eventually converge to a point of the form @xmath209 where @xmath210 in other words , @xmath211 as @xmath212 and , in fact , does so exponentially fast .",
    "notice that if the initial state is in the interior of the positive orthant then the boundary can not be reached in finite time .",
    "this is in contrast to the corresponding stochastic model which can reach the boundary in finite time with positive probability .",
    "in fact , in the open case , it will reach the boundary in finite time with probability @xmath213 due to ( positive ) recurrence .",
    "this remark is generic : it applies to any dimension .",
    "next , consider the open system case assuming , for simplicity , that @xmath214 , but @xmath215 .",
    "we have @xmath216 since @xmath91 , the lyapunov function argument shows that the system is asymptotically stable .",
    "in fact , there is a unique asymptotic equilibrium which attracts all initial conditions @xmath207 with @xmath217 .",
    "this unique equilibrium is given by @xmath218 as can be seen by setting the right hand side of the ode equal to zero @xcite .",
    "it should be noticed that the trajectories can be spirals around @xmath219 .",
    "a typical situation is shown below .    in this vector field plot",
    ", we took @xmath220 , @xmath221 , @xmath222 , so @xmath223 . if @xmath224 then the trajectory converges to infinity . indeed ,",
    "if no peers initially possess the file and no such peers ever show up , then the only thing that can happen is an accumulation , at rate @xmath225 , of ever demanding peers .",
    "the remedy is , clearly , the imposition of @xmath226 no matter how small ; then @xmath219 is globally attracting for all initial states in the closed positive orthant .    in this last example , we find that the eigenvalues of the differential of the vector field at @xmath219 are complex conjugates if and only if @xmath227 , and so this is the condition for the spiralling of trajectories .      here",
    "@xmath3 can take @xmath229 values : @xmath188 , @xmath230 , @xmath231 , @xmath232 .",
    "we work out the expression for each component separately .",
    "since an @xmath188-peer can only download from @xmath233 peers and indexes 1 and 2 represent the chunks that form a partition of @xmath0 . ] , but no peer can download from it or swap with it , we have @xmath234 , and so @xmath235 a @xmath213-peer can download from @xmath236 peers ; it can swap with @xmath237 peers ; the number of peers that take value @xmath213 after a download is @xmath238 ; and , since no peer can take the label @xmath213 after a swap , we have @xmath239 @xmath240 .",
    "we thus have @xmath241 the expression for @xmath242 is symmetric to that of @xmath243 .",
    "a @xmath244-peer can neither download from or swap with anyone , so @xmath245 ; there are @xmath246 peers which can take label @xmath244 after a download ; since only a @xmath148-peer can assume label @xmath244 after a swap , we have @xmath247 ; and , for the same reason , @xmath248 .",
    "thus , @xmath249 we thus have , @xmath250    [ [ case-1-closed - conservative - system . ] ] case 1 : closed conservative system .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider the @xmath228 case again , and assume that @xmath251 for all @xmath3 , @xmath93 ( a closed conservative system ) .",
    "assume further that @xmath252 .",
    "let @xmath253 we see a reduction in dimension from @xmath229 to @xmath254 ( owing to that fact that the sum of the coordinates is constant ) and a further reduction from @xmath254 to @xmath148 ( owing to the fact that , for @xmath252 , the vector field depends on @xmath116 , @xmath255 through their sum ) .",
    "we have : @xmath256 on assuming that @xmath257 and eliminating the variable @xmath258 we obtain @xmath259 we can qualitatively see the behaviour of this ode by looking at the vector field in the @xmath260 plane .",
    "a typical picture is as follows :    the first is an autonomous equation , encountered earlier .",
    "its solution is @xmath261 . letting @xmath262",
    "we have @xmath263 assume that @xmath264 , i.e.  @xmath265 .",
    "the solution of the last ode is : @xmath266 hence @xmath267 we have @xmath268 , as expected . from this",
    ", we can estimate the time @xmath269 required for the system to reach the set @xmath270 , where @xmath271 is a given ( small ) number .",
    "this time can be translated into an estimate for the expected time required for the original stochastic system to be absorbed by the state where all peers possess the full file .",
    "we shall not attempt the justification of this statement here .",
    "the time @xmath272 is the solution of the transcendental equation @xmath273 typical behaviour of this time as a function of @xmath274 is as follows :    the three graphs correspond to varying values of @xmath150 ranging from @xmath213 ( top curve ) to @xmath275 ( bottom curve ) and to @xmath276 , @xmath277 .",
    "[ [ case-2-closed - dissipative - system . ] ] case 2 : closed dissipative system .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider again the @xmath228 case with no arrivals , with swap rate @xmath151 equal to zero , but with departure rate @xmath106 .",
    "using the same notation as above , we have @xmath278 to substitute out one parameter , change the time variable to @xmath279 , let @xmath280 , and write @xmath281 for @xmath282 , so that @xmath283    assume @xmath284 so @xmath285 for all @xmath286 .",
    "we can not eliminate the variable @xmath258 now since there is no obvious conserved quantity , but we can study the equilibria of the system .",
    "it seems that the ode has no obvious analytical solution .",
    "however it can either be integrated numerically or its solution in terms of power series can be easily found . setting the right hand side equal to zero",
    "we see that , necessarily , @xmath287 , which leaves us with the possibility @xmath288 .",
    "so points of the form @xmath289 are equilibria .",
    "but not all of them are stable . for example , any point of the form @xmath290 with @xmath291 is an unstable equilibrium .",
    "specifically , the differential of the vector field is given by @xmath292 evaluated at @xmath290 , it gives @xmath293 , and this has eigenvalues @xmath294 .",
    "evaluated at @xmath295 , it gives @xmath296 , and this has eigenvalues @xmath297 .",
    "therefore , the only stable equilibria are points of the form @xmath298 in terms of the original variables , the stable equilibria are @xmath299 this is as expected : since there is no swapping ( @xmath252 ) , the system eventually settles to a situation where there are peers with label @xmath213 and peers with label @xmath148 . had @xmath151 been positive , @xmath116 , @xmath255 could not have simultaneously been positive in equilibrium .",
    "[ [ case-3-open - system . ] ] case 3 : open system .",
    "+ + + + + + + + + + + + + + + + + + + +    consider the situation as in case 2 , but add arrivals of peers ( known as seeds ) possessing the full file .",
    "choosing variables appropriately , we have @xmath300 in terms of the original variables , we here have @xmath301 , @xmath302 . here",
    "we see that the system eventually settles to the stable equilibrium @xmath303 we can easily see that the eigenvalues of the differential of the vector field at the stable equilibrium are both real and negative : @xmath304 and @xmath305 ( the first one has algebraic multiplicity 1 but geometric multiplicity 2 ) . hence there is no possibility of spiralling .      estimating the time for the system to reach an equilibrium requires cooking up an appropriate lyapunov function .",
    "the obvious lyapunov function used earlier gives a crude lower bound .    consider a general deterministic system ( open or closed ) , i.e.  the differential equation @xmath178 with @xmath118 given by .",
    "let @xmath306 .",
    "then @xmath307 where @xmath308 is the total arrival rate . using the naive inequality @xmath309 we obtain the following :    if the system starts from @xmath274 and if @xmath310 then the time @xmath311 required for the trajectory to reach an @xmath312-ball centred at @xmath313 satisfies @xmath314    in the other direction , consider the last component @xmath315 of the vector field . since no seed ( @xmath0-peer ) can download or swap , we have @xmath316 .",
    "so @xmath317 where @xmath318 is a quadratic form with positive coefficients .",
    "assume that the system is closed , so that @xmath319 in particular .",
    "let @xmath320 be an upper bound on @xmath318 , i.e. , a ( good ) bound that depends on the initial state @xmath274 and the parameters @xmath321 .",
    "if the system is closed and @xmath322 , then @xmath323    we conjecture that @xmath324 decreases along the trajectory @xmath126 as long as @xmath325 .",
    "if so , the bound above is @xmath326 .",
    "we address the following question : when is it advantageous to split a file into chunks ?",
    "in other words , assuming we fix certain system parameters ( e.g. , arrival rates ) , will peers acquire the file faster if the file is split into chunks ?",
    "we attempt here to answer the question in a simple case only by using the deterministic approximation .",
    "let @xmath225 be the total peer arrival rate .",
    "let @xmath150 be the download rate .",
    "assume that only @xmath327 peers arrive exogenously . in the absence of bittorrent incentives",
    ", we have the single - chunk case @xmath328 the globally attracting stable equilibrium is given by @xmath329 consider splitting into @xmath228 chunks .",
    "let @xmath330 be the state of the system .",
    "suppose that the new parameters are @xmath331 , @xmath332 , @xmath333 , @xmath334 .",
    "then @xmath335 the new equilibrium is easily found to be @xmath336 where @xmath337 is the positive number which solves @xmath338 and @xmath339 to see this , set the vector field equal to zero and solve for @xmath340 , @xmath341 .",
    "the simplest way to obtain the solution is by first adding the equations ; this gives @xmath342 whence @xmath343 .",
    "then add the middle two equations after setting @xmath344 : @xmath345 replace @xmath346 by @xmath347 and observe that , due to symmetry , @xmath348 .",
    "this gives the quadratic equation @xmath349 with @xmath350 defined by .",
    "finally , the first equation becomes @xmath351 which is solved for @xmath352 giving : @xmath353 thus :    if @xmath354 then @xmath355    so , by introducing splitting into chunks , we have fewer peers who have no parts of the file at all . using little s theorem ( see below ) , this can be translated into smaller waiting time from the time a peer arrives until he gets his first chunk .",
    "suppose now we are interested in determining how long it will take for a newly arrived peer to acquire the full file .",
    "on the average , a peer spends time equal to @xmath356 before it exits the system . during last part of his sojourn interval ( which is a random variable with mean @xmath78 ) ,",
    "the peer possess the full file .",
    "it thus takes on the average @xmath357 for a peer to acquire the full file . since we assume that @xmath331 , @xmath332 , it suffices to show that @xmath358 but @xmath359 - \\left[\\frac{\\delta}{{\\widetilde}\\beta } \\big(\\frac{\\delta}{\\lambda}u+1 \\big)^{-1 } + u + \\frac{\\lambda}{\\delta}\\right ] \\\\ & = \\frac{\\delta}{\\beta }   - \\frac{\\delta}{{\\widetilde}\\beta}\\big(\\frac{\\delta}{\\lambda}u+1 \\big)^{-1 }   -u -\\frac{\\lambda}{\\delta } \\\\ & = \\big(\\frac{\\delta}{\\lambda}u+1 \\big ) \\left [ \\big(\\frac{\\delta}{\\beta}-\\frac{\\delta}{{\\widetilde}\\beta}\\big ) + \\big(\\frac{\\delta^2}{\\beta \\lambda}-1\\big ) u -\\frac{\\delta}{\\lambda } u^2 \\right]\\end{aligned}\\ ] ] recalling @xmath360 solves @xmath349 .",
    "so , @xmath361 if and only if @xmath362 define @xmath363 as the unique positive number which satisfies @xmath364    [ incentives - coro ] if @xmath354 , a necessary and sufficient condition for @xmath365 is @xmath366 .",
    "this gives a set of non - vacuous conditions for achieving improvement of performance by the introduction of bittorrent incentives .",
    "it can be proved that if the parameters @xmath150 , @xmath152 , @xmath333 , @xmath334 are fixed and if @xmath354 then there exists a value @xmath367 such that for all @xmath368 the inequality @xmath366 holds . to prove this",
    ", we observe that @xmath369 and study the behaviour of @xmath370 as a function of @xmath225 in a neighbourhood of zero .",
    "we conjecture that an algebraic condition involving quadratics like @xmath350 and @xmath371 is valid for larger values of @xmath1 also .    to justify the use of deterministic approximation for estimating performance measures , and , specifically , the use of mean values , we need to show that as @xmath129 , we can approximate stationary averages in the original stochastic network by equilibria of the resulting ode .",
    "it is easy to show that the a.s .",
    "convergence to the ode limit can be translated into convergence of the means , using a uniform integrability argument .",
    "namely , @xmath372 { }   x_t \\xrightarrow[t \\to \\infty ] { } x^*,\\ ] ] where the second limit concerns the behaviour of the ode alone . on the other hand , if we fix @xmath2 and look at the asymptotic behaviour of the process @xmath373 as @xmath374 , we have @xmath375 { } \\frac{1}{n } e { \\widetilde}x_n,\\ ] ] where the law of @xmath376 is the stationary distribution of the chain @xmath377 .",
    "it can be proved that @xmath378 , as @xmath129 .",
    "arguments for this will be considered in future work .",
    "more detailed estimates on the discrepancy between the stochastic and deterministic systems can be found in the recent survey paper @xcite .",
    "we can also explain the use of @xmath379 as a measure of the sojourn time in the system of a peer , by first using the approximation outlined above and then appealing to little s law .",
    "this is as follows .",
    "consider an open bittorrent[@xmath380 , i.e.  @xmath381 , @xmath106 .",
    "we know that the markov chain @xmath143 is positive recurrent and has thus a unique stationary distribution .",
    "it makes sense to assess the performance of the network by looking at steady - state performance measures , such as the mean time it takes for an @xmath327-peer to become an @xmath0-peer ( a seed ) .",
    "consider then the process @xmath382 defined to be a stationary markov process with time index @xmath383 and transition rates as those of @xmath143 .",
    "the law of the process @xmath382 is unique .",
    "let @xmath384 be the times at which @xmath3-peers arrive ( and , say , @xmath385 , by convention ) .",
    "these are the points of a stationary poisson process in @xmath383 with rate @xmath386 .",
    "let @xmath387 be the sojourn time in the system of a peer arriving at time @xmath388 .",
    "since , by assumption , a peer departs only after it has acquired the full set , the time @xmath387 is the sum of the times it takes for the peer to become a seed plus the time that the peer hangs out in the system after becoming a seed ( the latter is an exponential time with mean @xmath78 ) . clearly then , for all @xmath389 , @xmath390 using campbell s formula , we obtain @xmath391 where @xmath392 is expectation with respect to @xmath393the palm probability of @xmath394 with respect to the point process @xmath395 .",
    "in particular , with @xmath396 , and @xmath397 , we have that @xmath398 which can be read as : the mean sojourn time of a @xmath327-peer is , in steady state , equal to the mean number of peers in the system divided by the rate of arrivals of @xmath327-peers . if @xmath2 is a parameter of the process as in theorem [ odeapprox ] then , @xmath225 being proportional to @xmath2 , we have that the right hand side converges to something that is proportional to @xmath379 , as required .",
    "using the functional central limit theorem for poisson processes , we can prove , by standard methods , the following : again consider the sequence bittorrent[@xmath399 for @xmath124 , and let @xmath125 be the corresponding jump markov chain .",
    "let @xmath400 be the solution to the ode @xmath178 with initial condition @xmath274 .",
    "let @xmath401 let @xmath402 , @xmath141 , be i.i.d .",
    "standard brownian motions in @xmath383 .",
    "finally , define the ( time - inhomogeneous ) gaussian diffusion process @xmath403 by @xmath404 where @xmath405 is the matrix of partial derivatives of @xmath118 .",
    "[ diffapprox ] if @xmath406 as @xmath129 , where @xmath127 , then the law of @xmath407 ( as a sequence of probability measures in @xmath408 with the topology of uniform convergence on compacta ) converges weakly to the law of @xmath403 .",
    "the proof of this theorem is omitted but the reader is referred to @xcite for the relevant arguments .",
    "we can obtain a computable rate of convergence of the stochastic model to the ode by using a combination of large deviations techniques with the solution of two optimisation problems .",
    "the idea is basically implicit in the proof of theorem [ odeapprox ] and this is the reason we wrote the proof explicitly in terms of the driving poisson processes @xmath142 .",
    "the first problem is so that we obtain an estimate of the maximum value of @xmath409 of @xmath146 . in the case of a closed network , this is a quadratic optimisation problem over the polyhedron @xmath410 .",
    "the second optimisation problem is for an estimate for @xmath411 , which can be translated to an estimate for the norm of the gradient @xmath412 . in the case of a closed network",
    ", we can estimate this by solving a ( large ) number of linear programming problems .",
    "of course , only estimates are needed .",
    "the first one concerns the behaviour of @xmath324 , and was stated at the end of section [ odebeh ] .",
    "the second concerning generalisation of corollary [ incentives - coro ] , was stated in section [ incentives - sec ] .",
    "the third conjecture is more vague : it basically says that we can evaluate the performance improvement by using a large number of chunks ( say 100 ) , by solving a number of quadratic inequalities . to this end , it should be remarked that in a deterministic open network , the unique equilibrium @xmath313 can be found by solving @xmath413 equations in @xmath413 unknowns , provided that the rate of arrivals of @xmath3-peers depends on @xmath3 through its cardinality alone : @xmath414 indeed , by symmetry of the vector field , we see that @xmath415 so if we define @xmath416 we will have @xmath417 hence if we let @xmath418 where @xmath419 and @xmath313 are related as above , then the equations we need to solve are @xmath420      if we are interested not only in the equilibria but also in a more detailed study of the transient behaviour of the ode , then we can obtain a rough idea ( and bounds ) by making the assumption of full symmetry , i.e. ,  we assume that the arrival rates @xmath386 and the initial states @xmath421 depend on @xmath3 only through @xmath422 .",
    "then the trajectory itself @xmath423 depends only on the cardinality of @xmath3 and so we can reduce the ode to an @xmath424-dimensional one . such a symmetrised ode can yield more detailed information on the time to reach a small neighbourhood of the equilibrium point .",
    "( note that our bounds in  [ settle ] are very crude . )",
    "it may be more reasonable in practise to assume that the time it takes for a chunk to be downloaded or swapped is a random variable with a heavy - tailed distribution .",
    "this is not captured by our model .",
    "indeed , the interaction times are not part of our model at all . a new , more detailed",
    ", model should be worked out .",
    "however , a crude capture of this phenomenon is the replacement of the poisson processes @xmath142 by more general point processes , perhaps with heavy - tailed inter - event times .",
    "as long as these processes obey a functional law of large numbers , we can ( by possibly modifying the scaling parameters ) rephrase theorem [ odeapprox ] and repeat the proof in this more general case .",
    "20    b.  cohen . . , berkeley , ca , usa , may 2003",
    "daley and j.  gani . .",
    "cambridge university press , 1999 .",
    "dc info ( distributed systems newsletter ) .",
    "xxii , issue 8 , june 30 , 2008 ; available at : http://www.dcia.info/news/#newsletters    s.n .",
    "ethier and t.g .",
    "wiley , new , york , 1986 .",
    "darling and j.r .",
    "differential equation approximations for markov chains .",
    ", 37 - 79 , 2008 .",
    "s.  foss and t.  konstantopoulos .",
    "an overview of some stochastic stability methods .",
    "journal of the operations research society of japan * 47 * 275 - 303 , 2004 .    z.  ge , d.r .",
    "figueiredo , s.  jaiswal , j.  kurose , and d.  towsley .",
    "modeling peer - to - peer file sharing systems . in _ proc .",
    "ieee infocom _ , san francisco , april 2004 .",
    "l.  guo , s.  chen , z.  xiao , e.  tan , x.  ding and x.  zhang , measurements , modeling and analysis of bittorrent - like systems . in _ proc .",
    "internet measurement conference ( imc ) _ , oct .",
    "g.  kesidis , y.  jin , b.  mortazavi , and t.  konstantopoulos . an epidemiological model for file - sharing with bittorrent - like incentives . in _ proc .",
    "ieee globecom _ ,",
    "g.  kesidis , t.  konstantopoulos and p.  sousi .",
    "modeling file - sharing with bittorrent - like incentives . in _ proc .",
    "ieee icassp _ , honolulu , april 2007 .",
    "g.  kesidis , m.  vojnovic , i.  hamadeh , y.  jin , s.  jiwasurat . a model of the spread of randomly scanning internet worms that saturate access links .",
    "_ acm tomacs _ ,",
    "may 2008 .",
    "t.  kurtz . .",
    "siam , philadelphia , 1981 .",
    "a.  legout , n.  liogkas , e.  kohler and l.  zhang .",
    "clustering and sharing incentives in bittorrent systems . , *",
    "35*(1 ) , june 2007 .",
    "l.  massouli and m.  vojnovic .",
    "coupon replication systems . in _ proc .",
    "acm sigmetrics _ , banff , alberta , canada , 2005 .",
    "p.  maymounkov and d.  mazieres .",
    "kademlia : a peer - to - peer information system based on the xor metric . ,",
    "cambridge , ma , usa , march 2002 .",
    "b.  mortazavi and g.  kesidis . a peer - to - peer content - distribution game with a reputation - based incentive mechanism . in _ proc .",
    "ieee workshop on information theory and its applications ( ita ) _ , uc san diego , feb .",
    "d.  qiu and r.  srikant . modeling and performance analysis of bittorrent - like peer - to -",
    "peer networks . in _ proc .",
    "acm sigcomm _ , portland , oregon , 2004 .",
    "b.  turner .",
    "generalizing bittorrent : how to build data exchange markets ( and profit from them ! ) , jan .",
    "2005 ; + available at : http://www.fractalscape.org/generalizingbittorrent.htm    k.  walsh and e.g.  sirer .",
    "fighting peer - to - peer spam and decoys with object reputation . in _ proc .",
    "workshop on economics of peer - to - peer systems ( p2pecon ) _ , philadelphia , pa , august 2005 .",
    "x.  yang and g.  de veciana .",
    "service capacity of peer to peer networks . in _ proc .",
    "ieee infocom _",
    ", san francisco , 2004 .",
    "we consider the set of vectors @xmath425 for each @xmath141 we define a polynomial @xmath146 , by comparing and : @xmath426 where @xmath427 , @xmath428 are given by , , respectively , and @xmath429 the variable @xmath55 ranges in @xmath32 or in @xmath33 .",
    "the algebra is the same in both cases .",
    "define the drift vector field by @xmath430 . comparing and we have @xmath431 the latter sum appears in , in the course of the proof of theorem [ odeapprox ] .",
    "we shall verify that @xmath432 where @xmath118 is defined by .",
    "consider the terms in the summation @xmath433 involving @xmath434 .",
    "notice that swapping @xmath3 with @xmath6 or @xmath48 with @xmath435 will not change the value of @xmath436 , so we need to make sure to take into account this change only once in the summation .",
    "if we _ simultaneously _",
    "swap @xmath3 with @xmath6 _ and _ @xmath48 with @xmath435 then neither @xmath436 nor the value of @xmath437 will change because , clearly , @xmath438 as readily follows from and .",
    "we now see that to swap @xmath3 with @xmath6 _ without _ swapping @xmath48 with @xmath435 is impossible ( unless @xmath439 ) .",
    "indeed , it is an easy exercise that @xmath440 taking into account this , we write @xmath441 where the @xmath442 appears because each term must be counted exactly once .",
    "the variables @xmath443 in both summations are free to move over @xmath444 ( but notice that restrictions have effectively been pushed in the definitions of @xmath445 , @xmath446 and @xmath447 )",
    ".    since @xmath448 we have @xmath449 call the four sums appearing in this display as @xmath450 , in this order .",
    "we use the definitions , of @xmath445 , @xmath451 and find the components of the vectors @xmath452 by hitting each one with a unit vector @xmath453 , i.e.  by taking the inner products @xmath454 .",
    "we have : @xmath455 where , in deriving the last equality we just observed that the number of sets @xmath48 that contain one more element than @xmath456 and are contained in @xmath6 is equal to @xmath457 , as long as @xmath458 : @xmath459 next , @xmath460 notice that , in the last summation , @xmath456 contains exactly one more element than @xmath3 and is strictly contained in @xmath6 , so @xmath461 . hence @xmath462 for @xmath463",
    ", we have : @xmath464 as for the last term , we have : @xmath465 adding and we obtain the first part of , while and give the second part ."
  ],
  "abstract_text": [
    "<S> in this paper , we propose a stochastic model for a file - sharing peer - to - peer network which resembles the popular bittorrent system : large files are split into chunks and a peer can download or swap from another peer only one chunk at a time . </S>",
    "<S> we prove that the fluid limits of a scaled markov model of this system are of the coagulation form , special cases of which are well - known epidemiological ( sir ) models . </S>",
    "<S> in addition , lyapunov stability and settling - time results are explored . </S>",
    "<S> we derive conditions under which the bittorrent incentives under consideration result in shorter mean file - acquisition times for peers compared to client - server ( single chunk ) systems . </S>",
    "<S> finally , a diffusion approximation is given and some open questions are discussed . </S>"
  ]
}