{
  "article_text": [
    "among all basic combinatorial structures , set partitions are probably one of the most attractive . like their close cousin , the permutations",
    ", they have a remarkably rich combinatorial structure .",
    "this is partly due to the fact that they can be represented in many equivalent way : in terms of words , functions , graphs , placements of non - attacking rooks in a triangular diagram , line diagrams , etc .",
    "( see figure  [ fig : representations ] for some examples ) . during the past decades several statistics ( here , statistic means an integer valued combinatorial parameter ) , also called parameters , on these different representations of set partitions have been introduced and studied .",
    "for instance , natural statistics on set partitions are the number of inversions in restricted growth functions or the numbers of crossings of arcs in linear and circular representations of set partitions . in very rare cases",
    ", one can determine the exact distribution of the statistic ( i.e. , for each @xmath1 , the number of set partitions of @xmath2 which have a certain value of the considered statistic ) , but most often , even though one has good information on the parameter , such as , for example , in form of an explicit formula for the generating function , there is no exact expression for the distribution .",
    "the by far most important descriptive quantity associated to a statistic is its _ average value _",
    "( also called _ mean value _ or _ expectation _ ) .",
    "the purpose of this paper is to compute the average values of several statistics on set partitions .",
    "some of these statistics have been introduced in the literature previously and others are new .",
    "[ fig : representations ]    ( 55,10)(0,-10 ) ( -2,0)(1,0)59 ( 0,0)(0,0)(0,-6)[c]1 ( 5,0)(5,0)(0,-6)[c]2 ( 10,0)(10,0)(0,-6)[c]3 ( 15,0)(15,0)(0,-6)[c]4 ( 20,0)(20,0)(0,-6)[c]5 ( 25,0)(25,0)(0,-6)[c]6 ( 30,0)(30,0)(0,-6)[c]7 ( 35,0)(35,0)(0,-6)[c]8 ( 40,0)(40,0)(0,-6)[c]9 ( 45,0)(45,0)(0,-6)[c]10 ( 50,0)(50,0)(0,-6)[c]11 ( 55,0)(55,0)(0,-6)[c]12 ( 0 , 0)(22.5 , 12)(45 , 0 ) ( 5 , 0)(7.5 , 3)(10 , 0 ) ( 10,0)(20,7)(30,0 ) ( 30,0)(35,5)(40,0 ) ( 20,0)(22.5,3)(25,0 ) ( 25,0)(40,12)(55,0 ) ( 35,0)(42.5,7)(50,0 ) ( 26,-5)(0,-6)[c](a ) linear representation    ( 25,25)(-10,-5 ) ( 0 , 0 ) ( 0 , 10 ) ( 5 , 8.66 ) ( 8.66 , 5 ) ( 10 , 0 ) ( 8.66 , -5 ) ( 5 , -8.66 ) ( 0,-10 ) ( -5 , -8.66 ) ( -8.66 , -5 ) ( -10 , 0 ) ( -8.66 , 5 ) ( -5 , 8.66 ) ( 0 , 12)(0,0)[c]1 ( 6 , 10.39)(0,0)[c]2 ( 10.39 , 6)(0,0)[c]3 ( 12,0)(0,0)[c]4 ( 10.39,-6)(0,0)[c]5 ( 6,-10.39)(0,0)[c]6 ( 0,-12)(0,0)[c]7 ( -6,-10.39)(0,0)[c]8 ( -10.39,-6)(0,0)[c]9 ( -12,0)(0,0)[c]10 ( -10.39,6)(0,0)[c]11 ( -6,10.39)(0,0)[c]12 ( -10,0)(-5 , 5)(0,10 ) ( 5,8.66)(6.83 , 6.83)(8.66,5 ) ( 8.66,5)(4.33 , -2.5)(0,-10 ) ( 0,-10)(-4.33,-7.5)(-8.66,-5 ) ( -8.66,-5)(-1.83,1.83)(5,8.66 ) ( 8.66,-5)(6.83,-6.83)(5,-8.66 ) ( 5,-8.66)(0,0)(-5,8.66)(-5,8.66)(1.83,1.83)(8.66,-5 ) ( -5 , -8.66)(-6.83 , -1.83)(-8.66 , 5 ) ( 0,-15)(0,-1)[c](b ) circular representation    ( 62,60)(-8,0 ) ( 0,0)(1,0)60(0,5)(1,0)55(0,10)(1,0)50 ( 0,15)(1,0)45(0,20)(1,0)40(0,25)(1,0)35 ( 0,30)(1,0)30(0,35)(1,0)25(0,40)(1,0)20 ( 0,45)(1,0)15(0,50)(1,0)10(0,55)(1,0)5 ( 0,0)(0,1)60(5,0)(0,1)55(10,0)(0,1)50 ( 15,0)(0,1)45(20,0)(0,1)40(25,0)(0,1)35 ( 30,0)(0,1)30(35,0)(0,1)25(40,0)(0,1)20 ( 45,0)(0,1)15(50,0)(0,1)10(55,0)(0,1)5 ( 0,10)(6,4)[c ] ( 5,45)(6,4)[c ] ( 10,25)(6,4)[c ] ( 20,30)(6,4)[c ] ( 25,0)(6,4)[c ] ( 30,15)(6,4)[c ] ( 35,5)(6,4)[c ] ( 0,0)(5,-6)[c]@xmath3 ( 5,0)(5,-6)[c]@xmath4 ( 10,0)(5,-6)[c]@xmath5 ( 15,0)(5,-6)[c]@xmath6 ( 20,0)(5,-6)[c]@xmath7 ( 25,0)(5,-6)[c]@xmath8 ( 30,0)(5,-6)[c]@xmath9 ( 35,0)(5,-6)[c]@xmath10 ( 40,0)(5,-6)[c]@xmath11 ( 45,0)(5,-6)[c]@xmath12 ( 50,0)(5,-6)[c]@xmath13 ( 55,0)(5,-6)[c]@xmath14 ( 0,0)(-6,5)[c]@xmath14 ( 0,5)(-6,5)[c]@xmath13 ( 0,10)(-5,5)[c]@xmath12 ( 0,15)(-5,5)[c]@xmath11 ( 0,20)(-5,5)[c]@xmath10 ( 0,25)(-5,5)[c]@xmath9 ( 0,30)(-5,5)[c]@xmath8 ( 0,35)(-5,5)[c]@xmath7 ( 0,40)(-5,5)[c]@xmath6 ( 0,45)(-5,5)[c]@xmath5 ( 0,50)(-5,5)[c]@xmath4 ( 0,55)(-5,5)[c]@xmath3 ( 30,-9)(0,-3)[c](c ) rook placement    ( 54,50)(0,0 ) ( 0,0)(1,0)53 ( 4,0)(0,-6)[c]@xmath3(8,0)(0,-6)[c]@xmath4 ( 12,0)(0,-6)[c]@xmath5(16,0)(0,-6)[c]@xmath6 ( 20,0)(0,-6)[c]@xmath7(24,0)(0,-6)[c]@xmath8 ( 28,0)(0,-6)[c]@xmath9(32,0)(0,-6)[c]@xmath10 ( 36,0)(0,-6)[c]@xmath11(40,0)(0,-6)[c]@xmath12 ( 44,0)(0,-6)[c]@xmath13(48,0)(0,-6)[c]@xmath14 ( 4,-0.5)(0,1)1(8,-0.5)(0,1)1 ( 12,-0.5)(0,1)1(16,-0.5)(0,1)1 ( 20,-0.5)(0,1)1(24,-0.5)(0,1)1 ( 28,-0.5)(0,1)1(32,-0.5)(0,1)1 ( 36,-0.5)(0,1)1(40,-0.5)(0,1)1 ( 44,-0.5)(0,1)1(48,-0.5)(0,1)1 ( 0,0)(0,1)30 ( 0,5)(-4,0)[c]@xmath3(0,10)(-4,0)[c]@xmath4 ( 0,15)(-4,0)[c]@xmath5(0,20)(-4,0)[c]@xmath6 ( 0,25)(-4,0)[c]@xmath7 ( -0.5,5)(1,0)1(-0.5,10)(1,0)1 ( -0.5,15)(1,0)1(-0.5,20)(1,0)1 ( -0.5,25)(1,0)1 ( 4,5)(40,5 ) ( 8,10)(12,10)(28,10)(36,10 ) ( 16,15 ) ( 20,20)(24,20)(48,20 ) ( 32,25)(44,25 ) ( 4,5)(1,0)36(8,10)(1,0)28(20,20)(1,0)28(32,25)(1,0)12 ( 25,-7)(0,-3)[c](d ) line diagram",
    "the central objects of this paper are set partitions .",
    "a partition @xmath15 of a set @xmath16 is a collection of nonempty and mutually disjoint sets @xmath17 whose union is  @xmath16 .",
    "the sets @xmath18 are called the _ blocks _ of the partition , and a partition into  @xmath19 blocks is called a _",
    "@xmath19-partition_. let us denote by @xmath20 the family of all partitions of @xmath16 and by @xmath21 the family of all @xmath19-partitions of @xmath16 .",
    "for instance , @xmath22 consists of the elements : @xmath23 the number @xmath24 of @xmath19-partitions of an @xmath1-set is called _ stirling number of the second kind _ , while the number @xmath25 of all partitions of an @xmath1-set is called _",
    "bell number_. hence , by definition , we have @xmath26 .",
    "almost all statistics considered on set partitions require that the set  @xmath16 to be partitioned is linearly ordered . without loss of generality ,",
    "from now on , we will consider only partitions of subsets of the set @xmath27 of positive integers . with @xmath28:=\\{1,2,\\ldots , n\\}$ ]",
    ", we will set @xmath29)$ ] , @xmath30)$ ] and @xmath31 . a convenient way , called _ standard form _ ( also called _ canonical order _ ) , to write a set partition @xmath32 , @xmath33 , is to arrange the blocks of @xmath15 in increasing order of their minima and each block in increasing order . for instance , the partition @xmath15 of @xmath34 $ ] consisting of the five blocks @xmath35 is written in standard form as @xmath36 .",
    "+ a substantial number of combinatorial statistics on set partitions were defined in terms of the _ _ r__estricted growth function representation for set partitions .",
    "it is well - known that  @xmath37 is the number of surjections from an @xmath1-set to a @xmath19-set .",
    "actually , stirling numbers also count a class of functions , called restricted growth functions . a word ( or equivalently , a mapping ) @xmath38 is said to be a restricted growth function ( rgf for short ) of length @xmath1 and size @xmath19 if :    1 .",
    "@xmath39 , 2 .",
    "@xmath40 for @xmath41 , 3 .",
    "@xmath42 .",
    "the usual way to associate bijectively set partitions of  @xmath28 $ ] into  @xmath19 blocks and  rgf of length  @xmath1 and size  @xmath19 works as follows : to a partition @xmath43 of  @xmath28 $ ] written in standard form , we associate the rgf @xmath44 such that @xmath45 if and only if @xmath46 . for instance , under this correspondence , the partition @xmath36 is sent to the rgf @xmath47 .",
    "the reader who knows the plethora of permutation and word statistics can imagine the amount of statistics that can be defined on set partitions via restricted growth functions .",
    "for instance , several statistics were defined in terms of inversions and noninversions , and more generally , in terms of counting occurrences of patterns in restricted growth functions .",
    "other interesting representations of set partitions suggest other combinatorial parameters .",
    "we will present some of them when they are needed .",
    "computation of average values of combinatorial parameters is often entertaining , but can be a very difficult task in some cases ( for instance , consider the parameter `` length of the longest increasing subsequence '' in permutations ) . in this paper , we will consider some statistics whose computation of their ( at least exact ) average value is not trivial , but not as difficult as the one we mentioned previously .",
    "for instance , two of the parameters considered in the present paper are the numbers of crossings in linear and circular representations of set partitions ( see figure  [ fig : representations ] ) .",
    "a little moment s thought will convince the reader that the computation of their ( at least exact ) average value is not completely trivial .",
    "depending on which statistic on set partitions is considered , it is more or less difficult to find its average value . as an example , let us consider the statistics ` number of blocks ' and ` number of crossings ' .",
    "while a simple direct combinatorial argument gives the average number of blocks in a random set partition of @xmath28 $ ] ( it is equal to @xmath48 ) , a moment s thought will convince the reader that the computation of the average number of crossings in the circular representation of a random set partition of @xmath28 $ ] , which , as we shall see later , is actually equal to @xmath49 is not completely trivial .",
    "perhaps the most natural and powerful approach to deal with average values is to use the linearity of the expectation by finding `` nice decompositions '' of the statistics we consider .",
    "this was done in the author s thesis  @xcite for the average number of crossings in the linear representation of a random set partition .",
    "it turns out that the decomposition used there is shared by a large number of existing statistics on set partitions and that their average values can be obtained almost `` mechanically '' . in order to make these remarks more precise ,",
    "we need additional terminology .    given a subset @xmath33 with cardinality @xmath50 , the _ standardization map _",
    "@xmath51 is the ( unique ) order - preserving bijection @xmath52 $ ] .",
    "when the subset @xmath16 is clear from the context , we will drop the subscript .",
    "we let @xmath51 act element - wise on objects built using @xmath16 as label . for instance , the set partition @xmath53 of  @xmath54 is sent after standardization to the set partition @xmath55 .",
    "[ defn : splittable ] a set partition statistic @xmath56 is said to be a _ z - statistic _ if for any @xmath57 , @xmath58    the terminology is inspired from a paper of galovich and white  @xcite , but originally , the term @xmath59-statistic is for a famous statistic introduced by bressoud and zeilberger  @xcite .",
    "it is worth noting that via the rgf representation , our _ z - statistics _ on set partitions could be seen as @xmath59-statistics on words ( with the definition of galovitch and white ) .",
    "for the present paper , the interest of z - statistics on set partitions is that the computation of their average value in a random partition is essentially equivalent to the computation of their average value in a random 2-partition ( see theorem  [ thm : gfunmean ] ) , the latter being often easier to calculate .",
    "an important number of existing statistics on set partitions are in fact z - statistics . in this paper",
    ", we will compute average values of carlitz s @xmath0-stirling distributions , the numbers of crossings in linear and circular representations , overlappings and embracings , and the number of occurrences of a 2-pattern in restricted growth functions .",
    "the most common @xmath0-analogs of stirling numbers of the second kind found in the literature are probably the @xmath0-stirling numbers @xmath60 and @xmath61 essentially described by carlitz and gould  @xcite .",
    "they can be defined as follows : @xmath62_q\\,s_{n-1,k}(q)\\qquad ( n\\geq k\\geq 1),\\end{aligned}\\ ] ] and @xmath63 , with @xmath64 if @xmath65 or @xmath66 .",
    "our interest in these @xmath0-stirling numbers comes from the fact that they arise as generating functions for the distribution of several statistics on set partitions .",
    "such statistics have been given by milne  @xcite , garsia and remmel  @xcite , sagan  @xcite , wachs and white  @xcite , white  @xcite , leroux  @xcite , de mdicis and leroux  @xcite , ehrenborg and readdy  @xcite , ksavrelof and zeng  @xcite .",
    "this list is probably not exhaustive .",
    "it is natural to ask for the expectation of these `` @xmath0-stirling distributions '' .",
    "we will say that a parameter @xmath67 defined on set partitions has the @xmath0-stirling distribution  @xmath68 ( @xmath69 , respectively ) if its generating function on each @xmath70 is given by @xmath60 ( @xmath61 , respectively ) , i.e. , for any @xmath71 , we have @xmath72    [ thm : mean_qstirling ] let @xmath67 be a parameter with the @xmath0-stirling distribution  @xmath68 .",
    "then the average value @xmath73 of @xmath67 in a random set partition of @xmath28 $ ] satisfies @xmath74 the average value @xmath75 of @xmath67 in a random set partition of @xmath28 $ ] into @xmath19  blocks satisfies @xmath76    note that it is almost immediate to derive from the above results the expectations of the @xmath0-stirling distribution  @xmath69 , which we denoted by @xmath77 and @xmath78 , respectively . indeed , by the relation @xmath63",
    ", we have @xmath79 and thus @xmath80 where the last equality follows from the identity @xmath81 ( for a proof , see e.g.  @xcite ) . +",
    "almost all known statistics with the @xmath0-stirling distribution @xmath68 are in fact z - statistics . in order to prove theorem  [ thm : mean_qstirling ] , we will work with the first known parameter with the distribution @xmath68 : this is the statistic @xmath82 ( originally denoted @xmath83 ) , first introduced by milne ( see  ( * ? ? ?",
    "* section  4 ) ) to answer a question of garsia .",
    "the parameter @xmath82 can also be defined by using the non - attacking rook placement model for set partitions ( see e.g.  @xcite ) .",
    "it is not hard to see that @xmath82 can be defined for a set partition @xmath84 written in standard form by @xmath85 it is easy to see that the parameter @xmath82 is a z - statistic . indeed , for a 2-partition @xmath86 written in standard form , we have @xmath87 whence for @xmath84 we have @xmath88      one of the most widely occurring property of set partitions is the `` noncrossing '' property .",
    "this is essentially due to the important number of works on noncrossing partitions which appear in different fields of mathematics .",
    "the terminology originated probably from the graphical representation of set partitions ( see e.g.  @xcite ) .",
    "the _ linear representation _ of a partition of a set @xmath89 is obtained as follows : draw the elements of @xmath16 in increasing order on a line and join successive elements of each block by arcs drawn in the upper half - plane .",
    "alternatively , the elements may be represented on a circle and circularly successive elements of each block are joined by chords : this is the _ circular representation_. for instance , the linear and circular representations of the partition  @xmath90 are given in figure  [ fig : representations ] .",
    "linear and circular representations of set partitions suggest many statistics .",
    "the most studied is the number of crossings , but other statistics like nestings , alignments , @xmath19-distant crossings , @xmath19-crossings , @xmath19-nestings , etc .",
    "have also appeared in the literature ( see e.g.  @xcite ) .    for a set partition @xmath57",
    ", we will denote by @xmath91 the number of crossings in the linear representation of @xmath15 .",
    "we will refer to such crossings as _ linear crossings _ , in order to distinguish these from the circular case .",
    "formally , a linear crossing is a sequence @xmath92 of edges of @xmath15 , such that @xmath93 . here",
    ", an edge of @xmath15 is just a pair @xmath94 of _ consecutive _ elements @xmath95 in the same block @xmath96 , where consecutive means that there is no element @xmath97 such that @xmath98 .",
    "for instance , if @xmath15 is the set partition represented in figure  [ fig : representations ] , then @xmath99 . in order to show that @xmath100 is a z - statistic , it suffices essentially to observe that a linear crossing is composed of two edges from distinct blocks ( details are left to the reader ) .",
    "[ thm : mean_crossinglinear ] the average number @xmath73 of linear crossings in a random set partition of  @xmath28 $ ] satisfies @xmath101 the average number @xmath75 of linear crossings in a random set partition of  @xmath28 $ ] into  @xmath19 blocks satisfies @xmath102      for a set partition @xmath57 , we will denote by @xmath103 the number of crossings in the circular representation of @xmath15 .",
    "we will refer to such crossings as _",
    "circular crossings_. formally , a circular crossing is a sequence @xmath92 of `` circular edges '' of @xmath15 , such that @xmath104 . here , a circular edge of @xmath15 is a pair @xmath94 such that @xmath105 are consecutive elements in the same block of @xmath15 or @xmath106 and @xmath107 for some block @xmath108 .",
    "for instance , if @xmath15 is the set partition represented in figure  [ fig : representations ] , then @xmath109 . we leave the verification that @xmath110 is a z - statistic to the reader .",
    "[ thm : mean_crossingcircular ] the average number @xmath73 of circular crossings in a random set partition of  @xmath28 $ ] satisfies @xmath111 the average number @xmath75 of circular crossings in a random set partition of @xmath28 $ ] into @xmath19 blocks satisfies @xmath112      flajolet and schott  @xcite considered a special class of set partitions , called _ non - overlapping partitions_. with the implied order structure , two sets  @xmath96 and  @xmath113 are said to overlap if @xmath114 .",
    "then , a partition is said to be _ non - overlapping _ if any two blocks do not overlap .",
    "this property of non - overlapping could be seen graphically by considering the line diagram ( see figure  [ fig : representations ] ) of a set partition .",
    "this suggests to consider statistics like the numbers of overlappings , embracings ( `` nestings of blocks '' ) , etc .",
    "the number of overlappings of a set partition  @xmath15 will be denoted  @xmath115 .",
    "for instance , if @xmath15 is the set partition represented in figure  [ fig : representations ] , then @xmath116 . we leave the verification that  @xmath117 is a z - statistic to the reader .",
    "[ thm : exactmean_ovl ] the average number @xmath73 of overlappings in a random set partition of @xmath28 $ ] satisfies @xmath118    the average number @xmath75 of overlappings in a random set partition of @xmath28 $ ] into @xmath19 blocks satisfies @xmath119      in this section , we consider a natural partner for overlappings .",
    "say that two sets  @xmath96 and  @xmath113 _ embrace _ if , with the implied order structure , @xmath120 .",
    "the number of embracings of a set partition  @xmath15 will be denoted  @xmath121 and can be easily computed via the line diagram representation .",
    "for instance , if @xmath15 is the set partition represented in figure  [ fig : representations ] , then @xmath122 . we leave the verification that  @xmath123 is a z - statistic to the reader .",
    "[ thm : exactmean_emb ] the average number @xmath124 of embracings in a random set partition of @xmath28 $ ] satisfies @xmath125 the average number @xmath75 of embracings in a random set partition of @xmath28 $ ] into @xmath19 blocks satisfies @xmath126      we say that a word @xmath127 in @xmath128 is a @xmath4-pattern if it contains the two letters  @xmath3 and  @xmath4 .",
    "an occurrence of the 2-pattern @xmath129 in a word @xmath130 is an @xmath131-tuple @xmath132 such that @xmath133 , where @xmath134 is the standardization map ( see section  [ sect : standmap ] ) . for instance , in the word @xmath135 , the @xmath5-tuples @xmath136 , @xmath137 and @xmath138 are occurrences of the pattern @xmath139 , while the @xmath5-tuples @xmath140 and @xmath141 are occurrences of the pattern @xmath142 .",
    "the number of occurrences of a pattern @xmath129 in a word @xmath143 will be denoted @xmath144 . since",
    "a set partition can be identified with its restricted growth function , we will set @xmath145 , where @xmath146 is , as usual , the rgf associated to @xmath15 .",
    "we leave the verification that @xmath147 is a z - statistic for any @xmath4-pattern  @xmath129 to the reader .",
    "[ thm : exactmean_occ ] let @xmath127 be a @xmath4-pattern of length @xmath131 , and let @xmath148 denote the average number of occurrences of the pattern @xmath129 in a random set partition of @xmath28 $ ] .",
    "+ ( i ) for fixed @xmath1 , the average value @xmath148 depends only on the first letter of @xmath129 .",
    "+ for @xmath149 , denote by @xmath150 the common value of @xmath151 for patterns @xmath152 ( of length @xmath131 ) satisfying @xmath153 .",
    "\\(ii ) for any integer @xmath154 , we have @xmath155    for @xmath156 , set @xmath157    \\(iii ) for any integer @xmath158 , we have @xmath159    \\(iv ) for any 2-pattern @xmath129 of length @xmath131 , we have the asymptotic approximation @xmath160",
    "\\(v ) for the 2-patterns @xmath129 of length 2 , i.e. , @xmath161 , we have the more precise asymptotic approximation @xmath162    to illustrate our result , we give the values of @xmath163 for 2-patterns  @xmath129 of length @xmath164 . for patterns of length @xmath165",
    ", we have @xmath166    for patterns of length @xmath167 , we have @xmath168    [ thm : exactmeanblock_occ ] let @xmath127 be a @xmath4-pattern of length @xmath131 , and let @xmath169 denote the average number of occurrences of the pattern @xmath129 in a random set partition of @xmath28 $ ] into @xmath19 blocks . + ( i ) for fixed @xmath1 and @xmath19 , the average value @xmath169 depends only on the first letter of @xmath129 .",
    "+ for @xmath149 , denote by @xmath170 the common value of @xmath171 for patterns @xmath152 ( of length @xmath131 ) satisfying @xmath153 .",
    "\\(ii ) for any integer @xmath71 , we have @xmath172    \\(iii ) for any integer @xmath71 , we have @xmath173 where @xmath174 is given by .",
    "+ ( iv ) as @xmath175 , we have the following asymptotic approximations @xmath176    in particular , for any 2-pattern @xmath129 of length @xmath131 , we have @xmath177      in the next section , we will prove the key result of the paper ( theorem  [ thm : gfunmean ] ) , which expresses average values of z - statistics as coefficients in certain generating functions . moreover , there we introduce the tools which are necessary to use our key result .",
    "the purpose of the other sections ( except the last ) is to prove the results presented in section  2 .",
    "finally , we will conclude the paper with some remarks , notably that the methodology could be adapted to other exponential families and to more general statistics .",
    "we said in the previous section that the computation of the average value of a z - statistic in a random set partition is essentially equivalent to the computation of its average value in a random 2-partition .",
    "let us make this more precise . given a z - statistic @xmath67 , let @xmath178 , and let @xmath179 be the exponential generating function of the sequence @xmath180 , i.e. , @xmath181    the following theorem is the key result of the paper .",
    "[ thm : gfunmean ] let @xmath67 be a z - statistic . denote by @xmath73 ( @xmath75 , respectively ) the average value of the statistic @xmath67 in a random set partition of  @xmath28 $ ] ( respectively of  @xmath28 $ ] into @xmath19 blocks ) .",
    "then we have @xmath182\\,v_2^{\\stat}(x)b(x)\\label{eq : thmgfunmean}\\\\ \\mu_{n , k}&=\\frac{1}{s_{n , k}}\\,\\left[\\frac{x^n}{n!}\\right]\\,v_2^{\\stat}(x)s_{k-2}(x),\\label{eq : thmgfunmeanblock}\\end{aligned}\\ ] ] where @xmath25 and @xmath24 are bell and stirling numbers , and @xmath183 and the @xmath184 s are exponential generating functions of bell and stirling numbers defined in   and  .    after coefficient extraction ,",
    "theorem  [ thm : gfunmean ] can lead to exact and asymptotic formulas for average values of z - statistics . for this purpose , we need some tools that we develop in the next subsection .",
    "it is worth noting that , here , by an exact formula , we mean a finite expression which involves elementary functions , and bell and stirling numbers .",
    "we then present a process to get the average and asymptotic value of z - statistics . in a particular case ( which includes all the statistics we consider in this paper ) ,",
    "the algorithm is deterministic",
    ". we will illustrate the process in the third subsection .",
    "finally , we will prove our key result , theorem  [ thm : gfunmean ] , in the last subsection .",
    "recall that the number of @xmath19-partitions of an @xmath1-set is the stirling number of the second kind @xmath24 , and the number of all partitions of an @xmath1-set is the bell number @xmath25 , so that we have @xmath185 . classifying the @xmath19-partitions of an @xmath1-set as to whether they do or do not contain a given element yields the recurrence : @xmath186 with @xmath187 .    as noted previously , the number of surjections from an @xmath1-set @xmath188 to a @xmath19-set @xmath189 is equal to @xmath190",
    ". then , given a set  @xmath191 , @xmath192 , classifying all the maps @xmath193 according to the cardinality of their image leads to the fundamental identity @xmath194 from which , by binomial inversion , we deduce the summation formula @xmath195 here and in the rest of the paper , @xmath196 stands for the @xmath19-th lower factorial @xmath197 .",
    "equation   leads to the generating function identity @xmath198 from which we deduce the double generating function @xmath199 setting @xmath200 , we recover the exponential generating function of bell numbers @xmath201 there are of course many ways to recover all the previous identities .",
    "for instance , one could first obtain the double generating function   immediately from the exponential formula ( a set partition is a `` set of nonempty sets '' in the language of species ) , and then by specializations , coefficient extractions ,  etc .",
    "recover all the previous results and even much more .",
    "given a z - statistic @xmath67 , the first step we have to perform in order to be able to apply theorem  [ thm : gfunmean ] is to try to find a convenient expression for the power series @xmath179 .",
    "it turns out that for all z - statistics which the author was able to locate in the literature , the formal power series @xmath179 is given by @xmath202 where the @xmath203 are polynomials .",
    "therefore , we need to develop some tools to cope with this situation .",
    "elementary computations based on the formulas and show that we have @xmath204 this implies that , for @xmath179 satisfying , there exist polynomials @xmath205 and @xmath206 , @xmath207 , such that @xmath208 suppose we are given a formal power series @xmath209 and let @xmath210 be the @xmath211-th formal derivative @xmath210 of @xmath212 . using the basic facts @xmath213a^{(h)}(x)&=a_{n+h } \\qquad \\left[\\frac{x^{n}}{n!}\\right]x^{i}a(x)=(n)_i a_{n - i } , \\label{eq : extractioncoeff}\\end{aligned}\\ ] ]",
    "coefficient extraction from power series of the form   or   becomes a routine process .",
    "in particular , if @xmath179 satisfies  , it follows by theorem  [ thm : gfunmean ] and   that @xmath73 and @xmath75 are given by @xmath214 where the @xmath215 and @xmath216 are polynomials in @xmath1 which are all zero except for a finite number of them .      in order to obtain asymptotic approximations of the average values @xmath73 and @xmath75 , in view of  , it is important to consider quotients of bell numbers and stirling numbers .",
    "we begin with stirling numbers .",
    "it follows immediately from   that , as @xmath217 , we have @xmath218 from which we deduce that , for @xmath219 , we have @xmath220 distinct the cases @xmath221 and @xmath222 leads to the following result .    [",
    "lem : asymptotic_quotientstirling ] for @xmath223 and @xmath224 , we have , as @xmath175 , @xmath225    the asymptotics of bell numbers is more delicate and is best performed by a saddle - point method .",
    "it is probably the most famous application of saddle - point techniques to combinatorial enumeration .",
    "the bell number @xmath25 satisfies ( see ( * ? ? ? * prop .",
    "viii.3 ) ) @xmath226 where @xmath131 is defined implicitly by @xmath227 , so that @xmath228 . instead of the latter formula",
    ", we will use the following corollary given by salvy and shackell  @xcite : @xmath229 note that the latter identity was established because it gives an asymptotic approximation of the average number of blocks in a random set partition of  @xmath28 $ ] .",
    "it is also worth noting that there exists a more precise asymptotic approximation ( see  @xcite ) which the reader can use to get more precise asymptotic approximations for the average values computed in this paper .",
    "[ lem : asymptotic_quotientbell ] for any integer @xmath230 , we have , as @xmath175 , @xmath231    suppose we are given an integer @xmath232 .",
    "it follows from that @xmath233    by elementary calculus and the well - known formula @xmath234 as @xmath235 , it is easy to establish that @xmath236 and thus @xmath237 combining , , and , we obtain immediately @xmath238 from which we deduce that , for any integer @xmath131 , we have @xmath239 since @xmath240 as @xmath235 .      by theorem  [ thm : gfunmean ] , in order to get the average values @xmath73 and @xmath75 of a z - statistic @xmath67 , we can proceed essentially as follows :    * compute @xmath179 . * extract coefficients from the power series @xmath241 and @xmath242 .",
    "actually , the above process seems to be nondeterministic , since it is a priori not clear whether @xmath179 admits a simple expression ( a finite expression involving elementary functions ) .",
    "however , as we mentioned previously , for all z - statistics on set partitions which the author was able to locate in the literature , the formal power series @xmath179 admits the simple form . for such statistics , one can design a deterministic algorithm .",
    "+ _ input _ : a z - statistic @xmath67 such that @xmath243 , where the @xmath244 are polynomials .",
    "_ output _ : ( a ) the exact average values @xmath73 and @xmath75 , written as finite expressions which involve elementary functions , bell and stirling numbers ; ( b ) asymptotic approximations of @xmath73 and @xmath75 .",
    "step 1_. compute explicitly @xmath179 ( i.e. , determine the polynomials @xmath245 , @xmath246 and @xmath247 ) .",
    "_ step 2_. using   , write @xmath248 and @xmath249 as @xmath250 where the @xmath205 and @xmath206 are polynomials .",
    "_ step 3_. using  , write the coefficients of @xmath248 and @xmath249 as @xmath251v_2^{\\stat}(x)b(x)=\\sum_{i\\in \\mathbb{z}}p_i(n)b_{n+i}\\;\\;\\text{and}\\;\\ ;   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\stat}(x)s_{k-2}=\\sum_{i , j\\geq 0 } q_{i , j } ( n , k ) s_{n - i , k - j},\\end{aligned}\\ ] ] where the @xmath215 and @xmath252 are polynomials in @xmath1 and @xmath19 which are all zero except for a finite number of them .    _ step 4_. divide the expressions obtained in the previous step by @xmath25 and @xmath24 in order to get the average values @xmath73 and @xmath75 , which can be written in the form @xmath251v_2^{\\stat}(x)b(x)=\\sum_{i\\in \\mathbb{z}}p_i(n)\\frac{b_{n+i}}{b_n}\\;\\;\\text{and}\\;\\ ;   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\stat}(x)s_{k-2}=\\sum_{i , j\\geq 0 } q_{i , j } ( n , k ) \\frac{s_{n - i , k - j}}{s_{n , k}}.\\end{aligned}\\ ] ]    _ step 5_. use lemmas  [ lem : asymptotic_quotientstirling ] and",
    "[ lem : asymptotic_quotientbell ] in the expressions obtained in the previous step to get asymptotic approximations of @xmath73 and @xmath75 .",
    "+ a proof that the above process is deterministic can be easily extracted from the previous subsection ( details are left to the reader ) . to make things more concrete",
    ", we give an example in the next subsection .      in his study of some @xmath0-stirling numbers which arose from a @xmath0-exponential formula , johnson  @xcite ( see also  @xcite ) introduced an inversion statistic on set partitions , denoted here by @xmath253 , which can be defined as follows .",
    "for @xmath254 with standard form @xmath255 , @xmath256 is the number of pairs @xmath94 , @xmath257 , such that @xmath258 belongs to a block to the right of the block containing @xmath232 .",
    "equivalently , @xmath256 is the number of inversions in the rgf @xmath146 of @xmath15 . recall that an inversion in a word @xmath259 is a pair @xmath94 , @xmath257 , such that @xmath260 .",
    "for instance , there are exactly 3 inversions in @xmath261 : the pairs @xmath262 , @xmath263 and @xmath264 ; hence @xmath265 .",
    "note that @xmath266 ( where @xmath267 is defined in section  [ section : inversion ] ) .",
    "+ we propose to determine exact and asymptotic average numbers of inversions in a random set partition .",
    "since @xmath253 is a z - statistic , we must first `` compute '' @xmath268 .    by definition",
    ", @xmath268 is the exponential generating function of the sequence @xmath269 with @xmath270 . for a combinatorialist ,",
    "it is usual to interpret @xmath271 as the number of pairs @xmath272 , where  @xmath15 is a 2-partition of @xmath28 $ ] and  @xmath273 is an inversion of  @xmath15 . such a pair will be called an _ underlined _ 2-partition .",
    "an underlined partition @xmath272 with @xmath273 can be identified with the restricted growth function @xmath146 in which the letters @xmath274 , @xmath275 are colored .",
    "for instance , there are 3 inversions in @xmath276 : @xmath277 , @xmath278 and @xmath279 .",
    "then we have @xmath280 , @xmath281 and @xmath282 .",
    "then , using this correspondence , it is not hard to see that an underlined 2-partition @xmath283 can be uniquely written as @xmath284 with @xmath285 . here and in the rest of the paper , we write @xmath286 for the free monoid generated by an alphabet @xmath191 , which is the set of words whose letters are in @xmath191 .",
    "the empty word will be denoted @xmath287 .",
    "elementary counting ( there are @xmath288 choices for the positions of the underlined elements and @xmath289 choices for the word @xmath290 ) leads to @xmath291 a straightforward computation , the details of which are left to the reader , then yields @xmath292    since @xmath268 can be written in the form  , we can continue the process described in the previous subsection .",
    "+ _ step 2 .",
    "_ using   and  , it is straightforward to obtain @xmath293    _ step 3 . _ after routine coefficient extraction based on , we obtain @xmath251v_2^{\\inv}(x)b(x ) & = \\frac{1}{8 } b_{n+2}-\\left(\\frac{n}{4}+\\frac{1}{8}\\right)b_{n+1 } + \\left(\\frac{n^2}{4}-\\frac{1}{8}\\right ) b_{n}-\\frac{(n)_2}{4}b_{n-1 } \\label{eq : v*b_inv } \\\\[0.3 cm ]   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\inv}(x)s_{k-2}(x ) & = \\frac{1}{4 } \\left(-n s_{n-1,k-2}+(n)_2 s_{n-2,k-2 }   \\right ) \\nonumber\\\\ & \\hspace{1 cm } + \\frac{1}{4 } ( k-1 ) \\left(s_{n , k-1}-2 n s_{n-1,k-1}+ 2 ( n)_2 s_{n-2,k-1 } \\right)\\nonumber\\\\ & \\hspace{1cm}+ \\frac{1}{8 }   k(k-1)\\left(s_{n , k}-2 n s_{n-1,k}+ 2 ( n)_2 s_{n-2,k } \\right).\\nonumber\\end{aligned}\\ ] ]    it is possible to simplify the expression obtained for @xmath294v_2^{\\inv}(x)s_{k-2}(x)$ ] .",
    "first , replace each occurrence of the left hand sides of the three identities @xmath295 by the corresponding right hand sides .",
    "then , in the identity obtained from the previous manipulation , replace each occurrence of the left hand side of the identity @xmath296 by its right hand side .",
    "this gives @xmath251v_2^{\\inv}(x)s_{k-2}(x )   & = \\left(\\frac{1}{4 } n \\left(n - k-1\\right ) \\left(1-\\frac{1}{k}\\right)+\\frac{1}{8 }   k(k-1)\\right)s_{n , k } \\label{eq : v*s_inv}\\\\ & \\qquad",
    "-\\frac{1}{4}\\left(n+1-k \\right)s_{n , k-1}+\\frac{n(n-1)}{4k}s_{n-1,k-1}.\\nonumber\\end{aligned}\\ ] ] note that identities  could be obtained in an elementary way from  . + _ steps 4 and 5 . _",
    "divide the expression by @xmath25 to obtain that _ the average number of inversions @xmath73 in a random set partition of  @xmath28 $ ] is given by _ @xmath297 using  lemma  [ lem : asymptotic_quotientbell ] ,",
    "it is straightforward to arrive at the asymptotic approximation @xmath298    similarly , divide expression by @xmath24 to obtain that _ the average number of inversions @xmath75 in a random set partition of  @xmath28 $ ] into  @xmath19 blocks is given by _",
    "@xmath299 use of  lemma  [ lem : asymptotic_quotientstirling ] then produces the asymptotic approximation @xmath300      let @xmath67 be a z - statistic defined on set partitions .",
    "it is easy to see that   is a corollary of  .",
    "indeed , by definition of the average value , we have @xmath301 suppose that   is true .",
    "then we have @xmath302v_2^{\\stat}(x)s_{k-2}(x)\\\\         & = \\frac{1}{b_n }   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\stat}(x)\\left(\\sum_{k\\geq 1 } s_{k-2}(x)\\right )       = \\frac{1}{b_n }   \\left[\\frac{x^{n}}{n!}\\right ] v_2^{\\stat}(x ) b(x).\\end{aligned}\\ ] ] therefore , in order to prove theorem  [ thm : gfunmean ] , we just have to prove  . set @xmath303 . by the definitions of average value and product of two formal power series , equation",
    "is equivalent to @xmath304 we will prove the latter identity .",
    "let @xmath305 be the set of pairs of nonempty and disjoints subsets of @xmath306 , i.e. , @xmath307 then , by definition of a z - statistic , we have @xmath308 } \\sum\\limits_{\\substack{\\pi\\in \\pi_n^k \\\\ a , b\\in \\pi } } \\stat(\\st(\\{a , b\\}))\\nonumber\\\\ & = \\sum\\limits_{\\substack{a , b\\subseteq [ n ] \\\\",
    "\\{a , b\\}\\in disj } } \\stat(\\st(\\{a , b\\}))\\,s_{n-|a\\cup b|,k-2},\\label{eq : mainthm1}\\end{aligned}\\ ] ] where the last equality follows from the fact that , for @xmath309 $ ] , the number  @xmath310 of partitions  @xmath15 in  @xmath70 such that @xmath311 is given by @xmath312 now , suppose we are given a set @xmath313 with @xmath314 .",
    "we have @xmath315 where the first equality follows from the definition of @xmath305 and the second is a consequence of the fact that @xmath316 send @xmath317 bijectively onto @xmath318 .    combining and , we obtain @xmath319 \\\\ \\{a , b\\}\\in disj } } \\stat(\\st(\\{a , b\\}))\\,s_{n-|a\\cup b|,k-2}\\\\ & = \\sum_{c\\subseteq[n ] } \\sum\\limits_{\\substack{\\{a , b\\}\\in disj\\\\ a\\cup b = c}}\\stat(\\st(\\{a , b\\}))\\,s_{n-|a\\cup b|,k-2}\\\\ & = \\sum_{c\\subseteq[n ] } v_{|c|}\\,s_{n-|c|,k-2},\\end{aligned}\\ ] ] which is obviously equivalent to  .",
    "this concludes the proof .    using the language of",
    "what is called the theory of species one can give a quick proof of  theorem  [ thm : gfunmean ] .",
    "we have preferred to avoid this terminology in order to keep the paper self - contained .",
    "we will work here with the z - statistic @xmath82 , which has the @xmath0-stirling distribution @xmath68 ( see  @xcite ) .",
    "recall that @xmath82 can be defined for a set partition @xmath84 in standard form by @xmath85    we have to start by `` computing '' @xmath320 .",
    "+ _ computation of @xmath320 .",
    "_ by definition , @xmath320 is the exponential generating function of the sequence @xmath269 with @xmath321 .    for a 2-partition @xmath322 written in standard form",
    ", we have @xmath323 .",
    "thus , we can see @xmath271 as the number of pairs @xmath324 , where  @xmath322 is a 2-partition of @xmath28 $ ] ( written in standard form ) and  @xmath325 .",
    "the number of such pairs is easily shown to be @xmath326 .",
    "indeed , we have @xmath327 choices for the element @xmath258 ( any of the elements of @xmath328 ) and then @xmath329 choices for the set @xmath330 ( any of the subsets of @xmath331 ) .",
    "therefore , we have @xmath332 a straightforward computation leads to @xmath333    since @xmath320 can be written in the form  , we can continue the process described in section  [ sect : process ] .",
    "+ _ step 2 .",
    "_ using   and , we can write @xmath334    _ step 3 .",
    "_ after routine coefficient extraction based on , we obtain @xmath251v_2^{\\los}(x)b(x ) & = -\\frac{1}{4 } b_{n+2}+\\left(\\frac{n}{2}+\\frac{1}{4}\\right)b_{n+1 } + \\left(-\\frac{n}{2}+\\frac{1}{4}\\right ) b_{n}\\label{eq : v*b_los}\\\\   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\los}(x)s_{k-2}(x ) & = \\frac{n}{2}s_{n-1,k-2 } + \\frac{1}{2}(k-1 ) \\left(-s_{n , k-1}+2 n s_{n-1,k-1}\\right)\\nonumber\\\\ & \\hspace{1cm}+\\frac{1}{4 } k(k-1 ) \\left(-s_{n , k}+2 n s_{n-1,k}\\right).\\nonumber\\end{aligned}\\ ] ]    it is possible to simplify the expression obtained for @xmath294v_2^{\\los}(x)s_{k-2}(x)$ ] by replacing each occurrence of the left hand sides of identities   and   by the corresponding right hand sides .",
    "this gives @xmath251v_2^{\\los}(x)s_{k-2}(x ) & = \\left(\\frac{1}{2 } n(k - 1)- \\frac{1}{4}k(k - 1)\\right)s_{n , k }    + \\frac{1}{2}(n+1-k)s_{n , k-1}. \\label{eq : v*s_los}\\end{aligned}\\ ] ]    _ steps 4 and 5 .",
    "_ division of expression   by @xmath25 gives the exact value   of @xmath73 , while its asymptotic approximation   is easily obtained from lemma  [ lem : asymptotic_quotientbell ] .",
    "similarly , division of expression   by @xmath24 gives the exact value   of @xmath75 , while , after a routine computation based on lemma  [ lem : asymptotic_quotientstirling ] , we obtain the asymptotic approximation @xmath335 which is a refinement of  .",
    "this concludes the proof of theorem  [ thm : mean_qstirling ] .",
    "there is an `` explicit '' expression for the generating function of the @xmath0-stirling distribution @xmath68 ( see e.g.  @xcite ) , namely , @xmath336_q!}\\sum_{j=1}^{k } ( -1)^{k - j } { k\\brack j}_q   q^{\\binom{k - j}{2}}[j]_q^n,\\end{aligned}\\ ] ] where @xmath337 is the usual @xmath0-binomial coefficient .",
    "it seems difficult to recover the exact average values of the @xmath0-stirling distributions from the above expression .",
    "however , it is well - known that  generating functions find averages  ( see e.g.  @xcite ) . in the case of our @xmath0-stirling numbers ,",
    "it is easy to derive from the recurrence   that @xmath338_q x)\\cdots(1-[k]_q x)}.\\end{aligned}\\ ] ] it is possible to recover the results presented in this section from this generating function identity .",
    "we can even obtain many more results , such as values of variances and some limit laws ( see  @xcite ) .",
    "_ computation of @xmath339 . _ by definition , @xmath339 is the exponential generating function of the sequence @xmath269 with @xmath340 .",
    "we can interpret @xmath271 as the number of pairs @xmath341 , where  @xmath15 is a 2-partition of @xmath28 $ ] and  @xmath342 is a linear crossing of  @xmath15 .",
    "such a pair will be called an _ underlined _ 2-partition .",
    "an underlined partition @xmath341 with @xmath343 can be identified with the restricted growth function @xmath146 in which the letters @xmath274 , @xmath275 , @xmath344 and @xmath345 are colored .",
    "for instance , there are 3 linear crossings in @xmath346 : @xmath347 , @xmath348 and @xmath349",
    ". then we have @xmath350 , @xmath351 and @xmath352 .    using this correspondence",
    ", it is not hard to see that an underlined 2-partition  @xmath341 can be decomposed uniquely in one of the following two ways :    * @xmath353 , * @xmath354 ,    with @xmath355 or @xmath356 , @xmath357 and @xmath358 ; @xmath359 , @xmath360 and @xmath361 .    simple rules of counting and manipulations of generating functions ( see e.g.  @xcite ) then show that the ordinary generating functions @xmath362 and @xmath363 for underlined of @xmath28 $ ] , @xmath364 admitting a decomposition of type  @xmath365 and @xmath366 , respectively , are given by @xmath367 thus , the number of underlined 2-partitions of @xmath28 $ ] , i.e. , @xmath271 , is just the coefficient of @xmath368 in the power series @xmath369 a routine coefficient extraction based on the partial fraction decomposition @xmath370 gives @xmath371    a straightforward computation then leads to @xmath372    of course , there are many other ways to compute the coefficients @xmath271 .",
    "we now present another way based on a decomposition of 2-partitions which is particularly well - adapted to the computation of the coefficients @xmath271 in the case of circular crossings .",
    "( 0,0)(10,1.6 ) ( 0,0)(2,0)2 ( 0,0)(2,0)3 ( 1,0)(2,0)2 ( 1,0)(2,0)2 ( 4.5,0)(0,0)(0.5,1 ) ( 5,0)(0,0)(0.3,0.55 ) ( -0.3,0)(10,0 ) ( 6,0.5)(9,0.5 ) ( 0,0)@xmath3 ( 0,0 )    via its restricted growth function , a 2-partition can be viewed as a word on the alphabet  @xmath373 whose first letter is 1 .",
    "it is then immediate to see that each 2-partition @xmath15 can be decomposed uniquely as @xmath374 for some @xmath375 , where @xmath376 for @xmath377 , and @xmath378 .    for @xmath375 ,",
    "denote by @xmath379 the set of 2-partitions with such a decomposition . a moment s thought",
    "( see figure  [ fig : linear2partition ] ) will convince the reader that    * if @xmath380 , @xmath381 , * if @xmath382 , @xmath383 , @xmath384    it is easy to see from the definition of @xmath379 that the ordinary generating functions @xmath385 and @xmath386 of 2-partitions of @xmath28 $ ] , @xmath364 , in @xmath379 satisfying @xmath387 and @xmath388 , respectively , are given by @xmath389 and @xmath390 .",
    "it follows that for @xmath383 we have @xmath391 where we have set @xmath392 for @xmath254 .",
    "using the latter equality and the formal identity @xmath393 , after a routine computation we obtain @xmath394 as it was previously derived .",
    "+ since @xmath339 ( see ) can be written in the form  , we can continue the process described in section  [ sect : process ] .",
    "+ _ step 2 .",
    "_ using  , and , we can write @xmath395    _ step 3 . _ after routine coefficient extraction based on , we obtain @xmath213v_2^{\\crol}(x)b(x ) & = -\\frac{5}{4 } b_{n+2}+\\left(\\frac{n}{2}+\\frac{9}{4}\\right)b_{n+1 } + \\left(\\frac{n}{2}+\\frac{1}{4}\\right ) b_{n}\\label{eq : v*b_crol}\\\\ \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\crol}(x)s_{k-2}(x ) & = \\frac{3 n}{2}s_{n-1,k-2}+\\frac{1}{2 } ( k-1 ) \\left(-3 s_{n , k-1}+4 n s_{n-1,k-1}\\right)\\nonumber\\\\ & \\hspace{1cm}+\\frac{1}{4 } k(k-1 ) \\left(-5 s_{n , k}+2 ns_{n-1,k}\\right).\\nonumber\\end{aligned}\\ ] ] it is possible to simplify the expression obtained for @xmath294v_2^{\\crol}(x)s_{k-2}(x)$ ] by replacing each occurrence of the left hand sides of identities   and   by the corresponding right hand sides .",
    "this gives @xmath251v_2^{\\crol}(x)s_{k-2}(x ) & = \\left(\\frac{1}{2 } n(k - 1)- \\frac{5}{4}k(k - 1)\\right)s_{n , k }    + \\frac{3}{2}(n+1-k)s_{n , k-1}.\\label{eq : v*s_crol}\\end{aligned}\\ ] ]    _ steps 4 and 5 .",
    "_ division of expression   by @xmath25 gives the exact value   of @xmath73 , while its asymptotic approximation   is easily obtained from lemma  [ lem : asymptotic_quotientbell ] .",
    "similarly , division of expression   by @xmath24 gives the exact value   of @xmath75 , while , after a routine computation based on lemma  [ lem : asymptotic_quotientstirling ] , we get the asymptotic approximation @xmath396 which is a refinement of  .",
    "this concludes the proof of theorem  [ thm : mean_crossinglinear ] .",
    "it is worth noting that there has been considerable interest in studying crossings in matchings ( set partitions each block of which has exactly two elements ) and set partitions .",
    "in the case of the number of crossings in matchings , a remarkable formula , often called the touchard ",
    "riordan formula , was made explicit by riordan  @xcite , who also mentioned the exact values of the average and the variance of the number of crossings in matchings . though they are `` contained '' in the touchard ",
    "riordan formula , it is not a priori clear whether they admit a simple form .",
    "later , flajolet and noy  @xcite used a certain decomposition of the number of crossings to give a `` direct '' proof for the average value .",
    "this decomposition was later generalized by the author  @xcite to compute the average number of linear crossings in a random set partition and is at the origin of this work .",
    "let @xmath397 be the generating function of set partitions of  @xmath28 $ ] into  @xmath19  blocks with respect to the number of linear crossings ,",
    "i.e. , @xmath398 .",
    "biane  @xcite ( see also  @xcite ) found a continued fraction expansion for the generating function @xmath399 .",
    "recently , stanton , zeng and the author  ( see  equation  28 in  @xcite ) proved that @xmath400_qt+a(1-q)[i]_qt)},\\end{aligned}\\ ] ] from which they derive the following remarkable formula for @xmath397 ( see  equation  32 in  @xcite ) : @xmath401_q^n}{[j]_q ! } \\sum_{i=0}^{k - j } \\frac{(1-q)^{i}}{[k - j - i]_{q } ! }   q^{\\binom{k - j - i+1}{2}-kj}\\biggl ( \\binom{n}{i } q^{j}+\\binom{n}{i-1}\\biggr).\\end{aligned}\\ ] ] another remarkable formula for @xmath397 was established recently by josuat - vergs and rubey  @xcite : @xmath402 again , though the average number of linear crossings is `` contained '' in the above two formulas , it is not a priori clear whether they admit a simple form .",
    "however , it is possible to recover the exact average values presented in this section and even exact values for the variance of the number of linear crossings ( see  @xcite ) from the generating function  .",
    "moreover , a limit law will be given in  @xcite .",
    "finally , we want to point out that there exist combinatorial parameters which have the same distribution ( hence , the same average value ) as the number of linear crossings on each  @xmath70 .",
    "this is the case of the number of nestings of two arcs  @xcite and the major index for set partitions introduced in  @xcite .",
    "_ computation of @xmath403 . _ by definition , @xmath403 is the exponential generating function of the sequence @xmath269 with @xmath404 .",
    "suppose we are given a 2-partition @xmath15 in @xmath379 . by definition of @xmath379",
    "( see section  [ sect : deftk ] ) , this means that there exist integers @xmath376 for @xmath377 , and @xmath378 such that @xmath405    a moment s thought ( see figure  [ fig : circular2partition ] ) will convince the reader that :    * if @xmath406 , @xmath407 , * if @xmath408 , @xmath409 .    ( -1.7,-1.7)(1.7,1.7 )    ( -1.7,-1.7)(1.7,-1.7 )    this implies that , for @xmath408 , we have @xmath410 since the generating function @xmath411 of 2-partitions in @xmath379 is given by @xmath412 . using the formal identity @xmath413 , it is then easy to obtain the identity @xmath414    for the case @xmath415 , we have to be more careful .",
    "by definition , a partition in @xmath416 can be written in the form @xmath417 , with @xmath418 and @xmath419 .",
    "we distinguish four cases . instead of long - winded explanations , we prefer to present the results in the table given in figure  [ fig : crossingsint2 ] .",
    "the first column lists the different cases considered , while the second column indicates the corresponding circular representations . in each case",
    ", the statistic @xmath110 assumes a constant value : the third column provides these constants .",
    "finally , the ( ordinary ) generating function of 2-partitions in each case is given in the fourth column .",
    "for instance , the first and third row read as follows :    @xmath420 _ case ( a ) _ : there is one and only one partition @xmath421 , @xmath422 and the generating function for this case is @xmath423 .",
    "@xmath420 _ case ( c ) _ : the parameter @xmath110 is equal to @xmath4 and the generating function of this class is @xmath424 .",
    "the other rows have to be read similarly .",
    "+ let @xmath425 , @xmath426 , @xmath427 and @xmath428 be the generating functions of 2-partitions in case @xmath365 , @xmath366 , @xmath429 and @xmath430 , respectively .",
    "it follows from a reading of the entire table that @xmath431 combining and the latter equality , we obtain @xmath432    a routine coefficient extraction based on the partial fraction decomposition @xmath433 gives @xmath434 a straightforward computation leads to @xmath435 since @xmath403 can be written in the form  , we can continue the process described in section  [ sect : process ] .",
    "+ _ step 2 .",
    "_ using  , and , we can write @xmath436    _ step 3 .",
    "_ after routine coefficient extraction based on , we obtain @xmath251v_2^{\\croc}(x)b(x ) & = \\frac{n}{2}b_{n+1}+\\frac{3n}{2}b_{n } -2n\\left(n+\\frac{1}{4}\\right)b_{n-1 } -(n)_2b_{n-2}+\\frac{1}{24}(n)_4 b_{n-4}\\label{eq : v*b_croc}\\\\   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\croc}(x)s_{k-2}(x ) & = \\frac{1}{24}\\left((n)_4 s_{n-4,k-2}-72(n)_2 s_{n-2,k-2}\\right)\\nonumber\\\\   & \\hspace{1cm}+ ( k-1 ) \\left(-2 ( n)_2 s_{n-2,k-1}+3n s_{n-1,k-1}\\right)\\nonumber\\\\ & \\hspace{1cm}+\\frac{1}{2 } k(k-1 ) ns_{n-1,k}.\\nonumber\\end{aligned}\\ ] ]    it is possible to simplify the expression obtained for @xmath294v_2^{\\croc}(x)s_{k-2}(x)$ ] by replacing each occurrence of the left hand sides of identities   and @xmath437 by the corresponding right hand sides .",
    "this gives @xmath251v_2^{\\croc}(x)s_{k-2}(x ) & = \\frac{n(k-1)}{2}s_{n , k}+\\frac{n}{2}(-4n-1 + 5k)s_{n-1,k-1}\\label{eq : v*s_croc}\\\\ & \\qquad -(n)_2 s_{n-2,k-2}+\\frac{(n)_4}{24}s_{n-4,k-2}.\\nonumber   \\end{aligned}\\ ] ]    _ steps 4 and 5 .",
    "_ division of expression   by @xmath25 gives the exact value   of @xmath73 , while its asymptotic approximation   is easily obtained from lemma  [ lem : asymptotic_quotientbell ] .",
    "similarly , division of expression   by @xmath24 gives the exact value   of @xmath75 , while , after a routine computation based on lemma  [ lem : asymptotic_quotientstirling ] , we get the asymptotic approximation @xmath438 which is a refinement of  .",
    "this concludes the proof of theorem  [ thm : mean_crossingcircular ] .",
    "while the combinatorial parameter @xmath100 has received a considerable interest , it seems that the natural parameter  @xmath110 was ignored .",
    "it is interesting to ask whether this parameter admits `` closed '' formulas similar to the formulas for @xmath100 presented in the previous section .",
    "some results on the asymptotic distribution of the parameter  @xmath110 will be given in  @xcite .",
    "_ computation of @xmath439 . _ by definition , @xmath439 is the exponential generating function of the sequence @xmath269 with @xmath440 .",
    "since @xmath117 assumes only the values 0 or 1 on @xmath441 , the term @xmath271 is just the number of @xmath4-partitions of @xmath28 $ ] that overlap , i.e. , the number of 2-partitions @xmath322 of @xmath28 $ ] such that @xmath442 .",
    "it is easy to see that there are exactly @xmath329 partitions @xmath322 of @xmath28 $ ] such that @xmath443 and @xmath444 , and among them only @xmath327 do not overlap ( these are the partitions @xmath445 with @xmath446 ) . consequently @xmath447    a straightforward computation leads to @xmath448 since @xmath439 can be written in the form  , we can continue the process described in section  [ sect : process ] .",
    "+ _ step 2 .",
    "_ using  , and , we can write @xmath449    _ step 3 . _ after routine coefficient extraction based on , we obtain @xmath251v_2^{\\ov}(x)b(x ) & = \\frac{1}{4 } b_{n+2}+\\frac{3}{4 } b_{n+1}-\\left(n+\\frac{5}{4}\\right ) b_{n}-\\frac{n}{2}b_{n-1}\\label{eq : v*b_ov}\\\\   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\ov}(x)s_{k-2}(x ) & = -\\frac{3n}{2 } s_{n-1,k-2}-\\frac{1}{2 } ( k-1)\\left(2 ns_{n-1,k-1}-3s_{n , k-1}\\right ) \\nonumber\\\\ & \\hspace{1cm}+ \\frac{1}{4 }   k(k-1 ) s_{n , k}.\\nonumber\\end{aligned}\\ ] ] it is possible to simplify the expression obtained for @xmath294v_2^{\\ov}(x)s_{k-2}(x)$ ] by replacing each occurrence of the left hand side of identity   by the corresponding right hand side .",
    "this gives @xmath251v_2^{\\ov}(x)s_{k-2}(x ) & = \\frac{1}{4}k(k-1)s_{n , k}-\\frac{3}{2}(n+1-k)s_{n , k-1 } \\label{eq : v*s_ov}\\\\ & \\qquad + \\frac{1}{2}n(k-1)s_{n-1,k-1}.\\nonumber\\end{aligned}\\ ] ]    _ steps 4 and 5 . _ division of expression   by @xmath25 gives the exact value   of @xmath73 , while its asymptotic approximation   is easily obtained from lemma  [ lem : asymptotic_quotientbell ] .",
    "similarly , division of expression   by @xmath24 gives the exact value   of @xmath75 , while , after a routine computation based on lemma  [ lem : asymptotic_quotientstirling ] , we obtain the asymptotic approximation @xmath450 which is a refinement of  .",
    "this concludes the proof of theorem  [ thm : exactmean_ovl ] .",
    "although it seems that the parameter number of overlappings was never considered before , it is naturally suggested by the article  @xcite , in which flajolet and schott considered non - overlappings partitions . in particular , they obtained the generating function of non - overlapping partitions in the form of a continued fraction expansion .",
    "it is worth noting that a continued fraction expansion for the generating function of set partitions with respect to the number of overlappings follows painlessly from earlier combinatorial investigations ( see e.g.  @xcite ) .",
    "we also want to point out that , as @xmath175 , @xmath75 converges to @xmath451 . that this is also the average number of inversions in a random permutation of size  @xmath19 is far from being a coincidence , as we will explain in future work .",
    "_ computation of @xmath452 . _ by definition , @xmath452 is the exponential generating function of the sequence @xmath269 with @xmath453 .",
    "since @xmath123 assumes only the values 0 or 1 on @xmath441 , the term @xmath271 is just the number of 2-partitions of  @xmath28 $ ] which are embracing , i.e. , the number of 2-partitions @xmath322 of  @xmath28 $ ] such that @xmath454 , or , equivalently , such that @xmath443 and @xmath455 .",
    "obviously , for @xmath456 , there are exactly @xmath457 such 2-partitions .",
    "consequently @xmath458 a straightforward computation leads to @xmath459 since @xmath452 can be written in the form  , we can continue the process described in section  [ sect : process ] .",
    "+ _ step 2 .",
    "_ using  , and , we can write @xmath460    _ step 3 .",
    "_ after routine coefficient extraction based on , we obtain @xmath251v_2^{\\emb}(x)b(x ) & = \\frac{1}{4 } b_{n+2}-\\frac{5}{4 } b_{n+1}+\\frac{3}{4}b_{n}+\\frac{n}{2}b_{n-1}\\label{eq : v*b_emb}\\\\   \\left[\\frac{x^{n}}{n!}\\right]v_2^{\\emb}(x)s_{k-2}(x ) & = \\frac{n}{2 } s_{n-1,k-2}-\\frac{1}{2 } ( k-1)s_{n , k-1}+ \\frac{1}{4}k(k-1)s_{n , k}.\\label{eq : v*s_emb}\\end{aligned}\\ ] ]    _ steps 4 and 5 .",
    "_ division of expression   by @xmath25 gives the exact value   of @xmath73 , while its asymptotic approximation   is easily obtained from lemma  [ lem : asymptotic_quotientbell ] .",
    "similarly , division of expression   by @xmath24 gives the exact value   of @xmath75 , while , after a routine computation based on lemma  [ lem : asymptotic_quotientstirling ] , we get the asymptotic approximation @xmath461 which is a refinement of  .",
    "this concludes the proof of theorem  [ thm : exactmean_emb ] .",
    "it is worth noting that , like for overlappings , it is painless to derive a continued fraction form for the generating function of set partitions with respect to the number of embracings by making use of the combinatorial theory of continued fractions  @xcite .",
    "one can also consider a variation of embracings .",
    "say that two sets  @xmath96 and  @xmath113 _ strongly embrace each other _ if , with the implied order structure , @xmath462 .",
    "then one can show that the statistic ` number of strong embracings ' has the same distribution ( hence , the same average value ) on each @xmath70 as the number of overlappings .",
    "this can be proved using the combinatorial theory of continued fractions or by a direct combinatorial argument .",
    "_ computation of @xmath463 .",
    "_ let @xmath127 be a @xmath4-pattern of length @xmath131 . by definition , @xmath463 is the exponential generating function of the sequence @xmath269 with @xmath464 .",
    "we can interpret @xmath271 as the number of pairs @xmath465 , where  @xmath15 is a 2-partition of @xmath28 $ ] and  @xmath466 is an occurrence of  @xmath129 in  @xmath15 .",
    "such a pair will be called an _ underlined _ 2-partition . an underlined 2-partition @xmath465 with @xmath466",
    "can be identified with the restricted growth function @xmath146 in which the letters @xmath467,@xmath468,  ,@xmath469 are colored .",
    "for instance , if @xmath470 , the 3-tuple @xmath471 is an occurrence of @xmath129 in @xmath472 and @xmath473 .",
    "using this correspondence , it is not hard to see that an underlined 2-partition can be decomposed uniquely as @xmath474 with @xmath475 and @xmath476 for @xmath477 ; @xmath478 with @xmath479 for @xmath480 . in particular",
    ", this proves that @xmath271 ( and thus @xmath463 ) depends only on the first letter of @xmath129 . for @xmath149 ,",
    "let @xmath481 equal the value of @xmath271 when @xmath482 .",
    "it follows from the above decomposition of underlined 2-partitions combined with an elementary counting that for @xmath483 , @xmath484 to see the above result in the case @xmath485 , for instance , just observe that there are @xmath486 choices for the positions of the underlined elements @xmath487,@xmath488,  ,@xmath489 and then @xmath490 choices for the word @xmath491 .",
    "the case @xmath492 can be treated in a similar way .    for @xmath149 ,",
    "let @xmath493 equal @xmath463 in the case where @xmath482 , i.e. , @xmath494 .",
    "for later simplifications , it is important to note that it suffices to determine only one of the @xmath493 s to get the other .",
    "indeed , an elementary computation yields @xmath495 from which we deduce easily ( using , for instance ) that @xmath496    we choose to deal with @xmath497 . in order to obtain a convenient expression for @xmath497 , we need some additional materials .",
    "let @xmath19 be a nonnegative integer and @xmath498 , as before .",
    "given a formal power series @xmath499 , it is easy to establish the formal identity @xmath500 what about the power series @xmath501 ? using the chu ",
    "vandermonde convolution , we have @xmath502 from which we deduce that @xmath503 in particular , for @xmath504 , we obtain @xmath505    we can now express the power series @xmath497 ( and @xmath506 ) in a convenient form . we have seen earlier that @xmath507 for @xmath483 ( @xmath508 , otherwise ) .",
    "after elementary manipulations , one gets @xmath509 for any integer @xmath510 , set @xmath511 combining   and  , we arrive at @xmath512 combining the latter identity and  , we get @xmath513    _ the connecting relations .",
    "_ we now establish relations   and  . instead of",
    ", we will use the identity @xmath514 which can be obtained from   by a straightforward computation . combining   and ,",
    "we can write @xmath515 and , after a routine coefficient extraction based on , we obtain @xmath516\\left(v_2^{(\\sigma_1=1)}(x)+v_2^{(\\sigma_1=2)}(x)\\right)\\,s_{k-2}(x ) & = { n \\choose r } \\left(s_{n+2-r , k}-s_{n+1-r , k}\\right).\\end{aligned}\\ ] ] summing the both sides of this identity over all integers @xmath517 , we obtain @xmath518\\left(v_2^{(\\sigma_1=1)}(x)+v_2^{(\\sigma_1=2)}(x)\\right)\\,b(x ) & = { n \\choose r } \\left(b_{n+2-r}-b_{n+1-r}\\right).\\end{aligned}\\ ] ]    it suffices now to divide expression   by  @xmath25 and expression   by @xmath24 , respectively , to obtain the relations   and  .",
    "+ _ exact average values in the case @xmath485 .",
    "_ combining   and  , we can write @xmath519 after a routine coefficient extraction based on , we obtain @xmath213v_2^{(\\sigma_1=2)}(x)s_{k-2}(x)&=\\sum_{j=0}^r\\frac{(-1)^{r - j}}{j!2^{r+1-j}}(n)_j \\left(s_{n+2-j , k}-s_{n+1-j , k}\\right)\\\\&\\qquad + \\frac{(-1)^{r+1}}{2^{r+1}}s_{n , k-2}.\\end{aligned}\\ ] ] a rearrangement of the terms of the sum on the right hand side gives @xmath213v_2^{(\\sigma_1=2)}(x)s_{k-2}(x)&=\\frac{(-1)^{r+1}}{2^{r+1}}s_{n , k-2}+\\sum_{j=0}^r p_j(n ) s_{n+2-j , k}\\label{eq : v*s_occ2}\\\\   & \\qquad -\\frac{1}{2}{n\\choose r } s_{n+1-r , k},\\nonumber\\end{aligned}\\ ] ] where @xmath174 is given by  .    division of expression   by @xmath24 gives the exact value of @xmath520 given in theorem  [ thm : exactmeanblock_occ ] , while the exact average value of @xmath521 given in theorem  [ thm : exactmeanblock_occ ] can be obtained easily from the exact value of @xmath520 by using  .",
    "+ _ asymptotic approximations of the average values in the case @xmath485 . _",
    "the exact average value of @xmath522 we found is @xmath523 it follows easily from  lemma  [ lem : asymptotic_quotientbell ] and basic representations of binomial coefficients that , as @xmath175 , we have @xmath524 for any integer @xmath525 . similarly , as @xmath175 , one can prove @xmath526 combining   and  , we get after basic comparisons @xmath527 which is exactly   in the case @xmath485 .    the exact average value of @xmath520 we found is @xmath528 it follows easily from  lemma  [ lem : asymptotic_quotientstirling ] and basic representations of binomial coefficients that , as @xmath175 , we have @xmath529 which is a refinement of the asymptotic approximation   given in theorem  [ thm : exactmeanblock_occ ] . + _ the case @xmath492 . _",
    "the exact and asymptotic approximations of the average value @xmath530 ( @xmath531 , respectively ) given in theorem  [ thm : exactmean_occ ] ( theorem  [ thm : exactmeanblock_occ ] , respectively ) can be easily obtained from the exact and asymptotic approximations of @xmath522 ( @xmath520 , respectively ) obtained earlier combined with relation   ( respectively ) .",
    "the details are left to the reader .",
    "+ _ patterns of length @xmath4 . _ to end the proof of our theorems , we need to establish assertion @xmath532 of theorem  [ thm : exactmean_occ ] .",
    "in fact , we have already shown in section  [ section : inversion ] that   is an asymptotic approximation of @xmath533 ( which is actually equal to @xmath534 as we remarked earlier ) .",
    "almost the same asymptotic computation shows that   is an asymptotic approximation of @xmath535 whose exact value is given in   ( the details are left to the reader ) .",
    "this concludes the proof of theorem  [ thm : exactmean_occ ] and theorem  [ thm : exactmeanblock_occ ] .",
    "the notion of pattern containment in set partitions we have considered in this section is due to sagan  @xcite .",
    "there is also an older and different notion of pattern containment in set partitions due to klazar ( see e.g.  @xcite ) .",
    "actually , it can be shown that the statistic ` number of occurrences of a 2-partition ' ( according to klazar s definition ) is also a z - statistic .",
    "one can show by either applying the methodology developed in this paper or by direct combinatorial arguments that , with klazar s definition of pattern containment , the average number of occurrences of any 2-partition @xmath15 of @xmath536 $ ] in a random set partition of @xmath28 $ ] is given by @xmath537    mansour , shattuck and yan  @xcite have considered a restricted case of pattern containment in set partitions where it is required that the occurrence has to be contiguous .",
    "they obtained some average value results for numbers of restricted occurrences of some patterns .",
    "note that their results can not be recovered with the methodology of this paper since , in the contiguous case , numbers of occurrences are not z - statistics .",
    "there is a natural way to generalize z - statistics . given an integer @xmath538",
    ", we will say that a set partition statistic @xmath56 is a z - statistic of depth @xmath131 if for any @xmath57 , @xmath539 examples of z - statistics of depth @xmath131 which can be found in the literature are the numbers of @xmath131-crossings and @xmath131-nestings of arcs  @xcite , the number of occurrences of an @xmath131-pattern with sagan s definition  ( see section  [ section : remarks_occ ] ) and the number of occurrences of an @xmath131-partition with klazar s definition  ( see section  [ section : remarks_occ ] )",
    ".    theorem  [ thm : gfunmean ] can be generalized in a straightforward manner to simplify the computation of average values of z - statistics of depth @xmath131 . given a z - statistic of depth @xmath131 @xmath67 ,",
    "let @xmath540 , and let @xmath541 be the exponential generating function of the sequence @xmath542 , i.e. , @xmath543      [ thm : gfunmean_r - splittable ] let @xmath67 be a z - statistic of depth @xmath131 . denote by @xmath73 ( respectively @xmath75 ) the average value of the statistic @xmath67 in a random set partition of  @xmath28 $ ] ( respectively of  @xmath28 $ ] into @xmath19 blocks ) .",
    "then we have : @xmath182\\,v_r^{\\stat}(x)b(x)\\label{eq : thmgfunmean_r - split}\\\\ \\mu_{n , k}&=\\frac{1}{s_{n , k}}\\,\\left[\\frac{x^n}{n!}\\right]\\,v_r^{\\stat}(x)s_{k-2}(x).\\label{eq : thmgfunmeanblock_r - split}\\end{aligned}\\ ] ]    note that the point of the above result is that the computation of average values of a z - statistic of depth @xmath131 in a random set partition is essentially equivalent to the computation of its average value in a random @xmath131-partition .    as open problems , we ask the following questions .",
    "what are the ( exact and asymptotic ) average values of the numbers of @xmath131-crossings , @xmath131-nestings , occurrences of an @xmath131-pattern in a random set partition of @xmath28 $ ] ?      in this paper we concentrated on set partitions but we might consider any other exponential family .",
    "an exponential family is , roughly speaking , a set of structures that are built out of connected pieces ( see e.g.  @xcite for a precise definition ) .",
    "one can easily establish a generalized version of theorem  [ thm : gfunmean ] for exponential families to simplify computation of average values .",
    "we do not think that it is necessary to state the generalization , but we give a typical illustration of application .    consider a natural generalization of matchings , namely the ( exponential family of ) set partitions all blocks of which are of size @xmath544 ( @xmath544 is a given integer @xmath545 ) .",
    "for these partitions , we can consider the statistics ` numbers of crossings in linear and circular representations ' and it is easy to see that these statistics are still z - statistics on such partitions",
    ". then one can prove the following results .",
    "@xmath420 _ the average number @xmath549 of circular crossings in a random set partition into @xmath19  blocks of size  @xmath544 , @xmath550 , is given by _",
    "@xmath551 note that , when @xmath552 , we recover already known results ( see e.g.  @xcite ) .    * acknowledgments . *",
    "the author would like to thank christian krattenthaler and einar steingrmsson for their encouragement during the preparation of this paper , and the anonymous referee for his helpful suggestions concerning the presentation of this paper .",
    "special acknowledgement is given to christian krattenthaler for a careful proofreading of this paper .",
    "all remaining errors are the author s .",
    "99 p. biane , some properties of crossings and partitions , discrete math . 175",
    "( 1997 ) , 4153 .",
    "d. bressoud and d. zeilberger , a proof of andrews @xmath0-dyson conjecture , discrete math . 54",
    "( 1985 ) , no .",
    "2 , 201224 . l. carlitz , @xmath0-bernoulli numbers and polynomials , duke math . j. 15 ( 1948 ) , 9871000 . w.y.c . chen , e.y.p .",
    "deng , r.r.x .",
    "stanley and c.h .",
    "yan , crossings and nestings of matchings and partitions , trans .",
    "( 2007 ) , no .",
    "4 , 15551575 . w.y.c .",
    "chen , i. gessel , c.h .",
    "yan and a.l.b .",
    "yang , a major index for matchings and set partitions , j. combin",
    ". theory ser . a 115 ( 2008 ) ,",
    "6 , 10691076 .",
    "d. drake and j.s .",
    "kim , @xmath19-distant crossings and nestings of matchings and partitions , discrete math .",
    "ak , 349360 , ( 2009 ) .",
    "a. de mdicis and p. leroux , a unified combinatorial approach for @xmath0- ( and @xmath553- ) stirling numbers , j. statist .",
    "inference 34 ( 1993 ) , no .",
    "1 , 89105 . r.s .",
    "deodhar and m.k .",
    "srinivasan , an inversion number statistic on set partitions , electron .",
    "notes discrete math . 15 ( 2003 ) , 8486 ( electronic ) .",
    "r. ehrenborg and m. readdy , juggling and applications to @xmath0-analogues , discrete math . 157",
    "( 1996 ) , no .",
    "13 , 107125 .",
    "p. flajolet , combinatorial aspects of continued fractions , discrete math .",
    "41 ( 1982 ) , 145153 .",
    "p. flajolet and m. noy , analytic combinatorics of chord diagrams , formal power series and algebraic combinatorics ( moscow , 2000 ) , 191201 , springer , berlin , 2000 .",
    "p. flajolet and r. schott , non - overlapping partitions , continued fractions , bessel functions and a divergent series , european j. combin . 11 ( 1990 ) ,",
    "flajolet , r. sedgewick , analytic combinatorics .",
    "cambridge university press , cambridge , 2009 .",
    "j. galovich and d. white , mahonian @xmath59 statistics , discrete math . 307",
    "( 2007 ) , no .",
    "1920 , 23412350 .",
    "a.m. garsia and j. b. remmel , @xmath554-counting rook configurations and a formula of frobenius , j. combin .",
    ". a 41 ( 1986 ) , 246275",
    ". h. w. gould , the @xmath0-stirling numbers of the first and second kinds , duke math .",
    "j. 28 ( 1961 ) , 281289 .",
    "johnson , some applications of the @xmath0-exponential formula , proceedings of the 6th conference on formal power series and algebraic combinatorics ( new brunswick , nj , 1994 ) , discrete math .",
    "157 ( 1996 ) , no .",
    "13 , 207225",
    ". m. josuat - vergs and m. rubey , crossings , motzkin paths and moments , discrete math .",
    "311 ( 2011 ) , issues 1819 , 20642078 .",
    "a. kasraoui , on the limiting distribution of some numbers of crossings in set partitions , in preparation .",
    "a. kasraoui , tudes combinatoires sur les permutations et partitions densemble , ph.d .",
    "thesis , universit lyon  1 , 2009 .",
    "a. kasraoui , d. stanton and j. zeng , the combinatorics of al - salam ",
    "chihara @xmath0-laguerre polynomials , advances in applied mathematics 47 ( 2011 ) , issue 2 , 216239 .",
    "a. kasraoui and j. zeng , distribution of crossings , nestings and alignments of two edges in matchings and partitions , electron .",
    "j. combin .",
    "13 ( 2006 ) , no .",
    "1 , research paper 33 .",
    "m. klazar , counting pattern - free set partitions .",
    "i. a generalization of stirling numbers of the second kind .",
    "european j. combin .",
    "21 ( 2000 ) , no .",
    "3 , 367378 . g. ksavrelof and j. zeng , nouvelles statistiques de partitions pour les @xmath0-nombres de stirling de seconde espce , discrete math . 256 ( 2002 ) , issue 3 , 743758 .",
    "p. leroux , reduced matrices and @xmath0-log - concavity properties of @xmath0-stirling numbers , j. combin .",
    "theory ser . a 54 ( 1990 ) , no .",
    "1 , 6484 .",
    "t. mansour , m. shattuck and s.h.f .",
    "yan , counting subwords in a partition of a set , electron .",
    "j. combin . 17 ( 2010 ) , no .",
    "1 , research paper 19 , 21 pp .",
    "s. milne , restricted growth functions , rank row matching of partition lattices , and @xmath0-stirling numbers , adv .",
    "43 ( 1982 ) , 173196 .",
    "j. riordan , the distribution of crossings chords joining pairs of @xmath555 points on a circle , math .",
    "computation 29 ( 1975 ) , 215222 .",
    "sachkov , probabilistic methods in combinatorial analysis . translated from the russian . revised by the author .",
    "encyclopedia of mathematics and its applications , 56 .",
    "cambridge university press , cambridge , 1997 .",
    "b. sagan , a maj statistic for set partitions , european j. combin .",
    "12  ( 1991 ) , 6979 .",
    "b. sagan , pattern avoidance in set partitions , ars combin .",
    "94 ( 2010 ) , 7996 .",
    "b. salvy and j. shackell , symbolic asymptotics : functions of two variables , implicit functions , j. symbolic comput . 25 ( 1998 ) , no .",
    "3 , 329349 .",
    "r. simion , non crossing partitions , discrete math .",
    "217 ( 2000 ) , 367409 .",
    "m. wachs and d. white , @xmath553-stirling numbers and set partition statistics , j. combin .",
    "theory ser . a 56 ( 1991 ) , 2746 .",
    "d. white , interpolating set partition statistics , j. combin .",
    "theory ser .  a 68 ( 1994 ) , 262295 .",
    "h. wilf , generatingfunctionology , academic press , inc . ,",
    "boston , ma , 1990 ."
  ],
  "abstract_text": [
    "<S> we find exact and asymptotic formulas for the average values of several statistics on set partitions : of carlitz s @xmath0-stirling distributions , of the numbers of crossings in linear and circular representations of set partitions , of the numbers of overlappings and embracings , and of the numbers of occurrences of a 2-pattern . </S>"
  ]
}