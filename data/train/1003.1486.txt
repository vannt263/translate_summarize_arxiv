{
  "article_text": [
    "the balance property is a notion connected with sturmian words from very first beginning of their investigation . in @xcite ,",
    "sturmian words were defined as aperiodic words with the smallest possible factor complexity . already in the same article , hedlund and",
    "morse observed that sturmian words show also the smallest discrepancy in occurrences of letters . to quote precisely their result ,",
    "let us denote by @xmath16 the length of the word @xmath5 and by @xmath17 the number of occurrences of letter @xmath7 in @xmath5 .",
    "hedlund and morse proved that an infinite aperiodic word @xmath0 over the alphabet @xmath18 is sturmian if and only if for all pairs @xmath5 , @xmath4 of factors of @xmath0 with @xmath19 it holds @xmath20 .",
    "let us note that the letter @xmath21 is not preferred as in binary alphabet the relations @xmath19 and @xmath20 imply the inequality @xmath22 as well .    during past 70 years",
    "many other characterizations of sturmian words have appeared , for their overview see @xcite . each of these characterizations may serve and serves for generalization of sturmian words to multiliteral alphabets , cf .",
    "@xcite . nevertheless , the balance property seems to be the most complicated to deal with .",
    "only a few results are known about words satisfying the so - called @xmath2-balanced property .",
    "let us recall that an infinite word @xmath0 over an alphabet @xmath1 is @xmath2-balanced if for all letters @xmath23 and all pairs @xmath24 of factors of @xmath0 with @xmath25 it holds @xmath26 .",
    "note that sturmian words are @xmath27-balanced in this terminology .",
    "the set of @xmath2-balanced words differs substantially from all other generalizations of sturmian words .",
    "neither generic arnoux - rauzy word nor generic word coding interval exchange transformation are @xmath2-balanced , see @xcite and @xcite .    in @xcite , adamczewski studies whether fixed point of a primitive substitution is @xmath2-balanced for some constant @xmath2 .",
    "he shows that the existence of such @xmath2 depends only on the spectrum of the incidence matrix of the substitution .",
    "however , the minimal value of @xmath2 can not be deduced from the spectrum . in @xcite and @xcite ,",
    "the minimal value of @xmath2 is determined for binary fixed points of canonical substitutions associated with quadratic pisot numbers .",
    "the notion `` canonical substitution associated with a number @xmath28 '' comes from positional numeration systems with the base @xmath29 , see @xcite .",
    "generally speaking , it is a very complicated problem to determine minimal value @xmath2 for a ternary balanced word , let alone for words over alphabets of higher cardinalities . despite a common belief",
    "that the tribonacci word is @xmath30-balanced , the first proof of this fact has appeared just one year ago in @xcite ( the tribonacci word is the fixed point of the substitution @xmath31 , @xmath32 , @xmath33 ) . in this article",
    "we provide minimal value of @xmath2 for a certain class of ternary words , namely for fixed points of substitutions    @xmath34    with the parameter @xmath13 .",
    "these substitutions are canonical substitutions associated with cubic pisot numbers @xmath35 , roots of polynomials @xmath36 ( cf .",
    "let us recall that the tribonacci substitution is associated with a numeration system as well .    the definition of a @xmath27-balanced word may be reformulated equivalently using parikh vectors . inspired by this fact , richome , saari and zamboni introduced the abelian complexity @xmath37 of infinite word . in their notation ,",
    "sturmian words are aperiodic words with @xmath38 for all @xmath39 .",
    "the question on existence of words with constant abelian complexity is natural .",
    "it was shown in @xcite that for @xmath40 no words with @xmath41 exist .",
    "on the other hand , words with @xmath42 can be found in @xcite .",
    "the relation between abelian complexity and balance property is not straightforward .",
    "it is easy to see that an infinite word @xmath0 is balanced if and only if its abelian complexity is bounded .",
    "moreover , if the abelian complexity of @xmath0 is bounded by @xmath43 , then @xmath0 is @xmath44 balanced .",
    "the tribonacci case shows that the opposite implication is not valid : according to @xcite , the abelian complexity of the tribonacci word takes all values in the set @xmath45 .",
    "the fixed point of the substitutions studied in this article has the same property .",
    "let @xmath46 be a finite alphabet .",
    "a concatenation of letters in @xmath46 is called a _",
    "word_. the set @xmath47 of all finite words over @xmath46 equipped with the empty word @xmath48 and the operation of concatenation is a free monoid .",
    "the _ length _ of the word @xmath49 , denoted by @xmath16 , represents the number of its letters .",
    "one may also consider infinite words @xmath50 ; the set of infinite words over the alphabet @xmath46 is denoted by @xmath51 .",
    "a word @xmath5 is called a _ factor _ of @xmath52 or @xmath51 if there exist words @xmath53 and @xmath54 or @xmath55 , respectively , such that @xmath56 .",
    "the word @xmath5 is called a _ prefix _ of @xmath4 , if @xmath57 .",
    "it is a _ suffix _ of @xmath4 , if @xmath58 .",
    "let @xmath59 . for @xmath60 ,",
    "the symbol @xmath61 denotes the concatenation @xmath62 .",
    "we set @xmath63 .",
    "let a word @xmath52 have the prefix @xmath61 , @xmath60 .",
    "then the symbol @xmath64 denotes the word satisfying @xmath65 .",
    "similarly , if a word @xmath66 has the suffix @xmath61 for a @xmath60 , then @xmath67 denotes the word with the property @xmath68 .",
    "a _ morphism _ on the free monoid @xmath47 is a map @xmath69 satisfying @xmath70 for all @xmath71 . obviously , the morphism @xmath72 is determined if we define @xmath73 for all @xmath74 .",
    "a morphism @xmath72 is called a _ substitution _ , if @xmath75 for all @xmath74 and if there is an @xmath76 such that @xmath77 .",
    "an infinite word @xmath0 is said to be a _",
    "fixed point _ of the substitution @xmath72 , or invariant under the substitution @xmath72 , if @xmath78 if we naturally extend the action of @xmath72 to infinite words , we may rewrite simply as @xmath79 .",
    "an infinite word @xmath0 is @xmath2-balanced , if for every @xmath74 and for every pair of factors @xmath4 , @xmath5 of @xmath0 such that @xmath25 , it holds @xmath80 .",
    "this property determines the discrepancy of occurrences of letters in the word @xmath0 .",
    "however , it turns out that if the cardinality of @xmath46 is higher than two , it is useful to have more detailed information , namely what is the discrepancy of occurrences of each particular letter . for this purpose",
    "we introduce the following notion :    let @xmath0 be an infinite word over the alphabet @xmath46 and let @xmath74 . the word @xmath0 is said to be _ @xmath2-balanced with respect to the letter @xmath7 _ , if @xmath81 for all pairs of factors @xmath4 , @xmath5 of @xmath0 of the same length .",
    "let us consider an alphabet @xmath46 with @xmath43 elements , i.e. @xmath82 , and an infinite word @xmath0 over @xmath46 .",
    "for any factor @xmath5 of @xmath0 , its _ parikh vector _ is the @xmath43-tuple @xmath83 .",
    "let the symbol @xmath84 denote the set of all factors of @xmath0 of the length @xmath85 .",
    "then the _ abelian complexity _ of the word @xmath0 is a function @xmath86 defined by @xmath87 on the right hand side of there is the cardinality of the set of parikh vectors of all factors of @xmath0 of the length @xmath85 . in the sequel",
    "we will denote this set by @xmath88 , i.e. @xmath89      from now on , we will focus on a special class of substitutions on the ternary alphabet @xmath90 . for any integer @xmath13 ,",
    "we denote by @xmath9 the substitution given by @xmath91 the substitution @xmath9 has a unique fixed point , namely @xmath92    if the results of @xcite are applied on @xmath93 , one finds out that there is a constant @xmath2 such that the word @xmath93 is @xmath2-balanced , but it is not known what the value of @xmath2 is and how it depends on @xmath15 .",
    "this is the main aim of this paper  to determine @xmath2 .",
    "the fact that @xmath93 is balanced immediately implies that the abelian complexity function of @xmath93 is bounded , see introduction .",
    "the second aim of this paper is thus to find the optimal bound for @xmath94 .",
    "the elements of @xmath46 are usually denoted by numbers : @xmath95 etc .",
    "we have considered this notation , but we believe that the paper becomes more transparent if letters are used .",
    "the choice of @xmath96 , @xmath97 and @xmath98 has its roots in the fact that the word @xmath93 is a fixed point of a substitution associated with a number @xmath35 , cf .",
    "let @xmath99 denote the set of numbers which can be written in the form @xmath100 for non - negative integers @xmath101 .",
    "it can be shown ( cf .",
    "@xcite ) that when the elements of @xmath99 are drawn on the real line , there are exactly three types of distances between neighbouring points .",
    "if we assign the letters @xmath96 , @xmath98 and @xmath97 to the longest , the medium and the shortest distance , respectively , then the order of distances on the real line corresponds exactly to the order of the letters @xmath102 in the infinite word @xmath93 .",
    "we begin by the formulation of the main result of the paper .",
    "[ balance ] let @xmath93 be the infinite word invariant under the morphism @xmath9 given by",
    ". then @xmath93 is    * @xmath103-balanced with respect to the letter @xmath96 , * @xmath30-balanced with respect to the letter @xmath97 , * @xmath30-balanced with respect to the letter @xmath98 ,    and none of these bounds can be improved .",
    "the theorem has the following trivial consequence :    the infinite word @xmath93 is @xmath103-balanced and this bound is optimal , i.e. it can not be improved .",
    "since the proof is long and slightly complicated , we will split it into four sections and proceed in the following way :    * we prove that @xmath93 is @xmath30-balanced with respect to the letter @xmath98 .",
    "* we prove that @xmath93 is @xmath30-balanced with respect to the letter @xmath97 .",
    "* we prove that @xmath93 is @xmath103-balanced with respect to the letter @xmath96 .",
    "* we show that none of the bounds can be improved .",
    "as we have explained in preliminaries , the word @xmath93 is a fixed point of @xmath9 , i.e. @xmath104 in this sense each letter of @xmath93 can be regarded as the image , or a factor of the image , of another letter of @xmath93 . in view of the definition of @xmath9 , cf .",
    ", each segment @xmath105 has the structure @xmath106 for @xmath107 and @xmath108 . the letters @xmath97 and @xmath98 are thus `` terminating symbols '' which cut @xmath93 to images of individual letters .",
    "this fact is particularly important when a factor @xmath4 of @xmath93 is given and one needs to find a factor @xmath109 of @xmath93 such that @xmath110 .",
    "it holds :    [ jednozvzor ] let @xmath111 be a factor of @xmath93 such that @xmath112 and let one of the following conditions be satisfied :    * the first letter of @xmath4 is @xmath98 , * @xmath4 has the prefix @xmath113 , * @xmath114 or @xmath115 is a factor of @xmath93 .    then there is a unique factor @xmath109 of @xmath93 satisfying @xmath116 .",
    "+    any of the conditions ( i ) , ( ii ) and ( iii ) together with @xmath112 ensures that @xmath111 is an image of certain factor @xmath109 , and it is obvious from the definition of @xmath9 that @xmath117 .",
    "[ pripustnevzor ] _ _ ( i)__let @xmath118 be a letter occuring in @xmath105 for a @xmath119 . then :    * if @xmath120 , then @xmath121 and @xmath122 . * if @xmath123 , then either @xmath124 and @xmath125 , or @xmath126 and @xmath127 .",
    "_ _ ( ii)__if @xmath128 is a factor of @xmath93 and @xmath129 , @xmath108 , @xmath130 , then @xmath131 and @xmath132 .",
    "the following observation describes the possible neighbours of each of the letters @xmath102 in the word @xmath93 .",
    "[ pripustne ] the sequence of letters in the word @xmath93 conform to these rules :    * each letter @xmath97 in @xmath93 is preceded by @xmath96 and followed either by @xmath96 or by @xmath98 . *",
    "each letter @xmath98 in @xmath93 is preceded by @xmath97 and followed by @xmath96 .    _",
    "( i ) _ each @xmath97 is the last letter of @xmath105 for @xmath124 or @xmath126 according to observation [ pripustnevzor ] , i.e. it is the last letter of the block @xmath133 or @xmath134 , thus is preceded by @xmath96 .",
    "the letter @xmath97 is followed by the first letter of @xmath135 , which can be either @xmath96 or @xmath98 ( cf . the substitution rule @xmath9 ) . + _",
    "( ii ) _ each @xmath98 is equal to @xmath105 for @xmath121 .",
    "we already know from ( i ) that @xmath136 and @xmath137 , therefore the @xmath98 is preceded by the last letter of @xmath138 ( which is @xmath97 ) and followed by the first letter of @xmath138 or @xmath139 ( which is @xmath96 ) .    in order to understand the structure of the word @xmath93",
    ", it is useful to describe possible segments @xmath140 in factors of @xmath93 of the type @xmath141 and @xmath142 .",
    "this is done in the next two observations .",
    "[ szs ] let @xmath143 be a factor of @xmath93 such that @xmath144 .",
    "then one of the following equalities holds :    * @xmath145 , * @xmath146 , * @xmath147 .",
    "observations [ jednozvzor ] and [ pripustnevzor ] imply that @xmath148 , where @xmath149 is a factor of @xmath93 the last letter of which is either @xmath96 or @xmath98 and which is preceded in @xmath93 by either @xmath96 or @xmath98 .",
    "since @xmath150 contains only one @xmath97 , namely its last letter , all letters of @xmath149 except the last one have to be different from @xmath96 and @xmath98 .",
    "therefore @xmath151 , where @xmath152 and @xmath153 .",
    "taking into account observation [ pripustne ] , we infer that @xmath154 or @xmath155",
    ". therefore only four situations are possible : @xmath156 , @xmath157 , @xmath158 , @xmath159 . moreover , since @xmath149 is preceded by either @xmath96 or @xmath98 , it can not hold @xmath157 , cf .",
    "observation  [ pripustne ] .",
    "therefore @xmath149 is equal to one of the factors @xmath96 , @xmath160 , @xmath161 , which implies that @xmath140 is equal to one of the factors @xmath113 , @xmath162 , @xmath163 .",
    "let @xmath142 be a factor of @xmath93 such that @xmath164 .",
    "then one of the following equalities holds :    * @xmath165 , * @xmath166 , * @xmath167 .",
    "consequently , @xmath168 .",
    "it follows from observations [ jednozvzor ] and [ pripustnevzor ] that @xmath169 , where @xmath143 is a factor of @xmath93 such that @xmath144",
    ". therefore @xmath170 and , according to observation [ szs ] , @xmath171 .",
    "many times we will need to compare the number of letters @xmath102 in a factor of @xmath93 and in its image .",
    "the substitution rule leads to the equalities @xmath172 which can be inverted subsequently :    [ vzor ] for any factor @xmath4 of @xmath93 it holds @xmath173 balance bound with respect to the letter @xmath98 --------------------------------------------------------    we begin the proof of theorem [ balance ] by its second statement , i.e. we show at first that @xmath93 is 2-balanced with respect to the letter @xmath98 .",
    "as we will see , the determination of the balance bound with respect to the letter @xmath98 is by far the most complicated part of the work .",
    "[ balancem ] let @xmath4 , @xmath5 be factors of @xmath93 such that @xmath25 .",
    "then @xmath174        if we apply observations [ jednozvzor ] and [ pripustnevzor ] , eq .",
    "implies that the factor @xmath4 is an image of certain factor of @xmath93 whose first and last letters equal @xmath97 .",
    "this allows us to define a factor @xmath179 of @xmath93 in this way : @xmath181    the factor @xmath5 is not ready for a direct application of observation [ jednozvzor ] because of .",
    "for that reason we at first extend the factor @xmath5 to both sides up to the closest letter @xmath98 , i.e. we put @xmath182 where @xmath183 is a factor of @xmath93 and @xmath184 .",
    "now we can define a factor @xmath180 of @xmath93 by the relation @xmath185 let us show that the factor @xmath180 is shorter than @xmath4 and @xmath5 :    [ g kratsi ] it holds @xmath186 .    since @xmath187 , the factor @xmath4 contains at least 3 letters @xmath98 , and thus @xmath188 .",
    "observation [ mzm ] then implies that @xmath189 .    since @xmath19 , it holds @xmath190 , hence necessarily @xmath191 according to observation [ mzm ] .",
    "but then @xmath192 and @xmath193 where @xmath194 and @xmath195 for @xmath196 .",
    "one more application of observation [ mzm ] gives @xmath197 , hence @xmath198 and necessarily @xmath199 , i.e. @xmath200 where @xmath201 .",
    "we deduce from eqs .",
    ", , from @xmath195 and from the minimality of @xmath85 that @xmath202 , @xmath196 .",
    "the factor @xmath183 ( cf . and ) is given by @xmath203 , hence equality together with observation [ pripustnevzor ] imply @xmath204 where @xmath205 , @xmath206 and @xmath207 .",
    "hence @xmath208 , and consequently , using observation [ szs ] , @xmath209 and @xmath210 .",
    "the sought inequality @xmath186 follows from these relations : @xmath211 @xmath212 .",
    "factors @xmath179 , @xmath180 satisfy latexmath:[\\[\\begin{gathered }        both relations will be proved using the properties of @xmath4 , @xmath183 .",
    "let us begin with eq . .",
    "considering proposition [ vzor ] , we have @xmath214 .",
    "therefore , taking into account eq . , we obtain @xmath215 now we proceed to eq . .",
    "it holds @xmath216 for any factor @xmath140 ( cf . the substitution rule ) .",
    "the identity @xmath217 allows one to eliminate @xmath218 , hence @xmath219 , we have @xmath220 , equivalently @xmath221 . if we apply to the last inequality , we obtain @xmath222 now we substitute here from which leads to .",
    "there is another useful statement , namely proposition [ f - g<=0 ] , but to prove it we need one more observation which gives an estimate of the number of occurences of the letter @xmath98 in a factor of @xmath93 of a given length :    [ obsahm ] _ _ ( i)__for every factor @xmath223 of @xmath93 it holds @xmath224 .",
    "+ _ _ ( ii)__if moreover @xmath223 has a prefix or a suffix of the length greater or equal to @xmath225 that does not contain @xmath98 , it holds @xmath226 .",
    "\\(i ) observation [ mzm ] says that if @xmath142 is a factor of @xmath93 , then @xmath227 .",
    "consequently @xmath228 .",
    "the inequality @xmath229 holds trivially .",
    "+ ( ii ) let @xmath230 and @xmath231 then , employing the result of ( i ) , one has @xmath232 .",
    "[ f - g<=0 ] it holds @xmath233 , i.e. the factor @xmath179 is not longer than @xmath180 .",
    "let us suppose that the contrary is true , i.e. @xmath234 . let @xmath235 be the suffix of @xmath179 of the length @xmath236 and let @xmath237 .",
    "then it holds @xmath238 ( the inequality `` @xmath239 '' is valid due to observation [ g kratsi ] ) and @xmath240 .",
    "our goal is to estimate @xmath241 which is equal to @xmath242 . for this purpose",
    "an estimate for @xmath243 will be needed ; we obtain it from : @xmath244 .    as for @xmath245 , since @xmath179 is followed by @xmath97 , the last letter of @xmath235 is @xmath96 ( cf .",
    "observation [ pripustne ] ) . with regard to this fact ,",
    "observation [ obsahm ] implies @xmath246 .",
    "now we distinguish two cases : + @xmath247if @xmath248 , then @xmath249 , hence @xmath250",
    "@xmath247if @xmath251 , then @xmath252 , hence @xmath253 we see that for any value of @xmath254 , the factors @xmath255 and @xmath180 of @xmath93 are of the same length less than @xmath85 and satisfy .",
    "this is a contradiction with the minimality of @xmath85 .",
    "+      at this moment we define another pair of factors .",
    "since @xmath257 and @xmath258 are factors of @xmath93 , observation [ jednozvzor ] says that there exist factors @xmath109 and @xmath256 of @xmath93 such that @xmath259 and @xmath260    [ x , y kratsi ] it holds @xmath261 and @xmath262 , i.e. both factors @xmath109 , @xmath256 are shorter that @xmath4 , @xmath5 .",
    "we use propositions [ g kratsi ] and [ f - g<=0 ] : @xmath263 it holds latexmath:[\\[\\begin{gathered }        the proof of both statements is straightforward using the definitions of @xmath109 and @xmath256 , proposition [ vzor ] , the identity @xmath265 holding for any factor @xmath4 , and equality .",
    "proposition [ vztah xy ] has an immediate corollary :    latexmath:[\\[\\begin{gathered }        if we substitute for @xmath243 from to , we obtain . equality and proposition",
    "then give .    in what follows we split the proof according to the signum of @xmath267 , and",
    "we show that whatever the value of @xmath267 is , it always contradicts the minimality of @xmath85 .",
    "we set @xmath269 and denote @xmath270 , where @xmath271 is a factor of @xmath93 of the length @xmath236 such that @xmath272 is a factor of @xmath93",
    ". then @xmath273 .",
    "moreover @xmath274 due to proposition [ x , y kratsi ] .",
    "our goal is to estimate @xmath275 which is equal to @xmath276 . the difference @xmath277 can be estimated using inequality : @xmath278 .",
    "let us proceed to @xmath279 .",
    "recall at first that @xmath280 ( cf . ) .",
    "thus the last letter of the factor @xmath256 is either @xmath96 or @xmath98 , which implies , with respect to observation [ pripustne ] , that the first letter of @xmath271 is either @xmath96 or @xmath97 , i.e. different from @xmath98 .",
    "observation [ obsahm ] then gives @xmath281 .",
    "now we distinguish two cases : + @xmath247if @xmath248 , then @xmath282 , hence @xmath283 ; + @xmath247if @xmath251 , then @xmath284 , hence @xmath285 the factors @xmath109 and @xmath286 are of the same length less than @xmath85 and for any @xmath254 satisfy @xmath287 . in other words , they contradict the minimality of @xmath85 .",
    "equality implies @xmath289 , and we know from proposition [ f - g<=0 ] that @xmath290 . therefore : + @xmath247if @xmath291 or @xmath292 , we have @xmath293 .",
    "since moreover @xmath294 , we have arrived at a contradiction with the minimality of @xmath85 .",
    "+ @xmath247if @xmath295 and @xmath296 , equality gives @xmath297 .",
    "this , however , contradicts inequality .",
    "the last case to deal with is @xmath298 .",
    "since the situation @xmath299 is very complicated to study , we will start with the case @xmath300 and then deal with @xmath299 separately .",
    "let us set for simplicity @xmath301 .",
    "equality gives @xmath302 .",
    "we infer from here and from the minimality of @xmath85 that @xmath303 ( otherwise one could consider the prefix of @xmath179 of the length @xmath304 , denote it by @xmath305 , then @xmath306 , @xmath307 , which is a contradiction with the minimality of @xmath85 ) .    similarly , we infer from @xmath308 and from the minimality of @xmath85 that @xmath309 ( otherwise we denote the prefix of @xmath256 of the length @xmath310 by @xmath311 , then @xmath312 , @xmath313 ) .",
    "equality then gives an upper bound on @xmath314 , namely @xmath315 .",
    "let us denote @xmath316 , where @xmath317 is a factor of @xmath93 and @xmath318",
    ". then @xmath319 and @xmath238 , and it follows from that if @xmath320 , the factor @xmath235 can be chosen such that its first letter is @xmath97 , i.e. different from @xmath98 .",
    "now we are going to express @xmath241 which is equal to @xmath321 .",
    "let us distinguish the cases @xmath322 and @xmath323 .",
    "@xmath247if @xmath322 , we have @xmath324 or @xmath325 , hence @xmath326",
    ".    @xmath247let @xmath323 .",
    "note that at the same time it holds @xmath327 , thus necessarily @xmath328 .",
    "observation [ obsahm ] leads to @xmath329 then @xmath330 we conclude that for any @xmath331 it holds @xmath238 and @xmath332 . this is a contradiction with the minimality of @xmath85 .      in this case , equality implies @xmath333 and equality implies @xmath334 .    since @xmath335 , necessarily @xmath309 ( the contrary conradicts the minimality of @xmath85 ) , hence gives latexmath:[\\[\\label{-1fg }    @xmath299 , can occur only for @xmath296 , because :    * if @xmath15 was greater than 3 , inequality would contradict the inequality @xmath290 , derived in proposition [ f - g<=0 ] . *",
    "if @xmath15 was equal to 3 , inequality together with proposition [ f - g<=0 ] would give @xmath295 , which would not conform to .",
    "this allows us to restrict our considerations on the case @xmath296 .",
    "inequality implies @xmath337 , inequality implies @xmath338 , putting it together we infer @xmath339 .",
    "this allows us to use eq . to compute @xmath277 : we obtain @xmath340 .",
    "let us sum up the relations between @xmath109 and @xmath256 and between @xmath179 and @xmath180 : @xmath341 it holds :    * the word @xmath342 is a factor of @xmath93 and at it holds @xmath343 , * the word @xmath344 is a factor of @xmath93 and at it holds @xmath345 .",
    "the proof will be done in ten steps .",
    "_ step 1 . _",
    "( possible prefixes and suffixes of @xmath4 , @xmath183 ) + the following four statements hold :    * @xmath346 or @xmath347 , * @xmath348 or @xmath349 , * @xmath350 or @xmath351 , * @xmath352 or @xmath353 .",
    "we have found in the proof of observation [ g kratsi ] that @xmath354 where @xmath355 and @xmath202 for @xmath196 .",
    "taking into account observation [ mzm ] , we deduce that for @xmath296 , the prefix of @xmath183 and its suffix can be equal to either @xmath356 or @xmath357 , thus ( iii ) and ( iv ) are proved .    statements ( i ) and ( ii ) say in fact , with regard to observation [ mzm ] , that @xmath4 can not have the segment @xmath357 as its prefix and suffix , respectively .",
    "let us suppose to the contrary that e.g. @xmath358 .",
    "we define @xmath359 , then @xmath360 . at the same time we denote @xmath361 , where @xmath362 is the prefix of @xmath5 of the length 9 ( thus @xmath363 ) .",
    "since @xmath364 , it follows from observation [ mzm ] that @xmath362 contains exactly @xmath27 letter @xmath98 , hence @xmath365 .",
    "therefore @xmath366 , which is a contradiction with the minimality of @xmath85 .",
    "_ step 2 . _",
    "( possible prefixes and suffixes of @xmath179 , @xmath180 ) + it holds    * @xmath367 or @xmath368 , * @xmath369 or @xmath370 , * @xmath371 or @xmath372 , * @xmath373 or @xmath374 .",
    "it is a trivial consequence of step 1 and of the definitions of @xmath179 and @xmath180 .",
    "_ step 3 . _",
    "( the prefix and suffix of @xmath179 ) + it holds @xmath375 .",
    "we show that @xmath368 , the proof of @xmath370 would be similar .",
    "step 2 implies that @xmath376 or @xmath377 .",
    "let us suppose for a while that @xmath376 .",
    "we put @xmath378 ( it is a factor of @xmath93 , because @xmath379 is a factor of @xmath93 , cf . ) .",
    "then @xmath380 , @xmath381 .    since @xmath382 according to step 2 , we are allowed to set @xmath383 .",
    "then it holds @xmath384 , @xmath385 .    the factors @xmath255 and @xmath386 satisfy @xmath387 and @xmath388 , see .",
    "this is a contradiction with the minimality of @xmath85 .",
    "_ step 4 . _",
    "( the prefixes and suffixes of @xmath4 , @xmath183 and @xmath180 ) + it holds    * @xmath389 , * @xmath390 , * @xmath391 .    statement ( i ) is a straightforward consequence of step 3 .",
    "statement ( ii ) follows from ( i ) , which can be proven by contradiction using similar ideas as in the proof in step 1 .",
    "statement ( iii ) is a consequence of ( ii ) .",
    "_ ( the prefixes and suffixes of @xmath109 and @xmath256 ) + it holds    * @xmath392 or @xmath393 , * @xmath394 .    _ ( i ) _ since @xmath395 and @xmath396 according to step 3 , obviously @xmath392 or @xmath393 , cf .",
    "observation for @xmath296 . + _",
    "( ii ) _ it follows from step 4 that @xmath397 .",
    "observation [ pripustne ] implies @xmath398 , observation [ szs ] gives @xmath399 .",
    "_ step 6 . _",
    "( two letters after @xmath256 ) + the word @xmath400 is a factor of @xmath93 .",
    "it is a consequence of step 5 and observation [ szs ] .",
    "_ step 7 . _",
    "( the suffix of @xmath109 ) + it holds @xmath401 .",
    "we consider the result of step 5 and prove that @xmath402 contradicts the minimality of @xmath85 .",
    "let @xmath402 .",
    "observation [ mzm ] then implies that @xmath109 is followed either by @xmath161 or by @xmath403 . in the first case we define @xmath404 .",
    "taking into account , we see that the pair @xmath405 , @xmath256 contradicts the minimality of @xmath85 . in the case",
    "when @xmath109 is followed by the group @xmath403 , we define @xmath406 where @xmath407 is the prefix of @xmath109 of the length 2 ( i.e. @xmath408 or @xmath409 ) .",
    "also we define @xmath410 ( this is allowed due to step 6 ) .",
    "the pair @xmath405 , @xmath286 now contradicts the minimality of @xmath85 with regard to .",
    "_ step 8 . _",
    "( the letter before @xmath109 ) + the word @xmath342 is a factor of @xmath93 .",
    "since @xmath257 is a factor of @xmath93 and @xmath411 , it follows from observation [ pripustnevzor ] that @xmath342 or @xmath412 is a factor of @xmath93 .",
    "however , if @xmath412 is a factor of @xmath93 , then the factors @xmath412 and @xmath256 contradict the minimality of @xmath85 with regard to .    _ step 9 . _",
    "( the prefix of @xmath109 ) + it holds @xmath413 .",
    "since @xmath342 is a factor of @xmath93 according to step 8 and @xmath414 according to step 5 , the word @xmath415 is a factor of @xmath93 .",
    "observation [ pripustnevzor ] then gives @xmath416 .",
    "_ step 10 . _",
    "( two letters before @xmath256 ) + the word @xmath344 is a factor of @xmath93 .    step 5 and observation [ szs ] imply that @xmath417 or @xmath344 is a factor of @xmath93 .",
    "let us suppose for a while that @xmath418 is a factor of @xmath93 .",
    "observation [ mzm ] implies immediately that @xmath419 .",
    "we introduce the word @xmath420 which is a factor of @xmath93 due to step 6 .",
    "then we define @xmath421 , this is a factor of @xmath93 due to step 9 .",
    "it follows from that the factors @xmath405 , @xmath286 satisfy @xmath422 , @xmath423 , i.e. they contradict the minimality of @xmath85 .",
    "this finishes the proof of proposition [ slozite ] .",
    "the statement follows from the results of steps 5 , 7 , 8 , 9 , 10 .",
    "proposition [ slozite ] together with observation [ jednozvzor ] allow one to define factors @xmath424 and @xmath425 of @xmath93 such that @xmath426 it is obvious that @xmath427 , @xmath428 , hence @xmath429 , @xmath430 , cf .",
    "proposition [ x , y kratsi ] .",
    "proposition [ vzor ] and relations , enable us to compute @xmath431 , @xmath432 and also @xmath433 : @xmath434 + 2(|x|_s-|y|_s)=\\\\ = -(|x|-|y|)+3(|x|_s-|y|_s)+(|x|_m-|y|_m)=\\\\ = -(|x|-|y|)+3(|fs|_m-|gs|_m)+(|x|_m-|y|_m)=-(-1)+3\\cdot(-2)+2=-3\\,.\\end{gathered}\\ ] ] the pair @xmath424 , @xmath425 thus satisfy @xmath435 and @xmath436 .",
    "this is a contradiction with the minimality of @xmath85 .",
    "the proof of theorem [ balancem ] is completed .",
    "once we know that @xmath93 is @xmath30-balanced with respect to the letter @xmath98 , it is easy to prove that it is @xmath30-balanced with respect to the letter @xmath97 as well .",
    "[ balances ] let @xmath4 , @xmath5 be factors of @xmath93 such that @xmath25 .",
    "then @xmath437    we will proceed by contradiction .",
    "let us assume that there exist factors @xmath438 , @xmath16 of @xmath93 such that @xmath25 and @xmath439 .",
    "obviously one can suppose that @xmath440 .",
    "then , with regard to the substitution rule , one has @xmath441 , @xmath442 , @xmath443 since the factors @xmath4 and @xmath5 are of the same length , they satisfy @xmath444 with regard to theorem [ balancem ] , hence @xmath445 furthermore , since @xmath446 and @xmath447 , one has @xmath448 let @xmath449 be a prefix of @xmath450 of the length @xmath451 .",
    "then @xmath452 , hence @xmath453 and since it holds @xmath454 , we have arrived at a contradiction with theorem  [ balancem ] .",
    "this section is devoted to the proof of the third part of theorem [ balance ] . as we will see , we will use both facts proved in the previous two sections .",
    "[ balancel ] let @xmath4 , @xmath5 be factors of @xmath93 such that @xmath25 .",
    "then @xmath455    we will again proceed by contradiction .",
    "let us assume that there exist factors @xmath438 , @xmath16 of @xmath93 such that @xmath175 and @xmath456 , @xmath177 .",
    "the minimality of @xmath85 implies @xmath457 gives @xmath458 and since @xmath459 and @xmath444 by virtue of theorems [ balancem ] and [ balances ] , respectively , we infer @xmath460    note that since @xmath461 , observation [ pripustnevzor ] implies that there are @xmath462 and @xmath463 such that @xmath464 is a factor of @xmath93 .",
    "we employ these @xmath43 and @xmath465 and define factors @xmath466 and @xmath183 of @xmath93 in the following way : @xmath467 now we can apply observation [ jednozvzor ] which establishes the existence of factors @xmath109 and @xmath256 of @xmath93 satisfying @xmath468 obviously @xmath469 .",
    "we are going to compute @xmath470 and @xmath267 .",
    "for that purpose the following relations will be useful : @xmath471 employing these relations and propositon [ vzor ] , one can derive @xmath472 and @xmath473    since @xmath109 is shorter than @xmath256 , we consider the prefix of the factor @xmath256 of the length @xmath310 and denote it by @xmath286 ; it obviously holds @xmath474 .",
    "therefore @xmath475 in other words , the factors @xmath109 and @xmath286 contradict the minimality of @xmath85 .",
    "to complete the proof of theorem [ balance ] , we have to show that the bounds 3 , 2 and 2 corresponding to @xmath96 , @xmath97 and @xmath98 , respectively , are optimal .",
    "to demonstrate this fact it suffices to find three pairs of factors of @xmath93 , let us denote them by @xmath476 , @xmath477 and @xmath478 , such that    @xmath479    there are many possibilities , one can take for example :    * @xmath480 , @xmath481 + then @xmath482 , @xmath483 . * @xmath484 , @xmath485 + then @xmath486 , @xmath487 .",
    "* @xmath488 , @xmath489 + then @xmath490 , @xmath491 .",
    "in this section we will determine the optimal bound for the abelian complexity function @xmath94 of the infinite word @xmath93 , taking advantage of the results on optimal balance bounds that have been derived in the previous part of the paper .",
    "the set of factors of @xmath93 of the length @xmath85 will be denoted by @xmath84 , and the symbol @xmath88 will stand for the set of corresponding parikh vectors , i.e. @xmath492 .    [ mozpar ] for each @xmath493 there are numbers @xmath494 and @xmath495 such that @xmath496 , where @xmath497 consequently , @xmath498 .",
    "for each @xmath493 , theorem [ balances ] implies that @xmath499 thus there is an @xmath494 such that @xmath500 similarly , using theorem [ balancem ] , one finds that there is an @xmath495 such that @xmath501 since @xmath502 , we deduce that the set @xmath88 is a subset of @xmath503 , where @xmath504 , @xmath505 , are given by .    proposition [ mozpar ] gives an upper bound of @xmath94 , namely @xmath498 for every @xmath493 , but we can even say more . indeed ,",
    "theorem [ balancel ] implies that @xmath88 can not contain at the same time @xmath506 and @xmath507 , hence @xmath508 .",
    "in fact , the optimal bound is even lower , as we will show with the help of the following proposition .",
    "[ vylucujici ] there is no pair of factors @xmath4 , @xmath5 of @xmath93 such that their parikh vectors satisfy @xmath509 .",
    "we prove the statement by contradiction .",
    "let us suppose that there are factors @xmath4 and @xmath5 of @xmath93 satisfying latexmath:[\\[\\label{aclsm }    factors @xmath4 and @xmath5 are obviously of the same length which we denote by @xmath85 . if @xmath511 and @xmath177 , we may assume without loss of generality that @xmath512 ( if e.g. @xmath513 , we can replace the pair @xmath514 by @xmath515 ) .",
    "having this assumption and eqs . , we deduce @xmath516 because if e.g. @xmath517 , then the pair @xmath518 and @xmath519 contradicts theorem [ balancel ] .",
    "similarly , theorem [ balances ] implies that @xmath520    let @xmath521 and @xmath522 be such numbers and letters that the word @xmath523 is a factor of @xmath93 .",
    "it is a trivial fact that such @xmath524 , @xmath525 exist .",
    "moreover , observation [ pripustne ] implies @xmath131 , observation [ pripustnevzor ] gives @xmath526 .",
    "we take these @xmath524 and @xmath118 and define a factor @xmath466 of @xmath93 , and then define also a factor @xmath183 of @xmath93 : @xmath527 now we apply observation [ jednozvzor ] which says that there are factors @xmath109 and @xmath256 of @xmath93 such that @xmath528 let us write down the following relations between @xmath466 and @xmath4 and between @xmath183 and @xmath5 , @xmath529 and use them to express @xmath277 , @xmath530 ( note that @xmath531 ) , and also to express @xmath267 : @xmath532    _ statement . _ it holds    * @xmath533 , * @xmath534 .    both ( i ) and ( ii ) can be proved by contradiction :    _ ( i ) _ suppose that e.g. the first letter of @xmath256 is @xmath535 .",
    "we define @xmath536 , then @xmath273 and @xmath537 , which is a contradiction with theorem [ balancem ] .",
    "similarly we prove that the last letter of @xmath256 is @xmath98 .    _",
    "( ii ) _ suppose that @xmath538",
    ". we know from that also @xmath539 , hence @xmath540 . then gives @xmath541 .",
    "let @xmath542 be the last letter of @xmath256 and @xmath543 .",
    "then it holds @xmath544 and @xmath545 , which is a contradiction with theorem [ balancem ] .    statements ( i ) and ( ii ) can be used to determine the first three letters of @xmath5 : @xmath546 however , observation [ szs ] implies that no factor of @xmath93 can contain the segment @xmath547 .",
    "this is a contradiction , thus the proposition is proved .    _",
    "( i ) _ let @xmath93 be the fixed point of the substitution @xmath9 defined in .",
    "then its abelian complexity satisfies @xmath548 for all @xmath493 and for all @xmath13 .",
    "( ii ) _ the bound @xmath549 is optimal , i.e. it can not be improved . moreover , for any @xmath13 there is infinitely many numbers @xmath493 such that @xmath550 .    _",
    "( i ) _ since @xmath551 and @xmath552 , proposition [ vylucujici ] implies that the set @xmath88 can contain at most one of the vectors @xmath506 , @xmath553 and at most one of the vectors @xmath554 , @xmath507 .",
    "therefore @xmath88 has at most 7 elements , hence @xmath548 .    _",
    "( ii ) _ we prove ( ii ) by showing that there are infinitely many values @xmath493 with this property : there are @xmath549 factors of @xmath93 of the length @xmath85 such that their parikh vectors are mutually different .    for all @xmath555 ,",
    "we define two auxiliary words : @xmath556 _ statement .",
    "_ for each @xmath555 it holds :    _ ( i ) _ @xmath557 and @xmath558 are factors of @xmath93 ,    _ ( ii ) _ @xmath559 and @xmath560 are factors of @xmath93 ,    _ ( iii ) _",
    "@xmath557 has the suffix @xmath561 and @xmath559 has the suffix @xmath562 ,    _ ( iv ) _ @xmath563 .    to see ( i )",
    ", we observe that @xmath557 is a prefix of @xmath564 , thus obviously a factor of @xmath93 .",
    "moreover , since @xmath565 is a factor of @xmath93 ( cf .",
    "observation [ mzm ] ) , the word @xmath566 is a factor of @xmath93 as well .",
    "then it suffices to show that @xmath567 has the suffix @xmath562 for each @xmath555 , which can be done easily by induction .",
    "the proof of ( ii ) is similar : since @xmath568 is a factor of @xmath569 , @xmath559 is a factor of @xmath93 . to demonstrate that @xmath560 is a factor of @xmath93 , it suffices to realize that @xmath561 is a suffix of @xmath570 for all @xmath555 , which can be shown by induction .",
    "let us proceed to ( iii ) . by the definitions above",
    ", @xmath557 has the suffix @xmath570 , @xmath559 has the suffix @xmath571 .",
    "now we can use the facts known from ( i ) and ( ii ) , namely that @xmath572 and @xmath573 for all @xmath555 .",
    "the statement ( iv ) is a consequence of these two equalities : @xmath574    for each @xmath555 , the auxiliary factors @xmath557 and @xmath559 are intrumental to define another set of words that we denote @xmath575 : @xmath576    it follows from statement above that all the words @xmath575 are factors of @xmath93 of the same length @xmath577 .",
    "if we compare the numbers of letters @xmath96 , @xmath97 and @xmath98 in these factors , we find that their parikh vectors and mutually different .",
    "this means that @xmath550 for every @xmath578 , where @xmath555 , i.e. the function @xmath579 attains the value @xmath549 infinitely many times .",
    "we finish this section by two statements describing the lower bound and the range of @xmath94 .",
    "it holds @xmath580 for all @xmath493 and for all @xmath13 .    at first",
    "we show that for any prefix @xmath4 of @xmath93 , both @xmath581 and @xmath582 are factors of @xmath93",
    ". this will be obvious from these three simple facts : + _",
    "( i ) _ since @xmath583 is a factor of @xmath93 , both @xmath584 and @xmath585 are factors of @xmath93 for any @xmath555 . + _",
    "( ii ) _ it holds @xmath586 and @xmath587 for any @xmath555 . + _ ( iii ) _ there is an @xmath555 such that @xmath4 is a prefix of @xmath571 , and thus of @xmath570 .    statements ( i ) and ( ii ) imply that both @xmath588 and @xmath589 are factors of @xmath93 , and ( iii ) then implies that @xmath582 and @xmath581 are factors of @xmath93 as well .",
    "let now @xmath590 be the prefix of @xmath93 of the length @xmath85 and let @xmath591 be its parikh vector .",
    "we will show that then there are factors @xmath466 and @xmath592 of @xmath93 such that @xmath593 and @xmath594 .",
    "we distinguish three cases according to @xmath595 : + @xmath247 if @xmath596 , then we set @xmath597 , @xmath598 .",
    "+ @xmath247 if @xmath599 , it holds necessarily @xmath600 ( cf .",
    "observation [ pripustne ] ) . in this case",
    "we set @xmath601 , @xmath602 .",
    "+ @xmath247 if @xmath603 , it holds necessarily @xmath604 ( cf . again observation [ pripustne ] ) .",
    "we set @xmath597 , @xmath605 .",
    "it can be demonstrated that for each value @xmath606 there is an @xmath493 such that @xmath607 , but we omit the proof with regard to the length of the paper .",
    "we have studied balance properties and the abelian complexity of a certain class of infinite ternary words . we have found the optimal @xmath2 such that these words are @xmath2-balanced , and also the optimal bound for their abelian complexity functions .",
    "we have introduced a new notion , namely the property that a word is `` @xmath2-balanced with respect to the letter @xmath7 '' , which helped us to proceed more effectively from the knowledge of the balance properties to the estimate on @xmath94 .",
    "the class of words studied in this paper has one parameter @xmath13 .",
    "however , it emerged from our calculations that all the three optimal bounds for balances with respect to particular letters , as well as the optimal bound for the abelian complexity , are independent of the value of @xmath15 .",
    "the problem has one more aspect .",
    "so far the subword complexity and the abelian complexity are considered as highly independent of each other ( cf .",
    "e.g. the work of richome , saari and zamboni ) .",
    "however , our result can indicate that there are connections between them , for the present waiting for their discovery .",
    "it has been recently shown in @xcite that a fixed point of a canonical substitution associated with a non - simple cubic parry number has affine factor complexity if and only if it belongs just to the class with which we have dealt in this paper .",
    "therefore , briefly speaking , `` if the factor complexity is affine , then the abelian complexity has the optimal bound @xmath549 '' holds in the cubic non - simple parry case .",
    "we remark that this sort of statement holds as well in the quadratic non - simple parry case , although there it is a trivial fact .",
    "the author is grateful to k. binda for performing a numerical experiment and to e. pelantov for helpful discussions on various aspects of the problem .",
    "balkov , e. pelantov , o. turek , combinatorial and arithmetical properties of infinite words associated with quadratic non - simple parry numbers .",
    "_ rairo _ : theoret . informatics appl .",
    "* 41 * 3 ( 2007 ) 307328 ."
  ],
  "abstract_text": [
    "<S> a word @xmath0 defined over an alphabet @xmath1 is @xmath2-balanced ( @xmath3 ) if for all pairs of factors @xmath4 , @xmath5 of @xmath0 of the same length and for all letters @xmath6 , the difference between the number of letters @xmath7 in @xmath4 and @xmath5 is less or equal to @xmath2 . in this paper </S>",
    "<S> we consider a ternary alphabet @xmath8 and a class of substitutions @xmath9 defined by @xmath10 , @xmath11 , @xmath12 where @xmath13 . </S>",
    "<S> we prove that the fixed point of @xmath9 , formally written as @xmath14 , is 3-balanced and that its abelian complexity is bounded above by the value 7 , regardless of the value of @xmath15 . </S>",
    "<S> we also show that both these bounds are optimal , i.e. they can not be improved .    </S>",
    "<S> laboratory of physics , kochi university of technology + tosa yamada , kochi 782 - 8502 , japan + email : ` ondrej.turek@kochi-tech.ac.jp ` </S>"
  ]
}