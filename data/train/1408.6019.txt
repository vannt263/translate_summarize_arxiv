{
  "article_text": [
    "pairs of partitions of a given set of objects occur naturally when evaluating two alternative clusterings in the field of data analysis and data mining .",
    "a _ clustering _",
    "partitions a set of objects into _ blocks _ or _ clusters _",
    ", such that objects in the same cluster are more similar ( according to some notion of similarity ) than objects in different clusters .",
    "there are a multitude of clustering algorithms that use , e.g. , an underlying graph structure or an attribute - based distance measure to define similarities",
    ". many algorithms also provide configurable parameter settings .",
    "consequently , different algorithms return different clusterings and judging which clustering is the most meaningful with respect to a certain interpretation of the data must be done by a human expert . for a structural comparison of two clusterings",
    "several numeric measures exist  @xcite , however , a single numeric value hardly shows where the clusterings agree or disagree .",
    "hence , a data analyst may want to compare different clusterings visually , which motivates the study of simultaneous embeddability of two partitions .",
    "we provide fundamental characterizations and complexity results regarding the simultaneous embeddability of a pair of partitions . while simultaneous embeddability can generally be defined for any number @xmath0 of partitions , we focus on the basic case of embedding _ two _ partitions , which is also the most relevant one in the data analysis application . we propose to embed two alternative partitions of the same set @xmath1 into the plane @xmath2 by mapping each element of @xmath1 to a unique point and each block ( of either of the two partitions ) to a region bounded by a simple closed curve .",
    "each block region must contain all points that belong to elements in that block and no point whose element belongs to a different block .",
    "hence , in total , each point lies inside two block regions .",
    "a simultaneous embedding of two partitions shares certain properties with set visualizations like euler or venn diagrams  @xcite .",
    "its readability will be affected by well - formedness conditions for the intersections of the different block regions .",
    "accordingly , we define a ( strict ) hierarchy of embeddability classes based on increasingly tight well - formedness conditions : _ weak _ , _ strong _ , and _ full _ embeddability .",
    "we show that ( i ) any two partitions are weakly embeddable , ( ii ) the decision problem for strong embeddability is -complete , and ( iii ) there is a linear - time decision algorithm for full embeddability .",
    "we fully characterize the embeddability classes in terms of the existence of a planar support ( strong embeddability ) or in terms of the planarity of the bipartite map ( full embeddability ) .",
    "interestingly , both concepts are closely related to hypergraph embeddings and different notions of hypergraph planarity .",
    "our -completeness result implies that vertex - planarity testing of 2-regular hypergraphs is also -complete .",
    "in information visualization there are a large variety of techniques for visualizing clusters of objects , some of which simply map objects to ( colored ) points so that spatial proximity indicates object similarity  @xcite , others explicitly visualize clusters or general sets as regions in the plane  @xcite .",
    "these approaches are visually similar to euler diagrams  @xcite , however , they do not give hard guarantees on the final set layout , e.g. , in terms of intersection regions or connectedness of regions , nor do they specifically consider the simultaneous embedding of two or more clusterings or partitions .    _",
    "clustered planarity _ is a concept in graph drawing that combines a planar graph layout with a drawing of the clusters of a single hierarchical clustering .",
    "clusters are represented as regions bounded by simple closed and pairwise crossing - free curves .",
    "such a layout is called _ c - planar _ if no edge crosses a region boundary more than once  @xcite .",
    "the simultaneous embedding of two planar graphs on the same vertex set is a topic that is well studied in the graph drawing literature , see the recent survey of blsius et al .",
    "@xcite . in a simultaneous graph embedding each vertex",
    "is located at a unique position and edges contained in both graphs are represented by the same curve for both graphs .",
    "the remaining ( non - shared ) edges are embedded so that each graph layout by itself is crossing - free , but edges from the first graph may cross edges in the second graph . some of our results and concepts in this paper can be seen as a generalization of simultaneous graph embedding to simultaneous hypergraph embedding if we consider blocks as hyperedges : all vertices are mapped to unique points in the plane and two hyperedges , represented as regions bounded by simple closed curves , may only intersect if they belong to different hypergraphs or if they share common vertices .",
    "several concepts for visualizing a single hypergraph are known  @xcite , but to the best of our knowledge the simultaneous layout of two or more hypergraphs has not been studied .",
    "let @xmath3 be a finite universe .",
    "a _ partition _",
    "@xmath4 of  @xmath1 groups the elements of @xmath1 into disjoint _ blocks _ ,",
    "i.e. , every element @xmath5 is contained in exactly one block @xmath6 . in this paper , we consider pairs @xmath7 of partitions of the same universe @xmath1 , i.e. , each element @xmath8 is contained in one block of @xmath9 and in one block of @xmath10 . in",
    "the following we often omit to mention  @xmath1 explicitly .",
    "let @xmath11 be a collection of subsets of  @xmath1 .",
    "an _ embedding _",
    "@xmath12 of @xmath11 maps every element to a distinct point @xmath13 and every set @xmath14 to a simple , bounded , and closed region @xmath15 such that @xmath16 if and only if @xmath17 .",
    "moreover , we require that each contiguous intersection between the boundaries of two regions is in fact a _ crossing point _",
    "@xmath18 , i.e. , the local cyclic order of the boundaries alternates around @xmath19 .",
    "a _ simultaneous embedding _",
    "@xmath12 of a pair of partitions @xmath7 is an embedding of the union @xmath20 of the two partitions . we define @xmath21 as the _ block region _ of a block @xmath22 and denote its boundary by @xmath23 .",
    "figure  [ fig : embedding - examples ] shows examples of simultaneous embeddings in the three different embedding classes to be defined in section  [ s : mce ] .",
    "a simultaneous embedding @xmath12 induces a subdivision of the plane and we can derive a plane multigraph @xmath24 by introducing a node for each intersection of two boundaries and an edge for each section of a boundary that lies between two intersections .",
    "furthermore , a boundary without intersections is replaced by a node with a self loop nested inside its surrounding face .",
    "we call @xmath24 the _ contour graph _ of @xmath12 and its dual graph @xmath25 the _ dual graph _ of @xmath12 .",
    "the faces of  @xmath24 belong to zero , one , or two block regions .",
    "we call a face that belongs to no block region a _ background face _ , a face that belongs to a single block region a _ linking face _ , and a face that belongs to two block regions an _ intersection face_. only intersection faces contain points corresponding to elements in the universe , and no two faces of the same type are adjacent in the contour graph .",
    "alternatively , the union of the two partitions @xmath26 can also be seen as a hypergraph @xmath27 , where every element  @xmath8 is a vertex and every block defines a hyperedge , i.e. , a non - empty subset of @xmath1 .",
    "the hypergraph @xmath28 is _ 2-regular _ since every vertex is contained in exactly two hyperedges .",
    "we denote @xmath29 as the _ corresponding hypergraph _ of the pair of partitions @xmath7 .",
    "_ hypergraph supports _",
    "@xcite play an important role in hypergraph embeddings and their planarity .",
    "a support of a hypergraph @xmath30 is a graph @xmath31 on the vertices of @xmath28 , such that the _ induced subgraph _ @xmath32 $ ] of every hyperedge @xmath33 is connected .",
    "we extend the concept of supports to pairs of partitions , i.e. , we say that a graph @xmath31 is a support for @xmath7 , if it is a support of @xmath34 .",
    "we call a support _ path based _ , if the induced subgraphs of all hyperedges are paths , and _ tree based _ , if all hyperedge - induced subgraphs are trees , i.e. , they do not contain any cycles . for any support @xmath35 of a pair of partitions",
    "@xmath36 we can always create a tree - based support @xmath37 by removing edges from cycles : suppose there exists a block @xmath38 such that @xmath39 $ ] contains a cycle  @xmath40 .",
    "if the vertices in  @xmath40 are also contained in a common block of @xmath10 , we can just remove a random edge from @xmath40 without destroying the support property .",
    "otherwise , we can remove an edge from @xmath40 that connects vertices in two different blocks of @xmath10 without destroying the support property .",
    "the _ bipartite map _",
    "@xmath41 of a hypergraph @xmath42 is defined as the bipartite graph  @xmath43 that has a node for each vertex in  @xmath44 and for each hyperedge in  @xmath45  @xcite .",
    "a node  @xmath46 is adjacent to a node  @xmath47 if  @xmath48 .",
    "we say that  @xmath41 is the bipartite map of a pair of partitions @xmath49 if  @xmath29 .",
    "finally , we define the _ block intersection graph _ @xmath50 as the graph with vertex set @xmath51 and edge set @xmath52 . thus @xmath53 has a vertex for each block and an edge between any two blocks that share a common element . since only blocks of different partitions can intersect , we know that @xmath53 is bipartite .",
    "we define three main concepts of simultaneous embeddability for pairs of partitions .",
    "we will see that these concepts induce a hierarchy of embeddability classes of pairs of partitions .",
    "we begin with _ weak embeddability _ , which is the most general concept .",
    "[ def : weak ] a simultaneous embedding of two partitions is _ weak _ if no two block regions of the same partition intersect . two partitions are _ weakly embeddable _ if they have a weak simultaneous embedding .",
    "prohibiting intersections of block regions of the same partition is our first well - formedness condition .",
    "a weak embedding emphasizes the fact that the blocks in each partition are disjoint . since the blocks of any partition are disjoint by definition , it is not surprising that any pair of partitions is weakly embeddable ( see fig .",
    "[ sfg : weak ] for an example ) .",
    "[ thm : weakly_embeddable ] any two partitions of a common universe are weakly embeddable on any point set .    a spanning forest ( in fact , any planar graph ) on  @xmath54 nodes",
    "can always be drawn in a planar way on any fixed set of  @xmath54 points in the plane  @xcite .",
    "let now @xmath55 be a partition .",
    "we choose arbitrary , but distinct points in the plane for the elements of @xmath1 .",
    "we then generate a spanning tree on the elements in each block and embed the resulting forest in a planar way on the points . slightly inflating the thickness of the edges of the trees",
    "yields simple bounded block regions .",
    "we can do this independently for a second partition on the same points and obtain a weak simultaneous embedding .    although the concept of weak embedding does not seem to provide interesting insights into the structure of a given pair of partitions , it guarantees at least the existence of a simultaneous embedding for any pair of partitions that is more meaningful than an arbitrary embedding .",
    "an obvious drawback of weak embeddings is that the block regions of disjoint blocks are allowed to intersect , as long as both blocks belong to different partitions  even if they do not share common elements .      following the general idea of euler diagrams  @xcite , which do not show regions corresponding to empty intersections , we establish a stricter concept of embeddability .",
    "in a strong embedding block regions may only intersect if the corresponding blocks have at least one element in common , and even more , each intersection face of the contour graph must actually contain a point , see fig .",
    "[ sfg : strong ] .",
    "this is our second well - formedness condition .",
    "[ def : strong ] a simultaneous embedding @xmath12 of two partitions is _",
    "strong _ if each intersection face of the corresponding contour graph contains a point @xmath56 for some @xmath8 .",
    "two partitions are _ strongly embeddable _ if they have a strong simultaneous embedding .",
    "obviously , a strong embedding is also weak , since blocks of the same partition have no common elements , and thus , can not form intersection faces .",
    "the class of strongly embeddable pairs of partitions is characterized by theorem  [ thm : se_vertex_planar ] ; we show in section  [ s : cdse ] that deciding the strong embeddability of a pair of partitions is -complete .",
    "[ thm : se_vertex_planar ] a pair of partitions of a common universe is strongly embeddable if and only if it has a planar support .",
    "let  @xmath36 be a pair of partitions and let  @xmath24 be the contour graph resulting from a strong embedding  @xmath12 of @xmath36 .",
    "we construct a planar support of  @xmath36 along  @xmath24 as follows .",
    "first recall that the elements of the universe , which correspond to the nodes in a support , are represented in  @xmath12 by points that are drawn inside intersection faces .",
    "vice versa , since  @xmath12 is strong , each intersection face contains at least one point .",
    "hence , we choose one point in each intersection face as the _ center _ of this face .",
    "we now create a dummy vertex for each linking face ( observe that one block region may induce several linking faces ) and link it to the centers of all adjacent intersection faces .",
    "the resulting graph is a subgraph of the dual graph of the contour graph  @xmath24 and therefore planar .",
    "we now connect all remaining vertices in a star - like fashion to the center of their intersection face , routing the edges in a non - crossing way .",
    "we finally remove the dummy vertices by merging them to an adjacent center , linking all adjacent vertices to that center .",
    "this graph remains planar .",
    "it also has the support property , since all intersection and linking faces of any block region are connected into a single component , and with them all vertices of that block region .",
    "now we construct a strong embedding from a planarly embedded support of  @xmath36 . to this end",
    ", we first construct a tree - based support by deleting edges from cycles as described in section  [ sec : prelim ] .",
    "then , we simply inflate the edges of each block - induced subtree .",
    "since the underlying support is embedded in a planar way , this yields a simple block region for every block in @xmath36 such that two block regions only intersect at the positions of the nodes .",
    "hence , the constructed block regions together with the nodes of the support form a strong embedding of  @xmath57 .",
    "we note that the support graph as a planar graph can in fact be embedded on any point set  @xcite .",
    "hence , a strongly embeddable pair of partitions can be strongly embedded on any point set .      in a strong embedding ,",
    "a single block region may still cross other block regions and intersect the same block regions several times forming distinct intersection faces  as long as each intersection face contains at least one common point .",
    "the last of our three embeddability classes prevents this behavior and requires that the block regions form a collection of _ pseudo - disks _",
    "i.e. , the boundaries of every pair of regions intersect at most twice and the boundaries of two nested regions do not intersect .",
    "see fig  [ sfg : full ] for an example .",
    "this implies in particular that every block intersection is connected , which is a well - formedness condition widely used in the context of euler diagrams  @xcite , and that block regions do not cross and are thus more locally confined .",
    "[ def : full ] a simultaneous embedding of two partitions is _ full _ if it is a strong embedding and the regions form a collection of pseudo - disks .",
    "two partitions are fully embeddable if they have a full simultaneous embedding .",
    "using a linear - time algorithm for planarity testing  @xcite , the following characterization of fully embeddable pairs of partitions directly implies a linear - time algorithm for deciding full embeddability .",
    "[ thm : charfull ] a pair of partitions of a common universe is fully embeddable if and only if its bipartite map is planar .",
    "let  @xmath7 be a pair of partitions and  @xmath25 the dual graph of a corresponding full embedding  @xmath12 .",
    "the bipartite map of @xmath58 can be constructed as follows .",
    "remove all vertices ( and incident edges ) from  @xmath25 that stem from a background face in the contour graph ( fig .",
    "[ sfg : clus ] and fig .",
    "[ sfg : dual ] ) .",
    "this results in a planar graph with a set of _ red _ nodes resulting from intersection faces , a set of _ green _ nodes resulting from linking faces and edges indicating that two faces in the contour graph are adjacent .",
    "our definitions of simultaneous embedding and contour graph ensures that nodes of the same color are not adjacent .",
    "hence , the graph constructed so far is bipartite .",
    "moreover , each red node is adjacent to at most two green nodes and , since  @xmath12 is full ( more precisely , since each intersection face in the contour graph is adjacent to at most two linking faces ) , two green nodes have at most one red common neighbor . from the same fact",
    "it further follows that each block region in  @xmath12 induces at most one linking face in the contour graph , and thus , the number of green nodes is at most the number of blocks in  @xmath59 .    if there are fewer green nodes than blocks in  @xmath60 , at least one block region in  @xmath12 must be completely contained in another block region resulting in a red node for the intersection but no green node which could be considered as a representative of the nested block .",
    "hence , the red node representing the intersection is only adjacent to one green node , namely the green node resulting from the linking face of the block region that contains the nested block .",
    "note that no three block regions can be nested , since each point in  @xmath12 is contained in exactly two block regions . in this case",
    ", we link an additional green node to the red node of the nested block region such that in the end each block in  @xmath58 corresponds to a green node and each red node is adjacent to exactly two green nodes .",
    "such an additional leaf obviously preserves planarity ( fig .",
    "[ sfg : dual ] ) .",
    "since the bipartite map of a hypergraph ( besides the nodes representing blocks ) consists of nodes representing the elements in the universe , we finally replace each red node by a set of nodes representing the elements that have been mapped by  @xmath12 into the corresponding intersection face , and connect each of these new nodes along the previous edges to the two green nodes previously adjacent to the replaced red node .",
    "this again preserves planarity of the finally resulting bipartite map of @xmath60 ( fig .",
    "[ sfg : bipart ] ) .",
    "now assume a planar embedding of the bipartite map of  @xmath57 with green nodes representing the blocks and black nodes representing the elements of the universe . in order to construct a full embedding of  @xmath36",
    ", we first construct for each block in @xmath36 a subgraph of the bipartite map such that each subgraph contains the green node that represents the corresponding block and two subgraphs share exactly one black node if and only if the corresponding blocks share at least one element .",
    "since the map of  @xmath36 is bipartite , each of these subgraphs is a star with black leaves linked to a green center .",
    "together these stars form a planar subgraph of the bipartite map such that slightly inflating the edges in each star yields simple block regions that intersect exactly at the positions of the black nodes . in the resulting contour graph , two block regions thus intersect at most once and each intersection face is adjacent to exactly two linking faces , each representing a block . a nested block in @xmath61 results in a star that only consists of a green center and one black leaf .",
    "in order to completely satisfy the condition of a full embedding , we shrink the block regions of nested blocks such that the boundary of the inner block does not intersect the boundary of the outer block . deleting the green and black nodes and drawing a set of points that represent the common elements of the intersecting blocks in each intersection face finally yields a full embedding .    we note that our construction uses only a single representative element per block intersection .",
    "thus , in contrast to weak and strong embeddings , it is not clear whether a fully embeddable pair of partitions permits a full embedding on any set of points .",
    "a full embedding is strong by definition and we have seen above that a strong embedding is also weak . hence , the three embeddability classes introduced in this section induce a hierarchy of embeddability classes .",
    "we now show that this hierarchy is strict .    the left side of fig .",
    "[ sfg : strongnotfull ] shows a strong embedding of a pair of partitions  @xmath62 that is not fully embeddable .",
    "the dotted lines indicate a planar support proving the strong embeddability of @xmath62 .",
    "the fact that  @xmath62 is not fully embeddable can be seen by considering the bipartite map of  @xmath63 , which is a subdivision of  @xmath64 , and thus , is not planar ( see right side of  fig .",
    "[ sfg : strongnotfull ] ) .",
    "the claim then follows from theorem  [ thm : charfull ] .    in order to prove that the class of strong embeddability is a proper subclass of weak embeddability",
    ", we take a detour via string graphs .",
    "a graph  @xmath65 is a _ string graph _ if there exists a set  @xmath66 of curves in the plane such that  @xmath67 if and only if  @xmath68 .",
    "deciding whether a graph is a string graph is -hard  @xcite .",
    "however , schaefer and stefankovic  @xcite showed that a graph is _ no _ string graph if it is constructed from a non - planar graph by subdividing each edge at least once . together with the following lemma we can thus prove that the pair of partitions shown in fig .",
    "[ sfg : weaknotstrong ] is not strongly embeddable .",
    "[ lem : strongstring ] the block intersection graph of a strongly embeddable pair of partitions is a string graph .",
    "let  @xmath12 be a strong embedding of a pair of partitions  @xmath62 .",
    "our goal is to construct a set  @xmath69 of curves in the plane , which correspond to the blocks in  @xmath70 such that  @xmath71 if and only if  @xmath22 and  @xmath72 share a common element .",
    "this is equivalent to the assertion that the block intersection graph @xmath73 is a string graph .",
    "we construct  @xmath74 along  @xmath12 as follows .",
    "first we delete the points in  @xmath75 .",
    "then we delete one point of the boundary of each block region that is not an intersection point .",
    "this results in a set  @xmath76 of curves that correspond to the blocks in @xmath77 , and since  @xmath12 is strong , two curves have a common point if and only if the corresponding blocks have at least one common element and the previous block regions were not nested in  @xmath12 . for blocks",
    "whose block regions are nested in  @xmath12 , we replace the curve that represents the nested block by a curve that crosses the surrounding block curve .",
    "this finally yields the desired set of curves .",
    "now consider the pair of partitions in fig .",
    "[ sfg : weaknotstrong ] . the left side of fig .",
    "[ sfg : weaknotstrong ] shows a weak embedding while the right side shows the corresponding block intersection graph , which is constructed from  @xmath78 by subdividing each edge exactly once .",
    "consequently , since  @xmath78 is not planar , it is no string graph ( according to schaefer and stefankovic  @xcite ) . applying lemma  [ lem : strongstring ]",
    "finally proves that the pair of partitions depicted in fig .",
    "[ sfg : weaknotstrong ] is not strongly embeddable .      the weak embeddability class forms the basis of the hierarchy and contains all pairs of partitions . the strong embeddability class and the full embeddability class",
    "are characterized by the existence of a planar support and the planarity of the bipartite map of a pair of partitions , respectively , where the latter directly implies a linear time algorithm for the corresponding decision problem . moreover , these characterizations reveal close relations to the hypergraph planarity concepts of _ zykov _ and _ vertex planarity_.    a hypergraph @xmath30 is zykov - planar  @xcite , if there exists a subdivision of the plane into faces , such that each hyperedge @xmath33 can be mapped to a face of the subdivision , and each vertex @xmath79 can be mapped to a point on the boundary of all faces that represent a hyperedge containing  @xmath80 .",
    "walsh  @xcite showed that a hypergraph is zykov planar if and only if its bipartite map is planar .",
    "in contrast , a hypergraph @xmath30 is vertex - planar  @xcite if there exists a subdivision of the plane into faces , such that every vertex @xmath79 can be mapped to a face and for every hyperedge @xmath33 , the interior of the union of all faces of the vertices in @xmath81 is connected .",
    "kaufmann et al .",
    "@xcite showed that a hypergraph is vertex planar if and only if it has a planar support .",
    "this shows that the class of _ fully _ embeddable pairs of partitions is a subclass of zykov planar hypergraphs , and the class of _ strongly _ embeddable pairs of partitions is a subclass of vertex planar hypergraphs .",
    "in this section we show the -completeness of testing strong embeddability . as a consequence , testing whether the corresponding hypergraph of a pair of partitions has",
    "a planar support is also -complete by theorem  [ thm : se_vertex_planar ] .",
    "this seems not very surprising considering the more general hardness results of johnson and pollak  @xcite and buchin et al .",
    "@xcite who showed that deciding the existence of a planar support and a 2-outerplanar support in general hypergraphs is -hard .",
    "however , we consider a restricted subclass of 2-regular hypergraphs , thus , the -hardness of our problem does not directly follow from the previous results .",
    "moreover , other special cases , e.g. , finding path , cycle , tree , and cactus supports are known to be solvable in polynomial time  @xcite . together with the characterization of theorem  [ thm : se_vertex_planar ] , theorem  [ thm : stronghard ]",
    "immediately implies that testing the vertex planarity of a 2-regular hypergraph is -complete .",
    "[ thm : stronghard ] deciding the strong embeddability of a pair of partitions is -complete .",
    "the existing hardness results  @xcite rely on elements that are contained in more than two hyperedges and could not be adapted to our 2-regular setting .",
    "instead we prove the hardness of deciding strong embeddability by a quite different reduction from the -complete problem monotone planar 3sat  @xcite .",
    "a monotone planar 3sat formula  @xmath82 is a 3sat formula whose clauses either contain only positive or only negated literals ( we call these clauses _ positive _ and _ negative _ ) and whose variable - clause graph @xmath83 is planar .",
    "a _ monotone rectilinear representation _ ( mrr ) of @xmath82 is a drawing of @xmath83 such that the variables correspond to axis - aligned rectangles on the x - axis and clauses correspond to non - crossing e - shaped `` combs '' above the x - axis if they contain only positive variables and below the x - axis otherwise ; see fig .",
    "[ fig : planar_monotone_3_sat ] .",
    "an instance of monotone planar 3sat is an mrr of a monotone planar 3sat formula  @xmath82 . in the proof of theorem  [ thm : stronghard ] we will construct a pair of partitions  @xmath84 that admits a strong embedding if and only if  @xmath82 is satisfiable .    for the sake of simplicity , we restrict the class of strong embeddings to the subclass of _ proper strong embeddings _ , which is equivalent , as we can argue that a pair of partitions has a strong embedding if and only if it also has a proper one .",
    "a strong embedding is _ proper _ if the contour graph does not contain background or linking faces that are adjacent to only two other faces .",
    "figure  [ fig : proper ] illustrates how background or linking faces violating this condition can be removed , transforming a strong embedding into a proper one .",
    "we say that two proper strong embeddings are _ equivalent _ if the embeddings of their contour graphs are equivalent , i.e. if the cyclic order of the edges around each vertex is the same .",
    "a pair of partitions has a _ unique strong embedding _ if all proper strong embeddings are equivalent .",
    "note that , analogously to the definition of equivalence of planar graph embeddings , two equivalent proper strong embeddings may have different unbounded outer background faces .",
    "our construction in the hardness proof is independent of the choice of the outer face .",
    "next we define a special pair of partitions that has a unique grid - shaped embedding as a scaffold for the gadgets in the subsequent proof of theorem  [ thm : stronghard ] .",
    "the first step is to construct a base graph @xmath85 for two integers  @xmath86 and  @xmath54 .",
    "the graph @xmath85 is a grid with @xmath87 columns and @xmath88 rows of vertices with integer coordinates @xmath89 for @xmath90 and @xmath91 .",
    "each vertex @xmath80 with coordinates @xmath89 is connected to the four vertices at coordinates @xmath92 ( if they exist ) . between the middle rows",
    "@xmath86 and @xmath93 we remove all vertical edges except for those in columns @xmath94 .",
    "this defines @xmath54 larger grid cells of width  @xmath86 in this particular row .",
    "figure  [ fig : grid ] ( left ) shows an example .     and the partitions @xmath95 sketched for the top - left grid cell marked in gray .",
    "]    from @xmath85 we construct a pair of partitions @xmath96 as follows ( see fig .  [",
    "fig : grid ] ) . for each vertex  @xmath80 with coordinates @xmath89 we create a _",
    "vertex block _ @xmath97 in partition @xmath98 . for each edge",
    "@xmath99 in @xmath85 we create a chain of four _ edge blocks _ @xmath100 , @xmath101 , @xmath102 , @xmath103 , such that @xmath100 and @xmath102 are in the same partition as @xmath97 and @xmath101 and @xmath103 are in the same partition as @xmath104 .",
    "we distribute five distinct elements among the edge blocks of @xmath99 and the vertex blocks for @xmath105 and @xmath80 such that they form the desired chain pattern and each intersection face contains one common element .",
    "the pair @xmath106 is indeed a pair of partitions as every element belongs to exactly one block of each partition .",
    "edge blocks contain two and vertex blocks up to four elements ( depending on the degree of the corresponding vertex in @xmath85 ) .",
    "below we will add the gadgets of the reduction on top of @xmath106 , for which it is required that there is an edge block in each partition that does not share any element with a vertex block .",
    "this explains why we link blocks of adjacent vertices by chains of four blocks .",
    "the next lemma shows that @xmath106 has a unique embedding , which is a consequence of the fact that @xmath85 is a subdivision of a planar 3-connected graph ( assuming @xmath107 ) and thus it has a unique embedding .",
    "this property is inherited by @xmath106 in our construction .",
    "[ lem : unique_embed ] the pair of partitions @xmath106 has a unique embedding .",
    "first , we observe that the base graph @xmath85 is a subdivision of a planar 3-connected graph ( assuming @xmath108 ) and thus it has a unique embedding ( up to the choice of the outer face ) in the plane .",
    "we claim that this property is inherited by @xmath106 in our construction .",
    "each edge block contains exactly two elements and intersects exactly two blocks of the other partition .",
    "thus its contour subgraph in any proper strong embedding is isomorphic to the 4-cycle @xmath109 with two non - incident duplicate edges inside , which belong to the boundaries of the two intersecting blocks . each vertex block @xmath97 contains two , three , or four elements , depending on the degree @xmath110 of @xmath80 in @xmath85 .",
    "since @xmath97 intersects with @xmath110 edge blocks of the other partition there are exactly two intersection points with the boundary of each of these edge blocks in a proper strong embedding ( if there were four intersection points , then the edge block would not be proper ) .",
    "thus the contour subgraph of @xmath97 is a 4- , 6- , or 8-cycle with two , three , or four non - incident duplicate edges inside belonging to the intersecting edge blocks .",
    "there is a bijection between the possible cyclic intersection orders of the @xmath110 edge blocks and the possible cyclic orders of the @xmath110 incident edges of vertex @xmath80 in @xmath85 .",
    "thus we have locally the same embedding choices of the contour graph of @xmath111 as for the vertex @xmath80 in @xmath85 .",
    "since @xmath85 has a unique embedding , and since each edge of @xmath85 is represented in @xmath106 by a sequence of four edge blocks with a locally unique embedding between the two incident vertex blocks , we conclude that for every proper strong embedding of @xmath106 the induced contour graph is the same graph with the same unique planar embedding .",
    "otherwise we could derive two different embeddings of @xmath85 , which is a contradiction .",
    "now we have all the tools that we need to prove our main theorem in this section .",
    "first we show that the problem is in . by theorem  [ thm : se_vertex_planar ] we know that a pair of partitions is strongly embeddable if and only if it has a planar support .",
    "thus we can `` guess '' a graph on @xmath1 and then test its planarity and support property in polynomial time .",
    "this shows membership in .",
    "it remains to describe the hardness reduction .",
    "let @xmath82 be a planar monotone 3sat formula together with an mrr .",
    "first we construct the pair of partitions @xmath106 for the base graph @xmath85 , where @xmath86 is the number of clauses of @xmath82 and @xmath54 is the number of variables of @xmath82 .",
    "by lemma  [ lem : unique_embed ] @xmath106 has a unique proper grid - like embedding .",
    "we call @xmath106 the _ base grid _ and the @xmath54 special cells between rows @xmath86 and @xmath93 the _ variable cells _ of the base grid .",
    "next we augment the pair of partitions @xmath112 by additional blocks , one for each clause , where positive clauses are added to @xmath113 and negative clauses to @xmath114 .",
    "the definition of these _ clause blocks _ closely follows the layout of the given mrr , see fig .",
    "[ fig : planar_monotone_3_sat ] .",
    "let @xmath115 be the positive clauses of @xmath82 ordered so that if @xmath116 is nested inside the e - shape of @xmath117 in the given mrr then @xmath118 . analogously let @xmath119 be the ordered negative clauses .",
    "we describe the definition of the block @xmath120 for a positive clause @xmath116 ( @xmath121 ) ; blocks for negative clauses are defined symmetrically .",
    "we create an _ intermediate embedding _ of @xmath120 ( which is not yet strong but serves as a template for a later strong embedding ) by putting @xmath120 on top of the base grid and adding new elements to @xmath120 and to certain edge blocks in @xmath114 .",
    "this fixes @xmath120 to run through two mirrored e - shaped sets of grid cells of our choice ( fig .",
    "[ fig : np_complete_2_clusterings ] ) . in the upper half of the base grid",
    ", @xmath120 is assigned to run between rows @xmath122 and @xmath123 .",
    "furthermore , @xmath120 is assigned to three columns leading towards the variable cells from the top .",
    "let @xmath124 be a variable contained in @xmath116 and assume that @xmath116 is the @xmath110-th positive clause from the right connecting to @xmath124 in the embedding of the given mrr .",
    "then @xmath120 runs between columns @xmath125 and @xmath126 . in the lower half of the base grid",
    "we translate and mirror the resulting e - shape as follows .",
    "we let @xmath120 occupy the cells between rows @xmath127 and @xmath128 and the three columns are shifted to the left by the number of occurrences of the respective variable in negative clauses ( fig .",
    "[ fig : np_complete_2_clusterings ] ) .",
    "since each variable cell is @xmath86 columns wide , we can always assign each clause to a unique column of @xmath124 in the top and bottom half of the grid in this way .",
    "we actually fix @xmath120 to the base grid by adding one shared element for each crossed edge of a grid cell to both @xmath120 and the respective edge block of @xmath114 that does not share an element with a vertex block in @xmath113 ( recall that @xmath106 contains such a block in each partition and for each grid edge ) .",
    "no two blocks of the same clause type ( positive or negative ) intersect , but blocks of different type do intersect in certain grid cells . for each grid cell shared between a positive and negative block ( except for the @xmath54 variable cells )",
    "we add one shared element ( black dots in fig .",
    "[ fig : np_complete_2_clusterings ] ) and call the respective grid cell the _ home cell _ for this element . recall that the orders of the incoming blocks from the top and the bottom of each variable cell are inverted .",
    "thus , within each variable cell the blocks of each pair of a positive and negative clause using the corresponding variable intersect , but no shared element is added .",
    "we denote the resulting new pair of partitions as  @xmath129 and observe that its size is polynomial in the size of @xmath82 .",
    "next we argue about the strong embedding options in contrast to the immediate embedding for a clause block @xmath120 in @xmath130 . in the intermediate embedding each block",
    "has three connections through variable cells linking the upper e - shape with the lower e - shape .",
    "any element shared with an edge block of the uniquely embedded base grid must obviously be reached by the block region of @xmath120 . since the block region must be simple , any strong embedding of @xmath120 results from opening the intermediate embedding of @xmath120 in exactly two grid cells so that the resulting block region of @xmath120 is connected and has no holes .",
    "additionally , a shared element must be placed in any intersection of the block region of @xmath120 with block regions of other clause blocks .",
    "first we assume that @xmath82 is a satisfiable formula and a satisfying variable assignment is given .",
    "we need to show that @xmath84 has a strong embedding .",
    "if a variable @xmath124 has the value _ true _ in the given assignment we open all blocks of negative clauses using @xmath124 in the corresponding variable cell ; if @xmath124 is _ false _ we open all blocks of positive clauses using  @xmath124 .",
    "thus no blocks intersect in variable cells any more . if a clause contains more than one _ true _",
    "literal , we open all but one connection in its variable cells of _ true _ literals . since the assignment satisfies @xmath82 , we know that each clause block is opened exactly twice in its variable cells and thus forms a valid simple block region . moreover , we place all shared elements in their home cells so that every block intersection contains an element and the embedding is strong .",
    "we call a strong embedding of @xmath84 with the above properties a _",
    "canonical embedding_.    now assume that @xmath84 has a strong embedding . we know that the base grid has its unique embedding and that each block is embedded as a simple region that results from opening the intermediate embedding ( with its two e - shapes linked through three variable cells ) in exactly two cells .",
    "if the embedding is already canonical , we can immediately construct a satisfying variable assignment for @xmath82 : if a variable cell is crossed by clause blocks in @xmath113 we set the variable to _ true _",
    ", otherwise we set it to _ false_. since every clause block is connected we know that this assignment satisfies all clauses .",
    "if the embedding is not canonical we show that it can be transformed into a canonical embedding as follows . in a non - canonical embedding it is possible that two blocks @xmath120 and @xmath131 intersect in a variable cell @xmath132 and have a shared element in their intersection face in the cell of @xmath132 rather than in the home cell of that element .",
    "this means , on the other hand , that in some shared home cell @xmath133 of @xmath120 and @xmath131 , say in the upper half , at least one of the two blocks is opened ( as there is no more shared element to put into an intersection face ) .",
    "thus the grid cell @xmath133 splits the e - shaped block region of one or both blocks in the upper half into two disconnected components , meaning that each opened block crosses at least two variable cells in order to connect both components via the lower half .",
    "hence we can safely split any block that is opened in @xmath133 in the cell of variable @xmath132 , re - connect it inside @xmath133 , and place the shared element of @xmath120 and @xmath131 into its home cell @xmath133 .",
    "this removes the block intersection in the cell of @xmath132 .",
    "once all block crossings within variable cells are removed , the resulting embedding is a canonical embedding and we can derive the corresponding satisfying variable assignment .",
    "we have characterized three main embeddability classes for pairs of partitions , which in fact form a strict hierarchy , and we have shown -completeness of deciding strong embeddability . from a practical point of view",
    "the class of strong embeddings is of particular interest : it guarantees that every intersection between block regions is meaningful as it contains at least one element , but on the other hand allows blocks to cross , imposing less restrictions than full embeddings .",
    "interesting subclasses of strong embeddings that further structure the space between strong and full embeddability can be defined and we mention two of them .      in a strong embedding",
    "two blocks can intersect many times forming disjoint intersection faces , whereas a full embedding permits only a single connected intersection region for any pair of blocks ( this is also a common requirement for euler diagrams  @xcite ) . in _",
    "single - intersection strong embeddings _ we adapt this _ unique intersection region _ condition of full embeddings , but still permit that two blocks cross in the embedding .",
    "this new class is a true subclass of strong embeddings , see the example in fig .",
    "[ fig:2_clusterings_no_single_intersection_detailed ] .",
    "it is open whether the corresponding decision problem is still -complete since our proof is based on the existence of multiple intersection regions between pairs of blocks .",
    "another interesting subclass are _ strong grid embeddings _ , in which the blocks of @xmath134 and @xmath135 are embedded as horizontal and vertical ribbons , respectively , which intersect in a matrix - like fashion , see fig .",
    "[ fig : plane_grid_strongly_embeddable ] .",
    "obviously a strong grid embedding is also a single intersection strong embedding , but again strong grid embeddings form a true subclass , see fig .",
    "[ fig:2_clusterings_no_path_based_detailed ] .",
    "it is easy to see that a pair of partitions admits a strong grid embedding if and only if its block intersection graph is a _ grid intersection graph _",
    "@xcite , i.e. , an intersection graph of horizontal and vertical segments in the plane .",
    "kratochvl  @xcite showed that deciding whether a bipartite graph is a grid - intersection graph is -complete .",
    "all fully embeddable pairs of partitions have a strong grid embedding : the bipartite map of a fully embeddable pair of partitions is planar by theorem  [ thm : charfull ] and immediately induces a planar bipartite block intersection graph , which , according to hartman et al .",
    "@xcite , is a grid intersection graph .",
    "this implies -completeness of deciding strong grid embeddability .",
    "but as the example of fig .",
    "[ sfg : strongnotfull ] shows , not every instance with a strong grid embedding admits a full embedding .",
    "it is an interesting direction for future work to study the generalization of our embeddability concepts to @xmath136 partitions . while weak embeddability and its properties extend readily to any number of partitions , it is less obvious how to generalize strong and full embeddability .",
    "one possibility is to require the properties in a pairwise sense ; otherwise constraints for new types of faces in the contour graph belonging to more than one but less than @xmath110 block regions might be necessary .    on the practical side , future",
    "work could be the design of algorithms that find visually appealing simultaneous embeddings according to our different embeddability classes .",
    "finally , if the partitions are clusterings on a graph , one would ideally want to simultaneously draw both the partitions and the underlying graphs .",
    "u.  brandes , s.  cornelsen , b.  pampel , and a.  sallaberry . blocks of hypergraphs : applied to hypergraphs and outerplanarity . in _ combinatorial algorithms ( iwoca10 )",
    "_ , vol . 6460 of _ lncs _ , pp . 201211 .",
    "springer , 2011 .",
    "k.  buchin , m.  van kreveld , h.  meijer , b.  speckmann , and k.  verbeek . on planar supports for hypergraphs . in _",
    "graph drawing ( gd09 ) _ , vol .",
    "5849 of _ lncs _ , pp . 345356 .",
    "springer , 2010 .",
    "( see also tech .",
    "uu - cs-2009 - 035 , utrecht university , 2009 )      s.  chaplick , v.  jelnek , j.  kratochvl , and t.  vyskocil .",
    "bend - bounded path intersection graphs : sausages , noodles , and waffles on a grill . in _ graph - theoretic concepts in computer science ( wg12 ) _ , vol .",
    "7551 of _ lncs _ , pp . 274285 .",
    "springer , 2012 ."
  ],
  "abstract_text": [
    "<S> we study the simultaneous embeddability of a pair of partitions of the same underlying set into disjoint blocks . </S>",
    "<S> each element of the set is mapped to a point in the plane and each block of either of the two partitions is mapped to a region that contains exactly those points that belong to the elements in the block and that is bounded by a simple closed curve . </S>",
    "<S> we establish three main classes of simultaneous embeddability ( _ weak _ , _ strong _ , and _ full _ embeddability ) that differ by increasingly strict well - formedness conditions on how different block regions are allowed to intersect . </S>",
    "<S> we show that these simultaneous embeddability classes are closely related to different planarity concepts of hypergraphs . for each embeddability class </S>",
    "<S> we give a full characterization . </S>",
    "<S> we show that ( i ) every pair of partitions has a weak simultaneous embedding , ( ii ) it is -complete to decide the existence of a strong simultaneous embedding , and ( iii ) the existence of a full simultaneous embedding can be tested in linear time . </S>"
  ]
}