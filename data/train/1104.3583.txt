{
  "article_text": [
    "in this paper , we analyze the solution to the skorokhod embedding problem originally given by root  @xcite , and generalized by rost  @xcite .",
    "our motivation for this is recent work connecting the solution to this problem to questions arising in mathematical finance  specifically model - independent bounds for variance options  which has been observed by dupire  @xcite , carr and lee @xcite and hobson  @xcite .",
    "the financial motivation can be described as follows : consider a ( discounted ) asset which has dynamics under the risk - neutral measure @xmath0 where the process @xmath1 is not necessarily known .",
    "we are interested in variance options , which are contracts where the payoff depends on the realized quadratic variation of the log - price process : specifically , we have @xmath2 and therefore @xmath3 an option on variance is then an option with payoff @xmath4 .",
    "important examples include variance swaps , which pay the holder @xmath5 , and variance calls which pay the holder @xmath6",
    ". we shall be particularly interested in the case of a variance call , but our results will extend to a wider class of payoffs .",
    "let @xmath7 for a suitable brownian motion @xmath8 and we can find a ( continuous ) time change @xmath9 such that @xmath10 , and so @xmath11 hence @xmath12 now suppose that we know the prices of call options on @xmath13 with maturity @xmath14 , and at all strikes ( recall that @xmath1 is not assumed known ) .",
    "then we can derive the law of  @xmath13 under the risk - neutral measure from the breeden  litzenberger formula . call this law @xmath15 .",
    "this suggests that the problem of finding a lower bound on the price of a variance call ( for an unknown @xmath1 ) is equivalent to @xmath16 this is essentially the problem for which rost has shown that the solution is given by root s barrier .",
    "[ in fact , the result trivially extends to payoffs of the form @xmath17 where @xmath18 is a convex , increasing function . ]    in this work , our aim is twofold : first , to provide a proof that root s barrier can be found as the solution to a particular variational inequality , which can be thought of as the generalization of an obstacle problem ; second , we show that the lower bound which is implied by rost s result can be enforced through a suitable hedging strategy , which will give an arbitrage whenever the price of a variance call trades below the given lower bound . to accomplish this second part of the paper , we will give a novel proof of the optimality of root s construction , and from this construction we will be able to derive a suitable hedging strategy .",
    "the use of skorokhod embedding techniques to solve model - independent ( or robust ) hedging problems in finance can be traced back to hobson  @xcite .",
    "more recent results in this direction include cox , hobson and obj  @xcite , cox and obj  @xcite and cox and obj  @xcite . for a comprehensive survey of the literature on the skorokhod embedding problem",
    ", we refer the reader to obj  @xcite .",
    "in addition , hobson @xcite surveys the literature on the skorokhod embedding problem with a specific emphasis on the applications in mathematical finance .",
    "variance options have been a topic of much interest in recent years , both from the industrial point of view , where innovations such as the vix index have contributed to a large growth in products which are directly dependent on quantities derived from the quadratic variation , and also on the academic side , with a number of interesting contributions in the literature .",
    "the academic results go back to work of dupire  @xcite and neuberger  @xcite , who noted that a variance swap  that is , a contract which pays @xmath19 , can be replicated model - independently using a contract paying the logarithm of the asset at maturity through the identity ( from it s lemma ) @xmath20 more recently , work on options and swaps on volatility and variance , ( in a model - based setting ) includes howison , rafailidis and rasmussen @xcite , broadie and jain  @xcite and kallsen , muhle - karbe and voss  @xcite .",
    "other work @xcite has considered the differences between the theoretical payoff ( @xmath21 ) and the discrete approximation which is usually specified in the contract [ @xmath22 .",
    "finally , several papers have considered variants on the model - independent problems  @xcite or problems where the modeling assumptions are fairly weak .",
    "this latter framework is of particular interest for options on variance , since the markets for such products are still fairly young , and so making strong modelling assumptions might not be as strongly justified as it could be in a well - established market .",
    "the rest of this paper is structured as follows : in section  [ secrootssolution ] we review some known results and properties concerning root s barrier . in section  [ secobs ] , we establish a connection between root s solution and an obstacle problem , and then in section  [ secvarineq ] we show that by considering an obstacle problem in a more general analytic sense ( as a variational inequality ) , we are able to prove the equivalence between root s problem and the solution to a variational inequality . in section  [ secoptimality ] ,",
    "we give a new proof of the optimality of root s solution and in section  [ secvaropt ] we show how this proof allows us to construct model - independent subhedges to give bounds on the price of variance options .",
    "our interest is in root s solution to the skorokhod embedding problem .",
    "simply stated , for a process @xmath23 , the skorokhod embedding problem is to find a stopping time @xmath24 such that @xmath25 . in this paper , we will consider first the case where @xmath26 , and @xmath27 is a continuous martingale and a time - homogeneous diffusion , and later the case where @xmath28 , is a centred , square integrable measure .",
    "in such circumstances , it is natural to restrict to the set of stopping times for which @xmath29 is a uniformly integrable ( ui ) process",
    ". we will occasionally call stopping times for which this is true _ ui stopping times_. in the case where @xmath15 is centered and has a second moment and the underlying process @xmath30 is a brownian motion ( or more generally , a diffusion and martingale with diffusion coefficient @xmath31 such that @xmath32 for some strictly positive constant @xmath33 ) , this is equivalent to the fact that @xmath34 . for the case of a general starting measure , there is a natural restriction on the measures involved , which is that we require @xmath35 for all @xmath36 .",
    "this assumption implies that @xmath37 ; see chacon  @xcite . by jensen s inequality ,",
    "such a constraint is clearly necessary for the existence of a suitable pair @xmath38 and @xmath15 ; further , by rost  @xcite , it is the only additional constraint on the measures we will need to impose .",
    "we shall write @xmath39 there are a number of important papers concerning the construction of root s barrier . the first work to consider the problem is root  @xcite , and this paper proved the existence of a certain skorokhod embedding when @xmath27 is a brownian motion .",
    "specifically , root showed that if @xmath27 is a brownian motion with @xmath40 , and @xmath15 is the law of a centered random variable with finite variance , then there exists a stopping time @xmath24 , which is the first hitting time of a _ barrier _ , which is defined as follows :    [ defrootbarrier ] a closed subset @xmath41 of @xmath42\\times[0,+\\infty]$ ] is a _ barrier _ if :    @xmath43 for all @xmath44 $ ] ;    @xmath45 for all @xmath46 $ ] ;    if @xmath47 , then @xmath48 whenever @xmath49 .",
    "we provide representative examples of barrier functions in figure  [ figgraphroot ] .    ) ; in we observe some of the nastier features which a barrier may possess , including spikes , corresponding to atoms of the distribution @xmath15 and regions in which the barrier can be unbounded . ]    in a subsequent paper loynes  @xcite proved a number of results relating to barriers . from our perspective , the most important are , first , that the barrier @xmath41 can be written as @xmath50 , where @xmath51 $ ] is a lower semi - continuous function ( with the obvious extensions to the definition to cover @xmath52 ) ; we will make frequent use of this representation .",
    "in addition , loynes  @xcite , theorem  1 , says that root s solution is essentially unique : if there are two barriers which embed the same distribution with a ui stopping time , then their corresponding stopping times are equal with probability one .",
    "the case where two different barriers can occur are then only the cases where , say @xmath53 for @xmath54 , and then @xmath55 is undetermined for all @xmath56 .",
    "the other important reference for our purposes is rost  @xcite .",
    "this work vastly extends the generality of the results of root and loynes , and uses mostly potential - theoretic techniques .",
    "rost works in the generality of a markov process @xmath27 on a compact metric space @xmath57 , which satisfies the strong markov property and is right - continuous",
    ". then rost recalls ( from an original definition of dinges  @xcite in the discrete setting ) the notion of _ minimal residual expectation _ :    a stopping time @xmath58 is of _ minimal residual expectation _ if , for each @xmath59 , it minimizes the quantity @xmath60 over all @xmath61 .",
    "then rost proves that [ under ( [ eqnpotcond ] ) ] there exists a stopping time of minimal residual expectation @xcite , theorem  1 , and that the hitting time of any barrier is of minimal residual expectation @xcite , theorem  2 .",
    "finally , rost also shows that the barrier stopping times are , to a degree , unique  @xcite , corollary to theorem  2 .",
    "the relevant result for our purposes ( where there is a stronger form of uniqueness ) is the corollary to theorem  3 therein , which says that if @xmath27 is a process for which the one - point sets are regular , then any stopping time of minimal residual expectation is root s stopping time . the class of processes for which the one - point sets are regular include the class of time - homogenous diffusions we consider .",
    "note that a stopping time is of minimal residual expectation if and only if , for every convex , increasing function @xmath62 ( where , without loss of generality , we take @xmath63 ) , it minimizes the quantity @xmath64 this fact being a consequence of the above representation .",
    "there are a number of important properties that the root barrier possesses .",
    "first , we note that , as a consequence of the fact that @xmath41 is closed and the third property of definition  [ defrootbarrier ] , the barrier is regular ( i.e. , if we start at a point in the barrier , we will almost surely return to the barrier instantly ) for the class of processes we will consider ( time - homogeneous diffusions ) this will have important analytical benefits .",
    "second , for a point @xmath65 , we know that if the stopped process at time  @xmath66 is at @xmath67 , then we have not yet reached the stopping time for the embedding .",
    "this will help in our characterization of the law of the stopped process ( lemma  [ lemroot ] ) .    in the rest of this paper",
    ", we will then say that a barrier is either a lower semi - continuous function @xmath68 , with @xmath69 , or the complement of the corresponding connected open set @xmath70 . as noted above , by loynes  @xcite this is equivalent to the barrier as defined in definition  [ defrootbarrier ] .",
    "we will define the hitting time of the barrier as : @xmath71 .",
    "note that the barrier @xmath41 is closed and regular , so that @xmath72 and @xmath73 whenever @xmath74 , where @xmath75 is the law of our diffusion started at @xmath67 at time @xmath66 .    finally , we give some examples where the barrier function can be explicitly calculated .",
    "we note that explicit examples appear to be the exception , and in general are hard to compute .",
    "first , if @xmath15 is a normal distribution , we easily see that @xmath55 is a constant .",
    "second , if @xmath15 consists of two atoms ( weighted appropriately ) at @xmath76 say , the corresponding barrier is @xmath77 in this example , observe that the function @xmath55 is not unique : we can choose any behavior outside @xmath78 $ ] , and achieve the same stopping time .",
    "second , we note the that there are even more general solutions to the skorokhod embedding problem ( without the uniform integrability condition ) since there are also barriers of the form @xmath79 which will embed the same law ( provided @xmath80 are chosen suitably ) , but which do not satisfy the uniform integrability condition . in general",
    ", a barrier can exhibit some fairly nasty features : consider , for example , the canonical measure on a middle third cantor set @xmath81 ( scaled so that it is on @xmath82 $ ] ) .",
    "root s result tells us that there exists a barrier which embeds this distribution , and clearly the resulting barrier function must be finite only on the cantor set ; however , the target distribution has no atoms , so that the `` spikes '' in the barrier function can not be isolated ( i.e. , we must have @xmath83 for all @xmath84 ) .",
    "we now consider alternative methods for describing root s barrier . we will , in general , be interested in this question when our underlying process @xmath27 is a solution to @xmath85 for a brownian motion @xmath86 , and we will introduce our concepts in this general context .",
    "initially , we assume that @xmath87 satisfies , for some positive constant  @xmath88 , @xmath89 recall that for the financial application we are interested in , we want the specific case @xmath90 to be included .",
    "clearly , this case is currently excluded ; however , we will show in section  [ secgbm ] that the results can be extended to include this case .    from standard results on sdes ,",
    "( [ eqsde ] ) and ( [ eqsde2 ] ) imply that the unique strong solution @xmath91 of ( [ eqx ] ) with @xmath92 is a strong markov process with generator @xmath93 for any initial value @xmath94 .",
    "moreover , ( [ eqhypo ] ) implies that the operator @xmath95 is hypoelliptic ; see stroock  @xcite , theorem  3.4.1 .",
    "we will write root s skorokhod embedding problem as :    find a lower - semicontinuous function @xmath55 such that the domain @xmath96 has @xmath97 , and @xmath98 is a ui process , where @xmath38 is the initial law of @xmath27 , and @xmath31 the diffusion coefficient .",
    "our aim is to show that the problem of finding @xmath99 is essentially equivalent to solving an obstacle problem . assuming that the relevant derivatives exist",
    ", we shall show that the problem can be stated in the following way :    find a function @xmath100 such that    [ eqobs ] @xmath101    where ( [ eqobsdiff ] ) is interpreted in a distributional sense  that is , we require @xmath102 whenever @xmath103 is a nonnegative function .",
    "condition ( [ eqobscomp ] ) can be interpreted more generally as requiring @xmath104 in a distributional sense whenever @xmath105 . however",
    ", this is an open set , and from the hypoellipticity of the operator @xmath106 , if this holds in a weak sense , it will hold in a strong sense .",
    "hence @xmath107 would be continuous even if we were only to require ( [ eqobscomp ] ) to hold in a distributional sense.=-1    in general , we do not expect @xmath108 to be sufficiently nice that we can easily interpret all these statements , and one of the goals of this paper is to give a generalization of obs@xmath109 that will make sense more widely .",
    "cases in which @xmath108 may not be expected to be @xmath110 include the case where @xmath15 contains atoms ( and therefore @xmath111 is not continuously differentiable ) .",
    "in addition , we specify this problem in @xmath110 since , in general , we would certainly not expect the second derivative to be continuous on the boundary between the two types of behavior in ( [ eqobscomp ] ) .",
    "[ thmconstruction ] suppose @xmath112 is a solution to sep@xmath113 and is such that @xmath114 then @xmath108 solves obs@xmath113 .",
    "this gives an initial connection between obs@xmath115 and sep@xmath109 .",
    "we roughly expect solutions to root s problem to be the unique solutions to the obstacle problem ( of course , we do not currently know that such solutions exist or , when they do , are unique ) .",
    "this suggests that we can attempt to solve the obstacle problem to find the solution @xmath112 to root s problem . in particular ,",
    "given a solution to obs@xmath109 , we can now identify @xmath112 as @xmath116 .",
    "[ lemroot ] for any @xmath117 , @xmath118 .    by the lower semi - continuity of @xmath99 , since @xmath117",
    ", there exists such that @xmath119 and hence , for any @xmath120 , @xmath121 . on the other hand , if @xmath122 , we have @xmath123 and hence , @xmath124 .",
    "therefore , @xmath125    [ lemsmoothness ] the measure corresponding to @xmath126 has density @xmath127 with respect to lebesgue on @xmath112 , and the density is smooth and satisfies @xmath128.\\ ] ]    this result appears to be standard , but we are unable to find concise references .",
    "we give a short proof based on @xcite , section  v.38.5 .",
    "proof of lemma [ lemsmoothness ] first note that , as a measure , @xmath126 is dominated by the usual transition measure , so the density @xmath127 exists .",
    "let @xmath129 be a point in @xmath112 , and we can therefore find an @xmath130 such that @xmath131 satisfies @xmath132 .",
    "then let @xmath133 be a smooth function , supported on @xmath134 , and by it s lemma , @xmath135 since @xmath133 is compactly supported , taking @xmath136 , the two terms on the left disappear , and the first integral term is a martingale .",
    "hence , taking expectations , and interchanging the order of differentiation , we get @xmath137 interpreting @xmath138 as a distribution , we have @xmath139 - \\frac{\\partial}{\\partial t } p^d(x , t ) = 0,\\ ] ] for @xmath140 , and since the heat operator is hypoelliptic , we conclude that @xmath127 is smooth in @xmath134 ( e.g. , stroock  @xcite , theorem  3.4.1 ) .",
    "we are now able to prove that any solution to root s embedding problem is a solution to the obstacle problem .",
    "proof of theorem  [ thmconstruction ] we first observe that @xmath141 , and @xmath28 , so that @xmath142 and ( [ eqobsinit ] ) holds .",
    "second , since @xmath98 is a ui process , by ( conditional ) jensen s inequality , @xmath143\\bigr ] = \\mathrm{u}_{\\mu}(x),\\ ] ] and ( [ eqobsobs ] ) holds .",
    "we now consider ( [ eqobsdiff ] ) .",
    "suppose @xmath144 , and note that @xmath145 and therefore ( in @xmath112 ) by lemma  [ lemsmoothness ] the function @xmath108 has a smooth second derivative in @xmath67 .",
    "further , we get @xmath146 } \\,{\\mathrm{d}}s\\biggr ] \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & = & -{\\mathbb{e}}l_{t \\wedge\\tau_d}^x \\\\ & = & -{\\mathbb{e}}|x - x_{t \\wedge\\tau_d}| + |x|,\\nonumber\\end{aligned}\\ ] ] where @xmath147 is the local time of the diffusion at @xmath67 .",
    "it follows that @xmath108 satisfies ( [ eqobsdiff ] ) on @xmath112 , and in fact attains equality there . on the other hand ,",
    "if @xmath148 , it follows from the definition of the barrier that if @xmath149 , the diffusion can not cross the line @xmath150 in the time interval @xmath151 , and hence @xmath152 therefore , for @xmath153 , @xmath154 where the last equality holds because @xmath155 is a ui stopping time .",
    "so ( [ eqobsobs ] ) holds with equality when @xmath148 .",
    "in particular , we can deduce that either ( if @xmath144 ) we have equality in ( [ eqobsdiff ] ) , or we have equality in ( [ eqobsobs ] ) , in which case ( [ eqobscomp ] ) must hold .",
    "it remains to show that ( [ eqobsdiff ] ) holds when @xmath156 .",
    "however , to see this , consider @xmath148 , and note first that @xmath157 whenever @xmath158 , since @xmath159 .",
    "hence @xmath160 .",
    "it is straightforward to check that @xmath161 is concave in @xmath67 , and therefore that @xmath162 , and ( [ eqobsdiff ] ) also holds .",
    "this result connects root s problem and the obstacle problem under a smoothness assumption on the function @xmath108 .",
    "however , ideally we want a one - to - one correspondence . we know from the results of rost  @xcite that there always exists a solution to sep@xmath109 , and from loynes  @xcite that the solution is unique .",
    "our aim is to show that a similar combination of existence and uniqueness hold for the corresponding analytic formulation .",
    "as already noted , we can not make a strong smoothness assumption on the function @xmath161 as required by obs@xmath109 , and so we need a weaker formulation of this problem .",
    "generalizations of the obstacle problem are well understood , and commonly called variational inequalities . in the next section , we will reformulate the obstacle problem as a variational inequality , and we are able to state a problem for which existence and uniqueness are known due to existing results .",
    "we now study the relation between root s skorokhod embedding problem and a variational inequality .",
    "our notation and definitions , and some of the key results which we will use , come from bensoussan and lions  @xcite .",
    "we begin with some necessary notation and results concerning evolutionary variational inequalities .",
    "given a constant @xmath163 and a finite time @xmath164 , we define the banach spaces @xmath165 and @xmath166 with the norms @xmath167 where the derivatives @xmath168 are to be interpreted as weak derivatives  that is , @xmath168 is defined by the requirement that @xmath169 for all @xmath170 , and @xmath171 is the set of compactly supported , smooth functions on @xmath172 . in particular , the spaces @xmath173 and @xmath166 are hilbert spaces with respect to the obvious inner products . in addition , elements of the set @xmath174 can always be taken to be continuous , and @xmath171 is dense in @xmath173 ; see , for example , friedman  @xcite , theorem  5.5.20 .    for functions @xmath175",
    ", we define an operator @xmath176\\,{\\mathrm{d}}x,\\ ] ] for @xmath177 .",
    "moreover if @xmath178 exits , we define , for @xmath179 , @xmath180 and finally , for @xmath181 , @xmath182 so that , for suitably differentiable test functions @xmath183 and @xmath179 , @xmath184 then we have the following restatement of bensoussan and lions  @xcite , theorem  2.2 , and section  2.15 , chapter  3 :    [ thmb&l ] for any given @xmath163 and @xmath164 , suppose :    @xmath185 are bounded on @xmath186 with @xmath187 a.e . in @xmath186 for some @xmath188 ;    @xmath189 ;    the set @xmath190 \\biggr\\ } \\ ] ] is nonempty , where @xmath191 denotes the dual space of @xmath174 .",
    "then there exists a unique function @xmath192 such that : @xmath193 \\\\[-8pt ] \\nonumber & \\hspace*{86pt}\\forall w \\in h^{1,\\lambda}\\mbox { such that } w \\ge \\psi(t ) \\mbox { a.e .",
    "} t \\in(0,t ) ; & \\\\ \\label{eqsv3 } & v(\\cdot , t ) \\ge\\psi(t)\\qquad \\mbox{a.e . }",
    "t \\in(0,t);&\\\\ \\label{eqsv4 } & v(\\cdot,0 ) = \\bar{v}.&\\end{aligned}\\ ] ] moreover , if @xmath194 , then @xmath192 is a solution to the obstacle problem : find @xmath194 such that @xmath192 satisfies ( [ eqsv3 ] ) , ( [ eqsv4 ] ) and @xmath195 almost everywhere in @xmath186 .",
    "for the most part , the theorem is a restatement of bensoussan and lions  @xcite , theorem  2.2 , and section  2.15 , chapter  3 , where we have mapped @xmath196 , and @xmath197 .",
    "we therefore only need to explain the last part of the result .",
    "if we suppose @xmath198 and @xmath199 , we have @xmath200\\,{\\mathrm{d}}x\\\\ & = & \\biggl[e^{-2\\lambda|x| } a(x , t ) \\frac{\\partial v}{\\partial x}\\phi \\biggr]_{-\\infty}^{\\infty } + \\int_{{\\mathbb{r}}}e^{-2\\lambda|x| } \\phi\\cdot a(t)v \\,{\\mathrm{d}}x,\\end{aligned}\\ ] ] where the first term on the right - hand side vanishes since @xmath201 and @xmath199 .",
    "therefore , by ( [ eqsv2 ] ) , for any @xmath202 such that @xmath203 a.e . in  @xmath172",
    ", @xmath204 taking , for example , @xmath205 , for a positive test function @xmath206 , we conclude that  ( [ eqvi1 ] ) holds .",
    "moreover , let @xmath207 in the inequality above , we have @xmath208 then ( [ eqvi3 ] ) follows from ( [ eqsv3 ] ) and ( [ eqvi1 ] ) .      to connect our embedding problem sep@xmath113 with the variational inequality , we need some assumptions on @xmath31 , @xmath15 and the starting distribution @xmath38 .",
    "first , on @xmath209 , we still assume ( [ eqsde ] ) and ( [ eqhypo ] ) hold .",
    "in addition , we assume that @xmath210 on @xmath15 and @xmath38 , we still assume that @xmath211 to ensure the existence of a solution to sep@xmath109 .    under these assumptions , we can specify the coefficients in the evolutionary variational inequality , ( [ eqsv4 ] ) and ( [ eqvi1])([eqvi3 ] ) , to be @xmath212 \\\\[-8pt ] \\nonumber \\psi(x , t ) & = & \\mathrm{u}_{\\mu}(x);\\qquad \\bar{v } = \\mathrm{u}_{\\nu}(x),\\end{aligned}\\ ] ] and then the corresponding operators are given by @xmath213 and @xmath214\\,{\\mathrm{d}}x.\\ ] ]    we write the evolutionary variational inequality as :    find a function @xmath215 { \\rightarrow}{\\mathbb{r}}$ ] satisfying ( [ eqsv1])([eqsv4 ] ) , where all the coefficients are given in ( [ eqcoefficient ] )",
    ".    we also have a stronger formulation , that is :    for given @xmath164 , we seek a function @xmath192 , in a suitable space , such that ( [ eqsv3])([eqvi3 ] ) hold , where all the coefficients are given in ( [ eqcoefficient ] ) .",
    "our main result is then to show that finding the solution to sep@xmath109 is equivalent to finding a ( and hence the unique ) solution to vi@xmath109 :    [ thmsv&sep ] suppose ( [ eqsde ] ) , ( [ eqhypo ] ) and ( [ eqsde3 ] ) hold , and let @xmath164 .",
    "also , let  @xmath112 and @xmath192 be the solutions to sep@xmath109 and vi@xmath109 , respectively .",
    "define @xmath216 and @xmath217 by @xmath218 ; v(x , t ) > \\psi(x , t)\\}.\\ ] ] then we have @xmath219 $ ] , and for all @xmath220 $ ] , @xmath221 moreover , if @xmath222 , then @xmath108 is also the solution to svi@xmath113 .",
    "let @xmath163 be fixed , and suppose @xmath112 is a solution to sep@xmath109 .",
    "we need to show @xmath108 is a solution to vi@xmath109 .",
    "first note that @xmath223 is continuous on @xmath172 , and converges to @xmath224 as @xmath225 , and hence is bounded .",
    "so @xmath226 , and then @xmath227 .",
    "similarly , @xmath228 . since @xmath229 for all",
    "@xmath230 $ ] , we have @xmath231 . by ( [ eqpotgrad ] ) , we also have @xmath232 since @xmath108 is the potential of some probability distribution .",
    "therefore we have @xmath233 . by lemma  [ lemsmoothness ] and the fact that @xmath108 is constant ( in time ) outside @xmath112 , @xmath234 is the transition density of the diffusion process  @xmath30 starting from @xmath38",
    ". then by standard gaussian estimates ( e.g. , stroock  @xcite , theorem  3.3.11 ) , we know there exists some constant @xmath235 , depending only on  @xmath88 , such that @xmath236 where we have applied hlder s inequality in the first line to get @xmath237 so @xmath238 , and we have shown ( [ eqsv1 ] ) holds .    by the same arguments used in the proof of theorem  [ thmconstruction ] , ( [ eqsv3 ] ) and ( [ eqsv4 ] ) hold .",
    "now we consider ( [ eqsv2 ] ) .",
    "we begin by observing that , for any @xmath239 , if we write @xmath240 for the law of @xmath241 , we have @xmath242 \\\\[-8pt ] \\nonumber & = & 2 \\int_{\\mathbb{r}}\\phi(y ) \\mu_t(\\mathrm{d}y ) \\\\ & = & 2 { \\mathbb{e}}[\\phi(x_{t \\wedge\\tau_d})].\\nonumber\\end{aligned}\\ ] ] in addition , for any @xmath202 , we can find a sequence @xmath243 such that @xmath244 moreover , @xmath245 is bounded , and if @xmath246 is also bounded , then we can , in addition , find a sequence @xmath243 such that @xmath247 for some constant @xmath248 independent of @xmath249 .",
    "for any @xmath249 , we therefore have @xmath250 \\\\[-8pt ] \\nonumber & & { } + \\int_{{\\mathbb{r } } } e^{-2\\lambda|x| } \\phi_n \\sigma^2 \\mu_{t}(\\mathrm{d}x).\\end{aligned}\\ ] ] on the other hand , since @xmath251 vanishes outside @xmath112 , and , using the same arguments as ( [ eqdpde ] ) ( which still hold on account of lemma  [ lemsmoothness ] ) , is equal to @xmath252 , we have , for almost every @xmath253 $ ] @xmath254 \\\\[-8pt ] \\nonumber & & \\qquad= \\int_{{\\mathbb{r}}\\setminus d_{t } } e^{-2\\lambda|x| } \\phi_n \\sigma^2 \\mu _ { t}(\\mathrm{d}x),\\end{aligned}\\ ] ] where @xmath255 . by ( [ eqip ] ) and ( [ eqvi ] ) , @xmath256 \\,{\\mathrm{d}}x\\\\ & & \\qquad=   \\int_{{\\mathbb{r } } } e^{-2\\lambda|x| } \\phi_n \\frac{\\partial u}{\\partial t } \\,{\\mathrm{d}}x + \\int_{{\\mathbb{r } } } e^{-2\\lambda|x| } \\phi_n \\sigma^2 \\mu_{t}(\\mathrm { d}x ) \\\\ & & \\qquad=   \\int_{{\\mathbb{r}}\\setminus d_{t } } e^{-2\\lambda|x| } \\phi_n \\sigma^2 \\mu_{t}(\\mathrm{d}x),\\end{aligned}\\ ] ] for almost every @xmath253 $ ] .",
    "now suppose initially we have @xmath246 bounded , and choose a sequence @xmath257 as above .",
    "then we can let @xmath258 and apply fatou s lemma and the fact that @xmath259 on @xmath260 and @xmath203 to get @xmath261 for almost every @xmath230 $ ] .",
    "so ( [ eqsv2 ] ) holds when @xmath246 is bounded .",
    "the general case follows from noting that @xmath262 converges to @xmath263 in @xmath174 .",
    "we can conclude that @xmath108 is a solution to vi@xmath109 .",
    "in addition , the final statement of the theorem now follows from theorem  [ thmb&l ] .",
    "conversely , suppose that we have already found the solution to vi@xmath109 , denoted by @xmath264 . by theorem  [ thmb&l ] and the preceding argument , we have @xmath265 when @xmath266 $ ] . finally , we need only note ( from ( [ eqdpde ] ) , and the line above ) that whenever @xmath144 , we have @xmath267 , and hence @xmath219 $ ] .    [ rmkdifflambda ] the constant @xmath268 which appears in the variational inequality",
    "can now be seen to be unimportant : if we consider two positive numbers @xmath269 , then by theorem  [ thmb&l ] , there exist @xmath192 and @xmath270 satisfying ( [ eqsv1])([eqsv4 ] ) with the parameters @xmath268 and @xmath271 , respectively . according to theorem  [ thmsv&sep ] , @xmath272 so @xmath273 . therefore , the description of root s barrier by the strong variational inequality is not affected by the choice of the parameter @xmath163 .",
    "we do , however , need @xmath274 , since this assumption is used , in , for example , ( [ eqip ] ) , to ensure we can integrate by parts .",
    "[ rmkoptstop ] as noted in bensoussan and lions  @xcite , and which is well known , one can connect the solution to the variational inequality vi@xmath109 to the solution of a particular optimal stopping problem .",
    "in our context , the function  @xmath192 which arises in the solution to vi@xmath109 is also the function which arises from solving the problem @xmath275.\\ ] ] this seems a rather interesting observation , and at one level extends a number of connections known to exist between solutions to the skorokhod embedding problem , and solutions to optimal stopping problems ( e.g. , peskir  @xcite , obj @xcite and cox , hobson and obj  @xcite ) .",
    "what is rather interesting , and appears to differ from these other situations , is that the above examples are all cases where the same stopping time is both a skorokhod embedding , and a solution to the relevant optimal stopping problem . in the context here",
    ", we see that the optimal stopping problem is _ not _ solved by root s stopping time .",
    "rather , the problem given in ( [ eqoptstop ] ) runs `` backwards '' in time : if we keep @xmath66 fixed , then the solution to ( [ eqoptstop ] ) is @xmath276 in addition , our connection between these two problems is only through the analytic statement of the problem : it would be interesting to have a probabilistic explanation for the correspondence .",
    "[ rknoncentred ] the above ideas also allow us to construct alternative embeddings which fail to be uniformly integrable .",
    "consider using the variational inequality to construct the domain @xmath112 in the manner described above , but with the function  @xmath277 chosen to be @xmath278 , for some @xmath188 .",
    "by ( [ eqoptstop ] ) , one can check that the solution to the variational inequality is a decreasing function with respect to @xmath66 , and hence , @xmath279 is a barrier , which is nonempty , so that @xmath280 a.s . , and the functions @xmath161 and @xmath264 defined in theorem  [ thmsv&sep ] agree ( e.g. , by taking bounded approximations to @xmath112 ) . in particular , @xmath281 . since @xmath282 is no longer uniformly integrable , we can not simply infer that this holds in the limit , but we can consider for example @xmath283\\ ] ] which is a bounded function . taking the limit as @xmath284 , we can deduce that @xmath285 = \\mathrm{u}_{\\mu}(x ) - \\mathrm{u}_{\\mu}(z).\\ ] ] from this expression , we can divide through by @xmath286 and take the limit as @xmath287 to get @xmath288 .",
    "the law of @xmath289 now follows .",
    "note also that there is no reason that the distribution above needed to have the same mean as @xmath38 , and this can lead to constructions where the means differ . in general , these constructions will not give rise to a uniformly integrable embedding , but if we take two general ( integrable ) distributions , there is a natural choice , which is to find the smallest @xmath290 such that @xmath291 .",
    "in such a case , we conjecture that the resulting construction would be _ minimal _ in the sense that there is no other construction of a stopping time which embeds the same distribution , and is almost surely smaller .",
    "see monroe  @xcite and cox  @xcite for further details regarding minimality .",
    "an important motivating example for our study is the financial application of root s solution described in the . in both @xcite and  @xcite",
    ", the case @xmath292 plays a key role in both the pricing and the construction of a hedging portfolio .",
    "however , in the previous section , we only discussed the relation between root s construction and variational inequalities under the assumptions ( [ eqsde ] ) , ( [ eqhypo ] ) and ( [ eqsde3 ] ) , where the last assumption is not satisfied by  @xmath31 in this special case .    in this section , we study this special case : @xmath90 , so that @xmath27 is a geometric brownian motion . in addition , we will assume that the process is strictly positive , so that @xmath38 and @xmath15 are supported on @xmath293 .",
    "we therefore consider the skorokhod embedding problem sep@xmath109 with starting distribution @xmath38 , where @xmath38 and @xmath15 are integrable probability distributions satisfying @xmath294 \\\\[-8pt ] \\nonumber \\mathrm{u}_{\\mu}(x)&\\leq&\\mathrm{u}_{\\nu}(x ) \\quad\\mbox{and } \\quad\\int x^2\\,{\\mathrm{d}}\\nu < \\infty .",
    "\\ ] ] we recall from ( [ eqnpotcond ] ) that this implies , in particular , that the means of @xmath15 and @xmath38 agree .",
    "the solution to the stochastic differential equation @xmath295 is the geometric brownian motion @xmath296 , and , for @xmath297 , the transition density of the process is @xmath298    by analogy with theorem  [ thmconstruction ] , if @xmath112 is the solution to sep@xmath109 , then we would expect @xmath299 where @xmath108 is defined as before by @xmath300 .",
    "however , if we follow the arguments in section  [ secsv&sep ] , we find that we need to set @xmath301 in vi@xmath109 , which would not satisfy the first condition of theorem  [ thmb&l ] .",
    "to avoid this we will perform a simple transformation of the problem .",
    "we set @xmath302.\\ ] ] define the operator @xmath303 ; then we have , when @xmath304 , @xmath305    we state our main result of this section as follows :    [ thmmaingbm ] suppose @xmath292 on @xmath293 and @xmath15 and @xmath38 satisfy ( [ eqmu3 ] ) . moreover , assume @xmath112 solves sep@xmath109 , and @xmath306 . then @xmath307 is the unique solution to ( [ eqsv1])([eqsv4 ] ) where we set @xmath308 \\\\[-8pt ] \\nonumber   \\bar{v } & = & \\mathrm{u}_{\\nu}(e^{x});\\qquad \\lambda > { \\tfrac{1}{2}}.\\end{aligned}\\ ] ]    much of the proof will follow the proof of theorem  [ thmsv&sep ] . as before , ( [ eqsv3 ] ) and ( [ eqsv4 ] ) are clear .",
    "in addition , we note that @xmath309 is continuous and converges to @xmath224 as @xmath310 and converges to @xmath311 as @xmath312 , so @xmath313 .",
    "hence @xmath314 since we have @xmath315 .",
    "thus , @xmath316 .",
    "moreover , we can easily see @xmath317 is bounded by @xmath318 .",
    "therefore , @xmath319 when @xmath320 . on the other hand ,",
    "since @xmath321 is bounded by @xmath322 , we have , by hlder s inequality , @xmath323 and hence , @xmath324 therefore ( [ eqsv1 ] ) is verified .    using ( [ equmeas ] ) , for @xmath325 we get @xmath326 \\frac{\\partial u}{\\partial x}(y , t ) \\,{\\mathrm{d}}y \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & = & 2 { \\mathbb{e}}[\\phi(\\ln(x_{t \\wedge\\tau_d } ) ) x_{t \\wedge \\tau_d}],\\end{aligned}\\ ] ] and so we define the measure @xmath327 by @xmath328.\\ ] ] now take any @xmath202 , and take @xmath329 satisfying ( [ eqphiseq ] ) . by ( [ eqspecialvi ] ) and  ( [ eqspecialdistr ] ) , similar arguments to those used in the proof of theorem  [ thmsv&sep ] give @xmath330 and @xmath331 for almost all @xmath230 $ ] , where @xmath332 .",
    "thus , for almost every @xmath230 $ ] , @xmath333 finally , following the same arguments as in the proof of theorem  [ thmsv&sep ] , we conclude  ( [ eqsv2 ] ) holds .",
    "therefore @xmath192 is a solution to ( [ eqsv1])([eqsv4 ] ) with coefficients determined by ( [ eqscoefficient ] ) .",
    "the uniqueness is clear since it is easy to check the coefficients defined in ( [ eqscoefficient ] ) satisfy the conditions in theorem  [ thmb&l ] .",
    "for a given distribution @xmath15 , rost  @xcite proves that root s construction is optimal in the sense of `` minimal residual expectation . ''",
    "it is easy to check that this is equivalent to the slightly more general problem @xmath334 \\\\ & & \\mbox{subject to:}\\qquad \\mathcal{l}(x_{\\tau } ) = \\mu;\\\\ & & \\phantom{\\mbox{subject to:}\\qquad } \\tau\\mbox { is a ui stopping time.}\\end{aligned}\\ ] ] here we assume @xmath15 is a given integrable and centered distribution , @xmath30 is the diffusion process defined by ( [ eqx ] ) , where the diffusion coefficient @xmath31 satisfies ( [ eqsde])([eqhypo ] ) , with initial distribution @xmath335 , and @xmath336 is a given convex , increasing function with right derivative @xmath133 and @xmath337 .",
    "our aim in this section is twofold .",
    "first , since rost s original proof relies heavily on notions from potential theory , to give a proof of this result using probabilistic techniques .",
    "second , we shall be able to give a `` pathwise inequality '' which encodes the optimality in the sense that we can find a submartingale @xmath338 , and a function  @xmath339 such that @xmath340 and such that , for @xmath155 , equality holds in  ( [ eqpathwiseineq ] ) and @xmath341 is a ui martingale .",
    "it then follows that @xmath155 does indeed minimize @xmath342 among all solutions to the skorokhod embedding problem .",
    "the importance of ( [ eqpathwiseineq ] ) is that we can characterize the submartingale @xmath338 , which will correspond in the financial setting to a dynamic trading strategy for constructing a sub - replicating hedging strategy for call - type payoffs on variance options .",
    "we first define the key functions @xmath343 and @xmath339 , where the submartingale in  ( [ eqpathwiseineq ] ) is @xmath344 , and give key results concerning these functions .",
    "we suppose that we have solved root s problem for the given distributions , and hence have our barrier @xmath345 .",
    "define the function @xmath346 where @xmath155 is the corresponding root stopping time . in the following",
    ", we shall assume @xmath347 we suppose also ( at least initially ) that ( [ eqsde])([eqhypo ] ) and ( [ eqsde3 ] ) still hold .",
    "note that @xmath348 now has the following important properties .",
    "first , since @xmath133 is right - continuous ( it is the right derivative of @xmath336 ) ,",
    "@xmath349 whenever @xmath148 and @xmath350 .",
    "in addition , since @xmath133 is increasing , for all @xmath67 and @xmath66 we have @xmath351 .",
    "now define a function @xmath352 by @xmath353 so in particular , we have @xmath354 , and @xmath352 is a convex function . define also @xmath355 and @xmath356 where @xmath55 is the barrier function .",
    "two key results concerning these functions are then :    [ propgfineq ] we have , for all @xmath357 , @xmath358    and also :    [ lemgmartsubmart ] suppose that @xmath133 is bounded , and for any @xmath359 , @xmath360 < \\infty , \\qquad { \\mathbb{e}}z(x_0 ) < \\infty.\\ ] ] then the process @xmath361 and @xmath362    using these results , we are able to prove the following theorem , which gives us rost s result regarding the optimality of root s construction .    [ thmoptimality ]",
    "suppose @xmath112 solves sep@xmath363 , and equations ( [ eqmassumption ] ) and ( [ eqqvbddcond ] ) hold .",
    "then @xmath364 whenever @xmath24 is a stopping time such that @xmath365 .",
    "we begin by considering the case where @xmath366 and @xmath133 is bounded . since @xmath352 is convex , by the meyer ",
    "it formula ( e.g. , protter  @xcite , theorem  iv.71 ) , @xmath367 by ( [ eqqvbddcond ] ) and the fact that @xmath133 is bounded ( and hence also @xmath368 is bounded ) , we get @xmath369 applying fatou s lemma , we deduce that for any stopping time @xmath24 with finite expectation , @xmath370 is integrable .",
    "moreover for such a stopping time , by convexity , @xmath371 $ ] , and so , by lemma  [ lemgmartsubmart ] , @xmath372 is a submartingale which is bounded below by a ui martingale , and bounded above by @xmath373 .",
    "it follows that @xmath374 as @xmath284 .",
    "the same arguments hold when we replace @xmath24 by @xmath155 .    since @xmath375 and if @xmath376 , then @xmath377-a.s .",
    ", so that @xmath378 for @xmath379 , we have @xmath380 \\\\[-8pt ] \\nonumber & & \\qquad = \\int_0^{\\tau_d } m(x_{\\tau_d},s ) \\,{\\mathrm{d}}s + \\int_0^{\\tau_d } \\bigl(f(s ) - m(x_{\\tau_d},s)\\bigr ) { \\,\\mathrm{d}s}\\\\ & & \\qquad = \\int_0^{\\tau_d } f(s ) \\,{\\mathrm{d}}s = f(\\tau_d).\\nonumber\\end{aligned}\\ ] ] on the other hand , since @xmath381 , and observing that @xmath382 and @xmath383 are integrable , so too is @xmath384 , and @xmath385    in addition , by lemma  [ lemgmartsubmart ] and the limiting behavior deduced above , we have @xmath386 putting these together , we get @xmath387 \\\\ & \\le&{\\mathbb{e}}[g(x_{\\tau},\\tau ) + h(x_\\tau ) ] \\\\ & \\le&{\\mathbb{e}}f(\\tau).\\end{aligned}\\ ] ]    we now consider the case where at least one of @xmath24 or @xmath155 has infinite expectation . note that if @xmath388 , then there is some @xmath389 with @xmath390 such that @xmath391 , and hence we can not have @xmath392 or @xmath393 without the corresponding term in ( [ eqtauineq ] ) also being infinite . the only case which need concern us is the case where @xmath394 , but @xmath395 .",
    "note , however , that @xmath155 remains ui , so @xmath396 = x_t$ ] .",
    "in addition , from the arguments applied above , we know @xmath370 is integrable , and since @xmath397 , so too is @xmath398 .",
    "then @xmath399 and @xmath384 are both bounded above by an integrable random variable , so their expectations are well defined ( although possibly not finite ) , and equal . then ,",
    "as above , @xmath400 \\le - z(x_{t \\wedge\\tau_d } ) \\le g(x_{t \\wedge\\tau_d } , t \\wedge \\tau_d)$ ] .",
    "we can deduce that @xmath401 . the remaining steps follow as previously , and it must follow that in fact @xmath402 , which contradicts the assumption that @xmath394 and @xmath395 .    to observe that the result still holds when @xmath133 is unbounded , observe that we can apply the above argument to @xmath403 , and @xmath404 to get @xmath405 , and",
    "the conclusion follows on letting @xmath406 .",
    "we now turn to the proofs of our key results :    proof of proposition  [ propgfineq ] if @xmath407 , then the left - hand side of ( [ eqgfineq ] ) is @xmath408 and we know @xmath409 , so that the inequality holds .",
    "now consider the case where @xmath410 .",
    "then the left - hand side of ( [ eqgfineq ] ) becomes @xmath411    proof of lemma  [ lemgmartsubmart ] we begin by noting that @xmath352 is convex , and therefore the meyer ",
    "it formula ( e.g. , protter  @xcite , theorem  iv.71 ) gives @xmath412 it follows from ( [ eqqvbddcond ] ) that the first integral is a martingale .",
    "so we get @xmath413 = \\int_s^t { \\mathbb{e}}[m(x_r,0)|{\\mathcal{f}}_s ] \\,{\\mathrm{d}}r,\\qquad s \\le t.\\ ] ]    in addition , since @xmath351 and @xmath414 is increasing , for @xmath415 by the strong markov property , writing @xmath416 for an independent stochastic process with the same law as @xmath30 and @xmath417 for the corresponding hitting time of the barrier , we have @xmath418 & = & { \\mathbf{1}}_{\\tau_{d}>r+u } { \\mathbb{e}}^{(x , r ) } [ f(\\tau_{d})|\\mathcal{f}_{r+u } ] \\\\ & & { } + { \\mathbf{1}}_{\\tau_{d}\\leq r+u } { \\mathbb{e}}^{(x , r)}[f(\\tau_{d})|\\mathcal{f}_{r+u } ] \\\\ & \\leq&{\\mathbf{1}}_{\\tau_{d}>r+u}{\\mathbb{e}}^{(x^{x}_{u},r+u)}[f({\\widetilde}{\\tau}_d ) ] + { \\mathbf{1}}_{\\tau_d\\leq r+u } f(r+u)\\\\ & \\leq & m(x^{x}_{u},r+u).\\end{aligned}\\ ] ] when @xmath419 , we have @xmath420\\leq m(x^{x}_{u},u)$ ] . for @xmath421 $ ] , @xmath422 & = & { \\mathbb{e}}^{x_s}m({\\widetilde}{x}_{t - s},u ) \\nonumber\\\\ & \\ge&{\\mathbb{e}}^{(x_{s } , u-(t - s))}[f({\\widetilde}{\\tau}_d ) ] \\\\ & \\ge & m\\bigl(x_{s } , u-(t - s)\\bigr),\\nonumber\\end{aligned}\\ ] ] when @xmath423 . on the other hand , if @xmath424 , @xmath425 & = & { \\mathbb{e}}\\bigl[{\\mathbb{e}}^{(x_{t - u},0)}[m({\\widetilde}{x}_u , u)]|{\\mathcal{f}}_s\\bigr ] \\nonumber\\\\ & \\geq&{\\mathbb{e}}\\bigl[{\\mathbb{e}}^{(x_{t - u},0)}[f({\\widetilde}{\\tau}_d)]|{\\mathcal{f}}_s\\bigr ] \\\\ & \\ge&{\\mathbb{e}}[m(x_{t - u},0)|{\\mathcal{f}}_s].\\nonumber\\end{aligned}\\ ] ]    then we can write @xmath426 & = & \\int_0^t { \\mathbb{e } } [ m(x_t , u ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u - { \\mathbb{e } } [ z(x_t ) | { \\mathcal{f}}_s ] \\\\[-2pt ] & = & g(x_s , s ) + \\int_0^t { \\mathbb{e } } [ m(x_t , u ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u - \\int_0^s m(x_s , u ) \\,{\\mathrm{d}}u \\\\[-2pt ] & & { } - { \\mathbb{e } } [ z(x_t)-z(x_s ) | { \\mathcal{f}}_s ] \\\\[-2pt ] & \\ge & g(x_s , s ) + \\int_0^{t - s } { \\mathbb{e } } [ m(x_{t - u},0 ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u - \\int_0^s m(x_s , u ) \\,{\\mathrm{d}}u \\\\[-2pt ] & & { } - \\int_s^t { \\mathbb{e } } [ m(x_{u},0 ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u + \\int_{t - s}^t m(x_s , s - t+u ) \\,{\\mathrm{d}}u \\\\[-2pt ] & \\ge & g(x_s , s ) + \\int_s^{t } { \\mathbb{e } } [ m(x_{u},0 ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u - \\int_s^t { \\mathbb{e } } [ m(x_{u},0 ) | { \\mathcal{f}}_s ] \\,{\\mathrm{d}}u \\\\[-2pt ] & & { } + \\int_{0}^s m(x_s , u ) \\,{\\mathrm{d}}u",
    "-\\int_0^s m(x_s , u ) \\,{\\mathrm{d}}u \\\\[-2pt ] & \\ge & g(x_s , s).\\end{aligned}\\ ] ] where we have used ( [ eqmsubmart1 ] ) and ( [ eqmsubmart2 ] ) in the third line .",
    "on the other hand , on @xmath427 , from the definition of @xmath348 and the markov property , we get @xmath428 = m(x_s , s - u)\\ ] ] when @xmath429 , and @xmath430 = m(x_u , 0)\\ ] ] when @xmath431 $ ] .",
    "then a similar calculation to above gives , for @xmath432 , @xmath433 \\\\[-2pt ] & & \\qquad = { \\mathbb{e}}\\biggl [ \\int_0^{t\\wedge\\tau_d } m(x_{t\\wedge\\tau_d},{t\\wedge \\tau_d}-u ) \\,{\\mathrm{d}}u \\big| { \\mathcal{f}}_s\\biggr ] - { \\mathbb{e } } [ z(x_{t\\wedge\\tau_d } ) | { \\mathcal{f}}_s ] \\\\[-2pt ] & & \\qquad = \\int_0^s m(x_s , s - u)\\,{\\mathrm{d}}u + { \\mathbb{e}}\\biggl [ \\int_s^{t\\wedge\\tau_d } m(x_{t\\wedge\\tau_d},{t\\wedge\\tau_d } - u ) \\,{\\mathrm{d}}u \\big| { \\mathcal{f}}_s\\biggr ] \\\\[-2pt ] & & \\qquad\\quad { } - z(x_s ) - { \\mathbb{e}}\\biggl [ \\int_s^{t\\wedge\\tau_d } m(x_u,0 ) \\,{\\mathrm{d}}u \\big| { \\mathcal{f}}_s\\biggr ] \\\\[-2pt ] & & \\qquad = { \\mathbb{e}}\\biggl [ \\int_s^{t } { \\mathbb{e } } [ m(x_{t\\wedge\\tau_d},{t\\wedge \\tau_d } - u ) - m(x_u,0 ) | { \\mathcal{f}}_u ] \\mathbf{1}_{\\{u \\le\\tau_d\\ } } \\,{\\mathrm{d}}u \\big |{\\mathcal{f}}_s\\biggr ] \\\\[-2pt ] & & \\qquad\\quad + g(x_s , s ) \\\\[-2pt ] & & \\qquad = g(x_s , s),\\end{aligned}\\ ] ] where we have used ( [ eqmmart1 ] ) and ( [ eqmmart2 ] ) .",
    "note that the fact that our choice of @xmath112 given in the solution is the domain @xmath112 which arises in solving root s embedding problem is only used in theorem  [ thmoptimality ] to enforce the lower bound .",
    "in fact , we could choose any barrier @xmath41 , and @xmath434 as our domain , and this would result in a lower bound , with corresponding functions @xmath435 and @xmath436 .",
    "the choice of root s barrier gives the optimal lower bound , in that we can attain equality for some stopping time . in this context , it is worth recalling the lower bounds given by carr and lee  @xcite , proposition  3.1here a lower bound is given which essentially corresponds to choosing the domain with @xmath437 , for a constant @xmath438 .",
    "the arguments given above show that similar constructions are available for any choice of @xmath99 , and the optimal choice corresponds to root s construction .",
    "[ rmkbndsigisid ] although the preceding section is written for a diffusion on @xmath172 , it is not hard to check that the case where @xmath90 can also be included without many changes . in this",
    "setting , we need to restrict the space variable to the space @xmath293 ( so we assume that @xmath280 a.s . ) , and consider a starting distribution which is also supported on @xmath293 , and with a corresponding change to ( [ eqmassumption ] ) .",
    "we end this section with a brief example which illustrates some of the relevant quantities .",
    "[ exoptimal ] suppose we take root s barrier @xmath439 with the boundary function @xmath440 where @xmath441 ; see figure  [ figgraphroot]a . given a standard brownian motion @xmath442 and root s stopping time @xmath443 define @xmath444 .",
    "let @xmath445 , and we will see @xmath446\\le{\\mathbb{e}}[f(\\tau)]$ ] for any ui stopping time @xmath24 such that @xmath447 .    for @xmath448 , define @xmath449 $ ] .",
    "then if @xmath153 , @xmath450 .",
    "if @xmath451 , since @xmath452 , using it s formula , we can compute @xmath348 to be @xmath453\\qquad \\mbox{for } 0\\leq t < r(x).\\ ] ] defining @xmath454 as in ( [ eqzdefn])([eqhdefn ] ) , we get the explicit expressions @xmath455-z(x ) , & \\quad $ \\mbox{if } 0\\leq t < r(x),$\\vspace*{2pt}\\cr \\displaystyle\\frac{r^{2}(x)}{2(1+\\lambda ) } + { \\frac{1}{2}}t^{2}-z(x),&\\quad $ \\mbox{if } t\\geq r(x),$ } \\\\",
    "h(x)&=&-\\frac{r^2(x)}{2(1+\\lambda)}+z(x ) .\\end{aligned}\\ ] ] it is easy to check directly that @xmath456 is a submartingale , and that it is a martingale up to the stopping time @xmath155 .",
    "we also can check that ( [ eqgfineq ] ) holds here : @xmath457 ^ 2}{2(1+\\lambda ) } , & \\quad $ \\mbox{if } 0\\leq t < r(x),$\\vspace*{2pt}\\cr 0,&\\quad $ \\mbox{if } t\\geq r(x).$}\\ ] ] therefore , for any ui stopping time @xmath24 such that @xmath458 , @xmath459 & \\geq&{\\mathbb{e}}[g(w_{\\tau},\\tau)+h(w_\\tau)]\\geq{\\mathbb{e}}[g(w_{\\tau _ { d}},\\tau_{d } ) ] + { \\mathbb{e}}[h(w_{\\tau_d } ) ] \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & = & { \\mathbb{e}}[f(r(w_{\\tau_{d } } ) ) ] + { \\mathbb{e}}\\biggl[\\int_{r(w_{\\tau_{d}})}^{\\tau_{d } } m(w_{\\tau_{d}},s)\\,{\\mathrm{d}}s\\biggr ] = { \\mathbb{e}}[f(\\tau_{d})],\\end{aligned}\\ ] ] which shows the optimality of root s stopping time .",
    "figure  [ figoptex ] illustrates some of the relevant functions derived here .    [ cols=\"^,^ \" , ]",
    "we now turn to our motivating financial problem : consider an asset price @xmath460 defined on a complete probability space @xmath461 , with @xmath462 under some probability measure @xmath463 , where @xmath464 is the objective probability measure , and @xmath465 a @xmath466-brownian motion .",
    "in addition , we suppose @xmath467 is the risk - free rate which we require to be known , but which need not be constant .",
    "in particular , let  @xmath468 be locally bounded , predictable processes so that the integral in ( [ eqsdefn ] ) is well defined , and so @xmath460 is an it process .",
    "we suppose that the process @xmath1 is not known ( or more specifically , we aim to produce conclusions which hold for all @xmath1 in the class described ) .",
    "specifically , we shall suppose :    [ assprice ] the asset price process , under some probability measure @xmath463 , is the solution to the sde ( [ eqsdefn ] ) , where @xmath467 and @xmath1 are locally bounded , predictable processes .",
    "in addition , we need to make the following assumptions regarding the set of call options , which are initially traded :    [ asscalls ] we suppose that call options with maturity @xmath14 , and at all strikes @xmath469 are traded at time @xmath224 , and the prices , @xmath470 , are assumed to be known .",
    "in addition , we suppose call - put parity holds , so that the price of a put option with strike @xmath88 is @xmath471 . we make the additional assumptions that @xmath470 is a continuous , decreasing and convex function , with @xmath472 , @xmath473 and @xmath474 as @xmath475 .    many of these notions can be motivated by arbitrage concerns ; see , for example , cox and obj  @xcite . that there are plausible situations in which these assumptions do not hold can be seen by considering models with bubbles ( e.g. ,  @xcite ) , in which call - put parity fails , and @xmath476 as @xmath477 .",
    "let us define @xmath478 , and make the assumptions above .",
    "following the perspective that the prices correspond to expectations under @xmath466 , the implied law of @xmath479 ( which we will denote @xmath15 ) can be recovered by the breeden ",
    "litzenberger formula  @xcite , @xmath480 here we have used @xmath481 to emphasize the fact that this is only an _ implied _ probability , and not necessarily the distribution under the actual measure @xmath466 . from ( [ eqbl ] )",
    "we deduce that @xmath482 , giving an affine mapping between the function @xmath483 and the call prices .",
    "we do not impose the condition that the law of @xmath484 under @xmath466 is @xmath15 , we merely note that this is the law implied by the traded options .",
    "we also do not assume anything about the price paths of the call options : our only assumptions are their initial prices , and that they return the usual payoff at maturity .",
    "it can now also be seen that the assumption that @xmath485 is equivalent to assuming that there is no atom at 0that is , @xmath15 is supported on @xmath293 .",
    "finally , it follows from the assumptions that @xmath15 is an integrable measure with mean  @xmath486 .",
    "our goal is to now to use the knowledge of the call prices to find a lower bound on the price of an option which has payoff @xmath487 consider the discounted stock price , @xmath488 under assumption  [ assprice ] , @xmath27 satisfies the sde @xmath489 defining a time change @xmath490 , and writing @xmath491 for the right - continuous inverse , so that @xmath492 , we note that @xmath493 is a brownian motion with respect to the filtration @xmath494 , and if we set @xmath495 , we have @xmath496 in particular , @xmath497 is now of a form where we may apply our earlier results , using the target distribution arising from ( [ eqbl ] ) , and noting also that @xmath498 and @xmath499 .",
    "we now define functions as in section  [ secoptimality ] , so that @xmath500 and ( [ eqmdefn])([eqhdefn ] ) hold .",
    "our aim is to use ( [ eqgfineq ] ) , which now reads @xmath501 to construct a sub - replicating portfolio .",
    "we shall first show that we can construct a trading strategy that sub - replicates the @xmath502 portion of the portfolio .",
    "then we argue that we are able , using a portfolio of calls , puts , cash and the underlying , to replicate the payoff @xmath503 .",
    "since @xmath502 is a submartingale , we do not expect to be able to replicate this in a completely self - financing manner .",
    "however , by the doob ",
    "meyer decomposition theorem , and the martingale representation theorem , we can certainly find some process @xmath504 such that @xmath505 and such that there is equality at @xmath506 .",
    "moreover , since @xmath507 is a martingale , and @xmath435 is @xmath508 in @xmath112 , we have @xmath509 more generally , we would not expect @xmath510 to exist everywhere in @xmath511 ; however , if , for example , left and right derivatives exist , then we could choose @xmath512 $ ] as our holding of the risky asset ( or alternatively , but less explicitly , take @xmath513 $ ] , for @xmath514 $ ] ) .",
    "it follows that we can identify a process @xmath504 with @xmath515 where we have used , for example , revuz and yor  @xcite , proposition  v.1.4 .",
    "finally , writing @xmath516 , we have @xmath517 if we consider the self - financing portfolio which consists of holding @xmath518 units of the risky asset , and an initial investment of @xmath519 in the risk - free asset , this has value @xmath520 at time @xmath66 , where @xmath521 and therefore @xmath522    we now turn to the @xmath503 component in ( [ eqghineq ] ) .",
    "if @xmath339 can be written as the difference of two convex functions ( so , in particular , @xmath523 is a well - defined signed measure ) , we can write @xmath524 } ( k - x)_+ h''(\\mathrm{d}k).\\end{aligned}\\ ] ] taking @xmath525 , we get @xmath526 } ( b_t k -s_t)_+ h''(\\mathrm{d}k).\\end{aligned}\\ ] ] this implies that the payoff @xmath503 can be replicated at time @xmath14 by `` holding '' a portfolio of @xmath527 \\\\[-8pt ] \\nonumber & & b_t^{-1 } h''(\\mathrm{d}k ) \\mbox { units of the call with strike } b_t k \\mbox { for } k \\in(s_0,\\infty);\\\\ & & b_t^{-1 } h''(\\mathrm{d}k ) \\mbox { units of the put with strike } b_t k \\mbox { for } k \\in(0,s_0];\\nonumber\\end{aligned}\\ ] ] where the final two terms should be interpreted appropriately . in practice , the function @xmath528 can typically be approximated by a piecewise linear function , where the `` kinks '' in the function correspond to traded strikes of calls or puts , in which case the number of units of each option to hold is determined by the change in the gradient at the relevant strike .",
    "the initial cost of setting up such a portfolio is well defined , provided @xmath529 } p(b_t k ) |h''|(\\mathrm{d}k ) + \\int_{(s_0,\\infty ) } c(b_t k ) |h''|(\\mathrm{d}k ) < \\infty,\\ ] ] where @xmath530 is the total variation of the signed measure @xmath523 .",
    "we therefore shall make the following assumption :    [ asshass ] the payoff @xmath503 can be replicated using a suitable portfolio of call and put options , cash and the underlying , with a finite price at time  0 .",
    "we can therefore combine these to get the following theorem :    [ thmhedge ] suppose that assumptions  [ assprice ] ,  [ asscalls ] and  [ asshass ] hold , and suppose @xmath18 is a convex , increasing function with @xmath337 and right derivative @xmath500 which is bounded .",
    "then there exists an arbitrage if the price of an option with payoff @xmath531 is less than @xmath532 \\\\[-8pt ] \\nonumber & & \\qquad { } + b_t^{-1}\\int_{(0,s_0 ] } p(b_t k ) h''(\\mathrm{d}k),\\end{aligned}\\ ] ] where the functions @xmath435 and @xmath436 are as defined in ( [ eqgdefn ] ) and ( [ eqhdefn ] ) , and are determined by the solution @xmath155 to sep@xmath533 for @xmath90 , and where @xmath15 is determined by  ( [ eqbl ] ) .",
    "moreover , this bound is optimal in the sense that there exists a model which is free of arbitrage , under which the bound can be attained .",
    "it follows from theorem  [ thmmaingbm ] that , given @xmath15 , we can find a domain  @xmath112 and corresponding stopping time @xmath155 which solves sep@xmath533 . applying proposition  [ propgfineq ] ( and bearing in mind remark  [ rmkbndsigisid ] ) , we conclude that the strategy described above will indeed sub - replicate , and we can therefore produce an arbitrage by purchasing the option , and selling short the portfolio of calls , puts and the underlying given in ( [ eqhport ] ) , and in addition , holding the dynamic portfolio with @xmath534 units of the underlying at time @xmath66 .",
    "it is not hard to check , given that  @xmath133 is bounded ( and choosing the lower limits in ( [ eqzdefn ] ) to be @xmath486 rather than @xmath224 ) that @xmath535 , and hence that ( [ eqqvbddcond ] ) holds .",
    "condition ( [ eqmassumption ] ) also clearly holds .",
    "as a consequence , we do indeed have a subhedge .",
    "to see that this is the best possible bound , we need to show that there is a model which satisfies assumption  [ assprice ] , has law @xmath15 under @xmath466 at time @xmath14 , and such that the subhedge is actually a hedge . but consider the stopping time @xmath155 for the process  @xmath497 .",
    "define the process @xmath536\\ ] ] which corresponds to the choice of @xmath537 . since @xmath538 a.s . , then @xmath539 , @xmath540 and @xmath541 is a price process satisfying assumption  [ assprice ] with @xmath542 finally , it follows from ( [ eqgfequal ] ) that at time @xmath14 , the value of the hedging portfolio exactly equals the payoff of the option .",
    "the above results are given in the context of an increasing , convex function , but there is also a similar result concerning increasing , concave functions which can be derived . consider a bounded , increasing function @xmath133 as before , and define the function @xmath543 using theorem  [ thmhedge ] and ( [ eqloghedge ] ) , it is easy to see that the price of a contract with payoff @xmath544 must be bounded above by @xmath545 } p(b_t k ) h''(\\mathrm{d}k),\\end{aligned}\\ ] ] where @xmath438 is the price of a log - contract [ i.e. , an option with payoff @xmath546 .",
    "as before , this upper bound is the best possible , under a similar set of assumptions .",
    "an analogous result can be shown for _ forward start _ options .",
    "suppose that the option has payoff @xmath547 for fixed times @xmath548 .",
    "then we can use the previous results for general starting distributions to deduce a similar result to theorem  [ thmhedge ] for forward start options , provided we assume that there are calls traded at both @xmath549 and @xmath14 .",
    "we use essentially the same idea as above : we aim to hold a portfolio which @xmath550 for @xmath551 $ ] , and hold the payoff @xmath503 as a portfolio of calls .",
    "however , we now have @xmath552 , and so @xmath495 , gives @xmath553 ( recall that @xmath491 was assumed right - continuous ) .",
    "the procedure is much as above , except that we need to use the solution to theorem  [ thmoptimality ] with a general target distribution , and the amount @xmath554 will be a @xmath555-random variable .",
    "the initial distribution @xmath38 can be derived using the breeden",
    " litzenberger formula ( [ eqbl ] ) at time @xmath549 . to ensure that we hold the amount @xmath554 at time @xmath549",
    ", we observe that @xmath556 .",
    "hence if , for example , @xmath557 can be written as the difference of two convex functions , we can replicate this amount by holding a portfolio of calls and puts with maturity @xmath549 in a similar manner to ( [ eqhport ] ) .",
    "the remaining details follow as in the hedge described in theorem  [ thmhedge ]    [ rkcorvar ] we can also consider modifications to the realized variance .",
    "consider a slightly different time - change : suppose we set @xmath558 for some `` nice '' function @xmath559 , which in particular we suppose is bounded above and below by positive constants .",
    "then following the computations above , we see that @xmath560 and therefore @xmath561 , where @xmath562 .",
    "we then conjecture that it is possible to extend theorem  [ thmmaingbm ] to cover this new class of functions @xmath563 ( the conditions that should be imposed on @xmath268 such that this result may be extended remains an interesting question for future research ) .",
    "it would then be possible to modify the above arguments to provide robust hedges on convex payoffs of the form @xmath564 an interesting special case of this would then be to give robust bounds on the price of an option on corridor variance @xmath565\\ } } \\,{\\mathrm{d}}s\\biggr),\\ ] ] by considering @xmath566\\}}$ ] , however this would only work in the case where there are no discount rates ( i.e. , @xmath567 ) . in general , we can only give a tight lower bound for options on @xmath568\\ } } \\,{\\mathrm{d}}s\\biggr),\\ ] ] although this does provide a lower bound for ( [ eqcorvar ] ) by considering the case where @xmath569 and @xmath570 .",
    "we conclude by summarizing the results , and describing some interesting questions for future work . in this paper",
    ", we have given a variational inequality representation of root s solution to the skorokhod embedding problem , and provided a novel proof of optimality , which allows us to construct a model - independent subhedge for options on variance .",
    "we believe that our results provide interesting insights into all three aspects of the work : the construction of solutions to the skorokhod embedding problem , proving optimality results for the same and finally the connections with model - independent hedging .",
    "we also believe that there are interesting lines of research that now arise .",
    "the construction opens up a number of questions regarding root s solution to the skorokhod embedding problem : for example , what can be said about the shape of the boundary ?",
    "under what conditions on @xmath15 will the boundary be smooth ? when does @xmath571 as @xmath572 ? when is @xmath55 bounded ?",
    "properties of free boundaries are well studied in the analytic literature , and may be useful in answering these questions .",
    "the connection to minimality and noncentered target distributions raised in remark  [ rknoncentred ] , and the question asked at the end of this remark would also be interesting lines for research .",
    "the connection with optimal stopping noted in remark  [ rmkoptstop ] is interesting , and obtaining a deeper understanding between optimal stopping problems and optimal skorokhod embeddings seems to be an interesting area of research .",
    "another natural question concerns the upper bound / super - hedging strategy .",
    "it has been remarked by obj  @xcite and carr and lee  @xcite that a related construction of rost should provide a suitable upper bound , but similar questions to those answered here remain ( although we hope to be able to provide some answers in subsequent work ) .",
    "we note , however , that numerical evidence ( see carr and lee  @xcite ) seems to suggest that the root bounds may be more appropriate in the financial applications .",
    "it would also be of interest to see to what extent these model - independent bounds may be useful in practice . in cox and obj  @xcite ,",
    "an analysis of the use of model - independent bounds as a hedging strategy for barrier options was performed .",
    "a similar analysis of the strategies derived in this work would also be of interest .",
    "other questions that arise from the practical standpoint include how to incorporate additional market information ( e.g. , calls at an intermediate time  @xcite ) , and how to adjust for the fact that there will generally only be a finite set of quoted calls ; see  @xcite for a related question .",
    "remark  [ rkcorvar ] also suggests open questions regarding more general choices of @xmath563 .",
    "we are grateful to sam howison for a helpful discussion which has much improved the material in sections  [ secobs ] and  [ secvarineq ] ."
  ],
  "abstract_text": [
    "<S> recent work of dupire and carr and lee has highlighted the importance of understanding the skorokhod embedding originally proposed by root for the model - independent hedging of variance options . </S>",
    "<S> root s work shows that there exists a _ </S>",
    "<S> barrier _ from which one may define a stopping time which solves the skorokhod embedding problem . </S>",
    "<S> this construction has the remarkable property , proved by rost , that it minimizes the variance of the stopping time among all solutions .    in this work , </S>",
    "<S> we prove a characterization of root s barrier in terms of the solution to a variational inequality , and we give an alternative proof of the optimality property which has an important consequence for the construction of subhedging strategies in the financial context .    .    </S>"
  ]
}