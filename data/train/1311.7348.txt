{
  "article_text": [
    "our data set is organized in four layers ( see supplementary information `` databases '' ) , three of which are shown in figure  [ fig : figure_3d_maps ] . the first layer is the population density , which we compute from the @xmath10 landscan global population data set .",
    "the second layer is the european gas pipeline network and liquefied natural gas ( lng ) terminals , which we extract from the platts @xmath11 geospatial data set .",
    "this infrastructure is a spatial network , where nodes and links are geographically located , and links have capacity and length attributes .",
    "the third layer is defined by the urban areas in europe with @xmath12 or more inhabitants , and we compile it from the _",
    "european environment agency _ and _ natural earth_. the fourth layer is the network of annual movements of gas via pipelines and of liquefied natural gas ( lng ) via shipping routes ( see figure  [ fig : flow_network ] ) . we represent gas flowing from an exporting country @xmath13 ( including lng ) to an importing country @xmath14 , by a directed network with weighted adjacency matrix @xmath15 .",
    "natural gas imports by pipeline and via liquefied natural gas ( lng ) terminals in europe during 2011 ( million cubic meters ) .",
    "gas exporting ( importing ) countries are on the left ( right ) of the image . for each exporting country",
    ", we show the breakdown of the volumes of gas exported annually , together with the importing countries served . for each importing country",
    ", we show the volumes of gas imported annually , together with the diversity of supply.,scaledwidth=45.0% ]    gas enters the network at source nodes , is transported over long distances on the pipeline transmission network , and then passed to the distribution network that delivers it to consumers . here",
    "we model only the transport of gas on the transmission network . to model consumption",
    "spatially , we first need a tessellation of each country into disjoint sets of urban and non - urban areas , such that the pipeline network in an area is associated with the population it serves .",
    "urban areas are naturally defined by the boundary of their spatial polygons .",
    "we partition non - urban areas by a voronoi tessellation with the gas pipeline nodes as generators , respecting country borders and excluding all urban areas  ( see supplementary information `` the model '' ) .",
    "we assume that the flow of gas on each pipeline intersecting an urban polygon ( i.e. ,  the border of the urban area ) is directed towards the centre of the urban area . for simplicity",
    ", we also assume that such pipelines supply the urban area from the closest node to the urban polygon that is located inside the urban area .",
    "moreover , each non - urban area is defined by a voronoi cell , and we assume that it is supplied by the cell generator node  ( see supplementary information `` the model '' ) .    to connect sink to source nodes with paths ( see contract paths in methods ) , we first go through each non - zero entry in the @xmath15 transport matrix and link each sink node in an importing country @xmath14 to the @xmath16 closest nodes in an exporting country @xmath13 , if @xmath13 is a country , or to all lng terminals in country @xmath14 , if @xmath13 is lng , where @xmath17 is the number of gas pipeline nodes in an exporting country @xmath13 .    to allocate demand to individual paths , we start with the observation that the demand @xmath15 of an importing country @xmath14 from an exporting country @xmath13 is proportional to the population of country @xmath14  @xcite .",
    "we next split the demand @xmath15 among all source to sink paths between countries @xmath13 and @xmath14 , proportionally to the population served by each sink node .",
    "we now have a value of demand associated with each path , and therefore with each sink node .",
    "finally , we replace each path by a set of identical paths , each having the minimum demand on the network .",
    "this implies that all paths have the same demand , while doubling the demand on a path is equivalent to creating two identical paths with the original demand  ( see supplementary information `` the model '' ) .    to begin integrating routing and congestion control , we first consider how to distribute the capacity @xmath18 of one single congested link over the @xmath19 paths that pass through the link , where @xmath20 is the link - path incidence matrix ( @xmath21 if link @xmath22 belongs to the path @xmath23 and @xmath24 otherwise ) , and where @xmath25 is the number of paths on the network ( see table  1 of the supplementary information `` the model '' ) . to find the exact routing for these paths",
    ", we apply an iterative algorithm that , for each source - sink pair , finds the path with minimum effective path length , where the effective link length is given by @xmath26 , @xmath27 is the length of link @xmath22 , @xmath28 , and @xmath29  ( see supplementary information `` the model '' ) .",
    "we consider two baseline scenarios : the present and future networks .",
    "the present baseline scenario is the network that has been operational since @xmath11 ; the future baseline scenario extends the present network by the planned and under construction pipelines . to determine the network effects of crises , we analyse a range of scenarios that consist in hypothetically removing exporting ( e.g. ,  russia ) or transit ( e.g. ,  ukraine ) countries from the baseline scenarios .",
    "the scenarios are , thus , identified by the baseline ( present or future ) and the hypothetically removed country .",
    "for example , the present russia scenario is given by the present network excluding russia , that is removing all entries in the transport matrix @xmath15 that are movements of gas originating in russia .",
    "similarly , the future ukraine scenario is determined by removing all ukrainian nodes and links from the future network .",
    "broadly , there are three strategies to manage congestion  @xcite .",
    "first , expanding the network capacity is the most obvious way to lower congestion .",
    "the eu has a plan to build major pipelines crossing the continent , that should lower european dependency on russia ( see planned pipelines in figure  s1 of the supplementary information ) . here , we include these planned pipelines in the future scenarios , but make no suggestions for extra infrastructure because the costs of expanding network capacity are high , and thus our focus is on how to best manage the existing and planned network capacity .",
    "second , implementing congestion pricing is a way to cap the consumption of heavy users that cause network bottlenecks .",
    "finally , by identifying groups of countries that have similar patterns of demand , we map a vast number of consumers to a relatively small number of communities that may be able to cooperate during crises  @xcite .",
    "we are aiming at controlling congestion in situations where the network has to perform a function for which it was not designed .",
    "for congestion control , we are using the _ proportional fairness _ algorithm ( see methods ) , which is inspired by the way capacity is managed on the internet  @xcite . the main idea behind proportional fairness is to use pricing on the links in order to control congestion ( see methods and supplementary information `` congestion control '' ) .",
    "use of non - congested links is free up to a threshold , above which the cost that a path incurs for using a link increases linearly , but steeply , with the difference between link capacity and link utilization .",
    "hence , paths that traverse many congested links pay a high cost for contributing to congestion , and thus get a smaller flow allocation than paths that avoid congestion .",
    "a flow is proportionally fair if , to increase a path flow by a percentage @xmath30 , we have to decrease a set of other path flows , such that the sum of the percentage decreases is larger or equal to @xmath30 .",
    "we view the network as an optimizer and the proportional fairness policy as a distributed solution to a global optimization problem  @xcite .     global network throughput by scenario .",
    "( a ) a scenario is named after the country that is hypothetically removed from the network , and coloured in blue ( orange ) if the country is removed from the present ( future ) baseline scenario .",
    "( b ) the country removed per scenario is coloured cyan ( red ) on the map , if it is an exporting ( transit ) country .",
    "the total network throughput increases by @xmath31 from the present baseline to the future baseline scenario ( i.e. ,  when the future and planned pipelines are added to the present network ) .",
    "the most challenging scenarios are the hypothetical removal of russia , followed by ukraine , the netherlands and lng .",
    "when russia is removed from the network , the global network throughput falls by @xmath32 relative to the present baseline and by @xmath33 in relation to the future baseline.,scaledwidth=45.0% ]      for each scenario , we hypothetically remove the scenario country from the network and , if @xmath13 is an exporting country , remove row @xmath13 in the @xmath15 transport matrix .",
    "since the network topology and the flow network @xmath15 depend on the scenario , we then re - compute the source - sink pairs , the demand of each pair , and we also replace every source - sink path with a number of identical paths , each having the minimum demand in the network .",
    "finally , we apply the proportional fairness congestion control algorithm to the resulting network and paths .",
    "we assume that all countries are willing to cooperate , that is , adhere to the rules of the congestion control policy . to assess the effect of the range of scenarios",
    ", we then analyse the throughput at the scales of the european continent , countries , and of urban areas .",
    "we compute the global network throughput , which is the sum of the throughput at all sinks ( urban and non - urban ) , for all the scenarios .",
    "our model reproduces successfully the expected consequences of removing the major source and transit countries from the network ( see figure  [ fig : network_throughput ] ) .",
    "we say that a country is resilient to crises if it combines high throughput per capita across scenarios with a low coefficient of variation of throughput .",
    "in addition , the network is considered resilient to a scenario if the vectors of country throughput per capita for the scenario and the baseline scenario are similar .",
    "to start addressing the resilience of countries and the network to supply and transit crises , we study the signatures in the scenario space given by the country throughput per capita in each of the @xmath34 scenarios .",
    "similarly , a scenario can be seen as a point in the @xmath35-dimensional space of country throughput .",
    "the heat - map in figure  [ fig : clustergram]a shows the throughput per capita for each pair of countries and scenarios  @xcite .",
    "the country groups , determined by dendrograms and highlighted in gray , reflect a similar level of throughput per capita achieved across the scenarios .",
    "countries belong to the high throughput per capita groups ( highlighted in dark gray in the figure ) due to a combination of effects : diversity of supply ; good access to network capacity ( strategic geographical location ) ; and a relatively small population ( see discussion in supplementary information `` results '' ) .",
    "the coefficient of variation , shown in figure  [ fig : clustergram]b for present and future scenarios , measures the normalized dispersion of country throughput per capita using the mean as a measure of scale .",
    "larger values indicate that the throughput accessible to a country varies across scenarios .",
    "figure  [ fig : clustergram]b shows that countries in eastern europe have high coefficient of variation of throughput per capita in the scenarios where we hypothetically remove russia or ukraine .",
    "in other words , countries in eastern europe are still very much dependent on one single source country ( russia ) and one major transit country ( ukraine ) .",
    "unexpectedly , we observe a spillover effect from countries , such as germany , which make large investments in infrastructure .",
    "these countries themselves seem to benefit less from such investments than some of their smaller neighbours .",
    "the reason behind this spillover is that countries with plentiful access to network capacity provide routes for neighbouring countries to also access such capacity .",
    "figure  [ fig : clustergram]a can be read from left to right : the scenarios that cause the largest disruption appear on the left , and the most benign scenarios are on the right .",
    "the present and future scenarios are clustered together when either russia , ukraine , the netherlands , or belarus are removed from the network , demonstrating that the new pipelines being built will only improve slightly the consequences of a hypothetical crisis with one of the major exporting countries ( russia or the netherlands ) , or with a critical transit country ( ukraine or belarus ) .",
    "it is thus very hard to change the consequences of such scenarios even by building new pipelines .",
    "we illustrate our model at a fine geographical scale in the heat - map of figure  [ fig : clustergram]c , where we show the throughput for urban areas in europe with @xmath36 million inhabitants or more , as the scenarios vary .",
    "the figure suggests possible classifications of cities into groups , highlighted in gray .",
    "we observe in figure  [ fig : clustergram]d that the coefficient of variation is larger for cities in eastern europe than for cities elsewhere ( except berlin , vienna and dusseldorf ) .",
    "note that dublin is resilient to all scenarios because it is supplied from the uk , which we never removed from the network .",
    "observe also that austria gets most of its gas from russia , and only a little from norway , so vienna is in a similar situation to eastern european cities .",
    "network throughput of selected countries in a hypothetical crisis with russia .",
    "the right axis shows the country throughput relative to the present baseline scenario . to minimize the impact of the loss of russian supply , we re - allocate paths that originate in russia to norway and the netherlands ( see methods ) .",
    "we then partition countries into two groups : group i is composed of eastern europe ( http://eurovoc.europa.eu/100277 ) together with estonia , finland , greece , latvia and lithuania , and group ii includes all other countries in our study .",
    "group ii countries have a demand of @xmath37 , where @xmath38 .",
    "panels ( a)(c ) show the throughput for selected group i countries ( open squares ) , whereas panels ( d)(f ) illustrate the throughput for group ii countries ( open circles ) .",
    "panels ( a)(c ) demonstrate that countries in group i benefit from curtailing the demand of countries in group ii .",
    "in contrast , panels ( d)(e ) show that some countries in group ii are largely unaffected even when their own demand is curtailed considerably .",
    "finally , panel ( f ) demonstrates that supply to austria is dominated by the demand reduction prefactor , @xmath39 .",
    "indeed , austria is crossed by routes from norway and the netherlands to group i countries , and these routes get a higher allocation of available capacity as austrian demand decreases ( i.e. ,  as @xmath39 decreases).,scaledwidth=45.0% ]    taken together , figures  [ fig : clustergram]a  d illustrate the resilience of countries , urban areas and the network to the scenarios , by showing how countries and urban areas with similar reactions to different types of crises are grouped together by throughput or by its coefficient of variation , and how different scenarios are clustered by their effect on the countries and urban areas .",
    "the most challenging scenario is a hypothetical crisis that would cut - off supply from russia to europe . to investigate how europe could make use of its internal gas production to minimize the impact of such a crisis , we simulate and quantify the effect of replacing gas supply from russia with supply from norway and the netherlands .",
    "to do this , we start by creating two groups of countries .",
    "group i is made of the countries that are heavily dependent on russian gas , and is defined by eastern europe ( http://eurovoc.europa.eu/100277 ) together with estonia , finland , greece , latvia and lithuania .",
    "group ii is defined by all other countries in our study ( see supplementary information `` databases '' ) .",
    "we consider a new scenario where russia is removed from the network and the demand of countries in group i is rerouted to the netherlands and norway . to do this ,",
    "we first create new paths linking each importing country in group i to norway and the netherlands ( see supplementary information `` the model '' ) and we update the matrix of gas flows to @xmath40 ( see methods ) .",
    "next , we apply a prefactor @xmath41 to the values of the demand @xmath40 of countries in group ii .",
    "the effect of @xmath39 is to lower the utilization of the network by countries of group ii that do not depend heavily on russia .",
    "these countries typically have a high value of demand , and hence by curtailing their demand , there will be more capacity available to transport gas from norway and the netherlands to group i countries . in figure",
    "[ fig : west_vs_east ] , we observe that group i countries increase their access to network capacity as @xmath39 decreases .",
    "group ii countries , such as austria , that are geographically on the main routes that link norway and the netherlands to group i countries , decrease their throughput as @xmath39 decreases .",
    "these countries are crucial : their throughput decreases as they share their network to benefit the more populous group i countries .",
    "in contrast , access to network capacity in routes supplying group ii countries , such as germany and italy , is broadly unaffected , even as @xmath39 is lowered considerably , because routes from norway and the netherlands to group i countries use little network capacity from these group ii countries . despite the increase in throughput for countries in group",
    "i as @xmath39 decreases , figure  [ fig : west_vs_east ] shows the difficulty in replacing russia by the netherlands and norway .",
    "although we can hope to recover between @xmath42 and @xmath43 of the baseline throughput for the czech republic and slovakia , we will only recover up to @xmath44 of the russian supply to ukraine and up to @xmath45 of the austrian supply .",
    "figures  [ fig : present_scenarios_1 ] , [ fig : present_scenarios_2 ] , [ fig : future_scenarios_1 ] and  [ fig : future_scenarios_2 ] show the load on network links in the present and future scenarios .",
    "these figures demonstrate that our model reproduces the main transport corridors in europe , and show the spatial pattern of bottleneck links for each scenario .",
    "it is apparent how a hypothetical removal of either russia or ukraine cuts - off the major transport routes , and damages drastically the supply of populations in europe .        *",
    "greece receives its gas from diverse sources , and thus is resilient to the scenarios we analyse .",
    "it gets most of its gas from russia ( @xmath174 ) , from turkey ( @xmath175 ) and lng ( @xmath176 ) ; * ireland gets its gas from the uk and is unaffected by our scenarios , since the uk is a secure source in our model ; * switzerland acts like a hub between south and northern europe , so it has very good access to network capacity ; * ukraine is a major transit route for gas to europe ; * latvia and finland have a relatively small population , good access to network capacity and are very close to russia ; * surprisingly , belarus does better when ukraine is removed from the network .",
    "the apparent contradiction is solved by realizing that europe s supply from russia has been historically built around ukraine .",
    "hence , ukrainian routes have higher capacity and shorter routes to central europe than routes that pass through belarus .",
    "in contrast , when ukraine is removed from the network , routes through belarus become the first choice to supply central europe ; * belgium draws its high energy security from diversification of supply .",
    "it gets its gas from the netherlands ( @xmath177 ) , from norway(@xmath178 , including lng ) , russia ( @xmath179 ) , germany ( @xmath180 ) , and the uk ( @xmath181 ) .",
    "* surprisingly , rome seems to gain slightly from removing libya .",
    "rome is approximately in the middle of the italy , and the country is supplied both from the south and from the north .",
    "when libya is removed there is no need to transport gas from the south to the north of italy and this frees capacity to bring more gas from the north to rome ; * unexpectedly , berlin gains from the removal of poland .",
    "germany is transporting gas to poland . when poland is removed , the capacity that is freed can be used for german cities located close to the polish border , including berlin ; * finally , dublin is resilient to all scenarios because it gets all of its supply from the uk , and we do not have any scenario affecting the ability of uk to supply gas .",
    "bettencourt lma , lobo j , helbing d , kuehnert c , west gb ( 2007 ) growth , innovation , scaling , and the pace of life in cities .",
    "_ proceedings of the national academy of sciences of the united states of america _ 104:73017306 .",
    "schneider cm , moreira aa , andrade js , havlin s , herrmann hj ( 2011 ) mitigation of malicious attacks on networks .",
    "_ proceedings of the national academy of sciences of the united states of america _ 108:38383841 .",
    "agreed political management processes are needed for crises scenarios , to guarantee supply to the most affected countries and urban areas and minimize the loss of gas by populations . here",
    ", we propose a decentralized algorithm inspired by congestion control on the internet , which would eliminate the need of improvisation and complicated , lengthy negotiations every time a crisis occurs .",
    "such mechanism has a stabilizing effect because it lowers the resource deficiency of the most affected countries  @xcite .",
    "we demonstrate how a wide range of scenarios impacts network throughput at global , country and urban levels , and how countries and urban areas react to scenarios of hypothetical crises .",
    "we show and quantify how countries that are heavily dependent on russian supply can lower the impact of a crisis , if other countries accept to reduce their demand .",
    "finally , our model tries to systematically compare alternative policy options during energy crises , using complex system models  @xcite .    in summary ,",
    "europe is not necessarily trapped and helpless during energy crises .",
    "the long - term interest in the sustainability of the gas industry makes governments and the industry likely to invest in rules and norms to enhance reciprocity and collective efforts during crises .",
    "because the number of governments and companies ultimately involved in taking the decisions in europe is relatively high , governments could implement decentralized solutions similar to the one we propose here , perhaps with a centralized control solution as backup . at its heart , energy security , like preparedness for future pandemics  @xcite , is about cooperation among nations  @xcite . to avoid european - wide crises",
    ", nations must cooperate to share access to their critical infrastructure networks .",
    "let @xmath46 be an undirected and connected weighted graph with no loops , node - set @xmath47 and link - set @xmath48 .",
    "each link @xmath22 has a capacity @xmath18 and a length @xmath27 .",
    "the network has a set of @xmath25 paths connecting source to sink nodes .",
    "all links of a path transport the same _ path flow_. different paths can share a link , even to perform transport in different directions ( e.g. , , during distinct time intervals ) .",
    "the relationship between links and paths can be described by the _ link - path incidence matrix _ @xmath20 as follows .",
    "set @xmath21 if the link @xmath22 belongs to the path @xmath23 , and set @xmath24 otherwise .",
    "matrix @xmath20 has dimensions @xmath49 , and maps paths to the links contained in these paths .",
    "when @xmath20 is applied to a vector of path flows , the resulting vector with components @xmath50 is the total flow on the links , or link throughput .",
    "we say that a link is a _ bottleneck _ if the sum of the path flows of paths that pass through it is equal to the link capacity .",
    "we assume that flows are elastic , that is that path flows are determined by the available network capacity .",
    "the pipeline contracts are for physical point - to - point transport on a given system over a _ contract path _",
    "the contract path is a route between a pair of source and sink nodes , such that gas flows from source to sink along that path and the transport costs are only incurred on links along that route .",
    "a decentralized algorithm for congestion control ( see supplementary information `` congestion control '' ) solves the system of coupled odes : @xmath51 where the price on link @xmath22 is @xmath52 and the price function is given by @xmath53      consider a system where the shadow prices vary gradually as a function of the path flows ( see supplementary information `` congestion control '' ) : @xmath54 where @xmath55 and @xmath56 is the inverse of @xmath57 . as @xmath58 ,",
    "the dual and primal algorithms become equivalent .",
    "when russia is removed from the network , we reroute paths between group i countries and russia to paths between group i countries and the netherlands and norway .",
    "to do this , we pair the new source and sink nodes as described in supplementary information `` the model '' , but we modify the @xmath15 matrix of gas flows .",
    "the new @xmath40 matrix is found by reallocating the demand from russia for group i countries to the netherlands and norway , proportionally to the production of gas of these two exporting countries : @xmath59 where @xmath60 and @xmath61 are the normalised proportions of supply from norway and the netherlands , respectively .",
    "we gratefully acknowledge the support of the raven epsrc project ( ep / h04812x/1 ) .",
    "was partially supported by vega ( project 1/0339/13 ) and apvv ( project apvv-0760 - 11 ) .",
    "we thank ethz for granting access to the brutus high - performance cluster .",
    "voropai ni , senderov sm , edelev av ( 2012 ) detection of `` bottlenecks '' and ways to overcome emergency situations in gas transportation networks on the example of the european gas pipeline network .",
    "_ energy _ 42:39 .",
    "bettencourt lma , lobo j , helbing d , kuehnert c , west gb ( 2007 ) growth , innovation , scaling , and the pace of life in cities .",
    "_ proceedings of the national academy of sciences of the united states of america _ 104:73017306 .",
    "kelly f , raina g ( 2011 ) _ explicit congestion control : charging , fairness and admission management _ , in next - generation internet : architectures and protocols , eds ramamurthy b , rouskas gn , sivalingam km ( cambridge university press , new york ) .",
    "eisen mb , spellman pt , brown po , botstein d ( 1998 ) cluster analysis and display of genome - wide expression patterns .",
    "_ proceedings of the national academy of sciences of the united states of america _ 95:1486314868 .",
    "we use the @xmath10 landscan  @xcite high - resolution global population distribution data that estimates the population count with a spatial resolution of approximately @xmath62 km , or @xmath63 seconds of arc ( see  http://www.ornl.gov/sci/landscan/ ) .",
    "we compiled the european gas pipeline transmission network and the liquefied natural gas ( lng ) terminals from the @xmath11 platts natural gas geospatial data ( see http://www.platts.com/products/gisdata ) , including pipelines that are planned or under construction .",
    "the data set covers @xmath64 of the @xmath65 eu member states ( except malta and cyprus ) , belarus , moldova , western russia , ukraine ( all part of the former ussr ) , bosnia and herzegovina , croatia , macedonia , serbia ( all part of the former socialist federal republic of yugoslavia ) , algeria , libya , morocco , tunisia ( all part of the maghreb ) , norway , switzerland and western turkey .        similarly to electrical power grids ,",
    "gas pipeline networks have two layers : transmission and distribution .",
    "the transmission network transports natural gas over long distances ( typically across countries ) and has a non - trivial topology .",
    "the distribution network is tree - like and comprises pipelines with smaller diameter that deliver gas to consumers .",
    "we extract the gas pipeline transmission network as all the important pipelines with diameter @xmath66 inches . to finalize the network , we add pipelines interconnecting major branches , so that the resulting network is connected .",
    "network links are weighted by pipeline diameter and length . to simplify ,",
    "we assume that gas can flow on both directions of a pipeline , although over different time periods .",
    "the compiled network has @xmath67 nodes ( compressor stations , city gate stations , liquefied natural gas ( lng ) terminals , etc . )",
    "connected by @xmath68 pipeline segments spanning @xmath69 km .      to avoid the controversy in the definition of an urban area  (",
    "* ch iv , p 49 ) , we considered only urban areas with @xmath12 or more inhabitants as defined by the eurostat urban audit ( see  http://www.urbanaudit.org ) .",
    "we are interested not just in the administrative boundaries of cities , but intend also to capture the surrounding areas that include a substantial share of the commuters into the city , since the gas pipeline infrastructure also supplies these peripheral urbanized districts .",
    "note that the infrastructure network supplies directly the major urban areas , but may not intersect spatially with the built - up area of cities .",
    "urban areas in the european union member countries and candidate countries are defined by eurostat as _ larger urban zones _ ( http://www.urbanaudit.org ) , and",
    "the gis files are provided by the european environment agency ( http://www.eea.europa.eu/data-and-maps/data/urban-atlas ) .",
    "the city levels in non - eu countries are defined from remotely sensed data ( see  @xcite and  http://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-urban-area/ ) .",
    "these city level areas are too small compared with the eu larger urban zones .",
    "hence , we define an urban area in non - eu countries to be the union of the third - level administrative divisions  ( http://www.gadm.org/ ) that intersect the corresponding city level polygon",
    ". we have found @xmath70 urban areas with a total area of @xmath71 .",
    "the fourth layer is the network of annual movements of gas by pipeline and of liquefied natural gas by ship into european terminals , collected from the international energy agency natural gas information statistics for @xmath11  @xcite ( see  http://www.oecd-ilibrary.org/statistics ) .",
    "this directed network is represented by the weighted adjacency matrix @xmath15of gas transported from @xmath13 to @xmath14 , where @xmath13 stands either for a gas exporting country or for liquefied natural gas ( lng ) terminals that supply an importing country @xmath14 ( see figure  @xmath72 of the main paper ) .",
    "we make use of iso alpha-@xmath72 country codes in @xmath13 and @xmath14 to denote individual countries ( see http://www.iso.org/iso/home/standards/country_codes.htm ) , so that , for example , @xmath73 is the amount of gas imported annually by france from russia .",
    "[ [ tessellation - of - urban - and - non - urban - areas - and - location - of - source - and - sink - nodes ] ] tessellation of urban and non - urban areas and location of source and sink nodes ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    for simplicity , we consider that all nodes in a gas exporting country are source nodes .",
    "the partition of non - urban areas is such that all points within a given voronoi cell are closer to their corresponding gas pipeline node than to any other node .",
    "if a gas pipeline node is inside an urban polygon , we call it an urban node , otherwise , we say the node is non - urban . to simplify , we assume that an urban area is supplied by the pipeline links that cross its border and have a node inside its polygon .",
    "this node turns out to be also the urban node on the pipeline that is the closest to the border of the urban polygon , and is thus the first node that gas will cross along the pipeline when entering the urban area .",
    "hence , we naturally say that the node is an urban sink , and we consider no other sink nodes along the pipeline for the given urban area .",
    "if an urban area polygon contains no gas nodes , we associate it to the closest gas node ( urban or not ) and say this node is a sink .",
    "we exclude pipeline links that have both end nodes located inside urban areas . in other words",
    ", we only consider pipeline links that have one urban and one non - urban node ( see figures  [ fig : urbansinks ] and  [ fig : city_sink_panels ] ) .",
    "source nodes are either located in an exporting country @xmath13 , or at liquefied natural gas ( lng ) terminals .",
    "when @xmath13 stands for a country , we connect by a path @xmath74 ( @xmath75 and @xmath76 ) the @xmath77 sinks in an importing country @xmath14 to the @xmath78 closest source nodes in the exporting country @xmath13 , where @xmath79{ll}\\min(10,s_m ) & \\text{if } m\\text { is a gas exporting country}\\\\ g_n & \\text{if } m\\text { is lng } \\end{array } \\right . .",
    "\\label{eq : phi}\\ ] ] in other words , when @xmath13 is a country , we connect each sink node in an importing country @xmath14 to a maximum of ten source nodes in an exporting country @xmath13 .",
    "when @xmath13 stands for lng , we assume that sink nodes in an importing country @xmath14 are supplied from all the lng terminals in country @xmath14 ( see summary of the notation in table  1 ) .",
    "we define the demand of a country to be the amount of gas imported over the gas pipeline network and liquefied natural gas terminals , as given by the @xmath15 matrix ( see figure  @xmath72 of the main paper ) , and the demand of a given geographical area to be the demand of the country weighted by the ratio between the area and the country populations .",
    "since demand for energy is proportional to population  @xcite , we locate the sink nodes and associate them with the population they supply .",
    "when the area is urban , we split its total population equally among the sink nodes inside the urban polygon . if an urban area contains no gas nodes inside its polygon , we add its population to the population associated with the closest gas node . in non - urban areas , we associate the gas pipeline node at centre of a voronoi cell with the population of the cell . because each sink node in an importing country @xmath14 is connected by @xmath78 paths to source nodes in an exporting country @xmath13 , each of these paths has a share of the demand @xmath15 given by @xmath80 where @xmath81 is the population associated with sink node @xmath82 of importing country @xmath14 , @xmath83 is the population of importing country @xmath14 , @xmath15 is the volume of gas imported by an importing country @xmath14 from an exporting country @xmath13 , and the number @xmath78 of paths from an exporting country @xmath13 to each sink node is given by equation  ( [ eq : phi ] ) ( see summary of the notation in table  1 ) .",
    "we next express the demand of a path in units of the minimum demand on the network . to do this , we note that @xmath84 is independent of @xmath85 , and we replace path @xmath74 having demand @xmath84 by @xmath86 paths identical to @xmath74 , each with demand @xmath87 , where @xmath88 where @xmath89 is the largest integer not greater than @xmath90 .",
    "we note that the demand of a sink node from a source node is now proportional to the number of paths connecting the source and sink pair .",
    "the path notation @xmath74 has been useful so far to locate the origin and destination of the paths , but the congestion control algorithm uses matrix multiplication , and it is simpler from now on to index paths in the network by an integer . to do this ,",
    "we loop through all pairs of exporting and importing countries with a non - zero entry in the @xmath91 matrix and re - label each of the @xmath86 source - sink paths identical to @xmath74 by the new index . in other words , for each pair of importing - exporting countries , we go through the @xmath92 shortest paths that connect source to sink nodes ( see table  1 ) , and we index all paths in increasing order of first @xmath13 , then @xmath14 and finally @xmath85 . now",
    "that we have allocated the source to sink paths , we update the number of paths on the network @xmath93 , where @xmath94 if @xmath15 is positive and zero otherwise , and we write @xmath23 to denote path @xmath95 , where @xmath96 .",
    "the pattern of route intersection determines how much the paths condition each other in their sharing of network links , and the capacity of links limits how much can be transported locally .",
    "if the network is not congested , transport over the geographical shortest paths minimizes the costs .",
    "in contrast , shortest path routing in congested networks can be inefficient , because it may cause congestion at a few overloaded links , while avoiding alternative routes that are only slightly longer but have higher capacity .",
    "moreover , routing over shortest paths in gas pipeline networks makes the effect of congestion even worst .",
    "indeed , parallel routes with similar capacity are often available , but only one of these routes is the shortest path ( see figure  [ fig : foot_of_italy_parallel_pipes ] ) , and hence the network capacity is largely underused .        to begin integrating routing and congestion control , we consider first how to distribute the capacity @xmath18 of a congested link @xmath22 over the @xmath97 paths that pass through the link when we add a new path through @xmath22 , where @xmath20 is the link - path incidence matrix ( @xmath21 if the link @xmath22 belongs to the path @xmath23 and @xmath24 otherwise )",
    ". an equitable way to divide the capacity on the link is to assign a path flow of @xmath28 to each of the @xmath98 paths .",
    "intuitively , @xmath99 is the slice of capacity allocated in a fair way to each of the @xmath100 paths that share the capacity @xmath18 , and the split is viewed as a fair outcome  @xcite .",
    "moreover , @xmath101 can be interpreted as a simple measure of network congestion , since it has a maximum at the most congested link  @xcite .",
    "hence , we combine routing and congestion through an effective link length : @xmath102 where @xmath103 is the average of @xmath99 over all network links , @xmath27 is the length of link @xmath22 , and @xmath104 . whereas we weight links by their length @xmath27 in the calculation of geographical shortest paths , we now weight each link by @xmath105 in the calculation of weighted shortest paths .",
    "thus , a link becomes less attractive ( its effective length is increased ) if it is more congested than the average .",
    "we find that the global network throughput is maximized for @xmath29 ( see figure  [ fig : alpha_parameter ] ) , and thus we use this value in the simulations .",
    "we define the effective path length @xmath106 of path @xmath95 as the sum of the effective lengths of each of its links .",
    "we interpret the sum of link weights on a path as a penalty , which we then use to reroute paths iteratively via the following heuristic  @xcite .",
    "we i ) go through each source and sink node pair and find a new path @xmath95 connecting the two nodes ; ii ) if this new path has lower value of @xmath106 than the previously found path , then it replaces the existing source to sink path ; iii ) we recompute the weights @xmath105 for all links on the new paths and repeat the procedure for all paths , until it has been executed @xmath34 times ( we found that the solution is does not change significantly when the number of iterations is larger than @xmath34 ) .",
    "how should we allocate scarce network resources to competing paths so as to manage network congestion ?",
    "there are two mechanisms at play in such allocation .",
    "on one hand , maximizing the flow transported on the network may lead to some paths being assigned a zero share of network capacity , and hence zero path flow .",
    "these paths are effectively blocked from using the network , and hence the flow allocation is unfair . on the other hand , allocations that share network capacity",
    "fairly are known to deliver low throughput and are thus inefficient  @xcite .",
    "hence , a good solution to the problem of congestion control aims at a trade - off between efficiency and fairness .",
    "how should we generalize equation  ( [ eq : link_weights ] ) when paths pass through several congested links on the network ?",
    "our intuitive notion of fairness breaks down on networks , because paths typically cross several congested links and hence share the capacity of these links with other paths .",
    "roughly , a solution is to allocate path flows iteratively , such that at each iteration we increase all path flows that do not pass through existing bottleneck links by the slice of capacity that is found by sharing equitably the capacity of the most congested links .",
    "the slice of capacity available to each path is the smallest on the most congested links , that is , the ratio @xmath107 is the smallest on these links .",
    "a procedure to do this finds one link @xmath22 , with the smallest ratio @xmath99 and increases all path flows by @xmath99 .",
    "such procedure distributes parsimoniously the capacity of link @xmath22 among the paths that pass through the link , and increases all unsaturated path flows by @xmath99 .",
    "the procedure then fixes the path flows of the paths that cross links with capacity @xmath18 , and decreases the capacity of links crossed by these paths by the amount of flow fixed .",
    "this creates a residual network , on which the procedure is then repeated , such that path flows are saturated and the capacity available at the links they cross is updated at each iteration .",
    "the procedure is repeated until all paths in the network are saturated .",
    "such allocation is known as _ _",
    "max - min fair__@xcite , a name that comes from the way that path flows with minimum allocation are maximized by splitting equitably the capacity at the bottleneck links in an iterative process .",
    "the max - min fair allocation is such that to increase a path flow we have to decrease another path flow that is already smaller .",
    "the major limitation of the max - min fair method is that network throughput is low compared to max - flow . to understand the mechanism behind this",
    ", we have to look at how both max - min fair and max - flow allocate path flows .",
    "the efficient allocation ( max - flow ) privileges short , over long paths that pass through several bottleneck links .",
    "long paths take up capacity from other paths at each bottleneck , but only contribute to network throughput at the sink node .",
    "hence , network throughput is maximized by minimizing the share of capacity to the long paths that pass through many bottlenecks , so that shorter paths can get a higher allocation of capacity and thus provide a higher contribution to network throughput . on the other hand , the max - min fair allocation shares the capacity of bottlenecks among the paths that pass through them .",
    "thus , unlike max - flow , max - min fair allocations do not restrict the amount of network capacity that long paths can consume and are often inefficient .",
    "this limitation prompted the search for a trade - off between max - min fairness and max - flow , which would still distribute network capacity in an equitable way , and thus _ proportional fairness _ appeared in the late @xmath108s .",
    "both proportional fairness and max - min fairness share the capacity @xmath18 of a single link among @xmath109 paths in a fair way , so that each path gets a path flow of @xmath110 , but the two allocations are distinct when operating on a network .",
    "a vector of path flows @xmath111 is _ proportionally fair _ if it is feasible and if for any other feasible vector of path flows @xmath112 , the sum of proportional changes in the path flows is non - positive  @xcite : @xmath113    if there were no capacity constraints , equation  ( [ eq : proportional_fairness ] ) would be verified when @xmath114 for all @xmath115 .",
    "the capacity constraints imply that a flow allocation @xmath116 is proportionally fair if all other feasible vector of path flows @xmath117 , for @xmath118 where @xmath115 , verify that the aggregate of percent changes @xmath119 is non - positive .",
    "* proof . *",
    "the proof given here is a direct application of the properties of convex functions  @xcite and global maxima of a function ( a sketch of the proof is given in  @xcite ) .",
    "first , observe that the set of feasible path flows is compact ( closed and bounded ) and convex .",
    "the functions @xmath121 are strictly concave , and thus @xmath122 is strictly concave , since it is the sum of strictly concave functions .",
    "thus @xmath122 has a unique global maximum .",
    "second , note that the tangent plane at any point of a convex ( concave ) function lies below ( above ) the graph of the function .",
    "hence , since @xmath122 is concave : @xmath123 now assume that @xmath124 is a proportionally fair allocation",
    ". then , @xmath125 from equation  ( [ eq : proportional_fairness ] ) , and thus @xmath126 from equation  ( [ eq : concave_function ] ) for all other feasible @xmath127 .",
    "hence , @xmath124 is a global maximum of @xmath128 .",
    "conversely , assume that the function @xmath128 has one global maximum at @xmath129 .",
    "then , @xmath130 and thus the flow allocation is proportionally fair .",
    "@xmath131       * proof .",
    "* to see this , assume that there is one path @xmath23 that does not pass through any bottleneck .",
    "consider link @xmath133 on the path @xmath23 .",
    "the path flow @xmath134 can be increased by @xmath135 , such that the new vector of path flows is @xmath136 .",
    "hence , @xmath137 is not proportionally fair because @xmath138 , and the path flow @xmath134 can be increased .",
    "@xmath131           plot of the global network throughput in the present and future baseline scenarios when we apply the heuristic routing algorithm of equation  ( [ eq : link_weights ] ) .",
    "horizontal lines are a guide for the eye and show network throughput in the present and future baseline scenarios with shortest path routing .",
    "we choose the value @xmath29 that maximizes the global throughput.,scaledwidth=48.0% ]    now in order to find the proportionally fair allocation , we need to maximize @xmath122 , constrained to the vector of path flows being feasible , that is : @xmath139 where the link - path incidence matrix is defined by @xmath21 if the link @xmath22 belongs to the path @xmath23 and @xmath24 otherwise , and @xmath140 is the vector of link capacities .",
    "the aggregate utility @xmath122 is concave and the inequality constraints are convex , and hence the optimization problem  ( [ eq : primal ] ) is convex .",
    "thus , any locally optimal point is also a global optimum and we can use results from the theory of convex optimization to solve problem  ( [ eq : primal ] ) ( see  @xcite and  @xcite for a brief introduction to lagrange multipliers , and  @xcite on convex optimization ) .",
    "the lagrangian associated with the optimization problem  ( [ eq : primal ] ) is  @xcite : @xmath141 where @xmath142 is a vector of lagrange multipliers .",
    "the lagrange dual function  @xcite is then given by @xmath143 , which is easily determined analytically by @xmath144 as @xmath145 and thus @xmath146 after removing the constant term in equation  ( [ eq : lagrange_dual_final ] ) and converting to a maximization problem , we obtain the dual problem  @xcite @xmath147      the primal problem  ( [ eq : primal ] ) is convex and the inequality constraints are affine .",
    "hence , slater s condition is verified and thus strong duality holds .",
    "this means that the _ duality gap _",
    ", i.e. ,  the difference between the optimal of the primal problem  ( [ eq : primal ] ) and the optimal of the dual problem  ( [ eq : dual ] ) , is zero  @xcite .",
    "strong duality has potentially immense implications as , depending on the problem , it may be easier to solve the primal or the dual . in our case ,",
    "the primal objective function depends on @xmath25 variables ( the path flows ) and is constrained by an affine system of equations , whereas the dual objective function depends on @xmath148 variables ( the links ) and is constrained only by the condition that the lagrange multipliers are non - negative . taken together , the methods of convex optimization provide us with powerful tools to gain insights into patterns of congestion in networks where the number @xmath25 of transport routes can be considerably larger than the number @xmath148 of available transport links .",
    "strong duality then states that the optimal path flows @xmath116 are related to the optimal lagrange multipliers @xmath149 by equation  ( [ eq : lagrange_dual ] ) .",
    "since @xmath116 maximizes the lagrangian over @xmath150 , it follows that its gradient must vanish at @xmath116 , and thus the following _ kkt _ condition is satisfied : @xmath151 equation  ( [ eq : kkt_complementary_slackness ] ) , often referred to as _ complementary slackness _",
    "@xcite , states that the vector @xmath152 of the lagrange multipliers and the vector of residual capacity have complementary sparsity patterns . to be more specific , either link @xmath22",
    "is utilized to full capacity ( i.e. ,  @xmath153 ) and @xmath154 , or @xmath155 and the capacity of link @xmath22 is underused ( i.e. ,  @xmath156 ) .",
    "this gives us a simple and powerful way to identify bottleneck links numerically , as the links with a positive lagrange multiplier @xmath157 .",
    "[ [ a - centralized - algorithm - for - proportional - fairness - with - link - price ] ] a centralized algorithm for proportional fairness with link price ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    now suppose that the network operator charges a price per unit flow @xmath158 for the use of link @xmath22 , when the total load on the link is @xmath159 .",
    "this means that the price at one link depends on all the paths that pass through the link  @xcite .",
    "hence , the problem  ( [ eq : primal ] ) can be generalized by adding a cost or penalty that is a function of the price  @xcite .",
    "if the penalty is infinite when the link capacity is exceeded , @xmath160 , then we can generalize problem  ( [ eq : primal ] ) to replace the capacity constraints by the link cost , such that @xmath161    to derive the dual of problem  ( [ eq : primal_star ] ) , we first find its lagrange dual @xmath162 to simplify equation  ( [ eq : network*_lagrange_dual_long ] ) , we integrate by parts and then by substitution , @xmath163 where @xmath56 is the inverse of @xmath57 . following  @xcite , we now remove the constant term in equation  ( [ eq : network*_lagrange_dual ] ) and covert to a maximization problem to obtain the dual of problem  ( [ eq : primal_star ] ) : @xmath164    the dual problem  ( [ eq : dual * ] ) is equivalent to the original dual problem  ( [ eq : dual ] ) if @xmath165 .",
    "however , this function is non - invertible and thus we approximate it by the invertible function  @xcite @xmath166 problems  ( [ eq : dual * ] ) and ( [ eq : dual ] ) are thus equivalent in the limit @xmath167 .",
    "the primal problems  ( [ eq : primal ] ) and ( [ eq : primal_star ] ) are equivalent in the limit @xmath167 if @xmath168      the key to a decentralized algorithm for proportional fairness is to translate the problem  ( [ eq : primal_star ] ) into an autonomous system of coupled differential equation , with a fixed point equivalent to the optimal solution of the optimization problem . to do this , we use the result that the stable fixed point of a system of differential equations is the maximum of the equations lyapunov function    for each path @xmath23 , the network is offering a certain path flow @xmath134 with unit rate of change , @xmath169 .",
    "now suppose that the network operator charges a price per unit flow @xmath158 for the use of link @xmath22 , when the total load on the link is @xmath159 .",
    "this means that the price at one link depends on all the paths that pass through the link .",
    "the price causes a reduction in the path flow @xmath134 , such that @xmath170 where the price on link @xmath22 is @xmath171 user @xmath22 responds to an underused capacity with a steady increase of its path flow , and to congestion with a multiplicative decrease of its path flow at a rate proportional to the congestion price .",
    "this additive - increase / multiplicative - decrease mechanism is best known for its use in communication networks , and is implemented in tcp congestion avoidance  @xcite .",
    "a possible pricing policy consists in charging only for link flows that are close to capacity , with a sharp increase in the price that each path pays as the link becomes saturated : @xmath172 as @xmath167 , the price @xmath173 tends to zero for link flows below capacity , and to infinity for saturated links .",
    "hence , problem  ( [ eq : primal_star ] ) approximates arbitrarily closely the primal problem  ( [ eq : primal ] ) ."
  ],
  "abstract_text": [
    "<S> human conflict , geopolitical crises , terrorist attacks , and natural disasters can turn large parts of energy distribution networks offline . </S>",
    "<S> europe s current gas supply network is largely dependent on deliveries from russia and north africa , creating vulnerabilities to social and political instabilities . during crises , less </S>",
    "<S> delivery may mean greater congestion , as the pipeline network is used in ways it has not been designed for . </S>",
    "<S> given the importance of the security of natural gas supply , we develop a model to handle network congestion on various geographical scales . we offer a resilient response strategy to energy shortages and quantify its effectiveness for a variety of relevant scenarios . </S>",
    "<S> in essence , europe s gas supply can be made robust even to major supply disruptions , if a fair distribution strategy is applied .    </S>",
    "<S> almost everything we do in the course of a day involves the use of energy . </S>",
    "<S> yet , history has taught us that the threats to the security of supply come in unexpected ways  @xcite . </S>",
    "<S> examples of unforeseen energy crises include the recent disputes between russia and ukraine over the price of natural gas ( @xmath0@xmath1 , @xmath2@xmath3 , @xmath3@xmath4 )  @xcite , the disruption of the oil and gas production industry in the us following hurricanes katrina and rita ( @xmath0 )  @xcite , the terrorist attack on the amenas gas plant that affected more than @xmath5 of algerian production of natural gas ( @xmath6 )  @xcite , and the supply shortage in march @xmath6 , when the uk had only @xmath7 hours worth of gas left in storage as a buffer  @xcite . </S>",
    "<S> new vulnerabilities could come from cyber attacks to the infrastructure  @xcite , particularly in the case of state - driven attacks  @xcite ; be the result of prolonged uncertainty or inaction on energy security in the us or europe  @xcite ; or derive from an extended period of extremely volatile prices due to intense international conflict  @xcite .    </S>",
    "<S> natural gas , a fossil fuel that accounts for @xmath8 of energy consumption in oecd - europe  @xcite , has been at the heart of these crises . </S>",
    "<S> gas is expensive to transport , and this is done mainly over a pipeline network . </S>",
    "<S> the investments are large and are made with long - term horizons , often of decades , and the costs are covered by locking buyers into long - term contracts  @xcite . moreover , </S>",
    "<S> current infrastructure investments in europe still derive from a historical dependency on supply from russia and north africa  @xcite . </S>",
    "<S> this dependency leaves the european continent exposed to both a pipeline network that was not designed to transport large quantities of gas imported via liquefied natural gas ( lng ) terminals , and to the effects of political and social instabilities in countries that are heavily dependent either on the export of natural gas ( e.g. ,  algeria , libya , qatar or russia ) or its transit ( e.g. ,  ukraine ) . </S>",
    "<S> hence , it is challenging to build infrastructure that will be resilient to a wide range of possible crisis scenarios  @xcite .    in a crisis , </S>",
    "<S> less delivery may mean greater congestion . </S>",
    "<S> this is due to the breakdown of major transit routes or production losses in affected areas , which cause the supply network to be used in different ways from what it was designed for . </S>",
    "<S> hence , the available resources can not be distributed well with the remaining transport capacities  @xcite  @xcite . </S>",
    "<S> this is why we need a method to handle congestion .     </S>",
    "<S> spatial data layers involved in our analysis : population density ( landscan 2012 ) ; gas pipeline network and liquefied natural gas ( lng ) terminals ( platts 2011 ) ; and major urban areas ( european environment agency and natural earth).,scaledwidth=45.0% ]    to manage the gas pipeline network during crises , we propose a decentralized model of congestion control that distributes the available network capacity to each route , without sacrificing network throughput  @xcite . </S>",
    "<S> a central controller makes the system vulnerable both to attacks on the control centre and to delays and failures of the lines of communication through the network  @xcite . </S>",
    "<S> in contrast , a decentralized method is more resilient to failures because damage to the network has only a local effect and the need for communication is reduced . to illustrate our model , we analyse the throughput of the present and planned pipeline networks across a range of different crisis scenarios at european , country and urban levels . </S>",
    "<S> the most challenging scenario corresponds to a hypothetical crisis with russia with a complete cut - off of supply to europe . </S>",
    "<S> we analyse how to alleviate the impact of such scenarios , by the identification of country groups with similar interests , which should cooperate closely to manage congestion on the network . </S>",
    "<S> this acknowledges that many of the @xmath9st century challenges , such as the management of energy grids and infrastructure networks  @xcite , can not be solved by technology alone , but do have a relevant behavioural or social component  @xcite . </S>"
  ]
}