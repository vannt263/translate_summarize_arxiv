{
  "article_text": [
    "for more 50 years , traffic flow has been a subject of intense research effort  @xcite . while earlier studies were mostly conducted by traffic engineers , in the last decade",
    "the traffic flow problem has received great attention from the physics community as well , largely due to the seminal works  @xcite in the early 90s , which demonstrated that traffic flow can be regarded as a driven nonequilibrium system .",
    "there are empirical indications of multiple dynamic phases in the traffic flow and dynamic phase transitions  .",
    "several theoretical explanations   for the empirical results were suggested . also physical phenomena such as self - organized criticality and hysteresis",
    "@xcite were revealed .",
    "numerous traffic models have been investigated ( see refs .",
    "@xcite for recent reviews ) in relation to empirical data , and considerable progress has been achieved toward an understanding of various traffic phenomena observed empirically .",
    "depending on the mathematical formulation used , traffic models may be categorized into one of the following types : car - following models , particle - hopping models , coupled - map lattice models , gas - kinetic models , and fluid - dynamic models .",
    "the first three types use a microscopic approach while the last type uses a macroscopic one .",
    "the approach used in the gas - kinetic models is intermediate and may be called mesoscopic .    recently it was suggested  @xcite that different types of traffic models may belong to the same `` universality '' class in the sense that they share qualitatively similar properties .",
    "more recently , a nonlocal fluid - dynamic model was derived from a gas - kinetic model  @xcite .",
    "these reports motivate further studies on mutual relationship between different types of traffic models .    in this paper",
    ", we address the relationship between microscopic car - following models and macroscopic fluid - dynamic models .",
    "specifically we use a coarse - graining procedure ( sec .  [ formulation ] ) to derive a macroscopic model ( sec .",
    "[ optimal ] ) from the microscopic optimal velocity model , a particular case of the car - following - type model .",
    "the resulting macroscopic model consists of the continuity equation [ eq .",
    "( [ vehicleconservation ] ) ] and a momentum equation [ eq .  ( [ velocitytotalderiv_final ] ) ] .",
    "the momentum equation contains a relaxation term , a density gradient term , and a diffusion term , similar to the fluid - dynamic model proposed in ref .",
    "it is shown that both the density gradient term and the diffusion term arise from a _ directed _ influence due to the breakdown of the balanced action - reaction .",
    "this is contrary to heuristic derivations  @xcite , in which the density gradient term is attributed to the velocity variance .",
    "it also provides an origin of the diffusion term assumed in many fluid - dynamic models . in sec .",
    "[ extension ] , the derivation is extended to general car - following - type models . in sec .",
    "[ numerical ] , the macroscopic model derived from the microscopic optimal velocity model is examined numerically in comparison with the optimal velocity model .",
    "section  [ discussion ] concludes the paper .",
    "some technical details are presented in appendixes  [ nonlinear ] , [ linear_regime ] , and [ differences ] .",
    "we remark that a different scheme to construct macroscopic models from microscopic car - following models was proposed recently  @xcite . the macroscopic fields @xmath0 and @xmath1",
    "are defined via an interpolation procedure instead of a coarse - graining procedure .",
    "the resulting momentum equation is _ nonlocal _ , while our momentum equation is local .",
    "also @xmath0 and @xmath1 defined in such a way do not strictly satisfy continuity equation  ( [ vehicleconservation ] ) , while the continuity equation is an exact identity in the coarse - graining - based scheme .",
    "in order to derive macroscopic traffic equations from microscopic ones , we first introduce two microscopic field variables , density field @xmath2 and flux field @xmath3 , @xmath4 where @xmath5 is the coordinate of the @xmath6th vehicle at time @xmath7 with @xmath8  . when traffic dynamics does not depend on third or higher order time derivatives of @xmath5",
    ", these two fields specify the status of traffic flow completely .    a natural way to obtain macroscopic description is to coarse grain these fields . we introduce a coarse graining envelope function @xmath9 which is non - negative valued , peaked at @xmath10 , and normalized as @xmath11 .",
    "the coarse grained density @xmath12 and flux @xmath13 can be defined as @xmath14 these two coarse grained fields specify the _ macroscopic _ status of traffic flow .",
    "next we derive equations that govern the time evolution of @xmath12 and @xmath13 . for the evolution of @xmath12 ,",
    "one finds @xmath15 which describes the local conservation of vehicles in the coarse - grained description .",
    "this equation can be verified from eq .",
    "( [ rhoandq ] ) using integration by parts and change of variables .",
    "derivation of the dynamic equation for @xmath13 is less straightforward .",
    "after some algebra , one obtains @xmath16 ,     \\label{roundqroundt}\\ ] ] where the bracketed average of a quantity @xmath17 is defined as follows ; @xmath18 note that @xmath19 , @xmath20 , and @xmath6 inside the brackets are dummy variables , while the label @xmath21 in the subscript of the bracket notation represents a spatiotemporal position where the average is evaluated .",
    "this label will be omitted in the rest of the paper when its omission does not cause confusion .",
    "here it is useful to introduce another macroscopic field @xmath22 , @xmath23 which represents some kind of macroscopic velocity , whose precise meaning depends on @xmath9 .",
    "two particular coarse graining schemes are good for illustration : spatial coarse graining @xmath24 and temporal coarse graining @xmath25 , where @xmath26 is the step function which is one for @xmath27 and zero for @xmath28 . for the spatial coarse graining , @xmath22 becomes @xmath29 where the primed summation runs over the vehicles in the range @xmath30 at time @xmath7 .",
    "the denominator is equal to the total number of vehicles within the range and thus @xmath22 represents the _ arithmetic mean velocity_. for the temporal coarse graining , on the other hand , it can be verified that @xmath31^{-1 }   \\over \\sum'_n 1}\\ , , \\ ] ] where the primed summation now runs over the vehicles that reach the point @xmath32 within the time interval @xmath33 , and @xmath34 represents the time at which the @xmath6th vehicle reaches the position @xmath32 . here",
    "@xmath35 is assumed .",
    "thus @xmath22 represents the _ harmonic mean velocity _ measured at local detectors .",
    "it is straightforward to rewrite eq .",
    "( [ vehicleconservation ] ) in terms of @xmath0 and @xmath1 instead of @xmath0 and @xmath36 . also expressing eq .",
    "( [ roundqroundt ] ) in terms of @xmath0 and @xmath1 , one obtains @xmath37 where @xmath38 measures the degree of microscopic velocity variation .",
    "note that the left - hand side of eq .",
    "( [ velocitytotalderivative ] ) corresponds to the total derivative @xmath39 .",
    "thus the two terms on the right - hand side can be interpreted as macroscopic force densities .",
    "the first term corresponds to the coarse - grained average of microscopic `` forces '' that act on each vehicle .",
    "the second term , on the other hand , arises from the coarse graining itself . in equilibrium systems",
    ", @xmath40 is proportional to the local temperature , and the second term represents the force due to thermal gradient .    the remaining job is to express the force terms in terms of @xmath0 and @xmath1 .",
    "however , it is well known that a rigorous treatment of the force terms generates an infinite sequence of dynamic equations .",
    "thus we instead develop approximations of the force terms in sec .",
    "[ optimal ] , so that eqs .",
    "( [ vehicleconservation ] ) and ( [ velocitytotalderivative ] ) form a closed set of equations .",
    "this scheme is partly motivated by the absence of empirical indication that the dynamics of the forces is important .",
    "a procedure to derive a macroscopic model is illustrated for the optimal velocity model in sec .",
    "[ optimal ] and for general car - following models in sec .",
    "[ extension ] . in both sections ,",
    "traffic states are assumed to be almost homogeneous . in this linear regime ,",
    "products of differentiated quantities such as @xmath41 become progressively smaller as @xmath42 increases , where @xmath43 are integers and @xmath44 are arbitrary functions of @xmath0 and @xmath1 .",
    "therefore , it is sufficient to retain terms with @xmath45 or @xmath46 only , which simplifies the construction of a macroscopic description considerably . in this sense , terms with @xmath45 or @xmath46 can be called _ linearly relevant _ terms , and terms with @xmath47 _",
    "linearly irrelevant _ terms .",
    "properties in the linear regime such as the dispersion relation for small amplitude waves depend on linearly relevant terms only",
    ". effects of the linearly irrelevant terms with @xmath48 are discussed in appendix  [ nonlinear ] .",
    "we first study the optimal velocity model  @xcite @xmath49 ,     \\label{optimalvelocitymodel}\\ ] ] where the constant @xmath50 represents a driver s sensitivity and @xmath51 is the coordinate difference between the vehicle @xmath6 and its preceding vehicle @xmath52 .",
    "@xmath53 is the optimal velocity to which drivers want to adjust their speed .",
    "an example is @xmath54 used by bando _ et al_.  @xcite . here",
    "we will assume neither a particular functional form for @xmath53 nor a particular value for @xmath50  @xcite .",
    "the coarse graining of eq .",
    "( [ optimalvelocitymodel ] ) leads to @xmath55 . \\label{averageforce}\\ ] ] the expansion of @xmath56 with respect to @xmath57 gives @xmath58 where @xmath59 is the term that is proportional to @xmath60 . here",
    "@xmath61 is absent since @xmath62 .",
    "note that the leading correction @xmath63 compensates for the difference @xmath64 , which is positive ( negative ) when @xmath65 is a convex ( concave ) function . in the linear regime , however , all corrections @xmath59 ( @xmath66 ) can be ignored .",
    "moreover it can be shown that the second term on the right - hand side of eq .",
    "( [ velocitytotalderivative ] ) is also negligible in the linear regime ( see appendix  [ linear_regime ] ) .",
    "therefore , the derivation of a macroscopic description in the linear regime is reduced to developing a proper approximation of @xmath67 .",
    "a naive approximation of @xmath68 is @xmath69 .",
    "however , this seemingly reasonable approximation has a serious problem . for illustration , it is useful to introduce an unphysical model by replacing @xmath70 in eq .",
    "( [ optimalvelocitymodel ] ) with @xmath71 , so that each vehicle responds to the vehicle _ behind _ it rather than the vehicle _ ahead _ of it . this unphysical model , which differs from the physical one only by the directionality of the influence , has qualitatively different properties .",
    "thus proper macroscopic descriptions should contain information about the directionality , while a naive approximation fails to capture this information .    to take the directionality into account ,",
    "an intuitive prescription was proposed  @xcite without a rigorous justification , @xmath72 which amounts to evaluating the density at the midpoint between two vehicles @xmath6 and @xmath52 . for the above unphysical model , this prescription results in an expression which is similar to eq .",
    "( [ midpointapproximation ] ) but has a negative sign in front of @xmath73 .",
    "thus this prescription contains information about the directionality .    in the linear regime",
    ", we find that a controlled approximation of @xmath57 can be obtained in a rigorous way ( see appendix  [ differences ] ) .",
    "the result is @xmath74 where @xmath75 represents the sum of all terms with second or higher order derivatives .",
    "note that eq .",
    "( [ distanceexpansion ] ) agrees with the taylor expansion of the heuristic approximation [ eq .  ( [ midpointapproximation ] ) ] , up to the first order derivative correction to @xmath76 .",
    "the deviation occurs in the second order derivative . while the second order derivative in the taylor expansion of eq .",
    "( [ midpointapproximation ] ) comes with the coefficient @xmath77 , a rigorous calculation leads to the coefficient @xmath78 ( see appendix  [ differences ] ) : @xmath79    thus the leading term in eq .",
    "( [ optimalvelocityexpansion ] ) can be expanded as @xmath80 + \\sigma_{\\rm ir } ,     \\label{optimalvelocityfisrtorderapprox_}\\ ] ] where @xmath81 denotes the sum of linearly irrelevant terms . by combining eqs .",
    "( [ velocitytotalderivative ] ) , ( [ averageforce ] ) , ( [ optimalvelocityexpansion ] ) , and ( [ optimalvelocityfisrtorderapprox _ ] ) , one obtains @xmath82     + { \\lambda \\over{2\\rho}}v_{\\rm op}^\\prime\\left(\\rho^{-1}\\right )           { { \\partial { \\rho^{-1}}}\\over{\\partial x } }    \\nonumber \\\\   & + & \\lambda v_{\\rm op}'\\left(\\rho^{-1}\\right)\\sigma .",
    "\\label{velocitytotalderiv_approx _ }   \\end{aligned}\\ ] ] note that the second term proportional to the density gradient arises from the directed influence , while conventional derivations of fluid - dynamic models  @xcite attribute the density gradient term to the velocity variance term in eq .",
    "( [ velocitytotalderivative ] ) .",
    "we will call the second term the anticipation term .",
    "the first term is often called the relaxation term .    it is interesting to compare the dispersion relations of microscopic and macroscopic models . in a microscopic description , small perturbations with respect to the homogeneous state can be written as @xmath83 where @xmath84 . by linearizing eq .",
    "( [ optimalvelocitymodel ] ) , one obtains the dispersion relation @xmath85 .",
    "\\label{mic_dispersion}\\ ] ] on the other hand , small perturbations in the macroscopic description can be written as @xmath86 where @xmath87 is the macroscopic counterpart of @xmath88 since both represent the phase difference between two successive vehicles , and @xmath89 is the macroscopic counterpart of @xmath90 .",
    "to see the origin of the additional term @xmath91 , note that @xmath90 is the frequency measured in the _ moving _ reference frame with the velocity @xmath92 , while @xmath93 is the frequency measured in the stationary frame . by linearizing eqs .",
    "( [ vehicleconservation ] ) and ( [ velocitytotalderiv_approx _ ] ) , one finds @xmath94 ,     \\label{mac_dispersion}\\ ] ] where @xmath95 when the last term in eq .",
    "( [ velocitytotalderiv_approx _ ] ) proportional to @xmath75 is ignored and @xmath96 when the leading contribution to @xmath75 in eq .",
    "( [ sigmaexpansion ] ) is included .",
    "note that @xmath97 agrees with the taylor expansion of the factor @xmath98 in eq .",
    "( [ mic_dispersion ] ) .",
    "thus it is clear that the macroscopic momentum equation  ( [ velocitytotalderiv_approx _ ] ) , combined with the continuity equation  ( [ vehicleconservation ] ) , gives a correct description of the long wavelength behavior of the microscopic model [ eq .",
    "( [ optimalvelocitymodel ] ) ] in the linear regime .      despite the excellent agreement of the long wavelength components , it is premature to accept eq .",
    "( [ velocitytotalderiv_approx _ ] ) as a macroscopic momentum equation since naive treatments of @xmath75 introduce an artificial instability , which is absent in the microscopic model [ eq .  ( [ optimalvelocitymodel ] ) ]",
    "for demonstration , we examine the linear instability criteria . in the microscopic model , from eq .",
    "( [ mic_dispersion ] ) one obtains that small fluctuations of the mode @xmath88 become linearly unstable when @xmath99 note that the @xmath100 mode shows the strongest instability and at the critical density where the instability first sets in , only an infinite wavelength mode becomes unstable .",
    "in contrast , naive macroscopic models give different results .",
    "when @xmath75 is ignored completely , eqs .",
    "( [ mac_dispersion ] ) and ( [ a_exp1 ] ) result in a linear instability criterion @xmath101 for mode @xmath102 .",
    "note that this inequality does not contain @xmath102 .",
    "thus as soon as @xmath103 satisfies this inequality , fluctuations of _ all _ wavelengths become unstable simultaneously , different from the behavior in the microscopic description . on the other hand ,",
    "when the leading contribution to @xmath75 in eq .",
    "( [ sigmaexpansion ] ) is retained , eqs .",
    "( [ mac_dispersion ] ) and ( [ a_exp2 ] ) result in @xmath104^{-2}$ ] .",
    "note that the right - hand side vanishes as @xmath105 and thus the homogeneous state is _ always _ unstable with respect to fluctuations with small wavelengths .",
    "this _ artificial _ instability can not be cured by merely using higher order approximations of @xmath75 .",
    "for example , if we assume that the next order contribution to @xmath75 is @xmath106 , which generates the correct next order in @xmath97 , one obtains the linear instability criterion @xmath107/ [ 1-(k\\rho_h^{-1})^2/6]^2 $ ] , which again shows an artificial instability for the short wavelength components .    to find the origin of the failure , it is useful to analyze the microscopic dispersion relation [ eq .",
    "( [ mic_dispersion ] ) ] since the approximations of @xmath75 are equivalent to truncating the series @xmath108 at a certain order .",
    "it can be verified that when the series is truncated at a _",
    "finite _ order , highest order terms dominate the physics for large @xmath88 and generate the artificial instability for large @xmath88 @xmath109 modes , while such instabilities are absent when the series is summed up to the _ infinite _ order .",
    "thus it is clear that truncation at a _",
    "finite _ order is responsible for the artificial instability .    in this subsection",
    ", we aim to develop an approximation of @xmath75 , which is compact but still captures important features of the exact @xmath75 .",
    "a key observation is that modes with @xmath110 are _ unphysical _ since fluctuations on length scales shorter than the vehicle spacing are not defined in the original microscopic model .",
    "motivated by this observation , we transform the leading order term of @xmath75 in eq .",
    "( [ sigmaexpansion ] ) in such a way that it preserves the same long wavelength behavior but suppresses fluctuations in short wavelength components with @xmath111 .",
    "to implement this idea , one first notes that eq .",
    "( [ vehicleconservation ] ) relates small fluctuations of @xmath0 and @xmath1 as follows : @xmath112",
    "one then exploits the correspondence between @xmath89 and @xmath90 , and between @xmath87 and @xmath88 . from the result @xmath113 for small @xmath88 , one obtains @xmath114 in this derivation , the @xmath115 mode is ignored since it always decays with time .",
    "note that the resulting relation amounts to a variational form of @xmath116 that can be regarded as the zeroth order approximation when @xmath117 .",
    "its first or higher order corrections will be ignored since they introduce third or higher order derivatives to the new approximation of @xmath75 [ eq .  ( [ diffusion ] ) ] . this way , we construct an approximation @xmath118 the momentum equation becomes @xmath119         - { { \\lambda v_{\\rm op } ' } \\over{2\\rho^3 } }            { { \\partial \\rho}\\over{\\partial x } }        +   { \\lambda \\over{6\\rho^2 } }                  { { \\partial^2 v}\\over{{\\partial x}^2}}\\ , .     \\label{velocitytotalderiv_final}\\ ] ] note that our approximation of @xmath75 results in a _ diffusion _ term , which tends to suppress short wavelength fluctuations .",
    "indeed , the linear instability criterion from eqs .",
    "( [ vehicleconservation ] ) and ( [ velocitytotalderiv_final ] ) becomes @xmath120 , which confirms the suppression of modes with @xmath111 .",
    "in addition , it can be verified that the macroscopic and microscopic dispersion relations agree up to order @xmath121 .",
    "thus we conclude that eq .",
    "( [ velocitytotalderiv_final ] ) is a satisfactory macroscopic momentum equation in the linear regime .    finally , we remark for completeness that eq .",
    "( [ velocitytotalderiv_final ] ) _ can not _ be used to study _",
    "backward _ time evolution .",
    "this restriction arises from the neglect of the @xmath115 mode , whose magnitude does _ grow _ in the backward time evolution .",
    "in this section , we extend the derivation in sec .  [ optimal ] to general car - following models .",
    "when third or higher order time derivatives do not appear in microscopic traffic equations , a general car - following equation with the galilean invariance can be written as @xmath122 coarse graining leads to @xmath123 where @xmath67 can be approximated by eqs .",
    "( [ distanceexpansion ] ) and ( [ sigmaexpansion ] ) , and @xmath124 see appendix  [ differences ] for a derivation of eq .",
    "( [ delta_dot_y ] ) .",
    "we further expand @xmath125 as @xmath126 where @xmath127 . in real traffic systems , @xmath128 and @xmath129",
    "are expected to be positive while @xmath130 is expected to be negative .",
    "cross - terms proportional to @xmath131 are ignored since they are linearly irrelevant .",
    "the macroscopic momentum equation then becomes @xmath132 note that the dependence of @xmath133 on @xmath134 gives rise to an explicit diffusion term .    despite the explicit diffusion term",
    ", the artificial instability at short wavelength components may still arise when @xmath128 is sufficiently large since the term proportional to @xmath135 tends to generate the artificial instability , as demonstrated in sec .",
    "[ optimal ] .",
    "thus we follow the procedure in sec .  [ optimal ]",
    "b to obtain @xmath136 which is a generalization of eq .",
    "( [ diffusion ] ) .",
    "the resulting momentum equation is @xmath137 note that the factor @xmath138 in front of the diffusion term is manifestly positive .",
    "this equation is free from the artificial instability .    to elucidate the relation with eq .",
    "( [ velocitytotalderiv_final ] ) , it is useful to define an effective optimal velocity @xmath139 in an implicit way as a solution of @xmath140 when @xmath141 for all @xmath1 , the solution is unique and there is no ambiguity in @xmath139 .",
    "one also defines @xmath142 which is positive for all @xmath0 and @xmath1 if @xmath141 always .",
    "thus the first term in eq .",
    "( [ gen_eq_of_motion2 ] ) can be interpreted as a generalized relaxation term : @xmath143 .",
    "\\nonumber\\ ] ]    in certain situations , the third term in eq .",
    "( [ gen_eq_of_motion2 ] ) can be transformed into a familiar form .",
    "one applies the procedure in sec .",
    "[ optimal ] b to the term , and uses the relation @xmath144 , where @xmath145 .",
    "thus we obtain @xmath146 where third or higher order derivatives are neglected . on the other hand , the second order derivative should be kept since it renormalizes the diffusion term .",
    "the macroscopic equation of motion then becomes @xmath147         - { \\nu a_{\\rm op,1 }   \\over 2\\rho^3 }         { { \\partial \\rho}\\over{\\partial x } }     - { \\mu a_{\\rm op,3 } \\over 6\\rho^2 }       { { \\partial^2 v}\\over{\\partial x^2}}\\ , ,     \\label{dvdt - ef2}\\ ] ] where @xmath148 and @xmath149 .",
    "note that three force density terms in eq .",
    "( [ dvdt - ef2 ] ) are in one - to - one correspondence with those in eq .",
    "( [ velocitytotalderiv_final ] ) .",
    "moreover the corresponding terms in the two equations usually have the same sign since @xmath150 is positive and @xmath130 is negative .",
    "however when @xmath151 in eq .",
    "( [ g - trs2 ] ) is a sufficiently large negative number , @xmath152 in the diffusion term in eq .",
    "( [ dvdt - ef2 ] ) becomes negative , and an artificial instability at short wavelength components arises . thus eq .",
    "( [ dvdt - ef2 ] ) can be used only when @xmath152 is positive while eq .",
    "( [ gen_eq_of_motion2 ] ) can be used in general situations .",
    "in this section , we compare numerically the properties of the microscopic optimal velocity model  [ eq .",
    "( [ optimalvelocitymodel ] ) ] and the macroscopic model [ eqs .",
    "( [ vehicleconservation ] ) and ( [ velocitytotalderiv_final ] ) ] derived from it . for definiteness , we use @xmath153,\\ ] ] with @xmath154  m / s , @xmath155  m , @xmath156  m , @xmath157 , and @xmath158 as in ref .",
    "a system size @xmath159 km is simulated with @xmath160 vehicles ( @xmath161 ) , and the following microscopic initial conditions are used : @xmath162 the corresponding macroscopic initial condition is prepared by coarse graining the microscopic initial condition [ see eqs .",
    "( [ rhoandq ] ) and ( [ velocity ] ) ] with the spatial coarse graining function @xmath163 , where we choose @xmath164 .",
    "the periodic boundary condition is imposed for both the microscopic and macroscopic systems .",
    "we first verify that the density range @xmath165 , in which the homogeneous traffic state becomes unstable with respect to infinitesimal perturbations , is essentially identical for the microscopic and macroscopic models .",
    "this implies that , in the linear regime , the macroscopic model describes the long wavelength behavior of the microscopic model very accurately .    to quantify the accuracy of the macroscopic model ,",
    "we introduce the space - averaged relative deviation @xmath166 , which is defined by @xmath167 ^ 2 \\rangle_{\\rm space } } \\over   \\langle v_{\\rm micro}(x , t ) \\rangle_{\\rm space } } , \\ ] ] where @xmath168 represents the spatial average . here",
    "@xmath169 is calculated from the macroscopic model , while @xmath170 is obtained by coarse graining the microscopic configuration at the time @xmath7 .",
    "when the initial perturbation from homogeneous flow is small , say @xmath171 , we find that @xmath166 is negligible for all density outside the linearly unstable density range . a typical velocity profile is shown in fig .",
    "[ stable - profile ] .",
    "note that the macroscopic profiles are almost indistinguishable from the microscopic ones .",
    "even when @xmath172 , which corresponds to a density slightly below ( above ) the lower ( upper ) critical density @xmath173 ( numerically obtained critical densities are nearly the same as analytic ones ) , @xmath166 remains @xmath174 during several hours of simulation time .",
    "the accuracy in the linearly unstable density range is also examined for @xmath171 and @xmath175 , which is the smallest @xmath160 that demonstrates the linear instability .",
    "the microscopic simulation shows that the initially smooth profile becomes `` rough '' as short wavelength fluctuations develop .",
    "an almost identical roughening is found in the macroscopic simulation , and @xmath166 is almost negligible initially [ fig .  [ ita - fg1](a ) ] .",
    "however , the growth rate of the short wavelength fluctuations is faster in the microscopic simulation compared to the macroscopic simulation .",
    "this difference is responsible for the rapid growth of @xmath166 near @xmath176 .",
    "the growth of @xmath166 occurs at an earlier time for the density with stronger linear instability . both in microscopic and macroscopic simulations , after a sufficient time interval ( @xmath177 ) all short wavelength fluctuations merge into a single large traffic jam , which moves backward at a constant speed without further evolution in its shape .",
    "thus this jam corresponds to the final steady state .",
    "figure  [ ita - fg1](b ) compares the velocity profiles of the jams from the microscopic and macroscopic simulations .",
    "the velocity of the jam propagation speed is different and the locations of the jams coincide periodically in time , resulting in the periodic dips in fig .",
    "[ ita - fg1](a ) .",
    "next we choose @xmath178 in eq .",
    "( [ ini - cdn ] ) , and examine the performance of the macroscopic model for large perturbations .",
    "figure [ dst_rgn](a ) shows the initial density profile . after a sufficiently long time",
    ", the initial condition may evolve to a homogeneous state or to a congested state .",
    "the evolution to a congested state is realized for @xmath179 when the microscopic model is used and for @xmath180 when the macroscopic model is used .",
    "thus the lower critical density is in good agreement while the upper critical density shows about 6% deviation .",
    "the comparison with the linear critical densities shows that both microscopic and macroscopic models exhibit _ metastability _ , which implies the hysteresis phenomena in the metastable density range . the phase diagram in fig .",
    "[ dst_rgn](b ) summarizes the result .",
    "note that the microscopic metastable regions are wider .",
    "we also investigate the dependence of the critical density on @xmath50 for fixed @xmath181 m. it is convenient to introduce a dimensionless parameter @xmath182 , which is about @xmath183 for @xmath184 .",
    "figure  [ vg - ld](a ) shows the relative deviations of the macroscopic critical densities with respect to the microscopic ones . for the lower critical density ,",
    "the macroscopic result is in good agreement with the microscopic one for general @xmath185 .",
    "for the upper critical density , on the other hand , the deviation of about 6% at @xmath186 shrinks with the increase of @xmath185 and good agreement is achieved near @xmath187 .",
    "thus the difference between the microscopic and macroscopic metastable regions in fig .",
    "[ dst_rgn](b ) shrinks as @xmath188 .",
    "the velocity @xmath189 of a backward propagating traffic jam cluster ( @xmath190 ) is also investigated .",
    "since @xmath191 is almost independent of @xmath160 , we fix @xmath192 ( @xmath193 ) for simplicity , and examine @xmath191 as a function of @xmath185 .",
    "figure  [ vg - ld](b ) ( diamonds ) shows the ratio between the microscopic value @xmath194 and the macroscopic value @xmath195 .",
    "note that @xmath196 when @xmath185 is close to 2 .",
    "this agreement is notable considering that the macroscopic model does not have any free parameter which can be varied to enhance the agreement .",
    "the agreement , however , becomes less satisfactory as @xmath185 becomes smaller .",
    "a crude understanding for the good agreement near @xmath187 can be achieved via the linear analysis , although the given initial condition is not in the linear regime . for the general optimal velocity model , the linear instability develops when",
    "@xmath197 ; here we introduce @xmath198 .",
    "this inequality sets an upper limit @xmath199 , above which the instability does not appear .",
    "note that @xmath199 shrinks to zero as @xmath200 approaches @xmath201 , which is @xmath46 .",
    "thus the characteristic length scale of the instability becomes longer as @xmath202 .",
    "this may explain the excellent agreement near @xmath187 , since the macroscopic model becomes more precise as the characteristic length scale grows .    from these comparisons ,",
    "we conclude that the macroscopic model  [ eqs .",
    "( [ vehicleconservation ] ) and ( [ velocitytotalderiv_final ] ) ] is quite accurate in the linear regime , and provides a reasonable description of fully developed jam clusters in the nonlinear regime , although there are deviations in the quantitative level .",
    "but when short length scale dynamics plays an important role , for example when the avalanchelike growth of many small clusters occurs , the macroscopic model is not satisfactory .    to construct more accurate macroscopic models",
    ", one needs to take into account effects of various terms ignored in the macroscopic momentum equation derivation .",
    "as a first trial , we extend the derivation to the nonlinear regime by including effects of all terms proportional to @xmath203 , @xmath204 , and @xmath205 ( see appendix  [ nonlinear ] ) .",
    "the resulting equation  ( [ nonlinear_dvdt_optimal_2 ] ) for the same optimal velocity model is examined . as expected , the linearly unstable density region is identical to that by eq .",
    "( [ velocitytotalderiv_final ] ) .",
    "however , the ratio @xmath206 deviates further from one [ circles in fig .",
    "[ vg - ld](b ) ] .",
    "thus it appears that naive inclusion of linearly irrelevant terms does not improve the accuracy .",
    "a local macroscopic fluid - dynamic model is derived from a microscopic car - following model , which establishes the link between the two types of traffic models .",
    "it is emphasized that the directed influence due to the breakdown of the balanced action - reaction is an important ingredient . for the optimal velocity model ,",
    "the corresponding macroscopic momentum equation consists of a relaxation term , an anticipation term ( proportional to the density gradient ) , and a diffusion term .",
    "thus it has a structure similar to the fluid - dynamic model in ref .",
    "however , the density gradient term is found to arise from the directed influence rather than the velocity variance .",
    "it is demonstrated that the diffusion term also arises from the directed influence .",
    "the derivation provides an unambiguous way to determine the coefficients of the anticipation term and the diffusion term .",
    "the macroscopic model derived from the optimal velocity model is examined numerically , and its properties are found to be in reasonable agreement with those of the microscopic model although there are deviations in the quantitative level .",
    "we acknowledge helpful discussions with h. y. lee , who participated in the early stage work of this paper .",
    "h. k. l. also thanks g. s. jeon for discussions .",
    "this work was supported by the brain korea 21 project in 2001 .",
    "while the derivation in secs .",
    "[ optimal ] and [ extension ] assumes a linear regime , interesting traffic phenomena often occur in the nonlinear regime . in this appendix",
    ", we aim to develop a macroscopic momentum equation , which is applicable to nonlinear traffic phenomena when the characteristic length scale is sufficiently long . for traffic phenomena with a long characteristic length scale @xmath207",
    ", each derivative @xmath208 can be formally regarded as a small expansion parameter since it effectively introduces the small factor @xmath209 .",
    "then we can take a perturbative approach : terms without derivatives constitute the zeroth order contributions , and terms with the first order derivative the first order contributions .",
    "thus the relaxation and anticipation terms are the zeroth and first order contributions , respectively .",
    "all zeroth and first order contributions are already included correctly in eqs .",
    "( [ velocitytotalderiv_final ] ) and ( [ gen_eq_of_motion2 ] ) . as for the second order contributions , however ,",
    "only part of them are included since terms proportional to @xmath203 , @xmath204 , or @xmath205 are of the same order as the diffusion term .",
    "below we demonstrate a procedure to obtain the missing second order contributions for the general microscopic model [ eq .",
    "( [ g - mic2 ] ) ] .    in the general expression  ( [ velocitytotalderivative ] ) , the last term proportional to @xmath210 is irrelevant for our discussion since it generates third or higher order contributions only ( see appendix  [ linear_regime ] ) .",
    "we expand the first term to obtain @xmath211 which is a generalization of eqs .",
    "( [ averageforce ] ) and ( [ optimalvelocityexpansion ] ) .",
    "here @xmath212 ) have been ignored . for a spatial coarse graining function @xmath213",
    ", we find @xmath214 where @xmath215 .",
    "note that these second order contributions depend on the coarse - graining function explicitly .",
    "the other three nonlinear terms in eq .",
    "( [ a_nonlinear_exp ] ) give third or higher order contributions only ( see appendix  [ linear_regime ] ) .    the first term on the right - hand side of eq .",
    "( [ a_nonlinear_exp ] ) also generates the second order contributions .",
    "the second order expansion of its arguments results in ( see appendix  [ differences ] ) @xmath216 thus one finds @xmath217    \\nonumber   \\\\ & + & a_{\\rm op,2}\\left[{1\\over \\rho}{\\partial v\\over \\partial x }    + { 1\\over 2\\rho^2}{\\partial^2 v\\over \\partial x^2 }    + { v \\over 2 } \\left ( { \\partial \\rho^{-1 } \\over \\partial x}\\right)^2 \\right ]    \\\\ & + & { a_{\\rm op,11 } \\over 8\\rho^2}\\left ( { \\partial \\rho^{-1 } \\over \\partial x }    \\right)^2+{a_{\\rm op,22}\\over 2\\rho^2}\\left({\\partial v\\over \\partial x }    \\right)^2+{a_{\\rm op,12 } \\over 2\\rho^2 } { \\partial \\rho^{-1 } \\over \\partial x }    { \\partial v \\over",
    "\\partial x}.    \\nonumber\\end{aligned}\\ ] ] note that the second order contributions from the expansion of @xmath218 do not depend on the coarse - graining function .",
    "next we apply the prescription @xmath219 which is the extension of eq .",
    "( [ short_scale_prescription ] ) to second order .",
    "the resulting macroscopic momentum equation is @xmath220 for the optimal velocity model [ eq .",
    "( [ optimalvelocitymodel ] ) ] , this reduces to @xmath221    + { \\lambda v_{\\rm op } ' \\over 2\\rho}{\\partial \\rho^{-1 } \\over \\partial x }    + { \\lambda \\over 6\\rho^2}{\\partial^2 v\\over \\partial x^2 }    \\nonumber \\\\ & + & \\lambda \\left ( { v_{\\rm op } ' \\over 6\\rho}+{v_{\\rm op } '' \\over 8\\rho^2 }    + { \\sigma^2 v_{\\rm op } '' \\over 2 } \\right)\\left (     { \\partial \\rho^{-1 } \\over \\partial x } \\right)^2     \\nonumber \\\\ & - & { \\lambda \\over 6\\rho^2 } { v_{\\rm op } '' \\over v_{\\rm op } ' }     { \\partial \\rho^{-1 } \\over \\partial x }    { \\partial v \\over",
    "\\partial x}\\ .",
    "\\label{nonlinear_dvdt_optimal } \\end{aligned}\\ ] ]    from numerical simulations we find that the last two terms give rise to the artificial instability for short wavelength components despite the presence of the diffusion term .",
    "it turns out that the artificial instability can be cured by applying the prescription @xmath222 .",
    "thus the resulting momentum equation for the optimal velocity model reads @xmath221    + { \\lambda v_{\\rm op } ' \\over 2\\rho}{\\partial \\rho^{-1 } \\over \\partial x }    + { \\lambda \\over 6\\rho^2}{\\partial^2 v\\over \\partial x^2 }    \\nonumber \\\\ & + & { \\lambda\\over ( v'_{\\rm op})^2 }     \\left ( { v_{\\rm op } ' \\over 6\\rho}-{v_{\\rm op } '' \\over 24\\rho^2 }    + { \\sigma^2 v_{\\rm op } '' \\over 2 } \\right)\\left (     { \\partial v \\over \\partial x } \\right)^2 .    \\nonumber \\\\",
    "\\label{nonlinear_dvdt_optimal_2 } \\end{aligned}\\ ] ]",
    "in this appendix , we assume the spatial coarse graining @xmath213 for definiteness .",
    "\\(i ) @xmath223 : after some algebra , it can be written as follows , @xmath224 ^ 2 \\delta(y_m(t)-x^\\prime )       \\delta(y_n(t)-x^{\\prime\\prime } ) .",
    "\\nonumber\\end{aligned}\\ ] ] when the characteristic length of the variations is much larger than the coarse - graining scale , @xmath225 can be formally regarded as small numbers . to obtain the leading contribution",
    ", we may then use the formal approximation @xmath226,\\ ] ] which leads to @xmath227.\\ ] ] note that the second factor on the right - hand side is proportional to the square of the spatial extension of the coarse - graining function .",
    "when there are many vehicles within the coarse - graining scale , @xmath228 where @xmath215 .",
    "thus we obtain @xmath229    \\(ii ) @xmath230 : the procedure is very similar : @xmath231 ^ 2 \\delta(y_m(t)-x^\\prime )       \\delta(y_n(t)-x^{\\prime\\prime } ) .",
    "\\nonumber\\end{aligned}\\ ] ] using the formal approximation @xmath232,\\ ] ] one finds @xmath233    \\(iii ) @xmath234 : @xmath235 ^ 2 \\delta(y_m(t)-x^\\prime )       \\delta(y_n(t)-x^{\\prime\\prime } ) .",
    "\\nonumber\\end{aligned}\\ ] ] since @xmath236 in the leading approximation ( see appendix .",
    "[ differences ] ) , we use the formal approximation @xmath237,\\ ] ] and obtain @xmath238 ^ 2.\\ ] ]    \\(iv ) @xmath239 : @xmath240    \\(v ) @xmath241 : @xmath242    \\(vi ) @xmath243 : @xmath244",
    "this appendix presents derivations of eqs .",
    "( [ distanceexpansion ] ) , ( [ sigmaexpansion ] ) , and ( [ delta_dot_y ] ) .",
    "\\(i ) @xmath67 : one begins with the definition of @xmath245 : @xmath246\\delta(y_n(t')-x ' ) .",
    "\\label{dy_def}\\end{aligned}\\ ] ] the following identity is useful : @xmath247 \\delta(y_n(t)-x ) = { \\partial\\over{\\partial x}}y_{r(x , t)}(t),\\ ] ] where @xmath248 is the vehicle number right in front of @xmath32 at time @xmath7 . for example , when @xmath249 , @xmath250 . note that each side of the equation vanishes unless there is a vehicle at @xmath32 , and that the @xmath32 integration of each side from @xmath251 to @xmath252 results in @xmath253 , which proves the identity . using the identity , eq .",
    "( [ dy_def ] ) can be simplified to @xmath254 , \\label{dy_exp1}\\ ] ] where @xmath255.\\end{aligned}\\ ] ] to obtain eq .",
    "( [ dy_exp1 ] ) , the integration by parts is used .",
    "below @xmath9 is assumed to be even in @xmath32 . in the homogeneous state ,",
    "@xmath256 and @xmath257 since @xmath258 is the vehicle number right behind the position @xmath19 at time @xmath20 .",
    "it can also be shown that @xmath259 in the homogeneous state .",
    "thus the first two leading terms in eq .",
    "( [ distanceexpansion ] ) can be obtained by replacing @xmath260 in eq .",
    "( [ dy_exp1 ] ) with @xmath261 .    to obtain the leading contribution to @xmath75 in eq .",
    "( [ sigmaexpansion ] ) , we calculate @xmath262 , which is expected to be proportional to @xmath263",
    ". however , the term @xmath264 does not give such a contribution .",
    "for illustration , it is useful to introduce a new coordinate @xmath265 and redefine all quantities in terms of the new space variable . under this transformation ,",
    "@xmath0 and @xmath264 have even parity [ @xmath266 , @xmath267 , while the density gradient has the odd parity [ @xmath268 .",
    "since @xmath264 and @xmath269 have different parities , @xmath264 should not give a correction proportional to @xmath263 .",
    "on the other hand , @xmath270 gives a correction proportional to @xmath263 .",
    "one uses the identity @xmath271,\\ ] ] where @xmath272 ^ 2 ,    \\nonumber \\\\ b_2(x , t ) & = & { 1\\over 2 } \\int dx ' dt ' \\phi(x - x',t - t ' )    \\nonumber \\\\    & \\times & \\left [ { y_{r(x',t')}(t')+y_{r(x',t')-1}(t ' ) \\over 2 }    -x'\\right]^2.\\end{aligned}\\ ] ] in the homogeneous state , @xmath273 and @xmath274 .",
    "thus one obtains @xmath275 from eqs .",
    "( [ dy_exp1 ] ) and ( [ a2_result ] ) , one then finds @xmath276    \\(ii ) @xmath277 : for derivation , it is convenient to relate @xmath277 to @xmath67 .",
    "using integration by parts , one can verify @xmath278 + { \\partial \\over \\partial x}\\left [ \\rho \\langle \\dot y_n \\delta y_n   \\rangle \\right].\\ ] ] here @xmath279 can be approximated by @xmath280 .",
    "their difference is proportional to @xmath281 ( see appendix  [ linear_regime ] ) , and thus we ignore @xmath282 $ ] .",
    "one then uses eq .",
    "( [ vehicleconservation ] ) to obtain @xmath283 by using expansion  ( [ distanceexpansion ] ) and the continuity equation  ( [ vehicleconservation ] ) to convert temporal derivatives into spatial derivatives , one obtains @xmath284    see for instance r. herman and k. gardels , sci",
    "209 * , 35 ( 1963 ) ; d. c. gazis , science * 157 * , 273 ( 1967 ) ; i. prigogine and r. herman , _ kinetic theory of vehicular traffic _ ( elsevier , amsterdam , 1971 ) .",
    "k. nagel and m. schreckenberg , j. phys .",
    "i france * 2 * , 2221 ( 1992 ) . o. biham , a. a. middleton , and d. levine , phys .",
    "a * 46 * , r6124 ( 1992 ) .",
    "b. s. kerner and p. konhuser , phys .",
    "e * 48 * , r2335 ( 1993 ) .",
    "j. treiterer and j. a. myers , in _ proc .",
    "6th int . symp . on transportation and traffic theory _ , edited by d. j. buckley ( elsevier , new york , 1974 ) ; m. koshi , m. iwasaki , and i. ohkura , in _ proceedings of the eighth international symposium on transportation and traffic flow _ , edited by v. f. hurdle , e. hauer , and g. n. stewart ( university of toronto press , toronto , 1983 ) .",
    "b. s. kerner and h. rehborn , phys .",
    "e * 53 * , r4275 ( 1996 ) ; phys .",
    "lett . * 79 * , 4030 ( 1997 ) ; b. s. kerner , _ ibid_. * 81 * , 1130 ( 1998 ) ; j. phys .",
    "a : math . gen . * 33 * , l221 ( 2000 ) .",
    "l. neubert , l. santen , a. schadschneider , and m. schreckenberg , phys .",
    "e * 60 * , 6480 ( 1999 ) .",
    "m. treiber , a. hennecke , and d. helbing , phys .",
    "e * 62 * , 1805 ( 2000 ) .",
    "h. y. lee , h .- w .",
    "lee , and d. kim , phys .",
    "e * 62 * , 4737 ( 2000 ) .",
    "t. nagatani , j. phys .",
    ". jpn . * 66 * , 1928 ( 1997 ) . h. y. lee , h .- w .",
    "lee , and d. kim , phys .",
    "lett . * 81 * , 1130 ( 1998 ) ; phys .",
    "e * 59 * , 5101 ( 1999 ) .",
    "d. helbing and m. treiber , phys .",
    "* 81 * , 3042 ( 1998 ) ; d. helbing , a. hennecke , and m. treiber , _ ibid_. * 82 * , 4360 ( 1999 ) . n. mitarai and h. nakanishi , j. phys .",
    ". jpn . * 68 * , 2475 ( 1999 ) ; phys .",
    "* 85 * , 1766 ( 2000 ) .",
    "e. tomer , l. safonov , and s. havlin , phys .",
    "* 84 * , 382 ( 2000 ) .",
    "p. nelson , phys .",
    "e * 61 * , r6052 ( 2000 ) .",
    "d. e. wolf , m. schreckenberg , and a. bachem , _ traffic and granular flow _",
    "( world scientific , singapore , 1996 ) ; m. schreckenberg and d. e. wolf , _ traffic and granular flow 97 _ ( world scientific , singapore , 1996 ) ; d. helbing , h. j. hermann , m. schreckenberg , d. e. wolf , _ traffic and granular flow 99 _ ( springer , berlin , 2000 ) .",
    "k. nagel , j. esser , and m. rickert , in _ annu .",
    "_ , edited by d. stauffer ( world scientific , 1999 ) .",
    "d. chowdhury , l. santen , and a. schadschneider , phys .",
    "rep . * 329 * , 199 ( 2000 ) .",
    "d. helbing , to appear in rev .",
    "mod . phys .",
    "( cond - mat/0012229 ) .",
    "m. hermann and b. s. kerner , physica a * 255 * , 163 ( 1998 ) .",
    "h. hayakawa and k. nakanishi , prog .",
    "130 , 57 ( 1998 ) .",
    "m. treiber , a. hennecke , and d. helbing , phys .",
    "e * 59 * , 239 ( 1999 ) .",
    "d. helbing , a. hennecke , v. shvetsov , and m. treiber , to appear in mathematical and computer modelling ( cond - mat/0003269 ) .",
    "m. bando , k. hasebe , a. nakayama , a. shibata , and y. sugiyama , phys .",
    "e * 51 * , 1035 ( 1995 ) . for a special value of @xmath50 and a special vehicle density",
    ", the traffic dynamics becomes critical .",
    "near this critical point , the method of t. s. komatsu and s .- i .",
    "sasa [ phys .",
    "e * 52 * , 5574 ( 1995 ) ] can be used to derive a continuum equation for the inverse density field . in this method , the velocity field is regarded as a function of the density field , which is valid only for @xmath285 . in contrast , both fields are independent dynamic fields in our derivation . sec . 3.3 in d. helbing , cond - mat/9806171 .",
    "tadaki , m. kikuchi , y. sugiyama , and s. yukawa , j. phys .",
    ". jpn . * 67 * , 2270 ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> we present a method to derive macroscopic fluid - dynamic models from microscopic car - following models via a coarse - graining procedure . the method is first demonstrated for the optimal velocity model . </S>",
    "<S> the derived macroscopic model consists of a conservation equation and a momentum equation , and the latter contains a relaxation term , an anticipation term , and a diffusion term . </S>",
    "<S> properties of the resulting macroscopic model are compared with those of the optimal velocity model through numerical simulations , and reasonable agreement is found although there are deviations in the quantitative level . </S>",
    "<S> the derivation is also extended to general car - following models .    2 </S>"
  ]
}