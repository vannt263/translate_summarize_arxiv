{
  "article_text": [
    "in order to understand the various stages of star formation it is essential to follow the exact thermal evolution of a collapsing cloud because some important dynamical processes , for example fragmentation @xcite , are closely related to the thermal evolution .",
    "the thermal evolution of a collapsing cloud is described by radiation hydrodynamics , and inevitably involves a numerical solution .",
    "however , it is not easy to implement and run a multi  dimensional radiation hydrodynamic code , so various approximate methods have been used instead of solving the full radiation hydrodynamic equations directly .",
    "@xcite used one  dimensional hydrodynamic codes including a more realistic approach to radiative transfer .",
    "such an approach can track the exact thermal evolution of a collapsing cloud , and is easily compared to the observational results .",
    "however , in a one  dimensional code it is impossible to observe some important dynamics , for example fragmentation .",
    "on the other hand , a simplified treatment for the radiative transfer is needed in multi  dimensional hydrodynamic codes .",
    "the eddington approximation was used by @xcite , while @xcite used the diffusion approximation in his one  dimensional simulations .",
    "however , the multi - dimensional calculations with radiative transfer published so far have been done mostly with codes using the finite difference method . although smooth particle hydrodynamics ( hereafter sph ) codes are now used quite commonly in the calculations for self  gravitating clouds , so far few attempts to include radiative transfer in an sph code",
    "have been published @xcite .",
    "the main reason is that the diffusion approximation for treating radiative transfer there has a double differential in spatial coordinates which is very difficult to evaluate accurately with sph because the particles occupy in principle arbitrary positions .",
    "* hereafter b85 ) derived an equation which bypasses the double differential by converting it to a single differential .",
    "* hereafter cm99 ) extended the b85 method to treat cases with a discontinuous conductivity .",
    "another difficulty in the treatment of radiative transfer is the large difference in time scales .",
    "the radiative time scale is much shorter than the dynamical time scale in a collapsing cloud .",
    "therefore , an implicit numerical scheme is needed to treat the thermal and dynamical evolutions simultaneously .",
    "@xcite developed an effective implicit scheme for radiative transfer in a fully three ",
    "dimensional sph code after many unsuccessful attempts .",
    "we have performed a non  isothermal cloud collapse with the implicit code , and compared our results with those of ( * ? ? ? * hereafter mb93 ) .",
    "the comparison should be useful because the two methods are completely different from each other .    the implicit scheme which combines the diffusion approximation and sph",
    "is described in section 2 in detail .",
    "we have used a more realistic energy calculation instead of an ideal equation of state for the determination of temperature , and the detailed procedure for the specific internal energy calculation is also given in the same section .",
    "the non  isothermal cloud collapse simulations and the comparison of our results with those of mb93 are given in section 3 .",
    "the summary is in section 4 .",
    "sph @xcite is a grid  free and fully lagrangian method , and therefore has been widely used in gravitational collapse simulations .",
    "the lagrangian hydrodynamics with self  gravitation are given by @xmath0 where @xmath1 is the lagrangian derivative , @xmath2 is the specific internal energy and other variables have their usual meaning .",
    "although there are many alternatives for the sph formulation of equations ( [ lhd1 ] )  ( [ lhd3 ] ) @xcite , we have used a common form given by @xmath3 here @xmath4 is the artificial viscosity given by @xmath5 where @xmath6 , @xmath7 is the smoothing length , @xmath8 , @xmath9 , @xmath10 , @xmath11 , and @xmath12 , @xmath13 and @xmath14 are free parameters , @xmath15 and @xmath16 in all simulations .",
    "@xmath14 is not a critical free parameter @xcite for the artificial viscosity , because normally @xmath17 . ] . here",
    "@xmath18 is the sound speed .",
    "although the artificial viscosity has a side  effect in differentially rotating systems @xcite , it is essential for the treatment of shock waves in sph .",
    "@xmath19 in equations ( [ sph1 ] ) - ( [ sph3 ] ) is a kernel function , and the m4 kernel @xcite has been used in our simulations . for additional details about sph , the reader is referred to the reviews by @xcite and @xcite .",
    "the diffusion approximation has been adopted in our three - dimensional sph code for the treatment of radiative transfer , because it is very hard to trace the exact behavior of individual photons in the multi  dimensional hydrodynamic code ( but see * ? ? ?",
    "the diffusion approximation is strictly valid only for regions of great optical depth ( i.e. optically thick medium ) .",
    "however , the early stage of the collapse of a cloud is optically thin because of the very low density and effective cooling .",
    "@xcite discussed this point in his one - dimensional simulations , and concluded that the diffusion approximation can be applied in the isothermal stage of a collapsing cloud , because the diffusion approximation essentially keeps the cloud temperature at the boundary value in the early stage of the collapse .",
    "the energy equation with the diffusion term is given by @xmath20 where @xmath21 is the radiative flux , and is given by @xmath22 where @xmath23 is the rosseland mean opacity , @xmath24 is @xmath25 , @xmath26 is the speed of light and @xmath27 is the stephan  boltzmann constant .",
    "if an effective conductivity , @xmath28 is defined , equation ( [ ene ] ) may be rewritten as @xmath29 equation ( [ newene ] ) contains a double derivative , and this @xmath30 operation is very sensitive to the disorder in the particle distribution , such that it may cause numerical noise in the simulation .",
    "b85 suggested another formulation for the diffusion term to avoid this @xmath30 operator .",
    "we describe here briefly the treatment of b85 .    in one  dimension ,",
    "the diffusion term of equation ( [ newene ] ) becomes @xmath31 the derivation for the first term of equation ( [ onedimdif ] ) starts from the taylor expansions of @xmath32 and @xmath33 around @xmath34 and @xmath35 , respectively , @xmath36 from equations ( [ taylorq ] ) and ( [ taylort ] ) one can derive , @xmath37[t(x')-t(x ) ] = ( x'-x)^2\\frac{dq}{dx}\\frac{dt}{dx},\\ ] ] and the integral interpolant form of equation ( [ middqdt ] ) becomes @xmath38[t(x')-t(x)]}{x - x ' } \\frac{\\partial w(x - x')}{\\partial x}dx'.\\ ] ]    for the derivation of the second term of equation ( [ onedimdif ] ) , we will use equation ( [ taylort ] ) , @xmath39 and it becomes @xmath40 from equations ( [ firstterm ] ) and ( [ secondterm ] ) , the diffusion term of equation ( [ ene ] ) in one  dimension becomes @xmath41 and the three - dimensional form becomes @xmath42 with equation ( [ diffsph1 ] ) or ( [ diffsph3 ] ) , the calculation of @xmath30 can be avoided , and the energy equation becomes finally @xmath43    this method derived by b85 is valid for a constant or smoothly varing conductivity .",
    "cm99 suggested a modification to treat media with a discontinuous conductivity .",
    "they considered the continuity of conductive heat flux across the border of adjacent cells ( or particles ) , and found a better expression , @xmath44 , for the effective conductivity term instead of @xmath45 in equation ( [ finalene ] ) .",
    "cm99 also performed various tests with the new formulation , and some of them are repeated in the next section .",
    "given the approximation involved in the derivation presented above , it is not obvious that a solution of equation ( [ finalene ] ) is also a solution of equation ( [ ene ] ) . therefore we have performed a test of the thermal conduction problem to verify the treatment for the double derivative .",
    "the thermal diffusion equation is given by @xmath46 where @xmath47 is time and @xmath48 is the thermal conductivity .",
    "the simplest case for the thermal diffusion equation is that @xmath48 is a constant ( i.e. a homogeneous medium ) . in this case equation ( [ heatdiffusion ] ) becomes @xmath49 here a simple relation between @xmath2 and @xmath50 , @xmath51 is assumed , and @xmath52 is the specific heat of the medium .",
    "the treatments of b85 and cm99 are the same in this simple case , and so equation ( [ hdsimple ] ) can be rewritten as @xmath53 in one  dimension .    for this test",
    ", we have used 40 particles in @xmath54 , and a constant @xmath7 value for all particles .",
    "@xmath55 , @xmath52 and @xmath48 are set to unity , and all particles keep their original positions in this test , so the situation is very similar to a one  dimensional finite difference simulation .",
    "the temperature distribution at @xmath56 is given by @xmath57 and the boundary temperature is set to @xmath58k .",
    "the analytic solution of equation ( [ hdsimple ] ) is , @xmath59 figure [ cont ] shows the results until @xmath60 .",
    "the solid lines in the figure are the analytic solution given by equation ( [ heatsol ] ) at different times , and the dots are the results of our numerical calculation .",
    "the numerical solution reproduces the analytic solution very well and confirms the validity of the b85 formulation .     and @xmath61 .",
    "the dots are the numerical solution using equation ( [ heatnumsol ] ) , and the solid lines are the analytic solution given by equation ( [ heatsol ] ) .",
    "there is very good agreement between these two solutions .",
    "the boundary temperature is set to @xmath58k in this simulation .",
    "[ cont ] ]    furthermore we have performed several tests for cases with a discontinuous conductivity as presented in cm99 .",
    "we will show one of them . in this test",
    "the medium is divided into two parts , and each part has different values for the conductivity , so the resultant diffusivity @xmath62 is different in the left and right part of the medium .",
    "the initial conditions for this test are shown in table [ cmtest ] .",
    "refer to section 5.3 of cm99 for details of this test .",
    ".initial conditions for discontinuous conductivity test [ cols=\"^,^,^\",options=\"header \" , ]     comparison of our results with those of mb93 . here",
    "cc and sc mean cartesian and spherical codes , respectively .",
    "we have presented a fully three - dimensional radiation hydrodynamic code based on the sph method and the diffusion approximation .",
    "the difficulty encountered in previous attempts of how to treat the double derivative in sph was solved by using the treatment developed by b85 to convert the double derivative to a single one .",
    "a thermal conduction test shows that this treatment works as expected .",
    "the second difficulty arises from the large difference between the radiative and dynamical time scales .",
    "the radiative time scale is much shorter than the dynamical time scale in a collapsing cloud , especially in the isothermal stage .",
    "we have developed a fully three - dimensional implicit scheme for dealing with the large difference between the time scales .    to test our implicit scheme",
    ", we performed a nonisothermal cloud collapse of a centrally condensed cloud .",
    "the same simulation has been performed by mb93 using two fdm codes , and we have compared our results with those of mb93 .",
    "the two numerical methods based on two completely different philosophies agree with each other .",
    "we thank harold yorke for providing a table of the new extinction values for grains and for a useful discussion .",
    "this research was supported by a grant from the national sciences and engineering research council of canada .",
    "shc thanks the carnegie institution of canada for supporting his post - doctoral fellowship at universit de montral ."
  ],
  "abstract_text": [
    "<S> an implicit method for radiative transfer in sph is described . </S>",
    "<S> the diffusion approximation is used , and the hydrodynamic calculations are performed by a fully three  dimensional sph code . instead of the energy equation of state for an ideal gas , various energy states and the dissociation of hydrogen molecules are considered in the energy calculation for a more realistic temperature and pressure determination . in order to test the implicit code , we have performed non  isothermal collapse simulations of a centrally condensed cloud , and have compared our results with those of finite difference calculations performed by mb93 . </S>",
    "<S> the results produced by the two completely different numerical methods agree well with each other . </S>"
  ]
}