{
  "article_text": [
    "a variety of lightly damped alfvnic modes can occur in magnetically confined plasmas .",
    "interaction with fast particles can destabilise these modes , leading to a loss of confinement of these particles . in fusion applications",
    ", such losses could reduce heating and damage plasma facing components .",
    "one such mode is the toroidicity - induced shear alfvn eigenmode ( tae ) , which occurs due to the coupling of successive poloidal harmonics in a toroidal plasma .",
    "this coupling results in frequency gaps in the spectrum of spatially - localised modes resonant on particular flux surfaces .",
    "taes which have extended radial structure , can exist in these frequency gaps .",
    "one potentially significant source of damping for these global modes is the resonant transfer of energy from these modes to the strongly damped continuum modes .",
    "physically , continuum damping represents dissipative effects , such as charge separation and mode conversion which occur near continuum resonances .",
    "such behaviour could be described using two - fluid and kinetic plasma models .",
    "however , it is not necessary to model these mechanisms to compute continuum damping .",
    "continuum damping can be calculated using resistive mhd  as the limit of damping as resistivity is reduced to zero @xcite . in ideal mhd",
    "a continuum resonance corresponds to a regular singular point .",
    "the correct treatment of such a singularity is dictated by the causality condition , analogous to the analysis of landau damping of plasma oscillations @xcite .",
    "analytic @xcite and numerical @xcite methods have been developed for calculating continuum damping using ideal mhd  based on this condition . in this paper we outline a numerical method in which singular finite elements are used to ensure that the singularity in the ideal mhd  treatment of continuum damping is properly represented .",
    "while we describe the calculation of continuum damping of a tae the method used could be adapted to the continuum damping of other global modes in toroidal plasmas .",
    "singular finite elements are used in a number of fields , with examples of applications occurring in fracture mechanics @xcite , electromagnetism @xcite and viscous flow @xcite . to our knowledge ,",
    "singular finite element methods have only been employed in one case in plasma physics to solve the ideal mhd  newcomb equation describing a marginally stable cylindrical plasma mhd  @xcite .",
    "this method was applied to the analysis of resistive instabilities . in these cases",
    "the asymptotic behaviour around and location of the singular point is known .",
    "singular finite elements have not previously been applied to mhd  problems with finite frequency oscillations . in the case",
    "we analyse , the location of continuum resonances is dependent on the tae  eigenvalue .",
    "consequently , determining this eigenvalue using the singular finite element method is an iterative process , in which the estimated location of the resonance must be updated after each iteration .    in section [ sec : tae_equation ] of this paper",
    "we outline a tae  model due to berk _",
    "_  and show that the resulting eigenvalue equation can be expressed in terms of hermitian operators .",
    "the frobenius method is applied to this expression to determine the form of the continuum resonance singularities in section [ sec : singularities ] .",
    "subsequently , in section [ sec : fem ] a finite element method is described which incorporates elements with this form .",
    "this method is applied to a tae  in section [ sec : verification ] and verified by comparison to the complex contour method .",
    "in this paper we consider a tae  in a low @xmath0 , large aspect ratio circular tokamak with a perfectly conducting wall at the edge of the plasma .",
    "for this case berk _",
    "_  have derived the following coupled mode equation for shear alfvn waves in ideal mhd@xcite : @xmath1+\\frac{d}{dr}\\left ( \\frac{\\omega^2}{{v_a}^2 } \\right ) r^2e_m-\\left ( m^2 - 1 \\right ) \\left(\\frac{\\omega^2}{v_a^2}-k_{\\parallel m}^2 \\right ) re_m & & \\nonumber \\\\ \\noindent + \\frac{d}{dr}\\left [ \\frac{5\\epsilon r^4}{2a } \\left ( \\frac{de_{m+1}}{dr}+\\frac{de_{m-1}}{dr } \\right ) \\right ] = 0 , \\label{eq : wave_equation}\\end{aligned}\\ ] ] in which @xmath2 is the @xmath3th poloidal fourier component of @xmath4 , where @xmath5 is the perturbation to the electric potential due to the wave .",
    "the gauge is set such that the magnetic vector potential @xmath6 associated with these oscillations is parallel to the equilibrium magnetic field .",
    "the variable @xmath7 is the radial coordinate in the flux - type straight - field - line coordinates defined by berk _",
    "et al . _",
    "the inverse aspect ratio @xmath8 , is the ratio of the minor radius @xmath9 to the major radius @xmath10 , @xmath11 is the angular frequency of the mode and @xmath12 is the wave number parallel to the magnetic field for poloidal and toroidal mode number @xmath3 and @xmath13 respectively . for a particular flux surface",
    "@xmath14 is the alfvn speed and @xmath15 is the safety factor .",
    "dividing by @xmath9 , equation ( [ eq : wave_equation ] ) can be written more compactly as : @xmath16 - l_{k } \\left [ e_j \\right ] = \\frac{d}{dx } \\left [   \\left ( \\omega^2 d_{\\omega , i , j } \\left ( x \\right ) - d_{k , i , j } \\left ( x \\right ) \\right ) \\frac{de_j}{dx } \\right ] & & \\nonumber \\\\ + \\left ( \\omega^2 a_{\\omega , i , j } \\left ( x \\right ) - a_{k , i , j } \\left ( x \\right ) \\right ) e_j = 0 .",
    "\\label{eq : matrix_equation}\\end{aligned}\\ ] ] here we define : @xmath17 in which @xmath18 is the normalised radial coordinate and @xmath19 is the normalised frequency , where @xmath20 is the alfvn speed at the magnetic axis .",
    "the operators @xmath21 and @xmath22 can be shown to be hermitian . as ideal",
    "mhd  is non - dissipative , the corresponding operators must be hermitian for arbitrary geometry .",
    "thus the equations of linearised ideal mhd  spectral analysis may always be expressed in the form seen in equation ( [ eq : matrix_equation ] ) , regardless of geometry and simplifying assumptions .",
    "therefore , the methods described here for a simplified case could in principle be applied in three - dimensional geometry or where there is interaction between shear - alfvn and magneto - sonic waves .    if operator @xmath23 is hermitian , then : @xmath24 \\right ) ^{\\dagger } { \\mathbf{y } } ' dx = \\int_{a}^{b } \\mathbf{y}^{\\dagger } \\left ( l \\left [ { \\mathbf{y } } ' \\right ] \\right ) dx , \\label{eq : hermitian}\\ ] ] for all @xmath25 and @xmath26 . if @xmath23 is a second order differential operator : @xmath27 = \\left ( l_2 \\left ( x \\right ) \\frac{d^2}{dx^2 } + l_1 \\left ( x \\right ) \\frac{d}{dx } + l_0 \\left ( x \\right ) \\right ) \\left [ \\mathbf{y } \\right ] .",
    "\\label{eq : sodo}\\ ] ] substitute equation ( [ eq : sodo ] ) into equation ( [ eq : hermitian ] ) and integrate by parts , @xmath28 the last step assumes that @xmath29 for @xmath30 and @xmath31 . hence ,",
    "to ensure that @xmath23 is hermitian , we require that : @xmath32 therefore , for hermitian matrices @xmath33 and",
    "@xmath34 this implies that @xmath35 , and thus the equation @xmath36 has the same form as equation ( [ eq : matrix_equation ] ) . clearly , @xmath33 and @xmath34 are hermitian for a circular tokamak with the large aspect ratio approximation described in equation ( [ eq : matrix_equation ] ) .",
    "however , it can also be shown that the force operator for linearised ideal mhd  can be expressed in a symmetric form @xcite .",
    "therefore , it follows that matrices @xmath33 and @xmath34 will be hermitian for arbitrary geometry .",
    "thus the equations of ideal mhd  spectral analysis may always be expressed in the form seen in equation ( [ eq : matrix_equation ] ) , regardless of geometry and simplifying assumptions .",
    "therefore , the methods described here for a simplified case could in principle be applied in three - dimensional geometry or where there is interaction between shear - alfvn and magneto - sonic waves .",
    "regular singularities occur for @xmath37 such that the determinant of the matrix @xmath38 is zero . at this point",
    "the inverse of the operator @xmath39 is unbounded .",
    "the behaviour of the wave function near this pole can be found using a frobenius expansion .",
    "let @xmath40 , where @xmath41 is the location of a pole due to a continuum resonance , and let @xmath42 . in general @xmath41 will be displaced into the complex plane as @xmath43 become complex due to continuum damping .",
    "where the inverse of @xmath44 exists , from equation ( [ eq : matrix_equation ] ) we can derive the following expression : @xmath45 assume that @xmath46 .",
    "that is , consider a case where the continuum resonance does not coincide with a stationary point of the continuous spectrum .",
    "hence , near the pole , the inverse of matrix @xmath47 can be approximated in terms of its adjugate as : @xmath48 thus it is possible to write equation ( [ eq : simplified ] ) as @xmath49 where @xmath50 \\right |_{x = x_r } = \\delta_{i , j } , & & \\\\",
    "n_{i , j } = \\left [ \\left . \\frac{\\textup{adj } \\left ( d \\right ) _ { i , k}}{\\frac{d \\left",
    "\\| d_{i , j } \\right \\|}{dx } }   a_{k , j }   \\right ] \\right |_{x = x_r } .\\end{aligned}\\ ] ] using the frobenius method , express the solution near the resonance as : @xmath51 where @xmath52 for some @xmath53 . combining this requirement with equation ( [ eq : fobenius ] ) leads to the indicial equation : @xmath54",
    "hence , the indicial equation has the double root @xmath55 .",
    "therefore , the indicial equation does not provide two linearly independent solutions . as a consequence",
    ", the solution will have general form : @xmath56 where @xmath52 or @xmath57 for some @xmath53 .",
    "thus , the indicial equations are : @xmath58 for these equations @xmath55 remains a solution , and if @xmath59 the previous solution is recovered .",
    "additional non - trivial solutions are found with @xmath57 for some @xmath53 .",
    "thus the solution in the vicinity of the resonance can be approximated to first order as @xmath60 .",
    "it is possible to express the normalised real frequency @xmath61 and damping @xmath62 as normalised complex frequency @xmath63 .",
    "for complex @xmath43 , the pole due to the continuum resonance will generally have an imaginary component .",
    "consequently , it is necessary to define an analytic continuation of the logarithmic function in the vicinity of the complex pole .",
    "the causality condition requires that the logarithmic function is found by analytic continuation of the function on a path that with the real axis encloses the singularity .",
    "physically , this derives from the requirement that a perturbation to the plasma precedes the response it causes .",
    "a branch cut exists where @xmath64 and @xmath65 if @xmath66 or @xmath67 if @xmath68 .",
    "thus the logarithmic function in the frobenius approximation will be : @xmath69 where @xmath70 and @xmath71 is the heaviside step function .",
    "in the galerkin method the eigenvalue problem @xmath72 is discretised by deriving a weak formulation of the problem and approximating the solution as a linear combination of a finite number of basis functions .",
    "the weak formulation is expressed in terms of bi - linear forms @xmath73 and @xmath74 defined for @xmath75 where @xmath76 is a hilbert space .",
    "the eigenfunction @xmath77 and eigenvalue @xmath78 are such that @xmath79 @xmath80 .",
    "this problem is discretised by solving for @xmath81 where @xmath82 is a @xmath83-dimensional subset of @xmath76 , representing the space spanned by a finite set of basis functions .",
    "this allows the problem to be represented as a generalised matrix eigenvalue problem , for which efficient numerical solution procedures exist .",
    "the solution obtained using this method is such that its error @xmath84 ( the difference between it and the exact solution to the original eigenvalue problem ) is galerkin orthogonal to the space spanned by the chosen basis functions .",
    "that is @xmath85 @xmath86 @xmath87 .",
    "thus this solution represents a projection of the exact solution onto the chosen space @xmath82 .",
    "the accuracy of the solution obtained depends on how accurately the eigenfunction can be approximated by a linear combination of the chosen basis elements .",
    "finite element method results can be made to converge with an increasing number of basis functions .    for simplicity ,",
    "triangular functions with uniform spacing were chosen to form the basis set .",
    "these are defined as follows , @xmath88 where the centre of the @xmath53th basis function is located at @xmath89 , @xmath90 is the number of elements and @xmath91 is the spacing between the centres of adjacent functions .",
    "this gives a piecewise linear approximate solution @xmath92 .",
    "it is possible to express the tae  wave equation in terms of a sesquilinear form by taking the scalar product with a function @xmath93 and integrating from @xmath94 to @xmath95 . in the absence of continuum resonances",
    "this leads to the expression : @xmath96 \\frac{de_j}{dx } dx = \\int_{0}^{1 } e_i^ * \\left [ d_{k , i , j } \\left ( x \\right ) - a_{k , i , j } \\left ( x \\right ) \\right ] e_j dx\\ ] ] , for all continuous @xmath93 where @xmath97 .",
    "however , due to the discontinuity associated with a logarithmic singularity , it is necessary to exclude the continuum resonance from the integration .",
    "let @xmath98 and @xmath99 be the real valued lower and upper bounds of a region containing the continuum resonance @xmath100 , where @xmath101 and @xmath102 . if the region where @xmath103 $ ]",
    "is removed from the integration , this leads to the appearance of surface terms : @xmath104 & & \\nonumber \\\\",
    "\\noindent = \\left [ \\left .",
    "* d_{k , i , j}\\left ( x \\right ) \\frac{de_j}{dx } \\right |_{x_r^-}^{x_r^+ } + \\left ( \\int_{0}^{x_r^- } dx + \\int_{x_r^+}^{1 } dx \\right ) \\left \\ { e_i^ * \\left ( d_{k , i , j } \\left ( x \\right ) - a_{k , i , j } \\left ( x \\right ) \\right ) e_j \\right \\ } \\right ] .\\end{aligned}\\ ] ] for all @xmath93 continuous on @xmath105 where @xmath97 .",
    "removing this part of the domain from the integration is equivalent to multiplying the integrand by a weight function @xmath106 which is equal to @xmath107 for @xmath108 and @xmath109 elsewhere .",
    "the equation clearly lacks any information on the excluded region .",
    "thus the equation expresses a necessary , but not sufficient condition for the solution @xmath2 .",
    "consequently , it is necessary to restrict @xmath2 in the excluded region to those solutions found using the frobenius expansion .",
    "this can be achieved by replacing the finite element basis functions where @xmath103 $ ] with appropriate singular finite elements .",
    "although , the above applies to cases with one continuum resonance , however it could readily be generalised to cases with multiple resonances .",
    "the basis functions described above are replaced with alternative functions reflecting the lowest order terms of the frobenius expansion over an inner region @xmath110 .",
    "the bounds @xmath9 and @xmath111 are chosen such that @xmath112 and both @xmath9 and @xmath111 are integer multiples of @xmath113 .",
    "the singular basis functions used are defined in terms of the analytically continued logarithmic function expressed in equation ( [ eq : aclog ] ) , @xmath114 such basis functions are illustrated in figure [ fig : log_sfe ] . by including the discontinuity at @xmath115 due to the continuum resonance pole , such singular basis functions ensure that continuum damping is represented by the imaginary component of the eigenvalue .",
    "elements which are constant on the inner region are also chosen , reflecting the constant terms in the expansion , @xmath116 this type of basis function is illustrated in figure [ fig : constant_fe ] . to improve convergence ,",
    "basis functions were also defined which were linear on the inner region , representing the next lowest order terms in the expansion , @xmath117 an illustration of such a basis function is provided in [ fig : linear_fe ] .",
    "inclusion of linear terms reflects the existence of a real component of the solution on the inner region which is anti - symmetric in both real and imaginary parts about the continuum resonance location .",
    "plots ( a ) and ( b ) illustrate basis functions which are logarithmic on the inner region @xmath118 , @xmath119 where @xmath120 is positive and negative respectively . in each case",
    "@xmath120 is finite , resulting in a continuous real component ( blue , solid ) and an imaginary component with a step - discontinuity at @xmath121 ( gold , dashed ) .",
    ", title=\"fig:\",width=302 ]   plots ( a ) and ( b ) illustrate basis functions which are logarithmic on the inner region @xmath118 , @xmath119 where @xmath120 is positive and negative respectively . in each case @xmath120 is finite , resulting in a continuous real component ( blue , solid ) and an imaginary component with a step - discontinuity at @xmath121 ( gold , dashed ) . ,",
    "title=\"fig:\",width=302 ]     a plot illustrating a basis function which is linear over the inner region @xmath118 , @xmath122 .",
    ", width=302 ]     a plot illustrating a basis function which is linear over the inner region @xmath118 , @xmath123 .",
    ", width=302 ]    the location of the pole due to the continuum resonance is not known _ a priori _ , as solutions to @xmath124 are dependent on @xmath43 .",
    "if there is an error in the estimated resonance location , the basis functions above will not be able to accurately represent the solution near the resonance .",
    "thus , the solution obtained will depend on the width of the excised region .",
    "consequently it is necessary to apply the singular finite element using an iterative technique .",
    "the technique is applied as follows :    1 .",
    "compute the real frequency component using the finite element technique incorporating only standard linear elements .",
    "this is reasonably accurate , provided that the continuum damping is small in relation to the real frequency component .",
    "2 .   estimate the pole location @xmath41 , by solving @xmath125 , where @xmath126 is the normalised continuum frequency .",
    "3 .   add a small imaginary component to the estimated pole location @xmath41 , reflecting that @xmath127 as required by the causality condition .",
    "the sign of this component is estimated based on a truncated taylor series expansion which implies @xmath128 .",
    "4 .   using singular finite elements ,",
    "find @xmath43 as a function of the width of the excised region .",
    "a larger excised width reduces the effect of the error in the pole location , though the remaining logarithmic part should be sufficiently large that it accurately reflects the solution .",
    "5 .   update the estimate for complex @xmath43 by estimating the limit for the @xmath43 based on the largest value of the excise width .",
    "update the estimate for the pole location . approximate the real component using @xmath129 and",
    "then approximate the imaginary component based on the truncated taylor series in step ( iii ) .",
    "repeat the previous three steps to determine increasingly accurate values for @xmath43 and @xmath41 , which numerical experiment shows converge to constant values . as this occurs the dependence of @xmath43 on the width of the excised region",
    "is removed .",
    "demonstrate convergence with respect to the number of radial grid points , @xmath90 and the width of the inner region , @xmath130 .",
    "the complex contour method was used to verify the results obtained using singular finite elements . in this technique the eigenvalue problem is solved over a complex contour which is deformed around the complex poles due to continuum resonances in accordance with the causality condition @xcite .",
    "the complex contour chosen is parameterised by @xmath131 , where @xmath132 .",
    "a similar galerkin method can be used to find the complex eigenvalues in this case , using a basis set composed exclusively of triangular functions .",
    "these basis functions are defined along the complex contour in terms of the contour parameter @xmath133 .",
    "for the chosen tae  case the equilibrium parameters @xmath134 and @xmath135 are analytic on the region of interest , allowing evaluation along the chosen complex contour .",
    "a tae  mode due to the coupling of the @xmath136 and @xmath137 harmonics was studied using the simplified model outlined in section [ sec : singularities ] .",
    "this analysis was done for a tokamak with aspect ratio @xmath138 ( @xmath139 ) .",
    "the safety factor profile was chosen to be @xmath140 , where @xmath141 and @xmath142 .",
    "the plasma density profile was selected to be @xmath143 , where @xmath144 and @xmath145 .",
    "a set of basis functions was chosen with the number of radial grid points @xmath146 and inner region width @xmath147 .",
    "the convergence of the damping ratio @xmath148 using the iterative technique outlined in section [ sec : fem ] is shown in figure [ fig : iterative_convergence ] .",
    "after five iterations , it was estimated that the normalised frequency was @xmath149 , corresponding to a damping ratio of @xmath150 ( considering the case where the excised region had width @xmath151 ) . a decrease in the inner region to @xmath152 and",
    "an increase to @xmath153 altered the damping ratio by just @xmath154 and @xmath155 respectively . increasing",
    "the number of radial grid points used to @xmath156 and @xmath157 changed the damping ratio by just @xmath158 and @xmath159 respectively , indicating convergence had also occurred with respect to this parameter .",
    "the mode structure obtained for the latter resolution is shown in figure [ fig : tae ] . using a finite element complex contour method ,",
    "the normalised frequency computed was @xmath160 and hence the damping ratio was @xmath161 .",
    "the convergence of this result with respect to the deformation parameter @xmath162 is shown in figure [ fig : contour_convergence ] .",
    "the difference between the damping ratios computed using the contour and singular finite element techniques is @xmath163 .     damping ratio @xmath164 as a function of the width of the excised region @xmath165 over five iterations using the singular finite element method .",
    "after each iteration @xmath41 is updated based on the value of @xmath43 for @xmath166 .",
    "the blue circle , gold box , green triangle , orange inverted triangle and purple diamond markers correspond to the first , second , third , fourth and fifth iterations respectively .",
    "the damping ratio found using the complex contour method is indicated by the black line .",
    ", width=302 ]     mode structure for a tae  due to coupling of the @xmath136 and @xmath137 harmonics with complex frequency @xmath167 , found using the singular finite element method .",
    "solid lines represent real quantities and dashed lines represent imaginary quantities .",
    "the continuum resonance pole is located at @xmath168 .",
    "@xmath169 radial grid points were used with inner region width @xmath170 and excised region width @xmath151 . , width=302 ]     damping ratio as a function of the number of radial grid points @xmath90 for different contour deformation parameters @xmath162 , using the complex contour method .",
    "the blue circle , orange square and green triangle correspond to @xmath171 , @xmath172 and @xmath173 .",
    "the damping ratio found using the singular finite element method is indicated by the black line .",
    ", width=302 ]    while the boundary condition @xmath174 used here differs from that used by berk _ et al . _",
    "@xcite , introducing this condition does not alter the results obtained to within three significant figures . in the singular finite element solution , @xmath175 assumes an approximately constant value very close to the magnetic axis as required for regular solutions of equation [ eq : wave_equation ] near the origin . using a shooting method implementation of the contour method , discussed in @xcite , with the boundary conditions of berk _ et al .",
    "_ gives @xmath161 .",
    "we have described a singular finite element method which successfully reproduces the tae  frequency and continuum damping found using the complex contour method .",
    "as the continuum damping computed using the latter method has previously been shown to closely agree with the results of resistive mhd  @xcite , this agreement demonstrates the validity of the singular finite element method .",
    "the small errors in the results of these finite element methods are due to the limited accuracy inherent in approximating a solution with a limited number of finite elements . in the case of the singular finite element technique , these limitations arise due to the finite width of the singular and regular elements as well as the location of the pole used to construct the former .    the singular finite element technique presented here could be readily integrated into existing codes .",
    "this would be done by replacing standard finite elements with appropriate singular finite elements in the regions around continuum resonances .",
    "unlike the complex contour technique , it does not require analytic continuation of equilibrium quantities .",
    "this is advantageous as finite element plasma stability codes typically employ numerical representations of these quantities which are based on spline interpolation and do not have analytic continuations over the domain of interest @xcite .",
    "in contrast to the complex contour method , the singular finite element method calculates the mode structure for real values of the radial coordinate @xmath7 , rather than over a complex path in that variable . moreover , less resolution is required to solve eigenvalue equations in ideal mhdequations than resistive mhd .",
    "thus , the ideal mhd  singular finite element technique presented may allow calculation of continuum damping in more complicated geometries than has previously been practical , such as for stellarators .",
    "however , this singular finite element technique requires the user to demonstrate that the solution has converged with respect to four different parameters ( grid resolution , excised width , singular element width and location ) . in contrast , convergence with respect to two parameters is required in the resistive technique ( grid resolution and resistivity parameter ) and the complex contour technique ( grid resolution and contour deformation ) .",
    "we gratefully acknowledge the assistance provided by em . prof .",
    "r. l. dewar , particularly in suggesting that a finite element approach be taken to the problem of continuum damping in plasma .",
    "we would also like to acknowledge helpful discussions regarding the continuum damping problem with dr .",
    "g. r. dennis ."
  ],
  "abstract_text": [
    "<S> damping due to continuum resonances can be calculated using dissipation - less ideal magnetohydrodynamics ( mhd ) provided that the poles due to these resonances are properly treated . </S>",
    "<S> we describe a singular finite element technique for calculating the continuum damping of alfvn waves . a frobenius expansion is used to determine appropriate finite element basis functions on an inner region surrounding a pole due to the continuum resonance . </S>",
    "<S> the location of the pole due to the continuum resonance and mode frequency are calculated iteratively using a galerkin method . </S>",
    "<S> this method is used to find the complex frequency and mode structure of a toroidicity - induced alfvn eigenmode ( tae ) in a large aspect ratio circular tokamak and are shown to agree closely with a complex contour technique . </S>"
  ]
}