{
  "article_text": [
    "the origin of this work lies in two beautiful _ reciprocity theorems _ of ehrhart and macdonald .",
    "one attaches to a convex rational polytope @xmath0 two counting functions :  the number of integral points in @xmath1 and the sum of the solid angles in @xmath1 , as functions of a positive integer @xmath2 .",
    "these functions are quasi - polynomials in @xmath2 which have a life beyond the positive integers .",
    "namely , when evaluated at negative integers , they give the respective counting function for the _ interior _ of @xmath0 .",
    "our goal is to unify and generalize the integral - point and solid - angle counting functions , using the philosophy of valuations .",
    "our main tool is brion s theorem on conic decompositions of polytopes .",
    "a _ convex polyhedron _",
    "@xmath0 is the intersection of ( open or closed ) half - spaces in @xmath3 .",
    "we say @xmath0 is a _",
    "convex polytope _ if it is bounded , and @xmath0 is a _ cone _ if each hyperplane bounding the half - spaces that define @xmath0 contains the origin .",
    "to each integer point @xmath4 in a convex polyhedron @xmath0 we attach the _ tangent cone _ @xmath5 , defined as follows .",
    "denote the _",
    "characteristic function _ of a set @xmath6 by @xmath7 , that is , it is 1 for @xmath8 and 0 otherwise .",
    "let @xmath9 .",
    "then the tangent cone at @xmath10 is @xmath11 in other words , @xmath5 equals    * @xmath3 if @xmath10 is in the interior of @xmath0 ; * @xmath12 if @xmath10 is not in the closure of @xmath0 ; * the intersection of the halfspaces defining a face @xmath13 if @xmath10 is on the face @xmath13 of @xmath0 , shifted to the origin .",
    "a _ lattice of sets _ is a collection @xmath14 of sets , partially ordered by set inclusion , such that for any two sets @xmath15 @xmath16 a function @xmath17 on @xmath14 with values in some abelian group is a _ valuation _",
    "( often called a _ finitely additive measure _ ) if for any @xmath15 @xmath18 we consider the lattice @xmath14 generated by ( open , closed , half - open ) cones .",
    "we define @xmath19 as the valuation @xmath17 evaluated at the tangent cone @xmath5 .",
    "this is a valuation when viewed as a function of @xmath0 .",
    "however , we will mostly be interested in @xmath19 as a function in @xmath10 .",
    "the counting function we study is @xmath20 initially defined for positive integers @xmath2 .",
    "this function only makes sense if @xmath0 is bounded , that is , @xmath0 is a convex polytope . in order to state our main theorem , recall that a _ quasi - polynomial _",
    "@xmath21 of _ degree _ @xmath22 as an expression of the form @xmath23 where @xmath24 are periodic functions of @xmath2 and @xmath25 .",
    "the least common multiple of the periods of the @xmath26 is called the _ period _ of @xmath21 .",
    "the _ denominator _ of the polytope @xmath0 is the least common multiple of the denominators of the vertices of @xmath0 .",
    "we denote the relative interior of @xmath0 by @xmath27 .",
    "[ t : mainthm ] for any closed convex rational @xmath22-polytope , @xmath28 is a quasi - polynomial in @xmath2 of degree  @xmath22 .",
    "the period of @xmath28 divides the denominator of @xmath0 .",
    "in particular , if @xmath0 has integer vertices then @xmath29 is a polynomial .",
    "its evaluation at negative integers gives @xmath30    our motivation for studying the function @xmath28 comes from special cases of valuations .",
    "the first example is @xmath31 in this case @xmath28 counts the number of integer points in @xmath32 and theorem  [ t : mainthm ] specializes to the following fundamental theorem due to ehrhart  @xcite .",
    "note that @xmath33 .",
    "[ c : ehrhart ] if @xmath34 is a closed convex rational @xmath22-polytope , then @xmath35 is a quasi - polynomial of degree @xmath22 , having period that divides the denominator of @xmath0 . in particular ,",
    "if @xmath0 has integer vertices , then @xmath36 is a polynomial .",
    "the evaluation of @xmath37 at negative integers gives @xmath38    the _ reciprocity law _",
    "( [ e : ehrrec ] ) , conjectured and partially proved by ehrhart , was in its full generality first proved by macdonald  @xcite .",
    "the second example of a valuation is @xmath39 that is , the ratio of the volumes of @xmath40 and @xmath41 , where @xmath41 is a sufficiently small @xmath22-ball centered at the origin .",
    "now @xmath28 counts the integer points in @xmath32 weighted by their solid angle in @xmath1 .",
    "theorem  [ t : mainthm ] specializes to the following fundamental theorem due to macdonald  @xcite .",
    "note again that @xmath33 .",
    "[ c : macdonald ] suppose @xmath0 is a convex rational @xmath22-polytope .",
    "let @xmath42 be the sum of the solid angles of @xmath1 at all integer points .",
    "then @xmath43 is a quasi - polynomial of degree @xmath22 , whose period divides the least common multiple of the denominators of the vertices of @xmath0 .",
    "the evaluation of @xmath43 at negative integers gives @xmath44 in particular , if @xmath0 has integer vertices , then @xmath45 is a polynomial which is either even or odd .",
    "it is not hard to conclude the first half of macdonald s theorem from ehrhart s theorem ( corollary  [ c : ehrhart ] ) , since all integer points in a given face of @xmath0 have the same solid angle .",
    "the nontrivial part is equation ( [ e : macrec ] ) .    a third example of a valuation is as follows .",
    "fix a vector @xmath46 , and let @xmath47 this time @xmath28 counts those integer points @xmath10 that after a small step in direction @xmath48 will be in @xmath1",
    ". note that , in particular , @xmath49 .",
    "theorem  [ t : mainthm ] specializes to the following statement .",
    "let @xmath50 and @xmath51 .",
    "suppose @xmath0 is a convex rational @xmath22-polytope and @xmath48 is a fixed vector in @xmath3",
    ". then @xmath52 is a quasi - polynomial of degree @xmath22 .",
    "the period of @xmath52 divides the least common multiple of the denominators of the vertices of @xmath0 .",
    "in particular , if @xmath0 has integer vertices , then @xmath53 is a polynomial .",
    "the evaluation of @xmath53 at negative integers gives @xmath54    we conceived theorem  [ t : mainthm ] when we realized that ehrhart s and macdonald s theorems ( corollaries  [ c : ehrhart ] and  [ c : macdonald ] ) follow very naturally from a theorem of brion  @xcite , which in itself can be thought of as a consequence of a theorem due to brianchon  @xcite and gram  @xcite .",
    "to state these results , we need to introduce a few notions of polyhedral geometry in the next section . by no means",
    "do we claim that our approach is the easiest to corollaries  [ c : ehrhart ] and  [ c : macdonald ] ; our goal is merely to show the intimate connections of these results .",
    "another such connection is given by barvinok s result  @xcite , which uses brion s theorem to conclude that in fixed dimension , the generating function of an ehrhart quasi - polynomial is polynomial - time computable .",
    "given a @xmath22-dimensional closed convex polyhedron @xmath55 , the hyperplane @xmath56 is a _ supporting hyperplane _ of @xmath57 if @xmath58 and @xmath0 lies entirely on one side of @xmath59 , that is , @xmath60 or @xmath61 .",
    "a _ face _ of @xmath57 is a set of the form @xmath62 , where @xmath59 is a supporting hyperplane of @xmath0 .",
    "note that both @xmath57 itself and the empty set are faces of @xmath57 .",
    "the @xmath63-dimensional faces are called _ facets _ , the 1-dimensional faces _ edges _ , and the 0-dimensional faces _ vertices _ of @xmath0 .    for a vertex @xmath48 of @xmath0 , we define the _ affine vertex cone _ @xmath64 as the shifted cone @xmath65 .    the _",
    "integer generating function _",
    "@xmath66 of a convex polyhedron @xmath0 is @xmath67 here we view @xmath68 as a @xmath22-dimensional complex variable .",
    "a polyhedron is _ rational _ if each of its defining halfspaces can be described as @xmath69 for some @xmath70 and @xmath71 .",
    "if @xmath0 is a rational polyhedron then @xmath72 can be written as a rational function in @xmath73 ( see , for example , @xcite ) .",
    "the following theorem can be derived , for example , from the brianchon - gram theorem  @xcite ; this is shown in  @xcite .",
    "the original proof of brion is in  @xcite ; other , more elementary proofs can be found in  @xcite .",
    "[ t : brion ] for a convex rational polytope @xmath74 , represent the generating functions of the vertex cones @xmath64 as rational functions .",
    "then @xmath75    we need to extend brion s theorem to our more general setting , albeit for our purposes we only need a version for simplices .",
    "our extension concerns the generating function for the valuation @xmath76 , that is , @xmath77 this is a rational function because @xmath19 is constant on faces .",
    "[ t : brionext ] suppose @xmath78 is a rational simplex and @xmath17 is a valuation .",
    "then , as rational functions , @xmath79    in what follows , we adjust a valuation - based proof of brion s theorem given in  @xcite to our more general setting .",
    "suppose @xmath78 is a rational @xmath22-simplex .",
    "the hyperplanes bounding @xmath78 divide @xmath3 into regions .",
    "these regions are in one - to - one correspondence with the non - empty faces of @xmath78 , namely the closure of each region touches a unique maximal face of @xmath78 .",
    "denote the region corresponding to the face @xmath13 by @xmath80 .",
    "we orient the hyperplanes in such a way that they point towards @xmath78 .",
    "thus @xmath81 is closed , the region corresponding to a vertex is open , and all the other regions are half open .",
    "let @xmath82 be the union of regions corresponding to subfaces of a face @xmath83 , that is , @xmath84 the set @xmath82 is a convex polyhedron that contains a line , except when @xmath13 is a vertex . because @xmath17 is a valuation , the generating function @xmath85 satisfies , @xmath86 now unless @xmath13 is a vertex , @xmath85 is zero : there is an integer vector @xmath10 such that @xmath87 ; but @xmath88 is not a zero divisor in the ring of rational functions in @xmath68 . in summary",
    ", we have @xmath89 by inclusion - exclusion , @xmath90 again using that @xmath17 is a valuation , we have @xmath91 this completes the proof .",
    "theorem  [ t : brionext ] can be extended to general convex polytopes using the valuation theorems of the next section .",
    "since we do not need the general case to prove our main theorem , we leave the proof to the reader .",
    "suppose @xmath0 is a convex rational polytope and @xmath17 is a valuation .",
    "as rational functions , we have the identity @xmath92",
    "a subset @xmath93 of a lattice @xmath14 is a _ generating set _ if @xmath93 is closed under intersection and every element of @xmath14 is the union of elements of @xmath93 .",
    "the following _ extension theorem _ is due to groemer  @xcite and generalizes a valuation theorem for polyhedra due to volland  @xcite .",
    "[ t : groemer ] suppose @xmath93 generates the lattice @xmath14 , and @xmath17 is a function on @xmath93 that satisfies @xmath94 whenever @xmath95",
    ". then @xmath17 extends uniquely to a valuation on @xmath14 .",
    "a _ ( rational ) polytope _ is the union of finitely many open or closed convex ( rational ) polytopes .",
    "we apply groemer s theorem as follows .",
    "given a ( rational ) polytope @xmath0 , fix a triangulation of @xmath0 into ( rational ) simplices .",
    "let @xmath96 denote the set of all unions of faces of these simplices .",
    "hence @xmath96 is a lattice , whose top element is @xmath0 .",
    "the generating set of @xmath96 consists of the simplices of the triangulation and their faces , which are also simplices .",
    "the union of @xmath97 faces @xmath98 is again a face if only if one of the faces @xmath99 contains all the others .",
    "in this situation the condition of groemer s theorem , theorem  [ t : groemer ] , is directly satisfied .",
    "this means that we can define a function arbitrarily on the faces of the triangulation , and this function will extend uniquely to a valuation on @xmath96 .",
    "moreover , the values on elements of @xmath96 are given by an iterated application of the inclusion - exclusion formula ( [ inclexcl ] ) .",
    "in particular :    [ vollcor ] two valuations that agree on all ( rational ) simplices agree on all ( rational ) polytopes .",
    "this result is useful to us , since @xmath100 is a valuation as a function of @xmath0 .",
    "because of corollary  [ vollcor ] , it is enough to prove theorem  [ t : mainthm ] for simplices",
    ". without loss of generality we may assume that the simplex @xmath78 has the same dimension as the space it lies in .",
    "hence suppose @xmath78 is a rational @xmath22-simplex in @xmath101 , whose vertices have coordinates with denominator @xmath102 .",
    "we will prove the reciprocity identity ( [ e : mainrec ] ) for the function @xmath103 for a fixed  @xmath104 .",
    "the fact that @xmath103 is a polynomial in @xmath2 will be recovered in passing .    by theorem  [ t :",
    "brionext ] , @xmath105 so we need to look at the integer generating functions for @xmath106-dilates of cones more closely . for a vertex @xmath48 of @xmath78 , suppose @xmath107 for some integer vectors @xmath108 ; then @xmath109 note that @xmath110 is an integer vector .",
    "now let @xmath111 denote the rational function equal to the integer generating function of @xmath112 ; because this cone is simple , @xmath111 is easy to write down : let @xmath113 , then @xmath114 whence @xmath115 note that we are using the fact that @xmath17 is a valuation . for the open cone @xmath116",
    "we obtain , completely analogously , @xmath117 where @xmath118 { { \\bf w}}_k$ ] .    from the form of these generating functions , we can immediately conclude that @xmath119 is a polynomial in @xmath2 which implies that @xmath120 is a quasi - polynomial : we know that the sum of the generating functions of all vertex cones is a polynomial in the variables of @xmath68 , hence the singularities of the rational functions cancel . to compute @xmath121",
    "we can write all the rational functions on the right - hand side over one denominator and use lhospital s rule to compute the limit . the result is a polynomial in @xmath2 , as we simply evaluate @xmath68 at 1 after using lhospital s rule the correct number of times .    to prove the reciprocity law",
    ", we relate the geometry of @xmath122 with the geometry of @xmath123 .",
    "this geometry depends on @xmath104 ; let us include this dependency in our notation . recall that @xmath124 and @xmath125 { { \\bf w}}_k \\ .\\ ] ] the two half - open parallelepipeds relate as @xmath126 as illustrated in figure  [ parallel ] . using the notation @xmath127 , we have @xmath128 which allows us to rephrase ( [ e : parallel ] ) as @xmath129     bottom : @xmath130    now by the extended brion - theorem for simplices ( theorem  [ t : brionext ] ) and the rational generating functions for simple cones , @xmath131",
    "there exists a slightly more general version of our main theorem  [ t : mainthm ] .",
    "namely , instead of @xmath0 one can take @xmath27 together with some facets of @xmath0 .",
    "then @xmath27 on the other side of the reciprocity identity gets replaced by @xmath27 together with the remaining facets .",
    "this parallels a theorem of stanley which generalizes ehrhart - macdonald reciprocity  @xcite .",
    "there is also a theorem analogous to brion s for polyhedra ( not just polytopes ) .",
    "our proof goes through in this case once one allows _",
    "unbounded simplices _ , which result when one moves a certain face of a simplex to infinity .",
    "( any polyhedron can be triangulated into bounded and unbounded simplices . )"
  ],
  "abstract_text": [
    "<S> for a convex polytope @xmath0 with rational vertices , we count the number of integer points in integral dilates of @xmath0 and its interior . </S>",
    "<S> the ehrhart - macdonald reciprocity law gives an intimate relation between these two counting functions . </S>",
    "<S> a similar counting function and reciprocity law exists for the sum of all solid angles at integer points in dilates of @xmath0 . we derive a unifying generalization of these reciprocity theorems which follows in a natural way from brion s theorem on conic decompositions of polytopes . </S>"
  ]
}