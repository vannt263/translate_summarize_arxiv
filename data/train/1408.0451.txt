{
  "article_text": [
    "given a finite or infinite word @xmath1 , let @xmath0 ( resp .",
    "@xmath13 ) denote the _ factor complexity function _",
    "the _ palindromic complexity function _ ) of @xmath1 , which associates with each integer @xmath14 the number of distinct factors ( resp .",
    "palindromic factors ) of @xmath1 of length @xmath2 .",
    "the well - known _ infinite sturmian words _ are characterized by both their factor complexity and palindromic complexity . in 1940",
    "morse and hedlund  @xcite established that an infinite word @xmath15 is sturmian if and only if @xmath16 for each @xmath14 .",
    "almost half a century later , in 1999 , droubay and pirillo  @xcite showed that an infinite word @xmath15 is sturmian if and only if @xmath17 whenever @xmath2 is even , and @xmath18 whenever @xmath2 is odd .",
    "in the same year , de  luca  @xcite studied the factor complexity function of finite words and showed , in particular , that if @xmath1 is a _ finite sturmian word _ ( meaning a factor of an infinite sturmian word ) , then the graph of @xmath0 as a function of @xmath2 ( for @xmath19 , where @xmath4 denotes the _ length _ of @xmath1 ) is that of a regular trapezoid ( or possibly an isosceles triangle ) .",
    "that is , @xmath0 increases by @xmath20 with each @xmath2 on some interval of length @xmath6 , then @xmath0 is constant on some interval of length @xmath7 , and finally @xmath0 decreases by @xmath20 with each @xmath2 on an interval of the same size @xmath6 .",
    "such a word is said to be _",
    "trapezoidal_. since @xmath8 , any trapezoidal word is necessarily on a binary alphabet .    in this paper , we study combinatorial and structural properties of the following natural generalization of trapezoidal words over an arbitrary finite alphabet .",
    "[ d : trapezoidal ] a finite word @xmath1 with _ alphabet _ @xmath21 , @xmath22 , is said to be a * _ generalized trapezoidal word _ * ( or * _ gt - word _ * for short )",
    "if there exist positive integers @xmath23 , @xmath24 with @xmath25 such that the factor complexity funtion @xmath0 of @xmath1 increases by @xmath20 for each @xmath2 in the interval @xmath26 $ ] , is constant for each @xmath2 in the interval @xmath27 $ ] , and decreases by 1 for each @xmath2 in the interval @xmath28 $ ] .",
    "that is , @xmath1 is a gt - word if there exist positive integers @xmath23 , @xmath24 with @xmath25 such that @xmath29 satisfies the following :    [ cols= \" < , < \" , ]     where @xmath30 and @xmath31 .",
    "moreover , @xmath32 and the maximal value of @xmath29 is @xmath33 .",
    "( @xmath34 ) : suppose that @xmath35 .",
    "we first consider the case @xmath36 so that @xmath37 and @xmath38 . by proposition  [ p : deluca1 ] , we know that @xmath29 is strictly increasing on the interval @xmath39 $ ] and is constant on the interval @xmath40 $ ] , and then strictly decreasing on the interval @xmath41 $ ] ; in particular , @xmath42$}.\\ ] ] it remains to show that @xmath43 for @xmath44 $ ] . since @xmath45",
    ", we have @xmath46 for @xmath44 $ ] , so @xmath47 , and in fact , we have @xmath48 . indeed , from equation   and the hypothesis @xmath49",
    ", we deduce that @xmath50 hence , since @xmath51 , it follows that @xmath52 .",
    "this implies that @xmath53 for @xmath54 $ ] . for if not , then there exists an @xmath55 such that @xmath56 and @xmath57 for @xmath58 ( e.g. , see @xcite ) implying that @xmath59 which is impossible because @xmath48 .",
    "now let us consider the case @xmath60 , so that @xmath61 and @xmath62 . by proposition  [ p : deluca1 ] , we know that @xmath29 is strictly increasing on the interval @xmath63 $ ] and is non - decreasing on the interval @xmath64 $ ] , and then strictly decreasing on the interval @xmath65 $ ] ; in particular , @xmath66$}.\\ ] ] moreover , by the hypothesis @xmath49 , it is easy to see that the maximal value of the complexity is @xmath67 .",
    "but since @xmath60 , we have @xmath68 , and therefore , @xmath69 . using a similar argument to that used in the previous case",
    ", it follows that @xmath53 for @xmath70 $ ] .",
    "( @xmath71 ) : to prove the converse statement , let us first suppose that @xmath60 .",
    "then by assumption , @xmath53 for @xmath72 $ ] , and so @xmath73 .",
    "moreover , since @xmath74 for @xmath75 $ ] , it follows that @xmath51 .",
    "furthermore , by the condition @xmath76 for @xmath77 $ ] , we have @xmath78 .",
    "hence , @xmath79 , i.e. , @xmath49 . on the other hand , if we suppose now that @xmath80 , we easily deduce from the hypothesis that @xmath81 , and therefore @xmath49 .",
    "[ c : rk - condition ] suppose @xmath1 is a non - empty finite word .",
    "if @xmath82 , then @xmath1 is a gt - word .    in the case",
    "when @xmath83 , the result follows immediately from theorem  [ t : rk - characterization ] . it remains to consider the case when @xmath84 .",
    "any such word has length equal to @xmath85 where @xmath86 and @xmath87 , and clearly all such words are gt - words since the graphs of their complexity functions , being constant , satisfy the trapezoidal property ( see remark  [ r : one - letter - words ] ) .",
    "it should be noted here that we are using a slightly different convention for @xmath88 compared to @xcite ; in that paper , a power of a letter had @xmath89 , not @xmath20 , since the empty word was considered to be a factor that is not right special in such a word .",
    "however , our convention ( defining @xmath88 to be the smallest _ positive _ integer such that @xmath1 does not have a right special factor of length @xmath88 ) allows us to view single - letter words as gt - words satisfying the rk - condition .",
    "let @xmath1 be a finite word with @xmath21 , @xmath22 .",
    "a factor @xmath90 of @xmath1 is said to be _ right - extendable _ if there exists a letter @xmath91 such that @xmath92 is a factor of @xmath1 and @xmath90 is said to have _ right - valence _",
    "@xmath93 if @xmath90 is right - extendable in @xmath1 by @xmath94 distinct letters ( e.g. , see @xcite ) .",
    "_ left special factors _ , _ left - extendable factors _ , and _ left - valences _ are all similarly defined .",
    "a factor of @xmath1 is said to be _ bispecial _ if it is both left and right special .",
    "clearly , any left ( resp .",
    "right ) special factor has left ( resp .",
    "right ) valence at least @xmath95 . in the case when @xmath96 , left and right special factors have valences equal to @xmath95 since any factor of a word is only extendable to the left or right in at most two different ways .    for the subset of gt - words satisfying the rk - condition , we have the following consequence of theorem  [ t : rk - characterization ] and proposition  [ p : deluca1 ] .",
    "[ p : right - special - characterization ] suppose @xmath1 is a finite word with @xmath83 .",
    "then @xmath97 if and only if there exists exactly one right special factor of @xmath1 of length  @xmath98 for every ( non - negative ) integer @xmath99 and each non - empty right special factor of @xmath1 has right - valence @xmath95 .",
    "( @xmath34 ) : let @xmath97 , @xmath100 , and @xmath101 .",
    "suppose @xmath1 contains two distinct right special factors of the same length @xmath98 for some @xmath99 .",
    "if @xmath102 , then since each factor of @xmath1 of length less than @xmath23 is right - extendable in @xmath1 , we would have @xmath103 , contradicting the fact that @xmath104 for each @xmath105 $ ] by theorem  [ t : rk - characterization ] . on the other hand , if @xmath106 ( in which case @xmath61 and @xmath62 ) , then there being two distinct right special factors of length @xmath98 implies that @xmath107 . indeed , since all factors of length @xmath98 of @xmath1 , except the suffix of @xmath1 of length @xmath98 , are right - extendable in @xmath1 , the two different right special factors of length @xmath98 would increase the complexity of @xmath1 by at least @xmath20 when going from factors of length @xmath98 to factors of length @xmath108 . but",
    "this contradicts that fact that @xmath29 must be constant on the interval @xmath64 $ ] by theorem  [ t : rk - characterization ] .",
    "so @xmath1 contains exactly one right special factor of each length @xmath99 .",
    "furthermore , using similar reasoning as above , we deduce that all non - empty right special factors of @xmath1 must have right - valence @xmath95 .",
    "( @xmath71 : ) conversely , if @xmath1 contains exactly one right special of each length @xmath99 with each non - empty right special factor having right - valence @xmath95 , then using proposition  [ p : deluca1 ] , we deduce that @xmath29 must satisfy the conditions in theorem  [ t : rk - characterization ] , and hence @xmath82 .",
    "recall that binary trapezoidal words are precisely those that satisfy @xmath109 ( see @xcite ) , so proposition  [ p : right - special - characterization ] ( above ) applies to all binary trapezoidal words , but it is not true in general for all gt - words @xmath1 with @xmath110 ( only those that satisfy the rk - condition ) .",
    "for instance , the gt - word @xmath111 does not satisfy the rk - condition ( since @xmath112 , @xmath113 , and @xmath114 ) and it has two different right special factors of length @xmath20 ( namely the letters @xmath115 and @xmath116 ) .",
    "we also note that gt - words that do not satisfy the rk - condition can also contain right special factors with right - valences greater than @xmath95 ( and also left special factors with left - valences greater than @xmath95 ) .",
    "for example , in the gt - word @xmath117 ( which does not satisfy the rk - condition ) , the letter @xmath115 is a right special factor with right - valence  @xmath118 .",
    "the letters @xmath116 and @xmath119 are each right - extendable only by the letter @xmath115 in @xmath90 , whereas the letter @xmath120 is not right - extendable as a factor of @xmath90 , so there is only a jump of @xmath20 between @xmath121 and @xmath122 .    as introduced by de  luca  @xcite , one can define two parameters , @xmath123 and @xmath124 , analogous to @xmath88 and @xmath125 , when considering left factors instead of right factors . specifically , for a given finite word @xmath1 with @xmath83 , @xmath123 is defined to be the smallest positive integer @xmath126 such that @xmath1 has no left special factor of length @xmath126 and @xmath124 is the shortest unrepeated prefix of @xmath1 . in ( * ? ? ?",
    "* proposition  4.6 ) , de  luca proved that any finite word @xmath1 satisfies @xmath127 and also @xmath128 .",
    "moreover , @xmath129 and @xmath130 ( * ? ? ?",
    "* corollary  4.1 ) .    using the _ dual _ of proposition  [ p : deluca1 ] , in which @xmath88 is replaced by @xmath123 and @xmath125 is replaced by @xmath124 ( see @xcite ) , we can prove ( in a symmetric way ) the corresponding dual of theorem  [ t : rk - characterization ] , and subsequently we have the following dual of proposition  [ p : right - special - characterization ] .",
    "[ p : left - special - characterization ] suppose @xmath1 is a finite word with @xmath83",
    ". then @xmath131 if and only if there exists exactly one left special factor of @xmath1 of length  @xmath98 for every ( non - negative ) integer @xmath132 and each non - empty left special factor of @xmath1 has left - valence @xmath95 .    the following useful result of de luca  @xcite concerns the structure of right and left special factors of maximal length of a given word @xmath1 with respect to the parameters @xmath88 , @xmath125 , @xmath123 , and @xmath124 .",
    "[ p : deluca4.5 ] ( * ? ? ?",
    "* proposition  4.5 ) suppose @xmath1 is a word and @xmath90 is a right ( left ) special factor of @xmath1 of maximal length .",
    "then @xmath90 is either a prefix ( suffix ) of @xmath1 or bispecial . if @xmath133 ( @xmath134 ) , then @xmath90 is bispecial .",
    "the next result is a refinement of ( * ? ? ?",
    "* proposition  4.6 ) .",
    "[ p : r+k&l+h ] suppose @xmath1 is a non - empty finite word .",
    "then @xmath135    we will prove only the first inequality since the second one is proved by a symmetric argument . if @xmath136 , then @xmath137 and @xmath87 , so @xmath82 .",
    "now suppose that @xmath83 and let @xmath100 , @xmath138 .",
    "since @xmath139 , it follows from proposition  [ p : deluca1 ] that @xmath140 for @xmath141 , and so @xmath142 .",
    "moreover , since @xmath143 for all integers @xmath144 $ ] , we have @xmath145 .",
    "furthermore , by proposition  [ p : deluca1 ] , we have @xmath76 for all integers  @xmath146 $ ] , and therefore @xmath147 . hence @xmath148    let @xmath149 denote the number of occurrences of a letter @xmath150 in a non - empty finite word @xmath1 .",
    "[ d : heart ] let @xmath1 be a non - empty finite word .",
    "suppose that @xmath6 is the longest ( possibly empty ) prefix of @xmath1 such that @xmath151 for all @xmath152 and that @xmath7 is the longest ( possibly empty ) suffix of @xmath1 such that @xmath151 for all @xmath153 .",
    "if @xmath154 , then there exists a unique ( non - empty ) word @xmath155 with @xmath156 such that @xmath157 and we call @xmath155 the * _ heart _ * of @xmath1 . otherwise , if @xmath158 , then @xmath159 and we define the * _ heart _ * of @xmath1 to be itself .    roughly speaking , for any finite word @xmath1 with @xmath154 ( i.e. , for any finite word @xmath1 that contains at least two occurrences of some letter ) , the heart of @xmath1 is defined to be the unique ( non - empty ) factor of @xmath1 that remains if we delete the longest prefix and the longest suffix of @xmath1 that contain letters only occurring once in @xmath1 .",
    "equivalently , the _ heart _ of a non - empty finite word @xmath1 is the unique ( non - empty ) factor @xmath155 of @xmath1 such that @xmath157 where @xmath160 is the longest prefix of @xmath1 such that @xmath161 and @xmath162 is the longest suffix of @xmath1 such that @xmath163 , i.e. , @xmath164 is the longest prefix of @xmath165 such that @xmath166 ( where @xmath167 denotes the _ reversal _ of a given word  @xmath90 ) .",
    "consider the word @xmath168 . by deleting from @xmath1 the longest prefix and the longest suffix that contain letters only occurring once in @xmath1",
    ", we determine that the heart of @xmath1 is @xmath169 .",
    "we also observe that @xmath1 can be expressed as @xmath157 with @xmath170 , @xmath171 , and where @xmath172 is the longest prefix of @xmath1 such that @xmath161 and @xmath173 is the longest suffix of @xmath1 such that @xmath163 .",
    "note that the word @xmath1 is a generalized trapezoidal word with @xmath174 and @xmath113 , and we see that @xmath175 ( where @xmath176 and @xmath177 ) ; in fact , this condition characterizes gt - words ( see theorem  [ t : characterization1-take2 ] in the next section ) .",
    "[ r : binary - heart ] all binary trapezoidal words are equal to their own hearts , except those of the form @xmath178 or @xmath179 where @xmath115 , @xmath116 are distinct letters and @xmath180 is an integer .",
    "such ( binary ) trapezoidal words have hearts of the form @xmath181 for some letter @xmath182 .",
    "we also note that any word @xmath1 with @xmath183 , i.e. , any word @xmath1 that is a product of mutually distinct letters , is a gt - word ( such a word @xmath1 has @xmath137 and @xmath184 and therefore satisfies the rk - condition ) .",
    "the next result generalizes ( * ? ? ? * proposition  4.8 ) .",
    "[ p : rklh ] let @xmath1 be a non - empty finite word with heart @xmath155 . if @xmath175 , then @xmath185    we first observe that if @xmath175 , then @xmath186 because , by definition of the heart @xmath155 of @xmath1 , @xmath187 , i.e. , @xmath188 .",
    "the result is trivial if @xmath189 because , in this case , @xmath190 and @xmath191 .",
    "so we will henceforth assume that @xmath192 .    by ( * ? ? ?",
    "* corollary  4.1 ) , @xmath193 and @xmath194 .",
    "hence , since any finite word @xmath155 satisfies @xmath195 ( by proposition  [ p : r+k&l+h ] ) , we deduce that @xmath196 . indeed",
    ", we have @xmath197 and thus @xmath198 .",
    "suppose that @xmath199 . then , by ( * ? ? ?",
    "* corollary  4.1 ) , @xmath200 , and thus , since @xmath196 , we have @xmath201 .",
    "furthermore , since @xmath199 , it follows from theorem  [ t : rk - characterization ] and the dual statement of proposition  [ p : deluca1 ] ( with @xmath202 and @xmath203 instead of @xmath204 and @xmath205 ) that @xmath206 .",
    "this implies that @xmath207 because @xmath208 for @xmath209 .",
    "but , as deduced above , @xmath201 ; thus we must have @xmath210 , and hence @xmath211 .",
    "let us now suppose that @xmath212 . then , since @xmath198 , we have @xmath213 . we wish to show that @xmath214 .",
    "suppose not , i.e. , suppose @xmath215 .",
    "let @xmath216 .",
    "since @xmath155 is a ( generalized trapezoidal ) word satisfying the rk - condition , it follows from proposition  [ p : right - special - characterization ] that there exists exactly one right special factor of @xmath155 of length  @xmath98 for every non - negative integer @xmath102 , with each right special factor having right - valence  @xmath95 .",
    "likewise , there must exist exactly one left special factor of @xmath155 of length  @xmath98 for every non - negative integer @xmath102 ( where @xmath217 ) , with each left special factor having left - valence  @xmath95 .",
    "but this implies that @xmath218 , contradicting the fact that the complexity function of @xmath155 satisfies @xmath219 by theorem  [ t : rk - characterization ] .",
    "hence we must have @xmath214 .",
    "finally , since we have @xmath220 and also @xmath221 , it easily follows that @xmath222 , and hence @xmath223 .",
    "we have the following easy consequence of proposition  [ p : rklh ] .",
    "[ c : l&h ] let @xmath1 be a non - empty finite word with heart @xmath155",
    ". then @xmath175 if and only if @xmath223 .",
    "if a word @xmath1 satisfies the @xmath224-condition @xmath82 ( with @xmath88 and @xmath125 instead of @xmath204 and @xmath205 ) , it is not necessarily true that @xmath225 ( and vice versa ) .",
    "for example , the word @xmath226 of length @xmath227 is a gt - word with complexity sequence @xmath228 .",
    "this gt - word has @xmath229 , @xmath230 , and @xmath231 . on the other hand , @xmath232 , @xmath233 , and @xmath234 .",
    "however , we see that @xmath235 and @xmath236 where @xmath237 is the heart of @xmath90 with @xmath238 .    in ( * ? ?",
    "* corollary  5.3 ) , de luca proved that the minimal period length @xmath239 of any finite word @xmath1 satisfies @xmath240 , and moreover , if @xmath241 , then @xmath109 .",
    "the following proposition gives a refinement of that result .",
    "[ p : min - period ] suppose @xmath1 is a non - empty finite word with minimal period length @xmath239",
    ". then @xmath242",
    ". moreover , if @xmath243 , then @xmath82 .    for any finite word @xmath1 with minimal period length @xmath239",
    ", we have @xmath244 ( * ? ? ?",
    "* proposition  5.1 ) , and by proposition  [ p : r+k&l+h ] , @xmath245 .",
    "hence @xmath242 . furthermore ,",
    "if @xmath243 , then it follows from ( * ? ? ?",
    "* proposition  5.1 ) that @xmath246 , and therefore @xmath82 by proposition  [ p : r+k&l+h ] .",
    "we are now ready to prove our main results about gt - words .",
    "[ t : characterization1-take2 ] suppose @xmath1 is a non - empty finite word with heart @xmath155 . then @xmath1 is a gt - word if and only if @xmath175 .",
    "the gt - word @xmath247 does not satisfy the @xmath224-condition , but it does satisfy the following condition in terms of its heart @xmath155 : @xmath248 indeed , @xmath249 with @xmath250 , @xmath251 , and @xmath252 .",
    "the following lemma is needed for the proof of theorem  [ t : characterization1-take2 ] .",
    "[ l : k!=1 ] suppose @xmath1 is a non - empty finite word with heart @xmath155 . then @xmath1 is a gt - word if and only if @xmath155 is a gt - word .",
    "moreover , when @xmath1 ( or equivalently @xmath155 ) is a gt - word , the maximal interval @xmath253 $ ] on which @xmath29 is constant is equal to the maximal interval @xmath254 $ ] on which @xmath255 is constant , i.e. , @xmath256 and @xmath257 .",
    "if @xmath258 , we are done .",
    "so suppose @xmath259 .",
    "then @xmath260 and we have @xmath261 where @xmath6 and @xmath7 are maximal such that @xmath151 for all @xmath262 .",
    "we distinguish three cases : @xmath263 ( where @xmath7 is non - empty ) , @xmath264 ( where @xmath6 is non - empty ) , or @xmath157 ( where both @xmath6 and @xmath7 are non - empty ) .",
    "the latter two cases ( when @xmath264 or @xmath157 ) are proved similarly to the first case ( when @xmath263 ) , so we consider only that case . by definition of @xmath155 and @xmath7 , there exist distinct letters @xmath265 such that @xmath266 ( i.e. , @xmath267 ) where @xmath268 . hence , @xmath269 for @xmath270 .",
    "now suppose @xmath1 is a gt - word .",
    "let @xmath271 $ ] be the maximal interval on which @xmath29 is constant and let @xmath254 $ ] be the maximal interval on which @xmath255 is constant .",
    "then since @xmath272 for @xmath270 , we see that @xmath255 increases by 1 with each @xmath2 in the interval @xmath273 $ ] , is constant on the interval @xmath271 $ ] , and decreases by 1 with each @xmath2 in the interval @xmath274 $ ] .",
    "so @xmath155 is a gt - word , and moreover @xmath275 and @xmath276 .",
    "conversely , suppose @xmath155 is a gt - word .",
    "then since @xmath277 for @xmath270 , we see that @xmath29 increases by 1 with each @xmath2 in the interval @xmath278 $ ] , is constant on the interval @xmath279 $ ] , and decreases by 1 with each @xmath2 in the interval @xmath280 $ ] .",
    "moreover , by proposition  [ p : deluca1 ] , @xmath29 must continue to decrease by @xmath20 with each @xmath2 in the interval @xmath281 $ ] .",
    "thus , @xmath1 is a gt - word and @xmath256 , @xmath257 .",
    "( @xmath71 ) : first suppose that @xmath282 where @xmath155 is the heart of @xmath1 . by definition of @xmath155 , @xmath187",
    ", so @xmath186 .",
    "hence , @xmath155 is a gt - word by corollary  [ c : rk - condition ] , and therefore @xmath1 is also a gt - word by lemma  [ l : k!=1 ] .",
    "( @xmath34 ) : conversely , suppose @xmath1 is a gt - word .",
    "if @xmath183 ( i.e. , if @xmath1 is a product of mutually distinct letters ) , then @xmath283 ( by definition  [ d : heart ] ) and such a gt - word has @xmath284 and @xmath285 ; whence @xmath286 .",
    "so we will henceforth assume that @xmath154 , in which case @xmath287 .    since @xmath1 is a gt - word ,",
    "so too is @xmath155 by lemma  [ l : k!=1 ] .",
    "it suffices to show that @xmath186 because it follows from this equality that @xmath175 by noting that @xmath187 .    if @xmath189 , then @xmath288 and @xmath289 , and hence @xmath186 .",
    "now suppose that @xmath192 and let @xmath254 $ ] denote the maximal interval on which @xmath255 is constant .",
    "if @xmath290 , then by proposition  [ p : deluca1 ] ( and the fact that @xmath155 is a gt - word ) , the complexity @xmath255 of @xmath155 satisfies the conditions of theorem  [ t : rk - characterization ] with @xmath291 and @xmath292 ; whence @xmath293 . on the other hand , if @xmath294 , then @xmath295 ( by proposition  [ p : deluca1 ] again ) and we claim that @xmath296 .",
    "suppose not , i.e. , suppose that @xmath297 . if @xmath298 then @xmath299 .",
    "but since each factor of @xmath155 of length @xmath300 is right - extendable in @xmath155 , this implies that @xmath155 has no right special factor of length @xmath300 ; a contradiction ( since @xmath301 ) .",
    "now suppose @xmath302 .",
    "then we have @xmath303 .",
    "let @xmath7 denote the suffix of @xmath155 of length @xmath205 .",
    "since all factors of @xmath155 of length @xmath205 except @xmath7 are right - extendable in @xmath155 , the equality @xmath303 implies that @xmath155 contains either two different right special factors of length @xmath205 , each with right - valence @xmath95 , or only one right special factor of length @xmath205 with right - valence @xmath118 .",
    "but then so too would any gt - word @xmath304 with heart @xmath155 and @xmath305 ( e.g. , @xmath306 where @xmath307 ) . and since @xmath7 is right - extendable in any such @xmath304 , it follows that @xmath308 ; a contradiction .",
    "thus @xmath296 , and so by proposition  [ p : deluca1 ] ( and the fact that @xmath155 is a gt - word ) , the complexity @xmath255 of @xmath155 satisfies the conditions of theorem  [ t : rk - characterization ] with @xmath309 and @xmath310 .",
    "hence @xmath186 .",
    "in view of corollary  [ c : l&h ] , we have the following straightforward consequence of theorem  [ t : characterization1-take2 ] .",
    "[ c : characterization1-take2 ] suppose @xmath1 is a non - empty finite word with heart @xmath155 .",
    "then @xmath1 is a gt - word if and only if @xmath223 .",
    "the next result describes the generalized trapezoidal words @xmath1 that are `` triangular '' in the sense that the graphs of their factor complexity functions are triangles on the interval @xmath311 $ ] where @xmath312 .",
    "[ t : triangle ] let @xmath1 be a finite word with @xmath83 and suppose @xmath155 is the heart of  @xmath1 .",
    "then the graph of the factor complexity @xmath0 of @xmath1 as a function of @xmath2 @xmath313 is a triangle on the interval @xmath314 $ ] if and only if @xmath315 .    ( @xmath71 ) : if @xmath316 , then the graph of the factor complexity function @xmath255 of @xmath155 is clearly a triangle on the interval @xmath317 $ ] by proposition  [ p : deluca1 ] .",
    "hence , by lemma  [ l : k!=1 ] , the graph of @xmath29 is a triangle on the interval @xmath318 $ ] .",
    "( @xmath34 ) : suppose the graph of @xmath29 is a triangle on the interval @xmath318 $ ] .",
    "more precisely , suppose @xmath29 increases by 1 with each @xmath2 in the interval @xmath26 $ ] and decreases by 1 with each @xmath2 in the interval @xmath319 $ ] for some positive integer @xmath23 .",
    "let us first consider the case @xmath294 . by proposition  [ p : deluca1 ] ,",
    "@xmath255 increases by 1 with each @xmath2 in the interval @xmath320 $ ] , is non - decreasing on the interval @xmath321 $ ] , and decreases by 1 with each @xmath2 in the interval @xmath322 $ ] .",
    "but by lemma  [ l : k!=1 ] , since the graph of @xmath29 is a triangle , so too is the graph of @xmath255 ; in particular , @xmath255 increases by 1 with each @xmath2 in the interval @xmath26 $ ] and decreases by 1 with each @xmath2 in the interval @xmath319 $ ] where @xmath23 is the same as above .",
    "hence @xmath323 .",
    "similarly , when considering the case @xmath324 , we deduce that @xmath323 .",
    "we end this section by noting that the set of all gt - words is _ factorial _",
    "( i.e. , closed by taking factors ) and is also closed under reversal .    [",
    "p : factors - closed ] the set of all gt - words is closed by factors .",
    "let @xmath1 be a gt - word .",
    "if @xmath136 , then clearly all of its factors are gt - words too ( see remark  [ r : one - letter - words ] ) .",
    "so let us now assume that @xmath83 .",
    "by lemma  [ l : k!=1 ] , it suffices to consider the heart @xmath155 of @xmath1 .",
    "suppose , by way of contradiction , that there exists a factor @xmath90 of @xmath155 ( and hence @xmath1 ) that is not a gt - word .",
    "then the heart @xmath325 of @xmath90 is not a gt - word ( by lemma  [ l : k!=1 ] again ) , so @xmath326 by theorem  [ t : characterization1-take2 ] .",
    "hence , by proposition  [ p : right - special - characterization ] , @xmath325 contains two different right special factors of the same length or a right special factor with right - valence greater than @xmath95 .",
    "but then the same would be true for the heart @xmath155 of @xmath1 , and therefore @xmath327 by proposition  [ p : right - special - characterization ] , contradicting the fact that @xmath155 is a gt - word ( by theorem  [ t : characterization1-take2 ] ) .",
    "[ p : reversal - closure ] a finite word @xmath1 is a gt - word if and only if @xmath165 is a gt - word .",
    "the result follows immediately from the definition of a gt - word ( definition  [ d : trapezoidal ] ) by observing that , for any word @xmath1 , its reversal @xmath328 has the same complexity as @xmath1 .",
    "the word @xmath329 and its reversal are both gt - words with complexity sequence @xmath330 .",
    "we note , however , that @xmath329 satisfies the rk - condition , but its reversal @xmath331 does not because it has @xmath332 , @xmath333 , and @xmath334 .",
    "so the set of all words satisfying the rk - condition is not closed under reversal , whereas the set of all gt - words is closed under this involution .      in the case",
    "when @xmath96 , the first author , together with de  luca and zamboni  @xcite , have shown that the set of all palindromic ( binary ) trapezoidal words coincides with the set of all sturmian palindromes . moreover , if @xmath1 is a ( binary ) trapezoidal word , then @xmath1 contains exactly @xmath335 distinct palindromes ( including the _ empty word _ @xmath336 ) .",
    "that is , ( binary ) trapezoidal words ( and hence finite sturmian words ) are _ rich _ in palindromes in the sense that they contain the maximum possible number of distinct palindromic factors since , as shown in @xcite , a finite word of length @xmath2 contains at most @xmath337 distinct palindromic factors ( including @xmath336 ) .",
    "more precisely , a finite word @xmath1 is said to be _ rich _ if and only if it has @xmath335 distinct palindromic factors , and an infinite word is rich if all of its factors are rich  @xcite .",
    "so , roughly speaking , a finite or infinite word is rich if and only if a new palindrome is introduced at each position in the word ( see proposition  [ p : xdjjgp01epis ] below ) .",
    "the family of rich words was studied in depth by the first author and others in @xcite .",
    "such words were also independently considered in 2004 by brlek , hamel , nivat , and reutenauer  @xcite who called them _",
    "full words_. amongst various properties of rich words , we have the following characterization in terms of so - called _",
    "complete returns_. let @xmath90 be a non - empty factor of a finite or infinite word @xmath1 .",
    "a factor of @xmath1 having exactly two occurrences of @xmath90 , one as a prefix and one as a suffix , is called a _ complete return _ to @xmath90 in @xmath1 .",
    "@xcite [ p : agjjswlz09pali ] a finite or infinite word @xmath1 is rich if and only if , for each non - empty palindromic factor @xmath90 of @xmath1 , every complete return to @xmath90 in @xmath1 is a palindrome .    in short , @xmath1 is rich if and only if all complete returns to palindromes are palindromes in @xmath1",
    ". we also have the following characterization of rich words that will be useful in what follows .",
    "note that a factor @xmath90 of a word @xmath1 is said to be _ unioccurrent _ in @xmath1 if @xmath90 has exactly one occurrence in @xmath1 .",
    "* proposition  3 ) [ p : xdjjgp01epis ] a word @xmath1 is rich if and only if all of its prefixes have a unioccurrent palindromic suffix ( called a _ ups _ for short ) .",
    "similarly , @xmath1 is rich if and only if all of its suffixes have a unioccurrent palindromic prefix .",
    "the ups of a rich word @xmath1 is necessarily the _ longest palindromic suffix _ of @xmath1 .",
    "whilst it is true that all binary trapezoidal words are rich  @xcite , the converse does not hold ; for example , the binary word @xmath338 is rich , but not trapezoidal because its complexity jumps by 2 from @xmath339 to @xmath340 .",
    "moreover , unlike in the binary case , not all generalized trapezoidal words are rich .",
    "for instance , the word @xmath341 is a non - rich gt - word .",
    "however , it is easy to see , for instance , that all gt - words @xmath1 with @xmath342 and @xmath184 are rich since any such word is simply a binary gt - word ( which is rich ) followed by a new letter ( its ups ) . more generally , our next result describes all the rich gt - words .",
    "[ t : gt - rich ] let @xmath1 be a gt - word and suppose that its heart @xmath155 has longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 .",
    "then @xmath1 is rich if and only if one of the following conditions is satisfied .",
    "* @xmath343 and @xmath344 are _ unseparated _ in @xmath155 ( i.e. , either @xmath345 , @xmath346 , or @xmath343 and @xmath344 overlap in @xmath155 ) . *",
    "@xmath347 where @xmath348 and @xmath349 .",
    "* @xmath350 where @xmath351 and @xmath352 where @xmath353 , @xmath354 , @xmath355 are words ( at least one of which is non - empty ) such that @xmath356 , @xmath357 , and @xmath355 contains no letters in common with @xmath343 and @xmath344 .    * examples *    * * rich gt - word : * @xmath358 has complexity sequence @xmath359 with heart @xmath360 ( a palindrome ) . *",
    "* rich gt - word : * @xmath361 has complexity sequence @xmath362 with heart @xmath249 , @xmath363 , and @xmath364 ( @xmath343 and @xmath344 overlap ) . * * rich gt - word : * @xmath365 has complexity sequence @xmath366 with heart @xmath345 where @xmath367 and @xmath368 ( @xmath155 is a product of @xmath343 and @xmath344 ) . * * rich gt - word : * @xmath369 has complexity sequence @xmath370 with heart @xmath371 where @xmath372 and @xmath373 . here @xmath374 and @xmath343 , @xmath344 are separated by a letter in @xmath375 . * * rich gt - word : * @xmath376 has complexity sequence @xmath377 with heart @xmath378 where @xmath379 and @xmath380 . here",
    "@xmath381 and @xmath343 , @xmath344 are separated by a letter in @xmath382 . * * rich gt - word : * @xmath383 has complexity sequence @xmath330 with heart @xmath384 where @xmath385 , @xmath386 , and @xmath387 . here @xmath351 and @xmath343 , @xmath344 are separated by a letter not in @xmath388 . * * rich gt - word : * @xmath389 has complexity sequence @xmath390 with heart @xmath350 where @xmath367 , @xmath391 , and @xmath380 . here",
    "@xmath351 and @xmath343 , @xmath344 are separated by the word @xmath392 where the letter @xmath119 is not in @xmath388 and @xmath393 .",
    "* * non - rich gt - word : * @xmath394 has complexity sequence @xmath362 with heart @xmath395 where @xmath363 and @xmath396 . here",
    "@xmath374 and @xmath343 , @xmath344 are separated by a letter not in @xmath375 .",
    "note that @xmath155 ends with a non - palindromic complete return to @xmath116 .",
    "* * non - rich gt - word : * @xmath397 has complexity sequence @xmath398 with heart @xmath378 where @xmath399 and @xmath368 . here",
    "@xmath400 and @xmath343 ,",
    "@xmath344 are separated by a letter that they do not contain .",
    "note that @xmath155 contains non - palindromic complete returns to each of the letters @xmath115 and @xmath116 .",
    "* * non - rich gt - word : * @xmath401 has complexity sequence @xmath390 with heart @xmath384 where @xmath402 , @xmath403 , and @xmath404 . here",
    "@xmath400 and @xmath343 , @xmath344 are separated by a product of two distinct letters , neither of which they contain themselves .",
    "note that @xmath155 contains non - palindromic complete returns to each of the letters @xmath120 and @xmath119 .",
    "* * non - rich gt - word : * @xmath405 has complexity sequence + @xmath406 with heart @xmath384 where @xmath407 , @xmath408 , @xmath409 . here @xmath351 and @xmath343 , @xmath344 are separated by a product of mutually distinct letters , with last letter in @xmath375 and first letter in @xmath410 .",
    "note that @xmath155 begins with a non - palindromic complete return to @xmath115 and also ends with a non - palindromic complete return to  @xmath119 .",
    "* * non - rich gt - word : * @xmath411 has complexity sequence + @xmath406 with heart @xmath384 where @xmath412 , @xmath413 , @xmath414 . here",
    "@xmath351 and @xmath343 , @xmath344 are separated by a word containing letters in @xmath375 and @xmath410 , but beginning with a letter not in @xmath375 .",
    "note that @xmath155 begins with a non - palindromic complete return to the letter @xmath115 and also contains non - palindromic complete returns to each of the other letters @xmath116 , @xmath120 , @xmath119 , and @xmath415 .",
    "the proof of theorem  [ t : gt - rich ] requires several lemmas ( lemmas  [ l : rich - heart][l : rich - disjoint ] , to follow ) , but first we show that , in the case of a binary alphabet , every trapezoidal word has unseparated @xmath343 and @xmath344 .",
    "this result allows us to give an alternative proof of the fact that all binary trapezoidal words are rich , originally proved in @xcite ( see corollary  [ c : binary - hearts ] below ) .",
    "[ p : binary - hearts ] suppose @xmath1 is a binary trapezoidal word .",
    "then the longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 of @xmath1 are unseparated in @xmath1 .",
    "let @xmath416 .",
    "we first observe that if @xmath1 takes the form @xmath417 or @xmath418 where @xmath419 and @xmath420 , then @xmath1 is simply a product of its longest palindromic prefix and longest palindromic suffix .",
    "let us now suppose , on the contrary , that @xmath1 is a binary trapezoidal word ( not of the form @xmath417 or @xmath418 ) of minimal length such that its longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 are separated , i.e. , such that @xmath421 where @xmath90 is a non - empty word . clearly , @xmath1 can not be a palindrome ; otherwise @xmath1",
    "would itself be its longest palindromic prefix and suffix ( i.e. , @xmath422 ) .",
    "we first show that @xmath423 .",
    "suppose not , i.e. , suppose @xmath424",
    ". then @xmath90 must be a non - palindromic word because @xmath1 is not a palindrome .",
    "if @xmath343 has an occurrence in @xmath1 that is neither a prefix nor a suffix of @xmath1 , then @xmath1 would begin with a complete return to @xmath343 ( shorter than @xmath1 ) , which can not be a palindrome because otherwise @xmath1 would begin with a palindrome longer than @xmath343 ( its longest palindromic prefix ) .",
    "so @xmath1 would begin with a non - palindromic complete return to @xmath343 ( shorter than @xmath1 ) of the form @xmath425 where @xmath426 is a non - palindromic word .",
    "let @xmath427 .",
    "since any factor of @xmath1 is a ( binary ) trapezoidal word ( by proposition  [ p : factors - closed ] or ( * ? ?",
    "* proposition  8) ) , the proper prefix @xmath427 of @xmath1 is a binary trapezoidal word . but this contradicts the minimality of @xmath1 as a binary trapezoidal word ( of shortest length ) having separated longest palindromic prefix and suffix . therefore @xmath343 occurs only twice in @xmath1 , as a prefix and as a suffix .",
    "that is , @xmath424 is itself a non - palindromic complete return to @xmath343 .",
    "if @xmath343 were a letter , say @xmath412 , then @xmath428 where @xmath429 ( since @xmath1 is a complete return to @xmath343 ) , which implies that @xmath430 for some integer @xmath431 . however , this is not possible because @xmath90 is not a palindrome .",
    "so @xmath432 . if @xmath385 , then @xmath433 where @xmath90 begins and ends with the letter @xmath116 . in this case",
    ", the letter @xmath115 is bispecial , so @xmath116 can not be left or right special by propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] . in particular , @xmath434 can not a factor of @xmath90 nor can @xmath435 because @xmath1 is a complete return to @xmath435 .",
    "hence , we deduce that @xmath436 for some integer @xmath431 ; a contradiction ( since @xmath90 is not a palindrome ) .",
    "thus @xmath437 , and likewise it can be shown that @xmath438 . hence @xmath439 .",
    "let us write @xmath440 where @xmath182 and @xmath441 is a palindrome .",
    "then we have @xmath442 .",
    "let @xmath304 be the prefix of @xmath1 obtained from @xmath1 by removing its last letter @xmath150 , i.e. , @xmath443 and let @xmath444 so that @xmath445 and @xmath446",
    ". clearly @xmath440 is the longest palindromic prefix of @xmath304 .",
    "let @xmath447 denote the longest palindromic suffix of @xmath304",
    ". by the minimality of @xmath1 as binary trapezoidal word ( of shortest length ) having separated longest palindromic prefix and suffix , @xmath343 and @xmath447 can not be separated in @xmath304 . hence @xmath448 . if @xmath449 , then @xmath304 ( and hence @xmath1 ) begins with the palindrome @xmath450 longer than @xmath343 .",
    "therefore @xmath451 and the prefix @xmath452 of @xmath447 overlaps with a suffix of the prefix @xmath453 of @xmath304 .",
    "hence @xmath304 either begins with the palindrome @xmath454 ( if @xmath455 ) or begins with a palindrome @xmath456 having @xmath457 as a prefix ( and @xmath452 as a suffix ) with @xmath458 ( since @xmath441 , being a palindrome , overlaps with itself in a palindrome ) .",
    "neither case is possible because @xmath440 is the longest palindromic prefix of @xmath304 .",
    "thus @xmath459 .",
    "we now claim that @xmath343 and @xmath344 are both unioccurrent in @xmath1 . indeed ,",
    "if @xmath343 occurs more than once in @xmath1 , then @xmath1 would begin with a complete return to @xmath343 ( shorter than @xmath1 ) , which can not be a palindrome because otherwise @xmath1 would begin with a palindrome longer than @xmath343 ( its longest palindromic prefix ) .",
    "so @xmath1 begins with a non - palindromic complete return to @xmath343 ( shorter than @xmath1 ) of the form @xmath425 with @xmath343 being its longest palindromic prefix and suffix .",
    "but since @xmath425 is trapezoidal ( by proposition  [ p : factors - closed ] or ( * ? ? ?",
    "* proposition  8) ) , this contradicts the minimality of @xmath1 as a binary trapezoidal word ( of shortest length ) having separated longest palindromic prefix and suffix . likewise",
    ", we deduce that @xmath344 occurs only once ( as a suffix ) in @xmath1 .",
    "so @xmath460 and @xmath461 .",
    "moreover , since @xmath1 is a binary trapezoidal word , we have @xmath109 and @xmath462 .",
    "if @xmath133 , then by proposition  [ p : deluca4.5 ] , the right special factor @xmath6 of @xmath1 of maximal length @xmath463 is bispecial , so @xmath6 occurs at least twice in @xmath1 .",
    "in particular , @xmath1 contains either both @xmath464 and @xmath465 or both @xmath466 and @xmath467 .",
    "let @xmath441 be the shortest prefix of @xmath1 that contains both @xmath468 and @xmath469 where @xmath419 .",
    "without loss of generality , we may assume that @xmath441 ends with a factor @xmath470 of the form @xmath471 .",
    "in particular , @xmath472 where @xmath473 is a complete return to @xmath6 .",
    "let @xmath474 ( resp .",
    "@xmath447 ) denote the longest palindromic prefix ( resp .",
    "suffix ) of @xmath475 .",
    "if @xmath476 , then @xmath441 would have a proper prefix containing @xmath477 , of which @xmath478 and @xmath479 are factors .",
    "so @xmath480 would be a bispecial factor of @xmath441 ( and hence of @xmath1 ) of length @xmath481 , and therefore @xmath482 by propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] .",
    "moreover , we deduce that @xmath473 must be palindromic complete return to ( the palindrome ) @xmath6 ; otherwise , reasoning as above , we would reach a contradiction .",
    "it follows that @xmath483 and @xmath484 , and so we see that @xmath1 has a prefix shorter than @xmath441 that contains both @xmath485 and @xmath486 , contradicting the minimality of @xmath441 .",
    "thus @xmath487 . if @xmath488 , then @xmath473 contains @xmath489 , which implies @xmath490 ( since @xmath473 is a complete return to @xmath6 )",
    "furthermore , @xmath473 can not contain @xmath491 ; otherwise @xmath480 would be a left special factor of length @xmath481 different from @xmath6 , which is not possible by proposition  [ p : left - special - characterization ] .",
    "so @xmath473 contains a factor @xmath492 of the form @xmath493 that contains only one occurrence of @xmath6 ( as a prefix ) and only one occurrence of @xmath480 ( as a suffix ) .",
    "such a factor can not be a palindrome ( since @xmath494 ) and it follows that the longest palindromic prefix and longest palindromic suffix of @xmath492 each have length less than @xmath481 and therefore they must be the same palindrome , @xmath456 say .",
    "but then @xmath492 would be a non - palindromic complete return to @xmath456 , contradicting the minimality of @xmath1 .",
    "so either @xmath495 or @xmath496 . in the former case",
    ", one can use similar reasoning as above to deduce that @xmath474 and @xmath447 are separated in @xmath441 , again contradicting the minimality of @xmath1 . in the latter case ( when @xmath496 ) , @xmath472 is a palindrome , which implies that @xmath483 ( and hence @xmath484 ) and that @xmath482 ( i.e. , @xmath6 is a palindrome ) .",
    "so @xmath497 where @xmath473 is a palindromic complete return to @xmath6 beginning with @xmath498 and ending with @xmath499 .",
    "reasoning as above , we deduce that @xmath500 and @xmath501 ( for if not , we reach a contradiction to either the minimality of @xmath441 or the fact that @xmath473 is a complete return to @xmath6 ) .",
    "let @xmath304 denote the prefix of @xmath1 obtained from @xmath1 by removing the last letter of @xmath1 , i.e. , let @xmath502 where @xmath503 is the last letter of @xmath1 . then , since @xmath500 , we see that @xmath343 ( the longest palindromic prefix of @xmath1 ) is also the longest palindromic prefix of @xmath304 , and using similar arguments as above , we deduce that the longest palindromic suffix @xmath504 of @xmath304 has length @xmath505 .",
    "hence , just as @xmath343 and @xmath344 are separated in @xmath1 , we see that the longest palindromic prefix and longest palindromic suffix of @xmath304 ( namely @xmath343 and @xmath504 ) are separated in @xmath304 ; a contradiction ( yet again ) to the minimality of @xmath1 as a binary trapezoidal word ( of shortest length ) having separated longest palindromic prefix and suffix .",
    "thus @xmath506 , and similarly we deduce that @xmath507 .    if @xmath508 , then @xmath509 ( because @xmath510 , @xmath461 , and @xmath511 ) ; a contradiction .",
    "so @xmath512 , and using similar reasoning , we deduce that @xmath513 too .",
    "hence it follows that @xmath514 and @xmath515 since @xmath130 and @xmath516 by ( * ? ? ?",
    "* corollary 4.1 ) and proposition  [ p : rklh ] .",
    "this implies that @xmath517 since @xmath518 where @xmath109 and @xmath461 .",
    "however , by proposition  [ p : deluca4.5 ] , the right special factor @xmath6 of @xmath1 of maximal length @xmath463 is a prefix of @xmath1 , which occurs at least twice in @xmath1 , and therefore @xmath343 ( which is a prefix of @xmath6 since @xmath519 ) occurs more than once in @xmath1 ; a contradiction .",
    "thus @xmath343 and @xmath344 are unseparated in @xmath1 .",
    "[ c : binary - hearts ] all binary trapezoidal words are rich .",
    "if @xmath1 is a binary trapezoidal word , but not rich , then @xmath1 contains a non - palindromic complete return to a palindrome @xmath343 of the form @xmath520 where @xmath90 is a non - palindromic word .",
    "let @xmath521 .",
    "clearly @xmath343 is both the longest palindromic prefix and the longest palindromic suffix of @xmath6 and these occurrences of @xmath343 in @xmath6 are separated .",
    "but this yields a contradiction because @xmath6 , being a factor of @xmath1 , must be a binary trapezoidal word ( by proposition  [ p : factors - closed ] or ( * ? ? ?",
    "* proposition  8) ) , and therefore its longest palindromic prefix and suffix can not be separated ( by proposition  [ p : binary - hearts ] ) .",
    "[ l : rich - heart ] a gt - word @xmath1 is rich if and only if the heart of @xmath1 is rich .",
    "let @xmath1 be a gt - word .",
    "if @xmath1 is rich , then clearly the heart of @xmath1 is rich too since any factor of a rich word is rich .",
    "conversely , suppose that the heart @xmath155 of @xmath1 is rich . if @xmath522 , we are done .",
    "so suppose that @xmath259 .",
    "then @xmath260 and we have @xmath157 where @xmath6 and @xmath7 are maximal such that @xmath523 for all @xmath262 . moreover , since @xmath259 , at least one of the factors @xmath6 and @xmath7 is non - empty .",
    "if @xmath6 is non - empty , then @xmath524 and it is easy to see that each prefix of @xmath6 has a unioccurrent palindromic suffix  just the last letter of each prefix . likewise ,",
    "if @xmath7 is non - empty , each prefix of @xmath7 has a ups .",
    "moreover , since @xmath155 is rich , each prefix of @xmath155 has a ups , by proposition  [ p : xdjjgp01epis ] .",
    "thus , since the alphabets @xmath525 , @xmath526 , and @xmath527 are mutually disjoint sets , we see that each prefix of @xmath157 has a ups , and thus @xmath1 is rich , by proposition  [ p : xdjjgp01epis ] again .",
    "[ l : gt - rich ] let @xmath1 be a gt - word and suppose that its heart @xmath155 has longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 . if @xmath350 for some non - empty word @xmath90 , then one of the following conditions holds :    * @xmath528 , @xmath529 , @xmath530 for some @xmath531 where @xmath115 , @xmath116 , and @xmath150 are mutually distinct letters ; * @xmath532 or @xmath533 ; * @xmath351 .",
    "moreover , if condition _",
    "( i ) _ is satisfied , then @xmath1 is rich .    in other words",
    ", the above lemma says that if @xmath155 is the heart of a gt - word with _ separated _ @xmath343 and @xmath344 such that the alphabets of @xmath343 and @xmath344 are not disjoint and neither alphabet is a subset of the other , then @xmath155 takes the form given by condition  ( i ) .",
    "all other hearts of the form @xmath384 ( @xmath534 ) are such that the alphabets of @xmath343 and @xmath344 are disjoint or one is a subset of the other .    for a given letter @xmath150 ,",
    "let @xmath535 denote the morphisms defined as follows : @xmath536 i.e. , @xmath535 maps the letter @xmath150 to itself and inserts the letter @xmath150 to the _ right _ of all other letters different from  @xmath150 .",
    "a word @xmath155 satisfying condition ( i ) in lemma  [ l : gt - rich ] can be expressed as @xmath537 , i.e. , @xmath155 is obtained from the binary trapezoidal word @xmath538 by inserting the letter @xmath539 to the right of each letter except the last .",
    "the shortest such word takes the form @xmath540 .",
    "we first observe that , for any word @xmath155 with longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 , the alphabets of @xmath343 and @xmath344 satisfy one of the following three conditions .",
    "* @xmath348 and neither alphabet is a subset of the other . *",
    "@xmath532 or @xmath533 ( i.e. , one alphabet is a subset of the other ) .",
    "* @xmath351 .",
    "furthermore , we observe that there exist hearts @xmath155 of gt - words of the form @xmath384 ( @xmath541 ) with @xmath343 and @xmath344 satisfying these conditions .",
    "for example , the gt - word @xmath376 has heart @xmath542 ( itself ) where @xmath379 , @xmath543 , @xmath380 with the alphabets of @xmath343 and @xmath344 satisfying condition ( a ) .",
    "condition ( b ) is satisfied , for instance , by the gt - word @xmath544 which has heart @xmath545 where @xmath363 , @xmath546 , @xmath396 with @xmath374 .",
    "we also observe that the reversal of @xmath547 ( which is also a gt - word by proposition  [ p : reversal - closure ] ) is such that the alphabet of its longest palindromic prefix ( namely @xmath116 ) is contained in the alphabet of its longest palindromic suffix ( namely @xmath548 ) .",
    "an example of a heart of a gt - word of the form @xmath384 satisfying condition ( b ) with @xmath400 is @xmath397 . and",
    "lastly , condition ( c ) is satisfied , for example , by the gt - word @xmath383 , which has heart @xmath549 ( itself ) where @xmath385 , @xmath550 , @xmath387",
    ".    now suppose , more generally , that @xmath155 is the heart of a gt - word of the form @xmath384 where @xmath90 is a non - empty word . then @xmath551",
    "indeed , if @xmath189 , then @xmath552 for some letter @xmath150 and positive integer @xmath2 , in which case @xmath346 ( i.e. , @xmath343 and @xmath344 are unseparated ) . and if @xmath553 then @xmath343 and @xmath344 can not be separated by a non - empty word in @xmath155 by proposition  [ p : binary - hearts ] .",
    "we also note that if @xmath183 , then @xmath283 and such a word is simply a product of mutually distinct letters with its first and last letters being its longest palindromic prefix and longest palindromic suffix , respectively , and therefore it satisfies condition ( iii ) in the statement of the lemma .",
    "so we will henceforth assume that @xmath154 , in which case the heart @xmath155 of @xmath1 satisfies @xmath287 and @xmath554 .",
    "this means , in particular , that each letter in @xmath525 is both left and right extendable in @xmath155 .",
    "we showed above that there exist hearts @xmath155 of gt - words of the form @xmath384 ( @xmath534 ) with @xmath343 and @xmath344 satisfying conditions ( ii ) and ( iii ) in the statement of the lemma ( which correspond to conditions ( b ) and ( c ) above ) .",
    "so let us now suppose that @xmath155 satisfies neither of those two conditions .",
    "then @xmath155 satisfies condition ( a ) above , i.e. , @xmath348 and there exist at least two distinct letters @xmath115 and @xmath120 such that @xmath555 and @xmath556 .",
    "we now show that @xmath343 , @xmath344 , and @xmath90 must take the form given in condition ( i ) of the lemma .",
    "let us first note that the palindrome @xmath343 ( resp .",
    "@xmath344 ) must contain at least two distinct letters  at least one letter in @xmath382 and at least one in @xmath557 ( resp .",
    "@xmath558 ) . hence the palindromes @xmath343 and @xmath344 each have length at least three .",
    "now , @xmath343 contains a letter @xmath559 such that @xmath560 is a factor of @xmath155 for some letter @xmath561 .",
    "since @xmath344 is a palindrome , the letter @xmath150 will occur at least twice in @xmath344 , except if @xmath344 has odd length and @xmath150 occurs only once as its central letter . in any case",
    ", @xmath150 will be right - extendable in @xmath344 by a letter @xmath562 ( since @xmath563 ) .",
    "so @xmath560 and @xmath564 are factors of @xmath155 ( where @xmath565 and @xmath566 ) , and therefore @xmath150 is a right special factor of @xmath155 of length @xmath20 . on the other hand , @xmath344 contains a letter @xmath567 such that @xmath568 is a factor of @xmath155 for some letter @xmath556 .",
    "since @xmath343 is a palindrome , the letter @xmath569 will occur at least twice in @xmath343 , except if @xmath343 has odd length and @xmath569 occurs only once as its central letter . in any case",
    ", @xmath569 will be right - extendable in @xmath343 by a letter @xmath570 ( since @xmath571 ) .",
    "so @xmath568 and @xmath572 are factors of @xmath155 ( where @xmath573 and @xmath574 ) , and therefore @xmath569 is a right special factor of @xmath155 of length @xmath20 .",
    "we have thus shown that the letters @xmath150 and @xmath569 are right special factors of @xmath155 .",
    "but since @xmath155 is a gt - word ( with @xmath186 by theorem  [ t : characterization1-take2 ] ) , it contains at most one right special factor of each length ( see proposition  [ p : right - special - characterization ] ) , and so we must have @xmath575 .",
    "therefore @xmath560 , @xmath564 , @xmath576 , and @xmath577 are all factors of @xmath155 where @xmath578 , @xmath579 , and moreover , @xmath580 since @xmath555 and @xmath556 .",
    "if @xmath581 or @xmath582 , then @xmath150 would have right - valence at least 3 in @xmath155 , which is not possible by proposition  [ p : right - special - characterization ] .",
    "( alternatively , we observe that since each distinct letter in @xmath155 is right - extendable in @xmath155 because @xmath287 , the letter @xmath150 having right - valence at least @xmath118 would imply that @xmath583 , i.e. , @xmath584 , contradicting the hypothesis that @xmath155 is a gt - word . )",
    "hence we must have @xmath585 and @xmath586 .",
    "it follows that the only factors of @xmath343 of length @xmath95 are @xmath560 and @xmath587 and the only factors of @xmath344 of length @xmath95 are @xmath564 and @xmath588 .",
    "so we deduce that @xmath343 takes the form @xmath589 or @xmath528 for some @xmath420 and that @xmath344 takes the form @xmath590 or @xmath530 for some @xmath591 .",
    "moreover , we note that @xmath560 , @xmath587 , @xmath588 , and @xmath564 are the only factors of length @xmath95 of @xmath155 . indeed , @xmath150 must always be preceded or followed by either @xmath115 or @xmath116 , otherwise @xmath150 would have right or left valence greater than @xmath95 , and also",
    "each of the letters @xmath115 and @xmath116 must always be preceded or followed by the letter @xmath150 in @xmath155 , otherwise we would have another left or right special factor of length @xmath20 in addition to @xmath150 ( which is bispecial ) , contradicting the hypothesis that @xmath155 is a gt - word .",
    "so the word @xmath90 that separates @xmath343 and @xmath344 in @xmath384 can not contain any letters different from @xmath115 , @xmath116 , or @xmath150 , and any factor of @xmath90 of length @xmath95 ( if @xmath592 ) must be one of the words @xmath587 , @xmath560",
    ", @xmath588 , @xmath564 .",
    "we now separately consider the two possible forms of each of @xmath343 and @xmath344 with respect to the `` separating word '' @xmath90 .",
    "* case 1 : * @xmath528 for some @xmath420 . in this case , if @xmath90 begins with the letter @xmath115 , then @xmath115 would be a right special factor of length @xmath20 ; a contradiction .",
    "so @xmath90 must begin with the letter @xmath150 . if @xmath529 , then @xmath155 satisfies condition ( i ) in the statement of lemma . otherwise ,",
    "if @xmath593 , then @xmath90 must begin with @xmath560 or @xmath564 since @xmath150 must be followed by either @xmath115 or @xmath116 in @xmath155 .",
    "but if @xmath90 begins with @xmath560 , then @xmath155 begins with the palindrome @xmath594 longer than @xmath343 .",
    "thus @xmath90 begins with @xmath564 .",
    "* case 2 : * @xmath589 for some @xmath420 . in this case",
    ", @xmath90 must begin with the letter @xmath115 or @xmath116 since @xmath150 can only be followed and preceded by one of these letters .",
    "if @xmath90 begins with the the letter @xmath115 ( which must always be followed by the letter @xmath150 ) , then @xmath155 would begin with the palindrome @xmath595 longer than @xmath343 , which is not possible .",
    "so @xmath90 must begin with the letter @xmath116 .",
    "if @xmath550 , then @xmath344 must begin with @xmath150 ( not @xmath116 ) , and so @xmath344 takes the form @xmath596 for some @xmath591 , in which case @xmath155 would end with the palindrome @xmath597 longer than @xmath344 .",
    "so @xmath593 and @xmath90 begins with @xmath588 .",
    "* case 3 : * @xmath530 for some @xmath591 . using similar reasoning as in case 1",
    ", we deduce that either @xmath155 satisfies condition ( i ) or that @xmath90 must end with @xmath587 .",
    "* case 4 : * @xmath596 for some @xmath591 . using similar reasoning as in case 2",
    ", we deduce that @xmath90 must end with @xmath560 .    from the above considerations , we see that either @xmath155 satisfies condition ( i ) , or @xmath90 takes one of the following forms : @xmath598 but if @xmath90 takes any of the above forms , we see that @xmath155 contains the following @xmath599 factors of length @xmath118 : @xmath600 , @xmath601 , @xmath602 , @xmath603 , @xmath604 , @xmath605 .",
    "this means that the complexity of @xmath155 jumps by @xmath95 from @xmath606 to @xmath607 , contradicting the hypothesis that @xmath155 is a gt - word .",
    "hence we have shown that @xmath155 must satisfy one of the conditions ( i)(iii ) .",
    "lastly , it is easily verified that if @xmath155 satisfies condition ( i ) , then each prefix of @xmath155 has a unioccurrent palindromic suffix , and hence @xmath155 is rich by proposition  [ p : xdjjgp01epis ] .",
    "thus @xmath1 is rich by lemma  [ l : rich - heart ] .",
    "[ l : sep - by - x ] let @xmath1 be a gt - word with heart @xmath155 having longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 .",
    "suppose @xmath608 where @xmath150 is a letter and @xmath532 or @xmath533 .",
    "then @xmath1 is rich if and only if @xmath349 .",
    "we first note that @xmath154 because if @xmath158 , then @xmath283 and @xmath155 would be a product of mutually distinct letters which does not take the assumed form .",
    "hence @xmath287 and @xmath554 .",
    "it is also easy to see that @xmath423 and @xmath609 .",
    "furthermore , if @xmath610 then @xmath343 and @xmath344 can not be separated by a non - empty word in @xmath155 ( by proposition  [ p : binary - hearts ] ) .",
    "hence @xmath551 . ( @xmath34 ) : suppose @xmath1 is rich , then @xmath155 is rich ( by lemma  [ l : rich - heart ] ) . by way of contradiction , let us suppose that @xmath611 . without loss of generality",
    ", we will assume that @xmath533 .",
    "since @xmath343 and @xmath344 contain at least one letter in common , there exists a letter @xmath565 such that @xmath612 and @xmath613 where @xmath614 and @xmath504 are ( possibly empty ) words that contain no letters in common . but @xmath615 is a complete return to @xmath115 , so it must be a palindrome ( since @xmath155 is rich ) , which implies that @xmath616 .",
    "so @xmath617 where @xmath618 because @xmath155 is not a palindrome .",
    "moreover , both @xmath474 and @xmath447 must be non - empty .",
    "indeed , if @xmath619 , then @xmath620 and we see that @xmath155 begins with the palindrome @xmath600 which is longer than @xmath412 ; a contradiction . likewise ,",
    "if @xmath621 , we reach a contradiction . now , since both @xmath474 and @xmath447 are non - empty , there exists a letter @xmath622 and a letter @xmath623 ( with @xmath624 and @xmath625 ) such that @xmath626 and @xmath627 are factors of @xmath155 .",
    "but then , since @xmath560 and @xmath587 are also factors of @xmath155 , we see that the letter @xmath115 is a bispecial factor of @xmath155 of length @xmath20 .",
    "moreover , since @xmath287 , each letter in @xmath525 is right - extendable in @xmath155 , and therefore the letter @xmath115 must always be followed by either @xmath150 or @xmath503 in @xmath155 . for if not",
    ", then @xmath115 would have right - valence greater than @xmath95 in @xmath155 , which would imply that @xmath583 , i.e. , @xmath584 , contradicting the hypothesis that @xmath155 is a gt - word ( also see proposition  [ p : right - special - characterization ] ) .",
    "likewise , the letter @xmath115 can only be preceded by the letter @xmath150 or @xmath569 in @xmath155 by proposition  [ p : left - special - characterization ] . since @xmath343 is a palindrome containing @xmath626",
    ", we see that @xmath628 is a factor of @xmath343 .",
    "similarly , since @xmath344 is a palindrome containing @xmath627 , we see that @xmath629 must be a factor of @xmath344 .",
    "we thus deduce that @xmath630 .",
    "so the only factors of @xmath155 of length @xmath95 are @xmath629 , @xmath627 , @xmath587 , and @xmath560 . if @xmath631 , then @xmath632 and @xmath633 for some @xmath634 , in which case @xmath635 , contradicting the hypothesis that the longest palindromic prefix and longest palindromic suffix of @xmath155 are separated .",
    "so @xmath636 and we deduce that @xmath343 takes the form @xmath637 for some @xmath591 and @xmath344 takes the form @xmath638 for some @xmath420 .",
    "but then @xmath639 , in which case either @xmath155 is a palindrome ( if @xmath640 ) or the longest palindromic prefix and longest palindromic suffix of @xmath155 overlap in @xmath155 ; a contradiction .",
    "hence @xmath349 .    ( @xmath71 ) : conversely , suppose @xmath349 .",
    "we will show that @xmath155 ( and hence @xmath1 ) is rich by determining the possible forms of @xmath343 and @xmath344 in @xmath155 . without loss of generality",
    ", we will assume that @xmath533 .",
    "then @xmath641 , and so @xmath343 contains at least three distinct letters ( since @xmath551 ) ; in particular , @xmath343 contains the letter @xmath150 and at least two other distinct letters @xmath115 and @xmath116 ( different from @xmath150 ) .",
    "we first observe that @xmath155 can not contain the square of a letter . indeed ,",
    "if @xmath642 were a factor of @xmath155 for some letter @xmath569 , then @xmath569 would be a factor of @xmath343 ( since @xmath400 ) , and therefore @xmath569 would be preceded and followed by some letter @xmath643 ( since @xmath644 ) .",
    "but then @xmath642 would be bispecial and @xmath569 can only ever be preceded ( and followed ) by itself and @xmath503 in @xmath155 , otherwise @xmath569 would have left or right valence more than @xmath95 , which is impossible by propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] .",
    "likewise , the letter @xmath503 can only ever be preceded and followed by the letter @xmath569 in @xmath155 , which implies that @xmath155 is a binary word ; a contradiction .",
    "so @xmath155 does not contain the square of a letter .",
    "moreover , using similar arguments as in the proof of lemma  [ l : gt - rich ] ( with the aid of propositions  [ p : right - special - characterization][p : left - special - characterization ] again ) , we deduce that @xmath343 ( and hence @xmath155 ) contains only two distinct letters different from @xmath150 and that @xmath343 and @xmath344 must take the following forms : @xmath645^k b \\quad \\mbox{and } \\quad q = ( ax)^n a\\ ] ] where @xmath115 and @xmath116 are distinct letters ( different from @xmath150 ) and @xmath646 with @xmath647 .",
    "that is , @xmath648^kb(xa)^{n+1}\\ ] ] with @xmath649 where @xmath650 and @xmath651 .",
    "( note that when @xmath532 the forms of @xmath343 and @xmath344 are opposite to those given above . )",
    "it is easy to see that every prefix of any such @xmath155 has a unioccurrent palindromic suffix .",
    "hence @xmath155 is rich ( by proposition  [ p : agjjswlz09pali ] ) , and thus @xmath1 is rich by lemma  [ l : rich - heart ] .",
    "[ l : sep - by - u ] let @xmath1 be a gt - word with heart @xmath155 having longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 . if @xmath652 where @xmath592 and @xmath532 or @xmath533 , then @xmath653 is not contained in @xmath388 .",
    "moreover , @xmath1 is not rich .    as in the proof of lemma",
    "[ l : sep - by - x ] , we first note that @xmath154 because if @xmath158 , then @xmath283 and @xmath155 would be a product of mutually distinct letters which does not take the assumed form .",
    "hence @xmath287 and @xmath554 .",
    "we must also have @xmath551 , because if @xmath189 then @xmath155 would be a palindrome ( i.e. , @xmath346 ) , and if @xmath553 , then @xmath343 and @xmath344 can not be separated by a non - empty word in @xmath155 by proposition  [ p : binary - hearts ] .    without loss of generality",
    ", we will assume that @xmath533 .",
    "suppose on the contrary that @xmath155 is a heart of a gt - word of minimal length such that @xmath384 where @xmath592 and the alphabet of @xmath90 is contained in @xmath388 ( where @xmath533 ) .",
    "using very similar reasoning as in the proof of proposition  [ p : binary - hearts ] ( and keeping in mind that any left / right special factor of @xmath155 has left / right valence @xmath95 by propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] ) , we deduce that @xmath459 and that both @xmath343 and @xmath344 are unioccurrent in @xmath155 .",
    "hence @xmath654 and @xmath655 .",
    "moreover , one can also show ( using much the same reasoning as in the proof of proposition  [ p : binary - hearts ] ) that @xmath656 and @xmath657 , from which it follows that @xmath658 and @xmath659 since @xmath194 and @xmath660 by ( * ? ? ?",
    "* corollary 4.1 ) and proposition  [ p : rklh ] .",
    "this implies that @xmath661 since @xmath662 where @xmath186 ( by theorem  [ t : characterization1-take2 ] ) and @xmath655 .",
    "moreover , since @xmath663 , we have @xmath664 and @xmath665 , and therefore @xmath666 is ( the heart of ) a gt - word ( by proposition  [ p : factors - closed ] ) .",
    "hence @xmath667 ( by corollary  [ c : characterization1-take2 ] ) , where @xmath668 and @xmath669 since @xmath654 .",
    "therefore @xmath670 i.e. , @xmath671 .",
    "but @xmath656 . this implies that @xmath672 and @xmath673 , which is impossible .",
    "thus @xmath653 is not contained in @xmath388 ; in particular , @xmath90 contains a letter not in @xmath388 .",
    "suppose that @xmath90 also contains a letter in common with @xmath343 or @xmath344 .",
    "then , using the fact that @xmath155 contains at most one left ( resp .",
    "right ) special factor of each length , with any such factor having left ( resp .",
    "right ) valence  @xmath95 ( propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] ) , it can be ( tediously ) shown that @xmath155 must take one of the following forms ( _ cf .",
    "_ arguments in the proofs of lemmas  [",
    "l : gt - rich ] and [ l : sep - by - x ] ) .    * * type 1 : * @xmath674 where @xmath115 is a letter , each @xmath675 is a product of at least two mutually distinct letters different from @xmath115 ( i.e. , @xmath676 and @xmath677 for @xmath678 ) , and @xmath679 . * * type 2 : * @xmath680 where @xmath115 , @xmath116 are distinct letters , @xmath681 , and @xmath355 is a product of mutually distinct letters ( possibly just a single letter ) different from @xmath115 and @xmath116 ( i.e. , @xmath682 and @xmath683 ) . * * type 3 : * the reverse of type 2 .",
    "note that hearts @xmath155 of type 1 have @xmath684 and @xmath685 ( e.g. , @xmath686 ) ; hearts of type  2 have @xmath687 , @xmath688 , @xmath689 ( e.g. , @xmath690 ) ; and hearts of type  3 have @xmath691 , @xmath692 , @xmath693 ( e.g. , @xmath694 ) .",
    "it is easy to see that any such word is not rich . indeed ,",
    "if @xmath155 is of type  1 , then @xmath155 contains two non - palindromic complete returns to the letter @xmath115 ( namely @xmath695 and @xmath696 ) . on the other hand , if @xmath155 is of type  2 ( or similarly type  3 )",
    ", then @xmath155 contains the non - palindromic complete return @xmath697 ( or @xmath698 ) to the letter @xmath115 .",
    "it remains to show that if @xmath90 has no letters in common with @xmath343 and @xmath344 , then @xmath155 ( and hence @xmath1 ) is not rich .",
    "we distinguish two cases , as follows .",
    "* case 1 : * _ @xmath90 is not a palindrome_. since @xmath533 , the first letter @xmath115 of @xmath344 is a factor of @xmath343 and we can write @xmath612 and @xmath699 where @xmath614 is a ( possibly empty ) word not containing the letter @xmath115 .",
    "that is , @xmath700 where @xmath701 is a non - palindromic complete return to the letter @xmath115 .",
    "thus @xmath155 is not rich .",
    "* case 2 : * _ @xmath90 is a palindrome_. if @xmath702 then @xmath155 ( @xmath703 ) would be a palindrome .",
    "but this is absurd because if @xmath155 were a palindrome , then we would necessarily have @xmath346 by definition of @xmath343 and @xmath344 .",
    "therefore @xmath459 .",
    "let @xmath150 denote the last letter of @xmath90 .",
    "since @xmath592 , there exists a letter @xmath569 ( possibly equal to @xmath150 ) such that @xmath704 and its reversal @xmath705 are factors of @xmath90 .",
    "moreover , if @xmath126 is the last letter of @xmath343 and @xmath706 is the first letter of @xmath344 , then @xmath707 and @xmath708 are factors of @xmath155 where @xmath709 since @xmath90 contains no letters in common with @xmath343 and @xmath344 . so the letter @xmath150 is a bispecial factor of @xmath155 of length @xmath20 .",
    "this means that neither @xmath343 nor @xmath344 contains a left or right special factor , otherwise @xmath155 would contain another left or right special factor different from @xmath150 , which is not possible by propositions  [ p : right - special - characterization ] and [ p : left - special - characterization ] .",
    "so either @xmath710 for some letter @xmath115 and @xmath591 or @xmath711 where @xmath115 , @xmath116 are distinct letters and @xmath591 .",
    "likewise , since @xmath344 has no left or right special factor of length @xmath20 and @xmath533 , it follows that @xmath344 must take the form @xmath712 , @xmath713 or @xmath714 for some @xmath420 . if @xmath632 , then @xmath633 where @xmath715 ( since @xmath459 and @xmath533 ) .",
    "however , if this was the case , then @xmath155 would begin ( or end ) with a palindrome of the form @xmath716 longer than @xmath343 ( or @xmath344 ) .",
    "so @xmath343 must take the form @xmath717 for some @xmath591 .",
    "if @xmath344 also takes the form @xmath713 for some @xmath420 , then @xmath155 would begin ( or end ) with a palindrome of the form @xmath718 longer than @xmath343 ( or @xmath344 ) .",
    "so @xmath344 must take the form @xmath714 .",
    "but then @xmath719 which contains the non - palindromic complete return @xmath720 to the letter @xmath116 ( and also the non - palindromic complete return @xmath721 to the letter  @xmath115 ) .",
    "thus @xmath155 is not rich .",
    "[ l : rich - disjoint ] let @xmath1 be a gt - word with heart @xmath155 having longest palindromic prefix @xmath343 and longest palindromic suffix @xmath344 .",
    "suppose @xmath384 where @xmath90 is a non - empty word and @xmath351 .",
    "then @xmath155 is rich if and only if there exist words @xmath353 , @xmath354 , and @xmath355 ( at least one of which is non - empty ) such that @xmath352 where @xmath356 , @xmath357 , and @xmath355 contains no letters in common with @xmath343 and @xmath344 .",
    "moreover , @xmath722 and there exist mutually distinct letters @xmath115 , @xmath116 , @xmath150 , @xmath569 and positive integers @xmath723 such that one of the following conditions is satisfied :    * @xmath724 , @xmath725 , @xmath726 ; * @xmath727 , @xmath728 , @xmath726 ; * @xmath729 , @xmath725 , @xmath726 ; * @xmath730 , @xmath731 , @xmath732 ; * @xmath711 , @xmath733 , @xmath734 ; * @xmath735 , @xmath731 , @xmath736 ; * the forms of @xmath343 and @xmath344 are the opposite of those satisfying one of the conditions _",
    "( i)(vi ) _ with the reversal of the corresponding @xmath90 separating them .",
    "the word @xmath355 must be non - empty in conditions ( iv)(vi ) .",
    "clearly we have @xmath551 , because if @xmath189 then @xmath155 would be a palindrome ( i.e. , @xmath346 ) , and if @xmath553 , then @xmath343 and @xmath344 can not be separated by a non - empty word in @xmath155 by proposition  [ p : binary - hearts ] .",
    "we also observe that if @xmath183 , then @xmath283 and such a word is simply a product of mutually distinct letters with its first and last letters being its longest palindromic prefix and longest palindromic suffix , respectively .",
    "such a word @xmath155 has @xmath343 , @xmath90 , and @xmath344 satisfying condition ( vi ) with @xmath737 .",
    "so we will now assume that @xmath154 , in which case the heart @xmath155 of @xmath1 satisfies @xmath287 and @xmath554 .",
    "this means , in particular , that each letter in @xmath525 is both left and right extendable in @xmath155 .",
    "( @xmath738 ) suppose @xmath155 is rich",
    ". then we must have @xmath432 and @xmath739 .",
    "indeed , if @xmath412 for some letter @xmath115 , then since @xmath554 , @xmath343 occurs at least twice in @xmath155 , and therefore @xmath155 begins with a palindromic complete return to @xmath343 that is longer than @xmath343 ( its longest palindromic prefix ) , which is not possible .",
    "likewise , we deduce that @xmath740 .",
    "we distinguish two cases , as follows .",
    "* case 1 : * @xmath741 .",
    "suppose @xmath150 is the left - most letter in @xmath90 that is not in the alphabet of @xmath343 .",
    "then @xmath742 where @xmath353 , @xmath354 are ( possibly empty ) words with @xmath743 .",
    "let @xmath115 denote the last letter of @xmath744 .",
    "then @xmath115 occurs in @xmath343 ( since @xmath743 ) , and moreover , since @xmath432 , there exists a letter @xmath745 such that @xmath746 and @xmath747 are factors of @xmath343 . since @xmath587 is also a factor of @xmath155 , we see that @xmath115 is a right special factor of @xmath155 of length @xmath20 . moreover , the letter @xmath150 is left special in @xmath155 because @xmath559 and so there exists a letter @xmath748 such that @xmath704 and also @xmath705 is a factor of @xmath344 ; whence @xmath587 and @xmath705 are factors of @xmath155 where @xmath749 . we thus deduce that @xmath343 contains no left or right special factor of length @xmath20 .",
    "indeed , the right special letter @xmath115 can only be followed by @xmath116 ( not @xmath150 ) in @xmath343 ; otherwise @xmath115 would have right - valence greater than @xmath95 , which implies that @xmath584 ( since each letter in @xmath525 is right - extendable in @xmath155 ) .",
    "but this is impossible because @xmath155 is a gt - word ( also see proposition  [ p : right - special - characterization ] ) .",
    "we also note that the letter @xmath115 can be preceded by only the letter @xmath116 in @xmath343 ; otherwise @xmath115 would be another left special factor of @xmath155 of length @xmath20 ( in addition to the letter @xmath150 ) which is not possible by proposition  [ p : left - special - characterization ] .",
    "so @xmath744 takes one of the following forms : @xmath750 for some @xmath591 .",
    "furthermore , we observe that the letters @xmath115 and @xmath116 can not occur to the right of @xmath150 in @xmath155 ; otherwise one of those letters would be left special .",
    "but the only letter that can be left special in @xmath155 is @xmath150 , by the fact that @xmath222 ( by corollary  [ c : characterization1-take2 ] ) together with proposition  [ p : left - special - characterization ] .",
    "hence @xmath751 , and using similar reasoning as for @xmath744 , we observe that @xmath752 has no left or right special factor of length @xmath20 .",
    "therefore @xmath753 for some @xmath420 where @xmath754 ( and @xmath755 ) .",
    "we have thus shown that @xmath155 satisfies one of the conditions ( i)(iii ) with @xmath756 , and the reversal of any such @xmath155 ( namely , @xmath757 , which is also a gt - word by proposition  [ p : reversal - closure ] ) satisfies condition ( vii ) .",
    "* case 2 : * @xmath653 contains a letter not in @xmath388 .",
    "using very similar reasoning as in case  1 , we deduce that @xmath155 satisfies one of the conditions ( i)(vi ) where @xmath355 is a non - empty word containing no letters in common with @xmath343 and @xmath344 , and the reversal of any such @xmath155 ( namely , @xmath757 , which is also a gt - word by proposition  [ p : reversal - closure ] ) satisfies condition ( vii ) .",
    "moreover , we note that @xmath722 , i.e. , @xmath355 is a product of mutually distinct letters .",
    "indeed , @xmath355 has no left or right special factor of length @xmath20 because the letters @xmath115 and @xmath150 are , respectively , the unique right and left special factors of @xmath155 of length @xmath20 .",
    "this implies that @xmath355 is either a product of mutually distinct letters ( possibly just a single letter ) , or @xmath355 takes one of the following forms : @xmath758 where @xmath120 and @xmath119 are distinct letters . but none of the above forms are possible because in each case the letter @xmath120 would be a left special factor of @xmath155 of length @xmath20 ( different from @xmath150 ) . thus @xmath355 must be a product of mutually distinct letters .",
    "( @xmath71 ) : conversely , suppose @xmath352 where @xmath353 , @xmath354 , and @xmath355 are words such that @xmath356 , @xmath357 , and @xmath355 contains no letters in common with @xmath343 and @xmath344 . then , using the same reasoning as above , we deduce that @xmath155 satisfies one of the conditions ( i)(vii ) and it is easy to see that every prefix of any such word has a unioccurrent palindromic suffix ; whence @xmath155 is rich .",
    "( @xmath34 ) : suppose @xmath1 is rich .",
    "then the heart @xmath155 of @xmath1 is clearly rich too since any factor of a rich word is rich ( see lemma  [ l : rich - heart ] ) .",
    "suppose , by way of contradiction , that @xmath155 is the ( rich ) heart of a rich gt - word @xmath1 such that @xmath155 satisfies none of the conditions ( i)(iii ) in the statement of the theorem .",
    "then , by lemmas  [ l : gt - rich ] , [ l : sep - by - x ] , and [ l : rich - disjoint ] , the only possibility is that @xmath155 takes the form @xmath384 where @xmath593 and @xmath532 or @xmath533 .",
    "however , by lemma  [ l : sep - by - u ] , all such @xmath155 are not rich .",
    "hence one of the conditions ( i)(iii ) must hold .",
    "( @xmath71 ) : conversely , suppose that @xmath155 satisfies one of the conditions ( i)(iii ) in the statement of the theorem . to prove that @xmath1 is rich",
    ", it suffices to prove that @xmath155 is rich ( by lemma  [ l : rich - heart ] ) .",
    "we first observe that if @xmath155 satisfies either of the conditions ( ii ) or ( iii ) , then @xmath155 is rich ( by lemmas  [ l : gt - rich ] , [ l : sep - by - x ] , and [ l : rich - disjoint ] ) .",
    "so let us now assume that @xmath155 satisfies condition ( i ) and suppose , on the contrary , that @xmath155 is a heart of a gt - word of minimal length satisfying that condition but @xmath155 is not rich .",
    "then , by proposition  [ p : agjjswlz09pali ] , @xmath155 contains a non - palindromic complete return to some non - empty palindrome @xmath441 , say @xmath759 where @xmath426 is a non - palindromic word .",
    "if @xmath760 is a factor of @xmath343 , then @xmath343 would be a non - rich ( heart of a ) gt - word shorter than @xmath155 satisfying condition ( i ) , contradicting the minimality of @xmath155 as a heart of a gt - word of shortest length satisfying condition ( i ) , but not rich .",
    "so @xmath760 is not a factor of @xmath343 , and likewise , @xmath6 is not a factor of @xmath344 .",
    "therefore @xmath760 is not wholly contained in either of the palindromes @xmath343 and @xmath344 .",
    "hence , we have @xmath761 where @xmath474 is prefix of @xmath343 and @xmath447 is a suffix of @xmath344 .",
    "note that at least one of the words @xmath474 and @xmath447 is non - empty ; otherwise @xmath762 where @xmath763 and @xmath764 , in which case @xmath155 does not satisfy either of the conditions ( i ) or ( ii ) .",
    "we distinguish three cases , as follows .",
    "* case 1 : * _ the first occurrence of @xmath441 in @xmath6 is not contained in @xmath343 .",
    "_ in this case , @xmath765 where @xmath766 is a ( possibly empty ) suffix of @xmath441 with @xmath767 ( i.e. , @xmath766 is a _ proper _ suffix of @xmath441 ) because , by assumption , @xmath344 does not contain @xmath760 as a factor .",
    "let @xmath768 .",
    "this proper suffix of @xmath155 is ( the heart of ) a gt - word ( by proposition  [ p : factors - closed ] ) and its longest palindromic prefix is @xmath441 . indeed ,",
    "if @xmath470 had a palindromic prefix longer than @xmath441 , but shorter than @xmath760 , then @xmath441 would occur more than twice in @xmath6 ( i.e. , @xmath441 would occur as an interior factor of @xmath6 ) , which is impossible because @xmath6 is a complete return to @xmath441 . on the other hand ,",
    "if @xmath470 had a palindromic prefix @xmath355 longer than @xmath760 , then the palindrome @xmath355 ( which begins with @xmath760 ) would be a non - rich ( heart of a ) gt - word shorter than @xmath155 satisfying condition  ( i ) , contradicting the minimality of @xmath155 .",
    "so we see that the longest palindromic prefix of @xmath470 ( namely @xmath441 ) and the longest palindromic suffix of @xmath470 ( namely @xmath344 ) are unseparated in @xmath470 .",
    "hence @xmath470 is a non - rich ( heart of a ) gt - word ( shorter than @xmath155 ) satisfying condition ( i ) , contradicting the minimality of @xmath155 again .",
    "* case 2 : * _ the second occurrence of @xmath441 in @xmath6 is not contained in @xmath344 .",
    "_ using the same reasoning as in case  1 we reach a contradiction .",
    "* case 3 : * _ the first occurrence of @xmath441 in @xmath6 is contained in @xmath343 and the second occurrence of @xmath441 in @xmath6 is contained in @xmath344_. in this case , @xmath343 ends with @xmath769 where @xmath770 is a proper prefix of @xmath771 and @xmath344 begins with @xmath772 where @xmath773 is a proper suffix of @xmath774 .",
    "let @xmath768 where @xmath447 is a suffix of @xmath344 .",
    "we observe that @xmath470 has longest palindromic suffix @xmath344 , and using the same reasoning as in case  1 , we deduce that the longest palindromic prefix of @xmath470 is @xmath441 .",
    "moreover , @xmath441 and @xmath344 must be unseparated in @xmath470 .",
    "otherwise , if @xmath441 and @xmath344 were separated by a letter or word of length at least @xmath95 in @xmath470 , then the same would be true of @xmath343 and @xmath344 in @xmath155 , which is impossible because @xmath155 satisfies condition ( i ) .",
    "hence @xmath470 is a non - rich ( heart of a ) gt - word ( shorter than @xmath155 ) satisfying condition  ( i ) , contradicting the minimality of @xmath155 .    in each of the above three cases",
    "we have reached a contradiction . hence @xmath155 ( and therefore @xmath1 )",
    "must be  rich .",
    "in this paper we have introduced a new class of words that encompass the ( original ) binary trapezoidal words and have studied combinatorial and structural properties of these so - called generalized trapezoidal words .",
    "we have also proved some characterizations of these words and have described all those that are rich in palindromes .",
    "a nice ( direct ) consequence of our characterization of rich gt - words is that all gt - words with palindromic hearts are rich . in the case of binary trapezoidal words",
    ", we have independently proved that the longest palindromic prefix and longest palindromic suffix of any such word must be `` unseparated '' , from which it follows that all binary trapezoidal words are rich , originally proved in a different way in @xcite .",
    "further work - in - progress concerns the enumeration of generalized trapezoidal words , as has recently been considered in the binary case  @xcite ( see also @xcite in which an enumeration formula for binary trapezoidal words was independently obtained ) .",
    "we thank very much the two anonymous referees for their thoughtful comments and suggestions which greatly helped to improve the paper .",
    "the first author would also like to thank members of the _ laboratoire mis _ and _ equipe sdma _ at the universit de picardie jules verne for their kind hospitality during her 1-month visit in mid 2011 when some of the preliminary work on this paper was done .",
    "she also gratefully acknowledges the funding provided by the universit de picardie jules verne for her visit to amiens ."
  ],
  "abstract_text": [
    "<S> the _ factor complexity function _ </S>",
    "<S> @xmath0 of a finite or infinite word @xmath1 counts the number of distinct _ factors _ of @xmath1 of length @xmath2 for each @xmath3 . </S>",
    "<S> a finite word @xmath1 of _ length _ </S>",
    "<S> @xmath4 is said to be _ trapezoidal _ if the graph of its factor complexity @xmath0 as a function of @xmath2 ( for @xmath5 ) is that of a regular trapezoid ( or possibly an isosceles triangle ) ; that is , @xmath0 increases by 1 with each @xmath2 on some interval of length  @xmath6 , then @xmath0 is constant on some interval of length @xmath7 , and finally @xmath0 decreases by 1 with each @xmath2 on an interval of the same length @xmath6 . necessarily @xmath8 ( since there is one factor of length @xmath9 , namely the _ empty word _ ) , so any trapezoidal word is on a binary alphabet . </S>",
    "<S> trapezoidal words were first introduced by de  luca ( 1999 ) when studying the behaviour of the factor complexity of _ finite sturmian words _ , </S>",
    "<S> i.e. , factors of infinite `` cutting sequences '' , obtained by coding the sequence of cuts in an integer lattice over the positive quadrant of @xmath10 made by a line of irrational slope . </S>",
    "<S> every finite sturmian word is trapezoidal , but not conversely . </S>",
    "<S> however , both families of words ( trapezoidal and sturmian ) are special classes of so - called _ rich words _ ( also known as _ full words _ )  a wider family of finite and infinite words characterized by containing the maximal number of palindromes  studied in depth by the first author and others in  2009 .    in this paper </S>",
    "<S> , we introduce a natural generalization of trapezoidal words over an arbitrary finite alphabet @xmath11 , called _ generalized trapezoidal words _ </S>",
    "<S> ( or _ gt - words _ for short ) . </S>",
    "<S> in particular , we study combinatorial and structural properties of this new class of words , and we show that , unlike the binary case , not all gt - words are rich in palindromes when @xmath12 , but we can describe all those that are rich . </S>"
  ]
}