{
  "article_text": [
    "in the late 70 s many authors @xcite introduced the _ test - particle _ theory of particle acceleration at strong collisionless shocks due to first order fermi mechanism .",
    "however , quantitative estimates soon pointed out that this mechanism , called diffusive shock acceleration ( dsa ) , may be so efficient that the back - reaction of the accelerated particles on the shock dynamics can not be neglected .",
    "the obvious theoretical challenge is how to model effectively the full shock dynamics .",
    "modeling shocks with efficient particle acceleration using plasma simulations ( pic and hybrid ) is extremely computationally expensive for several reasons .",
    "first , the energies of charged particles participating in the process range from the low thermal energies of cold plasma to the ultra - relativistic energies of cosmic rays , and both extremes of particle spectra are dynamically important if acceleration is efficient ( see , e.g. , * ? ? ?",
    "* for estimates of computational requirements ) .",
    "second , simulations need to be done in three dimensions because of the possibility of non - physical suppression of important processes in one- and two - dimensional simulations ( see , e.g. , * ? ? ?",
    "therefore , approximate methods must be used to model efficient particle accelerating shocks .    the first step towards a non - linear theory of dsa ( nldsa ) , in which particle acceleration and shock dynamics are calculated self - consistently ,",
    "is represented by the two - fluid model proposed by @xcite .",
    "this approach is indeed very useful to study the dynamics of a shock modified by the presence of accelerated particles ( treated as a diffusive , relativistic fluid ) but by design it can not provide any information about the spectrum of the cosmic rays ( crs ) which are produced .    a _",
    "study of the nldsa at astrophysical shocks also requires a statistical description of transport of superthermal particles .",
    "this relevant piece of physics has been taken into account by adopting a number of rather different approaches ; namely    * fully numerical simulations , in which a time - dependent diffusion - convection equation for the cr transport is solved in concert with coupled gas dynamics conservation laws , like in @xcite ; * stationary monte carlo numerical simulations of the full particle population , like in @xcite ; * semi - analytic solutions of the stationary ( or quasi - stationary , see * ? ? ?",
    "* ) diffusion - convection equation coupled to the gas dynamic equations , like in @xcite .",
    "all these approaches make consistent predictions about the main consequences of the shock modification , i.e.  the appearance of an upstream precursor created by the cr pressure around the shock , which slows down the incoming fluid . as a consequence of this cr - induced velocity gradient ,",
    "the fluid compression ratio is no longer 4 for any strong shock .",
    "hence , the test - particle prediction that the spectrum of accelerated particles has to be @xmath0 is no longer valid .",
    "nevertheless , it is still true that the spectral slope mainly depends on the compression factor actually `` felt '' by crs . since the larger is its momentum , the farther from the shock a particle can diffuse , high ( low ) momentum particles probe a total compression ratio larger ( smaller ) than 4 .",
    "the resulting cr spectrum becomes rather concave , being harder ( softer ) than @xmath1 at the higher ( lower ) energies .",
    "for accurate reviews of cr - modified shocks the reader can refer to @xcite .    in this paper",
    "we want , for the first time , to construct both qualitative and quantitative comparisons among different approaches to nldsa , in order to highlight their analogies and differences .",
    "in particular , we compare three state - of - the - art kinetic methods which are representative of the three categories listed above : the fully numerical calculation by @xcite , the monte carlo simulation by @xcite and the semi - analytical solution by @xcite . the final goal of this work is to provide a useful tool illustrating which physical aspects of the problem can be taken into account within each approach , which assumptions are _ a posteriori _ justified and consistent with any observational signature , and finally what is the computational effort required to tackle a given problem .    the present work is organized as follows : the next three sections are dedicated to the description of the three different techniques adopted to solve the problem of nldsa . for each of them ,",
    "the assumptions ( e.g.  time - dependence , isotropy of the cr distribution function ) and the equations of the model , the injection of particles in the acceleration mechanism and the turbulent heating in the precursor are outlined . in  [ sec : benchmark ] the results obtained within different approaches are compared , in terms of both hydrodynamics and cr distribution function .",
    "we comment and conclude in  [ sec : conclusion ] .",
    "in their kinetic simulations of dsa , kang and jones ( hereafter kj ) evolve the standard time - dependent gasdynamic conservation laws with the cr pressure terms in eulerian form for one - dimensional plane - parallel geometry @xcite , @xmath2 where @xmath3 is the gas density , @xmath4 is the fluid velocity , @xmath5 is the gas ( @xmath6 ) or cr ( @xmath7 ) pressure ( eq .  [ xicr ] ) and @xmath8 is the gas adiabatic index .",
    "@xmath9 is the injection energy loss term , which accounts for the energy carried away by the suprathermal particles injected into the cr component at the subshock and is subtracted from the postshock gas immediately behind the subshock .",
    "the gas heating due to the alfvn wave dissipation in the upstream region is modeled following @xcite and is given by the term @xmath10 where @xmath11 is the local alfvn speed and @xmath12 is the magnetic field strength far upstream . here and in the following we will label with the subscript 0 quantities at upstream infinity , and with 1 and 2 quantities immediately upstream and downstream of the subshock , respectively .",
    "these equations can be used to describe parallel shocks , where the large - scale magnetic field is aligned with the shock normal and the pressure contribution from the turbulent magnetic fields can be neglected .",
    "the cr population is evolved by solving the diffusion - convection equation for the pitch - angle - averaged ( isotropic in momentum space ) distribution function , @xmath13 , in the form : @xmath14+\\frac{p}{3}\\frac{{\\partial}f}{{\\partial}p}\\frac{{\\partial}(u+u_{w})}{{\\partial}x}\\,,\\ ] ] where @xmath15 is the spatial diffusion coefficient ( see e.g. * ? ? ? * for a derivation ) and @xmath16 is the scalar , momentum magnitude .",
    "this equation is then usefully rewritten and solved in terms of @xmath17 and @xmath18 as explained in @xcite , eq .",
    "the cr population is isotropized with respect to the local alfvnic wave turbulence , which would in general move at a speed @xmath19 with respect to the plasma . since the alfvn waves upstream of the subshock",
    "are expected to be established by the streaming instability , the wave speed is set there to be @xmath20 .",
    "downstream , it is likely that the alfvnic turbulence is nearly isotropic , hence @xmath21 there .",
    "kj typically initialize their simulations by creating pure hydrodynamical shocks and then evolving them along with crs .",
    "the shocks described here were initialized from rankine - hugoniot ( r - h ) relations , although alternatives , such as reflecting boundaries can be employed .",
    "it is important to note that the initial shock speed established by the r - h conditions ( and thus , also the mach number ) will change as the shock evolves .",
    "that results from increased compression through the shock .",
    "this feature , which is not a factor in the two steady state shock models , complicates somewhat our comparison methodology .",
    "previous studies showed that cr modified shocks evolve to a dynamical self - similar state , with constant total compression and downstream pressure balance ; however , the cr population continues to stretch to ever higher momenta unless high energy crs escape either through an upper momentum boundary , or a spatial `` free escape '' boundary @xcite .",
    "the former is simply implemented by setting @xmath22 for @xmath23 , while the latter ( employed in this study ) is effected by setting @xmath22 for @xmath24 .",
    "then the modified shocks and their cr population will evolve until cr escape through either of these boundaries balances dsa within the shock structure . from that time forward the shock and its cr population become steady and the spectrum of escaping particles can be worked out numerically as @xmath25_{x_0}\\,.\\ ] ]      equations [ masscon ] , [ mocon ] , [ econ ] , and [ diffcon ] are simultaneously integrated by finite difference methods in the crash ( cosmic - ray acceleration shock ) code .",
    "the detailed description of the crash code can be found in @xcite .",
    "three features of crash are important to our discussion below .",
    "first , crash applies an adaptive mesh refinement technique around the subshock .",
    "so the precursor structure is adequately resolved to couple the gas to the crs of low momenta , whose diffusion lengths can be at least several orders of magnitude smaller than the precursor width .",
    "second , crash uses a subgrid shock tracking ; that is , the subshock is a true discontinuity , whose position is followed accurately within a single cell on the finest mesh refinement level . consequently , the effective numerical subshock thickness needed to compute the spatial derivatives in eq .",
    "[ diffcon ] is always less than the single cell size of the finest grid .",
    "third , the exact subshock speed is calculated at each time step to adjust the rest frame of the simulation , so that the subshock is kept inside the same grid cell throughout .",
    "these three features allow one to obtain good numerical convergence in the solutions with a minimum of computational effort .",
    "a typical shock simulation with crash evolved to steady state with crs accelerated to @xmath26gev / c requires roughly 300 cpu hours on current microprocessors .",
    "crash does not currently have a parallel implementation .",
    "the evolving shock simulation time can be shortened by as much as an order of magnitude using the finite volume , cgmv algorithm for cr transport discussed in @xcite instead of traditional finite difference methods .",
    "however , thermal leakage in the sophisticated form discussed in the following subsection has not been implemented with the cgmv algorithm .",
    "so , since one of our objectives here is comparisons of injection methods , we do not employ cgmv .",
    "since the velocity distribution of suprathermal particles in the maxwellian tail is not isotropic in the shock frame , the diffusion - convection equation can not directly follow the injection from the non - diffusive thermal pool into the diffusive cr population . in the crash code",
    ", thermal leakage injection is emulated numerically by adopting a _ transparency function _ , @xmath27 , which expresses the probability for downstream thermal particles at given random velocity , @xmath28 , to swim successfully upstream across the subshock through the postshock cyclotron - instability - generated mhd waves , whose amplitude is parameterized by @xmath29 ( see * ? ? ?",
    "* eq .  8) .",
    "the condition of finite probability for suprathermal downstream particles to cross the subshock ( i.e.  @xmath30 for @xmath16 larger than an injection momentum @xmath31 effectively selects the lowest momentum of the particles entering the cr population .",
    "the model transparency function increases smoothly from zero to unity over @xmath32 .",
    "consequently , the transition from the maxwellian to the quasi - power - law distribution develops smoothly in momentum space .",
    "the parameter , @xmath33 , is the ratio of the magnitude of the large - scale magnetic field aligned with the shock normal , @xmath12 , to the amplitude of the postshock wave field that interacts with low energy particles , @xmath34 .",
    "this is an adjustable parameter , although , as discussed in @xcite , it is confined theoretically and experimentally to values , @xmath35 .",
    "the method of solving the nldsa problem based on the monte carlo particle transport , developed by ellison and co - workers and later adapted for modeling magnetic field amplification in shocks by vladimirov ( hereafter ev ) , makes the following physical assumptions :    * all quantities depend only on one spatial coordinate , but the flow velocity and/or the uniform magnetic field may have a component along the perpendicular direction ; * a steady state is realized ; * mass , momentum and energy conservation laws determine the nonlinear shock structure ; * the transport of all particles may be described statistically . in the simplest case , it is assumed that the momentum vector of every particle gets randomly perturbed in the course of propagation in such a way that particle distribution is isotropized in the course of a momentum - dependent collision time , which is a parameter of the model . if scattering rate is constant in space and time , then on large enough scales such particle transport models diffusion .",
    "gyration around a uniform magnetic field may be included along with the stochastic component of the motion ; * particles of all energies are treated on an equal basis , i.e.  there is no need for a strict distinction between thermal and superthermal particles .",
    "however , such a distinction may be artificially imposed ( see  [ ev : th ] ) ; * collisions that facilitate particle diffusion are elastic in the reference frame moving at a speed @xmath19 with respect the thermal plasma , where @xmath19 is chosen the same way as in the other models .    the problem of nldsa is thus stated as that of finding a steady state particle distribution function in a system where a supersonic motion exists at an infinite boundary , and the flow is subsonic at the opposite boundary .",
    "the distribution function @xmath36 in this case retains the information about the direction of the momentum vector @xmath37 and spans the range of momenta from thermal to @xmath38 . here and in the following we indicate with @xmath36 the whole distribution function ( thermal + cosmic rays ) and with @xmath39 the cosmic ray distribution only .",
    "the method by which this problem is solved involves an iterative application of the following two steps :    \\1 ) a trial flow speed @xmath40 is chosen based on the conservation laws and on the best - yet estimate of @xmath36 , and    \\2 ) the updated particle distribution @xmath36 is calculated with the monte carlo technique based on the trial flow speed @xmath40 . +",
    "these steps are repeated until mass , momentum and energy conservation laws hold for the particle distribution @xmath36 calculated with the chosen @xmath40 .    in practice ,",
    "the first step is realized by adjusting the previous guess for @xmath40 using the conservation laws .",
    "the conservation of momentum is used to choose @xmath40 in the supersonic region ( i.e. , upstream ) , and the conservation of momentum and energy is used to choose the flow speed in the subsonic region ( i.e.  downstream ) , taken as uniform .",
    "the equations expressing the conservation of mass , momentum and energy fluxes can be written in terms of @xmath41 as @xmath42 where the subscript @xmath43 labels the component along the axis @xmath43 , @xmath44 is the kinetic energy of a particle with momentum @xmath37 and @xmath45 is the energy flux carried away by particles escaping the system ( see below for details ) .",
    "this way of dealing with a _",
    "global _ distribution function is in contrast to writing the left hand side as the sum of gas and cr pressures , which would require @xmath41 to be isotropic in @xmath16-space .",
    "the second step is realized by introducing a population of thermal particles either far upstream , or at a location @xmath46 ( defined below ) , and propagating them in time steps small compared to the collision time , until they escape .",
    "a particle is considered to have escaped if a ) it is found many diffusion lengths downstream , or b ) it crosses the upstream free escape boundary .",
    "as the particles are propagated , their momentum are randomly perturbed as described in the next paragraph .",
    "when particles cross selected coordinates @xmath47 , their momenta and statistical weights are summed to calculate the particle distribution function in a momentum bin : @xmath48 here , the summation takes place over the events of a particle crossing the coordinate @xmath47 : @xmath49 is a bin in momentum space , @xmath50 is a bin in angles ( @xmath51 ) and @xmath52 is the properly normalized statistical weight of the particle . in a similar fashion , the code calculates the moments of the distribution function , including the momentum and energy fluxes defined in eq .",
    "[ pflux ] and [ eflux ] .",
    "when particles are propagated , they move in straight lines for a time @xmath53 equal to a fraction of the collision time @xmath54 .",
    "after that , the momentum in the local plasma frame is rotated by a random angle chosen so that the averaged particle motion represents diffusion with the appropriate diffusion coefficient . the local plasma frame for cr particles",
    "is assumed to be moving at a speed @xmath55 with respect to the subshock , where @xmath56 is the local alfvn speed . for thermal particles",
    ", the frame in which momentum rotation is performed is moving at a speed @xmath40 with respect to the subshock .",
    "the details of this procedure are described in @xcite . in regions where the particle distribution is isotropic ( e.g. , far downstream ) , the code may set @xmath57 , which simulates a random walk process and corresponds to the diffusion approximation .",
    "a gradient of the local plasma speed in the above procedure leads to the first order fermi acceleration of particles .",
    "this applies to the thermal particles as well as to the superthermal ones .",
    "injection of thermal particles into the acceleration process occurs in this model only due to their fermi - i acceleration at the subshock .",
    "elastic scatterings of thermal particles in the shock precursor will , in the presence of a small flow speed gradient , lead to adiabatic heating : @xmath58 ( this heating is , in a sense , due to the same fermi - i acceleration process , but on a smooth variation of the flow speed instead of a discontinuity ) .",
    "if additional heating operates in the precursor due to some wave dissipation processes , the treatment of thermal particles in the precursor is modified as described in  [ ev : th ] .    in the monte carlo",
    "particle transport routine , the escape of energetic particles upstream is modeled by removing from the simulation the particles that cross the coordinate of the free escape boundary , @xmath59 , in the upstream direction . the value of @xmath59 is a free parameter of the model .",
    "the energy flux carried away by the escaping particles is reflected in the value of the energy flux downstream of @xmath59 .",
    "the amount of escaping energy flux , @xmath60 , is calculated in the ev method as the difference between the energy flux upstream of @xmath59 and the energy flux downstream of @xmath59 ( see equation ( [ eflux ] ) ) , while the spectral density of the flux of escaping particles can be calculated in the simulation as @xmath61    as a final remark , the computational time required by this monte carlo approach is on the order of tens to hundreds of processor hours , and parallel processing is implemented in the latest version .      in order to include precursor heating ,",
    "particles are introduced at an upstream location @xmath62 , which is close to the subshock , but not too close , in order that the thermal particle distribution is still isotropic at @xmath62 .",
    "upstream of @xmath62 , instead of calculating @xmath41 and its moments like @xmath63 from particle propagation , the model finds @xmath63 by solving the equation @xmath64 = \\mathcal{w}(x)=-v_{a}(x)\\frac{dp_{c}}{dx},\\ ] ] where @xmath65 is the same heating rate as in eq .",
    ". then particles are introduced at @xmath62 with the temperature corresponding to @xmath66 and allowed to propagate , get injected and accelerated .",
    "this procedure requires a differentiation between thermal and superthermal particles in order to calculate the total momentum and energy fluxes upstream ( eqs .",
    "[ pflux ] and [ eflux ] ) . having placed the shock at @xmath67 ( with the upstream at @xmath68 ) , the definition adopted in the model is that a particle is thermal if it has never crossed the coordinate @xmath67 going against the flow ( it never got injected ) , and a cr particle otherwise . therefore , for @xmath69 eqs .",
    "[ pflux ] and [ eflux ] are rewritten as @xmath70 where @xmath71 is the distribution function containing only cosmic ray contribution in the sense of the above definition . at @xmath69 , where anisotropies of thermal particle distribution are important , eqs .",
    "[ pflux ] and [ eflux ] are used .    as one can see , between the location @xmath62 and the subshock , thermal particles",
    "are only heated by compression , but if this compression is rapid , like at the subshock , this compressive heating is non - adiabatic .",
    "in fact , it turns out that the solutions provided by the model contain a region of finite thickness @xmath72 , in which this non - adiabatic compressive heating takes place : this region is interpreted as the subshock .",
    "the semi - analytic formalism for the nldsa problem developed by caprioli , amato and blasi ( hereafter cab ) couples the conservation of mass , momentum and energy flux with an analytical solution of the stationary diffusion - convection equation for the isotropic part of the cr distribution function @xcite .    more precisely , the transport equation is taken as in eq .",
    "[ diffcon ] , with the velocity of the scattering centres @xmath73 neglected with respect to the fluid one , their ratio being typically of order of @xmath74 : @xmath75+\\frac{p}{3}\\frac { du}{dx}\\frac{{\\partial}f}{{\\partial}p}+\\mathcal{q}(x , p)\\,.\\ ] ] the injection term @xmath76 is written following @xcite as @xmath77 where @xmath78 is the fraction of particles crossing the shock and injected in the acceleration process and @xmath79 is the injection momentum ( see  [ cab : inj ] for further details ) .",
    "eq .  [ diffconvstat ]",
    "is solved imposing the upstream boundary condition @xmath80 as in kj model , which mimics the presence of a free - escape boundary at a distance @xmath81 upstream of the shock . a net flux of particles @xmath82 escaping the system from this boundary",
    "is expected to grant the achievement of a stationary configuration , as discussed in @xcite .",
    "an excellent approximate solution of eq .",
    "[ diffconvstat ] is found to be : @xmath83   \\left [ 1-\\frac{\\lambda(x , p)}{\\lambda_{0}(p)}\\right];\\label{eq : app - f}\\\\ \\phi_{esc}(p)&=&-d(p)\\left[\\frac{\\partial f}{\\partial x}\\right]_{x_0}=- \\frac{u_{0}{f_{sh}(p)}}{\\lambda_{0}(p)}~,\\label{eq : esccab}\\end{aligned}\\ ] ] where @xmath84;\\qquad   \\lambda_{0}(p)=\\lambda(x_{0},p)\\ ] ] embeds all the information on the escape flux and the cr distribution function at the shock position @xmath85 can be implicitly written as @xmath86\\right\\},\\label{eq : fsh}\\\\ u_{p}(p)&=&\\frac{{r_{sub}}}{{r_{tot}}}-\\frac{1}{{f_{sh}(p)}}\\int_{x_{0}}^{0}{\\rmn{d}}x f(x , p)\\frac{du}{d x}.\\label{eq : up}\\end{aligned}\\ ] ] here we introduced the normalized fluid velocity @xmath87 and the compression ratios at the subshock @xmath88 and between @xmath81 and downstream @xmath89 .",
    "the solution of the problem is found using a recursive method , starting from a guess for @xmath90 ( the compression ratios are linked together by eq .  [ rsrtth ] ) , along with a guess for the cr distribution function at the shock and the escape flux ( the test - particle solution of * ? ? ?",
    "* at each step of iteration the pressure in crs is calculated from the distribution function as : @xmath91 and it is normalized to the valued of @xmath92 deduced from the momentum conservation equation integrated between positions immediately upstream of the subshock and @xmath81 ; namely @xmath93 where @xmath94 is given by eq .",
    "[ eq : pgas ] . * with this normalized cr pressure , it is possible to calculate at first @xmath95 from momentum conservation and eventually a new @xmath96 via eqs .",
    "[ eq : app - f][eq : up ] .",
    "the steps above are iterated , leaving @xmath97 unchanged until convergence is reached , i.e.  until the factor normalizing @xmath92 does not change between one step and the following : in general this factor is different from 1 , which means that the chosen @xmath97 does not provide a physical solution of the problem .",
    "the whole process is thus restarted with a new choice of @xmath97 until the iteration on @xmath96 leads to a distribution function which does not need to be re - normalized in order to satisfy momentum conservation : the @xmath96 and the @xmath95 found in this way represent the solution of the nldsa problem .    once the solution has been found , the equation for the conservation of the energy is satisfied as well , and the energy carried away by escaping particles , normalized to @xmath98 , can be written as @xmath99 or also as the difference between the gas energy flux at @xmath81 and the whole energy flux downstream , namely : @xmath100 where @xmath101 is the adiabatic index of the relativistic gas of cosmic rays .",
    "the time required to run this iterative scheme is less than one minute on a current generation cpu .",
    "also in this approach the injection of particles into the acceleration mechanism is taken as occurring immediately downstream of the shock due to thermal leakage , as in kj .",
    "however , the implementation by @xcite adopted here is simplified with respect to the kj model , because it does not include a smooth transparency function .",
    "the injection momentum @xmath79 is in fact chosen as a multiple of the thermal momentum of downstream particles , namely : @xmath102 , with @xmath103 .",
    "the shift @xmath104 comes from the assumption that thermal particles downstream have a maxwellian spectrum in the fluid reference frame , while @xmath79 and the equations above are written in the shock frame . under this hypothesis",
    "the fraction @xmath78 ( eq .  [ eq : eta ] ) is uniquely determined by the choice of @xmath105 , namely : @xmath106      as in the previous approaches , precursor heating due to the dissipation of alfvnic turbulence can be taken into account as described in @xcite , following the implementation proposed by @xcite .",
    "in particular , the entropy conservation for the gas ( eq .  [ turbheat ] ) determines the gas pressure in the presence of a non - adiabatic heating as @xmath107\\,;\\qquad      h(x)=\\gamma(\\gamma-1)\\frac{m_0 ^ 2}{m_{a,0 } }      \\left[\\frac{1-u^{\\gamma+1/2}(x)}{\\gamma+1/2}\\right],\\ ] ] where @xmath108 is the plasma pressure as calculated taking into account only adiabatic compression in the precursor , i.e.  @xmath109const .",
    "this expression serves as an equation of state for the gas in the presence of effective alfvn heating and leads to the following relation between the compression ratios @xmath110 and @xmath111 @xcite : @xmath112\\,.\\ ] ] and in turn @xmath113 where @xmath114 is given by eq .",
    "[ eq : pgas ] evaluated upstream of the subshock .    for completeness , the downstream temperature is thus calculated to be @xmath115",
    "in this section the three approaches described above are applied to the same physical problem , in order to emphasize analogies and differences among themselves .",
    "the benchmark case studied here is a plane , parallel shock with velocity @xmath116 propagating in a homogeneous background with magnetic field @xmath117 g , particle density @xmath118 @xmath119 and temperature @xmath120 , corresponding to a sonic mach number @xmath121 .",
    "the corresponding alfvn speed is , @xmath122 , with an alfvnic mach number , @xmath123 .",
    "the upstream free escape boundary is located at @xmath124 cm and the diffusion is taken as bohm - like diffusion in the background magnetic field @xmath125 . in approaches where a diffusion coefficient is needed , this is equivalent to @xmath126 with @xmath127 . in order to give an idea of the length - scale imposed here",
    ", the choice of @xmath81 corresponds to the diffusion length @xmath128 of a particle with momentum @xmath129gev / c , which approximates the upper cutoff momentum , @xmath130 , obtained in all the solutions .",
    "this set of environmental parameters is well defined for the stationary approaches of ev and cab , but is slightly trickier for the time - dependent case of kj .",
    "as noted previously , their simulations start with a purely gasdynamic shock established by r - h conditions to give a shock speed , @xmath131 at rest at @xmath132 .",
    "there are no pre - existing crs , @xmath133 at @xmath134 . as suprathermal particles are injected at the subshock and accelerated , the cr pressure increases , while total compression increases and the shock is slowed down .",
    "when the shock has reached the self - consistent dynamical equilibrium state , the speed becomes @xmath135 , which equals to the shock speed of steady state solutions obtained by the other two methods .",
    "we emphasize again that a gasdynamic shock evolved into a cr modified shock can reach a true steady state only when crs escape the shock structure and carry away energy at a rate that balances the rate at which crs gain energy through dsa . in these simulations that escape",
    "comes through imposition of a free escape boundary at @xmath59 .    in ev approach , there is no distinction between thermal and non - thermal particles , hence particle injection is intrinsically defined by the choice of the scattering properties ( as in  [ ev : model ] ) , and so it is not controlled with a free parameter . in order to match this intrinsic recipe for the injection embedded in the monte carlo approach ,",
    "we chose values of @xmath29 and @xmath136 , which lead to similar total compression ratios as ev s , @xmath137 . quantitatively speaking , kj chose @xmath138 ( see  [ kj : inj ] ) , while cab fixed @xmath139 (  [ cab : inj ] ) , corresponding to the injection of a fraction @xmath140 of the flux of particles crossing the subshock .",
    "it turns out these choices push the cr acceleration close to its maximum efficiency , because the non - linear feedback and shock modification saturate with respect to increased injection .",
    "it has been shown previously that , for moderately strong shocks ( @xmath141 ) , the cr acceleration efficiency and the shock modification become insensitive to the values of @xmath29 and @xmath136 for the injection fraction above a critical value , @xmath142 ( e.g. , * ? ? ?",
    "* ) .       at the shock position , in the shock frame ,",
    "multiplied by @xmath143 , calculated within different approaches as in the legend.,scaledwidth=90.0% ]    in fig .",
    "[ fig : spectra ] the particle distribution at the shock position is shown as a function of the normalized momentum @xmath144 , as multiplied by @xmath145 in order to emphasize the main scaling .",
    "the agreement among the three solutions is indeed very satisfactory : the concave shape of the cr spectrum typical of cr modified shock models is recovered within all the approaches : in particular , @xmath146 is steeper than @xmath1 at low momenta and then flattens towards higher momenta , until it turns down sharply above @xmath130 .",
    "the peaks of the distributions of the thermal particles calculated with the three different approaches match very well , and the thermal distributions in the two thermal leakage injection models are in excellent agreement . in the monte carlo approach",
    "the transition between thermal and non - thermal particles is much broader than in thermal leakage ones .",
    "moreover , the transparency function implemented in kj thermal leakage modeling makes this transition smoother than in cab one , which shows a sharp break between thermal and non - thermal populations . nevertheless , despite of these different ways of dealing with particle injection , above 0.1 gev / c",
    "all spectra are very close to each other .",
    "as estimated at the beginning of the section , the spectrum has to be cut - off around @xmath147gev / c as a consequence of the escape of the highest energy particles , which are not able to diffuse back to the shock .",
    "the position and the shape of the momentum cut - off is consistent among the different models , with the ev solution extending about 10 per cent higher in energy with respect to the other cases ( see also the left panel of fig .  [",
    "fig : escape ] ) .",
    "this is due to a subtle difference in the definition of the transport properties of particles : the models of cba and kj use a diffusion coefficient to describe relativistic particle propagation , and the model of ev defines a small - angle scattering rate instead , which leads to some 20 per cent difference in the effective particle mean free path , which is a small factor compared to the uncertainty in the model of particle diffusion ( see e.g.",
    "  3.1.2 in * ? ? ?",
    "the spectrum of particles escaping the system from the upstream boundary @xmath82 is shown in the left panel of fig .  [",
    "fig : escape ] ( heavy lines ) , as multiplied by @xmath148 and compared with the highest end of the spectrum at the shock location , @xmath149 ( thin lines ) .",
    "the spectra obtained with different methods are in good agreement , with a slight shift towards higher energies of the peak of the spectral distribution found within the monte carlo approach as discussed above .",
    "this fact is of great interest since particles escaping the system from the upstream are expected to be responsible for the highest energy region of the galactic diffuse cosmic ray spectrum ( see e.g. * ? ? ?",
    "in particular , provided that escape occurs when the shock evolution is quasi - stationary ( a reasonable assumption during the sedov - taylor stage of a snrs , when the instantaneous maximum energy is thought to be limited by the accelerator size and not by the acceleration time ) , the rate and the spectrum of accelerated particles that are injected in the galaxy as crs is found to be the same in all the approaches .",
    "this remarkable agreement between models that solve the particle transport via monte carlo techniques or via the diffusion equation is not trivial at all , since the anisotropy of the particle distribution function is treated in radically different ways . in order to better understand this point we introduce the quantity @xmath150 which measures the anisotropy of the cr distribution function , averaged over @xmath16 , at the position @xmath43 .",
    "here @xmath151 , with @xmath152 corresponding to particles moving against ( in the direction of ) the flow , and @xmath153 is normalized such that @xmath154 .",
    "while the monte carlo approach directly takes the anisotropy of the distribution function into account ( see  [ ev : model ] ) , the other approaches solve the diffusion - convection equation for the isotropic part only .",
    "more precisely , in the diffusive approximation the distribution function is taken as the sum of an isotropic term @xmath155 and a dipole - like anisotropic one @xmath156 , in such a way that @xmath157 this is expected to be a very good approximation for non - relativistic shocks since the @xmath158 term in the anisotropy expansion is of order @xmath159 ( see e.g. * ? ? ?",
    "* for a thorough derivation of the diffusion - convection equation ) .",
    "the introduction of the spatial diffusion coefficient in fact allows one to eliminate @xmath160 , and the diffusive flux reads @xmath161     ( @xmath162 , heavy lines ) and particle distribution at the shock ( @xmath163 , thin lines ) .",
    "different curves correspond to different models , as in the legend of fig .",
    "[ fig : spectra ] . _ right panel _ : angular distribution , averaged over momenta , of escaping particles ( @xmath164 , top ) and of the particles immediately downstream of the free - escape boundary ( @xmath165 , bottom).,title=\"fig:\",scaledwidth=48.0% ]   ( @xmath162 , heavy lines ) and particle distribution at the shock ( @xmath163 , thin lines ) .",
    "different curves correspond to different models , as in the legend of fig .",
    "[ fig : spectra ] .",
    "_ right panel _ : angular distribution , averaged over momenta , of escaping particles ( @xmath164 , top ) and of the particles immediately downstream of the free - escape boundary ( @xmath165 , bottom).,title=\"fig:\",scaledwidth=48.0% ]    we are particularly interested in the anisotropy at the free - escape boundary , where it is expected to be the largest , but there is a caveat in carrying out this analysis . whichever is the value of the distribution function at @xmath81 as a function of @xmath16 , the anisotropy immediately downstream of @xmath81 , which we will refer to as @xmath165 , and immediately upstream of @xmath81 , indicated with @xmath166 ,",
    "are intrinsically different .",
    "this must be true , since upstream of @xmath81 particles must escape the system , and hence , @xmath166 has to vanish for @xmath167 .",
    "downstream of @xmath81 , instead , particles can diffuse back to the shock and thus eq .  [ eq : expansion ] safely holds also for @xmath168 .    keeping this difference in mind , we can write the anisotropy of the distribution function at the position @xmath81 also for diffusive approaches using eqs .  [ eq : g]-[eq : f1 ] , obtaining @xmath169 while the anisotropy of the escaping particles reads @xmath170 where @xmath171 is the usual heaviside step function .",
    "this procedure allows one to work out the expected anisotropy close to the escape boundary within the numerical approach of kj , where the boundary condition @xmath172 is imposed and thus @xmath173 is finite , but also in the semi - analytical approach of cab , where @xmath173 is imposed to be exactly 0 , simply by taking the left limit for @xmath174 in the equations above .",
    "the results are shown in the right panel of fig .",
    "[ fig : escape ] , along with the result of the monte carlo simulation by ev at @xmath81 ( top panel ) and at @xmath175 ( bottom panel ) .",
    "also in this case the agreement among the different approaches is remarkable and , most interestingly , the degree of anisotropy which the methods based on the solution of the diffusion - convection equation are able to retain is indeed very accurate , even when compared to the monte carlo method which deals with the fully anisotropic distribution function and which can track the smooth transition from the linear to the step - like functional form of @xmath153 in the range @xmath176 .",
    "quantitatively speaking , we can safely conclude that , for plane non - relativistic shocks , the discrepancies in the spectra of accelerated and escaping particles between time - dependent and stationary approaches or between nldsa models taking or not into account the anisotropy of the distribution function are well within any uncertainty induced , for instance , by any observational constraint of the several environmental parameters of a given astrophysical object .      , _ left panel _ ) and density ( normalized to @xmath177__right panel _ _ ) in the three different approaches . here and in the following figures the shock faces to the right and is rest at @xmath67 ; the upstream is truncated at @xmath178 and the downstream is assumed as homogeneous and not in scale.,title=\"fig:\",scaledwidth=48.0% ] , _ left panel _ ) and density ( normalized to @xmath177__right panel _ _ ) in the three different approaches . here and in the following figures the shock faces to the right and is rest at @xmath67 ; the upstream is truncated at @xmath178 and the downstream is assumed as homogeneous and not in scale.,title=\"fig:\",scaledwidth=48.0% ]    the spatial structures of the modified shocks are quite consistent among the three models .",
    "this is evident from fig .",
    "[ fig : hydro ] which compares velocity and density profiles . as stated above",
    ", the cr acceleration efficiencies are very close to the upper limits allowed by the system when turbulent heating is taken into account .",
    "the slightly different saturation levels achieved in different approaches might thus be regarded as due to intrinsic properties of the models .",
    "all the models return the same ratio of unperturbed to downstream fluid density @xmath179 within a tolerance of less than 10 per cent .",
    "in particular , the total compression ratios are found to be @xmath180 , @xmath181 and @xmath182 , corresponding to cr acceleration efficiencies of about 60 per cent of the bulk pressure for cab and kj approaches and of about 75 per cent in the ev case . the higher shock modification in the ev case is due to a larger amount of energy in supra - thermal , non relativistic particles compared to the cab and kj approaches ( see fig .  [",
    "fig : spectra ] ) .    in the precursor",
    "the total spread among the model profiles is within a 10 - 20 per cent tolerance .",
    "unfortunately , at the moment there are no observations able to resolve the spatial structure of a precursor . in addition",
    ", all the hydrodynamical evidence of efficient cr acceleration at snr shocks comes from estimates of the separation distance between the the forward shock and the contact discontinuity ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* for tycho and sn1006 , respectively ) , or by an estimated suppression of the downstream plasma temperature ( e.g. * ? ? ?",
    "* ) with respect to the pure gaseous case .",
    "on the other hand , it was suggested that the h@xmath183 profiles in tycho s snr shock might indicate the presence of a cr precursor ( e.g. * ? ? ?",
    "title=\"fig:\",scaledwidth=48.0% ] , title=\"fig:\",scaledwidth=48.0% ]    in fig .",
    "[ fig : termo ] the gas pressure and temperature are shown for the three models , confirming once again that all the approaches lead to consistent results .",
    "the lower values of the downstream gas pressure and temperature in the monte carlo approach with respect to the other cases may be due to the slightly more marked shock modification , since the larger is the amount of energy channelled into accelerated particles , the lower is the energy left for heating up the downstream plasma . on the other hand , above the thermal peak the monte carlo solution shows significant deviation from a pure maxwellian distribution , because the injection model adopted in the simulation and the nature of the calculation allow mildly accelerated particles ( those having crossed the shock only a few times ) to be present in the shock vicinity .",
    "finally , the fraction of the bulk energy density flux @xmath184 carried away by particles escaping the system at the upstream boundary is found to be @xmath185 , @xmath186 and @xmath187 , consistently with the small differences in the acceleration efficiencies outlined above .",
    "in this work we conducted a comparison among numerical , monte carlo and semi - analytical approaches to nldsa theory by solving a benchmark case for an astrophysical plane , non - relativistic strong shock .",
    "in particular we examined a case in which cosmic rays are efficiently accelerated and strongly modify the shock with their dynamical back - reaction .",
    "the results obtained with the three different techniques that assume specific and distinct recipes for physical ingredients such as particle injection , particle escape and diffusion properties are very consistent with each other in terms of both accelerated ( and escaping ) spectra and hydrodynamics .",
    "these findings represent an actual investigation of the role that specific pieces of information embedded in each approach have in modeling cosmic ray modified shocks . in particular",
    ", we showed how the solution obtained when the stationary state is achieved by ( a ) letting the system evolve at the presence of a free - escape boundary ( the numerical approach , see[sec : kj ] ) , ( b ) a steady - state solution in which the particle transport is described statistically through a monte carlo technique (  [ sec : ev ] ) , or ( c ) the semi - analytic solution of the stationary diffusion - convection equation for the isotropic part of the cosmic ray distribution function (  [ sec : cab ] ) show an agreement well within any uncertainty intrinsic to the basic physics of the process .",
    "thus , the agreement would not allow distinction of the methods using current observations .",
    "at the same time , it is worth recalling that all the models are rather flexible and may be updated with any new physical insight which may come from present and future observations . very generally , these methods are limited more by our real knowledge of the mechanisms going on in a snr shock than by the possibility of implementation of these effects .",
    "an important example of a piece of information that can be embedded in all the methods is a more detailed description of the magnetic field responsible for the particle scattering . in the calculations above",
    "we did not include any process leading to the amplification of the background magnetic field due to cr streaming instabilities @xcite , nor any dynamical feedback of the magnetic turbulence in the shock dynamics @xcite . on the other hand , by assuming bohm - like diffusion we have intrinsically taken into account a magnetic configuration quite different from the typical interstellar one @xcite .",
    "moreover , we included a phenomenological model for a non - adiabatic heating of the upstream background plasma as due to the instantaneous damping of all the magnetic turbulence produced via resonant streaming instability , as described in @xcite .",
    "this very efficient damping , while largely adopted in order to prevent dramatic shock modification , is however inconsistent with magnetic fields of order @xmath188 g inferred in the downstream of some young snrs ( see e.g. * ? ? ?",
    "* ) : in these environments the shock modification may be controlled by the non - negligible dynamical role of the amplified magnetic field , an effect which can be easily included in the models above ( see * ? ? ?",
    "* ; * ? ? ?",
    "another interesting finding of our comparison is that not only monte carlo simulations , but also methods based on the solution of the diffusion - convection equation can retain reliable information about the anisotropy of the distribution function , even close to the free - escape boundary , in many astrophysical cases .",
    "this fact allows one to use the so - derived diffusive cr current to calculate the excitation of modes relevant for the growth of the magnetic turbulence , as predicted in many scenarios involving the self - generation of an amplified magnetic field responsible in which particles are scattered very efficiently ( see e.g. * ? ? ?",
    "* for the calculation of the bell non - resonant streaming instability excited by escaping particles ) .    in this work we considered a situation",
    "in which injection occurs very efficiently , as suggested by the monte carlo modeling of the subshock .",
    "this choice , while on one hand perfectly reproduces the observations of the earth bow shock ( e.g. * ? ? ?",
    "* ) , on the other hand is not firmly supported by observational evidence in snr shocks . for typical values of temperatures and magnetic fields in snr environments , in fact",
    ", the region of the spectrum between the thermal and the non - thermal distributions does not provide , at the moment , any strong signature testable with multi - wavelength studies of snrs . in this respect ,",
    "a simple parametrization of the injection process like the thermal leakage captures most of the ( non - linear ) physics which is expected to be relevant in nldsa theory .",
    "further improvements in discrimination between the various models of particle injection can be expected from the ongoing work on particle - in - cell simulations of non - relativistic shocks .",
    "dealing with strongly modified shocks is indeed very challenging for fully numerical methods .",
    "when huge gradients are found in the precursor , the system very likely develops some instabilities , whose nature may be not only numerical , but also physical .",
    "for instance , the acoustic instability studied by @xcite can develop strong inhomogeneities , which can drive turbulence in multi - dimensional flows .",
    "numerical methods are thus tools necessary in order to unravel these kind of questions , being in principle able to follow the growth of instabilities even in the non - linear regime , typically inaccessible to analytical approaches .    a numerical simulation is currently the only way to deal with time - dependent nldsa problems .",
    "we recall that there are two main ways of accounting for the dependence on time of the physical quantities : on one hand we have cases in which the shock velocity is almost constant and only cr - related quantities are expected to vary on time scales comparable with the acceleration time at @xmath130 , and on the other hand we have cases in which also `` environmental '' quantities , like the shock velocity , change with time .",
    "the former case is realized for instance during the ejecta dominated stage of a snr , in which the shock is not dramatically slowed down by the inertia of the swept - up material .",
    "nevertheless , if a spatial boundary condition is imposed in such a way that particles are free to escape from an upstream boundary , also in this case a steady - state solution consistent with stationary approaches may be recovered .",
    "otherwise , if @xmath130 is free to grow unconstrained by spatial limits , the system evolves according to a self - similar behavior as shown by @xcite : also in this case stationary approaches , with a proper age - limited maximum momentum ( * ? ? ? * see ) , should be able to reproduce the correct results .",
    "the latter case , instead , is expected to be realized in the sedov - taylor stage of the evolution of snrs . as shown by @xcite , during this stage the decrease of the shock velocity",
    "is expected to lead to a decrease of the magnetic field amplification and in turn to a drop of the confinement power of the system . at",
    "any given time particles with momentum close to @xmath189 can not diffuse back to the shock and escape the system upstream , thus , carrying away a sizable fraction of the energy flow into the shock .",
    "this situation is thought to lead to the achievement of a quasi - stationary configuration in which particle acceleration and losses balance themselves ; also in this case a time - independent approach might be a good description of the problem .    in the case in which the assumption of quasi - stationarity is satisfied , modeling an astrophysical object might require one to run the nldsa code many times : one for each time - step , for any given choice of the many environmental and model parameters .",
    "it is clear that such an investigation can be conducted only by using very fast solutions of the nldsa problem , and semi - analytical approaches can do this job very well ( see e.g. * ? ? ?",
    "* for an example )",
    ".    finally , monte carlo codes allow one to take into account strong anisotropies of the cr distribution function , for which the diffusive approximation and hence the solution of the diffusion - convection equation for the isotropic part of @xmath41 only may fail by a large amount .",
    "this point is of central interest especially for the study of mildly - relativistic and relativistic shocks @xcite , since anisotropic corrections to eq .",
    "[ diffcon ] are of order @xmath190 , as outlined in ",
    "[ sec : escape ] .",
    "the last consideration is about an assumption that is ubiquitous in nldsa theories ; namely , that particle are efficiently scattered by magnetic irregularities and in a _ diffusive _ way . this assumption may be broken close to @xmath81 , beyond which particles are expected to stream away without diffusing , or even in the precursor if the topology of the magnetic field is organized in structures like the cavities predicted by bell s instability @xcite .",
    "nonetheless it is worth stressing that in the literature no non - linear particle acceleration methods able to relax the hypothesis that particle are scattered in a diffusive way ( which is embedded also in monte carlo approaches ) have been developed yet",
    ". such a problem could be in principle addressed by particle in cell ( pic ) simulations , but the computational time required to run a case in which the spectrum of accelerated particles spans many order of magnitudes is now , and it is going to be for years , prohibitive even for huge computer clusters .",
    "this research was supported in part by the national science foundation under grant no . phy05 - 51164 , in the context of the program _ particle acceleration in astrophysical plasmas _ , ( 2009 , july 26-october 3 ) , held at the kavli institute for theoretical physics ( santa barbara , ca ) .",
    "the authors want to thank all the participants to the program , but in particular way don ellison and pasquale blasi for their suggestions and illuminating contributions to this comparison project .",
    "dc was supported by asi through contract asi - inaf i/088/06/0 .",
    "hk was supported by national research foundation of korea through grant 2010 - 016425 av was supported by nasa grants 06-atp06 - 21 and nnx09ac15 g .",
    "twj was supported by nasa grant nnx09ah78 g and by the university of minnesota supercomputing institute ."
  ],
  "abstract_text": [
    "<S> we provide a both qualitative and quantitative comparison among different approaches aimed to solve the problem of non - linear diffusive acceleration of particles at shocks . </S>",
    "<S> in particular , we show that state - of - the - art models ( numerical , monte carlo and semi - analytical ) , even if based on different physical assumptions and implementations , for typical environmental parameters lead to very consistent results in terms of shock hydrodynamics , cosmic ray spectrum and also escaping flux spectrum and anisotropy . </S>",
    "<S> strong points and limits of each approach are also discussed , as a function of the problem one wants to study .    </S>",
    "<S> [ firstpage ]    acceleration of particles - cosmic rays - dsa </S>"
  ]
}