{
  "article_text": [
    "structure solution without crystals was not conceivable for nearly a century .",
    "however , linac based x - fel - s will soon become operational and their extremely short and intense pulses offer the chance for a new type of experiment .",
    "the concept of single molecule imaging @xcite is based on fast measurement of a `` slowly '' exploding system . in the proposed experiment",
    "the molecule does not have time to deteriorate during a single x - ray pulse and enough elastically scattered photons can be collected to give information on the unmodified structure .",
    "there are two distinct theoretical parts of the problem : the coulomb explosion and the image reconstruction process . in a previous paper",
    "we have given a detailed description of the coulomb explosion @xcite .",
    "in the present work we analyse the effect of the explosion on the image reconstruction .",
    "up to now only two papers have been published on the coulomb explosion initiated by hard x - ray pulses . in the first",
    ", the explosion of a lysozime molecule has been modelled @xcite . in the second",
    ", 100 - 1500 atom carbon clusters exploded under the influence of a single pulse @xcite .",
    "these works are special molecular dynamics calculations of charged particles , which take into account various quantum processes initiated by the photoeffect . from this point of view",
    ", the second set of calculations is closer to reality , because it handles all processes which change the dynamics of the system .",
    "therefore , our treatment of coulomb explosion is based on this work .",
    "image reconstruction from intensity data - also known as the phase retrieval in optics - has a more extended literature . over years of practice fienup",
    "s hybrid input - output method @xcite proved to be the most successful algorithm of phase retrieval .",
    "it is based on a no density region surrounding a non - periodic object in real space and a corresponding densely sampled data in reciprocal space .",
    "those with a crystallographic background also use the term _ oversampling _ for this scenario , meaning that it uses more data than conventional bragg sampling of crystals would allow @xcite . while oversampling is not applicable in the case of crystals , it is well suited for single molecule imaging .",
    "a recent paper already applied this method for the reconstruction of 3d synthetic data of a static macromolecule @xcite .",
    "none of the earlier papers treated the coulomb explosion and the reconstruction process together , which we shall do in the present work .",
    "we also discuss the fundamental questions : how the atom density affects the coulomb explosion and reconstruction , what time - window of a single pulse is available for useful data collection and finally how multi - pulse measurements affect reconstruction .",
    "the answers are crucial for planning an experiment with the target of single molecule structure solution .",
    "atomic resolution imaging is important in many fields of science , from solid state physics to biology .",
    "this diverse interest covers cluster sizes ranging from a few tens to millions of atoms .",
    "the original proposal of single molecule imaging came from biology but biological macromolecules are too large to accurately model their coulomb explosion .",
    "therefore , we follow the time evolution of smaller atomic clusters .",
    "we expect that the results can be plausibly extended to larger systems and the general conclusions are also relevant to macromolecules .",
    "our model system is a 200-atom carbon cluster forming an incomplete cube , as shown in fig .",
    "atoms are scattered around grid points of a simple cubic lattice and are held together by central forces .",
    "three different lattice spacings were investigated : @xmath0=1.5 , 2.4 and 3.0   .",
    "the depth of the bonding potential corresponds to the covalent bond for the 1.5   lattice , to the van der waals bond for the 3.0   lattice and it is linearly interpolated for the intermediate 2.4   lattice . with this choice of parameters we can study the characteristics of the explosion for a wide range of atom density and bond strength .",
    "the calculation follows the time evolution of the system while a gaussian shape x - ray pulse is incident on the sample .",
    "we solve the classical equations of motion for all the particles ( atoms , electrons and ions ) as described in @xcite .",
    "quantum processes are taken into account as random events by probabilities corresponding to their cross sections .",
    "we include the photoeffect , auger processes , coulomb interaction and inelastic electron scattering .",
    "the parameters of the pulse are : 10 kev photon energy , @xmath1 integrated photon number and 10  fs full width at half maximum .",
    "note that the pulse width is shorter than initially expected at hard x - ray fel - s @xcite .",
    "however , current efforts to decrease the pulse width below 100  fs are promising and reaching 10  fs is not unrealistic @xcite .",
    "the reason for this choice is that the shorter the pulse the higher the ratio of photons available for useful imaging .    to illustrate the changes of the atomic configuration during a pulse ,",
    "the time evolution of a typical coulomb explosion of the @xmath0=1.5   cluster is shown in fig .",
    "the total period of model calculation is between @xmath2=0 and 30  fs where 15  fs corresponds to the maximum of the gaussian shape pulse .",
    "it is clear that up to 10  fs the cluster is almost unchanged .",
    "visible distortions start to develop at 12  fs and by 18  fs the cluster has totally disintegrated . to quantify the explosion we calculated the cluster charge and the mean displacement as a function of time for the three atom densities ( see fig .  [ fig3 ] ) .",
    "the total charge shows how many electrons scatter elastically while the mean displacement gives an estimate for the distortion of geometry .",
    "the trend in both series of curves indicates that the explosion takes longer for low atom densities .",
    "this is in agreement with natural expectations , the coulomb repulsion is smaller for ions at larger distances .",
    "we can learn two important facts from figs .",
    "[ fig2 ] and [ fig3 ] .",
    "( i ) useful data can be collected only in the first part of the pulse .",
    "( ii ) low density systems will allow more time for data collection .",
    "however , no cleverly chosen parameter can replace the real reconstruction process . during the explosion the elastic scattering pattern changes significantly and",
    "what we measure is a composite pattern .",
    "it is not trivial that using this composite pattern as input data , the original atomic configuration can be reconstructed .",
    "in this work we used a modification of fienup s hybrid input - output algorithm . in real space the charge density is represented in a cubic box with cell edge @xmath3 and grid spacing @xmath4 .",
    "the box size @xmath3 must be larger than the object and the grid spacing @xmath4 must be sufficiently fine to reconstruct atoms .",
    "we used @xmath3=25 , 35 and 40   for the three different atom densities while @xmath4=0.4   was kept constant . the real space charge density and the reciprocal space scattering amplitudes",
    "are related by the discrete fourier transform .",
    "thus amplitudes in reciprocal space are also represented in a cubic box with a cell edge @xmath5 and grid spacing @xmath6 .",
    "measurement of elastic scattering is required at points of this dense grid .",
    "the reciprocal space box limits the maximum momentum transfer at @xmath7 .",
    "we use all data within the sphere of radius @xmath8 and treat unobserved data outside the sphere as zeros .",
    "the algorithm requires a molecular support , which completely surrounds the object . the object is smaller than its support and the charge density is positive",
    "- these are the simple a priori constraints .",
    "we used a spherical volume , which is a loose support , it poorly approximates the shape of the cluster .",
    "the volume ratio @xmath9 is called the oversampling parameter , denoted by @xmath10 . for the three atom densities we chose the radius 10 , 14 and 16  ",
    ", corresponding to @xmath11 for which the algorithm is expected to work .",
    "fienup s method is a special type of density modification , it cycles between real and reciprocal space by the fourier transform . in real space",
    "the charge density is modified only where the support or positivity constraints are violated , while in reciprocal space the observed moduli and model phases are combined without a condition .",
    "the @xmath12 reciprocal space amplitude corresponds to the total charge but is unobserved .",
    "we chose the correct ab initio treatment , it is initialized to zero and then allowed to change freely .",
    "the iteration starts with a random phase set in reciprocal space .",
    "testing multiple phase sets is important , some phase sets converge faster , while others do not converge within a fixed number of iterations .",
    "there is a single parameter @xmath13 in the real part of the algorithm , which acts as feedback . in the literature",
    "the typical value of @xmath13 is 0.5 - 0.9 , we used @xmath14 .",
    "our experience with the original algorithm is that after a number of iterations large negative charge density develops and oscillates which is a sign of over - amplification .",
    "the solution was to set the charge density outside the support to zero before each real space modification .",
    "this makes convergence slower but the quality of reconstruction is better . to evaluate a solution it is best both to plot the charge density and by peak picking analyse the number and position of atoms .",
    "our model cluster is a non - centrosymmetric object with pseudo - symmetries , its atomic resolution reconstruction is far from trivial .",
    "we carefully tested the algorithm by reconstructing static configurations of the exploding cluster at different times up to 20  fs . we found that any static configuration can be reconstructed in this time interval , so only the quality of real data will limit the structure solution .",
    "the reconstruction algorithm needs 3d data while in a single - pulse experiment only a 2d slice can be collected .",
    "therefore , even at ideal conditions , we can not measure the full data set during a single pulse .",
    "we have to merge the results of many repeated measurements , which are made on identical replicas of the molecule in different orientations . here",
    "we give an estimate for the minimum number of independent orientations and the total number of pulses necessary for a complete data set from a small biological molecule .",
    "let us take a typical macromolecule which is enclosed in the real space box with edge @xmath3=60   and require reconstruction on a grid with @xmath4=0.4   spacing .",
    "then reciprocal space data is represented in a box with edge @xmath5 and grid spacing @xmath6 . at the maximum resolution data",
    "is accessible only inside the limiting sphere with radius @xmath15 .",
    "the scattering intensity is sampled with @xmath16 density and @xmath17 is the total number of 3d data points .",
    "a single orientation provides 2d data on the surface of the ewald sphere with radius @xmath18 . assuming that each @xmath19 area of the @xmath20 surface gives independent information , a single orientation contributes @xmath21 points to the 3d data .",
    "so in this example the number of independent orientations is 100 . for larger molecules",
    "this number increases with the linear size of the box .",
    "this is the minimum number of orientations , which must be measured with adequate statistics .",
    "repeated measurements are needed both to cover all required orientations and also to improve their statistics .",
    "sorting individual single - pulse patterns into orientation bins is not discussed here but will need special attention .",
    "let us suppose there is no background , and the reconstruction algorithm can tolerate 10% noise .",
    "considering that x- ray scattering is strongly anisotropic we estimate that on average 100 elastically scattered photons per pixel must be collected . for the above example",
    "this is the order of @xmath22 photons / orientation and @xmath23 photons total .",
    "the elastic cross section of carbon and the intensity of @xmath1 photons / pulse lead to about @xmath24 elastically scattered photons per pulse .",
    "therefore , to construct 3d data with adequate statistics approximately @xmath25 repeated measurements must be done using the same number of replicas of the molecule .",
    "the coulomb explosion fundamentally determines the quality of data , which is available for structure solution . during data collection",
    "the scattering pattern changes drastically .",
    "even a 2d section of data measured by a single pulse is a composite pattern , a time integral weighted by the pulse intensity .",
    "we need the optimum integration time with the highest number of elastically scattered photons and a pattern closest to that of the original structure .",
    "if the time - window is too short then the statistics of individual patterns is poor .",
    "if the time - window is too long then the scattering of the disintegrated cluster becomes dominant , washing out the original structural information .",
    "for the sake of data quality part of the pulse must be thrown away and because the total number of photons is fixed , more measurements are needed for the same statistics .",
    "we will show that with the pulse width of 10  fs the increase in the number of measurements is not drastic , a factor of 2 to 4 .",
    "the situation could be worse with the pulse width of 100  fs because the same level of distortion is reached much before the peak , which means an order of magnitude less photons for reconstruction .",
    "here we give an estimate for the optimum integration time using 10  fs pulses .",
    "for simplicity we assume that 3d data can be obtained from a single experiment , as if separate explosions took place the same way .",
    "integration is approximated by summing the scattering pattern at each 0.5 fs time - slice with the weight of the gaussian pulse intensity .",
    "the upper limit of integration is @xmath26 .",
    "statistical uncertainty of real experiments is simulated by adding 10% noise to the composite pattern .",
    "then we make a reconstruction for each composite pattern and compare it to the original charge density .",
    "we accept the reconstruction for @xmath26 if all the atoms are found and the standard deviation of displacement does not exceed 0.3   . with these requirements the structure of the @xmath0=1.5 , 2.4 and 3.0   cluster was successfully recovered up to @xmath26=12 , 14 and 15  fs respectively .",
    "these time - windows correspond to 25 , 40 and 50% useful photons per pulse @xcite .",
    "collecting data for longer periods degrades the quality of the reconstruction , the useful structural information is quickly washed out .",
    "it is informative to follow the scattering pattern of individual time - slices .",
    "what happens is that the disintegrating cluster becomes random in real space , so its fourier transform turns into white noise .",
    "[ fig4 ] shows the quality of reconstruction for the @xmath0=1.5   cluster using integrated data up to @xmath26=12 and 18  fs . while with shorter integration we get a structure practically identical to the original cluster , just 6  fs longer integration leads to the loss of half of the atoms and to increased structural disorder .",
    "similar differences were found in the case of clusters with larger interatomic distances .",
    "the summary of the above results is : accurate gating will be critical for a real experiment .",
    "after giving an estimate for the optimum integration time of single pulses , we consider the effect of averaging in multi - pulse experiments .",
    "although in principle identical replicas of the molecule are used in consecutive experiments , their disintegration will follow different pathways .",
    "this is partly due to thermal vibration which displaces the starting atomic positions , and partly to the stochastic nature of photo - ionization , auger process and secondary ionization which changes the dynamics of the coulomb explosion .    to check the joint effect of the time integral and multi - pulse averaging on structure solution",
    ", we followed 100 explosions of the @xmath0=1.5   cluster .",
    "the deviation of the starting configurations was chosen to be small , corresponding to low temperature ( t=30 k ) .",
    "even so , the time evolution leads to differences in the atomic position and charge state which is already apparent at @xmath26=12  fs . the scattering pattern was calculated as before , but the time integral was added for all individual explosions .",
    "we found that the quality of reconstruction is somewhat better than for the single - pulse case .",
    "this is in accordance with expectations , averaging the contribution of many slightly different configurations results in a smaller deviation from the original structure .",
    "the improvement is not drastic , the useful integration time can be increased just by a femtosecond .",
    "in this work we have shown that single molecule imaging using hard x - fel pulses might be possible , but the experimental difficulties are more severe than anticipated earlier .",
    "our results differ from those of previous publications in several respects .",
    "first , the time evolution of the coulomb explosion is more reliable as we included all quantum processes in the simulation .",
    "second , we time integrated the scattering pattern of the exploding cluster and took into account the effect of multiple replicas .",
    "reconstruction of the original atomic structure was achieved using these composite patterns at 0.8   resolution .",
    "this is in contrast to previous work , which reconstructed a static structure at 2.5   resolution @xcite .    while giving a unified treatment of the coulomb explosion and reconstruction , we arrived at new conclusions : ( i ) we demonstrated that only part of the pulses can be efficiently used for data collection , therefore very fast gating will be required .",
    "( ii ) we analysed the reconstruction as a function of atom density , and found that lower density will allow more time for data collection . in terms of the fraction of total photons available for imaging",
    "this means a maximum of 50% .",
    "( iii ) we also showed that averaging the contribution of individual replicas in a multi - pulse experiment slightly improves the quality of reconstruction .",
    "finally , we would like to call attention to problems not discussed in the paper , but important for the feasibility of real experiments . in practice a complete data set",
    "can be collected by measuring a large number of identical replicas , and individual scattering patterns have to be arranged into 3d data on a reciprocal space grid . due to the low statistics of single patterns",
    "it will be difficult to sort them into distinct orientation bins .",
    "although electron microscopy successfully handles a similar problem @xcite , in the case of x - fel experiments it remains to be solved .",
    "an other serious problem is the low signal to noise ratio .",
    "as energy selective detectors are useless at the femtosecond timescale , the detector will count all the photons in the experiment .",
    "as the elastic scattering is weak , any spurious scattering will distort useful structural information .",
    "it is difficult to estimate the background level , but compton scattering will certainly give a contribution . its weight relative to elastic scattering is small while the electrons are localized on the atoms , but will drastically increase after photoionization . of course",
    ", background will also come from instrumental sources such as the beam path and sample environment .",
    "here we pointed out just a few experimental problems , probably there will be several others .",
    "however , the importance of single molecule imaging is so great that once it is shown to work given ideal conditions , it is worth the effort to realize the experiment and attempt the solution of these problems ."
  ],
  "abstract_text": [
    "<S> the ingenious idea of single molecule imaging by hard x - ray free electron laser ( x - fel ) pulses was recently proposed by neutze _ et al . </S>",
    "<S> _ @xcite . </S>",
    "<S> however , in their numerical modelling of the coulomb explosion several interactions were neglected and no reconstruction of the atomic structure was given . in this work we carried out improved molecular dynamics calculations including all quantum processes which affect the explosion . based on this time evolution we generated composite elastic scattering patterns , and by using fienup s algorithm successfully reconstructed the original atomic structure . </S>",
    "<S> the critical evaluation of these results gives guidelines and sets important conditions for future experiments aiming single molecule structure solution . </S>"
  ]
}