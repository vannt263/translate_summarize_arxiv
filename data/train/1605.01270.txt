{
  "article_text": [
    "studies involving non - invasive brain stimulation have reported remarkable changes in cognitive and behavioral performance @xcite . among those techniques ,",
    "transcranial alternating current stimulation ( tacs ) is particularly promising as it directly allows for the modulation of physiologically relevant brain oscillations that subserve cognitive operations @xcite .",
    "the effects of tacs are highly dependent on the frequency and phase of stimulation @xcite .",
    "the conventional tacs approach involves defining the frequency and phase of stimulation ad hoc and testing them on a cohort of subjects .",
    "however , this approach exhibits two limitations : ( 1 ) the brain networks targeted by the stimulation can not be verified without simultaneous fmri ; ( 2 ) those stimulation parameters may vary across subjects due to difference in anatomy or heterogeneity in disease . yet",
    ", there is a combinatorial explosion in the biologically plausible range of stimulation frequencies ( 1 - 100 hz ) and phases ( 0 - 359@xmath0 ) , resulting in up to thousands of possibilities . identifying the optimal stimulation protocol for a given individual is like  finding a needle in a haystack \"",
    "therefore , using conventional methodology makes tailoring tacs to an individual highly unfeasible . to address this fundamental challenge in the clinical use of tacs",
    ", we aim to combine tacs with a recently presented framework that behavior real - time functional magnetic resonance imaging ( fmri ) and bayesian optimization : the _ automatic neuroscientist _ @xcite .",
    "employing such a framework allows us to start with a target brain state and find a set of tacs parameters ( frequency and phase of stimulation ) for each individual that maximally activates it ( fig .",
    "[ fig : automaticneuroscientist ] ) .",
    "bayesian optimization is particularly relevant to such a problem as it provides a powerful strategy for finding maxima of objective functions that are expensive to evaluate and might contain noisy measurements ( both criteria are met with functional neuroimaging data ) .",
    "moreover , bayesian optimization is suited in situations where we do not have an analytical expression of the objective function nor can make formal statements regarding its properties @xcite . however , the implementation of bayesian optimization requires several fundamental choices that are paramount to the success of the technique ; such as ( 1 ) the choice of covariance function for the gaussian process ( gp ) prior and ( 2 ) the choice of acquisition function which determines the manner in which the space of parameters is explored .",
    "the aim of this study is to objectively compare the performance of a variety of distinct kernel functions ( resulting in distinct gp priors ) and acquisitions functions .",
    "offline fmri data from eight healthy volunteers receiving blocks of non - invasive tacs stimulation over left frontoparietal brain regions as well as simulation data were employed .",
    "the results obtained will be used to propose a combination of kernel and acquisition functions for upcoming real - time experiments .",
    "the objective of this work is to obtain a better understanding of the relationship between various combinations of tacs parameters ( i.e. , frequency and phase ) and each subject s neural response . in the framework of bayesian optimization",
    ", such a relationship is summarized by a latent objective function which we wish to infer . with this in mind , a small neuroimaging study was conducted where healthy participants received tacs consisting of various combinations of frequency and phase .",
    "this data was subsequently employed to perform model selection on the gp covariance function .",
    "in addition to this , simulation analyses were carried out to compare two popular acquisition functions .",
    "eight healthy volunteers ( 5 female , 24.75 @xmath1 3.49 years ) took part in our study .",
    "the study was approved by the hammersmith hospital ( london , uk ) research ethics committee .",
    "each participant performed three runs of a switch task @xcite in the mr scanner .",
    "each run consisted of task blocks ( 36 s ) interleaved with rest blocks ( 24 s ) . during task blocks ,",
    "tacs was applied via a pair of mr - compatible conductive rubber electrodes over left frontal ( f3 ) and left parietal ( p3 ) regions ( as determined by the international 10 - 20 eeg system ) .",
    "both return electrodes were placed on the ipsilateral shoulder .",
    "the current was fixed to 1 ma ( peak - to peak ) .",
    "the experiment parameter space was limited to ten different frequencies ( 0,1,5,8,12,16,20,26,40 and 80 hz ) and five different phases ( 0 , 60 , 90 , 180 and 270@xmath0 ) , resulting in 50 different frequency - and - phase combinations ( see fig .",
    "[ fig : space ] ) . for each run and each subject , we tested a subset of 14 identical frequency - and - phase combinations ( grey shaded squares in fig .",
    "[ fig : space ] ) .",
    "the order of those frequency - and - phase combinations was random for each run in order to eliminate any order effect of the stimulation on the subject s neural response .",
    "the condition without any stimulation ( 0 hz with 0@xmath0 ) was the only condition that was repeated two ( n=4 ) to four ( n=4 ) times within each run .",
    "whole - brain coverage images were acquired by a siemens verio 3 t scanner using an epi sequence ( tr : 1.5s ) .",
    "data was minimally preprocessed by applying motion - correction , high - pass filtering ( 100s ) and spatial smoothing ( 5 mm fwhm gaussian kernel ) .",
    "we than extracted 20 regions of interest ( rois ) that have been previously shown to predict trial - by - trial performance in task switching ( for roi definition we created 8 mm spheres around the peak coordinates reported in @xcite ) .",
    "the extracted timecourses were further cleaned by removing high - frequency noise and large signal spikes using a modified kalman filter @xcite .",
    "we then assessed changes in functional connectivity between those regions for blocks of tacs using psychophysiological interaction ( ppi ) analyses @xcite ( whilst also including six motion parameters as confounds ) .",
    "for the analyses presented here , we selected the two regions that exhibited the highest inter - run robustness across all subjects ( assessed using spearman s rank correlation coefficient ) : the left inferior parietal lobule and the posterior cingulate gyrus . in order to assess",
    "how likely the pattern of results between those regions could have occurred by chance , we performed non - parametric permutation testing ( 10,000 permutations ) and found the result to be highly significant ( _ _ z__=3.71 , _ _",
    "p__@xmath2.001 ) .          the underlying intuition behind the method of lorenz et al .",
    "@xcite is that the target brain pattern is a function of experimental conditions . as such",
    ", the authors propose to learn the relationship by modelling the observed brain state as a sample from a gaussian process ( gp ) .",
    "this facilitates the use of a bayesian optimization framework @xcite in a closed - loop form where subjects are presented with an experimental condition and real - time fmri provides instantaneous information about the subject s brain state .",
    "based on this , we can iteratively update our beliefs about the unknown objective function , captured in the posterior distribution of the gp . while lorenz et al .",
    "@xcite used simple perceptual stimuli in their original experiment , our study here involves blocks of non - invasive brain stimulation with different combinations of frequency and phase .",
    "this can be considered as a far more challenging problem as only a handful of studies exist investigating the effects of tacs on the blood oxygenation level dependent ( bold ) . beyond that",
    ", high inter - subject variability can be expected as outlined in the introduction .",
    "in contrast to the fmri setting employed in @xcite , there is far less prior knowledge regarding the properties of the latent objective function which can be leveraged in this context .",
    "therefore , data was collected over a cohort of eight subjects ( see previous section ) . using this empirical data we begin by studying the choice of kernel function in section [ covariance_function ] .",
    "given a choice of kernel and by carrying out simulation analyses , the effects of various acquisition functions are subsequently assessed in section [ acquisition_function ] .      the choice of kernel function in gp regression is fundamental @xcite .",
    "the kernel directly specifies a measure of similarity across various inputs and therefore determines the generalization properties of the estimated model .",
    "model selection in the context of gps is often posed as a parameter estimation task whereby the hyper - parameters for a specific choice of kernel can be learnt @xcite .",
    "however , comparing the performance of potentially many distinct kernels is a challenging problem .",
    "recently , @xcite have proposed a method for automatically searching over the space of kernel structures in a principled manner .",
    "briefly , the proposed approach proceeds by considering compositional structures ( either addition or multiplication ) over four _ base kernels _ ; squared exponential ( as employed in @xcite ) , periodic , linear or rational quadratic .",
    "when comparing various distinct kernel structures the bayesian information criterion ( bic ) is employed to score the various models ( where type-2 maximum likelihood estimates of parameters are used ) .",
    "initially , each of the base kernels is proposed .",
    "thereafter , the selected kernel can be extended by either performing addition or multiplication with any base kernel .",
    "while the original approach described in @xcite proposes kernels for each dimension independently , in this work both dimensions were studied simultaneously ( thus two dimensional kernels were proposed at each step ) .",
    "this decision is based on the hypothesis that each dimension ( either frequency or phase ) would share a similar relationship with the response , therefore leading to the selection of similar ( if not the same ) kernel .      of equal importance for the success of the bayesian optimization",
    "is the choice of acquisition function .",
    "the role of the acquisition function is to iteratively propose the experimental condition to be presented to the subject .",
    "it therefore serves to guide the search over all combinations of parameters ( in our case frequency and phase ) and must implicitly balance exploration with exploitation . in this work we considered the performance of two popular acquisition functions : the expected improvement ( ei ) and upper confidence bound ( gp - ucb ) acquisition function @xcite .",
    "the two acquisition functions differ in their trade - off between exploration and exploitation of the experimental parameters space , giving rise to distinct sampling behaviors over time .",
    "informally , the ei acquisition function can be seen as trying to maximize the expected improvement over the current best .",
    "while the gp - ucb also favors the selection of points with high mean value ( similar to the ei acquisition function ) , it also favors points with high variance ( i.e. , regions worth to explore ) . in certain settings , this will result in a more explorative behavior of the gp - ucb compared to the more  greedy \" ei acquisition function . for algorithmic details ,",
    "please refer to @xcite . while the choice of kernel function can be guided by model selection and information theoretic",
    "measures , the comparison of multiple acquisition functions requires explicit knowledge of the underlying objective function . as a result , a simulation study was employed to the benchmark the performance of the two aforementioned acquisition functions .",
    "a complex and multimodal objective function was proposed for the simulation study ( see fig .  [",
    "fig : simulations]a ) .",
    "this was motivated by our empirical results , showing multiple optima and minima for each subject ( not shown ) .",
    "as the presence of non - neural noise is well documented for fmri experiments , we also studied how different levels of contrast - to - noise - ratio ( cnr ) affected the bayesian optimization .",
    "we repeated our simulations analyses with cnr values ranging from 0.1 and 1.8 ( typically reported cnr values in fmri literature vary between 0.5 and 1.8 @xcite ) .",
    "for each cnr value tested , we ran 100 simulations .",
    "the maximum number of iterations was set to 100 with the first five ( randomly selected ) observations serving as burn - in phase .",
    "thereafter , at each iteration , a new frequency - and - phase combination was proposed by maximizing the respective acquisition function and sampled by the bayesian optimization algorithm in the next iteration .    as a measure of accuracy we computed spatial correlation between the algorithm s predictions for the whole parameter space and the  ground truth",
    "\" objective function .",
    "considering our underlying motivation to gain a holistic understanding of the whole parameter space ( learning about maxima and minima ) , spatial correlations seemed most appropriate to capture similarity across the whole space .",
    "this procedure was identical to the one reported in @xcite .",
    "in this work we follow @xcite , and look to compare several distinct kernels via the use of bic . furthermore , we also employ a greedy search algorithm whereby we begin with a base kernel and iteratively extend this kernel .",
    "there are two significant differences in the approaches described in this work to those of @xcite .",
    "the first is our choice of base kernels ; in this work the squared exponential , periodic , linear and matern @xmath3 where employed as base kernels .",
    "the second difference is that two - dimensional kernels were proposed at each iteration .",
    "this choice was motivated by an assumption that the relationship between parameter ( frequency or phase ) and the response shared a similar functional form .",
    "finally , a minor difference between this work and that of @xcite is that change - point functions were not considered here .",
    "following @xcite , we begin by proposing each of the base kernels and calculating the associated bic scores . in this first step",
    "the squared exponential kernel was selected .",
    "we then proceeded to consider compositional structures .",
    "each of these structures was composed by either adding or multiplying the squared exponential kernel with each of the base kernels . for each compositional kernel",
    ", the parameters were estimated using the previous parameters as warm starts . again",
    ", bic scores were employed to score each of the compositional models . at this stage",
    ", there was no reduction in bic scores resulting in the choice of the squared exponential kernel .",
    "simulation analyses were carried out to assess the performance of the ei and gp - ucb acquisition functions .",
    "a range of crn values were employed in order to recreate the properties of fmri data as well as study the performance of each of the acquisition functions in scenarios with low signal - to - noise ratio . throughout this simulation",
    "the underlying gp model was maintained constant , allowing us to attribute any differences in performance to the acquisition functions .    for each cnr value , 100 simulations where performed .",
    "each simulation allowed the proposed bayesian optimization algorithm to explore the parameter space over 100 iterations .",
    "the spatial correlation between the predictive posterior under the gp model and the true objective function was calculated at each iteration .",
    "the mean @xmath1 sem spatial correlation results are depicted in fig .",
    "[ fig : simulations]b for the ei and in fig .",
    "[ fig : simulations]c for the gp - ucb acquisition function .",
    "not surprisingly , we note that both acquisition functions fail in the presence of too much noise ( for cnr values @xmath4 ) .",
    "the results also indicate that the gp - ucb acquisition function clearly outperforms the ei acquisition function for typical cnr values reported in the literature ( 0.5 - 1.8 ) .",
    "the results presented here serve as an initial exploration into the choices of kernel and acquisition functions which can be used in the context of real - time optimization for tacs .",
    "our results propose the use of a squared exponential kernel function in combination with a gp - ucb acquisition function . in a series of simulations ,",
    "the latter was shown to capture the whole parameter space ( as identified by using spatial correlations ) when compared to the ei acquisition function .",
    "this result was consistent for a range of cnr values tested .",
    "these findings serve as an important basis for upcoming real - time experiments .",
    "an avenue of future work is the definition of appropriate stopping criteria to determine convergence @xcite .",
    "this is particularly important in our context due to high scanning costs , limited attentional capacities of subjects and neural habituation to the stimulation .    to our knowledge , this is the first study to propose a framework that allows tailoring non - invasive brain stimulation to an individual .",
    "the next step consists of applying this technology to patients suffering from traumatic brain injury ; a condition that disrupts frontoparietal brain networks and hence results in cognitive impairments @xcite . while closed - loop deep brain stimulation has already been shown to outperform the conventional approach in parkinson s patients @xcite we envision that our framework will advance personalized treatment by means of non - invasive brain stimulation .",
    "this will be of particular importance for neurological and psychiatric deficits that are diffuse and widely heterogeneous in their origin .",
    "this research was supported by the nihr imperial brc and the wellcome trust ( 103045/z/13/z ) ."
  ],
  "abstract_text": [
    "<S> non - invasive brain stimulation , such as transcranial alternating current stimulation ( tacs ) provides a powerful tool to directly modulate brain oscillations that mediate complex cognitive processes . while the body of evidence about the effect of tacs on behavioral and cognitive performance is constantly growing </S>",
    "<S> , those studies fail to address the importance of subject - specific stimulation protocols . with this study here , we set the foundation to combine tacs with a recently presented framework that utilizes real - time frmi and bayesian optimization in order to identify the most optimal tacs protocol for a given individual . </S>",
    "<S> while bayesian optimization is particularly relevant to such a scenario , its success depends on two fundamental choices : the choice of covariance kernel for the gaussian process prior as well as the choice of acquisition function that guides the search . using empirical ( functional neuroimaging ) as well as simulation data </S>",
    "<S> , we identified the squared exponential kernel and the upper confidence bound acquisition function to work best for our problem . these results will be used to inform our upcoming real - time experiments .    </S>",
    "<S> bayesian optimization , fmri , non - invasive brain stimulation , transcranial alternating current stimulation </S>"
  ]
}