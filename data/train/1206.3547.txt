{
  "article_text": [
    "we study first the case in which particles jump independently from state @xmath10 to @xmath7 and vice - versa , schematically : @xmath11 with rates that depend on the value of the heterogeneity parameter , @xmath12 .",
    "the probability @xmath13 for particle @xmath4 to be in state @xmath7 at time @xmath5 obeys the linear rate equation @xmath14 . in the case of constant rates ,",
    "the solution is : @xmath15 , with @xmath16 .",
    "the results derived below apply equally if the rates depend on time or on the time that the particle has been in its current state ( if the rate depends on the time @xmath17 that the particle has been on its current state , the steady - state probability of finding the particle at state @xmath7 is @xmath18 with @xmath19 ) . using particle independence and that the moments with respect to realizations of the stochastic process of the random variable @xmath20 are given by @xmath21 , one obtains that the average and variance of the global variable @xmath22 are : @xmath23&=&\\sum_{i=1}^n \\left(p_i(t)-p_i(t)^2\\right)= n\\left(\\overline{p(t)}-\\overline{p(t)^2}\\right),\\label{varparticular}\\end{aligned}\\ ] ] where the overline denotes an average over the population , @xmath24 .",
    "if we consider a system where all particles are identical ( i.e. have the same values for the internal parameter @xmath25 ) , and keep the same average value @xmath26 for the global variable at time @xmath5 , the variance would be @xmath27=n\\overline{p(t)}\\left(1-\\overline{p(t)}\\right)\\ge \\sigma^2[n(t)]$ ] .",
    "we obtain the somehow counterintuitive result that a system of heterogeneous independent particles displays smaller fluctuations in its collective variable than another system with identical particles .",
    "this effect is illustrated in figure  [ traject ] .",
    "the reduction in the variance of the collective variable is @xmath0 times the variance of @xmath28 over the population : @xmath29-\\sigma^2[n(t)]=n\\left(\\overline{p(t)^2}-\\overline{p(t)}^2\\right),\\ ] ] which is of the same order , @xmath30 , as the variance itself , giving a non - negligible correction .",
    "reading the previous formula backwards , one realizes that the moments of the collective variable give information about the degree of heterogeneity in the system : @xmath31}{n}.\\ ] ] this expression is general , regardless the specific form in which @xmath28 is distributed over the population .",
    "higher moments of the heterogeneity distribution are also related to higher moments of the collective variable .",
    "this allows to infer the skewness , kurtosis and higher order characteristics of the heterogeneity distribution by measuring only global variables and their fluctuations . in the supplementary information",
    "it is shown that an equivalent result is obtained generically for @xmath32-state systems for @xmath33 .",
    "of a system of identical ( left panel ) and heterogeneous ( right panel ) particles , for a system of @xmath34 particles .",
    "the parameters were set as @xmath35 , with @xmath36 in the case of identical particles ( left panel ) and @xmath28 chosen from a symmetric beta distribution @xmath37^{\\alpha-1}$ ] , with @xmath38 , being the sample mean and variance equal to @xmath39 , @xmath40=0.23 $ ] , respectively .",
    "note that the fluctuations of the average state are larger in the case of identical particles .",
    "[ traject ] ]    besides the moments , one can derive the full probability distribution of the global variable .",
    "the generating function for the one particle probability distribution is @xmath41 and the generating function @xmath42 of the sum of independent random variables is the product of their generating functions , @xmath43 . expanding in powers of @xmath44",
    "we can obtain the probability distribution for @xmath22 : @xmath45 , being @xmath46 and @xmath47 the group of permutations of @xmath0 elements .",
    "the model studied in this subsection , despite its simplicity , offers a reduced description of generic systems of non - interacting multi - stable units subject to fluctuations .",
    "the results obtained here are directly relevant if one is interested in the collective properties of one such system when the units are non - identical .",
    "one can reasonably argue that the independence property is too unrealistic for the study to be of any practical interest .",
    "we will be considering more complicated cases including non - independent units in the rest of the paper .",
    "however , this simple model presents in isolation a mechanism , spontaneous transitions , that can play a role in more complicated and relevant systems ( we will see this later ) .",
    "the simplicity of the model allows us to understand the effect of heterogeneity in this mechanism , and will give us insight in the role of heterogeneity in the behavior of more complicated systems .",
    "we will now discuss the situation in which the particular values of the parameter of each particle are not known .",
    "this introduces an additional source of uncertainty . for simplicity",
    ", we will focus on the @xmath48-states independent particles system considered before , but the discussion applies as well to general systems of interacting particles .",
    "this discussion will also allow us to take a closer look at the results obtained and clarify their meaning and relevance in different settings .",
    "often , one does not know the value of the parameter @xmath1 of each individual particle , but has some idea about how this parameter is distributed on the population , perhaps its probability distribution ( obtained for example by measuring individual behavior in an equivalent system ) . here",
    ", we will assume that the @xmath1 s are independent and identically distributed random variables with a given probability density @xmath49 .",
    "in this case , @xmath50 and @xmath51 $ ] are themselves random variables that , as shown above , depend on the particular realization of the @xmath1 s .",
    "the expected values of these quantities are obtained by averaging eqs.([medparticular],[varparticular ] ) over the distribution of the individual parameters : @xmath52}=n\\left(\\widehat{p(t)}-\\widehat{p(t)^2}\\right)\\label{varmed},\\ ] ] where the hat denotes an average with respect to @xmath49 , @xmath53 .",
    "again the variance is smaller than for a system of identical particles with the same mean value , namely , @xmath54-\\widehat{\\sigma^2[n(t)]}=n\\left(\\widehat{p(t)^2}-\\widehat{p(t)}^2\\right)$ ] .",
    "if we average the probability @xmath55 over the distribution of parameters we obtain a simple form for the probability of the global variable @xmath22 : @xmath56 a binomial distribution with parameter the average @xmath57 over the distribution @xmath58 .",
    "the variance of this distribution is @xmath59_\\text{tot}=n\\left(\\widehat{p(t)}-\\widehat{p(t)}^2\\right)\\label{vartotal},\\ ] ] equal to the variance one would obtain in a system of identical particles with the same average , @xmath60 , a result in apparent contradiction with ( [ varmed ] ) .",
    "however , we should note that they refer to different things : expression ( [ varmed ] ) gives the average variance when the parameter values are given , so measuring the average uncertainty in @xmath22 due to the stochastic nature of the process .",
    "( [ vartotal ] ) , in addition to the uncertainty coming from the stochasticity of the process , also includes the uncertainty on the parameter values .",
    "the two expressions are related by the law of total variance : @xmath61_{tot}&=&\\widehat{\\sigma^2[n]}+\\sigma^2[\\langle n|\\lambda_1,\\dots,\\lambda_n\\rangle]\\nonumber\\\\   & = & n(\\widehat{p}-\\widehat{p^2})+\\sigma^2\\left[\\sum_i p_i\\right ] = n(\\widehat{p}-\\widehat{p}^2).\\end{aligned}\\ ] ] in @xmath62 $ ] , the variances are taken over the distribution of the @xmath1 s .",
    "if we are considering a particular system , the temporal fluctuations ( all the systems considered in this paper are ergodic , so we can think on averages over time or over the realization of the stochastic process interchangeably ) in @xmath22 will come only from the intrinsic stochasticity , and expressions ( [ varparticular],[varmed ] ) are the ones that measure it .",
    "expressions ( [ averagedistribindep],[vartotal ] ) are appropriate only if we are considering an ensemble of systems with a distribution of parameters and our different measurements may come from different systems in the ensemble .",
    "let us now consider a general system of interacting heterogeneous particles .",
    "the stochastic description now starts from a master equation for the @xmath0-particle probability distribution : @xmath63\\nonumber\\\\ & & + \\sum_{i=1}^{n}(e_i^{-1}-1)\\left[(1-s_i)r_i^{+}p(s_1,\\dots , s_n)\\right]\\label{mastereqgen},\\end{aligned}\\ ] ] with step operators defined as @xmath64 .",
    "the transition rates @xmath65 might now depend on the state of any other particle ( this is how interactions enter in the model ) . from eq.([mastereqgen ] ) one can derive for the moments and correlations : @xmath66 .",
    "\\label{correlationsgeneral}\\end{aligned}\\ ] ] with @xmath67 and @xmath68 in the second equation ( recall that @xmath69 ) . in general ,",
    "if the transition rates depend on the state variables @xmath20 , these equations are not closed since they involve higher order moments , and some approximation method is needed to proceed .",
    "systematic expansions in @xmath70 , including van kampen s @xmath71-expansion @xcite , are not applicable , since variables @xmath72 are not extensive . in the following ,",
    "we introduce an approximation suitable for the analytical treatment of systems of globally coupled heterogeneous particles .",
    "we assume that the @xmath73-particle correlations @xmath74 with    @xmath75 scale with system size as @xmath76 using this ansatz one can close the system of equations ( [ momentsgeneral],[correlationsgeneral ] ) for the mean values and the correlations .",
    "this is shown in the supplementary information for general transition rates of the form @xmath77 .",
    "while the resulting equations for the average values @xmath78 coincide with the mean - field rate equations usually formulated in a phenomenological way@xcite , our formulation allows us to compute the correlations and include , if needed , higher order corrections in a systematic way .",
    "assumption ( [ ansatz ] ) can be justified noting that it is consistent with @xmath79 which follows from van kampen s splitting of the global variable @xmath80 , with @xmath81 deterministic and @xmath82 stochastic .",
    "details are given in the supplementary information .",
    "the global variable @xmath22 is extensive and it is expected to follow van kampen s ansatz in many cases of interest .",
    "note , however , that since there is not a closed description for the macroscopic variable @xmath22 , one can not use van kampen s expansion , and our approach extends the implications of this splitting of the macroscopic variable to the correlations of the microscopic state variables . for simplicity ,",
    "we have focused on @xmath48-states systems and assumed a constant number of particles . systems with @xmath32 states",
    "are also expected to follow ansatz ( [ ansatz ] ) , since the scaling of the global variable is not limited to @xmath48-sates systems .",
    "the case of variable , but bounded , number of particles can be included straightforwardly by considering an extra state . the unbounded case can also be considered performing an appropriate limit . if the system has some spatial structure , the ansatz ( [ ansatz ] ) is not expected to be valid , and some decay of the correlations with the distance is expected instead ; this interesting situation is left for future work .",
    "we will proceed by applying the presented method to analyze the role of heterogeneity in two models previously considered in the literature that apply to contexts in which the assumption of identical agents can hardly be justified : stock markets and disease spreading .",
    "we will focus on the steady - state properties of both models , skipping transient dynamics .",
    "kirman s model @xcite was proposed to study herding behavior in the context of stock markets and collective dynamics on ant colonies . in the stock market context",
    ", agent @xmath4 can be in two possible states ( e.g. @xmath83``pessimistic '' -with regard to future market price- and @xmath84``optimistic '' ) and it can switch from one to the other through two mechanisms : spontaneous transitions at a rate @xmath85 , and induced transitions at a rate @xmath86 , being @xmath87 the  influence \" of agent @xmath88 on other agents .",
    "the case @xmath89 corresponds to the voter model@xcite . in the original formulation ,",
    "all agents have the same influence , i.e. @xmath90 .",
    "we generalize the model allowing the parameter @xmath1 to vary between agents .",
    "in @xcite , the effect of heterogeneity was explored numerically , but not in a systematic way .",
    "this model is interesting for us because it incorporates in a simple way two basic processes : spontaneous transitions and induced transitions . as we will see , due to its simplicity , a full analytical treatment is possible that will , in turn , allow us to obtain a deeper insight into the general effect of heterogeneity in systems of interacting particles .",
    "the master equation for the process is of the form ( [ mastereqgen ] ) , with rates given by : @xmath91 from ( [ momentsgeneral ] ) the averages and correlations obey : @xmath92 for @xmath68 and @xmath93 .",
    "note that , due to the particular form of the rates , these equations do not involve higher - order moments .",
    "this is a simplifying feature of this model that allows one to obtain exact expressions .",
    "the first equation leads to a steady state value @xmath94 ( a property that comes from the symmetry @xmath95 ) . using the relation @xmath51=\\sum_{i , j}\\sigma_{i , j}$ ] we obtain",
    "( see supplementary information ) that the variance in the steady state is : @xmath96=\\frac{n}{4}\\left[1 + \\frac{2\\overline{\\lambda}(1-n^{-1})}{4\\epsilon+\\overline{\\lambda } } + \\frac { ( n-3 + 2n^{-1})\\overline{a}}{2\\epsilon+\\overline{a}}\\right]\\label{kirmanexact}\\ ] ] with @xmath97 .",
    "the leading - order term , @xmath98=\\frac{n}{4}\\left[1+\\frac{\\overline{\\lambda}}{2\\epsilon}+\\frac{\\sigma^2[\\lambda]}{2\\epsilon\\left(4\\epsilon+\\overline{\\lambda}\\right)}\\right]+o(n^0 ) $ ] , with @xmath99=\\overline { \\lambda^2}-\\overline\\lambda^2 $ ] , can also be readily obtained using the ansatz ( [ ansatz ] ) .",
    "note that the presence of heterogeneity increases collective fluctuations . in fig.[kirmanaverage ] we compare expression ( [ kirmanexact ] ) with results coming from numerical simulations .     as a function of the variance of the influence parameter @xmath100 in kirman s model with distributed influence .",
    "numerical simulations ( symbols ) and theoretical analysis ( lines ) , eq.([kirmanexact ] ) , for different number of agents @xmath0 and @xmath101 .",
    "@xmath1 are independent random variables distributed according to a lognormal or a gamma distribution with mean @xmath102 and variance @xmath103 .",
    "the results have been averaged over @xmath104 for @xmath105 and @xmath106 for @xmath34 realizations of the distribution of parameters .",
    "[ kirmanaverage ] ]    in this case , the knowledge of @xmath107 and @xmath108 $ ] alone does not allow to infer the degree of heterogeneity present in the system , unless one knows from other sources @xmath109 and @xmath85 and it is not possible to conclude whether the observed fluctuations have a contribution due to the heterogeneity of the agents .",
    "however , the steady - state correlation function @xmath110(t)\\equiv\\langle n(t)n(0)\\rangle_\\textrm{st}-\\langle n\\rangle_\\textrm{st}^2 $ ] , does include a term that allows to infer the possible heterogeneity .",
    "@xmath110(t)$ ] is obtained integrating eq.([kirmanaverage ] ) and performing the appropriate conditional averages ( see supplementary information ) : @xmath111(t)=\\left(\\sigma^2_\\text{st}[n]-u\\right)e^{-(2\\epsilon+\\overline{\\lambda})t}+ue^{-2\\epsilon t } ,   \\label{kirmancorrfunc}\\ ] ] with @xmath112-n/4)$ ] .",
    "the departure from a pure exponential decay signals the presence of heterogeneity ( for identical particles @xmath113 $ ] ) .",
    "fitting this expression to data one can obtain @xmath108 $ ] and the parameters @xmath114 .",
    "then , the use of expression ( [ kirmanexact ] ) would yield @xmath99 $ ] . in fig.[kirmancorrf ] we show that the numerical simulations indeed support the existence of two exponential decays for the correlation function .    ) , solid lines ) .",
    "note that when heterogeneity is present ( @xmath115 ) the correlation function departs from purely exponential decay ( displayed as a dashed line ) .",
    "data for @xmath116 have been moved up @xmath117 units vertically for better visualization .",
    "parameters values are @xmath101 , @xmath34 .",
    "@xmath1 are independent random variable distributed according to a gamma with mean @xmath118 and variance , @xmath103 , indicated in the figure",
    ". a simple fit of expression ( [ kirmancorrfunc ] ) to the @xmath119 data gives @xmath120 .",
    "[ kirmancorrf ] ]      interestingly , other ways to introduce heterogeneity in the system have different effects :- if the heterogeneity is introduced in the spontaneous transition rate , @xmath121 , making some particles more prone to spontaneous transitions that others ( but keeping @xmath122 , @xmath123 to isolate effects ) , collective fluctuations again increase with respect to the case of identical particles .",
    "-next , we can assume that the rate of induced change is different for different agents , even if all have the same influence .",
    "measuring this difference in  susceptibility \" ( to induced change ) with a parameter @xmath124 , we would have that the rate of induced change in agent @xmath4 is @xmath125 .",
    "the effect of heterogeneity in @xmath124 ( keeping again @xmath122 , @xmath123 ) is that the collective fluctuations decrease with the degree of heterogeneity in the susceptibility @xmath124.-setting some heterogeneous preference for the states among the particles , i.e. making @xmath126 , the spontaneous rate from @xmath10 to @xmath7 of particle @xmath4 , different from @xmath127 , the spontaneous rate from @xmath7 to @xmath10 of the same particle , decreases global fluctuations . in order to vary the preference for one state keeping constant the global  intrinsic noise \" of this particle ( note that the correlation time of particle @xmath4 , when isolated , is given by @xmath128 ) , we set @xmath129 and generate @xmath130 as i.i.d .",
    "random variables with a distribution with support contained in the interval @xmath131 $ ] .",
    "exact explicit expressions for the first moments of the global variables are ( see supplementary information):@xmath132_{st}&=&\\frac{n}{4(\\epsilon+\\frac{2\\lambda}{n})}\\left[\\overline{\\epsilon^+}(1+\\frac{\\lambda}{\\epsilon})-\\frac{\\overline{\\epsilon^+}^2}{\\epsilon}\\left(\\frac{\\lambda}{2\\epsilon}+1\\right)-2\\frac{\\sigma^{2}[\\epsilon]}{2\\epsilon+\\lambda}\\right]\\label{varkirmanprefer},\\end{aligned}\\ ] ] in figure ( [ fig : kirmanpreference ] ) the exact expressions ( [ medkirmanprefer ] , [ varkirmanprefer ] ) are compared with results coming from numerical simulations .    in this case , the correlation function decays exponentially , @xmath111(t)=\\sigma^2[n]_{\\textrm{st}}e^{-2\\epsilon t},\\ ] ] independently of the degree of heterogeneity , so this form of heterogeneity can not be inferred by measuring the correlation function .",
    "numerical simulations confirm this result .     as a function of the variance of the spontaneous transition rate to state @xmath7 , @xmath133 , in kirman s model .",
    "results coming from numerical simulations ( symbols ) and theoretical analysis ( solid lines , eqs.([medkirmanprefer ] , [ varkirmanprefer ] ) ) , for @xmath105 agents , @xmath134 and @xmath135 .",
    "@xmath136 are independent random variables distributed according to a symmetric beta distribution in the interval @xmath137 with mean @xmath138 and variance , @xmath139 .",
    "[ fig : kirmanpreference ] ]      we have seen that heterogeneity can have an ambivalent effect over the size of the fluctuations , depending on the particular form it appears .",
    "we now provide intuitive arguments to understand these different effects .",
    "when the influence parameter , @xmath1 , varies from one unit to the other , there will be some largely influential agents and others with little influence . in the limit of very large heterogeneity we can think of a situation with a single agent with an extremely large influence and the others having a negligible one ( we are keeping a constant average influence ) . in this case",
    ", the highly influential agent drifts from one state to the other , essentially independently ( since other agents have negligible influence ) , but , due to its large influence , all the agents are attracted to its current state . in this  follow the leader \" regime , we obtain macroscopic transitions from one state to the other , corresponding to very large global fluctuations .",
    "the situation is the opposite for a non - identical susceptibility parameter @xmath124 where global fluctuations decrease as the diversity is increased .",
    "again , we can understand this in the limit of very large heterogeneity where a single agent ( or a small number of them ) has large susceptibility while all the others have a negligible one ( in order to keep average susceptibility constant ) .",
    "then , agents with small susceptibility change essentially independently , in an uncorrelated fashion , resulting in low global fluctuations ( note that in order to have large global fluctuations , the fluctuations in the state of the single agents should be correlated ) .    in the case of diverse spontaneous transition rates , @xmath140 , global fluctuations increase with the degree of heterogeneity . in the limit of large heterogeneity , we would have a small number of agents with very large spontaneous transition rate , whose state would fluctuate in an uncorrelated fashion , and a large number of agents with low spontaneous transition rate , that essentially would only change state through induced transitions , giving rise to correlated fluctuations , resulting in large variance for the global variable .    in the case in which agents display an intrinsic heterogeneous preference for one of the two states , the global fluctuations decrease with heterogeneity degree .",
    "we saw this already in the first section for non - interacting agents . here",
    "we see the same effect , suggesting that the phenomenon is robust and still plays a role when interaction is added .",
    "the coexistence of a small number of agents with large value for the parameter and a large number with a small value assumed in the previous arguments arises from the fact that an unbounded ( from above ) distribution of positive - defined parameters ( e.g. rates ) is skewed . however , all the effects of diversity commented are still present if the distribution is symmetric . in this case , nevertheless , the maximum degree of heterogeneity ( for a constant mean value ) is bounded , sometimes greatly limiting the maximum possible value of diversity . for symmetric distributions ,",
    "a simple explanation is not so clear , but an asymmetry in the effect of increasing and decreasing the value of the parameter seems to be at the heart of the phenomenon .",
    "the previous example could be treated exactly because , due to symmetry , the interaction , non - linear terms , cancel out in the equations for the moments . in general , however , this is not the case , and the analytical treatment is more involved .",
    "here we consider an example of such case .",
    "the stochastic susceptible - infected - susceptible ( sis ) model is a paradigmatic model for the study of spreading of infectious disease @xcite as well as the diffusion of innovation @xcite and other types of social influence . despite its simplicity",
    ", it captures interesting phenomenology .",
    "the process is schematically described by : @xmath141 where @xmath142 ( resp .",
    "@xmath143 denotes agent @xmath4 being susceptible ( resp .",
    "infected ) .",
    "there are 3 basic elementary processes : ( i ) infected agent @xmath88 infects susceptible agent @xmath4 at a rate @xmath144 , being @xmath87 the infectivity parameter of agent @xmath88 ; ( ii ) infected agent @xmath88 becomes susceptible a rate @xmath145 ; ( iii ) susceptible agent @xmath88 gets infected spontaneously ( due to interactions with agents not considered in the system or other causes ) at a rate @xmath85 .",
    "this corresponds to the sis model with spontaneous contagions and distributed infectivity . in the absence of spontaneous infections",
    "@xmath89 , the system has a trivial steady state with zero infected agents . with @xmath146",
    "the system has a non - trivial steady state whose properties we analyze in the following . as in the previous case",
    ", heterogeneity could appear in any parameter of the agents ( for example , in the recovery rate , in a``susceptibility '' parameter , etc . ) .",
    "we study first the case in which only the infectivity , @xmath1 , can vary from agent to agent .",
    "the effect of heterogeneity in the deterministic version of related models was studied recently @xcite .",
    "the master equation is of the form ( [ mastereqgen ] ) with rates @xmath147 .",
    "equations ( [ momentsgeneral]-[correlationsgeneral ] ) for the first moments can be closed in the steady state , using our main ansatz , to obtain explicit formulas for @xmath148 and @xmath51_\\textrm{st}$ ] to any desired order in @xmath149 . in this case , however , the expressions are rather cumbersome and we skip them here .",
    "the results are plotted in figure ( [ sismed ] ) , where we compare the approximation to order @xmath150 with results coming from numerical simulations , showing good agreement . here",
    "both the average value and the variance are modified by the presence of heterogeneity ( the dependence of the average is , however , only in second order in @xmath70 , almost unnoticeable in the figure ) . as in the kirman model ,",
    "the size of the fluctuations increase markedly with the amount of heterogeneity in the `` influence '' ( now influence to infecting others ) of the agents .    , @xmath151 , @xmath152 , @xmath102 .",
    "[ sismed ] ]    in this case , other ways to introduce heterogeneity also have different effects .",
    "when heterogeneity appears in the recovery rate @xmath145 , the mean number of infected agent increases , with a moderate effect over the variance ( resulting in smaller relative fluctuations ) .",
    "heterogeneity in the susceptibility to infection ( which would be introduced with the change @xmath153 , with @xmath124 distributed over the population ) decreases the fluctuations , with little effect over the mean value .",
    "heterogeneity in the spontaneous infection rate @xmath85 has almost no effect . in a real situation ,",
    "one expects to find heterogeneity simultaneously in several of the parameters defining the model . when heterogeneity is present both in the infectivity and in the susceptibility , the effects of both types of heterogeneity essentially add up , with the size of the fluctuations increasing with the heterogeneity in the infectivity for a given level of heterogeneity in the susceptibility and fluctuations decreasing with the level of heterogeneity in the susceptibility for a given level of heterogeneity in the infectivity .",
    "the effects of heterogeneity in the infectivity and in the susceptibility are equivalent to those found in the kirman model , and can be intuitively understood in the same terms .",
    "heterogeneity in the recovery rate is similar to assigning an heterogeneous preference for the state @xmath10 ( recovery ) and its effect in the ( relative ) fluctuations is again the same as that in the case of the kirman model .",
    "this suggests that the effects of the heterogeneity found are generic and can be useful to understand the behavior of other systems .",
    "in this work , we have analyzed the combined effect of stochasticity and heterogeneity in interacting - particle systems .",
    "we have presented a formulation of the problem in terms of master equations for the individual units , but extracted conclusions about the fluctuations of collective variables .",
    "we have developed an approximation suitable for the analytical study of this general type of systems .",
    "we have shown that the heterogeneity can have an ambivalent effect on the fluctuations , enhancing or decreasing them depending on the form of the system and the way heterogeneity is introduced . in the case of independent particles , heterogeneity in the parameters always decreases the size of the global fluctuations .",
    "we have also demonstrated that it is possible to obtain precise information about the degree and the form of the heterogeneity present in the system by measuring only global variables and their fluctuations , provided that the underlying dynamical equations are known . in this way stochastic modeling allows to obtain information not accessible from a purely deterministic approach .",
    "we have also demonstrated that , in some cases , one can account for the heterogeneity of the particles without losing analytical tractability .",
    "heterogeneity among the constituent units of a system is a very generic feature , present in many different contexts and this work provides a framework for the systematic study of the effect of heterogeneity in stochastic systems , having thus a wide range of potential applicability . more research in this direction",
    "would be welcomed .",
    "we have developed and used analytical tools based on an extension of van kampen s ansatz on the relative weight of the fluctuations compared to the mean value , suitable for systems with particle heterogeneity .",
    "we have included the details of this method in the supplementary information . in some cases , and in order to compare with the analytical expressions",
    ", we have generated data from numerical simulations using a particular form of gillespie s algorithm @xcite that takes into account the heterogeneity in the population .",
    "we now explain this algorithm using , for the sake of concreteness , the specific case of the kirman model with distributed susceptibility .",
    "the parameters of the system are : the spontaneous transition rate @xmath85 , the influence parameter @xmath100 , the susceptibility parameter of each agent @xmath124 , and the total number of agents @xmath0 . in this case",
    ", the influence parameter can be reabsorbed rescaling @xmath124 , so we set @xmath154 without loss of generality",
    ". the variables of the system are the state of each agent @xmath72 .",
    "we will also use the total number of agents in state @xmath7 , @xmath155 , the total susceptibility of agents in state @xmath7 , @xmath156 , and the average susceptibility @xmath157 .    at",
    "any given instant , two events can happen:(i ) an agent in state @xmath7 changes to state @xmath10 .",
    "this can happen due to a spontaneous transition , at a total rate @xmath158 , or due to an induced transition , at a total rate @xmath159.(i ) an agent in state @xmath10 changes to state @xmath7 .",
    "this can happen due to a spontaneous transition , at a total rate @xmath160 , or due to an induced transition , at a total rate @xmath161 .    according to the gillespie method , that considers the continuous - time process , the time at which the next transition will take place is exponentially distributed , with average the inverse of the total rate .",
    "the probability that a given transition is realized is proportional to its rate .",
    "if the realized transition is a spontaneous one , the agent that actually undergoes it is selected at random ( since , in this case , they all have the same rate @xmath85 ) .",
    "if the transition is induced , the agent that undergoes it is selected with probability proportional to its susceptibility .",
    "it can be easily seen that this principles lead to an exact ( up to numerical precision ) simulation of sample paths of the stochastic process @xcite .",
    "the algorithm , then , proceeds as follows : + ( 0 ) evaluate the total number of particles in state @xmath7 , @xmath22 , and the total susceptibility of particles in state @xmath7 , @xmath71.(1 ) evaluate the total transition rate @xmath162.(2 ) generate the time for the next reaction , @xmath163 , as an exponential random variable with average @xmath164 . this can be done by setting @xmath165 , with @xmath166 a uniform random variable in the range @xmath167.(3 ) select which reaction takes place .",
    "for this , generate a uniform random variable , @xmath168 , in the range @xmath169 .",
    "+ -if @xmath170 the transition will be a spontaneous transition from @xmath7 to @xmath10 ; select an agent , @xmath88 , at random among those at state @xmath7 .",
    "set @xmath171 , @xmath172.-if @xmath173 , the transition will be a spontaneous transition form @xmath10 to @xmath7 ; select an agent , @xmath88 , at random among those at state @xmath10 .",
    "set @xmath174 , @xmath175.-if @xmath176 , the transition will be an induced transition from @xmath7 to @xmath10 ; select an agent , @xmath88 , among those at state @xmath7 with probability proportional to the value of its susceptibility parameter @xmath177 . set @xmath171 , @xmath172.-if @xmath178 , the transition an induced transition from @xmath10 to @xmath7 ; select an agent , @xmath88 , among those at state @xmath10 with probability proportional to the value of its susceptibility parameter @xmath177 . set @xmath174 , @xmath175.(4 ) set @xmath179 .",
    "go to ( 1 ) .",
    "we thank e. hernandez - garcia for useful discussions .",
    "this work was supported by mineco ( spain ) , comunitat autnoma de les illes balears , feder , and the european commission under project fis2007 - 60327 .",
    "is supported by the jaepredoc program of csic .",
    "spudich , j. l. , koshland , jr .",
    "d. e. non - genetic individuality : chance in the single cell .",
    "_ nature _ * 262 , * 467 - 471 ( 1976 ) .",
    "snijder , b. , pelkmans , l. origins of regulated cell - to - cell variability .",
    "cell biol _ * 12 , * 119 - 125 ( 2011 ) .",
    "granovetter , m. threshold models of collective behavior .",
    "j. sociol .",
    "_ * 83 , * 1420 - 1443 ( 1978 ) .",
    "kirman , a. whom or what does the representative individual represent ?",
    ". perspect _ * 6 , * 117 - 136 ( 1992 ) .",
    "braiman , y. , kennedy , t. a. b. , wiesenfeld , k. and khibnik , a. entrainment of solid - state laser arrays .",
    "a _ * 52 , * 1500 - 1506 ( 1995 ) .",
    "oliva , r. a. and strogatz , s. h. dynamics of a large array of globally coupled lasers with distributed frequencies .",
    ". chaos _ * 11 , * 2359 - 2374 ( 2001 ) .",
    "albert , r. and barabsi , a .-",
    "statistical mechanics of complex networks . _ rev . mod .",
    "phys . _ * 74 , * 47 - 97 ( 2002 ) .",
    "boccaletti , s. , latora , v. , moreno , y. , chavez , m. , hwang , d .- u .",
    "complex networks : structure and dynamics _ phys .",
    "rep . _ * 424 , * 175 - 308 ( 2006 ) .",
    "tessone , c. j. , mirasso , c. r. , toral .",
    "r. and gunton , j. d. diversity - induced resonance .",
    "lett . _ * 97 , * 194101 1 - 4 ( 2006 ) .",
    "komin , n. , lacasa , l. and toral , r. critical behavior of a ginzburg  landau model with additive quenched noise .",
    "_ j. stat .",
    "_ * p12008 , * 1 - 19 ( 2010 ) .",
    "peyton young , h. innovation diffusion in heterogeneous populations : contagion , social influence , and social learning .",
    "rev . _ * 99 , * 1899 - 1924 ( 2009 ) .",
    "novozhilov , a. s. epidemiological models with parametric heterogeneity : deterministic theory for closed populations _ math model nat pheno _",
    "* 7 , * 147 - 167 ( 2012 ) .",
    "masuda , n. , gibert , n. and redner , s. heterogeneous voter models .",
    "e _ * 82 , * ( 010103r ) 1 - 4 ( 2010 ) .",
    "mobilia , m. and georgiev , i. t. , voting and catalytic processes with inhomogeneities .",
    "e _ * 71 , * 046102 1 - 17 ( 2005 ) .",
    "xie , j. and sreenivasan , s. social consensus through the influence of committed minorities .",
    "e _ * 84 , * 011130 1 - 8 ( 2011 ) .",
    "fisher , d. s. critical - behavior of random transverse - field ising sping chains _ phys .",
    "b _ * 51 , * 6411 - 6461 ( 1995 ) .",
    "young , a. p. ( ed . ) _ spin glasses and random fields _ world scientific , singapore ( 1998 ) .",
    "mzard , m. , parisi , g. and virasoro , m. a. _ spin glass theory and beyond _ world scientific , singapore ( 1987 ) .",
    "bouchaud , j-.p . and georges , a. , anomalous diffusion in disordered media : statistical mechanisms , models and physical applications .",
    "_ phys . rep .",
    "_ * 195 , * 127 - 293 ( 1990 ) .",
    "ben - avraham , d. and havlin , s. _ diffusion and reactions in fractals and disordered systems _ cambridge university press , cambridge ( 2000 ) .",
    "dushoff , j. host heterogeneity and disease endemicity : a moment - based approach .",
    "theor popul biol * 56 , * 325335 ( 1999 ) .",
    "van kampen , n. g. _ stochastic processes in physics and chemistry _ , north - holland , amsterdam ( 2004 ) .",
    "kirman , a. ants , rationality , and recruitment .",
    "_ q. j. econ . _ * 108 , * 137 - 156 ( 1993 ) .",
    "liggett , t. m. _ interacting particle systems _ , springer - verlag , new york ( 1985 ) .",
    "alfarano , s. and milakovi , m. network structure and n - dependence in agent - based herding models .",
    "_ j. econ .",
    "control _ * 33 , * 78 - 92 ( 2009 ) .",
    "anderson , r. m. _ population dynamics of infectious diseases : theory and applications _ , chapman and hall , london - new york ( 1982 ) .",
    "gillespie , d. t. _ exact stochastic simulation of coupled chemical reactions _ * 81,*(25 ) 2340 - 2361 ( 1977 ) .",
    "we consider here the case in which each particle can be in one of @xmath180 ( instead of @xmath48 ) possible states .",
    "we will show that the results obtained in the main text for @xmath181state systems also hold in this more general case .",
    "we label the states with the subscript @xmath182 , so in this case the variable describing the state of particle @xmath4 can take @xmath180 possible values , @xmath183 ( we start the labeling from @xmath10 to be consistent with the previous case , that would correspond to @xmath184 ) .",
    "let @xmath185 the probability that particle @xmath4 , with heterogeneity parameter @xmath1 , be on state @xmath186 .",
    "it satisfies the evolution equation : @xmath187 with @xmath188 a general transition matrix ( satisfying @xmath189 ) , that may depend in principle on time and on the time that the particle has been on its current state . to isolate the role of parameter heterogeneity , we assume that the initial condition is the same for all the particles ( or that the initial condition is determined by the value of @xmath1 ) such that the solution @xmath190 is the same for all particles sharing the same value of the parameter",
    ". the macroscopic state of the system will be described by the set of variables @xmath191 , that is , the number of particles in each state .",
    "the averages and variances of this variables are given by : @xmath192&=&\\sum_{i=1}^n\\left [ p(\\lambda_i,\\alpha , t)-p(\\lambda_i,\\alpha , t)^2\\right].\\end{aligned}\\ ] ] this variance is again smaller that tat of a system of identical particles with same average , the difference given by : @xmath193_\\text{id}-\\sigma^2[n_\\alpha(t)]=n\\overline{p(\\alpha , t)^2}-\\overline{p(\\alpha , t)}^2,\\ ] ] a result exactly analogous to the one obtained in the previous case .",
    "the heterogeneity among the particles on the probability of occupation of level @xmath186 can be derived from the first moments of the occupation number of the level : @xmath194}{n}.\\ ] ] note that , when focusing on the number of particles on state @xmath186 , the system effectively reduces to a @xmath181level one , with states @xmath186 and no-@xmath186 , so the results of the previous section can be translated directly .    a different and some times relevant question can be considered when the labeling of the states is such that the order is well defined ( for example each state corresponds to an energy level or a distance from a reference ) .",
    "then the average state is meaningful and we can study its statistical properties .",
    "below we show that the variance of this mean level is again always smaller if heterogeneity is present .",
    "the average state of the system is given by @xmath195 .",
    "it is a random variable whose average and variance are given by : @xmath196&=&\\sum_{\\alpha,\\beta=0}^{m-1}\\frac{\\alpha\\beta}{n^2}(\\langle n_\\alpha",
    "n_\\beta\\rangle-\\langle n_\\alpha\\rangle\\langle n_\\beta\\rangle)=\\frac{1}{n^2}\\sum_{i=1}^n\\left[\\sum_{\\alpha=0}^{m-1}\\alpha^2p(\\alpha,\\lambda_i)-\\sum_{\\alpha,\\beta=0}^{m-1}\\alpha p(\\alpha,\\lambda_i)\\beta p(\\beta,\\lambda_i)\\right]\\label{meanlevelhet}.\\end{aligned}\\ ] ] we have used @xmath197 and @xmath198 $ ] .",
    "a system of identical particles that had the same average occupation of the different levels i.e. @xmath199 @xmath200 , would have and average and variance of the mean level given by : @xmath201_\\text{id}&=&\\frac{1}{n}\\sum_{\\alpha=0}^{m-1}\\alpha^2\\frac{\\langle",
    "n_\\alpha\\rangle}{n}-\\frac{1}{n}\\sum_{\\alpha,\\beta=0}^{m-1}\\alpha\\beta\\frac{\\langle n_\\alpha\\rangle}{n}\\frac{\\langle n_\\beta\\rangle}{n}\\label{meanlevelid}.\\end{aligned}\\ ] ] we now define @xmath202 ( the average level of particle @xmath4 ) , and note that the first terms in the right - hand side of ( [ meanlevelhet ] ) and ( [ meanlevelid ] ) are equal , while the second terms can be written as : @xmath203 ^ 2=\\frac{1}{n}\\overline{g}^2,\\end{aligned}\\ ] ] which implies that @xmath204_\\text{id}\\ge \\sigma^2[l]$ ] , i.e. the variance of the mean level is always smaller in a system of heterogeneous particles , the difference with respect to the case of identical ones being : @xmath205_\\text{id}-\\sigma^2[l]=\\frac{1}{n}\\left(\\overline{g^2}-\\overline{g}^2\\right)=\\frac{1}{n}\\sum_{\\alpha,\\beta=0}^{m-1}\\alpha\\beta\\left[\\sum_{i=1}^n\\frac{p(\\alpha,\\lambda_i)p(\\beta,\\lambda_i)}{n}-\\sum_{i , j=1}^n\\frac{p(\\alpha,\\lambda_i)p(\\beta,\\lambda_j)}{n^2}\\right]\\geq0.\\ ] ] the correction to the variance in this case scales as @xmath70 , but again is of the same order as the variance itself , indicating a non - negligible correction . in this case to derive the heterogeneity of @xmath206 over the population one needs to know the average occupation level of each state @xmath207 and use : @xmath208.\\ ] ] this can be written in terms of the variance of @xmath209 in an equivalent system of identical particles , @xmath204_\\text{id}$ ] .",
    "if this is known , one can directly use @xmath210_\\text{id}-\\sigma^2[l]\\right).\\ ] ] note that , contrary to the two - level case , now the value of @xmath211 does not determine @xmath204_\\text{id}$ ] .",
    "[ [ intuitive - origin - of - the - decrease - of - fluctuations - for - independent - units ] ] intuitive origin of the decrease of fluctuations for independent units ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    we have shown that a system of independent heterogeneous particles has smaller fluctuations for the collective variable than an equivalent system of identical ones . the origin of this result is the following ( for simplicity we refer to the case of @xmath48-state system ) :    the average of the global variable is determined by the concentration of the states of the particles around state @xmath7 ( @xmath212 ) . the fluctuations ( measured by the variance ) of the global variable",
    "are determined by the stochastic fluctuations of the individual particles alone ( @xmath51=\\sum_i\\sigma^2[s_i]$ ] , since the particles are independent).in a system of heterogeneous particles , the dispersion of the states of the particles is due to the heterogeneity ( some prefer to be around sate @xmath10 , others prefer to be around sate @xmath7 ) plus their intrinsic stochasticity . in a system of identical particles ,",
    "the dispersion comes from the stochasticity alone , so for a system of identical particles to have the same concentration in the states of the particles ( global average ) than a heterogeneous system , the intrinsic stochasticity has to be larger",
    ". this will give rise to larger fluctuations for the global variable.in particular , any given rational value of @xmath213 can be obtained with zero fluctuations , taking @xmath214 particles that are always at state @xmath7 and @xmath215 particles that are always at state @xmath10 .",
    "this explanation is illustrated in figure ( [ fig : trajectories ] ) . in the identical - particles system",
    "both particles fluctuate between @xmath7 and @xmath10 . in the heterogeneous case",
    ", one particle spends most of the time at @xmath7 and the other spends most of the time at @xmath10 .",
    "the probability of finding a given particle at @xmath7 is the same in both cases ( @xmath216 ) but in the heterogeneous case most of the time there is one particle at @xmath7 and one particle at @xmath10 , resulting on a value of the average state most often equal to @xmath216 , and so with smaller fluctuations .",
    "the situation is similar for a larger number of particles , as shown in figure 1 of the main text .",
    "an analogous picture emerges when one considers more that @xmath48 states .",
    "note that in every case we compare a system of heterogeneous particles with another of identical ones that has the same one - particle distribution i.e. @xmath217 , @xmath200 .",
    "the general evolution equations for the first moments are of the form : @xmath218 our main ansatz is that the @xmath73-particle correlations @xmath74 with @xmath219 scale with system size as @xmath76 we first show how the ansatz ( [ ansatz ] ) allows to close the system ( [ momentsgeneral ] , [ correlationsgeneral]).we assume that functional dependence of the rates on the sate variables is of the form @xmath77 .",
    "this includes , for example , rates of the form @xmath220 like the ones used in the examples analyzed .",
    "we further assume that the rates can be expanded as a power series : @xmath221 there are @xmath222 terms in the @xmath32th summand , @xmath223 , giving a total contribution of order @xmath224 .",
    "the terms in the right hand side of ( [ momentsgeneral ] ) are of the form : @xmath225 where @xmath226 corresponds to a term of the form @xmath227 , @xmath228 corresponds to @xmath229 and the last equality holds due to our ansatz .",
    "we see that the dominant terms are those with @xmath230 , which correspond to products of mean values of the form @xmath231 .",
    "we conclude that the ansatz allows to do the substitution @xmath232 in the evolution equations for the mean values .",
    "the evolution equations for the correlations read : @xmath233 in this case , the terms are of the form @xmath234 with @xmath235 . due to the presence of @xmath236 , the term in which only averages appears vanishes .",
    "reasoning as before , we see that the dominant terms are those proportional to @xmath237 , while those proportional to higher - order correlations can be neglected . in this case",
    ", the ansatz allows to do the substitution @xmath238 . in this way ,",
    "the evolution equation for the correlations depend , at first order , only on averages and correlations and not on higher order moments .",
    "the validity of the ansatz ( [ ansatz ] ) itself can be established a posteriori by checking that the results obtained using the ansatz are consistent with it . in this section",
    ", we will link its validity with the well - known van kampen s ansatz @xcite that is the basis for the systematic system - size expansion .",
    "van kampen s ansatz consists on assuming that the variable of interest has a deterministic part of order @xmath71 plus a stochastic part of order @xmath239 , i.e. @xmath240 , where @xmath71 is a parameter of the system that controls the relative size of the changes due to elementary processes , typically the system size .    in our system",
    "the role of the parameter @xmath71 is played by the total number of particles @xmath0 . as briefly stated in the main text",
    ", we can not expect that the single - particle variables that we are considering obey van kampen s ansatz , since they are not extensive .",
    "our variables @xmath72 have a deterministic and stochastic part that are both of order zero respect to @xmath0 ( note that @xmath241=\\langle s_i\\rangle(1-\\langle s_i\\rangle)$ ] ) .",
    "however , the macroscopic variable @xmath155 is indeed extensive and we can expect that it will follow van kampen s ansatz : @xmath242 .",
    "this implies that the @xmath73-th central moment of @xmath22 will scale as @xmath243 , i.e : @xmath244 now , assuming that @xmath245 for @xmath246 , with @xmath247 independent of @xmath0 i.e. the @xmath73-particle correlations are all or the same order in @xmath0 , so that @xmath248 scales as @xmath249 ( note that there are of the order of @xmath250 terms in the sum ) , we obtain our main ansatz , @xmath251 for @xmath246 .",
    "we have only considered terms with @xmath246 in the sum ( [ vkansatzcorr ] ) ; terms with repeated sub - indexes can be expressed as lower order ones .",
    "for example , if the index @xmath252 is present @xmath32 times , and the others are all different , we find : @xmath253+\\sigma_{j_1,\\dots , j_{m - k+1}}[(1-\\langle s_{j_1}\\rangle)^k-(-\\langle s_{j_1}\\rangle)^k]\\nonumber\\end{aligned}\\ ] ] as can be see expanding @xmath254 and keeping in mind that @xmath69 .",
    "the number of such terms in the sum ( [ vkansatzcorr ] ) is @xmath255 , so they give smaller contribution that terms with all sub - indexes different .",
    "proceeding order by order from @xmath256 , we see that our main ansatz ( [ ansatz ] ) follows from ( [ vkansatzcorr ] ) .",
    "we point out that in systems of heterogeneous particles we do not have a closed description for the global , extensive , variable @xmath22 so van kampen s expansion can not be used .",
    "instead we derive the implications of van kampen s ansatz over the correlations of the microscopic variables .",
    "( [ ansatz ] ) is a simple and convenient expression that in general allows to close the equation for the moments ( [ momentsgeneral],[correlationsgeneral ] ) .",
    "often , however it is not necessary , and a weaker condition of the form ( [ vkansatzcorr ] ) , that directly follows from van kampen s ansatz without further assumptions , is sufficient .",
    "van kampen s ansatz is generally valid when the macroscopic equations have a single attracting fixed point , when the system displays small fluctuations around the macroscopic state .",
    "the general method explained here is expected to be valid under similar conditions .",
    "an interesting topic for future research will be whether a system that has a single attracting fixed point in the absence of diversity always maintains this globally stable state when diversity is present , and whether a system that does not posses this globally stable fixed point can acquire it when diversity is added .      in the kirman model with distributed influence ,",
    "the averages and correlations obey : @xmath257\\label{kirmancorrelations}\\end{aligned}\\ ] ] with @xmath258 .",
    "note that , due to the particular form of the rates , these equations are indeed closed .",
    "the first equation leads to a steady state value @xmath259 , which implies @xmath260 ( a property that comes from the symmetry @xmath95 ) .",
    "( [ kirmancorrelations ] ) is a linear system of equations for the correlations .",
    "the steady state correlations can always be obtained by inverting the matrix that gives the couplings . obtaining a closed expression for",
    "@xmath51 $ ] in terms of the moments of @xmath100 is , however , not straightforward . from ( [ kirmancorrelations ] ) , we see that in the steady state : @xmath261}{2(2\\epsilon+\\overline{\\lambda})}\\label{sigmakir},\\ ] ] from where we obtain @xmath262=\\sum_{i , j}\\sigma_{i , j}=\\frac{n(\\epsilon+\\overline{\\lambda}/2)+2c(1 - 1/n)}{2(2\\epsilon+\\overline{\\lambda})}\\label{sigmakir2},\\ ] ] with @xmath263",
    ". multiplying ( [ sigmakir ] ) by @xmath87 and summing over @xmath88 , one obtains : @xmath264 where @xmath265 .",
    "this is obtained again multiplying ( [ sigmakir ] ) by @xmath266 and summing over @xmath267 : @xmath268 where @xmath269 . using the ansatz @xmath270 we see that the last term of ( [ d ] ) is @xmath224 ( while the other are of @xmath30 ) , so to the first order we obtain : @xmath96=\\frac{n}{4}\\left[1+\\frac{\\overline{\\lambda}}{2\\epsilon}+\\frac{\\sigma^2[\\lambda]}{2\\epsilon\\left(4\\epsilon+\\overline{\\lambda}\\right)}\\right]+o(n^0),\\label{kirman1st}\\ ] ] with @xmath99=\\overline { \\lambda^2}-\\overline\\lambda^2 $ ] .",
    "we have seen how the application of the ansatz ( [ ansatz ] ) allows one to obtain closed expression for the global average and variance .",
    "interestingly , in this particular example , it is possible to include all higher order terms to obtain an exact expression for @xmath271 ( which gives the exact expression for @xmath51 $ ] trough ( [ c],[sigmakir2 ] ) ) , details are given in the appendix : @xmath272 the second equality holds as long as @xmath273 ( note that @xmath274 ) .",
    "a sufficient condition for this is @xmath275 . when the @xmath1 s are i.i.d .",
    "random variables , the probability that this condition is satisfied approaches one as @xmath0 grows .",
    "this condition is actually necessary and sufficient for the first equality in ( [ dexact ] ) to hold ( see appendix).we finally obtain the following exact expression for the variance : @xmath96=\\frac{n}{4}\\left[1 + \\frac{2\\overline{\\lambda}(1 - 1/n)}{4\\epsilon+\\overline{\\lambda } } + ( n-3 + 2/n)\\frac{\\overline{\\frac{\\lambda^2}{n(4\\epsilon+\\overline{\\lambda})+2\\lambda}}}{2\\epsilon+\\overline{\\frac{\\lambda^2}{n(4\\epsilon+\\overline{\\lambda})+2\\lambda}}}\\right]\\label{kirmanexact}\\ ] ]      expressions ( [ kirman1st ] , [ kirmanexact ] ) refer to the variance of @xmath22 in a population with given values for the parameters of each agent , @xmath1 , so the averages are population averages i.e. @xmath276 . in the case that the parameters of the agents are random variables , the population averages themselves , @xmath277 , become random variables . to compute the expected ( average ) value of ( [ kirman1st ] , [ kirmanexact ] ) , @xmath278}$ ] , one has to average over the distribution of @xmath277 , which depends on the distribution @xmath49 of the @xmath279 ( we are assuming @xmath279 i.i.d .",
    "random variables ) .",
    "this averages were obtained numerically , by evaluating expressions ( [ kirman1st ] , [ kirmanexact ] ) over the same realizations of the @xmath1 s that were used in the numerical simulations .",
    "one can use the approximation @xmath280 , that works better the larger the @xmath0 and the lower the variance @xmath281 , and that , due to the law of large numbers , is valid in the limit @xmath282 . in fig.2 of the main text",
    "we compare the average of the analytical expression ( [ kirmanexact ] ) with results coming from numerical simulations .",
    "we find perfect agreement and see that at first order the dependence of @xmath51 $ ] with @xmath283 is linear and independent of the form of the distribution , as indicated by ( [ kirman1st ] ) .",
    "higher order corrections are noticeable for higher levels of diversity .    in the case of heterogeneity in the preference of the agents for the states ,",
    "as indicated in the main text , the variance is given by : @xmath61_{st}&=&\\frac{n}{4(\\epsilon+\\frac{2\\lambda}{n})}\\left[\\overline{\\epsilon^+}(1+\\frac{\\lambda}{\\epsilon})-\\frac{\\overline{\\epsilon^+}^2}{\\epsilon}\\left(\\frac{\\lambda}{2\\epsilon}+1\\right)-2\\frac{\\sigma^{2}[\\epsilon]}{2\\epsilon+\\lambda}\\right]\\label{varkirmanprefer},\\end{aligned}\\ ] ] in this case , the average of ( [ varkirmanprefer ] ) over the distribution of parameters can be easily computed , giving : @xmath284}_{st}&=&\\frac{n}{4(\\epsilon+\\frac{2\\lambda}{n})}\\bigg[\\widehat{\\epsilon^+}\\left(2+\\frac{\\lambda}{\\epsilon}\\right)-\\widehat{\\epsilon^+}^2\\left(\\frac{\\lambda}{2\\epsilon^2}+\\frac{1}{\\epsilon}\\right)\\nonumber\\\\ & & \\hspace{1.5cm}-\\sigma^2_{\\epsilon^+}\\left(\\frac{2\\epsilon+\\lambda / n}{\\epsilon(2\\epsilon+\\lambda)}+\\frac{\\lambda}{2\\epsilon^2n}\\right)\\bigg]\\label{varkirmanprefermed},\\end{aligned}\\ ] ]    the correlation function can be derived as follows ( we exemplify the derivation in the case of distributed influence , for other types of heterogeneity , the derivation is similar):([kirmanaverage ] ) is an equation for the conditional averages @xmath285 if we set @xmath286 as initial conditions .",
    "it implies : @xmath287 with @xmath288 . noticing that ( [ kirmanaverage ] ) is equal to @xmath289",
    ", we obtain : @xmath290 using now @xmath291(t)=\\langle \\langle n(t_0+t)|n(t_0)\\rangle n(t_0)\\rangle_{st}-\\langle n\\rangle_{st}^2=\\sum_{i , j}\\langle\\langle s_i(t_0+t)|\\{s_k(t_0)\\}\\rangle s_j(t_0)\\rangle-\\frac{n^2}{4}$ ] ( remember @xmath292 ) , and after some straightforward algebra , we obtain : @xmath293(t)=(\\sigma_{st}^2-c/\\overline{\\lambda})e^{-(2\\epsilon+\\overline{\\lambda})t}+c/\\overline{\\lambda}e^{-2\\epsilon t}.\\label{kst}\\ ] ] from ( [ sigmakir ] ) we get @xmath294 , showing that ( [ kst ] ) is equal to the expression displayed in the main text .",
    "we start with equation ( [ sigmakir ] ) : @xmath261}{2(2\\epsilon+\\overline{\\lambda})}.\\ ] ] using the rescaled variables @xmath295 , and defining @xmath296 , we obtain : @xmath297 defining now @xmath298 , we arrive to : @xmath299,\\\\   t_{m+1}-g_1&=&t_m+\\frac{n}{2}\\sum_{n=1}^m\\left[\\left(\\frac{2}{n\\overline{\\tilde{\\lambda}}-1}\\right)^n\\left(\\frac{2\\overline{\\tilde{\\lambda}^{n+1}}}{n\\overline{\\tilde{\\lambda}}-1}+g_1\\overline{\\tilde{\\lambda}^{n}}\\right)\\right].\\end{aligned}\\ ] ]    if @xmath300 , we see that : @xmath301 going back to the original variables , we finally obtain , with the notation of the main text : @xmath302 which can be rewritten in the form ( [ dexact ] ) , completing the proof .",
    "the condition of convergence is : @xmath303 a necessary and sufficient condition for this is @xmath304 .",
    "when the parameters @xmath1 are i.i.d .",
    "r. v. the probability of this typically approaches @xmath7 as @xmath0 grows ."
  ],
  "abstract_text": [
    "<S> we study stochastic particle systems made up of heterogeneous units . </S>",
    "<S> we introduce a general framework suitable to analytically study this kind of systems and apply it to two particular models of interest in economy and epidemiology . </S>",
    "<S> we show that particle heterogeneity can enhance or decrease the size of the collective fluctuations depending on the system , and that it is possible to infer the degree and the form of the heterogeneity distribution in the system by measuring only global variables and their fluctuations . </S>",
    "<S> our work shows that , in some cases , heterogeneity among the units composing a systems can be fully taken into account without losing analytical tractability    most real systems are made up of heterogeneous units . </S>",
    "<S> whether considering a population of cells @xcite , a group of people @xcite or an array of lasers @xcite ( to name just a few examples ) , one never finds two units which behave exactly in the same way . despite this general fact , quantitative modeling most often assumes identical units , since this condition seems necessary for having analytically tractable models . </S>",
    "<S> moreover , in the general framework of complexity science , systems very often can be modeled only at a stochastic level , since a complete knowledge of all the variables , the precise dynamics of the units and the interaction with the environment is not available . </S>",
    "<S> one way to include system heterogeneity is to consider that the interactions between the units are not homogeneous but mediated by some complex network , an approach that has attracted enormous attention in the last years @xcite . </S>",
    "<S> an issue that has been less studied , beyond the role of particle heterogeneity in deterministic systems @xcite , is the heterogeneity in the behavior of the particles themselves in stochastic models . </S>",
    "<S> some exceptions include the recent reference @xcite , where the authors analyze the effect of heterogeneous transition rates on consensus times in the voter model , and works considering the effect of a few `` committed '' individuals in this and related models @xcite . in the context of statistical physics , </S>",
    "<S> the combined effects of stochasticity and heterogeneity have been considered , for example , in random - field ising models and spin glasses @xcite or in diffusion in disordered media @xcite . </S>",
    "<S> we aim here at developing a general framework for the analytical study of stochastic systems made up of heterogeneous units , applicable beyond equilibrium models or hamiltonian systems and suitable for a general class of complex systems of recent interest and at identifying some generic effects of particle heterogeneity on the macroscopic fluctuations .    in this work </S>",
    "<S> we will show that the combined effect of stochasticity and heterogeneity can give rise to unexpected , non - trivial , results . </S>",
    "<S> while , based on nave arguments , one should conclude that global fluctuations increase in heterogeneous systems , we will show that in some systems of stochastic interacting particles fluctuations actually decrease with the degree of heterogeneity . </S>",
    "<S> moreover , we will see that it is possible to infer the degree of particle heterogeneity ( or `` diversity '' ) by measuring only global variables . </S>",
    "<S> this is an issue of great interest when one has access only to information at the macroscopic , population level , since it allows one to determine if heterogeneity is a relevant ingredient that needs to be included in the modeling . in this way </S>",
    "<S> , heterogeneity can be included when its presence is implied by the data and it does not enter as an extra free parameter . </S>",
    "<S> we will study first the simple case of independent particles ; then we will consider the general case of interacting particles and develop an approximated method of general validity to analytically study these systems ; next , as a way of example , this method will be applied to two particular models of interest in economy and epidemiology .    </S>",
    "<S> our starting point is a stochastic description of a system composed by @xmath0 non - identical units , which we call generically `` particles '' or  agents \" . </S>",
    "<S> each particle is characterized by a constant parameter @xmath1 ( @xmath2 ) ; the value of this parameter differs among the particles and it is the source of heterogeneity considered . although there are more general ways of including heterogeneity , we will stick to this type of parametric heterogeneity @xcite because it is simple yet rather general . </S>",
    "<S> for simplicity , we assume that each particle can be in one of two possible states and define @xmath3 as the variable describing the state of particle @xmath4 at time @xmath5 ( the two - states assumption will be relaxed later ) . </S>",
    "<S> the collective state of the system is given by the total number @xmath6 of particles in state @xmath7 . </S>",
    "<S> sometimes , one does not have access to the individual dynamics and can only access experimentally the value of @xmath8 . </S>",
    "<S> we are interested in the statistical properties of this global variable and how do they depend on the degree of heterogeneity in the system . </S>",
    "<S> we will often refer to @xmath8 as the _ macroscopic _ variable and to the @xmath9 s as the _ microscopic _ ones . </S>"
  ]
}