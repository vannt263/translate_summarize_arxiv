{
  "article_text": [
    "thermoacoustic tomography ( tat ) and the closely related photoacoustic modality ( pat ) are both based on the measurements of acoustic waves generated within the object of interest by a thermoelastic expansion @xcite . to initiate the wave ,",
    "the object is illuminated by a short electromagnetic ( em ) pulse whose energy is partially absorbed by the tissues . the subsequent increase in the local temperature",
    "makes the tissues expand , which in turn generates the outgoing acoustic wave registered by the detectors surrounding the object .",
    "by solving the corresponding inverse problem one can reconstruct the distribution of the initial pressure inside the body .",
    "spikes in the initial pressure are indicative of cancerous tumors that absorb much more em energy than healthy tissues ; thus , cancer detection ( particularly , in breast imaging ) is one of the most promising applications of this modality .",
    "general review of the inverse problem of tat / pat , and investigation of the related mathematical questions can be found in reviews @xcite and references therein .",
    "the recent advances in the measuring technology of tat / pat make it possible to collect enough data to reconstruct high resolution 3d images of the object of interest .",
    "since such a reconstruction amounts to computing many millions of unknowns , the use of existing reconstruction algorithms may lead to inordinate computation time .",
    "for example , methods based of filtration / backprojection formulas would require several days of computations per one high - resolution 3d image .",
    "we , thus , propose three fast reconstruction algorithms for certain acquisition geometries with spherical or circular symmetry , including , in particular , a fast method for the measuring scheme with integrating line detectors arranged in a rotating cylindrical assembly .",
    "the present algorithms produce high quality images two orders of magnitude faster than the existing methods .",
    "let us briefly review existing reconstruction techniques while paying close attention to the asymptotic estimates of the number of floating point operations ( flops ) needed to complete one reconstruction .",
    "( while such estimates hide the unknown constant factor , they usually provide a good qualitative measure of the efficiency of the method . )",
    "ideally , one would like to reconstruct an image on a grid with @xmath5 unknowns in @xmath6 flops .",
    "however , methods that require @xmath7 flops ( where @xmath8 is some constant ) are still generally considered `` fast '' .",
    "the simplest inverse problem in tat / pat arises when small ( point - like ) detectors are placed on an infinite plane . in this case",
    "the explicit solution can be obtained using the fourier transform techniques ( see @xcite and references therein ) .",
    "the authors of @xcite , by combining proper discretization of such a solution with application of the non - uniform fft ( nufft ) developed a fast algorithm that reconstructs images on @xmath9 grid ( in 3d ) in @xmath10 flops .",
    "however , in any practical application such a measuring plane needs to be truncated , which leads to a loss of information about the wave fronts nearly parallel to the plane .",
    "thus , it is preferable to use closed ( and bounded ) measuring surfaces .",
    "one of the simplest closed surfaces is a sphere , and first explicit solutions of the tat / pat  problem in a closed domain were obtained for circular ( in 2d ) and spherical ( in 3d ) acquisition geometries in @xcite and @xcite by means of separation of variables .",
    "later , some modifications of the 2d formulas of @xcite were proposed in @xcite and @xcite in order to avoid the divisions by zero in the original formulas of @xcite .",
    "such techniques have complexity @xmath11 flops for a 2d grid with @xmath12 unknowns . a straightforward implementation of the 3d version of the series solution @xcite results in a rather slow @xmath13 algorithm .",
    "however , a modification of this technique proposed in @xcite , if properly discretized , yields a faster @xmath14 algorithm .",
    "there also exist several explicit inversion formulas of filtration / backprojection type @xcite for the spherical or circular acquisition geometries . in spite of the theoretical importance of these formulas , the corresponding algorithms are not fast , requiring @xmath11 flops for a 2d reconstruction on @xmath15 grid , and @xmath16 flops for a 3d problem .",
    "the time reversal by means of a finite difference solution of the wave equation back in time @xcite is faster ( at least in 3d ) .",
    "this technique can be adapted to almost any closed acquisition surface , and it allows one to take into account ( known ) variations in the speed of sound within the region of interest ( most other techniques are applicable only if the speed of sound is a known constant ) .",
    "these methods have complexity @xmath14 in 3d and @xmath17 in 2d",
    ".    mathematically equivalent to the time reversal are the methods based on expanding the solution of the wave equation into the series of eigenfunctions of the dirichlet laplacian in the domain surrounded by the acquisition surface @xcite .",
    "this technique is computationally efficient only if there exists a fast method for the summation of the eigenfunctions . for example , if the detectors are placed on a surface of a cube , such a summation can be performed using the 3d fast fourier transform ( fft ) algorithm , and one obtains a very fast @xmath18 reconstruction technique @xcite .",
    "this is the only known fast method for tat / pat problems with point - like detectors placed on a closed surface .",
    "in addition to point - like detectors , there exists another new and promising class of measuring devices , the so - called integrating line detectors @xcite .",
    "a sensing element in a line detector is a straight optical fiber coupled to a laser interferometer .",
    "( in some implementations the fiber is replaced by a laser beam propagating through the water in which the object of interest is immersed . ) propagating acoustic waves slightly elongate the fiber , and this elongation is registered by the interferometer .",
    "the measured value is proportional to the line integral of the acoustic pressure .",
    "since the fiber can be made very thin , the use of such detectors can significantly increase the spatial resolution of tat / pat .",
    "however , in order to enable this new acquisition technique one needs new inversion algorithms .",
    "the most studied measurement scheme of this sort @xcite utilizes integrating line detectors arranged in a rotating cylindrical assembly ( see figure  [ f : geom](a ) ) , with the object placed inside the cylinder .",
    "a two step inversion procedure was proposed in @xcite for solving the arising inverse problem ( see also @xcite ) .",
    "it is based on the observation that , for a fixed orientation of the cylinder , the data measured by the line detectors are related to the line integrals of the sought function ( over the parallel lines ) by the two - dimensional wave equation .",
    "thus , the latter line integrals can be reconstructed by one of the 2d methods for tat / pat  with conventional point - like detectors placed on a circle .",
    "the first step of the reconstruction procedure consists in solving such a 2d problem for each orientation of the cylinder . on",
    "the second step one performs a series of inversions of the 2d radon transform to reconstruct the sought function from the line integrals whose values were found on the first step . since the fastest known algorithms for the circular geometry require at least @xmath11 operations , and the number of problems to be solved is @xmath19 the first step needs at least @xmath20 flops .",
    "the second step as described in @xcite is also an @xmath20 flops procedure ; however , since methods for fast ( @xmath21 inversion of the 2d radon transform are well - known ( see @xcite and references therein ) , it can be accelerated to @xmath22 flops .",
    "thus , the total number of operations ( @xmath23 for the whole inversion technique is determined by the first step .",
    "one of our goals is to develop a fast algorithm for the data acquisition scheme with integrating line detectors described in the previous paragraph . to this end",
    ", we first develop a fast @xmath24 reconstruction algorithm for the 2d problem with point - like detectors located on a circle .",
    "since such a technique ( and its 3d generalization ) are of independent interest for problems with conventional detectors , we present them separately in section  [ s : conventional ] .",
    "further analysis of the 3d problem with the line detectors shows that the two - step reconstruction procedure mentioned in the previous paragraph is somewhat suboptimal . instead , a direct",
    ", efficient @xmath22 reconstruction algorithm can be built by modifying the 2d method described in section  [ s:2dconventional ] ; we present this technique in section  [ s : linedet ] .",
    "the results of numerical simulations show that our methods yield very fast reconstructions without any sacrifice in stability or in the resolution of the images .",
    "in addition to simulations , in section  [ s : real ] we illustrate the work of our algorithms by reconstructing images from the data of real measurements performed in recendt ( research center for non - desctructive testing , linz , austria ) .",
    "we will assume throughout the paper that the speed of sound in the tissue is constant ( in this case one can set it to be equal 1 without loss of generality ) , and that the attenuation is negligible .",
    "this simplified model is acceptable in such important applications as breast imaging , and most of the formulas and algorithms mentioned in the introduction are based on these assumptions .",
    "( in the situations when the variations in the speed of sound need to be taken into account , other techniques ( e.g. , time reversal ) should be used . )    under the above assumptions the acoustic pressure @xmath25 solves the following initial problem for the wave equation in the whole space@xmath26{c}%",
    "u_{tt}=\\delta u,\\text { } x\\in\\mathbb{r}^{d},\\text { } t\\in\\lbrack0,\\infty),\\\\ u(x,0)=f(x),\\\\ u_{t}(x,0)=0 .",
    "\\end{array } \\right .   \\label{ivp}%\\ ] ] were the initial pressure of the acoustic wave @xmath27 is the function we seek , and dimension @xmath28 equals 2 or 3 , depending on the context .",
    "we will assume that @xmath27 is finitely supported within the region of interest @xmath29 and that the measurements of @xmath25 are done outside @xmath30      as explained in the introduction , we start with the problem that arises when the pressure is measured by the conventional point - like detectors placed on a circle ( or , in 3d , a sphere ) @xmath31 of radius @xmath32 and @xmath33 coincides with the corresponding disk ( or ball ) @xmath34 .",
    "in other words , the data @xmath35 are defined as follows@xmath36    reconstruct @xmath27 from @xmath37 , @xmath38 , @xmath39 @xmath40    the solution of this problem will serve as an important step in solving problem 2 .",
    "we will also present a fast algorithm for solving the 3d version of this problem :    reconstruct @xmath27 from @xmath37 , @xmath41 , @xmath39 @xmath42.$ ]    the difference in the observation time used in 2d and 3d versions arises since in 3d , due to the huygens principle , @xmath43 on @xmath31 for all @xmath44 we present fast algorithms for solving problem 1 in 2d and 3d in section  [ s : conventional ] .",
    "suppose that the acoustic pressure @xmath25 satisfying conditions ( [ ivp ] ) is measured by the integrating line detectors lying on the surface of a cylinder of radius @xmath45 whose axis is parallel to the vector @xmath46 and passes through the origin ( see figure  [ f : geom ] ) .",
    "if we denote the left normal to @xmath47 lying in the horizontal plane ( spanned by the vectors @xmath48 and @xmath49 ) by @xmath50 then each detector lies on a line @xmath51 passing through the point @xmath52 where @xmath53 is the vertical unit vector .",
    "this detector measures the value proportional to the line integral @xmath54 of @xmath55@xmath56 where we assume for simplicity that the detectors are infinitely long .",
    "reconstruct the initial condition @xmath27 ( supported within a ball of radius @xmath45 centered at the origin ) from the measurements @xmath54 known for all @xmath57,$ ] @xmath58,$ ] @xmath59    we solve this problem in section  [ s : linedet ] .",
    "as mentioned in the introduction , there exist a variety of the methods for the solution of problem 1 in 2d and 3d . however",
    ", none of the known methods have optimal computational complexity . a fast algorithm for the 3d version of the problem",
    "is needed since even relatively fast @xmath14 methods require several hours of computing time ; methods based on slower @xmath16 discrete versions of explicit inversion formulas can easily run a couple of days on larger computational grids .",
    "a single solution of the 2d problem does not take long in practical terms even if a slow algorithm is used .",
    "however , in order to solve problem 2 , one need to solve the 2d version of problem 1 @xmath60 times , which can again result in several hours of computation .",
    "hence , a fast method is also needed .",
    "solution @xmath25 to the initial value problem ( [ ivp ] ) in 2d can be written @xcite in the following form:@xmath61 where @xmath62 is the free space green function of the wave equation : @xmath63{cc}% \\frac{1}{2\\pi\\sqrt{t^{2}-x^{2 } } } , & t>|x|,\\\\ 0 , & t\\leq|x| .",
    "\\end{array } \\right.\\ ] ] in particular , the measured data @xmath35 are given by the similar formula @xmath64 where @xmath34 is disk of radius @xmath45 and @xmath31 is its boundary .",
    "let us find the fourier transform @xmath65 of @xmath35 in @xmath66@xmath67 and the fourier transform @xmath68 of the green function : @xmath69 by combining ( [ grconv ] ) and ( [ phat2d ] ) we obtain:@xmath70 let us utilize the addition theorem for @xmath71 ( see , for example @xcite):@xmath72 also , let us expand @xmath73 and @xmath74 in the fourier series in @xmath75 and @xmath76:@xmath77 where coefficients @xmath78 and @xmath79 are given by the formulas@xmath80    by substituting ( [ addition ] ) into ( [ helmholtz ] ) and expanding in the fourier series one obtains@xmath81   e^{-ik\\varphi}d\\varphi\\nonumber\\\\ &   = \\lambda h_{|k|}^{(1)}(\\lambda r)\\left (   \\int\\limits_{0}^{2\\pi}% \\int\\limits_{0}^{\\infty}f(r\\hat{x}(\\theta))j_{|k|}(\\lambda r)e^{-ik\\theta } rdrd\\theta,\\right )   \\label{series}%\\end{aligned}\\ ] ] and further , by utilizing ( [ fseries]):@xmath82 the above formula relates @xmath78 to the hankel transform of @xmath83 and , since the latter transform is self - invertible,@xmath84 formula ( [ harmsol ] ) was first presented in @xcite .",
    "a somewhat similar expression was obtained in @xcite ; instead of @xmath85 it contained the bessel functions @xmath86 in the denominator , and a term that corresponds to the real part of our @xmath87 in the numerator . in that formula ,",
    "theoretically , the zeros of @xmath88 cancel the zeros of the bessel function in the denominator .",
    "however , when @xmath78 is computed from the data of real measurements contaminated by noise , the cancellation will not happen automatically . in @xcite a technique based on the use of fourier - bessel series",
    "was proposed to avoid such division by zeros .",
    "our approach is based on formula ( [ harmsol ] ) ; since hankel s functions do not vanish for real ( and bounded ) values of the argument , this formula provides a stable ( and simple ) way to recover @xmath89    a straightforward discretization of equation ( [ harmsol ] ) leads to a method that would require @xmath90 flops per each @xmath91 and @xmath11 per whole reconstruction , and thus , is not fast enough . to develop a fast algorithm",
    "we combine ( [ fseries ] ) and ( [ harmsol ] ) and represent @xmath92 in the following form:@xmath93 let us now consider plain waves @xmath94:@xmath95 and expand these waves in the fourier series in @xmath96 the values of the corresponding fourier coefficients can be found using the jacobi - anger expansion @xcite:@xmath97 so that@xmath98 by substituting the latter formula in ( [ myseries ] ) we obtain@xmath99 w(r\\hat{x}(\\theta),\\lambda(\\lambda,\\varphi))d\\varphi\\lambda d\\lambda . \\label{long2d}%\\ ] ] let us denote by @xmath100 the expression in the brackets ( the choice of such a notation will become clear momentarily)@xmath101 then ( [ long2d ] ) can be re - written as@xmath102 which means that @xmath103 is , in fact , the 2d fourier transform of @xmath27 defined in the standard way:@xmath104    formula ( [ fastalg ] ) allows us to compute @xmath103 for all values of @xmath105 in order to find @xmath106 the following integral identity can be used:@xmath107   dr\\nonumber\\\\ &   = \\int\\limits_{0}^{\\infty}\\frac{2\\hat{p}_{0}(\\lambda)}{\\pi h_{0}% ^{(1)}(\\lambda r)}\\left [   \\int\\limits_{0}^{r}rj_{0}(\\lambda r)dr\\right ] d\\lambda=\\int\\limits_{0}^{\\infty}\\frac{2\\hat{p}_{0}(\\lambda)}{\\pi\\lambda h_{0}^{(1)}(\\lambda r)}rj_{1}(\\lambda r)d\\lambda . \\label{f0in2d}%\\end{aligned}\\ ] ] since @xmath71 has a logarithmic singularity at @xmath108 and @xmath109 has a single root at the latter point , the integrand in ( [ f0in2d ] ) vanishes as @xmath110 and the formula is well - defined .",
    "now @xmath27 can be computed by applying the 2d inverse fourier transform to @xmath111 we utilize the fft s on various steps of the resulting algorithm to make the computations fast :    * the algorithm for problem 1 in 2d : *    1 .   on an equispaced grid in @xmath112",
    "compute @xmath113 using 1d fft in time:@xmath114 2 .   for each value of @xmath112 in the grid compute @xmath78 using 1d fft in @xmath75 :",
    "@xmath115 3 .   for each value of @xmath116 in the grid compute coefficients @xmath117@xmath118 4 .   on a polar grid in @xmath112 and @xmath75",
    "compute @xmath119 by summing the fourier series ( use 1d fft ) : @xmath120 5 .",
    "compute @xmath106 from formula ( [ f0in2d ] ) using the trapezoid rule .",
    "interpolate @xmath103 to a cartesian grid in @xmath121 7 .",
    "reconstruct @xmath27 by the 2d inverse fft .",
    "it is not difficult to estimate the computational costs of the present method . assuming that the computational grid is of size @xmath122 and the number of detectors and the size of the grids in @xmath112 and @xmath75 are @xmath19 steps 1 , 2 , 4 , and 7 require @xmath24 flops each .",
    "step 3 needs @xmath90 operations and step 5 is completed in @xmath60 flops .",
    "the interpolation step 6 needs some commentary .",
    "it is known @xcite that low - order interpolation in spectral domain can be a source of significant error .",
    "in particular , interpolation in the radial direction ( i.e. in @xmath123 is more sensitive than that in the angular direction ( i.e. in @xmath124 .",
    "the results presented below were obtained by combining linear interpolation in @xmath75 with interpolation by cubic polynomials in @xmath125 we found that this yields accuracy that is more than sufficient for practical tomography applications . since such interpolation is local , the associated operation count is @xmath126 however , if a more accurate interpolation is desired , one can apply methods based on global trigonometric interpolation using the nufft ( see , e.g. @xcite ) , for the total cost of @xmath24 operations . in any case , the asymptotic estimate for the total number of operations required by the present method is @xmath127      in order to evaluate the performance of our algorithm we simulated high resolution projections that corresponded to a phantom consisting of several characteristic functions of disks lying inside a unit circle , as shown in figure  [ f : rec2d](a ) .",
    "the number of the simulated detectors was equal to 272 ( this corresponds to the number of detectors in the set of real measurements presented in section  [ s : real ] ) .",
    "the detectors were placed on a circle of radius 1.05 .",
    "the measurements were simulated for the time interval @xmath128 $ ] , with time step 0.005 ( i.e. , 1000 time samples were simulated ) .",
    "a smooth cut - off was applied at the end of this time interval , and the signal for @xmath129 was neglected .",
    "the result of the reconstruction on a grid @xmath130 is shown in figure  [ f : rec2d](b ) ; the computation took 0.3 seconds on a desktop computer with a @xmath131 ghz intel core 2 duo processor .",
    "the code was written in fortran-95 , and computations were not parallelized .    in order to test stability of the present method we added @xmath132 ( in @xmath133 norm ) noise to the simulated projections .",
    "figure  [ f : rec2d](c ) compares the noiseless and noisy data for the first detector .",
    "figure  [ f : rec2d](d ) presents the result of the reconstruction from the noisy data .",
    "one can notice low level of noise in the reconstructed image , which is unusual for the inverse problems of tomography , where at least mild instability ( and hence , some noise amplification ) occurs almost always .",
    "a quick glance at the steps of the algorithm confirms that all the operations are stable : the fourier transforms and series are isometries in @xmath133 , and in the formula  ( [ bkeys ] ) @xmath78 is multiplied by a factor that vanishes as @xmath112 goes to infinity .",
    "the reason of such stability is the presence of the time derivative in the equation ( [ grconv ] ) that describes the wave propagation . in the absence of this derivative",
    "( i.e. for example if the initial value of the pressure was zero but the time derivative was non - zero ) the stability properties of the problem would be similar to those of the classical inverse radon transform in 2d , and some noise amplification would occur during the reconstruction .",
    "it is also interesting to compare the present technique with the results obtained by the time reversal computed using finite differences . in order to do so",
    ", we solved the 2d wave equation back in time in the unit square @xmath134 , using the explicit leapfrog scheme@xmath135 starting with @xmath136 at time @xmath137 and enforcing the boundary condition @xmath138 for all @xmath139 lying on the boundary @xmath140 of @xmath30 we chose to do the reconstruction in a square domain since the exact boundary conditions are easy to enforce in the nodes of the computational grids lying on the sides of the square .",
    "( for a domain of a different shape enforcing the boundary conditions requires interpolation ( see e.g. @xcite ) which brings additional error ) . in order to guarantee the stability of this explicit scheme we had to increase the number of time steps from 1000 to 3800 .",
    "the result of the reconstruction by the time reversal is shown in figure  [ f : reversal](a ) .",
    "larger features of the image are reconstructed quite well .",
    "however , the second - order finite difference scheme we used is not very accurate on higher spatial frequencies , which leads to a typical diamond - shaped distortion of small round shapes , clearly visible in the magnified fragment of the image presented in figure  [ f : reversal](b ) .",
    "the same part of the image in figure  [ f : rec2d](b ) ( obtained using the present algorithm ) is shown in figure  [ f : reversal](c ) .",
    "the artifacts are much smaller , in spite of the lesser number of time steps in the data .",
    "the time reversal took 214 seconds on the same computer , as before .",
    "even if one discounts this number by a factor of 4 ( to account for a larger number of the time steps ) , our technique is still faster by two orders of magnitude .      in this section",
    "we briefly outline the 3d version of the method presented in section  [ s : alg2d ] . in 3d ,",
    "the green s function for the wave equation satisfying radiation condition at infinity has the following form @xcite:@xmath141 as in 2d case , we compute the fourier transform in @xmath142 from the data @xmath35 @xmath143 and the fourier transform @xmath68 from the green s function@xmath144 by combining ( [ grconv3d ] ) and ( [ grfourier3d ] )  we obtain:@xmath145 we will utilize spherical harmonics @xmath146 @xmath147 normalized so that@xmath148 where @xmath149 is the kronecker symbol . let us extend @xmath27 and @xmath113 in spherical harmonics : @xmath150    as in the 2d case , we make use of the addition theorem for @xmath151 @xcite:@xmath152 where @xmath153 and @xmath154 are , respectively , the spherical bessel and hankel functions .    by substituting the above equation , together with ( [ sphrhar1 ] ) , into ( [ newconv3d ] ) we obtain@xmath155   d\\hat{x}r^{2}dr\\\\ &   = \\sum\\limits_{k=0}^{\\infty}\\sum\\limits_{m =- k}^{k}\\left (   h_{k}% ^{(1)}(\\lambda r)\\lambda^{2}\\int\\limits_{0}^{\\infty}f_{k , m}(r)j_{k}(\\lambda r)r^{2}dr\\right )   y_{k}^{m}(\\hat{y}),\\end{aligned}\\ ] ] and further , by comparing with ( [ sphrhar3]):@xmath156 the spherical bessel functions are related to their cylindrical counterparts by the equation@xmath157 thus , @xmath158 can be expressed in terms of the hankel transform of @xmath159 : @xmath160 j_{s+1/2}(\\lambda r)rdr\\right )   .\\ ] ] since the hankel transforms are self - invertible , one recovers @xmath161 as follows:@xmath162    this approach is close ( although not quite identical ) to the solution obtained in @xcite .",
    "( an expression equivalent to ( [ nortonsol3d ] ) was derived in @xcite . ) a straightforward computation of ( [ nortonsol3d ] ) for all @xmath163 @xmath164 leads to an algorithm of complexity at least @xmath14 for an @xmath9 computational grid . in order to accelerate the computations we choose the following approach . by substituting ( [ nortonsol3d ] ) into ( [ sphrhar1 ] )",
    "we obtain:@xmath165 a convenient integral representation for the term @xmath166 in the above equation is given by the funk - hecke formula @xcite : @xmath167 combining ( [ myser3d ] )  and ( [ funk3d ] ) yields:@xmath168   e^{-ix\\cdot\\lambda } d\\lambda,\\end{aligned}\\ ] ] where @xmath169 let us denote the term in the brackets by @xmath170:@xmath171 and it becomes clear that function @xmath170 is the 3d fourier transform of @xmath27 defined as follows:@xmath172    formulas ( [ grconv3d ] ) and ( [ sphrhar4 ] ) allow us to reconstruct the fourier transform @xmath170 for all @xmath105 in order to find @xmath173 we notice that@xmath174 where @xmath175 is given by ( [ nortonsol3d ] ) , so that:@xmath176   d\\lambda.\\end{aligned}\\ ] ] since @xmath177 the integral in the brackets can be easily evaluated:@xmath178 leading to the following expression for @xmath173:@xmath179 thus , @xmath27 can be reconstructed by the following method :    * the algorithm for problem 1 in 3d : *    1 .   on an equispaced grid in @xmath112",
    "compute @xmath113 using 1d fft in time:@xmath114 2 .   for each value of @xmath112 in the grid expand @xmath180 in spherical harmonics in @xmath181 : @xmath182 3 .   for each value of @xmath116 in the grid compute coefficients",
    "@xmath183:@xmath184 4 .   on a spherical grid in @xmath185",
    "compute @xmath170 by summing spherical harmonics : @xmath186 5 .",
    "compute @xmath173 from formula ( [ f03d ] ) using the trapezoid rule .",
    "interpolate @xmath170 to a cartesian grid in @xmath121 7 .",
    "reconstruct @xmath27 by the 3d inverse fft .",
    "the most time - consuming steps of this algorithm are steps 2 and 4 , corresponding to the fourier analysis and synthesis on a sphere .",
    "one of the simplest ways to decompose a function in the spherical harmonics combines expansion into the fourier series ( which can be done fast using the fft ) with the expansion into the series of legendre functions .",
    "the straightforward implementation of the latter legendre transform requires @xmath90 flops for a one dimensional function defined by @xmath187 samples .",
    "then , expanding one 2d function on a sphere ( defined by @xmath15 samples ) into a series of spherical harmonics needs @xmath11 operations , and the present method involving @xmath60 of such expansions would require @xmath14 flops ( synthesis of spherical harmonics is quite similar to the analysis ) .",
    "recently , several versions of the fast spherical harmonics ( fsh ) transform were introduced by several research groups @xcite .",
    "fsh is asymptotically fast ; it performs fourier analysis and synthesis on a sphere in @xmath188 flops .",
    "if this algorithm is used on steps 2 and 4 of our reconstruction technique , the resulting method will also be fast , requiring @xmath189 operations per a 3d reconstruction .",
    "one has to keep in mind , however , that the break - even size for which the fsh  starts to outperform the simple slow method described in the previous paragraph is currently of order of hundreds , and thus our 3d reconstruction method would not significantly outperform slower @xmath14 techniques for the sizes of the problems we consider in this paper .",
    "in addition , ready - to - use implementations of the fsh are only available for a restricted number of operating systems and computational languages . however , as the work on the fsh progresses , the performance and the ease of programming of our 3d method will improve .",
    "it is known @xcite that problem 2 can be reduced to solving a set of problems 1 in 2d , followed by a set of numerical inversions of the 2d radon transform .",
    "indeed , let us fix unit vector @xmath190 and consider all line integrals @xmath191 in the direction @xmath190 of @xmath25 : @xmath192    it is well - known ( see e.g. @xcite ) that integrals @xmath191 satisfy the wave equation in @xmath193 ( the `` method of descent ''  is based on this fact):@xmath194 with the initial conditions@xmath195 in other words , the initial values @xmath196 of @xmath197 are the integrals of @xmath27 along the straight lines parallel to the vector @xmath190 . on the other hand , integrals @xmath54 measured by the integrating line detectors ( see equation ( [ e : cylinder ] ) are equal to the values of @xmath191 for all @xmath198lying on the circle @xmath31 of radius @xmath45 centered at the origin @xmath199:@xmath200 therefore , for each fixed angle @xmath201 values of @xmath202 can be recovered within the disk @xmath34 ( bounded by @xmath31 ) by applying the 2d algorithm of section  [ s:2dconventional ] to @xmath203 .",
    "further , for a fixed value of the vertical coordinate @xmath204 the values of @xmath205 correspond to the 2d radon transform of the restriction of @xmath27 to the plane @xmath206 thus @xmath207 can be reconstructed from @xmath208 using one of the well - known inversion algorithms for the latter transform ( see e.g. @xcite ) .",
    "in particular , in  @xcite the well - known filtration / backprojection algorithm is utilized for such a computation .",
    "the above mentioned techniques are not as fast as we would like , however . in order to accelerate the computation",
    ", one can combine the fast method proposed in section  [ s:2dconventional ] , with the fast fourier transform - based inversion of the radon transform @xcite .",
    "notice , however , that such two stage approach adds to the algorithm a numerical inversion of the 2d radon transform , which may increase the computational error , since such inversion is a ( mildly ) ill - posed problem .",
    "moreover , such an algorithm is somewhat redundant .",
    "indeed , on the first stage the values of @xmath202 are reconstructed by means of the fourier synthesis ( step 7 of the algorithm presented in section [ s : alg2d ] ) . on the second stage , as a part of the fourier reconstruction from projections , the 1d fourier transform in @xmath209 of projections @xmath208",
    "is computed for each value of @xmath8    this redundancy can be eliminated as follows . for each fixed @xmath8",
    "let us apply the first 5 steps of the algorithm from section [ s : alg2d ] to the data @xmath203 and compute functions @xmath210 , where the subscript indicates the dependence of @xmath211 on the angle @xmath201 and the fact that @xmath210 are solutions of 2d problems .",
    "for a fixed @xmath201 function @xmath210 is the 2d fourier transform of @xmath212 since @xmath202 are the x - ray projections of the initial condition @xmath213 in the direction @xmath214 by the well - known slice - projection theorem @xcite @xmath210 coincides with the values of the 3d fourier transform @xmath215 of @xmath27 restricted to the plane normal to @xmath190 and passing through the origin @xmath216 therefore , @xmath215 can be reconstructed directly from the values of @xmath210 computed for all @xmath8 from @xmath217 to @xmath218 the sought function @xmath27 is then obtained by computing the 3d inverse fourier of @xmath219 this can be summarized in the form of the following    * algorithm for solving problem 2 *    1 .",
    "for all @xmath8 from @xmath217 to @xmath220 compute @xmath221 from @xmath203 by performing the first 5 steps of the algorithm from section [ s : alg2d ] 2 .",
    "interpolate values @xmath210 to obtain @xmath222 on a 3d cartesian grid 3 .",
    "compute @xmath27 from @xmath215 by using the 3d inverse fft .",
    "if the number of the cylinder directions is of order of @xmath19 step 1 of the above algorithm requires @xmath22 flops .",
    "the second step involves interpolation in the spectral domain from spherical grid to the cartesian grid . in our simulations we utilized cubic interpolation in the radial direction and bilinear interpolation in the angular directions",
    "; the number of operations involved in this step is @xmath223 the third , final step requires @xmath22 operations ; the whole algorithm then needs only @xmath22 flops .    in order to evaluate the performance of the present algorithm we simulated the measurements corresponding to 272 integrating line detectors rotated over 512 directions @xmath8 equispaced from @xmath217 to @xmath218 as a phantom we used a collection of characteristic functions of balls centered on the ( pair - wise ) intersections of the planes @xmath224 @xmath225 , @xmath226 , and lying within the unit sphere , as shown in figure  [ f:3dphan ] .",
    "( the orientation of the axes corresponds to vectors @xmath227 , @xmath228 and @xmath229 as illustrated in figure  1(b ) . )",
    "the cross - sections of the phantom are shown in the first row of figure  [ f : rec3dflat ] .",
    "for each direction @xmath8 , 500 time samples were simulated in the interval @xmath230 $ ] ; the rest of the signal was neglected .",
    "the image was reconstructed on a @xmath231 cartesian grid containing 125 million unknowns ( although only about a half of them lied within the unit sphere where function @xmath27 was supported ) .",
    "the cross sections of the reconstructed @xmath27 are shown in the second row of figure  [ f : rec3dflat ] .",
    "the above computation took 67 seconds on the desktop computer described in section [ s : alg2d ] .",
    "a comparison can be made with a reconstruction obtained by the time reversal using finite differences in a cubic domain with @xmath232 computational grid .",
    "on our computer it took about @xmath233 min .",
    "since such a time reversal method scales as @xmath234 , on a grid of the size @xmath235 the reconstruction would take about @xmath236 hours , or three orders of magnitude longer than the time required by the present algorithm .",
    "( such a comparison is quite crude since a different problem is solved in a different computational domain ; nevertheless it indicates that our method is indeed very fast . )",
    "the third row of figure  [ f : rec3dflat ] demonstrates images reconstructed from the data with added simulated noise with intensity 50% ( in @xmath133 norm ) of the signal .",
    "the level of noise in the reconstructed images is surprisingly low .",
    "the explanation of such stability is the same as in section [ s : alg2d ] .",
    "in this section we illustrate the work of our algorithms by processing a set of real data kindly provided to us by recendt .",
    "this set of data was measured by integrating line detectors , as shown in figure  1 and described in detail in section  [ s : linedet ] . as the test object the researchers from recendt used a piece of a human hair tied in a knot .",
    "the number of the detector directions @xmath190 in this set was @xmath237 for each direction , the linear detector was respectively placed in each of 272 equispaced positions on the surface of the ( imaginary ) cylinder .",
    "( in fact , 11 out of 272 positions at the bottom were unavailable and the corresponding data were replaced by zeros . ) for each position 10000 time samples were measured . to reduce the noise ,",
    "the signal was smoothed by a convolution with a gaussian and downsampled by a factor of 10 , so that the number of time samples on the input of the reconstruction algorithm was 1000 . moreover , to reduce strong artifacts at the beginning and at the end of each time series , the signal was set to zero there as well .",
    "the resulting set of data ( corresponding to the detectors being aligned along @xmath238 is represented by the gray - scale image shown in figure  [ f : real2d](a ) .",
    "each vertical line in this image corresponds to the time series for one detector position of a line detector ; the bottom corresponds to @xmath239    figure  [ f : real2d](b ) demonstrates the image reconstructed by applying algorithm of section  [ s : alg2d ] to the data shown in figure  [ f : real2d](a ) . as explained in section  [ s : linedet ] , the result is not the complete reconstruction , but the x - ray transform of the 3d density function @xmath27 corresponding to the hair .    in order to reconstruct @xmath27 we applied algorithm of section  [ s : linedet ] to the full set of data .",
    "the results are shown in figure  [ f : real3d ] .",
    "the three images in this figure correspond to the horizontal cross - sections of the test object at the levels a , b , and c , respectively .",
    "one can see sharp spikes in the images corresponding to the location(s ) of the hair .",
    "there are significant radial artifacts in these images , arising due to the insufficient sampling in angle @xmath8 ( i.e. insufficient number of the detector directions ) .",
    "it is known @xcite that for the inversion of the 2d radon transform the optimal number of the angular directions is of the same order of magnitude as the desired resolution of the spatial grid ( several hundred , in out case ) . unfortunately , our data set only contained data corresponding to 25 detector directions . as the reconstructions obtained in section  [ s : linedet ] from simulated data show , if the number of directions equals several hundred , the algorithm yields very accurate and detailed images .",
    "the author would like to thank recendt for providing the data of real measurements .",
    "we are grateful to drs .",
    "p.  burgholzer , h.  grn , and h.  roitner for the fruitful discussions of the data acquisition schemes with integrating line detectors , related data processing techniques and open problems in this area .",
    "the author gratefully acknowledges support by the nsf through the grant dms-090824 .",
    "m. agranovsky and p. kuchment , _ uniqueness of reconstruction and an inversion procedure for thermoacoustic and photoacoustic tomography with variable sound speed _ , inverse problems , * 23*:2089102 , 2007 .",
    "p. burgholzer , j. bauer - marschallinger , h. grn , m. haltmeier , and g. paltauf , _ temporal back - projection algorithms for photoacoustic tomography with integrating line detectors _ , inverse problems , * 23*:s65-s80 , 2007 .",
    "p. burgholzer , c. hofer , g. paltauf , m. haltmeier , o. scherzer , _",
    "thermoacoustic tomography with integrating area and line detectors _ , ieee transactions on ultrasonics , ferroelectrics , and frequency control , * 52*(9):157783 , 2005 .",
    "p. burgholzer , c. hofer , g. j. matt , g. paltauf , m. haltmeier , and o. scherzer , _ thermoacoustic tomography using a fiber - based fabry - perot interferometer as an integrating line detector _ , proc .",
    "spie 6086 , 43442 , 2006 .",
    "m. haltmeier , o. scherzer , p. burgholzer , r. nuster , and g. paltauf , _ thermoacoustic tomography and the circular radon transform : exact inversion formula _",
    ", mathematical models and methods in applied sciences , * 17*(4 ) : 63555 , 2007 .",
    "s. j. norton and m. linzer , _ ultrasonic reflectivity imaging in three dimensions : exact inverse scattering solutions for plane , cylindrical , and spherical apertures _ , ieee transactions on biomedical engineering , * 28 * : 200 - 202 , 1981 .",
    "g. paltauf , r. nuster , m. haltmeier and p. burgholzer , _ experimental evaluation of reconstruction algorithms for limited view photoacoustic tomography with line detectors _ , inverse problems , * 23 * : s81s94 , 2007 ."
  ],
  "abstract_text": [
    "<S> we propose three fast algorithms for solving the inverse problem of the thermoacoustic tomography corresponding to certain acquisition geometries . </S>",
    "<S> two of these methods are designed to process the measurements done with point - like detectors placed on a circle ( in 2d ) or a sphere ( in 3d ) surrounding the object of interest . </S>",
    "<S> the third inversion algorithm works with the data measured by the integrating line detectors arranged in a cylindrical assembly rotating around the object . </S>",
    "<S> the number of operations required by these techniques is equal to @xmath0 and @xmath1 for the 3d techniques ( assuming the reconstruction grid with @xmath2 nodes ) and to @xmath3 for the 2d problem with @xmath4 discretizetion grid . </S>",
    "<S> numerical simulations show that our methods are at least two orders of magnitude faster than the existing algorithms , without any sacrifice in accuracy or stability . </S>",
    "<S> the results of reconstructions from real measurements done by the integrating line detectors are also presented , to demonstrate the practicality of our methods .    </S>",
    "<S> [ theorem]acknowledgement [ theorem]algorithm [ theorem]problem </S>"
  ]
}