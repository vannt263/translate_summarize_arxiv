{
  "article_text": [
    "the problem of the non commutativity of the filtering operation has been considered by ghosal and moin ( 1995)@xcite , van der ven ( 1995)@xcite , fureby and tabor ( 1997)@xcite , vasilyev _ et al . _",
    "( 1998)@xcite and reviewed by ghosal ( 1999)@xcite and sagaut in his monography on large eddy simulation ( les ) for incompressible flows ( 2001)@xcite .",
    "ghosal and moin@xcite showed that the commutation error is of the second order in the filter width . introducing a filter definition built on the mapping function of the non uniform grid , they proposed a procedure that can be used whenever numerical schemes based on pseudo - spectral methods or on finite differencing of an order higher than the second order are employed . the non commutation term",
    "are expanded in a taylor series in the filter width , where the coefficients depend on the spatial derivatives of the filtered field and the mapping function . in this way",
    ", extra terms appear in the filtered equations , which increase the differential order of the equations .",
    "the authors suggested both the use of additional boundary conditions to mantain the well - posedeness of the problem or the use of asymptotic expansions of the filtered variables , in terms of the square of the filter width , which however requires the solution of additional non homogeneous perturbative problems .",
    "a family of one parameter filters commuting with differentiation up to any given order in the filter width , which is assumed nonuniform in the integration domain , was constructed by van der ven @xcite .",
    "if a discretization scheme of a given order is adopted in a les , one may select a filter inside the family so that the lack of commutation between differentiation and filtering can be neglected .",
    "a general formulation of the commutation error , due to a non uniform filter and to the presence of boundaries , has been proposed by fureby and tabor@xcite .",
    "boundary domain terms are explicitly formulated inside this representation .",
    "a detailed numerical analysis of the field distribution of the intensity of the non commutation terms is given in this paper by comparing les and direct numerical simulation ( dns ) data obtained from simulations of the incompressible turbulent channel flow at @xmath3 and @xmath4 .",
    "it has been found that the local intensity can be as high as @xmath5 of the local advection , with a field volume averaged relative intensity of about @xmath6 .",
    "lower values apply if reference is made to the sum of the local advection , pressure gradient , and molecular viscous flux terms .",
    "an interesting result is that the use of different subgrid scale models negligibly affects the local and average values of the sum of the commutation error terms . as expected , the high relative intensities of the commutation terms are concentrated in the flow regions where the gradient of @xmath0 is high .",
    "however , the question of the possible extension of the effects on the macroscopic scale of the flow is still left open .",
    "a generalization of the procedures proposed by ghosal and moin and van der ven is presented in the paper by vasilyev _ _ et al.__@xcite .",
    "a minimization of the commutation error is achieved by using a class of filters with @xmath7 vanishing moments , where @xmath8 is the order of the employed numerical discretization scheme .",
    "the authors also supply a group of rules to construct discrete filters that commutes with differentiation up to any given order inside complex domains .",
    "the method here proposed relies on an approximation of the specific non commutation term that corresponds to the different terms of the motion equations .",
    "a commutation approximation of the fourth order in the filter width can be obtained thanks to the introduction of successive levels of average .",
    "[ par.non-comm ] for the basic formulation relevant to an isotropic grid stretching and the appendix for the more general anisotropic case , which also specifies the formulation that is appropriate to wall - bounded flows .",
    "while performing large eddy simulations , the present approach can conveniently be used together with subgrid models based on analog multi - level filtering , e.g. models which apply the dynamic procedure , germano _ et al . _",
    "( 1991)@xcite , germano ( 1992)@xcite or the bardina mixed model ( 1980)@xcite .",
    "the filtering approach we use in this paper is that of the very fundamental volume average , first applied by smagorinsky in 1963@xcite .",
    "the volume average formulation is advantageous because it does not introduce an error associated to domain boundaries , thus avoiding the problem of the addition of further non commutation terms in the equations .",
    "the variable scale filtered navier - stokes equations , including the commutation terms approximation , are given in sec .",
    "[ par.non-comm-a ] .    a priori tests on the turbulent channel flow data bases by alfonsi _",
    "et al . _",
    "( 1998)@xcite and passoni _ et al . _  ( 1999)@xcite , @xmath1 , and by moser _",
    "et al . _",
    "( 1999)@xcite , @xmath9 , are presented in sec .",
    "[ par.test-a ] .",
    "an example of application of the numerical procedure is presented in sec .",
    "[ par.test-b ] , which focuses attention on the fact that this systematic error is important throughout the entire flow and not only in the regions where the non homogeneous terms of the motion equation , which originate from the lack of commutation of the operations of differentiation and filtering , are different from zero .",
    "the capacity of the present procedure to reduce the relevant absolute and relative errors is shown .    before proceeding to the other sections , it is necessary to open a digression on the terminology adopted in what follows . since , among the points being discussed in the paper , there are : the structure of the motion equation , once a variable scale filtering is used , and the role played by the terms which originate from the non commutation filter - differentiation , we have had to clearly distinguish the concept of commutation error on the flow solution from that of non commutation term in the equations . by _ commutation error _ we mean the error which affects the flow solution , when a variable scale filter is used , but the equations are used as if the operations of filtering and differentiation commute . by _",
    "non commutation term _ we mean any of the terms which originate in the equation of motion when the filter scale is a function of the point .",
    "it is necessary to recall that in previous literature the latter was called commutation error , since the equation were always used as if they were commutative and the omissiom of the terms , which should make them complete when the filter length varies , introduced the error in the solution .",
    "the loss of the commutation between the spatial filtering and the differentiation operations is related to the use of a variable filter , which in the more general configuration is anisotropic . in this case",
    "the filter width is the vector @xmath10 .    for reading convenience and",
    "as the isotropic stretching configuration is conceptually non reductive , a scalar filter scale @xmath11 is assumed in what follows .",
    "however , the general anisotropic configuration of stretching is dealt with in the appendix , which also specifies a filtering formulation that is suitable for wall - bounded flows .",
    "let us suppose we have chosen a given class of integration volumes    @xmath12    and an average operation for the variable @xmath13 :    @xmath14    where the transformation @xmath15 has been used and , as a consequence , @xmath16 .",
    "please note that , with this choice , the width of the averaging volumes is twice the filter scale .",
    "a variable filter scale is introduced by allowing @xmath0 to be a function of point , @xmath17 . in this case @xmath18 \\nonumber\\\\ & = & \\langle \\nabla f \\cdot { \\mbox{\\boldmath $ \\delta$}}_i\\rangle_{\\delta } + \\frac{\\partial \\delta}{\\partial x_i } ( { { \\bf x } } ) \\langle   \\nabla f \\cdot { \\mbox{\\boldmath",
    "$ \\xi$}}\\rangle \\label{derfilt}\\end{aligned}\\ ] ] by virtue of the fact that @xmath19\\nonumber\\\\ & = & \\frac{1}{v_1 } \\int_{v_{1 } } \\nabla f \\cdot { \\mbox{\\boldmath $ \\xi$}}d{\\mbox{\\boldmath $ \\xi$ } } , \\label{der1}\\end{aligned}\\ ] ]    recalling that @xmath20 , it results that the filter of the derivative is a differential operator acting on the filtered field :    @xmath21    the non commutation term @xmath22 , which is defined as @xmath23    can be represented through ( [ filder ] ) by the product of the filter space derivative and the filter derivative of the filtered variable : @xmath24    the here proposed method is based on an approximation of relation ( [ commuer ] ) . the problem could be faced adopting a truncated series expansion of @xmath25 in terms of powers of @xmath0 ( ghosal and moin , 1995)@xcite . however , this would increase the order of the equations , and thus require additional boundary conditions . here a numerical approximation of the @xmath0 first derivative is used in conjunction with truncated @xmath0 expansions .",
    "let us write the second order finite difference approximation    @xmath26    choosing @xmath27 @xmath28    now , the problem to face is that of the approximation of @xmath29 and @xmath30 in terms of relevant averaged quantities . using a taylor expansion of the integrating function in ( [ def - media ] ) ,",
    "we obtain the following expression for @xmath31 , in terms of @xmath32 , and the filter width : @xmath33\\delta^4 + o(\\delta^6 ) \\nonumber \\\\ & = & f({{\\bf x } } ) +   f_1[f]\\delta^2 +   f_2[f]\\delta^4 + o(\\delta^6 ) \\label{s1}\\end{aligned}\\ ] ] where coefficients @xmath34 are defined as @xmath35 and the operators @xmath36 as : @xmath37 & = &   \\frac{1}{2 } a_{1,0,0}\\nabla^2 \\cdot\\\\ \\label{of1 } f_2[\\cdot ] & = &   \\frac{1}{4 ! } \\left [ a_{2,0,0 } ( \\partial_1 ^ 4 + \\partial_2 ^ 4+\\partial_3 ^ 4 ) \\cdot + 6 a_{1,1,0 } ( \\partial_1 ^ 2\\partial_2 ^ 2\\right.\\nonumber\\\\ & & + \\left.\\partial_1 ^ 2\\partial_3 ^ 2+\\partial_2 ^ 2\\partial_3 ^ 2)\\ ; \\cdot \\;\\right ] \\label{of2}\\end{aligned}\\ ] ] from ( [ s1 ] ) it follows that @xmath38 \\delta^2 + o(\\delta^4 ) \\label{s2}\\ ] ] and then , averaging ( [ s2 ] ) on a volume of linear dimension @xmath39 , @xmath40\\delta^2\\rangle_{2\\delta } + o(\\delta^4 ) . \\label{eq.duedelta}\\ ] ]    however , from ( [ s1 ] ) it can be observed that @xmath41\\delta^2\\rangle_{2\\delta } & = & f_1[f]\\delta^2 + 4 f_1 [ f_1[f ] \\delta^2 ] \\delta^2 + ... = \\\\ & = & \\delta^2 f_1 [ f ] + o(\\delta^4)\\end{aligned}\\ ] ] so that @xmath42\\delta^2 + o(\\delta^4 ) \\label{2d}\\ ] ] when the expressions ( [ s2 ] ) for @xmath32 and ( [ 2d ] ) for @xmath43 are introduced into ( [ app - der ] ) , one obtains @xmath44    when using ( [ appder ] ) , the non commutation term @xmath45 [ see ( [ commuer ] ) ] can be approximated by @xmath46    which implies @xmath47    in order to analize the approximation error @xmath48 and give a true estimate of it , let us write : @xmath49 where @xmath50 is a reference value of the filter width which is usually associated to the portion of the domain where conditions of near homogeneity of the flow hold .",
    "function @xmath51 is a positive non dimensional function which belongs to the interval @xmath52 $ ] , in the homogeneous region of the flow @xmath53 is constant and equal to 1 .",
    "function @xmath54 varies in the inhomogeneous regions , though it keeps values that are greater than @xmath55 , which is a value that must correspond : ( i )  when the local scale invariance may be supposed  to a convenient minimum value of the filter width still inside the inertial range , and ( ii )  when the local scale invariance does not hold  to a scale of the order of the scale which characterises the local turbulence structure , as , in case of wall flows , is the scale of the quasi - streamwise vortices peculiar to the viscous sublayer ( see moin and kim , 1982@xcite , and ghosal , 1999@xcite ) .    introducing ( [ deltaphi ] ) and @xmath56 into ( [ commuer ] ) and deducing the @xmath0 derivative from expansion ( [ s1 ] ) , written up to the fourth order of accuracy",
    ", the non commutation term can be estimated @xmath57 \\delta^2 \\right.\\nonumber\\\\ & & \\left.+ 2 \\varphi^2({{\\bf x } } ) f_2[f ] \\delta^4 + o(\\delta^6 ) \\right ) \\label{commerrest }   \\end{aligned}\\ ] ] using expantion ( [ s1 ] ) twice , after having inserted ( [ deltaphi ] ) , approximation ( [ appcomm ] ) can be estimated as @xmath58 \\delta^2 + ( 4 \\varphi^2({{\\bf x}})f_2[f]\\right.\\nonumber\\\\ & & \\left.+ f_1[\\varphi^2 f_1[f]])\\delta^4+o(\\delta^6 ) \\right ) \\label{appcomm1}\\end{aligned}\\ ] ] to keep the validity of estimates ( [ commerrest ] ) and ( [ appcomm1 ] ) , care must be taken to select a function @xmath53 which , in the region of filter variation , also posseses first and second derivatives of @xmath59 .",
    "possible examples are trascendental functions such as @xmath60 .",
    "a comparison of ( [ commerrest ] ) and ( [ appcomm1 ] ) yields @xmath61    consequently , when ( [ appcomm ] ) is used , a fourth order non commutation term in ( [ filder ] ) is produced instead of the second order error , which would be obtained by totally neglecting the lack of commutation @xcite . introducing a finite difference approximation of a higher order than ( [ app - der0 ] ) , and , consequently , further levels of average , it could be possible to increase the accuracy of the approximation of the non commutation term , leading to a higher order error in ( [ fine1 ] ) .",
    "this analysis pertains to differential operators of the first order .",
    "the analysis is similar for the second order differential operators .",
    "the structure of the correction terms remains the same and to reach the fourth order of accuracy the same number of levels of average must be mantained .",
    "the approximation of the non commutation term now includes the filter of the variable spatial first derivatives .",
    "the non commutation term of the second derivatives , being defined by @xmath62 can be obtained by taking the derivative of the first derivative ( [ derfilt ] ) as @xmath63 that is , @xmath64 and can consequently be approximated using the finite difference for the @xmath0-derivatives , as performed for the non commutation term of the first derivatives .",
    "the use of the standard three - point formula for the second derivative of @xmath31 with respect to @xmath0 and of relation ( [ appder ] ) for @xmath65 [ second term on the right hand side of equation ( [ commu2 ] ) ] , yields @xmath66 \\nonumber\\\\ & & - \\frac{(\\partial_i\\delta(x))^2+\\delta(x)\\partial^2_{i}\\delta(x)}{2\\delta^2(x ) } \\left [ \\langle { \\langle f \\rangle}_{\\delta}\\rangle_{2\\delta}-{\\langle f \\rangle}_{\\delta } \\right],\\nonumber\\\\ & & \\label{appr2}\\end{aligned}\\ ] ] whose order of accuracy can be determined by again using the trasformation @xmath67 .",
    "if the expansions of the non commutation terms @xmath68 is compared with its approximantion @xmath69 , it is seen that , also in this case , the error is @xmath70 .",
    "even if the present analysis is based on the use of the volume averages , it can be observed that it remains valid in the case where a more general kind of filtering is adopted .",
    "a weight function @xmath71 , introduced in ( [ def - media ] ) , only modifies the coefficients @xmath34 [ eq . ( [ eq.coeff-a ] ) ] , which should now be defined as @xmath72 however , the non commutation term ( 6 ) and its approximation remain unchanged , provided the weight function has a compact support .",
    "it is always possible to choose @xmath11 , so that the actual integration domain of the filter lies inside the flow domain ( for instance setting a value that is lower than the distance from the wall of the first layer of grid points for the minimum of @xmath11 ) . in this way",
    ", the compactness of the support prevents the error linked to the presence of finite boundaries@xcite .",
    "it should be noted that this procedure operates in the physical space and does not rely on the use of a mapping function of the non uniform grid .",
    "centered volumes of average have been adopted [ see eq .",
    "( [ def - media ] ) ] , even though they are not strictly necessary as far as the average process is considered .",
    "however , this choice shows two advantages : ( i ) physically , when the flow is incompressible , the center of the volume of average is also the center of gravity and thus the point of application of the average momentum , ( ii ) analytically , it allows for a compact , and second order in @xmath50 , representation of the non commutations terms , which in turn are approximated by the present procedure with an accuracy of the fourth order . the choice of non centered volume of averages , which , in principle , is mathematically feasible , yields a first order in @xmath50 representation of the non commutation terms , which would also lead to a much more cumbersome analytical structure@xcite .",
    "let us consider the incompressible navier - stokes equations written in the form : @xmath73    if a filter operator is applied the system becomes @xmath74    when @xmath0 , the linear scale of filtering ( see for instance the definition proposed in sec .",
    "[ par.non-comm ] ) is not uniform in the flow domain , the averaging and differentiation operations no longer commute . by",
    "introducing the subgrid turbulent stresses @xmath75 and the non commutation terms @xmath76 , for the first and second derivatives , as discussed in sec .",
    "[ par.non-comm ] for the isotropic filter configuration and in the appendix for the general anisotropic and the wall - bounded flow configuration [ see the isotropic relations ( [ commuerdef ] ) , ( [ commuer ] ) , ( [ defin2 ] ) and ( [ commu2 ] ) ; the anisotropic relations ( [ anis - commuerdef])([anis - commuer ] ) , ( [ anis - defin2 ] ) , ( [ anis - appcomma ] ) , ( [ anis - appr2 ] ) ; the wall anisotropy relations ( [ anis - wall - bounded ] ) , ( [ anis - wall - bounded2 ] ) ) , the averaged equations are written as @xmath77 together with what has been explainded in detail in sec .  [ par.non-comm ] ( see ( [ appcomm ] ) and ( [ appr2 ] ) ) the present procedure approximates the non commutation term terms on the right hand side of ( [ clesc ] , [ mlesc ] ) with an accuracy of the fourth order",
    ". the correction terms can thus be represented by the following group of relations which are determined from the field information obtained through two successive average levels ( the second being computed over a linear scale @xmath78 ) :    @xmath79 \\label{commuerui}\\ ] ]    @xmath80 \\label{commuercon}\\ ] ]    @xmath81 \\label{commuerp}\\ ] ]    @xmath82 + \\right .",
    "\\nonumber \\\\ \\left .",
    "+ \\frac{(\\partial_j\\delta(x))^2+\\delta(x)\\partial^2_{j}\\delta(x)}{2\\delta^2(x ) } \\left [ \\langle { \\langle u_i \\rangle}_{\\delta}\\rangle_{2\\delta}-{\\langle u_i \\rangle}_{\\delta } \\right ] \\right\\ } \\nonumber\\\\ & & \\label{commuerdiff2}\\end{aligned}\\ ] ]    @xmath83 , \\label{commuersubgridstress}\\ ] ]    which must be accordingly modified in the case of anisotropy of the stretching of the computational grid , see the previous comments and the appendix [ ( [ anis - appcomma])([anis - appcommb ] ) , ( [ anis - appcommb2])([anis - wall - bounded ] ) and ( [ anis - appr2])([anis - wall - bounded2 ] ) ] .",
    "the adoption of the volume average allows the filtered variables to be fully supported inside the physical domain . as a consequence ,",
    "a peculiar property of the present procedure is that there is an absence of non commutation terms associated to a finite or semi - infinite computational domain in the filtered equations .",
    "such terms arise when the filtering operator requires the extension of the dependent variables beyond the rim of the domain [ see fureby and tabor ( 1997)@xcite ] .",
    "it can be observed that the use of the double level of average highlights the convenience of coupling this procedure to subgrid models which also employ it .",
    "these subgrid models are the mixed model , by bardina _",
    "et al . _",
    "( 1980)@xcite and , in general , all models that apply the dynamical procedure , by germano _ et al . _  ( 1991)@xcite and germano ( 1992)@xcite .",
    "the filtered equations ( [ cles ] , [ mles ] ) are invariant under galileian transformations . under transformation @xmath84 , a spatial variation of the filter scale @xmath85 , in the @xmath86 reference system ,",
    "becomes a spatio - temporal variation @xmath87 in the @xmath88 system .",
    "the temporal dependence of the filter scale yields to the presence of a non commutation term which is also associated to the non stationary term .",
    "the trasformed non commutation terms , and the relevant approximations , released by the unsteady and the convective terms , however cancel each other .",
    "furthermore , the terms obtained from the divergence of the stress tensor in a system like ( [ clesc ] , [ mlesc ] ) and the corresponding approximations ( [ commuerp ] ) - ( [ commuersubgridstress ] ) are all galileian invariants , which assures that the variable scale filtered equations and their approximations are also such .",
    "another general implication , linked to the presence of a finite domain , is that the boundary conditions for the filtered variables should be different from those for the unfiltered variables .",
    "the problem of wall boundary conditions for the filtered field could be treated with this procedure by adopting one of the classical approximated conditions , which rely on the introduction of a special subgrid model , that is , the wall model , which is apt to represent the inner layer dynamics and which puts the first grid point inside the logarithmic layer@xcite@xmath89@xcite@xmath89@xcite@xmath89@xcite .",
    "it could also be treated by placing grid points well inside the viscous sublayer to resolve the near - wall dynamics and by assuming no slip and impermeability boundary conditions .",
    "it should be recalled that the latter conditions , which in theory should not be used for filtered velocities , introduce an error of @xmath90 , independently of the filter shape .",
    "their use requires the subgrid model , which should represent the non homogeneous and anisotropic structure of the viscous and buffer layers , to be altered in the inner region .",
    "the employement of anisotropic models based on a tensorial turbulent viscosity would be opportune , see horiuti ( 1990)@xcite , carati and cabot ( 1996)@xcite , the review monography by sagaut ( 2001 , chap .",
    "5.3)@xcite and also the differential angular momentum model ( iovieno and tordella , 2002)@xcite , which , being based on the representation of the turbulent viscosity through the moment of momentum vector , is well suited to assume an anisotropic formulation .",
    "in this section a set of a priori tests is presented , which provides information on the field distribution of the non commutation terms , their relevant approximations and their ratios with respect to the physical terms from which they arise .",
    "the data correlating the approximated and exact non commutation terms have been determined by filtering the direct numerical simulation of the turbulent plane channel flow at @xmath91 , as performed by alfonsi _",
    "et al . _",
    "( 1998)@xcite and passoni _ et al . _  ( 1999)@xcite , and at @xmath9 , as performed by moser _",
    "( 1999)@xcite . the longitudinal momentum balance , which implies a zero pressure non commutation term , is considered .",
    "repetition on two different grid levels has been performed .",
    "all the data here presented have been averaged over an interval of 1.2 revolution times .",
    "+   +     figure [ fig.1 ] shows the distributions of the exact non commutation terms and of their approximation according to the present procedure , at two filtering levels . the convection term of the longitudinal momentum balance , its grid and subgrid scale decomposition and the diffusive term are shown in parts ( a ) , ( b ) and ( c ) , respectively .",
    "the filter @xmath92 , with constants @xmath93 and @xmath94 , varies along the transversal non dimensional @xmath95 direction according to @xmath96 , where @xmath97 $ ] , and @xmath98 $ ] is a function of at least class @xmath99",
    ". the variation of @xmath100 has been laterally arranged ( in 20% of the channel width along the walls ) as follows @xmath101 where @xmath102 is the parameter that controls the gradient of the filter scale at the wall .",
    "the non commutation terms on the first and second derivatives have been determined for such an anisotropic structure of the filter through the use of relations ( [ anis - wall - bounded ] ) and ( [ anis - wall - bounded2 ] ) . the data in fig .  1 ( a , c )",
    "show that the present procedure yields , on average , for the reynolds stress @xmath103 @xmath104 and for the viscous stress @xmath105 @xmath106 where @xmath107 .",
    "these figures have been obtained by neglecting the data that belong to the first 5%  near the wall , where the numerical uncertainty due to the spatial discretization is high - especially as regard the exact non commutation terms computations - and where these results deteriorate by nearly 25% .",
    "the results of the numerical test at @xmath108 as compared with those at @xmath3 , see fig .",
    "[ fig.1 ] ( a ) , show a good invariance of the procedure accuracy with respect to variations of the flow control parameter .",
    "it should be remarked , that a procedure capable to predict at worst , using the rather large value of @xmath109 , the 90% of the value of the non commutation terms may be considered accurate .",
    "in fact , the analysis of numerical errors in les of turbulence with cutoff in the inertial range ( errors due to spatial discretization : finite - differencing errors and aliasing errors ) shows that _ the resulting errors are very large , of the same order and even larger than the magnitude of the subgrid term over most of the wavenumber interval , for finite difference schemes up to eighth - order accurate , irrespective of the grid resolution _",
    "ghosal s. , 1996 , pp .",
    "201 - 202)@xcite .",
    "in such a general situation , it may be considered it a success that the procedure is capable of predicting nine - tenth of the value of the non commutation terms .",
    "the relevant average error can not spoil the overall numerical reliability of the simulations since it is about one order of magnitude lower than the errors due to the spatial discretation .",
    "a warning is necessary regarding the numerical computation of the exact values of the non commutation terms .",
    "direct computation through the definition is not recommended , as , even with the implementation of a numerical differentiation of the sixth order of accuracy , it artificially amplifies the fluctuations that are naturally present in the data field .",
    "the exact values of the non commutation terms should be correctly evaluated by using the integral representation of the derivatives @xmath110 or @xmath111 , such as ( [ der1 ] ) in sec .",
    "[ par.non-comm ] or ( [ anis - der1 ] ) in the appendix .",
    "no such numerical problems affect the computation of the approximated non commutation terms .",
    "figure [ fig.2 ] provides information on the relative importance of the exact non commutation terms with respect to the physical terms which causes them . in part",
    "( a ) the average ratio @xmath112 has been plotted for @xmath107 , @xmath113 and also with an increase of the wall value of the stretching factor @xmath114 .",
    "it can be seen , that close to the point where the reynolds stress reaches its maximum ( @xmath115 ) , and the divergence therefore takes in the average very small values , ratio values as high as @xmath116 are reached with the coarser grid . the comparison of these results with the results of fig .",
    "[ fig.1](b ) indicates that the average exact value of the convection non commutation term is of the same order than the average divergence of the subgrid stresses .",
    "furthermore , it is interesting to observe that the doubling of the stretching factor @xmath102 increases the relevance of the noncommutation terms in this region nearly as much as the doubling of the grid coarsening does , see in fig .",
    "[ fig.2](a ) the near wall region where @xmath117 . figure [ fig.2](a ) also shows a positive comparison of the field integral value of @xmath118 given by fureby and tabor@xcite with the distribution of the same ratio that has been yielded by the database used here.@xcite@xmath119@xcite    with respect to the average ratio @xmath120 , fig .",
    "[ fig.2](b ) yields maxima local values of about 100% for the coarser resolution , and about 60% for the finer one , close to where the relevant non commutation terms reach their local maxima near to the wall . leaving aside local maximum values detached from the wall and relevant to the coarser resolution , this ratio , in the central part of the field ,",
    "settles to constant lower values close to @xmath121 .      ,",
    "( b ) : diffusion .",
    "adimensionalization by means of channel semi - width and @xmath122.,title=\"fig : \" ] + , ( b ) : diffusion . adimensionalization by means of channel semi - width and @xmath122.,title=\"fig : \" ]    as seen in sec .",
    "[ par.non-comm-a ] , there are four type of non commutation terms in the variable scale filtered incompressible navier - stokes equations ( [ clesc ] ) , ( [ mlesc ] ) , which are all source terms . if one limits the analysis of their influence on the flow solution to the determination of the field distribution of the values they take with regards to the values taken by the original terms of the equations , one would mainly find the foreseen result that the non commutation terms are not negligible where the gradient of the filter scale is high .",
    "this is however not sufficient to understand the way , localized rather than extended , in which the commutation error affects the flow solution .    for this purpose ,",
    "it has here been considered useful to study the behaviour of an extremely simple flow model , a sort of conceptual model , which has two characteristics :  just one type of commutation source term is present , ",
    "its exact filtered solution , that is , the variable scale filtered solution not affected by the commutation error , is known and thus could be used as the reference solution .",
    "the second characteristics can only be obtained by filtering the exact solution of the unfiltered equation of the motion .    on the other hand , to prove the efficiency of any given procedure for the correction of the commutation error , it is also necessary to know the exact filtered solution of a test flow , which , in turn , requires the knowledge of the exact flow unfiltered solution .",
    "such a reference state can not be found in a turbulent configuration of flow , for which no exact solution is available .",
    "reference is therefore made to a laminar flow , which has an exact solution .",
    "one should note that , in such a case , the filtered equation of the motion , when the filter length is a function of the point but the commutation error correction is not considered , is identical to the unfiltered equation .",
    "the steady laminar incompressible channel flow has been selected as the test flow , since it has only one commutation term , the diffusion one , see ( [ commuerdiff2 ] ) , and its solution is analytically known .",
    "the non dimensional momentum equation for the steady incompressible channel flow is written as @xmath123    , @xmath124 , see ( [ phi2 ] ) , iii b ) ; ( * - - - - * ) local values of the commutation term @xmath69 , see ( [ cfce ] ) , referring to the diffusion term ; ( *  -  * ) @xmath125 , relative commutation error for the solution of the filtered non corrected equation ( @xmath126 ) normalized with respect to the field peak value , @xmath127 $ ] . ]",
    "( *  * ) and relative @xmath127 $ ] ( * - - - - * ) error distributions of the filtered velocity distributions : * a *  without the commutation correction ,",
    "* b *  with the commutation correction . curve ( *  -  * ) : error recovery @xmath128 with the distance from the wall .",
    "the exact filtered velocity reference distribution is @xmath129 $ ] . ]    where @xmath130 is the modulus of the dimensional longitudinal pressure gradient and the adimensionalization is based on the channel width @xmath131 , the gradient @xmath130 and the density @xmath132 ( the non dimensional pressure gradient @xmath133 results equal to @xmath134 ) .",
    "the boundary conditions are @xmath135 the corresponding filtered equation is @xmath136 where @xmath137 is set to zero to determine the solution which neglects the commutation error and where @xmath138 is approximated by @xmath139\\nonumber\\\\ & & - \\frac{\\delta'(y)^2+\\delta(y)\\delta''(y)}{2\\delta^2(y ) } \\left [ \\langle { \\langle u \\rangle}_{\\delta}\\rangle_{2\\delta}-{\\langle u \\rangle}_{\\delta } \\right ] \\label{cfce}\\end{aligned}\\ ] ] to determine the solution which accounts for the commutation error with the present procedure",
    ". the numerical solution of equation ( [ fce ] ) is determined by solving the corresponding unsteady filtered equation @xmath140 through a fourth order runge - kutta time integration scheme  carried out until the steady state is reached ",
    "coupled to a fourth order finite - difference discretization of the domain .",
    "the double level of average has been computed using a third order hermitian quadrature formula .",
    "the filter of the exact solution gives the velocity distribution @xmath141}$ ] , which constitutes the reference on which the constrast between the commutation corrected filtered solution and the non corrected filtered solution is based .",
    "the filter scale varies along the transversal direction according to @xmath142 , where @xmath97 $ ] , with @xmath143 , is a function of at least class @xmath99 .",
    "the variation of @xmath100 @xmath144 has been laterally arranged in 20% of the channel width along the wall , setting the parameter @xmath145 , see fig .",
    "[ fig.3 ] .    by contrasting the filtered exact solution ,",
    "the absolute and relative errors relevant to the corrected and non corrected solutions are compared in fig .",
    "[ fig.4 ] . the corresponding error recovery , with the wall distance , is also shown in figs .  [ fig.2 ] and [ fig.3 ] .",
    "it can be seen that the present procedure greatly reduces the commutation errors : in the central part of the flow , an almost full recovery is obtained .    for a comparison of the distributions of the local value of the non commutation term and of the relative commutation error on the solution , see again fig .",
    "[ fig.3 ] .",
    "it is important to observe that , by neglecting the commutation correction , the field results to be affected by a systematic error not only in the region where the filter length varies , but also in the region where it is constant .",
    "this behaviour is due to the accumulation of errors on the velocity variable and its derivative , which is due to the lack of the two diffusion addenda ( see ( [ fce ] ) , ( [ cfce ] ) ) that should enter the momentum balance equation .",
    "even through these terms are significantly different from zero in a limited portion of the flow they affect the entire field to a great extent . in the central part of the flow , where the non commutation term is very small ( fig .",
    "[ fig.3 ] ) , the relative commutation error results to be of the same order as the peak value of the field , while the absolute error reaches its maximum value ( see again fig .",
    "[ fig.4 ] ) .",
    "a procedure to explicitly insert the correction terms in order to counteract the commutation error associated to the use of a variable filter scale in the filtered equations of motion is here presented . with this procedure",
    "it is possible to directly compensate for the commutation error on the filtered field .",
    "the procedure uses volume average filtering , but more general filter operators are also possible .",
    "both isotropic and fully anisotropic filtering configurations are considered .",
    "approximated commutation terms , with an accuracy of the fourth order in the filter width , are inserted into the motion equations , which do not increase their differential order .",
    "the difficulties related to the addition of further boundary conditions are therefore avoided .",
    "the proposed representation of the commutator operators is based on truncated expansions in the filter width of finite difference approximations , that make use of a multilevel average operation .",
    "this fact suggests the joint use of the present procedure with subgrid models which need an explicit filtering of the equations of motion , such as dynamic and mixed models .",
    "a set of a priori tests , with a plane channel flow dns ( @xmath91 ) as a test field , proves the good correlation that the present procedure yields between the approximate and `` exact '' non commutation terms .",
    "it also provide information on the relative importance of these terms with respect to the original physical terms .",
    "the influence of the field resolution on the general non commutation term is confirmed to be @xmath90 .",
    "asymptotically , the accuracy of the present approximation is expected to be @xmath70 . at the resolution levels corresponding to @xmath91 ,",
    "these tests show a reduction of the absolute errors , after halfing the reference filter scale , that is nearly @xmath146 .",
    "the filtering is a mathematical operation , that is not specific of the navier - stokes equations and is independent of the solution typology .",
    "when it is varied , the filter causes one kind of non commutation term for each differential term present in the equations of the motion .",
    "a test , for which the analytically exact ( unfiltered and as a consequence filtered ) solution is available , has been considered to overcome the limitation of an analysis , based on the _ a posteriori _ determination of the relative order of magnitude of the non commutation terms , with regard to the original physical terms of the motion equations , and to analyze the effects of the commutation error on a flow solution .",
    "the chosen test flow is the two dimensional incompressible laminar channel flow , whose dynamics consist of the balance between the constant longitudinal pressure force and the viscous diffusion . in this case , only one type of commutation source term  diffusion  is present , and this is only of relative importance in the lateral part of the flow , according to the filter gradient dependence .",
    "the error , due to the lack of a non commutation term in the motion equation , is however also transferred to the central part of the flow .",
    "the result is a biased filtered velocity distribution where the relative error in the central part of the flow , where the filter gradient is zero , is of the same order of magnitude as the local maximum error of the field , which is situated at a distance from the wall of about @xmath147 of the channel width .",
    "it has been shown that the present procedure can reduce the commutation error by one order of magnitude in the central part of the field .",
    "the authors would like to thank professor g.passoni for helpful discussions and for making the turbulent channel flow database available .",
    "when the geometry of the flow domain requires stretching each direction independently , which implies @xmath10 , it is opportune to adopt a class of integration volumes of the kind + @xmath148      in such a situation , by virtue of the fact that @xmath155 \\nonumber\\\\ & = & \\sum_{j=1}^{3 }   \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\frac{\\partial f}{\\partial x_j}(x_j + \\delta_j({{\\bf x } } ) \\xi_j ) \\times \\nonumber\\\\ & & \\times \\frac{\\partial } { \\partial \\delta_k}(x_j + \\delta_j ( { { \\bf x } } ) \\xi_j ) d { \\mbox{\\boldmath $ \\xi$}}\\nonumber\\\\ & = &   \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } }   \\xi_k \\frac{\\partial f}{\\partial x_k } d{\\mbox{\\boldmath $ \\xi$ } } , \\label{anis - der1}\\end{aligned}\\ ] ] it is obtained    @xmath156 = \\sum_{j=1}^{3 }   \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\frac{\\partial f}{\\partial x_j}(x_j + \\delta_j({{\\bf x } } ) \\xi_j ) \\frac{\\partial } { \\partial x_i}(x_j + \\delta_j ( { { \\bf x } } ) \\xi_j ) d { \\mbox{\\boldmath $ \\xi$}}\\\\ & = & \\sum_{j=1}^{3 }   \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } } [ \\delta^{\\rm k}_{ji }   \\frac{\\partial f}{\\partial x_j } + \\frac{\\partial \\delta_j}{\\partial x_i } \\xi_j \\frac{\\partial f}{\\partial x_j } ] d { \\mbox{\\boldmath $ \\xi$}}= \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } }   \\frac{\\partial f}{\\partial x_i } d { \\mbox{\\boldmath $ \\xi$}}+   \\sum_{j=1}^{3 } \\frac{\\partial \\delta_j}{\\partial x_i } \\frac{1}{v_{{\\mbox{\\boldmath $ 1 $ } } } } \\int_{v_{{\\mbox{\\boldmath $ 1 $ } } } }   \\frac{\\partial f}{\\partial x_j } \\xi_j d { \\mbox{\\boldmath $ \\xi$}}= \\langle   \\frac{\\partial f}{\\partial x_i}\\rangle_{{\\mbox{\\boldmath $ \\delta$ } } } + \\sum_{j=1}^{3 } \\frac{\\partial \\delta_j}{\\partial x_i }",
    "\\frac { \\partial \\langle    f   \\rangle_{{\\mbox{\\boldmath $ \\delta$}}}}{\\partial \\delta_j } ,    \\label{anis - derfilt}\\end{aligned}\\ ] ]    where @xmath157 is the kronecker unit tensor . as in sec .",
    "[ par.non-comm ] [ see relation ( [ filder ] ) ] for the isotropic configuration , it results that the anisotropic filter of the derivative is a differential operator that acts on the filtered field : @xmath158        proceeding in strict analogy with what has been done in sec .",
    "[ par.non-comm ] , the anisotropic non commutation term can be approximated through second order centered finite differences : @xmath161 again , using a taylor expansion of the integrating function in ( [ def - media - anis ] ) , where only even derivatives appear since the domain of integration ( [ anis - vol - int ] ) is symmetric with respect to all the integration variables , expressions are obtained for quantities such as @xmath162 and @xmath163 , in terms of @xmath32 , and the filter width  which is now defined as @xmath164 , where @xmath50 is a reference value for @xmath165 and @xmath166 : @xmath167 where @xmath168 and @xmath169 since from ( [ anis - s1 ] ) @xmath170 .",
    "the basic approximation for the anisotropic non commutation term @xmath45 is derived through these expansions as @xmath171 while the accuracy of the anisotropic first derivative commutation error and its approximation can be verified to be @xmath172 by filtering only in the @xmath173 direction , expansion ( [ anis - s1 ] ) becomes @xmath174 which implies @xmath175 and , though keeping the same order of accuracy , the equivalent representation for both relations ( [ anis - appcomma ] , [ anis - appcommb ] ) becomes @xmath176 for flow fields where the domain grid needs to be stretched along only one direction , say @xmath95 and whose typical examples are two dimensional wall - bounded flows , the last representation yields very simple approximation formulae . by adopting the widely used notation @xmath92 in such a case with constants @xmath93 and @xmath94 , the anisotropic approximation for the first derivative non commutation term results to be @xmath177 the anisotropic non commutation term of the second derivatives , being defined by @xmath178 can be obtained as in sec .",
    "[ par.non-comm ] [ see ( [ defin2])([commu2 ] ) ] @xmath179 before deriving the approximated form for ( [ anis - commu2 ] ) , while wishing to mantain its fourth order of accuracy , it is useful to observe that the terms on the r.h.s . which contain @xmath180 , @xmath181 , by ( [ anis - s1 ] ) , are of the same order as the remainder term .",
    "therefore , they do not enter the approximation , which is @xmath182 \\nonumber\\\\    & - &   \\sum_{j=1}^{3 } \\frac{\\partial_i\\delta_j}{\\delta_j } \\left [ \\langle \\partial_i{\\langle f \\rangle}_{{\\mbox{\\boldmath $ \\delta$}}}\\rangle_{\\displaystyle 2\\delta_j { { \\bf e}}_j}-\\partial_i{\\langle f \\rangle}_{{\\mbox{\\boldmath $ \\delta$ } } } \\right ] \\label{anis - appr2}\\end{aligned}\\ ] ] again , in analogy with what has been done for the first derivatives , eq .",
    "( [ anis - wall - bounded ] ) , the following is obtained @xmath183 \\nonumber\\\\    & - &    \\frac{\\partial_y\\varphi}{\\varphi(y ) } \\left [ \\langle \\partial_y{\\langle f",
    "\\rangle}_{{\\mbox{\\boldmath $ \\delta$}}}\\rangle_{\\displaystyle 2\\varphi(y ) \\delta y}-\\partial_y{\\langle f \\rangle}_{{\\mbox{\\boldmath $ \\delta$ } } } \\right ] \\label{anis - wall - bounded2}\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> a simple procedure to approximate the noncommutation terms that arise whenever it is necessary to use a variable scale filtering of the motion equations and to compensate directly the flow solutions from the commutation error is here presented . </S>",
    "<S> such a situation usually concerns large eddy simulation of nonhomogeneous turbulent flows . </S>",
    "<S> the noncommutation of the average and differentiation operations leads to nonhomogeneous terms in the motion equations , that act as source terms of intensity which depend on the gradient of the filter scale @xmath0 and which , if neglected , induce a systematic error throughout the solution . here </S>",
    "<S> the different noncommutation terms of the motion equation are determined as functions of the @xmath0 gradient and of the @xmath0 derivatives of the filtered variables . </S>",
    "<S> it is shown here that approximated noncommutation terms of the fourth order of accuracy , with respect to the filtering scale , can be obtained using series expansions in the filter width of approximations based on finite differences and introducing successive levels of filtering , which makes it suitable to use in conjunction with dynamic or mixed subgrid models . </S>",
    "<S> the procedure operates in a way which is independent of the type of filter in use and without increasing the differential order of the equations , which , on the contrary , would require additional boundary conditions . </S>",
    "<S> it is not necessary to introduce a mapping function of the nonuniform grid in the physical domain into a uniform grid in an infinite domain . _ a priori _ tests on the turbulent channel flow ( @xmath1 and @xmath2 ) </S>",
    "<S> highlight the approximation capability of the present procedure . </S>",
    "<S> a numerical example is given , which draws attention to the nonlocal effects on the solution due to the lack of noncommutation terms in the motion equation and to the efficiency of the present procedure in reducing the commutation error on the solution . </S>"
  ]
}