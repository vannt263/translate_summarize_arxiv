{
  "article_text": [
    "the ability to store a quantum state over long times is a desirable feature in many quantum information protocols . in the optical domain ,",
    "quantum memories ( qm ) are necessary to implement the quantum repeaters needed for future long - distance quantum networks , and are the object of active research  @xcite .",
    "quantum memories at microwave frequencies have also become of great interest in recent years because of the development of superconducting qubits which have their resonance frequency in the ghz range , in the perspective of implementing holographic quantum computing  @xcite . for such schemes ,",
    "the memory should act as an ideal multi - qubit register , able to store over long times the state of large numbers of qubits and to retrieve them on - demand .",
    "spin ensembles have emerged as promising candidates for a multi - mode microwave quantum memory because of their long coherence time  @xcite and of the multiple collective modes that a spin ensemble withstands .",
    "existing proposals  @xcite ( inspired by optical quantum memory protocols  @xcite ) proceed in two distinct steps .",
    "first , the microwave field prepared in a well - defined quantum state @xmath1 ( for instance by a superconducting qubit ) is absorbed by the spin ensemble .",
    "this generates a transverse magnetisation which decays rapidly in a time @xmath2 due to the spread of resonance frequencies in the ensemble .",
    "given the weakness of the coupling constant of a single spin to the microwave field , efficient absorption requires embedding the ensemble in a high - quality factor microwave resonator in order to reach the so - called high - cooperativity regime  @xcite .",
    "the second step of the memory operation consists in retrieving the initial state , by a series of operations after which the spins emit a microwave pulse in a quantum state as close as possible to @xmath1 . in  @xcite , this is achieved by a hahn - echo - like sequence consisting of two consecutive @xmath3 pulses on the spins , combined with dynamical tuning of the resonator frequency and quality factor .",
    "the maximum storage time of the memory is approximately the hahn - echo decay time @xmath4 , so that the maximal number of stored quantum states is of order @xmath5 , a figure which can be very large in many spin systems .",
    "the first step of this protocol ( quantum state transfer ) has been demonstrated at the single - photon level in recent experiments  @xcite ; the remaining obstacle to a microwave quantum memory is therefore the implementation of hahn - echo refocusing sequences at the quantum level in a hybrid quantum circuit .",
    "the object of this work is precisely to identify the challenges posed by this task and to demonstrate experimentally that they can be solved . for simplicity ,",
    "we consider from now on a protocol simpler than the full qm  @xcite but which constitutes an essential building block : the two - pulse echo ( 2pe ) . as depicted in fig .",
    "[ fig1]a , the 2pe consists in storing weak pulses @xmath6 into the spin ensemble at times @xmath7 , and applying a single refocusing pulse at time @xmath8 which triggers the emission of echo pulses @xmath9 at times @xmath10 ( therefore in reverse order ) in the detection waveguide  @xcite .    performing the 2pe at the quantum level imposes a number of requirements which represent experimental challenges . for quantum states to be well defined ,",
    "thermal excitations should be absent from the system .",
    "this implies both that the spin ensemble has a high degree of polarisation and that the microwave field is in its ground state with high probability , which can only be achieved if the experiments are performed at millikelvin temperatures . at these temperatures",
    "however , spins tend to relax very slowly towards their ground state , and an active spin reset is therefore needed in order to repeat the experimental sequence at a reasonable rate ( @xmath11hz ) as requested by experiments at the single photon level",
    ". then , applying refocusing pulses to the spins requires large microwave powers potentially incompatible with the detection of quantum fields .",
    "finally , the echo emitted by the spins should faithfully restore the initial field , which implies that the echo recovery efficiency @xmath12 , that we define as the ratio of the energy radiated during the echo to the energy of the incoming pulse , should be close to @xmath13 .",
    "to summarise , reaching the quantum regime requires a mean excitation per mode ( both microwave and spin ) @xmath14 , input microwave fields with intra - cavity photon number @xmath15 , and an echo efficiency @xmath12 close to @xmath13 .",
    "are stored in the spin ensemble .",
    "a refocusing pulse @xmath16 acts as time - reversal for the spins and triggers the retrieval of the stored pulses as echoes @xmath9 in reverse order .",
    "top and bottom time lines show the applied , and the reflected and echo signals , respectively .",
    "( b ) setup placed in a dilution refrigerator : the cavity is a lumped - element parallel lc resonator in niobium coupled to a coplanar waveguide by a capacitor @xmath17 .",
    "it consists of an interdigitated capacitor @xmath18 and a meander wire inductor @xmath19 creating the ac magnetic field shown in inset , for a @xmath20 incident microwave power at resonance .",
    "the spin ensemble consists of nv centres in a diamond monocrystal pressed on top of the inductor .",
    "laser pulses can be shone on it through an optical fibre glued to its top face .",
    "a tunable dc magnetic field @xmath21 is applied parallel to the @xmath22 $ ] direction of the crystal .",
    "( c ) negatively - charged nv centres in diamond consist of a nitrogen atom next to a vacancy of the diamond lattice , having trapped an electron .",
    "their electronic spin @xmath23 is coupled by hyperfine interaction to the nitrogen nuclear spin @xmath24 ( for the @xmath25 isotope ) .",
    "half of the electronic spins ( sub - ensemble denoted n - orth in blue ) make an angle @xmath26 with @xmath21 , whereas the other half ( sub - ensemble orth in red ) is orthogonal to the field .",
    "( d ) nv simplified energy diagram ( top ) showing the ground @xmath27 and the excited @xmath28 electronic states as well as the zeeman and hyperfine structure of @xmath27 , with @xmath29ghz the zero - field splitting .",
    "( bottom ) magnetic field dependence of the allowed transitions for both n - orth ( blue ) and orth ( red ) sub - ensembles , showing respectively a linear and quadratic zeeman effect .",
    "nvs can be optically repumped in their @xmath30 ground state by application of green ( @xmath31 nm ) laser pulses exciting the @xmath27 - @xmath28 transition.,width=377 ]    these stringent requirements have never been met in an experiment , by far .",
    "the multi - mode character of the 2pe has been recently benchmarked in the classical regime  @xcite with an ensemble of phosphorus donors in silicon at @xmath32k in the three - dimensional microwave cavity of an electron paramagnetic resonance spectrometer .",
    "that experiment reached @xmath33 , @xmath34 , and an echo recovery efficiency @xmath35 .",
    "here we use negatively - charged nitrogen - vacancy ( nv ) centres in diamond , which are colour centres consisting of a substitutional nitrogen atom sitting next to a vacancy of the lattice ( see fig .  [ fig1]c ) with properties suitable for a quantum memory : their spin triplet ( @xmath23 ) electronic ground state has a long coherence time  @xcite and can be optically repumped in the spin ground state @xmath36 ( see figs .  [ fig1]c and d ) .",
    "we re - visit the 2pe protocol with an ensemble of nv centres at @xmath37mk coupled to a planar superconducting resonator , in a setup compatible with hybrid quantum circuits , with active reset of the spin at the beginning of each experimental sequence , and we demonstrate the storage of multiple pulses at the picowatt level for @xmath38 , three orders of magnitude longer than in earlier experiments  @xcite .",
    "our experiment reaches @xmath39 , @xmath40 , @xmath41 , and @xmath42 , and comes therefore closer to the quantum regime than previous work by several orders of magnitude .",
    "we quantitatively identify the present limitations and show that they can be solved in future experiments , opening the way to the implementation of quantum memory protocols .",
    "the experimental setup is sketched in fig .",
    "[ fig1]b ( see also suppl .",
    "a diamond crystal homogeneously doped with nv centres ( @xmath43\\approx 2$]ppm ) is glued on top of the inductance of a planar superconducting lc resonator cooled in a dilution refrigerator . for optical pumping , @xmath31 nm laser light is injected through a single - mode optical fibre , glued on top of the crystal , @xmath44 mm above the resonator inductance .",
    "a magnetic field @xmath45 is applied parallel to the chip along the @xmath22 $ ] crystalline axis ( see fig .",
    "[ fig1]c ) .",
    "nv centres in their ground state are described  @xcite by the hamiltonian @xmath46 $ ] , with @xmath47 ( resp .",
    "@xmath48 ) the spin operator of the @xmath23 nv electronic spin ( resp .",
    "the @xmath24 nitrogen nuclear spin ) , @xmath29ghz the zero - field splitting between states @xmath30 and @xmath49 , @xmath50mhz the hyperfine coupling , and @xmath51mhz the nuclear quadrupole momentum  @xcite . local electric field and",
    "strain couple with strength @xmath12 the spin eigenstates @xmath52  @xcite .",
    "the energy eigenstates @xmath53 , shown in fig .",
    "[ fig1]d , are thus linear combinations of states @xmath52 ; in particular , at zero magnetic field , states @xmath54 are separated in energy by @xmath55 . in the experiment",
    "we use transitions between the spin ground state @xmath36 and the two excited states @xmath53 at frequencies close to the zero - field splitting .     showing the resonator resonance at @xmath56ghz with quality factor @xmath57 , when the spins are saturated and do not contribute to the signal .",
    "( b ) measured reflection coefficient modulus @xmath58 around the centre of the resonator line , showing the absorption by the spins for different magnetic fieds . top line ( 6 mt , black ) corresponds to all spins ( orth . and",
    "n - orth ) being far detuned and shows no absorption .",
    "other lines show several absorption peaks moving with magnetic field ( sub - ensemble n - orth ) or not ( sub - ensemble orth ) .",
    "( c ) optical reset of the nv centre spins .",
    "the spins are first saturated by a @xmath59 long microwave pulse with frequency @xmath60 and applied power @xmath61dbm ; they are then optically repumped to their ground state with a laser pulse of power @xmath62 and duration @xmath63 ; after letting the system cool down during @xmath64 , the reflected amplitude of an applied weak ( @xmath65dbm ) @xmath66ms long measurement pulse at @xmath67ghz is measured .",
    "( d ) reflected amplitude for @xmath68mw and different @xmath63 .",
    "the curves show the hyperfine split @xmath30 to @xmath69 spectroscopic transitions of the n - orth sub - ensemble , with an amplitude that increases with @xmath63 because of increasing spin re - polarisation .",
    "( e ) corresponding imaginary part @xmath70 of the spin susceptibility .",
    "in addition , the dashed and dash - dotted lines show respectively @xmath70 measured at thermal equilibrium ( @xmath71mk , no saturating nor optical pulse ) and calculated ( see supplementary methods and supplementary figs.@xmath72 and @xmath73 ) and rescaled by a global factor to match the experiment at @xmath74s.,width=377 ]    the resonator is capacitively coupled to measurement lines through which microwave signals are applied , the amplitude and phase of the reflected field being detected by homodyne demodulation after amplification at @xmath75k .",
    "the reflection coefficient @xmath76 , shown in figs .",
    "[ fig2]a and b , yields the resonator frequency @xmath77ghz and quality factor @xmath57 .",
    "such a low @xmath78 was chosen to avoid spin relaxation by superradiant spontaneous emission after excitation by the refocusing pulse  @xcite .",
    "dips in @xmath58 are due to absorption by the nvs , as evidenced by their dependence on @xmath21 .",
    "to demonstrate optical repumping of the nvs in @xmath36 , we probe the spin polarisation after a laser pulse of power @xmath79 and duration @xmath63 , by measuring the absorption of a microwave pulse at @xmath80ghz .",
    "in addition to repumping the spins , the laser generates quasiparticles in the superconductor and carriers in the silicon substrate .",
    "we thus introduce a delay of @xmath64 between the two pulses for these excitations to relax . in order to start from a reproducible spin polarisation ,",
    "a strong microwave pulse is applied before the laser pulse , which saturates all the spins at the beginning of each sequence ( see fig .  [",
    "fig2]c ) .     for @xmath81mw , and on @xmath79 for @xmath82s .",
    "the experimental sequence is shown in fig .",
    "( c ) nv spin relaxation time measurement .",
    "a series of @xmath83ms weak microwave pulses ( @xmath84dbm ) at @xmath67ghz , separated by @xmath85s , is applied following optical reset of the spins .",
    "blue dots are the average reflected amplitude of each pulse",
    ". a bi - exponential fit ( red solid line ) yields @xmath86s and @xmath87s.,width=325 ]    the results are shown in fig .  [ fig2]d for @xmath68mw . without laser pulse , the reflected pulse amplitude is independent of @xmath21 , proving that the spins are efficiently saturated by the initial microwave pulse . for non - zero @xmath63 ,",
    "absorption peaks with the triplet shape characteristic of the nv hyperfine structure are observed , indicating sizeable nv polarisation . to quantify the effect ,",
    "we convert the absorption signal into the imaginary part of the spin susceptibility @xmath88 ( see fig .  [ fig2]e and supplementary information ) , which yields the relative spin polarisation @xmath89 , with @xmath90 the maximum repumping time . the polarisation increases with @xmath63 and then saturates ( see figs .  [ fig2b]a and b ) , which shows that the spins reach the maximum polarisation allowed by optical pumping at @xmath31 nm , close to @xmath91 according to earlier work  @xcite . the refrigerator cold stage was heated up to @xmath37mk due to laser power ; all the following results were obtained under these conditions .",
    "better alignment of the fibre with the resonator should reduce the power needed by two orders of magnitude .    using the optical pumping",
    ", we measure the energy relaxation of the spins . in that goal",
    "the spins are first repumped , after which a series of a @xmath66ms resonant probe microwave pulse separated by @xmath32s are applied .",
    "the average reflected amplitude of each pulse is plotted in fig .",
    "[ fig2b]c and shows a bi - exponential response with time constants @xmath86s and @xmath87s , similar to recent measurements  @xcite .",
    "these very long values confirm the need of actively resetting the spins for operating a qm .",
    "as a first step towards the application of refocusing pulses to the spins , we measure their time - domain response to microwave pulses of varying power .",
    "the experiments are performed at @xmath92mt . the zero - field spin susceptibility @xmath93 ( see fig .  [",
    "fig3]a ) shows two broad peaks corresponding to the @xmath94 and @xmath95 transitions .",
    "the width of these peaks is governed by the inhomogeneity of local electric fields and strain acting on the nvs , which results in a broad distribution of @xmath12 , causing the hyperfine structure to be barely resolved as seen in fig .",
    "[ fig3]a . on the @xmath95 transition ,",
    "the spin absorption reaches a maximum at @xmath96ghz , that we will thus use as the frequency of all microwave pulses in the following .",
    "square microwave pulses of varying input power @xmath97 are sent to the sample , and their reflected amplitude @xmath98 is measured .",
    "the data are shown in fig .",
    "[ fig3]b and c , rescaled by @xmath99 , and compared to the reflected amplitude of the same microwave pulse with the spins initially saturated by a strong pulse . at low power ( the linear regime ) , after an initial transient where resonator and spins exchange energy , @xmath98 reaches half of the saturated value in steady state , indicating that the spins absorb @xmath100 of the incoming power .",
    "the steady - state value of @xmath98 increases with incoming power , indicating reduced spin absorption caused by progressive saturation of the ensemble .",
    "note that no clear rabi oscillations are observed .",
    "this is due to the spatial inhomogeneity of the microwave field generated by the planar resonator ( see fig .  [",
    "fig1]b ) , which causes a spread of rabi frequency within the ensemble ; in particular , this prevents the application of precise @xmath3 pulses to all the spins  @xcite , which is an issue for hahn echo sequences .     of the spin susceptibility at @xmath92mt . the calculated curve ( see suppl .",
    "methods ) was rescaled by a global factor to match the experiment .",
    "( b ) reflected field amplitude @xmath98 for a square input microwave pulse of power @xmath97 .",
    "solid lines are experimental data with @xmath101 , @xmath102 , @xmath103 , and @xmath104dbm ( blue , green , yellow , and red ) ; dashed lines are simulations .",
    "the black curve is obtained when spins have been saturated by an initial strong pulse .",
    "the curves have been rescaled by @xmath105 for easier comparison , with @xmath106dbm .",
    "( c ) in - phase ( blue ) and out - of - phase ( green ) quadrature of the reflected field for @xmath101dbm .",
    "( d ) spin - echo sequence .",
    "an incoming microwave pulse @xmath107 with power @xmath102dbm is followed by a delay @xmath8 and a @xmath108 long refocusing pulse ( @xmath16 ) with power @xmath109dbm , yielding an echo _ e _ at time @xmath110 .",
    "saturation of the amplifiers ( shown in red ) limits the measurable amplitude to about @xmath111v .",
    "( e ) experimental ( crosses ) and simulated and rescaled ( open circles ) area of the echo as a function of the refocusing pulse power @xmath112 .",
    "( f ) measured ( crosses ) decay of the echo maximum amplitude as a function of @xmath8 . dashed and solid lines are an exponential fit yielding a characteristic time @xmath113 and a bi - exponential fit @xmath114 yielding @xmath115 and @xmath116 , respectively.,width=415 ]    in order to understand in detail the spin dynamics",
    ", we compare the experimental data to the result of numerical simulations .",
    "these simulations consist of a number of mean value equations along the lines of  @xcite and explained in further detail in the supplementary information .",
    "in particular , the inhomogeneity in both spin frequency and coupling strength is taken into account by dividing the ensemble into a sufficiently large set of homogeneous sub - ensembles and integrating the equations of motion for the resonator field and the spin components of all the sub - ensembles .",
    "the distribution of spin frequencies follows from the spin susceptibility shown in fig .",
    "[ fig4]a , and the distribution of coupling strengths depend on the resonator - field vacuum fluctuations , whose spatial distribution is calculated using the comsol simulation package and exemplified in the inset of fig .",
    "the actual distributions used are shown in supplementary fig.s5 .",
    "the simulations employed assume an ensemble of spin-1/2 particles , which is an approximation in the case of nv centres having a spin of 1 . however , in the linear , non - saturated regime this description is exact , and for the non - linear , saturated regime we expect the approximation to be justified since the applied pi pulse has a narrow frequency bandwidth and is tuned predominantly to the @xmath95 transition of the nv centres . in fig .  [ fig3]b and c the measured and calculated reflected field",
    "are compared and show a convincing agreement , without any adjustable parameter .",
    "this confirms the validity of the calculations , both in the linear and non - linear regime , and proves in particular that the frequency distribution used is correct .",
    "despite the impossibility to apply well - defined @xmath3 pulses to the spins , we implement a spin - echo sequence with an initial microwave pulse creating a transverse magnetisation , followed after @xmath8 by a refocusing pulse .",
    "its power @xmath117dbm is chosen such that spin saturation is reached within the pulse duration , as requested for spin - echo . the reflected signal amplitude is shown in fig .",
    "[ fig3]d , with the expected spin - echo observed at @xmath110 .",
    "we have studied the amplitude of this echo as a function of @xmath112 , and compared this curve to the result of the simulations .",
    "the agreement is quantitative , as shown in fig .",
    "[ fig3]e ; in particular the power at which the echo amplitude saturates is well predicted by the simulations .",
    "this brings further evidence of the validity of calculated coupling strengths and of the spin-1/2 approximation .",
    "the dependence of the echo amplitude on @xmath8 is fitted by a bi - exponential function @xmath118 , with two different coherence times @xmath119 and @xmath120 , and @xmath121 and @xmath122 ( see fig .  [ fig3]f ) .",
    "such a dependence is expected for an ensemble of nv centres in zero magnetic field .",
    "indeed , the coherence time of nv centres is limited by dipolar interactions with the surrounding spin bath , either paramagnetic impurities ( p1 centres ) or @xmath123 nuclear spins . this spin bath can be approximated as generating a fluctuating magnetic field that blurs the phase of the nv centre . in zero magnetic field ,",
    "an interesting situation occurs : the nuclear spin state @xmath124 becomes immune to first order to magnetic fluctuations  @xcite because of the strain - induced coupling between states @xmath49 which gives rise to an avoided level crossing , and thus to a transition frequency independent of magnetic field to first order ( see fig .",
    "[ fig1]d ) .",
    "this was shown in previous work to make the free - induction decay time @xmath2 one order of magnitude longer in zero magnetic field  @xcite , and should equally lead to a longer hahn echo time @xmath4 .",
    "this is however not true for states with @xmath125 , which should therefore have a shorter decoherence time @xmath4 in zero magnetic field .",
    "more details will be given in future work .",
    "( @xmath126 ) with an identical amplitude ( corresponding to @xmath127 photons in the resonator ) and different phases @xmath128 and @xmath129 , and a @xmath130db stronger refocusing pulse @xmath16 with phase @xmath131rad .",
    "( b ) amplitude of the measured ( solid line ) and calculated ( dash - dotted line ) output signal showing the reflected pulses @xmath6 ( after partial absorption by the spins ) and @xmath16 ( its amplitude being trimmed by amplifier saturation , shown in red ) , as well as the six re - emitted echoes @xmath9 ( magnified by a factor 5 ) .",
    "inset : the comparison between the energies of the reflected @xmath6 pulses with the spins saturated ( black line ) or reset in their ground state ( blue line ) shows that about 75% of the incident power is absorbed by the spins .",
    "( c ) iq quadratures of the output signal , showing that the @xmath9 pulses ( magnified by 10 ) are recovered with phase @xmath132 , as expected .",
    "( d ) spin - echo @xmath133 of @xmath134 photons in the resonator for a low power incoming @xmath107 pulse populating the resonator with only @xmath135 photons .",
    "the refocusing pulse ( dashed line ) was suppressed in the room - temperature detection chain by a microwave switch to avoid saturating the follow - up amplifiers.,width=415 ]    we finally implement the multi - mode 2pe protocol with weak microwave pulses .",
    "six consecutive microwave pulses with a varying phase and identical amplitude corresponding to @xmath136 photons in the resonator are first absorbed by the spin ensemble ; a strong refocusing pulse is then applied @xmath137 later ( see fig .",
    "[ fig4]a ) .",
    "the sequence is averaged @xmath138 times at a repetition rate of @xmath13hz , made possible by the active reset of the spins . as shown in fig .",
    "[ fig4]b , the six pulses are recovered after the refocusing pulse up to @xmath38 after their storage , with an amplitude reduced by @xmath139 compared to the incoming pulse , corresponding to @xmath140 photon in the resonator .",
    "as expected , the pulses are re - emitted in reverse order ( see fig .",
    "[ fig4]c ) .",
    "note that the strong refocusing pulse ( @xmath141 photons in the cavity ) does not prevent detection of fields at the single - photon level few microseconds later .",
    "we were able to detect a measurable spin - echo signal for pulses containing up to @xmath142 times lower energy , thus populating the resonator with @xmath41 photons on average ( see fig .",
    "[ fig4]d ) .    an important figure of merit is the field retrieval efficiency @xmath12 , defined as discussed in the introduction as the ratio between the energy recovered during the echo and the energy of the incoming pulse . in the data shown in fig .",
    "[ fig4]b , @xmath12 is seen to decrease with @xmath8 due to spin decoherence , following approximately the relation @xmath143 , which yields @xmath144 for @xmath145 .",
    "coming back to the figures of merit defined in the introduction , our measurements reach @xmath39 , @xmath40 , @xmath41 , and @xmath42 , many orders of magnitude closer to the quantum regime than previous state - of - the - art experiments  @xcite .    reaching the quantum regime",
    "however requires a recovery efficiency @xmath12 close to @xmath13 , and therefore calls for a quantitative understanding of our measurements imperfections . in that goal",
    "we have performed simulations of the multi - mode 2pe protocol . as seen in fig .",
    "[ fig4]b the measurements are well reproduced , although a seven times higher efficiency @xmath146 is predicted .",
    "we attribute the discrepancy between @xmath147 and @xmath148 to the imperfect modelling of decoherence .",
    "indeed , our simulations treat spin decoherence in the markov approximation .",
    "this is not an adequate treatment since it is well - known that the spin bath environment displays strong memory effects . in particular",
    "this markov approximation is expected to describe improperly the dynamics of a spin under the action of a microwave drive , as happens during the refocusing pulse .",
    "this non - markovian bath causes the rabi oscillation of a single spin to decay faster than the spin - echo damping time @xmath4 as was observed in @xcite for instance .",
    "this effect is not included in our simulations and might explain the remaining discrepancy between theory and measurements .",
    "overall we infer from the simulations that @xmath148 would reach @xmath149 for a sample with infinite @xmath4 ; this number quantifies the reduced efficiency caused by refocusing pulse imperfections and finite spin absorption . in the measured efficiency @xmath150 ,",
    "finite spin coherence causes a further @xmath151 reduction , thus appearing as the main limitation of the field retrieval efficiency in the present experiment .",
    "a one order of magnitude increase of the coherence time will thus be necessary to reach the quantum regime .",
    "this can be achieved  @xcite with samples having a reduced concentration of nitrogen paramagnetic impurities as well as isotopic enrichment of @xmath152 .",
    "better refocusing could be obtained either by rapid adiabatic passage  @xcite , or by tailoring the spin spatial distribution  @xcite . these combined advances should make possible to reach the figures of merit requested for the quantum regime , and therefore to implement a complete quantum memory protocol  @xcite at the single photon level , and to explore experimentally its fidelity .",
    "optical pumping in a hybrid circuit , as demonstrated here , is also a first step towards the polarisation of the nitrogen nuclear spins  @xcite , and in a longer term towards a nuclear - spin based quantum memory .    in conclusion",
    "we have implemented the multi - mode storage and retrieval of microwave fields in an ensemble of nv centres in diamond at millikelvin temperatures , with active reset by optical pumping and refocusing by a strong microwave pulse .",
    "these results demonstrate that complex dynamical control of spin ensembles is compatible with hybrid quantum circuits , thus enabling the long - term storage of quantum information in electronic or nuclear spin ensemble quantum memory .",
    "* we acknowledge technical support from p. snat , d. duet , j .- c .",
    "tack , p. pari , p. forget , as well as useful discussions within the quantronics group and with a. drau , j .- f .",
    "roch , t. chanelire and j. morton .",
    "we acknowledge support of the french national research agency ( anr ) with the qinvc project from chistera program , of the european project scaleqit , and of the cnano idf project quantrocryo .",
    "y. kubo is supported by the japanese society for the promotion of science ( jsps ) .",
    "b. julsgaard and k. mlmer acknowledge support from the villum foundation .",
    "the sample we use is a polished @xmath153 plate of dimensions @xmath154 taken from a @xmath155 growth sector of a synthetic type - ib diamond crystal with its edges along @xmath156 $ ] .",
    "the synthetic diamond crystal was grown by a temperature gradient method under high pressure and high temperature ( hpht ) of 5.5gpa and @xmath157c .",
    "the crystal contained @xmath66ppm of neutral substitutional nitrogen ( the p1 centre ) as measured by ir absorption .",
    "irradiation with @xmath111mev electrons was carried out in two steps .",
    "first , it was irradiated at rt with a dose of @xmath158e / c@xmath159 and annealed at @xmath160c for @xmath161 hours in vacuum .",
    "secondly , it was irradiated at @xmath162c to a dose of @xmath158e / c@xmath159 and annealed at @xmath163c for @xmath111 hours in vacuum . from the measured absorption",
    "we deduce the nv centre concentration @xmath164ppm , implying a probable concentration of remaining neutral substitutional nitrogen ( the p1 centre ) of @xmath165ppm . in samples with such large p1 centre concentration ,",
    "the typical nv centre coherence time is @xmath166  @xcite , in agreement with measurements shown in fig .",
    "the niobium resonator was fabricated using optical lithography followed by dry etching .",
    "microwave simulations indicates an impedance @xmath167 , corresponding to a total inductance @xmath168nh .",
    "this inductance arises from the capacitor fingers , and from the meander wire connecting the two capacitor electrodes on top of which the diamond is pressed by a copper spring .",
    "simulations indicate that the meander wire inductance is @xmath169nh .",
    "since the diamond crystal covers only this wire , the spin filling factor is @xmath170 .",
    "the wire was designed purposely to occupy a small area of @xmath171 in order to minimise the laser power needed to repump the spins .",
    "the single - mode fibre , with numerical aperture @xmath172 , was brought into our cryogen - free dilution cryostat through a home - made vacuum feedthrough .",
    "a yag laser doubled at @xmath31 nm is injected into the room - temperature end of the fibre .",
    "it is pulsed with @xmath173db dynamics by a double - pass acousto - optic modulator .",
    "up to @xmath174mw laser power could be injected into the fibre . at low temperatures , the fibre and cladding",
    "were stripped over @xmath13 cm .",
    "this short bare fibre part was glued to a glass @xmath13 mm thick spacer itself glued to the @xmath175 mm thick diamond , so that the fibre - to - sample distance was @xmath44 mm , corresponding to a nominal beam diameter of @xmath176 at the sample , therefore matching the area covered by the resonator meander wire . prior",
    "to being glued , the fibre was positioned on top of this wire , with a precision estimated to be better than @xmath175 mm .",
    "the detailed microwave setup is shown in supplementary fig .",
    "[ figs11 ] .",
    "the incoming microwave pulses are attenuated at low temperatures , routed to the input waveguide of the resonator via a circulator , and the reflected signal is amplified at @xmath75k by a low - noise hemt amplifier , and demodulated at room - temperature , yielding the field quadratures @xmath177 or equivalently the amplitude and phase @xmath178 .",
    "note that the attenuation in the input line ( @xmath66db at @xmath75k and @xmath32db at @xmath142mk ) is not sufficient to fully suppress thermal photons in the input waveguide to the resonator , implying that a thermal field with @xmath179 photon is present in the resonator , and causing sizeable thermal excitation of the spin ensemble as shown in fig .  2 of the main text .",
    "this was done purposely to apply more conveniently the refocusing pulses that require large microwave powers at the sample input .",
    "one difficulty of the experiment is to switch on and off with very high dynamics the strong microwave pulses needed to saturate or refocus the spins .",
    "we found that one microwave switch was not sufficient , and we used in all the experiments two switches in series , one internal to the microwave source , and one external ( see supplementary figs .  [ figs11 ] and  [ figs12 ] ) .    , @xmath180 and @xmath181 ghz , respectively .",
    "cuni coax is a coaxial cable made of cuni , and ag - cuni coax is a silver - plated cuni coaxial cable .",
    "sc coax is a superconducting nbti coaxial cable .",
    "flex coax is a low - loss flexible coaxial cable .",
    "rectangles represent ports terminated by 50@xmath182 .",
    "the cryogenic microwave amplifier is a citcryo 1 - 12 from caltech , with gain @xmath18338 db and noise temperature @xmath1835 k at @xmath184 ghz .",
    "a dc magnetic field @xmath21 is applied parallel to the chip by passing a dc current through an outer superconducting coil .",
    "the sample box and the coil are surrounded by two magnetic shieldings consisting of a lead cylinder around which permalloy tape is wrapped .",
    "the sample box , coil , and the shieldings are thermally anchored at the mixing chamber with base temperature @xmath71mk ( note that in the experiments using active reset of the spins with @xmath44mw laser power , the temperature was @xmath37mk instead ) .",
    "( b ) full configuration of the measurement apparatus at room temperature for spins polarization measurements ( fig .  2 of the main text ) .",
    "the saturation pulse is shaped with @xmath185db dynamics by two microwave switches in series .",
    "the dc waveform supplied to the external microwave switch is delayed by @xmath186ns to synchronize both switches .",
    "lpf is a low - pass filter with cutoff frequency @xmath13 mhz .",
    ", width=604 ]    db dynamics by two microwave switches in series .",
    "the dc waveform supplied to the external microwave switch is delayed by @xmath186ns to synchronize both switches .",
    "( a ) full configuration of the measurement apparatus at room temperature for multimode storage experiment ( fig .",
    "5 b , c of main text ) .",
    "lpf is a low - pass filter with cutoff frequency @xmath161 mhz .",
    "( b ) full configuration of the measurement apparatus at room temperature for few - photon storage experiment ( fig .",
    "5 d of main text ) .",
    "the local oscillator of the iq demodulator is pulsed to suppress the refocusing pulse from the reflected signal .",
    "lpf is a low - pass filter with cutoff frequency @xmath13mhz.,width=604 ]      the goal of this section is to give the necessary elements to understand the theoretical curves presented in the main text . after defining the model ,",
    "we explain 1 ) how the spin susceptibility @xmath187 is extracted from microwave absorption measurements ( figs@xmath111d and @xmath184a in the main text ) , 2 ) how this measured susceptibility can be computed from the spin hamiltonian assuming phenomenological distributions of the various hamiltonian parameters ( again figs@xmath111d and @xmath184a in the main text ) , and 3 ) how the experimental sequences with refocusing pulses were simulated ( figs@xmath75b , c , e and @xmath161b of the main text ) .      here",
    "we follow the model already described in@xcite .",
    "the spin-1 nv centers are approximated by two spin-1/2 particles ( see justification in the main text and below ) .",
    "the nv ensemble is thus modelled as an ensemble of @xmath188 spin-1/2 particles of frequency @xmath189 .",
    "each spin couples to the cavity field ( described by creation and annihilation operators @xmath190 and @xmath191 ) with a coupling constant @xmath192 and a jaynes - cummings type of interaction .",
    "the resonator frequency is @xmath193 , and its field damping rate @xmath194 .",
    "the total system hamiltonian is then        the dynamics predicted by this model is quite complex ( see below ) .",
    "however it becomes simpler in the limit where the number of excitations present in the system is much lower than the total number of spins @xmath188 .",
    "indeed , in this regime , spin saturation can be neglected , and the spins behave as weakly excited harmonic oscillators .",
    "this is the so - called holstein - primakoff approximation , by which all previous experiments on spins coupled to resonators have been theoretically described so far .",
    "the measurements shown in figs . @xmath111 and @xmath75a of the main text are also performed in that limit , which is why we briefly discuss it in the next paragraph .",
    "[ [ microwave - absorption - and - spin - susceptibility - in - the - linear - regime ] ] microwave absorption and spin susceptibility in the linear regime ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^",
    "@xmath204 being the spin dephasing rate .",
    "the spins shift the resonance frequency @xmath193 by @xmath205 and add a damping term @xmath206 to the field damping rate @xmath207 .",
    "these quantities can be directly extracted from the microwave measurements as explained in the following .    in the experiment",
    ", we measure the amplitude and phase of the field reflected on the resonator .",
    "we thus want to calculate the reflection coefficient @xmath208 , @xmath209 being the reflected field . from input - output theory",
    "we have @xmath210 , so that      in the experiment , we measure reflected microwave signals through measurement cables and amplifiers which have a complex frequency - dependent transmission coefficient @xmath212 giving us access to @xmath213 ( the complex conjugate is taken because of a different sign convention between theory and experiment ) . to calibrate @xmath212 , the reflected signal @xmath214",
    "is compared to the steady - state values of the reflected signal with spins saturated which is given by @xmath215 , with @xmath216 the reflextion coefficient of the cavity without spins . in total",
    "we obtain that      we find it useful to express @xmath218 in terms of the spin susceptibility @xmath219 , defined as the ratio of the induced magnetization @xmath220 and the applied microwave field @xmath221 .",
    "more precisely for an applied field @xmath222 , the induced magnetization is @xmath223 , with @xmath224  @xcite .",
    "this changes the resonator inductance @xmath19 into @xmath225  @xcite , @xmath226 being the filling factor and @xmath227 the complex spin susceptibility in cgs units .",
    "this implies that the resonator frequency is shifted by @xmath228 , and the extra field damping rate is @xmath229 .",
    "this yields the following direct link between @xmath218 and @xmath219 :      equations ( [ eq : kmeasurements ] ) and ( [ eq : kandchi ] ) explain how the experimental spin susceptibility was derived from the measurements ( figs @xmath111d and @xmath75a of the main text ) .",
    "note that the corresponding absorption curves were measured at powers @xmath231dbm corresponding to few intra - cavity photons , thus by far low enough for the holstein - primakoff approximation to be justified .",
    "the goal of this section is to demonstrate that it is possible to quantitatively understand from the nv centers hamiltonian the measured susceptibility curves , assuming phenomenological distributions of the parameters entering this hamiltonian .",
    "this is how we computed the theory curves in figs.@xmath111e and @xmath75a of the main text .",
    "note that this section is to a large extent independent of the rest of the paper : it explains the theory curves in figs2d and inset of 3a , but importantly the numerical simulations of the echo experiments do not rely in any way on the distributions of strain or magnetic field fluctuations obtained phenomenologically in this section .",
    "as explained in  @xcite this implies that @xmath234 ( this relation holds in the limit where the inhomogeneous frequency spread is much larger than the homogeneous spin linewidth , which is the case here ) .",
    "therefore , @xmath235 is proportional to @xmath236 .",
    "we assume that the spatial distribution ( which determines the coupling constant @xmath237 ) and the frequency distribution of the spins are uncorrelated , which would be the case if the frequency distribution were only caused by local fields ( magnetic , electric , strain , see below ) , with a spatially independent distribution .",
    "one can then write @xmath238 , with @xmath239 and @xmath240 normalized such that @xmath241 .",
    "what we are interested in here is to reproduce the frequency distribution @xmath240 observed in the experiment , starting from the nv center hamiltonian , with only one distribution of the hamiltonian parameters ( strain @xmath12 , magnetic field @xmath242 , zero - field splitting @xmath243 ) .          with @xmath246",
    "ghz the zero - field splitting , @xmath12 the strain splitting , @xmath247  mhz the nuclear quadrupole momentum , @xmath248  mhz the hyperfine coupling of the nv to the @xmath244 nucleus , and @xmath249 the magnetic field felt by the nv .",
    "our ensemble of nv centers has a certain frequency distribution because the hamiltonian parameters have a distribution , that we assume to be static . here",
    "we will consider that both @xmath98 and @xmath78 are fixed for all nvs .",
    "on the other hand , @xmath250 has evidently a certain distribution characterized by a function @xmath251 such that the number of spins seeing a certain magnetic field between @xmath250 and @xmath252 is given by @xmath253 .",
    "this distribution originates from the different magnetic environments due to the local random distribution of @xmath254 centers and @xmath255 nuclei . note",
    "that although one can safely assume that @xmath256 , @xmath257 and @xmath250 have the same distribution , we will only consider the @xmath250 distribution because it is the one that couples most strongly to the nv center , a good approximation when @xmath258 as is the case here . in the following we write @xmath259 , and we note that @xmath260 , @xmath21 being the applied magnetic field at an angle @xmath261 from the nv axis and @xmath262 the z component of the field due to the local environment of each nv .",
    "what is constant in the problem is the distribution of @xmath262 , @xmath263 the strain parameter @xmath12 has another distribution @xmath264 . and",
    "finally , the zero - field splitting @xmath243 is distributed with density @xmath265 , which is validated by recent work  @xcite .",
    "the hamiltonian diagonalization leads to @xmath266 states , corresponding to the 3 nuclear spin states @xmath267 , and the @xmath184 nv center states due to their spin @xmath23 .",
    "this gives @xmath268 transition frequencies @xmath269 $ ] .",
    "our goal is now to express @xmath270 as a function of @xmath271 , @xmath272,@xmath273 .",
    "we write      for @xmath271 and @xmath272 we will assume a lorentzian shape , which at least for @xmath271 has a physical justification ( the linewidth of a dipolar broadened spin ensemble is usually lorentzian ) , with a width that will be `` guessed '' or adapted to fit the data .",
    "for @xmath273 we use the @xmath92 dataset ( see fig .",
    "@xmath75a of the main text ) to find an appropriate distribution .",
    "the formula above is in principle sufficient to compute @xmath270 numerically given @xmath271 , @xmath272,@xmath273 ; however it would lead to very long calculation times and we need to simplify it .",
    "the first simplification is that instead of explicitly diagonalizing the hamiltonian to obtain @xmath275 $ ] we use approximate formulas :          with @xmath279 , considering the hyperfine interaction with the nuclear spin as a nuclear - spin - state dependent effective magnetic field of modulus @xmath280 .",
    "these formulas are valid when @xmath258 , a very good approximation in our case .",
    "this allows to very easily invert the formula yielding , for given frequency @xmath281 , strain @xmath12 and zero - field splitting @xmath243 , the local magnetic field @xmath282 needed so that @xmath275=\\omega$ ] .",
    "this equation has either zero or two solutions depending on @xmath281 . for the @xmath283 transitions there are two solutions if @xmath284 , and zero else ; for the @xmath285 transitions there are two solutions if @xmath286 , and zero elsewhere .",
    "@xmath296\\right ) \\\\ & = & \\sum_{m_i,\\pm , i}\\iint dedd\\rho_{e}(e)\\rho_{d}(d)\\frac{\\rho_{b}\\left(b_{m_i,\\pm^{(i)}}[\\omega , e , b_{nv},d]\\right)}{\\left|\\frac{\\partial\\omega_{m_i,\\pm}}{\\partial b}(b_{m_i,\\pm}[\\omega , e , b_{nv},d])\\right|}.\\end{aligned}\\ ] ]    note that from the previous formulas it is clear that the density of nv centers at a given frequency @xmath281 can have a strong dependence on the nuclear spin state .",
    "this might explain in particular why the relative contributions of the @xmath297 and @xmath124 to the spin echo signal at @xmath298ghz were found to be slightly different from the expected @xmath299 and @xmath300 by fitting the decoherence signal ( see main text ) .",
    "a difficulty arises when @xmath301 vanishes , giving rise to a divergence .",
    "to smoothen this out , we discretize the problem : we choose some small frequency scale @xmath302 and we solve the equation @xmath303-\\omega_{m_i,+}[e , b_{nv},d , b]=d\\omega_{0}$ ] .",
    "this equation has always two solutions , we take the min of the two yielding the quantity @xmath304 $ ] .",
    "the new formula is        we assume a lorentzian distribution for both @xmath263 and @xmath265 with respective widths @xmath306 and @xmath307 .",
    "we use the data at @xmath308 to guess the distribution @xmath264 .",
    "we find that a bi - exponential distribution @xmath309 / ( e_1 + a_1 e_2)$ ] yields a computed @xmath310 that reproduces semi - quantitatively the data .",
    "in total we use the following parameters : @xmath311gs , @xmath312mhz , @xmath313mhz , @xmath314mhz , @xmath315 . in this way",
    "we obtain the @xmath92gs spin susceptibility shown in fig .",
    "[ figs3 ] ( the corresponding @xmath264 distribution is shown in inset ) .    .",
    "open red circles are experimental data , solid blue line is the theory computed with the bi - exponential strain distribution @xmath316 shown in the inset , with a lorentzian @xmath317 and @xmath318 with respective widths @xmath319gs and @xmath320khz.,width=453 ]    after having in this way determined the distributions @xmath321 , we compute without further adjustable parameters the rescaled @xmath322 .",
    "the experimental distribution includes contributions both from the spins that are orthogonal to @xmath21 and from those that are non - orthogonal , each of those having a very different resonance frequency dependence on @xmath21 as shown in fig .  2 of the main text .",
    "each family contains exactly half of the total number of spins contributing to the signal ; however , spins from each family have a different coupling constant to the resonator field due to the angle they make with this field .",
    "this difference in coupling constant can be incorporated in a single numerical factor that yields a different ensemble coupling constant for each of the two spin families , @xmath323 and @xmath324 .",
    "indeed , the coupling constant of a nv center ensemble to a resonator is given by @xmath325  @xcite , with @xmath326 the ensemble filling factor and @xmath327 the angular factor .",
    "the geometrical filling factor is clearly identical for the two families , but the factor @xmath199 differs . we have numerically calculated the ratio @xmath328 , yielding @xmath329 . in this way we are able to compute the total @xmath330 . the rescaled result is shown in fig .  [ figs4 ] .      as can be seen from figs .",
    "[ figs3 ] and [ figs4 ] , the agreement is semi - quantitative .",
    "all the features are reproduced but not exactly with the appropriate weight .",
    "these remaining discrepancies might be due to the fact that the strain distribution is likely to have some spatial dependence ; in particular it could depend to some extent of the distance to the surface , in which case it would be correlated with the coupling constant distribution making the above analysis an approximation .",
    "numerical simulations are performed to describe spin - echo experiments and quantitatively estimate the echo field retrieval efficiency .",
    "therefore they clearly do not use the linear approximation developed in the previous paragraphs , in order to account for refocusing effects , but instead use the complete hamiltonian eq .",
    "( [ eq : hamiltonian_working ] ) . to perform the calculations while taking into account the inhomogeneity in both spin resonance frequencies and coupling strengths , the entire inhomogeneous ensemble is divided into @xmath331 homogeneous sub - ensembles , @xmath332 , each of them describing spins having an identical frequency @xmath333 and coupling to the cavity field @xmath334 .",
    "the total number of spins in one sub - ensemble is defined as @xmath335 .",
    "we define the sub - ensemble spin collective operators : @xmath336 where @xmath337 runs over all spin sub - ensembles . here again , the spin-1 nv center is treated approximately as two spin-@xmath338 particles . by incorporating the effect of resonator leakage and spin decoherence in the markov approximation ,",
    "the dynamical evolution of mean values in the frame rotating at @xmath339 ( with @xmath339 the mean spin frequency ) is described by ( see ref .",
    "@xcite for details ) : @xmath340 here @xmath341 , @xmath342 , @xmath343 ; and @xmath344 and @xmath345 are the cavity field quadratures such that @xmath346 = i$ ] , @xmath347 and @xmath348 are real and imaginary parts of the external driving field with @xmath349 being the incident number of microwave photons per second , @xmath350 is the spin population decay rate . in the experiment",
    "the population decay time @xmath351s ( see fig.@xmath184c of main text ) is very long compared to the typical refocusing time scales and we use the excellent approximation @xmath352 .",
    "the first step is to determine the size @xmath335 of each sub - ensemble @xmath353 , which requires knowledge of the distribution of coupling constants and resonance frequency within the spin - ensemble .",
    "the distribution of coupling constants can be computed from the known resonator geometry and crystalline orientation ( see next section ) ; the distribution of resonance frequencies is not a priori known but is extracted from absorption measurements as explained earlier .",
    "we first come back to the interaction hamiltonian between the nv center spin @xmath354 and the quantized resonator magnetic field : @xmath355 , where @xmath356 is the rms fluctuations of the resonator vacuum field .",
    "the external field @xmath357 and the effective field generated by the nuclear spin , @xmath358 , can be treated classically . in the rotating wave approximation",
    "the spin part of the hamiltonian can be expressed in terms of the energy eigen states @xmath359 at zero bias magnetic field as : @xmath360 \\:-\\ : ig_y\\left[{\\ensuremath{\\hat{a}_{\\mathrm{c}}}}{\\ensuremath{|-\\rangle}}\\!{\\ensuremath{\\left<0\\right| } } \\:-\\ :     { \\ensuremath{\\hat{a}^{\\dagger}_{\\mathrm{c}}}}{\\ensuremath{|0\\rangle}}\\!{\\ensuremath{\\left<-\\right|}}\\right ] ,    \\end{split}\\ ] ] where @xmath361 .",
    "we note the energy splitting of @xmath55 between the @xmath362 and @xmath363 states , and we observe that two jaynes - cummings - like interaction terms emerge . under the holstein - primakoff approximation ( i.e.  in absence of saturation with all population essentially in the ground state @xmath364 ) , the nv center can be treated accurately as two separate spin-@xmath338 particles .",
    "of course , if the resonator field saturates the nv center , and hence depletes the @xmath364 state , this two - particle picture fails .",
    "nonetheless , we argue below that it is a reasonable approximation to maintain this picture throughout our simulations .    the hamiltonian above is expressed with the quantization axis ( the @xmath365-axis ) along the nv center axis .",
    "since this does not coincide with our laboratory coordinate system ( defined in fig .",
    "1b of the main text ) , we must define a local coordinate system for each of the four possible nv center axes . as local @xmath365-axes",
    "we choose : @xmath366 i.e.  for family 1 we take , @xmath367 , etc . for symmetry reasons the coupling strengths from family 1 and 2 turn",
    "out identical , and likewise for families 3 and 4 .",
    "we thus proceed with families 1 and 3 only . as local @xmath368- and @xmath369-axes for family 1",
    "we have a selection of choices : @xmath370 @xmath371 being the angle between the nv axis and the direction of non - axial strain in the diamond matrix .",
    "for all angles @xmath371 we obtain a local orthogonal coordinate system @xmath372 $ ] with the @xmath365-axis pointing along the nv center axis as required .",
    "the angle @xmath371 must be chosen such that the hamiltonian term @xmath373 describes correctly the actual physical strain experienced by the nv center from the surrounding host material . however , since this strain has no preferred direction we shall later average our coupling - strength distribution over this angle .",
    "similarly , for family 3 we adopt the local coordinate system : @xmath374 and @xmath375 next , provided that the resonator vacuum field @xmath356 is known , the coupling constants @xmath376 and @xmath377 for the two nv center transitions follow as @xmath378 and @xmath379 for each spin family .",
    "the sign ( or in general the phase ) of @xmath380 is irrelevant and we use in the simulations a positive quantity for the coupling constants . for the spin families 1 and 3",
    "we then find : @xmath381 the distribution of @xmath380-parameters thus follows from both an inhomogeneous distribution of magnetic fields @xmath356 and the angular distribution of crystal strain experienced by the nv centers .",
    "we note that the distributions of @xmath382 and @xmath383 ( and likewise for @xmath384 and @xmath385 ) are identical when the angular average is taken into account . to proceed , the vacuum field @xmath356",
    "is calculated using the comsol simulation software .",
    "the shape of @xmath356 is shown graphically in the inset of fig .",
    "1b in the main text , and the curved sections of the resonator element was neglected such that @xmath356 essentially only consists of an @xmath368- and a @xmath369-component . the correct magnitude for @xmath356",
    "is obtained by scaling the field to the one corresponding to the resonator current set equal to @xmath386 . the resulting distribution [ or rather @xmath387 times the distribution @xmath388 with @xmath389 of @xmath380-parameters is shown in fig .",
    "[ fig : extractdist]a , where the effective length of the active crystal was taken to be 100 microns along the @xmath365-axis , the concentration was 2 ppm , and a 0.7 @xmath390 spacing for glue was estimated between the resonator and the diamond crystal .",
    "the area under @xmath391 is equal to the squared ensemble coupling constant @xmath392 , and the orthogonal families ( 3 and 4 ) contribute @xmath393 of the total area , while families 1 and 2 contribute the remaining @xmath394 part .",
    "the black circles in fig .",
    "[ fig : extractdist]a denote the actual discrete distribution , which was used for the simulation results shown in fig .",
    "4b , c , e and 5b in the main text .",
    "the frequency distribution @xmath395 is determined as explained earlier , from microwave absorption measurements .",
    "note that the directly measured ensemble coupling constant from integrating the curves in fig .",
    "[ fig : extractdist]b is @xmath396 mhz .",
    "however , these data were obtained under repumping with a laser power of @xmath397 corresponding ( see fig .",
    "3b of main text ) to a spin polarization @xmath398 . in the simulations we thus rescale the number of spins @xmath188 such that the ensemble coupling constant becomes @xmath399 , and when simulating the spin - echo sequences the appropriate initial value of @xmath400 is chosen , where @xmath401 refers to the polarization corresponding to the laser power used in the experiment ( @xmath44mw in most measurements ) .",
    "we note that the @xmath380-parameter distribution calculated from first principles as explained above leads to @xmath402 mhz , i.e.  @xmath403 70 % of the value stated above . given the measurement accuracy , and the fact that the nv center concentration and the resonator - to - crystal distance are known only approximately , we find the agreement between these numbers satisfactory .",
    "the main purpose of our simulations is to understand the measured retrieval efficiency of the echo pulses .",
    "hence , we must be quantitative on the echo - pulse magnitudes in the simulations , and accordingly we must adapt the equations of motion to cover the actual case with two spin classes of different coherence time as explained in sec .",
    "iv .     during the refocusing pulse ( red )",
    "compared to the difference , @xmath404 ( black ) , between the simulations with fast and slow dephasing .",
    "the refocusing pulse extends from @xmath405@xmath406 , followed by free - induction decay .",
    "( b ) the red circles denote the field recovery efficiency of the experimental echo pulses versus the delay @xmath110 between storage and readout of the six pulses in the multi - mode echo sequence .",
    "the blue dots are simulated efficiencies for a range of driving powers in the vicinity of the experimental value of @xmath407 dbm .",
    "the green solid line is the square of the function @xmath408 described in the main text .",
    "the remaining solid lines corresponds to a constant pre - factor times @xmath409 ^ 2 $ ] .",
    "( c ) the blue circles correspond to the simulated pre - factors from panel ( b ) with the horizontal blue dashed line denoting the average value of @xmath410 .",
    "the red dashed line is the experimental pre - factor equal to @xmath411 . ]",
    "the obvious strategy would be doubling the sub - ensemble partitioning into two parts  one with coherence time @xmath412 and the other with @xmath413and adapting eqs .",
    "( [ eq : def_sub - ensembles])-([eq : mean_val_eq_sz_kl ] ) accordingly .",
    "however , we use a much simpler strategy in the following : the simulations are run first with a single coherence time @xmath412 , and then repeated with the other coherence time @xmath413 .",
    "the calculated reflected fields in these two instances are then combined according to the weights given by the fitting parameters @xmath98 and @xmath242 mentioned in the main text .",
    "now the two sub - ensembles share in practice a common resonator field @xmath191 which in the simulations is ascribed two different values , and under influence of the refocusing pulse , i.e.  in conditions of saturation , linearity will not be applicable . however , for our problem in question ( the multi - mode echo sequence in fig .  5 of the main text )",
    "the refocusing pulse strength is @xmath414 db above saturation , and hence the external driving determines the resonator field to a much larger extent than the reaction field of the spin dipoles .",
    "indeed , fig .",
    "[ fig : fidelitycalculation]a shows that the resonator field is essentially identical in the two simulation runs with fast and slow coherence time .",
    "now , for the multi - mode sequence shown in fig .  5 in the main text , the efficiency is calculated for each of the six pulses in the sequence and plotted as a function of the input - output delay @xmath110 in fig .",
    "[ fig : fidelitycalculation ] ( red circles ) .",
    "since the efficiency is defined as the energy of the echo pulse relative to the incoming energy , it is expected to behave as : @xmath415 ^ 2 $ ] , where @xmath416 is a constant and @xmath114 was found in the main text as fitting the experimental amplitude - decay of echo pulses [ scaled such that @xmath417 .",
    "the function @xmath409 ^ 2 $ ] is shown as the green curve in fig .",
    "[ fig : fidelitycalculation]b , and this curve corresponds to the efficiency that one would obtain if spin dephasing were the sole reason for a non - ideal echo protocol .",
    "we observe that both simulations ( blue dots ) and experiment lead to a lower efficiency ; however , the overall behavior corresponds indeed to a pre - factor @xmath416 multiplied onto @xmath409 ^ 2 $ ] .    before we comment on these pre - factors ,",
    "there is a little subtlety to mention about the simulations : due to the discrete division of the coupling strengths into @xmath418 bins ( see fig .  [",
    "fig : extractdist]a ) , there are artificial oscillations occurring in the echo recovery efficiency as a function of the applied driving power , see the blue circles in fig .",
    "[ fig : fidelitycalculation]c . we have checked that an increasing @xmath419 will decrease the magnitude of such oscillations ( not shown ) while the mean value stays essentially fixed .",
    "for this reason we compute the mean value of the efficiency pre - factors in fig .",
    "[ fig : fidelitycalculation]c , which then amounts to 0.21 ( dotted blue line ) .",
    "we thus conclude that the rather low simulated efficiencies ( a few times @xmath151 and decreasing with increasing @xmath110 in fig .",
    "[ fig : fidelitycalculation]b ) are caused primarily by spin dephasing .",
    "the simulated curve in fig .",
    "4e of the main text was obtained with @xmath420 .",
    "next , the experimental retrieval efficiencies follow also the trend of @xmath409 ^ 2 $ ] but with a pre - factor @xmath421 times lower than the one found from simulations .",
    "this indicates that there is an additional effect in play , which is not included in our simulations .",
    "as explained in the main text , we attribute this discrepancy to the inadequacy of the markov approximation to describe decoherence caused by a spin bath .",
    "36ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1038/nature03064 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2009.231 [ * * , ( ) ] link:\\doibase    10.1038/nature09662 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/13/9/093031 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.101.040501 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.77.020301 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.103.070502 [ * * ,   ( ) ] link:\\doibase    10.1038/ncomms2771 [ * * ,   ( ) ] link:\\doibase 10.1038/nmat3182 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1217635 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1103/physrevlett.110.250503 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.105.140502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.105.140501 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.107.060502 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.110.067004 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.110.157001 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.107.220501 [ * * ,   ( ) ] link:\\doibase 10.1038/nature10462 [ * * ,   ( ) ] link:\\doibase    10.1063/1.1721903 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.105.140503 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.85.012333 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.79.075203 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys1969 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.063810 [ * * ,   ( ) ] link:\\doibase    10.1038/nature10401 [ * * ,   ( ) ] link:\\doibase 10.1063/1.4792205 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.74.161203 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1016/j.jmr.2013.01.010 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.102.057403 [ * * ,   ( ) ] http://stacks.iop.org/0022-3727/30/i=12/a=016 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.84.063810 [ * * ,   ( ) ]",
    "link:\\doibase 10.1103/physreva.83.053852 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop"
  ],
  "abstract_text": [
    "<S> a quantum memory at microwave frequencies , able to store the state of multiple superconducting qubits for long times , is a key element for quantum information processing . </S>",
    "<S> electronic and nuclear spins are natural candidates for the storage medium as their coherence time can be well above one second . </S>",
    "<S> benefiting from these long coherence times requires to apply the refocusing techniques used in magnetic resonance , a major challenge in the context of hybrid quantum circuits . </S>",
    "<S> here we report the first implementation of such a scheme , using ensembles of nitrogen - vacancy ( nv ) centres in diamond coupled to a superconducting resonator , in a setup compatible with superconducting qubit technology . </S>",
    "<S> we implement the active reset of the nv spins into their ground state by optical pumping and their refocusing by hahn echo sequences . </S>",
    "<S> this enables the storage of multiple microwave pulses at the picowatt level and their retrieval after up to @xmath0s , a three orders of magnitude improvement compared to previous experiments . </S>"
  ]
}