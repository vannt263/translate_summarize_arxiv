{
  "article_text": [
    "let @xmath1 and @xmath2 be two continuous distribution functions in @xmath3 with densities @xmath4 and @xmath5 with respect to lebesgue measure , respectively",
    ". given independent and identically distributed samples @xmath6 from two unknown densities @xmath4 and @xmath5 , respectively , the two - sample problem is to distinguish the hypotheses @xmath7 asymptotic properties of tests will be derived in the usual limiting regime where @xmath8 is fixed , and @xmath9 with @xmath10 and @xmath11 .    for univariate data ,",
    "there are several celebrated nonparametric tests such as the kolmogorov - smirnoff maximum deviation test @xcite , the wald - wolfowitz runs test @xcite , and the mann - whitney rank test @xcite ( refer to @xcite for more on these tests ) .    the two - sample problem for multivariate data has been extensively studied , beginning with the work of weiss @xcite and bickel @xcite .",
    "friedman and rafsky @xcite generalized the wald - wolfowitz runs test @xcite to higher dimensions using the euclidean minimal spanning tree ( mst ) of the pooled data .",
    "thereafter many other two - sample tests based on inter - point distances have been proposed .",
    "schilling @xcite and henze @xcite used tests based on the @xmath0-nearest neighbor ( @xmath0-nn ) graph of the pooled sample .",
    "later , rosenbaum @xcite and recently biswas et al .",
    "@xcite proposed tests based on inter - point distaces which are distribution - free under the null .",
    "maa et al .",
    "@xcite provided certain theoretical motivations for using tests based on inter - point distances .",
    "another class of multivariate two - sample tests is the liu - singh rank sum statistics @xcite , which generalize the mann - whitney rank test using the notion of data - depth .",
    "this include tests based on halfspace depth @xcite , simplicial depth @xcite , and projection depth @xcite , among others . for",
    "other popular two - sample test refer to @xcite and the references therein .",
    "begin by recalling the general framework of graph - based two - sample tests introduced by the author in @xcite , which includes the tests based on inter - point distances , as well as , those based on data - depth .",
    "a _ graph functional _",
    "@xmath12 in @xmath3 defines a graph for all finite subsets of @xmath3 , that is , given @xmath13 finite , @xmath14 is a graph with vertex set @xmath15 .",
    "a graph functional is said to be _ undirected / directed _ if the graph @xmath14 is an undirected / directed graph with vertex set @xmath15 .",
    "we assume that @xmath14 has no self loops and multiple edges , that is , no edge is repeated more than once in the undirected case , and no edge in the same direction is repeated more than once in the directed case .",
    "the set of edges in the graph @xmath14 will be denoted by @xmath16 .",
    "[ graph2 ] let @xmath17 and @xmath18 be i.i.d .",
    "samples of size @xmath19 and @xmath20 from densities @xmath4 and @xmath5 , respectively , as in ( [ 2 ] ) .",
    "2-sample test statistic based on the graph functional @xmath12 _ is defined as @xmath21    if @xmath12 is an undirected graph functional , then the statistic   counts the number of edges in the graph @xmath22 with one end point in @xmath17 and the other in @xmath18 .",
    "if @xmath12 is a directed graph functional , then   is the number of directed edges with the outward end in @xmath17 and the inward end in @xmath18 .",
    "this includes the friedman - rafsky ( fr ) test   @xcite ( based on the mst ) , the test based on the @xmath0-nn graph @xcite , the cross match test  @xcite ( based on minimum non - bipartite matching ) , as well as the tests based on the liu - singh rank sum statistic @xcite ( see @xcite for details ) .",
    "zuo and he @xcite proved the asymptotic normality of the liu - singh rank sum statistic under general alternatives .",
    "however , the limiting distribution of the statistic   under the alternative , for tests based on geometric graphs , remained open . in this paper",
    ", we settle this problem for stabilizing geometric graphs ( which include the fr - test and the test based on the @xmath0-nn graph ) in the poissonized setting .      in the poissonized",
    "setting , instead of taking @xmath19 samples from the @xmath1 and @xmath20 from @xmath2 , we take @xmath23 from @xmath1 and @xmath24 samples from @xmath2 . the spatial independence of the poisson process simplifies calculations and yields cleaner formulas for the asymptotic variances .",
    "suppose @xmath25 and @xmath26 be i.i.d .",
    "samples from @xmath4 and @xmath5 , respectively , and @xmath27 where @xmath28 and @xmath29 are independent of each other , and of @xmath25 , @xmath26 . given a graph function @xmath12 ,",
    "the poissonized the two - sample statistic is defined as : @xmath30 the distribution of this statistic can be described as follows : let @xmath31 and @xmath32 be independent random variables with common density @xmath33 .",
    "let @xmath34 be an independent poisson variable with mean @xmath35 .",
    "then @xmath36 is a non - homogeneous poisson process in @xmath3 with rate function @xmath37 .",
    "label each point of @xmath38 independently with @xmath39 then the sets of points assigned labels 1 and 2 have the same distribution as @xmath40 and @xmath41 ( as in  ) , respectively .",
    "this implies that for a directed graph functional @xmath12 can be modified to a directed graph functional @xmath42 in a natural way : for @xmath13 finite , @xmath43 is obtained by replacing every edge in @xmath14 with two directed edges , one in each direction .",
    "thus , without loss of generality , it suffices to consider directed graph functionals . ]",
    ", the poissonized 2-sample test statistic can be re - written as @xmath44 where @xmath45 .",
    "denote by @xmath46 and @xmath47 the expectation under the null and the alternative , respectively . for a directed graph functional @xmath12 , @xmath48 note that for the mst functional , @xmath49 and for the @xmath0-nn graph functional @xmath50 , respectively .",
    "thus , the level @xmath51-test based on @xmath12 rejects when @xmath52 where @xmath53 is the standard normal quantile of level @xmath51 , and @xmath54 is the limiting null variance of @xmath55 , which depends on the graph functional @xmath12 , but generally not on the unknown null distribution .",
    "many geometric graphs such as the mst and the @xmath0-nn graph , have local dependence , that is , addition / deletion of a point only effects the edges incident on the neighborhood of that point .",
    "this was formalized by penrose and yukich @xcite using stabilization . to describe the notion of stabilization ,",
    "few definitions are needed .",
    "let @xmath12 be a graph functional defined for all locally finite subsets of @xmath3 .",
    "is _ locally finite _ , if @xmath56 is finite , for all compact subsets @xmath57 .",
    "a locally finite set @xmath13 is _ nice _ if all the inter - point distances among elements of @xmath15 are distinct .",
    "if @xmath15 is a set of @xmath58 i.i.d .",
    "points @xmath59 from some continuous distribution function @xmath1 , then the distribution of @xmath60 does not have any point mass , and @xmath15 is nice . ] for @xmath13 nice and @xmath61 , let @xmath62 be the set edges incident on @xmath63 in @xmath64 .",
    "note that @xmath65 , the ( total ) degree of the vertex @xmath63 in @xmath64 .",
    "[ ts]given @xmath13 and @xmath66 and @xmath67 , denote by @xmath68 and @xmath69 .",
    "a graph functional @xmath12 is said to be _ translation invariant _ if the graphs @xmath70 and @xmath14 are isomorphic for all points @xmath61 and all locally finite @xmath13 .",
    "a graph functional @xmath12 is _ scale invariant _ if @xmath71 and @xmath14 are isomorphic for all points @xmath67 and and all locally finite @xmath13 .",
    "let @xmath72 be the poisson process of intensity @xmath73 in @xmath3 , and @xmath74 , for @xmath61 .",
    "penrose and yukich @xcite defined stabilization of graph functionals over homogeneous poisson processes as follows :    [ stabilization ] a translation and scale invariant graph functional @xmath12 _ stabilizes _",
    "@xmath72 if there exists a random but almost surely finite variable @xmath75 such that @xmath76 for all finite @xmath77 , where @xmath78 is the ( euclidean ) ball of radius @xmath75 with center at the point @xmath79 .",
    "informally , a graph functional is stabilizing if addition of finitely many points outside a ball of finite radius centered at the origin , does not effect the set of edges incident at the origin .",
    "many popular multivariate two - sample tests are based on stabilizing geometric graphs .",
    "friedman and rafsky @xcite generalized the wald and wolfowitz runs test to higher dimensions by using the euclidean minimal spanning tree of the pooled sample .    [ mst ] given a nice finite set @xmath80 , a _ spanning tree _ of @xmath15 is a connected graph @xmath81 with vertex - set @xmath15 and no cycles .",
    "the _ length _ @xmath82 of @xmath81 is the sum of the euclidean lengths of the edges of @xmath81 .",
    "a _ minimum spanning tree _",
    "( mst ) of @xmath15 , denoted by @xmath83 , is a spanning tree with the smallest length , that is , @xmath84 for all spanning trees @xmath81 of @xmath15 .",
    "thus , @xmath81 defines a graph functional in @xmath3 , and given @xmath40 and @xmath41 as in  , the fr - test rejects @xmath85 for small values of @xmath86 where @xmath87 and @xmath88 is obtained by replacing every ( undirected ) edge in @xmath89 with two directed edges , one in each direction .",
    "friedman and rafsky @xcite calibrated   as a permutation test , and showed that it has good power in practice for multivariate data , especially against fixed scale alternatives .",
    "later , henze and penrose @xcite proved that the statistic @xmath90 is asymptotically normal under @xmath85 and is consistent under all fixed alternatives .",
    "aldous and steele @xcite extended the mst graph functional to locally finite point sets using the prim s algorithm .",
    "moreover , by ( * ? ?",
    "* lemma 2.1 ) the mst graph functional @xmath81 stabilizes @xmath91 .      as in  , a multivariate two - sample test can be constructed using the @xmath0-nearest neighbor graph of @xmath92 .",
    "this was originally suggested by friedman and rafsky @xcite , and later studied by schilling @xcite and henze @xcite .",
    "[ knn ] given a nice finite set @xmath80 , the ( directed ) @xmath0-nearest neighbor graph ( @xmath0-nn ) is a graph with vertex set @xmath15 with a directed edge @xmath93 , for @xmath94 , if the euclidean distance between @xmath95 and @xmath96 is among the @xmath0-th smallest distances from @xmath95 to any other point in @xmath15 .",
    "denote the directed @xmath0-nn of @xmath15 by @xmath97 .",
    "given @xmath98 as in  , the @xmath0-nn statistic is @xmath99    schilling @xcite showed that the test based on the @xmath0-nearest neighbor graph is asymptotically normal under @xmath85 and consistent under fixed alternatives . )",
    "is slightly different from the test used by schilling ( * ? ? ?",
    "* section 2 ) , which can also be re - written as graph - based test  ( [ graph2test ] ) by allowing multiple edges in the @xmath0-nn graph . ]",
    "the @xmath0-nn graph , which can be naturally extended to locally finite points sets , stabilizes @xmath91 ( * ? ? ?",
    "* lemma 6.1 ) .      in this paper central limit theorems are derived for two - sample tests based on stabilizing geometric graphs under general alternatives , in the poissonized setting .",
    "they provide mathematical justifications for these tests and validates their various applications .",
    "in particular , this gives a way to compare the asymptotic performances of tests based on geometric graphs which have zero asymptotic pitman efficiency , complementing recent results by the author @xcite .",
    "the results are summarized below :    * it is shown that for tests based on stabilizing geometric graphs , such as the friedman - rafsky test   and the test based on the @xmath0-nearest - neighbor ( @xmath0-nn ) graph  , the graph - based two - sample test statistic has a limiting normal distribution , after centering by the conditional mean and scaling by @xmath100 ( theorem [ th : clt_r1 ] ) . * under the stronger assumption of _ exponential stabilization _",
    "@xcite , the conditional clt can be strengthened to obtain the central limit theorem ( clt ) of the graph - based two - sample statistic , when centered by the unconditional mean ( theorem [ clt_r2 ] ) .",
    "in particular , this implies the clt for the @xmath0-nn test under the alternative , in the poissonized setting . * as a consequence , local alternatives for which the @xmath0-nn based test have non - trivial ( bounded between 0 and 1 ) limiting power can be identified .",
    "in particular , in many situations the test based on the @xmath0-nn graph has power going to 1 , for alternatives shrinking towards the null slower than @xmath101 .",
    "this shows that though the @xmath0-nn test has zero asymptotic pitman efficiency , that is , no power against @xmath102 alternatives @xcite , it is often powerful against alternatives which shrink towards the null more slowly , in particular , at a rate slower than @xmath101 . in general , there are two exponents @xmath103 , depending on the dimension @xmath8 , such that the @xmath0-nn based test has no limiting power for alternatives shrinking towards the null faster than @xmath104 , and power going to 1 for alternatives shrinking towards the null at a rate slower than @xmath105 ( theorem [ effsecond ] ) .",
    "the rest of the paper is organized as follows : the general consistency result is stated in section  [ consistent ] .",
    "the central limit theorems for the statistic   are described in section  [ distribution ] .",
    "the application of these results to the @xmath0-nn graph functional is given in section  [ sec : knn ] .",
    "the proofs of the results are given in the appendix .",
    "the consistency of the test based on the @xmath0-nn graph was proved by schilling  @xcite and more generally by henze  @xcite . later , henze and penrose  @xcite proved the consistency of the fr - test .",
    "the arguments here show that the proof in  @xcite can be easily extended to any stabilizing graph functional , whenever the degree function satisfy the following moment condition :    ( degree moment condition ) a translation and scale invariant graph functional @xmath12 is said to satisfy the @xmath106-_degree moment condition _ if it stabilizes @xmath107 , for all @xmath108 , and @xmath109 where @xmath110 ranges over all finite subsets of @xmath3 .",
    "[ pdegree ]    the weak limit of the statistic @xmath111 is given in terms of the henze - penrose dissimilarity measure between the two density functions :    [ hpdiss]given @xmath112 and densities @xmath4 and @xmath5 in @xmath3 , the _ henze - penrose dissimilarity _ measure is defined as @xmath113 this belongs to a general class of separation measures between distributions @xcite .",
    "the following proposition gives the weak - limit of @xmath111 for stabilizing graph functionals satisfying the degree moment condition .",
    "the proof of the proposition is given in section  [ sec : pfconsistency ] .",
    "[ consistent]let @xmath12 be a translation and scale invariant directed graph functional which stabilizes @xmath107 for all @xmath114 . if @xmath12 satisfies the @xmath106-degree moment condition for @xmath115 , then @xmath116 where @xmath117 is the out - degree of the vertex zero in the graph @xmath118 .    using the asymptotic normality of @xmath119 under the null and the above result",
    ", it follows that the level @xmath51-test with rejection region   is consistent for all fixed alternatives ( [ test ] ) , since @xmath120 and the inequality is strict for densities @xmath4 and @xmath5 differing on a set of positive measure ( see ( * ? ? ?",
    "* theorem 1 and corollary 1 ) ) .",
    "this generalizes the results in  @xcite to stabilizing graph functionals .",
    "recently , arias - castro and pelletier  @xcite showed that rosenbaum s cross match test @xcite based on non - bipartite matching , has the same limit as in  , thus , it is also consistent for general alternatives .",
    "note that this does not follow from proposition  [ consistent ] , because it is unknown whether the nbm graph functional is stabilizing .",
    "this section describes the central limit theorems of the poissonized two sample statistic @xmath119 ( recall ) for stabilizing graph functionals .",
    "let @xmath4 and @xmath5 be two densities in @xmath3 , and @xmath121 note that @xmath122 uniformly over the support of @xmath123 .",
    "let @xmath124 be independent random variables with common density @xmath125 .",
    "then @xmath36 , where @xmath126 is independent of @xmath127 .",
    "let @xmath128 be the sigma - algebra generated by @xmath127 and the poisson random variable @xmath129 .    in this section ,",
    "the limiting distribution of @xmath130 is derived for stabilizing graph functionals .",
    "note that @xmath131 , where @xmath132 is the statistic centered by the conditional mean and scaled by @xmath100 , and @xmath133 is the centered conditional mean .",
    "the clt of   is derived in two steps : first , conditioning on @xmath134 , the clt of   is obtained for stabilizing graph functionals ( theorem  [ th : clt_r1 ] ) .",
    "then , under the stronger assumption of exponential stabilization ( definition  [ expstabilize ] ) , the clt of the conditional mean   is derived ( theorem  [ clt_r2 ] ) , which combined with the conditional clt of   gives the clt of   ( theorem  [ th : clt_r ] ) .      for a directed graph functional @xmath12 , @xmath13 finite and a point @xmath61 , let @xmath135 be the _ in - degree _ , @xmath136 be the _ out - degree _ , and @xmath137 be the _ total degree _ of the vertex @xmath63 in the graph @xmath64 .",
    "also , let @xmath138 be the number of outward 2-stars and inward 2-stars incident on @xmath63 in @xmath14 , respectively .",
    "finally , let @xmath139 be the number of 2-stars incident on @xmath63 in @xmath14 with different directions on the two edges . for notational brevity , denote @xmath140 and @xmath141 .",
    "similarly , let @xmath142 and @xmath143    to derive the clt of  , various assumptions are required on the graph functional @xmath12 . to begin with recall the degree moment condition  .",
    "another condition that is required is that the graph functional has bounded maximum degree .",
    "this is trivially satisfied by bounded degree graph functionals , such as the mst and the @xmath0-nn graph .",
    "the slightly weaker polynomial upper bound given below includes stabilizing geometric graphs with poly - logarithmic maximum degree , like the delaunay graph @xcite .",
    "[ assummaxdeg](maximum degree condition ) a graph functional @xmath12 is said to satisfy the _ maximum degree condition _ if @xmath144 for some @xmath145 .",
    "the following theorem gives the clt of   for stabilizing graph functionals satisfying the above conditions .",
    "[ th : clt_r1 ] let @xmath12 be a translation and scale invariant directed graph functional which stabilizes @xmath107 , for all @xmath114 . if @xmath12 satisfies the @xmath106-degree moment condition for @xmath115 and the maximum degree condition  , then @xmath146 where @xmath147 and @xmath148 .",
    "the proof of the theorem is given in section  [ sec : pfcltr1 ] .",
    "the limiting conditional variance of @xmath149 is derived using properties of stabilizing graphs ( lemma  [ var_r ] ) , and the clt is proved using stein s method based on dependency graphs .",
    "the limiting variance @xmath150 in   depends on the graph functional @xmath12 , the unknown densities @xmath4 and @xmath5 , and the limiting fraction @xmath151 of sample 1 . under the null distribution ( @xmath152 ) the expression simplifies to @xmath153 for example , when @xmath154 is the @xmath0-nn nearest neighbor graph functional , @xmath155 , @xmath156 , @xmath157 , @xmath158 , and   simplifies to @xmath159    for an undirected graph functional   further simplifies to @xmath160 since @xmath161 , @xmath162 , and @xmath163 . for the mst graph functional @xmath81 , @xmath164  ( * ? ? ?",
    "* lemma 7 ) , and   becomes @xmath165 .    in general there",
    "seem to be no closed form expressions for @xmath166 for the @xmath0-nn graph , or @xmath167 for the mst .",
    "to compute the rejection regions for these tests , the above quantities need to be estimated through simulations .",
    "for the mst , henze and penrose @xcite computed @xmath168 for small values of @xmath8 .",
    "they also computed @xmath169 , using earlier results of penrose @xcite , which can be a useful approximation when dimension is large .      proving the clt of the conditional mean is more difficult , and requires the stronger notion of exponential stabilization  @xcite . for any locally finite point set @xmath170 and @xmath61 ,",
    "define the _ out - degree measure _ of a graph functional @xmath12 as follows : for all borel sets @xmath171 @xmath172 where @xmath173 . in other words ,",
    "the out - degree measure of a set @xmath174 , with respect to @xmath175 and @xmath63 is the number of edges incident on @xmath63 with the other end point in @xmath176 in the graph @xmath177 .",
    "fix a locally finite point set @xmath175 , a point @xmath61 , and a borel set @xmath178",
    ". the _ radius of stabilization _ of the degree measure ( [ outdegmeasure ] ) at @xmath63 with respect to @xmath175 and @xmath174 ( to be denoted by @xmath179 ) is the smallest @xmath180 such that @xmath181 for all finite @xmath182 and all borel subsets @xmath183 , where @xmath78 is the ( euclidean ) ball of radius @xmath75 with center at the point @xmath79 . if no such @xmath75 exists , then set @xmath184 .",
    "let @xmath185 , where @xmath186 and @xmath187 are the supports of the densities @xmath4 and @xmath5 , respectively .",
    "recalling @xmath188 from   define :    [ expstabilize]let @xmath189 be the radius of stabilization of out - degree measure @xmath190 at @xmath63 with respect to the poisson process @xmath191 and the union of the supports @xmath192 .",
    "define , @xmath193 the out - degree measure @xmath190 is    * _ power law stabilizing of order _",
    "@xmath194 if @xmath195 , * _ exponentially stabilizing _ if @xmath196 .",
    "the above definition of exponential stabilization from definition  [ expstabilize ] is slightly different from ( * ? ? ?",
    "* definition 2.4 ) , because the density @xmath188 in the poisson process @xmath191 depends on @xmath58 .",
    "however , the proof in @xcite can be trivially modified to show the exponential stabilization of the @xmath0-nn graph functional ( see section [ pfknnexpstabilize ] for details ) .",
    "conditions on the decay of the tail of the radius of stabilization , similar to   above , is a standard requirement for proving limit theorems of functionals of random geometric graphs @xcite . using this machinery",
    ", the following theorem gives the clt of the conditional mean for exponentially stabilizing random geometric graphs . to this end , assume that @xmath197 and @xmath198 , as @xmath9 .",
    "[ clt_r2 ] let @xmath12 be a translation and scale invariant directed graph functional in @xmath3 which satisfies the @xmath106-degree moment condition   for @xmath199 .",
    "if the out - degree measure @xmath190 is power law stabilizing of order @xmath200 , then @xmath201 where @xmath202 moreover ,",
    "if @xmath190 is exponentially stabilizing then @xmath203    the proof of the theorem is given in section  [ pfcltr2 ] .",
    "combining theorem  [ th : clt_r1 ] and theorem  [ clt_r2 ] the clt of @xmath204 ( defined in  ) can be obtained .",
    "the proof is in section  [ pfcltr ] .",
    "[ th : clt_r ] let @xmath12 be a translation and scale invariant directed graph functional which satisfies the @xmath106-degree moment condition for @xmath115 and the maximum out - degree condition  . if the degree measure @xmath190 is exponentially stabilizing then @xmath205 where @xmath206 , and @xmath207 and @xmath208 are as defined in   and  , respectively .",
    "if @xmath154 is the @xmath0-nn nearest neighbor graph functional ,   reduces to @xmath209 under the null @xmath210 , this further reduces to @xmath211 .",
    "this is expected , because under the null @xmath212",
    "many random geometric graphs , such as the @xmath0-nn graph and the delaunay graph and @xmath213 , the locus of points closer to @xmath63 than to any other point in @xmath15 is called the _",
    "voronoi _ cell centered at @xmath63 .",
    "the graph with vertex set @xmath15 in which each pair of adjacent cell centers is connected by an edge is the _ delaunay graph _ of @xmath15 .",
    "the delaunay graph is exponentially stabilizing  ( * ? ? ?",
    "* section 6.3 ) ( see also  @xcite ) . ] are exponentially stabilizing , and theorem  [ th : clt_r ] can be used to obtain their asymptotic distributions . in particular , this provides mathematical justifications for the two - sample test statistic based on the @xmath0-nn graph functional , which has been used in various applications . moreover , using this asymptotic distribution , local alternatives that have non - trivial ( bounded between 0 and 1 ) limiting power can be identified , which provides a way to compare the asymptotic performances of the tests .",
    "assume that the densities @xmath4 , @xmath5 are bounded and almost everywhere continuous probability density functions in @xmath214 with bounded convex support , such that the union of their support @xmath215 is convex .",
    "in this case , the @xmath0-nn graph functional @xmath216 is exponentially stabilizing . in the poisson process @xmath191 depends on @xmath58 .",
    "nevertheless , the proof of ( * ? ? ?",
    "* theorem 6.4 ) can be easily modified to show the exponential stabilization of the out - degree measure for the @xmath0-nn graph functional @xmath216 , when @xmath4 and @xmath5 are as in corollary  [ cor : knn ] ( see lemma [ lmknnexp ] for more details ) . ]",
    "this shows the following corollary of theorem  [ th : clt_r ] :    [ cor : knn ] for the @xmath0-nn graph functional @xmath216 and @xmath217 as above , @xmath218 where @xmath219 , and @xmath220 is as defined in  .",
    "the @xmath216 graph functional is exponentially stabilizing and satisfies the degree moment condition for @xmath115 .",
    "therefore ,   holds with @xmath221 , where @xmath207 and @xmath208 are as defined in   and  , respectively .",
    "the result then follows from  .    under the null @xmath210 , using   and  , the asymptotic variance   simplifies to @xmath222 therefore , the two - sample test based on @xmath216 rejects when @xmath223 this test is asymptotically level @xmath51 and distribution free , and consistent against all fixed alternatives . in the following section ,",
    "we derive the power of this test against local alternatives .",
    "unfortunately , theorem  [ th : clt_r ] does not apply to the fr - test , because it is not known whether the mst is exponentially stabilizing .",
    "kesten and lee @xcite and later penrose  @xcite used a martingale method to derive central limit theorems for functionals of the mst defined on a homogeneous poisson process",
    ". it might be possible to leverage these techniques with the ideas developed in this section to prove a central limit theorem for the fr - test .      in @xcite",
    "it was shown that two - sample tests based on stabilizing graph functionals have zero pitman efficiency ( power against @xmath102 alternatives ) .",
    "this raises the question : does the @xmath0-nn test have power for alternatives shrinking towards the null at rate slower that @xmath102 ?",
    "corollary  [ cor : knn ] can be used to determine the rate at which the alternatives shrink toward the null , such that the @xmath0-nn test have non - trivial ( bounded by 0 and 1 ) limiting power .",
    "this can provide a way to compare between tests which have zero pitman efficiencies .    to this end , let @xmath224 be the parameter space and @xmath225 be a parametric family of distributions in @xmath3 with density @xmath226 .",
    "let @xmath40 and @xmath41 be samples from @xmath227 and @xmath228 as in  , respectively , and consider the testing problem @xmath229 for a sequence @xmath230 in @xmath231 , such that @xmath232 .",
    "the _ limiting power _ of the two - sample test based on @xmath12 is the probability of the rejection region   under the alternative @xmath233 above , as @xmath58 goes to infinity .",
    "[ assumptionlocalpower ] to derive the local power , the following assumptions on the family @xmath225 are needed :    a.   for all @xmath234 , the density @xmath226 has a compact and convex support @xmath13 , with a non - empty interior , not depending on @xmath235 .",
    "b.   @xmath236 , for all @xmath234 , where @xmath237 denotes the boundary of @xmath15 . c.   for all @xmath234 , the functions @xmath226 and @xmath238 are three times continuously differentiable in the interior of @xmath15 .",
    "d.   for all @xmath239 , @xmath240 is three times continuously differentiable in the interior of @xmath241 .",
    "define the _ critical exponents _ , @xmath242 the following theorem gives bounds on the rate at which the hypotheses should shrink toward each other to have no power or full power .",
    "( note that for a vector @xmath243 , @xmath244 denotes the euclidean norm of @xmath63 . )",
    "[ effsecond ] let @xmath245 and @xmath246 be as defined in  .",
    "consider the two - sample test based on the @xmath0-nn graph functional @xmath216 with rejection region   for the testing problem  .",
    "a.   if @xmath247 , the limiting power of the test   is @xmath51 .",
    "b.   if @xmath248 , the limiting power of the test   is @xmath249 .",
    "note that for @xmath250 , the bounds in the above theorem match , showing that for all hypothesis and all directions @xmath251 , the limiting power of the @xmath0-nn test has a sharp phase transition at @xmath252 . for @xmath253 ,",
    "the test has non - trivial limiting power , which can be computed from the proof of theorem [ effsecond ] .",
    "this is illustrated for the normal location problem in section [ sec : nlocation ] below .",
    "quite interestingly , the critical exponents @xmath245 and @xmath246 has a phase - transition at @xmath254 . the lower critical exponent @xmath245 decreases with @xmath8 to @xmath255 ( recall the @xmath0-nn test has no power for @xmath100 alternatives",
    "@xcite ) , and the upper critical exponent increases with @xmath8 to @xmath249 ( the @xmath0-nn test always has power against fixed alternatives ) .      let @xmath80 be a symmetric set is _ symmetric _ if @xmath213 implies @xmath256 .",
    "for example , @xmath257 , the @xmath8-dimensional unit ball , is a symmetric set in @xmath3 . ] containing the origin @xmath258 . for @xmath259 ,",
    "let @xmath260 be the normal distribution with mean @xmath261 and standard deviation 1 truncated to @xmath15 , that is , @xmath262 and @xmath263 where @xmath264 .",
    "denote by @xmath265 the expectation with respect to @xmath266 , and @xmath267 be the mean of the distribution .",
    "for a fixed symmetric set @xmath80 and @xmath268 , suppose @xmath269 are independent samples from @xmath270 and @xmath271 , respectively , and @xmath28 and @xmath29 are independent of each other and of @xmath272 .",
    "[ effnlocation ] consider the two - sample test based on the @xmath249-nn graph functional , with rejection region  , for distinguishing the samples in  .",
    "a.   if @xmath273 , the limiting power of the test is @xmath51 .",
    "b.   if @xmath274 , the limiting power of the test is @xmath249 . c.",
    "if @xmath275 , for some @xmath276 , the limiting power of the test is @xmath277 where @xmath278 is the volume of the unit ball in @xmath3 , and @xmath279 is as defined in  .    the proof of the result is given in section [ ch3:pfnlocation ] .",
    "in fact , proposition [ effnlocation ] easily generalizes to location problems for elliptical distributions .",
    "note that truncated normal distributions are considered , so that assumption [ assumptionlocalpower](a ) is satisfied .",
    "this is merely a technical condition , and it should be possible to replace this by assumptions of the tails of the distributions .",
    "the following example compares the power of the @xmath0-nn for the normal location problem in simulations .",
    "+     +    [ nlocationexnn ] consider the parametric family @xmath280 , for @xmath281 . to compute the empirical power ,",
    "consider i.i.d .",
    "samples @xmath17 and @xmath18 ( as in  ) from @xmath282 and @xmath283 , where @xmath251 is a sequence in @xmath284 converging to 0 .",
    "* figure  [ nlocation34 ] shows the empirical power ( as a function of @xmath285 , where @xmath275 ) of the hotelling s @xmath286 test ( which is the most powerful test in this case ) , the fr - test based on the mst , and the tests based on the 1-nn , 2-nn , and 3-nn graphs , repeated over 200 iterations over a grid of 20 values of @xmath285 in @xmath287 $ ] for dimension ( a ) @xmath288 and ( b ) @xmath289 , with sample sizes @xmath290 and @xmath291 .",
    "note that in both dimensions 3 and 4 , @xmath292 , and the tests based on geometric graphs have non - zero local power @xmath253 , as predicted by theorem  [ effsecond ] .",
    "+   + +   + * for dimension @xmath293 , @xmath294 .",
    "figure  [ nlocation10 ] shows the empirical power ( as a function of @xmath285 ) of the hotelling s @xmath286 test , the fr - test based on the mst , and the tests based on the 1-nn , 2-nn , and 3-nn graphs , repeated over 200 iterations over a grid of 20 values of @xmath285 in @xmath287 $ ] for dimension @xmath293 , with sample sizes @xmath295 and @xmath296 for ( a ) @xmath297 , and ( b ) @xmath275 .",
    "as expected , the hotelling s @xmath286 test has power converging to 1 in both cases .",
    "however , as shown in proposition [ effnlocation ] , the fr test and the @xmath0-nn test have little power ( as a function of @xmath285 ) in figure  [ nlocation10](a ) , but have non - trivial power in figure  [ nlocation10](b ) .",
    "99 d. aldous , d. and j. m. steele , asymptotics for euclidean minimal spanning trees on random points , _ probab . theory related fields _ , vol .",
    "92 , 247258 , 1992 .",
    "e. arias - castro and b. pelletier , on the consistency of the crossmatch test , arxiv:1509.05790 [ math.st ] , 2015 .",
    "b. aslan and g. zech , new test for the multivariate two - sample problem based on the concept of minimum energy , _ journal of statistical computation and simulation _ , vol .",
    "75 , 109119 , 2005 . l. baringhaus , and c. franz , on a new multivariate two - sample test , _ journal of multivariate analysis _",
    "88 , 190206 , 2004 . b. b. bhattacharya , power of graph - based two - sample tests , arxiv:1508.07530 , 2015 .",
    "p. j. bickel , a distribution free version of the smirnov two sample test in the @xmath151-variate case , _ annals of mathematical statistics _ ,",
    "40 , 123 , 1969 . m. biswas , m. mukhopadhyay , a. k. ghosh , a distribution - free two - sample run test applicable to high - dimensional data , _ biometrika _ , vol .",
    "101(4 ) , 913926 , 2014 . h. chen , and j. h. friedman , a new graph - based two - sample test for multivariate and object data , arxiv:1307.6294 [ stat.me ] , 2015 .",
    "l. h. y. chen and q .- m .",
    "shao , normal approximation under local dependence , _ ann .",
    "32 ( 3 ) , 19852028 , 2004 .",
    "j. h. friedman , and l. c. rafsky , multivariate generalizations of the wolfowitz and smirnov two - sample tests , _ ann .",
    "_ , vol . 7 , 697717 , 1979 . j. d. gibbons and s. chakraborty , _ nonparametric statistical inference _ , new york , marcel dekker , 2003",
    "a. gretton , k. borgwardt , m. rasch , b. scholkopf , and a. smola , a kernel two - sample test , _ journal of machine learning research _ , vol .",
    "16 , 723773 , 2012 .",
    "l. gyrfi , and t. nemetz , @xmath4-dissimilarity : a general class of separation measures of several probability measures , _ in topics in information theory .",
    "jnos bolyai _ , vol .",
    "16 , 309321 , 1975 . l. gyrfi , and t. nemetz , on the dissimilarity of probability measures , _ problems control inform .",
    "vol . 6 , 263267 , 1977 .",
    "p. hall and n. tajvidi , permutation tests for equality of distributions in high - dimensional settings , _ biometrika _ , vol .",
    "89 , 359374 , 2002 . n. henze , a multivariate two - sample test based on the number of nearest neighbor type coincidences , _ ann .",
    "16 , 772783 , 1988 .",
    "n. henze and m. d. penrose , on the multivariate runs test , _ the annals of statistics _ , vol .",
    "27 ( 1 ) , 290298 , 1999 . h. kesten and h. lee , the central limit theorem for weighted minimal spanning trees on random points , _ annals of applied probability _",
    "6 , 495527 , 1996 .",
    "r. y. liu , on a notion of data - depth - based on random simplices , _ ann .",
    "18 , 405414 , 1990 .",
    "r. y. liu and k. singh , a quality index based on data - depth and multivariate rank tests , _",
    "88 , 252260 , 1993 .",
    "maa , d. k. pearl , and r. bartoszy ' nski , reducing multidimensional two - sample data to one - dimensional interpoint comparisons , _ the annals of statistics _ , vol .",
    "24 ( 3 ) , 10691074 , 1996 . h. b. mann and d. r. whitney , on a test of whether one of two random variables is stochastically larger than the other , _ annals of mathematical statistics _ , vol .",
    "18(1 ) , 5060 , 1947 .",
    "m. d. penrose , the random minimal spanning tree in high dimensions , _ ann . probab .",
    "24 , 19031925 , 1996 . m. d. penrose , _ random geometric graphs _",
    ", oxford university press , 2003 . m. d. penrose , multivariate spatial central limit theorems with applications to percolation and spatial graphs , _ ann .",
    "33 ( 5 ) , 19451991 , 2005 .",
    "m. d. penrose , gaussian limits for random geometric measures , _ electronic journal of probability _ , vol .",
    "12 , 9891035 , 2007 . m. d. penrose and j. e. yukich , central limit theorems for some graphs in computational geometry , _ ann .",
    "11 , 10051041 , 2001 . m. d. penrose and j. e. yukich , weak laws of large numbers in geometric probability , _ ann .",
    "13 , 277303 , 2003 .",
    "p. r. rosenbaum , an exact distribution - free test comparing two multivariate distributions based on adjacency , _ journal of the royal statistical society : series b ( statistical methodology ) _ , vol .",
    "67 ( 4 ) , 515530 , 2005 .",
    "v. rousson , on distribution - free tests for the multivariate two - sample location - scale model , _",
    "80 , 4357 , 2002 .",
    "w. rudin , _ real and complex analysis _",
    "mcgraw - hill , new york , 1987 .",
    "m. f. schilling , multivariate two - sample tests based on nearest neighbor s , _",
    "81 , 799806 , 1986 . n. smirnoff , on the estimation of the discrepancy between empirical curves of distribution for two independent samples , _ bulletin de universite de moscow , serie internationale ( mathematiques ) _ , vol .",
    "2 , 314 , 1939 .",
    "j. w. tukey , mathematics and picturing data , _ in proc .",
    "vancouver 1974 _ , vol .",
    "2 , 523531 , 1975 . a. wald and j. wolfowitz , on a test whether two samples are from the same distribution , _ ann .",
    "11 , 147162 , 1940 . l. weiss , two - sample tests for multivariate distributions , _ the annals of mathematical statistics _ ,",
    "31 , 159164 , 1960 . j. yukich , limit theorems in discrete stochastic geometry , _ stochastic geometry , spatial statistics and random fields _ , lecture notes in mathematics , 2068 , 239275 , 2013 . y. zuo , projection based depth functions and associated medians , _ ann .",
    "31 , 14601490 , 2003 .",
    "y. zuo and x. he , on the limiting distributions of multivariate depth - based rank sum statistics and related tests , _ ann .",
    "34 , 28792896 , 2006 .",
    "in this section the asymptotic distribution of the two - sample test based on stabilizing geometric graphs in the poissonized setting is derived .",
    "the section is organized as follows : begin by recalling preliminaries about geometric graphs in section [ sec : preliminaries ] . in section [ sec : techlemmas ]",
    "a few technical lemmas are proved , which will be required to derive the asymptotic variance of the statistic .",
    "the consistency of these tests under general alternatives ( proposition [ consistent ] ) is given in section [ sec : pfconsistency ] .",
    "the proof of the conditionally centered clt of the test statistic ( theorem [ th : clt_r1 ] ) is described in section [ r ] .",
    "the clt of the conditional mean and the proofs of theorem [ clt_r2 ] and theorem [ th : clt_r ] are given in section [ sec : pfr2r ] .",
    "given a graph functional @xmath12 , recall that @xmath298 is a measurable @xmath299 valued function defined for all locally finite set @xmath300 and @xmath301 . for a function @xmath302 , define @xmath303 note that if both @xmath12 and @xmath123 are translation and scale invariant , then @xmath304 .",
    "moreover , if @xmath305 , is the poisson process of rate @xmath306 in @xmath3 , then @xmath307 , since @xmath308 .",
    "it follows from ( * ? ? ?",
    "* lemma 3.2 ) that , under appropriate moment conditions , @xmath309 converges to @xmath310 , where @xmath311 is a density in @xmath3 .",
    "the proof of ( * ? ? ? * lemma 3.2 ) can be easily modified to show that the same holds for any sequence of densities @xmath312 uniformly .",
    "( recall the definition of stabilizing functions of graph functionals ( definition [ stabilization ] ) . )",
    "[ poissonstabilize ] let @xmath12 be a translation and scale invariant graph functional in @xmath3 , and @xmath313 as in  .",
    "suppose @xmath302 is translation invariant and almost surely stabilizing on @xmath314 , with limit @xmath315 for all @xmath108 , and for @xmath316 @xmath317 where the set @xmath110 ranges over all finite subsets of @xmath3 .",
    "a.   then as @xmath9 , @xmath318 in expectation and in distribution .",
    "b.   for any @xmath66 , as @xmath9 , @xmath319 in expectation and in distribution .",
    "let @xmath320 be a homogeneous poisson process of rate 1 on @xmath321 .",
    "define coupled point processes @xmath322 and @xmath323 as follows : let @xmath322 be the image of the restriction of @xmath320 to the set @xmath324 under the projection @xmath325 . then @xmath322 is a poisson process in @xmath3 with intensity function @xmath326 , consisting of @xmath327 random points with common density @xmath188 . let @xmath323 be the restriction of @xmath320 to the set @xmath328 under the mapping @xmath329 .",
    "note that @xmath323 is a homogeneous poisson process on @xmath3 of intensity @xmath330 .    by (",
    "* lemma 3.1 ) ) , given @xmath331 and @xmath332 a lebesgue point of @xmath123 , @xmath333 hence , there exists @xmath0 such that for @xmath58 large enough , @xmath334 since @xmath302 stabilizes @xmath335 .",
    "this implies that @xmath336 . by assumption ( [ funcmoment ] ) , @xmath337 is uniformly integrable .",
    "therefore , @xmath338 this completes the proof of ( [ eq : mb1 ] ) .    to prove ( [ eq : mb2 ] ) consider a slight modification of the same coupling : let @xmath320 be a homogeneous poisson process of rate 1 on @xmath321 .",
    "define coupled point processes @xmath322 and @xmath323 : let @xmath322 be the image of the restriction of @xmath320 to the set @xmath324 under the projection @xmath325 .",
    "also , let @xmath323 be the restriction of @xmath320 to the set @xmath339 under the mapping @xmath340 .",
    "@xmath323 is a homogeneous poisson process on @xmath3 of intensity @xmath330 .",
    "now , by ( * ? ? ?",
    "* lemma 3.1 ) @xmath341 by stabilization , as in ( [ eq : g1 ] ) , it follows that @xmath342 the convergence in expectation follows from uniform integrability by assumption ( [ funcmoment ] ) .",
    "in this section a few technical lemmas required for deriving the limit of the conditional variance in theorem  [ th : clt_r1 ] are proved .",
    "begin with a few definitions : for @xmath171 , denote by @xmath343 the lebesgue measure of the set @xmath174 .",
    "is also used to denote the cardinality of a finite set @xmath15 , depending on the context . ]",
    "a point @xmath61 is a _",
    "lebesgue point _ of @xmath123 if @xmath344 where @xmath345 is the euclidean ball in @xmath3 with center at @xmath63 and radius @xmath346 .",
    "almost every point @xmath61 is a lebesgue point of @xmath123 ( * ? ? ?",
    "* theorem 7.7 ) .",
    "let @xmath313 as in  , and @xmath347 $ ] a symmetric and jointly measurable function , such that for almost every @xmath61 , @xmath348 is measurable and @xmath63 a lebesgue point of the function @xmath349 .",
    "define @xmath350    [ lem : hzz ] let @xmath12 be a translation and scale invariant graph functional in @xmath3 which satisfies the @xmath106-degree moment condition   for @xmath199 . then for @xmath347",
    "$ ] as above @xmath351 if @xmath332 is a lebesgue point of @xmath123 and @xmath352 .",
    "moreover , as @xmath9 , @xmath353    the lemma is proved below in section  [ pfhzz ] .",
    "the same proof shows that @xmath354 where @xmath355 and @xmath356 is as defined in  .",
    "next , define @xmath357 $ ] as follows : @xmath358 and @xmath359 let @xmath360 and @xmath361 where @xmath188 is defined in  .",
    "[ lem : hzzz ] let @xmath12 be an translation and scale invariant graph functional in @xmath3 which satisfies the @xmath106-degree moment condition   for @xmath115 .",
    "then @xmath362 for @xmath363 as in  .",
    "the same result holds for @xmath364 , with @xmath365 replaced by @xmath366 , and @xmath363 replaced by @xmath367 .",
    "the proof of lemma  [ lem : hzz ] is given in section  [ pfhzz ] .",
    "the proof of lemma  [ lem : hzzz ] is described in section  [ pfwzzz ] .",
    "the proof of lemma [ lem : hzz ] is organized as follows : begin with the proof of   below .",
    "this together with uniform integrability , which follows from the degree moment condition  , implies the convergence in expectation in . following this the convergence of ( [ hzz ] ) in @xmath368",
    "is shown , by computing the limit of the second moment . + * _ proof of   and convergence in expectation _ * : fix @xmath331 . by the palm theory of poisson processes  ( * ? ? ?",
    "* theorem 1.6 ) , @xmath369 which tends to zero as @xmath9 , if @xmath332 is a lebesgue point of both @xmath123 and @xmath370 .",
    "since @xmath285 has range @xmath371 $ ] , this implies that @xmath372 where @xmath373 is the number of edges @xmath374 incident on @xmath332 such that @xmath375 . since @xmath12 is stabilizes @xmath107 for all @xmath108 , the functions @xmath376 and @xmath377 defined on @xmath12 stabilizes @xmath378 , for all @xmath108 ( as in definition  [ stabilization ] ) .",
    "therefore , by lemma [ poissonstabilize ] , @xmath379 now , recall the definition of @xmath380 from  . from ( [ explimiti ] ) and ( [ explimitii ] ) and",
    "lemma  [ poissonstabilize ] , it follows that for every @xmath332 which is a lebesgue point of @xmath123 and @xmath352 , @xmath381 where the last equality uses @xmath12 is scale invariant .",
    "therefore , as @xmath9 @xmath382 by ( [ explimitiii ] ) and the dominated convergence theorem .",
    "+ * _ proof of   ( convergence in @xmath368 ) _ * : by the palm theory of poisson processes  ( * ? ?",
    "* theorem 1.6 ) , @xmath383 where @xmath384    since @xmath285 is bounded in @xmath371 $ ] , @xmath385 , as ( [ degmoment ] ) holds for @xmath386 .",
    "thus , @xmath387 , and the first term in ( [ exp2 ] ) goes to 0 as @xmath9 .    therefore , it suffices to consider @xmath388 .",
    "fix @xmath331 and let @xmath389 and @xmath390 be lebesgue points of @xmath123 .",
    "define @xmath391 .",
    "then by triangle inequality , for almost all @xmath392 @xmath393 as @xmath9 .",
    "similarly , if @xmath392 are lebesgue points of @xmath394 and @xmath395 , respectively , then as @xmath9 @xmath396    let @xmath397 . then , since @xmath285 has range @xmath371 $ ] , ( [ exp2t1 ] ) and ( [ exp2t2 ] ) gives @xmath398 where @xmath399 by lemma  [ poissonstabilize ] , since ( [ degmoment ] ) holds for @xmath386 .",
    "similarly , @xmath400 combining   and   and taking @xmath401 it follows that the lhs of  ( [ exp21 ] ) goes to zero .",
    "therefore , @xmath402 for @xmath392 lebesgue points of @xmath123 and @xmath403 and @xmath404 , respectively .",
    "now , by a modification of the coupling argument used in lemma [ poissonstabilize ] , similar to the proof of ( * ? ? ?",
    "* lemma 3.1 ) , it can be shown that @xmath405 where the last step uses @xmath12 is scale invariant .",
    "combining ( [ exp23 ] ) with ( [ exp22 ] ) gives @xmath406 thus , taking limit as @xmath407 in ( [ exp2 ] ) gives @xmath408 where @xmath409 is defined in ( [ exp1limit ] ) .",
    "combining ( [ exp1limit ] ) and ( [ exp2limit ] ) gives the @xmath368 convergence in ( [ hzz ] ) .",
    "+ * _ proof of  _ * : it follows from  ,  , and   that if @xmath332 is a lebesgue point of both @xmath123 and @xmath370 , then @xmath410 lemma  [ poissonstabilize ] then implies that @xmath411 , where @xmath412 is as defined in  .",
    "this shows convergence in expectation .",
    "the @xmath368 convergence is similar to the proof of  .",
    "the proof is very similar to lemma [ lem : hzz ] . without loss of generality consider the function @xmath363 defined in   ( the proof for @xmath367 is identical ) .",
    "fix @xmath331 .",
    "define @xmath413 , then by palm theory , @xmath414 since @xmath415 uniformly .",
    "note that @xmath416 therefore , if @xmath332 is a lebesgue point of both @xmath4 and @xmath5 , then , as @xmath9 , @xmath417 moreover , @xmath418 and by the lebesgue differentiation theorem @xmath419 combining ( [ phi21 ] ) and ( [ phi22 ] ) gives @xmath420 the triangle inequality combined with ( [ exphzzz1 ] ) and ( [ exphzzz2 ] ) implies that the rhs of ( [ exphzzz ] ) goes to 0 as @xmath9 .",
    "this implies that @xmath421 where @xmath422 now , since @xmath12 stabilizes @xmath107 for all @xmath108 , the function @xmath423 and hence @xmath424 stabilizes @xmath378 , for all @xmath108 .",
    "moreover , @xmath425 satisfies the bounded moment condition ( [ funcmoment ] ) for @xmath426 , since @xmath427 satisfies ( [ degmoment ] ) for some @xmath386 .",
    "therefore , by lemma [ poissonstabilize ] , @xmath428    from ( [ hzzzi ] ) and ( [ hzzzii ] ) it follows that for every @xmath332 which is a lebesgue point of both @xmath4 and @xmath5 , @xmath429 where ( [ hzzziiia ] ) uses lemma [ poissonstabilize ] and ( [ hzzziiib ] ) uses @xmath12 is scale invariant .",
    "therefore , by the dominated convergence theorem , @xmath430    now , as in lemma  [ lem : hzz ] , it can be shown that the second moment of the quantity @xmath431 converges to @xmath432 .",
    "this proves the @xmath368 convergence of ( [ hzzz ] ) .",
    "recall from the definition of @xmath119 .",
    "define @xmath433 note that @xmath434 , uniformly in @xmath435 as @xmath9 . then , with @xmath188 and @xmath123 as in  , using lemma  [ hzz ] @xmath436 where @xmath437 and is @xmath438 is defined in  .",
    "the limit in   shows convergence in expectation . to show convergence in probability ,",
    "compute @xmath439 from   it follows that @xmath440 .",
    "moreover , by lemma  [ var_r ] below , @xmath441 this implies @xmath442 , completing the proof of  .",
    "this section is organized as follows : section  [ pfconditionalvar ] below derives the limit of the conditional variance , using results proved in section  [ sec : techlemmas ] .",
    "the proof of the clt is given in section  [ pfcondclt ] .",
    "the limit of the conditional variance @xmath443 can be computed as a function of the graph functional @xmath12 and the unknown densities @xmath4 , @xmath5 .",
    "[ var_r ] let @xmath12 as in theorem  [ th : clt_r1 ] and @xmath149 as in ( [ r1 ] ) .",
    "then , @xmath444 where @xmath445 is as defined in theorem  [ th : clt_r1 ] .",
    "define the function @xmath446 $ ] as @xmath447 by construction @xmath92 is a poisson process in @xmath3 with intensity function @xmath448 , where @xmath122 uniformly as @xmath9 ( as defined in  ) .",
    "therefore , for @xmath449 @xmath450 .",
    "moreover , @xmath451 uniformly in @xmath435 as @xmath9 .",
    "now , let @xmath452 then by ( [ r1 ] ) , @xmath453 .",
    "therefore , @xmath454 by lemma [ lem : hzz ] , as @xmath9 , @xmath455    it remains to compute the limit of the covariance term in ( [ var_q ] ) .",
    "to this end , observe that @xmath456 where @xmath457 where @xmath458 is defined in  .",
    "the convergence above is uniformly in @xmath459 , as @xmath9 .",
    "therefore , by lemma [ lem : hzzz ] , @xmath460 where @xmath461 is as defined in  . similarly , define @xmath462 where @xmath463 is defined in  .",
    "then , by lemma [ lem : hzzz ] , @xmath464 where @xmath465 is as defined in  .",
    "similarly , it can be shown that @xmath466 where @xmath467 is as defined in  .    also , from   @xmath468 where @xmath412 is as defined in  .",
    "finally , observe @xmath469 and @xmath470 and @xmath471 .",
    "using this , and combining together ( [ var3 ] ) , ( [ var4 ] ) , ( [ var5 ] ) , ( [ var6 ] ) with ( [ var_q ] ) , the limit in   follows .",
    "the clt of @xmath472 will be proved using stein s method based on dependency graphs given below :    [ th : steinsmethod ] let @xmath473 be random variables indexed by the vertices of a dependency graph @xmath474 with maximum degree @xmath475 .",
    "if @xmath476 with @xmath477 , @xmath478 and @xmath479 for all @xmath480 and for some @xmath481 , then @xmath482    using this , the proposition below shows that the statistic @xmath119 , centered by the conditional mean and scaled by the conditional variance converges to @xmath483 .",
    "this , along with lemma  [ var_r ] , completes the proof of theorem  [ th : clt_r1 ] .",
    "[ cltr1 ] let @xmath119 be as defined in   and @xmath484 the standard normal distribution function .",
    "then for all @xmath485 , @xmath486    let @xmath487 .",
    "recall the definition of @xmath488 from ( [ v ] ) and let @xmath489 note that @xmath490 , and @xmath491 and @xmath492 .",
    "let @xmath475 be the maximum degree of dependency graph of the random variables @xmath493 .",
    "it is easy to see that @xmath494 , by assumption [ assummaxdeg ] .",
    "moreover , for @xmath495 @xmath496    therefore , by theorem [ th : steinsmethod ] above , conditional on @xmath134 , @xmath497 note that @xmath498 , as @xmath499 is a poisson random variable with mean @xmath58 , and by lemma [ var_r ] , @xmath500 .",
    "therefore , ( [ ste ] ) goes to zero in probability , since @xmath501 , by assumption [ assummaxdeg ] .",
    "this completes the proof of ( [ clt_r ] ) .",
    "the proof of theorem [ clt_r2 ] is given in section  [ pfcltr2 ] below .",
    "theorems [ th : clt_r1 ] and [ clt_r2 ] can be easily combined to complete the proof of theorem  [ th : clt_r ] ( see section  [ pfcltr ] ) .",
    "recall the definition of @xmath502 from  .",
    "note that @xmath434 , uniformly in @xmath435 as @xmath9 .",
    "it is easy to see that @xmath503 since @xmath197 and @xmath198 .",
    "therefore , for any @xmath504 @xmath505 for @xmath58 large enough . by stabilization , @xmath506 , as @xmath9 . therefore , the rhs above is arbitrarily small as @xmath9 , and @xmath507 where @xmath508 .",
    "let @xmath509 .",
    "for @xmath61 , a locally finite point set @xmath175 and any borel set @xmath178 , define @xmath510 where @xmath511 is the out - degree measure defined in  .",
    "let @xmath512 and @xmath513 .",
    "therefore , @xmath514 and @xmath515 thus , from   @xmath516    _ proof of  _ : by ( * ? ? ?",
    "* lemma 4.1 ) @xmath517 where @xmath518 , and @xmath519 where @xmath520 .    from lemma  [ hzz ] and",
    "the assumption that @xmath12 is @xmath106-degree bounded for @xmath115 , we get @xmath521 therefore , to compute of  , it suffices to derive the limit of the @xmath522 . to this end",
    ", we have the following lemma , which is proved similarly to lemma [ hzz ] .",
    "let @xmath12 be as in theorem  [ clt_r2 ] .",
    "for @xmath63 a lebesgue point of @xmath123 and @xmath523 , @xmath524 moreover , any @xmath525 and @xmath520 , @xmath526    the limit in ( [ eq : vx ] ) follows from   in lemma [ hzz ] , since @xmath527 .",
    "it remains to show  . by the palm theory of poisson processes (",
    "* theorem 1.6 ) , @xmath528 which tends to zero as @xmath9 , if @xmath332 is a lebesgue point of both @xmath123 and @xmath523 .",
    "since @xmath529 has range @xmath371 $ ] , this implies that @xmath530 where @xmath531 therefore , by lemma [ poissonstabilize](b ) , @xmath532 from ( [ ei ] ) and ( [ eii ] ) , for every @xmath63 which is a lebesgue point of @xmath123 and @xmath523 , @xmath533 completing the proof of  .    by (",
    "* lemma 3.6 ) it follows that @xmath534 moreover , since @xmath12 is @xmath106-degree moment bounded for @xmath115 by assumption , the lhs above is uniformly integrable , which implies the convergence in expectation .",
    "this is summarized in the following lemma :    [ penrose ( * ? ? ?",
    "* lemma 3.6 ) ] [ degjoint]let @xmath12 be as in theorem  [ clt_r2 ] . for every lebesgue point @xmath63 of @xmath123 and any @xmath525 , @xmath535    using this the limit of @xmath522 ( defined in  ) can be derived .",
    "the limit in   then follows from   and the following lemma .",
    "let @xmath12 be as in theorem  [ clt_r2 ] and @xmath522 as in  .",
    "then as @xmath9 @xmath536    let @xmath537 . since @xmath12 is power - law",
    "stabilizing ( recall definition  [ expstabilize ] ) , by ( * ? ? ?",
    "* theorem 2.1 ) and lemma  [ degjoint ] it follows that @xmath538 note that @xmath539 by the scale invariance of the degree function .",
    "now , substituting @xmath540 in  , the result follows .    _",
    "proof of  _ the proof of the central limit theorem follows from ( * ? ? ?",
    "* theorem 2.2 ) ( the slight modification required to adapt the result in our setup is straightforward and the details are omitted ) .",
    "recall from   and  , @xmath131 .",
    "let @xmath445 and @xmath541 be as defined in theorems  [ th : clt_r1 ] and  [ clt_r2 ] , and @xmath542 .",
    "then , for @xmath543 , from proposition  [ cltr1 ] and theorem  [ th : clt_r1 ] , @xmath544    now , by the dominated convergence theorem @xmath545 and the proof is complete .",
    "recall the definition of exponential stabilization from definition  [ expstabilize ] .",
    "note that this is slightly different from ( * ? ? ?",
    "* definition 2.4 ) , because the density @xmath188 in the poisson process @xmath191 depends on @xmath58 .",
    "nevertheless , the proof of ( * ? ? ?",
    "* theorem 6.4 ) can be trivially modified to show the exponential stabilization of the out - degree measure for the @xmath0-nn graph functional @xmath216 , as shown below :    [ lmknnexp]for @xmath4 and @xmath5 be as in corollary  [ cor : knn ] , the out - degree measure @xmath546 is exponetially stabilizing for the @xmath0-nearest neighbor graph functional @xmath216 .",
    "suppose @xmath4 and @xmath5 are both supported on some bounded convex set @xmath547 .",
    "let @xmath548 be a finite collection of infinite open cones in @xmath3 with angular radius @xmath549 and apex at @xmath79 .",
    "for @xmath550 and @xmath551 $ ] denote by @xmath552 the translate if @xmath553 with apex at @xmath63 , and @xmath554 the open cone concentric to @xmath552 with apex @xmath63 and angular radius @xmath555 . for",
    "@xmath556 and @xmath551 $ ] , let @xmath557 be the distance from @xmath63 to @xmath0-th nearest neighbor of @xmath63 in @xmath558 , if such a point exists and is less than the diameter of @xmath559 . otherwise , set @xmath557 to be the diameter of @xmath560 .",
    "define @xmath561}r_i(x)$ ] .",
    "it follows from penrose ( * ? ? ?",
    "* section 6.3 ) that for every @xmath562 , @xmath563 .    to show exponential stabilization ,",
    "we begin by bounding @xmath564 . this probability is zero unless @xmath565 . in this case , choose @xmath566 such that @xmath567 . by the convexity of @xmath559 , @xmath568 .",
    "note that @xmath569 .",
    "hence , if the @xmath570 contains less than @xmath0 points of @xmath191 , then @xmath571 . therefore , there exists a constant @xmath572 ( independent of @xmath573 , @xmath63 , @xmath574 ) such that @xmath575 which implies that @xmath576 .",
    "this implies that @xmath577 and the exponential stabilization of the degree function for the @xmath0-nn graph functional follows .",
    "in this section the proofs of theorem  [ effsecond ] and proposition [ effnlocation ] are presented . to simplify calculations ,",
    "the theorem is proved for @xmath578 .",
    "the proof for general @xmath0 can be done similarly .      under the null , @xmath584 .",
    "thus , to derive power against local alternatives , the distribution of @xmath585 has to be derived , when @xmath586 . note that @xmath587 where @xmath588 , where , as in  , @xmath589 .",
    "therefore , it suffices to derive the limit of @xmath590 where @xmath591 is the gradient vector , and @xmath592 is the hessian matrix of @xmath593 , at @xmath594 , and the error term @xmath595 for some @xmath596 .",
    "the rest of the section is organized as follows : the limits of the gradient term and the hessian term are derived in section  [ gradientlimit ] and section  [ hessianlimit ] , respectively .",
    "the proof of theorem  [ effsecond ] is then completed in section  [ pfcomp ] , by analyzing the error term .",
    "recall that @xmath597 is the 1-nn graph on the poisson process of rate 1 in @xmath3 , with the point @xmath598 added to it . for @xmath599 , define @xmath600 to be the expected length of the @xmath574-th power of the outward edge incident on @xmath598 in the graph @xmath597 .",
    "note that @xmath601 where @xmath278 and @xmath602 is the volume and the surface area of the unit ball in @xmath3 , respectively .",
    "similarly , @xmath603          recall the definition of @xmath593 from  .",
    "note that for @xmath607 in the interior of @xmath15 , @xmath608 where @xmath609 . then differentiating with respect to @xmath610 under the integral sign gives , @xmath611 therefore , @xmath612 , where @xmath613                  choose @xmath631 small enough so that @xmath632 . note that , for all @xmath633 , @xmath634 , by symmetry .",
    "thus , by the taylor series expansion of @xmath635 around @xmath63 , @xmath636 where @xmath602 is the surface area of the unit ball in @xmath3 . consider the spectral decomposition @xmath637 , where @xmath638 is the diagonal matrix of eigenvalues of the hessian matrix @xmath639 .",
    "under orthogonal the transformation @xmath640 ,                      to begin with , bound the @xmath666 term .",
    "observe that for @xmath213 , @xmath667 the first inequality follows by the variable change @xmath668 , the second equality uses symmetry , and the last inequality uses observation [ obsintconv ] .",
    "now , as in proposition [ dd+1 ] , @xmath669 where @xmath670 by the uniform boundedness of the spectral norm ( assumption [ assumptionlocalpower](c ) ) . then using , @xmath671 the second inequality uses @xmath672 , the cauchy - schwarz inequality , and the fact @xmath673 ( assumption [ assumptionlocalpower](c ) ) .",
    "this implies that @xmath674    next , we bound the @xmath675 term .",
    "as in , @xmath676 by assumption [ assumptionlocalpower](c ) , the maximum eigenvalue of @xmath677 is uniformly bounded , that is , @xmath678 . then by and the expansion of @xmath679 as above , @xmath680 , since @xmath681 .",
    "it remains to bound @xmath682 .",
    "first , by the transformation @xmath683 , @xmath684 by observation [ obsintconv ] , the convergence above is exponentially fast . therefore , ignoring this exponentially small error term , and following arguments as and , ( using @xmath672 and @xmath685 ) , @xmath686        by assumption  [ assumptionlocalpower](b ) all the points in @xmath690 are in the interior of the support @xmath15 of @xmath691 with probability 1 .",
    "the taylor - series expansion of @xmath692 around @xmath63 gives , @xmath693 where @xmath694 for some @xmath665 .",
    "finally , as @xmath692 is twice continuously differentiable over a compact set @xmath15 , the spectral norm of the hessian of @xmath692 is bounded , and @xmath701 by ( * ? ? ?",
    "* corollary 8.1 ) .",
    "this completes the proof of the result .    *",
    "_ proof of lemma _  [ t1limit]*(a ) : recall from that @xmath702 then by proposition  [ t1ppn ] ( with @xmath703 ) , @xmath704 + * _ proof of lemma _  [ t1limit]*(b ) : [ pft2limit ] recall from   that @xmath705 where @xmath706 for @xmath707 and @xmath660 .",
    "let @xmath708 .",
    "then it is easy to see that @xmath709 and @xmath710 , for all @xmath646 $ ] .",
    "moreover , by proposition [ dd+1 ] , @xmath711 , and by the taylor series expansion of @xmath712 around 0 , @xmath713 ( recall the definition of @xmath615 from ) , where @xmath714 for some @xmath715 . by proposition [ dd+1 ] , @xmath716 and @xmath717 by proposition [ ppn : dw ] ( with @xmath718 and @xmath719 )",
    ".    finally , by assumption [ assumptionlocalpower ] , @xmath720 , and using  ( * ? ? ?",
    "* theorem 2.5 ) , it is easy to verify that , @xmath721 lemma  [ t1limit](b ) now follows from and   above , and by recalling @xmath713 .",
    "+          * _ proof of proposition  [ hessianppn ] _ * : recall the definition of @xmath593 from  . differentiating with respect to @xmath610 twice under the integral signs gives , @xmath723 where @xmath724 .",
    "therefore , @xmath725 , where @xmath726 where @xmath727 is defined in .",
    "the limit of @xmath728 , @xmath729 , @xmath730 , and @xmath731 are given in the following lemma .",
    "using this proposition  [ hessianppn ] follows .",
    "recall the definition of the error term .",
    "first , it is shown that @xmath746 , for @xmath747 , where @xmath245 is as defined in  . to this end , define @xmath748 note that the error term @xmath749 , where @xmath750 .",
    "control of the error term , needs the third derivatives of @xmath593 with respect to @xmath610 .",
    "this involves several terms which can computed by taking another derivative with respect to @xmath610 of the hessian of @xmath593 in .",
    "each of the resulting terms can be bounded in a similar manner . in the following ,",
    "this is illustrated for one such term @xmath751 , obtained by taking the derivative of @xmath752 with respect to @xmath610 of the fourth term in .",
    "let @xmath753 is be positive constant depending on @xmath8 .",
    "let @xmath754 , by assumption .",
    "then for @xmath58 large , @xmath755 using ( * ? ? ?",
    "* corollary 8.4 ) .",
    "the other terms in the third derivative can be also be bounded similarly .",
    "this implies that @xmath756 .",
    "recall @xmath245 defined in .",
    "now , let @xmath757 such that @xmath758 .",
    "taking @xmath759 in it follows that @xmath746 . also , by proposition [ gradppn ] and proposition [ hessianppn ] @xmath760 and @xmath761 , respectively .",
    "then by , @xmath762 and limiting power of the test   is @xmath51 .",
    "next , suppose @xmath250 and @xmath763 is such that @xmath764 . by proposition [ hessianppn ] , @xmath765 .",
    "moreover , from above ( taking @xmath766 ) , @xmath767 , and @xmath768 , whenever @xmath769 .",
    "also , by proposition [ gradppn ] , @xmath770 , which shows that @xmath771 , and the limiting power of the test   is 1 .",
    "finally , suppose @xmath772 and @xmath773 is such that @xmath764 .",
    "then by proposition [ gradppn ] , @xmath774 , and by proposition [ hessianppn ] @xmath775 .",
    "moreover , from above , @xmath776 , and the hessian term @xmath777 , whenever @xmath232 .",
    "therefore , the hessian term dominates and @xmath771 , completeing the proof of the result .",
    "recall that the gradient term @xmath781 , where @xmath614 and @xmath615 are defined in . by symmetry of @xmath15 , when @xmath782 , then @xmath783 . then by , @xmath784 .",
    "then , @xmath785 since @xmath786 and @xmath787 , by symmetry ."
  ],
  "abstract_text": [
    "<S> in this paper central limit theorems are derived for multivariate two - sample tests based on stabilizing geometric graphs under general alternatives , in the poissonized setting . for tests based on stabilizing graphs , such as the friedman - rafsky test  @xcite and the test based on the @xmath0-nearest neighbor ( @xmath0-nn ) graph  @xcite , </S>",
    "<S> the statistic has a limiting normal distribution , after centering by the conditional mean and an appropriate scaling . for the @xmath0-nn graph and , </S>",
    "<S> more generally , for exponentially stabilizing graphs , this can be strengthened to obtain the clt of the statistic when centered by the unconditional mean . as a consequence , local alternatives for which the @xmath0-nn based test have non - trivial ( bounded between 0 and 1 ) limiting power can be identified . </S>",
    "<S> this validates various applications of these tests and provides a way to compare their asymptotic performances .    </S>",
    "<S> central limit theorem , hypopaper testing , geometric graphs , stein s method . </S>"
  ]
}