{
  "article_text": [
    "the maximum work theorem , a consequence of the second law of thermodynamics , states that the amount of work performed _ by _ a thermodynamic system during a transformation from a specific initial state @xmath0 to a specific final state @xmath1 is less than energy difference between the two states @xcite .",
    "the work @xmath2 is maximum and equal to the free energy difference , or _",
    "reversible work _ , if the transformation is carried out reversibly .",
    "equivalently , the average work performed _ on _ a system during such a transformation is bounded from below by the free energy difference @xmath3 , @xmath4 the notation @xmath5 implies an average over many in general irreversible transformations initiated in an equilibrium state .",
    "( for macroscopic systems every individual transformation will require the same amount of work but for small systems work fluctuations occur . )",
    "remarkably , the inequality ( [ equ : clausius ] ) can be turned into an equality by considering exponential averages @xcite , @xmath6 where @xmath7 is the inverse temperature and @xmath8 is boltzmann s constant .",
    "this identity , proven by jarzynski @xcite and later by crooks @xcite under very general conditions , relates the statistics of irreversible work to equilibrium free energy differences .",
    "the jarzynski identity can be used to calculate free energy differences in computer simulations of molecular systems @xcite . in statistical mechanical terms the free energy difference @xmath9 between a system at temperature @xmath10 with hamiltonian @xmath11 and another one at the same temperature with hamiltonian @xmath12",
    "is given by @xmath13 where the integration extends over the entire phase space and @xmath14 includes the positions @xmath15 and momenta @xmath16 of all particles . in the above equation ,",
    "@xmath17 and @xmath18 are the canonical partitions functions of systems @xmath0 and @xmath1 . to calculate @xmath3 using jarzynski s identity we introduce a parameter dependent hamiltonian @xmath19 defined such that @xmath20 and @xmath21 are obtained for particular values of the control parameter , @xmath22 and @xmath23 . by switching the control parameter @xmath24 from @xmath25 to @xmath26",
    "we can continuously transform @xmath12 into @xmath11 .",
    "if this is done over a time @xmath27 , while the system evolves from particular initial conditions @xmath28 , the work performed on the system is @xmath29 its value depends on the initial conditions @xmath28 and on the particular way the control parameter @xmath30 is switched from its initial to its final value . according to jarzynski s identity , the free energy difference can be evaluated by averaging the work exponential @xmath31 over many such transformations .",
    "specifically , this average is performed over a canonical distribution of initial conditions in the initial equilibrium state , @xmath32 where @xmath33 .    in fast switching simulations based on the jarzynski identity ,",
    "non - equilibrium trajectories are generated by approximately integrating the equation of motion , typically through a truncated taylor expansion of the time - evolving phase space point @xmath34 .",
    "the fidelity of trajectories obtained in this way to true microscopic dynamics is determined by the time interval over which a low - order taylor expansion is assumed to be accurate .",
    "usually , the time step is chosen to be small , so that the total energy is nearly conserved when control parameters are held constant ( in an isolated system ) @xcite . in this paper",
    "we show that fast switching trajectories integrated with large time steps , while perhaps poor simulations of dynamics , suffice to compute _ exact _ free energy differences .",
    "this new approach , which can increase the efficiency of fast switching simulations by up to two orders of magnitude , is based on a generalization of jarzynski s identity for general phase space mappings@xcite .",
    "jarzynski s original expression corresponds to the particular phase space mapping provided by the dynamical propagator .",
    "his result is valid , however , for any invertible phase space mapping .",
    "one could just as well use a concatenation of highly approximate molecular dynamics steps , the result of integrating equations of motion to low order over large time intervals , to map points in phase space .",
    "although such large time step trajectories are not accurate dynamical pathways , expressions for the free energy remain exact . due to the reduced cost of large time step trajectories",
    ", a considerable efficiency increase is possible .",
    "the remainder of the paper is organized as follows .",
    "the formalism and the justification of the large time step approach are presented in section [ sec : formalism ] .",
    "the efficiency of the resulting algorithm is discussed in section [ sec : efficiency ] . in section [ sec : numerical ] we demonstrate the validity of this algorithm by calculating the reversible work to transform a simple one - dimensional energy landscape , and that to drag a particle through a lennard - jones fluid .",
    "conclusions are given in section [ sec : conclusion ] .",
    "the deterministic time evolution of a classical many - particle system can be viewed as mapping every point in phase space to another : a system initially at @xmath28 will be located at @xmath35 after a time @xmath36 .",
    "the function @xmath37 is called the _ propagator _ of the system . since the system evolves deterministically the point @xmath38 is completely determined by the initial conditions @xmath28 .",
    "the time reversibility of equations of motion further ensures that such a mapping is invertible , i.e. , that from @xmath38 the corresponding starting point @xmath28 can be uniquely determined , @xmath39 .",
    "consider now a general invertible and differentiable mapping @xmath40 that maps phase space point @xmath41 into phase space point @xmath42 .",
    "here , the mapping @xmath43 takes the place of the propagator @xmath44 . for such mappings jarzynski",
    "has derived an expression akin to the non - equilibrium work theorem @xcite . to introduce the necessary notation we rederive this result . for this purpose",
    "we consider the definition of the free energy difference , @xmath45 multiplying and dividing the integrand in the above equation with @xmath46 we obtain @xmath47\\}.\\end{aligned}\\ ] ] a change of integration variables from @xmath42 to @xmath48 yields @xmath49\\}. \\label{equ : dfw}\\end{aligned}\\ ] ] where @xmath50 is the jacobian determinant of the mapping @xmath43 .",
    "the above equation suggests generalizing the definition of work @xmath51 this `` work '' includes the energy change caused by switching the control parameter from @xmath25 to @xmath26 . in addition @xmath52",
    "includes a term involving the jacobian of @xmath43 , which can be viewed as the work necessary to compress or expand the phase space volume when applying the mapping @xmath43 .",
    "this entropic contribution can be interpreted as `` heat '' absorbed during the mapping .",
    "in fact , if we choose the mapping to be the system s propagator , this term is exactly the heat . in this interpretation ,",
    "( [ equ : wphi ] ) is nothing other than an expression of the first law of thermodynamics .    using the work definition ( [ equ : wphi ] ) we can rewrite equ .",
    "( [ equ : dfw ] ) as @xmath53 or , as an average over the initial equilibrium distribution , @xmath54 this equation can be viewed as a generalization of jarzynski s identity . if the mapping is chosen to be the propagator @xmath44 of newtonian dynamics , the work @xmath52 equals the physical work @xmath2 carried out on the system as it evolves from @xmath28 to @xmath38 , @xmath55 and equ .",
    "( [ equ : jarphi ] ) reduces to jarzynski s identity . in deriving this result",
    "we have exploited the fact that newtonian dynamics conserves phase space volume  even when a control parameter changes with time , the jacobian appearing in the definition of @xmath52 [ equ .",
    "( [ equ : wphi ] ) ] is unity .      instead of the propagator @xmath37",
    ", we can choose a sequence of molecular dynamics steps as our mapping .",
    "each of these steps , which are designed to approximate the time evolution of the system over a small time interval @xmath56 , maps a phase point @xmath57 into a phase point @xmath58 .",
    "equation  ( [ equ : jarphi ] ) can be applied to a map defined by @xmath59 such steps , together taking the initial point @xmath28 into a final point @xmath60 .",
    "the expression for the work @xmath52 is particularly simple for integrators such as the verlet algorithm , which both conserve phase space volume and are time - reversible@xcite . in this case",
    "the jacobian of the mapping is unity , and , according to equ .",
    "( [ equ : wphi ] ) , @xmath61 so that @xmath62\\ } \\rangle .",
    "\\label{equ : finite}\\ ] ] this relation is exact regardless of the size of the time step @xmath56 used in applying these integrators .",
    "equation  ( [ equ : finite ] ) suggests the following algorithm .",
    "( 1 ) a canonical distribution @xmath63 of initial conditions is sampled with a monte carlo procedure or with an appropriately thermostatted molecular dynamics simulation .",
    "( note that in the latter case a sufficiently small time step must be used in order to preserve the correct equilibrium distribution . )",
    "( 2 ) these initial conditions are then used as starting points for fast switching trajectories obtained by repeated application of the verlet algorithm .",
    "( 3 ) during the integration the control parameter is changed from @xmath25 to @xmath26 . since equ .",
    "( [ equ : finite ] ) is exact for any size of the time step @xmath56 , the chosen integration time step can be arbitrarily large , provided that the variables specifying the state of the system ( for instance , positions and momenta of all particles ) retain values that do not exceed the range a computer can represent .",
    "we call this limit the _",
    "stability limit_. for each trajectory the energy difference @xmath64 is determined and used to calculate the exponential average appearing in equ .",
    "( [ equ : finite ] ) . since large time step trajectories",
    "are computationally less expensive , this algorithm holds promise to increase the efficiency of fast - switching free energy calculations .",
    "whether this is actually the case depends on how the work distribution is modified by the increase in time step length . in sec .",
    "iii we describe how to analyze the efficiency of fast switching simulations with large time steps .",
    "often the dynamics of model molecular systems evolve by stochastic equations of motion .",
    "common examples include the langevin equation @xcite , @xmath65 where @xmath66 is a friction coefficient and @xmath67 is a fluctuating random force ; and deterministic dynamics coupled to stochastic thermostats , such as the andersen thermostat @xcite .",
    "it has been shown that the jarzinsky relation remains valid also in these cases @xcite . in this section",
    "we discuss the question whether the large time step approach discussed in the previous section can be applied to stochastic dynamics as well .",
    "we describe the stochastic component of these dynamics through a `` noise history '' @xmath67 . in the case of langevin dynamics",
    "the noise history is , as the notation suggests , the trajectory of the random force . for a given realization of @xmath67 ,",
    "the time evolution of a stochastic system can be regarded as deterministic , and we may write @xmath68,\\ ] ] where the second argument in the deterministic map indicates its dependence on the noise history @xmath67 . since this mapping is invertible and differentiable , equ .",
    "( [ equ : jarphi ] ) applies for any particular noise history , @xmath69\\}\\rangle,\\ ] ] where we have averaged over canonically distributed initial conditions and @xmath70=}\\hspace{0.5 cm } \\nonumber \\\\ & & \\hspace{-1.4cm}{\\cal h}(\\phi[x ; \\eta(t ) ] , \\lambda_b)-{\\cal h}(x , \\lambda_a)-k_b t \\ln \\left|{\\partial \\phi[x;\\eta(t ) ] \\over \\partial x } \\right|.\\end{aligned}\\ ] ] this result above is valid for any noise - dependent map @xmath71 $ ] , so we are free to choose a mapping comprised of repeated application of brownian dynamics steps @xcite with arbitrary step size .",
    "because the result of averaging @xmath72\\}$ ] over initial conditions is completely independent of @xmath67 , the remaining average over noise histories is trivial , yielding @xmath73\\rho(x ) \\exp\\{-\\beta w_\\phi [ x ; \\eta(t)]\\}. \\label{equ : stochastic}\\end{aligned}\\ ] ] here , the notation @xmath74 indicates summation over all noise histories and @xmath75 $ ] is the probability distribution for observing a particular realization .",
    "interestingly , the above derivation implies that equ .",
    "( [ equ : stochastic ] ) can be applied to mappings with a completely arbitrary stochastic component . in particular , it is not necessary that the magnitude of stochastic fluctuations be related in any way to the rate of dissipation . in order to preserve a canonical distribution ,",
    "the langevin equation must be supplemented with such a constraint on the statistics of @xmath67 ( henceforth assumed to be gaussian white noise ) : @xmath76 this fluctuation - dissipation relation , ensuring detailed balance , is a necessary condition for the applicability of jarzynski s original identity concerning the exponential average of work defined in the conventional way . obtaining that result from equ .",
    "[ equ : stochastic ] is not nearly as straightforward as was the analogous task for deterministic dynamics . for stochastic mappings",
    "the jacobian determinant does not directly correspond to heat , even in the limit of small time step size . instead , for a trajectory of length @xmath27 @xmath77 \\over \\partial x } \\right| = e^{- n_{\\rm f}\\gamma \\tau } , \\label{equ : lang_jac}\\ ] ] where @xmath78 is the number of momentum degrees of freedom .",
    "the volume of a phase space element evolving under langevin dynamics thus decays steadily as time evolves and has no contribution from the fluctuating random force .",
    "mathematically , this phase space compression arises from the systematic damping of kinetic energy through the friction term in equ .",
    "[ equ : langevin ] . physically , its cancellation of contributions from heat @xmath79 in the exponential average of equ .",
    "[ equ : stochastic ] is a subtle consequence of detailed balance .",
    "crooks has shown that , for trajectories generated by any balanced dynamical rules , @xmath80 is equivalent to the ratio of probability densities of forward and time - reversed pathways .",
    "this ratio is closely related to a mapping s jacobian , as will be shown in sec .",
    "[ sec : discussion ] .",
    "the practical utility of our large time step result for free energy differences is compromised in the specific case of langevin dynamics by at least two issues .",
    "first , the rapid decay of @xmath81 / \\partial x } \\right|$ ] could damp all but the largest fluctuations , making convergence of the average in equ .",
    "[ equ : stochastic ] problematic .",
    "second , an exact calculation of the jacobian for large time steps is cumbersome when many degrees of freedom interact .",
    "the insensitivity equ .",
    "( [ equ : stochastic ] ) to the form of stochastic noise might be exploited to offset these problems , but it is not obvious how to do so .",
    "in a straightforward application of the fast switching procedure , the free energy difference @xmath3 is estimated from a finite sample of @xmath82 trajectories originating from canonically distributed initial conditions . here",
    "we assume that these initial conditions are statistically uncorrelated samples .",
    "defining @xmath83 we can write the free energy difference for finite @xmath82 as @xmath84 where @xmath85 is the average of @xmath86 over @xmath82 independent trajectories : @xmath87 here , @xmath88 is the value of @xmath86 obtained from the @xmath89-th trajectory .",
    "we now repeat this entire procedure @xmath90 times ( generating a total of @xmath91 trajectories ) and average over all @xmath90 resulting free energy estimates @xmath92 . the limiting result of this protocol",
    "is @xmath93 due to the non - linearity of the logarithm relating the average @xmath94 to the free energy estimate @xmath95 ( see equ .",
    "( [ equ : df_finite ] ) ) , @xmath96 differs from the true free energy difference @xmath3 even in the limit of infinitely many repetitions . for sufficiently large @xmath82",
    "this deviation , or bias , is given by @xcite @xmath97 where the fluctuation @xmath98 is the deviation of @xmath86 from its average value .",
    "this equation is obtained by expanding the logarithm in equ .",
    "( [ equ : df_finite ] ) in powers of relative fluctuations of @xmath99 and truncating the expansion after the quadratic term .",
    "in addition to the systematic bias , we must account for random error in each free energy estimate @xmath100 . assuming the statistical errors of different samples to be uncorrelated , and denoting their variance as @xmath101 ^ 2\\rangle,\\ ] ] we obtain the total mean squared deviation from the true free energy difference ,",
    "@xmath102 ^ 2\\rangle = b_n^2+\\sigma_n^2.\\ ] ] note that the bias decays with sample size as @xmath103 for large @xmath82 , while the scale of random error decays only as @xmath104 . thus , for sufficiently large @xmath82 only the statistical errors in the free energy estimate are relevant , and we can safely approximate @xmath105 from equ .",
    "( [ equ : epsilon ] ) one can determine the number of trajectories @xmath106 necessary to obtain a certain level of error @xmath107 , @xmath108 the computational cost of each trajectory is roughly proportional to the number of required force calculations and hence proportional to the number of steps @xmath109 necessary to generate a trajectory of length @xmath27 . neglecting the cost of the generation of initial conditions we can thus define a normalized computational cost @xmath110 this computational cost @xmath111 is the cpu - time required to obtain an accuracy in the free energy of @xmath112 measured in units of the cpu - time required to carry out one single molecular dynamics time step .",
    "note that while @xmath113 is independent from the stepsize @xmath56 , the mean square fluctuations @xmath114 depend on it . to determine an optimal time step size for a fast - switching free energy calculation",
    ", we must minimize the entire quantity @xmath111 .",
    "in the following section we will present calculations of this normalized cpu - time as a function of the stepsize @xmath56 for two different models .",
    "we first study the effect of large time step integration for a simple model introduced by sun @xcite . in this one - dimensional model a point particle of unit mass moves in a potential that depends on a control parameter @xmath24 .",
    "the hamiltonian for the system as a function of the position @xmath15 and the momentum @xmath16 of the moving particle is @xmath115 here , all quantities are scaled to be unitless . for @xmath116 the potential has two symmetric minima located at @xmath117 separated by a barrier of height @xmath118 located at @xmath119 . for @xmath120",
    "the potential energy function reduces to a single quartic well . for a given value of the control parameter @xmath24",
    "the partition function is @xmath121 .",
    "the free energy difference between the two states corresponding to @xmath120 and @xmath116 , respectively , can be calculated analytically to be @xmath122 @xcite .",
    "for this model we carried out fast switching simulations using different time steps @xmath56 ranging from @xmath123 to @xmath124 .",
    "the equations of motion were integrated with the velocity verlet algorithm @xcite , yielding positions @xmath125 and momenta @xmath126 as a function of time @xmath36 .",
    "for this model the verlet algorithm becomes unstable for time steps larger than @xmath127 . in all cases the total trajectory length was @xmath128 , corresponding to a transformation sufficiently gradual to allow accurate calculation of the free energy difference and of the mean square fluctuations @xmath114 . for each time step size",
    "we integrated @xmath129 trajectories from initial conditions sampled from a canonical distribution ( with @xmath116 ) using a monte carlo procedure .",
    "along the trajectories the control parameter was varied from its initial to its final value .",
    "more precisely , after each velocity verlet step , carried out at constant @xmath24 , the control parameter was increased by @xmath130 where @xmath131 is the number of time steps in the trajectory . at the end of each trajectory",
    "the work @xmath132 was calculated and added to the exponential average .",
    "( note that , when advancing time in large steps , it is important to use this generalized definition of work rather than summing estimates of the physical work performed during each stepwise change of the control parameter . )     obtained for the sun model for a trajectory length @xmath128 and step sizes @xmath124 ( solid line ) and 0.01 ( dashed line ) .",
    "work distributions for all time steps smaller than @xmath133 are indistinguishable from the distribution for @xmath133 on the scale of the figure.,width=264 ]    work distributions @xmath134 obtained for different step sizes @xmath56 ( and hence for different numbers of steps per trajectory ) are shown in fig .",
    "[ fig : pw_sun ] .",
    "@xmath134 deviates visibly from its small time step limit only for the largest step size , @xmath124 these differences originate in the inaccuracy of the integration algorithm for large step sizes .",
    "even though the work distribution varies with the size of integration steps , the resulting free energies show no step size dependence ( see fig .",
    "[ fig : df_sun ] ) , provided the stability limit of the integration algorithm is not exceeded .     with different step sizes",
    "the dotted line denotes the exact free energy difference .",
    "also shown is the average work @xmath135 ( squares).,width=264 ]    to quantify the statistical error in the free energy estimates shown in fig .",
    "[ fig : df_sun ] we have calculated the relative fluctuations @xmath136 , which according to equ .",
    "( [ equ : epsilon ] ) determine the mean squared error @xmath137 .",
    "these relative fluctuations are plotted in fig .",
    "[ fig : fluc_sun ] . the irregular shape of this curve reflects changes in the features ( such as the peak near @xmath138 ) of the work distributions shown in fig . [",
    "fig : pw_sun ] .     for the sun model as a function of the step size @xmath139.,width=264 ]",
    "the computational cost @xmath111 follows from the relative fluctuations and is shown as a function of the step size in fig .",
    "[ fig : cpu_sun ] . over the range of time steps depicted in the figure the computational cost decreases from about @xmath129 to about @xmath140 .",
    "thus , the fast switching simulation can be accelerated by two orders of magnitude if the conservative step size of @xmath141 is replaced by a step size @xmath124 near the stability limit .",
    "although in the latter case the equations of motion are not faithfully solved ( see sec .",
    "[ sec : discussion ] , fig .",
    "[ fig : wepsilon ] ) , the expression for the free energy remains exact .",
    "for the sun model as a function of the step size @xmath56 for @xmath142 .",
    "for all step sizes the total trajectory length was @xmath143 .",
    "this result indicates that for this model the computational cost of a free energy calculation with a given error decreases for increasing step size until the stability limit is reached.,width=264 ]      our second example involves a system with many degrees of freedom and is therefore likely to be more relevant for typical molecular systems of interest .",
    "spepcifically , we tested the large - timestep version of the jarzynski identity for a particle dragged through a lennard - jones fluid . in these simulations ,",
    "a tagged particle is coupled to a harmonic trap whose minimum is shifted from one position to another while the system evolves in time .",
    "if this process is carried out at a finite rate , work is performed on the system by the moving trap .",
    "nevertheless , the free energy difference between the two states corresponding to the initial and final position of the trap vanishes due to symmetry .",
    "the time - dependent hamiltonian for our @xmath90-particle system is @xmath144 where @xmath145 is the momentum of particle @xmath89 , @xmath146 is the position of particle @xmath89 , @xmath147 is the distance between particles @xmath89 and @xmath148 and the second sum on the right hand side extends over all particle pairs .",
    "the particles interact via the lennard - jones potential @xmath149.\\ ] ] here , @xmath150 and @xmath151 are parameters describing the depth of the potential well and the interaction range of the strongly repulsive core , respectively .",
    "the last term in equ .",
    "( [ ljhamiltonian ] ) describes the potential energy of one particular particle ( we arbitrarily pick particle @xmath152 ) in a harmonic trap with force constant @xmath153 . in equ .",
    "( [ ljhamiltonian ] ) @xmath154 denotes the time - dependent position of the trap s minimum , which is moved from the origin in the @xmath41-direction with constant speed @xmath155 , @xmath156 where @xmath157 is the unit vector in @xmath41-direction . during a total time @xmath27 the trap",
    "is displaced by an amount @xmath158 .",
    "while the trap s minimum roughly determines the position of particle @xmath152 , this particle does fluctuate about @xmath154 .",
    "the work @xmath2 performed on the system along a particular trajectory from @xmath159 to @xmath160 is given by @xmath161 since the free energy of the system does not depend on the trap s location , @xmath162 , the exponential work average carried out over many realizations of this process is @xmath163 here , angular brackets indicate a canonical average for a fixed position of the trap .",
    "we have carried out a fast switching procedure for @xmath164 particles of unit mass in a three - dimensional , cubic simulation box with periodic boundary conditions .",
    "the fluid s density , @xmath165 , is roughly that at the triple point , and its initial temperature places it in the liquid phase .",
    "canonically distributed initial conditions were generated by a molecular dynamics simulation , employing an andersen thermostat at temperature @xmath166 @xcite , with the trap fixed at the origin .",
    "for the generation of initial conditions , the equations of motions were integrated with the velocity verlet algorithm and a time step of @xmath167 .",
    "the state of the system was recorded every 50 steps along this equilibrium trajectory , providing an ensemble of intial conditions for the fast switching procedure .    from these initial conditions we generated fast switching trajectories of total length @xmath168 with different time steps ranging from @xmath169 to @xmath170 .",
    "the corresponding pathways ranged in number of steps from @xmath171 to @xmath172 , respectively . in each case the total displacement of the trap from its initial to its final position was @xmath173 corresponding to a velocity of @xmath174 .",
    "the velocity verlet algorithm without thermostat was used to integrate newton s equations of motion . along these trajectories",
    "the particle trap was displaced stepwise by a small distance @xmath175 after each molecular dynamics step .",
    "work distributions obtained in this manner are shown in fig .",
    "[ fig : pw_gcm ] for three different step sizes .",
    "free energy differences @xmath3 and the average work @xmath2 calculated in these simulations are depicted in fig .",
    "[ fig : df_gcm ] .     for a particle dragged through a lennard - jones fluid for step size @xmath176 ( solid line ) , step size @xmath177 ( dashed line ) and step size @xmath178 ( dotted line).,width=264 ]    .",
    "the trajectory length was @xmath179 for all step sizes . also shown is the average work @xmath135 ( squares).,width=264 ]    we used the relative fluctuations @xmath180 ( see fig .",
    "[ fig : fluc_gcm ] ) to calculate the normalized cpu time @xmath111 , which is plotted in fig .",
    "[ fig : cpu_gcm ] . the computational effort required to obtain a specific accuracy decreases with increasing step size until the largest value , @xmath170 . just as in the schematic one - dimensional example , the most efficient fast - switching calculation for dragging a particle through a dense fluid is obtained for step sizes close to the stability limit .     for the particle dragged through a lennard - jones fluid as a function of the step size @xmath56.,width=264 ]     for the particle dragged through a lennard - jones fluid of @xmath181 particles at a density @xmath182 as a function of the step size @xmath56 at @xmath183 .",
    "the particle is dragged through the fluid by a parabolic potential with force constant @xmath184 moving at constant speed @xmath185 . for",
    "all step sizes the total trajectory length was @xmath168 . also for this model",
    "the cost of a free energy calculation decreases up to step sizes just short of the stability limit.,width=264 ]",
    "molecular dynamics simulations carried out with large time steps do not faithfully reproduce the dynamics of any system with configuration - dependent forces .",
    "if such large time steps are used in the generation of fast switching trajectories to calculate free energy differences on the basis of jarzynski s identity , integration errors lead to work distributions differing from those obtained in the small time step limit . nevertheless , as we have shown in sec .",
    "[ sec : formalism ] , the jarzynski identity remains exactly valid in principle for time steps of arbitrary size . as a practical matter",
    "the stability limit provides an upper bound to the step size .",
    "since the computational cost of molecular dynamics trajectories is proportional to the number of integration steps , large time steps can be beneficial .",
    "whether an increase of computational efficieny can really be achieved depends on how the relative squared fluctuations @xmath136 scale with the size of the integration time step . if these fluctuations increase with @xmath56 sublinearly , using large time steps is advantageous .    in both of the numerical examples presented in sec .",
    "[ sec : numerical ] , increasing the size of the time step well beyond the range appropriate for equilibrium simulations proved favorable . resulting efficiency increases reached up to two orders of magnitude . here",
    "we ask more generally , and with complex molecular systems in mind , what circumstances should allow large time step integration to improve upon fast switching simulations . to answer that question it is convenient to write the work @xmath2 performed on the system during the transformation as sum of two parts .",
    "this separation is particularly natural if the control parameter @xmath24 is changed stepwise , i.e. , if each step is performed at constant @xmath24 and is followed by an increase in the control parameter by an increment @xmath186 .",
    "we define the first contribution to the generalized work @xmath52 as the change in energy due to the changes in control parameter for fixed phase points , @xmath187-{\\cal h}[x_i , ( i-1 ) \\delta \\lambda ] .",
    "\\label{equ : wham}\\ ] ] here , @xmath57 is the phase space point reached after @xmath89 integration steps starting from phase space point @xmath28 . in crooks s considerations of systems out of equilibrium , @xmath188 is precisely the physical work exerted by the change of control parameter @xcite .    in a system that evolves according to newton s equations with a time - independent potential energy function ,",
    "the total energy is a constant of the motion .",
    "but when these equations are integrated approximately over finite time steps , the energy of the system is not perfectly conserved . summing the energy changes due to integration error in the intervals between stepwise increases of @xmath24 , we obtain the other contribution to @xmath52 : @xmath189-{\\cal h}[x_i , i \\delta \\lambda ] .",
    "\\label{equ : weps}\\ ] ] to summarize our decomposition of @xmath52 , the work @xmath190 involves changes in control parameter at fixed phase space points , while the less physical contribution @xmath191 involves changes in the phase space point at constant control parameter .",
    "the total work performed during the transformation is the sum of these two quantities , @xmath192 in the limit of very small time steps , the energy of the system is conserved whenever @xmath24 is constant . in this case",
    ", the `` error '' work @xmath191 vanishes and the entire work is caused by changes in the control parameter , @xmath193 . if a system is driven away from equilibrium by a stepwise increase of the control parameter , the error work serves as a simple measure for the accuracy of approximate numerical integration .    neglecting correlations between @xmath188 and @xmath191 for the moment",
    ", we can write @xmath194 accordingly , the free energy change is the sum of two terms originating from @xmath188 and @xmath191 , @xmath195 this separation of the free energy difference into two terms related to @xmath188 and @xmath191 , respectively , is only strictly valid if fluctuations in @xmath196 are statistically independent .",
    "this supposition can not be assumed a priori to be the case .",
    "for the two models treated numerically in this study we have calculated the correlation @xmath197 where @xmath198 and @xmath199 .",
    "this coefficient quantifies correlations between the two variables @xmath200 and @xmath201 .",
    "while in the absence of correlations @xmath202 , perfect correlation ( anticorrelation ) leads to @xmath203 ( @xmath204 ) .",
    "correlations computed numerically for the sun model are depicted in fig .",
    "[ fig : corr ] as a function of the time step @xmath56 . for all time step sizes @xmath200 and",
    "@xmath201 are only weakly ( anti)correlated . the assumption of statistical independence is justified in these cases .     between control parameter work and integration error work as a function of the step size for the sun model.,width=264 ]    under the same assumption the statistical error of a fast switching free energy calculation with large time steps",
    "can also be written as the sum of two distinct contributions .",
    "absent correlations between @xmath188 and @xmath191 , equ .",
    "( [ equ : epsilon ] ) becomes @xmath205 .",
    "\\label{equ : epsilon_sum}\\ ] ] thus , the total mean squared error is the sum of the mean squared errors of the free energies related to the control parameter work and the integration error work , respectively .",
    "one potentially substantial difference between these two error contributions is their dependence on system size .",
    "often , the control parameter @xmath24 acts only on a small subset of the system s degrees of freedom . in calculating the chemical potential of an electrically neutral species by particle insertion ,",
    "for instance , the solute interacts only with a small number of other particles near the insertion point .",
    "similarly , the transformation of a residue of a protein into another one mainly affects only a local group of interactions .",
    "in such cases , the work @xmath188 resulting directly from changes in the control parameter quickly saturates with growing system size .",
    "the work @xmath191 , originating in the inaccuracy of the integration algorithm , has a different system size dependence .",
    "since all degrees of freedom contribute to the integration error , @xmath191 is expected to grow linearly with the system size .",
    "thus , for sufficiently large systems the second term on the right hand side of equ .",
    "( [ equ : epsilon_sum ] ) might become dominating for long time steps , thus limiting the maximally possible efficiency gain .",
    "( it is for similar reasons that hybrid monte carlo - molecular dynamics simulations decline efficiency for large systems @xcite . ) but as long as the integration error is small compared to work done by changes in control parameter , using large time steps should remain advantageous .    in our discussion of the efficiency of the large time step fast switching approach we have so far neglected the computational cost associated with generating initial conditions . often , starting points for the fast switching trajectories",
    "are generated with an appropriately thermostatted molecular dynamics simulation .",
    "it is important that these simulations are carried out with a time step of conventionally small size .",
    "otherwise the distribution of initial conditions can differ from the necessary canonical one .",
    "thus , the large time step approach can reduce only the computational cost associated with generating the non - equilibrium trajectories .",
    "this latter contribution is dominant by far in most cases .",
    "the issues discussed in this paper have some interesting implications for molecular dynamics simulations carried out at equilibrium as well .",
    "if the control parameter @xmath24 is not changed as the system evolves in time , no work @xmath188 is done on the system . in this case the free energy difference @xmath3 also vanishes , since initial and final hamiltonians are identical .",
    "nevertheless , due to the imperfection of a finite time step integration algorithm , the energy is not strictly conserved , and some `` error '' work @xmath191 is performed . according to equ .",
    "( [ equ : finite ] ) the statistics of such energy errors obeys @xmath206 this result implies that the distribution of integration errors can not be symmetric about @xmath207 . rather , positive errors are in loose terms more likely than negative ones . for a gaussian error distribution , equ .",
    "( [ equ : wepsilon ] ) relates the average error to the width of the error distribution , @xmath208 for more complicated error distributions , this same result is obtained from a cumulant expansion of equ .",
    "( [ equ : wepsilon ] ) truncated after the second term .",
    "thus , for an error distribution that is gaussian and/or sufficiently narrow , the average error is positive .",
    "this demonstration that the average energy of a simulated canonical ensemble drifts upward with time makes no reference to the details of molecular interactions .     of the integration error @xmath191 at constant control parameter .",
    "solid line : sun model for @xmath116 , @xmath128 , and @xmath209 ; dashed line : lennard - jones fluid with one particle in fixed trap , @xmath210 , @xmath211.,width=264 ]    we have verified equ .",
    "( [ equ : wepsilon ] ) both for the sun model and for the lennard - jones fluid . in both cases",
    "we have determined the distribution @xmath212 of the integration error @xmath191 for a large integration step @xmath56 and constant @xmath24 .",
    "the averages were carried out in the respective canonical ensembles corresponding to @xmath116 .",
    "two typical distributions are shown in fig .",
    "[ fig : wepsilon ] . for the sun model ( solid line )",
    "@xmath212 is strongly non - gaussian and asymmetric about @xmath207 , with positive errors more likely than negative ones .",
    "while the average error of @xmath213 is clearly positive , the exponential average @xmath214 is unity with high accuracy .",
    "for the lennard - jones fluid with one particle in a fixed trap the distribution of integration errors is approximately gaussian , with an average of @xmath215 .",
    "also in this case the exponential work average is unity .",
    "formulating changes in control parameter as a sequence of discrete steps is also convenient for demonstrating the equivalence between our identity for stochastic mappings , equ .",
    "( [ equ : stochastic ] ) , and jarzynski s original identity . during periods when @xmath24 is fixed ,",
    "stochastic evolution subject to a suitable fluctuation - dissipation relation , such as equ .",
    "( [ equ : flucdiss ] ) , satisfies detailed balance in the small time step limit . specifically , @xmath216 where @xmath217 $ ] is the canonical distribution corresponding to the hamiltonian @xmath218 at step @xmath89 , and @xmath219 is the noise - averaged probability for a phase space point @xmath41 at the beginning of a constant-@xmath24 interval to evolve into phase space point @xmath42 at the end of the interval .",
    "the caret in equ .",
    "( [ equ : balance ] ) indicates _ time reversal _ , so that @xmath220 is the probability for @xmath42 to evolve into @xmath41 under dynamics running backward in time . for langevin dynamics ,",
    "time reversal can be achieved simply by inverting the signs of all momenta contained in phase space points @xmath41 and @xmath42 . for a given noise history ,",
    "such transition probabilities are specified by the deterministic map @xmath221 $ ] .",
    "we can thus rewrite equ .",
    "( [ equ : balance ] ) as @xmath222   \\left\\langle \\delta(x'-\\phi[x;\\eta(t ) ] )   \\right\\rangle_\\eta = \\nonumber\\\\ & & \\hspace{-0.4 cm } e^{-\\beta { \\cal h}(x',i\\delta\\lambda ) } \\left\\langle \\delta(x'-\\phi[x;\\eta(t ) ] ) \\left|{\\partial \\phi[x;\\eta(t ) ] \\over \\partial x}\\right| \\right\\rangle_\\eta , \\label{equ : balance2}\\end{aligned}\\ ] ] where angled brackets with a subscript @xmath223 denote an average over realizations of the noise history .    from the condition of detailed balance",
    ", we now obtain a general identity for averages involving the jacobian determinant .",
    "we begin by multiplying equ .",
    "( [ equ : balance2 ] ) by an arbitrary function @xmath224 of two phase space points , and then integrate over @xmath42 , yielding @xmath225 )   \\right\\rangle_\\eta = \\left\\langle f(x,\\phi[x;\\eta(t ) ] ) \\right .",
    "\\nonumber\\\\ & & \\left .",
    "\\quad \\times e^{-\\beta [ { \\cal h}(\\phi[x;\\eta(t)],i\\delta\\lambda ) - { \\cal h}(x , i\\delta\\lambda ) ] } \\left|{\\partial \\phi[x;\\eta(t ) ] \\over \\partial x}\\right| \\right\\rangle_\\eta .",
    "\\label{equ : balance3}\\end{aligned}\\ ] ] this result holds for any period during which the control parameter is held constant , i.e. , while no physical work is done on a system . since we have assumed here that equations of motion are integrated with an infinitesimally small time step , the `` error '' work vanishes as well .",
    "the energy change @xmath226,i\\delta\\lambda ) - { \\cal h}(x , i\\delta\\lambda)]$ ] in equ .",
    "( [ equ : balance3 ] ) is thus identically the heat @xmath227 absorbed from the bath during the @xmath89th time interval .",
    "equation  ( [ equ : balance3 ] ) states that the jacobian determinant and @xmath80 negate one another in averages over noise history .    this proof is completed by decomposing the total change in energy along a trajectory into contributions from physical work @xmath188 ( accumulated over many discrete steps in control parameter at fixed phase space point ) and heat ( accumulated over many intervals during which the phase space point evolves at fixed @xmath24 ) : @xmath228 , \\lambda_b)-{\\cal h}(x , \\lambda_a ) = w_\\lambda + { \\cal q } \\\\ { \\cal q } = \\sum_{i=0}^{n-1}{\\cal h}[x_{i+1 } , i \\delta \\lambda]-{\\cal h}[x_i , i \\delta \\lambda]\\end{aligned}\\ ] ] we have retained the definition of physical work from equ .",
    "( [ equ : weps ] ) .",
    "note that heat in the case of stochastic dynamics is defined in precisely the same way as `` error '' work was defined for deterministic dynamics propagated in an approximate way .",
    "recalling the generalized definition of work @xmath52 and applying the identity  ( [ equ : balance3 ] ) with @xmath229-{\\cal h}[x ' , ( i-1 ) \\delta \\lambda ] ) \\}$ ] for each constant-@xmath24 interval , we finally have @xmath230 \\over \\partial x}\\right| \\right\\rangle_\\eta \\nonumber\\\\ & = &   \\left\\langle e^{-\\beta w_\\lambda } \\right\\rangle_\\eta.\\end{aligned}\\ ] ] this equivalence , together with equ .",
    "( [ equ : stochastic ] ) , completes an alternative route to jarzynski s identity for systems evolving stochastically under the constraint of detailed balance .",
    "the consequence of detailed balance expressed in this way has interesting implications for energy fluctuations of stochastic systems at equilibrium ( i.e. , with fixed control parameter ) . with the choice @xmath231 , we have for the specific case of langevin dynamics ( see equ .",
    "( [ equ : lang_jac ] ) ) @xmath232 along trajectories of length @xmath27 .",
    "this identity stands in stark constrast to the corresponding exponential average of energy fluctuations under norm - conserving deterministic mappings , equ .",
    "( [ equ : wepsilon ] ) . the long - time divergence in equ .",
    "( [ equ : expq ] ) would be expected for a system which asymptotically loses all memory of its initial conditions . in that case , the exponential average factorizes in the long - time limit : @xmath233 the first factor on the right hand side of equ .",
    "( [ equ : qfactor ] ) averages a quantity that negates the effect of boltzmann weighting , and is proportional to the entire phase space volume . since the range of possible momenta",
    "is unbound even in a system with finite volume , a divergent result is inevitable once correlations have decayed completely .",
    "we anticipate similarly unbounded growth of exponentially averaged energy fluctuations for many classes of stochastic dynamics , such as monte carlo sampling .",
    "that the analogous average is fixed at unity for deterministic propagation rules with unit jacobian such as the verlet algorithm indicates that errors arising from finite time step size do not disrupt substantial correlations with initial conditions .",
    "by considering general invertible phase space mappings we have demonstrated that the jarzynski relation remains exactly valid for non - equilibirum trajectories generated with large time steps , provided the work performed on the system is defined appropriately . for integration algorithms that conserve phase space volume , such as the verlet algorithm , this definition is particularly simple .",
    "here , the work just equals the energy difference between the final and the initial state of the trajectory .",
    "simulating dynamics with a larger time step requires fewer integration steps to generate a trajectory of given length , and therefore lower computational cost .",
    "numerical simulations indicate that optimum efficiency is achieved for time steps just short of the stability limit . compared to simulations with time steps of conventional size",
    ", the long time step approach can yield improvements in efficiency of one or more orders of magnitude .",
    "recently , sun has shown how work - biased path sampling can be used to improve the efficiency of fast switching simulations @xcite .",
    "however , it seems that this path sampling approach does not outperform conventional methods for calculating free energy differences",
    ". it will be interesting to see if the fast switching approach can be improved , by combining the long time step approach of this paper with biased path samping methodologies @xcite , to the point that it is computationally competitive with other free energy calculation techniques , such as umbrella sampling , thermodynamic integration , or flat histogram sampling ."
  ],
  "abstract_text": [
    "<S> jarzynski s identity for the free energy difference between two equilibrium states can be viewed as a special case of a more general procedure based on phase space mappings . solving a system s equation of motion by approximate means </S>",
    "<S> generates a mapping that is perfectly valid for this purpose , regardless of how closely the solution mimics true time evolution . </S>",
    "<S> we exploit this fact , using crudely dynamical trajectories to compute free energy differences that are in principle exact . </S>",
    "<S> numerical simulations show that newton s equation can be discretized to low order over very large time steps ( limited only by the computer s ability to represent resulting values of dynamical variables ) without sacrificing thermodynamic accuracy . for computing the reversible work required to move a particle through a dense liquid , these calculations are more efficient than conventional fast switching simulations by more than an order of magnitude . </S>",
    "<S> we also explore consequences of the phase space mapping perspective for systems at equilibrium , deriving an exact expression for the statistics of energy fluctuations in simulated conservative systems . </S>"
  ]
}