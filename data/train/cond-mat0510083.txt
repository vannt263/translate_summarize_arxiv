{
  "article_text": [
    "the study of electronic transport through devices comprising only a handful of atoms is becoming one of the most fascinating branch of modern solid state physics .",
    "the field was initiated with the advent of the scanning tunnelling microscope ( stm ) @xcite and at present comprises a multitude of applications which span over several disciplines and encompass different technologies , from building blocks for revolutionary computer architectures , to disposable electronics , to diagnostic tools for genetically driven medicine .",
    "clearly many of these devices will soon change and enhance the quality of our daily life .    fully functional molecular memories @xcite and logic gates @xcite have been already demonstrated suggesting a possible roadmap to the post - silicon era .",
    "these should produce future generations of computers , together with magnetic data storage devices exceeding the terabit / in@xmath2 storage limit .",
    "the readout of such high - density data storage media will be achieved using nanoscale devices with magnetic atomic point contacts @xcite .    at the same time",
    "hybrid molecular devices are becoming increasingly popular in multifunctional sensor design , demonstrating a sensitivity orders of magnitude superior to that achievable with conventional methods .",
    "these molecular devices include for example carbon nanotubes detectors for no@xmath3 @xcite and nerve agents @xcite , nanowire - based virus detectors @xcite and chemical sensors @xcite .",
    "the near future should see the development of on - chip nanolabs able to sense a particular signature of gene or protein expression and therefore be able to diagnose various diseases",
    ". these will be formidable tools for the study of biological systems and in the field of preventive medicine @xcite .",
    "in addition to this large experimental activity an equally large effort has been devoted to the development of efficient computational methods for evaluating @xmath0-@xmath1 characteristics of nanoscale devices .",
    "this is quite a remarkable theoretical challenge since advanced quantum transport algorithms must be combined with state of the art electronic structure methods . ideally these tools should be able to include strong correlation as well as inelastic effects , and they should be suitable for describing large systems ( easily scalable methods ) .",
    "furthermore in order to compare directly to experiments the detailed knowledge of the atomic configuration is needed .",
    "modern theory of quantum transport has developed a range of methods for calculating transport in nanoscale conductors . broadly speaking",
    "these can be divided into two main classes : 1 ) steady state algorithms , and 2 ) time dependent schemes .",
    "the first are based upon the assumption that , regardless of the details of a possible transient , a steady state is always achieved .",
    "the current through the entire device is calculated as a balance of currents entering and leaving a given scattering region , either using scattering theory @xcite , or by solving a master equation @xcite .",
    "a multitude of variations over this generic scheme are available @xcite , depending on the underlying assumption leading to the steady state , the details of the electronic structure method employed , and the way in which the external potential is introduced in the calculation .",
    "interestingly most of the methods can be demonstrated to be applicable to cases of non - interacting electrons @xcite , although their equivalence is not demonstrated for the interacting case . among these algorithms a particular place",
    "is occupied by implementations of the non - equilibrium green function ( negf ) @xcite method within density functional theory ( dft ) @xcite .",
    "this approach , which is based on equilibrium dft to describe the electronic structures , has the advantage of being conceptually simple , and computationally easy and versatile to implement @xcite .",
    "time dependent methods are at an earlier stage of development .",
    "these investigate the time - evolution of the electronic charge density of a system , brought out of equilibrium by a time - dependent perturbing potential . to the best of our knowledge",
    "two fundamentally different methods have been proposed to date .",
    "the first considers infinite non - periodic systems , with an external potential introduced as a time dependent perturbation @xcite . the time - evolution of the density matrix is studied with time - dependent density functional theory ( tddft ) @xcite .",
    "an alternative approach consists of placing the system of interest in a large capacitor .",
    "such a capacitor is charged at @xmath4=0 and the time - dependent de - charging process is investigated @xcite . generally speaking these methods are computationally intensive , since the need to perform the time evolution adds to the computational overheads of standard static schemes",
    ". however they should be able to address transport limits such as coulomb blockade or resonant tunnelling , which are otherwise difficult to describe .",
    "interestingly , important information can be extracted from the static limit of the time - dependent problem @xcite , and this can help in designing more accurate static methods and in understanding their limitations .    here",
    "we present in details our recently developed quantum transport code _",
    "smeagol _ @xcite .",
    "_ smeagol _ is a dft implementation of the non - equilibrium green s function method , which has been specifically designed for magnetic materials .",
    "the main core of _ smeagol _ is our original technique for constructing the leads self - energies @xcite , which avoids the standard problems of recursive methods @xcite and allows us to describe devices having current / voltage probes with a complicated electronic structure .",
    "in addition _",
    "smeagol _ has been constructed to be a modular and scalable code , with particular emphasis on heavy parallelization , to facilitate large scale simulations . in its present form _",
    "smeagol _ is parallel over @xmath5-space , real space and energy and furthermore it can deal with spin - polarised systems , including spin non - collinearity . a partial description of the code has already been provided @xcite , which should be incorporated with this more detailed description .",
    "the paper is organized as follows . in the next section",
    "we introduce our method and its main technical implementations .",
    "in particular we set the problem , explain how to construct the leads self - energies , and describe the strategy used for calculating the electrostatic potential .",
    "then we present a series of calculations for systems relevant to either spin- or molecular - electronics .",
    "these address specific aspects of _ smeagol _ such as the electrostatics , the spin polarization and the spin non - collinearity .",
    "finally in the appendices we describe in more details the self - energy algorithm , we recall the theoretical foundations of the negf formalism , and we establish a connection with tddft .",
    "in this section we describe in details our computational technique .",
    "the underlying assumption used throughout this work is that all the quantities associated to the electronic structure ( hamiltonian , density matrix , green s functions , etc . )",
    "can be written over a localized atomic orbital ( lao ) basis set of some kind @xmath6 , where @xmath7 is the position of the @xmath8-th nucleus and @xmath9 is a collective index spanning , the angular momentum ( @xmath10 ) and the orbital @xmath11 .",
    "note that in general the index @xmath11 can run over different radial functions corresponding to the same angular momentum , according to the multiple - zetas scheme @xcite . in this way a generic operator @xmath12",
    "is represented by a finite @xmath13 matrix ( @xmath14 is the total number of degrees of freedom in the system ) whose matrix elements are simply @xmath15 .",
    "note also that the functions @xmath16 are generally non - orthogonal and the overlap matrix @xmath17 is defined as @xmath18 .      _",
    "smeagol _ has been designed to describe two - terminal conductance experiments , where two current / voltage electrodes of macroscopic size sandwich a nanometer - sized device ( a molecule , an atomic point contact , a tunneling barrier ... ) .",
    "let us present the problem from three different perspectives : the thermodynamics , the hamiltonian and the electrostatics ( see figure [ fig1 ] ) .",
    "from a thermodynamic point of view the system is modelled two bulk leads and a central region .",
    "the latter includes the actual device and , for reasons that will be clear later , part of the leads .",
    "therefore we call such a central region an `` extended molecule '' ( em ) .",
    "the two current / voltage leads are kept at two different chemical potentials respectively @xmath19 and @xmath20 and are able to exchange electrons with the em .",
    "note that when the applied bias is zero ( @xmath21 ) , this system of interacting electrons is in thermodynamic equilibrium and may be regarded as a grand canonical ensemble .",
    "when the bias is applied however @xmath22 and the current will flow .",
    "then the prescription for establishing the steady state is that of adiabatically switching on the coupling between the leads and the em @xcite .    at the hamiltonian level",
    "the system under investigation is described by an infinite hermitian matrix @xmath23 .",
    "this however has a rather regular structure .",
    "first notice that the two semi - infinite current / voltage probes are defect - free crystalline metals .",
    "these have a regular periodic structure and a unit cell along which the direction of the transport can be defined . at this point",
    "it is important to notice that because of the lao basis set this matrix will be rather sparse .",
    "it is convenient to introduce the concept of principal layer ( pl ) .",
    "a principal layer is the smallest cell that repeats periodically in the direction of the transport constructed in such a way to interact only with the nearest neighbour pls .",
    "this means that _ all _ the matrix elements between atoms belonging to two non - adjacent pls vanish .",
    "for example take a linear chain of hydrogen atoms described by a nearest neighbour tight - binding model then one atom forms the unit cell .",
    "however if nearest and next nearest neighbour elements are included then the pl will contain two atoms etc ( for examples see appendix [ h1problem ] ) .",
    "we then define @xmath24 as the @xmath13 matrix describing all interactions within a pl , where @xmath14 is the total number of degrees of freedom ( basis functions ) in the pl ( note that we use calligraphic symbols - @xmath23 - for infinitely - dimensional matrices and capitalized letters - @xmath25 - for finite matrices ) .",
    "similarly @xmath26 is the @xmath13 matrix describing the interaction between two pls .",
    "finally @xmath27 is the @xmath28 matrix describing the extended molecule and @xmath29 ( @xmath30 ) is the @xmath31 matrix containing the interaction between the last pl of the left - hand side ( right - hand side ) lead and the extended molecule .",
    "the final form of @xmath23 is @xmath32[htot ] for a system which preserves time - reversal symmetry @xmath33 , @xmath34 and @xmath35 . in this form",
    "@xmath23 has the same structure as the hamiltonian of a one - dimensional system as shown in figure [ fig1]b .",
    "however this is not the most general situation and does not apply if a magnetic field is present for example .    note",
    "that the overlap matrix @xmath36 has exactly the same structure of @xmath23 .",
    "therefore we adopt the notation @xmath37 , @xmath38 , @xmath39 , @xmath40 and @xmath41 for the various blocks of @xmath36 , in complete analogy with their hamiltonian counterparts . here",
    "the principal layer , defined by @xmath23 is used for both the @xmath36 and the @xmath23 matrix , even though the range of @xmath36 can be considerably shorter than that of @xmath23 .",
    "let us now discuss the electrostatics of the problem ( figure [ fig1]c ) .",
    "the main consideration here is that the current / voltage probes are made from good metals and therefore preserve local charge neutrality .",
    "for this reason the effect of an external bias voltage on the leads will produce a rigid shift of the whole spectrum , i.e. of all the on - site energies .",
    "in contrast a non - trivial potential profile will develop over the extended molecule , which needs to be calculated self - consistently .",
    "importantly the resulting self - consistent electrostatic potential must match that of the leads at the boundaries of the em .",
    "if this does not happen , the potential profile will develop a discontinuity with the generation of spurious scattering .",
    "therefore , in order to achieve a good match of the electrostatic potential , several layers of the leads are usually included in the extended molecule .",
    "their number ultimately depends upon the screening length of the leads , but in most situations a few ( between two and four ) atomic planes are sufficient .    even in the case of extremely short screening length , it is however good practice to include a few planes of the leads in the extended molecule because the electrodes generally have reconstructed surfaces , which might undergo additional geometrical reconstructions when bonding to the nanoscale device ( e.g. molecules attached to metallic surfaces through corrosive chemical groups ) .",
    "we conclude this section with some comments about the application of periodic boundary conditions in the transverse direction perpendicular to that of the transport .",
    "the setup of a typical experiment is that of two very large current voltage probes sandwiching a tiny region which is responsible for most of the resistance . the ideal description would be that of two infinite leads ( with infinite cross sections ) and a finite scattering region",
    "unfortunately this problem is intractable since both @xmath24 and @xmath26 become infinitely - dimensional .",
    "therefore one has to consider some approximations .",
    "the first option is to use leads with finite cross section . in this case ,",
    "no periodic boundary conditions are required and the whole system is quasi - one - dimensional .",
    "however special care must be taken when choosing the cross section of the leads in order to avoid quantum confinement effects .",
    "it is also worth noting that leads with very small cross section make the use of the landauer formula for transport @xcite questionable . as a rule of thumb",
    "the linear dimension of the cross section should be several times the fermi wavelength of the material forming the leads and there should be several open scattering channels .",
    "the second option is to use periodic boundary conditions . in this case",
    "the system is repeated periodically in the transverse direction , meaning that the extended molecule is also repeated periodically . clearly quantum confinement effects are eliminated , but one should be particularly careful in order to eliminate the spurious interaction between the mirror images of the extended molecule .",
    "therefore large unit cells must be employed even when periodic boundary conditions are used .",
    "however from a formal point of view the use of periodic boundary conditions does not change the problem setup .",
    "all the matrices ( @xmath24 , @xmath26 etc . ) now depend on the transverse @xmath5-vector used , and the infinite problem transforms in a collection of @xmath5-dependent quasi one - dimensional problems .",
    "this dependence is implicitly assumed whenever necessary throughout the rest of the paper .",
    "we are dealing with an infinite - dimensional hermitian problem , which is intractable , because the wave - functions deep inside the leads have a plane - wave form .",
    "these can be calculated by computing the band - structure of an infinite chain of pl s . the main computational effort is therefore focussed upon the problem of describing the scattering of plane - waves from one lead to the other across the em .",
    "the problem is solved by computing the retarded green s function @xmath42 for the whole system by solving the green s function equation @xmath43\\:{\\cal g}^\\mathrm{r}(e)={\\cal i}\\:,\\ ] ] where @xmath44 is an infinitely - dimensional identity matrix , @xmath45 and @xmath46 is the energy .",
    "the same equation explicitly using the block - diagonal structure of both the hamiltonian and the overlap matrix ( we drop the symbol `` r '' indicating the retarded quantities ) is of the form    @xmath47    where we have partitioned the green s functions @xmath48 into the infinite blocks describing the left- and right - hand side leads @xmath49 and @xmath50 , those describing the interaction between the leads and extended molecule @xmath51 , @xmath52 , the direct scattering between the leads @xmath53 , and the finite block describing the extended molecule @xmath54 .",
    "we have also introduced the matrices @xmath55 , @xmath56 , @xmath57 , @xmath58 and their corresponding overlap matrix blocks , indicating respectively the left- and right - hand side leads hamiltonian and the coupling matrix between the leads and the extended molecule .",
    "@xmath27 is an @xmath28 matrix and @xmath59 is the @xmath28 unit matrix .",
    "the infinite matrices , @xmath60 and @xmath61 describe the leads and have the following block - diagonal form @xmath62 with similar expressions for @xmath61 and the overlap @xmath36 matrix counterparts .",
    "in contrast the coupling matrices between the leads and the extended molecule are infinite dimensional matrices whose elements are all zero except for a rectangular block coupling the last pl of the leads and the extended molecule .",
    "for example we have @xmath63 the crucial step in solving equation ( [ eq3 ] ) is to write down the corresponding equation for the green s function involving the em and surface pl s of the left and right leads and then evaluate the retarded green s function for the extended molecule @xmath64 .",
    "this has the form @xmath65^{-1}\\ : , \\label{rgfem}\\ ] ] where we have introduced the retarded self - energies for the left- and right - hand side lead @xmath66 and @xmath67 here @xmath68 and @xmath69 are the retarded _ surface _ green s function of the leads , i.e. the leads retarded green s functions evaluated at the pl neighboring the extended molecule .",
    "formally @xmath68 ( @xmath69 ) corresponds to the right lower ( left higher ) block of the retarded green s function for the whole left - hand side ( right - hand side ) lead .",
    "these are simply @xmath70^{-1}\\ : \\label{eq9}\\ ] ] and @xmath71^{-1}\\ : .",
    "\\label{eq10}\\ ] ] note that @xmath72 ( @xmath73 ) is not the same as @xmath74 ( @xmath75 ) defined in equation ( [ eq3 ] ) .",
    "in fact the former are the green s functions for the semi - infinite leads in isolation , while the latter are the same quantities for the leads attached to the scattering region .",
    "importantly one does not need to solve the equations ( [ eq9 ] ) and ( [ eq10 ] ) for calculating the leads surface green s functions and a closed form avoiding the inversion of infinite matrices can be provided @xcite .",
    "this will be discussed in what follows and in appendix [ h1problem ] .",
    "let us conclude this section with a few comments on the results obtained .",
    "the retarded green s function @xmath64 contains all the information about the electronic structure of the extended molecule attached to the leads . in its close form given by the equation ( [ rgfem ] )",
    "it is simply the retarded green s function associated to the effective hamiltonian matrix @xmath76 @xmath77 note that @xmath76 is not hermitian since the self - energies are not hermitian matrices .",
    "this means the the number of particles in the extended molecule is not conserved , as expected by the presence of the leads .",
    "moreover , since @xmath64 contains all the information about the electronic structure of the extended molecule in equilibrium with the leads , it can be directly used for extracting the zero - bias conductance @xmath78 of the system .",
    "in fact one can simply apply the fisher - lee @xcite relation and obtain @xmath79\\ : , \\label{zbcond}\\ ] ] where @xmath80\\:.\\ ] ] in equation ( [ zbcond ] ) all the quantities are evaluated at the fermi energy @xmath81 .",
    "clearly @xmath82(e)$ ] is simply the energy dependent total transmission coefficient @xmath83 of standard scattering theory @xcite .",
    "finally note that what we have elaborated so far is an alternative way of solving a scattering problem .",
    "in standard scattering theory one first computes the asymptotic current carrying states deep into the leads ( scattering channels ) and then evaluate the quantum mechanical probabilities for these channels to be reflected and transmitted through the extended molecule @xcite . in this case the details of the scattering region are often reduced to a matrix describing the effective coupling between the two surface pls of the leads @xcite .",
    "in contrast the use of ( [ zbcond ] ) describes an alternative though equivalent approach , in which the leads are projected out to yield a reduced matrix describing an effective em .",
    "the current through surface pl s perpendicular to the transport direction are the same @xcite , the two approaches are equivalent and there is no clear advantage in using either one or the other .",
    "however , when the hamiltonian matrix of the scattering region @xmath27 is not known _ a priori _ , then the negf method offers a simple way of setting up a self - consistent procedure .",
    "consider now the case in which the matrix elements of the hamiltonian of the system are not known explicitly , but only their functional dependence upon the charge density @xmath84 , @xmath85 $ ] , is known .",
    "this is the most common case in standard mean field electronic structure theory , such as dft .",
    "if no external bias is applied to the device ( linear response limit ) the hamiltonian of the system can be simply obtained from a standard equilibrium dft calculation and the procedure described in the previous section can be applied without any modification . however ,",
    "when an external bias @xmath1 is applied , the charge distribution of the extended molecule will differ from that at equilibrium since both the net charge and the electrical polarization are affected by the bias .",
    "this will determine a new electrostatic potential profile with different scattering properties .",
    "these modifications will affect only the extended molecule , since our leads are required to preserve local charge neutrality .",
    "this means that the charge density and therefore the hamiltonian of the leads are not modified by the external bias applied . as discussed at the beginning the only effect of the external bias over the current / voltage electrodes",
    "is that of a rigid shift of the on - site energies .",
    "the hamiltonian then takes the form @xmath86 note that the coupling matrices between the leads and the extended molecule are also not modified by the external bias , since by construction the charge density in the surface planes of the extended molecule matches exactly that of the leads .",
    "the hamiltonian of the extended molecule @xmath87\\ ] ] depends on the density matrix , which is calculated using the lesser green s function @xmath88 @xcite @xmath89 so a procedure must be devised to compute this quantity .    in equilibrium ,",
    "@xmath90f(e-\\mu)$ ] , so it is only necessary to consider the retarded green s function , given by equation ( [ gretarded ] ) .",
    "alternatively , @xmath91 may be obtained from the eigenvectors of @xmath92 .    out of equilibrium ,",
    "however , the presence of the leads establishes a non - equilibrium population in the extended molecule and @xmath93 is no longer equal to @xmath94f(e-\\mu)$ ] .",
    "the non - equilibrium green s function formalism @xcite provides the correct expression ( see appendix [ appb ] ) : @xmath95g_{\\mathrm m}^{\\mathrm r\\dag}(e)\\ ] ] where @xmath96 , @xmath97 is the fermi function for a given temperature @xmath98 , @xmath99 and @xmath100 is given again by the equation ( [ rgfem ] ) where now we replace @xmath101 with @xmath102 .",
    "finally the self consistent procedure is as follows .",
    "first a trial charge density @xmath103 is used to compute @xmath27 from equation ( [ hamiltonian ] ) .",
    "then @xmath104 , @xmath105 and @xmath64 are calculated from equations ( [ gammal ] ) , and ( [ rgfem ] ) .",
    "these quantities are used to compute the @xmath88 of equation ( [ rgfem2 ] ) , which is fed back in equation ( [ density ] ) to find a new density @xmath106 .",
    "this process is iterated until a self - consistent solution is achieved , which is when @xmath107 . at this point",
    "the problem is identical to that solved in the previous section ( since the whole @xmath23 is now determined ) and the current @xmath0 can be calculated using @xcite @xmath108 \\left[f\\left(e-\\mu_\\mathrm{l}\\right ) - f\\left(e-\\mu_\\mathrm{r}\\right)\\right]\\ : .",
    "\\label{current}\\ ] ] note that now the transmission coefficient depends on both the energy @xmath46 and the bias @xmath1 .",
    "let us conclude this section with a note on how to perform the integrals of equations ( [ density ] ) and ( [ current ] ) .",
    "the one for the current is trivial since the two fermi functions effectively cut the integration to give a narrow energy window between the chemical potentials of the leads .",
    "in addition the transmission coefficient , with the exception of some tunneling situations , is usually a smooth function of the energy .",
    "in contrast the integration leading to the density matrix ( [ density ] ) is more difficult , since the integral is unbound and the green s function has poles over the real energy axis .",
    "this however can be drastically simplified by adding and subtracting the term @xmath109 and by re - writing the integral ( [ density ] ) as the sum of two contributions @xmath110",
    "@xmath111 f\\left(e-\\mu_\\mathrm{l}\\right ) , \\label{d_equil}\\ ] ] and @xmath112 .",
    "\\label{d_out_equil}\\ ] ]    @xmath113 can be interpreted as the density matrix at equilibrium , _ i.e. _ the one obtained when both the reservoirs have the same chemical potential @xmath19 , while @xmath114 contains all the corrections due to the non - equilibrium conditions .",
    "computationally @xmath114 is bound by the two fermi functions of the leads , as for the current @xmath0 , and therefore one needs to perform the integration only in the energy range between the two chemical potentials .",
    "in contrast @xmath113 is unbound , but the integral can be performed in the complex plane using a standard contour integral technique @xcite , since @xmath64 is both analytical and smooth .",
    "let us now return to the question of how to calculate the self - energies for the leads . from the equations ( [ senleft ] ) and ( [ senright ] )",
    "it is clear that the problem is reduced to that of computing the retarded surface green functions for the left- ( @xmath115 ) and right - hand side ( @xmath116 ) lead respectively .",
    "this does not require any self - consistent procedure since the hamiltonian is known and it is equal to that of the bulk leads plus a rigid shift of the on - site energies .",
    "however the calculation should be repeated several times since the @xmath117 s depend both on the energy and the @xmath5-vector .",
    "therefore it is crucial to have a stable algorithm .",
    "there are a number of techniques in the literature to calculate the surface green s functions of a semi - infinite system .",
    "these range from recursive methods @xcite to semi - analytical constructions @xcite . in _",
    "smeagol _ we have generalized the scheme introduced by sanvito _ et .",
    "@xcite to non - orthogonal basis sets .",
    "this method gives us a prescription for calculating the retarded surface green s function exactly .",
    "the main idea is to construct the green s function for an infinite system as a summation of bloch states with both real and imaginary wave - vectors , and then to apply the appropriate boundary conditions to obtain the green s function for a semi - infinite lead .     and @xmath37 are the matrices describing the hamiltonian and the overlap within a pl , while @xmath26 and @xmath38 are the same quantities calculated between two adjacent pls .",
    "the arrow indicates the direction of transport.,width=283 ]    as explained above the hamiltonian and the overlap matrices are arranged in a tridiagonal block form , having respectively @xmath24 and @xmath37 on the diagonal , and @xmath26 and @xmath38 as the first off diagonal blocks ( see figure [ fig2 ] ) .",
    "since we are dealing with an infinite periodic quasi one - dimensional system , the schrdinger equation can be solved for bloch states @xmath118 and reads @xmath119\\phi_k=0\\;,\\ ] ] where @xmath120 with @xmath121 integer and @xmath122 the separation between principal layers , @xmath5 is the wave - vector along the direction of transport ( in units of @xmath123 ) , @xmath124 is a @xmath14-dimensional column vector and @xmath125 a normalization factor .",
    "here we introduce the @xmath13 matrices @xmath126 since the green s functions are constructed at a given energy our task is to compute @xmath127 ( both real and complex ) instead of @xmath128 as conventionally done in band theory . a numerically efficient method to solve the `` inverse '' secular equation",
    "@xmath129 is to map it onto an equivalent eigenvalue problem .",
    "it is simple to demonstrate @xcite that the eigenvalues of the following @xmath130 matrix @xmath131 are @xmath132 and that the upper @xmath14 component of the eigenvectors are the vectors @xmath124 .",
    "clearly for the solution of this eigenvalue problem one needs to invert @xmath133 . however , since @xmath133 is determined by the details of the physical system , the choice of basis set and of principal layer may be singular or severely ill - conditioned .",
    "this problem often originates from the fact that a few states within a pl do not couple to states in the nearest - neighbouring pls , but it can also be due to the symmetry of the problem .",
    "for example in the case of _ ab initio _ derived matrices this becomes unavoidable when one considers transition metals , where the strongly localized @xmath134 shells coexist with rather delocalised @xmath135 electrons .",
    "a possible solution to this problem is to consider an equivalent _ generalized _ eigenvalue problem , which does not require matrix inversion .",
    "however this solution is not satisfactory for two reasons .",
    "first the matrices still remain ill - conditioned and the general algorithm is rather unstable .",
    "secondly for extreme cases we have discovered that the generalized eigenvalue solver can not return meaningful eigenvalues ( divisions by zero are encountered ) .",
    "we therefore decide to use an alternative approach constructing a regularization procedure for eliminating the singularities of @xmath133 .",
    "this must be performed before starting the actual calculation of the green s functions .",
    "we will return on this aspect in appendix [ h1problem ] . for the moment we assume that @xmath133 has been regularized and it is neither singular nor ill - conditioned .    when using orthogonal basis sets the knowledge of @xmath5 and @xmath136 is sufficient to construct the retarded green s function for the doubly - infinite system , which has the form @xcite @xmath137 where the summation runs over both real and imaginary @xmath138 . in equation ( [ gfans ] )",
    "@xmath138 ( @xmath139 ) are chosen to be the right - moving or right - decaying ( left - moving or left - decaying ) bloch states , i.e. those with either positive group velocity or having @xmath5-vector with positive imaginary part ( negative group velocity or negative imaginary part ) .",
    "@xmath140 are the corresponding vectors , and @xmath141 is defined in reference [ ] .",
    "finally @xmath142 is just the dual of @xmath140 obtained from @xmath143 in the case of a non - orthogonal basis set the same expression is still valid if @xmath141 is now defined as follows @xmath144.\\ ] ] finally the surface green s functions for a semi - infinite system can be obtained from those of the doubly - infinite one by an appropriate choice of boundary conditions . for instance",
    "if we subtract the term @xmath145 from @xmath146 of equation ( [ gfans ] ) we obtain a new retarded green s function vanishing at @xmath147 .",
    "note that @xmath148 is a linear combination of eigenvectors and therefore does not alter the causality of @xmath78 .    in this way we obtain the final expression for the retarded surface green s functions of both the left- and right - hand side",
    "lead @xmath149 { v}^{-1 } , \\\\ { g}_\\mathrm{r}^{0\\mathrm{r } } & = & \\left [ i_\\mathrm{n } - \\sum_{l , h } \\phi_{k_h}e^{i k_h}\\phi_{k_h}^\\dagger \\phi_{\\bar{k}_l}e^{-i \\bar{k}_l}\\phi_{\\bar{k}_l}^\\dagger\\right]{v}^{-1}.\\end{aligned}\\ ] ] these need to be computed at the beginning of the calculation only .",
    "the formalism presented in sections [ negf ] through [ leads ] is rather general and is not specific of a particular functional dependence of the hamiltonian upon the charge density .",
    "therefore one can use on the same footing hamiltonian theories ranging from parameterized self - consistent tight - binding methods @xcite to density functional theory @xcite .",
    "_ smeagol _ uses dft as its main electronic structure method .    at this point",
    "it is important to observe that _",
    "smeagol _ , and indeed any other negf dft - based scheme , simply uses the kohn - sham hamiltonian @xcite as a single particle hamiltonian .",
    "this means that the non - equilibrium charge density obtained through the negf method ( equations ( [ d_equil ] ) and ( [ d_out_equil ] ) ) is not by any mean associated with any variational principle and certainly does not minimise the density functional , nor makes it stationary .",
    "the only exception is for zero bias , where the method presented here is just a clever alternative for solving an equilibrium problem for an infinite non - periodic system .",
    "although it is common practice , it is therefore misleading and incorrect to refer to our method as dft - based negf , since the hohenberg - kohn theorem can not be applied @xcite . some additional discussion over this issue can be found in reference [ ] .",
    "although _ smeagol _ is constructed in a simple and modular way and can be readily interfaced with any dft package based on a lao basis set , for the present implementation we have used the existing code _",
    "siesta _ @xcite .",
    "_ siesta _ is a mature numerical implementation of dft , which has been specifically designed for tackling problems involving a large number of atoms .",
    "it uses norm conserving pseudopotentials in the separate kleinman - bylander form @xcite , and most importantly a very efficient lao basis set @xcite .",
    "one important aspect that deserves a mention is the way in which we calculate the hartree ( electrostatic ) potential for the extended molecule under bias .",
    "clearly the easier and more transparent way would be that of solving the poisson s equation in real space with appropriate boundary conditions . however this usually is numerically less efficient then solving it in @xmath5-space using the fast fourier transform algorithm .",
    "_ siesta _ uses this second strategy and so does _ smeagol_. in _ smeagol _ the electrostatic potential is then calculated for the infinite system obtained by repeating periodically the extended molecule along the transport direction ( see figure [ fig3 ] ) .",
    "however , before solving the poisson s equation for such a system we add to the hartree potential a saw - like term , whose drop is identical to the bias applied . for convergence reasons we often add at both edges of the scattering region two buffer layers , in which the external potential is only a constant and the density matrix is that of the leads and is not evaluated self - consistently .        in summary a typical _ smeagol _ calculation proceeds as follows .",
    "first one computes the leads self - energies over a range of energies @xmath46 as large as the bandwidth of the materials forming the leads .",
    "these are then stored either in memory or on disk depending on the size of the leads .",
    "then the proper _ smeagol _ calculation is performed following the prescription described in the previous sections .",
    "we now present several test cases demonstrating the capabilities of _ smeagol_. they address key aspects of the code such as the electrostatics , the calculation of the transmission coefficients , the calculation of the @xmath0-@xmath1 characteristic , the spin - polarization and the spin non - collinearity .      as first simple test we present the case of a parallel plate capacitor , constructed from two infinite fcc gold surfaces separated by a vacuum region 12.3    long .",
    "clearly we do not expect transport across this device ( with the exception of a tiny tunneling current ) , but it is a good benchmark of the _ smeagol _ ability to describe the electrostatics of a device .",
    "the two gold surfaces are oriented along the ( 100 ) direction and the unit cell has only one atom in the cross section .",
    "the extended molecule comprises seven atomic planes in the direction of the transport , which is enough for achieving a good convergence of the hartree potential ( the thomas - fermi screening length in gold is @xmath1500.6@xcite ) . for the calculation we use 100 @xmath5-points in the full brillouin zone in the transverse direction , a single zeta basis set for the @xmath135 , @xmath151 and @xmath134 orbitals and standard local density approximation ( lda ) of the exchange and correlation potential .    in figure [ fig4 ] we present the planar average of the hartree ( electrostatic ) potential @xmath152 , the difference between the planar average of hartree potential at finite bias and that at zero bias @xmath153 , and the difference @xmath154 between of the planar average of the charge density along the direction of the transport for a given bias and that at zero bias .     for an infinite parallel - plate capacitor",
    "b ) difference between the planar average of the hartree potential at a given bias and that at zero bias @xmath153 .",
    "c ) difference @xmath154 between of the planar average of the charge density along the direction of the transport for a given bias and that at zero bias .",
    "the dots indicates the position of gold planes.,width=302 ]    the quantities shown in the picture are those expected from the classical physics of a parallel plate capacitor . in the leads the electrostatic potential shows oscillations with a period corresponding to that of the separation between the gold planes , but with a constant average .",
    "in contrast in the vacuum region the potential is much higher , since there are no contributions from the nuclei , but it is uniform . if we eliminate the oscillations , by subtracting the zero bias potential from that obtained at finite bias ( figure [ fig4]b ) , we obtain a constant potential profile in the leads and a linear drop in the vacuum region .",
    "finally the macroscopic average of the charge density shows charge accumulation on the surfaces of the capacitor and local charge neutrality in the leads region as expected from a capacitor .",
    "metallic quantum point contacts ( pcs ) present conductance quantization at room temperature @xcite a property that has been predicted theoretically for many years@xcite .",
    "recently , rodrigues _ et al . _",
    "have shown that in a point contact the crystallographic orientation of the atomic tips forming the junction plays an important rle in determining transport properties @xcite",
    ". therefore , a realistic theoretical description of the electronic transport in pcs must take into consideration the atomistic aspects of the problem .",
    "as an example we have performed calculations for a [ 100]-oriented gold quantum point contact ( see inset of figure [ fig5 ] ) .",
    "a single gold atom is trapped at its equilibrium position between two [ 100 ] fcc pyramids .",
    "this is the expected configuration for such a specific crystal orientation , and the configuration likely to form in breaking junction experiments for small elongation of the junction .",
    "this has been confirmed by atomic resolution tem images @xcite . in this case",
    "we have used lda and a single zeta basis set for @xmath135 , @xmath151 and @xmath134 orbitals .",
    "the unit cell of the extended molecule now contains 141 atoms ( seven planes of the leads are included ) and we consider periodic boundary conditions with 16 @xmath5-points in the 2-d brillouin zone .     direction . in the lower panel the bandstructure for a monoatomic gold chain with lattice constant equal to the au - au separation in bulk gold .",
    "the inset shows a ball - and - stick representation of the atomic positions of the pc ( the extended molecule).,width=321 ]    in figure [ fig5 ] we present the zero - bias transmission coefficient as a function of energy .",
    "recalling that the linear response conductance is simply @xmath155 ( in this case we have complete spin - degeneracy ) our calculation shows one quantum conductance for this point contact .",
    "interestingly the transmission coefficient is a rather smooth function @xmath156 for a rather broad energy range around @xmath81 .",
    "this means that the @xmath157 result is stable against the fluctuations of the position of the fermi level , which may be encountered experimentally .",
    "the large plateau at @xmath156 indicates the presence of a single conductance channel for energies around and above @xmath81 .",
    "this is expected from the bandstructure of a straight monoatomic gold chain with lattice parameter equal to the au - au separation in bulk gold ( see figure [ fig5]b ) , which presents only one @xmath135 band for such energy range .",
    "therefore we conclude that the transport at the fermi level is dominated by a single low - scattering @xmath135 channel .",
    "notably for energies 1  ev below @xmath81 the transmission coefficient shows values exceeding one , which are due to contributions from @xmath134 orbitals . in gold mono - atomic chains these are",
    "substantially closer to @xmath81 than in bulk gold and participate to the transport .",
    "these results are in good agreement with previously reported calculations @xcite and experimental data @xcite .",
    "additional examples of _ smeagol _ s calculations for pcs carried out by the authors can be found elsewhere in the literature @xcite .",
    "the study of the @xmath0-@xmath1 characteristics of magnetic systems at the nanoscale is one of _ smeagol _ s main goals .",
    "the most typical among spin devices is the magnetic spin - valve , which is obtained by sandwiching a non - magnetic spacer between two magnetic contacts .",
    "the direction of the magnetization in the two contacts can be arbitrarily changed by applying a magnetic field .",
    "the device then switches from a low resistance state , when the magnetization vectors in the leads are parallel to each other , to a high resistance state when the alignment of the magnetizations is antiparallel .",
    "this is the giant magnetoresistance effect @xcite , which is at the foundation of modern hard - disk reading technology .",
    "traditional spin - valves use either metals or inorganic insulators as spacers .",
    "however a recent series of experiments have shown that organic molecules can serve the same purpose and a rather large gmr can be found @xcite .",
    "these experiments could lead to integrating the functionalities of molecules with spin - systems , and therefore have the potential to merge together the fields of spin- and molecular - electronics .",
    "the calculation of the transport properties of molecular spin - valves is a tough theoretical problem .",
    "it involves the computation of accurate electronic structures for magnetic surfaces , the charging properties of molecules , and the knowledge of the actual atomic positions . in a recent paper @xcite we have demonstrated that molecules can efficiently be employed in spin - valves .",
    "moreover we have shown that @xmath158-conjugated conducting molecules produce larger gmr then their insulating counterparts .",
    "most of the effect is due to the orbital selectivity of the molecule / metal bonding , which in transition metals translates to a spin - selectivity . here",
    "we further expand this concept and we demonstrate that the gmr can be tuned by molecular end - group engineering .",
    "-@xmath1 characteristics for both the parallel and antiparallel alignment of the leads and the inset the corresponding gmr ratio .",
    "the lower panel is the transmission coefficient at zero bias as a function of energy .",
    "because of spin - symmetry , in the antiparallel case we plot only the majority spin.,width=283 ]    the system under investigation is a 1,4-phenyl molecule attached to two fcc ni surfaces oriented along the ( 001 ) direction .",
    "the molecules are attached to the ni hollow site through a thiol - like group where we use s , se and te as anchoring atoms .",
    "we consider collinear spin only and investigate the @xmath0-@xmath1 characteristic assuming the magnetization vectors in the current / voltage contacts to be either parallel ( p ) or antiparallel ( ap ) to each other .",
    "the size of the gmr effect is expressed by the gmr ratio @xmath159 , which is defined as @xmath160 , with @xmath161 ( @xmath162 ) the current in the parallel ( antiparallel ) state . at zero bias ,",
    "when all the currents vanish , we replace them with the conductances .",
    "we construct the unit cell of the extended molecule to include four ni atomic planes on each side , for a total of forty ni atoms .",
    "the basis set is critical and a single zeta for all the orbitals is not sufficient .",
    "therefore we have used single zeta for h , c and s @xmath135 orbitals , double zeta for ni @xmath135 , @xmath151 and @xmath134 , and double zeta polarized for c and s @xmath151 orbitals .",
    "this basis gives us a hamiltonian with over a thousand degrees of freedom .",
    "finally the charge density is obtained by integrating the green s function over 50 imaginary and 600 real energies .    in figures",
    "[ fig6 ] , [ fig7 ] and [ fig8 ] we present the @xmath0-@xmath1 characteristics , the zero bias transmission coefficient as a function of energy , and the gmr ratio as a function of bias for the three anchoring situations ( s , se , te ) .",
    "clearly all the three cases show a large gmr , particularly for small biases .",
    "interestingly the maximum gmr increases when going from s to se to te , and this is correlated with a general reduction of the total transmission and consequently of the current .",
    "such a reduction is more pronounced in the case of antiparallel alignment of the leads and this gives rise to the increase in gmr .",
    "the origin of the drastic reduction of the transmission when changing the anchoring groups has to be found in the different bonding structure . since s ,",
    "se and te all belong to the same row of the periodic table , the orbital nature of the bonding to the ni surface is left unchanged , and so are the generic features of the transmission coefficient .",
    "however the bond distance goes from 1.28  to 1.48  to 1.77  when going from s to se to te .",
    "this large increase in the bond distance is responsible for the reduction in transmission .",
    "-@xmath1 characteristics for both the parallel and antiparallel alignment of the leads and the inset the corresponding gmr ratio .",
    "the lower panel is the transmission coefficient at zero bias as a function of energy . because of spin - symmetry , in the antiparallel case we plot only the majority spin.,width=283 ]",
    "the most relevant features of the transmission coefficient can be understood in terms of tunneling through a single molecular state @xcite .",
    "if we define @xmath163 ( @xmath164 ) as the majority ( minority ) spin hopping integral from one of the leads to the molecular state , then the total transmission coefficient through the entire device in the parallel alignment will be simply @xmath165 . here the total transmission coefficient for majority ( minority ) spin is @xmath166 ( @xmath167 ) .",
    "similarly in the case of antiparallel alignment of the leads we have @xmath168 . in this simple description , which neglects both co - tunnelling and multiple scattering from the contacts , @xmath169 turns out to be a convolution of the transmission coefficients for the parallel case @xmath170 .",
    "this type of behavior can be appreciated in figures [ fig6 ] , [ fig7 ] and [ fig8 ] .",
    "-@xmath1 characteristics for both the parallel and antiparallel alignment of the leads and the inset the corresponding gmr ratio .",
    "the lower panel is the transmission coefficient at zero bias as a function of energy .",
    "because of spin - symmetry , in the antiparallel case we plot only the majority spin.,width=283 ]    it is important to note that the large gmr ratio is ultimately due to the low transmission around @xmath81 in the antiparallel case , which originates from the small transmission of the minority spins in the parallel case through the relation @xmath171 .",
    "this is surprising since the density of states for minority spins at the fermi level is rather large and one may expect substantial transmission .",
    "moreover @xmath135-like electrons , which are weakly affected by the spin orientation , generally contribute heavily to the current regardless of the magnetic state of the device .",
    "therefore , what does block the minority spin electrons ?",
    "a detailed analysis of the local density of states of the molecule attached to the leads @xcite reveals that the bonding of the molecule to the ni surface is through ni @xmath134 and s @xmath151 orbitals ( the same is valid for se and te ) .",
    "the transport is therefore through hybrid ni  @xmath134-s  @xmath151 states , which in turns are spin - split due to the ferromagnetism of ni .",
    "the crucial point here is that for the minority band these states end up above the fermi level , and therefore do not contribute to the low bias transport .",
    "this is an important observation , since it demonstrates that orbital selectivity in magnetic systems can produce a spin - selectivity , and therefore magnetoresistance type of effects .",
    "the transport properties of magnetic transition metal point contacts have been the subject of several recent investigations .",
    "technologically these systems are attractive since they can be used as building blocks for read heads in ultra - high density magnetic data storage devices . from a more fundamental point of view",
    "they offer the chance to investigate magnetotransport at the atomic level .",
    "magnetic point contacts are effectively spin - valve - like devices , with the spacer now replaced by a narrow constriction where a sharp domain wall can nucleate @xcite . therefore the magnetoresistance can be associated with domain - wall scattering and the mr ratio can be defined earlier .    a simple argument based on the assumption that all the valence electrons can be transmitted with @xmath156 gives an upper bound for the gmr of the order of a few percent ( 100% in the case of nickel ) .",
    "this however may be rather optimistic since one expects the @xmath134 electrons to undergo quite some severe scattering .",
    "indeed small values of gmr for ni point contacts have been measured @xcite .",
    "surprisingly at the same time other groups have measured huge gmr for the same system @xcite .",
    "although mechanical effects can be behind these large values @xcite , the question on whether or not a large gmr of electronic origin can be found in point contacts remains .",
    "therefore we investigate the zero bias conductance of a four atom long monoatomic ni chain sandwiched between two ni ( 001 ) surfaces ( see figure [ fig9 ] ) .",
    "this is an extreme situation rarely found in actual break junctions @xcite .",
    "however an abrupt domain wall ( one atomic spacing long ) in a monoatomic chain is the smallest domain wall possible , and it is expected to show the larger gmr . for this reason",
    "our calculations represent an upper bound on the gmr obtainable in ni only devices , and they also serve also as a test of the _ smeagol _ capability for dealing with non - collinear spin .        in this calculation",
    "we use a double zeta basis set for @xmath135 , @xmath151 and @xmath134 orbitals and consider finite leads ( no periodic boundary conditions are applied ) with either four or five atoms in the cross section .",
    "we then investigate two possible situations . in the first one we place the domain wall symmetrically with respect to the leads , i.e. between the second and the third atom of the chain . in the second ( asymmetric )",
    "the domain wall is positioned between the third and the fourth atom .",
    "furthermore we perform spin - collinear and spin - non - collinear calculations for both cases .",
    "interestingly all our non - collinear calculations always converge to a final collinear solution .",
    "this confirms expectations based on simple @xmath135-@xmath134 model @xcite , suggesting that the strong exchange coupling between the conduction electrons and those responsible for the ferromagnetism , stabilize the collinear state if the magnetization vectors of the leads are collinear .    in figure [ fig10 ] we present the transmission coefficient as a function of the energy for both the symmetric and asymmetric case and the parallel state .",
    "for collinear calculations the contributions from majority and minority spins are plotted separately , while we have only one transmission coefficient in the non - collinear case .",
    "clearly in all cases the non - collinear solution agrees closely with the collinear one , i.e. @xmath172 .",
    "this is expected since the final magnetic arrangement of the non - collinear calculation is actually collinear , and it is a good test for our computational scheme .    .",
    "the right - hand side panels ( a ) are for collinear calculations and the left - hand - side ( b ) are for non - collinear ; ( 1 ) parallel state , ( 2 ) antiparallel with symmetric domain wall , ( 3 ) antiparallel with asymmetric domain wall . note that in the non - collinear case we do not distinguish between majority and minority spins . in panel ( a2 )",
    "majority and minority spins are degenerate.,width=321 ]    turning our attention to the features of the transmission coefficient it is evident that at the fermi level @xmath98 in the parallel state is larger than that in the antiparallel .",
    "this difference however is not large and the gmr ratio is about 60% with little difference between the symmetric and asymmetric domain wall .",
    "this is mainly due to the much higher transmission of the un - polarized @xmath135 electrons compared with that of the @xmath134 .",
    "note that the conductance approaches @xmath173 for energies approximately 0.5  ev above the fermi level .",
    "for such energies in fact no @xmath134 electrons contribute to the density of states of both the spin sub - bands , and only @xmath135 electrons are left .",
    "these are then transmitted with @xmath156 as in the case of au chains investigated previously .",
    "the crucial point is that the contribution of the @xmath135 electrons is also large at the fermi level .",
    "this results in a poorly spin - polarized current at low bias and consequently in a small gmr , in agreement with other calculations @xcite . in conclusion",
    "our finding rules against the possibility of large gmr from electronic origin in ni point contacts .",
    "however the presence of non - magnetic contamination ( for example oxygen ) may change this picture radically .",
    "the aim of this section is to show how strongly the transmission coefficients may depend on the leads cross section , whenever @xmath134 electrons are close to @xmath81 . as an example , we present results for the h@xmath3 molecule sandwiched between fcc pt(001 ) leads , and compare leads of different sections with extended leads .",
    "these are obtained by applying periodic boundary conditions and a sampling over the @xmath5-points along the direction orthogonal to that of transport .",
    "the conductance of an h@xmath3 molecule sandwiched between platinum electrodes has been extensively studied @xcite . experimentally @xcite it has been found that the inclusion of hydrogen gas into the vacuum chamber produces a dramatic change in the conductance histograms of platinum , which change from a structure with a broad peak at 1.5 @xmath174 to a structure with a sharp peak at 1 @xmath174 .",
    "this resonance has been attributed to the conductance through a single molecule , which bridges both leads lying parallel to the current flow .",
    "this explanation has been confirmed by theoretical calculations @xcite .",
    "molecule sandwiched between fcc platinum leads near the equilibrium distances ( @xmath150 9.5 and 11  ) . the left hand side ( a ) corresponds to the configuration where the molecule lies parallel to the current flow and the right hand side ( b ) to the configuration where the molecule lies perpendicular .",
    "the leads are made of alternating slabs of 4 - 5 atoms ( 1 ) and 9 - 12 atoms ( 2 ) without periodic boundary conditions along the perpendicular directions ( @xmath175 ) , and 9 - 9 atoms with periodic boundary conditions along @xmath175 ( 3 ) . in the last case",
    "the dashed and continuous lines have been obtained with 4 and 12 @xmath5 points , respectively.,width=321 ]    in our calculations the h@xmath3 molecules is located either parallel or perpendicular to the current flow . a detailed description of the geometric configuration and the results can also be found in reference [ ] .",
    "we use a double zeta polarized basis set for platinum @xmath135 , @xmath151 and @xmath134 orbital , a double zeta for the hydrogen @xmath135 electrons and the lda functional . as a first step we employ finite cross section leads along the transversal directions , composed of alternated planes containing 4 and 5 atoms each .",
    "the resulting transmission coefficients show many peaks and gaps throughout all the energy range and particularly sharp variations around the fermi energy , as can be seen in figures [ fig11 ] ( a1 ) and ( b1 ) .",
    "when thicker slabs composed of alternating planes of 9 and 12 atoms are employed the results do not improve and the large oscillations still remain , as shown in figures [ fig11 ] ( a2 ) and ( b2 ) .",
    "it is apparent from these figures that while @xmath83 shows a long plateau at positive energies , it presents strong oscillations at the fermi energy and , therefore , it is uncertain to infer the conductance of the junction from @xmath176 ) .",
    "this is in stark contrast with the case of gold , where the @xmath134-levels lie below @xmath81 , and @xmath83 is smooth regardless of the size of the leads cross section",
    ". for platinum the presence of @xmath134-states at the fermi energy opens minibands and minigaps , which translate into strong oscillations in @xmath177 .",
    "these minibands and minigaps arise from interference effects of the @xmath134-states along the transverse direction .",
    "consequently , oscillations in @xmath83 should disappear when bulk electrodes are used .",
    "indeed , this is what we find when slabs made of 3@xmath1783 atomic planes and periodic boundary conditions are employed , as shown in figures [ fig11 ] ( a3 ) and ( b3 ) .",
    "we moreover show how @xmath83 converges when the number of transverse @xmath5 points is increased from 4 to 12 .",
    "although some small variations and peaks still remain when 4 @xmath5 points are used , the transmission at the fermi level is essentially converged .",
    "note that the parallel case has @xmath156 for a long range of energies around @xmath179 , which remains essentially unperturbed for small variations of the coordinates or the distance between the electrodes .",
    "this explains the sharp peak observed in the experimental conductance histograms @xcite .    in view of the above calculations we can therefore conclude that the use of bulk electrodes , characterized by periodic boundary conditions along the perpendicular directions and @xmath5 points , is mandatory in order to avoid oscillations in the transmission coefficients .",
    "otherwise the presence of strong variations and minigaps can give unphysical solutions for systems with open @xmath134 shells .",
    "we have presented a description of our newly developed non - equilibrium green s function code _ smeagol_. in the present version _ smeagol _ uses the dft implementation contained in _",
    "siesta _ as the underlying electronic structure method .",
    "however the code has been developed in a modular and general form and can be easily combined with any electronic structure scheme based on localized orbital basis set .",
    "the core of _ smeagol _ is our new algorithm for calculating the surface green s functions of the leads , which combines generalized singular value decomposition with decimation .",
    "this results in an un - precedent numerical stability for a quantum transport code , and in the possibility of drastically reducing the number of degrees of freedom in the leads . in this way large current / voltage probes with complicated electronic structure can be tackled .",
    "we have also presented a selection of results obtained with _ smeagol_. these range from simple tests for the electrostatics to an analysis of the gmr in molecular spin - valves , and demonstrate the _ smeagol _ s ability to tackle very different problems .",
    "the authors thank k.  burke and t.  todorov for discussion .",
    "this work is sponsored by science foundation of ireland under the grant sfi02/in1/i175 , the uk epsrc and the eu network mrtn - ct-2003 - 504574 rtnnano .",
    "jf and vmgs thank the spanish ministerio de educacin y ciencia for financial support ( grants bfm2003 - 03156 and ap2000 - 4454 ) .",
    "arr thanks enterprise ireland ( grant ei - sc/2002/10 ) for financial support .",
    "traveling has been sponsored by the royal irish academy under the international exchanges grant scheme .",
    "the method presented in section [ leads ] to calculate the leads green s functions depends crucially on the fact that the coupling matrix between principal layers @xmath180 is invertible and not ill - defined .",
    "however this is not necessarily the case since singularities can be present in @xmath133 as the result of poor coupling between pls or because of symmetry reasons .",
    "note also that since @xmath180 the rank of @xmath133 may also depend on the energy @xmath46 .",
    "we now give a few examples illustrating how these singularities arise .",
    "let us consider for the sake of simplicity an orthogonal nearest neighbour tight - binding model with only one @xmath135-like basis function per atom .",
    "in this case @xmath181 is independent from the energy . in figure [ figa1 ]",
    "we present four possible cases for which @xmath26 is singular .",
    "is singular : ( a ) lack of bonding , ( b ) supercell , ( c ) over - bonding , ( d ) odd bonding .",
    "each black dot represents an atom and each line a bond .",
    "the dashed boxes enclose a principal layer.,width=245 ]    in the picture the dots represent the atomic position , the lines the bonds and the dashed boxes enclose a pl .",
    "all the bonds are assumed to have the same strength , thus all hopping integrals @xmath182 are identical .    in the first case ( figure [ figa1]a ) the pl",
    "coincides with the primitive unit cell of the system and therefore it is the smaller principal layer that can be constructed .",
    "however since every second atom in the cell does not couple with its mirror in the two adjacent cells @xmath26 has the form @xmath183 and therefore is singular .",
    "this is the case of `` lack of bonding '' between principal layers .",
    "it is the most common case and almost always present when dealing with transition metals , since localized @xmath134 shells coexist with delocalized @xmath135 orbitals .",
    "figure [ figa1]b presents a different possibility . here",
    "the pl is a supercell constructed from two unit cells and every atom in the pl couples with atoms located in only one of the two adjacent pls . in this case @xmath184 which is again singular .",
    "clearly in this specific case one can reduce the principal layer to be the primitive unit cell solving the problem ( @xmath26 become a scalar @xmath182 ) .",
    "however in a multi - orbital scheme the supercell drawn may be the smallest pl possible and the problem will appear .",
    "again this is a rather typical situation when dealing with transition metals .",
    "the case of `` overbonding '' is shown in figure [ figa1]c .",
    "again the pl coincides with the primitive unit cell , but now every atom in the pl is coupled to all the atoms in the two adjacent pls . in this case",
    "@xmath185 which is not invertible .",
    "finally the `` odd bonding '' case is presented in figure [ figa1]d .",
    "also in this case the pl coincides with the primitive unit cell , however the upper atom in the cell is coupled only to atoms in the right nearest neighbour principal layer .",
    "the @xmath26 matrix is then ( we label as `` 1 '' the upper atom in the cell ) @xmath186 i.e. it is singular .",
    "clearly the above categorization is basis dependent , since one can always find a unitary rotation transforming a generic @xmath26 in a new matrix of the form of equation ( [ h14 ] ) .",
    "we now present the first step of a scheme for regularizing @xmath133 , and indeed the whole hamiltonian and overlap matrix , by removing their singularities . in the cases of `` lack of bonding '' , `` supercell '' and `` odd bonding '' presented in the previous section the singularities of @xmath181 were well defined since an entire column was zero .",
    "however more generally , and in particular in the case of multiple zetas basis set , @xmath133 is singular without having such a simple structure ( for instance as in the `` overbonding '' case ) .",
    "this is the most typical situation and a method for identifying the singularities is needed .",
    "the ultimate goal is to perform a unitary transformation of both @xmath23 and @xmath36 in such a way that the off - diagonal blocks of the leads hamiltonian and overlap matrix ( @xmath26 and @xmath38 ) assume the form @xmath187 \\end{array } = \\left ( \\begin{array}{cccccc } 0 & 0 & \\cdots & a_{1,n - r+1 } & \\cdots & a_{1,n } \\\\ 0 & 0 & \\cdots & a_{2,n - r+1 } & \\cdots & a_{2,n } \\\\ 0 & 0 & \\cdots & a_{3,n - r+1 } & \\cdots & a_{3,n } \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots \\\\ 0 & 0 & \\cdots & a_{n , n - r+1 } & \\cdots & a_{n , n } \\\\",
    "\\end{array } \\label{blockform } \\right)\\:,\\ ] ] i.e. they are @xmath13 block matrices of rank @xmath188 , whose first @xmath189 columns vanish . in this form",
    "the problem is re - conducted to the problem of `` odd bonding '' presented in the previous section .",
    "this can be achieved by performing a generalized singular value decomposition ( gsvd ) @xcite .",
    "the idea is that a pair of @xmath13 matrices , in this case @xmath26 and @xmath38 , can be written in the following form @xmath190q^\\dagger , \\\\",
    "s_{1}= v\\lambda_2\\left[0,w\\right]q^\\dagger,\\end{aligned}\\ ] ] with @xmath191 , @xmath1 and @xmath192 unitary @xmath13 matrices and @xmath193 being a @xmath194 non - singular triangular matrix where @xmath188 is the rank of the @xmath195 matrix @xmath196 $ ] ( @xmath197 ) .",
    "the matrices @xmath198 and @xmath199 are defined as follows : @xmath200 @xmath201 where @xmath202 is the rank of @xmath38 , @xmath203 , @xmath204 is the @xmath205 unit matrix and @xmath206 and @xmath207 are matrices to determine .",
    "clearly the two matrices @xmath26 and @xmath38 have the two common generators @xmath193 and @xmath192 .",
    "then , one can perform a unitary transformation of both @xmath26 and @xmath38 by using @xmath192 , obtaining @xmath208= \\begin{array}{rc }    & \\scriptstyle{n - r } \\ \\ \\ \\scriptstyle{r } \\\\ \\scriptstyle{n } & \\left [ \\begin{array}{ccc } 0 &   , & \\bar{h}_{1 } \\end{array}\\right ] \\end{array}\\label{h1bar } \\\\ s_1^q = q^\\dagger",
    "s_1q = q^\\dagger v\\lambda_2\\left[0,w\\right]= \\begin{array}{cc }    & \\scriptstyle{n - r } \\ \\ \\ \\scriptstyle{r } \\\\ \\scriptstyle{n } & \\left[\\begin{array}{ccc } 0 & , & \\bar{s}_{1 } \\end{array}\\right ] .",
    "\\end{array}\\end{aligned}\\ ] ] here @xmath209 and @xmath210 are the @xmath211 non - vanishing blocks of the gsvd transformed matrices @xmath26 and @xmath38 respectively .    in an analogous way the same transformation for @xmath212 , @xmath213 , @xmath24 and @xmath37 leads to @xmath214 \\end{array } \\\\ { s^q_1}^\\dagger = q^\\dagger s_1^\\dagger q = \\begin{array}{cc }    & \\scriptstyle{n } \\\\",
    "\\begin{array}{c } \\scriptstyle{n - r } \\\\ \\scriptstyle{r } \\end{array } & \\left[\\begin{array}{c } 0 \\\\ \\bar{s}_{1}^\\dagger \\end{array}\\right ] \\end{array } \\\\",
    "h_0^q = q^\\dagger h_0q\\ : , \\\\",
    "s_0^q = q^\\dagger s_0q\\:,\\end{aligned}\\ ] ] where the transformed matrices @xmath215 and @xmath216 are not necessarily in the form of equation ( [ blockform ] ) .",
    "we are now in the position of writing the final unitary transformations for the total ( infinite ) hamiltonian @xmath23 and overlap @xmath36 matrices describing the whole system ( leads plus extended molecule ) .",
    "these are given by @xmath217 and @xmath218 with the infinite matrix @xmath219 defined as @xmath220[qtransf ] where @xmath59 is the @xmath28 unit matrix .",
    "note that this unitary transformation rotates all the @xmath26 matrices ( the @xmath38 matrices in the case of @xmath36 ) , but it leaves @xmath27 ( @xmath41 ) unchanged .",
    "finally the matrices coupling the extended molecule to the leads transform as following @xmath221 and so do the corresponding matrices of @xmath36 .      now that both @xmath23 and @xmath36 have been written in a convenient form we can efficiently renormalize them out .",
    "the key observation is that the two ( infinite ) blocks describing the leads have now the following structure ( the @xmath36 matrix has an analogous structure and it is not shown here explicitly )    @xmath223       & 0       & \\cdots \\\\",
    "\\cdots & \\left[\\begin{array}{c } 0 \\\\ \\bar{h}_1^\\dagger \\end{array}\\right ]   & \\left(\\begin{array}{cc } c & b \\\\ b^\\dagger & d \\end{array}\\right )   & \\left[\\begin{array}{cc } 0 & \\bar{h}_1 \\\\ \\end{array}\\right ]     & \\cdots \\\\ \\cdots & 0       & \\left[\\begin{array}{c } 0 \\\\ \\bar{h}_1^\\dagger \\end{array}\\right ] & \\left(\\begin{array}{cc } c & b \\\\ b^\\dagger & d \\end{array}\\right )     & \\cdots \\\\         & \\vdots & \\vdots & \\vdots & \\ddots \\end{array}\\right)\\ : , \\label{matform}\\ ] ]    where the matrices @xmath224 , @xmath225 and @xmath206 are respectively @xmath226 , @xmath227 and @xmath228 .",
    "note that the degrees of freedom ( orbitals ) contained in the block @xmath206 of the matrix @xmath229 couple to those of only one of the two adjacent pls .",
    "this situation is the generalization to a multi - orbital non - orthogonal tight - binding model of the `` odd bonding '' case discussed at the beginning of this appendix ( figure [ figa1]d ) .",
    "these degrees of freedom are somehow redundant and they will be eliminated .",
    "we therefore proceed with performing gaussian elimination @xcite ( also known as `` decimation '' ) of all the degrees of freedom associated to all the blocks @xmath206 .",
    "the idea is that the schrdinger equation @xmath230{\\cal q}\\psi=0 $ ] can be re - arranged in such a way that a subset of degrees of freedom ( in this case those associated to orbitals in a pl that couple only to one adjacent pl ) do not appear explicitly .",
    "the procedure is recursive .",
    "let us suppose we wish to eliminate the @xmath231-th row and column of the matrix @xmath232{\\cal q}$ ] .",
    "this can be done by re - arranging the remaining matrix elements according to @xmath233 the dimension of the resulting new matrix @xmath234 ( `` 1 '' indicates that one decimation has been performed ) is reduced by one with respect to the original @xmath235 .",
    "this procedure is then repeated and after @xmath236 decimations we obtain a matrix @xmath237 let us now decimate all the matrix elements contained in all the sub - matrices @xmath206 .",
    "we obtain a new tridiagonal matrix @xmath238 ( `` @xmath239 '' means that an infinite number of decimations have been performed ) of the form @xmath240 where @xmath241 , @xmath242 and @xmath243 .",
    "the crucial point is that the new matrix @xmath244 is still in the desired tridiagonal form , but now the coupling matrices between principal layers @xmath245 are not singular .",
    "these are now @xmath226 matrices obtained from the decimation of the non - coupled degrees of freedom of the matrices @xmath246 ( the @xmath206 blocks ) .",
    "moreover the elimination of degrees of freedom achieved with the decimation scheme is carried out only in the leads .",
    "the electronic structure of these is not updated during the self - consistent procedure for evaluating the green s function , and therefore the information regarding the decimated degrees of freedom are not necessary .",
    "in contrast the degrees of freedom of the scattering region are not affected by the decimation or the rotation .",
    "therefore the matrix @xmath247 is unaffected by the decimation .    in the decimated matrix @xmath238 new terms",
    "appear ( @xmath248 , @xmath249 , @xmath250 and @xmath251 ) .",
    "these arise from the specific structure of the starting matrix @xmath230{\\cal q}$ ] and from the fact that the complete system ( leads plus scattering region ) is not periodic .",
    "in fact assuming that @xmath121 is the last principal layer of the left - hand side lead and @xmath231 is the first layer of right - hand side lead , the decimation is carried out up to @xmath252 to the left and starts from @xmath231 to the right of the scattering region .",
    "this allows us to preserve the tridiagonal form of @xmath253 and at the same time to leave @xmath247 unchanged .",
    "a schematic picture of the decimation strategy is illustrated in figure [ figa2 ] .",
    "matrix @xmath235 .",
    "every symbol ( dots , boxes .. ) represents a collection of degrees of freedom ( a matrix block ) and every line the coupling .",
    "( a ) original structure after the rotation @xmath219 . in the periodic leads the upper black dots represent the blocks @xmath206 of the matrix of equation ( [ matform ] ) .",
    "the large white rectangular box represents the scattering region .",
    "( b ) the degrees of freedom marked with the red crosses are decimated .",
    "( c ) final structure after decimation .",
    "the new white symbols represent the leads degrees of freedom of the principal layers adjacent to the scattering region as they appear after the decimation.,width=283 ]    in practical terms all the blocks of the infinite matrix of equation ( [ dechamil ] ) can be calculated by decimating auxiliary finite matrices .",
    "in particular    1 .",
    "@xmath254 , @xmath245 and @xmath249 are calculated by decimating both the @xmath206 matrices of the following finite @xmath255 matrix @xmath256 \\\\ \\left[\\begin{array}{c } 0 \\\\ { \\bar{k}_1^{\\dagger } } \\end{array}\\right ]   &   \\left(\\begin{array}{cc } c & b \\\\ b^\\dagger & d \\end{array}\\right ) \\\\ \\end{array}\\right)\\longrightarrow \\left(\\begin{array}{cc } d_2 & \\theta \\\\ \\theta^\\dagger & \\delta \\end{array}\\right)\\:,\\ ] ] where @xmath257 and @xmath258 2 .",
    "@xmath248 and @xmath250 are calculated by decimating only the upper @xmath206 matrix of the same finite @xmath255 matrix @xmath256 \\\\ \\left[\\begin{array}{c } 0 \\\\ { \\bar{k}^{\\dagger}_1 } \\end{array}\\right ]   &   \\left(\\begin{array}{cc } c & b \\\\ b^\\dagger & d \\end{array}\\right ) \\\\ \\end{array}\\right)\\longrightarrow \\left(\\begin{array}{cc } d_2 & t_1 \\\\ t_1^\\dagger & d_1 \\end{array}\\right)\\:,\\ ] ] where @xmath248 is @xmath13 , while @xmath250 is @xmath259 .",
    "3 .   @xmath251 is a @xmath260 matrix obtained by decimating the @xmath206 block of the following @xmath261 matrix @xmath262 where @xmath263 is the @xmath264-dimensional null matrix .",
    "finally we are now in the position of calculating the self - energies .",
    "these are obtained from the surface green s functions for the rotated and decimated leads ( specified by the matrices @xmath254 and @xmath245 ) and have the following form @xmath265 and @xmath266^{-1}\\theta_\\mathrm{rm}\\:.\\ ] ] clearly our procedure not only regularizes the algorithm for calculating the self - energies , giving it the necessary numerical stability , but also drastically reduces the degrees of freedom ( orbitals ) needed for solving the transport problem .",
    "these go from @xmath14 ( the dimension of the original @xmath26 matrix ) to @xmath188 ( the rank of @xmath26 ) .",
    "usually @xmath267 and considerable computational overheads are saved .",
    "finally it is important to note that usually the rank @xmath188 of @xmath196 $ ] is not necessarily the same of that of @xmath268 $ ] ( @xmath269 ) .",
    "if @xmath270 the gsvd transformation must be performed over the matrices @xmath271 and @xmath272 .",
    "the procedure is similar to what described before but the final structure of the matrix @xmath235 is somehow different , and so should be the decimation scheme .",
    "the electronic part of the system we consider is described in a general way by the following hamiltonian @xcite @xmath273 where @xmath26 accounts for the coulomb interaction among electrons and @xmath24 stands for all one - particle pieces of the hamiltonian , @xmath274 @xmath275 and @xmath276 are respectively the kinetic energy and the coulomb interaction between electrons and nuclei , and @xmath277 is an external electrostatic potentials applied to the system at @xmath278 .",
    "the electronic system evolves according to the time - independent hamiltonian @xmath279 for all negative times , and uses @xmath280 as the synchronization time for all pictures .",
    "moreover we assume that before @xmath277 is switched on the system of interacting electrons is in thermodynamic equilibrium at a chemical potential @xmath281 .",
    "we then prepare the density matrix @xmath84 at @xmath280 also .",
    "therefore , expectation values of observables @xmath282 are described in terms of the density matrix of an interacting electron system at equilibrium .",
    "these expectation values may be evaluated by using perturbation theory .",
    "wick s theorem may be applied only to ensembles of non - interacting electrons . in order to take advantage of it , we must use a non - interacting density matrix such as @xmath283    we then define the hamiltonian in the schrdinger picture in the keldish contour of fig .",
    "[ figb1 ] of the complex @xmath284 plane as follows @xmath285 and analogous expressions for its noninteracting and interacting pieces , @xmath286 and @xmath287 .",
    "we notice that the time variable is doubled valued along the real axis .",
    "we must therefore distinguish whether any real time lies on the upper ( @xmath288 ) or lower ( @xmath289 ) branch .",
    "in the complex @xmath284 plane . the imaginary time path is called @xmath290 or @xmath291 in the text .",
    "the segment lying below ( above ) the real - time axis is called @xmath292 ( @xmath293 ) .",
    "the time loop @xmath292+@xmath293 is called @xmath294.,width=283 ]    we then define heisenberg ( h ) and dirac ( d ) pictures in the keldish contour whereby evolution of operators is provided by @xmath295 where @xmath296 is the time ordering operator on @xmath297 .",
    "expectation values of operators are then given by the statistical averages @xmath298 which are evaluated in the non - interacting ensemble described by @xmath299 .",
    "the green function of the system , @xmath300 is a tool to compute the physical response of the system .",
    "thus the electron charge and current densities are simply @xmath301\\,g(1^+,2)|_{2=1 ^ -}\\nonumber\\end{aligned}\\ ] ] and depend on the applied the external potential . here , @xmath302 denote creation and annihilation operators , and @xmath303 .",
    "the green s function can be proven to satisfy the following dyson equation @xmath304\\,g(1,2)&=&\\delta(1,2)+(\\sigma \\otimes g)\\,(1,2 ) \\nonumber\\\\ \\left[\\,-i\\,\\partial_{t_2 } -h_0(2)\\,\\right]\\,g(1,2)&=&\\delta(1,2)+ ( g \\otimes \\sigma)\\,(1,2)\\end{aligned}\\ ] ] where all time variables run through the keldish contour @xmath297 and we follow the conventional shorthand @xmath305      we now define a fictitious system of non - interacting electrons described by the hamiltonian @xcite @xmath306 where we assume that @xmath307 is constant and that the system is in thermodynamic equilibrium at chemical potential @xmath308 , all for negative times . we also assume that @xmath307 may be exactly diagonalized . we do not split a perturbing piece from the hamiltonian and therefore , heisenberg and dirac pictures coincide .",
    "we again take @xmath280 as the synchronization and density - matrix preparation time .",
    "the density matrix @xmath309 and the time - evolution operator on the keldish contour @xmath310 completely determine the expectation value of observables of this fictitious system @xmath311    the green s function @xmath312 , whose time variables also lie on @xmath297 , satisfies the equation of motion @xmath313\\,g_s(1,2)&=&\\delta(1,2 ) \\nonumber\\\\ \\left[\\,-i\\,\\partial_{t_2 } -h_s(2)\\,\\right]\\,g_s(1,2)&=&\\delta(1,2)\\end{aligned}\\ ] ] and provides the physical response of the system @xmath314&= &   -i\\,e\\,g_s(1^+,1 ^ -)\\nonumber\\\\ \\vec{\\j}_s[v_s(1)]&= & -\\frac{e\\,\\hbar}{2\\,m}\\,\\left[\\vec{\\nabla}_1-\\vec{\\nabla}_2 + 2\\,i\\,\\vec{a}(1)\\right]\\,g_s(1^+,2)|_{2=1 ^ -}\\nonumber\\end{aligned}\\ ] ]    we define the action functionals @xmath315&= & i\\ , \\ln \\mathrm{tr } \\left [ \\hat{u}(-i\\,\\beta,0)\\right]\\nonumber\\\\ r_s[v_s(x)]&= & i\\ , \\ln \\mathrm{tr } \\left [ \\hat{u}_s(-i\\,\\beta,0)\\right]\\end{aligned}\\ ] ] whose functional derivative with respect to the external potential provides an alternative way to calculate the electronic density .",
    "we adjust the potential @xmath316 so that the densities of the two systems be equal , @xmath317}{\\delta v(x)}=\\frac{\\delta r[v_s(x)]}{\\delta v_s(x)}=\\langle n(x)\\rangle\\ ] ] notice that we do not require that the current densities of the two systems be equal .",
    "we now perform a legendre transform to find the new actions @xmath318&=&-r[v[n]]+\\int dx\\ , n(x)\\,v(x)\\nonumber\\\\ s_s[n]&=&-r_s[v_s[n]]+\\int dx\\ , n(x)\\,v_s(x)\\end{aligned}\\ ] ] such that @xmath319}{\\delta n(x)}&=&v(x)\\nonumber \\\\ \\frac{\\delta",
    "s_s[n(x)]}{\\delta n(x)}&=&v_s(x)\\end{aligned}\\ ] ]    we define an exchange - correlation functional @xmath320= s[n]+\\frac{1}{2}\\int\\,dx\\;[v_\\mathrm{h}(x)\\,n(x)+s_\\mathrm{xc}[n]]\\ ] ] whose functional derivative with respect to the density provides with a key relationship between the external potential of the actual and fictitious systems , @xmath321&=&\\frac{\\delta s_\\mathrm{xc}}{\\delta n(x)}\\end{aligned}\\ ] ]    comparing the equations of motion of @xmath78 and @xmath322 , we find an explicit relationship between the green s functions @xmath323 and the sham - schlter equation for the self - energy @xmath324\\otimes g\\ ] ]    iterating these equations once means equating both green s functions , @xmath325 , which in turn implies approximating @xmath326 by @xmath327 .",
    "the resulting integral equation for @xmath117 has @xmath328(1,2)=(\\,v_\\mathrm{h}[n(1)]+v_\\mathrm{xc}[n(1)]\\,)\\,\\delta(1,2)\\ ] ] as a trivial solution .",
    "this simple approximation has the virtue that charge is conserved .",
    "this can be seen in two alternative ways .",
    "first , the self - energy can be written as a @xmath329$]-derivable function .",
    "second , the fictitious system satisfies the continuity equation by construction .",
    "subsequent iterations improve the physical content of @xmath78 , but we have used in our code this lowest - order approximation .    the green s function at two different times @xmath330 can be viewed as the matrix element @xmath331 , sandwiched between two time states of the whole set @xmath332 of times in the keldish contour .",
    "we split the contour into the three pieces @xmath333 of fig . 2 , and",
    "define the corresponding three time subsets . the green s function",
    "can then be represented in matrix form as @xmath334    the physical response of the system is therefore encapsulated in the lesser green function , @xmath335&= &   -i\\,g_s^<(1^+,1 ^ -)\\nonumber\\\\ \\vec{\\j}[v_s(1)]&= & -\\frac{\\hbar}{2\\,m}\\,\\left[\\vec{\\nabla}_1-\\vec{\\nabla}_2 + 2\\,i\\,\\vec{a}(1)\\right]\\,g_s^<(1^+,2)|_{2=1 ^ -}\\nonumber\\end{aligned}\\ ] ]    there are only five independent @xmath336 out of the seven matrix elements displayed above .",
    "a partial reduction to six matrix elements in the green s function is achieved by the non - unitary transformation @xmath337    both matrices satisfy the matrix equations of motion @xmath313\\ , \\hat{g}_s(1,2)&=&\\delta(\\vec{r}_1-\\vec{r}_2)\\ , \\hat{\\delta}(\\tau_1-\\tau_2)\\nonumber\\\\ \\left[\\,i\\,\\partial_{t_1 } -h_s(1)\\,\\right]\\ , \\check{g}_s(1,2)&=&\\delta(\\vec{r}_1-\\vec{r}_2)\\ , \\check{\\delta}(\\tau_1-\\tau_2)\\nonumber\\end{aligned}\\ ] ] where the time delta functions are defined as @xmath338 with the menos ( plus ) sign corresponding to the hat ( check ) delta function .",
    "we shall drop the `` @xmath135 '' subindex from now on , since all the discussion that follows is valid only for the ficticious system of non - interacting electrons .",
    "physical response is customarily written in terms of @xmath339 and @xmath93 . since there is no linear transformation which allow to group them in one common matrix",
    ", one uses langreth s rules to find relationships among them .",
    "the eigenstates of the system can be obtained by expanding them in the basis of non - orthogonal states , @xmath340 , in terms of which the schrdinger equation reads @xmath341\\,c_{j\\:\\nu}(n , t_1)=0\\ ] ] alternatively the equation of motion for either check or hat green functions are @xmath342\\ , g_{k\\lambda\\:j\\nu}(t_1,t_2)=\\delta_{ij}\\,\\delta_{\\mu\\nu}\\,\\hat{\\delta}(t_1-t_2)\\nonumber\\ ] ]      the electron charge and current densities are found from @xmath346 where we have introduced the density matrix @xmath347 and @xmath348 the electric current through a given surface @xmath17 is obtained by integrating the current density over such surface @xmath349 where only those bonds @xmath350 pierced by the surface contribute to the summation .",
    "if the system is in thermodynamic equilibrium , the population of electrons does not depend on time , and follows the fermi - dirac distribution function @xmath351 .",
    "thereby the lesser green function can be written in terms of the retarded one as @xmath352=\\nonumber\\\\ & = & -2\\,i\\,f(e)\\,\\mathrm{im}\\,\\left[g^\\mathrm{r}_{i\\mu\\:j\\nu}(e)\\right]=\\nonumber\\\\ & = & 2\\,\\pi\\,i\\,f(e)\\,\\sum_n\\,c_{i\\mu}(n)\\,c_{j\\nu}^*(n)\\,\\delta(e-\\epsilon_n)\\nonumber\\end{aligned}\\ ] ] where @xmath353 are the eigenvalues of the hamiltonian .",
    "therefore , the density matrix can be obtained from the wave function coefficients by just diagonalising the hamiltonian , @xmath354=\\nonumber\\\\ & = & \\sum_n\\,c_{i\\mu}(n)\\,c_{j\\nu}^*(n)\\,f(\\epsilon_n)\\end{aligned}\\ ] ]      we now wish to partition the green functions according to the system setup of fig .",
    "1 , where the left and right leads remain in thermodynamic equilibrium defined by @xmath355 at all times .",
    "the extended molecule is also in thermodynamic equilibrium for times @xmath356 .",
    "the hamiltonian for negative times @xmath357 serves to define the reference equilibrium hat and check green functions , that satisfy the equations of motion @xmath358\\ , g_{k\\lambda , j\\nu}(t_1,t_2)=\\delta_{i , j}\\,\\delta_{\\mu,\\nu}\\,\\hat{\\delta}(t_1-t_2)\\nonumber\\ ] ] for instance , the equation of motion for the retarded green function in frequency domain is just        the extended molecule is contacted by the electrodes at time @xmath278 , through the hamiltonian matrix elements @xmath361 where @xmath362 is zero for negative times , and 1 for times larger than a certain characteristic time @xmath363 .",
    "the perturbation @xmath364 drives the core of the extended molecule out of equilibrium for positive times , by populating it with a distribution of electrons that does not follow fermi - dirac statistics .",
    "the distribution function of the non - contacted molecule @xmath365 is completely washed out , but the density - matrix of the system can still be determined from the equations of motion of the lesser and retarded green functions .",
    "we seek to solve the equations of motion for times @xmath366 where all transient effects have vanished .",
    "this means , first , that @xmath367 , so that the matrix hat and check green functions are block - diagonal ; second , that the hamiltonian is simply @xmath23 ; and third , that green functions do not depend on the time variable t.        the lesser green function is better expressed in terms of the retarded and advanced , and the reference equilibrium lesser green function , by using langreth s rules , as @xmath369 straightforward matrix algebra then leads to eqs .",
    "( [ density ] ) and ( [ current ] ) .",
    "kuekes , j.r .",
    "heath , and r.s .",
    "williams , us patent , number 6128214 ( hewlett - packard ) , october 2000 .",
    "collier , e.w .",
    "wong , m.  belohradsky , f.m .",
    "raymo , j.f .",
    "stoddart , p.j .",
    "kuekes , r.s .",
    "williams and j.r .",
    "heath , science * 285 * , 391 ( 1999 ) .",
    "y.  huang , x.  duan , y.  cui , l.j .",
    "lauhon , k .- h .",
    "kim , c.m .",
    "lieber , science * 294 * , 1313 ( 2001 ) . n. garca , m. muoz , and y .- w .",
    "zhao , phys .",
    "lett . * 82 * , 2923 ( 1999 ) .",
    "versluijs , m.a .",
    "bari , and j.m.d .",
    "coey , phys .",
    "lett . * 87 * , 026601 ( 2001 ) .",
    "qi , o.  vermesh , m.  grecu , a.  javey , q.  wang , h.  dai , s.  peng and k.  cho , nano lett . * 3 * , 347 ( 2003 ) .",
    "novak , e.s .",
    "show , e.j .",
    "houser , d.  park , j.l .",
    "stepnowski , and r.a .",
    "mcgill , appl .",
    "* 83 * , 4026 ( 2003 ) .",
    "f.  patolsky , et al .",
    "usa * 101 * , 14017 ( 2004 ) .",
    "y.  cui , w.  qingqiao , p.  hongkun , and c.m .",
    "lieber , science * 293 * , 1289 ( 2001 ) .",
    "heath , m.e .",
    "phelps and l.  hood , mol .",
    "biol . * 5 * , 312 ( 2003 ) .",
    "s.  datta , _ electronic transport in mesoscopic systems _ , cambridge university press , cambridge , uk , 1995 .",
    "rocha and v.m .",
    "garca - surez and s.w .",
    "bailey and c.j .",
    "lambert and j. ferrer and s. sanvito , _ smeagol _ : spin and molecular electronics in atomically generated orbital landscapes .",
    "some caution should be taken in selecting the plane for evaluating the conductance when the basis set is not complete as in the case of lao basis sets .",
    "see for instance t. todorov , j.  phys . :",
    "matter * 13 * , 10125 ( 2001 ) ; t. todorov , j.  phys . : condens .",
    "matter * 14 * , 3049 ( 2002 ) .",
    "j.  m.  soler , e.  artacho , j.  d.  gale , a.  garca , j.  junquera , p.  ordejn and d.  sanchez - portal , j. phys .",
    "matter * 14 * , 2745 - 2779 ( 2002 ) .",
    "l.  kleinman , d.m .",
    "bylander , phys .",
    "48 * , 1425 ( 1982 )              h.  ohnishi , y.  kondo , k.  takayanagi , nature ( london ) * 395 * , 780 ( 1998 ) .",
    "coura , s.b .",
    "legoas , a.s .",
    "moreira , f.  sato , v.  rodrigues , s.o .",
    "dantas , d.  ugarte , and d.s .",
    "galvo , nano lett . * 4 * , 1187 ( 2004 ) .",
    "u.  landman , w.d .",
    "luedtke , b.e .",
    "salisbury , and r.l .",
    "whetten , phys .",
    "lett . * 77 * , 1362 ( 1996 ) .",
    "e.  anderson , z.  bai , c.  bischof , s.  blackford , j.  demmel , j.  dongarra , j.  du croz , a.  greenbaum , s.  hammarling , a.  mckenney , and d.  sorensen , _ lapack users guide _ , society for industrial and applied mathematics , philadelphia , pa ( 1999 ) ."
  ],
  "abstract_text": [
    "<S> _ ab initio _ computational methods for electronic transport in nanoscaled systems are an invaluable tool for the design of quantum devices . </S>",
    "<S> we have developed a flexible and efficient algorithm for evaluating @xmath0-@xmath1 characteristics of atomic junctions , which integrates the non - equilibrium green s function method with density functional theory . </S>",
    "<S> this is currently implemented in the package _ </S>",
    "<S> smeagol_. the heart of _ smeagol _ is our novel scheme for constructing the surface green s functions describing the current / voltage probes . </S>",
    "<S> it consists of a direct summation of both open and closed scattering channels together with a regularization procedure of the hamiltonian , and provides great improvements over standard recursive methods . </S>",
    "<S> in particular it allows us to tackle material systems with complicated electronic structures , such as magnetic transition metals . here </S>",
    "<S> we present a detailed description of _ smeagol _ together with an extensive range of applications relevant for the two burgeoning fields of spin and molecular - electronics . </S>"
  ]
}