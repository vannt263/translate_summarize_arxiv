{
  "article_text": [
    "in @xcite , it was proved that every word @xmath0 has at most @xmath1 many distinct palindromic factors , including the empty word .",
    "the authors of @xcite recently initiated a unified study of words which achieve this limit .",
    "they called these words _ rich _ ( in palindromes ) .",
    "the same concept was introduced already in @xcite with the term _ full _ words .",
    "full , meaning that a bound is reached .",
    "this class of words have been studied in several other papers from various point of views , for example in @xcite , @xcite , @xcite , @xcite and @xcite .    in section 2",
    "we will prove several results about extending rich words .",
    "a rich word @xmath0 can be _ extended richly _ with a word @xmath2 if @xmath3 is rich . in @xcite",
    "it was proved that every rich word can be extended at least with one letter .",
    "we will prove that every rich word @xmath0 can be eventually extended richly at least in two ways , after it had been extended at most with a word of length @xmath5 .",
    "this fact will be used in several places later .",
    "we will also show that every rich word can be extended to be both an infinite aperiodic and infinite periodic rich word .",
    "also , all sturmian words can be extended richly in two ways .    in section 3 we will define a new concept , the _ infinite defect _ of a finite word .",
    "the normal _ defect _ of a word @xmath0 tells how many palindromes does it lack .",
    "the infinite defect tells how many palindromes does the infinite extension of @xmath0 has to lack in minimum .",
    "we will notice that this number is always finite",
    ". we will also give some upper bounds and study how the defect and the infinite defect can differ from each other .",
    "in section 4 we will give upper and lower bounds for the number of rich words of length @xmath4 .",
    "clearly all words are not rich , so it is natural to study how many of them exist .",
    "this has not yet been done .",
    "the upper bound has no theory behind it , but it seems to be quite near to the actual number of rich words . for the lower bound we will use the fact that every rich word could be extended at least in two different ways after a limited extension .    in section 5",
    "we will shortly study two - dimensional rich words and their extensions .    in section 6 we will give some open problems from the previous sections .",
    "an _ alphabet _ @xmath6 is a non - empty finite set of symbols , called _",
    "letters_. a _ word _ is a finite sequence of letters from @xmath6 .",
    "the _ empty _",
    "word @xmath7 is the empty sequence . the set @xmath8 of all finite words over @xmath6 is a _",
    "free monoid _ under the operation of concatenation .",
    "the _ free semigroup _",
    "@xmath9 is the set of non - empty words over @xmath6 .",
    "right infinite word _",
    "_ left _ ) is a sequence indexed by @xmath10 ( resp .",
    "@xmath11 ) with values in @xmath6 . a _",
    "two - way infinite word _ is a sequence indexed by @xmath12 .",
    "we denote the set of all infinite words over @xmath6 by @xmath13 and define @xmath14 .",
    "an infinite word is _ ultimately periodic _ if it can be written as @xmath15 for some @xmath16 @xmath17 . if @xmath18 then we say the infinite word is _",
    "periodic_. an infinite word that is not ultimately periodic is _",
    "aperiodic_. the _ length _ of a word @xmath19 , with each @xmath20 , is denoted by @xmath21 .",
    "the empty word @xmath7 is the unique word of length @xmath22 . by @xmath23",
    "we denote the number of occurences of a letter @xmath24 in @xmath0 .",
    "the _ reversal _ of @xmath0 is denoted by @xmath25 .",
    "word @xmath0 is called a _ palindrome _ if @xmath26 .",
    "the empty word @xmath7 is assumed to be a palindrome .",
    "a word @xmath27 is a _ factor _ of a word @xmath28 if @xmath29 , for some @xmath30 . if @xmath31 ( @xmath32 ) then we say that @xmath27 is a _ prefix _ ( resp . _",
    "suffix _ ) of @xmath0 . a factor @xmath27 of a word @xmath0",
    "is said to be _ unioccurent _ in @xmath0 if @xmath27 has exactly one occurence in @xmath0 .",
    "two occurences of factor @xmath27 are said to be _ consecutive _ if there is no occurence of @xmath27 between them .",
    "a factor of @xmath0 having exactly two occurences of a non - empty factor @xmath2 , the other as a prefix and the other as a suffix , is called a _ complete return _ to @xmath2 in @xmath0 .    if @xmath33 , by notation @xmath34 or @xmath35 we mean the removal of a prefix or a suffix of @xmath0",
    "right palindromic closure _",
    "_ left _ ) of a word @xmath0 is the unique shortest palindrome @xmath36 ( resp .",
    "@xmath37 ) having @xmath0 as a prefix ( resp .",
    "if @xmath2 is the ( unique ) longest palindromic suffix of @xmath38 then @xmath39 .    let @xmath0 be a finite or infinite word .",
    "the set @xmath40 means the set of all factors of @xmath0 , the set @xmath41 means the set of all letters that occur in @xmath0 and the set @xmath42 means the set of all palindromic factors of @xmath0 .",
    "we say that a word @xmath0 is _ unary _ if @xmath43 , _ binary _ if @xmath44 , _ ternary _ if @xmath45 and _ @xmath4-ary _ if @xmath46    other basic definitions and notation in combinatorics on words can be found from lothaires books @xcite and @xcite .      in this subsection we give the basic definitions and state some already known properties and characterizations of rich words .",
    "[ p0](@xcite , prop .",
    "2 ) a word @xmath0 has at most @xmath1 distinct palindromic factors .    a word @xmath0 is _ rich _ if it has exactly @xmath1 distinct palindromic factors .",
    "an infinite word is _ rich _ if all of its factors are rich .",
    "[ p1](@xcite , cor .",
    "2.5 ) a word @xmath0 is rich if and only if all of its factors are rich .",
    "[ p2](@xcite , cor .",
    "2.5 ) if @xmath0 is rich , then it has exactly one unioccurent longest palindromic suffix ( referred later as @xmath47 or @xmath48 ) .    from cor .",
    "2.5 in @xcite we also get that if @xmath0 is rich then @xmath49 is rich . from this",
    "we see that the above proposition holds for prefixes also and we refer to the unioccurent longest palindromic prefix of @xmath0 as @xmath50 or @xmath51 .",
    "the next proposition characterizes rich words according to complete return words .",
    "[ p3](@xcite , thm .",
    "2.14 ) a finite or infinite word @xmath0 is rich if and only if all complete returns to any palindromic factor in @xmath0 are themselves palindromes .",
    "we can also take the palindromic closure of a rich word and get a rich word .",
    "[ p4](@xcite , prop .",
    "2.6 ) palindromic closure preserves richness .",
    "let @xmath0 be a word and @xmath52 its longest proper palindromic suffix .",
    "the _ proper palindromic closure _ of @xmath38 is defined as @xmath53 . from the proof of proposition 2.8 in @xcite",
    "we get that also the proper palindromic closure preserves richness .",
    "it uses the fact that the longest proper palindromic suffix ( referred later as @xmath54 or @xmath55 ) can occur only in the beginning and in the end of the word .",
    "hence we create a new palindrome in every step when we are taking the proper palindromic closure and the word stays rich .",
    "[ p5](@xcite , proof of prop . 2.8 ) the proper palindromic closure preserves richness .",
    "let @xmath0 be a rich word .",
    "we say that @xmath0 can be _ extended richly _ with a word @xmath2 if @xmath3 is rich .",
    "the word @xmath3 is called a _ rich extension _ of @xmath0 with the word @xmath2 .",
    "we also say that @xmath0 can be extended richly in @xmath4 ways if there exists @xmath4 distinct letters @xmath56 such that @xmath57 is rich .",
    "the word @xmath0 can be _ eventually extended richly _ in @xmath4 ways if there exists a finite word @xmath2 such that the word @xmath3 is rich and can be extended richly in @xmath4 ways .    in @xcite , it was proved that every rich word can be extended richly at least in one way :    [ p6](@xcite , prop .",
    "2.8 ) suppose @xmath0 is a rich word .",
    "then there exist letters @xmath58 such that @xmath59 and @xmath60 are rich .    the next theorem states that every ( non - unary ) rich word can be eventually extended richly at least in two ways .    [ tt1 ]",
    "let @xmath0 be a non - unary rich word .",
    "there exists a word @xmath2 such that @xmath3 is rich , @xmath61 and @xmath3 can be extended richly at least in two ways .    the idea of the proof is to take the biggest power @xmath62 of some letter @xmath24 in @xmath0 and then extend the word richly such that this biggest power is the suffix of @xmath3 ( we stop extending when we see it as a suffix for the first time ) .",
    "now we can extend the word richly with the letter @xmath24 and with a letter @xmath63 that is before the lpps@xmath64 , where @xmath63 is a different letter than @xmath24 because @xmath62 was the biggest power of @xmath24 .",
    "the extension with @xmath24 gives a new palindrome @xmath65 and the extension with @xmath63 gives a new palindrome @xmath63lpps@xmath63 .",
    "now we only have to show that we actually can extend @xmath0 richly such that @xmath62 is a suffix .",
    "suppose @xmath66 , where @xmath67 is the longest proper palindromic suffix . now @xmath68 .",
    "if @xmath62 is a factor of @xmath69 then we can cut the word @xmath70 such that the @xmath62 inside @xmath71 is a suffix .",
    "if @xmath62 is a prefix , and hence a suffix , of @xmath67 then we are already done .",
    "so we still need to consider the case where @xmath62 is as a factor only inside @xmath67 .",
    "for this case we take the proper palindromic closure of @xmath70 .",
    "the word @xmath72 can not be longer than @xmath73 because otherwise @xmath67 would not be lpps@xmath74 .",
    "now there are two subcases : 1 ) @xmath75 , where @xmath76 is a prefix of @xmath77 , and 2 ) @xmath78 .",
    "suppose the case 1 .",
    "now the word @xmath79 is rich and if @xmath62 is a factor of @xmath76 then we can cut the word @xmath79 inside @xmath80 such that @xmath62 is a suffix .",
    "if @xmath62 is not a factor of @xmath76 then it has to be a factor of @xmath81 , which is a contradiction .",
    "this comes from the fact that @xmath82 would be an overlap of two palindromes @xmath67 and @xmath27 , where @xmath81 is the common part which contains @xmath62 but the other parts @xmath76 and @xmath71 would not contain @xmath62 .",
    "suppose the case 2 .",
    "now the word @xmath83 is rich and because @xmath67 contains @xmath62 as a factor we can cut the word @xmath83 inside the latter @xmath67 such that @xmath62 is a suffix .",
    "the rich extension @xmath3 was clearly constructed in every case such that @xmath61 .",
    "let us use the idea from the previous theorem into the following rich word @xmath84 .",
    "the word can be extended richly only with letter @xmath22 and the biggest powers of both letters @xmath22 and @xmath85 are inside the lpps @xmath86 .",
    "we take the proper palindromic closure @xmath87 , where the new lpps is @xmath88 .",
    "now we get @xmath89 to a suffix : @xmath90 and we can extend the word richly with both @xmath22 and @xmath85 .",
    "the original word in the previous example had length @xmath91 and the new word up to the point where we can extend it with two ways had length @xmath92 .",
    "we can increase the ratio @xmath93 ultimately close to @xmath94 by making the block @xmath95 longer .",
    "so the bound from the previous theorem can be reached if we use the idea of the proof on how to extend the word richly .",
    "although , already the word @xmath96 can be extended richly in two ways !",
    "this implies that there is much to improve .",
    "[ rr1 ] we can construct words such that the number of consecutive compulsory rich extensions grows arbitrarily large .",
    "for example for the word @xmath97 there are four compulsory extensions with letter @xmath85 before we can extend it with both @xmath22 and @xmath85 . from the above word",
    "we can easily see how to generalize this for an arbitrary @xmath4 .",
    "notice that the length of the word is @xmath98 for @xmath4 compulsory rich extensions , so the word grows rapidly .",
    "there can also be consecutive compulsory rich extensions which are not the for the same letter .",
    "for example the word @xmath99 has to be extended first with letter @xmath22 and then with letter @xmath85 .",
    "the next proposition will be used in proposition [ pp1 ] and proposition [ pp2 ] .",
    "it gives us a necessary condition if two rich words can appear in a same rich word .",
    "[ pj ] two rich words @xmath2 and @xmath67 can not be factors of a same rich word if there are @xmath100 and @xmath101 such that @xmath102 and @xmath103 .    from theorem 6 in @xcite",
    "we get immediately that if some word would contain such words @xmath2 and @xmath67 as factors , and hence @xmath104 and @xmath76 , then it would not be rich .",
    "the next proposition states that every rich word can not be eventually extended richly in @xmath94 ways .",
    "this means theorem [ tt1 ] is not true for extensions in three or more ways .",
    "[ pp1 ] every ternary rich word can not be eventually extended richly in @xmath94 ways .",
    "the word @xmath105 is rich .",
    "let us prove that it can not be eventually extended richly in 3 ways .",
    "first we give some forbidden factors that can never appear on any rich extension of @xmath0 .",
    "we use proposition [ pj ] for this .",
    "the factors @xmath106 , @xmath107 , @xmath108 and @xmath109 are forbidden immediately due to proposition [ pj ] because @xmath0 has factors @xmath110 , @xmath111 , @xmath112 and @xmath113 , respectively .",
    "suppose some rich extension of @xmath0 would have factor @xmath114 .",
    "then we could take the first occurence of @xmath114 and get that the rich extension has factor @xmath115 .",
    "this is because the complete return to @xmath114 has to be a palindrome .",
    "now we would have factors @xmath116 and @xmath117 , which means that the factors @xmath118 and @xmath119 are also forbidden    now suppose the contrary : there exists a rich extension @xmath3 such that @xmath120 , @xmath121 and @xmath122 are rich .",
    "the last letter of @xmath3 has to be @xmath22 because otherwise we would have factors @xmath106 or @xmath107 .",
    "now we have three cases depending on which is the second last letter of @xmath3 .",
    "\\1 ) suppose @xmath123 .",
    "this would give a forbidden factor @xmath108 in @xmath124 .",
    "\\2 ) suppose @xmath125 .",
    "this would give a forbidden factor @xmath119 in @xmath126 .",
    "\\3 ) suppose @xmath127 .",
    "if the third last letter is @xmath22 then we would get a factor @xmath109 in @xmath122 .",
    "if the third last letter is @xmath85 then we would get a factor @xmath106 already in @xmath3 .",
    "if the third last letter is @xmath128 then we would get a factor @xmath118 in @xmath120 .",
    "these are all forbidden factors .    in each case",
    "we get a contradiction and the proof is complete .",
    "the next proposition states the previous for every @xmath129 .",
    "[ pp2 ] for every @xmath129 there exists an @xmath4-ary rich word which can not be eventually extended richly in @xmath4 ways .",
    "the case @xmath130 follows from the previous proposition . for @xmath131",
    "we take the word @xmath132 .",
    "similar to the previous proof , factors @xmath133 and @xmath134 can never appear on any rich extension of @xmath0 .",
    "suppose to the contrary that @xmath3 is such that we can extend it richly in @xmath4 ways , i.e. with all the letters @xmath135 .",
    "now , for every last letter of @xmath3 we would always get one of the forbidden factors listed above",
    ".    for every @xmath136 there also exists @xmath4-ary rich word which can be extended richly in @xmath4 ways .",
    "the word @xmath137 is an example for @xmath138 .",
    "when you see how the above word is constructed you see that it can be generalized for every @xmath136 .    from the proof of the previous proposition",
    "we also see that if a word have factors like @xmath139 , where @xmath140 , then we can never extend the word richly with all the letters @xmath141 and @xmath94 .",
    "using theorem [ tt1 ] and its idea we can extend every rich word to be an infinite aperiodic rich word .",
    "[ pp3 ] if @xmath0 is a non - unary rich word then it can be extended to be an infinite aperiodic rich word .",
    "we can construct such word for every @xmath0 by repeating the procedure of theorem [ tt1 ] infinitely many times .",
    "we first choose the biggest power @xmath62 of some letter @xmath24 in @xmath0 .",
    "then we extend the word such that this biggest power is a suffix .",
    "then we extend the word with the letter @xmath24 and we get a new palindrome @xmath65",
    ". then we extend the word with the letter that is before the factor @xmath65 .",
    "when we repeat this procedure we get longer and longer powers of some letter .",
    "this kind of word is clearly aperiodic and rich .",
    "using proposition [ p4 ] we can also extend every rich word to be an infinite periodic rich word .",
    "[ pp4 ] if @xmath0 is rich then it can be extended to be an infinite periodic rich word .    from proposition [ p5 ]",
    "we get that @xmath142 is a rich palindrome , where @xmath67 is the lpps of @xmath70 .",
    "we prove by induction that @xmath143 , where @xmath144 means taking the proper palindromic closure @xmath4 times in a row .",
    "it holds for @xmath145 .",
    "suppose it holds for @xmath146 .",
    "now we have to prove that @xmath147 .",
    "when we use the assumption that the claim was true for @xmath146 , we get @xmath148 . because @xmath149 is a palindrome",
    ", we get that @xmath150 .",
    "otherwise @xmath151 would occur somewhere else than in the end or in the beginning of the word @xmath152 and hence @xmath67 would not be the lpps of @xmath70 .",
    "this all means that @xmath153 .    repeating the procedure infinitely many times we get an infinite periodic word @xmath154 which is rich and has @xmath0 as a prefix .",
    "finite rich words could always be extended richly with some letter by proposition [ p6 ] .",
    "the next proposition tells that the same holds for infinite rich words also .    if @xmath0 is a right infinite rich word then there always exists a letter @xmath155 such that @xmath156 is rich .",
    "we suppose to the contrary that @xmath156 is not rich for every @xmath155 . from the definition of a rich infinite word",
    "we get that for every @xmath155 there exists a word @xmath157 such that @xmath157 is non - rich prefix of @xmath156 .",
    "suppose that @xmath158 is longest such word .",
    "now we would get that @xmath159 is a rich word and can not be extended richly to the left with any letter .",
    "this is a contradiction because of proposition [ p6 ] .",
    "the next proposition tells that taking the palindromic closure of the reverse of a rich word , i.e. the left palindromic closure , preserves the number of rich extensions that the original word had .",
    "if @xmath0 is rich and can be extended richly in @xmath4 ways , then so can @xmath160 .",
    "let @xmath0 be a rich word and @xmath161 , where @xmath67 is the lpp of @xmath0 and @xmath2 is possibly an empty word .",
    "the word @xmath2 can be empty only if @xmath0 is a palindrome .",
    "the claim is clearly true for palindromes so we can suppose @xmath162 .",
    "we suppose that @xmath57 is rich and @xmath163 is non - rich , for letters @xmath164 .",
    "now we only need to prove that 1 ) @xmath165 is rich and 2 ) @xmath166 is non - rich .",
    "\\1 ) suppose that @xmath167 is the lps of @xmath57 , which means it is unioccurent in @xmath57 .",
    "we will prove that @xmath167 is also unioccurent lps of @xmath168 .",
    "clearly @xmath167 can not occur inside @xmath0 nor @xmath49 , otherwise it would not be unioccurent in @xmath57 .",
    "so if @xmath167 would not be unioccurent in @xmath165 then it would have to contain @xmath67 .",
    "suppose that @xmath169 , where @xmath170 .",
    "if @xmath171 , then another occurence of @xmath167 in @xmath172 would imply another occurence of @xmath67 in @xmath0 ( @xmath162 ) .",
    "if @xmath173 , then the occurence of @xmath167 in the end of @xmath57 would again directly imply another occurence of @xmath67 in @xmath0 ( @xmath170 ) .",
    "suppose that @xmath174 , i.e. @xmath175 .",
    "this would directly mean that @xmath176 would have two occurences of @xmath167 .",
    "so in every case we get a contradiction .",
    "\\2 ) if the lps of @xmath166 is shorter than @xmath163 then it is not unioccurent , because @xmath163 was non - rich .",
    "this means @xmath166 is not rich .",
    "the lps of @xmath166 clearly can not be @xmath163 , otherwise @xmath163 would be a palindrome and hence rich .",
    "if the lps of @xmath166 is strictly longer than @xmath177 then @xmath67 would occur at least twice in @xmath0 , which is impossible .    at the end of this section",
    "we prove that every factor of any sturmian word can always be extended richly in two ways .",
    "let us first define sturmian words . in the following",
    "we suppose that all words are binary .",
    "a word @xmath0 is _ balanced _ if for every two factors @xmath178 of the same length and for every letter @xmath56 the number @xmath179 is at most @xmath85 .",
    "if a word is not balanced then it is _",
    "unbalanced_. an infinite word is _ sturmian _ if it is balanced and aperiodic .",
    "a finite word is _ sturmian _ if it is a factor of an infinite sturmian word .",
    "first we need to know that all sturmian words actually are rich in the first place .",
    "the next proposition is from @xcite ( proposition 2 ) .",
    "it was proved for trapezoidal words , but sturmian words are a subset of those .",
    "[ pp5 ] if @xmath0 is sturmian then it is rich .",
    "the next two propositions are from @xcite ( proposition 2.1.17 and proposition 2.1.3 , respectively ) .",
    "the first one tells that finite sturmian words and finite balanced words are the same and the second one gives us a property for unbalanced words .",
    "[ pp6 ] a finite word is sturmian if and only if it is balanced .",
    "[ pp7 ] a word @xmath2 is unbalanced if and only if there exists a palindrome @xmath67 such that @xmath180 and @xmath181 are factors of @xmath2 .",
    "the next proposition states that every finite sturmian word , and hence every finite balanced word , can be extended richly in two ways .    [ pp8 ] every finite sturmian word can always be extended richly in two ways .",
    "suppose @xmath2 is a finite sturmian word and @xmath182 . from proposition [ pp5 ] and proposition [ pp6 ]",
    "we get that @xmath2 is rich and balanced .",
    "we only have to prove that both @xmath183 and @xmath184 are rich .",
    "suppose to the contrary that @xmath183 is not rich ( the case @xmath184 is identical ) .",
    "now @xmath183 is unbalanced because otherwise it would be sturmian and hence rich .",
    "proposition [ pp7 ] tells us that there is a palindrome @xmath67 such that @xmath180 and @xmath181 are factors of @xmath183 .",
    "because @xmath2 was balanced , the factor @xmath181 has to be a suffix of @xmath183 and it can not occur anywhere else in the word .",
    "this means that @xmath181 is a new palindrome and @xmath183 is rich , a contradiction .",
    "rich words were defined such that there were maximum number of palindromes in the word .",
    "we can define other words with respect to how many palindromes they lack , i.e. the defect of the word .",
    "this concept have been studied in various papers from different angles , for example in @xcite , @xcite , @xcite , @xcite and @xcite . in this section",
    "we define a new concept , the infinite defect .",
    "the _ defect _ of a finite word @xmath0 is defined by @xmath185 .",
    "the _ defect _ of an ( right , left or two - way ) infinite word @xmath0 is defined by @xmath186 .",
    "if the previous supremum does not exists then the defect is defined to be @xmath187 . clearly , finite and infinite rich words are exactly those words with defect equal to @xmath22 .",
    "we can also study how few defects a finite word must have if it has to be extended to be an infinite word .",
    "we define the _ infinite defect _ of a finite word @xmath0 with @xmath188 , where we of course suppose @xmath189 .",
    "the next theorem guarantees that the @xmath190-function above gives always a finite number .",
    "[ tttt1 ] the infinite defect @xmath191 of a finite word @xmath0 is finite .",
    "let us first denote @xmath192 .",
    "we will prove that @xmath154 has finite defect .",
    "more precisely , we will prove @xmath193 .",
    "we do it with induction .",
    "so the claim is that @xmath194 holds for all @xmath195 .",
    "if @xmath196 then the claim is trivial . suppose it holds for @xmath146 .",
    "if @xmath67 is any non - empty prefix of @xmath2 , then clearly @xmath197 is a palindromic suffix of @xmath198 .",
    "the word @xmath197 is longer than half of the word @xmath198 , so if @xmath197 is not unioccurent in @xmath198 then it must overlap with itself .",
    "we can take the longest such overlap and get that it is unioccurent lps of @xmath198 .",
    "we got that for every non - empty prefix @xmath67 of @xmath2 the word @xmath198 has an unioccurent lps .",
    "the word @xmath199 has therefore the same defect as @xmath200 because we get a new palindrome in every step when we extend @xmath200 into @xmath199 .",
    "this completes the induction .",
    "we now get our claim because clearly @xmath201 , where @xmath202 is finite .    the definition of the infinite defect to be useful we have to find a word @xmath0 for which @xmath203 .",
    "the word @xmath204 is such .",
    "clearly @xmath205 but for every @xmath206 and @xmath207 the defect is equal to @xmath94 .",
    "this means that no matter how we extend the word we always create new defects .",
    "the defect and the infinite defect of rich words are equal to 0 .",
    "the defect and the infinite defect of a finite word can be same for non - rich words also .",
    "for example @xmath208 .",
    "we could also define right and left infinite defects of @xmath0 separately such that the right ( left ) infinite defect would mean the lowest defect of a right ( resp . left ) infinite word that contains @xmath0 .",
    "this would also be reasonable since there are words for which they would be different .",
    "for example the word @xmath209 has defect equal to @xmath85 .",
    "we can extend @xmath0 to the right with infinite word @xmath210 and get a word which has also defect equal to @xmath85 .",
    "but already the words @xmath211 and @xmath207 have defects equal to @xmath128 .",
    "so to get an infinite word that has the lowest defect we sometimes have to extend it to the left and sometimes to the right .",
    "sometimes it does not matter .    we could also study how a right or left infinite word can be extended into a two - way infinite word .",
    "the _ infinite defect _ of a right or left infinite word @xmath0 could be defined by @xmath212 .",
    "if a word is rich then we know that the infinite defect is always zero . but how to determine the infinite defect for other words ?",
    "we know that it is always finite",
    ". the problem might be algorithmically undecidable , but we can at least find some upper bounds . clearly the normal defect is always a lower bound , which sometimes is achieved .",
    "[ pppp1 ] for a finite word @xmath0 we have inequalities @xmath213 and @xmath214 .",
    "this comes directly from the proof of theorem [ tttt1 ] .",
    "this method is sometimes optimal .",
    "for example the word @xmath215 has defect equal to @xmath85 and so does the word @xmath216 .",
    "the method is still not always optimal .",
    "for example the word @xmath217 has defect equal to @xmath218 .",
    "we get that already the words @xmath219 and @xmath220 have defects equal to @xmath221 .",
    "but we can do better : @xmath222 , which means that @xmath223 .",
    "note that the words @xmath224 and @xmath225 can actually have different defects .",
    "such word is for example @xmath226 .",
    "[ pppp2 ] if @xmath0 is a finite word then @xmath227 , where @xmath4 is the length of the longest rich suffix or the longest rich prefix of @xmath0 .",
    "we can take the longest rich suffix ( prefix ) @xmath2 of @xmath38 and extend it to be a right ( resp .",
    "left ) infinite rich word .",
    "when we add the left - over @xmath67 to the beginning ( resp . to the end ) we clearly get at most @xmath228 defects .",
    "the method described in the previous proposition is sometimes optimal .",
    "for example , the word @xmath229 has defect @xmath94 and so does the word @xmath230 , where we have extended the longest rich suffix @xmath231 .",
    "we see that @xmath232 .",
    "sometimes it is not optimal .",
    "the word @xmath233 has defect @xmath234 . the longest rich suffix and prefix are @xmath235 and @xmath236 , respectively .",
    "if we want to extend those to be right and left infinite rich words , respectively , we have to extend them both first with @xmath22 .",
    "that creates a new defect . after that , both extensions @xmath22 and @xmath85 create new defects also .",
    "so we have that @xmath237 , @xmath238 , @xmath239 , @xmath240 .",
    "but we can see that @xmath241 .",
    "consider the word @xmath242 : the first letter @xmath85 creates a new defect ( which we can not avoid ) but after that we always get a new palindrome @xmath243 , where @xmath244 .",
    "[ pppp3 ] if @xmath0 is a finite word then @xmath245 , where @xmath4 is the length of the biggest power of any letter in @xmath0 .",
    "if @xmath0 ends or begins with @xmath246 then we can choose @xmath247 , where @xmath248 is the biggest power of letter @xmath24 in @xmath0 .",
    "suppose @xmath62 is the biggest power of letter @xmath24 in @xmath0 .",
    "if we now extend the word @xmath0 with @xmath249 then we create a new palindrome @xmath250 , where @xmath251 , in every step after we have extended @xmath0 with at least @xmath62 .",
    "so we create at most @xmath4 new defects .",
    "clearly , if @xmath0 ends or begins with @xmath246 then we create at most @xmath252 new defects .",
    "this method is also sometimes optimal .",
    "for example if we look the previous remark where the defect was @xmath234 .",
    "now the biggest power of letter @xmath85 is @xmath253 and the word @xmath0 ends with @xmath254 .",
    "so we get that @xmath255 .    for the word @xmath256 , which has defect @xmath218 , this method is not optimal .",
    "the biggest powers of letters in @xmath0 are @xmath257 and @xmath258 . if we now extend the word with @xmath259 or @xmath210 to the left or right we get at least one defect more in each case .",
    "but we can see that @xmath260 , which means @xmath223 .",
    "note that the propositions that give us those upper bounds give also a method to construct the infinite word which contains the original word @xmath0 .",
    "the actual constructions in proposition [ pppp2 ] and proposition [ pppp3 ] may sometimes give a smaller defect than what the bound is always guaranteeing .",
    "note also that , as the next proposition says , we can extend a finite word to be both periodic and aperiodic infinite word such that the defect of that infinite word is still finite .",
    "if @xmath0 is a finite word then we can extend it to be both periodic and aperiodic infinite word @xmath67 such that @xmath261 is finite .",
    "the periodic infinite word @xmath67 can be constructed using theorem [ tttt1 ] : @xmath262 .",
    "the aperiodic infinite word @xmath67 can be constructed using proposition [ pppp2 ] and proposition [ pp3 ] : we take the longest rich suffix and extend it to be aperiodic rich word .",
    "next , let us look how the defect and the infinite defect can differ from each other .",
    "first we define some functions for an integer @xmath4 : @xmath263 we clearly see that @xmath264 and @xmath265 are non - bounded growing functions . for the function @xmath266 we can prove the following inequality .",
    "@xmath267 .",
    "let us choose @xmath0 to be a word for which @xmath268 .",
    "now clearly @xmath269 . from these",
    "we get that @xmath270 .    the previous proposition still does not guarantee that @xmath266 would be non - bounded because we do not know how much faster @xmath265 grows than @xmath264 , if any . but with a quite artificial construction we can prove it .    the function @xmath266 is a non - bounded growing function .",
    "it is trivially growing , so we only need to prove the non - boundedness .",
    "suppose to the contrary that there exists @xmath271 such that @xmath272 .",
    "we will consider the word @xmath273 , where @xmath0 is a word which does not have @xmath274 as a factor but still has every palindrome of length at most @xmath275 as a factor that is possible under this restriction .",
    "now we need to prove that no matter how we extend @xmath0 to be an infinite word , the defect will always grow with at least @xmath276 .",
    "we can not get a lower defect by extending the word to the both ends , so we suppose we extend it only to the right . every time we put a letter to the end of @xmath2 we can not get a new palindromic factor that would contain @xmath274 .",
    "this comes from the fact that @xmath0 does not contain @xmath274 and the factor @xmath274 is preceded by @xmath277 and followed by @xmath114 .",
    "this means that after we have extended the word @xmath2 with @xmath276 letters we have not got any new palindromes because every palindrome of length @xmath275 or shorter is contained in @xmath0 .",
    "all binary words of length @xmath278 or shorter are rich .",
    "the shortest non - rich binary words are of length @xmath279 and there are four of them : @xmath280 , @xmath281 , @xmath282 , @xmath283 . since all words are not rich it is natural to study how many of them exist .",
    "this has not yet been done .",
    "let us mark with @xmath284 the number of @xmath276-ary rich words of length @xmath4 .",
    "the next proposition states that there is an exponentially decreasing upper bound for @xmath285 ( i.e. the percentage of rich binary words from all binary words ) .",
    "[ ppp1 ] the function @xmath285 has an exponentially decreasing upper bound .",
    "first we give a recursive upper bound for @xmath286 .",
    "we start with the exact initial values : @xmath287 for @xmath288 . because there are four words of length @xmath279 that are not rich and every binary rich word can be extended richly at most two ways",
    ", we get a recursive upper bound @xmath289 for @xmath290 .",
    "this kind of recursive function is easy to solve : @xmath291    now we have that @xmath292 .",
    "the function @xmath293 decreases to @xmath22 exponentially when @xmath4 goes to infinity .",
    "using the idea from the previous proof , we can trivially enhance the upper bound .",
    "we just need to note that there are @xmath234 non - rich words of length @xmath294 , @xmath295 non - rich words of length @xmath277 , @xmath296 non - rich words of length @xmath297 and @xmath298 non - rich words of length @xmath106 , such that all the non - rich words do not contain the shorter ones as a suffix ( so they really do create completely new non - rich words ) .",
    "[ ccc1 ] for @xmath299 we have @xmath300 , where we have the exact values of @xmath301 for @xmath302 .",
    "we can of course do the same for every size of the alphabet if we change few numbers from the upper proof .",
    "suppose @xmath303 .",
    "all @xmath276-ary words of length @xmath94 or shorter are rich but all the words of form @xmath304 are non - rich and there are @xmath305 of them .",
    "[ ccc2 ] the funtion @xmath306 has an exponentially decreasing upper bound @xmath307 .    for the lower bound of @xmath284 we use theorem [ tt1 ] .",
    "we know that every rich word can be extended richly at least one way and from theorem [ tt1 ] we get that after an extension of limited length we can extend it richly with two letters .",
    "[ ppp2 ] for @xmath136 we have @xmath308 , where @xmath309 .",
    "every rich word can extended richly at least in one way . from theorem [ tt1 ]",
    "we get that every rich word @xmath0 of length @xmath310 can be extended richly with at least two ways after it has been extended with a proper word @xmath2 such that @xmath311 .",
    "these facts clearly give us our recursive formula when we notice that @xmath309 .",
    "we do not know whether the function that comes from the recursive formula of the lower bound is exponentially growing or not .",
    "note that we can improve the lower bound if we can improve theorem [ tt1 ] .",
    "note also that remark [ rr1 ] gives some limitations on improving it .",
    "for @xmath312 the exact numbers of @xmath286 are : 1 , 2 , 4 , 8 , 16 , 32 , 64 , 128 , 252 , 488 , 932 , 1756 , 3246 , 5916 , 10618 , 18800 , 32846 , 56704 , 96702 , 163184 , 272460 , 450586 , 738274 , 1199376 , 1932338 , 3089518 . in figure [ pic1 ] there are both the bounds and the 26 first exact numbers of rich binary words",
    ". the picture would imply that the upper bound can not be enhanced very much but the lower bound can be .",
    "this means that there is much to improve in theorem [ tt1 ] .",
    "let @xmath6 be an alphabet .",
    "we define _ two - dimensional word _ to be an infinite rectangular grid @xmath313 where every pair @xmath314 gets a value from @xmath315 .",
    "we denote with @xmath316 the letter ( or the empty word ) from the pair of indices @xmath314 of a two - dimensional word @xmath0 .",
    "two - dimensional words have been studied in various papers , for example in @xcite , @xcite , @xcite and @xcite , but these concepts have not been applied to rich words . here",
    "we define rich two - dimensional words and make few notions about them .",
    "two - dimensional word @xmath0 is _ rich _ if for every @xmath317 all the words @xmath316 @xmath318 and @xmath319 are rich , where @xmath320 and @xmath321 for every @xmath276 ( @xmath322 ) .",
    "we say that a two - dimensional word @xmath0 can be extended to be a _ rich plane _",
    "if for every @xmath314 for which @xmath323 there exists a letter @xmath56 such that if we set @xmath324 then the new two - dimensional word is rich .",
    "the two - dimensional words in figure [ pic2 ] are both rich .",
    "the previous can trivially be extended to be a rich plane by just adding letter @xmath85 for every empty spot , but the latter can not .",
    "this comes from the fact that we would be forced to extend the @xmath325square to the right so that the vertical word becomes @xmath280 , which is non - rich .",
    "let us suppose we have binary alphabet @xmath326 .",
    "we saw that @xmath325squares can not always be extended to be rich planes .",
    "the next proposition states that every @xmath327square can always be extended to be a rich plane .",
    "the @xmath327square does not need to be full with letters because every binary word of length @xmath328 or shorter is rich .",
    "if @xmath0 is a two - dimensional binary word such that every @xmath329 is inside a @xmath327square , then @xmath0 can be extended to be a rich plane .",
    "the proof is constructional .",
    "we suppose that the corners of the @xmath327square of @xmath0 are @xmath330 , @xmath331 , @xmath332 or @xmath333 , where the order of the corners is left lower , left upper , right upper and right lower .",
    "clearly all other possibilities are isomorphic in terms of the orientation of the plane and/or swapping the letters .",
    "if the @xmath327square is not full , we can extend it to be full in any way we want .",
    "we extend all the four possibilities in a way that is described in figure [ pic3 ] .",
    "the big letters @xmath22 and @xmath85 mean that the whole part of the plane is filled with that letter .",
    "all the horizontal    squares.,scaledwidth=60.0% ]    and vertical words inside the @xmath327square can be extened to be infinite rich words .",
    "the words @xmath334 and @xmath335 are any words that satisfies this .",
    "now we can see that the whole plane is rich by using the fact that the words @xmath336 , @xmath337 and @xmath338 are always rich if @xmath339 .",
    "the next trivial proposition gives some other two - dimensional words that can be extended to be rich planes .",
    "a finite word @xmath0 is _ strongly _ rich if @xmath340 is rich . for strongly rich words ,",
    "look @xcite and @xcite .",
    "let @xmath0 be a two - dimensional word for which @xmath329 only inside some rectangle .",
    "if every @xmath323 inside that rectangle can be chosen to be some letter such that every horizontal and vertical word is strongly rich , then @xmath0 can be extended to be a rich plane .",
    "we simply extend @xmath0 to be strongly rich inside that rectangle and then we just replicate it and fill the whole plane so that the rectangles are side by side . clearly the two - dimensional word that we get",
    "is rich .",
    "the problem whether a given two - dimensional word @xmath0 can be extended to be a rich plane is of course semi - decidable , i.e. there exists an algorithm that gives `` yes '' if the word can not be extended .",
    "it just tries every possible way to fill the empty indices @xmath314 of @xmath0 in some order .",
    "if at some point there is no possible choice , the algorithm halts and returns `` yes '' .",
    "the problem is although probably not decidable .",
    "here we list some open problems from the previous sections .",
    "let @xmath0 be a rich word .",
    "how long is the shortest @xmath2 such that @xmath3 can always be extended at least in two ways ?    is the condition in proposition [ pj ] sufficient for joining two rich words @xmath2 and @xmath67 into factors of a same rich word ?    is the following problem decidable : `` determine the infinite defect of a given finite word @xmath0 '' ?",
    "is the funtion @xmath284 , i.e. the number of rich words , exponentially increasing ?    can every @xmath341square be extended to be a rich plane ?    is the following problem decidable : `` given a two - dimensional word @xmath0 , can it be extended to be a rich plane '' ?",
    "i would like to thank my supervisors luca zamboni and tero harju for several fruitful discussions and for introducing me to rich words ."
  ],
  "abstract_text": [
    "<S> in @xcite , it was proved that every word @xmath0 has at most @xmath1 many distinct palindromic factors , including the empty word . </S>",
    "<S> the unified study of words which achieve this limit was initiated in @xcite . </S>",
    "<S> they called these words _ rich _ ( in palindromes ) .    </S>",
    "<S> this article contains several results about rich words and especially extending them . </S>",
    "<S> we say that a rich word @xmath0 can be _ extended richly _ with a word @xmath2 if @xmath3 is rich . </S>",
    "<S> some notions are also made about the infinite defect of a word , the number of rich words of length @xmath4 and two - dimensional rich words .    </S>",
    "<S> combinatorics on words , palindromes , rich words , sturmian words , defect , two - dimensional words . </S>"
  ]
}