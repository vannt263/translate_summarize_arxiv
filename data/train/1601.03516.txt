{
  "article_text": [
    "dynamics on complex networks , such as the diffusion of information in a social networks , are commonly modelled as markov processes .",
    "an advantage of this approach is that for every ( static ) network with positive edge - weights we can define a corresponding markov process by interpreting the network as the state space of a random walker , and assigning the state - transition probabilities according to the link weights .",
    "this direct correspondence between the state space of the markov process and the network enables us to examine the interplay between structure and dynamics from two sides . on the one hand",
    ", one can assess how the topological properties of a network influence the dynamical process .",
    "on the other hand , this coupling between topology and dynamics allows us to explore the structure of a network by means of a dynamical process .",
    "specifically , for a linear markov process the impact of the network structure on the dynamics will be mediated by the spectral properties of the matrix governing the time - evolution of the process , e.g. the adjacency matrix or the laplacian @xcite .",
    "reversely , spectral properties can be used to uncover salient structural properties of a network , such as modular organisation @xcite .",
    "while simple markov models have been very successful in modelling dynamics of complex systems and found many applications , they have one obvious disadvantage . in this class of models ,",
    "the future state of the system only depends on its current state and does not account for its history . in a diffusion process , for instance",
    ", the next position of a random walker only depends on the currently occupied node and its outgoing links , but not on any of the previously visited nodes",
    ". however , as it has been emphasised recently , for a broad range of networked systems , flows tend to exhibit a temporal path dependence @xcite .",
    "think of human mobility : the places a person is likely to visit next , often depend strongly on where the person came from .",
    "for instance , a person coming to work from home is likely to return home afterwards @xcite .",
    "other examples of processes with temporal memory include web traffic , journal citation flows and email cascades .",
    "such processes therefore can not be reproduced accurately by simple markov models",
    ". however , the impact of this temporal correlations can often be well - approximated already by second - order markov ( @xmath0 ) models @xcite .",
    "importantly , the transition probabilities to define these models can be obtained empirically by measuring pathways of interaction cascades , rendering such an approach suitable for applications like information spreading or human mobility .    in the standard markovian network model ( @xmath1 ) ,",
    "the elementary states are identified with the nodes of the original network ( see figure [ fig1 ] ) . in the @xmath0 model ,",
    "elementary states correspond to sequences of two nodes , and thus can be identified with _ directed edges _ in the original network ( see figure [ fig1 ] ) .",
    "therefore we may think of a @xmath2 model alternatively as a random walk between directed edges of the original network .",
    "the state space of the @xmath0 model defines a new network describing the observed dynamics , which we call here the @xmath0 or memory network .",
    "the structural properties of the memory network can now be studied by many tools of network science , allowing us to uncover interesting patterns of flow in an @xmath0 model .",
    "( right side , top panel ) , the state space is isomorphic to the physical network : every node corresponds to one state , every link indicates a transition between those states . in a second order markov model",
    "the state space is structured like a _ directed line - graph _ of the original network .",
    "the states in this @xmath2 network can be identified with the directed edges in the original network and are connected if it is possible to traverse from one edge to another edge in the original directed network .",
    "note that , when projecting back these @xmath2 dynamics onto the physical network , the probability to move from one node to another will thus appear non - markovian . ]",
    "the purpose of this paper is to highlight how the formalism of higher order markov models provides a simple means to extend network theoretic tools to take into account important dynamical properties as encoded in the @xmath0 representation .",
    "indeed many network theoretic tools may be understood as the outcome of a matrix iteration or eigenvector computation @xcite , which can be naturally associated to a dynamical process .",
    "in this paper we focus on the problem of community detection , though higher - order models can be equally applied to other problems , including the assessment of node centralities @xcite or the speedup ( or slowdown ) of spreading processes @xcite . while ref .",
    "@xcite discussed how the map equation can account for higher - order flows in community detection , here our main example will be the markov stability @xcite formalism , as it incorporates many commonly used community detection measures as special cases , notably , the concept of modularity @xcite , diverse potts models @xcite , and spectral clustering @xcite .",
    "we thereby highlight that all these classical algorithms can indeed be naturally generalised to account for memory effects by using @xmath2 networks , showing that these representations provide a general tool for the analysis of a dynamics occuring on a latent network structure .",
    "moreover , as spectral clustering can be shown to be a special case of the markov stability formalism for long times , we can draw further connections to recently proposed techniques of graph partitioning based on non - backtracking random walks @xcite , and discuss how these can be understood from the point of view of second order markov processes . we remark that as clustering an @xmath0 network is equivalent to finding a partition of the edges of the original system , it naturally leads to the detection of overlapping communities in the same way as the analysis of line graphs  @xcite .",
    "this can be a highly desirable feature , especially when analysing social networks , which tend to be organised in overlapping social circles @xcite .",
    "the remainder of this article is organised as follows .",
    "initially , we review the markov stability formalism for community detection , a general framework to detect flow - based communities in complex networks , and particularly emphasise its properties in the case of directed networks @xcite . we show how this quality function can be naturally generalised for the analysis of @xmath0 networks , which we illustrate by studying a flight network of the united states from the perspective of second order markov models . in this context",
    ", we also discuss the possibility to generate realistic pathway data using models of second - order markov processes , even if only time aggregated network information is available .",
    "subsequently , we propose a mechanism to extract pathway statistics to build second - order models from event - based , temporal network data , which do not contain pathway statistics _ a priori_. using computer - generated data and time - resolved interactions records of school - children ,",
    "we demonstrate how we can uncover communities which capture important flow - constraints imposed by the temporal activation patterns of the links .",
    "finally , we draw connections between the @xmath2 network representation and non - backtracking random walks to uncover communities in sparse networks .",
    "let us consider a continuous - time random walk on a network with @xmath3 nodes , governed by the following kolmogorov forward equation : @xmath4 here @xmath5 denotes the probability of a walker to be present on node @xmath6 at time @xmath7 ; @xmath8 is the weight of the link from node @xmath9 to node @xmath6 , i.e. , @xmath10 is the ( weighted ) adjacency matrix ; finally , @xmath11 is the weighted out - degree of node @xmath6 .",
    "clearly this dynamics is driven by the normalised laplacian matrix @xmath12 , defined as @xmath13 .",
    "the perron - froebenius theorem guarantees that a unique stationary solution exist for the above dynamics if the network is strongly connected . for an undirected network ,",
    "this stationary solution is @xmath14 , where @xmath15 is the node degree and @xmath16 is the total weight of the undirected links . for a general directed network",
    "the stationary solution is given by the dominant ( left ) eigenvector of @xmath12 , which depends on the global network properties and can not be expressed by a simple analytical formula .",
    "[ [ ergodic ] ] making the dynamics ergodic ( when it is not ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    note that for the continuous - time random walk defined above , a strongly connected graph implies an unique stationary distribution and an ergodic dynamics .",
    "these criteria are a common requirement for dynamics - based methods for network analysis @xcite .",
    "however , in a majority of real - world systems the system contains not just one but several strongly connected components ( sccs ) , whose sizes typically have different orders of magnitude .",
    "a standard solution is to address this issue by either neglecting some nodes and focusing only on the largest scc only , or by making the system strongly connected through random teleportations @xcite .",
    "the first solution has the advantage of not distorting the dynamics , while the second allows for the analysis of the whole system .",
    "when analyzing real - world systems in the following , we will for these reasons use the first solution if the vast majority of nodes belongs to the largest scc , while we will opt for the second solution if the system comprises a large number of disconnected components .",
    "the structure of a network has a strong effect on the dynamics of a diffusing random walker : in unstructured ( random ) networks , the diffusion process will evolve almost isotropically and the walker will quickly reach its stationary distribution .",
    "however , if the network contains structure , a walker can get trapped inside a group of nodes for a time far longer than expected .",
    "such groups of nodes thus constitute flow - retaining , _ dynamical communities _ in the network .",
    "hence a random walk dynamics can effectively be used to define a quality function for a network partition based on the persistence of the diffusion inside the groups . by optimising such a quality function ,",
    "we can therefore search for a modular partition of the network .",
    "important examples for such an approach include the map equation @xcite and the markov stability framework @xcite , which we consider in this paper .",
    "note that , as highlighted in refs .",
    "@xcite this notion of community is markedly different to the commonly considered structural viewpoint of communities , in that we are interested in flow - retaining , rather than densely ( homogeneously ) connected substructures .",
    "the markov stability of a partition @xmath17 is defined as : @xmath18 where @xmath19 is the probability for a walker to be in community @xmath20 initially and at time @xmath7 , for a system at stationarity .",
    "note that as all information about the initial position is lost after infinite time , @xmath21 also describes the probability of two independent walkers to be in @xmath20 .    for the process , the markov stability quality function can be written explicitly as : @xmath22,\\ ] ] where @xmath23 denotes the matrix exponential .",
    "intuitively , with increasing time the walker will be able to explore larger and larger parts of the graph .",
    "the larger the time , the larger the modules that will be found in general . by ` zooming ' through different markov times one can thus reveal adequate scales of robust community structure , which manifest themselves as plateaux in time where the same partitions are found consistently @xcite . in the limit @xmath24",
    ", it can be shown by eigenvalue decomposition that @xmath25 is maximised by a bi - partition in accordance with the normalised fiedler eigenvector , a classic method in spectral clustering  @xcite .",
    "interestingly , the expression for markov stability can be rewritten as the newman - girvan modularity @xcite of a _ different _ network , whose adjacency matrix is given by @xmath26.\\ ] ] here @xmath27 is the flow of probability from @xmath9 to @xmath6 after a time interval @xmath7 at stationarity . in this new network @xmath28 , the weight of a connection between two nodes is thus modulated according to its importance for the diffusion dynamics .",
    "this rewriting of markov stability as the modularity of a different network opens the possibility to use any modularity based algorithm for the optimization of stability , too . for the results in the present manuscript ,",
    "we have made use of the louvain algorithm @xcite , a fast greedy optimisation heuristic that has been shown to have a good performance in the literature .    in practice",
    ", it can be more efficient to consider ( [ rt ] ) in the limit of small times @xmath29 . performing a taylor expansion and keeping only linear terms in @xmath7 , results in the linearised markov stability : @xmath30.\\ ] ] note that for an _ undirected _ network , we have @xmath31 and @xmath32 , and one recovers the modularity of the original network for @xmath33 as well as the potts - model heuristic @xcite for other markov times ( see @xcite for details ) .",
    "however , for _ directed _ networks is not equivalent to the directed modularity of the original network , but is given by : @xmath34.\\ ] ] interestingly , similar adjusted adjacency ( or laplacian ) matrices have been proposed as means for community detection in the literature based on different reasoning  @xcite .",
    "note that , as with all applications of unsupervised algorithms , care is needed when interpreting the results .",
    "for instance , the optimisation of markov stability for a fixed markov time inherits the limitations of modularity maximisation , such as a resolution limit @xcite , and a high degeneracy of optimial solutions @xcite .",
    "nevertheless , this class of method has been applied successfully in numerous applications @xcite .",
    "indeed , some of these problems can be circumvented by carefully sweeping through different resolution parameters @xcite and finding partitions that are robust over a range of parameters @xcite .",
    "most importantly , however , the notion of community inherent to the methods presented here is based on flows @xcite .",
    "this is in contrast to methods like stochastic blockmodels ( sbm ) , see e.g. ref .",
    "@xcite , which employ a generative model for the whole network and aim at finding patterns of pairwise connections in the system , though very recent work aims to incorporate dynamical aspects within the sbm framework  @xcite .",
    "let us now show how we can incorporate second - order markov models into the markov stability framework . as higher - order markov models provide more faithful representations of the dynamics observed in real world systems , this enables us to capture more of the real flow constraints in the uncovered communities .",
    "for simplicity let us initially consider undirected networks composed of @xmath3 nodes and @xmath16 links .",
    "the dynamics of a second order markov process are encoded by the transition matrix @xmath35 , which describes the probability that a walker moves from node @xmath6 to node @xmath36 if it came from @xmath9 in the previous step . by definition ,",
    "this transition matrix is normalised such that @xmath37 .    as sequences of two vertices in our original network correspond to the nodes in the @xmath2 network ,",
    "the entries in @xmath38 describe precisely the transitions from @xmath0-node @xmath39 to @xmath0-node @xmath40 .",
    "the ( second - order ) @xmath2 process on the original network is thus equivalent to a first - order markov process , albeit on a different network : namely , the @xmath0 network composed of @xmath41 nodes . as each undirected link of the original network",
    "can be traversed in two distinct directions ( from @xmath9 to @xmath6 , and vice versa ) it accounts for 2 nodes in the @xmath0 network , @xmath39 and @xmath42 .",
    "this implies that the @xmath2 network is _ directed _ even if the original network is undirected . to see this ,",
    "observe that if @xmath43 , there can not be a link between @xmath40 and @xmath39 , even if a transition between @xmath39 and @xmath40 exists .",
    "henceforth we use greek letters to denote @xmath0 nodes , and latin characters to denote the nodes in the original @xmath1 network .    similarly to ( [ ctrw ] )",
    ", we can define a continuous - time random walk on the @xmath0 network as : @xmath44 where @xmath45 is the probability of finding a walker on @xmath0 node @xmath46 at time @xmath7 .",
    "likewise the stationary distribution @xmath47 of this process is given by the left eigenvector of the corresponding laplacian , associated with eigenvalue @xmath48 : @xmath49 = 0.\\end{aligned}\\ ] ]    note that we can also observe how a simple @xmath50 markov dynamics evolves from the point of view of an @xmath2 network , i.e. , we can view the @xmath50 dynamics from the point of view of transitions between the ( directed ) edges of the graph .",
    "as this is equivalent to lifting the @xmath50 dynamics into the larger @xmath2 state - space , we will denote this representation as a @xmath51 network . in this case",
    "it can be shown easily that @xmath52 , where @xmath53 is the weight of edge @xmath46 and @xmath54 @xcite .",
    "the transition probability to any out - neighbour of @xmath46 on the @xmath55 network is simply @xmath56 here @xmath57 is the set of out - neighbours of @xmath46 , and @xmath58 is the out - strength of @xmath46 . note that , since the original network has been undirected we have @xmath59 , where @xmath6 is the endpoint of memory node ( the directed edge ) @xmath60 .      while second order transition matrices @xmath38 can be directly generated from temporal pathway data , in some cases only information about the aggregated ( first - order ) network might be available .",
    "however , in such cases we can still create @xmath2 networks using a simple memory model as described in the following , calibrated by the pathway statistics of similar datasets for which this temporal information is obtainable .",
    "for instance , the temporal information pathways of one email dataset may be used to fit model - parameters to generate a second - order model for different email communication network , where only aggregated information is obtainable .",
    "the key idea underpinning the model is to weight different types of transitions between two directed edges .",
    "as illustrated in figure [ figr ] , we define three different types of transitions @xcite .    1 .   a _ return step _ , in which a walker coming from @xmath39 jumps to @xmath42 . in other words : a walker coming from node @xmath9 to @xmath6 returns to node @xmath9 .",
    "2 .   a _ triangular step _ , in which a walker coming from @xmath39 moves to edge @xmath40 , where @xmath43 is a neighbor of @xmath9 .",
    "an _ exploratory step _ , in which the walker moves from @xmath39 to an edge @xmath61 , whose endpoint @xmath62 is neither @xmath9 , nor any of the neighbors of @xmath9 .",
    "network using a second - order transition model .",
    "* from each directed edge in the original network a walker can in principle perform three types of moves , which get weighted according to the parameters @xmath63 : a _ return step _ ( @xmath64 ) , a _ triangular step _ ( @xmath65 ) and an _ exploratory step _ ( @xmath66 ) .",
    "the picture shows these different options for a generic network edge . ]    to account for their relative importance we assign positive weights @xmath64 , @xmath65 and @xmath66 to the different types of transition as follows .",
    "let us denote the adjacency matrix of the directed line graph associated with our network by @xmath67 .",
    "then we can decompose @xmath67 into three matrices @xmath68 ( return links ) , @xmath69 ( triangular ) , and @xmath70 ( exploratory ) each containing only the links of the respective type . to obtain a weighted memory model we now define the weighted @xmath71 adjacency matrix : @xmath72 from which we can compute the associated second order transition matrix @xmath73 simply by normalising each row to sum to @xmath74 .",
    "as can be easily verified , this definition implies that when we project the resulting walk onto the node space , we obtain a ( first order ) markov process when @xmath75 . we further remark that if the dynamics is ergodic on a graph for any set of parameters , it will remain ergodic for any value of @xmath64 , @xmath65 and @xmath66 , provided each parameter is strictly positive .",
    "let us now demonstrate how second - order markov dynamics can help to uncover the organisation of systems where pathway data are available , and compare their outcome with the community structure obtained by first - order dynamics and by simplified models of second - order markov dynamics , as defined in section [ sec : mem_models ] . to do so ,",
    "we consider a flight network in the united states .",
    "the data used to construct the network consists of individual flight trajectories of people navigating between different airports in the us . from these trajectories",
    "one can directly obtain a @xmath50 or @xmath2 network as discussed above and in ref .",
    "the main purpose of our analysis here is to illustrate the differences that may arise in community detection when considering the same mobility data from different modelling perspectives .",
    "we analysed the modular structure of this system for the following three scenarios : i ) a first order markov network ( @xmath76 ) , viewed from the perspectives of the edges ; ii ) a second order markov network ( @xmath0 ) where the transition probabilities are directly obtained from empirical data ; iii ) a second order markov network ( @xmath77 ) , where transitions are approximated by a simple second - order transition matrix @xmath78 ( see text ) , whose parameters have been fitted from the data . in each case , optimising the linearised stability for these different markov models yields a clustering of the edges , which can be interpreted in terms of an overlapping community structure at the airport level . to compare the different scenarios we concentrate on the results obtained for markov time @xmath33 ( see fig .  [ airports ] ) .",
    "let us also note that , for each network , only few hardly active airports do not belong to the largest scc .",
    "for this reason , as argued in section [ ergodic ] , we restrict the scope to nodes in this scc . to be more precise ,",
    "we restrict the scope to the intersection of the largest sccs of the three processes , in order to ensure that stability is well - defined for each of them .    in order to compare the communities associated to each markov process",
    ", we first calculate the normalised variation of information @xcite between the three different partitions of @xmath0 nodes obtained by optimising stability at @xmath33 . by construction ,",
    "smaller values of variation of information indicate more similar community structures .",
    "we obtain a variation of information of @xmath79 between @xmath0 and @xmath76 , @xmath80 between @xmath0 and @xmath77 , and @xmath81 between @xmath76 and @xmath77 .",
    "these results confirm that the clusters obtained from @xmath77 provide an intermediate solution between @xmath0 and @xmath76 , with the advantage of requiring far fewer parameters than in the @xmath0 case .",
    "after having found the edge - communities in each scenario , each node can be characterised by the set of group labels of its incident edges . in order to quantify the apparent difference between the covers",
    ", we measure for each node the entropy of its associated group labels .",
    "@xmath82 where @xmath83 is its fraction of edges assigned to community @xmath84 .",
    "a value @xmath85 indicates that the node is associated to a single community , while higher values indicate a more diverse participation .",
    "the level of overlap of an edge partition can now be characterised by the distribution of entropy values on the set of nodes .",
    "we observe in figure [ airports ] that analyzing the @xmath0 network results in more overlapping communities than the expanded first - order model , while the @xmath77 network is characterized by intermediate participation values .",
    "similarly as observed for the map equation  @xcite , accounting for memory via second order dynamics therefore uncovers communities with a stronger overlap , in agreement with empirical observations that higher - order dynamics tends to constrain flows within these modules .",
    "node or link activity in networked systems often exhibits non - trivial temporal patterns , such as heterogeneous inter - event times and correlations between activations times of neighbouring edges @xcite .",
    "different network representations of such temporal data can be adopted , each associated to a different notion of temporal community .",
    "a first , ` naive ' approach is to neglect the edge - timings and work with a static network representation , where the weight of each edge corresponds to an aggregation of the activity over the whole observed time interval . in this case ,",
    "community detection aims at grouping nodes which have the aggregated edge - weight concentrated inside modules .",
    "alternatively , one can represent the system by a set of ( coupled ) adjacency matrices @xmath86 , where each @xmath86 represents the system in a short - time frame of the whole observation period . by applying community detection to this representation one",
    "tries to uncover meaningful structures in each time window , while enforcing some continuity between different time intervals @xcite .",
    "this approach accordingly aims at tracking the evolution of communities in the course of time .    as we now discuss , a third notion of community is naturally associated to the representation of dynamics on temporal networks as a second - order markov process . in situations",
    "when the activations of neighbouring edges present temporal correlations , the dynamics of a random walker is expected to be poorly reproduced by a first - order markov process @xcite . however , by finding a second - order representation of the temporal data and using the methodology introduced above , one can capture the observed temporal constraints on flow , including causal paths and a high levels of synchrony between edge activity .",
    "the mapping from a time series into a second - order markov model is realized as follows .",
    "we consider a system described by an ordered set of adjacency matrices @xmath86 defining the connections between nodes at time @xmath87 $ ] , where @xmath38 is the number of observations",
    ". the static representation of the temporal network is provided by the adjacency matrix @xmath88 .",
    "each directed edge with in @xmath89 defines a @xmath0 node . the connection strength between @xmath0 nodes",
    "is now obtained by simulating pathways of a random walk process on the temporal network as follows .",
    "a walker is initially randomly assigned to a node . at every time",
    "step the walker waits until at least one edge is available for transport . if an edge becomes available",
    ", the walker leaves the node with probability @xmath90 and remains on its current node with probability @xmath91 .",
    "if there are multiple possible transitions , the walker takes each edge with a probability proportional to its weight .",
    "this process is repeated multiple times for the observed interval @xmath92 $ ] in order to generate sufficiently many trajectories . from these trajectories",
    ", one can simply construct a @xmath0 network by evaluating the transition frequencies between different edge pairs .",
    "we remark here that several other procedures could be defined to generate @xmath0 networks , too .",
    "for instance , we could account for the duration of the intervals between time steps , or define the walker s leaving probability to be proportional to the number of available contacts . note that in the above construction , when @xmath93 , the walker always takes the first available edge , and one recovers the dynamics studied in e.g. ref .",
    "the use of non - zero values of @xmath94 introduces a source of randomness in the dynamics , which can prevent spurious effects such as an overly strong tendency for backtracking as observed in @xcite .",
    "however , with increasing values of @xmath94 , the original ordering of events becomes less important , and the impact of the exact timings is expected to be diluted @xcite .",
    "let us now show that a @xmath0 representation helps at uncovering hidden structures in temporal networks .",
    "as a first illustrative example , we consider a computer - generated benchmark of a social network defined as follows .",
    "the underlying structure is a complete graph , where the ( directed ) social interactions are divided into @xmath95 different , non - overlapping types , e.g. , work relations , friends , etc .",
    "[ ex_graph ] a shows such a network with @xmath96 nodes and @xmath97 edge types .",
    "we assume that different types of relationships dominate at different times , as often observed in empirical data @xcite .",
    "therefore , at each time , all edges of one single group are simultaneously active .",
    "initially , a randomly chosen group is active . at each step ,",
    "the currently active group remains active with probability @xmath98 ; with probability @xmath99 , a new active group is randomly selected among all groups ( including the currently active one ) . for the parameters considered here , the walker thus has three outgoing edges available for transport at each step ( see figure [ ex_graph ] ) .",
    "it is important to note that for the generation of trajectories on this temporal network , a change of the probability for the walker to stay at its node @xmath94 is effectively equivalent to a change in @xmath98 . for the sake of simplicity",
    ", we therefore set @xmath100 here .",
    "clearly , the trajectories of the random walker and the corresponding structure of the @xmath0 network are affected by the value of @xmath98 .",
    "when @xmath101 , a new active group is randomly selected at each step of the random walker . in this limit , the average dynamics is equivalent to a first - order random walk on a fully connected network , and thus no underlying structure can be found .",
    "increasing @xmath98 implies that the random walker remains for longer time periods inside one group of edges before leaving , and it is thus possible to uncover the group structure .",
    "the extreme case @xmath102 is again trivial : the initial group remains active for all times .",
    "this case is therefore not considered in the following .",
    "the results of our analysis are summarised in fig .",
    "[ ex_graph ] , where we compare the uncovered communities with the planted solution into groups by means of normalised variation of information ( vi ) .",
    "our observations are twofold .",
    "first , for values of @xmath7 slightly larger than @xmath33 , we find the planted partition with high accuracy .",
    "second , one observes that the underlying communities can be successfully found when the value of @xmath98 is sufficiently large , with a clear transition around @xmath103 ( see inset in figure [ ex_graph ] ) .      to demonstrate the utility of our approach with a real - world example ,",
    "we have considered an empirical dataset from the sociopatterns project @xcite .",
    "the data , described in detail in @xcite , consists of time - dependent face - to - face contacts , captured by wireless wearable sensors , between children and teachers in a primary school . in total , the dataset is made of 77,602 contact events between 242 individuals during two consecutive days . as the children belong to 10 different classes , we expect to find strong structural communities associated to these classes in the dynamic contact network . in the following analysis ,",
    "the pathways were generated with a probability for the walker to stay at his node at each step set to @xmath104 , but similar results were obtained when varying this parameter .    by scanning through markov times we can find several persisting partitions .",
    "as validation we first identified the markov time @xmath105 around which the algorithm robustly detects @xmath106 communities , and verified that the communities overlap with the partition into classes of the students .",
    "one should note here that the partition into classes can in fact be uncovered even from the aggregated , weighted network associated to the data @xcite .",
    "the advantage of our approach becomes apparent when looking at further stable partitions found for smaller markov times .",
    "for instance , we find another robust split of the @xmath0 network at markov time @xmath107 into @xmath108 communities .",
    "for this partition most communities are still identified with classes , as can be seen in fig .",
    "[ spstand ] . however , there are also additional modules in which students from different classes are mixed .",
    "these modules display activity patterns which are highly localized in time and therefore are bound to get lost when averaging over the temporal dimension in the data .",
    "interestingly , these latter communities correspond in fact to interactions taking place between students during lunch breaks .",
    "notably , these interaction are not detectable from the aggregate network or when using a memoryless representation of the dynamics ( e.g. , the @xmath51 network ) . by using the approach outlined here , we can thus not only detect structural communities , in which actors maintain a higher amount of interactions between each other throughout time , but also temporally localized communities , which are associated to groups that interact with each other strongly over certain time - periods .",
    "[ splunch ]",
    "recently , there has been an increased interest in spectral methods based on the so - called non - backtracking matrix of a network . while standard spectral algorithms for graph partitioning tend to fail when applied to very sparse networks , krzakala _ et al .",
    "_ @xcite demonstrated how using the non - backtracking matrix one can design spectral algorithms which behave optimally right until the theoretical limit of detectability of a stochastic block model .",
    "as the name suggests , the non - backtracking matrix is intimately related to the non - backtracking random walk on a network .",
    "the non - backtracking random walk is a diffusion process in which a particle behaves just like a simple random walker on the network , albeit with one additional constraint : after arriving at a node the walker is not allowed to immediately return to the node from which she originated ( she can not ` backtrack ' ) .    interestingly , this non - backtracking random walk can be simply phrased in terms of a memory dynamics . following the notation of section [ sec : mem_models ] the non - backtracking matrix",
    "is defined on the set of @xmath0-nodes and may be simply written as @xmath109 clearly this matrix describes the line graph for a memory walker with parameters set to @xmath110 ( see section [ sec : mem_models ] ) .",
    "the associated transition matrix @xmath111 of the non - backtracking random walk is simply obtained through normalisation : @xmath112 where @xmath113 is the weighted out - degree of @xmath0-node @xmath46 .",
    "as this is just a diagonally scaled version ( by the degree ) of the non - backtracking operator , we may employ the flow based transition matrix @xmath114 for spectral partitioning of the nodes @xcite .",
    "in fact , @xmath114 is just one particular instance of a whole continuum of possible transition matrices , each with varying amounts of memory .",
    "we can thus assess the effect the introduced memory has on the clustering by varying the parameters @xmath63 and performing a spectral clustering analysis .",
    "nodes with a planted bipartition .",
    "the average degree of the network vs. the spectral clustering performance for classifying the _ nodes _ as measured by the normalised mutual information ( nmi ) .",
    "note that the theoretical detectability limit is given by @xmath115 ( red dashed line ) * ( a ) * clustering performance based on the adjacency matrix @xmath10 , the non - backtracking matrix @xmath116 , and the normalised laplacian matrix @xmath117 . *",
    "( b ) * clustering performance based on different @xmath118 transition matrices with different parameter settings . ]    like in @xcite , we consider the problem of spectral clustering here in the simplest possible setup , which is the detection of a bipartition of equally sized groups in a large , sparse network .",
    "the networks we consider here consist of @xmath119 nodes , divided into two groups according to a simple stochastic block model @xcite .",
    "we denote the average degree of each node by @xmath84 , the average degree to nodes inside its group by @xmath120 , and the average degree to nodes outside its own group by @xmath121 .",
    "note that these quantities are coupled by the simple relation @xmath122 .",
    "similar to @xcite , while keeping the ratio @xmath123 fixed , we vary the average degree @xmath84 and observe the results we obtain from different operators via spectral clustering . following @xcite , each node is grouped using the following protocol .",
    "we first compute the second dominant ( left ) eigenvector of the respective matrix operator .",
    "second , for each we sum over the eigenvector components corresponding to all of its incoming links .",
    "the nodes are grouped according to the sign of this sum : if is is positive the node is assigned to group 1 if not to the second group . in case",
    "the respective matrix operator is directly defined on the node space , the nodes are simply partitioned according to the signs of the eigenvector .",
    "note that in contrast to the problems considered above we here look at the problem of community detection from the perspective of a hard clustering of the @xmath124 rather than the edges and moreover assume that there is a fixed , known number of non - overlapping node - communities .",
    "we thus do not expect that using second - order transition matrices will necessarily improve the performance ( for the non - overlapping node - clustering ) , indeed accounting for memory can also be detrimental for this purpose as we will see in the following . however , our main purpose here was not to design an improved node clustering algorithm but to better understand the connection between spectral clustering and memory matrices .    in figure",
    "[ fig : spectral]a , we initially perform a spectral clustering analysis the non - backtracking matrix @xmath116 @xcite , the adjacency matrix @xmath10 , the normalised laplacian matrix @xmath125 as has been observed by krzakala et al .",
    ", the clustering based on the backtracking matrix @xmath116 performs clearly better than the one based on the adjacency or laplacian matrix , in particular when the graph becomes very sparse ( see figure [ fig : spectral]a ) .",
    "figure [ fig : spectral]b shows the results for the spectral clustering based on the memory walk matrices @xmath126 with various parameter settings @xmath63 .",
    "there appears to be a clear trend : the more weight there is assigned to exploratory steps , the easier it appears to decide on the node groupings .",
    "spectral clustering based on the non - backtracking second - order transition matrix @xmath127 performs almost as well as the clustering based on @xmath116 for very sparse networks . for networks with a higher average degree ( @xmath128 ) ,",
    "the results are even slightly better .",
    "as the second eigenvector of @xmath38 , which is used for the clustering , describes the approach of a memory dynamics towards stationarity it should not be too surprising that the results deteriorate if more memory is introduced : as very sparse graphs have a tendril like structure , additional memory can lead to a localisation of the dynamics in parts of the graph which correspond to strong local bottlenecks . stated differently , the slowest time - scale of the diffusion may not correlated with moving from one planted ( node ) community to the other , but local obstacles become more important making the second eigenvector a bad predictor of the bi - partition .",
    "this is in particular interesting as for most memory dynamics reported @xcite , the return flow appears to be significantly large , which would imply that the dynamical constraints on the flow are much more pronounced on a local level than one may expect from the perspective of an aggregated network .",
    "this observation appears to be aligned with the fact that many real - world systems tend to be composed of overlapping communities @xcite .",
    "network - based models have been extremely successful for the analysis of complex systems , and have led to the discovery of structural features with profound impacts on its dynamics @xcite . however , to accurately capture the complexity of real - world interacting systems , simple network models are often not sufficient . for this reason ,",
    "different approaches have been proposed recently , which increase the model dimension and enrich the network paradigm .",
    "one approach that has gained prominence in the literature , is to account for the different types of interactions present in the system by means of multiplex or multilayer networks @xcite .",
    "our approach developed in the work presented here proceeds in a similar spirit : by providing a larger state space representation in the _ temporal _ dimension , we aim to obtain new insights about the dynamical processes taking place in the system . despite their similarities",
    "( see ref .",
    "@xcite ) , multiplex networks and higher - order markov models differ , as the former model tends to emphasise differences in the connections of the system , while the second emphasises pathways .    in this paper",
    ", we have focused on the applicability of second - order markov dynamics in the context of flow - based community detection .",
    "second - order markov dynamics model real - world temporal dynamics more accurately , so the found communities are expected to better capture the actual flow constraints in the system . in particular ,",
    "we have shown how the markov stability framework , and thus techniques like potts models and spectral clustering , can be based on a second - order markov dynamics , which is equivalent to considering transitions between directed edges in the original network .",
    "as clustering of second order models yields a partition of the edges , one can readily interpret the results as an overlapping clustering of the nodes in the original system , which is a beneficial feature of the approach .",
    "some practical concerns are associated with moving to a second - order model .",
    "naturally , there is an increased computational cost , as the number of nodes in the second - order model is equivalent to the number of directed edges in the original network .",
    "however , as most networks are sparse , this cost tends to be outweighed by the benefits gained from a higher - order dynamical representation .",
    "another practical issue is that pathway statistics , needed to construct a second - order transition matrix directly from data , may not always be immediately accessible . to make the toolkit of second order models available in such scenarios , we have presented two different strategies",
    "first , we have analysed a simple model able to generate realistic second - order dynamics , which can be calibrated from similar datasets .",
    "second , we have demonstrated how to represent temporal network data as a second order network .",
    "we have tested these two strategies by focusing on a flight network in the united states , and a ( temporal ) social interaction network in a school environment , respectively . in both cases , the second order dynamics , even approximated , allowed us to extract temporal patterns in the data that would have been missed by an aggregated first - order model .",
    "finally , we have highlighted the relationship between second - order markov models and the recently introduced spectral clustering formalism based on the non - backtracking matrix .",
    "interestingly , the non - backtracking matrix corresponds to a scaled version of the transition matrix of a non - backtracking random walk , which is a special case of the second order dynamics discussed in this manuscript .",
    "as we have demonstrated , this connection opens up the possibility to investigate further second order markov processes and their relationships to spectral clustering .",
    "investigating these issues in more detail will be the subject of future work .",
    "we acknowledge financial support from f.r.s - fnrs , arc and from the cost action td1210 knowescape .",
    "this paper presents research results of the belgian network dysco ( dynamical systems , control , and optimismtion ) , funded by the interuniversity attraction poles programme , initiated by the belgian state , science policy office ."
  ],
  "abstract_text": [
    "<S> complex systems made of interacting elements are commonly abstracted as networks , in which nodes are associated with dynamic state variables , whose evolution is driven by interactions mediated by the edges . </S>",
    "<S> markov processes have been the prevailing paradigm to model such a network - based dynamics , for instance in the form of random walks or other types of diffusions . despite the success of this modelling perspective for numerous applications </S>",
    "<S> , it represents an over - simplification of several real - world systems . </S>",
    "<S> importantly , simple markov models lack memory in their dynamics , an assumption often not realistic in practice . here , we explore possibilities to enrich the system description by means of second - order markov models , exploiting empirical pathway information . </S>",
    "<S> we focus on the problem of community detection and show that standard network algorithms can be generalized in order to extract novel temporal information about the system under investigation . </S>",
    "<S> we also apply our methodology to temporal networks , where we can uncover communities shaped by the temporal correlations in the system . </S>",
    "<S> finally , we discuss relations of the framework of second order markov processes and the recently proposed formalism of using non - backtracking matrices for community detection . </S>"
  ]
}