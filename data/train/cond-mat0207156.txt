{
  "article_text": [
    "thanks to the availability of massive flows of financial data , theoretical insights on financial markets can nowadays be tested to an unprecedented precision in socio - economic systems .",
    "this poses a challenge which has attracted natural scientists who have pioneered an _ empirical _ approach to financial fluctuations @xcite independent of the econometric approach and often in contrast with the _ axiomatic _ approach of theoretical finance @xcite .",
    "the empirical evidence depicts financial markets as complex self - organizing critical systems : the statistics of real market returns deviate considerably from the olympic gaussian world described by louis bachelier at the turn of last century .",
    "rather mandelbrot @xcite observed that fractal ( levy ) statistics gives a closer approximation , even though that is not a satisfactory model@xcite .",
    "market returns display scaling@xcite , long range volatility correlations and evidence of multiscaling @xcite have also been discussed .",
    "such features evoke the theory of critical phenomena in physics , which explains how quite similar features may emerge from the interaction of many microscopic degrees of freedom and statistical laws . indeed",
    "financial markets _ are _ systems of many interacting degrees of freedom ( the traders ) and there are very good theoretical reasons to expect that they operate rather close to criticality @xcite .",
    "these expectations have been substantiated by microscopic agent based market models@xcite : the picture offered by these _ synthetic markets _ is one where speculation drives market to information efficiency ",
    "i.e. to a point where market returns are unpredictable .",
    "but the point where markets become exactly efficient is the locus of a _ phase transition_. close to the phase transition the behavior of synthetic markets is characterized by the observed stylized facts  fat tails and long range correlations  whereas far from the critical region the market is well described in terms of random walks ( see ref .",
    "@xcite for a non technical discussion ) .",
    "work has however been mostly confined on single assets or indices .",
    "recently ensembles of assets and their correlations have become the focus of quite intense interest .",
    "on one side the role of random matrix theory has been realized as a tool for understanding how noise dresses financial correlations @xcite how one can undress them @xcite , how clustering techniques can help understanding the structure of correlation @xcite , and the impact of such consideration on portfolio optimization @xcite .",
    "here we report findings that strongly support the view of a self - organized critical market .",
    "we show that long range correlations and scale invariance extends both across assets and , in the behavior of the ensemble of assets , across frequencies . more precisely , we apply a novel parameter free data clustering method @xcite to a large financial data set @xcite in order to uncover the internal structure of correlations both across different assets and across different days .",
    "we identify statistically significant classifications of assets in correlated _ sectors _ and of daily profiles of market - wide activity in market _ states_. both the statistics of sector sizes and of state sizes shows scale free properties .",
    "determining market s states is an important achievement both theoretically and practically : the concept of a state which codifies all relevant economic informations is the basis of many theoretical models of financial markets .",
    "but practically every day traders experience a quite different reality : the market place is flooded with massive flows of information of which it may be hard to say what is relevant and what is irrelevant .",
    "it is by no means obvious that something like market states exists at all and even if they exist the problem becomes that of identifying them .",
    "our aim is to give a practical answer to these questions",
    ". we shall keep our discussion as simple as possible , relegating technical details in notes and in the appendix .",
    "the data clustering method that we use has been recently proposed in ref .",
    "@xcite . in brief , it is based on the simple statistical hypothesis that _ similar objects have something in common_. it is possible to compute the likelihood that a given data set satisfies this hypothesis and hence to look for the most likely cluster structure . a precise definition is given in the appendix and for more details we refer the interested reader to refs .",
    "let us only mention that this method overcomes several limitation of traditional data clustering approaches , such as the needs of pre - defining a metric , fixing _ a priori _ the number of clusters or tuning the value of other parameters@xcite .",
    "the data set covers a period from 1st january 1990 to 30th of april 1999 and it reports daily prices ( open , hi , low , close ) for @xmath1 assets traded in the new york stock exchange @xcite . the number of assets actually traded varies with time . hence we mainly focus on a subset of the @xmath2 most actively traded assets ( see http://www.sissa.it/dataclustering/fin/ for the detailed list of assets considered , as well as for further informations ) .",
    "our goal is to investigate the _ internal _ structure of correlations hence we first normalize the raw data @xcite in order to eliminate common trends and patterns both across assets and across different days .",
    "this procedure eliminates for example the so - called `` market mode '' , i.e. the constant correlation of individual asset s returns with the so - called `` market s return '' .",
    "we first apply data clustering to group assets with a similar economic dynamics in sectors of _ correlated _ assets ( see appendix ) .",
    "this classification reveals a rich structure .",
    "the clusters giving the largest contributions to the log - likelihood clearly emerge from the noisy background in fig .",
    "[ figassets ] .",
    "we find a large overlap with the sectors of economic activity defined by the standard industrial classification ( sic ) codes ( see caption of fig . [ figassets ] ) .",
    "but we also find significant correlations between assets with widely different sic .",
    "this has practical relevance for risk management of large portfolios which can not be handled all at once .",
    "indeed rather than splitting the problem according to economic sectors ( defined by the sic ) it is preferable to use our classification in correlated sectors .",
    "the difference of the two classifications is also revealed by a zipf s plot of the size of sector against its rank ( see inset of fig .",
    "[ figassets ] ) .",
    "the distribution of correlated sector sizes follows zipf s law to a high accuracy , i.e. the number @xmath3 of sectors with more than @xmath4 firms ( i.e. of size larger than @xmath4 ) is inversely proportional to @xmath4 .",
    "note that the scale free distribution of sector sizes is not due to an analogous property of _ fundamentals_. indeed the rank plot of economic sector sizes bends in log - log scale .",
    "this suggests that zipf s law arises as a dynamical consequence of market interaction .",
    "the scale invariant behavior is robust with respect to the subset of assets taken : the same behavior is found considering the @xmath5 or @xmath6 most actively traded assets , in that period or @xmath7 assets in the s&p500 index ( see ref .",
    "in addition we find , as in ref .",
    "@xcite , that the correlation @xmath8 inside sector @xmath9 ( see appendix ) scales with its size @xmath10 with a law @xmath11 with @xmath12 .",
    "we finally remark that this property is not an artifact of the method .",
    "indeed the distribution of eigenvalues of the correlation matrix shows a similar broad distribution , even though that is affected by considerable noise dressing @xcite . a factor model which takes into account a large enough number of principal components ( corresponding to the largest eigenvalues ) reproduces the same features eigenvalues of the correlation matrix are significantly outside the noise band predicted by random matrix theory @xcite . with a correlation matrix which retains the structure of the first @xmath13 principal components ( considering the remaining components as uncorrelated noise ) we found a quite similar cluster structure . ] .",
    "are there well defined patterns of daily market - wide economic performance ? in order to answer this question , rather than classifying assets according to their temporal evolution , we can classify days according to the performance of different assets . fig . [ figdays ]",
    "implies that , above a noisy background , a meaningful classification of the daily profiles of market activity exists .",
    "clusters of days can be identified with different patterns of market wide activity  or market states .",
    "quite remarkably , the maximum likelihood classification in market states shows scale free features , for large clusters ( frequent patterns of market activity ) . the number of patterns which occur more than @xmath14 days behaves as @xmath15 for the most frequent patterns ( inset top ) . there is a clear crossover in the plot of cluster s correlation versus cluster size which distinguishes the meaningful clusters ( patterns ) from a random noise background ( inset bottom ) .    from a sample of @xmath2 assets over @xmath16 days we identify @xmath17 different states  characterized by similar profiles of market activity  plus a sixth random state ( see fig . [ figdays ] ) .",
    "we assign an integer @xmath18 between @xmath19 and @xmath20 to each day @xmath21 , which is the state which occurred in that day .",
    "we are then in a position to analyze market performance in different states .",
    "[ figcross ] shows the ( non normalized ) average daily returns of different asset in different states . we find that market s behavior in states 1 and 2",
    "are anti - correlated : those assets which go up in state 1 go down in state 2 , on average .",
    "[ figcross ] also shows that assets in the same sector as defined above have a similar behavior .",
    "so , for example , while most of the assets go up in state 1 and down in state 2 , the cluster of assets of gold and silver mining has an opposite behavior .",
    "state 3 is clearly characterized by a fall of high - tech companies and a mild rise in the electric sector .",
    "an opposite behavior takes place in state 4 , whereas state 5 is dominated by the a marked rise of oil & gas , and petroleum refining companies @xcite .",
    "these results are remarkably stable with respect to the definition of the time window where the analysis is performed @xcite .",
    "clustering the market s dynamics leaves us with the sequence @xmath18 of the states of the market in different days @xmath22 .",
    "this allows us to pose interesting questions on predictability and market s information efficiency .",
    "let us first ask : is it possible to predict the state @xmath23 of the market tomorrow , given the state @xmath24 of the market today ? in order to answer this question we estimate the probability @xmath25 of transition from state @xmath24 to state @xmath23 .",
    "it turns out that both the classification in states and the transition matrix @xmath26 are very stable with respect to the definition of the time window @xcite .",
    "this means that they both vary very slowly in time .",
    "hence we shall neglect their variation in time henceforth .    _",
    "if _ the process @xmath18 were markovian , its predictability could be quantified by the characteristic time @xmath27 of convergence to the stationary state .",
    "this is related to the second largest ( in absolute value ) eigenvalue @xmath28 of the matrix @xmath26 by @xmath29 .",
    "we find @xmath30 days  a value which would occur by chance , if there were no correlations , in one out of @xmath31 cases for symbolic sequences @xmath32 generated by randomly reshuffling days .",
    "these times are distributed around @xmath33 with a spread @xmath34 .",
    "the analysis of the tail of the distribution allows to estimate the likelihood of @xmath35 for the real sequence . ]",
    ". statistical prediction is possible .",
    "can we predict market s returns on the basis of these results ?",
    "[ figcross ] shows that average returns @xmath36 conditional on the state @xmath18 of the market contain non - trivial information .",
    "however this information is not available for trading in day @xmath21 .",
    "but if we know the transition matrix @xmath26 we can estimate the expected return of asset @xmath37 tomorrow given the state @xmath24 today : @xmath38 a natural measure of predictability , inspired by works on theoretical models @xcite , is the averaged signal - to - noise ratio defined as : @xmath39 where @xmath40 and @xmath41 is the frequency with which state @xmath24 occurs . the distribution of @xmath42 across assets is shown in fig .",
    "[ figph ] for @xmath43 , @xmath44 and @xmath45 .",
    "the latter gives a benchmark of the background noise level .",
    "we find @xmath46 for several assets @xmath37 : the knowledge of @xmath18 _ before _",
    "day @xmath21 provides significant predictive power on excess returns . that same information is much less useful the day after , since @xmath47 is only slightly above the noise level",
    "this is a further indication that the financial market is close to information efficiency , but not quite unpredictable . in reality",
    "the transition matrix @xmath26 changes slowly in time .",
    "hence this conclusion provides an `` upper bound '' for the market s predictability ( when measured out - of - sample ) : real markets are therefore even closer to efficiency .",
    "if @xmath18 were a markov process , the characteristic time @xmath48 for transitions @xmath49 over @xmath50 days is computed in the same way as @xmath51 above , from the matrix @xmath52 of transition probabilities @xmath53 in @xmath50 days . for a markov process",
    "this matrix is the @xmath54 power of the matrix @xmath26 and its eigenvalues are given by @xmath55 .",
    "] should decrease with @xmath50 as @xmath56 .",
    "a prediction of the future state of the market , which is significantly better than a random draw , would only be possible on a time horizon of one day , if the process were markovian .",
    "the inset of fig .",
    "[ figph ] shows that @xmath48 remains significantly above the noise level almost up to @xmath57 days !",
    "this means that @xmath18 carries significant information about the future state @xmath58 of the market , even after @xmath59 days .",
    "the slow decay of @xmath48 is a further signature of the presence of long range correlations .    during the period we have studied ,",
    "two major extreme events occurs : the 27 october 1997 and the 31 august 1998 crashes .",
    "the state process @xmath18 is different before the crash , but is quite similar after it .",
    "the strings of states , starting from the day of the crash , read @xmath60 and @xmath61 in the two cases .",
    "this is a significant similarity occurred in the process but the starting days were fridays ( 90/04/27 and 90/05/25 ) and not mondays .",
    "note furthermore that normalization @xcite removes the collective component of the dynamics and it ensures that crash days appear with the same weight as normal days in the analysis . ] .",
    "this suggests the existence of a particular dynamical pattern with which markets respond to extreme events ( see also ref .",
    "@xcite on this ) .",
    "in conclusion we show that both the _ horizontal _ clustering of assets in correlated sectors and the _ vertical _ classification of market - wide economic performance in market states , reveal a scale free structure ( see figs .",
    "[ figassets ] , [ figdays ] ) .",
    "the emergent picture poses quite severe constraints on multi - asset agent based modeling , which we believe will disclose important information on how real markets work .",
    "this expectation is based on the fact that scale - free statistical behavior is a signature of interaction mechanisms which is rather insensitive to microscopic details .",
    "furthermore , the identification of market states allows us to precisely quantify informational efficiency by computing the market s predictability , thereby establishing a direct contact between the empirical world and the realm of theoretical models .",
    "in particular we find that , as expected , markets are close to information efficiency .",
    "we find that correlated sectors have a large overlap with sectors of economic activity . in the same way",
    ", it would be interesting to understand how states are correlated with economic information and the news arrival process .    in a wider context",
    ", we have discussed an unsupervised approach to the study of a complex system .",
    "be it a stock market , the world economy , urban traffic network , a cell of a living organism or the immune system , the complex system can be considered as a black box .",
    "we show how a series of simultaneous measures in many different `` points '' of the system allows one to identify its _ parts _ and its _",
    "states_.    a black box approach to a financial market or to a cell , which neglects all of economics and finance or of biology and genetics and relies only on empirical data , may lead to misleading results specially if the data set is incomplete .",
    "still , we believe , it has the potential of uncovering collective aspects which can hardly be derived in a theoretical bottom - up approach .",
    "consider a set of @xmath62 objects each of which is defined in terms of @xmath63 measurable features , so that each object is represented by a vector @xmath64 , @xmath65 .",
    "we assume for simplicity that data are normalized : @xmath66 where @xmath67 and @xmath68 .    in our case , when identifying sectors , the objects are assets and @xmath69 , the number of assets .",
    "their features are the daily returns in each day @xmath21 and @xmath70 .",
    "the @xmath71 component of @xmath72 is @xmath73 .",
    "when identifying states instead objects are days and features are assets ( i.e. @xmath74 and @xmath75 ) .",
    "the @xmath76 component of @xmath77 is @xmath78 .",
    "the problem of classifying @xmath62 objects into different classes goes under the name of data clustering .",
    "naively one would like to have similar objects classified in the same cluster , but in practice one faces a number of problems : what does it mean similar ? what is the `` right '' number of clusters ? which principle to follow ?",
    "we resort to a recent data clustering technique @xcite based on the maximum likelihood principle and a simple statistical hypothesis : _ similar objects have something in common_. in mathematical terms , we let @xmath79 be the label of the cluster to which object @xmath37 belongs , and @xmath80 be the set of objects with @xmath81 .",
    "we assume that @xmath82 here @xmath83 denoted the _",
    "common _ component shared by all objects @xmath84 and @xmath85 weights the common component against the individual one @xmath86 .",
    "( [ ansatz ] ) is the statistical hypothesis where @xmath87 and @xmath79 are the parameters to be fitted . assuming further that both @xmath83 and @xmath88 are gaussian vectors in @xmath89 , with zero average and unit variance ( @xmath90=e[\\|\\epsilon_i\\|^2]=1 $ ] ) makes it possible to compute the likelihood of the parameters @xmath91 and @xmath92 ( see ref .",
    "@xcite for details ) .",
    "the likelihood is maximal when @xmath93 } % ~~~\\hbox{if $ c_s\\ge n_s$}\\ ] ] where @xmath94 is the number of objects in cluster @xmath9 and @xmath95 is the total correlation inside cluster @xmath9 .",
    "the maximum log - likelihood per feature takes the form @xmath96.\\ ] ] note that a cluster with a single isolated object ( @xmath97 ) , or a cluster of uncorrelated objects ( @xmath98 ) gives a vanishing contribution to the log - likelihood .    several algorithms for finding an approximate maximum of @xmath99 over the space of cluster structures",
    "@xmath100 have been discussed in ref .",
    "we used both hierarchical clustering and simulated annealing algorithms , which yield quite similar results ( the codes are available on the internet @xcite ) .",
    "figures [ figassets ] and [ figdays ] are a graphic representation of the hierarchical clustering algorithm : it starts from @xmath62 clusters composed of a single object and it produces a sequence of cluster structures . at each iteration ,",
    "two clusters of the configurations with @xmath101 clusters are merged so that the log - likelihood of the resulting configuration with @xmath102 clusters is maximal .",
    "this procedure starts with @xmath103 and it stops with @xmath104 , when a single cluster is formed .",
    "the log - likelihood of the cluster structure is @xmath105 when @xmath103 , it decreases with @xmath101 and it reaches a minimum for an intermediate value of @xmath101 .",
    "then it increases again and reaches @xmath106 when @xmath104 , because of data normalization .",
    "the graphs report the log - likelihood of each cluster on the @xmath107 axis .",
    "the initial configuration corresponds to @xmath62 points aligned on the @xmath108 axis ( zero log - likelihood ) .",
    "each merge operation is represented graphically by a link between the merging clusters and the new cluster .",
    "hence as the log - likelihood decreases structures above the @xmath108 axis start to form .",
    "red links are merging steps which increase the log - likelihood .",
    "blue links corresponds to situation where the log - likelihood of the union of the clusters is larger than that of each part but it is smaller than their sum ( hence the total log - likelihood decreases ) .",
    "hence statistically relevant clusters appear as the large red structures in the plot .",
    "laloux et al .",
    ", _ noise dressing of financial correlation matrices _ , phys .",
    ". lett . * 83 * , 1467 ( 1999 ) ; v. plerou et al .",
    "_ universal and nonuniversal properties of cross correlations in financial time series _ , _ ibid _ 1471 .",
    "the data set was made available by courtesy of r. n. mantegna .",
    "the tic symbols of the subset of assets considered , the detailed cluster structures of sectors and states and other informations are available at http://www.sissa.it / dataclustering / fin/.    let @xmath109 be the return of asset @xmath110 in day @xmath22 .",
    "we set @xmath111 where @xmath112 is a time average and @xmath113 denotes the average over assets .",
    "as in m. b. eisen et al . ,",
    "[ proc . natl .",
    "usa , * 95 * , 14863 ( 1998 ) . ] , the normalized data @xmath114 , is obtained as the limit of @xmath115 as @xmath116 . in practice",
    "the iteration was stopped after a given accuracy was reached .",
    "this procedure does not affect significantly the results .",
    "indeed the first step of normalization eliminates most of the global patterns .",
    "for missing values we assumed @xmath117 if asset @xmath37 were not traded on day @xmath21 .    in order to asses the stability of the results we repeated the classification of days for the first ( from jan .",
    "90 to aug .",
    "94 ) and the second ( sep .",
    "94 to apr .",
    "99 ) halves of the time series .",
    "we found dendrograms quite similar to those in fig .",
    "[ figdays ] with two main dominant states .",
    "clustering again days into @xmath20 states , we found two new sequences @xmath118 for @xmath119 and @xmath118 for @xmath120 .",
    "we found that @xmath121 in @xmath122% of cases and @xmath123 in @xmath124% of cases , where @xmath18 is the state occurring in day @xmath21 according to the analysis of the whole time series ."
  ],
  "abstract_text": [
    "<S> by analyzing a large data set of daily returns with data clustering technique , we identify economic sectors as clusters of assets with a similar economic dynamics . </S>",
    "<S> the sector size distribution follows zipf s law . </S>",
    "<S> secondly , we find that patterns of daily market - wide economic activity cluster into classes that can be identified with market states . </S>",
    "<S> the distribution of frequencies of market states shows scale - free properties and the memory of the market state process extends to long times ( @xmath0 days ) . </S>",
    "<S> assets in the same sector behave similarly across states . </S>",
    "<S> we characterize market efficiency by analyzing market s predictability and find that indeed the market is close to being efficient . </S>",
    "<S> we find evidence of the existence of a dynamic pattern after market s crashes .    2 </S>"
  ]
}