{
  "article_text": [
    "to implement the siam in eq .   in the main text with the digital quantum simulator , we first map the creation and annihilation operators in @xmath77 onto spin operators that act on the qubits in the coprocessor .",
    "this is achieved via the jordan  wigner transformation @xmath78 , @xmath79 , and @xmath80 ( we take @xmath81 to be the impurity ) . here ,",
    "@xmath82 , and @xmath83 , @xmath84 , and @xmath85 are the pauli spin operators .",
    "the transformation maps @xmath25 fermionic sites onto a string of @xmath86 qubits such that two adjacent qubits represent one lattice site .",
    "the correspondences between the qubit states and fermionic states are @xmath87 , @xmath88 , @xmath89 , and @xmath90 .    to obtain the necessary quantum gates to approximate the unitary evolution operator we use a trotter decomposition on the propagator @xmath91 between each time @xmath92 and @xmath93 as @xmath94 , where @xmath95 .",
    "each term @xmath96 can be readily implemented using spin rotations @xmath97 where @xmath98 is the angle of rotation , and multi - qubit mlmer ",
    "srensen ( ms ) gates  @xcite , characterized by two phases @xmath99 and @xmath100 as @xmath101 $ ] , with @xmath102 ( see supplementary material ) . here",
    ", the ms gate acts on qubits @xmath103 , @xmath104 ,  , @xmath105 , and the phase @xmath99 controls the amount of entanglement , while varying @xmath100 allows a shift between a @xmath83 or a @xmath84 type gate .      using the jordan  wigner transformation , the lesser and greater impurity green s functions for each spin @xmath106",
    "can be written as a sum of four expectation values of products of pauli operators and evolution operators ( see supplementary material ) .",
    "we use a single - qubit interferometry scheme@xcite to measure each of the expectation values @xmath107 that constitute the green s function .",
    "we introduce a probe qubit which is coupled to the string of @xmath86 system qubits .",
    "we assume that the probe qubit is prepared in the pure state @xmath108 , yielding the total system - probe density operator @xmath109 .",
    "the combined system is then run through a ramsey interferometer sequence , in which first a @xmath110 pulse ( or hadamard gate @xmath111 ) is applied to the probe qubit , the state of which will transform into the superposition @xmath112 .",
    "the two states in the superposition provide the necessary interference paths .",
    "following the @xmath110 pulse , we apply the unitary evolution on the system of interest up to a certain time @xmath14 .",
    "the pauli operators are then applied on the system as controlled quantum gates with either @xmath108 or @xmath113 as the control state .",
    "this is followed by evolution up to the final time @xmath14 , another controlled application of pauli gates , and finally another @xmath110 pulse is applied on the probe qubit , bringing the interference paths together .",
    "the output state of the probe qubit at the end of the ramsey sequence is given by @xmath114\\nonumber \\\\ = & \\frac{1+\\mathrm{re}[f(t , t')]}{2}|0\\rangle \\langle 0 | - i\\frac { \\mathrm{im}[f(t , t')]}{2}|0 \\rangle \\langle 1 |   + i\\frac { \\mathrm{im}[f(t , t')]}{2}|1 \\rangle \\langle 0",
    "| + \\frac{1-\\mathrm{re}[f(t , t')]}{2}|1 \\rangle \\langle 1 |,\\end{aligned}\\ ] ] where @xmath115.$ ] here , the unitary operators @xmath116 and @xmath117 , in which @xmath118 and @xmath119 are pauli operators or tensor products of pauli operators ( see supplementary material ) , act only on the system and not on the probe qubit .",
    "note that we can write @xmath120\\hat{\\sigma}_z + \\mathrm{im}[f(t , t ' ) ] \\hat{\\sigma}_y \\right),$ ] so that we have @xmath121=\\mathrm{re}[f(t , t')],$ ] and @xmath122=\\mathrm{im}[f(t , t')]$ ] . therefore repeated measurements ( which can be done in parallel ) of the @xmath123 and @xmath124 components of the probe qubit for all times @xmath14 and @xmath5 yields a contribution to the impurity green s function @xmath30 . for a spin - symmetric system , on the order of 80,000 measurements per time step are required .",
    "see supplementary material for details .",
    "10 url # 1`#1`urlprefix[2]#2 [ 2][]#2    .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & _ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    &",
    "_ _ * * , ( ) .    , ,",
    "_ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _ _ * * , ( ) .    , & . _",
    "_ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , &",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "* * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    _",
    "_ , vol .",
    "( , ) .    , , & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .    , , , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    , &",
    "_ _ * * , ( ) .    , &",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "* , ( ) .",
    "& . _ _ * * , ( ) .",
    ", , , & . _ _ ( ) .         in the siam dynamics .",
    "this example network is given for the paramagnetic phase starting from the atomic limit , as considered in the main text and in ref.@xcite .",
    "a probe qubit ( top line ) is prepared in a symmetric superposition @xmath125 of computational basis states @xmath108 and @xmath113 by a hadamard gate @xmath126 . here , @xmath49 , and the initial states of the bath sites ( lines below the impurity )",
    "are set to either @xmath108 or @xmath113 using jordan  wigner transformed operators , following the standard scheme in ref.@xcite . after evolving the siam to time @xmath14 according to @xmath127",
    "the probe qubit interacts with the impurity via controlled pauli gates .",
    "a second set of controlled pauli gates is applied after evolving the impurity to time @xmath5 .",
    "the precise choice of pauli gates selects different contributions to the green s function .",
    "after another hadamard gate this contribution is encoded in the expectation values @xmath85 and @xmath84 of the probe qubit , as discussed in methods . ]",
    "we provide background details on non - equilibrium dynamical mean - field theory and the setup that we study in the main text , and present the formulae needed for implementing the single - impurity anderson model with qubits and on measuring the single - particle non - equilibrium green function .",
    "we further elucidate the non - interacting system where we studied reducing the effects of a noisy bath .",
    "one of the simplest models to capture essential phenomena in strongly - correlated electron materials is the single - band hubbard hamiltonian @xmath128 where @xmath129 is the tunnelling ( ` hopping ' ) matrix element between nearest - neighbour sites @xmath2 and @xmath3 , and @xmath8 is the on - site coulomb repulsion . here",
    ", we have assumed general time - dependent parameters due to the driving of material via , e.g. , intense laser pulses  @xcite .",
    "furthermore , @xmath6 ( @xmath130 ) is the creation ( annihilation ) operator for an electron with spin projection @xmath131 at site @xmath2 , while @xmath132 is the corresponding number operator .    despite its apparent simplicity ,",
    "the hubbard model   is notoriously difficult to solve , even numerically , and especially in two dimensions where it may be relevant to high-@xmath133 superconductivity .",
    "fortunately , dynamical mean - field theory ( dmft )  @xcite and its extension to non - equilibrium problems  @xcite provide a means to compute local observables by circumventing the necessity of dealing directly with the hubbard hamiltonian .",
    "this is achieved by mapping it onto an impurity model , the solution of which is usually easier to obtain , albeit still a highly non - trivial computational task .",
    "the mapping is justified in the limit of infinite spatial dimensions , @xmath134 , ( or infinite coordination , @xmath135 ) by the collapse of the irreducible self - energy of the hubbard model to only contributions emerging from strictly local skeleton diagrams which are identical to those of an impurity model .",
    "the collapse of the skeleton diagrams follows from the necessity to scale the hopping parameters as @xmath136 to avoid a diverging average kinetic energy per lattice site and from simple power counting arguments . while describing the full hubbard hamiltonian with a single - impurity model",
    "is only an approximation in finite dimensions , it often relatively accurate already in three dimensions for certain lattice types .",
    "the solution of the impurity model means essentially computing the local green function @xmath137\\right\\}}{\\operatorname{tr}\\left\\ { \\mathcal{t}_{\\mathcal{c } } \\left [ \\exp(\\hat{s}_{\\mathrm{loc}})\\right]\\right\\ } } , \\end{aligned}\\ ] ] where @xmath138 is the contour - ordering operator on an ` l - shaped ' keldysh time - contour @xmath139 ( see fig .",
    "[ fig : keldysh ] ) .",
    "the local action @xmath140 is given by  @xcite @xmath141\\nonumber \\\\&-i\\int_{\\mathcal{c } } dt \\int_{\\mathcal{c } }   dt ' \\ , \\sum_\\sigma \\lambda_\\sigma(t , t')\\hat{c}^{\\dagger}_\\sigma(t)\\hat{c}_\\sigma(t').\\end{aligned}\\ ] ] here , @xmath142 is the chemical potential and @xmath143 is the _ a priori _ unknown hybridization function , or weiss function , that describes the exchange of electrons between the impurity site with a bath of non - interacting electrons . the essential step in dmft is the self - consistent determination of @xmath143 . for a bethe lattice , which corresponds to a semi - elliptical density of states @xmath144 , the dmft self - consistency condition obtains a simple closed form . for time - dependent hoppings @xmath145 , this reads @xmath146    .",
    "it consists of two real - time branches between an initial time @xmath147 to final time @xmath29 , and an imaginary - time branch from @xmath147 to @xmath148 , where @xmath149 is the inverse temperature . ]",
    "the impurity action   can also be represented in a hamiltonian form which permits the application of hamiltonian - based numerical methods  @xcite to compute the local green function .",
    "it also makes it possible to use the trapped - ion scheme for quantum simulations  @xcite .",
    "the impurity model that we address here is the single - impurity anderson model ( siam ) given by @xmath150 @xmath151 @xmath152 @xmath153\\hat{a}_{p\\sigma}^{\\dagger}\\hat{a}_{p\\sigma},\\end{aligned}\\ ] ] here , @xmath154 ( @xmath155 ) is the creation ( annihilation ) operator for the impurity orbital , and @xmath156 ( @xmath157 ) for a bath orbital @xmath28 .",
    "further , @xmath27 describes the hopping of electrons between the impurity and the bath , and @xmath26 denotes the energy of the bath orbital @xmath28 .",
    "the siam hamiltonian   corresponds to the correct dmft action   if the parameters @xmath158 and @xmath26 are chosen such that the relation @xmath159 is valid on the whole keldysh contour @xmath139 . here",
    ", the siam hybridization function has the expression  @xcite @xmath160 where @xmath161e^{-i\\int_{\\mathcal{c}}d\\bar{t } \\ , ( \\epsilon_{p\\sigma}(\\bar{t})-\\mu ) } \\end{aligned}\\ ] ] is the non - interacting green function for an isolated bath site , with @xmath162 denoting the fermi distribution function and @xmath163 being the contour heaviside function defined as @xmath164    an essential part of the hamiltonian - based dmft scheme is the determination of the parameters @xmath27 and @xmath26 for a given hybridization function @xmath13 . in what follows , we will relax the spin index @xmath106 for the hybridization function since below we will be dealing with a spin - symmetric set - up where both contributions are identical .    for non - equilibrium problems , it is useful introduce two distinct baths , with each having their own corresponding hybridization function  @xcite .",
    "the first bath , with hybridization @xmath165 , includes those sites that are coupled to the impurity at @xmath37 . often this first bath vanishes as @xmath166 . the second bath , @xmath167 , builds up as time evolves , i.e. , couples additional bath sites to the impurity for times @xmath168 .",
    "we will consider a system with no initial correlations ( @xmath169 ) in the next section , and focus only on the second bath , with weiss function @xmath170 since all imaginary - time components , which account for initial correlations , vanish for @xmath167 , we set @xmath171 for all bath sites that are included in @xmath167 .",
    "the time - dependence of the bath energies @xmath172 can be absorbed in the time dependence of the hoppings @xmath173 , meaning that we are free to choose the evolution  @xcite @xmath174 where @xmath175 is a constant . moreover , since @xmath176 is incorporated only in the fermi functions @xmath177 $ ] for @xmath178 , we can simply choose @xmath176 such that @xmath179 is equal to 0 or 1 .",
    "this is done in order to find a representation of the weiss functions as @xmath180 @xmath181 in which @xmath182 and @xmath183 denote the sets of initially occupied and empty bath sites , respectively .",
    "note that for a particle - hole symmetric system , @xmath184 , which is satisfied if the occupied and empty bath sites come in pairs with complex conjugate hybridizations .",
    "moreover , for a discretized time @xmath185 $ ] , we have , e.g. , @xmath186 which has the form of a cholesky decomposition @xmath187 where @xmath188 is a lower triangular matrix , the @xmath28th column of which gives the time - dependent hybridization to the bath orbital @xmath28 .",
    "the use of cholesky decomposition to the determine the hybridizations from the weiss function allows us to adopt a time - propagation scheme in which we do not update the whole green and weiss function matrices as time evolves but only the current time slice . in practice , since we only have a limited number of bath sites @xmath189 , we employ an approximate representation of the weiss function in which we obtain the evolution of the first @xmath189 time - steps from the cholesky decomposition , and for time steps greater than @xmath189 we update a new column and row in the weiss function matrix in a manner which minimizes the error in the approximate representation  @xcite . in the next section we present a test system and use the results of this section to determine the weiss field self - consistently for the hubbard model in an infinite - dimensional bethe lattice .",
    "we consider the time evolution of the infinite - dimensional hubbard model with constant on - site interaction @xmath40 and time - dependent hopping @xmath4  @xcite .",
    "the hopping is turned on from the initial value @xmath190 ( i.e. , the atomic limit ) to the final value @xmath191 , which we use as the unit of energy , with the profile @xmath192 &   \\mathrm{for } \\ ; t   < t_q \\\\        1 & \\mathrm{for } \\ ; t \\geq t_q      \\end{cases},\\end{aligned}\\ ] ] where @xmath193 and @xmath194 is a suitable quench time . in our simulations we use @xmath195 .",
    "we assume a zero temperature initial state in the paramagnetic phase in the half - filled bethe lattice .",
    "we then map the hubbard model onto a siam .",
    "since @xmath41 , @xmath165 vanishes and the hybridization function is given by @xmath196 .",
    "since we have a spin- and a particle - hole symmetric system , the bath is represented with pairs of initially occupied and empty sites .",
    "we take the total number of bath sites to be @xmath197 , where @xmath189 is the rank of the approximate representations of @xmath198 and @xmath199 .",
    "the initial ground state of the siam has an equal number of empty and doubly occupied bath sites with energies @xmath200 , and singly - occupied impurity which is spin - mixed with density matrix @xmath201 . to account for occupation of the impurity site ,",
    "we consider two subsystems @xmath202 and @xmath149 , in which the impurity of the system @xmath202 ( @xmath149 ) is initially occupied by a single @xmath45-electron ( @xmath46-electron ) .",
    "we then compute two impurity green functions @xmath203 and @xmath204 the average of which yields the local lattice green function @xmath205,\\end{aligned}\\ ] ] after self - consistency has been reached .",
    "since we are considering the hubbard model in the bethe lattice , the dmft self - consistency condition is given by eq .  .",
    "the non - equilibrium dmft steps to compute the single - particle lattice green function for a maximum simulation time @xmath206 are then the following :    * choose an initial green function @xmath207 . for iteration @xmath208 , initialize the hybridization function as @xmath209 , where @xmath145 is the hopping in the hubbard hamiltonian .",
    "* use the cholesky decomposition for @xmath210 to obtain the hopping parameters @xmath211 for the @xmath212th iteration .",
    "* use exact diagonalization techniques to compute the impurity green functions @xmath213 for @xmath214 and @xmath215 , where @xmath216 here , @xmath217 is the initial ( pure ) state for system @xmath218 , and @xmath219 is the ( usual ) time - ordering operator .",
    "use eq .   to obtain the local lattice green function @xmath220 .",
    "* use the dmft self - consistency condition for the bethe lattice @xmath221 to obtain the hybridization function for the next iteration . *",
    "go to step 1 and iterate the steps until convergence is reached .",
    "the convergence variable can be , e.g. , @xmath222 .    from the lattice",
    "green function we can obtain single - particle observables .",
    "in addition to the green function , in the time - evolution we can calculate the time - dependent double occupation @xmath223 which is also averaged over the systems @xmath202 and @xmath149 .",
    "the aim of the main article is to show how such dmft steps as described above could be performed on a trapped - ion quantum computer in conjunction with a classical feedback loop . to this end",
    ", we must represent the siam hamiltonian   with @xmath224 and @xmath200 in terms of spin operators that operate on the qubits .",
    "this is achieved via the jordan  wigner transformation , in which we map a string of @xmath25 fermions onto a string of @xmath86 qubits .",
    "the relation between the fermionic creation and annihilation operators and the spin operators reads @xmath225 where @xmath82 , and @xmath83 , @xmath84 , and @xmath85 are the pauli spin operators .",
    "we apply the transformations - to the siam hamiltonian .",
    "the interaction term becomes @xmath226 while the hybridization terms read    @xmath227    @xmath228    in order to implement the time - evolution operator in an experiment , we use the trotter decomposition @xmath229 in which each of the terms on the right hand side can be implemented with the help of mlmer  srensen gates and local and global rotations , as described in the next section .",
    "each exponent that consists of tensor products of @xmath230 pauli operators can be implemented ( up to local rotations ) with a mlmer ",
    "srensen gate acting on the @xmath230 qubits , one local gate acting on a single qubit , and the inverse mlmer ",
    "srensen gate  @xcite .",
    "for example , we have the decomposition @xmath231 where the mlmer  srensen gate is given by @xmath232,\\end{aligned}\\ ] ] with @xmath102 . the local gate in eq .",
    "reads @xmath233 to implement a string of @xmath84 gates instead of @xmath83 , we use a different mlmer  srensen gate , yielding the decomposition @xmath234 with the local gate @xmath235 any of the gates from eqs .   and   can be obtained from eqs .   and   by applying additional local rotations .",
    "for instance ,    @xmath236    where @xmath237 for even @xmath28 , and @xmath238 for odd @xmath28 , with @xmath239 .",
    "similarly , e.g. , @xmath240 where @xmath241 for even @xmath28 , and @xmath242 for odd @xmath28 , with @xmath243 .",
    "an essential part of the scheme is the determination of the local non - equilibrium green function . in this section ,",
    "we propose an experimental scheme to measure it with trapped ions .",
    "we again apply the jordan  wigner transformations on the @xmath244-operators and obtain the following expressions for the different components of the green function    @xmath245    @xmath246    @xmath247    @xmath248    in eqs .  - , all time - evolution operators @xmath249 , etc , correspond to a sequence of quantum gates obtained in the previous section .    to measure each of the summands in eqs .  - ,",
    "we introduce a probe qubit  @xcite which we couple to the system of interest .",
    "we assume that the probe qubit is prepared in the pure state @xmath108 , yielding the total density operator @xmath109 .",
    "the combined system is then run through a ramsey interferometer sequence described by a quantum circuit in which we first apply a hadamard gate @xmath111 ( @xmath110 pulse ) on the probe qubit , followed by unitary evolution of the system of interest , followed by a controlled application of pauli gates , evolution up to the final time , another controlled application of pauli gates , and ending with another hadamard gate on the probe qubit ( see fig .  2 of the main text ) .",
    "the output state of the qubit at the end of the ramsey sequence is given by @xmath114\\nonumber \\\\ = & \\frac{1+\\mathrm{re}[f(t , t')]}{2}|0\\rangle \\langle 0 | - i\\frac { \\mathrm{im}[f(t , t')]}{2}|0 \\rangle \\langle 1 | \\nonumber \\\\ & + i\\frac { \\mathrm{im}[f(t , t')]}{2}|1 \\rangle \\langle 0",
    "| + \\frac{1-\\mathrm{re}[f(t , t')]}{2}|1 \\rangle \\langle 1 |,\\end{aligned}\\ ] ] where @xmath115 $ ] corresponds to one of the summands in eqs .  - . here ,",
    "the unitary operators @xmath116 and @xmath117 , in which @xmath118 and @xmath119 are pauli operators or tensor products of pauli operators according to eqs .  - , act only on the system and not on the probe qubit .",
    "for example , the network in fig .",
    "2 of the main text corresponds to the case @xmath250 and @xmath251 . note that @xmath252\\hat{\\sigma}_z + \\mathrm{im}[f(t , t ' ) ] \\hat{\\sigma}_y \\right),\\end{aligned}\\ ] ] where @xmath253 is the identity operator , so that we have @xmath254=\\mathrm{re}[f(t , t')],\\end{aligned}\\ ] ] and @xmath255=\\mathrm{im}[f(t , t')],\\end{aligned}\\ ] ] which are then experimentally measurable quantities .    to give a rough estimate on the number of measurements required in an experiment",
    ", we consider the probe to be in the superposition @xmath256 which is the state with maximal uncertainty in the measurement outcome .",
    "thus , the measurement of the @xmath257 component yields either -1 or + 1 with probability @xmath258 .",
    "this random variable then follows a two - point distribution with parameters @xmath259 , @xmath260 , and variance @xmath261 .",
    "the mean of the @xmath257 component in this state is zero . to obtain this mean with a standard error of the mean",
    "@xmath262 requires @xmath263 projective measurements for each contribution to the green function .",
    "for example for @xmath264 we would need about @xmath265 [ 2 systems ( @xmath202 and @xmath149 ) , 2 spins , lesser and greater green function , 4 terms per green function , 2 expectation values to be measured , and 2500 measurements for each expectation value ] measurements per time step , and this number scales quadratically with the number of points in the time grid .",
    "however , if we consider a spin - symmetric system as above , where we have the symmetries @xmath266 , we only need to measure half of the green functions above .",
    "note that all measurements can be done in parallel .",
    "we perform classical simulations of the single - qubit interferometer described in the previous section . in the actual hybrid device",
    ", the single - qubit interferometry would be done experimentally , and here we try to mimic the experimental procedure .",
    "we consider the first @xmath189 time steps , where @xmath189 is the half the number of bath sites .",
    "we first obtain some initial guess hybridization parameters @xmath267 , where @xmath268 . using @xmath267",
    "we construct _ imperfect _ quantum gates @xmath269 and @xmath270 , where @xmath271 , @xmath272 , and @xmath273 are normally distributed random variables with zero mean and standard deviations @xmath106 , @xmath274 , and @xmath275 , respectively .",
    "these quantum gates yield the trotterized unitary evolution operator @xmath34 , where @xmath276 .",
    "we use this evolution operator to compute the @xmath277-point ( @xmath278 ) of @xmath107 from @xmath121 $ ] and @xmath122 $ ] as explained in the previous section , and we average the results over several realizations to gather error statistics . after going through all the possible combinations of the controlled @xmath279 ( @xmath280 ) and @xmath281 ( @xmath282 ) gates according to eqs .  - ,",
    "we obtain @xmath283 .    however , we interpret the computation of the point @xmath277 as a measurement which collapses the state of the system , and we can not store any information of the state at this time instant in memory , since we do nt want to re - use any of the obtained wave functions later to avoid correlating the errors between different points in the green function .",
    "we compute these points from independent realizations instead . this way we make our classical simulations to follow what one would do in an experiment .",
    "this means that in order to compute another point @xmath284 or @xmath285 , we have to propagate again from the origin @xmath286 to the desired point and again average over several realizations .",
    "this procedure is repeated until we have obtained all the points of @xmath287 until @xmath288 .",
    "this concludes the ` experimental ' , or quantum , part of the first @xmath189 time steps in the _ first _ iteration of the dmft self - consistency loop .",
    "the obtained @xmath287 is then used in the classical computer to produce the hybridization function @xmath289 . in the first @xmath189 time steps",
    ", we have enough parameters to do a cholesky decomposition of @xmath15 to obtain new hybridizations @xmath290 , which are used for updating @xmath269 and @xmath270 .",
    "this begins the _ second _ iteration of the dmft self - consistency loop where use the updated quantum gates to again ` measure ' @xmath287 using the steps described above , always starting from the origin to compute one point in the time grid and averaging over several realizations .",
    "this non - linear process of ` measuring ' @xmath287 and using cholesky decomposition of @xmath13 to update @xmath27 is repeated until @xmath291 where @xmath292 is a predetermined error threshold .",
    "for the time steps @xmath293 with @xmath294 , we adopt the ` time slicing ' scheme of ref .",
    "@xcite , where we iterate one time step @xmath295 to self - consistency before moving to @xmath296 . in the classical part of the hybrid device , we utilize a simple minimizer step  @xcite to update only @xmath297 while keeping the previously obtained @xmath298 ( @xmath299 ) fixed .",
    "however , again when we want to reach the @xmath300th time step in the time grid , we have to start propagating from the origin .",
    "mimicking the experiment to this level makes our classical simulation very difficult .",
    "thus , our simulations are limited to small system sizes and relatively short time scales .",
    "the non - interacting impurity system comprises of siam hamiltonian   with @xmath301 .",
    "we take each bath site as being independently coupled to a thermal reservoir to which it can incoherently exchange electrons with .",
    "this is described within the quantum master equation approach where the density operator @xmath302 of the full system obeys @xmath303 \\\\ & + \\sum_{p>0,\\sigma}\\gamma^-_p[2\\hat{c}_{p\\sigma}\\hat{\\rho}(t)\\hat{c}^\\dagger_{p\\sigma } - \\hat{\\rho}(t)\\hat{c}^\\dagger_{p\\sigma}\\hat{c}_{p\\sigma } -   \\hat{c}^\\dagger_{p\\sigma}\\hat{c}_{p\\sigma}\\hat{\\rho}(t ) ] \\\\ & + \\sum_{p>0,\\sigma}\\gamma^+_p[2\\hat{c}^\\dagger_{p\\sigma}\\hat{\\rho}(t)\\hat{c}_{p\\sigma } -   \\hat{\\rho}(t)\\hat{c}_{p\\sigma}\\hat{c}^\\dagger_{p\\sigma } -   \\hat{c}_{p\\sigma}\\hat{c}^\\dagger_{p\\sigma}\\hat{\\rho}(t)],\\end{aligned}\\ ] ] where @xmath304 are the rates of electron ejection ( @xmath305 ) and injection ( @xmath306 ) to bath site @xmath28 . in the case of no impurity coupling @xmath307",
    "the noise on each bath site will drive their occupancies to a steady - state value of @xmath308 .",
    "since this model is non - interacting and has lindblad noise terms which are linear in the electron creation and annihilation operators the master equation can be solved exactly using the so - called super - fermion formalism @xcite . here",
    "we use this approach to compute the impurity single - particle green functions @xmath309 , \\\\ g^<_\\sigma(t , t ' ) & = & -i{\\rm tr}[\\hat{\\rho}_0\\hat{c}_{1\\sigma}(t)\\hat{c}^\\dagger_{1\\sigma}(t')],\\end{aligned}\\ ] ] for this system given an initial density operator @xmath310 .",
    "we focused on a quench of the hubbard hopping parameter @xmath4 given by eq .  .",
    "the initial density operator @xmath310 was again chosen to model a @xmath311 half - filled paramagnetic phase @xcite , where @xmath312 , with the impurity being in a singly occupied spin - mixed state @xmath313 , along with half the bath sites were doubly occupied @xmath314 , and the other half empty @xmath315 . the dissipation in the bath was taken to have @xmath316 so that the steady - state density of the system remains a constant unit - filling .",
    "we take the bath energies to @xmath317 throughout .    using the calculated @xmath318",
    "the non - equilibrium dmft self - consistency loop was solved using ( i ) the standard cholesky time - slicing proposed for a noiseless system @xcite , explained after eq .  , and ( ii ) using a fitting procedure which attempts to correct for the effects of the bath noise .",
    "we solve numerically for the bath green functions @xmath72 using the super - fermion approach  @xcite . to implement a noise - reduction scheme ,",
    "we minimize @xmath319 ( @xmath320 is the frobenius norm ) over the @xmath27 to obtain the hybridizations corresponding to a noisy system .",
    "it is often useful to include a multiplying function of the form @xmath321 in the cost function to aid the convergence of the minimiser ."
  ],
  "abstract_text": [
    "<S> we propose a non - linear , hybrid quantum - classical scheme for simulating non - equilibrium dynamics of strongly correlated fermions described by the hubbard model in a bethe lattice in the thermodynamic limit . </S>",
    "<S> our scheme implements non - equilibrium dynamical mean field theory ( dmft ) and uses a digital quantum simulator to solve a quantum impurity problem whose parameters are iterated to self - consistency via a classically computed feedback loop where quantum gate errors can be partly accounted for . </S>",
    "<S> we analyse the performance of the scheme in an example case .    next generation scalable quantum devices@xcite promise a step change in our ability to do computations . </S>",
    "<S> direct quantum simulation@xcite using highly controllable quantum systems  @xcite has already led to numerous insights into many - body quantum physics , despite limitations in the size of the simulated system .    </S>",
    "<S> recently , quantum computer simulations of strongly correlated fermion models have been proposed  @xcite . </S>",
    "<S> we suggest a hybrid quantum - classical scheme to simulate non - equilibrium dynamics of the hubbard model in a bethe lattice directly in the thermodynamic limit . </S>",
    "<S> our scheme implements the non - equilibrium extension of the well - established dynamical mean - field theory ( dmft ) method ( for extensive reviews of dmft , see , e.g. , refs .  </S>",
    "<S> @xcite ) . instead of the traditional all - classical method , </S>",
    "<S> the proposed scheme uses a digital quantum simulator to efficiently solve the dmft impurity problem , the parameters of which are iterated to self - consistency via a classically computed feedback loop . </S>",
    "<S> this setup promises an exponential speed - up over the best currently - known hamiltonian - based classical algorithms . </S>",
    "<S> we show how quantum gate errors can be partly accounted for in the feedback loop , improving simulation results . </S>",
    "<S> the scheme also avoids the sign problem in classical quantum monte carlo methods and works for all interaction strengths , unlike classical methods based on perturbation theory . </S>",
    "<S> presently , non - equilibrium dmft is one of the most promising methods to study time - dependent phenomena in high - dimensional correlated lattice models , and could thus be of interest for current efforts to develop scalable quantum technologies@xcite . </S>",
    "<S> examples of applications of non - equilibrium dmft include the dielectric breakdown of mott insulators  @xcite , damping of bloch oscillations  @xcite , and thermalization after parameter quenches  @xcite .    further to this , driven strongly correlated quantum materials are now being extensively investigated experimentally . </S>",
    "<S> a large motivation for this is the possibility of manipulating correlated phases of matter with strong pulses of light , such as photodoping of mott insulators  @xcite or inducing superconductivity  @xcite . </S>",
    "<S> the underlying physical mechanisms are , however , still poorly understood . </S>",
    "<S> even the dynamical behaviour of conceptually simple and commonly used quantum lattice models is yet not fully grasped . </S>",
    "<S> solving these model systems could elucidate physical phenomena underlying currently unexplained experimental results . </S>",
    "<S> a standard example of this kind of idealised model for non - equilibrium problems is the time - dependent hubbard hamiltonian @xmath0 in this model , electrons with spin projections @xmath1 move only between adjacent lattice sites @xmath2 and @xmath3 with time - dependent ` hopping ' energy @xmath4 , where @xmath5 denotes time . </S>",
    "<S> this process is described in the first sum , which is over all nearest - neighbour sites , with fermionic creation and annihilation operators @xmath6 and @xmath7 , respectively . </S>",
    "<S> the electrons interact with coulomb repulsion @xmath8 only if they occupy the same lattice site @xmath2 , given in the latter term by the product of the number operators @xmath9 and @xmath10 .    </S>",
    "<S> this and similar models are extremely challenging to study numerically due to the exponential growth of the hilbert space with system size . </S>",
    "<S> one thus often resorts to mean field approximations which typically consider only a single lattice site and replace interactions with its neighbourhood by a mean field @xmath11 . </S>",
    "<S> this turns a linear quantum problem in an exponentially large hilbert space into a much smaller but non - linear problem where @xmath11 needs to be determined self - consistently . </S>",
    "<S> such mean field approximations become increasingly accurate with the number of nearest neighbours . </S>",
    "<S> a classic example of this approach is the weiss theory of ferromagnetism @xcite . for mean field theory to be applicable to strongly correlated fermi systems in thermal equilibrium </S>",
    "<S> , the mean field @xmath12 has to be dynamical to account for correlations between interactions with the environment that are separated by @xmath5 in time , as schematically shown in figs .  </S>",
    "<S> [ fig : dmft]a , b .    </S>",
    "<S> this highly successful approach is called dmft  @xcite . </S>",
    "<S> dmft can be extended to non - equilibrium systems  @xcite by letting @xmath13 , which is often called hybridization function , depend on two interaction times @xmath5 and @xmath14 explicitly . </S>",
    "<S> note that non - local spatial fluctuations can be included in dmft by going beyond the single - site approximation and considering a cluster of isolated sites  @xcite , but this is beyond the scope of this work .    </S>",
    "<S> in general , it is a complex task to determine @xmath15 and the related local single - particle green s function @xmath16 ( where @xmath17 is the time - ordering operator ) , describing the response of the many - body system after a localized removal and addition of a particle at times @xmath5 and @xmath14 . </S>",
    "<S> commonly used numerical methods for solving the non - equilibrium dmft problem include continuous - time quantum monte carlo , which suffers from a severe dynamical sign problem , and perturbation theory which can only address the weak and strong coupling regimes  @xcite .    in infinite dimensions , </S>",
    "<S> the system can also be explicitly mapped onto a single impurity anderson model ( siam )  @xcite @xmath18 @xmath19 @xmath20 @xmath21\\hat{c}_{p\\sigma}^{\\dagger}\\hat{c}_{p\\sigma}.\\end{aligned}\\ ] ] where the selected lattice site is represented by an impurity , with the creation ( annihilation ) operator @xmath22 ( @xmath23 ) and number operator @xmath24 , whose interaction with @xmath15 is mimicked by a collection of @xmath25 non - interacting bath sites with on - site energies @xmath26 , as shown in fig .  </S>",
    "<S> [ fig : dmft]c . </S>",
    "<S> the time - dependent hybridization energy @xmath27 describes the amplitude for exchange of fermions between the impurity site and bath site @xmath28 . </S>",
    "<S> these must be determined self - consistently : for given @xmath27 the quantum dynamics of the siam is solved and its green s function and corresponding hybridization function @xmath15 are determined . from @xmath15 a new set of @xmath27 </S>",
    "<S> is worked out which is then fed back into the siam . </S>",
    "<S> these steps are repeated until convergence is achieved @xcite . </S>",
    "<S> the dynamics of the siam is usually worked out with exact diagonalization ( ed )  @xcite for small systems or with tensor network theory ( tnt ) methods@xcite . </S>",
    "<S> however , the dynamical generation of entanglement in these problems has severely hampered the efficiency of tnt methods @xcite . </S>",
    "<S> furthermore , the required number of bath sites increases with the maximum simulation time @xmath29 . </S>",
    "<S> this makes solving the siam the exponentially difficult bottleneck  @xcite in purely classical dmft solvers .    here , </S>",
    "<S> we propose and analyze a hybrid quantum - classical computing scheme for dmft to efficiently solve the hubbard model in a bethe lattice . </S>",
    "<S> the bethe lattice is chosen for the simplicity of its self - consistency condition . </S>",
    "<S> it is conceptually straightforward to extend the scheme to other types of lattices . </S>",
    "<S> a small digital quantum coprocessor solves the siam evolution with the resulting @xmath30 being processed by a classical computer to complete the non - linear feedback loop as shown in fig .  </S>",
    "<S> [ fig : dmft]d . </S>",
    "<S> we consider a trapped ion coprocessor for concreteness , although any other platform for quantum computing could implement the coprocessor as well . even for imperfectly implemented quantum gates with realistic errors of @xmath31 we find accurate solutions to a simple model problem in small systems . </S>",
    "<S> in addition , our numerical evidence suggests that gate errors mainly lead to a smearing of the bath energies , which can be accounted for in the classical feedback loop to improve the solution .    </S>",
    "<S> figure  [ fig : co ] shows an example coprocessor quantum network for computing a contribution to the green s function ( see methods for details ) . </S>",
    "<S> the real and imaginary contributions to the impurity green s function are encoded as @xmath32 and @xmath33 of a probe qubit by interacting it with the impurity state at times @xmath14 and @xmath5 via controlled quantum gates@xcite . </S>",
    "<S> we decompose the unitary dynamics @xmath34 of the siam into a network of quantum gates @xcite by discretising time as @xmath35 , where @xmath36 is a small time - step . </S>",
    "<S> we then breakup the evolution from @xmath37 to @xmath38 into a product of trotter steps @xmath39 . </S>",
    "<S> the trotter steps can readily be implemented by single qubit rotations and multi - qubit entangling mlmer  </S>",
    "<S> srensen ( ms ) gates  @xcite that have recently been realized in ion traps with high fidelity  @xcite . </S>",
    "<S> the total number of ms gates per trotter step scales only linearly with the number of bath sites .    </S>",
    "<S> we analyze the performance of our simulation scheme by considering a simple example system  @xcite . </S>",
    "<S> we study the infinite - dimensional time - dependent hubbard model   with constant onsite interaction @xmath40 and tunneling matrix element @xmath4 . </S>",
    "<S> the simulation starts in the half - filled paramagnetic atomic limit with tunneling @xmath41 , which is then dynamically ramped up to its final value @xmath42 after quench time @xmath43 and is kept at @xmath42 until the final simulation time @xmath29 is reached@xcite ( setting @xmath44 ) . </S>",
    "<S> such a sudden quench is representative of experimental ultracold atom dynamics  @xcite and also ultrafast dynamics probed in condensed matter systems  @xcite . </S>",
    "<S> the initial state of the system has a singly occupied impurity site in the completely mixed state of spin @xmath45 and spin @xmath46 , and one half of the bath sites are doubly occupied and the other half empty ( for explicit details , see  ref.@xcite ) . in practice , we prepare the system in two pure fermion occupational number states , where one has the impurity in state @xmath47 and the other in state @xmath48 , along with the bath states  @xcite . </S>",
    "<S> the results are then averaged over these two pure states . </S>",
    "<S> these initial number states are mapped onto product states of qubits via the jordan  wigner transformation ( see methods ) . </S>",
    "<S> the initial qubit configuration is that shown in fig .  </S>",
    "<S> [ fig : co ] , where @xmath49 . </S>",
    "<S> we emulate the operation of the quantum coprocessor by classically evaluating the quantum networks , and the classical exponential scaling limits our simulations to small systems . </S>",
    "<S> the self - consistency condition for the bethe lattice calculated in the classical feedback loop is @xmath50 , from which we obtain the siam coupling to bath @xmath28 efficiently via a cholesky decomposition @xmath51 , where @xmath52 denotes complex conjugation ( see supplementary material for details ) . </S>",
    "<S> the impurity site double occupancy @xmath53 obtained from the self - consistent hybrid simulation is compared to the exact result in fig .  </S>",
    "<S> [ fig : res1]a and shows that trotter errors do not noticeably affect our results .    </S>",
    "<S> next we assume imperfect gates characterized by phase errors that are described by normally distributed random variables with zero mean  @xcite . </S>",
    "<S> we choose their standard deviations consistent with current experimental capabilities@xcite setting the single qubit error to @xmath54 and allowing ms gate errors @xmath55 to vary between @xmath56 and @xmath57 . </S>",
    "<S> we obtain accurate results for the dynamics of the double occupancy even in the presence of gate errors . as shown in fig .  </S>",
    "<S> [ fig : res1]a the double occupation differs from the exact result by only @xmath58 for @xmath59 . for a smaller gate error of @xmath60 </S>",
    "<S> the difference is insignificant up to @xmath61 . in fig .  [ </S>",
    "<S> fig : res1]b we plot the error in the imaginary part of the lesser green s function @xmath62 induced by imperfect gates . </S>",
    "<S> the diagonal values @xmath63 , which determine time - local single - particle observables , are almost unaffected even for large ms gate errors . gate errors in general make the green s function decay faster with @xmath64 than in the ideal case and will thus affect unequal time correlation functions .    </S>",
    "<S> we further investigate the effect of imperfect gates by considering the impurity site coupled to two bath sites via constant @xmath27 . </S>",
    "<S> we find that the imaginary part of the mean field differs from the exact solution by a factor of approximately @xmath65 as shown in fig .  </S>",
    "<S> [ fig : res2]a . </S>",
    "<S> the decay rate @xmath66 increases with @xmath55 as displayed in the inset of fig .  </S>",
    "<S> [ fig : res2]a . </S>",
    "<S> this numerical evidence suggests that gate errors have the same effect as smearing out the bath energies @xmath26 to a similar width @xmath66 . </S>",
    "<S> the impurity model including errors would then be equivalent to the bath sites possessing a finite coherence time @xmath67 . since the number of gates is @xmath68 we expect @xmath66 to only depend weakly on @xmath25 .    </S>",
    "<S> a bath site with coherence time @xmath67 can be modelled by allowing an ideal bath to incoherently exchange particles with a reservoir at an ` error ' rate @xmath69 . </S>",
    "<S> this exchange of particles modifies the bath s green s function from its ideal value of @xmath70 and correspondingly modifies the relation between impurity bath couplings and mean field to  @xcite @xmath71 . </S>",
    "<S> this relation does not necessarily allow for an exact solution for @xmath27 even for large @xmath25 . </S>",
    "<S> the effect of noise therefore limits the mean fields @xmath15 that the bath sites can model .    </S>",
    "<S> we investigate if the noise induced by gate errors can be partly compensated by implementing self - consistency via this modified relation . </S>",
    "<S> for the non - interacting impurity with bath sites coupled to a particle reservoir we solve numerically for the bath green s functions @xmath72 , exploiting the super - fermion formalism  @xcite ( see supplementary material ) . </S>",
    "<S> we minimize @xmath73 using the frobenius norm over the @xmath27 to obtain the hybridizations in the noisy system . </S>",
    "<S> this modification of the _ classical _ feedback loop significantly reduces the effect of gate errors as demonstrated in fig .  [ </S>",
    "<S> fig : res2]b , showing the reduction in average absolute error in the mean field @xmath15 . in the hybrid simulation scheme a slight modification of the quantum network shown in fig .  </S>",
    "<S> [ fig : co ] allows the probe qubit to measure the bath green s functions , thus providing the information required for this noise - reduction scheme to be implemented .    </S>",
    "<S> finally , we emphasize that our scheme works directly in the thermodynamic limit and , since it does not require a small expansion term , gives accurate results for all values of @xmath40 , in particular for the challenging situation of intermediate interactions like the example @xmath74 considered here . </S>",
    "<S> the number of available qubits only limits the number of bath sites that can be included in the simulation and hence the maximally reachable simulation time @xmath29 . </S>",
    "<S> purely classical simulations are currently limited to approximately @xmath75 bath sites@xcite and , because of fast growing siam entanglement@xcite , scale exponentially with @xmath29 despite efficiently implementing the feedback loop . </S>",
    "<S> therefore , a quantum coprocessor with only about @xmath76 qubits@xcite coupled to a classical feedback loop would be able to improve upon current purely classical algorithms . </S>",
    "<S> our hybrid simulation scheme thus provides an interesting scientific application of next generation , possibly imperfect , quantum devices .    </S>",
    "<S> the authors would like to thank simon benjamin as well as ian walmsey and his group members for useful discussions . </S>",
    "<S> the research leading to these results has received funding from the epsrc national quantum technology hub in networked quantum information processing ( nqit ) . </S>",
    "<S> j.m.k .  acknowledges financial support from christ church , oxford and the osk .  </S>",
    "<S> huttunen foundation . d.j .  acknowledges financial support from the european research council under the european union s seventh framework programme ( fp7/2007 - 2013)/erc grant agreement no .  </S>",
    "<S> 319286 q - mac and the eu collaborative project quprocs ( grant agreement 641277 ) . </S>",
    "<S> the data presented in this work is contained in the source files of the arxiv submission arxiv:1510.05703 .    </S>",
    "<S> while preparing this manuscript , we became aware of related work by b.  bauer et al  @xcite .    </S>",
    "<S> the authors declare no competing financial interests .    </S>",
    "<S> author contributions : j.m.k . and s.r.c </S>",
    "<S> . carried out the numerical calculations . </S>",
    "<S> j.m.k . decomposed the siam into quantum networks and carried out the analytical calculations . </S>",
    "<S> d.j . </S>",
    "<S> , s.r.c . and j.m.k . </S>",
    "<S> wrote the manuscript . </S>",
    "<S> d.j . conceived and coordinated the project . </S>"
  ]
}