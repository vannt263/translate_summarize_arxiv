{
  "article_text": [
    "the major atmospheric gamma ray imaging cherenkov ( magic ) telescope @xcite uses the iact technique  @xcite to study the very high energy ( vhe , @xmath1  gev ) @xmath0-ray emission from astrophysical sources , at the lowest possible energy threshold .",
    "the technique uses cherenkov radiation : a vhe @xmath0-ray entering the earth s atmosphere initiates a shower ( cascade ) of electrons and positrons , with a particle density maximum about 10  km above sea level ( for an energy of 1  tev ) .",
    "the particles in the cascade produce cherenkov light in a cone of about @xmath2 half - angle , which illuminates an area of around 120  m radius on the ground .",
    "if the magic telescope is located in this area , part of the cherenkov light will be collected by the telescope mirrors and a shower image will be projected onto the photomultiplier tube ( pmt ) camera .",
    "the cherenkov photons arrive within a very short time interval of a few nanoseconds at the telescope camera , whose pixels are fast light sensors such as pmts , so that one can trigger on the coincident light signals .",
    "the fluctuations of the light of the night sky ( lons ) cause background noise .",
    "this effect is minimized by using low exposure times ( signal integration times ) , typically of the order of ten nanoseconds .    to reach the highest sensitivity and the lowest energy threshold , the recorded signals have to be accurately reconstructed .",
    "two quantities are of interest : the total signal charge and the signal arrival time .",
    "the signal charge ( the total number of photo - electrons released from the photocathode of the pmt ) is proportional to the total area below the pulse .",
    "the sum of the signal charges of all camera pixels is a measure of the shower energy .",
    "the signal arrival time is given by the time difference between the first recorded fadc sample and a characteristic position on the pulse shape , like the maximum , the half - maximum on the rising edge or the center of gravity of the pulse .",
    "the timing information may be used to discriminate between pixels whose signals belong to the shower , and pixels which are affected by randomly timed background noise .",
    "the pixels with a low signal - to - noise ratio are rejected for the subsequent image parameterization @xcite .",
    "the main background to @xmath0-rays originates from the much more frequent showers induced by isotropic hadronic cosmic rays .",
    "monte carlo ( mc ) based simulations predict different time structures for @xmath0-ray and hadron induced shower images as well as for images of single muons @xcite .",
    "this has two consequences : on the one hand the arrival time structures across the observed cherenkov shower image , from pixel to pixel , depend on the type of the primary particle . on the other hand , also the recorded cherenkov pulse shape inside an individual pixel",
    "depends on the primary particle . to exploit the pulse shape differences ,",
    "an ultra - fast digitization of the cherenkov pulses is necessary , as is provided by the most recent upgrade of the data acquisition of the magic telescope to a 2  gsamples / s fadc system @xcite .",
    "this paper , however , deals with the signal reconstruction of the data taken with the initial 300  msamples / s fadc system .",
    "because of its limited sampling speed , we do not try to exploit the differences in pulse shape here .",
    "this paper is structured as follows : in section  [ sec : signal_read_out ] the read - out system of the magic telescope is described , and in section  [ sec : reco ] the average pulse shapes of calibration and cosmic pulses are reconstructed , from data taken with the fadc system .",
    "these pulse shapes are compared to those implemented in the mc simulation program . in section",
    "[ sec : criteria ] criteria for an optimal signal reconstruction are developed . in section  [ sec : algorithms ] the signal reconstruction algorithms and their implementation in the magic software framework ( _ * mars * _",
    "@xcite ) are described .",
    "the performance of the signal extraction algorithms under study is assessed by applying them to pedestal , calibration and mc events ( sections  [ sec : mc ] to  [ sec : calibration ] ) .",
    "section [ sec : speed ] gives the cpu time requirements for the different signal reconstruction algorithms .",
    "finally in sections  [ sec : extraction : results ] and [ sec : outlook ] the results are summarized and an outlook is given .",
    "figure  [ fig : magic_read - out_scheme ] shows a sketch of the magic read - out system , including the pmt camera , the analog - optical link , the majority trigger logic and flash analog - to - digital converters ( fadcs ) . the response of the pmts to sub - ns input light pulses shows a full width at half maximum ( fwhm ) of 1.0 - 1.2  ns and rise and fall times of 600 and 700ps correspondingly  @xcite .",
    "a transmitter using a vertical - cavity surface - emitting laser ( vcsel ) diode modulated in amplitude , converts the electrical pulse supplied by the pmt into an optical signal .",
    "this signal is then transferred via optical fibers ( 162 m long , 50/125@xmath3 m diameter ) to the counting house  @xcite . after transforming the light back to an electrical signal",
    ", the original pmt pulse has a fwhm of about 2.2  ns for a single photo - electron pulse , and rise and fall times of about 1ns .        in order to sample this pulse shape with the 300 msamples / s fadc system ,",
    "the original pulse is electronically shaped by effectively folding it with a function of 6ns fwhm . in order to increase the dynamic range of the read - out",
    ", the signals are split into two branches , with gains differing by a factor  10 .",
    "the low - gain branch is delayed by 55ns and both branches are multiplexed and read out by one fadc .",
    "the switch from high- to low - gain occurs only if the high - gain signal exceeds a pre - set threshold , and 55ns after this happens . during the subsequent 50ns",
    "the low - gain signal is connected to the output while the high - gain signal is blocked .",
    "figure  [ fig : pulpo_shape_high ] shows the average reconstructed pulse shape ( generated by a fast pulser , see section [ sec : reco ] ) as measured by one fadc .",
    "a more detailed overview about the magic read - out and daq system can be found in @xcite .",
    "the following intrinsic characteristics of the magic read - out system are the most important to affect the signal reconstruction :    * inner and outer pixels : * the magic camera is constructed with two types of pixels , inner and outer pixels , with the following differences :    1 .",
    "size : the outer pixels have an area larger than the inner pixels by a factor four  @xcite .",
    "their area multiplied by photon detection efficiency , however , is higher only by a factor  2.6 . 2 .",
    "gain : the camera is flat - fielded in order to yield a similar reconstructed charge signal in all pixels , for the same photon illumination intensity . in order to achieve this , the gain of the inner pixels has been adjusted to about a factor 2.6 higher than the outer ones  @xcite .",
    "this results in a lower charge rms contribution from the light of the night sky ( lons ) for the outer pixels .",
    "3 .   delay : due to the lower high voltage ( hv ) settings of the outer pixels , their signals are delayed by about 1.5ns with respect to the inner ones .    * asynchronous trigger : * the fadc clock is not synchronized with the trigger",
    ". therefore the time @xmath4 between the trigger decision and the first read - out sample is uniformly distributed along the range @xmath5 $ ] , where @xmath6ns is the digitization period of the magic 300mhz fadcs .",
    "all fadcs run at the same frequency and phase .",
    "the 300 mhz clock signal is produced at a central place , multiplicated and distributed by equally long cables to the individual fadc modules .    * ac coupling : * the pmt signals are ac - coupled at various places in the signal transmission chain .",
    "thus the contribution of the pmt pulses due to the lons is on average zero . only the signal rms depends on the intensity of the lons . in moonless nights , observing an extra - galactic source , an average background rate of about 0.13 photo - electrons per nano - second per inner pixel has been measured  @xcite . *",
    "shaping : * as already mentioned above , the optical receiver board shapes the pulse with a shaping time of 6ns fwhm , i.e. much larger than the typical intrinsic pulse width . since the shaping time is larger than the width of a single fadc slice , a strong correlation of the noise between neighboring fadc slices",
    "is expected .",
    "the fact that the signal pulses are sampled asynchronously by the fadcs allows one to determine the average pulse shape with high accuracy . to do that ,",
    "the signal samples from different recorded pulses are shifted to a common reconstructed arrival time and normalized to a common area / charge .",
    "therefore , the precision of the determination of each point along the pulse shape depends on the accuracy of the arrival time and charge reconstruction .",
    "possible biases in the charge and arrival time reconstruction may introduce systematic errors , whose size are unknown at first hand .",
    "figure  [ fig : pulpo_shape_high ] shows the average signal from a fast pulser as reconstructed by the magic read - out system .",
    "the relative statistical error of the amplitude value of every reconstructed point is well below @xmath7 .",
    "the pulser generates unipolar pulses of about 2.5  ns fwhm and with a preset amplitude .",
    "these electrical pulses are fed to the vcsel transmitters , and are transmitted using the same analog - optical link as the pmt pulses , and are fed into the magic receiver board .",
    "figure  [ fig : pulse_shapes ] ( left ) shows the normalized average pulse shape for the pulse generator in the high and in the low gain , respectively .",
    "the intrinsic fwhm of the generated pulses is 2.5ns , whereas it is on average 6.3ns and 10ns for the pulses reconstructed from the high and low gain chains , respectively .",
    "the broadening of the low gain pulses with respect to that of the high gain is due to the limited bandwidth of the passive 55ns on - board delay line of the magic receiver boards",
    ".     left : average reconstructed high gain and low gain pulse shapes from a pulse generator run .",
    "the black line corresponds to the pulse shape implemented into the mc simulations @xcite .",
    "right : average reconstructed high gain pulse shape for calibration runs with green and uv light ( see section  [ sec : calibration ] ) .",
    "all pulse shapes are normalized to a common arrival time and area.,title=\"fig : \" ] left : average reconstructed high gain and low gain pulse shapes from a pulse generator run .",
    "the black line corresponds to the pulse shape implemented into the mc simulations @xcite .",
    "right : average reconstructed high gain pulse shape for calibration runs with green and uv light ( see section  [ sec : calibration ] ) .",
    "all pulse shapes are normalized to a common arrival time and area.,title=\"fig : \" ]    figure  [ fig : pulse_shapes ] ( right ) shows the normalized average reconstructed pulse shapes for green and uv calibration led pulses  @xcite ( see section [ sec : calibration ] ) as well as that of cosmic events .",
    "the shapes of the uv calibration and cosmic pulses are quite similar .",
    "both have a fwhm of about 6.3 ns .",
    "since air showers from hadronic cosmic rays trigger the telescope much more frequently than @xmath0-ray showers , the reconstructed pulse shape of the cosmic events corresponds mainly to hadron induced showers .",
    "the pulse shape from electromagnetic air showers might be slightly different as indicated by mc simulations @xcite .",
    "the pulse shape for green calibration led pulses is wider and has a pronounced tail .",
    "the difference between the shapes of the calibration led pulses is not due to the led light color but to different electronics used for the fast led drivers .",
    "the reconstructed pulse shapes for generator pulses , cosmic and calibration events permit to implement a representative pulse shape in the mc simulations , see e.g. the full black line in figure [ fig : pulse_shapes ] , left panel .",
    "the shape difference between the calibration pulses and the cosmic pulses has to be corrected for in the calibration procedure @xcite .",
    "the goal of the optimal signal reconstruction algorithm is to compute an unbiased estimate of the charge and arrival time of the cherenkov pulse with the highest possible resolution .",
    "let us consider a large number of identical signals , corresponding to a fixed number of photo - electrons @xmath8 . by applying a signal extraction algorithm ,",
    "a distribution of estimated signals @xmath9 is obtained , see also @xcite and references therein .",
    "criteria for an optimal signal reconstruction algorithm are developed according to  @xcite .",
    "the deviation between true and reconstructed value is given by : @xmath10 the distribution of @xmath11 has a mean @xmath12 ( the * bias * of the estimator ) and a variance @xmath13.the parameter @xmath12 is also called the * bias * of the estimator and _ rmse _ is the * root mean - squared error * which combines resolution and bias : @xmath14 generally , both @xmath12 and _ rmse _ depend on @xmath8 and the background fluctuations _",
    "bg_. in the case of the magic telescope , the background fluctuations are due to the electronics noise and the pmt response to the lons .",
    "the signals from the latter have the same shape as those from cherenkov pulses .",
    "therefore , those algorithms which search for the highest sum of a number of consecutive fadc slices inside a global time window ( so - called * sliding window algorithms * ) will have a bias . in case of no cherenkov signal",
    "they will typically reconstruct the largest noise pulse .",
    "nevertheless , such a sliding window algorithm usually has a much smaller variance and in many cases a smaller _ rmse _ than the * fixed window extractors * , which just sum up a fixed number of fadc slices .",
    "the reconstructed charge should be proportional to the total number of photo - electrons in the pmt .",
    "this linearity is very important for the reconstruction of the shower energy and hence for the measurement of energy spectra from astronomical sources .",
    "deviations from linearity may be caused in different ways : at very low signals , the signal will be biased towards too high values ( positive @xmath11 ) . at very high signals ,",
    "the fadc system goes into saturation , and the reconstructed signal becomes too low ( negative @xmath11 ) .",
    "also , any error in the inter - calibration between the high and low gain acquisition channels yields an effective deviation from linearity .",
    "another important feature of an extractor is its robustness , i.e. its stability in reconstructing the charge and arrival time for different types of pulses with different intrinsic shapes and background levels :    * cherenkov signals from @xmath0-rays , hadrons and muons * calibration pulses from different led color pulsers ( with different pulse shapes , see figure [ fig : pulse_shapes ] right panel ) * pulse generator pulses .    finally , the extractor has to accurately reconstruct both the high and low gain channels . due to the analog delay line",
    ", the low gain pulse is wider .",
    "the total recorded time window is relatively small , such that parts of the low gain pulse may lie outside of the recorded fadc window .",
    "we have chosen four algorithms for the study of the reconstruction of the signal charge and arrival time : fixed window , sliding window with amplitude - weighted time , cubic spline with integral or amplitude extraction , and digital filter .",
    "for the signal reconstruction algorithms adopted by other air cherenkov telescopes , see e.g. @xcite .",
    "this signal extraction algorithm simply adds the pedestal - subtracted fadc slice contents of a fixed range ( window ) of consecutive fadc slices .",
    "the window has to be chosen large enough to always cover the complete pulse , otherwise physical differences in the pulse position with respect to the fadc slice numbering would lead to integration of different parts of the pulse . for this reason , the fixed window algorithm adds up more noise than the other considered signal reconstruction algorithms . due to the ac - coupling of the read - out chain ,",
    "the reconstructed signals have no bias .    in the current implementation",
    ", the fixed window algorithm does not calculate arrival times .",
    "this signal extraction algorithm searches for the maximum integral content among all possible fadc windows of fixed size contained in a defined time range ( global window ) . the arrival time is calculated from the window with the highest integral as : @xmath15 where @xmath16 denotes the fadc slice index , starting from slice @xmath17 and running over a window of size @xmath18 .",
    "the @xmath19 are the pedestal - subtracted fadc slice contents and the @xmath20 are the corresponding times relative to the first recorded fadc slice .",
    "this signal extraction algorithm interpolates all the pedestal - subtracted fadc slice contents of the full read - out window using a cubic spline algorithm , adapted from  @xcite . in a second step , it searches for the position of the maximum of the interpolation function .",
    "thereafter , two different estimators of the pulse charge are available :    1 .",
    "* amplitude * : the value of the spline maximum is taken as reconstructed signal .",
    "* integral * : the interpolation function is integrated in a window of fixed size , with integration limits fixed with respect to the position of the spline maximum .",
    "the pulse arrival times can also be estimated in two ways :    1 .",
    "* pulse maximum * : the position of the spline maximum determines the arrival time .",
    "pulse half maximum * : the position of the half maximum at the rising edge of the pulse determines the arrival time .",
    "the goal of the digital filtering method  @xcite is to optimally reconstruct the charge and arrival time of a signal whose shape is known .",
    "thereby , the noise contributions to the amplitude and arrival time reconstruction are minimized , see also  @xcite . for the digital filtering method to work properly ,",
    "two conditions have to be satisfied :    * the normalized signal shape has to be constant .",
    "* the noise properties must be constant , i.e. the noise is stationary and independent of the signal amplitude .",
    "as the pulse shape in magic is mainly determined by the artificial shaping on the optical receiver board , the first assumption holds to a good approximation for all pulses with intrinsic signal widths much smaller than the shaping constant . also the second assumption is satisfied to a good approximation : signal and noise are independent and the measured pulse is a linear superposition of the signal and noise contributions . lons conditions",
    ".    let @xmath21 be the normalized signal shape ( e.g. from figure  [ fig : pulse_shapes ] ) , @xmath22 the signal integral ( charge ) and @xmath23 the shift between the timing of the physical and the considered / probed signals .",
    "then the time dependence of the signal is given by @xmath24 , where @xmath25 is the time - dependent noise contribution .",
    "for small time shifts @xmath23 the time dependence can be linearized .",
    "discrete measurements @xmath26 of the signal at times @xmath27 have the form @xmath28 , where @xmath29 is the time derivative of the signal shape , @xmath30 and @xmath31",
    ".    the correlation of the noise contributions at times @xmath20 and @xmath32 can be expressed by the noise autocorrelation matrix @xmath33 whose elements can be obtained from pedestal data ( see section [ sec : pedestals ] ) . the noise autocorrelation matrix is dominated by lons pulses shaped by 6ns fwhm .",
    "the absolute scale of the matrix elements depends on the lons level .",
    "the normalized matrix elements may change by about 10% due to varying lons levels in typical observation conditions .",
    "the noise auto - correlation in the low gain channel can not be determined from data .",
    "the low gain channel read - out is only activated in case the high gain signal is above a certain threshold resulting in a measurable low gain signal .",
    "it has to be retrieved from monte - carlo studies instead .    for a given pulse ,",
    "@xmath22 and @xmath34 can be estimated from the @xmath35 fadc measurements @xmath36 by minimizing the deviation between the measured and the known pulse shape , and taking into account the known noise auto - correlation , i.e. minimizing the following expression ( in matrix form ) : @xmath37 this leads to the following solution : @xmath38 @xmath39 where @xmath4 is the time difference between the trigger decision and the first read - out sample , see section [ sec : reco ] .",
    "thus @xmath22 and @xmath40 are given by a weighted sum of the discrete measurements @xmath26 with the weights for the amplitude , @xmath41 , and time shift , @xmath42 , plus @xmath43 .",
    "to reduce @xmath43 , the fit can be iterated using @xmath44 and the weights @xmath45  @xcite .",
    "figure  [ fig : extraction : weights ] shows examples of digital filter weights .",
    "the expected contributions of the noise to the error of the estimated amplitude and timing only depend on the the shape @xmath21 , and the noise auto - correlation @xmath46 .",
    "the corresponding analytic expressions can be found in  @xcite .",
    "examples of digital filter weights .",
    "top : cosmic pulses , center : uv calibration pulses and bottom : blue and green calibration pulses . on the left side ,",
    "the high gain pulse is shown , one the right side , the low gain .",
    "full lines show the normalized signal shapes @xmath21 ( multiplied by 5 for better visibility ) , dashed lines the amplitude weights @xmath47 , and dotted - dashed lines the time weights @xmath48 . for the high - gain extraction",
    "4 fadc slices are used and for the low - gain extraction 6 fadc slices.,title=\"fig : \" ]   examples of digital filter weights .",
    "top : cosmic pulses , center : uv calibration pulses and bottom : blue and green calibration pulses . on the left side ,",
    "the high gain pulse is shown , one the right side , the low gain .",
    "full lines show the normalized signal shapes @xmath21 ( multiplied by 5 for better visibility ) , dashed lines the amplitude weights @xmath47 , and dotted - dashed lines the time weights @xmath48 . for the high - gain extraction",
    "4 fadc slices are used and for the low - gain extraction 6 fadc slices.,title=\"fig : \" ]   examples of digital filter weights .",
    "top : cosmic pulses , center : uv calibration pulses and bottom : blue and green calibration pulses . on the left side ,",
    "the high gain pulse is shown , one the right side , the low gain .",
    "full lines show the normalized signal shapes @xmath21 ( multiplied by 5 for better visibility ) , dashed lines the amplitude weights @xmath47 , and dotted - dashed lines the time weights @xmath48 . for the high - gain extraction",
    "4 fadc slices are used and for the low - gain extraction 6 fadc slices.,title=\"fig : \" ]",
    "pulses of a specific number of photo - electrons can be simulated by using the monte - carlo technique to simulate signal pulses and noise ( for the magic mc simulations , see reference  @xcite ) moreover , using mc , the same pulse can be studied with and without added noise . in the subsequent studies , the monte carlo simulation was used to determine , for each of the tested extractors , the following quantities : the bias and the charge resolution as functions of the input signal charge . for the subsequent studies ,",
    "the following settings have been used :    * the lons level in the mc simulations has been set to the value determined from extra - galactic source observation conditions ( 0.13 photo - electrons per ns , see @xcite ) . *",
    "the electronics noise has been simulated without any correlations between the fadc samples as a gaussian distribution with a sigma of 1.6 fadc counts ( corresponding to about 0.2 photo - electrons ) per fadc slice , roughly at the level measured in data .",
    "note , that in the data the electronic noise introduces a correlation between the fadc samples . * the intrinsic arrival time spread of the photons was set to be 1ns ( fwhm of a gaussian ) , as expected for @xmath0-ray showers . *",
    "the conversion factor from photo - electrons to integrated charge over the whole pulse was set to 7.8 fadc counts per photo - electron . * the relative timing between the trigger and the signal pulse",
    "was uniformly distributed over 1 fadc slice . *",
    "the total dynamic range of the entire signal transmission chain was set to infinite , thus the detector has been simulated to be completely linear .",
    "the signals were simulated with noise and extracted using the different extractor algorithms . for all sliding window algorithms the extraction window",
    "was allowed to move 5 fadc slices , independently of its size . for each signal extraction algorithm the average conversion factor between the reconstructed charge in fadc counts and the input number of photo - electrons was determined separately .",
    "the signal reconstruction bias was calculated as a function of the simulated number of photo - electrons @xmath49 : @xmath50 figure  [ fig : extraction : biases ] shows the results for some tested extractors , with different initializations .",
    "as expected , the fixed window extractor does not show any bias up to statistical precision .",
    "all other extractors however , do show a bias .",
    "usually , the bias vanishes for signals above 5  photo - electrons , except for the sliding window . in this latter case",
    ", the bias only vanishes for signals above 12  photo - electrons .",
    "charge reconstruction bias as a function of the number of generated photo - electrons from mc simulations including electronic noise plus lons . above 12 photo - electrons",
    ", the bias vanishes for all signal extractors . ]      in order to obtain the precision of a given extractor , we calculated the relative _ rmse _ : @xmath51 + b^2 } \\ .\\ ] ] figure  [ fig : extraction : resolutions ] shows the relative _ rmse _ for the high gain and low gain parts separately .",
    "also the square root of the relative variance of the number of simulated photo - electrons ( @xmath52 ) is shown , which corresponds to the intrinsic fluctuations of the signal from air showers , following poissonian statistics .",
    "note , that the pmt introduces an additional excess noise @xcite , which is on average 18% of the poissonian fluctuations for the magic pmts . for all extractors",
    "the variance of the reconstructed signal is dominated by noise and only slowly increases with rising signals due to mis - reconstruction of the signal pulse itself .",
    "therefore , the relative _ rmse _ is proportional to @xmath53 . for small numbers of photo - electrons , extractors with small extraction windows or the digital filter yield the smallest values of _ rmse _ , but the difference is only important below about 5 photo - electrons . above that value ,",
    "the curves for all extractors have crossed the black line , i.e. they are more precise than the intrinsic fluctuations of the signal .",
    "this is also true for the entire low gain extraction range .",
    "the best results are obtained with the digital filter or a spline integrating 1 fadc slice .",
    "relative _ rmse _ as a function of the number of generated photo - electrons from mc simulations including fully simulated electronic noise plus lons . left : high gain , right : low gain .",
    "the black dashed line shows the square root of the relative variance of the incoming numbers of photo - electrons , note , that the pmt introduces an additional excess noise @xcite .",
    "the best results are obtained with the digital filter or a spline integrating 1 fadc slice.,title=\"fig : \" ]   relative _ rmse _ as a function of the number of generated photo - electrons from mc simulations including fully simulated electronic noise plus lons .",
    "left : high gain , right : low gain .",
    "the black dashed line shows the square root of the relative variance of the incoming numbers of photo - electrons , note , that the pmt introduces an additional excess noise @xcite .",
    "the best results are obtained with the digital filter or a spline integrating 1 fadc slice.,title=\"fig : \" ]",
    "the pedestal is the average fadc count for the signal baseline ( no input signal ) . to determine the pedestal setting off - line , dedicated",
    "pedestal runs are used , during which the magic read - out is triggered randomly .",
    "the fluctuations of the signal baseline are due to electronics noise and lons fluctuations .",
    "thus the pedestal rms is a measure for the total noise level .    by applying the signal extractor to pedestal events , the bias @xmath12 and the _ rmse _ for the case of no signal ( @xmath54 ) can be determined .",
    "table  [ tab : extraction : pedestalbias ] shows the bias , the square root of the variance @xmath55 $ ] and the root - mean - square error for randomly triggered pedestal events with closed camera and sample observations outside the galactic plane ( `` extra - galactic lons '' , @xmath56 photo - electrons / ns ) as well as within the galactic plane ( `` galactic lons '' ) . in addition , table  [ tab : extraction : pedestalbias ] shows the corresponding values from mc simulations .",
    "the @xmath55 $ ] of the mc simulations is slightly lower then in the sample observations outside the galactic plane , although the simulated lons level in the mc simulations has been adjusted to the `` extra - galactic lons '' .",
    "this is in part due to neglecting the correlation of the fadc slices from the electronic noise , see section [ sec : mc ] .",
    "every extractor window had the freedom to move 5 fadc slices , i.e. the global window size was fixed to five plus the extractor window size .",
    "one can see that the bias typically decreases and the variance increases with increasing sliding window size , except for the digital filter .",
    "the extractor with the smallest _ rmse _ is the digital filter fitting 4 fadc slices with an _ rmse _ of 1.4 and 1.7 photo - electrons for an extra - galactic and a galactic star - field , respectively .    in the so - called image cleaning @xcite",
    "only the camera pixels above a certain charge threshold are used for the image parameterization @xcite .",
    "the charge threshold is adjusted such that the probability of being a noise fluctuation does not exceed a certain value . for the sake of comparison ,",
    "a typical value of 3@xmath57 ( 0.3% probability ) was chosen here and that number approximated with the formula : @xmath58 @xmath59 is shown in the 11@xmath60 and 15@xmath60 column of table  [ tab : extraction : pedestalbias ] . most of the sliding window algorithms yield a smaller signal threshold than the fixed window , although the former ones have a bias .",
    "the lowest threshold of only 4.2  photo - electrons for the extra - galactic star - field and 5.0  photo - electrons for the galactic star - field is obtained with the digital filter fitting 4 fadc slices .",
    "this is almost a factor 2 lower than the fixed window results .",
    "in this section , tests are described which were performed using light pulses of different color , shape and intensity produced by the magic led calibration pulser system  @xcite .",
    "such a system is able to provide fast light pulses of 24ns fwhm , with intensities ranging from 3 to more than 600 photo - electrons in one inner pmt of the magic camera .",
    "these pulses can be produced in three colors : _ * green , blue * _ and _ * uv*_. table  [ tab : pulsercolors ] lists the available colors and intensities .",
    ".the pulser colors available from the calibration system [ cols=\"^,^,^,^,^,^,^ \" , ]",
    "the results based on the investigations discussed above are summarized in table  [ tab : extraction : result ] .",
    "note , that there is no absolute basis for criteria to separate acceptable from non - acceptable properties of signal extraction algorithms . in the following the arbitrarily chosen criteria to compare the extractors are motivated :    * the extractor should yield on average the true number of photo - electrons and should not deviate by more than 10% in case of slight modifications of the pulse shape .",
    "these deviations directly effect the determination of the absolute energy scale of the reconstructed events .",
    "note , that the dominant systematic error to the absolute energy scale is currently the photon detection efficiency ( 10 - 12% ) @xcite .",
    "this requirement excludes extractors which integrate only a small portion of the pulse , especially the amplitude sensing cubic spline extractor .",
    "* the extractor must yield a stable low gain pulse extraction .",
    "this means that apart from being robust against modifications of the pulse shape , the extractor has to reconstruct on average the true signal charge also in case of variations of the pulse position within the recorded fadc samples .",
    "this criterion excludes the fixed window extractor since arrival time jitters may exceed the time window between the tail of the high gain pulse and the beginning of the low gain pulse . * the _ rmse _ of the reconstructed charge for the case of no signal should not exceed 2 photo - electrons ( an arbitrarily chosen threshold ) for dark night observations and the _ rmse _ of the reconstructed charge for air shower signals should never exceed the intrinsic poissonian signal fluctuations plus excess noise above 5 photo - electrons .",
    "camera pixels with a signal below 5 photo - electrons are usually rejected for the image parameterization @xcite .",
    "this low - energy analysis condition discards the large sliding windows and the fixed window extractor .",
    "it is not critical for high - energy analyses , however . * for analyses close to the energy threshold , an extractor should have a small or negligible bias , discarding again the amplitude sensing cubic spline extractor .",
    "* the time resolution should not be worse than 2ns at a signal strength of 10 photo - electrons .",
    "note , that this condition allowed us to require a time coincidence of 3.3  ns between neighboring pixels to reject noise signals in the image cleaning and thus allow to measure differential energy spectra down to 60 gev @xcite . all fixed window and",
    "all simple sliding window extractors are excluded by this condition .",
    "* the needed cpu - time should not exceed the one required for reading the data into memory and writing it to disk .",
    "unless further effort is made to speed up the integrating spline , it is excluded if used with a large integration window .",
    "table  [ tab : extraction : result ] shows which extractors satisfy the above criteria .",
    "one can see that there is no signal extractor without problems .",
    "however , the digital filter fitting four fadc slices can always be used for the high gain extraction , and the digital filter fitting six fadc slices for the low gain extraction.the mean pulse position is not critical .",
    "this combination has been chosen as the standard extractor for all magic data before april 2007 with the 300 msamples / s fadc system . during a certain period ,",
    "the pulse position was by mistake shifted with respect to the fadc read - out samples . in this case",
    "@xcite the signal was reconstructed by the cubic spline algorithms integrating 12 fadc slices .",
    "if efficiencies at low energies are not critical , i.e. a high analysis energy threshold without the use of the timing information , the sliding window extractor can be used in configurations which cover the entire pulse .",
    "this extractor turns out to be especially robust and was used for the data analysis in @xcite .",
    "in this paper different algorithms to reconstruct the charge and arrival time from the fadc read - out samples of the magic telescope have been developed .",
    "these algorithms are tested using mc simulations , pedestal and calibration events . the achievable charge and arrival time resolutions",
    "are determined . a digital filter fitting four fadc slices in the high gain channel and six fadc slices in the low gain",
    "was chosen as the standard signal extraction algorithm .",
    "part of the difficulties to find a suitable signal extractor ( reflected in table  [ tab : extraction : result ] ) stem from the fact that the magic signals are shaped just as long as to cover about four fadc slices .",
    "this choice , although necessary for a 300  msamples / s fadc read - out , `` washes out '' the intrinsic pulse form differences between @xmath0-ray and hadron showers , and thus prevents the analysis from using this information in the @xmath0/hadron discrimination , see @xcite . on the other side , the shaping time is not long enough to safely extract the amplitude from the ( shaped ) signal .",
    "these problems will be overcome with the full analysis of data taken with the new 2ghz fadc system in magic @xcite ; for first results see @xcite .",
    "this system has been designed to reduce any pulse form deformation to the minimum .",
    "it can be expected that the individual pulse forms are then directly recognized as such , e.g. with a digital filter using two sample pulse forms ( a @xmath0-ray - like and a hadron - like ) and discriminating between the two with the help of the calculated @xmath61 .",
    "these fadcs have a higher dynamic range and do not need a separate low gain channel any more .",
    "it can be expected that the signal extraction will become more robust , besides extracting a wealth of additional information about the shower characteristics .",
    "we would like to thank the iac for the excellent working conditions at the observatory de los muchachos in la palma . the support of the german bmbf and mpg , the italian infn and the spanish cicyt is gratefully acknowledged .",
    "the magic telescope is also supported by eth research grant th  34/04  3 and the polish mnii grant 1p03d01028 .",
    "f.goebel et  al ( magic collab . ) , 2007 , `` upgrade of the magic telescope with a multiplexed fiber - optic 2gsamples / s fadc data acquisition system system '' , proc .",
    "30th icrc , merida , mexico , arxiv:0709.2363 ."
  ],
  "abstract_text": [
    "<S> until april 2007 the magic telescope used a 300  msamples / s fadc system to sample the shaped pmt signals produced by the captured cherenkov photons of air showers . </S>",
    "<S> different algorithms to reconstruct the signal from the read - out samples ( extractors ) have been implemented and are described and compared . </S>",
    "<S> criteria based on the obtained charge and time resolution / bias are defined and used to judge the different extractors , by applying them to calibration , cosmic and pedestal signals . the achievable charge and time resolution </S>",
    "<S> have been derived as functions of the incident number of photo - electrons .    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    fast digitization , fadc , digital filter , cherenkov imaging telescopes , @xmath0-ray astronomy . </S>"
  ]
}