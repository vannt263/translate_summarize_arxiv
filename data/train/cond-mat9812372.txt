{
  "article_text": [
    "since its development , the density matrix renormalization group@xcite ( dmrg ) has been successfully used to calculate static properties of ground states and low - lying excited states in various low dimensional strongly interacting systems .",
    "energies can be determined with highest precision , and the calculation of time - independent correlation functions is easy and high accuracy can be achieved .",
    "the calculation of dynamical properties is more difficult .",
    "the lanczos vector method , also known as the continued fractions method , can be used to determine the dynamical correlation functions in an exact diagonalization calculation . however , in a dmrg calculation , if the basis is optimized only to represent the ground state , this will lead to poor results , since the lanczos vectors are not represented correctly in the truncated basis .",
    "hallberg suggested using several of the first lanczos vectors as target states in addition to the ground state@xcite .",
    "reasonable results were obtained for an s=1/2 chain , but the true accuracy of the method was not determined , since the infinite system dmrg method , rather than the finite system method , was used . in this paper",
    "we determine the accuracy of this method for the more appropriate finite system method .",
    "an alternative approach for generating dynamical spectra is the correction vector method , which yields exact results within the given basis@xcite .",
    "although it has been used in the dmrg context@xcite , in those calculations the basis was not expanded to represent these correction vectors .",
    "here we apply the correction vector method , targeting a correction vector at a particular frequency .",
    "we find that the dynamical correlation function at this frequency can be calculated directly and very accurately .",
    "we show how to piece together results from correction vectors at different frequencies to obtain the full spectrum .    taking antiferromagnetic heisenberg chains with spin 1 and",
    "spin @xmath0 as examples , we discuss the advantages and limitations of the two methods .",
    "we show how to obtain the spectral weight functions , and how to judge the quality of the numerical results .",
    "dmrg calculations are most accurate with open boundary conditions , in which case momentum is not precisely defined . in this work we show how to construct operators corresponding to wavevectors in systems with open boundaries using filter functions .    in section [ filtersection ]",
    "we discuss the construction of the operators for systems with open boundaries . in section [ lanczosvecsect ]",
    "we present the lanczos method , and in section [ spin1sect ] we apply it to the antiferromagnetic spin-1 chain . as an example where the lanczos method does not work so",
    "well we discuss the antiferromagnetic spin-1/2 chain in section [ spin1d2sect ] . in section [ corrvecsect ]",
    "we present the correction vector method , and we give conclusions in section [ conclusionsect ] .",
    "to calculate a green s function @xmath1 with @xmath2 , we have to be able to apply an operator @xmath3 in our system .",
    "the dmrg works in real - space , and operators with wavevectors @xmath4 can be obtained as fourier transforms of on - site operators @xmath5 . in infinite systems",
    "they are given as : @xmath6 @xmath7 where @xmath8 is the position of site @xmath9 , the lattice spacing is @xmath10 .    for finite systems with open boundaries , we construct operators defined as wavepackets , with finite spatial extent and finite uncertainty in the momentum .",
    "we construct the wavepacket by inserting a windowing or filter function in eq.([fouriertransformeq ] ) .",
    "if only real operators are used , it is numerically convenient to construct @xmath11 and @xmath12 where @xmath13 is the filter function , @xmath14 is the width of the window .",
    "we use system with even numbers of sites , and @xmath8 is offset so that is in the center of the system .",
    "the sites closest to the middle of the system are at @xmath15 and @xmath16 .",
    "the operators @xmath17 are reflection symmetric , which allows , if the hamiltonian is also reflection symmetric , using reflected system blocks as environment blocks in the dmrg .    applying the operator as if the system were periodic , is equivalent to using a rectangular window @xmath18 as the filter function with @xmath19 : @xmath20    this operator is seriously flawed .",
    "first , it has substantial weight at the edges of the system , where open boundary effects are significant .",
    "second , even if we ignore the edge effects , this window is very broad in the wavevector space .",
    "the fourier transform of @xmath18 is @xmath21 which for small @xmath4 is @xmath22    the wavevector uncertainty @xmath23 of this operator is of order 1 , even when @xmath24 , whereas @xmath4 itself ranges from 0 to @xmath25 .",
    "therefore this operator is not useful .",
    "as is well known from elementary quantum mechanics , the wavepacket with the minimum product of uncertainties @xmath26 is a gaussian function .",
    "however , it is more desirable to use an operator which is equal to 0 at the edges of the system . a widely used filter that looks similar to a gaussian in the center , but with compact support , is the parzen filter ( fig . [ parzen_filter.plot ] ) : @xmath27    with @xmath28 this filter smoothly goes to zero at the boundaries .",
    "the fourier transform is @xmath29 and the wavevector uncertainty is @xmath30 .",
    "we see that @xmath23 varies inversely with the system size if @xmath31 . for example , in a system with 100 sites @xmath32 , and with wavevectors @xmath33 this is a relative error of only @xmath34 .",
    "figure [ parzen_four.plot ] shows how the fourier transform of the parzen filter smoothly goes to zero , while the fourier transform of a rectangular window has oscillations at higher frequencies .",
    "the use of sine ( eq . [ sinappl ] ) and cosine ( eq . [ cosappl ] )",
    "functions for the operators instead of the complex form ( eq . [ fouriertransformeq ] ) requires some special attention .",
    "the green s function is @xmath35 with `` @xmath36 '' for sine and `` @xmath37 '' for cosine . noting that @xmath38 and @xmath39 , there are three different cases for the green s function .",
    "for it is : @xmath40    for : @xmath41    if only sine or cosine functions are used , the values found at @xmath42 and @xmath43 are either zero or twice the expected values . by doing separate calculations with sine and cosine functions and adding up the results the correct values are always obtained .    in finite systems",
    "this effect is broadened due to the finite width @xmath23 of the operators in the wavevector space .",
    "to get system size independent values for the green s functions we require @xmath44 for the filter functions .",
    "for the parzen filter this means that an additional prefactor of @xmath45 must be included in the filter .",
    "to calculate spectral functions a lanczos vector procedure can be used@xcite . to do this ,",
    "the hamiltonian @xmath46 is projected onto a krylov subspace spanned by lanczos vectors @xmath47 : @xmath48    in the lanczos basis the hamiltonian is tridiagonal : @xmath49    now the eigenvectors @xmath50 of @xmath46 are used as an approximation of the identity @xmath51 . inserting this into the green s function we get : @xmath52 here @xmath53 is the eigenvalue of @xmath54 , and @xmath55 .",
    "the dynamical correlation function @xmath56 is then given by @xmath57 where @xmath58 is the ground state energy .",
    "the peaks in the correlation function are at @xmath59 .",
    "the major source of errors in this is the approximation of the identity in terms of lanczos vectors , and the small number @xmath60 of these lanczos vectors that can be used as target states in practical calculations .",
    "only those states that are used as target states can be relied on as being represented correctly .",
    "similar to the lanczos algorithm for the solution of eigensystems , every additional lanczos vector adds another peak , typically at high energy , while peaks with the smallest frequencies are determined most precisely and converge the fastest .    to obtain the dynamical correlation function at the end of the calculation ,",
    "we make full use of the available hilbert space .",
    "we calculate @xmath61 at the dmrg step where the system block is the same size as the environment block , since the truncation errors are smallest in that step . to do this , we not only use the lanczos vectors that were target states , but keep calculating new lanczos vectors until orthogonality breaks down and the overlap of the new lanczos vector @xmath62 with the first lanczos vector @xmath63 is bigger than @xmath64 .    if more than just a few lanczos vectors are used , the question of the weight that is assigned to these target states in the density matrix has to be addressed .",
    "the weight of a lanczos vector in the spectrum is given by : @xmath65 taking this as a measure for the importance of a lanczos vector , we assign @xmath66 of the weight to the ground state , and distribute the remaining @xmath66 among the lanczos target states according to their weight @xmath67 .",
    "as an example we look at the antiferromagnetic spin 1 heisenberg model : @xmath68 each of the spins can be viewed as two spin-1/2 spins that pair with the spin-1/2 on the neighboring site in an antisymmetric singlet wavefunction@xcite . in an open chain",
    "this effectively leaves unpaired spin-1/2 s at the ends . to compensate for this",
    ", we add real spin-1/2 s at the ends of the chain",
    ". we do not include theses spins in the calculation of the spectra and set @xmath69 for the parzen filter .",
    "this system has a finite correlation length and the haldane gap that separates the ground state from the first excitation , a single magnon with wavevector @xmath70 .",
    "dmrg is particularly accurate in this system even if the number of states kept is small .    to obtain the dynamical correlation function",
    "we keep the ground state and the three first lanczos states as target states ( @xmath71 ) , and we keep @xmath72 states in the dmrg basis . to verify that keeping three lanczos vectors as target states is enough",
    ", we calculate the weight of the lanczos vectors in the final @xmath73 for @xmath43 .",
    "figure [ weight_vs_lanczosvector.spin1_and_1d2 ] shows that the weight of the first vectors is big and decays fast , and the first three lanczos vectors contain @xmath74 of the total weight .    to further verify the convergence of the dmrg basis , we calculate @xmath75 in every step and compare it to the final result @xmath73 by taking the inner product of the two : @xmath76 with the inner product defined as @xmath77 , and the norm @xmath78 . for this calculation",
    "we use a finite broadening factor @xmath79 .",
    "figure [ sp1.int_final_spectrum_vs_iteration.l=320.eta=0.01.128states ] shows the product for every dmrg step .",
    "the discontinuities occur when the system and environment blocks have the same size , and utilizing reflection symmetry , the system block is reflected onto the environment block .",
    "after two sweeps the dmrg basis is converged , there are no further discontinuities , only small oscillations which are due to the different truncation effect depending on the size of the system and the environment block . obviously with three lanczos target states the spectrum is described well enough , and convergence is very good .    in the calculation of the final spectrum ,",
    "lanczos vectors are calculated until the overlap of the new vector with the first one exceeds @xmath64 .",
    "the inset of fig .",
    "[ sp1.int_final_spectrum_vs_iteration.l=320.eta=0.01.128states ] shows that the overlap @xmath80 increases exponentially . in the given example we use the first 83 lanczos vectors .",
    "it can be seen from the overlap that orthogonality breaks down after 95 lanczos vectors have been calculated , effectively restarting the procedure .",
    "the effect on the resulting spectrum if more lanczos vectors are used is very small .",
    "figure [ sp1.q = pi.splus ] shows @xmath73 for @xmath43 . most of the weight is in one single peak , and with increasing system size this peak moves towards the haldane gap . to be sure that keeping @xmath72 states in the dmrg basis is enough ,",
    "we compare results with those from calculations with @xmath81 and @xmath82 states .",
    "table [ tab1 ] shows the truncation error depending on the system size and number of states .",
    "the truncation errors are relatively small even with states , and the difference between those with and @xmath82 states are small .",
    "cccc @xmath83 & @xmath84 & @xmath85 & @xmath86 +   + 40 & @xmath87 & @xmath88 & @xmath89 + 80 & @xmath90 & @xmath91 & @xmath92 + 160 & @xmath93 & @xmath94 & @xmath95 + 320 & @xmath96 & @xmath94 & @xmath97 +    [ tab1 ]    table [ tab2 ] and fig.[sp1.weight_and_omega.q = pi](a ) show the weight in the first peak .",
    "the weight grows with the system size , but seems to go to @xmath98 instead of @xmath99 .",
    "this value is important for estimating how good a single mode approximation for this excitation is .",
    "[ cols=\"^,^,^,^ \" , ]     since a finite broadening factor @xmath100 is used , the correction vector becomes complex . to avoid the use of complex numbers , we split the correction vector into real and imaginary part ,",
    "both used as target states : @xmath101    the equation for the correction vector is split into real and imaginary parts @xmath102 and @xmath103 , and the imaginary part is found by solving @xmath104 using the conjugate gradient method .",
    "note that this equation system gets more singular as @xmath105 gets closer to an eigenenergy of the hamiltonian , and as the broadening factor @xmath100 gets smaller . for large @xmath100",
    "the hamiltonian is close to a diagonal matrix , and the conjugate gradient method converges much faster than for small @xmath100 .",
    "this means that a large @xmath100 results in short calculation times , but it also limits the resolution of the spectrum . the convergence is also slowed down because energy gaps in @xmath106 are squared in eq .",
    "( [ imcorrveceq ] ) , and the convergence rate of the conjugate gradient method depends on the gap between the lowest and the next lowest eigenvector .",
    "the real part of the correction vector is calculated directly : @xmath107    using the correction vector , the green s function can be calculated directly : @xmath108 taking these states ( @xmath109,@xmath110 and @xmath111 ) as target states and optimizing the dmrg basis to represent them allows for a very precise calculation of the green s function for a given frequency @xmath105 and broadening factor @xmath100 . unfortunately , the correction vector has to be calculated separately for every @xmath105 .",
    "if the correction vector does not change very rapidly with @xmath105 , the dmrg basis that is optimized to represent the correction vector at a certain @xmath105 , should also be able to represent correction vectors for nearby frequencies .",
    "although the correction vectors are needed as target states to determine the dmrg basis , it is more efficient to use the lanczos vector method to determine the complete spectra within that basis . using the correction vector , but no lanczos vectors except the first one , as a target state , dmrg sweeps are performed until the basis is converged ( typically two or three sweeps ) . the dynamical correlation function is then calculated in the same way as in the lanczos vector method : when the left and right block have the same size lanczos vectors are calculated until orthogonality is lost . since this method is almost exact in the given basis , in principle it should yield the same result as using the correction vector method in the same basis , and it is much faster . of course ,",
    "while the spectrum is produced for all @xmath105 , it is only accurate near the @xmath105 used to produce the correction vector .    to determine the range of @xmath105 in which the truncated basis is good enough to calculate the spectral function",
    ", we compare calculations with different frequencies for the correction vectors .",
    "figure [ sp1d2.correctionvector.1om.eta=0.1.128states ] shows the spectral weight function near the upper edge of the excitation band in the antiferromagnetic spin-1/2 chain .",
    "this is an especially difficult region , because there are a lot of peaks at lower energies .",
    "we did several calculations with correction vectors for different @xmath105 , calculating the spectral weight in the region around the targeted frequencies . with @xmath72 states kept ,",
    "the overall shape reproduces the edge of the band accurately .",
    "deviations between the pieces of the spectrum calculated with different correction vectors can be seen .",
    "the small mismatch between the very accurate values calculated directly from the correction vectors , and the corresponding part obtained with the lanczos vector method are due to numerical errors in the lanczos procedure . by keeping more states",
    "this result can be improved .",
    "figure [ sp1d2.correctionvector.1om.eta=0.1.256states ] shows the same part of the spectrum with @xmath82 states kept .",
    "now the different parts match very well .",
    "further improvement would be possible by keeping more states or reducing the distance between the frequencies of the correction vectors .",
    "this result can be improved even further .",
    "instead of using just one correction vector as a target state , we try using two correction vectors at the same time .",
    "the spectral weight can then be interpolated for frequencies between these two correction vectors . with a broadening factor of @xmath112 ,",
    "a distance of @xmath113 between the two correction vectors seems appropriate . in fig .",
    "[ sp1d2.correctionvector.2om.eta=0.1.128states ] and [ sp1d2.correctionvector.2om.eta=0.1.256states ] the results from calculations with different frequencies for the correction vectors are plotted . with @xmath72 states the parts for @xmath114 match perfectly , and for @xmath115 they still match better than with only one correction vector as a target state ( fig .",
    "[ sp1d2.correctionvector.1om.eta=0.1.128states ] ) . with @xmath82 states ( fig .",
    "[ sp1d2.correctionvector.2om.eta=0.1.256states ] ) all pieces of the spectrum match up almost perfectly .",
    "this gives us a consistent method to verify how good our numerical results are , and we find that it is possible to achieve very high accuracy .",
    "now we use this method to obtain the complete spectral weight in a 160 site chain .",
    "keeping @xmath82 states and using two correction vectors as target states , we start with correction vectors for @xmath116 and @xmath117 . after two sweeps through the system the dmrg basis",
    "is converged , and the spectral weight function is calculated for @xmath118 using the lanczos procedure",
    ". then we target @xmath117 and @xmath119 , perform two sweeps through the system , and calculate the spectral weight for @xmath120 . continuing this procedure",
    ", we obtain the function shown in fig .",
    "[ sp1d2.l=160.q = pi.spectralweight.eta=0.1 ] .",
    "in contrast to the results from the lanczos vector method , the spectral weight function calculated using two correction vectors shows no finite - size peaks and reflects the shape expected in the infinite system .",
    "( [ bandstruct.eq ] ) predicts @xmath121 decay from @xmath116 to @xmath122 , where the spectral weight drops to zero . the band presented in fig .",
    "[ sp1d2.l=160.q = pi.spectralweight.eta=0.1 ] shows the correct upper and lower bound , but the spectral weight in the band decays faster than @xmath121 . to verify",
    "if this is a finite - size effect , we look at chains with different lengths . figure [ sp1d2.different_l.q=pi.spectralweight.eta=0.2 ] shows that the spectral weight decays faster than @xmath121 in all system , and the decays do not become slower for longer chains .",
    "the only hint at finite - size effects is the different size of the spectral weight for different system sizes .",
    "the small oscillations in the 40 site chain are due to the limited number of peaks in the relatively small system , those in the 160 site chain are due to the large distance of @xmath123 between the correction vectors .",
    "they do not affect our result , and could be removed by using pairs of correction vectors with closer frequencies or by increasing the size of the dmrg basis .    in fig .",
    "[ sp1d2.correctionvector.2om.eta=0.1.256states ] the upper edge of the excitation band can be seen , but due to the broadening factor @xmath112 it is difficult to determine the position of the edge .",
    "since the spectral weight function is plotted by taking the peaks found in the lanczos procedure and plotting them with the given @xmath100 , they can as well be plotted with smaller broadening factors .",
    "figure [ sp1d2.l=80.different_eta ] shows plots with @xmath112 , for which the dmrg basis was optimized , and @xmath124 and @xmath79 .",
    "for the smaller @xmath100 the different parts of the spectral weight function no longer match , but now the poles are easily identifiable .",
    "the position of the peaks can also be determined by directly taking the position of the peaks from the lanczos procedure .",
    "doing this , the last peak in the band is found at @xmath125 , compared to @xmath122 given in ( eq .",
    "[ sp1d2.upper_edge.eq ] ) . to verify",
    "if the small difference is a finite - size effect or a numerical error , longer chains can be studied , or correction vectors closer to the desired region could be used . using smaller",
    "@xmath100 and reducing the distance between the correction vectors also gives higher resolution .",
    "in conclusion , we have presented and tested two methods to calculate dynamical correlation functions using dmrg .",
    "we have shown that the lanczos vector method works very well if only the low - energy part of the correlation function is of interest , or if the bulk of the weight is in one single peak .",
    "we demonstrated this for the case of the antiferromagnetic spin-1 and spin-1/2 chains , where we could reproduce the dispersion relation of the lower edge of the spectral weight functions correctly .",
    "if there is an excitation band , the lanczos vector method is unable to describe the higher energy part of the correlation functions .",
    "these parts can be determined using the correction vector method .",
    "this method gives very precise results for frequencies at which the correction vectors are used as target states .",
    "the lanczos procedure can be used in the basis optimized for the correction vectors to determine the spectrum fast and efficiently not only at the frequency of the correction vector , but also in the region around that . by comparing the plots from calculations with different frequencies for the correction",
    "vectors it is possible to estimate the range over which the spectral function is determined correctly .",
    "we find that remarkably good spectra can be determined if two correction vectors are used as target states , and the spectral function is calculated for the frequencies between them . in the case of the excitation band in the spectral weight function of the antiferromagnetic spin-1/2 chain",
    ", we used this method and were able to study a system long enough and with sufficient accuracy that no finite - size peaks were visible and excellent agreement with theoretical expectations was obtained .",
    "our results show that using these techniques , obtaining accurate dynamical spectral functions from dmrg is feasible and can be considered a standard dmrg technique .",
    "the calculation time is longer than for ground state properties , but still manageable for single chain systems and probably for ladders with a few chains .",
    "the authors would like to thank h.  monien , e.  jeckelmann and s.  k.  pati for profitable discussions .",
    "we are especially grateful to m. s. l. du croo de jongh for discussions and program design and development .",
    "this work was supported by the national science foundation under grant dmr98 - 70930 and the daad `` doktorandenstipendium i m rahmen des gemeinsamen hochschulsonderprogramms iii von bund und lndern '' ."
  ],
  "abstract_text": [
    "<S> the density matrix renormalization group ( dmrg ) method allows for very precise calculations of ground state properties in low - dimensional strongly correlated systems . </S>",
    "<S> we investigate two methods to expand the dmrg to calculations of dynamical properties . in the lanczos vector method </S>",
    "<S> the dmrg basis is optimized to represent lanczos vectors , which are then used to calculate the spectra . </S>",
    "<S> this method is fast and relatively easy to implement , but the accuracy at higher frequencies is limited . </S>",
    "<S> alternatively , one can optimize the basis to represent a correction vector for a particular frequency . </S>",
    "<S> the correction vectors can be used to calculate the dynamical correlation functions at these frequencies with high accuracy . by separately calculating correction vectors at different frequencies , </S>",
    "<S> the dynamical correlation functions can be interpolated and pieced together from these results . for systems with open boundaries </S>",
    "<S> we discuss how to construct operators for specific wavevectors using filter functions .    </S>",
    "<S> [ @twocolumnfalse    ] </S>"
  ]
}