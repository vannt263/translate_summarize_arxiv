{
  "article_text": [
    "evolutionary relationships between present - day taxa ( species , genera etc ) are usually represented by a phylogenetic tree , which shows a branching pattern of speciation from some ancestral taxon to the taxa we observe today @xcite . however , reticulate evolution is known to complicate this simple ` tree model ' due to processes such as the formation of hybrid species @xcite , and other mechanisms where genetic material is exchanged between species ( such as horizontal gene transfer ( hgt ) ) or within a species ( recombination , a process we do not consider further in this paper ) .",
    "consequently , phylogenetic networks that allow ` vertical ' branching through time as well as ` horizontal ' reticulation events have increasingly been recognised as providing a more complete picture of much of the evolutionary history of life @xcite .",
    "this transition has brought with it a number of mathematical and computational problems  in particular , how to reconstruct and analyse such networks , and how to distinguish different types of reticulation from tree - like evolution @xcite . in this note",
    "we consider one aspect of the latter topic , namely the question of whether or not , if we knew the average evolutionary distance between each pair of species , we could determine whether the species network could have been a tree , or whether some more complicated reticulate history is required .    in a phylogenetic tree ,",
    "the evolutionary distance between two present - day species is simply the path length from each species to the other via its most recent common ancestor ( here , ` evolutionary distance ' typically refers to the actual or expected amount of genetic change ) .",
    "however , for networks , there may be many paths linking two present - day species , and the evolutionary distance will be some average of these path lengths . nevertheless , it is conceivable that in some cases , these distances might still appear to fit a tree exactly .",
    "we explore this question for two classes of networks : those relevant to hybrid evolution ; and those relevant to hgt .",
    "both are special cases of a more general description of ( binary ) ` reticulation ' networks , which we now define .      following  @xcite , a _ reticulation network _",
    "@xmath0 on a finite set @xmath1 is a rooted acyclic digraph @xmath2 with the following properties :    * the _ root _ vertex has in - degree 0 and out - degree 2 ; * @xmath1 is the set of vertices with out - degree 0 and in - degree 1 ( ` leaves ' ) ; * all remaining vertices are _ interior vertices _ , and each such vertex either has in - degree 1 and out - degree 2 ( a _ tree vertex _ ) or in - degree 2 and out - degree 1 ( a _ reticulation vertex _ ) ; * the arc set @xmath3 of @xmath0 is the disjoint union of two subsets , the set of ` reticulation arcs ' @xmath4 and the set of ` tree arcs ' @xmath5 ; moreover each reticulation arc ends at a reticulation vertex , and each reticulation vertex has at least one incoming reticulation arc ; * every interior vertex has at least one outgoing tree arc ; and * there is a function @xmath6 so that ( a ) if @xmath7 is a tree arc then @xmath8 , and ( b ) if @xmath7 is a reticulation arc , then @xmath9 .    condition ( vi ) embodies the biological requirement that the network has a temporal representation that reflects the order of speciation events , and for which reticulation events involve two species that co - exist at some point in time .    in applications , @xmath1 typically denotes a set of extant ( present day ) species .",
    "two types of reticulation networks are particularly relevant in evolutionary biology ( for different reasons , as we explain shortly ) and these will be the main classes we will consider in this paper .",
    "the distinction is in the pair of arcs ending at a reticulation vertex in property ( iii ) .",
    "namely ,    * in a _ hybridization network _ , arcs ending in a reticulation vertex are reticulation arcs , and * in a _ horizontal gene transfer ( hgt ) network _ , exactly of the arcs ending in a reticulation vertex is a reticulation arc .    a simple example of each type is shown in figure  [ fig1 ] .",
    "( usually extant species ) ; ( ii ) an hgt network on @xmath10 ; and ( iii ) the tree @xmath11 obtained from the hgt network @xmath0 in ( ii ) by deleting all reticulation arcs .",
    "reticulate arcs in ( i ) and ( ii ) are drawn as arrows ; in each case the reticulate vertices are at the endpoints of the reticulate arcs .",
    "note that ( i ) has four reticulation arcs and two reticulation vertices , while ( ii ) has five reticulation arcs and five reticulation vertices . ]",
    "hybridization networks model settings where a new species arises from members of two lineages , a process that occurs in plants , fish , and some animals  @xcite , while hgt models the situation where a gene ( or genes ) are transferred from one species to another ( a process that is common in bacteria ) @xcite .",
    "firstly , observe that a reticulation network @xmath0 on @xmath1 has no reticulation vertices if and only if @xmath0 is a rooted binary phylogenetic @xmath1-tree ( as defined , for example , in @xcite ) .",
    "moreover , any hybridization network is necessarily a _ tree - child network _ ; that is , from any interior vertex in @xmath0 , there is a path to a leaf that avoids any reticulation vertex .",
    "tree - child networks have a number of desirable combinatorial and computational properties ( see e.g. @xcite ) .",
    "hybridization networks have bounded size once @xmath12 is specified , since such a network can have at most @xmath13 reticulation vertices @xcite . to see this , note that",
    "in any digraph , the sum of the out - degrees equals the sum of the in - degrees so we obtain : @xmath14 where @xmath15 and @xmath16 refer to the number of tree vertices and hybridization vertices , respectively .",
    "note that each hybridization vertex corresponds to two parent tree vertices , and hence @xmath17 in a hybridization network .",
    "( [ counter ] ) gives @xmath18 , and using @xmath19 we obtain : @xmath20 a consequence of this bound is that , up to isomorphism , there are only finitely many hybridization networks for any given @xmath21 ( the enumeration of hybridization networks has recently been investigated by @xcite ) .",
    "by contrast , an hgt network with a given leaf set @xmath1 can have arbitrarily many reticulation vertices , and so there are infinitely many hgt networks for a given @xmath1 .",
    "however , an hgt network @xmath0 has a useful property that is absent in a hybridization network : an hgt network always has an associated canonical rooted binary phylogenetic @xmath1-tree @xmath22 that is obtained from @xmath0 by deleting all the reticulation arcs ( and suppressing any resulting vertices that have both in - degree 1 and out - degree 1 ) .",
    "we denote this tree with the notation @xmath11 ( an example is shown in figure  [ fig1 ] ) .    given any reticulation network @xmath0 on @xmath1 , suppose that for each reticulation vertex , we delete exactly one of the in - coming arcs .",
    "the resulting graph is a rooted tree with leaf set @xmath1 and a root that coincides with the root of @xmath0 .",
    "moreover , if we suppress any resulting vertices that have both in - degree 1 and out - degree 1 we obtain a rooted binary phylogenetic @xmath1-tree , @xmath22 .",
    "we say that @xmath22 is _ displayed _ by @xmath0 and we let @xmath23 denote the set of all the ( at most ) @xmath24 such trees that are displayed by @xmath0 .",
    "consider any unrooted phylogenetic @xmath1-tree @xmath25 together with a weight function @xmath26 that assigns strictly positive weights to each edge of the tree .",
    "then @xmath27 induces a distance function on @xmath1 as follows : for each pair of leaves @xmath28 on a tree @xmath22 , the _ tree distance _ between them is defined as the sum of the weights of the edges that lie on the ( unique ) path in @xmath22 connecting @xmath29 and @xmath30 .",
    "that is : @xmath31 where if @xmath32 we set @xmath33 ( the empty path has length zero ) .",
    "the resulting function @xmath34 is a metric on @xmath1 .",
    "a metric on @xmath1 that can be represented in this way on some phylogenetic @xmath1-tree is said to be a _",
    "tree metric_. this holds if and only if the metric satisfies the ` four - point condition ' .",
    "this states that for any four ( not necessarily distinct ) points @xmath35 from @xmath1 , two of the three sums @xmath36 are equal , and are greater than or equal to the other one .",
    "this classic characterisation of tree metrics dates back to the 1960s ( for more recent treatments , see @xcite )",
    ". moreover , if @xmath37 is a tree metric on @xmath1 , then @xmath37 can be written @xmath38 for precisely one choice of the pair @xmath27 , where @xmath22 is a phylogenetic @xmath1-tree , and @xmath39 a strictly positive edge weight function . in the case where @xmath22 is binary",
    ", we will say that @xmath37 is a _",
    "binary tree metric_.      a reticulation network can be thought of as a ` weighted union ' of the trees displayed by @xmath0 .",
    "we formalise this idea , and extend it to bring in distances , as follows :    for each vertex @xmath40 in the set @xmath41 of reticulation vertices of @xmath0 , let @xmath42 denote the two arcs that end at @xmath40 .",
    "suppose we are given a reticulation network @xmath43 on @xmath1 along with :    * a weight function @xmath44 that assigns weights to each tree arc ; and * a strictly positive probability distribution @xmath45 on the set @xmath46 of functions @xmath47 for which @xmath48 .",
    "in evolutionary biology , the weighting @xmath39 typically describes some measure of genetic change along each tree arc , and each function @xmath49 indicates the line of descent of a particular gene , and so describes a tree @xmath50 in @xmath23 .",
    "notice that @xmath51 though it may be possible for different functions @xmath52 to lead to the same rooted phylogenetic tree ( possibly with different tree metrics ) . for a given @xmath49 , its @xmath45-value , denoted @xmath53 , can be thought of as the expected proportion of genes that follow the tree @xmath50 . since @xmath54 , we call @xmath45 the ` mixing distribution ' of the network .    for example",
    ", suppose we have two arcs @xmath55 and @xmath56 that end at the reticulate vertex @xmath40 , and a function @xmath57 satisfying @xmath58 ( such a function @xmath59 could indicate the proportion of genetic material that is contributed from each of the two parent lineages when a reticulation occurs ) . when there is just a single reticulation , the mixing distribution @xmath45 can be identified with the @xmath59 function for the single reticulation vertex .",
    "however , when more than one reticulation vertex is present , one needs to consider how the different reticulation events might interact . in the simplest case",
    ", we might treat the reticulations as ( stochastically ) independent events ( with @xmath59 now being regarded as assigning probabilities rather than proportions ) so that the resulting randomly generated function @xmath52 would have probability @xmath60 this assumption of independence is very strong and is more than we require here .",
    "indeed , all that we require is that the mixing distribution @xmath45 of the network satisfies @xmath61 for all @xmath49 .",
    "we now define the distance induced by a reticulation network with weighted tree arcs and a mixing distribution .",
    "for such a triple @xmath62 we define @xmath63 by @xmath64 where @xmath65 is the edge weight induced by @xmath0 on @xmath50 .",
    "if there are no reticulation vertices in @xmath0 , so that @xmath0 is a rooted phylogenetic @xmath1-tree @xmath22 , we take @xmath37 to be the tree metric @xmath66 .",
    "we illustrate these ideas for a hybridization network and an hgt network in figures [ figure2 ] and  [ figure3 ] , respectively .",
    "notice that @xmath67 is always a metric on @xmath1 , since it is a convex combination of tree metrics on @xmath1 .     with edge weights @xmath39 , and",
    "reticulation values @xmath68 .",
    "( ii ) the two rooted trees in @xmath23 that are displayed by @xmath0 , together with their associated edge weights . (",
    "iii ) the unrooted trees from ( ii ) , which have the same topology , even though the trees in ( ii ) do not .",
    "for this example , the network distance between @xmath55 and @xmath69 is given by @xmath70    , and reticulation value @xmath59 on the unique reticulation arc , and @xmath71 on the incident tree arc that has weight @xmath72 .",
    "( ii ) the two rooted trees in @xmath23 that are displayed by @xmath0 , together with their associated edge weights . (",
    "iii ) the unrooted trees from ( ii ) .",
    "for this example , the network distance between @xmath55 and @xmath69 is given by @xmath73    some detail is known about the conditions that govern when a metric can be represented on a reticulation network . in @xcite , willson shows how a network can be reconstructed from average distances , given that one knows the underlying network graph already .",
    "there are some uniqueness properties , including for the reticulation probabilities ( @xmath59 ) .    in  @xcite",
    ", willson shows how one can generate the underlying network graph from the average distances , under some hypotheses .",
    "he shows that if there is only one reticulation , it can be done , and he provides an algorithm for this .",
    "there are some necessary conditions on the average distance function , and which are sufficient if there is only one reticulation .    in this paper",
    ", we study conditions under which a tree metric can be represented on a network .",
    "we impose no conditions on the distance function .",
    "network distances arise in a range of models in molecular genetics , for example those in which dna sequences undergo site mutations along the tree arcs , and for which ( i ) at speciation events ( tree vertices ) the sequences on the two outgoing arcs are identical to the sequence at the end of the incoming arc , and ( ii ) at reticulation vertices , the state at each site is selected from the state at the same position at the end of either one of the two incoming arcs . in such a hybridisation network @xmath0 on @xmath1 ,",
    "the history of the @xmath74 position for each species in @xmath1 traces back according to one of the trees in @xmath75 .",
    "now , consider the hamming distance @xmath76 between pairs of species from the set @xmath1 ( so @xmath77 is the proportion of sites where taxon @xmath29 and taxon @xmath30 differ ) . for binary sequences , suppose each site mutates at most once in the network ( the so - called ` infinite sites model ' @xcite ) and at each reticulation vertex the state at each site is ( independently ) selected to match the state at the site from one of its two incoming arcs with the prescribed @xmath59 probability values .",
    "then the expected hamming distance @xmath78 on @xmath1 satisfies @xmath79 , where the weight @xmath39 of a tree arc @xmath7 is the proportion of sites for which a mutation occurs along @xmath7",
    ".      we will show ( proposition  [ prophelps ] ) that if each tree in @xmath23 is isomorphic to the same ( unrooted ) phylogenetic @xmath1-tree , then the network induces a distance that is tree - like and behaves nicely with respect to the weights . on the other hand ,",
    "if exactly two different unrooted trees are present in @xmath23 , then the distance function induced by the network is never tree - like .",
    "the proof of this result can be found in the materials and methods section .",
    "[ prophelps ]    * suppose that all the trees in @xmath23 are isomorphic as unrooted phylogenetic @xmath1-trees to some tree @xmath22 . then @xmath80 is a tree metric that is represented by @xmath22 . * if the trees in @xmath23 can be partitioned into two non - empty isomorphism classes of unrooted trees , then @xmath80 is not a tree metric .",
    "in this section , we are interested in whether or not a tree metric can be realised on a hybridization network and , conversely , whether a hybridization network might induce a distance that fits perfectly on some tree . in order to state our main result , theorem  [ thm ]",
    ", we introduce a further definition : we call a hybridization network with @xmath81 hybridizations a _ @xmath81-hybridization network _ , and we call a 1-hybridization network for which the two reticulation arcs have their source vertices adjacent to the root a _ primitive _ 1-hybridization network . the proof of this theorem is given in the materials and methods section .",
    "[ thm ] let @xmath1 be a finite set of taxa , and suppose @xmath37 is a metric on @xmath1 , @xmath82 .    1 .",
    "if @xmath37 is a binary tree metric , then there exists a primitive 1-hybridization network @xmath0 and weights @xmath83 such that @xmath84 .",
    "2 .   if @xmath0 is a hybridization network , and @xmath84 is a tree metric for some @xmath85 , then @xmath0 is either a tree , or @xmath0 is a primitive 1-hybridization network .",
    "one way to rephrase the key point of this theorem is that a tree metric can be represented on a @xmath81-hybridization network if and only if either @xmath86 or @xmath87 and the hybridization is placed near the root .",
    "but there is slightly more here , in that any network admitting a tree metric must be primitive 1-hybridization network .",
    "we are also able to count such networks , showing that there are @xmath88 such primitive 1-hybridization networks on @xmath21 taxa for each tree metric ( proposition  [ prop : counting ] ) .",
    "there is a unique unrooted tree for each tree metric .",
    "theorem  [ thm ] means that for each rooted tree we have at least one primitive 1-hybridization network . but",
    "how many do we in fact have ?",
    "[ prop : counting ] for each tree metric on @xmath21 leaves , there are @xmath88 1-hybridization networks that realise the metric .",
    "each of the @xmath89 internal edges on the unrooted tree correspond to a choice for the root , and each one gives four distinct 1-hybridization networks , since each of the four subtrees nearest the root could be the one descending from the hybridization ( see figure  [ fig : four.retics ] ) .",
    "each hybridization network from a root placed on an external edge can also be obtained from a root placed on an internal edge , and so this adds no new hybridization networks .",
    "our main result for hybridization networks ( in the previous section ) applies only in one direction for hgt networks .",
    "if a single reticulation occurs between the arcs of @xmath0 that are incident with the root then we obtain a tree metric .",
    "however , for hgt networks , it is possible for tree metrics to arise under other scenarios , both for a single reticulation event , and for multiple ones .",
    "we now describe two results that demonstrate how this can occur .",
    "recall that @xmath11 is the rooted phylogenetic @xmath1-tree associated with an hgt network @xmath0 , obtained by deleting all the reticulation arcs .",
    "[ lemsister ] for any hgt network @xmath0 , if each reticulation arc is between adjacent tree arcs of @xmath11 , then @xmath80 is tree - like on @xmath11 .",
    "if @xmath0 has the property described , then every tree in @xmath23 is isomorphic as a rooted phylogenetic @xmath1-tree to @xmath11 , and so these two trees are also isomorphic as unrooted trees .",
    "the lemma now follows from proposition [ prophelps](a ) .",
    "our main result for this section is the following .    [ main_hgt ]    * if an hgt network @xmath0 has a single reticulation arc , then @xmath80 is tree - like if and only if that arc is either ( i ) from one arc to an adjacent arc or ( ii ) between a root arc and one of the two children of the other root arc .",
    "moreover , this holds for any ( positive ) parameters on @xmath0 , and the only tree that harbours a representation for @xmath80 is @xmath11 .",
    "* there exist 2-reticulated hgt networks @xmath0 that can be represented on @xmath11 and ( for other parameter settings ) on a tree that is different from @xmath11 , even when the mixing distribution treats the two reticulations independently .    _",
    "part ( a ) : _ for the ` if ' part , condition ( i ) suffices by lemma  [ lemsister ] . for case ( ii )",
    ", we note that although the two trees in @xmath23 are no longer isomorphic to the same rooted phylogenetic @xmath1-tree , they are isomorphic to the same unrooted phylogenetic @xmath1-tree , so proposition  [ prophelps ] applies .    for the `",
    "only if ' direction , suppose that neither condition ( i ) nor ( ii ) is satisfied .",
    "that is , the reticulation arc is not between adjacent arcs and not from a root arc to one of the two children of the other arc .",
    "there is a quartet then in which the reticulation is between non - adjacent and non - root arcs , in which case , if we suppress the location of the root , it corresponds to the scenario shown in figure  [ fig : hgt.quartets ] , up to permutation of the leaves .",
    "let us abbreviate the sums of distances arising in the four - point condition as @xmath90 , @xmath91 and @xmath92 . ignoring the terms that appear in every sum ( shown as @xmath93 in figure  [ fig : hgt.quartets ] ) , the quartet distance sums in the case shown in figure  [ fig : hgt.quartets ] are : @xmath94,\\\\ s_2&=[(1-\\alpha)(b+c)+\\alpha a]+(a+b),\\\\ s_3&=b+[(1-\\alpha)(a+b+c)].\\end{aligned}\\ ] ] noting that @xmath95 since @xmath96 , for these quartets to satisfy the four - point condition we must have @xmath97 .",
    "however , this implies that either @xmath98 or @xmath99 , which is a contradiction .",
    "leading to leaf @xmath100 can not contain the root , as this would create a directed cycle in the network , but any other tree arc can ) .",
    "here @xmath93 denotes weights that occur in each quartet sum in the four - point condition and that hence can be ignored . ]    _ part ( b ) : _ it suffices to provide an example .",
    "consider the 2-reticulated network shown in figure  [ fig:2-retic ] , where hgt events represented by the branches labelled @xmath59 and @xmath101 occur independently ( the _ independence model _ , as described in the section average distances on networks ) .     that can be represented on a tree that is different from @xmath11 . here",
    ", we assume that @xmath102 and @xmath103 . ]",
    "we have the following quartet distances involved in the four - point condition , with @xmath104 being as defined in ( a ) : @xmath105+[(1-\\alpha)(1-\\alpha')(d+e)+\\alpha(b+c)+(1-\\alpha)\\alpha'(a+c+e)]\\\\      & = ( 1+(1-\\alpha)\\alpha')a+(1+\\alpha)b+(\\alpha+(1-\\alpha)\\alpha')c+(1-\\alpha)(1-\\alpha')d+(1-\\alpha)e,\\\\ s_2 & = [ ( 1-\\alpha)(1-\\alpha')(a+c+d+e)+(1-\\alpha)\\alpha ' e+\\alpha(a+b)]+[b+c]\\\\      & = ( 1-(1-\\alpha)\\alpha')a+(1+\\alpha)b+(1+(1-\\alpha)(1-\\alpha'))c+(1-\\alpha)(1-\\alpha')d+(1-\\alpha)e,\\\\ s_3 & = [ a+c]+[(1-\\alpha)\\alpha'(a+b+e)+(1-\\alpha)(1-\\alpha')(b+c+d+e)]\\\\      & = ( 1+(1-\\alpha)\\alpha')a+(1-\\alpha)b+(1+(1-\\alpha)(1-\\alpha'))c+(1-\\alpha)(1-\\alpha')d+(1-\\alpha)e.\\end{aligned}\\ ] ]    in the underlying tree ( @xmath11 ) of the network we have @xmath106 as the smaller of these , so that @xmath107 . the equality of @xmath108 and @xmath109 requires @xmath110 , and @xmath111 implies @xmath112 .",
    "together we require @xmath113 which is certainly possible for some regions of the parameter space .",
    "however , there are alternative solutions , as required by the theorem . for instance",
    ", it is possible to have @xmath109 as the shortest of the three quartet distances , so that @xmath114 .",
    "this is possible so long as @xmath115 just to be explicit , this is possible whenever , for example , @xmath116 , @xmath117 and @xmath118 .",
    "the unrooted tree that realizes this metric has taxa 1 and 4 together and taxa 2 and 3 together ( @xmath119 ) , and is _ not _ @xmath11 .",
    "this completes the proof of theorem  [ main_hgt ] .",
    "the four point condition provides a very precise characterization , in terms of pairwise distances between taxa , of the circumstances under which a metric is able to be displayed on a tree ( see the section on tree metrics ) .",
    "it is so successful that it is tempting to assume that once a metric satisfies this condition then we have a tree , and that that is the end of the story .",
    "however the results in this paper show that such  tree metrics \" can _ also _ be realised as hybridization and hgt networks .",
    "any surprise at this conclusion may be partly due to the biconditional statement of the four point condition ; namely that a metric is a tree metric _ if and only if _ it satisfies the condition . superficially this appears to leave little room to maneouvre .",
    "however , as we show , being realised on a tree does not preclude the possibility that the metric can also be realised on a reticulation network .",
    "the practical implication of this wriggle - room is that phylogenies displaying tree metrics may in fact involve hybridization or horizontal gene transfer in their histories .",
    "however , the results in this paper also show that ` all hell is not about to break loose ' : for the network to be a hybridization network , strict restrictions apply ( theorem  [ thm ] ) .",
    "in particular , there can be at most one hybridization event and it must be adjacent to the root . however , such restrictions do not hold for hgt networks ( theorem  [ main_hgt ] ) . in this case",
    "there is some control when the network contains a single reticulation , but surprisingly , it is also possible to have a tree metric displayed on an hgt network with more than one reticulation .    while it is biologically unlikely for a single network to contain both hybridization and hgt events , these results leave open several intriguing questions for further study .",
    "for instance :    1 .   it would be interesting to determine how far theorem  [ main_hgt](b ) extends .",
    "for example , is the following true ? for _ any _ two binary phylogenetic @xmath1-trees @xmath120 and @xmath121 ( where @xmath1 can be of any size ) , is there an hgt network for which @xmath122 and yet where @xmath80 is representable on @xmath121 ( where the mixing distribution is given by the independence model ) ? 2",
    ".   how do our results change if we allow some leaves to be missing ( due to extinction or sampling omission ) ? 3 .",
    "let @xmath123 denote the minimum number of hybridizations required to represent @xmath37 on a hybridization or an hgt network .",
    "what conditions characterise those metrics @xmath37 with @xmath124 ?",
    "what about @xmath125 for any @xmath126 ?",
    "in the following , for a subset @xmath127 of @xmath1 of size 4 ( a ` quartet ' ) , we use @xmath128 to denote the phylogenetic tree with leaf set @xmath127 that is induced by the @xmath1-tree @xmath22 on @xmath127 .",
    "moreover , if @xmath129 , we write @xmath130 if the path in @xmath22 connecting @xmath29 and @xmath30 is vertex - disjoint from the path in @xmath22 connecting @xmath39 and @xmath131 .    recall the statement of proposition  [ prophelps ] :    * suppose that all the trees in @xmath23 are isomorphic as unrooted phylogenetic @xmath1-trees to some tree @xmath22 .",
    "then @xmath80 is a tree metric that is represented by @xmath22 . *",
    "if the trees in @xmath23 can be partitioned into two non - empty isomorphism classes of unrooted trees , then @xmath80 is not a tree metric .",
    "both parts of proposition  [ prophelps ] follow from the respective parts of the following lemma  [ lem1 ] , noting that in part ( b ) , if two trees are non - isomorphic as unrooted trees , then they must resolve at least one quartet differently .    [ lem1 ] let @xmath132 be a sequence of phylogenetic @xmath1-trees with associated strictly positive edge weights .    *",
    "if @xmath133 for all @xmath134 , then for any values @xmath135 , we have : @xmath136 for the positive edge weights @xmath137 on @xmath22 .",
    "* suppose that there is a quartet @xmath138 , for which @xmath139 .",
    "then for any values @xmath140 , we have : @xmath141 for any phylogenetic @xmath1-tree @xmath22 having non - negative edge weights @xmath39 .    _",
    "part ( a ) _ : by the definitions and the interchange of the order of summation we have , for any @xmath142 : @xmath143    _ part ( b ) _ : suppose that @xmath129 satisfies the condition stated , with @xmath144 for all @xmath145=\\{1,\\ldots , k\\}$ ] , and @xmath146 for all @xmath147-j$ ] , for some non - empty proper subset @xmath148 of @xmath149 $ ] .",
    "let @xmath150 , @xmath151-j } \\beta_j d_{(t_j ,   w_j)}$ ] and @xmath152 } \\beta_j d_{(t_j ,   w_j)}.$ ] by part ( a ) and the four - point condition , we have : @xmath153 and @xmath154 it follows that : @xmath155 similarly @xmath156 .",
    "therefore , @xmath157 violating the four - point condition .",
    "thus @xmath37 has no realisation on any unrooted phylogenetic tree ( binary or not ) with non - negative edge weights .",
    "recall the statement of theorem  [ thm ] :    let @xmath1 be a finite set of taxa , and suppose @xmath37 is a metric on @xmath1 , @xmath82 .    1 .",
    "if @xmath37 is a binary tree metric , then there exists a primitive 1-hybridization network @xmath0 and weights @xmath83 such that @xmath84 .",
    "if @xmath0 is a hybridization network , and @xmath84 is a tree metric for some @xmath85 , then @xmath0 is either a tree , or @xmath0 is a primitive 1-hybridization network .",
    "the proof of theorem  [ thm ] relies on first establishing some preliminary results .",
    "[ lem3 ] the two binary phylogenetic @xmath158trees displayed by a 1-hybridization network are isomorphic as unrooted trees if and only if the tree is a primitive 1-hybridization network .",
    "the ` if ' part is clear .",
    "conversely , suppose that a 1-hybridization network is not primitive .",
    "then if @xmath7 and @xmath159 denote the two reticulation arcs , there is a vertex @xmath39 of @xmath0 that has a leaf @xmath131 as a descendant ( following a path of tree edges ) that is not a descendant of @xmath160 or @xmath40 .",
    "select leaves @xmath161 and @xmath30 that are descendants ( following a path of tree arcs ) of @xmath160 and @xmath40 , respectively .",
    "then for the two induced phylogenetic @xmath1-trees obtained from @xmath0 , one tree resolves the quartet @xmath162 as @xmath163 , while the other tree resolves the quartet as @xmath164 ( as above , the vertical bar here refers to the path that connects the pair of taxa on the left being vertex - disjoint from the path connecting the pair of taxa on the right ) .",
    "it follows that these two induced @xmath1-trees are not isomorphic as unrooted trees @xcite .",
    "[ cor : retic.near.root ] in a 1-hybridization network , with an edge weighting @xmath39 and a mixing distribution @xmath45 , the induced distance function @xmath67 is equal to @xmath66 for a phylogenetic @xmath1-tree if and only if the hybridization is between the two edges that are incident with the root .    by combining proposition  [ prophelps ] and lemma  [ lem3 ] .",
    "we have dealt with the case in which a network has a single hybridization and shown that for it to satisfy the four - point condition ( i.e. be a tree metric ) the hybridization must be in a particular position , namely next to the root ( the network must be primitive 1-hybridization network ) .",
    "this is because both quartet trees must agree , and the only way for this to occur is if the hybridization is in this position .    to deal with the case where the network has more than one hybridization",
    ", we require a further result .",
    "[ lems ] if a hybridization network @xmath0 has four leaves and two hybridization vertices then if we consider the ( at most four ) trees in @xmath23 and ignore their rooting , they produce exactly two unrooted quartet trees .",
    "this is an elementary check , as follows .",
    "there are only two 2-hybridization networks on four leaves , up to symmetry , namely those in fig .",
    "[ fig:2.retics ] .        resolving these hybridizations into the alternative unrooted quartet trees , we find that the first hybridization network only yields the unrooted quartet trees @xmath165 and @xmath166 , and the second yields @xmath165 and @xmath167 .    we can now prove theorem  [ thm ] .    _ part ( a ) _ : suppose @xmath37 is a binary tree metric .",
    "writing @xmath168 for a binary tree @xmath22 , select any interior vertex @xmath40 of @xmath22 , and consider the three edges @xmath169 that are incident with @xmath40 , their corresponding weights @xmath170 and @xmath171 and the rooted subtrees @xmath172 and @xmath173 that these edges are attached to , at the opposite end from @xmath40 , as in fig .",
    "[ fig:3subtrees]@xmath174 .",
    "let @xmath0 be the primitive 1-hybridization network that is obtained as follows : first , consider the rooted binary tree @xmath22 consisting of a root vertex attached by edges @xmath175 and @xmath176 to the roots of @xmath120 and @xmath121 .",
    "next , place reticulation arcs from ( a point on each of ) @xmath175 and @xmath176 to a reticulation vertex , and place a tree arc from this vertex to the root of @xmath173 .",
    "select any strictly positive value of @xmath29 with @xmath177 , and assign edge weights to @xmath0 as follows .",
    "to the two edges that are incident with the root vertex assign weight @xmath29 ; to the tree arcs that are incident with @xmath120 and @xmath121 assign weights @xmath178 and @xmath179 , respectively , and to the tree arcs incident with @xmath173 , assign the weight @xmath171 . to the reticulation arcs",
    "assign a uniform hybridization distribution ( @xmath180 ) ( see fig .",
    "[ fig:3subtrees]@xmath181 ) .",
    "then it can be checked that @xmath0 , together with this arc weighting and hybridization distribution , gives a distance function that coincides exactly with @xmath37 .",
    "represents rooted subtrees of @xmath22 . as in the proof of theorem  [ thm ] part  ( a )",
    ", we have an unrooted tree and a primitive 1-reticulated network with the same average distance function . ]    _ part ( b ) _ : suppose a network @xmath0 has more than one hybridization .",
    "we first consider the case where there is at least one reticulation arc @xmath7 whose source vertex ( @xmath182 ) lies below a non - root vertex @xmath39 that has two outgoing tree arcs .",
    "let @xmath159 be the other reticulation arc of @xmath0 that ends at reticulation vertex @xmath40 .",
    "we will construct a quartet of leaves that give rise to a non - primitive 1-hybridization network .",
    "let @xmath183 and @xmath184 be three leaves obtained by following tree arcs from @xmath185 and @xmath186 , respectively ( every internal vertex has at least one outgoing tree arc by the definition of a reticulation network , part ( v ) ) . choose a fourth leaf @xmath37 that is reached by an arc from the root that does not pass through @xmath182 or @xmath186 .",
    "this can always be done ; consider two cases .",
    "first , if @xmath39 lies above @xmath186 as well as @xmath182 , then paths from the root that do not go through @xmath39 will also not go through @xmath182 or @xmath186 . alternatively , there is a path from the root through @xmath39 that goes down the `` other '' tree arc from @xmath39 ( the one not leading to @xmath182 ) that will not pass through @xmath186",
    ". the restrictions of @xmath0 to @xmath10 in these two cases are shown in figure  [ fig : placing.d ] . in either case , the restriction is a 1-hybridisation network that is not primitive , and so , by corollary  [ cor : retic.near.root ] , does not induce a tree metric on @xmath10 . thus @xmath84 can not be a tree metric on @xmath1 .    , showing the restriction of @xmath0 to @xmath10 .",
    "@xmath174 shows the case that @xmath39 is above both @xmath182 and @xmath186 , and @xmath181 shows the case @xmath39 is above @xmath182 but not @xmath186 . ]",
    "thus , we may suppose that if @xmath0 has more than one hybridisation , then none of the source vertices of any reticulation arc lie below any non - root vertex that has two outgoing tree arcs .",
    "that is , the source vertices of all reticulation arcs lie below either the root , or another source vertex of a reticulation arc ( if a non - root vertex does not have two outgoing tree arcs , then it must have a reticulation arc ) .",
    "another way to view this is that as one proceeds along any path from the root to a leaf , once one encounters a tree vertex one never encounters another reticulation vertex .",
    "this forces the reticulation vertices to be near the root , and for there to be a quartet in which at least two hybridizations appear ( see figure  [ fig:2.retics ] ) .",
    "therefore , since @xmath187 ( inequality  ) , exactly two hybridizations occur .",
    "such a quartet can be chosen simply by a suitable choice of leaves . by lemma  [ lems ] and proposition  [ prophelps ]",
    "this implies that @xmath80 restricted to this quartet is not a tree metric on that quartet , which violates the assumption that @xmath80 is a tree metric on all of @xmath1 .",
    "thus , @xmath0 must be a 1-hybridization network .",
    "lemma  [ lem3 ] and proposition  [ prophelps](b ) now imply that @xmath0 must also be primitive .",
    "this completes the proof .",
    "we thank the two anonymous reviewers for some helpful comments on an earlier version of this manuscript .",
    "the first author thanks the australian research council ( via ft100100898 ) and the second author thanks the nz marsden fund and allan wilson centre for helping to fund this work ."
  ],
  "abstract_text": [
    "<S> hybrid evolution and horizontal gene transfer ( hgt ) are processes where evolutionary relationships may more accurately be described by a reticulated network than by a tree . in such a network , there will often be several paths between any two extant species , reflecting the possible pathways that genetic material may have been passed down from a common ancestor to these species . these paths will typically have different lengths but an ` average distance ' can still be calculated between any two taxa . in this article </S>",
    "<S> , we ask whether this average distance is able to distinguish reticulate evolution from pure tree - like evolution . </S>",
    "<S> we consider two types of reticulation networks : hybridization networks and hgt networks . </S>",
    "<S> for the former , we establish a general result which shows that average distances between extant taxa can appear tree - like , but only under a single hybridization event near the root ; in all other cases , the two forms of evolution can be distinguished by average distances . for hgt networks , we demonstrate some analogous but more intricate results .    </S>",
    "<S> * keywords : * phylogeny ; reticulation network ; hybridization ; horizontal gene transfer ; distance measures . </S>"
  ]
}