{
  "article_text": [
    "the recent paper by dunkel and hilbert titled `` consistent thermostatistics forbids negative absolute temperatures '' @xcite has triggered a vigorous debate on whether the boltzmann entropy ( alias the surface entropy , eq .",
    "[ eq : somega ] ) or the gibbs entropy ( alias the volume entropy , eq .",
    "[ eq : somega ] ) is the more appropriate expression for the thermodynamic entropy of thermally isolated mechanical systems @xcite .",
    "the thermodynamic consistency of the gibbs entropy has been a leitmotiv that sporadically recurred in the classical statistical mechanics literature .",
    "it started with helmholtz @xcite , boltzmann @xcite , and gibbs @xcite , it continued with p. hertz",
    "@xcite einstein @xcite , and others @xcite , until it has been reprised recently by various authors @xcite .",
    "this line of research culminated with the work of ref .",
    "@xcite , showing that the gibbs entropy complies with all known thermodynamic laws and unveiling the mistakes apparently incurred into the arguments of its opponents @xcite .    while the work of ref .",
    "@xcite is characterised by a top - down approach ( namely , one postulates an entropy expression and then investigates compliance with the thermodynamic laws ) here we adopt instead a bottom - up approach : we begin from the thermodynamic laws and construct the expression of the microcanonical entropy on them .",
    "in particular we base our construction on the following two fundamental pillars of thermodynamics .",
    "1 ) the second law of thermodynamics as formulated by clausius for quasi - static processes , namely , @xmath4 , which says that @xmath5 is an integrating factor for @xmath6 , and identifies the entropy with the associated primitive function @xmath7 .",
    "2 ) the equation of state of an ideal gas @xmath8 .    our construction , based on the mathematics of differential forms , leads uniquely to the gibbs entropy ; see sec .",
    "[ sec : construction ] . as a consequence",
    "the adoption of any expression of entropy other than the gibbs entropy , e.g. , the boltzmann entropy , may lead to inconsistency with the fundamental pillars .",
    "this will be illustrated with a macroscopic collection of spins in a magnetic field . as we will see the boltzmann entropy severely fails to predict the correct value of the magnetization , and",
    "even predicts a nonexistent phase transition in the thermodynamic limit , see sec .",
    "[ subsec : failure ] .",
    "this provides a compelling reason for discarding the boltzmann entropy at once .",
    "the present work thus complements the work of ref .",
    "@xcite by stating not only the compliance of the gibbs entropy with the thermodynamic laws , but also its _ necessity _ and _ uniqueness _ : thermodynamic entropy has to be expressed by means of gibbs formula and no other expression is admissible .",
    "together with ref .",
    "@xcite the present work appears to settle the debated issue .",
    "we recall the definitions of boltzmann and gibbs entropies within the microcanonical formalism @xcite : @xmath9\\label{eq : somega}\\ , , \\\\",
    "s_g(e,\\bm{\\lambda } )   & = k_b \\ln \\omega(e,\\bm{\\lambda } ) \\label{eq : somega } \\ , , \\end{aligned}\\ ] ] where @xmath10 \\label{eq : phi}\\end{aligned}\\ ] ] denotes the volume of the region of the phase space of the system with energy not above @xmath11 .",
    "the symbol @xmath12 stand for some arbitrary constant with units of energy . here",
    "@xmath13 , denotes the hamilton function of either a classical or a quantum system with degrees of freedom @xmath14 and @xmath15 denotes external parameters , e.g. the volume of a vessel containing the system or the value of an applied magnetic or electric field @xcite .",
    "@xmath16 is their number . in the case of continuous classical systems the symbol @xmath17 stands for an integral over the phase space normalized by the appropriate power of planck s constant and possible symmetry factors . for classical discrete systems",
    ", @xmath17 denotes a sum over the discrete state space . for quantum systems @xmath17",
    "is the trace over the hilbert space .",
    "the symbol @xmath18 stands for the heaviside step function .",
    "the symbol @xmath19 stands for the density of states , namely the derivative of @xmath20 with respect to @xmath11 : @xmath21 = \\frac{\\partial \\omega(e,\\bm{\\lambda } ) } { \\partial e}\\ , .",
    "\\label{eq : omega}\\end{aligned}\\ ] ] here it is assumed that the spectrum is so dense that the density of states can be considered a smooth function of @xmath11 .",
    "the main objective is to link thermodynamic observables , i.e. the forces @xmath22 and temperature @xmath23 , to the quantities which naturally pertain to both the mechanical hamiltonian description and the thermodynamic description , i.e. , the energy @xmath11 and the external parameters @xmath24 .",
    "as we will see the entropy , @xmath7 will follow automatically and uniquely once the @xmath22 s and @xmath23 are linked .",
    "we begin with the thermodynamic forces @xmath22 , whose expression is universally agreed upon @xcite : @xmath25 with @xmath26 denoting the ensemble average . within the microcanonical framework these",
    "are expressed as : @xmath27 } {   \\omega(e,\\bm{\\lambda } ) } \\right ) \\ , .",
    "\\label{eq : fmicro}\\end{aligned}\\ ] ]    with the expression of @xmath28 we can construct the differential form representing heat : @xmath29 @xmath6 is a differential form in the @xmath30 dimensional space @xmath31 .",
    "it is easy to see that , in general @xmath6 is not an exact differential ; see , e.g. , ref .",
    "@xcite .",
    "before we proceed it is important to explain the meaning of @xmath32 within the microcanonical formalism .",
    "the idea behind the microcanonical ensemble is that @xmath11 and @xmath24 are controllable parameters .",
    "and @xmath24 are controllable parameters in the canonical formalism ] accordingly , if the system is on an energy surface identified by @xmath31 , the idea is that the experimentalist is able to steer it onto a nearby energy shell @xmath33 . in practice",
    "this is can be a difficult task .",
    "it can be accomplished , in principle , in the following way : the experimentalist should first change the parameters by @xmath34 in a quasi - static way .",
    "this induces a well defined energy change @xmath35 , which is the work done on the system .",
    "this brings the system to the energy shell @xmath36 . to bring the system to the target shell @xmath33 the experimentalist must now provide the energy @xmath37 by other means while keeping the @xmath24 fixed .",
    "for example she can shine targeted amounts of light on the system , from a light source .",
    "after the energy @xmath37 is absorbed by the system ( or emitted , depending on its sign ) , no other interaction occurs and the system continues undisturbed to explore the target shell @xmath33 . in this framework",
    "the light source acts as a reservoir of energy , and the quantity @xmath38 , identified as heat , represents the energy it exchanges .",
    "according to the second law of thermodynamics in the formulation given by clausius the inverse temperature @xmath5 is an integrating factor for @xmath6 .",
    "this fundamental statement is often called the _ heat theorem _ @xcite .",
    "we recall that an integrating factor is a function @xmath39 such that @xmath40 equals the total differential @xmath41 of some function @xmath42 called the associated primitive , or in brief , just the primitive .",
    "primitives are determined up to an unimportant constant , which we will disregard in the following .",
    "entropy is defined in thermodynamics as the primitive associated with clausius s integrating factor @xmath5 @xcite : @xmath43 in searching for thermodynamically consistent expressions of temperature within the microcanonical formalism , one should therefore look among the integrating factors of the microcanonically calculated heat differential in ( [ eq : deltaq ] ) . it must be remarked that it is not obvious that one integrating factor exists , because the existence of integrating factors is not guaranteed in spaces of dimensions higher than @xmath44 .",
    "so the existence of a mechanical expression for thermodynamic temperature ( hence of the entropy ) is likewise not obvious .",
    "it turns out however that an integrating factor for the differential in ( [ eq : deltaq ] ) always exists . finding it is straightforward if one re - writes the forces in the following equivalent form @xmath45 } {   \\omega(e,\\bm{\\lambda } ) } \\right ) \\nonumber\\\\ & =   \\frac{1}{\\omega(e,\\bm{\\lambda } ) } \\tr\\ , \\left ( \\frac{\\partial \\theta[e - h(\\bm{\\xi};\\bm{\\lambda})]}{\\partial \\lambda_i}\\right ) \\nonumber \\\\ & = \\frac{1}{\\omega(e,\\bm{\\lambda } ) } \\frac{\\partial \\omega(e,\\bm{\\lambda})}{\\partial \\lambda_i}\\ , .",
    "\\label{eq : fomega}\\end{aligned}\\ ] ] this follows from the fact that dirac s delta is the derivative of heaviside s step function . with this , eq . ( [ eq : deltaq ] ) reads @xmath46 it is now evident that @xmath47 is an integrating factor : @xmath48 @xmath2 being the associated primitive .",
    "this does not mean that @xmath49 should be identified with temperature and accordingly @xmath2 with entropy .",
    "in fact if an integrating factor exists , this identifies a whole family of infinitely many integrating factors .    to find the family of integrating factors , consider any differentiable function @xmath50 with non null derivative @xmath51 .",
    "its total differential reads : @xmath52   \\delta q\\ , .",
    "\\label{eq : dg}\\end{aligned}\\ ] ] this means that any function @xmath39 of the form @xmath53 is an integrating factor for the heat differential @xmath6 , and @xmath50 is the associated primitive . in fact",
    "all integrating factors must be of the form in eq .",
    "( [ eq : beta ] ) , which is equivalent to saying that all associated primitives must be of the form @xmath54 to prove that all primitives must be of the form in eq .",
    "( [ eq : g(phi ) ] ) we consider the adiabatic manifolds , namely the @xmath16 dimensional manifolds in the space @xmath31 identified by the condition that @xmath55 , i.e. , @xmath56 .",
    "note that the density of states is a strictly positive function @xmath57 .",
    "this is because increasing the energy results in a strictly larger enclosed volume in the phase space .",
    "thus , the adiabatic manifolds are characterised by the condition @xmath58 , ( i.e. , any path occurring on them involves no heat exchanges ) , and each value of @xmath2 identifies one and only one adiabatic manifold .",
    "any primitive @xmath42 associated with an integrating factor @xmath59 stays constant on the adiabatic manifolds : @xmath60 unless @xmath59 diverges , which we exclude here .",
    "hence the only way by which any primitives @xmath42 and @xmath20 can both be constant on all adiabatic manifolds is that @xmath61 is a function of @xmath2 , as anticipated .",
    "note that this rules out automatically the surface entropy @xmath62 $ ] because , in general , the density of states can not be written as a function of the phase volume @xmath20 .",
    "this is clear for example in the case of an ideal monoatomic gas in a vessel of volume @xmath63 , for which @xmath64 and @xmath65 @xcite ; see below .    our derivation above tells us that the second law requires that the entropy , which is one of the primitives , has to be a function @xmath50 of the phase volume , but does not tell us which function that is . for",
    "that we need to identify which , among the infinitely many integrating factors , @xmath66 corresponds to clausius s notion of temperature .",
    "we remark that once the function @xmath67 is chosen , it has to be one and the same for all systems .",
    "this is because by adjusting the external parameters @xmath24 , whose number and physical meaning is completely unspecified , one can transform any hamiltonian into any other .",
    "this fact reflects the very essence of clausius s heat theorem , namely , that there exists a unique and universal scale of temperature which is one and the same for all systems @xcite .",
    "we proceed then to single out the function @xmath67 that is consistent with the notion of temperature of an ideal monoatomic gas in a vessel of volume @xmath63 , taking its equation of state @xmath68 as the definition .",
    "the hamilton function of an ideal monoatomic gas reads @xmath69 with @xmath70 representing the box potential confining the gas within the volume @xmath63 .",
    "the phase volume reads @xcite @xmath71 hence , using eq .",
    "( [ eq : fomega ] ) , we obtain for the pressure , @xmath72 : @xmath73 . confronting this with the ideal gas law",
    "we obtain @xmath74 consistently with what is known from thermodynamics . since @xmath75 in this case",
    ", we readily recognize that @xmath76 , namely , @xmath77 that is @xmath78 , which singles out the gibbs entropy , @xmath79 as the primitive associated with the integrating factor corresponding to the thermodynamic absolute temperature @xcite .    in sum : if one accepts the microcanonical expression ( [ eq : f ] ) of the forces , the gibbs entropy represents the _ only _ expression of thermodynamic entropy which is consistent with the second law of thermodynamics , eq .",
    "( [ eq : deltaq ] ) , and the equation of state of the ideal gas .",
    "as mentioned above the density of states is definite positive @xmath80 , also , by definition , the volume @xmath2 is non - negative .",
    "hence their ratio @xmath81 is non - negative .",
    "this means that , within the _ microcanonical _ formalism , negative temperatures are inadmissible .",
    "often the present microcanonical scenario is confused with the more common canonical scenario , where the system stays in a canonical state at all times during a transformation , e.g. , ref .",
    "this is unfortunate because , as we see below , microcanonical and canonical descriptions are not equivalent for those finite spectrum systems usually discussed in this context .",
    "the same construction presented above can be repeated for systems obeying statistics other than microcanonical @xcite . if applied to the canonical ensemble , @xmath82 , ( with @xmath83 being the canonical partition function ) the canonical expression @xmath84 for the forces , along with the equation of state of the ideal gas , _",
    "uniquely _ identifies the canonical parameter @xmath59 as the integrating factor , and its associated primitive @xmath85 as the only thermodynamically consistent expressions of inverse temperature and entropy within the canonical formalism .",
    ", that is , the canonical entropy coincides with the gibbs - von neumann information of the canonical distribution @xmath86 . ] in the canonical formalism nothing formally constraints the sign of @xmath59 to be definite .",
    "a spin system in a canonical state at negative @xmath59 will have a positive internal energy @xmath87 .",
    "the same system in the microcanonical state of energy @xmath88 will , however , have a positive thermodynamic temperature .",
    "this evidences the inequivalence of canonical and microcanonical ensembles in systems with a finite spectrum .      in an attempt to justify the correctness of the boltzmann entropy , frenkel and warren @xcite ,",
    "provided a construction which leads to the boltzmann entropy .",
    "it must be stressed that the construction presented by frenkel and warren @xcite is approximate , and valid only under the assumption that the saddle point approximation holds .",
    "this approximation holds only when the density of states increases exponentially with the energy . under this assumption , however , the density of states @xmath47 and phase volume @xmath2 coincide . so the construction of frenkel and warren",
    "@xcite can not shed light onto which entropy expression is appropriate in the case when they do not coincide , which is indeed the very case of practical interest .",
    "in contrast , the present construction is exact , i.e. , it holds regardless of the functional dependence of the density of states on energy .",
    "accordingly it says that in any case , independent of whether equivalence of the two entropies holds , the volume entropy is the consistent choice .      for continuous classical hamiltonian systems ,",
    "thanks to the equipartition theorem @xcite , the thermodynamic temperature @xmath23 is identical with the equipartition temperature @xmath89 : @xmath90 where the average is the microcanonical average on the shell @xmath31 .",
    "this provides further evidence that the choice @xmath91 conforms to the common notion of temperature of any classical system , not just the ideal monoatomic gas .",
    "we further remark that the equipartition theorem also identifies the temperature @xmath92 in eq .",
    "( [ eq : partiallogphi ] ) as an intensive quantity , namely a property that is equally shared by all subsystems @xcite .",
    "we emphasize that at variance with previous approaches to the foundations of the gibbs entropy @xcite , which postulated that the thermodynamic temperature is the equipartition temperature , here we have instead postulated only that temperature is the integrating factor that is consistent with the ideal gas law and have obtained the coincidence with the equipartition temperature as an aftermath .",
    "the advantage of the present approach is evident : it applies to any microcanonical system , even those for which there is no equipartition theorem ( e.g. , quantum systems ) .      at variance with other approaches we chose as starting point the expression for the microcanonical forces ( [ eq : fmicro ] ) which is universally agreed upon and built our construction on that firm ground .",
    "the salient point of our argument is the identity ( [ eq : fomega ] ) expressing the microcanonical forces in terms of the partial derivatives of @xmath2 .",
    "the identity ( [ eq : fomega ] ) alone has as a consequence that the entropy must be of the form @xmath93 with some @xmath67 with non null derivative @xmath51 .",
    "in fact , for any @xmath94 one finds the forces @xmath95 , to be identical to the microcanonical forces @xmath22 , eq . ( [ eq : fmicro ] )",
    "@xmath96 here @xmath97 is a shorthand notation for @xmath98 .",
    "if one employs an entropy expression that is not of the form @xmath50 , e.g. , the boltzmann entropy , one can well end up in wrongly evaluating the forces .",
    "this happens , for example , in the case of a large collection of @xmath99 non interacting @xmath100 spins in a magnetic field @xmath101 , at energy @xmath11 @xcite , that is the prototypical example of the emergence of negative boltzmann temperature @xcite .",
    "the hamiltonian reads @xcite @xmath102 here @xmath101 plays the role of the external parameter @xmath103 , @xmath104 is @xmath105 depending on whether the spin points parallel ( up ) or antiparallel ( down ) to the field , and @xmath106 is the magnetic moment of each spin . at energy @xmath11 , the magnetization is given by ( [ eq : fmicro ] ) : @xmath107 the number of states with @xmath108 spins up is @xmath109 the number of states with no more than @xmath108 spins up is @xmath110 using the relation @xmath111 , and treating @xmath11 as a continuous variable under the assumption that @xmath112 is very large , according to standard procedures , we observe that @xmath113 denotes the number of states with energy between @xmath114 and @xmath115 .",
    "the density of states is therefore : @xmath116 and the number of states with energy below @xmath11 is @xmath117     and magnetization @xmath118 of a system of @xmath112 non - interacting @xmath100 spins , as predicted by the boltzmann entropy @xmath119 , and the gibbs entropy @xmath120 here @xmath121 .",
    "only gibbs magnetization conforms with the physical magnetization @xmath122 . ]",
    "figure [ fig : fig1 ] shows the gibbs and boltzmann temperatures and magnetizations as functions of @xmath11 calculated with @xmath123 for larger values of @xmath112 qualitatively similar plots are obtained .",
    "a very unphysical property of @xmath124 is that with the flip of a single spin it jumps discontinuously from @xmath125 to @xmath126 in the thermodynamic limit .",
    "the usual reply to such a criticism would be , following @xcite , to say that one should look instead at the quantity @xmath127 , which displays no divergence .",
    "no way out is however possible if one considers the magnetization . as can be seen from the figure",
    ", only @xmath120 reproduces the exact result , eq .",
    "( [ eq : exact ] ) whereas the magnetization given by @xmath119 is drastically off , and even predicts a nonexistent and unphysical phase transition , in the thermodynamic limit , where the magnetization abruptly jumps from @xmath126 to @xmath125 as a single spin flips from @xmath128 to @xmath129 .",
    "the results in the figure are also corroborated by analytical calculations .",
    "using eqs .",
    "( [ eq : tmb ] ) and ( [ eq : tmg ] ) with eqs .",
    "( [ eq : omega ] ) and ( [ eq : omega ] ) we obtain @xmath130 thus the discrepancy @xmath131 between the boltzmann magnetization and the physical magnetization is given by the negative boltzmann thermal energy rescaled by the applied magnetic field : @xmath132 since @xmath124 diverges around the zero energy in the thermodynamic limit , so does the discrepancy @xmath131 .",
    "note that the discrepancy also diverges as the intensity of the applied magnetic field decreases .",
    "it is interesting to notice that , while in the thermodynamic limit @xmath133 approaches @xmath124 for @xmath134 , the same is not true for @xmath135 , which distinctly deviates from @xmath136 for both @xmath137 and @xmath134 .",
    "this unveils the fact , apparently previously unnoticed , that boltzmann and the gibbs entropy are not equivalent even in the lower part of the spectrum of large spin systems .",
    "lines do not coincide with the adiabats @xmath138 . ]",
    "equation ( [ eq : mb ] ) is a special case of a general relation linking the boltzmann forces ( @xmath139 ) and the gibbs forces @xmath140 ( i.e. , the thermodynamic forces @xmath141 ) , reading : @xmath142 this equation accompanies a similar relation linking boltzmann and gibbs temperatures @xmath143 with @xmath144 being the heat capacity",
    ". equations ( [ eq : mbvsmg ] ) and ( [ eq : tbvstg ] ) follow by taking the derivative with respect to @xmath11 of @xmath22 and @xmath133 respectively .    the reason for the thermodynamic inconsistency of @xmath119 ( consistency of @xmath120 ) can also be understood in the following way .",
    "consider the heat differential @xmath145 .",
    "clearly @xmath146 is an integrating factor : @xmath147 .",
    "hence @xmath148 is a primitive .",
    "accordingly the adiabats are determined by the equation @xmath149 and the entropy must be some monotonic function of @xmath150 , that is of @xmath151 . by inspecting eqs .",
    "( [ eq : omega ] ) and ( [ eq : omega ] ) we see that the phase volume @xmath2 is a monotonic function of @xmath151 while the density of states @xmath47 is not a function of @xmath151 ; hence @xmath119 is thermodynamically inconsistent .",
    "the inequivalence of @xmath120 and @xmath119 is most clearly seen by plotting the iso-@xmath119 lines in the thermodynamic space @xmath152 ; see fig .",
    "[ fig : fig2 ] .",
    "note that the adiabats , eq .",
    "( [ eq : adiabats ] ) are straight lines passing through the origin .",
    "the iso-@xmath119 lines instead predict a completely different structure of the adiabats .",
    "note in particular that the iso-@xmath119 lines are closed .",
    "this evidences their thermodynamical inconsistency .",
    "summing up : the boltzmann entropy severely fails to accomplish one of its basic tasks , namely , reproducing the correct value of the thermodynamic forces and of heat .",
    "we have shown that , within the microcanonical formalism there is only one possible choice of entropy that is consistent with the second law and the equation of state of an ideal gas , namely , the gibbs entropy .",
    "discarding the gibbs entropy in favour of the boltzmann entropy , may accordingly result in inconsistency with either of those two pillars .",
    "for the great majority of large thermodynamic systems , gibbs and boltzmann entropies practically coincide ; hence there is no problem regarding which we choose .",
    "however , there are cases when the two do not coincide : examples are spin systems @xcite and point vortex gases @xcite , where boltzmann temperature , in disagreement with gibbs temperature , has no definite sign , and the boltzmann entropy can largely fail to predict correct values of thermodynamic forces .    it must be stressed that the demonstrated failure of the boltzmann entropy to reproduce the thermodynamic forces is not restricted to small systems , where the failure was already known to occur @xcite , but survives , and even becomes more prominent , in the thermodynamic limit , where the boltzmann entropy predicts an unphysical and nonexistent phase transition in the magnetization of a system of non - interacting spins in a magnetic field .    in the light of the present results , together with the established fact that the gibbs entropy conforms with all thermodynamic laws @xcite ,",
    "the issue of which entropy expression is correct is apparently now fully and ultimately settled .",
    "the author is indebted to jrn dunkel , stefan hilbert , peter talkner and especially peter hnggi , for the many discussions we had on this topic for years .",
    "this research was supported by a marie curie intra european fellowship within the 7th european community framework programme through the project nequflux grant no . 623085 and by the cost action no .",
    "mp1209 `` thermodynamics in the quantum regime . ''"
  ],
  "abstract_text": [
    "<S> a question that is currently highly debated is whether the microcanonical entropy should be expressed as the logarithm of the phase volume ( volume entropy , also known as the gibbs entropy ) or as the logarithm of the density of states ( surface entropy , also known as the boltzmann entropy ) . rather than postulating them and investigating the consequence of each definition , </S>",
    "<S> as is customary , here we adopt a bottom - up approach and construct the entropy expression within the microcanonical formalism upon two fundamental thermodynamic pillars : ( i ) the second law of thermodynamics as formulated for quasi - static processes : @xmath0 is an exact differential , and ( ii ) the law of ideal gases : @xmath1 . </S>",
    "<S> the first pillar implies that entropy must be some function of the phase volume @xmath2 . </S>",
    "<S> the second pillar singles out the logarithmic function among all possible functions . </S>",
    "<S> hence the construction leads uniquely to the expression @xmath3 , that is the volume entropy . as a consequence </S>",
    "<S> any entropy expression other than that of gibbs , e.g. , the boltzmann entropy , can lead to inconsistencies with the two thermodynamic pillars . </S>",
    "<S> we illustrate this with the prototypical example of a macroscopic collection of non - interacting spins in a magnetic field , and show that the boltzmann entropy severely fails to predict the magnetization , even in the thermodynamic limit . </S>",
    "<S> the uniqueness of the gibbs entropy , as well as the demonstrated potential harm of the boltzmann entropy , provide compelling reasons for discarding the latter at once . </S>"
  ]
}