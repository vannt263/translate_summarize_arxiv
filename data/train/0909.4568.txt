{
  "article_text": [
    "the recent discovery of graphene  @xcite  a single layer of graphite representing first truly two - dimensional crystal  @xcite  has opened new avenues for carbon nanoelectronics .  @xcite the limits on continued scaling of present silicon - based electronics are set by the fundamental physical effects  @xcite ( such as quantum tunneling of carriers through the gate insulator and through the body - to - drain junction ; dependence of the subthreshold behavior on temperature ; and discrete doping effects ) ,",
    "the most detrimental being power dissipated in various leakage mechanisms .",
    "this is especially dangerous for minimal field - effect transistor ( fet ) dimensions and oxide thicknesses . following the discovery of carbon nanotubes ( cnts ) , which are rolled up sheets of graphene ,",
    "the exploration of carbon nanoelectronics over the past decade as a strong contender to aging silicon technology has been centered around semiconducting cnts as the new type of channel for fet that also makes possible unconventional transistor designs .",
    "@xcite    single - wall cnts bring their unique features into nanoelectronics arena , such as ballistic transport or diffusion with very long mean free paths , high mobility at room temperature due to suppressed electron  acoustic - phonon scattering , current carrying capacities of the order of @xmath3 a/@xmath4 , and one of the largest known specific stiffness .",
    "@xcite however , full integration of cnts into complex high - performance nanoelectronic devices has been thwarted by several unresolved issues , such as : ( i ) electronic inhomogeneity where random mixture of semiconducting and metallic cnt ( due to uncontrolled distribution of diameters and chirality in current synthesis methods ) degrade device performance ; ( ii ) difficulty in aligning and patterning through standard lithography methods suitable for high - volume production because of cnts not being flat ; and ( iii ) extreme sensitivity to minute changes in their local chemical environment .",
    "@xcite    graphene shares many of the features of cnt , offering large critical current densities  @xcite and intrinsic mobility limit @xmath5 @xmath4/vs at room temperature being higher than any of the known inorganic semiconductors .",
    "@xcite such high mobility promises near - ballistic transport and ultrafast switching .",
    "thus , from its inception ,  @xcite application of graphene in fet devices has been a major experimental endeavor .",
    "@xcite    however , all graphene - fets fabricated with wide sheets  @xcite have poor ratio of on - state current @xmath6 to off - state current @xmath7 due to the bulk graphene samples behaving as a zero gap semiconductor .",
    "nevertheless , recent breakthrough fabrication ( via chemical derivation ,  @xcite stm tip drawing  @xcite and cnt unrolling  @xcite ) of sub-10-nm - wide graphene nanoribbons ( gnrs ) , _ all of which are semiconducting _ , has led to the development of  @xcite with @xmath8 ratio up to @xmath9 which is suitable for logic devices .    moreover , unusual band structure of graphene has generated a plethora of proposals to create devices that have no analog in silicon - based electronics .",
    "the new functionality brought by the gnr electronic structure ,  @xcite such as `` valley valves ''  @xcite or difference in transmission properties of reflectionless @xmath10 and highly reflective @xmath11 turns made of gnrs with zigzag edges ,  @xcite can only be captured by quantum transport analysis . at the same time ,",
    "equilibrium interatomic charge transfer and chemical doping by different atoms  @xcite or atomic groups  @xcite that passivate gnr edges require to model explicitly atomistic structure and corresponding charge density within the device .",
    "these tasks are beyond the scope of popular tight - binding models  @xcite ( projected onto the basis of single @xmath12-orbital per carbon atom ) , or even simpler continuous weyl hamiltonian describing massless dirac fermions as low - energy quasiparticles close to the charge neutrality point .",
    "@xcite furthermore , in the nonequilibrium state driven by the finite bias voltage one has to compute self - consistently charge redistribution and the corresponding electric potential in order to keep the gauge invariance  @xcite of the characteristics  @xcite intact .    finally ,",
    "virtually every experiment on graphene employees gate electrodes to move the fermi level away from the charge neutrality point or shift conduction from electron to hole carriers , so that self - consistent computation of the _ inhomogeneous _ charge distribution  @xcite induced by the gate voltage and its highly non - trivial effects on the band structure of gnrs  @xcite is necessary to understand device performance ( rather than using unrealistic constant shift of the on - site potential to simulate the presence of the gate electrode in the tight - binding models  @xcite ) .",
    "thus , the prime candidate capable of handling all of these issues within a unified quantum transport framework  @xcite is the nonequilibrium green function ( negf ) formalism  @xcite combined with the density functional theory ( dft ) in standard approximation schemes  @xcite ( such as lda , gga , or b3lyp ) for its exchange - correlation potential .",
    "the sophisticated algorithms  @xcite developed to implement the framework over the past decade can be encapsulated by the iterative self - consistent loop :  @xcite @xmath13 \\rightarrow { \\rm negf } \\rightarrow n^{\\rm out}({\\bf r}).\\ ] ] the loop starts from the initial input electron density @xmath14 @xmath15 employs some standard dft code  @xcite ( typically in the basis set of finite - range orbitals for the valence electrons which allows for faster numerics and unambiguous partitioning of the system into `` central region '' and the semi - infinite ideal leads ) to get the single particle hamiltonian [ is the dft mean - field potential due to other electrons with @xmath16 being the hartree and @xmath17 the exchange - correlation contribution ; @xmath18 is the external potential ] @xmath15 inversion of @xmath19 $ ] yields the retarded green function @xmath20 whose integration over energy determines the density matrix via negf - based formula :    @xmath21 f(e-\\mu_r )   - \\frac{1}{\\pi } \\int\\limits_{-\\infty}^{+\\infty}de \\ ,   { \\bf g}^r(e)\\cdot { \\rm im}\\ , [ { \\bm \\sigma}_{l}(e ) ] \\cdot { \\bf g}^a(e )   \\left[f\\left(e-\\mu_{l}\\right)-f\\left(e-\\mu_{r}\\right)\\right ] = { \\bm \\rho}_{\\rm eq } + { \\bm \\rho}_{\\rm neq}.\\ ] ]    the matrix elements are the new electron density as the starting point of the next iteration .",
    "this procedure is repeated until the convergence criterion @xmath22 is reached , where @xmath23 is a tolerance parameter .",
    "the representation of the retarded green function in the local orbital basis requires to compute the inverse matrix @xmath24 - { \\bm \\sigma}(e)]^{-1}.\\ ] ] the advanced green function matrix is defined as @xmath25^\\dagger$ ] .",
    "the non - hermitian matrix is the sum of the retarded self - energy matrices introduced by the `` interaction '' with the left [ @xmath26 and the right [ @xmath27 leads .",
    "these self - energies determine escape rates of electrons from the central region into the semi - infinite ideal leads , so that an open quantum system can be viewed as being described by the ( non - hermitian ) hamiltonian .",
    "the negf post - processing of the converged result of dft calculations makes it possible to obtain the current through a two - terminal device in terms of the landauer - type formula  @xcite @xmath28.\\ ] ] this integrates the self - consistent transmission function @xmath29 for electrons injected at energy @xmath30 to propagate from the left to the right electrode under the source - drain applied bias voltage @xmath31 . here",
    "@xmath32 is the submatrix of @xmath33 whose elements @xmath34 connect orbitals in the first lead supercell ( layer denoted as 1 ) of the extended central region `` sample + portion of the electrodes '' to the last lead supercell ( layer denoted as @xmath35 ) of the simulated region .",
    "the matrices @xmath36=-2{\\rm i m } \\ , { \\bm \\sigma}_{l , r}(e)$ ] account for the level broadening due to the coupling to the leads .",
    "@xcite a usual assumption about the leads is that the effect of the bias voltage can be taken into account by a rigid shift of their electronic structure , so that @xmath37 and @xmath38 are computed in equilibrium and then the shift @xmath39 is applied to their electronic structure to mimic the applied bias .",
    "the energy window for the integral in eq .",
    "( [ eq : iv ] ) is defined by the difference of fermi functions @xmath40 of macroscopic reservoirs into which semi - infinite ideal leads terminate .",
    "the formula  ( [ eq : iv ] ) is valid only for coherent transport , i.e. , assuming absence of dephasing  @xcite due electron - phonon or electron - electron interactions ( beyond those captured by the mean - field treatment  @xcite ) .",
    "thus , the most demanding computational task of the framework is the self - consistent evaluation of the density matrix @xmath41 whose different algorithmic steps have the following  @xcite _ computational complexity _",
    "@xcite in terms of the number of atoms @xmath42 :  @xcite ( _ i _ ) the computation @xmath43 of the effective potential for @xmath19 $ ] has complexity @xmath44 ; ( _ ii _ ) the second step , @xmath45 $ ] , has complexity @xmath46 ; ( _ iii _ ) usual computation of all elements of the retarded green function , @xmath19 \\rightarrow { \\bf g}^r$ ] , requires @xmath47 operations ; ( _ iv _ ) @xmath48 scales as @xmath46 ; and ( _ v _ ) the final step @xmath49 also has complexity @xmath46 .",
    "obviously , the bottleneck is set by the retarded green function computation .",
    "since computational codes  @xcite are developed and tested for small molecules attached to metallic electrodes ( where they are successful when coupling between the molecule and the electrodes is strong enough to diminish coulomb blockade effects  @xcite ) , they typically evaluate all elements of @xmath33 by inverting through eq .",
    "( [ eq : gr ] ) the hamiltonian of the extended molecule region . because this has to be done repeatedly through self - consistent loop  ( [ eq : scloop ] )",
    ", the number of atoms in the extended central region `` molecule + portion of the electrodes '' that can be simulated is limited to few hundreds .",
    "this bottleneck also prevents realistic modeling of single or multiple  @xcite gate electrodes  instead of an additional layer of atoms covering portion of the central region ,",
    "one typically employs a uniform electric field in the direction perpendicular to the transport .",
    "@xcite    a more subtle reason for the failure of conventionally implemented codes when applied to systems containing large number of atoms is the integration in the second term @xmath50 in eq .",
    "( [ eq : rho ] ) which must be performed along the real axis since the integrand is not analytic anywhere in the complex plan .",
    "although this integration is restricted by the fermi functions to a segment of the order of the applied bias voltage , a very fine integration grid must be used to capture locations of subband edges ( introduced by semi - infinite leads ) and broadened molecule orbitals where sharp peaks in the integrand occur .",
    "this problem is exacerbated in devices containing large number of atoms where the increasing number of such sharp peaks  due to van hove singularities in the density of states of the leads or quasi - bound states present when different contacts throughout the device are not perfectly transparent  can make it virtually impossible to converge @xmath50 .",
    "the present approach in algorithms to deal with this issue is to move the line of integration slightly into the complex plane .",
    "however , this effectively adds small imaginary part @xmath51 to the hamiltonian @xmath52 which , therefore , does not conserve current .",
    "for example , direct application of this procedure to experimental graphene devices , such as 100 nm long of ref .  , would lead to substantial difference between the total current in the left and the right leads .",
    "this issue is rarely discussed in the usual treatment of transport through relatively short molecules where such violation of current conservation is small .",
    "some recent attempts to solve it , such as locating the peaks due to quasibound states and patching the non - equilibrium density matrix integral,@xcite can not be applied to large systems with many such peaks .",
    "the peaks can be broadened by physical dephasing mechanisms due to electron - electron  @xcite or electron - phonon interactions ,  @xcite but this drastically changes the approach by requiring additional and computationally very expensive self - consistent loops to calculate extra self - energy functionals  @xcite due to interactions within the device for which the sparsity of the hamiltonian matrix becomes irrelevant .",
    "recent efforts  @xcite to replace some of the algorithms within the negf part of the scheme , such as unfavorable computational complexity of brute force matrix inversion  @xcite or the real - axis integration  @xcite in @xmath50 , have still not led to self - consistent electron density and transport calculations for systems composed of more than about a thousand of atoms .",
    "@xcite here we introduce modified scheme which is based on our novel algorithm for the integrations in eq .",
    "( [ eq : rho ] ) combined with the partitioning the nanostructure of arbitrary shape into slices containing much smaller number of atoms . the green function",
    "matrices of these slices , needed to obtain the electron density within the slice , are computed recursively with much more favorable computational complexity than @xmath47 .",
    "the number of iteration steps within the self - consistent loop is further reduced , in the case of nanodevices in equilibrium or in quasi - equilibrium situations ( e.g. , due to by non - zero gate voltage and zero or linear response bias voltage ) , via modified broyden mixing scheme for input and output charge density .",
    "we demonstrate the capability of our computational code , termed cannes ( carbon nanoelectronics simulator ) , to treat multi - terminal structures containing large number of atoms by computing the self - consistent electron density and conductance in the presence of the gate voltage in a graphene nanodevice whose extended central region is composed of @xmath2 carbon and hydrogen atoms .    the paper is organized as follows . sec .",
    "[ sec : algorithm ] elaborates on the `` pole summation '' algorithm for computing integrals in @xmath41 . in sec .",
    "[ sec : example ] we demonstrate efficiency of our approach by setting up a _ three - terminal _ fet - type device whose source and drain electrodes are made of zigzag graphene nanoribbon ( zgnr ) source and drain electrodes while its channel is an armchair gnr ( agnr ) of variable width and with sizable energy gap .",
    "the third electrode is gate modeled as a rectangularly - shaped layer of carbon atoms covering the fet channel .",
    "the dangling bonds of all graphene layers are terminated by hydrogen atoms .",
    "the dft part of the calculation is carried out using the self - consistent environment - dependent tight - binding model ( ) with four orbitals per carbon atom and one orbital per hydrogen atom , which is specifically tailored to simulate eigenvalue spectra , electron densities and coulomb potential distributions for carbon - hydrogen nanostructures .",
    "@xcite the combination of `` pole summation '' algorithm with the recursive green function formulas allows us to compute in sec .",
    "[ sec : example ] intricate electric potential distribution in the space around zgnr - agnr - zgnr fet device , as well as to demonstrate how much voltage has to be applied on the gate electrode to push the device from the off - state due to the gap of agnr into an on - state enabled by a single transport channel crossing the fermi level .",
    "the computed source - drain conductance as a function of the gate voltage also demonstrates that even at zero gate voltage there is a difference between the non - self - consistent and self - consistent conductance , where the latter takes into account charge transfer between different atomic species or different segments of the device .",
    "we conclude in sec .",
    "[ sec : conclusions ] .",
    "we rewrite the equilibrium contribution to the density matrix  ( [ eq : rho ] ) : @xmath53 f(\\mu , t , e),\\end{aligned}\\ ] ] in the form which emphasizes its dependence on the chemical potential @xmath54 and temperature @xmath55 , as well as that the lower limit of integration is the lowest energy at which @xmath56 \\neq 0 $ ] .",
    "as long as the end - point @xmath57 is selected  @xcite below the bottom of the valence band edge , there are no further poles in the integrand , and thus the expression is exact .",
    "although this looks obvious , it is important to point out that if the value @xmath58 is too small , and there are poles left outside of the contour , the corresponding poles will not be included in the integration .",
    "this causes charge to erroneously disappear from the system , which typically initiates an avalanche effect , pushing the poles even further out , and even more charge is lost , until the system is totally void of electrons . when this occurs , the calculation will actually converge trivially , but to a physically incorrect solution",
    "since diagonal matrix elements of @xmath20 are a rapidly varying function of energy , a direct integration along the real axis would be rather ineffective since its numerical accuracy is not sufficient to achieve convergence of the self - consistent electron density . instead",
    ", present computational codes  @xcite deform the integration contour into the upper complex half - plane @xmath59>0 $ ] , where the retarded green function is much smoother .",
    "this is allowed since @xmath20 is analytic in the upper complex half - plane ( all of its poles are slightly displaced below the real axis ) .",
    "the thick white line in fig .  [ fig : polesdensityplot ] designates typically chosen  @xcite integration contour .",
    "it consists of a semi - circular part @xmath60 and a horizontal line @xmath61 parallel to the real axis on the right which is positioned to enclose specific number @xmath62 of the fermi function poles @xmath63 while ensuring that @xmath60 and @xmath61 are sufficiently far away from the real axis so that the green function is smooth over both of these two segments [ the main variation of the integrand on @xmath61 comes from the fermi function @xmath0 which , therefore , can be used as a weight function in the quadrature  @xcite ] .",
    "the final expression for @xmath64 obtained in this procedure ( using the cauchy residue theorem for the closed contour @xmath60 + @xmath61 + vertical segment from @xmath61 to the real axis + portion of the real axis ) is : @xmath65,\\end{aligned}\\ ] ] where the smoothness of @xmath20 on @xmath66 contour is exploited to perform the approximate integration in the first term by using a quadrature with a small number of points .",
    "@xcite    obviously , it would be advantageous to compute integral in eq .",
    "( [ subeq : gintegral ] ) precisely and without worrying about proper selection of parameters for positioning @xmath60 and @xmath61 , via a simple summation over a finite set of complex energies akin to the second term of eq .",
    "( [ eq : smeagol ] ) . here",
    "we introduce such an algorithm which makes possible virtually exact evaluation of @xmath64 by `` pole summation . ''",
    "this algorithm is discussed separately for high temperatures ( and/or valence electrons ) in sec .",
    "[ subsec : hightvalence ] and low temperatures ( and/or core electrons ) in sec .",
    "[ subsec : lowtcore ] .      the algorithm for equilibrium density matrix computation discussed in this section can be used when the inequality @xmath68 is satisfied . if eq .",
    "( [ subeq : emintoktratio ] ) is not satisfied , a slightly more elaborate algorithm described in the next sec .",
    "[ subsec : lowtcore ] is needed .",
    "let us define the desired precision through the non - negative number @xmath69 , such that the magnitude of the relative error is @xmath70 . in most cases the machine precision roughly corresponds to @xmath71 , while the practical range of @xmath69 is usually between 21 and 27 .",
    "we start by introducing a function @xmath72 @xmath73 where all its arguments except @xmath30 are limited to real domain and satisfy the following inequalities ( @xmath74 is the boltzmann constant and @xmath75 ) :    [ subeq : ftildaparameters ] @xmath76    the choice of parameters given by eq .",
    "( [ subeq : ftildaparameters ] ) guarantees that for real @xmath77 the function @xmath72 deviates from @xmath78 by no more than @xmath79 . therefore the replacement of @xmath78 with @xmath72 in the integrand of eq .",
    "( [ subeq : gintegral ] ) will result in the relative error less than @xmath79 . in the following",
    "we assume that @xmath80 so that @xmath81 .",
    "thus , for all practical purposes we can state that ( all arguments except @xmath30 are omitted for brevity ) @xmath82.\\end{aligned}\\ ] ] the poles and residues of the first term in the product on the right - hand side of eq .",
    "( [ subeq : ftildadefinition ] ) are given by    [ eq : polesandresiduesim ] @xmath83_{z=\\tilde{z}_{\\rm im}^{(n ) } }   =   -i",
    "k_b \\tilde{t}_{\\rm im}. \\label{subeq : residuesimaginary}\\end{aligned}\\ ] ]    where @xmath84 is an integer .",
    "similarly , the poles and residues of @xmath85 in the second term are    [ eq : polesandresiduesphysical ] @xmath86_{z = z^{(n ) } } = -k_b t , \\label{subeq : residuesphysical}\\end{aligned}\\ ] ]    and for @xmath87 they are    [ eq : polesandresiduesrealficticious ] @xmath88_{z=\\tilde{z}_{\\rm re}^{(n ) } } = k_b \\tilde{t}_{\\rm re}. \\label{subeq : residuesrealficticious}\\end{aligned}\\ ] ]        inequalities ( [ subeq : ftildaparameters ] ) provide sufficient freedom to prevent the coincidence of the poles @xmath89 , @xmath90 , and @xmath91 ( @xmath92 @xmath93 , @xmath94 , and  @xmath84 ) .",
    "thus , @xmath72 only has first order poles with residues given by :      in the upper complex half - plane the residues ( [ subeq : residuesimaginaryftilda ] ) decay exponentially if @xmath96 lies outside the interval @xmath97 $ ] , and the residues ( [ subeq : residuesphysicalftilda ] ) , ( [ subeq : residuesrealficticiousftilda ] ) decay exponentially if the imaginary component of the poles @xmath63 or @xmath91 exceeds @xmath98 .",
    "thus , for any given @xmath69 only the limited number of poles @xmath99 , @xmath100 have non - negligible residues .    if one replaces the real axis integration in eq .",
    "( [ subeq : gintegralapprox ] ) by the integration along the semi - circular contour of the sufficiently large radius in the upper complex half - plane , the contour contribution to the integral is zero , and the contribution from the poles is solely from @xmath99 .",
    "the integral  ( [ subeq : gintegralapprox ] ) is computed as the sum over all non - zero residues : @xmath101_{z = z_{j}}{\\bf g}^r ( z_{j})}\\right],\\end{aligned}\\ ] ] where the set @xmath99 is comprised of only those @xmath102 , @xmath103 , and @xmath104 poles which satisfy    [ eq : polesselection ] @xmath105    respectively , in order to keep the relative error below @xmath106 .    for values of @xmath57 and @xmath55 obeying the inequality  ( [ subeq : emintoktratio ] ) and @xmath107 the number of relevant poles @xmath108 is moderate .",
    "for example , it is safe to chose @xmath109  ev for valence electrons in a hydro - carbon system ( note that this value for @xmath57 is measured from the vacuum level ) .",
    "then , at room temperature the ratio ( [ subeq : emintoktratio ] ) is around 700 , and for @xmath110 the minimal number of required poles for parameters satisfying eq .",
    "( [ subeq : ftildaparameters ] ) equals 76 . decreasing @xmath69 down to machine precision",
    "raises the minimal number of poles to 96 .",
    "figure  [ fig : polesdensityplot ] shows the density plot of @xmath72 corresponding to @xmath110 and @xmath109  ev used to compute self - consistent electron within the graphene nanodevice example of sec .",
    "[ sec : example ] .",
    "the minimal number of poles @xmath108 is obtained as follows .",
    "we consider @xmath111 and @xmath112 as free parameters , and the minimum allowed @xmath113 and @xmath98 are obtained from equalities in constraints imposed by eq .",
    "( [ subeq : ftildaparameters ] ) .",
    "then , the number of poles @xmath63 is approximately twice the value of @xmath98 divided by the inter - pole distance @xmath114 and the approximate numbers of poles along the lines @xmath115 and @xmath116 in fig .",
    "[ fig : polesdensityplot ] are    [ eq : nbccd ] @xmath117    respectively . the optimal values of @xmath111 and @xmath112",
    "are obtained by minimizing @xmath118 in the space of these two parameters .",
    "a small @xmath112 and @xmath98 adjustment , subject to constraints  ( [ subeq : ftildaparameters ] ) , is made afterwards to place the line @xmath119 right in between the two poles on lines @xmath120 and @xmath116 ( cf . figs .",
    "[ fig : polesdensityplot ] and [ fig : multisteppolessetup ] ) .",
    "this is done to ensure that the poles are not too close to each other , otherwise a large numerical errors may occur .",
    "the minimum number of poles @xmath108 is scaled by the temperature and the energy interval @xmath121 . in order to reduce @xmath108 , it is desirable to have as large spacing between the poles @xmath122 as possible . according to eq .",
    "( [ eq : ftildaparameters_c ] ) , increasing @xmath111 for the given @xmath69 means the increase of @xmath98 .",
    "the increase of @xmath98 in turn increases the length of the segment @xmath120 , and hence the number of poles @xmath63 to be summed . on the other hand , reducing the number of @xmath63 ( i.e. , decreasing @xmath123=@xmath98 ) , will bring the line @xmath119 closer to the real axis , so to prevent deviation of @xmath72 from unity on the real axis requires to decrease @xmath111 .",
    "the latter increases the number of poles @xmath122 along the line @xmath119 .",
    "the simple solution to this problem is to break the interval between @xmath113 and @xmath54 into several sub - intervals , and apply the scheme presented in sec .",
    "[ subsec : hightvalence ] to each sub - interval .",
    "for example , if the original interval is split into two sub - intervals , the substitution for @xmath72 is @xmath124 where ; ; and .",
    "the parameters @xmath125 , @xmath126 , @xmath127 , and @xmath128 ensure the required precision by satisfying the constraints similar to eq .",
    "( [ subeq : ftildaparameters ] ) :    @xmath129    figure  [ fig : multisteppolessetup](b ) illustrates these concepts .",
    "poles forming the left ( smaller ) and the right ( bigger ) rectangles are associated respectively with the first and the second term in eq .",
    "( [ subeq : ftildaextentiondefinition ] ) .",
    "the poles running along the line @xmath130 are the same for the first and second term in eq .",
    "( [ subeq : ftildaextentiondefinition ] ) .",
    "the minimization of the total number of poles @xmath108 is performed analogously to eqs .",
    "( [ eq : nab ] ) and ( [ eq : nbccd ] ) . for @xmath131",
    "the optimization parameters are @xmath132 , @xmath133 , @xmath134 , and @xmath134 .",
    "the starting point for the conjugate gradient minimization is @xmath135 and @xmath136 , so that the optimized parameters fit this order of magnitude relationship .",
    "indeed , the size of the integration intervals in fig .",
    "[ fig : multisteppolessetup](b ) and  [ fig : multisteppolessetup](c ) increases by an order of magnitude from right to left .",
    "for this reason @xmath108 grows logarithmically with increasing ratio @xmath137 . that is , depending on @xmath69 , approximately 30 to 40 extra poles are required for each decade of this ratio increase ( i.e. , per order of magnitude in temperature reduction ) .      the concepts presented in sec .",
    "[ subsec : hightvalence ] allow for efficient and exact evaluation of the @xmath20 moments in the interval bounded by two fermi functions .",
    "this property can be used for systematic approximation of @xmath138 with the function @xmath139 such that @xmath140 on the real axis , and which is analytic in the upper complex half - plane .",
    "this approximation can be used to transform the non - analytic integrands to analytic functions .",
    "an obvious applications of this idea to negf - dft framework would be the computation of nonequilibrium contribution @xmath50 to the density matrix in eq .",
    "( [ eq : rho ] ) . because the functions @xmath141 and @xmath142 in the integrand of @xmath50 are non - analytic below and above the real axis , respectively , the integrand is non - analytic function in the entire complex energy plane .",
    "thus , no integration contour deformation akin to fig .",
    "[ fig : polesdensityplot ] can be exploited to avoid direct integration along the real axis to obtain @xmath50 . on the other hand ,",
    "such direct integration along the real axis is computationally expensive due to the need for very fine integration grids .",
    "@xcite as discussed in sec .",
    "[ sec : introduction ] , integration may not even converge when the integrand becomes too spiky with numerous closely spaced sharp peaks for devices containing large number of atoms .",
    "let us divide the interval @xmath143 $ ] into @xmath144 subintervals of equal size @xmath145 @xmath146 where we assume for simplicity that @xmath147 .",
    "then @xmath50 in eq .  (",
    "[ eq : rho ] ) can be rewritten as @xmath148 \\cdot { \\bf g}^a ( e ) \\times \\nonumber \\\\ & & { } \\left[f(\\mu_{m},t , e)-f(\\mu_{m-1},t , e)\\right].\\end{aligned}\\ ] ] for each interval @xmath149 $ ] in the sum ( [ subeq : nonequilibriumintegralsum ] ) we approximate @xmath141 by the power expansion with respect to the deviation from the center of the interval @xmath150 where @xmath151 are constant matrices .",
    "we require that the moments @xmath152 up to order @xmath153 for @xmath154 and @xmath155 coincide @xmath156 = \\nonumber \\\\ & & { } \\int\\limits_{-\\infty}^{+\\infty } de\\ , \\sum_{\\kappa=0}^{k } { \\bf g}_{m}^{(\\kappa)}\\times(e-\\xi_{m})^{\\kappa+d } \\times \\nonumber\\\\ & & { } \\left[f(\\mu_{m},t , e)-f(\\mu_{m-1},t , e)\\right],\\end{aligned}\\ ] ] where @xmath157 $ ] .     used to evaluate the integral in eq .",
    "( [ subeq : exactmoments ] ) . for a chosen precision set by @xmath158 ,",
    "the contribution from 28 poles has to be summed .",
    "three poles of @xmath159 are marked with the red empty circles .",
    "the values of the retarded green function at most of the poles shown are reused to compute matrices @xmath160 in eq .",
    "( [ subeq : equalmoments ] ) for @xmath161 , so that the average number of green functions to be computed per interval equals 3 . ]    the first integral in eq .",
    "( [ subeq : equalmoments ] ) can be computed accurately as @xmath162 = \\nonumber \\\\ & & { } \\int\\limits_{-\\infty}^{+\\infty}de\\ , { \\bf g}^{r}(e)(e-\\xi_{m})^{d } \\times \\nonumber\\\\ & & { } \\tilde{f}(\\mu_{m},\\mu_{m-1},\\tilde{\\mu}_{\\rm im},t , t,\\tilde{t}_{\\rm im},e).\\end{aligned}\\ ] ] figure  [ fig : momentrepresentation ] shows the poles of @xmath72 from eq .",
    "( [ subeq : exactmoments ] ) for the case @xmath158 , @xmath163 , and @xmath164 .",
    "even though the number of poles to be summed per every moment equals 28 , the number of points per integration interval @xmath145 at which @xmath141 needs to be calculated is 3 because the values of @xmath141 at different poles are reused in computation of the moments at different intervals .",
    "thus , @xmath152 is computed similarly to eq .",
    "( [ subeq : gintegralthroughresidues ] ) , with the only difference being that @xmath165 is now replaced by @xmath166 .    because matrices @xmath151 do not depend on energy , the integrals in the second term of eq .",
    "( [ subeq : equalmoments ] ) @xmath167,\\end{aligned}\\ ] ] can be computed analytically .",
    "here we provide example solution of this problem for @xmath168 ( the solutions for @xmath169 are similar to this ) .",
    "the integrals @xmath170 are non - zero when @xmath171 is even integer .",
    "for example , assuming @xmath172 they are @xmath173 then , to satisfy eq .",
    "( [ subeq : equalmoments ] ) for @xmath174 , matrices @xmath151 should be chosen as    @xmath175    the analytic continuation of @xmath139 into the upper complex half - plane is simply @xmath176^\\dagger \\times ( z-\\xi_{m})^{\\kappa}.\\end{aligned}\\ ] ] then eq .",
    "( [ subeq : nonequilibriumintegralsum ] ) becomes @xmath177 where @xmath178.\\end{aligned}\\ ] ] the integrand in eq .",
    "( [ subeq : nonequilibriumintegralsumapproxomega ] ) is now analytic in the upper - half plane and can be evaluated through our `` pole summation '' algorithm discussed in sections  [ subsec : hightvalence ] and  [ subsec : lowtcore ] .",
    "the algorithm presented in this section is actually more computationally expensive than the usually implemented  @xcite real axis integration to get @xmath50 since for every interval one needs to compute the retarded green function at three different points instead of one , as shown in fig .",
    "[ fig : momentrepresentation ] . nonetheless , the benefit of this approach is in systematic approximation by exact match of the green function moments which can evade insufficiently fine integration grid or , most importantly , uncontrolled usage  @xcite of the real - axis infinitesimal @xmath179 that leads to serious current non - conservation in long devices beyond molecular electronics scale .",
    "for example , a very large system poorly coupled to its contacts may have several sharp peaks within 10 mev interval .",
    "none of the adaptive real - axis integration methods  @xcite can properly account for these peaks if the integration step equals 10 mev , while the moments - matching algorithm has capability to capture the contribution from these peaks to the integral .",
    "from the very outset , the discovery of graphene has been intimately connected to attempts to fabricate carbon - based planar fets .",
    "@xcite since fets produced using micron - size graphene sheets as channels have poor @xmath180 ratio , the pursuit of fets suitable for digital electronics applications has shifted toward fabrication of gnrs with large band gaps  @xcite @xmath181  ev .",
    "their band gap can be engineered by transverse quantum confinement effects in the case of agnr ( where the gap is additionally affected by the increased hopping integral between the @xmath12-orbitals on carbon atoms around the armchair edge caused by slight changes in atomic bonding length in the presence of edge passivating hydrogen  @xcite ) or by staggered sublattice potential arising due to non - zero spin polarization around zigzag edges of zgnr .",
    "@xcite    the very recent experiments@xcite have demonstrated that all sub-10-nm - wide gnrs are semiconducting . since",
    "band gaps due to edge magnetic ordering in zgnr are easily destroyed at room temperature ,  @xcite by finite current under nonequilibrium bias voltage conditions ,  @xcite or by impurities and vacancies along the edge ,  @xcite we assume that agnrs are essential ingredient to introduce sizable band gap in graphene nanodevices operating at room temperature , as confirmed also by recent tunneling spectroscopy .",
    "@xcite    ,  , @xmath35 is described by the hamiltonian matrix @xmath182 , all of which are stored in computer memory together with matrices @xmath183 describing the coupling between adjacent slices @xmath184 and @xmath185 . ]",
    "the fabricated thus far have utilized metallic source and drain electrodes where schottky barrier ( sb ) is introduced at the contact between metallic electrode ( typically pd with high work function ) and gnr , so that the current is modulated by carrier tunneling probability through sb at contacts . on the other hand , planar structure of graphene",
    "is envisaged to make possible electronic circuits patterned from either a single graphene plane or multiple planes separated by layers of insulating material .",
    "@xcite    any circuit concept will require both active fets and passive elements for wiring individual circuit elements .",
    "although zgnr can be expected to be metallic at room temperature , the wiring based on them is nontrivial issue because only few specific zgnr patterns have close to ideal conductance and can transmit electron flux without losses .",
    "@xcite furthermore , at finite bias voltage zgnrs can open a band gap if they are mirror symmetric with respect to the midplane between the two zigzag edges .",
    "@xcite      our fet - type device setup , based on the combination of zgnr source and drain metallic electrodes and semiconducting agnr channel in between them , is shown in fig .",
    "[ fig : systemconfiguration ] the source and drain have different widths and are modeled as semi - infinite ideal zgnrs leads .",
    "the size of the agnr band gap is an oscillating function of the ribbon width .",
    "the width variation causing agnr to switch between small and large gaps equals to just a single bond length , which was found to greatly affect the transfer characteristics ( current @xmath186 vs. gate voltage @xmath187 at fixed source - drain bias @xmath188 ) in the recent study  @xcite of several fet concepts with agnr channel .",
    "because cutting graphene with atomic precision in order to obtain uniform device performance is currently not an option , the variable width agnr seems to be the simplest realistic path toward making a short semiconducting fragment . above the semiconducting `` active region '' we place a graphene rectangle , which is assumed to have no electrical contact with the zgnr - agnr - zgnr structure below it .",
    "this may be achieved by placing boron - nitride insulating layer in between .",
    "we note that the recent analysis  @xcite ( using negf for simple @xmath12-orbital tight - binding model , which is self - consistently coupled to a three - dimensional poisson solver for treating the electrostatics ) of dual - gate schottky barrier , with uniform width agnr channels and several different types of graphene- or non - graphene - based source and drain electrodes , has singled out zgnr - agnr - zgnr device concept as an optimal one with high enough @xmath8 ratio and advantageous features of zgnr metallic contacts .    the usage of wide graphene sheets as the channel of fet is conceptually difficult because depending on the position of the fermi level graphene possesses either electron or hole conductivity making it impossible to produce regions depleted of mobile charge carriers . at the same time",
    ", the concept of gnr devices allows to build both normally - off and normally - on transistors based solely on the device geometries .",
    "@xcite one of the main benefits of graphene in nanoelectronics is its one - atom - thickness which leads to very low parasitic capacitance , and therefore allows terahertz cut - off frequencies for devices and circuits .",
    "so far both the experiments  @xcite and quantum transport simulations  @xcite have been focused on whose channel is long and narrow semiconducting gnr attached to metallic source and drain ( such as pd ) contacts while being controlled by metallic top - gate shifting the band gap .",
    "although such transistors play an important role in studying gnr properties , they compromise the main purpose of nanoelectronic devices  the speed . the parasitic gate - substrate or gate - source ( drain ) capacitances  @xcite for such hybrid metal - graphene structure",
    "are orders of magnitude higher than capacitance of the channel , and thus substantially decrease the transistor speed . exploring nanoelectronic devices to reach",
    "the optimal speed limit is one of the primary motivations for the design concept shown in fig .",
    "[ fig : systemconfiguration ] .      the retarded green function matrix @xmath20 , as the central negf quantity in phase - coherent transport regime which yields electron density through eq .",
    "( [ eq : rho ] ) and current via eq .",
    "( [ eq : iv ] ) , can be computed by direct matrix inversion in eq .",
    "( [ eq : gr ] ) .",
    "however , the computational complexity @xmath47 of this operation makes it virtually impossible for present codes ( which typically perform this brute force operation ) to be applied to systems containing large number of atoms .",
    "@xcite thus , first - principles simulation of transport in large systems can be accomplished only if relevant elements of @xmath20 can be obtained via algorithms that scale linearly with increasing length of assumed quasi - one - dimensional ( q1d ) device geometry .",
    "@xcite    in fact , since only a much smaller submatrix of @xmath20 determines transport properties given by eq .",
    "( [ eq : iv ] ) , the recursive green function algorithms  @xcite ( in serial or parallel implementation  @xcite ) have commonly been used to compute the submatrix @xmath189 and obtain the transmission properties of mesoscopic devices .",
    "@xcite they are based on using the dyson equation , @xmath190 , to build the green - function slice by slice , so that the dimensions of the matrices that have to be inverted are strongly reduced ( @xmath191 is the green function of some region of the device with one of the leads attached , @xmath192 is the hopping matrix between that region and adjacent slice , and @xmath193 is the green function of the coupled system lead + region + slice ) .",
    "this type of algorithms have also been extended  @xcite to obtain other submatrices of @xmath33 needed to compute local quantities within the simulated region , such as @xmath194 or @xmath195 which define the electron density within slice @xmath184 or spatial profile of local currents between slices @xmath184 and @xmath185 , respectively .",
    "although it is often considered  @xcite that standard or extended recursive green function algorithms can be applied only to q1d two - terminal devices , some alternative approaches which invert smaller matrices than the full device hamiltonian @xmath52 to build the green function of multi - terminal nanostructures of arbitrary geometrical shape have also been introduced recently .  @xcite    the key issue for a successful inclusion of the recursive green function formulas into codes is not the specific set of equations , which is very similar in different approaches , but the ability to make a consistent partition of a system of arbitrary shape and with many attached electrodes into slices described by much smaller matrices @xmath182 .",
    "the full hamiltonian matrix can then be written as    @xmath196    since due to the finite range of basis functions in the transport direction the size of the slices can always be chosen so large that only neighboring ones are coupled through each other via the hopping matrices @xmath183 .",
    "an example of the solution to this primarily _ geometrical problem _ is illustrated using the device setup in fig .",
    "[ fig : systemconfiguration ] .",
    "our algorithm here starts from the bitmap image of the device @xmath197 converts the image into a finite - size honeycomb lattice @xmath197 then attempts to partition the device within a loop until consistent set of slices is achieved across the whole device .",
    "the final result  a set of slices of non - uniform shape ( in contrast to typical columns of sites orthogonal to the axis of the device when recursive algorithm is applied to two - terminal q1d devices of simple shape  @xcite)is shown in fig .",
    "[ fig : systemconfiguration ] as dark and light colored segments of the honeycomb lattice .",
    "each slice is described by a matrix @xmath182 containing the interactions between atoms within the layer @xmath184 ( @xmath198,  ,@xmath35 ) .",
    "the size of the matrix @xmath182 is @xmath199 , where @xmath200 is the total number of atomic orbitals for all atoms in the slice @xmath184 .",
    "these matrices are much smaller than @xmath201 , and are stored in memory at the beginning of the calculation together with matrices @xmath183 .    starting from the set of matrices @xmath182 and @xmath183",
    ", we implement the simplest recursive green function algorithm aimed at getting @xmath202 from which we can compute the density matrix @xmath203 of slice @xmath184 by replacing @xmath33 in eq .",
    "( [ eq : rho ] ) with @xmath202 .",
    "the retarded green function @xmath202 of each slices is given by : @xmath204^{-1}.\\ ] ] where @xmath205 and @xmath206 are the self - energies due to the rest of the device on the left and on the right , respectively , attached to slice @xmath184 ( @xmath207 is the unit matrix of the same size as @xmath182 ) .",
    "the self - energies @xmath205 generated by the left side of the device attached to slide @xmath184 are computed through the recursive formula which starts from the self - energy of the left semi - infinite ideal electrode , @xmath208 , and proceeds through    @xmath209^{-1 } \\cdot { \\bf h}_{1,2 } , \\label{eq : first } \\\\ { \\bm \\sigma}_l^{2,2}(e ) & = & { \\bf h}_{2,3}^\\dagger \\cdot [ e{\\bf i}_{2,2 } - { \\bf h}_{2,2 } - { \\bm \\sigma}_l^{1,1}(e)]^{-1 } \\cdot { \\bf h}_{2,3 } , \\\\",
    "\\vdots & = & \\vdots \\\\ { \\bm \\sigma}_l^{s-1,s-1}(e ) & = & { \\bf h}_{s-1,s}^\\dagger \\cdot [ e{\\bf i}_{s-1,s-1 } - { \\bf h}_{s-1,s-1 } - { \\bm \\sigma}_l^{s-2,s-2}(e)]^{-1 } \\cdot { \\bf h}_{s-1,s}.\\end{aligned}\\ ] ]    here @xmath210 is portion of the retarded green function of the isolated lead connecting atoms in the edge principal layer that is coupled to the extended central region via @xmath211 .",
    "the same recursion starts from the right semi - infinite ideal electrode to generate the self - energies @xmath206 , where the self - energy of the right semi - infinite ideal electrode , @xmath212 , and the hamiltonian @xmath213 of the first slice @xmath35 on the right side of the extended central region are used to construct the starting equation of the recursion analogous to eq .",
    "( [ eq : first ] ) .",
    "we note here that the usual simplification in codes is to treat the extended central region out of equilibrium while electronic structure of the ideal semi - infinite leads is computed in equilibrium , thereby ignoring the self - consistent response of the leads to the current .",
    "although it has been pointed out  @xcite that this approximation can be incompatible with asymptotic charge neutrality , this is rarely taken into account . instead of assuming that the equilibrium band structure of the leads is rigidly shifted by the bias voltage @xmath214 applied between the macroscopic reservoirs to which they are attached , we use @xmath215 satisfying @xmath216 as the shifts of the lead on - site energies , . here",
    "the potential @xmath217 is adjusted after each iteration within the self - consistency loop if the total charge on slices @xmath218 and @xmath35 ( obtained from @xmath219 and @xmath220 respectively ) is found to deviate from the neutral state charge .",
    "after the self - consistency is reached , the transmission @xmath221 in eq .",
    "( [ eq : iv ] ) is computed from the submatrix @xmath189 obtained recursively via the dyson equation by starting from the known retarded green function @xmath222 ( [ eq : slabgf ] ) of the first slice on the left : @xmath223^{-1 } \\cdot { \\bf h}_{i-1,i}^\\dagger \\cdot { \\bf g}_{i-1,1}^r.\\ ] ] thus , the computational complexity of the retarded green function evaluation is reduced from @xmath47 for the full matrix inversion to @xmath224 operations , where @xmath225 is the average number of atoms within the slice @xmath184 .",
    "this means that the time required to obtain all relevant submatrices @xmath202 and @xmath189 for the negf - dft algorithm scales linearly @xmath226 with increasing the length of the device ( i.e. , the number of slices @xmath35 ) .",
    "the recursive green function algorithm helps to resolve only one of the two key problems in the application of negf - dft to large devices .",
    "the other one discussed in sec .  [",
    "sec : introduction]numerous sharp peaks in the integrand of @xmath50 that render real axis integration non - convergent  can be solved in principle by including the interactions  @xcite within the simulated region capable of washing out the quantum interference effects ( that are , anyhow , seldom observed in devices at room temperature ) .",
    "for example , the inclusion of electron - electron correlation effects within the gw approximation was demonstrated  @xcite to broaden or remove sharp features in the negfs for test systems ( such as a chain of gold atoms ) .    in the presence of such dephasing processes",
    ", one has to resort to the full negf formalism  @xcite whose core quantities are the retarded @xmath33 and the lesser @xmath227 green function describing the density of available quantum - mechanical states and how electrons occupy those quantum states , respectively .",
    "both green functions can be obtained from the contour - ordered green function defined for any two time values that lie along the kadanoff - baym - keldysh time contour .",
    "@xcite in addition to the retarded @xmath228 and the lesser @xmath229 self - energy due to attached electrodes , the full formalism requires to compute self - energy functionals due to many - body interactions within the sample , @xmath230 and @xmath231 , while using conserving approximation  @xcite for their expression in terms of @xmath33 and @xmath227 .    in the phase - coherent transport regime ,",
    "@xmath232 and @xmath233 , so that the lesser self - energy of non - interacting ( i.e. , mean - field or kohn - sham ) quasiparticles can be expressed solely in terms of the retarded self - energies of the leads @xmath234 then the keldysh equation @xmath235 \\cdot { \\bf g}^a(e),\\ ] ] allows to eliminate @xmath227 as independent negf and express the corresponding density matrix @xmath236 using only @xmath20 and @xmath237 , as shown explicitly by eq .",
    "( [ eq : rho ] ) .    on the other hand , even the simplest phenomenological negf models of dephasing , such as `` momentum - conserving '' choice and ( @xmath238 measures the dephasing strength ) proposed in ref .  ,",
    "require to solve eq .",
    "( [ eq : gr ] ) and eq .",
    "( [ eq : keldysh ] ) as a system of coupled matrix equations involving full size matrices in the hilbert space of the simulated device region . for example , in the case of the dephasing model of ref .",
    ", this means iterative solving of eq .",
    "( [ eq : gr ] ) , with as the initial guess , and then using converged @xmath33 to solve eq .",
    "( [ eq : keldysh ] ) as the sylvester equation of matrix algebra . obviously , in this case the sparse nature of @xmath201-matrix in eq .",
    "( [ eq : hmatrix ] ) and the corresponding recursive green function formulas become irrelevant for reducing the time it takes to obtain all relevant negfs in a single step of the self - consistent loop  ( [ eq : scloop ] ) .",
    "more realistic description of interactions with the extended central region is far more computationally demanding .",
    "@xcite thus , the only route toward first - principles modeling of transport through large devices is to remain within the phase - coherent transport regime and develop algorithms that can resolve problems in the convergence of integration in @xmath50 along the real axis , as discussed in sec .",
    "[ subsec : nonanalytic ] or by refs .  .",
    "the dft part of our simulation , which constructs the hamiltonian of the central region as an input for negf post - processing to obtain the device transport properties , is performed by using the model .",
    "@xcite this model accounts for atomic polarization and inter - atomic charge transfer in a standard dft - like fashion while making it possible to use a _ minimal basis set _ of four gaussian orbitals per carbon and one orbital per hydrogen atom .",
    "the usage of such minimal basis set allows us to reduce the size of matrices @xmath182 and @xmath183 discussed in sec .",
    "[ sec : recursive ] without loosing any of the important aspects of _ ab initio _ input about carbon - hydrogen systems .",
    "this makes highly advantageous when treating systems with large number of atoms .",
    "conceptually , can be viewed as the pseudo - potential dft scheme with each atom having its own atomic orbital basis set adjustable to the local atomic environment around this atom .",
    "it is a hybrid of the non - self - consistent environment - dependent tight - binding model  @xcite and a gaussian - based dft scheme .",
    "such adaptive behavior adequately compensates for the low precision of the minimal orthogonal basis set . in practice , implements the environment dependence as the parametrization of hamiltonian matrix elements with respect to the atomic environment , rather than the parametrization of the atomic basis set .",
    "for example , the parameterized part of hamiltonian matrix elements for the atom near the edge of the nanoribbon will be different from the respective matrix elements in the middle of the strip . similarly , the in - plane hamiltonian matrix elements for a single graphene layer will be different from the respective matrix elements in a graphene bilayer .",
    "the hamiltonian matrix elements are the sums of parameterized adaptive `` tb - like '' and non - adaptive `` true dft '' contributions .",
    "the former mainly accounts for the covalent bonding , while the latter describes interatomic charge transfer , atomic dipole polarization , and on - site variation of exchange potential",
    ". the extensive comparison of with large basis set dft calculations indicates that produces more precise and transferable results than minimal basis set pseudo - potential dft schemes . at the same time , is faster than minimal basis set pseudo - potential dft due to : ( i ) faster computation of matrix elements ; ( ii ) unit overlap matrix ( i.e. orthogonal basis set ) ; and ( iii ) smaller number of components used for the description of electron density ( uses ten independent components , @xmath239 , @xmath240 , @xmath241 , @xmath242 , @xmath243 , @xmath244 , @xmath245 , @xmath246 , @xmath247 , @xmath248 , to describe the electron density at a given carbon atom ) .",
    "this allows us not only to capture the interatomic charge transfer , but also to account for the dipole polarization .",
    "the compact description of electron density makes possible efficient combination of with convergence acceleration schemes for both equilibrium and non - equilibrium cases , as discussed in sec .",
    "[ sec : broyden ]",
    ". the more detailed specification of electron density provided by standard dft codes in local density ( or some other ) approximation  @xcite will decrease the computation efficiency , but will not affect the simulation of graphene devices whose operation is based on charge transfer at the scale larger than carbon - carbon bond length . to accommodate systems composed of tens of thousands atoms",
    ", the part of our computational code also includes the possibility of multipole expansion of coulomb potential and parallelization on distributed / shared memory systems .    despite cutoff radius for the orbitals used in , the coupling hamiltonian matrix elements between the top and the bottom graphene layers of the system depicted in fig .",
    "[ fig : systemconfiguration ] have to be masked with zeros to simulate insulating layer in between .",
    "this causes the nonequilibrium density matrix  ( [ eq : rho ] ) in the presence of the gate voltage @xmath187 to evolve into two equilibrium integrals  ( [ subeq : gintegral ] ) @xmath249 f(\\mu , t , e ) } \\nonumber \\\\ & & { } - \\frac{1}{\\pi}\\int\\limits_{-\\infty}^{+\\infty } de\\ , { \\rm im}\\ , [ { \\bf g}_{\\rm gate}^{r}(e ) ] \\left\\ { f(\\mu+ev_{gs},t , e ) \\right .",
    "\\nonumber   \\\\ & & { } - \\left .",
    "f(\\mu , t , e)\\right\\},\\end{aligned}\\ ] ] each of which is evaluated through our `` pole summation '' algorithm encoded by the formula  ( [ subeq : gintegralthroughresidues ] ) . here",
    "@xmath250 refers to the green function matrix eq .",
    "( [ eq : gr ] ) computed for the whole device , but whose all elements associated with atoms in the lower source - channel - drain layer are masked with zeros .",
    "that is , only those matrix elements which correspond to the gate layer are allowed to be non - zero .",
    "we assume that the self - consistency of the recursive green function algorithm + broyden mixing scheme ( see appendix  [ sec : broyden ] ) is reached when @xmath251 , where the elements of the electron density vector @xmath252 are extracted from the diagonal blocks of the corresponding @xmath253 and @xmath253 matrices [ as discussed in sec .",
    "[ sec : recursive ] , only their diagonal blocks are computed from recursively generated submatrices @xmath254 of the retarded green function ] .",
    "the potential spikes pointing downwards correspond to the hydrogen atoms .",
    "positive potential spikes associated with carbon atoms in the c - h dipole pairs are truncated to make a clear view of the potential inside the conducting channel .",
    "note that the potential axis points downwards .",
    "]      we first assume zero gate voltage and plot in fig .",
    "[ fig : coulombpotentialzerovoltage ] the self - consistent hartree potential  @xcite computed via the poisson equation with net charge density due to charging of carbon atoms as the source term .",
    "the potential profiles are evaluated within the planes that are parallel to two graphene layers in fig .",
    "[ fig : systemconfiguration ] and positioned in the region between them .",
    "the inhomogeneous profiles are caused by charge transfer between hydrogen and carbon atoms .",
    "furthermore , it is important to emphasize that there is approximately @xmath255  mev difference between the fermi levels of the wide @xmath256 and narrow @xmath257 source and drain zgnr electrodes , respectively , in the bottom graphene layer of the device in fig .",
    "[ fig : systemconfiguration ] .",
    "this is caused by different ratios of carbon atoms to hydrogen atoms passivating the zigzag edges in gnrs of different widths .",
    "that is , the edge hydrogen atoms effectively dope the nanoribbon  @xcite where the level of doping depends on its size and geometry . to account for this , the equilibrium fermi level of the whole setup @xmath258 used in eq .",
    "( [ subeq : quasinonequilibriumdensity ] ) is assumed to be the average of @xmath256 and narrow @xmath257 .",
    "such compensation of the difference in the fermi levels requires a small built - in electric field in our model .",
    "room - temperature ( @xmath259 k ) operation is assumed in all figures in this section .",
    "then we apply voltage to the gate electrode in fig .",
    "[ fig : coulombpotential3dv1 ] and plot the full three - dimensional spatial profile of the electric potential . further increase of the gate voltage to leads to potential ( within a geometrical plane in between two graphene layers ) shown in fig .",
    "[ fig : coulombpotentialthreevolts ] .",
    "the self - consistent atomistic level simulation captures the potential variation in the transverse direction of the gnrs , as well as possible modifications of the band structure of gnrs with increasing gate voltage .",
    "@xcite    in both figures , we find that the chosen portion of metallic zgnr electrodes attached to the agnr channel to form the `` extended central region '' ,  @xcite encompassing @xmath2 carbon and hydrogen atoms for self - consistent electron density and potential calculations , is actually not large enough ( despite many zgnr supercells included into the extended central region ) to completely screen the effect of the applied electric field via the top gate electrode .",
    "this is signified by the color of the coulomb potential at the boundaries ( marked by horizontal white lines in fig .",
    "[ fig : coulombpotentialthreevolts ] ) of the `` extended central region '' not being identical to the color of the uniform potential along the semi - infinite leads .",
    "the total uncompensated charge at the boundary is approximately 0.03  @xmath260 for and 0.07 @xmath260 for .     atoms . ]    ) of the nanodevice depicted in fig .",
    "[ fig : systemconfiguration ] as a function of energy .",
    "the conductances are obtained in the absence ( a ) , ( b ) or presence ( c ) , ( d ) of the gate voltage @xmath187 , where charge redistribution is computed self - consistently in all three cases ( b)(d ) [ unlike in ( a ) ] . the solid and dashed rectangular lines in panel ( a )",
    "show the conductance quantization of the infinite source ( wide nanoribbon , solid line ) and drain ( narrow nanoribbon , dashed line ) zgnr electrodes , respectively .",
    "the fermi level in the case of unbiased gate corresponds to @xmath261 . ]",
    "another feature conspicuous in fig .",
    "[ fig : coulombpotentialthreevolts ] is that the on - site potential shift experienced by carbon atoms in the lower layer is much smaller than expected from the applied bias voltage .",
    "this unusual screening capability of insulating agnr channel can be attributed to the presence of short segments of metallic agnr due to either particular width of such segments ( we do not relax the coordinates and edge bonds which is necessary to make all three types of agnr insulating  @xcite ) or doping by evanescent modes  @xcite that decay from zgnr electrodes into agnr channel thereby generating metal induced gap states  @xcite ( localized at the zgnr@xmath262agnr interface ) .",
    "@xcite this is also reflected in the conductance of our device  to shift the band gap of variable - width agnr by @xmath263  ev and bring it into single channel conducting regime demands a rater large gate voltage ( when compared to required to turn uniform semiconducting agnr into a single channel conductor  @xcite ) , as shown by the source - drain conductance computed as the function of @xmath187 in figs .",
    "[ fig : conductance](b)(d ) .",
    "the metallic behavior of zgnr electrodes is characterized by the non - zero density of states and finite ( zero temperature ) conductance at the fermi level @xmath264 .",
    "we note that in simple nearest - neighbor tight - binding models  @xcite the conductance of infinite zgnr around the charge neutral ( dirac ) point @xmath265 is quantized @xmath266 ( @xmath267 is the conductance quantum for spin - degenerate transport ) due to a single open conducting channel ( i.e. , transverse propagating mode ) defined by the overlap of edge - localized wave functions .",
    "@xcite on the other hand , in dft description ( that can be mimicked by single @xmath12-orbital tight - binding models which include third nearest - neighbor hopping  @xcite ) more complicated subband structure of zgnr leads to three open conducting channels  @xcite around @xmath265 and @xmath268 quantized conductance for semi - infinite source and drain zgnr electrodes .",
    "this is confirmed in the context of our negf - dft approach by fig .",
    "[ fig : conductance](a ) .    comparing fig .",
    "[ fig : conductance](a ) with fig .",
    "[ fig : conductance](b ) , which are both obtained at @xmath269 v , highlights the importance of self - consistent electron density computation , even in the absence of gate voltage effects .",
    "we find a marked difference in two panels between the position of the gap region [ over which the transmission function @xmath270 in eq .",
    "( [ eq : transmission ] ) is zero ] and conductance oscillations outside of it .",
    "the conductance in fig .",
    "[ fig : conductance](a ) was obtained without computing charge transfer effects , and could be reproduced by popular non - self - consistent tight - binding models  @xcite without resorting to full negf - dft formalism .",
    "the modeling of realistic multi - terminal graphene nanoelectronic devices requires quantum transport methods that can capture effects of its highly unusual electronic properties  @xcite and their dependence on detailed device geometry ,  @xcite as well as charge transfer ( in equilibrium ) and charge redistribution ( out of equilibrium ) effects on atomistic scale . while quantum transport approaches based on simple pre - defined hamiltonians  @xcite can not handle all of these issues , the framework , which generates the self - consistent hamiltonian of the device prior to the calculation of conductance or @xmath271 characteristics , offers a proper methodology for first - principles modeling of electron transport involving accurate quantum - chemical description of atomic scale geometry .",
    "however , simulations thus far have been limited  @xcite to rather small systems , such as short molecules connected to metallic electrodes . here",
    "we address several obvious  @xcite and more subtle ( sec .",
    "[ sec : introduction ] ) impediments that have to be resolved to make possible the application of codes to devices containing many thousand atoms : ( _ i _ ) computational complexity of the retarded green function calculation , as the main time limiting part of the simulation when full hamiltonian matrix is inverted , should scale linearly with the system size ; ( _ ii _ ) integration of negfs to get the equilibrium and nonequilibrium part of the density matrix has to be performed in a way ( especially in the case of nonequilibrium contribution ) which ensures convergence despite sharp peaks ( due to assumed phase - coherent transport of non - interacting quasiparticles ) along the real axis whose number increases substantially in large systems ; and ( _ iii _ ) the convergence of the self - consistent loop , which repeatedly evaluates ( _ i _ ) and ( _ ii _ ) , should be accelerated with proper mixing scheme of previous iterative steps that is compatible with solution of problems in ( _ i _ ) and ( _ ii _ ) .",
    "the algorithms presented here extend the methodology to systems containing large number of atoms through a combination of :    \\(1 ) the `` pole summation '' algorithm for the exact integration of the retarded green function in the expression for the equilibrium part of the density matrix offers an alternative to standard numerical contour integration by replacing the fermi function @xmath0 with the analytic function @xmath1 , which coincides with @xmath0 inside the integration range along the real axis but decays exponentially in the upper complex half - plane .",
    "only a finite number @xmath108 of its poles , which can be found analytically , has non - negligible residues , so that where @xmath272 are scalars given by simple analytical expressions in eq .",
    "( [ subeq : gintegralthroughresidues ] ) .",
    "the typical value of @xmath108 for valence electrons at room temperature is 80 , and it increases with the temperature decrease with an approximate rate of 40 extra poles per order of magnitude in temperature reduction .",
    "\\(2 ) possible application of the `` pole summation '' algorithm to tackle the problem of difficult - to - converge integration of negfs along the real - axis ( due to numerous sharp peaks in the integrand which would be impossible to locate and handle individually  @xcite for devices contains large number of atoms ) to obtain @xmath50 after its non - analytic integrand in the entire complex plane is approximated with an analytic function in the upper complex plane , so that the same type of summation can be performed as in the case of @xmath64 integral .",
    "\\(3 ) the recursive green function formulas which , assuming proper geometrical decomposition of the lattice of the device into slices of irregular shape for arbitrary nanostructure geometry , makes it possible to reduce scaling of the required computing time from @xmath47 for the full hamiltonian matrix inversion in the single iteration of the self - consistent loop to linear scaling @xmath226 [ @xmath35 is the number of slices in the transport direction ] of the computation of only the diagonal blocks of the retarded green function that yield the electron density within the slice .    in the case of equilibrium or quasi - equilibrium",
    "( such as generated by non - zero gate voltage and zero or linear response bias voltage ) situations , we additionally accelerate convergence of the self - consistent loop for the density matrix by using the modified broyden scheme discussed in appendix  [ sec : broyden ] , which is compatible with the recursive green function algorithm and mixes input and output electron density from all previous iterations to generate input density for the next iteration step .",
    "we illustrate the numerical efficiency of the combination of these algorithms for negf part of the calculation by integrating it with the dft code ( based on the minimal basis set  four localized orbitals per carbon atom and one per hydrogen  tailored for carbon - hydrogen systems ) to simulate gate voltage effects in fet - type device .",
    "our simulated device is composed of @xmath2 atoms and employs agnr of variable width ( kept below @xmath273 nm ) as a realistic semiconductor channel accessible to present nanofabrication technology .",
    "@xcite the device does not require atomic precision in controlling the width and the corresponding band gap when uniform sub-10-nm wide agnr are used , while exploiting advantageous  @xcite zgnr source and drain electrodes .",
    "we also use square - shaped gate electrode covering the channel which is made of graphene as well .",
    "the self - consistent evaluation of the electron density and coulomb potential is required to capture inhomogeneous charge distribution and modification of the gnr band structure with increasing gate voltage .",
    "@xcite this reveals that rather large gate voltage is required to shift the band gap of variable - width agnr channel and bring this type of top - gated into a window of single open transverse propagating mode with low scattering and heat dissipation .",
    "the computation of self - consistent electron density and electrostatic potential , as the crucial aspect of negf - dft approach to quantum transport modeling , is indispensable to properly take into account gate voltage effects or to ensure the gauge invariance  @xcite of the characteristics in far from equilibrium transport .",
    "@xcite in addition , we also demonstrate notable difference between the zero - bias transmission ( i.e. , linear response conductance ) of non - self - consistent and self - consistent modeling .",
    "this can be attributed to charge transfer effects between edge passivating hydrogen atoms and carbon atoms , where such edge doping also affects the position of the fermi level of isolated gnrs of different size and geometry .",
    "financial support from nsf under grant no . is gratefully acknowledged .",
    "the recursive green function algorithm discussed in sec .  [ sec : recursive ] drastically reduces the computational complexity of a single iteration step within the self - consistent loop  ( [ eq : scloop ] ) .",
    "another important ingredient of algorithms that can handle systems with large number of atoms is to combine the recursive techniques with the convergence acceleration scheme based on proper mixing of quantities found in previous steps to produce the input for the next step .",
    "the simplest mixing scheme takes certain fraction @xmath274 of the output electron density @xmath275 from the previous step @xmath94 and the remaining fraction @xmath276 from the corresponding input @xmath277 to produce input for the next step , @xmath278 .",
    "finding the optimal value for the mixing parameter , typically @xmath279 , depends on the nature of the system ( such as , insulating vs. metallic or isolated vs. attached to semi - infinite leads ) .",
    "this can require few thousand iteration steps to satisfy the convergence criterion @xmath280 we employ in our simulation .",
    "the more sophisticated mixing schemes employ pulay  @xcite or broyden  @xcite algorithms to mix several previous steps , where the quantities mixed can be the density matrix or hamiltonian and green functions  @xcite ( which can be more efficient for open multi - terminal systems where the central region does not have a fixed number of electrons ) . for a small bias voltage",
    ", the self - consistency can be achieved by applying the broyden convergence acceleration method which has two major advantages .",
    "first , the modified second broyden method  @xcite is compatible with the recursive green function method discussed in sec .",
    "[ sec : recursive ] .",
    "second , the broyden method adds @xmath46 extra operations , so that the single iteration is not slowed down .",
    "however , the reduction of the number of iterations achieved by the broyden method is appreciable .",
    "the broyden method works well when the correlation between the electron density and the potential is local , i.e. , when the local potential distortion results in a local self - consistent density change . on the other hand , in the case of non - local correlations",
    "the broyden method performance rapidly deteriorates .",
    "the nonequilibrium electron density in the coherent ballistic approximation constitutes the perfect example when the broyden method fails .",
    "the reason for this is that electron - potential correlations becomes completely non - local  the change of the potential at one contact can shut off the electron flux through the entire system and cause the system - wide electron density redistribution .",
    "thus , in far - from - equilibrium cases other mixing schemes have to be used .",
    "@xcite    in particular , the modified second broyden method  @xcite is compatible with the recursive green function method discussed in sec .",
    "[ sec : recursive ] , and makes it possible to reduce the number of iteration steps to the order of @xmath281 . in this scheme ,",
    "an input electron density for iteration @xmath282 is constructed from the set of input and output densities generated in _ all _ previous iterations :    [ eq : broyden ] @xmath283^t \\cdot { \\bf f}_m , \\\\ \\mbox { }   { \\bf f}_m & = & { \\bf n}_m^{\\rm out } - { \\bf n}_m^{\\rm in } , \\\\ \\mbox { } { \\bf w}_i & = & -\\varepsilon ( { \\bf f}_i - { \\bf f}_{i-1 } ) + { \\bf n}_i^{\\rm in } - { \\bf n}_{i-1}^{\\rm in } \\nonumber \\\\ \\mbox { } & & - \\sum_{j=2}^{i-1 } { \\bf w}_j \\cdot [ { \\bm \\phi}_j]^t \\cdot ( { \\bf f}_i-{\\bf f}_{i-1 } ) , \\\\ \\mbox { }   [ { \\bm \\phi}_i]^t & = & \\frac{({\\bf f}_i - { \\bf f}_{i-1})^t}{({\\bf f}_i - { \\bf f}_{i-1})^t \\cdot ( { \\bf f}_i - { \\bf f}_{i-1})}.\\end{aligned}\\ ] ]    here @xmath277 , @xmath275 , @xmath284 , @xmath285 , and @xmath286 comprise a relatively small set of vectors to be stored in computer memory . the compatibility of this modified broyden scheme with the recursive green function algorithm of sec .",
    "[ sec : recursive ] stems from the fact that only diagonal blocks of @xmath33 , required to construct vectors in eq .",
    "( [ eq : broyden ] ) , are computed recursively without knowing the full green function needed in some other mixing schemes .",
    "@xcite                                                                                                                                                b.  k.  nikoli , l.  p.  zrbo , and s. souma , in _ the oxford handbook of nanoscience and technology : frontiers and advances _ ,",
    "v. narlikar and y. y. fu ( oxford university press , oxford , 2010 ) ; preprint arxiv:0907.4122 .",
    "although metal induced gap states do not affect the transmission for long channel devices at linear response bias voltage , they are expected to contribute to tunneling currents , particularly in short channel devices .",
    "in fact , they can also affect longer channel devices by enhancing scattering processes under high source - drain bias voltage ."
  ],
  "abstract_text": [
    "<S> the recent fabrication of graphene nanoribbon ( gnr ) field - effect transistors poses a challenge for first - principles modeling of carbon nanoelectronics due to many thousand atoms present in the device . </S>",
    "<S> the state of the art quantum transport algorithms , based on the nonequilibrium green function formalism combined with the density functional theory ( ) , were originally developed to calculate self - consistent electron density in equilibrium and at finite bias voltage ( as a prerequisite to obtain conductance or current - voltage characteristics , respectively ) for small molecules attached to metallic electrodes where only a few hundred atoms are typically simulated . </S>",
    "<S> here we introduce combination of two numerically efficient algorithms which make it possible to extend the negf - dft framework to device simulations involving large number of atoms . </S>",
    "<S> our first algorithm offers an alternative to the usual evaluation of the equilibrium part of electron density via numerical contour integration of the retarded green function in the upper complex half - plane . </S>",
    "<S> it is based on the replacement of the fermi function @xmath0 with an analytic function @xmath1 coinciding with @xmath0 inside the integration range along the real axis , but decaying exponentially in the upper complex half - plane . </S>",
    "<S> although @xmath1 has infinite number of poles , whose positions and residues are determined analytically , only a finite number of those poles have non - negligible residues . </S>",
    "<S> we also discuss how this algorithm can be extended to compute the nonequilibrium contribution to electron density , thereby evading cumbersome real - axis integration ( within the bias voltage window ) of negfs which is very difficult to converge for systems with large number of atoms while maintaining current conservation . </S>",
    "<S> our second algorithm combines the recursive formulas with the geometrical partitioning of an arbitrary _ multi - terminal _ </S>",
    "<S> device into non - uniform segments in order to reduce the computational complexity of the retarded green function computation by evaluating only its submatrices required for electron density or transmission function . </S>",
    "<S> we illustrate fusion of these two algorithms into the -type code by computing charge transfer , charge redistribution and conductance in two - terminal device covered with a gate electrode made of graphene layer as well . </S>",
    "<S> the total number of carbon and edge - passivating hydrogen atoms within the simulated central region of this device is @xmath2 . </S>",
    "<S> our self - consistent modeling of the gate voltage effect suggests that rather large gate voltage might be required to shift the band gap of the proposed agnr interconnect and switch the transport from insulating into the regime of a single open conducting channel .    </S>",
    "<S> = 1 </S>"
  ]
}