{
  "article_text": [
    "the positron emission tomograph ( pet ) works by estimating the radioactive fluid density ( tracer ) from the measurements of the @xmath0 quanta emitted from the beta plus ( @xmath1 ) decay .",
    "the two quanta are emitted simultaneously and almost back - to - back .",
    "we will call such emission an _ event_. the @xmath0 are detected in the detectors surrounding the patient . detecting two quanta yields a _ tube of response _ passing through the emission point .",
    "the better the spatial resolution of the detection the thinner is the tube giving a better reconstruction .",
    "currently all pet scanners perform the measurements using the non - organic scintillating crystals and the spatial resolution is controlled by the crystal size which can be as small as few millimeters across .",
    "our group is working currently on a prototype pet using the long plastic scintillator strips where the spatial resolution is obtained from the time of flight measurements  @xcite . achieving sufficient time resolution ( less than @xmath2  ps )",
    "is the main technological challenge , however the novel hardware require also the suitable adaptation of the reconstruction algorithm .",
    "this contribution is concerned with the calculation of the system kernel in the 2d image reconstruction in the axial plane of our strip pet detector .",
    "it is organized as follows : in section  [ sec : detector ] we describe the detector geometry and measurment errors , in section  [ sec : lm ] the principles of the list - mode expectation maximization algorithm is described and in the following sections we derive the system response kernel .",
    "in its final form our detector should consist of strips of scintillators arranged on a cylinder .",
    "the strips are aligned with the axis of the cylinder .",
    "we will start with a simpler 2d geometry  two parallel line segments of scintillators of length @xmath3 at the distance @xmath4 ( see figure  [ fig : detector ] ) .",
    "detector geometry.,width=377 ]    this is anyway a necessary step as our first prototype will consist of two bars of scintillators .",
    "this is in a sense a minimal configuration required for testing .",
    "the real idealization here is neglecting the scintillator thickness .",
    "a photomultiplier tube is attached to the end of each strip .",
    "the @xmath0 quanta can scatter in the scintillator and produce light which then propagates along the scintillator to the photomultipliers . by measuring the time at which light reaches the photomultiplier we can estimate the position at which @xmath0 had crossed the scintillator @xmath5 we use tildas to mark the measured quantities as opposed to the exact ones .",
    "the @xmath6 denotes the effective speed of light in the scintillator .",
    "it takes into account both the actual speed of light in scintillator and the elongation of the optical path due to reflections .",
    "we have estimated this to be approximately @xmath7 m/s for the scintillators we use . combining the time measurements from the two scintillators we can estimate the position of the emission point on the line joining the upper and lower crossing points @xmath8 where @xmath9 is the difference of distances of the reconstructed point @xmath10 from the upper and lower detection points ( see figure  [ fig : detector ] ) .",
    "those quantities are of course subject to measurement errors and are related to exact ones by @xmath11    we assume that the errors @xmath12 are normally distributed with some correlation matrix @xmath13",
    ". in general the magnitude of the errors will depend on place where the @xmath0 hit the scintillator @xmath14 .",
    "this matrix is a necessary and important input for the reconstruction algorithm . under some plausible assumptions which are beyond the scope of this contribution this matrix",
    "can be parametrized by three functions @xmath15 where @xmath16 and @xmath17    the @xmath18 , @xmath19 and @xmath9 are related to the coordinates @xmath10 of the emission point and the emission angle @xmath20 by the formulas @xmath21 and conversely @xmath22",
    "given good enough time resolution our detector using the time - of - flight technique could reconstruct each individual event with sufficient accuracy to measure the emitter density directly .",
    "currently however this is not the case and the measurements errors have to be incorporated into the reconstruction using a _",
    "statistical _ approach .",
    "almost every current reconstruction algorithm is based on likelihood maximization approach described in@xcite .",
    "this work is concerned with _",
    "binned _ data .",
    "however because of the advance of the technology most of the scanners work in the list",
    " mode where every single detected event is recorded separately .",
    "the extensions of the likelihood maximization approach to this case was done in@xcite .",
    "here we provide a very brief introduction to this algorithm , for details reader is referred to @xcite .",
    "let s denote the _ system response kernel _",
    "by @xmath23 .",
    "this is defined as probability that a _ detected _ event emitted from pixel @xmath24 was reconstructed as @xmath25 .",
    "given this probability for each emitter density @xmath26 we can calculate the probability of observing the particular set of @xmath27 events@xcite : @xmath28 the @xmath29 is the _ sensitivity _ of the pixel the probability that an event originating from pixel @xmath24 will be detected at all . together",
    "@xmath29 and @xmath30 provide the complete model of the detector .",
    "the reconstruction algorithm consists of finding the distribution @xmath26 that maximizes this probability , or more accurately its logarithm - the likelihood .",
    "that is achieved using the iterative expectation maximization ( em ) algorithm @xcite @xmath31 the sum over @xmath32 runs over all collected events @xmath33 .",
    "considering that up to hundred millions of events can be collected during a single scan this is a very time consuming calculation . finding an efficient approximation for the system response",
    "kernel is of a paramount importance .",
    "to calculate @xmath34 we start with @xmath35  the probability that a event @xmath36 will be detected as @xmath25 .",
    "this includes the possibility of an event not being detected @xmath37 the @xmath38 is the sensitivity of an event  the probability that the event will be detected .    with this definition @xmath39 where @xmath40 and @xmath41    we assume that every event reaching the detector is detected so the @xmath38 is given solely by the geometrical constraints @xmath42 \\wedge z_{d}\\in [ -l/2,l/2]\\\\   0 & \\text{otherwise}. \\end{cases}\\ ] ] this is somewhat more complicated in the image space @xmath43\\\\   0 & \\text{otherwise } \\end{cases}\\ ] ] we will also need the sensitivity of the image point @xmath10 @xmath44 with @xmath45    as discussed in the previous section the errors are normally distributed @xmath46 where @xmath47    we will now construct an approximation for the formula .",
    "we start by calculating @xmath48    the first approximation we make is to assume that the correlation matrix @xmath13 is depending weakly on @xmath49 and we can approximate it by its value at @xmath25 .",
    "the integral becomes then @xmath50    we will approximate this integral using the saddle - point approximation . to this end we first expand the @xmath51 in @xmath52 @xmath53 with @xmath54 @xmath55 and @xmath56 where @xmath57    after inserting into the exponent of we obtain the expression @xmath58 which we truncate to the quadratic order @xmath59 after differentiating with respect to @xmath60 we obtain the equation for the minimum @xmath61 with the solution @xmath62 denoting @xmath63 we rewrite the as @xmath64    finally we obtain @xmath65 and performing the gaussian integration we get @xmath66    we still need to perform the integration over the pixel",
    ". we will just approximated it by the value of at its center @xmath67 and @xmath68 where @xmath69 denotes the center of pixel @xmath24 .",
    "to validate our calculations we compare the formulas and for few selected events .",
    "the biggest issue here is the estimation of the correlation matrix @xmath13 . we will consider the case of diagonal correlation matrix not depending on the positions @xmath70 from our measurments we estimate @xmath71    we the consider events with @xmath72 and angles zero and @xmath73 ( see figure  [ fig : c300 ] ) .",
    "the value of @xmath74 does not matter as in this case all the formulas are invariant with respect to the translation along the @xmath74 axis .",
    "it is clear that the formula is non - negligible only in a limited region around the reconstruction point . to estimate this region we will use only the first term from the exponent",
    "this a homogeneous polynomial of the second order in @xmath75 and @xmath76 so it defines a ellipse around reconstruction point given by the equation @xmath77 the region of the interest is defined as the three sigma ellipse ( @xmath78 ) .",
    "two of the events used for validation .",
    "the reconstructed point is at @xmath79 and reconstructed angles are @xmath80 and @xmath73.,width=377 ]    for each event we scan the formulas and along the horizontal and vertical line segments based on the bounding box of the one @xmath81 ellipse ( see the figure  [ fig : c300 ] ) . for this choice of parameters",
    "the two formulas were practically indistinguishable .",
    "we have presented a derivation of the system response kernel for a pet detector based on time of flight measurements in two parallel scintillators strips .",
    "the resulting formula for the kernel is still quite complicated . for each event",
    "the expression in the exponent is a rational function in variables @xmath75 and @xmath76 .",
    "we could envisage further simplification , but this can be problematic without detailed knowledge of the detector geometry / size and the matrix @xmath82 .",
    "however we believe that our formula provides a very good starting point for further approximations once the detector geoemtry is fixed .    the biggest simplification we have made is to assume that the scintillators have no thickness .",
    "in reality they can be up to 20 mm thick .",
    "a simplest approach would be to incorporate this into the correlation matrix .",
    "however our preliminary calculations show that the resulting errors are not gaussian .",
    "this is a subject of an ongoing investigation . +",
    "* acknowledgments * + we acknowledge technical and administrative support by m.  adamczyk , t.  gucwa - ry , a.  heczko , k.  ojek , m.  kajetanowicz , g.  konopka - cupia , j.  majewski , w.  migda , and the financial support by the polish national center for development and research and by the foundation for polish science through mpd programme , the eu and mshe grant no .",
    "poig.02.03.00 - 00 - 013/09 ."
  ],
  "abstract_text": [
    "<S> reconstruction of the image in positron emission tomographs ( pet ) requires the knowledge of the system response kernel which describes the contribution of each pixel ( voxel ) to each tube of response ( tor ) . </S>",
    "<S> this is especially important in list  </S>",
    "<S> mode reconstruction systems where an efficient analytical approximation of such function is required . in this contribution we present a derivation of the system response kernel for a novel 2d strip pet . </S>"
  ]
}