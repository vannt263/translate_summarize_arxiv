{
  "article_text": [
    "in  @xcite , the authors showed that for the two - dimensional ( 2d ) ising model , at low temperature , monte carlo methods converge faster in the dual forney factor graph than in the original ( primal ) factor graph .",
    "monte carlo methods based on the dual factor graph were also proposed in  @xcite to estimate of the partition function of the 2d ising model in the absence of an external magnetic field ( see also  @xcite ) .    in thermodynamic limits , the exact value of the partition function of the 2d ising model , with constant couplings and in the absence of an external field ,",
    "was first calculated by onsager  @xcite ,  ( * ? ? ?",
    "* chapter 7 ) .",
    "however , the 2d ising model in an arbitrary non - zero external field and the three - dimensional ( 3d ) ising model have remained unsolved  @xcite .    in general , the partition function of 2d models with arbitrary couplings can be estimated using markov chain monte carlo methods  @xcite . in this paper",
    ", we consider the problem of estimating the partition function of the  finite - size \" 2d ferromagnetic ising model in a consistent external field .",
    "we propose monte carlo methods in the dual of the forney factor graph representing the model that can efficiently estimate the partition function . as a special case",
    ", we consider models that are in a strong external magnetic field .",
    "the paper is organized as follows . in section  [ sec : ising ] , we review the ising model and graphical model representations in terms of forney factor graphs . dual forney factor graphs and the factor graph duality theorem are discussed in section  [ sec : nfgd ] .",
    "the proposed monte carlo methods are described in section  [ sec : is ] .",
    "numerical experiments are reported in section  [ sec : num ] .",
    "let @xmath0 be a collection of discrete random variables arranged on the sites of a 2d lattice , as illustrated in fig .",
    "[ fig:2dgrid ] , where interactions are restricted to adjacent ( nearest - neighbor ) variables .",
    "suppose each random variable takes on values in a finite alphabet @xmath1 .",
    "let @xmath2 represent a possible realization of @xmath3 , @xmath4 stand for a configuration @xmath5 , and @xmath6 stand for @xmath7 .    in a 2d ising model , @xmath8 and the hamiltonian ( the energy function ) of a configuration @xmath4",
    "is defined as  @xcite @xmath9 - [ x_k \\ne x_{\\ell}]\\big)\\\\   - \\sum_{m = 1}^n h_m\\cdot\\big([x_m = 1 ] - [ x_m = 0]\\big)\\end{gathered}\\ ] ] where @xmath10 contains all the unordered pairs ( bonds ) @xmath11 with non - zero interactions and @xmath12 $ ] denotes the iverson bracket  ( * ? ? ?",
    "* chapter 2 ) , which evaluates to @xmath13 if the condition in the bracket is satisfied and to @xmath14 otherwise .",
    "the real coupling parameter @xmath15 controls the strength of the interaction between adjacent variables @xmath16 .",
    "the real parameter @xmath17 corresponds to the presence of an external magnetic field . in this paper , we concentrate on ferromagnetic models , characterized by @xmath18 for each @xmath19 .",
    "the external field is assumed to be consistent , i.e. , for @xmath20 , @xmath17 is either assigned to all positive or to all negative values . the probability that the model is in configuration @xmath4 is given by the boltzmann distribution  @xcite @xmath21    here ,",
    "the normalization constant @xmath22 is the _ partition function _ @xmath23 and @xmath24 , where @xmath25 denotes the temperature and @xmath26 is boltzmann s constant .    in the rest of this paper",
    ", we will assume @xmath27 .",
    "hence , large values of @xmath28 and @xmath29 correspond to models at low temperature and in a strong external field .",
    "boundary conditions are assumed to be periodic throughout this paper .",
    "thus @xmath30 . for each adjacent pair @xmath31 ,",
    "let @xmath32 - [ x_k \\ne x_{\\ell}]\\big)}\\ ] ] and for each @xmath33 @xmath34 - [ x_m = 0]\\big)}\\ ] ]    we then define @xmath35 as @xmath36    the corresponding forney factor graph ( normal factor graph ) for the factorization in  ( [ eqn : factorf ] ) is shown in  fig .",
    "[ fig:2dgrid ] , where the boxes labeled `` @xmath37 '' are equality constraints  @xcite .    from ( [ eqn : factorf ] ) , the partition function in  ( [ eqn : prob ] ) can be expressed as @xmath38    to estimate @xmath22 , we propose monte carlo methods in the dual of the forney factor graph representing the factorization  ( [ eqn : factorf ] ) .",
    "( 81,72)(0,0 ) ( 0,60)(4,4)@xmath37 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 8,63)(0,0)[bc]@xmath39 ( 12,60)(4,4 ) ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath37 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 32,63)(0,0)[bc]@xmath40 ( 36,60)(4,4 ) ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath37 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4 ) ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath37 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4 ) ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4 ) ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4 ) ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4 ) ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath37 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4 ) ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath37 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4 ) ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath37 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4 ) ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath37 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4 ) ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4 ) ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4 ) ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4 ) ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath37 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4 ) ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath37 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4 ) ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath37 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4 ) ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath37 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4 ) ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4 ) ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4 ) ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4 ) ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath37 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4 ) ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath37 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4 ) ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath37 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4 ) ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath37 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )",
    "we can obtain the dual of  fig .",
    "[ fig:2dgrid ] , by replacing each variable @xmath41 with its dual variable @xmath42 , each factor @xmath43 with its 2d discrete fourier transform ( dft ) , each factor @xmath44 with its one - dimensional ( 1d ) dft , and each equality constraint with an xor factor  @xcite .",
    "note that @xmath45 also takes on values in @xmath1 .",
    "after suitable modifications , we can construct the dual forney factor graph of the 2d ising model , as shown in  fig .",
    "[ fig:2dgriddm ] . for binary variables @xmath46 boxes containing @xmath47 symbols in  fig .",
    "[ fig:2dgriddm ] , represent xor factors as @xmath48\\ ] ] where @xmath49 denotes the sum in gf(@xmath50 ) , the small boxes attached to each xor factor are as @xmath51 and the unlabeled normal - size boxes attached to each equality constraint represent factors as @xmath52    here , @xmath53 is the coupling parameter associated with each bond . for more details , see  @xcite .    in this paper",
    ", we focus on ferromagnetic models , and as a result , all the factors  ( [ eqn : isingkerneldual ] ) are positive . in a 2d ising model ,",
    "the value of @xmath22 is invariant under the change of sign of the external field  @xcite .",
    "therefore , without loss of generality , we assume @xmath54 for @xmath20",
    ". with this assumption , all the factors  ( [ eqn : isingkerneldual2 ] ) will also be positive . in the dual domain",
    ", we denote the partition function by @xmath55 . in the context of this paper , the normal factor graph duality theorem  ( * ? ? ?",
    "* theorem 2 ) states that @xmath56    ( 77,72)(0,0 ) ( 0,60)(4,4)@xmath57 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 12,60)(4,4)@xmath37 ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath57 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 36,60)(4,4)@xmath37 ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath57 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4)@xmath37 ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath57 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4)@xmath37 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4)@xmath37 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4)@xmath37 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4)@xmath37 ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath57 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4)@xmath37 ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath57 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4)@xmath37 ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath57 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4)@xmath37 ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath57 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4)@xmath37 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4)@xmath37 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4)@xmath37 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4)@xmath37 ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath57 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4)@xmath37 ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath57 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4)@xmath37 ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath57 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4)@xmath37 ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath57 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4)@xmath37 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4)@xmath37 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4)@xmath37 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4)@xmath37 ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath57 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4)@xmath37 ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath57 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4)@xmath37 ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath57 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4)@xmath37 ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath57 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    ( 8,63)(0,0)[bc]@xmath58 ( 32,63)(0,0)[bc]@xmath59    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    roughly speaking , the dual representation transforms the low - temperature region ( i.e. , large j ) to the high - temperature region ( i.e. , small j ) and vice versa . furthermore , due to the presence of the xor factors in  fig .",
    "[ fig:2dgriddm ] , it is possible to simulate a subset of the variables , followed by doing computations on the remaining ones .",
    "these properties can be employed to design efficient monte carlo methods in the dual domain to estimate @xmath22  especially for cases that such an estimation might otherwise be difficult in the original ( primal ) domain .    in section  [ sec :",
    "is ] , we design monte carlo methods in  fig .",
    "[ fig:2dgriddm ] to estimate @xmath55 , which can then be used to compute an estimate of @xmath22 via the normal factor graph duality theorem .",
    "we describe our monte carlo methods ( importance sampling and uniform sampling ) in the dual factor graph of the 2d ising model in an external field .    in  fig .",
    "[ fig:2dgriddm ] , let us partition @xmath61 , into @xmath62 and @xmath63 , with the restriction that @xmath63 is a linear combination ( involving the xor factors ) of @xmath62 .",
    "an example of such a partitioning is illustrated in fig .",
    "[ fig:2dgriddpart ] , where @xmath63 is the set of all the edges connected to the small unlabeled boxes ( which are involved in factors  ( [ eqn : isingkerneldual2 ] ) ) , and @xmath62 is the set of all the bonds ( which are involved in factors  ( [ eqn : isingkerneldual ] ) and are marked by thick edges ) . as will be discussed ,",
    "this choice of partitioning is appropriate for models in a strong external field .    in this set - up ,",
    "a valid configuration @xmath64 in the dual factor graph can be created by assigning values to @xmath62 , followed by updating @xmath63 as a linear combination of @xmath62 .",
    "accordingly , let us define    r , c , l ( * x*_a ) & & _ x_k * x*_a _ k(x_k ) [ eqn : partg ] + ( * x*_b ) & & _ x_m * x*_b _ m(x_m)[eqn : partl ]    from  ( [ eqn : partg ] ) , we define the following probability mass function in @xmath65    r , c , l [ eqn : auxdist ] q(*x*_a ) & & , * x*_a ^||    the probability mass function  ( [ eqn : auxdist ] ) has two key properties .",
    "first , its partition function @xmath66 is analytically available as    r , c , l z_q & = & _ * x*_a ( * x*_a ) + & = & _ k 2(j_k + j_k ) + & = & 2^|| ( _ k j_k ) [ eqn : zq ]    where @xmath67 denotes the cardinality of @xmath10 , which is equal to the number of bonds in the lattice ( cf .",
    "section [ sec : ising ] ) .",
    "second , it is straightforward to draw _ independent _ samples @xmath68 , according to @xmath69 .",
    "the product form of  ( [ eqn : partg ] ) indicates that to draw @xmath70 we can do the following .    *",
    "_ draw _ @xmath71 $ ] * * for * @xmath72 * to * @xmath67 * @xmath73 * @xmath74 *   * @xmath75 *   * * end for *    the quantity @xmath76 is equal to @xmath77 .    as @xmath78 is a linear combination of @xmath79 ,",
    "updating @xmath80 is easy after generating @xmath70 .",
    "these samples are then used in the following importance sampling algorithm to estimate @xmath81 .    * * for * @xmath82 * to * @xmath83 * _ draw _ @xmath84 _ according to _ @xmath69 * _ update _ @xmath80 * * end for * * _ compute _ + r , c , l [ eqn : estr ] z _ & = & _",
    "= 1^l ( * x*_b^ ( ) )    it follows that , @xmath85 is an unbiased estimator of @xmath81 . indeed @xmath86 = z_\\text{d}\\ ] ]    ( 77,72.25)(0,0 ) ( 0,60)(4,4)@xmath57 ( 8,54)(3,3 ) ( 12,60)(4,4)@xmath37 ( 24,60)(4,4)@xmath57 ( 32,54)(3,3 ) ( 36,60)(4,4)@xmath37 ( 48,60)(4,4)@xmath57 ( 56,54)(3,3 ) ( 60,60)(4,4)@xmath37 ( 72,60)(4,4)@xmath57 ( 80,54)(3,3 ) ( 0,50)(4,4)@xmath37 ( 24,50)(4,4)@xmath37 ( 48,50)(4,4)@xmath37 ( 72,50)(4,4)@xmath37 ( 0,40)(4,4)@xmath57 ( 8,34)(3,3 ) ( 12,40)(4,4)@xmath37 ( 24,40)(4,4)@xmath57 ( 32,34)(3,3 ) ( 36,40)(4,4)@xmath37 ( 48,40)(4,4)@xmath57 ( 56,34)(3,3 ) ( 60,40)(4,4)@xmath37 ( 72,40)(4,4)@xmath57 ( 80,34)(3,3 ) ( 0,30)(4,4)@xmath37 ( 24,30)(4,4)@xmath37 ( 48,30)(4,4)@xmath37 ( 72,30)(4,4)@xmath37 ( 0,20)(4,4)@xmath57 ( 8,14)(3,3 ) ( 12,20)(4,4)@xmath37 ( 24,20)(4,4)@xmath57 ( 32,14)(3,3 ) ( 36,20)(4,4)@xmath37 ( 48,20)(4,4)@xmath57 ( 56,14)(3,3 ) ( 60,20)(4,4)@xmath37 ( 72,20)(4,4)@xmath57 ( 80,14)(3,3 ) ( 0,10)(4,4)@xmath37 ( 24,10)(4,4)@xmath37 ( 48,10)(4,4)@xmath37 ( 72,10)(4,4)@xmath37 ( 0,0)(4,4)@xmath57 ( 8,-6)(3,3 ) ( 12,0)(4,4)@xmath37 ( 24,0)(4,4)@xmath57 ( 32,-6)(3,3 ) ( 36,0)(4,4)@xmath37 ( 48,0)(4,4)@xmath57 ( 56,-6)(3,3 ) ( 60,0)(4,4)@xmath37 ( 72,0)(4,4)@xmath57 ( 80,-6)(3,3 )    ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    ( 4,60)(4,-3)4 ( 28,60)(4,-3)4 ( 52,60)(4,-3)4 ( 76,60)(4,-3)4    ( 4,40)(4,-3)4 ( 28,40)(4,-3)4 ( 52,40)(4,-3)4 ( 76,40)(4,-3)4 ( 4,20)(4,-3)4 ( 28,20)(4,-3)4 ( 52,20)(4,-3)4 ( 76,20)(4,-3)4 ( 4,0)(4,-3)4 ( 28,0)(4,-3)4 ( 52,0)(4,-3)4 ( 76,0)(4,-3)4    ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2    ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2    ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2    ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2    ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2    ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2    ( 4,62)(1,0)8 ( 16,62)(1,0)8 ( 28,62)(1,0)8 ( 40,62)(1,0)8 ( 52,62)(1,0)8 ( 64,62)(1,0)8 ( 2,54)(0,1)6 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 74,50)(0,-1)6 ( 4,42)(1,0)8 ( 16,42)(1,0)8 ( 28,42)(1,0)8 ( 40,42)(1,0)8 ( 52,42)(1,0)8 ( 64,42)(1,0)8 ( 2,34)(0,1)6 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 74,30)(0,-1)6 ( 4,22)(1,0)8 ( 16,22)(1,0)8 ( 28,22)(1,0)8 ( 40,22)(1,0)8 ( 52,22)(1,0)8 ( 64,22)(1,0)8 ( 2,14)(0,1)6 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 74,10)(0,-1)6 ( 4,2)(1,0)8 ( 16,2)(1,0)8 ( 28,2)(1,0)8 ( 40,2)(1,0)8 ( 52,2)(1,0)8 ( 64,2)(1,0)8    the proposed importance sampling scheme can yield an estimate of @xmath81 , which can then be used to estimate @xmath22 in  ( [ eqn : partfunction ] ) , using the normal factor graph duality theorem ( cf .  section  [ sec : nfgd ] ) .",
    "the accuracy of  ( [ eqn : estr ] ) depends on the fluctuations of @xmath87 .",
    "if @xmath87 varies smoothly , @xmath85 will have a small variance . with our choice of partitioning in  ( [ eqn : partg ] ) and  ( [ eqn : partl ] ) , we expect to observe a small variance if the model is in a strong ( negative ) external field .",
    "see appendix  i for a discussion .",
    "we can design a uniform sampling algorithm by drawing @xmath88 uniformly and independently from @xmath65 , and by applying    r , c , l [ eqn : estun ] z _ & = & _",
    "= 1^l ( * x*_a^())(*x*_b^ ( ) )    it is easy to verify that , @xmath89 = z_\\text{d}$ ] .",
    "the efficiency of the uniform sampling and the importance sampling algorithms will be close if @xmath53 is very large ( i.e. , when the model is at very low temperature ) .",
    "however , for a wider range of parameters , importance sampling outperforms uniform sampling  as will be illustrated in our numerical experiments in section  [ sec : num ] .",
    "if the model is in a relatively strong external field , we can consider applying annealed importance sampling  @xcite ; see appendix ii .",
    "the choice of partitioning in the dual graph is arbitrary , as long as @xmath78 can be computed as linear combinations of @xmath79 .",
    "the partitioning in  fig .",
    "[ fig:2dgriddpart ] is suitable for models in a strong external field .",
    "an example of a partitioning suitable for models with strong couplings is described in  @xcite .",
    "finally , note that a good general strategy to reduce the variance of monte carlo methods in  fig .",
    "[ fig:2dgriddm ] , is to include factors with larger model parameters ( coupling parameters @xmath28 and the external magnetic field @xmath90 ) in @xmath87 .",
    "we apply the proposed monte carlo methods of section  [ sec : is ] to estimate the log partition function per site , i.e. , @xmath91 , of the 2d ferromagnetic ising model in an external field with spatially varying model parameters .",
    "all simulation results show @xmath91 vs.  the number of samples for one instance of the ising model of size @xmath92 and with periodic boundary conditions . in this case @xmath30 .    in our first two experiments we set @xmath93",
    "the coupling parameters are set to @xmath94 $ ] in the first experiment and to @xmath95 $ ] in the second experiment .",
    "simulation results obtained from importance sampling ( solid lines ) and uniform sampling ( dashed lines ) are shown in figs .",
    "[ fig : ferising1 ] and [ fig : ferising2 ] .",
    "the estimated log partition functions per site are about @xmath96 and @xmath97 , respectively .",
    "everything as in fig .",
    "[ fig : ferising1 ] ; but with @xmath98 $ ] . ]    everything as in fig .",
    "[ fig : ferising1 ] ; but with @xmath98 $ ] . ]    for very large coupling parameters , ( corresponding to models at very low temperature ) , convergence of uniform sampling is comparable to the convergence of the importance sampling algorithm ( see  fig .  [",
    "fig : ferising1 ] ) .",
    "however , as we observe in fig  [ fig : ferising2 ] , uniform sampling has issues with slow convergence for a wider range of coupling parameters , while the importance sampling algorithm performs well in all the ranges .    in our last two experiments we set @xmath99",
    "$ ] . in the third experiment ,",
    "we set @xmath93 $ ] . fig .",
    "[ fig : ferising3 ] shows simulation results obtained from importance sampling , where the estimated log partition function per site is about @xmath100 .",
    "we set @xmath101 $ ] in the last experiment .",
    "the estimated @xmath91 from  fig .",
    "[ fig : ferising44 ] is about @xmath102 .",
    "we observe that convergence of the importance sampling algorithm improves as @xmath29 becomes larger ( see appendix  i ) .",
    "everything as in fig .",
    "[ fig : ferising3 ] ; but with @xmath103 $ ] . ]    everything as in fig .",
    "[ fig : ferising3 ] ; but with @xmath103 $ ] . ]",
    "monte carlo methods were proposed in the dual forney factor graph to estimate the partition function of the 2d ferromagnetic ising model in an external magnetic field . we described a method to partition the variables in the dual factor graph and introduced an auxiliary probability mass function accordingly .",
    "the methods can efficiently estimate the partition function in a wide range of model parameters ; in particular ( with our choice of partitioning ) , when the ising model is in a strong external magnetic field .",
    "indeed , convergence of the methods improve as the external field becomes stronger .",
    "depending on the values and the spatial distribution of the model parameters , different partitionings yield schemes with different convergence properties .",
    "generalizations of the proposed methods to the @xmath104-state potts model are discussed in  ( * ? ? ?",
    "* section v ) .",
    "comparisons with deterministic algorithms in the primal domain ( e.g. , the generalized belief propagation and the tree expectation propagation algorithms , as done in  @xcite ) are left for future work .",
    "the author would like to thank hans - andrea loeliger , pascal vontobel , david forney , justin dauwels , and ali al - bashabsheh for their comments that greatly improved the presentation of this paper .",
    "the author gratefully acknowledges the support of albert guilln i fbregas at upf .",
    "for simplicity , we assume that the coupling parameter and the external field are both constant , denoted by @xmath28 and @xmath29 , respectively . in the dual factor graph ,",
    "let us replace each factor  ( 10 ) by @xmath105 and each factor  ( 12 ) by @xmath106 the required scale factor @xmath107 to recover @xmath81 can be easily computed by multiplying all the local scale factors as @xmath108    note that , @xmath109 , therefore in a strong external field ( i.e. , large @xmath29 ) and at low temperature ( i.e. , large @xmath28 ) , @xmath110 and @xmath111 both tend to constant , which gives reasons for the fast convergence of uniform sampling in this case .",
    "indeed , convergence of the uniform sampling algorithm in the dual domain improves as @xmath28 and @xmath29 both become larger . and",
    "for a fixed @xmath28 , convergence of the importance sampling algorithm improves as @xmath29 becomes larger . for more details , see  ( * ? ? ?",
    "* appendix  i ) .",
    "we briefly explain how to employ annealed importance sampling  @xcite in the dual factor graph to estimate the partition function of the 2d ising model , when the model is in a relatively strong consistent external field .",
    "again , for simplicity , we assume that the coupling parameter and the external field are both constant . the partition function is thus denoted by @xmath112 .",
    "we express @xmath112 using a sequence of intermediate partition functions by varying @xmath29 in @xmath113 levels as @xmath114      if @xmath117 is large enough , @xmath118 can be estimated efficiently via our proposed monte carlo methods . as for the intermediate steps , a sampling technique that leaves the target distribution invariant ( e.g. , metropolis - hastings algorithms or gibbs sampling  @xcite ) is required at each level .",
    "the number of levels @xmath113 should be sufficiently large to ensure that intermediate target distributions are close enough and estimating @xmath118 is feasible ( see also  ( * ? ? ? * section 3 ) ) .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` partition function of the ising model via factor graph duality , '' _ proc .",
    "2013 ieee int . symp . on information theory , _",
    "istanbul , turkey , july 712 , 2013 , pp .",
    "23042308 .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` monte carlo algorithms for the partition function and information rates of two - dimensional channels , '' _ ieee trans .",
    "information theory _ ,",
    "59 , pp .  495503 , jan .",
    "r.  l.  graham , d.  e.  knuth , and o.  patashnik , _ concrete mathematics : a foundation for computer science .",
    "_ addison - wesley , 1989 .",
    "loeliger , `` an introduction to factor graphs , '' _ ieee signal proc .  mag .",
    ", _ vol .",
    "29 , pp .  2841 , jan ."
  ],
  "abstract_text": [
    "<S> we propose monte carlo methods to estimate the partition function of the two - dimensional ising model in the presence of an external magnetic field . </S>",
    "<S> the estimation is done in the dual of the forney factor graph representing the model . </S>",
    "<S> the proposed methods can efficiently compute an estimate of the partition function in a wide range of model parameters . as an example </S>",
    "<S> , we consider models that are in a strong external field . </S>"
  ]
}