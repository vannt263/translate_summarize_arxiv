{
  "article_text": [
    "the detection of compact signals ( sources ) embedded in a background is a recurrent problem in many fields of science .",
    "some common examples in astronomy are the separation of individual stars in a crowded optical image , the identification of local features ( lines ) in noisy one - dimensional spectra or the detection of faint extragalactic objects in microwave frequencies .    regarding the detection of point sources on maps of the cosmic microwave background radiation ( cmb ) , several techniques based on different linear filters",
    "have been proposed in the literature : the mexican hat wavelet ( mhw cayn et al.@xcite , vielva et al.@xcite ) , the classic _ matched _ filter ( mf , tegmark and de oliveira - costa@xcite ) , the adaptive top hat filter ( athf , chiang et al.@xcite ) and the scale - adaptive filter ( saf , sanz et al.@xcite , herranz et al.@xcite ) . a certain deal of controversy has appeared about which one , if any , of the previous filters is _ optimal _ for the detection of point sources in cmb data .    in order to answer that question it is necessary to consider first a more fundamental issue , the concept of _ detection _ itself .",
    "the detection process can be posed as follows : given an observation , the problem is to _ decide _ whether or not a certain signal was present at the input of the receiver .",
    "the decision is not obvious since the observation is corrupted by a random process that we call ` noise ' or ` background ' .",
    "formally , the _ decision _ is performed by choosing between two complementary hypotheses : that the observed data is originated by the background alone ( _ null hypothesis _ ) , and the hypothesis that the observation corresponds to a combination of the background and the signal .",
    "to decide , the detector should use the totality of the available information in terms of the probabilities of both hypotheses given the data . the _ decision device _ separates the space @xmath0 of all possible observations in two disjoint subspaces , @xmath1 and @xmath2 , so that if an observation @xmath3 the null hypothesis is accepted , and if @xmath4 the null hypothesis is rejected , that is , a source is ` detected ' .",
    "hence , we will call any generic decision device of this type a _",
    "detector_.    any detector can produce two kinds of errors : on the one hand , it can produce a _ false alarm _ or _ spurious detection _ when an observation in which no source was present is assigned to the subspace @xmath1 .",
    "the probability of this kind of error depends on the statistical properties of the background and the choice of the detector . on the other hand ,",
    "a signal that is present in the observation can be missed by the detector ( i. e. the observation is wrongly assigned to the subspace @xmath2 ) .",
    "this error is often referred as _ false dismissal_. the probability of false dismissal depends on the statistical properties of the background , the choice of the detector and the properties of the signal ( for example , its intensity ) .",
    "in general , it is not possible to decrease the incidence of both types of error at the same time : one of them can be reduced at expense of increasing the other .",
    "the goodness of a given detector must be established by taking into account the balance between these two types of error .",
    "the most simple example of detector , and one that has been exhaustively used in astronomy , is _",
    "thresholding_. thresholding considers that the space @xmath0 of observations consists of all the possible values of the measured intensity @xmath5 ( in the case of an astronomical image ) and subdivides this space into two simple regions @xmath6 and @xmath7 .",
    "the value @xmath8 is an arbitrarily chosen _ threshold _ that is often expressed as a number of times the standard deviation of the background , @xmath9 . thresholding works on the assumption that the probability of finding a value of @xmath5 due to the background decreases as the value of @xmath5 increases . in the case of a gaussian background ,",
    "this assumption has a very precise meaning and it allows us to straightforwardly control the probability of occurrence of spurious detections simply by setting a large enough threshold .",
    "however , this may lead to a very high probability of false dismissals .",
    "unfortunately , in many cases the sources are very faint and this makes very difficult to detect them : a high threshold means that the number of detections will be very small .",
    "here is where _ filtering",
    "_ enters in scene .",
    "the role of filtering is to transform the data in such a way that a detector can perform better than before filtering .",
    "for example , a filter can be designed in order to reduce the fluctuations of the background so that we can safely use lower detection thresholds and , hopefully , increase the number of detections without increasing the number of spurious detections .",
    "we remark that _ a filter is not a detector _ : the decision device we call ` detector ' can be applied after the application of any imaginable filter , or even no filter at all , while the use of any filter without a posterior detection criterion means nothing",
    ". however , the two different steps in the process ( filtering and detection ) are not independent . in the thresholding example , the use of a filter that cancels most of the fluctuations in the background allows us to change the detection threshold from its original high value to a lower one .",
    "given an adopted detector and a background , it is licit to ask which is the filter that creates the most favorables conditions in the filtered background for the detector to perform . in other words ,",
    "the ` optimality ' of a filter for detection depends on the type of detector chosen which , in turn , depends on the specific _ goal _ the observer has in mind : in certain cases the observer will accept a relatively large number of spurious detections in order to have a large number of true targets , whereas in other cases it could be more important to be certain that the detections are all of them reliable , and so on .",
    "for example , let us consider that we have chosen thresholding as our detection device . in that case , it has been shown that the optimal linear filter is the matched filter .",
    "it produces the maximum amplification of the signal with respect to the background fluctuations , so that the threshold for a given probability of spurious detections is minimum , allowing the thresholding detector to find more sources than would be detected if we filtered with any other filter .",
    "a sub - optimal approach , using only thresholding , is to select a priori a filter and adapt its scale in order to produce a maximum amplification in a given background .",
    "such is the case of the mexican hat wavelet at the optimum scale ( mho , vielva et al.@xcite ) and the adaptive top hat filter ( athf , chiang et al.@xcite ) .",
    "thresholding has a number of advantages , among them the facts that it is straightforward , it has an obvious meaning in the case of gaussian backgrounds , and it has been successfully used for many years in many fields of science .",
    "it , however , does not use all the available information contained in the data to perform decisions .",
    "the question is then : is it possible to devise a detector that uses additional information apart from mere intensities and that produces better results than thresholding ? and , if so , which is the filter that optimizes the performance of such a detector ?",
    "let us focus on the case of one - dimensional data ( such as stellar spectra , or time - ordered scannings of the sky in cmb experiments ) and linear filters .",
    "data in a one - dimensional array is entirely described by two quantities , namely the position in the array ( corresponding to the spatial or temporal coordinate , for simplicity we will refer it as _ spatial _ information ) and the value ( intensity ) at each position . thresholding uses only the intensity distribution to make the decision .",
    "clearly , the inclusion of spatial information in a detector should be useful .",
    "for example , it could help to distinguish the sources from fluctuations in the background with similar scale but a different shape . a full description of this `",
    "spatial information ' should include the probability distribution of events ( both due to background and sources ) in space , with all its infinite moments .",
    "we will somewhat relax this demand of information assuming that the background is homogeneous and isotropic , and asking at each point for some information about the shape of the sources and the autocorrelation of the background ( for example , the curvature of the peaks ) .",
    "in fact , even a simple filtering - and - thresholding scheme uses implicitly some degree of spatial information .",
    "both the mho and the athf adapt to the scale at which the contrast between sources and background produces the maximum amplification .",
    "the mf includes as well the information on the profile of the sources in order to amplify the structures whose shape correlates with the shape of the sources .",
    "saf goes a step further in constraining additionally the scale of the filter .",
    "moreover , in most cases the detection is performed not in all the points of the data but only in the peaks , that is , _ in those points where the curvature is positive_.    in a recent work , barreiro et al.@xcite propose a detection criterion based on the neyman - pearson decision rule that uses the information of both the intensities @xmath5 and the curvatures @xmath10 of the peaks in a data set . in that work the performances of several filters ( saf , mf and mhw ) is compared in terms of their _ reliability _ , defined as the ratio between the probability density of true detections over the probability density of spurious detections .",
    "they find that , on the basis of this quantity , the choice of the optimal filter depends on the statistical properties of the background . for the case of backgrounds that can be described with a power spectrum of the form @xmath11 , the saf outperforms the other two filters for the case @xmath12 , whereas in the range @xmath13 the mf is the most reliable .",
    "the mhw is the most reliable filter in this sense when @xmath14 .",
    "the reliability , defined in the previous sense , could not be a valid measure of performance of the filters , since it favors a situation in which the number of the detections is very low in order to keep a ` safe ' number of spurious detections .",
    "a different approach can be used in which the number density of spurious detections ( or , alternatively , of true detections ) is fixed for all the filters , and then the number density of true detections ( or spurious detections ) is compared for all the filters . in this work ,",
    "we first clearly define the _ goal _ of our experiment : fixed a certain number density of spurious detections , to obtain the maximum possible true detections from the data .",
    "note that this goal is not universal : in other applications , an observer may desire to work on the basis of the reliability described in barreiro et al.@xcite , or define its own requirements .",
    "once fixed the goal , we will develop a detection criterion that corresponds to a bayesian generalized neyman - pearson test .",
    "then , a particular filter from the family of matched - type filters ( mtf ) that optimizes the performance of the detector under the optimality conditions set by our goal will be obtained .",
    "finally , the performance of the optimal mtf will be compared with the standard mf using simulations .",
    "the overview of this paper is as follows : in section 2 , we introduce two useful quantities : number of maxima in a gaussian background in the absence and presence of a local source . in section 3 , we introduce the detection problem and define the region of acceptance . in section 4",
    ", we obtain different analytical and numerical results regarding point sources and scale - free background spectra and compare the performance of a new family of matched - type filters . in section 5 , we describe the numerical simulations performed to test some theoretical aspects and give the main results .",
    "finally , in section 6 , we summarize the main results and applications of this paper .",
    "let us assume a 1d background ( e. g. one - dimensional scan on the celestial sphere or time ordered data set ) represented by a gaussian random field @xmath15 with average value @xmath16 and power spectrum @xmath17 : @xmath18 , where @xmath19 is the fourier transform of @xmath15 and @xmath20 is the 1d dirac distribution .",
    "the distribution of maxima was studied by rice@xcite in a pioneer article . the expected number density of maxima per intervals @xmath21 , @xmath22 and @xmath23 is given by @xmath24 being @xmath25 the expected total number density of maxima ( i. e. number of maxima per unit interval @xmath26 ) @xmath27    @xmath28    where @xmath29 and @xmath30 represent the normalized field and curvature , respectively .",
    "@xmath31 is the moment of order @xmath32 associated to the field .",
    "@xmath33 are the coherence scale of the field and maxima , respectively .",
    "if the original field is linear - filtered with a circularly - symmetric filter @xmath34 , dependent on @xmath35 parameters ( @xmath36 defines a scaling whereas @xmath37 defines a translation ) @xmath38 we define the filtered field as @xmath39 then , the moment of order @xmath40 of the linearly - filtered field is @xmath41 being @xmath42 the power spectrum of the unfiltered field and @xmath43 the fourier transform of the circularly - symmetric linear filter .      now , let us consider a gaussian source ( i. e. profile given by @xmath44 ) embedded in the previous background .",
    "then , the expected number density of maxima per intervals @xmath21 , @xmath22 and @xmath45 , given a source of amplitude @xmath46 in such spatial interval , is given by ( barreiro et al.@xcite ) @xmath47 where @xmath29 and @xmath30 , @xmath48 is the normalized amplitude of the source and @xmath49 is the normalized curvature of the filtered source .",
    "the last expression can be obtained as @xmath50 we consider that the filter is normalized such that the amplitude of the source is the same after linear filtering : @xmath51 .",
    "we want to make a decision between filters based on _ detection_. to make such a decision , we will focus on the following two fundamental quantities : a ) the number of spurious sources which emerge after the filtering and detection processes and b ) the number of real sources detected . as seen in the previous section , these quantities are properties of the gaussian field and source that can be calculated through equations ( [ nbackground ] ) and ( [ nsource ] ) .",
    "as we will see , the previous properties are not only related to the signal - to - noise - ratio gained in the filtering process but depend on the filtered momenta to 4th - order ( in the 1d case ) , i. e. the amplification and the curvature of the source .      let us consider a local peak in the 1d data set characterized by the normalized amplitude and curvature @xmath52 .",
    "let @xmath53 represents the _ null _ hypothesis , i. e. the local number density of background maxima , and @xmath54 represents the _ alternative _ hypothesis , i. e. the local number density of maxima when there is a compact source with normalized amplitude and curvature @xmath55 .",
    "given the data @xmath56 , we can associate to any region @xmath57 two number densities @xmath58 and @xmath59 @xmath60",
    "@xmath61 then , @xmath58 is the number density of spurious sources , i. e. due to the background , expected inside the region @xmath57 , whereas @xmath59 is the number density of maxima expected in the same region of the @xmath62 space in the presence of a local source .",
    "hereinafter , we will call it the _ number density of detections_. we will assume a bayesian approach : at a concrete pixel we get the number of source detections weighting with the _ a priori _ probability @xmath63 .",
    "@xmath1 is called the _ acceptance _ region .",
    "we remark that in order to get the true number of real source detections such a number must be multiplied by the probability to have a source in a pixel in the original data set .",
    "we will assume a bayesian generalized neyman - pearson decision rule using number densities instead of probabilities : the acceptance region @xmath1 giving the highest number density of detections @xmath59 , for a given number density of spurious @xmath58 , is the region ( criterion for detection ) @xmath64 we decide that the signal is present , whereas if @xmath65 we decide that the signal is absent .",
    "once we have assumed the previous decision rule for detection , the region of acceptance @xmath1 is given by @xmath66 or equivalently by the sufficient linear detector @xmath67 where @xmath68 is a constant and @xmath69 is given by @xmath70 we remark that the assumed criterion for detection leads to a _ linear _ detector @xmath69 ( i. e. linear dependence on the threshold @xmath71 and curvature @xmath10 ) .",
    "once obtained the region of acceptance @xmath1 in the previous subsection , one can calculate the number density of spurious sources and the number density of detections as given by equations ( [ eq : nbstar ] ) and ( [ eq : nstar ] ) .",
    "@xmath72 , \\nonumber \\\\ h&=&\\sqrt{\\frac{1-\\rho^2}{2(1 - 2\\rho y_s+y_s^2 ) } } , \\label{naceptb}\\end{aligned}\\ ] ] @xmath73e^{- \\frac{(1 - \\rho^2)\\varphi^2 } { 2{(1 - \\rho y_s)}^2}},\\end{aligned}\\ ] ] @xmath74 then , one can invert the equation for the number of spurious to get @xmath75 that allows to rewrite the equation for the number of detections as @xmath76 .",
    "we will considerer as application the detection of compact sources characterized by a gaussian profile @xmath77 , though the extension to other profiles will be considered in the future .",
    "such a profile is physically and astronomically interesting because represents the convolution of a point source ( dirac @xmath78 distribution ) with a gaussian beam .      by introducing a circularly - symmetric filter , @xmath34",
    ", we are going to express the conditions in order to obtain a matched filter for the detection of the source @xmath79 at the origin taking into account the fact that the source is characterized by a single scale @xmath80 .",
    "the following conditions are assumed : @xmath81 , i. e. @xmath82 is an _ unbiased _ estimator of the amplitude of the source ; @xmath83 the variance of @xmath84 has a minimum at the scale @xmath80 , i. e. it is an _ efficient _",
    "estimator @xmath85 this will be called _ matched _ filter as is usual in the literature .    for the case of a gaussian profile for the source and a scale - free power spectrum given by @xmath86",
    ", the previous formula leads to the following matched filter @xmath87 for the mf the parameters @xmath88 and the curvature of the source @xmath89 are given by @xmath90 we remark that the linear detector @xmath91 is reduced to @xmath92 i.e. the curvature does not affect the region of acceptance for the mf and the sufficient detector @xmath69 reduces to the plain thresholding detector .",
    "let us modify the filtering scale as @xmath93 to introduce a family of matched - type filters .",
    "in particular , if we consider the white noise case ( @xmath94 ) , this family is given by @xmath95 therefore , this family allows one to filter at scales different from the one of the source .",
    "obviously , for @xmath96 the usual mf is recovered .",
    "the parameters characterizing the background and source are in this case modified in the following way @xmath97 @xmath98      in this case , @xmath99.\\ ] ] this allows one to obtain @xmath100,\\ \\ u\\equiv \\frac{\\varphi } { \\sqrt{2(y^2_s + \\mu ) } } .\\ ] ]      hereinafter , we shall consider the case of white noise @xmath101 for the background and a uniform distribution for the point sources in an interval @xmath102 $ ] .",
    "@xmath103 has been chosen to produce a threshold of 2 for the filtered field using the standard mf .",
    "the corresponding thresholds for the mmf can be easily obtained using equation ( [ eq : nualpha ] ) .",
    "we would like to point out that this reflects a situation where we want to detect very weak sources , which were below the @xmath104 level in the original unfiltered map .",
    "the region of acceptance @xmath1 is defined by the sufficient linear detector @xmath69 .",
    "let us consider equation ( [ naceptb ] ) , giving the number density of spurious , then one can invert to get @xmath105 . in fig .",
    "[ fig : teoricas ] we show some results for the cases @xmath36=3 , @xmath106 and @xmath36=4 , @xmath107 .",
    "the two panels on the left correspond to the first case and the ones on the right to the second one .",
    "the top figures show the expected number density of detections versus the @xmath108 parameter of the filter .",
    "it is interesting to remark that such a number decreases with @xmath108 .",
    "in fact , the largest number of detections are obtained for @xmath109 which corresponds approximately to filter at the pixel scale .",
    "the relative ratio to the standard mf defined as @xmath110 is shown in the bottom panels .",
    "for the first case , the ratio takes values up to @xmath111 per cent whereas for the second it goes up to @xmath112 per cent .",
    "these results clearly indicate that , under certain conditions , the standard mf can be improved by simply modifying the scale of the filter .",
    "we remark the importance of the curvature defining the acceptance regions for the mtf .    [ cols=\"^ \" , ]",
    "this methodology is optimal for weak sources embedded in white noise .",
    "regarding bright sources , the amplification plays a major role as compared to curvature entering the acceptance region .",
    "therefore , the use of the mf is well justified in this case .",
    "regarding the behavior of the detector with respect to the scale @xmath36 , we found that if @xmath36 is very low the sources become more and more point - like and they are more easily mistaken with the fluctuations of the background .",
    "therefore , in these cases the curvature does not help to distinguish among them and the detector tends again to the thresholding case which favors the use of the mf .",
    "the detection of compact sources on a background is a relevant problem for many fields , in particular for astronomy .",
    "several detection techniques based on the use of linear filters thresholding - based detectors are standard . here",
    ", we have considered an approach to the problem of detector design based on a bayesian generalization of the neyman - pearson rule that includes _ a priori _ information of the source distribution and the number densities of maxima ( background and background plus source ) to define the acceptance region .",
    "our approach based on maxima includes both the amplitude and the curvature .",
    "therefore , the chances of detection do not depend only on the amplification of the sources produced by the filtering but also on the filtered momenta up to the fourth order .",
    "this determines in a strong way the designing of the linear filters that are used to help the detection .",
    "we have applied our technique to a family of matched - type filters ( mtf ) by modifying the scale of the standard matched filter .",
    "we considered the very interesting case of white noise to represent the background .",
    "as an example , we have considered a uniform distribution of sources in the interval @xmath113 in the filtered field , i.e. weak sources .",
    "we have shown that the curvature plays an important role defining the acceptance region and we have proven that the number of detections in the case of a filter with a scale similar to the pixel size beats the number of detections in the case of the standard mf .",
    "this result has been tested with numerical simulations for a uniform distribution and white noise .",
    "the ideas presented in this paper can be generalized : application to other profiles ( e. g. multiquadrics , exponential ) and non - gaussian backgrounds is physically and astronomically interesting .",
    "the extension to include several images ( multi - frequency ) is relevant .",
    "the generalization to two - dimensional data sets ( plane and spherical maps ) and nd images is also very interesting .",
    "finally the application of our method to other fields is without any doubt .",
    "we are currently doing research in some of these topics .",
    "the authors thank enrique martnez - gonzlez and patricio vielva for useful discussions .",
    "rbb thanks the ministerio de ciencia y tecnologa ( mcyt ) and the universidad de cantabria for a ramn y cajal contract .",
    "dh acknowledges support from the european community s human potential programme under contract hprn - ct-2000 - 00124 , cmbnet .",
    "mlc thanks the mcyt for a predoctoral fpi fellowship .",
    "we acknowledge partial support from the spanish mcyt projects esp2001 - 4542-pe and esp2002 - 04141-c03 - 01 and from the eu research training network ` cosmic microwave background in europe for theory and data analysis '      cayn , l. , sanz , j. l. , barreiro , r. b. , mart nez - gonzlez , e. , vielva , p. , toffolatti , l. , silk , j. , diego , j. m. & argeso , f. , `` isotropic wavelets : a powerful tool to extract point sources from cosmic microwave background maps '' , _ mnras _ * 315 * , pp .",
    "757 - 761 , 2000 .",
    "vielva , p. , barreiro , r. b. , hobson , m.p . , martnez - gonzlez , e. , lasenby , a. , sanz , j. l. & toffolatti , l. , `` combining maximum - entropy and the mexican hat wavelet to reconstruct the microwave sky '' , _ mnras _ * 328 * , pp . 1 - 16 , 2001 .",
    "chiang , l.y . ,",
    "jrgensen , h.e . ,",
    "naselsky i.p . ,",
    "naselsky p.d .",
    ", novikov i.d .",
    "& christensen , p.r . , `` an adaptive filter for the construction of the planck compact source catalogue '' , _ mnras _ * 335 * , pp . 1054 - 1060 , 2002 .",
    "herranz , d. , sanz , j. l. , hobson , m. , barreiro , r. b. , diego , j. m. , martnez - gonzlez , e. lasenby , a.n .",
    ", `` filtering techniques for the detection of sunyaev - zeldovich clusters in multifrequency maps '' _ mnras _ * 336 * , pp .",
    "1057 - 1068 , 2002 .",
    "herranz , d. , gallegos , j. , sanz , j. l. & martnez - gonzlez , e. , `` point source detection and extraction from simulated planck time - ordered data using optimal adaptive filters '' , _ mnras _ * 334 * , pp .",
    "533 - 541 , 2002 ."
  ],
  "abstract_text": [
    "<S> we consider filters for the detection and extraction of compact sources on a background . </S>",
    "<S> we make a one - dimensional treatment ( though a generalization to two or more dimensions is possible ) assuming that the sources have a gaussian profile whereas the background is modeled by an homogeneous and isotropic gaussian random field , characterized by a scale - free power spectrum . </S>",
    "<S> local peak detection is used after filtering . </S>",
    "<S> then , a bayesian generalized neyman - pearson test is used to define the region of acceptance that includes not only the amplification but also the curvature of the sources and the a priori probability distribution function of the sources . </S>",
    "<S> we search for an optimal filter between a family of matched - type filters ( mtf ) modifying the filtering scale such that it gives the maximum number of real detections once fixed the number density of spurious sources . </S>",
    "<S> we have performed numerical simulations to test theoretical ideas . </S>"
  ]
}