{
  "article_text": [
    "during the last decade , the physicists community working on the theory of complex networks has paid special attention to the problem of epidemic spreading in social @xcite , biological @xcite and technological networks @xcite .",
    "the development of mathematical and computational models to guide our understanding of the disease dynamics has allowed to address important issues such as the influence of diverse contact patterns and also new algorithms for immunization and vaccination policies @xcite .",
    "physicist s approaches to problems in epidemiology invoke statistical physics , the theory of phase transitions and critical phenomena @xcite , to grasp the macroscopic behavior of epidemic outbreaks @xcite .",
    "it is not adventurous to claim that one of the main artifices of this success has been the mean - field ( mf ) approximation , where homogeneity and isotropy are hypothesized to reduce the complexity of the system under study .    on the other hand ,",
    "the study of the topological properties of complex networks @xcite has provided new grounds to the understanding of contagion dynamics . particularly widespread in nature are heavy tailed degree distributions , specially scale - free ( sf ) networks , whose degree distribution follows a power law @xmath0 for the number of connections , @xmath1 , an individual has .",
    "sf networks include patterns of sexual contacts @xcite , the internet @xcite , as well as many other social , technological and biological networks @xcite .",
    "the critical properties of an epidemic outbreak in sf networks were addressed using the heterogeneous mean - field ( hmf ) prescription ( also called correlated mean field ) @xcite .",
    "hmf coarse - grains vertices within degree classes and hypothesizes that all nodes in a degree class have the same dynamical properties ; the approach also assumes that fluctuations can be neglected @xcite .",
    "this framework has been proved to be exact in annealed networks , whose nodes degrees are sampled from a fixed degree distribution at each step of the dynamics @xcite ( i.e.  its specific connectivity is fixed only in average ) . however , in specific realizations of a model s topology ( quenched networks ) , hmf can result in different levels of accuracy @xcite .",
    "this problem leads to the question of whether or not the direct use of the hmf approach is accurate enough when dealing with real networks ( i.e. , in an instance of a network ensemble ) . in a recent work ,",
    "gleeson et al .",
    "@xcite studied how accurate the hmf can be on 21 real - world networks and found some relationships between the predictive accuracy and topological properties of the networks .",
    "also other works have addressed this problem using pair approximations , in particular miller @xcite has found analytical results for a special class of clustered networks .",
    "although the hmf approach has been extremely useful to assess the critical properties of epidemic models , it is not thought to give information of individual nodes but of classes of nodes of a given degree .",
    "then , asking about the probability that a given node is infected is not well - posed in this framework . to obtain more details at the individual ( node ) level of description , usually one has to rely on monte carlo ( mc ) simulations of the actual dynamics , which have also been used to validate the results obtained using hmf methods .",
    "the current theory concentrates in two specific situations , the contact process @xcite ( cp ) and the fully reactive process @xcite ( rp ) .",
    "a cp stands for a dynamical process that involves an individual stochastic contagion per infected node per unit time , while in the rp there are as many stochastic contagions per unit time as neighbors a node has .",
    "however , in real situations , the number of stochastic contacts per unit time is surely a variable of the problem itself @xcite .",
    "recently , some of us have proposed an alternative approach to study the susceptible - infected - susceptible ( sis ) model @xcite considering the number of stochastic contacts as a parameter that defines a whole family of sis models @xcite , the so - called microscopic markov - chain approach ( mmca ) .",
    "this more realistic scenario allows to characterize the prevalence of the disease at the level of individual nodes when the number of contacts interpolates between the two limiting cases of cp and rp .",
    "capitalizing on the mmca framework , we propose here a non - perturbative hmf formulation which does not prune the equations at first order in the prevalence density , but considers the whole series expansion .",
    "the resulting equations can be solved using fixed point iteration , and are accurate in predicting the epidemic incidence for the whole phase diagram , even out of the critical transition region .",
    "the analysis of epidemic spreading models in networks has some of the same difficulties that are found for well - mixed populations ( equivalent to complete graphs ) .",
    "these difficulties are intrinsic to the discrete - time or continuous - time formulation of the governing equations , and the methods used to solve each of them .",
    "continuous approximations have been more popular in epidemic modeling because of their mathematical tractability , and the avoidance of chaotic behaviors that can arise in their discrete counterparts @xcite . for the sake of clarity ,",
    "we henceforth fix our attention on the study of a family of sis models . in a sis model ,",
    "individuals that are cured do not develop permanent immunity but are immediately susceptible to the disease again . in well - mixed populations ,",
    "the differential equations governing the number of susceptible ( s ) and infected ( i ) individuals are @xmath2 where @xmath3 is the ( constant ) size of the population .",
    "the term @xmath4 accounts for the probability of contacting an infected individual in a well - mixed population of size @xmath5 , @xmath6 is the infectivity rate ( probability per unit time ) for each contact , and @xmath7 is the rate at which one infected individual recovers .",
    "their corresponding difference equations are @xmath8\\ , ,    \\label{diff}\\end{aligned}\\ ] ] or equivalently @xmath9\\ , .",
    "\\label{diffi}\\ ] ] defining @xmath10 as the fraction of infected individuals in the population , eq .",
    "( [ diffi ] ) is written as @xmath11\\ , .",
    "\\label{difffraci}\\ ] ]    note that while the system of eqs .",
    "( [ cont ] ) always converges to a solution @xcite , eq .",
    "( [ difffraci ] ) can be mapped to a logistic function when the reproductive ratio @xmath12 , thus giving rise to basic periodicity , bifurcations and chaotic behavior depending on the parameters @xcite .",
    "although both descriptions are equivalent in the limit @xmath13 , differences arise when considering a finite @xmath14 .",
    "particularly interesting is what happens when considering a numerical scheme iterating eq .",
    "( [ difffraci ] ) .",
    "in many cases @xmath14 is usually assimilated to the stochastic simulation time unit and set to 1 .",
    "consequently , the numerical differences with the continuous case are substantial .",
    "it is also important to distinguish between rates and probabilities , @xmath15 is a probability , and the same holds for @xmath16 .",
    "again , by setting @xmath17 , one can mix up rate and probabilities because both will have the same values , even though their units are different .",
    "the mapping of the above sis equations to the case of heterogeneous networks is not straightforward and has its critical step in the redefinition of the probability of contacts . in a network ,",
    "the number of contacts is restricted to a fixed neighborhood , then each individual ( node ) can potentially contact only its neighbors . in the seminal work by pastor - satorras and vespignani",
    "@xcite , these authors proposed the direct use of eq .",
    "( [ difffraci ] ) for classes of nodes based on their degree @xmath1 .",
    "this is the root of the hmf approach in complex networks and the hypothesis of homogeneity is here postulated at the level of classes of nodes .",
    "the rationale behind this assumption is that the dynamical behavior of any two nodes with the same degree @xmath1 will be essentially the same .",
    "then , a system of equations for each class @xmath1 is written as @xmath18\\ , ,    \\label{hmfvr}\\ ] ] where now @xmath19 stands for the fraction of infected individuals of degree @xmath1 , and the probability of contacting an infected node is encoded in the new function @xmath20 . for the general case of correlated networks , the function @xmath20 takes the form @xmath21 where @xmath22 is the probability that a node of degree @xmath1 connects to a node of degree @xmath23 .",
    "eq.([hmfvr ] ) is used to find the stationary value of the incidence for given values of @xmath24 and @xmath25 .",
    "indeed , for the stationary state , it is true that the only dependence to take into account is the ratio @xmath26 because the equations can be rescaled without modifying their solutions .",
    "however , this is not anymore the case during the transient .",
    "the critical value @xmath27 for the epidemic threshold was found in @xcite to be @xmath28 being @xmath29 the largest eigenvalue of the connectivity matrix of classes of nodes @xmath30 , whose components are given by @xmath31 , i.e.  the expected number of links from a node of degree @xmath1 to nodes of degree @xmath23 .",
    "in this section , we summarize an alternative approach to describe the equations governing the sis class of models @xcite .",
    "we henceforth refer to this formulation as microscopic markov - chain approach ( mmca ) .",
    "the main advantage of this approach is that it is able to deal with the infection dynamics at the level of single nodes .",
    "specifically , we focus on the probability of a node to be infected at time @xmath32 . for each node @xmath33",
    ", we construct a markov chain that accounts for the probability of infection @xmath34 , assuming that the number of contacts of node @xmath33 with its neighbors is parameterized by an integer @xmath35 , and that the infection events are uncorrelated .",
    "note that this constitutes a first principles derivation of a discrete model , not a discretization of a differential equation .",
    "we consider two different situations of interest : i ) without reinfections ( wor ) , and ii ) with reinfections ( wir ) .",
    "the first case implies that the time scales for the infection and cure are well separated , whereas the latter assumes that the same time scale holds for infection and cure and therefore a just recovered individual might catch the disease again within the same time step @xmath32 .",
    "the respective equations are : @xmath36[1-q_{i}(t ) ] + ( 1-\\mu ) p_{i}(t)\\ , ,    \\label{eqwor }    \\\\",
    "\\nonumber    \\\\    & \\mbox{wir : } & \\nonumber    \\\\    & p_{i}(t+1 ) = [ 1-q_{i}(t ) ] + ( 1-\\mu ) p_{i}(t ) q_{i}(t)\\ , ,    \\label{eqwir}\\end{aligned}\\ ] ] where the probability @xmath37 of node @xmath33 not being infected by any neighbor is @xmath38\\ , .",
    "\\label{eqqi}\\ ] ]    keeping in mind the separation of the two processes , namely , contacting a node and transmitting the infection , already presented in eqs .",
    "( [ diff ] ) for the well - mixed case , the explanation of these equations is straightforward .",
    "the terms in the r.h.s .  of eq .",
    "( [ eqwor ] ) account respectively for the probability that a susceptible node @xmath39 $ ] is infected by at least one neighbor @xmath40 $ ] , and an infected node does not recover @xmath41 $ ] .",
    "( [ eqwir ] ) adds , after some algebra , a term that accounts for the probability that an infected node recovers @xmath42 $ ] but gets infected again by a neighbor @xmath40 $ ] in the same time step . finally , in eq .",
    "( [ eqqi ] ) , we have the probabilities that infected nodes @xmath43 $ ] contact node @xmath33 , and that these contacts lead to new infections , which occur with probability @xmath24 .",
    "the values of the contact probabilities @xmath44 can be expressed as @xmath45 for weighted networks , and @xmath46 for unweighted networks , where @xmath47 for the contact process , @xmath48 and @xmath49 , whereas for the fully reactive process , @xmath50 and @xmath51    at the stationary state , eqs .",
    "( [ eqwor ] ) and  ( [ eqwir ] ) are independent of the discrete time - step , and simplify to @xmath52 with @xmath53 these equations are easily solved by fixed point iteration until a fixed point ( for the wir and wor cases ) or a cycle ( for the wor setup ) is found . in this second case ,",
    "averaging over the oscillating values of the quantity of interest must be considered .",
    "finally , the average fraction of infected nodes in the stationary state is given by @xmath54",
    "in heterogeneous mean field theory it is supposed that all nodes of the same degree behave equally . in terms of the mmca formulation",
    "this means that @xmath55 if @xmath56 , and the density @xmath57 of infected nodes of degree @xmath1 is given by @xmath58 where @xmath59 is the set of nodes with degree @xmath1 , whose cardinality is denoted by @xmath60 .",
    "this notation allows to group together terms according to the degrees of the nodes .",
    "for instance , if the degree of node @xmath33 is @xmath61 , then @xmath62 where @xmath63 is the expected number of links from a node of degree @xmath1 to nodes of degree @xmath23 , as explained in sect .",
    "[ sect2 ] .",
    "substitution of the hmf approximation , eq .",
    "( [ rhok ] ) , into the mmca eqs .",
    "( [ eqworst ] ) and  ( [ eqwirst ] ) leads to @xmath64 which can also be written as @xmath65 these equations constitute the hmf approximations of mmca for the sis model without and with reinfections , respectively .",
    "we still need a hmf expression for @xmath66 . for unweighted networks",
    "the value of @xmath67 is @xmath68 if node @xmath33 has degree @xmath61 , then @xmath69 where we have grouped together the terms in the product by their degrees @xmath23 as in eq .",
    "( [ exsum ] ) .",
    "the expression within the parentheses is equal to @xmath70 for all nodes of degree @xmath23 that are not connected to node @xmath33 ( @xmath71 ) , and equal to @xmath72 $ ] for nodes of degree @xmath23 that are linked to @xmath33 ( @xmath73 ) .",
    "besides , the expected number of such terms is @xmath74 .",
    "hence , we obtain @xmath75 eqs .",
    "( [ nphmfwor ] ) and  ( [ nphmfwir ] ) , together with eq .",
    "( [ nphmfq ] ) , form what we call the _ non - perturbative heterogeneous mean field _ ( nphmf ) equations of the sis model in unweighted networks .",
    "note that in the derivation of the nphmf equations no assumption has been made about the proximity of the system to the epidemic threshold , where the epidemic prevalence is small , nor any linear approximation has been invoked , hence the qualification of `` non - perturbative '' .",
    "the solution of the nphmf equations follows the same steps as in mmca , i.e. , eqs .",
    "( [ nphmfworiter ] ) , ( [ nphmfwiriter ] ) and  ( [ nphmfq ] ) are iterated until a fixed point ( wir , wor ) or a cycle ( wor ) is found .",
    "as before , for the latter case , we take the average of oscillating values for the disease prevalence . finally , the global epidemic prevalence is given by @xmath76    it is easy to show that the standard hmf equations @xcite are just a linear approximation of our wor nphmf equations .",
    "near the epidemic threshold @xmath77 , where @xmath78 , we get @xmath79 which can be inserted into eq .",
    "( [ nphmfwor ] ) to give @xmath80 where @xmath81      to round off our analysis , we derive the critical spreading threshold using the different approaches here discussed . in",
    "@xcite it is shown that mmca allows the determination of the epidemic threshold @xmath82 where @xmath83 is the maximum eigenvalue of the matrix @xmath84 of the contact probabilities @xmath85 .",
    "in particular , @xmath86 these results hold both with and without reinfections , since at first order , eqs .",
    "( [ eqwor ] ) and  ( [ eqwir ] ) coincide . in the same way ,",
    "the critical points from nphmf eqs .",
    "( [ nphmfwor ] ) and  ( [ nphmfwir ] ) are the same as in standard hmf , where the matrix @xmath87 with elements @xmath88 replaces matrix @xmath84 , @xmath89 with the well - known particular cases @xmath90 the comparison with monte carlo ( mc ) simulations shows that mmca provides a better approximation to the epidemic threshold than hmf , since no information of the original network structure is lost .",
    "additionally , by the definition of the contact probabilities , the mmca is applicable to weighted and directed networks without further modifications of the equations .",
    "this is not the case when one deals with hmf in networks that are not unweighted and undirected .     as a function of the infection rate @xmath24 .",
    "the different curves correspond ( as indicated ) to monte carlo results and the numerical solutions of the fixed point equations of the different approaches ( mmca , hmf and nphmf ) for a sf network made up of @xmath91 nodes using the configuration model .",
    "the exponent of the degree distribution is @xmath92 .",
    "the contact probabilities used correspond to the case of a fully reactive process and @xmath25 has been set to @xmath93.,scaledwidth=49.0% ]",
    "to compare the results coming out from the different approaches , we have performed mc simulations of the disease dynamics on top of scale - free networks generated using the uncorrelated configuration model .",
    "besides , numerical solutions of the fixed point equations have also been obtained . for high values of @xmath25 and @xmath24 , mmca without reinfections does not converge to a fixed point as the rest , but it converges to an oscillation between two states , from which the average is taken .",
    "these oscillations are also present in the mc runs , and dissapear after averaging over multiple runs . on the other hand ,",
    "standard hmf can not be solved by iteration , since it diverges even for small values of @xmath94 .",
    "therefore , we have made use of a nonlinear minimization algorithm based on a successive quadratic programming solver .",
    "of infected individuals of degree @xmath1 from nphmf versus the infection probabilities @xmath95 ( black ) and their average @xmath96 over nodes with the same degree ( blue ) obtained from mc .",
    "the epidemic model is a rp with reinfections with @xmath97 and @xmath98 . for the sake of clarity , we have used in this case an sf network of 500 nodes with @xmath92.,scaledwidth=49.0% ]    figure  [ fig1 ]",
    "shows the comparison between all the approaches discussed throughout this paper for the case in which a fully reactive process is considered .",
    "as can be seen , the worst performance with respect to mc simulations corresponds to the hmf , which correctly predicts the epidemic threshold but fails to reproduce the evolution of the epidemic incidence as the infection rate increases and moves away from the critical point .",
    "the figure also shows that the nphmf approximation behaves only slightly worse than the markov chain formulation .",
    "more important , in addition to correctly capturing the critical epidemic threshold and at variance with the standard hmf , it allows to study the whole phase diagram whatever the value of the infection rate is .",
    "c +    to provide further evidences of the validity of the nphmf , we have represented in fig  [ fig2 ] the epidemic incidence of nodes of degree @xmath57 as given by the solution of the nphmf equations as a function of the probability @xmath95 that a node @xmath33 , whose connectivity is @xmath1 , is infected , being the latter obtained from mc simulations . besides , the average over all the @xmath95 s for nodes of the same degree has also been represented . as can be seen ,",
    "all individual probabilities are distributed around the mean value , which in turns is close to the values coming out from the nphmf formulation .",
    "these results further illustrate that the behavior is not the same along all the connectivity classes : for large prevalence densities ( or probability of being infected ) , the dispersion around the mean values shrinks .",
    "in other words , the degree of accuracy in the prediction of the state of a given node @xmath33 with respect to whether it is infected or not depends on @xmath57 : for large values of this density , one can predict with high accuracy the individual probabilities @xmath95 for nodes of degree @xmath1 , while if @xmath57 is relatively small , the prediction error is larger due to the more pronounced deviations from the average value .    finally , we have also tested the new formulation against variation of the recovery rate .",
    "the results obtained for different values of @xmath25 using the mmca and the nphmf approaches are compared with mc simulations in fig .",
    "[ fig3 ] . as in fig .",
    "[ fig1 ] , we have prescribed a fully reactive process on top of an undirected and unweighted scale - free network . moreover ,",
    "the results shown correspond to the case in which reinfections are possible ( similar results are found for the case without reinfections ) .",
    "the different curves show that both formulations perform quite well , being however the mmca slightly better that the nphmf case .",
    "in summary , in this paper we have proposed a new kind of heterogeneous mean field approach to describe the spreading of diseases in complex networks . capitalizing on a previous formulation aimed at computing the individual probabilities for nodes to be infected ,",
    "we have coarse grained the dynamical equations by degree classes . in doing so , we have been able to keep higher order terms , which ultimately allow us to use the resulting fixed point equation to obtain numerical solutions that are in good agreement with mc simulations .",
    "however , although the results outperform those obtained through the standard mean - field approach , the new formulation is still limited with respect to individual - based approaches ( such as the mmca ) .",
    "the reason is that , when coarse - graining the dynamics , some information of the original network is lost and exact quantities are replaced by expected values .",
    "the ultimate consequence is that , although one can accurately reproduce the behavior of global dynamical descriptors like the epidemic prevalence , at the individual level the probabilities of infection are more error - prone .",
    "having said that , we however think that the approach proposed here represents a significant improvement on the standard hmf framework in several aspects .",
    "first , it is more accurate .",
    "secondly , it allows to solve the whole phase diagram , which opens up the possibility of getting fast numerical solutions given a network topology without resorting to mc simulations .",
    "we acknowledge prof .",
    "mason a. porter for the critical reading of our manuscript .",
    "partial support came from the spanish micinn projects fis2009 - 13730-c02 - 02 ( s.g . and a.a . ) , fis2008 - 01240 ( j.g.g . and y.m . ) , mtm2009 - 13848 ( j.g.g . ) and fis2009 - 13364-c02 - 01 ( y.m . ) .",
    "s. g. and a. a. were partially supported by the generalitat de catalunya 2009-sgr-838 .",
    "y. m. was partially supported by the fet - open project dynanets ( grant no .",
    "233847 ) funded by the european commission and by comunidad de aragn ( spain ) through the project fmi22/10 .",
    ".  acknowledges support from the micinn ( spain ) through the ramn y cajal program ."
  ],
  "abstract_text": [
    "<S> since roughly a decade ago , network science has focussed among others on the problem of how the spreading of diseases depends on structural patterns . here , we contribute to further advance our understanding of epidemic spreading processes by proposing a non - perturbative formulation of the heterogeneous mean field approach that has been commonly used in the physics literature to deal with this kind of spreading phenomena . </S>",
    "<S> the non - perturbative equations we propose have no assumption about the proximity of the system to the epidemic threshold , nor any linear approximation of the dynamics . </S>",
    "<S> in particular , we first develop a probabilistic description at the node level of the epidemic propagation for the so - called susceptible - infected - susceptible family of models , and after we derive the corresponding heterogeneous mean - field approach . </S>",
    "<S> we propose to use the full extension of the approach instead of pruning the expansion to first order , which leads to a non - perturbative formulation that can be solved by fixed point iteration , and used with reliability far away from the epidemic threshold to assess the prevalence of the epidemics . </S>",
    "<S> our results are in close agreement with monte carlo simulations thus enhancing the predictive power of the classical heterogeneous mean field approach , while providing a more effective framework in terms of computational time . </S>"
  ]
}