{
  "article_text": [
    "networks have been widely used to describe systems in a multitude of disciplines , such as genetic networks , protein networks or the internet . in ecology ,",
    "networks are mainly used to visualize and describe food webs .",
    "but not only trophic interactions are the focus of attention . in the last years",
    "researchers show a growing interest in the study of other species interactions such as parasitism ( vzquez et al . , 2005 ) , scavenger species ( selva and fortuna , 2007 ) and mostly mutualism ( bascompte and jordano , 2007 and references therein ) . studies on mutualistic food webs focus on specific pairwise interactions between a plant and an animal and how they are shaped by a community context , either in a single locality , or geographically ( bascompte and jordano , 2007 ) .",
    "pairwise interactions can be described in the form of a bipartite graph or an interaction matrix .",
    "these webs are characterized by nodes that represent species or species groups and observed interactions are drawn as links that , when not binary , can render their intensity or frequency in graded thicknesses . in the interaction matrix , links are represented as nonzero cells on the intersection of a row and column . according to almeida - neto et al.,2007 , bipartite webs do in fact offer several advantages of their own : first , they are often fully resolved , without the problems of uneven resolution which haunt the analysis of complete webs .",
    "second , all links are of a single kind of ecological interaction ( e.g. mutualism ) , which ensures structural integrity as well as similar ecological and evolutionary processes throughout the entire assemblage .    the most studied structure within a bipartite graph is the nested pattern of species interactions , although other structures are also possible ( prado et al .",
    "2006 ; almeida - neto et al . , 2007 ) .",
    "in nested assemblages , plants with few interactions are related only with generalist animals ; conversely , specialized animals are found related to plants with many links , that is , with large associated faunas .",
    "moreover , generalists in one species set tend to interact with generalists in the other , forming a dense core of interactions ( prado et al . , 2006 ; bascompte and jordano , 2007 ) .",
    "a nested structure is very cohesive and stable .",
    "the fact that few species are involved in many interactions ( functional redundancy ) , poses the community with the possibility for alternative routes if some interactions disappear ( bascompte and jordano , 2007 ) .",
    "a nested structure is also quite robust : it is less prone to sampling bias than number of species and links ( nielsen and bascompte , 2007 ) and not generated by the random combination of sets of plants and animals solely in proportion to their different abundances as previously thought ( prado et al . , 2006 ) .",
    "recently , a large series of mutualistic interaction assemblages have shown a significantly nested structure ( bascompte et al .",
    "substantial effort has been done in developing various measures and forms of calculating nestedness ( atmar and patterson , 1993 ; guimaraes and guimaraes , 2006 ; rodrguez - girons and santamara , 2006 ; almeida - neto et al .",
    ", submitted ) .",
    "the most commonly used nestedness metric is the `` nestedness temperature calculator '' , or `` nestcalc '' , used to calculate nestedness in binary matrices ( atmar and patterson , 1993 ) .",
    "the nestedness from this algorithm has a problem , though : the absolute value of the nestedness temperature is dependent on matrix size and fill .",
    "some studies show that the nestedness temperature of randomly assembled matrices increases with network size and attains its maximum value for intermediate fills ( rodrguez - girons and santamara , 2006 ; almeida - neto et al . , submitted ) .",
    "so , smaller networks need lower temperature than larger ones do to be significantly nested ( nielsen and bascompte , 2007 ) .    from a mathematical point of view , the central object in the discussion about nestedness is a matrix of zeros and ones .",
    "the ecologist in the field interpret this matrix as a table where she ( he ) marks a cross at the @xmath1 column and @xmath2 row each time a species of group one @xmath1 ( e.g. plant ) is related to group two @xmath2(e.g .",
    "insect ) . in order to visualize nestedness in the studied ecological community",
    "the ecologist has to rank rows and columns of the table .",
    "in fact , each time one row ( or column ) is permuted to another row ( or to column ) , the interactions among species of groups one and two do not change . for a matrix of @xmath3 species in group one and @xmath4 species in group 2 , there are @xmath5 possibilities to represent the matrix following different permutations of rows and columns .",
    "each one of these possibilities is just a different visualization of the same network structure .",
    "ranking rows and columns is a very practical option to visualize nestedness in a interaction matrix .",
    "when we rank the elements of a matrix we choose one of the @xmath5 possibilites , that one where the elements of the matrix are the most packed .",
    "in other words , we choose the representations where the elements of the matrix are as closest as possible from the @xmath6 , @xmath7 corner . in the literature .",
    "packing procedure is a previous step before the evaluation of a nestedness index ( atmar and patterson , 1993 ) . in this article",
    "we also pack the matrix before the evaluation of our nestedness index .",
    "we introduce here a new nestedness measure applied to digraphs originated from ecological data .",
    "however , the method is more general than its predecessor and can be naturally applied to graphs ( networks ) other than digraphs . in section",
    "@xmath8 we describe the formal objects used in this article : adjacency matrix , manhattan distance in a matrix , projection of a generic matrix into the unit square lattice , packing process , random matrix , maximum nested matrix and nestedness estimator . in section @xmath9 we apply the nestedness estimator to a set of insect - plant herbivory networks extracted from the community ecology literature . in section @xmath10 we summarize the article , point out potential applications of the method and give the final words .",
    "in this section we introduce the concept of distance in a matrix to characterize the nestedness of digraphs . in order to fix the notation we call digraph an object @xmath11 formed by two sets of vertices @xmath12 and @xmath13 and a set of links between these two sets . the digraph is completely described by the adjacency matrix , @xmath14 , of size @xmath15 , where @xmath3 and @xmath4 are the number of elements of @xmath12 and @xmath13 , respectively . by definition @xmath16 if there is a link between vertices @xmath1 of @xmath12 and @xmath2 of @xmath13 and @xmath17 if @xmath1 and @xmath2 are not linked .",
    "it is useful to visualize @xmath14 as a @xmath3 versus @xmath4 lattice with empty ( zero ) or full ( one ) sites .",
    "moreover , the number of links of a vertex @xmath18 is @xmath19 and the distribution of links of @xmath12 and @xmath13 is @xmath20 and @xmath21 respectively .    in ecology ,",
    "the field data corresponding to the digraph is composed by two sets of species and the corresponding links ( interactions ) between them . as we pointed out in the introduction , the standard procedure in this area consists in packing the adjacency matrix of the data .",
    "the packing is performed in the following way : the link distributions @xmath20 and @xmath21 are ordered such that the most connected species go to the first position of the matrix . in this way the matrix @xmath14 shows more ones close to @xmath6 and @xmath7 corner and zeros at the opposite corner , @xmath22 and @xmath23 . from the matrix point of view , the packing process consists in replacing lines and columns until @xmath20 and @xmath21 are ordered .",
    "we emphasize that since the packing process do not change the links between species it does not alter the phenomenology underlying the network .",
    "the idea behind packing the matrix @xmath14 is to better visualize network nestedness .",
    "in addition , nestedness is related with the dispersion of ones and zeros after the packing process .",
    "a very nested matrix is one that , after packing , has a minimal mixing of ones and zeros . using a lattice analogy",
    ", a very nested lattice shows a minimum of holes .    to introduce distance properties in the original matrix",
    "@xmath14 we map it into a cartesian space . in order to avoid distortions",
    "we map the @xmath15 matrix to the unit square .",
    "to perform this task the cell elements @xmath24 assume the positions @xmath25 and @xmath26 that are done by : @xmath27 @xmath28    in this article we use the manhattan distance because it is broadly employed to measure matrix distances .",
    "euclidean distance is used for estimating distance between elements apart in continuum space , which is not the case here .",
    "in fact , in the context of abstract metric spaces ( courant , r. and hilbert , d. , 1937 ) set of distances @xmath29 that depends on the parameter @xmath30 , the case @xmath31 corresponds to the manhattan distance and the case @xmath32 to the euclidean distance .",
    "we define the occupancy number @xmath33 as the fraction of occupied sites in the adjacency matrix . for @xmath34",
    "the total number of ones in @xmath14 we have @xmath35 .",
    "to quantify nestedness of a given matrix @xmath14 we use two matrix benchmarks with the same @xmath3 , @xmath4 and @xmath33 : the maximal nested matrix @xmath36 and the random matrix @xmath37 .",
    "the maximal nested matrix is constructed in such a way that it has no holes and its elements are as close as possible to the @xmath38 corner .",
    "we construct @xmath36 filling the elements along equidistant diagonals to @xmath38 .",
    "in fact all elements along the same diagonal have the same distance to the @xmath38 corner .",
    "the construction of @xmath36 is the following : the first element occupied is @xmath38 , after that it comes @xmath39 and @xmath40 , followed by @xmath41 , @xmath42 and @xmath43 , etc .",
    "figure [ fig1 ] illustrates the optimal filling strategy to build @xmath36 .",
    "in contrast , the random matrix is constructed in such a way that all its elements are uniformly occupied with the same probability @xmath44 .",
    "the maximum packed matrix of the species interaction will be in - between these two .",
    "we use the manhattan distance to evaluate the distances of the filled elements @xmath45 ( the distances are defined for the matrix elements projected into the unit square in the cartesian plane ) .",
    "we call @xmath46 the sum over the distances of all the elements of the matrix projected into the unit square , that means , @xmath47 for @xmath48 . in order to define the nestedness estimator we introduce two additional distances : the total distance of the artificial matrices @xmath36 and @xmath37 .",
    "we note that @xmath36 has the smallest total distance among all the lattices with the same @xmath33 and we call @xmath49 its total distance , while the total distance of @xmath37 is @xmath50 .",
    "consider a sample of @xmath34 points ramdomly distributed along the unit square , the expected value of the distance to the origin , @xmath51 , is the manhatann distance from the origin to the center of the square of size @xmath52 , that means , @xmath53 .",
    "therefore : @xmath54    to get an insight about distances in @xmath14 we start exploring the behavior of @xmath49 and @xmath50 against occupancy @xmath33 in figure [ fig2 ] .",
    "we use in this picture @xmath55 .",
    "as expected , the distances follow the relation @xmath56 .",
    "the total distance @xmath46 for any matrix , after the packing process , shows the property : @xmath57 in fact , @xmath58 since @xmath49 is derived from an artificial matrix whose components , by construction , have the minimal distance to the origin .",
    "otherwise , @xmath59 because @xmath46 is derived from a packed matrix , and in the packing process the matrix reduces the distances of their elements when compared with a similar random matrix .",
    "the distance as defined above depends on the matrix size and the occupation .",
    "in fact , the total distance observes the relation @xmath60 for a given @xmath33 and the relation @xmath61 for a constant @xmath62 .",
    "this behavior can be visualized in figures [ fig2 ] and [ fig3 ] . in order to have a @xmath34 free nestedness index of the system we define the nestedness index @xmath63 as follows : @xmath64 we emphasize that @xmath49 and @xmath50 are computed over a artificial matrix with the same @xmath3 , @xmath4 and @xmath33 of the original system . in the next section",
    "we test @xmath63 over a set of digraphs from the context of community ecology and discuss the results .",
    "in this chapter we select a set of @xmath0 insect - plant herbivory networks in the literature and apply the nestedness index we develop in this article . in table",
    "[ tab1 ] we enumerate the set of networks with its main properties : the occupancy @xmath33 , size @xmath3 and @xmath4 , the nestedness estimator @xmath63 , the temperature @xmath65",
    "( according to atmar and patterson , 1993 ) and the reference of the network . a visual inspection of the table does not reveal correlation between @xmath63 and @xmath65 .",
    "in fact , a linear correlation analysis between the two variables revels no significant correlation ( @xmath66 and @xmath67 ) .    the range of values of our estimator is @xmath68 and the average value is @xmath69 . in contrast , the usual temperature estimator have the range @xmath70 and average value @xmath71 . in order to improve the visual intuition about the problem we plot in figure @xmath10 four lattices of insect - plant networks .",
    "it is clear in the figure that ( a ) and ( b ) are highly nested , and that on the contrary , ( c ) and ( d ) are not nested at all .",
    "this intuitive idea is corroborated by the @xmath63 estimator , but not by the temperature , the estimator of the two initial matrices are 0.18 and 0.23 ( low values ) , and of the last two 0.79 and 0.76 ( high values ) .",
    "the temperature estimator , on the other hand , shows an intermediary value in case ( a ) , where our estimator shows a low value and a very high temperature in ( c ) where our estimator points for a very large value .",
    "in fact , figures ( c ) and ( d ) have a large number of specialists , and in consequence the matrix can not be well nested .",
    "our estimator corroborates this observation . as a final remark concerning this set of figures",
    ", we point that all the matrices in this figure are well packed , that means , the number of elements of lines and columns are ordered . on the other hand ,",
    "the nestedness calculator from atmar and patterson , 1993 , usually fails in packing well the matrices .    from the observation of figure [ fig5 ]",
    "we see that the variables are correlated , in fact , a linear correlation analysis reveals @xmath72 , @xmath73 and @xmath74 .",
    "an exponential correlation regression results @xmath75 , @xmath76 and @xmath77 .",
    "therefore the adjust of the data to the exponential curve is slightly better than the linear one .",
    "the dependence of a nestedness index to occupancy was already pointed in the literature ( girons and santamara , 2006 ) . at first",
    ", a relation between @xmath33 and @xmath63 seems intuitive : once the number of sites increase , in the average , they will be more nested after the packing process .",
    "we let for a future work a more carefull analysis of this point .",
    "in this work we develop a new nestedness estimator @xmath63 based on distances over the adjacency matrix of the network .",
    "we think that this estimator will be useful in the methodological discussion involving nestedness in community ecology . to make the method clearer to the reader we summarize the algorithm to find @xmath63 in the following sequence of steps :    1 .",
    "evaluate the link distributions @xmath78 and @xmath79 of the adjascency matrix of the network .",
    "2 .   pack the matrix , that means , permute lines and columns of the matrix in order that @xmath78 and @xmath79 are ranked .",
    "this step defines a corner of nestedness .",
    "3 .   project the matrix into the unit square in order to avoid distortion due to the diferences between the sizes @xmath3 and @xmath4 of the matrix .",
    "4 .   find the manhatann distance @xmath80 of all elements @xmath25 @xmath26 of the matrix and sum to find the total distance of the elements of the matrix @xmath46 .",
    "5 .   determine analitically the distance of the associated random matrix with the same occupancy @xmath33 : @xmath81 , for @xmath34 the total number of occupied elements of the matrix .",
    "determine computationally the distance of the asociated maximally nested matrix with the same @xmath33 : @xmath49 .",
    "finally , calcule the estimator @xmath82 .    as estimated above ,",
    "@xmath83 . in the limit @xmath84 the network is completely nested and @xmath84 corresponds to the random limit .",
    "we tested our estimator for a set of @xmath0 insect - plant networks and the data is summarized in table [ tab1 ] .",
    "an interesting result of our estimator is that it depends on the occupancy number .",
    "this result is in agreement with the intuitive idea that the matrix nestedness increases with its occupancy density .",
    "the parameter @xmath65 is a very used nestedness estimator in community ecology .",
    "this parameter , despite of its popularity , is not well defined and present several problems ( fischer and lindenmayer , 2002 ; rodrguez - girons and santamara , 2006 ; almeida - neto et al . ,",
    "submitted ) .",
    "we are perfectly aware that our estimator will be compared with the usual temperature estimator developed by atmar and patterson ( 1993 ) .",
    "what we should do is to show the good points of our method and let the methodological discussion to the scientific community . in this way we stress the strong points of our method in the following :    1 .",
    "our algorithm is based on plain geometry and metric statements . in this way",
    "it is simple and can be calculated with help of a easy computer program .",
    "we have two benchmarks clearly defined : the total distance of the random matrix and of the completely nested one .",
    "3 .   we do not use any ad hoc parameter in the equation that defines the nestedness estimator .",
    "4 .   our estimator gives a number between zero and one .",
    "5 .   the visual inspection criterion of nestedness of empirical matrices agrees with our estimator .",
    "this paper opens a new perspective in the study of nestedness .",
    "we develop an original index to measure nestedness that is based on direct metric analysis of the matrix . instead of considering the dispersion of elements around an artificial isocline",
    ", we estimate directly the distances of all the matrix elements from the packing corner .",
    "the nestedness of a matrix is a measure of how much the elements of the matrix are close to the corner where the matrix is packed .",
    "we hope this paper to be usefull to improve the understanding of nestedness in the community ecology context .",
    "the authors thank m. almeida - neto for helpful comments on the manuscript .",
    "umberto kubota , graciela valadares and thomas lewinsohn , who made unpublished data available .",
    "the authors gratefully acknowledge the financial support of fapesp and cnpq , brazil .",
    "prado , p. i. and lewinsohn , t. m. 1994 .",
    "genus tomoplagia ( diptera , tephritidae ) in the serra do cip , mg , brazil : host records and notes of taxonomic interest .",
    "revista brasileira de entomologia 38 : 3 - 4 ."
  ],
  "abstract_text": [
    "<S> a recent problem in community ecology lies in defining structures behind matrices of species interactions . </S>",
    "<S> the interest in this area is to quantify the nestedness degree of the matrix after its maximal packing . in this work </S>",
    "<S> we evaluate nestedness using the sum of all distances of the occupied sites to the vertex of the matrix . </S>",
    "<S> we calculate the distance for two artificial matrices with the same size and occupancy : a random matrix and a perfect nested one . using these two benchmarks </S>",
    "<S> we develop a nestedness estimator . </S>",
    "<S> the estimator is applied to a set of @xmath0 real networks of insect - plant interactions .    </S>",
    "<S> nestedness , networks , insect - plant interactions </S>"
  ]
}