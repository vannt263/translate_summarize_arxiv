{
  "article_text": [
    "understanding dust dynamics in protoplanetary disks is an important topic in the study of planet formation , both theoretically and observationally . on one hand ,",
    "planetary cores must be built up from micron - sized interstellar dust grains , which need to gradually grow in size within a gaseous environment @xcite .",
    "especially challenging is how mm / cm - sized particles can effectively sediment towards the mid - plane of a protoplanetary disk and coalesce to form km - sized planetesimals ( * ? ? ?",
    "* and references therein ) .",
    "thanks to the advance in telescopes , on the other hand , it has become possible for observations to resolve the distribution of mm / cm - sized particles in nearby protoplanetary disks , from their thermal emission in sub - millimeter and radio wavelengths or polarized scattered light in the near infrared .",
    "for instance , @xcite used the atacama large millimeter / centimeter array ( alma ) to locate large - scale , lopsided concentration of mm - sized pebbles in the transition disk around oph irs  48 .",
    "@xcite found almost perfectly axisymmetric , ring - like distribution of pebbles around hl  tau .",
    "the strategic explorations of exoplanets and disks with subaru ( seeds ) project @xcite found a wealth of morphologically diverse structures like spiral arms and rings in an array of protoplanetary disks .",
    "these structures have also been detected with the very large telescope ( vlt ; see , e.g. , @xcite ) .",
    "to gain more insight into the physical processes at work in these protoplanetary disks , numerical simulations modeling both gas and solid particles are often enlisted given the complexity of such a system .",
    "for example , numerical simulations were used to demonstrate how pebbles / boulders could spontaneously concentrate themselves in a gaseous disk via the streaming instability @xcite , to the extent that planetesimal formation is triggered ( @xcite ; @xcite ; schfer , yang , & johansen , in preparation ) .",
    "simulations have also been used to study how dust is trapped within vortices , which could explain the observed lopsided dust concentration in some transition disks @xcite . using simulations of a protoplanetary disk with planet - induced gaps ,",
    "the axisymmetric dust distribution observed in the hl tau disk can be reproduced @xcite . by matching simulation models with the spiral structures in an observed protoplanetary disk , the mass and orbit of any potentially unseen planet",
    "can also be inferred @xcite .    for a solid particle of size",
    "less than @xmath0100 m in a protoplanetary disk , the dominant interaction between the particle and its surrounding gas is via their mutual drag force instead of their mutual gravity ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "the main tendency of the drag force is to reduce the relative velocity between the gas and the particle exponentially with time , the strength of which can be characterized by the stopping time @xmath1 @xcite . when the collective motion of a swarm of identical solid particles is considered , the time constant of the exponential decay due to this mutual drag force is given by @xmath2 , where @xmath3 is the local solid - to - gas density ratio ( see sections  [ ss : asol ] and  [ ss : unistr ] ) .",
    "therefore , for any numerical method explicitly integrating a particle - gas system with mutual drag interaction , stability criterion requires that the time step must be less than this time constant at all time .    depending on the value of this time constant , @xmath2 ,",
    "the mutual drag force can become extremely stiff in particular regimes .",
    "firstly , for particles of sizes less than about the mean free path of the surrounding gas , the stopping time @xmath1 is linearly proportional to the size of the particles @xcite .",
    "hence the smaller the particles , the stiffer the mutual drag force becomes . as a reference point",
    ", @xmath1 is on the order of @xmath4 local keplerian orbital period for mm - sized particles embedded at 1au in the mid - plane of a minimum mass solar nebula model ( e.g. , * ? ? ?",
    "secondly , the stronger the local concentration of solid particles , the higher the maximum solid - to - gas density ratio @xmath3 and yet again the stiffer the mutual drag force is .",
    "it has been suggested that the mm - sized chondrules ubiquitous in the solar system were formed in a solid - rich environment , with a density of solids roughly 100 times the background gas density or more @xcite . moreover , for sedimented layer of particles marginally coupled to the surrounding gas , the maximum local solid - to - gas density ratio in the saturated state of the streaming turbulence can be as high as @xmath5@xmath6 @xcite . therefore ,",
    "either effect or a combination of both can render the time step so short that the computational cost of the simulation model becomes intractable .",
    "a classic approach to treat stiff source terms is to operator split these terms out and use a dedicated method to integrate them with reasonable accuracy and efficiency ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "when considering two - fluid approximation for a particle - gas system with mutual drag interaction , this leads to a system of ordinary differential equations for the drag force without any spatial coupling .",
    "it is then relatively straightforward to integrate this system strictly locally , either with analytical formulas or with numerical methods .",
    "this approach and similar ones have been implemented in eulerian grid - based schemes @xcite and in smoothed particle hydrodynamics @xcite .    instead of the two - fluid approximation ,",
    "however , it is typically preferable to use lagrangian solid particles to model a particle - gas system @xcite .",
    "the exact information of position and velocity carried by each particle better samples the distribution of particles in phase space .",
    "the ability of sampling the velocity distribution of particles is especially important in the study of collisional evolution of solids , both large ( e.g. , * ? ? ?",
    "* ) and small ( e.g. , * ? ? ?",
    "lagrangian particles not only help measure their velocity dispersion , but also can directly be used to predict the collision parameters , neither of which is readily available in the fluid approximation . moreover , in the drag - dominated regime , particles do not dynamically equilibrate among themselves due to lack of direct interaction , and thus the effective pressure of particles is virtually zero .",
    "this implies that any spatial variation in the fluid description of particles is connected by a contact discontinuity , which is not trivial to be traced numerically accurately , especially when the contrast is significant .",
    "this issue is absent when using lagrangian particles .",
    "despite these advantages of employing lagrangian solid particles along with eulerian gas , major difficulties arise for the direct integration of the mutual drag force between gas and particles ( see section  [ s : algm ] ) .",
    "the most difficult of these is that the presence of the particles can make the system of equations globally coupled , much like a diffusion equation , with which the temporal solution for any cell depends on the initial conditions for all other cells . with the diffusion equation , an initial delta function",
    "is immediately broadened in time and becomes a gaussian distribution which is nonzero for the whole domain .",
    "surprisingly , using the standard particle - mesh approach to compute the mutual drag force in a particle - gas system also induces this property for the connected domain covered by the particles , as we show in appendix  [ s : ns ] .",
    "consider , for example , a one - dimensional grid of gas with uniformly distributed particles . suddenly pushing one particle on one side of the domain",
    "would drag not only its surrounding gas , but also all of the particles via their intermediate gas cells , up to the particles on the other side of the domain .",
    "though this effect of global propagation of information diminishes exponentially with distance , it indicates that using the particle - mesh method , the coupling between the gas and the particles is more complex than simple local particle - gas pairs .",
    "while there exist standard numerical techniques to treat a diffusion equation efficiently , e.g. , the crank  nicolson method and the spectral method , the incongruence between the lagrangian and the eulerian descriptions makes these methods not applicable to the particle - gas systems with mutual drag force .",
    "therefore , the focus has been only on the direct integration of the drag force on the particles without operator splitting the drag force on the gas , as in @xcite , @xcite , and @xcite .",
    "this approach only relieves the time - step constraint due to small particles , while it remains problematic as strong solid concentration occurs .",
    "note also that in @xcite as well as in @xcite , an artificial increase of the stopping time @xmath1 is implemented for those cells with high local solid - to - gas density ratios in order to circumvent the time - step constraint , and the numerical accuracy of this approach has not been systematically demonstrated yet .    in this work ,",
    "we devise a numerical algorithm that effectively disentangles the system of equations for the mutual drag force and allows for its direct integration on a cell - by - cell basis .",
    "for each cell , then , we use an analytical solution to assist in predicting the velocities of the gas and the particles at the next time step , so that the time - step constraint posed by the mutual drag force is lifted .",
    "this algorithm is described in detail in section  [ s : algm ] . to validate our algorithm ,",
    "we use an extensive suite of benchmarks with known solutions in one , two , and three dimensions , presented in sections  [ s:1d][s:3d ] , respectively .",
    "finally , we discuss the generality and possible applications of our algorithm in section  [ s : conc ] .",
    "to begin with , we consider a system of eulerian gas and lagrangian solid particles moving in a differentially rotating disk in a rotating frame . in addition to the coriolis force , the centrifugal force , and the external axisymmetric gravitational potential , the gas and",
    "each of the particles interact with their mutual drag force .",
    "we further adopt the local - shearing - sheet approximation @xcite , in which the origin of the frame is located at an arbitrary distance @xmath7 away from the rotation axis with the @xmath8- , @xmath9- , and @xmath10-axes of the frame constantly in the radial , azimuthal , and vertical directions , respectively , and the frame co - rotates with the disk at the local angular frequency at its origin .",
    "we include also a constant @xmath8-acceleration @xmath11 to the gas from , e.g. , a background pressure gradient , and a vertically varying @xmath10-acceleration @xmath12 on both the gas and the particles due to , e.g. , the vertical component of the central gravity . without loss of generality ,",
    "we assume an isothermal equation of state for the gas with @xmath13 being the speed of sound . then the governing equations for the gas read @xmath14",
    "while the equations of motion for the particles read @xmath15 in the above equations , @xmath16 and @xmath17 are respectively the density and the velocity of the gas at grid point @xmath18 , and @xmath19 is the velocity of the @xmath20-th particle which is located at @xmath21 ; see figure  [ f : pm]a .",
    "the constant local angular velocity @xmath22 is parallel to the @xmath10-axis , and @xmath23 is the dimensionless shear parameter at radial distance @xmath7 from the rotation axis , which is @xmath24 for a keplerian potential .",
    "both @xmath17 and @xmath19 are measured relative to the background shear velocity @xmath25 at their respective locations .",
    "the parameter @xmath1 is the stopping time of the mutual drag force between the gas and each of the particles . for simplicity , and more importantly , for a clean demonstration of our algorithm , we assume @xmath1 is a constant in this work and discuss the possibility of its generalization in section  [ s : conc ] .",
    "the remaining variables are @xmath26 and @xmath27 : the former is some averaged particle - to - gas density ratio `` perceived '' by the gas in cell @xmath28 from the @xmath20-th particle , while the latter is some averaged velocity of the surrounding gas `` perceived '' by the @xmath20-th particle .",
    "we then operator split out the source terms for the mutual drag force , the rotation / shear , the external radial acceleration for the gas , and the external vertical acceleration for the particles from the full system of equations   ( see appendix  [ s : os ] ) . as a result , the two independent systems of equations now read    [ e : hypsys ] @xmath29    and    [ e : src ] @xmath30    the system of equations   consists of the usual euler equations for fluid dynamics and an ordinary differential equation for the positions of the particles , both of which can be integrated with any standard technique .",
    "our task is therefore to devise a numerical algorithm to solve the system of equations   without any time - step constraint due to the mutual drag force between the gas and the particles .    even after the operator splitting",
    ", the system of equations   still presents several major difficulties , as mentioned in section  [ s : intro ] .",
    "firstly , the rather loose definitions of @xmath31 and @xmath27 are a manifestation of the distinctly different formalisms of the gas and the solid particles , i.e. , eulerian vs.  lagrangian .",
    "their design is therefore one of the central factors that determine the accuracy as well as the efficiency of the algorithm concerning the mutual drag force . secondly , to relieve the time - step constraint posed by both small stopping time @xmath1 and large solid - to - gas density ratio @xmath3",
    ", the characteristic velocity curves followed by each cell of gas and each particle need to be accurately captured by the numerical method .",
    "this is best achieved by solving the system of equations   simultaneously in the same integrator , given the particle - gas coupling via the mutual drag force .",
    "worst of all , the density ratio @xmath31 usually includes all particles within a definite distance to cell @xmath28 , while the velocity @xmath27 is usually a weighted average from the surrounding cells around the @xmath20-th particle .",
    "this implies that all cells by equation   and all particles by equation   are more than likely to be completely coupled via @xmath31 and @xmath27 , particularly when the particles are roughly uniformly distributed throughout the computational domain .",
    "these couplings make the solutions for the whole velocity field of the gas and all the particle velocities as a function of time dependent on each other ( see also appendix  [ s : ns ] ) . in order to solve this system efficiently ,",
    "an implicit numerical method is usually employed , since the method is unconditionally stable against time step . however , even with an implicit method , the matrix representing the system of equations   is huge , with the total number of cells plus particles on each side , and the inversion of this matrix can be a prohibitive computational task , since it can not be organized in simple band diagonal form .",
    ", this approach does not relieve the time - step constraint due to high local solid - to - gas density ratios .",
    "] in the following subsections , we construct our numerical algorithm with these difficulties in mind .      in order to proceed , we first conceive the simplest possible scenario to solve the system of equations  , which leads to the nearest - grid - point ( ngp ) scheme of the particle - mesh method . in this scheme , each individual cell containing some number of particles is considered independently ; the gas in one cell interacts only with the particles inside and vice versa . as a result ,",
    "the gas and the particles in a cell do not couple with those in any of the neighboring cells .",
    "this implies that @xmath32 and @xmath33 , where @xmath34 is the mass of the @xmath20-th particle and @xmath35 is the volume of the cell . with these simplifications ,",
    "the system of equations   can be solved analytically .",
    "the vertical direction is independent of the other directions , and the solutions for it read @xmath36,\\label{e : uzt}\\\\ v_{j , z}(t ) & =      \\left[v_{j , z}(0 ) +             u_z(0)\\left(\\frac{1 - e^{-{\\epsilon_{tot}}\\tau}}{{\\epsilon_{tot}}}\\right)\\right]e^{-\\tau } +      \\alpha t + \\nonumber\\\\&\\quad      \\left(u_z - \\frac{\\alpha t_s}{{1 + { \\epsilon_{tot}}}}\\right )          \\left[1 - e^{-\\tau}\\left(1 - \\frac{1 - e^{-{\\epsilon_{tot}}\\tau } }                                            { { \\epsilon_{tot}}}\\right)\\right]\\nonumber\\\\&\\quad +      \\left[g_z(z_{p , j } ) - \\alpha\\right]t_s\\left(1 - e^{-\\tau}\\right )      \\label{e : vzt},\\end{aligned}\\ ] ] where @xmath37 is the total solid - to - gas density ratio in the cell , @xmath38 is the number of @xmath39-folding times for the drag force at @xmath40 , @xmath41 is the vertical center - of - mass acceleration , and @xmath42 is the vertical component of the initial center - of - mass velocity of the particle - gas system .",
    "the first term in equations   and   is the decaying mode from the initial velocities of the gas and the particles .",
    "the second term represents the center - of - mass motion of the system .",
    "the remaining terms stem from the coupling between the gas and the particles due to the mutual drag force and determine the terminal velocities relative to the center - of - mass motion .",
    "solving the system of equations   for the horizontal directions is more involved because the coriolis force and the shear couple the @xmath8- and @xmath9-components of the velocities .",
    "nevertheless , the analytical solutions can still be found and are @xmath43 the first term in the above equations denotes the equilibrium velocities , which are calculated by @xmath44 where @xmath45 is the dimensionless stopping time , or the stokes number in the context of a rotating disk . when the shear parameter @xmath46 and @xmath47 , the keplerian frequency , these are simply the nakagawa  sekiya  hayashi ( nsh ) equilibrium solutions @xcite .",
    "the vectors @xmath48 and @xmath49 are defined by",
    "@xmath50 +             \\sum_j{\\tilde{\\epsilon}_{kj}}\\left[{\\boldsymbol{v}}_j(0 ) - \\tilde{{\\boldsymbol{v}}}\\right]}{{1 + { \\epsilon_{tot}}}},\\\\ { \\boldsymbol{v } } & \\equiv      \\frac{\\left[{\\boldsymbol{u}}(0 ) - \\tilde{{\\boldsymbol{u}}}\\right ] -            { \\epsilon_{tot}}^{-1}\\sum_j{\\tilde{\\epsilon}_{kj}}\\left[{\\boldsymbol{v}}_j(0 ) - \\tilde{{\\boldsymbol{v}}}\\right ] }           { { 1 + { \\epsilon_{tot}}}},\\end{aligned}\\ ] ] which are respectively the initial center - of - mass velocity of the system and the weighted velocity difference between the gas and the particles , measured with respect to the equilibrium state .",
    "the constant @xmath51 is defined by @xmath52 and @xmath53 is the epicycle frequency .",
    "hence the second term in equations   describes the constant , in - phase , epicycle motion of the bulk system , while the third term depicts the decaying , out - of - phase , epicyclic mode of the velocity difference between the gas and the particles .",
    "finally , the vectors @xmath54 are defined by @xmath55,\\ ] ] and thus the last term in equations   and   denotes the decaying , epicyclic mode of the velocity difference of each individual particle relative to the center - of - mass of the particle system .",
    "it should be clear now what the advantages of operator splitting not only the mutual drag force but also the other source terms , as in equations  , are .",
    "these source terms do not depend on any spatial derivative of the field variables or differences between particles , and an equilibrium state should be preserved numerically when they cooperate in balance .",
    "hence the equilibrium velocities @xmath56 and @xmath57 inherent in equations   are important in guaranteeing that the equilibrium state can be maintained down to the machine precision .- folding times is required for these seeds to grow to appreciable amplitude compared to the dynamical timescale of many models of interest , these errors do not pose a serious issue .",
    "] note that the hydrostatic equilibrium is on the contrary determined by the system of equations   , or the like , which should be independently maintained by the other integrator given the operator split . also with equations  ",
    ", all the epicyclic modes due to the coupling between the gas and the particles are accurately followed in time .",
    "most importantly , the velocity damping due to mutual drag force can be predicted with a time step of arbitrary size using the solutions , and thus the time - step constraint posed by the drag timescale in either direction can be relieved .",
    "even though the ngp scheme is simple and easy to implement , it is not suitable in many circumstances and a higher - order particle - mesh scheme is usually desirable . with the ngp scheme",
    ", each particle only interacts with the gas at the nearest grid point , so the particle behaves as if sitting at the grid point and the significance of its positional information within the cell is lost .",
    "moreover , the mass and the momentum density fields sampled via the particles are prone to be overwhelmed by the poisson noise . to have a 1% sensitivity , at least @xmath58 particles are required in each cell . on the other hand , any higher - order interpolation scheme that utilizes the positional information of the particles",
    "drastically overturns the situation ; as less as one particle per cell is sufficient to describe a signal of arbitrarily low amplitude @xcite .",
    "therefore , it is necessary to incorporate any particle - mesh scheme of choice into the solutions discussed in section  [ ss : asol ] .    to achieve this ,",
    "the solid - to - gas density ratio contributed by the @xmath20-th particle in the cell at @xmath59 should be generalized to @xmath60 where @xmath61 is the weight function of the particle - mesh scheme in question .",
    "more often than not , the weight function @xmath61 has a physical interpretation ( e.g. , * ? ? ?",
    "* ) ; see figure  [ f : pm]b .",
    "for example , in the cloud - in - cell ( cic ) scheme , the mass of each particle is distributed uniformly in a rectangular box of the cell size that is centered at the particle , i.e. , a uniform rectangular `` particle cloud '' . in the triangular - shaped - cloud ( tsc )",
    "scheme , each dimension of the particle cloud is doubled and the mass of the particle is distributed non - uniformly with a density peak at the cloud center and zero density at the cloud boundary . this scheme is so named since the density profile of the particle cloud resembles an isosceles triangle when viewed at the cloud center along any of the coordinate directions . the density function of the ngp scheme in this interpretation is simply a delta function .",
    "hence the term @xmath62 in equation   can be interpreted as the fraction of the mass of the @xmath20-th `` particle cloud '' that is enclosed by the cell at @xmath59 and is treated as part of the `` particle fluid '' in the cell .",
    "guided by this interpretation of equation  , we have the following proposition to update the velocities of the particles .    1 .",
    "split each particle cloud into multiple sub - clouds and distribute them into the surrounding cells according to equation  .",
    "each sub - cloud has the same initial velocity as their parent particle .",
    "we denote the velocity of the sub - cloud at cell @xmath28 as @xmath63 and thus @xmath64 for all @xmath28 .",
    "see figure  [ f : pm]b .",
    "2 .   for each cell @xmath28 ,",
    "treat the gas and all the sub - cloud inside as a multi - fluid system .",
    "hence identify @xmath19 as @xmath63 and @xmath27 as @xmath17 in equations  .",
    "3 .   find the velocity changes @xmath65 at time @xmath40 from the analytical solutions in equations  , , and  .",
    "see figures  [ f : pm]c and  d.[dvjk ] 4 .",
    "after all cells are integrated , collect the momentum changes of the sub - clouds back to the parent particles : @xmath66 5 .",
    "update the velocities of the particles by @xmath67 .",
    "see figure  [ f : pm]e .    essentially , this procedure decouples the coupled system of equations   and makes it possible to conduct the integrations on a cell - by - cell basis , and hence substantially reduces the amount of computational work required , as discussed in the introduction of this section .",
    "we note that the procedure outlined above is consistent with standard particle - mesh interpolation .",
    "since the momentum change of an individual particle is the sum of the momentum changes of its sub - clouds , @xmath68\\nonumber\\\\ & = g_z(z_{p , j}){\\hat{{\\boldsymbol{e}}}}_z -       2{\\boldsymbol{\\omega}}\\times{\\boldsymbol{v}}_j + q \\omega v_{j , x } { \\hat{{\\boldsymbol{e}}}}_y + \\nonumber\\\\&\\qquad      \\frac{\\sum_k w({\\boldsymbol{r}}_k - { \\boldsymbol{r}}_{p , j}){\\boldsymbol{u}}_k - { \\boldsymbol{v}}_j}{t_s } ,      \\label{e : pmgas}\\end{aligned}\\ ] ] where @xmath69 is the gas velocity at @xmath59 . by comparing this with equation  , it can be seen that @xmath70 , which proves that the gas velocity experienced by the particle is the standard particle - mesh interpolation from its surrounding cells .    in principle , the gas velocity in cell @xmath28 at time @xmath40 can be similarly obtained along with step  [ dvjk ] above via the analytical solutions in equations  , , and  , and thus can be updated directly . as will be shown in section  [ ss : lsi ]",
    ", the growth rate of a linear mode for the streaming instability indeed converges with resolution using this approach .",
    "however , the convergence rate is relatively poor compared with that using the explicit integration . in the next subsection , we devise further steps for the update of the gas velocity that significantly improve the benchmarks .",
    "the reason for the relatively poor performance of directly using the analytical solutions to update the gas velocity after the steps described in section  [ ss : uppar ] is that this approach remains local from the perspective of the gas .",
    "even though the gas in a cell receives sub - particle clouds from the surrounding cells , it does not interact with the neighboring gas .",
    "this can be seen in the system of equations   with the substitutions @xmath71 and @xmath72 , where the gas velocity @xmath17 in cell @xmath28 is the sole state variable for the gas and no coupling for gas velocities between different cells exists . in reality , however , the gas in neighboring cells should couple via the drag force with the interpenetrating particle clouds as interpreted in the particle - mesh method .",
    "this missing coupling can be remedied , as inspired by the algorithm suggested in @xcite for distributing the back reaction of the drag forces from particles to gas .",
    "we note that the velocity change of each particle @xmath73 acquired by the steps in section  [ ss : uppar ] contains all the information of the mutual drag force between the particle and the surrounding gas .",
    "that is , the particle has sampled the spatial variation in the velocity field of the gas to determine its own velocity change , as shown in equation  .",
    "this process can then be reversed since the mutual drag force forms an action - reaction pair .",
    "each particle can be considered now as a unified particle cloud undergoing a momentum change @xmath74 instead of a group of independent sub - clouds .",
    "this momentum change can then be redistributed onto the grid by standard particle - mesh assignment .",
    "see figure  [ f : pm]f .",
    "one more difficulty remains , though , since additional source terms are included in our system and thus the total momentum of the gas and particles in each cell is not conserved .",
    "this difficulty can be resolved with the center - of - mass frame approach , in which the mutual drag force cancels out . combining equations  , , and   gives @xmath75 where @xmath76 is the center - of - mass velocity .",
    "equation   can be analytically integrated and gives the change at time @xmath40 as @xmath77 with @xmath78 since @xmath73 are known , equation   can be rearranged to find the velocity change of the gas @xmath79 ( figure  [ f : pm]f ) .",
    "this completes our algorithm .      as a final note ,",
    "the sheared periodic boundary conditions for the local - shearing - sheet approximation @xcite require some attention in our algorithm . for the eulerian description , they state that @xmath80 , where @xmath81 is any of the dynamical fields , @xmath82 is the radial dimension of the computational domain , and @xmath40 is the time at the beginning of each time step instead of the size of a time step used liberally in the previous subsections .",
    "note , however , that our algorithm completely decouples the gas fields and no simultaneous information in any pair of adjacent cells is needed in any of our steps . on the other hand ,",
    "all of the coupling is achieved via the splitting of the particle `` clouds '' .",
    "the only place that the boundary conditions ( as well as domain decomposition in parallel computing ) are required , then , is in the particle - mesh weight function @xmath61 , specifically in equations  , , and  .",
    "therefore , the radial boundary conditions can simply be executed by shifting the positions of the particles near the radial boundaries by    [ e : parbc ] @xmath83    when these particles are cast into the other side of the boundary , in which the upper / lower sign is taken for the left / right boundary .- coordinate into the limits of the ghost cell a particle is sent to , by applying the azimuthal periodicity @xmath84 , where @xmath85 is the azimuthal size of the computational domain . ]",
    "the azimuthal and the vertical boundary conditions for our algorithm can be similarly implemented by revising equations  .",
    "all the other properties of the particles remain unchanged .",
    "we note that this approach also eliminates the need of interpolation as required in the implementation of @xcite , the latter of which introduces additional numerical errors near the radial boundaries in particle - mesh assignment .",
    "we have implemented our algorithm in the pencil code , a high - order finite - difference simulation code for astrophysical fluids and particles @xcite .",
    "the code employs sixth - order centered differences in space and third - order runge  kutta integration in time .",
    "the system of equations   is operator split out of the runge ",
    "kutta steps and thus separately integrated by the algorithm described in this section . throughout this work ,",
    "we restrict ourselves to the tsc weight function , with which the interpolation error is of second order in cell size @xcite . in the following ,",
    "we validate the algorithm as well as our implementation on several systems with known solutions .",
    "sedimentation of solid particles towards the mid - plane of a gas disk is one of the most important topics in the theory of planet formation .",
    "it is considered to be the first process in the core accretion scenario , creating a dense layer of solid materials that can later concentrate and become seeds of planetary cores @xcite .",
    "the degree of sedimentation intimately couples with the gas dynamics , especially in turbulent disks , and thus numerical simulations are often required @xcite .",
    "we hereby use a simple form of the sedimentation process as the first benchmark against our integrator .",
    "we consider a single particle moving vertically through a stationary gas .",
    "the particle undergoes a gravitational acceleration of the form @xmath86 , where @xmath87 is the vertical natural frequency , and the gas drag of stopping time @xmath1 .",
    "the equation of motion for the particle is then @xmath88 this system is the well - known damped harmonic oscillator , and its analytical solutions are readily available . using our algorithm , equation   is equivalently being operator split into two separate equations as @xmath89 the first of which is in the runge  kutta integrator and thus any integrator of order at least one renders this solution . ] while the second is in the split integrator of section  [ s : algm ] .",
    "note that in this case the mass of the particle @xmath90 is effectively zero so that the gas is unaffected and remains stationary .",
    "the particle is released at a height of @xmath91 at rest , i.e. , @xmath92 and @xmath93 .",
    "we integrate this system with both the godunov and the strang splitting methods , which are formally first- and second - order accurate , respectively ( see appendix  [ s : os ] ) .",
    "figure  [ f : oscex ] compares the numerical and the analytical solutions for the cases of a simple harmonic ( @xmath94 ) , underdamped ( @xmath95 ) , critically damped ( @xmath96 ) , and over - damped ( @xmath97 ) oscillator .",
    "we use a fixed and unusually large time step of @xmath98 to highlight the numerical errors in the comparison .",
    "even with such a large time step , the numerical solutions agree reasonably well with the analytical ones , especially for more highly damped systems .",
    "the strang splitting does perform better than the godunov splitting in particle position , but no appreciable difference appears in particle velocity between the two splitting methods . in any case , dispersive errors do exist in both position and velocity for the case of oscillatory systems .",
    "however , no diffusive errors exist in either variable , and having this property is important in accurately establishing the scale height of the particle layer , which is one of the critical factors in driving planet formation .",
    "finally , notice that although the time step is much larger than the stopping time @xmath1 in the over - damped system and thus the initial acceleration of the particle is not resolved , the numerical solution still accurately captures the terminal speed at the very first time step , and even more so at later times .",
    "figure  [ f : oscerr ] demonstrates the accuracy and convergence properties of our algorithm for two over - damped harmonic oscillators , one with @xmath99 and the other with @xmath100 .",
    "we cover a wide range of time step @xmath101 so that both @xmath102 and @xmath103 regimes are included . for the errors in position , the godunov splitting shows the expected first - order convergence .",
    "on the other hand , the strang splitting shows the expected second - order convergence only for small @xmath101 while first - order convergence for large @xmath101 , the latter of which might be due to the unresolved initial acceleration of the particle .",
    "the transition occurs at @xmath104 , and it seems that the error approaches the same asymptote towards small @xmath101 irrespective of the stopping time .",
    "nevertheless , the strang splitting is indeed more accurate in position than the godunov splitting , albeit only slightly at large time step . for the errors in velocity",
    ", there exists no difference between the godunov and the strang splittings , which is consistent with figure  [ f : oscex ] , and this property does not depend on the stopping time .",
    "similar to the convergence in position with the strang splitting , the convergence in velocity for both splittings shows first order for large @xmath101 and second order for small @xmath101 , and the transition occurs at @xmath104 . in any case , the smaller the stopping time , the more accurate the results are at any given time step .",
    "note that it is never stable to integrate this system explicitly with @xmath105 , which is the regime of interest in this work .",
    "furthermore , in a typical model , one usually operates on the range @xmath106 .",
    "hence we consider these results to be fairly accurate .",
    "we next consider the interpenetrating streaming motions between uniform gas and uniformly distributed particles .",
    "it is the same test performed by @xcite , in which it was called particle - gas deceleration test , and it is also the linear - drag case of the dustybox suite presented by @xcite . in this scenario ,",
    "the system of equations reads @xmath107 where @xmath108 and @xmath109 are the velocities of the gas and the particles , respectively , and @xmath3 is the constant solid - to - gas density ratio . with the initial conditions @xmath110 and @xmath111 , the solutions for the velocities are @xmath112,\\label{e : usu}\\\\ v(t ) & = v_0 e^{-(1+\\epsilon)t / t_s } +           u_0\\left[1 - e^{-(1+\\epsilon)t / t_s}\\right],\\label{e : usv}\\end{aligned}\\ ] ] where @xmath113 is the center - of - mass velocity .",
    "the displacement for each of the particles is given by @xmath114 + u_0 t.\\label{e : uss}\\end{aligned}\\ ] ] in the center - of - mass frame , @xmath115 .",
    "the only relevant scales of time and velocity in this system are the stopping time @xmath1 and the speed of sound @xmath13 , respectively . hence the time and all the velocities can be normalized by these two scales , and this in turn fixes the length scale at @xmath116 .    to test this system with our algorithm , we set up a one - dimensional , periodic grid of gas and uniformly distributed lagrangian particles .",
    "the computational domain has a length of @xmath117 so that a time step greater than the stopping time @xmath1 can be covered in the test .",
    "we allocate one particle at the center of each cell .",
    "the particles have an initial velocity of @xmath118 while the gas has a uniform initial velocity of @xmath119 , i.e. , the gas and the particles move in opposite directions .",
    "the errors are measured at a fixed final time of @xmath120 , and the cell size @xmath121 is varied to test the numerical convergence .",
    "we note that for @xmath122 , it takes exactly one time step to reach @xmath123 .",
    "finally , we experiment with a wide range of solid - to - gas density ratio @xmath3 , which is the only free parameter in the system .",
    "we find that the final velocities in all cases are accurate to the analytical solutions , equations   and  , close to the machine precision .",
    "although the velocities do not exactly remain uniform , the noise introduced is close to the machine - precision level .",
    "only slight increase in the noise level can be observed for high resolutions and thus small time steps , and this can be attributed to the round - off errors .",
    "the high degree of accuracy in velocities is hence not surprisingly due to our analytical integration of the velocities in section  [ ss : asol ] , assisted by the high degree of uniform motion .",
    "therefore , the only error remains to be considered is the displacement of the particles .",
    "similar to the velocities , the noise in the displacements of the particles is small and close to the machine - precision level , and thus the separation between adjacent particles remain highly constant . figure  [ f : userr ] shows the absolute error in the mean displacement of the particles as a function of cell size @xmath121 , and it can be seen that numerical convergence is achieved in a wide range of solid - to - gas density ratio @xmath3 with both the godunov and the strang splittings .",
    "a few features can be observed from figure  [ f : userr ] .",
    "firstly , the accuracy is relatively insensitive to the solid - to - gas density ratio @xmath3 for @xmath124 , while it improves appreciably for @xmath125 .",
    "secondly , the godunov splitting demonstrates the expected first - order convergence .",
    "the strang splitting , on the other hand , only achieves the second - order convergence when @xmath121 is sufficiently small such that the mutual drag timescale of @xmath2 is resolved .",
    "this behavior is similar to what is found in section  [ ss : osc ] .",
    "thirdly , the strang splitting renders more accurate displacements when @xmath124 .",
    "however , the difference between the strang and the godunov splittings significantly reduces when @xmath125 .",
    "finally , we note that in all cases , the errors are all below the cell size @xmath121 , and hence the algorithm gives more precise displacements of the particles than what the resolution can provide for .",
    "in the local - shearing - sheet approximation ( see , e.g. , equation   or  ) , the existence of the shear advection terms @xmath126 , where @xmath81 is any dynamical field variable , makes @xmath127}$ ] with a time - dependent @xmath8-wavenumber @xmath128 and a constant @xmath9-wavenumber @xmath129 a natural choice of the basis function .",
    "this basis depicts a two - dimensional wave , in which the power in the azimuthal direction feeds the power in the radial direction , winding up the structure into a tighter and tighter spiral wave towards trailing morphology . substituting this basis into the two - fluid description of the particle - gas system without background radial gas pressure gradient ( i.e. , @xmath130 in equation  ) , @xcite derived a set of ordinary differential equations for the ( complex ) amplitudes of the wave :    [ e : swav ] @xmath131,\\\\ { \\frac{\\mathrm{d}\\hat{u}_x}{\\mathrm{d}t } } & =      2\\omega\\hat{u}_y -      \\frac{\\epsilon_0}{t_s}\\left(\\hat{u}_x - \\hat{v}_x\\right ) -      \\frac{i k_x(t)c_s^2}{\\rho_{g,0}}\\hat{\\rho}_g,\\\\ { \\frac{\\mathrm{d}\\hat{u}_y}{\\mathrm{d}t } } & =      -(2 - q)\\omega\\hat{u}_x -      \\frac{\\epsilon_0}{t_s}\\left(\\hat{u}_y - \\hat{v}_y\\right ) -      \\frac{i k_y c_s^2}{\\rho_{g,0}}\\hat{\\rho}_g,\\\\ { \\frac{\\mathrm{d}\\hat{\\rho}_p}{\\mathrm{d}t } } & =      -\\rho_{p,0}\\left[i k_x(t)\\hat{v}_x + i k_y\\hat{v}_y\\right],\\\\ { \\frac{\\mathrm{d}\\hat{v}_x}{\\mathrm{d}t } } & =      2\\omega\\hat{v}_y -      \\frac{1}{t_s}\\left(\\hat{v}_x - \\hat{u}_x\\right),\\\\ { \\frac{\\mathrm{d}\\hat{v}_y}{\\mathrm{d}t } } & =      -(2 - q)\\omega\\hat{v}_x -      \\frac{1}{t_s}\\left(\\hat{v}_y - \\hat{u}_y\\right),\\end{aligned}\\ ] ]    where @xmath132 and @xmath133 are the background uniform densities of the gas and the particles , respectively , @xmath134 , and @xmath13 is the isothermal speed of sound .",
    "this system of equations can be readily integrated numerically , and its solution serves as a convenient analytical benchmark to validate our implementation of the sheared periodic boundary conditions as well as the mutual drag force .    applying our algorithm to this shear - wave test , we evolve the particle - gas system for a square domain @xmath135 in the @xmath136-plane with a single mode @xmath137 and @xmath138 . we use a 64@xmath13964 grid and a shear parameter of @xmath46 , and allocate one particle per cell .",
    "the initial conditions are such that @xmath140 while @xmath141 .",
    "note that in this case , it takes 22@xmath142 for the @xmath8-wavenumber to reach the nyquist frequency , when the numerical diffusion and/or aliasing becomes significant . in what follows , we vary the values of @xmath143 and @xmath144 to assess the performance of our algorithm , where @xmath45 .",
    "we only present the results with the godunov splitting method and note that the strang splitting only slightly improves the accuracy .",
    "first we consider the case of @xmath145 and @xmath146 , which makes the test exactly the same as was done in @xcite .",
    "figure  [ f : swav1 ] shows the comparison between the analytical solutions obtained from integrating equations   and the measurements of the amplitudes on the simulation data obtained with our algorithm .",
    "all the amplitudes of the shear wave from the simulation agree well with the analytical solutions for several orbital periods , with some minor deviation in the velocity field of the particles for @xmath147 .",
    "note that the time steps used here are significantly larger than those used in @xcite .",
    "next we probe the case of small particles with @xmath148 and @xmath146 , the result of which is shown in figure  [ f : swav2 ] . in this case , there exists an initial abrupt jump in the @xmath149 and the @xmath150 fields , followed by a smooth oscillatory evolution in the amplitudes as in the previous case .",
    "an integration with the explicit method would require an extremely small time step to resolve and accurately capture this initial jump ; it is not even numerically stable if the time step is larger than the width of this feature .",
    "our algorithm , in contrast , accurately predicts the velocity fields with a time step much longer than the timescale of this feature . in spite of some initial minor deviation of the density fields ,",
    "the solutions with our algorithm closely follow the analytical ones up to @xmath151 , after which some noticeable deviation appears in both the gas and the particle fields .    finally",
    ", we barge into the solid - dominated regime with @xmath148 and @xmath152 , as shown in figure  [ f : swav3 ] . similar to the previous case ,",
    "a yet larger initial jump occurs in the @xmath149 field but a lesser one in the @xmath150 fields , and our algorithm accurately finds the first velocity fields with one long time step . although the algorithm also captures the density field of the particles relatively accurately , a significant error exists in the density field of the gas at the very first time step .",
    "this error affects the accuracy of the subsequent evolution of the shear wave , the most prominent of which is in the frequency of the oscillation in the amplitude of each field .",
    "nevertheless , the general evolution of this shear wave is still reproduced by our algorithm up to @xmath153 , where especially noticeable are the maximum amplitudes achieved in each oscillation of the fields .",
    "this last case highlights that some inaccuracy in density fields can occur when there exists unresolved transient behavior in velocity , a situation reminiscent of the sedimentation benchmark presented in section  [ ss : osc ] .",
    "the magnitude of this numerical error depends on how strong the change in velocity is , and in this test problem , increases with increasing background solid - to - gas density ratio .",
    "note that this kind of transient behavior often stems from initial conditions which are significantly out of equilibrium , as in this case , or impulses imposed onto the system in its course of evolution .",
    "once the impulse subsides and the system resumes smooth evolution , i.e. , one that is resolved by the numerical time steps , our algorithm should exhibit high degree of accuracy , as demonstrated in the first case ( or even the second case ) of this section as well as other benchmarks presented in this work . on the other hand , if the transients are of importance , one can always restrict the time steps so that those can be accurately captured . as demonstrated in figure  [",
    "f : swav4 ] , simply resolving the initial transient jump by four time steps makes the evolution of all fields accurate up to @xmath154 , a similar performance achieved in the earlier cases of figures  [ f : swav1 ] and  [ f : swav2 ] .",
    "an important discovery in the theory of planet formation was that of the streaming instability by @xcite .",
    "this instability efficiently concentrates centimeter / meter - sized solid particles in a protoplanetary gas disk to trigger gravitational collapse and form kilometer - sized planetesimals , circumventing the problematic fast radial drift of the solid particles ( e.g. , * ? ? ?",
    "the mutual drag force between the gas and the solid particles moving in a differentially rotating disk is an essential ingredient in this instability , and hence the results of the analysis carried out by @xcite , serendipitously , can be used as a rigorous touchstone to validate any numerical algorithm concerning the integration of this kind of the particle - gas system .",
    "this is the goal of this section .",
    "the streaming instability is a local , two - dimensional , axisymmetric instability with interpenetrating gas and particles under differential rotation . ignoring vertical gravity and assuming an isothermal equation of state for the gas , @xcite have performed linear analysis on this system and found the growth rate and wave speed of this instability and the corresponding eigenvector as a function of the wavenumber of the perturbation as well as all the relevant dimensionless parameters for the system .",
    "the eigensystem was expressed in the frame of the center - of - mass velocity of the particle - gas system , which was not convenient for direct comparison with numerical simulations , and hence @xcite have transformed these solutions back into the local - shearing - sheet frame and expressed them as a standing wave in the vertical direction while propagating in the horizontal direction .",
    "the resulting eigenfunction is either even @xmath155             e^{st}\\cos k_z z,\\label{e : lsie}\\end{aligned}\\ ] ] or odd @xmath156             e^{st}\\sin k_z z,\\label{e : lsio}\\end{aligned}\\ ] ] in the vertical direction , where @xmath157 is the complex amplitude , @xmath158 is the wavenumber , and @xmath159 is the complex angular frequency .",
    "the vertical component of the velocities of the gas and the particles assumes the odd parity , while all other dynamical fields assume the even parity . on top of the background equilibrium state as given in equations   and with an initially small amplitude for the perturbations , equations   and   then serve as both the initial conditions and the analytical solutions against which our algorithm is validated .",
    "four eigensystems have been published in the literature , all of which are the ( nearly ) fastest growing modes at the respective set of the dimensionless parameters .",
    "we first test the lina and the linb modes in @xcite .",
    "they have the same dimensionless stopping time of @xmath160 as well as the same background radial gas pressure gradient of @xmath161 , where @xmath13 is the isothermal speed of sound and @xmath162 is the local keplerian angular frequency .",
    "on the other hand , the lina mode has a background solid - to - gas density ratio of @xmath163 , while the linb mode has @xmath164 . in our tests ,",
    "the computational domain is such that one wavelength of the mode is fit in each direction .",
    "we use one particle per cell , and use the method described in appendix  c of @xcite to seed a perturbation of @xmath165 in the density field of the particles .",
    "given their positions , the initial velocities of the particles are then set by the perturbation equations   and   as well as the equilibrium drift velocity equations   and  .",
    "it is trivial to set the initial density and velocity field of the gas using equations   and   as well as equations   and  .",
    "we measure the complex amplitude of the fourier mode @xmath166 as a function of time in our simulation data , and then use the linear regression on the magnitude of the amplitude to find the ( exponential ) growth rate @xmath167 .",
    "we vary the resolution to seek the convergence of our measured rate as compared to the analytical one . for comparison purposes , we use three different integration schemes for this test .",
    "one is the explicit integration , as originally used by @xcite .",
    "the other two are our algorithm either with or without particle - mesh back - reaction ( pmbr ) to the gas velocity field , as described in section  [ ss : upgas ] , and we only present the results with the godunov splitting here .",
    "the results are shown in figures  [ f : lina ] and  [ f : linb ] . as can be seen ,",
    "the growth rates for all three schemes converge to the theoretical one with resolution . for the lina mode",
    ", our algorithm _ with pmbr _ achieves virtually the same performance of the explicit integration .",
    "while it requires a resolution of around 3264  points per wavelength @xmath168 for the growth rate of the @xmath16 field to approach within 5% of the theoretical one , it requires around 1632  points per @xmath168 for those of the @xmath169 , @xmath170 , and @xmath149 fields , around 16  points per @xmath168 for that of the @xmath150 field , and only around 48  points per @xmath168 for that of the @xmath171 , @xmath172 , and @xmath173 fields .",
    "albeit convergent , our algorithm _ without pmbr _ has a much slower convergence rate , requiring a resolution of around 64128  points per @xmath168 for the growth rates of most fields , except around 3264  points per @xmath168 for those of the @xmath171 and @xmath16 fields and around 1632  points per @xmath168 for that of the @xmath150 field .",
    "as for the linb mode , our algorithm _ with pmbr _ has again similar growth rates as achieved by the explicit integration",
    ". a resolution of around 3264  points per @xmath168 is required , except for the @xmath149 field , which requires only a resolution of around 1632  points per @xmath168 .",
    "our algorithm _ without pmbr _ remains inferior , requiring a resolution of around 128256 points per @xmath168 in all fields except for the @xmath150 field , which requires a resolution of around 64128 points per @xmath168 .",
    "the other two modes are the linc and the lind modes from @xcite .",
    "these modes push the limit of the dimensionless stopping time down to @xmath174 and @xmath175 , respectively .",
    "they have the same solid - to - gas density ratio of @xmath176 , as well as the same background radial gas pressure gradient @xmath161 as do the lina and the linb modes .",
    "our test results are shown in figures  [ f : linc ] and  [ f : lind ] .",
    "again , the growth rates for all three schemes demonstrate convergence towards the theoretical one .",
    "moreover , the performance of our algorithm _ with pmbr _ remains essentially the same as that of the explicit integration for all fields . for the linc mode , a resolution of around 3264",
    "points per wavelength @xmath168 is required for all the velocity fields , while a resolution of around 1632  points per @xmath168 and that of around 128256  points per @xmath168 are required for the @xmath171 and the @xmath16 fields , respectively . for the lind mode , a resolution of around 64128  points per @xmath168 is required for all the velocity fields , while that of around 128256  points per @xmath168 is required for both the density fields .",
    "we note that the performance of these integrators for these modes is relatively better in comparison with that performed in @xcite . as for our algorithm _ without pmbr _ , the convergence is again much slower as compared to the other two schemes , and it does not even converge to within 5% of the theoretical rate at a resolution of 512  points per @xmath168 for the lind mode except for the density fields , which requires a resolution of around 256  points per @xmath168 .",
    "these results demonstrate the excellent performance of our algorithm in reproducing the linear modes of the streaming instability , especially with a wide range of the dimensionless stopping time @xmath143 .",
    "moreover , they justify the necessity of the implementation of pmbr to the gas velocity in our algorithm as described in section  [ ss : upgas ] .",
    "we note here that there exists no noticeable improvement in the test results when using our algorithm with the strang splitting method . in the next subsection",
    ", we continue to explore our algorithm in the nonlinear saturation of the streaming instability .      in a companion paper to @xcite , @xcite investigated the nonlinear saturation of the streaming instability and found two distinctive patterns that could develop in this stage .",
    "one is for marginally coupled solid particles with @xmath145 , while the other is for strongly coupled solid particles with @xmath160 .",
    "the @xmath145 particles initially concentrate themselves into short stripes that are close to horizontal but tilt alternately in the vertical direction with a separation consistent with the wavelength of the fastest growing mode of the streaming instability .",
    "these stripes then undergo inverse cascade and merge themselves into larger and larger stripes that tilt more and more towards the vertical direction . in the fully saturated stage ,",
    "long , strongly concentrated filaments with a wide separation float either upwards or downwards with much reduced radial drift motion . on the other hand ,",
    "the @xmath160 particles initially create numerous small voids by random , locally divergent motions .",
    "these voids then undergo inverse cascade and merge themselves into larger and larger voids , driving the particles into their rims . in the fully saturated stage ,",
    "voids of various sizes move around in random directions , while the particles stream along the alleyways in between these voids .    using our algorithm along with the godunov splitting method , we rerun model  ba and model  ab in @xcite .",
    "model  ba contains marginally coupled particles with @xmath145 and has a solid - to - gas density ratio of @xmath164 , while model  ab contains strongly coupled particles with @xmath160 and has a solid - to - gas density ratio of @xmath146 .",
    "both models have a background radial gas pressure gradient of @xmath161 . adopting the same computational domains and resolutions as used in @xcite",
    ", we construct a 256@xmath139256  grid with a domain of 2@xmath177@xmath1392@xmath177 and 0.1@xmath177@xmath1390.1@xmath177 for model  ba and model  ab , respectively , where @xmath177 is the scale height of the gas .",
    "we allocate on average one particle per cell , which is sufficient in capturing the overall density distribution function of particles at a fixed resolution , as has been shown by @xcite .",
    "the initial velocities of the gas and the particles are those under mutual drag equilibrium , equations  . the initial density field of the gas is uniform , while the initial positions of the particles are random to seed the streaming instability at all scales .",
    "the resulting evolutions of the density field of the particles are shown in figure  [ f : nsi ] .",
    "as can be seen , we have reproduced the two aforementioned distinct patterns in the saturated state of the streaming instability , with quantitative similarity as the same models in @xcite .",
    "this again illustrates the consistency between the original explicit integration and our algorithm in this work .",
    "finally , we explore our algorithm with its full three - dimensional glory . to the best of our knowledge , there exists no appropriate analytical model that contains all the physics considered in our algorithm .",
    "we therefore resort to our earlier nonlinear simulations published in @xcite as our base for comparison , which employed the technique of explicit integration .      in @xcite",
    ", we systematically studied the dependence of the streaming turbulence in a sedimented layer of solid particles on the computational domain of the simulations . with particles of dimensionless stopping time @xmath178 and a background gas pressure gradient of @xmath161 , where @xmath13 is the isothermal speed of sound and @xmath162 is the local keplerian angular frequency",
    ", we found that multiple radial filamentary concentrations of solids can be driven by the streaming instability and that the characteristic separation between adjacent filaments is on the order of 0.2@xmath177 , with @xmath177 being the vertical scale height of the gas .    using our algorithm along with the godunov splitting method",
    ", we rerun otherwise exactly the same model in @xcite that has a computational domain of 1.6@xmath177@xmath1391.6@xmath177@xmath1390.2@xmath177 and a resolution of 160  points per @xmath177 . figure  [ f : sedsig ] compares the resulting radial concentrations of solids between the simulations in @xcite and in this work .",
    "as can be seen in the comparison , we obtain excellent agreement between the two simulations . despite minor differences in the stochastic erosion and accretion of solids from and onto the filaments ,",
    "the total number of filaments , their radial drifts , and the magnitude of the solid density are all quantitatively and evolutionarily similar .",
    "this experiment demonstrates the consistency between the two techniques in three dimensions and yet again the robustness of our algorithm .    in figure  [",
    "f : seddt ] , we compare the time steps used in the two simulations . for the simulation in @xcite ,",
    "the time steps were initially determined by the hydrodynamic courant condition but soon dropped by roughly one order of magnitude beginning at @xmath179 , where @xmath180 is the local orbital period .",
    "this is predominantly limited by the drag time @xmath181 , which is the timescale for the exponential decay in the relative velocity between the gas and the particles due to their mutual drag interactions , as discussed in section  [ s : intro ] . in the pencil code , it is approximated by @xmath182 , where @xmath16 is the gas density in the cell , @xmath35 is the volume of the cell , @xmath183 is the total number of ( super-)particles in the cell , @xmath90 is the mass of a ( super-)particle , and @xmath1 is the physical stopping time .",
    "note that we used 100% of @xmath181 as our time - step limiter in @xcite , for cells with high local solid - to - gas density ratios ; see section  [ s : intro ] . ]",
    "which , although speeds up the simulations , could amount to a relative error of roughly 10% in relative velocity in the worst - case scenario .",
    "the pencil code defaults to use 20% of @xmath181 as a time - step limiter to guarantee better accuracy , and thus we also show the time steps that would have been used in this case in figure  [ f : seddt ] . as can be seen , the drag time begins to dominate earlier at @xmath184 and the time steps drop by another order of magnitude than those used in @xcite .    on the other hand ,",
    "our algorithm is not limited by the drag time @xmath181 at all .",
    "as shown in figure  [ f : seddt ] , the time steps remain almost constant and are only determined by the hydrodynamic courant condition . dominates the time - step limiter , the courant number used is irrelevant .",
    "] these time steps are in drastic contrast to those used in the simulation of @xcite , the latter of which are more than one order of magnitude smaller , and would have been more than two orders of magnitude smaller if 20% of @xmath181 were adopted .",
    "therefore , this experiment also illustrates the exceptional efficiency of our algorithm , which we set out to achieve in this work .",
    "in summary , we have devised an accurate , efficient numerical algorithm to directly integrate the mutual drag force in a system of eulerian gas and lagrangian solid particles . despite the entanglement between the gas and the particles due to the conventional particle - mesh construct",
    ", we have effectively decomposed the globally coupled system of equations for the mutual drag force and been able to integrate this system on a cell - by - cell basis .",
    "analytical solution exists for the temporal evolution of each cell , which we use to achieve the highest degree of accuracy .",
    "this solution relieves the time - step constraint posed by the mutual drag force , making simulation models with small particles and/or strong local solid concentration significantly more amenable .",
    "we have used an extensive suite of benchmarks with known solutions  in one , two , and three dimensions  to validate our algorithm and found satisfactory consistency in all cases .",
    "even though the strang splitting is formally higher order , we find that its use with our algorithm does not offer significant advantage over the godunov splitting , especially in multidimensional models . in our one - dimensional benchmarks ,",
    "both splittings predict virtually the same velocities , and hence they give the same accuracy in velocities and have the same behavior in numerical convergence . as for the accuracy in particle positions",
    ", although the strang splitting demonstrates expected second - order convergence for small time steps , it degrades to first - order convergence and does not give noticeably improved accuracy than the godunov splitting for large time steps . in our multidimensional benchmarks , on the other hand , no appreciable difference in either density or velocity fields for the gas and the particles exists between the two splitting methods .",
    "we emphasize that since our objective is to relieve the time - step constraint due to the mutual drag force , the use of large time steps is of more interest here .",
    "moreover , note that since the strang splitting requires one more run of either our algorithm or the other integrator than the godunov splitting ( see appendix  [ s : os ] ) , the former is significantly more expensive than the latter , let alone other operator splitting methods of even higher orders .",
    "therefore , we find that employing the godunov splitting with our algorithm is sufficient and more economical for practical purposes",
    ".    the simulation models to which our algorithm can be applied are more general than what have been presented in this work .",
    "first of all , our algorithm only concerns the mutual drag force as well as the rotation / shear - related source terms and the background accelerations .",
    "all other physical processes are consolidated in the other half of the operator - split system of equations as in equations   and are integrated independently of our algorithm . in this regard ,",
    "the particle - gas system that can be considered using our algorithm is unconstrained and potentially arbitrary .",
    "moreover , our algorithm is not limited to the local - shearing - sheet approximation .",
    "for instance , a non - rotating inertial frame , either rectangular or curvilinear , is simply a degenerate case of equations   with the angular frequency @xmath185 , and thus the same solution of section  [ ss : asol ] applies except that the equilibrium velocities ( equations   ) need to be modified accordingly . as for a rotating cylindrical coordinate system , the shear acceleration terms in equations   are replaced by the centrifugal force as well as the external gravity , but an analytical counterpart of the solution in section  [ ss : asol ] can still be obtained from the modified system of equations .",
    "lastly , note also that it is not required for the particles to have the same mass , as shown in equation  .",
    "some elaboration is needed when generalizing our procedure for a system with particles of various stopping times . a closed - form analytical solution as that in section  [ ss : asol ]",
    "is only possible when the stopping time @xmath1 is a constant for all particles . for the case of independent stopping time for each particle ,",
    "nevertheless , it becomes merely a matter of adopting a numerical method that can accurately and efficiently approximate the solution of the corresponding system of equations   in place of the analytical solution of section  [ ss : asol ] .",
    "given the stiffness of the mutual drag force , an implicit method is likely to be required for this purpose .",
    "however , since we have effectively decoupled the system and made it possible to integrate it on a cell - by - cell basis , the individual integration task for each cell does not amount to an unmanageable size of matrix inversion , for instance .",
    "therefore , we expect that this extra complexity would not lead to noxious reduction in computational efficiency with our algorithm .",
    "having the time - step constraint due to stiff mutual drag force removed , our algorithm presented in this work will prove to be useful in the study of dust dynamics in protoplanetary disks .",
    "specifically , a model containing numerous mm / cm - sized pebbles and/or with high mass loading of solids can be simulated as efficiently as a model containing m - sized boulders without strong concentration of them .",
    "in other words , it becomes feasible to evolve small solid particles interacting with a gas disk in relatively high numerical resolution and long simulation time .",
    "this capability is particularly important in further study of the streaming instability with mm / cm - sized pebbles and its connection to planetesimal formation , as pioneered by @xcite , since the wavelength of the fastest growing mode decreases with decreasing particle size and the corresponding growth rate is low when the initial solid abundance is low @xcite . for the same reasons , our algorithm may also find its use in investigating the dynamics of pebbles with the influence of turbulence , vortices , or other large - scale structures in the gas disk , and the corresponding observational consequences .",
    "we thank james m.  stone for motivating this project .",
    "we would also like to thank shu - ichiro inutsuka for his discussion on this work .",
    "significant improvement in the clarity of the manuscript was attributed to the referee s comments .",
    "part of the code development and the benchmarks presented in this work were performed on resources provided by the swedish national infrastructure for computing ( snic ) at lunarc in lund university , sweden .",
    "this research was supported by the european research council under erc starting grant agreement 278675-pebble2planet .",
    "a.  j.  is grateful for financial support from the knut and alice wallenberg foundation and from the swedish research council ( grant 2010 - 3710 ) .",
    "in this section , we demonstrate by a simple example that the mutual drag force between the gas and the particles leads to numerical stresses under the particle - mesh construct . consider a system of uniform gas and uniformly distributed particles .",
    "suppose that all the velocities of gas and particles align in the @xmath9-direction and depend on only @xmath8 .",
    "the evolution of this system then becomes a one - dimensional problem in the @xmath8-direction with all the velocities in the transverse direction , so the densities of both the gas and the particles remain uniform over time .",
    "we construct a regular grid for the gas with one particle at each cell interface , i.e. , the center of cell @xmath28 is at @xmath186 and the @xmath20-th particle is at @xmath187 , where @xmath121 is the cell size .",
    "the system of equations for this problem reads , from equations   and  , @xmath188 where @xmath189 is the velocity of gas in cell @xmath28 , @xmath190 is the velocity of the @xmath20-th particle , @xmath3 is the ( uniform ) solid - to - gas density ratio , @xmath1 is the stopping time , and @xmath191 is the particle - mesh weight function .",
    "we now consider the special case of @xmath192 , where @xmath143 is the dimensionless stopping time , i.e. , @xmath1 normalized by the timescale of interest for the system . in this limit ,",
    "equation   implies that @xmath193 for all @xmath28 .",
    "we further adopt the cic weight function such that @xmath194 and @xmath195 for all @xmath196 .",
    "equation   then becomes @xmath197 for all @xmath20 .",
    "this equation is exactly the same as the diffusion equation with a diffusion coefficient of @xmath198 when spatially discretized by second - order accurate , centered finite differences .",
    "we note that using a higher - order weight function as tsc does not change this diffusion coefficient , but only increases the accuracy of the spatial derivatives .",
    "another special case we can consider is the limit of @xmath199 and @xmath200 . in this limit ,",
    "equation   implies that @xmath201 for all @xmath20 . with the cic weight function ,",
    "equation   then becomes @xmath202 for all @xmath28 .",
    "once again , this equation is the same as the diffusion equation with a diffusion coefficient of @xmath203 , to second - order spatial accuracy .",
    "equations   and   indicates that using the particle - mesh method to treat the mutual drag force introduces numerical shear stresses to the system .",
    "moreover , it can be seen by generalizing the argument outlined above that numerical normal stresses are also induced by the particle - mesh method .",
    "fortunately , the diffusion coefficient associated with these stresses diminishes quadratically with increasing resolution .",
    "on the other hand , this property implies that the system of equations   is indeed globally coupled , and special care needs to be taken to numerically solve this system both accurately and efficiently .",
    "in this appendix , we briefly review the concept of operator splitting , and two standard methods of it .",
    "suppose that @xmath204 is the full partial differential equation in question , where @xmath205 is the vector for the dynamical variables to be solved for and @xmath206 and @xmath207 are two differential operators .",
    "we can _ operator split _",
    "equation   into two separate differential equations as      with @xmath209 and @xmath210 being the respective solutions to equations   along with the initial conditions @xmath211 .",
    "note that @xmath209 and @xmath210 can be either exact or approximate themselves .",
    "then by somehow combining @xmath209 and @xmath210 can the real solution @xmath212 to the full equation   be approximated .",
    "there are two standard operator - splitting methods to approximate the solution @xmath213 at time step @xmath214 with the initial conditions @xmath215 at time step @xmath216 .",
    "the first is called the godunov splitting , and @xmath217 is given by a two - step method :          the accuracies for the godunov and the strang splittings are formally first - order and second - order , respectively . for a proof of these properties and more information , the interested reader is referred to , e.g. , chapter  17 of @xcite ."
  ],
  "abstract_text": [
    "<S> numerical simulation of numerous mm / cm - sized particles embedded in a gaseous disk has become an important tool in the study of planet formation and in understanding the dust distribution in observed protoplanetary disks . </S>",
    "<S> however , the mutual drag force between the gas and the particles can become so stiff , particularly because of small particles and/or strong local solid concentration , that an explicit integration of this system is computationally formidable . in this work , we consider the integration of the mutual drag force in a system of eulerian gas and lagrangian solid particles . despite the entanglement between the gas and the particles under the particle - mesh construct , we are able to devise a numerical algorithm that effectively decomposes the globally coupled system of equations for the mutual drag force and makes it possible to integrate this system on a cell - by - cell basis , which considerably reduces the computational task required . </S>",
    "<S> we use an analytical solution for the temporal evolution of each cell to relieve the time - step constraint posed by the mutual drag force as well as to achieve the highest degree of accuracy . to validate our algorithm , we use an extensive suite of benchmarks with known solutions in one , two , and three dimensions , including the linear growth and the nonlinear saturation of the streaming instability . </S>",
    "<S> we demonstrate numerical convergence and satisfactory consistency in all cases . </S>",
    "<S> our algorithm can for example be applied to model the evolution of the streaming instability with mm / cm - sized pebbles at high mass loading , which has important consequences for the formation scenarios of planetesimals .    </S>"
  ]
}