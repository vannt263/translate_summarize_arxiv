{
  "article_text": [
    "statistical machine learning methods have recently permeated disciplines such as psychiatry , which specialize in the diagnosis and treatment of neuropsychiatric disorders .",
    "the availability of large - scale functional magnetic resonance image ( fmri ) datasets have encouraged the application of advanced machine learning models to the diagnosis of neuropsychiatric disorders @xcite . fmri scans measure brain activity by detecting fluctuations in blood - oxygen levels over time .",
    "brain activations are represented digitally as _ voxels _ , the three - dimensional analogue of pixels .",
    "in this paper we present the application of a temporal model , specifically a hidden markov model ( hmm ) , to the problem of automatically diagnosing attention deficit hyperactivity disorder ( adhd ) from resting - state fmri scans of subjects .",
    "adhd is a psychiatric disorder that adversely affects the attention span , hyperactivity , or impulsivity of an individual .",
    "since adhd positive individuals have difficulty maintaining focus on a mental activity , it is reasonable to assume that the temporal evolution of their brain activities , as measured by the fmri , differ from those of healthy individuals .",
    "it is with this argument that we motivate the use of a temporal model for adhd diagnosis .",
    "the primary challenge in developing a machine learning algorithm for adhd diagnosis is the large dimensionality of the fmri scan .",
    "a single fmri scan may consist of hundreds of three - dimensional images over time , each of which is composed of approximately 500,000 voxels .",
    "therefore , extracting lower dimensional fmri representations that retain discriminative features for diagnosis is an important step in the implementation of diagnosis algorithms . if successful , an automatic adhd diagnosis algorithm would aid mental - health care professionals in the diagnosis and treatment of the disorder .",
    "this paper is structured as follows : the following section provides a review of related work .",
    "section  [ sec : algorithm ] describes the proposed temporal model for adhd diagnosis and outlines the feature extraction and feature representation techniques explored .",
    "section  [ sec : evaluation ] describes the dataset used for training and evaluating the proposed algorithm .",
    "in addition , this section states hypotheses regarding the performance and structure of the learned diagnostic model and describes the evaluation procedure for testing the performance of the algorithm .",
    "the experimental results and analysis are presented in section  [ sec : results ] .",
    "finally , the work is concluded in section  [ sec : conclusion ] .",
    "using the adhd-200 competition dataset , which consists of several hundred resting - state fmri scans , eloyan _ et al . _",
    "@xcite explored several different classifiers for adhd diagnosis , including a support vector machine , gradient boosting , and voxel - based morphology .",
    "in addition , several feature extraction methods were investigated , including singular value decomposition and cur matrix decomposition .",
    "the best classification accuracy was achieved by taking a weighted combination of these classifiers , which yielded @xmath0 accuracy on the test data . also using the adhd-200 competition dataset , sina _",
    "@xcite extracted histogram of oriented gradient features from fmri scans , which were then input to a support vector machine .",
    "the classifier yielded an accuracy of @xmath1 on the test dataset .",
    "these two methods report the highest classification accuracy on the adhd-200 competition dataset .",
    "recent studies @xcite emphasize that different parts of the brain are functionally correlated . taking this into consideration , the human connectome project explores graphical models that seek to capture these functional connectivities , both in task - based and resting - state fmri scans .",
    "similarly , zhang _ _ et al.__@xcite proposed a bayesian network for modeling functional neural activity . in this work , each region of the brain is represented as a node in the graphical model and the functional connectivity of these nodes over time is used for classifying drug addicts from healthy controls .",
    "apart from using functional relations , temporal correlation between brain voxels and connectivity has been explored by fiecas _",
    "furthermore , the temporal relation between mental states and neuronal activities has been investigated by building a conditional random field @xcite .",
    "@xcite proposed two methods based on likelihood and distance measures to analyze fmri scans using an hmm .",
    "however , this work focuses on analyzing the blood oxygen level dependent ( bold ) signal for brain activities in order to predict the brain activations in task - based fmri time series .",
    "@xcite analyzed the functional connectivity dynamics in resting state fmri and decoded the temporal variation of functional connectivity into a sequence of hidden states using an hmm .",
    "similar to the previously mentioned temporal approaches to adhd classification , we will investigate the temporal evoluation of voxels for both healthy and adhd positive subjects using an hmm .",
    "however , we explore reduced dimensional representations of fmri voxels in adhd regions of interest .",
    "the analysis of regions of interest in an fmri scan instead of the entire brain is common practice .",
    "for instance , solmaz _ et al . _",
    "@xcite used a bag of words approach for identifying adhd patients using the _ default mode network _ region of the brain .",
    "in order to learn an adhd classification model , several steps are necessary . for each time slice of the fmri , voxels are extracted from adhd regions of interest ( rois ) in the brain and dimensionality reduction algorithms are applied to the voxels in each region to reduce the dimensionality of the data .",
    "the resulting data is presented as observations to a cluster of hidden markov models ( hmms ) that learn to discriminate between healthy , adhd inattentive , and adhd combined types .",
    "using the resulting classifier , new fmri data can be input to the system ; features are extracted from the fmri data , which the classifier uses to diagnose the subject .",
    "this process is depicted in figure  [ fig : algorithmio ] .",
    "each step of the process is explained in more detail in the following sections .          for each time slice of each fmri scan ,",
    "we extract clusters of voxels that correspond to the twelve adhd regions of interest from the cortex , cingulate gyrus , and thalamus regions of the brain @xcite , according to the harvard - oxford cortical and subcortical structural atlas . each roi is composed of approximately 4000 voxels ; there are 48,710 voxels across all rois , which is less than a tenth of the @xmath2 voxels in one time slice of an fmri scan . despite this reduction in dimensionality ,",
    "the dimensionality of the feature space is still quite large . to further reduce the dimensionality of the feature space , four dimensionality reduction algorithms  described in the following sections ",
    "are applied to the fmri voxels extracted from the twelve adhd regions of interest .",
    "an unsophisticated method of dimensionality reduction is to simply compute the average value of the given feature set . using this method",
    ", we compute the average of the fmri voxel values in each region of interest .",
    "the output of this dimensionality reduction method is a matrix @xmath3 , such that @xmath4 is the number of subject fmri scans in the dataset , @xmath5 is the number of image samples over time , and 12 is the number of rois .",
    "the average value of the voxels ignores the fact that the voxels lying near the centre of a region of interest may contain more information than the voxels at the boundary . taking this into consideration , we experimented with computing a weighted mean of voxels for each region of interest .",
    "the weights were derived from a univariate gaussian distribution with a standard deviation of one and a mean value that is aligned with the center of that region .",
    "hence , voxels further from the centre will be assigned smaller weights .",
    "the output of this dimensionality reduction method is a matrix @xmath3 , such that @xmath4 is the number of subject fmri scans in the dataset , @xmath5 is the number of image samples over time , and 12 is the number of rois .      principal components analysis ( pca)@xcite applies an orthogonal transformation to an input dataset to convert a set of possibly correlated variables into a set of linearly uncorrelated variables named principal components .",
    "pca is applied to the voxels in each region of interest and the three principal components with the largest spectral components are selected .",
    "the term _ spectral components _ refers to the singular values in the singular value decomposition of the input data matrix .",
    "three principal components were selected because these singular values were substantially larger than the others , and thus , these principal components capture the most information about the input voxel data .",
    "the output of this dimensionality reduction method is a matrix @xmath6 , such that @xmath4 is the number of subject fmri scans in the dataset , @xmath5 is the number of image samples over time , and @xmath7 is a concatenated vector containing the three principal components computed for each of the twelve regions of interest",
    ".      kernel principal components analysis ( kpca ) is a non - linear dimensionality reduction technique that maps the data to a non - linear feature space that is defined by a kernel function .",
    "the mapping attempts to unfold the data onto a lower dimensional manifold . in the context of our project , we assume that the fmri voxels in each region of interest lie on a ten dimensional manifold , which the kpca algorithm will attempt to recover . given an fmri scan , for each time instance we apply kpca on each of the twelve regions of interest . in order to stretch the underlying lower dimensional manifold , the feature space should maximize the distance between two neighboring points while keeping the locality constraint intact . formally , if @xmath8 , @xmath9 , and @xmath10 are three neighboring points and their corresponding feature - space representation is @xmath11 , and @xmath12 then the problem of manifold learning becomes @xmath13 subject to the constraint that @xmath14 and @xmath15 @xcite .",
    "this optimization problem can be efficiently solved by semidefinite programming techniques .",
    "the output of this dimensionality reduction method is a matrix @xmath16 , such that @xmath4 is the number of subject fmri scans in the dataset , @xmath5 is the number of image samples over time , and @xmath17 is a concatenated vector containing the ten dimensional subspace computed by kpca for each of the twelve regions of interest .",
    "regardless of the dimensionality reduction algorithm used , the feature output is a matrix @xmath18 , such that @xmath4 is the number of subject fmri scans , @xmath5 is the number of image samples over time , and @xmath19 is the size of the feature set after dimensionality reduction . the sequence of fmri features of a subject are posed as _ observations _ to an hmm , a probablistic graphical model with the structure presented in figure  [ fig : hmmstructure ] .",
    "the latent variables ( hidden states ) of the hmm correspond to the current _ mental state _ of the brain .",
    "for example , the mental state of the brain can be interpreted as the task or thought being focused on at any given time .    for training the model ,",
    "the fmri scans in the dataset described in section  [ subsec : dataset ] are partitioned into groups according to their corresponding class label : healthy ( 1 ) , adhd inattentive ( 2 ) , or adhd combined ( 3 ) .",
    "one hmm is trained for each class label .",
    "each hmm @xmath20 is initialized with random values for the initial state distribution , the transition matrix , and the emission distribution .",
    "the emission distribution is a gaussian mixture model .",
    "preliminary experiments using mean voxel values for regions revealed that a mixture of five gaussian distributions yielded optimal results . from the dataset , the model parameters of each hmm were learned using the baum - welch algorithm @xcite .",
    "the probabilistic modeling toolbox for matlab was used for model initialization , training , and classification .",
    "given an fmri scan of a single subject @xmath21 , adhd classification is performed by returning the model @xmath22 that maximizes the probabililty of the observations @xmath23 @xmath24 where @xmath25 is computed by summing the forward variables in the _ forward - backward _ procedure , which rabiner @xcite meticulously describes .",
    "this section will describe the fmri dataset used to train and evaluate the proposed temporal adhd diagnosis model .",
    "several hypotheses are made regarding the performance and structure of the model . to confirm or refute these conjectures ,",
    "several experiments are proposed .",
    "the adhd-200 competition dataset is used to train and evaluate our adhd diagnosis model .",
    "the dataset consists of 940 fmri scans of subjects that are labeled by health - care professionals as healthy control , adhd inattentive , adhd impulsive , or adhd combined .",
    "only 39 fmri scans are labeled as adhd impulsive , so these scans were removed from the dataset .",
    "there are 91 image samples over time for each subject fmri scan . therefore , the dataset is of the form @xmath26 , where the raw fmri scans contain @xmath27 voxels per time sample .",
    "the adhd-200 competition dataset preprocesses the raw fmri scans using the following transformations : motion correction , which compensates for patient head movement ; co - registration , which projects each time slice of an fmri scan to a standard structural mri scan space ; normalization , which transforms the size and shape of each fmri scan to have the same dimensions ; temporal filtering , which removes drift or noise from the time - series data ; and intensity normalization , which normalizes the voxel values to lie within the range @xmath28 $ ] .",
    "we propose several hypotheses regarding our diagnosis model :    a.   increasing the model complexity ( number of hidden states in the hmm ) will increase classification accuracy .",
    "b.   in terms of the dimensionality reduction algorithm used , the classification accuracy of the proposed diagnosis system using kernel pca features will be greater than pca , which will be greater than weighted voxel means , which in turn will be greater than voxel means .",
    "the rationale for this hypothesis is that taking the mean or weighted mean value of voxels in each of the twelve rois navely reduces the dimensionality of the feature space such that discriminative features for proper classification are discarded .",
    "we hypothesize that the alternative dimensionality reduction algorithms will preserve discriminative features .",
    "c.   after training , the trace of the state transition matrix for the healthy hmm @xmath29 is higher than the trace of the state transition matrices for the adhd - i hmm @xmath30 and the adhd - c hmm @xmath31 . recall that the trace operator of a matrix sums the diagonal entries of the matrix , which are the probabilities that the mental state of the subject stays the same .",
    "the rationalization for this conjecture is that healthy subjects will tend to stay in the same mental state in contrast to subjects that are adhd positive .",
    "we use 5-fold cross validation to evaluate our implemented diagnosis algorithm .",
    "the fmri dataset is partitioned into five subsets , such that in each iteration 4/5 of the dataset is used for training and 1/5 of the dataset is used for testing .",
    "a different subset is used for testing in each iteration .",
    "care is taken to partition the dataset such that each subset is populated with an equal distribution of class labels , i.e. , each of the five subsets contain an equal proportion of fmri data corresponding to healthy , adhd - i , and adhd - c types .",
    "when testing on the @xmath32 subset of data , our classifier will output a class label @xmath33 for each of the @xmath34 fmri scans . given the ground - truth labels @xmath35",
    ", the accuracy of our classifier on fold @xmath36 is @xmath37 the final classification accuracy is reported as the average of the classification accuracies computed for each of the five cross - validation folds ( [ eqn : foldacc ] ) .    to confirm or refute the hypotheses posed in the previous section",
    ", several experiments have been designed . to test hypothesis ( i  ii ) , for each dimensionality reduction method proposed , 5-fold cross validation will be conducted for the following number of hmm states @xmath38 $ ] . in this case",
    ", each of the three hmms will have the same state value . hypothesis ( ii ) can be accepted or rejected based on the results reported by the experiment proposed for hypothesis ( i ) . to test hypothesis ( iii ) , using the dimensionality reduction method and number of states parameter that received the highest accuracy in experiment ( i ) ,",
    "this model will be trained on the entire dataset and the trace of the transition matrix for the healthy hmm will be compared to the trace of the transition matrix for the adhd - i and adhd - c hmms .",
    "the results of the experiment proposed for hypothesis ( i ) and ( ii ) are presented in table  [ tab : cvresults ] , which displays the 5-fold cross - validation accuracy for different numbers of hidden states in the hmm as well as different fmri dimensionality reduction methods .    our first hypothesis states that classification accuracy will increase as the model complexity increases .",
    "analyzing the 5-fold cross - validation accuracy of the proposed model for different numbers of hidden states in the hmms , ( table  [ tab : cvresults ] ) reveals that our first hypothesis is not quite correct . in the case of the voxel mean , weighted voxel mean , and kernel pca dimensionality reduction methods , we see an increase in cross - validation accuracy as the model complexity increases until a point where further increases in complexity actually hinders classification performance . in the case of pca",
    ", we see minute fluctuations in the classification accuracy as model complexity increases ; however there is no apparent trend .",
    "this phenemenon suggests that when processing pca features of fmri scans , classification of adhd may be independent of the internal hidden state of the hmm and alternative temporal models should be explored in this case .    for each dimensionality reduction method ,",
    "if we consider the number of states parameter that yields the maximum cross - validation classification accuracy ( typeset in bold in table  [ tab : cvresults ] ) , our hypothesis that the classification accuracy of kernel pca will exceed pca , which will exceed weighted voxel means , which will exceed the accuracy of voxel means , is almost correct .",
    "the results show that the classification accuracy of pca and kpca dimensionality reduction is indeed greater than weighted voxel means , which is greater than voxel means .",
    "however , the accuracy of pca and kpca are almost equivalent and outperform state - of - the - art diagnosis systems on the adhd-200 dataset @xcite .",
    "hence , we conclude that for pca , the three components along the maximum variability of data successfully captures a significant amount of information necessary for classifying adhd .",
    "also , our assumption that the fmri data for each subject and for each time instance lies on a lower dimensional manifold is also true for the purposes of classification .",
    "our third hypothesis states that when training our classifier with 20 hidden states for each of the three hmms on the entire fmri dataset using pca dimensionality reduction , the trace of the transition matrix for the healthy hmm will be larger than the trace of the transition matrices for the adhd - i and adhd - c hmms .",
    "the results of this experiment are presented in table  [ tab : transtrace ] . though the results show that our hypothesis is in fact correct , the differences in trace are too insignificant to draw any concrete conclusions .",
    "perhaps the most interesting question that arises from this experiment is why the trace of the transition matrices are so small .",
    "note that a trace value of two on a transition matrix of the form @xmath39^{20",
    "\\times 20}$ ] implies that each self - state transition in the hmm is approximately @xmath40 .",
    "this suggests that most of the transitions among the underlying markov chain may be from one state to another instead of from one state to itself .    upon further investigation of the transition matrices",
    ", it seems the opposite is true . in all cases ,",
    "i.e. , for all numbers of hidden states , and for all dimensionality reduction algorithms explored , one state in the markov chain has a high self - state transition probability in the order of approximately 0.99 .",
    "that is , 99% of the time , the markov chain will remain in this state once it wanders onto the state .",
    "this means that a single state is essentially attempting to explain every single time slice of the fmri , which is not the desired effect of using such a temporal model .    .5-fold cross - validation results for adhd classification ( healthy , adhd - i , or adhd - c ) using various numbers of hmm states for the following feature representations : voxel means , weighted voxel means , pca , kpca [ cols=\"^,^,^,^,^\",options=\"header \" , ]     although the results of our proposed temporal adhd classification model are comparable to state - of - the - art adhd classifiers published in the literature @xcite , our system barely performs above the threshold of labeling every input data instance as the majority class in the training dataset .",
    "the majority class is the _ healthy _ subject type and amounts to 62.13% of the dataset .",
    "this is compared to our best result of 63.01% when using 20 hidden states and principal components analysis for dimensionality reduction of the fmri .",
    "there are several explanations for the lackluster performance of the proposed classifier , some of which pertain to the performance of adhd classification systems in general .",
    "perhaps the difference between the resting state brain activity for individuals who are adhd positive and adhd negative is negligible .",
    "it could also be the case that the regions of interest extracted from the resting - state fmri do not contain discriminative information for diagnosing adhd and other regions of interest should be explored .",
    "another possible explanation is that the sampling frequency of the physical fmri machine does not coincide with the frequency with which the brain switches mental processes and our temporal model is not synchronized with the real mental state transitions of the brain .",
    "it could also be that the dimensionality reduction algorithms that we explored in this paper severely degrade the discriminative power of the raw voxel intensities .",
    "on the other hand , it could be that the dimensionality reduction methods still yield too many features and feature selection algorithms should be applied to the observations posed to the hmms . to see if this is the case , we performed pairwise t - tests on the voxel mean features for the twelve regions of interest for adhd and found that region number 4 ( _ intra - calcarine cortex _ ) , 5 ( _ frontal medial cortex _ ) , 9 ( _ cingulate gyrus , posterior division _ ) , and 10 ( _ frontal orbital cortex _ ) do not exhibit any discriminative power between healthy controls and adhd positive subjects .",
    "that is , the null hypothesis that a set of features are not important is true for these regions of interest .",
    "the development of automatic adhd diagnostic algorithms from fmri data is a challenging task .",
    "the application of statistical pattern recognition algorithms to this problem currently yield insubstantial results , rendering these classification systems unfit for practice in the health - care industry .",
    "however , much research is being done to improve these results and search for discriminative features for classifying adhd amongst the plethora of voxel values present in a single fmri scan .",
    "apart from systems that aggregate fmr images over time to produce a single three - dimensional image of the brain that is then used for classification , in this paper we explored a temporal classification system that uses the evolution of voxel values over time to make decisions regarding adhd diagnosis . specifically , we used the adhd-200 competition dataset to learn an hmm classifier that classifies the subject as healthy , adhd inattentive type , or adhd combined type from an input fmri scan .",
    "we investigated and evaluated the application of several dimensionality reduction algorithms to twelve adhd regions of interest in the fmri scan .",
    "our results indicate that a hidden markov model with 20 hidden states processing fmri data , where the dimensionality is reduced by the principal components analysis algorithm , yields the best results with 63.01% 5-fold cross - validation accuracy .",
    "still , there is much work to be done in this area .",
    "our analysis of the transition matrices of the trained hidden markov models indicate that other temporal models , such as recurrent neural networks or hidden markov models with more arcs between nodes , should be explored in future work .",
    "moreover , we propose that locating lower dimensional sets of fmri features that retain discriminative power for adhd classification is the heart of the problem and that the majority of future work should focus on this task ."
  ],
  "abstract_text": [
    "<S> this paper applies a hidden markov model to the problem of attention deficit hyperactivity disorder ( adhd ) diagnosis from resting - state functional magnetic resonance image ( fmri ) scans of subjects . </S>",
    "<S> the proposed model considers the temporal evolution of fmri voxel activations in the _ cortex _ , _ cingulate gyrus _ , and _ thalamus _ regions of the brain in order to make a diagnosis . </S>",
    "<S> four feature dimensionality reduction methods are applied to the fmri scan : voxel means , voxel weighted means , principal components analysis , and kernel principal components analysis . using principal components analysis and kernel principal components analysis for dimensionality reduction </S>",
    "<S> , the proposed algorithm yielded an accuracy of 63.01% and 62.06% , respectively , on the adhd-200 competition dataset when differentiating between healthy control , adhd innattentive , and adhd combined types . </S>"
  ]
}