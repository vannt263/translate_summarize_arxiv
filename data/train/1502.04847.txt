{
  "article_text": [
    "projector quantum monte carlo ( qmc ) methods are important tools in calculating accurate properties of quantum systems.@xcite such methods involve stochastically applying a projection operator , @xmath0 , such that the desired evolution is achieved _ on average_. this leads to a stochastic and sparse sampling of the object under consideration , thus reducing the associated memory requirement and often allowing for the study of larger systems than possible with exact , deterministic approaches . while this approach is beneficial in granting access to such systems , the stochastic error decays slowly with simulation time ; increasing the efficiency of the sampling therefore allows greater statistical accuracy to be obtained .    a recent projector qmc method ,",
    "full configuration interaction quantum monte carlo ( fciqmc)@xcite , has been greatly successful in the highly - accurate study of many challenging systems , providing fci - quality results for systems well out of reach of traditional deterministic fci approaches . while many traditional projector qmc methods such as diffusion monte carlo ( dmc ) sample the wave function in real space , fciqmc performs the sampling in a space of discrete basis states .",
    "this discrete sampling of the wave function allows efficient annihilation to take place between the walkers , greatly ameliorating the sign problem in many situations@xcite and removing the need for a fixed node approximation .    a recent article by petruzielo _ _ et al.__@xcite provided a number of significant advances in fciqmc , including the introduction of a semi - stochastic approach . in this approach",
    "the basis states forming the fci space are divided into two sets .",
    "the projection in the space of states in one set , whose states are deemed to be most significant , is performed exactly .",
    "the rest of the projection operator is applied stochastically as in the traditional fciqmc algorithm . by performing projection in the most important region of the space exactly , the stochastic error on results",
    "can be significantly reduced . as the additional memory requirements need not be overwhelmingly large , the approach is still capable of treating systems far beyond those accessible to exact diagonalization , and therefore there were no significant drawbacks which offset this reduction in random error .    in this article",
    "we further investigate and apply the semi - stochastic adaptation . in section  [ sec : theory",
    "] we present a brief overview of the method and in section  [ sec : determ_space ] suggest a flexible and relatively black box method for partitioning the fci space . in section",
    "[ sec : implementation ] we explain how the semi - stochastic adaptation can be implemented in a straightforward and efficient manner in an existing fciqmc code . due to the importance of the efficient parallel scaling of fciqmc",
    "we place particular emphasis on this aspect . in section",
    "[ sec : results ] results are presented . it is demonstrated that the semi - stochastic adaptation need not greatly alter the parallel performance in the current regime of applicability , and we present results for our method of partitioning the fci space , both in the standard energy estimator and also in the calculation of reduced densities matrices within fciqmc .",
    "finally , the semi - stochastic approach is used to study the beryllium dimer , with f12 corrections calculated from reduced density matrices .",
    "the fciqmc wave function is represented by a collection of walkers which have a weight and a sign and reside on a particular many - electron basis state , which if not specified can be assumed to be a single slater determinant .",
    "the total signed weight of walkers on a state is interpreted as the amplitude of that many - electron basis state in the ( unnormalized ) fci wave function expansion .",
    "the fciqmc algorithm consists of repeated application of the projection operator @xmath1 to some initial state , where @xmath2 is the hamiltonian operator , @xmath3 is some small time step and @xmath4 is an energy offset ( ` shift ' ) applied to the hamiltonian to control the total walker population . with sufficiently small",
    "@xmath3 , exact repeated application of @xmath0 will project the initial state to the ground state of @xmath2@xcite . in fciqmc , @xmath0 is applied such that the correct projection is only performed on average , thus leading to a stochastic sampling of the ground state wave function .    the projection operator can be expanded in the chosen fci basis as @xmath5 in the semi - stochastic adaptation the set of basis states is divided into two sets , @xmath6 and @xmath4 .",
    "we refer to the space spanned by those basis states in @xmath6 as the _ deterministic space _ , and refer to the basis states themselves as _ deterministic states_. the terms in eq .  ( [ eq : proj_op ] ) can then be divided into two separate operators , @xmath7 where @xmath8 refers to the deterministic projection operator , @xmath9 and @xmath10 is the stochastic projection operator containing all other terms . in semi - stochastic fciqmc , @xmath8 is applied exactly by performing an exact matrix - vector multiplication , while @xmath10 is applied using the stochastic fciqmc spawning steps as usual.@xcite in order to perform an exact projection in the deterministic space , the walker weights must be allowed to be non - integers .",
    "this differs from most previous descriptions of the fciqmc algorithm thus far . to be clear in notation and terminology",
    ", we use @xmath11 to refer to the _ signed _ amplitude on a state , and @xmath12 to refer to the _ unsigned _ amplitude ( and so @xmath13 ) , which we refer to as the _ weight _ on the state .    a complete iteration of semi - stochastic fciqmc is performed as follows , where @xmath14 :    1 .   * stochastic projection * : loop over all occupied states . perform @xmath15 spawning attempts from state @xmath16 , where @xmath15 is specified below . for each spawning attempt , choose a random connected state @xmath17 with probability @xmath18 , where connected means that @xmath19 and @xmath20 .",
    "the attempt fails if both @xmath16 and @xmath17 belong to @xmath6 , otherwise a new walker on state @xmath17 is created with weight and sign given by @xmath21 .",
    "deterministic projection * : new walkers are created on states in @xmath6 with weights and signs equal to @xmath22 , where @xmath23 is the vector of amplitudes currently on states in @xmath6 .",
    "* death / cloning * : loop over all occupied states in @xmath4 . for each state create a spawned walker with weight and sign given by @xmath24 .",
    "* annihilation * : combine all newly spawned walkers with walkers previously in the simulation by summing together the amplitudes of all walkers on the same state .",
    "@xmath15 is chosen probabilistically such that its expected value obeys @xmath25=n_i$ ] .",
    "although other approaches have been used@xcite , in this work we set @xmath26 where @xmath27 denotes rounding up and @xmath28 denotes rounding down . if integer weights are used then this reduces to @xmath29 , as used in previous work@xcite .",
    "in order to reduce the memory demands of having a large number of states occupied with a low weight , a minimum occupation threshold , @xmath30 , is defined .",
    "after all annihilation has occurred , any walkers with a weight less than @xmath30 are rounded up to @xmath30 with probability @xmath31 or otherwise down to 0 . in practice , we always choose @xmath32 .",
    "the occupation threshold is not applied to deterministic states so that the deterministic projection is applied exactly .",
    "we further use a modification to the initiator adaptation to fciqmc@xcite by allowing all successful spawning events both from and to the deterministic space to survive .",
    "this effectively forces all deterministic states to be initiators , which is sensible since these states should selected by their importance ( i.e. weight ) . in the scheme used by petruzielo _",
    "_ , the initiator threshold was allowed to vary based on the number of steps since a walker last visited the deterministic space , and so our approach is different ( although deterministic states are always initiators in both schemes ) . in supplemental material@xcite",
    "we show that our scheme achieves the same qualitative behavior for the hubbard model as demonstrated in ref .",
    "we have not performed a comprehensive study of the effect of semi - stochastic on the initiator error . however , we tend to find that when the number of walkers , @xmath33 , is much larger than the deterministic space size , the use of semi - stochastic makes little difference .",
    "this is expected because the two approximations should be identical in the limit @xmath33/@xmath34 .",
    "we also note that it is not essential to use both the initiator and semi - stochastic adaptations together ; the benefits from both extensions are largely independent of each other .",
    "however , all results presented in this article do use the initiator adaptation .    using non - integers weights",
    "can have a significant memory impact compared to integer weights due to the large number of additional spawned walkers , which also increases time demands due to expensive extra processing and communication steps .",
    "we therefore apply an unbiased procedure to stochastically remove newly - spawned walkers with very small weights , similar to that above . following the notation of overy _",
    "_ et al.__@xcite , we use a spawning cutoff , @xmath35 , where @xmath36 unless stated otherwise . a spawning of weight @xmath37 is rounded up to @xmath35 with probability @xmath38 or otherwise down to 0 .",
    "spawned walkers with weights greater than @xmath35 are left unaltered .",
    "the key to reducing stochastic error within the semi - stochastic approach is to choose @xmath6 such that most of the weight of the true fci wave function is in this space . for a given number of basis states in the deterministic space , @xmath39",
    ", it is expected that the best possible deterministic space ( the one which reduces noise the most ) is obtained by choosing the @xmath39 most highly weighted basis states in the exact expansion of the ground - state wave function .",
    "achieving this optimal space requires knowledge of the exact wave function and so is not feasible in general .",
    "a sensible choice for @xmath6 in many systems would be a truncation of the fci space by number of excitation operators applied to an initial dominant configuration ( generally the hartree - fock state ) , giving the truncated ` ci ' expansion , or alternatively a complete active space ( cas ) truncation .",
    "these are generally regarded as being effective at describing situations where dynamical and static correlation , respectively , are important .",
    "we have found from experience that such spaces are useful and lead to a large reduction in stochastic noise .",
    "this leads to the question : can one find a better deterministic space , at least in common cases ?",
    "petruzielo _ _ et al.__@xcite describe an iterative method for choosing the deterministic space .",
    "first the space connected to the states chosen in the previous iteration is generated and the ground state of the hamiltonian in this subspace is calculated .",
    "the most significant basis states in the ground - state expansion are kept ( according to a criterion on the amplitude of coefficients ) .",
    "the initial space contains ( e.g. ) the hartree  fock determinant .",
    "this process is repeated for some number of iterations .",
    "this approach was shown to give much greater improvements than by simply using the space connected to the hartree  fock state , even with a reduced size for @xmath6 , as it can contain the chemically - relevant basis states@xcite .    in this work we present and use a new method of generating the deterministic space .",
    "inspired by the spirit of fciqmc , we allow the deterministic space to emerge from the calculation itself : we simply perform a fully - stochastic fciqmc calculation ( or a semi - stochastic calculation with a simple deterministic space , such as a cisd space ) until a coarse representation of the ground state is deemed to have been reached , and then choose the most populated basis states in the fciqmc wave function to form @xmath6 . because the semi - stochastic adaptation does not significantly change the rate of convergence , and statistics are not accumulated until the ground state is reached anyway ( where the semi - stochastic adaptation is of more benefit ) , this requires no extra computational effort .",
    "this approach has the benefit that it does not require performing an exact ground - state diagonalization within a ( potentially large ) subspace , which can be very expensive .",
    "the only parameter is the desired deterministic space size and it is therefore also a relatively black box approach .",
    "although the fciqmc wave function is only a stochastic snapshot of the true ground state , the most significant basis states in the expansion will tend to remain highly occupied throughout the simulation with weights fluctuating about their exact values .",
    "the fciqmc simulation naturally picks out chemically - important determinants , even when deep in the hilbert space ( on quadruple , sextuple and higher excitation levels ) , and so our procedure can select close - to - optimal deterministic spaces in a very inexpensive manner . for very large deterministic spaces , states with the smallest occupation weights",
    "may be included in the space . in this case",
    "there is some redundancy in how @xmath6 is chosen , and the choice of @xmath6 will probably not be optimized fully , although we still find this approach to work very well .",
    "it is simple to include a cutoff to avoid this if desired , although we do not do so in the calculations presented here . with our approach",
    "we avoid the need for diagonalization steps , which would become unfeasible for large @xmath6 and as the connectivity of the hamiltonian grows .",
    "for instance , in some previous applications of fciqmc the number of connections to the hartree - fock has been @xmath40$]@xcite .",
    "an in - depth description of our fciqmc implementation is given in ref .",
    "( ) ; we present here only the additions to that algorithm required for the semi - stochastic implementation .",
    "our implementation of fciqmc is parallelized using mpi .",
    "a given basis state is assigned to a particular mpi process , which performs all spawning from that basis state .",
    "deterministic and stochastic states are treated equally in this respect .",
    "iterative diagonalization methods , such as the davidson or lanczos methods , typically require at most a few tens of iterations .",
    "given the desire to treat as large a system as possible and the memory cost of storing even a compressed form of @xmath41 , many deterministic subspace methods use the direct ci approach of constructing @xmath42 as needed@xcite .",
    "in contrast , fciqmc calculations regularly require on the order of @xmath43 iterations .",
    "thus , it is of critical importance that each multiplication by the ( comparatively small ) deterministic hamiltonian is very fast .",
    "storing the hamiltonian , which speeds up this multiplication considerably , is therefore worthwhile and feasible .",
    "because fciqmc scales well to large numbers of processors , a large amount of distributed memory is typically available and one is usually far more time - limited than memory - limited . as such , we have not found this memory requirement to become an issue .",
    "the deterministic hamiltonian is stored in a sparse matrix format and split across processes so that , if @xmath44 belongs to an mpi process , then all non - zero elements @xmath45 ( i.e. the entire compressed row ) are also stored in memory on that process . in contrast the walker amplitude for basis state @xmath44 is only stored in memory for the process to which @xmath44 belongs .",
    "we gather the amplitudes of the deterministic basis states via an mpi_allgatherv call and perform the deterministic projection via a sparse matrix multiplication on each mpi process .",
    "our implementation therefore requires one additional parallel communication per iteration compared to the standard fciqmc algorithm .    for the most part",
    ", deterministic states are treated in the same manner as non - deterministic states . because the stochastic and deterministic spaces are coupled , stochastic spawning attempts must still be performed from @xmath6 .",
    "however , because the deterministic - to - deterministic projection is performed exactly , such stochastic attempts should not create new walkers inside @xmath6 .",
    "for simple deterministic spaces , such as ci and cas spaces , it is possible to create excitation generators which never create deterministic - to - deterministic spawnings .",
    "this is not feasible for more general spaces , such as in the schemes outlined in the previous section .",
    "instead , we remove any walkers stochastically spawned from a state in @xmath6 to another state in @xmath6 .",
    "this check is efficiently performed by using a hash table ( similar to that used for annihilation in fciqmc@xcite ) of the deterministic space , such that the test of whether the basis state is in @xmath6 can be performed in @xmath46 $ ] time .",
    "the extra memory required to store the hash table is usually negligible compared to other memory requirements , such as that of the deterministic hamiltonian .",
    "it is also partially compensated by the fact that a smaller number of ( stochastic ) spawned walkers are accepted , and so memory demands of the spawned list are decreased .",
    "figure  [ fig : scaling_cr2 ] presents the parallel speed - up for the chromium dimer ( bond length 1.5 , sv basis , cas ( 24,30 ) ) from 24 to 1152 cores on archer , a cray xc30 .",
    "this system has a hilbert space size of @xmath47 $ ] , and approximately @xmath48 walkers were used in each simulation ( sufficient to converge the initiator error to high accuracy ) .",
    "we consider fciqmc calculations using both integer weights and non - integer weights , and semi - stochastic fciqmc using @xmath49 and @xmath50 .",
    "it is apparent that the scaling quality reduces somewhat by using non - integer coefficients .",
    "however , there is almost no further decrease in quality when using the semi - stochastic adaptation .",
    "in fact , the scaling is slightly improved when using a deterministic space size of @xmath51 .",
    "the semi - stochastic initialization times , usually negligible compared to the total calculation time , were not included in these results so that the scaling curves did not depend on the number of iterations performed .    by far",
    "the largest cause of loss in parallel efficiency in fciqmc is poor load balancing .",
    "the number of basis states and walkers assigned to each process is not precisely constant .",
    "each process therefore takes a different amount of time to complete each iteration .",
    "the slowest process acts as a bottleneck for other processes with less work , which must synchronize before parallel communication can be performed .",
    "it is found that using non - integer coefficients somewhat exacerbates this issue , leading to the loss of parallel efficiency seen in figure  [ fig : scaling_cr2 ] .",
    "this worsening of load balancing with non - integer coefficients is primarily due to the greatly increased number of spawning events that are received , and must be processed , by processes with already - heavy loads .",
    "as expected , communication time is also increased by using non - integer weights due to the extra spawning events that must be sent and received , but this time still remains quite small compared to the synchronization time .",
    "figure  [ fig : scaling_hubbard ] shows similar results for the 18-site 2d hubbard model , with solid ( dashed ) lines representing @xmath52 ( @xmath53 ) .",
    "all calculations used approximately @xmath54 walkers .",
    "the load balancing for @xmath53 , which has a highly delocalized wave function in the bloch basis , is very good .",
    "excellent ( essentially identical ) parallel scaling is seen in all cases .",
    "the @xmath52 system , however , is heavily dominated by the hartree  fock state .",
    "therefore , the process to which this state belongs takes much longer to complete each iteration than other processes . this problem is exacerbated as the process count increases , and the parallel performance is very poor .",
    "it is found that using the semi - stochastic adaptation slightly improves this performance , as the hartree ",
    "fock process has far fewer successful spawning events to perform calculations on , due to many deterministic - to - deterministic stochastic spawning events being canceled . despite this ,",
    "the most expensive steps are the spawning attempts , which are still performed , and so the load balancing is still poor .    however , if all states connected to the hartree ",
    "fock through a single application of @xmath2 are included in the deterministic space , then _ all _ stochastic spawnings from the hartree  fock state will be canceled .",
    "as such there is no need to attempt any spawning from the hartree  fock state .",
    "when this change is made , the parallel performance improves dramatically .",
    "this suggests that using deterministic approaches to treat the most heavily - weighted states may be a very effective way to improve the parallel performance of fciqmc .",
    "this approach has not been used for any further results in this article , but will be an area of research going forward .",
    "walkers used .",
    "scaling worsens with the use of non - integer weights , primarily due to exaggerating the poor balancing of work among processes .",
    "the semi - stochastic adaptation does not greatly alter the scaling further . ]     walkers .",
    "solid lines show results at @xmath52 and dashed lines show @xmath53 . at @xmath52 scaling",
    "is very poor due the extremely large number of walkers on the hartree  fock state .",
    "the scaling is improved slightly with the use of semi - stochastic , as far fewer spawnings from the hartree ",
    "fock state survive .",
    "if all connections to the hartree  fock are included in the deterministic space then stochastic spawning from the hartree  fock does not need to be performed . with this change the load balancing is greatly improved . at @xmath53",
    "the scaling is much better , and little difference is made by the semi - stochastic adaptation . ]",
    "we first present efficiency increases for the standard hartree ",
    "fock - based projected energy estimator : @xmath55 where @xmath56 is the hartree ",
    "fock state and @xmath57 is wave function represented by the fciqmc walkers .",
    "the efficiency measure that we consider is the same one used by petruzielo _ _",
    "et al.__@xcite , @xmath58 where @xmath59 is the total simulation time ( excluding initialization time@xcite ) and @xmath60 is the final energy error estimate , obtained by averaging multiple estimates taken from throughout the simulation .",
    "this is a sensible efficiency measure because the error of such an average can be estimated via @xmath61 where @xmath62 is the number of _ uncorrelated _ estimates contributing to a mean estimate ( possibly taken from a blocking analysis@xcite ) , and @xmath63 is the true standard deviation of the distribution from which each estimate is taken , which is constant at equilibrium .",
    "@xmath62 scales linearly with @xmath59 , and therefore this efficiency measure is appropriate .",
    "caution should be taken in interpreting the relative efficiency of two simulations , however .",
    "an increase of efficiency of @xmath64 with semi - stochastic does not necessarily mean that a particular value of @xmath65 can always be obtained with @xmath64 times less simulation time by using the semi - stochastic adaptation .",
    "for the efficiency results presented here , all error estimates are calculated through a blocking analysis@xcite in order to take account of the serially correlated nature of the fciqmc wave function between subsequent iterations .",
    "such an analysis typically requires a large number of iterations ( depending on the system and time step used ) in order to obtain an accurate error estimate . because using semi - stochastic does not seem to reduce the auto - correlation time",
    ", a similar number of iterations must be performed .",
    "thus after a sufficient number of iterations , the error obtained even without the use of the semi - stochastic adaptation may be suitably small . in such cases ,",
    "the overhead of performing the deterministic projection is not particularly advantageous . in most cases ,",
    "however , more than a small number of independent blocks of data are required , and so using the semi - stochastic approach is highly beneficial .",
    "we present results for a variety of systems to demonstrate the general applicability of semi - stochastic and our method for generating the deterministic space .",
    "all calculations were performed with @xmath51 walkers unless stated otherwise , and the deterministic space was generated using the new scheme outlined in section iii .",
    "the relative efficiencies presented are relative to otherwise identical simulations that do not use the semi - stochastic adaptation ( but _ do _ use non - integer coefficients , with the same value of spawning cutoff , @xmath35 ) .",
    "all calculations for each system were performed on the same machine and number of cpu cores ( between 24 and 96 ) .",
    "simulations were typically performed for between @xmath66 and @xmath51 iterations .    in each case",
    "the time step was set just small enough to avoid the possibility of bloom events , where more walkers than the initiator threshold are created from one spawning attempt .",
    "such events are undesirable because they instantly become initiators , increasing the associated initiator error as a consequence .",
    "figure  [ fig : hub_hf ] shows the efficiency of semi - stochastic fciqmc for the 18-site 2d hubbard model at a variety of coupling strengths , from @xmath67 to @xmath68 , and for deterministic space sizes ranging from @xmath69 to @xmath66 . significant increases in efficiency are observed in all cases , with the most significant gains occurring at small @xmath70 .",
    "this is expected : at small coupling strengths the wave function is dominated by a small number of significant determinants which are treated exactly by the deterministic space , whereas at large @xmath70 the equivalent deterministic space will be significantly less occupied .    )",
    "of semi - stochastic simulations relative to otherwise identical simulations without semi - stochastic , for an 18-site hubbard model . for small @xmath70 values , where the wave function is dominated by a small number of basis states , the semi - stochastic adaptation helps greatly , leading to an efficiency increase of over @xmath71 at @xmath70=0.25 and @xmath72 . for larger @xmath70 values",
    "the benefit becomes less significant . ]",
    "table  [ tab : hf_efficiency ] contains results for two molecular systems , n@xmath73 in a cc - pvdz basis ( with 4 core electrons uncorrelated ) and be@xmath73 in a cc - pcvtz basis , at equilibrium and stretched geometries .",
    "once again significant improvements are observed , even at stretched geometries where the wave function is more multi - reference .",
    ".the efficiency ( @xmath74 ) of semi - stochastic simulations relative to an otherwise identical simulation without semi - stochastic .",
    "results are shown for n@xmath73 in a cc - pvdz basis with 4 core electrons uncorrelated , at equilibrium ( 2.118a@xmath75 ) and stretched ( 10.4@xmath76 ) geometries , and also for be@xmath73 in a cc - pcvtz basis at equilibrium and two stretched geometries .",
    "a significant increase in efficiency is found for all geometries , and a monotonic improvement with @xmath39 is always observed .",
    "[ cols=\"^,^,^,^,^,^ \" , ]     two separate quantities are considered to study the quality of these rdm estimates .",
    "the first is the variational energy estimate @xmath77 where @xmath78 is the 1-rdm .",
    "this should be an important quantity in fciqmc because it is variational , whereas the energy obtained in @xmath79-fciqmc from equation  ( [ eq : hf_estimator ] ) is not .",
    "the second quantity considered is the expectation value of @xmath80 , which for spin-@xmath81 particles can be calculated as @xmath82 + \\frac{3}{4 } n,\\end{gathered}\\ ] ] where @xmath62 is the number of particles and @xmath83 and @xmath84 are spatial orbital labels .    in figure",
    "[ fig : hub_rdm ] the relative efficiency is shown for the same hubbard systems used in figure  [ fig : hub_hf ] , but using the estimates of @xmath85 from the 2-rdm .",
    "results from these two figures used the same parameters but were taken from different simulations .",
    "rdm estimates were calculated every @xmath86 iterations and a blocking analysis was performed . once again",
    ", substantial improvements are found , with an efficiency increase of over @xmath51 observed for @xmath67 .",
    "some remarkably accurate results are obtained .",
    "it is known that the exact value of @xmath87 should be @xmath88 for the ground state of this system . for @xmath67 ,",
    "estimates of @xmath87 change from @xmath89 for the fully stochastic formulation , to @xmath90 for @xmath91 .",
    "table  [ tab : rdm_efficiency ] shows relative efficiencies for molecular systems , for both the variational energy and spin estimators . once again",
    ", significant improvements are seen in all cases , and there is always an improvement with increasing @xmath39 for the range of deterministic space sizes considered here .",
    "this suggests using a large deterministic space is sensible , although this has to be weighed against increasing memory requirements .      as a further demonstration of the benefits of semi - stochastic",
    ", we consider the calculation of an explicitly correlated correction to the basis set incompleteness error in be@xmath73 . the explicitly correlated ` f12 ' approach",
    "was first proposed in 1985@xcite , and has since been refined@xcite to become a standard tool to accelerate basis set convergence in quantum chemistry@xcite .",
    "the aim of this approach is to complement the traditional wave function expansion ( in slater determinants ) by a small set of functions which have an explicit dependence on the inter - electronic distance .",
    "these ` geminal ' functions are crucial for an accurate description of the electronic cusps .    in this work ,",
    "rather than optimizing the sampled wave function in the presence of the explicitly correlated geminal functions , they are instead coupled after the fciqmc calculation via an internally contracted multireference perturbative approach ( @xmath92_{r12}$ ] ) .",
    "this method was first proposed by torheyden _",
    "et al_.@xcite and first applied to fciqmc in ref .",
    "this approach allows the calculation of the correction through the sampled one and two - body density matrices ( after some rank - reducing approximations ) . the quality of these corrections will provide a further demonstration of the accuracy of fciqmc reduced density matrices when using the semi - stochastic approach",
    "it should be noted that in previous applications of this method to fciqmc , the results were without the semi - stochastic adaptation and approximated the rdms without the use of a replica sampling ( in a biased fashion)@xcite .",
    "an alternative explicitly correlated approach , where the hamiltonian is ` transcorrelated ' via an approximate many - body canonical transformation@xcite has also been used within the fciqmc framework.@xcite while it is still unclear which is the optimal strategy within fciqmc , in this work we focus on the _ a posteriori _ approach , in order to demonstrate the accuracy of the sampled rdms with the semi - stochastic adaptation .",
    "be@xmath73 is a very weakly bound molecule which has resulted in extensive study within the literature , both in theoretical and experimental investigations@xcite .",
    "the small binding energy is a stern test for fciqmc , as it requires careful control over stochastic errors on the order of @xmath93 for reliable results .",
    "these random errors limited the accuracy in the previous fciqmc study of ref .",
    "( ) , and as such we expect the improvement due to the semi - stochastic approach to be important .",
    "an all - electron semi - stochastic fciqmc calculation was performed within the cc - pcvdz - f12 basis set to calculate 2-rdm estimates . from these 2-rdm estimates ,",
    "@xmath92_{r12}$ ] corrections were calculated via the mpqc code@xcite .",
    "the binding in be@xmath73 is primarily due to dispersion interactions , and requires very high angular momentum atomic orbitals for an accurate description . as such",
    ", it is not to be expected that the cc - pcvdz - f12 basis set ( which only contains up to @xmath94 angular momentum orbitals ) will provide high quality results .",
    "rather , this system is used to demonstrate the very great accuracy with which @xmath92_{r12}$ ] corrections can be calculated when using the semi - stochastic approach .",
    "the fciqmc calculations used time - reversal symmetrized functions@xcite as basis states , as a compromise between slater determinants and full configuration state functions .",
    "the total space size was @xmath95 basis states .",
    "the deterministic space consisted of @xmath96 states , chosen using our scheme presented in section  [ sec : determ_space ] .",
    "@xmath97 repeats were performed for each geometry ( starting from different random number generator seeds ) to provide ( uncorrelated ) estimates with which to estimate error bars on the [ 2]@xmath98 corrections , and also on @xmath99 estimates .",
    "approximately @xmath100 walkers were used for each calculation .",
    "this was found to reduce initiator error to no greater than roughly @xmath101 at each bond length , with such accuracy being deemed necessary for this weakly - bound system .",
    "an optimal value of the single parameter in the f12 geminal ( the @xmath102 exponent ) was found by minimizing the @xmath92_{r12}$ ] correction at equilibrium geometry , yielding an optimized @xmath103 .    in figure",
    "[ fig : be2_r12 ] the @xmath92_{r12}$ ] contributions are shown .",
    "these values are plotted relative to the correction at infinite separation .",
    "this infinite separation value was calculated by using the exact fci 2-rdm for the be atom , and therefore has no stochastic or systematic error .",
    "it is therefore very encouraging that our fciqmc results converge to this value so accurately .",
    "error bars are not visible on the plot , all being less than @xmath104@xmath105 ( 0.5@xmath106 ) .",
    "this demonstrates that the semi - stochastic adaptation works well for these @xmath92_{r12}$ ] corrections , as for the rdm - based quantities already considered .    in figure",
    "[ fig : be2_combined ] the variational energy calculated from the 2-rdm estimates ( using eq .",
    "( [ eq : rdm_energy ] ) ) is shown , together with the total energy , including both @xmath99 and @xmath92_{r12}$ ] contributions .",
    "it is seen that the @xmath92_{r12}$ ] corrections greatly reduce the basis set incompleteness .",
    "however , for this system the cc - pcvdz - f12 basis , despite the addition of the explicitly correlated correction , is still not sufficient to obtain results compatible with the most accurate estimates@xcite of the well depth , which are around @xmath107@xmath105 .",
    "interestingly , the @xmath92_{r12}$ ] correction for this system is not as significant as for many previously - studied systems .",
    "it has been demonstrated that results of aug - cc - pvqz quality can sometimes be obtained within an aug - cc - pvdz basis@xcite .",
    "the small improvement here is perhaps explained by the f12 corrections being less effective at describing bonding via dispersion interactions .",
    "for the be atom , an accurate variational energy is @xmath108@xcite . by including both @xmath92_{r12}$ ] and @xmath92_s$ ] corrections ,",
    "the cc - pcvdz - f12 be energy goes from @xmath109 to @xmath110 ( with @xmath111 ) .",
    "thus , the accuracy of the atom energy is greatly improved , although interestingly it appears that the energy is below the complete basis set limit by @xmath112 ( possible due to this perturbative framework ) .",
    "the improvement to the be@xmath73 binding energy is less significant .",
    "we emphasize however , that relatively small improvement of @xmath92_{r12}$ ] in this case is not a result of using fciqmc .",
    "in particular , the semi - stochastic adaptation is found to perform extremely well , with all stochastic errors being less than @xmath113@xmath105 ( @xmath114 ) .    _ { r12}$ ] energies ( relative to the fci value at infinite separation ) for be@xmath73 in a cc - pcvdz - f12 basis set , with all electrons correlated and @xmath103 .",
    "error bars , which are each calculated from 5 independent estimates , are plotted but not visible .",
    "all error estimates are less than @xmath104@xmath105 ( @xmath115 ) .",
    "it is seen that the result at large bond lengths approaches the fci result with very great accuracy . ]     binding curve in a cc - pcvdz - f12 basis set , calculated by combining @xmath99 and @xmath92_{r12}$ ] contributions .",
    "all @xmath116 electrons are correlated and @xmath103 .",
    "the addition of the @xmath92_{r12}$ ] basis set incompleteness correction improves the energy estimate . however , the system is still under bound by around @xmath117@xmath105 compared to experimental values , suggesting that larger basis sets ( with high angular momentum functions ) are still required .",
    "the relatively small improvement of the @xmath92_{r12}$ ] correction for this system and basis set is not related to the use of fciqmc .",
    "error bars , which are each calculated from 5 independent estimates , are plotted but not visible .",
    "all errors estimates are less than @xmath113@xmath105 ( @xmath114 ) . ]",
    "we have performed a detailed study of the semi - stochastic adaptation to fciqmc and presented a new method for generating the deterministic space .",
    "this approach creates the space naturally from the dominant states in the fciqmc wave function and avoids having to perform multiple large and time - consuming deterministic ground - state calculations . using this approach",
    "greatly improves the stochastic efficiency of calculations for a large range of systems and parameters .",
    "we also demonstrated that a simpler approach to the initiator approximation in semi - stochastic fciqmc gives the same benefits as the approach previously suggested by petruzielo _ _ et al__@xcite .",
    "we have also explained how the semi - stochastic adaptation can be implemented with relative ease in an existing parallel fciqmc code .",
    "it has been shown that the parallel scaling is not significantly worsened for a range of numbers of cpu cores .",
    "rather , for systems where parallel efficiency is particularly poor , it has been shown that deterministic approaches can significantly improve the parallel performance and speed up fciqmc calculations .",
    "this is a significant result and deserves further investigation .",
    "the benefit of the semi - stochastic approach was demonstrated for fciqmc estimates of the 2-rdm .",
    "this is significant as we expect this object to be important in future applications of fciqmc , as it can be used for calculating non - trivial two body operators , variational energy estimates and f12 basis set incompleteness corrections .",
    "we observed improvements in efficiency to factors in excess of 1 million .",
    "as a concrete demonstration , these improvements were applied to the calculation of f12 corrections for be@xmath73 .",
    "we therefore suggest that using the semi - stochastic adaptation should become standard practice when performing fciqmc calculations .",
    "we thank c. j. umrigar for helpful comments on the original manuscript .",
    "we also thank d. p. tew for helpful discussions .",
    "n.s.b . gratefully acknowledges trinity college , cambridge for funding .",
    "j.s.s . acknowledges the research environment provided by the thomas young centre under grant no .",
    "g.h.b . gratefully acknowledges the royal society for a university research fellowship . this work has been supported by the epsrc under grant no .",
    "ep / j003867/1 .",
    "48ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop link:\\doibase 10.1007/bf00527669 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase",
    "10.1063/1.459921 [ * * , ( ) ] link:\\doibase 10.1063/1.1461814 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.1757439 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3664729 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we expand upon the recent semi - stochastic adaptation to full configuration interaction quantum monte carlo ( fciqmc ) . </S>",
    "<S> we present an alternate method for generating the deterministic space without _ a priori _ knowledge of the wave function and present stochastic efficiencies for a variety of both molecular and lattice systems . </S>",
    "<S> the algorithmic details of an efficient semi - stochastic implementation are presented , with particular consideration given to the effect that the adaptation has on parallel performance in fciqmc . </S>",
    "<S> we further demonstrate the benefit for calculation of reduced density matrices in fciqmc through replica sampling , where the semi - stochastic adaptation seems to have even larger efficiency gains . </S>",
    "<S> we then combine these ideas to produce explicitly correlated corrected fciqmc energies for the beryllium dimer , for which stochastic errors on the order of wavenumber accuracy are achievable . </S>"
  ]
}