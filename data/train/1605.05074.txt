{
  "article_text": [
    "let a sequence @xmath13 of natural numbers be given . by an _ @xmath14-edge - colouring _ ( or _",
    "colouring _ for brevity ) of a graph @xmath15 we mean a function @xmath16 $ ] , where we denote @xmath17:=\\{1,\\dots , s\\}$ ] .",
    "note that we do not require colourings to be proper , that is , adjacent edges can have the same colour .",
    "a colouring @xmath18 of @xmath1 is called @xmath9-_valid _ if , for every @xmath19 $ ] , the colour-@xmath5 subgraph @xmath20 contains no copy of @xmath21 , the complete graph of order @xmath6 .",
    "write @xmath22 for the number of @xmath9-valid colourings of @xmath1 .    in this paper",
    ", we investigate @xmath7 , the maximum of @xmath2 over all graphs @xmath1 on @xmath8 vertices , and the _ @xmath9-extremal _ graphs , i.e.  order-@xmath8 graphs which attain this maximum .",
    "we assume throughout the paper that @xmath23 and that @xmath24 for all @xmath25 $ ] ( since @xmath26 just forbids colour @xmath5 and the problem reduces to one with @xmath27 colours ) .      the problem , namely the case when @xmath28 , was first considered by erds and rothschild in 1974 ( see  @xcite ) . clearly , any colouring of a @xmath29-free graph is @xmath9-valid . by turn s theorem  @xcite ,",
    "the maximum such graph on @xmath8 vertices is @xmath30 , the complete @xmath31-partite graph with parts as equal as possible .",
    "this implies the trivial lower bound @xmath32 where @xmath33 is the number of edges in @xmath30 .",
    "in particular , erds and rothschild conjectured that , when @xmath34 and @xmath8 is sufficiently large , the trivial lower bound  ( [ trivial ] ) is in fact tight and , furthermore , @xmath35 is the unique @xmath9-extremal graph .",
    "the conjecture was verified for all @xmath36 by yuster  @xcite ( who also computed @xmath37 for smaller @xmath8 ) .",
    "yuster generalised the conjecture to @xmath38 and proved an asymptotic version .",
    "the full conjecture for all @xmath39 was proved by alon , balogh , keevash and sudakov  @xcite who further showed that an analogous result holds for three colours :    [ alonetal ] let @xmath40 where @xmath39 and @xmath41 .",
    "then @xmath42 moreover , @xmath30 is the unique extremal graph in both cases.@xmath43    the proof of theorem  [ alonetal ] uses szemerdi s regularity lemma .",
    "unfortunately , this also means that the graphs to which it applies are very large indeed .",
    "in fact , the assertions are not true for all numbers @xmath8 of vertices .",
    "as was remarked in  @xcite , the conclusion of theorem  [ alonetal ] fails when @xmath44 , as in this case a random colouring of the edges of @xmath45 with @xmath14 colours contains no monochromatic @xmath46 with probability more than @xmath47 .",
    "thus , for this range of @xmath8 , we have @xmath48 .    the authors of  @xcite noted that when more than three colours are used , the behaviour of @xmath49 changes , making its determination both harder and more interesting .",
    "namely , it was shown in  @xcite that if @xmath50 ( and @xmath39 ) then @xmath49 is exponentially larger than @xmath51 . in particular , any extremal graph has to contain many copies of @xmath46 . in the case when @xmath52 , they determined @xmath53 asymptotically by showing that @xmath54 , where @xmath55 achieves the right exponent .",
    "similarly , they proved that @xmath56 , where @xmath57 achieves the right exponent . determining the exact answer in these two cases , the first and third author of this paper proved that",
    ", when @xmath58 , @xmath55 is the unique @xmath59-extremal graph on @xmath8 vertices , and @xmath57 is the unique @xmath60-extremal graph on @xmath8 vertices .",
    "it was also proved in  ( * ? ? ?",
    "* proposition  5.1 ) that the limit @xmath61 exists ( and is positive ) when @xmath62 .",
    "as it is easy to see , the proof from  @xcite extends to an arbitrary fixed sequence @xmath9 .",
    "erds and rothschild also considered the generalisation of the problem , where one forbids a monochromatic graph @xmath63 ( the same for each colour ) . in",
    "@xcite the authors showed that the analogue of theorem  [ alonetal ] holds when @xmath63 is _ colour - critical _ , that is , the removal of any edge from @xmath63 reduces its chromatic number .",
    "( note that every clique is colour - critical . ) in a further generalisation , balogh  @xcite considered edge - colourings which themselves do not contain a specific colouring of a fixed graph @xmath63 .",
    "other authors have addressed this question in the cases of forbidden monochromatic matchings , stars , paths , trees and some other graphs in  @xcite , matchings with a prescribed colour pattern in  @xcite , and rainbow stars in  @xcite . extending work in  @xcite , benevides , hoppen and sampaio",
    "considered forbidden cliques with a prescribed colour pattern , and using techniques similar to our own , obtained several results in this direction , including a version of theorem  [ zykov ] below . in  @xcite , a colouring version of the erds - ko - rado theorem for families of @xmath64-intersecting @xmath65-element subsets of an @xmath8-element set was considered ; that is , one counts the number of colourings of families of @xmath65-sets such that every colour class is @xmath64-intersecting .",
    "a so - called ` @xmath66-analogue ' was addressed in  @xcite , which considers a colouring version of the erds - ko - rado theorem in the context of vector spaces over a finite field @xmath67 .",
    "alon and yuster  @xcite studied a directed version of the problem , to determine the maximum number of @xmath68-free orientations of an @xmath8-vertex graph , where @xmath68 is a given @xmath69-vertex tournament .",
    "they showed that the answer is @xmath70 for @xmath71 .",
    "this in fact answers the original question of erds  @xcite , which he modified to ask about edge - colourings .",
    "the problem of counting @xmath63-free edge - colourings in hypergraphs was studied in  @xcite . in an asymptotic hypergraph version of theorem",
    "[ alonetal ] , lefmann , person and schacht  @xcite proved that , for every @xmath69-uniform hypergraph @xmath63 and @xmath72 , the maximum number of @xmath63-free @xmath14-edge - colourings over all @xmath69-uniform hypergraphs with @xmath8 vertices is @xmath73 , where the turn function @xmath74 is the maximum number of edges in an @xmath63-free @xmath69-uniform hypergraph on @xmath8 vertices .",
    "this is despite the fact that @xmath74 is known only for few @xmath63 .",
    "our first result states that it suffices to consider very special graphs @xmath1 in order to determine the value of @xmath7 :    [ zykov ] for every @xmath75 and @xmath76 , at least one of the @xmath9-extremal graphs of order @xmath8 is complete multipartite .",
    "our second result ( theorem  [ optred ] below ) writes the limit in   as the value of a certain optimisation problem .",
    "* problem  @xmath77 * : _ given a sequence @xmath78 of natural numbers and @xmath79 , determine @xmath80 the maximum value of @xmath81 over the set @xmath82 of _ feasible solutions _ , that is , triples @xmath83 such that _    * @xmath84 and @xmath85 , where @xmath86 is the _ ramsey number _ of @xmath87 ( i.e.  the minimum @xmath88 such that @xmath89 admits no @xmath87-valid @xmath14-edge - colouring ) ; * @xmath90 , where @xmath91 is the set of all functions @xmath92}{2 } \\rightarrow 2^{[s]}$ ] such that @xmath93}{2 } : c \\in \\phi(ij ) \\right\\rbrace\\ ] ] is @xmath21-free for every colour @xmath25 $ ] and @xmath94 for all @xmath95}{2}$ ] ; * @xmath96 , where @xmath97 is the set of all @xmath98 with @xmath99 for all @xmath100 $ ] , and @xmath101 .",
    "note that the maximum in   is attained .",
    "indeed , for each of the finitely many allowed pairs @xmath102 , the function @xmath103 is continuous and hence attains its maximum over the non - empty compact set @xmath97",
    ". a triple @xmath83 is called",
    "_ @xmath77-optimal _ if it attains the maximum , that is , @xmath104 and @xmath105 . as we will show later in lemma",
    "[ lm : qs ] , @xmath106 so we will denote this common value by @xmath107 . of course , if one wishes to determine the value of @xmath107 , then one should work with problem  @xmath108 as it has the smallest feasible set .",
    "since one of our results is stated in terms of @xmath109-optimal triples ( which may be a strict superset of @xmath108-optimal triples ) , we stated different versions of the optimisation problem . in section  [ conclusion ] , we explore how one might hope to solve this optimisation problem , and show that all previously obtained ( asymptotic ) results can be recovered .",
    "first we show that @xmath107 gives rise to an asymptotic lower bound on @xmath7 .",
    "[ lm : lowerbd ] for every @xmath110 and @xmath76 , there exists @xmath111 such that for all @xmath112 there is a graph @xmath1 on @xmath8 vertices with @xmath113 .",
    "let @xmath83 be @xmath114-optimal .",
    "for @xmath112 , let @xmath115 be the graph of order @xmath8 with vertex partition @xmath116 , where @xmath117 ; and in which for all @xmath118 $ ] and @xmath119 and @xmath120 , we have that @xmath121 is an edge of @xmath115 if and only if @xmath122 and @xmath123 .",
    "consider those colourings of @xmath115 in which @xmath121 is coloured with some colour in @xmath124 , for every @xmath119 , @xmath120 , where @xmath125 .",
    "every such colouring is @xmath9-valid because @xmath126 is @xmath21-free for all @xmath25 $ ] .",
    "the number of such colourings gives the desired lower bound for @xmath7 : @xmath127 where @xmath128 is a constant due to rounding .",
    "[ optred ] for every @xmath129 and @xmath76 , we have @xmath130 , that is , @xmath131 , where @xmath132 is the limit in  .",
    "so , as in the result of lefmann , person and schacht  @xcite mentioned above , this theorem can be proved without knowledge of @xmath107 .",
    "our proof of theorem  [ optred ] builds upon the techniques of  @xcite and also uses the regularity lemma",
    ".    the structure of an arbitrary order-@xmath8 graph @xmath1 with @xmath133 can be rather complicated ( see a short discussion in section  [ conclusion ] of the case @xmath134 ) .",
    "however , the next result states that if @xmath1 is assumed to be complete multipartite , then the part ratios have to be close to being @xmath109-optimal .",
    "[ th : partitestructure ] for every @xmath135 there are @xmath136 and @xmath137 such that if @xmath15 is a complete multipartite graph of order @xmath138 with ( non - empty ) parts @xmath139 and @xmath140 then there is a @xmath109-optimal triple @xmath141 such that the @xmath142-distance between @xmath143 and @xmath144 is at most @xmath145 : @xmath146 .    in a sense ,",
    "a converse to theorem  [ th : partitestructure ] holds . indeed , for every @xmath109-optimal triple @xmath147 , for all @xmath112 , the proof of lemma  [ lm : lowerbd ] gives a complete @xmath65-partite graph @xmath148 on @xmath8 vertices with parts @xmath149 such that , setting @xmath150 , we have , as @xmath151 , that @xmath152    the rest of the paper is organised as follows .",
    "theorem  [ zykov ] is proved in section  [ symsec ] .",
    "section  [ lemma ] contains a general lemma which is then used in section  [ optredproof ] to prove theorems  [ optred ] and  [ th : partitestructure ] .",
    "section  [ conclusion ] contains some concluding remarks .",
    "we will use the following notation . for",
    "a set @xmath153 and an integer @xmath154 , let @xmath155 denote the set of all @xmath69-subsets of @xmath153 .",
    "also , let @xmath156 be the set of all subsets of  @xmath153 . if it is clear from the context , we may write @xmath157 to denote the set @xmath158 or the ordered pair @xmath159 .",
    "in this section we prove theorem  [ zykov ] , which states that , for any instance of the problem ( i.e.  any choice of the parameters @xmath161 ) , there is a complete multipartite graph which is @xmath9-extremal .",
    "the proof uses the well - known symmetrisation method that was introduced by zykov  @xcite .",
    "_ proof of theorem  [ zykov ] .",
    "_ let @xmath15 be a @xmath9-extremal graph on @xmath8 vertices .",
    "consider distinct vertices @xmath162 with @xmath163 .",
    "let @xmath164 , where @xmath165 $ ] is the graph obtained from @xmath1 by removing every vertex of a set @xmath166 and every edge adjacent to a vertex of @xmath153 . for a graph @xmath63 , let @xmath167 denote the set of @xmath9-valid colourings of @xmath63 .",
    "( thus @xmath168 . )",
    "let @xmath169 and @xmath170 denote the number of @xmath9-valid extensions of @xmath171 to @xmath172 and @xmath173 respectively .",
    "since @xmath174 and each forbidden graph is a clique , we have that the number of @xmath9-valid extensions of @xmath18 to @xmath1 is @xmath175 .",
    "thus @xmath176 let @xmath177 be the graph obtained from @xmath1 by deleting @xmath178 and adding a new vertex @xmath179 which is a clone of @xmath180 in @xmath1 . define @xmath181 analogously . from ( [ zykov1 ] ) , it follows that @xmath182 since @xmath1 is @xmath9-extremal , we have that @xmath183 and hence we have equality everywhere",
    ". therefore @xmath177 and @xmath181 are both @xmath9-extremal . in order to finish the proof ,",
    "it is enough to show that we can reach a complete multipartite graph by starting with @xmath1 and iteratively performing the above operation .",
    "we say that two vertices @xmath184 and @xmath185 are _ twins _ ( and write @xmath186 ) if they have the same sets of neighbours .",
    "note that twins are necessarily non - adjacent .",
    "it is easy to see that @xmath187 is an equivalence relation .",
    "let @xmath188_{\\sim}$ ] denote the equivalence class of @xmath184 .",
    "let @xmath189 .",
    "repeat the following for as long as possible .",
    "suppose that we have defined graphs @xmath190 for some @xmath191 , which are all @xmath9-extremal .",
    "suppose that @xmath192 contains a pair @xmath193 of non - adjacent vertices which are not twins .",
    "choose such a pair so that @xmath194_\\sim|$ ] is maximal .",
    "let @xmath195 be the graph obtained from @xmath192 by deleting @xmath178 and adding a new vertex @xmath179 which is a clone of @xmath180 . as was argued above",
    ", @xmath196 is necessarily @xmath9-extremal .    for each @xmath191 ,",
    "call an equivalence class @xmath188_{\\sim}$ ] in the graph @xmath192 _ frozen _",
    "if @xmath192 is complete between @xmath188_{\\sim}$ ] and its complement , and _ unfrozen _ otherwise .",
    "let @xmath197 be the sum of sizes of all frozen classes plus the largest size of an unfrozen one .",
    "it is easy to see that @xmath197 is strictly increasing with @xmath198 .",
    "since @xmath197 is bounded above by @xmath8 , the process terminates in at most @xmath199 steps with some @xmath9-extremal graph @xmath63 . since every pair of non - adjacent vertices in @xmath63 are twins , @xmath63 is complete multipartite , as desired .",
    "@xmath43    also , the symmetrisation can be applied to @xmath77-optimal solutions . in particular",
    ", one can prove the following .",
    "[ lm : qs ] for every @xmath9 , we have @xmath106 .    since trivially @xmath200 , we have @xmath201 .    on the other hand , among all @xmath114-optimal solutions @xmath83 ,",
    "fix one with @xmath65 as small as possible . then , in particular , we have that each @xmath202 is non - zero .",
    "we claim that necessarily @xmath203 ( which will give the required inequality @xmath204 ) .",
    "if this is not true , then @xmath205 for some @xmath206\\choose 2}$ ] , say for @xmath207 .",
    "for a real @xmath5 , consider @xmath208 defined by @xmath209 , @xmath210 and @xmath211 for all @xmath212 $ ] .",
    "in other words , we shift weight @xmath5 from @xmath213 to @xmath214 .",
    "since @xmath215 is a linear function @xmath216 of @xmath5 and @xmath217 when @xmath218 is at most @xmath219 , it must be the case that @xmath216 is a constant function .",
    "thus @xmath220 regardless of @xmath5 .",
    "in particular , by taking @xmath221 , that is , by shifting all weight from @xmath213 to @xmath214 , we obtain a @xmath114-optimal solution @xmath141 with @xmath222 , whose restriction to @xmath223 $ ] gives another @xmath114-optimal solution , contradicting the minimality of @xmath65 .",
    "the proofs of theorems  [ optred ] and  [ th : partitestructure ] will both follow from the next lemma , which states that the number of @xmath9-valid colourings of any complete @xmath65-partite graph @xmath63 can be bounded above by evaluating @xmath66 for a triple @xmath224 , where @xmath225 is given by the ratios of the parts of @xmath63 .",
    "[ mainlem ] for all @xmath110 , @xmath76 and @xmath226 , there exists @xmath227 such that for every complete multipartite graph @xmath63 of order @xmath228 with ( non - empty ) parts @xmath229 with at least one @xmath9-valid colouring , there is some @xmath230 such that @xmath231 where @xmath232 .    in outline ,",
    "the argument to prove lemma  [ mainlem ] is as follows .",
    "the main idea of the proof is to use szemerdi s regularity lemma to pass from a @xmath9-valid colouring @xmath18 of @xmath63 to a set of feasible solutions that come from @xmath65-tuples of clusters which are transversal with respect to the @xmath65-partition of  @xmath63 . for each obtained solution @xmath233 , an upper bound on @xmath234",
    "can be translated via regularity into an upper bound on the number of restrictions of possible colourings @xmath18 to the involved clusters ( an idea already used in  @xcite )",
    ". then we estimate @xmath235 by taking an appropriately weighted sum of logarithms of these bounds .",
    "it turns out that the dominant contribution is from those triples @xmath236 that belong to @xmath237 , and so the bound obtained for @xmath235 is in terms of the largest @xmath234 among such triples .",
    "we will need the following definitions related to szemerdi s regularity lemma .    given a graph @xmath1 and disjoint non - empty sets @xmath238",
    ", we define the _ edge density _ between @xmath239 and @xmath240 to be @xmath241)|}{|a|\\,|b|}.\\ ] ] given @xmath242 , the pair @xmath243 is called    * _ @xmath244-regular _ if for every @xmath245 and @xmath246 with @xmath247 and @xmath248 , we have that @xmath249 ; * _ @xmath250-regular _ if it is @xmath244-regular and has edge density at least @xmath251 .",
    "we call a partition @xmath252    * _ equitable _ if @xmath253 for all @xmath254 $ ] ; * _ @xmath244-regular _ if it is equitable , @xmath255 , and all but at most @xmath256 of the pairs @xmath257 with @xmath258 are @xmath244-regular .    our first tool states that an induced subgraph of a regular pair is still regular , provided both parts are not too small .",
    "[ badrefine ] let @xmath259 be such that @xmath260 .",
    "suppose that @xmath261 is a @xmath145-regular pair , and let @xmath262 and @xmath263 . if @xmath264 then the pair @xmath265 is @xmath244-regular .",
    "let @xmath266 and @xmath267 be such that @xmath268 and @xmath269 . then @xmath270 .",
    "since @xmath261 is @xmath145-regular , we have that @xmath271 note further that @xmath272 , so @xmath271 by the triangle inequality , @xmath271 this implies that @xmath265 is @xmath244-regular .",
    "we use the following multicolour version of szemerdi s regularity lemma  @xcite ( see  e.g theorem  1.18 in komls and simonovits  @xcite ) .",
    "[ multicol ] for every @xmath273 and @xmath110 , there exists @xmath274 such that for any graph @xmath1 on @xmath275 vertices and any @xmath14-edge - colouring @xmath276 $ ] , there is an ( equitable ) partition @xmath277 with @xmath278 , which is @xmath244-regular simultaneously with respect to all graphs @xmath279 , with @xmath25$].@xmath43    finally , we need the following bound .    [ continuity ]",
    "let @xmath280 and @xmath76 .",
    "let @xmath281 and @xmath282 .",
    "then @xmath283    we have that @xmath284}\\alpha_i\\sum_{j \\in [ r]\\setminus \\lbrace i \\rbrace}\\alpha_j\\log|\\phi(ij)| - \\sum_{i \\in [ r]}\\beta_i\\sum_{j \\in [ r]\\setminus \\lbrace i \\rbrace}\\beta_j\\log|\\phi(ij)| \\biggr|\\\\ & \\leq \\biggl| \\sum_{i \\in [ r]}(\\alpha_i-\\beta_i ) \\sum_{j \\in [ r]\\setminus \\lbrace i \\rbrace}\\alpha_j\\log|\\phi(ij)| \\biggr| + \\biggl| \\sum_{j \\in [ r]}(\\alpha_j-\\beta_j)\\sum_{i \\in [ r]\\setminus \\lbrace j \\rbrace}\\beta_i\\log|\\phi(ij)| \\biggr|\\\\ & \\leq 2\\log_2(s ) \\cdot \\|\\bm{\\alpha}-\\bm{\\beta}\\|_1.\\end{aligned}\\ ] ]      let @xmath226 ( assumed without loss of generality to be sufficiently small ) and choose an additional constant @xmath251 so that @xmath285 . by the ( standard ) embedding lemma ( see , for example ,  ( * ? ? ?",
    "* theorem  2.1 ) ) , there exist @xmath273 and @xmath286 such that the following holds for all @xmath25 $ ] : _ if @xmath1 is a graph with a partition @xmath287 such that @xmath288 for all @xmath289 $ ] and every pair @xmath290 for @xmath291 is @xmath250-regular , then @xmath292_.    we may assume that @xmath293 since whenever @xmath294 , we have that an @xmath295-regular pair is also an @xmath244-regular pair .",
    "let @xmath296 be the integer returned by lemma  [ multicol ] when applied with parameters @xmath297 and @xmath14 .",
    "choose @xmath227 and assume , without loss of generality , that @xmath298 .",
    "we have the hierarchy @xmath299 let @xmath228 be arbitrary .",
    "let @xmath63 be a complete multipartite graph on @xmath300 vertices with parts @xmath229 .",
    "we may assume that @xmath85 otherwise @xmath301 .",
    "let @xmath302 be a graph obtained from @xmath63 by removing all but one vertex from every part @xmath303 of size at most @xmath304 ( and all edges incident with the removed vertices ) .",
    "write @xmath305 and @xmath306 for all @xmath100 $ ] .",
    "then @xmath307 .",
    "so @xmath308 and so @xmath309 define @xmath310 and @xmath311 . then @xmath312 without loss of generality , there is some @xmath313 $ ] such that @xmath314 is a singleton for all @xmath315 $ ] , and @xmath316 for all @xmath317 .    for the rest of the proof , we will work with @xmath1 rather than @xmath63 .",
    "informally , the reason for passing to @xmath1 is the following .",
    "after applying the regularity lemma to @xmath63 with a valid colouring @xmath18 , we do not _ a priori _ have control on the distribution of coloured edges incident to small parts of @xmath63 .",
    "if the statement of lemma  [ mainlem ] asked for a @xmath281 , we could simply neglect these parts ; but since we require @xmath230 we can not do this .",
    "therefore we introduce @xmath1 in which each small part @xmath318 is replaced by a token vertex @xmath319 , which merely asserts the existence of its part .",
    "but for each @xmath320 , there are only constantly many possible values for @xmath321 \\rbrace$ ] for all @xmath14-edge - colourings @xmath18 .",
    "thus we can refine our regularity partition into parts according to these values .",
    "now we have good control between _ all _ pairs of parts : if both are large then regularity provides good control ; and if one of them is small it is necessarily a single vertex and @xmath18 is constant on all edges between the parts .",
    "let @xmath322 $ ] be a @xmath9-valid colouring of @xmath1 . by the choice of @xmath296 (",
    "that is , by lemma  [ multicol ] applied to @xmath1 and @xmath18 with parameters @xmath297 and @xmath14 ) , there is an ( equitable ) partition @xmath323 , with @xmath278 , which is @xmath297-regular simultaneously with respect to all graphs @xmath324 , @xmath25 $ ] .",
    "we will now take a common refinement of @xmath116 and @xmath325 which also takes into account attachments to @xmath326 .",
    "namely , for all @xmath327 $ ] , subdivide @xmath328 into at most @xmath329 parts as follows .",
    "put each vertex in @xmath330 into a separate part .",
    "now , for any vertices @xmath331 remaining in @xmath328 , put @xmath185 and @xmath332 in the same part if and only if there is some @xmath333 $ ] such that @xmath334 , and @xmath335 for all @xmath336 $ ] .",
    "thus we obtain a ( not necessarily equitable ) partition @xmath337 of @xmath318 for each @xmath100 $ ] , where @xmath338 .",
    "let @xmath339 be the collection of sets  @xmath340 .",
    "it is indexed by @xmath341\\mbox { and } j \\in [ m_i]\\,\\}.\\ ] ]    for a colour @xmath19 $ ] , let @xmath342 consist of all pairs of indices @xmath343 such that @xmath344 $ ] is @xmath250-regular , and at least one of the following holds : @xmath345 is a vertex of @xmath346 ; @xmath347 is a vertex of @xmath346 ; or @xmath348 .",
    "( so if , say , @xmath345 is a vertex of @xmath346 , then @xmath349 for some @xmath25 $ ] since @xmath350 $ ] is a monochromatic star under  @xmath18 . ) we define @xmath351 to be the union of @xmath344 $ ] over all pairs @xmath352 .",
    "let @xmath353 .",
    "thus @xmath354 consists of edges without endpoints in @xmath346 which are incident with a part of size less than @xmath355 ; and edges which come from coloured pairs that are not @xmath244-regular or have edge density less than  @xmath251 .",
    "the following claim , whose proof is fairly standard , shows that @xmath354 can not contain many edges .",
    "[ badpairs ] @xmath356 .",
    "call a part @xmath357 _ small _ if @xmath358 .",
    "let @xmath359 be the set of edges that have at least one vertex in a small part .",
    "since each @xmath360 is subdivided into at most @xmath361 new parts , the number of vertices in small parts is at most @xmath362 and , trivially , @xmath363    let @xmath364 consist of those edges of @xmath1 that lie inside some @xmath360 or belong to some colour-@xmath5 bipartite subgraph @xmath365 $ ] which is not @xmath297-regular . since @xmath366 is an @xmath297-regular ( equitable ) partition , we have @xmath367 which is by @xmath368 at most , say , @xmath369 .",
    "next , we bound the size of @xmath370 .",
    "let @xmath371 be any edge from this set . since each @xmath345 is an independent set in @xmath1 , we have @xmath372)$ ] for some distinct @xmath373 .",
    "let @xmath374 $ ] satisfy @xmath375 and @xmath376 . since @xmath377 , we have @xmath378 which is at least @xmath355 by our choice of constants .",
    "let @xmath379 be the colour of @xmath371 .",
    "since @xmath380 , we have that @xmath381 and @xmath365 $ ] is @xmath297-regular .",
    "thus proposition  [ badrefine ] implies that @xmath344 $ ] is @xmath244-regular . since @xmath382",
    ", it must be the case that @xmath344\\ni e$ ] has edge density less than @xmath251 .",
    "we conclude that @xmath370 has edge density at most @xmath383 between any pair @xmath384 .",
    "thus @xmath385 proving the claim .",
    "define @xmath386}$ ] by setting , for all @xmath387 , @xmath388 : \\{ig , jh\\}\\in p^c\\}. \\ ] ]    if neither @xmath345 nor @xmath347 is a vertex of @xmath346 but @xmath389 , then @xmath390 is empty .",
    "otherwise , @xmath390 consists of those @xmath5 for which @xmath344 $ ] is @xmath250-regular .",
    "also , let @xmath391 be the restriction of @xmath18 to @xmath354 .    for each @xmath9-valid colouring @xmath18 of @xmath1 ,",
    "fix one partition @xmath392 as above and then define the tuple @xmath393 accordingly .",
    "[ s5 ] the number of possible tuples @xmath393 is at most @xmath394 .",
    "clearly , there are at most @xmath395 possible partitions of @xmath396 in which , for all @xmath100 $ ] , every @xmath397 lies in one of at most @xmath398 parts .",
    "each such partition determines @xmath339 and @xmath399 uniquely ( since the partition @xmath400 is fixed throughout the whole proof ) .",
    "given @xmath339 and @xmath399 , the number of possible @xmath401 is at most @xmath402 . by claim  [ badpairs ] ,",
    "the number of ways to choose @xmath354 and colour these edges ( i.e. choose @xmath403 ) is , very roughly , at most @xmath404 the claim is proved by multiplying these three bounds .",
    "fix a tuple @xmath393 such that @xmath405 , where @xmath406 is the set of colourings @xmath18 which generate it .",
    "our next step is to provide an upper bound for @xmath407 . for every @xmath408",
    ", we have @xmath409 .",
    "also , by the definition of @xmath354 , every @xmath410 lies in some @xmath250-regular bipartite graph @xmath344 $ ] with @xmath25 $ ] and @xmath411 such that @xmath412 or at least one of @xmath413 is a vertex of @xmath346 .",
    "thus @xmath352 , that is , @xmath414 .",
    "therefore @xmath415}{2}}\\prod_{\\stackrel{gh \\in [ m_i]\\times [ m_j]}{\\phi(ig , jh ) \\neq \\emptyset}}|\\phi(ig , jh)|^{|u_{i , g}|\\,|u_{j , h}|}.\\ ] ] let us agree that @xmath416 . then @xmath417}{2}}\\sum_{gh \\in [ m_i]\\times[m_j]}|u_{i , g}|\\,|u_{j , h}| \\log_2|\\phi(ig , jh)|.\\ ] ]    let @xmath418\\times \\ldots \\times[m_r]$ ] .",
    "we use @xmath68 to index all ` transversal ' @xmath65-tuples of parts from @xmath419 , where we take one part from each of @xmath420 . for each @xmath421 in @xmath68 , define @xmath422}{2 } \\rightarrow 2^{[s]}$ ] by setting , for @xmath95}{2}$ ] , @xmath423 recall the definition of @xmath424 after  ( [ fchange ] ) .",
    "[ numtuple ] @xmath425 , where @xmath426    we will first show that , for every @xmath19 $ ] and @xmath427 , the graph @xmath428 is @xmath21-free . indeed , suppose that @xmath429 span a copy of @xmath21 in @xmath428",
    ". first consider the case when @xmath430 is not a vertex of @xmath346 but @xmath431 .",
    "then , by the definition of @xmath401 , we have that @xmath432 is a vertex of @xmath346 for all @xmath433 .",
    "moreover , for every @xmath434}{2}$ ] , every edge in @xmath435 $ ] is coloured with @xmath5 by @xmath18 , a contradiction .",
    "so , without loss of generality , we may assume that there is some @xmath436 such that each of @xmath437 consists of a vertex of @xmath346 and @xmath438 for all @xmath439 .",
    "then , by the definition of @xmath339 , we have that @xmath440 for all @xmath441 $ ] with @xmath442 $ ] and @xmath443\\setminus \\lbrace p \\rbrace$ ] . by the definition of @xmath444 and the embedding lemma ( that is , our choice of parameters at the beginning of the proof ) , for all @xmath439 ,",
    "there is @xmath445 such that together these vertices @xmath446 span a copy of @xmath447 in @xmath20 .",
    "then @xmath20 spans a copy of @xmath21 , contradicting the @xmath9-validity of  @xmath18 .",
    "this and the trivial bound @xmath85 imply that @xmath448",
    ". therefore , for each @xmath427 , we have that @xmath449 , and so @xmath450}{2}}\\alpha_i\\alpha_j\\log_2|\\phi(it_i , jt_j)| \\leq b(\\bm{t}),\\ ] ] where we define @xmath451 ( i.e.  if @xmath452 we take a ( somewhat arbitrary ) trivial bound for @xmath453 ) .",
    "the claim will follow from taking a weighted average of  ( [ jeq ] ) by multiplying by @xmath454}|u_{\\ell , t_\\ell}|$ ] and summing over all @xmath427 .",
    "first consider the right hand side of ( [ jeq ] ) .",
    "let @xmath455 be the set of @xmath427 such that @xmath456 for some @xmath457}{2}$ ] .",
    "we will show that the sum of @xmath454}|u_{\\ell , t_\\ell}|$ ] over all @xmath458 is not much less than the sum taken over the whole of @xmath68 .    to this end , fix a pair @xmath411 such that @xmath459 .",
    "if at least one edge @xmath371 in @xmath350 $ ] is not in @xmath354 , then there is some @xmath25 $ ] such that @xmath460",
    ". then @xmath349 and so @xmath461 is non - empty , a contradiction .",
    "therefore @xmath462 ) \\subseteq e_0 $ ] . furthermore , by our definition of @xmath401",
    ", we have that @xmath463 .",
    "observe that , if one sums only over those @xmath427 that contain @xmath464 , then one gets @xmath465}|u_{\\ell , t_\\ell}| = |u_{i , g}||u_{j , h}| \\prod_{\\ell \\in",
    "[ r]\\setminus \\lbrace i , j\\rbrace}|x_\\ell| \\leq \\frac{|u_{i , g}||u_{j , h}|}{\\eta^4 n^2 } \\prod_{\\ell \\in [ r]}|x_\\ell|.\\ ] ] then , using the upper bound on @xmath466 from claim  [ badpairs ] , we have that @xmath467}|u_{\\ell , t_\\ell}| & \\leq \\sum_{\\stackrel{\\lbrace ig , jh \\rbrace \\in \\binom{i}{2}:}{e(g[u_{i , g},u_{j , h } ] ) \\subseteq e_0 } } \\sum_{\\stackrel{\\bm{t } \\in t:}{t_i = g , t_j = h}}\\prod_{\\ell \\in [ r]}|u_{\\ell , t_\\ell}| \\leq \\frac{|e_0|}{\\eta^4 n^2 } \\prod_{\\ell \\in [ r]}|x_\\ell|\\\\ & \\leq \\frac{s\\gamma}{\\eta^4 } \\prod_{\\ell \\in [ r]}|x_\\ell|.\\end{aligned}\\ ] ] we can now give an upper bound for the weighted average of the right hand of ( [ jeq ] ) as follows : @xmath468}|u_{\\ell , t_\\ell}| b(\\bm{t } ) & \\leq \\frac{q^*}{2 } \\sum_{\\bm{t } \\in t } \\prod_{\\ell \\in [ r]}|u_{\\ell , t_\\ell}|+ \\frac{r^2\\log_2 s}{2 } \\sum_{\\bm{t } \\in t_0}\\prod_{\\ell \\in [ r]}|u_{\\ell , t_\\ell}|\\\\   & \\stackrel{(\\ref{t0})}{\\leq }   \\prod_{\\ell \\in [ r]}|x_\\ell| \\left ( \\frac{q^*}{2 } + \\frac{r^2 s\\gamma \\log_2 s}{2\\eta^4 } \\right ) \\leq \\prod_{\\ell \\in [ r]}|x_\\ell| \\frac{q^ * + \\sqrt{\\gamma}}{2}.\\end{aligned}\\ ] ] using this bound together with a weighted average of the left hand side of  ( [ jeq ] ) , we have that @xmath469}|x_\\ell|\\\\ & \\geq \\sum_{\\bm{t } \\in t }       \\sum_{ij \\in \\binom{[r]}{2}}\\alpha_i\\alpha_j\\log_2|\\phi(it_i , jt_j)|     \\prod_{\\ell \\in [ r]}|u_{\\ell , t_\\ell}|      \\\\ & = \\sum_{ij \\in \\binom{[r]}{2}}\\alpha_i\\alpha_j   \\sum_{gh \\in [ m_i]\\times[m_j]}|u_{i , g}|\\,|u_{j , h}|\\log_2|\\phi(ig , jh)|     \\sum_{\\bm{t } \\in t : \\atop t_i = g , t_j = h}\\ \\prod_{\\ell \\in [ r]\\setminus\\{i , j\\}}|u_{\\ell , t_\\ell}|   \\\\ & = \\sum_{ij \\in \\binom{[r]}{2 } } \\frac{|x_i|}{n } \\cdot \\frac{|x_{j}|}{n }    \\sum_{gh \\in [ m_i]\\times[m_j]}|u_{i , g}|\\,|u_{j , h}|\\log_2|\\phi(ig , jh)|      \\prod _ { \\ell \\in [ r]\\setminus \\lbrace i , j\\rbrace}|x_\\ell|    \\\\ & \\stackrel{\\mathclap{(\\ref{s6})}}{\\geq } \\frac{1}{n^2 }   \\log_2 |\\mathcal{c}| \\prod _ { \\ell \\in [ r]}|x_\\ell|,\\end{aligned}\\ ] ] proving claim  [ numtuple ] .",
    "let @xmath470 be such that @xmath471 .",
    "recall that @xmath472 . then @xmath473 and",
    "hence @xmath474 lies in @xmath237 . now claims  [ s5 ] and  [ numtuple ] and proposition  [ continuity ]",
    "imply that @xmath475 completing the proof of the lemma.@xmath43",
    "by lemma  [ lm : lowerbd ] , it suffices to show that for every @xmath226 , there exists @xmath227 such that @xmath476 for all @xmath58 . fix @xmath226 and obtain @xmath137 from lemma  [ mainlem ] .",
    "now let @xmath58 . by theorem  [ zykov ]",
    ", there exists a complete multipartite graph @xmath1 on @xmath8 vertices with @xmath10 .",
    "the required upper bound on @xmath477 follows immediately from lemma  [ mainlem].@xmath43      suppose that there is @xmath478 which contradicts the claim .",
    "we need the following claim , which uses a compactness argument to show that a triple in @xmath237 which is almost optimal is in fact ` close ' to a @xmath109-optimal triple .",
    "[ compact ] there exists @xmath226 such that for all @xmath479 with @xmath480 , there is a @xmath109-optimal triple @xmath147 such that @xmath481 .",
    "suppose this is not the case .",
    "then for all @xmath112 , there exists @xmath482 with @xmath483 but for all @xmath484 with @xmath485 , we have that @xmath486 is not @xmath109-optimal .",
    "consider the sequence @xmath487 .",
    "since @xmath97 is closed and bounded , the heine - borel theorem implies that it is compact .",
    "therefore there is some subsequence @xmath488 of @xmath489 which converges ( in any norm , since @xmath65 is finite ) .",
    "let @xmath490 .",
    "observe that @xmath491 , so @xmath492 .",
    "having fixed @xmath493 , observe that @xmath494}{2}}\\lambda_i\\lambda_j\\log|\\phi(ij)|$ ] is a continuous function of @xmath495 .",
    "therefore @xmath496 together with  ( [ limitq ] ) , this implies that @xmath497 , and so @xmath498 is @xmath109-optimal .",
    "now , since @xmath499 , we can choose @xmath500 such that @xmath501 .",
    "this contradicts our assumption and hence proves the claim .",
    "choose @xmath502 as in the claim .",
    "obtain @xmath227 by applying lemma  [ mainlem ] with @xmath502 . since we supposed that @xmath478 contradicts the statement of theorem  [ th : partitestructure ]",
    ", there exists a complete multipartite graph @xmath1 on @xmath58 vertices such that @xmath503 and @xmath1 is a counterexample to the statement .",
    "let @xmath504 be the parts of @xmath1 and define @xmath505 .",
    "then , for all @xmath109-optimal triples @xmath147 , we have that @xmath506 .",
    "lemma  [ mainlem ] and our assumption on @xmath1 imply that there exists @xmath230 such that @xmath507 claim  [ compact ] immediately gives a contradiction , completing the proof of the theorem  [ th : partitestructure].@xmath43",
    "the referee of this paper asked if the cases where @xmath132 was determined in  @xcite can be done using our optimisation problem .",
    "while the answer is in the affirmative , some claims from  @xcite are more conveniently derived by working with graphs rather than feasible solutions .",
    "for example , following  @xcite let us show that @xmath508 } \\ell d_\\ell \\leq s\\left(1-\\frac{1}{k-1}\\right),\\ ] ] where @xmath509 has length  @xmath14 , @xmath510 is an arbitrary feasible solution , and we define @xmath511}{2}}{|\\phi(ij)|=\\ell}}\\alpha_i\\alpha_j,\\quad \\mbox{for $ \\ell\\in [ s]$}.\\ ] ] the shortest way is probably to consider the graph @xmath115 from the proof of lemma  [ lm : lowerbd ] . for @xmath19 $ ] ,",
    "let @xmath512 be the subgraph of @xmath115 spanned by pairs of parts @xmath513 such that @xmath514 .",
    "then @xmath512 is @xmath46-free for all colours @xmath25 $ ] and so turn s theorem implies that @xmath515 .",
    "thus we have that , as @xmath516 , @xmath517 } \\ell d_\\ell = 2\\sum_{c \\in [ s]}\\sum_{\\stackrel{ij \\in \\binom{[r]}{2}}{c\\in\\phi(ij)}}\\alpha_i\\alpha_j = 2\\sum_{c \\in [ s]}\\frac{e(h_c)+o(n)}{n^2 } \\leq s\\left(1-\\frac{1}{k-1}\\right)+o(1),\\ ] ] which gives the claimed inequality  .",
    "interestingly ,   and the trivial constraints @xmath518 for @xmath519 $ ] imply the sharp upper bound on @xmath520 when @xmath521 and when @xmath522 .",
    "( if @xmath523 , then an additional constraint , analogous to  , suffices to determine @xmath107 , see  @xcite . )    unfortunately , the problem of ( numerically ) solving problem  @xmath108 seems rather difficult even for moderately small @xmath9 .",
    "if we have a candidate pair @xmath102 , then the lagrange multiplier method gives a linear program which either returns a best possible @xmath424 for this @xmath102 in the interior of @xmath97 , or implies that there is an optimal solution on the boundary so we can reduce @xmath65 by one .",
    "this calculation can be efficiently implemented .",
    "however , the number of possible pairs @xmath102 becomes large very quickly . here",
    ", the quest of replacing the crude bound @xmath524 by a better one leads to the following ramsey - type question .",
    "namely , @xmath65 can be bounded by @xmath525 , where we define @xmath526 to be the smallest @xmath65 such that for every choice of a _ list - colouring _",
    "@xmath527\\choose 2}\\to { [ s]\\choose 2}$ ]",
    "there is @xmath19 $ ] with @xmath126 containing a @xmath6-clique .",
    "clearly , the definition would not change if we restrict ourselves to lists of size at least @xmath528 , so we can assume @xmath529 in the statement of problem  @xmath108 .",
    "the problem of estimating @xmath526 runs into similar difficulties as those for the classical version @xmath86 .",
    "it is a special case of a parameter studied in  @xcite , and seems to grow fast .",
    "for example , in  @xcite it was shown that @xmath530 , which is already too large for a nave enumeration of feasible @xmath401 by computer .",
    "as we mentioned , the existence of the limit in   can be shown by an easy modification of the proof for the case @xmath531 in  @xcite .",
    "in fact , there are two different proofs .",
    "the one that appears in the published version of  @xcite was suggested by an anonymous referee and uses an entropy inequality of shearer to show that @xmath532 is a non - increasing function of  @xmath8 .    the other proof , which was the original argument by alon et al  @xcite , is similar to our proof of theorem  [ optred ] . in our language ,",
    "it can be sketched as follows .",
    "fix a large @xmath300 such that @xmath533 is close to the limit superior of  .",
    "take an @xmath244-regular partition @xmath534 of an arbitrary @xmath9-extremal order-@xmath300 graph @xmath1 with a ` typical ' colouring @xmath18 .",
    "let @xmath124 be the set of those colours @xmath535 $ ] for which @xmath536 $ ] is an @xmath250-regular pair .",
    "as in lemma  [ lm : lowerbd ] , use this function @xmath537\\choose 2}\\to 2^{[s]}$ ] with the uniform vector @xmath538 to produce graphs of order @xmath539 with at least @xmath540 valid colourings . since @xmath541 can be made arbitrarily close to the limit superior of   by choosing small @xmath542 , the limit in   exists .",
    "the latter proof can be adopted to prove  theorem  [ optred ] ( by applying symmetrisation to reduce the triple @xmath543 to one with fewer than @xmath86 parts ) . however , our proof ( where the regularity lemma is applied after the symmetrisation ) has the advantages of giving some explicit ( although rather bad ) bound on the rate of convergence in   and implying theorem  [ th : partitestructure ] as well .    despite theorem",
    "[ th : partitestructure ] , there may be order-@xmath8 graphs @xmath1 with @xmath133 which are very far in edit distance from being complete multipartite . for example , if @xmath134 , then one can take for @xmath1 an equitable complete bipartite graph with parts @xmath544 and add any triangle - free graph into @xmath239 ( e.g.  a blow - up of a pentagon which is far from being complete partite ) . here , we can colour edges between @xmath239 and @xmath240 arbitrarily provided all edges inside @xmath239 have colour @xmath545 . thus @xmath546 , while @xmath547 is easily seen to be equal to @xmath47 .",
    "interestingly , our follow - up results ( in preparation ) show that all @xmath548-extremal graphs of sufficiently large order @xmath8 happen to be in fact 3-partite .",
    "for example , if @xmath549 is odd ( and large ) , then the unique extremal graph is @xmath550 . in order to illustrate how a small part can increase the number of colourings ,",
    "let us show that @xmath551 that is , the number of @xmath548-valid colourings of @xmath552 is by factor @xmath553 larger than that for the turn graph @xmath554 . if @xmath63 has parts @xmath555 with @xmath556 , then @xmath63 has @xmath557 colourings where @xmath558 $ ] is coloured arbitrarily while all edges between @xmath559 and @xmath560 have colour @xmath545 .",
    "similarly we have @xmath557 colourings where @xmath560 is ` bundled ' with @xmath561 ( and all edges between @xmath561 and @xmath560 get colour @xmath545 ) . all colourings that appear",
    "twice are exactly those that assign colour 1 to all edges incident to @xmath560 , so there are @xmath562 of them , giving  .",
    "the above example shows that one can have parts of size @xmath563 in theorem  [ th : partitestructure ] even for @xmath9-extremal graphs .",
    "( these parts will correspond to zero entries of @xmath424 in the limit . )",
    "nonetheless , we conjecture that theorem  [ zykov ] captures all extremal graphs :      in a future paper , we hope to provide a sufficient condition for this to be true for all @xmath564 and apply the developed theory to solving the problem for new values of  @xmath9 .",
    "we note that , in the different setting of forbidden cliques with prescribed colour patterns explored in  @xcite , the corresponding version of conjecture  [ cj : extr ] holds in some cases .",
    "erds , some new applications of probability methods to combinatorial analysis and graph theory , proceedings of the fifth southeastern conference on combinatorics , graph theory and computing , congress numerantium x ( 1974 ) , 3951 .",
    "j.  komls and m.  simonovits , ` szemerdi s regularity lemma and its applications to graph theory ' in _ combinatorics , paul erds is eighty _",
    ", d.  mikls , v.  t.  ss and t.  szni , eds . , vol .  2 , bolyai math .",
    "soc . , 1996 , pp ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a sequence of natural numbers . </S>",
    "<S> for a graph @xmath1 , let @xmath2 denote the number of colourings of the edges of @xmath1 with colours @xmath3 such that , for every @xmath4 , the edges of colour @xmath5 contain no clique of order @xmath6 . write @xmath7 to denote the maximum of @xmath2 over all graphs @xmath1 on @xmath8 vertices . </S>",
    "<S> this problem was first considered by erds and rothschild in 1974 , but it has been solved only for a very small number of non - trivial cases . we prove that , for every @xmath9 and @xmath8 , there is a complete multipartite graph @xmath1 on @xmath8 vertices with @xmath10 . also , for every @xmath9 we construct a finite optimisation problem whose maximum is equal to the limit of @xmath11 as @xmath8 tends to infinity . </S>",
    "<S> our final result is a stability theorem for complete multipartite graphs @xmath1 , describing the asymptotic structure of such @xmath1 with @xmath12 in terms of solutions to the optimisation problem .    </S>",
    "<S> # 1 = [ theorem]lemma [ theorem]corollary [ theorem]proposition [ theorem]conjecture [ theorem]definition [ theorem]claim [ theorem]problem    [ 1 ]    # 1    9999 </S>"
  ]
}