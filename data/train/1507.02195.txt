{
  "article_text": [
    "improved experimental techniques have made it possible to measure molecular fluctuations at a small scale , creating a need for a stochastic description of molecular data @xcite .",
    "typically , biochemical reaction networks are modelled as deterministic systems of ordinary differential equations ( odes ) , but these models assume the individual species are in high concentrations and do not allow for stochastic fluctuation .",
    "an alternative is stochastic models based on continuous - time markov chains @xcite . as an example of a stochastic reaction system ,",
    "consider @xmath1[\\kappa_2 ] } 2c,\\ ] ] where @xmath2 are positive reaction constants .",
    "the network consists of three chemical species @xmath3 , @xmath4 and @xmath5 and two reactions .",
    "each occurrence of a reaction modifies the species counts , for example , when the reaction @xmath6 takes places , the amount of @xmath3 and @xmath4 molecules are each decreased by one , while two molecules of @xmath5 are created .",
    "the species counts are modelled as a continuous - time markov chain , where the transitions are single occurrences of reactions with transition rates @xmath7 and @xmath8 are the species counts @xcite . when modelled deterministically , the concentrations ( rather than the counts ) of the species change according to an ode system .    in a classical paper @xcite ,",
    "kurtz explored the relationship between deterministic and stochastic reaction systems , using a scaling argument  large volume limit  to link the dynamical behaviour of the two types of systems to each other .",
    "other , mainly recent work , also points to close connections between the two types of systems @xcite . in this paper",
    "we explore this relationship further .",
    "a fundamental link between structural network properties and dynamical features of deterministic reaction networks has been known since the 1970s and 1980s with the work of horn , jackson and feinberg @xcite .",
    "specifically , their theory concerns the existence and uniqueness of equilibria in _ complex balanced _",
    "systems , with the ` deficiency zero theorem ' playing a central role in this context .",
    "complex balanced systems were called cyclic balanced systems by boltzmann .",
    "they have attractive analytical and physical properties ; for example a ( pseudo-)entropy might be defined which increases along all trajectories ( boltzmann s h - theorem ) @xcite .",
    "a parallel theory for the stochastic regime is not available , and the very concept of `` complex balanced '' does not currently have a stochastic counterpart . in this paper",
    "we develop a theory to fill this gap .",
    "we define _ stochastically complex balanced _",
    "systems through properties of the stationary distribution , and we prove results for stochastic reaction networks that are in direct correspondence with the results for deterministic models . in particular , we prove a parallel statement of the deficiency zero theorem and show that all deficiency zero reaction networks have product - form poisson - like stationary distributions , irrespectively whether they are complexed balanced or not .",
    "in fact , in the non - complexed balanced case , the network is complex balanced on the boundary of the state space .    a second target of our study concerns product - form stationary distributions .",
    "such distributions are computationally and analytically tractable and appear in many areas of applied probability , such as , queueing theory @xcite , petri net theory @xcite , and stochastic reaction network theory @xcite .",
    "specifically , a complex balanced mass - action network has a product - form poisson - like stationary distribution on every irreducible component @xcite . as an example , the stationary distribution of the complex balanced reaction system is @xmath9 where @xmath10 is an irreducible component of the state space @xmath11 and @xmath12 is a normalising constant .",
    "we expand the above result on mass - action systems and give general conditions under which the converse statement is true .",
    "in particular , we are interested in providing a structural characterisation of the networks with product - form poisson - like stationary distributions . however , this class of networks is strictly larger than that of complex balanced networks , and a full characterisation seems hard to achieve .",
    "we illustrate this with examples .",
    "we first introduce the necessary notation and background material ; see @xcite for general references .",
    "we assume standard knowledge about continuous - time markov chains .      we let @xmath13 , @xmath14 and @xmath15 be the real , the non - negative real and the positive real numbers , respectively .",
    "also let @xmath16 be the natural numbers including 0 .    for any real number @xmath17",
    ", @xmath18 denotes the absolute value of @xmath19 .",
    "moreover , for any vector @xmath20 , we let @xmath21 be the @xmath22th component of @xmath23 , @xmath24 the euclidean norm , and @xmath25 the infinity norm , that is , @xmath26 . for two vectors @xmath27 , we write @xmath28 ( resp.@xmath29 ) and @xmath30 ( resp.@xmath31 ) , if the inequality holds component - wise .",
    "further , we define @xmath32 to be one if @xmath30 , and zero otherwise , and similarly for the other inequalities . if @xmath33 then @xmath23 is said to be positive .",
    "finally , @xmath34 denotes the index set of the non - zero components . for example , if @xmath35 then @xmath36 .    if @xmath37 and @xmath38 , we define @xmath39 with the conventions that @xmath40 and @xmath41 .",
    "a reaction network is a triple @xmath42 , where @xmath43 is a set of @xmath44 species , @xmath45 is a set of @xmath46 complexes , and @xmath47 is a set of @xmath48 reactions , such that @xmath49 for all @xmath50 .",
    "the complexes are linear combinations of species on @xmath16 , identified as vectors in @xmath51 .",
    "a reaction @xmath52 is denoted by @xmath53 .",
    "we require that every species is part of at least one complex , and that every complex is part of at least one reaction . in this way",
    ", there are no `` superfluous '' species or complexes and @xmath54 is completely determined by the set of reactions @xmath55 , which we allow to be empty",
    ". in , there are @xmath56 species ( @xmath57 ) , @xmath58 complexes ( @xmath59 ) , and @xmath60 reactions .    given a reaction network @xmath54 ,",
    "the _ reaction graph _ of @xmath54 is the directed graph with node set @xmath45 and edge set @xmath55 .",
    "we let @xmath61 be the number of linkage classes ( connected components ) of the reaction graph .",
    "a reaction @xmath62 is _ terminal _ if any directed path that starts with @xmath53 is contained in a closed directed path .",
    "we let @xmath63 be the set of terminal reactions .",
    "a reaction network @xmath54 is _ weakly reversible _ , if every reaction is terminal .",
    "the network in is weakly reversible , since both reactions are terminal .",
    "the _ stoichiometric subspace _ of @xmath54 is the linear subspace of @xmath51 given by @xmath64 for @xmath65 , the sets @xmath66 are called the _ stoichiometric compatibility classes _ of @xmath54 ( fig .",
    "@xmath67 ) . for the network in , @xmath68 , which is 2-dimensional .",
    "we will consider a reaction network @xmath54 either as a deterministic dynamical system on the continuous space @xmath69 , or as a stochastic dynamical system on the discrete space @xmath0 .",
    "in the deterministic case , the evolution of the species concentrations @xmath70 at time @xmath71 is modelled as the solution to the ode @xmath72 for some functions @xmath73 and an initial condition @xmath74 .",
    "we require that the functions @xmath75 are continuously differentiable , and that @xmath76 if and only if @xmath77 . such functions are called _ rate functions _ , they constitute a _ deterministic kinetics _ @xmath78 for @xmath54 , and the pair @xmath79 is called a _",
    "deterministic reaction system_. if @xmath80 for all reactions , then the constants @xmath81 are referred to as _ rate constants _ and the modelling regime is referred to as _ deterministic mass - action kinetics_. in this case , the pair @xmath82 is called a _ deterministic mass - action system _ , where @xmath83 is the vector of rate constants .    in the stochastic",
    "setting , the evolution of the species counts @xmath84 at time @xmath71 is modelled as a continuous - time markov chain with state space @xmath0 . at any state @xmath85 ,",
    "the states that can be reached in one step are @xmath86 for @xmath62 , with transition rates @xmath87 .",
    "the functions @xmath88 are called _ rate functions _ , and we require that @xmath89 if and only if @xmath90 .",
    "a choice of these functions constitute a _",
    "stochastic kinetics _",
    "@xmath78 for @xmath54 and the pair @xmath79 is called a _",
    "stochastic reaction system_. if the reaction @xmath53 occurs at time @xmath71 , then the new state is @xmath91 where @xmath92 denotes the previous state .",
    "if for any reaction @xmath62 @xmath93 then the constants @xmath81 are known as _ rate constants _ , as in the deterministic case , and the modelling regime is referred to as _",
    "stochastic mass - action kinetics_. the pair @xmath82 is , in this case , called a _",
    "stochastic mass - action system_.    the evolution of the stochastic as well as the deterministic reaction system is confined to the stoichiometric compatibility classes , @xmath94 in fact , @xmath95 , as @xmath96 takes values in @xmath0 .",
    "let @xmath42 be a reaction network .",
    "a.   a reaction network @xmath97 is a _ subnetwork _ of @xmath54 if @xmath98 . in this case",
    ", it follows that @xmath99 and @xmath100 .",
    "b.   a system @xmath101 , deterministic or stochastic , is a _ subsystem _ of a system",
    "@xmath79 if @xmath102 is a subnetwork of @xmath54 and the rate functions agree on the reactions in @xmath103 . c.   the subnetwork @xmath104 given by the set of terminal reactions @xmath63 is the _ terminal network _ of @xmath54 .",
    "we denote @xmath105 .",
    "furthermore , the subsystem @xmath106 of @xmath79 is called the _ terminal system _ of @xmath79 .",
    "the connected components of the reaction graph of the terminal network of @xmath54 are called _ terminal strongly connected component _ of @xmath54 . for any complex @xmath107 in @xmath108 ,",
    "we denote by @xmath109 the subsystem of @xmath54 whose reaction graph is the terminal strongly connected component containing @xmath107 as node .    as an example , consider the mass - action system @xmath110[\\kappa_2]}2b\\cee{<-[\\kappa_3]}a\\cee{->[\\kappa_4]}0\\cee{<=>[\\kappa_5][\\kappa_6]}c.\\ ] ] here , there are two terminal strongly connected components , which are @xmath111 and @xmath112 . in particular , @xmath113 is equal to @xmath114 and is given by @xmath110[\\kappa_2]}2b.\\ ] ] finally , if @xmath82 is a mass - action system , any subsystems @xmath101 is a mass - action systems as well and can be denoted by @xmath115 .",
    "in this section we will recapitulate the known characterisation of existence and uniqueness of positive equilibria in complex balanced systems and the connection between complex balanced systems and deficiency zero reaction networks .",
    "as we will show in the subsequent section , this characterisation can be fully translated into a similar characterisation for stochastic reaction networks .",
    "we start with a definition .",
    "[ def : cb ] a deterministic reaction system @xmath79 is said to be _ complex balanced _ if there exists a positive _ complex balanced equilibrium _ , that is , a positive equilibrium point @xmath116 for the system , such that @xmath117    the name ` complex balanced ' refers to the fact that the flow , at equilibrium , entering into the complex @xmath107 equals the flow exiting from the complex . as an example",
    ", the mass - action system in is complex balanced for any choice of @xmath118 and @xmath119 is a complex balanced equilibrium .",
    "the class of complex balanced systems is an extension of the class of detailed balanced mass - action systems @xcite .    for mass - action systems , becomes @xmath120 with the convention that @xmath121 if @xmath122 .    in the case of mass - action kinetics , we extend definition [ def : cb ] to the stochastic case , by saying that a stochastic mass - action system @xmath82 is complex balanced if the deterministic mass - action system @xmath82 is complex balanced",
    ". we might therefore refer to complex balanced mass - action systems without specifying whether they are stochastically or deterministically modelled .",
    "the next theorem is a slight generalization of a classical result @xcite , which provides the backbone for the further characterisation .",
    "the generalization includes a property of non - negative equilibria    [ thm : complex_balanced ] if a deterministic reaction system @xmath79 is complex balanced , then @xmath54 is weakly reversible .",
    "moreover , if @xmath78 is mass - action kinetics , then all equilibria are complex balanced , that is , they fulfil .",
    "moreover , there exists exactly one positive equilibrium in each stoichiometric compatibility class , which is locally asymptotically stable .    as we are not aware of a proof of this more general formulation , we provide one in appendix [ sec : proofs ] .",
    "the _ deficiency _ plays an important role in the study of complex balanced systems .",
    "the deficiency of @xmath54 is defined as @xmath123 where @xmath46 is the cardinality of @xmath45 , @xmath61 is the number of linkage classes of the reaction graph of @xmath54 and @xmath124 is the dimension of the stoichiometric subspace @xmath125 @xcite .",
    "the definition hides the geometrical interpretation of the deficiency , which we now will explore .",
    "let @xmath126 be a basis of @xmath127 .",
    "further , define @xmath128 for @xmath62 .",
    "let @xmath129 . then @xmath130 @xcite .",
    "the space @xmath131 is linearly isomorphic to the stoichiometric subspace @xmath125 if and only if @xmath132 . specifically , consider the homomorphism @xmath133 for @xmath62 , we have @xmath134 and @xmath135 is thus a surjective homomorphism .",
    "therefore , @xmath136 which implies that @xmath137 is an isomorphism if and only if @xmath132 .",
    "it further follows that the deficiency is a non - negative number .",
    "we state here a useful lemma on the deficiency of subnetworks .",
    "[ lem : subnet ] let @xmath54 be a reaction network with deficiency @xmath138 . then , the deficiency of any subnetwork of @xmath54 is smaller than or equal to @xmath138 .",
    "let @xmath98 and let @xmath102 be the corresponding subnetwork with deficiency @xmath139 .",
    "further , let @xmath140 and @xmath141 be the equivalent of @xmath131 and @xmath125 for @xmath102 , respectively . by and",
    "since @xmath140 is a subspace of @xmath131 , we have @xmath142 which concludes the proof .",
    "we next state two classical results which elucidate the connection between complex balanced systems and deficiency zero systems .",
    "a proof of the first and of the second result can be found in @xcite and in @xcite , respectively .",
    "the results draw a connection between graphical and dynamical properties of a network .",
    "theorem [ thm : equilibrium_boundary ] is given here in a wider formulation than in @xcite ( see appendix [ sec : proofs ] for a proof ) .",
    "[ thm : deficiency_zero_iff ] the mass - action system @xmath82 is complex balanced for any choice of @xmath143 if and only if @xmath54 is weakly reversible and its deficiency is zero .    [",
    "thm : equilibrium_boundary ] consider a deterministic reaction system @xmath79 , and assume that the deficiency of @xmath54 is zero . if @xmath144 is an equilibrium point and @xmath62 , then @xmath145 only if @xmath53 is terminal",
    "moreover , if @xmath78 is mass - action kinetics with rate constants @xmath143 and @xmath145 , then the projection of @xmath146 onto the species space of @xmath147 is a complex balanced equilibrium of @xmath148 .",
    "it follows from theorem [ thm : equilibrium_boundary ] that an equilibrium point satisfies for the terminal system , though it is not necessarily a positive equilibrium of @xmath149.the deficiency zero theorem , in the following formulation , is a consequence of the three previous theorems :    [ thm : deficiency_zero ] consider a deterministic reaction system @xmath79 for which the deficiency is zero .",
    "then the following statements hold :    a.   if @xmath54 is not weakly reversible , then there exists no positive equilibria ; b.   if @xmath54 is weakly reversible and @xmath78 is mass - action kinetics , then there exists within each stoichiometric compatibility class a unique positive equilibrium , which is asymptotically stable .    the original formulation is richer than the one presented here @xcite",
    ", and @xmath150 . ( a ) the stoichiometric compatibility classes are of the form @xmath151 .",
    "( b ) the two irreducible components on @xmath152 are shown ( black circles and square ) , together with the possible transitions between the states .",
    "all states within a component are accessible from each other .",
    "the `` square '' component has no active reactions , both reactions are active on the `` black circles '' component .",
    "the grey states are transient states which are not in any irreducible component .",
    ", scaledwidth=80.0% ]    to characterise the stochastic dynamics we introduce the following terminology .",
    "let @xmath42 be a reaction network .",
    "a.   a reaction @xmath62 is _ active _ on @xmath85 if @xmath90 .",
    "b.   a state @xmath153 is _ accessible _ from a state @xmath85 if there is a sequence of @xmath154 reactions @xmath155 such that 1 .",
    "@xmath156 , 2 .",
    "@xmath157 is active on @xmath158 for all @xmath159 .",
    "let @xmath54 be a reaction network .",
    "a non - empty set @xmath160 is an _ irreducible component _ of @xmath54 if for all @xmath161 and all @xmath153 , @xmath162 is accessible from @xmath146 if and only if @xmath163 .",
    "a reaction network @xmath54 is _ essential _ if the state space is a union of irreducible components .",
    "a reaction network @xmath54 is _ almost essential _ if the state space is a union of irreducible components except for a finite number of states .",
    "an essential network is also almost essential .",
    "a weakly reversible reaction network is essential @xcite .",
    "conditions for being essential can be found in @xcite .",
    "any irreducible component is contained in some stoichiometric compatibility class , and a stoichiometric compatibility class may contain several irreducible components ( fig .",
    "@xmath164 ) .",
    "the stationary distribution @xmath165 on an irreducible component @xmath166 is unique , if it exists .",
    "it is characterised by the _ master equation _",
    "@xcite : @xmath167 for all @xmath161 .",
    "let @xmath96 denote the stochastic process associated with the system .",
    "if @xmath168 follows the law of @xmath165 at time @xmath169 , then the distribution of @xmath96 is @xmath165 for all future times @xmath170 . in this sense ,",
    "the stationary distribution describes a state of equilibrium of the system .",
    "moreover , if @xmath165 exists , then @xmath171 provided that @xmath172 with probability one .",
    "as discussed in section [ sec : introduction ] , a connection between mass - action complex balanced systems and their stationary distribution has been made in @xcite :    [ thm : anderson ] let @xmath82 be a complex balanced mass - action system . then , there exists a unique stationary distribution on every irreducible component @xmath166 , and it is of the form @xmath173 where @xmath174 is a positive complex balanced equilibrium of @xmath82 and @xmath175 is a normalising constant .      in this section",
    "we derive stochastic statements corresponding to theorem [ thm : complex_balanced]-[thm : deficiency_zero ] .",
    "some of the proofs are deferred to appendix [ sec : proofs ] .",
    "we begin with a definition .    for an irreducible component @xmath166 , the set @xmath176 of _ active reactions _ on @xmath166 consists of the reactions @xmath62 that are active on some @xmath161 .",
    "the subnetwork @xmath177 is called the _",
    "@xmath166-network _ of @xmath54 and the subsystem @xmath178 of @xmath79 is called the _",
    "@xmath166-system _ of @xmath79 .",
    "the reactions that are active on @xmath166 determine the dynamics of the stochastic system on @xmath166 .",
    "to study the stationary distributions , it is therefore convenient to analyse the @xmath166-systems .",
    "note that @xmath176 is empty if and only if @xmath166 consists of a single state .",
    "as an example , consider the deficiency zero network , @xmath179 all molecules of @xmath3 and @xmath4 are irreversibly consumed through @xmath180 and @xmath181 , thus the only active reactions on an irreducible component @xmath182 are @xmath183 .",
    "the @xmath166-network is therefore @xmath183 , which differs from the terminal system @xmath183 , @xmath111 .",
    "the next proposition states that for a deficiency zero reaction network @xmath184 for any irreducible component @xmath166 .",
    "note that proposition [ prop : terminal_strong_linkage_classes ] does not hold in general , for example , @xmath185 has @xmath186 for any @xmath187 , while @xmath188 .",
    "[ prop : terminal_strong_linkage_classes ] let @xmath54 be a reaction network and @xmath166 an irreducible component such that @xmath189 has deficiency zero .",
    "then , @xmath189 is a subnetwork of @xmath104 .",
    "in particular , this is true if the deficiency of @xmath54 is zero .",
    "see appendix [ sec : proofs ] for a proof .",
    "proposition [ prop : terminal_strong_linkage_classes ] can be useful because @xmath176 might be difficult to find , especially if there are many complexes . on the other hand , terminal reactions are easily identified by means of the reaction graph .",
    "the next definitions are inspired by definition [ def : cb ] .",
    "[ defi : complex_balanced_stationary_distribution ] let @xmath190 be a stochastic reaction system . a stationary distribution @xmath165 on an irreducible component @xmath166 is said to be _ complex balanced _ if @xmath191    for a mass - action system , becomes @xmath192 for any @xmath193 and @xmath161 , with the convention that @xmath121 if @xmath194 . in developing the theory for complex balanced equilibria in the deterministic setting ,",
    "an important role is played by requiring positivity of the complex balanced equilibrium .",
    "our aim is to introduce a similar concept for the stochastic systems . in the deterministic setting , if a state @xmath195 is positive then every rate function calculated on @xmath196 is positive .",
    "we find inspiration from this to give the next definition :    an irreducible component @xmath166 is _ positive _ if @xmath197 .",
    "equivalently , an irreducible component @xmath166 is _ positive _ if all reactions are active on @xmath166 .",
    "the next definition follows naturally by analogy with the deterministic setting .",
    "[ def : stoch_cb ] a stochastic reaction system @xmath79 is said to be _ stochastically complex balanced _ if there exists a complex balanced stationary distribution on a positive irreducible component .    if @xmath166 is positive , then @xmath198 and a complex balanced stationary distribution on @xmath166 satisfies with @xmath199 replaced by @xmath45 .",
    "note the similarity between definition [ def : stoch_cb ] and the definition of a complex balance equilibrium ( definition [ def : cb ] ) : the positivity of @xmath166 plays the role of the positivity in definition [ def : cb ] . also note the close similarity between and .",
    "[ thm : stochastic_complex_balanced ] let @xmath79 be a stochastic reaction system , and let @xmath166 be an irreducible component . if there exists a complex balanced stationary distribution @xmath165 on @xmath166 then @xmath189 is weakly reversible . moreover , if @xmath78 is mass - action kinetics with rate constants @xmath143 , there exists a complex balanced stationary distribution @xmath165 on @xmath166 if and only if the @xmath166-system of @xmath82 is complex balanced . if this is the case , then @xmath165 has the form @xmath200 where @xmath174 is a positive complex balanced equilibrium of @xmath201 and @xmath175 is a normalising constant .",
    "the proof is in appendix [ sec : proofs ] .",
    "it is shown in @xcite that the stationary distribution @xmath202 is independent of the choice of complex balanced equilibrium @xmath174 of the @xmath166-system , provided that it is positive .",
    "we are now ready to derive stochastic versions of theorem [ thm : complex_balanced]-[thm : deficiency_zero ] .",
    "in addition , we will show that a stochastically complexed balanced mass - action system is complex balanced and _",
    "vice versa_. hence , we will show that the deterministic and stochastic systems are intimately connected .",
    "the next corollary is an analogue of theorem [ thm : complex_balanced ] .",
    "[ cor : stochastic_complex_balanced_positive ] if a stochastic reaction system @xmath79 is stochastically complex balanced then @xmath54 is weakly reversible",
    ". moreover , a mass - action system @xmath82 is stochastically complex balanced if and only if it is complex balanced . if this is case , then on every irreducible component @xmath166 there exists a unique stationary distribution @xmath165 .",
    "such @xmath165 is a complex balanced stationary distribution and it has the form , where @xmath174 is a positive complex balanced equilibrium of @xmath82 .    if @xmath166 is positive , then @xmath203",
    "therefore , by theorem [ thm : stochastic_complex_balanced ] if @xmath79 is stochastically complex balanced then @xmath54 is weakly reversible .",
    "moreover , if @xmath78 is mass - action kinetics with rate constants @xmath143 , it follows from theorem [ thm : stochastic_complex_balanced ] that there exists a complex balanced stationary distribution on @xmath166 if and only if @xmath82 is complex balanced . in this case , by theorem [ thm : anderson ] , a stationary distribution exists on every irreducible component and it is of the form . by theorem [ thm : stochastic_complex_balanced ] ,",
    "it is a complex balanced stationary distribution .",
    "corollary [ cor : stochastic_complex_balanced_positive ] might be considered a stochastic version of theorem [ thm : complex_balanced ] , especially if is taken to be equivalent to `` asymptotic stability '' for a deterministic equilibrium .",
    "part of the corollary is known @xcite ( see also theorem [ thm : anderson ] ) , and the whole corollary might therefore be considered as an extension of the result in @xcite on mass - action systems . in this sense ,",
    "theorem [ thm : stochastic_complex_balanced ] provides an even more general version , which deals with complex balanced subsystems of @xmath82 .",
    "we now state the parallel versions of theorem [ thm : deficiency_zero_iff]-[thm : deficiency_zero ] for the stochastic setting .",
    "[ cor : stoch_deficiency_zero_iff ] the mass - action system @xmath82 is stochastically complex balanced for any choice of @xmath143 if and only if @xmath54 is weakly reversible and its deficiency is zero .",
    "the result is an immediate consequence of corollary [ cor : stochastic_complex_balanced_positive ] and theorem [ thm : deficiency_zero_iff ] .",
    "[ thm : stationary_boundary ] consider a stochastic reaction system @xmath79 , and assume the deficiency of @xmath54 is zero .",
    "let @xmath146 be a state in an irreducible component @xmath166 and let @xmath53 in @xmath55 .",
    "then , @xmath204 only if @xmath53 is terminal . moreover , if @xmath78 is mass - action kinetics , then on @xmath166 the stationary distribution has the form @xmath205 where @xmath174 is a positive complex balanced equilibrium for the terminal system , and @xmath206 is a normalising constant .",
    "the proof is in appendix [ sec : proofs ] .",
    "[ thm : stoch_deficiency_zero ] consider a stochastic reaction system @xmath79 , and assume that the deficiency of @xmath54 is zero .",
    "then the following statements hold :    a.   if @xmath54 is not weakly reversible , then there exist no positive irreducible components ; b.   if @xmath54 is weakly reversible , then @xmath54 is essential , and if @xmath78 is mass - action kinetics then there exists a unique stationary distribution on every irreducible component .    the proof of the theorem is in appendix [ sec : proofs ] . in case ( i ) , theorem [ thm : stationary_boundary ] provides the form of the stationary distribution .",
    "hence we have characterised the stationary distribution for any deficiency zero reaction system , irrespectively whether it is complex balanced or not .",
    "consider the two stochastic mass - action systems @xmath207[\\kappa_2 ] } b,\\quad 10a \\cee{<=>[\\kappa_3][\\kappa_4 ] } 10b\\quad\\text{and}\\quad a \\cee{<=>[\\kappa_1][\\kappa_2 ] } b,\\quad 10a \\cee{->[\\kappa_3 ] } 0.\\ ] ] the behaviours of the two corresponding deterministic systems differ substantially , while the behaviours of the stochastic systems are equivalent on the irreducible components @xmath208 with @xmath209 an integer . indeed , in both cases the @xmath210-system is @xmath207[\\kappa_2 ] } b,\\ ] ] which is complex balanced ( theorem [ thm : deficiency_zero_iff ] ) .",
    "it follows from theorem [ thm : stochastic_complex_balanced ] that the stationary distribution on @xmath210 is @xmath211 for a suitable normalizing constant @xmath212 .",
    "the stationary distributions are complex balanced , but since @xmath210 is not positive in either of the two networks , we can not conclude that the systems are stochastically complex balanced . indeed , they are not for some choice of rate constants ( corollary [ cor : stoch_deficiency_zero_iff ] ) .",
    "incidentally , note that the second network is not almost essential .",
    "the above results draw parallels between stochastic and deterministic reaction networks . if a mass - action system is ( stochastically )",
    "complex balanced , then the stationary distribution on every irreducible component is a product - form poisson - like distribution .",
    "does the reverse statement hold true too ?",
    "if the stationary distribution is a product - form poisson - like distribution on some , or all irreducible components , does it follow that the system is complex balanced ? in the spirit of the first part of the paper we would like to achieve a full characterisation of stochastic systems with product - form poisson - like stationary distributions .",
    "however , even though the hypothesis of theorem [ thm : main_thm ] below is rather general , a full characterisation seems hard to achieve .",
    "[ thm : main_thm ] let @xmath54 be an almost essential reaction network , @xmath213 a vector of rate constants and @xmath116 a vector with positive entries . the probability distribution @xmath214 $ ] , defined by is a stationary distribution for the stochastic mass - action system @xmath82 for all irreducible components @xmath215 of @xmath54 if and only if @xmath174 is a complex balanced equilibrium for @xmath82 .    by theorem [ thm : anderson ] ,",
    "if @xmath216 is a complex balanced equilibrium for @xmath82 , then the stationary distribution on all irreducible components @xmath160 is of the form .",
    "oppositely , assume that is the stationary distribution on @xmath166 for the stochastic mass - action system @xmath82 , for all irreducible components @xmath166 .",
    "since @xmath54 is almost essential , there exists a constant @xmath78 such that any states @xmath146 with @xmath217 belongs to an irreducible component @xmath166 . for any @xmath85 , such that @xmath218 we have that @xmath219 and @xmath220 for all @xmath62 .",
    "then , since is a stationary distribution and since @xmath146 and @xmath221 are in the same irreducible component for all @xmath62 , we have from @xmath222 for all @xmath161 satisfying .",
    "further , using , equation becomes @xmath223 which , by rearranging terms , leads to @xmath224 the equality holds for all @xmath85 satisfying , therefore the polynomials on the two sides of are equal .",
    "for any @xmath225 , let @xmath226 be the polynomial @xmath227 the monomial with maximal degree in @xmath228 is @xmath229 , and these differ for all complexes @xmath225 .",
    "this implies that @xmath228 , @xmath225 , are linearly independent on @xmath13 , and thus , the polynomials on the two sides of are equal if and only if @xmath230 hence , @xmath174 is a complex balanced equilibrium for @xmath82 and the proof is completed .      to infer the existence of positive complex balanced equilibria in theorem [ thm : main_thm ] , the assumptions of the theorem could be weakened .",
    "specifically , it is only required that holds for a set of states whose geometry and cardinality allow us to conclude that the polynomials on the two sides of are the same . for to hold , we need @xmath146 to be in a irreducible component and we require @xmath219 and @xmath220 for all reactions @xmath62 , as well as the stationary distribution evaluated in @xmath146 and @xmath231 to be of the form . if a state @xmath146 satisfies this , we call it a _ good state_.    a more general condition than being almost essential could be chosen case by case and depends on the monomials appearing in .",
    "for example , if the set of complexes coincides with the set of species , then the polynomials in are linear and the existence of @xmath232 _ good states",
    "_ in general position implies the existence of a positive complex balanced equilibrium . in general ,",
    "let @xmath233 be the total degree of the polynomials in .",
    "then it is sufficient to have @xmath44 lines in general position with more than @xmath234 good states on each of them .",
    "therefore , to conclude that a system is complex balanced it is sufficient to check the behaviour of a finite number of states , lying on a finite number of irreducible components .",
    "however , it follows from examples [ ex : not_complex_balanced ] and [ ex : not_complex_balanced_2 ] that the existence of arbitrarily many good states on a few irreducible components does not imply the existence of a positive complex balanced equilibrium in general . finally , in order to postulate that the mass - action system is complex balanced",
    ", it is necessary that the vector @xmath174 appearing in theorem [ thm : main_thm ] is the same for every irreducible component , as shown in example [ ex : not_complex_balanced_different_c ] .",
    "the following examples are also meant to give an idea of why it is hard to obtain a full characterization of stochastic mass - action systems with a product - form poisson - like stationary distribution on some irreducible component .",
    "[ ex : not_complex_balanced ] let @xmath235 and let @xmath236 be an integer . consider the stochastic mass - action system @xmath237{\\rho } 2a,\\ ] ] where @xmath238 and @xmath239 are the rate constants .",
    "the reaction network is almost essential .",
    "it is shown in appendix [ sec : calculations ] that the stationary distribution on the irreducible component @xmath208 has the form with @xmath240 , namely @xmath241 where @xmath212 is a normalising constant .",
    "however , the mass - action system is not complex balanced as the reaction network is not weakly reversible ( theorem [ thm : complex_balanced ] ) .",
    "in particular , by theorem [ thm : main_thm ] , not all irreducible components can have a stationary distribution of the form with @xmath240 .",
    "trivially , the absorbing states @xmath242 and @xmath243 have it .    additionally , we should point out that there is not an _ equivalent _ system on @xmath166 ( that is , a stochastic mass - action system with the same transition rate matrix on the states of @xmath166 as ) which is complex balanced . consider the case @xmath244 . since the transition from @xmath245 to @xmath246 is possible according to ,",
    "any equivalent mass - action system must contain the reaction @xmath247 , with rate constant @xmath248 .",
    "it can be further shown that any equivalent weakly reversible mass - action system must contain the connected component    ( a+b ) at ( 0,0 ) @xmath249 ; ( 2b ) at ( 2,0.6 ) @xmath250 ; ( 2a ) at ( 4,0 ) @xmath251 ; ( 2b ) edge node@xmath248 ( 2a ) ( 2a ) edge node@xmath252 ( a+b ) ( a+b ) edge node@xmath248 ( 2b ) ;    this prevents the system from being complex balanced , since there is not a @xmath253 fulfilling for the three complexes @xmath250 , @xmath254 and @xmath249 .",
    "let @xmath255 and let @xmath236 be an integer . consider the modification of example [ ex : not_complex_balanced ] given by @xmath256[\\rho_2 ] } b\\qquad     2b \\cee{<=>[\\phantom{\\theta-}\\rho_1+\\rho_3\\phantom{()1}][\\rho_3 ] } 2a,\\ ] ] which is weakly reversible .",
    "if we let @xmath257 and @xmath258 , then the system reduces to that of example [ ex : not_complex_balanced ] by removing the two reversible reactions .",
    "it can be shown that for any parameter choice , is still a stationary distribution on the irreducible component @xmath259 . however , for some choice of parameters the mass - action system is not complex balanced .",
    "this can be seen either by direct computation on the system of complex balance equations or by noting that the deficiency of the network is 1 , so there must be a choice of parameters which prevents positive complex balanced equilibria by theorem [ thm : deficiency_zero_iff ] .",
    "it can be further shown that irreducible components different from @xmath166 do not possess a product - form poisson - like stationary distribution .",
    "[ ex : not_complex_balanced_2 ] consider the stochastic mass - action system with @xmath235 and @xmath260 two positive integers , @xmath261{\\rho\\theta_1\\theta_2 } b &     2b & \\xrightarrow{\\rho(\\theta_1+\\theta_2 - 1 ) } 2a\\\\[-0.3 cm ]     3a & \\xrightarrow[\\phantom{\\rho(\\theta_1+\\theta_2 - 1)}]{\\rho } a+2b\\qquad &     2a+b & \\xrightarrow[\\phantom{\\rho(\\theta_1+\\theta_2 - 1)}]{\\rho } 3b .",
    "\\end{aligned}\\ ] ] the reaction network is almost essential . for any @xmath262 ,",
    "consider the irreducible component @xmath263 .",
    "then @xmath264 and @xmath265 , defined as in , are the ( unique ) stationary distributions on the irreducible components @xmath266 and @xmath267 , respectively . for the relevant calculations see appendix [ sec : calculations ] . however , the mass - action system is not complex balanced , since the reaction network is not weakly reversible ( theorem [ thm : complex_balanced ] ) .",
    "[ ex : not_complex_balanced_different_c ] theorem [ thm : main_thm ] can be also used to compute the stationary distribution of a stochastic mass - action system which behaves as a complex balanced system on the irreducible components . consider the weakly reversible ( and therefore essential ) stochastic mass - action system @xmath268[\\kappa_2 ] } 2a\\qquad     a+b \\cee{<=>[\\kappa_3][\\kappa_4 ] } 2a+b.\\ ] ] on every irreducible component @xmath269 , @xmath262 , the associated continuous time markov chain , which describes the evolution of the counts of @xmath3 , has the same distribution as the process associated with @xmath270[\\kappa_2+\\kappa_4\\theta]}2a,\\ ] ] because the transition rates coincide .",
    "the latter system is complex balanced for any choice of rate constants .",
    "the stationary distribution has the form ( theorem [ thm : main_thm ] ) @xmath271 for some positive constant @xmath212 .",
    "the latter gives the stationary distribution of the original system as well .",
    "however , the rate of the poisson distribution does depend on @xmath272 , in which case the original system can not be complex balanced ( corollary [ cor : stochastic_complex_balanced_positive ] ) .",
    "for the same reason the example does not contradict theorem [ thm : main_thm ] .",
    "there are not many means to explicitly calculate the stationary distribution of a stochastic mass - action system . as an example , theorem [ thm : stochastic_complex_balanced ] can be used to determine the stationary distributions of mass - action systems like @xmath273[\\kappa_2]}d,\\quad 2a\\cee{<=>[\\kappa_3][\\kappa_4]}2b,\\quad a\\cee{->[\\kappa_5]}0.\\ ] ] indeed , for any irreducible component @xmath166 different from @xmath274 , the @xmath166-system is given by @xmath273[\\kappa_2]}d,\\ ] ] which is weakly reversible and has deficiency zero , therefore it is complex balanced . hence , the stationary distribution on @xmath166 has the form @xmath275 where @xmath276 and @xmath277 denote the entries relative to @xmath5 and @xmath131 , respectively . alternatively , since the terminal system is given by @xmath273[\\kappa_2]}d,\\quad 2a\\cee{<=>[\\kappa_3][\\kappa_4]}2b,\\ ] ] theorem [ thm : stationary_boundary ] can be used to compute the stationary distribution . on every irreducible component @xmath166 , it is given by @xmath278 which is equivalent to the previous formula since @xmath279 and @xmath280 are constantly @xmath281 on all irreducible components .",
    "if the system does not fulfil the conditions of theorem [ thm : stochastic_complex_balanced ] and neither can be cast as a birth - death process , theorem [ thm : main_thm ] might be useful .",
    "the following mass - action system is considered in @xcite : @xmath282 by theorem [ thm : main_thm ] , the stationary distribution can not be poisson . indeed , it is given by the distribution of @xmath283 , where @xmath284 and @xmath285 are two independent poisson random variables with rates @xmath286 and @xmath287 , respectively .",
    "hence , @xmath288 in @xcite , the following system is also considered : @xmath289[\\kappa_2]}a\\qquad    2a\\cee{<=>[\\kappa_3][\\kappa_4]}3a.\\ ] ] it has the stationary distribution @xmath290}{i(i-1)(i-2)+\\theta_3i}\\quad\\text{for } x\\in{\\mathbb{n}},\\ ] ] where @xmath291 , @xmath292 , @xmath293 and @xmath294 is a normalising constant .",
    "it is interesting that @xmath295 is a poisson distribution if and only if @xmath296 .",
    "in fact , and in accordance with our results , the mass - action system is complex balanced if and only if @xmath296 .",
    "corollary [ cor : stoch_deficiency_zero_iff ] provides a characterisation of reaction networks that are stochastically complex balanced for any choice of rate constants .",
    "it is natural to wonder whether a stationary distribution of the form on some irreducible component @xmath166 for all choices of rate constants implies something specific about the @xmath166-system .",
    "if for specific form we intend deficiency zero and weakly reversible , this is not the case , as this is violated in example [ ex : not_complex_balanced_different_c ] .",
    "however , in example [ ex : not_complex_balanced_different_c ] the system might be described _",
    "equivalently _ by means of a weakly reversible deficiency zero system for any irreducible component .",
    "the question of whether this is always true remains open .",
    "we provide here two more examples .",
    "[ ex : equivalent_to_complex_balanced_finite_case ] consider the stochastic mass - action system @xmath297}2b\\qquad     a+3b\\cee{->[\\kappa_2]}3a+b.\\ ] ] the underlying reaction network is considered in figure [ figure ] . on the irreducible component @xmath298 , the markov chain associated with the system has the same distribution as the markov chain associated with @xmath110[3\\kappa_2]}2b,\\ ] ] since the transition rates coincide .",
    "it is interesting to note that the dynamics of the two systems are different when they are deterministically modelled @xcite . due to theorem [ thm : deficiency_zero_iff ] ,",
    "the latter system is complex balanced for any choice of rate constants .",
    "therefore , by theorem [ thm : main_thm ] , the stationary distribution on @xmath166 has the form on both systems for any choice of rate constants .",
    "the same argument does not hold , in this case , for the other irreducible components .",
    "the same phenomenon as in example [ ex : equivalent_to_complex_balanced_finite_case ] is observed in the stochastic mass - action system @xmath297}3a+b\\qquad     a+3b\\cee{->[\\kappa_2]}2b.\\ ] ] on the irreducible component @xmath299 , the markov chain associated with the system has the same distribution as the markov chain associated with @xmath110[\\kappa_2]}3a+b,\\ ] ] since the transition rates coincide , and the latter network is weakly reversible and has deficiency zero .",
    "here we state some preliminary results that will be needed in appendix [ sec : proofs ] .    [",
    "lem : path ] let @xmath54 be a reaction network . if @xmath300 is a directed path in the reaction graph of @xmath54 , and @xmath301 , then @xmath302 is accessible from @xmath146 .",
    "first , note that @xmath303 it is sufficient to note that if @xmath301 , then for any @xmath304 , we have @xmath305 this concludes the proof .",
    "[ lem : weakly_reversible ] let @xmath166 be an irreducible component such that @xmath189 has deficiency zero . then , @xmath189 is weakly reversible . in particular ,",
    "if @xmath54 has deficiency zero , @xmath189 has deficiency zero and is weakly reversible for every irreducible component @xmath166 .",
    "if @xmath176 is empty then @xmath189 is weakly reversible and there is nothing to prove .",
    "otherwise , if @xmath176 is non - empty , let @xmath306 .",
    "by hypothesis , there exists a state @xmath146 in @xmath166 with @xmath301 .",
    "this means that @xmath307 is accessible from @xmath146 .",
    "moreover , since @xmath146 belongs to an irreducible component @xmath166 , we have that @xmath146 is accessible from @xmath307 as well , which implies that @xmath308 for a certain choice of @xmath309 .",
    "in particular , @xmath310 . by the hypothesis of deficiency zero",
    ", it follows that @xmath311 , because @xmath312 , defined in , is an isomorphism between the spaces @xmath131 and @xmath125 associated with @xmath189 . therefore , @xmath313 for some integers @xmath314 . since the vectors @xmath315 are linearly independent , @xmath316 for all @xmath317 .",
    "hence , each @xmath315 that appears in the sum , must appear at least twice , once with coefficient @xmath318 , once with @xmath319 .",
    "consequently , by iteratively reordering the terms @xmath320 , the reactions @xmath321 form a union of directed closed paths in the reaction graph of @xmath54 .",
    "in particular , the reaction @xmath322 is contained in a closed directed path of the reaction graph of @xmath189 , and since this is true for every reaction in @xmath176 , @xmath189 is weakly reversible .",
    "we conclude the proof by lemma [ lem : subnet ] , since if @xmath54 has deficiency zero , so does every subnetwork of @xmath54 .",
    "[ lem : reactions_gamma ] let @xmath54 be a weakly reversible reaction network , and let @xmath166 be an irreducible component . then , for any complex @xmath193 we have @xmath323    one inclusion is trivial , since @xmath324 .",
    "for the other inclusion , fix @xmath193 .",
    "suppose that there exists @xmath161 with @xmath325 .",
    "it follows that any reaction @xmath326 is active on @xmath166 , and therefore is contained in @xmath176 .",
    "moreover , since @xmath54 is weakly reversible , for any reaction in @xmath55 of the form @xmath53 , there exists a directed path in the reaction graph of @xmath54 from @xmath327 to @xmath107 .",
    "hence , by lemma [ lem : path ] , @xmath221 is accessible from @xmath146 , which implies that @xmath221 is in @xmath166 and that @xmath53 is in @xmath176 , since @xmath328 . therefore , to conclude the proof it suffices to prove that there exists @xmath161 with @xmath325 .",
    "if it were no @xmath161 with @xmath325 , then no reaction of the form @xmath329 would be in @xmath176 .",
    "since @xmath193 , there exists a reaction of the form @xmath53 .",
    "this means that there is @xmath330 , such that @xmath331 .",
    "hence , @xmath332 is in @xmath166 with @xmath333 , which concludes the proof .",
    "it is proven in @xcite that if a deterministic reaction system @xmath79 is complex balanced , then @xmath54 is weakly reversible .",
    "by @xcite , we also know that if @xmath78 is mass - action kinetics , then all positive equilibria are complex balanced , and there exists exactly one positive equilibrium in each stoichiometric compatibility class , which is locally asymptotically stable . therefore , to conclude the proof we only need to prove that in a complex balanced mass - action system @xmath82 , the eventual equilibria on the boundary of @xmath51 are also complex balanced .",
    "first of all note that any subsystem @xmath334 of @xmath82 corresponding to a linkage classes @xmath335 of @xmath54 is complex balanced . indeed , the projection of a positive complex balanced equilibrium of @xmath82 onto the space of the species of @xmath335 satisfies for any complex of @xmath336 ,",
    "hence it is a positive complex balanced equilibrium of @xmath334 .",
    "let @xmath174 be an equilibrium point on the boundary .",
    "consider a linkage class @xmath335 of @xmath54 , and assume that @xmath337 for any species @xmath125 appearing in the linkage class .",
    "then , the projection of @xmath174 onto the species of @xmath335 is a positive equilibrium of @xmath334 , and therefore complex balanced .",
    "it follows that @xmath174 satisfies for any complex of @xmath335 .",
    "oppositely , assume that there exists a species appearing in the linkage class @xmath335 , such that @xmath338 ( this can only happen on a boundary state ) .",
    "remember that by mass - action kinetics , all the rates of reactions whose source complex contains @xmath125 are zero . in particular , all the rates of reactions degrading @xmath125 are zero .",
    "consider a complex @xmath107 in @xmath335 that contains @xmath125 . by weakly reversibility , there exists a reaction @xmath329 in @xmath335 .",
    "if @xmath327 contains @xmath125 , then @xmath339 .",
    "if @xmath327 does not contain @xmath125 , then the reaction @xmath329 produces @xmath125 .",
    "since the rate of all reactions degrading @xmath125 is zero at @xmath174 and @xmath174 is an equilibrium , then @xmath340 must be zero as well . by mass - action kinetics , this means that there exists a species @xmath341 such that @xmath141 appears in @xmath327 and @xmath342 . by iteratively applying the same argument with the new species @xmath141 and by weakly reversibility , we obtain that @xmath343 for any reaction @xmath53 in @xmath335 .",
    "it follows that @xmath174 satisfies for any complex in @xmath335 , since the equation reduces to @xmath344 .",
    "equation is therefore satisfied for any complex of @xmath54 and @xmath174 is a complex balanced equilibrium .",
    "this concludes the proof .      by (",
    "* theorem 6.1.2 ) , if @xmath144 is an equilibrium point and @xmath62 , then @xmath145 only if @xmath53 is terminal . moreover , if @xmath145 , then @xmath345 for every complex @xmath346 of @xmath347 .    now",
    ", suppose that @xmath78 is mass - action kinetics with rate constants @xmath143 , and that @xmath145 with @xmath62 ( and therefore @xmath348 ) .",
    "consider @xmath349 by the first part of the statement , the reaction graph of the subnetwork @xmath350 is a union of terminal strongly connected components of @xmath54 , and therefore @xmath351 is weakly reversible .",
    "moreover , by lemma [ lem : subnet ] , the deficiency of @xmath351 is 0 .",
    "it is not hard to see that the canonical projection of @xmath146 onto the space of the species @xmath352 is a positive equilibrium point of @xmath353 , and therefore complex balanced by theorem [ thm : deficiency_zero_iff ] . the proof is concluded by and by noting that , for any complex @xmath354 , @xmath355      if @xmath176 is empty there is nothing to prove .",
    "suppose that this is not the case . since @xmath189 has deficiency zero , by lemma [ lem : weakly_reversible ] , it is weakly reversible . for any @xmath356 , by definition there",
    "exists @xmath161 such that @xmath90 , which in turn implies @xmath357 .",
    "therefore , for any directed path in the reaction graph of @xmath54 that starts with @xmath356 , all the reactions in the path belong to @xmath176 , by definition of @xmath176 .",
    "since @xmath189 is weakly reversible , this can only happen if @xmath184 , and this proves the first part of the statement . to conclude the proof ,",
    "note that if the deficiency of @xmath54 is zero , then by lemma [ lem : subnet ] the deficiency of @xmath189 is zero as well .",
    "for the first part of the statement , consider a continuous - time markov chain @xmath358 with state space @xmath359 and transition rate from @xmath360 to @xmath361 given by @xmath87 if @xmath356 , and zero otherwise .",
    "the master equation for @xmath358 is @xmath362 with the convention that @xmath363 if @xmath364 . by definition [ defi : complex_balanced_stationary_distribution ] , a stationary distribution for @xmath358 exists",
    "and it is of the form @xmath365 , for a suitable normalising constant @xmath366 . since @xmath295 is positive for any @xmath161 ( because it is a stationary distribution on an irreducible component ) , then by standard markov chain theory , we have that for any two states @xmath367 , if @xmath368 is accessible from @xmath369 , then @xmath369 is accessible from @xmath368 .",
    "fix @xmath356 and @xmath161 with @xmath90 .",
    "then , a directed path from @xmath361 to @xmath360 exists in the graph associated with @xmath358 . the second components of the form @xmath107 of the states in the path , by construction , determine a directed path in the reaction graph of @xmath189 from @xmath327 to @xmath107 . hence , any reaction @xmath356 is contained in a closed directed path , which means that @xmath189 is weakly reversible .",
    "assume now that @xmath78 is mass - action kinetics with rate constants @xmath143 and that @xmath174 is a positive complex balanced equilibrium of @xmath82 .",
    "then , by theorem [ thm : anderson ] , there exists a ( unique ) stationary distribution on @xmath166 of the form . if a species @xmath370 is not in @xmath371 , then the value of @xmath372 is constant for any @xmath161 , and can be obtained from by modifying the normalising constant .    by theorem",
    "[ thm : complex_balanced ] and lemma [ lem : reactions_gamma ] , we have that @xmath373 with @xmath374 if @xmath364 .",
    "therefore , for any @xmath193 and @xmath161 , @xmath375 which leads to , since @xmath376 is of the form .    to prove the converse we first introduce a new stochastic mass - action system @xmath377 , which is given by the reactions of the form @xmath378 where @xmath379 are fictitious species in one to one correspondence with the complexes @xmath199 .",
    "the rate constant of the reaction @xmath380 is given by @xmath81 .",
    "it is not difficult to see that the sum of the fictitious species is conserved for any possible trajectory .",
    "moreover , since any directed path @xmath381 in the reaction graph of @xmath54 corresponds to a directed path @xmath382 in the reaction graph of @xmath383 , we have that @xmath383 is weakly reversible by the first part of the proof .",
    "consider the set @xmath384 every state in @xmath385 is of the form @xmath386 , where @xmath161 and @xmath387 is considered as the vector in @xmath388 with entry 1 in the position corresponding to the species @xmath387 and 0 otherwise . since @xmath166 is an irreducible component of @xmath54 and the sum of the fictitious species is conserved , no state outside @xmath385 is accessible from any state in @xmath385 , according to @xmath383 .",
    "moreover , the master equation on @xmath385 can be written as @xmath389 if we choose @xmath390 for some positive constant @xmath366 , then the master equation is satisfied due to definition [ defi : complex_balanced_stationary_distribution ] .",
    "therefore , if @xmath366 is chosen as a suitable normalising constant , @xmath391 is a stationary distribution on @xmath385 .",
    "consider the linear homomorphism @xmath312 as defined in , for the reaction network @xmath383 .",
    "let @xmath392 denote the cardinality of a set , and note that @xmath393 .",
    "for any vector @xmath315 of the basis of @xmath394 , we have @xmath395 .",
    "since the vectors @xmath396 with @xmath317 are linear independent , @xmath312 is an isomorphism and the deficiency of @xmath383 is 0 .",
    "since @xmath383 is a deficiency zero weakly reversible reaction network , it follows from theorem [ thm : deficiency_zero_iff ] that the mass - action system @xmath397 is complex balanced . therefore , by theorem [ thm : anderson ] , we have that @xmath398 has the form @xmath399 for a positive complex balanced equilibrium @xmath400 , on any irreducible component @xmath401 contained in @xmath385 .",
    "since @xmath390 does not depend on @xmath402 , we have @xmath403 for any @xmath404 .",
    "fix a complex @xmath405 . since @xmath189 is weakly reversible ,",
    "there exists a reaction @xmath329 that is active on @xmath166 .",
    "fix @xmath161 such that @xmath325 .",
    "then for any @xmath356 we have @xmath220 .",
    "if we plug the formula for @xmath406 in for our choice of @xmath146 and @xmath327 , we obtain @xmath407 which leads to @xmath408 the proof is concluded by the fact that the above holds for any fixed @xmath193 , which means that @xmath174 is a positive complex balanced equilibrium of @xmath201 .      by lemma [ lem : weakly_reversible ]",
    ", @xmath189 is weakly reversible . moreover , for @xmath356 , if @xmath90 then @xmath357 .",
    "this implies that for any directed path in the reaction graph of @xmath54 that starts with @xmath356 , all the reactions in the path belong to @xmath176 , by definition of @xmath176 . since @xmath189 is weakly reversible , every directed path in the reaction graph of @xmath54 that starts with @xmath356 is contained in a closed directed path .",
    "this implies that @xmath184 , and proves the first part of the statement .",
    "now assume that @xmath78 is mass - action kinetics with rate constants @xmath143 .",
    "if the deficiency of @xmath54 is zero , then by lemma [ lem : subnet ] the deficiency of the terminal network is zero as well .",
    "moreover , @xmath104 is weakly reversible by definition , thus by theorem [ thm : deficiency_zero_iff ] @xmath149 is complex balanced for any choice of rate constants @xmath409 .",
    "let @xmath96 be the stochastic process associated with @xmath82 .",
    "by the first part of the statement , on @xmath166 only terminal reactions take place and these involve a subset of the species only . without loss of generality , we can assume that @xmath410 is constituted by the first @xmath411 species of @xmath412 .",
    "therefore , @xmath166 is of the form @xmath413 , with @xmath414 and @xmath415 .",
    "moreover , we have that on @xmath416 , the projection @xmath417 is distributed as the process associated with @xmath149 , for which @xmath416 is an irreducible component .",
    "let @xmath174 be a positive complex balanced equilibrium for @xmath149 .",
    "hence , by theorem [ thm : anderson ] or corollary [ cor : stochastic_complex_balanced_positive ] , the stationary distribution of the process @xmath418 on @xmath166 is of the form .",
    "for the first part , we prove that if an irreducible component @xmath166 is positive , then @xmath54 is weakly reversible .",
    "this simply follows from lemma [ lem : weakly_reversible ] : indeed , by the lemma , @xmath189 is weakly reversible and since @xmath166 is positive , @xmath197 .    to prove the second part",
    ", we have to show that a weakly reversible reaction network is essential , and this is done in @xcite .",
    "moreover , a deficiency zero weakly reversible mass - action system is complex balanced , and the proof is concluded by theorem [ thm : anderson ] or corollary [ cor : stochastic_complex_balanced_positive ] .",
    "in example [ ex : not_complex_balanced ] , we claim that the stationary distribution on the irreducible component @xmath208 has the form @xmath419 to prove this , it is sufficient to show that @xmath420 satisfies the master equation for every point @xmath421 of @xmath210 .",
    "the master equation on @xmath421 is given by @xmath422 by plugging in the formula for @xmath420 and after dividing by @xmath248 and @xmath212 we obtain @xmath423=\\frac{1}{x_1!x_2!}[x_1(\\theta-1)+x_2(x_2 - 1)].\\ ] ] if we multiply by @xmath424 and substitute @xmath425 , it follows that @xmath426 that is @xmath427 which always holds true because the terms cancel each other .",
    "in example [ ex : not_complex_balanced_2 ] , we change the notation to @xmath263 .",
    "then we claim that the stationary distributions on the irreducible components @xmath266 and @xmath267 are @xmath264 and @xmath265 , respectively , where as before @xmath419 we prove that @xmath264 is the stationary distribution on @xmath266 . the case with @xmath428 is analogue .",
    "we prove the result by consider the master equation for @xmath264 on a point @xmath429 , which is as following : @xmath430 as we did for the previous calculations , we plug in the expression for @xmath264 , then divide by @xmath431 , @xmath248 and multiply by @xmath424 .",
    "we obtain @xmath432 finally , by substituting @xmath433 with @xmath434 and by performing the calculations , we obtain @xmath344 , which means that the above equation is satisfied .            , _ continuous time markov chain models for chemical reaction networks _",
    ", in design and analysis of biomolecular circuits : engineering approaches to systems and synthetic biology , heinz koeppl , douglas densmore , gianluca setti , and mario di  bernardo , eds . ,",
    "springer , 2011 , pp .  342 ."
  ],
  "abstract_text": [
    "<S> stochastic reaction networks are dynamical models of biochemical reaction systems and form a particular class of continuous - time markov chains on @xmath0 . here </S>",
    "<S> we provide a fundamental characterisation that connects structural properties of a network to its dynamical features . </S>",
    "<S> specifically , we define the notion of ` stochastically complex balanced systems ' in terms of the network s stationary distribution and provide a characterisation of stochastically complex balanced systems , parallel to that established in the 70 - 80ies for deterministic reaction networks . </S>",
    "<S> additionally , we establish that a network is stochastically complex balanced if and only if an associated deterministic network is complex balanced ( in the deterministic sense ) , thereby proving a strong link between the theory of stochastic and deterministic networks . </S>",
    "<S> further , we prove a stochastic version of the ` deficiency zero theorem ' and show that any ( not only complex balanced ) deficiency zero reaction network has a product - form poisson - like stationary distribution on all irreducible components . finally , we provide sufficient conditions for when a product - form poisson - like distribution on a single ( or all ) component(s ) implies the network is complex balanced , and explore the possibility to characterise complex balanced systems in terms of product - form poisson - like stationary distributions . </S>"
  ]
}