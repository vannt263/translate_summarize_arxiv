{
  "article_text": [
    "the poset of _ partitions _ @xmath6 of the set @xmath7 , where the order is defined by refinement , is a classical object in combinatorics .",
    "various aspects of this poset have been studied in the literature ( cf .",
    "3 ) ) . in particular",
    ", its mbius function has been computed by schtzenberger and by frucht and rota independently ( cf .  @xcite ) , and the homotopy type of its order complex is a wedge of spheres .",
    "( the latter follows from the well - known fact that @xmath6 is a geometric lattice , and from bjrner s result @xcite that geometric lattices are shellable . )",
    "closely related , and more relevant to the present work , is the poset of _ ordered partitions _ of @xmath7 .",
    "it has a much simpler structure ; for example , all intervals in this poset are isomorphic to boolean lattices .    _ bipartitional relations _",
    "( _ bipartitions _ , for short ) were introduced by foata and zeilberger  @xcite , who showed that these are the relations @xmath8 for which the ( appropriately generalized ) major index @xmath9 and inversion number @xmath10 are equidistributed on all rearrangement classes .",
    "han ( * ? ? ?",
    "5 ) showed that these bipartitional relations can be axiomatically characterized as the relations @xmath8 for which @xmath8 _ and _ its complement are transitive .",
    "@xcite for further work on questions of this kind . )",
    "bipartitional relations on @xmath7 carry a natural poset structure , the partial order being defined by inclusion of relations .",
    "we denote the corresponding _ poset of bipartitions _ by @xmath11 .",
    "figure  [ fig : bip2 ] shows the hasse diagram of @xmath12 .",
    "the poset @xmath11 contains the poset of ordered partitions of @xmath7 _ and _ its dual as subposets , and therefore can be considered as a common extension of the two .",
    "it turns out that the richness of the structure of the poset of bipartitions is comparable to that of the lattice of partitions . to begin with",
    ", @xmath11 is a graded lattice of total rank @xmath1 ( see theorem  [ thm : lattice ] and corollary  [ cor : rank ] ) , although it is neither modular ( cf.example  [ ex : modular ] ) nor geometric .",
    "furthermore , the mbius function of each interval is @xmath3 , @xmath4 , or @xmath5 ( see corollaries  [ c_mobbip ] and [ c_mobprod ] , and theorem  [ t_irreg ] ) .",
    "we show this by proving the stronger result that the order complex of @xmath11 is homotopy equivalent to a sphere ( see theorem  [ t_fullc ] ) , and each proper interval is either the direct product of boolean lattices and smaller lattices of bipartitions , or has a contractible order complex ( see proposition  [ p_regprod ] and theorem  [ t_irreg ] ) .",
    "the proofs of these facts form the most difficult part of our paper .",
    "they are essentially based on an adaptation of the gray code of permutations due to johnson @xcite and trotter @xcite and on work of babson and hersh @xcite constructing a discrete morse function in the sense of forman @xcite for the order complex of a graded poset .",
    "the former is needed to decompose @xmath11 into a union of distributive lattices in a shelling - like manner .",
    "this decomposition is then refined using the well - known @xmath13-shelling of distributive lattices in order to obtain an enumeration of the maximal chains of @xmath11 to which the proofs of the results of babson and hersh apply .",
    "this paper is organized as follows .",
    "the next two sections are of preliminary nature .",
    "namely , section  [ sec : def ] reviews basic facts on bipartitional relations , while section  [ sec : morse ] outlines the basic ideas of the construction of babson and hersh .",
    "here we observe that the proofs of their main results are actually applicable to a larger class of enumerations of maximal chains , which we call  enumerations growing by creating skipped intervals . \" in section  [ sec : bipart ] , we provide the proof that @xmath11 is a lattice , and we show that it is graded and compute its rank function in section  [ sec : rank ] .",
    "the purpose of section  [ sec : pi - compatible ] is to show that @xmath11 may be written as union of @xmath14 distributive lattices , each indexed by a permutation , where the proof of distributivity is deferred to section  [ sec : distr ] .",
    "we begin section  [ sec : jt ] by reviewing the johnson  trotter algorithm and an easy generalization to enumerating all elements in a direct product of symmetric groups .",
    "we continue by using these enumerations to decompose the order complex of @xmath11 , and the order complex of certain intervals in it , in a shelling - like manner .",
    "section  [ s_toc ] forms the core of our article . here",
    "we construct an enumeration of the maximal chains of @xmath11 that refines the ",
    "j  t decomposition \" introduced in section  [ sec : jt ] , and to which the results of babson and hersh are adaptable , as reviewed in section  [ sec : morse ] .",
    "finally , in section  [ sec : int ] , we outline how the argument of the preceding section may be modified to handle the case of proper intervals of @xmath11 as well .",
    "in definition  [ d_bip ] below , we formally introduce bipartitional relations .",
    "this definition is ( essentially ) taken from han @xcite .",
    "subsequently , we shall provide a different way to see bipartitional relations , namely in terms of ordered bipartitions .",
    "historically , bipartitional relations were originally defined by foata and zeilberger in ( * ? ? ?",
    "1 ) in the latter way , and han showed in ( * ? ? ? * th .",
    "5 ) the equivalence with a condition which , in its turn , is equivalent to the transitivity condition that we use for defining bipartitional relations as given below .    [ d_bip ] a relation @xmath15 on a finite set @xmath16 is a _ bipartitional relation _",
    ", if both @xmath8 and @xmath17 are transitive",
    ". we denote the set of bipartitional relations on x by @xmath18 .",
    "note that , by definition , the complement of a bipartitional relation is also a bipartitional relation .",
    "following @xcite , we say that @xmath19 are _ incomparable _ , if either both @xmath20 and @xmath21 belong to @xmath8 , or none of them does .",
    "we will use the notation @xmath22 for such pairs .",
    "[ lem : han ] the incomparability relation @xmath23 is an equivalence relation .    this is ( * ? ? ?",
    "* lemme  4 ) , which may be easily verified directly , using definition  [ d_bip ] .",
    "as it was first observed by han in @xcite , every bipartitional relation @xmath8 induces a _ linear order @xmath24 _ on the @xmath8-incomparability classes as follows .",
    "for @xmath25 we set @xmath26 if and only if @xmath27 but @xmath28 .",
    "the @xmath8-incomparability classes form a set partition of @xmath16 and we may order them by @xmath24 to obtain an _ ordered partition _ of @xmath16 .",
    "an ordered partition @xmath29 of @xmath16 is an ordered list of pairwise disjoint nonempty subsets @xmath30 , such that @xmath16 is the union of the sets @xmath31 .",
    "every bipartitional relation may be represented by a unique pair of an ordered partition @xmath29 of @xmath16 and a vector @xmath32 ( cf .",
    "* th .  5 ) ) , as follows .",
    "we set @xmath33 in fact , the @xmath31 s must be the @xmath23-equivalence classes , numbered in such a way that @xmath34 if and only if @xmath35 for every @xmath36 and @xmath37 .",
    "we must set @xmath38 if and only if @xmath39 for all @xmath36 .",
    "for example , the bipartitional relation @xmath40 has two @xmath8-equivalence classes : @xmath41 and @xmath42 . since @xmath43 and @xmath44",
    ", we must have @xmath45 and @xmath46 .",
    "moreover , @xmath47 implies @xmath48 , whereas @xmath49 and @xmath50 imply @xmath51 .",
    "following @xcite , we call the ordered partition @xmath29 together with the vector @xmath52 an _ ordered bipartition _ , and we write it as @xmath53 .",
    "we call the blocks @xmath31 satisfying @xmath38 _ underlined _ ( and , consequently , we call the blocks @xmath31 satisfying @xmath54 _ nonunderlined _ )",
    ". furthermore , we call the ordered bipartition @xmath53 defining @xmath8 via ( [ e_obip ] ) the _ ordered bipartition representation of @xmath8_. on the other hand , every relation @xmath8 defined by an ordered bipartition representation @xmath53 in the way above is bipartitional : the transitivity of @xmath8 is clear , and the transitivity of @xmath17 is evident from the following trivial observation .",
    "[ l_uc ] if @xmath15 is represented by the ordered bipartition @xmath53 of @xmath16 , then @xmath55 is represented by the ordered bipartition @xmath56",
    ".    we will use the notation has no specific significance here , but we selected it in tribute to the ubiquitous letter @xmath8 in foata and zeilberger s article @xcite . ]",
    "@xmath57 to denote the bipartitional relation defined by its ordered bipartition representation @xmath53 .",
    "for example , the bipartitional relation @xmath40 from above may also be given as @xmath58 .    frequently , we shall write this ordered bipartition in a suggestive manner , where we physically underline the elements of underlined blocks .",
    "for example , the above bipartitional relation will also be written in the form @xmath59 .",
    "_ discrete morse theory",
    "_ , developed by forman  @xcite , is a combinatorial theory that helps to determine the homotopy type of a simplicial complex . roughly speaking , in this theory a _",
    "morse function _ on the faces of a simplicial complex induces a _ morse matching _ , which in its turn enables one to  contract \" parts of the complex which have no contribution to the homotopy type of the complex , and which leaves over only certain faces , called _ critical cells _ , from which the homotopy type of the complex can ( hopefully ) be read off . in our paper , we shall not need to know exact definitions of all these ingredients . for our purpose",
    "it will suffice to keep in mind that one of the primary goals is to identify the critical cells . for a detailed description of the theory",
    "we refer the reader to the above cited sources .    in this paper we will adapt a method developed by babson and hersh  @xcite , designed to find the homotopy type of the _ order complex _",
    "@xmath60 of a graded partially ordered set @xmath61 with minimum element @xmath62 and maximum element @xmath63 .",
    "recall that the order complex of a partially ordered set @xmath64 is the simplicial complex whose vertices are the elements of @xmath64 and whose faces are the chains of @xmath64 .",
    "babson and hersh  @xcite find a morse matching on the hasse diagram of the poset of faces of @xmath65 , the order relation being defined by inclusion , by fixing an enumeration of the maximal chains of @xmath61 , which they call _ poset lexicographic order _",
    ", defined as follows .",
    "[ d_plo ] a poset lexicographic order of a graded poset @xmath61 is a total ordering @xmath66 of its maximal chains with the following property : assume that for some @xmath34 two maximal chains @xmath67 and @xmath68 contain the same elements @xmath69 at ranks @xmath70 , but at rank @xmath71 the element @xmath72 is different from the element @xmath73 .",
    "then any maximal chain containing @xmath74 comes before any maximal chain containing @xmath75 in the total ordering .",
    "the above definition is an exact rephrasing of  ( * ? ? ?",
    "1.2 ) and , in this form , it is easily seen to be equivalent to the definition of a _ chain - edge labelling with the first atom property _ , as defined by billera and hetyei  ( * ? ? ?",
    "* def .  9 ) .",
    "every graded poset has a poset lexicographic order : we may draw the hasse diagram of the poset in the plane and enumerate its maximal chains in such a way that , for any pair of maximal chains @xmath76 and @xmath77 which contain the same elements at ranks @xmath78 but have different elements at rank @xmath71 , the chain @xmath76 comes before the chain @xmath77 in the enumeration if the element of @xmath76 at rank @xmath71 is to the left of the element of @xmath77 at rank @xmath71 .",
    "such an enumeration of maximal chains was considered in  @xcite .",
    "the enumeration of maximal chains induced by a @xmath79-labelling , as defined by bjrner and wachs  @xcite , is also a poset lexicographic order .",
    "the key property of a poset lexicographic order that is used in all proofs of babson and hersh in  @xcite ( and also suffices to prove the linear inequalities shown in  @xcite and  @xcite ) is that the enumeration of maximal chains considered _ grows by creating skipped intervals _ , a notion ( implicitly ) introduced in ( * ? ? ?",
    "* remark  2.1 ) ) .",
    "it is not difficult to see that this notion is equivalent to the following .",
    "[ d_ecsi ] let @xmath61 be a graded poset of rank @xmath80 with a unique minimum element @xmath81 and a unique maximum element @xmath82 .",
    "an enumeration @xmath83 of all maximal chains of @xmath61 _ grows by creating skipped intervals _",
    "if for every maximal chain @xmath67 there is a family of intervals @xmath84 with elements @xmath85=\\{a , a+1,\\ldots , b\\}\\subseteq \\{1,2,\\dots , n\\}$ ] , none of the intervals contained in another , with the following property : a chain @xmath86 contained in a maximal chain @xmath67 is also contained in a a maximal chain @xmath68 for some @xmath87 if and only if the set of ranks of @xmath86 is disjoint from at least one interval in @xmath84 .    in the main result of babson and",
    "hersh @xcite , a second interval system , which is derived from the @xmath88-intervals , plays a crucial role .",
    "this interval system is called _",
    "@xmath89-intervals _ @xmath90 .",
    "the process of finding the system of @xmath89-intervals is given in  @xcite and may be extended without any change to enumerations of maximal chains that grow by creating skipped intervals as follows .",
    "[ d_jint ] consider an enumeration of all maximal chains of a graded poset of rank @xmath80 with @xmath81 and @xmath82 that grows by creating skipped intervals .",
    "let @xmath91 be a maximal chain whose associated interval system @xmath92 satisfies @xmath93\\in    i(c_k)}[u , v]=\\{1,2,\\dots , n\\}.\\ ] ] we define the _ associated @xmath89-intervals @xmath90 _ as the output of the following process :    * initialize by setting @xmath94 and @xmath95 .",
    "* let @xmath96 $ ] be the interval in @xmath88 whose left end point @xmath97 is the least .",
    "add @xmath96 $ ] to @xmath89 , and remove it from @xmath88 .",
    "* replace each interval @xmath98 $ ] in @xmath88 by the intersection @xmath98\\cap[v+1,n]$ ] .",
    "define the  new \" @xmath88 to be the resulting new family of intervals . * delete from @xmath88 those intervals which are not minimal with respect to inclusion . * repeat steps _",
    "( 1)(3 ) _ until @xmath99 .",
    "the output of the algorithm is @xmath89 .",
    "our wording differs slightly from the one used by babson and hersh , since they consider the families @xmath92 and @xmath90 as families of subsets of @xmath91 , whereas we consider them as families of subsets of @xmath100 .",
    "babson and hersh  @xcite state their main results for poset lexicographic orders only .",
    "however , a careful inspection shows that their statements and proofs ( in the corrected form from @xcite ) also apply to the larger class of enumerations of maximal chains growing by creating skipped intervals .",
    "this is what we need for our purposes since we shall consider an enumeration of maximal chains of @xmath11 which is not a poset lexicographic order ( see example  [ e_nonplo ] ) but still has the property defined in definition  [ d_ecsi ] ( as shown in lemma  [ l_skip ] ) .",
    "the following theorem presents the corresponding obvious generalization of ( * ? ? ?",
    "2.2 , cor .",
    "2.1 ) in the corrected form of ( * ? ? ?",
    "* theorem  4.2 ) .",
    "( the reader should note that the correction concerns the replacement of @xmath92 by @xmath90 in the characterization of maximal chains which contribute a critical cell . )",
    "[ t_bh1 ] let @xmath61 be a graded poset of rank @xmath80 with @xmath101 and @xmath102 , and let @xmath83 be an enumeration of its maximal chains that grows by creating skipped intervals .",
    "then , in the morse matching constructed by babson and hersh in ( * ? ? ?",
    "* paragraphs above th .",
    "2.1 ) , each maximal chain @xmath91 contributes at most one critical cell .",
    "the chain @xmath91 contributes a critical cell exactly when the union of all intervals listed in @xmath90 equals @xmath103 .",
    "if a maximal chain @xmath91 contributes a critical cell , then the dimension of this critical cell is one less than the number of intervals listed in @xmath90 .",
    "we will use the above result in combination with the main theorem of discrete morse theory due to forman ( * ? ? ? * first ( unnumbered ) corollary ) , ( * ? ? ?",
    "* th .  0.1 ) , ( * ? ?",
    "[ thm : forman ] suppose @xmath104 is a simplicial complex with a discrete morse function .",
    "then @xmath104 is homotopy equivalent to a cw complex with exactly one cell of dimension @xmath105 for each critical cell of dimension @xmath105 . in particular ,",
    "if there is no critical cell then @xmath104 is contractible .",
    "in this section , we formally define the order relation on the set of bipartitional relations , and we prove that the so defined poset is a lattice ( see theorem  [ thm : lattice ] ) . at the end of this section ,",
    "we record an auxiliary result concerning the lattice structure of @xmath18 in lemma  [ l_shortp ] , which will be needed later in section  [ sec : pi - compatible ] in the proof of lemma  [ l_opl ] .",
    "let @xmath8 and @xmath106 be two bipartitional relations in @xmath18 .",
    "we define @xmath107 if and only if @xmath108 as subsets of @xmath109 . in this manner , @xmath18 becomes a partially ordered set .",
    "[ thm : lattice ] for any finite set @xmath16 , the poset @xmath18 is a lattice .    by ( * ? ? ?",
    "3.3.1 ) , it is sufficient to show that every pair of bipartitional relations has a join .",
    "this will be done in proposition  [ p_join ] below .",
    "we remind the reader that a pair @xmath20 belongs to the _ transitive closure _ of a relation @xmath110 if there exists a chain @xmath111 with @xmath112 such that @xmath113 , @xmath114 and @xmath115 for @xmath116 .",
    "[ p_join ] for every @xmath117 there exists the join @xmath118 _ ( _ a smallest bipartitional relation with respect to inclusion containing both @xmath8 and @xmath106 _ ) _ , and it is given by the transitive closure of @xmath119 .",
    "let @xmath120 denote the transitive closure of @xmath119 .",
    "every bipartitional relation containing both @xmath8 and @xmath106 contains also @xmath120 by transitivity .",
    "we only need to show that @xmath120 is bipartitional .",
    "it is clearly transitive , only the transitivity of @xmath121 remains to be seen .",
    "assume by way of contradiction that @xmath20 and @xmath122 belong to the complement of @xmath120 but @xmath123 for some @xmath124 . by the definition of @xmath120 , there exists a sequence @xmath125 such that @xmath112 , @xmath113 , @xmath126 , and for every @xmath127 we have @xmath128 or @xmath129 .",
    "without loss of generality we may assume that we have @xmath130 .",
    "we can not have @xmath131 since this implies @xmath132 , in contradiction with @xmath133 , @xmath134 , and the transitivity of @xmath135 ( where , as before , @xmath135 denotes the complement @xmath17 ) . by induction on @xmath136",
    ", we see that @xmath137 belongs to @xmath120 , for @xmath138 . in particular , we have @xmath139 .",
    "the pair @xmath140 can not belong to @xmath8 , otherwise we have @xmath141 and , by the transitivity of @xmath120 , also @xmath142 . on the other hand , by the transitivity of the relation @xmath135 , we obtain from @xmath143 and @xmath144 that @xmath145 , in contradiction with our assumption",
    ".    we may represent any relation @xmath146 as a directed graph on the vertex set @xmath16 by drawing an edge @xmath147 exactly when @xmath148 .",
    "if we represent @xmath119 as a directed graph , we obtain that @xmath149 if and only if there is a directed path @xmath150 such that each edge belongs to the graph representing @xmath119 . by the transitivity of @xmath8 and @xmath106",
    ", a shortest such path is necessarily _ @xmath151-alternating _ in the sense that every second edge belongs to @xmath8 , the other edges belonging to @xmath106 .",
    "there is no bound on the minimum length of such a shortest path , as is shown in the following example .",
    "let @xmath152 and consider the bipartitional relation @xmath153 where each block has two elements , except possibly for the rightmost block , which is a singleton if @xmath0 is odd .",
    "consider also @xmath154 where each block has two elements , except for the leftmost block , which is always a singleton , and possibly for the rightmost block which is a singleton if @xmath0 is even .",
    "it is easy to verify that @xmath155 the shortest @xmath151-alternating path from @xmath4 to @xmath0 is @xmath156 , since @xmath157 if @xmath158 .    on the other hand ,",
    "if only @xmath20 belongs to @xmath159 but @xmath21 does not , then the shortest @xmath151-alternating path from @xmath160 to @xmath161 has length @xmath4 .",
    "[ l_shortp ] let @xmath8 and @xmath106 be bipartitional relations on @xmath16 .",
    "if for some @xmath162 we have @xmath149 and @xmath163 then @xmath20 already belongs to @xmath119 .",
    "assume , by way of contradiction , that the shortest @xmath151-alternating path @xmath150 from @xmath160 to @xmath161 satisfies @xmath164 .",
    "then , because of @xmath164 , @xmath20 belongs to @xmath135 and @xmath165 .",
    "since @xmath163 , the pair @xmath21 also belongs to @xmath135 and @xmath165 .",
    "thus @xmath166 and @xmath167 .",
    "we claim that we may replace @xmath113 with @xmath161 and @xmath114 with @xmath160 in the @xmath151-alternating path @xmath168 and obtain a @xmath151-alternating path @xmath169 .",
    "indeed , @xmath166 and @xmath170 imply that @xmath160 and @xmath161 belong to the same nonunderlined block of @xmath8 . hence , if @xmath171 , then @xmath172 belongs to a block of @xmath8 to the  right \" of the block containing @xmath160 , whence @xmath173 .",
    "similarly , if @xmath174 , then @xmath167 and @xmath175 yield @xmath176 .",
    "the proof that @xmath177 may be replaced with @xmath160 is analogous .",
    "we obtain that there is a @xmath151-alternating path from @xmath161 to @xmath160 , implying @xmath178 , in contradiction to our assumption .",
    "therefore we must have @xmath179 .",
    "in this section we describe the cover relations in the bipartition lattice @xmath18",
    ". this description will allow us to show that @xmath18 is a graded poset , and to give an explicit formula for the rank function .",
    "[ t_cover ] let @xmath180 be bipartitional relations",
    ". then @xmath106 covers @xmath8 if and only if its ordered bipartition representation may be obtained from the ordered bipartition representation of @xmath8 in one of the three following ways :    1 .",
    "join two adjacent underlined blocks of @xmath8 , 2 .",
    "separate a nonunderlined block of @xmath8 into two adjacent nonunderlined blocks , or 3 .",
    "change a nonunderlined singleton block of @xmath8 into an underlined singleton block .",
    "moreover , @xmath18 is a graded poset , with rank function @xmath181    the cover relations in @xmath12 are represented in figure  [ fig : bip2 ] .",
    "the cover relations in a subset of @xmath182 are represented in figure  [ fig : bip3c ] .",
    "( the fact that the cover relations in the latter subposet are also cover relations in the entire poset @xmath182 is shown in proposition  [ t_fullrank ] . )    first we show that the ordered bipartition representation of @xmath106 must come from the ordered bipartition representation of @xmath8 in one of the three ways mentioned in the statement . for that purpose , assume that @xmath106 covers @xmath183 .",
    "let us compare the restrictions of @xmath106 and @xmath8 to every block @xmath31 .",
    "note that the restriction of a bipartitional relation on @xmath16 to a subset of @xmath16 is also bipartitional .    in this case",
    "we must have @xmath54 .",
    "the relation @xmath120 given by @xmath184 is a bipartitional relation , properly containing @xmath8 , and contained in @xmath106 .",
    "in fact , its ordered bipartition representation may be obtained from @xmath53 by replacing @xmath185 with the ordered bipartition representation of @xmath186 .",
    "since @xmath106 covers @xmath8 , we must have @xmath187 .",
    "if @xmath186 contains no underlined block then merging two adjacent blocks of @xmath186 yields a bipartitional relation @xmath188 on @xmath31 satisfying @xmath189 .",
    "since @xmath106 covers @xmath8 and , hence , @xmath186 covers @xmath190 ,",
    "we must have @xmath191 . therefore @xmath106 is obtained from @xmath8 by an operation of type ( ii ) .",
    "if @xmath186 contains an underlined block , then by changing this block to nonunderlined we may obtain a bipartional relation properly contained in @xmath106 and still containing @xmath8 .",
    "hence @xmath186 must be @xmath192 .",
    "the only case when there is no bipartition on @xmath31 strictly between @xmath193 and @xmath194 is when @xmath195 , and @xmath106 is obtained from @xmath8 by an operation of type ( iii ) .    in this case",
    "every @xmath23-equivalence class is contained in some @xmath196-equivalence class , and this containment is proper for at least one of the @xmath31 s , since otherwise we must have @xmath197 .",
    "hence the situation of case  1 applies to at least one of the blocks of @xmath165 and @xmath135 .",
    "( clearly , @xmath135 must cover @xmath165 ) .",
    "thus , by the already proven case , the ordered bipartition representation of @xmath135 must be obtained from the ordered bipartition representation of @xmath165 by an operation of type ( ii ) or ( iii ) .",
    "here we may exclude an operation of type ( iii ) , since we are not allowed to have the @xmath23-equivalence classes ( which are the same as the @xmath198-equivalence classes ) to coincide with the @xmath196-equivalence classes",
    ". therefore @xmath135 is obtained from @xmath165 by an operation of type ( ii ) , which by lemma  [ l_uc ] is equivalent to saying that @xmath106 is obtained from @xmath8 by an operation of type ( i ) .",
    "it is easy to see that the function @xmath199 given in ( [ e_rank ] ) assigns zero to the empty bipartitional relation @xmath200 , and increases by exactly one every time we perform one of the operations ( i ) , ( ii ) , or ( iii ) . by the already established part of the statement , @xmath199 increases by one on every cover relation , and so @xmath18 is a graded poset with rank function @xmath199 . on the other hand ,",
    "every operation of type ( i ) , ( ii ) , or ( iii ) on a bipartitional relation @xmath8 must yield a bipartitional relation @xmath106 covering @xmath8 , since the rank function has increased by exactly one .",
    "[ cor : rank ] if @xmath201 then @xmath18 has rank @xmath1 .",
    "the purpose of this section is to introduce the notion of compatibility of bipartitional relations with a given ordered partition ( the latter having been defined in the paragraph after lemma  [ lem : han ] ) .",
    "this notion will be of crucial importance for the subsequent structural analysis of @xmath18 in the subsequent sections .",
    "as a first application , we use it in proposition  [ p_cont ] to give a criterion to decide @xmath108 when @xmath8 and @xmath106 are bipartitional relations given by their ordered bipartition representations .",
    "[ def : comp ] we call an ordered partition @xmath203 _ compatible _ with the bipartitional relation @xmath8 , if for every @xmath19 we have @xmath204    equivalently , if @xmath205 , then every @xmath31 is the union of consecutively indexed @xmath206 s .",
    "a particular case arises if @xmath202 consists of singleton blocks only . in this case , given that @xmath207 , there is a permutation @xmath208 of the elements of @xmath16 such that @xmath209 . by abuse of terminology",
    ", we shall often say in this case that  the ordered partition @xmath202 _ is a permutation _ , \" and the bipartitional relation @xmath8 is compatible with such an ordered partition @xmath202 if and only if the elements of @xmath210 may be listed in such an order that placing these lists one after the other in increasing order of blocks gives the left - to - right reading of the permutation @xmath202 .",
    "for any ordered partition @xmath202 , we denote the subposet of @xmath202-compatible bipartitions in @xmath18 by @xmath211 .",
    "the hasse diagram of @xmath212 is shown in figure  [ fig : bip3c ] .",
    "the next lemma shows that this subposet is also a sublattice .",
    "[ l_opl ] let @xmath202 be an ordered partition of @xmath16 . if @xmath15 and @xmath213 are @xmath202-compatible bipartitional relations then so are @xmath214 and @xmath118 .",
    "let @xmath203 and assume @xmath149 but @xmath163 for some @xmath215 and @xmath216 . by lemma  [ l_shortp ] , we have @xmath217 . without loss of generality",
    "we may assume @xmath27 .",
    "since @xmath8 is @xmath202-compatible , we obtain @xmath34 .",
    "hence @xmath118 is also @xmath202-compatible .",
    "the other half of the statement follows by duality , since any bipartitional relation is @xmath218-compatible if and only if its complement is @xmath219-compatible .",
    "using theorem  [ t_cover ] we may deduce the following fact .",
    "[ p_c ] let @xmath220 be a maximal chain in @xmath18 , where @xmath221 .",
    "then there is a unique ordered partition @xmath222 which is compatible with all elements of the chain .",
    "this ordered partition is a permutation .",
    "for @xmath131 the statement is trivially true .",
    "assume @xmath223 and let @xmath160 and @xmath161 be two different elements of @xmath16 .",
    "consider the smallest @xmath136 for which @xmath224 contains at least one of @xmath20 and @xmath21 .",
    "such an @xmath136 exists since @xmath225 , and it is positive since @xmath226 .",
    "we claim that exactly one of @xmath20 and @xmath21 will belong to @xmath224 .",
    "in fact , @xmath227 does not contain any of them , so @xmath160 and @xmath161 belong to the same nonunderlined @xmath228-equivalence class .",
    "@xmath224 is obtained from @xmath227 by one of the operations described in theorem  [ t_cover ] . since at least one of @xmath20 and @xmath21",
    "was added , this operation can only be the separation of the @xmath228-equivalence class of @xmath160 and @xmath161 into two nonunderlined blocks .",
    "such an operation adds exactly one of @xmath20 and @xmath21 .",
    "let us set @xmath229 if @xmath230 and @xmath231 ,",
    "respectively @xmath232 if @xmath233 and @xmath234 .",
    "we want to construct an ordered partition @xmath222 which is compatible with all @xmath224 s . if @xmath229 , this implies that @xmath160 belongs to an earlier block of @xmath222 than @xmath161 .",
    "there is at most one such ordered partition : the permutation , induced by the relation @xmath235 , provided that @xmath235 is a linear order .",
    "we are left to show that @xmath235 is indeed a linear order .",
    "clearly , for distinct @xmath160 and @xmath161 exactly one of @xmath229 and @xmath232 holds .",
    "we only need to show the transitivity of the relation @xmath235 .",
    "assume by way of contradiction that @xmath229 , @xmath236 and @xmath237 hold for some @xmath238",
    ". then we have @xmath239 for some @xmath240 . by the cyclic symmetry of the list",
    "@xmath241 we may assume that either @xmath242 or @xmath243 .",
    "if @xmath242 , then , since @xmath244 and @xmath245 , the transitivity of the relation @xmath246 implies @xmath247 , which is in contradiction with @xmath248 .    on the other hand , if @xmath243 , then since @xmath245 and @xmath249 , the transitivity of the relation @xmath246 implies @xmath250 , which is in contradiction with @xmath251 .",
    "proposition  [ p_c ] allows us to characterize @xmath108 when @xmath8 and @xmath106 are bipartitional relations given by their ordered bipartition representation .",
    "[ p_cont ] let @xmath180 be bipartitional relations represented as @xmath252 and @xmath253",
    ". then @xmath8 is contained in @xmath106 if and only if the following three conditions are satisfied :    1 .",
    "there is an ordered partition @xmath254 that is also a permutation which is compatible with both @xmath8 and @xmath106 , 2 .",
    "every underlined @xmath31 is contained in some underlined @xmath206 , 3 .   every nonunderlined @xmath255 is contained in some nonunderlined @xmath256 .",
    "assume first that @xmath8 is contained in @xmath106 .",
    "then there is a maximal chain @xmath86 in @xmath18 containing both @xmath8 and @xmath106 . by proposition  [ p_c ]",
    "there is an ordered partition @xmath222 compatible with every element of @xmath86 , and this ordered partition is a permutation , so condition ( i ) is satisfied .",
    "consider an underlined block @xmath31 .",
    "for every @xmath257 we have @xmath258 and so @xmath259 since @xmath108 .",
    "hence @xmath31 is contained in some @xmath206 .",
    "the proof of condition ( iii ) is analogous .",
    "we are left to show that whenever @xmath8 is not contained in @xmath106 , at least one of the given conditions is violated .",
    "assume @xmath260 and consider an ordered pair @xmath261 .",
    "if @xmath262 holds as well then @xmath160 and @xmath161 are contained in the same underlined block in the representation of @xmath8 . thus condition ( ii ) is violated since @xmath175 .",
    "similarly @xmath263 implies a violation of condition ( iii ) .",
    "we are left with the case where @xmath27 , @xmath28 , @xmath175 , and @xmath264 . now condition ( i )",
    "is violated .",
    "indeed , let @xmath254 be an arbitrary ordered partition that is also a permutation , satisfying @xmath265 and @xmath266 . by definition ,",
    "if @xmath202 is compatible with @xmath8 then we must have @xmath34 while compatibility with @xmath106 requires just the opposite , @xmath87 .",
    "in this section we introduce a representation of all @xmath202-compatible bipartitions , where @xmath202 is an arbitrary fixed permutation .",
    "we will use this representation to show that @xmath211 is a distributive lattice , for all ordered partitions @xmath202 . without loss of generality , we may assume @xmath267 and , for the moment , we may even assume that @xmath268 .",
    "the analogous results for an arbitrary finite set @xmath16 and an arbitrary permutation @xmath202 may be obtained by renaming the elements .",
    "let @xmath8 be a @xmath269-compatible bipartitional relation , represented as @xmath270 , such that the elements in each block are listed in increasing order .",
    "we define the _ code of @xmath8 _ as the vector @xmath271 where each @xmath272 is an element of the set @xmath273 , given by the following rule : @xmath274    for example , the code of the bipartitional relation @xmath275 is @xmath276 .",
    "evidently , the ordered bipartition representing @xmath8 may be uniquely reconstructed from its code , we only need to determine which vectors are valid codes of bipartitional relations .",
    "the definition of the code of @xmath8 is inspired by formula ( [ e_rank ] ) giving the rank of @xmath8 . according to this formula",
    ", we may compute @xmath277 of a @xmath269-compatible bipartional relation @xmath8 as follows .",
    "we take the ordered bipartition representation of @xmath8 , where we list the elements in increasing order . for the first element in each nonunderlined",
    "block we increase @xmath277 by @xmath4 , and we associate no contribution to the other elements in nonunderlined blocks . for the last element in",
    "each underlined block we increase @xmath277 by @xmath278 , and for each other element of an underlined block we increase @xmath277 by @xmath279 .",
    "thus we could equivalently define a code where the ordered list of weights @xmath280 is replaced by the list @xmath281 .",
    "the rank of @xmath8 is the sum of the coordinates in this `` simpler code . ''",
    "the list of weights @xmath280 is obtained from @xmath281 by the linear transformation @xmath282 .",
    "thus , even for the code we have chosen , @xmath277 is a linear function of the sum of the coordinates in its code .",
    "our choice of code has two `` advantages '' over the `` more obvious '' code described above :    * the description of a valid code in corollary  [ c_vcode ] below involves very simple linear inequalities with integer bounds . * for our code ,",
    "the code of @xmath135 is obtained by simply taking the negative of the code of @xmath8 .    in the end",
    ", it is only a matter of taste whether one prefers the list of weights@xmath280 or the list @xmath281 , and the results below may be easily transformed to fit the reader s preference .",
    "[ l_vcode ] a vector @xmath283 is the code of a @xmath269-compatible bipartitional relation if and only if the following conditions are satisfied :    * @xmath284 ; * @xmath285 ; * if @xmath286 for some @xmath287 then @xmath288 ; * if @xmath289 for some @xmath290 then @xmath291 .",
    "the necessity of the conditions above is obvious .",
    "conversely , given a vector @xmath292 satisfying the conditions above , we may find a unique ordered bipartition @xmath293 representing a relation whose code is @xmath271 , as follows :    * start the first block with @xmath4 if @xmath294 and with @xmath295 if @xmath296 .",
    "continue reading the @xmath272 s , left to right . * for @xmath297 , if @xmath298 , start a new nonunderlined block with @xmath136 .",
    "note that rule ( iv ) prevents us from starting a nonunderlined block without ending a preceding underlined block . * for @xmath299 , if @xmath286 then add a nonunderlined @xmath136 to the nonunderlined block that is currently being written ( by condition ( iii ) ) . * for @xmath299 , if @xmath300 then end an underlined block with @xmath301 .",
    "this block is a singleton if @xmath288 , and so @xmath302 belongs to a preceding nonunderlined block , or if @xmath303 , and so @xmath304 ends the preceding underlined block . * for @xmath297 , if @xmath289 , then add an underlined @xmath301 to the current underlined block if @xmath305 , and start a new underlined block with @xmath301 if @xmath306",
    ".    clearly the above process yields the only @xmath8 whose code is @xmath271 , and conditions ( i ) through ( iv ) guarantee that the process never halts with an error .",
    "lemma  [ l_vcode ] may be rephrased in terms of inequalities as follows .",
    "[ c_vcode ] a vector @xmath283 is the code of a @xmath269-compatible bipartitional relation if and only if it satisfies @xmath307 , @xmath308 and @xmath309 for @xmath310 .",
    "[ t_repr ] let @xmath8 and @xmath106 be @xmath269-compatible bipartitional relations with codes @xmath271 respectively @xmath311 .",
    "then @xmath108 if and only if @xmath312 holds for @xmath313 .",
    "assume that @xmath314 and @xmath253 .",
    "since @xmath8 and @xmath106 are both @xmath269-compatible , by proposition  [ p_cont ] , @xmath8 is contained in @xmath106 if and only if every underlined @xmath31 is contained in some underlined @xmath206 and every nonunderlined @xmath255 is contained in some nonunderlined @xmath256 .",
    "it suffices to show that this is equivalent to @xmath312 for all @xmath315 .",
    "assume @xmath108 first , and consider the possible values of @xmath316 , for a fixed @xmath317 .",
    "let @xmath256 be the block of @xmath8 containing @xmath315 .",
    "if @xmath318 , then @xmath312 is automatically true .",
    "if @xmath319 then @xmath320 can not be @xmath321 , otherwise the nonunderlined block @xmath255 containing @xmath315 has a smaller element in @xmath255 , whereas the least element of the nonunderlined block @xmath256 is @xmath315 .",
    "only @xmath256 could contain @xmath255 , but it does not .",
    "this contradiction shows that @xmath322 . if @xmath323 then @xmath315 is an element in an underlined block @xmath31 of @xmath8 .",
    "this block @xmath31 must be contained in some underlined @xmath206 .",
    "in other words , @xmath315 belongs to an underlined block in @xmath106 showing @xmath324 . finally ,",
    "if @xmath325 , then @xmath326 is the subset of some underlined @xmath31 .",
    "this @xmath31 is contained in some underlined @xmath206 , for which we must have @xmath327 .",
    "thus , @xmath315 is not the last element in @xmath206 , forcing @xmath328 .    for the converse ,",
    "assume , by way of contradiction , that @xmath329 for @xmath330 , but @xmath260 . then either condition ( ii ) or ( iii ) of proposition  [ p_cont ] is violated .    some nonunderlined @xmath255 is not contained in any nonunderlined @xmath256 . if the least element @xmath315 of @xmath255 belongs to some",
    "underlined @xmath256 then , because of @xmath331 and @xmath332 we have @xmath333 , a contradiction .",
    "it remains the case where @xmath315 belongs to some nonunderlined @xmath256 . in this case",
    "let @xmath334 be the least element of @xmath255 which does not belong to the same @xmath256 as @xmath315 .",
    "such a @xmath334 exists since the entire block @xmath255 is not contained in @xmath256 .",
    "now we have @xmath335 and @xmath336 , implying @xmath337 , again contradicting our assumption .",
    "some underlined @xmath31 is not contained in any underlined @xmath206 .",
    "this case is the dual of the previous one , see also lemma  [ l_dual ] below .",
    "in both cases we obtain that @xmath260 implies @xmath338 for some @xmath334 , which is absurd .",
    "[ l_dual ] if @xmath339 is the code of the bipartitional relation @xmath8 then @xmath340 is the code of @xmath341    the proof is straightforward and is left to the reader .",
    "using theorem  [ t_repr ] and corollary  [ c_vcode ] we are able to show that the sublattice of @xmath202-compatible bipartitional relations is distributive for _ any _ ordered partition @xmath202 .",
    "[ t_dist ] let @xmath202 be any ordered partition on @xmath16 .",
    "then the lattice @xmath211 is distributive .    without loss of generality ,",
    "let @xmath267 .",
    "it suffices to consider the case where @xmath342 . for , if @xmath343 , then , from the remarks immediately following definition  [ def : comp ] , it is easy to see by compressing the blocks @xmath255 to singletons @xmath344 that @xmath345    from now on , let @xmath342 . by theorem  [ t_repr ] and corollary  [ c_vcode ] , the partially ordered set @xmath211 is isomorphic to the set of all vectors @xmath346 satisfying @xmath307 , @xmath308 and @xmath309 for @xmath310 , partially ordered by the relation @xmath347 if and only if @xmath348 holds for all @xmath136 .",
    "we claim that the join and meet operations in this representation are given by @xmath349 @xmath350 clearly the above operations yield the join and meet of the two vectors in the larger lattice of _ all _ vectors from @xmath351 , partially ordered by the cartesian product of natural orders of integers .",
    "thus we only need to show that @xmath352 and @xmath353 satisfy the inequalities required by corollary  [ c_vcode ] , given that @xmath339 and @xmath354 satisfy these inequalities .",
    "the verification of this observation is straightforward and is left to the reader .",
    "the theorem now follows from the fact that the @xmath355 and @xmath356 operations are distributive over each other .",
    "the next example shows that the entire lattice @xmath18 is not distributive for @xmath357 , and that , in fact , it is not even modular .",
    "[ ex : modular ] let @xmath152 for some @xmath223 and consider the bipartitional relations @xmath358 , @xmath359 , and @xmath360 .",
    "it is easy to verify that @xmath361 is contained in @xmath362 , the join @xmath363 is @xmath109 , and the meet @xmath364 is @xmath193 .",
    "the set @xmath365 , shown in figure  [ fig : nmod ] , is thus a sublattice , isomorphic to the smallest example of a nonmodular lattice .    by birkhoff s theorem ( * ?",
    "3.4.1 ) , every distributive lattice is isomorphic to the lattice of order ideals in the poset of its join - irreducible elements . in order to apply this result",
    ", we need to find the join - irreducible elements in @xmath211 . in preparation for the corresponding result ( see theorem  [ p_jirred ] below )",
    ", we first characterize the cover relations in @xmath211 .",
    "again , without loss of generality , we may assume that @xmath152 and @xmath268 .",
    "[ t_fullrank ] let @xmath267 , and let @xmath202 be the permutation @xmath366 .",
    "let @xmath367 be @xmath202-compatible bipartitional relations in @xmath18 .",
    "then @xmath106 covers @xmath8 in @xmath18 if and only if @xmath106 covers @xmath8 in @xmath211 .",
    "clearly , if @xmath106 covers @xmath8 in @xmath18 it also covers it in @xmath211 .",
    "we only need to show that whenever @xmath368 holds in @xmath211 , then there is a @xmath202-compatible @xmath188 covering @xmath8 in @xmath18 such that @xmath369 holds in @xmath211 .",
    "we prove this statement by considering the codes @xmath339 of @xmath8 and @xmath354 of @xmath106 .",
    "assume that @xmath348 holds for @xmath370 and that @xmath371 is the least index such that @xmath372 .",
    "@xmath373 . in this case",
    "@xmath374 and @xmath375 is negative .",
    "the element @xmath371 is in a nonunderlined block of @xmath8 , and it is not the first element of this block . let @xmath188 be the @xmath269-compatible bipartitional relation obtained from @xmath8 by splitting the block containing @xmath371 into two adjacent blocks , such that the second block begins with @xmath371 .",
    "then the code @xmath376 of @xmath188 is obtained from the code @xmath271 by increasing @xmath377 to @xmath378 and leaving all other coordinates unchanged . since @xmath372 , we have @xmath379 , and thus @xmath380 holds for @xmath381 .    @xmath382 . in this case",
    "@xmath375 ( if it exists ) is not @xmath279 and @xmath8 has a nonunderlined block starting at @xmath371 . since @xmath383 , we also have @xmath384 , and so @xmath385 is positive .",
    "@xmath386 , i.e. , @xmath387 belongs to the nonunderlined block of @xmath8 that started at @xmath371 .",
    "thus , by condition ( iii ) in lemma  [ l_vcode ] , @xmath388 can not be @xmath321 and so @xmath389 .",
    "let @xmath188 be the @xmath269-compatible bipartitional relation obtained from @xmath8 by splitting the block containing @xmath387 into two adjacent blocks , such that the second block begins with @xmath387 .",
    "just like in case  1 , the code @xmath376 of @xmath188 is obtained from the code @xmath271 by increasing @xmath386 to @xmath390 , and so @xmath380 holds for all @xmath136 .",
    "@xmath391 , i.e. , the nonunderlined block containing @xmath371 is a singleton block .",
    "let @xmath188 be the @xmath269-compatible bipartitional relation obtained from @xmath8 by changing the nonunderlined block @xmath392 into an underlined block @xmath393 .",
    "the code @xmath376 of @xmath188 is obtained from the code @xmath271 by increasing @xmath394 to @xmath395 , leaving all other coordinates unchanged . since @xmath396",
    ", we have @xmath397 for all @xmath136 .",
    "@xmath398 ( thus @xmath399 ) .",
    "there is an underlined block in @xmath8 ending with @xmath371 , whereas the underlined block containing @xmath371 in @xmath106 does not end with @xmath371 .",
    "@xmath400 . by condition ( iii ) of lemma  [ l_vcode ] , we must have @xmath401 .",
    "moreover , @xmath399 and condition ( iv ) of lemma  [ l_vcode ] imply @xmath402 .",
    "therefore there is a nonunderlined block in @xmath8 starting at @xmath387 and , thus , @xmath403 is satisfied .",
    "we may now repeat the reasoning of case  2 for @xmath387 .",
    "@xmath404 , i.e. , there is an adjacent underlined block in @xmath8 starting with @xmath387 .",
    "let @xmath188 be the @xmath269-compatible bipartitional relation obtained from @xmath8 by merging the underlined blocks containing @xmath371 and @xmath387 .",
    "the code @xmath376 of @xmath188 is obtained from the code @xmath271 by increasing @xmath405 to @xmath406 , leaving all other coordinates unchanged .",
    "since @xmath399 , we have @xmath397 for all @xmath136 .",
    "[ cor : samerank ] for any permutation @xmath202 of @xmath16 , every interval @xmath407 $ ] in @xmath211 has the same rank as the corresponding interval @xmath407 $ ] in @xmath18 .",
    "now we are in the position to describe the join - irreducible elements in @xmath211 .",
    "[ p_jirred ] let @xmath267 and @xmath268 .",
    "then @xmath211 has the following @xmath1 join - irreducible elements :    * @xmath408 for @xmath409 .",
    "* @xmath410 for @xmath411 . here",
    "the first block is omitted for @xmath412 and the last block is omitted for @xmath413 .",
    "* @xmath414 for @xmath415 . here",
    "the first block is omitted for @xmath412 and the last block is omitted for @xmath416 .    moreover , the bipartitional relations listed under _ ( i ) _ and _ ( ii ) _ are also join - irreducible elements in @xmath18 .",
    "the bipartitional relations of type ( i ) above have rank @xmath4 and are clearly join - irreducible elements even in the larger lattice @xmath18 . by theorem  [ t_cover ] ,",
    "a bipartitional relation of type ( ii ) covers exactly one element of @xmath18 , namely @xmath417 .",
    "this bipartitional relation belongs of course also to @xmath211 .",
    "thus the bipartitional relations listed under ( ii ) are again join - irreducible elements even in the larger lattice @xmath18 .",
    "the element @xmath418 in ( iii ) is not join - irreducible in @xmath18 since , by theorem  [ t_cover ] , it covers exactly the two elements @xmath419 and @xmath420 however , only one , namely the former , is @xmath202-compatible . hence , by proposition  [ t_fullrank ] , @xmath418 covers exactly one element in @xmath211 , which means that it is join - irreducible in @xmath211 .",
    "conversely , if @xmath106 is join - irreducible in @xmath211 , then , be definition , it covers exactly one element , @xmath8 say , in @xmath211 . by proposition  [ t_fullrank ]",
    ", @xmath106 covers @xmath8 also in @xmath18 .",
    "( @xmath106 may cover other elements in @xmath18 as well , but they must not be @xmath202-compatible . ) by theorem  [ t_cover ] , @xmath8 can be obtained from @xmath106 by either splitting an underlined block into adjacent underlined blocks , or by joining two adjacent nonunderlined blocks , or by changing a singleton underlined block into a nonunderlined block .",
    "@xmath106 is join - irreducible if and only if exactly one such operation yields a @xmath202-compatible @xmath8 .",
    "this excludes the possibility of @xmath106 having two underlined blocks , or an underlined block with more than two elements , or three adjacent nonunderlined blocks .",
    "furthermore , it also excludes the possibility of @xmath106 having an underlined block at the same time as having two adjacent nonunderlined blocks .",
    "it is now obvious that only the possibilities listed under ( i)(iii ) remain .",
    "figure  [ fig : bipji ] indicates the hasse diagram of the subposet of join - irreducible elements of @xmath421 .",
    "this section contains preparatory material for the proofs of our main results in sections  [ s_toc ] and [ sec : int ] .",
    "the ultimate goal is to construct an enumeration of all maximal chains in @xmath18 , respectively in any interval thereof , such that the results of babson and hersh reviewed in section  [ sec : morse ] become applicable . the way that we propose here to arrive there proceeds in two steps .",
    "recall that , by proposition  [ p_c ] , each maximal chain @xmath86 determines a unique permutation @xmath202 such that all elements of @xmath86 are @xmath202-compatible .",
    "the first step , performed in this section , will consist of finding a suitable enumeration of all permutations .",
    "this induces a  pre - enumeration \" of the maximal chains , by putting them together in smaller groups according to their associated permutations and enumerating these groups .",
    "then , in the subsequent sections , we shall refine this pre - enumeration further to a full enumeration of all maximal chains by declaring how to enumerate the maximal chains corresponding to the same permutation .    for all of @xmath18 , the proposed enumeration of all permutations of @xmath16 will be obtained by the classical johnson ",
    "trotter algorithm @xcite . for proper intervals in @xmath18",
    ", we will need to consider a variant adapted to enumerate only specific subgroups of the full permutation group ( namely young subgroups , although this term will be of no importance in the sequel ; the interested reader may consult ( * ? ? ?",
    "7.18 ) for more information ) .",
    "we recall the johnson ",
    "trotter algorithm next , and subsequently describe its variant . in theorem  [ t_trotter ]",
    "we prove a property of the johnson  trotter algorithm and of its variant which will be crucial in proving the key lemma , lemma  [ l_skip ] , and of its adaptation to the results of section  [ sec : int ] , showing that the enumerations of maximal chains that we construct grows by creating skipped intervals .",
    "the adaptation of lemma  [ l_skip ] to the case of intervals in section  [ sec : int ] is made possible by the introduction of the _ j  t decomposition _ of the order complex of an interval in definition  [ d_trotterdec ] , and by theorem  [ t_trotterdec ] , discussing the properties of this decomposition .    the original version of the johnson ",
    "trotter algorithm  @xcite is used to enumerate all permutations of @xmath103 in such a way that each permutation differs from the preceding one by a transposition of adjacent elements .",
    "it may be described recursively as follows .    1 .",
    "the johnson ",
    "trotter enumeration of all permutations of @xmath41 is @xmath422 .",
    "assume we are given the johnson ",
    "trotter enumeration of all permutations of @xmath423 .",
    "if the permutation @xmath424 is an odd numbered item in this enumeration , then we replace it with the list @xmath425 otherwise we replace it with the list @xmath426    for example , the johnson ",
    "trotter enumeration of all permutations of @xmath427 is @xmath428    before we are able to describe the announced variant , we need to first review some facts about ordered partitions and their relation to bipartitions .",
    "we say that an ordered partition @xmath202 of @xmath16 _ refines _ the ordered partition @xmath218 if each block @xmath255 is the union of consecutive blocks of @xmath202 .    for an ordered partition @xmath202 of @xmath16 ,",
    "a bipartitional relation @xmath429 is @xmath202-compatible if and only if @xmath202 refines the ordered partition @xmath430 .",
    "refinement defines a partial order on the ordered partitions of @xmath16 .",
    "the poset thus obtained is isomorphic to the subposet of @xmath18 formed by all bipartitions having only underlined blocks .",
    "this isomorphism is made precise in the following definition .",
    "let @xmath431 be an ordered partition of @xmath16 .",
    "we define the _ underlined representation _ of @xmath431 in @xmath18 as the bipartitional relation @xmath432 , and we denote it by @xmath433 .",
    "[ c_uop ] let @xmath202 and @xmath208 be ordered partitions of @xmath16",
    ". then @xmath202 refines @xmath208 if and only if @xmath434 in @xmath18 .",
    "if @xmath314 and @xmath435 , then we will be interested in finding all permutations refining the ordered partition @xmath436 , as well as the ordered partition @xmath437 .",
    "[ cor : refine ] a permutation @xmath202 of @xmath16 refines the ordered partitions @xmath438 and @xmath437 if and only if @xmath439    note that @xmath440 is taken in @xmath18 .",
    "hence , the resulting bipartitional relation may also have nonunderlined blocks in its ordered bipartition representation . by proposition  [ p_cont ]",
    ", such a bipartitional relation can not contain a bipartition having only underlined blocks , and in that case there is no permutation refining both @xmath438 and @xmath441 .",
    "if , however , @xmath440 has an ordered bipartition representation @xmath442 consisting of underlined blocks only , then @xmath202 refines both @xmath438 and @xmath441 if and only if it refines @xmath443 . therefore enumerating all permutations associated to some maximal chain containing @xmath8 and @xmath106",
    "is equivalent to enumerating all permutations refining a given ordered partition .",
    "now we adapt the johnson  trotter algorithm to list all permutations refining a given ordered partition @xmath218 of @xmath103 such that each permutation differs from the preceding one by a transposition of adjacent blocks , as follows .    1 .   for @xmath131 we may only have @xmath444 , @xmath445 , and we list the permutation @xmath422 .",
    "2 .   assume we already know how to build the johnson ",
    "trotter enumeration of all permutations refining any given ordered partition of @xmath446 .",
    "let @xmath218 be an ordered partition of @xmath7 .",
    "if @xmath447 is a block by itself , then @xmath448 is an ordered partition of @xmath446 . list all permutations @xmath202 of @xmath446 refining @xmath449 , and insert @xmath450 between the last block of @xmath202 contained in @xmath451 and the first block of @xmath202 contained in @xmath452 .",
    "( at most one of these blocks may be missing if @xmath179 or @xmath453 . )",
    "we obtain an appropriate enumeration . + from now on",
    "we may assume that the block @xmath454 containing @xmath0 contains at least one more element .",
    "introducing @xmath455 for @xmath456 , @xmath457 is an ordered partition of @xmath423 , and we consider the johnson ",
    "trotter enumeration of all permutations refining this ordered partition .",
    "let @xmath458 be a permutation in this enumeration , where @xmath459 .",
    "( note that @xmath460 and @xmath315 are the same for all permutations in the enumeration . )",
    "if @xmath202 is an odd numbered item in this enumeration , then we replace it with the list @xmath461 otherwise we replace it with the list @xmath462    for example , the johnson",
    " trotter enumeration of all permutations refining @xmath463 is built recursively as follows .",
    "the list of all permutations refining @xmath422 is @xmath422 .",
    "the list of all permutations refining @xmath464 is @xmath464 .",
    "the list of all permutations refining @xmath465 is @xmath466 4 .   the list of all permutations refining @xmath467 is @xmath468    recall ( see @xcite ) that the _ shelling _ of a simplicial complex @xmath104 is an enumeration @xmath469 of its facets such that each facet has the same dimension as @xmath104 and , for each @xmath287 , any face @xmath470 that is contained in some preceding @xmath471",
    ", is also contained in a preceding @xmath472 whose intersection @xmath473 with @xmath474 has codimension one ( that is , making @xmath473 `` as large as possible '' ) .",
    "our next goal is to decompose each order complex @xmath475\\setminus \\{u , v\\})$ ] in a manner resembling a shelling . in the decomposition we are going to describe , the role of the facets in a shelling",
    "will be played by subcomplexes of the form @xmath476_\\pi\\setminus \\{u , v\\}),\\ ] ] where @xmath202 is a permutation such that @xmath8 and @xmath106 are @xmath202-compatible , and @xmath407_\\pi$ ] stands for the subposet of @xmath407 $ ] consisting of all @xmath202-compatible bipartitional relations . as a consequence ,",
    "we need to understand intersections of subcomplexes of the form . for this",
    ", it is necessary to know when a bipartitional relation is simultaneously compatible with two different ordered partitions . in this",
    "regard , lemma  [ c_uop ] yields the following immediate characterization .    [ c_simulc ] a bipartitional relation @xmath8 is simultaneously compatible with the ordered partitions @xmath477 and @xmath478 if and only if @xmath8 is compatible with the ordered partition @xmath443 given by @xmath479    obviously @xmath443 is the `` finest common coarsening '' of the ordered partitions @xmath477 and @xmath478 . in particular , in the case where @xmath267 and the permutations @xmath480 and @xmath481 differ in a transposition of adjacent blocks , say , @xmath482 , then @xmath483",
    "thus @xmath484 covers @xmath485 and @xmath486 in @xmath11 , and the intersection@xmath487 has the largest possible rank that a proper intersection of two lattices of the form @xmath488 may have . as a consequence , for every interval @xmath407 $ ] such that @xmath8 and @xmath106 are simultaneously @xmath489- and @xmath202-compatible , the subcomplexes @xmath475_\\sigma\\setminus \\{u , v\\})$ ] and @xmath475_\\pi\\setminus \\{u , v\\})$ ] are either equal or their intersection has codimension @xmath279 in both subcomplexes ( recall the formula for the rank function and the fact that , in the latter case , the above intersection arises by identifying @xmath490 and @xmath491 )",
    "this makes such intersections analogous to codimension @xmath4 faces in a shelling ( recall again the definition @xcite of a shelling ) .",
    "the following technical result is the key result for establishing the above indicated shelling - like property of the announced j ",
    "t decomposition ( to be defined in definition  [ d_trotterdec ] ) in theorem  [ t_trotterdec].(iii ) .",
    "[ t_trotter ] let @xmath218 be an ordered partition of the set @xmath7 and consider the johnson ",
    "trotter enumeration of all permutations refining this ordered partition . if @xmath492 precedes @xmath489 in this enumeration , then there is a permutation @xmath202 preceding @xmath489 in this enumeration , which differs from @xmath489 only in a transposition of adjacent blocks , and which satisfies @xmath493 here , @xmath494 means that @xmath495 covers @xmath496 .",
    "the permutation @xmath497 precedes @xmath498 in the johnson ",
    "trotter enumeration of all permutations of @xmath499 , and we have @xmath500 the permutation @xmath501 also precedes @xmath489 in the johnson  trotter enumeration , and @xmath202 differs from @xmath489 only in the transposition of the adjacent blocks @xmath502 and @xmath503 .",
    "thus we have @xmath504 implying @xmath505 we should perhaps also point out that , here , @xmath202 _ does not immediately _ precede @xmath489 in the johnson  trotter enumeration .",
    "we prove the statement by induction on @xmath0 .",
    "there is nothing to prove for @xmath131 .",
    "assume that the statement holds up to @xmath506 .",
    "consider a @xmath492 preceding a @xmath489 in the johnson ",
    "trotter enumeration of all permutations refining the ordered partition @xmath218 of @xmath7 .",
    "let @xmath507 , respectively @xmath508 , denote the permutations obtained from @xmath489 , respectively @xmath492 , by deleting the block @xmath450 .",
    "let @xmath509 be the ordered partition considered right before inserting @xmath0 in the johnson ",
    "trotter enumeration associated to @xmath218 . in other words , we have @xmath510 and @xmath511 if @xmath447 is a block by itself ( for some @xmath512 ) , and we have @xmath513 and @xmath455 for all @xmath371 otherwise . note that @xmath507 and @xmath514 belong to the set of all permutations of @xmath446 refining @xmath509 .    @xmath515",
    "then @xmath514 precedes @xmath507 in the johnson ",
    "trotter enumeration of all permutations refining @xmath509 . by our induction hypothesis , there is a permutation @xmath516 preceding @xmath507 in this enumeration such that we have @xmath517 here , for some @xmath136 , we have @xmath518 and we may assume @xmath519 and @xmath520    @xmath521 holds for some @xmath522",
    ". then we set @xmath523 where @xmath524 .",
    "in other words , we insert @xmath450 at the same place into @xmath516 as the place where it needs to be inserted into @xmath507 to obtain @xmath489 . by the recursive structure of the johnson ",
    "trotter enumeration , @xmath202 precedes @xmath489 in the enumeration of all permutations refining @xmath218 .",
    "moreover , @xmath202 differs from @xmath489 only in transposing the adjacent blocks @xmath525 and @xmath526 .",
    "thus , @xmath527 and it covers @xmath528 in @xmath11 .",
    "finally , by ( [ e_indhyp ] ) , the ordered bipartition representation of @xmath529 contains @xmath490 and @xmath491 in the same underlined block .",
    "therefore @xmath490 and @xmath491 are also in the same underlined block in the ordered bipartition representing @xmath530- together with , this implies @xmath531 .",
    "@xmath532 . in the same way as at the end of the previous subcase , the fact that @xmath490 and @xmath491 belong to",
    "the same underlined block of @xmath529 implies that they also belong to the same underlined block of @xmath533 .",
    "now , @xmath534 and @xmath535 imply that @xmath0 also belongs to the same underlined block of @xmath536 .",
    "thus @xmath533 contains the bipartitional relation @xmath106 represented by the ordered bipartition @xmath537 as a consequence , by lemma  [ c_uop ] , the block @xmath454 containing @xmath0 also contains @xmath490 and @xmath491 .",
    "therefore the permutations @xmath538 and @xmath539 both refine @xmath218 . by the structure of the johnson ",
    "trotter enumeration , one of them precedes @xmath489 .",
    "this one may be chosen as @xmath202 .",
    "it follows that @xmath540    @xmath541 . without loss of generality",
    ", we may assume that @xmath542 is an even numbered item in the johnson ",
    "trotter enumeration of all permutations refining @xmath509 .",
    "since @xmath492 precedes @xmath489 in the johnson ",
    "trotter enumeration of all permutations refining @xmath218 , we must have @xmath543 and @xmath544 for some @xmath545 .",
    "it is easy to see that @xmath546 as a consequence , by lemma  [ c_uop ] , the block @xmath454 containing @xmath0 also contains @xmath547",
    ". therefore the permutation @xmath548 also refines @xmath218 and it precedes @xmath489 in the johnson  trotter enumeration .",
    "we have @xmath549 in particular , @xmath550 covers @xmath551 , and @xmath550 is contained in @xmath552 .    using theorem  [ t_trotter ] , we now show that , for any interval @xmath407\\subseteq { \\operatorname{bip}}(x)$ ] , the order complex @xmath475\\setminus \\{u , v\\})$ ] has a  shelling - like \" decomposition .",
    "namely , we may write @xmath553\\setminus \\{u , v\\})=\\bigcup_{\\pi } \\triangle([u , v]_\\pi\\setminus \\{u , v\\}),\\ ] ] where the union is taken over all permutations @xmath202 such that both @xmath8 and @xmath106 are @xmath202-compatible .",
    "( the notation @xmath407_\\pi$ ] was defined just after . )",
    "we may enumerate these permutations using the johnson ",
    "trotter enumeration . to see the similarity with a shelling",
    ", the reader should imagine that the role of facets in a shelling is played in the decomposition by the subcomplexes @xmath475_\\pi\\setminus \\{u , v\\})$ ] , all of which have the same dimension as @xmath475\\setminus \\{u , v\\})$ ] by corollary  [ cor : samerank ] .",
    "moreover , by theorem  [ t_dist ] , each poset @xmath407_{\\pi}$ ] is a distributive lattice and , by a result due to provan @xcite ( cf .",
    "also ( * ? ? ?",
    "* cor .  2.2 ) ) , the order complex @xmath475_\\pi\\setminus \\{u , v\\})$ ] is either the order complex of a boolean lattice ( and thus isomorphic to the boundary complex of a simplex ) or it is a polyhedral ball . in the case where @xmath554 and @xmath555 , i.e. , when @xmath407={\\operatorname{bip}}(x)$ ] , the sublattice @xmath407_{\\pi}$ ] is never a boolean lattice , thus we decompose the order complex as a union of balls .",
    "note next that for proper intervals @xmath407\\subset { \\operatorname{bip}}(x)$ ] it may happen that @xmath475_\\pi\\setminus \\{u , v\\})=\\triangle([u , v]_\\sigma\\setminus \\{u , v\\})$ ] holds for some @xmath556 .",
    "for example , in the case where the ordered bipartition @xmath557 representing @xmath8 and the ordered bipartition @xmath558 representing @xmath106 satisfy @xmath559 and @xmath560 then a permutation @xmath481 refining both @xmath438 and @xmath561 must satisfy @xmath562 , but it does not matter whether @xmath563 and @xmath564 or @xmath565 and @xmath566 . by proposition",
    "[ p_c ] , @xmath202 arises as the only ordered partition that is compatible with all elements of some maximal chain @xmath86 containing @xmath8 and @xmath106 , but the choice of the values of @xmath567 and @xmath568 is related to the part of @xmath86 that is outside the interval @xmath407 $ ]",
    ". we may overcome this difficulty by keeping only the first copy of each @xmath475_\\pi\\setminus \\{u , v\\})$ ] .",
    "[ d_trotterdec ] let @xmath407\\subseteq { \\operatorname{bip}}(x)$ ] be an interval , where @xmath569 , @xmath570 , and let the ordered partition @xmath443 be given by @xmath571 we define the _ j  t decomposition _ of @xmath475\\setminus \\{u , v\\})$ ] as follows :    1 .",
    "we list the order complexes @xmath475_\\pi\\setminus \\{u , v\\})$ ] in the order of the johnson ",
    "trotter enumeration of permutations @xmath202 refining @xmath443 .",
    "( by corollary  [ cor : refine ] , these are the permutations @xmath202 such that @xmath8 and @xmath106 are both @xmath202-compatible . ) 2 .",
    "if the same simplicial complex occurs several times in the above enumeration , we keep only its first occurrence and remove all other occurrences .",
    "the remaining list @xmath572 is the j  t decomposition of @xmath475\\setminus \\{u , v\\})$ ] .",
    "[ t_trotterdec ] the j ",
    "t decomposition @xmath572 of @xmath475\\setminus \\{u , v\\})$ ] has the following properties :    * each @xmath573 has the same dimension as @xmath475\\setminus \\{u , v\\})$ ] ; * each @xmath573 is either isomorphic to the boundary complex of a simplex or it is a polyhedral ball ; * for @xmath287 , any face contained in @xmath574 is also contained in @xmath575 for some @xmath576 such that there are permutations @xmath489 and @xmath202 that differ only in a transposition of adjacent blocks , with @xmath577_\\sigma\\setminus \\{u , v\\})$ ] and @xmath578_\\pi\\setminus \\{u , v\\})$ ] .",
    "we only need to show ( iii ) since , as mentioned above , item  ( i ) follows from corollary  [ cor : samerank ] , and item",
    "( ii ) follows from provan s result  @xcite .",
    "assume @xmath577_\\sigma\\setminus \\{u , v\\})$ ] and consider a face @xmath579 that is also contained in @xmath580_\\tau\\setminus \\{u , v\\})$ ] for some @xmath87 .",
    "this means that the elements of @xmath579 are @xmath489-compatible and @xmath492-compatible bipartitional relations . by corollary  [ c_simulc ] , these bipartitional relations are also compatible with the ordered bipartition @xmath208 given by @xmath581 . by theorem  [ t_trotter ] ,",
    "there is a permutation @xmath202 preceding @xmath489 in the johnson ",
    "trotter enumeration of all permutations @xmath208 with the property that both @xmath8 and @xmath106 are @xmath208-compatible , such that @xmath582 .",
    "thus the elements of the face @xmath579 are also @xmath202-compatible , and @xmath579 is contained in @xmath583_\\sigma\\setminus \\{u , v\\})\\cap \\triangle([u , v]_\\pi\\setminus \\{u , v\\}).\\ ] ] here @xmath475_\\pi\\setminus \\{u , v\\})=\\triangle_k$ ] for some @xmath576 in the j ",
    "t decomposition , in particular , @xmath584 .",
    "in this section we determine the homotopy type of the order complex of @xmath586 . to achieve this goal",
    ", we construct a listing of all maximal chains contained in @xmath18 and then use the results of babson and hersh  @xcite as described in section  [ sec : morse ] to see that there is exactly one critical cell in this order complex with respect to the induced discrete morse matching .",
    "we now describe the announced listing of all maximal chains of @xmath18 . without loss of generality",
    ", we may assume that @xmath152 .",
    "the construction involves the following three steps .    by proposition  [ p_c ] , for each maximal chain @xmath86 in @xmath18 , there is a unique permutation @xmath489 such that all elements of @xmath86 are @xmath489-compatible .",
    "let us list the permutations of @xmath16 using the johnson ",
    "trotter enumeration and associate to each permutation @xmath489 the set of all @xmath489-compatible maximal chains , or , equivalently , of _ all _ maximal chains in @xmath587 .    by theorem  [ t_dist ] , for a fixed @xmath489 , the lattice @xmath587 is distributive . by (",
    "4.5 ) , it has an @xmath13-labelling using its join - irreducible elements . in this @xmath13-labelling , an edge @xmath151 , where @xmath8 and @xmath106 are elements of @xmath587 such that @xmath8 is covered by @xmath106 ,",
    "is labelled by the unique join - irreducible element @xmath588 such that @xmath589 but @xmath590 .",
    "we use this @xmath13-labelling to order the maximal chains of @xmath587 in the following way .",
    "the join - irreducible elements of @xmath587 for @xmath591 are given in proposition  [ p_jirred ] . by permuting the elements of @xmath16 ,",
    "it is easy to see that the join - irreducible elements of @xmath587 are the following :    * @xmath592 for @xmath409 , * @xmath593 for @xmath411 , * @xmath594 for @xmath415 .    for all what follows in this section",
    ", we fix the linear extension @xmath595 ( here , we use the symbol @xmath596 to distinguish the linear extension in from the order relation in @xmath587 . ) now , as announced above , we associate to each maximal chain @xmath597 contained in @xmath587 the word @xmath598 , where the letter @xmath599 is the unique join - irreducible element contained in @xmath224 but not contained in @xmath227 .",
    "we list the maximal chains in @xmath587 according to the lexicographic order of their associated words .    given a @xmath489-compatible maximal chain @xmath86 and a @xmath600-compatible maximal chain @xmath76 , the chain @xmath86 precedes @xmath76 if and only if either @xmath489 precedes @xmath600 in the johnson ",
    "trotter enumeration , or if @xmath601 and @xmath86 precedes @xmath76 in the ordering of the maximal chains in @xmath587 described in step  2 .",
    "the list of chains we thus obtain is in general _ not _ a poset lexicographic order as defined in definition  [ d_plo ] , as it may be seen in the following example .",
    "[ e_nonplo ] consider the cover relations @xmath602and @xmath603 in @xmath604 . here",
    "@xmath605 is @xmath606-compatible and @xmath607-compatible , but not@xmath608-compatible , whereas @xmath609 is @xmath608-compatible but not @xmath606-compatible nor @xmath607-compatible . in the johnson ",
    "trotter enumeration of all permutations of @xmath499 , the permutations @xmath606 , @xmath608 , @xmath607 follow in this order .",
    "it is not true that every maximal chain extending @xmath610 precedes every maximal chain extending @xmath603 since any@xmath608-compatible maximal chain precedes any @xmath607-compatible maximal chain . on the other hand ,",
    "it is also not true that every maximal chain extending @xmath603 precedes every maximal chain extending @xmath610 since any @xmath606-compatible maximal chain precedes any @xmath608-compatible maximal chain .",
    "however , our list of maximal chains still grows by skipped intervals , as defined in definition  [ d_ecsi ] , which we prove in the lemma below . in the proof of the lemma , and also",
    "later , we use the following well - known property of the @xmath13-labelling of distributive lattices which we recalled in step  2 above , and which involves the notion of a _ descent _ in a word @xmath598 : an index @xmath136 for which @xmath611 is called a descent .",
    "when we list the maximal chains of @xmath587 in lexicographic order as described in step  2 , then a subset @xmath612 of a maximal chain @xmath86 with associated word @xmath598 does not belong to any previously listed maximal chain if and only if the set of their ranks contains all descents of @xmath598 .",
    "[ l_skip ] let @xmath267 , and let @xmath613 be a permutation of @xmath16 . furthermore ,",
    "let @xmath86 be a @xmath489-compatible maximal chain of @xmath18 , and assume that the word @xmath598 is associated to @xmath86 in @xmath587 .",
    "as before , we list the maximal chains in @xmath587 according to the lexicographic order of their associated words , as described in step  2 at the beginning of this section .",
    "then a chain contained in @xmath86 is also contained in an earlier listed maximal chain of @xmath587 if and only if the set of its ranks is disjoint from at least one of the following intervals :    * all singletons @xmath614=\\{i\\}$ ] such that @xmath611 ; * all intervals @xmath615 $ ] with @xmath616 , @xmath617 , for some @xmath618 , such that the permutation @xmath202 obtained from @xmath489 by exchanging the adjacent blocks @xmath619 and @xmath620 precedes @xmath489 in the johnson  trotter enumeration .",
    "consider first the intersection of @xmath597 with another @xmath489-compatible maximal chain that was listed earlier .",
    "as noted in the paragraph preceding the lemma , a chain belongs to such an intersection if and only if its set of ranks does not contain the descent set @xmath621 of the word @xmath598 or , equivalently , if it is disjoint from at least one of the singletons listed in ( i ) .",
    "consider next the intersection of @xmath86 with a @xmath492-compatible maximal chain @xmath76 , where @xmath492 precedes @xmath489 in the johnson ",
    "trotter enumeration .",
    "this intersection is contained in @xmath622 which , by part ( iii ) of theorem  [ t_trotterdec ] , is contained in some @xmath211 , where @xmath202 is obtained from @xmath489 by exchanging the adjacent blocks @xmath619 and @xmath620 , for some @xmath618 , and @xmath202 precedes @xmath489 in the johnson  trotter enumeration .",
    "we may extend the intersection @xmath623 to a @xmath202-compatible maximal chain . clearly , the intersection @xmath623 is then a chain in @xmath624 .",
    "consider now the word @xmath598 associated to @xmath86 and define @xmath136 and @xmath371 by @xmath616 and @xmath617 .",
    "equivalently , @xmath136 is the smallest rank at which we find a bipartition @xmath224 that contains @xmath625 and @xmath618 in different ( _ nonunderlined _ ) blocks , and @xmath387 is the smallest rank at which we find a bipartition @xmath626 containing @xmath625 and @xmath618 in the same _ underlined _ block . thus the chain @xmath627 is @xmath202-compatible _ and _ @xmath489-compatible , whereas any @xmath628 of rank @xmath629 $ ] is only @xmath489-compatible . the intersection @xmath623 must be contained in , whence its set of ranks must be disjoint from @xmath615 $ ] .",
    "therefore , the intersection @xmath623 satisfies condition  ( ii ) with the above @xmath202 .",
    "conversely , let @xmath579 be a subchain of @xmath86 such that the set of its ranks avoids an interval @xmath615 $ ] , where the interval is one of the intervals described in item ( ii ) .",
    "then @xmath579 is a subchain of @xmath630 this chain may be extended to the @xmath202-compatible maximal chain obtained from @xmath86 by replacing each @xmath628 , @xmath631 , by the bipartitional relation @xmath632 obtained from @xmath628 by swapping the elements @xmath633 and @xmath634 .",
    "therefore @xmath579 is contained in the intersection of @xmath86 with a @xmath202-compatible maximal chain , where @xmath202 precedes @xmath489 .",
    "[ t_fullc ] the order complex @xmath635 is homotopy equivalent to a sphere of dimension @xmath636 .",
    "as before , without loss of generality , we may assume that @xmath267 .",
    "lemma  [ l_skip ] says that the enumeration of maximal faces of the order complex described in steps  13 at the beginning of this section grows by creating skipped intervals .",
    "consequently , by theorem  [ t_bh1 ] , in the morse matching constructed by babson and hersh  @xcite from such an enumeration , at most one critical cell is contributed per maximal chain , namely exactly when the set of intervals @xmath637 ( defined in definition  [ d_ecsi ] ) covers all elements of the set of ranks @xmath638 .",
    "we are going to show that there is exactly one maximal chain in our enumeration that contributes a critical cell .",
    "this maximal chain is the lexicographically first chain among the maximal chains that are compatible with the last permutation in the johnson ",
    "trotter enumeration , namely @xmath639 according to our construction , the lexicographically first chain which is compatible with this permutation is @xmath640 where @xmath641 is the enumeration of the join - irreducible elements in , with @xmath489 replaced by @xmath642 .",
    "subsequently , we will compute the dimension of the critical cell contributed by this maximal chain , using the last part of theorem  [ t_bh1 ] . the proof will be completed by taking recourse to theorem  [ thm : forman ] .",
    "consider now a @xmath489-compatible chain @xmath86 , whose associated word is @xmath598 ( compare step  2 at the beginning of this section ) , and assume that it contributes a critical cell .",
    "our first goal is to determine the set of intervals @xmath637 . according to lemma  [ l_skip ] ,",
    "it consists of those intervals listed in items  ( i ) and ( ii ) in this lemma that are minimal with respect to inclusion .",
    "clearly , all singletons listed in item  ( i ) of lemma  [ l_skip ] belong to @xmath637 .",
    "because of the property of @xmath13-labellings of distributive lattices that we recalled in the paragraph before lemma  [ l_skip ] , this implies in particular that any other interval @xmath615 $ ] , @xmath34 , can only be minimal with respect to inclusion if the substring @xmath643 of @xmath598 contains no descent . it",
    "is then not difficult to see from the choice of the linear extension of the subposet of join - irreducible elements ( cf .",
    "figure  [ fig : bipji ] ) that an interval @xmath615 $ ] listed in item  ( ii ) of lemma  [ l_skip ] belongs to @xmath637 if _ and only if _ we have @xmath644 , there is a @xmath618 such that @xmath616 and @xmath617 , and the permutation @xmath202 obtained from @xmath489 by exchanging the adjacent blocks @xmath619 and @xmath620 precedes @xmath489 in the johnson  trotter enumeration .    it remains the question ,",
    "how exactly the join - irreducible elements in can be aligned in a word @xmath598 such that the above described minimal intervals in @xmath637 cover all of @xmath645 $ ] , and what properties the permutation @xmath489 must have .",
    "( while reading the subsequent paragraphs , the reader is advised to keep figure  [ fig : bipji ] in mind . )    in order to answer the above question , we claim that , if the above described minimal intervals in @xmath637 cover all of @xmath7 , for all @xmath646 we have the following three properties :    * the letters appearing in the union of intervals @xmath647\\ ] ] _ in the poset of join - irreducible elements of _ @xmath488 appear in increasing order ( with respect to the linear order described in ) in @xmath598 ( from left to right ) . * for @xmath648 , the permutation obtained from @xmath489 by exchanging the blocks @xmath649 and @xmath650 precedes @xmath489 in the johnson ",
    "trotter enumeration . * for @xmath648",
    ", the substring @xmath651 of @xmath598 contains no descents .",
    "we prove these assertions by induction on @xmath652 .",
    "all three statements are vacuously true for @xmath444 .",
    "assume now that the statements are true for some @xmath653 .",
    "we will show that they also hold if we increase @xmath652 to @xmath71 .",
    "let us for the moment suppose that @xmath444 .",
    "since @xmath654 holds in @xmath11 , the letter @xmath655 must appear before the letter @xmath656 in the word @xmath598 , and the substring @xmath657 contains an _ ascent _",
    ", i.e. , a letter followed by a larger letter . let @xmath658 be the leftmost such ascent .    on the other hand , if @xmath659 , then , by ( c ) , we know that the substring @xmath660 contains no descent .",
    "moreover , since @xmath661 in @xmath11 , the letter @xmath662 must appear after the letter @xmath663 .",
    "both together , we infer that @xmath662 must appear after @xmath664 , and the substring @xmath665 contains an ascent .",
    "let @xmath658 be the leftmost such ascent .    to summarize both cases , in @xmath598 we find @xmath666 where @xmath658 marks the ascent that we identified in both cases , and where @xmath664 is not present if @xmath444 .",
    "it is allowed that @xmath667 ( or even that @xmath668 in the case that @xmath444 ) or @xmath669 .",
    "the position @xmath670 of the ascent @xmath658 can not be covered by a singleton listed under item  ( i ) in lemma  [ l_skip ] , thus it must be covered by a minimal interval @xmath615 $ ] listed under item  ( ii ) in lemma  [ l_skip ] . in particular , @xmath671 .    assume , by way of contradiction , that the interval @xmath615 $ ] is not associated to @xmath672 and @xmath673 .",
    "then we must have @xmath616 and @xmath674 for some @xmath675 .",
    "we claim that @xmath676 .",
    "this is immediate when @xmath444 . for @xmath677 ,",
    "the inequality @xmath676 follows from the fact that criterion ( a ) does not allow any letter @xmath678 satisfying @xmath679 to appear after @xmath664 ( recall ) .",
    "let us compare now the position of the letter @xmath680 with the position of @xmath681 if @xmath444 , or with the position of the letter @xmath664 if @xmath682",
    ". the letter @xmath680 can not appear before @xmath655 when @xmath444 , nor can it appear before @xmath664 when @xmath677 , because @xmath683 , respectively @xmath684 , would force a descent in the substring @xmath685 , making @xmath615 $ ] nonminimal . however , @xmath680 can not appear after @xmath655 when @xmath444 , nor can it appear after @xmath664 when @xmath677 . for , if this is the case , then we have an ascent in the substring in @xmath686 , respectively in the substring @xmath687 , and thus an ascent that occurs before @xmath688 , a contradiction with our choice that @xmath658 was the leftmost ascent in the substring @xmath689 , respectively in @xmath665 ( recall that @xmath671 ) .",
    "thus we must have @xmath690 and @xmath691 , and the permutation obtained by exchanging the blocks @xmath692 and @xmath693 must precede @xmath489 in the johnson ",
    "trotter enumeration .",
    "this proves that ( b ) remains valid when we increase @xmath652 to @xmath71 .",
    "furthermore , the substring @xmath694 must not contain any descents , proving that ( c ) remains valid when we increase @xmath652 to @xmath71 . as a consequence ,",
    "the elements in @xmath695 $ ] in the poset of join - irreducible elements of @xmath488 appear in increasing order in @xmath696 .",
    "the letter @xmath697 must appear before @xmath664 since @xmath698 holds in @xmath11 .",
    "this implies that the substrings @xmath699 and @xmath694 overlap , with @xmath662 following after @xmath664 .",
    "in addition , both substrings contain no descents .",
    "therefore ( a ) remains also valid when we increase @xmath652 to @xmath71 .",
    "this concludes the proof of the properties ( a)(c ) .    for @xmath700 , statement ( b ) forces",
    "@xmath489 to be the last permutation in the johnson ",
    "trotter enumeration .",
    "statement ( a ) implies that @xmath598 must not contain any descents , making @xmath86 the first maximal chain in @xmath488 .",
    "( note that , for @xmath700 , the union of intervals contains all @xmath1 join irreducible elements of @xmath488 . )",
    "thus far we have shown that the only maximal chain @xmath86 that _ may _ contribute a critical cell is the lexicographically first @xmath642-compatible chain ( that is , the chain , with @xmath642 being given in ) , where @xmath642 is the last permutation in the johnson ",
    "trotter enumeration , given in .",
    "we show that this chain @xmath86 contributes a critical cell , by computing explicitly the minimal intervals @xmath637 , and then we find the dimension of the critical cell by calculating the simplified system @xmath701 , as given in definition  [ d_jint ] , and by applying the last part of theorem  [ t_bh1 ] .",
    "since the word @xmath598 associated to @xmath86 contains no descents , it must be the string of join - irreducible elements listed in the order described in , and all intervals @xmath615 $ ] , where @xmath702 and @xmath703 , with @xmath704 , belong to @xmath637 . using the list",
    ", we obtain that @xmath705\\ } & \\mbox{if $ n=2$;}\\\\ \\{[1,4]\\}\\cup \\bigcup_{k=1}^{n-3 } \\{[3k,3k+4]\\}\\cup \\{[3n-6,3n-3]\\ } & \\mbox{if $ n\\geq 3$.}\\\\ \\end{cases}\\ ] ]    for any @xmath223 , the union of intervals contained in @xmath637 is @xmath706 , therefore @xmath86 does contribute a critical cell by theorem  [ t_bh1 ] .",
    "we are left to find the family of intervals @xmath701 , using definition  [ d_jint ] and above .",
    "it is easy to see that @xmath701 is given by @xmath707\\ } & \\mbox{if $ n=2$;}\\\\ \\{[1,4]\\}\\cup \\bigcup_{k=1}^{n-3 } \\{[3k+2,3k+4]\\}\\cup \\{[3n-4,3n-3]\\ } & \\mbox{if $ n\\geq 3$.}\\\\ \\end{cases}\\ ] ]    since @xmath708 , the dimension of the only critical cell is @xmath2 by the last part of theorem  [ t_bh1 ] .",
    "the theorem now follows upon invoking theorem  [ thm : forman ] .",
    "if we combine the preceding theorem with philip hall s theorem  ( * ? ?",
    "3.8.6 ) stating that the mbius function of a graded poset @xmath61 with minimum element @xmath62 and maximum element @xmath63 is the reduced euler characteristic of the order complex @xmath709 , then we obtain the following immediate corollary .",
    "[ c_mobbip ] the mbius function of the minimum and maximal element in @xmath18 is given by @xmath710",
    "in this concluding section , we handle proper intervals of @xmath18 .",
    "we distinguish between two kinds of intervals , regular and irregular ones ( see definition  [ def : regular ] . ) as we show in proposition  [ p_regprod ] , regular intervals are isomorphic to the direct product of boolean lattices and smaller bipartition lattices . since the mbius function of boolean lattices is well - known , and since we computed the mbius function of bipartition lattices in corollary  [ c_mobbip ] , it is then easy to compute the mbius function of regular intervals , see corollary  [ c_mobprod ] . for irregular intervals",
    "we prove that their order complexes are always contractible , see theorem  [ t_irreg ] .",
    "hence , the mbius function of an irregular interval vanishes .",
    "we must leave the question of the topological structure of regular intervals open .",
    "[ def : regular ] we say that an interval @xmath407\\subseteq { \\operatorname{bip}}(x)$ ] is _ regular _ if every @xmath160 satisfying @xmath711 also satisfies @xmath712 .",
    "otherwise we call @xmath407 $ ] _ irregular_.    in other words , an interval @xmath407 $ ] is regular if and only if , for every @xmath160 belonging to a nonunderlined block in @xmath8 and to an underlined block in @xmath106 , the block containing @xmath160 in @xmath8 is equal to the block containing @xmath160 in @xmath106 in the ordered bipartition representations of @xmath8 and @xmath106 , respectively .",
    "we remark that all of @xmath18 , that is , the interval @xmath713 $ ] , is a regular interval . indeed ,",
    "assuming without loss of generality that @xmath267 , we have @xmath714= [ u(\\{1,2,\\dots , n\\}),u(\\{\\underline1,\\underline2,\\dots,\\underline n\\})].\\ ] ]    [ p_regprod ] every regular interval @xmath407\\subseteq { \\operatorname{bip}}(x)$ ] is isomorphic to a direct product of boolean lattices and lattices of the form @xmath715 , where each @xmath716 is a block in the ordered bipartition representation of @xmath8 and of @xmath106 such that @xmath716 is nonunderlined in @xmath8 and underlined in @xmath716 .",
    "we prove the statement by induction on the total number of blocks in the ordered bipartition representations of @xmath8 and @xmath106 .",
    "assume first that there is no @xmath717 such that @xmath160 is contained in an underlined block of @xmath106 and in a nonunderlined block of @xmath8 .",
    "by proposition  [ p_cont ] , every nonunderlined block of @xmath106 is contained in some nonunderlined block of @xmath8 , and every underlined block of @xmath8 is contained in some underlined block of @xmath106 .",
    "thus , by our assumption , @xmath16 may be uniquely written as a disjoint union @xmath718 where each @xmath719 is either an underlined block of @xmath106 ( which is also the union of some consecutive underlined blocks of @xmath8 ) or a nonunderlined block of @xmath8 ( which is also the union of some consecutive nonunderlined blocks of @xmath106 ) . moreover , since every @xmath719 is either a block of @xmath8 , or the union of consecutive blocks of @xmath8 , we may order the blocks @xmath719 in such a way that , for all @xmath34 , the relation @xmath35 holds for all @xmath720 and @xmath721 .",
    "since @xmath108 , it is easy to see that , for all @xmath34 , @xmath720 and @xmath721 , we also have @xmath722 .",
    "a relation @xmath110 is bipartitional and belongs to the interval @xmath407 $ ] if and only if , for each @xmath136 , the restriction @xmath723 is bipartitional , belongs to @xmath724 $ ] , and we have @xmath725 for all @xmath720 , @xmath721 satisfying @xmath34 . thus the interval @xmath407 $ ] is isomorphic to the direct product @xmath726 $ ] .    given an interval @xmath724 $ ] , there are two possibilities : either @xmath727 has a single nonunderlined block , or @xmath728 has a single underlined block .",
    "it is then easily seen by compressing the ( nonunderlined ) blocks of @xmath728 , respectively the ( underlined ) blocks of @xmath727 , to singleton blocks , that each interval @xmath724 $ ] is isomorphic to a boolean lattice .",
    "assume finally that there is at least one @xmath717 such that @xmath729 . since @xmath407 $ ] is regular , the nonunderlined block @xmath730 ( say ) of @xmath8 containing @xmath160 is an underlined block of @xmath106 .",
    "let @xmath731 ( @xmath732 ) be the ( possibly empty ) union of all blocks listed before ( after ) @xmath730 in the ordered bipartition representation of @xmath8 .",
    "since @xmath730 is also a block of @xmath106 , and since @xmath108 , it is easy to see that @xmath731 ( @xmath732 ) is also the union of all blocks listed before ( after ) @xmath730 in the ordered bipartition representation of @xmath106 .",
    "a relation @xmath733 is bipartitional and belongs to @xmath407 $ ] if and only if for each @xmath734 the restriction @xmath735 is bipartitional , belongs to @xmath736 $ ] and , for all @xmath34 , @xmath737 and @xmath738 implies @xmath739 .",
    "( here we assume that the restriction of any relation to the empty set is the empty set , hence @xmath740 implies @xmath741|=1 $ ] . )",
    "thus the interval @xmath407 $ ] is isomorphic to @xmath742 $ ] .",
    "we may apply the induction hypothesis to the intervals @xmath743 $ ] and @xmath744 $ ] , whereas the interval @xmath745 $ ] is isomorphic to @xmath746 .    from the previous proposition ,",
    "we obtain the following immediate corollary for the mbius function of regular intervals .",
    "[ c_mobprod ] let @xmath407 $ ] be a regular interval in @xmath18 .",
    "then we have @xmath747    by ( * ? ? ?",
    "3.8.2 ) , the mbius function behaves multiplicatively for products of posets .",
    "furthermore , it is well - known that the mbius function of the minimum and maximum element in a boolean lattice of rank @xmath512 is equal to @xmath748",
    ". finally , by corollary  [ c_mobbip ] , we also know that the mbius function of the minimum and maximum element in a bipartition lattice of rank @xmath1 is equal to @xmath749 .",
    "if we put all this together and also recall that the rank function of products of posets is additive , we obtain the claim .",
    "our final theorem says that irregular intervals have a contractible order complex .",
    "[ t_irreg ] if @xmath407\\subseteq{\\operatorname{bip}}(\\{1,2,\\dots , n\\})$ ] is not regular , then the order complex @xmath475\\setminus \\{u , v\\})$ ] is contractible . in particular ,",
    "the mbius function @xmath750 vanishes in @xmath11 .",
    "we show theorem  [ t_irreg ] by adapting the proof of theorem  [ t_fullc ] .",
    "again , we need to define a listing of all maximal chains of @xmath407 $ ] to which the results of section  [ sec : morse ] are applicable . as in section  [ s_toc ] ,",
    "the construction of this listing involves three steps .",
    "we list the order complexes @xmath475_\\sigma\\setminus\\{u , v\\})$ ] , where @xmath489 is a permutation of @xmath16 such that @xmath8 and @xmath106 are @xmath489-compatible , using the johnson ",
    "trotter decomposition of @xmath475\\setminus\\{u , v\\})$ ] as defined in definition  [ d_trotterdec ] .    by theorem  [ t_dist ] , for a fixed @xmath489 ,",
    "the lattice @xmath587 is distributive , and , hence , also the subposet @xmath407_\\sigma$ ] is distributive . as in step  2 in section  [ s_toc ] , @xmath407_\\sigma$ ]",
    "has an @xmath13-labelling using its join - irreducible elements , due to ( * ? ? ?",
    "4.5 ) .    evidently , the join - irreducible elements of @xmath407_{\\sigma}$ ] may be identified with those elements @xmath751 , @xmath752 , and @xmath753 which are contained in @xmath106 but not in @xmath8 .",
    "more precisely , a join - irreducible element @xmath754 is identified with the join - irreducible element @xmath755_\\sigma$ ] . in the sequel , by abuse of terminology , when we speak of  the join - irreducible elements of @xmath407_{\\sigma}$ ] , \" then we shall always mean the join - irreducible elements @xmath754 which are contained in @xmath106 but not in @xmath8 , keeping the above identification in mind .    for defining the @xmath13-labelling , however , we need to start with a linear extension of the join - irreducible elements of @xmath407_\\sigma$ ] . unlike in section  [ s_toc ]",
    ", we select a different linear extension for each @xmath489 , the individual choices being independent from each other .",
    "lemma  [ l_nocrit ] below describes the details of these choices .",
    "analogously to section  [ s_toc ] , we associate to each maximal chain @xmath756 contained in @xmath407_\\sigma$ ] the word @xmath757 ( here @xmath758 is the rank of @xmath407_{\\sigma}$ ] ) , where the letter @xmath599 is the unique join - irreducible element of @xmath587 contained in @xmath224 but not contained in @xmath227 .",
    "we list the maximal chains in @xmath407_\\sigma$ ] according to the lexicographic order of their associated words .",
    "assume that @xmath475_\\sigma\\setminus\\{u , v\\})$ ] and @xmath475_{\\sigma'}\\setminus\\{u , v\\})$ ] appear in the j ",
    "t decomposition of @xmath475\\setminus\\{u , v\\})$ ] . given a @xmath489-compatible maximal chain @xmath86 and a @xmath600-compatible maximal chain @xmath76 , the chain @xmath86 precedes @xmath76 if and only if either @xmath475_\\sigma\\setminus\\{u , v\\})$ ] precedes @xmath475_{\\sigma'}\\setminus\\{u , v\\})$ ] in the j  t decomposition , or if @xmath601 and @xmath86 precedes @xmath76 in the ordering of @xmath407_\\sigma$ ] described in step  2 .",
    "[ l_nocrit ] let @xmath407 $ ] be an interval in @xmath11 , and let @xmath759 be a permutation such that @xmath475_{\\sigma}\\setminus \\{u , v\\})$ ] appears in the j ",
    "t decomposition of @xmath475\\setminus \\{u , v\\})$ ] .",
    "assume that some @xmath760 has the following properties :    * exactly one of @xmath761 and @xmath762 is contained in @xmath106 but not in @xmath8 .",
    "* at least one of @xmath763 and @xmath764 is contained in @xmath106 but not in @xmath8 .",
    "then there is a linear extension of the join - irreducible elements of @xmath407_{\\sigma}$ ] such that , no matter what linear extension we select for the other subcomplexes @xmath475_{\\pi}\\setminus \\{u , v\\})$ ] , no maximal chain of @xmath407_{\\sigma}$ ] contributes a critical cell .",
    "consider first the case where @xmath761 is contained in @xmath106 but not in @xmath8 , and @xmath762 is either contained in @xmath8 or not contained in @xmath106 . without loss of generality , we may assume that @xmath764 is contained in @xmath106 but not in @xmath8 ( otherwise we may simply replace @xmath764 by @xmath763 in the subsequent argument ) .",
    "this means that , when we label the cover relations @xmath765 in @xmath407_{\\sigma}$ ] by the unique join - irreducible element of @xmath488 that is contained in @xmath495 but not in @xmath361 , the elements @xmath761 and @xmath764 appear among the labels used but @xmath762 does not . select a linear extension of the join - irreducible elements of @xmath407_\\sigma$ ] ( recall the convention explained in step  2 after the statement of theorem  [ t_irreg ] ) , in which @xmath761 is the least element .",
    "this is possible since @xmath761 is a minimal element among the join - irreducible elements .",
    "we claim that for this labelling , no maximal chain of @xmath407_{\\sigma}$ ] contributes a critical cell .",
    "consider a maximal chain @xmath86 in @xmath407_{\\sigma}$ ] , and assume by way of contradiction that it contributes a critical cell . by theorem  [ t_bh1",
    "] , this means that the set of intervals @xmath637 covers all elements of the set of ranks of @xmath407 $ ] .",
    "let @xmath766 be the word associated to @xmath86 according to step  2 after theorem  [ t_irreg ] . in analogy",
    "to lemma  [ l_skip ] , a chain contained in @xmath86 is also contained in an earlier listed maximal chain if and only if the set of its ranks is disjoint from at least one of the following intervals :    * all singletons @xmath614=\\{i\\}$ ] such that @xmath611 , * all intervals @xmath615 $ ] with @xmath616 , @xmath617 , for some @xmath618 , such that the permutation @xmath202 obtained from @xmath489 by exchanging the adjacent blocks @xmath619 and @xmath620 makes @xmath475_{\\pi}\\setminus \\{u , v\\})$ ] precede @xmath475_{\\sigma}\\setminus \\{u , v\\})$ ] in the j ",
    "t decomposition of @xmath475\\setminus \\{u , v\\})$ ] as described in definition  [ d_trotterdec ] .",
    "the proof is essentially the same , and is thus omitted .",
    "next we have to determine the subset @xmath637 of the above intervals which are minimal with respect to inclusion .",
    "clearly , @xmath637 contains all singletons listed under ( i ) . in the same way as in the proof of theorem  [ t_fullc ]",
    ", it can be seen that an interval @xmath615 $ ] listed in item  ( ii ) belongs to @xmath637 only if we have @xmath644 .",
    "( note that we do not have an `` if and only if '' statement anymore , since the `` if '' part in the proof of theorem  [ t_fullc ] followed from the particular choice of the linear extension of the poset of join - irreducible elements , which we do not and need not guarantee in the present situation . )",
    "since @xmath767 holds in @xmath11 , the letter @xmath761 must appear before the letter @xmath764 in @xmath766 .",
    "moreover , because of @xmath768 , the substring @xmath769 contains an ascent .",
    "let the leftmost such ascent be at position @xmath670 , so that we encounter @xmath770 with @xmath658 .",
    "the position @xmath670 of the ascent is not covered by a singleton listed under ( i ) above , thus it must be covered by a minimal interval @xmath615 $ ] listed under ( ii ) above . in particular , we have @xmath671 .",
    "the interval @xmath615 $ ] is associated to @xmath616 and @xmath617 for some @xmath771 since @xmath762 is not a join - irreducible element in @xmath407_{\\sigma}$ ] . since",
    "the interval @xmath615 $ ] is minimal , the substring @xmath685 can not contain any descents . by our choice of the linear extension of the join - irreducible elements of @xmath407_\\sigma$ ]",
    ", we have @xmath772 .",
    "consider now the relative position of the letters @xmath761 and @xmath680 .",
    "if the letter @xmath680 appears after @xmath761 in @xmath766 , then we encounter @xmath773 ( it is allowed that @xmath774 or @xmath775 . )",
    "then the substring @xmath776 contains an ascent which is not covered by the interval @xmath615 $ ] ( recall that @xmath616 ) , in contradiction to having selected the leftmost ascent in the substring @xmath769 . on the other hand ,",
    "if the letter @xmath680 appears before @xmath761 in @xmath766 then we encounter @xmath777 ( it is allowed that @xmath778 or @xmath779 . ) because of @xmath780 , there is a descent in the substring @xmath781 , in contradiction to the fact that the substring @xmath685 does not contain any descents .",
    "consider now the case where @xmath762 is contained in @xmath106 without being contained in @xmath8 , and @xmath761 is either contained in @xmath8 or not contained in @xmath106 .",
    "this case is similar to the previous one , thus we only outline the necessary changes . without loss of generality",
    ", we may assume that @xmath764 is contained in @xmath106 , without being contained in @xmath8 .",
    "take a linear extension of the partial order on the set of join - irreducible elements of @xmath407_\\sigma$ ] such that @xmath762 is the maximal element , and consider the word @xmath766 associated to a maximal chain @xmath86 that contributes a critical cell .",
    "again , by theorem  [ t_bh1 ] , this means that the set of intervals @xmath637 covers all elements of the set of ranks of @xmath407 $ ] .",
    "since @xmath782 holds in @xmath11 , the letter @xmath764 must appear before the letter @xmath762 in @xmath766 , and the substring @xmath783 contains an ascent .",
    "consider the _",
    "rightmost _ such ascent .",
    "this ascent must be covered by an interval @xmath615 $ ] where @xmath616 and @xmath617 for some @xmath771 since @xmath761 is not a join - irreducible element in @xmath407_{\\sigma}$ ] . whether the letter @xmath762 appears before or after @xmath784 in @xmath766",
    ", we obtain a contradiction , by either finding an ascent in the substring @xmath785 to the right of the supposedly rightmost ascent in @xmath783 , or we find a descent in @xmath786 in contradiction to the substring @xmath685 not containing any descents .",
    "assume that @xmath407 $ ] is irregular .",
    "then there is an @xmath787 such that @xmath711 and the block @xmath716 of @xmath160 in @xmath8 is not equal to the block @xmath788 of @xmath160 in @xmath106 .",
    "the goal is to construct an enumeration of all maximal chains of @xmath407 $ ] using steps  13 after the statement of the theorem such that no maximal chain contributes a critical cell according to theorem  [ t_bh1 ] .",
    "the only undetermined place in steps  13 concerned the choice of linear extension of the join - irreducible elements of @xmath407_\\sigma$ ] .",
    "let @xmath489 be an arbitrary permutation such that @xmath8 and @xmath106 are @xmath489-compatible .",
    "it suffices to find a @xmath789 which satisfies the criteria given in lemma  [ l_nocrit ] .",
    "list the elements @xmath790 , in this order .",
    "the elements of @xmath716 and @xmath788 form sublists of consecutive elements : @xmath791 and @xmath792 , for some @xmath793 , where @xmath794 and @xmath795 , and where the intersection of the intervals @xmath615 $ ] and @xmath796 $ ] is not empty since @xmath797 .",
    "thus , since @xmath798 , one of the following four situations arises :    @xmath799 . in this case , we have @xmath800 but @xmath801 .",
    "thus , @xmath802 , while @xmath663 is contained in @xmath106 , without being contained in @xmath8 .",
    "similarly , @xmath803 is contained in @xmath106 , without being contained in @xmath8 .",
    "we set @xmath804 .",
    "@xmath805 . in this case",
    ", we have @xmath806 but @xmath807 .",
    "thus , @xmath808 , while @xmath809 is contained in @xmath106 , without being contained in @xmath8 .",
    "similarly , @xmath752 is contained in @xmath106 , without being contained in @xmath8 .",
    "we set @xmath810 .",
    "@xmath811 and @xmath812 . in this case",
    ", we have @xmath813 but @xmath814 .",
    "thus , @xmath815 , while @xmath816 is contained in @xmath106 , without being contained in @xmath8 .",
    "similarly , @xmath817 is contained in @xmath106 , without being contained in @xmath8 .",
    "we set @xmath818 .",
    "@xmath811 and @xmath819 . in this case",
    ", we have @xmath820 but @xmath821 .",
    "thus , @xmath822 , while @xmath823 is contained in @xmath106 , without being contained in @xmath8 .",
    "similarly , @xmath824 is contained in @xmath106 , without being contained in @xmath8 .",
    "we set @xmath825 .",
    "we may therefore apply lemma  [ l_nocrit ] to conclude that there is an enumeration of the maximal chains of @xmath407 $ ] such that , by theorem  [ t_bh1 ] , there are no critical cells contributed by the associated morse matching . consequently ,",
    "by theorem  [ thm : forman ] , the order complex @xmath475\\setminus \\{u , v\\})$ ] is contractible .",
    "this project started in 1996 during the authors stay at the mathematical sciences research institute , berkeley , during the combinatorics program 1996/97 , organized by louis billera , anders bjrner , curtis greene , rodica simion , and richard stanley .",
    "it was completed while the first author was on reassignment of duties from unc charlotte , enjoying the hospitality of the university of vienna in spring 2009 ."
  ],
  "abstract_text": [
    "<S> bipartitional relations were introduced by foata and zeilberger in their characterization of relations which give rise to equidistribution of the associated inversion statistic and major index . </S>",
    "<S> we consider the natural partial order on bipartitional relations given by inclusion . </S>",
    "<S> we show that , with respect to this partial order , the bipartitional relations on a set of size @xmath0 form a graded lattice of rank @xmath1 . </S>",
    "<S> moreover , we prove that the order complex of this lattice is homotopy equivalent to a sphere of dimension @xmath2 . each proper interval in this lattice has either a contractible order complex , or it is isomorphic to the direct product of boolean lattices and smaller lattices of bipartitional relations . as a consequence </S>",
    "<S> , we obtain that the mbius function of every interval is @xmath3 , @xmath4 , or @xmath5 . </S>",
    "<S> the main tool in the proofs is discrete morse theory as developed by forman , and an application of this theory to order complexes of graded posets , designed by babson and hersh .    </S>",
    "<S> research partially supported by the austrian science foundation fwf , grants z130-n13 and s9607-n13 , the latter in the framework of the national research network  analytic combinatorics and probabilistic number theory \" ] </S>"
  ]
}