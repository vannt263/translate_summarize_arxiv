{
  "article_text": [
    "galaxy clusters continue to play a prominent role in our desire for precision cosmological measurements .",
    "clusters inform us about cosmology through their abundance and spatial clustering , both of which are sensitive probes of the universe s matter density and the growth of structure due to gravity .",
    "precision cosmological inference using clusters is only possible when we measure their characteristics as a function of mass @xcite .",
    "cluster mass can not be directly observed , but its presence is visible through the gravitational potential , which can be quantified using the lensing of background galaxies ( weak or strong ) , via the surface brightness and temperature of the intracluster medium to infer gas mass in hydrostatic equilibrium , through the maximum escape velocity surface traced by phase - spaces of the cluster galaxies , as well as through the jean s equation @xcite .",
    "there are also indirect cluster mass estimation techniques , such as the x - ray gas temperature or luminosity , the sz decrement from the scattering of the background cmb photons , the velocity dispersion , and cluster richnesses @xcite .",
    "there is ongoing research to understand and control statistical and systematic uncertainties in the techniques of cluster mass inference using direct measures of the potential .",
    "direct measurement of cluster potentials often requires a significant amount of data per cluster , whether it is the number of background galaxies for weak lensing shear profiles , x - ray photons for gas mass profiles , or spectroscopic galaxies for radius - velocity phase - space analyses .",
    "there are numerous studies which utilize simulations of idealized datasets to characterize statistical and systematic errors in direct potential measurements of individual clusters @xcite .",
    "another way to constrain uncertainties is to compare two different measures of the potential ( _ e.g. , _ * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    in reality",
    ", the quantity and quality of data quickly becomes prohibitively expensive for large samples of clusters or for faint and small clusters ( e.g. , low mass and/or distant ) . to counter the lack of data , stacking is often employed as a way to raise the signal - to - noise for an ensemble of clusters .",
    "stacking also has the benefit of homogenizing the projected shapes in order to reduce the bias from spherically - fit profiles to non - spherical systems .",
    "however , stacking can just as easily induce new systematic biases .",
    "for example , @xcite showed how the stacked sz signal can have significant systematic biases if the optical cluster sample selection is not correctly characterized .",
    "@xcite used the pairwise velocity dispersion ( a form of stacking ) to quantify the scatter in the dispersion at fixed richness for clusters in the sloan digital sky survey data and in simulations .",
    "they recognize that the resulting stacked dispersion must be treated as non - gaussian to avoid biases in the result .",
    "other recent studies examine how accurately stacked ensembles can infer the potential through the jean s equation , as well as the presence of cluster shape - induced biases using both phase - space and weak lensing observables @xcite    here , we study how to conduct a stacked analysis using cluster projected phase - spaces and the caustic technique to infer the escape velocity masses @xcite . merging individual phase - spaces into an ensemble cluster",
    "increases the signal - to - noise of the caustic feature used to estimate the mass profile .",
    "this work extends upon @xcite , who used particle data in simulations to constrain the minimum and maximum caustic mass biases caused by line - of - sight projections of the cluster phase - spaces .",
    "the @xcite result is related to what was found by @xcite , who used weak lensing stacking and incorporated realistic cluster selection on galaxy catalogs . in both cases ,",
    "cluster shape is shown to play an important role in ensemble cluster mass estimation .",
    "what have yet to be fully investigated are the baseline accuracy of the caustic technique on stacked phase spaces , how to build ensembles clusters , and the effects of mass scatter in the binning process .",
    "the caustic technique has been applied to stacked systems in observations before .",
    "@xcite stacked 43 poorly sampled clusters with galaxies out to @xmath3 and used both the caustic technique as well as a jeans analysis to recover an average mass profile and found good agreement between the two methods .",
    "@xcite created an ensemble cluster based on nine clusters in the cairns survey . unlike other studies ,",
    "each of the included systems was sampled well enough to obtain individual measurement of velocity dispersion and @xmath4 .",
    "they chose to scale their velocities by each system s velocity dispersion before stacking , and doing so , found agreement to within @xmath5 of the theoretical expectation of @xmath6 .",
    "our focus in this paper is to test the caustic technique s ability to recover the average stacked ensemble mass and the average ensemble uncertainty for different stacking strategies .",
    "we pay particular attention to the stacking algorithms , and we use realistic simulated galaxy data with projection effects that mimic what is seen in the local universe ( @xmath7 ) .",
    "we test whether the act of stacking induces an intrinsic bias by developing a new self - stacking technique (  [ sec : self_stacking ] ) .",
    "once the algorithm is verified , we build ensemble clusters to study how sampling rates affect the accuracy and precision of the stacked cluster masses (  [ sec : massbinstack ] ) .",
    "finally , we use a mass - observable relation to incorporate correlated scatter into our ensemble clusters and we measure the resultant biases from mass mixing across the bin boundaries (  [ sec : observablestack ] ) .",
    "in this study , we utilize the @xcite semi - analytic galaxy catalog and the millennium simulation @xcite .",
    "semi - analytic galaxy catalogs are built using a set of  rules \" for evolving galaxies inside identified subhalos in an n - body simulation .",
    "subhalos are defined and located using algorithms such as subfind @xcite which have been shown to work well to identify all of the sub - structure in n - body simulations ( see also * ? ? ?",
    "the semi - analytic model captures the history of position , velocity , size , and merger history of these subhalos and applies its rule set to transform these properties into galaxy mass , circular velocity , accretion rate , and other physical parameters that can , in theory , be observed .",
    "semi - analytic galaxy catalogs can be compared with observed luminosity functions of galaxies to judge their success .    the millennium database contains four different semi - analytic catalogs .",
    "one way the catalogs differ is in the way they treat  orphan \" galaxies , or semi - analytic galaxies whose host subhalo was destroyed in the simulation .",
    "orphan galaxy treatment is necessary since subhalos are too easily destroyed in n - body simulations due to limited resolution . to combat this ,",
    "once a subhalo is destroyed , the semi - analytic galaxy lives on for a time following the most bound particle of the destroyed subhalo .",
    "dynamical friction arguments are applied to determine the time the orphan galaxy exists in the simulation .",
    "@xcite studied these semi - analytic catalogs and found the guo catalog galaxy cluster velocity dispersion and mass estimates to be near the average of the catalogs and unbiased using a set of assumptions for mass estimation .    in sections",
    "[ sec : self_stacking ] and [ sec : self_stacking_r ] our sample contains 20 clusters from the guo semianalytic catalog at redshift = 0 for which we have 3-dimensional position and velocity information .",
    "these clusters are located within the central @xmath8 mpc of the @xmath9 mpc per side simulation box .",
    "this allows for long lines - of - sight to each system of at least @xmath10 mpc .",
    "long lines - of - sight are necessary to build phase spaces with similar projected interloper properties of clusters at low redshift .",
    "the remaining sections utilize the henriques all - sky light cone @xcite to study stacking independent clusters .",
    "this sample consists of @xmath11 clusters that span a mass range of @xmath12 .",
    "the redshift range is selected to be between @xmath13 to mimic shallow - wide surveys .",
    "this large sample allows us to test for systematics over a large cluster mass range . in all our analyses ,",
    "we assume a flat @xmath14cdm cosmology with @xmath15 , @xmath16 , and @xmath17 km s@xmath18 mpc@xmath18 .",
    "under newtonian dynamics , the escape velocity of a spherically symmetric cluster relates to its gravitational potential by @xmath19 where @xmath20 is the 3-dimensional measured distance to the center of the cluster . if the dynamics of the system are controlled by the gravitational potential , galaxies which can not escape the potential exist in a well - defined region of radius / velocity @xmath21 phase space .",
    "the extrema of the velocities in this phase space define an edge , the escape velocity profile @xmath22 , which can also be observed directly with 3 dimensional position and velocity information , or estimated using projected sky coordinates and line - of - sight velocities as @xmath23 .",
    "given the observed @xmath23 , the escape velocity or ",
    "caustic \" technique allows one to infer the mass profile of a cluster to well beyond the virial radius @xcite .",
    "once the escape velocity surface is identified , the equation @xmath24 calculates the mass within the radius @xmath25 where @xmath26 is the observed ( projected ) escape velocity profile and @xmath27 is a function which depends on the density , the potential , and the projected anisotropy profile .",
    "it is usually approximated as a constant and calibrated through simulations .",
    "@xcite quantify how well the average calibration constant , @xmath27 , can be determined for individual systems .",
    "these calibrations involve choosing the correct `` surface '' to prescribe as tracing the projected escape velocity and in defining a value for @xmath27 .",
    "as discussed in detail in @xcite , the constant @xmath27 is derived as a function of the dark matter density ( @xmath28 ) and potential ( @xmath29 ) profiles , as well as the galaxies velocity anisotropy profile @xmath30 .",
    "analytically , @xmath31 is expressed as : @xmath32 considering density profiles of halos and clusters in simulations can be modeled in the functional form defined by @xcite , we can reduce equation [ eqn : fbeta ] to @xmath33 where @xmath34 and @xmath35 such that @xmath36 is the nfw scale radius .",
    "the nfw profile is not the only parametrization of the density found in literature .",
    "for example , the  einasto profile \" @xcite has been shown to be a better fit to the density profiles outside the virial radius of clusters @xcite .",
    "@xcite uses a different functional ( a generalized jaffe profile ) which , like the einasto profile , models a steeper density profile outside the virial radius as compared with the nfw functional form . due to close similarities between the generalized jaffe profiles and the einasto profiles , we focus on results from the nfw and einasto parametrizations .",
    "@xcite and @xcite approximate the radial average of equation [ eq : avgfb ] as a constant ( @xmath27 ) out to 2 - 3@xmath37r@xmath38 , noting that its value varies slowly with radius . when defined as a constant over some range in radius , @xmath27 acts as a caustic mass calibrator , which depends weakly on variations in concentration and the radially averaged velocity anisotropy @xmath39 .",
    "there is some debate in the literature about the value of @xmath27 , with values ranging from 0.5 - 0.7 @xcite .",
    "nominally , this term resides within the integral in equation [ eq : caustic_eq ] and so the correct value is determined through its nearly constant radial average . as shown in @xcite and @xcite , large variations in concentration and @xmath39 lead to small variations in the @xmath27 and caustic masses ,",
    "so these are not the source of the wide range in accepted @xmath27 values . instead , @xcite",
    "show that the differences can mostly be attributed to the use of different dynamical tracers ( i.e. , velocity bias ) , which enters into the technique when the surface is determined , i.e. , equation [ eq : caustic_eq ] , which is derived by requiring equation [ eq : escape_newton ] .",
    "all caustic analyses on clusters utilize a surface calibration based on @xcite , who show that @xmath40 where @xmath41 and @xmath42 are the total mass and potential energy of the system respectively .",
    "if the system is in virial equilibrium , @xmath43 , where the total kinetic energy @xmath44 , then we can identify the escape velocity profile by choosing the iso - density contour in phase - space that satisfies the equation @xmath45 if @xmath46 is calculated using biased dynamical tracers , the inferred @xmath23 will also be biased .",
    "this can be compensated for by calibrating @xmath27 to recover unbiased masses .",
    "it is not necessary that @xmath27 be treated as a free - parameter to calibrate unbiased cluster masses against simulations @xcite . utilizing density - potential pair equations for either the nfw or einasto profiles @xcite and assuming some value for the radially averaged anisotropy parameter @xmath39",
    ", one can calculate @xmath27 from equation [ eq : avgfb ] or [ eq : avgfb_nfw ] directly , so long as one is given a cluster mass .",
    "we use @xmath4 and @xmath25 from our simulated cluster sample along with the concentration - mass relation from @xcite to analytically model the nfw density and potential profiles given each cluster s mass and inferred concentration .",
    "the einasto density profiles are derived by fitting to the analytic nfw density profiles within @xmath25 @xcite . finally , we model the anisotropy as a constant inside @xmath25 with @xmath47 @xcite .",
    "marginalizing over all uncertainties in @xmath48 and @xmath39 results in a suite of @xmath31 profiles for each parametrization that can be radially averaged into the constant @xmath49 per cluster .",
    "we use all of the clusters to find a median value of @xmath50 within @xmath25 assuming an nfw profile and @xmath51 when using the einasto profile .",
    "we emphasize that the values for @xmath27 are not from fits to any data , but are the result of models given the list of cluster @xmath4s and @xmath25s .",
    "@xcite utilize numerically evaluated potentials , which they show are @xmath52 lower than the potentials expected from the nfw density profile via the poisson equation .",
    "the challenge in this approach is to carefully match the potential in equations [ eq : avgfb ] or [ eq : avgfb_nfw ] to the escape surface .",
    "this is because equation [ eqn : surface ] requires that the density and potential profiles be poisson pairs @xcite .",
    "the @xmath52 difference between our value of @xmath27 = 0.63 and the value in @xcite of @xmath27 = 0.7 is explained through our use of a poisson potential ( with potential relative to infinity ) and @xcite use of a numerical potential ( with potential relative to 10mpc ) , given that the average densities are the same .",
    "we have explored other possibilities such as radial and mass dependencies of @xmath27 and find they account for differences of a few percent .",
    "taking all of these issues into account , we conclude that the literature values of @xmath27 are quite consistent ( @xmath53 ) between techniques which utilize equations [ eq : avgfb ] or [ eq : avgfb_nfw ] ( _ e.g. , _ * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and techniques which calibrate it to individual systems using @xmath14cdm simulations ( _ e.g. , _ * ? ? ?",
    "* ; * ? ? ?",
    "another challenge when using stacked ensemble clusters and the caustic technique is in the surface calibration ( e.g. , equation [ eqn : surface ] . ) as shown in @xcite and as we highlight below , the velocity dispersion of a stacked phase - space is a biased representation of the mean of the underlying velocity dispersion .",
    "therefore in  [ sec : esc_method ] , we develop a new technique to calibrate the escape - velocity surface which leverages the high sampling of the stacked phase - spaces .",
    "the caustic technique is an estimate of the projected escape velocity profile such that the caustic profile @xmath54 and the potential profile @xmath55 ( in the definition of @xmath27 ) must be equal . as the name suggests , the caustic should be a sharp density drop - off in the cluster projected phase - space ; however , with a sampling of even 100 galaxies inside the virial radius it is difficult to identify this edge by eye , let alone algorithmically .",
    "this challenge has been overcome by identifying cluster members , measuring the cluster velocity dispersion , and using a virialization condition to calibrate the caustic surface based on a series of measured iso - density contours @xcite .",
    "this step makes caustic mass estimates of individual clusters possible without the need to visually identify a sharp edge in projection .",
    "the downside of using equation [ eqn : surface ] is that we add an additional assumption to our methodology : that the stacked line - of - sight velocity dispersion represents an average of the individual dispersions . in velocity space , stacking is analogous to mixing semi - randomly sampled gaussians if each cluster s velocity dispersion is approximately normal . on average",
    ", the resulting stacked distribution will have a velocity dispersion that is larger than the mean of the individual dispersions , or @xmath56 .",
    "we show this by simulating draws from mixed gaussian distributions and reporting the log difference between the dispersion of the sample and the average dispersion of the input gaussian population .    in figure",
    "[ fig : mixture_bias ] , we simulate the expected bias for typical observational values of 20% scatter in @xmath57 , 15 random samples per gaussian , and 50 gaussians per stack in 1000 experiments .",
    "the result is an expected velocity dispersion bias of 3 - 5% ( left figure ) .",
    "this does not include a potential background interloper population uniformly distributed in velocity space that would work to increase this bias .",
    "@xcite find an interloper fraction of 18 - 25% when using sigma - clipping techniques on randomly chosen dark matter particles ; however , we expect our values to be lower given our more complex shifting - gapper approach which also utilizes magnitude information @xcite .",
    "we re - quantify the velocity dispersion bias when 10% of the galaxies are drawn from a uniform background population in velocity space .",
    "we find that the bias increases to @xmath52 .",
    "the translation from velocity dispersion bias to mass bias in the caustic technique is complicated and discussed further in  [ sec : massbinstack ] .    given the expected velocity bias in our ensemble clusters and our goal to remove the virial condition from the technique , we wish to eliminate the use of equation [ eqn : surface ] altogether .",
    "we can do this through a direct identification of the caustic surface in highly sampled phase - spaces .",
    "stacking allows us to overcome the lack of signal in the cluster projected phase - spaces and identify a caustic edge , despite projection blurring effects .",
    "using the radius / velocity phase - space , we identify iso - density surfaces based on medians of velocity percentiles in the radially binned velocity distributions using a mirrored phase - space ( see * ? ? ?",
    "interloper rejection is done in two phases .",
    "first , a shifting - gapper algorithm is run to eliminate obvious outliers in the phase - spaces ( see * ? ? ?",
    "* ) . however , because our phase - spaces are densely populated , we also make cuts in velocity based on smoothed phase - space density . in each radial bin",
    ", we make a cut in absolute velocity where the smoothed density reaches the estimated background density which differs from stack - to - stack .",
    "this usually occurs between 2 - 3@xmath37 the velocity dispersion in each radial bin .",
    "once we have removed potential interlopers , instead of using equation [ eqn : surface ] we use the analytically calculated einasto potential profiles to calibrate the correct iso - density contour selected by velocity percentile . we find that the iso - density contour matched to the median of galaxies with velocities above the @xmath5890th percentile ( within radial bins @xmath59 of the ensemble ) recovers the mean einasto potential profile for each ensemble .",
    "this new surface calibration technique is independent of mass and sampling , at least for the systems in our data set .",
    "most importantly , this algorithm ensures that our caustic surface matches the analytic potential , as required in equation [ eq : caustic_eq ] .    as a result of projection effects",
    ", the nfw surface calibration is very similar to the einasto profile and is within one percentile of the 90th percentile chosen above .",
    "we note that while the nfw escape velocity profile is slightly higher than the einasto profile for a given stacked cluster , the smaller @xmath60 as compared with @xmath61 balance out in equation [ eq : caustic_eq ] which creates nearly identical results of bias and scatter as presented in ",
    "[ sec : stacking ] when using the einasto profile .",
    "we note that miller et al .",
    "( 2016 ) showed that the einasto and the generalized jaffe density - potential pairs perform nearly identically well , and so we can surmise that this calibration holds for at least three popular potential - density poisson pairs .    unlike serra et al .",
    "( 2011 ) who utilize numerical potentials determined from particle information on individual clusters , we use an analytical representation of the potential and pay strict attention to the @xcite framework to infer caustic surfaces in stacked phase - spaces . since our analysis is based upon a semi - analytic representation of the galaxies in a light - cone simulation , we can not numerically evaluate the projected particle - based potential - density pairs .",
    "our emphasis on the einasto profile has several advantages .",
    "first , it ensures a true density - potential pairing @xcite .",
    "second , the einasto , like the nfw , is a well - known representation of the average ( or stacked ) density profile of collapsed halos to @xmath25 @xcite .",
    "third , the einasto profile may actually provide better fits to the density and potential profiles both inside and outside the virial radius of galaxy cluster size halos @xcite .",
    "fourth , the einasto profile has been tested observationally ( sereno et al .",
    "2016 , stark et al .",
    "however , we caution that other potential - density pair representations of the cluster profiles may do a better job than what we find for the einasto .    at the same time",
    ", our emphasis on the einasto ( or any ) analytical representation has its own pitfalls .",
    "while the einasto profile is a good fit to simulated and real mass density profiles of clusters , this obviously may not translate to observed dark matter halos .",
    "likewise , if a cluster sample is dominated by non - virialized systems , parametrizations like the einasto and the nfw are certainly not appropriate , since they were both constructed against collapsed ( or virialized ) systems .    in figure",
    "[ fig : stacked_phase ] , we show a stacked cluster projected phase - space from our simulations .",
    "the stack is built by sampling the top 50 brightest galaxies from the most massive 100 clusters in the sample .",
    "the red line shows the caustic edge selected using line - of - sight velocities above the 90th percentile of observed velocities across 6 radial bins within the @xmath62 of this ensemble .",
    "this is compared with the analytically calculated @xmath63 ( solid black line ) and the nfw equivalent ( dashed black line ) using the average properties of the system .",
    "the difference between the model nfw and einasto escape velocity edge is small , and switching between the two models changes the inferred precentile by less than a percent .",
    "however , the einasto result matches what is expected by a direct calibration of @xmath27 @xcite .",
    "the blue band encompasses the 68% distribution of the individual caustic profiles estimated for each input cluster to the stack using the velocity dispersion to calibrate each caustic surface .",
    "because these massive clusters have high sampling , the individual surfaces agree with the stacked surface within the scatter .    in  [ sec : stacking ] , we test the ability of stacking to recover the average cluster mass in stacked ensemble phase - spaces by adjusting the number of galaxies per cluster and the number of clusters used in stacking .",
    "we will also study how the cluster binning procedure affects the stacked mass estimates .",
    "in sub - sections [ sec : self_stacking ] , [ sec : massbinstack ] , and [ sec : observablestack ] we investigate and quantify the overall systematic uncertainties when using stacking cluster projected phase - spaces and our revised caustic technique to estimate average masses . in  [ sec : self_stacking ] we introduce a way to stack single clusters in order to test the fundamental basis of our algorithm .",
    "we then introduce mass - mixing to our stacking procedure in  [ sec : massbinstack ] by creating ensembles of clusters through binning directly on mass . finally in ",
    "[ sec : observablestack ] , we build cluster ensembles using a mass proxy : the projected richness estimates of each cluster which has realistic scatter .      stacking cluster phase - spaces first requires a decision on how to  bin \" or stack on cluster properties .",
    "ideally , we first stack clusters of identical mass ( and concentration ) in order to eliminate the overall mass - mixing in each bin .",
    "this allows us to test for any potential systematic biases in the technique itself .",
    "however , this task is difficult .",
    "ideally , one needs multiple realizations ( or re - simulations ) of the same cosmology in order to achieve enough statistics without binning .    to solve this problem for our sample of clusters based in the millennium simulation ,",
    "we devise a technique that stacks cluster projected phase - spaces with mass bins of infinitesimal width .",
    "this is achieved by stacking multiple lines - of - sight to one cluster in order to build a stacked phase - space .",
    "we term this technique self - stacking .",
    "the inferred stacked masses are then compared to a single well - defined mass to identify biases in the technique .",
    "technically , self - stacking mimics stacking different individual systems .",
    "we treat each line - of - sight projection to a single cluster as a unique observation which , when stacked with @xmath64 random projections , produces an ensemble phase - space that we use to identify the caustic profile .",
    "the exact steps are as follows :    1 .",
    "@xmath64 random lines - of - sight to a cluster are chosen , the galaxies are projected to create @xmath64 radius - velocity projected phase - spaces .",
    "@xmath65 galaxies are chosen randomly from the top @xmath66 brightest galaxies projected within the virial radius of the cluster in each phase - space . the @xmath65 brightest galaxies are chosen randomly to avoid artificial structure in the projected phase - space due to using the same cluster .",
    "3 .   the stacked phase - space will contain the combined projected positions and velocities of @xmath67 galaxies .",
    "the caustic profile is identified and mass estimated for each stacked system .",
    "how we choose @xmath65 from the top @xmath66 galaxies is carefully considered .",
    "there are several ways to achieve a desired sampling .",
    "first , along each line - of - sight to a cluster , galaxies can be rank ordered by a chosen magnitude ( e.g. sdss r - band ) and the brightest galaxies are selected only from the top of the list ( @xmath68 ) .",
    "this method s advantage lies in its closeness to realistic spectroscopic follow - up .",
    "usually , the brightest galaxies in any given field are given preference in spectroscopic surveys for practical purposes in observation and reduction .",
    "the problem with sampling the same bright galaxies during the self - stacking process in simulations is the repeated measurements along different lines - of - sight . due to the simple projection geometry , a single galaxy s projected distance from the cluster center changes very slowly as the observer s line - of - sight to the cluster shifts .",
    "if the observer plots the cluster projected phase - space position of a single galaxy for many different random lines - of - sight , the phase space will show strong vertical structure bounded by a maximum in projected distance equal to the 3d distance from the galaxy to the cluster center .",
    "when sampling many galaxies per line - of - sight , this artificial structure can heavily influence the phase space density , and consequently , the iso - density contour that defines the caustic profile .",
    "ultimately , this leads to non - physical phase - spaces .",
    "another method of selecting galaxies along different lines - of - sight also requires sorting the galaxies brighter than some magnitude limit to create a list @xmath66 .",
    "however , instead of always taking the @xmath65 brightest galaxies from each line - of - sight , a fraction of the sorted list is selected in a random fashion .",
    "for example , if we wish to select 10 galaxies along each line - of - sight to a cluster to be stacked into the final ensemble , we could randomly choose these galaxies from a list of the 100 brightest galaxies .",
    "this does not ensure complete uniqueness of galaxies in the final ensemble , but the frequency of repeated draws will become very low as @xmath69 .",
    "choosing the fractional difference between @xmath65 and @xmath66 using this method requires us to strike a balance . if we impose that the fraction be large ( @xmath70 ) , then there will be more artificial structure due to the repeated selection of galaxies like in the previous method . if instead we impose that the fraction be small ( @xmath69 ) , then galaxies will be randomly selected from a very large and therefore increasingly faint set of galaxies that may not be realistic for typical observed clusters .",
    "this can also increase the interloper - to - member ratio of galaxies in the phase - space which works to further blur the caustic edge in projection and increase the uncertainty in its position .",
    "the third possible way of selecting galaxies is to assure that no galaxy appears in more than one line - of - sight phase space in the self - stacking analysis . while realistic in mimicking stacking unique systems , it results in individual line - of - sight ( pre - stacked ) phase - spaces that are populated with nearly all faint galaxies .",
    "while no artificial structure exists in the stacked phase - space , we do not pursue this method .",
    "we decide to use the second method to select galaxies due to its lack of artificial sub - structure with a @xmath71 fraction of @xmath72 .",
    "the results of self - stacking represent an ideal scenario where the expectation mass equals the mass of the cluster being self - stacked .",
    "it is now possible to test whether the act of stacking multiple phase - space projections results in any biases . as we point out in section",
    "[ sec : caustic_tech ] , the stacked systems are close to spherically symmetric , and any observed biases are not due to cluster shape .",
    "we test the self - stacking performance by varying either the number of lines - of - sight @xmath64 stacked in phase - space or the number of bright galaxies @xmath65 we sample from each line - of - sight .",
    "for example , to achieve a similar stacked richness of @xmath73 , we can either stack @xmath74 each with @xmath75 or @xmath76 each with @xmath77 . in figure",
    "[ fig : ss_bias_scatter ] , we vary @xmath65 along the vertical direction and the @xmath64 in the horizontal direction .",
    "the color map represents the degree of bias ( left ) and scatter ( right ) in the recovered masses as compared with @xmath4 in the simulation .",
    "contours of constant @xmath78 are displayed and labeled as diagonal lines in the figure .",
    "of primary concern is the average degree of self - stacked mass bias relative to the mass of each halo as a function of @xmath64 and @xmath65 .",
    "we find the measured bias depends almost purely on @xmath78 and asymptotically approaches the input cluster mass when @xmath78 is large ( lower right of figure [ fig : ss_bias_scatter ] left ) . on average ,",
    "the stacks are unbiased to within @xmath79 of the input cluster mass when @xmath80 .",
    "the input cluster mass is defined as the sum of the masses of all dark matter particles in 3d space within @xmath81 for a given cluster .",
    "this holds even when the sampling per cluster is low ( @xmath58 10 - 15 galaxies ) and we expect a significant low bias on individual systems @xcite .",
    "we draw the conclusion that stacking multiple - phase spaces with individually unique velocity dispersions does not bias the mass inferred by the caustic technique .",
    "figure [ fig : ss_bias_scatter ] right shows how the self - stacked mass scatter depends on @xmath78 .",
    "when @xmath82 , the scatter decreases from @xmath83 as we increase the number of lines - of - sight included in each stack .",
    "this is approximately a factor of 2 less than the individual cluster mass scatter seen in @xcite .",
    "we conclude that the scatter in stacked mass primarily depends on the total stacked richness which increases along an upper - left to lower - right diagonal in the parameter space .      in the previous section ,",
    "we show that stacking projected phase - spaces from clusters of exactly the same mass does not result in a biased measurement of mass when the caustic edge is identified directly .",
    "however , this assumes the bins chosen to stack within are of infinitely small width in mass which is unphysical when stacking different clusters in simulations or observations . in an ideal scenario ,",
    "we would bin clusters on an observable that has negligible scatter with mass",
    ". this would be functionally equivalent to binning on mass itself .",
    "analytically , the expectation mass of each bin would then be @xmath84 where @xmath85 is the halo mass function , and @xmath86 when @xmath87 $ ] acting as a window function for each mass bin .",
    "we define our bins by sorting our clusters in mass , and require that each mass bin contain an equal number of clusters ( @xmath88 ) . we can then vary @xmath88 to study the effects of including more clusters in a stack .",
    "this is formally equivalent to varying @xmath64 in the self - stacking test described in section [ sec : self_stacking ] . following this procedure ,",
    "the width of our mass bins are related to our simulated cluster sample size and is not motivated by any observational or physical reason . as a consequence of keeping @xmath88 constant across all mass bins , the width of each mass bin will not be constant and adapt to the mass function of our sample . because we have many more low than high mass clusters , the low mass bins will be far narrower than the high mass bins .",
    "the simulated cluster masses ( @xmath4 ) range from @xmath89 - @xmath90 .",
    "when stacking different clusters in a mass bin , we can select the top @xmath65 brightest galaxies from each cluster that are projected within @xmath25 and are @xmath91km / s away from the cluster .",
    "this is similar to spectroscopic follow - up in practice where bright galaxies are usually observed with higher priority given a magnitude limited cluster survey . in observations , the number of bright galaxies will vary depending on both cluster size and redshift , but in this analysis we are able to set @xmath65 and test how mass scatter and bias depend on this trait .",
    "figure [ fig : bs_bias_scatter ] is similar to figure [ fig : ss_bias_scatter ] which shows the degree of bias ( left ) and scatter ( right ) for the mass stacking technique as compared with the average cluster mass in each ensemble .",
    "we measure these properties as a function of both @xmath65 and @xmath88 and find the trend follows total ensemble sampling ( @xmath78 ) that is nearly identical to the self - stacked experiment .",
    "we find that the stacked mass estimates become unbiased once @xmath92 , by which is in agreement with the self - stacking results .",
    "seen another way , figure [ fig : bs_bias ] shows the mass bias as a function of each ensemble s individual cluster sampling @xmath65 compared with results from @xcite .",
    "binning on 15 , 25 , 50 , and 100 clusters ( los ) are shown as red diamonds , orange hexagons , green squares , and blue triangles respectively .",
    "the black circles represent the results from @xcite who used 100 clusters in the same millennium simulation and measured the average bias for individual systems in using the @xcite semi - analytic galaxy catalog .",
    "we find that stacking works to remove the bias observed in individual systems .",
    "even when we only sample the brightest 15 galaxies per cluster , stacking 50 or more of these phase - spaces and measuring an ensemble caustic mass recovers the average mass to within 5% as compared with the original bias seen in @xcite of @xmath93 .",
    "the effects of low sampling can be seen when fewer clusters are stacked with @xmath94 as the method fails to identify the escape velocity edge .",
    "it is important to emphasize that the reduction in statistical bias for the poorly sampled ensemble clusters can not be replicated by averaging alone .",
    "`` ensembles '' based on averaging individual cluster caustic masses will reduce scatter , but will fail to remove the known sampling biases .",
    "stacked ensembles produce the high phase - space sampling required for accurate caustic masses and can work even when the individual per cluster sampling is low .",
    "in  [ sec : esc_method ] , we mention that the stacked estimate of the velocity dispersion is expected to be biased relative to the average of the true cluster velocity dispersions in each stack due to mixing gaussians .",
    "we test how these velocity dispersion biases translate to mass biases when using the stacked velocity dispersion to calibrate the stacked caustic surface . in our example in  [ sec : esc_method ] , we found average velocity dispersion biases of 3 - 10% depending on the interloper fraction of the stacked ensemble .",
    "we find this translates to an average stacked mass bias of @xmath95 when @xmath96 and @xmath97 to directly compare with our velocity dispersion example .",
    "if we increase the sampling per cluster to @xmath75 , the stacked mass bias increases slightly to @xmath98 .",
    "this confirms our hypothesis that using a biased velocity dispersion to calibrate our stacked caustic surface will return biased stacked masses compared with the average mass in each stack .",
    "we note that this level of uncertainty is similar to our uncertainty in @xmath27 ( see  [ sec : calib1 ] . )    in terms of precision , we find that the scatter in @xmath1 for ensemble clusters , decreases to 10% for ensemble clusters with only 15 galaxies per cluster and 100 clusters per ensemble or when @xmath92 .",
    "compare this to the results for individual systems , where the mass scatter is is 70% when only 15 galaxies are used to measure the caustic mass @xcite . for well sampled clusters and by using large cluster samples , one can achieve high precision mass estimates for ensemble clusters using the caustic technique ( i.e. , statistical uncertainties less than 5% ) .      in observations of real clusters",
    ", we must bin on cluster properties that correlate with mass . for optical surveys , examples of observables that act as mass proxies may include velocity dispersion , richness , or total luminosity .",
    "these observables often scale with mass through power law relationships that also include a degree of scatter .",
    "the relationship can be calibrated either in simulations or self - consistently in real observations , however , doing so requires an understanding of the scatter and uncertainty in the mass proxy measurement .",
    "scatter in mass - observable scaling relations are most commonly due to intrinsic variability and line - of - sight projection effects like non - spherical symmetry or contamination from interlopers and large scale structure .",
    "an example of intrinsic variability is two clusters of identical mass containing different richnesses of bright galaxies within their virial radii .",
    "this is a statistical scatter that will dominate if projection effects are minimal and represents an upper limit to the relationship s precision .",
    "however , scatter between mass and observables are mostly limited by line - of - sight effects .",
    "velocity dispersion is an excellent observable proxy of mass . in 3d ,",
    "the velocity dispersion at fixed mass exhibits a minimal scatter of 5% and is independent of cosmology @xcite . in projection",
    ", the scatter with mass can be as low as @xmath99 for highly sampled systems or as high as @xmath100 for systems with only a handful of spectroscopic members @xcite .",
    "scatter negatively affects our attempt to bin clusters based on these observable properties with the goal of closely binning on mass .",
    "clusters with a given mass are randomly scattered between observable bins as a result of scatter in the mass - observable relationship . because the mass function falls off sharply with mass",
    ", the up - scatter can particularly impact the high - mass bins by artificially increasing the number of clusters in those bins @xcite .",
    "this contamination between mass bins may affect the caustic mass estimates for each ensemble and bias the resulting stacked mass relative to the true observable - mass relation expectation .",
    "as described in @xcite , the average mass in a richness bin is modeled as @xmath101 where @xmath85 is the halo mass function and @xmath102 here , @xmath103 when @xmath104 $ ] per bin , and @xmath105 is the probability a cluster with mass @xmath41 has a richness @xmath106 .",
    "@xmath107 then equals the probability that a cluster of mass @xmath41 is observed within the richness bin controlled by @xmath108 .",
    "observable - mass relations with extremely tight scatter that limit the effects listed above do exist as tested in high - resolution nbody and gas dynamics simulations .",
    "@xcite found that the product of the gas mass and temperature observables ( @xmath109 ) show a remarkably low scatter of @xmath110 with @xmath111 .",
    "unfortunately , these observables are often not available for the majority of optically identified clusters .",
    "instead , we focus on optical observables such as cluster richness which is known to correlate tightly with mass . @xcite used sdss clusters to estimate the scatter on their matched - filter richness estimator ( @xmath112 ) and found @xmath113 log - scatter with @xmath4 for clusters with @xmath114 . in our simulations",
    ", we utilize a simple richness estimator for a background subtracted galaxy count within a projected aperture on the sky equal to @xmath25 .",
    "we estimate the background counts by sampling an area of sky 5x the cluster aperture , normalize by area , and take the difference from the cluster counts to measure @xmath106 .",
    "using the true values of @xmath4 in the simulation and comparing with our estimated values of @xmath106 , we measure a log - scatter in @xmath105 equal to 20% , which is realistic when compared to @xcite .",
    "this level of scatter in the mass - observable relation is also realistic for future spectroscopic surveys which measure spectroscopic members for tens of galaxies per cluster ( see section [ sec : discussion ] ) .",
    "we apply our estimates of @xmath106 to our stacking framework in a similar systematic fashion as ",
    "[ sec : massbinstack ] .",
    "the two variables of interest are the number of galaxies we sample from each cluster ( @xmath65)and the number of clusters we stack per bin ( @xmath88 ) .",
    "however , instead of building our stacks based on binning according to the true underlying cluster mass , we do so based on our optical richness observable .",
    "note that we do not use or require the use of the underlying mass - observable relation in the analysis .",
    "we measure the richnesses in a realistic fashion and build the ensembles directly on the observed richnesses .",
    "the comparison is then made between the ensemble caustic mass and the average of the true underlying halo masses for those same systems in each richness bin .    in figure",
    "[ fig : mm_bias_scatter ] ( left ) we present how the sampling and mass - scatter affect the stacked caustic mass bias for different types of sampling and binning relative to the results in figure [ fig : bs_bias_scatter ] .",
    "we observe that , when binning on an observable with realistic scatter , the stacked caustic mass recovers the average mass of the stack with the same accuracy as our perfectly binned sample to within @xmath115 .",
    "this result indicates that modest scatter in the mass - observable relationship does not impact the stacked caustic technique s ability to recover average masses in each observable bin .",
    "the scatter between the ensemble mass estimates and the average mass per bin is also minimally affected . in figure",
    "[ fig : mm_bias_scatter ] ( right ) , we quantify the increase in scatter due to the increase in mass mixing in each observable bin . across the range of galaxy and cluster sampling per bin ,",
    "we see an increase in the scatter by @xmath58 5% when there exists scatter between the true mass and observational mass - proxy used to bin .",
    "overall , the minimum mass scatter reached for observable stacked ensembles is @xmath116 in highly sampled clusters using large cluster samples .    in figure",
    "[ fig : onetoone ] , we show one - to - one plots of average cluster mass vs the stacked mass per bin with @xmath97 in both panels .",
    "the left panel stacks are built by sampling @xmath96 per cluster , and the right panel stacks by sampling @xmath75 per cluster .",
    "as shown in @xcite , figure [ fig : onetoone ] should show a 40% negative bias if one used the individual cluster masses and averaged over the large sample of clusters .",
    "the stacked bias is smaller than 5% .    on the other hand it is possible for",
    "stacked ensemble estimates to fail and return erroneous values .",
    "these are the outliers in [ fig : onetoone ] .",
    "however , even when sampling only 15 galaxies per cluster , it happens rarely . with a modest degree of mass - mixing due to observable - mass scatter ,",
    "only a few percent of our stacked estimates are classified as  failed stacks \" .",
    "these outliers are in the low mass end where our interloper rejection fails . based on the low level of bias and scatter , combined with the lack of outliers in the stacked estimates",
    ", we can conclude that the stacking technique is robust to binning on a mass - proxy such as richness .      throughout this work",
    ", we have utilized a single simulated galaxy catalog based on a single underlying cosmological simulation @xcite .",
    "it is worth discussing how other mock galaxy prescriptions and other cosmologies might affect our results .",
    "previous authors have studied the issues of dynamical mass tracers and cosmology . for instance",
    ", @xcite showed that the 3d virial - to - mass scaling relation is independent of cosmology , based a comparison against a number of different cosmologies .",
    "the same can be said for the standard caustic technique , which is governed by the poisson equation and calibrated by the virial equation ( diaferio 1999 and section [ sec : caustic_tech ] ) .",
    "however , all of our measurements are made on projected data where the dominant concern for the surface calibration is the normalization of the power spectrum ( i.e. , @xmath117 , which sets the normalization on 8mpc scales ) .",
    "projected interlopers are the likely cause for additional systematic biases in the stacked surface measurement .",
    "for example , there are @xmath118 more clusters above @xmath119m@xmath120 when @xmath121 compared to @xmath122 .",
    "the additional clusters in a high @xmath117 universe could result in contaminated phase spaces , which in turn could change the percentile used to identify the stacked caustic surface .    as a final test , we conduct our entire analysis using the mice mock sky catalogs @xcite . like the millennium data",
    ", the mice data stems from a dark matter n - body particle simulation using gadget-2 .",
    "the cosmology used in the mice simulation is almost identical to that used in the millennium simulation ( @xmath123 for millennium and @xmath124 for mice ) .",
    "there are two key differences between the mice galaxy catalogs and the millennium galaxy catalogs .",
    "first , the normalization of the power spectrum in the mice simulations is @xmath125 while for the millennium it is @xmath121 .",
    "second , while the henriques et al .",
    "( 2012 ) light - cone is developed using a semi - analytic representation of galaxy formation and evolution , the mice light - cone mock galaxy catalogs are developed using a hybrid halo occupation distribution and halo abundance matching prescription to populate friends - of - friends dark matter halos .",
    "the details of how the galaxies are assigned to halos and how their magnitudes are prescribed in the mice version 1 simulations is discussed in @xcite .",
    "we then conduct the identical exercise on the mice - based data that we used to build the ensemble caustics as discussed in section [ sec : massbinstack ] for the millennium - based data .",
    "we use the surface calibration as determined from the millennium and presented in section [ sec : esc_method ] . note that there are significantly fewer massive halos in the mice catalog , due to the smaller areal coverage of only 1/8@xmath126 the total sky and the smaller power spectrum normalization .",
    "however , for most of the bins defined in figure [ fig : bs_bias_scatter ] , we can make a direct comparison .",
    "when comparing the stacking results from the mice to the millennium simulations , we find that the mean absolute deviation of the measured ensemble scatter between the millennium and the mice samples is @xmath127 . the mean absolute deviation of the measured ensemble bias between the millennium and the mice samples is @xmath128 .",
    "these small differences in the measured bias and scatter between the two simulations establish the baseline of the robustness of the caustic surface definition technique against large variations in astrophysical and cosmological variations .",
    "a more detailed study would require a significant number of light - cone mock galaxy catalogs constructed against a wider variation in the cosmological parameters .",
    "such data does not yet exist .",
    "measuring dynamical cluster masses when @xmath94 can result in statistical and systematic biases that make it impossible to self - calibrate mass - observable scaling relations through averaging @xcite . stacking works to eliminate statistical biases present in individual cluster observations by building an ensemble system with sufficient sampling to measure average properties of the stacked system .",
    "however , using stacking methods to infer the average properties of clusters can be a messy process that depends on prior decisions of how to bin , which observable to bin on , the cluster finder and survey used , etc .",
    "we have used halos in an all - sky light cone built on the millennium simulation @xcite to define a complete and pure , low redshift ( @xmath129 ) cluster sample .",
    "we then develop and characterize a caustic stacking technique to infer ensemble cluster masses .",
    "we find that the surface calibration in the caustic technique needs to be modified to avoid velocity biases .",
    "the standard virial - based surface calibration imparts a 5 - 10% statistical mass bias into the ensemble masses , which is similar to the the uncertainty on the caustic calibration term , @xmath27 . to solve this problem , we develop and test a new calibration of the caustic surface which leverages the well - populated ensemble phase - spaces .",
    "we evaluate our new stacking procedure in terms of bias and scatter for three scenarios : ( 1 ) an ideal situation where the mass of an ensemble cluster is perfectly known and defined by a single cluster ( self - stacking ) ; ( 2 ) when the mass of the clusters are known but the ensemble contains a distribution of cluster masses ; ( 3 ) when the mass of the clusters is inferred through a proxy with scatter and the ensemble is defined based on this proxy .",
    "this study should be viewed as a baseline ability of the stacked caustic technique to recover average cluster masses .",
    "the completeness , purity , and mis - centering of cluster finding methods may well influence the results presented here @xcite .    when creating the ensemble clusters , we vary the number of galaxies sampled per cluster and the number of clusters per bin .",
    "we find that the agreement between the stacked caustic estimate and the average true mass of the bin depends on the total sampling in the stacked cluster projected phase - space .",
    "once we achieve a level of sampling of @xmath130 tracers within the phase - space , our estimates are unbiased to within @xmath79 .",
    "the bias follows the iso - sampling contours very closely , implying that achieving precise stacked estimates depends solely on the total number of galaxies in the stacked phase - space .",
    "our tests also reveal that stacking results in very low mass scatter relative to the average cluster mass per bin : @xmath131 when our phase - space sampling is high ( @xmath132 ) .",
    "we incorporate mass scatter into the analysis through an observable mass proxy via cluster richnesses to demonstrate the effects of adding uncertainty to the binning process . when binning on richness , we are imposing a log mass scatter of 20% ( intrinsically built into the henriques et al .",
    "2012 mock galaxy catalogs ) .",
    "we find that the ensemble stacked caustics cluster masses can recover the underlying binned mass averages to within @xmath133 , matching the scenario where we assume no scatter between observable and mass .",
    "this accuracy is independent of cluster mass regardless of binning procedure .",
    "we find that the log scatter in the recovered masses increases by 5 - 10% ( see figure [ fig : mm_bias_scatter ] ) .",
    "cosmological constraints based on stacking observed data within bins based on the observable do not yet fully utilize the data . as an example",
    ", mass scatter plays an important role in the observed abundance function @xcite . by using the stacking techniques described here , in combination with individual caustic cluster masses , one could directly characterize the scatter and bias in mass using the data alone . in this paper",
    ", we show that caustic masses of ensemble clusters in projected data are both accurate and precise ( i.e. , within 5% in @xmath1 ) .",
    "this high level of accuracy and precision provides the means to measure the sample - wide statistical bias and scatter by directly using the individual cluster measurements and comparing to the stacked measurements .",
    "our efforts in this paper coincide with current surveys like the dark energy survey @xcite , the baryon acoustic oscillation survey and its extension eboss ( extendedboss is part of a program of post-2014 surveys on the sloan telescope ) , and the dark energy spectroscopic instrument @xcite .",
    "each of these surveys is providing ( or will provide ) a wealth of new photometric and spectroscopic data for clusters over a wide range of mass and redshift .",
    "these new data and the stacking techniques described here will enable precision stacked dynamical cluster mass estimates to redshifts @xmath134 for cosmological analyses @xcite .",
    "the authors made use of the flux high performance computing cluster at the university of michigan .",
    "the millennium simulation databases used in this paper and the web application providing online access to them were constructed as part of the activities of the german astrophysical virtual observatory ( gavo ) . the authors want to thank alejo stark , jessica kellar , and august evrard for their helpful comments and discussion .",
    "this material is based upon work supported by the national science foundation under grant no .",
    "1311820 and grant no ."
  ],
  "abstract_text": [
    "<S> ongoing and future spectroscopic surveys will measure numerous galaxy redshifts within tens of thousands of galaxy clusters . </S>",
    "<S> however , the sampling within these clusters will be low , @xmath0 per cluster . with such data </S>",
    "<S> , it will be difficult to achieve accurate and precise mass estimates for individual clusters using phase - space mass estimation techniques . </S>",
    "<S> we develop and test a new stacking algorithm based on the caustic technique , which reduces the mass scatter in @xmath1 for ensemble clusters from 70% for individual clusters to less than 10% for ensemble clusters with only 15 galaxies per cluster and 100 clusters per ensemble . with @xmath2 galaxies per ensemble phase - space , </S>",
    "<S> the escape - velocity edge becomes readily identifiable and the presence of interloping galaxies is minimized . </S>",
    "<S> we develop and test an algorithm to trace the projected phase - space surface directly , which results in minimally biased dynamical mass estimates . </S>",
    "<S> we then quantify how binning and sampling affect the phase - space - based mass estimates when using an observational proxy that incorporates realistic mass scatter , like richness , and find the added uncertainty in the binning procedure has minimal influence on the resulting bias and scatter of the stacked mass estimates . </S>"
  ]
}