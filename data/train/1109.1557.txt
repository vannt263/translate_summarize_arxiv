{
  "article_text": [
    "the discovery of a number of `` hot jupiters ''  extrasolar giant planets residing on very tight orbits  calls for understanding the dynamical pathways that brought these objects to their current orbits . due to the difficulty of forming these planets _ in situ _ , it was suggested that potential hot jupiter s form at larger separations from their stars and are subsequently transported inwards by some migration mechanism @xcite . in protoplanetary disks ,",
    "planets act as sources of nonaxisymmetric density waves ( * ? ? ?",
    "* ; * ? ? ?",
    "* hereafter gt80 ) , and coupling of planetary gravity to these waves acts to transfer angular momentum between the disk and the planet .",
    "this ultimately results in the orbital migration of embedded planets . at the same time",
    ", density waves generated by planets can affect the structure of the disk ( potentially leading to gap opening ) once the angular momentum that they carry is transferred to the disk material .",
    "thus , better understanding of t he density wave properties and processes of their excitation , propagation , and damping plays a crucial role in the global picture of planet formation .",
    "evolution of the density wave can be separated into the linear and nonlinear stages .",
    "the former applies to density waves excited by low - mass planets , which have not had enough time to propagate very far from their launching site ( a more precise condition is formulated in  [ sec : theory ] ) .",
    "the linear theory of disk - planet interaction was pioneered by ( * ? ? ?",
    "* gt80 ) who provided a description of the density wave excitation in two - dimensional ( 2d ) gaseous disks .",
    "this theory has been subsequently refined in various ways , e.g. by calculating the asymmetry of planetary interaction with inner and outer portions of the disk ( ward 1986 ) , and extending it to fully three - dimensional disks @xcite .",
    "these studies concentrated on understanding the behavior of perturbed quantities fourier decomposed in azimuthal angle @xcite , often addressing only the _ integral _ wave properties such as the total angular momentum carried by the waves , or the differential lindblad torque @xcite .",
    "only recently has the linear evolution of the wave properties in _ physical space _ , namely the spatial dependence of the perturbed fluid velocity and surface density , been addressed by ( * ? ? ? * hereafter gr01 ) in the local shearing sheet approximation .",
    "subsequently @xcite and @xcite studied the shape of the density wake in the global setting .",
    "this paved way for subsequent exploration of the nonlinear wave evolution ( gr01 , @xcite ) , understanding of which requires knowledge of the wave characteristics in physical space .    in parallel with these analytical and semi - analytical studies ,",
    "numerous attempts to verify linear theory by direct hydrodynamical simulations were made .",
    "however , the majority of these studies compared with theoretical predictions only the _ secondary _ or derived properties of the planet - disk system related to the density wave excitation and evolution .",
    "for example , in their simulations @xcite ,",
    "@xcite , @xcite , and @xcite measure the rate of planet migration due to its gravitational interaction with the disk  a quantity that is determined by the small difference between the summed ( over all azimuthal harmonics ) one - sided torques that the planet exerts on the inner and outer portions of the disk .",
    "other studies @xcite tried to measure the planetary mass at which a gap opens in the disk  a process that depends not only on the magnitude of the angular momentum carried by the waves but also on the intricate details of their dissipation . in both situations",
    "the verification of the linear theory ends up being rather indirect .",
    "it is certainly much more convincing and more robust to verify linear theory by comparing with its predictions the _ primary _ wave properties , such as the spatial distribution of the perturbed fluid properties derived from simulations .",
    "recently some effort in this direction has been made .",
    "in particular , @xcite investigated the distribution of the torque imparted by the planet on the disk as a function of radial distance .",
    "@xcite showed the spatial structure of the density perturbation associated with the wave obtained in their 2d simulations . unfortunately , in both cases no quantitative comparison with linear theory predictions was provided .",
    "in this work , we use 2d local inviscid hydrodynamical simulations in the shearing sheet geometry to verify the linear theory . for the first time we provide direct comparison of the primary physical variables",
    " perturbed surface density profile , torque density in both _",
    "physical _ and _ fourier _ space , and angular momentum flux  derived from simulations with the theoretical predictions .",
    "our verification effort is the most thorough , sophisticated and quantitative to date , and we achieve agreement with theory at the level of _ several per cent _ for all physical variables explored .",
    "in addition , using our numerical results we address some remaining issues in the linear theory , such as the different expressions for the torque density in fourier space ( gr80,@xcite ) .",
    "we also formulate a set of requirements which should be satisfied by simulations to reach convergence and to reliably reproduce the linear theory results .",
    "the way in which we make the comparison an d the agreement we achieve can serve as a standard for checking the performance of different codes .",
    "the paper is structured as follows .",
    "we briefly summarize the main results of the linear density wave theory in  [ sec : theory ] .",
    "a description of the code and our numerical setup are given in ",
    "[ sec : code ] , including a discussion of potential problems associated with implementing orbital advection algorithm in studies of the disk - satellite interaction .",
    "we present our numerical results and compare them with theoretical predictions in  [ sec : result ] , followed by the investigation of the sensitivity of simulation outcomes to the different numerical algorithms in  [ sec : parameters ] . in  [ sec : fargo ] we describe and discuss a commonly ignored numerical problem in disk simulations which if not handled appropriately can lead to incorrect results . finally , a summary is provided in  [ sec : summary ] .",
    "in linear theory of disk - planet interaction laid out in cylindrical geometry ( * ? ? ?",
    "* gt80 ) , the planetary potential is normally decomposed into a series of fourier harmonics . assuming all perturbed fluid variables to be proportional to @xmath1 $ ] ( @xmath2 is a positive integer ) and neglecting the self - gravity of the disk , one can obtain the dispersion relation for the @xmath2-th wave harmonic in the wkb limit in the form m^2",
    "^ 2=^2+k_r^2c_s^2 , [ eq : disp_rel ] where @xmath3 is the epicyclic frequency ( @xmath4 for a newtonian potential ) , @xmath5 is the wavenumber , @xmath6 is the fluid angular frequency , and @xmath7 is the pattern speed of the perturbation equal to the angular frequency of the point - mass perturber moving on a circular orbit with semi - major axis @xmath8 , that is @xmath9 . as eq .",
    "( [ eq : disp_rel ] ) demonstrates , there are two ( inner and outer ) lindblad resonances ( lr ) where @xmath10 and @xmath2-th harmonic of planetary potential couples best to the wave - like perturbation .",
    "these resonances are located at radii @xmath11 given by @xmath12 , which in the limit of @xmath13 results in @xmath14 where @xmath15 , @xmath16 is the vertical disk scale length , and @xmath17 .",
    "the superposition of all the harmonics with different azimuthal wavenumbers @xmath2 forms inner and outer spiral density waves . in physical space",
    "fluid perturbation associated with the wave is concentrated in narrow wake ( with azimuthal extent of order @xmath18 ) , the location of which is described in the local limit by ( gr01 ) y_w-(x ) , [ eq : wake_shape ] where @xmath19 and azimuthal angle @xmath20 is counted in the prograde sense ( with respect to planetary orbital motion ) .",
    "this location corresponds to the stationary phase of different fourier harmonics composing the wave , as can be easily seen from eq .",
    "( [ eq : disp_rel ] ) .",
    "the wake shape in the global setting accounting for cylindrical geometry of the disk and keplerian profile of @xmath21 was explored by @xcite and @xcite .",
    "each of the perturbation harmonics carries angular momentum flux , which for the @xmath2-th harmonic is given by ( gt80 ) . & & f_h(m)=f_h^wkb(m ) , [ eq : f_h ] + & & f_h^wkb(m)= ( ) ^2 ^ 2 .",
    "[ eq : f_h_wkb ] here @xmath22 is the unperturbed surface density of the disk , @xmath23 is the asymptotic fourier contribution of the flux reached beyond the launching region on one side of the disk calculated in the wkb approximation ( @xmath24 and @xmath25 are the modified bessel functions of zeroth and first order ) , and the expression is only accurate for @xmath26 . the ratio @xmath27 accounts for the difference between the precise value of @xmath28 and @xmath23 .",
    "this difference becomes important for @xmath29 since , as demonstrated by gt80 , @xmath28 decays exponentially with @xmath2 at high azimuthal wavenumbers  the so - called `` torque cutoff '' phenomenon . as a result , the total angular momentum flux carried by the wave f_h=_m=1^f_h(m ) 0.93(g m_p)^2 , [ eq : f_h_tot ]",
    "is dominated by harmonics with @xmath30 ( or @xmath31 ) , which are excited within a radial separation of order @xmath18 from the planet , see eq .",
    "( [ eq : resonance - position ] ) .",
    "this local nature of the wave excitation has important implications for the possibility of analytical treatment of the wave evolution .    in real protoplanetary disks , the torques acting on the inner and outer disks are slightly different ( fractional difference @xmath32 ) , giving rise to a net torque on the planet and leading to type i planetary migration @xcite .",
    "however , in shearing sheet configuration the inner and outer parts of the disk are identical so there is no net torque acting on the planet and migration does not arise .",
    "there is an important planetary mass scale characterizing excitation and propagation of the density waves , the so called _ thermal mass _ ( gr01 ) , which we define instead of @xmath33 . ] here as m_th=12  m_()^3 ( ) ^1/2 ( ) ^3/2 .",
    "[ eq : mth ] there are several reasons for the significance of this mass scale .",
    "first , a hill radius of the planet with @xmath34 is of order the scale height of the gaseous disk @xmath18 .",
    "second , the bondi radius @xmath35 , which is the size of a region in which planetary gravity strongly perturbs local pressure distribution , also becomes comparable to @xmath18 for @xmath34 ( rafikov 2006 ) .",
    "third , and most importantly for our present study , planets with @xmath36 generate density waves which are nonlinear from the very start ( @xmath37 ) .    in the small planet mass limit of m_pm_th[eq : limit ] perturbations induced by the planetary gravity",
    "are weak ( @xmath38 ) and _ excitation _ of the density wave by the planet can be studied purely in the linear approximation .",
    "it is in this limit that the linear theory of wave _ driving _ developed by gt80 and all of its results are valid . in the opposite limit of @xmath39 the nonlinear effects",
    "must be accounted for even at the stage of wave excitation , which is not feasible analytically .",
    "as mentioned above , the generation of the wave is largely completed at a distance of order @xmath18 away from the planet , because this is where the most important lindblad resonances lie .",
    "after that , in the absence of viscosity , the wave travels freely , no longer affected by the planetary gravity . at this stage of _ propagation _ nonlinear effects start to accumulate and finally result in wave breaking , formation of a shock , and transfer of wave energy and angular momentum to the disk fluid . prior to the steepening into a shock the angular momentum flux",
    "@xmath40 carried by the wave far from the planet ( outside of the excitation region @xmath41 ) is exactly conserved in the absence of linear dissipation .",
    "this nonlinear stage has been explored analytically in gr01 in the limit ( [ eq : limit ] ) .",
    "the numerical results on the nonlinear wave evolution will be presented in ( * ? ? ?",
    "* here after paper ii ) .",
    "we do not cover this stage in this work , but we mention the result of gr01 for the radial separation away from the planetary orbit at which the shock induced by the nonlinear effects first occurs : @xmath42 where @xmath43 is the adiabatic index of gas . for @xmath44",
    "one finds the shock to be well separated from the planet , @xmath45 , so that the wave excitation occurs in the linear regime , as asserted before .",
    "however , even for @xmath44 the linear theory of wave propagation fails for @xmath46 . in this work we are always exploring the low planetary mass limit ( [ eq : limit ] ) and",
    "consider only @xmath47 so that linear theory applies .",
    "most analytical work on the linear evolution of density waves was carried out in application to two - dimensional ( 2d ) disks . to provide a meaningful comparison with these studies , in our current work",
    "we employ 2d hydrodynamical simulations in local shearing box configuration .",
    "the computational tool for this investigation is athena , a grid - based code for astrophysical gas dynamics using higher - order godunov methods .",
    "athena is written in conservative form , so it conserves mass , momentum , and energy down to machine precision .",
    "the mathematical foundations of the algorithms are described in @xcite , and a comprehensive description of the implementation and tests of the algorithms is given in @xcite .",
    "the implementation of the shearing box approximation in athena is described in @xcite .",
    "this approximation adopts a frame of reference located at radius @xmath8 corotating with the disk at orbital frequency @xmath9 . in this frame , the 2d hydrodynamics equations are written in a cartesian coordinate system @xmath48 that has unit vectors @xmath49 , @xmath50 , and @xmath51 as @xcite : & & + * * ( ) = 0 , [ eq : cons_mass ] + & & + * * ( + p ) = _ p^2(2qx * * ) - 2_p * * - _ p , [ eq : cons_momentum ] + & & + ( e*v * + p ) = _ p^2 ( 2qx * * ) - _ p , [ eq : cons_energy ] where @xmath52 is the gravitational potential of the planet ( whose form we will discuss in the next section ) , @xmath53 is the gas pressure , @xmath54 is the total energy density ( sum of the internal and kinetic energy , but excluding the gravitational energy ) .",
    "the shear parameter @xmath55 is defined as : @xmath56 so that for keplerian flow @xmath57 .",
    "the equation of state ( eos ) we use in the simulations is the ideal gas law with @xmath58 where @xmath59 is the internal energy and @xmath60 .",
    "we also use an isothermal eos , in which case @xmath61 , where @xmath62 is the isothermal sound speed . we do not include explicit viscosity ( i.e. there is no explicit linear dissipation in the system ) and we do not account for the self - gravity of the disk ( thus we concentrate on studying the low mass disks ) .    to accurately resolve the flow in the vicinity of a gravitating mass without making the time step too short one usually resorts to softening the potential of the perturber .",
    "there are many ways of doing this but all of them come up with the form of the potential that converges to the newtonian potential @xmath63 at large separations @xmath64 , beyond the softening length @xmath65 . at small separations , @xmath66 smoothed potentials become finite allowing the time step of simulations to stay finite . to test the sensitivity of our results to the specific method of potential softening we tried three different forms of the softened planetary potential .",
    "the second order potential _",
    "m_p [ eq : phi2 ] converges to @xmath67 at @xmath68 as @xmath69 ( which means the fractional error is o@xmath70 as @xmath71 ) .",
    "this is a standard form of the potential used in a majority of numerical hydrodynamic studies .",
    "we also studied the fourth order potential _",
    "m_p [ eq : phi4 ] converging to the point mass potential as @xmath72 for @xmath68 , and the sixth order potential _",
    "m_p [ eq : phi6 ] converging to @xmath67 at @xmath68 as @xmath73 .",
    "the difference in accuracy with which these potentials represent @xmath67 at large @xmath74 can be quantified by the distance from the planet at which a given potential deviates from @xmath67 by @xmath75 .",
    "this distance is @xmath76 for @xmath77 , @xmath78 for @xmath79 , and @xmath80 for @xmath81 .",
    "note that the first - order potential @xmath82 , which we do not use here , gives only @xmath83 accuracy relative to @xmath67 even at @xmath84 , and we strongly discourage its use .",
    "the effects of different potential prescriptions will be discussed in detail in  [ sec : phip+rs ] .    to guarantee accuracy and convergence of our results we carry out an exhaustive exploration of various numerical parameters characterizing our simulations , described in ",
    "[ sec : parameters ] .",
    "unless noted otherwise , our results shown in  [ sec : result ] are obtained with the following numerical parameters : an isothermal equation of state , the roe solver with third order reconstruction in characteristic variables , and the corner transport upwind ( ctu ) unsplit integrator @xcite , a resolution of 256 grid points per scale length @xmath18 ( subsequently denoted @xmath85 for brevity ) , and fourth order accurate potential @xmath79 given by eq .",
    "( [ eq : phi4 ] ) with softening length @xmath86 .    high order of accuracy , high resolution and an accurate form of planetary potential used in our runs allow us to properly capture the details of wave evolution .",
    "high resolution ensures low levels of numerical viscosity and prevents the angular momentum accumulated by the wave from spurious dissipation ( see section [ sec : parameters ] for more discussion ) .",
    "we run a series of test simulations with otherwise identical conditions but different explicit navier - stokes viscosity , and measure the wave properties . as the explicit viscosity decreases the simulation results gradually",
    "converge to the one with zero explicit viscosity , which indicates the numerical viscosity dominates the explicit viscosity . for a typical simulation with low @xmath87 and an isothermal equation of state , the effective shakura - sunyaev @xmath88-parameter ( @xmath89 ) characterizing our numerical viscosity is found to be below @xmath90 .",
    "such small levels of viscosity are expected in dead zones of protoplanetary disks @xcite , where magnetorotational instability ( mri ) may not operate effectively @xcite .",
    "also note even when the mri operates , mhd turbulence may not act like a navier - stokes viscosity .    for the standard simulations in this work to fit the parabolic wake ( see eq .",
    "[ eq : wake_shape ] ) in the box we use box size @xmath91 , thus the overall grid resolution in our runs is about @xmath92 ( for the standard resolution of @xmath85 ) . in a few cases with very small @xmath93 , we extend the simulation box size to @xmath94 to trace linear wave evolution further out in @xmath95 , since smaller @xmath93 delays shock formation ( see eq .",
    "( [ eq : ls ] ) ) .",
    "our simulations are run for at least 10 and in some cases up to 50 orbital periods .",
    "figure [ fig : image ] presents a typical snapshot of one of our simulations showing the density structure and the spiral waves .",
    "we use the following boundary conditions ( bcs ) . on @xmath95 ( radial ) boundaries , we keep values of all physical variables in ghost zones fixed at their respective unperturbed keplerian values ( _ i.e. _ keep the ghost zones as their initial states ) , and the waves leave through the @xmath95 boundaries when they reach the edge . in our shearing sheet simulations , experiments show that this @xmath95 bc has less wave reflection and outflowing of the fluid than the conventional outflow @xmath95 bc , in which case the ghost zones are copied from the last actively - updated column of cells of the simulations at every time - step ( see also @xcite ) .",
    "we do not expect our adopted radial bc to affect wave evolution since significant radial fluid motions are not expected to arise in our simulations anyway .    on the @xmath96 ( azimuthal ) boundary , we experimented with two bcs : the conventional outflow bc , as described above , and an inflow / outflow bc . in the latter case ,",
    "the variables in the ghost zones are fixed at their initial values if they are the physical `` inflow '' boundaries ( the regimes @xmath97 and @xmath98 ) , or copied from the last actively - updated row of cells if they are the physical `` outflow '' boundaries ( the regimes @xmath99 and @xmath100 ) . for the purposes of current paper ,",
    "the difference between these two bcs is not significant and resultant density profiles and torque calculation are almost identical ( of the level of @xmath101 ) .",
    "we found that with the pure outflow bc fluid entering the simulation box accumulates some non - zero velocity perturbation on top of the pure linear shear velocity profile .",
    "this affects calculation of variables derived from the simulated velocity field , such as potential vorticity , which are analyzed in paper ii .",
    "we use the inflow / outflow @xmath96 bc for our simulations .    at the start of a simulation",
    "run we instantaneously turn on the potential of the planet in the center of the linearly sheared fluid flow with uniform surface density .",
    "this gravitational perturbation immediately excites an inner and an outer density wave propagating away from the planet , as well as strong transients : vortices that appear near the planet but travel on horseshoe orbits away from it . before measuring the wave properties ,",
    "we run simulations for @xmath102 orbital periods to let these time - dependent structures move away from the planet . we also tried gradually turning on planetary gravity by linearly increasing strength of the potential from zero to its full value within several orbital periods @xcite , but did not find this trick as effective at removing transient structures as simply waiting for them to move away from the planet .",
    "we now present our main results and compare them with the predictions of linear theory . to mitigate possible nonlinear effects we consider only very low planetary masses in our calculations , ranging between @xmath103 and @xmath104 . according to eq .",
    "( [ eq : mth ] ) at 1 au this mass range corresponds to @xmath93 between @xmath105 m@xmath106 and 3 lunar masses ( note that they are sound speed dependent ) . as the basis for comparison we primarily use the distribution of the perturbed density (  [ sec : density ] ) and the evolution of the angular momentum flux carried by the density wave (  [ sec : amf ] ) .",
    "we carry out linear theory verification both in physical ( coordinate ) space and in fourier space .",
    "the most basic and direct comparison between numerical simulations and theory can be performed using the spatial distribution of the perturbed fluid variables . in this work",
    "we choose the perturbed surface density @xmath107 as the primary variable for comparison .",
    "since @xmath108 is spatially concentrated along a narrow wake it makes sense to compare with theory both the _ overall shape _ of the wake in @xmath109 coordinates , and the density distribution _ across _ the wake .",
    "we determine the wake shape in the following way . at each value of @xmath95",
    "we find the value of @xmath96 , called @xmath110 , at which @xmath108 reaches its maximum value @xmath111 .",
    "we then compare the run of @xmath110 with the theoretical prediction ( [ eq : wake_shape ] ) , which applies in the shearing sheet geometry ( gr01 ) .",
    "the results are shown in figure  [ fig : wake ] .",
    "the two curves agree well far from the planet , at @xmath112 .",
    "the discrepancy at @xmath113 is not surprising because in this region ( a ) the density wave is not yet fully formed and ( b ) the dispersion relation ( [ eq : disp_rel ] ) is significantly affected by the @xmath114 term , which causes the wake profile to deviate from the theoretical prediction ( [ eq : wake_shape ] ) valid far from the planet , see @xcite for details .",
    "next we investigate the evolution of the wave amplitude as it travels away from the planet by looking at the behavior of maximum amplitude @xmath115 as a function of @xmath95 .",
    "we plot this quantity scaled by @xmath116 ( this normalization removes the dependence of @xmath117 on @xmath22 and @xmath93 ) in figure [ fig : density - profile]a .    at small @xmath118",
    "the value of @xmath117 is large and decreases with @xmath95 .",
    "this behavior has nothing to do with the density wave since the region in the immediate vicinity of the planet represents a quasi - static atmosphere that forms inside the planetary potential well right after the planetary gravity is switched on .",
    "this structure is rarely mentioned in the analytical calculations of planet - disk interaction but it shows prominently in realistic simulations . in hydrostatic balance ( in the absence of background velocity caused by differential rotation ) density profile in the vicinity of the planet should be given by ( assuming isothermal equation of state with constant sound speed @xmath119 ) @xmath120 in real disks , the background velocity field distorts the atmospheric profile from the circularly - symmetric ( with respect to planet ) shape predicted by this equation .",
    "this explains why @xmath121 shown figure [ fig : density - profile]b slightly overestimates @xmath117 at small @xmath95 .",
    "the effect of the atmosphere on @xmath117 rapidly decreases beyond several @xmath18 from the planet , and @xmath117 starts to rise with increasing @xmath95 .",
    "this is because density wave excitation occurs at @xmath41 and from now on the behavior of @xmath117 is determined by the wave - like density perturbation .",
    "conservation of the angular momentum flux @xmath122 carried by the wave forces the wave amplitude to increase with distance @xmath123 ( gr01 ) . as figure [ fig : density - profile]a shows this scaling agrees reasonably well with the numerically computed @xmath111 far from the planet .    note that initially , at separations of several @xmath18 from the planet , @xmath117 increases with @xmath95 _ faster _ than the theoretical @xmath124 scaling , which is caused by the still ongoing accumulation of the angular momentum flux @xmath40 at these separations . in other words , at this location @xmath40 has not yet reached its asymptotic value given by eq .",
    "( [ eq : f_h_tot ] ) , see  [ sec : amf ] for more details .",
    "far from the planet , beyond @xmath125 ( @xmath126 in the case shown in figure [ fig : density - profile]a ) , the peak @xmath108 rapidly goes down relative to the analytical @xmath124 scaling .",
    "this behavior is caused by the appearance of the shock at @xmath127 and subsequent dissipation of the angular momentum flux carried by the wave .",
    "these nonlinear processes are explored in detail in paper ii .",
    "finally , we examine evolution of the density profile across the wake as a function of radial separation @xmath95 .",
    "we do this by making an azimuthal cut through the density field at fixed @xmath95 and shifting the resultant one - dimensional density profile in @xmath96 by @xmath128 given in eq .",
    "( [ eq : wake_shape ] ) . to eliminate the increase of @xmath108 resulting simply from the angular momentum flux conservation we normalize the density perturbation by @xmath124 .",
    "we additionally scale @xmath108 by @xmath116 , as in figure [ fig : density - profile]a .",
    "as mentioned before , in linear theory the normalized density profile should be independent of @xmath93 at a fixed separation @xmath95 .",
    "this is indeed seen in figure [ fig : mp]a , where we plot scaled profiles of @xmath108 computed for several values of @xmath93 at @xmath129 , and find no significant difference between them .",
    "the adopted value of @xmath95 is small enough for the linear theory to apply even for the highest @xmath93 ( @xmath130 ) used in making this figure , i.e. @xmath95 is always considerably smaller than @xmath127 ( cf .",
    "figure [ fig : density - profile]b and the discussion in  [ sec : nonlinear ] ) .",
    "previously , gr01 computed the evolution of the density profile as a function of @xmath95 in the linear regime . in figure",
    "[ fig : density - profile]b we provide an analogue of figure 1 of gr01 by showing the scaled density cuts at the same values by the `` mach 1''distance @xmath131 rather than @xmath18 as we do here .",
    "however , the physical values of @xmath95 for the density cuts shown in figure [ fig : density - profile]a are the same as in gr01 . ] of @xmath95 ",
    "@xmath132 , @xmath133 , @xmath134 , @xmath135  as in gr01 .",
    "this particular calculation uses a very small planet mass @xmath136 corresponding to @xmath137 , see eq .",
    "( [ eq : ls ] ) , which puts the values of @xmath95 used in making this figure well inside the shock position and reduces the impact of nonlinearity on the density profile , see  [ sec : nonlinear ] .",
    "the effective width of the density profile in this figure does not significantly vary with @xmath95 and stays at the level of several @xmath18 at all times .",
    "we note , however , that this property holds only for the density cuts passing through the wake at fixed @xmath95 , as shown in figure [ fig : density - profile]b . on the contrary ,",
    "the width of the density profile cutting through the wake at fixed @xmath96 ( not shown here ) is _ shrinking _ as @xmath138 , which follows directly from the dispersion relation ( [ eq : disp_rel ] ) since @xmath139 for @xmath140 .",
    "our numerical results agree with linear calculations of gr01 quite well , with quantitative differences at the level of @xmath83 or less .",
    "in particular , we are able to reproduce several subtle features of the wake profile evolution found in gr01 , which are highlighted by arrows in figure [ fig : density - profile]b . these are ( a ) the increase of @xmath108 with @xmath95 in the density trough in front of the wake , ( b ) the decrease of @xmath108 with @xmath95 in the density trough behind the wake , and ( c ) the slight drift of density profile with respect to theoretical wake position @xmath141 given by eq .",
    "( [ eq : wake_shape ] ) as @xmath95 increases .",
    "there are also some minor differences between the figure [ fig : density - profile]b and the results presented in gr01 , e.g. the lower ( by about @xmath83 ) amplitude of @xmath108 far from the planet , at @xmath142 , in our case ( note that the vertical axis of [ fig : density - profile]b is different from the vertical axis in figure 2 of gr01 , since we use @xmath33 and @xmath18 instead of @xmath143 and @xmath144 as mass and length units ) .",
    "we speculate that this may be explained by the gradually accumulating nonlinear effects in our simulations , which are absent in linear calculations of gr01 .",
    "previously , ( * ? ? ?",
    "* figure 6 ) have shown density profiles resulting from their 2d hydro simulations in cylindrical geometry , which are similar to those presented in figure [ fig : density - profile ] .",
    "however , their calculations were carried out for planetary masses ( _ minimum _",
    "@xmath145 ) larger than used in our work ( _ maximum _",
    "@xmath146 ) , which does not allow them to isolate linear effects clearly .",
    "also , @xcite did not attempt quantitative comparison of their numerical results with the linear theory predictions .",
    "we now investigate the behavior of the angular momentum flux ( amf ) carried by the wave @xmath147 as a function of @xmath95 .",
    "linear calculations of this quantity in fourier space have been first performed in gt80 , and later refined in @xcite and @xcite .",
    "the torque density @xmath148 , which is a spatial derivative of @xmath147 has been inferred from simulations in @xcite and @xcite , although no direct comparison with the linear theory was provided in these studies .    the analytical expression ( [ eq : f_h_tot ] ) for the integrated",
    "angular momentum flux scales linearly with the planetary semi - major axis @xmath8 . in the shearing sheet geometry employed in our simulations",
    "@xmath8 is ill - defined , and it makes sense to redefine angular momentum flux as @xmath149 . subsequently we will drop tilde for brevity and denote such normalized momentum flux as @xmath40 . we compute @xmath147 from our data according to the following definition : @xmath150 where @xmath151 is the radial velocity of the fluid , and @xmath152 is the velocity perturbation with respect to the background shear profile in the azimuthal direction .",
    "we compute the torque density ( normalized by @xmath8 ) exerted by the planet on the fluid at separation @xmath95 as @xmath153 and the integrated torque accumulated by the wave at @xmath95 is just @xmath154 conservation of angular momentum ensures that the derivative of equation ( [ eq : amf - numerical ] ) ( the slope of the amf ) coincides with the torque density ( [ eq : specific torque ] ) in the absence of dissipation .",
    "we first compare our simulation results with linear theory in fourier space by studying the behavior of the torque cutoff function @xmath155 , see  [ sec : theory ] .",
    "previously gt80 computed variation of this quantity as a function of @xmath2 , and the result is shown in figures 2 and 3 of their paper , providing a basis for comparison .",
    "@xcite subsequently refined this calculation by arguing that evaluating the planetary potential at separations slightly displaced from the classical lindblad resonance position ( [ eq : resonance - position ] ) should lead to more accurate results .",
    "adopting this approach @xcite provided a simple analytical prescription ( eq .",
    "( 25 ) of @xcite ) to reproduce the behavior of @xmath155 , which can also be compared with our calculations .    substituting @xmath151 and @xmath152 in the form of their fourier integrals in eq .",
    "( [ eq : amf - numerical ] ) and manipulating the resulting expression one can write @xmath147 as the integral over the azimuthal wavenumber @xmath156 : & & f_h(x)=_0^dk_y f_h , k(x ) , + & & f_h , k(x)=4_0 , [ eq : flux_fourier ] where @xmath157 and @xmath158 are the fourier transforms of @xmath151 and @xmath152 , which themselves are functions of @xmath95 . even though the available analytical calculations of the torque cutoff function were performed only in the limit @xmath159 , we chose to retain the dependence of @xmath147 on @xmath95 to explore the evolution of the harmonic content of the amf with distance from the planet .    instead of the discrete theoretical wkb",
    "fourier harmonics of the flux @xmath160 given by ( [ eq : f_h_wkb ] ) we use the following continuous version with @xmath161 and summation over @xmath2 with integration over @xmath162 . ] : f_h , k^wkb=_0(k_yh)^2 ( ) ^2 ^ 2 , [ eq : flux_fourier_theor ] where we also normalized the final expression by @xmath8 .",
    "we can now compute real and imaginary components of @xmath157 and @xmath158 using our numerical data and then obtain @xmath163 from eq .",
    "( [ eq : flux_fourier ] ) . dividing the result by @xmath164",
    "provides us with the ratio @xmath165 , which can then be compared with the existing theoretical calculations of the torque cutoff .",
    "this is done in figure [ fig : amf - decay ] where we plot the numerical @xmath165 computed at different separations from the planet against the semi - analytical calculations of the same quantity ( in the limit @xmath166 ) performed by gt80 and @xcite .",
    "these calculations were done for rather small @xmath167 ( corresponding to @xmath168 ) allowing us to see linear wave evolution out to large separations .",
    "one can see in figure [ fig : amf - decay]a that the agreement between theory and simulations is generally quite good .",
    "our results seem to agree better with gt80 torque cutoff prescription than with @xcite . however , at the level of accuracy available to us we are not able to firmly discriminate between these two torque cutoff prescriptions . at intermediate values of @xmath169",
    "our numerical results for @xmath165 are essentially independent of @xmath95 and pass between the two aforementioned analytical torque cutoff prescriptions . only weak sensitivity of @xmath165 on @xmath95 is expected since beyond @xmath170 the power in azimuthal harmonics corresponding to this range of @xmath171 should have already been fully accumulated by the density wave , and no evolution should arise .",
    "good agreement with the gt80 results is also illustrated in figure [ fig : amf - decay]b , which shows the torque cutoff function ( multiplied by @xmath172 ) in linear space , as in figure 3 of gt80 .",
    "the situation is different for smaller values of @xmath173 , where the numerical curves fall below the analytical asymptotic behavior @xmath174 as @xmath175 .",
    "also , there is noticeable evolution of @xmath165 with @xmath95 , with nonzero power extending down to smaller and smaller values of @xmath156 as the wave travels further from the planet .",
    "this is because the low - order harmonics corresponding to small @xmath171 contribute to the wave flux predominantly at separations larger than @xmath176 @xcite , see eq .",
    "( [ eq : resonance - position ] ) . as a result ,",
    "the further the wave travels , the more power gets collected by the wave from these lower - order azimuthal harmonics of the planetary potential , but the very small values of @xmath177 never contribute to the wave flux even at @xmath178 .",
    "our numerical results also exhibit noticeable disagreement with theory and clear evolution with @xmath95 at large values of @xmath179 , and we comment on their origin in  [ sec : nonlinear ] .",
    "we now study the behavior of the amf and torque density in physical space .",
    "understanding the spatial distribution of the latter quantity is important for properly computing the amf in disks with non - uniform distribution of @xmath180 in the vicinity of the planet , and is thus important for understanding the early stages of gap formation by massive planets .",
    "here we look at disks with uniform distribution of @xmath180 . in figure",
    "[ fig : amf ] we show the behavior of the afm @xmath147 computed according to the definition ( [ eq : amf - numerical ] ) and also of the accumulated torque @xmath181 given by eqs .",
    "( [ eq : specific torque ] ) .",
    "we display our results for four different values of @xmath93 , normalizing @xmath147 and @xmath181 by @xmath182  according to linear theory the shape of the resultant curves should then be independent of @xmath93",
    ". theoretical scaling of the torque @xmath183 is indeed largely confirmed by this figure , but see  [ sec : nonlinear ] for more details .    to facilitate the comparison with the torque calculation , amf curves have all been vertically shifted by a small offset to cancel the non - zero value of @xmath184 at @xmath185 resulting from the residual gas motion in the horseshoe region and a small intrinsic non - zero starting value of the amf ( rafikov & petrovich , in preparation ) .",
    "this brings them in perfect accord with @xmath181 curves close to the planet , which is expected to be the case in the absence of dissipation . at large separations , beyond @xmath127 ,",
    "the @xmath147 curve starts falling below the @xmath181 curve , which is caused by shock formation and dissipation of the wave amf past this point . quite naturally , this effect is more pronounced for higher @xmath93 , e.g. @xmath186 and @xmath187 , corresponding to smaller @xmath127 . for smaller masses shocks",
    "occur outside the simulation box and essentially no difference between @xmath147 and @xmath181 can be seen .",
    "the post - shock behavior of the amf will be studied in paper ii .    in figure",
    "[ fig : torque - density ] we plot the torque density @xmath188 ( [ eq : torque - density ] ) as a function of @xmath95 .",
    "the overall shape of the curve is consistent with previous numerical calculations of the same quantity in cylindrical coordinates performed by @xcite and @xcite .",
    "as expected from linear theory , beyond @xmath189 torque density drops dramatically , and the amf rises only weakly , with @xmath190 , which is evident from the flattening of amf curves in figure [ fig : amf ] .",
    "this justifies the localization of the wave excitation to the immediate vicinity ( within @xmath191 ) of the planet , as described in  [",
    "sec : theory ] .",
    "to the best of our knowledge , no quantitative analytical description of how @xmath147 should vary with distance from the planet exists in the literature , despite its potential importance for the gap opening problem . to fill this gap we first tried the following theoretical prescription @xmath192 motivated by the calculations of gt80 : at each @xmath95 we compute the lowest azimuthal wavenumber @xmath193 for which the location of the lindblad resonance @xmath194 using eq .",
    "( [ eq : resonance - position ] ) and then calculate the amf as the sum of all fourier contributions @xmath28 given by eq .",
    "( [ eq : f_h ] ) that correspond to @xmath195 .",
    "the result , which we denote by @xmath192 , is given by : & & f_h^lr(x)=^2__min(x)^d^2 , [ eq : f_h_phys ] + & & _ min(x)= , [ eq : mu_min ] where we adopt the torque cutoff function @xmath196 calculated in gt80 .",
    "note that @xmath192 is in fact independent of the adopted value of @xmath8 since its calculation can be rephrased fully in terms of @xmath197 rather than @xmath2 .",
    "this prescription essentially assumes that the amf contribution @xmath28 corresponding to a particular azimuthal wavenumber @xmath2 gets picked up by the density wave in a step - like fashion , solely at a _ single discrete _ location corresponding to the position of the @xmath2-th lindblad resonance .",
    "previously , this recipe was used in gt80 to compute the asymptotic behavior of the torque density in the limit @xmath112 , considering azimuthal harmonics with @xmath198 . here",
    "we essentially extend this prescription to the case of arbitrary @xmath2 and @xmath190 .",
    "linear calculations by @xcite show that this approximation is not very accurate , and amf contribution due to each potential harmonic is in fact accumulated by the wave over an extended range of @xmath95 .",
    "thus we should not expect @xmath192 given by eq .",
    "( [ eq : f_h_phys ] ) to accurately represent the real coordinate dependence of the amf in the linear regime . nevertheless , this prescription still provides a useful reference point and we plot it in figure [ fig : amf](a ) ( the dotted line , denoted by lr theory ) .",
    "we also plot in figure [ fig : torque - density ] the theoretical prescription for the torque density @xmath199 obtained by differentiating eq .",
    "( [ eq : f_h_phys ] ) with respect to @xmath95 .",
    "one can see from these figures that the simple - minded theoretical prescription ( [ eq : f_h_phys ] ) overestimates the torque density at small @xmath95 and underestimates it at larger @xmath95 .",
    "while the areas under the numerical and theoretical curves in figure [ fig : torque - density ] , which represent the full accumulated amf , are close to each other , the profiles of the two curves are quite different . as a result , @xmath192 initially rises faster than the numerical @xmath147 in figure [ fig : amf ] , but eventually the two asymptote to a similar final value .",
    "the small remaining difference is caused by both the intrinsic numerical inaccuracy and the fact that unlike the amf theoretical curve the numerical amf curve has been shifted to have a zero starting point .    as the next level of approximation to the behavior of the @xmath147 and @xmath181 we used the semi - analytical calculations of these quantities in the linear regime by rafikov & petrovich ( in preparation ) .",
    "the run of corresponding @xmath181 is displayed in fig .",
    "[ fig : amf ] by the dash - dotted curve ( the curve has also been shifted downward to cancel the non - zero starting value , and we use the label `` linear theory '' to indicate rafikov & petrovich s work in all the figures ) and clearly demonstrates good agreement between the simulation results and the semi - analytical linear theory . theoretical torque density based on this @xmath181",
    "is shown in fig .",
    "[ fig : torque - density ] and also agrees well with the numerical results , much better than the derivative of @xmath192 .",
    "this additionally emphasizes the point that assigning the planetary torque produced by a particular potential harmonic to a single location corresponding to the respective lindblad resonance ( as done in eq .",
    "( [ eq : f_h_phys ] ) ) is not a very accurate procedure .",
    "finally , we also compare our numerical results with another quantity that can be computed in the linear approximation , namely the `` pseudo - amf ''",
    "@xmath200 introduced in gr01 as f_j(x)=_-^()^2 dy .",
    "[ eq : pseudo ] this quantity reduces to @xmath147 at large separations from the planet @xmath112 , where @xmath108 is determined solely by the density wave , propagating away from the planet .",
    "however , for @xmath113 the pseudo - amf is strongly affected by the presence of the aforementioned atmosphere around the planet ( see  [ sec : density ] ) , which is not a propagating density perturbation and can not be associated with the density wave ( this explains the prefix `` pseudo- '' ) .",
    "we compute the theoretical value @xmath201 in the linear approximation using unpublished data from gr01 and also derive @xmath201 from our numerical data using the definition ( [ eq : pseudo ] ) .",
    "the comparison between the two is shown in figure [ fig : flux2 ] for very small @xmath202 .",
    "one can indeed see that at small @xmath190 the pseudo - amf _ increases _ with decreasing @xmath190 , analogous to @xmath108 in figure [ fig : density - profile]a , which is explained by the presence of the atmosphere accumulated in the planetary potential well .",
    "comparison with figure [ fig : amf ] also shows that @xmath201 indeed reduces to @xmath147 at large @xmath190 .",
    "most importantly , the agreement between the theoretical @xmath201 derived from linear theory and the numerical @xmath201 is very good in the whole range of @xmath95 explored , which provides additional verification of linear theory of the planetary density wave evolution .      in linear theory",
    "the dynamics of the density wave is independent of the adopted equation of state ( eos ) , and depends only on adiabatic sound speed of the gas @xmath62 . to check this property",
    "we have run several test simulations with two different eos : isothermal eos and eos with @xmath60 , while keeping @xmath62 the same .",
    "the results do not show any significant difference between the runs with different eos in linear stage thus confirming theoretical expectations .",
    "however , in the nonlinear stage a particular form of the eos does become important and this is investigated further in paper ii .",
    "we now discuss the nonlinear effects that arise in our simulations even prior to the appearance of the shock , i.e. at @xmath47 .",
    "nonlinear distortion of the wave profile is unavoidable even for the very low amplitude density waves and even during the mostly linear phase of their evolution .",
    "the rate of accumulation of the nonlinear effects ( which eventually become strong and lead to shock formation ) scales with planetary mass and is lower for low @xmath93 .",
    "this point is illustrated in figure [ fig : mp]b , which is very similar to figure [ fig : mp]a and presents azimuthal density cuts through the wake for different values of @xmath93 , but now recorded further out from the planet , at @xmath203 . while in figure [ fig : mp]a , at @xmath129 , the density profiles for all @xmath93 are essentially overlapping and agree with the analytical profile from gr01 , the situation at @xmath203 is quite different .    at this location",
    "the ( normalized ) wake profiles for the two smallest masses , @xmath204 ( corresponding to @xmath205 ) and @xmath206 ( @xmath207 ) , still agree with each other and the semi - analytical linear calculation from gr01 quite well . however ,",
    "already for @xmath208 ( @xmath209 ) one can see a noticeable distortion of the profile compared to the linear solution , with the leading edge ( at the left ) becoming _ steeper _ and the profile peak _ shifting _ to the left , towards incoming fluid .",
    "the wave for even higher @xmath210 ( @xmath211 ) has already shocked at @xmath203 , which is clearly reflected in its density profile : its leading edge is essentially vertical , exhibiting a discontinuity in the fluid variables across the shock .",
    "thus , the role of the nonlinear effects , which is measured at a given @xmath95 both by the slope of the leading edge of the profile and the shift of its peak relative to the linear solution , progressively increases with the planet mass .",
    "nonlinear effects also manifest themselves in a variety of other , more indirect ways .",
    "in particular , they explain the evolution of the torque cutoff function in fourier space and its deviation from theoretical predictions at high @xmath179 ( see  [ sec : fourier ] ) .",
    "figure [ fig : amf - decay]a clearly shows a growing amount of excess power at the high values of @xmath171 as the wave propagates to larger @xmath95 .",
    "this behavior is naturally accounted for by the nonlinear wave steepening , which causes the transfer of the amf power in fourier space from the low-@xmath156 to high-@xmath156 harmonics .",
    "nonlinearity also affects the amf behavior in physical space .",
    "close inspection of figure [ fig : amf ] reveals that the numerical torque and amf curves tend to asymptote to lower levels for higher @xmath93 , when nonlinearity is stronger .",
    "the difference in asymptotic values at large @xmath95 between the largest and the smallest planet cases is about @xmath212 .",
    "variation of @xmath93 also affects the height of @xmath188 curve at smaller @xmath213 , increasing the peak value of @xmath188 for lower @xmath93 , as shown in figure [ fig : torque - density ] .",
    "this explains the dependence of normalized amf and @xmath181 curves on @xmath93 in figure [ fig : amf ] : the area under the differential torque curve is slightly ( by @xmath214 ) higher for @xmath215 ( the think solid line ) than for @xmath167 ( the thin solid line ) , explaining the difference seen between the asymptotic values of integrated torque @xmath181 in figures [ fig : amf]b and [ fig : amf]d .",
    "spurious dissipation related to numerical viscosity can not be blamed for this effect since its effect on the amf should be independent of @xmath93 .",
    "we suggest that this behavior may be explained ( at least partly ) by the stronger nonlinear evolution of the wave profile for higher @xmath93 . according to eq .",
    "( [ eq : torque - density ] ) nonlinear distortion of @xmath108 away from the theoretically expected - value should have an effect ( growing with @xmath93 ) on the calculation of the torque density @xmath188 .",
    "since for @xmath93 not too close to @xmath33 this profile distortion becomes significant only far from the planet , where the planetary potential is weak , the impact of this nonlinear torque modification on the amf curves is not very dramatic , but it is definitely non - zero .",
    "we also note that one expects simulations with smaller @xmath93 to exhibit better agreement with the theory since they are less affected by the nonlinear effects .",
    "however in reality this is not always the case because the optimal set of numerical parameters for achieving the best possible numerical result for different @xmath93 is different ( see  [ sec : parameters ] ) .",
    "close inspection of figure [ fig : torque - density ] reveals an interesting feature in the behavior of the torque density at large @xmath95 .",
    "the inset in this figure clearly shows that @xmath188 becomes _ negative _ beyond @xmath216 , which is at odds with linear theory since according to gt80 @xmath188 should not change sign at any non - zero @xmath95 .",
    "the contribution of this negative torque density to the total integrated torque @xmath217 is rather small ( under one per cent level ) , but its existence presents a challenge to the results of gt80 .",
    "further investigation reveals that this `` negative torque '' phenomenon is present also in previous lower resolution numerical calculations of ( * ? ? ?",
    "* figure 12 ) and ( * ? ? ? * figure 7 ) .    to understand the nature of this effect we varied the numerical parameters of our simulations . for a given @xmath167 we tried varying softening length @xmath65 from @xmath218 to @xmath219 at fixed resolution of @xmath85 , and then varied resolution from @xmath220 to @xmath221 for a fixed @xmath222 .",
    "as figure [ fig : torque - density ] shows this does not make the negative torque go away and @xmath188 still changes sign at the same value of @xmath223 .",
    "even more interestingly , changing the planetary mass @xmath93 to lower @xmath215 while keeping everything else the same ( resolution of @xmath85 and @xmath86 ) also does not affect the position of @xmath223 , as the same figure clearly shows .",
    "analogously , experiments with different sizes of the simulation box and different prescriptions of gravitational potential show that the existence of negative torque and the position of @xmath223 are independent of these parameters as well .",
    "moreover , simulations of ( * ? ? ?",
    "* figure 12 ) suggest that the negative torque phenomenon shows up only at _ low _ planetary masses ( @xmath224 m@xmath225 m@xmath106 in their case ) , which makes possible explanations based on nonlinear effects unlikely .    this point is confirmed in rafikov & petrovich ( in preparation ) who demonstrate that the sign change of the torque density at large separation from the planet is in fact a purely linear effect .",
    "it can be understood by carefully accounting for the complex spatial structure of the torque density produced by each azimuthal harmonic of the planetary potential , which goes beyond the simple calculation presented in gt80 .",
    "we now explore how the results presented in previous section and their agreement with analytical theory are affected by the variation of purely numerical parameters in our simulations .",
    "table [ tab : parameter ] lists the numerical parameters that we varied and the values we explored .",
    "values corresponding to our standard case are indicated in boldface .",
    "lc riemann solver ( flux function ) used & * roe * , hllc + order of accuracy & 2 , , 3p + boundary conditions in @xmath96 & outflow , * inflow / outflow * + resolution of the simulation ( cells per @xmath18 ) & 64 , 128 , * 256 * + planetary potential ] & @xmath77 , @xmath226 , @xmath81 + softening length & 1/8 , 1/16 , * 1/32 * + equation of states of the fluid & @xmath227 , @xmath60 + mass of the planet @xmath228 & @xmath229 , @xmath230 , @xmath231 , @xmath232 , @xmath233 + [ tab : parameter ]      in our simulations we compare two different riemann solvers  roe s linearized solver ( @xcite ) and hllc @xcite  with three different algorithms for the spatial reconstruction step @xcite : second order with limiting in the characteristic variables ( denoted 2 in this work ) , which is the predominant choice in literature in this field , third order with limiting in either the characteristic variables ( 3c ) , or in the primitive variables ( 3p ) .",
    "we find that roe and hllc solvers yield nearly identical results both in terms of the density profile and in terms of @xmath147 and @xmath181 ( differences are at the @xmath234 level ) .",
    "the effect of using a different order of accuracy on the profile of the density wave is shown in figure [ fig : density - variety]a , where we plot azimuthal density cuts obtained with different numerical settings at @xmath129 ( together with semi - analytical profile computed by gr01 in the framework of linear theory ) and @xmath203 .",
    "one can see that density perturbation is rather insensitive to variation of the order of accuracy .",
    "the sensitivity of the amf calculation to varying order of accuracy is illustrated in figure [ fig : amf - variety]a , where the linear theory curve based on the semi - analytical calculation by rafikov and petrovich ( in preparation ) is overplotted for reference .",
    "one can see that the higher order of accuracy ( 3c and 3p ) results in a slightly lower asymptotic value of torque and amf , and the difference in the asymptotic value for the two between the 2 case and the 3p case is about @xmath212 .",
    "furthermore , 3c and 3p cases agree with each other on the position where the amf curve starts to deviate from the torque , @xmath235 , which is still somewhat smaller than the theoretical prediction @xmath236 in this case due to the relatively low resolution .",
    "however , the second order of accuracy moves this point inward , which means that the angular momentum carried by the wave starts to dissipate earlier in this case .",
    "in particular , we find that using a second order accuracy solver compared with the third order accuracy solver has similar effect to decreasing the resolution by a factor of 2 ( in term of advancing the displacement of the amf - torque separation point , see  [ sec : resolution ] and figure  [ fig : amf - variety]b ) .",
    "finally , we also note that calculations with 3p order of accuracy produce considerably noisier velocity field ( this explains the noisy corresponding amf curve in figure [ fig : amf - variety]a ) than the other two cases explored .",
    "this difference is important for calculation of the velocity - based variables such as potential vorticity , which is used in paper ii as the means of shock detection . for these reasons in our current simulations we use roe solver with 3c reconstruction .      in figure",
    "[ fig : density - variety]b we show the effect of varying resolution of our simulations on the density profile . in general , increasing resolution from @xmath237 to @xmath85 improves the agreement with linear theory , but only slightly .",
    "lower resolution simulations overestimate the amplitude of @xmath108 by just several per cent compared to @xmath85 simulations .",
    "thus , for the study of the density wave profile our simulations essentially reach convergence in terms of resolution already at @xmath237 .    in figure [ fig : amf - variety]b we show that the amf and torque calculations are more sensitive to resolution , especially when the nonlinear effects become important .",
    "increasing resolution causes the asymptotic values of @xmath147 and @xmath181 to decrease , and the difference in the asymptotic value for the two between the @xmath85 case and the @xmath237 case is about @xmath83 .",
    "the key factor that clearly shows the downside of low resolution is the location , at which the numerical amf curve deviates from the numerical torque calculation .",
    "calculations shown in figure [ fig : amf - variety ] use @xmath208 , which according to eq .",
    "( [ eq : ls ] ) corresponds to shocking length @xmath168 . in our highest resolution simulations ( @xmath85 ) , the amf curve starts to deviate from the accumulated torque curve precisely at @xmath168 , as expected from theory .",
    "but as we reduce resolution , the radial separation at which @xmath147 starts departing from @xmath181 moves closer to the planet violating the agreement with theory . in @xmath237 simulations",
    "such departure starts already at @xmath238 , considerably closer to the planet than the nominal shock location @xmath127 .",
    "this behavior is caused by the higher level of numerical viscosity arising at low resolution , which leads to the dissipation of angular momentum carried by the wave prior to shock formation ( we verified this point by conducting some runs with explicit viscosity in paper ii , which show behavior qualitatively similar to our low resolution runs here ) .",
    "thus , high resolution is crucial to correctly capture the details of the nonlinear wave evolution .",
    "we elaborate on this issue in paper ii .",
    "the rate at which a given smoothed potential converges to @xmath67 is important for the problem of density wave generation .",
    "indeed , the amplitude and spatial distribution of fluid perturbation is in the end determined solely by the potential behavior . as a result ,",
    "if @xmath239 is substantially different from @xmath67 in the region where most of the torque is exerted by the planet , i.e. at @xmath240 , see figure [ fig : torque - density ] , then one can expect significant spurious effects modifying the density wave properties .",
    "a specific form of the potential can have a two - fold effect on the properties of the density wave excited by the planet .",
    "first , there is a deviation of the potential from newtonian , which directly affects the wave excitation at a given separation from the planet .",
    "but in addition , different potentials result in different structures of the quasi - static atmospheres ( see  [ sec : density ] ) that get collected in the planetary potential well .",
    "this has an effect on the pressure distribution in the vicinity of the planet and can also affect wave excitation by modifying the dispersion relation and displacing the effective positions of lindblad resonances . in practice disentangling these two effects based on the results of simulations",
    "may be non - trivial .    in figure",
    "[ fig : density - variety]c we show that for a fixed @xmath222 varying the order of the potential does not have a significant effect on the density wave profile",
    ". however , the amf and torque calculations are more sensitive to the form of the potential , as figure [ fig : amf - variety]c demonstrates .",
    "in particular , amf in calculations with less accurate potential ( e.g. @xmath77 ) is lower than it is in more accurate potential ( @xmath212 for @xmath79 ) .",
    "we note that the seemingly better agreement with theory in the @xmath77 case is an accidental phenomenon at this set of other numerical parameters .",
    "for example , panel ( d ) shows that using softening length @xmath241 instead of @xmath218 could shift the curves downward by @xmath242 , so if switching to @xmath241 in panel ( c ) then the @xmath81 case would come to perfect agreement with the linear theory ( see  [ sec : sum_res ] for additional discussion ) .    in figure",
    "[ fig : density - variety]d we explore the effect of varying @xmath65 for a fixed form of the potential @xmath79 .",
    "we discover that lowering @xmath65 results in a higher amplitude of the density perturbation .",
    "on the other hand , figure [ fig : amf - variety]d shows that a lower @xmath65 leads to a higher numerical amf and torque , and the difference in the asymptotic value for the two between the @xmath243 case and the @xmath86 case is about @xmath244 .",
    "again , the better agreement between the theory and the @xmath241 case is accidental .",
    "our calculations presented in  [ sec : result ] use @xmath79 potential with @xmath86 .",
    "we conclude that the overall shape of the density wave profile is generally less sensitive to the variations of numerical parameters ( unless these values are very different from the ranges explored in this work , see below ) than the spatial dependence of the amf or integrated torque .",
    "this emphasizes the importance of these integrated quantities as diagnostics of various subtle effects influencing the wave properties .",
    "in the course of this numerical exploration we have also discovered that the `` optimal '' value of a particular numerical parameter ( e.g. softening length @xmath65 ) showing closest agreement with the linear theory depends on the values of other numerical parameters ( e.g. resolution , type of the potential , etc . ) and on @xmath93 . in other words",
    ", there is no universal best choice for each numerical parameter of simulations . in both figure [ fig : density - variety ] and [ fig : amf - variety ] , only the relative position of the curves representing different parameters matters , not their exact locations and the discrepancies between them and the linear theory . on the other hand ,",
    "as we demonstrate in paper ii , high order of accuracy , high resolution , and highly accurate form of the potential with small softening length are critical to properly resolve the nonlinear stage of the wave evolution .",
    "hydrodynamic simulations of the disk - planet interaction must often be run for many orbital periods .",
    "this is the case _",
    "e.g. _ in studies of planetary migration or gap opening , in which substantial effects appear on timescales of hundreds to thousands of orbital periods ( depending on @xmath93 ) .",
    "this severely restricts the choice of resolution and softening length at which such simulations can run .",
    "typical resolutions in global disk simulations found in the literature @xcite range from @xmath245 to @xmath246 , and @xmath65 is usually taken to be between @xmath247 to @xmath18 , in combination with a second order of accuracy solver and the second ( see eq .",
    "( [ eq : phi2 ] ) ) or even lower order representation of the planetary potential . on the other hand , accurate description of the migration rate and gap opening",
    "may only be possible if properties of the density wave excited by the planet are properly captured by the simulation .    to test",
    "how reliably the wave structure can be reproduced in global simulations we compare two sets of simulations in our local setting with @xmath208 .",
    "we run one simulation with the typical numerical parameters for local shearing box simulations found in recent literature ( typical global simulations in literature use even smaller resolution and @xmath65 ) : second order of accuracy , resolution @xmath245 and @xmath77 potential with @xmath248 .",
    "another simulation is run with our fiducial parameters  third order of accuracy , resolution @xmath85 , and @xmath79 potential with @xmath222  and their results are compared in figure [ fig : comparison ] .",
    "there are noticeable differences between the two runs .",
    "the simulation with typical literature parameters produces smoother density profile , which deviates from analytical solution by about @xmath249 , see figure [ fig : comparison]a .",
    "at the same time , our fiducial run shows deviations from analytical profile only at the level of @xmath75 .",
    "the difference is even more pronounced when we compare the amf and torque behavior in figure [ fig : comparison]b .",
    "our fiducial simulation yields asymptotic values of @xmath147 and @xmath181 which are within several per cent of the expected theoretical value ( [ eq : f_h_tot ] ) .",
    "as expected , @xmath147 agrees with @xmath181 all the way until @xmath250 , which is precisely the shock location for the @xmath93 used , according to eq .",
    "( [ eq : ls ] ) . on",
    "the contrary , in the typical literature simulation amf @xmath147 starts deviating from the integrated torque curve @xmath181 already at @xmath251 , significantly in advance of the expected shock position ( a factor of 2 ) .",
    "this indicates that dissipation and transfer of the angular momentum carried by the wave to the disk fluid start earlier in the typical literature case than they should in reality .",
    "the most likely explanation for this behavior is the high level of numerical viscosity in the typical literature run .",
    "moreover , the absolute asymptotic values of @xmath147 and @xmath181 disagree with the theoretical prediction for asymptotic @xmath40 by @xmath252 ( comparing with @xmath253 in our fidicual simulation ) , which is quite significant .",
    "we note that the differences between our fiducial and the typical literature simulations persist also in experiments with larger planet masses , @xmath254 , while the linear regime of wave excitation still holds .",
    "underestimate of the wave angular momentum flux in the low - resolution simulations may result in an underestimate of the planetary migration rate in global simulations . in our shearing sheet setup",
    "we can not investigate the effect of resolution on the planetary migration rate : by design one - sided torques exerted by the inner and outer parts of the disk on the planet exactly cancel each other , while the migration speed relies on the small imbalance between them .",
    "but the very fact that the one - sided torques in low - resolution case deviate by tens of per cent from the high - resolution case is suggestive that the migration speed should be adversely affected by poor resolution at the same level .",
    "furthermore , the relative imbalance between the one - sided torques can also be a function of resolution potentially exacerbating the problem .",
    "the discrepancy in the amf should also affect the fidelity of gap opening by the planet in typical literature global simulations .",
    "lower amf carried by waves means that the planet is less effective at repelling gas away from its semi - major axis , which would require higher @xmath93 to open a gap .",
    "in addition , the gap opening process is sensitive to the _ spatial distribution _ of the amf dissipation @xcite . as a result ,",
    "spurious dissipation of wave amf prior to shock formation in low - resolution simulations and the accelerated amf decay after the shock may introduce artificial effects in the gap opening picture . to summarize ,",
    "any numerical studies of processes in which density wave production and dissipation plays important role need to use high order of accuracy , high resolution , and accurate representation of the planetary potential with small softening length .",
    "in this section we describe a commonly ignored numerical problem that we discover in disk - planet interaction simulations .",
    "namely , we find that if the time - step @xmath255 of the simulation is too large , the code can not resolve the motion of the fluid in regions where the fluid experiences large gravitational acceleration .",
    "this issue applies to simulations in general , but it is especially problematic when the orbital advection algorithms is implemented ( the fargo algorithm , citealtmas00 ) .",
    "@xcite introduced a modification of the standard transport algorithm ( fast advection in rotating gaseous objects , fargo ) for simulations of differentially rotating systems , which significantly speeds up the calculations . by getting rid of the average azimuthal velocity when applying the courant condition",
    ", this technique results in a much larger time step @xmath255 , which is limited by the small perturbed velocity , than the usual procedure , where @xmath255 is limited by the full fluid velocity dominated by the differential rotation .",
    "fargo has been implemented in athena by @xcite .    in a shearing box without planets ,",
    "the dynamical time scale is @xmath256 and is uniform throughout the box .",
    "however , when the planet is introduced , the dynamical timescale is spatially varying , and could be characterized by the free - fall time , which is the time that it takes a fluid element to fall on the planet assuming a constant acceleration at the grid point . for gravitational potential in the form of eq .",
    "( [ eq : phi4 ] ) , the free - fall time is : @xmath257{\\frac{2(\\rho^2+{r_{\\rm s}}^2)^{5/2}}{{\\rm g}{m_{\\rm p}}(\\rho^2 + 2.5{r_{\\rm s}}^2 ) } } \\label{eq : tff}\\ ] ] note that @xmath258 depends on a specific form of the gravitational potential , and a more smoothed potential results in a larger @xmath258 .",
    "the smallest free - fall time in the entire domain , which is the limiting timescale for the simulation , occurs at the grid points that are adjacent to the planet , which have the smallest @xmath74 ( @xmath259{2}$ ] of the cell size @xmath260 in athena ; the separation where the smallest @xmath258 occurs also depends on the form of potential ) . in our simulations",
    ", we always keep @xmath261 ( usually @xmath262 ) , so the smallest free - fall time is : @xmath263{\\frac{0.8{r_{\\rm s}}^3}{{\\rm g}{m_{\\rm p } } } } \\label{eq : tffs}\\ ] ] on the other hand , according to the courant condition when varying the resolution the time step @xmath264 .",
    "so the ratio @xmath265 scales with numerical parameters and @xmath93 as @xmath266{{m_{\\rm p } } } r_c } \\label{eq : tffdt}\\ ] ] to properly resolve fluid dynamics in the vicinity of the planet , the ratio @xmath265 should be kept above a certain threshold .",
    "our calculations without orbital advection and with @xmath255 determined by the courant condition usually have @xmath267 .",
    "however when we turn on the orbital advection algorithm , @xmath255 typically increases by a factor of @xmath268 , and the ratio @xmath265 decreases by the same factor .",
    "we find that when the time - step is _ too large _ to properly resolve the fluid motion around the planet , the numerical results will be _ incorrect _ , as described below .",
    "figure  [ fig : fargo ] shows the azimuthal density profiles @xmath108 at @xmath129 for a set of simulations using identical numerical parameters and orbital advection algorithm but with different @xmath265 ratio , which we achieve by manually setting @xmath255 to be a fraction of the @xmath255 set by the courant condition in fargo .",
    "the two cases with highest @xmath265 yield the density profile in agreement with the theoretical prediction , also demonstrating the convergence of the result at high @xmath265 . however , the density profiles in simulations with lower @xmath265 clearly deviate from theory , with smaller @xmath265 leading to larger discrepancy . in the run with",
    "the smallest used @xmath269 which corresponds to @xmath255 set by the courant condition in fargo ( representing maximum fargo speed up ) , the density peak even becomes a density trough . by experimenting with athena",
    ", we generally find that our simulations of the disk - planet interaction produce converged results agreeing with theory only when @xmath270 while this critical number may depend on the numerical method used in a particular code or some other numerical conditions .",
    "we note that in principle all disk - planet simulations have to satisfy condition ( [ eq : tffdtcondition ] ) to ensure correct results , but in experiments we find simulations with the orbital advection algorithm tend to violate this condition much more easily than simulation without the orbital advection algorithm .    apart from incorrectly reproducing density perturbation , disk - planet simulations violating the @xmath265 constraint exhibit other serious problems .",
    "in particular , simulations with small @xmath265 do not achieve a steady state .",
    "we illustrate this in figure  [ fig : fargo ] by showing the density profile at half simulation time for two cases .",
    "while the @xmath271 case reaches a steady state and develops time independent density profile at half time , the @xmath272 case does not , and its density perturbation decreases with time .    in simulations with @xmath265",
    "lower then the critical value , the fluid element approaching the planet at small @xmath190 , instead of moving on a horseshoe orbit , gets trapped by the planetary potential , leading to the formation of a fluid loop around the planet .",
    "as simulation progresses the rotational velocity of the fluid loop becomes higher and higher , and eventually the centrifugal force evacuates the region around the planet .",
    "this effect , which is a purely numerical artifact of the too small @xmath265 , is visually very similar to ( and can easily be confused with ) the gap opening phenomenon , which is a real physical effect .",
    "simulations exploring the gap opening process with large planet mass and low resolution are likely to have small @xmath265 violating condition ( [ eq : tffdtcondition ] , see eq .",
    "[ eq : tffdt ] ) , which may have detrimental effects on the results .",
    "we note that using athena with orbital advection algorithm , numerical simulations with @xmath273 and a large @xmath248 must have an effective resolution at least @xmath237 in the vicinity of the planet to avoid this problem ( a more smoothed potential may weaken this condition , through ) . however , again we emphasize that the critical value of @xmath265 in simulations with the same numerical parameters but using different code and solver may be different from ours",
    ".    the @xmath265 threshold severely limits the ability of fargo to speed up calculations of disk - satellite interaction . for most of our simulations",
    ", @xmath265 is already rather close to the threshold value without orbital advection algorithm , so there is not much room left to increase @xmath255 , which is what the orbital advection algorithm aims to achieve ( all our simulations presented outside this section are done without orbital advection technique ) .",
    "however , in many other studies of differentially rotating systems , such as the investigation of magnetorotational instability ( mri ) in accretion disks , the point mass objects are absent and the characteristic dynamical time scale is always long enough for the orbital advection algorithm to be a extremely useful tool for speeding up the simulations . at last , we note that both @xmath255 and @xmath274 may vary during the simulation , and the constraint ( [ eq : tffdtcondition ] ) on their ratio should be satisfied in the entire domain throughout the simulation time .",
    "we have conducted a series of hydrodynamical simulations to study the details of the gravitational interaction between low mass planets and a protoplanetary disk , and to test predictions of the linear theory of density wave evolution .",
    "our simulations assume local shearing sheet geometry and are carried out in 2d at very high resolution to reduce the effect of numerical viscosity .",
    "we focus on both the excitation of the density waves and their propagation away from the planet in the linear regime . to mitigate the effects of nonlinearity we consider very small planetary masses , starting at @xmath105 m@xmath106 and going down to 3 lunar masses at 1 au .",
    "we extract the spatial distribution of the density perturbation induced by the planet from our simulations and compare it with the predictions of linear theory .",
    "we find good agreement between the two , at the level of several per cent when high resolution ( typically @xmath85 ) is employed .",
    "we also investigate the spatial dependence of the angular momentum flux carried by the wave and the distribution of torque induced by the planet on the disk , again finding good agreement with theoretical predictions .",
    "in particular , we are able to reproduce the theoretical behavior of the torque cutoff in fourier space .",
    "we also find various manifestations of nonlinear effects in our simulations even while the waves are formally linear .",
    "these include ( 1 ) the noticeable steepening of the density profile at larger values of @xmath93 far from the planet , ( 2 ) the slight variation of the asymptotic value of the amf with planetary mass in addition to the expected @xmath275 dependence , causing the discrepancy with linear theory prediction at the level of several per cent , and ( 3 ) the growth of power in high azimuthal wavenumber harmonics of the amf in fourier space .",
    "by carefully studying the spatial distribution of the torque density @xmath188 in our simulations we discover an interesting `` negative torque '' phenomenon : @xmath188 changes sign at some radial separation from the planet ( at @xmath276 in our simulations ) , which contradicts the analytical results of gt80 .",
    "this effect can however be understood in the framework of the linear theory as shown in rafikov & petrovich ( in preparation ) .",
    "this feature of the torque distribution has only weak effect on the total accumulated torque in our simulations .",
    "we also carried out a detailed investigation of the effect of different numerical settings on our results in linear regime .",
    "we explored the influence on wave properties of ( 1 ) different riemann solvers with different accuracy , ( 2 ) spatial resolution , ( 3 ) different forms of the softened planetary potential , and ( 4 ) softening length of the planetary potential .",
    "we find the spatial distribution of the amf and torque to be a more sensitive probe of the effects of various numerical parameters on the wave evolution than the distortions of the density wave profile . based on this study",
    "we conclude that a very high resolution ( ensuring low numerical viscosity ) , high order of accuracy , and an accurate prescription of planetary potential with small softening length are critical for accurately reproducing the key features of the wave evolution in linear regime .    we demonstrate that low order of accuracy , low spatial resolution , and inaccurate potential with large softening length often employed in global disk - planet interaction studies can severely affect the fidelity of their results , especially in applications to planet migration and gap opening .",
    "specifically , we conduct a test run with typical numerical parameters from recent literature . comparing with the analytical theory ,",
    "the test run produces a lower amplitude of the density wave ( by @xmath277 ) , a lower final accumulated torque ( by @xmath252 ) , and a largely advanced starting point of wave dissipation ( a factor of @xmath278 ) .",
    "most of our own calculations were carried out with third order of accuracy , resolution of @xmath85 , softening length @xmath86 and a potential that rapidly converges to newtonian ( as @xmath279 ) at large separation @xmath74 from the planet .",
    "this set of numerical parameters allows us to obtain excellent agreement with linear theory in athena , but is not meant to be universal for other codes .",
    "however , the way in which we make the comparison with the theory and the agreement we achieve may serve as a standard framework for future code tests .",
    "we also discover a numerical problem which is largely ignored in previous simulations of disk - planet interactions . to follow the fluid motion correctly",
    ", the time - step in a simulation has to be smaller than the local dynamical timescale by a certain factor ( @xmath280 in our case using athena ) in the entire domain , including the region where the fluid experiences the largest gravitational acceleration ( _ e.g. _ the vicinity of the planet ) . in the context of numerical disk - planet studies , violation of this condition leads to inaccurate calculation of wave properties , lack of convergence on long time scales , and spurious repulsion of gas by planet similar to gap opening .",
    "this timescale issue applies to disk - planet simulations in general , but it particularly affects the ones which use the orbital advection algorithm ( fargo ) , in which cases a significant increase of the time step is usually allowed to speed up calculations .    in paper ii , we will continue our investigation of the disk - planet interaction by looking at the details of the density wave evolution in the nonlinear phase .",
    "we are grateful to jeremy goodman , takayuki muto , zhaohuan zhu , and an anonymous referee for useful discussions and comments .",
    "the financial support of this work is provided by nsf grant ast-0908269 and sloan fellowship awarded to rrr ."
  ],
  "abstract_text": [
    "<S> density waves excited by planets embedded in protoplanetary disks play a central role in planetary migration and gap opening processes . </S>",
    "<S> we carry out 2d shearing sheet simulations to study the linear regime of wave evolution with the grid - based code athena , and provide detailed comparisons with the theoretical predictions . low mass planets ( down to @xmath0 at 1 au ) and high spatial resolution ( 256 grid points per scale height ) are chosen to mitigate the effects of wave nonlinearity . to complement the existing numerical studies , we focus on the _ primary _ physical variables such as the spatial profile of the wave , torque density , and the angular momentum flux carried by the wave , instead of _ secondary _ quantities such as the planetary migration rate . </S>",
    "<S> our results show _ percent _ level agreement with theory in both physical and fourier space . </S>",
    "<S> new phenomena such as the change of the toque density sign far from the planet are discovered and discussed . also , we explore the effect of the numerical algorithms , and find that a high order of accuracy , high resolution , and an accurate planetary potential are crucial to achieve good agreement with the theory . </S>",
    "<S> we find that the use of a too large time - step without properly resolving the dynamical time scale around the planet produces incorrect results , and may lead to spurious gap opening . </S>",
    "<S> global simulations of planet migration and gap opening violating this requirement may be affected by spurious effects resulting in e.g. the incorrect planetary migration rate and gap opening mass . </S>"
  ]
}