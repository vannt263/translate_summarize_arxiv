{
  "article_text": [
    "in this paper we will examine and generalize the algebra problems listed immediately below from the point of view of spaces of non - positive curvature .",
    "let @xmath2 be either the field @xmath3 or @xmath4 , and let @xmath5 be a nonarchimedean valued field with discrete valuation ring @xmath6 and the value group @xmath7 . for simplicity ,",
    "let us consider here and throughout this introduction a split reductive group @xmath8 over @xmath0 , see chapter [ sect : organizing algebra ] for a more general discussion .",
    "eigenvalues of a sum . *",
    "set @xmath9 , let @xmath10 be a maximal compact subgroup of @xmath11 .",
    "let @xmath12 be the lie algebra of @xmath11 , and let @xmath13 be its cartan decomposition .",
    "give necessary and sufficient conditions on @xmath14 in order that there exist elements @xmath15 whose projections to @xmath16 are @xmath17 and @xmath18 , respectively , so that @xmath19 * * q2 .",
    "singular values of a product .",
    "* let @xmath11 and @xmath10 be the same as above .",
    "give necessary and sufficient conditions on @xmath20 in order that there exist elements @xmath21 whose projections to @xmath22 are @xmath23 and @xmath24 , respectively , so that @xmath25 * * q3 .",
    "invariant factors of a product . * set @xmath26 and @xmath27 .",
    "give necessary and sufficient conditions on @xmath28 in order that there exist elements @xmath21 whose projections to @xmath22 are @xmath23 and @xmath24 , respectively , so that @xmath25 * * q4 . decomposing tensor products .",
    "* let @xmath29 be the langlands dual group of @xmath8 , see definition [ langlandsdual ] .",
    "give necessary and sufficient conditions on highest weights @xmath30 of irreducible representations @xmath31 , @xmath32 , @xmath33 of @xmath34 so that @xmath35    throughout the paper we will denote by @xmath36 the sets of triples @xmath37 which are solutions of problems * qi * , @xmath38 for the group @xmath11 .",
    "we refer the reader to section [ linalg ] for _ linear algebra _ reformulations of the problems * q1 , q2 , q3 * in the case when @xmath39 and to section [ geo = hecke ] for reformulation of * q3 * in terms of the hecke ring .",
    "the above problems have a long history which is described in detail in @xcite , we briefly discuss it in section [ linalg ] .    to state our main results we need several notation .",
    "the quotient spaces @xmath16 and @xmath22 in problems * q1 * and * q2 * are naturally identified with the euclidean weyl chamber @xmath40 inside a cartan subspace @xmath41 .",
    "the double coset space appearing in problem * q3 * is a more subtle discrete object , namely the intersection of @xmath40 with the _ cocharacter lattice _",
    "@xmath42 ( see section [ duality ] for the precise definition ) .",
    "the appearance of the dual group @xmath43 in problem * q4 * is explained by the fact that the cocharacter lattice of @xmath8 is the same as the character lattice of the dual group @xmath44 , see section [ duality ] .",
    "we let @xmath45 denote the lattice @xmath46 here @xmath47 is the coroot lattice of @xmath8 .",
    "the importance of the lattice @xmath45 comes from the inclusion @xmath48 next we need the number @xmath49 , the _ saturation factor _ associated with the root system @xmath50 of the group @xmath8 ; it is computed in the table [ tab ] in section [ sec : satfactor ] . for a split rank @xmath51 simple algebraic group @xmath8 over @xmath5",
    "these numbers are defined as follows .",
    "let @xmath50 be the associated root system , let @xmath52 be the simple roots and @xmath53 be the highest root : @xmath54 then @xmath49 is the least common multiple of @xmath55 .    with these notation ,",
    "the main result of this paper is the following chain of relations between the problems * q1q4 * :    [ mainthm ] 1 .",
    "@xmath56    \\2 .",
    "@xmath57    \\3 . for the root systems @xmath58 and @xmath59 we have @xmath60 and @xmath61    \\4",
    ". even if @xmath8 is not necessarily split , for @xmath62 , the solution set @xmath63 depends only on the ( finite ) weyl group of @xmath11 .",
    "it is a convex homogeneous polyhedral cone @xmath64 contained in @xmath65 .",
    "a description of the linear inequalities defining this cone can be found in section [ polyhedron ] .",
    "even if @xmath8 is not necessarily split , for @xmath66 , the solution set @xmath67 depends only on the affine weyl group of @xmath11 .",
    "the equivalence of problems * q1 * and * q2 * ( known as thompson s conjecture ) for some classical groups ( including @xmath68 ) was proved by klyachko in @xcite , for all complex semisimple groups by alexeev , meinrenken and woodward in @xcite , and in general case by evens and lu in the recent paper @xcite , using different methods .",
    "the above saturation constants @xmath49 are not necessarily the smallest possible , for instance , in  [ semigroup ]",
    "we prove that for the group @xmath8 with the root system @xmath59 , @xmath69    it is well - known , that @xmath70 see theorem [ vectorsandngons ] in the appendix . in the forthcoming paper @xcite it",
    "is shown that @xmath71    despite of the algebraic appearance of the results of the main theorem , its main source is _ geometry _ , the sole exception is the relation between * q3 * and * q4 * which is proven via _",
    "satake correspondence_. in this paper , we reformulate the algebra problems * q1**q3 * as _ geometric problems _ which are special cases of a geometric question raised and studied in @xcite :    we fix a euclidean coxeter complex @xmath72 with the euclidean weyl chamber @xmath73 , and consider nonpositively curved metric spaces @xmath74 with geometric structures _ modeled on _ @xmath72 . the spaces of this kind which we are interested in are symmetric spaces of nonpositive curvature , their infinitesimal versions ( _ infinitesimal symmetric spaces _ , see section [ geometries ] ) , and euclidean buildings .",
    "for such spaces @xmath74 there is a notion of @xmath40-length for oriented geodesic segments which reflects the anisotropy of @xmath74 .",
    "this leads to the following problem :    * * gti : generalized triangle inequalities .",
    "* give necessary and sufficient conditions on @xmath75 in order that there exists a geodesic triangle in @xmath74 with @xmath40-side lengths @xmath17 and @xmath18 .",
    "we refer to the solution set of * gti * as @xmath76 .",
    "as explained in section [ geodesic polygons ] , for a symmetric space @xmath74 , the problem * gti * is equivalent to the singular value problem * q2*. for an infinitesimal symmetric space @xmath77 , it is equivalent to the eigenvalues of a sum problem * q1 * :    [ equ ] suppose that @xmath8 is a reductive algebraic group over @xmath3 and @xmath78 or @xmath79 ; let @xmath80 be the symmetric space corresponding to @xmath81 and @xmath77 be the infinitesimal symmetric space .",
    "then @xmath82    the invariant factor problem * q3 * corresponds to the case when @xmath74 is a euclidean building and in this case the inequalities defining @xmath76 give only _ necessary _ conditions on @xmath83 to solve the algebraic problem * q3*. the key difference with the problems * q1 , q2 * is lack of homogeneity in euclidean buildings @xmath74 : _ not all vertices of @xmath74 are special _ ( except for the buildings of type @xmath84 ) .",
    "this eventually explains why for the euclidean building @xmath74 corresponding to some groups @xmath85 we have the inequality @xmath86    we refer the reader to section [ geodesic polygons ] for justification of the correspondence between algebraic and geometric problems .    despite of the results of this paper , the structure of the solution sets @xmath87 ,",
    "@xmath88 remains unclear .",
    "it was known for a long time that @xmath88 is a semigroup .",
    "in contrast , we will see in section [ semigroup ] that the set @xmath89 is not a semigroup for the root systems @xmath58 and @xmath59 .",
    "the following result , a consequence of a recent theorem in logic of m.  c.  laskowski @xcite , building on work of s.  kochen @xcite , reveals the general structure of the subset @xmath90 define a subset of @xmath91 to be _ elementary _ if it is the set of solutions of a finite set of linear inequalities with integer coefficients and a finite set of linear congruences .",
    "then laskowski proves the following    [ las ] there is an integer @xmath92 , depending only on @xmath8 , such that for any nonarchimedean henselian valued field @xmath5 with value group @xmath7 and residue characteristic greater than @xmath93 we have @xmath94    it follows from theorem [ mainthm ] , part 5 , that theorem [ las ] holds for _ all _ complete nonarchimedean valued fields @xmath5 .",
    "this is because all split groups @xmath8 , as @xmath5 varies , have the same affine coxeter group .",
    "hence the set @xmath95 does not depend on @xmath5 . therefore , once the above statement is true for one of them it is true for all of them .",
    "[ lasproblem ] 1 .",
    "find the corresponding inequalities and congruences .",
    "is there an analogue of laskowski s theorem that describes the set sol(*q4 * ) ?",
    "if so find the inequalities and congruences in this case as well .",
    "we can solve the problem [ lasproblem ] and thus the problem * q3 * for the following groups :    [ typea ] if @xmath8 is covered by @xmath96 or @xmath68 then @xmath97 in other words , say for the group @xmath98 , the solution set @xmath99 is the set of triples @xmath100 in @xmath101 such that @xmath102 . here",
    "@xmath103 is the infinitesimal symmetric space of zero trace symmetric @xmath104 matrices and @xmath47 is the coroot lattice of @xmath96 .",
    "a similar statement holds for a more general class of groups , see theorem [ atype ] . for example",
    ", the conclusion of part ( a ) holds for the groups @xmath105 where @xmath106 is a division algebra over @xmath5 , see tableau des chelonages @xcite .",
    "we conclude by pointing out that for the group @xmath68 it was known since the 1960-s that @xmath107 and therefore we can use theorem [ typea ] to give a new proof of the saturation conjecture for @xmath68 ( the theorem of knutson and tao ) , see section [ saturationforgl ] .    this paper is organized as follows .",
    "in chapter [ datum ] we review root systems for algebraic reductive groups and discuss coxeter groups .",
    "in chapter [ sect : organizing algebra ] we set up the general algebra problem * r * which generalizes the setting of the problems * q1q3*. we then discuss in detail the parameter spaces for the problems * q1q4 * and their mutual relation .    in chapter [ settingupgeometry ]",
    "we first convert the problem * r * into an abstract geometry problem about existence of polygons with the prescribed generalized side - lengths ( problem [ linalgprob ] ) .",
    "next , we introduce a class of metric spaces ( metric spaces modeled on euclidean coxeter complexes ) and restate the abstract geometry problem for three classes of such spaces : infinitesimal symmetric spaces , nonpositively curved symmetric spaces and euclidean buildings .",
    "we introduce the notion of refined and coarse ( the @xmath40-length ) generalized side - lengths for the geodesic polygons in such metric spaces . for the infinitesimal symmetric spaces and symmetric spaces ,",
    "the problem of existence of polygons with the prescribed @xmath40-side lengths is adequate for solving the corresponding algebra problems ( * q1 * and * q2 * ) , but in the case of buildings it is not .",
    "this establishes the equalities and inclusions @xmath108 in theorem [ mainthm ] as well as part 4 and 5 in this theorem .    in chapter [ gau ]",
    "we describe the solution ( given in @xcite ) to the problem * gti * of existence of polygons with the prescribed @xmath40-side lengths in the above classes of metric spaces @xmath74 .",
    "we also discuss the relation of this solution to symplectic and mumford quotients .",
    "we describe the system of generalized triangle inequalities for @xmath74 and give an explicit set of inequalities in the case of root system of type @xmath109 . _",
    "the reader who is not interested in the geometric ideas behind the results of this paper can skip this chapter except for the definition of the mapping @xmath110 for buildings which will be used in chapter [ k - computation]_.    in chapter [ building ] we show that the geometry problem * gti * solved in the previous chapter is not adequate ( in the building case ) for solving the algebra problem * q3*. the key tool here is the procedure of _ folding _ of geodesic triangles in euclidean buildings into apartments . the main application of the examples constructed in this section is to establish the first inequality in part 3 of theorem [ mainthm ] .    in chapter [ k - computation ]",
    "we show that in the case of @xmath111-type root systems , the solution of the geometry problem * gti * given in chapter [ gau ] solves the algebra problem * q3 * as well : @xmath112 more generally , we establish the existence of the saturation factors @xmath113 and compute these numbers ; modulo multiplication by @xmath114 the geometry problem * gti * is equivalent to the algebra problem * q3*. this establishes part 2 of theorem [ mainthm ] .    in chapter [ 3&4 ]",
    "we reformulate problem * q3 * in terms of _ spherical hecke rings _",
    ", compare the algebraic problems * q3 * and * q4 * , establish the inclusion @xmath115 ( see part 1 of theorem [ mainthm ] ) and give our new proof of the saturation conjecture for @xmath68 .    in the appendix ,",
    "chapter [ append ] , we relate the solution set of the problem * q4 * to mumford quotients and show that the former forms a semigroup .",
    "although these results are known to experts , we include them for the sake of completeness .    during",
    "the work on this paper the first author was visiting the max plank institute ( bonn ) , he was also supported by the nsf grants dms-99 - 71404 and dms-02 - 03045 .",
    "the first and the third authors were supported by the mathematics department of the university of tbingen during their stay there in may of 2002 .",
    "the third author was supported by the nsf grant dms-01 - 04006 .",
    "the authors gratefully acknowledge support of these institutions .",
    "we are grateful the referees of this paper for their useful remarks .",
    "the authors are grateful to l.   ein , s.  kumar , t.  haines , r.  hemmecke , c.  laskowski , j.  stembridge , e.  vinberg and c.  woodward for useful conversations .",
    "we would especially like to thank steve kudla for suggesting we use the satake transform to connect problems * q3 * and * q4 * and jiu - kang yu for his help with chapter [ 3&4 ] and in particular for providing us with the proof of lemma [ basic ] .",
    "when we told g.  lusztig of our theorem [ q4->q3 ] establishing the inclusion @xmath116 for local nonarchimedean valued fields @xmath5 , he informed us that although he had not known the result before our message , it was an easy consequence of his work in @xcite .",
    "we should say that our proof depends in an essential way on lusztig s paper @xcite .",
    "we use his change of basis formulas , lemma [ expansionlemma ] , and his realization that the coefficients in one of those formulas were kazhdan - lusztig polynomials for the affine weyl group , lemma [ kazhdanlusztigestimate ] .",
    "subsequently , alternative proofs of theorem [ q4->q3 ] were given by tom haines in @xcite and by kapovich and millson in @xcite .",
    "let @xmath8 be a reductive algebraic group over a field @xmath117 and @xmath118 be a split torus in @xmath8 .",
    "our goal in this section is to describe _ the root datum _ associated to the pair @xmath119 .",
    "the reader will find the definition of root datum in @xcite .",
    "we recall that the algebraic group @xmath120 is the affine algebraic group with coordinate ring @xmath121(st-1)$ ] and comultiplication @xmath122 given by @xmath123 .",
    "[ splittorus ] an affine algebraic group @xmath118 defined over @xmath117 is a split torus of rank @xmath124 if it is isomorphic to the product of @xmath124 copies of @xmath120 .",
    "a character of an algebraic group @xmath118 defined over @xmath117 is a morphism of algebraic groups from @xmath118 to @xmath120 .",
    "the product of two characters and the inverse of a character are characters and accordingly the set of characters of @xmath118 is an abelian group denoted by @xmath125 .",
    "suppose that @xmath118 is a split torus over @xmath117 of rank @xmath124 .",
    "then the character group of @xmath118 is a lattice ( i.e. free abelian group ) of rank @xmath124 .",
    "we have @xmath126\\cong \\f[t_1,t_1^{-1},\\cdots , t_l , t_l^{-1}]$ ] .",
    "a character of @xmath118 corresponds to a hopf algebra morphism from @xmath127 $ ] to @xmath128 $ ] .",
    "such a morphism is determined by its value on @xmath129 .",
    "this value is necessarily a grouplike element ( this means @xmath130 ) .",
    "however the grouplike elements of @xmath128 $ ] are the monomials in the @xmath131 s and their inverses .",
    "the exponents of the monomial give the point in the lattice .",
    "@xmath132    we note that the previous isomorphism is realized as follows .",
    "any hopf - algebra homomorphism @xmath133 of coordinate rings is of the form @xmath134 for some integer @xmath135 .",
    "then the above isomorphism sends @xmath133 to @xmath135 .",
    "a cocharacter or a one - parameter ( algebraic ) subgroup of @xmath118 is a morphism @xmath136 .",
    "the set of cocharacters of @xmath118 will be denoted @xmath137 .",
    "suppose that @xmath118 is a split torus over @xmath117 of rank @xmath124 .",
    "then the cocharacter group of @xmath118 is a free abelian group of rank @xmath124 .",
    "we have @xmath126\\cong \\f[t_1,t_1^{-1},\\cdots , t_l , t_l^{-1}]$ ] .",
    "a cocharacter of @xmath118 corresponds to a hopf algebra morphism @xmath133 from @xmath128 $ ] to @xmath127 $ ] .",
    "such a morphism is determined by its value on @xmath138 .",
    "then @xmath133 corresponds to the lattice vector @xmath139 where @xmath140 .",
    "we define an integer - valued pairing @xmath141 between characters and cocharacters as follows .",
    "suppose @xmath142 is a cocharacter of @xmath118 and @xmath143 is a character .",
    "then @xmath144 .",
    "we define @xmath145 to be the integer corresponding to @xmath146 .",
    "we now describe two homomorphisms that will be useful in what follows .",
    "let @xmath147 be the zariski tangent space of @xmath118 at the identity @xmath148 .",
    "[ derivativeofacocharacter ] we define @xmath149 by @xmath150 here @xmath151 is the identity of @xmath152 and @xmath153 denotes the derivative at @xmath151 .",
    "we also define @xmath154 by @xmath155    the character and cocharacter groups @xmath156 are multiplicative groups , the trivial ( co)character will be denoted by @xmath151 .",
    "however , we will use the embeddings @xmath157 and @xmath158 to identify them with additive groups .",
    "this will be done for the most part in chapters [ sect : organizing algebra ] and [ 3&4 ] .",
    "the reductive group @xmath8 picks out a distinguished finite subset of @xmath125 , the _ relative root system _ @xmath159 .",
    "a character of @xmath118 is a _ root _ if it occurs in the restriction of the adjoint representation of @xmath8 to @xmath118 .",
    "we let @xmath160 denote the subgroup of @xmath125 generated by @xmath50 and define @xmath161 .",
    "we recall    [ splitgroup ] the algebraic group @xmath8 is _ split over @xmath117 _ if it has a maximal torus @xmath118 defined over @xmath117 , which is split .    from now on",
    "we assume @xmath8 is split over @xmath117 and @xmath118 is a maximal torus as in the above definition .",
    "it is proved in @xcite , that @xmath162 satisfies the axioms of a root system .",
    "moreover in the same section it is proved that to every root @xmath163 there is an associated coroot @xmath164 such that @xmath165 .",
    "we let @xmath166 denote the resulting set of coroots , let @xmath167 be the subgroup of @xmath137 they generate and @xmath168 . the root and coroot system @xmath50 and @xmath166 determine ( isomorphic ) finite weyl groups",
    "@xmath169 which acts on @xmath170 and @xmath171 respectively",
    ". the action of the generators @xmath172 of the group @xmath169 on @xmath125 and @xmath137 are determined by the formulae : @xmath173    we then have @xcite :    the quadruple @xmath174 is a _ root datum_.",
    "let @xmath175 and @xmath176 be root data",
    ". then an _ isogeny _ from @xmath177 to @xmath178 is a homomorphism @xmath142 from @xmath179 to @xmath74 such that @xmath142 is injective with finite cokernel .",
    "moreover we require that @xmath142 induces a bijection from @xmath180 to @xmath50 and the transpose of @xmath142 induces a bijection of coroots .",
    "now suppose @xmath181 is a covering of algebraic groups .",
    "if @xmath118 is a maximal torus in @xmath8 then its image @xmath182 is a maximal torus in @xmath183 .",
    "the induced map on characters gives rise to an isogeny of root data , denoted @xmath184 .",
    "conversely , we have ( * ? ? ?",
    "* theorem 2.9 ) :    1 .   for any root datum @xmath178 with reduced root system there exist a connected split ( over @xmath117 ) reductive group @xmath185 and a maximal split torus @xmath118 such that @xmath186 .",
    "the pair @xmath187 is unique up to isomorphism .",
    "2 .   let @xmath186 and @xmath188 and @xmath142 be an isogeny from @xmath177 to @xmath178 .",
    "then there is a covering @xmath189 with the image of @xmath118 equal to @xmath182 such that @xmath190 .    before stating the next definition we need a lemma which we leave to the reader .",
    "if @xmath191 is a root datum so is @xmath192 .",
    "we now have    [ langlandsdual ] let @xmath8 be a ( connected ) split reductive group over @xmath0 .",
    "let @xmath193 @xmath191 be the root datum of @xmath187 .",
    "then the _ langlands dual _",
    "@xmath29 of @xmath8 is the unique ( up to isomorphism ) reductive group over @xmath0 which has the root datum @xmath194 .",
    "in fact we will need only the complex points @xmath195 of @xmath29 in what follows .",
    "we will accordingly abuse notation and frequently refer to @xmath43 as the langlands dual of @xmath8 .",
    "one has @xmath196      in this section we review the properties of coxeter groups , we refer the reader for a more thorough discussion to ( * ? ? ?",
    "* section 4.2 ) and @xcite .",
    "let @xmath197 be a root system of rank @xmath135 on a real euclidean vector space @xmath171 .",
    "we do not assume that @xmath135 equals the dimension of @xmath171 .",
    "note that in the case of semisimple lie algebras , the space @xmath171 will be a cartan subalgebra @xmath198 with the killing form .",
    "we will sometimes identify @xmath171 and @xmath199 using the metric .",
    "let @xmath200 denote _ the root lattice _",
    ", i.e. the integer span of @xmath50 .",
    "this subgroup is a lattice in @xmath201 , it is a discrete free abelian subgroup of rank @xmath135 . given a subgroup @xmath202 we define a collection @xmath203 of hyperplanes ( called _ walls _ ) in @xmath171 as the set @xmath204 in this paper we will be mostly interested in the case when @xmath45 is either @xmath7 or @xmath3 , but much of our discussion is more general .",
    "we define an _ affine coxeter group _ @xmath205 as the group generated by the reflections @xmath206 in the hyperplanes @xmath207 .",
    "the only reflection hyperplanes of the reflections in @xmath208 are the elements of @xmath209 .",
    "the pair @xmath210 is called a _ euclidean coxeter complex _ , where @xmath211 is the euclidean space .",
    "the _ vertices _ of the coxeter complex are points which belong to the transversal intersections of @xmath135 walls in @xmath209 .",
    "( this definition makes sense even if @xmath212 , only in this case there will be continuum of vertices even if @xmath213 . ) if @xmath208 is trivial , we declare _ each point _ of @xmath214 a vertex .",
    "we let @xmath215 denote the vertex set of the coxeter complex .",
    "an _ embedding of euclidean coxeter complexes _ is a map @xmath216 , where @xmath217 is a monomorphism of coxeter groups and @xmath218 is a @xmath142-equivariant affine embedding .",
    "let @xmath219 denote the translational part of @xmath208 .",
    "if @xmath213 then @xmath219 is the _ coroot lattice _ @xmath167 of @xmath50 . in general ,",
    "the linear part @xmath221 of @xmath208 is a finite coxeter group acting on @xmath171 , it is called a _",
    "spherical coxeter group_. the stabilizer of the origin @xmath222 ( which we will regard as a base - point @xmath223 ) in @xmath208 maps isomorphically onto @xmath221 .",
    "thus @xmath224 .",
    "a vertex of the euclidean coxeter complex is called _ special _ if its stabilizer in @xmath208 is isomorphic to @xmath221 .",
    "we let @xmath225 denote the set of special vertices of @xmath214 .",
    "the normalizer @xmath226 of @xmath208 ( in the full group @xmath171 of translations on @xmath214 ) acts transitively on the set of special vertices .",
    "the vertex set @xmath215 of the complex @xmath210 contains @xmath227 , but typically it is strictly larger that .",
    "moreover , in many cases @xmath215 does not form a group .",
    "we recall that the weight group @xmath228 and the coweight group @xmath229 are defined by @xmath230    in the case when @xmath212 our definition of weights is different from the one in @xcite .",
    "again , @xmath228 and @xmath229 are lattices provided that @xmath231 , otherwise they are nondiscrete abelian subgroups of @xmath171 .",
    "we have the inclusions @xmath232 the normalizer @xmath226 equals @xmath233 .",
    "the spherical coxeter groups @xmath221 which appear in the above construction act naturally on the sphere at infinity @xmath234 ; the pair @xmath235 is called a _",
    "spherical coxeter complex_. the definitions of _ walls _ , _ vertices _ , etc .",
    ", for euclidean coxeter complexes generalize verbatum to the spherical complexes .",
    "we will use the notation @xmath236 for the spherical weyl chamber , @xmath237 is the ideal boundary of the euclidean weyl chamber @xmath238 ( i.e. a fundamental domain for the action @xmath239 , which is bounded by walls ) .    from our viewpoint ,",
    "the euclidean coxeter complex is a more fundamental object than a root system .",
    "thus , if the root system @xmath50 was not reduced , we replace it with a reduced root system @xmath240 which has the same group @xmath208 : if @xmath241 we retain the root @xmath242 and eliminate the root @xmath243 .",
    "we will assume henceforth that the root system @xmath50 is reduced .    .",
    "suppose that @xmath210 is a euclidean coxeter complex associated with the reduced root system @xmath50 , let @xmath244 denote the decomposition of @xmath50 into irreducible components .",
    "accordingly , the euclidean space @xmath214 splits as the metric product @xmath245 where @xmath246 is spanned by @xmath247 , @xmath248 .",
    "this decomposition is invariant under the group @xmath208 which in turn splits as @xmath249 where @xmath250 for each @xmath251 ; for @xmath252 we get the trivial coxeter group @xmath253 .",
    "the group @xmath254 is the image of @xmath255 under the natural embedding of affine groups @xmath256 .",
    "analogously , the spherical coxeter group @xmath221 splits as the direct product @xmath257 ( where @xmath258 ) .",
    "the weyl chamber @xmath40 of @xmath221 is the direct product of the weyl chambers @xmath259 , where @xmath260 is a weyl chamber of @xmath261 and @xmath262 .",
    "similarly , the normalizer @xmath226 of @xmath208 splits as @xmath263 where @xmath264 is the vector space underlying @xmath265 and @xmath266 is the normalizer of @xmath254 in the group of translations of @xmath246 .",
    "note that for each @xmath251 the groups @xmath254 and @xmath266 act as lattices on @xmath246 .",
    "we observe that the vertex set of the complex @xmath72 equals @xmath267 where @xmath268 is the vertex set of the complex @xmath269 .",
    "similarly , the set of special vertices @xmath225 of @xmath214 equals @xmath270    our discussion of coxeter groups was somewhat nongeometric ; a more geometric approach would be to start with an affine coxeter group and from this get root systems , etc .",
    "we will see in this chapter that the problems * q1**q3 * for reductive algebraic groups @xmath11 can reformulated as special cases of a single algebraic problem as follows . there is a group @xmath273 ( closely associated to @xmath11 ) which contains @xmath10 , a maximal bounded subgroup of @xmath11 .",
    "the conditions of fixing @xmath274 , @xmath275 and @xmath24 in problems * q1**q3 * will amount to fixing three double cosets in @xmath276 .",
    "the problems * q1**q3 * will be then reformulated as :    * * problem r(@xmath277 ) * : find necessary and sufficient conditions on @xmath278 in order that there exist @xmath279 in the double cosets represented by @xmath280 resp .",
    ", such that @xmath281 .",
    "we will now describe the groups @xmath273 and @xmath10 for the problems * q1**q3*. the main part of this chapter will then be occupied with describing the double coset spaces @xmath282 . in section [ summ ]",
    "we will also prove that the problem * r(@xmath277 ) * agrees with the problem * q1 * from the introduction ( the equivalence will be clear for two other problems ) .    1 .   for the problem * q1 * : for @xmath79 or @xmath4 , let @xmath8 be a connected reductive algebraic group over @xmath283 , @xmath284 be a real or complex lie group with lie algebra @xmath285 .",
    "pick a maximal compact subgroup @xmath10 of @xmath11 .",
    "let @xmath286 denote the lie algebra of @xmath10 .",
    "then we have the orthogonal decomposition ( with respect to the killing form ) @xmath287 we let @xmath273 be the _ cartan motion group _ @xmath288 .",
    "2 .   for the problem",
    "* q2 * : @xmath8 and @xmath10 are the same as in 1 , but now we take @xmath289 .",
    "3 .   for the problem",
    "* q3 * : let @xmath5 be a complete nonarchimedean valued field with a discrete valuation @xmath290 and the value group @xmath291 .",
    "let @xmath292 denote the ring of elements in @xmath293 with nonnegative valuation .",
    "let @xmath8 be a connected reductive algebraic group over @xmath5 , @xmath294 and @xmath295 .",
    "in order to relate problems * q1**q3 * with geometry we will have to compute the double coset spaces @xmath296 .",
    "moreover we will show that the parameter spaces @xmath271 admit canonical linear structures : in the first two problems we use a cartan decomposition @xmath297 , then @xmath271 is described as the ( positive ) weyl chamber @xmath40 in @xmath298 , the lie algebra of @xmath111 . in the case of the third problem ,",
    "@xmath299 is identified with the intersection @xmath300 , where @xmath118 is a maximal @xmath5-split torus of @xmath8 and @xmath301 is _ extended cocharacter lattice _ of @xmath118 ( see section [ tough ] ) .",
    "we continue with the notation of previous section , in particular , @xmath302 .",
    "we now describe the parameter space @xmath303 .",
    "we choose a cartan subspace @xmath304 ( i.e. a maximal subalgebra of @xmath305 , necessarily abelian and reductive ) .",
    "we recall that the positive euclidean weyl chamber @xmath122 is the dual cone in @xmath306 to the cone of positive restricted roots in @xmath307 .",
    "the inclusion @xmath308 given @xmath309 induces a bijection onto @xmath271 .",
    "we first observe that since @xmath310 , every double coset in @xmath311 has a representative of the form @xmath312 .",
    "since @xmath313 the lemma is clear .",
    "we complete the proof of equivalence of * r*(@xmath277 ) with problem * q1 * by observing that for @xmath314 , @xmath315 , @xmath316    we see from ( [ add ] ) that if @xmath317 then putting @xmath318 we find @xmath319    thus we find representatives @xmath320 and @xmath321 in @xmath77 of the orbits @xmath322 whose sum equals zero ( i.e. we have a solution of the eigenvalues of a sum problem ) .",
    "conversely , if @xmath323 solve the eigenvalues of a sum problem then @xmath324 and hence @xmath325 solve the double coset problem * r*(@xmath277 ) .",
    "thus we may find @xmath111 , @xmath326 and @xmath327 in @xmath273 in the required @xmath10-double cosets with @xmath281 if and only if there exist @xmath328 with @xmath329 in the required @xmath330-orbits in @xmath77 .",
    "let @xmath331 and consider the cartan decomposition @xmath297 where @xmath111 is the maximal abelian subgroup of @xmath277 , whose lie algebra is the cartan subalgebra @xmath332 from the previous section .",
    "we will identify @xmath111 and @xmath333 via the exponential map , let @xmath334 .",
    "then we get the refinement of the cartan decomposition : @xmath335 .",
    "it is now clear that the inclusion @xmath336 given by @xmath337 induces a bijection onto @xmath338 . in",
    "what follows we will parameterize double cosets in @xmath299 by their logarithms , which are vectors in @xmath122 .",
    "the goal of this section is to give an explicit description of the parameter space @xmath339 for the invariant factor problem * q3*. we start by noticing that the discrete valuation @xmath340 admits a splitting @xmath341 : it is given by sending @xmath342 to the uniformizer @xmath343 . throughout this section",
    ", @xmath8 will denote a connected reductive algebraic group over @xmath5 , which has the ( relative ) rank @xmath124 .",
    "let @xmath344 be a maximal @xmath5-split torus , and let @xmath125 and @xmath137 be the lattices of characters and cocharacters .",
    "we denote by @xmath345 be a minimal parabolic subgroup such that @xmath346 is a parabolic pair , ( * ? ? ?",
    "this data determines a ( relative ) root system @xmath347 and hence a ( relative ) finite weyl group @xmath221 .",
    "let @xmath348 and @xmath349 be respectively the centralizer and normalizer ( over @xmath5 ) of the algebraic group @xmath118 . as usual",
    "we let @xmath350 and @xmath129 denote the groups of @xmath5-points of the corresponding algebraic groups .",
    "we let @xmath10 denote @xmath351 and @xmath352",
    ". we will frequently refer to @xmath11 as a _ nonarchimedean reductive lie group_.    as in the previous section , we have to discuss the cartan decomposition @xmath353 of the group @xmath11 ( where @xmath354 will be an appropriate subset of @xmath355 ) . in the split case this decomposition will have the form @xmath356 , where @xmath357 and @xmath111 will be a subgroup of @xmath129 so that @xmath358 .",
    "we can now describe @xmath359 , the parameter space for the generalized invariant factors problem for the nonarchimedean reductive lie group @xmath11 .",
    "* split case .",
    "* we first consider the case when @xmath8 is split over @xmath5 since the description is more transparent in this case . in this case",
    "there is an algebraic group defined and split over @xmath0 and in fact a group scheme over @xmath7 such that @xmath8 is obtained from it by extension of scalars .",
    "we will abuse notation and also denote the above group - scheme over @xmath7 by @xmath8 as well . under this assumption the torus @xmath118",
    "is also defined and split over @xmath0 , hence the group of real points of @xmath118 is well - defined .",
    "we thus consider the real torus @xmath360 with the _ real _ lie algebra @xmath298 .",
    "the map @xmath157 of definition [ derivativeofacocharacter ] ( with @xmath361 ) gives us an identification @xmath362 then the group @xmath137 is identified with a lattice @xmath363 in @xmath298 .",
    "similarly we use the map @xmath158 to identify @xmath125 with a lattice in the dual space @xmath364 .",
    "the root system @xmath50 sits naturally in the dual space @xmath364 and the corresponding finite weyl group @xmath221 acts on @xmath298 and @xmath364 in the usual way ; @xmath221 leaves invariant the lattices @xmath137 and @xmath125 .",
    "let @xmath238 be the ( positive ) weyl chamber of the group @xmath221 , determined by the parabolic subgroup @xmath365 .",
    "our goal is to prove that the space @xmath366 can be identified with the `` cone '' @xmath367    by definition , a cocharacter @xmath142 is a homomorphism from the group @xmath368 to the group @xmath129 : note that the map @xmath369 given by @xmath370 is injective ( where @xmath371 is a fixed uniformizer ) .",
    "we define the subgroup @xmath111 by @xmath372    the following lemma is immediate ( it suffices to prove it for @xmath373 ) .",
    "the group @xmath129 is a direct product @xmath374 .",
    "we let @xmath375 be the image of @xmath376 under the map @xmath178 .",
    "[ thecartandecomposition ] ( see @xcite . )",
    "we have the cartan decomposition @xmath377 i.e. , each element @xmath378 has a unique representation as a product @xmath379 , where @xmath380 and @xmath381 .",
    "the inclusion @xmath382 induces a bijection@xmath383 .",
    "now that we have identified the double coset space @xmath384 with @xmath385 , it is clear that the generalized invariant factor problem * q3 * in the introduction agrees with the double coset problem * r*(@xmath11 )",
    ". however it may not be clear at this point why these problems agree with problem * p3 * in case @xmath386 .    to see this we note that we can give a second description of the vector @xmath387 if we choose coordinates in @xmath118 . let @xmath388 be a basis for the group @xmath125 and define @xmath389 to be the map with components @xmath390 .",
    "we observe that we may use the derivative of @xmath391 at @xmath148 to obtain coordinates on @xmath147 and accordingly we obtain a map @xmath392 .",
    "we leave the following lemma to the reader .",
    "@xmath393 is the ( integral ) vector in @xmath394 obtained by applying the valuation @xmath290 to the coordinates of @xmath395 .",
    "we now consider the general case when @xmath8 is not necessarily split .",
    "most of the above discussion remains valid , however the cartan decomposition for @xmath11 has a slightly different form and for this reason we _ can not _ use the cocharacter lattice as @xmath301 .",
    "we no longer can talk about _ real points _ of @xmath118 , so we do not have the interpretation of @xmath298 as a tangent space .",
    "we _ define _ @xmath298 as @xmath396 .",
    "we set @xmath397 .",
    "let @xmath214 denote the affine space underlying @xmath171 ; as before , @xmath398 is the positive weyl chamber for @xmath221 .",
    "note that @xmath399 is a subgroup of finite index .",
    "[ nu ] define the homomorphism @xmath400 by the formula ( see @xcite ) @xmath401    note that on the left hand side of the above formula , the pairing of @xmath402 with @xmath403 is coming from the pairing @xmath404 between @xmath137 and @xmath125 . on",
    "the right hand side of the equation ( [ eq : nu ] ) , the action of @xmath143 on @xmath405 is coming from the fact that each character @xmath406 defines a character of the group @xmath407 , i.e. we have @xmath408 .",
    "let @xmath409 denote the kernel of @xmath410 and let @xmath301 denote the image of @xmath410 in @xmath171 .",
    "then @xmath409 is a maximal compact subgroup of @xmath355 , see ( * ? ? ?",
    "[ col ] we will refer to the group @xmath411 as the _ extended cocharacter lattice _ of @xmath118 .",
    "we have the inclusions @xmath412 with equality in the case when @xmath8 is split over @xmath0 .",
    "the quotient group @xmath413 operates on the affine space @xmath214 faithfully , through a discrete group @xmath414 .",
    "the finite weyl group @xmath221 is the linear part of @xmath414 ( the stabilizer of the origin ) and we have @xmath415 .",
    "we refer to @xcite for more details .",
    "let @xmath416 and @xmath417 .",
    "then one has :    @xcite [ carta ] @xmath418 and the map @xmath419 given by @xmath420 descends to a bijection @xmath421 .",
    "this proves that in the nonsplit case we can also identify @xmath422 with the parameter space @xmath423 for the problem * q3*.      we can now compare the four algebra problems * q1q4 * stated in the introduction .",
    "we have already compared the parameter spaces for * q3 * and * q4 * in the introduction .",
    "to compare the first three problems we assume that we are given groups @xmath424 which are connected reductive algebraic groups ( possibly all the same ) , where the first two are defined over @xmath3 , and @xmath425 is over @xmath426 , where @xmath5 is a nonarchimedean valued field with valuation @xmath290 and value group @xmath7 .",
    "suppose that the fields @xmath427 are either @xmath3 or @xmath4 .",
    "we assume that all three lie groups @xmath428 have the same ( relative ) rank @xmath124 and isomorphic ( relative ) weyl groups @xmath429 acting on the appropriately chosen vector space @xmath298 .",
    "let @xmath430 be a ( positive ) weyl chamber .",
    "let @xmath431 be the extended cocharacter lattice , see definition [ col ] .",
    "then the parameter spaces @xmath432 for the problems * q1 * and * q2 * ( for the groups @xmath433 resp . ) are exactly the same : they are equal to @xmath40 .",
    "the parameter space @xmath434 is the intersection @xmath385 of the lattice @xmath435 with @xmath40 .",
    "note that in the special case when @xmath436 , @xmath437 , is split over @xmath0 , @xmath438 and we get a canonical isomorphism @xmath439 described in the previous section ( here @xmath298 is the _ real _ lie algebra of @xmath360 ) .",
    "this isomorphism identifies @xmath434 with the set of `` integer points '' @xmath385 in the weyl chamber @xmath40 .      in this section",
    "we reformulate problems * q1 q3 * stated in the introduction as _ linear algebra _ problems in the case when the group @xmath8 is @xmath68 .",
    "let @xmath274 , @xmath275 and @xmath24 be @xmath440-tuples of real numbers arranged in decreasing order . in problem",
    "* p3 * we let @xmath293 be a complete , nonarchimedean valued field .",
    "we assume that the valuation @xmath290 is discrete and takes values in @xmath7 .",
    "we let @xmath441 be the subring of elements with nonnegative valuation .    in order to state problems * p2 * and * p3 * below we recall some definitions from algebra .",
    "the _ singular values _ of a matrix @xmath442 are the ( positive ) square - roots of the eigenvalues of the matrix @xmath443 . to define the _ invariant factors _ of a matrix @xmath442 with entries in @xmath5 note first that it is easy to see that the double coset @xmath444 is represented by a diagonal matrix @xmath445 .",
    "the invariant factors of @xmath442 are the integers obtained by applying the valuation @xmath290 to the diagonal entries of @xmath446 .",
    "if we arrange the invariant factors in decreasing order they are uniquely determined by @xmath442 .",
    "now we can state the three algebra problems that interest us here , following the presentation in @xcite .    * * p1 .",
    "eigenvalues of a sum . *",
    "give necessary and sufficient conditions on @xmath274 , @xmath275 and @xmath24 in order that there exist hermitian matrices @xmath111 , @xmath326 and @xmath327 such that the set of eigenvalues ( arranged in decreasing order ) of @xmath111 , resp .",
    "@xmath326 , resp .",
    "@xmath327 is @xmath274 , resp .",
    "@xmath275 , resp .",
    "@xmath24 and @xmath19 * * p2 .",
    "singular values of a product . *",
    "give necessary and sufficient conditions on @xmath274 , @xmath275 and @xmath24 in order that there exist matrices @xmath111 , @xmath326 and @xmath327 in @xmath447 the logarithms of whose singular values are @xmath17 and @xmath18 , respectively , so that @xmath25 * * p3 .",
    "invariant factors of a product .",
    "* give necessary and sufficient conditions on the integer vectors @xmath274 , @xmath275 and @xmath24 in order that there exist matrices @xmath111 , @xmath326 and @xmath327 in @xmath448 with invariant factors @xmath449 and @xmath18 , respectively , so that @xmath25    we now see that the problems * pi * are equivalent to the corresponding problems * qi * ; we consider the field @xmath78 since for @xmath79 the discussion is similar .",
    "we have @xmath450 and the cartan subspace @xmath77 is the space of hermitian @xmath440-by-@xmath440 matrices , @xmath306 is the space of diagonal @xmath440-by-@xmath440 matrices with real entries and the cone @xmath451 is the cone in which the diagonal entries are arranged in decreasing order .",
    "the maximal compact subgroup @xmath452 .",
    "thus the parameter space @xmath271 for the double coset @xmath453 is the cone of @xmath440-tuples of real numbers arranged in decreasing order .",
    "this agrees with the parameter space of the problem * p1*.    \\2 .",
    "observe that the cartan subgroup @xmath454 consists of diagonal matrices with positive diagonal entries , @xmath455 consists of matrices @xmath456 with diagonal entries arranged in the decreasing order , and the projection @xmath457 of @xmath458 to @xmath459 is given by first sending @xmath458 to @xmath460 , then diagonalizing @xmath461 , arranging the diagonal values in the decreasing order and then taking their logarithms . thus @xmath462 is given by the vector whose components are the logarithms of the singular values of the matrix @xmath458 .",
    "we conclude that problem * p2 * is equivalent to the problem * q2*.    \\3 .",
    "the torus @xmath463 consists of diagonal matrices with entries in @xmath5 ; we find that @xmath464 is the diagonal matrix with diagonal entries @xmath465 , where @xmath142 corresponds to the lattice vector @xmath466 .",
    "therefore * p3 * @xmath467 * q3*.    to unify the notation , in what follows we will refer to the problem * q4 * for the group @xmath68 as * p4*.    the complete solution of problems * p1p4 * and the relation between them were established only recently due to the efforts of several people .",
    "after much classical work , a.  klyachko in @xcite proved that sol(*p1 * ) is a polyhedral cone in @xmath468 , he also computed a finite system of linear homogeneous inequalities describing sol(*p1 * ) in terms of the schubert calculus in the grassmannians @xmath469 .",
    "this computation was subsequently improved by p.  belkale @xcite .",
    "a.  klyachko then proved in @xcite that sol(*p1*)=sol(*p2 * ) , which was known as _",
    "conjecture_.    the sets of solutions for problems * p3 * and * p4 * are also the same , namely they are integral points in the above polyhedral cone .",
    "this result is due to p.  hall , j.  green and t.  klein , see @xcite and @xcite ; see also ( * ? ? ?",
    "100 ) for the history of this problem .",
    "in this paper we show ( theorem [ q4->q3 ] ) that the inclusion @xmath470 is true for _ all _ split reductive groups over @xmath0 .",
    "this was the harder of the two implications for @xmath68 , proved by t.  klein in @xcite and @xcite , see also ( * ? ? ?",
    "94100 ) .    the exceptional ( i.e. not true for all split reductive groups ) inclusion @xmath471 was first proved for @xmath68 by p.  hall but not published .",
    "in fact it follows from a beautiful and elementary observation of j.  green , which is set forth and proved in ( * ? ? ?",
    "91 - 92 ) , and which we will outline in  [ saturationforgl ] .",
    "the description of the solutions to problem * p4 * as the set of integral points in the polyhedral cone sol(*p1 * ) ( known as the _ saturation conjecture _ ) is due to a.  knutson and t.  tao , @xcite ( see also @xcite for a proof using quivers and @xcite for a proof in the spirit of the present paper using littelmann s path model ) .",
    "the knutson - tao theorem combined with the above equivalence of problems * p3 * and * p4 * establishes that the set of solutions to problem * p3 * is also the set of integral points in the above polyhedral cone .    in the present paper",
    "we reverse this path : we first prove directly that the set of solutions to problem * p3 * is the set of integral points in the above polyhedral cone , then using the above equivalence of problems * p3 * and * p4 * we deduce that this set is also the set of solutions to problem * p4 * , thus providing yet another proof of the saturation conjecture .",
    "we refer to @xcite , @xcite , @xcite , @xcite , @xcite @xcite , @xcite , @xcite , @xcite , @xcite for more details and further developments .",
    "in this chapter we will show that the algebra problems * r*(@xmath277 ) from chapter [ sect : organizing algebra ] can be restated geometrically , in terms of the existence of triangles with the prescribed `` side - lengths '' in three classes of spaces of nonpositive curvature , which are :    1 .",
    "@xmath74 is an",
    "_ infinitesimal symmetric space _ ( a cartan motion space ) , @xmath472 .",
    "@xmath74 is a symmetric space of nonpositive curvature .",
    "@xmath74 is an euclidean building .",
    "we start with a purely set - theoretic discussion .",
    "let @xmath74 be a set with a base - point @xmath473 , and let @xmath277 is a group acting on @xmath74 .",
    "let @xmath10 denote the stabilizer of @xmath473 in @xmath11 .",
    "in general , the @xmath277-action is not transitive ( such examples will appear when @xmath74 is a euclidean building ) , we let @xmath474 denote the orbit @xmath475 . for pairs of points @xmath476 we define the invariant @xmath477 as the projection of @xmath478 to @xmath479 .",
    "we will regard @xmath480 as the `` generalized @xmath277-invariant distance '' between points in @xmath74 .",
    "given @xmath481 we regard the set @xmath482 as the `` sphere of radius @xmath483 '' centered at @xmath473 .    for pairs of points @xmath484 one can interpret the invariant @xmath485 as follows : let @xmath299 denote the quotient space @xmath486 then for pairs of points @xmath487 in @xmath474 we can identify @xmath485 with the double coset @xmath488 .",
    "in other words , translate the pair @xmath489 by @xmath490 to @xmath491 and then project @xmath492 to the element @xmath493 .",
    "then two pairs @xmath489 and @xmath494 in @xmath495 belong to the same @xmath277-orbit if and only if @xmath496 ; hence , @xmath497 can be bijectively identified with @xmath498 .",
    "we will use the notation @xmath499 for the map @xmath500 .",
    "for @xmath501 we let @xmath502 denote @xmath503 .",
    "it is now clear that the problem * r*(@xmath277 ) stated in chapter [ sect : organizing algebra ] can be restated as a special case ( @xmath504 ) of the following :    [ linalgprob ] give conditions on the vector of generalized side - lengths @xmath505 that are necessary and sufficient in order that there exist elements @xmath506 in @xmath273 such that @xmath507    we set @xmath508 .",
    "note that @xmath509 acts on @xmath292 by right and left multiplications .",
    "motivated by the connection between the moduli spaces of @xmath135-gons and symplectic quotients when @xmath474 is a complete simply - connected 3-dimensional riemannian manifold of constant curvature ( see @xcite , @xcite ) , @xcite ) we define the  momentum map \" @xmath510 by @xmath511 we define the analogue of the symplectic quotient of @xmath292 by @xmath10 , by @xmath512 here we divide out by the diagonal action of @xmath10 , where @xmath10 acts on each factor by _",
    "this action is the only action of @xmath10 on @xmath292 that we will use henceforth .",
    "we let @xmath513 be the subset of @xmath514 such that @xmath515 .",
    "thus @xmath513 is the set of solutions of the problem [ linalgprob ] and @xmath516 is its quotient by @xmath10 .",
    "our goal now is to reformulate the problem [ linalgprob ] in more geometric terms .",
    "an _ @xmath135-gon _ ( or _ a closed @xmath135-gonal linkage _ ) in @xmath74 with the vertices @xmath517 is an @xmath135-tuple @xmath518 , regarded as a map @xmath519 .",
    "the _ generalized side - lengths _ of the polygon @xmath520 are the elements @xmath521 thus for each @xmath135-gon we get a vector @xmath522 of its generalized side - lengths .",
    "the group @xmath277 acts naturally on the space @xmath523 of all @xmath135-gons , preserving the generalized side - lengths of the polygons .",
    "fix @xmath522 and form the space @xmath524 and its quotient , the _ moduli space _ of polygons with the fixed side - lengths in @xmath74 : @xmath525 in the case when @xmath74 is a topological space and @xmath277 acts homeomorphically on @xmath74 we give the space @xmath526 the quotient topology .",
    "we note that @xmath527 sits naturally in @xmath523 as the subset of polygons with vertices in @xmath474 .",
    "the generalized side - lengths of the polygons with vertices in @xmath474 are regarded as elements of @xmath528 .",
    "we define a map @xmath529 by @xmath530 we see that @xmath157 is @xmath10-equivariant ( recall that @xmath10 acts on @xmath292 by conjugation on each factor ) .",
    "[ trick ] the map @xmath157 induces a surjection @xmath531 from @xmath516 onto the moduli space @xmath532 .",
    "we first verify that each polygon @xmath533 has the `` correct '' side - lengths . by the left - invariance of @xmath480 we have @xmath534 to prove surjectivity of the map @xmath531",
    "let @xmath535 .",
    "choose @xmath458 such that @xmath536 and replace @xmath537 by @xmath538 . since @xmath539 and ( now ) @xmath540 we find that @xmath541 .",
    "hence there exists @xmath542 such that @xmath543 .",
    "similarly , there exists @xmath544 such that @xmath545 .",
    "continuing in this way we get an @xmath135-tuple @xmath546 such that @xmath547 where @xmath540 .",
    "thus @xmath548 and after replacing @xmath549 with @xmath550 we get an @xmath135-tuple @xmath551 such that @xmath552 and @xmath553 .",
    "thus we find that the problem [ linalgprob ] can be solved if and only the moduli space @xmath554 is nonempty .    to prove a version of lemma [ trick ] with a _ bijective _ map and to get a better analogy with the symplectic quotients we have to make a further assumption about the action @xmath555 :    through the rest of this section we assume that @xmath277 contains a subgroup @xmath326 which acts simply - transitively on @xmath474 .",
    "now , instead of the orbits @xmath556 and their product @xmath557 we consider the intersections : @xmath558 the group @xmath10 no longer acts on @xmath559 by conjugations , instead one has the use a _ dressing action _ ,",
    "@xmath560 , see @xcite for the definition in the case when @xmath561 , @xmath562 and @xmath326 fixes a point at infinity . in the case of infinitesimal symmetric spaces @xmath563 ( where @xmath564 ) one takes @xmath565 and the adjoint action of @xmath10 as the dressing action .",
    "we now redefine the symplectic quotient as follows : @xmath566 then one gets an analogue of lemma [ trick ] ( which we do not need for the purposes of this paper ) , we refer the reader to @xcite for the discussion in the case of @xmath567 :    [ trickk ] the map @xmath157 induces a bijection @xmath568 from @xmath569 onto the moduli space @xmath554 .",
    "moreover , let @xmath474 be a topological space and @xmath570 .",
    "then the quotient spaces @xmath569 and @xmath571 have natural topology and the bijection @xmath568 is a homeomorphism .",
    "the above discussion has been completely formal , our next goal is to describe the spaces @xmath74 which can be used to analyze the problem [ linalgprob ] for various groups @xmath277 .",
    "fix a spherical or euclidean coxeter complex @xmath572 , where @xmath111 is a euclidean space @xmath214 or a sphere @xmath573 and @xmath574 or @xmath429 is a ( possibly nondiscrete ) euclidean or a spherical coxeter group acting on @xmath111 . if @xmath575 is discrete then the coxeter complex @xmath572 is called _ discrete_. in the case of euclidean coxeter complexes we let @xmath576 denote the translation subgroup of @xmath575 . pick a special vertex @xmath223 with stabilizer @xmath221 ( see chapter [ datum ] ) and let @xmath238 be a weyl chamber of @xmath221 .",
    "we will use the notation @xmath237 to denote the ideal boundary of @xmath122 ; @xmath237 is contained in the sphere @xmath573 which will be regarded as the sphere at infinity of @xmath214 ; thus @xmath237 is a fundamental domain for the action @xmath577 .",
    "let @xmath355 be a metric space .",
    "a _ geometric structure _ on @xmath355 _ modeled on _",
    "@xmath572 consists of an atlas of isometric embeddings @xmath578 satisfying the following compatibility condition : for any two charts @xmath579 and @xmath580 , the transition map @xmath581 is the restriction of an isometry in @xmath575 . the charts and their images , @xmath582 , are called _",
    "apartments_. we will sometimes refer to @xmath111 as the _ model apartment_. we will require that there are _ plenty of apartments _ in the sense that any two points in @xmath355 lie in a common apartment .",
    "all @xmath575-invariant notions introduced for the coxeter complex @xmath583 , such as walls , singular subspaces , chambers etc . , carry over to geometries modeled on @xmath583 .",
    "one defines the group of automorphisms @xmath584 of the model apartment as the group of isometries of @xmath111 which normalize the subgroup @xmath575 .",
    "if @xmath74 is a space modeled on @xmath583 then an isometry @xmath585 is an automorphism if it sends apartments to apartments and for each pair of apartments @xmath586 the composition @xmath587 is the restriction of an automorphism of @xmath111 .",
    "the group of automorphisms of @xmath74 is denoted @xmath588 .",
    "examples of the above geometries are provided by symmetric spaces of noncompact type and their infinitesimal analogues ( infinitesimal symmetric spaces ) .",
    "these are modeled on euclidean coxeter complexes with transitive affine weyl group . in the case of a symmetric space @xmath74 , the apartments are the maximal flats .",
    "the associated coxeter complex has the form @xmath72 where @xmath214 is an apartment and @xmath208 is the group generated by reflections at singular hyperplanes .    take a real or complex reductive lie group @xmath11 , the lie algebra @xmath12 of @xmath11 has the decomposition @xmath589 , where @xmath590 is a maximal compact subgroup , let @xmath286 denote the lie algebra of @xmath10 .",
    "we will identify the cartan subspace @xmath77 with the tangent space @xmath591 to the symmetric space @xmath80 at the point @xmath592 stabilized by @xmath10 .",
    "the subspaces @xmath593 , equipped with the affine action of @xmath594 , are _ infinitesimal symmetric spaces _ in the following sense .",
    "the @xmath72-structure on @xmath74 induces a @xmath72-structure on the _ cartan subspace _",
    "@xmath595 , such that the apartments in @xmath77 are the translates of the cartan subalgebras ( i.e.  the maximal abelian subalgebras ) in @xmath77 .",
    "the apartments through @xmath596 in @xmath77 are the tangent spaces to the apartments through @xmath592 in @xmath74 .",
    "the term  infinitesimal symmetric space \" may be also justified by noting that there is a one - parameter family of spaces @xmath597 parameterized by @xmath598 and all isometric to @xmath74 for @xmath599 such that @xmath600 , see @xcite .",
    "the last kinds of geometries considered in this paper are spherical and euclidean buildings .",
    "we refer the reader to @xcite for the definitions of @xmath601 metric spaces .",
    "a _ spherical building _ is a cat(1)-space modeled on a spherical coxeter complex .",
    "we will use the notation @xmath602 for the metric in a spherical building .",
    "spherical buildings have a natural structure as polysimplicial piecewise spherical complexes .",
    "we prefer the geometric to the combinatorial view point because it appears to be more flexible .",
    "a discrete euclidean building is a cat(0)-space modeled on a discrete euclidean coxeter complex .    in the non - discrete case",
    "the definition of euclidean buildings is more subtle , see @xcite .",
    "we refer to @xcite for a thorough discussion of buildings from the geometric viewpoint .",
    "a building is called _ thick _ if every wall is an intersection of apartments . a non - thick building",
    "can always be equipped with a natural structure of a thick building by reducing the weyl group .",
    "if @xmath74 is a symmetric space of noncompact type or a thick euclidean building modeled on the coxeter complex @xmath72 , then its ideal boundary @xmath603 is a thick spherical building modeled on @xmath604 . in the case that @xmath74 is a building , the _ spaces of directions _",
    "@xmath605 are spherical buildings modeled on @xmath604 .",
    "the building @xmath605 is thick if and only if @xmath606 is a special vertex of @xmath74 .",
    "we note that in the case when @xmath74 is a discrete building , @xmath605 is just the link of the point @xmath607 .",
    "let @xmath326 be a spherical building modeled on a spherical coxeter complex @xmath608 .",
    "we say that two points @xmath609 are antipodal , if @xmath610 ; equivalently , they are antipodal points in an apartment @xmath611 containing both @xmath606 and @xmath612 . the quotient map @xmath613 induces a canonical projection @xmath614 folding the building onto its model weyl chamber .",
    "the @xmath53-image of a point in @xmath326 is called its _ type_.    to define @xmath615 pick an apartment @xmath616 containing @xmath606 and a chart @xmath617 .",
    "then @xmath615 is the projection of @xmath618 to @xmath619 .",
    "we note that this is clearly independent of @xmath616 and @xmath142 .",
    "the same definition applies in the case of euclidean buildings @xmath326 .",
    "the difference however is that the action @xmath620 in general is no longer discrete , so we can not identify the image of @xmath621 with a simplex . if @xmath208 acts as a lattice on @xmath214 , then @xmath622 can be identified with a _ fundamental alcove _ for the action @xmath620 .",
    "we now give two properties of the projection @xmath53 :    \\1 .",
    "if @xmath623 is an isomorphism of apartments in @xmath326 ( i.e. @xmath624 ) then @xmath625 .",
    "if @xmath326 is a spherical building , @xmath626 which belong to apartments @xmath627 respectively and @xmath628 are antipodal to @xmath629 , then @xmath630 implies @xmath631 . to prove this",
    "pick an isomorphism @xmath623 . then",
    "( since @xmath630 ) there exists @xmath632 such that @xmath633 . hence @xmath634 .",
    "the claim now follows from 1 .",
    "suppose that @xmath74 is a thick euclidean building modeled on a _",
    "reducible _ discrete coxeter complex @xmath72 .",
    "consider the derham decomposition of the building @xmath74 : @xmath635 where each @xmath636 is a thick euclidean building modeled on the euclidean coxeter complex @xmath637 and @xmath638 is the flat derham factor .",
    "for each @xmath251 the group @xmath639 acts as an irreducible affine coxeter group on the euclidean space @xmath246 , for @xmath252 we get the trivial coxeter group @xmath253 .",
    "accordingly , the euclidean space @xmath214 splits ( metrically ) as the product @xmath640 this decomposition is invariant under @xmath208 which in turn splits as @xmath641 as explained in section [ datum ] .      in this section we describe properties of the euclidean building ( the _ bruhat - tits building _ ) associated to a reductive nonarchimedean lie group by bruhat and tits .",
    "the reader familiar with @xcite can skip this section .",
    "let @xmath5 be a valued field with valuation @xmath290 and value group @xmath7 .",
    "let @xmath557 denote the subring in @xmath5 which consists of elements with nonnegative valuation .",
    "let @xmath8 be a connected reductive algebraic group over @xmath5 which has relative rank @xmath124 .",
    "the subgroup @xmath642 is a maximal bounded subgroup of @xmath11 . in this section",
    "we review the properties of a euclidean building @xmath643 attached to the group @xmath8 .",
    "we refer the reader to @xcite and ( * ? ? ?",
    "* chapter 7 ) for more details .",
    "we begin by recalling the notation from section [ tough ] .",
    "let @xmath344 be a maximal @xmath5-split torus , @xmath348 and @xmath349 be its centralizer and normalizer ( over @xmath5 ) respectively .",
    "we also get the groups @xmath644 and @xmath129 of @xmath5-points of the corresponding algebraic groups .",
    "then @xmath645 , where @xmath137 is the group of cocharacters of @xmath118 .",
    "the euclidean space @xmath214 is the affine space underlying @xmath171 with appropriately chosen euclidean metric .",
    "let @xmath646 denote the relative root system of the pair @xmath119 ; then @xmath221 is the finite coxeter group corresponding to this system",
    ".    definition [ nu ] gives us a homomorphism @xmath647 , with the kernel @xmath648 and the image equal to the extended cocharacter lattice @xmath301 .",
    "we also get the quotient group @xmath413 , which acts on the euclidean space @xmath214 discretely and isometrically through a group @xmath414 . unless @xmath8 is semisimple , @xmath414 _ is not _ an affine weyl group .    in the case",
    "when the group @xmath8 is simply - connected and semisimple , one can take the pair @xmath649 as the euclidean coxeter complex @xmath210 of the bruhat - tits building @xmath650 attached to the group @xmath8 .",
    "in general however it is not the case and one has to do more work to define @xmath208 .",
    "the construction of this group will be unimportant for us ( we refer to @xcite for the explicit construction ) , the important properties of @xmath208 are the following :    1 .",
    "@xmath651 , the relative rank of @xmath8 or the dimension of @xmath118 .",
    "@xmath652 is a normal subgroup ( * ? ? ?",
    "* , page 34 ) , the index @xmath653 is finite in the semisimple case .",
    "3 .   @xmath654 .",
    "@xmath208 is an affine coxeter group attached to a root system @xmath197 .",
    "the root system @xmath50 in general _ is not the same _ as @xmath347 but they have the same rank and the same finite weyl group @xmath221 , @xcite . 6 .",
    "@xmath655 , where @xmath221 is the finite weyl group as above . 7 .",
    "we have the inclusions @xmath656 8 .   if @xmath8 is a simply - connected semisimple group then @xmath657 , @xcite . if @xmath8 is split over an unramified extension of @xmath5 then @xmath658 , @xcite .",
    "if @xmath8 is split then the reduced ( bruhat - tits ) root system associated with @xmath208 is the usual reduced root system @xmath347 of the group @xmath8 ( note that @xmath347 is also the absolute root system since we are in the split case ) .    here as usual",
    ", @xmath219 is the translation subgroup of @xmath208 and @xmath226 is the normalizer of @xmath208 in @xmath171 .",
    "when we are dealing with _ the root system associated with _",
    "@xmath8 , as in 4 or 5 above , we will refer to @xmath50 , and not to @xmath347 .",
    "we will call @xmath50 the _ bruhat - tits root system _ associated with the algebraic group @xmath8 .",
    "we refer the reader to tableau des chelonages in @xcite for computation of the bruhat - tits root systems .",
    "we note that the root systems @xmath50 and @xmath347 are not very different since they have the same finite coxeter group .",
    "thus , in the irreducible case , both root systems are either isomorphic or one of them is of type @xmath659 and the other of type @xmath660 . in particular ,",
    "the _ saturation factors _ for @xmath50 and @xmath347 are exactly the same ( see chapter [ sec : satfactor ] ) .",
    "having described the properties of the coxeter complex @xmath210 , we will describe the properties of the _ bruhat - tits building _ @xmath661 associated with the group @xmath8 :    [ list ]    1 .",
    "@xmath74 is modeled on the euclidean coxeter complex @xmath72 described above .",
    "the group @xmath11 acts on @xmath74 by ( isometric ) automorphisms .",
    "3 .   the subgroup @xmath10 is the stabilizer of a special vertex @xmath473 in @xmath74 .",
    "@xmath11 acts transitively on the set of apartments in @xmath74 .",
    "5 .   for each apartment",
    "@xmath662 let @xmath663 be the stabilizer of @xmath664 in @xmath11 .",
    "then the image of @xmath663 in @xmath665 is the group @xmath414 ( containing @xmath208 as a normal subgroup ) . 6 .",
    "the building @xmath74 is thick ( see ( * ? ? ?",
    "7.4.5 ) ) .",
    "the group @xmath208 acts discretely and ( in the semisimple case ) cocompactly on @xmath214 .",
    "the properties in the list [ list ] , except the last one , hold in the case of symmetric spaces and their infinitesimal analogues .",
    "we note that the affine space @xmath214 has the distinguished point @xmath473 , the origin ( corresponding to the trivial cocharacter ) .",
    "the corresponding vertex in @xmath74 is also denoted by @xmath473 , it is stabilized by @xmath666 .      in this paper",
    "we will be considering polygons in the metric spaces modeled on the coxeter complexes , which were discussed in section [ geometries ] . with the exception of the rank zero spherical buildings ,",
    "all such metric spaces @xmath74 are _ geodesic _ and thus we define a _ geodesic polygon _ in @xmath74 as a polygon with the vertices @xmath667 together with a choice of _ sides _",
    "@xmath668 , i.e. the geodesic segments connecting @xmath669 to @xmath670 . we note that in the case of metric spaces modeled on euclidean coxeter complexes the sides are uniquely determined by the polygon @xmath671 .",
    "we recall that _",
    "@xmath135-gons _ in @xmath74 are regarded as maps @xmath672 .",
    "let @xmath572 be a spherical or euclidean coxeter complex .",
    "the complete invariant of a pair of points @xmath673 with respect to the action @xmath674 , is its image @xmath675 under the canonical projection to @xmath676 .",
    "we define the _ refined length _ of a geodesic segment @xmath677 as @xmath678 .",
    "this notion carries over to geometries modeled on the coxeter complex @xmath572 : for a pair of points @xmath489 pick an apartment @xmath664 containing @xmath679 and , after identifying @xmath664 with the model apartment @xmath111 , let @xmath680 be the projection to @xmath676 .    in the case of euclidean coxeter complexes",
    "there are extra structures associated with the concept of refined length . given a euclidean coxeter complex @xmath210 ,",
    "pick a special vertex @xmath223 .",
    "then we can regard @xmath214 as a vector space @xmath171 , with the origin @xmath681 .",
    "let @xmath238 denote a weyl chamber of @xmath221 , the tip of @xmath40 is at @xmath473 .",
    "suppose that @xmath435 is a subgroup of the group @xmath171 of all translations of @xmath214 so that : @xmath682 where @xmath683 is the normalizer of @xmath208",
    ". since @xmath473 is the origin in @xmath214 , we will identify the orbits @xmath684 and @xmath685 with @xmath435 and @xmath219 respectively .",
    "we define the set of _ refined @xmath435-integral lengths _ as the subset @xmath686 if @xmath687 then we have a natural bijection @xmath688 since @xmath210 is a euclidean coxeter complex , there is also a coarser notion of _ @xmath40-length _ obtained from composing @xmath689 with the natural forgetful map @xmath690 to compute the @xmath40-length @xmath691 we regard the oriented geodesic segment @xmath677 as a vector in @xmath214 and project it to @xmath40 .",
    "again , the concepts of @xmath40-length , @xmath435-integral @xmath40-lengths , etc .",
    ", carry over to the geometries modeled on @xmath72 .",
    "note that @xmath40-length and refined length coincide for symmetric spaces and their infinitesimal analogues because the affine weyl group acts transitively .",
    "we define the set of @xmath435-_integral _ @xmath40-lengths as the subset @xmath692 .",
    "a segment with @xmath435-integral @xmath40-length has @xmath435-integral refined length iff its vertices lie in the distinguished orbit @xmath684 ( identified with @xmath435 ) . for segments with endpoints of type @xmath693 ,",
    "the notions of @xmath40-length and refined length are equivalent .    given a collection @xmath694 of @xmath40-lengths we define the _ moduli space @xmath695 _ as the quotient of the collection of geodesic polygons in @xmath74 with the @xmath40-side - lengths @xmath483 by the action of the group @xmath11 .",
    "we give @xmath695 the quotient topology .",
    "we are now ready to state the questions which will be ( for @xmath504 ) the geometric counterparts to the algebra questions in chapter [ sect : organizing algebra ] :    [ mainques0 ] let @xmath74 be a symmetric space of noncompact type or an infinitesimal symmetric space , or a thick euclidean building .",
    "describe the set @xmath696 of @xmath40-side lengths which occur for geodesic @xmath135-gons in @xmath74 .",
    "the above problem was solved in the papers @xcite . in these papers",
    "the notation @xmath697 was used in place of @xmath698 .",
    "we refer the reader to section [ polyhedron ] for the description of the solution of problem [ mainques0 ] .",
    "[ geometricquestion ] let @xmath74 be a thick euclidean building .",
    "describe the set @xmath699 of refined @xmath435-integral side - lengths which occur for @xmath135-gons in @xmath74 .",
    "one of the key results concerning the above problem is the following    [ transfer theorem , see @xcite ] [ transfer ] suppose that @xmath700 are thick euclidean buildings modeled on the coxeter complexes @xmath701 respectively , @xmath702 are lattices as in ( [ lattice ] ) , @xmath703 is an embedding of coxeter complexes such that @xmath704 .",
    "then @xmath705 induces an embedding @xmath706    below we explain how given an algebraic problem * q1**q3 * one finds a metric space @xmath74 modeled on a euclidean coxeter complex , so that the geometric problem [ geometricquestion ] ( for @xmath504 ) is equivalent to the corresponding algebraic problem .    as we explained in the beginning of chapter [ sect : organizing algebra ] , with each problem * qi * , * i=1 , 2 , 3 * , we can associate a pair of groups @xmath707 .    \\1 . for the problem *",
    "q1 * we take @xmath288 and let @xmath708 .",
    "then @xmath74 is a metric space modeled on the euclidean coxeter complex @xmath709 .",
    "\\2 . for the problem * q2",
    "* we take @xmath710 and let @xmath74 be the symmetric space @xmath80 .    in both cases",
    "@xmath277 acts transitively on @xmath74 and we apply lemma [ trick ] to the transitive action @xmath711 , to conclude that * q1 * and * q2 * are equivalent to problem [ mainques0 ] for the corresponding space @xmath74 .",
    "let @xmath712 , @xmath452 .",
    "then the symmetric space @xmath74 associated with @xmath11 is @xmath713 , which is the space @xmath714 of positive - definite hermitian @xmath104 matrices .",
    "the model apartment @xmath111 in @xmath714 consists of diagonal matrices with positive diagonal entries .",
    "the finite weyl @xmath715 group acts on @xmath111 by permutations of the diagonal elements ; the affine weyl group @xmath208 is isomorphic to @xmath716 .",
    "thus we get a geometric model for analyzing the problem * p2 * from the introduction .",
    "\\3 . for the problem",
    "* q3 * we assign to the group @xmath717 the euclidean ( bruhat - tits ) building @xmath74 as it was explained in the previous section .",
    "we let @xmath474 be the @xmath11-orbit of the special vertex @xmath718 .",
    "although , unlike in the previous two examples , the group @xmath11 does not act transitively on the building @xmath74 , this group acts transitively on the subset @xmath719 and we apply lemma [ trick ] to the action @xmath720 to see that the problem * q3 * ( or , equivalently , * r*(@xmath11 ) ) is equivalent to finding necessary and sufficient conditions for existence of geodesic triangles in @xmath74 whose vertices are in @xmath474 and whose @xmath122-lengths are the prescribed elements of @xmath422 , where @xmath721 . more generally , there is a surjective map @xmath722 and by applying the transfer theorem [ transfer ] we get :    suppose that there exists a polygon @xmath723 in @xmath74 whose @xmath724-side - lengths are @xmath725 .",
    "then for any choice of @xmath726 , there exists a polygon @xmath727 in @xmath74 whose @xmath689-side - lengths are @xmath728",
    ".    therefore we will stick to the notion of the refined side - length @xmath689 through the rest of the paper .",
    "let @xmath74 be a symmetric space of nonpositive curvature or a euclidean building .",
    "recall that the ideal boundary @xmath729 has the structure of a spherical building , the metric on @xmath326 is denoted by @xmath602 . given a weyl chamber @xmath40 in @xmath74",
    ", we get a spherical weyl chamber @xmath730",
    ". we will identify @xmath237 with the unit vectors in @xmath40 . recall that there is a canonical projection @xmath731 , see section [ geometries ] .",
    "take a collection of weights @xmath732 and define a finite measure space @xmath733 where the measure @xmath410 on @xmath734 is given by @xmath735 .",
    "an @xmath135-tuple of ideal points @xmath736 together with @xmath733 determine a _ weighted configuration at infinity _ , which is a map @xmath737 the _ type _ @xmath738 of the weighted configuration @xmath133 is given by @xmath739 .",
    "let @xmath740 be the pushed forward measure on @xmath326 .",
    "we define the _ slope _ of a measure @xmath741 on @xmath326 with finite total mass @xmath742 as @xmath743 in this paper we will consider only measures with finite support .    [ stability ] a measure @xmath741 on @xmath326 ( with finite support ) is called _ semistable _ if @xmath744 and _ stable _ if @xmath745 for all @xmath746 .",
    "there is a refinement of the notion of semistability motivated by the corresponding concept in geometric invariant theory .",
    "a measure @xmath741 on @xmath326 ( with finite support ) is called _ nice semistable _",
    "if @xmath741 is semistable and @xmath747 is a subbuilding or empty . in particular , stable measures are nice semistable .",
    "a weighted configuration @xmath133 on @xmath326 is called _ stable , semistable _ or _",
    "nice semistable _ , respectively , if the corresponding measure @xmath748 has this property .    for the purposes of this paper , i.e.  the study of polygons ,",
    "nice semistability plays a role in the case of symmetric spaces and infinitesimal symmetric spaces only .",
    "we note however that for these spaces , existence of a semistable configuration @xmath133 on @xmath603 implies existence of a nice semistable configuration on @xmath603 , which has the same type as @xmath133 , see @xcite .",
    "\\(i ) let @xmath326 be a spherical building of rank @xmath596 .",
    "then a measure @xmath741 on @xmath326 is stable iff it contains no atoms of mass @xmath749 , semistable iff it contains no atoms of mass @xmath750 , and nice semistable iff it is either stable or consists of two atoms of equal mass .",
    "\\(ii ) suppose that @xmath326 is a unit sphere and regard it as the ideal boundary of a euclidean space @xmath214 , @xmath751 .",
    "each semistable measure @xmath741 has slope zero everywhere .",
    "define the subset @xmath752 consisting of those @xmath135-tuples @xmath753 for which there exists a weighted semistable configuration on @xmath326 of type @xmath483 .",
    "suppose now that @xmath11 is a reductive complex lie group , @xmath590 is a maximal compact subgroup , @xmath80 is the associated symmetric space .",
    "then the spaces of weighted configurations in @xmath603 of the given type @xmath753 can be identified with products @xmath754 where @xmath755 s are smooth complex algebraic varieties ( generalized flag varieties ) on which the group @xmath11 acts transitively .",
    "hence @xmath11 acts on @xmath756 diagonally .    in case @xmath74",
    "is the symmetric space associated to a complex lie group , the notions of stability ( semistability , etc . ) introduced above coincide with corresponding notions from symplectic geometry , and , in the case where the weights @xmath757 s are @xmath435-integral ( i.e. , belong to @xmath721 ) they also coincide with the concepts of stability ( semistability , etc . ) used in the geometric invariant theory ; for a proof of this see @xcite .",
    "we now relate polygons in @xmath74 ( where @xmath74 is a metric space modeled on a euclidean coxeter complex ) and weighted configurations on the ideal boundary @xmath326 of @xmath74 , which plays a key role in @xcite and @xcite . if @xmath74 is an infinitesimal symmetric space @xmath77 we identify the visual boundary of @xmath74 with the tits boundary @xmath758 of the corresponding symmetric space @xmath759 via the exponential map @xmath760 .",
    "thus for all three geometries , the ideal boundary @xmath326 is a spherical building .",
    "consider a ( closed ) polygon @xmath761 in @xmath74 , i.e. a map @xmath672 .",
    "the distances @xmath762 determine a finite measure @xmath410 on @xmath734 by @xmath735 .",
    "the polygon @xmath723 gives rise to a collection @xmath763 of _ gauss maps _ @xmath764 by assigning to @xmath765 an ideal point @xmath766 so that the geodesic ray @xmath767 ( originating at @xmath768 and asymptotic to @xmath769 ) passes through @xmath770 .",
    "this construction , in the case of the hyperbolic plane , already appears in the letter of gauss to w.  bolyai , @xcite .",
    "taking into account the measure @xmath410 , we view the maps @xmath771 as _ weighted configurations _ of points on @xmath603 .",
    "note that if @xmath74 is a riemannian symmetric space and the @xmath772 s are all non - zero , there is a unique gauss map due to the unique extendability of geodesics . on the other hand ,",
    "if @xmath74 is a euclidean building then , due to the branching of geodesics , there are in general infinitely many gauss maps . however , the corresponding weighted configurations are of the same type , i.e.  they project to the same weighted configuration on @xmath237 .",
    "the following crucial observation explains why the notion of semistability is important for studying closed polygons .",
    "[ @xcite , @xcite ] [ polygonstosemistable ] for each gauss map",
    "@xmath133 the pushed forward measure @xmath773 is semistable .",
    "if @xmath74 is a symmetric space or an infinitesimal symmetric space then the measure @xmath741 is nice semistable .",
    "we are now interested in finding polygons with prescribed gauss map .",
    "such polygons will correspond to the fixed points of a certain dynamical system . for @xmath774 and @xmath775",
    ", we define the map @xmath776 by sending @xmath606 to the point at distance @xmath777 from @xmath606 on the geodesic ray @xmath778 .",
    "since @xmath74 is nonpositively curved , the map @xmath142 is 1-lipschitz .",
    "fix now a weighted configuration @xmath779 with non - zero total mass .",
    "we define the 1-lipschitz self - map @xmath780 as the composition @xmath781 of the maps @xmath782 .",
    "the fixed points of @xmath157 are the first vertices of closed polygons @xmath783 so that @xmath133 is a gauss map for @xmath723 . since the map @xmath157 is 1-lipschitz , and the space in question is complete and has nonpositive curvature , the existence of a fixed point for @xmath157 reduces ( see @xcite ) to the existence of a bounded orbit for the dynamical system @xmath784 formed by the iterations of @xmath157 . of course",
    ", in general , there is no reason to expect that @xmath784 has a bounded orbit : for instance , if the support of the measure @xmath740 is a single point , all orbits are unbounded .",
    "one of our results is that under the appropriate semi - stability assumption on @xmath133 the system @xmath784 has a bounded orbit :    [ stabletofixed ] suppose that @xmath74 is either a symmetric space or a euclidean building with one vertex .",
    "suppose that @xmath133 is a nice semistable weighted configuration on @xmath603 ( in the symmetric space case ) or a semistable configuration ( in the building case ) .",
    "then @xmath110 has a fixed point .",
    "this theorem also holds for arbitrary euclidean buildings : it was proven in an early version of @xcite under the local compactness assumption , this proof was superseded by a proof by andreas balser @xcite who had removed the local compactness assumption .    combining the above result with the transfer theorem [ transfer ] we get :    [ @xcite ] [ poly - ss ]",
    "suppose that @xmath74 is a symmetric space of nonpositive curvature or an infinitesimal symmetric space or a euclidean building with a model weyl chamber @xmath40",
    ". then @xmath785 .",
    "the equivalence of the problems * q1 * and * q2 * ( and consequently * p1 * and * p2 * ) in the introduction follows immediately from the above theorem since for an infinitesimal symmetric space @xmath77 and the corresponding symmetric space @xmath74 the tits boundaries are the same . as another corollary of the combination of theorems [ transfer ] and [ poly - ss ] we get :    [ @xcite ] [ mainth ] let @xmath74 be either a thick euclidean building , a symmetric space or an infinitesimal symmetric space . then @xmath786 depends only on the associated spherical coxeter complex and not on the type of the geometry .    for instance , suppose that @xmath74 is a nonpositively curved symmetric space and @xmath759 is a euclidean building which have isomorphic finite weyl groups and the same rank .",
    "then @xmath787 , @xmath788 , where @xmath789 and @xmath790 are euclidean cones over the tits boundary of @xmath700 , i.e. 1-vertex buildings .",
    "since @xmath789 and @xmath790 have isomorphic spherical weyl groups , their affine weyl groups are isomorphic as well , so the transfer theorem implies that @xmath791 as required .",
    "in the case when the group @xmath11 is complex , for the ideal boundaries @xmath326 of symmetric spaces @xmath80 one constructs the moduli space of semistable weighted configurations on @xmath326 as follows .    given a type @xmath483 ( so that for each @xmath765 the vector @xmath757 is nonzero ) , the set of semistable configurations @xmath792 ( resp .",
    "nice semistable configurations @xmath793 ) of type @xmath483 on @xmath326 has a natural topological structure .",
    "define a relation @xmath794 on @xmath792 by @xmath795 if @xmath796 one then verifies that @xmath794 is an equivalence relation , see @xcite and @xcite .",
    "define the moduli space @xmath797 of semi - stable configurations on @xmath326 of type @xmath483 as the quotient @xmath798 .",
    "we note that the moduli space ( see ( [ moduli ] ) ) @xmath695 of @xmath135-gons in @xmath74 with the given side - lengths @xmath753 , is also a compact topological space .",
    "the moduli space @xmath799 is hausdorff .",
    "the map @xmath800 defines a natural homeomorphism @xmath801 .",
    "it was proven in @xcite and @xcite that @xmath802 , and that @xmath799 is hausdorff .",
    "the surjection @xmath461 is clearly continuous , it is also easily seen to be injective .",
    "therefore the map @xmath803 is also a homeomorphism .    for the purposes of this paper we only need to know that @xmath804 iff @xmath805 .",
    "below are few more details concerning the symplectic nature of the moduli space @xmath799 in the case when @xmath11 is a complex lie group . recall that @xmath806 and @xmath807 .",
    "for @xmath808 we identify each @xmath757 with the element @xmath809 of the lie algebra @xmath286 .",
    "we consider the product @xmath810 of the orbits @xmath811 , @xmath812 .",
    "the manifold @xmath442 carries a natural symplectic structure which is invariant under the diagonal adjoint action of the group @xmath10 .",
    "let @xmath813 be the _ momentum mapping _ of this action .",
    "since the map @xmath457 is given by the formula @xmath814 we obtain an identification of the moduli space @xmath815 of polygons in @xmath77 with the _ symplectic quotient _ : @xmath816 in the case when all @xmath757 belong to the cocharacter lattice @xmath435 , this quotient is the same as the _",
    "mumford quotient _ of the projective variety @xmath817 by the group @xmath11 .",
    "one of the main results of @xcite is a description of @xmath786 ( where @xmath74 is an infinitesimal symmetric space ) in terms of the schubert calculus in the grassmannians associated to complex and real lie groups @xmath11",
    "( i.e. the quotients @xmath818 where @xmath723 is a maximal parabolic subgroup of @xmath11 ) .",
    "below we describe @xmath786 for the three classes of metric spaces considered in the present paper .",
    "we first do it in the context of symmetric spaces of _ noncompact type _",
    "( i.e. their derham decomposition contains no euclidean factor ) since the description in this class is more natural .",
    "let @xmath74 be a symmetric space of noncompact type and @xmath11 the identity component of its isometry group .",
    "the ideal boundary @xmath603 is a spherical building modeled on a spherical coxeter complex @xmath819 with model spherical weyl chamber @xmath236 .",
    "we identify @xmath573 with an apartment in @xmath603 .",
    "let @xmath40 denote the euclidean weyl chamber of @xmath74 .",
    "we identify @xmath237 with @xmath820 .",
    "let @xmath326 be the stabilizer of @xmath237 in @xmath11 .",
    "for each vertex @xmath821 of @xmath603 one defines the generalized grassmannian @xmath822 .",
    "( here @xmath723 is the maximal parabolic subgroup of @xmath11 stabilizing @xmath821 . )",
    "it is a compact homogeneous space stratified into @xmath326-orbits called _",
    "schubert cells_. every schubert cell is of the form @xmath823 for a unique vertex @xmath824 of the spherical coxeter complex .",
    "the closures @xmath825 are called _",
    "schubert cycles_. they are unions of schubert cells and represent well defined elements in the homology @xmath826 .    for each vertex @xmath821 of @xmath237 and each @xmath135-tuple @xmath827 of vertices in @xmath828 consider the following homogeneous linear inequality for @xmath829 : @xmath830 here we identify the @xmath831 s with unit vectors in @xmath40 .",
    "let @xmath832 be the subset consisting of all data @xmath833 such that the intersection of the schubert classes @xmath834,\\dots,[\\ol c_{\\eta_n}]$ ] in @xmath826 equals @xmath835 $ ] .",
    "[ @xcite ] [ thm : stabineq ] @xmath836 consists of all solutions @xmath837 to the system of inequalities _ ( [ stabineq ] ) _ where @xmath833 runs through @xmath832 .",
    "this system of inequalities depends on the schubert calculus for the generalized grassmannians @xmath818 associated to the group @xmath11 .",
    "it is one of the results of @xcite that the set of solutions depends only on the spherical coxeter complex .    typically , the system of inequalities in theorem [ thm : stabineq ] is redundant . if @xmath11 is a _",
    "complex _ lie group one can use the complex structure to obtain a smaller system of inequalities . in this case , the homogeneous spaces @xmath838 are complex manifolds and the schubert cycles are complex subvarieties and hence represent classes in _ integral _ homology . let @xmath839 be the subset consisting of all data @xmath833 such that the intersection of the schubert classes @xmath834,\\dots,[\\ol c_{\\eta_n}]$ ] in @xmath840 equals @xmath835 $ ] .",
    "the following analogue of theorem [ thm : stabineq ] was proven independently and by completely different methods in @xcite and in @xcite :    [ stability inequalities ] [ thm : stabineqc ] @xmath841 consists of all solutions @xmath837 to the system of inequalities _ ( [ stabineq ] ) _ where @xmath833 runs through @xmath842 .",
    "we now consider the general case when @xmath74 is a symmetric space or a euclidean building which splits as @xmath843 , where @xmath844 is the flat derham factor of @xmath74 . in the case when @xmath563 is an infinitesimal symmetric space we consider the decomposition @xmath845 corresponding to the orthogonal decomposition @xmath846 , where @xmath847 is the lie algebra of the split part of the of the central torus of @xmath11 ( where @xmath12 is the lie algebra of @xmath11 ) . in this case",
    "we again refer to @xmath848 as the euclidean derham factor of @xmath74 . if @xmath849 , where @xmath759 is a nonpositively curved symmetric space , then the above decomposition of @xmath77 is the infinitesimal version of the splitting off the derham factor of @xmath759 .",
    "let @xmath850 be the corresponding decomposition of the euclidean coxeter complex , the weyl chamber @xmath238 splits as @xmath851 , where @xmath852 is the weyl chamber for the action @xmath853 and @xmath262 .",
    "let @xmath854 denote the side - lengths polyhedron for the space @xmath855 .",
    "it is clear that @xmath856 then we get : @xmath857 we refer the reader to proposition [ prop : reduction ] for the explanation .    combining our results",
    "one obtains the following recipe for determining the polytope @xmath786 for any of the spaces @xmath74 as in theorem [ mainth ] ( i.e. , infinitesimal symmetric spaces , symmetric spaces and euclidean buildings ) : given @xmath74 , first of all , split @xmath74 as @xmath843 , where @xmath844 is the euclidean derham factor . in view of the formula ( [ split ] ) it suffices to describe @xmath858 ; so we let @xmath859 .",
    "then find a complex semisimple lie group @xmath11 of noncompact type , whose spherical coxeter complex is isomorphic to the one of @xmath74 .",
    "let @xmath759 be the symmetric space @xmath713 associated with @xmath11 . using schubert calculus for the grassmannians @xmath818 associated to @xmath11 as in theorem [ thm : stabineqc ] above , compute the system of stability inequalities describing @xmath860 .",
    "the polytopes @xmath786 and @xmath861 are equal .",
    "we note that although the polyhedron @xmath786 depends only on the spherical coxeter group , the system of stability inequalities describing @xmath786 depends on the root system .",
    "in fact in @xcite it is shown that the systems obtained for the root systems @xmath862 and @xmath863 are different ( even though they have the same number of inequalities ) .",
    "suppose that @xmath11 is a reductive algebraic over @xmath0 and @xmath43 is its langlands dual .",
    "let @xmath12 and @xmath864 be the lie algebras of @xmath11 and @xmath43 and let @xmath865 be the corresponding symmetric spaces .",
    "let @xmath866 be the cartan decomposition .",
    "take a cartan subalgebra @xmath867 .",
    "the pairing @xmath868 induces an isomorphism @xmath869 , where @xmath870 is a cartan subalgera of @xmath864 .",
    "we then identify @xmath298 with @xmath364 using the invariant metric .",
    "this gives us an isometry @xmath871 which conjugates the spherical coxeter group @xmath221 of @xmath12 to the spherical coxeter group @xmath872 of @xmath864 .",
    "this isometry also carries a euclidean weyl chamber @xmath40 of @xmath873 onto a euclidean weyl chamber for the action @xmath874 .",
    "thus @xmath457 induces a bijection @xmath875 for instance , if @xmath11 and @xmath43 are simple complex lie groups of type @xmath876 and @xmath877 respectively , then the above construction provides an isometry @xmath878 .    in the next subsection",
    "we will write down the inequalities [ thm : stabineqc ] for the root system @xmath109 in the case @xmath504 .      in @xcite and",
    "@xcite the stability inequalities for the polyhedra @xmath76 were computed for all @xmath74 of rank @xmath879 or @xmath880 ( the polyhedron for @xmath59 was computed in @xcite ) .",
    "we now give the example of the polyhedron for the root system @xmath109 .",
    "this example will be useful to us later .    since all symmetric spaces with the same root system give rise to the same polyhedron we may take @xmath881 .",
    "the weyl chamber @xmath122 is given by @xmath882 thus the @xmath40-lengths @xmath883 are vectors @xmath489 in @xmath40 . since the root system has rank 2 , @xmath237 has exactly two vertices @xmath884 .",
    "thus we get two generalized grassmannians , @xmath885 .",
    "these grassmannians are the spaces of isotropic lines and isotropic planes in @xmath886 .",
    "thus the set of stability inequalities breaks into two subsystems , one for each @xmath887 .",
    "this gives a system of @xmath888 inequalities in addition to the inequalities defining the chamber @xmath40 .",
    "below we have dropped one of these @xmath888 inequalities , which was implied by the inequalities defining the chamber .",
    "the first subsystem of stability inequalities ( corresponding to the grassmannian of isotropic lines ) is given by @xmath889 in order to describe the second system we let @xmath573 be the sum of all the coordinates of the side - lengths , so @xmath890 the second subsystem ( corresponding to the grassmannian of isotropic planes ) is then given by @xmath891 to the above system of 18 inequalities we also have to add the `` chamber inequalities '' : @xmath892 in total we get 24 inequalities .",
    "thus we have :    suppose that @xmath74 is a symmetric space with the ( finite ) weyl group of type @xmath109 .",
    "then there exists a triangle in @xmath74 whose @xmath40-side lengths are vectors @xmath893 , @xmath315 if and only if @xmath883 s satisfy the above system of 18 inequalities .    using a computer we have verified that the above system is minimal , the polyhedron @xmath894 is a cone over a compact polytope with 15 vertices and 24 top - dimensional faces .",
    "note that the weyl chamber @xmath895 determines a partial order on @xmath298 : @xmath896 one may ask if the `` naive '' triangle inequalities @xmath897 are satisfied by the @xmath40-side lengths of triangles in a symmetric space @xmath74 with the weyl chamber @xmath40 .",
    "below is a counter - example :    consider the root system @xmath58 and the vectors @xmath898 where @xmath899 .",
    "the reader will verify that the stability inequalities above are satisfied by the vectors @xmath280 , however the inequality @xmath897 fails since it would imply that @xmath900 .",
    "nevertheless , one can rewrite the system of stability inequalities for the root system @xmath58 in terms of the _ root cone _ @xmath901 as follows : @xmath902 @xmath903 and @xmath904 @xmath905 for all @xmath906 such that @xmath907 . here",
    "let @xmath74 be a thick euclidean building modeled on a discrete coxeter complex @xmath210 . as in section [ geodesic polygons",
    "] , let @xmath435 be a lattice in @xmath214 which contains the translation subgroup @xmath219 of @xmath208 and which normalizes @xmath208 . note that @xmath435 acts by automorphisms on the coxeter complex @xmath909 . for the algebraic applications we would like to determine",
    "for which @xmath910 , there exists a polygon in @xmath74 with @xmath435-integral side - lengths @xmath911 and the first vertex at a distinguished special vertex @xmath718 .",
    "in other words , we are interested in the image of the map @xmath912    in this chapter we will show that in general the map ( [ ref - to - delta ] ) is not onto ( section [ firstcounterexample ] ) : the counterexamples are based on the idea of _ folding _",
    "triangles into apartments ( see section [ foldtriangle ] ) .",
    "in the subsequent chapter [ k - computation ] we will prove `` positive results '' : some of them guarantee that the map ( [ ref - to - delta ] ) is onto for certain pairs @xmath913 , the other results establish sufficient conditions for elements of @xmath914 to belong to the image of @xmath705 .      in this section",
    "we describe a construction which produces billiard triangles in an apartment from triangles in a building .",
    "suppose that @xmath915 is a triangle in a ( euclidean or spherical ) building @xmath326 .",
    "in general it is not contained in an apartment .",
    "however ( see @xcite ) there exists a finite subdivision of the edge @xmath677 by points @xmath916 such that each geodesic triangle @xmath917 is contained in an apartment in @xmath326 .",
    "it is easy to see that there is a uniform upper bound on the number @xmath114 which depends only on the coxeter group @xmath575 .    for each @xmath765 ,",
    "let @xmath918 be an apartment containing @xmath919 .",
    "we will identify @xmath920 with the model apartment @xmath111 .",
    "we will produce points @xmath921 in the first apartment @xmath920 such that the triangles @xmath922 are congruent to the triangles @xmath919 via apartment isomorphisms @xmath923 .",
    "this is done inductively as follows .",
    "we start with @xmath924 and @xmath925 .",
    "suppose that @xmath921 has been constructed .",
    "to find @xmath926 , choose @xmath927 so that it carries @xmath928 to @xmath929 .",
    "put @xmath930 .",
    "the procedure yields a _ billiard triangle _ in the apartment @xmath111 consisting of two geodesic sides @xmath931 and @xmath932 with the same refined lengths as the corresponding sides of the original triangle @xmath915 , and one piecewise geodesic path @xmath933 .",
    "the points @xmath934 are the _ break points _ of the broken side of this billiard triangle",
    ".    [ special0 ] if @xmath405 is a special vertex of @xmath74 , then , by projecting the apartment @xmath111 to a weyl chamber @xmath122 ( with the tip at @xmath405 ) , we can assume that the folded triangle is contained in @xmath122 .",
    "consider the spherical building @xmath935 whose coxeter complex is @xmath936 , where the group @xmath937 is the stabilizer of @xmath768 in @xmath575 .",
    "let @xmath938 be the canonical projection of @xmath939 to the weyl chamber in this building .",
    "notice that @xmath937 may be smaller than @xmath221 .",
    "since the refined lengths of @xmath940 and @xmath941 are equal , it follows that @xmath942 , @xmath943 . because the directions @xmath944 and @xmath945 in the spherical building @xmath946 are antipodal , the properties of the canonical projection @xmath938 ( see section [ geometries ] ) imply that the directions @xmath947 and @xmath948 in the spherical coxeter complex @xmath936 are antipodal modulo the action of @xmath937 .",
    "a broken triangle @xmath949 with two geodesic sides @xmath931 and @xmath932 and one piecewise geodesic path @xmath933 is a _ billiard triangle _ if at every break point @xmath921 , the directions @xmath947 and @xmath948 in the spherical coxeter complex @xmath950 are antipodal modulo the action of the stabilizer @xmath937 of @xmath921 in the coxeter group of @xmath111 .",
    "we note that each broken side @xmath933 of a billiard triangle can be _ straightened _ in the model apartment @xmath111 , i.e. there exists a geodesic segment @xmath951 ( a _ straightening _ of @xmath933 ) such that @xmath952 , the metric length of @xmath953 is the same as of @xmath933 , and the direction of @xmath953 at @xmath954 is the same as the direction of @xmath955 .",
    "= 3.5 in    a billiard triangle @xmath129 in the model apartment can be unfolded to a geodesic triangle in the building if and only if , for each break point @xmath921 , @xmath956 , the following holds .",
    "let @xmath957 be the directions towards @xmath958 .",
    "the necessary and sufficient condition is :    [ con ] for each @xmath765 there exists a triangle @xmath959 in the spherical building @xmath960 so that @xmath961 and the refined lengths of @xmath962 and @xmath963 are the same as for @xmath964 and @xmath965 respectively .    [ rem : con ]",
    "a necessary condition for existence of a triangle @xmath966 is that @xmath967 , which is just the usual ( metric ) triangle inequality in the spherical building @xmath939 .    [",
    "unfold ] suppose that we have an apartment @xmath968 in a euclidean building @xmath74 and a billiard triangle @xmath969 , @xmath970 has geodesic sides @xmath971 and the broken side @xmath972 .",
    "suppose that for each break point @xmath973 , there is a wall @xmath974 through @xmath975 which weakly separates separates @xmath968 into half - apartments @xmath976 such that @xmath405 is in the closure of @xmath977 and @xmath978 are in the closure of @xmath979 .",
    "] @xmath980 from the vertex @xmath981 .",
    "assume that the reflection @xmath982 in the wall @xmath983 carries the direction @xmath984 to the direction antipodal to @xmath985 . then there exists a geodesic triangle @xmath986 so that @xmath987 and the refined side - length of @xmath677 is the same as for the straightening of the broken side @xmath988 .    = 3.5 in",
    "we prove the lemma by verifying condition [ con ] for each @xmath989 .",
    "the spherical building @xmath990 contains the apartment @xmath991 and the directions @xmath992 of the geodesic segments @xmath993 the wall @xmath994 in the spherical apartment @xmath995 separates @xmath995 into half - apartments @xmath996 , so that @xmath997 contains @xmath998 and @xmath999 contains the directions @xmath1000 . because the building @xmath474 is thick , there exists an apartment @xmath1001 which intersects @xmath995 along the half - apartment @xmath1002",
    ". let @xmath1003 .",
    "there exists an isomorphism of coxeter complexes @xmath1004 which restricts to the identity on @xmath1005 .",
    "set @xmath1006 . clearly , @xmath1007 it remains to verify that @xmath1008 , i.e. that the points @xmath837 and @xmath1009 are antipodal .",
    "note that we also have the third apartment @xmath1010 and the isomorphism of coxeter complexes @xmath1011 which is the identity on @xmath1012 , see figure [ unfolding ] .",
    "the restriction of @xmath1013 to @xmath1014 equals @xmath1015 .",
    "thus @xmath1013 carries @xmath1016 ( which is antipodal to @xmath1017 by assumption ) to the point @xmath1009 , and @xmath1018 .",
    "thus the points @xmath1019 are antipodal .",
    "we now state a conjecture describing unfoldable billiard triangles .",
    "let @xmath1020 be a weyl chamber with the tip at a special vertex @xmath473 .",
    "we first define a _ weak ls path _ between two special vertices @xmath1021 to be a broken geodesic @xmath1022 which satisfies littelmann s axioms for an ls path in @xcite except we do not require @xmath1023 in the definition of an @xmath664-chain .",
    "a billiard triangle is a _",
    "littelmann triangle _",
    "if the broken side @xmath1024 is an ls path .",
    "we say that a billiard triangle in @xmath1025 with the geodesic sides @xmath1026 and a broken side @xmath1024 is a _ generalized littelmann triangle _ if @xmath1024 is a weak ls path .",
    "we recall ( see @xcite ) that there exists a littelmann triangle with geodesic sides @xmath1026 and the broken side @xmath1027 iff @xmath1028 where @xmath1029 and @xmath1030 is the @xmath40-length of the straightening of the broken geodesic @xmath1027 , provided that @xmath280 are characters of the split torus @xmath1031 . here",
    "@xmath1032 are irreducible representations of the group @xmath1033 , cf . ",
    "[ introduction ] .    a billiard triangle in @xmath1025 with the sides @xmath1026 and @xmath1027 and with the special vertices @xmath1034 , is unfoldable iff it is a generalized littelmann triangle .",
    "in this section we first construct an example of a discrete thick euclidean building @xmath74 ( modeled on discrete euclidean coxeter complex with the root system @xmath50 of type @xmath109 ) and a triangle @xmath1035 with the @xmath40-side lengths @xmath1036",
    "so that :    \\1 .",
    "the vertices of @xmath723 are at vertices of @xmath74 .",
    "there is no triangle @xmath1037 with vertices at special vertices of @xmath74 and the @xmath40-lengths @xmath1038 .    in terms of our basic algebra problems",
    ", @xmath1039 is a solution of problem * q2 * but not of problem * q3 * for the simply - connected group @xmath1040 ,    = 3.5 in    we next describe ( without proof ) analogous counterexamples for the root systems @xmath1041 and @xmath1042 . in terms of our basic algebra problems",
    ", this shows that there are solutions of problem * q2 * that are not solutions to problem * q3 * for the simply - connected groups @xmath1043 .",
    "[ notriangle2 ] let @xmath74 be a thick euclidean building with associated discrete euclidean coxeter complex @xmath72 of type @xmath109 .",
    "then the map ( [ ref - to - delta ] ) is not surjective for @xmath504 and @xmath1044 .",
    "we recall that the simple roots for the root system @xmath109 are @xmath1045 and @xmath1046 and the simple coroots are @xmath1045 and @xmath1047 . the folded triangle @xmath129 is represented in figure [ f13 ] .",
    "it has three vertices : @xmath1048 and @xmath1049 and two geodesic sides : @xmath1050 and @xmath1051 .",
    "the third side is the broken geodesic segment which consists of three pieces : @xmath1052 and @xmath1053 .",
    "the vectors in the weyl chamber @xmath1054 which represent the corresponding @xmath40-side lengths are @xmath1055 , @xmath1056 and @xmath1055 , where @xmath1055 represents the broken side . to see that @xmath129 can be unfolded into a geodesic triangle in the corresponding building @xmath74 one can either use lemma [ unfold ] or simply verify that the vectors @xmath1055 , @xmath1056 and @xmath1055 satisfy the inequalities of section [ inequalities ] .",
    "note that the vectors @xmath1056 and @xmath1055 belong to the coroot lattice .",
    "= 3.5 in    we now prove that there is no triangle @xmath1057 in the building @xmath74 whose @xmath40-side lengths are the vectors @xmath1055 , @xmath1056 and @xmath1055 and whose vertices are special vertices of @xmath74 .",
    "suppose that such triangle exists .",
    "as described in section [ foldtriangle ] , we subdivide the side @xmath1058 and fold @xmath1057 to a billiard triangle @xmath970 in the model apartment @xmath111 . without loss of generality we can assume that the side @xmath1059 folds onto the geodesic segment @xmath1060 , where @xmath473 is the origin in @xmath111 and @xmath1061 . by remark [ special0 ] we can assume that this triangle is contained in the weyl chamber @xmath1062 .",
    "hence the side @xmath1063 folds onto the geodesic segment @xmath1064 where @xmath1065 .",
    "note that @xmath1066 is strictly less than @xmath1067 , which is the magnitude of the vector @xmath1055 .",
    "thus the broken geodesic segment @xmath1068 ( which is the image of @xmath1058 under folding ) has to have at least one break point .",
    "next , observe that the only break points in @xmath1068 can occur at the vertices of the affine coxeter complex .",
    "any vertex other than one in the set @xmath1069 would be too far from @xmath1070 for a billiard triangle to exist .",
    "we note that all points in @xmath1071 are nonspecial vertices of the coxeter complex .",
    "thus the only break in @xmath1072 ) which can occur at such a point is `` backtracking '' .",
    "below we exclude breaks at various points of @xmath573 and will leave the rest of the possibilities to the reader , since the arguments are similar .",
    "suppose that the broken geodesic path @xmath1068 is the concatenation of the geodesic segments @xmath1073 where @xmath1074 , see figure [ f15 ] .",
    "the point @xmath1075 is one of two break points of @xmath1068 . at the link",
    "@xmath1076 consider the directions : @xmath1077 towards the points @xmath1078 and @xmath473 .",
    "then @xmath1079 hence , according to remark [ rem : con ] , the billiard triangle @xmath970 can not be unfolded into a geodesic triangle @xmath1080 .",
    "contradiction .",
    "= 3.5 in    lastly , consider a break point at the vertex @xmath1081 ; the broken geodesic path @xmath1068 is the concatenation of the geodesic segments @xmath1073 see figure [ f16 ] . at the link @xmath1082 of the break point",
    "@xmath664 consider the directions : @xmath1077 towards the points @xmath1083 and @xmath473 .",
    "again , @xmath1084 contradiction .",
    "( note that in this example we do not get a contradiction by considering the link of the break point @xmath1075 . )",
    "consider the usual embedding @xmath1085 of the root system @xmath1086 to @xmath1087 .",
    "the @xmath40-side length vectors @xmath1055 , @xmath1056 and @xmath1055 correspond to the vectors @xmath1088 one can show that for each @xmath1089 and the appropriate discrete building @xmath74 , the vectors @xmath280 * belong to the image * of @xmath1090 .    consider now a thick building @xmath1091 modeled on the discrete euclidean coxeter complex of type @xmath1092 , @xmath1089 .",
    "set @xmath1093 . to obtain examples of triples of vectors which do not belong to the image of @xmath1094 we do the following :    choose the vectors @xmath1095 and @xmath1096",
    ". then @xmath1097 are in the coroot lattice @xmath435 of @xmath1098 .",
    "we claim this choice of side - lengths gives a solution of problem * q2 * that is not a solution of problem * q3 * for the root system @xmath1098 .",
    "there exists an isomorphism of algebraic groups @xmath1099 carrying a split torus of @xmath1100 to a split torus of @xmath1101 such that the induced map on cartan subalgebras ( relative to the coordinates of ( * ? ? ?",
    "252 - 255 ) ) , is given by the matrix @xmath1102,\\ ] ]    let @xmath1103 be the spin representation . by theorem g ( b ) of @xcite ,",
    "the spin representation of @xmath1104 is symplectic if and only if either @xmath1105 mod @xmath1106 or @xmath1107 mod @xmath1106 .",
    "hence , the image of @xmath142 lies in @xmath1101 .",
    "if follows easily that @xmath142 is an isomorphism .",
    "let @xmath1108 be the coordinate functionals as in @xcite , loc .",
    "since the weights of the spin representation relative to the basis of the dual of the cartan subalgebra are @xmath1109 and @xmath1110 we find that the pull - back by the map , induced on the duals of the cartan subalgebras , of the coordinate functional @xmath1111 is @xmath1112 and the pull - back of the coordinate functional @xmath1113 is @xmath1114 .",
    "thus the above matrix is the matrix of the map on the duals . since it is symmetric is also the matrix of the map on the cartan subalgebras .",
    "since the vectors @xmath280 ( from the previous example ) map to the vectors @xmath1115 and @xmath1096 respectively , the claim follows .",
    "now consider the natural embedding of root systems @xmath1116 , @xmath1117 .",
    "one can verify ( similarly to the arguments presented in example [ notriangle2 ] ) that the vectors @xmath1118 satisfy the property that @xmath1119 where @xmath1120 is a discrete euclidean building modeled on the euclidean coxeter complex associated with the root system @xmath877 .",
    "thus the triple @xmath1121 is a solution of problem * q2 * for @xmath1122 but not a solution of problem * q3 * for @xmath1123 where @xmath293 is an nonarchimedean local field with value group @xmath1124 .",
    "as we have seen in the previous chapter , the map @xmath1125 in general is not surjective .",
    "the goal of this chapter is to find conditions on the root systems , etc .",
    ", which would guarantee existence of polygons @xmath723 in euclidean buildings @xmath74 with the prescribed @xmath435-integral @xmath40-side lengths and vertices at the vertices of @xmath74",
    ". moreover , we will find conditions under which the vertices of @xmath723 are in @xmath475 , where @xmath718 is a certain special vertex .",
    "we will also see that the image of @xmath705 is always contained in the set @xmath1126 we will show that for each data @xmath1127 ( where @xmath1128 ) , there exists a natural number @xmath114 such that for each @xmath1129 , the vector @xmath1130 belongs to the image of the map ( [ ref - to - delta ] ) .",
    "we will compute the _ saturation factors _",
    "@xmath114 for various classes of @xmath1127 . in few cases we are fortunate and @xmath1131 ,",
    "i.e. the map ( [ ref - to - delta2 ] ) is onto .",
    "we then apply these results to the algebra problem * q3*.      in this section we define and compute _ saturation factors _ associated with root systems .",
    "let @xmath210 be a euclidean coxeter complex , @xmath1132 .",
    "we define the _ saturation factor _",
    "@xmath49 for the root system @xmath50 to be the least natural number @xmath114 such that @xmath1133 .",
    "the numbers @xmath49 for the irreducible root systems are listed in the table ( [ tab ] ) .",
    "below we explain how to compute the saturation factors @xmath49 .",
    "first of all , it is clear that if the root system @xmath50 is reducible and @xmath244 are its irreducible components , then @xmath1134 , where @xmath1135 stands for the _ least common multiple_. henceforth we can assume that the system @xmath50 is reduced , irreducible and @xmath231 .",
    "then the affine coxeter group @xmath208 is discrete , acts cocompactly on @xmath214 and its fundamental domain ( a _ weyl alcove _ ) is a simplex .",
    "let @xmath1136 be the collection of simple roots in @xmath50 ( corresponding to the positive weyl chamber @xmath40 ) and @xmath1137 be the highest root .",
    "then @xmath1138    we can choose as a weyl alcove @xmath327 for @xmath208 the simplex bounded by the hyperplanes @xmath1139 , @xmath1140 .",
    "the vertices of @xmath327 are : @xmath1141 ( the origin ) and the points @xmath1142 .",
    "each @xmath1143 , belongs to the intersection of the hyperplanes @xmath1144 , @xmath1145 .",
    "the set of values ( mod @xmath7 ) of the linear functionals @xmath243 ( @xmath1146 ) on the vertex set @xmath215 of the coxeter complex , equals @xmath1147 .",
    "note that @xmath1148 where the numbers @xmath772 are the ones which appear in the equation ( [ highestroot ] ) .",
    "thus @xmath1149 .",
    "[ kexists ] @xmath1150 .",
    "we have : @xmath1151 for each @xmath765 , which in turn implies that @xmath1152 for all @xmath1153 .",
    "hence @xmath1154 for each @xmath1146 .",
    "since @xmath1155 , this proves that @xmath1156 . if @xmath1157 is such that @xmath1158 , then @xmath772 divides @xmath114 for each @xmath812 .    in our paper we will also need a generalization of the numbers @xmath49 , which we discuss for the rest of this section .",
    "( the reader who is interested only in simply - connected groups can ignore this material . )",
    "we again consider a general reducible root system @xmath50 .",
    "suppose that @xmath1159 is a subgroup of @xmath226 containing the lattice @xmath1160 ; we will assume that @xmath1159 acts as a _ lattice _ on @xmath214 ( i.e. a discrete cocompact group ) . set @xmath1161 , where @xmath1162 are the vector spaces underlying @xmath246 .",
    "we note that since @xmath1163 and @xmath219 acts as a lattice on @xmath1164 , the discrete group @xmath435 also acts as a lattice on @xmath1165 .",
    "let @xmath1166 denote the orthogonal projections @xmath1167 .",
    "consider the images @xmath1168 of @xmath435 under the projections @xmath1166 ( @xmath1169 ) ; since @xmath1170 and @xmath1171 , we have the inclusions @xmath1172 where @xmath1173 is the translation subgroup of @xmath254 .",
    "[ glq ] suppose that @xmath210 is the coxeter complex associated with the root system of the group @xmath1174 .",
    "then @xmath1175 , @xmath1176 is the cocharacter group of the maximal torus @xmath118 ( represented by diagonal matrices ) in @xmath1174 .",
    "the group @xmath1159 is generated by the cocharacters @xmath1177 ( @xmath151 is on the @xmath765-th place ) .",
    "the coroot lattice @xmath167 is generated by the simple coroots @xmath1178 .",
    "the metric on @xmath214 is given by the trace of the product of matrices .",
    "we have the decomposition @xmath850 where @xmath265 is 1-dimensional and is spanned by the vector @xmath1179 , and the space @xmath1180 is the kernel of the map @xmath1181 thus @xmath1180 is the ( real ) cartan subalgebra of the lie algebra @xmath1182 of @xmath1183 , the derived subgroup of @xmath1174 .    the projection @xmath1184 is given by @xmath1185 .",
    "the group @xmath208 equals @xmath1186 , which acts on @xmath1180 as the euclidean coxeter group with the extended dynkin diagram of type @xmath1187 .",
    "the intersection @xmath1188 , where @xmath166 is a root system contained in @xmath1180 .",
    "it is the coroot system of the lie algebra @xmath1182 the projection @xmath1189 is @xmath229 , the coweight lattice of the lie algebra @xmath1182 .",
    "consider the group of isometries @xmath414 generated by elements of @xmath208 and @xmath435 .",
    "then @xmath414 is a euclidean coxeter group with the linear part @xmath221 and translation part @xmath435 , @xmath1190 .",
    "since @xmath1191 normalizes @xmath254 , for each @xmath765 we get the induced action of the finite abelian group @xmath1192 on the weyl alcove @xmath1193 of @xmath254 .    a face @xmath1194 of a weyl alcove @xmath1193 of @xmath639 , will be called _ @xmath1168-admissible _ if there exists an element @xmath1195 which preserves @xmath1196 and @xmath1197 acts transitively on its vertices ( @xmath251 ) .",
    "note that in the case @xmath1198 , the only @xmath1168-admissible simplices are the vertices of @xmath1196 .    [ satfactor ] for each pair of groups @xmath1199 , define the _ saturation factor _ @xmath1200 , to be the smallest natural number @xmath1201 such that for each @xmath1168-admissible face @xmath1202 , the multiple of its barycenter @xmath1203 , belongs to @xmath1204 .",
    "we let @xmath1205 denote @xmath1206 . in the case",
    "@xmath1207 we will use the notation @xmath1208 for @xmath1209 .",
    "we note that in the case @xmath687 we get @xmath1210 and if @xmath435 is the weight lattice , @xmath1211 we have @xmath1212 .",
    "our next goal is to compute the saturation factors for various irreducible root systems and various lattices @xmath435 .",
    "we again assume that the root system @xmath50 is irreducible and that its rank @xmath135 equals @xmath1213 .",
    "note that the group @xmath1214 acts by automorphisms on the extended dynkin diagram @xmath1215 of the root system @xmath50 ( since @xmath756 acts on the weyl alcove @xmath664 which is uniquely determined by the labelled graph @xmath1215 , whose nodes correspond to the faces of @xmath664 ) .",
    "for @xmath812 we mark the @xmath765-th node ( corresponding to @xmath1216 ) of @xmath1215 with the natural number @xmath772 which appears the formula for the highest root ( [ highestroot ] ) .",
    "we mark the @xmath596-th node of @xmath1215 ( corresponding to @xmath53 ) with @xmath151 .",
    "then the automorphisms of @xmath1217 preserve this labelling ; the action of the full group @xmath226 on @xmath1217 is transitive on the set of all the nodes labelled by @xmath151 .",
    "not all automorphisms of @xmath1215 can be induced by @xmath756 even if one takes @xmath435 as large as possible , i.e. @xmath1207 .",
    "recall that the action on @xmath664 comes from the action of @xmath414 by conjugation on @xmath208 ; this action induces inner automorphisms of the spherical weyl group @xmath221 .",
    "thus , if @xmath458 is an automorphism of @xmath1217 induced by an element of @xmath756 and @xmath458 fixes a vertex with the label @xmath151 , then @xmath458 acts trivially on @xmath1217 .",
    "this does not completely determine the image of @xmath226 in @xmath1218 but it will suffice for the computation of the saturation factors .    here is the procedure for computing the saturation factor @xmath1219 .",
    "given @xmath1220 ( including the identity ) consider the orbits of @xmath1221 in the vertex set of the graph @xmath1215 . here and in",
    "what follows @xmath1221 denotes the cyclic subgroup of @xmath1222 generated by @xmath458 .",
    "let @xmath1223 be such an orbit .",
    "this orbit corresponds to the orbit @xmath1224 of @xmath1221 on the vertex set of the weyl alcove .",
    "take the barycenter @xmath1225 of the corresponding vertex set ( also denoted @xmath557 ) of the euclidean coxeter complex .",
    "for the point @xmath1226 compute the rational numbers @xmath1227 .    then find the gcd ( the greatest common denominator ) of the rational numbers @xmath1228 , call it @xmath1229 .",
    "finally , let @xmath1230    instead of taking all @xmath1220 it is enough to consider representatives of their conjugacy classes in @xmath1231 ( under the conjugation by the full automorphism group of @xmath1217 ) .",
    "it is clear that the number @xmath114 computed this way satisfies the required property :    \\1 . for the barycenter @xmath1075 of each @xmath435-admissible face of @xmath664 , the multiple @xmath1232 belongs to the coweight lattice ( which equals @xmath227 )    \\2 .",
    "the number @xmath114 is the least natural number with this property .",
    "the numbers @xmath49 and @xmath1208 are listed in the table ( [ tab ] ) below ( the number @xmath765 in the table is the index of connection ) .",
    "we will verify the computation in the most interesting case , namely for the root system of the @xmath111-type .",
    "suppose that the dynkin diagram @xmath354 has type @xmath1233 and that @xmath1234 .",
    "then @xmath1219 equals @xmath440 .",
    "in particular , if @xmath1207 then we get @xmath1235 .",
    "the group @xmath1234 acts on the graph @xmath1236 by cyclic permutations .",
    "let @xmath1220 be a permutation of order @xmath777 ; note that @xmath777 divides @xmath440 .",
    "then for each orbit @xmath557 of @xmath458 ( in the vertex set of the weyl alcove @xmath664 ) we get : @xmath1237 for each @xmath1238 , @xmath1239 if @xmath1240 , and @xmath1241 if @xmath1242 . for the highest root",
    "we get : @xmath1243 if @xmath1244 and @xmath1245 if @xmath1246 . in any case ,",
    "@xmath1247 .",
    "since all @xmath777 s divide the order @xmath440 of the group @xmath756 ( and for the generator of @xmath756 , @xmath1248 ) , the lcm of @xmath1229 s taken over all orbits and all elements of @xmath756 , equals @xmath440 .",
    "similarly we have    suppose that the dynkin diagram @xmath354 has type @xmath1249 and @xmath1250",
    ". then @xmath1219 equals @xmath1106 if @xmath756 permutes at least two roots labelled by @xmath879 and @xmath1251 if it does not ( the latter holds for the orthogonal groups ) .",
    "we note that for all classical root systems except @xmath1252 where @xmath1253 , @xmath1208 equals the index of connection @xmath765 and for all exceptional root systems , @xmath1254 ( so for the computation of saturation constants for problem * q3 * @xmath1252 behaves like an exceptional root system ) .",
    "if @xmath8 is a reductive algebraic group with the cocharacter lattice @xmath435 and the associated affine weyl group @xmath208 , we let @xmath1255 . the numbers @xmath1256 listed below appear in the discussion of the saturation for the invariant factor problem for the group @xmath8 , see section [ k - computation ] .    we then obtain :    @xmath1257    here @xmath1258 denotes the simply - connected algebraic group , the symbol @xmath1259 denotes the algebraic group of adjoint type , i.e. the quotient of @xmath1258 by its center . in the case of root systems with the index of connection equal to @xmath151 , @xmath1260 , so we have used the symbol @xmath11 to denote the unique connected algebraic group with the given root system .",
    "note that for the non - simply - connected classical groups we always get the order of the fundamental group as the saturation factor ( except for the group @xmath1261 ) .",
    "we begin this section with few simple remarks about existence of polygons in @xmath74 with the vertices of a given type .",
    "as before , @xmath1262 is such that the @xmath11-stabilizer of the model apartment @xmath111 acts on @xmath111 through the group @xmath414 , whose translational part is @xmath721 .",
    "thus , if @xmath1263 is a geodesic segment with @xmath1264 , then @xmath1265 iff @xmath1266 .",
    "therefore the following are equivalent for a polygon @xmath1035 , whose @xmath40-lengths are in @xmath1267 :    \\1 .",
    "all vertices of @xmath723 are in @xmath475 .",
    "one ( say , the first ) of the vertices of @xmath723 is in @xmath475 .",
    "we also have    [ special ] for a vector @xmath1268 the following are equivalent :    \\1 .",
    "there exists a polygon @xmath1035 with the @xmath40-lengths @xmath911 , such that all ( equivalently , one of ) the vertices of @xmath723 are in @xmath475 .",
    "there exists a polygon @xmath1035 with the @xmath40-lengths @xmath911 , such that all ( equivalently , one of ) the vertices of @xmath723 are special .",
    "it is clear that ( 1)@xmath1269(2 ) , let s prove the converse .",
    "let @xmath1270 be a polygon in @xmath74 with the @xmath40-lengths @xmath911 , such that the first vertex @xmath1271 of @xmath723 is special .",
    "let @xmath1272 be such that @xmath1273 have the same refined lengths as the segments @xmath1274 , @xmath812 . by assumption ,",
    "the vertex @xmath1275 is special .",
    "recall that the normalizer @xmath226 of @xmath208 in the group of translations of @xmath214 , acts transitively on the set of special vertices .",
    "we identify the model apartment @xmath214 with an apartment in @xmath74 containing the origin @xmath473 .",
    "let @xmath1276 be such that @xmath1277 .",
    "set @xmath1278 , @xmath812 .",
    "then @xmath669 are in @xmath435-orbit of @xmath473 for each @xmath765 and according to the transfer theorem [ transfer ] , there exists a geodesic polygon @xmath1279 with the refined side - lengths same as for @xmath1280 .",
    "in particular , @xmath1281 for each @xmath765 and all vertices of @xmath1282 are in @xmath475 .    thus a vector @xmath911 belongs to the image of the map ( [ ref - to - delta2 ] ) iff there exists a polygon @xmath1035 with special vertices and the @xmath40-side lengths @xmath911 .",
    "as we have seeing in chapter [ gau ] , the existence problem for polygons with the given @xmath40-side lengths in @xmath74 is equivalent to the existence of a fixed point for a certain map @xmath1283 . in this section",
    "we will try to find conditions under which @xmath110 fixes a _ special vertex _ in the building @xmath74 .",
    "we first analyze the case when the euclidean coxeter complex is irreducible .",
    "we therefore assume that the affine coxeter group @xmath208 corresponds to a reduced irreducible root system @xmath50 of rank @xmath51 in an @xmath51-dimensional vector space @xmath171 , with the underlying affine space @xmath214 , see chapter [ datum ] .",
    "recall that @xmath435 is a lattice such that @xmath1284 as before , @xmath414 denotes the subgroup of @xmath1222 generated by elements of @xmath208 and @xmath435 .",
    "then @xmath414 is a euclidean coxeter group with the linear part @xmath221 and translation part @xmath435 .",
    "since @xmath414 normalizes @xmath208 , we get the induced action of the finite abelian group @xmath1285 on the weyl alcove @xmath243 of @xmath208 .",
    "the notion of @xmath435-admissible faces of weyl alcoves of @xmath72 introduced in section [ sec : satfactor ] , carries over to the building @xmath74 .",
    "note that in the case @xmath687 , the only @xmath435-admissible faces are the vertices of @xmath74 .",
    "suppose that @xmath1286 , where @xmath1287 for each @xmath765 .",
    "let @xmath1288 be a weighted configuration on @xmath603 of the type @xmath483 , where @xmath1289 .",
    "consider the map @xmath1290 . then @xmath1291 where each @xmath1292 acts on every apartment @xmath1193 asymptotic to @xmath769 by the translation @xmath131 ( by the vector which has the same @xmath40-length as @xmath757 ) .",
    "thus the assumption @xmath1293 implies that each @xmath131 is an automorphism of the euclidean coxeter complex ( which we identify with @xmath1193 ) . in particular , the map @xmath157 preserves the simplicial structure of @xmath74 .",
    "[ fixedbarycenter ] assume in addition that @xmath157 has a fixed point in @xmath74 .",
    "then :    \\1 .",
    "@xmath157 fixes the barycenter of an @xmath435-admissible face in @xmath74 .",
    "\\2 . if @xmath1294 then @xmath157 fixes a vertex of @xmath74 .",
    "\\3 . more generally , if @xmath1295 is a lattice normalized by @xmath221 , such that @xmath1296 , and @xmath1297 , then @xmath157 fixes the barycenter of an @xmath1295-admissible face in @xmath74 .",
    "\\4 . if @xmath157 fixes a special vertex of @xmath74 then @xmath1294 . in particular ,",
    "if the coxeter complex associated with @xmath74 is the irreducible coxeter complex @xmath72 of type @xmath1298 , we have : @xmath1299    \\1 . for a fixed point @xmath1300 of @xmath157 ,",
    "let @xmath1301 denote the smallest face ( a simplex ) in @xmath74 containing @xmath606 .",
    "consider the apartments @xmath1302 ( containing @xmath1303 ) , @xmath1304 ( containing @xmath1305 ) , ... , @xmath1306 ( containing @xmath1307 ) .",
    "then @xmath1308 , @xmath1309 , ... , @xmath1310 .",
    "since @xmath157 preserves the simplicial structure of @xmath74 and @xmath1301 is the smallest simplex containing @xmath606 , we get : @xmath1311 .",
    "the map @xmath1312 is the composition of maps @xmath1313 where each @xmath1314 is a translation .",
    "let @xmath1315 be an ( isometric ) parameterization as in the definition of a space modeled on a coxeter complex .",
    "we can assume that @xmath1316 is a face of the weyl alcove @xmath1317 .",
    "there exists a parameterization @xmath1318 so that @xmath1319 on the domain of this composition . similarly ( like in the definition of a developing map of a geometric structure ) we choose parameterizations @xmath1320 , so that for each @xmath765 , @xmath1321 on the domain of this composition",
    ". then we get : @xmath1322 let @xmath1323 ; these maps are translations by the vectors @xmath1324 , which are in the @xmath208-orbits of the vectors @xmath757 , @xmath812 . set @xmath1325 . then the `` holonomy map '' @xmath1326 sends the simplex @xmath1327 to itself",
    "moreover , @xmath1328 where @xmath1329 .",
    "thus , by letting @xmath1330 , we conclude that @xmath1331 admits the extension by @xmath1332 to the entire @xmath214 .",
    "since @xmath1333 , @xmath157 induces an automorphism of the simplex @xmath1301 by an element of the group @xmath414 .",
    "we note that @xmath157 does not necessarily permute all the vertices of @xmath1301 .",
    "consider however an orbit of @xmath1334 on the vertex set of @xmath1301 .",
    "it is clear that this orbit spans an @xmath435-admissible simplex @xmath321 in @xmath1335 ; since @xmath1336 is a 1-lipschitz automorphism , it preserves the barycenter of the simplex @xmath321 and hence the first assertion of the theorem follows .",
    "let us prove the second assertion .",
    "set @xmath1337 .",
    "note that the map @xmath1338 is the translation in @xmath214 by the vector @xmath1324 where @xmath1339 for some @xmath1340 .",
    "the composition @xmath1341 is the translation by the vector @xmath1342 we claim that @xmath1343 iff @xmath1344 .",
    "we leave the proof of the following elementary lemma to the reader :    if @xmath1345 then for each @xmath1346 we have : @xmath1347    therefore @xmath1348 where @xmath1349 .",
    "this proves the claim .",
    "recall that @xmath1331 admits the extension by @xmath1332 ( where @xmath1329 ) to the entire model apartment @xmath214 .",
    "thus , if @xmath1344 then @xmath1331 is the restriction of an element @xmath1350 . since the alcove @xmath243 is a fundamental domain for the action of @xmath208 on @xmath214 and @xmath1327 is a face of @xmath243 , we conclude that @xmath1351 .",
    "hence @xmath157 fixes a vertex of @xmath74 .",
    "the proof of 3 is analogous to the proof of 2 and we leave it to the reader .    \\4 .",
    "lastly , suppose that @xmath157 fixes a special vertex @xmath606 of @xmath74 , then @xmath1352 , @xmath1353 is a special vertex in @xmath214 , and @xmath1354 implies that @xmath1355 , where @xmath1329 . since @xmath1356 is a special vertex , @xmath1357 , where @xmath1358 fixes @xmath1356 and @xmath1359 .",
    "thus @xmath1360 , which implies that @xmath1361 , and hence @xmath1344 .",
    "as an immediate corollary of the above theorem we get :    [ fixedvertex ] 1 . for each @xmath1362 such that @xmath1363 , there exists a polygon @xmath1035 such that @xmath1364 and the vertices of @xmath723 are at the vertices of @xmath74 .",
    "\\2 . if there exists a polygon @xmath1035 with special vertices and @xmath1364 , then @xmath1363 .    for the irreducible coxeter complex @xmath72 of the type @xmath1365",
    ", there are vectors @xmath1366 such that @xmath157 fixes a vertex of @xmath74 but @xmath1367 .",
    "consider the billiard triangle @xmath129 shown in figure [ f4 ] .",
    "it has geodesic sides @xmath1368 , @xmath1369 and the broken side @xmath1370 .",
    "its @xmath40-side lengths are @xmath219-integral and it has non - special vertices .",
    "= 3.5 in    let us check that this triangle can be unfolded to a geodesic triangle @xmath1371 in @xmath74 ( with vertices at the vertices of @xmath74 ) , in the sense of section [ foldtriangle ] .",
    "this can be done as follows .",
    "we note that the geodesic @xmath124 ( weakly ) separates @xmath405 from @xmath606 and @xmath612 .",
    "hence we can unfold the billiard triangle @xmath129 to a geodesic triangle in @xmath74 using lemma [ unfold ]",
    ".    then the vectors @xmath1372 representing the sides @xmath1373 and @xmath1374 of @xmath1375 are in the coroot lattice @xmath47 , but the vector @xmath1376 representing the side @xmath1369 is not in the coroot lattice . hence @xmath1377 .",
    "thus the fixed point of @xmath157 may not be special .",
    "however , if @xmath226 acts transitively on the vertices of @xmath214 , every vertex is special and we get :    [ transit ] suppose that the normalizer @xmath226 of @xmath208 in @xmath171 acts transitively on the vertices of @xmath214 .",
    "then the image of @xmath1378 in @xmath786 equals @xmath1379    the example of a coxeter complex for which the hypothesis of corollary [ transit ] holds is given by @xmath72 for which the finite weyl group @xmath221 is of type @xmath84 .",
    "then each vertex of the coxeter complex @xmath210 is special .",
    "next we consider the general case when the coxeter complex @xmath72 is reducible . as in section [ geometries ]",
    ", we have the corresponding derham decomposition of the building @xmath74 : @xmath635 where @xmath844 is the flat derham factor , the group @xmath639 ( @xmath1380 ) acts as an irreducible affine coxeter group on the euclidean space @xmath246 .",
    "the weyl chamber @xmath40 is the product @xmath1381 of weyl chambers , where of course @xmath262 .",
    "let @xmath1166 denote the orthogonal projection @xmath1382 , @xmath1383 ; by abusing notation we will also use @xmath1166 to denote the orthogonal projections @xmath1167 . given a lattice @xmath1159 in @xmath214 we get the inclusions @xmath1384 note that @xmath1385    we have    [ prop : reduction ] 1 .",
    "@xmath1386 .    \\2 . for each @xmath1387",
    ", there is a polygon @xmath1035 with the @xmath40-side lengths @xmath911 and the vertices at the ( special ) vertices of @xmath74 iff for each @xmath765 there exists a polygon @xmath1388 with the @xmath260-side lengths @xmath1389 and the vertices at the ( special ) vertices of @xmath636 .",
    "\\3 . @xmath1390 .",
    "we will prove the third assertion since the proofs of ( 1 ) and ( 2 ) are similar .",
    "first of all , if @xmath1035 is a polygon with @xmath1159-integral refined side - lengths then its projections @xmath1391 are also polygons with @xmath1168-integral refined side - lengths .",
    "conversely , if @xmath1388 are polygons with @xmath1392-integral refined side - lengths and @xmath1393 is the @xmath1013-th vertex of the polygon @xmath1394 , we set @xmath1395 this point is a vertex of @xmath74 since all @xmath1393 s are vertices of the corresponding buildings @xmath636 .",
    "this defines the polygon @xmath1396 in @xmath74 .",
    "it is clear that the refined side - lengths of @xmath723 are @xmath1159-integral .",
    "the above proposition implies that corollaries [ fixedvertex ] and [ transit ] remain valid for euclidean buildings with reducible coxeter complexes .    as in section",
    "[ sec : satfactor ] , given a lattice @xmath1159 in @xmath214 we define the lattice @xmath435 as the intersection of @xmath1159 and the translation group of @xmath1397 .",
    "we now can compute the image of the map ( [ ref - to - delta2 ] ) `` up to saturation '' :    [ sat ] 1 .",
    "let @xmath1398 be the saturation factor defined in section [ sec : satfactor ] .",
    "then for each @xmath1399 , there exists an @xmath135-gon @xmath1035 with special vertices and @xmath40-side lengths @xmath1400 .",
    "let @xmath50 be the root system corresponding to the coxeter complex @xmath72 and let @xmath1401 be the saturation factor defined in section [ sec : satfactor ] .",
    "then for each @xmath1399 satisfying @xmath1402 there exists an @xmath135-gon @xmath1035 with special vertices and @xmath40-side lengths @xmath1400 .",
    "we first consider the case when the root system @xmath50 is reduced , irreducible and has rank equal the dimension of the space @xmath171 ; then @xmath1403 .",
    "let @xmath1037 be a polygon with the @xmath40-lengths @xmath1404 .",
    "since @xmath1405 for each @xmath765 , theorem [ fixedbarycenter ] implies that the polygon @xmath1406 can be chosen so that its first vertex is the barycenter of an @xmath435-admissible simplex in @xmath74 .",
    "let @xmath1274 , @xmath1407 , be oriented segments in the model apartment @xmath214 , which represent the refined side - lengths of the polygon @xmath1406 ; the point @xmath1271 ( and hence @xmath1408 for each @xmath1409 ) is the barycenter of an @xmath435-admissible simplex in @xmath214 .",
    "we regard @xmath214 as the vector space @xmath171 by identifying the origin with the special vertex @xmath473 .",
    "then , according to the definition of @xmath1219 , the segments @xmath1410 have end - points at the _ special vertices _ of @xmath214 .",
    "consider the affine transformation @xmath1411 which is the homothety @xmath1412 .",
    "then @xmath1413 is an injective endomorphism of the affine coxeter systems and the transfer theorem [ transfer ] implies that there exists a polygon @xmath723 in @xmath74 whose refined side - lengths are represented by @xmath1414 , @xmath812 .",
    "the vertices of @xmath723 are special and its @xmath40-side - lengths are @xmath1400 .",
    "we now consider the general case when the coxeter complex @xmath72 is reducible .",
    "let @xmath1037 be a polygon with the @xmath40-lengths @xmath1404 .",
    "since @xmath1415 , we have @xmath1416 hence for each @xmath1417 we get @xmath1418 therefore , by theorem [ fixedbarycenter ] ( part 3 , where we take @xmath1419 , @xmath1417 ) , the polygon @xmath1406 can be chosen so that for each @xmath1417 , the vertices of @xmath1420 are barycenters of @xmath1421-admissible faces of @xmath1422 .",
    "recall that @xmath1423 .    by the irreducible case , for each @xmath1417",
    "there is a polygon @xmath1424 with special vertices and side - lengths @xmath1425 .",
    "let @xmath1426 , @xmath1427 , be oriented segments in the model apartment @xmath1428 , which represent the refined side - lengths of the polygon @xmath1429 .",
    "it follows from the transfer theorem [ transfer ] that for each @xmath1417 there exists a polygon @xmath1430 whose refined side - lengths are represented by the segments @xmath1431 , where @xmath1432 .",
    "note that @xmath1433 for each @xmath765 and @xmath1013 . by the definition of @xmath1434 , for each @xmath1013 the vertices of @xmath1435 are special vertices of @xmath1422 .",
    "now proposition [ prop : reduction ] implies that there exists a polygon @xmath1035 with the special vertices , whose projections to @xmath1422 are @xmath1435 for each @xmath1013 and the @xmath40-side lengths of @xmath723 are @xmath1400 .",
    "the proof of this assertion is analogous to the proof of 1 .",
    "first , suppose that the coxeter complex is irreducible .",
    "then , according to theorem [ fixedbarycenter ] ( part 2 ) , a polygon @xmath1037 with the @xmath40-lengths @xmath1404 can be chosen so that its vertices are vertices of @xmath74 .",
    "let @xmath1274 , @xmath1407 , be oriented segments in the model apartment @xmath214 , which represent the refined side - lengths of the polygon @xmath1406 .",
    "then , by the definition of @xmath1436 , the end - points of the segments @xmath1437 are special vertices of @xmath74 .",
    "the rest of the argument is the same as for ( 1 ) .",
    "we now apply the results from the previous section to the generalized invariant factor problem for nonarchimedean reductive lie groups @xmath11 .",
    "suppose that @xmath8 is a connected reductive algebraic lie group over @xmath5 , where @xmath5 is a field with discrete valuation @xmath290 .",
    "let @xmath1438 .",
    "the group @xmath8 determines a bruhat - tits building @xmath74 , bruhat - tits root system @xmath50 , the corresponding affine coxeter group @xmath208 and the extended cocharacter lattice @xmath1439 satisfying the double inclusion ( [ ink ] ) .",
    "define @xmath1440 .    as an immediate corollary of theorem [ sat ]",
    ", we obtain :    [ simplesaturation ] 1 . for @xmath1441 and any @xmath1442 , there exists an @xmath135-gon @xmath723 in @xmath74 with @xmath40-side - lengths equal to @xmath1130 and vertices in @xmath1443 .",
    "\\2 . for @xmath1436 and any @xmath1444 there exist an @xmath135-gon @xmath723 with @xmath40-side lengths equal to @xmath1130 and vertices in @xmath1443 .",
    "\\3 . if @xmath8 is semisimple and simply - connected then @xmath1445 and@xmath1446 .",
    "parts ( 1 ) and ( 2 ) follow from theorem [ sat ] ( parts ( 1 ) and ( 2 ) respectively ) and lemma [ special ] .    to prove ( 3 )",
    "note that in this case @xmath1447 and thus @xmath1448    we emphasize that @xmath1449 and @xmath49 depend only on @xmath11 and not the choice of @xmath483 .    by specializing to the case @xmath504 and using the equivalence ( see  [ geodesic polygons ] ) of problem rgti for euclidean buildings with the problem * q3 * , we get :    [ simplesaturation2 ] for each @xmath1157 divisible by @xmath1449 and each triple @xmath1450 which satisfies the _ generalized triangle inequalities _ for the space @xmath74 , there exist representatives @xmath1451 of the double coset classes @xmath1452 such that @xmath1453 .",
    "let @xmath1454 .",
    "then example [ notriangle2 ] shows that there is a triple @xmath1455 , such that @xmath280 satisfy the generalized triangle inequalities and such that one can not find @xmath1451 in the corresponding double cosets of @xmath1456 such that @xmath1453 .",
    "thus one can not take @xmath1131 for the case @xmath1040 .",
    "@xmath1457 . in other words , let @xmath74 be the bruhat - tits building associated with the group @xmath1458 , where @xmath5 is a field with nonarchimedean discrete valuation and the value group @xmath7 .",
    "let @xmath1459 have entries arranged in decreasing order .",
    "then @xmath911 satisfies the generalized triangle inequalities ( i.e. @xmath1460 ) if and only if there exists an @xmath135-gon @xmath723 in @xmath74 with the first vertex at the origin ( the point stabilized by @xmath1461 ) and @xmath40-side lengths @xmath911 .",
    "although this example is a special case of theorem [ sat ] ( part 2 ) , we present a complete proof for the benefit of the reader .",
    "recall ( see example [ glq ] ) that the euclidean coxeter complex @xmath72 of @xmath74 is reducible , @xmath1462 , where @xmath1180 is the kernel of the map @xmath1463 and @xmath265 is the span of @xmath1464 .",
    "let @xmath1465 be the vector space underlying @xmath1180 .",
    "we may identify @xmath1465 with the lie algebra of traceless real diagonal matrices , the real cartan subalgebra of the lie algebra of @xmath96 . moreover",
    "( see example [ glq ] ) , @xmath1466 , is the cocharacter lattice ; the orthogonal projection of @xmath435 to @xmath1465 is the coweight lattice of @xmath96 , and the root system is of type @xmath1467 . on the other hand ,",
    "suppose that @xmath1468 .",
    "then , since @xmath1460 , there exists a polygon @xmath1469 in @xmath74 with the @xmath40-side lengths @xmath757 .",
    "let @xmath845 be the derham decomposition of @xmath74 , where @xmath1470 is the flat factor .",
    "since the projection of @xmath1469 to the flat derham factor @xmath265 of @xmath74 is also a polygon , we get : @xmath1471 hence @xmath1472",
    ". therefore we can apply theorem [ fixedbarycenter ] ( part 2 or 4 ) to conclude that there exists a polygon @xmath1473 whose vertices are ( special ) vertices of @xmath855 and whose @xmath40-side lengths are @xmath1474 . by combining this with the polygon @xmath1475 via proposition [ prop :",
    "reduction ] we conclude that there exists a polygon @xmath1035 whose vertices are ( special ) vertices of @xmath74 and whose @xmath40-side lengths are @xmath1476 . thus @xmath1457 .",
    "let @xmath1477 be the derived ( i.e. commutator ) subgroup of @xmath8",
    ". then @xmath1478 2 . moreover , if @xmath1479 are the simple factors of @xmath1477 then @xmath1480    the equation ( [ deriv ] ) follows from three observations :    we first claim that the lattice @xmath1481 equals @xmath1482 .",
    "this is because we can assume that the maximal split tori @xmath1483 and @xmath1484 of @xmath1477 and @xmath8 are related by @xmath1485 hence the cocharacter lattice of @xmath1477 is the sublattice of @xmath301 consisting of those cocharacters whose image is contained in @xmath1477 .",
    "passing to tangent vectors at the identity yields the claim .",
    "second , by definition , the coroot system @xmath1486 of @xmath1477 is the same as the coroot system @xmath1487 of @xmath8 regarded as a root system in @xmath1397 .",
    "thus @xmath8 and @xmath1477 have the same affine weyl group @xmath208 .",
    "lastly , the projection of the lattice @xmath301 into @xmath1488 is contained in @xmath1489 .    with these observations , the same argument as in the case of @xmath68 goes through : @xmath1490 ( the saturation factor @xmath1256 depends only on the group @xmath208 and the cocharacter lattice ) , which implies ( [ deriv ] ) .    to prove the second assertion of the theorem note that the euclidean coxeter complex for @xmath1477 is the direct product of the euclidean coxeter complexes for its factors @xmath1491 .",
    "let @xmath1492 be maximal split tori of @xmath1493 , @xmath251 and @xmath1494 be their cocharacter lattices .",
    "let @xmath1495 , and @xmath1496 ; then each @xmath1168 is the projection of @xmath1159 to @xmath1162 , where @xmath1497 are the euclidean coxeter complexes associated with @xmath1498 .",
    "then definition [ satfactor ] implies that @xmath1499    we can also give a complete solution ( in terms of the stability inequalities ) for the invariant factor problem * q3 * in the case of nonarchimedean reductive lie groups @xmath11 with root system of type @xmath1467 .",
    "for instance , @xmath8 could be the quotient of @xmath96 by a subgroup of its center .",
    "as before , let @xmath435 denote the lattice @xmath301 and let @xmath1500 be the bruhat - tits building associated with @xmath8 .",
    "[ atype ] let @xmath8 be a reductive algebraic group over @xmath5 , so that the group @xmath8 has the associated root system @xmath50 of type @xmath1467",
    ". then the natural embedding @xmath1501 is onto .",
    "the assertion follows from corollary [ simplesaturation ] and the fact that @xmath1502 for the root system of type @xmath111 .",
    "specializing to the case of @xmath68 and @xmath96 we get the following corollary :    let @xmath1503 be the symmetric space of symmetric positive - definite @xmath104-matrices .",
    "then there exists a solution to the invariant factor problem * q3 * for the case @xmath1504 ( or @xmath1505 ) and @xmath1506 ( resp .",
    "@xmath1507 ) if and only if @xmath274 , @xmath275 and @xmath24 are integer diagonal matrices so that @xmath1508 and the projections @xmath1509 satisfy the stability inequalities [ thm : stabineqc ] for the space @xmath74 .",
    "here @xmath1510 is the identity matrix .",
    "in this section we will ( for the most part ) follow the notation of @xcite .",
    "we urge the reader to consult this paper for more details . however we will let @xmath5 and @xmath292 be as in section [ tough ] .",
    "we will assume that the valuation @xmath290 is discrete , the field @xmath5 is locally compact and the residue field is finite of order @xmath1049 and uniformizer @xmath371 .",
    "the assumption that @xmath5 is locally compact is equivalent to @xmath5 being a totally - disconnected local field , see ( * ? ? ?",
    "5 ) . by applying theorem [ transfer ]",
    ", it follows that the main result of this section , theorem [ q4->q3 ] , also holds in the case when @xmath5 is not locally compact , for example the case in which @xmath1511 the field of fractions of the ring of formal power series @xmath1512 $ ] .",
    "we let @xmath8 be a connected reductive algebraic group over @xmath5 .",
    "we will assume that @xmath8 is split over @xmath5 .",
    "then @xmath185 is the general fiber of a group scheme ( also denoted @xmath185 ) over @xmath292 with reductive special fiber .",
    "we fix a maximal split torus @xmath1513 defined over @xmath292 .",
    "we put @xmath1514 and @xmath1515 .",
    "we let @xmath1516 be a borel subgroup normalized by @xmath1517 and put @xmath1518 .",
    "we let @xmath1519 be the unipotent radical of @xmath326 whence @xmath1520 .",
    "let @xmath643 denote the bruhat - tits building associated with the group @xmath8 ; @xmath718 is a distinguished special vertex stabilized by the compact subgroup @xmath10 .",
    "we have already defined in section [ tough ] the free abelian groups ( of rank @xmath1521 ) @xmath1522 and @xmath1523 and a perfect @xmath7-valued pairing @xmath868 between them .",
    "the first contains the coroots @xmath166 , the second contains the roots @xmath50 of @xmath185 .",
    "the roots are the characters of @xmath1517 that occur in the adjoint representation on the lie algebra of @xmath185 .",
    "the subset @xmath1524 of the roots that occur in representation on the lie algebra of @xmath1525 forms a positive system and the indecomposable elements of that positive system form a system of simple roots @xmath1526 .",
    "we let @xmath575 denote the corresponding ( finite ) weyl group .",
    "the root basis @xmath1526 determines a positive weyl chamber @xmath1527 in @xmath1522 , by @xmath1528 we define a partial ordering on @xmath1527 by @xmath1529 iff the difference @xmath1530 is a sum of positive coroots",
    ".    we will use the notation @xmath596 for the trivial cocharacter .",
    "we define the element @xmath1531 $ ] by @xmath1532 we recall that @xmath1533 is the sum of the fundamental weights of @xmath50 .",
    "then , for all nontrivial @xmath1534 , the half - integer @xmath1535 is positive .",
    "the hecke ring @xmath1536 is the ring of all locally constant , compactly supported functions @xmath1537 which are @xmath10-biinvariant .",
    "the multiplication in @xmath1538 is by the convolution @xmath1539 where @xmath1540 is the haar measure on @xmath11 giving @xmath10 volume @xmath151 .",
    "we claim that the function @xmath1541 also takes values in @xmath7 .",
    "indeed , @xmath457 and @xmath458 are finite sums of characteristic functions of @xmath10-double cosets .",
    "thus it suffices to prove the claim in the case that @xmath457 and @xmath458 are both characteristic functions of @xmath10-double cosets . in this case",
    "it is immediate that their convolution product is the characteristic function of the set of products of the elements in the two double cosets .",
    "this product set is itself a finite union of @xmath10-double cosets .",
    "this implies that the structure constants @xmath1542 of the hecke ring , defined below , are nonnegative integers .",
    "the characteristic function of @xmath10 is the unit element of @xmath1538 . for the proof of the next lemma see @xcite .",
    "@xmath1538 is commutative and associative .",
    "in fact much more is true . for @xmath1543 let @xmath1544 be the characteristic function of the corresponding @xmath10-double coset @xmath1545 .    1 .",
    "the assignment @xmath1546 induces an isomorphism of free abelian groups @xmath1547 \\lra \\mathcal{h}$ ] .",
    "the hecke ring is a filtered ring with the filtration levels indexed by the ordered abelian semigroup @xmath1527 . in particular",
    ", we have @xmath1548    here and in what follows @xmath1549 denotes the sum over elements @xmath410 from @xmath1527 .",
    "we note that this sum is finite .",
    "we will prove in lemma [ polynomialstructureconstants ] , that the structure constants @xmath1550 are polynomials in @xmath1049 with integer coefficients . here and below we",
    "will keep track of the dependence of certain quantities on the cardinality @xmath1049 of the residue field .",
    "thus @xmath1049 will play the role of a variable in what follows .",
    "one of the main points here is that the structure constants @xmath1551 of the representation ring @xmath1552 do not depend on @xmath1049 .",
    "they will be encoded in the coefficients of the polynomials @xmath1550 ( along with the coefficients of the kazhdan - lusztig polynomials @xmath1553 ) .",
    "we recall the definition of the structure constants @xmath1554 : given double cosets of @xmath1555 in @xmath22 , consider the characteristic functions @xmath1556 , @xmath1557 and @xmath1558 of these double cosets ; then decompose the triple product @xmath1559 in the hecke algebra @xmath1538 .",
    "this defines @xmath1554 .",
    "our primary interest is @xmath1560 ( where @xmath596 is the trivial character ) ; it will be viewed as a function of the variable @xmath1049 .    in our proof of the saturation conjecture for @xmath68 we will need the following lemma , where @xmath1561 denotes the weight contragredient to @xmath24 .",
    "then @xmath1562 is a representative for the double coset obtained by inverting the elements in the one represented by @xmath1563 .",
    "[ contragredientstructureconstant ] @xmath1564    we define an inner product @xmath1565 on @xmath1566 , the space of compactly supported complex - valued functions on @xmath11 , by @xmath1567    we first claim that @xmath1568 indeed @xmath1569 the claim follows by noting that the product function is identically one if the cosets coincide and otherwise it is identically zero .    next we observe that @xmath1570 indeed , the right - hand side is equal to @xmath1571 hence @xmath1572 finally @xmath1573      in this section we will prove the following    [ trcount ] @xmath1560 is the number of triangles in the building @xmath74 with first vertex @xmath473 and side - lengths @xmath1574 .",
    "we recall that given @xmath1575 we define @xmath1576 , the `` @xmath122-sphere of radius @xmath483 and center at @xmath473 '' .    for each @xmath1577",
    "the group @xmath10 acts transitively on @xmath1578 .",
    "let @xmath1579 .",
    "by the properties of the action of @xmath11 on the building @xmath74 , presented in the list [ list ] , there exists @xmath1580 such that @xmath1581 and @xmath1582 where @xmath111 is the model apartment .",
    "since @xmath1581 we have @xmath1583 , whence @xmath1584 if follows that @xmath1585 and @xmath1586 .    as a consequence we can identify the right @xmath10quotients of the @xmath10double cosets in @xmath11 to the @xmath122spheres @xmath1578 in the building .",
    "the proof of the following lemma is then clear .",
    "let @xmath1587 .",
    "then the map @xmath1588 induces a bijection between the quotient @xmath1589 and @xmath1590 .",
    "we define @xmath1591 by sending @xmath1592 to the double coset represented by @xmath1593 .",
    "the reader will observe that @xmath457 is well - defined .",
    "thus @xmath457 induces a map ( again denoted @xmath457 ) from @xmath1594 to @xmath1595 .",
    "now let @xmath1596 .",
    "we define the set @xmath1597 note that this set is finite since @xmath1598 .",
    "let @xmath1599 be a triangle in the building @xmath74 with the @xmath40-side lengths @xmath1600 .",
    "then @xmath1601 and we obtain a map @xmath1602 from the space of triangles in @xmath74 with side - lengths @xmath1600 and first vertex at @xmath473 into the set @xmath1603 .",
    "we leave the proof of the following lemma to the reader .",
    "@xmath756 is a bijection .",
    "the appearance of the contragredient coweight @xmath1561 comes about because we require @xmath1604 , but @xmath1605 is the contragredient of the @xmath1606 .",
    "write @xmath1607 where both @xmath1510 and @xmath1608 are finite ( since @xmath1598 )",
    ". the theorem will be a consequence of the following lemma .",
    "@xmath1609 .",
    "we have @xmath1610    as a consequence of theorem [ trcount ] and lemma [ contragredientstructureconstant ] , we find that the structure constants for the hecke algebra are determined by the geometry of the building .",
    "[ geometrydeterminesstructureconstants ] let @xmath1596 .",
    "then we have @xmath1611    we have only to apply lemma [ contragredientstructureconstant ] and observe that since we are assuming that @xmath1612 we have @xmath1613 .      in this section",
    "we define an integral transform @xmath573 , the satake transform , from compactly supported , @xmath10-biinvariant functions on @xmath11 to left @xmath10-invariant , right @xmath1519-invariant functions on @xmath11 .",
    "let @xmath1614 be the modular function of @xmath326 , @xcite .",
    "we may regard @xmath1615 as a left @xmath10-invariant , right @xmath1519-invariant function on @xmath11 . by the iwasawa decomposition for @xmath11 , ( * ? ? ?",
    "51 ) , any such function is determined by its restriction to @xmath129 .",
    "we normalize the haar measure @xmath1616 on @xmath1519 so that the open subgroup @xmath1617 has measure @xmath151 .",
    "for a compactly supported @xmath10-biinvariant function @xmath457 on @xmath11 we define its _ satake transform _ as a function @xmath1618 on @xmath11 given by @xmath1619    then @xmath1620 is a left @xmath10-invariant , right @xmath1519-invariant function on @xmath11 with values in @xmath1621 $ ] ; this function is determined by its restriction to @xmath1622 .",
    "the main result of @xcite ( see also ( * ? ? ? * pg .",
    "147 ) ) , is that the image of @xmath573 lies in the subring @xmath1623)^w \\otimes \\z[q^{1/2},q^{-1/2 } ] \\cong   r(g^{\\vee})\\otimes \\z[q^{1/2},q^{-1/2}],\\ ] ] where @xmath1624 is a ring isomorphism . here and below , @xmath1625 .",
    "furthermore we have ( see @xcite , ( * ? ? ?",
    "147 ) ) :    the satake transform gives a ring isomorphism @xmath1626 \\cong r(g^{\\vee})\\otimes \\z[q^{1/2},q^{-1/2}].\\ ] ]    for @xmath1534 let @xmath1627 be the character of the irreducible representation @xmath1628 of @xmath43 ( see e.g. ( * ? ? ?",
    "* pg . 375 ) ) .",
    "we may identify @xmath1627 with a @xmath575-invariant element of @xmath1629 = \\z[x_*(\\underline{t})]$ ] .    in what follows",
    "we will need two bases for the free @xmath1630$]-module @xmath1631 $ ] .",
    "the first basis is @xmath1632 the second basis is @xmath1633    the change of basis matrices relating these two bases are both upper triangular ( see lemma [ expansionlemma ] below ) with entries in the ring @xmath1630 $ ] .",
    "we define the order ( at @xmath1634 ) @xmath1635 of the element @xmath1636 $ ] by @xmath1637 , provided that @xmath1638 .",
    "note that if @xmath457 is a polynomial in @xmath1049 then @xmath1639 where @xmath1640 is the degree of @xmath457 in @xmath1049 .",
    "we will accordingly extend the degree to @xmath1630 $ ] by defining @xmath1641 thus the extended degree takes values in the half integers .",
    "we define @xmath1642 for @xmath1643 $ ] to be the maximum of the degrees of the components of @xmath756 _ when @xmath756 is expressed in the basis @xmath1644_. we will use a similar convention ( i.e. , expanding it terms of the basis @xmath1644 ) when we speak of the  leading term \" of @xmath756 .",
    "we retain the notation @xmath1645 ( without subscript ) for the ordinary notion of degree @xmath1646 for the laurent polynomials in @xmath1621 $ ] .",
    "analogously , we define @xmath1647 when @xmath756 is expanded in terms of the basis @xmath1648 .    in what follows we will need two formal properties of @xmath1649 and @xmath1650 .",
    "we leave their proofs to the reader .",
    "the first is the _ ultrametric _ inequality which we state for @xmath1650 @xmath1651    the second is the obvious identity ( again stated for @xmath1650 ) @xmath1652.\\ ] ]    for the following lemma , due to lusztig , we refer the reader to ( * ? ? ? * ( 3.11 ) and ( 3.12 ) ) , ( * ? ? ? * ( 6.10 ) ) .",
    "see @xcite , for the statement of the lemma in the generality we require here .",
    "[ expansionlemma ] 1 . there exist polynomials @xmath1653 in @xmath1049 such that @xmath1654    \\2 .",
    "conversely , there exist polynomials @xmath1553 in @xmath1049 such that @xmath1655    the degree estimate below follows from @xcite , who proved that the polynomials @xmath1553 are _ kazhdan - lusztig polynomials_. these polynomials have many remarkable properties but the only property we need here is the degree estimate . the inequality of the next lemma will play a critical role in our proofs .",
    "[ kazhdanlusztigestimate ] for all @xmath1656 we have :",
    "@xmath1657    this lemma when combined with lemma [ expansionlemma ] has the following consequences .",
    "[ characterestimate ]    1 .",
    "2 .   @xmath1659    by lemma [ expansionlemma ] we get @xmath1660 hence lemma [ kazhdanlusztigestimate ] implies @xmath1661    since @xmath1662 we find that the inequality of the second statement of the lemma holds on a basis .",
    "consequently it holds for all @xmath1663 \\cong r(g^{\\vee})\\otimes \\z[q^{1/2},q^{-1/2}]$ ] . indeed , writing @xmath1664 we obtain , using the ultrametric inequality and the first statement of the lemma , @xmath1665 @xmath1666    recall that @xmath596 denote the trivial cocharacter .",
    "[ polynomialstructureconstants ] there exists a polynomial @xmath1667 in the variable @xmath1049 , such that we have the equality of functions in @xmath1049 : @xmath1668 furthermore , all structure constants @xmath1669 are polynomials in @xmath1049",
    ".    we will prove that all the structure constants @xmath1669 are polynomials in @xmath1049 .",
    "the first statement will follow from this .",
    "following @xcite we define @xmath1670 $ ] by @xmath1671 the elements @xmath1672 give a new basis for the @xmath1630$]-module @xmath1631 $ ] .",
    "we claim that the structure constants for the ring relative to this basis are polynomials in @xmath1049 .",
    "indeed , we have @xmath1673 now , since @xmath1674 , the coweight @xmath1675 is a sum of positive coroots and consequently @xmath1676 is an nonnegative integer",
    ".    we can now prove the second statement .",
    "let @xmath274 and @xmath275 be given .",
    "we expand @xmath1677 and @xmath1678 in terms of the basis of @xmath1679 s thereby introducing the polynomials @xmath1653 .",
    "we then multiply the resulting expressions . according to the paragraph above ,",
    "the result is an expression in the @xmath1679 s with polynomial coefficients in @xmath1049 .",
    "we then substitute for the @xmath1679 s using lemma [ expansionlemma ] introducing the polynomials @xmath1553 .",
    "it follows from theorem [ trcount ] that if @xmath1049 is a prime power then the values @xmath1667 are nonnegative .",
    "we now show that if for some prime power @xmath1049 the value @xmath1667 is nonzero then all values at prime powers are nonzero .",
    "we note that the examples we computed below show that the polynomial @xmath1680 can have coefficients of both signs .",
    "[ nonvanishing ] if a polynomial @xmath1680 is nonzero for some prime power @xmath1681 then it is nonzero at all prime powers .",
    "we assume that @xmath1049 is given such that @xmath1682 this means that @xmath1683 where @xmath1684 is a local field with residue field of order @xmath1049 .",
    "in other words , in the euclidean building @xmath1685 corresponding to the group @xmath1686 there exists a triangle @xmath483 with @xmath40-side lengths @xmath280 , whose vertices are special vertices of @xmath74 .",
    "it then follows from part 5 of theorem [ mainthm ] or , equivalently , from the transfer theorem [ transfer ] , that @xmath1687 for an _ arbitrary _ local field @xmath5 ( with any order @xmath1688 of the residue field ) .",
    "therefore @xmath1689 for all prime powers @xmath1690 .",
    "we recall the definition of the structure constants @xmath1691 : @xmath1692 we are interested in comparing the coefficient @xmath1693 ( corresponding to the trivial character @xmath596 of @xmath43 ) with @xmath1560 .    the main goal of this section is to prove the following    [ q4->q3]if the triple @xmath1574 is a solution of problem * q4 * then it is also a solution of problem * q3*. more precisely , @xmath1694    we first prove the following :    [ 4->3 ] suppose that @xmath185 is of a reductive algebraic group over @xmath5 which is split over @xmath5 . then :    \\(a ) the degree of the polynomial @xmath1667 is at most @xmath1695 .",
    "\\(b ) the leading coefficient of @xmath1667 , i.e. , the coefficient at @xmath1696 , is equal to @xmath1693 .    _ proof of theorem [ 4->3]_. for the benefit of the reader , below we explain the idea behind the proof of theorem [ 4->3 ] . we have to compute the coefficient of @xmath596 in the hecke triple product @xmath1697 .",
    "instead , we will compute the coefficient of @xmath596 in the triple product @xmath1698 in the representation ring @xmath1631 $ ] where the triple product is expanded _ relative to the basis @xmath1644_. in order to do this we will use the formula from lemma [ expansionlemma ] and compute ( initially ) in the basis @xmath1648 . however , to prove the theorem we must again apply lemma [ expansionlemma ] to rewrite the result in terms of the basis @xmath1644 .    the theorem will follow from the next three lemmas .",
    "we owe the first of these to jiu - kang yu .",
    "[ basic ] for all @xmath1699 satisfying @xmath1700 we have : @xmath1701    the proof is by induction on @xmath1702 with respect to the partial order @xmath1703 .",
    "we remind the reader that each set @xmath1704 is finite .",
    "if the set @xmath1704 is empty then there is nothing to prove .",
    "now assume that we are given @xmath1534 and that we have proved the above estimate for all predecessors of @xmath1702 in the partial order @xmath1703 .",
    "we have , according to lemma [ expansionlemma ] , @xmath1705 and @xmath1706 thus @xmath1707 we make the change of variable @xmath1708 in the last sum to obtain @xmath1709    since @xmath1710 is a basis of the @xmath1711$]-module @xmath1631 $ ] , by combining the previous formula with the part 1 of lemma [ expansionlemma ] , we obtain : @xmath1712    the degree of the first term satisfies the required estimate by lemma [ kazhdanlusztigestimate ] .",
    "we estimate the degrees of the terms in the second sum . by the induction hypothesis , @xmath1713 and by lemma [ kazhdanlusztigestimate ]",
    "we have @xmath1714 consequently , for all @xmath741 , we get @xmath1715    @xmath1716 .",
    "[ triple ] for @xmath1717 such that @xmath1718 is a nontrivial character , we have :    1 .",
    "2 .   @xmath1720    by expanding the triple product @xmath1721 @xmath1722 in terms of the basis @xmath1723 we get the following types of summands : @xmath1724 @xmath1725 @xmath1726 and similar ones obtained by permuting @xmath280 , and finally : @xmath1727 where in the latter case @xmath1728 , @xmath1729 .",
    "the first term ( @xmath1730 ) cancels out , we estimate the degree of each of the remaining terms separately",
    ". we will do it in the case of the 2-nd and 4-th term and leave the 3-rd term to the reader :    first , since @xmath1731 , @xmath1732 \\le \\\\   \\<\\alpha + \\beta , \\rho\\ > + deg ( a_{\\gamma}(\\lambda)q^{\\<\\la,\\rho\\ > } ) < \\\\ \\hbox{~(by lemma \\ref{basic})~~}\\\\ < \\<\\alpha + \\beta , \\rho\\ > +   \\<\\ga , \\rho\\ > = \\<\\al+\\be+\\ga , \\rho\\>.\\end{aligned}\\ ] ] similarly , @xmath1733 = \\\\ deg [ a_\\al(\\nu ) q^{\\<\\nu,\\rho\\ > } ] + deg [ a_\\be(\\mu )   q^{\\<\\mu,\\rho\\ > } ] + deg [ a_\\ga(\\la )   q^{\\<\\la,\\rho\\ > } ] < \\\\ \\hbox{~(by lemma \\ref{basic})~~}\\\\",
    "< \\<\\al+\\be+\\ga , \\rho\\>.\\end{aligned}\\ ] ] the first statement immediately implies the second and the lemma follows .",
    "[ striple ] under the assumptions of the above lemma , we have : @xmath1734    the assertion follows from lemma [ triple ] since by lemma [ characterestimate ] we have @xmath1735 .",
    "now we can prove the degree estimate in theorem [ 4->3 ] .",
    "observe that since @xmath1736 is one of the coefficients ( the coefficient of the trivial double coset ) of the triple product @xmath1737 when expressed in terms of the double coset basis for the hecke ring , we have @xmath1738 and hence @xmath1739 here the last equality follows from lemma [ triple ] .",
    "this proves the first assertion of theorem [ 4->3 ] .",
    "we now identify the leading term of @xmath1736 .",
    "let @xmath1740 be the element of the hecke ring defined by @xmath1741    let @xmath1742 denote the identity element of the representation ring ( i.e. the character of the trivial representation ) .",
    "we identify this element ( via the satake isomorphism ) with the trivial double coset @xmath1743 .",
    "we have    @xmath1744    by definition of the structure constants @xmath1691 we have @xmath1745 but by lemma [ characterestimate ] , @xmath1746 .",
    "noting that @xmath1742 is the character of the trivial representation the lemma follows .",
    "we now combine the previous lemma , the ultrametric inequality and corollary [ striple ] to obtain the estimate    @xmath1747    now the previous estimate on the difference of elements in the hecke ring implies that degrees of _ all _ coefficient polynomials of the difference when expanded in terms of the double coset basis satisfy the same estimate . now the coefficient of the identity element @xmath1748 of the triple product is @xmath1749 . thus applying the above observation to the identity coefficient of the difference",
    "we obtain    @xmath1750    this proves theorem [ 4->3 ] and in particular implies that the polynomial @xmath1680 is nonzero . hence for nonarchimedean local fields with sufficiently large residue fields ( i.e. sufficiently large @xmath1049 ) the structure constant @xmath1560 is nonzero . but by theorem [ nonvanishing ] if the structure constant @xmath1560 is nonzero for some nonarchimedean local field @xmath293 it is nonzero for all nonarchimedean local fields .",
    "hence theorem [ q4->q3 ] is proved .",
    "the above theorem also immediately implies the following    if @xmath1751 then @xmath1752 .",
    "we now give another explanation why @xmath1753    [ sum ]    1 .   @xmath1754 .",
    "2 .   @xmath1755 .",
    "\\(1 ) follows from theorem [ fixedbarycenter ] , part 4 .",
    "hence ( 2 ) follows from ( 1 ) via theorem [ 4->3 ] , however we give a direct proof below .",
    "the center of @xmath43 acts on each of the factors of the triple tensor product by a scalar , hence it acts by a scalar on the triple tensor product itself .",
    "but if @xmath1756 this scalar is necessarily @xmath151 . hence the center fixes the ( highest ) weight vector with weight @xmath1757 , whence @xmath1757 annihilates the center .",
    "accordingly it is in the character lattice of the adjoint group @xmath1758 .",
    "thus @xmath1759 .      in this section",
    "we consider two examples : @xmath1760 , whence @xmath1761 and the group @xmath185 of type @xmath59 and @xmath1762 .",
    "we begin with @xmath1760 ; we assume that we have chosen witt bases for @xmath1763 and @xmath886 .",
    "we let @xmath1764 be the split torus consisting of diagonal matrices in @xmath1765 and @xmath118 be the split torus of @xmath1766 consisting of diagonal matrices .",
    "we use the rectangular coordinates @xmath1767 in the cartan subalgebra @xmath1768 such that the simple roots are @xmath1769 .",
    "we set @xmath1770 note that @xmath1718 belongs to the coroot lattice of @xmath1766 , i.e. , the condition stated in theorem [ sum ] is satisfied .",
    "we give two proofs of the next lemma , the first computational , the second conceptual .",
    "@xmath1771    thus this choice of side - lengths is a solution problem * q3 * but not of problem * q4*.    in fact the second equality implies the first because , in this case , @xmath1772 . hence , ( according to theorem [ 4->3 ] ) @xmath1773 .",
    "but the coefficient of @xmath1774 in the above formula for @xmath1560 is @xmath596 .",
    "the first equality is obvious if we observe that under the isomorphism between @xmath1101 and @xmath1100 the representation of @xmath1765 with the highest weight @xmath1775 corresponds to the standard ( vector ) representation of @xmath1776 on @xmath1763 ( considered as a nonfaithful representation of @xmath1777 ) .",
    "now it is standard that the tensor square of this representation consists of three irreducible summands , the trivial representation ( corresponding to the invariant quadratic form ) , the exterior square of the standard representation and the harmonic quadratic polynomials on @xmath1763 .",
    "since none of these are equivalent to the standard representation and all representations of @xmath1765 are self - dual the first statement follows .",
    "the proof of the second statement requires more work . from (",
    "231 ) , we have : @xmath1778 upon taking the cube and calculating in the representation ring of @xmath1765 one obtains @xmath1779 \\\\ - 3 q^4 [ ch v_{(2,2 ) } + ch v_{(2,0 ) } + 1 ] + 3 q^2 ch v_{(1,1 ) } - 1.\\end{aligned}\\ ] ] upon substituting for the @xmath1627 using lemma [ expansionlemma ] ( and computing the appropriate kazhdan - lusztig polynomials @xmath1553 ) the lemma follows .    as for the conceptual proof of ( the second part of ) the lemma , note that the side - lengths belong to the root - subgroup @xmath1780 corresponding to the positive root @xmath1781 .",
    "but it is evident that one can construct an equilateral triangle with side - lengths equal to the positive root and vertices of the correct type in the tree for @xmath1782 .",
    "since this tree is convex in the building for @xmath1783 and the fixed vertex for @xmath1784 in this embedded tree is @xmath473 ( the fixed vertex for @xmath1785 ) , the lemma follows .",
    "equivalently if we can realize the trivial double coset as a product of the three @xmath1784double cosets in @xmath1782 belonging to @xmath1786 then we can certainly do it in @xmath1787 .",
    "this last sentence is the essence of the counterexample .",
    "the solutions to problems * q3 * and * q4 * behave differently with respect to inclusions of subgroups",
    ". the solutions of problem * q3 *  push forward \" , the solutions of problem * q4 * do not .",
    "we now give another example of a triple of coroots @xmath1788 such that the triple is a solution to problem * q3 * but not of problem * q4*. this example was motivated by unpublished observations of s.  kumar and j.  stembridge .",
    "we take @xmath1789 .",
    "hence @xmath1790 as well .",
    "we take @xmath1791 and @xmath1792 . here",
    "@xmath1793 is the first fundamental weight ( the highest weight of the unique irreducible seven dimensional representation ) and @xmath1794 is the second fundamental weight ( the highest weight of the adjoint representation ) .",
    "@xmath1795    from ( * ? ? ?",
    "231 , ( 5.7 ) ) , we have @xmath1796    multiplying ( using lie ) one obtains @xmath1797    hence , by lemma [ expansionlemma ] we have @xmath1798    using @xmath1799 and @xmath1800 we obtain @xmath1801    now lemma [ contragredientstructureconstant ] implies that @xmath1802  from ( * ? ? ? *",
    "735 ) , we get @xmath1803 the lemma follows .",
    "@xmath1804    from ( * ? ? ?",
    "231 , ( 5.7 ) ) , we have @xmath1805 and @xmath1806 whence @xmath1807 . hence , the structure constant has degree ( one ) less than the maximum possible degree .",
    "we now give a geometric proof ( using unfolding ) that @xmath1808 is nonzero .",
    "we show that there exists a triangle @xmath970 ( with @xmath40-side - lengths @xmath1809 ) in a discrete euclidean building @xmath74 modeled on the discrete affine coxeter complex of type @xmath59 , so that all vertices of @xmath970 are special .",
    "we start with the billiard triangle @xmath129 in figure [ g2example ] , contained in a model apartment @xmath1810 ; this triangle has two geodesic sides @xmath1811 and one broken side @xmath1370 .",
    "note that all three vertices of this billiard triangle are special vertices of the coxeter complex .",
    "the break point @xmath1812 on the broken side of the billiard triangle belongs to the wall @xmath124 of the coxeter complex , the wall @xmath124 separates the broken side @xmath1370 from the vertex @xmath1813 .",
    "thus , by lemma [ unfold ] , one can unfold the billiard triangle @xmath129 to a geodesic triangle @xmath1814 preserving the refined side - lengths .",
    "one can also easily see that @xmath1815 using littelmann s path model .",
    "= 3.5 in      in this subsection we explain green s idea for proving that for @xmath1 @xmath1816 let @xmath5 be a valued field with a discrete complete valuation @xmath290 and let @xmath1817 be the subring of elements with nonnegative valuation . pick a uniformizer @xmath343 for the valuation @xmath290 .",
    "we will assume that the residue field is finite .",
    "let @xmath8 be a connected reductive group algebraic group over @xmath5 and set @xmath717 and let @xmath1818 be its langlands dual .",
    "we will assume that @xmath8 is split over @xmath5 .",
    "recall that the _ structure constants _ @xmath1669 and @xmath1819 for the hecke ring of @xmath11 and the representation ring of @xmath43 respectively , are given by @xmath1820 @xmath1821 we will say that a dominant weight @xmath741 for @xmath1 is a _ partition _ if all components of the integer vector @xmath741 are nonnegative .",
    "the starting point is that if the dominant weights @xmath1574 are partitions then there is a standard formula ( * ? ? ? *",
    "161 ) that expresses the structure constant @xmath1669 as the number of finite @xmath1822-module extensions @xmath1823 where @xmath1824 , @xmath1825 and @xmath1826 .",
    "we will say that such an extension is of type @xmath1827 .",
    "now for @xmath1 there is an explicit formula ( the littlewood- richardson rule ) for the structure constant @xmath1819 ( in case @xmath1574 are partitions ) as the number of littlewood ",
    "richardson sequences ( of partitions ) of type @xmath1827 , see ( * ? ? ?",
    ". then the observation of j.  green is the following    suppose there exists an extension of @xmath292-modules of type @xmath100 .",
    "then there exists a littlewood - richardson sequence ( of partitions ) of type @xmath100 .",
    "thus for the group @xmath1 we find that if @xmath1828 are partitions and the structure constant @xmath1829 is nonzero then the structure constant @xmath1830 is nonzero ( the superscript @xmath1831 denotes the contragredient dominant weight ) .",
    "we next remove the assumption that @xmath1828 are partitions . to this end",
    "let @xmath1702 be the cocharacter of @xmath1 that sends @xmath1832 to the scalar matrix with diagonal entries equal to @xmath405 .",
    "if @xmath274 is a cocharacter then there exists @xmath114 such that @xmath1833 is a partition .",
    "now since the matrix @xmath1834 is scalar it is clear that for any @xmath274 @xmath1835 .",
    "it then follows that @xmath1836 now the previous operation of convolving with the function @xmath1837 corresponds , under langlands   duality , to multiplying a character by @xmath1838 , the character of the determinant representation .",
    "thus @xmath1839    finally , by lemma [ contragredientstructureconstant ] we have @xmath1840 also it is immediate that @xmath1841 .",
    "thus , if @xmath1842 then @xmath1843 as well . by combining this with theorem [ q4->q3 ] , we conclude that for @xmath1 problems * q3 * and * q4 * are equivalent . since we have proved that @xmath151 is a saturation factor for the problem * q3 * it is also a saturation factor for * q4*.      given a root system @xmath50 , the intersection @xmath1844 is a semigroup whose finite generating set ( a _ hilbert basis _ ) can be computed once we know the explicit _ stability inequalities _ defining the convex cone @xmath76 .",
    "we have performed these computations for the root systems @xmath1845 using the program 4ti2 ( which could be found at http://www.4ti2.de ) and the stability inequalities established in @xcite .",
    "let @xmath1846 be the long and short fundamental coweights for the root system @xmath50 ; below we will use the coordinates @xmath1847 $ ] for the coweight @xmath1848 .",
    "the hilbert basis in the case @xmath1849 consists of the following 8 triples @xmath37 and their permutations under the @xmath1850 action : @xmath1851 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 0\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 0\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 2\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 1\\end{array}\\right]\\right),\\ ] ] @xmath1851 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right).\\ ] ] we note that the first 5 generators are represented by flat triangles contained in an apartment in @xmath74 and therefore are solutions of * q4 * ( and of course of * q3 * )",
    ". the last three generators are not solutions of * q3 * since @xmath1853 .",
    "however , a direct computation ( using littelmann triangles ) shows that for every generator @xmath37 among the last 3 generators in our list , @xmath1854 is a solution of * q4*. therefore , since the solution set of * q4 * forms a semigroup , we obtain    if @xmath37 belongs to @xmath1855 then the triple @xmath1854 is a solution of the problem * q4 * for the group @xmath1101 .",
    "we next observe that the solution set of the problem * q3 * for the group @xmath1100 is not a semigroup . indeed , using the coordinates as in the example [ notriangle2 ] , consider the triples @xmath1856 , @xmath1857 . as in section [ 3not4 ] ,",
    "the first triple is a solution of the problem * q3 * for @xmath1100 , the second triple represents a flat triangle with the vertices @xmath1858 in the apartment .",
    "however @xmath1859 is the triple from the example [ notriangle2 ] , and therefore is not a solution of * q3*.    the hilbert basis in the case @xmath1860 consists of the following triples @xmath37 and their permutations under the @xmath1850 action : @xmath1851 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 0\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 0\\end{array}\\right]\\right),\\ ] ] @xmath1851 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) ,   \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 3\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 2\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 3\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 2\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 2\\end{array}\\right]\\right),\\ ] ] @xmath1852 , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) , \\quad \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 1\\end{array}\\right]\\right).\\ ] ] the first 9 generators are solutions of * q4 * and the last two generators are only solutions of * q3*. however one can show ( arguing analogously to the example [ notriangle2 ] ) that the sum of the last two generators , @xmath1861 , \\left[\\begin{array}{c } 2\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 2\\end{array}\\right]\\right)\\ ] ] is not a solution of * q3*. hence the solution set of * q3 * for the root system @xmath59 is not a semigroup . on the other hand , a direct computation shows that for both @xmath1862 the triples @xmath1863 , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 0\\\\ 1\\end{array}\\right]\\right ) , \\quad k\\cdot \\left(\\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 0\\end{array}\\right ] , \\left[\\begin{array}{c } 1\\\\ 1\\end{array}\\right]\\right)\\ ] ] are solutions of * q4*. therefore , since the solution set of * q4 * is a semigroup and because each natural number @xmath1864 has the form @xmath1865 , we get :    for each @xmath1866 the semigroup @xmath1867 is contained in the solution set of * q4*.",
    "in this section we will assume that @xmath11 is a reductive complex lie group with lie algebra @xmath285 and weyl group @xmath575 .",
    "we let @xmath10 be a maximal compact subgroup of @xmath11 and @xmath129 be a maximal torus in @xmath11 and @xmath326 be a borel subgroup containing @xmath129 .",
    "we let @xmath1868 denote the lie algebra of @xmath129 .",
    "we may choose @xmath129 so that it is preserved by the cartan involution of @xmath11 corresponding to @xmath10 .",
    "let @xmath1869 denote the cartan decomposition of the lie algebra @xmath12 of @xmath11 and let @xmath1870 . then multiplication by @xmath1871 interchanges @xmath77 and @xmath286 .",
    "we let @xmath1872 be the associated symmetric space .",
    "the choice of @xmath326 is equivalent to a choice of positive roots or a positive chamber @xmath1873",
    ". we will be sloppy throughout with the difference between the solution sets for problem * q1 * for @xmath11 and @xmath43 since these sets are canonically isomorphic ( say by using an @xmath330 invariant metric on @xmath286 ) . in the similar fashion",
    "we will identify @xmath286 with @xmath1874 and @xmath77 with @xmath1875 .",
    "we will use the following notation .",
    "let @xmath1876 be a dominant weight for the torus @xmath129",
    ". then we let @xmath1628 be an irreducible @xmath11module with the highest weight @xmath1702 ( so @xmath1628 is unique up to isomorphism ) .",
    "we let @xmath1877 be the highest weight of the dual representation , so @xmath1878 where @xmath1879 is the longest element in @xmath575 .",
    "let @xmath1885 be a dominant weight .",
    "then the coadjoint orbit @xmath1886 as above carries a natural homogeneous complex structure ( see ( * ? ? ?",
    "* chapter 1 ) ) so that the coadjoint action of @xmath10 on @xmath1886 extends to a holomorphic action of @xmath11 .",
    "the dominant weight @xmath1880 defines a very ample line bundle @xmath1887 over @xmath1886 and the action of @xmath11 on @xmath1886 extends to a holomorphic action @xmath1888 .",
    "now let @xmath274 and @xmath275 be dominant weights .",
    "in this section we will discuss the problem of finding the possible irreducible constituents of tensor products @xmath1891 .",
    "of course this is equivalent to finding for which triples @xmath274 , @xmath275 , @xmath24 , the space of @xmath11invariants @xmath1892 is nonzero .",
    "since the line bundle @xmath1896 is very ample , it determines a @xmath11equivariant holomorphic embedding @xmath756 of @xmath1895 into @xmath1897 .",
    "we will use the notation @xmath1898 for the mumford quotient associated with this line bundle . see the end of section [ gaussmaps ] for further discussion ; note that here we have shortened the notation @xmath1899 ( in  [ gaussmaps ] ) to @xmath1900 .",
    "the moduli space of triangles in the infinitesimal symmetric space @xmath77 with @xmath40side lengths @xmath274 , @xmath275 , @xmath24 is canonically homeomorphic to the mumford quotient @xmath1901 defined above .    by a theorem of kempf and ness @xcite ,",
    "the mumford quotient @xmath1901 is canonically homeomorphic to the symplectic quotient @xmath1902 .",
    "it is a standard argument ( essentially the formula for the moment map of the action of the diagonal subgroup of a product ) that @xmath1903 however the latter is canonically isomorphic to the moduli space of triangles in @xmath77 with the @xmath40side lengths @xmath1904 .",
    "the main goal of this section is to prove theorem [ vectorsandngons ] , that relates the existence of semistable triples in @xmath1895 and the existence of nonzero invariants in triple tensor products of irreducible representations of @xmath11 .",
    "theorem [ vectorsandngons ] implies that if @xmath1910 then there exists a weighted semistable configuration on @xmath603 of type @xmath1827 .",
    "however the converse is false as we have seen in section [ 3not4 ] .",
    "let @xmath111 be the graded ring associated to the projective variety @xmath1911 .",
    "then by definition @xmath1912 is the set of restrictions to @xmath1911 of the homogeneous polynomials of degree @xmath114 in the projective coordinates given by a basis of @xmath1913 thus @xmath1914 here @xmath1915 is the degree @xmath114summand of the graded ideal of polynomials in the sections of @xmath1916 that vanish on @xmath1895 .",
    "equivalently , @xmath1915 is the degree @xmath114 component of the ideal @xmath1510 of polynomials that vanish on @xmath1911 in the ring of polynomials on @xmath1917 .",
    "now another definition of the mumford quotient is @xmath1918 where @xmath1919 is the subring of @xmath11invariants of the graded ring @xmath111 .",
    "we define another graded ring @xmath50 by @xmath1920 below and in what follows , if @xmath1921 are @xmath433modules , then @xmath1922 denotes the @xmath1923module with the underlying vector space equal to the tensor product @xmath1924 .",
    "we define a graded @xmath1925module @xmath180 by @xmath1926 we will abuse notation and use @xmath180 to denote the restriction of the previous module to the diagonal in @xmath1925 . then , we have an isomorphism of @xmath11modules @xmath1927      the lemma follows from the following three equations .",
    "first , let @xmath1930 and @xmath1931 be complex manifolds and @xmath1932 , resp .",
    "@xmath1933 , be a holomorphic line bundle over @xmath1930 , resp .",
    "first we have        next we show that @xmath111 and @xmath50 are isomorphic .",
    "this is the exceptional feature of the homogeneous situation .",
    "the key point , the surjectivity of the natural map below , was pointed out to us by lawrence ein .      to obtain the desired map from the graded ring @xmath111 to the graded ring @xmath50",
    "we observe that for any complex manifold @xmath442 and holomorphic line bundle @xmath1938 over @xmath442 there is a natural map ( usually not onto ) from @xmath1939 to @xmath1940 .",
    "hence there is a natural map from @xmath1912 to @xmath1941 .",
    "the exceptional feature here is that this natural map is _",
    "onto_.    to see this we note that by the theorem of borel and weil the action of @xmath1942 on @xmath1941 is irreducible .",
    "but the image of @xmath1912 in @xmath1941 is an invariant subspace .",
    "hence @xmath1912 maps onto @xmath1941 .",
    "clearly the map is injective ( because we have divided by the ideal @xmath1943 .",
    "theorem [ vectorsandngons ] follows by taking @xmath11invariants from the @xmath11isomorphism @xmath1944 .",
    "indeed , there exists a triangle with @xmath40side lengths @xmath274,@xmath275,@xmath1945 the mumford quotient @xmath1901 is nonempty @xmath1946 .",
    "the reason that the existence of a nonzero @xmath11invariant does not follow from the existence of a triangle is that the lowest degree @xmath11invariant might not have degree @xmath151 , that is , it is possible that @xmath1947      we will use @xmath1948 to denote the semigroup of dominant characters of @xmath129 henceforth .",
    "we begin this section by noting that the set of triples of dominant characters @xmath100 that belong to @xmath76 is a subsemigroup @xmath1949 ( since it is determined by a system of homogeneous linear inequalities ) .",
    "moreover , since these inequalities have integral coefficients , the subsemigroup @xmath1950 is finitely generated .",
    "we set @xmath1951 i.e. the set of triples @xmath37 for which @xmath1952    we recall that if @xmath1953 is an inclusion of semigroups then the _ saturation _ of @xmath1954 in @xmath1955 is the semigroup of elements of @xmath1956 such that for some positive integer @xmath135 we have @xmath1957 .",
    "first we need a general lemma .",
    "let @xmath1960 be a complex reductive group , @xmath1961 be a borel subgroup of @xmath1960 and @xmath1702 and @xmath741 be dominant characters ( as in the beginning of the appendix ) .",
    "we recall that the irreducible representation @xmath1962 is always an irreducible constituent of multiplicity 1 in the tensor product @xmath1963 .",
    "let @xmath1964 be the @xmath1960equivariant projection .",
    "let @xmath1968 .",
    "we apply the borel - weil theorem to obtain @xmath1969 , @xmath1970 and @xmath1971",
    ". then @xmath1972 corresponds to a section @xmath1973 and @xmath1974 corresponds to a section @xmath1975 .",
    "hence @xmath1976 corresponds to the product section @xmath1977 of the product line bundle @xmath1978 .",
    "but since @xmath442 is irreducible the product section can not be zero .",
    "let @xmath1979 and let @xmath1980 be a nonzero @xmath11invariant vector in @xmath1981 we take @xmath1982 and @xmath1983 , where @xmath1984 is a borel subgroup as before ; we have the @xmath1960modules @xmath1985 then @xmath1986 by the above lemma , the vector @xmath1976 is nonzero . since it is clearly @xmath11invariant , @xmath1987",
    "hence @xmath1988 and the first statement of theorem follows .          by gordan s lemma ,",
    "see ( * ? ? ?",
    "* proposition 1 , page 12 ) , the semigroup @xmath1950 is finitely generated .",
    "choose a finite set of generators @xmath1990 of this semigroup .",
    "for each generator @xmath1991 there exists a positive integer @xmath1201 such that @xmath1992 see theorem [ vectorsandngons ]",
    ". then take @xmath1993 .",
    "a.  klyachko , _ random walks on symmetric spaces and inequalities for matrix spectra _ , linear algebra appl .",
    "special issue : workshop on geometric and combinatorial methods in the hermitian sum spectral problem ( coimbra , 1999 ) , vol .",
    "* 319 * ( 2000 ) , no .  13 , p. 3759 .",
    "s.  kumar , b.  leeb , j.  j.  millson , _ the generalized triangle inequalities for rank @xmath880 symmetric space of noncompact type _ , in : `` explorations in complex and riemannian geometry ( papers dedicated to robert greene ) , '' contemporary math .",
    ", vol 332 , 2003 , p. 171195 ."
  ],
  "abstract_text": [
    "<S> in this paper we apply our results on the geometry of polygons in infinitesimal symmetric spaces , symmetric spaces and buildings , @xcite , to four problems in algebraic group theory . </S>",
    "<S> two of these problems are generalizations of the problems of finding the constraints on the eigenvalues ( resp . </S>",
    "<S> singular values ) of a sum ( resp . product ) when the eigenvalues ( singular values ) of each summand ( factor ) are fixed . </S>",
    "<S> the other two problems are related to the nonvanishing of the structure constants of the ( spherical ) hecke and representation rings associated with a split reductive algebraic group over @xmath0 and its complex langlands dual . </S>",
    "<S> we give a new proof of the `` saturation conjecture '' for @xmath1 as a consequence of our solution of the corresponding `` saturation problem '' for the hecke structure constants for all split reductive algebraic groups over @xmath0 . </S>"
  ]
}