{
  "article_text": [
    "quaternions , invented by the irish mathematician w. r. hamiltonian in 1843 , have been extensively utilized in physics @xcite , aerospace and aeronautical technologies @xcite , robotics and automation @xcite , human motion capture @xcite , computer graphics and games @xcite , molecular dynamics @xcite , and flight simulation @xcite .",
    "quaternions have no inherent geometrical singularity as euler angles when parameterizing the 3-dimensional special orthogonal group manifold @xmath0 with local coordinates and they are useful for real - time computation since only simple multiplications and additions are needed instead of trigonometric relations .",
    "almost all of the researches available about the applications of quaternions focus on these two merits and the fundamental _ quaternion kinematical differential equation _ ( qkde ) @xcite . in @xcite",
    "( see page-21 , eq.77 . ) , robinson presented the following qkde @xmath1 where @xmath2 is the initial time , @xmath3}^\\textsf{t}}$ ] is the angular velocity vector , @xmath4}^\\textsf{t}}$ ] is the matrix representation of the quaternion @xmath5 with scalar part @xmath6 as well as vector part @xmath7}^\\textsf{t}}$ ] , and @xmath8_\\times } \\end{bmatrix } = -{{{\\bm{a}}}^\\textsf{t } } , \\\\ { [ { \\bm{\\omega}}]_\\times } & = \\begin{bmatrix } 0 & -\\omega_3 & \\omega_2 \\\\ \\omega_3 & 0 & -\\omega_1 \\\\ -\\omega_2 & \\omega_1 & 0 \\end{bmatrix } = -{{({[{\\bm{\\omega}}]_\\times})}^\\textsf{t}}. \\end{split}\\ ] ] formally , eq.([eq - qkde ] ) is a linear ordinary differential equation ( ode ) and its numerical solution should be easily determined in practical engineering applications .",
    "however , as wie and barbar @xcite pointed out , the coefficients @xmath9 , or equivalently the angular rate vector @xmath10}^\\textsf{t}}$ ] , are time - varying and the matrix @xmath11 has the repeated eigenvalues @xmath12 where @xmath13 denotes the frobnius norm ( @xmath14-norm ) .",
    "this implies that _ the linear system , i.e. the qkde described by eq.([eq - qkde ] ) , is critically ( neutrally ) stable and the numerical integration is sensitive to the computational errors_. therefore , it is necessary to find a robust and long time precise integration method for solving eq.([eq - qkde ] ) .",
    "many researchers have studied this problem with the traditional finite difference method since 1970s .",
    "hrastar @xcite , cunningham @xcite and wie @xcite used the taylor series method , miller @xcite tried the rotation vector concept , mayo @xcite adopted the runge - kutta @xcite and the state transition matrix method and wang @xcite compared the runge - kutta scheme with symplectic difference scheme , and funda et al . @xcite",
    "used the periodic normalization to unit magnitude .",
    "however , even for the time - invariant @xmath15 , the numerical scheme for qkde may be sensitive to the accumulative computational errors and may also encounter the stiff problem .",
    "we solve the qkde eq.([eq - qkde ] ) via symplectic geometric algorithms ( sga ) which overcomes the disadvantages of the previous methods .",
    "firstly , we consider the autonomous qkde ( a - qkde ) in which the parameters @xmath16 and @xmath17 are time - invariant constants . in such a scenario ,",
    "the qkde can be modeled by an autonomous hamiltonian system and the sga , which was firstly proposed by k. feng @xcite and r. d. ruth @xcite independently and developed by other researchers in the past 30 years @xcite , and can be applied directly to get a non - dissipative numerical scheme .",
    "secondly , we discuss the non - autonomous qkde ( na - qkde ) where @xmath18 depend on time explicitly and give its numerical scheme by utilizing symplectic geometric method .    the main purpose of this paper is to propose sgas for solving the general qkde while preserving long time precision and the norms of quaternions interested automatically .",
    "the contents of this paper are organized logically .",
    "the preliminaries of sga are presented in section [ section2 ] .",
    "section [ section3 ] deals with the sga for the a - qkde . in section [ section4 ]",
    "we cope with the sga for na - qkde .",
    "the simulation results are presented in section [ section5 ] .",
    "finally , section [ section6 ] gives the summary and conclusions .",
    "w. r. hamiltonian introduced the canonical differential equations @xcite @xmath19 for problems of geometrical optics , where @xmath20 are the generalized momentums , @xmath21 are the generalized displacements and @xmath22 is the hamiltonian , viz . , the total energy of the system .",
    "let @xmath23}^\\textsf{t}}\\in { \\mathbb{r}^{{n}\\times { 1}}}$ ] , @xmath24}^\\textsf{t}}\\in { \\mathbb{r}^{{n}\\times { 1}}}$ ] , and @xmath25}^\\textsf{t}}= { { [ { { { \\bm{p}}}^\\textsf{t } } , { { { \\bm{q}}}^\\textsf{t}}]}^\\textsf{t}}\\in { \\mathbb{r}^{{2n}\\times { 1}}}$ ] , then @xmath26 can be specified by @xmath27 in the @xmath28-dimensional phase space . since the gradient of @xmath29 is @xmath30}^\\textsf{t } }",
    "\\in { \\mathbb{r}^{{2n}\\times { 1}}}.\\ ] ] then the canonical equation is equivalent to @xmath31 where @xmath32 is the @xmath33-by-@xmath33 identical matrix , @xmath34 is the @xmath33-by-@xmath33 zero matrix and @xmath35 is the @xmath28-th order standard symplectic matrix @xcite .",
    "any system which can be described by eq.([eq - heq ] ) is called an hamiltonian system .",
    "the canonical equation of hamiltonian system is invariant under the symplectic transform ( phase flow ) , the evolution of the system is the evolution of symplectic transform , both the symplectic symmetry and the total energy of the system can be preserved simultaneously and automatically @xcite .",
    "the symplectic geometric algorithms are motivated by these fundamental facts .",
    "ruth @xcite and feng @xcite emphasized two key points in their pioneer works :    * symplectic geometric algorithm is a kind of difference scheme which preserves the symplecitc structure of hamiltonian system ; * the single - step transition mapping is a symplectic transform ( matrix ) which preserves the symplectic structure of the difference equation obtained by discritizing the original continuous eq.([eq - heq ] ) .    when the initial condition @xmath36}^\\textsf{t}}$ ] is given , the symplectic difference scheme ( sds ) for eq.([eq - heq ] )",
    "can be written by @xmath37 = { \\bm{g}}_\\tau { \\bm{z}}[k],\\quad { \\bm{z}}[0 ] = { \\bm{z}}(t_0 ) ,   \\quad k = 0 , 1 , 2 , \\cdots\\ ] ] where @xmath38 is the time step , @xmath39 = { \\bm{z}}(t_0+k\\tau)$ ] is the sample value at the discrete time @xmath40 , and @xmath41 , @xmath42   \\mapsto { \\bm{z}}[k+1 ] $ ] is the transition operator , also named as transition mapping or matrix , from @xmath43-th step to @xmath44-th step such that @xmath45 equivalently , we have @xmath46 in which @xmath47 is the symplectic transform group and @xmath48 is the general linear transform group @xcite .",
    "usually , @xmath49 is specified by numerical schemes adopted .    for the general nonlinear and nonseparable hamiltonian system , a useful symplectic difference scheme , i.e. ,",
    "the _ centered euler implicit scheme _ of the second order ( ceis-2 ) @xcite , described by @xmath50 -{\\bm{p}}[k]}{\\tau }   = -   h_{{\\bm{q}}}(\\bar{{\\bm{z}}}_k ) , \\quad \\frac{{\\bm{q}}[k+1 ] - { \\bm{q}}[k]}{\\tau } =    h_{{\\bm{p}}}(\\bar{{\\bm{z}}}_k ) , \\end{split}\\ ] ] in which the midpoint @xmath51 + { \\bm{z}}[k]}{2}\\ ] ] can be used to determine the transition matrix @xmath49 .",
    "let @xmath52 where @xmath53 is the hessel matrix at the midpoint @xmath54 , and @xmath55 is the cayley transform .",
    "then for small @xmath38 such that @xmath56 is nonsingular , the @xmath49 will be @xcite @xmath57\\cdot { \\left [ { \\bm{i } } - \\frac{\\tau}{2}{\\bm{b}}\\right]^{-1 } }           = { \\left [ { \\bm{i } } - \\frac{\\tau}{2}{\\bm{b}}\\right]^{-1}}\\left [ { \\bm{i } } + \\frac{\\tau}{2}{\\bm{b}}\\right ] .",
    "\\end{split}\\ ] ] note that although eq.([eq - gt ] ) is an approximate result in the sense of approximate conservation @xcite for the general nonlinear hamiltonian system ( linear hamiltonian system requires that the hessel matrix @xmath58 is symmetric ) , it could be a precise solution for some special cases .",
    "when the matrix @xmath11 in eq.([eq - qkde ] ) is time - invariant , or equivalently the parameters @xmath59 and @xmath60 are constants , we can model it with the autonomous hamilton system . obviously , for @xmath61 , let @xmath62}^\\textsf{t } } = { { [ e_0 , e_1]}^\\textsf{t}}$ ] , @xmath63}^\\textsf{t } } = { { [ e_2 , e_3]}^\\textsf{t}}$ ] , @xmath64}^\\textsf{t}}\\equiv { \\bm{z}}$ ] , we have @xmath65 with the help of eq.([eq - qkde ] ) and eq.([eq - a ] ) .",
    "we remark here that the symbols @xmath27 and @xmath5 are equivalent since the vector @xmath27 consists of @xmath66 . thus @xmath5 and @xmath27 can be used alternatively if necessary . from eq.([eq - q2hs ] ) we can find that @xmath67 .",
    "therefore @xmath68 according to eq.([eq - b ] ) .",
    "note that @xmath69 , so the hessel matrix @xmath70 is not symmetric , which means that the hamiltonian system here is _ nonlinear _ by definition @xcite .",
    "obviously , the a - qkde is an autonomous hamiltonian system and the symplectic algorithm can be adopted to find its numerical solution . in the following , we will prove a lemma and an interesting euler s formula for constructing the symplectic difference scheme for a - qkde .",
    "[ lem-1 ] suppose matrix @xmath71 is skew - symmetric , i.e. , @xmath72 and there exists a positive constant @xmath73 such that @xmath74 .",
    "let @xmath75 be the caylay transformation and @xmath76 , then for any @xmath77 the euler formula @xmath78 = \\cos \\theta(x , \\gamma ) { \\bm{i } } + \\sin \\theta(x , \\gamma ) \\hat{{\\bm{m } } } , \\quad \\hat{{\\bm{m}}}^2 = -{\\bm{i } } \\end{split}\\ ] ] holds , in which @xmath79 and @xmath80 .",
    "furthermore , @xmath81 is an orthogonal matrix .",
    "proof : it is trivial that @xmath82 and @xmath83 . for any @xmath77 , we find that @xmath84 . in consequence @xmath85 .",
    "hence the caylay transformation @xmath81 can be simplified as following @xmath86   \\end{split}\\ ] ] where @xmath80 .",
    "put @xmath87 , then by the trigonometric identity and @xmath88 we immediately have @xmath89   & = \\cos \\theta(x,\\gamma ) { \\bm{i } } + \\sin \\theta(x,\\gamma ) \\hat{{\\bm{m}}}. \\end{split}\\ ] ] moreover , @xmath90}^\\textsf{t}}\\cdot \\phi(x{\\bm{m } } ) & = { { [ \\cos \\theta(x,\\gamma ) { \\bm{i } } + \\sin \\theta(x,\\gamma ) \\hat{{\\bm{m}}}]}^\\textsf{t}}[\\cos \\theta(x,\\gamma ) { \\bm{i } } + \\sin \\theta(x,\\gamma ) \\hat{{\\bm{m } } } ] \\\\ & = \\cos^2 \\theta(x,\\gamma ) { \\bm{i } } - \\sin^2 \\theta(x,\\gamma ) \\hat{{\\bm{m}}}^2 = { \\bm{i}}.\\end{aligned}\\ ] ] similarly , we can obtain @xmath91}^\\textsf{t } } = { \\bm{i}}$ ] .",
    "hence @xmath81 is orthogonal by definition .",
    "( * euler s formula * ) for any time step @xmath38 and time - invariant vector @xmath15 , the transition mapping @xmath92 for the a - qkde can be represented by @xmath93 = \\cos\\theta({\\bm{\\omega } } , \\tau )   \\cdot { \\bm{i } } + \\sin \\theta({\\bm{\\omega}},\\tau ) \\cdot \\hat{{\\bm{a } } } , \\end{split}\\ ] ] in which @xmath94 , @xmath95 , @xmath96 and @xmath97 .",
    "proof : with the help of eq.([eq - gt ] ) and eg.([eq - bq ] ) , the transition mapping will be @xmath98 .",
    "let @xmath99 , then @xmath100 .",
    "thus the theorem follows from lemma [ lem-1 ] directly .    for any @xmath101 and @xmath102",
    ", the transition mapping @xmath92 is an orthogonal transformation and an invertible symplectic transformation with first - order precision , i.e. , @xmath103}^\\textsf{t } } { \\bm{j } } { \\bm{g}}_\\tau^{{\\mathbbm{q } } }   = { \\bm{j } } + \\mathcal{o}(\\tau ) , \\quad { [ { \\bm{g}}_\\tau^{{\\mathbbm{q}}}]^{-1 } } = { \\bm{g}}_{-\\tau}^{{\\mathbbm{q } } } = { { [ { \\bm{g}}_\\tau^{{\\mathbbm{q}}}]}^\\textsf{t}}.\\end{aligned}\\ ] ]    proof : for a constant vector @xmath15 , we can find the function @xmath104 is an odd function of time step @xmath38 . by utilizing @xmath105 and @xmath106 , we immediately obtain @xmath107}^\\textsf{t } } & = { { [ \\cos \\theta({\\bm{\\omega}},\\tau){\\bm{i } } + \\sin \\theta({\\bm{\\omega}},\\tau)\\hat{{\\bm{a}}}]}^\\textsf{t}}\\\\ & = \\cos \\theta({\\bm{\\omega}},\\tau){\\bm{i } } -\\sin \\theta({\\bm{\\omega}},\\tau)\\hat{{\\bm{a } } } = \\cos ( -\\theta({\\bm{\\omega}},\\tau)){\\bm{i } } + \\sin ( -\\theta({\\bm{\\omega}},\\tau))\\hat{{\\bm{a}}}\\\\ & = \\cos \\theta({\\bm{\\omega}},-\\tau)){\\bm{i } } + \\sin \\theta({\\bm{\\omega}},-\\tau)\\hat{{\\bm{a } } } = { \\bm{g}}_{-\\tau}^{{\\mathbbm{q}}},\\end{aligned}\\ ] ] which implies that the transition mapping is invertible .",
    "moreover , @xmath108 is orthogonal by lemma [ lem-1 ] . in consequence ,",
    "@xmath109}^\\textsf{t } } = { \\bm{g}}_{-\\tau}^{{\\mathbbm{q } } } = { \\left({\\bm{g}}_{\\tau}^{{\\mathbbm{q}}}\\right)^{-1}}$ ] .",
    "furthermore , simple algebraic operation implies that @xmath110 because @xmath111 and @xmath112 , where @xmath113 .",
    "therefore , @xmath107}^\\textsf{t } } { \\bm{j } } [ { \\bm{g}}_\\tau^{{\\mathbbm{q } } } ] = { \\bm{j } } + ( { \\bm{j } } + \\hat{q}\\hat{{\\bm{a } } } ) \\cdot(-2\\sin^2\\theta { \\bm{i } } + 2\\sin\\theta \\cos \\theta \\hat{{\\bm{a}}}).\\\\end{aligned}\\ ] ] since both @xmath114 and @xmath115 are independent with @xmath38 , @xmath116 , @xmath117 , we can deduce that @xmath118}^\\textsf{t } } { \\bm{j } } [ { \\bm{g}}_\\tau^{{\\mathbbm{q } } } ] = { \\bm{j } } + \\mathcal{o}(\\tau)$ ] .",
    "hence @xmath92 is a symplectic matrix with first - order precision by definition@xcite .",
    "we remark that the nonlinearity of the qkde , or equivalently the non - symmetric property of the hessel matrix @xmath119 , brings the non - commutativity of @xmath35 and @xmath115 , i.e. , @xmath120 , _ which lowers the precision of the euler implicit midpoint formula from the second order to the first order_.      fortunately , the analytic solution ( as ) for a - qkde can be found without difficulty .",
    "in fact for any @xmath121 $ ] where @xmath2 and @xmath122 denote the initial and final time respectively , we have @xmath123.\\ ] ] let @xmath124 and @xmath125 , then @xmath126 show that @xmath127 thus for @xmath128 , the as to the transition mapping for the a - qkde is @xmath129 at the same time , for sufficiently small @xmath38 in eq.([eq - gtqexp ] ) we have @xmath130 for sufficiently small @xmath131 since @xmath132 let @xmath133 , then when we have @xmath134 for @xmath135 and @xmath136 for @xmath137 .",
    "therefore , the @xmath138 can be approximated by @xmath139 with an acceptable precision when time step @xmath140 .",
    "the sag for a - qkde is given in algorithm [ sp - a - qkde ] by the explicit expression @xmath141 obtained .",
    "[ sp - a - qkde ]    the time - invariant vector @xmath101 , time step @xmath38 such that @xmath142 and the initial quaternion @xmath143}^\\textsf{t}}$ ] at initial time @xmath2 .",
    "numerical solution to the a - qkde @xmath144 for @xmath145 with first - order symplectic difference scheme .",
    "set matrix @xmath11 with vector @xmath10}^\\textsf{t}}$ ] according to eq.([eq - a ] ) .",
    "set parameter @xmath146 with @xmath15 and @xmath38 , viz .",
    "@xmath147 . compute the transition mapping : @xmath148 $ ] . set the initial condition",
    "@xmath149 = { \\mathbbm{q}}(t_0)= { \\mathbbm{q}}_0 $ ] iterate : @xmath150 = { \\bm{g}}^{{\\mathbbm{q}}}_\\tau { \\mathbbm{q}}[k ] , \\quad k = 0 , 1 , 2 , \\cdots $ ]",
    "for the time - varying vector @xmath151 , eq.([eq - qkde ] ) implies @xmath152 , where @xmath153 .",
    "hence the na - qkde is a non - autonomous hamiltonian system essentially and the corresponding symplectic geometric algorithm can be obtained via the concept of extended phase space @xcite ( see chapter 5 , section 5.8 ) .",
    "let @xmath154 , where @xmath155 is the negative of the total energy .",
    "let @xmath156}^\\textsf{t } } = { { [ { { { \\bm{p}}}^\\textsf{t } } , h , { { { \\bm{q}}}^\\textsf{t } } , t]}^\\textsf{t}}\\in { \\mathbb{r}^{{(2n+2)}\\times { 1}}}$ ] , @xmath157 , then we have _ the time - centered euler implicit scheme of the fourth order _ ( t - ceis-4 ) @xcite , @xmath158 -{\\bm{z}}[k]}{\\tau }   = { \\bm{j}}^{-1}h_{{\\bm{z}}}(\\bar{{\\bm{z}}}_k ) - \\frac{\\tau^2}{24}{\\bm{j}}^{-1}\\nabla_{{\\bm{z}}}\\left\\{{{[h_{{\\bm{z}}}(\\bar{{\\bm{z}}}_k)]}^\\textsf{t } } { \\bm{j}}^{-1}h_{{\\bm{zz}}}(\\bar{{\\bm{z}}}_k){\\bm{j}}^{-1}h_{{\\bm{z}}}(\\bar{{\\bm{z}}}_k)\\right\\}.\\ ] ] note that in our problem we have no interest in the concrete results for @xmath155 .",
    "eq.([eq - cies2 ] ) shows that for the time - varying problems , @xmath159 is replaced by @xmath160 where @xmath161 may be @xmath162 or @xmath163 . in order to guarantee the duality of the phase space ,",
    "@xmath27 is rewritten as @xmath164}^\\textsf{t}}$ ] . the symplectic scheme for the na - qkde as eq.([eq - cies2 ] )",
    "can be simplified as @xmath165 -{\\bm{z}}[k]}{\\tau }   = \\frac{1}{2}{\\bm{a}}_k\\bar{{\\bm{z}}}_k - \\frac{\\tau^2\\omega_k{\\left\\lvert { \\bm{\\omega}}_k \\right\\rvert}^2}{96}{\\bm{j}}\\bar{{\\bm{z}}}_k,\\ ] ] where @xmath166 + \\tau/2 $ ] , @xmath167 , @xmath168 and @xmath169 by taking the similar procedure as we do in finding the transition mapping for symplectic difference scheme of the a - qkde , we can obtain @xmath170^{-1}}\\left [ { \\bm{i } } + \\frac{\\tau}{2}{\\bm{b}}_k\\right]\\ ] ] where @xmath171 is a skew - symmetric matrix such that @xmath172 according to lemma.[lem-1 ] , there exists a series of @xmath173 which satisfy the following identity @xmath174    for the na - qkde  @xmath175{\\mathbbm{q}}$ ] , let @xmath176 , @xmath177 , @xmath178 , @xmath179 , then the transition mapping @xmath180 \\mapsto { \\bm{z}}[k+1 ] , k = 0 , 1 , 2 , \\cdots $ ] can be given by @xmath181 = \\cos \\theta\\left({\\bm{\\omega}}_k,\\tau\\right )   { \\bm{i } }    + \\sin \\theta\\left({\\bm{\\omega}}_k,\\tau\\right )   \\hat{{\\bm{b}}}({\\bm{\\omega}}_k ) , \\end{split}\\ ] ] where @xmath182 such that @xmath183}^\\textsf{t}}\\cdot { \\bm{j}}\\cdot [ { \\bm{g}}^{{\\mathbbm{q}}}_\\tau(k+1|k ) ] = { \\bm{j } } + \\mathcal{o}(\\tau^2).\\ ] ]    due to the nonlinearity of the qkde , _ the precision of t - ceis-4 is reduced from the fourth order to the second order_. in addition , since @xmath184 is time - dependent and @xmath185-\\tau/2 ) \\neq { \\bm{\\omega}}(t[k]+\\tau/2)$ ] for positive @xmath38 in general , we can deduce that @xmath186^{-1}}$ ] although @xmath187 is also a symplectic and orthogonal transformation .",
    "the sag for na - qkde is presented in algorithm [ sp - na - qkde ] .",
    "[ sp - na - qkde ]    the time - varying vector @xmath188band the initial quaternion @xmath143}^\\textsf{t}}$ ] at initial time @xmath2 .",
    "numerical solution to the na - qkde @xmath189 for @xmath145 with second - order symplectic difference scheme . set the initial condition @xmath149 = { \\mathbbm{q}}(t_0)= { \\mathbbm{q}}_0 $ ] . set @xmath190 . set matrix @xmath191 with vector @xmath192}^\\textsf{t}}$ ]",
    "according to eq.([eq - a ] ) and @xmath193 by eq.([eq : t - cies-4-omega ] ) .",
    "calculate the norm of @xmath194 :   @xmath195 .",
    "set parameter @xmath196 and @xmath197 with @xmath15 and @xmath38 , viz .",
    "+ @xmath198 , @xmath199 .",
    "set matrix @xmath171 with @xmath194 and @xmath38 according to eq.([eq : na - qkde - b ] ) .",
    "compute the transition mapping : @xmath200 = \\frac{1}{1+\\alpha_k}\\left [ ( 1-\\alpha_k){\\bm{i } } + \\tau{\\bm{b}}_k\\right]$ ] .",
    "iterate : @xmath150 = { \\bm{g}}^{{\\mathbbm{q}}}_\\tau[k ] { \\mathbbm{q}}[k ] , \\quad k = 0 , 1 , 2 , \\cdots $ ]    we remark here that @xmath201+\\tau/2)$ ] relates the fractional interval sampling , which will increase the complexity of the hardware implementation .",
    "however , if the sampling rate @xmath202 is large enough , the @xmath184 will vary slowly in each short time interval @xmath203 , t[k+1]]$ ] and the linear interpolation can be considered here .",
    "this is to say that for @xmath204,t[k+1]]$ ] @xmath205 ) + \\frac{{\\bm{\\omega}}(t[k+1 ] ) - { \\bm{\\omega}}(t[k])}{\\tau } t.\\ ] ] hence @xmath206 ) + \\frac{{\\bm{\\omega}}(t[k+1 ] ) - { \\bm{\\omega}}(t[k])}{\\tau}\\cdot \\bar{t}_k\\ ] ] with acceptable precision . in this way",
    "the fractional interval sampling can be avoided and the complexity of the hardware implementation can be reduced .",
    "although the principles and algorithms have been given in the previous sections , it is still necessary to verify them with concrete examples by numerical simulation .",
    "however , each quaternion @xmath5 has four components , i.e. , @xmath207 and @xmath208 , which implies that it is not convenient for visualization unless we project the 4-dimensional vector representation of quaternions into a subspace .",
    "since all of the transition mappings @xmath209 are orthogonal , then the norm of the quaternions should be preserved as @xmath210 .",
    "thus the norm can be used as a necessary condition so as to validate the correctness of the algorithms proposed . on the other hand",
    ", we can construct some special cases in which the analytic solutions can be obtained easily and compared with the numerical solutions .    for a - qkde",
    ", the @xmath15 is time - invariant and @xmath211 is a constant .",
    "since the eigen - values of matrix @xmath212 are @xmath213 , then the general solution of the a - qkde must be @xmath214 in which the amplitudes @xmath215 and phases @xmath216 can be determined by the initial condition .    for na - qkde ,",
    "if we choose the functions @xmath217 and @xmath218 such that for sufficient large @xmath163 , @xmath219 and @xmath220 , then eq.([eq - qkde ] ) shows that there exists some positive @xmath221 and for @xmath222 such that @xmath223 since @xmath224}^\\textsf{t}}$ ] .",
    "hence @xmath225 for sufficiently large @xmath163 .",
    "if @xmath226 asymptotically ( where @xmath227 is a constant ) , then we have @xmath228 where @xmath229 .",
    "in other words , asymptotically , each @xmath230 can be described by eq.([eq - ei - cosine ] ) .    without loss of generality",
    ", we can set the initial condition as @xmath231}^\\textsf{t}}$ ] for the verification thus can just consider @xmath232 and @xmath233 .",
    "let @xmath234 , @xmath166 + \\tau/2 $ ] , @xmath235 , @xmath236 , @xmath237 and @xmath238 , then by lemma [ lem-1 ] yields @xmath239 where @xmath240 . obviously , @xmath241 is a symplectic matrix since @xmath242}^\\textsf{t}}\\cdot { \\bm{j}}_2 \\cdot [ { \\bm{g}}^{e_0e_1}_\\tau(k+1|k ) ] = { \\bm{j}}_2 . \\end{split}\\ ] ]      in order to evaluate the accuracy and stability of our proposed algorithms , we carried out some numerical simulations of time - variant and time - varying systems .",
    "all experiments in this paper were implemented in matlab and ran on a desktop pc equipped with intel^^ core^`tm`^ i7 - 3770 cpu @ 3.4 ghz and 4 gb ram .",
    "[ fig-1-omega ] demonstrates the asymptotic performance of sag for qkde .",
    "we find that for different @xmath184 , the norm @xmath243 is kept and there are no accumulated errors . in fig.[fig-1-case-1 ] , each @xmath230 is a cosine function since @xmath244 is a constant according to eq.([eq - ei - cosine ] ) . in fig.[fig-1-case-2 ] , @xmath232 and @xmath233 behave like cosine curves asymptotically because @xmath245 asymptotically .",
    "moreover , it is trivial that @xmath246 since @xmath247 . in fig.[fig-1-case-3 ] , each @xmath230 varies periodically when @xmath248 by eq.([eq-38 ] ) .",
    "although the each @xmath249 varies independently , the norm @xmath250 .",
    "fig.[fig-2-diffscheme ] shows the precision and stability with the time step .",
    "we find that the four - stage explicit runge - kutta ( rk4 ) method works well only when the time step is small in fig.[fig - sga - rk4-eub-2 ] and the time duration is relatively short ( 15 seconds ) in fig.[fig - sga - rk4-eub-1 ] , and the euler - backward ( eub ) method always leads to serious accumative errors .",
    "however , the sga works well and there is no computational damp since the @xmath251 remains constant .",
    "fig.[fig - na - qkde - longtime1 ] illustrates the performace of sag for na - qkde .",
    "we set parameters @xmath252 , initial state @xmath149=[\\cos ( \\pi/160),0,\\sin(\\pi/160),0]$ ] and @xmath253}^\\textsf{t}}\\ ] ] such that the as   @xmath254}^\\textsf{t } }   = { { \\left[\\cos(\\beta/2 ) , 0 , \\sin ( \\beta/2 ) \\cos(\\omega_0 t ) , \\sin(\\beta/2)\\sin(\\omega_0 t)\\right]}^\\textsf{t}}.\\ ] ] we have computed the absolute differences between the numerical solutions and the analytical solutions with algorithm [ sp - na - qkde ] for every component of quaternions @xmath255 @xmath256 , as it is shown in fig.[fig - na - qkde - longtime1 ] , where the time duration is 1000 s ( @xmath257 = [ 0 , 1000]$ ] ) .",
    "we find that all these errors of numerical solutions are stably held every small during 1000 s , and the magnitude of error of the quaternion @xmath6 is @xmath258 .",
    "the accuracy and stability of sga are proved well for na - qkde on long time interval .",
    "fig.[fig - na - qkde - longtime2 ] represents the low time complexity of sga for na - qkde in comparison with the gauss - legendre ( g - l ) method .",
    "g - l method is an accurate and implicit method for the differential equations of time - varying system , however , it needs a lot of computing time to solve the equations .",
    "we solved the eq.([eq - qkde ] ) with the same parameters @xmath259 as fig.[fig - na - qkde - longtime1 ] during 500 s , and calculated the maximum error and computing time of the two methods with a series of time step @xmath38 .",
    "the numerical results of quaternion @xmath260 and @xmath261 were plotted in fig.[fig - na - qkde - longtime2 ] .",
    "although the precision of our proposed algorithm is worse than g - l in fig.[fig - na - qkde - longtime2a ] , we point out the time complexity of sga is far lower than g - l and the computing time of sga is almost less than 1 s for most cases .",
    "low time complexity is essential for the real - time system .",
    "in addition , we find that the maximum error of @xmath6 calculated by sga is less than by g - l when the computing time is limited within 7 s in fig.[fig - na - qkde - longtime2b ] , from which we can see that our algorithm performs more competitive in the case with the limitation of computing time .",
    "in this paper we proposed the key idea of solving the qkde with symplectic method : each qkde can be described by a corresponding hamiltonian system and the ceis-2 or t - ceis-4 can be used to design sga for qkde . the euler s formula for the symplectic transition mapping plays a key role in designing sag for a - qkde with first - order precision and na - qkde with second - order precision , which simplifies the original algorithmic structures and guarantees the low time complexity of computation .",
    "the correctness and efficiencies of the sag presented are verified and demonstrated by comparison with as and ns . examples show that our proposed algorithms perform very well since the norms of the quaternions can be preserved and the errors accumulated can be eliminated .",
    "as part of future work , we will investigate the high - order precision sga @xcite to qkde , the robustness of the sga to qkde perturbed by noise , the applications of sga to more general linear time - varying system and its combination with precise - integration method @xcite .",
    "additionally , we will also design second - order precision symplectic - precise integrator to solve the linear quadratic regulator problem and the matrix ricatti equation since they play an important role in automation .",
    "the financial support of the fundamental research funds for the central universities of china under grant number zxh2012h005 is gratefully acknowledged .",
    "this work was also supported in part by the national natural science foundation of china ( nnfsc ) under grant numbers nnsfc 61201085 , nnsfc 51205397 and nnsfc 51402356 .",
    "the first author would like to thank prof .",
    "daniel dalehaye of ecole nationale de laviation civile ( enac ) because part of this work was carried out while this author was visiting enac .",
    "we are indebted to prof .",
    "yifa tang whose lectures on symplectic geometric algorithms for hamiltonian system in chinese academy of sciences attracted the first author and stimulated this work in some sense .",
    "the authors thanks go to ms .",
    "fei liu , mr .",
    "jingtang hao and ms .",
    "yajuan zhang for correcting some errors in an earlier version of this paper .",
    "k.  feng and m.  qin . .",
    "springer - verlag , zhejiang science and technology publishing house , berlin heidelberg and hangzhou , second edition , 2010 .",
    "the first edition is written in chinese and published by zhejiang science and technology publishing house in 2003 ."
  ],
  "abstract_text": [
    "<S> solving quaternion kinematical differential equations is one of the most significant problems in the automation , navigation , aerospace and aeronautics literatures . </S>",
    "<S> most existing approaches for this problem neither preserve the norm of quaternions nor avoid errors accumulated in the sense of long term time . </S>",
    "<S> we present symplectic geometric algorithms to deal with the quaternion kinematical differential equation by modeling its time - invariant and time - varying versions with hamiltonian systems by adopting a three - step strategy . </S>",
    "<S> firstly , a generalized euler s formula for the autonomous quaternion kinematical differential equation are proved and used to construct symplectic single - step transition operators via the centered implicit euler scheme for autonomous hamiltonian system . </S>",
    "<S> secondly , the symplecitiy , orthogonality and invertibility of the symplectic transition operators are proved rigorously . finally , the main results obtained are generalized to design symplectic geometric algorithm for the time - varying quaternion kinematical differential equation which is a non - autonomous and nonlinear hamiltonian system essentially . </S>",
    "<S> our novel algorithms have simple algorithmic structures and low time complexity of computation , which are easy to be implemented with real - time techniques . </S>",
    "<S> the correctness and efficiencies of the proposed algorithms are verified and validated via numerical simulations .    </S>",
    "<S> * keywords * : quaternion kinematical differential equation ; symplectic geometric algorithm ; hamiltonian system ; non - autonomous system </S>"
  ]
}