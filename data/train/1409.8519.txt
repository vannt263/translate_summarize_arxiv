{
  "article_text": [
    "[ sec : intro ]    in the context of strongly magnetized plasma simulations , the motion of particles is confined around the magnetic field lines ; the frequency of this cyclotron motion is faster than the frequencies of interest .",
    "therefore , the physical system can be reduced from the @xmath0 vlasov - maxwell system to a four or five dimensional model by averaging over the gyroradius of charged particles ( see for a review @xcite ) . in this paper",
    "we focus on 4d drift - kinetic model , where the movement of the plasma in the plane perpendicular to the magnetic field can be governed by the guiding - center model .",
    "this reduced model could help us to investigate plasma turbulence problems with an acceptable computational time .",
    "more especially , using the 2d guiding - center model , we can focus directly on the difficulties of treatment of boundary conditions on arbitrary computational domain .",
    "moreover , these reduced models have the conservative properties , which can be used as criterion to evaluate the good performance of numerical methods .",
    "to develop accurate and stable numerical techniques for plasma turbulence ( 4d drift kinetic , 5d gyrokinetic and 6d kinetic models ) is one of our objectives . in @xcite several numerical solvers have been developed using an eulerian formulation for gyro - kinetic models .",
    "however , spurious oscillations often appear in the nonlinear phase when small structures occur and it is difficult to distinguish physical and numerical oscillations . moreover ,",
    "for these models semi - lagrangian methods are no more conservative , hence the long time behavior of the numerical solution may become unsuitable .",
    "at contrast , a class of numerical methods based on the hermite interpolation @xcite , together with a weighted essentially non - oscillatory ( weno ) reconstruction can be applied either to semi - lagrangian or to finite difference methods @xcite .",
    "on the one hand , the semi - lagrangian methods are very efficient and fast but do not conserve mass in an arbitrary grid . on the other hand ,",
    "the finite difference methods are mass conservative and more stable for long term simulations but have a restrictive cfl constraint .",
    "we thus propose a mixed method to carry forward the advantages of each method , _",
    "i.e. _ the semi - lagrangian method in linear phase where the solution is relatively smooth , the finite difference method during the nonlinear phase where a lot of small structures appear .",
    "we will apply the mixed method to the 4d drift - kinetic model to verify its efficiency .",
    "the numerical resolution of 4d drift - kinetic model in a cylinder has been already performed via polar coordinates  @xcite .",
    "however , polar coordinates are not always suitable since artificial singular points appear in the computational domain coming from the change of variable . moreover , for more complicated geometry , it is not straightforward to perform the appropriate change of variables . from these considerations , we focus here on the discretization of transport models on a cartesian mesh and develop a suitable technique as in  @xcite to treat boundary conditions . this method is based on the inverse lax - wendroff method @xcite . on the other hand , to compute the electric potential from the poisson equation , we apply an extrapolation technique @xcite . to test the numerical algorithm ,",
    "the guiding center model will be solved on a @xmath1-shape domain  @xcite .",
    "we will first compute a steady state solution by solving numerically a nonlinear poisson equation and then investigate its stability properties .",
    "the paper is organized as follows : in section  [ sec : model ] , we present the derivation of the 4d drift - kinetic and the 2d guiding - center models , and their conservative properties . then in section [",
    "sec : schemes ] , we recall the hermite weno reconstructions developed in  @xcite for solving the vlasov equations , and the treatment of boundary conditions corresponding to the poisson equation . in section [ sec : num ] , we numerically compute a steady state solution for the 2d guiding - center model in a @xmath1-shape domain .",
    "then , we study its stability properties by performing numerical simulations with a perturbed steady state as initial data .",
    "finally , we numerically solve the 4d drift - kinetic model with the mixed methods , and present the numerical results of the conservative properties of the 4d drift - kinetic model and the evolution of the distribution function of density .",
    "the vlasov equation for the distribution function @xmath2 in standard form in standard notation is @xmath3 where @xmath4 is the time variable , @xmath5 is the space variable , @xmath6 is the velocity variable , @xmath7 is the particle mass , @xmath8 is its charge , @xmath9 is the electric field and @xmath10 is the magnetic field .",
    "we assume the electric field is computed by @xmath11 , where @xmath12 is electric potential whereas the magnetic field is uniform @xmath13 , where @xmath14 stands for the unit vector in the toroidal direction .",
    "moreover , we assume that @xmath2 is vanishing at infinity of velocity field and periodic boundary condition is taken in @xmath15 direction .    to derive the drift kinetic model",
    ", we start to perform a change of variable according to the drift direction @xmath16 ; that is @xmath17 with @xmath18 next , we decompose @xmath9 into components along @xmath10 and perpendicular to @xmath10 : @xmath19 substituting this expression in  , it yields @xmath20 then we introduce a new distribution function @xmath21 , such that @xmath22 for which we get that it is solution to @xmath23 finally , we integrate the previous equation in velocity field @xmath24 @xmath25 where @xmath26 . by passing formally to the limit @xmath27",
    ", we obtain the drift - kinetic model @xmath28    on the other hand , the self - consistent potential @xmath12 is solution to the quasi - neutrality equation  @xcite @xmath29 where @xmath30 is the ion cyclotron frequency , and @xmath31 and @xmath32 are the electron temperature and density profiles respectively which only depend on @xmath33 .",
    "the ion density profile is given by @xmath34 and @xmath35 represents the average on the magnetic field lines , that is , @xmath36 with @xmath37 the length in the @xmath15 variable .",
    "dropping the @xmath38 over the various quantities and replacing @xmath39 by @xmath40 , the non - dimensional form of the drift - kinetic model can be written as    @xmath41   \\displaystyle\\mathbf{u}=\\frac{\\mathbf{e}\\times\\mathbf{b}}{b^2},\\quad   \\mathbf{e}=-\\nabla\\phi , \\\\[3 mm ] \\displaystyle -\\nabla_\\bot\\cdot\\left(\\frac{\\rho _ 0(\\mathbf{x}_\\bot)}{b}\\nabla_\\bot\\phi\\right)+\\frac{\\rho_0(\\mathbf{x}_\\bot)}{t_e(\\mathbf{x}_\\bot)}(\\phi-\\bar{\\phi})=\\rho-\\rho_0 .",
    "\\end{array}\\right.\\ ] ]    the following proposition shows some properties of the drift - kinetic model when we ignore the effect of boundary conditions :    [ prop : driftkinetic ] let us consider @xmath42 or the torus .",
    "then the drift - kinetic model ( [ dk4d ] ) verifies the following properties :    1 .",
    "if @xmath2 is smooth , we have the maximum principle @xmath43 2 .",
    "@xmath44 norm conservation , for @xmath45 @xmath46 3 .",
    "kinetic entropy conservation @xmath47 4 .   energy conservation @xmath48    for practical applications , this model has to be supplemented with suitable boundary conditions when considering a domain of the form @xmath49 with @xmath1 a two dimensional domain .",
    "we assume that the electric potential is vanishing at the boundary @xmath50 @xmath51 ,   \\label{eq : dk_bc1}\\ ] ] and the distribution function is given by @xmath52 , \\,{\\rm with } \\ , \\mathbf{u}(\\mathbf{x})\\cdot   \\mathbf{n}_\\mathbf{x } \\geq 0 ,   \\label{eq : dk_bc2}\\ ] ] where @xmath53 is a stationary solution to the drift - kinetic model ( [ dk4d ] ) .",
    "furthermore , periodic boundary conditions are assumed for the potential and the distribution function in the @xmath15 direction @xmath54    finally , we can derive the guiding centre model from ( [ dk4d ] ) by integrating the equation with respect to @xmath55 .",
    "we get that the reduced density @xmath56 is solution to the guiding centre system of equations @xmath57",
    "\\displaystyle\\mathbf{u}=\\frac{\\mathbf{e}\\times\\mathbf{b}}{b^2 } , \\quad \\mathbf{e}=-\\nabla\\phi , \\\\[3 mm ] \\displaystyle -\\nabla_\\bot\\cdot\\left(\\frac{\\rho _ 0(\\mathbf{x}_\\bot)}{b}\\nabla_\\bot\\phi\\right)\\,=\\,\\bar\\rho-\\rho_0 .",
    "\\end{array}\\right.\\ ] ]    in this case , the solution @xmath58 satisfies the following properties    [ prop : cg2d ] let us consider the two dimensional domain @xmath59 or the torus . then the guiding centre model ( [ cg2d ] ) verifies the following properties :    1 .",
    "if @xmath60 is smooth , we have the maximum principle @xmath61 2 .",
    "@xmath44 norm conservation , for @xmath45 @xmath62 3 .",
    "energy conservation @xmath63    for practical applications , we assume that the electric potential is vanishing at the boundary @xmath50 @xmath64",
    "in this section we present the hybrid method based on the hermite weno reconstruction already proposed in @xcite . on the one hand",
    ", we apply a semi - lagrangian method for a general transport equation written in a non conservative form . on the other hand , we apply a finite difference method , which enforces the conservation of mass when the equation is written in the conservative form .",
    "these methods are coupled with the inverse lax - wendroff procedure to discretize accurately boundary conditions in an arbitrary @xmath65 geometry .",
    "finally in the subsection [ sec : poisson ] , we discretize the poisson equation for the electrical potential ( [ cg2d ] ) .",
    "we briefly remind the high order hermite interpolation coupled with a weight essentially non - oscillatory ( hweno ) reconstruction for semi - lagrangian methods .",
    "the semi - lagrangian method becomes a classical method for the numerical solution of the vlasov equation because of its high accuracy and its small dissipation  @xcite . for a given @xmath66 , the differential system @xmath67   \\mathbf{x}(s)= { \\mathbf{x } } ,   \\end{array }   \\right.\\ ] ]",
    "is associated to the transport equation @xmath68 we denote its solution by @xmath69 .",
    "the backward semi - lagrangian method is decomposed into two steps for computing the function @xmath70 at time @xmath71 from the function @xmath72 at time @xmath73 :    1 .",
    "for each mesh point @xmath74 of phase space , compute the backward characteristic @xmath75 , the value of the characteristic at time @xmath76 who is equal to @xmath74 at time @xmath71 .",
    "2 .   as the function @xmath2 of transport equation",
    "verifies @xmath77 we obtain the value of @xmath78 by computing @xmath79 by interpolation , since @xmath75 is not usually a mesh point .",
    "we apply a third order hermite interpolation coupled with a weighted essentially non - oscillatory procedure , such that it is accurate for smooth solutions and it removes spurious oscillations around discontinuities or high frequencies which can not be solved on a fixed mesh . consider a uniform mesh @xmath80 of the computational domain and assume that the values of the distribution function @xmath81 and its derivative @xmath82 are known at the grid points .",
    "we define two quadratic polynomials in the interval @xmath83 : @xmath84   \\displaystyle   h_r(x)\\,=\\,f_i+\\frac{f_{i+1}-f_i}{\\delta x}(x - x_i)+\\frac{\\delta x { f}'_{i+1}-(f_{i+1}-f_i)}{\\delta x^2}(x - x_i)(x - x_{i+1}).\\label{eq : hweno : pr } \\end{array}\\right.\\ ] ] the polynomial of degree 2 @xmath85 verifies @xmath86 while @xmath87 verifies @xmath88    the idea of weno reconstruction is now to use the cubic polynomial when function @xmath2 is smooth , otherwise , we use the less oscillatory polynomial of degree 2 between @xmath85 or @xmath87 .",
    "thus , let us define @xmath89 as follows @xmath90 where @xmath91 and @xmath92 are weno weights . to determine these weno weights",
    ", we follow the strategy given in  @xcite and first define smoothness indicators by integration of the first and second derivatives of @xmath93 and @xmath94 on the interval @xmath83 : @xmath95 then we set @xmath91 and @xmath92 as @xmath96 where @xmath97 where @xmath98 , @xmath99 and @xmath100 to avoid the denominator to be zero .",
    "observe that when the function @xmath2 is smooth , the difference between @xmath101 and @xmath102 becomes small and the weights @xmath103 and @xmath104 .",
    "when the smoothness indicator @xmath105 , @xmath106 blows - up , then the parameter @xmath107 and the weight @xmath108 goes to zero , which yields @xmath109 finally , let us mention that the following fourth - order centred finite difference formula is used to approximate the first derivative at the grid point @xmath110 @xmath111      when the velocity @xmath112 is not constant in ( [ eq : transport_vlasov ] ) , the semi - lagrangian method is not conservative even when @xmath113 , hence mass is no longer conserved and the long time behavior of the numerical solution may be wrong even for small time steps .",
    "therefore , high order conservative methods may be more appropriate even if they are restricted by a cfl condition .    in this section ,",
    "we extend hermite weno reconstruction for computing numerical flux of finite difference method .",
    "suppose that @xmath114 is approximation of @xmath115 .",
    "we look for @xmath116 such that the flux difference approximates the derivative @xmath117 to @xmath118-th order accuracy : @xmath119 to approximate the flux @xmath120 , we define a piecewise polynomial @xmath121 such that it is exactly known on a set of points @xmath122 , @xmath123 .",
    "@xmath124 thus , given the point values @xmath125 , we can compute @xmath126 by an interpolation method and therefore deduce the numerical flux by @xmath127    now to interpolate the function @xmath126 , we apply a high order hermite weno scheme and outline the procedure of reconstruction only for the fifth order accuracy case .",
    "the aim is to construct an approximation of the flux @xmath128 by the hermite polynomial of degree five together with a weno reconstruction from point values @xmath125 :    1 .",
    "we construct the hermite polynomial @xmath129 such that @xmath130 2 .",
    "we construct cubic reconstruction polynomials @xmath131 , @xmath132 , @xmath133 such that : @xmath134   h_c(x_{i+j+1/2 } ) = g_{i+j+1/2},\\ , j=-2,\\,-1,\\,0,\\,1 , & \\",
    ", \\\\[4 mm ]   h_r(x_{i+j+1/2 } ) = g_{i+j+1/2},\\ , j=-1,\\,0,\\,1 , & h'_r(x_{i+3/2 } ) =   g'_{i+3/2},\\\\[4 mm ]    \\end{array}\\right.\\ ] ] where @xmath135 is the sixth order centered approximation of first derivative @xmath136.\\ ] ] let us denote by @xmath137 , @xmath138 , @xmath139 , @xmath140 the first derivatives of @xmath131 , @xmath132 , @xmath133 , @xmath141 respectively . by evaluating @xmath137 , @xmath138 , @xmath139 , @xmath140 at @xmath142",
    ", we obtain @xmath143 and @xmath144   \\displaystyle    h_c(x_{i+1/2 } ) \\,=\\ , \\frac{-f_{i-1 } \\,+\\ , 5\\,f_i + 2\\,f_{i+1}}{6},\\\\[3 mm ]   \\displaystyle    h_r(x_{i+1/2 } ) \\,=\\ , \\frac { f_{i } \\,+\\ , 5\\,f_{i+1 }   \\,-\\ , 2\\,g'_{i+3/2}}{4}. \\end{array}\\right.\\ ] ] 3 .",
    "we evaluate the smoothness indicators @xmath101 , @xmath145 , @xmath102 , which measure the smoothness of @xmath137 , @xmath138 , @xmath139 on the cell @xmath146 $ ] @xmath147   & = & l_1 ^ 2 \\,\\,+\\,\\ , 3\\ , l_1\\,l_2 \\,\\,+\\,\\ , \\frac{75}{16 } \\,l_2 ^ 2 , \\quad \\textrm{with } l_1",
    "\\,=\\ , u_i - u_{i-1 } , \\quad l_2 \\,=\\ , -3u_{i-1 } + u_i + 2g'_{i-3/2 } ,      \\\\[3 mm ]   \\beta_c & = & \\int_{x_i}^{x_{i+1 } }   \\delta x",
    "+   \\delta x^3 ( h''_c(x))^2 dx\\\\[3 mm ]   & = & c_1 ^ 2 \\,\\,+\\,\\ , 2\\ , c_1\\,c_2 \\,\\,+\\,\\ , \\frac{25}{12 } \\,c_2 ^ 2 ,   \\quad \\textrm{with } c_1 \\,=\\ , u_i - u_{i-1 } , \\quad c_2 \\,=\\ , u_{i-1 } - 2u_i + u_{i+1},\\\\[3 mm ]   \\beta_r & = & \\int_{x_i}^{x_{i+1 } }   \\delta x ( h'_r(x))^2 +   \\delta x^3 ( h''_r(x))^2 dx\\\\[3 mm ]   & = & r_1 ^ 2 \\,\\,+\\,\\ , \\frac{39}{16 } \\,r_2 ^ 2 ,   \\quad \\textrm{with } r_1 \\,=\\ , u_{i+1 } - u_{i } , \\quad r_2 \\,=\\ , u_{i } - 3 u_{i+1 } + 2g'_{i+3/2}.\\end{aligned}\\ ] ] 4 .",
    "we compute the nonlinear weights based on the smoothness indicators @xmath148    \\displaystyle w_c = \\frac{\\alpha_c}{\\alpha_l + \\alpha_c + \\alpha_r } , &   \\displaystyle\\alpha_c = \\frac{c_c}{(\\varepsilon + \\beta_c)^2 } , \\\\[5 mm ]   \\displaystyle   w_r = \\frac{\\alpha_r}{\\alpha_l + \\alpha_c + \\alpha_r } , &   \\displaystyle\\alpha_r = \\frac{c_r}{(\\varepsilon + \\beta_r)^2 } ,   \\end{array}\\right.\\ ] ] where the coefficients @xmath149 , @xmath150 , @xmath151 are chosen to get fifth order accuracy for smooth solutions and the parameter @xmath100 avoids the blow - up of @xmath152 , @xmath153 .",
    "the flux @xmath154 is then computed as @xmath155    the reconstruction to @xmath156 is mirror symmetric with respect to @xmath157 of the above procedure .",
    "we use a classical five points finite difference approximation to discretize the poisson equation  - .",
    "so it remains to treat the dirichlet boundary conditions on @xmath50 .    to discretize the laplacian operator @xmath158 near the physical boundary",
    ", some points of the usual five points finite difference formula can be located outside of interior domain .",
    "for instance , figure  [ fig:2ddomain ] illustrates the discretization stencil for @xmath158 at the point @xmath159 .",
    "we notice that the point @xmath160 is located outside of interior domain .",
    "let us denote the approximation of @xmath12 at the point @xmath161 by @xmath162 .",
    "thus @xmath162 should be extrapolated from the interior domain .",
    "we extrapolate @xmath162 on the normal direction @xmath163 @xmath164 where @xmath165 is the cross point of the normal @xmath163 and the physical boundary @xmath1 .",
    "the points @xmath166 and @xmath167 are equal spacing on the normal @xmath163 , _",
    "i.e. _ @xmath168 , with @xmath169 , @xmath170 , @xmath171 are the space steps in the directions @xmath172 and @xmath173 respectively .",
    "moreover , @xmath174 , @xmath175 , @xmath176 are the extrapolation weights depending on the position of @xmath161 , @xmath165 , @xmath166 and @xmath167 . in",
    ", @xmath177 is given by the boundary condition  , whereas @xmath178 , @xmath179 should be determined by interpolation .",
    "spatially two - dimensional cartesian mesh .",
    "@xmath180 is interior point , @xmath181 is ghost point , @xmath182 is the point at the boundary , @xmath183 is the point for extrapolation , the dashed line is the boundary.,width=377 ]    for this , we first construct an interpolation stencil @xmath184 , composed of grid points of @xmath1 .",
    "for instance , in figure  [ fig:2ddomain ] , the inward normal @xmath163 intersects the grid lines @xmath185 , @xmath186 , @xmath187 at points @xmath188 , @xmath189 , @xmath190",
    ". then we choose the three nearest points of the cross point @xmath191 , in each line , _ i.e. _ marked by a large circle . from these nine points , we can build a lagrange polynomial @xmath192 .",
    "therefore , we evaluate the polynomial @xmath193 at @xmath166 and @xmath167 , _ i.e. _ @xmath194   { \\phi}(\\mathbf{x}_{2h})&=&\\sum_{\\ell=0}^8w_{2h,\\ell}{\\phi}(\\mathbf{x}_{\\ell}),\\end{aligned}\\ ] ] with @xmath195 .",
    "we thus have that @xmath162 is approximated from the interior domain .    however ,",
    "in some cases , we can not find a stencil of nine interior points .",
    "for instance , when the interior domain has small acute angle sharp , the normal @xmath163 can not have three cross points @xmath191 in interior domain , or we can not have three nearest points of the cross point @xmath191 , in each line . in this case",
    ", we alternatively use a first degree polynomial @xmath196 with a four points stencil or even a zero degree polynomial @xmath197 with an one point stencil .",
    "we can similarly construct the four points stencil or the one point stencil as above .",
    "in this section , we present numerical simulations .",
    "we first consider the 2d guiding - center model in a d - shaped domain . the steady state solution and perturbed solution",
    "are studied .",
    "then we perform the ion turbulence instability simulation with the 4d drift - kinetic model in a cylinder domain .",
    "we consider now the 2d guiding - center model in a d - shaped domain @xmath198 presented in section iv of  @xcite and depicted in figure  [ fig : dshape](a ) .",
    "the mapping @xmath199 from curvilinear coordinates @xmath200 to physical coordinates @xmath201 is given by    @xmath202\\ , \\cos[2\\pi\\xi_2 + \\arcsin(0.416)\\sin(2\\pi\\xi_2)],\\\\[3 mm ]      y\\ , = \\ , 1.66 [ 0.074(2\\xi_1 - 1 ) + 0.536]\\sin(2\\pi\\xi_2 ) ,    \\end{array}\\ ] ]    for @xmath203 , @xmath204 .    [ cols=\"^,^,^ \" , ]",
    "in this paper , we have presented an efficient algorithm for long term plasma simulations .",
    "we first derive the 4d drift - kinetic and the 2d guiding - center models , and present their conservative properties .",
    "the hermite weno reconstructions are applied for solving the vlasov equations , which was proved to be robust  @xcite in computational performance . moreover , to adapt the arbitrary computational domain , we discretize the models on cartesian meshes , and the special numerical methods for the boundary conditions , as the inverse lax - wendroff method for the vlasov equation  @xcite and the extrapolation method for the poisson equation  @xcite , are proposed .    next , we solve the guiding - center model on a d - shape domain .",
    "a steady state solution @xmath205 is found numerically .",
    "then we perturb the steady state density @xmath206 along the streamline , and use this perturbed density @xmath60 as the initial condition for the guiding - center model .",
    "we observe that the difference of density @xmath207 revolves , and the filaments appear for long term simulation .",
    "finally , we simulate the 4d drift - kinetic model with the mixed methods , _",
    "i.e. _ the semi - lagrangian method in linear phase and finite difference method during the nonlinear phase .",
    "numerical results show that the mixed method is efficient and accurate in linear phase and it is much stable during the nonlinear phase .",
    "moreover , it preserves well the conservative properties .",
    "we thus conclude that our mixed method is efficient for realistic and high dimensional plasma turbulence simulations .",
    "both authors are partially supported by the european research council erc starting grant 2009 , project 239983-_nusikimo _ and the inria project kaliffe .",
    "chang yang is also supported by national natural science foundation of china ( grant no .",
    "11401138 ) ."
  ],
  "abstract_text": [
    "<S> in this paper , we present an efficient algorithm for the long time behavior of plasma simulations . </S>",
    "<S> we will focus on 4d drift - kinetic model , where the plasma s motion occurs in the plane perpendicular to the magnetic field and can be governed by the 2d guiding - center model .    </S>",
    "<S> hermite weno reconstructions , already proposed in @xcite , are applied for solving the vlasov equation . here </S>",
    "<S> we consider an arbitrary computational domain with an appropriate numerical method for the treatment of boundary conditions .    </S>",
    "<S> then we apply this algorithm for plasma turbulence simulations . </S>",
    "<S> we first solve the 2d guiding - center model in a d - shape domain and investigate the numerical stability of the steady state . </S>",
    "<S> then , the 4d drift - kinetic model is studied with a mixed method , _ </S>",
    "<S> i.e. _ the semi - lagrangian method in linear phase and finite difference method during the nonlinear phase . </S>",
    "<S> numerical results show that the mixed method is efficient and accurate in linear phase and it is much stable during the nonlinear phase </S>",
    "<S> . moreover , in practice it has better conservation properties .    </S>",
    "<S> = 1    keywords . </S>",
    "<S> cartesian mesh ; semi - lagrangian method ; hermite weno reconstruction ; guiding - center ; drift - kinetic model .    </S>",
    "<S> 2000 mathematics subject classication . </S>",
    "<S> 65m08 , 65m25 , 78a35 . </S>"
  ]
}