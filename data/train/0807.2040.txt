{
  "article_text": [
    "in  @xcite , a very general model for sparse random graphs was introduced , corresponding to an inhomogeneous version of @xmath0 , and many properties of this model were determined , in particular , the critical point of the phase transition where the giant component emerges .",
    "part of the motivation was to unify many of the new random graph models introduced as approximations to real - world networks .",
    "indeed , the model of  @xcite includes many of these models as exact special cases , as well as the ` mean - field ' simplified versions of many of the more complicated models .",
    "( the original forms are frequently too complex for rigorous mathematical analysis , so such mean - field versions are often studied instead . ) unfortunately , there are many models with key features that are not captured by their mean - field versions , and hence not by the model of  @xcite .",
    "the main problem is that many real - world networks exhibit _ clustering _ : for example , while there are @xmath1 vertices and only @xmath2 edges , there may be @xmath3 triangles , say .",
    "in contrast , the model of  @xcite , like @xmath0 , produces graphs that contain essentially no triangles or short cycles .",
    "most models introduced to approximate particular real - world networks turn out to be mathematically intractable , due to the dependence between edges . nevertheless , many such models have been studied ; as this is not our main focus , let us just list a few examples of early work in this field .",
    "one of the starting points in this area was the ( homogeneous ) ` small - world ' model of watts and strogatz  @xcite .",
    "another was the observation of power - law degree sequences in various networks by faloutsos , faloutsos and faloutsos  @xcite , among others .",
    "of the new inhomogeneous models , perhaps the most studied is the ` growth with preferential attachment ' model introduced in an imprecise form by barabsi and albert  @xcite , later made precise as the ` lcd model ' by bollobs and riordan  @xcite .",
    "another is the ` copying ' model of kumar , raghavan , rajagopalan , sivakumar , tomkins and upfal  @xcite , generalized by cooper and frieze  @xcite , among others . for ( early ) surveys of work in this field",
    "see , for example , barabsi and albert  @xcite , dorogovtsev and mendes  @xcite , or bollobs and riordan  @xcite .",
    "roughly speaking , any sparse model with clustering must include significant dependence between edges , so one might expect it to be impossible to construct a general model of this type that is still mathematically tractable .",
    "however , it turns out that one can do this .",
    "the model that we shall define is essentially a generalization of that in  @xcite , although we shall handle certain technicalities in a different way here .    throughout this paper",
    "we use standard graph theoretic notation as in  @xcite .",
    "for example , if @xmath4 is a graph then @xmath5 denotes its vertex set , @xmath6 its edge set , @xmath7 the number of vertices , and @xmath8 the number of edges .",
    "we also use standard notation for probabilistic asymptotics as in @xcite : a sequence @xmath9 of events holds _ with high probability _ , or _ whp _ , if @xmath10 as @xmath11 .",
    "if @xmath12 is a sequence of random variables and @xmath13 is a deterministic function , then @xmath14 means @xmath15 , where @xmath16 denotes convergence in probability .",
    "let us set the scene for our model . by a _ type space _ we simply mean a probability space @xmath17 .",
    "often , we shall take @xmath18 $ ] or @xmath19 $ ] with @xmath20 lebesgue measure .",
    "sometimes we consider @xmath21 finite .",
    "as will become clear , any model with @xmath21 finite can be realized as a model with type space @xmath22 $ ] , but sometimes the notation will be simpler with @xmath21 finite . more generally , as shown in  @xcite , every instance of the random graph model we are going to describe can be realized as an equivalent model with type space @xmath22 $ ] .",
    "hence , when it comes to proofs , we lose no generality by taking @xmath18 $ ] , but we usually prefer allowing an arbitrary type space , which is more flexible for applications . for example , as with the model in  @xcite , type spaces such as @xmath18 ^ 2 $ ] are likely to be useful for geometric applications , as in  @xcite .",
    "let @xmath23 consist of one representative of each isomorphism class of finite connected graphs , chosen so that if @xmath24 has @xmath25 vertices then @xmath26=\\{1,2,\\ldots,{r}\\}$ ] .",
    "given @xmath24 with @xmath27 vertices , let @xmath28 be a measurable function from @xmath29 to @xmath30 ; we call @xmath28 the _ kernel _ corresponding to @xmath31 .",
    "a sequence @xmath32 is a _",
    "kernel family_. in our results we shall impose an additional integrability condition on @xmath33 , but this is not needed to define the model .",
    "let @xmath33 be a kernel family and @xmath1 an integer ; we shall define a random graph @xmath34 with vertex set @xmath35={\\ensuremath{\\{1,2,\\ldots , n\\}}}$ ] .",
    "first let @xmath36 be i.i.d .",
    "( independent and identically distributed ) with the distribution @xmath20 .",
    "given @xmath37 , construct @xmath34 as follows , starting with the empty graph .",
    "for each @xmath27 and each @xmath24 with @xmath38 , and for every @xmath27-tuple of distinct vertices @xmath39^{r}$ ] , add a copy of @xmath31 on the vertices @xmath40 ( with vertex @xmath41 of @xmath31 mapped to @xmath42 ) with probability @xmath43 all these choices being independent .",
    "if @xmath44 , then we simply add a copy with probability @xmath45 .",
    "we shall often call the added copies of the various @xmath31 that together form @xmath34 _ atoms _ since , in our construction of @xmath34 , they may be viewed as indivisible building blocks .",
    "sometimes we refer to them as _ small graphs _ , although there is in general no bound on their sizes .",
    "usually we think of @xmath34 as a simple graph , in which case we simply replace any multiple edges by single edges .",
    "typically there will be very few multiple edges , so this makes little difference .",
    "note that we assume that the atoms of @xmath34 are connected .",
    "the extension to the case where some atoms may be disconnected is discussed in section  [ sdisconnected ] .",
    "the reason for dividing by @xmath46 in is that we wish to consider sparse graphs ; indeed , our main interest is the case when @xmath34 has @xmath47 edges . as it turns out , we can be slightly more general ; however , when @xmath48 is integrable ( which we shall always assume ) , the expected number of added copies of each graph @xmath31 is @xmath49 ) .",
    "note that all incompletely specified integrals are with respect to the appropriate @xmath25-fold product measure @xmath50 on @xmath51 .",
    "there are several plausible choices for the normalization in .",
    "the one we have chosen means that if @xmath52 is constant , then ( asymptotically ) there are on average @xmath53 copies of @xmath31 in total , and each vertex is on average in @xmath54 copies of @xmath31 .",
    "an alternative is to divide the expression in by @xmath27 ; then ( asymptotically ) each vertex would on average be in @xmath55 copies of @xmath31 .",
    "another alternative , natural when adding cliques only but less so in the general case , would be to divide by @xmath56 ; this is equivalent to considering unordered sets of @xmath27 vertices instead of ordered @xmath27-tuples .",
    "when there is only one kernel , corresponding to adding edges , this would correspond to the normalization used in @xcite , and in particular to that of the classical model @xmath0 ; the normalization we use here differs from this by a factor of 2 . yet another normalization would be to divide by @xmath57 , the number of automorphisms of @xmath31 ; this is equivalent to considering the distinct copies of @xmath31 in @xmath58 , which is natural but leads to extra factors @xmath57 in many formulae , and we do not find that the advantages outweigh the disadvantages .    as in  @xcite , there are several minor variants of @xmath34 ; perhaps the most important is the _ poisson multi - graph _ version of @xmath34 . in this variant , for each @xmath31 and each @xmath27-tuple , we add a poisson @xmath59 number of copies of @xmath31 with this vertex set , where @xmath60 is given by , and we keep multiple edges .    alternatively , we could add a poisson number of copies and delete multiple edges , which is the same as adding one copy with probability @xmath61 and no copy otherwise .",
    "more generally , we could add one copy of @xmath31 with probability @xmath62 , and two or more copies with probability @xmath63 .",
    "as long as the error terms are uniform over graphs @xmath31 and @xmath27-tuples @xmath64 , all our results will apply in this greater generality .",
    "since this will follow by simple sandwiching arguments ( after reducing to the ` bounded ' case ; see definition  [ dbounded ] ) , we shall consider whichever form of the model is most convenient ; usually this turns out to be the poisson multi - graph form .",
    "under certain mild conditions , the results of @xcite imply a strong form of asymptotic equivalence between the various versions of the model .",
    "for example , if we add copies of @xmath31 with probability @xmath65 , where the implied constant is uniform over @xmath31 and @xmath66 , and @xmath67 then the resulting model is equivalent to that with probability @xmath60 , in that the two random graphs can be coupled to agree whp ; this is a straightforward modification of ( * ? ? ? * corollary 2.13(i ) ) . extending the argument in ( * ? ? ?",
    "* example 3.2 ) , it can be shown that holds if @xmath68 this certainly holds for the bounded kernel families ( see  definition  [ dbounded ] ) that we consider in most of our proofs , although is easy to verify directly for such kernel families .    in the special case where all @xmath28 are zero apart from @xmath69 , the kernel corresponding to an edge , we recover ( essentially ) a special case of the model of  @xcite ; we call this the _ edge - only _ case , since we add only edges , not larger graphs .",
    "we write @xmath70 for @xmath69 .",
    "note that in the edge - only case , given @xmath71 , two vertices @xmath41 and @xmath72 are joined with probability @xmath73 the correction term will never matter , so we may as well replace @xmath70 by its symmetrized version .",
    "in fact , we shall always assume that @xmath28 is invariant under the action of the automorphism group @xmath74 of the graph @xmath31 .",
    "in other words , if @xmath75\\to[r]$ ] is a permutation such that @xmath76 if and only if @xmath77 , then we assume that @xmath78 for all @xmath79 . in the poisson version , or",
    "if we add copies of graphs @xmath31 with probability @xmath61 , the correction terms in and its generalizations disappear : in the edge - only case , given @xmath71 , vertices @xmath41 and @xmath72 are joined with probability @xmath80 , and in general we obtain exactly the same random graph if we symmetrize each @xmath28 with respect to @xmath74 .",
    "for any kernel family @xmath33 , let @xmath81 be the corresponding _ edge kernel _",
    ", defined by @xmath82 where the second sum runs over all @xmath83 ordered pairs @xmath84 with @xmath77 , and we integrate over all variables apart from @xmath85 and @xmath86 . note that the sum need not always converge ; since every term is positive this causes no problems : we simply allow @xmath87 for some @xmath88 . given @xmath89 and @xmath90 , the probability that @xmath41 and @xmath72 are joined in @xmath34 is at most @xmath91 , and this upper bound is typically quite sharp .",
    "for example , if @xmath33 is bounded in the sense of definition  [ dbounded ] below , then the probability is @xmath92 . in other words",
    ", @xmath81 captures the edge probabilities in @xmath34 , but not the correlations .    before proceeding to deeper properties ,",
    "let us note that the expected number of added copies of @xmath31 is @xmath93 .",
    "unsurprisingly , the actual number turns out to be concentrated about this mean .",
    "let @xmath94 be the _",
    "asymptotic edge density _ of @xmath33 .",
    "since every copy of @xmath31 contributes @xmath95 edges , the following theorem is almost obvious , provided we can ignore overlapping edges .",
    "a formal proof will be given in section  [ sec_subgraphs ] .",
    "( a similar result for the total number of atoms is given in lemma  [ badv ] . )    [ tedges ] as @xmath96 , @xmath97 converges in probability to the asymptotic edge density @xmath98 . in other words , if @xmath99 then @xmath100 , and if @xmath101 then , for every constant @xmath102 , we have @xmath103 whp .",
    "moreover , @xmath104    as in  @xcite , our main focus will be the emergence of the giant component . by the _ component structure _ of a graph @xmath4 , we mean the set of vertex sets of its components , i.e. , the structure encoding only which vertices are in the same component , not the internal structure of the components themselves .",
    "when studying the component structure of @xmath34 , the model can be simplified somewhat .",
    "recalling that the atoms @xmath24 are connected by definition , when we add an atom @xmath31 to a graph @xmath4 , the effect on the component structure is simply to unite all components of @xmath4 that meet the vertex set of @xmath31 , so only the vertex set of @xmath31 matters , not its graph structure .",
    "we say that @xmath33 is a _ clique kernel family _ if the only non - zero kernels are those corresponding to complete graphs ; the corresponding random graph model @xmath34 is a _ clique model_. for questions concerning component structure , it suffices to study clique models . for clique kernels we write @xmath105 for @xmath106 ;",
    "as above , we always assume that @xmath105 is symmetric , here meaning invariant under all permutations of the coordinates of @xmath29 . given a general kernel family @xmath33 , the corresponding ( symmetrized ) clique kernel family is given by @xmath107 with @xmath108 where @xmath109 denotes the symmetric group of permutations of @xmath110 $ ] .",
    "( this is consistent with our notation @xmath111 . ) in the poisson version , with or without merging of parallel edges , the probability of adding some connected graph @xmath31 on a given set of @xmath25 vertices is exactly the same in @xmath34 and @xmath112 , so there is a natural coupling of these random graphs in which they have exactly the same component structure . in the non - poisson version ,",
    "the probabilities are not quite the same , but close enough for our results to transfer from one to the other .",
    "thus , when considering the size ( meaning number of vertices ) of the giant component in @xmath34 , we may always replace @xmath33 by the corresponding clique kernel family .",
    "it is often convenient to think of a clique model as a random hypergraph , with the cliques as the hyperedges ; for this reason we call a clique kernel family a _ hyperkernel_. note that each unordered set of @xmath27 vertices corresponds to @xmath56 @xmath27-tuples , so the probability that we add a @xmath113 on a given set of @xmath25 vertices is @xmath114 .",
    "( more precisely , this is the expected number of @xmath115s added with this vertex set . )",
    "associated to each hyperkernel @xmath116 , there is a branching process @xmath117 with type space @xmath21 , defined as follows .",
    "we start with generation @xmath118 consisting of a single particle whose type is chosen randomly from @xmath21 according to the distribution @xmath20 .",
    "a particle @xmath119 of type @xmath85 gives rise to children in the next generation according to a two - step process : first , for each @xmath120 , construct a poisson process @xmath121 on @xmath122 with intensity @xmath123 we call the points of @xmath124 the _ child cliques _ of @xmath119 .",
    "there are @xmath125 children of @xmath119 for each child clique @xmath126 , one each of types @xmath127 .",
    "thus the types of the children of @xmath119 form a multiset on @xmath21 , with a certain compound poisson distribution we have just described . as usual , the children of different particles are independent of each other , and of the history .    considering the relationship to the graph @xmath34 , the initial factor @xmath25 in arises because a particular vertex @xmath128 may be any one of the @xmath25 vertices in an @xmath25-tuple @xmath129 on which we add a @xmath115 .",
    "we also consider the branching processes @xmath130 , @xmath131 , defined exactly as @xmath117 , except that we start with a single particle of the given type @xmath85 .",
    "we shall consider two integral operators naturally associated to @xmath117 .",
    "given any ( measurable ) @xmath132 $ ] , define @xmath133 by @xmath134 and let @xmath135 ( the factors @xmath27 in and in the definition of @xmath117 are unfortunate consequences of our choice of normalization . )    let @xmath119 be a particle of @xmath117 in generation @xmath136 with type @xmath85 , and suppose that each particle in generation @xmath137 of type @xmath86 has some property @xmath138 with probability @xmath139 , independently of the other particles .",
    "given a child clique @xmath140 of @xmath119 , the bracket in the definition of @xmath141 expresses the probability that one or more of the @xmath125 corresponding child particles has property @xmath138 .",
    "hence @xmath142 is the expected number of child cliques containing a particle with property @xmath138 , and , from the poisson distribution of the child cliques , @xmath143 is the probability that there is at least one such clique , i.e. , the probability that at least one child of @xmath119 has property @xmath138 .",
    "let @xmath144 denote the survival probability of the branching process @xmath117 , and @xmath145 the survival probability of @xmath130 .",
    "assuming for the moment that the function @xmath146 $ ] is measurable , from the comments above and the independence built into the definition of @xmath117 , we see that the function @xmath147 satisfies @xmath148 using simple standard arguments as in  @xcite , for example , it is easy to check that @xmath147 is given by the maximum solution to this equation , i.e. , the pointwise supremum of all solutions @xmath132 $ ] to @xmath149 see lemma  [ l_max ] below . from the definitions of @xmath117 and @xmath130 ,",
    "it is immediate that @xmath150    in our analysis we shall also consider the linear operator @xmath151 defined by @xmath152 where @xmath81 is defined by . for a hyperkernel @xmath33 ( which is the only type of kernel family for which we define the branching process ) , we have @xmath153 from which it is easy to check that @xmath151 is the linearized form of @xmath141 : more precisely , @xmath151 is obtained by replacing @xmath154 by @xmath155 in the definition of @xmath141 .",
    "let us note two simple consequences of this fact .",
    "for any sequence @xmath156 in @xmath157}$ ] we have @xmath158 , so @xmath159 for any @xmath132 $ ] .",
    "also , @xmath160 if and only if @xmath161 . since the integral of a non - negative function is positive if and only if the function is positive on a set of positive measure , it follows that for any @xmath132 $ ] we have @xmath162    in the edge - only case , when only @xmath70 is non - zero , @xmath163 and @xmath164 .",
    "when translating results from  @xcite , it is sometimes @xmath151 and sometimes @xmath141 that plays the role of the linear operator @xmath165 appearing there .      in most of our results we shall need to impose some sort of integrability condition on our kernel family ; the exact condition depends on the context .",
    "[ dint ]    [ dwint ] a kernel family @xmath32 is _ integrable _ if @xmath166 this means that the expected number of atoms containing a given vertex is bounded .",
    "[ deint ] a kernel family @xmath32 is _ edge integrable _ if @xmath167 equivalently , @xmath99 or @xmath168 .",
    "this means that the expected number of edges in @xmath169 is @xmath47 , see theorem  [ tedges ] , and thus the expected degree of a given vertex is bounded .",
    "note that a hyperkernel @xmath170 is integrable if and only if @xmath171 , and edge integrable if and only if @xmath172 .",
    "since we only consider connected atoms @xmath31 , it is clear that @xmath173    our main result is that if @xmath33 is an integrable kernel family satisfying a certain extra assumption , then the normalized size of the giant component in @xmath34 is simply @xmath174 .",
    "the extra assumption is essentially that the graph does not split into two pieces . as in @xcite",
    ", we say that a symmetric kernel @xmath175 is _ reducible _ if @xmath176 otherwise @xmath81 is _",
    "irreducible_. thus @xmath81 is irreducible if @xmath177 a kernel family @xmath178 or hyperkernel @xmath179 is _ irreducible _ if the corresponding edge kernel @xmath81 is irreducible .",
    "it is easy to check that a kernel family @xmath178 is irreducible if and only if for every @xmath180 with @xmath181 there exists an @xmath182 such that , with @xmath183 , if @xmath184 are chosen independently at random in @xmath21 with distribution @xmath20 , then there is a positive probability that @xmath185 , @xmath186 and @xmath187 .",
    "informally , @xmath178 is irreducible if , whenever we partition the type space into two non - trivial parts , edges between vertices with types in the two parts are possible .    note",
    "that a kernel family @xmath188 and the corresponding hyperkernel @xmath33 do _ not _ have the same edge kernel : replacing each atom by a clique in general adds edges , so @xmath189 with strict inequality possible .",
    "if @xmath190 is irreducible , then so is @xmath81 ; using the characterization of irreducibility above , it is easy to check that the reverse implication also holds .",
    "we are now ready to state our main result ; we write @xmath191 for the number of vertices in the @xmath41th largest component of a graph @xmath4 .",
    "[ th1 ] let @xmath192 be an irreducible , integrable kernel family , and let @xmath193 be the corresponding hyperkernel , given by",
    ". then @xmath194 and @xmath195 .",
    "the reducible case reduces to the irreducible one ; see remark  [ r_red ] .",
    "unsurprisingly , part of the proof of theorem  [ th1 ] involves showing that ( in the hyperkernel case ) the branching process captures the ` local structure ' of @xmath34 ; see section  [ sec_loc ] and in particular lemma  [ nkint ] .",
    "so theorem  [ th1 ] can be seen as saying that _ within this broad class of models _ the local structure determines the size of the giant component .",
    "of course , the restriction is important , as shown by the fact that the global assumption of irreducibility is necessary .    of course",
    ", for theorem  [ th1 ] to be useful we would like to know something about the survival probability @xmath144 ; as noted earlier , @xmath144 can be calculated from @xmath147 , which is in turn the largest solution to a certain functional equation  . of course , the main thing we would like to know is when @xmath144 is positive ; as in  @xcite , it turns out that the answer depends on the @xmath196-norm @xmath197 of the operator @xmath151 defined by .",
    "( since this operator is symmetric , its @xmath196-norm is the same as its spectral radius . in other contexts",
    ", it may be better to work with the latter . )",
    "[ th2 ] let @xmath33 be an integrable hyperkernel .",
    "then @xmath198 if and only if @xmath199 .",
    "furthermore , if @xmath33 is irreducible and @xmath199 , then @xmath145 is the unique non - zero solution to the functional equation , and @xmath200 holds for a.e .",
    "@xmath85 .    in general",
    ", @xmath201 may be rather hard to calculate ; a non - trivial example where we can calculate the norm easily is given in subsection  [ ss_egg ] .",
    "let us give a trivial example here : suppose that each @xmath202 is constant , say @xmath203 .",
    "then @xmath204 for all @xmath85 and @xmath86 , so @xmath205 this is perhaps surprising : it tells us that for such uniform hyperkernels , the critical point where a giant component emerges is determined only by the total number of edges added ; it does not matter what size cliques they lie in , even though , for example , the third edge in every triangle is ` wasted ' .",
    "this is not true for arbitrary kernel families : we must first replace each atom by a clique .",
    "note that for any hyperkernel , @xmath206 with equality if and only if @xmath45 is an eigenfunction , i.e. , if the asymptotic expected degrees @xmath207 are the same ( ignoring sets of measure 0 ) ; c.f .",
    "* proposition 3.4 ) .      in the edge - only case , the present results are almost ( see below ) special cases of those  @xcite .",
    "the set - up here is much simpler , as we choose to insist that the vertex types @xmath208 are i.i.d .",
    "this avoids many of the complications arising in  @xcite . in one way , the present set - up is , even in the edge - only case , more general than that considered in  @xcite : with the types i.i.d .",
    ", there is no need to restrict the kernels other than to assume integrability ( in  @xcite we needed them continuous a.e . ) , and one does not need to impose the ` graphicality ' assumption of  @xcite .",
    "thus the edge - only case here actually complements the results in  @xcite .",
    "we could form a common generalization , but we shall not do this in detail ; we believe that it is just a question of combining the various technicalities here and in  @xcite , and that no interesting new difficulties arise . of course",
    ", these technicalities are rather beside the point of the present paper ; our interest is the extension from kernels to hyperkernels .",
    "this turns out not to be as straightforward as one might perhaps expect .",
    "the problem is that the correlation between edges forces us to deal with a non - linear operator , namely @xmath141 .",
    "the rest of the paper is organized as follows . in the next section",
    "we prove the results about the non - poisson branching process @xmath117 that we shall need later , the most important of which is theorem  [ th2 ] . in section  [ sec_loc ]",
    "we consider the local coupling between the graph and the branching process , showing in particular that the ` right ' number of vertices are in components of any fixed size . in section  [ sec_giant ]",
    "we complete the proof of theorem  [ th1 ] , showing that whp there is at most one ` large ' component , which is then a ` giant ' component of the right size .",
    "we briefly discuss percolation on the graphs @xmath34 in section  [ sdisconnected ] . in sections",
    "[ sec_degrees ] and  [ sec_subgraphs ] we consider simpler properties of @xmath34 , namely the asymptotic degree distribution and the number of subgraphs isomorphic to a given graph .",
    "our results in  section  [ sec_subgraphs ] include theorem  [ tedges ] as a simple special case . in section  [ sec_pl ]",
    "we illustrate the flexibility of the model by carrying out explicit calculations for a special case , giving graphs with power - law degree sequences with a range of exponents and a range of clustering and mixing coefficients ; see section  [ sec_pl ] for the definitions of these coefficients .",
    "finally , in section  [ sec_lim ] we discuss connections between our model and various notions of graph limit , and state two open questions .",
    "in this section , which is the heart of the paper , we forget about graphs , and study the ( compound poisson ) branching process @xmath117 .",
    "one might expect the arguments of  @xcite to carry over _ mutatis mutandis _ to the present context , but in the branching process analysis this is very far from the truth ; this applies especially to the proof of theorem  [ unique ] below .    throughout the section we work with an integrable hyperkernel @xmath116 , i.e.",
    ", we assume that @xmath209 .",
    "our main aim in this section is to prove theorem  [ th2 ] .",
    "for @xmath210 let @xmath211 so @xmath212 is the expected number of child cliques of a particle of type @xmath85 .",
    "we have @xmath213 which is finite by our integrability assumption .",
    "it follows that @xmath214 holds almost everywhere .",
    "changing each kernel @xmath105 on a set of measure zero , we may assume that @xmath212 is finite for all @xmath85 .",
    "( such a change is irrelevant for the branching process and for the graph . ) from now on , we thus assume that @xmath214 holds for all @xmath85 , for any hyperkernel @xmath33 we consider .    since a poisson random variable with finite mean is always finite , any particle in @xmath117 has a finite number of child cliques , and hence a finite number of children , even though the expected number of children may perhaps be infinite .",
    "hence , the event that the branching process dies out ( i.e. , that some generation is empty ) coincides with the event that it is finite .    using this fact , we have the following , standard result .",
    "recall that @xmath145 denotes the survival probability of the branching process @xmath130 that starts with a single particle of type @xmath85 , and @xmath147 denotes the function @xmath215 .",
    "[ l_max ] the function @xmath147 satisfies the functional equation .",
    "furthermore , if @xmath216 $ ] is any other solution to , then @xmath217 holds for every @xmath85 .",
    "let @xmath218 be the probability that @xmath130 survives for at least @xmath136 generations , so @xmath219 is identically @xmath45 .",
    "conditioned on the set of child cliques , and hence children , of the root , each child of type @xmath86 survives for @xmath136 further generations with probability @xmath220 .",
    "these events are independent for different children by the definition of the branching process , so @xmath221 .",
    "the result follows from the monotonicity of @xmath222 and the fact that @xmath223 , noting that @xmath224 for the strict inequality .",
    "let us remark for the last time on the measurability of the functions we consider : in the proof above , @xmath219 is measurable by definition . from the definition of @xmath222 and the measurability of each @xmath225",
    ", it follows by induction that each @xmath226 is measurable , and hence that @xmath147 is .",
    "similar arguments apply in many places later , but we shall omit them .",
    "we next turn to the uniqueness of the non - zero solution ( if any ) to .",
    "the key ingredient in establishing this is the following simple inequality concerning the non - linear operator @xmath141 .",
    "[ l_fsg ] let @xmath33 be an integrable hyperkernel , and let @xmath13 and @xmath227 be measurable functions on @xmath21 with @xmath228 .",
    "then @xmath229    we may write @xmath141 as @xmath230 , where @xmath231 is the non - linear operator corresponding to the single kernel @xmath105 , so @xmath232 is defined by the summand in . it suffices to prove that @xmath233 we shall in fact show that for any ( distinct ) @xmath234 we have @xmath235 since @xmath105 is symmetric , follows .",
    "( in fact , can be true in general only if always holds , considering the symmetrization of a delta function . )",
    "now can be viewed as an inequality in @xmath236 variables @xmath237 .",
    "this inequality is linear in each variable .",
    "furthermore , it is linear in each pair @xmath238 , @xmath239 . in proving for any @xmath228",
    ", we may thus assume that for each @xmath41 one of three possibilities holds : @xmath240 , @xmath241 , or @xmath242 and @xmath243 .",
    "in other words , we may assume that @xmath13 and @xmath227 are @xmath244-valued .",
    "suppose then for a contradiction that fails for some @xmath244-valued @xmath13 and @xmath227 with @xmath245 . then there must be some permutation @xmath246 such that @xmath247 which we may take without loss of generality to be the identity permutation .",
    "since both sides of are @xmath244-valued , the left must be @xmath45 and the right @xmath118 .",
    "since the left is @xmath45 , we have @xmath248 , so , using @xmath245 , @xmath249 .",
    "but now for the right hand side of to be 0 the final product in must be @xmath45 , so @xmath242 for @xmath250 , i.e. , @xmath13 takes the value @xmath45 only once . of course , @xmath227 must take the value @xmath45 at least twice , otherwise we have equality .",
    "but now the left hand side of is exactly @xmath251 , coming from terms with @xmath252 and hence @xmath253 .",
    "the right hand side is at least @xmath251 , from any @xmath246 mapping @xmath45 to some @xmath254 with @xmath255 .",
    "hence holds after all , giving a contradiction and completing the proof .",
    "if @xmath33 is reducible , then may in general have several non - zero solutions . to prove uniqueness in the irreducible case we need to know what irreducibility tells us about @xmath141 .",
    "[ l_red2 ] if there exists a measurable @xmath132 $ ] with @xmath256 and @xmath257 , then @xmath33 is reducible .",
    "let @xmath258 , so by assumption @xmath259 on @xmath260 .",
    "from we have @xmath261 , so @xmath262 on @xmath263 . from the definition of @xmath151",
    "it follows that @xmath264 a.e .",
    "on @xmath265 , so @xmath81 is reducible .",
    "but this is what it means for @xmath33 to be reducible .",
    "in fact , taking @xmath13 to be a suitable indicator function , one can check that the converse of lemma  [ l_red2 ] also holds .    using lemmas",
    "[ l_fsg ] and  [ l_red2 ] it is easy to deduce uniqueness of any non - zero solution to  .",
    "[ unique ] let @xmath33 be an irreducible , integrable hyperkernel , and let @xmath13 and @xmath227 be solutions to with @xmath266 for every @xmath85 . then either @xmath267 or @xmath268 .",
    "in particular , the only solutions to are @xmath147 and the zero function , which may or may not coincide .",
    "we may suppose that @xmath13 is not @xmath118 a.e . ; otherwise , @xmath269 would be identically zero .",
    "since @xmath13 solves , we have @xmath270 , so by lemma  [ l_red2 ] we can not have @xmath271 .",
    "the only possibility left is that @xmath272 , i.e. , @xmath273 a.e . turning to @xmath227 , since @xmath33 is integrable , we have @xmath274 for a.e . @xmath85 , and thus @xmath275 a.e .    since @xmath13 and @xmath227 solve , we have @xmath276 and @xmath277",
    "hence , @xmath278 whenever @xmath279 , with strict inequality whenever @xmath280 . since @xmath33 is integrable ,",
    "it is immediate from the definition that @xmath281 and @xmath282 are integrable , and it follows that @xmath283 with strict inequality unless @xmath268 a.e . since lemma  [ l_fsg ] gives the reverse inequality , we have @xmath268 a.e . , and thus @xmath284 .",
    "the second statement then follows from lemma  [ l_max ] .",
    "theorem  [ unique ] generalizes the corresponding result in  @xcite , namely lemma  5.9 . indeed , in the edge - only case ( when only @xmath70 is non - zero ) , the operators @xmath141 and @xmath151 coincide , and lemma  [ l_fsg ] holds trivially , using the symmetry of @xmath151 .",
    "this shows that , with hindsight , the proof of lemma  5.9 in  @xcite may be simplified considerably , by considering @xmath285 instead of @xmath286 , @xmath287 .",
    "this is significant , since the proof in  @xcite does not adapt readily to the present context .",
    "although simple , the proof of theorem  [ unique ] above is a little mysterious from a branching process point of view .",
    "it is tempting to think that the result is ` obvious ' , and indeed that a corresponding result should hold for any galton  watson process .",
    "however , some conditions are certainly necessary , and it is not clear what the right conditions are for a general process .",
    "( irreducibility is always needed , of course . ) in  @xcite , a corresponding result is proved for a general branching process satisfying a certain continuity assumption ; the proof uses the convexity property @xmath288 for any function @xmath289 and any @xmath290 , which holds for all galton ",
    "watson branching processes . in  theorem",
    "[ unique ] , continuity is not needed , but some kind of symmetry is ; there does not seem to be an obvious common generalization of these results .    indeed , the next example shows that the situation is not that simple : in the compound poisson case ( as opposed to the simple poisson case ) , symmetry of the relevant linear operator is not enough .",
    "let @xmath291 with @xmath292 for each @xmath41 , and consider the branching process @xmath293 with type space @xmath17 defined as follows .",
    "start with a single particle of some given type @xmath85 .",
    "each particle of type @xmath41 has a poisson number of children of type @xmath294 with mean @xmath295 ; we call these ` forward children ' .",
    "also , for @xmath296 , a particle of type @xmath41 has ` backward children ' of type @xmath297 : the number of these is @xmath298 times a poisson with mean @xmath299 .",
    "note that the expected number of backward children is @xmath300 . defining the ` edge - kernel ' @xmath81 so that the expected number of children of type @xmath72 that each particle of type @xmath41 has is given by @xmath301 , we have @xmath302 if @xmath303 and @xmath304 otherwise , so @xmath81 is symmetric and irreducible .",
    "define the non - linear operator @xmath305 associated to @xmath306 in the natural way , so @xmath307 is the probability that at least one child of the root of type @xmath85 has a certain property , if each child of type @xmath86 has this property independently with probability @xmath139 .",
    "as before , the survival probability @xmath308 satisfies @xmath309 .",
    "let @xmath310 denote the probability that the process",
    "_ survives transiently _",
    ", i.e. , survives forever , but , for each @xmath41 , contains in total only finitely many particles of type @xmath41 .",
    "consider the ` forward process ' given by ignoring backward children .",
    "this is simply a poisson galton ",
    "watson process with on average 2 offspring , and so survives with some positive probability .",
    "also , given that it survives , there is a positive probability that for every @xmath136 , generation @xmath136 contains at most @xmath311 particles , say .",
    "but since the particles in generation @xmath136 have type @xmath312 , the expected number of _ sets _ of backwards children of all particles in the forward process is at most @xmath313 , and with positive probability the particles in the forward process have no backwards children .",
    "but in this case , the forward process is the whole process , and the process survives transiently .",
    "hence @xmath314 for every @xmath85 .",
    "let @xmath315 be the probability that the process survives recurrently .",
    "considering the children of the initial particle , we see that @xmath316 .",
    "the process restricted to any two consecutive types is already supercritical , and so has positive probability of surviving by alternating between these types .",
    "thus @xmath317 for all @xmath85 .",
    "we showed above that @xmath318 for all @xmath85 , so @xmath319 , and @xmath320 has ( at least ) two non - zero solutions , namely @xmath321 and @xmath322 .",
    "let us turn to the analysis of the solution @xmath147 to , and in particular the question of when @xmath323 , i.e. , when the branching process @xmath324 is supercritical .",
    "throughout we consider an integrable hyperkernel @xmath33 , with corresponding edge kernel @xmath81 .",
    "recall that we may assume that @xmath325 is finite everywhere .",
    "hence , for any @xmath13 satisfying , we have @xmath326 for all @xmath85 . on the other hand",
    ", we can not assume that @xmath81 is integrable , or indeed finite .",
    "for one natural example , consider the integrable hyperkernel with each @xmath105 constant , and @xmath327 . in this case",
    "@xmath87 for all @xmath85 and @xmath86 .",
    "if @xmath81 is infinite on a set of positive measure , then we take @xmath201 to be infinite .",
    "[ l_sc ] if @xmath328 , then @xmath329 .",
    "suppose that @xmath13 is a solution to that is not @xmath118 a.e . since @xmath330 for @xmath331 , we have @xmath332 , with strict inequality on a set of positive measure . but",
    "@xmath333 by , so @xmath334 , with strict inequality on a set of positive measure .",
    "hence @xmath335 , so @xmath336 .",
    "lemmas 5.12 and 5.13 of  @xcite carry over to the present context , with only minor modifications . given functions @xmath337 and @xmath13 , we write @xmath338 if the sequence @xmath339 is monotone increasing and converges to @xmath13 pointwise .    if @xmath289 and @xmath340 , then @xmath341 as @xmath342 , for some @xmath343 with @xmath344 .    since @xmath345 , monotonicity of @xmath222 gives @xmath346 and , by induction , @xmath347 for all @xmath348 .",
    "since @xmath349 , it follows that @xmath350 exists for every @xmath85 , and @xmath351 . from monotone convergence",
    "we have @xmath352 , from which it follows that @xmath344 .",
    "[ l_fup ] if there is a function @xmath132 $ ] , not a.e .  @xmath118 , such that @xmath353 for some @xmath354 , then @xmath198 .",
    "the proof is the same as that of lemma 5.13 in  @xcite , using @xmath141 in place of @xmath355 .",
    "the next step is to show that if @xmath199 , then there is a function @xmath13 with the property described in lemma  [ l_fup ] . in  @xcite we did this by considering a bounded kernel .",
    "here we have to be a little more careful , as we are working with the non - linear operator @xmath141 rather than with @xmath151 ; this is no problem if we truncate our kernels suitably .",
    "[ dbounded ] we call a hyperkernel @xmath356 _ bounded _ if two conditions hold : only finitely many of the @xmath105 are non - zero , and each @xmath105 is bounded .",
    "similarly ( for later use ) , a general kernel family @xmath178 is _ bounded _ if only finitely many of the @xmath28 are non - zero , and each @xmath28 is bounded .    in other words ,",
    "@xmath33 is bounded if there are constants @xmath357 and @xmath358 such that @xmath359 for @xmath360 , and @xmath105 is pointwise bounded by @xmath358 for @xmath361 .",
    "note that if @xmath33 is bounded , then the corresponding edge kernel @xmath81 is bounded in the usual sense .    given a hyperkernel @xmath362 , for each @xmath363 we let @xmath364 be the bounded hyperkernel obtained from @xmath365 by truncating each @xmath105 , @xmath366 , at @xmath358 , and replacing @xmath105 by a zero kernel for @xmath367 .",
    "thus @xmath368 the truncation @xmath369 of a general kernel family @xmath178 is defined similarly , replacing the condition @xmath370 by @xmath371 .",
    "[ l_ef ] if @xmath199 then there is a @xmath354 and an @xmath132 $ ] , not a.e .",
    "@xmath118 , such that @xmath353 .",
    "we slightly modify the proof of lemma 5.16 of  @xcite .",
    "consider the truncated hyperkernels @xmath364 defined in . from and monotone convergence , the corresponding edge kernels @xmath372 tend up to @xmath81 ( which may be infinite in some places ) pointwise .",
    "arguing as in the proof of lemma 5.16 of  @xcite , since @xmath199 there is some positive @xmath13 with @xmath373 and @xmath374 . by monotone convergence , @xmath375 , so @xmath376 , and",
    "there is some @xmath358 with @xmath377 .",
    "since @xmath372 is bounded , setting @xmath378 , by lemma 5.15 of  @xcite it follows that there is a bounded @xmath379 with @xmath13 not 0 a.e .",
    "such that @xmath380 we may assume that @xmath381 . if @xmath382 , @xmath383 , then ( by induction ) @xmath384 , and it follows that if @xmath385 is chosen small enough , then @xmath386 since @xmath387 , the result follows .",
    "theorem  [ th2 ] follows by combining the results above .",
    "together lemmas  [ l_sc ] , [ l_fup ] and [ l_ef ] show that @xmath198 if and only if @xmath199 .",
    "uniqueness is given by theorem  [ unique ] .",
    "the final statement is immediate from lemma  [ l_red2 ] .",
    "having proved theorem  [ th2 ] , our next aim is to prove theorem  [ th1 ] .",
    "the basic strategy will involve comparing the neighbourhoods of a vertex in the random graph @xmath34 with the branching process @xmath117 . as in  @xcite",
    ", it will be convenient to carry out the comparison only for certain restricted hyperkernels . in order to deduce results about @xmath34 in general",
    ", one needs approximation results both for the graph and for the branching process .",
    "we now turn to such results for branching processes .",
    "lemma 6.3 and theorems 6.4 and 6.5 of  @xcite carry over to the present context , _ mutatis mutandis _ , using the results above about @xmath144 instead of the equivalents in  @xcite , and replacing @xmath355 by @xmath141 or @xmath151 as appropriate : @xmath141 when considering @xmath388 , and @xmath151 when arguing using @xmath196-norms . in these results",
    "@xmath147 denotes the function @xmath215 , and @xmath389 and @xmath390 denote respectively the probabilities that @xmath130 and @xmath117 have total size at least @xmath391 , where the _ size _ of a branching process is the total number of particles in all generations .",
    "[ l12 ] if @xmath392 , then @xmath393 .",
    "[ tappb ]    let @xmath394 , @xmath395 , be a sequence of hyperkernels on @xmath17 increasing a.e.=1000 to an integrable hyperkernel @xmath33 .",
    "then @xmath396 a.e.=1000 and @xmath397 .",
    "let @xmath394 , @xmath395 , be a sequence of integrable hyperkernels on @xmath17 decreasing a.e.=1000 to @xmath33 .",
    "then @xmath398 a.e.=1000 and @xmath399 .",
    "[ tappc ]    let @xmath394 , @xmath395 , be a sequence of hyperkernels on @xmath17 increasing a.e.=1000 to a hyperkernel @xmath33 .",
    "then , for every @xmath400 , @xmath401 for a.e.=1000 @xmath85 and @xmath402 .",
    "let @xmath394 , @xmath395 , be a sequence of integrable hyperkernels on @xmath17 decreasing a.e.=1000 to @xmath33 .",
    "then , for every @xmath403 , @xmath404 for a.e.=1000 @xmath85 and @xmath405",
    ".    the assumption that @xmath394 be integrable in theorems [ tappb](ii ) and [ tappc](ii ) can be weakened to @xmath406 for a.e .",
    "@xmath85 , where @xmath407 is the expected number of child cliques in @xmath408 of a particle of type @xmath85 ; see @xcite .",
    "we now turn to the local coupling between our random graph and the corresponding branching process , relating the distribution of small components in @xmath34 to the branching process @xmath117 . in  @xcite",
    ", we were essentially forced to condition on the vertex types , since these were allowed to be deterministic to start with . here , with i.i.d .",
    "vertex types , there is no need to do so .",
    "this allows us to couple directly for all bounded hyperkernels , rather than simply for finite type ones .",
    "we shall consider a variant of the usual component exploration process , designed to get around the following problem .",
    "when we test edges from a given vertex @xmath128 to all other vertices , the probability of finding a given edge @xmath409 depends on the type of @xmath410 as well as that of @xmath128 .",
    "hence , _ not _ finding such an edge changes the conditional distribution of the type of @xmath410 . if the kernel is well behaved , it is easy to see that this is a small effect . rather than quantify this ,",
    "it is easier to embed @xmath34 inside a larger random graph with uniform kernels .",
    "testing edges in the larger graph does not affect the conditional distribution of the vertex types ; we make this precise below . in doing so",
    ", it will be useful to take the hypergraph viewpoint : given a hyperkernel @xmath33 , let @xmath411 be the hypergraph on @xmath35 $ ] constructed according to the same rules as @xmath34 , except that instead of adding a @xmath113 we add a hyperedge with @xmath27 vertices .",
    "in fact , we consider the poisson version of the model , allowing multiple copies of the same hyperedge .",
    "let @xmath33 be a bounded hyperkernel , and let @xmath412 be a corresponding upper bound , so @xmath413 is the constant kernel @xmath358 for @xmath361 , and zero for @xmath360 , while @xmath414 holds pointwise for all @xmath27 .",
    "taking , as usual , our vertex types @xmath415 to be independent , each having the distribution @xmath20 , we construct coupled random ( multi-)hypergraphs @xmath416 and @xmath417 on @xmath35 $ ] as follows : first construct @xmath418 by taking , for every @xmath419 , a poisson @xmath420 number of copies of each possible @xmath25-element hyperedge , with all these numbers independent .",
    "although in our formal definition of @xmath417 we first decide the vertex types , @xmath417 is clearly independent of these types .",
    "hence , given @xmath417 , the types are ( still ) i.i.d .  with distribution @xmath20 .",
    "given @xmath417 and the i.i.d .",
    "types @xmath208 of the vertices , we may form @xmath416 by selecting each hyperedge @xmath421 of @xmath422 to be a hyperedge of @xmath416 with probability @xmath423 , independently of all other hyperedges .",
    "it is easy to see that this gives the right distribution for @xmath424 .",
    "( if we disallowed multiple copies of an edge , there would be an irrelevant small correction here . )    turning to the branching processes , there is an analogous coupling of @xmath117 and @xmath425 : first construct @xmath425 , which may be viewed as a single - type process , according to our two - step construction via child cliques . then assign each particle a type according to the distribution @xmath20 , independently of the other particles and of the branching process . then form the child cliques in @xmath117 by keeping each child clique in @xmath425 with an appropriate probability depending on the types , deleting not only the children corresponding to deleted child cliques , but also all their descendants .",
    "let @xmath426 $ ] be chosen uniformly at random , independently of @xmath416 and @xmath422 .",
    "let @xmath427 denote the @xmath428-neighbourhood of @xmath128 in @xmath416 , and @xmath429 that in @xmath422 .",
    "counting the expected number of cycles shows that for any fixed @xmath428 , the hypergraph @xmath430 is whp treelike .",
    "furthermore , standard arguments as for @xmath0 show that one may couple @xmath430 and the first @xmath428 generations of @xmath425 so as to agree in the natural sense whp .",
    "when @xmath430 is treelike , then @xmath431 may be constructed using exactly the same random deletion process that gives ( the first @xmath428 generations of ) @xmath117 as a subset of @xmath425 .",
    "it follows that @xmath432 and the first @xmath428 generations of @xmath117 may be coupled to agree whp .    recalling that @xmath34 and @xmath416 have the same components , for any fixed @xmath400 one can determine whether the component containing @xmath128 has exactly @xmath391 vertices by examining @xmath433 . writing @xmath434 for the number of vertices of a graph @xmath4 that are in components of size @xmath391 , it follows that @xmath435 as in  @xcite",
    ", starting from two random vertices easily gives a corresponding second moment bound , giving convergence in probability .",
    "[ nkbdd ] let @xmath33 be a bounded hyperkernel .",
    "then @xmath436 for any fixed @xmath391 .",
    "of course it makes no difference whether we work with @xmath437 or @xmath438 : lemma  [ nkbdd ] also tells us that @xmath439    the extension to arbitrary hyperkernels is easy from theorem  [ tappc ] .",
    "[ nkint ] let @xmath33 be an integrable hyperkernel .",
    "then for each fixed @xmath391 we have @xmath440    as in  @xcite , we simply approximate @xmath33 by bounded hyperkernels .",
    "for @xmath363 let @xmath364 be the truncated hyperkernel defined by .",
    "let @xmath400 be fixed , and let @xmath441 be arbitrary . from monotone convergence and integrability , @xmath442",
    "so for @xmath358 large enough we have @xmath443 say . by theorem  [ tappc](i ) , increasing @xmath358 if necessary , we may also assume that @xmath444    since @xmath445 holds pointwise , we may couple the hypergraphs @xmath446 and @xmath416 associated to @xmath447 and @xmath34 so that @xmath448 . recall that @xmath34 is produced from @xmath416 by replacing each hyperedge @xmath449 with @xmath25 vertices by an @xmath25-clique .",
    "however , as noted earlier , if we form @xmath450 from @xmath416 by replacing each @xmath449 by any connected simple graph on the same set of vertices , then @xmath450 and @xmath34 will have exactly the same component structure , and in particular @xmath451 .",
    "let us form @xmath450 and @xmath452 in this way from @xmath416 and @xmath446 , replacing any hyperedge with @xmath25 vertices by some tree on the same set of vertices . recalling that @xmath448 ,",
    "we may of course assume that @xmath453 .",
    "writing @xmath454 for the number of @xmath25-vertex hyperedges in a hypergraph @xmath455 , @xmath456    hence , @xmath457 recalling that @xmath453 and noting that adding one edge to a graph can not change @xmath458 by more than @xmath459 , we see that with probability at least @xmath460 we have @xmath461 applying lemma  [ nkbdd ] ( or rather  ) to the bounded hyperkernel @xmath364 , we have @xmath462 . using",
    "it follows that when @xmath1 is large enough , with probability at least @xmath463 , say , we have @xmath464 .",
    "since @xmath441 was arbitrary , we thus have @xmath465 as required .",
    "the local coupling results of the previous section easily give us the ` right ' number of vertices in large components . as usual",
    ", we will pass from this to a giant component by using the ` sprinkling ' method of erds and rnyi  @xcite , first uncovering the bulk of the edges , and then using the remaining ` sprinkled ' edges to join up the large components .",
    "the following lemma gathers together the relevant consequences of the results in the previous section .",
    "[ l_easypart ] let @xmath362 be an integrable hyperkernel , and let @xmath466 . then @xmath467",
    "furthermore , given any @xmath441 , there is a @xmath354 and a function @xmath468 such that @xmath469 holds whp , where @xmath470 .",
    "from lemma  [ nkint ] we have @xmath471 for each fixed @xmath391 .",
    "since @xmath472 as @xmath473 , it follows that for some @xmath474 we have @xmath475 we may and shall assume that @xmath476 . since @xmath477 , the first statement of the lemma follows",
    ".    for the second , we may of course assume that @xmath478 ; otherwise , there is nothing to prove . as @xmath479 , from theorem  [ tappb](i )",
    "we have @xmath480 .",
    "fix @xmath354 with @xmath481 , and let @xmath470 . applying to @xmath452 , there is some @xmath468 such that @xmath482 which implies .    in the light of lemma  [ l_easypart ] , and writing @xmath450 for @xmath34 , to prove theorem  [ th1 ] it suffices to show that if @xmath33 is irreducible , then for any @xmath441 we have @xmath483 whp ; then @xmath484 as required . also , from and the fact that @xmath485 , we obtain @xmath486 as claimed .",
    "since @xmath487 , there is a natural coupling of the graphs @xmath452 and @xmath450 appearing in lemma  [ l_easypart ] in which @xmath453 always holds .",
    "our aim is to show that , whp , in passing from @xmath452 to @xmath450 , the extra ` sprinkled ' edges join up almost all of the @xmath488 vertices of @xmath452 in ` large ' components ( those of size at least @xmath489 ) into a single component .",
    "unfortunately , we have to uncover the vertex types before sprinkling , so we do not have the usual independence between the bulk and sprinkled edges .",
    "a similar problem arose in bollobs , borgs , chayes and riordan  @xcite in the graph context , as opposed to the present hypergraph context .",
    "it turns out that we can easily reduce to the graph case , and thus apply a lemma from  @xcite .",
    "this needs a little setting up , however . here",
    "it will be convenient to take @xmath18 $ ] with @xmath20 lebesgue measure ; as noted in section  [ sec_ir ] , this loses no generality .    let @xmath13 be a bounded symmetric measurable function @xmath490 ^ 2\\to { { \\mathbb r}}$ ] . following frieze and kannan  @xcite , the _ cut norm _",
    "@xmath491 of @xmath13 is defined by @xmath492 }",
    "\\left| \\int_{s\\times t } f(x , y){\\,d}x{\\,d}y\\right|,\\ ] ] where the supremum is taken over all pairs of measurable sets .",
    "note that @xmath493 , since the integral above is bounded by @xmath494 ^ 2}|f|$ ] .    given a kernel @xmath365 on @xmath22",
    "$ ] and a measurable function @xmath495\\to [ 0,1]$ ] , let @xmath496 be the kernel defined by @xmath497 if @xmath498 is a measure - preserving bijection , then @xmath496 is a _ rearrangement _ of @xmath365 .",
    "( one can also consider measure - preserving bijections between subsets of @xmath22 $ ] with full measure ; it makes no difference . )",
    "we write @xmath499 if @xmath500 is a rearrangement of @xmath365 .    given two kernels @xmath365 , @xmath500 on @xmath22 $ ] ,",
    "the _ cut metric _ of borgs , chayes , lovsz , ss and vesztergombi  @xcite is defined by @xmath501 note that this is a pseudo - metric rather than a metric , as we can have @xmath502 for different kernels .",
    "( probabilistically , it is probably more natural to consider couplings between kernels as in  @xcite , rather than rearrangements , but this is harder to describe briefly and turns out to make no difference . )",
    "let @xmath503 be a symmetric @xmath1-by-@xmath1 matrix with non - negative entries @xmath504 , which we may think of as a ( dense ) weighted graph .",
    "there is a piecewise - constant kernel @xmath505 associated to @xmath503 ; this simply takes the value @xmath504 on the square @xmath506\\times ( ( j-1)/n , j / n]$ ] , @xmath507 .",
    "there is also a sparse random graph @xmath508 associated to @xmath503 ; this is the graph on @xmath35 $ ] in which edges are present independently , and the probability that @xmath509 is an edge is @xmath510 .",
    "( if @xmath503 has non - zero diagonal entries then @xmath508 may contain loops .",
    "these are irrelevant here . )    the main result of bollobs , borgs , chayes and riordan  @xcite is that if @xmath365 is an irreducible bounded kernel and @xmath511 is a sequence of matrices with uniformly bounded entries such that @xmath512 , then the normalized size of the giant component in @xmath508 converges in probability to @xmath513 .",
    "the sprinkling argument there relies on the following lemma concerning the graph @xmath514 , in which edges are present independently .",
    "[ l_bbcr ] let @xmath365 be an irreducible bounded kernel on @xmath22 $ ] , and @xmath515 and @xmath516 positive constants .",
    "there is a constant @xmath517 such that whenever @xmath503 is a sequence of symmetric matrices with entries in @xmath518 $ ] with @xmath512 , then for sufficiently large @xmath1 we have @xmath519 for all disjoint @xmath520 , @xmath521 $ ] with @xmath522 , where @xmath523 denotes the event that @xmath508 contains a path starting in @xmath520 and ending in @xmath524 .    in fact , this lemma",
    "is not stated explicitly in  @xcite , but this is exactly the content of the end of section 3 there ; for an explicit statement and proof of ( a stronger version of ) this lemma see  ( * ? ? ?",
    "* lemma 2.14 ) .",
    "we shall apply lemma  [ l_bbcr ] to graphs @xmath508 corresponding to ( subgraphs of ) @xmath525 , where @xmath515 is as in lemma  [ l_easypart ] . to achieve independence between edges , we shall simply take only one edge from each hyperedge . unfortunately , the problem of conditioning on the @xmath89 still remains ; we shall return to this shortly .",
    "let @xmath33 be an integrable hyperkernel and let @xmath416 be the poisson ( multi-)hypergraph corresponding to @xmath34 .",
    "given the sequence @xmath37 , let @xmath526 be the random ( multi-)graph formed from @xmath416 by replacing each @xmath25-vertex hyperedge @xmath449 by a single edge , chosen uniformly at random from the @xmath527 edges corresponding to @xmath449 .",
    "with @xmath71 fixed , the numbers of copies of each edge @xmath449 in @xmath416 are independent poisson random variables . from basic properties of poisson processes",
    ", it follows that , with @xmath71 fixed , the number of copies of each edge @xmath509 in @xmath526 are also independent poisson random variables .",
    "our next aim is to calculate the edge probabilities in @xmath526 .    as usual , we write @xmath528 for the _ falling factorial _ @xmath529 . given @xmath530 and distinct @xmath531 $ ] , for @xmath532 let @xmath533 where the sum runs over all @xmath534 sequences @xmath535 of distinct indices in @xmath35\\setminus{\\ensuremath{\\{i ,",
    "j\\}}}$ ] , and let @xmath536 be the @xmath1-by-@xmath1 matrix with entries @xmath537 for @xmath538 and @xmath539 if @xmath540 .",
    "with @xmath71 given , the expected number of @xmath25-vertex hyperedges in @xmath416 containing @xmath509 is @xmath541 .",
    "hence the expected number of @xmath509 edges in @xmath526 is exactly @xmath510 .",
    "now @xmath504 clearly depends on @xmath89 and @xmath90 .",
    "unfortunately , it also depends on all the other @xmath542 .",
    "the next lemma will show that the latter dependence can be neglected .",
    "set @xmath543 and let @xmath544 be the ` re - scaled ' edge kernel defined by @xmath545 comparing with the formula for @xmath546 , note that we have divided each term in the sum in by @xmath547 , the number of edges in @xmath113 . note that @xmath548    recall that @xmath549 and @xmath504 depend on the random sequence @xmath71 . in the next lemma ,",
    "the expectation is over the random choice of @xmath71 ; no graphs appear at this stage .",
    "[ la ] let @xmath356 be an integrable hyperkernel .",
    "then @xmath550 for every @xmath25 , and @xmath551    we have @xmath552    suppose first that @xmath202 is bounded .",
    "let @xmath553 where the sum again runs over all @xmath534 sequences @xmath535 of distinct indices in @xmath35\\setminus{\\ensuremath{\\{i , j\\}}}$ ] . given @xmath89 and @xmath90 , each term in the sum has mean 0 , and any two terms with disjoint index sets @xmath554 are independent .",
    "since there are @xmath555 pairs of terms with overlapping index sets , and @xmath202 is bounded , we have @xmath556 thus @xmath557 .",
    "hence , by the cauchy ",
    "schwarz inequality , @xmath558 , and so @xmath559 this proves and thus for bounded hyperkernels .",
    "for general hyperkernels , we use truncation and define @xmath560 by .",
    "for the corresponding @xmath561 , @xmath562 and @xmath563 , @xmath564 since @xmath170 is integrable , given any @xmath441 we can make these expected differences less than @xmath565 by choosing @xmath358 large enough , and the result follows from the bounded case .    with the preparation above we are now ready to prove theorem  [ th1 ] .",
    "we assume without loss of generality that @xmath18 $ ] , with @xmath20 lebesgue measure .",
    "let @xmath192 be an irreducible , integrable kernel family , let @xmath356 be the corresponding hyperkernel , given by , and let @xmath441 .",
    "as noted after lemma  [ l_easypart ] , in the light of this lemma , it suffices to prove the lower bound on @xmath566 .",
    "we may and shall assume that @xmath198 and @xmath567 , say .",
    "let @xmath354 and @xmath568 be as in lemma  [ l_easypart ] , and let @xmath416 , @xmath446 and @xmath569 be the poisson multi - hypergraphs associated to the hyperkernels @xmath33 , @xmath570 and @xmath571 , respectively . using the same vertex types @xmath37 for all three hypergraphs , there is a natural coupling in which @xmath572 , with @xmath446 and @xmath569 _ conditionally _ independent given @xmath71 .",
    "define @xmath536 and @xmath544 by and , respectively , starting from the integrable hyperkernel @xmath571 .",
    "note that @xmath544 is a kernel on @xmath22 $ ] , while @xmath536 is an @xmath1-by-@xmath1 matrix _ that depends on @xmath71_. recall from that @xmath573 if and only if @xmath574 , so @xmath544 is irreducible . in order to be able to apply lemma  [ l_bbcr ] , we would like to work with a bounded kernel and matrices that are bounded uniformly in @xmath1 .",
    "we achieve this simply by considering @xmath575 and @xmath576 defined by @xmath577    let @xmath578 be the ( random ) ` sampled ' matrix corresponding to @xmath544 , defined by @xmath579 and let @xmath580 be the corresponding matrix associated to @xmath576 .",
    "the second statement of lemma  [ la ] tells us exactly that @xmath581 where the expectation is over the random choice of @xmath71 . since @xmath582 for @xmath538 , while @xmath583 , it follows that @xmath584 or , equivalently , that @xmath585 , where we write @xmath586 for the piecewise constant kernel @xmath587 ^ 2\\to{{\\mathbb r}}$ ] associated to a matrix @xmath358 .    since @xmath588",
    ", it follows that @xmath589 , and hence that @xmath590 .",
    "coupling the random sequences @xmath71 for different @xmath1 appropriately , we may and shall assume that @xmath591 almost surely .",
    "since @xmath576 is a bounded kernel on @xmath22 $ ] , i.e. , a ` graphon ' in the terminology of  @xcite , theorem 4.7 of borgs , chayes , lovsz , ss and vesztergombi  @xcite tells us that with probability at least @xmath592 , we have @xmath593 .",
    "it follows that @xmath594 both in probability and almost surely .",
    "using , we see that @xmath595 almost surely . note that @xmath596 depends on the sequences @xmath71 .",
    "let @xmath452 and @xmath450 be the simple graphs underlying @xmath446 and @xmath416 . from lemma  [ l_easypart ] , holds whp . for the rest of the proof , _",
    "we condition on @xmath71 and on @xmath446_. we assume , as we may , that holds for all large enough @xmath1 , and that holds .",
    "it suffices to show that with _ conditional _",
    "probability @xmath597 we have @xmath598 .",
    "recall that , given @xmath71 , the ( multi-)hypergraphs @xmath446 and @xmath569 are independent , so after our conditioning ( on @xmath71 and @xmath446 ) , the hypergraph @xmath569 is formed by selecting each @xmath25-tuple @xmath599 to be an edge independently , with probability @xmath600 .",
    "let @xmath601 be the random ( multi-)graph defined from @xmath569 by taking one edge from each hyperedge as in definition  [ gnkdef ] , noting that @xmath602 . since we have conditioned on @xmath71 ( and @xmath452 ) , as noted after definition  [ gnkdef ] , each possible edge @xmath509 is present in @xmath603 independently . in the multi - graph version ,",
    "the number of copies of @xmath509 is poisson with mean @xmath510 . passing to a subgraph",
    ", we shall take instead the number of copies to be poisson with mean @xmath604 . since this mean is @xmath605 , the probability that one or more copies of @xmath509 is present is @xmath606 , where @xmath607 .",
    "since @xmath608 , we have @xmath609 .",
    "since @xmath576 is an irreducible bounded kernel , the ( simple graphs underlying ) @xmath603 satisfy the assumptions of lemma  [ l_bbcr ] , so there is a constant @xmath610 such that for any two set @xmath520 , @xmath524 of at least @xmath611 vertices of @xmath603 , the probability that @xmath520 and @xmath524 are _ not _ joined by a path in @xmath603 is at most @xmath612 .",
    "recall that we have conditioned on @xmath452 , assuming .",
    "suppose also that @xmath613 .",
    "then there is a partition @xmath614 of the set of vertices of @xmath452 in large components in @xmath452 with @xmath615 such that there is no path in @xmath450 from @xmath616 to @xmath617 .",
    "let us call such partition @xmath614 a _",
    "bad partition_. having conditioned on @xmath452 , noting that in any potential bad partition @xmath616 must be a union of large components of @xmath452 , the number of possible choices for @xmath614 is at most @xmath618 . on the other hand , since @xmath619 , the probability that any given partition is bad is at most @xmath612 , so the expected number of bad partitions is @xmath620 , and whp there is no bad partition .",
    "thus @xmath621 holds whp , as required .",
    "[ r_red ] the restriction to irreducible kernel families in theorem  [ th1 ] is of course necessary ; roughly speaking , if @xmath33 is reducible , then our graph @xmath34 falls into two or more parts .",
    "lemma  [ l_easypart ] still applies to show that we have @xmath622 vertices in large components , but it may be that two or more parts have giant components , each of smaller order than @xmath623 .",
    "more precisely , let @xmath33 be a reducible , integrable kernel family .",
    "thus the edge kernel @xmath81 is reducible . by lemma 5.17 of  @xcite",
    ", there is a partition @xmath624 , @xmath625 , of our ground space @xmath21 ( usually @xmath22 $ ] ) such that each @xmath626 is measurable , the restriction of @xmath81 to @xmath626 is irreducible ( in the natural sense ) , and , apart from a measure zero set , @xmath81 is zero off @xmath627 .    suppressing the dependence on @xmath1 ,",
    "let @xmath628 be the subgraph of @xmath34 induced by the vertices with types in @xmath626 . since the vertex types are i.i.d .",
    ", the probability that @xmath34 contains any edges other than those of @xmath629 is 0 .",
    "now @xmath628 has a random number @xmath630 of vertices , with a binomial @xmath631 distribution , which is concentrated around its mean .",
    "given @xmath630 , the graph @xmath628 is another instance of our model .",
    "let @xmath632 , so that @xmath633 . from the remarks above it is easy to check that theorem  [ th1 ] gives @xmath634 and @xmath635 ; we omit the details . sorting the @xmath636 into decreasing order @xmath637",
    ", it follows that @xmath638 for each fixed ( finite ) @xmath639 , in particular , for @xmath640 and @xmath641 .",
    "one of the most studied features of the various inhomogeneous network models is their ` robustness ' under random failures , and in particular , the critical point for site or bond percolation on these random graphs .",
    "for example , this property of the barabsi  albert  @xcite model was studied experimentally by barabsi , albert and jeong  @xcite , heuristically by callaway , newman , strogatz and watts  @xcite ( see also  @xcite ) and cohen , erez , ben - avraham and havlin  @xcite , and rigorously in  @xcite . in the present context , given @xmath642 , we would like to study the random subgraphs @xmath643 and @xmath644}}(n,{{\\undertilde{{\\kappa}}}})$ ] of @xmath34 obtained by deleting edges or vertices respectively , keeping each edge or vertex with probability @xmath60 , independently of the others . in the edge - only model of  @xcite , these graphs were essentially equivalent to other instances of the same model : roughly speaking , @xmath645 and @xmath644}}(n,{\\kappa}){\\cong}g(pn , p{\\kappa})$ ] .",
    "( for precise statements , see  ( * ? ? ?",
    "* section 4 ) . )    here , the situation is a little more complex . when we delete edges randomly from @xmath34",
    ", it may be that what is left of a particular atom @xmath31 is disconnected .",
    "this forces us to consider _ generalized kernel families _",
    "@xmath646 with one kernel @xmath28 for each @xmath647 , where the set @xmath648 consists of one representative of each isomorphism class of finite ( not necessarily connected ) graphs .    rather than present a formal statement ,",
    "let us consider a particular example .",
    "suppose that @xmath33 is the generalized kernel family with only one kernel @xmath28 , corresponding to the disjoint union @xmath31 of @xmath649 and @xmath650 .",
    "let @xmath651 be the kernel family with two kernels , @xmath652 corresponding to @xmath649 and @xmath653 for @xmath650 .",
    "then @xmath34 and @xmath654 are clearly very similar ; the main differences are that @xmath34 contains exactly the same number of added triangles and @xmath650s , whereas in @xmath654 the numbers are only asymptotically equal , and that in @xmath34 a triangle and a @xmath650 added in one step are necessarily disjoint . since almost all pairs of triangles and @xmath650s in @xmath654 are disjoint anyway , it is not hard to check that @xmath34 and @xmath654 are ` locally equivalent ' , in that the neighbourhoods of a random vertex in the two graphs can be coupled to agree up to a fixed size whp .    more generally , given a generalized kernel family @xmath655 , let @xmath651 be the kernel family obtained by replacing each kernel @xmath28 by one kernel for each component @xmath656 of @xmath31 , obtained by integrating over variables corresponding to vertices of @xmath657 as above",
    ". this may produce several new kernels for a given connected @xmath656 ; we of course simply add these together to produce a single kernel @xmath658 .",
    "note that @xmath659 so if @xmath33 is integrable , then so is @xmath651 . although @xmath34 and @xmath654 are not exactly equivalent , the truncation and local approximation arguments used to prove theorem  [ th1 ] carry over easily to give the following result .",
    "[ th_disc ] let @xmath655 be a generalized kernel family , let @xmath651 be the corresponding kernel family as defined above , and let @xmath660 be the hyperkernel corresponding to @xmath651 , defined by . if @xmath651 is irreducible , then @xmath661 and @xmath662 .",
    "note that the hyperkernel @xmath663 corresponding to @xmath651 is obtained by replacing each ( now connected , as before ) atom @xmath656 by a clique ; this corresponds to replacing each _ component _ of an atom @xmath31 in @xmath34 by a clique .    turning to bond percolation on @xmath34 ,",
    "i.e. , to the study of the random subgraph @xmath643 of @xmath34 , let @xmath664 be the kernel family obtained by replacing each kernel @xmath28 by @xmath665 kernels @xmath666 , one for each spanning subgraph of @xmath31 .",
    "( as before , we then combine kernels corresponding to isomorphic graphs @xmath656 . )",
    "working work with the poisson multigraph formulation of our model , the graphs @xmath643 and @xmath667 have exactly the same distribution .",
    "this observation and theorem  [ th_disc ] allow us ( in principle , at least ) to decide whether @xmath643 has a giant component , i.e. , to find the critical point for bond percolation on @xmath34 .",
    "let us illustrate this with the very simple special case in which each kernel @xmath28 , @xmath668 , is constant , say @xmath669 .",
    "we assume that @xmath33 is integrable , i.e. , that @xmath670 . in this case",
    "each kernel @xmath671 making up @xmath664 is also constant , and the same applies to the hyperkernel @xmath663 corresponding to @xmath664 .",
    "hence , from the remarks above and , @xmath643 has a giant component if and only if the asymptotic edge density @xmath672 of the hyperkernel @xmath663 is at least @xmath673 .",
    "since we obtain @xmath663 by first taking random subgraphs of our original atoms @xmath31 , and then replacing each component by a clique , we see that @xmath674 where @xmath675 is the expected number of unordered pairs of distinct vertices of @xmath31 that lie in the same component of the random subgraph @xmath676 of @xmath31 obtained by keeping each edge with probability @xmath60 , independently of the others .",
    "alternatively , @xmath677 where @xmath678 is the _ susceptibility _ of @xmath676 , i.e. , the expected size of the component of a random vertex of @xmath676 .",
    "if we have only a finite number of non - zero @xmath679 , then @xmath672 may be evaluated as a polynomial in @xmath60 , and the critical point found exactly .    turning to site percolation ,",
    "there is a similar reduction to another instance of our model , most easily described by modifying the type space .",
    "indeed , we add a new type @xmath680 corresponding to deleted vertices , and set @xmath681 . setting @xmath682 for @xmath180",
    ", we obtain a probability measure @xmath683 on @xmath684 . replacing each kernel @xmath28 by @xmath685 kernels @xmath686 on @xmath687 defined appropriately ( with @xmath656 corresponding to the subgraph of @xmath31 spanned by the non - deleted vertices )",
    ", one can show that @xmath644}}(n,{{\\undertilde{{\\kappa}}}})$ ] is very close to ( in the poisson version , identical to ) a suitable instance @xmath688 of our model , where @xmath689 is now random but concentrated around its mean @xmath690 . in the first instance @xmath651",
    "may include kernels for disconnected graphs , but as above we can find an asymptotically equivalent kernel family involving only connected graphs . in this way one can find the asymptotic size of any giant component in @xmath644}}(n,{{\\undertilde{{\\kappa}}}})$ ] ; we omit the mathematically straightforward but notationally complex details .",
    "heuristically , the vertex degrees in @xmath169 can be described as follows .",
    "consider a vertex @xmath128 and condition on its type @xmath691 .",
    "the number of atoms that contain @xmath128 then is asymptotically poisson with a certain mean depending on @xmath33 and @xmath691 .",
    "however , each atom may add several edges to the vertex @xmath128 , and thus the asymptotic distribution of the vertex degree is compound poisson ( see below for a definition ) .",
    "moreover , this compound poisson distribution typically depends on the type @xmath691 , so the final result is that , asymptotically , the vertex degrees have a mixed compound poisson distribution . in this section",
    "we shall make this precise and rigorous .",
    "we begin with some definitions .",
    "if @xmath692 is a finite measure on @xmath693 , then @xmath694 , the _ compound poisson distribution with intensity @xmath692 _ , is defined as the distribution of @xmath695 , where @xmath696 are independent poisson random variables .",
    "equivalently , @xmath694 is the distribution of the sum @xmath697 of the points of a poisson process @xmath698 on @xmath693 with intensity @xmath692 , regarded as a multiset .",
    "( the latter definition generalizes to arbitrary measures @xmath692 on @xmath699 such that @xmath700 , but we consider in this paper only the integer case . )",
    "since @xmath701 has probability generating function @xmath702 , @xmath694 has probability generating function@xmath703 whenever this is defined , which it certainly is for @xmath704 .",
    "if @xmath705 is a random finite measure on @xmath693 , then @xmath706 denotes the corresponding _",
    "mixed compound poisson distribution_. from now on , for each @xmath131 , @xmath707 will be a finite measure on @xmath693 , depending measurably on @xmath85 .",
    "we shall write @xmath705 for the corresponding random measure on @xmath693 , obtained by choosing @xmath85 from @xmath21 according to the distribution @xmath20 and then taking @xmath707 . thus @xmath706 is defined by the point probabilities @xmath708 or , equivalently , the probability generating function@xmath709    [ rcpo ] since we have assumed that @xmath692 is a finite measure , @xmath710 ; thus a.s .",
    "@xmath711 and only finitely many @xmath701 are non - zero , whence @xmath712 a.s .",
    "this verifies that @xmath694 is a proper probability distribution . on the other hand ,",
    "the mean of @xmath694 is @xmath713 which may be infinite . as a consequence , @xmath714    let @xmath715 denote the total variation distance between two random variables , or rather their probability distributions , defined by @xmath716 where the supremum is taken over all measurable sets @xmath717",
    ". we shall use the following trivial upper bound on the total variation distance between two compound poisson distributions .",
    "[ lb ] if @xmath692 and @xmath718 are two finite measures on @xmath693 , then @xmath719    let @xmath696 be as above and let @xmath720 be another family of independent poisson variables .",
    "we can easily couple the families so that @xmath721 for every @xmath72 .",
    "then @xmath722    given an integrable kernel family @xmath33 and @xmath131 , @xmath182 and @xmath723 $ ] , let @xmath724 be the ( asymptotic ) expected number of added copies of @xmath31 containing a given vertex of type @xmath85 in which the given vertex corresponds to vertex @xmath72 in @xmath31 .",
    "let @xmath725 be the degree of vertex @xmath72 in @xmath31 , and define the measure @xmath726 where , as usual , @xmath727 denotes the probability measure assigning mass 1 to @xmath428 .",
    "thus @xmath707 is a measure on @xmath693 , with point masses given by @xmath728 the ( asymptotic ) expected number of atoms containing a given vertex of type @xmath85 and having degree @xmath428 there . from , @xmath729 , and thus by @xmath730 consequently , @xmath707 is a finite measure on @xmath693 for a.e .",
    "@xmath85 , and the mixed compound poisson distribution @xmath706 is defined .",
    "let the random variable @xmath731 be the degree of any fixed vertex in @xmath34 .",
    "equivalently , by symmetry , we can take @xmath732 to be the degree of a uniformly random vertex . furthermore",
    ", for @xmath733 , let @xmath734 be the number of vertices with degree @xmath735 in @xmath34 .",
    "then the random sequence @xmath736 can be regarded as a ( random ) probability distribution , viz .",
    ", the conditional distribution of the degree of a random vertex in @xmath34 , given this random graph .",
    "note that @xmath737 .",
    "[ tdegree ] suppose that @xmath32 is an integrable kernel family . then , as @xmath96 ,    [ tda ] @xmath738 , and    [ tdc ] @xmath739    [ tdb ] moreover , for every fixed @xmath735 , @xmath740 and thus @xmath741 in the space of probability measures on @xmath693 .",
    "note that the limit distribution exists for every integrable kernel family , but has finite expectation only if the kernel family is edge integrable .    as usual , theorem  [ tdegree ] applies to the variants of the model @xmath34 discussed in section  [ sec_ir ] . in the proof",
    ", we shall mostly work with the ( non - poisson ) multi - graph form , where we add at most one copy of a certain small graph @xmath31 with a particular vertex set , but keep any resulting multiple edges .",
    "assume first that @xmath33 is a bounded kernel family , with @xmath742 and @xmath743 if @xmath744 .",
    "fix a vertex @xmath745 $ ] , and let @xmath746 be the degree of @xmath128 . for",
    "@xmath182 with @xmath747 and @xmath748 , let @xmath749 be the number of added copies of @xmath31 that contain @xmath128 with @xmath128 corresponding to vertex @xmath72 in @xmath31 .",
    "let @xmath750 this is the number of edges added to @xmath128 , including possible repetitions . thus",
    "@xmath751 unless two added edges with endpoint @xmath128 coincide . for any other vertex @xmath410 , conditioned on the types @xmath37 ,",
    "the number of atoms containing both @xmath128 and @xmath410 is a sum @xmath752 of independent bernoulli variables @xmath753 , for @xmath754 in some index set . for each @xmath755",
    "there are @xmath756 such variables , each with @xmath757 .",
    "hence , @xmath758 since there are @xmath759 possible choices for @xmath410 , it follows that @xmath760 hence , in proving [ tda ] , it makes no difference whether we work with @xmath761 or with @xmath746 , i.e. , with the multi - graph or simple graph version of @xmath34 .",
    "conditioned on @xmath71 , @xmath749 is a sum of independent bernoulli variables @xmath762 for @xmath763 in some index set @xmath764 , with @xmath765 given by and @xmath766 .",
    "let @xmath767 . by a classical poisson approximation theorem ( see ( * ? ? ?",
    "* ( 1.8 ) ) ) , @xmath768 ( this follows easily from the elementary @xmath769 ; see e.g.  ( * ? ? ? * and theorem 2.m ) for history and further results . )",
    "furthermore , given @xmath71 , the random variables @xmath749 are independent , and thus and imply that if @xmath770 are independent , then @xmath771 since @xmath772 has a compound poisson distribution @xmath773 with intensity @xmath774 , we have @xmath775 by and lemma  [ lb ] , this yields @xmath776 in particular , for every @xmath777 , taking @xmath778 in , @xmath779 taking the expectation of both sides , and noting that @xmath780 and @xmath781 , we find that @xmath782 we shall show that the final term is small .    by , with @xmath183 , @xmath783 where the sum runs over all @xmath784 sequences @xmath785 of distinct elements in",
    "@xmath35 $ ] with @xmath786 . consequently , by , @xmath787 recalling that @xmath33 is bounded , it is easy to check ( as in the similar argument in the proof of lemma  [ la ] ) that @xmath788 and thus , by the cauchy ",
    "schwarz inequality and , @xmath789 consequently , using again that @xmath33 is bounded , @xmath790 so @xmath791 combining and we see that @xmath792 for every @xmath735 , i.e. , @xmath793 , which proves [ tda ] for bounded @xmath33 .",
    "next we turn to the proof of [ tdb ] , assuming still that @xmath33 is bounded .",
    "fix a number @xmath777 , and for @xmath745 $ ] let @xmath794 be the degree of @xmath128 in @xmath34 , and @xmath795 the indicator @xmath796}$ ] .",
    "fix two distinct vertices @xmath128 and @xmath410 , let @xmath797 be the set of atoms that contain both @xmath128 and @xmath410 , and let @xmath798 and @xmath799 be the degrees of the vertices if we delete ( or ignore ) the atoms in @xmath797 .",
    "since @xmath33 bounded , the expected number @xmath800 of such exceptional atoms is @xmath801 , and thus @xmath802 moreover , these bounds hold conditional on @xmath71 . furthermore , given @xmath71 , @xmath798 and @xmath799 are independent . consequently , for any @xmath777 , @xmath803 and thus @xmath804 . since @xmath805 , it follows that @xmath806 and thus @xmath807 further , if we write @xmath808 and sum ( where @xmath809 ) over @xmath128 , we obtain @xmath810 by , the right - hand side has expectation @xmath811 and",
    "thus @xmath812 now @xmath813 are i.i.d .",
    "random variables with mean @xmath814 hence , by the law of large numbers , @xmath815 , which is the same as @xmath816 the result follows from , , .",
    "furthermore , says that @xmath817 in the space @xmath818 of sequences , equipped with the product topology , which is the same as separate convergence of the components .",
    "however , it is well - known , and easy to see ( e.g.  by compactness ) that restricted to the set of probability distributions , this equals the standard topology there .",
    "we have proved [ tda ] and [ tdb ] for bounded @xmath33 . for general @xmath33",
    "we use truncations : define @xmath819 in analogy with , setting @xmath820 for @xmath371 and @xmath821 for @xmath822 .",
    "we use @xmath823 , @xmath824 and so on to denote quantities defined for @xmath447 . for fixed @xmath358 , applying for the bounded kernel family @xmath364 , we have @xmath825 as @xmath11 , and thus by dominated convergence @xmath826 furthermore , for every @xmath131 and @xmath827 , the intensities @xmath828 converge to @xmath829 as @xmath830 , by , and monotone convergence .",
    "thus a simple coupling shows that @xmath831 as @xmath830 .",
    "we may couple @xmath169 and @xmath832 in the obvious way so that @xmath169 is obtained from @xmath832 by adding further atoms , say @xmath833 copies of each @xmath182 .",
    "then @xmath834 , and since at most @xmath835 vertices are affected by the extra additions , @xmath836 the right hand side is independent of @xmath1 , and tends to 0 as @xmath837 by dominated convergence and our assumption that @xmath33 is integrable . for any @xmath441 , we may thus choose @xmath358 so large that the right hand side of is less than @xmath565 , and also so that @xmath838 ; then by , for large enough @xmath1 , @xmath839 which proves and thus [ tdb ] .",
    "further , and dominated convergence yields @xmath840 , which proves [ tda ] .    finally we prove [ tdc ] .",
    "( this could also easily be done directly in a fairly straightforward way . ) first , and yield @xmath841 which yields the formula for @xmath842 claimed in the theorem , since @xmath843 .",
    "next , the convergence in distribution [ tda ] yields ( by a version of fatou s lemma ) the inequality @xmath844 .",
    "finally , recalling the definition of @xmath845 ( denoted @xmath761 in ) , we have @xmath846 and thus @xmath847 yielding the opposite inequality @xmath848 .",
    "part [ tdc ] of theorem  [ tdegree ] is not surprising .",
    "also , since by symmetry @xmath849 , it follows from theorem  [ tedges ] ( which we shall not prove until the next section ) . for bounded kernel families , it is easy to see that also higher moments of @xmath850 converge to the corresponding moments of @xmath706 , for example by first showing that @xmath851 for every fixed @xmath852 and combining this with [ tda ] .",
    "this extends to certain unbounded kernel families , but somewhat surprisingly not to all integrable kernel families , as the following example shows .",
    "[ badp2 ] let @xmath853 with lebesgue measure , and regard @xmath21 as a circle with the usual metric @xmath854 .",
    "we construct our random graph by adding triangles only ; thus @xmath743 for @xmath855 , and we take @xmath856 for some small @xmath441 , for example @xmath857 . clearly , @xmath33 is an integrable kernel family ( and a hyperkernel ) .",
    "let @xmath858 be the minimal spacing between the @xmath1 independent uniformly distributed random points @xmath89 , @xmath859 .",
    "it is well - known that this minimal spacing is of order @xmath860 ; in fact , it is easy to see that for @xmath861 we have @xmath862 , and in particular @xmath863 whp .",
    "hence there exist whp two distinct indices @xmath41 and @xmath72 with @xmath864 , and thus , for large @xmath1 and every @xmath542 , @xmath865 .",
    "if @xmath41 and @xmath72 are chosen such that this holds , then from we have @xmath866 for all @xmath867 , and thus the number of @xmath391 such that the triangle @xmath868 is an atom stochastically dominates the binomial distribution @xmath869 ; hence this number is whp at least @xmath870 .",
    "we have shown that whp there are at least two vertices @xmath41 and @xmath72 with degrees @xmath871 , and thus , for large @xmath1 , @xmath872 .",
    "consequently , for large @xmath1 , @xmath873    on the other hand , for some finite @xmath874 , by symmetry , @xmath875 and @xmath876 .",
    "hence @xmath877 , which is the distribution of @xmath878 with @xmath879 , which has all moments finite .    as we shall see in theorem  [ th_reg ] , this situation can not arise in the edge - only version of the model , i.e. , the model in  @xcite ; in the terminology of the next section , all copies of @xmath880 are then ` regular '",
    ".    in section  [ sec_pl ] we shall illustrate theorem  [ tdegree ] by giving a natural family of examples with degree distributions with power - law tails .",
    "in this section we turn to the final general property of @xmath34 we shall study , the asymptotic number of copies of a fixed graph @xmath31 in @xmath34 ; throughout this section , @xmath33 denotes a kernel family @xmath178 , rather than a hyperkernel .",
    "we work with the multi - graph version of the model .",
    "although mathematically not as interesting as the phase transition , the number of small graphs in @xmath34 is important as it is directly related to the original motivation for the model . indeed , recall that perhaps the main defect of the model of  @xcite , i.e. , the edge - only case of the present model , is that it produces graphs with very few ( usually @xmath881 ) triangles , i.e. , graphs with clustering coefficients that are essentially zero .",
    "this contrasts strongly with many of the real - world networks we wish to model .",
    "the simplest way that a copy of some graph @xmath31 may arise in @xmath34 is as an atom .",
    "the expected number of such copies is simply @xmath882    the next simplest way that a copy of @xmath31 may arise is as a subgraph of some atom @xmath656 of @xmath34 .",
    "let us call such copies of @xmath31 _ direct _ ; we include the case @xmath883 .",
    "let @xmath884 denote the number of subgraphs of @xmath656 isomorphic to @xmath31 , so @xmath885 , for example .",
    "set @xmath886 and let @xmath887 denote the number of direct copies of @xmath31 in @xmath34 . then from we see that @xmath888 and that if @xmath33 is bounded , then @xmath889 the reason for the somewhat peculiar notation @xmath890 is as follows : the subscript @xmath45 indicates direct copies ( arising from only one atom )",
    ". the tilde will be useful later to differentiate from standard notation @xmath891 in other contexts .",
    "it will turn out that in well behaved cases ( for example for all bounded kernel families ) , essentially all copies of any @xmath892-connected graph @xmath31 in @xmath34 arise directly . unfortunately , this is not the case for general @xmath31 .",
    "perhaps the main special cases we are interested in are stars ; the number of copies of the star @xmath893 ( i.e. , the path @xmath880 ) is needed to calculate the clustering coefficient , for example . note that the number of copies of the star @xmath894 ( @xmath895 ) in any graph @xmath4 is simply @xmath896 times the @xmath391th factorial moment of the degree of a random vertex ; hence counting stars is closely related to studying the degree distribution , which we did for @xmath34 in section  [ sec_degrees ] .",
    "let us say that a copy of @xmath31 in @xmath34 arises _ indirectly _ if it contains edges of at least two of the atoms making up @xmath34 . to understand the expected number of such copies we first need to understand the probability that a certain set of vertices form a copy of @xmath31 _ given the types of the vertices_. more",
    "precisely , we consider the expectation of the number of copies of @xmath31 with a given vertex set , even though this number is highly unlikely to exceed 1 .",
    "let @xmath31 be a connected graph with @xmath25 vertices .",
    "let @xmath897 denote the number of _ embeddings _ of @xmath31 into @xmath656 , i.e. , the number of injective homomorphisms from @xmath31 to @xmath656 , so @xmath898 .",
    "fixing a labelling of @xmath31 , let @xmath899 denote the number of copies of @xmath31 in a multigraph @xmath4 with vertex @xmath41 of @xmath31 corresponding to vertex @xmath41 of @xmath4 .",
    "( thus @xmath899 is @xmath118 or @xmath45 if @xmath4 is simple . )",
    "the contribution to @xmath900 from copies of @xmath31 arising as subgraphs of atoms isomorphic to a given @xmath656 with @xmath901 vertices is exactly @xmath902 where @xmath498 runs over all @xmath897 embeddings of @xmath31 into @xmath656 , we take @xmath903 if @xmath904 , and we integrate over the remaining @xmath905 variables @xmath906 .    set @xmath907 then we have @xmath908 and if @xmath33 is bounded then the relative error is @xmath909 .    comparing and ,",
    "note that if @xmath910 , then @xmath911 . before continuing ,",
    "let us comment on the normalization . recall that in defining @xmath34 , we consider all @xmath912 possible ways of adding a ( labelled ) copy of @xmath31 on vertex set @xmath913 , say , adding each copy with probability @xmath914 .",
    "this means that the contribution from @xmath28 to @xmath915 is @xmath916 , and , correspondingly , the contribution from @xmath28 to @xmath917 is @xmath918 . in other words , while having the same form as a kernel , @xmath917 is normalized differently .",
    "this situation arises already in the edge - only case , where @xmath919 .",
    "it turns out that here the normalization of @xmath917 , giving directly the probability that a certain set of edges forming a copy of @xmath31 is present , is the natural one .",
    "note that if we had used this normalization from the beginning , then formulae such as would have extra factors .",
    "let @xmath31 be a connected graph with vertex set @xmath110 $ ] .",
    "we say that a set @xmath920 of connected graphs forms a _ tree decomposition _ of @xmath31",
    "if each @xmath921 is connected , the union of the @xmath921 is exactly @xmath31 , any two of the @xmath921 share at most one vertex , and the @xmath921 intersect in a tree - like structure .",
    "the last condition may be expressed by saying that the @xmath921 may be ordered so that each @xmath922 other than the first meets the union of the previous ones in exactly one vertex .",
    "equivalently , the intersection is tree - like if @xmath923 .",
    "equivalently , defining ( as usual ) a _ block _ of a graph @xmath4 to be either a maximal 2-connected subgraph of @xmath4 or a bridge in @xmath4 , @xmath920 forms a tree composition of @xmath31 if each @xmath921 is a connected union of one or more blocks of @xmath31 , with each block contained in exactly one @xmath921 .",
    "( cf .  @xcite . )",
    "note that we allow @xmath924 , in which case @xmath925 .",
    "for @xmath926 , the order of the factors is irrelevant , so , for example , @xmath893 has a unique non - trivial tree decomposition , into two edges .",
    "note also that if @xmath31 is 2-connected , then it has only the trivial tree decomposition .",
    "let us say that a copy of @xmath31 in @xmath927 if _ regular _ if it is the union of graphs @xmath920 forming a tree decomposition of @xmath31 , where each @xmath921 arises directly as a subgraph of some atom @xmath928 , and @xmath929 for all @xmath538 ( with this intersection containing at most one vertex ) .",
    "we can write down exactly the probability that @xmath34 contains a regular copy of @xmath31 with vertex set @xmath930 in terms of certain integrals of products of conditional expectations @xmath931 .",
    "we shall not do so .",
    "instead , let @xmath932 where the sum runs over all tree decompositions of @xmath31 and each term @xmath933 is evaluated at the subset of @xmath934 corresponding to the vertices of @xmath935 , and set @xmath936 note that these definitions extend to disconnected graphs @xmath31 , taking the sum over all combinations of one tree decomposition for each component of @xmath31 .",
    "the upper bound easily implies that the expected number of regular copies of @xmath31 in @xmath34 is at most @xmath937 , and furthermore this bound is correct within a factor @xmath938 if @xmath33 is bounded ; the factor @xmath939 appears because there are @xmath940 potential copies of @xmath31 .",
    "note that the number @xmath941 of embeddings of a graph @xmath31 into a graph @xmath4 , i.e. , the number of injective homomorphisms from @xmath31 to @xmath4 , is simply @xmath942 .",
    "hence @xmath943 is the appropriate normalization for counting embeddings of @xmath31 into @xmath34 rather than copies of @xmath31 . in other contexts ,",
    "when dealing with dense graphs , it turns out to be most natural to consider homomorphisms from @xmath31 to @xmath4 , the number of which will be very close to @xmath941 .",
    "thus the normalization in is standard in related contexts .",
    "( see , for example , lovsz and szegedy  @xcite . )    let us illustrate the definitions above with two simple examples .",
    "[ etk2 ] the simplest case is @xmath910 . in this case",
    ", there is only the trivial tree decomposition , and and yield @xmath944    [ etp2 ] suppose that @xmath33 contains only two non - zero kernels , @xmath70 , corresponding to an edge , and @xmath945 , corresponding to a triangle ; our aim is to calculate @xmath946 in this case , where @xmath880 is the path with 2 edges . using symmetry of @xmath70 and @xmath945 , @xmath947 while @xmath948 reflecting the fact the @xmath880 @xmath868 appears directly in @xmath34 if and only if we added a triangle with vertex set @xmath949 , and this vertex set corresponds to 6 @xmath950-tuples .",
    "since @xmath951 , it follows that @xmath952    more generally , let @xmath31 be any ( simple ) subgraph of @xmath466 with @xmath391 components .",
    "( we abuse notation by now writing @xmath31 for a specific subgraph of @xmath450 , rather than an isomorphism class of graphs . )",
    "let @xmath953 list all atoms contributing edges of @xmath31 , and let @xmath954 , where we take the intersection in the multigraph sense , i.e. , intersect the edge sets .",
    "for example , if @xmath955 and @xmath956 are parallel edges in @xmath450 forming a double edge from @xmath41 to @xmath72 , and @xmath957 , @xmath958 , then @xmath959 contains no @xmath509 edge , even though @xmath960 and @xmath31 each do so . by definition",
    "each @xmath921 contains at least one edge , and @xmath31 is the edge - disjoint union of the @xmath921 .",
    "since @xmath31 has @xmath391 components , when adding the @xmath921 one by one , at least @xmath961 times a new component is _ not _ created , so at least @xmath961 times at least one vertex of @xmath921 , and hence of @xmath928 , is repeated .",
    "it follows that @xmath962 extending our earlier definition , we call @xmath31 _ regular _ if equality holds in , and _ exceptional _ otherwise .",
    "note that if any @xmath921 is disconnected , then @xmath31 is exceptional .",
    "let @xmath963 denote the number of regular copies of @xmath31 in @xmath466 , and @xmath964 the number of exceptional copies .",
    "[ th_ssbd ] let @xmath466 , where @xmath33 is a kernel family , and let @xmath31 be a graph with @xmath391 components .",
    "then @xmath965 if @xmath33 is bounded , then @xmath966 @xmath967 and @xmath968    we have essentially given the proof of the first statement , so let us just outline it . to construct a regular copy of @xmath31 in @xmath450 we must first choose graphs @xmath920 on @xmath969 forming a tree decomposition of each component of @xmath31 . then we must choose a graph @xmath928 containing each @xmath921 to be the atom that will contain @xmath921",
    ". then we must choose @xmath970 distinct vertices @xmath971 from @xmath972 to be the vertices of the @xmath928 , where ( since @xmath31 is regular ) , we have @xmath973 .",
    "note that there are @xmath974 choices for the vertices @xmath42 .",
    "( we are glossing over the details of the counting , and in particular various factors @xmath975 for various graphs @xmath455 .",
    "it should be clear comparing the definition of @xmath976 with what follows that these are in the end accounted for correctly . )    given the vertex types , the probability that these particular graphs @xmath928 arise is then ( up to certain factors @xmath977 ) a product of factors of the form @xmath978 , where the kernel is evaluated at an appropriate subset of @xmath979 .",
    "note that the overall power of @xmath1 in the denominator is @xmath980 . integrating out over the variables @xmath90",
    "corresponding to @xmath981 , and summing over all @xmath982 , the factor @xmath983 becomes a factor @xmath917 . finally , integrating out over the remaining variables ,",
    "corresponding to vertices of @xmath31 , and summing over decompositions , we obtain @xmath984 as an upper bound .",
    "if @xmath33 is bounded then the number @xmath985 of vertices appearing above is bounded , so @xmath986 , where the error term is uniform over all choices for @xmath953 .",
    "it follows that in this case , @xmath987    arguing similarly for exceptional copies , the power @xmath988 of @xmath1 in the denominator is now at least @xmath989 , and it follows that if @xmath33 is bounded , then @xmath990 as claimed .",
    "it follows that @xmath991    finally , for the variance we simply note that @xmath992 is the expected number of ordered pairs @xmath993 of not necessarily disjoint copies of @xmath31 in @xmath450 .",
    "if @xmath994 and @xmath995 share one or more vertices , then @xmath996 has at most @xmath997 components . from , the expected number of such pairs is @xmath998 .",
    "the expected number of pairs with @xmath994 and @xmath995 disjoint is simply @xmath999 , where @xmath1000 is the disjoint union of two copies of @xmath31 and @xmath1001 is a symmetry factor , the number of ways @xmath1000 can be divided into 2 copies of @xmath31 .",
    "( if @xmath31 is connected then simply @xmath1002 and in general , if @xmath31 has distinct components @xmath922 with multiplicities @xmath1003 , then @xmath1004 . ) since @xmath1005 , we have @xmath1006 , so gives @xmath1007 from which the variance bound follows .",
    "the final bound follows by chebyshev s inequality .",
    "for bounded kernel families , theorem  [ th_ssbd ] is more or less the end of the story , although one can of course prove more precise results . for unbounded kernel families",
    "the situation is much more complicated .",
    "let us first note that regular copies of @xmath31 do not give rise to any problems .",
    "[ th_reg ] let @xmath33 be a kernel family and @xmath31 a connected graph , and let @xmath466",
    ". then @xmath1008 .",
    "in other words , if @xmath1009 , then for any constant @xmath102 , whp @xmath1010 , while if @xmath1011 , then @xmath1012 .",
    "we consider the truncated kernel families @xmath364 . since @xmath943 is a sum of integrals of products of sums of integrals of the kernels @xmath686 , by monotone convergence we have @xmath1013 as @xmath837 , and hence @xmath1014 .",
    "if @xmath1009 , choose @xmath358 so that @xmath1015 , and couple @xmath1016 and @xmath450 in the natural way so that @xmath453 .",
    "since @xmath364 is bounded , theorem  [ th_ssbd ] implies that @xmath1017 whp .",
    "since @xmath1018 , the result follows .",
    "if @xmath1011 , then given @xmath441 , the truncation argument above shows that @xmath1019 holds whp . by the first statement of theorem  [ th_ssbd ] , @xmath1020 . combining these two bounds gives the result .",
    "note that we do not directly control the variance of @xmath963 ; as we shall see in section  [ sec_pl ] , there are natural examples where @xmath1021 is concentrated about its finite mean even though its variance tends to infinity .",
    "the very simplest case of theorem  [ th_reg ] concerns edges ; we stated this as a separate result in the introduction .    since all copies of @xmath650 in @xmath1022 are regular ( and direct ) , @xmath1023 , and taking @xmath910 in theorem  [ th_reg ] and using yields @xmath1024 , which is the first claim of theorem  [ tedges ] .",
    "it remains to show that @xmath1025 .",
    "the lower bound follows from the first part , since convergence in probability implies @xmath1026 , while theorem  [ th_ssbd ] gives @xmath1027 , completing the proof .",
    "it is also easy to prove theorem  [ tedges ] directly , using truncations as in this section but avoiding many complications present in the general case .",
    "by a _ moment _ of a kernel family @xmath33 we shall mean any integral of the form @xmath1028 where @xmath1029 are not necessarily distinct , and each term @xmath1030 is evaluated at some @xmath1031-tuple of distinct @xmath90 .",
    "the proof of theorem  [ th_ssbd ] shows that for any connected @xmath31 , @xmath1032 is bounded by a sum of moments of @xmath33 .",
    "this gives a very strong condition under which we can control @xmath1033 .",
    "[ th_mf ] let @xmath33 be a kernel family in which only finitely many kernels @xmath28 are non - zero .",
    "suppose also that all moments of @xmath33 are finite .",
    "then for any connected @xmath31 , @xmath1034 , and the conclusions of theorem  [ th_reg ] apply with @xmath963 replaced by @xmath1035 .",
    "this is essentially trivial from the comments above and theorem  [ th_reg ] .",
    "we omit the details .",
    "example  [ badp2 ] shows that some conditions are necessary to control @xmath1033 ; we refer the reader to for the description of the kernel family in this case . plugging into ,",
    "in this case we have @xmath1036 for some constant @xmath1037 ( in fact , @xmath1038 ) , and it easily follows that @xmath1039 .",
    "however , as shown in the discussion of that example , whp there is a vertex with degree at least @xmath870 , and hence at least @xmath1040 copies of @xmath880 , which is much larger than @xmath1 if @xmath1041 . in this case",
    "the problem is exceptional @xmath880s @xmath868 arising from atoms @xmath1042 and @xmath1043 : the corresponding moment @xmath1044 is infinite , due to the contribution from @xmath1045 .    of course",
    ", not all moments contribute to @xmath1046 ; as we shall see in the next section , it is easy to obtain results similar to theorem  [ th_mf ] under weaker assumptions in special cases .",
    "also , in general it may happen that @xmath964 has infinite expectation ( in the multigraph form ) , but is nonetheless often small , i.e. , that the large expectation comes from the small probability of having a vertex in very many copies of @xmath31 .",
    "much more generally , it turns out that when @xmath33 is integrable , whp all exceptional copies of @xmath31 sit on a rather small set of vertices .",
    "[ th_ess ] let @xmath33 be an integrable kernel family and @xmath31 a connected graph , with @xmath976 finite .",
    "let @xmath466 .    for any @xmath441 , there is a @xmath354 such that whp _ every _ graph @xmath452 formed from @xmath450 by deleting at most @xmath1047 vertices has @xmath1048 .",
    "for any @xmath441 and any @xmath354 , whp there is _ some _ graph @xmath452 formed from @xmath450 by deleting at most @xmath1047 vertices such that @xmath1049 .",
    "together the statements above may be taken as saying that @xmath450 contains essentially @xmath1050 copies of @xmath31 , where ` essentially ' means that we may ignore @xmath811 vertices .",
    "in other words , the ` bulk ' of @xmath450 contains this many copies of @xmath31 , though a few exceptional vertices may meet many more copies .",
    "we start with the second statement , since it is more or less immediate . indeed , writing @xmath1051 for @xmath1052 , and considering truncations @xmath364 as usual , from monotone convergence we have @xmath1053 as @xmath837 .",
    "let @xmath441 , @xmath354 and @xmath1054 be given .",
    "since @xmath33 is integrable , i.e. , @xmath1055 , there is some @xmath358 such that @xmath1056 .",
    "coupling @xmath1057 and @xmath466 in the usual way , let us call a vertex _ bad _ if it meets an atom present in @xmath450 but not @xmath1058 .",
    "the expected number of bad vertices is at most the expected sum of the sizes of the extra atoms , which is at most @xmath1059 .",
    "hence the probability that there are more than @xmath1047 bad vertices is at most @xmath1060 .    deleting all bad vertices from @xmath450 leaves a graph @xmath452 with at most @xmath1061 copies of @xmath31 . applying theorem  [ th_ssbd ]",
    ", this number is at most @xmath1062 whp , so we see that if @xmath1 is large enough , then with probability at least @xmath1063 we may delete at most @xmath1047 vertices to leave @xmath452 with at most @xmath1064 copies of @xmath31 , as required .    turning to the first statement",
    ", we may assume without loss of generality that @xmath33 is bounded .",
    "indeed , there is some truncation @xmath364 with @xmath1065 , and taking @xmath1066 as usual , it suffices to prove the same statement for @xmath447 with @xmath565 replaced by @xmath1067 .",
    "assuming @xmath33 is bounded , then by theorem  [ th_ssbd ] we have @xmath1068 whp , so it suffices to prove that if @xmath33 is bounded and @xmath441 , then there is some @xmath354 such that whp any @xmath1047 vertices of @xmath466 meet at most @xmath1069 copies of @xmath31 .",
    "let @xmath128 be a fixed vertex of @xmath31 , and for @xmath859 let @xmath636 denote the number of homomorphisms from @xmath31 to @xmath450 mapping @xmath128 to vertex @xmath41 .",
    "let @xmath656 be the graph formed from two copies of @xmath31 meeting only at @xmath128 .",
    "then there are exactly @xmath1070 homomorphisms from @xmath656 to @xmath450 mapping @xmath128 to @xmath41 , so in total there are @xmath1071 homomorphisms from @xmath656 to @xmath450 . now",
    "the image of any homomorphism from @xmath656 to @xmath450 is a connected subgraph @xmath1072 of @xmath450 , and each such subgraph is the image of @xmath1073 homomorphisms .",
    "applying theorem  [ th_ssbd ] to each of the @xmath1073 possible isomorphism types of @xmath1072 , it follows that there is some constant @xmath102 such that , whp , @xmath1074 when the upper bound holds , given any set @xmath1075 $ ] with @xmath1076 , by the cauchy ",
    "schwartz inequality we have @xmath1077    repeating the argument above for each vertex @xmath128 of @xmath31 and summing , we see that there is some @xmath1078 ( given by the sum of at most @xmath1079 constants corresponding to @xmath1080 above ) such that whp for any @xmath354 , and any set @xmath1081 of at most @xmath1047 vertices of @xmath450 , there are at most @xmath1082 homomorphisms from @xmath31 to @xmath450 mapping any vertex of @xmath31 into @xmath1081 .",
    "this condition implies that @xmath1081 meets at most @xmath1082 copies of @xmath31 , so choosing @xmath515 such that @xmath1083 , we see that whp any @xmath1047 vertices meet at most @xmath1069 copies of @xmath31 . as noted above , the first statement of the theorem follows .",
    "our aim in this paper has been to introduce a very general family of sparse random graph models , showing that despite the generality , the models are still susceptible to mathematical analysis .",
    "the question of which special cases of the model may be relevant in applications is a very broad one , and not our focus .",
    "nevertheless , in the light of the motivation of the model , we shall investigate one special case .",
    "we should like to show that , with an appropriate choice of kernel family , our model gives rise to graphs with power - law degree distributions , with various ranges of the degree exponent , the clustering coefficient ( see  ) , and the mixing coefficient ( see  ) .",
    "we achieve this in the simplest possible way , considering a ` rank 1 ' version of the model in which we add only edges and triangles .",
    "we do not claim that this particular model is appropriate for any particular real - world example ; nevertheless , it shows the potential of our model to produce graphs that are similar to real - world graphs , where similarity is measured by the values of these important and much studied parameters .    throughout this section",
    "we fix three parameters , @xmath1084 , and @xmath1085 with @xmath1086 .",
    "we consider one specific kernel family @xmath33 on @xmath1087 $ ] with @xmath20 lebesgue measure .",
    "our kernel family has only two non - zero kernels , @xmath70 , corresponding to edges , and @xmath945 to triangles , with @xmath1088 and @xmath1089 we could of course consider many other possible functions , but these seem the simplest and most natural for our purposes",
    ". it would be straightforward to carry out computations such as those that follow with each of the @xmath1090s above replaced by a different constant , for example , although we should symmetrize the kernels in this case . however , one of these exponents would determine the power law , and it seems most natural to take them all equal .    for convenience ,",
    "we define @xmath1091 in particular , @xmath1092 .",
    "we then have @xmath1093 so @xmath33 is integrable .",
    "also , for the asymptotic edge density in theorem  [ tedges ] , @xmath1094 in the following subsections we apply our general results to determine various characteristics of this particular random graph @xmath466 .      from and symmetry of @xmath70 and @xmath945",
    "we see that @xmath1095 while for @xmath1096 , @xmath1097 since an edge contributes 1 to the degree of each endvertex , while a triangle contributes 2 to the degrees of its vertices , for each @xmath85 , the measure @xmath707 defined by is given by @xmath1098 theorem  [ tdegree ] then tells us that the degree distribution of @xmath466 converges to the mixed compound poisson distribution @xmath706 , where @xmath705 is the random measure corresponding to @xmath707 with @xmath85 chosen uniformly from @xmath19 $ ] .",
    "note that if @xmath1099 , then the limiting degree distribution is mixed poisson , while if @xmath1100 , almost all degrees are even and the degrees divided by @xmath892 have a mixed poisson distribution .    for the power law ,",
    "note that the mean @xmath212 of @xmath707 is simply @xmath1101 where @xmath1102 is a constant depending on @xmath1103 , @xmath1104 and @xmath1090 . choosing @xmath85 randomly from @xmath19",
    "$ ] , for any @xmath1105 we have @xmath1106 so the distribution of @xmath212 has a power - law tail . using the concentration properties of poisson distributions with large means , arguing as in the proof of corollary 13.1 of  @xcite",
    ", it follows easily that @xmath1107 as @xmath473 , so the asymptotic degree distribution does indeed have a power - law tail with ( cumulative ) exponent @xmath1090 .",
    "let @xmath1108 , so by theorem  [ tdegree ] , the asymptotic fraction of vertices with degree @xmath391 is simply @xmath1109 .",
    "if @xmath1110 then it is not hard to check that in fact @xmath1111 as @xmath473 , where @xmath1112 , so the degree distribution is power - law in this stronger sense . if @xmath1100 , then @xmath1113 if @xmath391 is odd , but still holds for even @xmath391 , for a different ( doubled ) constant @xmath1114 .      from  , we have @xmath1115 , which we may rewrite as @xmath1116 , where @xmath1117 by theorems  [ th1 ] and  [ th2 ] , the largest component of @xmath450 is of size @xmath622 , and there is a giant component , i.e. , @xmath198 , if and only if @xmath199 . in this case",
    "@xmath81 is ` rank 1 ' in the terminology of  @xcite , and we have @xmath1118 hence , fixing @xmath1119 and thus @xmath1120 and @xmath1121 , there is a giant component if and only if @xmath1122    turning to the normalized size @xmath144 of the giant component , theorem  [ unique ] allows us to calculate this in terms of the solution to a functional equation .",
    "usually this is intractable , but for the special @xmath33 we are considering this simplifies greatly , as in the rank 1 case of the edge - only model ; see section 16.4 of  @xcite , or section 6.2 of  @xcite . indeed , writing @xmath308 for the survival probability of @xmath130 , from we have @xmath1123 which simplifies to @xmath1124 where @xmath1125 by lemma  [ l_max ] , we have @xmath1126 , so @xmath1127 although we defined @xmath102 in terms of @xmath322 , we can view @xmath102 as an unknown constant , define @xmath322 by , and substitute back into .",
    "the function @xmath322 then solves if and only if @xmath102 solves @xmath1128 and every solution to arises in this way .",
    "in particular , by theorems  [ unique ] and  [ th2 ] , there is a positive solution only in the supercritical case ( when holds ) , and that solution is then unique ; @xmath1129 is always a solution . transforming the integral using the substitution @xmath1130",
    ", one can rewrite the right hand side of in terms of an incomplete gamma function , although it is not clear this is informative .",
    "the point is that the form of @xmath308 is given by , and the constant can in principle be found as the solution to an equation , and can very easily be found numerically for given values of @xmath1103 , @xmath1104 and @xmath1090 .      in the following subsections",
    "we shall need expressions for @xmath976 for various small graphs @xmath31 , where @xmath976 , defined by and , may be thought of as the asymptotic density of copies of @xmath31 in the kernel family @xmath33 .",
    "we start with direct copies of @xmath31 . since all atoms are edges or triangles , the only graphs @xmath31 that can be produced directly are edges , triangles , and @xmath880s , i.e. , paths with 2 edges .",
    "putting the specific kernels @xmath70 and @xmath945 into the formulae and from the previous section , we have @xmath1131 and @xmath1132 while @xmath1133    edges may be formed only directly , so either from and or from , we have @xmath1134 which agrees , as it should , with .",
    "since a triangle is 2-connected , it has no non - trivial tree decomposition , and and give @xmath1135 which may also be seen by noting that the only regular copies of a triangle are those directly corresponding to @xmath945 .    a copy of @xmath880 may be formed by a single triangular atom ( a direct copy ) , but may also be formed by two edges from different atoms .",
    "hence , as in example  [ etp2 ] , @xmath1136 in particular , if @xmath1137 then @xmath946 is infinite .    for @xmath1138 , the star with three edges ,",
    "there are two types of tree - decompositions : three edges or one edge and one copy of @xmath880 , the latter occurring in 3 different ways .",
    "( there are no direct copies . )",
    "hence , @xmath1139 and thus @xmath1140    finally , for @xmath1141 , there are again two types of tree - decompositions : three edges or one edge and one copy of @xmath880 , the latter now occurring in 2 different ways .",
    "hence , @xmath1142    as we shall see , the counts above are enough to calculate two more interesting parameters of the graph @xmath466 .",
    "the _ clustering coefficient _ @xmath1143 of a graph @xmath4 was introduced by watts and strogatz  @xcite as a measure of the extent to which neighbours of a random vertex in @xmath4 tend to be joined directly to each other .",
    "after the degree distribution , it is one of the most studied parameters of real - world networks . as discussed in  @xcite , for example",
    ", there are several different definitions of such clustering coefficients .",
    "one of these turns out to be most convenient for mathematical analysis , and is also very natural ; following  @xcite , we call this coefficient @xmath1144 .",
    "( hopefully there will be no confusion with our earlier use of @xmath1144 for the number of vertices in the 2nd largest component . )",
    "the coefficient @xmath1144 may be defined as a certain weighted average of the ` local clustering coefficients ' at individual vertices , but is also simply given by @xmath1145 a ratio that is easily seen to lie between @xmath118 and @xmath45 .",
    "now from above we have @xmath1146 .",
    "hence , by theorem  [ th_reg ] , @xmath1147 where , as usual , @xmath466 .",
    "we shall return to exceptional copies of @xmath649 shortly .    if @xmath1137 then @xmath946 is infinite , and @xmath450 will whp contain more than @xmath47 copies of @xmath880 .",
    "note that this is to be expected given the exponent of the asymptotic degree distribution , since in this case the expected square degree is infinite .    from now on",
    "we suppose that @xmath1119 , so @xmath946 is finite .",
    "suppose for the moment that exceptional copies of @xmath880 and @xmath649 are negligible , i.e. , that @xmath1148 by theorem  [ th_reg ] , we have @xmath1149 and @xmath1150 , so it follows that @xmath1151 where , from the formulae in subsection  [ ss_counts ] , @xmath1152 with @xmath1153 given by .",
    "it follows that with the degree exponent @xmath1119 fixed , this special case of our model can achieve any possible value of the clustering coefficient , with the trivial exception of @xmath45 ( achieved only by graphs that are vertex disjoint unions of cliques ) .",
    "indeed , @xmath1154 for any @xmath1103 , while taking @xmath1100 we have @xmath1155 which is decreasing as a function of @xmath1104 , and tends to @xmath45 as @xmath1156 and to @xmath118 as @xmath1157 .",
    "let us note in passing that by theorem  [ th_reg ] , if @xmath1158 then @xmath1159 is concentrated around its finite mean even though its variance , which involves the expected 4th power of the degree of a random vertex , tends to infinity .",
    "so far we considered only regular copies of @xmath880 and @xmath649 ; we now turn our attention to exceptional copies . unfortunately , for any @xmath1090 , some moment of our kernel is infinite , so theorem  [ th_mf ] does not apply .",
    "however , it is easy to describe the set of moments relevant to the calculation of @xmath1046 for the graphs @xmath31 we consider .",
    "suppose that @xmath31 is an exceptional triangle ( or @xmath880 ; the argument is then almost identical ) in @xmath466 . since @xmath31 has ( at most )",
    "three edges , there are at most 3 atoms @xmath921 contributing edges to @xmath31 .",
    "let @xmath455 be the union of these atoms , considered as a multigraph .",
    "for example , if @xmath31 is the triangle @xmath1160 , then @xmath455 might consist of the union of the three triangles @xmath1161 , @xmath1162 , and @xmath1163 .",
    "in some sense this will turn out to be the ` worst ' case .",
    "let us fix the isomorphism type of @xmath455 , defined in the obvious way .",
    "let @xmath1164 be the total number of vertices in @xmath455 , and write @xmath1165 for the ` redundancy ' of @xmath455 . since @xmath31 is exceptional , @xmath1166 .",
    "the expected number of exceptional @xmath31 arising in this way is exactly @xmath1167 times a certain integral of products of @xmath70 and @xmath945 .",
    "from the form of @xmath70 and @xmath945 , we may write this as @xmath1168 where @xmath630 is the number of the atoms @xmath922 that contain the @xmath41th vertex of @xmath455 . the initial factor is at most @xmath1169 , while the integral is finite unless @xmath1170 for some @xmath41 .",
    "since @xmath455 is made up of at most 3 atoms @xmath922 , we always have @xmath1171 , so if @xmath1172 then the relevant integrals ( i.e. , the relevant moments ) are finite , and we have @xmath1173 , which certainly implies .",
    "in fact , we do not need to assume that @xmath1172 .",
    "suppose that @xmath1174 .",
    "then in the multigraph version of the model , @xmath1175 .",
    "( consider , for example , three triangles sitting on 4 vertices as above . ) on the other hand , this does not mean that @xmath1176 is often large . indeed ,",
    "when we choose our vertex types uniformly from @xmath19 $ ] , whp there is no vertex whose type @xmath85 is at most @xmath1177 , say . conditioning on this very likely event @xmath1178 , we may consider the restrictions of @xmath70 and @xmath945 to @xmath1179 ^ 2 $ ] and @xmath1179 ^ 3 $ ] , respectively .",
    "now the expected number of copies of some pattern @xmath455 is at most a constant times @xmath1180 where @xmath985 is the number of vertices @xmath41 of @xmath455 with @xmath1181 .",
    "since the graph @xmath649 ( or @xmath880 ) we are trying to form has maximum degree 2 , every vertex of @xmath455 with @xmath1181 corresponds to a redundancy , so we always have @xmath1182 . up to constants and a power of @xmath1183",
    "the integral is @xmath1184 , and it follows that @xmath1185 since @xmath1186 , it follows that @xmath1187 , even though its expectation would not suggest this .",
    "the same holds for @xmath1188 , so we see that does indeed hold for any @xmath1119 , and the clustering coefficient is indeed concentrated about @xmath1189 .",
    "another interesting parameter of real networks is the extent to which the degrees of the two ends of a randomly chosen edge tend to correlate ; positive correlation is known as _ assortative mixing _ , and negative correlation as _ disassortative mixing_. to define this precisely , let @xmath4 be any graph , and let @xmath409 be an edge of @xmath4 chosen uniformly at random .",
    "more precisely , let @xmath1190 be chosen uniformly at random from all @xmath1191 ordered pairs corresponding to edges of @xmath4 .",
    "let @xmath794 and @xmath1192 denote the degrees of @xmath128 and @xmath410 ; we view these as random variables . since the events @xmath1193 and",
    "@xmath1194 have the same probability , the random vertices @xmath128 and @xmath410 have the same distribution , so @xmath794 and @xmath1192 have the same distribution .",
    "let @xmath1195 here @xmath4 is fixed , and all expectations are with respect to the random choice of @xmath1190 .",
    "thus @xmath1196 is simply the correlation coefficient between the degrees of the two ends of a randomly chosen edge , so @xmath1197 , and @xmath1198 corresponds to assortative mixing and @xmath1199 to disassortative mixing .",
    "this mixing coefficient was introduced by callaway , hopcroft , kleinberg , newman and strogatz  @xcite , building on work of krapivsky and redner  @xcite , and has been studied by many people , for example newman  @xcite . in  @xcite , @xmath1196 is denoted @xmath1200 ; we avoid this notation as it clashes with our notation for the survival probability of a branching process .",
    "fortunately , we need no new theory to evaluate @xmath1196 for @xmath1201 , since @xmath1196 can be expressed in terms of small subgraph counts .",
    "more precisely , for any graph @xmath4 , @xmath1202 where @xmath41 runs over all vertices of @xmath4 , then @xmath72 over all neighbours of @xmath41 , and @xmath1203 is the degree of vertex @xmath41 in @xmath4 .",
    "also , @xmath1204 so @xmath1205 also , @xmath1206 where @xmath1138 is the star with @xmath950 edges .",
    "thus @xmath1207 hence @xmath1208 in well - behaved cases , for example for bounded kernel families , it follows from our results here ( theorems [ th_ssbd][th_mf ] ) that if @xmath466 , then @xmath1209 where @xmath1210 with @xmath1211 ; see .    returning to our present specific example , substituting in the expressions for @xmath1212 in subsection  [ ss_counts ]",
    ", the ratio turns out to be @xmath1213 where @xmath1214 .",
    "let us make a few comments on these expressions .",
    "firstly , the coefficients @xmath1215 , @xmath946 , @xmath1216 and @xmath1217 are finite for all @xmath1119 , while @xmath1218 is finite if and only if @xmath1172 . for the numerator",
    ", one can argue for @xmath1141 as for @xmath880 and @xmath649 above to show that the number of exceptional copies of @xmath1141 is @xmath1219 and thus negligible for every @xmath1220 , and hence @xmath1221 by theorem  [ th_reg ] .",
    "consequently , the numerator in ( with @xmath1222 ) divided by @xmath1223 converges in probability to the numerator in , and this limit is finite . for @xmath1224 , one can argue in the same way to show that the number of exceptional copies of @xmath1225 is negligible , so @xmath1226 and does indeed hold . for @xmath1227 , when @xmath1228 , theorem  [ th_reg ] implies that @xmath1229 , so in this case @xmath1230 , for the not very interesting reason that @xmath1231 is unbounded while @xmath1232 is not . in any case",
    ", we have shown that holds in our example for every @xmath1220 .",
    "secondly , we see that @xmath1233 for every @xmath1220 , with @xmath1234 whenever @xmath1235 and we add both edges and triangles ( i.e. , if both @xmath1103 and @xmath1104 are non - zero ) .",
    "thirdly , if @xmath1103 and @xmath1104 are both positive and comparable but very small , then it is easy to see that @xmath1236 is close to @xmath45 , for the simple reason that the graph then consists of rather few ( though still order @xmath1 ) edges and triangles , which are almost all vertex disjoint . in this case we almost always have either @xmath1237 , if we pick an edge component , or @xmath1238 if we pick an edge of a triangle .",
    "this is also easily checked algebraically from : the denominator is of the form @xmath1239 , which is asymptotically equal to the numerator if @xmath1240 with @xmath1241 bounded above and below .",
    "it follows that as @xmath1103 and @xmath1104 are varied , @xmath1236 can take any value between @xmath118 and @xmath45 , with @xmath45 excluded .    finally , it is easy to check that the form of @xmath1236 as a function of @xmath1103 , @xmath1104 and @xmath1090 is very different from that of @xmath1189 given in .",
    "it follows that with the degree exponent @xmath1172 fixed , if we vary @xmath1103 and @xmath1104 we may vary the clustering coefficient and @xmath1236 independently , subject to certain inequalities .",
    "it so happens that in the example considered here , @xmath1236 is always non - negative , but it is easy to give examples where @xmath1242 . indeed , this arises already in the edge - only case ( of the kind we treated in @xcite ) , even with the very simple type space with two elements of weights @xmath1243 and @xmath1244 , @xmath642 , taking @xmath1245 , @xmath1246 and @xmath1247 . in symbols , @xmath1248},\\ ] ] where @xmath1249}$ ] is the indicator function of the event @xmath1250 .    for this kernel ( family ) @xmath1251 } , \\\\ { { \\xi}({{\\undertilde{{\\kappa}}}})}&=\\int{\\kappa}_2=2apq , \\\\ \\sigma_{k_2}(x , y)&=2{\\kappa}_2(x , y)={{{\\kappa}_{\\mathrm e}}}(x , y)=2a{\\boldsymbol1[x\\neq y]}.\\end{aligned}\\ ] ] expanding the integrals as sums",
    ", it follows that @xmath1252    substituting these expressions into and simplifying , we find that @xmath1253 hence @xmath1254 , and we have disassortative mixing as soon as @xmath1255 , i.e. , when @xmath1256 .",
    "we see also that the coefficient @xmath1236 can be made to take any value in @xmath1257 $ ] by choosing the parameters suitably .",
    "one can easily combine the simple example above with that considered in the bulk of this section to give graphs with power - law degree distributions with various values of the clustering coefficient and of @xmath1258 , now with negative values of @xmath1258 possible .",
    "perhaps the simplest way of giving such graphs is to divide the type space @xmath19 $ ] into two intervals @xmath1259 $ ] and @xmath1260 $ ] , take @xmath1261 on @xmath1262 and @xmath1263 on @xmath1264 , to set @xmath1265 if one of @xmath85 is in @xmath1262 and the other in @xmath1264 , and @xmath1266 otherwise , and to define @xmath1267 to be some constant times @xmath1268 , where the constant depends on how many of @xmath85 , @xmath86 and @xmath1269 lie in @xmath1262 .",
    "although our main focus in this paper was the introduction of the model @xmath34 , and the study of the existence and size of the giant component in this graph , we shall close by briefly discussing some connections to earlier work that arise when considering the local structure of @xmath34 .",
    "let us start by considering subgraph counts .",
    "as before , let @xmath648 consist of one representative of each isomorphism class of finite graphs , and let @xmath1270 consist of the connected graphs in @xmath648 . given two graphs @xmath31 and @xmath4 , let @xmath1271 be the number of homomorphisms from @xmath31 to @xmath4 , and @xmath941 the number of embeddings , so @xmath1272 .",
    "writing @xmath450 for a graph with @xmath1 vertices , in the dense case , where @xmath450 has @xmath1273 edges , one can combine the normalized subgraph or embedding counts @xmath1274 to define a metric that turns out to have very nice properties .",
    "( often one uses the equivalent homomorphism densities @xmath1275 , but when we come to sparse graphs embeddings are more natural than homomorphisms . )",
    "a sequence @xmath1276 converges in this _ subgraph metric _ if and only if there are constants @xmath1277 , @xmath24 , such that @xmath1278 for each @xmath24 .",
    "lovsz and szegedy  @xcite characterised the possible limits @xmath1279 , both in terms of kernels and algebraically .",
    "borgs , chayes , lovsz , ss and vesztergombi  @xcite introduced the cut metric @xmath1280 that we used in section  [ sec_giant ] .",
    "they showed that this metric is equivalent to the subgraph metric , as well as to various other notions of convergence for sequences of dense graphs .",
    "one of the nicest features of these results is that for every point in the completion of the space of finite graphs ( with respect to any of these metrics ) , there is a natural random graph model ( called a @xmath1281-random graph in  @xcite ) that produces sequences of graphs tending to this point .",
    "( see also diaconis and janson  @xcite , where connections to certain infinite random graphs are described . )",
    "turning to sparse graphs , as described in  @xcite , the situation is much less simple .",
    "when @xmath450 has @xmath1282 edges , as here , the natural normalization is to consider , for each connected @xmath31 , @xmath1283 under suitable additional assumptions on the sequences @xmath450 , one can again combine these counts to define a metric , and consider the possible limit points .",
    "unfortunately , not much is known about these ; see the discussion in  @xcite",
    ".    turning to our present model , theorem  [ th_mf ] shows that if @xmath33 is a kernel family with only finitely many non - zero kernels and all moments finite , then @xmath1284 for all connected @xmath31 , where @xmath466 and @xmath943 is given by .",
    "this suggests the following question .",
    "note that question  [ q1 ] is very different from the question answered by lovsz and szegedy  @xcite : our definition of @xmath943 is different from the corresponding notion studied there , since it is adapted to the setting of sparse graphs .",
    "in particular , if @xmath33 consists only of a single kernel @xmath70 ( as in @xcite ) , then we have @xmath1287 for any @xmath31 that is not a tree .    as discussed in  ( * ? ? ?",
    "* question 8.1 ) , it is an interesting question to ask whether , for various natural metrics on sparse graphs , one can provide natural random graph models corresponding to points in the completion . for those vectors @xmath1288 where the answer to question  [ q1 ] is yes , the model @xmath34 provides an affirmative answer ( at least if @xmath33 is bounded , say ) . but these points will presumably only be a very small subset of the possible limits , so there are many corresponding models still to be found .    as noted in  (",
    "* sections 3,7 ) , rather than considering subgraph counts @xmath1289 , for graphs with @xmath1282 edges it is more natural to consider directly the probability that the @xmath136-neighbourhood of a random vertex @xmath128 is a certain graph @xmath31 ; the subgraph counts may be viewed as moments of these probabilities .",
    "more precisely , let @xmath1290 be the set of isomorphism classes of connected , locally finite rooted graphs , and for @xmath1291 , let @xmath1292 be the set of isomorphism classes of finite connected rooted graphs with _ radius _ at most @xmath136 , i.e. , in which all vertices are within distance @xmath136 of the root .",
    "a probability distribution @xmath246 on @xmath1290 naturally induces a probability distribution @xmath1293 on each @xmath1292 , obtained by taking a @xmath246-random element of @xmath1290 and deleting any vertices at distance more than @xmath136 from the root .",
    "given @xmath1294 and a graph @xmath450 with @xmath1 vertices , let @xmath1295 be the probability that a random vertex @xmath128 of @xmath450 has the property that its neighbourhoods up to distance @xmath136 form a graph isomorphic to @xmath31 , with @xmath128 as the root .",
    "a sequence @xmath1276 with @xmath1296 has _ local limit _",
    "@xmath246 if @xmath1297 for every @xmath1294 and all @xmath1291 .",
    "this notion has been introduced in several different contexts under different names : aldous and steele  @xcite used the term ` local weak limit ' , and aldous and lyons  @xcite the name ` random weak limit ' . also , benjamini and schramm  @xcite defined a corresponding ` distributional limit ' of certain random graphs .",
    "notationally it is convenient to map a graph @xmath450 to the point @xmath1298^{{{{\\mathcal g}}^{\\mathrm r}_t}}$ ] , and to define @xmath1299 similarly . taking any metric @xmath428 on @xmath1300 giving rise to the product topology",
    ", we obtain a metric @xmath1301 on the set of graphs together with probability distributions on @xmath1290 , and @xmath1276 has local limit @xmath246 if and only if @xmath1302 .",
    "as noted in  @xcite , under suitable assumptions ( which will hold here if @xmath33 is bounded , for example ) , the two notions of convergence described above are equivalent , and one can pass from the limiting normalized subgraph counts @xmath1303 to the distribution @xmath246 and _ vice versa_. also , if @xmath365 is a bounded kernel , then the random graphs @xmath927 defined in  @xcite have as local limit a certain distribution associated to @xmath246 .",
    "this latter observation extends to the present model , and as we shall now see , no boundedness restriction is needed .",
    "given an integrable hyperkernel @xmath33 , let @xmath1304 be the random ( potentially infinite ) rooted graph associated to the branching process @xmath117 .",
    "this is defined in the natural way : we take the root of @xmath117 as the root vertex , for each child clique of the root we take a complete graph in @xmath1304 , with these cliques sharing only the root vertex .",
    "each child @xmath410 of the root then corresponds to a non - root vertex in one of these cliques , and we add further cliques meeting only in @xmath410 to correspond to the child cliques of @xmath410 , and so on .    more generally , given an integrable kernel family @xmath32 , we may define a random rooted graph @xmath1304 in an analogous way ; we omit the details .",
    "we write @xmath1305 for the probability distribution on @xmath1290 associated to @xmath1304 .",
    "in fact , we conjecture that almost sure convergence holds for any coupling of the @xmath450 for different @xmath1 , and in particular if the different @xmath450 are taken to be independent .",
    "( the case of independent @xmath450 is the extreme case , which by standard arguments implies a.s",
    ".  convergence for every other coupling too ; a.s .  convergence in this case is known as _",
    "complete convergence_. )    writing @xmath1307 for the probability distribution on @xmath1292 induced by @xmath1305 , by definition we have @xmath1306 if and only if @xmath1308 for each @xmath136 and each @xmath1294 .",
    "the special case where @xmath33 is a bounded hyperkernel is essentially immediate : is simply a formal statement of the local coupling established for bounded hyperkernels in  section  [ sec_loc ] .",
    "exactly the same argument applies to a bounded kernel family . for the extension to general kernel families",
    "we need a couple of easy lemmas .",
    "this is an extension of proposition 8.11 of  @xcite ; the proof carries over _ mutatis mutandis _ , using theorem  [ th_ssbd ] with @xmath1310 to bound the sum of the squares of the vertex degrees in the bounded case .",
    "the key step is to use edge integrability to find a bounded kernel family @xmath651 such that @xmath654 may be regarded as a subgraph of @xmath34 containing all but at most @xmath1311 of the edges .",
    "it turns out that we can weaken edge integrability to integrability .",
    "the price we pay is that we can not control the number of edges incident to a small set of vertices , but only the size of the neighbourhood . as usual , given a set @xmath1103 of vertices in a graph @xmath4 , we write @xmath1312 for the set of vertices at graph distance at most @xmath136 from @xmath1103 , so @xmath1313 .      replacing each atom by a clique , we may and shall assume that @xmath33 is a hyperkernel .",
    "let @xmath651 be the kernel family obtained from @xmath33 by replacing each clique by a star .",
    "since @xmath33 is integrable , @xmath651 is edge integrable .",
    "let @xmath1316 be the function given by lemma  [ le1 ] , and set @xmath1317 .",
    "then whp every set @xmath1103 of at most @xmath1047 vertices of @xmath654 has @xmath1318 and hence @xmath1319 .",
    "coupling @xmath34 and @xmath654 in the obvious way , vertices adjacent in @xmath34 are at distance at most @xmath892 in @xmath654 , and the result follows .",
    "let @xmath1323 be the number of atoms with @xmath25 vertices , and @xmath1324 .",
    "let @xmath1325 , and let @xmath1326 be the contribution to @xmath1051 from kernels corresponding to graphs @xmath31 with @xmath25 vertices , so @xmath1327 and @xmath1328 .",
    "given @xmath441 , there is an @xmath357 such that @xmath1329 .",
    "each @xmath1323 has a poisson distribution and is thus concentrated about its mean , so whp @xmath1330 writing @xmath1331 for @xmath1332 , since @xmath565 was arbitrary we have shown that @xmath1333 .",
    "since @xmath1334 is bounded , it follows that @xmath1335 .",
    "but @xmath1336 , so @xmath1337 .",
    "hence @xmath1338 , so @xmath1339 as claimed .",
    "let @xmath33 be an integrable kernel family , and let @xmath466 .",
    "fix @xmath1340 , @xmath1294 , and @xmath441 .",
    "it suffices to prove that @xmath1341 then letting @xmath1342 we have @xmath1343 , so holds . since @xmath136 and @xmath31 are arbitrary , this implies @xmath1306 .",
    "applying lemma  [ le2 ] @xmath136 times , there is a @xmath354 such that whp any set @xmath1103 of at most @xmath1047 vertices of @xmath450 satisfies @xmath1344 .",
    "since @xmath33 is integrable , there is a bounded kernel family @xmath364 which satisfies @xmath445 pointwise and @xmath1345 . as @xmath837 , we have @xmath1346 pointwise , and it follows that @xmath1347 ; the argument is as for theorem  [ tappc](i ) . taking @xmath358 large enough , we may thus assume that @xmath1348 .",
    "let @xmath1016 . since @xmath364 is bounded , we have @xmath1349 . coupling @xmath450 and @xmath452 as usual so that @xmath1350 , let @xmath1104 be the set of vertices incident with an atom present in @xmath450 but not @xmath452 . by lemma  [ badv ]",
    "we have @xmath1351 whp , so whp no more than @xmath611 vertices are within distance @xmath136 of vertices in @xmath1104 .",
    "but then @xmath1352 whp , and follows .",
    "the general question of which probability distributions on @xmath1290 arise as local limits of sequences of finite graphs seems to be rather difficult .",
    "there is a natural necessary condition noted in different forms in all of  @xcite ; see also ( * ? ? ?",
    "* section 7 ) .",
    "aldous and lyons  @xcite asked whether this condition is sufficient , emphasizing the importance of this open question .",
    "let us finish with a related but perhaps much simpler question : given @xmath33 , we defined @xmath117 as a branching process in which the particles have types .",
    "but in the corresponding random graph @xmath1304 these types are not recorded .",
    "this means that @xmath33 can not simply be read out of the distribution of @xmath1304 , i.e. , out of @xmath1305 .",
    "this suggests the following question .",
    "part of this research was done during visits of sj to the university of cambridge and trinity college in 2007 , and to the isaac newton institute in cambridge , funded by a microsoft fellowship , in 2008 .",
    "d.  aldous and j.m .",
    "steele , the objective method : probabilistic combinatorial optimization and local weak convergence , in _ probability on discrete structures _ , _ encyclopaedia math .",
    "sci . _ * 110 * , springer ( 2004 ) , pp .",
    "172 .",
    "a. d. barbour , l. holst and s. janson , _",
    "poisson approximation_. oxford university press , oxford , uk , 1992 .",
    "i.  benjamini and o.  schramm , recurrence of distributional limits of finite planar graphs , _ electron . j. probab .",
    "_ * 6 * ( 2001 ) , no .",
    "23 , 13 pp .",
    "( electronic ) .",
    "b.  bollobs and o.  riordan , metrics for sparse graphs , in _ surveys in combinatorics 2009 _ , london math . soc .",
    "lecture note series * 365 * , s. huczynska , j.d .",
    "mitchell and c.m.roney-dougal eds , cup ( 2009 ) , pp .",
    "212 - 287 .",
    "b.  bollobs and o.  riordan , sparse graphs : metrics and random models , preprint ( 2007 ) . `",
    "\\simarxiv:0812.2656 . `    c.  borgs , j. t.  chayes , l.  lovsz , v. t.  ss and k.  vesztergombi , convergent sequences of dense graphs i : subgraph frequencies , metric properties and testing , _ advances in math . _",
    "* 219 * ( 2008 ) , 18011851 ."
  ],
  "abstract_text": [
    "<S> in 2007 we introduced a general model of sparse random graphs with ( conditional ) independence between the edges . </S>",
    "<S> the aim of this paper is to present an extension of this model in which the edges are far from independent , and to prove several results about this extension . </S>",
    "<S> the basic idea is to construct the random graph by adding not only edges but also other small graphs . in other words </S>",
    "<S> , we first construct an inhomogeneous random hypergraph with ( conditionally ) independent hyperedges , and then replace each hyperedge by a ( perhaps complete ) graph . </S>",
    "<S> although flexible enough to produce graphs with significant dependence between edges , this model is nonetheless mathematically tractable . indeed , we find the critical point where a giant component emerges in full generality , in terms of the norm of a certain integral operator , and relate the size of the giant component to the survival probability of a certain ( non - poisson ) multi - type branching process . while our main focus is the phase transition , we also study the degree distribution and the numbers of small subgraphs . </S>",
    "<S> we illustrate the model with a simple special case that produces graphs with power - law degree sequences with a wide range of degree exponents and clustering coefficients . </S>"
  ]
}