{
  "article_text": [
    "the study of the complexity of the constraint satisfaction problem ( csp , for short ) has been initiated by schaefer @xcite .",
    "schaefer studied the complexity of @xmath6 , the csp parametrized by a set @xmath7 of allowed constraints , a constraint language , over a certain set .",
    "more precisely he determined the complexity of @xmath6 for constraint languages on a 2-element set .",
    "the complexity of problems @xmath6 for constraint languages over finite sets has been attracting much attention since then .",
    "this research is guided by the dichotomy conjecture proposed by feder and vardi @xcite that states that every csp of the form @xmath6 for a constraint language @xmath7 on a finite set is either solvable in polynomial time or is np - complete .",
    "this conjecture has been restated and made more precise in different languages , see , e.g.@xcite . also , several powerful approaches to the problem have been developed , through algebra , logic , and graph theory .",
    "so far the most successful method of studying the complexity of the csp has been the algebraic approach introduced by jeavons et al .",
    "this approach relates the complexity of @xmath6 to the properties of a certain universal algebra @xmath8 associated with @xmath7 . in particular",
    "it allows one to expand @xmath6 to the problem @xmath9 depending only on the associated algebra without changing its complexity .",
    "it therefore suffices to restrict ourselves to the study of the complexity of problems of the form @xmath10 , where @xmath0 is a finite universal algebra .",
    "although the dichotomy conjecture remains open in general , it has been confirmed in a number of cases : for constraint languages on 2- and 3-element sets @xcite ( a dichotomy result was also announced for languages over 4- , 5- , and 7-element sets @xcite ) , for constraint languages containing all unary relations @xcite , and several others , see , e.g.  @xcite .",
    "one of the most remarkable phenomena discovered is that , generally , there are only two types of algorithms applicable to csps solvable in polynomial time . the first one has long been known to researchers in artificial intelligence as constraint propagation @xcite .",
    "algorithms of the other type resemble gaussian elimination in the sense that they constract a small generating set of the set of all solutions @xcite . the scope of both types of algorithms is precisely known @xcite .",
    "general dichotomy results , however , can not be proved using only algorithms of a single ` pure ' type . in all such results ,",
    "see , e.g.  @xcite a certain mix of the two types of algorithms is needed . in some cases such as @xcite such",
    "a hybrid algorithm is somewhat ad hoc ; in other cases , @xcite it is based on intricate decompositions of the problem instance .",
    "it is clear however that ad hoc hybridization and the decomposition techniques developed in the mentioned works are not sufficient .",
    "therefore trying to identify new polynomial time solvable cases of the csp through combining the two types of algorithms is the key to approaching the dichotomy conjecture .",
    "there have been several further attempts to design hybrid algorithms ; however , most of them were not quite successful . in more successful cases such as @xcite the researchers tried to tackle somewhat limited cases ,",
    "in which a combination of local consistency properties and gaussian elimination type fragments is very explicit . to represent the context for our results we explain those cases in details .",
    "suppose an idempotent algebra @xmath0 is such that it has a congruence @xmath3 with the property that the csp of its factor @xmath4 can be solved by , say , a local propagation algorithm , while for every @xmath3-block @xmath11 ( a subalgebra of @xmath0 ) the csp over @xmath11 can be solved by the small generating set algorithm ; or the other way round , see figure  [ fig : blocks ] .",
    "how can one solve the csp over @xmath0 itself ?",
    "maroti in @xcite considered the second case , when @xmath4 can be solved by the small generating set algorithm , say , it is maltsev .",
    "this case turns out to be easier because of the property of @xmath3-blocks we can exploit .",
    "suppose for simplicity that every @xmath3-block @xmath11 is a semilattice , as shown in figure  [ fig : blocks ] .",
    "then every csp instance on @xmath11 has some sort of a canonical solution that assigns the maximal element of the semilattice ( that is element @xmath12 such that @xmath13 for all @xmath14 ) to every variable .",
    "it then can be shown that if we find a solution @xmath15 where @xmath16 is the set of variables of the instance on @xmath4 , and then assigning the maximal elements of the @xmath3-block @xmath17 to @xmath18 , we obtain a solution of the original instance .",
    "such that @xmath4 is maltsev ; ( b ) an sbm algebra .",
    "rectangles represent @xmath3-blocks , dots represent elements , lines show the semilattice structure , and @xmath19 represents a maltsev operation acting on elments or @xmath3-blocks . ]",
    "the case when @xmath0 is a semilattice , while every @xmath3-block is maltsev is much more difficult .",
    "we will call such algebras _ semilattice block maltsev _ algebras ( sbm algebras , for short ) .",
    "more precisely , we consider idempotent algebras @xmath0 with the following property : there are a binary operation @xmath1 and a ternary operation @xmath2 , and a congruence @xmath3 of @xmath0 such that @xmath4 is a semigroup with a semigroup operation @xmath1 , and every @xmath3-block @xmath20 is a maltsev algebra with maltsev operation @xmath2 , and @xmath21 is a projection .",
    "the main difficulty with this kind of algebras is that the only solution of a csp over a semilattice we can reliably find is the canonical one assigning the maximal elements .",
    "finding a second solution is already hard . on the other hand ,",
    "if we restrict our instance only to the maximal @xmath3-block @xmath11 , it may have no solution there , even though the original instance has a solution , which simply does not belong to the maximal block .",
    "if this is the case , it has been unclear for nearly 10 years how the maximal block can be eliminated from consideration , and the domain reduced .    the problem has been resolved in some special cases .",
    "firstly , maroti in @xcite showed that it suffices to consider sbm algebras of a certain restricted type .",
    "we will use this result in this paper .",
    "marcovic and mckenzie suggested an algorithm that solves the csp over sbm algebras @xmath0 when @xmath4 is a chain , that is , @xmath22 for any @xmath23 . in this case",
    "their algorithm is capable of eliminating the maximal block using the fact that if a semilattice is a chain , any its subset is a subalgebra .",
    "finally , very recently payne in @xcite suggested an algorithm that works for a more general class of algebras than sbm , but algebras in this class have to satisfy an extra condition that in sbm algebras manifests itself as the existence of certain well behaving mappings between @xmath3-blocks .",
    "in particular , this condition guarantees that the instance restricted to the maximal @xmath3-block has a solution whenever the original problem has a solution .",
    "in this paper we continue the effort started in @xcite and present an algorithm that solves the csp over an arbitrary sbm algebra .",
    "[ the : main ] if @xmath0 is a sbm algebra then @xmath10 is solvable in polynomial time .",
    "the algorithm is based upon a new local consistency notion that we call _ block minimality _ ( although in our case it is necessarily not quite local , since it has to deal with maltsev algebras ) .",
    "more specifically , our algorithm first separates the set @xmath16 of variable of a csp instance into overlapping subsets , so - called coherent sets , and considers subproblems on these sets of variables . for block minimality",
    "these subproblems have to be minimal , that is , every tuple from every constraint relation has to be a part of a solution .",
    "this can achieved be by solving the problem many times with additional constraints . however",
    ", this is not very straightforward , because coherent sets may contain all the variables from @xmath16 . to overcome this",
    "we show that the subproblems restricted to coherent sets are either over a maltsev domain and therefore can be solved efficiently , or they split up into a collection of disjoint instances , each of which has strictly smaller domain . in the latter case we can recurse on theses smaller instances . finally , we prove that any block - minimal instance has a solution",
    ".    the results of this paper can easily be made more general by removing some of the restrictions on the basic functions of sbm algebras .",
    "however , we hope that these results can be generalized well beyond sbm - like algebras and so we stop short of giving more general but also more technically involved proofs just restricting ourselves to demonstrating the general idea .    in section",
    "[ sec : prelims ] we remind the basic definitions and study certain properties of sbm algebras . in section  [ sec : coherent ] we strengthen the results of @xcite about the structure of relations over maltsev algebras and extend them to sbm algebras . in section  [ sec : to - instances ] we extend these notions to csp instances .",
    "finally , in section  [ sec : algorithm ] we prove the main results and present a solution algorithm .",
    "the necessary facts about universal algebra and the link between algebra and the csp can be found in @xcite .",
    "by @xmath24 $ ] we denote the set @xmath25 .",
    "let @xmath26 be finite sets .",
    "tuples from @xmath27 are denoted in boldface , say , @xmath28 , and their entries by @xmath29\\zd\\ba[n]$ ] .",
    "a _ relation _ @xmath30 over @xmath26 is a subset of @xmath31 .",
    "we refer to @xmath32 as the _ arity _ of tuple @xmath28 and relation @xmath30 .",
    "let @xmath33 be an ( ordered ) multiset , a subset of @xmath24 $ ] .",
    "then let @xmath34\\zd\\ba[i_k])$ ] and @xmath35 .",
    "relation @xmath30 is said to be a _",
    "subdirect product _ of @xmath26 if @xmath36 for @xmath37 $ ] . in some cases it will be convenient to consider tuples and relations whose",
    "entries are indexed by sets other than @xmath24 $ ] , most often those will be sets of variables",
    ". then we either assume the index set is somehow ordered , or consider tuples as functions from the index set to the domain and relations as sets of such functions .",
    "let @xmath38 be a set of sets , in this paper @xmath38 is usually the set of universes of finite algebras derived from an sbm algebra ; we clarify ` derived ' later .",
    "an instance of a _ constraint satisfaction problem _ ( csp ) over @xmath38 is given by @xmath39 , where @xmath16 is a set of _ variables _ , @xmath40 is a collection of _ domains _ @xmath41 , and @xmath42 is a set of _ constraints _ ; every constraint @xmath43 is a pair consisting of an ordered multiset @xmath44 , a subset of @xmath16 , called the _ constraint scope _ and @xmath30 is a relation over @xmath45 , called the _ constraint relation_.    let @xmath46 be a class of finite algebras of the same type and @xmath38 the set of universes of algebras from @xmath46 . then @xmath47 is the class of instances @xmath48 of csps over @xmath38 such that every constraint relation @xmath30 from @xmath49 , @xmath44 , is a sublagebra of @xmath50 , where @xmath41 , @xmath51 , are viewed as algebras from @xmath46    let @xmath52 . by @xmath53",
    "we denote the instance @xmath54 defined as follows : @xmath55 for each @xmath56 ; for every constraint @xmath57 , @xmath58 , the set @xmath59 includes the constraint @xmath60 , where @xmath61 and @xmath62 .",
    "a solution of @xmath53 is called a _ partial solution _ of @xmath63 on @xmath64 .",
    "the set of all such solutions is denoted by @xmath65 . if @xmath66 or @xmath67 , we simplify notation to @xmath68 and @xmath69 , respectively .",
    "instance @xmath63 is called _ minimal _ if every tuple @xmath70 for any constraint @xmath49 can be extended to a solution of @xmath63 ; that is , there is @xmath71 such that @xmath72 $ ] for @xmath73 .",
    "instance @xmath63 is called _",
    "@xmath74-minimal _ if @xmath53 is minimal for all @xmath74-element @xmath52 . for any",
    "fixed @xmath74 every instance can be reduced to a @xmath74-minimal instance in polynomial time by a standard algorithm @xcite : cycle over all @xmath74 element subsets @xmath52 , solve the problem @xmath53 , and for every constraint @xmath43 exclude from @xmath30 all tuples inconsistent with @xmath65 . if @xmath75 for some class of finite algebras @xmath46 closed under subalgebras , the resulting problem also belongs to @xmath47 .",
    "in particular , from now on we will assume that all the instances we deal with are 1-consistent .",
    "for such problems we can also _ tighten _ the instance reducing the domains @xmath41 , @xmath76 , to the sets @xmath77 .",
    "every constraint relation will therefore be assumed to be a subdirect product of the respective domains .",
    "if @xmath46 consists of idempotent algebras , then any problem from @xmath47 can be reduced to a minimal one by solving polynomially many instances of @xmath47 .",
    "first of all , _ constant relations _ , @xmath78 , @xmath79 ,",
    "are subalgebras of @xmath0 and therefore can be used in constraints",
    ". then the algorithm proceeds as follows : cycle over all constraints @xmath80 and all @xmath70 ; replace @xmath81 with the collection of unary constraints @xmath82),\\rel_{\\ba[\\bs[i]]}}$ ] ; solve the resulting instance @xmath83 ; remove @xmath28 from @xmath30 if @xmath83 has no solutions .",
    "the set ( lattice ) of congruences of an algebra @xmath0 will be denoted by @xmath84 .",
    "the smallest congruence of @xmath0 , the equality relation , is denoted by @xmath85 , and the greatest congruence , the total relation , is denoted by @xmath86 .",
    "if @xmath87 are related by a congruence @xmath88 , we write @xmath89 ; the @xmath88-block containing @xmath90 is denoted @xmath91 .",
    "let @xmath30 be a subdirect product of @xmath92 , and @xmath93 , @xmath94 $ ] .",
    "then by @xmath95 , or simply @xmath96 if @xmath30 is clear from the context , we denote the congruence @xmath97 of @xmath30 given by @xmath98 if and only if @xmath99\\eqc{\\al_i}\\bb[i]$ ] for all @xmath100 $ ] .",
    "also , if @xmath101 $ ] then by @xmath102 we denote the congruence @xmath103 of @xmath104 .",
    "let @xmath105 be an instance and @xmath106 a congruence of @xmath77 .",
    "by @xmath107 we denote the instance @xmath108 , in which @xmath109 , and a constraint @xmath110 , @xmath44 , belongs to @xmath111 if and only if a constraint @xmath43 , where @xmath112^{\\al_{v_1}}\\zd\\ba[k]^{\\al_{v_k } } ) : \\ba\\in\\rel\\},\\ ] ] belongs to @xmath42 .",
    "a pair of congruences @xmath113 is said to be a _ prime quotient _ , denoted @xmath114 , if @xmath115 and @xmath116 for no congruence @xmath117 .",
    "then @xmath118 means that @xmath114 or @xmath119 . for an operation @xmath1 on @xmath0",
    "we write @xmath120 if , for any @xmath121 with @xmath122 , @xmath123 . as usual , by an _",
    "idempotent unary polynomial _ we mean a polynomial @xmath124 such that @xmath125 or , equivalently , such that @xmath126 for any @xmath127 from its range .",
    "@xmath128-minimal set _ is a minimal ( under inclusion ) set @xmath129 such that @xmath130 for a unary idempotent polynomial of @xmath0 satisfying @xmath131 .",
    "recall that algebra @xmath0 is called _",
    "maltsev _ if it has a ternary term operation @xmath132 satisfying the equations @xmath133 . every algebra from the variety generated by a maltsev algebra is _ congruence permutable _ , that is any two of its congruences @xmath134 satisfy the condition @xmath135 . in particular ,",
    "the congruence lattice of a maltsev algebra is _ modular_.    let @xmath30 be a subdirect product of @xmath92 .",
    "similar to tuples from @xmath30 , polynomials of @xmath30 are also denoted in boldface , say ,  @xmath136 .",
    "the polynomial @xmath136 can be represented as @xmath137 where @xmath5 is a term operation of @xmath30 and @xmath138 .",
    "then the polynomial @xmath139\\zd \\ba^\\ell[i])$ ] of @xmath140 is denoted by @xmath141 , and for @xmath142 $ ] , @xmath143 denotes the polynomial @xmath144 of @xmath104 . for any @xmath145 , and any polynomial @xmath1 of @xmath140 ,",
    "there is a polynomial @xmath146 of @xmath30 such that @xmath147 .",
    "we shall call @xmath146 an _ extension _ of @xmath1 to a polynomial of @xmath30 . finally , for @xmath148",
    "$ ] , and @xmath149 and @xmath150-i}\\za_i$ ] , @xmath151 denotes the tuple @xmath152 such that @xmath153=\\ba[i]$ ] for @xmath154 and @xmath153=\\bb[i]$ ] if @xmath100-i$ ] . to distinguish such concatenation of tuples from pairs of tuples",
    ", we will denote pairs of tuples by @xmath155 .",
    "the two propositions below list the main basic properties of relations over maltsev algebras , their congruences , and minimal sets .    [",
    "pro : basics ] let @xmath30 be a subdirect product of maltsev algebras @xmath156 @xmath157 and @xmath148 $ ] . then the following properties hold + ( 1 ) @xmath30 is _ rectangular _ , that is if @xmath158-i}\\rel$ ] and @xmath159 , @xmath160 , then @xmath161 . + ( 2 ) the relation @xmath162 there is @xmath163-i}\\rel$ ] such that @xmath164 , @xmath165 is a congruence of @xmath104 .",
    "+ ( 3 ) @xmath30 is a disjoint union of sets of the form @xmath166 where @xmath20 is a @xmath167-block and @xmath81 is a @xmath168-i}$]-block .",
    "[ pro : minimal - sets ] let @xmath0 be a finite algebra and @xmath114 for @xmath113 .",
    "+ ( 1 ) any two @xmath128-minimal @xmath169 sets are _ polynomially isomorphic _ ; that is , there is a unary idempotent polynomials @xmath170 of @xmath0 such that @xmath171 , @xmath172 and @xmath173 , @xmath174 are identity mappings on @xmath16 and @xmath129 , respectively . + ( 2 ) if @xmath175 is a prime factor _ projective _ to @xmath114 in @xmath84 , then every @xmath128-minimal set is also @xmath176-minimal , and conversely , every @xmath176-minimal set is also @xmath128-minimal .",
    "+ ( 3 ) if @xmath0 is maltsev , then for any @xmath121 with @xmath177 , there is an @xmath128-minimal set containing both @xmath178 and @xmath179 .      since the fewer operations an algebra has , the richer the corresponding constraint language",
    ", we assume that the algebras we are dealing with have only two basic operations , just enough to guarantee the required properties .",
    "an algebra @xmath0 is called a _ semilattice block maltsev _ ( sbm ) algebra if it has two basic operations : a binary operation @xmath180 that we will often omit , and a ternary operation @xmath181 that satisfy the following conditions .",
    "there is a congruence @xmath182 of @xmath0 such that @xmath183 is term equivalent to a semigroup with semigroup operation @xmath180 , and every @xmath182-block @xmath20 is a maltsev algebra , where @xmath181 is a maltsev operation and @xmath180 is the first projection . for elements @xmath121 such that @xmath184 we write @xmath185 .",
    "[ lem : dot - inequality ] let @xmath0 be an sbm algebra . by choosing a reduct of @xmath0 we may assume that    * operation @xmath180 satisfies the equation @xmath186 ; in particular , for any @xmath121 @xmath187 . * for any @xmath188 , @xmath189 .",
    "\\(1 ) follows from @xcite .",
    "\\(2 ) the operation @xmath190 is maltsev on every @xmath182-block and satisfies the condition of the lemma .",
    "next we show several useful properties of sbm algebras .",
    "let @xmath0 be an sbm algebra and @xmath191 the maximal block of @xmath3 , that is , @xmath192 for all @xmath193 .",
    "[ lem : irreducible - maximal ] ( 1 ) the equivalence relation @xmath194 whose blocks are @xmath191 and all the remaining elements form singleton blocks , is a congruence .",
    "+ ( 2 ) let @xmath30 be a subdirect product of sbm algebras @xmath195 and the equivalence relation @xmath196 is such that its blocks are @xmath197 , and all the remaining elements form singleton blocks . then @xmath196 is a congruence .",
    "\\(1 ) it suffices to observe that for any @xmath198 we have @xmath199 , @xmath200 for any @xmath201 , and therefore all polynomials of @xmath0 preserve @xmath191 .",
    "\\(2 ) is similar to ( 1 ) .",
    "[ lem : min - set ] every @xmath128-minimal set , for @xmath202 , is a subset of @xmath191 .",
    "let @xmath16 be a @xmath128-minimal set and @xmath1 a polynomial with @xmath203 and @xmath131 .",
    "we may assume @xmath1 is idempotent .",
    "since @xmath204 , @xmath205 .",
    "take @xmath198 and set @xmath206 . then as before @xmath207 and @xmath208 . finally , @xmath209 , therefore @xmath210 and @xmath211 for @xmath212 . as @xmath16 is minimal , @xmath213 .",
    "[ lem : modularity ] let @xmath30 be a subdirect product of @xmath214 .",
    "the interval @xmath215 in @xmath216 is modular .",
    "let @xmath217 denote the restriction of @xmath218 on @xmath219 and @xmath220 with added unary operations that are restrictions of unary polynomials of @xmath30 .",
    "this definition is proper , as every polynomial of @xmath30 preserves @xmath221 .",
    "since all the non - trivial blocks of @xmath196 are contained in @xmath221 , interval @xmath215 in @xmath216 is isomorphic to @xmath222 .",
    "as @xmath221 is a maltsev algebra , the claim follows .      in this section",
    "we describe a reduction introduced by maroti in @xcite that allows us to reduce csps over sbm algebras to csps over sbm algebras of a certain restricted type .",
    "more precisely , it allows us to assume that every domain @xmath0 contains a _ minimal element _",
    "@xmath178 , that is , an element such that @xmath184 for all @xmath223 .",
    "moreover , as is easily seen , such element is unique and forms a @xmath182-block , which is also the smallest element of the semilattice @xmath183 .",
    "let @xmath1 be an idempotent unary polynomial of algebra @xmath0 , @xmath224 is the universe of @xmath0 .",
    "the _ retract _",
    "@xmath225 of @xmath0 is the algebra with universe @xmath226 , and whose basic operations are of the form @xmath227 , given by @xmath228 for @xmath229 , where @xmath5 is a basic operation of @xmath0 .",
    "[ lem : retract ] a retract of an sbm algebra through an idempotent polynomial is an sbm algebra .",
    "let @xmath1 be an idempotent polynomial .",
    "let @xmath230 , @xmath231 be the basic operations of the reduct , and @xmath232 , and @xmath233 .",
    "firstly , note that @xmath234 is a congruence of @xmath235 and @xmath235 is an idempotent algebra .",
    "since @xmath183 is term equivalent to a semilattice and any retract of a semilattice is a semilattice , so is @xmath236 . finally , @xmath237 for any @xmath238 with @xmath239 .",
    "the results of @xcite imply the following .",
    "let @xmath46 be a class of finite algebras of similar type closed under subalgebras , and retracts via idempotent unary polynomials .",
    "suppose that @xmath46 has a term operation @xmath1 satisfying the following conditions for some @xmath240 :    * @xmath241 for any @xmath242 ; * for each @xmath12 the mapping @xmath243 is not surjective ; * the set @xmath81 of @xmath12 such that @xmath244 is surjective generates a proper subalgebra of @xmath11 .",
    "then @xmath47 is polynomial time reducible to @xmath245 .    as is easily seen , the operation @xmath180 of the class of sbm algebras from @xmath46 satisfies condition ( 1 ) . if the operation @xmath246 is surjective for some @xmath178 , then @xmath247 for all @xmath248",
    ". therefore the only case when condition ( 2 ) is not satisfied is when @xmath11 has a minimal element .",
    "finally , condition ( 3 ) is satisfied whenever @xmath11 is not a maltsev algebra .",
    "therefore , choosing @xmath11 to be a maximal ( in terms of cardinality ) algebra from @xmath46 satisfying conditions ( 1)(3 ) we may only consider instances of @xmath47 , in which every domain has a minimal element or is a maltsev algebra .",
    "[ cor : maroti ] every instance @xmath75 can be reduced in polynomial time to a polynomially many instances over algebras with minimal elements .    throughout the rest of the paper @xmath46",
    "is a finite class of finite sbm algebras closed under taking subalgebras , homomorphic images , and retracts through unary idempotent polynomials .",
    "in this section we introduce and study a method of decomposition of subdirect products of sbm algebras . throughout the section",
    "@xmath249 is a subdirect product of sbm algebras @xmath0 and @xmath250 , unless otherwise stated .",
    "we will say that an index @xmath251 $ ] _ can be separated _ from @xmath252 $ ] _ with respect to @xmath253 _ , if there exists a unary polynomial @xmath136 of @xmath30 such that @xmath254 and @xmath255 .",
    "if @xmath136 satisfies this property we will also say that @xmath136 _ separates _",
    "@xmath145 from @xmath256 with respect to @xmath253 .",
    "[ lem : max - separate ] if @xmath145 can be separated from @xmath256 then there is a polynomial @xmath136 that separates @xmath145 from @xmath256 and such that @xmath257 for every @xmath258 $ ] .",
    "let @xmath146 separate @xmath145 from @xmath256 .",
    "choose a tuple @xmath259 and consider the polynomial @xmath260 .",
    "as is easily seen , @xmath261 . since @xmath262 , we have @xmath255 . finally , take @xmath263 and @xmath264 such that @xmath265 , @xmath266 .",
    "such elements exist , because @xmath254 and all the nontrivial @xmath267-blocks are inside @xmath219 . then @xmath268=a\\ba[i]=a\\\\ & & \\qquad \\ne b = b\\ba[i]=g_i(b')\\ba[i]=f_i(b').\\end{aligned}\\ ] ]    from now on we assume that all polynomials separating coordinate positions satisfy the conditions of lemma  [ lem : max - separate ] .",
    "[ lem : selected ] if @xmath145 can be separated from @xmath256 then , for any @xmath269-minimal set @xmath129 , there is an idempotent unary polynomial @xmath146 such that @xmath270 , and @xmath146 separates @xmath145 from  @xmath256 .",
    "let @xmath136 separate @xmath145 from @xmath256 .",
    "then @xmath271 contains an @xmath269-minimal set @xmath16 , and there is an idempotent polynomial @xmath272 with @xmath273 .",
    "the polynomial @xmath272 can be extended to a polynomial @xmath274 of @xmath30 .",
    "then @xmath275 separates @xmath145 from @xmath256 and @xmath276 .",
    "there is a @xmath269-minimal set @xmath64 with @xmath277 and an idempotent polynomial @xmath278 with @xmath279 . as above the polynomial @xmath278",
    "can be extended to a polynomial @xmath280 of @xmath30 . for a certain @xmath74 ,",
    "@xmath281 is idempotent , separates @xmath145 from @xmath256 , and @xmath282 .",
    "now the lemma follows easily from the fact that any two @xmath269-minimal sets are polynomially isomorphic .",
    "[ lem : symmetric ] if @xmath145 can be separated from @xmath256 and @xmath283 then @xmath256 can be separated from  @xmath145 .",
    "let @xmath284 be all the @xmath269-minimal sets .",
    "by lemma  [ lem : selected ] , for every @xmath285 , there is an idempotent unary polynomial @xmath286 separating @xmath145 from @xmath256 and such that @xmath287 .",
    "take a @xmath288-block @xmath20 that contains more than one @xmath289-blocks , a tuple @xmath70 such that @xmath290 , and set @xmath291 . by lemmas  [ lem : min - set ] and",
    "[ lem : max - separate ] @xmath292 and @xmath293 , and @xmath294 .",
    "the operation @xmath295 satisfies the conditions    * @xmath296)= \\mal(x , x,\\ba^{(\\ell)}[i ] ) = a^{(\\ell)}[i]$ ] forevery @xmath297 ; * @xmath298)\\eqc{\\al_j } \\mal(x,\\ba^{(\\ell)}[j],\\ba^{(\\ell)}[j ] ) = x$ ] forevery @xmath299 ; * @xmath300 .",
    "we are going to compose the polynomials @xmath301 such that the composition collapses @xmath267 . to this end",
    "take a sequence @xmath302 such that @xmath303 is a subset of the range of @xmath304 , and , for @xmath305 , @xmath306 is a subset of the range of @xmath307 .",
    "since @xmath308 , there is @xmath309 such that @xmath310 contains no @xmath269-minimal sets .",
    "therefore , setting @xmath311 we have @xmath272 collapses all the @xmath269-minimal sets , and @xmath312 acts identically on @xmath313 .",
    "therefore , @xmath274 separates @xmath256 from  @xmath145 .",
    "let @xmath314 $ ] be the set of all @xmath251 $ ] with @xmath315 .",
    "the relation @xmath316 on @xmath317 consisting of all pairs @xmath318 such that @xmath145 can not be separated from @xmath256 with respect to @xmath253 is obviously reflexive and transitive , and is symmetric by lemma  [ lem : symmetric ] .",
    "so , @xmath316 is an equivalence relation .",
    "we call its classes _ coherent sets _ with respect to @xmath253 .",
    "we show that coherent sets possess some additional useful properties .",
    "[ coherent - projection ] let @xmath319 $ ] , and @xmath320 the coherent sets of @xmath30 with respect to @xmath253 .",
    "then the coherent sets of @xmath104 with respect to @xmath321 are @xmath322 .",
    "lemma  [ coherent - projection ] follows from the observation that whether @xmath145 can be separated from @xmath256 or not depends entirely on the algebra @xmath323 .",
    "[ lem : real - coherent ] if @xmath319 $ ] is a coherent set then there is a unary polynomial @xmath136 of @xmath30 such that @xmath324 moreover , for any @xmath325 , and any @xmath326-minimal set @xmath327 , the polynomial @xmath136 can be chosen such that @xmath328 .",
    "take @xmath154 and an @xmath269-minimal set @xmath129 .",
    "by lemma  [ lem : selected ] , for every @xmath329 , there is an idempotent polynomial @xmath330 such that @xmath331 separates @xmath145 from @xmath256 and @xmath332 .",
    "composing all these polynomials we obtain an operation @xmath136 such that @xmath255 for every @xmath329 , and @xmath333 for @xmath334 .",
    "since for every @xmath335 the polynomial @xmath136 does not separate @xmath145 from @xmath336 , we have @xmath337 .",
    "let now @xmath136 be an operation separating each @xmath154 from each @xmath329 and such that the sum of @xmath338 , for @xmath154 , is minimal among the operations with this property .",
    "then , for every @xmath154 , @xmath271 is an @xmath269-minimal set . indeed , suppose that there is @xmath154 such that @xmath271 is not a minimal set",
    ". then @xmath271 contains an @xmath269-minimal set @xmath16 and there is an idempotent unary polynomial @xmath339 with the range @xmath16 .",
    "as is easily seen , for an extension @xmath146 of @xmath339 to a polynomial of @xmath30 , the operation @xmath340 still separates every @xmath325 from every @xmath329 , but the sum of @xmath341 , @xmath342 , is less than that for @xmath136 ; a contradiction .    finally , arguing as in the proof of lemma  [ lem : selected ]",
    "we may derive an idempotent polynomial with the required properties .",
    "we say that prime interval @xmath114 in @xmath84 can be _ separated _ from a prime interval @xmath343 if there is a unary polynomial @xmath1 of @xmath0 such that @xmath131 , but @xmath344 .",
    "we say that a congruence @xmath345 is _ e - minimal _ for the interval @xmath134 if for every @xmath346 , the interval @xmath343 can not be separated from @xmath114 .",
    "separation as it is just introduced is closely related to separation as it is defined in section  [ sec : separation ] .",
    "[ lem : separation - separation ] let @xmath347 be the binary equality relation on @xmath0 .",
    "prime interval @xmath202 can be separated from @xmath348 as intervals in @xmath84 if and only if 1 can be separated from 2 in @xmath347 with respect to @xmath349 and @xmath350 .",
    "note that for any polynomial @xmath136 its action on the first and second projections of @xmath347 is the same polynomial of @xmath0 .",
    "therefore @xmath114 can be separated from @xmath343 in @xmath84 if and only if , there is a unary polynomial @xmath1 of @xmath0 , @xmath131 while @xmath344 .",
    "this condition can be expressed as follows : there is a unary polynomial @xmath136 of @xmath347 , @xmath351 while @xmath352 , which precisely means that 1 can be separated from 2 in @xmath347 .",
    "[ cor : e - related ] let @xmath0 be any sbm algebra .",
    "+ ( 1 ) if @xmath202 can be separated from @xmath348 , then @xmath343 can be separated from @xmath114 .",
    "+ ( 2 ) if prime intervals @xmath114 and @xmath343 are projective , then they can not be separated from each other .",
    "+ ( 3 ) if @xmath348 and @xmath202 can not be separated , then a set @xmath129 is a @xmath128-minimal set if and only if it is an @xmath353-minimal set .",
    "\\(1 ) follows from lemmas  [ lem : symmetric ] and  [ lem : separation - separation ] .",
    "\\(2 ) follows from proposition  [ pro : minimal - sets](2 ) , as @xmath128- and @xmath353-minimal sets are the same .",
    "\\(3 ) consider the binary equality relation @xmath347 on @xmath0 . by lemma  [ lem : separation - separation ] 1",
    "can not be separated from 2 with respect to @xmath349 and @xmath350 . by lemma  [ lem",
    ": real - coherent ] for any @xmath128-minimal set @xmath129 there is a polynomial @xmath136 of @xmath347 such that @xmath354 and @xmath355 is a @xmath353-minimal set .",
    "however , @xmath356 , the result follows .",
    "[ lem : linkage ] ( 1 ) if @xmath357 is e - minimal for @xmath202 , then @xmath358 .",
    "+ ( 2 ) if @xmath359 are e - minimal for @xmath202 , then so is @xmath360 .",
    "+    \\(1 ) take @xmath198 and consider the polynomial @xmath361 .",
    "this polynomial does not collapse @xmath362 to @xmath88 but collapses @xmath0 onto @xmath191 , and so every interval @xmath363 with @xmath364 and @xmath365 .",
    "\\(2 ) by lemma  [ lem : modularity ] the interval @xmath366 $ ] in @xmath84 is modular .",
    "therefore every prime interval in @xmath367 $ ] , @xmath368 , is projective to an inteval in @xmath369 $ ] or to an interval in @xmath370 $ ] .",
    "therefore , for every prime factor @xmath371 , every @xmath372-minimal set @xmath129 is a minimal set of some prime factor @xmath373 , @xmath374 or @xmath375 .",
    "thus if some @xmath1 collapses @xmath376 , we have @xmath377 for any @xmath372-minimal set @xmath129 . therefore , @xmath1 collapses @xmath372 .    by lemma  [ lem : linkage](2 )",
    "there is the greatest congruence of @xmath0 e - minimal for @xmath114 ; it will be denoted by @xmath378 .      for a set",
    "@xmath319 $ ] , let us denote the equality relations on @xmath30 , @xmath379 by @xmath380 , @xmath381 respectively , and for any @xmath382 , @xmath383}\\gm_i$ ] , @xmath384 .",
    "the following lemma shows a connection between minimal sets of @xmath30 and its coherent sets .",
    "[ lem : minimal - set ] let @xmath385if @xmath315 and @xmath386 otherwise .",
    "let @xmath387 , and let @xmath388 be a @xmath353-minimal set for an idempotent polynomial @xmath136 .",
    "then @xmath136 satisfies  for a certain coherent set with respect to @xmath253 .",
    "first we prove the claim of the lemma in a particular case .",
    "let @xmath389 , @xmath390 $ ] is such that @xmath283 , and @xmath391 , where @xmath392 and @xmath393 for @xmath394 ; then by the rectangularity of @xmath220 ( proposition  [ pro : basics ] ) either @xmath395 or @xmath396 .",
    "notice that in the latter case the rectangularity of @xmath221 implies that for any @xmath397 , @xmath398 , there are @xmath399 with @xmath400=a,\\bb[j]=b$ ] , and such that @xmath401 .",
    "claim 1 . for any @xmath389 , @xmath402 for @xmath251",
    "$ ] , any @xmath252 $ ] with @xmath283 , and @xmath391 , @xmath403 such that @xmath392 and @xmath393 for @xmath394 , every idempotent polynomial @xmath136 of @xmath30 such that @xmath388 is an @xmath404-minimal set satisfies  for the coherent set @xmath405 containing  @xmath256 .",
    "as is easily seen , @xmath406 ; therefore , there is a @xmath407-minimal set @xmath408 , which is also an @xmath409-minimal set .",
    "take a polynomial @xmath146 satisfying  for  @xmath405 , and such that @xmath410 .",
    "let @xmath74 be such that @xmath411 is idempotent .",
    "then @xmath412 , @xmath413 if and only if @xmath414 , that is , @xmath415 satisfies  for  @xmath405 , and @xmath416 .",
    "since @xmath417 , and @xmath418 is a @xmath419-minimal set , we have @xmath420 .",
    "moreover , as @xmath421 , we have @xmath422 , and the claim is proved .",
    "then we prove that , for any prime quotient @xmath423 , there are @xmath424 , @xmath425 , and @xmath252 $ ] with @xmath283 such that @xmath426 and @xmath393 for @xmath394 , and such that @xmath176 is projective to @xmath419 , and therefore , @xmath388 is an @xmath176-minimal set if and only if it is a @xmath419-minimal set .",
    "this , however , follows from the fact that among conguences of the form @xmath427 we can find a maximal chain from @xmath96 to @xmath428 .",
    "[ cor : special ] ( 1 ) let @xmath319 $ ] be a coherent set , and @xmath429 , @xmath430 , @xmath431 , and @xmath432 in @xmath216 . then , any idempotent polynomial @xmath136 of @xmath30 such that @xmath388 is an @xmath433-minimal set satisfies  for  @xmath405 .",
    "\\(2 ) let @xmath434 be a tuple from a nontrivial @xmath435-block and such that @xmath436 is in a nontrivial @xmath437-block .",
    "there is a polynomial @xmath136 satisfying  for @xmath405 and such that @xmath438 .",
    "\\(1 ) by lemma  [ lem : minimal - set ] , @xmath136 satisfies  for a certain coherent set @xmath439 . if @xmath440 , then @xmath441 for any @xmath154 .",
    "therefore , @xmath442 , and @xmath443 .",
    "\\(2 ) let @xmath357 be the greatest congruence of @xmath104 such that @xmath444 and @xmath445 contains only one @xmath102-block , and @xmath446 .",
    "since @xmath447 lies in a nontrivial @xmath437-block , @xmath448 and by proposition  [ pro : minimal - sets](3 ) @xmath447 belongs to a @xmath353-minimal set .",
    "let @xmath449 be congruences constructed as in part  ( 1 ) of the corollary .",
    "then there is an idempotent polynomial @xmath136 satisfying  for @xmath405 , and such that @xmath450 .",
    "set @xmath451 . since @xmath441 whenever @xmath452 , we have @xmath453 and @xmath454)=\\ba[i]$ ] . if @xmath154 and @xmath455 then @xmath333 , and therefore @xmath456),\\ba[i])=\\mal(x,\\ba[i],\\ba[i])=x.\\ ] ] this means @xmath457",
    "moreover , as @xmath271 is a @xmath269-minimal set , @xmath458 is also a @xmath269-minimal set .",
    "thus , for a certain @xmath74 , @xmath459 is idempotent and satisfies  for @xmath405 .",
    "finally , @xmath460)=\\mal(f_i(\\ba[i]),f_i(\\ba[i]),\\ba[i])=\\ba[i].\\ ] ] so , @xmath461 ; the corollary is proved .",
    "[ lem : semirectangularity ] let @xmath20 be a @xmath435-block of @xmath30 , such that @xmath462 for @xmath251 $ ]",
    ". then @xmath463 where @xmath320 are the coherent sets with respect @xmath253 and @xmath464\\mid \\al_i=\\beta_i\\}$ ] .",
    "set @xmath465 , @xmath466-i$ ] .",
    "we prove that @xmath467 . by taking factors",
    "modulo @xmath468 we may assume @xmath469 , @xmath251 $ ] .",
    "consider two congruences on @xmath104 : @xmath470 and @xmath471 , @xmath472 .",
    "notice that if for @xmath473 there is @xmath474 with @xmath475 then the rectangularity of @xmath476 implies that , for any @xmath477 such that @xmath478 , the tuple @xmath479 also belongs to  @xmath30 .",
    "analogously , for any @xmath473 with @xmath480 , there are @xmath481 such that @xmath482 .",
    "we are to prove that if @xmath483 then @xmath484 , or , equivalently , the equality @xmath485 .",
    "denote the congruences appearing in this equality by @xmath357 and @xmath486 , respectively .",
    "if @xmath487 then , for congruences @xmath449 constructed as in corollary  [ cor : special](1 ) , there is an idempotent unary polynomial @xmath136 satisfying  for @xmath405 and such that @xmath388 is a @xmath433-minimal set .",
    "however , this leads to a contradiction because on the one hand @xmath488 , hence @xmath489 , but on the other hand @xmath490 for any @xmath136 satisfying  for  @xmath405 .    repeating the same argument for each coherent set we get what is required .",
    "an element @xmath491 is called _",
    "@xmath492-split _ if there is a @xmath267-block @xmath20 and @xmath493 such that @xmath494 .",
    "note that no element from @xmath219 is @xmath492-split , while the minimal element is @xmath492-split .",
    "we say that @xmath495 $ ] are not _ @xmath496-aligned _ if there is @xmath70 such that @xmath99 $ ] is not @xmath492-split and @xmath400 $ ] is @xmath497-split , or the other way round .",
    "[ lem : align - coherence ] if @xmath498 are not @xmath492-aligned then they are in different coherent sets with respect to @xmath253 .",
    "it suffices to consider the case @xmath499 , @xmath375 , @xmath500 .",
    "let @xmath501 be such that @xmath178 is @xmath492-split , while @xmath179 is not @xmath497-split .",
    "let also @xmath502 .",
    "consider operation @xmath503 .",
    "we claim that @xmath504 while @xmath505 .",
    "first , observe that all the values of the operation @xmath506 belong to @xmath221 , and @xmath507 for any @xmath508 .",
    "then , for any nontrivial @xmath509-block @xmath510 and any @xmath511 we have @xmath512 , as @xmath179 is not @xmath513-split .",
    "thus @xmath505 . on the other hand ,",
    "since @xmath178 is @xmath514-split , there is a @xmath515-block @xmath516 and @xmath517 such that @xmath518 .",
    "therefore @xmath504 .",
    "let @xmath519 , and let @xmath520 be the smallest congruence such that @xmath521 and @xmath114 can not be separated for some @xmath522 .",
    "observe that since the interval @xmath366 $ ] in @xmath84 is modular , the intersection of all @xmath523 $ ] such that @xmath524 can not be separated from @xmath114 for some @xmath525 , such an @xmath520 exists .",
    "for @xmath117 , @xmath358 , if @xmath526 , let @xmath527 denote the smallest congruence such that there is an irreducible chain @xmath528 and every prime interval @xmath529 can be separated from @xmath114 . by @xmath530",
    "we denote the smallest congruence such that there is an irreducible chain @xmath531 and every prime interval @xmath529 can not be separated from @xmath114 .",
    "again the modularity of @xmath366 $ ] implies that such smallest congruences exist .",
    "a unary idempotent polynomial @xmath1 is called _ @xmath128-collapsing _ with respect to @xmath198 if the following conditions hold :    * for any @xmath117 , @xmath532 , it holds @xmath533 ; * for any @xmath117 , @xmath358 and any @xmath534 with @xmath535 , @xmath536 .",
    "[ lem : collapse - uncollapse ] for every sbm algebra @xmath0 , any @xmath537 , @xmath202 , and any @xmath193 from a @xmath362-block containing more than one @xmath88-block , there is a @xmath128-collapsing polynomial @xmath1 with respect to @xmath178 .",
    "let @xmath520 be the smallest congruence such that @xmath521 and @xmath114 can not be separated for some @xmath522 .",
    "first , we show that @xmath0 has a polynomial @xmath1 satisfying the following conditions",
    ".    * @xmath131 ; * @xmath538 for any @xmath117 , @xmath358 .    for any prime interval @xmath343 that can be separated from @xmath114 , there is a unary polynomial @xmath539 such that @xmath540 , but @xmath541 .",
    "we may assume that all the @xmath539 are idempotent and have the same @xmath128-minimal set as image .",
    "as is easily seen , composing all such polynomials we obtain the result .",
    "let us denote the resulting polynomial by @xmath1 .",
    "we may assume @xmath1 is idempotent and @xmath130 is a @xmath128-minimal set such that @xmath542 .",
    "set @xmath543 ; then @xmath544 .",
    "take @xmath117 , @xmath358 , and @xmath545 .",
    "since @xmath538 , we obtain @xmath546 .",
    "therefore @xmath547 .",
    "now let @xmath284 be a list of all @xmath128-minimal sets , and @xmath548 a function with @xmath549 and @xmath550 for all @xmath117 and @xmath545 .",
    "composing these polynomials as in the proof of lemma  [ lem : symmetric ] we obtain @xmath551 satisfies the following conditions : @xmath552 for any @xmath128-minimal set @xmath129 containing @xmath178 , and @xmath553 for all @xmath117 and @xmath545 .",
    "the first condition implies @xmath554 .",
    "[ lem : relation - collapse ] let @xmath555 be a subdirect product of sbm algebras , @xmath556 for @xmath557 , and @xmath558 for @xmath559 .",
    "let also @xmath405 be a coherent set with respect to @xmath253 and let @xmath560 be such that @xmath99 $ ] belongs to a @xmath267-block containing more than one @xmath468-block for some @xmath154 .",
    "there is an idempotent unary polynomial @xmath146 of @xmath30 such that @xmath561 is @xmath409-collapsing with respect to @xmath400 $ ] for all @xmath342 .",
    "we repeat the proof of lemma  [ lem : collapse - uncollapse ] for relations rather than individual algebras . without loss of generality",
    "assume @xmath562 $ ] .",
    "first , for every @xmath256 and every @xmath563 , @xmath564 such that @xmath343 can be separated from @xmath283 find a polynomial @xmath565 of @xmath30 such that @xmath566 and @xmath567 .",
    "note that as @xmath24 $ ] is a coherent set with respect to @xmath568 , @xmath569 for any @xmath325 . by lemma  [ lem : real - coherent ]",
    "we may assume that @xmath570 is a @xmath326-minimal set for all @xmath325 .",
    "we can also assume that for some @xmath571 the images of @xmath572 are equal to the same @xmath573-minimal set @xmath574 .",
    "as in the proof of lemma  [ lem : collapse - uncollapse ] , by composing all such polynomials we obtain an idempotent polynomial @xmath136 satisfying the following conditions for every @xmath342 :    * @xmath575 ; * @xmath576 for any @xmath577 , @xmath578 .",
    "let @xmath579 be a maximal congruence of @xmath30 from @xmath580 $ ] such that @xmath581 and @xmath582 $ ] such that @xmath175 .",
    "let @xmath583 be a @xmath176-minimal set such that @xmath584 .",
    "note that by lemma  [ lem : minimal - set ] @xmath585 is an @xmath409-minimal set and @xmath400\\in\\pr_ju$ ] for @xmath342 .",
    "set @xmath586 ; then @xmath587 .",
    "take @xmath577 , @xmath578 , @xmath342 , and @xmath588^\\gm$ ] .",
    "since @xmath589 , we obtain @xmath590 .",
    "therefore @xmath591 .",
    "now let @xmath284 be a list of all @xmath409-minimal sets for @xmath342 , and @xmath592 a function with @xmath593 and @xmath594 for all @xmath595 , @xmath325 , and @xmath545 .",
    "composing these polynomials we obtain a polynomial @xmath274 such that @xmath596 for any @xmath409-minimal set @xmath129 containing @xmath400 $ ] , @xmath342 , and @xmath597 for all @xmath577 and @xmath588^\\gm$ ] .",
    "the first condition implies @xmath598^\\gm)\\sse \\ba[j]^{\\nu_{\\al_j\\beta_j}(\\gm)}$ ] .",
    "we then complete the proof again composing all such polynomials for all @xmath342 .",
    "a polynomial @xmath146 constructed in lemma  [ lem : relation - collapse ] we will call @xmath599-collapsing .",
    "let @xmath105 be a 3-minimal instance of @xmath47 .",
    "a partition @xmath600 of the set of variables is called a _ link partition _ if the following condition holds :    * for every @xmath51 there is a partition @xmath601 such that whenever @xmath602 for some @xmath145 , we have @xmath603 , and there is a bijection @xmath604\\to[k_w]$ ] such that for any @xmath605 and any @xmath606 $ ] , @xmath607 if and only if @xmath608 . + ( or in other words if every @xmath609 is a union of blocks of the link congruence with respect to @xmath610 . )    observe that , since @xmath63 is 3-minimal , the mappings @xmath611 are consistent , that is , for any @xmath612 from the same class @xmath613 it holds that @xmath614 .",
    "without loss of generality we will assume that @xmath611 is an identity mapping whenever @xmath615 belong to the same class of the partition .",
    "since coherent sets depend only on binary projections of a relation , coherent sets can be defined for 3-minimal instances as well .",
    "more precisely , let @xmath105 and @xmath616 , @xmath617 ; we say that @xmath18 is not separated from @xmath618 , @xmath619 , with respect to @xmath253 , if this is the case for @xmath610 . due to 3-minimality",
    " we can consider ternary sets of solutions  this relation is transitive .",
    "it is also reflexive and symmetric .",
    "the equivalence classes will be called coherent sets of @xmath63 with respect to @xmath253 .    [",
    "lem : coherent - product - instance ] let @xmath105 be an instance of @xmath47 and @xmath620 the coherent sets of @xmath63 with respect to @xmath253 , @xmath621 , @xmath622 , @xmath623 , @xmath51 .",
    "if @xmath624 has a solution @xmath625 such that @xmath626 and for every @xmath100 $ ] the problem @xmath627 has a solution @xmath628 such that @xmath629 for every @xmath630 , then @xmath631 has a solution @xmath632 , where @xmath633 whenever @xmath630 , @xmath100 $ ] .    replacing @xmath77 with the factor @xmath634",
    "we can assume @xmath635 .",
    "let @xmath49 and @xmath636 .",
    "by lemma  [ lem : semirectangularity ] @xmath637 therefore @xmath638 , and @xmath632 is a solution .    in a similar way we define another partition of @xmath16 based on @xmath496-alignment properties .",
    "variable @xmath619 are _ @xmath496-aligned _ if they are @xmath496-aligned in @xmath610 .",
    "as is easily seen , this property defines an equivalence relation ; let @xmath639 be the classes of this relation . by lemma  [ lem : align - coherence ] the @xmath496-alignment partition is coarser than the partition into coherent sets with respect to @xmath253 .    [",
    "lem : coherent - link - partition ] ( 1 ) if variables @xmath619 of an instance @xmath105 are @xmath496-aligned and @xmath77 has a minimal elemnt then @xmath640 also has a minimal element .",
    "+ ( 2 ) if every domain of an instance @xmath105 has a minimal element the partition of @xmath16 into aligned sets is a link partition .",
    "for every @xmath51 let @xmath641 denote the set of @xmath642-split elements of @xmath77 and let @xmath643 denote the set of @xmath642-non - split elements . as we observed before lemma  [ lem : align - coherence ] both sets are nonempty if @xmath77 has a minimal element , and @xmath644 if @xmath77 is a maltsev algebra .",
    "\\(1 ) if @xmath640 is a maltsev algebra then @xmath615 can not be @xmath496-aligned since @xmath645 , while @xmath646 .",
    "\\(2 ) for any @xmath647 and any pair @xmath605 , @xmath648 if and only if @xmath649 . therefore @xmath610 is link - partitioned , as well as @xmath650 for any constraint @xmath80 .",
    "let @xmath651 be a domain of @xmath63 .",
    "choose an irreducible chain of congruences @xmath652 in @xmath653 .",
    "let @xmath654 . if @xmath655 we set @xmath656 .",
    "we use the following notation . for @xmath657",
    "$ ] :    * @xmath658 is the greatest @xmath606 $ ] such that @xmath659 and every prime interval in @xmath660 can not be separated from @xmath661 if @xmath662 , and @xmath663 for @xmath664 ; * @xmath665 is the minimal @xmath606 $ ] such that @xmath666 and @xmath667 can not be separated from @xmath661 , if one exists and if @xmath662 ; @xmath668 otherwise .",
    "[ lem : e - relation ] let @xmath622 be such that @xmath675 , say , @xmath670 .",
    "let also @xmath676 .",
    "+ ( 1 ) the coherent sets with respect to @xmath677 , and @xmath678 are the same .",
    "+ ( 2 ) for any such coherent set @xmath64 the @xmath679- and @xmath680-collapsing polynomials are the same .",
    "let @xmath681 be a 3-minimal instance such that every its domain is either a maltsev algebra with respect to @xmath181 or has a minimal element .",
    "for every @xmath51 and @xmath682 $ ] let @xmath683 be the set of @xmath684 such that for some @xmath685 $ ] @xmath18 can not be separated from @xmath618 in @xmath610 with respect to @xmath686 . for @xmath687",
    "let @xmath688 , where @xmath256 is as above .",
    "let @xmath689 for @xmath687 and @xmath690 for @xmath691 .",
    "as is easily seen , @xmath683 is a coherent set of @xmath63 with respect to @xmath692 and does not depend on the choice of @xmath256 .",
    "we start with an auxiliary lemma .",
    "as is easily seen , for any @xmath427 such that @xmath694 for each @xmath51 , any coherent set @xmath64 of @xmath63 with respect to @xmath695 is a subset of @xmath696 for any @xmath697 and @xmath256 such that @xmath698 .",
    "[ lem : collapsing - rectangularity ] let @xmath427 be such that @xmath694 for each @xmath51 and @xmath64 a coherent set of @xmath63 with respect to @xmath695 ; and let @xmath699 be such that @xmath700 . for @xmath56",
    "if @xmath701 let @xmath702 and @xmath703 .",
    "suppose @xmath625 is a solution of @xmath704 such that if @xmath705 for some @xmath56 , then there is a @xmath706-collapsing polynomial @xmath136 of @xmath707 with @xmath708 .",
    "then there is a solution @xmath632 to @xmath709 such that @xmath710 .    if @xmath711 for all @xmath56 , then there is a @xmath706-collapsing polynomial @xmath136 such that @xmath712 for all @xmath713 , that is , for all @xmath714 , because @xmath715 . if @xmath705 for some @xmath56 then we consider the @xmath706-collapsing polynomial @xmath136 given in the lemma . for the same reason this polynomial satisfies the condition @xmath716 for all @xmath714 .    for every @xmath56 ,",
    "if we view @xmath17 as a subset of @xmath717 , @xmath718 , as @xmath136 is @xmath706-collapsing and @xmath719 .",
    "consider a constraint @xmath57 of @xmath720 .",
    "there is a tuple @xmath70 such that @xmath721\\in\\vf(v)$ ] for @xmath722 .",
    "then @xmath723 and the @xmath724-block containing this tuple does not depend on the choice of @xmath28 .",
    "therefore @xmath725 is a solution of @xmath709 .",
    "we prove two claims by induction for any @xmath726 such that @xmath694 for @xmath51 : + ( 1 ) the instance @xmath727 has a solution @xmath728 such that if @xmath729 then @xmath730 ; + ( 2 ) solution @xmath728 can be chosen such that for any coherent set @xmath64 with respect to @xmath695 , there is a @xmath706-collapsing polynomial @xmath136 of @xmath731 for @xmath699 with @xmath700 such that @xmath732 .",
    "+ if @xmath733 then @xmath734 and the result follows .",
    "the base case of induction is given by @xmath735 ; then the mapping @xmath736 is a solution since @xmath737 is a semilattice .",
    "suppose @xmath427 is such that for any @xmath738 with @xmath739 for @xmath51 , where at least one inequality is strict , claims ( 1 ) and ( 2 ) are true .",
    "by the induction hypothesis there is a solution @xmath632 of @xmath740 .",
    "let @xmath64 be a coherent set with respect to @xmath695 .",
    "for @xmath56 let @xmath701 , @xmath741 , and @xmath676 .",
    "let @xmath742 be the set of those @xmath18 for which @xmath705 .",
    "let also @xmath743 for @xmath744 .",
    "as is easily seen , @xmath745 is a coherent set with respect to @xmath678 .",
    "again by the induction hypothesis @xmath746 is a solution of @xmath747 and belongs to the range of some @xmath748-collapsing polynomial @xmath415 of @xmath749 .",
    "note that @xmath415 is also a @xmath750-collapsing .",
    "therefore , there is an extension of @xmath415 to a @xmath751-collapsing polynomial @xmath136 of @xmath731 .",
    "then @xmath752 for @xmath753 and @xmath754 .",
    "also , since @xmath755 .",
    "therefore , as @xmath136 is @xmath751-collapsing , @xmath756 . by lemma  [ lem : collapsing - rectangularity ]",
    "there is a solution @xmath625 of @xmath709 such that @xmath757 .",
    "since as in the proof of lemma  [ lem : collapsing - rectangularity ] @xmath625 is an image under polynomial @xmath136 , this also proves ( 2 ) for @xmath64 .      to show that theorem  [ the : block - minimal ] gives rise to a polynomial - time algorithm for @xmath47 we need to show how block minimality can be established .",
    "we prove that establishing block - minimality can be reduced to solving polynomially many smaller instances of @xmath47 .",
    "[ pro : to - block - minimal ] transforming an instance @xmath758 to a block minimal instance can be reduced to solving polynomially many instances @xmath759 such that @xmath760 and for all @xmath761 either @xmath762 is a maltsev algebra , or @xmath763 .      using the standard propagation algorithm and maroti s reduction ( section  [ sec : maroti ] ) we may assume that @xmath63 is 3-minimal and every @xmath77 is either maltsev or has a minimal element .",
    "let @xmath683 be the coherent sets as in the definition of block - minimality .",
    "we need to show how to make problems @xmath693 minimal .",
    "if every @xmath640 for @xmath687 is maltsev , @xmath693 can be made minimal using the algorithm from @xcite .",
    "if @xmath640 has a minimal element for some @xmath687 then by lemma  [ lem : coherent - link - partition ] @xmath693 is link partitioned , that is , it is a disjoint union of instances @xmath764 , where @xmath765 are such that @xmath766 is a disjoint union .",
    "we then transform them to minimal instances separately .",
    "andrei  a. bulatov , andrei  a. krokhin , and benoit larose .",
    "dualities for constraint satisfaction problems . in _ complexity of constraints - an overview of current research themes [ result of a dagstuhl seminar ] .",
    "_ , pages 93124 , 2008 .",
    "andrei  a. bulatov and matthew valeriote .",
    "recent results on the algebraic approach to the csp . in _ complexity of constraints - an overview of current research themes [ result of a dagstuhl seminar ] .",
    "_ , pages 6892 , 2008 ."
  ],
  "abstract_text": [
    "<S> there are two well known types of algorithms for solving csps : local propagation and generating a basis of the solution space . for several years </S>",
    "<S> the focus of the csp research has been on ` hybrid ' algorithms that somehow combine the two approaches . in this paper </S>",
    "<S> we present a new method of such hybridization that allows us to solve certain csps that has been out of reach for a quite a while . </S>",
    "<S> we consider these method on a fairly restricted class of csps given by algebras we will call semilattice block maltsev . </S>",
    "<S> an algebra @xmath0 is called semilattice block maltsev if it has a binary operation @xmath1 , a ternary operation @xmath2 , and a congruence @xmath3 such that the quotient @xmath4 with operation @xmath1 is a semilattice , @xmath1 is a projection on every block of @xmath3 , and every block of @xmath3 is a maltsev algebra with maltsev operation @xmath5 . </S>",
    "<S> we show that the constraint satisfaction problem over a semilattice block maltsev algebra is solvable in polynomial time .    </S>",
    "<S> h  s # 1#1_fin p # 1var(#1 ) # 1sg(#1 ) # 1cg(#1 ) # 1rbcomp(#1 )    = = = = = = =    # 1(_#1,_#1 )    = = = = =    p *o *    # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 )    = # 1#1 # 1#1 # 1 # 1#2#1 _ 1#1 _ # 2 = \\ # 1height7pt depth3pt width.4pt # 1/ # 1 # 1#2    (    c # 1 + # 2    )    # 1#2#3    (    c # 1 + # 2 + # 3    )    # 1#2#3#4    (    c # 1 + # 2 + # 3 + # 4    )    # 1#2#3#4#5#6    (    c # 1 + # 2 + # 3 + # 4 + # 5 + # 6    )    # 1#2#3    (    ccc 1&2&3 + # 1&#2&#3    )    = # 1id(#1 )    = = = = = = = = = = = =    = eufm10 scaled 1200 = eufm6 12= 12=12= = msbm10 = msbm8 11=11= 11==msbm10 scaled 1200 13=13= 13==``0b4e = ' ' 0d3f </S>"
  ]
}