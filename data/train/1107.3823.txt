{
  "article_text": [
    "learning generative models of natural images is a long - standing challenge .",
    "recently , a new spectrum of approaches , loosely referred to as `` deep learning '' ( dl ) , has led to advances in several ai - style learning tasks . at the heart of this framework",
    "is the use of rbms for greedy learning of multi - layered representations such as deep belief networks ( dbn ,  @xcite ) and deep boltzmann machines ( dbm ,  @xcite ) .",
    "however , despite interesting applications in vision ( e.g.  @xcite ) , it has become apparent that the basic formulation of the rbm is too limited to model images well , and several alternative formulations have recently been proposed ( e.g.  @xcite ) .",
    "one powerful notion from the computer vision literature is that of a layered representation .",
    "this allows images to be composed from several independent objects and can account for occlusion ( e.g.  @xcite ) . in  @xcite , we have proposed a model that introduces such a layered representation into the dl framework . in this model ,",
    "the masked rbm ( mrbm ) , an image is composed of several regions , each of which is modeled in terms of its shape and appearance .",
    "the region shape determines where a region is visible , and the appearance determines the color or texture of the region , while overlapping regions occlude each other .",
    "we used this architecture to formulate a generative model of lower - level structure in _ generic _ images and therefore assumed that all regions were equivalent , i.e. all regions were governed by the same shape and appearance models , and that shape and appearance were independent . for higher - level tasks such as recognition ,",
    "however , the different regions of an image are not equivalent and some are more interesting than others . here",
    ", we show that separating an image into _ qualitatively different _ layers and _ jointly _ modeling shape and appearance allows us to learn and represent specific objects or object categories _ independently _ of the background . as a result ,",
    "the representation of the foreground is less affected by background clutter .",
    "our model is able to perform foreground - background segmentation , and it can generate new instances of the foreground objects ( shape and appearance ) . in particular , we show that learning is possible directly from cluttered images and requires only very weak supervision : inspired by @xcite , we bootstrap learning with an approximate model of the background .",
    "this is easily obtained by training on general natural images and sufficient for learning then to proceed without further supervision : foreground objects can be detected as outliers under the background model and a model of the foreground can thus be learned from the regularities of these outliers across training images . to our knowledge",
    ", foreground - background segmentation has not previously been addressed in the dl framework .",
    "tang @xcite proposes a model that is related to ours and applies it to the problem of recognition under occlusion , but considers a simpler scenario with binary images and fully supervised learning only .",
    "our model extends the mrbm presented in  @xcite : instead of modeling general images that consist of generic and equivalent regions , it assumes that images contain a single foreground object in front of a cluttered background ( which can and often will also contain parts of other objects , but these are not explicitly modeled ) .",
    "foreground and background are assumed to be independent and the background is occluded by the foreground object . in the model , this is achieved by composing the _ observed _ image from two _ latent _ images : one for the background , and one for the foreground .",
    "the background image is visible only where the foreground is not , and the visibility of the foreground image is determined by a binary mask . intuitively speaking",
    ", the foreground image determines the _ appearance _ of the foreground object , and the mask determines its _ shape_. the model is a pixel - wise binary mixture with the mixture component for each pixel specified by the mask . denoting the observed image by @xmath0 , the background image by @xmath1 , and the appearance and shape of the foreground by @xmath2 and @xmath3 respectively",
    ", the model can be written as @xmath4^{m_i } \\ns \\!\\delta\\!\\left[\\vb_i \\ns = \\ns x_i\\right]^{(1-m_i)}\\ns \\right ) \\ns p_{\\mathrm{fg}}(\\vf\\ns , \\m ) p_{\\mathrm{bg}}(\\vb ) \\label{eq : fullmodel}\\ ] ] where @xmath5 is the pixel index , @xmath6 , and the product of delta functions forces , for each pixel , one of the two latent images to take on the value of the observed image at that pixel .",
    "the mask determines which latent image is chosen .",
    "we formulate the priors over the background image and over foreground appearance and shape as rbms . assuming that pixels are continuous valued in @xmath7 $ ] , we choose for @xmath8 a special form of the beta rbm with energy @xmath9 described in @xcite so that @xmath10 . unlike the gaussian rbm with fixed variance commonly used for continuous data",
    "( e.g.  @xcite ) , the beta rbm models mean _ and _ variance of the visible units .",
    "the model of the foreground object defines a joint distribution over a continuous valued image and a binary mask . here , we are interested in the case where shape and appearance are _ dependent _ and we will therefore model them jointly .",
    "this is in contrast with the approach taken in  @xcite where they were assumed to be independent , i.e. @xmath11 .",
    "thus , in this new model , we use a particular form of the rbm which has two sets of visible units , a set of binary units for the mask @xmath3 and a set of continuous valued units for the appearance image @xmath2 : @xmath12 where @xmath13 is the energy function of a binary rbm , and the joint distribution is thus given by : @xmath14 .",
    "* inference * : although exact inference is intractable , an efficient gibbs sampling scheme exists , as detailed in  @xcite .",
    "let @xmath15 and @xmath16 denote the hidden units of the foreground and the background model respectively , then the following properties admit a gibbs sampling scheme in which the three sets of variables @xmath17 , @xmath3 , and @xmath18 are sampled in turn :    1 .",
    "given @xmath2 and @xmath1 the hidden units @xmath15 and @xmath16 are conditionally independent , i.e. @xmath19 and @xmath20  , 2 .   given the hidden variables @xmath15 , @xmath16 and the image @xmath0 , the variables of the mask , foreground image , and background image are pixel - wise conditionally independent , i.e. @xmath21  , 3 .",
    "@xmath22 can be decomposed as follows @xmath23 \\pbg(\\vb_i|\\hb ) & ~~\\mathrm{if}~ m_i = 1 \\\\ \\delta\\left[\\vb_i = x_i\\right ] \\pfg(\\vf_i|\\hf ) & ~~\\mathrm{otherwise .",
    "} \\end{array } \\label{eq : conditional3 } \\right.\\end{aligned}\\ ] ]    * learning * : during learning with unlabeled data only @xmath0 is observed .",
    "we use an em - like approach in which inference of @xmath2 , @xmath1 , and @xmath3 alternates with updates of the model parameters .",
    "once these variables have been inferred , they can be treated as `` observed '' data for one of the usual learning schemes for rbms such as contrastive divergence ( cd ,  @xcite ) or stochastic maximum likelihood ( sml , also referred to as `` persistent cd ''  @xcite ) , which we use in the experiments below .",
    "sml relies on persistent chains of samples to represent the model distribution which are updated by one step of gibbs sampling per iteration .",
    "note that , due to the directed nature of the mixture in ( [ eq : fullmodel ] ) , the persistent markov chains representing the model distributions of the two rbms for foreground and background do not interact , i.e. we run independent chains as if we were training both rbms separately .",
    "fully unsupervised learning is possible in principle but likely to be very difficult for all but very simple datasets .",
    "we therefore consider a `` weakly supervised '' scenario related to @xcite : we assume that we have some general knowledge of the statistical regularities to be expected in the _ background_. this approximate model of the background can be obtained by training on general natural images and it allows us to bootstrap learning of the foreground model from unsegmented training data .",
    "foreground objects stand out from the background , i.e. they appear as `` outliers '' to the background model which forces them to be explained by the foreground model .",
    "although this detection is initially unreliable , the foreground model can then learn about the consistencies of these outliers across the training images which eventually leads to a good model of the foreground objects without any additional information being provided or prior knowledge ( e.g. coherence or convexity ) being used .",
    "* datasets & evaluation * : we evaluate the model and the learning scheme on two datasets : a toy dataset and a more challenging , modified version of the `` labeled faces in the wild - a '' ( lfw - a)-dataset  @xcite .",
    "the toy data consist of @xmath24 pixel image patches that contain two classes of foreground `` objects '' against backgrounds that are randomly cropped patches from the voc 2009 dataset .",
    "the two classes differ in appearance and shape ( i.e. shape and appearance are _ dependent _ ) and objects can appear at various positions in the patch ( see fig .  [",
    "fig : toysamples ] ) . for the lfw -",
    "a dataset , the original images of size @xmath25 were cropped to @xmath26 pixels and down - scaled to @xmath27 pixels .",
    "we used the first 13000 images in the dataset for training and the remaining 233 images for test purposes .",
    "examples are shown in fig .",
    "[ fig : facesresults]a .",
    "we evaluate the quality of learned models for both datasets by sampling and by performing fg - bg segmentation on unseen test images .",
    "we also investigate whether the fg - bg model s ability to model the object of interest independently of the background provides additional robustness of the latent representation to background clutter in a recognition task .    [ cols=\"^,^,^,^ \" , ]     * models & learning * : for our weakly supervised learning scheme , we first learned models of the background by training beta rbms on large sets of natural image patches using sml .",
    "we next trained the foreground rbms in the context of the full model ( eq .  [ eq : fullmodel ] as described in section [ sec : model ] ) . for each training data point , we store the state of the latent variables @xmath2 , @xmath1 , and @xmath3 from one epoch to the next .",
    "we update them by one step of gibbs sampling before using the state of the latent variables for the current batch and the particles in the persistent chains for the foreground model to compute the gradient step for the parameters of the foreground rbm in the usual manner @xcite . fig .",
    "[ fig : facesresults]e illustrates how the mask @xmath3 converges for a particular _ training _ image _ during learning _ over 1000 epochs . for the model to converge well on the face dataset",
    "we further initialized the weights for the foreground appearance by training a beta rbm directly on the full face images ( i.e. including background ; this pre - training does not teach the model to distinguish between foreground and background in the training images ) . for highly structured images the background models were sometimes not sufficiently powerful",
    "so that part of the background was assigned to the foreground even after consolidation of the foreground model .",
    "this does not completely prohibit learning of the foreground model but leads to a noisy final model .",
    "we addressed this issue by introducing an outlier component into the background model ( @xmath28 ) the constraints in eq .",
    "( [ eq : fullmodel ] ) are replaced by @xmath29^{m_i } \\delta\\left[\\vb_i = x_i\\right]^{(1-m_i)(1-o_i)}\\left[u(x_i)\\right]^{(1-m_i)o_i } \\right)$ ] . for the toy dataset we initially trained only with",
    "the basic model and introduced the outlier component only for fine - tuning once the model had largely converged .",
    "for the faces we trained with the outlier component from the beginning .",
    "] , i.e. each background pixel was modeled either by the background rbm or by a uniform distribution ( @xmath30 ) , which can be incorporated into the gibbs sampling scheme by modifying equations ( [ eq : conditional1]-[eq : conditional3 ] ) .",
    "additional details can be found in the supplemental material available on the first author s homepage  @xcite .",
    "cc +   +   +   +   +   +   +   + & + ( e ) & ( f )",
    "* toy data * : for the toy data the model successfully learned about the shapes and appearances of the foreground objects : after learning , samples closely matched the foreground objects in the training set ( cf . fig .",
    "[ fig : toysamples]a ) and inference on test patches led to largely correct segmentations of these patches into foreground and background : it labeled 96% of the pixels in our set of 5000 test images correctly ( see fig .",
    "[ fig : toysamples]c for examples ) . to investigate to what extent",
    "the ability to ignore the background may help in recognition tasks we trained a simple rbm on the same data ( same total number of hidden units as for the fg - bg model ) and performed inference for a set of test patches in both models , @xmath2 , and @xmath1 . ] .",
    "we trained a simple logistic classifier ( with l2-regularization ) on the inferred activation of the hidden units ( only @xmath15 for the fg - bg model ) in order to classify patches whether they contain rectangles or round shapes .",
    "this an easy classification task if enough training data is available ( e.g. 100 training patches per class ) , but as the number of training data points is reduced the classification performance drops strongly for the simple rbm but to a far lesser extent for the fg - bg model ( classification performance 66% vs. 88% at 10 data points per class ) , suggesting that being able to ignore the background can help to improve recognition performance .    * faces * : the model also learned a good representation of faces .",
    "[ fig : facesresults]b shows samples from the trained model .",
    "although the samples do not exhibit as much detail as the faces in the training data ( this is to be expected given the relatively small number of hidden units used ) they exhibit important features of the training data , for instance , there are male and female faces , and the model has learned about different head positions and hair styles .",
    "figure [ fig : facesresults]c shows segmentation results for a subset of the test images . in most cases",
    "the model has largely correctly identified the pixels belonging to the face .",
    "test images for which the model tends to make mistakes typically show heads in extreme poses .",
    "[ fig : facesresults]d demonstrates that the model does not simply choose the same region in all images : randomly re - assigning the inferred masks to test images leads to considerably worse results . to investigate the effect of the mask in a very simple recognition task we manually segmented a small subset of the images in the dataset ( @xmath31 ) . for each segmented person we created two test images by pasting the person into two different natural image background patches , thus obtaining two sets of images containing the same 65 different faces but against different backgrounds ( two example pairs are shown in fig .",
    "[ fig : facesresults]f ) .",
    "we inferred the segmentation and subsequently the hidden activation of the latent units of the foreground model . for each image from the first set we determined the most similar image in the second set ( in terms of the rms difference between the hidden unit activations ) . for 52 ( 80% ) of the images in the first set the corresponding image with the same face ( different background ) in the second set was the closest match .",
    "this compares to 15 out of 65 ( 23% ) for a simple beta rbm ( same number of hidden units as the foreground model ) trained on the same dataset , suggesting that here , too , `` ignoring '' the background can lead to a representation in the hidden units that is less affected by the background than for a normal rbm .",
    "we have demonstrated how rbms and layered representations can be combined to obtain a model that is able to represent the joint shape and appearance of foreground objects independently of the background and we have shown how to learn the model of the foreground directly from cluttered training images using only very weak supervision .",
    "the architecture is very flexible : it can be applied to images of different types ( e.g. binary ) , the background model can be re - used for different foreground models , and it is possible to replace the background model independently of the foreground ( e.g. if the statistics of the background change ) .",
    "also , dbns or dbms could be used instead of rbms .",
    "one interesting extension would be to include a third layer that is _ in front _ of the object layer .",
    "this would allow modeling occlusion of the foreground object ( such occlusions , although rare in the face dataset , may explain part of the uncertainty in the learned shape model ) . using _",
    "semi_-supervised schemes ( e.g. with a few pre - segmented images ) to learn more challenging object categories , is another exciting direction ."
  ],
  "abstract_text": [
    "<S> we propose an extension of the restricted boltzmann machine ( rbm ) that allows the joint shape and appearance of foreground objects in cluttered images to be modeled independently of the background . </S>",
    "<S> we present a learning scheme that learns this representation directly from cluttered images with only very weak supervision . </S>",
    "<S> the model generates plausible samples and performs foreground - background segmentation . </S>",
    "<S> we demonstrate that representing foreground objects independently of the background can be beneficial in recognition tasks .    , </S>",
    "<S> segmentation , weakly supervised learning </S>"
  ]
}