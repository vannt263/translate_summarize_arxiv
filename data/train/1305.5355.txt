{
  "article_text": [
    "the human body is inhabited by complex microbial communities , called microbiomes .",
    "it is estimated that the number of microbial cells associated with the human body is 10 times the total number of human cells .",
    "the collective genomes of these microbes constitute an extended human genome that provides us with genetic and metabolic capabilities that we do not inherently possess [ @xcite ] . with the development of next generation sequencing technology such as the 454 pyrosequencing and illumina solexa sequencing , microbiome composition",
    "can now be determined by direct dna sequencing without laborious cultivation .",
    "typically , instead of sequencing all bacterial genomic dna as in a shotgun metagenomic approach , only the 16s rrna gene , which is ubiquitous in the bacteria kingdom and has variable regions , is sequenced .",
    "since each bacterial cell is assumed to have the same number of copies of this gene , the basic idea is to isolate from all the bacteria the dna strands corresponding to some variable region of the gene , to count different versions of the sequences , and then to identify to which bacteria the versions correspond .",
    "the types and abundances of different bacteria in a sample can therefore be determined .",
    "after preprocessing of the raw sequences , the 16s sequences are either mapped to an existing phylogenetic tree in a taxonomic dependent way [ e.g. , @xcite ] or clustered into operational taxonomic units ( otus ) at a certain similarity level in a taxonomic independent way [ e.g. , @xcite ] . at 97% similarity level , these otus are used to approximate the taxonomic rank _",
    "species_. the otu based approach is most commonly used in 16s based microbiome studies .",
    "each otu is characterized by a representative dna sequence and can be assigned a taxonomic lineage by comparing to a known bacterial 16s rrna database .",
    "most otus are in extremely low abundances , with a large proportion being simply singletons ( possibly due to sequencing error ) .",
    "we can further aggregate otus from the same genus and perform analysis on the abundances at the genus level , which is more robust to sequencing error and can reduce the number of variables significantly .",
    "either way we finally obtain the taxa counts for each sample .",
    "recent studies have linked the microbiome with human diseases including and inflammatory bowel disease [ @xcite ] .",
    "it is therefore important to understand how genetic or environmental factors shape the human microbiome in order to gain insight into etiology of many microbiome - related diseases and to develop therapeutic measures to modulate the microbiome composition .",
    "@xcite demonstrated that genetic variants are associated with the mouse gut microbiome .",
    "@xcite showed that dietary nutrients are associated with the human gut microbiome .",
    "both studies have considered a large number of genetic loci or nutrients and aimed to identify the genetic variants or nutrients that are associated with the gut microbiome .",
    "when there are numerous possible covariates affecting the microbiome composition , variable selection becomes necessary .",
    "variable selection can not only increase biological interpretability but also provide researchers with a short list of top candidates for biological validation .",
    "the methods we develop in this paper are particularly motivated by an ongoing study at the university of pennsylvania to link the nutrient intake to the human gut microbiome . in this study ,",
    "gut microbiome data were collected on 98 normal volunteers .",
    "in addition , food frequency questionnaire ( ffq ) were filled out by these individuals .",
    "the questionnaires were scored and the quantitative measurements of 214  micronutrients were obtained .",
    "details of the study and the data set can be found in section  [ secreal ] and in @xcite .",
    "our goal is to identify the nutrients that are associated with the gut microbiome and also their associated bacterial taxa .",
    "most of the microbiome studies used distance - based methods to link the microbiome and environmental covariates , where a distance metric was defined between two microbiome samples and statistical analysis was then performed using the distances .",
    "however , the choice of distance metric is sometimes subjective and different distances vary in their power of identifying relevant environmental factors .",
    "another limitation of distance - based methods is its inefficiency for detecting subtle changes since distances summarize the overall relationship . in addition",
    ", such distance - based approaches do not provide information on how covariates affect the microbiome compositions and which taxa are affected .",
    "therefore , it is desirable to model the counts directly instead of summarizing the data as distances .",
    "one way of testing for covariate effects is by performing a multivariate multiple regression ( called redundancy analysis in ecology ) after appropriate transformation of the count data such as converting into proportions [ @xcite ] .",
    "a pseudo-@xmath1 statistic is then calculated and the significance is then evaluated by permutation test . alternatively , one can define a distance between the samples and then use a permanova procedure to test for covariate effects [ @xcite ] .",
    "it is easy to show that when the distance is euclidean , these two procedures are equivalent .    in this paper",
    ", we consider the sparse dirichlet - multinomial ( dm ) regression [ @xcite ] to link high - dimensional covariates to bacterial taxa counts from microbiome data .",
    "the dm regression model is chosen to model the overdispersed taxa counts .",
    "the observed taxa count variance is much larger than that predicted by a multinomial model that assumes fixed underlying taxa proportions , an assumption that is hardly met for real microbiome data .",
    "uncontrollable sources of variation such as individual - to - individual variability , day - to - day variability , sampling location variability or even technical variability such as sample preparation lead to enormous variability in the underlying proportions .",
    "in contrast , the dm model assumes that the underlying taxa proportions come from a dirichlet distribution .",
    "we use a log - linear link function to associate the mean taxa proportions with covariates . in this dm modeling framework",
    ", the effects of the covariates on taxa proportions can be tested using the likelihood ratio test .",
    "when the number of the covariates is large , we propose a sparse group @xmath0 penalized likelihood approach for variable selection and parameter estimation .",
    "the sparse group @xmath0 penalty function [ @xcite ] consists of a group @xmath0 penalty and an overall @xmath0 penalty , which induce both group - level sparsity and within - group sparsity .",
    "this is particularly relevant in our setting . for the nutrient - microbiome association example",
    ", we have @xmath2 nutrients and @xmath3 taxa , so the fully parameterized model has @xmath4 coefficients including the intercepts , since each nutrient - taxon association is characterized by one coefficient .",
    "the @xmath3 coefficients for each nutrient constitute a group .",
    "if we assume many nutrients have no or ignorable effects on the microbiome composition , the groups of coefficients associated with these irrelevant nutrients should be zero altogether , which is a group - level sparsity that is achieved by imposing a group @xmath0 penalty .",
    "however , the group @xmath0 penalty does not perform within - group selection , wherein if one group is selected , all the coefficients in that group are nonzeros . in the case of nutrient - microbiome association",
    ", we are also interested in knowing which taxa are associated with a selected nutrient . by imposing an overall @xmath0 penalty , within - group selection",
    "becomes possible .",
    "therefore , we impose a sparse group @xmath0 penalty not only to select these important nutrients but also to recover relevant nutrient - taxon associations .",
    "section  [ secdm ] reviews the dirichlet - multinomial model for count data .",
    "section  [ seclr ] introduces the dirichlet - multinomial regression framework for incorporating covariate effects and proposes a likelihood ratio statistic for testing the covariate effect .",
    "section [ secgrp ] proposes a sparse group @xmath0 penalized likelihood procedure for variable selection for the dm models followed by a detailed description of a block - coordinate descent algorithm in section [ secalg ] .",
    "section  [ secsim ] shows simulation results and section  [ secreal ] demonstrates the proposed method on a real human gut microbiome data set to associate the nutrient intake with the human gut microbiome composition .",
    "suppose we have @xmath3 bacterial taxa and their counts @xmath5 are random variables .",
    "denote @xmath6 as the observed counts .",
    "the simplest model for count data is the multinomial model and its probability function is given as @xmath7 where @xmath8 and @xmath9 are underlying species proportions with @xmath10 . here",
    "the total taxa count @xmath11 is determined by the sequencing depth and is treated as an ancillary statistic since its distribution does not depend on the parameters in the model .",
    "the mean and variance of the multinomial component  @xmath12 @xmath13 are @xmath14    for microbiome composition data , the actual variation is usually larger than what would be predicted by the multinomial model , which assumes fixed underlying proportions .",
    "this increased variation is due to the heterogeneity of the microbiome samples and the underlying proportions vary among samples . to account for the extra variation or overdispersion",
    ", we assume the underlying proportions @xmath15 are themselves positive random variables @xmath16 subject to the constraint @xmath17 .",
    "one commonly used distribution is the dirichlet distribution [ @xcite ] with the probability function given by @xmath18 where @xmath19 are positive parameters , @xmath20 and @xmath21 is the gamma function . the mean and variance of the dirichlet component @xmath22 @xmath13 are @xmath23 the mean is proportional to @xmath24 and the variance is controlled by @xmath25 , which can be regarded as a `` precision parameter . ''",
    "as @xmath25 becomes larger , the proportions are more concentrated around the means .",
    "the dirichlet - multinomial ( dm ) distribution [ @xcite ] results from a compound multinomial distribution with weights from the dirichlet distribution ( parametrization i ) : @xmath26\\\\[-8pt ] & = & \\pmatrix{y_+ \\cr{\\mathbf{y}}}\\frac{\\gamma(y_+ + 1 ) \\gamma(\\gamma_+)}{\\gamma(y_+ + \\gamma_+ ) } \\prod _ { j=1}^{q } \\frac{\\gamma(y_j + \\gamma_j)}{\\gamma ( \\gamma_j)\\gamma(y_j+1)}.\\nonumber\\end{aligned}\\ ] ] the mean and variance of the dm distribution for each component @xmath12 @xmath27 is given by @xmath28 comparing ( [ eqdm2 ] ) with ( [ eqm2 ] ) , we see that the variation of the dm component is increased by a factor of @xmath29 , where @xmath25 controls the degree of overdispersion with a larger value indicating less overdispersion . using an alternative parameterization , the probability function can be written as ( parameterization  ii ) @xmath30 where @xmath31 is the mean and @xmath32 is the dispersion parameter . when @xmath33 , it is easy to verify ( [ eqdm3 ] ) is reduced to the multinomial distribution .",
    "when there is no covariate effect , the dm model can be used to produce more accurate estimates of taxa proportions of a given microbiome sample than the simple multinomial model , due to its ability to model the overdispersion . beyond proportion estimation ,",
    "microbial ecologists are more interested in associating the microbiome composition with some environmental covariates .",
    "suppose we have @xmath34 microbiome samples and @xmath3 species .",
    "let @xmath35 be the observed count matrix for the @xmath34 samples .",
    "let @xmath36 be the design matrix of @xmath2 covariates for @xmath34 samples .",
    "we assume the parameters @xmath24 @xmath27 in the dm model ( parametrization i ) depend on the covariate via the following log - linear model , @xmath37 where @xmath38 is the @xmath39th row vector of @xmath40 and @xmath41 is the coefficient for the @xmath42th taxon with respect to @xmath43th covariate , whose sign and magnitude measure the effect of the @xmath43th covariate on the @xmath42th taxon . from ( [ eqdm2 ] ) , we see that @xmath44 , where @xmath45 can be interpreted as the baseline abundance level for species @xmath42 and the coefficient @xmath41 indicates the magnitude of the @xmath43th covariate effect on species @xmath42 . though the log - linear link is assumed mainly for ease of computation , it is biologically consistent , in that microorganisms usually exhibit exponential growth in a favorable environment.=-1    for notational simplicity , we denote @xmath46 as @xmath47 and augment @xmath40 with an @xmath34-vector of @xmath48 s as its first column .",
    "we number the columns from @xmath49 to @xmath2 .",
    "the link function becomes @xmath50 let @xmath51 be the @xmath52 regression coefficient matrix , @xmath53 be the vector of coefficients for the @xmath42th taxon ( @xmath54 ) and @xmath55 be the vector of coefficients for the @xmath43th covariate ( @xmath56 ) .",
    "we also use @xmath51 to denote the @xmath57 vector that contains all the coefficients . substituting ( [ eqlink1 ] ) into dm probability function",
    "( [ eqdm1 ] ) and ignoring the part that does not involve the parameters , the log - likelihood function given the covariates is given by @xmath58\\\\[-9pt ] & & \\hspace*{45pt } { } + \\sum_{j=1}^q \\bigl\\{\\tilde { \\gamma } \\bigl(y_{ij}+\\gamma_j\\bigl({\\mathbf{x}}^i ; { \\bolds{\\beta}}^j\\bigr ) \\bigr ) - \\tilde{\\gamma } \\bigl(\\gamma_j \\bigl({\\mathbf{x}}^i;{\\bolds{\\beta}}^j\\bigr ) \\bigr ) \\bigr\\ } \\biggr],\\nonumber\\end{aligned}\\ ] ] where @xmath59 is the log - gamma function .",
    "based on the likelihood function ( [ eqloglik2 ] ) , one can test the effect of a given covariate or the joint effects of all covariates on the microbiome composition using the standard likelihood ratio test ( lrt ) . to solve the maximization problem",
    ", we implemented the newton ",
    "raphson algorithm , since the gradient and hessian matrix of the log - likelihood can be calculated analytically .",
    "alternatively , we can use the general - purpose optimization algorithm such as @xmath60 in r , which computes the gradient and hessian numerically . by selecting an appropriate starting point ( e.g. , @xmath61 ) , for moderate - size problems in the dimensions @xmath2 and @xmath3",
    ", the algorithm converges to a stationary point sufficiently fast .    with a large number of covariates in the dm regression model , direct maximization of the likelihood function",
    "becomes infeasible or unstable .",
    "when each covariate is tested separately using the lrt , adjustment for multiple testing is required .",
    "in addition , when the number of taxa @xmath3 is large , the null distribution of the lrt has large degrees of freedom and therefore reduced power .",
    "it is also desirable to select the relevant covariates that are associated with the microbiome composition .",
    "although one can test the null hypothesis @xmath62 for each @xmath63 pair by the lrt , adjustment of multiple comparisons can lead to a loss of power . in the next section we present a sparse group @xmath0 penalized estimation for variable selection and parameter estimation for sparse dm regression models .",
    "to perform variable selection , we estimate the regression coefficient vector @xmath51 in model ( [ eqlink2 ] ) by minimizing the following sparse group @xmath0 penalized negative log - likelihood function , @xmath64 where @xmath65 is the log - likelihood function defined as in ( [ eqloglik2 ] ) , @xmath66 and @xmath67 are the tuning parameters and @xmath68 is the @xmath0 norm and @xmath69 is the group @xmath0 norm of the coefficient vector @xmath70 , respectively .",
    "we do not penalize the intercept vector @xmath71 .",
    "the first part of the sparse group @xmath0 penalty is the group @xmath0 penalty that induces group - level sparsity , which facilitates selection of the covariates that are associated with taxa proportions .",
    "the second @xmath0 penalty on all the coefficients facilitates the within - group selection , which is important for interpretability of the resulting model .",
    "a similar penalty involving both group @xmath0 and @xmath0 terms is discussed in @xcite and @xcite for regularized multivariate linear regression . when @xmath72 , criterion ( [ eqploglik ] ) reduces to the group lasso .",
    "the sparse group @xmath0 estimates of @xmath51 can be obtained by minimizing the penalized negative log - likelihood function ( [ eqploglik ] ) : @xmath73 using the general block coordinate gradient descent algorithm of @xcite , we develop in the following an efficient algorithm to solve this optimization problem . @xcite present a block coordinate gradient descent algorithm for group lasso for logistic regression that includes only the group @xmath0 penalty ( i.e. , @xmath72 ) . in contrast , our optimization problem ( [ eqploglik ] ) has two nondifferentiable parts , both at the individual @xmath41 and at the group @xmath70 levels .",
    "the key idea of the algorithm is to combine a quadratic approximation of the log - likelihood function with an additional line search .",
    "first we expand ( [ eqloglik2 ] ) at current estimate @xmath74 to a second - order taylor series .",
    "the hessian matrix is then replaced by a suitable matrix @xmath75 .",
    "we define @xmath76 where @xmath77 . also denote @xmath78 and @xmath79 the gradient and increment with respect to @xmath80 for the @xmath43th group , and @xmath81 and @xmath82 with respect to @xmath83 .",
    "we then minimize the following function @xmath84 with respect to the @xmath43th penalized parameter group : @xmath85\\\\[-8pt ] & \\approx & \\mathit{pl}\\bigl(\\hat{{\\bolds{\\beta}}}{}^{(t)}+{{\\mathbf{d } } } ; { { \\mathbf{y } } } , { { \\mathbf{x } } } , \\lambda_1 , \\lambda_2\\bigr ) .",
    "\\nonumber\\end{aligned}\\ ] ] we restrict ourselves to vectors @xmath86 with @xmath87 for @xmath88 and the corresponding @xmath89 submatrix @xmath90 for the @xmath43th group is a diagonal matrix of the form @xmath91 for some scalar @xmath92 .",
    "the solution to the general optimization problem of the form ( [ eqpqlik ] ) is given by theorem  [ theorem1 ] and its corollary in the .",
    "let @xmath93 and @xmath94 be the set @xmath95 . denote @xmath96 the subvector of @xmath79 with indices in @xmath97 and @xmath98 in @xmath94 .",
    "the minimizer of ( [ eqpqlik ] ) can be decomposed into two parts : the first part @xmath99 can be obtained by @xmath100 the second part @xmath101 can be computed by minimizing @xmath102 with respect to @xmath98 ( set components other than @xmath98 to be @xmath49 ) , where @xmath103\\ ] ] and sgn(@xmath104 ) is the sign function .",
    "minimization of ( [ eqpqlik2 ] ) with respective to @xmath98 can be performed in a similar fashion as in @xcite for the group @xmath0 penalty .",
    "specifically , if @xmath105 , the minimizer of equation ( [ eqpqlik2 ] ) for @xmath98 is @xmath106 otherwise @xmath107    for the unpenalized intercept , the solution can be directly computed : @xmath108    if @xmath109 , an inexact line search using the armijo rule will be performed .",
    "let @xmath110 be the largest value in @xmath111 such that @xmath112 where @xmath113 , and @xmath114 is the improvement in the objective function @xmath115 using a linear approximation , that is , @xmath116 finally , we update the current estimate by @xmath117    for @xmath90 , we use the same choice as in @xcite , that is , @xmath118,\\ ] ] where @xmath119 is a lower bound to ensure convergence . in this paper",
    ", we use the standard choices for the parameters , @xmath120 and @xmath121 [ @xcite ] , in the block coordinate descent algorithm to ensure the convergence of the algorithm .    in each iteration of the algorithm",
    "detailed above , when estimating the @xmath43th column of the @xmath122 coefficient matrix @xmath51 with all other columns fixed , the algorithm first identifies the coefficients with zero estimates , denoted by set @xmath97 in the algorithm . for the coefficients in set",
    "@xmath97 , @xmath123 and , therefore , when , @xmath124 and the coefficients in @xmath97 are shrunk to zero . based on its definition , the set @xmath97 depends on the turning parameter @xmath67 and a larger value of @xmath67 leads to fewer nonzero coefficients .",
    "the algorithm then performs a group shrinkage of the nonzero estimates of the coefficients in the complementary set @xmath94 .",
    "these nonzero coefficients can further be shrunk to zero as a group if the condition @xmath125 is met , in which case @xmath126 and , therefore , @xmath127 . clearly , this group shrinkage depends on the tuning parameter @xmath66 .",
    "thus , with careful choice of the tuning parameters @xmath66 and @xmath67 , some column group coefficients are set to zero and the within - group sparsity is achieved by the plain @xmath0 penalty .",
    "two tuning parameters @xmath66 and @xmath67 in the penalized likelihood estimation need to be tuned with data by @xmath128-fold cross - validation or a bic criterion . to facilitate computation ,",
    "we reparameterize @xmath66 and @xmath67 as @xmath129 and @xmath130 .",
    "the multiplier @xmath131 in the group penalty is used so that the group @xmath0 penalty and overall @xmath0 penalty are on a similar scale .",
    "here we use @xmath132 to control the overall sparsity level and use @xmath133 $ ] to control the proportion of group @xmath0 in the composite sparse group penalty .",
    "when @xmath134 , the penalty is reduced to the lasso ; when @xmath135 , it is reduced to a group lasso .",
    "we consider the tuning parameter @xmath136 from the set @xmath137 .",
    "for each @xmath136 , to search for the best tuning parameter value , we run the algorithm from @xmath138 so that it produces the sparsest model with the intercepts @xmath71 only .",
    "the value @xmath138 can be roughly determined by using the starting value @xmath139 with components @xmath140 @xmath141 and @xmath142 the mle of ( [ eqloglik2 ] ) without covariates , and choosing the smallest value of @xmath132 so that the iteration converges in the first iteration , that is , @xmath139 is a stationary point .",
    "we then decrease the @xmath132 value and use the estimate of @xmath51 from the last @xmath132 as a warm start .",
    "the grid of @xmath132 can be chosen to be equally spaced on a log - scale , for example , @xmath143 @xmath144 , where @xmath145 is set so that @xmath146 or , alternatively , we could terminate the loop until the model receives more than the maximum number of nonzero coefficients allowed .",
    "we simulate @xmath34 microbiome samples , @xmath2 nutrients and @xmath3 bacterial taxa to mimic the real data set that we analyze in section [ secreal ] .",
    "the nutrient intake vector is simulated using a multivariate normal distribution with mean @xmath147 and a covariance matrix @xmath148 .",
    "we simulate @xmath149 relevant nutrients with each nutrient being associated with @xmath150 taxa .",
    "for each nutrient , the association coefficients @xmath151 for the @xmath150 taxa are equally spaced over the interval @xmath152 $ ] with alternative signs , where @xmath153 controls the association strength .",
    "we consider two growth models to relate the taxa abundances to the covariates . in the exponential growth model ,",
    "the proportion of the @xmath42th taxon of the @xmath39th sample is determined as @xmath154 the intercepts @xmath71 , which determine the base abundances of the taxa , are taken from a uniform distribution over @xmath155 so that the base taxa abundances can differ up to 100 folds .",
    "the exponential growth model is a common model for bacteria growth in response to environmental stimuli .",
    "we also consider a linear growth model , in which the proportion of the @xmath42th taxon of the @xmath39th sample is determined as @xmath156 the intercepts @xmath71 are now drawn from a uniform distribution over @xmath157 so that the base taxa abundances can also differ up to 100 folds . to deal with possible negative @xmath158",
    ", we add a small constant to make it positive .",
    "we then generate the count data using the dm model of parametrization ii ( [ eqdm3 ] ) with a common dispersion @xmath159 .",
    "the number of individuals ( sequence reads ) for the @xmath39th sample @xmath160 is generated from a uniform distribution over @xmath161 .",
    "note that the data are not generated exactly according to our model assumptions , which are based on parametrization i ( [ eqdm1 ] ) and link ( [ eqlink2 ] ) .",
    "this can further demonstrate the robustness of our proposed model .     on variable selection .",
    "the tuning parameter @xmath136 is varied from @xmath49 to @xmath162 . under each value of @xmath136 , the best @xmath132 value , which maximizes the likelihood of the test data set ,",
    "is selected to generate the sparse model .",
    "group ( left ) and within - group ( right ) selection performances are then evaluated using measures of recall , precision and @xmath163 based on 100 replications .",
    "simulation setting : @xmath164 , @xmath165 , @xmath166 , @xmath167 , @xmath168 , @xmath169 , @xmath170 , @xmath171 . ]      to evaluate the variable selection performance of the proposed sparse penalized likelihood approach with group @xmath0 penalty , we first simulate the count data using the exponential growth model with @xmath172 , @xmath173 , @xmath174 , @xmath167 , @xmath168 , @xmath175 , @xmath170 , and @xmath171 , totaling @xmath176 variables .",
    "we compare the results to the corresponding penalized estimation of the dm model using only the @xmath0 penalty function and two other sparse group @xmath0 estimations based on multinomial or dirichlet regression . in sparse multinomial regression , we use the multinomial model for count data and the link function is given by ( [ eqlinkmult ] ) .",
    "we set @xmath177 to make the coefficients identifiable . in sparse dirichlet regression , instead of modeling the counts directly ,",
    "we model the proportions using the dirichlet distribution and the link function is the same as that of the dm regression . since the count data contain zeros , we add 0.5 to the cells with 0 counts .",
    "we also include results from the lrt based univariate testing procedure for group selection controlling the false discovery rate ( fdr ) at 0.05.=-1    we measure the selection performance using @xmath178 where @xmath179 , @xmath180 and @xmath181 are true positives , false negatives and false positives , respectively , and @xmath163 is an overall measure , which weights the precision and recall equally .",
    "the averages of these measures are reported based on @xmath182 replications .",
    "to select the best tuning parameter values , we simulate an independent test data set of @xmath183 samples .",
    "we then run the penalized procedure over the training data set and re - estimate the selected coefficients using an unpenalized procedure ( `` nlm '' function in r ) .",
    "the log - likelihood of the test data set is calculated based on the re - estimated coefficients and the tuning parameter is selected to maximize the log - likelihood over the test data set .",
    "we choose the tuning parameter @xmath136 from the set @xmath137 .",
    "figure  [ figceffect ] shows that a small @xmath136 is sufficient to identify the groups efficiently , while further increase of @xmath136 only improves the group selection marginally . on the other hand , within - group",
    "selection exhibits a unimode pattern indicating slight grouping could lead to better identification of within - group elements . in the following simulations , we tune both @xmath136 and @xmath132 to achieve the maximum likelihood values in the test data sets .    table  [ tabsgl0 ] shows the simulation results .",
    "the sparse group @xmath0 penalized dm regression has a much higher precision rate in group selection than the corresponding @xmath0 penalized procedure , while both achieve similar recall rates , demonstrating the gain from including the group @xmath0 penalty in the regularization .",
    "interestingly , the sparse group penalized dm regression also performs better in within - group selection , as shown by a higher recall rate and @xmath163 , indicating better group selection could also facilitate better overall variable selection .",
    "compared to models based on the sparse dirichlet regression and multinomial regression , the dm model performs    = =    @lcccccccccccc@ & & + & & + & & & & + & & & & + * model * & * r * & * p * & * f * & * r * & * p * & * f * & * r * & * p * & * f * & * r * & * p * & * f * +   + & + dm & 0.59 & 0.70 & 0.59 & 0.86 & 0.92 & 0.87 & 0.42 & 0.76 & 0.48 & 0.88 & 0.68 & 0.70 + & ( 0.23 ) & ( 0.23 ) & ( 0.18 ) & ( 0.23 ) & ( 0.16 ) & ( 0.18 ) & ( 0.21 ) & ( 0.23 ) & ( 0.18 ) & ( 0.22 ) & ( 0.29 ) & ( 0.22 ) + d & 0.48 & 0.73 & 0.52 & 0.83 & 0.89 & 0.82 & 0.36 & 0.82 & 0.45 & 0.82 & 0.77 & 0.72 + & ( 0.23 ) & ( 0.23 ) & ( 0.20 ) & ( 0.26 ) & ( 0.18 ) & ( 0.21 ) & ( 0.20 ) & ( 0.21 ) & ( 0.19 ) & ( 0.26 ) & ( 0.27 ) & ( 0.23 ) + m & 0.46 & 0.72 & 0.50 & 0.82 & 0.85 & 0.79 & 0.36 & 0.76 & 0.44 & 0.84 & 0.70 & 0.69 + & ( 0.23 ) & ( 0.26 ) & ( 0.21 ) & ( 0.27 ) & ( 0.24 ) & ( 0.25 ) & ( 0.19 ) & ( 0.24 ) & ( 0.18 ) & ( 0.26 ) & ( 0.28 ) & ( 0.24 ) + lrt &  &  &  & 0.96 & 0.54 & 0.66 &  &  &  & 0.96 & 0.54 & 0.66 + &  &  &  & ( 0.11 ) & ( 0.21 ) & ( 0.16 ) &  &  &  & ( 0.11 ) & ( 0.21 ) & ( 0.16 ) +    better in variable selection , especially for within - group selection , suggesting the dm model is more appropriate than multinomial or dirichlet models when the counts exhibit overdispersion .",
    "the dirichlet model performs slightly better than the multinomial model . at 5% fdr ,",
    "the lrt based univariate testing procedure selects far more variables than these penalized procedures , yielding a higher recall rate but a much worse precision rate.=1      we further investigate the effect of overdispersion and simulate the count data with different degrees of overdispersion and present the results in figure  [ figsgl1 ] .",
    "we observe that larger overdispersion makes the selection more difficult for all three models , as shown by smaller @xmath163 values .",
    "when the data have slight overdispersion ( @xmath184 ) , the selection performances of the three models are similar . on the other hand ,",
    "when the data have much overdispersion ( @xmath185 ) , dm performs much better than the other two models in terms of both group selection and within - group selection .",
    "therefore , modeling overdispersion can lead to power gains in identifying relevant variables if the data are overdispersed .",
    "penalized dirichlet - multinomial model ; dm - l : @xmath0 penalized dirichlet - multinomial model ; m - sgl : sparse group @xmath0 penalized multinomial model ; m - l : @xmath0 penalized multinomial model ; d - sgl : sparse group @xmath0 penalized dirichlet model ; d - l : @xmath0 penalized dirichlet model . for each bar ,",
    "mean@xmath186standard error is presented based on 100 replications . ]    to assess the sensitivity to model misspecification , we simulate the counts using the linear growth model instead and compare the results with the exponential growth model ( see figure  [ figsgl1 ] ) .",
    "interestingly , both the dirichlet and dm model are very robust to model misspecification and their selection performances do not decrease significantly . on the other hand",
    ", the multinomial model suffers a large performance loss with the @xmath163 measure for group selection decreasing from @xmath187 to @xmath188 .",
    "we also study the effect of the total counts for each sample ( data not shown ) . even increasing the total count by 10 folds ,",
    "the dm model is still better than the proportion based dirichlet model .",
    "therefore , even though we have much deeper sequencing of the microbiome that results in larger counts for each sample , using the dm model can still lead to improved performance over the model that considers only the proportions .",
    "penalized dirichlet - multinomial model ;",
    "dm - l : @xmath0 penalized dirichlet - multinomial model ; m - sgl : sparse group @xmath0 penalized multinomial model ; m - l : @xmath0 penalized multinomial model ; d - sgl : sparse group @xmath0 penalized dirichlet model ; d - l : @xmath0 penalized dirichlet model . for each bar ,",
    "mean@xmath186standard error is presented based on 100 replications . ]",
    "we next study the effect of the number of relevant taxa in each group on the performance of different models and present the results in figure  [ figsgl3 ] . when each relevant group contains only one relevant taxon ,",
    "the grouping is not very helpful , so the sparse group regularized dm model and @xmath0 regularized dm model do not differ much in selecting the relevant groups .",
    "when the relevant group contains @xmath189 relevant taxa , variable grouping becomes much more important and the sparse group regularized dm model performs much better than the @xmath0 penalized dm .",
    "the group penalized multinomial and dirichlet regression models , on the other hand , select groups as well as the dm regression model , since the grouping effect is much stronger .",
    "figure  [ figsgl3 ] also shows the results when we increase the dimension of covariates to 400 ( @xmath190 variables in total ) .",
    "increase of the dimension does not deteriorate the variable selection performance , demonstrating the efficiency of our method in handling high - dimensional data .",
    "diet strongly affects the human health , partly by modulating gut microbial community composition .",
    "@xcite studied the habitual diet effect on the human gut microbiome , where a cross - section of 98 healthy volunteers were enrolled in the study .",
    "diet information was collected using a food frequency questionnaire ( ffq ) and was then converted to nutrient intake values of 214 micronutrients .",
    "nutrient intake was further normalized using the residual method to adjust for caloric intake and was standardized to have mean 0 and standard deviation 1 .",
    "since some nutrient measurements were almost identical , we used only one representative for these highly correlated nutrients ( correlation @xmath191 ) , resulting in 118 representative nutrients .",
    "stool samples were collected and dna samples were analyzed by the 454@xmath192roche pyrosequencing of 16s rdna gene segments of the v1v2 region .",
    "the pyrosequences were denoised prior to taxonomic assignment , yielding an average of @xmath193 ( sd ) reads per sample .",
    "the denoised sequences were then analyzed by the qiime pipeline [ @xcite ] with the default parameter settings .",
    "the otu table contained 3068 otus ( excluding the singletons ) and these otus can be further combined into 127 genera .",
    "we studied 30 relatively common genera that appeared in at least 25 subjects .",
    "finally , we had the count matrix @xmath194 and covariate matrix @xmath195 .",
    "our goal is to identify the micronutrients that are associated with the gut microbiomes and the specific genera that the selected nutrients affect .",
    "penalized dm model .",
    "top plot : square root of the fitted counts versus square root of the observed counts based on the dm model with the selected nutrients ; bottom plots : observed counts and simulated counts produced by the fitted sparse dm model and multinomial model . ]    = =    @ld2.2d2.2cd2.2d2.2d2.2 d2.2d2.2d2.2d2.2@ +  & -0.03&-0.08 & 0.09 & -0.08 & -0.10 & -0.02 & 0.02 & 0.10 & & -0.03 + @xmath1960.32 & & -0.33 & & & & 0.22 & & & & + @xmath1960.38 & & & & & & & & & -0.29 & +  & -0.01 & -0.08 & 0.13 & -0.07 & & & & 0.02 & -0.23 & +  & & 0.23 & & & 0.36 & 0.63 & -0.72 & & & + @xmath1960.19 & -0.04 & & 0.16 & & & & & & & 0.05 +  & & & & & & & & & & 0.16 +  & & & & & -0.08 & & & & 0.07 & +  & -0.02 & & & & & & & -0.10 & & +  & & 0.19 & & & & & & & & +  & 0.02 & & & & & & & -0.12 & -0.12 & 0.14 +  & & & & -0.35 & & & & & & + @xmath1960.26 & & -0.29 & & & & & & & & +   + @xmath197 & & & & & & & & & & +   + 0.50 & 0.93 & 0.72 & 0.94&0.35&0.67 & 0.43 & 0.58 & 0.92 & 0.61&0.60 +    we applied the sparse group @xmath0 penalized dm regression to this data set .",
    "we used the bic to select the tuning parameters .",
    "the final dm model selected 11  nutrients and 13 associated genera .",
    "we refit the dm regression model using the selected variables and obtained the maximum likelihood estimates of the coefficients .",
    "we compared the fitted counts ( total count@xmath198fitted proportion ) against the observed counts in figure  [ figfit ] ( top panel ) .",
    "the model fits the data quite well with @xmath199 .",
    "table  [ estcoeff ] shows the mles of the regression coefficients for the selected nutrients and genera . except for methionine ( second column ) ,",
    "the coefficients are not too small .",
    "since the nutrient measurements are standardized , the exponentiation of a given coefficient can be interpreted as the factor of change in proportion of a taxon when a given nutrient changes by one unit while other nutrients remain constant .",
    "the marginal @xmath2-value based on the lrt for each of the selected nutrients is also shown in this table . except for vitamin e and eriodictyol",
    ", these selected nutrients all showed a significant marginal association with the gut microbiome .    to further assess the relevance of the nutrients selected , we used the bootstrap to analyze the stability of the selected nutrients [ @xcite ] .",
    "specifically , we took 100 bootstrap samples and for each sample we ran our algorithm to select the nutrients . since some nutrients are highly correlated , we expect that highly correlated nutrients ( if the correlation is greater than 0.75 ) can be selected in different bootstrap samples ; we define the bootstrap selection probability of a given nutrient as the number of times that this nutrient or its correlated nutrients were selected .",
    "table [ estcoeff ] shows the bootstrap probabilities of the nutrients that were selected by the sparse dm regression , indicating quite stable selection of most of the selected microbiome - associated nutrients .",
    "vitamin e had the least stable selection over the 100 bootstrap samples .",
    "the identified nutrient - taxon associations are visualized in a bipartite graph shown in figure  [ figcombo ] , where the genera and nutrients are depicted with circles and hexagons , respectively .",
    "these results further confirmed the findings of @xcite , where they found the human gut microbiome can be clustered into two enterotypes characterized by prevotella and bacteroides , respectively , and the prevotella enterotype is associated with a high carbohydrate diet while the bacteroides enterotype is associated with a high protein / fat / choline diet .",
    "figure  [ figcombo ] shows that two carbohydrates , maltose and sucrose , are positively associated with prevotella and negatively associated with bacteroides , while animal proteins are positively associated with bacteroides , parabacteroides and alistipes , the three genera mostly enriched in the bacteroides enterotype .",
    "choline is positively associated with bacteroides and negatively associated with prevotella .",
    "polyunsaturated fat is strongly associated with alistipes , odoribacter , barnesiella and parasutterella , indicating the large effect of fat on the human microbiome .",
    "regularized dm model .",
    "we use a bipartite graph to visualize the selected nutrients and their associated genera based on sparse group @xmath0 penalized dm regression .",
    "circle : genus ; hexagon : nutrient ; solid line : positive correlation ; dashed line : negative correlation .",
    "the thickness of the line represents the association strength . ]",
    "the dm model also identified several other associations that are worth further investigation .",
    "for example , we found that naringenin ( flavanone ) was positively associated with faecalibacterium , an anti - inflammatory commensal bacterium identified by gut microbiota analysis of crohn s disease patients [ @xcite ] .",
    "if the association is validated , diet with high naringenin ( e.g. , orange , grapefruit ) can be beneficial for patients with crohn s disease .    as a comparison",
    ", we also ran the sparse group @xmath0 penalized multinomial or dirichlet regression models and the identified nutrient - genus associations showed significant overlap with those from the dm regression model .",
    "however , the interpretability of the dm regression model was the best . to further demonstrate the advantage of the dm model",
    ", we simulated taxa counts for each individual based on the fitted models and the observed total taxa counts .",
    "the bottom plot of figure  [ figfit ] shows that the simulated counts produced by the fitted sparse dm model resemble the observed counts better than those from the sparse multinomial model , where the simulated counts are apparently over - smoothed .",
    "this indicates the importance of considering the overdispersion in modeling the gut microbiome data .",
    "we also performed the lrt based univariate testing procedure . at fdr@xmath2000.05 ,",
    "the lrt identified 13 nutrients , 8 of which are also identified or highly correlated with the nutrients identified by the sparse group @xmath0 penalized dm model .",
    "we have proposed a sparse group @xmath0 penalized estimation for the dm regression in order to select covariates associated with the microbiome composition .",
    "the sparse group @xmath0 penalty encourages both group - level and within - group sparsity , with which we can select the relevant taxa associated with the selected covariates .",
    "we have performed extensive simulations to evaluate our proposed penalized estimation procedure for both group and within - group selections .",
    "we demonstrated the procedure with a real data set on associating nutrient intakes with gut microbiome composition and confirmed the major findings in @xcite .    in our penalized likelihood estimation of the dm model",
    ", we use a combination of group @xmath0 and individual @xmath0 penalties , which result in a convex and separable ( in groups of parameters ) penalty function .",
    "this property facilitates the application of the general coordinate gradient descent method of @xcite to implement an efficient optimization algorithm . in each iteration",
    ", we have a closed form solution for a block update . for a given set of the sparsity tuning parameters ,",
    "our algorithm is fully automatic and does not require the specification of an algorithmic tuning parameter to ensure convergence .",
    "for example , it took about 3 minutes on a standard laptop ( core i5 , 2 g memory ) to finish the analysis of the real data set using an r implementation of the algorithm ( available at http://statgene.med.upenn.edu/ ) .",
    "besides the sparse @xmath201 group penalty , other group penalty functions such as the sup - norm penalty in @xcite and the composite absolute penalties in @xcite can also be used in the setup of the dirichlet multinomial regression .",
    "however , efficient implementation of the optimization problems with these penalty functions is challenging .    in microbiome data analysis literature ,",
    "one commonly used approach is to normalize the counts into proportions and perform statistical analysis using the proportions .",
    "however , by converting into the proportions , the variation associated with the multinomial sampling process is lost . in 16s rrna sequencing , the sequencing depths ( total counts ) for",
    "samples can vary up to 10-fold .",
    "obviously , the accuracy of the proportion estimates under sequencing depth of @xmath202 reads is very different from that of @xmath203 reads . as shown in our simulations , modeling counts directly can result in gain of power in selecting relevant variables even when the number of sequence reads is very large .",
    "another problem associated with proportions is the existence of numerous zeros in the taxa count data .",
    "many proportion based approaches require taking logarithms of the proportions , which is problematic for the zero proportions . to circumvent this problem ,",
    "either a pseudo count ( e.g. , 0.5 ) is added to these zero counts before converting into proportions or an arbitrary small proportion is substituted for these zero proportions .",
    "the effects of creating pseudo counts have not been evaluated thoroughly when the data contain excessive zeros .",
    "besides overdispersion , the taxa count data can also exhibit zero - inflation [ @xcite ] , where the count data contain more zeros than expected from the dm model . how to model the microbiome count data that allows overdispersion",
    ", zero - inflation and possibly the phylogenetic correlations among the taxa is an important future research topic . the multilevel zero - inflated dm regression model for overdispersed count data with extra zeros [ @xcite ] can potentially provide a solution to this problem .",
    "another problem associated with the dm model is its inflexibility in modeling the covariance structure among the taxa counts .",
    "the multinomial model for counts compounded by a logistic normal model [ @xcite ] for proportions provides a possible solution .",
    "this needs to be investigated further .",
    "[ theorem1 ] letting @xmath204 , @xmath205 are nonnegative constants and @xmath206 is the minimizer of the following function : @xmath207 then @xmath208 and @xmath209 where @xmath210 and @xmath211 and @xmath212 is the sign function .",
    "we prove @xmath208 by contradiction .",
    "if @xmath213 @xmath214 , then we can construct a new @xmath215 with @xmath216 and other components being the same as @xmath206 . clearly , @xmath217 and @xmath218 .",
    "the former is due to the fact that @xmath219 for @xmath220 .",
    "hence , @xmath206 is not the minimizer of @xmath221 , which is contradictory .",
    "therefore , @xmath222 .    to prove the second part",
    ", we note that @xmath223 must be either @xmath49 or have an opposite sign of @xmath224 for @xmath225 .",
    "so the minimization of @xmath226 is equivalent to minimizing @xmath227 subject to @xmath228 since @xmath208 , we can restrict the minimization over only @xmath229 , @xmath230 subject to @xmath231 since @xmath232 is the minimizer of @xmath233 without the constraint , the sign of @xmath232 should be the opposite of the sign of @xmath234 . because @xmath235 for @xmath236 , the sign of @xmath234 is the same as @xmath237 .",
    "so the sign of @xmath232 is the opposite of that of @xmath237 .",
    "therefore , @xmath232 satisfies the constraint .    using simple variable substitution",
    ", we have the following corollary .    [ cor1 ] letting @xmath238 , @xmath205 are nonnegative constants and @xmath239 is the minimizer of the following function , @xmath240 then @xmath241 and @xmath242 where @xmath243 , @xmath211 and @xmath212 is the sign function .",
    "we thank doctors rick bushman , james lewis and gary wu for providing the data and for many insightful discussions .",
    "we also thank professor karen kafadar , an associate editor and two reviewers for many helpful comments ."
  ],
  "abstract_text": [
    "<S> with the development of next generation sequencing technology , researchers have now been able to study the microbiome composition using direct sequencing , whose output are bacterial taxa counts for each microbiome sample . </S>",
    "<S> one goal of microbiome study is to associate the microbiome composition with environmental covariates . </S>",
    "<S> we propose to model the taxa counts using a dirichlet - multinomial ( dm ) regression model in order to account for overdispersion of observed counts . </S>",
    "<S> the dm regression model can be used for testing the association between taxa composition and covariates using the likelihood ratio test . however , </S>",
    "<S> when the number of covariates is large , multiple testing can lead to loss of power . to address the high dimensionality of the problem , we develop a penalized likelihood approach to estimate the regression parameters and to select the variables by imposing a sparse group @xmath0 penalty to encourage both group - level and within - group sparsity . </S>",
    "<S> such a variable selection procedure can lead to selection of the relevant covariates and their associated bacterial taxa . </S>",
    "<S> an efficient block - coordinate descent algorithm is developed to solve the optimization problem . </S>",
    "<S> we present extensive simulations to demonstrate that the sparse dm regression can result in better identification of the microbiome - associated covariates than models that ignore overdispersion or only consider the proportions . </S>",
    "<S> we demonstrate the power of our method in an analysis of a data set evaluating the effects of nutrient intake on human gut microbiome composition . </S>",
    "<S> our results have clearly shown that the nutrient intake is strongly associated with the human gut microbiome . </S>"
  ]
}