{
  "article_text": [
    "barrier options are contracts whose pay - offs are activated or de - activated when the underlying process crosses a pre - specified level .",
    "these contracts are among the most popular path - dependent options .",
    "to value barrier options , a model needs to be sufficiently flexible to calibrate call option prices at different strikes and maturities .",
    "however , it is desirable to maintain a degree of analytical tractability to facilitate the calculations , especially for the greeks or the sensitivities .",
    "these sensitivities describe the change in the model price with respect to a change in the underlying parameter , and are important for an appreciation of the robustness of the model s results .",
    "it is well known that the accurate evaluation of the greeks is a challenging numerical problem , since standard pde or monte - carlo methods are generally slow and unstable .",
    "it is well established that the geometric brownian motion model lacks the flexibility to capture features in financial asset return data such as the skewness and the excess kurtosis .",
    "it can not calibrate simultaneously to a set of call option prices . to address these limitations ,",
    "one of the approaches consists of introducing jumps in the price process by replacing the brownian motion by a lvy process .",
    "lvy models , such as the vg , cgmy , nig , kobol , generalised hyperbolic , and kou s double exponential model , have been successfully applied to the valuation of european - type options .",
    "we refer to cont and tankov @xcite , boyarchenko and levendorskii @xcite , and schoutens @xcite for background and references on the application of lvy models in option pricing .",
    "as observed by many authors , such as eberlein and kluge @xcite , or carr and wu @xcite , lvy models are generally not capable of calibrating option prices simultaneously across strikes and maturities .",
    "empirical studies of s&p500 index data by carr and wu @xcite , and pan @xcite , show that the implied jump intensities and the implied jump size distributions vary greatly over time .",
    "the prices of short - dated options exhibit a significantly larger risk - premium than that of long - dated options .",
    "this is reflected in the thicker tails of the implied marginal risk - neutral distributions , especially at short maturities .",
    "for example , in the equity markets , short - dated out - of - the money put options are relatively expensive since the risk of a large negative jump in the share is priced . because of the stationarity and independence of the increments of a lvy process , the moments exhibit a rigid term structure that is different from what is observed in market data .",
    "this lack of flexibility can be overcome by considering models driven by additive processes , which have independent and time - inhomogeneous increments .",
    "additive models have been used for equity option pricing by carr et al .",
    "@xcite , galloway and nolder @xcite , and by eberlein and kluge @xcite for interest rate option pricing . motivated by modelling considerations , carr @xcite proposed a self - similar additive model for the log - price , and reported good calibration results across time .",
    "galloway and nolder @xcite carried out a calibration study for various related models .",
    "eberlein and kluge @xcite constructed an hjm model driven by an additive process with continuous characteristics , and they obtained a good fit for swaptions by using piecewise constant parameters .    in this paper",
    "we follow a similar approach : we model the share price by an additive process with hyper - exponential jumps .",
    "hyper - exponential distributions are finite mean - mixtures of exponential distributions which can approximate monotone distribution arbitrarily closely . as first observed by asmussen et al .",
    "@xcite , most of the popular lvy models used in mathematical finance possess completely monotone lvy densities and can therefore be approximated well by hyper - exponential lvy models .",
    "a hyper - exponential additive model is sufficiently flexible to allow for an accurate calibration to european option prices across strikes and multiple maturities .",
    "in addition , if the parameters are piecewise constant , the model admits semi - analytical expressions for prices and greeks of barrier options .",
    "there currently is a body of literature devoted to various aspects of pricing barrier options . in the setting of lvy models , a transform - based approach to price",
    "barrier options has been developed in a number of papers , including geman and yor @xcite , kou and wang @xcite , davydov and linetsky @xcite , boyarchenko and levendorskii @xcite .",
    "in particular , kou and wang @xcite , kou et al .",
    "@xcite , sepp @xcite , lipton @xcite , and jeannin and pistorius @xcite considered the cases of lvy processes with double - exponential and hyper - exponential jumps .    in this paper ,",
    "the transform algorithm that we develop is based on a so - called matrix wiener - hopf factorization .",
    "such matrix factorizations were first studied by london et al .",
    "@xcite and rogers @xcite for ( noisy ) fluid models .",
    "jiang and pistorius @xcite developed matrix - wiener factorization results for regime - switching models with jumps .",
    "we show that by suitably randomizing the parameters the distributions of the infimum and supremum of the randomized hyper - exponential additive process can be explicitly expressed in terms of a matrix wiener - hopf factorization .",
    "we use these results to derive semi - analytical expressions for the first - passage time probabilities , for the prices , and for the greeks of barrier options , up to a multi - dimensional transform .",
    "the actual prices are subsequently obtained by inverting this transform .",
    "as a numerical illustration , we calibrate the hyper - exponential additive model to eurostoxx prices quoted on 27 february 2007 at four different maturities .",
    "we calculate in this setting down - and - in digital and down - and - in call option prices and greeks ( delta and gamma ) .",
    "to invert the transform , we use a contour deformation algorithm and a fractional fast fourier transform algorithm , developed by talbot @xcite , bailey and swarztrauber @xcite , and chourdakis @xcite , @xcite .",
    "we also compare it to monte - carlo euler scheme simulations .",
    "we find that the algorithm is accurate and stable , and much faster than monte - carlo simulations ( especially for the greeks ) .",
    "this method is suitable for applications in which the number of periods is not too large ( up to four ) . when a larger number of periods is required , the direct inversion method used here is no longer feasible .",
    "the subject still needs to be further investigated and is left for future research .",
    "the remainder of the paper is organized as follows . in section",
    "[ sec : add ] we define the hyper - exponential additive model and present its application to european call option pricing . in sections",
    "[ sec : wh ] and [ sec : price ] we derive semi - analytical expressions for the first - passage probabilities of a hyper - exponential additive process in terms of a matrix wiener - hopf factorisation , and for the prices and greeks of barrier options . in section [ sec : num ] we present numerical results .",
    "we consider an asset price process @xmath0 modelled as the exponential @xmath1 of an additive process @xmath2 .",
    "informally , an additive process can be described as a lvy process with time - dependent characteristics or , equivalently , as a process with independent but non - stationary increments .",
    "we briefly review below some key properties of additive processes .",
    "for further background on additive processes and their applications in finance , we refer to sato @xcite , and to cont and tankov @xcite .",
    "an additive process can be defined more formally as follows .",
    "[ def : locallevy ] for a given @xmath3 , @xmath4\\}$ ] is an additive process if    * @xmath5 , * for any finite partition @xmath6 , the random variables @xmath7 are independent , * the sample paths @xmath8 have cdlg modifications almost surely .",
    "if @xmath2 is an additive process , then , for every @xmath9 $ ] , @xmath10 has an infinitely divisible distribution with lvy triplet @xmath11 ; that is , the characteristic function of @xmath10 is given by @xmath12 $ ] .",
    "according to the lvy - khintchine formula , @xmath13 is the characteristic exponent given by @xmath14 with @xmath15 , @xmath16 , and where @xmath17 the lvy measure satisfies the integrability constraint @xmath18 the law of the additive process @xmath19\\}$ ] is determined by the collection of lvy triplets @xmath20\\}$ ] .",
    "if the lvy triplets are time - independent , @xmath2 is a lvy process .",
    "if the additive process has absolutely continuous characteristics , the lvy triplets take the explicit form @xmath21 where @xmath22\\to\\mathbb r$ ] and @xmath23\\times\\mathbb r\\to\\mathbb r$ ] are integrable functions , with @xmath24 and @xmath25 non - negative .",
    "we call the functions @xmath26 the local triplet of @xmath2 . +   + we assume that we have been given deterministic integrable functions @xmath27 and",
    "@xmath28 representing the short rate and the dividend yield , and that the characteristic exponent of @xmath10 satisfies @xmath29\\td s,\\qquad \\ ] ] or equivalently @xmath30g(t , x)\\td x = r(t ) - d(t).\\ ] ] it follows that the discounted process @xmath31\\td s)\\ ] ] is a martingale if and only if ( or , equivalently , ) holds .      in what follows",
    "we restrict the discussion to a hyper - exponential additive process @xmath2 which is specified by its local triplet @xmath32 where @xmath24 is given by @xmath33 where @xmath34 and @xmath35 are non - negative .",
    "the continuous part of @xmath2 consists of a diffusion with time - dependent drift @xmath36 and volatility @xmath37 .",
    "the jump part of @xmath2 is of finite activity and forms an inhomogeneous compound poisson process where positive and negative jumps occur at the rates @xmath38 and jump sizes are distributed according to a hyper - exponential distribution .",
    "+ small random price movements are intuitively modelled by the diffusion part , whereas sudden changes of the price are captured by the jump - part of @xmath2 .",
    "if we take @xmath39 , the jump - sizes are exponentially distributed , and this model reduces to an extension of the kou model with time - dependent parameters .      to reduce the dimension of the available parameter set , we take the functions @xmath40 and @xmath41 to be piecewise constant .",
    "given that we have a finite set of european call options with different maturities @xmath42 , we take the local parameters to be constant between the different maturities @xmath43 . then for all @xmath44 $ ] , ( with @xmath45 )",
    "we set @xmath46 for @xmath47 $ ] the characteristic exponent of @xmath48 is given by @xmath49 where @xmath50",
    "the value of a digital barrier option can be expressed in terms of the distribution @xmath51 of the running supremum @xmath52 of @xmath2 , or equivalently , the distribution of the first - passage time @xmath53 which is related to @xmath54 by @xmath55 whereas for a lvy process the distributions of the infimum and supremum are linked to the characteristic exponent by the so - called wiener - hopf factorization , such a result does not exist for general additive processes , because of the time - dependence of the parameters .",
    "however , in the case of piecewise constant parameters , the triplet changes only at deterministic times , so that as a consequence the distribution function @xmath56 only depends on the inter - jump times @xmath57 ( with @xmath45 ) . in this case , as we show below , the @xmath58-dimensional laplace transform @xmath59 of @xmath54 , given by @xmath60 where @xmath61 , is expressed explicitly in terms of a matrix wiener - hopf factorization . to state",
    "this result we need to introduce some further notation .    for any vector @xmath62 , we denote by @xmath63 the diagonal matrix @xmath64 .",
    "let @xmath65 be the @xmath66 matrix given in block notation by @xmath67 where @xmath68 here @xmath69 , and @xmath70 and @xmath71 are the @xmath72 and @xmath73 matrices in block notation given by @xmath74 here @xmath75 is the row - vector @xmath76 , and where @xmath77 , @xmath78 are given by @xmath79 where @xmath80 is the column - vector @xmath81 , and @xmath82 where @xmath83 are @xmath84 zero matrices , and @xmath85 , @xmath86 , and @xmath87 are given by and with @xmath88 and @xmath89 replaced by @xmath90 and @xmath91 .",
    "the matrix @xmath65 is a generator matrix , that is , a square matrix with non - negative off - diagonal elements and non - positive row sums , and defines a markov chain .",
    "this markov chain is associated to a randomization and embedding of the additive process @xmath2 ( which will be illustrated with a concrete example below ) .",
    "we recall that a sub - probability matrix is a matrix with non - negative elements and row sums not larger than one . by applying the matrix wiener - hopf factorization results of jiang and pistorius @xcite to the current setting",
    "we arrive at the following conclusion .",
    "[ thm : wh ] it holds that @xmath92,\\ ] ] where @xmath93 @xmath94 is an @xmath95 generator matrix that together with @xmath96 an @xmath97 sub - probability matrix , solves the system of matrix equations @xmath98 here the @xmath99 s are zero matrices of appropriate sizes , and in block notation we have , @xmath100 with @xmath101 @xmath102 and @xmath103 represent @xmath104 zero and identity matrices , respectively .    by applying theorem [ thm : wh ] to @xmath105",
    ", we find the corresponding pair of matrices @xmath106 .",
    "the quadruple @xmath107 is called a matrix wiener - hopf factorization of @xmath65 .",
    "+   + * example . * to illustrate this approach , we consider a hyper - exponential additive process @xmath2 on @xmath108 $ ] whose parameters are constant during the periods @xmath109 $ ] and @xmath110 $ ] . in the first period @xmath2",
    "evolves as a jump - diffusion with positive and negative exponential jumps with means and jump rates @xmath111 and @xmath112 . in the second period @xmath2",
    "is a brownian motion with drift .",
    "the idea is to randomize the times between maturities by replacing @xmath113 and @xmath114 with independent exponential random variables having means @xmath115 and @xmath116 .",
    "this results in a regime - switching jump - diffusion with the regime only jumping from state 1 to state 2 , according to the generator matrix @xmath117 we associate to the regime - switching process a continuous markov additive process , which can be informally obtained by replacing positive and negative jumps with stretched slopes of @xmath118 and @xmath119 ( see asmussen @xcite for background on this embedding ) . as described in @xcite , in this case the generator of the modulating markov process",
    "is given by @xmath120 with the matrices @xmath121 and @xmath122 in theorem [ thm : wh ] given by @xmath123     are illustrated . here",
    "@xmath2 is a hyper - exponential additive process on the period @xmath108 $ ] whose parameters are constant during the periods @xmath109 $ ] and @xmath110 $ ] . during the first period @xmath109",
    "$ ] , the process @xmath2 evolves as a jump - diffusion with volatility @xmath124 , drift @xmath125 and exponentially - distributed jumps .",
    "the positive and negative jumps are exponentially - distributed with means and jump rates @xmath111 and @xmath112 , respectively . during the second period",
    "@xmath126 $ ] , @xmath2 evolves as a linear brownian motion with volatility @xmath127 and drift @xmath128 .",
    "associated to @xmath2 is a continuous markov additive process @xmath129 , which can be obtained from @xmath2 by replacing the positive and negative jumps with linear stretches of path of slopes @xmath118 and @xmath119 , and replacing the fixed times @xmath130 , @xmath131 by independent exponential random times @xmath132 and @xmath133 with parameters @xmath134 .",
    "the process @xmath135 that records the current state or regime of @xmath129 is a markov process with generating matrix @xmath65 .",
    "when @xmath135 takes values 1 and 2 , @xmath129 evolves as a linear brownian motion with zero drift and volatility @xmath124 and @xmath127 respectively ; and when @xmath135 is 3 and 4 , @xmath129 is a positive or negative unit drift .",
    "these linear stretches of paths of @xmath129 originate from the jumps of @xmath2 . a jump of @xmath135 from one state to another is induced either by a jump of @xmath2 or by a switch of the set of parameters that determine the dynamics of @xmath2 . by time - changing @xmath129 by the time @xmath136 up to time @xmath137",
    "that @xmath135 was equal to @xmath138 and @xmath139 , we recover a regime - switching jump - diffusion ; that is , the process @xmath140 is in law equal to a regime - switching jump - diffusion .",
    "finally , replacement of the times at which a regime switch occurs by @xmath130 and @xmath141 results in a process that has the same distribution as @xmath2.,width=285,height=393 ]      to solve the system , which is a ricatti - type matrix equation , we follow a spectral approach and determine the spectral decomposition of @xmath142 . denoting by @xmath143 a ( column ) eigenvector of @xmath142 corresponding to the eigenvalue @xmath144 , one finds that it is a matter of algebra to verify that the system can be equivalently rewritten as @xmath145 here @xmath99 is a @xmath146 square zero matrix , @xmath147 is an @xmath148 identity matrix , and @xmath149 defining the matrix @xmath150 by @xmath151 we find that @xmath143 solves the linear system @xmath152\\begin{pmatrix}i\\\\\\eta^+\\end{pmatrix}h(\\rho)=\\mbf 0,\\ ] ] which implies that @xmath144 is a root of the equation @xmath153 .",
    "the following result characterizes the eigenvalues of @xmath142 ( see appendix a ) :    [ lem : eigen ]    * it holds that @xmath154 has @xmath148 positive roots and @xmath155 negative roots .    since @xmath156 is the negative of a generator matrix , it is non - negative definite , so its eigenvalues are non - negative and are given by the positive roots of .",
    "in particular , if the positive roots @xmath157 of equation are distinct , it follows from lemma [ lem : eigen ] and theorem [ thm : wh ] that @xmath158,\\ ] ] where @xmath159 .",
    "the valuation of barrier options involves the joint distribution of the final position at maturity @xmath160 and the first exit time .",
    "we will extend the results in the previous section by considering the following : @xmath161\\\\ & = & e[\\te{sx_t}\\mathbf 1_{\\ { t^+(x ) < t\\}}].\\end{aligned}\\ ] ] @xmath162 depends on time only through the inter - maturity times @xmath163 .",
    "the laplace transform @xmath164 of @xmath165 in @xmath163 , can be expressed in terms of @xmath142 and @xmath150 as follows :    [ prop : xs ] it holds that @xmath166 for all @xmath167 with @xmath168 .",
    "a proof is given in appendix a.      the form of the analogous distributions concerning the infimum @xmath169,\\quad x>0,\\ ] ] can be found by applying the results in the previous section to the process @xmath105 .",
    "more specifically , it is straightforward to check that the @xmath58-dimensional laplace transforms @xmath170 and @xmath171 are given by and replacing @xmath142 by @xmath172 .",
    "@xmath173 satisfies the system of matrix equations with @xmath174 replaced by @xmath175 , where the latter set is defined by interchanging @xmath176 and @xmath177 in equations , , and .",
    "it is straightforward to verify that _ (",
    "i ) _ an eigenvector @xmath143 of @xmath172 corresponding to eigenvalue @xmath144 satisfies @xmath178\\begin{pmatrix}\\eta^-\\\\ i\\end{pmatrix}h(\\rho)=0,\\ ] ] where @xmath147 is an @xmath155 identity matrix , and _",
    "( ii ) _ that , in view of lemma [ lem : eigen ] , the eigenvalues of @xmath172 are given by the negative roots @xmath179 of @xmath180 .",
    "using the first - passage results from the previous section we derive semi - analytical expressions for the prices and sensitivities of down - and - in digital and knock - in call options .",
    "a down - and - in digital option at level @xmath181 is a contract that pays out one unit at maturity @xmath160 if the price @xmath0 has down - crossed the level @xmath182 before @xmath160 .",
    "similarly , a down - and - in call option at level @xmath181 and with strike @xmath183 is a call option whose pay - off is activated once @xmath0 down - crosses @xmath182 . taking the risk - free rate @xmath184 and the dividend rate @xmath185 to be constant ,",
    "the arbitrage free prices of a down - and - in digital @xmath186 and a call option @xmath187 are given respectively by @xmath188    = \\te{-(r - d)t } p(\\unl x_t < h),\\ ] ] where @xmath189 is the log - barrier , and @xmath190,\\ ] ] where @xmath191 denotes the log - strike .",
    "let @xmath192 denote the joint laplace transform of @xmath193 in the inter - maturity times @xmath194 ( with @xmath195 ) , and denote by @xmath196 the laplace - fourier transform in @xmath194 and in the log - strike @xmath197 .",
    "then we have the following result :    [ prop : price ] for @xmath198 it holds that @xmath199 where @xmath191 , @xmath200 , and @xmath201    before we give the proof we observe that from the explicit expressions and semi - analytical formulas can be obtained for the delta and gamma of the down - and - in digital and call options ( i.e.  the first and second derivatives of the option value with respect to the spot @xmath202 ) . indeed , the derivatives of the expressions and with respect to @xmath202 are equal to the laplace - fourier transforms of the derivatives of the option , as integration and differentiation are interchangeable in this case . in the case of a down - and - in digital option",
    "we find that the laplace transforms @xmath203 and @xmath204 of the delta @xmath205 and gamma @xmath206 are given by @xmath207\\te{q^- h}\\mathbf 1.\\ ] ]    the expression is a direct consequence of theorem [ thm : wh ] ( see also section [ ssec : low ] ) . to verify we start by taking the fourier transform in @xmath197 and find as in that the fourier transform @xmath208 is given by @xmath209 where @xmath210 and @xmath211.\\ ] ] from proposition [ prop : xs ] we deduce that the form the joint laplace transform @xmath212 of @xmath213 in @xmath163 is given by @xmath214 combining and completes the proof .",
    "to determine a parameter set to test the method , we calibrate the hyper - exponential additive model to eurostoxx call options at four different maturities , observed in the market on 20 february 2007 .",
    "the spot price is eur @xmath215 , the risk - free rate is assumed to be fixed at @xmath216 , and the dividend rate is taken to be zero . as we find that inclusion of positive jumps does not substantially improve the calibration results , we only consider negative jumps , and we specify the jump size parameters to be @xmath217 .",
    "the jump arrival rates and the volatility are piecewise constant in time , and are estimated by minimizing the root - mean - square error between model and observed market call prices . using the well known fourier transform method ( briefly recalled in appendix [ app : euro ] ) the calibration",
    "is carried out maturity by maturity under constraints through a bootstrapping method with well - defined local triplets :    1 .",
    "calibrate call prices at @xmath130 to obtain the parameters @xmath218 .",
    "2 .   for @xmath219 calibrate call prices at @xmath220 to obtain @xmath221 .    in figure 2",
    "the calibration results are presented with plots of the market and model implied volatility surfaces corresponding to the four maturities @xmath222 m , @xmath138y , @xmath223y and @xmath224y . the root - mean - square error ( rmse ) and the average relative percentage error ( arpe )",
    "are equal to @xmath225 and @xmath226 .",
    "we compare it to a price process that follows a lvy process with hyper - exponential jumps ( i.e.  with constant parameters over time ) , and find that the calibration of the four maturities in that case give a rmse of @xmath227 and an arpe of @xmath228 . in table 1",
    "the resulting parameter sets are displayed under the hyper - exponential additive and lvy models . in the case of the hyper - exponential model we observe a high jump intensity of small jumps for short maturities that decrease substantially over time",
    "this is consistent with the finding of carr and wu @xcite , and pan @xcite .",
    "[ fig : cal ]      using the parameter set found in the calibration of the eurostoxx call options , we value barrier and digital options on the eurostoxx index , modelling its price process as the exponential of a hyper - exponential additive process .",
    "we use the semi - analytical results in proposition [ prop : price ] . to invert the multi - dimensional laplace transforms",
    "we choose talbot s method @xcite ( see also @xcite ) for down - and - in digital options .",
    "we combine it with the fractional fft algorithm of bailey and swarztrauber @xcite , and chourdakis @xcite for down - and - in call options .",
    "see appendix [ app : trans ] for a detailed description of the implementation of these transform algorithms .",
    "we compare it to the same quantities calculated by monte - carlo simulations , using a standard euler scheme .",
    "we price down - and - in digital options with a maturity of five years for different spot levels .",
    "we evaluate the required 4-dimensional laplace transform over two time increments of six months , and two of two years , that is , @xmath229 , @xmath230 , @xmath231 , @xmath232 .",
    "we use talbot s algorithm with @xmath233 ( see appendix [ app : trans ] for an explanation of this parameter ) . using mathematica to run the algorithm ,",
    "the computation time was five minutes on a 3189 mhz computer to calculate prices and greeks for fourteen different spot levels .",
    "the calculation of first passage probabilities using monte - carlo simulations requires a large number of time steps and paths .",
    "we use one million paths with @xmath234 and it takes several hours to obtain stable greeks in c++ .",
    "error bounds can not be obtained analytically , but we observe in table [ table : vgdd ] that the results of the transform method agree with monte - carlo simulation results .",
    "figures 3 and 4 report prices and greeks for down - and - in digital options .",
    "the options are expressed as a percentage of the spot price .",
    "the values of the sensitivities are expressed as fractions of the spot price @xmath202 .",
    "this transform algorithm is particulary efficient at a book level , since once the generating matrices @xmath172 of the infimum have been calculated for different values of the vector @xmath235 the calculation of prices and greeks of any digital barrier product is just a matter of summation .",
    "we value down - and - in call options with a maturity of one year for different strike levels . in this case , a two - dimensional laplace inversion is required over time increments @xmath229 and @xmath230 . for the inversions of the laplace",
    "transform and the fourier transform , we set @xmath236 and @xmath237 ( refer to appendix [ app : trans ] for an explanation of these parameters ) . for monte - carlo simulations ,",
    "we use one million paths with time step @xmath238 .",
    "the option prices and greeks obtained by the two methods are reported in table [ table : vgdic ] and figures [ fig : did5yg ] and [ fig : dic1y ] .",
    "we observe that the results of the transform method agree with the monte - carlo simulation results .",
    "using mathematica again to run the algorithm , the computation time is ten minutes to calculate the option prices , delta and gamma for eleven different levels of the strike .",
    "since the option prices and greeks of a down - and - in call option are obtained via a fourier - laplace transform , it takes more time than in the case of a digital option ( approximately twice as long ) , which is still much faster than a monte - carlo euler scheme .",
    "we note that the transform algorithm is particulary efficient for the pricing of options with different strikes , as we obtain by frfft inversion the prices and greeks of any down - and - in call options on a log - strike grid .",
    "+     +    * appendix *",
    "_ proof of lemma [ lem : eigen ] : _    * it is straightforward to verify that @xmath239 can be obtained from @xmath150 by interchanging some columns and rows , where @xmath239 is given by @xmath240 where @xmath241 and @xmath242 are square matrices of dimension @xmath243 .",
    "there are defined respectively by @xmath244 where @xmath245 , and @xmath246 therefore @xmath247 is equal to @xmath248 . to proceed we recall an identity from matrix algebra .",
    "let @xmath249 be a matrix of the form @xmath250 in block notation , where @xmath251 is invertible .",
    "then @xmath252 using this identity , it is a matter of algebra to verify by induction that @xmath253 as a consequence we find , by applying this matrix identity , that @xmath254 and the assertion follows in view of . * using the intermediate value theorem and the specific form of @xmath255 , it is straightforward to check that the equation @xmath256 , @xmath257 has @xmath258 positive roots @xmath259 and @xmath260 negative roots @xmath261 , satisfying @xmath262 since @xmath263 is a polynomial of degree @xmath264 , it follows that all the roots of @xmath265 are given by @xmath266 and @xmath267 . in view of the form of @xmath268 derived in (",
    "i ) the assertion follows .",
    "+   + _ proof of proposition [ prop : xs ] : _ consider the following randomization of @xmath2 obtained by randomizing the inter - maturity times @xmath269 by replacing them by independent exponential random times with means @xmath270 , and call this process @xmath271 .",
    "the process @xmath271 is a regime - switching jump - diffusion , where the only regime switches that can occur are from @xmath272 to @xmath273 at rate @xmath274 ( @xmath275 ) , and from the final state @xmath58 to an absorbing graveyard state @xmath276 .",
    "as shown in @xcite , the process @xmath271 is equal to a time - changed continuous process @xmath129 , say .",
    "denoting by @xmath277 the epoch at which @xmath129 is sent to @xmath276 , by @xmath135 the modulating markov chain , and by @xmath278 , we have @xmath279\\\\ & = & e[\\te{s a_{\\zeta- } } \\mathbf 1_{\\{\\tau < \\zeta\\}}]\\\\ & = & e[\\te{s a_{\\tau } } \\mathbf 1_{\\{\\tau < \\zeta\\}}f(y_\\tau)]\\\\ & = & \\te{s x } e[\\mathbf 1_{\\{\\tau < \\zeta\\}}f(y_\\tau)],\\end{aligned}\\ ] ] with @xmath280,\\ ] ] where the last two lines follow by the markov property of @xmath281 and the fact that @xmath129 is continuous . to guarantee that all the expressions are well defined in this calculation @xmath282 has to be such that @xmath283<\\i$ ] , which corresponds to the restriction that @xmath284    in @xcite it was shown that the vector @xmath285 , where @xmath58 denotes the state space of @xmath135 , is given by @xmath286 where the matrix @xmath150 is given in ( [ eq : k ] ) . combining these results with theorem [ thm : wh ]",
    "we find that @xmath287 and the proof is complete .",
    "under the hyper - exponential additive model with piecewise constant parameters , the characteristic function at time @xmath160 is explicitly given by @xmath288 with @xmath289 as given in .",
    "the price of a european call with maturity @xmath43 can thus be efficiently calculated using a well - established fourier transform method , which we briefly recall .",
    "the fourier transform @xmath290 over @xmath197 of @xmath291 , the price of a call option with log - strike @xmath191 and maturity @xmath43 , can be explicitly expressed in terms of the characteristic function @xmath292 as follows : @xmath293 \\td k\\\\ & = & s_0\\te{-rt_i}\\frac{\\phi^{(i)}(v-(\\alpha+1)\\mathbf i)}{(\\alpha+\\mathbf iv)(\\alpha+1+\\mathbf iv)}.\\label{eq : fftcall}\\end{aligned}\\ ] ] since the call pay - off function itself is not square - integrable in the log - strike , the axis of integration is here shifted over @xmath294 which corresponds to exponentially dampening the pay - off function at a rate @xmath295 , which is usually taken to be @xmath296 ( see carr and madan @xcite ) .",
    "the call option prices are then determined by inverting the fourier transform : @xmath297",
    "to evaluate down - and - in digital option prices ( did ) , we invert the multi - dimensional laplace transform to obtain @xmath298 where @xmath299 and @xmath300 are vertical lines in the complex plane defined by @xmath301 for @xmath302 with @xmath303 and fixed values of @xmath304 , chosen such that all the singularities of the transform @xmath305 are coordinate - wise on the left of the lines @xmath300 .",
    "many algorithms approximate the integrals in by a finite linear combination of the transform at some specific nodes with certain weights .",
    "three approaches have been studied by abate et al .",
    "@xcite , based on fourier series expansion , combinations of gaver functionals , and deformation of the integral contour . here",
    "we concentrate on the last method developed by talbot @xcite , since reports in the literature ( e.g. @xcite ) suggest that this approach offers high performance for a short time of execution , which our numerical results confirm .",
    "we write @xmath306 with @xmath302 , @xmath307 , @xmath308 , and @xmath309 since @xmath193 is a real valued function , @xmath193 is also equal to the real part of the integral on the right - hand side of , which can be used to reduce the calculation by a factor of two . to illustrate the evaluation of the integrals",
    ", we present concrete expressions for the approximating sums when @xmath310 ( which is the setting that will be implemented later on ) . defining @xmath311",
    "we obtain @xmath312 where @xmath313 is equal to @xmath314 .",
    "the weights and the nodes are given by @xmath315 ^ 2)-\\mathbf i \\cot(k\\pi / m))e^{q_k}.\\end{aligned}\\ ] ] since the weights and nodes are independent of the transform , the calculation time of the algorithm can be reduced by pre computing and storing weights and nodes .",
    "the speed of convergence and the accuracy of the talbot algorithm will depend on the regularity of the laplace transform @xmath313 .",
    "although universal error bounds are not known , abate et al .",
    "@xcite showed numerically that the single parameter @xmath249 can be used to control the error and can be seen as a measure for the precision .",
    "they found after extensive numerical experiments that for a large class of laplace transforms the relative error is approximately @xmath316 .",
    "for high dimensional inversion , extra accuracy in the inner sums may be needed to obtain a sufficient degree of precision for the outer sums , which can be achieved by increasing @xmath249 .      to evaluate down - and - in call option prices ( dic ) , we invert the fourier - laplace transform over log - strike and time periods . for",
    "the inversion of the laplace transform we again apply the talbot algorithm . in the case of two time periods , with @xmath317",
    "we find that the fourier transform @xmath208 can be approximated by the following sums : @xmath318 unlike the case of the inversion of @xmath314 , we can not reduce the calculation time by two by using complex conjugates , since the function @xmath208 is not real valued .",
    "down - and - in call prices are then obtained by inverting the fourier transform over strike : @xmath319 where @xmath295 is the rate of exponential dampening .",
    "this integral is approximated for a set of log - strikes between @xmath320 as a summation : @xmath321 where @xmath322 are the integration weights defined by the trapezoidal rule with @xmath323 and @xmath138 otherwise , @xmath324 is the log - strike grid step - size and @xmath325 is the @xmath326-grid step - size . carr and madan @xcite and chourdakis @xcite set @xmath327 .    to have accurate prices for any strike , the log - strike grid spacing @xmath328 needs to be sufficiently small .",
    "a common approach is to apply directly the fast fourier transform ( fft ) and to compute the summation on a fixed log - strike range @xmath320 with @xmath329 using many points @xmath58 .",
    "bailey and swarztrauber @xcite , @xcite propose an alternative approach , and define the fractional fast fourier transform ( frfft ) , which uses an arbitrary range .",
    "chourdakis @xcite showed that the frfft can be used to calculate option prices with less points without losing accuracy .",
    "he reported that the frfft is @xmath330 times faster than the fft for the calculation of european option prices .",
    "since in our case the fourier transform @xmath208 is obtained numerically , we chose to employ the frfft .",
    "we now briefly specify the form of this algorithm in our setting , and refer for further details to @xcite , @xcite , @xcite .",
    "the resulting sum is then given by @xmath331 where @xmath332 , @xmath333 and @xmath334 . extending this summation into a circular convolution over @xmath335 yields @xmath336 where @xmath337 and @xmath338 this equation can be rewritten in terms of three discrete fourier transforms : @xmath339 with @xmath340 although the latter sum is computed by invoking two fourier transforms and one inverse fourier transform , this approach has the advantage of computing the option prices on a specific log - strike window @xmath320 with independent grids @xmath325 and @xmath328 and requires less points ."
  ],
  "abstract_text": [
    "<S> in this paper we develop an algorithm to calculate the prices and greeks of barrier options in a hyper - exponential additive model with piecewise constant parameters . </S>",
    "<S> we obtain an explicit semi - analytical expression for the first - passage probability . </S>",
    "<S> the solution rests on a randomization and an explicit matrix wiener - hopf factorization . employing this result we derive explicit expressions for the laplace - fourier transforms of the prices and greeks of barrier options . as a numerical illustration </S>",
    "<S> , the prices and greeks of down - and - in digital and down - and - in call options are calculated for a set of parameters obtained by a simultaneous calibration to stoxx50e call options across strikes and four different maturities . by comparing the results with monte - carlo simulations , </S>",
    "<S> we show that the method is fast , accurate , and stable .    _ </S>",
    "<S> keywords : _ hyper - exponential additive processes , matrix wiener - hopf factorization , first passage times , barrier options , multi - dimensional laplace transform , fourier transform , sensitivities .    </S>",
    "<S> _ acknowledgements : _ we would like to thank p.  howard and s.  obraztsov for their support , and also d.  madan for useful conversations </S>",
    "<S> . this research was supported by epsrc grant ep / d039053 , and was partly carried out while the authors were based at king s college london . </S>"
  ]
}