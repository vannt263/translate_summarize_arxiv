{
  "article_text": [
    "because of an increasing demand in high - energy astrophysics , numerical modeling of relativistic kinetic plasmas has been growing in importance . to date , many simulations on relativistic kinetic processes have been performed , such as the rankine - hugoniot problem across a relativistic shock @xcite , magnetic reconnection and kinetic instabilities @xcite in a relativistically hot current sheet,@xcite and the kinetic kelvin - helmholtz instability in a relativistic flow shear @xcite . in these simulations",
    ", one has to carefully set up ultrarelativistic bulk flows and/or relativistically hot plasmas in their rest frame .",
    "loading velocity distribution function , i.e. , initializing particle velocities by using random variables according to a relativistic distribution function , is essentially important .    in nonrelativistic particle simulations",
    ", it is quite natural to begin with a maxwell - boltzmann distribution ( maxwellian in short ) . to load the maxwellian , the box ",
    "muller algorithm is widely used.@xcite one can easily initialize a distribution with a bulk drift velocity , by applying an offset to the particle velocities .    in relativistic simulations ,",
    "it is natural to begin with a relativistic maxwellian , also known as the jtter - synge distribution function.@xcite in order to load it , perhaps the @xcite algorithm is the most popular , at least in monte  carlo simulation community .",
    "the algorithm was formally proposed by @xcite in a russian proceeding .",
    "its key results are outlined in @xcite .",
    "meanwhile , it is not so clear how to initialize particles according to the relativistic shifted - maxwellian or moving population of other distributions . to the best of our knowledge ,",
    "the algorithms for the jtter - synge distribution have not been applied to the relativistic shifted - maxwellian .",
    "several alternative algorithms have been proposed .",
    "@xcite applied a rejection method for a log - concave distribution function .",
    "@xcite utilized a numerical cumulative distribution function and cylindrical transformation .    in this research note , we describe numerical methods to load relativistic maxwellians in particle simulations .",
    "we first describe two base algorithms to load stationary relativistic maxwellian , the inverse transform method and the sobol method.@xcite next we apply the lorentz transformation to obtain the relativistic shifted - maxwellian .",
    "simple rejection methods are proposed to deal with the spatial part of the lorentz transformation .",
    "we validate the algorithms by test problems , followed by discussions .",
    "we consider relativistic maxwell distributions ( jttner - synge distribution@xcite ) in the following form , @xmath1 where @xmath2 is the spatial components of the 4-velocity , @xmath3 is the velocity , @xmath4^{-1/2}$ ] is the lorentz factor , @xmath5 is the rest mass , @xmath6 is the light speed , @xmath7 is the temperature , and @xmath8 is the modified bessel function of the second kind .",
    "the normalization constant is set such that the number density is @xmath9 .",
    "hereafter we set @xmath10 and @xmath11 for simplicity .",
    "we use uppercases for fluid quantities and lowercases for particle properties throughout the paper .    to generate @xmath12",
    ", we consider the spherical transformation @xmath13 . then equation [ eq : js ] yields @xmath14 in the special case of @xmath15",
    ", one can read this equation as a probability function with respect to @xmath16 .",
    "we generate @xmath16 whose distribution follows equation [ eq : exp_u2 ] by either the inverse transform method ( sec .",
    "[ section : inverse ] ) or the sobol method ( sec .",
    "[ section : sobol ] ) .",
    "we will describe these methods in the next subsections .",
    "after we obtain @xmath16 , we generate @xmath12 on a spherical surface @xmath17 in the momentum space . using uniform random variables @xmath18 and @xmath19 , we set @xmath12 in the following way , @xmath20 then we obtain a relativistic maxwellian which follows equation [ eq : js ] .",
    "we consider the cumulative distribution function @xmath21 with a practical upper bound @xmath22 , @xmath23 in the nonrelativistic limit of @xmath24 , @xmath25 is sufficient , where @xmath26 is the thermal speed . in the relativistically hot case of @xmath27 , equation",
    "[ eq : exp_u2 ] behaves like @xmath28 for @xmath29 .",
    "this decays slower than the nonrelativistic limit of @xmath30v^2 $ ] , and so we increase the upper bound to @xmath31 .",
    "we usually prepare a numerical table of @xmath21 with @xmath32 or more grid points . using a uniform random variable @xmath33",
    ", we compute @xmath34 by referring and interpolating the table .",
    "let us consider the gamma distribution .",
    "its probability function @xmath35 is given by @xmath36 where @xmath37 and @xmath38 are free parameters and @xmath39 is the gamma function .",
    "the gamma distribution with an integer parameter @xmath37 can be generated by multiple random variables @xmath40 s ( @xmath41 ) in the following way,@xcite @xmath42    @xcite noticed that the right hand side of equation [ eq : exp_u2 ] is similar to the third - order gamma distributions , @xmath43 for a certain @xmath7 , we initialize @xmath16 by using three random variables ( @xmath44 ) , @xmath45 comparing the exponential parts in equations [ eq : exp_u2 ] and [ eq : pgamma ] , we obtain a relativistic maxwellian by the rejection method . by using another random variable @xmath46",
    ", we accept the particle if @xmath47 then we obtain @xmath16 which is distributed by equation [ eq : exp_u2 ] .",
    "using equation  [ eq : gamma3 ] , this criteria can be modified to @xmath48 this leads to a simple form of the sobol s criterion,@xcite @xmath49 where @xmath50 .",
    "note that @xmath51 and @xmath16 share the same variables @xmath52 , and @xmath53 .",
    "make sure to avoid zero in @xmath54 , because @xmath55 is undefined .",
    "once equation [ eq : sobol ] ( or eq .  [ eq : rej ] ) is met , we continue to the next step of the spherical scattering ( eq .  [ eq : spherical_scattering ] ) .    comparing the normalization factors in equation [ eq : exp_u2 ] with @xmath15 and equation [ eq : pgamma ]",
    ", we obtain the overall efficiency of the rejection method as a function of @xmath7,@xcite @xmath56 figure [ fig : eff ] shows the acceptance efficiency of the sobol method , as a function of @xmath7 .",
    "the efficiency quickly decreases for @xmath57 , while it approaches to @xmath58 for @xmath59 .",
    "next we discuss general properties of the lorentz transformation for particle distributions .",
    "we consider the transformation between two frames , @xmath60 and @xmath61 .",
    "we assume that particles are stationary in the reference frame @xmath60 , and then we switch to a moving frame @xmath61 at the 4-velocity @xmath62 . without losing generality , we consider the transformation in the @xmath63 direction . in @xmath61 , we observe the particle distribution , boosted by the 4-velocity @xmath64 . we denote the observed properties in @xmath61 by the prime sign ( @xmath65 ) .",
    "as the total particle number is conserved , we recognize @xmath66 here , @xmath67 is the spatial volume element . using the time element @xmath68 in the same frame , we consider the 4-dimensional volume element of @xmath69 and @xmath70 that is moving at the 4-vector of @xmath12 .",
    "the 4-dimensional position @xmath71 follows the lorentz transformation , and so the 4-volume element vector @xmath72 also follows the lorentz transformation .",
    "since the jacobian of the lorentz transformation matrix @xmath73 is 1 , the 4-volume @xmath74 is conserved , i.e. , @xmath75 .",
    "since we deal with the @xmath12-moving volume , the time element @xmath68 is related to the canonical time element @xmath76 in the following way , @xmath77 .",
    "we similarly see @xmath78 .",
    "therefore we obtain @xmath79 this also indicates the length contraction for the volume .",
    "the transformation is slightly different for @xmath80 , because @xmath12 is constrained by @xmath81 . without losing generality",
    ", one can consider the lorentz transformation by @xmath62 in the @xmath63 direction : @xmath82 under the condition of @xmath83 , we obtain @xmath84    from equations .  [",
    "eq : dx ] and [ eq : du ] , we obtain @xmath85 .",
    "this ensures @xmath86 we obtain a relativistic shifted - maxwellian by simply translating equation  [ eq : f ] , @xmath87    since we know nice algorithms ( sec .",
    "ii ) , we would like to initialize the particle momentum @xmath12 in the @xmath60 frame , and then translate it to the @xmath61 frame by the lorentz transformation , @xmath88 .",
    "this procedure contains the momentum - space transformation ( eq .",
    "[ eq : du ] ) . however , it does not take care of the spatial part of the transformation , @xmath89 ( eq .  @xmath90 ) . using the @xmath60-frame quantities ,",
    "the distribution in @xmath61 appears to the observer in the following way , @xmath91 we recognize a volume transform factor @xmath92 , because the element volume in @xmath60 is not identical to the element volume in @xmath61 .",
    "this issue is also addressed by @xcite .",
    "@xmath93 one can also interpret that the number density is reciprocal to the volume size @xmath94 ( see also eq .",
    "[ eq : dx ] ) .",
    "since both spacial and momentum transformation ( equations [ eq : dx ] and [ eq : du ] ) depends on @xmath12 , the factor differs _ from particle to particle_. this may sound tricky , but the above formula describes what the observer looks at .",
    "we obtain very different results without the volume transformation , as will be shown in section iv .    in this line",
    ", we briefly outline relativistic fluid properties .",
    "we assume isotropic maxwellian distribution . from equation [ eq : du ] , the number flux 4-vector @xmath95 yields @xmath96",
    "we see @xmath97 .",
    "equations [ eq : n ] ensures that @xmath95 follows the lorentz transformation , i.e. , @xmath98 , where @xmath73 is the lorentz tensor .",
    "similarly , the stress - energy tensor @xmath99 yields , @xmath100 clearly it follows the lorentz transformation , i.e. , @xmath101 . in this case , @xmath102 where @xmath103-t \\}$ ] is the internal energy density and @xmath104 is the pressure in the rest frame .      here , we describe simple methods to deal with the volume transform factor ( eq .  [ eq : factor ] ) .",
    "it is impossible to deal with this by adjusting the cell size in pic simulation , because the transformation differs from particle to particle .",
    "one can also change the weight of particles .",
    "however , we prefer not to do so , because the ratio of the heaviest particle to the lightest particle could be very large .",
    "we propose to adjust the particle number by a rejection method .",
    "using a random variable @xmath105 ( @xmath106 ) , we accept the particle if the following condition is met , @xmath107 the left hand side ranges from 0 to 1 .",
    "if the condition is not met , then we re - initialize the particle momentum .",
    "the factor @xmath108 can be absorbed in the normalization constant , because we usually know the value of @xmath109 before loading particles .",
    "the expected value @xmath110 $ ] of the acceptance efficiency is @xmath111 , @xmath112 = \\frac{1}{2 } ( 1 + \\beta { \\rm e}[v_x ] ) = 0.5.\\ ] ] if @xmath60 is not the fluid rest frame , @xmath113 \\ne 0 $ ] and so the efficiency may vary .",
    "we can further improve the efficiency in a special case of a symmetric distribution .",
    "when @xmath114 , we multiply the acceptance factor by 2 , @xmath115 the @xmath116 factor is absorbed in the total particle number .",
    "we take advantage of the fact that the second term of the right hand side is odd function of @xmath117 ( or @xmath118 ) .",
    "when @xmath119 is negative , the acceptance factor ranges between @xmath120 .",
    "we reject the particles at the probability of @xmath121 . on the other hand ,",
    "when @xmath119 is positive , the factor ranges between @xmath122 .",
    "we accept all particles .",
    "in addition , we interpret that we need to add another set of particles at the probability of @xmath121 . if @xmath114 , the number of the rejected particles and the number of the particles to be added are equal .",
    "we simply reverse the sign of @xmath117 of the rejected particles , and then we add them to the positive-@xmath119 side .",
    "this logic is schematically illustrated in the bottom of figure [ fig : shifted ] .",
    "we summarize the algorithm in the following way . if the following condition is met for a random variable @xmath123 , @xmath124 then we change @xmath125 , before computing @xmath126 . here",
    "we combine the two conditions of @xmath127 and @xmath128 to one condition ( eq .  [ eq : sz ] ) .",
    "the acceptance efficiency is 100% .",
    "we call it the flipping method ( eq .  [ eq : sz ] ) to distinguish it from the rejection method ( eq .  [ eq : factor2 ] ) .",
    "in order to validate the algorithms , we carry out several test problems .",
    "we initialize @xmath129 particles in all cases .",
    "the black squares in figure [ fig : eff ] show the acceptance efficiency of the sobol method , as a function of @xmath7 .",
    "they are in excellent agreement with the expected curve ( eq .",
    "[ eq : eff ] ) .",
    "we then compute relativistic shifted - maxwellian by using the sobol method and the flipping method ( eq .  [ eq : sz ] ) .",
    "we set @xmath130 and we boost the particles by the bulk lorentz factor @xmath131 in the @xmath132 direction . figure [ fig : f ] compares numerical results and analytic distributions in the moving frame @xmath61 , integrated over @xmath133 and @xmath134 .",
    "all distributions are normalized by @xmath135 .",
    "the following analytic solution is obtained by using a cylindrical transformation @xmath136 in equation [ eq : shifted2 ] . @xmath137",
    "the numerical results are in excellent agreement with the analytic solutions .",
    "the stationary maxwellian looks ok . as @xmath138 increases",
    ", the distribution is stretched in the @xmath139 direction . from equation",
    "[ eq : f_ux ] , we see @xmath140 \\approx u'_x\\exp [ -({u'_x}/{2 \\gamma t } ) ] $ ] for @xmath141 . therefore , the slope on the boosted side becomes extremely flat . for @xmath142 ,",
    "the numerical results on the right side ( @xmath143 ) look slightly noisier than on the other side ( @xmath144 ) .",
    "this is probably a unfair comparison , because the right slope has more gridpoints than the left slope in the low - density range . for @xmath145 , the distribution",
    "is highly stretched in @xmath139 . outside the figure , it still remains @xmath146 at @xmath147 .",
    "it will be challenging to initialize such a distribution by a direct rejection method in the @xmath61 frame , because we have to extend the parameter domain @xmath148 times longer in @xmath139 .",
    "this gives us another motivation to initialize particles in @xmath60 and then boost it to the @xmath61 frame .",
    "next , we compute several fluid quantities in the moving frame @xmath61 . after initializing the particles ,",
    "we compute the flow vector @xmath149 and the stress - energy tensor @xmath150 .",
    "then we evaluate the average velocity @xmath151 and the average energy flux @xmath152 .",
    "the former is a direct indicator of the bulk motion , and the latter , the energy flux , plays a decisive role to the system evolution .",
    "the results are presented in table [ table ] .",
    "we change two key parameters , the bulk lorentz factor @xmath153 and the relativistic temperature @xmath154 . in the @xmath155 case",
    ", we use the inverse transform method ( sec . ii a ) , because the efficiency of the sobol method falls to @xmath156 .",
    "we also test the @xmath157 case without the volume transformation .",
    "this incorrect case is denoted by the asterisk sign ( @xmath158 ) . in table",
    "[ table ] , the first rows show the computed results .",
    "the second rows show the relative error to analytic solutions .",
    "as can be seen , the results appear to be accurate , except for the rightmost columns .    without the volume transformation , we see that the average bulk speed is inaccurate in table [ table ] .",
    "this is crucial to initialize a relativistic current sheet @xcite , in which relativistically hot populations carry the electric current .",
    "the energy flux is significantly distorted , too .",
    "the average energy flux without the volume transformation is @xmath159 since @xmath160 for @xmath161 , we lose @xmath162 of the energy flux , regardless of the bulk speed @xmath163",
    ". we can similarly evaluate the average energy density without the volume transformation .",
    "it deviates from the right value by a factor of @xmath164^{-1}$ ] , and therefore the error approaches @xmath162 for @xmath165 and @xmath161 .",
    "the author acknowledges m. oka and a. taktakishvili for their assistance to find out sobol s original article and t. n. kato for his insightful comments on the manuscript .",
    "this work was supported by grant - in - aid for young scientists ( b ) ( grant no .",
    "25871054 ) .",
    "alves , e. p. , grismayer , t. , martins , s. f. , fiza , f. , fonseca , r. a. , and silva , l. o. , `` large - scale magnetic field generation via the kinetic kelvin - helmholtz instability in unmagnetized scenarios , '' , l14 ( 2012 ) .",
    "box , g. e. p. and muller , m. e. , `` a note on the generation of random normal deviates , '' _ annals of mathematical statistics _",
    "* 29 * , 610 ( 1958 ) .",
    "gallant , y. a. , hoshino , m. , langdon , a. b. , arons , j. , and claire , c. e. , `` relativistic , perpendicular shocks in electron - positron plasmas , '' , 73 ( 1992 ) .",
    "harris , e. g. , `` on a plasma sheath separating regions of oppositely directed magnetic field , '' _",
    "nuovo cimento _ * 23 * , 115 ( 1962 ) .",
    "hoh , f. c. , `` stability of sheet pinch , '' _ phys . fluids _ * 9 * , 277 ( 1966 ) .",
    "jttner , f. , `` das maxwellsche gesetz der geschwindigkeitsverteilung in der relativtheorie , '' _ ann .",
    "* 339 * , 856 ( 1911 ) .",
    "kennedy , w. j. , jr . and",
    "gentle , j. e. , _ `` statistical computing , '' _ marcel dekker inc .",
    "landau , l. d. and lifshitz , e. m. , _ `` the classical theory of fields , '' _ oxford , 4th ed ,  6 ,  10 ( 1975 ) .",
    "melzani , m. , winisdoerffer , c. , walder , r. , folini , d. , favre , j. m. , krastanov , s. , and messmer p. , `` apar - t : code , validation , and physical interpretation of particle - in - cell results , '' , a133 ( 2013 ) .",
    "pozdnyakov , l. a. , sobol , i. m. , and sunyaev , r. a. , `` effect of multiple compton scatterings on an x - ray emission spectrum - calculations by the monte carlo method , '' _",
    "soviet astronomy _ * 21 * 708 ( translation ) ( 1977 ) .",
    "pozdnyakov , l. a. , sobol , i. m. , and sunyaev , r. a. , `` comptonization and the shaping of x - ray source spectra - monte carlo calculations , '' _ astrophys .",
    "space phys .",
    "* 2 * , 189 ( translation ) ( 1983 ) .",
    "sobol , i. m. , `` on modeling certain distributions similar to gamma distribution , '' in monte carlo methods in computational mathematics and mathematical physics ( novosibirsk , 1976 ) , pp .",
    "2429 [ in russian ] ( 1976 ) .",
    "swisdak , m. , `` the generation of random variates from a relativistic maxwellian distribution , '' , 062110 ( 2013 ) .",
    "synge , j. l. , _ the relativistic gas _ , new york : interscience ( 1957 ) .",
    "zenitani , s. and hoshino , m. , `` particle acceleration and magnetic dissipation in relativistic current sheet of pair plasmas , '' , 702 ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> numerical algorithms to load relativistic maxwell distributions in particle - in - cell ( pic ) and monte - carlo simulations are presented . for stationary relativistic maxwellian , </S>",
    "<S> the inverse transform method and the sobol algorithm are reviewed . to boost particles to obtain relativistic shifted - maxwellian , </S>",
    "<S> two rejection methods are proposed in a physically transparent manner . </S>",
    "<S> their acceptance efficiencies are @xmath0100can be combined with arbitrary base algorithms . </S>"
  ]
}