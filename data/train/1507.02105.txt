{
  "article_text": [
    "the parallax of an object is its observed angular displacement with respect to a reference frame due to the movement of the observer over a baseline .",
    "stellar parallaxes are measured using twice the earth  sun separation as a baseline . from geometry and the definition of the parallax , @xmath0 ,",
    "the distance of a star from the sun , @xmath1pc , is @xmath2  to a very good approximation .",
    "parallaxes are one of the few distance measures in astronomy which do not make assumptions about the intrinsic properties of the object .",
    "hipparcos blazed the trail when it measured the parallaxes of over @xmath3 stars to an accuracy of around 1mas down to @xmath4 in the 1990s ( perryman et al .",
    "gaia is currently extending this to @xmath5 objects with expected accuracies as good as 0.01mas ( and still much less than a mas at its magnitude limit of @xmath6 ) ( lindegren et al .",
    "2008 ) , and lsst hopes to obtain parallaxes with standard deviations of order 1mas for billions of stars down to much fainter magnitudes ( ivezi et al .",
    "2011 ) .",
    "it is therefore of considerable importance to know how to estimate distances ( and their uncertainties ) from parallaxes . despite",
    "the simple relation between the two , inverting a parallax to give a distance is only appropriate when we have no measurement errors .",
    "as we always have measurement errors , determining the distance given a parallax becomes an inference problem . here",
    "i show that this inference is not trivial when the errors are even still quite small , necessarily involves assumptions , and can lead to surprisingly large errors .",
    "i then set out to solve the following problem : given a measured parallax , @xmath0 , and its uncertainty , @xmath7 , how can we obtain a good estimate of the distance and its uncertainty ?",
    "numerous studies in the astronomical literature have examined estimating physical quantities from parallaxes and possibly additional data ( such as colours ) .",
    "these quantities may be individual distances , absolute magnitudes , distances to clusters , etc .",
    "example studies include lutz & kelker 1973 , smith & eichhorn 1996 , brown et al .",
    "1997 , verbiest et al .",
    "2012 , palmer et al .  2014 .",
    "my objective is not to repeat such analyses , but rather to illustrate the issues involved using what is arguably the simplest of these problems : estimating distance from a single parallax .",
    "more complex problems will need to consider these same issues , even though in many cases we will not want to estimate distances explicitly .",
    "we should instead infer the quantity of interest directly .",
    "if we want to compare model predictions with data ( which is not the topic of this paper ) , then it is usually better to project the predictions ( and their distributions ) into the data space , where the noise ( measurement ) model is better defined , rather than inferring quantities and then trying to determine an appropriate noise model to use in the comparison .",
    "i use @xmath8 to denote parallax ( always in ) and @xmath1 to denote distance ( always in pc ) . where it is necessary to make a distinction",
    ", i use @xmath9 to indicate the true distance , and @xmath10 to indicate an estimate of this , such as the mode @xmath11 , or median , @xmath12 .",
    "i will frequently refer to the _ fractional parallax error _ , the ratio of the ( 1@xmath13 ) parallax uncertainty to the parallax .",
    "this can either be the empirical quantity based only on the measured data , @xmath14 , or a quantity based on the true distance , @xmath15 . in a real application @xmath9 and @xmath16 are of course unknown .",
    "for a star at true distance @xmath1 , its true but unknown parallax is @xmath17 .",
    "the measured parallax , @xmath0 , is a noisy measurement of @xmath17 .",
    "i will assume that @xmath0 is normally distributed with unknown mean @xmath17 and known standard deviation @xmath7 .",
    "that is , i assume @xmath0 has been drawn from the distribution @xmath18 } \\hspace*{1em}{\\rm where}\\hspace*{1em } \\parsd \\geq 0 \\label{eqn : likelihood}\\ ] ] which is gaussian in @xmath0 , but of course not in @xmath1 .",
    "this function is the measurement model , or likelihood .",
    "it gives the probability density function ( pdf )  probability per unit parallax  for any @xmath0 , given values of @xmath1 and @xmath7 .",
    "this is the measurement model used in the hipparcos and gaia data processing .",
    "@xmath7 depends in particular on the centroiding accuracy of each of the individual position measurements which are used in the astrometric solution .",
    "this in turn depends primarily on the number of photons ( @xmath19 ) received from the star ( @xmath20 ) , and thus on its brightness , the observing time per observation , and the number of observations ( assuming the observations have an appropriate cadence to determine a parallax at all ) .",
    "depending on the source brightness , other terms and systematic errors may also be significant .",
    "the two most important points here are ( 1 ) @xmath7 is independent of @xmath0 , and ( 2 ) @xmath7 can be estimated from another measurement model using other measured data ( de bruijne 2012 ) .. but this will generally be a small uncertainty compared to the noise in the parallax , so i do nt consider it here . ]",
    "equation  [ eqn : likelihood ] has a finite probability of giving non - positive parallaxes , and this probability gets larger with increasing @xmath16 .",
    "an astrometric reduction can indeed produce a negative parallax , because the `` measured '' parallax is the result of reducing a set of noisy angular measurements .",
    "it corresponds to the parallactic displacement being in the opposite direction on the sky from that expected due to the movement of the observer along the baseline .",
    "it does _ not _ correspond to a negative distance , because @xmath21 by definition . non - positive parallaxes are perfectly reasonable measurements , and we will see that they can deliver useful distance information",
    ".    strictly speaking the likelihood must be changed at extremely small distances , because then the definition that the ( noise - free ) parallax is the reciprocal of distance breaks down .",
    "but this only occurs for parallaxes on degree scales , whereas all measured stellar parallaxes are less than an arcsecond .",
    "suppose we have a measurement @xmath22 .",
    "one may be tempted to report @xmath2 as the distance estimate , and use a first order taylor expansion to give @xmath23 as the uncertainty .",
    "but we will now see that this quickly becomes a poor approximation .    from the definition of the gaussian , the intervals @xmath24 \\hspace{1em}{\\rm and}\\hspace{1em } 1/r \\,=\\ , [ \\parallax , \\parallax+2\\parsd]\\ ] ] each includes a fraction @xmath25 of the total probability of the distribution @xmath26 .",
    "the transformation from @xmath17 to @xmath1 is monotonic and so preserves the probability .",
    "thus the intervals",
    "@xmath27 \\hspace{1em}{\\rm and}\\hspace{1em } r \\,=\\ , [ 1/(\\parallax+2\\parsd ) , 1/\\parallax]\\ ] ] must each also contain a fraction 0.477 of the total probability over the distance .",
    "but whereas these intervals are equally sized in @xmath17 ( the gaussian is symmetric ) , they are not in @xmath1 . for example , with @xmath28 and @xmath29 , these intervals are @xmath30 $ ] and @xmath31 $ ] respectively .",
    "the uncertainties do not transform symmetrically because of the nonlinear transformation from @xmath17 to @xmath1 .",
    "we see that the first order taylor expansion suggested above is a poor approximation even for relatively small errors ( here @xmath32=@xmath33 ) .",
    "but what if the errors are larger , with @xmath34 ?",
    "the upper distance interval in the example becomes @xmath35 $ ] .",
    "if @xmath32 is even larger , then this interval becomes undefined and we seem to `` lose '' some of the probability .",
    "as the gaussian distribution has infinite support for all values of @xmath0 and @xmath7 , some finite amount of probability in the likelihood function will always correspond to an undefined distance .",
    "the problem here is that we are trying to make a probabilistic statment about @xmath1 using just equation  [ eqn : likelihood ] , yet this is a probability distribution over @xmath0 , not @xmath1 .",
    "the solution is to pose the problem correctly .",
    "given @xmath0 and @xmath7 , we want to infer @xmath1 . as there is noise involved , we know we can not infer @xmath1 exactly , so we want a probability distribution over the possible values of @xmath1 .",
    "that is , we want to find @xmath36 . from bayes theorem ( which follows from the axioms of probability )",
    "this is related to the likelihood by @xmath37 where @xmath38 is the normalization constant @xmath39 which is not a function of @xmath1 .",
    "@xmath40 is the prior , and expresses our knowledge of  or assumptions about  the distance , independent of the parallax we have measured .",
    "@xmath36 is the posterior distribution . by multiplying the likelihood by a prior",
    ", we essentially transform an expression ( the likelihood ) for the probability of the known data ( parallax ) given the unknown parameter ( distance ) to an expression ( the posterior ) for the probability of the parameter given the data .",
    "we see that we can only infer the distance in a probabilistic sense if we adopt a prior .",
    "some people object to this on philosophical grounds ( _ how can science depend on assumptions ? _ ) , others on practical grounds ( _ how can i know the prior if i havent yet measured any distances ? _ ) .",
    "the latter is a valid objection and will be discussed later . yet without a prior , we run into the problems we just saw in the previous section .",
    "a common strategy for dealing with prior discomfort is to adopt a uniform prior over the full range of the parameter , on the grounds that this does not prefer one value over another . in the present context",
    "we should go one step further and use @xmath41 so as to introduce the definition that distances must be positive .",
    "the @xmath42 symbol is used to indicate that the pdf is unnormalized .",
    "the subscript is an abbreviation of the distribution .",
    "because it extends to infinity , this prior can not be normalized .",
    "such priors are referred to as _",
    "improper_. from equation [ eqn : bayes ] , the ( unnormalized ) posterior , @xmath43 , in this case is the likelihood ( equation  [ eqn : likelihood ] ) but now considered as a function of @xmath1 rather than @xmath0 , and subject to the additional constraint that @xmath1 must be positive , i.e.@xmath44    examples of this posterior are shown in figure [ fig : ud.post_runifprior ] for @xmath45 and various values of @xmath32 .",
    "this demonstrates the skewness discussed in section [ sec : intuition ] .",
    "( improper uniform prior ) for @xmath45 and four values of @xmath46 .",
    "the posteriors have been scaled to all have their mode at @xmath47 . as the prior is improper ,",
    "the posterior remains finite out to infinite distance for all values of @xmath48.[fig : ud.post_runifprior],scaledwidth=50.0% ]    inspection of equation [ eqn : likelihood ] shows that @xmath49 the posterior does not converge , has an infinite area and so can not be normalized . consequently it has no mean , no standard deviation , no median , and no quantiles .",
    "the only plausible estimator of the distance is the mode . ] , which we see from figure  [ fig :",
    "ud.post_runifprior ] is well defined for all values of @xmath32 , and is equal to @xmath2 for @xmath50 .",
    "for non - positive parallaxes the posterior increases monotonically from 0 at @xmath51 to a finite asymptote ( equation [ eqn : likelihood ] ) putting the mode at @xmath52 , which is physically implausible in a finite universe .",
    "this is bad , as negative parallaxes are valid measurements .",
    "we should also be concerned that this estimator ignores the parallax uncertainty , even though we have seen that its magnitude determines the skewness of the distance distribution ( section [ sec : intuition ] ) .",
    "an uncertainty could be derived from the full width at half maximum ( fwhm ) ( or similar ) , but without a normalizable posterior there is no useful probabilistic interpretation of this .",
    "the above mentioned problems notwithstanding , we can still ask how good the mode of this posterior is as an estimator . recall that the posterior is a function of the _ measured _ parallax , which due to noise is not equal to the true parallax , so @xmath2 is not equal to the true distance .",
    "thus to assess the quality of any estimator we need to test it using noisy simulated data .",
    "in particular , we would like to see how its accuracy varies as a function of the expected fractional parallax error .",
    "i do this with the following empirical test procedure :    assign a fractional parallax error , @xmath16    assign a true distance , @xmath9 ( which together with @xmath16 determines @xmath7 ) [ listitem : assign_distance ]    simulate a parallax measurement , @xmath0 , by drawing a value at random from the likelihood with @xmath53[listitem : draw_parallax ]    use @xmath0 in the posterior to evaluate the distance estimator , @xmath10    calculate the _ scaled residual _",
    ", @xmath54    repeat steps 25 numerous times to compile a set of values @xmath55 at a single value of @xmath16    calculate the bias , @xmath56 , and sample standard deviation , @xmath57    repeat steps 17 for different values of @xmath16 .",
    "the bias and standard deviation are standard tests of the quality of an estimator .",
    "a good estimator will have small values of both , where `` small '' is , of course , a relative term . by using the scaled residuals ( rather than just the residuals )",
    "i can collate information on many different true distances into a single value of @xmath58 and @xmath59 for a given @xmath16 . in the first test",
    "i assign true distances in step [ listitem : assign_distance ] by drawing at random from the distribution @xmath60 which corresponds to stars being uniformly distributed in three - dimensional space , @xmath61=const .",
    ", of finding a star in a shell with inner and outer radii @xmath62 is proportional to the volume of that shell , @xmath63 .",
    "@xmath64 , so @xmath65 .",
    "] i use @xmath66 . for each value of @xmath16",
    "i sample @xmath67 true distances .",
    "i do this for 100 values of @xmath16 ranging from 0.01 to 1.0 in steps of 0.01 .",
    "the estimator in this case is the mode , which is just @xmath2 .",
    "if the parallax is non - positive ( in step [ listitem : draw_parallax ] ) , then for the improper uniform prior i throw away the sample , because an infinite distance would give an infinite bias and standard deviation ( telling us straight away that it is a bad estimator ! ) .",
    "the procedure for other priors i will discuss as we encounter them .     for the mode estimator of the posterior @xmath43 ( equation [ eqn : urunifpost ] , which uses the improper uniform prior ) for data drawn from the constant volume density prior ( equation  [ eqn : r2prior ] ) .",
    "the right panel is a zoom of the left panel .",
    "the red line in the right panel shows the fraction of samples which had to be rejected because they had non - positive parallaxes .",
    "[ fig : scaledresiduals_mode_runifprior_r2trueprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ]   for the mode estimator of the posterior @xmath43 ( equation [ eqn : urunifpost ] , which uses the improper uniform prior ) for data drawn from the constant volume density prior ( equation  [ eqn : r2prior ] ) .",
    "the right panel is a zoom of the left panel .",
    "the red line in the right panel shows the fraction of samples which had to be rejected because they had non - positive parallaxes .",
    "[ fig : scaledresiduals_mode_runifprior_r2trueprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ]    the results are shown in figure [ fig : scaledresiduals_mode_runifprior_r2trueprior_rmax1e3 ] . we see that the standard deviation increases steadily until @xmath68 , then it explodes .",
    "the bias also increases sharply , in this case reaching a value of about 4 at @xmath16=1 .",
    "the reason for this appearance is that as @xmath16 increases , the probability increases that the measured parallax  which is drawn from the likelihood  becomes arbitrarily close to zero , in which case @xmath69 becomes arbitrarily large .",
    "this also explains why both the bias and standard deviation become very noisy for @xmath70 : the exact appearance of the curves depends on the sample drawn in the simulation .. below this value we get a very smooth dependence of bias and standard deviation on @xmath16 . at values of @xmath16 well below this `` explosion ''",
    "we could even use the taylor approximation mentioned in section [ sec : intuition ] to estimate the distance and a ( symmetric ) uncertainty . ]    although noisy , the plot is independent of @xmath71 , because we are calculating functions of the scaled residuals , @xmath72 , for fixed @xmath16 .",
    "doubling @xmath71 would double both @xmath9 and @xmath10 , leaving @xmath72 unchanged .",
    "one might argue that by drawing true distances from a distribution which is very different from the uniform prior adopted in the posterior , we are bound to get poor results .",
    "to some extent this is true . to test this ,",
    "i repeat the above procedure , but drawing from the prior in equation [ eqn : urunifprior ] .",
    "of course , to be able to draw from this i have to set an upper limit ( otherwise all draws will be infinite ) , and i again use @xmath66 ( although the exact value is irrelevant , because the scaled residuals are independent of it ) .",
    "the results are shown in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3 ] .",
    "we see that they are hardly any better than before .",
    "the problem is therefore not prior mismatch , but the fact that @xmath2 ( the mode ) is a very noisy estimator once @xmath70 .",
    "because this posterior is not normalizable , no other estimator is available .    , but now drawing data from the truncated uniform prior.[fig : scaledresiduals_mode_runifprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ] , but now drawing data from the truncated uniform prior.[fig : scaledresiduals_mode_runifprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ]    this example shows that an apparently innocuous approach to inference is in fact highly problematic . it is the kind of thing which may be done by those who reject the bayesian approach to inference on the grounds that it depends on prior assumptions .",
    "they want to rely only on the likelihood , yet have to adopt some kind of prior to get logically consistent answers , and tacitly choose an unbounded uniform prior in @xmath1 in the belief that it is `` uninformative '' .",
    "yet one can equally argue that uniform in @xmath73 ( i.e.  in distance modulus ) is uninformative .",
    "in fact , by adopting a uniform prior in @xmath1 , one assumes that the volume density of stars varies as @xmath74 ( see the discussion around equation [ eqn : r2prior ] ) , which is highly informative .",
    "corresponds to uniform in @xmath17 and so @xmath75 . ]",
    "clearly , this approach is not very robust : it will only give distance estimates for @xmath76 , it can not give self - consistent uncertainty estimates ( only a poor approximation using a taylor expansion ) , and it breaks down entirely with non - positive parallaxes .",
    "can we do better ?",
    "( truncated uniform prior with @xmath66 ) for @xmath45 and four values of @xmath77 ( black lines ) .",
    "the red line shows the posterior for @xmath78 and @xmath79 .",
    "the posteriors have been scaled to all have their mode at at @xmath80 .",
    "right : the same five posterior pfds but now normalized .",
    "[ fig : ud.post_runiftruncprior],title=\"fig:\",scaledwidth=49.0% ]   ( truncated uniform prior with @xmath66 ) for @xmath45 and four values of @xmath77 ( black lines ) .",
    "the red line shows the posterior for @xmath78 and @xmath79 .",
    "the posteriors have been scaled to all have their mode at at @xmath80 .",
    "right : the same five posterior pfds but now normalized .",
    "[ fig : ud.post_runiftruncprior],title=\"fig:\",scaledwidth=49.0% ]    an obvious improvement is to truncate the prior at some value .",
    "this prevents the inferred distance becoming very large , so should reduce the explosion of the bias and standard deviation we saw with the improper prior for larger @xmath16 .",
    "the normalized prior is @xmath81 where @xmath71 is the largest distance we expect for any star in our survey .",
    "the posterior is the same shape as in figure [ fig : ud.post_runifprior ] but set to zero for @xmath82 @xmath83 this is shown in figure [ fig : ud.post_runiftruncprior ] . note the effect of the normalization .",
    "the right panel illustrates how the posterior is a combination of the likelihood and prior . when the data are good ( @xmath16 is small ) , the likelihood is narrow compared to the prior , so the former dominates the posterior .",
    "as the data become less informative ( larger @xmath16 ) , the posterior gets broader and the prior plays more of a role . for non - positive parallaxes the posterior increases",
    "monotonically from 0 at @xmath51 to a maximum at @xmath84 ( the red line shows an example ) .",
    "the mode of the resulting posterior serves as our distance estimator , and is @xmath85 i call a mode solution `` extreme '' if the estimate from the likelihood alone would place it beyond @xmath71 , and so is truncated by the prior to @xmath71 . that non - postitive parallaxes are set to @xmath71 is consistent with the nature of the parallax measurement ( see section [ sec : likelihood ] ) .",
    "i redo the empirical test with data drawn from the uniform prior ( with a common value of @xmath71 ) . to allow a fairer comparison with the results obtained with the improper uniform prior",
    ", i again reject simulated parallax measurements in step [ listitem : draw_parallax ] which are non - positive .",
    "the results are shown in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_truncatemode ] .",
    "they are again independent of @xmath71 .",
    "the bias and standard deviation are significantly reduced .",
    "this is not surprising , because we are now clipping all those large distance estimates to @xmath71 .",
    "the dashed line shows that relatively few objects have their distances clipped in this way  only 10% at @xmath16=0.25 and 20% at @xmath16=1  which in turn shows that the explosion in the bias and standard deviation seen previously was due to a minority of objects .",
    "an alternative to clipping these distances would be to reject them , which means we decide we can not estimate distances .",
    "the results of the empirical test in that case ( for the same data ) are shown in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode ] .",
    "as we would expect , rejecting these cases reduces the bias and standard deviation , but not by much .     for the mode estimator ( equation [ eqn : postut_mode ] ) of the posterior @xmath86 ( equation [ eqn : runifpost ] , which uses the truncated uniform prior ) for data drawn from a truncated uniform prior in @xmath1 .",
    "the right panel is a zoom of the left panel .",
    "the solid red line shows the fraction of samples which were rejected because they had non - positive parallaxes .",
    "the dashed red line shows the fraction of samples with an extreme mode ( @xmath87 ) which was truncated to @xmath71 .",
    "[ fig : scaledresiduals_mode_runifprior_rmax1e3_truncatemode],title=\"fig:\",scaledwidth=49.0% ]   for the mode estimator ( equation [ eqn : postut_mode ] ) of the posterior @xmath86 ( equation [ eqn : runifpost ] , which uses the truncated uniform prior ) for data drawn from a truncated uniform prior in @xmath1 .",
    "the right panel is a zoom of the left panel .",
    "the solid red line shows the fraction of samples which were rejected because they had non - positive parallaxes .",
    "the dashed red line shows the fraction of samples with an extreme mode ( @xmath87 ) which was truncated to @xmath71 .",
    "[ fig : scaledresiduals_mode_runifprior_rmax1e3_truncatemode],title=\"fig:\",scaledwidth=49.0% ]    , but now rejecting all samples which have @xmath87 .",
    "[ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode],title=\"fig:\",scaledwidth=49.0% ] , but now rejecting all samples which have @xmath87 .",
    "[ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode],title=\"fig:\",scaledwidth=49.0% ]    compared to the improper uniform prior at least , the results look quite good . in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode ] , the bias and standard deviation increase approximately linearly for @xmath88 with gradients of 0.10 and 1.1 respectively ; their values are 0.025 and 0.29 respectively at @xmath89",
    ". one might think about correcting the bias ( see section [ sec : biascorrection ] ) , but the need for this will be later obviated by the use of a better prior .",
    "now that the posterior is normalized we could investigate using the mean or median .",
    "but these are strongly influenced by the choice of @xmath71 for large values of @xmath16 , which is just the domain where we want a more robust estimator than the mode .",
    "the results in figures [ fig : scaledresiduals_mode_runifprior_rmax1e3_truncatemode ] and [ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode ] are for the situation when the real data come from the same distribution as the prior .",
    "the shape of this prior aside , individual distance estimates for small parallaxes and/or large values of @xmath16 will be sensitive to the choice of @xmath71 .",
    "astrophysically this corresponds to knowing the maximum distance of any star .",
    "this could be set for each star individually according to its measured apparent magnitude , @xmath90 , and the fact that stellar evolution limits the absolute magnitude , @xmath91 , to about @xmath92mag .",
    "the flux continuity relation then tells us that @xmath93 , where @xmath94 is the interstellar absorption in the observed band .",
    "setting @xmath95 gives us the maximum distance ( although this will be an overestimate for observations at low galactic latitudes ) .",
    "a more stringent upper limit on @xmath91 could be set if the star s colour were known .",
    "truncating the prior has helped , but it still corresponds to assuming that the volume density of stars varies as @xmath74 .",
    "this is not only a strong prior , it is also scale independent , which the galactic stellar distribution most certainly is not .",
    "one could adopt a more complex prior based on a galaxy model .",
    "we may want to do this in practice ( see section [ sec : choice ] ) , but this gives us little insight into the role of the prior .",
    "let us instead take at least an astrophysically reasonable yet less informative prior , namely a constant volume density of stars ( equation [ eqn : r2prior ] ) .",
    "this too is truncated at @xmath84 in order to be normalizable .",
    "the unnormalized posterior is @xmath96 }   & \\:{\\rm if}~~ 0 < r \\leq \\rlim \\\\    0                           & \\:{\\rm otherwise } \\ . \\end{dcases } \\label{eqn : upostr2}\\ ] ] examples of this posterior are shown in figure [ fig : post_r2prior ] for @xmath45 , @xmath66 , and various values of @xmath32 . for low @xmath32 the posterior looks unimodal , but then appears to develop a minimum ( and thus a second mode at @xmath84 ) , until for @xmath97 the lower mode ( and hence the minimum ) disappears , leaving a posterior which increases monotonically from zero up to @xmath71 .",
    "( truncated constant volume density prior with @xmath66 ) for @xmath45 and eight values of @xmath98 .",
    "the posteriors have been scaled to all have their mode at at @xmath99 .",
    "right : the same posterior pdfs but now normalized",
    ". the curves with the clear maxima around @xmath100 are @xmath101 in decreasing order of the height of the maximum.[fig : post_r2prior],title=\"fig:\",scaledwidth=49.0% ]   ( truncated constant volume density prior with @xmath66 ) for @xmath45 and eight values of @xmath98 .",
    "the posteriors have been scaled to all have their mode at at @xmath99 .",
    "right : the same posterior pdfs but now normalized .",
    "the curves with the clear maxima around @xmath100 are @xmath101 in decreasing order of the height of the maximum.[fig : post_r2prior],title=\"fig:\",scaledwidth=49.0% ]    we can find the turning points of the posterior by solving @xmath102 for @xmath1 .",
    "this gives a quadratic equation with solutions @xmath103 the solution with the positive sign is the minmum ( @xmath104 ) and that with the negative sign is the mode ( @xmath11 ) .",
    "they are plotted as a function of @xmath32 in figure [ fig : roots_deriv_d.post_r2prior ] .",
    "there is an additional mode at @xmath84 due to the discontinuous cut - off in the prior .",
    "we see that for @xmath32@xmath105@xmath106 ( = 0.354 ) neither turning point is defined : the posterior transitions from having two modes and a minimum to the single mode at @xmath84 .",
    "thus for larger values of @xmath32 we would need to resort to another estimator ; @xmath71 itself would be consistent .    ) of the posterior @xmath107 ( equation  [ eqn : upostr2 ] , which uses the constant volume density prior ) as a function of @xmath32 .",
    "the two roots are the minimum ( @xmath104 , left ) and the mode ( @xmath11 , right ) .",
    "@xmath0 is the measured parallax .",
    "[ fig : roots_deriv_d.post_r2prior],scaledwidth=98.0% ]    equation [ eqn : r2post_roots ] shows that the mode scales linearly with @xmath2 : the function in the right panel of figure [ fig : roots_deriv_d.post_r2prior ] is the factor which we multiply @xmath2 by to estimate the distance .",
    "it depends on the parallax error ( through @xmath32 ) , but not on @xmath71 .",
    "contrary to expectations ( perhaps ) , the posterior would have a minimum for all ( positive ) values of @xmath108 , but if it occurs at @xmath82 it will not be seen due to the cut off from the prior . in the case",
    "shown @xmath109 , so the minimum will only drop below @xmath71 when @xmath110 . for @xmath32 ( @xmath111 ) with @xmath112 .",
    "the solution is @xmath113 ] the minimum goes to infinity in the limit @xmath114 .",
    "( truncated constant volume density prior with @xmath66 ) for @xmath115 and four values of @xmath116 ( black lines ) .",
    "the red line shows the posterior for @xmath117 for @xmath118 ( @xmath32 is then undefined).[fig : post_r2prior_nonposw],scaledwidth=49.0% ]    the posterior is also defined when @xmath119 , as can be seen by inspection of equation [ eqn : upostr2 ] and shown in figure [ fig : post_r2prior_nonposw ] .",
    "this demonstrates that when we use a prior , negative or zero parallaxes provide information in agreement with our intuition : they are just noisy measurements which happened to end up non - positive .",
    "they imply the distance is likely to be large ( up to the constraint imposed by prior knowledge ) , and the range of probable solutions depends on the size of the parallax error ( a smaller error means more constraint ) .",
    "this intuition is expressed quantitatively by the probabilistic approach .",
    "let us now test this estimator with the same empirical test as used before ( section [ sec : empirical_test ] ) .",
    "i draw the data from the constant volume density prior ( equation [ eqn : r2prior ] ) with the same value of @xmath71 as used in the posterior ( @xmath120 ) .",
    "my distance estimator is the lower mode of the posterior when it is defined , i.e.  @xmath11 in equation [ eqn : r2post_roots ] if @xmath108 and @xmath121 , and @xmath71 otherwise .",
    "note that this decision can be made using only measured data ( it involves @xmath32 , not @xmath16 ) .",
    "if @xmath122  an extreme mode  then i set @xmath123 , because this is what the prior tells us .",
    "thus @xmath124     for the mode estimator ( equation [ eqn : postr2t_mode ] ) of the posterior @xmath107 ( constant volume density prior ; equations [ eqn : upostr2 ] and [ eqn : r2post_roots ] ) for data drawn from the same prior .",
    "the right panel is a zoom of the left panel .",
    "the dashed red line shows the fraction of samples with an extreme mode ( @xmath125 ) .",
    "the dotted red line shows the fraction of samples with an undefined mode ( @xmath126 ) . in both these cases the distance estimates for the samples",
    "are set to @xmath71 .",
    "[ fig : scaledresiduals_mode_r2prior_rmax1e3_truncatemode],title=\"fig:\",scaledwidth=49.0% ]   for the mode estimator ( equation [ eqn : postr2t_mode ] ) of the posterior @xmath107 ( constant volume density prior ; equations [ eqn : upostr2 ] and [ eqn : r2post_roots ] ) for data drawn from the same prior .",
    "the right panel is a zoom of the left panel .",
    "the dashed red line shows the fraction of samples with an extreme mode ( @xmath125 ) .",
    "the dotted red line shows the fraction of samples with an undefined mode ( @xmath126 ) . in both these cases the distance estimates for the samples",
    "are set to @xmath71 .",
    "[ fig : scaledresiduals_mode_r2prior_rmax1e3_truncatemode],title=\"fig:\",scaledwidth=49.0% ]    the results are shown in figure [ fig : scaledresiduals_mode_r2prior_rmax1e3_truncatemode ] .",
    "note that the curve is defined for all positive value of @xmath16 ( the horizontal axis ) , in particular beyond @xmath106 . at any given value of @xmath16",
    "the samples will have a range of values of @xmath32 due to the parallax sampling in step [ listitem : draw_parallax ] of the empirical test .",
    "but these still contribute to the sample for the specific value of @xmath16 .",
    "we see in the figure how the fraction of samples with an undefined mode ( dotted red line ) increases steadily with @xmath16 .",
    "the majority of the samples fall in this category once @xmath127 .",
    "this largely explains why the bias and standard deviation saturate : setting most distances to @xmath71 limits the distance error incurred .",
    "the fraction of samples with an extreme mode ( dashed red line ) initially increases , but then decreases , because for large parallax errors the measured parallax is increasingly likely either to be negative ( which is not considered an extreme mode ) or positive but so small that @xmath128 , in which case the mode is undefined and the sample contributes to the dotted curve instead .    , but now the samples with extreme and undefined modes are rejected rather than set to @xmath71 . [",
    "fig : scaledresiduals_mode_r2prior_rmax1e3_rejectmode],title=\"fig:\",scaledwidth=49.0% ] , but now the samples with extreme and undefined modes are rejected rather than set to @xmath71 .",
    "[ fig : scaledresiduals_mode_r2prior_rmax1e3_rejectmode],title=\"fig:\",scaledwidth=49.0% ]    using this prior and strategy , we get much better results than with the improper uniform prior ( figure [ fig : scaledresiduals_mode_runifprior_rmax1e3 ] ) .",
    "we also achieve a lower standard deviation than with the truncated uniform prior ( figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_truncatemode ] ) for larger values of @xmath16 , but at the price of a much larger bias .",
    "note that these results are for data drawn from the same prior as that used in the posterior . with a mismatched prior we will get different results .    instead of truncating the extreme and undefined mode values to @xmath71",
    ", we could just reject them , as we did with the truncated uniform prior in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode ] .",
    "the results of this are shown in figure [ fig : scaledresiduals_mode_r2prior_rmax1e3_rejectmode ] .",
    "the dotted and dashed lines are the same ( they are statistically the same data ) , but now the standard deviation and especially the bias look quite different . indeed , the bias now turns negative for some values of @xmath16 .",
    "this is because we are rejecting exclusively samples which would otherwise be assigned the largest distance possible .",
    "this also helps to lower the standard deviation .",
    "but once @xmath16 increases nearly to 1 ( 100% expected parallax errors ) , the standard deviation and bias are large again .",
    "even worse , we have had to reject over 95% of the data .",
    "while a constant volume density prior is more desirable from a physical point of view than the prior uniform in @xmath1 , it suffers from the same problem : a discontinuous cut - off in @xmath10 . for lower accuracy parallaxes",
    ", this demands that we either throw away those data or assign a fixed distance , @xmath71 .",
    "both are undesirable .",
    "we would like to have a posterior which yields a distance estimate for any value of @xmath32 and @xmath0 , including non - positive parallaxes .",
    "this can be achieved by replacing the sharp cut - off of the previous priors with something which drops asymptotically to zero as @xmath129 . here",
    "i investigate a prior which produces an exponential decrease in the volume density of stars , @xmath130 , namely @xmath131 where @xmath132 is a length scale .",
    "the unnormalized posterior is @xmath133 }   & \\:{\\rm if}~~ r > 0 \\\\    0                           & \\:{\\rm otherwise } \\ . \\end{dcases } \\label{eqn : upostr2e-2}\\ ] ] examples of this posterior are shown in figure [ fig : ud.post_r2e - rprior ] .",
    "we see a dependence on @xmath32 which is similar to that of the @xmath134 prior for small @xmath1 , but now with a smooth peak at large @xmath1 and a continuous decline beyond . depending on the value of @xmath32 , we may have one or two modes . in this example",
    "there is a single mode for @xmath135 , two modes for @xmath136 , and one mode for @xmath137 .",
    "note that although @xmath138 is a characteristic length scale of the posterior , the mode corresponding to this is at a somewhat larger value of @xmath1 .",
    "( exponentially decreasing volume density prior ; equation  [ eqn : upostr2e-2 ] ) for @xmath139 , @xmath45 and seven values of @xmath140 .",
    "the red line is the posterior for @xmath78 and @xmath79 .",
    "the green curve is the prior .",
    "the right panel is a zoom of the left one and also shows an additional posterior for @xmath141 .",
    "all curves have been scaled to have their highest mode at @xmath142 ( outside the range for some curves in the right panel ) .",
    "[ fig : ud.post_r2e - rprior],title=\"fig:\",scaledwidth=49.0% ]    ( exponentially decreasing volume density prior ; equation  [ eqn : upostr2e-2 ] ) for @xmath139 , @xmath45 and seven values of @xmath140 .",
    "the red line is the posterior for @xmath78 and @xmath79 .",
    "the green curve is the prior .",
    "the right panel is a zoom of the left one and also shows an additional posterior for @xmath141 .",
    "all curves have been scaled to have their highest mode at @xmath142 ( outside the range for some curves in the right panel ) .",
    "[ fig : ud.post_r2e - rprior],title=\"fig:\",scaledwidth=49.0% ]    the larger @xmath32 , the less informative the data , and in the limit @xmath143 the posterior just becomes the prior for any value of the parallax ( positive , zero , or negative ) .",
    "indeed , already at @xmath144 the posterior is almost indistinguishable from the prior ( the green line ) .",
    "the red line in figure [ fig : ud.post_r2e - rprior ] shows the posterior for a negative parallax of @xmath145 with @xmath79 .",
    "if @xmath146 were smaller this posterior would shift to the right .",
    "this makes sense , because a smaller @xmath146 means we are more confident that the true parallax is close to zero . as @xmath146 gets larger the posterior shifts to the left , eventually converging to the prior .    to find the mode we set @xmath147 which gives @xmath148 this is a cubic equation which generally has three complex roots , but fewer solutions here due to the physical limitations on the signs of the variables .",
    "the roots are a function not only of @xmath14 , but also of @xmath138 and @xmath7 . depending on these values ,",
    "the posterior may have three real roots , corresponding to two modes and one minimum , or just one real root , corresponding to a single mode .",
    "inspection of the roots leads to the following strategy for assigning the distance estimator , @xmath11 , from the modes :    if there is one real root , it is a maximum : select this as the mode .",
    "if there are three real roots , there are two maxima :    if @xmath149 , select the smallest root ( value of @xmath1 ) as the mode .",
    "if @xmath150 , select the mode with @xmath21 ( there is only one ) .    the other two possibilities ( zero or two real roots ) do not occur for @xmath151 .",
    ", of the posterior @xmath152 ( which uses the exponentially decreasing volume density prior ; equation  [ eqn : upostr2e-2 ] ) shown as @xmath153 as a function of @xmath16 .",
    "each line is for a different value of the parallax , @xmath0 , and labelled with @xmath154 .",
    "the left panel is for @xmath139 and the right panel for @xmath155 .",
    "note the ( different ) log scales on the vertical axes .",
    "[ fig : roots_mainmode_d.post_r2e - rprior],scaledwidth=98.0% ]    the variation of @xmath11 as a function of @xmath32 for different @xmath0 and @xmath138 is shown in figure [ fig : roots_mainmode_d.post_r2e - rprior ] . and",
    "@xmath0 , the variation of @xmath156 with respect to @xmath16 is independent of @xmath0 .",
    "] let us follow the curve labelled `` @xmath157 '' ( @xmath158 ) in the left panel , which corresponds to the posteriors plotted in figure  [ fig : ud.post_r2e - rprior ] . at small values of @xmath16 ( below 0.30 )",
    ", the posterior has a single mode , and the value of @xmath11 ( for a given @xmath0 ) increases slowly and smoothly with increasing fractional parallax error .",
    "as @xmath16 rises above about 0.30 , a second mode appears , but i continue to use the mode at the lower value of @xmath1 as the distance estimator , because we can think of this one as being dominated by the data : it continues to evolve smoothly from the data - dominated regime ( small @xmath16 ) .",
    "once @xmath16 rises above 0.373 , there is a sudden increase in the value of @xmath11 .",
    "this corresponds to the `` data - dominated '' mode disappearing , leaving only the other,``prior - dominated '' , mode for all larger values of @xmath16 .",
    "if the measured parallax were smaller , say @xmath159 , but @xmath138 the same , then we see from figure [ fig : roots_mainmode_d.post_r2e - rprior ] ( left panel ) that the posterior only ever has one mode for all @xmath16 .",
    "this is because the data and the prior are now indicating distances on a similar order of magnitude . if we instead used a larger @xmath138 for @xmath159 ( right panel , line labelled `` @xmath160 '' ) , the measured parallax is again quite different from the prior , so we again see two modes for smaller @xmath16 , and the transition to a single mode for larger @xmath16 .",
    "we only and always get such transitions when @xmath161 .",
    "whenever we have two modes , it is always the smaller one which is dictated by the data , so we can always make the correct choice of distance estimator .     for the mode distance estimator of the posterior @xmath152 ( exponentially decreasing volume density prior ; equation  [ eqn : upostr2e-2 ] ) with @xmath139 for data drawn from the same prior . the black circles and blue triangles are the bias and standard deviation respectively of the median of the posterior .",
    "the right panel is a zoom of the left panel .",
    "[ fig : scaledresiduals_mode_r2e - rprior_rlen1e3],title=\"fig:\",scaledwidth=49.0% ]   for the mode distance estimator of the posterior @xmath152 ( exponentially decreasing volume density prior ; equation  [ eqn : upostr2e-2 ] ) with @xmath139 for data drawn from the same prior . the black circles and blue triangles are the bias and standard deviation respectively of the median of the posterior .",
    "the right panel is a zoom of the left panel .",
    "[ fig : scaledresiduals_mode_r2e - rprior_rlen1e3],title=\"fig:\",scaledwidth=49.0% ]    to assess the performance of this posterior and estimator , i perform the empirical test drawing data from the same prior ( equation  [ eqn : r2e-2prior ] ) as used in this posterior , both with @xmath139 .",
    "the results are shown in figure [ fig : scaledresiduals_mode_r2e - rprior_rlen1e3 ] .",
    "the variation of the standard deviation is similar to what we have seen before with proper priors , and similar in scale to that obtained with the @xmath134 prior .",
    "the standard deviation increases linearly when @xmath88 with a gradient of 1.0 , slightly better than the @xmath134 prior in figure [ fig : scaledresiduals_mode_runifprior_rmax1e3_rejectmode ] , and now without having to reject any data .",
    "but in the present case we get essentially no bias even for large @xmath32 .",
    "this lack of bias was not seen with the previous priors , even when we had a match between the prior and the distribution of true distances .",
    "the explanation for this is that we are now using a prior which decreases continuously and asymptotically after some distance .",
    "the particular choice of @xmath162 is not important to achieve this .",
    "the problem with using a sharp cut - off in a prior is that a star with a sufficiently large fractional parallax error will , before applying the cut - off , have a significant probability for distances greater than the cut - off distance .",
    "if the mode lies beyond this value , applying the cut - off will cause a `` build up '' of inferred distances at the cut - off , resulting in a strong bias .",
    "this can occur even for stars with very large parallaxes ( small distances ) : not only stars with a true distance near to the cut - off distance are affected .",
    "if the fractional parallax error is large enough , the sharp cut - off will always cause a problem , and increasing the cut - off distance will not help .",
    "this shows that truncating the prior at the largest distance expected based on the observed magnitude will not avoid the bias .",
    "one might argue that truncating the prior at very large distances will have little impact in practice , but with an asymptotically decreasing prior this is even unnecessary , because at @xmath163 there is vanishingly small probability anyway .",
    "returning to figure [ fig : roots_mainmode_d.post_r2e - rprior ] , we may be tempted to conclude that using @xmath164 would be a good idea , because it would give @xmath165 .",
    "but the parallax is a noisy measurement , so @xmath166 .",
    "we are not aiming to get @xmath2 as our estimator ( we saw in earlier sections how bad it is ) .",
    "the empirical test confirms that using @xmath164 in the prior gives poor results .",
    "so far i have only investigated the mode of this posterior .",
    "finding the mode is generally easy , because it involves differentiation and solving a polynomial equation .",
    "but it is not necessarily the best estimator in terms of bias and variance . finding the mean and median ( or any other quantile ) involves integrals ( semi - infinite and finite ) of the form @xmath167 over @xmath1 for @xmath168 ( and @xmath169 for the standard deviation , if we wanted this as an error estimate ) .",
    "these integrals have no simple solution , so we must resort to a numerical approach .",
    "where possible i use adaptive quadrature techniques .",
    "for some combinations of parameters this approach can find no solution , in which case i use the metropolis algorithm .",
    "samples and a short burn - in .",
    "a longer chain would reduce the noise , but takes longer to compute .",
    "] this is slow compared to adaptive quadrature , so i have only computed the bias and standard deviation of the median at a few values of @xmath16 .",
    "these are plotted in figure [ fig : scaledresiduals_mode_r2e - rprior_rlen1e3 ] as black circles and blue triangles ( respectively ) .",
    "the median has a significant bias for larger @xmath16 .",
    "the mean has a similar profile , but with slightly larger values of both bias and standard deviation .",
    "so of all the obvious estimators , the mode appears to be the best .    , but now drawing data from the @xmath134 prior with @xmath66 ( and the left panel now has a different vertical scale ) .",
    "[ fig : scaledresiduals_mode_r2e - rprior_rlen1e3_r2trueprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ] , but now drawing data from the @xmath134 prior with @xmath66 ( and the left panel now has a different vertical scale ) . [",
    "fig : scaledresiduals_mode_r2e - rprior_rlen1e3_r2trueprior_rmax1e3],title=\"fig:\",scaledwidth=49.0% ]    what happens if we have a mismatch between the distribution the data are drawn from , and the prior assumed in the model ?",
    "figure [ fig : scaledresiduals_mode_r2e - rprior_rlen1e3_r2trueprior_rmax1e3 ] shows an example of this , where data are drawn from the truncated constant volume density prior ( @xmath65 ) with @xmath66 . as the posterior extends to considerably larger distances than the maximum _ true _ distance of any star in the sample , we inevitably overestimate distances when @xmath16 is large : the estimation of course only sees the noisy measured parallax , which for large @xmath16 has a high probability of being much smaller than @xmath170 .",
    "if we repeat this experiment but now drawing data from a prior which extends to larger distances , e.g.  @xmath171 , then the posterior estimator will tend to underestimate distances .",
    "there is not much more you can do about this other than to try to construct a well - matched prior _ and _ to report confidence intervals on your distance estimates by calculating quantiles on the posterior : i suggest 5% and 95% .",
    "this interval will be large for large @xmath32 ( see the left panel of figure [ fig : ud.post_r2e - rprior ] ) , but large fractional parallax errors necessarily mean that our distance estimates are poor and that we are dependent on the prior . yet",
    "this is arguably preferable to throwing away data once @xmath32 rises above some arbitrary value .",
    "while this prior overcomes many of the problems we saw with other priors , i am not suggesting that we _",
    "always _ use it .",
    "the point of the examples in the previous few sections was to show that the choice of prior ( and estimator ) can have a significant impact on the inferred distances , and that some of the obvious choices may be poor .",
    "one should always think about what is an appropriate prior , given the available information .",
    "this is discussed further in section [ sec : choice ] .",
    "the main application of the exponentially decreasing volume density prior will be when we have very little information other than the parallax , and/or want to make minimal assumptions .",
    "some of the literature on astrometry has been concerned with trying to apply bias corrections to using @xmath2 as a distance estimator ( e.g.  lutz & kelker 1973 , smith 2003 , francis 2013 ) .",
    "unfortunately , many of these corrections are only valid under very restricted circumstances , only apply to small ( @xmath172 ) fractional parallax errors , or are even wrong ( brown et al .",
    "1997 , brown 2012 ) .",
    "furthermore , we have just seen that there are priors which give unbiased estimates , so do we need to ever make bias corrections ? if there is a mismatch between the prior and the true distribution the stars are drawn from , then we might . but",
    "this requires that we know what the mismatch is , in which case we could improve the prior .",
    "it seems far better to always improve the prior than to make ad hoc corrections .",
    "suppose we did have a desirable estimator which is possibly biased ( e.g.  one which gives a lower standard deviation than an unbiased estimator ) .",
    "is there a useful correction which could be applied which does not simultaneously increase the standard deviation by too much ? this is an issue , because any bias correction is itself a function of measured and therefore noisy data .",
    "the bias and standard deviation plots i have shown , plotted against @xmath16 ( @xmath173 ) , show the bias and standard deviation we expect to obtain on average as a function of the expected fractional parallax accuracy .",
    "they are useful to predict the quality of an estimator .",
    "but they can not be used to calculate a bias correction , because they depend on an unknown quantity .",
    "we would instead have to plot the bias against @xmath32 ( @xmath174 )",
    ". this could be done , but it is questionable whether the use of a suitable prior will ever bring up the need to make a bias correction .",
    "there are many more priors and posterior - based estimators one could think of .",
    "a good prior is one which is as closely matched to the expected data as possible . in practice",
    "it should contain all the relevant information we have which is independent of individual measurements .",
    "this could be a combination of both the expected intrinsic distribution of stars in the galaxy , how they enter the sample ( as influenced by the choice of observational wavelength and interstellar extinction ) , and how they are selected by the survey ( e.g.  the survey detection efficiency and magnitude limit )",
    ". this could be quite complex , and will generally vary with the direction of observation through the galaxy .",
    "the exponentially decreasing volume density prior ( section [ sec : expdec ] ) may be suitable when looking well out of the disk , where for a sufficiently deep survey the decrease in stellar density is caused mostly by the galaxy itself rather than the survey .",
    "there are of course many variations on the theme of this prior .",
    "for example , we could produce a sharper decrease with increasing @xmath1 by using @xmath175 for @xmath176 .",
    "but with @xmath177 replaced by @xmath178 . ]",
    "although stellar physics implies a maximum distance for any star , we have seen that discontinuities in the prior have the unpleasant property of leading to rejection of data or the cumulation of all poor data at the same maximum distance . for smooth priors ,",
    "arbitrarily large distances receive asymptotically small probabilities , so are preferred .",
    "if the survey includes extragalactic objects , one will want to allow for very large ( but not infinite ) distances .",
    "this could be achieved using a two component prior ( one for galactic , one for extragalactic objects ) with two modes .",
    "when the posterior has two modes , one should generally report both , but may choose only to report one if it is significantly higher than the other .",
    "setting an informative prior which is wrong could be disastrous . when faced with a choice ,",
    "i recommend using the simplest prior possible consistent with the constraints , as its influence on the results will be easier to interpret . as with all cases of data analysis and interpretation",
    " whether bayesian or not",
    " results will depend on personal choices .",
    "a good approach is to test the sensitivity of the results to the use of different but equally acceptable priors .",
    "the poor quality data ( high @xmath32 ) are more affected by the choice of prior , and these will anyway have broader posteriors . thus it is imperative that confidence intervals are reported on every distance estimate .",
    "i suggest to use 5% and 95% quantiles to define a 90% confidence interval .",
    "the standard deviation , @xmath13 , should not be used , because @xmath1 is strictly positive . quoting @xmath179 implies a gaussian and negative distances .",
    "given a posterior , one is still left with the choice of estimator .",
    "for the priors i have tested , the mode ( taking care to deal with multimodality as described ) is more accurate ( lower bias and variance ) and faster to calculate ( no numerical integration ) than the mean or median .",
    ") for gaia , calculated using the gums catalogue with the post - launch , sky - averaged , 5-year mission astrometric accuracy model .",
    "the red line is the measured fractional parallax error ( i.e.  @xmath32 ) for the hipparcos catalogue .",
    "[ fig : gums_hipparcos_cumf],title=\"fig:\",scaledwidth=49.0% ] ) for gaia , calculated using the gums catalogue with the post - launch , sky - averaged , 5-year mission astrometric accuracy model .",
    "the red line is the measured fractional parallax error ( i.e.  @xmath32 ) for the hipparcos catalogue .",
    "[ fig : gums_hipparcos_cumf],title=\"fig:\",scaledwidth=49.0% ]    we have seen that when the fractional parallax errors are larger than about 20% , use of a prior is imperative in order to make reasonable distance estimates at all and to assign confidence limits . simply rejecting data with larger errors",
    "is in the best case a waste of hard - earned survey data , and in the worst case can severely bias analyses , because we will tend to reject fainter and/or more distant stars . while the accuracy of the ongoing gaia survey will surpass all previous surveys in parallax accuracy on a large number of stars ( accuracy of order 0.02mas at @xmath180 magnitude ) , it remains that many of the stars in the gaia catalogue will have large fractional parallax errors . using a published simulation of what gaia",
    "is expected to observe ( robin et al .",
    "2012 ) together with the first post - launch estimates of gaia s end - of - mission , sky - averaged parallax accuracy ( de bruijne et al .",
    "2015 ) , i have calculated the fraction of stars with expected fractional parallax errors ( @xmath16 ) less than some amount : see the black line in figure [ fig : gums_hipparcos_cumf ] . only about 20% of the gaia catalogue will have @xmath181 .",
    "this leaves at least 800 million stars requiring use of sensible prior information if we are to obtain a meaningful and not totally deviant distance estimate from the astrometry .",
    "the situation is better with the hipparcos catalogue ( red line figure [ fig : gums_hipparcos_cumf ] ) , yet even here only about 40% of the stars have @xmath182 .",
    "for this reason , we should make use of astrophysical parameters which will be estimated from the gaia spectrophotometry and spectroscopy ( bailer - jones et al .  2013 ) to improve our distance estimates .",
    "specifically , the interstellar extinction and absolute magnitude , combined with our knowledge of stellar astrophysics embodied in the hertzsprung ",
    "russell diagram , give an independent , probabilistic determination of the distance .",
    "this posterior pdf can be combined with the astrometric - based posterior pdf to yield a distance estimate which is more accurate than either estimate alone .",
    "i have shown that estimating the distance given a parallax is not trivial .",
    "the naive approach of reporting @xmath183 fails for non - positive parallaxes , is extremely noisy for fractional parallax errors larger than about 20% , and gives an incorrect ( symmetric ) error estimate .",
    "probability - based inference for the general case is unavoidable .",
    "adopting an `` uninformative '' improper uniform prior over all positive @xmath1 does not solve any of these problems , and is in fact both informative and implausible ( viz .  a volume density of stars varying as @xmath184 ) .",
    "the problems can be avoided by using a properly normalized prior which necessarily decreases after some distance .",
    "the use of a prior with a sharp cut - off is not recommended , because it introduces significant biases for low accuracy measurements at all distances ( not just those near the cut - off ) .",
    "instead , a prior which converges asymptotically to zero as distance goes to infinity should be used .",
    "perhaps the simplest case is @xmath185 , which corresponds to an exponentially decreasing volume density with a length scale @xmath138 .",
    "it is relatively neutral in that it is broad , decreases slowly , and has only one parameter .",
    "the mode of the corresponding posterior is an unbiased estimator ( for the case that the population observed conforms to the prior ) and it provides meaningful estimates for arbitrarily large parallax errors as well as non - positive parallaxes .",
    "bias corrections are not necessary .",
    "the variance of this estimator behaves as well as one could expect given the irreducible measurement errors . the median and mean perform less well than the mode .",
    "distance estimates must be accompanied by uncertainty estimates . for fractional parallax errors larger than about 20% ,",
    "the posterior over distance is significantly asymmetric , so we should always report confidence intervals using quantiles ( e.g.  5% and 95% ) rather than standard deviations .",
    "the performance of any distance estimator depends , of course , on how well the prior is matched to the true distribution of distances .",
    "one must consider how much one is willing to tune the prior to previous knowledge of the galaxy . in any case , priors with discontinuities should be avoided , and the sensitivity of results to the adopted priors should always be tested and reported . limiting inference to objects with fractional parallax errors",
    "much better than 20% significantly diminishes the dependence of results on the choice of prior . but this would limit one to using only 20% of the gaia catalogue , which may introduce truncation biases into subsequent astrophysical analyses .    its appealing properties notwithstanding , i am not advocating exclusive use of the exponentially decreasing volume density prior .",
    "my main message is rather that one should think carefully about what is an appropriate prior , given the available information , and what impact this has on the results .",
    "i would like to thank morgan fouesneau , hans - walter rix , anthony brown , and jan rybizki , as well as two anonymous referees , for useful discussions and comments .",
    "this work was supported in part by the sfb 881 project `` the milky way system '' of the german research foundation ( dfg ) .",
    "bailer - jones c.a.l . , andrae r. , arcay b. et al . , 2013 , _ the gaia astrophysical parameters inference system ( apsis ) .",
    "pre - launch description _ , a&a 559 , a74    brown a.g.a , 1997 , arenou f. , van leeuwen f. , lindegren l. , luri x. , 1997 , _ considerations in making full use of the hipparcos catalogue _ , proceedings of the esa symposium ` hipparcos - venice ' 97 , esa sp-402 ( july 1997 ) , pp .",
    "6368              lindegren l. , babusiaux c. , bailer - jones c. a. l. , et al .",
    "2008 , _ the gaia mission : science , organization and present status _ , in iau symposium vol .",
    "248 , ed .",
    "jin , i.  platais , & m. a. c. perryman , 217-223"
  ],
  "abstract_text": [
    "<S> astrometric surveys such as gaia and lsst will measure parallaxes for hundreds of millions of stars . yet they will not measure a single distance . rather , a distance must be estimated from a parallax . in this didactic article , </S>",
    "<S> i show that doing this is not trivial once the fractional parallax error is larger than about 20% , which will be the case for about 80% of stars in the gaia catalogue . estimating distances is an inference problem in which the use of prior assumptions is unavoidable . </S>",
    "<S> i investigate the properties and performance of various priors and examine their implications . a supposed uninformative uniform prior in distance </S>",
    "<S> is shown to give very poor distance estimates ( large bias and variance ) . </S>",
    "<S> any prior with a sharp cut - off at some distance has similar problems . </S>",
    "<S> the choice of prior depends on the information one has available  and is willing to use  concerning , for example , the survey and the galaxy . </S>",
    "<S> i demonstrate that a simple prior which decreases asymptotically to zero at infinite distance has good performance , accommodates non - positive parallaxes , and does not require a bias correction . </S>"
  ]
}