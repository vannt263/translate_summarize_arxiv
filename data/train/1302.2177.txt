{
  "article_text": [
    "a quantum memory is said to be activated when we configure the mems to allow the optical pumping light to reach the waveguide during the preparation stage and thus tailor an afc in the inhomogeneously broadend absorption spectrum of thulium ions ( see fig .",
    "[ fig : experimentalsetup ] ) .",
    "if the optical pumping is blocked , the memory is said to be deactivated and light entering the waveguide merely experiences constant attenuation over its entire spectrum .",
    "if a memory is activated , an incident photon is mapped onto a collective excitation of thulium ions in the prepared afc and subsequently re - emitted at a time given by the inverse of the comb tooth spacing @xcite , i.e. , @xmath39 ( see fig .  [",
    "fig : experimentalsetup ] ) . in all cases , we adjust the mean photon number at the memory inputs so that mean photon numbers are equal at the hom - bs inputs .",
    "this is required for achieving maximum visibility with attenuated laser pulses ( further details later in supplementary information ) .",
    "the two ti : tm : linbo@xmath0 waveguides are fabricated identically but differ in terms of overall length , yielding optical depths of 2.5 for memory @xmath6 and 3.2 for memory @xmath7 . as shown in figure 1 , memory @xmath6",
    "is placed at the centre of a solenoid in a uniform magnetic field , while memory @xmath7 is placed outside the solenoid and thus experiences only a much weaker stray field .",
    "therefore it is not possible to achieve the optimal efficiency for both memories at the same time ( further details later in supplementary information ) .      *",
    "a ) * the polarization degree is easily adjusted using the free - space half- and quarter - wave plate set at each hom - bs input . for our measurements",
    "we rotate the half - wave plate in steps of either 45 or 7.5 degrees . *",
    "b ) * the temporal separation @xmath40 between a pulse arriving at one of the hom - bs inputs and the next pulse in the train arriving at the other input can be expressed as @xmath41 , where @xmath42 is the refractive index of the fibres , @xmath43  km is the path - length difference for pulses interacting with memory @xmath6 and @xmath7 , and @xmath44 is the repetition period of the pulse train from the aom , which is set in the range of 350 - 400  ns . as we can change @xmath44 with 10  ps precision , we can tune @xmath40 on the ns scale .",
    "* c ) * for the storage time scan , the recall efficiency decreases with storage time due to decoherence .",
    "hence , we balance the mean photon number per pulse for stored and transmitted pulses for each storage time . *",
    "d ) * finally , to change the spectral overlap of the pulses input to the hom - bs we can utilize that these pulses were generated at different times in the aom and thus we can chose their carrier frequencies independently .",
    "we interchangeably drive the aom by frequencies @xmath45 and @xmath46 and thus create two interlaced trains of pulses with different frequencies . adjusting the pulse timing",
    "we can ensure that the pulses overlapped at the hom - bs belong to different trains and thus have a spectral overlap given by @xmath47 . due to the limited bandwidth of the aom",
    "we are only able to scan @xmath48 by 100  mhz , which , when compared to the 50  mhz pulse bandwidth , is not quite sufficient to make the pulses completely distinguishable . to achieve complete distinguishability , we supplement with a measurement using orthogonal polarizations at the inputs ( further details later in supplementary information ) .      for the bell - state projection measurement",
    "we interchangeably prepare the time - bin qubits in either @xmath15 or @xmath16 , or in @xmath17 and @xmath18 by setting the relative phase and intensity of the aom drive signal . adjusting the timing of the pulse preparation",
    "we ensure that qubits in different states overlap at the hom - bs .              in the experimental configuration in which the hom - interference occurs between two pulses recalled from separate quantum memories we pointed , in the main text , to the different properties of the two memory devices . in this section",
    "we wish to elaborate on the differences between the two memories based on their physical dissimilarity and measured optical depth as a function of frequency .",
    "memory waveguide @xmath6 is 10.4  mm long and crystal @xmath7 is 15.4  mm long .",
    "the optical depths at 795.43  nm are around 2.5 and 3.2 for waveguide @xmath6 and @xmath7 , respectively , as shown by the light - grey curves in fig .",
    "[ fig : afc - od ]  a , b , corresponding to the case in which the memories are not activated .    in order to spectrally",
    "tailor an afc in tm : linbo@xmath0 , a magnetic field must be applied along the crystal s c - axis so as to split the ground and excited level multiplets into their two nuclear zeeman sublevels @xcite .",
    "however , as one crystal is located at the centre of the setup s solenoid and the other outside the solenoid ( see fig .  [ fig : experimentalsetup ] ) it is not possible to apply the same b - field at the two crystals .",
    "thus when we activate both memories we generally apply a magnetic field , which provides a reasonable balance in recall efficiencies but is not optimal for either memory .",
    "this circumstance is reflected by the different shapes of optical - depth profiles of the afcs shown in red in fig .",
    "[ fig : afc - od]a , b .      in all our demonstrations of the hom interference",
    "we consistently observe that the hom visibility is close to the theoretical maximum for coherent states .",
    "yet , it is important to realize that an improperly configured afc quantum memory does alter a stored photon s wavefunction , resulting in imperfect hom interference with a non - stored photon .",
    "to support this claim we activate only memory @xmath6 , whose performance we change by varying the bandwidth of the afc , and interfere the recalled pulses with pulses directly transmitted through the deactivated memory @xmath7 . as the afc bandwidth decreases below that of the probe pulses , the afc effectively acts as a bandpass filter for the stored photons and we thus expect the recalled pulses to be temporally broadened w.r.t . the original pulse",
    "this is observed in the insert of fig .",
    "[ fig : coin-1qm - bwscan ] , which shows smoothed histograms of photon detection events as a function time .",
    "it is worth noting that the small bandwidth afc also acts as a bandpass filter for the transmitted pulse by virtue of the different effective optical depths inside and outside the afc .",
    "thus the broadened transmitted pulse starts to overlap with the echo for the narrow afc bandwidth traces , as is also observed in the insert of fig .",
    "[ fig : coin-1qm - bwscan ] .",
    "another consequence of reducing the afc bandwidth is that the overall efficiency of the quantum memory decreases , which causes an imbalance between the mean photon numbers at the hom - bs inputs and thus reduces hom interference visibility .",
    "we circumvent the change to the echo efficiency by adapting the mean photon number at the memory input so as to keep the mean photon number of the recalled pulse constant . with this remedial procedure ,",
    "we assess the hom visibility by changing the hom - bs inputs from parallel to orthogonal polarizations for a series of different afc bandwidths . the hom visibility in fig .",
    "[ fig : coin-1qm - bwscan ] is steady for bandwidths from around 100  mhz and up .",
    "however , below 100  mhz the visibility begins to drop significantly .",
    "the dashed line is a fit of the visibilities to a gaussian function with full - width at half - maximum ( fwhm ) of @xmath49 .",
    "note , that the reason for the visibility being limited to around 40% is solely that , for this measurement , we do not go through the usual careful optimization steps .    with these measurements",
    "we have illustrated how a quantum memory could alter the photonic wavefunction resulting in a reduced hom interference visibility .",
    "a combination of spectral and temporal distortion of the photonic wavefunction is indeed a common type of perturbation by quantum memories .",
    "@xcite it is particularly worth noting that the gradient - echo memory ( gem ) quantum memory protocol , though similar to the afc protocol , imparts a frequency chirp to the recalled pulse @xcite . if not corrected , this feature constitutes a perturbation of the wavefunction of the recalled pulse , which may render it unsuitable for applications relying on two - photon interference .",
    "[ [ analytical - model - of - second - order - interference - in - coincidence - measurements . ] ] analytical model of second - order interference in coincidence measurements .",
    "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    in the following theoretical treatment we will derive expressions for the coincidence and single - detector counts in terms of probabilities . by multiplying these probabilities with the average experimental repetition rate we can easily calculate the predicted experimental count rates . to a large extent",
    "though , we will mainly be interested in relative probabilities or count rates between different settings of the degrees of freedom of pulses .",
    "it is reasonably straightforward to derive the rates of detection of photons at the outputs of a bs ( note that in this supplementary information , the hom - bs of the main text will be referred to as just bs ) in our case coherent states @xmath50 and @xmath51 , characterized by mean photon numbers @xmath52 and @xmath53 , occupy the two spatial input modes of the bs . in the fock - basis",
    "the coherent state can be represented as @xmath54 and similarly for @xmath51 .    to account for the cases of photons being distinguishable and indistinguishable at the bs",
    "we must allow for an additional degree of freedom in each of the spatial modes , e.g. polarization , frequency , or time .",
    "thus we write the input state at one of the bs inputs as @xmath55 , where @xmath56 and @xmath57 are the coherent state amplitudes in the two orthogonal modes of the auxiliary degree of freedom within the same spatial mode .",
    "we treat the coherent state at the other bs input in a similar way .",
    "for the case in which the fields at the inputs of the bs are distinguishable with respect to the auxiliary degree of freedom , the inputs to the bs are described as being in the state @xmath58 , whereas in the case of them being indistinguishable ( up to a difference in the mean photon number ) the input fields are written as @xmath59 .",
    "the bs is characterized by its reflection amplitude @xmath60 and transmission amplitude @xmath61 , which cause the input creation operators to transform as @xmath62 and @xmath63 . with this in hand",
    ", we can compute the state in the bs outputs for any combination of fock states at the inputs .",
    "when the two input states are indistinguishable , i.e. in the same auxiliary degree of freedom , we get @xcite        the above calculated output modes impinge on the single photon detectors ( spds ) .",
    "these may be characterized by the probability of detecting an incident single photon . from this single photon detection probability @xmath67",
    "it is also possible to deduce the probability of detecting a pulse consisting of multiple photons , keeping in mind that , irrespective of the number of photons , only a single detection event can be generated .",
    "we write @xmath68 for the probability for generating one detector event given @xmath42 incident photons , and it is useful to note that it relates to the probability @xmath69 of detecting nothing as @xmath70 .",
    "the probability for not detecting @xmath42 photons is , on the other hand , easily computed as @xmath71 .",
    "since the two detectors at the bs outputs are independent , the probability @xmath72 of generating a coincidence event , i.e. having simultaneous detection events in each of the detectors , given @xmath42 and @xmath73 photons in one and the other output is simply @xmath74 .",
    "thus the probability for a coincidence detection becomes @xmath75 \\left[1-(1-\\eta_2)^m \\right ] \\",
    ", , \\end{aligned}\\ ] ] where @xmath76 and @xmath77 are the single photon detection probabilities for detector 1 and 2 , respectively .",
    "expressing the coincidence detection probability in terms of fock states at the bs input we have      where @xmath79 should be substituted with the factor from eq .",
    "( [ eq : fockbsoutind ] ) . for distinguishable inputs",
    "we find a similar expression for @xmath80 using the factor @xmath81 from eq .",
    "( [ eq : fockbsoutdis ] ) .",
    "it is assumed that the detector at a given spatial output mode is equally sensitive to photons in both auxiliary modes , i.e. it detects the states @xmath82 and @xmath83 with equal probability .",
    "we are now in the position to formulate an expression for the different detection probabilities given a particular set of coherent input fields .",
    "the probability to generate a detection event in both detectors , given coherent input fields of amplitudes @xmath84 and @xmath85 , is @xmath86 ( note that to distinguish the probability in eq .",
    "( [ eq : nmphotbsoutdetprobcoin ] ) , which is applicable to fock states , from that ineq .",
    "( [ eq : cohphotbsoutdetprobcoin ] ) , which applies to coherent state inputs , we use @xmath87 to denote the former and @xmath88 for the latter . )",
    "this allows us to derive the visibility of the hom interference on the two detectors as @xmath89 where we have spelled out the parameters that affect the value of the visibility . the quantity @xmath90 is referred to as the _ hom visibility_.          to gain some intuitive understanding of the way the hom visibility is affected by the experimental parameters we resort to a couple of approximations .",
    "firstly , we assume equal mean photon numbers at the inputs of the beam - splitter , @xmath91 , the bs ratio to be 50:50 ( i.e. @xmath92 ) , and the detectors to have equal single photon detection probability @xmath93 . secondly ,",
    "since we normally work at very low mean photon numbers @xmath94 only the first couple of terms of eq .",
    "( [ eq : cohfockparam ] ) need to be included . specifically , we taylor expand @xmath95 and keep only terms in the sum up to 2@xmath96 order in @xmath97 .",
    "thus , for the coincidence detection events we get the probabilities @xmath98 which results in a hom visibility of @xmath99 a key point is that the hom visibility of @xmath100 is independent of the mean photon number @xmath97 .",
    "this observation can be explained by noting that in this low order treatment the coincidences in the case of indistinguishable input modes stem mostly from events in which two photons are present at the same input , which occurs with probability @xmath101 .",
    "for distinguishable input modes the coincidences stem from all events that contain two photons at the input , i.e. @xmath102 . since , according to eq .",
    "( [ eq : cohfockparam ] ) , for coherent input states , all of these probabilities scale in the same way with the mean photon number , their ratio , and thus the visibility of eq .",
    "( [ eq : cohphotcoinvis ] ) , is constant for all mean photon numbers .",
    "[ [ compilation - of - experimental - results - for - hom - interference - at - the - few - photon - level . ] ] compilation of experimental results for hom interference at the few - photon level . ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    here",
    "we show the plots of coincidence count rates on which the few - photon values in table  [ tab : visresults ] of the main text are based .",
    "we restate that coincidence count rates are proportional to coincidence probabilities by a factor that is given by the average experimental repetition rate .",
    "moreover , when calculating the hom visibility , only the relative probabilities or count rates in a measurement are important . in the experiments we change the mutual polarization , time separation , or frequency difference of the pulses at the bs ( in the main text referred to as hom - bs ) input as explained in the earlier in the supplementary information .",
    "+ we present the data in order of the number of activated memories starting with none , i.e. pulses merely pass through attenuated to the bs . in fig .  [",
    "fig : coin-0qm]a ) we show the coincidence counts as we vary the polarization difference of the pulses at the two inputs of the bs .",
    "fitting the data to a sine function we obtain a visibility of @xmath103% . in fig .",
    "[ fig : coin-0qm]b ) we display the coincidence counts as we step the temporal separation of the pulses at the two inputs of the bs .",
    "the count rates for these measurements are generally higher than all the other count rates presented .",
    "this is because this data was acquired by looking at coincidences between the transmitted part of the probe pulses in the configuration of two active quantum memories ( shown in fig .",
    "[ fig : coin-2qm]b ) ) .",
    "hence , the balancing of the mean photon number in the transmitted pulses done less meticulously , which is the most likely reason for the observed lower visibility of @xmath104% in this case .            fig .",
    "[ fig : coin-0qm]c ) shows the coincidence count rates as function of the frequency difference of the two pulses at the bs inputs . the horizontal line and surrounding shaded band shown in fig .  [ fig : coin-0qm]c )  as well as in fig .  [ fig : coin-1qm]c ) ",
    "give the coincidence counts for completely distinguishable input photons as obtained by making the polarizations orthogonal .",
    "as noted earlier in the supplementary information , it is necessary to resort to the polarization degree of freedom in order to make the pulses completely distinguishable .",
    "the visibility from the fit is noticeably lower than that obtained when we change the other degrees of freedom .",
    "there are two main reasons for this .",
    "the first is that , in order to generate pulses with different frequencies , we drive the aom at the limits of its bandwidth .",
    "this , in turn , necessitates setting the rf drive signal amplitude high whereby the frequency purity of the signal is contaminated by higher - order harmonics . although it is not expected to change the maximal interference value occurring when the pulses are generated with the same modulation frequency , it will alter the shape of the interference as a function of the pulse frequency difference .",
    "hence , the fitted gaussian curve , assuming a fourier limited pulse , may not correctly reproduce the actual frequency dependence of the interference . indeed , the minimum coincidence rates consistently fall below the fitted curve . a second factor reducing the observed visibility",
    "is related to the need to adjust the aom drive amplitude to balance the bandwidth limitation .",
    "the limited accuracy with which we are able to estimate the appropriate rf amplitude results in significant scattering of the coincidence counts due to variations in input pulse intensities . to amend this we have found that it is necessary to normalize the points to the count rates on the individual detectors , as indicated on the y - axis of plot fig .",
    "[ fig : coin-1qm]c .",
    "unfortunately , the manifestation of the hom interference in the single - detector count rates  which will be elaborated later in the supplementary information  means that such a normalization procedure tends to reduce the visibility in the coincidence counts .",
    "+ next in line are the plots for the case in which only memory @xmath6 is activated , while the other is left inactive . in fig .",
    "[ fig : coin-1qm ] we present the coincidence count rates when changing the same degrees of freedom as in case of both memories being inactive . additionally , in fig .",
    "[ fig : coin-1qm]d , we plot the coincidence count rates when changing the storage time in the quantum memory .",
    "+ lastly , we present the plots for the case in which both memories are activated . due to limitations in our current setup",
    "it is not possible to simultaneously generate two quantum memories with different storage times , and therefore we do not acquire a storage time scan when both memories are active .",
    "furthermore , we skip the characterization with respect to the spectral degree of freedom .",
    "the coincidence count data for the remaining two degrees of freedom are plotted in fig .",
    "[ fig : coin-2qm ] , which also includes the appropriate fits .",
    "we also evaluate the effect of the two - photon interference on the counts registered by a single detector .",
    "this is easily done by amending the detection probability to the case of one detection event in one detector and any number of events @xmath105 ( i.e. @xmath106 ) in the other detector .",
    "we arrive at @xmath107 this expression can be inserted into eq .",
    "( [ eq : nmphotbsoutdetprobcoin ] ) to calculate @xmath108 , which , through eq .",
    "( [ eq : cohphotbsoutdetprobcoin ] ) , gives us @xmath109 , and from which the _ single - detector visibility _",
    "@xmath110 is defined analogous to eq .",
    "( [ eq : cohphotcoinvis ] ) .",
    "we can formulate a simplified expression by using the same approximations as in the case of coincidence detections : @xmath111 from which we get the single - detector visibility @xmath112 in the limit of low detector efficiency , @xmath113 , since , in that case , the probability of detecting two photons impinging on the detector is simply twice that of detecting one .",
    "this nulls the limitation that only a single detection event can be generated per pulse .",
    "furthermore , the single - detector visibility also goes to zero for very low mean photon numbers . in this case",
    "it is very unlikely to have two photons either at the _ same _ or at _ different _ input ports of the bs , hence most of the single detector counts stem from single photons from either one or the other input of the bs .",
    "it is interesting to note that if @xmath67 is known for a detector , then , from observing the single - detector visibility ( see eq .",
    "( [ eq : cohphotbsoutvissingsimp ] ) ) , it is in principle possible to estimate the mean photon number per pulse @xmath97 .",
    "another important consequence of the manifestation of two - photon interference in the single - detector counts is that the single - detector counts can not generally be used to normalize the coincidence counts w.r.t .",
    "fluctuations in the input pulse intensities . only for detectors with low detection efficiency or very low mean photon numbers , in which case @xmath113 ,",
    "is this normalization possible .",
    "[ [ experimental - results - on - hom - interference - manifested - in - single - detector - counts ] ] experimental results on hom interference manifested in single - detector counts ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    first , in figure  [ fig : sing-1qm ] , we present the single - detector counts corresponding to the coincidence counts depicted in figure  [ fig : coin-1qm]a , b . in the case where we vary the polarization and time separation we see a clear change in the single - detector counts , which , moreover , is evidently correlated with the change in coincidence counts . the count variation due to the two - photon interference is somewhat masked by the single - detector count scatter , which is due to intensity fluctuations mainly in the light going through the 10  km delay line .",
    "we fit the data in figures  [ fig : sing-1qm]a and b with a sine and gaussian function , respectively . for the former",
    "we find a mean photon number of @xmath116 while from the latter we estimate @xmath117 . from the number of single - detector counts there is some evidence to conclude that the light intensity is about 15% higher .",
    "to this should be added about 25% uncertainty for the intensity at the bs w.r.t .",
    "the intensity at the detector due to variation in the loss in the fibre mating sleeves .",
    "finally , the scatter of the counts makes the fits themselves rather uncertain .",
    "nevertheless , the mere fact that the two - photon interference is manifested in the single - detector counts validates the order of magnitude of the mean photon number , as depicted in fig .",
    "[ fig : sing - theo ] .",
    "figure  [ fig : sing-2qm ] depicts the single - detector counts corresponding to the coincidence counts depicted in figure  [ fig : coin-2qm]a , b .",
    "again , from fitting the appropriate functions to the polarization and time data yields visibilities around 7% , corresponding to mean photon numbers of around @xmath118 .      in this section",
    "we derive an analytical expression for the coincidence count rates corresponding to projections onto the @xmath119 bell - state for time - bin qubits detected by the two detectors at the output of the hom - bs . to that end",
    ", we will introduce a number of approximations as we did previously in order to calculate the hom interference in the coincidence counts . in the limit of low mean",
    "photon numbers , two coherent states impinging onto the two inputs of a 50:50 bs can be represented in terms of fock states as      where the subscripts on the state vector refer to the order of listing the input modes , i.e. @xmath121 . the factors written as @xmath122 denote the probability of having @xmath42 and @xmath73 photons in mode @xmath6 and @xmath7 , and are given by @xmath123 .",
    "stemming from the low mean photon number assumption , we do not include terms with more than two photons .",
    "assuming that our detectors are noiseless , terms with a total of one or no photons are also left out as they can not generate any coincidence counts .    for a time - bin qubit",
    ", the fock state is created in a superposition of two temporal modes , i.e. , an @xmath124 ( @xmath19 ) and a @xmath125 ( @xmath20 ) mode , by the creation operators for the spatial input mode @xmath126 of the beam - splitter , as      where @xmath128 and @xmath129 are the amplitudes of , and @xmath130 is the relative phase between , the two temporal modes composing the time - bin qubit .",
    "the subsript @xmath131 refers to the early time - bin of the spatial mode @xmath105 and similarly for @xmath132 .",
    "note , that we sometimes simplify the notation for the time - bin qubit states as @xmath133 .",
    "if we insert the expression in eq .",
    "( [ eq : timebincreate ] ) in place of the @xmath134 and @xmath135 operators in eq .",
    "( [ eq : bsinputfockrep ] ) we get the expression for the wavefunction @xmath136 for time - bin qubits at the hom - bs inputs .",
    "we split this expression into the various contributions given in eq .",
    "( [ eq : bsinputfockrep ] )    [ eq : multiphotonevent ] @xmath137 |0000\\rangle_{ce , cl , de , dl }    \\label{eq : multiphotoneventa}\\qquad\\\\[4pt ] ( ( \\hat{a}^{\\dagger})^2 \\otimes i)|00\\rangle_{ab }   & \\rightarrow \\frac{1}{2 } \\bigg [   2e^{i\\phi_a } \\cos\\!\\big(\\frac{\\theta_a}{2}\\big ) \\sin\\!\\big(\\frac{\\theta_a}{2}\\big ) \\left(\\hat{c}^\\dagger_e\\hat{c}^\\dagger_l - \\hat{d}^\\dagger_e\\hat{d}^\\dagger_l\\right ) \\qquad \\nonumber\\\\   & \\qquad + i2e^{i\\phi_a } \\cos\\!\\big(\\frac{\\theta_a}{2}\\big ) \\sin\\!\\big(\\frac{\\theta_a}{2}\\big ) \\left(\\hat{c}^\\dagger_e\\hat{d}^\\dagger_l + \\hat{c}^\\dagger_l\\hat{d}^\\dagger_e\\right ) \\qquad \\nonumber\\\\   & \\qquad + \\cos^2\\!\\big(\\frac{\\theta_a}{2}\\big ) \\left((\\hat{c}^\\dagger_e)^2 + i2 \\hat{c}^\\dagger_e\\hat{d}^\\dagger_e   - ( \\hat{d}^\\dagger_e)^2 \\right ) \\qquad \\nonumber\\\\   & \\qquad + e^{i2\\phi_a }",
    "\\sin^2\\!\\big(\\frac{\\theta_a}{2}\\big ) \\left((\\hat{c}^\\dagger_l)^2 + i2 \\hat{c}^\\dagger_l\\hat{d}^\\dagger_l   - ( \\hat{d}^\\dagger_l)^2 \\right ) \\bigg ] |0000\\rangle_{ce , cl , de , dl}\\label{eq : multiphotoneventb}\\end{aligned}\\ ] ]    and similarly for @xmath138 .",
    "again , the subscripts on the state vector refer to the order of listing the temporal and spatial modes , e.g. @xmath139 labels the early bin of the spatial output mode @xmath140 .",
    "we will look for coincidence detection events that correspond to projections onto the bell - state @xmath141 .",
    "such projections correspond to a detection event in the early time - bin in one detector followed by a detection event in the late time - bin in the other detector .",
    "this projection occurs with a probability @xmath142 , which can be computed by combining eq .",
    "( [ eq : multiphotonevent ] ) with eq .",
    "( [ eq : bsinputfockrep ] ) . assuming equal mean photon numbers at the two inputs @xmath91 and averaging over the coherent state phases , i.e. the complex angle between @xmath84 and @xmath85",
    ", we get the expression      with this we are able to calculate the probabilities of projection onto @xmath119 for different combinations of qubits at the two bs inputs , i.e. for different choices of the angles @xmath144 and @xmath130 . in turn , this allows us to calculate the @xmath119 bell - state measurement error rate as @xmath145 where @xmath146 is the projection probability when the two input qubit states are identical , i.e. @xmath147 and @xmath148 , while @xmath149 is the projection probability for two orthogonal input qubit states .",
    "this is also defined in terms of count rates in eq .",
    "( [ eq : errdef ] ) in the main text .",
    "we will now treat a number of relevant cases .",
    "+   + using the simplified notation this corresponds to the case were the input qubit states are of the form @xmath150 .",
    "when depicted on the bloch sphere these qubits span the @xmath151-plane . using eq .",
    "( [ eq : bellhomvis ] ) we compute the projection probability as      we are interested in the probability @xmath146 for the case in which the input qubits are parallel ( @xmath148 ) and @xmath149 for the case in which the input qubit states are orthogonal ( @xmath153 ) .",
    "specifically , when we prepare two qubits ( one at each input of the bs ) in state @xmath15 , or two qubits in state @xmath16 , we expect @xmath154 .",
    "the probability for observing a projection onto @xmath155 increases as we change @xmath156 ( or @xmath157 ) , and reaches a maximum @xmath149 if one qubit is in state @xmath15 and the other one in @xmath16 .",
    "hence , using the expression for the error rate above ( eq .",
    "( [ eq : errdefalt ] ) ) , we find @xmath158 .",
    "we now turn to measuring the coincidence rates for all combinations of @xmath15 and @xmath16 input states , and thus extracting @xmath146 and @xmath149 , using 0.6 photons per qubit at the memory input .",
    "more precisely , we prepare the input qubit state @xmath159 to measure @xmath160 and then @xmath161 to measure @xmath162 .",
    "subsequently , we prepare the input qubit state @xmath163 to measure @xmath164 and then @xmath165 to measure @xmath166 .",
    "these yield the average values @xmath167 and @xmath168 , from which we compute the experimental error rate @xmath27 , which is near the theoretical lowest value of @xmath169 .",
    "+ in this case the two input qubits are in equal superpositions of early and late bins , that is of the form @xmath170 . on the bloch sphere",
    "these are qubits that lie in the @xmath171-plane . in this case",
    "we compute @xmath172 thus the @xmath119 bell - state projection probability is smallest  but nonzero ",
    "when @xmath173 , i.e. the qubit states are parallel , and largest when the phases differ by @xmath174 , i.e. the qubit states are orthogonal . inserting these values for @xmath146 and @xmath149 into eq .",
    "( [ eq : errdefalt ] ) results in an expected error rate of @xmath175 .    using again 0.6 photons per qubit",
    ", we measure the coincidence counts for @xmath173 and @xmath174 giving us @xmath176 and @xmath177 , respectively . from these",
    "we get an error rate of @xmath178 , which is slightly above the theoretical bound .",
    "this indicates that either the measurement suffers from imperfections such as detector noise or the modes at the bs are not completely indistinguishable , which in turn could be due imperfectly generated qubit states or imperfect storage of the qubit in the quantum memory . to be conservative in our assessment of our quantum memory",
    "we assume that the entire increase of the measured values of @xmath179 is due to the memory fidelity being less than one .",
    "+ we now compare the performance of our bell - state measurement to a number of relevant bounds assuming always that any imperfections arise from the imperfect storage of the photon in the memory .",
    "we will derive bounds to the error rate in the case of one qubit being stored in either a classical memory ( cm ) or quantum memory ( qm ) . to accommodate this scenario",
    "we assume that the memory performs the following operation @xmath180 , where @xmath181 denotes the fidelity of the stored state and @xmath182 is the state orthogonal to @xmath183 . for a classical memory @xmath184  [ ] whereas for a quantum memory @xmath185 .",
    "doing the replacement @xmath186 and likewise for @xmath149 we can express the error rate expected after imperfect storage of one of the pulses partaking in the bell - state measurement : @xmath187 where in this case the probabilities @xmath146 and @xmath149 refer to those expected without the memory .",
    "since the expected values for @xmath146 and @xmath149 differ between the @xmath188 and @xmath189 bases we treat them separately .    beginning with the @xmath188 basis we use eq .",
    "( [ eq : errdefaltimperf ] ) with the values from eq .",
    "( [ eq : bellprojprobz ] ) to derive a bound for the error rate of the bell - state measurement for one of the two qubits being recalled from a quantum or a classical memory .",
    "we find that @xmath190 , and hence we establish the two bounds @xmath191 and @xmath192 .",
    "this clearly shows that a classical memory would cause a larger error rate than the @xmath193 measured after storage in our memory .",
    "we can also reverse the equations and estimate our memory s fidelity based on the measured error rate . in this case , inserting @xmath194 into eq .",
    "( [ eq : errdefaltimperf ] ) , we deduce the value @xmath195 .",
    "we now turn to the @xmath189 basis . for attenuated laser pulses we insert into eq .",
    "( [ eq : errdefaltimperf ] ) the values @xmath196 and @xmath197 computed from eq .",
    "( [ eq : bellprojprobx ] ) , which enables us to relate the error rate to the memory fidelity as @xmath198 .",
    "thus , one obtains the theoretical lower bound on the error rate @xmath199 for an ideal quantum memory @xmath200 and @xmath201 with an optimal classical storage device @xmath202 .",
    "we make the observation that our experimental error rate @xmath178 is much below the bound for a classical memory .",
    "based on the experimental error rate @xmath178 we derive an experimental value for the memory fidelity of @xmath203 .",
    "the estimates of the memory fidelity @xmath204 and @xmath205 derived from our measurements in two bases are equal to within the experimental error .",
    "this together with the fact that their values are well above @xmath206 reaffirms our claim that our storage device outperforms a classical memory .",
    "we emphasize once more that we have assumed that the reduction in error rates is due solely to the memory and thus indicates the fidelity of the memory .",
    "however , this is likely not the case as imperfections in the state preparation and detector noise also contribute to the reduction in error rate .",
    "+ although we do not use single photon sources for the experiments reported here , it is interesting to determine how well our results measure up to those that could have been obtained if single photon sources had been employed . in the following",
    "we will derive the error rate for the bell - state measurement using qubits encoded into single photons . to this end",
    "we step back to eq .",
    "( [ eq : bsinputfockrep ] ) , and note that for single photon sources all probabilities are 0 except for @xmath207 , which describes the probability of having a single photon at each bs input .",
    "thus , in the output state we only need to keep the terms from eq .",
    "( [ eq : multiphotoneventa ] ) , which in turn means that the bell - state projection probability can be written as      it is easily seen that for any two parallel input qubit states ( @xmath148 and @xmath147 ) we get @xmath209",
    ". therefore , irrespective of the projection probability for orthogonal input qubit states the expected error rate is always @xmath210 , where @xmath211 identifies this value as belonging to the single photon case .",
    "gauging the effect of storing one of the single photons partaking in the bell - state measurement in a memory is thus independent of the basis and using eq .",
    "( [ eq : errdefaltimperf ] ) we derive @xmath212 and @xmath213 . contrasting the error rate expected for a photon stored in a classical memory with the two values @xmath27 and @xmath178 obtained experimentally , we recognize that both are well below @xmath214 .",
    "this means that even with a single photon source at ones disposal the error rates that we measured could not have been attained with a classical memory .",
    "+ in this final section we will explore in greater detail the hom interference dependence on the angle @xmath215 between a set of equal superposition qubit states @xmath216 , which in line with the preceding sections belong to the @xmath189 basis . according to eq .",
    "( [ eq : bellprojprobx ] ) the coincidence count rates vary as function of @xmath217 . in fig .",
    "[ fig : coin_1qm_tbinphase ] we show measured coincidence count rates as function of @xmath215 for a mean photon number per qubit before the memory of around 20 .",
    "as expected the coincidence detection probability reaches its maximum @xmath149 when two input qubits are orthogonal ( @xmath218 ) and when they are identical ( @xmath173 ) it reaches a minimum @xmath146 .",
    "it is natural to define a bell - state measurement visibility as @xmath219 analogous to eq .",
    "( [ eq : hom_visibility ] ) in the main text . using values obtained from a cosine fit to the data in fig .",
    "[ fig : coin_1qm_tbinphase ] yeilds @xmath220 . comparing eq .",
    "( [ eq : visbsmdef ] ) with eq .",
    "( [ eq : errdefalt ] ) it is easily seen that @xmath221 and @xmath19 are related as @xmath222 .",
    "we can then use the expected error rates to find the corresponding bell - state measurement visibilities . using @xmath223",
    "we get a theoretical value @xmath224 . in conclusion ,",
    "our experimental bell - state measurement visibility is only slightly below and within the experimental error actually equal to the expected value ."
  ],
  "abstract_text": [
    "<S> quantum memories for light , which allow the reversible transfer of quantum states between light and matter , are central to the development of quantum repeaters @xcite , quantum networks @xcite , and linear optics quantum computing @xcite . </S>",
    "<S> significant progress has been reported in recent years , including the faithful transfer of quantum information from photons in pure and entangled qubit states @xcite . however , none of these demonstrations confirm that photons stored in and recalled from quantum memories remain suitable for two - photon interference measurements , such as c - not gates and bell - state measurements , which constitute another key ingredient for all aforementioned applications of quantum information processing . using pairs of weak laser pulses , each containing less than one photon on average , we demonstrate two - photon interference as well as a bell - state measurement after either none , one , or both pulses have been reversibly mapped to separate thulium - doped titanium - indiffused lithium niobate ( ti : tm : linbo@xmath0 ) waveguides . as </S>",
    "<S> the interference is always near the theoretical maximum , we conclude that our solid - state quantum memories , in addition to faithfully mapping quantum information , also preserves the entire photonic wavefunction . </S>",
    "<S> hence , we demonstrate that our memories are generally suitable for use in advanced applications of quantum information processing that require two - photon interference .    </S>",
    "<S> when two indistinguishable single photons impinge on a 50/50 beam - splitter ( bs ) from different input ports , they bunch and leave together by the same output port . </S>",
    "<S> this so - called hong - ou - mandel ( hom ) effect @xcite is due to destructive interference between the probability amplitudes associated with both input photons being transmitted or both reflected , see fig . </S>",
    "<S> 1 . since no such interference occurs for distinguishable input photons , the interference visibility @xmath1 provides a convenient way to verify that two photons are indistinguishable in all degrees of freedom , i.e. spatial , temporal , spectral , and polarization modes . </S>",
    "<S> the visibility is defined as @xmath2 where @xmath3 and @xmath4 denote the rate with which photons are detected in the two output ports in coincidence if the incoming photons are indistinguishable and distinguishable , respectively . </S>",
    "<S> consequently , the hom effect has been employed to characterize the indistinguishability of photons emitted from a variety of sources , including parametric down - conversion crystals @xcite , trapped neutral atoms @xcite , trapped ions @xcite , quantum dots @xcite , organic molecules @xcite , nitrogen - vacancy centres in diamond @xcite , and atomic vapours @xcite . </S>",
    "<S> furthermore , two - photon interference is at the heart of linear optics bell - state measurements @xcite , and , as such , has already enabled experimental quantum dense coding @xcite , quantum teleportation @xcite , and entanglement swapping @xcite . </S>",
    "<S> however , to date , the possibility to perform bell - state measurements with photons that have previously been stored in a quantum memory , as required for advanced applications of quantum information processing , has not yet been established . </S>",
    "<S> for these measurements to succeed , photons need to remain indistinguishable in all degrees of freedom , which is more restrictive than the faithful recall of encoded quantum information . indeed , taking into account that photons may or </S>",
    "<S> may not have been stored before the measurement , this criterion amounts to the requirement that a quantum memory preserves a photon s wavefunction during storage . </S>",
    "<S> similar to the case of photon sources , the criterion of indistinguishability is best assessed using hom interference , provided single - photon detectors are employed .        our experimental setup is depicted in fig .  </S>",
    "<S> [ fig : experimentalsetup ] . we employ solid - state quantum memories , more precisely thulium - doped lithium - niobate waveguides in conjunction with the atomic frequency comb ( afc ) quantum memory protocol @xcite , which have shown great promise for advanced applications of quantum information processing @xcite . </S>",
    "<S> we then interfere various combinations of recalled and non - stored ( i.e. directly transmitted ) pulses on a 50/50 bs ( hom - bs ) . when using single photon fock states at the memory inputs , the hom visibility given in eq .  </S>",
    "<S> ( [ eq : hom_visibility ] ) theoretically reaches 100% as illustrated in fig .  </S>",
    "<S> [ fig : homillustr ] . </S>",
    "<S> however , with phase incoherent laser pulses obeying poissonian photon - number statistics , as in our demonstration , the maximally achievable visibility is 50% @xcite , irrespective of the mean photon number ( see supplementary information ) . nevertheless , attenuated laser pulses are perfectly suitable for assessing the effect of our quantum memories on the photonic wavefunction . </S>",
    "<S> any reduction of indistinguishability due to storage causes a reduction of visibility , albeit from maximally 50% . </S>",
    "<S> this approach extends the characterization of quantum memories using attenuated laser pulses @xcite from assessing the preservation of quantum information during storage to assessing the preservation of the entire wavefunction , and from first- to second - order interference .        </S>",
    "<S> we first deactivate both quantum memories ( see supplementary information ) , to examine the interference between directly transmitted pulses , and thereby establish a reference visibility for our experimental setup . </S>",
    "<S> we set the mean photon number per pulse before the memories to 0.6 , i.e. to the single - photon level . using the wave plates </S>",
    "<S> , we rotate the polarizations of the pulses at the two hom - bs inputs to be parallel ( indistinguishable ) or orthogonal ( distinguishable ) . employing eq .  </S>",
    "<S> ( [ eq : hom_visibility ] ) we find a visibility of @xmath5% .    </S>",
    "<S> subsequently , we activate memory @xmath6 while keeping memory @xmath7 off , and adjust the timing of the pulse preparation so as to interfere a recalled pulse from the active memory with a directly transmitted pulse from the inactive memory ( see supplementary information ) . </S>",
    "<S> pulses are stored for 30  ns in memory @xmath6 , and the mean photon number per pulse at the quantum memory input is 0.6 . taking the limited storage efficiency of @xmath8 and coupling loss into account , this results in @xmath9 photons per pulse at the hom - bs inputs . as before , changing the pulse polarizations from mutually parallel to orthogonal , we find @xmath10% , which equals our reference value within the measurement uncertainties .    as the final step , we activate both memories to test the feasibility of two - photon interference in a quantum - repeater scenario . </S>",
    "<S> we note that in a real - world implementation , memories belonging to different network nodes are not necessarily identical in terms of material properties and environment . </S>",
    "<S> this is captured by our setup where the two ti : tm : linbo@xmath0 waveguides feature different optical depths and experience different magnetic fields ( see fig .  </S>",
    "<S> [ fig : experimentalsetup ] and supplementary information ) . to balance the ensuing difference in memory efficiency we set the mean photon number per pulse before the less efficient and more efficient memories to 4.6 and 0.6 , respectively , so that , as before , the mean photon numbers are @xmath9 at both hom - bs inputs . with the storage time of both memories set to 30  ns , we get @xmath11% , in excellent agreement with the values from the previous measurements . </S>",
    "<S> the consistently high visibilities , compiled in the first column of table  [ tab : visresults ] , hence confirm that our storage devices do not introduce any degradation of photon indistinguishability during the reversible mapping process , and that two - photon interference is feasible with photons recalled from separate quantum memories , even if the memories are different .    </S>",
    "<S> we now investigate in greater detail the change in coincidence count rates as photons gradually change from being mutually indistinguishable to completely distinguishable w.r.t .  </S>",
    "<S> each degree of freedom accessible for change in single - mode fibres , i.e. polarization , temporal , and spectral modes ( see supplementary information ) . to acquire data </S>",
    "<S> more efficiently we increase the mean number of photons per pulse at the memory input to between 10 and 50 ( referred to as few - photon - level measurements ) . </S>",
    "<S> however , the mean photon number at the hom - bs remains below one . </S>",
    "<S> example data plots are shown in fig .  </S>",
    "<S> [ fig : exresults ] , while the complete set of plots is supplied in the supplementary information figs .  </S>",
    "<S> [ fig : coin-0qm]-[fig : coin-2qm ] .    in fig .  </S>",
    "<S> [ fig : exresults]a we show the coincidence counts rates as a function of the polarization of the recalled pulse for the case of one active memory . </S>",
    "<S> the visibilities for all configurations ( i.e. zero , one , or two active memories ) extracted from fits to the experimental data are listed in column 2 of table  [ tab : visresults ] . </S>",
    "<S> they are  as in the case of single - photon - level inputs  </S>",
    "<S> equal to within the experimental uncertainty .        </S>",
    "<S> next , in fig .  </S>",
    "<S> [ fig : exresults]b , we depict the coincidence count rates as a function of the temporal overlap ( adjusted by the timing of the pulse generation ) for the two - memory configuration . </S>",
    "<S> column 3 of table  [ tab : visresults ] shows the visibilities extracted from gaussian fits to the data , reflecting the temporal profiles of the probe pulses , for all configurations . within experimental uncertainty , </S>",
    "<S> they are equal to each other . </S>",
    "<S> alternatively , in the single - memory configuration , we also change the temporal mode overlap by adjusting the storage time of the pulse mapped to the quantum memory . </S>",
    "<S> again the measured visibility of @xmath12% ( see fig .  </S>",
    "<S> [ fig : exresults]c ) is close to the theoretical maximum .    finally , we vary the frequency difference between the two pulses ( see supplementary information ) to witness two - photon interference w.r.t .  </S>",
    "<S> spectral distinguishability . for this measurement </S>",
    "<S> , we consider only the configurations in which neither , or a just single memory is active . in both cases the visibilities , listed in the last column of table  [ tab : visresults ] , </S>",
    "<S> are around 43% . </S>",
    "<S> while this is below the visibilities found previously , for reasons discussed in the supplementary information , the key observation is that the quantum memory does not affect the visibility .    </S>",
    "<S> .experimental two - photon interference visibilities ( % ) for different degrees of freedom [ cols=\"^,^,^,^,^ \" , ]     [ tab : visresults ]    as stated in the introduction , bell - state measurements ( bsm ) with photonic qubits recalled from separate quantum memories are key ingredients for advanced applications of quantum communication . </S>",
    "<S> to demonstrate this important element , we consider the asymmetric ( and arguably least favourable ) case in which only one of the qubits is stored and recalled . appropriately driving the aom in fig .  </S>",
    "<S> [ fig : experimentalsetup ] , we prepare the states @xmath13 and @xmath14 , which describe time - bin qubits @xcite of the form @xmath15 , @xmath16 , @xmath17 , or @xmath18 , where @xmath19 and @xmath20 , respectively , label photons in early or late temporal modes , which are separated by 25  ns . the qubits are directed to the memories of which only one is activated . </S>",
    "<S> the mean photon number of the qubit that is stored is set to 0.6 , yielding a mean photon number of both qubits at the hom - bs input of @xmath21 . </S>",
    "<S> we ensure to overlap pulses encoding the states @xmath13 and @xmath14 at the hom - bs and count coincidence detections that correspond to a projection onto the @xmath22 bell state . </S>",
    "<S> this projection occurs if the two detectors click with 25  ns time difference @xcite . because @xmath23 is antisymmetric w.r.t . </S>",
    "<S> any basis , the count rate is expected to reach a minimum value @xmath24 if the two input pulses are prepared in equal states , and a maximum value @xmath25 if prepared in orthogonal states . accordingly , we define an error rate that quantifies the deviation of the minimum count rate from its ideal value of zero : @xmath26 first , choosing to encode @xmath13 and @xmath14 in states @xmath15 and @xmath16 we obtain the error rate @xmath27 , which is near the theoretical value of @xmath28 ( see the supplementary information for derivations of the theoretical values and bounds ) . </S>",
    "<S> in addition it clearly violates the lower bound @xmath29 that can be obtained for a bell - state measurement on two qubits of which one is recalled from a classical memory ( cm ) . </S>",
    "<S> note that values for @xmath30 and @xmath31 are independent of whether @xmath15 and @xmath16 qubits are encoded into single photons or attenuated laser pulses . </S>",
    "<S> next , using instead the states @xmath32 , and @xmath33 we measure @xmath34 , which again only slightly exceeds the lowest possible value for attenuated laser pulses of @xmath35 . </S>",
    "<S> the crucial observation is once more that @xmath36 violates both the lower bound for qubits encoded into single photons @xmath37 and attenuated laser pulses @xmath38 that are recalled from a classical memory .    </S>",
    "<S> our demonstrations show that solid - state afc quantum memories are suitable for two - photon interference experiments , even in the general case of storing the two photons an unequal number of times . with improved system efficiency @xcite and multi - mode storage supplemented by </S>",
    "<S> read - out on demand @xcite , such memories can be used as synchronization devices in multi - photon experiments , which will allow increasing the number of photons that can be harnessed simultaneously for quantum information processing beyond the current limit of eight @xcite . </S>",
    "<S> a subsequent goal is to develop workable quantum repeaters or , more generally , quantum networks , for which longer storage times are additionally needed . </S>",
    "<S> depending on the required value , which may range from hundred micro - seconds @xcite to seconds @xcite , this may be achieved by storing quantum information in optical coherence , or it may require mapping of optical coherence onto spin states @xcite . </S>"
  ]
}