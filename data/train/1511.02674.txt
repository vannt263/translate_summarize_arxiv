{
  "article_text": [
    "the recent introduction of fully convolutional networks ( fcns )  @xcite has led to significant quantitative improvements on the task of semantic segmentation . however , despite their empirical success , fcns suffer from some limitations .",
    "large receptive fields in the convolutional layers and the presence of pooling layers lead to blurring and segmentation predictions at a significantly lower resolution than the original image . as a result ,",
    "their predicted segments tend to be blobby and lack fine object boundary details .",
    "we report in fig .",
    "[ intro_fig ] some examples illustrating typical poor localization of objects in the outputs of fcns .",
    "recently , chen at al .",
    "@xcite addressed this issue by applying a dense - crf post - processing step  @xcite on top of coarse fcn segmentations .",
    "however , such an approach introduces several problems of its own .",
    "first , the dense - crf adds new parameters that are difficult to tune and integrate into the original network architecture . additionally , most methods based on crfs or mrfs use low - level pixel affinity functions , such as those based on color .",
    "these low - level affinities often fail to capture semantic relationships between objects and lead to poor segmentation results ( see last column in fig .",
    "[ intro_fig ] ) .",
    "we propose to address these shortcomings by means of a boundary neural field ( bnf ) , an architecture that employs a single semantic segmentation fcn to predict semantic boundaries and then use them to produce semantic segmentation maps via a global optimization .",
    "we demonstrate that even though the semantic segmentation fcn has not been optimized to detect boundaries , it provides good features for boundary detection .",
    "specifically , the contributions of our work are as follows :    * we show that semantic boundaries can be expressed as a linear combination of interpolated convolutional feature maps inside an fcn .",
    "we introduce a boundary detection method that exploits this intuition to predict object boundaries with accuracy superior to the state - the - of - art . *",
    "we demonstrate that boundary - based pixel affinities are better suited for semantic segmentation than the commonly used color affinity functions .",
    "* finally , we introduce a new global energy that decomposes semantic segmentation into multiple binary problems and relaxes the integrality constraint .",
    "we show that minimizing our proposed energy yields better qualitative and quantitative results relative to traditional globalization models such as mrfs or crfs .",
    "* boundary detection . *",
    "spectral methods comprise one of the most prominent categories for boundary detection . in a typical spectral framework ,",
    "one formulates a generalized eigenvalue system to solve a low - level pixel grouping problem .",
    "the resulting eigenvectors are then used to predict the boundaries .",
    "some of the most notable approaches in this genre are mcg  @xcite , gpb  @xcite , pmi  @xcite , and normalized cuts  @xcite .",
    "a weakness of spectral approaches is that they tend to be slow as they perform a global inference over the entire image .    to address this issue , recent approaches cast boundary detection as a classification problem and predict the boundaries in a local manner with high efficiency .",
    "the most notable examples in this genre include sketch tokens ( st )  @xcite and structured edges ( se )  @xcite , which employ fast random forests . however , many of these methods are based on hand - constructed features , which are difficult to tune .",
    "the issue of hand - constructed features have been recently addressed by several approaches based on deep learning , such as @xmath0 fields  @xcite , deepnet  @xcite , deepcontour  @xcite , deepedge  @xcite , hfl  @xcite and he d  @xcite .",
    "all of these methods use cnns in some way to predict the boundaries . whereas deepnet and deepcontour optimize ordinary cnns to a boundary based optimization criterion from scratch , deepedge and hflemploy pretrained models to compute boundaries .",
    "the most recent of these methods is he d  @xcite , which shows the benefit of deeply supervised learning for boundary detection .    in comparison to prior deep learning approaches ,",
    "our method offers several contributions .",
    "first , we exploit the inherent relationship between boundary detection and semantic segmentation to predict semantic boundaries .",
    "specifically , we show that even though the semantic fcn has not been explicitly trained to predict boundaries , the convolutional filters inside the fcn provide good features for boundary detection .",
    "additionally , unlike deepedge  @xcite and hfl  @xcite , our method does not require a pre - processing step to select candidate contour points , as we predict boundaries on all pixels in the image .",
    "we demonstrate that our approach allows us to achieve state - of - the - art boundary detection results according to both f - score and average precision metrics . additionally , due to the semantic nature of our boundaries , we can successfully use them as pairwise potentials for semantic segmentation in order to improve object localization and recover fine structural details , typically lost by pure fcn - based approaches .",
    "* semantic segmentation .",
    "* we can group most semantic segmentation methods into three broad categories .",
    "the first category can be described as `` two - stage '' approaches , where an image is first segmented and then each segment is classified as belonging to a certain object class .",
    "some of the most notable methods that belong to this genre include  @xcite .",
    "the primary weakness of the above methods is that they are unable to recover from errors made by the segmentation algorithm .",
    "several recent papers  @xcite address this issue by proposing to use deep per - pixel cnn features and then classify each pixel as belonging to a certain class .",
    "while these approaches partially address the incorrect segmentation problem , they perform predictions independently on each pixel . this leads to extremely local predictions , where the relationships between pixels are not exploited in any way , and thus the resulting segmentations may be spatially disjoint .    the third and final group of semantic segmentation methods can be viewed as front - to - end schemes where segmentation maps are predicted directly from raw pixels without any intermediate steps .",
    "one of the earliest examples of such methods is the fcn introduced in  @xcite .",
    "this approach gave rise to a number of subsequent related approaches which have improved various aspects of the original semantic segmentation  @xcite .",
    "there have also been attempts at integrating the crf mechanism into the network architecture  @xcite .",
    "finally , it has been shown that semantic segmentation can also be improved using additional training data in the form of bounding boxes  @xcite .",
    "our bnf offers several contributions over prior work . to the best of our knowledge ,",
    "we are the first to present a model that exploits the relationship between boundary detection and semantic segmentation * within a fcn framework*. we introduce pairwise pixel affinities computed from semantic boundaries inside an fcn , and use these boundaries to predict the segmentations in a global fashion . unlike  @xcite , which requires a large number of additional parameters to learn for the pairwise potentials , our global model only needs @xmath1 extra parameters , which is about @xmath2 orders of magnitudes less than the number of parameters in a typical deep convolutional network ( e.g. vgg  @xcite ) .",
    "we empirically show that our proposed boundary - based affinities are better suited for semantic segmentation than color - based affinities .",
    "additionally , unlike in  @xcite , the solution to our proposed global energy can be obtained in closed - form , which makes global inference easier .",
    "finally we demonstrate that our method produces better results than traditional globalization models such as crfs or mrfs .",
    "in this section , we describe boundary neural fields . similarly to traditional globalization methods , boundary neural fields are defined by an energy including unary and pairwise potentials .",
    "minimization of the global energy yields the semantic segmentation .",
    "bnfs build both unary and pairwise potentials from the input rgb image and then combine them in a global manner .",
    "more precisely , the coarse segmentations predicted by a semantic fcn are used to define the unary potentials of our bnf .",
    "next , we show that the convolutional feature maps of the fcn can be used to accurately predict semantic boundaries .",
    "these boundaries are then used to build pairwise pixel affinities , which are used as pairwise potentials by the bnf .",
    "finally , we introduce a global energy function , which minimizes the energy corresponding to the unary and pairwise terms and improves the initial fcn segmentation .",
    "the detailed illustration of our architecture is presented in figure  [ fig : arch ] .",
    "we now explain each of these steps in more detail .      to predict semantic unary potentials we employ the deeplab model  @xcite , which is a fully convolutional adaptation of the vgg network  @xcite .",
    "the fcn consists of @xmath3 convolutional layers and @xmath2 fully convolutional layers .",
    "there are more recent fcn - based methods that have demonstrated even better semantic segmentation results  @xcite .",
    "although these more advanced architectures could be integrated into our framework to improve our unary potentials , in this work we focus on two aspects orthogonal to this prior work : 1 ) demonstrating that our boundary - based affinity function is better suited for semantic segmentation than the common color - based affinities and 2 ) showing that our proposed global energy achieves better qualitative and quantitative semantic segmentation results in comparison to prior globalization models .      in this section , we describe our approach for building pairwise pixel affinities using semantic boundaries . the basic idea behind our boundary detection approach is to express semantic boundaries as a function of convolutional feature maps inside the fcn .",
    "due to the close relationship between the tasks of semantic segmentation and boundary detection , we hypothesize that convolutional feature maps from the semantic segmentation fcn can be employed as features for boundary detection .",
    "we propose to express semantic boundaries as a linear combination of interpolated fcn feature maps with a non - linear function applied on top of this sum .",
    "we note that interpolation of feature maps has been successfully used in prior work ( see e.g.  @xcite ) in order to obtain dense pixel - level features from the low - resolution outputs of deep convolutional layers . here",
    "we adopt interpolation to produce pixel - level boundary predictions .",
    "there are several advantages to our proposed formulation .",
    "first , because we express boundaries as a linear combination of feature maps , we only need to learn a small number of parameters , corresponding to the individual weight values of each feature map in the fcn .",
    "this amounts to @xmath1 learning parameters , which is much smaller than the number of parameters in the entire network ( @xmath4 ) . in comparison ,",
    "deepedge  @xcite and hfl  @xcite need 17 m and 6 m _ additional _ parameters to predict boundaries .    furthermore , expressing semantic boundaries as a linear combination of fcn feature maps allows us to efficiently predict boundary probabilities for all pixels in the image ( we resize the fcn feature maps to the original image dimensions ) .",
    "this eliminates the need to select candidate boundary points in a pre - processing stage , which was instead required in prior boundary detection work  @xcite .",
    "our boundary prediction pipeline can be described as follows .",
    "first we use use sbd segmentations  @xcite to optimize our fcn for semantic segmentation task .",
    "we then treat fcn convolutional maps as features for the boundary detection task and use the boundary annotations from bsds 500 dataset  @xcite to learn the weights for each feature map .",
    "bsds 500 dataset contains @xmath5 training , @xmath6 validation , @xmath5 testing images , and ground truth annotations by @xmath7 human labelers for each of these images .    to learn the weights corresponding to each convolutional feature map we first sample @xmath8 points from the dataset .",
    "we define the target labels for each point as the fraction of human annotators agreeing on that point being a boundary .",
    "to fix the issue of label imbalance ( there are many more non - boundaries than boundaries ) , we divide the label space into four quartiles , and select an equal number of samples for each quartile to balance the training dataset . given these sampled points ,",
    "we then define our features as the values in the interpolated convolutional feature maps corresponding to these points .",
    "to predict semantic boundaries we weigh each convolutional feature map by its weight , sum them up and apply a sigmoid function on top of it . we obtain the weights corresponding to each convolutional feature map by minimizing the cross - entropy loss using a stochastic batch gradient descent for @xmath9 epochs",
    ". to obtain crisper boundaries at test - time we post - process the boundary probabilities using non - maximum suppression .    to give some intuition on how fcn feature maps contribute to boundary detection , in fig .",
    "[ conv_maps ] we visualize the feature maps corresponding to the highest weight magnitudes .",
    "it is clear that many of these maps contain highly localized boundary information .",
    ".boundary detection results on bsds500 benchmark .",
    "our proposed method outperforms all prior algorithms according to all three evaluation metrics . [ cols=\"^,^,^,^\",options=\"header \" , ]     in this section we present quantitative and qualitative results for semantic segmentation on the sbd  @xcite dataset , which contains objects and their per - pixel annotations for @xmath10 pascal voc classes .",
    "we evaluate semantic segmentation results using two evaluation metrics .",
    "the first metric measures accuracy based on pixel intersection - over - union averaged per pixels ( pp - iou ) across the 20 classes . according to this metric , the accuracy is computed on a per - pixel basis . as a result ,",
    "the images that contain large object regions are given more importance .",
    "however , for certain applications we may need to accurately segment small objects .",
    "therefore , similar to  @xcite we also consider the pi - iou metric ( pixel intersection - over - union averaged per image across the 20 classes ) , which gives equal weight to each of the images .",
    "we compare boundary neural fields with other commonly used global inference methods .",
    "these methods include belief propagation  @xcite , iterated conditional mode ( icm ) , graph cuts  @xcite , and dense - crf  @xcite .",
    "note that in all of our evaluations we use the same fcn unary potentials for every model .",
    "our evaluations provide evidence for three conclusions :    * in subsection  [ aff_results ] , we show that our boundary - based pixel affinities are better suited for semantic segmentation than the traditional color - based affinities . * in subsection  [ inf_results ]",
    ", we demonstrate that our global minimization leads to better results than those achieved by other inference schemes . * in fig .",
    "[ ss ] , we qualitatively compare the outputs of fcn and dense - crf to our predicted segmentations .",
    "this comparison shows that the bnf segments are better localized around the object boundaries and that they are also spatially smooth .",
    "| c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c    bottle & bus & car & cat & chair & cow & table & dog & horse & mbike & person & plant & sheep & sofa & train & tv & mean + & fcn - softmax & 80.7 & 71.6 & 80.7 & 71.3 & 72.9 & 88.1 & 81.8 & 86.6 & 47.4 & 82.9 & 57.9 & 83.9 & 79.6 & 80.4 & 81.0 & 64.7 & 78.2 & 54.5 & 80.9 & 69.9 & 74.8 + & belief propagation  @xcite & 81.4 & 72.2 & 82.4 & 72.2 & 74.3 & 88.8 & 82.4 & 87.2 & 48.4 & 83.8 & 58.4 & 84.6 & 80.5 & 80.9 & 81.5 & 65.1 & 79.5 & 55.5 & 81.5 & 71.2 & 75.6 + & icm & 81.7 & 72.2 & 82.8 & 72.1 & 75.3 & 89.6 & 83.4 & 87.7 & 46.3 & 83.3 & 58.4 & 84.6 & 80.6 & 81.4 & 81.5 & 65.8 & 79.5 & 56.0 & 80.7 & 74.1 & 75.8 + & trws  @xcite & 81.6 & 70.9 & 83.8 & 72.0 & 75.1 & 89.5 & 82.5 & 88.0 & * 51.7 & 86.6 & 61.9 & 85.8 & 83.3 & 80.8 & 81.1 & 65.3 & 81.5 & * 58.8 & 77.6 & 75.9 & 76.7 + & graph cuts  @xcite & 82.5 & 72.4 & 84.6 & 73.3 & * 77.2 & 89.7 & 83.3 & 88.8 & 49.3 & 84.0 & 60.3 & 85.4 & 82.2 & 81.2 & 81.9 & 66.7 & 79.8 & 58.0 & 82.3 & 74.9 & 76.9 + & qpbo  @xcite & 82.6 & 72.3 & 84.7 & 73.1 & 76.7 & 89.9 & * 83.6 & 89.3 & 49.7 & 85.0 & 61.1 & 86.2 & 82.9 & 81.3 & * 82.3 & 67.1 & 80.5 & * 58.8 & 82.2 & 75.1 & 77.2 + & dense - crf  @xcite & * 83.4 & 71.5 & 84.9 & 72.6 & 76.2 & 89.5 & 83.3 & 89.1 & 50.4 & * 86.7 & 61.0 & * 86.8 & * 83.5 & * 81.8 & * 82.3 & 66.9 & * 82.2 & 58.2 & 81.9 & 75.1 & 77.3 + & * bnf - sb & 81.9 & 72.5 & 84.9 & 73.3 & 76.0 & 90.3 & 83.1 & 89.2 & 51.2 & * 86.7 & * 61.5 & 86.6 & 83.2 & 81.3 & 81.9 & 66.2 & 81.7 & 58.6 & 81.6 & * 75.8 & 77.4 + & * bnf - sb - sm & 82.2 & * 73.1 & * 85.1 & * 73.8 & 76.7 & * 90.6 & 83.4 & * 89.5 & 51.3 & * 86.7 & 61.4 & * 86.8 & 83.3 & 81.7 & * 82.3 & * 67.7 & 81.9 & 58.4 & * 82.4 & 75.4 & * 77.6 + & fcn - softmax & 56.9 & 35.1 & 47.8 & 41.1 & 27.4 & 51.1 & 43.4 & 52.7 & 22.2 & 43.1 & 29.2 & 54.2 & 40.5 & 45.6 & 59.1 & 24.2 & 43.6 & 24.8 & 55.9 & 37.2 & 41.8 + & belief propagation  @xcite & 68.0 & 38.6 & 52.9 & 45.8 & 31.9 & 55.9 & 47.2 & 58.2 & 24.6 & 49.9 & 31.7 & 60.2 & 44.9 & 50.1 & 62.4 & 25.2 & 49.9 & 27.6 & 62.3 & 42.2 & 46.2 + & icm & 65.3 & 40.9 & 56.4 & 45.3 & 33.7 & 58.9 & 49.5 & 61.9 & 25.8 & 53.5 & 33.2 & 62.1 & 48.0 & 53.2 & 63.4 & 24.1 & 54.8 & 34.0 & 63.7 & 47.7 & 48.8 + & trws  @xcite & 67.5 & 40.7 & 60.3 & 46.3 & 35.6 & 63.4 & 49.6 & 69.3 & 29.7 & 58.9 & 37.8 & 67.4 & 57.3 & 53.8 & 64.1 & 26.3 & 62.0 & 36.9 & 63.1 & 49.9 & 52.0 + & graph cuts  @xcite & 72.1 & 47.8 & 64.5 & 50.8 & 36.0 & 70.8 & 51.4 & 71.6 & 31.7 & 65.8 & 34.4 & 71.8 & 62.0 & 59.4 & 64.8 & 29.0 & 60.9 & 38.7 & 70.3 & 51.6 & 55.3 + & qpbo  @xcite & 71.6 & 46.8 & 65.6 & 49.6 & 38.0 & 72.6 & 52.7 & 76.7 & 32.5 & 69.6 & 38.9 & 74.4 & 61.4 & 61.0 & * 66.2 & 30.3 & * 68.7 & * 41.4 & 72.2 & 52.8 & 57.2 + & dense - crf  @xcite & 68.0 & 39.5 & 58.0 & 45.0 & 33.4 & 62.8 & 47.7 & 66.0 & 29.4 & 60.9 & 36.0 & 68.5 & 54.6 & 51.4 & 63.7 & 28.3 & 57.6 & 37.1 & 65.9 & 48.2 & 51.1 + & * bnf - sb & 71.6 & 48.1 & * 67.2 & 52.3 & 37.8 & * 79.5 & 52.9 & * 80.8 & * 33.3 & 71.5 & * 39.5 & * 75.1 & 65.7 & 63.4 & 65.1 & 31.1 & 67.5 & 39.6 & * 73.2 & * 54.7 & * 58.5 + & * bnf - sb - sm & * 72.0 & * 48.9 & 66.5 & * 52.9 & * 39.1 & 79.0 & * 53.4 & 78.6 & 32.9 & * 72.2 & 39.4 & 74.6 & * 65.9 & * 64.2 & 65.8 & * 31.7 & 66.9 & 39.0 & 73.1 & 53.9 & * 58.5 + * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *      in table  [ affinity_table ] , we consider two global models .",
    "both models use the same unary potentials obtained from the fcn _ softmax _ layer .",
    "however , the first model uses the popular color - based pairwise affinities , while the second employs our boundary - based affinities .",
    "each of these two models is optimized using several inference strategies .",
    "the table shows that using our boundary based - affinity function improves the results of all global inference methods according to both evaluation metrics .",
    "note that we can not include dense - crf  @xcite in this comparison because it employs an efficient message - passing technique and integrating our affinities into this technique is a non - trivial task .",
    "however , we compare our method with dense - crf in subsection  [ inf_results ] .",
    "the results in table  [ affinity_table ] suggest that our semantic boundary based pixel affinity function yields better semantic segmentation results compared to the commonly - used color based affinities .",
    "we note that we also compared the results of our inference technique using other edge detectors , notably ucm  @xcite and hfl  @xcite . in comparison to ucm edges",
    ", we observed that our boundaries provide @xmath11 and @xmath12 according to both evaluation metrics respectively .",
    "when comparing our boundaries with hflmethod , we observed similar segmentation performance , which suggests that our method works best with the high quality semantic boundaries .",
    "additionally , we also present semantic segmentation results for both of the metrics ( pp - iou and pi - iou ) in table  [ pp_iou ] . in this comparison ,",
    "all the techniques use the same fcn unary potentials .",
    "additionally , all inference methods except dense - crf use our affinity measure ( since the previous analysis suggested that our affinities yield better performance ) .",
    "we use bnf - sb to denote the variant of our method that uses only semantic boundary based affinities .",
    "additionally , we use bnf - sb - sm to indicate the version of our method that uses both boundary and _ softmax_-based affinities ( see eq .  ) .    based on these results",
    ", we observe that our proposed technique outperforms all the other globalization methods according to both metrics , by @xmath13 and @xmath14 respectively .",
    "additionally , these results indicate that most benefit comes from the semantic boundary affinity term rather than the _ softmax _ affinity term .    in fig .",
    "[ ss ] , we also present qualitative semantic segmentation results . note that , compared to the segmentation output from the _ softmax _ layer , our segmentation is much better localized around the object boundaries . additionally , in comparison to dense - crf predictions , our method produces segmentations that are much spatially smoother .",
    "we can also label our boundaries with a specific object class , using the same classification strategy as in the hflsystem  @xcite .",
    "since the sbd dataset provides annotations for semantic boundary classification , we can test our results against the state - of - the - art hfl  @xcite method for this task . due to the space limitation",
    ", we do not include full results for each category .",
    "however , we observe that our produced results achieve mean max f - score of @xmath15 ( averaged across all @xmath10 classes ) whereas hflmethod obtains @xmath16 .",
    "in this work we introduced a boundary neural field ( bnf ) , an architecture that employs a semantic segmentation fcn to predict semantic boundaries and then uses the predicted boundaries and the fcn output to produce an improved semantic segmentation maps a global optimization .",
    "we showed that our predicted boundaries are better suited for semantic segmentation than the commonly used low - level color based affinities .",
    "additionally , we introduced a global energy function that decomposes semantic segmentation into multiple binary problems and relaxes an integrality constraint .",
    "we demonstrated that the minimization of this global energy allows us to predict segmentations that are better localized around the object boundaries and that are spatially smoother compared to the segmentations achieved by prior methods .",
    "we made the code of our globalization technique available at http://www.seas.upenn.edu/~gberta/publications.html .",
    "the main goal of this work was to show the effectiveness of boundary - based affinities for semantic segmentation .",
    "however , due to differentiability of our global energy , it may be possible to add more parameters inside the bnfs and learn them in a front - to - end fashion .",
    "we believe that optimizing the entire architecture jointly could capture the inherent relationship between semantic segmentation and boundary detection even better and further improve the performance of bnfs .",
    "we will investigate this possibility in our future work .",
    "this research was funded in part by nsf award cns-1205521 ."
  ],
  "abstract_text": [
    "<S> the state - of - the - art in semantic segmentation is currently represented by fully convolutional networks ( fcns ) </S>",
    "<S> . however , fcns use large receptive fields and many pooling layers , both of which cause blurring and low spatial resolution in the deep layers . as a result fcns tend to produce segmentations that are poorly localized around object boundaries . </S>",
    "<S> prior work has attempted to address this issue in post - processing steps , for example using a color - based crf on top of the fcn predictions . however , these approaches require additional parameters and low - level features that are difficult to tune and integrate into the original network architecture . additionally , most crfs use color - based pixel affinities , which are not well suited for semantic segmentation and lead to spatially disjoint predictions .    to overcome these problems , </S>",
    "<S> we introduce a boundary neural field ( bnf ) , which is a global energy model integrating fcn predictions with boundary cues . </S>",
    "<S> the boundary information is used to enhance semantic segment coherence and to improve object localization . </S>",
    "<S> specifically , we first show that the convolutional filters of semantic fcns provide good features for boundary detection . </S>",
    "<S> we then employ the predicted boundaries to define pairwise potentials in our energy . </S>",
    "<S> finally , we show that our energy decomposes semantic segmentation into multiple binary problems , which can be relaxed for efficient global optimization . </S>",
    "<S> we report extensive experiments demonstrating that minimization of our global boundary - based energy yields results superior to prior globalization methods , both quantitatively as well as qualitatively . </S>"
  ]
}