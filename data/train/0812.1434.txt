{
  "article_text": [
    "a spectrum produced by a dispersing element , usually a prism or a grism , without a slit or slitlets has a number of characteristics that require specialized data reduction tools .",
    "slitless spectroscopy is primarily a survey tool , since the spectra of all objects within a given area defined by the telescope - instrument - detector combination are recorded .",
    "while this survey aspect brings advantages , it also has some drawbacks .",
    "there can be no prior selection of target objects , and contamination , which is an overlapping of spectra , occurs frequently .",
    "the lack of defining slits implies that for extended objects the spectral resolution is controlled by the object size , more specifically the component of the object size in the dispersion direction .",
    "moreover the shape of the objects , which in general are not aligned with the dispersion direction , must be taken into account during the spectral extraction . since in slitless",
    "spectroscopy each pixel can receive radiation of any wavelength ( within the sensitive range of the instrument ) , special techniques for flat - fielding and fringing are required .",
    "acs / wfc & g800l & @xmath0 & @xmath1 & @xmath2 + acs / hrc & g800l & @xmath0 & @xmath3 & @xmath4 + acs / hrc & pr200l & @xmath5 & 20[@2500 ] & @xmath4 + acs / sbc & pr130l & @xmath6 & 7[@1500 ] & @xmath7 + acs / hrc & pr110l & @xmath8 & 10[@1500 ] & @xmath7 + nicmos / nic3 & g141 & @xmath9 & 80.0 & @xmath10 + wfc3/uvis & g280 & @xmath11 & 13.0 & @xmath12 + wfc3/ir & g102 & @xmath13 & 25.0 & @xmath14 + wfc3/ir & g141 & @xmath15 & 47.0 & @xmath14 +    slitless spectroscopy has been employed for surveys from the ground such as for the hamburg / eso objective - prism survey survey @xcite , the uk schmidt telescope ( clowes et al .  1980 ; hazard et al .  1986 ) and the quasars near quasars survey @xcite .",
    "early efforts to use this technique for the determination of stellar radial velocities are described in @xcite . however , the strong disadvantage of slitless spectroscopy from the ground is the high background , since the lack of a slit implies that each pixel receives the full transmission of the dispersing element .",
    "the background can be reduced by choosing a high resolving power disperser or adding a narrow band filter to the light path , such as for emission line studies on known lines ( e.g. salzer et al .",
    "2000 ; jangren et al .",
    "2005 ) .",
    "deep slitless surveys from the ground , such as searches for high redshift galaxies at @xmath16 , are still valuable ( see kurk et al .",
    "2004 ) , however space based observations are particularly effective , since the background is many orders of magnitude lower than from earth and there are no strong and variable atmospheric absorption and emission components . for the hubble space telescope ( hst ) , the high spatial resolution ( through lack of atmospheric seeing ) brings a further gain , since the background contribution to the extracted spectrum is reduced .",
    "although the background in slitless mode is larger by the ratio of the spectrum length to the slit width with respect to slit spectroscopy , hst slitless spectroscopy can challenge the faint limits of ground - based telescopes ( e.g. * ? ? ?",
    ".    surveys with hst in slitless mode have included the nicmos / hubble space telescope grism parallel survey of h@xmath17 emission line galaxies in the redshift range 0.7 to 1.9 with the g141 grism @xcite ; the space telescope imaging spectrograph parallel survey ( gardner et al.1998 ; teplitz et al .",
    "2003 ) of [ o  ii ] and [ o  iii ] emission line galaxies @xmath18 ; and the advanced camera for surveys grapes study of the ultra - deep field @xcite with , for example , detection of ly-@xmath17 and lyman - break galaxies to @xmath19 @xcite ; the pears survey in the goods north and goods south fields @xcite and searches for high - z supernovae to @xmath20 ( riess et al .",
    "2004 ; strolger et al .",
    "2004 ) .",
    "after exploratory attempts to use standard spectral extraction tasks in public data reduction packages ( e.g. , iraf , idl and midas ) for slitless spectroscopic data , it was decided to develop a dedicated extraction package.these standard packages encapsulate an enormous amount of expertise for slit spectroscopy .",
    "however the lack of solutions for specific problems in slitless spectroscopy together with the demand for the processing of hundreds to thousands of spectra per image mandated a dedicated software package .",
    "this software package , called axe , was originally developed for advanced camera for surveys ( acs ) grism and prism spectroscopy ( see table [ spec_modes ] and pasquali et al .",
    "however by design axe was intended to be instrument - independent , and this aim was achieved by placing all the instrument specific parameters into a single data file called a _ configuration file_. in addition to acs , axe has subsequently been successfully applied to nicmos slitless data @xcite and data obtained during the ground calibration campaigns of wide field camera 3 ( wfc3 , bond et al .",
    "2007 , kuntschner et al . 2008b",
    "; see also table [ spec_modes ] ) .",
    "this paper is devoted to a description of the axe spectral extraction package .",
    "axe does _ not _ work like a data reduction pipeline , which has a static set of products as output .",
    "depending on the data and the scientific questions to be answered , the user can reduce the data following different recipes and methods , and the subsequent sections illustrate all the methods and techniques implemented in the current version axe-1.6 .",
    "section [ sect : axe_strat ] is devoted to the extraction of spectra from an individual slitless image .",
    "section [ sect : contamination ] explains the various techniques to treat the contamination problem , followed by the introduction of a 2d - resampling technique which aims at co - adding individual spectra of the same object in section [ sect : axedrizzle ] .",
    "the axe implementation of optimal weighting is illustrated in section [ optimal_weighting ] , followed by a discussion of the effects of detector fringing ( section [ sect : fringing ] ) .",
    "the structure of axe and related software packages for simulation and visualization are presented in section [ sect_axe_software_package ] .",
    "the paper closes with a summary and options for further refinement of the package .",
    "this section details the axe method to extract spectra from individual slitless images .",
    "axe requires associated direct images for the slitless images to enable data processing .      in slitless",
    "spectroscopy the location of spectra on the detector is defined by the position of the object itself within the field - of - view ( fov ) . therefore , in order to recover the absolute wavelength scale , the position of the object must be known in advance in the reference frame of the slitless image .",
    "although not a fundamental limitation , the presence of a direct image from which the position of the object can be determined is usually taken as a pre - requisite for the reduction of slitless spectra .",
    "in instrumental configurations with a grism as disperser , the 0@xmath21 order spectrum , when available , could be used to provide the zero point of the wavelength scale . however , due to the prism on which the grating is ruled , the 0@xmath21 order appears in practice slightly dispersed which does not favour an accurate position determination .    in order to establish for each object a reference position on the slitless image , axe requires , for each slitless image ( figure [ fig : composit_image ] , panel a ) , a corresponding direct image of the same sky area ( figure [ fig : composit_image ] , panel b ) .",
    "the pointing information as given in the world coordinate system information in the headers of the slitless and direct images allows to transform object positions from the direct images to the slitless images .",
    "the reference positions are then used as the origins of local coordinate systems to describe , for each object , its spectral properties .",
    "axe has been applied to the various hst slitless spectroscopic modes listed in table [ spec_modes ] , which all have different properties , e.g. different descriptions of the trace ( the location of the center of gravity in the spatial direction ) and dispersion . in order to be able to reduce these distinct instrumental modes with axe , all information for a specific mode",
    "is stored in a single _",
    "configuration file_. an axe configuration file contains :    * the data description ( pointers to the science , error and data quality fits image extensions ) ; * the location and extent of the different spectral order(s ) ; * the trace description for the spectral order(s ) ; * the dispersion solution for the spectral order(s ) ; * the names of the calibration files ( flat - field and sensitivity files ) to be used .",
    "the trace description in axe is given as a polynomial : @xmath22 with @xmath23 , the relative distance of the image coordinates @xmath24 from the reference position of an object on the slitless image @xmath25 .",
    "grism dispersion solutions are described as polynomials : @xmath26 with the distance along the trace @xmath27 .",
    "since prisms display quite rapid variation of the spectral dispersion with wavelength , the functional form for the dispersion solution is better described as : @xmath28 around the singularity at @xmath29 the resolution decreases rapidly , causing a pile - up in instrumental configurations such as acs / hrc / pr200l which still have significant sensitivity at the start wavelength of the pile - up @xcite .",
    "all quantities @xmath30 in eqns .",
    "[ eq_trdesc]-[eq_prdisp ] can be given as a 2d field dependent polynomial in order to take variations of the trace description and dispersion solution as a function of object position into account .",
    "this 2d field dependence is caused by field effects and the different geometrical distortion between the direct and the dispersed images .",
    "the quantity @xmath31 given as a 2d polynomial of order @xmath32 is , for example : @xmath33 where @xmath34 and @xmath35 are the reference object position on the slitless image",
    ".    a thorough description of the axe configuration files and the various quantities declared therein can be found in the axe manual @xcite .",
    "as calibration files axe needs sensitivity files to transform the extracted spectra from detector units ( @xmath36 ) to flux units ( @xmath37 ) and special flat - fields , which are introduced and described in sect .",
    "[ sect : flatfield ] .",
    "the hst instrument science teams conduct dedicated observing programmes to derive calibration files , trace description and dispersion solution in the various slitless modes ( see e.g.  pasquali et al .",
    "2006 ; kuntschner , kmmel & walsh 2008a ) .",
    "axe configuration and calibration files for all supported instruments are available for download on the st - ecf webpages ( ) .       onto the set of spectral bins",
    "@xmath38 $ ] . for the given trace and extraction direction ( gray , thin lines )",
    ", @xmath39 contributes with the weight ( @xmath40 ) @xmath41 to the bins @xmath42 .",
    "[ fig : extraction],scaledwidth=45.0% ]    the spectral extraction in axe aims at avoiding multiple rebinning of the pixels and processes the data from detector to the 1d spectra in a direct manner .",
    "this is achieved by tying the spectral information to the pixels . in detail",
    ", the axe extraction of a single object spectrum from a slitless image involves the following steps :    1 .   on the basis of the reference position ,",
    "the local trace and dispersion solutions are determined ; 2 .",
    "the extraction geometry ( the direction of constant wavelength and slit width , see sect .",
    "[ sect : extr_geom ] ) and the extraction area are determined ; [ ext_one ] 3 .   for each pixel @xmath39 in the extraction area , the distance to the trace in the cross - dispersion direction ,",
    "the distance along the trace and the effective wavelength associated to the pixel are computed ; 4 .",
    "each pixel @xmath39 is flat - fielded according to its associated wavelength ( see sect .",
    "[ sect : flatfield ] ) ; 5 .",
    "a set of spectral bins @xmath43 $ ] is created .",
    "each bin @xmath44 covers the wavelength range @xmath45 \\label{eqn : lambda}\\end{aligned}\\ ] ] where @xmath46 is the grism or prism dispersion solutions given in eqns .",
    "[ eq_grdisp ] and [ eq_prdisp ] .",
    "the sequence of integer numbers @xmath47 is chosen such that the entire sensitive wavelength range of the instrument is covered ; 6 .",
    "the area of each pixel @xmath39 is projected onto the set of spectral bins @xmath44 in order to determine the fractional contributions @xmath48 . as can be seen in figure [ fig : extraction ] , the quantities @xmath48 are usually @xmath49 for all except a few bins .",
    "the extraction or cross - dispersion direction is optimized for each object ( see sect .",
    "[ sect : extr_geom ] ) and is , as shown in fig .",
    "[ fig : extraction ] , not necessarily perpendicular to the trace ; 7 .   the spectrum value of the spectral bins with _ non - zero _ contributions @xmath48 are re - calculated using weighted summation @xmath50 where @xmath51 , @xmath52 and @xmath53 , @xmath54 are the new and old values for the spectrum value and weight for bin @xmath47 , respectively and @xmath55 is the spectral flux in pixel @xmath39 . [ ext_seven ]    after the extraction the spectral bins for each object , ordered in wavelength , are written to a fits table @xcite .",
    "these resulting spectra contain for each spectral bin the wavelength @xmath56 , the extracted spectrum in @xmath57 $ ] , the error in @xmath57 $ ] , the flux in @xmath37 , the flux error and the total weight .",
    "the wavelength values , although derived from spectral bins @xmath44 which have associated wavelength ranges as described above , are _ not _ just assigned the mean value of the spectral bins @xmath46 ( see eqn .  [ eqn : lambda ] ) , but are computed using weighted summation as in eqns .",
    "[ eqn : weight ] and [ eqn : wsum ] ( with @xmath58 , the effective wavelength associated to pixel @xmath59 , instead of @xmath55 ) .",
    "the error for each spectral bin is computed by propagating the initial error for each detector pixel through all axe reduction steps using basic error propagation .",
    "if not explicitly given in an image extension of the slitless image , axe derives an error image on the fly , using a typical detector noise model ( readout noise and photon shot noise ) .",
    "the total weight of a spectral bin is the co - added area of its pixel contributions .",
    "since axe does not use pixels which are marked as defective , the weights for a spectral bin can vary . for hst images , such bad pixels",
    "( e.g. dead pixels or pixels affected by cosmic rays ) are indicated by the value of the data quality image extension .       and",
    "@xmath60 and the angle @xmath61 , here defined with respect to the dispersion or trace direction .",
    "the quantities @xmath62 and @xmath63 are the projection of the major and minor half axis onto a plane perpendicular to the trace.[fig : extr_geom],scaledwidth=45.0% ]    every object which produces a slitless spectrum acts as its own _ virtual slit _",
    "( see appendix in freudling et al .",
    "2008 for a detailed discussion ) , which in general is not aligned with the detector grid or the spatial direction of the disperser .",
    "the shape of this virtual slit must be taken into account if a 1d spectrum is to be extracted from the slitless image or a rectified 2d spectrum ( analogous to a long slit spectrum , see sect .",
    "[ sect : axedrizzle ] ) is to be generated . since there is no slit or mask which defines or limits the extraction geometry , the slit orientation and the slit length translate in slitless spectroscopy to the extraction direction ( the direction of equal wavelength ) and the extraction width ( the number of pixels on both sides of the trace which are co - added ) , respectively .",
    "these quantities must be set for each object during the spectral extraction .",
    "axe offers several methods to define the extraction geometry and thus to extract 1d spectra from a slitless image .",
    "most of the methods link the extraction geometry to the object shape in order to optimize the extraction .",
    "figure [ fig : extr_geom ] illustrates the quantities involved in defining the extraction geometry for an arbitrary object . in a very basic model an object is described as a 2d gaussian with major axis size @xmath31 , minor axis size @xmath60 and the orientation of the major axis @xmath64 , which is defined with respect to the trace here .",
    "the projections of @xmath31 and @xmath60 onto the plane perpendicular to the dispersion or trace direction are named @xmath62 and @xmath63 , respectively . for this object shape ,",
    "axe offers spectral extraction with :    1 .   a fixed extraction width @xmath65 given by the user and an extraction direction perpendicular to the dispersion direction ; [ seq : case_one ] 2 .",
    "a variable extraction width scaled as @xmath66 ( @xmath67 given by the user ) and an extraction direction perpendicular to the dispersion direction ; 3 .",
    "a variable extraction width scaled as @xmath68 ( @xmath67 given by the user ) and an extraction direction parallel to @xmath31 ; [ seq : case_three ] 4 .",
    "as in [ seq : case_three ] , but switching to @xmath69 and an extraction direction parallel to @xmath60 if @xmath70 .",
    "[ seq : case_four ]    depending on the science case the user may prefer a specific extraction method , e.g ( [ seq : case_one ] ) if the primary targets are point - like or ( [ seq : case_four ] ) in a typical survey situation with galaxies of differing sizes and random orientation .       for all wavelengths .",
    "[ fig : hrcff],scaledwidth=50.0% ]    flat - fielding is an essential data reduction step in creating scientific quality images of uniform sensitivity . in direct imaging , flat - fields for each filter",
    "are constructed using homogeneously illuminated images , and a single flat - field correction yields equal sensitivity .",
    "these direct imaging flat - fields are valid for radiation in the restricted passband defined by the combination of optical elements .",
    "a slitless spectrum , however , can occur anywhere on the detector , and the flat - field correction has to be performed for each pixel as a function of incident wavelength ; this leads to the use of a flat - field cube whereby the wavelength behaviour of the flat - field is described for each pixel by the 3@xmath71 dimension in addition to the two spatial dimensions of the detector . to characterize the wavelength dependent behaviour ,",
    "a series of direct image flat - fields taken at various central wavelengths is used .    for acs",
    ", we decided to combine the wavelength information in all direct image flat - fields by fitting a polynomial to the series of wavelength dependent flat - field values for each pixels .",
    "the flat - field cube then contains the polynomial coefficients in the third dimension .",
    "this method is applicable for the acs slitless modes since the variation of the flat - field as a function of wavelength is smooth @xcite .",
    "there are several reasons why the flat - field cube derived from direct image flats only does not provide a perfect correction .",
    "the large scale flat - field characteristic of the grisms and prisms is likely somewhat different from that of the direct image flats used to generate the flat - field data cube .",
    "moreover the direct image flat - fields produce a flat image for a homogeneously illuminated image of the sky , but the plate scales and hence the effective pixel size vary significantly from one corner of the detector to another @xcite .    in order to correct for these additional , field dependent effects",
    "it is necessary to apply an empirical large scale correction to the flat - field cube , which is determined from observations of a flux standard star at various detector positions .",
    "the final flat - field cube allows the application of a single sensitivity curve for the conversion to absolute flux units which is independent of the object positions .",
    "a detailed description on flat - fielding in slitless spectroscopy and a discussion on the use of the available direct image flats is given in @xcite .",
    "figure [ fig : hrcff ] shows a representation of the acs hrc / g800l flat - field cube .",
    "its sub - panels show the four layers with the polynomial coefficients as indicated in the labels .",
    "the flat - field value for the pixel @xmath72 , which is exposed to light of wavelength @xmath73 is computed as @xmath74 where @xmath75 is the coefficient from the @xmath76 layer of the flat - field cube , @xmath34 the normalized wavelength , @xmath77 and @xmath78 and @xmath79 are the minimum and maximum wavelengths of the direct image flat - fields used in constructing the slitless flat - field cube , respectively .",
    "figure [ fig : ffpixels ] illustrates the flat - field as a function of @xmath56 for two selected pixels on the acs / wfc ccd # 1 .",
    "the symbols show the values from the direct image flats taken through the acs filters for a @xmath80 binned region , with the rms on the mean as errors .",
    "the lines show the polynomial fits to the the data and thus the wavelength dependent flat - field correction which is applied to the data values measured in these two pixels .",
    "axe has two different methods to handle the background emission from the sky .",
    "the first method incorporates a _ global _ background subtraction before starting the extraction process , the second uses _ local _ sky background estimates .",
    "further enhancements to the basic methods described here , e.g. applying a 2d correction to the master sky when the background shape differs @xcite , are possible .",
    "the method of removing a global sky background uses a 2d master sky image which is automatically scaled to the background level of each individual slitless image . when determining the scaling factor , pixels on and close to the spectral traces are masked out in order to prevent an overestimate of the background level .",
    "the spectral extraction is then conducted after subtracting the scaled master background from the slitless images .",
    "master sky images can be generated by e.g. combining multiple slitless images with a rejection algorithm which excludes pixels dominated by object spectra .",
    "the local background estimate uses the background pixel values close to the spectral traces to determine individual background levels . for each pixel which is part of an object spectrum ,",
    "a background value is determined by interpolating between the user - defined number of adjacent background pixels .",
    "figure [ fig : composit_image ] shows the cutout of a local background image in panel c. interpolated background pixels are visible at the position of the spectra , the background pixels used for the interpolation remain unchanged , and pixels neither part of a spectrum nor used as background appear white .",
    "the local background subtraction can even be applied in addition to the global background .",
    "such a procedure is useful in slitless modes such as nicmos g141 , which display temporal variations of the background ( see freudling et al .",
    "2008 ) .",
    "the axe approach to extract spectra is different from the long slit or multi - slit approaches .",
    "the method of equipping the pixels with spectral information ( e.g. wavelength , trace distance , see sect .",
    "[ sect : spec_extr ] ) and then filling them into initially empty spectral bins has several advantages .",
    "firstly , the re - use of an individual pixel in several spectra , which is necessary in regions of spectral overlap , is straight forward .",
    "several wavelength values @xmath81 are given to the pixel @xmath82 when co - added to the spectra of the sources @xmath83 .",
    "secondly , the virtual slits defined by the objects themselves can be flexibly addressed via the various geometrical methods of attributing wavelength values to the pixels ( sect .",
    "[ sect : extr_geom ] ) .",
    "hence axe is well equipped to adjust to the variety of object morphologies encountered in typical survey scenarios .",
    "thirdly , the techniques used in the axe spectral extraction are geometrical descriptions ( e.g. for the trace and wavelength solutions or attributing wavelength values to the pixels ) and weighted summation ( when co - adding pixels to the spectra ) , which both are rather simple and mathematically well described .",
    "in slitless spectroscopy an overlap of spectra occurs very frequently .",
    "this overlap is generally referred to as contamination , as it complicates the task of extracting a clean spectrum of a given single object . there",
    "exist several types of contamination .",
    "firstly , objects close in the spatial direction can cause contamination . such contamination can also occur in spectroscopy with slits or masks . secondly",
    ", objects that are well - separated on the sky can still contaminate each other in the dispersion direction . in spectroscopy with masks ,",
    "such contamination is avoided by a careful object selection or , equivalently , mask design .",
    "thirdly , for grism dispersers",
    "( e.g. acs / g800l , nicmos / g141 ) many spectral orders ( @xmath84 , @xmath85 , @xmath86 , @xmath87  ) are typically visible in the fov of the detector , and contamination can occur across different spectral orders at distances of several hundred pixels .",
    "contamination is impossible to avoid in typical slitless spectroscopy observations at optical / nir wavelengths , such as the hst slitless modes",
    "acs / wfc / g800l , acs / hrc / g800l , nicmos / g141 .",
    "consequently , the data reduction software must be able to collect and process contamination information in order to deliver data that can be interpreted scientifically .",
    "axe handles contamination in two different ways @xcite .",
    "both use predictions based on the knowledge of the source positions . the so called _ geometrical contamination _",
    "scheme simply records which spectral bins are affected by contamination . the _ quantitative contamination _ scheme estimates for each spectral bin the contribution from neighbouring sources .      for geometrical contamination the areas that are covered by the various spectral orders of all objects",
    "are marked .",
    "then for every pixel in each spectrum the information on how many other spectra fall on this pixel is processed through the extraction .",
    "the final result is the number of other spectra that fall on the pixels which were combined to a spectral bin .",
    "geometrical contamination is computationally cheap and allows the selection of regions of spectra which are not occupied and therefore contaminated by other spectra .",
    "quantitative contamination aims at computing directly for every spectral bin the contaminating flux from other sources .",
    "this is done by modelling the dispersed contribution of every object to the slitless image .",
    "based on this model information the contaminating flux for each pixel is recorded and processed through the spectral extraction .",
    "the result of quantitative contamination is , for each extracted spectrum , an associated spectrum of the contaminating flux .",
    "axe generates a slitless image model re - using the configuration and sensitivity files from the extraction , which guarantees a symmetry between the extraction and the modelling in quantitative contamination .",
    "the morphological and spectral object properties are derived from the direct images , and axe has two different methods to employ these properties in an _ emission model _",
    ", which are discussed in the next sections .",
    "an even better refinement and better estimates would be expected from an iterative approach which uses the direct image information initially , but then the extracted spectra for more refined contamination estimates .",
    "this procedure , which is computationally intensive and does not necessarily converge , is currently not implemented .",
    "the gaussian emission model approximates the object morphology with 2d gaussians , whose major and minor axes and position angle are already available in the spectral extraction ( see sect .  [",
    "sect : extr_geom ] and fig .",
    "[ fig : extr_geom ] ) .",
    "as spectral energy distribution this emission model uses one or , if available , several ab - magnitudes at different wavelengths measured on the associated direct images . beyond the wavelength range covered by the ab - magnitudes the object spectra or spectral energy distributions are extended as flat in @xmath88 .",
    "figure [ fig : composit_image]d shows the slitless model generated for quantitative contamination using the gaussian emission model .",
    "the fluxcube emission model derives both the object morphologies and the spectral information directly from the direct images . for this purpose",
    "a so called _ fluxcube file _ is generated for each slitless image .",
    "such a fluxcube file is a multi - extension fits image which contains at least one corresponding direct image cutout , converted to @xmath88 , and a _ segmentation image_. the segmentation image , essential to avoid self - contamination , marks the pixels contributing to each object .",
    "the values of the pixels on which an object in the associated source catalogue was detected contain the object index .",
    "a segmentation image is easily produced by sextractor @xcite ( parameter checkimage_type segmentation ) .",
    "as for the gaussian emission model , the fluxcube emission model extends the object spectra as flat in @xmath88 .",
    "figure [ fig1:quantcont ] illustrates how quantitative contamination aids in the interpretation of extracted spectra .",
    "the two panels show source spectra ( solid lines ) and quantitative contamination information ( dotted lines , gaussian emission model ) for two objects extracted from hst acs / wfc / g800l slitless data .",
    "the upper source ( named _ id4245 _ internally ) has a strong emission line at @xmath89 , and the lower ( _ id1785 _ ) two emission features at @xmath90 and @xmath91 .",
    "the geometrical contamination scheme raises the contamination flag for all spectral bins in both spectra .",
    "the quantitative contamination scheme is able to estimate for the upper spectrum a negligible contamination from other sources and for the lower spectrum at least a strong contributions from neighbouring objects to both emission features .",
    "the two spectra in fig .",
    "[ fig1:quantcont ] clearly demonstrate the need for quantitative contamination information .",
    "this is especially essential for deep slitless surveys such as grapes @xcite , where contamination by @xmath84 orders often resembles emission lines ( as in _ id1785 _ ) and a reliable distinction is essential .",
    "the basic data necessary to extract slitless spectra with axe ( slitless images plus associated direct images ) already allows the usage of quantitative contamination with little extra effort .",
    "a limitation of quantitative contamination is the emission model , and particularly its spectral part .",
    "the crude approximation of the object spectra with often only a single data point in flux space can still lead to large differences between the contamination estimate and the actual contamination in the spectra .",
    "e.g. an examination of the spectra _",
    "id1785 _ in fig .",
    "[ fig1:quantcont ] reveals that the contamination estimate is @xmath92 to @xmath93 times lower than the excess in flux at @xmath90 .",
    "a better wavelength coverage with more direct images yields better contamination estimates .",
    "as in direct imaging , a typical slitless spectroscopic dataset taken with hst usually consists of several images of the same region on the sky with only small shifts or dithers @xcite between them . the basic axe extraction discussed in sect .",
    "[ sect : axe_strat ] is capable of reducing all objects from every slitless image .",
    "however the data for each object must be co - added to obtain deep spectra with high signal - to - noise ratio .",
    "co - added object spectra can be derived by combining the 1d spectra extracted from the individual slitless images .",
    "this approach has some disadvantages .",
    "the data is rebinned twice , once for the spectral extraction and once for combining the spectra .",
    "the procedure requires a complex weighting scheme to take into account masked pixels ( e.g. cosmic ray hits ) and different exposure times for the spectral bins .",
    "information in the spatial direction , e.g. the exact location of an emission feature within an extended source , is lost when combining 1d spectra .",
    "problem detection and error tracking is more difficult in 1d than in 2d .      with _ axedrizzle _ ( kmmel et al .  2004 ; kmmel et al .",
    "2005 ) we have developed and implemented in axe a method of combining the individual , 2d spectra into a deep 2d slitless spectrum , which allows subsequent 1d extraction from the deep image . for 2d - resampling and co -",
    "addition of the individual 2d spectra we use the drizzle software @xcite , which is a standard method of combining hst direct images . with axedrizzle",
    "the re - gridding to a uniform wavelength scale and a cross - dispersion direction orthogonal to the dispersion direction is achieved in a single step .",
    "the weighting of different exposure times per pixel and cosmic - ray affected pixels are correctly handled through the drizzle weights .",
    "the combined 2d spectra can be visually inspected for problem detection .",
    "they reveal fainter features in the spatial direction not detectable in single images ( see e.g rhoads et al .",
    "2004 ) and can be used for finding emission line regions in larger , extended objects .      ]    as an example , figure [ fig1:axedrizzle ] illustrates the axedrizzle procedure for acs / hrc g800l data from the hubble ultra deep field ( hudf ; proposal i d 9803 , p.i : beckwith ; + ) parallels observations for one object . the upper panel in fig .",
    "[ fig1:axedrizzle ] shows the cutout image for one object in one grism image , assembled from the flat - fielded pixels . in the @xmath94 slitless images of the entire dataset ,",
    "the object is located at different positions , which leads to small variations in trace angle , dispersion solution and image distortions . for each of the @xmath94 observations of this object",
    "individual drizzle coefficients are determined which , via the drizzle process , lead to individual 2d grism images , such as fig .",
    "[ fig1:axedrizzle]b , with zero trace angle , a linear , pre - defined dispersion solution and an extraction direction perpendicular to the trace .",
    "axedrizzle allows the user to select a specific interpolation kernel for the drizzle routine in the configuration file .",
    "the final 1d spectrum is extracted from the co - added 2d slitless stamp image fig .  [ fig1:axedrizzle]c , which has a combined exposure time of @xmath95 .    .",
    "for @xmath96 ( lower panel ) the contaminating @xmath84 order spectra from other sources are clearly visible.[fig1:gristamp],scaledwidth=50.0% ]    to illustrate the advantages of axedrizzle , figure [ fig1:gristamp ] shows the axedrizzle combined , deep 2d slitless images corresponding to the spectra in fig .",
    "[ fig1:quantcont ] .",
    "the re - sampled image confirms the intrinsic origin of the emission line feature for the source _",
    "id4245 _ in the upper panel and even indicates the presence of additional emission lines . in the lower panel , it is obvious that the object _ id1785 _ itself has a smooth spectrum .",
    "both emission features arise solely from two bright , offset spots , which are identified as contaminating zeroth order spectra from two different objects .",
    "besides the main science information , axedrizzle also processes other data such as the errors , contamination ( see figs .",
    "[ fig1:quantcont ] and [ fig1:gristamp ] ) and weights ( for optimal weighting , see sect .  [ optimal_weighting ] ) .",
    "all data is stored in the layers of the deep 2d slitless stamp , which is a multi - extension fits image , and used in the 1d extraction . as in the original drizzle method , the weight image is composed as one image extension which reflects the total exposure time for each pixel .",
    "the 2d resampling and co - adding in axedrizzle introduces correlated errors between neighboring pixels .",
    "however in @xcite it was shown that the independently processed noise from axedrizzle is in good agreement with empirical noise estimates derived from der_snr @xcite .",
    "this confirms not only the accuracy of the errors from axedrizzle but also justifies their further use , e.g. in optimal weighting ( sect .",
    "[ optimal_weighting ] ) .",
    "local background estimates are processed by axedrizzle in the same way as the object data , and for each deep 2d slitless stamp a deep 2d background stamp image is generated from the local background estimates on the individual images . as in the processing of individual slitless images ( sect .",
    "[ sect : background ] ) , the background subtraction is done during the 1d extraction of the spectra .    only the 2d combining of the first order spectra is currently implemented in axedrizzle . in all grism modes supported by axe",
    ", the sensitivity contrast between the first and all higher orders is very large , and the focus on the first order does not imply an important loss of scientific content which the slitless data contains .",
    "apart from dithering , hst slitless data can also be observed with different roll angles , which translates to a different orientation of the traces on the sky .",
    "certainly the simple method of co - adding 1d spectra ( sect .",
    "[ sect : coadd_indiv ] ) , but also axedrizzle , is capable of combining such data . as well as the spectra",
    ", the individual contamination patterns , which usually change for significant roll angle differences , are combined . in general , this leads to combined spectra with larger and more complex contamination . also care must be taken when combining data of extended objects , since the object size in the spectral direction , and thus the spectral resolution , varies for significant roll angle differences .",
    "in addition , more complex objects , such as late - type galaxies with hii regions , can display very different spectra at different roll angles . for point sources ,",
    "however , it is possible to combine the contamination - free parts of the data only and to derive contamination free spectra .",
    "the optimal weighting technique , originally introduced by @xcite and @xcite , aims to enhance the signal - to - noise ratio of spectra by attributing lower weights to pixels which contain only a small fraction of the object flux .",
    "the basic equation of the spectral extraction using optimal weights is ( see e.g.  rodriguez - pascual et al .  1999 ) : @xmath97*\\frac{p(x,\\lambda)}{\\sigma(x,\\lambda)^2}}{\\sum_x \\frac{p(x,\\lambda)^2}{\\sigma(x,\\lambda)^2 } } \\label{opt_noise}\\end{aligned}\\ ] ] where @xmath34 is the coordinate in spatial direction , @xmath56 the coordinate in the spectral direction , @xmath98 the data value at pixel @xmath99 , @xmath100 the background value at pixel @xmath99 , @xmath101 the noise value at pixel @xmath99 , @xmath102 the extraction profile at pixel @xmath99 and @xmath103 the extracted data value at @xmath56 .    in the original descriptions of optimal weighting ,",
    "the extraction profile @xmath102 is computed from the object spectrum itself . for several reasons",
    "this approach is not generally applicable in slitless spectroscopy .",
    "the signal - to - noise ratio of the sources is often too low to determine an individual extraction profile .",
    "the contamination phenomenon does not permit an automatic and reliable generation of extraction profiles for all sources .",
    "an iterative approach on the sometimes hundreds or even thousands of spectra on an acs slitless image would require too much computing time . also averaging the profile in the spectral direction does not give representative results for special object classes , e.g. sources with emission lines .",
    "in axe we have developed an optimal weighting which is robust and practical for all sources .",
    "to compute extraction profiles , the optimal weighting in axe uses the models for the dispersed objects , which were introduced in sect .",
    "[ sect : quantcont ] as the basis of the slitless models and hence the quantitative contamination technique .",
    "the source - specific models computed from the direct image ( using either the gaussian or the fluxcube emission model ) are a good basis for calculating the quantity @xmath102 in eqn .",
    "[ opt_noise ] .",
    "the 2d models are also used as an input to calculate the pixel errors @xmath101 according to the typical detector noise model : @xmath104 where @xmath105 and @xmath106 are the 2d model value at pixel @xmath99 and the detector readout noise , respectively .",
    "optical interference in a ccd occurs between incident light and that back - reflected from the thin multi - layer structure . in a back - illuminated ccd ,",
    "if the detection layer becomes transparent , the contribution of the reflected light can become a large fraction of the incident power .",
    "the result is a modulation of the signal by fringes whose amplitude depends on the optical properties of the layers . the level of fringing and its behaviour with wavelength is dependent on the number of layers of the ccd , their thicknesses and refractive indices .    in imaging and slit spectroscopy fringe maps are used to correct for the detector fringing . in the case of slitless spectroscopy , parallel to the case for flat - fielding ,",
    "each pixel can receive light of any wavelength over the passband of the instrument , and the fringe map must be replaced by a cube . in practice maps of the individual layer thicknesses , together with their optical properties , are used together with a simple geometrical optics model to predict the fringe amplitude for all pixels for any wavelength .",
    "@xcite applied this technique to the stis site ccd and an analogous procedure was developed for the acs wfc and hrc detectors @xcite .    from a set of monochromatic flat - fields over the range of significant fringing",
    ", the fresnel equations can be solved in terms of the thickness of the ccd layers , adopting tabulated refractive indices for the layer materials @xcite . in order to correct for the fringing at a given pixel in a slitless spectrum , the wavelength extent of each pixel ( given by the position of the dispersing object and the dispersion solution ) ,",
    "the ccd thicknesses for that pixel and the respective refractive indices are used to compute the observed fringing of that pixel .",
    "the correction of the fringe amplitude affecting a slitless spectrum has been incorporated into the axe software and @xcite present the application to acs slitless spectra .",
    "besides the ccd structure , an important input for the fringe calculation is the form of the throughput function for the ccd pixels .",
    "the pixel throughput function is defined as the relative distribution of light as a function of wavelength falling onto a given ccd pixel . in general",
    "this is the convolution of the intrinsic source spectrum with the line spread function ( lsf ) of the instrument .",
    "the determination of the throughput function and the computation of the fringing amplitudes would thus require the a priori knowledge of the source spectrum , which in general is not available .",
    "however for continuum sources and the theoretical case of pure emission line objects ( an object with a spectrum that consists only of a single , narrow emission line ) the throughput function can be estimated .    for continuum sources the lsf dominates the form of the throughput function everywhere and the influence of the slowly varying source spectra can be neglected . using a gaussian with 100  full width at half maximum height ( fwhm ) as lsf ( similar to the spectral resolution ,",
    "see kuntschner , kmmel & walsh 2008a ) the acs wfc requires a maximum fringe correction of 0.1% .",
    "this is negligible in comparison with other sources of error ( photon noise , flux calibration errors ) .    for pure emission line sources the throughput function",
    "is solely determined by the intrinsic object spectrum , thus amplitudes of 12% as measured in the monochromator data @xcite and even higher are possible . while such variations could be detected , in practice the intrinsic line broadening in the spectrum",
    "dilutes the fringe signal . as an example",
    ", line flux variations of @xmath107 were detected among a set of wolf - rayet star observations with acs wfc / g8000l @xcite .",
    "if the emission line source is extended , then mixing of wavelengths in the resulting slitless spectrum will even further dilute the detected fringe amplitude .",
    "the axe extraction software is available for download . in this section",
    "we describe the operational system of version 1.6 , together with two related software packages which are used to simulate and visualize slitless data .",
    "axe is distributed to be installed and loaded as a local iraf / pyraf package ( ) .",
    "moreover it is embedded into the stsdas ( ) software package which is distributed by the space telescope science institute ( stsci ) .",
    "the axe software package is written in ansi c and python it uses the third party libraries cfitsio @xcite , gsl @xcite and wcstools @xcite and is portable between unix platforms .",
    "the axe software is split up into several tasks , which perform all the necessary steps to extract spectra from slitless images .",
    "there exist two different classes of axe tasks .",
    "low level tasks _ operate on individual images , and all input and output refers to a particular image .",
    "_ high level tasks",
    "_ operate on datasets , which usually consist of several slitless images and their associated direct images taken in the same area of the sky .",
    "some preparatory steps are required before spectra can be extracted .",
    "these steps mostly deal with generating input source lists from the direct images in the dataset .",
    "the direct images are usually co - added to enhance the signal - to - noise ratio and to remove pixel defects and cosmics . for hst data , this step is generally performed using the multidrizzle software @xcite .",
    "an object detection algorithm , e.g. sextractor @xcite , is run on the co - added direct image . besides detecting the objects , sextractor is also capable to deliver all necessary object parameters such as the positions , gaussian shapes ( for defining the extraction geometry ) and source brightness ( for quantitative contamination ) . using sextractor is not mandatory , however the source lists for axe must be formatted in the same way as a sextractor object list .",
    "the positions of the sources determined on the co - added direct image are first projected back into the coordinate system of each associated direct image , and axe provides a dedicated task to do this step in a typical scenario of a direct image co - added with multidrizzle and a sextractor source list .",
    "then the object positions are projected into the coordinated system of the slitless images as part of the axe extraction .      ) in the nicmos hudf field for the hst / wfc3 g141 grism and f160w filter in the upper and lower panel , respectively .",
    "the wfc3/ir fov is @xmath108.[fig1:axesim],scaledwidth=37.0% ]    the quantitative contamination method introduced in section [ sect : quantcont ] is based on modelling the slitless spectra on input images , either as 2d gaussians ( see fig .",
    "[ fig : composit_image]d ) or object images .",
    "thus , expanding this modeling capability to a full simulation tool was a natural development . rather than adding simulations to axe , an additional pyraf package called axesim ( ; see kmmel , kuntschner & walsh 2007 ) , which uses a number of the capabilities of axe already described , was built as a tool for simulating slitless spectroscopic images plus their associated direct images .",
    "axesim was designed both to assist users planning slitless observations and to aid in the analysis of slitless data , such as for determining detection limits by adding and extracting model spectra on real images . for hst",
    ", axesim is a valuable tool in the phase i and ii proposal preparation process , and its usage has already started in cycle 17 .",
    "a 2d impression of the layout of a target field is provided , which allows assessment of potential problems arising from crowding or spectral overlap . the sensitivity and resolution offered by the various slitless modes",
    "can be explored in 2d , such as for a variety of object morphologies .",
    "the optimal pointing and roll angle can be chosen for a specific target field .",
    "the characterization of the instrument used by axesim through a configuration file is identical to that used by the extraction package axe , thus closing the loop between the simulation and subsequent extraction .    in the most basic form",
    "an object is simulated in the gaussian emission model ( see section [ sect : gaussmodel ] ) by a gaussian shape and one ab - magnitude , transformed and extended as a spectrum flat in @xmath37 . for simulating more realistic objects",
    ", the user can provide 2d image templates for ` real ' object shapes , build more complex spectral energy distributions by specifying magnitude values at different wavelengths or provide high resolution spectra as templates , which are shifted in redshift and scaled in flux to user - provided values .",
    "the basic input for every object is collected in a sextractor - like text table .    as a typical application of axesim , figure [ fig1:axesim ] shows a noise - free simulation of the bright ( @xmath109 ) objects in the nicmos hubble ultra deep field ( thompson et al .",
    "2005 ) for the hst / wfc3 g141 grism and f160w filter in the upper and lower panels , respectively .",
    "the spectral energy distribution of the objects is defined via their ab - magnitudes in the filters acs / wfc / f850lp , nicmos3/f110w and nicmos3/f160w , which all were provided in the original source catalogue .      $ ] and in physical units ( @xmath37 ) , overplotted with the contamination estimate . [ fig1:axe2web],scaledwidth=50.0% ]",
    "a deep slitless image ( e.g. from acs / wfc ) can contain detectable spectra of hundreds to over a thousand objects . to visually inspect them in a fast manner we developed axe2web ( ) , a tool which produces browsable web pages for fast and discerning examination of many hundreds of spectra @xcite .",
    "this additional task to the axe package takes the axe output files and generates linked web pages in html format for all sources .",
    "each object produces a line in a table which lists the reference number , magnitude in the direct image filter , the x and y position of the direct object , its right ascension and declination , a cut - out image showing the direct object , the spectrum stamp image showing the 2d spectrum , a 1d extracted spectrum in counts and the same in flux units , overplotted with the spectrum of the contaminating sources .",
    "figure [ fig1:axe2web ] shows an example of two objects extracted from an acs / wfc / g800l grism dataset as presented by axe2web .",
    "axe is not the only software for extracting hst slitless spectra . for acs / wfc ,",
    "an independent method has been described in @xcite .",
    "multispec @xcite and the extraction method described in @xcite concentrate on stis slitless spectroscopy . quickly after the first release in 2002 , axe developed into the standard reduction package for all acs slitless modes .",
    "the methods implemented in axe specifically for slitless spectroscopy ( e.g. flat - fielding , 2d - resampling with axedrizzle ) have proven to produce science - ready and well calibrated data for a number of large programmes such as grapes @xcite , pears @xcite and searches for high - z supernovae ( riess et al .",
    "2004 ; strolger et al .",
    "2004 ) .    by generating instrument - specific configuration and calibration files ,",
    "axe can also be applied to slitless spectroscopic data from other hst instruments ( e.g. nicmos ) and even from ground based instruments such as the wide field imager ( wfi ) mounted on the eso 2.2-m - telescope . with small modifications",
    ", axe has even been used to successfully reduce data taken with fors2 mxu masks ( see kuntschner et al .",
    "2005 and kmmel et al .",
    "axesim is being used to simulate data for future space missions such as space ( cimatti et al .",
    "2008 ; now renamed to euclid ) and snap ( ) that plan to use slitless spectroscopy .",
    "the ability within axe to automatically extract spectra from slitless data was important in the nicmos hubble legacy archive ( hla ) project @xcite and axe served as the central component of the completely automatic pipeline for hubble legacy archive grism data ( phlag ) ( kmmel et al .  2007 ;",
    "kmmel et al .",
    "2008 ) . due to the modular setup of axe , additional tasks",
    "which handle some features specific to nicmos could comfortably be added in order to achieve optimal results leading to an archive of several thousand near - infrared spectra ( ) .    besides instrument - specific adjustments also the core of the axe extraction software is continually being improved and further developed , with releases of new versions at an approximately annual rate .",
    "new features and developments that are currently being implemented for axe ( versions 1.7 and 1.8 ) and axesim ( version 1.2 ) include spectral extraction based on a slit geometry optimized for slitless spectroscopy and flux conversion which compensates for the size of the direct object ( developed in the nicmos hla project , see freudling et al .",
    "2008 ) ; the identification and exclusion of cosmics and hot pixels within axedrizzle , similar to multidrizzle @xcite in direct imaging ; the integration of axesim into stsdas .",
    "the application of axe to hst data is going to continue with the installation of the wide field camera 3 ( wfc3 , bond et al .",
    "2007 ) with its three slitless spectroscopic modes ( see tab .  [ spec_modes ] ) during servicing mission 4 . as for acs ,",
    "axe is the recommended tool for reducing wfc3 slitless spectroscopic images . from the ground calibration data collected during the thermal vacuum testing , initial axe configuration and calibration files are already available ( kuntschner et al .",
    "2008b and kuntschner et al .",
    "2008c ) that were , for example , used in generating the axesim simulations shown in fig .",
    "[ fig1:axesim ] . improved calibration will result from on - orbit data , enabling axe to extract spectra from all slitless modes of wfc3 .",
    "based on observations made with the nasa / esa hubble space telescope , obtained from the data archive at the space telescope -",
    "european coordinating facility .",
    "+ we would like to thank s.s .",
    "larsen , w. freudling , and m.  demleitner for their respective contributions to axe .",
    "we are grateful to our anonymous referee for the numerous suggestions , which helped to significantly improve this paper .",
    "chen , h.w .",
    ", lanzetta , k.m . & pascarelle , s. , 1999 , in weymann , r. , storrie - lombardi , l. , sawicki , m. , & brunner , r. ( eds . ) , _ photometric redshifts and the detection of high redshift galaxies _ , asp conference series 191 , 217                                      kmmel , m. w. , kuntschner , h. , larsen , s. s. & walsh , j. r. , 2006 , in gabriel , c. , arviset , c. , ponz , d. & solano , e. ( eds ) , _ astronomical data analysis software and systems xv _ , asp conference series 351 , 283      kmmel , m. , albrecht , r. , fosbury , r.f . , freudling , w. , haase , j. , et al . , 2007 , in shaw , r.a . ,",
    "hill , f. , bell , d.j .",
    ", _ astronomical data analysis software and systems xvi _ , asp conference series 376 , 245      kmmel , m. , albrecht , r. , fosbury , r.f .",
    ", freudling , w. , haase , j. , et al . , 2008 , in kaufer , a. & kerber , f. ( eds . ) , _ the 2007 eso instrument calibration workshop _ , eso astrophysics symposia xxviii , 185        kuntschner , h. , bushouse , h. , walsh , j. & kmmel , m. 2008 , hst wfc3 instrument science report 08 - 15 ( baltimore : stsci ) kuntschner , h. , bushouse , h. , walsh , j. & kmmel , m. 2008 , hst wfc3 instrument science report 08 - 16 ( baltimore : stsci ) kurk , j.d . , cimatti , a. , di serego alighieri , s. , vernet , j. , et al .",
    ", 2004 ,  , 422 , l13                                  stoehr , f. , white , r. , smith , m. , kamp , i. , thompson , r. , et al . , 2008 , in argyle , r.w .",
    ", bunclark , p.s . & lewis , j.r .",
    "( eds . ) , _ astronomical data analysis software and systems xvii _ , asp conference series 394 , 505"
  ],
  "abstract_text": [
    "<S> the methods and techniques for the slitless spectroscopy software axe , which was designed to reduce data from the various slitless spectroscopy modes of hubble space telescope instruments , are described . </S>",
    "<S> axe can treat slitless spectra from different instruments such as acs , nicmos and wfc3 through the use of a configuration file which contains all the instrument dependent parameters . </S>",
    "<S> the basis of the spectral extraction within axe are the position , morphology and photometry of the objects on a companion direct image . </S>",
    "<S> several aspects of slitless spectroscopy , such as the overlap of spectra , an extraction dependent on object shape and the provision of flat - field cubes , motivate a dedicated software package , and the solutions offered within axe are discussed in detail . </S>",
    "<S> the effect of the mutual contamination of spectra can be quantitatively assessed in axe , using spectral and morphological information from the companion direct image(s ) . </S>",
    "<S> a new method named axedrizzle for 2d rebinning and co - adding spectral data , taken with small shifts or dithers , is described . </S>",
    "<S> the extraction of slitless spectra with optimal weighting is outlined and the correction of spectra for detector fringing for the acs ccd s is presented . </S>",
    "<S> auxiliary software for simulating slitless data and for visualizing the results of an axe extraction is outlined . </S>"
  ]
}