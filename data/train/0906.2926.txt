{
  "article_text": [
    "the solution of transfer equation in spherical geometry remains a classic problem even 75 years after the first attempts by @xcite , who used eddington approximation . in later decades",
    "more accurate methods were given ( see * ? ? ?",
    "* ; * ? ? ?",
    "* for historical reviews ) .",
    "@xcite , @xcite developed a variable eddington factor method , and computed the solution on rays of constant impact parameter ( tangents to the discrete shells and parallel to line of sight ) in 1d spherical geometry .",
    "this is a very efficient differential equation based technique which uses feautrier solution along rays of constant impact parameter .",
    "an integral equation method was developed by @xcite to solve the problem , again based on tangent rays approach .",
    "@xcite presented a highly accurate finite difference method based on the first order form of the transfer equation .",
    "all these methods were later extended to expanding , and highly extended atmospheres . however , in this paper we confine our attention to static , 1d spherical atmospheres .    in a next epoch in the development of spherical radiative transfer , the integral operator techniques were proposed .",
    "the idea of operator splitting and the use of approximate operators in iterative methods was brought to the astrophysical radiative transfer in planar media by @xcite .",
    "@xcite extended his work with a new definition of the approximate operator .",
    "the application of integral operator technique to the spherical transfer started with the work of @xcite and @xcite .",
    "they used approximate operators that are diagonal , constructed from core saturation approach .",
    "the @xmath0 operator contains the non - local coupling between all the spatial points .",
    "@xcite showed that the diagonal part ( local coupling ) of the actual @xmath0 operator itself is an optimum choice for the ` approximate operator ' .",
    "these methods are known as approximate lambda iteration ( ali ) methods .",
    "the ali methods which are based on the concept of operator splitting and the use of jacobi iterative technique , were widely used in the later decades in radiative transfer theory ( see * ? ? ?",
    "* for historical reviews ) .",
    "@xcite used an implicit integral method to solve static spherical line transfer problems . the most recent and interesting work on spherical radiative transfer",
    "are the papers by @xcite and @xcite both of which are based on gauss - seidel ( gs ) and successive over relaxation ( sor ) iterative techniques .",
    "@xcite were the first to use bicg technique in astrophysics .",
    "they use bicg with incomplete lu decomposition technique in their double splitting iterative scheme along with orthomin acceleration .",
    "they applied it to multi - dimensional line transfer problem .",
    "@xcite describes a variant of orthomin acceleration which uses ` minimization with respect to a set of conjugate vectors ' .",
    "he uses a set of n ( usually n=2 or n=4 ) conjugate direction vectors which are orthogonal to each other , constructed using the residual vectors with a purpose to accelerate the convergence sequence .",
    "@xcite developed gmres ( actually its variant called generalized conjugate residuals gcr ) method to solve the spherical transfer problem .",
    "it is based on an application of the idea of krylov subspace techniques .",
    "they applied it to a more general time - dependent transport with velocity fields in a medium which scatters anisotropically .",
    "they apply gmres method to the neurino transfer .",
    "it can also be used for radiation transfer problem , including the simple problem of 2-level atom line transfer discussed in this paper .    the preconditioned bi - conjugate gradient method ( hereafter pre - bicg ,",
    "see eg . , * ? ? ?",
    "* ) was first introduced to the line transfer in planar media , by @xcite who describe the method and compare it with other prevalent iterative methods , namely gs / sor . in this paper",
    "we adopt the pre - bicg method to the case of spherical media .",
    "we also show that the ` stabilized preconditioned bi - conjugate gradient ( pre - bicg - stab ) ' is even more advantageous in terms of memory requirements but with similar convergence rate as pre - bicg method .",
    "it is well known that the spherical radiative transfer in highly extended systems , despite being a straight forward problem , has two inherent numerical difficulties namely ( i ) peaking of the radiation field towards the radial direction , and ( ii ) the @xmath1 dilution of radiation in spherical geometry . to handle these",
    ", it becomes essential to take a very large number of angle ( @xmath2 ) points and spatial ( @xmath3 ) points respectively .",
    "the existing ali methods clearly slow down when extreme angular and spatial resolutions are demanded ( for example see table  [ table_1 ] ) .",
    "therefore there is a need to look for a method that is as efficient as ali methods , but faster , and is relatively less sensitive to the grid resolution . the pre - bicg method and a variant of it",
    "provide such an alternative as we show in this paper .",
    "governing equations are presented in sect .",
    "[ transfer ] . in sect .",
    "[ geo ] , we define the geometry of the problem and the specific details of griding . in sect .",
    "[ model ] , the benchmark models are defined .",
    "we briefly recall the jacobi , and gs / sor methods in sect .",
    "[ ali ] . in sect .",
    "[ bicg_sphere ] we describe the pre - bicg method .",
    "the computing algorithm is presented in sect .",
    "[ prebicg_alg ] . in sect .",
    "[ prebicg - stab ] we describe the pre - bicg - stab method briefly , and we give the computing algorithm in sect .",
    "[ stab_alg ] . in sect .",
    "[ bicg_ali ] we compare the performance of pre - bicg with the jacobi , and gs / sor methods . in sect .",
    "[ results ] we validate this new method , by comparing with the existing well known benchmark solutions in spherical line radiative transfer theory .",
    "conclusions are presented in sect .",
    "[ conclusions ] .",
    "in this paper we restrict ourselves to the case of a 2-level atom model .",
    "further , we assume complete frequency redistribution ( crd ) .",
    "the transfer equation in divergence form is written as @xmath4\\nonumber \\\\ & & \\times [ \\bm{s}(x , r)-\\bm{i}(r , \\mu , x ) ] .",
    "\\label{transfer_div}\\end{aligned}\\ ] ] here , @xmath5 is the specific intensity of radiation , @xmath6 - the source function , @xmath7 - the radial distance , @xmath2 - the direction cosine , @xmath8 - the frequency measured in doppler width units from line center , @xmath9 - the line profile function , and @xmath10 , @xmath11 - line center and continuum opacities respectively .",
    "the differential optical depth element is given by @xmath12 there are several methods which use the above form of the transfer equation ( see * ? ? ?",
    "in our paper we solve the transfer equation on a set of rays tangent to the spherical shells .",
    "it is written as @xmath13   \\nonumber \\\\ & & \\times [ \\bm{s}(x , r)-\\bm{i}^{\\pm}(z , p , x ) ] ,   \\label{transfer_red}\\end{aligned}\\ ] ] for the outgoing ( + ) and incoming ( - ) rays respectively . here",
    "@xmath14 is the distance along the tangent rays and @xmath15 is the distance from the center to the points on the vertical axis ( the mid - line ) , where the tangent rays intersect it ( see fig .",
    "[ fig_geometry ] ) .",
    "the direction cosines @xmath16 are related to @xmath15 by @xmath17 for a shell of radius @xmath7 .",
    "the optical depth scale along the tangent rays are now computed using @xmath18 . in practical work , due to the symmetry of the problem",
    ", it is sufficient to perform the computations on a quadrant only .",
    "the source function is defined as @xmath19 @xmath20 is the continuum source function taken as the planck function @xmath21 throughout this paper .",
    "the monochromatic optical depth scale @xmath22 $ ] , with @xmath23 along the tangent rays . for simplicity , hereafter we omit the subscript @xmath14 from @xmath24 and write @xmath3 to denote @xmath24 .",
    "the line source function is given by @xmath25 with the thermalization parameter defined in the conventional manner as @xmath26 , where @xmath27 and @xmath28 are collisional and radiative de - excitation rates .",
    "the intensity along the rays is computed using the formal solution integral @xmath29+\\nonumber \\\\ & & \\int_{\\tau}^{t }   \\exp[-\\delta \\tau'_{x } ] \\bm{s}(\\tau')[\\phi(x)+\\beta_{\\rm c}]{\\rm d}\\tau ' . \\label{int_plus}\\end{aligned}\\ ] ] the corresponding integral for the incoming rays is @xmath30+\\nonumber \\\\ & & \\int_{0}^{\\tau } \\exp[-\\delta \\tau'_{x } ] \\bm{s}(\\tau')[\\phi(x)+\\beta_{\\rm c}]{\\rm d}\\tau ' .",
    "\\label{int_minus}\\end{aligned}\\ ] ] here , @xmath31 represents the inner boundary condition imposed at the core and along the mid - vertical line ( see fig .",
    "[ fig_geometry ] ) .",
    "@xmath32 is the outer boundary condition specified at the surface of the spherical atmosphere .",
    "when the above formal integral is applied to a stencil of short characteristic ( mop ) along a tangent ray , it takes a simple algebraic form @xmath33 + \\nonumber \\\\ & & \\bm{\\psi}^{\\pm}_{\\rm m}(\\tau , p , x)\\bm{s}_{\\rm m}+\\bm{\\psi}^{\\pm}_{\\rm o}(\\tau , p , x)\\bm{s}_{\\rm o}+ \\nonumber \\\\ & & \\bm{\\psi}^{\\pm}_{\\rm p}(\\tau , p , x)\\bm{s}_{\\rm p } , \\label{int_sc}\\end{aligned}\\ ] ] where @xmath34 are the source function values at m , o and p points on a short characteristic .",
    "the coefficients @xmath35 are calculated following the method described in @xcite .      in fig .",
    "[ fig_geometry ] , we show the geometry used for computing the specific intensity @xmath36 along rays of constant impact parameter .    in a spherically symmetric medium , we first discretise the radial co - ordinate @xmath7 ( @xmath37 ) , where @xmath38 is the core radius , and @xmath39 is the outer radius of the atmosphere . the radial grid is given by @xmath40 , where @xmath41 is the radius of the outer most shell , and @xmath42 is that of the inner most shell .",
    "@xmath43 is the probability that the direction of propagation of an emitted photon lies within an element of solid angle @xmath44 . in the azimuthally symmetric case ,",
    "it is @xmath45 . to calculate the mean intensity @xmath46 in plane parallel geometry",
    ", we integrate the intensity over the angular variable @xmath47 itself . in spherical medium",
    ", we have one to one correspondence between the ( @xmath2,@xmath7 ) and the ( @xmath15,@xmath7 ) system . in ( @xmath15,@xmath7 ) system , the probability that a photon is emitted with its impact parameter between @xmath15 and @xmath15+@xmath48 , propagating in either positive @xmath2 or negative @xmath2 direction is @xmath49 .",
    "the direction cosines made by the rays in the ( @xmath2,@xmath7 ) space , with a tangent ray of constant @xmath15 value , are given by @xmath50 at different radii @xmath51 .",
    "therefore the angular integration factor @xmath45 can be changed to @xmath49 ( see * ? ? ?",
    "_ the @xmath15 - grid construction _",
    ": if @xmath52 is the number of core rays , then the @xmath15-grid for the core rays is computed using : @xmath53 the number of lobe rays equals the number of radial points . for lobe rays ,",
    "the @xmath15-grid is same as radial @xmath7-grid .",
    "it is constructed using : @xmath54 + where @xmath55=the number of radial points .",
    "thus , the total number of impact parameters is @xmath56 .",
    "we have followed @xcite in defining the @xmath15-grid in this manner .",
    "geometrical distances along the rays of constant impact parameter are constructed as follows : @xmath57 for spherical shells we perform several tests using power - law type variation of density . for such atmospheres ,",
    "the line and continuum opacities also vary as a power law given by @xmath58 let @xmath59 and @xmath60 denote the proportionality constants for @xmath10 and @xmath11 respectively . the constant @xmath59 can be determined using the optical depth at line center @xmath61 . for a power law with index @xmath62 , @xmath63 using the given input value of @xmath64 we can compute the constant @xmath65 .",
    "we use voigt profile with damping parameter @xmath66 or the doppler profile for the results presented in this paper .",
    "the spherical shell atmosphere is characterized by the following parameters : ( @xmath39 , @xmath62 , @xmath61 , @xmath66 , @xmath67 , @xmath68 , @xmath69 ) .",
    "we recall that @xmath39 is the outer radius of the spherical atmosphere surrounding a hollow central cavity of radius @xmath38 .",
    "when @xmath70 we recover the plane parallel limit .",
    "for the spherical shell atmospheres , we take @xmath71 as the unit of length to express the radial co - ordinate .",
    "the boundary conditions are specified at the outer boundary ( @xmath72 ) and the inner boundary .",
    "there are two types of inner boundary conditions : + ( a ) _ emitting core _ : + core rays : @xmath73    lobe rays : @xmath74 @xmath75 along the mid - vertical .",
    "+ ( b ) _ hollow core : _   + for both the core and the lobe rays : @xmath76 the hollow core boundary condition is also called ` planetary nebula boundary condition ' ( see * ? ? ?",
    "it is clear that a spherical shell with a hollow core is equivalent to a plane parallel slab of optical thickness @xmath77 with symmetry about the mid - plane at @xmath78 .",
    "we use spherical shell atmospheres for most of our studies .",
    "the ali methods have been successfully used for the solution of transfer equation in spherical shell atmospheres ( see eg . , * ? ? ? * and references therein ) .",
    "these authors use the jacobi iterative methods ( first introduced by @xcite ) for computing the source function corrections .",
    "recently the gs method has been proposed to solve the same problem ( see eg .",
    "* ; * ? ? ?",
    "@xcite proposed the gmres method for solving spherical radiative transfer problem .",
    "gmres and pre - bicg both belong to krylov subspace technique . in this paper",
    "we compute the spherical transfer solutions by jacobi and gs / sor methods , and compare with the solutions computed using the pre - bicg method . for the sake of clarity",
    ", we recall briefly the steps of jacobi and gs / sor methods .",
    "+ _ jacobi iteration cycle _ : the source function corrections are given by @xmath79 } , \\label{deltas_jacobi}\\ ] ] for the @xmath80th iterate . here",
    "@xmath81 is the depth index .",
    "the @xmath82 is the approximate operator which is simply taken as the diagonal of the actual @xmath0 operator defined through @xmath83=\\bm{\\bar{j } } ; \\label{j_bar}\\ ] ] @xmath84    _ gs / sor iteration cycle _ : the essential difference between the jacobi and gs / sor methods is the following : @xmath85 here the parameter @xmath86 is called the relaxation parameter which is unity for the gs technique .",
    "the sor method is derived from the gs method by simply taking @xmath87 ( see * ? ? ? * for details ) .",
    "the source function correction for the gs method is given by @xmath88 } , \\label{deltas_gs}\\ ] ] where the quantity @xmath89 denotes the mean intensity computed using new values of the source function as soon as they become available .",
    "for those depth points for which the source function correction is not yet complete , gs method uses the values of the source function corresponding to the previous iteration ( see * ? ? ? * ) . for clarity",
    "we explain how the gs algorithm works in spherical geometry , on rays of constant impact parameter .",
    "+ begin loop over iterations + begin loop over radial shells with index @xmath90 + begin loop over impact parameters ( or directions ) with increasing @xmath15 + for the @xmath80th iteration :    * for the incoming rays ( @xmath91 ) : * + ( * reverse sweep along radial shells * )    \\(a ) this part of the calculations start at the outer boundary for all impact parameter rays .",
    "+ ( b ) @xmath92 are first calculated for a given radial shell @xmath90 using @xmath93 , @xmath94 and @xmath95 .",
    "+ ( c ) the partial integral @xmath96 are calculated before proceeding to the next shell .",
    "this part of the calculations is stopped when the core ( for the core rays ) and the mid - vertical line ( for the lobe rays ) are reached .",
    "+    * for outgoing rays ( @xmath97 ) : * + ( * forward sweep along radial shells * )    \\(d ) this part of the calculations start at the inner boundary .",
    "first , for the radial shell with @xmath98 + @xmath99 is calculated , using boundary conditions @xmath100 .",
    "+ ( e ) @xmath101 is computed and the source function is updated using @xmath102 . + ( f ) for the next radial shell @xmath103 : + to calculate @xmath104 by applying the short characteristic formula , @xmath105 , @xmath106 and @xmath107 are needed .",
    "already @xmath108 , @xmath109 and @xmath110 are available .",
    "gs takes advantage of the available new source function at @xmath98 .",
    "@xmath104 is calculated with this set of source functions .",
    "+ ( g ) then @xmath111 are calculated using @xmath104 .",
    "+ ( h ) note that , @xmath112 was calculated using @xmath113 , @xmath109 , and @xmath110 whereas @xmath111 used the `` updated '' source function @xmath108 . therefore @xmath114 is corrected by adding the following correction : @xmath115    \\(i ) @xmath116 and @xmath117 are now calculated .",
    "+ ( j ) since `` updated '' @xmath118 at @xmath103 is also available now , before going to the next radial shell it is appropriate to correct the intensity at the present radial shell by adding to it , the following correction term @xmath119    end loop over impact parameters ( or directions ) + end loop over radial shells + end loop over iterations .",
    "in this section we first describe the essential ideas of the pre - bicg method .",
    "the complete theory of the method is described in @xcite .",
    "we recall that the 2-level atom source function with a background continuum is given by @xmath120 it can be re - written as @xmath121 where @xmath122 from equations  ( [ source_line ] ) , ( [ j_bar ] ) and ( [ jbar ] ) , we get @xmath123 + \\epsilon \\bm{b}_{\\nu}(r)\\}+ \\nonumber \\\\ & & ( 1-\\tilde p(x , r))\\bm{s}_{\\rm c}(r ) . \\label{source_total1}\\end{aligned}\\ ] ] therefore the system of equations to be solved becomes @xmath124\\bm{s}(x , r)= \\tilde p(x , r ) \\epsilon \\bm{b}_{\\nu}(r)+ \\nonumber \\\\ & & ( 1-\\tilde p(x , r))\\bm{s}_{\\rm c}(r ) , \\label{system}\\end{aligned}\\ ] ] which can be expressed in a symbolic form as @xmath125;\\,\\bm{y}=\\bm{s}(x , r ) .",
    "\\label{system_gen}\\end{aligned}\\ ] ] the vector @xmath126 represents quantities on the rhs of equation  ( [ system ] ) .",
    "now we describe briefly , how the pre - bicg method differs from ali based methods .",
    "let @xmath127 denote the @xmath80-dimensional euclidean space of real numbers .",
    "* definition * : the pre - bicg algorithm is a process involving projections onto the @xmath128-dimensional subspace ( @xmath129 ) of @xmath127 @xmath130 and also being orthogonal to another @xmath128-dimensional subspace of @xmath127 @xmath131 here @xmath132 is taken as the initial residual vector @xmath133 with @xmath134 the initial guess for the solution of equation  ( [ system_gen ] ) .",
    "the vector @xmath135 is taken as arbitrary such that the inner product @xmath136 .",
    "the method recursively constructs a pair of bi - orthogonal bases @xmath137 and @xmath138 for @xmath139 and @xmath140 respectively , such that they satisfy the bi - orthogonality condition @xmath141 . for the purpose of application to the radiative transfer theory it is convenient to write the pre - bicg steps in the form of an algorithm for simplicity we drop the explicit dependence on variables .",
    "our goal is to solve equation  ( [ system_gen ] ) . in this section",
    "the symbols @xmath142 and @xmath143 are used to be in conformity with the standard notation of residual and conjugate direction vectors .",
    "they should not be confused with the radius vector @xmath51 and impact parameter @xmath144 which appear in spherical radiative transfer theory .",
    "\\(a ) the very first step is to construct and store the matrix @xmath145 ( which does not change with iterations , for the cases considered here , namely 2-level atom model ) .",
    "details of computing @xmath145 efficiently is described in appendix [ appendix_lambda ] .",
    "we follow the preconditioned version of the bicg method .",
    "preconditioning is a process in which the original system of equations is transformed into a new system , which has faster rate of convergence .",
    "for example , this can be done by solving the new system @xmath146 where @xmath147 is an appropriately chosen matrix , called the `` preconditioner '' ( see also equation 2 of * ? ? ? * ) .",
    "this preconditioner is chosen in such a way that , + ( i ) the new system should be easier to solve , + ( ii ) @xmath148 itself should be inexpensive to operate on an arbitrary vector , + ( iii ) the preconditioning is expected to increase the convergence rate . +",
    "the choice of the preconditioner depends on the problem at hand . when an appropriate @xmath149 is chosen such that the amplification matrix @xmath150 $ ] has as small a maximum eigen value as possible ( see * ? ? ?",
    "* ) , the convergence rate is enhanced .",
    "what enables the convergence of ali , that satisfies the above property , and simplest to manipulate , is the diagonal of the @xmath0 itself .",
    "therefore the amplification matrix @xmath151 $ ] with a diagonal form for @xmath149 is a simple and natural choice as a ` preconditioner ' .",
    "we construct the preconditioner matrix @xmath147 by taking it as the diagonal of @xmath152 .",
    "+ ( b ) an initial guess for the source function is @xmath153 where the thermal part @xmath154 is taken as an initial guess for @xmath155 .",
    "+ ( c ) the formal solver is used with @xmath134 as input to calculate @xmath156 .",
    "+ ( d ) the initial residual vector is computed using @xmath157    \\(e ) the initial bi - orthogonal counterpart @xmath158 for @xmath159 is chosen such that we have @xmath160 .",
    "one can choose @xmath161 itself .",
    "such an initial choice of @xmath158 vector is necessary , as the method is based on the construction of bi - orthogonal residual vectors @xmath142 and @xmath162 recursively , for @xmath163 , where @xmath128 is the number of iterations required for convergence . the process of constructing the bi - orthogonal vectors gets completed , once we reach the convergence . in other words , the number of bi - orthogonal vectors necessary to guarantee a converged solution represents the actual number of iterations itself .",
    "it is useful to remember that when we refer to ` bi - orthogonality ' hereafter , say eg .",
    ", of the residual vectors @xmath142 , @xmath164 we simply mean that @xmath165 for @xmath166 , but @xmath167 need not be unity .",
    "+ ( f ) the bi - orthogonalization process makes use of conjugate direction vectors @xmath168 and @xmath169 for each iteration .",
    "they can be constructed during the iterative process , again through recursive relations .",
    "an initial guess to these vectors is made as @xmath170 and @xmath171 .",
    "+ ( g ) the preconditioned initial residual vectors @xmath172 are computed using @xmath173    \\(h ) for @xmath174 the following steps are carried out until convergence : + ( i ) using the formal solver with @xmath143 as input ( instead of actual source vector @xmath175 ) , @xmath176 $ ] is obtained .",
    "+ ( j ) @xmath177 $ ] is computed using @xmath178=\\bm{p}_{\\rm i}-(1-\\epsilon)\\tilde p \\,\\bm { \\bar j}[\\bm{p}_{\\rm i } ] .",
    "\\label{a_l } \\nonumber\\ ] ]    \\(k ) the inner products @xmath179 , \\bm{p}_{\\rm i}^ * \\ra \\quad \\textrm{and }   \\quad \\la \\bm{r}_{\\rm i } , \\bm{\\zeta}_{\\rm i}^ * \\ra , \\label{a_l_lstar}\\ ] ] are computed and used to estimate the quantity @xmath180 , \\bm{p}_{\\rm i}^ * \\ra}.\\ ] ]    \\(l ) the new source function is obtained through @xmath181    _ test for convergence _",
    ": let @xmath182 denote the convergence criteria . if @xmath183 then iteration sequence is terminated .",
    "otherwise it is continued from step ( m ) onwards .",
    "the convergence criteria @xmath182 is chosen depending on the problem . +",
    "( m ) following recursive relations are used to compute the new set of vectors to be used in the @xmath184th iteration : @xmath185 , \\\\ & & \\bm{r}_{\\rm i+1}^*=\\bm{r}_{\\rm i}^*-\\alpha_{\\rm i } \\hat { a}^t [ \\bm{p}_{\\rm i}^*],\\\\ & & \\bm{\\zeta}_{\\rm i+1}^*=\\hat{m}^{-1 } \\bm{r}_{\\rm i+1}^*.\\end{aligned}\\ ] ]    \\(n ) the quantity @xmath186 is computed using @xmath187    \\(o ) the conjugate direction vectors for the @xmath184th iteration are computed through @xmath188    \\(p ) the control is transferred to step ( g ) .    the converged source function @xmath175 is finally used to compute the specific intensity everywhere within the spherical medium .",
    "in spite of higher convergence rate , computation and storage of the @xmath189 matrix is a main dis - advantage of the pre - bicg method . to avoid this , and to make use of only the ` action ' of @xmath152 matrix on an arbitrary vector , a method called ` bicg - squared '",
    "was developed ( see * ? ? ? * for references and details ) , which is based on squaring the residual polynomials .",
    "later it was improved by re - defining the residual polynomial as a product of two polynomials and obtaining a recursive relation for the new residual polynomial .",
    "this product involves residual polynomial of the pre - bicg method and a new polynomial which ` smoothens ' the iterative process . in this section",
    "we give the computing algorithm of the pre - bicg - stab method as applied to a radiative transfer problem .",
    "as described below , we can avoid computing and storing of the @xmath189 matrix in the pre - bicg - stab method .",
    "however we would now need to call the formal solver twice per iteration unlike in pre - bicg method , where it is called only once .",
    "this results in an increase in number of operations per iteration when compared to pre - bicg method , causing a slight increase in the cpu time per iteration . in spite of",
    "these the pre - bicg - stab method turns out to be always faster than the regular pre - bicg method in terms of convergence rate ( lesser number of iterations for convergence ) .",
    "now we give the algorithm of pre - bicg - stab method to solve the system @xmath190 . here",
    "@xmath147 is a suitably chosen preconditioner matrix .",
    "the computing algorithm is organized as follows : + ( a ) first initial preconditioned residual vectors and conjugate direction vectors are defined through @xmath191    @xmath192    \\(b ) for @xmath193 the following steps are carried out until convergence .",
    "+ ( c ) using @xmath194 instead of the source function a call to the formal solver is made to compute @xmath195 .",
    "( d ) the coefficient @xmath196 can be evaluated now as @xmath197    \\(e ) another vector @xmath198 is calculated as @xmath199    \\(f ) using @xmath198 in place of the source function a call to the formal solver is made to obtain @xmath200 .",
    "+ ( g ) the coefficient @xmath201 is estimated as @xmath202    \\(h ) the updated new source function is calculated as @xmath203    \\(i ) test for convergence is made as in the pre - bicg algorithm . + ( j ) before going to the next iteration a set of recursive relations are used to compute residual vectors @xmath204    and conjugate direction vectors    @xmath205    for the next iteration , where the coefficient @xmath206 is    @xmath207    \\(k ) the control is now transferred to the step ( b ) .",
    "there are two characteristic quantities that define iterative techniques .",
    "they are ( a ) convergence rate , which is nothing but the maximum relative change ( mrc ) defined as @xmath208 and ( b ) the total cpu time @xmath209 required for convergence .",
    "@xmath209 is the time taken to reach a given level of convergence , taking account only of the arithmetic manipulations within the iteration cycle .",
    "we also define a quantity called the true error @xmath210 and use it to evaluate these methods .      in this section",
    "we compare @xmath211 and @xmath209 for the jacobi , gs , sor , pre - bicg and the pre - bicg - stab methods . the sor parameter used is 1.5 .",
    "it is worth noting that the overrates ( the time taken to prepare the necessary set up , before initiating the iterative cycle ) are expected to be different for different methods .",
    "for instance , in jacobi and gs / sor this is essentially the cpu time required to set up the @xmath149 matrix . in the pre - bicg method this involves the time taken to construct the @xmath189 matrix , which is a critical quantity of this method .",
    "the pre - bicg method is described in this paper in the context of a 2-level atom model , because of which , we do not need to update the @xmath189 matrix at each iteration .",
    "for the pre - bicg - stab method it is the time taken to construct the preconditioner matrix @xmath147 .    fig .",
    "[ fig_mrc ] shows a plot of @xmath211 for different methods .",
    "we can take @xmath211 as a measure of the convergence rate .",
    "@xcite show that it always becomes necessary to use high resolution grids , to achieve high accuracy of the solution ( see also sect .",
    "[ intro ] of this paper ) .",
    "this is especially true in the case of spherical radiative transfer where a spatial grid with a large number of points per decade becomes necessary to achieve reasonable accuracy . in the following",
    "we discuss how different methods respond to the grid refinement .",
    "it is a well known fact with the ali methods , that the convergence rate is small when the resolution of the depth grid is very high .",
    "in contrast they have a high convergence rate in low resolution grids .",
    "on the other hand the @xmath211 of pre - bicg and pre - bicg - stab methods have higher convergence rate even in a high resolution grid . fig .  [ fig_mrc](a ) shows @xmath211 for different methods when a low resolution spatial grid is used ( 5pts / d in the logarithmic scale for @xmath3 grid ) .",
    "the jacobi method has a low convergence rate . in comparison",
    ", gs has a convergence rate which is twice that of jacobi .",
    "sor has a rate that is even better than that of gs .",
    "however pre - bicg and the pre - bicg - stab methods have the higher convergence rate . fig .",
    "[ fig_mrc](b ) and [ fig_mrc](c ) are shown for intermediate ( 8 pts / d ) and high ( 30 pts / d ) grid resolutions .",
    "the essential point to note is that , as the grid resolution increases , the convergence rate decreases drastically and monotonically for the jacobi and the gs methods .",
    "it is not so drastic for the sor method which shows non - monotonic dependence on grid resolution .",
    "the pre - bicg and pre - bicg - stab methods exhibit again a monotonic behaviour apart from being relatively less sensitive to the grid resolution .    in table",
    "[ table_1 ] we show what happens when we set convergence criteria to progressively smaller values ( @xmath212@xmath213 , @xmath214 , and @xmath215 for tables [ table_1a ] , [ table_1b ] and [ table_1c ] respectively ) for various grid resolutions .",
    "the model used to compute these results is ( @xmath62 , @xmath39 , @xmath61 , @xmath66 , @xmath67 , @xmath68 , @xmath216)= ( 0 , 10 , @xmath217 , @xmath218 , @xmath219 , 0 , 1 ) .",
    "the idea is to demonstrate that for a given grid resolution ( corresponding rows of the tables [ table_1a ] , [ table_1b ] and [ table_1c ] ) , all the methods show a monotonic increase in the number of iterations for convergence , as we decrease the @xmath220 . on the other hand pre - bicg and pre - bicg - stab require much less number of iterations to reach the same level of accuracy .",
    "_ cpu time considerations _ :",
    "table  [ table_2 ] shows the cpu time requirements for the methods discussed in this paper .",
    "the model used to compute these test cases is ( @xmath62 , @xmath39 , @xmath61 , @xmath67 , @xmath68 , @xmath69 , @xmath220)= ( 0 , 300 , @xmath221 , @xmath219 , 0 , 1 , @xmath214 ) .",
    "the grid resolution considered is 30 pts / d .",
    "the cpu time for convergence can be defined as the computing time required to complete the convergence cycle and reach a fixed level of accuracy .",
    "we recall that the overrates in computing time is the time taken to prepare the necessary set up before initiating the iterative cycle .",
    "total computing time is the sum of these two . in appendix [ appendix_lambda ]",
    "we discuss in detail how to construct @xmath149 matrix for jacobi , gs / sor methods and @xmath152 and @xmath147 matrices for pre - bicg and pre - bicg - stab methods respectively with an optimum effort .",
    "construction of these matrices constitutes the overrates in computing time of each method .",
    "the first row of table  [ table_2 ] shows that pre - bicg is the fastest to complete the convergence cycle .",
    "the reason why pre - bicg - stab takes slightly longer time than pre - bicg is explained at the end of sect .",
    "[ prebicg - stab ] .",
    "the second row of table  [ table_2 ] shows that all methods except pre - bicg take nearly 8 seconds as overrates for the chosen model .",
    "pre - bicg takes additional 3 - 4 seconds as explicit integrals are performed for computing off - diagonal elements also ( unlike the other methods where such integrals are performed only for diagonal elements ) .",
    "the last row of table  [ table_2 ] shows that in terms of total cpu time requirement , the other methods fall behind the pre - bicg and the pre - bicg - stab .",
    "pre - bicg seems to be a bit faster compared to pre - bicg - stab for the particular model chosen .",
    "however it is model dependent .",
    "for instance , as the contribution towards overrates increases , pre - bicg - stab clearly stands out as the fastest method of all , discussed in this paper .",
    "we now study the true errors in these methods ( see figure [ fig_true ] ) .",
    "the model parameters are ( @xmath62 , @xmath39 , @xmath61 , @xmath67 , @xmath68 , @xmath216)= ( 0 , 10 , @xmath217 , @xmath219 , 0 , 1 ) . a coherent scattering limit is used . to define a true error",
    ", we need a so called ` exact solution ' . except for highly idealized cases ,",
    "exact solutions do not exist . for practical purposes , the exact solution can be defined as a solution obtained on a spatial grid of resolution that is three times larger than the grid resolution of the model that we are interested in .",
    "also , we extend the iteration until @xmath211 reaches an extremely small value of @xmath222 . the source function computed in this way",
    "can be called @xmath223 ( fully converged solution on an infinite resolution ) ( see * ? ? ?",
    "the source function at the @xmath80th iterate is denoted by @xmath224 .",
    "we define the true error as @xmath225 following @xcite . in fig .",
    "[ fig_true](a ) we show @xmath210 computed for the pre - bicg method using three grid resolutions , namely 10 pts / d , 14 pts / d and 20 pts / d .",
    "the plateau of each curve represents the minimum value of the true error reached for a given grid resolution .",
    "we notice that as the resolution increases , @xmath210 gradually decreases in magnitude as expected . in fig .",
    "[ fig_true](b ) we show @xmath210 computed for the pre - bicg - stab method .",
    "the model parameters are same as in fig .",
    "[ fig_true](a ) . clearly , pre - bicg - stab shows a smooth decrement of true error compared to pre - bicg , because of the smoothing polynomial used to define the residual vectors . in fig .",
    "[ fig_true](c ) we compare the decrement of true errors for different iterative methods .",
    "the grid resolution chosen is 14 pts/ d with other model parameters being same as in figs .",
    "[ fig_true](a ) , ( b ) .",
    "the decrease of the true errors follows the same pattern in all the iterative methods , although the number of iterations required for @xmath210 to reach a constant value ( plateau ) depends on the method . to reach the same level of true error ,",
    "the pre - bicg and pre - bicg - stab methods require considerably less number of iterations , when compared to the other three .",
    "suppose that @xmath152 is an @xmath226 matrix .",
    "the solution to the problem @xmath227 is a vector of length @xmath55 . in an @xmath55-dimensional vector space @xmath228 the maximum number of linearly independent vectors is @xmath55 .",
    "hence , there can at the most be @xmath55 orthogonal vectors in @xmath228 .",
    "the pre - bicg method seeks a solution by constructing orthogonal vectors .",
    "we recall that the residual counterpart vectors @xmath229 constructed during the iteration process are orthogonal to the initial residual vector @xmath230 .",
    "thus , when we reach convergence after @xmath231 iterations , we will have a set of @xmath232 orthogonal vectors @xmath233 .",
    "from the arguments given above , it is clear that @xmath234 , namely in the pre - bicg method , ` the convergence must be reached theoretically in at the most @xmath55 steps ( or iterations ) ' .",
    "this sets an upper limit to the number of iterations to reach convergence ( see also * ? ? ?",
    "for example when the dimensionality of a problem is high ( very large value of @xmath55 ) , the pre - bicg method ensures convergence in at the most @xmath55 iterations . a theoretical upper bound on the number of iterations also exists for the pre - bicg - stab method , whereas the other methods do not have such a theoretical upper bound . in practice",
    "we find that pre - bicg and pre - bicg - stab methods actually require much less number of iterations than @xmath55 , even when @xmath55 is large .",
    "the main purpose of this paper is to propose a new method to solve the line transfer problems in spherically symmetric media . in this section",
    "we show some illustrative examples in order to compare with the famous benchmarks for spherical transfer solutions presented in the papers by @xcite . in fig .",
    "[ fig_source ] we show source functions for different test cases . fig .",
    "[ fig_source](a ) shows the source functions for @xmath235 and @xmath236 for @xmath237 and @xmath238 .",
    "other model parameters are ( @xmath62 , @xmath68 , @xmath69)=(2 , 0 , 1 ) . we use a doppler profile to compare with the results of @xcite .",
    "plane parallel result is also shown for comparison .",
    "when @xmath235 we observe that the thermalization is reached at the thermalization length for the doppler profile namely @xmath239 .",
    "when @xmath236 thermalization does not occur .",
    "clearly the minimum value of the source function is @xmath240 . for the large values of @xmath237 and opacity index @xmath241 , as @xmath7 increases the opacity decreases steadily and the source function indeed approaches this minimum value near the surface layers . for this case ,",
    "the departure of the source function from planar limit is severe near the surface .",
    "it can be shown ( dashed line of fig .",
    "[ fig_source](b ) , see also fig .  3 of @xcite ) that this departure is not so acute when @xmath242 , but is more acute when @xmath243 ( dash triple - dotted line in fig .  [ fig_source](b ) ) .",
    "[ fig_source](b ) we plot source function for the same model as fig .",
    "[ fig_source](a ) but for various values of @xmath244 . for negative @xmath244 , the distinction between @xmath245 vs. @xmath3 curves for different @xmath62 is small . for positive @xmath244 ,",
    "the effects are relatively larger ( see dot - dashed and long dashed curves in fig .",
    "[ fig_source](b ) ) .    in fig .",
    "[ fig_source](c ) , we show source function variation for a range of spherical extensions @xmath39 . we have chosen an effectively optically thin model ( @xmath61 , @xmath67)=(@xmath246 , @xmath215 ) because in such a medium , thermalization effects do not completely dominate over the effects of sphericity .",
    "other parameters are same as in fig .",
    "[ fig_source](b ) . clearly , the decrease in the value of source function throughout the atmosphere is monotonic , with an increase in the value of @xmath39 from 1 to @xmath247 .    in fig .",
    "[ fig_intensity1 ] , we show effects of limb darkening in spherical atmospheres for @xmath248 and @xmath249 . the other model parameters for fig .  [",
    "fig_intensity1](a ) are ( @xmath62 , @xmath61 , @xmath67 , @xmath68 , @xmath216)= ( 2 , @xmath250 , @xmath219 , 0 , 1 ) . a doppler line profile is used . from the figure , we notice absorption in the line core and emission in the near line wings ( @xmath251 ) for @xmath252 and @xmath253 .",
    "this is the characteristic self reversal observed in spectral lines formed in extended spherical atmospheres .",
    "the self reversal decreases gradually as @xmath254 increases , and finally vanishes for large values of @xmath254 .",
    "indeed for extreme value of @xmath255 , we observe a pure emission line .    in fig .",
    "[ fig_intensity1](b ) we show line profiles formed in a semi - infinite spherical medium .",
    "the model parameters are same as in fig .",
    "[ fig_intensity1](a ) except for ( @xmath39 , @xmath61)=(300 , @xmath256 ) .",
    "the profiles for a range of @xmath257 are shown . for the core rays ( @xmath258 )",
    "we see a pure absorption line due to thermalization of source function . for other angles ,",
    "as expected we see chromospheric type self - reversed emission lines , formed in the lobe part of the spherical medium .",
    "in this paper we propose a robust method called preconditioned bi - conjugate gradient ( pre - bicg ) method to solve the classical problem of line transfer in spherical media .",
    "this method belongs to a class of iterative methods based on the projection techniques . we briefly present the method , and the computing algorithm .",
    "we also present a transpose - free variant called the stabilized preconditioned bi - conjugate gradient ( pre - bicg - stab ) method which is more advantageous in some of its features .",
    "the pre - bicg and pre - bicg - stab methods are validated in terms of its efficiency and accuracy , by comparing with the contemporary iterative methods like jacobi , gs and sor . to calculate the benchmark solutions we use spherical shell atmospheres .",
    "few difficult test cases are also presented to show that the pre - bicg and pre - bicg - stab are efficient numerical methods for spherical line transfer .",
    "l. s. anusha likes to thank dr .",
    "han uitenbroek , dr . a. asensio ramos and dr",
    ". m. sampoorna for useful discussions .",
    "asensio ramos , a. , & trujillo bueno , j. 2006 , in eas pub .",
    "18 , radiative transfer and applications to very large telescopes , ed .",
    "stee , 25 auer , l.  h. 1984 , in methods in radiative transfer , ed .",
    "kalkofen , w. ( cambridge : cambridge university press ) , 237 auer , l.  h. 1991 , in stellar atmospheres : beyond classical models , ed .",
    "crivellari ,  l. , hubeny ,  i. , & hummer ,  d.  g. ( dordrecht : kluwer academic publishers ) , 9 auer , l.  h. , fabiani bendicho , p. , & trujillo bueno , j. 1994 , , 292 , 599 cannon , c. j. 1973 , jqsrt , 13 , 627 chandrasekhar , s. 1934 , mnras , 94 , 522 chevallier , l. , paletou , f. , & rutily , b. 2003 , , 411 , 221 daniel , f. , & cernicharo , j. 2008 , , 488 , 1237 gros , m. , crivellari , l. , & simonneau , e. 1997 , , 489 , 331 hamann , w - r .",
    "1985 , , 145 , 443 hamann , w - r .",
    "2003 , in asp conf .",
    "288 , stellar atmosphere modeling , ed .",
    "hubeny , i. , mihalas , d. , & werner , k. ( san francisco : asp ) , 171 hestenes , m.  r. , & stiefel , e. 1952 , journal of research of the national bureau of standards , 49(6 ) , 409 hubeny , i. , & burrows , a. 2007 , , 659 , 1458 hubeny , i. in asp conf .",
    "288 , stellar atmosphere modeling , ed .",
    "hubeny , i. , mihalas , d. , & werner , k. ( san francisco : asp ) , 17 hummer , d.  g. , & rybicki , g.  b. 1971 , mnras , 152 , 1 klein , r.  i. , castor , j.  i. , greenbaum , a. , taylor , d. , & dykema , p.  g. 1989 , jqsrt , 41 , 199 kosirev , n.  a. 1934 , mnras , 94 , 430 kunasz , p.  b. , & auer , l.  h. 1988 , jqsrt , 39 , 67 kunasz , p.  b. , & hummer , d.  g. 1973 , mnras , 166 , 57 kunasz , p.  b. , & hummer , d.  g. 1974 , mnras , 166 , 19 mihalas , d. 1978 , stellar atmospheres ( 2nd ed . ; san francisco : freeman ) olson , g.  l. , auer , l.  h. , & buchler , j.  r. 1986 , jqsrt , 35 , 431 paletou , f. , & anterrieu .",
    "2009 , arxiv:0905.3258 , http://arxiv.org/abs/0905.3258 peraiah , a. 2002 , an introduction to radiative transfer ( cambridge university press ) peraiah , a. , & grant , i. p. 1973 , jima , 12 , 75 saad , y. 2000 , iterative methods for sparse linear systems ( 2nd ed . )",
    "scharmer , g. b. 1981 , , 249 , 720 schmid - burgk , j. 1974 , , 32 , 73 trujillo bueno , j. , & fabiani bendicho , p. 1995 , , 455 , 646 werner , k. , & husfeld , d. 1985 , , 148 , 417                           crrrrr & jacobi & gs & sor & pre - bicg & pre - bicg - stab + cpu time for convergence & 7 min 49 sec & 4 min 4 sec & 1 min 18 sec & 27 sec & 42 sec + overrates in computing & 6 sec & 6 sec & 6 sec & 9 sec & 6 sec + total computing time & 7 min 55 sec & 4 min 10 sec & 1 min 24 sec & 36 sec & 48 sec +",
    "in pre - bicg method , it is essential to compute and store the @xmath189 matrix . a brute force - fully numerical way of doing",
    "this is as follows .",
    "suppose that the dimension of @xmath152 matrix is @xmath226 , where @xmath55 is the number of depth points . by sending a @xmath259-source function @xmath55 times , to a formal solver subroutine , @xmath55 columns of @xmath152 matrix can be calculated . but",
    "this takes a large amount of cpu time especially for large values of @xmath55 .",
    "instead , there is a semi - analytic way of calculating the @xmath152 matix . by substituting the @xmath259-source function in the expression for the intensity on a short - characteristic stencil of 3-points ( mop in standard notation )",
    "we can obtain  recursive relations for intensity matrix elements @xmath260 , which can then be integrated over frequencies and angles to get the @xmath0 matrix . finally , @xmath261 $ ] .",
    "the diagonal of @xmath0 is @xmath149 and the diagonal of @xmath152 is the preconditioner matrix @xmath147 .    for plane parallel full - slab problem , this is given in @xcite .",
    "in radiative transfer problems with spherical symmetry , it is sufficient to compute the solution on a quadrant .",
    "however this causes a tricky situation , in which we have to define a mid - line ( see fig .  [ fig_geometry ] ) on which a non - zero boundary condition @xmath262 has to be specified . for the outgoing rays ,",
    "the mid - vertical line is the starting grid point for a given ray . since the intensity at the starting point is non - zero ( @xmath262 )",
    ", intensity at any interior point depends on the intensity at all the previous points .",
    "recall that @xmath263 and @xmath264 and so on until we reach the mid - line .",
    "it is easy to see from above equations that intensity calculation at a short - characteristic stencil mop is not confined only to the intensity on mop , but also on all previous points , through spatial coupling .",
    "this is specific to performing radiative transfer on a spherical quadrant .",
    "note that even for the construction of a diagonal @xmath0 , all the elements @xmath265 of the intensity matrix has to be computed .",
    "we present below the recursive relations to compute @xmath266 .",
    "+ * for the incoming rays ( @xmath91 ) - reverse sweep * + do @xmath267 + consider an arbitrary spatial point @xmath268 .",
    "the delta - source vector is specified as + @xmath269 do @xmath270 , where @xmath271 is the total number of impact parameters .",
    "+ for the inner boundary points , define @xmath272 for the core rays and @xmath273 for lobe rays .",
    "the index @xmath274 represents the total number of points on a given ray of constant impact parameter @xmath15 .",
    "the external boundary condition has to be taken as zero for constructing integral operators like @xmath0 .",
    "@xmath275            else + if ( @xmath291 ) @xmath292 else @xmath293 end if + end if + end if + end do + for those rays for which @xmath294 + do @xmath278 + @xmath292 end do + end do + end do + * for the outgoing rays ( @xmath97 ) - forward sweep *   + let @xmath295 + @xmath296 do @xmath270 + for @xmath297 ( inner boundary point ) +",
    "@xmath298          else @xmath303 end if + end do + for those rays for which @xmath294 + do @xmath304 + @xmath292 end do + end do + end do + the algorithm given above saves a great deal of computing time by cutting down the number of calls to the formal solver -2 instead of @xmath55 -the first call to store the @xmath35 and @xmath305 at all depth points , and the second call to compute @xmath265"
  ],
  "abstract_text": [
    "<S> a robust numerical method called the preconditioned bi - conjugate gradient ( pre - bicg ) method is proposed for the solution of radiative transfer equation in spherical geometry . a variant of this method called stabilized preconditioned bi - conjugate gradient ( pre - bicg - stab ) is also presented . </S>",
    "<S> these are iterative methods based on the construction of a set of bi - orthogonal vectors . </S>",
    "<S> the application of pre - bicg method in some benchmark tests show that the method is quite versatile , and can handle hard problems that may arise in astrophysical radiative transfer theory . </S>"
  ]
}