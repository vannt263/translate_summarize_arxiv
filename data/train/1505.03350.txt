{
  "article_text": [
    "many statistical applications in diverse fields such as biology , genetics and finance often involve stochastic models with analytically or computationally intractable likeli - hood functions . the rapidly growing literature on approximate bayesian computation ( abc ) has led to a set of methods which do not involve direct calculation of the likelihood , leading to bayesian inference that is approximate in a sense that will be specified later .",
    "abc methods are becoming popular in genetics @xcite , epidemiology @xcite and in population biology @xcite among other areas .",
    "formally , let @xmath0 be a random sample of size @xmath1 drawn from a statistical model @xmath2 indexed by the parameter @xmath3 .",
    "the likelihood for @xmath4 , corresponding to @xmath2 is @xmath5 , which is not available in closed expression . for a certain prior @xmath6 ,",
    "the aim is to obtain the posterior distribution @xmath7 , but as @xmath5 is inaccessible , @xmath8 can not be approximated by directly evaluating @xmath5 .",
    "this difficulty may be overcome by using abc methods .",
    "specifically , let @xmath9 be a vector of observable summary statistics ( e.g. mean , variance , quantiles etc . ) , which may not be sufficient , let @xmath10 be a metric distance between @xmath11 and its observed value @xmath12 with @xmath13 the tolerance parameter .",
    "abc methods approximate @xmath8 by @xmath14 where @xmath15 , and @xmath16 is the indicator function for the event @xmath17 . they require a choice of @xmath18 and for this purpose several authors @xcite suggest approaches where @xmath18 is estimated as part of an extended model with respect to @xmath2 , while a recent approach based on diagnostic tools for abc can be found in @xcite . in this work",
    "another criterion for choosing @xmath18 is discussed .",
    "the basic version of the abc algorithm relies on simulation by the mixture representation method consisting in generating , say , @xmath19 values of @xmath4 from @xmath6 and using them to generate the corresponding @xmath19 values of @xmath11 from @xmath2 at the simulated @xmath4 .",
    "we accept all values of @xmath4 such that @xmath20 . for @xmath21",
    "the abc method has been proven to return a consistent estimator of the posterior @xmath22 and under some assumptions it is also possible to provide the approximation error as shown in @xcite . moreover , if @xmath11 is sufficient and @xmath23 , then @xmath24 .",
    "there is a certain agreement in that low dimensional , but informative summary statistics improve the accuracy of the abc approximation @xcite .",
    "one drawback of the basic abc algorithm is that it can be extremely inefficient when the discrepancy between @xmath6 and @xmath8 is relevant .",
    "unfortunately , as @xmath5 is intractable , the discrepancy between @xmath6 and @xmath8 is difficult to know a priori and not easy to assess . to deal with this issue , more advanced monte carlo methods , such as abc - mcmc , originally developed in @xcite and further analyzed in several papers such as @xcite , or sequential monte carlo ( smc ) methods ( see , e.g. ,",
    "* ; * ? ? ?",
    "* ) may be used . all these methods attempt to account for the observed data at the proposal stage . however , to accomplish this task , a proposal distribution or a perturbing kernel is required , which in practice is supplied by the analyst.=1    another aspect of the method , which is of major concern in the abc literature , is the choice of @xmath25 , which should be informative for @xmath26 .",
    "the same concern applies here , as we require @xmath25 not to be ancillary with respect to @xmath26 .",
    "many suggestions can be found in the current literature .",
    "for instance , @xcite propose considering the posterior mean of @xmath26 , i.e. @xmath27 . the latter is estimated by means of a pilot - run simulation that depends on the specific observed sample .",
    "moreover , @xcite suggest choosing @xmath25 as the score of the composite likelihood function obtained from @xmath2 .",
    "the present work focuses on the study of a class of proposal distributions for abc - mcmc , and a method for building proposal densities , which target the posterior @xmath28 , is illustrated .",
    "such proposal distributions depend on the model at hand and account for the observed data .",
    "these distributions for @xmath26 are constructed in a way that leads to adopting a normal kernel on the space of @xmath25 , and then consider a reparametrization from @xmath25 to @xmath26 by a suitable regression function @xmath29 .",
    "a recent approach , strongly connected with the use of such a regression function , can be found in @xcite , where the @xmath30 is the binding function in indirect inference @xcite .",
    "we show that for scalar parameter problems and @xmath30 such proposal distributions arise from the class of quasi - likelihood functions ( ql ) of @xmath26 @xcite denoted by @xmath31 . for multidimensional parameter problems ,",
    "the ql is not tractable , but the idea can still be generalized to these contexts using asymptotic arguments . indeed , for the vector of parameters @xmath4",
    ", we consider a multivariate normal kernel and a multivariate transformation from @xmath11 to @xmath4 .",
    "for both the scalar and the multi parameter cases , these transformations are typically not available analytically and we estimate them in a pilot - run simulation . this pilot - run simulation is performed regardless of the specific observed sample and thus it can serve for routine analysis .",
    "this is an appealing feature of the proposed method as will be shown later by an application to a genome wide association study ( gwas ) .",
    "despite the fact that under some more elaborate requirements for the proposal distribution , later discussed , we end up in a proposal which is not the ql for @xmath4 , we think that the connection of abc and ql is important because @xmath5 is not available and the estimation theory of the qls guarantees , asymptotically , that @xmath32 targets @xmath5 .",
    "the structure of the paper is as follows : section [ sec : qlabcmcmc ] discusses @xmath32 , which inspires the proposal distributions considered throughout the paper .",
    "these distributions will be embedded in the abc - mcmc algorithm .",
    "the proposed abc algorithm , abc@xmath33 , for scalar parameters is formally discussed in section [ sec : abc - mcmc - ql ] , while the generalization to @xmath34 is presented in section [ sec : abc - mcmc - ql - p ] .",
    "section [ sec : examples ] illustrates the proposed method with some examples from the abc literature and an important application to gwas for population genetic isolates .",
    "conclusions and further remarks are given in section [ sec : conclusions ] .",
    "the theory and use of estimating equations and that of the related quasi- and quasi - profile likelihood functions have received a good deal of attention in recent years ; see , among others , @xcite .",
    "in addition , @xcite discuss the use of ql functions in the bayesian setting .",
    "let @xmath35 be a scalar summary statistic generated from @xmath36 whose observed value is @xmath37 .",
    "we assume for convenience that the summary statistic lies on the real line , which can be easily achieved by suitable transformations ( e.g. a log - transformation of the sample variance ) .",
    "moreover , suppose @xmath26 is a scalar parameter , i.e. @xmath38 and let @xmath39 be an unbiased estimating function of @xmath26 based on @xmath25 , i.e. @xmath40 .    the ql for @xmath26 based on @xmath39 @xcite , is given by @xmath41 where @xmath42 , @xmath43 is an arbitrary constant , @xmath44 and @xmath45 when @xmath46 , a quasi likelihood for @xmath26 is usually easy to derive , while for @xmath34 some difficulties arise . moreover , as shown below , for a suitable estimating function and under @xmath47 constant , is a normal kernel .",
    "the abc - mcmc algorithm , proposed in @xcite , summarized in algorithm [ alg - mh - abc ] , evaluates @xmath5 indirectly via the indicator function @xmath16 , and uses the proposal density @xmath48 .",
    "set @xmath13 , @xmath49 ; generate @xmath50 ; generate @xmath51 ; calculate @xmath52 ; with probability @xmath53 accept @xmath54 and set @xmath55 , otherwise @xmath56    depending on how the proposal is defined , with algorithm [ alg - mh - abc ] we may implement the independent metropolis hastings ( mh ) or the random walk ( rw ) mh .",
    "smc methods may also be considered as in @xcite .",
    "finally , the proposal @xmath57 can also be viewed as an importance function for the implementation of an importance sampling ( is ) simulation algorithm .",
    "the proof that @xmath58 is the stationary distribution of algorithm [ alg - mh - abc ] is contained in theorem 1 of @xcite and the rate of convergence depends on the choice of @xmath57 and @xmath18 .",
    "however , as @xmath59 is not tractable , it is not possible to further characterize the stochastic behavior of the induced chain .",
    "in fact , the theoretical conditions discussed in @xcite and @xcite may be assessed if @xmath59 is available in a closed form expression .",
    "notice that the approach can also be viewed as a pseudo marginal mh as we are working with an estimated likelihood when evaluating the indicator function @xmath16 , and results for convergence of such pseudo marginal algorithms can also be found in @xcite .",
    "the main objective of this paper is to construct a proposal density centered on the bulk of the posterior distribution . in a setting where",
    "the likelihood can not be computed explicitly , this issue could be cumbersome . for this purpose , we consider a ql derived from estimating functions based on @xmath25 .",
    "the following proposition 1 provides the expression of @xmath60 for a general statistic @xmath25 and assuming @xmath61 is constant .    *",
    "proposition 1*. suppose @xmath38 and let @xmath62 be a bounded regression function under the sampling model @xmath2 for which the jacobian @xmath63 and that the conditional variance @xmath64 is constant with respect to @xmath26 .",
    "consider the following estimating function @xmath65 . in this case",
    "we have @xmath66 where @xmath67 is the density of the standard normal distribution .    * proof*. note that the estimating function is unbiased because @xmath68 . from the definition of @xmath60",
    "the following quantities are needed : @xmath69 @xmath70    then @xmath71 and by we have @xmath72 which is the kernel of the normal distribution centered at @xmath37 with variance @xmath73 . @xmath74",
    "expression suggests that @xmath31 is a normal density when working in the @xmath30 parametrization , and thus if one is able to make a change - of - variable from @xmath30 to @xmath26 , it could be employed as a proposal for mcmc - abc algorithms , leading to a broad class of abc methods denoted abc@xmath33 algorithms .",
    "note that the constant variance assumption , @xmath75 , leads to a closed - form proposal distribution , a normal density .",
    "however , as this assumption may be restrictive , we extend the idea of constructing proposal distributions based on @xmath31 , but assuming a non constant variance , @xmath76 , which can be estimated as well as @xmath30 ( see subsection [ estim.f ] ) .",
    "the theory of ql assures that also for non constant @xmath77 there exists a corresponding @xmath31 whose form is intractable and for this reason it can not be used directly as a proposal density . instead",
    ", our proposal distribution for a random walk metropolis hastings ( rwmh ) is based on a distribution of the form of @xmath31 in where @xmath77 is non constant : @xmath78    @xmath79 , @xmath80 , @xmath77 , or their estimates ( @xmath81 , @xmath82 , @xmath83 ) .",
    "+ set @xmath13 and @xmath84 ; generate @xmath85 set @xmath86 generate @xmath87 ; calculate @xmath52 ; calculate the derivative , @xmath80 , of @xmath30 , at @xmath88 and @xmath54 ; with probability @xmath89 accept @xmath54 and set @xmath55 , otherwise @xmath56    finally , this way of constructing proposals could also be extended to other types of distributions with heavy tails , such as the @xmath90-student distribution .",
    "on the other hand , abc importance sampling ( abc - is ) can be implemented using @xmath91 as the importance function from which it is possible to simulate .",
    "assuming @xmath92 , it would be enough to simulate a sample @xmath93 from a standard normal and then calculate @xmath94 to have a draw of @xmath26 .",
    "the abc - is is completed by the evaluation of the importance weights by means of @xmath95 .",
    "also abc - smc can be used starting with a sample from @xmath95 and using steps s1-s3 from @xcite .",
    "the computational requirements are almost the same as for the abc - is .",
    "in fact , for abc - smc it is necessary to calculate importance weights to be updated in the mc sequence .",
    "the function @xmath30 can be elicited , suggested by the model in @xcite or by theoretical arguments as in @xcite .",
    "for instance , in the genetic model analyzed in @xcite , where the constraint of the empirical likelihood plays the same role as @xmath96 , @xmath30 is built upon the score function of the pairwise likelihood corresponding to the model . however , except in few specific situations , @xmath30 , @xmath80 and @xmath76 are generally unknown , and we replace them in algorithm [ alg - q - mh - abc ] by estimates that can be obtained in a pilot - run simulation as stated in algorithm [ alg - est - f ] . in the sequel , when referring to the abc@xmath33 algorithms , our intention is always that @xmath30 , @xmath80 and @xmath77 are unknown and replaced by an estimator with the sole purpose of providing the input as a proposal density for algorithm [ alg - q - mh - abc ] ( or algorithm [ alg - q - mh - abc - multi ] ) . if @xmath30 , @xmath97 and @xmath77 were known , the computational effort for the abc@xmath33 algorithm would be reduced . in any case , the proof of the convergence of algorithm [ alg - q - mh - abc ] ( or algorithm [ alg - q - mh - abc - multi ] ) is discussed in the previous section [ sec : qlabcmcmc ] .",
    "@xmath98 , @xmath99 consider @xmath98 values @xmath100 taken in a regular spaced grid of a suitable large subset @xmath101 ; generate @xmath102 where @xmath103 ; regress @xmath104 on @xmath105 obtaining @xmath106 and @xmath107 ; regress @xmath108 on @xmath105 obtaining @xmath109 .",
    "@xmath106 , @xmath107 and @xmath110 .    the functions @xmath106 or @xmath109 can be any estimator which provides smoothing regression functions , and @xmath106 is at least once differentiable .",
    "this implies that the main assumption for @xmath30 is to be monotone and once differentiable .",
    "we find it useful to use smoothing splines , for which the derivative , @xmath82 , can be obtained analytically from splines coefficients .",
    "other choices are possible and left to the convenience of the analyst that inspects the scatter diagram of points @xmath111 and provides a goodness - of - fit argument that justifies the choice .",
    "the inverse @xmath112 , at some point @xmath113 , can be obtained either analytically , with the bisection method on @xmath114 or by numerical minimization of @xmath115 , e.g. , by a newton - raphson algorithm .",
    "some observations are appropriate .    *",
    "since we are able to simulate from @xmath116 , then @xmath106 and @xmath109 can be practically estimated with a precision that depends on the available computational resources .",
    "also more precision can be achieved by making the regular grid @xmath99 wider or by increasing the number of simulations , @xmath98 .",
    "values of @xmath98 ranging from @xmath117 to @xmath118 are enough in the examples discussed later for @xmath38 , while larger values are needed for @xmath34 , due to the curse of dimensionality as the computational effort increases exponentially with @xmath119 .",
    "* the range of @xmath99 should always be large enough to include the observed @xmath37 in order to gain precision around the bulk of the target posterior @xmath58 . *",
    "the monotonicity assumption is a necessary condition for abc as it states that there exists a relation between @xmath25 and @xmath26 through @xmath79 , see e.g. , @xcite .",
    "the lack of monotonicity is not a fault of the proposed method , but instead it is an indication of the fact that @xmath25 is not informative for @xmath26 in some subset of the parameter space .",
    "this would be automatically recognized by the proposal as it would be essentially flat in such a region due to a small jacobian .",
    "* the function @xmath31 can also be useful to fix @xmath18 , because under the assumption that @xmath120 is @xmath59 dominated and that @xmath31 was its approximation , then it would be enough to simulate @xmath26 from @xmath31 and @xmath25 from @xmath121 obtaining thus the distribution for @xmath122 and fixing @xmath18 as its suitable quantile . *",
    "the computational cost for approximating @xmath8 with the proposed approach should include that for estimating @xmath123 , approximating the inverse @xmath112 and its jacobian @xmath124 , where the latter is mainly important for @xmath34 , as for @xmath38 the derivative is obtained analytically .",
    "such costs in the implemented examples are actually reduced by another interpolation of the inverse and jacobian with splines , or its corresponding equivalent generalized additive model ( gam ) for @xmath34 ( see the next section ) .",
    "this interpolation speeds up the mcmc because at each step we do not need to calculate its inverse and jacobian , but just its interpolation . finally , because the most important cost is model simulations rather than regression estimation , we note that , in the analyzed examples , the number of simulated statistics @xmath98 is no larger than 10% of the number of mcmc steps @xmath19 .",
    "such computational effort is enough to achieve the desired precision in formulating a proposal distribution .",
    "suppose @xmath34 and let @xmath12 be the vector of the @xmath119 observed statistics . in this case",
    "the theory for @xmath32 is not well developed for finite samples ; however , when @xmath125 , @xmath32 exists if and only if the matrix @xmath126 is symmetric",
    ". in the multi parameter case , we use the regular asymptotic argument for the likelihood ( see e.g. , * ? ? ?",
    "* ch .  4 ) .",
    "that is , for @xmath127 , the taylor expansion of the ql around its mode leads to the following multivariate normal ql : @xmath128 where @xmath129 is a bounded monotone , and possibly non - linear regression function and @xmath130 is the conditional covariance matrix of @xmath131 .",
    "following the same approach as for @xmath38 , we use @xmath132 as a proposal distribution to be used in a mh scheme ( see algorithm [ alg - q - mh - abc - multi ] ) also considering a non constant covariance matrix @xmath133 , that is @xmath134 where @xmath135 denotes the @xmath119-variate normal distribution with mean @xmath136 and variance - covariance matrix @xmath137 , and @xmath138 is the jacobian of the transformation @xmath129 .    in the multi - parameter case",
    "we have a system of non - linear equations @xmath139 whose solution is @xmath140 .",
    "such a solution and the calculation of the determinant of the jacobian , @xmath141 , can be obtained using numerical methods for solving a non - linear system of equations and approximating the derivative of @xmath142 at @xmath4 . in the case of non constant covariance matrix",
    ", we use the proposal distribution with covariance @xmath143 where @xmath144 are the conditional variance functions for each component of @xmath11 with respect to all @xmath119 components of @xmath4 . note that in this case we are forced to use a diagonal covariance matrix in order to guarantee that @xmath133 is positive definite . the correlation between the @xmath119 parameters",
    "is then accounted for in the mcmc sampling .",
    "algorithm [ alg - est - fmulti ] illustrates how to obtain estimates of @xmath142 and @xmath133 along with the calculation of the jacobian corresponding to @xmath145 for @xmath34 .",
    "consider the set of @xmath146 points @xmath147 , each of @xmath119 scalar coordinates over a regular lattice of @xmath148 and let @xmath149 be the @xmath150 matrix of all points ; generate @xmath151 and let @xmath152 be the @xmath150 matrix of all simulated statistics ; regress column @xmath153 of @xmath152 , @xmath154 , on @xmath155 obtaining @xmath156 and regression residuals @xmath157 .",
    "calculate @xmath158 using richardson s extrapolation ( using r package numderiv ) .",
    "let @xmath159 be the @xmath150 matrix of regression residuals , calculate @xmath160 ; regress @xmath161 on @xmath155 to have @xmath162 for @xmath163 and obtain @xmath164 .",
    "@xmath165 , @xmath158 and @xmath164 .",
    "once we have estimated @xmath142 and @xmath130 with @xmath145 and @xmath166 , respectively , we can calculate the proposal @xmath167 in and apply algorithm [ alg - q - mh - abc - multi ] .",
    "this is just algorithm [ alg - q - mh - abc ] in its multivariate version , where the distance function @xmath168 must consider the joint distance of all @xmath119 coordinates of @xmath11 with respect to @xmath12 . also here",
    "@xmath32 can be used to fix @xmath18 in two ways .",
    "the first solution , which is the one adopted in this paper , consists of considering a common @xmath18 for all @xmath119 dimensions by characterizing the stochastic norm of @xmath169 and its quantiles . the second solution would be to consider different tolerance parameters , one for each of the @xmath119 dimensions , by deriving the @xmath119 marginals from the joint proposal and then , at each iteration @xmath90 , updating each one of the @xmath119 parameters separately .",
    "@xmath79 , @xmath170 and @xmath171 , or their estimates ( @xmath81 , @xmath172 and @xmath173 ) . set @xmath13 , @xmath174 ;",
    "generate @xmath175 set @xmath176 generate @xmath177 ; calculate @xmath178 ; calculate the determinant of the jacobian matrices @xmath179 and",
    "@xmath180 ; with probability @xmath181 accept @xmath182 and set @xmath183 , otherwise @xmath184    finally , in order to speed up the mcmc algorithm , especially for large @xmath119 , it is worth noting that once @xmath145 is estimated , its inverse and the jacobian @xmath158 can be further interpolated by means of their respective values calculated on the points of @xmath4 used for the pilot - run . with such interpolation ,",
    "the inverse and jacobians are calculated only on the points of the grid ( @xmath185 in total ) , which is much less computationally demanding than a calculation for all mcmc steps .",
    "many of the remarks outlined in @xmath186)-@xmath187 ) hold in the multivariate case as well . in to guarantee enough flexibility , and because we are mainly interested in predicting @xmath11 , we consider @xmath145 and @xmath188 , to belong to the class of generalized additive regression models @xcite in which each component of @xmath4 enters into the linear predictor by means of a smoothing spline as discussed , for instance , in section 12.2 of @xcite .",
    "the jacobian of the non linear system , @xmath158 which relates @xmath119 summary statistics to the @xmath119 parameters , is calculated using richardson s extrapolation ( implemented in the r package numderiv ) . finally , the inverse of the non linear system of equations at some point @xmath11 is obtained by newton steps as detailed in @xcite ( implemented in the r package nleqslv ) .",
    "we acknowledge that the approach proposed here limits the number of observed statistics to be equal to the number of unknown parameters .",
    "this is in line with the general recommendation to keep the number of statistics , i.e. the number of estimating functions , equal to the number of parameters , as also discussed in @xcite and @xcite .",
    "in this section we illustrate the proposed approach with four examples .",
    "the first is a coalescent model @xcite with a scalar parameter of interest .",
    "the second example is a gamma model with two unknown parameters , and the third is the @xmath189-and-@xmath190 distribution ( see , e.g. , * ? ? ?",
    "* ) with four unknown parameters .",
    "the last example is an application to a real dataset concerning gwas , with three unknown parameters . in the first example",
    "we apply algorithms [ alg - q - mh - abc ] and [ alg - est - f ] , whereas for the other examples we apply algorithms [ alg - est - fmulti ] and [ alg - q - mh - abc - multi ] .    the coalescent model and four - parameter @xmath189-and-@xmath190 distribution",
    "are considered as benchmark examples .",
    "the example of the gamma model is useful in order to validate the procedure against a known @xmath5 . finally , the example of gwas is relevant for analyzing population genetic isolates for which the genealogy tree is known .",
    "although these kinds of data are rare , they are exceedingly more powerful for detecting genes related to some phenotypes than the usual and more costly gwas applied to larger samples of open populations . in all the examples",
    "we have used rw - abc - mcmc , although in examples 1 to 3 we have used also the independent mh abc algorithm , obtaining similar results .",
    "this is because the proposal distribution , constructed under the framework of ql functions , is located around the bulk of the posterior distribution , @xmath28 . finally , the use of proper priors , in some examples , has the sole purpose of allowing comparison with existing methods .",
    "all examples , except the gwas , have been implemented assuming that @xmath109 and @xmath164 are non constant . in the sequel",
    "abc@xmath33denotes the types of algorithms where the proposal for the mcmc has been approximated as explained above .      in the following we consider an example from population genetics , namely the coalescent model analyzed in @xcite and @xcite , among others .",
    "given a set of @xmath1 dna sequences , the aim is to estimate the effective mutation rate , @xmath191 , under the infinitely - many - sites model . in this model",
    ", mutations occur at rate @xmath192 at dna sites that have not been hit by mutation before .",
    "if a site is affected by a mutation , then it is said to be segregating in the sample . in this example , the summary statistic @xmath193 is the number of segregating sites .",
    "the generating mechanism for @xmath194 is the following :    * generate @xmath195 , the length of the genealogical tree of the @xmath1 sequences , where @xmath196 , where @xmath197 are independent exponential random variables with mean @xmath198 such that @xmath199 has mean @xmath200 and variance + @xmath201 ; * generate @xmath202    hence , the likelihood @xmath203 is given by the marginal density of @xmath204 with respect to @xmath199 , which has a closed form only for @xmath205 as @xmath206 .",
    "for large @xmath1 , we approximate the inner integral in @xmath199 by simulating @xmath207 @xmath208 for @xmath209 and then obtaining the marginal density of @xmath204 by averaging over these @xmath207 simulated values of @xmath199 . this parametric approximation is denoted by @xmath210 and relies on the partial knowledge of the likelihood as the marginal density is obtained using the poisson likelihood .    in order to employ abc@xmath33",
    ", we consider @xmath211 and @xmath212 instead of @xmath192 and @xmath194 , respectively . as an example",
    ", we consider @xmath213 and an observed value of @xmath214 , which is a value likely to be obtained under @xmath215 ( and hence @xmath216 ) .",
    "figure [ fig - coal0 ] reports the result of the pilot - run study ( top - left ) with @xmath217 with @xmath81 , @xmath109 ( top - right ) , the calculated jacobian with the splines coefficients ( bottom - left ) and the approximated posterior ( bottom - right ) with @xmath18 being the 10% quantile of the distribution of @xmath218 simulated from @xmath219 , where @xmath220 .     for the pilot - run study along with the estimated @xmath81 and @xmath221 ( green ) .",
    "( top - right ) the estimated conditional variance of @xmath222 , @xmath109 .",
    "( bottom - left ) the jacobian of @xmath106 in the grid of the pilot - run .",
    "( bottom - right ) the approximated posterior @xmath223 with 95% credible interval and posterior mean ( green ) . ]    from figure [ fig - coal0 ] we can see that the chosen summary statistic is not informative for small values of @xmath26 because observing no segregating sites with @xmath213 samples may occur for almost every mutation rate lower than @xmath224 .",
    "this is , of course , not a fault of the method , but of the chosen summary statistic and it may also occur in the standard original abc approaches .",
    "moreover , this is reflected by the proposed method as the estimated jacobian is near 0 for values of @xmath225 .",
    "it can also be seen that for larger values , the approximated jacobian is nearly constant , suggesting that there exists a linear relation between @xmath25 and @xmath26 .    for @xmath226 and @xmath213 we calculated , for each dataset simulated at different values of @xmath227 , the relative difference of quantiles of each posterior with respect to those obtained with the parametric approximation , as in @xcite .",
    "the relative difference is defined as @xmath228 where @xmath229 and @xmath230 are the @xmath119-th quantiles of the abc posterior and that of the parametric approximation , respectively .",
    "figure [ fig - coal2 ] shows the relative differences .",
    "we can clearly see that these differences are more robust with respect to @xmath26 for the abc@xmath33rather than for the abc , and this is due to the impact of the prior in the standard abc algorithm .",
    "in fact , for @xmath231 the discrepancy between prior and posterior becomes important .     with the parametric approximation in terms of relative differences between quantiles of the parametric approximation and those of abc and abc@xmath33 .",
    "]      let @xmath232 with mean @xmath233 and variance @xmath234 , where @xmath235 and @xmath236 are the log of shape and scale , respectively .",
    "we have @xmath237 , @xmath238 and consider the following two statistics @xmath239 , where @xmath240 and @xmath241 are the logarithms of the sample mean and the standard deviation , respectively . for @xmath242",
    "we consider a sample of size @xmath243 with @xmath244 and estimate the posterior distribution under two independent standard normal priors , @xmath245 .",
    "we consider the estimation of @xmath145 with @xmath246 , @xmath237 over a regular lattice of @xmath247 points in @xmath248 .",
    "figure [ fig - gamma1 ] shows the conditional regression functions of each statistic against the parameters , which appear quite linear .",
    "figure [ fig - gamma - varest ] illustrates the @xmath249 of squared residuals and the estimation of the conditional variances @xmath250 and @xmath251 with respect to @xmath4 .",
    "figures [ fig - gamma3 ] and [ fig - gamma4 ] illustrate the mcmc output . from the former",
    "we can deduce that the chain mixes well , and that marginal posteriors @xmath252 and @xmath253 are centered around the true values . from the latter",
    ", we see that the bivariate density @xmath28 obtained by the abc@xmath33 , and the true underlying posterior @xmath254 are similar in terms of contour levels .    , for @xmath235 and @xmath255 along with the histogram of the marginal posteriors @xmath256 and @xmath257",
    ". vertical dotted lines are the true values of @xmath235 and @xmath255 that are used to generate @xmath37 . ]",
    "( dashed ) along with @xmath8 ( continuous ) .",
    "the posterior modes of @xmath235 and @xmath255 are represented by the cross point of the dashed lines , where the true value is @xmath242 . ]",
    "we notice that the output of the mcmc in figure [ fig - gamma4 ] is similar to that obtained using @xmath130 constant ( not reported here ) .",
    "this is presumably because , in this example , the use of logarithms on the scale of the summary statistics stabilizes their conditional variance with respect to @xmath4 .",
    "another reason is because the chain moves in a radius of @xmath258 where the variance functions @xmath259 , @xmath260 are almost constant and do not differ significantly from the estimated diagonal of @xmath130 when it is assumed constant .",
    "distributions based on quantiles are of great interest because of their flexibility . however , although a stochastic representation is available , their density and hence the likelihood @xmath261 are not available in closed form and , in general , they are difficult to evaluate .",
    "we focus on the four - parameter ( @xmath262 ) , @xmath189-and-@xmath190 distribution , which has the following stochastic representation @xmath263 the unknown parameters @xmath264 and @xmath265 represent location , scale , skewness and kurtosis , respectively @xcite .",
    "such distributions have also been used for testing several abc approaches as in @xcite .",
    "we consider the following four statistics all based on empirical quantiles @xmath266 of @xmath267 : @xmath268 with the following meaning : @xmath240 is the median , @xmath269 is the log of the interquartile range and @xmath270 is the skewness index described in @xcite , a special case of the @xcite index .",
    "finally @xmath271 is the log transformation of the kurtosis index described in @xcite .",
    "-and-@xmath190 distribution .",
    "conditional distribution of @xmath272 , for @xmath273 .",
    "each boxplot represents the marginal distribution of the statistic at the specified value of @xmath274 in the horizontal axis . ]    from the pilot - run simulation shown in figure [ fig - gk1 ] , it is possible to notice that the relationship between statistics and parameters is not linear . in this example , we consider a sample simulated under the scenario discussed in @xcite in which @xmath275 observations are generated with @xmath276 and the uniform prior on @xmath277 \\times[-\\log(10),\\log(10 ) ] \\times [ 0,10 ] \\times[-\\log(10),\\log(10)]$ ] is considered . figure  [ fig - gk1-var ] reports the conditional distributions of the logarithm of squared residuals , indicating that the variance may be non constant .",
    "therefore , for this model , we estimated with gams the conditional variance functions @xmath162 , for @xmath278 as explained in algorithm [ alg - est - fmulti ] .",
    "figure [ fig - gk2 ] shows the output of the abc@xmath33with the rw - abc - mcmc algorithm for the four marginal posterior densities , for a given sample .",
    "we can see that the marginal posterior distributions include , in their high posterior density interval , the true value of @xmath4 and the chains have good mixing .",
    "-and-@xmath190 distribution .",
    "logarithms of squared residuals in the pilot - run .",
    "each boxplot is the conditional distribution of @xmath279 , @xmath280 .",
    "such values indicate that @xmath133 is not constant with respect to @xmath4 . ]",
    "-and-@xmath190 distribution .",
    "the approximated marginal posterior @xmath281 , @xmath282 . ]    -and-@xmath190 distribution .",
    "the marginal distributions of the log of mse for each of the four parameters , in 50 replications of the considered simulation scenario , along with the log of mse of the semi - automatic abc procedure reported in @xcite ( stars ) .",
    "]    finally , the performance of the proposed method is assessed by a simulation study  of 50 simulated datasets .",
    "as in @xcite , the 50 datasets are simulated from 50 different parameter values sampled from the prior .",
    "the expected quadratic errors for each marginal abc@xmath33@xmath283 posterior are reported in figure [ fig - gk3 ] , where also the mean squared error ( mse ) of the semi - automatic abc , taken from @xcite , is shown for comparison of the order of magnitudes .    from figure [ fig - gk3 ] , we can see that the expected quadratic error under abc@xmath33 is compatible with that reported for the semi - automatic abc .",
    "notice that our method uses a set of four observable summary statistics that differ from those ones used in @xcite .      in this application",
    ", we address the problem of estimating dna markers related to a certain phenotype such as , for instance , the presence of a certain disease . in this problem genotype",
    "is represented by a large set of dna sequences known as single - nucleotide polymorphisms or snps in the sequel .",
    "such snps are usually observed in millions per individuals and thus fast and reliable statistical methods are needed in order to answer the scientific question as to which snps are mainly related to the disease .",
    "a  dataset for a case / control study is usually collected on an open population where the degree of inbreeding , that is the mating of pairs who are closely related genetically , is unknown as it is usually negligible in open populations .",
    "nonetheless , there exists certain evidence in the genetic literature that very valuable indications regarding snps / disease relationships may come from the study of isolate genetics , i.e. human samples for which inbreeding is also relevant and known .",
    "such types of collected samples are very rare because there are very few genetic isolates in the world , and so the statistical methods to analyze them are not very well developed .",
    "one example of a genetic isolate for which data are also available is the sardinian genetic isolate of the ogliastra region , which is situated in the center of the island of sardinia @xcite .",
    "an example of such data may come from figure [ fig - exgentree ] in which we have a population composed of 4 families , 18 individuals and 2 snps labeled as snp1 and snp2 . from figure [ fig - exgentree ]",
    "we have that ancestors have not been observed because have died ( white ) ; while offsprings are labelled as healthy ( green ) or affected ( red ) along with their snp configurations .",
    "data in figure [ fig - exgentree ] may be formally represented as follows : for individual @xmath186 let @xmath284 represent the indicator of the phenotype , i.e. @xmath285 if affected and @xmath286 otherwise ; assume @xmath287 represents the genotype , e.g. the snp configuration with three levels . for a genealogy composed of @xmath288 individuals we have to model the corresponding pairs @xmath289 , where only @xmath290 have been observed . at the phenotype level we assume the usual @xmath291 model @xmath292 with @xmath293 being the probability that individual @xmath186 is affected .",
    "if one considers the data in figure [ fig - exgentree ] as @xmath243 independent observations and estimates , for instance , a logistic regression model of @xmath294 against @xmath295 , or just considers the fisher exact test among @xmath294 and @xmath295 , one would end up finding no association .",
    "in particular , the fisher exact test between @xmath294 and the first snp has a @xmath119-value of 0.21 while with snp2 it is exactly 1 . while the latter @xmath119-value is reasonable as there is apparently no association between snp2 and @xmath294 ,",
    "the former is not , because all @xmath296 individuals are affected and all @xmath297 individuals are healthy and therefore there should be certain evidence of association between the first snp and affection status .",
    "the shortcoming of this analysis is that it treats all individuals as independent and identically distributed , while it is clear that they are not .    on the other hand ,",
    "the situation of highly dependent observations complicates the statistical model .",
    "in fact , the probabilistic model for the sample must take into account the genealogy that underlies the genetic variant transmission and also the model which relates the phenotype to the genotype . as the genotype is observed for the very last generations only , the configurations of the snps for the previous generations then constitute an enormous number of random latent variables .",
    "this makes it almost impossible to write the likelihood for the parameter relating the snps configuration with the phenotype , that is , the coefficients of a logistic regression between @xmath294 and @xmath295 .        in this application",
    "we illustrate the abc@xmath33 method for the data in figure [ fig - exgentree ] and we also consider a sample from the village of talana ( ogliastra , sardinia - italy ) that is affected by a reduced mean cell volume ( i.e. a mcv@xmath29872 ) disease for which it is known that there exists a genetic variant inside the beta - globin gene which determines it . the data , provided by the centro nazionale ricerche of italy , consists of @xmath299 individuals , all in one tree , originating from two common ancestors .",
    "only @xmath300 individuals of the later generations are observed , among whom only 5 are affected .",
    "moreover , the proportion of affected , similar to the prevalence of the disease , is around 13% .",
    "there are 91 snps with three levels and we know that only one is inside the beta - globin gene .    in this analysis , we treat each snp separately and set up a stochastic model for a single snp .",
    "the overall analysis for all snps is made by the sequence of separated analyses over all snps . in the linear predictor of the logistic regression , we consider as covariates the genotype for individual @xmath186 : @xmath301    the vector of coefficients @xmath4",
    "are usually interpreted as the log of the odds ratio for the probabilities of being affected given a snp configuration . in order to account for the fact that the sample @xmath302 is not i.i.d .",
    "we include the transmission model for the genetic variants .",
    "specifically , let @xmath303 and @xmath304 be the snp configuration for the ancestors of individual @xmath186 .",
    "then the probabilistic model for the transmission of a genotype variant is assumed to be regulated by the usual mendelian inheritance model of transmission , where the ancestor individuals are assumed to be known , according to the genealogical tree .",
    "this law is also known as the law of independent assortment , segregation or dominance , see for instance @xcite .",
    "therefore , if individual @xmath186 is a descendent in the tree @xmath305 while if @xmath186 is a founder or her / his ancestors are not in the tree , then we assume the following prior distribution for configuration of ancestors : @xmath306    the summary statistics , calculated only for the @xmath1 observations , are the observed log - odds of the proportion of affected among all individuals that have a certain configuration .",
    "specifically , let @xmath307 count the number of occurrences of type @xmath308 , @xmath309 where @xmath310 corresponds to @xmath311 , @xmath312 and @xmath313 , respectively .",
    "note that we add one individual in the numerator and two in the denominator in order to guarantee that @xmath314 and @xmath270 are always defined .",
    "this , of course , constitutes a limitation for very small samples from which , however , it would be difficult to estimate very strong signals for a snp that is a risk or protection factor .    in order to run abc@xmath33",
    ", we performed a pilot - run simulation with @xmath315 points on a regular grid of log odds ratios between -10 and 10 .",
    "this pilot - run study depends only on the genealogy tree and not on the observed genotypes or phenotypes . in the case of gwas analysis , this provides a saving in computational efforts , as in general there are many genes to be analysed .",
    "the results for the pilot - run study are summarized in figure [ fig - exgentreepilotrun ] where we can see that the chosen statistics are quite informative around the null hypothesis of no association .",
    "for very large signals , e.g. @xmath316 , the summary statistics are very weakly informative .",
    "this is not the fault of the summary statistics , but it is due to the small observed sample , as is typical in genetic isolates .",
    "figure [ fig - exgentreepilotrun - var ] illustrates the conditional distributions of the logarithm of squared residuals with respect to @xmath235 , @xmath255 and @xmath317 , which could be used to estimate the variance function @xmath133 .",
    "however , in this case we find it reasonable to assume that @xmath133 is constant and we estimate it with @xmath166 as explained in algorithm [ alg - est - fmulti ] .     with @xmath315 points .",
    "each boxplot is the conditional distribution of @xmath318 , @xmath310 . ]    .",
    "each boxplot is the conditional distribution of @xmath319 , @xmath310 .",
    "such values indicate that @xmath133 is constant with respect to @xmath4 . ]",
    "we complete the algorithm by using the euclidean distance @xmath320 , between @xmath11 and its observed value @xmath12 further weighted by a term that takes into account the simulated configurations for the snp .",
    "this term makes the distance tend to 0 when there are many matches between simulated and observed configurations , @xmath321 the tolerance parameter @xmath18 has been fixed in order to obtain an acceptance probability in the rw - abc - mcmc algorithm around 30% .",
    "the output of the chain for data in figure [ fig - exgentree ] is represented in figure [ fig - ex - res ] .    .",
    "chain output for rw - abc - mcmc for the two snps ( a , b ) and corresponding density estimation ( c ) with posterior means represented by dots .",
    "logarithm of bayes factor for @xmath322 against @xmath323 along with the reference lines at @xmath3241.6 ( d ) . ]    from figure [ fig - ex - res ] we can see that snp1 , which has the largest signal , exhibits values of @xmath26 with the largest posterior mean and the largest uncertainty . moreover , the approximated marginal posteriors for @xmath235 and @xmath317 for snp1 are very skewed . for snp2 where",
    "there is no signal , posterior distributions are centered around 0 .",
    "these results are also reflected by the logarithm of the bayes factors ( bfs ) for @xmath325 against @xmath323 , @xmath326 which is defined as long as the posterior of @xmath327 exists .",
    "in fact , there is substantial evidence for the configurations of snp1 to be risk or protective factors , but not for snp2 .",
    "we repeated the above analysis for the talana data and found that the snp inside the beta - globin ( rs11036238 ) is among the first three snps , out of 91 , with the highest posterior mean ( in absolute value ) as shown in figure [ fig - ressnp ] .",
    "those snps also have the largest bayes factors . however , the greater uncertainty for the first three snps in figure [ fig - ressnp ] is due to the fact that with only @xmath300 observed individuals we can not be very precise in estimating very large signals as discussed above .",
    "s with the largest posterior mean ( in absolute ) value ( dot ) .",
    "the posterior is approximated with the rw - abc - mcmc . ]",
    "recently , the idea of using simulation from the model to approximate the distribution of summary statistics seems to be proliferating in the abc literature ( see , e.g. @xcite ) . in this paper",
    "we also used this type of approach .",
    "in particular , we simulate from the model varying the parameters in a grid to approximate the distribution of summary statistics as a function of the parameters in order to build a suitable proposal for abc - mcmc .",
    "such a proposal distribution can be implemented in a rw fashion or can be used as an independence kernel , although we focused mainly on rw type mcmc algorithms .    in scalar parameter problems with conditional constant variance of summary statistics with respect to the parameters , we showed by using the definition of quasi - likelihood @xcite that this proposal is a normal kernel in the auxiliary space , @xmath30 . in multiparameter problems or when",
    "the variance of the regression function can not be assumed to be constant , the theory of quasi - likelihoods only suggests a form for the proposal .",
    "in fact , analogously to the scalar parameter case with constant variance , we propose using a multivariate normal kernel in the auxiliary space .",
    "a key point for the success of our method is that the summary statistics must vary when changing the parameter values .",
    "moreover , there must be a one - to - one relation between them and again , the choice of @xmath11 is critical , as an ancillary statistic is useless for gathering information about @xmath4 . such a non ancillarity assumption is usually required over the whole parameter space @xmath328 and it may happen that there could be parts of the parameter space where @xmath11 is locally ancillary .",
    "this happens , for instance , in the coalescent model for low mutation rates and also in the application to gwas .",
    "such ancillarity , however , is properly accounted for in the discussed proposal density for abc - mcmc .",
    "another problem with our approach may lie in the asymptotic argument for @xmath34 which may not hold in some applications when @xmath32 is irregular .",
    "the proposed abc@xmath33 seems to perform quite well in the above examples compared to other available methods ; it is straightforward to apply and its implementation does not require more than just basic notions of regression analysis .",
    "we discussed two possible abc - mcmc algorithms , the rw - mh with or without constant regression variance .",
    "although we focus mainly on the non constant variance assumption , we found that the original independent mh with constant regression variance leads to satisfactory results for the discussed examples .",
    "this is because we are only implementing a proposal distribution for the abc - mcmc and also because the estimation theory of ql functions allows for a good approximation of @xmath5 which is reflected in the proposal .",
    "furthermore , when simulation from @xmath2 is costly another alternative to abc could be using the @xmath32 as a surrogate of @xmath5 as in @xcite . for other surrogate pseudo - likelihoods used in the abc context ,",
    "see also @xcite among others .",
    "cabras , s. , castellanos , m.  e. , biino , g. , persico , i. , sassu , a. , casula , l. , del giacco , s. , bertolino , f. , pirastu , m. , and pirastu , n. ( 2011 ) .",
    "`` a strategy analysis for genetic association studies with known inbreeding . '' _ bmc genetics _ , 12:63 .",
    "cornuet , j.  m. , santos , f. , beaumont , m.  a. , robert , c.  p. , marin , j.  m. , balding , d.  j. , guillemaud , t. , and estoup , a. ( 2008 ) .",
    "`` inferring population history with diy abc : a user - friendly approach to approximate bayesian computation . ''",
    "_ bioinformatics _ , 24 : 27132719 .",
    "fearnhead , p. and prangle , d. ( 2012 ) .",
    "`` constructing summary statistics for approximate bayesian computation : semi - automatic approximate bayesian computation . ''",
    "_ journal of royal statistal society : series b _ , 74 : 419474 .",
    "foll , m. , beaumont , m.  a. , and gaggiotti , o. ( 2008 ) .",
    "`` an approximate bayesian computation approach to overcome biases that arise when using amplified fragment length polymorphism markers to study population structure . '' _ genetics _ , 179 : 927939 .",
    "haynes , m.  a. , macgillivray , h.  l. , and mengersen , k.  l. ( 1997 ) .",
    "`` robustness of ranking and selection rules using generalised g - and - k distributions . '' _ journal of statistical planning and inference _ , 65 : 4566 .",
    "marjoram , p. , molitor , j. , plagnol , v. , and tavare , s. ( 2003 ) .",
    "`` markov chain monte carlo without likelihoods . ''",
    "_ proceedings of the national academy of sciences of the united states of america _ , 100 : 153248 .",
    "mengersen , k.  l. , pudlo , p. , and robert , c.  p. ( 2013 ) .",
    "`` approximate bayesian computation via empirical likelihood . ''",
    "_ proceedings of the national academy of sciences of the united states of america _ , 110(4 ) : 13211326 .",
    "ratmann , o. , jrgensen , o. , hinkley , t. , stumpf , m. , richardson , s. , and wiuf , c. ( 2007 ) .",
    "`` using likelihood - free inference to compare evolutionary dynamics of the protein networks of h. pylori and p. falciparum . ''",
    "_ plos computational biology _",
    ", 3 : 22662276 .",
    "tanaka , m.  m. , francis , a.  r. , luciani , f. , and sisson , s.  a. ( 2006 ) .",
    "`` using approximate bayesian computation to estimate tuberculosis transmission parameters from genotype data . '' _ genetics _ , 173 : 15111520 .",
    "toni , t. , welch , d. , strelkowa , n. , ipsen , a. , and stumpf , m. p.  h. ( 2009 ) .",
    "`` approximate bayesian computation scheme for parameter inference and model selection in dynamical systems . ''",
    "_ journal of the royal society interface _ , 6 : 187202 .",
    "maria eugenia castellanos was partially funded by ministerio de ciencia e innovacin grant mtm2013 - 42323 .",
    "stefano cabras has been partially funded by ministerio de ciencia e innovacin grant mtm2013 - 42323 , eco2012 - 38442 , ryc-2012 - 11455 and together with erlis ruli were partially funded by ministero dellistruzione , dellunivesit e della ricerca of italy .",
    "all authors have been partially financially supported by regione autonoma della sardegna under grant crp-59903 ."
  ],
  "abstract_text": [
    "<S> approximate bayesian computation ( abc ) is a useful class of methods for bayesian inference when the likelihood function is computationally intractable . in practice , the basic abc algorithm may be inefficient in the presence of discrepancy between prior and posterior . </S>",
    "<S> therefore , more elaborate methods , such as abc with the markov chain monte carlo algorithm ( abc - mcmc ) , should be used . however , the elaboration of a proposal density for mcmc is a sensitive issue and very difficult in the abc setting , where the likelihood is intractable . </S>",
    "<S> we discuss an automatic proposal distribution useful for abc - mcmc algorithms . </S>",
    "<S> this proposal is inspired by the theory of quasi - likelihood ( ql ) functions and is obtained by modelling the distribution of the summary statistics as a function of the parameters . </S>",
    "<S> essentially , given a real - valued vector of summary statistics , we reparametrize the model by means of a regression function of the statistics on parameters , obtained by sampling from the original model in a pilot - run simulation study . the ql theory is well established for a scalar parameter , and it is shown that when the conditional variance of the summary statistic is assumed constant , the ql has a closed - form normal density . </S>",
    "<S> this idea of constructing proposal distributions is extended to non constant variance and to real - valued parameter vectors . </S>",
    "<S> the method is illustrated by several examples and by an application to a real problem in population genetics .    </S>",
    "<S> ,    , </S>"
  ]
}