{
  "article_text": [
    "what is a ` sparse ' graph ?",
    "it is not enough to simply consider edge density as the measure of sparseness .",
    "for example , if we start with a dense graph ( even a complete graph ) and subdivide each edge by inserting a new vertex , then in the obtained graph the number of edges is less than twice the number of vertices . yet in several aspects , the new graph inherits the structure of the original .",
    "a natural restriction is to consider _ proper minor - closed _ graph classes .",
    "these are the classes of graphs that are closed under vertex deletions , edge deletions , and edge contractions ( and some graph is not in the class ) .",
    "planar graphs are a classical example .",
    "interest in minor - closed classes is widespread .",
    "most notably , @xcite proved that every minor - closed class is characterised by a _ finite _ set of excluded minors .",
    "( for example , a graph is planar if and only if it has no @xmath3-minor and no @xmath4-minor . )  moreover , membership in a particular minor - closed class can be tested in polynomial time . there are some limitations however in using minor - closed classes as models for sparse graphs . for example , cloning each vertex ( and its incident edges ) does not preserve such properties . in particular , the graph obtained by cloning each vertex in the @xmath5 planar grid graph has unbounded clique minors @xcite .    a more general framework concerns _ proper topologically - closed _ classes of graphs .",
    "these classes are characterised as follows : whenever a subdivision of a graph @xmath6 belongs to the class then @xmath6 also belongs to the class ( and some graph is not in the class ) .",
    "such a class is characterised by a possibly infinite set of forbidden configurations .",
    "a further generalisation consists in classes of graphs having _ bounded expansion _",
    ", as introduced by @xcite .",
    "roughly speaking , these classes are defined by the fact that the maximum average degree of a shallow minor of a graph in the class is bounded by a function of the depth of the shallow minor . thus bounded expansion classes",
    "are broader than minor - closed classes , which are those classes for which every minor of every graph in the class has bounded average degree",
    ".    bounded expansion classes have a number of desirable properties .",
    "( for an extensive study we refer the reader to @xcite . )  for example , they admit so - called _ low tree - depth decompositions _ @xcite , which extend the low tree - width decompositions introduced by @xcite for minor - closed classes .",
    "these decompositions , which may be computed in linear time , are at the core of several linear - time graph algorithms , such as testing for an induced subgraph isomorphic to a fixed pattern @xcite .",
    "in fact , isomorphs of a fixed pattern graph can be counted in a graph from a bounded expansion class in linear time @xcite .",
    "also , low tree - depth decompositions imply the existence of restricted homomorphism dualities for classes with bounded expansion @xcite .",
    "that is , for every class @xmath7 with bounded expansion and every connected graph @xmath8 ( which is not necessarily in @xmath7 ) there exists a graph @xmath9 such that @xmath10 where @xmath11 means that there is a homomorphism from @xmath6 to @xmath12 , and @xmath13 means that there is no such homomorphism .",
    "finally , note that the structural properties of bounded expansion classes make them particularly interesting as a model in the study of ` real - world ' sparse networks @xcite .    bounded expansion classes are the focus of this paper .",
    "our contributions to this topic are classified as follows ( see figure  [ fig : bec ] ) :    * we establish two new characterisations of bounded expansion classes , one in terms of so - called topological parameters , the other in terms of controlling dense parts ; see section  [ sec : characterisations ] . * this latter characterisation is then used to show that the notion of bounded expansion is compatible with erds - rnyi model of random graphs with constant average degree ( that is , for random graphs of order @xmath1 with edge probability @xmath2 ) ; see section  [ sec : random ] . * we present several new examples of classes with bounded expansion that appear naturally in the context of graph drawing or graph colouring . in particular , we prove that each of the following classes have bounded expansion , even though they are not contained in a proper topologically - closed class : * * graphs that can be drawn with a bounded number of crossings per edge ( section  [ sec : crossingnumber ] ) , * * graphs with bounded queue - number ( section  [ sec : queue ] ) , * * graphs with bounded stack - number ( section  [ sec : stack ] ) , * * graphs with bounded non - repetitive chromatic number ( section  [ sec : nonrep ] ) .",
    "+ we also prove that graphs with ` linear ' crossing number are contained in a topologically - closed class , and graphs with bounded crossing number are contained in a minor - closed class ( section  [ sec : crossingnumber ] ) .",
    "@r=1pt@c=1pt & & & & + & & & & + [ 10pt ] & & & + & & & ; [ uull ] * * ?",
    "> * + & & & + [ 10pt ] & & & +   ; [ uuuuur ] * * ? > * & &   & ; [ uuuuull ] * * ? > * + & & & + [ 10pt ] & & & + & &   ; [ uuuuul ] * * ? > * + & &    [ fig : bec ]    before continuing we recall some well - known definitions and results about graph colourings .",
    "a _ colouring _ of a graph @xmath6 is a function @xmath14 from @xmath15 to some set of colours , such that @xmath16 for every edge @xmath17 .",
    "a subgraph @xmath12 of a coloured graph @xmath6 is _ bichromatic _ if at most two colours appear in @xmath12 .",
    "a colouring is _ acyclic _ if there is no bichromatic cycle ; that is , every bichromatic subgraph is a forest .",
    "the _ acyclic chromatic number _ of @xmath6 , denoted by @xmath18 , is the minimum number of colours in an acyclic colouring of @xmath6 .",
    "a colouring is a _ star colouring _ if every bichromatic subgraph is a star forest ; that is , there is no bichromatic @xmath19 .",
    "the _ star chromatic number _ of @xmath6 , denoted by @xmath20 , is the minimum number of colours in a star colouring of @xmath6 .",
    "observe that a star colouring is acyclic , and @xmath21 for all @xmath6 .",
    "conversely , the star chromatic number is bounded by a function of the acyclic chromatic number ( folklore , see @xcite ) . that graphs with bounded expansion have bounded star chromatic number is proved in @xcite .",
    "in the following , we work with unlabelled finite simple graphs .",
    "we use standard graph theory terminology . in particular , for a graph @xmath6 , we denote by @xmath15 its vertex set , by @xmath22 its edge set , by @xmath23 its _ order _ ( that is , @xmath24 ) and by @xmath25 its _ size _ ( that is , @xmath26 ) . the _ distance _ between two vertices @xmath27 and @xmath28 of @xmath6 , denoted by @xmath29 , is the minimum length ( number of edges ) of a path linking @xmath27 and @xmath28 ( or @xmath30 if @xmath27 and @xmath28 do not belong to the same connected component of @xmath6 ) .",
    "the _ radius _ of a connected graph @xmath6 is the minimum over all vertices @xmath31 of @xmath6 of the maximum distance between @xmath31 and another vertex of @xmath6 . for a subset of vertices @xmath32 of @xmath6 , the _ subgraph of @xmath6 induced by _",
    "@xmath32 will be denoted by @xmath33 $ ] .",
    "a class @xmath7 of graphs is _ hereditary _ if every induced subgraph of a graph in @xmath7 is also in @xmath7 , and @xmath7 is _ monotone _ if every subgraph of a graph in @xmath7 is also in @xmath7 .    for @xmath34",
    ", a graph @xmath12 is said to be a _",
    "shallow minor _ of a graph @xmath6 at _ depth _",
    "@xmath35 if there exists a subgraph @xmath36 of @xmath6 whose connected components have radius at most @xmath35 , such that @xmath12 is a simple graph obtained from @xmath6 by contracting each component of @xmath36 into a single vertex and then taking a subgraph ( see figure  [ fig : shm ] ) .",
    "@xcite , who introduced shallow minors as _ low - depth minors _ , attributed this notion to charles leiserson and sivan toledo .     of a graph",
    "@xmath6 is a simple subgraph of a minor of @xmath6 obtained by contracting vertex disjoint subgraphs with radius at most @xmath35.,scaledwidth=75.0% ]    [ fig : shm ]    for a graph @xmath6 and @xmath34 , let @xmath37 denote the set of all shallow minors of @xmath6 at depth @xmath35 . in particular , @xmath38 is the set of all subgraphs of @xmath6 .",
    "hence we have the following non - decreasing sequence of classes : @xmath39 we extend this definition in the obvious way to graph classes @xmath7 by defining @xmath40    the information gained by considering shallow minors instead of minors enables robust classification of graphs classes .",
    "an infinite graph class @xmath7 is said to be _ somewhere dense _ if there exists an integer @xmath35 such that every ( finite simple ) graph belongs to @xmath41 , otherwise @xmath7 is _ nowhere dense _",
    "@xcite . that is , a graph class is somewhere dense if every graph is a bounded depth shallow minor of a graph in the class .",
    "nowhere dense classes are closely related to _ quasi wide _",
    "classes @xcite , which were introduced in the context of first order logic by @xcite , and to asymptotic counting of homomorphisms from fixed templates @xcite .",
    "in some sense , this dichotomy defines a simple yet robust frontier between a `` sparse '' and a `` dense '' world .",
    "examples of nowhere dense classes include classes with bounded expansion , which we now define formally .",
    "let @xmath7 be a graph class .",
    "define @xmath42 in the particular case of a single - element class @xmath43 , @xmath44 is called the _ greatest reduced average density _",
    "( grad ) of @xmath6 of rank @xmath35 .",
    "we say @xmath7 has _ bounded expansion _ if there exists a function @xmath45 ( called an _ expansion function _ ) such that @xmath46 for example , it is easily seen @xcite that every graph @xmath6 with maximum degree at most @xmath47 satisfies @xmath48 .",
    "thus a class of graphs with bounded maximum degree has bounded expansion .",
    "define @xmath49 .",
    "the graph classes with bounded expansion , where the expansion function is bounded by a constant , are precisely those excluding a fixed minor .",
    "let @xmath50 be the hadwiger number of a graph @xmath6 ; that is , @xmath51 is a minor of @xmath6 but @xmath52 is not a minor of @xmath6 .",
    "then @xcite showed that @xmath53",
    "[ sec : characterisations ]    several characterisations of bounded expansion classes are known , based on :    * special decompositions , namely _ low tree - depth decompositions _ @xcite ; * orientations and augmentations , namely _ transitive fraternal augmentations _ @xcite ; * vertex orderings , namely _ generalised weak colouring numbers _ @xcite ; * edge densities of shallow topological minors @xcite .",
    "here we recall this last characterisation and then give two new characterisations .",
    "a graph @xmath12 is a _ subdivision _ of a graph @xmath6 if @xmath12 is obtained by replacing each edge @xmath54 of @xmath6 by a path between @xmath55 and @xmath56 .",
    "the vertices in @xmath57 are called _",
    "division vertices_. the vertices in @xmath15 are called _",
    "original vertices_. a subdivision of @xmath6 with at most @xmath58 division vertices on each edge of @xmath6 is called a _",
    "@xmath59-subdivision_. the subdivision of @xmath6 with exactly @xmath58 division vertices on each edge of @xmath6 is called the _ @xmath58-subdivision _ of @xmath6 .",
    "the @xmath60-subdivision of @xmath6 is denoted by @xmath61 . in a @xmath62-subdivision of @xmath6",
    ", if @xmath27 is the division vertex for some edge @xmath54 of @xmath6 , then the path @xmath63 in @xmath61 is called a _ transition_.    a _ shallow topological minor _ of a graph @xmath6 of depth @xmath35 is a ( simple ) graph @xmath12 obtained from a subgraph of @xmath6 by replacing an edge disjoint family of induced paths of length at most @xmath64 by single edges ( see figure  [ fig : topmin ] ) .",
    "@xmath65{hidden_pet.pdf}\\ar[r]^{subgraph } & \\includegraphics[width=3cm]{pet.pdf}\\ar[d]^{\\approx}\\\\ \\includegraphics[width=3cm]{pet3.pdf } & \\includegraphics[width=3cm]{pet2.pdf}\\ar[l]_{\\text{short path contraction } } } \\endxy\\ ] ]    for a graph @xmath6 and @xmath34 , let @xmath66 denote be the class of graphs that are shallow topological minors of @xmath6 at depth @xmath35 . as a special case , @xmath67 is the class of all subgraphs of @xmath6 ( no contractions allowed ) .",
    "since @xmath66 is contained in @xmath37 , @xmath68 for a class of graphs @xmath7 , define @xmath69 hence @xmath70 for every graph @xmath6 , and we have the non - decreasing sequence @xmath71 the _ topological closure _ of @xmath7 is the class @xmath72 of all topological minors of graphs in @xmath7 .",
    "we say @xmath7 is _ topologically - closed _",
    "if @xmath73 , and is _ proper topologically - closed _ if it is topologically - closed and does not include all ( simple finite ) graphs .",
    "define @xmath74 and denote @xmath75 by @xmath76 . in the particular case of a single element class @xmath43 , @xmath77",
    "is called the _ topological greatest reduced average density _ ( top - grad ) of @xmath6 of rank @xmath35 .",
    "obviously , @xmath44 is an upper bound for @xmath77 . that a polynomial function of @xmath44 is also a lower bound for @xmath77 was proved by zdenk dvok in his ph.d .",
    "thesis :    [ thm : dvorak ] let @xmath6 be a graph and @xmath78 . if @xmath79 , then @xmath6 contains a subgraph that is a @xmath80-subdivision of a graph with minimum degree @xmath81 .",
    "[ cor : dvorak ] for every graph @xmath6 and @xmath34 , @xmath82    if follows that a class @xmath7 has bounded expansion if and only if there is a function @xmath83 such that @xmath84 for every graph @xmath85 .",
    "this alternative characterisation will be particularly useful in this paper .",
    "for example , every graph @xmath6 with maximum degree at most @xmath47 satisfies @xmath86 ( as the bound on the maximum degree obviously holds for every topological minor of @xmath6 ) .      here",
    "we introduce the first of our new characterisations of bounded expansion classes .",
    "graph parameter _ is a function @xmath87 for which @xmath88 is a non - negative real number for every graph @xmath6 .",
    "note that all the graph parameters that we shall study are isomorphism - invariant .",
    "examples include minimum degree , average degree , maximum degree , connectivity , chromatic number , treewidth , etc .",
    "if @xmath87 and @xmath89 are graph parameters , then @xmath87 is _ bounded by _",
    "@xmath89 if for some function @xmath14 , @xmath90 for every graph @xmath6 .",
    "@xcite defined a graph parameter @xmath87 to be _ topological _ if for some function @xmath14 , for every graph @xmath6 , @xmath91 and @xmath92 where @xmath61 is the @xmath60-subdivision of @xmath6 ( the graph obtained from @xmath6 by subdividing each edge once ) .",
    "for instance , tree - width and genus are topological , but chromatic number is not .",
    "a graph parameter @xmath87 is _ strongly topological _ if for some function @xmath14 , for every graph @xmath6 and every @xmath93-subdivision @xmath12 of @xmath6 , @xmath94 and @xmath95 .",
    "the graph parameter @xmath87 is _ monotone _ ( respectively , _ hereditary _ ) if @xmath96 for every subgraph ( respectively , every induced subgraph ) @xmath12 of @xmath6 , and @xmath87 is _ degree - bound _ if for some function @xmath14 , every graph @xmath6 has a vertex of degree at most @xmath97 .",
    "notice that in such a case , @xmath14 may be chosen non - decreasing .",
    "a graph parameter @xmath87 is _ unbounded _ if for every integer @xmath98 there exists a graph @xmath6 such that @xmath99 .",
    "[ lem : beparam ] [ lem : topoexp ] a class @xmath7 has bounded expansion if and only if there exists a strongly topological , monotone , degree bound graph parameter @xmath87 and a constant @xmath100 such that @xmath101 .",
    "assume @xmath7 has bounded expansion , and let @xmath102 .",
    "if @xmath14 is bounded , then define @xmath103 . otherwise , define @xmath88 to be the minimum @xmath104 such that @xmath105 for every @xmath106 .",
    "let @xmath6 be a graph and let @xmath12 be a @xmath93-subdivision of @xmath6 . then @xmath107 and @xmath108 .",
    "it follows that @xmath109 .",
    "this proves that @xmath87 is strongly topological . if @xmath12 is a subgraph of @xmath6 then @xmath110 , hence @xmath96 . also , every graph @xmath6 has a vertex of degree at most @xmath111 , hence @xmath87 is also degree - bound .",
    "notice that @xmath7 obviously is a subset of @xmath112 .",
    "now assume that @xmath87 is a strongly topological , monotone , and degree - bound parameter .",
    "let @xmath113 for some constant @xmath100 .",
    "let @xmath31 be an integer .",
    "let @xmath85 .",
    "for some @xmath114 , we have @xmath115 .",
    "let @xmath116 be a @xmath117-subdivision of @xmath12 isomorphic to a subgraph of @xmath6 .",
    "let @xmath118 .",
    "there is a sequence @xmath119 such that @xmath120 is a @xmath93-subdivision of @xmath121 , for each @xmath122 .",
    "by induction , @xmath123 where @xmath124 is @xmath14 iterated @xmath125 times . since @xmath14 is non - decreasing , @xmath126 .",
    "since @xmath87 is degree bound and hereditary , @xmath127 is at most some @xmath128 .",
    "it follows that @xmath7 has bounded expansion .",
    "here we introduce the second of our new characterisations of bounded expansion classes .",
    "[ lem : trdens0 ] for every graph @xmath6 and every integer @xmath31 , if @xmath129 then @xmath130    for some @xmath114 , we have @xmath131 .",
    "let @xmath61 be a @xmath117-subdivision of @xmath12 that is a subgraph of @xmath6 .",
    "let @xmath132 be the average number of subdivision vertices of @xmath61 per branch",
    ". then @xmath133 and @xmath134 .",
    "hence @xmath135    this property may be efficiently used in conjunction with the following alternative characterisation of classes with bounded expansion , which may be useful for classes that are neither addable ( that is , closed under disjoint unions ) nor hereditary .",
    "[ lem : charac2 ] let class @xmath7 be a class of graphs .",
    "then @xmath7 has bounded expansion if , and only if , there exists functions @xmath136 such that the following two conditions hold :    * @xmath137 * @xmath138    assume @xmath7 has bounded expansion",
    ". then the average degree of graphs in @xmath7 is bounded by @xmath139 . hence , for every @xmath85 and every integer @xmath140 , @xmath141 hence @xmath142 .",
    "thus @xmath143 and @xmath144 suffice .",
    "the second property is straightforward : put @xmath145 and @xmath146 .",
    "now assume that the two conditions hold .",
    "fix @xmath31 .",
    "let @xmath85 and let @xmath116 be a subset of vertices of @xmath6 of cardinality @xmath147 .",
    "let @xmath148 denote a vertex subset formed by adding paths of length at most @xmath149 with interior vertices in @xmath150 and endpoints in @xmath116 ( not yet linked by a path ) , one by one until no path of length at most @xmath149 has interior vertices in @xmath150 and endpoints in @xmath116 . then @xmath151 .",
    "suppose not , and consider the set @xmath152 of the first @xmath153 vertices of @xmath154 .",
    "by definition the subgraph of @xmath6 induced by @xmath152 contains a @xmath117-subdivision of a graph @xmath12 of order @xmath58 and size at least @xmath155 .",
    "it follows that @xmath156)\\geq f_{\\nabla}(r)$ ] hence @xmath157 , a contradiction .",
    "let @xmath158 .",
    "then for sufficiently big graphs @xmath6 ( of order greater than @xmath159 ) , @xmath160 .",
    ". now assume that there exists in @xmath6 a @xmath117-subdivision @xmath61 of a graph @xmath12 with minimum degree at least @xmath47 .",
    "as @xmath162 is the number of vertices of @xmath61 having degree at least @xmath47 , we infer that @xmath163 .",
    "it follows that @xmath164 hence @xmath165 , a contradiction .",
    "it follows that @xmath166 .",
    "hence , for every graph @xmath85 ( including those of order at most @xmath98 ) we have @xmath167 .",
    "[ sec : random ]    the @xmath168 model of random graphs was introduced by @xcite and @xcite ; see @xcite . in this model , a graph with @xmath1 vertices is built , where each edge appears independently with probability @xmath125 .",
    "it is frequently considered that @xmath125 may be a function of @xmath1 , hence the notation @xmath169 .",
    "the order of the largest complete ( topological ) minor in @xmath170 is well - studied .",
    "it is known since the work of @xcite that random graphs @xmath169 with @xmath171 are asymptotically almost surely ( henceforth abbreviated , _ a.a.s .",
    "_ ) planar , whereas those with @xmath172 a.a.s .",
    "contain unbounded clique minors .",
    "@xcite proved that for every @xmath173 there exists a constant @xmath174 such that a.a.s .",
    "the maximum order @xmath175 of a complete minor of a graph in @xmath176 satisfies the inequality @xmath177 .",
    "also , @xcite proved that as long as the expected degree @xmath178 is at least @xmath179 and is @xmath180 , then a.a.s .",
    "the order of the largest complete topological minor of @xmath168 is almost as large as the maximum degree , which is @xmath181 .",
    "however , it is known that the number of short cycles of @xmath176 is bounded . precisely , the expected number of cycles of length @xmath58 in @xmath176 is at most @xmath182 .",
    "it follows that the expected value @xmath183 of the clique size of a shallow topological minor of @xmath6 at depth @xmath35 is bounded by approximately @xmath184 ( for some constant @xmath185 ) .",
    "@xcite proved that @xmath186 is a.a.s .",
    "@xmath187-degenerate , where a graph @xmath12 is said to be _",
    "@xmath188-degenerate _ if there exists an ordering @xmath189 of its vertices such that for each @xmath190 , there are at most @xmath35 vertices @xmath191 adjacent to @xmath190 with @xmath192 , and there are at most @xmath193 subsets @xmath194 for some neighbour @xmath191 of @xmath190 with @xmath195 , where the _ neighbourhood _ @xmath196 is the set of vertices that are adjacent to @xmath191 .",
    "we modify their proof in order to estimate the top - grads of @xmath186 .",
    "the proof is based on the characterisation of bounded expansion given in lemma  [ lem : charac2 ] .",
    "we first prove that graphs in @xmath186 a.a.s .",
    "have a small proportion of vertices have sufficiently large degree , and then that subgraphs having sufficiently dense sparse topological minors must span some positive fraction of the vertex set of the whole graph .",
    "thanks to lemma  [ lem : trdens0 ] , this last property will follow from the following two facts :    * as a random graph with edge probability @xmath2 has a bounded number of short cycles , if one of its subgraphs is a @xmath117-subdivision of a sufficiently dense graph it should a.a.s .  span at least some positive fraction @xmath197 of the vertices ( lemmas  [ lem : sparse ] and [ lem : sparse2 ] ) ; * for every @xmath198 , the proportion of vertices in a random graph with edge probability @xmath2 that have sufficiently large degree ( @xmath199 ) is a.a.s .",
    "less than @xmath200 ( lemma  [ lem : smalldeg ] ) .",
    "[ lem : sparse ] let @xmath198 .",
    "every subgraph @xmath61 of @xmath186 with @xmath201 vertices satisfies @xmath202 .",
    "it is sufficient to prove that almost surely every subgraph @xmath61 of @xmath186 with @xmath203 vertices satisfies @xmath204 .",
    "let @xmath61 be an induced subgraph of @xmath6 of order @xmath58 with @xmath203 .",
    "the probability that @xmath61 has size at least @xmath205 is at most @xmath206 .",
    "therefore , by the union bound , the probability that @xmath6 has an induced subgraph of order @xmath58 with size at least @xmath205 is @xmath207 summing over all @xmath208 , one easily checks that the probability that @xmath6 has an induced subgraph @xmath61 of order at most @xmath209 such that @xmath210 is @xmath211 , completing the proof .",
    "lemmas  [ lem : trdens0 ] and [ lem : sparse ] imply :    [ lem : sparse2 ] let @xmath212 .",
    "every subgraph @xmath61 of @xmath186 with @xmath213 vertices satisfies @xmath214 .",
    "that is , @xmath215    [ lem : smalldeg ] let @xmath216 and let @xmath217 .",
    "a.a.s .  there are at most @xmath218 vertices of @xmath186 with degree greater than @xmath219 .",
    "let @xmath32 be the subset of @xmath220 vertices of largest degree in @xmath221 , and let @xmath47 be the minimum degree of vertices in @xmath32 .",
    "thus there are at least @xmath222 edges that have at least one endpoint in @xmath32 .",
    "consider a random subset @xmath223 of @xmath32 with size @xmath224 .",
    "every edge that has an endpoint in @xmath32 has probability at least @xmath225 of having exactly one endpoint in @xmath223 .",
    "so there is a subset @xmath226 of size @xmath224 such that the number @xmath227 of edges between @xmath223 and @xmath228 satisfies @xmath229 .",
    "we now give an upper bound on the probability that @xmath230 .",
    "each set @xmath223 of @xmath231 vertices in @xmath221 has probability at most @xmath232 of having at least @xmath233 edges between @xmath223 and @xmath228 .",
    "therefore the probability that there is a set @xmath223 of @xmath234 vertices in @xmath6 that has at least @xmath235 edges between @xmath223 and @xmath228 is at most @xmath236 completing the proof .    for every @xmath237",
    "there exists a class @xmath238 with bounded expansion such that @xmath170 asymptotically almost surely belongs to @xmath238 .",
    "[ sec : crossingnumber ]    for a graph @xmath6 , let @xmath239 denote the _ crossing number _ of @xmath6 , defined to be the minimum number of crossings in a drawing of @xmath6 in the plane ; see the surveys @xcite .",
    "it is easily seen that @xmath240 for every subdivision @xmath12 of @xmath6 . thus crossing number",
    "is strongly topological .",
    "the following `` crossing lemma '' , independently due to @xcite and @xcite , implies that crossing number is degree - bound .",
    "[ lem : crossinglemma ] if @xmath241 then @xmath242",
    ".    lemmas  [ lem : beparam ] and [ lem : crossinglemma ] imply that a class of graphs with bounded crossing number has bounded expansion . in fact , since every graph @xmath6 has orientable genus at most @xmath243 ( simply introduce one handle for each crossing ) , any class with bounded crossing number is included in a minor - closed class . in particular , @xmath244 implying @xmath245 and @xmath246 by .",
    "the following theorem says that graphs with linear crossing number ( in some sense ) are contained in a topologically - closed class , and thus have bounded expansion .",
    "let @xmath247 denote the subgraph of @xmath6 induced by the vertices of @xmath6 that have degree at least @xmath248 .",
    "let @xmath249 be a constant .",
    "let @xmath250 be the class of graphs @xmath6 such that @xmath251 for every subgraph @xmath12 of @xmath6 .",
    "then @xmath250 is contained in a topologically - closed class of graphs .",
    "precisely @xmath252 .",
    "let @xmath253 and let @xmath12 be a topological minor of @xmath6 such that @xmath254 .",
    "let @xmath255 be a witness subdivision of @xmath12 in @xmath6 .",
    "we prove that @xmath256 by contradiction . were it false , then @xmath257 and by lemma  [ lem : crossinglemma ] , @xmath258 thus @xmath259 , a contradiction .",
    "hence @xmath260 for every @xmath253 .",
    "consider the class of graphs that admit drawings with at most one crossing per edge .",
    "obviously this includes large subdivisions of arbitrarily large complete graphs .",
    "thus this class is not contained in a proper topologically - closed class .",
    "however , it does have bounded expansion .",
    "let @xmath249 be a constant .",
    "the class of graphs @xmath6 that admit a drawing with at most @xmath100 crossings per edge has bounded expansion .",
    "precisely , @xmath261 .",
    "assume @xmath6 admits a drawing with at most @xmath100 crossings per edge .",
    "consider a subgraph @xmath12 of @xmath6 that is a @xmath80-subdivision of a graph @xmath36 .",
    "so @xmath36 has a drawing with at most @xmath262 crossings per edge .",
    "@xcite proved that if an @xmath1-vertex graph has a drawing with at most @xmath263 crossings per edge , then it has at most @xmath264 edges .",
    "thus @xmath265 hence @xmath266 .",
    "a graph @xmath6 is _ ordered _ if @xmath267 .",
    "let @xmath6 be an ordered graph .",
    "let @xmath268 and @xmath269 denote the endpoints of each edge @xmath270 such that @xmath271 .",
    "two edges @xmath272 and @xmath14 are _ nested _ and @xmath14 is _ nested inside _",
    "@xmath272 if @xmath273 and @xmath274 . two edges @xmath272 and @xmath14 _ cross _ if @xmath275 .",
    "an ordered graph is a _ queue _ if no two edges are nested .",
    "an ordered graph is a _ stack _ if no two edges cross .",
    "observe that the left and right endpoints of the edges in a queue are in first - in - first - out order , and are in last - in - first - out order in a stack  hence the names ` queue ' and ` stack ' .",
    "let @xmath6 be an ordered graph .",
    "@xmath6 is a @xmath263-_queue _ if there is a partition @xmath276 of @xmath22 such that each @xmath277 $ ] is a queue .",
    "@xmath6 is a @xmath263-_stack _ if there is a partition @xmath276 of @xmath22 such that each @xmath277 $ ] is a stack .",
    "let @xmath6 be an ( unordered ) graph .",
    "@xmath263-queue layout _ of @xmath6 is a @xmath263-queue that is isomorphic to @xmath6 .",
    "a _ @xmath263-stack layout _ of @xmath6 is a @xmath263-stack that is isomorphic to @xmath6 .",
    "a @xmath263-stack layout is often called a _",
    "@xmath263-page book embedding_. the _ queue - number _ of @xmath6 is the minimum integer @xmath263 such that @xmath6 has a @xmath263-queue layout .",
    "the _ stack - number _ of @xmath6 is the minimum integer @xmath263 such that @xmath6 has a @xmath263-queue layout .",
    "stack layouts are more commonly called _ book embeddings _ , and stack - number has been called _ book - thickness _ , _ fixed outer - thickness _ , and _ page - number_. see @xcite for references and applications of queue and stack layouts .",
    "@xcite proved that a graph has stack number @xmath60 if and only if it is outerplanar , and it has stack number at most @xmath278 if and only if it is a subgraph of a hamiltonian planar graph ( see figure  [ fig : sn ] ) .",
    "thus every @xmath279-connected planar graph has stack number at most @xmath278 .",
    "@xcite proved that every planar graph has stack number at most @xmath279 .",
    "in fact , every proper minor - closed class has bounded stack - number @xcite . on the other hand , even though stack and queue layouts appear to be dual , it is unknown whether planar graphs have bounded queue - number @xcite , and more generally , it is unknown whether queue - number is bounded by stack - number @xcite . @xcite proved that planar graphs have bounded queue - number if and only if @xmath278-stack graphs have bounded queue - number , and that queue - number is bounded by stack - number if and only if @xmath248-stack graphs have bounded queue - number .",
    "the largest class of graphs for which queue - number is known to be bounded is the class of graphs with bounded tree - width @xcite .",
    "-connected planar graph has stack number at most @xmath278 ( since it is hamiltonian ) ]    -queue layout of a given planar graph . ]    in the following two sections , we prove that graphs of bounded queue - number or bounded stack - number have bounded expansion .",
    "the closest previous result in this direction is that graphs of bounded queue - number or bounded stack - number have bounded acyclic chromatic number . in particular , @xcite proved that every @xmath263-queue graph has acyclic chromatic number at most @xmath280 , and every @xmath263-stack graph has acyclic chromatic number at most @xmath281 .",
    "[ sec : queue ]    every @xmath60-queue graph is planar @xcite .",
    "however , the class of @xmath278-queue graphs is not contained in a proper topologically - closed class since every graph has a @xmath278-queue subdivision , as proved by @xcite .",
    "moreover , the bound on the number of division vertices per edge is related to the queue - number of the original graph .",
    "[ thm : kqueuesubdiv ] for all @xmath282 , every graph @xmath6 has a @xmath263-queue subdivision with at most @xmath283 division vertices per edge , for some absolute constant @xmath100 .",
    "conversely , the same authors proved that queue - number is strongly topological .",
    "[ lem : subdivqueue ] if some @xmath59-subdivision of a graph @xmath6 has a @xmath263-queue layout , then @xmath284 , and if @xmath285 then @xmath286 .    also , queue - number is degree bound :    [ lem : sizequeue ] every @xmath263-queue graph has average degree less than @xmath287 .",
    "it now follows that :    [ thm : queueexpansion ] graphs of bounded queue - number have bounded expansion .",
    "in particular @xmath288 for every @xmath263-queue graph @xmath6 .",
    "consider a subgraph @xmath12 of @xmath6 that is a @xmath289-subdivision of a graph @xmath36 .",
    "thus @xmath290 , and @xmath291 by lemma  [ lem : subdivqueue ] .",
    "thus the average degree of @xmath36 is less than @xmath292 by lemma  [ lem : sizequeue ] .",
    "hence @xmath293 by theorem  [ thm : dvorak ] .",
    "note that there is an exponential lower bound on @xmath294  for graphs of bounded queue - number .",
    "fix integers @xmath282 and @xmath295 .",
    "let @xmath6 be the graph obtained from @xmath296 by subdividing each edge @xmath297 times , where @xmath298 .",
    "@xcite constructed a @xmath263-queue layout of @xmath6 .",
    "observe that @xmath299 .",
    "we now set out to give a direct proof of theorem  [ thm : queueexpansion ] that does not rely on dvok s characterisation ( theorem  [ thm : dvorak ] ) .",
    "consider a @xmath263-queue layout of a graph @xmath6 .",
    "for each edge @xmath54 of @xmath6 , let @xmath300 be the queue containing @xmath54 .",
    "for each ordered pair @xmath301 of adjacent vertices in @xmath6 , let @xmath302 note that @xmath303 has at most @xmath304 possible values .",
    "[ lem : edges ] let @xmath6 be a graph with a @xmath263-queue layout .",
    "let @xmath54 and @xmath305 be disjoint edges of @xmath6 such that @xmath306 . then @xmath307 if and only if @xmath308 .    without loss of generality ,",
    "@xmath309 and @xmath310 since @xmath311 .",
    "say @xmath307 .",
    "if @xmath312 then @xmath313 . thus @xmath305 is nested inside @xmath54 , which is a contradiction since @xmath314 .",
    "hence @xmath308 .",
    "say @xmath308 .",
    "if @xmath315 then @xmath316 . thus @xmath54 is nested inside @xmath305 , which is a contradiction since @xmath317 .",
    "hence @xmath307 .",
    "by induction , lemma  [ lem : edges ] implies :    [ lem : paths ] let @xmath6 be a graph with a @xmath263-queue layout .",
    "let @xmath318 and @xmath319 be disjoint paths in @xmath6 , such that @xmath320 for each @xmath321 $ ] . then @xmath322 if and only if @xmath323 .",
    "[ thm : contractqueue ] let @xmath6 be a graph with a @xmath263-queue layout .",
    "let @xmath8 be a subgraph of @xmath6 such that each component of @xmath8 has radius at most @xmath31 .",
    "let @xmath12 be obtained from @xmath6 by contracting each component of @xmath8 .",
    "then @xmath12 has a @xmath324-queue layout , where @xmath325    we can assume that @xmath8 is spanning by allowing @xmath60-vertex components in @xmath8 . for each component @xmath36 of @xmath8 fix a _ centre _",
    "vertex @xmath55 of @xmath36 at distance at most @xmath31 from every vertex in @xmath36 .",
    "call @xmath36 the _ @xmath55-component_.    consider a vertex @xmath326 of @xmath6 in the @xmath55-component of @xmath8 .",
    "fix a shortest path @xmath327 between @xmath55 and @xmath326 in @xmath8 . thus @xmath328 $ ] .",
    "let @xmath329    consider an edge @xmath330 of @xmath6 , where @xmath326 is in the @xmath55-component of @xmath8 , @xmath331 is in the @xmath56-component of @xmath8 , and @xmath332 .",
    "such an edge survives in @xmath12 .",
    "say @xmath309 .",
    "colour @xmath330 by the triple @xmath333 observe that the number of colours is at most @xmath334    from the linear order of @xmath6 , contract each component of @xmath8 into its centre .",
    "that is , the linear order of @xmath12 is determined by the linear order of the centre vertices in @xmath6 .",
    "after contracting there might be parallel edges with different edge colours .",
    "replace parallel edges by a single edge and keep one of the colours .",
    "consider disjoint monochromatic edges @xmath54 and @xmath305 of @xmath12 , where @xmath309 and @xmath310 . by construction , there are edges @xmath330 and @xmath335 of @xmath6 such that @xmath326 is in the @xmath55-component , @xmath331 is in the @xmath56-component , @xmath336 is in the @xmath27-component , @xmath337 is in the @xmath28-component , and @xmath338 thus @xmath339 and @xmath340 .",
    "consider the paths @xmath341 since @xmath342 , we have @xmath343 for each @xmath344 $ ] .",
    "similarly , since @xmath345 , we have @xmath346 for each @xmath347 $ ] . since @xmath348 , lemma  [ lem : paths ] is applicable to these two paths .",
    "thus @xmath307 if and only if @xmath310 .",
    "hence @xmath54 and @xmath305 are not nested .",
    "thus the edge colouring of @xmath12 defines a queue layout .",
    "theorem  [ thm : contractqueue ] implies theorem  [ thm : queueexpansion ] ( with a better bound on the expansion function ) since by lemma  [ lem : sizequeue ] , the graph @xmath12 in the statement of theorem  [ thm : contractqueue ] has bounded density . in particular ,",
    "if @xmath6 has a @xmath263-queue layout then @xmath349    theorem  [ thm : contractqueue ] basically says that minors and queue layouts are compatible , in the same way that queue layouts are compatible with subdivisions ; see lemma  [ lem : subdivqueue ] .",
    "let @xmath350 be a partially ordered set ( that is , a poset ) .",
    "the _ hasse diagram _ @xmath351 of @xmath350 is the graph whose vertices are the elements of @xmath350 and whose edges correspond to the _ cover relation _ of @xmath350 . here",
    "@xmath27 _ covers _",
    "@xmath28 in @xmath350 if @xmath352 and there is no element @xmath353 of @xmath350 such that @xmath354 .",
    "a _ linear extension _ of @xmath350 is a total order @xmath355 of @xmath350 such that @xmath356 implies @xmath357 for every @xmath358 .",
    "the _ jump number _ @xmath359 of @xmath350 is the minimum number of consecutive elements of a linear extension of @xmath350 that are not comparable in @xmath350 , where the minimum is taken over all possible linear extensions of @xmath350 .",
    "@xcite proved that the jump number of a poset is at least the queue number of its hasse diagram minus one ; that is , @xmath360 .",
    "it follows that the class of hasse diagrams of posets having bounded jump - number has bounded queue - number",
    ". thus theorem  [ thm : queueexpansion ] implies :    let @xmath361 be a class of posets with bounded jump number .",
    "then the class @xmath362 of the hasse diagrams of the posets in @xmath361 has bounded expansion .",
    "[ sec : stack ]    the class of @xmath248-stack graphs is not contained in a proper topologically - closed class since every graph has a @xmath248-stack subdivision @xcite .",
    "many authors studied bounds on the number of divisions vertices per edge in @xmath248-stack subdivisions , especially of @xmath296 .",
    "the most general bounds on the number of division vertices are by @xcite .    for all @xmath363 ,",
    "every graph @xmath6 has an @xmath364-stack subdivision with at most @xmath365 division vertices per edge , for some absolute constant @xmath100 .",
    "it is open whether a result like lemma  [ lem : subdivqueue ] holds for stack layouts .",
    "@xcite conjectured that such a result exists .",
    "[ con : bo ] there is a function @xmath14 such that @xmath366 for every graph @xmath6 and @xmath62-subdivision @xmath12 of @xmath6 .",
    "this conjecture would imply that stack - number is topological .",
    "this conjecture holds for @xmath367 as proved by @xcite , @xcite , and @xcite .",
    "the proofs by @xcite and @xcite use essentially the same ramsey - theoretic argument .",
    "@xcite proved the following bound for the density of graphs having a @xmath368-subdivision with a @xmath263-stack layout :    [ thm : subdivstack ] let @xmath6 be a graph such that some @xmath59-subdivision of @xmath6 has a @xmath263-stack layout for some @xmath369 .",
    "then @xmath370    it follows that graphs with bounded stack number form a class with bounded expansion :    [ thm : stackexpansion ] graphs of bounded stack number have bounded expansion . in particular : @xmath371 for every @xmath263-stack graph @xmath6 .",
    "@xmath372-stack graphs have bounded expansion since they are planar .",
    "let @xmath6 be a graph with stack - number @xmath373 for some @xmath369 .",
    "consider a subgraph @xmath12 of @xmath6 that is a @xmath374-subdivision of a graph @xmath36 .",
    "thus @xmath375 , and by theorem  [ thm : subdivstack ] , @xmath376 it follows that @xmath377 .",
    "the following open problem is equivalent to some problems in computational complexity @xcite .",
    "do @xmath248-stack @xmath1-vertex graphs have @xmath378 separators ?    see ( * ? ? ?",
    "* section  8) for results relating expansion and separators .",
    "[ sec : nonrep ] let @xmath14 be a colouring of a graph @xmath6 .",
    "then @xmath14 is _ repetitive _ on a path @xmath379 in @xmath6 if @xmath380 for each @xmath381 $ ] .",
    "if @xmath14 is not repetitive on every path in @xmath6 , then @xmath14 is _ non - repetitive_. let @xmath382 be the minimum number of colours in a non - repetitive colouring of @xmath6 .",
    "these notions were introduced by @xcite and have since been widely studied @xcite .",
    "the seminal result in this field , proved by @xcite in 1906 , ( in the above terminology ) states that @xmath383 .",
    "see @xcite for a survey of related results .",
    "note that a non - repetitive colouring is proper ( @xmath384 ) .",
    "moreover , a non - repetitive colouring contains no bichromatic @xmath19 ( @xmath385 ) , and is thus a star colouring .",
    "hence @xmath386 .",
    "the main result in this section is that @xmath387 is strongly topological , and that graphs with bounded @xmath387 have bounded expansion .",
    "the closest previous result is by @xcite who proved that @xmath388 for every graph @xmath6 , and thus @xmath389 .",
    "first observe :    [ lem : nonrepsub ] for every @xmath62-subdivision @xmath12 of a graph @xmath6 , @xmath390 for every @xmath391-subdivision @xmath12 of a graph @xmath6 , @xmath392 for every subdivision @xmath12 of a graph @xmath6 , @xmath393    first we prove ( a ) . given a non - repetitive @xmath263-colouring of @xmath6 ,",
    "introduce a new colour for each division vertex of @xmath12 .",
    "since this colour does not appear elsewhere , a repetitively coloured path in @xmath12 defines a repetitively coloured path in @xmath6 .",
    "thus @xmath12 contains no repetitively coloured path . part ( b ) follows by applying ( a ) twice .",
    "now we prove ( c ) .",
    "let @xmath1 be the maximum number of division vertices on some edge of @xmath6 .",
    "@xcite proved that @xmath394 has a non - repetitive @xmath248-colouring @xmath395 .",
    "arbitrarily orient the edges of @xmath6 . given a non - repetitive @xmath263-colouring of @xmath6 , choose each @xmath396 to be one of three new colours for each arc @xmath54 of @xmath6 that is subdivided @xmath35 times , colour the division vertices from @xmath55 to @xmath56 by @xmath397 .",
    "suppose @xmath12 has a repetitively coloured path @xmath350 .",
    "since @xmath57 is a collection of disjoint paths , each of which is non - repetitively coloured , @xmath350 includes some original vertices of @xmath6 .",
    "let @xmath398 be the path in @xmath6 obtained from @xmath350 as follows .",
    "if @xmath350 includes the entire subdivision of some edge @xmath54 of @xmath6 then replace that subpath by @xmath54 in @xmath398 .",
    "if @xmath350 includes a subpath of the subdivision of some edge @xmath54 of @xmath6 , then without loss of generality , it includes @xmath55 , in which case replace that subpath by @xmath55 in @xmath398 .",
    "since the colours assigned to division vertices are distinct from the colours assigned to original vertices , a @xmath58-vertex path of division vertices in the first half of @xmath350 corresponds to a @xmath58-vertex path of division vertices in the second half of @xmath350 .",
    "hence @xmath398 is a repetitively coloured path in @xmath6 .",
    "this contradiction proves that @xmath12 is non - repetitively coloured .",
    "hence @xmath399 .",
    "note that lemma  [ lem : nonrepsub](a ) is best possible in the weak sense that @xmath400 and @xmath401 ; see @xcite .    loosely speaking ,",
    "lemma  [ lem : nonrepsub ] says that non - repetitive colourings of subdivisions are not much  harder \" than non - repetitive colourings of the original graph .",
    "this intuition is made more precise if we subdivide each edge many times .",
    "then non - repetitive colourings of subdivisions are much  easier \" than non - repetitive colourings of the original graph . in particular , @xcite proved that every graph has a non - repetitively 5-colourable subdivision .",
    "this bound was improved to 4 by @xcite and by @xcite , and very recently to 3 by @xcite ; see @xcite for related results .",
    "this implies that the class of non - repetitively @xmath248-colourable graphs is not contained in a proper topologically - closed class .",
    "we now set out to prove a converse of lemma  [ lem : nonrepsub ] ; that is , @xmath382 is bounded by a function of @xmath402 . the following tool by @xcite will be useful .    [",
    "lem : nesras ] for every @xmath263-colouring of the arcs of an oriented forest @xmath152 , there is a @xmath403-colouring of the vertices of @xmath152 , such that between each pair of ( vertex ) colour classes , all arcs go in the same direction and have the same colour .    a _ rooting _ of a forest @xmath8",
    "is obtained by nominating one vertex in each component tree of @xmath8 to be a _ root _",
    "vertex .",
    "[ lem : nonrepforest ] let @xmath404 be the @xmath60-subdivision of a forest @xmath152 , such that @xmath405 .",
    "then @xmath406 moreover , for every non - repetitive @xmath263-colouring @xmath100 of @xmath404 , and for every rooting of @xmath152 , there is a non - repetitive @xmath407-colouring @xmath408 of @xmath152 , such that :    1 .   for all edges",
    "@xmath54 and @xmath305 of @xmath152 with @xmath409 and @xmath410 , the division vertices corresponding to @xmath54 and @xmath305 have the same colour in @xmath100 .",
    "2 .   for all non - root vertices @xmath55 and @xmath27 with @xmath409 , the division vertices corresponding to the parent edges of @xmath55 and @xmath27 have the same colour in @xmath100 .",
    "3 .   for every root vertex @xmath31 and every non - root vertex @xmath55 , we have @xmath411 .",
    "4 .   for all vertices @xmath55 and @xmath56 of @xmath152 , if @xmath412 then @xmath413 .    let @xmath100 be a non - repetitive @xmath263-colouring of @xmath404 , with colours @xmath414 $ ] .",
    "colour each edge of @xmath152 by the colour assigned by @xmath100 to the corresponding division vertex .",
    "orient each edge of @xmath152 towards the root vertex in its component . by lemma  [ lem : nesras ] , there is a @xmath403-colouring @xmath14 of the vertices of @xmath152 , such that between each pair of ( vertex ) colour classes in @xmath14 , all arcs go in the same direction and have the same colour in @xmath100 . consider a vertex @xmath55 of @xmath152 .",
    "if @xmath55 is a root , let @xmath415 ; otherwise let @xmath416 where @xmath56 is the parent of @xmath55 . let @xmath417 .",
    "the number of colours in @xmath408 is at most @xmath407 .",
    "observe that claims ( c ) and ( d ) hold by definition .",
    "we claim that @xmath408 is non - repetitive .",
    "suppose on the contrary that there is a path @xmath418 in @xmath152 that is repetitively coloured by @xmath408 .",
    "that is , @xmath419 for each @xmath420 $ ] .",
    "thus @xmath421 and @xmath380 and @xmath422 .",
    "since no two root vertices are in a common path , ( c ) implies that every vertex in @xmath350 is a non - root vertex .",
    "consider the edge @xmath423 of @xmath350 for some @xmath424 $ ] .",
    "we have @xmath380 and @xmath425 . between these two colour classes in @xmath14 ,",
    "all arcs go in the same direction and have the same colour .",
    "thus the edge @xmath423 is oriented from @xmath190 to @xmath426 if and only if the edge @xmath427 is oriented from @xmath428 to @xmath429 . and @xmath430 .",
    "if at least two vertices @xmath190 and @xmath191 in @xmath350 have indegree @xmath278 in @xmath350 , then some vertex between @xmath190 and @xmath191 in @xmath350 has outdegree @xmath278 in @xmath350 , which is a contradiction .",
    "thus at most one vertex has indegree @xmath278 in @xmath350 .",
    "suppose that @xmath190 has indegree @xmath278 in @xmath350 .",
    "then each edge @xmath431 in @xmath350 is oriented from @xmath191 to @xmath432 if @xmath433 , and from @xmath432 to @xmath434 if @xmath435 ( otherwise two vertices have indegree @xmath278 in @xmath350 ) .",
    "in particular , @xmath436 is oriented from @xmath437 to @xmath438 and @xmath439 is oriented from @xmath440 to @xmath441 .",
    "this is a contradiction since the edge @xmath436 is oriented from @xmath437 to @xmath438 if and only if the edge @xmath439 is oriented from @xmath441 to @xmath440 .",
    "hence no vertex in @xmath350 has indegree @xmath278 .",
    "thus @xmath350 is a directed path .",
    "without loss of generality , @xmath350 is oriented from @xmath437 to @xmath442 .",
    "let @xmath27 be the parent of @xmath442 .",
    "now @xmath443 and @xmath444 and @xmath445 .",
    "thus @xmath446 .",
    "summarising , the path @xmath447 in @xmath404 is repetitively coloured by @xmath100 .",
    "( here division vertices in @xmath404 are described by the corresponding edge . )  since @xmath100 is non - repetitive in @xmath404 , we have the desired contradiction . hence @xmath408 is a non - repetitive colouring of @xmath152 .",
    "it remains to prove claims ( a ) and ( b ) .",
    "consider two edges @xmath54 and @xmath305 of @xmath152 , such that @xmath409 and @xmath410 .",
    "thus @xmath448 and @xmath449 .",
    "thus @xmath54 and @xmath305 have the same colour in @xmath100 .",
    "thus the division vertices corresponding to @xmath54 and @xmath305 have the same colour in @xmath100 .",
    "this proves claim ( a ) . finally consider non - root vertices @xmath55 and @xmath27 with @xmath409 .",
    "thus @xmath450 .",
    "say @xmath56 and @xmath28 are the respective parents of @xmath55 and @xmath27 . by construction , @xmath451 .",
    "thus the division vertices of @xmath54 and @xmath305 have the same colour in @xmath100 .",
    "this proves claim ( b ) .",
    "we now extend lemma  [ lem : nonrepforest ] to apply to graphs with bounded acyclic chromatic number ; see @xcite for similar methods .",
    "[ lem : nonrepgraph ] let @xmath61 be the @xmath60-subdivision of a graph @xmath6 , such that @xmath452 and @xmath453 .",
    "then @xmath454    let @xmath125 be an acyclic @xmath455-colouring of @xmath6 , with colours @xmath456 $ ] .",
    "let @xmath100 be a non - repetitive @xmath263-colouring of @xmath61 .",
    "for distinct @xmath457 $ ] , let @xmath458 be the subgraph of @xmath6 induced by the vertices coloured @xmath459 or @xmath460 by @xmath125 .",
    "thus each @xmath458 is a forest , and @xmath100 restricted to @xmath461 is non - repetitive .",
    "apply lemma  [ lem : nonrepforest ] to each @xmath458 .",
    "thus @xmath462 , and there is a non - repetitive @xmath463-colouring @xmath464 of @xmath458 satisfying lemma  [ lem : nonrepforest](a)(d ) .",
    "consider a vertex @xmath55 of @xmath6 .",
    "for each colour @xmath465 $ ] with @xmath466 , let @xmath467 .",
    "define @xmath468,j\\neq p(v)\\big\\}\\big).\\ ] ] note that the number of colours in @xmath408 is at most @xmath469 we claim that @xmath408 is a non - repetitive colouring of @xmath6 .",
    "suppose on the contrary that some path @xmath418 in @xmath6 is repetitively coloured by @xmath408 .",
    "that is , @xmath470 for each @xmath471 $ ] .",
    "thus @xmath472 and for each @xmath471 $ ] .",
    "let @xmath473 .",
    "choose any @xmath465 $ ] with @xmath474 .",
    "thus @xmath475 and @xmath476",
    ". hence @xmath477 by lemma  [ lem : nonrepforest](d ) .",
    "consider an edge @xmath478 for some @xmath424 $ ] .",
    "let @xmath473 and @xmath479 .",
    "now @xmath470 and @xmath480 .",
    "thus @xmath481 and @xmath482 .",
    "moreover , @xmath475 and @xmath483 .",
    "that is , @xmath484 and @xmath485 .",
    "thus @xmath486 by lemma  [ lem : nonrepforest](a ) .",
    "consider the edge @xmath487 .",
    "let @xmath488 and @xmath489 . without loss of generality ,",
    "@xmath441 is the parent of @xmath490 in the forest @xmath458 . in particular",
    ", @xmath490 is not a root of @xmath458 . since @xmath491 and by lemma",
    "[ lem : nonrepforest](c ) , @xmath442 also is not a root of @xmath458 .",
    "let @xmath28 be the parent of @xmath442 in @xmath458 .",
    "by lemma  [ lem : nonrepforest](b ) applied to @xmath490 and @xmath442 , we have @xmath492 .",
    "summarising , the path @xmath493 is repetitively coloured in @xmath61 .",
    "this contradiction proves that @xmath6 is repetitively coloured by @xmath408 .",
    "lemmas  [ lem : nonrepgraph ] and [ lem : nonrepsub](a ) imply :    [ lem : nonrepgraphs ] let @xmath12 be a @xmath494-subdivision of a graph @xmath6 , such that @xmath495 and @xmath453 . then @xmath496    [ lem : constructacyclic ] let @xmath100 be a non - repetitive @xmath263-colouring of the 1-subdivision @xmath61 of a graph @xmath6 .",
    "then @xmath497    orient the edges of @xmath6 arbitrarily .",
    "let @xmath498 be the set of oriented arcs of @xmath6 .",
    "so @xmath100 induces a @xmath263-colouring of @xmath15 and of @xmath498 . for each vertex @xmath55 of @xmath6 ,",
    "let @xmath499 the number of possible values for @xmath500 is at most @xmath501 .",
    "we claim that @xmath408 is an acyclic colouring of @xmath6 .",
    "suppose on the contrary that @xmath502 for some arc @xmath54 of @xmath6 .",
    "thus @xmath413 and @xmath503 , implying @xmath504 .",
    "that is , for some arc @xmath505 , we have @xmath506 and @xmath507 .",
    "thus the path @xmath508 in @xmath61 is repetitively coloured .",
    "this contradiction shows that @xmath408 properly colours @xmath6 .",
    "it remains to prove that @xmath6 contains no bichromatic cycle ( with respect to @xmath408 ) .",
    "first consider a bichromatic path @xmath509 in @xmath6 with @xmath510 .",
    "thus @xmath511 .",
    "suppose on the contrary that @xmath350 is oriented @xmath512 , as illustrated in figure  [ fig : constructacyclic](a ) . by construction , @xmath513 ,",
    "implying @xmath514 .",
    "that is , @xmath515 and @xmath516 for some arc @xmath505 ( and thus @xmath517 ) .",
    "similarly , @xmath518 , implying @xmath519 .",
    "thus @xmath520 and @xmath521 for some arc @xmath522 ( and thus @xmath523 ) .",
    "hence the 8-vertex path @xmath524 in @xmath61 is repetitively coloured by @xmath100 , as illustrated in figure  [ fig : constructacyclic](b ) .",
    "this contradiction shows that both edges in @xmath350 are oriented toward @xmath55 or both are oriented away from @xmath55 .",
    "consider the case in which both edges in @xmath350 are oriented toward @xmath55 .",
    "suppose on the contrary that @xmath525 . by construction , @xmath526 ,",
    "implying @xmath527 .",
    "that is , @xmath515 and @xmath516 for some arc @xmath505 ( implying @xmath517 since @xmath525 ) .",
    "similarly , @xmath528 , implying @xmath529 .",
    "that is , @xmath530 and @xmath531 for some arc @xmath532 ( implying @xmath523 since @xmath533 ) .",
    "hence the path @xmath534 in @xmath535 is repetitively coloured in @xmath100 , as illustrated in figure  [ fig : constructacyclic](c ) .",
    "this contradiction shows that @xmath536 . by symmetry , @xmath536 when both edges in @xmath350 are oriented away from @xmath55 .",
    "hence in each component of @xmath61 , all the division vertices have the same colour in @xmath100 .",
    "every bichromatic cycle contains a 4-cycle or a 5-path .",
    "if @xmath6 contains a bichromatic 5-path @xmath537 , then all the division vertices in @xmath537 have the same colour in @xmath100 , and @xmath538 is a repetitively coloured path in @xmath61 , as illustrated in figure  [ fig : constructacyclic](d ) .",
    "similarly , if @xmath6 contains a bichromatic 4-cycle @xmath539 , then all the division vertices in @xmath539 have the same colour in @xmath100 , and @xmath540 is a repetitively coloured path in @xmath61 , as illustrated in figure  [ fig : constructacyclic](e ) .",
    "thus @xmath6 contains no bichromatic cycle , and @xmath408 is an acyclic colouring of @xmath6 .",
    "illustration for lemma  [ lem : constructacyclic ] . ]",
    "note that the above proof establishes the following stronger statement : if the 1-subdivision of a graph @xmath6 has a @xmath263-colouring that is non - repetitive on paths with at most @xmath541 vertices , then @xmath6 has an acyclic @xmath501-colouring in which each component of each 2-coloured subgraph is a star or a 4-path .    lemmas  [ lem : constructacyclic ] and [ lem : nonrepsub](a ) imply :    [ lem : constructacyclicc ] if some @xmath62-subdivision of a graph @xmath6 has a non - repetitive @xmath263-colouring , then @xmath542 .",
    "[ lem : subdiv2graph ] if @xmath495 for some @xmath494-subdivision of a graph @xmath6 , then @xmath543    @xmath544 by lemma  [ lem : constructacyclicc ] .",
    "the result follows from lemma  [ lem : nonrepgraphs ] with @xmath545 .",
    "[ cor : gensubdiv2graph ] there is a function @xmath14 such that @xmath546 for every @xmath547-subdivision @xmath12 of a graph @xmath6 .",
    "one of the most interesting open problems regarding non - repetitive colourings is whether planar graphs have bounded @xmath387 ( as mentioned in most papers regarding non - repetitive colourings ) .",
    "corollary  [ cor : gensubdiv2graph ] implies that to prove that planar graphs have bounded @xmath387 it suffices to show that every planar graph has a subdivision with bounded @xmath387 and a bounded number of division vertices per edge .",
    "this shows that conjectures 4.1 and 5.2 in @xcite are equivalent .",
    "we now get to the main results of this section . lemmas  [ lem : subdiv2graph ] and [ lem : nonrepsub](a ) imply :    [ thm : nonreptopo ] @xmath387 is strongly topological .",
    "@xmath387 is degree - bound since every graph @xmath6 has a vertex of degree at most @xmath548 ; see ( * ? ? ?",
    "* proposition 5.1 ) . since @xmath387 is hereditary , lemma  [ lem : topoexp ] and theorem  [ thm : nonreptopo ]",
    "imply :    for every constant @xmath100 the class of graphs @xmath549 has bounded expansion .",
    "corollary  [ cor : gensubdiv2graph ] with @xmath367 implies that there is a function @xmath14 such that for every @xmath547-subdivision @xmath12 of @xmath296 , @xmath550 and @xmath551 for all fixed @xmath35 .",
    "we now obtain reasonable bounds on @xmath14 .",
    "[ lem : knd ] let @xmath552 be the @xmath35-subdivision of @xmath296 .",
    "then @xmath553    suppose on the contrary that @xmath554 .",
    "fix a non - repetitive @xmath100-colouring of @xmath552 .",
    "orient each edge of @xmath296 arbitrarily .",
    "colour each arc @xmath54 of @xmath296 by the @xmath35-vector of colours assigned to the division vertices on the path from @xmath55 to @xmath56 in @xmath552 .",
    "the number of arc colours is at most @xmath555 .",
    "let @xmath556 .",
    "there is a @xmath557 subgraph of @xmath296 whose vertices are monochromatic in @xmath408 , and there is a subgraph @xmath12 of @xmath557 consisting of at least @xmath558 monochromatic arcs .",
    "now @xmath559 .",
    "thus @xmath560 and @xmath561 .",
    "hence @xmath12 has at least @xmath125 arcs .",
    "if @xmath12 contains a vertex @xmath55 with an incoming arc @xmath562 and an outgoing arc @xmath54 , then @xmath552 contains a repetitively coloured path on @xmath563 vertices , as illustrated in figure  [ fig : pathcyclepath](a ) .",
    "thus for every vertex @xmath55 of @xmath12 , all the arcs incident to @xmath55 are incoming or all are outgoing .",
    "in particular , @xmath12 has no triangle .",
    "since @xmath12 has at least @xmath125 arcs , the undirected graph underlying @xmath12 contains a cycle .",
    "if @xmath12 contains a 4-cycle then @xmath552 contains a repetitively coloured path on @xmath564 vertices , as illustrated in figure  [ fig : pathcyclepath](b ) .",
    "otherwise the undirected graph underlying @xmath12 contains a @xmath565-vertex path , in which case , @xmath552 contains a repetitively coloured path on @xmath564 vertices , as illustrated in figure  [ fig : pathcyclepath](c ) .",
    "this is the desired contradiction .",
    "illustration for lemma  [ lem : knd ] . ]    lemmas  [ lem : knd ] and [ lem : nonrepsub](c ) imply :    [ cor : generalcompletesubdivision ] if @xmath12 is a @xmath547-subdivision of @xmath296 then @xmath566    determining @xmath567 is an interesting open problem .",
    "the lower bound @xmath568 follows from a result by @xcite , and also follows from the previously mentioned lower bound @xmath569 by @xcite .",
    "here is the best known upper bound .",
    "[ prop : completegraphfirstsubdiv ] @xmath570 .",
    "let @xmath571 . in @xmath572",
    ", let @xmath573 be the original vertices , and let @xmath574 be the division vertex having @xmath575 and @xmath576 as its neighbours .",
    "colour each original vertex @xmath577 by @xmath578 .",
    "colour each division vertex @xmath579 by @xmath580 if @xmath581 .",
    "colour each division vertex @xmath582 by @xmath583 where @xmath584 .",
    "suppose that @xmath585 is a repetitively coloured path . by parity , @xmath586 is even .",
    "first suppose that @xmath587 .",
    "then @xmath350 contains some transition @xmath152 .",
    "observe that each transition is uniquely identified by the three colours that it receives .",
    "in particular , the only transition coloured @xmath588 with @xmath581 is @xmath589 . and",
    "the only transition coloured @xmath590 is @xmath591 .",
    "thus @xmath152 is repeated in @xmath592 , which is a contradiction .    otherwise @xmath593 .",
    "thus @xmath585 is coloured @xmath594 for some @xmath584 .",
    "but the only edges coloured @xmath595 are the two edges in the transition @xmath591 , which again is a contradiction .",
    "hence there is no repetitively coloured path .",
    "the number of colours is @xmath596 .",
    "we now determine @xmath597 to within a constant factor .",
    "[ lem : completegraphsubdiv ] let @xmath598 and @xmath599 and @xmath600 be integers .",
    "if @xmath601 then @xmath602 .",
    "let @xmath603 be a non - repetitive sequence such that @xmath604 and @xmath605 .",
    "let @xmath355 be a total ordering of the original vertices of @xmath552 .",
    "since @xmath601 , the original vertices of @xmath552 can be labelled @xmath606    colour each original vertex @xmath55 by @xmath607 .",
    "consider a pair of original vertices @xmath55 and @xmath56 with @xmath608 .",
    "if @xmath609 is the transition from @xmath55 to @xmath56 , then for @xmath610 $ ] , colour the division vertex @xmath611 by @xmath612 where @xmath613 is the indicator function of @xmath614 .",
    "we say this transition is _ rooted _ at @xmath55 .",
    "observe that the number of colours is at most @xmath615 .",
    "every transition is coloured @xmath616 for some @xmath617 $ ] and @xmath618 $ ] and @xmath619 .",
    "every such transition is rooted at the original vertex @xmath620 .",
    "that is , the colours assigned to a transition determine its root .",
    "suppose on the contrary that @xmath621 is a repetitively coloured path in @xmath552 .",
    "since every original vertex receives a distinct colour from every division vertex , for all @xmath622 $ ] , @xmath623 is an original vertex if and only if @xmath624 is an original vertex , and @xmath623 is a division vertex if and only if @xmath624 is a division vertex .    by construction ,",
    "every transition is coloured non - repetitively .",
    "thus @xmath350 contains at least one original vertex , implying @xmath625 contains at least one original vertex .",
    "if @xmath625 contains at least two original vertices , then @xmath625 contains a transition @xmath626 , implying @xmath627 is another transition receiving the same tuple of colours .",
    "thus @xmath626 and @xmath627 are rooted at the same original vertex , implying @xmath350 is not a path .",
    "now assume there is exactly one original vertex @xmath623 in @xmath625 .",
    "thus @xmath628 is the only original vertex in @xmath629 .",
    "hence @xmath630 is a transition , implying @xmath631 . without loss of generality , @xmath632 and this transition is rooted at @xmath623 .",
    "let @xmath633 and @xmath634 . for @xmath635 $ ] , the vertex @xmath636 is the @xmath460-th vertex in the transition from @xmath55 to @xmath56 , and is thus coloured @xmath637 .",
    "suppose that @xmath638 .",
    "let @xmath27 be the original vertex such that the transition between @xmath56 and @xmath27 contains @xmath639 .",
    "now @xmath640 since @xmath641 , we have @xmath642 . for @xmath643 $ ]",
    ", the vertex @xmath644 is the @xmath460-th vertex in the transition from @xmath56 to @xmath27 , and thus @xmath645 in particular , @xmath646 for all @xmath643 $ ] .",
    "note that if @xmath647 then this conclusion is vacuously true .",
    "now suppose that @xmath648 .",
    "let @xmath649 be the original vertex such that the transition between @xmath649 and @xmath55 contains @xmath650 .",
    "now @xmath651 since @xmath652 , we have @xmath653 . for @xmath654 $ ] ,",
    "the vertex @xmath655 is the @xmath460-th vertex in the transition from @xmath649 to @xmath55 , and thus @xmath656 in particular , @xmath657 and @xmath658 .",
    "thus @xmath646 for all @xmath654 $ ] .",
    "note that if @xmath659 then this conclusion is vacuously true .",
    "hence @xmath646 for all @xmath635 $ ] .",
    "now @xmath55 is coloured @xmath660 , and @xmath56 is coloured @xmath661 . since @xmath662 and @xmath663 receive the same colour , @xmath664 .",
    "therefore @xmath646 for all @xmath665 $ ] .",
    "that is , @xmath666 , which is the desired contradiction .",
    "therefore there is no repetitively coloured path in @xmath552 .",
    "[ thm : completegraphsubdiv ] for @xmath600 , @xmath667    the lower bound is lemma  [ lem : knd ] .",
    "the upper bound is lemma  [ lem : completegraphsubdiv ] with @xmath668 and @xmath669 .",
    "as mentioned earlier , @xmath296 has a subdivision @xmath12 with @xmath670 .",
    "all known constructions of @xmath12 use at least @xmath671 division vertices on some edge  some use @xmath672 division vertices on every edge .",
    "we now show that @xmath673 division vertices is best possible .",
    "the @xmath674-subdivision of @xmath296 has a non - repetitive @xmath675-colouring .",
    "moreover , if @xmath12 is a subdivision of @xmath296 and @xmath676 then some edge of @xmath296 is subdivided at least @xmath677 times .",
    "the upper bound follows from lemma  [ lem : completegraphsubdiv ] with @xmath678 and @xmath679 .",
    "( note that the bound of @xmath675 can be easily lowered with a little more proof . )  for the lower bound , suppose that @xmath12 is a @xmath547-subdivision of @xmath296 and @xmath676 . by corollary  [ cor : generalcompletesubdivision ] , @xmath680 .",
    "that is , @xmath681 .",
    "hence some edge of @xmath12 is subdivided at least @xmath677 times .",
    "we conclude this section with a final observation about repetitive colourings . @xcite",
    "_ strong star colouring _ of a graph @xmath6 to be a colouring such that between each pair of colour classes all the edges are incident to a single vertex .",
    "that is , each bichromatic subgraph is a star plus isolated vertices .",
    "if @xmath379 is a repetitively coloured path , then @xmath436 and @xmath439 are bichromatic edges with no vertex in common .",
    "thus every strong star colouring is non - repetitive .",
    "the authors would like to thank vida dujmovi for simplifying a clumsy proof in an early draft of the paper .",
    "aeolus , 2006 .",
    "structural properties of overlay computers : state of the art survey and algorithmic solutions .",
    "deliverable d1.1.1 , project ip - fp6 - 015964 of eec .",
    "http://aeolus.ceid.upatras.gr/sub-projects/deliverables/d111.pdf                                            dawar , a. , 2007 .",
    "finite model theory on tame classes of structures . in : kuv cera ,",
    "l. , kuera , a. ( eds . ) , mathematical foundations of computer science 2007 .",
    "4708 of lecture notes in computer science .",
    "springer , pp .",
    "devos , m. , ding , g. , oporowski , b. , sanders , d.  p. , reed , b. , seymour , p. , vertigan , d. , 2004 . excluding any graph as a minor allows a low tree - width 2-coloring .",
    "j. combin .",
    "theory ser .",
    "b 91  ( 1 ) , 2541 .",
    "eppstein , d. , 2002 . separating thickness from geometric thickness . in : goodrich , m.  t. , kobourov , s.  g. ( eds . ) , proc . 10th international symp . on graph drawing ( gd 02 ) .",
    "2528 of lecture notes in comput .",
    "springer , pp .",
    "150161 .",
    "neetil , j. , ossona  de mendez , p. , 2005 .",
    "the grad of a graph and classes with bounded expansion . in : raspaud ,",
    "a. , delmas , o. ( eds . ) , 7th international colloquium on graph theory .",
    "22 of electronic notes in discrete mathematics .",
    "elsevier , pp . 101106 .",
    "neetil , j. , ossona  de mendez , p. , 2006 .",
    "linear time low tree - width partitions and algorithmic consequences . in : stoc06 .",
    "proceedings of the 38th annual acm symposium on theory of computing .",
    "acm press , pp .",
    "391400 .",
    "neetil , j. , ossona  de mendez , p. , 2008 .",
    "structural properties of sparse graphs . in : grtschel , m. , katona ,",
    "g.  o. ( eds . ) , building bridges between mathematics and computer science .",
    "19 of bolyai society mathematical studies , springer . edited in honour of l.  lovsz on his 60th birthday"
  ],
  "abstract_text": [
    "<S> classes with bounded expansion , which generalise classes that exclude a topological minor , have recently been introduced by neetil and ossona  de  mendez . </S>",
    "<S> these classes are defined by the fact that the maximum average degree of a shallow minor of a graph in the class is bounded by a function of the depth of the shallow minor . </S>",
    "<S> several linear - time algorithms are known for bounded expansion classes ( such as subgraph isomorphism testing ) , and they allow restricted homomorphism dualities , amongst other desirable properties .    in this paper we establish two new characterisations of bounded expansion classes , one in terms of so - called topological parameters , the other in terms of controlling dense parts . </S>",
    "<S> the latter characterisation is then used to show that the notion of bounded expansion is compatible with erds - rnyi model of random graphs with constant average degree . in particular </S>",
    "<S> , we prove that for every fixed @xmath0 , there exists a class with bounded expansion , such that a random graph of order @xmath1 and edge probability @xmath2 asymptotically almost surely belongs to the class .    </S>",
    "<S> we then present several new examples of classes with bounded expansion that do not exclude some topological minor , and appear naturally in the context of graph drawing or graph colouring . </S>",
    "<S> in particular , we prove that the following classes have bounded expansion : graphs that can be drawn in the plane with a bounded number of crossings per edge , graphs with bounded stack number , graphs with bounded queue number , and graphs with bounded non - repetitive chromatic number . </S>",
    "<S> we also prove that graphs with ` linear ' crossing number are contained in a topologically - closed class , while graphs with bounded crossing number are contained in a minor - closed class . </S>"
  ]
}