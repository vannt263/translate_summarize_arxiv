{
  "article_text": [
    "polarimetric imaging produces multi - dimensional pixel data that is either interpreted in terms of polarimetric properties of the imaged objects , or quite often , processed into a single image revealing specific contrasts which may not appear on standard reflectance images . in simplified polarimetric imaging systems , a pair of monochromatic images",
    "are acquired along two orthogonal polarization directions .",
    "the two - dimensional pixel data obtained can then be presented by either color encoding or by a combination of the two components so as to enhance contrast between objects in a scene sharing different polarimetric properties .",
    "such contrast - maximizing representation of the polarimetric information can prove helpful in underwater polarimetric imaging @xcite and imaging through turbid media @xcite ( like colloids @xcite , tissues @xcite and fog @xcite ) .",
    "in most laboratory based imaging experiments @xcite , the scene is static and the object of interest is usually embedded in a uniform background , thus allowing for processing over multiple frames acquired over a period of time .",
    "however , in real - world scenarios with fast moving scene and/or camera , it is often desirable to reach real - time imaging and processing .",
    "this requires the identification and use of computationally simple and optimal representations of the polarimetric images that are adapted to the experimental scenarios at hand .    in this article",
    ", we address the specific issue of contrast enhancement of an intentionally polarized beacon of light ( or semaphore ) , imaged at a long distance through obscured atmosphere with a polarization - sensitive camera .",
    "such situation is of great interest for applications in transportation safety . in this context , we demonstrate , both analytically and experimentally , that an optimal processing of the polarimetric images allows such contrast maximization under all experimental conditions encountered .",
    "the optimal polarimetric representation derived differs from commonly used polarimetric contrasts , but remains computationally compatible with real - time processing at video rate , which is a stringent constraint in the applicative context considered here .",
    "this article is organized as follows : in section [ exp ] , the experimental setup is described , as well as the statistical measure used to assess the contrast of the source in the image . then , the numerical and theoretical derivation of an optimal polarimetric representation is reported in section [ optrep ] .",
    "the efficiency of this optimal representation to enhance contrast of a polarized source through fog is then discussed on experimental data in section [ discus ] , allowing us to confirm theoretical predictions in real field conditions .",
    "conclusion and perspectives of this article are finally given in section [ conc ] .",
    "the long distance polarimetric imaging experiment described in the following has been set up in the vicinity of the campus of university of rennes 1 to gather experimental data on real atmospheric conditions .",
    "the imaging experiment covers a kilometric distance which is the typical range of distance one aims at for transportation safety applications like air and sea transport .",
    "a thorough description of this experimental facility and of the snapshot polarimetric imager designed is reported in @xcite , along with a detailed depiction of the experiment control and calibration procedure .",
    ".5   and @xmath0 on a single camera ( c ) using lens l3 .",
    "( b ) a subset of the raw images from the polarimetric camera , showing the tower and the source with varying conditions of fog density and visibility .",
    "the 8 images are sorted in increasing order of background correlation ( @xmath1 ) estimated over a small roi surrounding the source pixel .",
    "the time stamp of acquisition is indicated below each image.,title=\"fig : \" ]    .5   and @xmath0 on a single camera ( c ) using lens l3 .",
    "( b ) a subset of the raw images from the polarimetric camera , showing the tower and the source with varying conditions of fog density and visibility .",
    "the 8 images are sorted in increasing order of background correlation ( @xmath1 ) estimated over a small roi surrounding the source pixel .",
    "the time stamp of acquisition is indicated below each image.,title=\"fig : \" ]    the experiment basically consists of a highly linearly polarized source of incoherent light , placed on a telecommunication tower ( about 80  m in height and 1.3  km far from the detection site at the laboratory ) , and a wollaston - prism based polarimetric camera for imaging . the experimental setup reported in @xcite",
    "is improved here using a higher dynamics , low noise camera ( andor neo scmos 5.5 mpixels , 16-bit , 0.015 e-/pixel / s dark noise at -30@xmath2c sensor temperature ) which is more suitable for this experiment .",
    "such high - dynamics detector enables finer sampling of intensity levels and noise statistics in the acquired images .",
    "the entire imaging system has been thoroughly re - calibrated with this new camera .",
    "as mentioned before and shown in the schematic in fig .",
    "[ exptsetup ] , the source is imaged from a distance of about 1.3 km , and the snapshot polarimetric imager enables the simultaneous acquisition of two images on the camera ( namely , @xmath3 and @xmath0 ) corresponding to the two orthogonal polarization directions , with @xmath3 aligned with the direction of polarization of the source . for the purpose of illustration in this article , we pick a dataset of images taken during an experiment conducted on 24 - 01 - 2014 between 1:00 p.m. and 2:20 p.m. ( at a time interval of 1 frame/10 seconds ) . during this 80 minutes acquisition ,",
    "successive passing fog layers obscured the source intermittently , causing the visibility of the source to evolve rapidly and significantly .",
    "an example of 8 frames acquired by the polarimetric camera can be observed in fig .",
    "[ fig : raw ] .      using the image registration method described in @xcite ,",
    "the two images can be extracted to form a set of two - dimensional pixels , such that the @xmath4 pixel @xmath5^t$ ] is a part of the polarimetric image @xmath6 } = [ i_\\parallel , i_\\perp]^t$ ] . in practice , this two - dimensional data is processed to provide the end - user with a final contrast image , or to feed a higher - level image processing algorithm ( detection and tracking , segmentation , etc . ) . for that purpose , the recorded two - dimensional data can be represented by a linear combination of both images @xmath3 and @xmath0 , i.e. , as a projection of the individual vectors @xmath7 over a row vector @xmath8 $ ] .",
    "thus , a linear representation denoted generically by @xmath9 can be written as @xmath10    in each such representation , the source will have different contrast and with different overall scaling depending on the values of @xmath11 and @xmath12 . as a result",
    ", we resort to a contrast - to - noise ratio ( cnr ) in order to fairly compare the contrast of the source in each representation . using a local region of interest ( roi ) of size 21 @xmath13 21 pixels around the source , we identify two sets of pixels ( shown as colored squares in fig .",
    "[ fig : visual ] and described in the caption ) denoted by @xmath14 ( _ background _ ) and @xmath15 ( _ source _ ) , and we define the cnr of the source in a general representation @xmath9 as @xmath16 where , @xmath17 respectively stand for the empirical mean and variance over region @xmath18 , with cardinality @xmath19 .",
    "this contrast measure returns the local contrast of a central pixel w.r.t .",
    "its immediate background and remains invariant under scaling of the gray levels in the image , i.e. , for different values of @xmath20 $ ] . in a general case",
    ", the intervening medium may be birefringent and thus the values of @xmath11 and @xmath12 can range between [ -1,1 ] .",
    "however , for non - birefringent medium , where no rotation of polarization is observed , the weight ( @xmath11 ) of @xmath3 remains non - zero and thus can be scaled out so that the representation depends only on the weight ( @xmath12 ) of @xmath0 .",
    "further , for a generic representation @xmath9 , we define a gain in contrast with respect to an intensity - summed image ( @xmath21 ) which would be acquired with a standard camera . for brevity",
    ", we denote this gain as    @xmath22",
    "several combinations of the acquired polarimetric images can be envisaged for producing a final contrast image . in the context of this article , we aim at maximizing the cnr of a polarized light source over a background .",
    "this naturally raises the question of finding the optimal representation that provides the best contrast independent of the atmospheric situation , while remaining computationally efficient to match real - time requirements . before deriving such optimal representation ,",
    "let us first recall standard polarimetric representations which are commonly used in the literature for various applications in polarimetric imaging .      from the two acquired polarimetric images @xmath3 and",
    "@xmath0 , most simple and standard representations are :    [ [ intensity - summed - image - gamma_sigma-1 - 1-i_p ] ] intensity - summed image ( @xmath23\\ ,          i_p$ ] ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    such combination qualitatively provides the image that would be acquired with a standard , polarization - insensitive camera .",
    "thus , other representations can be compared as a gain with respect to the intensity - summed image .",
    "[ [ polarization - filtered - image - gamma_parallel-1 - 0-i_p ] ] polarization filtered image ( @xmath24\\ , i_p$ ] ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    another very simple approach is to use a polarization - filtered image , which can be obtained on our setup by retaining only the polarimetric image corresponding to the direction of polarization of the light source .    [ [ polarization - difference - image - gamma_delta-1 - -1-i_p ] ] polarization - difference image ( @xmath25 \\ , i_p$ ] ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    computing a difference image by subtracting the two polarimetric frames acquired is a very standard technique , widely used in polarimetric imaging @xcite for its efficiency in contrast enhancement . in the first experiments conducted with the imaging system described above , it was indeed noticed that the difference image performs generally better than the other standard representations @xcite .",
    "nevertheless , it was also observed that @xmath26 does not always provide the best possible contrast in the context of polarimetric imaging through fog considered in this article .",
    "[ [ orthogonal - states - contrast - image - oscgamma_delta - gamma_sigma ] ] orthogonal states contrast image ( @xmath27 ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this polarimetric contrast is obtained by normalizing the difference image by the intensity - summed image .",
    "it is widely used and has proved efficient in active polarimetric imaging for its ability to provide an estimate of the degree of polarization of light scattered by an object ( or an imaged scene)@xcite .",
    "however , it was shown that such normalization tends to increase the noise in the final image due to possible low intensity values in the intensity - summed image @xcite .",
    "for that reason , and due to the fact that the osc can not be written as a linear combination of @xmath3 and @xmath0 , this representation will not be considered in the remainder of this article .    in the next subsections",
    ", we derive an optimal polarimetric representation , which in general differs from the most classical ones , whose expressions are summarized in table [ tab ] .    .65   and [ b ] in fig .",
    "[ fig : raw ] .",
    "the source region , @xmath15 is bounded by the 3 @xmath13 3 pixels red square and @xmath14 is the background region between the two blue squares of sizes 11 @xmath13 11 pixels and 21 @xmath13 21 pixels .",
    "( b ) cnr - maximizing 1d search over values of @xmath12 keeping @xmath28 for the two frames .",
    ", title=\"fig : \" ]    .35   and [ b ] in fig .",
    "[ fig : raw ] .",
    "the source region , @xmath15 is bounded by the 3 @xmath13 3 pixels red square and @xmath14 is the background region between the two blue squares of sizes 11 @xmath13 11 pixels and 21 @xmath13 21 pixels .",
    "( b ) cnr - maximizing 1d search over values of @xmath12 keeping @xmath28 for the two frames .",
    ", title=\"fig : \" ]      it is possible to determine the optimal projection numerically for each acquired frame by a simple grid search over possible coefficient vectors @xmath29 . as a result ,",
    "the optimal representation , denoted @xmath30 $ ] in the following , is obtained by computationally solving @xmath31 for @xmath32 $ ] and @xmath33 $ ] and obtaining an image @xmath34 . on the resulting processed images of two individual frames in fig .",
    "[ fig : visual ] , on the roi defined above , it can be checked that a significant contrast enhancement can be obtained over the difference image @xmath26 and the intensity - summed image @xmath35 , which indicates that the optimal representation @xmath36 differs , in these cases , from both @xmath26 and @xmath35 .",
    "it can be observed that for the frame labeled [ a ] , the optimal representation is very close to a polarization - filtered image @xmath37 . on the other hand , for the frame [ b ]",
    ", the computational search leads to optimal weight of @xmath38 corresponding to an intermediate situation between representations @xmath26 and @xmath37 .",
    "as observed in the previous subsection , the optimum linear combination of the polarimetric images for contrast enhancement may differ from the commonly used polarimetric representations , and may vary from frame to frame .",
    "accordingly , identifying the physical parameter that influences the weights of the optimum linear combination would make it possible to implement an adaptive representation of polarimetric image that provides the best contrast for any weather condition .",
    "however , in such a long distance imaging setup , there is no a priori knowledge of the properties of the intervening medium , and thus we rely on the noise properties of the image .",
    "we hypothesize a correlated gaussian noise model treating each pixel @xmath39 as a bivariate random variable having a mean of @xmath40^t$ ] at the source location and @xmath41^t$ ] outside the source location . here ,",
    "@xmath42 and @xmath43 denote the mean intensities of the highly polarized source and the depolarized background , respectively .",
    "the second - order statistical properties of @xmath44 are modeled by the covariance matrix @xmath45 defined as @xmath46 where @xmath47 stands for the standard deviation of the overall multiplicative optical noise , which is likely to be partially correlated in polarimetric channels especially in snapshot imaging .",
    "the correlation coefficient is denoted by @xmath1 . with such statistical noise model ,",
    "the theoretical expression of the cnr of a generic representation @xmath9 has been derived in appendix .",
    "the obtained expression can be easily and analytically maximized w.r.t .",
    "@xmath1 , which indeed leads to the following linear representation @xmath48 with @xmath49 $ ] .",
    "this provides a simple adaptive representation where the background noise correlation coefficient , @xmath1 , which can be in practice estimated locally over the region @xmath14 using the following empirical estimator    @xmath50    where @xmath51 still denotes the background region comprised between the two blue squares of sizes 11 @xmath13 11 pixels and 21 @xmath13 21 pixels depicted in fig .  [",
    "fig : visual ] .",
    "this representation is denoted as @xmath52 ( for maximum likelihood ) since , for the experimental conditions at hand ( with highly polarized source and completely depolarized background ) , its form could be equivalently derived from a likelihood maximizing approach @xcite . using this representation on the same dataset",
    ", it can be seen in fig .",
    "[ fig : visual].a that @xmath36 and @xmath52 consistently provide enhanced contrast compared to other simple polarimetric representations . as can be observed in fig .",
    "[ fig : visual].b , these representations are almost equivalent , the small discrepancy between each other being due to numerical errors in the computation of the estimators and/or to possible deviation of the actual statistics from a gaussian model .",
    "this result is verified over the entire dataset and further discussed in the next section .",
    "in fig .  [ fig : timeseriesgain ] , we plot the time evolution of the gain in cnr defined in eq.([eq : gainsym ] ) for each representation . for reference , the cnr @xmath53 is shown as black - dotted line in the bottom of fig .",
    "[ fig : timeseriesgain ] .",
    "the comparison confirms that the difference image @xmath26 ( solid red lines ) is not always the best representation and in many cases is outperformed by a simple ` polarization - filtered ' image @xmath37 , i.e. , the raw @xmath3 image ( solid , filled green ) .",
    "furthermore , @xmath36 ( solid black ) , presents the best contrast gain , and in general differs from both @xmath26 and @xmath37 .",
    "it can be clearly observed that the gain in source contrast in the ml representation ( @xmath52 ) closely follows the best possible gain obtained with @xmath36 , i.e. , with a computational search over all possible linear combinations . as a result , this simple analytical representation behaves adaptively to present the best source contrast in the final image for all fog density conditions .",
    "these experimental results also quantify the advantage in using a polarimetric camera for long distance contrast - enhancement of a polarized beacon through fog , as the cnr gain rises from 2-fold to a maximum of 12-fold compared to an intensity - summed image which is qualitatively similar to an image obtained from a standard intensity camera .",
    "it must be noticed at this level that the noise statistics of an intensity - summed image may differ in general from the ones obtained with a true intensity imager .",
    "as shown in appendix , a fair comparison with a true intensity imager would imply a gain comprised between 2 and 6-fold , for the noise model considered .    v / c / v / c / v / c / v / c / v + & & & & & w & & g^=c()/c ( _ ) +   +   + & & & _ & & [ 1,1 ] & & 1 +   +   +   + & & & _ & & [ 1,0 ] & & +   +   +   + & & & _ & & [ 1,-1 ] & & +   +   +   + & & & _ cs & & [ 1,v_cs ] & & - +   +   +   + & & & _ ml & & [ 1,- ] & & +   +    * *      as stated in the previous section , the derivation of the ml representation allowed us to identify the background correlation , @xmath1 , as a crucial factor in determining the optimal contrast linear representation . in the above framework it is straightforward to calculate the theoretical cnr for each representation and thus compute the functional dependence of the gain in contrast with the correlation parameter ( see appendix ) .",
    "the theoretical forms are tabulated in table  [ tab ] and plotted as solid lines in fig .",
    "[ fig : corrgain ] .",
    "furthermore , the experimentally generated contrast gains are plotted alongside ( scattered symbols ) as a function of locally estimated background correlation .",
    "the plot shows that the cnr gain for each representation depends on @xmath1 in an orderly fashion which was not obvious in the ` noisy ' time - series data in fig .",
    "[ fig : timeseriesgain ] .",
    "it is interesting to notice that the difference image @xmath26 gives the best cnr with high values of @xmath1 , but is outperformed by the polarization - filtered image @xmath37 as the value of @xmath1 falls bellow 0.5 .",
    "the performance of @xmath37 remains linear with @xmath1 , with a maximum gain of 2 for high values of @xmath1 , while that of @xmath26 rises steeply when @xmath54 .",
    "again , the optimality of the ml representation is clearly seen , as it corresponds to the best contrast representation for all values of @xmath1 .",
    "+ the @xmath1-dependant performance of the studied representations ( particularly @xmath26 and @xmath52 ) can be interpreted by noting that , in the present context , @xmath1 is a measure of the visibility of background structure in the local scene or local non - uniformity in reflectance .",
    "this can also be checked on the frames shown in fig .",
    "[ fig : raw ] that are sorted in increasing order of @xmath1 . as a result",
    ", the main benefit of @xmath26 relies in its ability to suppress highly structured ( and thus correlated ) background in the final image .",
    "this property is retained by the @xmath52 , which identifies with @xmath26 for @xmath55 .",
    "on the other hand , with uncorrelated background ( @xmath56 ) , the perpendicular image @xmath0 does not bring any further information , making @xmath37 optimal during very low visibility conditions .",
    "the experiment also quantifies the advantage in using a polarimetric camera as we observe a maximum cnr gain of 12-fold compared to the intensity - summed image which is qualitatively similar to an image obtained from standard intensity camera .",
    "( red solid lines ) and @xmath36 representation ( black solid line ) w.r.t the intensity - summed image @xmath35 .",
    "the blue crosses show the gain obtained with @xmath52 representation , which can be seen to follow the maximum attainable contrast .",
    "the green filled curve shows the gain of the @xmath37 image with respect to the intensity - summed image .",
    "[ fig : timeseriesgain ] ]    .38 .",
    "( b ) comparison of the intensity - summed image ( left , [ a ] ) with a processed cnr map of @xmath52 ( right , [ b ] ) that can be provided as a final contrast enhanced image to the end - user or to a higher - level image processing unit.[fig : results ] , title=\"fig : \" ]    .62 .",
    "( b ) comparison of the intensity - summed image ( left , [ a ] ) with a processed cnr map of @xmath52 ( right , [ b ] ) that can be provided as a final contrast enhanced image to the end - user or to a higher - level image processing unit.[fig : results ] , title=\"fig : \" ]      finally , we briefly discuss the implementation and some generic issues associated with computing such contrast - maximizing representations for each frame , when the locations and number of sources are unknown . in this case , each frame can be processed to obtain an intermediate contrast image that isolates the polarized source from the rest of the image as shown in fig .",
    "[ fig : cnrimage ] . to obtain the cnr image ,",
    "the calculation of cnr over a sliding window can be replaced with a convolution approach which performs quickly by using fast fourier transforms . for computing @xmath36 ,",
    "multiple cnr images must be generated and the maximum value at each pixel must be chosen to form the final image .",
    "in contrast , for the ml representation one would need fewer fourier transforms to calculate the local correlation coefficients , thus providing @xmath52 a noticeable time advantage over @xmath36 .",
    "however , with fast computers or fpga based embedded system , both techniques should remain within real - time requirement .",
    "another parameter of importance is the size and shape of roi , which should also be varied to maximize the cnr over multiple scales , especially when the spread of the source is unknown .",
    "the ml method remains specifically suitable in this case as only a 1d maximization over scale is required as opposed to a search over both scale and linear weighting of polarimetric images .",
    "in this article , we first showed experimentally that when performing real field polarimetric imaging , two polarimetric channels acquired along two orthogonal polarization directions can have intensity fluctuations that are significantly correlated .",
    "moreover , experiments reveal that the contrast of a polarized light source under any visibility condition can be maximized using a linear combination of the two acquired polarimetric images , which differs in general from the standard polarimetric representations used in literature . under a correlated gaussian noise hypothesis , we also demonstrated that the optimal representation is simply related to the noise correlation coefficient , which is also observed experimentally . as a result",
    ", such computationally - efficient representation can replace a numerical search of the optimal weighting coefficients , and could thus be easily implemented in real - time applications as a pre - processing task for automated detection / localization on wide field images .",
    "lastly , the results presented here could be easily generalized to any case of partially polarized source and background with finite detector noise , which could be of interest for underwater imaging or imaging in biological tissues .",
    "as noted above , the polarimetric pixel can be written as a 2-d random vector @xmath57^t$ ] , where the dependency in pixel location @xmath58 is omitted in the appendix for the sake of clarity . assuming a correlated gaussian noise model and keeping the same notations as in section  [ polconimg ]",
    ", we derive the expression for cnr for a generic polarimetric representation @xmath9 .",
    "its mean value at a given location in the image is directly given by @xmath59 , and its variance reads @xmath60 . from the definition of the cnr in eq.([eq : cnr ] ) , a straightforward calculation yields @xmath61 as a result , the gain in cnr with respect to the intensity - summed representation @xmath35 reads @xmath62 from which the gain expressions of table [ tab ] are easily derived .",
    "if one now considers a true intensity imager , and given the notations above , the intensity level @xmath63 recorded at a given pixel would have a mean value of @xmath64 at the source location , and @xmath65 in the background region , with variance @xmath66 .",
    "the cnr is thus @xmath67 , and as a result , @xmath68 this shows that the gain with respect to a true intensity imager is equivalent to the gain with respect to the intensity - summed image only when the correlation parameter @xmath1 tends to @xmath69 , and is lower by a factor of 2 when @xmath1 approaches unity .",
    "this work has been partly funded by the cefipra ( project n@xmath2 4604 - 4 ) .",
    "the authors would like to thank pr .",
    "hema ramachandran for fruitful discussions .",
    "the authors acknowledge the tdf company and rennes mtropole for supporting this work , and l. frein , c. hamel , a. carr and s. bouhier for technical assistance .",
    "h.  horinaka , m.  osawa , k.  hashimoto , k.  wada , and y.  cho , `` extraction of quasi - straightforward - propagating photons from diffused light transmitting through a scattering medium by polarization modulation , '' _ optics letters _ , 20 , 15011503 ( 1995 ) ."
  ],
  "abstract_text": [
    "<S> we present a contrast - maximizing optimal linear representation of polarimetric images obtained from a snapshot polarimetric camera for enhanced vision of a polarized light source in obscured weather conditions ( fog , haze , cloud ) over long distances ( above 1 km ) . </S>",
    "<S> we quantitatively compare the gain in contrast obtained by different linear representations of the experimental polarimetric images taken during rapidly varying foggy conditions . </S>",
    "<S> it is shown that the adaptive image representation that depends on the correlation in background noise fluctuations in the two polarimetric images provides an optimal contrast enhancement over all weather conditions as opposed to a simple difference image which underperforms during low visibility conditions . </S>",
    "<S> finally , we derive the analytic expression of the gain in contrast obtained with this optimal representation and show that the experimental results are in agreement with the assumed correlated gaussian noise model .    manuscript received month dd , yyyy ; revised month dd , yyyy . </S>",
    "<S> first published month dd , yyyy . </S>",
    "<S> current version published month dd , yyyy .    </S>",
    "<S> polarimetric imaging , imaging through fog . </S>"
  ]
}