{
  "article_text": [
    "molecular dynamics ( md ) simulation is a powerful tool for investigating a broad range of systems , from biological to materials sciences . in the equilibrium situation ,",
    "it is of crucial importance to consider the ensemble that an md simulation samples , because the quantities to observe are often calculated from the ensemble averages .",
    "moreover , the equilibrium ensemble may serve as the initial condition for non - equilibrium md simulations  @xcite .",
    "most of early md simulations solve the hamiltonian dynamics , and sample the microcanonical ensemble .",
    "in practical applications , alternative ensembles like canonical or isothermal - isobaric ( npt ) ensembles are usually more desirable , so various methods have been developed to sample the required ensemble by modifying the hamiltonian dynamics .",
    "one class of approaches to generate the desired ensemble is the extended phase space methods . for example , the nos - hoover  @xcite , nos - hoover chain  @xcite and stochastic nos - hoover thermostats are proposed to generate the canonical ensemble ; the andersen  @xcite , parrinello - rahman  @xcite and martyna - tuckerman - klein  @xcite barostats are proposed to generate the npt ensemble .",
    "these methods share the idea of extending the physical phase - space ( positions , velocities of particles and the simulation cell ) by extra variables that control the temperature and/or pressure of the system .",
    "the dynamics of the extended system is carefully designed to fulfill the condition that if the trajectory is ergodic , then the marginal stationary distribution in the physical phase - space is consistent with that of the desired ensemble .",
    "langevin dynamics is an alternative method for generating the canonical ensemble .",
    "it has been proved that the ergodicity is guaranteed under mild restrictions  @xcite , therefore the convergence to the canonical distribution is ensured in the limit of infinitely long simulation time . because of this advantage , langevin dynamics has attracted increasing attention recently , and various integration schemes were developed in order to improve the accuracy of numerical simulations  @xcite .",
    "the first attempt of using the langevin dynamics in generating the npt ensemble was from feller et.al .",
    "@xcite and kolb and dnweg  @xcite , who proposed the langevin dynamics for both the particle degrees of freedom and the volume of the simulation cell ( isotropic cell fluctuation ) .",
    "these work are recently improved by grnbech - jensen and farago  @xcite and di pierro et .",
    "quigley and probert coupled the parrinello - rahman dynamics with langevin stochastic terms to extend the method to the fully flexible cell motions ( anisotropic cell fluctuation )  @xcite .",
    "however , it is not possible , as the authors stated , to prove that the stationary distribution of the dynamics is subject to the npt ensemble when the cell motion is stochastic and rotation - eliminated",
    ". therefore , theoretically , the cell motions in this approach should be deterministic , and the convergence to the npt distribution is not guaranteed , although the npt distribution is one of the stationary distributions . in practice ,",
    "the authors recommended to accept the cell stochastic motions at the cost of rigor in theory .    in this work",
    ", we propose a fully - flexible - cell npt langevin dynamics that allows explicit stochastic components in both the particle and cell motions , due to which the convergence of configurational distribution to the npt ensemble is naturally ensured in the infinitely long time limit .",
    "we start by defining the hamiltonian for an extended phase - space composed of scaled coordinates and simulation cell variables .",
    "then the langevin dynamics of this system can be directly written down , and the boltzmann stationary distribution is obtained in the extended phase - space . in order to have a direct description of the particle motions in terms of physical coordinates , the scaled coordinates are transformed back , and the langevin dynamics is reformulated accordingly by using ito s formula . the configurational stationary distribution is then proved to be consistent with that of the npt ensemble by transforming the boltzmann distribution back to the physical coordinates in the same way . to develop the numerical scheme ,",
    "we start by considering the fokker - planck equation that is equivalent to the langevin equation , then the scheme is formulated by splitting the single - step propagator of the fokker - planck equation according to trotter s theorem . by construction ,",
    "the proposed scheme is of second order accuracy with respect to the time - step size .    before moving to the main results of this work",
    ", it should be noted that it is in general difficult to check if the convergence to the npt distribution is achieved in a finite simulation time .",
    "one might check the convergence of some properties of the system , for example the free energy profile along a certain reaction coordinate  @xcite , but the choice of indicating properties depends on the nature of the system and what is wanted from the simulation , and they are usually not sufficient to prove the convergence of the distribution .",
    "therefore , we do not intend to investigate the ergodicity or the speed of convergence to the desired ensemble distribution in numerical simulations .",
    "the significance of this work is to propose a new fully - flexible - cell npt langevin dynamics that takes the _ theoretical _ advantage of ergodicity , and can be used as an alternative to the existing npt simulation methods .",
    "this paper is organized as follows : the development of npt langevin dynamics is discussed in detail in sec .",
    "[ sec : tmp2 ] .",
    "the discretization of langevin dynamics is provided in sec .",
    "[ sec : tmp3 ] . in sec .",
    "[ sec : tmp4 ] , we validate the npt langevin dynamics by a solid argon system of triclinic region cell .",
    "this work is concluded in sec .",
    "[ sec : tmp5 ] .",
    "we denote the particle positions in the system by @xmath0 , where @xmath1 is the number of particles in the system .",
    "the simulation cell matrix is denoted by @xmath2 $ ] , where @xmath3 are cell vectors .",
    "the scaled ( direct ) coordinate of a particle @xmath4 is defined by @xmath5 . in order to generate the fully - flexible - cell npt ensemble , all components of the cell vectors",
    "are allowed to fluctuate .",
    "we define the kinetic energy of the system by @xmath6 where @xmath7 is the fictitious mass corresponding to the motion of @xmath8 that is the @xmath9-th component of the @xmath10-th cell vector .",
    "the first term on the rhs of is different from the _ physical _ kinetic energy of the system , which is  @xmath11 ^ 2 $ ] .",
    "the consequence of this difference will be discussed in detail later .",
    "it is worth noting that the parrinello - rahman barostat  @xcite also uses eq .   as the definition of kinetic energy .",
    "the lagrangian of the system is defined as @xmath12}}),\\end{aligned}\\ ] ] where @xmath13 is the potential energy of the system , @xmath14 is the target pressure , @xmath15 is a constant that depends only on the dimension of the system and will be discussed in remark 1 , @xmath16 is the target temperature and @xmath17 is the boltzmann constant .",
    "the generalized momenta corresponding to @xmath18 and @xmath19 are @xmath20 respectively .",
    "therefore , the hamiltonian of the system yields @xmath21}}.\\end{aligned}\\ ] ] the first term on the rhs of is the kinetic energy of cell vectors , and the summation of the last three terms gives the instantaneous enthalpy .",
    "the langevin dynamics is defined by -.8 cm    [ eqn : lang - scaled ] @xmath22    where @xmath23 , @xmath24 denote the standard wiener processes , which are independent for different particle and cell degrees of freedom .",
    "the friction @xmath25 and noise magnitude @xmath26 are @xmath19 dependent matrices defined by @xmath27 , @xmath28 , where @xmath29 , then the fluctuation - dissipation theorem @xmath30 holds for . we define @xmath31 and @xmath32 , where @xmath33 , then the fluctuation - dissipation theorem @xmath34 holds for . it is well known that the stationary probability density of the langevin dynamics   is @xmath35.\\end{aligned}\\ ] ]    it is more convenient to represent the langevin dynamics in physical coordinates , so we introduce the following transformation @xmath36 by using ito s formula , and writing down all partial derivatives explicitly , we reach    [ eqn : aniso - npt - eom ] @xmath37_{{\\alpha\\beta}}- \\gamma_{{\\alpha\\beta}}\\ , p^h_{{\\alpha\\beta}}+ \\sqrt{m_{{\\alpha\\beta}}}\\,\\sigma_{{\\alpha\\beta}}\\ , \\dot w_{{\\alpha\\beta}},\\end{aligned}\\ ] ]    where @xmath38 is the instantaneous pressure tensor defined by @xmath39 it can be easily shown that the jacobian determinant of the transform   is 1 , therefore , by integrating out the cell vector momenta , the equilibrium probability density generated by dynamics   is @xmath40^{-\\chi } } }    \\exp    \\big [    -\\frac1{{k_{_\\textrm{b}}t}}\\big (    \\sum_{i=1}^n \\frac{{p}_i^2}{2m_i }    + u(\\{{r}_i\\ } )    + p\\det({h } )    \\big )    \\big].\\end{aligned}\\ ] ]    * remark 1 * : it was proposed by ref .",
    "@xcite that @xmath15 takes the value of @xmath41 , where @xmath42 is the dimension of the system .",
    "if the rotation of the simulation cell is eliminated by taking @xmath43 as an upper ( or lower ) triangular matrix , then @xmath15 should take @xmath44 ( see appendix  [ app : tmp2 ] for more details ) .",
    "the term @xmath45 on the rhs  of eq .   can be effectively treated as a correction to the pressure difference @xmath46 , and vanishes under the thermodynamic limit , viz .",
    "the volume of the system @xmath47 goes to infinity .",
    "* remark 2 * : it should be noted here that the particle momentum @xmath48 is not exactly the physical momentum @xmath49 . as a matter of fact , we have the relation : @xmath50 this inconsistency is the direct consequence of the definition of the kinetic energy  , in which the particle contribution is not the physical kinetic energy . there is no substantial difficulty in using the physical definition , however , the derivation of the langevin dynamics would become much more complicated . in most applications ,",
    "only the correctness of system configuration is of importance .",
    "the current definition guarantees the configurational distribution to be consistent with that of the npt ensemble .",
    "it is also worth noting that the particle momentum @xmath51 rather than @xmath52 should be used to estimate an equilibrium quantity that is an average over momentum - dependent instantaneous values ( e.g.  temperature and pressure ) . by using @xmath51 ,",
    "the equilibrium distribution   matches the form of the npt distribution , so the average converges to the npt equilibrium quantity under the infinity long time limit , and is independent with the parameters ( frictions and the fictitious mass ) in the langevin dynamics .",
    "* remark 3 * : the choice of the parameters in the langevin dynamics   has been extensively discussed in literature , e.g.  @xcite .",
    "we pick up the friction coefficients based on a rule of thumb  @xcite : @xmath53 , where @xmath54 denotes the frequency of the thermostat and @xmath55 is the time - scale of the thermostat . in order to provide the way of choosing the fictitious mass @xmath7",
    ", we firstly assume that the cell matrix @xmath43 is diagonal ( a cuboid cell ) . with a first order expansion of the pressure with respect to the cell fluctuation in @xmath56 , @xmath57 and @xmath58",
    ", we have @xmath59 where @xmath60 is the compressibility .",
    "the superscript `` 0 '' denotes the equilibrium value of the corresponding variable .",
    "we further assume that the fluctuation from the equilibrium value is small , i.e.  @xmath61 are small . arranging the equation   in the component - wise way and preserving only the first order fluctuations on the rhs , we have @xmath62 \\\\    =    -\\frac{1}{\\kappa h^0_{11}h^0_{22}h^0_{33 } } \\big [    ( h_{11 } - h^0_{11 } ) h^0_{22}h^0_{33 } +    ( h_{22 } - h^0_{22 } ) h^0_{11}h^0_{33 } +    ( h_{33 } - h^0_{33 } ) h^0_{11}h^0_{22 } \\big].\\end{gathered}\\ ] ] one possible solution to the equation is @xmath63 by inserting and into , and discarding the friction and noise , @xmath15 , and higher order terms , we have @xmath64 which is the equation of motion of harmonic oscillator @xmath65 with spring constant @xmath66 and equilibrium position @xmath67 . by using the relation @xmath68 , where @xmath69 is the barostat frequency , we derive the expression for the fictitious mass @xmath70 where @xmath71 is the time - scale of the barostat . for simplicity , we choose the off - diagonal value of fictitious mass by @xmath72 in practice , it is often impossible to predict the equilibrium cell matrix @xmath73 before performing the simulation , however , if the initial condition does not deviate very far from equilibrium , we take the initial value of @xmath43 as a reasonable guess for @xmath73 . the compressibility @xmath74 can either take an experimental value , or be estimated from short testing simulations using the formula : @xmath75 ) .",
    "it is worth noting that regardless of the choice of the parameters , the langevin dynamics   samples the configurational distribution of the npt ensemble at infinitely long time limit .",
    "the difference in using different parameters lies in the sampling efficiency .",
    "if the time - scales of the thermo- and barostat were chosen too large , then the temperature and pressure of the system would not be adjusted in a responsive way , and the sampling of the npt ensemble would be too slow . on the other hand , if they were chosen too small , then an unnecessarily small time - step would be needed to keep the md simulation stable . therefore , it was suggested that the inverse time - scales be chosen just below the typical molecular frequency  @xcite .",
    "the evolution of a system governed by the langevin dynamics  is equivalently described by the following fokker - planck equation : @xmath76 where @xmath77 is the time dependent probability density defined on the phase space .",
    "@xmath78 is the infinitesimal generator , which can be factorized as @xmath79 with each term defined by @xmath80 \\cdot    \\frac{\\partial}{\\partial { r}_i}\\\\    { \\mathcal f}_u & =    \\sum_i\\big [    -\\partial_i u - { h}^{-\\top}{\\dot{{h}}}^\\top{p}_i    \\big ] \\cdot    \\frac{\\partial}{\\partial { p}_i}\\\\    { \\mathcal f}_{o } & =    \\sum_{i=1}^n    \\big[\\ ,    3\\gamma +    \\gamma { p}_i \\frac{\\partial}{\\partial { p}_i }    + \\frac{m_i\\sigma^2}{2}\\frac{\\partial^2}{\\partial { p}_i^2 }        \\,\\big ] \\\\    { \\mathcal f}^h_k & =    \\sum_{{\\alpha\\beta}}\\frac{p^h_{{\\alpha\\beta}}}{m_{{\\alpha\\beta } } }    \\frac{\\partial}{\\partial h_{{\\alpha\\beta } } }   \\\\    { \\mathcal f}^h_u & =    \\sum_{{\\alpha\\beta}}\\big\\ { \\det({h } ) \\big [ \\big({p}_{\\textrm{ins}}- { p } - { { \\frac{\\chi{{k_{_\\textrm{b}}t}}}{\\det(h ) } } }   \\big ) { h}^{-\\top}\\big ] _ { { \\alpha\\beta}}\\big\\ }    \\frac{\\partial}{\\partial p^h_{{\\alpha\\beta } } }   \\\\    { \\mathcal f}^h_{o } & =    \\sum_{{\\alpha\\beta}}\\big[\\ ,    \\gamma_{{\\alpha\\beta}}+    \\gamma_{{\\alpha\\beta}}p^h_{{\\alpha\\beta}}\\frac{\\partial}{\\partial p^h_{{\\alpha\\beta } } }    + \\frac{m_{{\\alpha\\beta}}\\sigma_{{\\alpha\\beta}}^2}{2}\\frac{\\partial^2}{\\partial ( p^h_{{\\alpha\\beta}})^2 }        \\,\\big].\\end{aligned}\\ ] ]    given this factorization , the single - step propagator @xmath81 ( @xmath82 being the time - step ) can be split by the trotter theorem : @xmath83 this style of splitting is actually the `` baoab '' scheme proposed by ref .",
    "the authors argued that the baoab splitting is more accurate than other schemes in the sense of configurational sampling .",
    "the action of propagator @xmath84 and @xmath85 corresponds to evolve @xmath18 and @xmath48 by @xmath82 under the ordinary differential equation @xmath86 and @xmath87 , respectively .",
    "here we adopt the convention that the cell matrix @xmath19 is an upper triangular matrix , then one has to solve , in general , @xmath88 with @xmath89 being an upper or lower triangular matrix . in the current work , the analytic solution of @xmath88 in the upper and lower triangular cases",
    "are denoted by @xmath90 and @xmath91 , respectively .",
    "the explicit forms of function @xmath92 and @xmath93 are provided in appendix  [ app : solve - s ] .",
    "the action of propagator @xmath94 and @xmath95 corresponds to evolve variables @xmath48 and @xmath96 by @xmath82 under the ornstein - uhlenbeck process . in general , an ornstein - uhlenbeck process @xmath97 can be explicitly solved by @xmath98 , where @xmath99 is a random number subject to the normal distribution with vanishing mean and unit variance , i.e.  @xmath100 .",
    "discarding the higher order terms and applying from left to right the propagators on the rhs of yields the following numerical scheme :    @xmath101_{{\\alpha\\beta}}$ ] @xmath102 @xmath103 ) @xmath104 @xmath105 @xmath106 @xmath104 @xmath107 ) compute the force for each particle @xmath102 compute the instantaneous pressure tensor @xmath101_{{\\alpha\\beta}}$ ]    the operators @xmath108 and @xmath109 are mutable , therefore , lines 6 and 7 in the algorithm can be swapped .",
    "the npt langevin method was implemented in the in - house molecular dynamics simulation package moasp developed on infrastructure jasmin  @xcite . in order to validate the theory and the implementation , we tested a solid argon system modeled by the lennard - jones interaction : @xmath110 where @xmath111 is the distance between a pair of particles .",
    "@xmath112  @xmath113 and @xmath114  @xmath115 are parameters taken from the charmm27 force field  @xcite .",
    "@xmath116 is a shifting constant that ensures the continuity of energy at the cut - off .",
    "the cut - off radius was chosen to be 0.9  nm in all simulations .",
    "the neighbor list was build for particles that are at most 1.1  nm apart , and was updated every 20 time - steps . if not stated otherwise , the time - step of integration was chosen to be 0.001  ps .",
    "@xmath117 , and the dashed line uses a compressibility of @xmath118  @xmath117 . ,",
    "scaledwidth=48.0% ]    an initial configuration of perfect fcc crystal was prepared by extending the bravais lattice cell of @xmath119  nm and @xmath120 by @xmath121 times along three cell vectors , respectively .",
    "therefore , the system contained 12,000 atoms in total .",
    "an 100  ps equilibration simulation that used this configuration and zero initial velocities was conducted at 300  k and 40  kbar .",
    "the initial guess of the compressibility was @xmath122  @xmath117 ( which was actually a value taken from the liquid water under ambient condition ) .",
    "the time - scales of thermostat and barostat were set to 0.1  ps and 0.5  ps , respectively .",
    "the system was successfully equilibrated to the desired thermodynamic state within only 1  ps ( the solid lines in fig .",
    "[ fig : equi ] ) , and the initial fcc solid structure was stable under this thermodynamic condition .",
    "the finial coordinates and velocities of atoms were recorded for productive simulations .",
    "the compressibility , @xmath118  @xmath117 , was estimated from this simulation , and was used for all following simulations . since the initial guess of the compressibility was much larger than @xmath118  @xmath117 , the speed of equilibration was actually faster than the user specified thermo- and barostat time - scales .",
    "we conducted the equilibration again with the correct compressibility , and found that the speed of equilibration was roughly the same as the specified thermo- and barostat time - scales ( the dashed lines in fig .",
    "[ fig : equi ] ) .",
    "$ ] ( pink ) , the instantaneous enthalpy ( blue ) and the hamiltonian ( red ) are presented .",
    "the kinetic energy and @xmath123 $ ] use the left y - axis , while the instantaneous enthalpy and the hamiltonian use the right y - axis , as the arrows in the figure indicate .",
    "the unit of the energy is kj / mol .",
    ", scaledwidth=45.0% ]    an effective way to validate the correctness of the equations and software implementation is to check the conservation of hamiltonian   when the friction and noise in vanish .",
    "we performed this simulation with the initial positions and velocities from the previous equilibration , and plot the evolution of the cell kinetic energy , the instantaneous enthalpy , @xmath123 $ ] and the hamiltonian in figure  [ fig : consv - hamil ] . a perfect conservation of the hamiltonian is observed .",
    "it is worth mentioning that the cell kinetic energy and the instantaneous enthalpy fluctuate at the magnitude of roughly @xmath124  kj / mol ( see fig .  [",
    "fig : consv - hamil ] ) , and that the kinetic and potential energy of particles fluctuate at the magnitude of roughly @xmath125  kj / mol ( not shown ) .         , @xmath126 and @xmath127 , respectively . plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] . ,",
    "title=\"fig:\",scaledwidth=23.0% ] , @xmath126 and @xmath127 , respectively .",
    "plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] . , title=\"fig:\",scaledwidth=23.0% ] + , @xmath126 and @xmath127 , respectively .",
    "plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] . , title=\"fig:\",scaledwidth=23.0% ] , @xmath126 and @xmath127 , respectively .",
    "plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] . , title=\"fig:\",scaledwidth=23.0% ] + , @xmath126 and @xmath127 , respectively .",
    "plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] . ,",
    "title=\"fig:\",scaledwidth=23.0% ] , @xmath126 and @xmath127 , respectively .",
    "plot ( d ) ",
    "( f ) on the right column present the probability densities of three angles @xmath10 , @xmath9 and @xmath128 between them , respectively .",
    "( @xmath10 is the angle between @xmath129 and @xmath130 .",
    "@xmath9 is the angle between @xmath131 and @xmath130 .",
    "@xmath128 is the angle between @xmath131 and @xmath129 . )",
    "the simulated system is the same as fig .",
    "[ fig : tmp1 ] .",
    ", title=\"fig:\",scaledwidth=23.0% ]        the productive npt simulation lasted for 10,000  ps , and the data collection started from 100  ps .",
    "the instantaneous enthalpy and cell vectors were recorded every 0.02  ps .",
    "we plot the distribution of the instantaneous enthalpy and cell volume in fig .",
    "[ fig : tmp1 ] .",
    "the distribution of the lengths of cell vectors and the angles between them are presented in fig .",
    "[ fig : tmp2 ] . in the figures ,",
    "the results of the npt langevin dynamics are compared and consistent with those of a reference simulation that uses velocity - rescaling thermostat  @xcite and parrinello - rahman barostat  @xcite . the initial condition and the other parameters",
    "were set to be the same as the langevin simulation .",
    "the reference simulation is considered to be reliable , because it was conducted by a well - tested md simulation package gromacs  @xcite ( version 4.6.5 ) .",
    "the radial distribution functions ( rdfs ) calculated by langevin and the reference simulation are shown to be overlapping in the upper plot of fig .",
    "[ fig : rdf ] . from the lower plot of fig .",
    "[ fig : rdf ] , we observe that the difference between them is dominated by the statistical uncertainty .",
    "this means that the solid structures sampled by langevin dynamics reproduce those of the reference simulation .    ) of the integration .",
    "the @xmath132-axis is the time - step in unit of picosecond , and the @xmath133-axis is the relative error .",
    "the reference values of the volume and enthalpy are obtain by the simulation using time - step 0.0005  ps .",
    "the relative errors of volume below @xmath82 = 0.008  ps and enthalpy below @xmath82 = 0.004  ps are dominated by statistical uncertainties , so they are not presented for clarity .",
    ", scaledwidth=46.0% ]     the npt langevin dynamics is numerically solved by the integration scheme in sec .",
    "[ sec : tmp3 ] that inevitably introduces error by time - discretization . to investigate its effect on temperature , pressure , volume and enthalpy computations , we present the relative errors vs. time - step size in a log - scaled plot ( fig .  [",
    "fig : converge - dt ] ) .",
    "the reference values of the volume and enthalpy are obtained by a simulation using the time - step of 0.0005  ps . the statistical uncertainty in estimating the relative errors are , on average , @xmath134 , @xmath135 , @xmath136 and @xmath137 ( 95   for temperature , pressure , volume and enthalpy , respectively .",
    "the numerical results prove that the integration scheme is of second - order accuracy in computing the temperature , volume and enthalpy .",
    "the accuracy of pressure computation is remarkably high , so the errors are dominated by the statistical uncertainty ( @xmath138 ) , and do not present the dependency on the time - step size .",
    "the relative errors in computing the cell vector lengths and angles are also dominated by the statistical uncertainty , and are not presented here .",
    "in this work , we proposed a new fully - flexible - cell langevin dynamics in npt ensemble .",
    "our approach couples stochastic terms to both the particle and cell degrees of freedom , and is proved to correctly sample the configurational stationary distribution of the npt ensemble .",
    "we noted that the choice of the working parameters ( friction coefficients and the fictitious masses of cell vectors ) does not affect the sampling of the npt ensemble in the infinitely long time limit , however it determines the sampling efficiency and the size of the md time - step .",
    "therefore , we suggested a practical guide that automatically computes the fictitious mass and the friction coefficients by using the user specified thermo-/barostat time - scales , and the compressibility of the simulated material . in order to solve the langevin equations by computers ,",
    "a discretization scheme was developed by using the trotter splitting of the single - step propagator of the fokker - planck equation .",
    "this scheme is , by construction , of second order accuracy .",
    "a solid argon system modeled by the lennard - jones interaction was simulated to validate the proposed langevin dynamics and the numerical scheme .",
    "the conservation of the hamiltonian in the case of vanishing friction and noise was firstly check , and the correctness of the equations and the software implementation was confirmed .",
    "then the equilibrium distributions of enthalpy , cell volume and vectors were calculated , and were found to be in good consistency with those calculated by a reference simulation ( conducted by package gromacs  4.6.5 ) .",
    "the accuracy of the equilibrium structure of the system was verified by comparing the radial distribution function with the reference simulation .",
    "there are , roughly speaking , two classes of approaches for sampling canonical or isothermal - isobaric ensembles : the first is the deterministic approaches utilizing the extended phase space dynamics , while the second is the stochastic approaches introducing random noise in the dynamics .",
    "one can also find methods that combine the ideas from both classes of approaches , e.g.  ref .",
    "the main concern about the deterministic approaches is the ergodicity  @xcite , the theoretical proof of which is , as far as we see , still unavailable .",
    "thus the advantage of the stochastic approaches is the theoretically guaranteed ergodicity , which indicates that one can expect converged sampling of the desired ensemble in the infinitely long time limit .",
    "however , it should be noted that the theoretical proof of ergodicity does not necessarily ensure better performance in practice , because no real simulation is infinitely long . both classes of approaches",
    "face the issue of how efficiently the phase space is explored . as discussed in sec .",
    "[ sec : intro ] , this challenging question can be numerically investigated by checking the convergence of indicating properties on a case - by - case basis . as a matter of fact",
    ", one can find examples in the literature showing that the stochastic approaches are more precise in computing some properties ( e.g.  @xcite ) , while other examples indicating that the deterministic approaches are more efficient ( e.g.  @xcite ) .",
    "since it is impossible to derive a conclusive answer on which class of approaches is superior , we suggest to provide the users both options in md simulation packages .     in this work , the numerical scheme for solving the langevin equations",
    "is designed by a second order trotter splitting of the single - step propagator .",
    "it worth mentioning that the proposed scheme is not the only possibility to achieve the time - discretization .",
    "alternative schemes can be designed , for example , by manipulating the order of operators in eq .",
    "@xcite , or by minimizing the truncation errors of extended high - order splitting schemes with free parameters  @xcite .",
    "the studies along this direction will be carried out in the future .",
    "although the langevin dynamics is an efficient sampling tool of the equilibrium ensembles , the computed dynamical properties like time correlation functions are usually wrong , because the stochastic terms in the momentum equations break the physical dynamics of the system that is described by the newton s equations of motion .",
    "therefore , in the cases where the dynamical properties are intended to be computed precisely , more carefully designed methods , e.g.  local langevin thermostat , should be used  @xcite .",
    "the authors acknowledge the valuable discussions with aiqing zhang , xu liu and jianjun liu , and the technical supports from them .",
    "thanks the fruitful discussions with dr .",
    "wei zhang from freie universitt berlin .",
    "the authors gratefully acknowledge the financial support from national high technology research and development program of china under grant 2015aa01a304 .",
    "is supported by the national science foundation of china under grants 91430218 and 61300012 .",
    "is supported by the national science foundation of china under grants 11501039 and 91530322 .",
    "in this section we follow the arguments of ref .  @xcite . to separate the volume fluctuation from the total fluctuation of @xmath43 , we let @xmath139 , where @xmath140 is the volume of the system , and @xmath141 with @xmath142 accounts for the shape of the simulation cell .",
    "the partition function of the npt ensemble ( isotropic pressure control ) reads @xmath143 where @xmath144 is the canonical partition function .",
    "when transforming @xmath141 back to @xmath43 in the integration , the measure transform @xmath145 is used for case that the @xmath146 components of the tensor @xmath43 are not constrained . if the rotation of @xmath141 ( or equivalently @xmath43 ) is eliminated by taking @xmath141 as an upper triangular matrix ( @xmath147 ) , the number of degrees of freedoms in the tensor @xmath141 is @xmath148 , therefore we have the measure transform @xmath149 . in general , we denote @xmath150 , and integrate the partition function eq .   over @xmath140",
    ": @xmath151^{-(\\nu / d-1 ) } e^{-{p\\det(h)}/{{k_{_\\textrm{b}}t } } } q(h).\\end{aligned}\\ ] ] this means the constant @xmath15 should take the value of @xmath152 . when the simulation cell is allowed to rotate , @xmath153 , so @xmath15 takes @xmath41 .",
    "when the rotation of the simulation cell is removed , @xmath154 , so @xmath15 takes @xmath44 .",
    "the ordinary differential equation @xmath155 can be solved analytically .",
    "we start with the case that @xmath89 is an upper triangular matrix : @xmath156    =    \\left [      \\begin{matrix }        b_0\\\\        b_1\\\\        b_2      \\end{matrix }    \\right ]    +    \\left [      \\begin{matrix }        a_{00 } & a_{01 } & a_{02}\\\\        0 & a_{11 } & a_{12}\\\\        0 & 0 & a_{22}\\\\      \\end{matrix }    \\right ]    \\cdot    \\left [      \\begin{matrix }        x_0\\\\        x_1\\\\        x_2      \\end{matrix }    \\right ] .\\end{aligned}\\ ] ] the solution is given by : @xmath157 where the function @xmath158 , @xmath159 and @xmath160 are defined to be @xmath161 it should be noticed that the definitions have singularity when any two of the @xmath162 , @xmath163 , @xmath116 and @xmath164 are equal , and we do not exclude these cases in real simulations . noticing that we only need the solution of at small @xmath165 , the singularity can be avoided by taylor expansion of the exponential functions around 0 .",
    "following this idea , we reach the serial expansions of @xmath158 , @xmath159 and @xmath160 : @xmath166    for the case that @xmath89 is a lower triangular matrix : @xmath167    =    \\left [      \\begin{matrix }        b_0\\\\        b_1\\\\        b_2      \\end{matrix }    \\right ]    +    \\left [      \\begin{matrix }        a_{00 } & 0      & 0     \\\\        a_{10 } & a_{11 } & 0     \\\\        a_{20 } & a_{21 } & a_{22}\\\\      \\end{matrix }    \\right ]    \\cdot    \\left [      \\begin{matrix }        x_0\\\\        x_1\\\\        x_2      \\end{matrix }    \\right ] , \\end{aligned}\\ ] ] the solution can be written down in a similar way : @xmath168      han wang , christof schutte , giovanni ciccotti , and luigi delle  site .",
    "exploring the conformational dynamics of alanine dipeptide in solution subjected to an external electric field : a nonequilibrium molecular dynamics simulation .",
    ", 10(4):13761386 , 2014 .",
    "evan kelly , michael seth , and tom ziegler .",
    "calculation of free energy profiles for elementary bimolecular reactions by ab initio molecular dynamics : sampling methods and thermostat considerations . , 108(12):21672180 , 2004 .",
    "nicolas foloppe and alexander  d mackerell  jr . all - atom empirical force field for nucleic acids : i. parameter optimization based on small molecule and condensed phase macromolecular target data .",
    ", 21(2):86104 , 2000 .",
    "s.  pronk , s.  pll , r.  schulz , p.  larsson , p.  bjelkmar , r.  apostolov , m.r .",
    "shirts , j.c .",
    "smith , p.m. kasson , d.  van  der spoel , b.  hess , and e.  lindahl .",
    "gromacs 4.5 : a high - throughput and highly parallel open source molecular simulation toolkit .",
    ", page btt055 , 2013 .",
    "ip  omelyan , i m  mryglod , and r  folk .",
    "symplectic analytically integrable decomposition algorithms : classification , derivation , and application to molecular dynamics , quantum and celestial mechanics simulations .",
    ", 151(3):272314 , 2003 ."
  ],
  "abstract_text": [
    "<S> we present a new method of conducting fully - flexible - cell molecular dynamics simulation in isothermal - isobaric ensemble based on langevin equations of motion . the stochastic coupling to all particle and cell degrees of freedoms is introduced in a correct way , in the sense that the stationary configurational distribution is proved to be in consistent with that of the isothermal - isobaric ensemble . in order to apply the proposed method in computer simulations , a second order </S>",
    "<S> symmetric numerical integration scheme is developed by trotter s splitting of the single - step propagator . </S>",
    "<S> moreover , a practical guide of choosing working parameters is suggested for user specified thermo- and baro - coupling time - scales . </S>",
    "<S> the method and software implementation are carefully validated by a numerical example . </S>"
  ]
}