{
  "article_text": [
    "in late 1916 , a year before his death , marian von smoluchowski , one of the pioneers of statistical physics , submitted a paper titled _ versuch einer mathematischen theorie der koagulationskinetik kolloider lsungen _",
    "( an attempt for a mathematical theory of coagulation kinetics of colloidal solutions ) to zeitschrift fr physikalische chemie @xcite . in smoluchowski s paper",
    "he imagined a large dilute system of hard spherical particles moving independently with brownian motion .",
    "he wondered what would happen if particles could stick together whenever they ` touch ' .    using the simple example of a closed system containing two diffusing spheres with radii denoted @xmath0 and @xmath1 respectively we can state the famous smoluchowski result rather succinctly : diffusing hard spheres placed randomly in a sufficiently large container of volume @xmath2 will ( after an initial period ) come into contact at a constant rate @xmath3 per unit time given by @xmath4 where @xmath5 and @xmath6 denote the respective einstein diffusion coefficients of spheres @xmath7 and @xmath8 .",
    "it is not uncommon to see this result stated independently of the volume , @xmath9 , and in terms of the relative diffusion coefficient @xmath10 and/or the joint effective radius ( the distance between the sphere centres at the moment of contact ) @xmath11 .",
    "the smoluchowski model of diffusing hard spheres is presented diagrammatically in fig .",
    "[ smolfig ] .",
    "containing a dilute , well - mixed population of diffusing spheres , contact rates per unit time between any two spheres , 1 and 2 , will be dependent on the diffusion constants and radii of each of the spheres and inversely proportional to the volume .",
    "the relationship between these parameters and the rate of contact is given by equation ( [ smol ] ) . ]",
    "smoluchowski s discovery had a very obvious and immediate impact for coagulation theory and is a fundamental theoretical result used in fields such as aerosol physics @xcite .",
    "as is the case for many simply stated mathematical relations , his equation is more profound than its initial application and has indeed been applied broadly in the last hundred years .",
    "indeed , smoluchowski himself postulated that the relationship that he had discovered may help in the understanding of chemical reactions @xcite .",
    "this is not immediately apparent .",
    "whilst large molecules seemingly move according to brownian motion in stationary fluids , most can not adequately be described as hard spheres .",
    "furthermore , chemical reactions do not occur purely as a result of random collisions but rather complex molecular interactions which often require careful analysis and/or numerical simulation . theorising that a reaction rate @xmath12 for a chemical reaction can be determined using only knowledge of the molecular kinetics @xmath13 and relative molecular sizes @xmath14 at first glance seems contrary to the standard model for chemical reactions and molecular interactions . at the very least",
    ", the definition of @xmath14 as a physical size of molecules needs to be relaxed if one is to extend smoluchowski s theory to include chemical reactions .",
    "there has been a number of attempts to reproduce the result of smoluchowski throughout the 20th century where the hard spheres are replaced with molecules and interact with other molecules in a fluid .",
    "notably , the introduction of additional physical mechanisms such as intermolecular forces by kramers @xcite and debye @xcite and , later , hydrodynamic effects @xcite into the problem resulted in a rate @xmath12 that looks almost identical to that derived earlier by smoluchowski with only an alteration to the definition of @xmath14 .",
    "the parameter @xmath14 needed to be redefined and contained information about the nature of the intermolecular forces and/or the hydrodynamic effect considered , but nonetheless was a constant parameter for a given reaction .",
    "whilst historically @xmath14 is referred to as the smoluchowski reaction radius , it should more physically be described simply as a reaction parameter . physically interpreting @xmath14 merely as a parameter , which summarises the molecular interaction , results in the extension of the smoluchowski relation to diffusion - controlled reactions .",
    "smoluchowski kinetics has henceforth become an important classical result in chemical reaction theory @xcite .",
    "whilst @xmath14 does not represent a physical contact distance in chemical applications , using the analogous interpretation of smoluchowski , a complex chemical system made up of many molecules of diffusing reactant species can be reduced , using simulation , to a system of point particles which react when the centre of masses get within a corresponding proximity @xmath14 of each other ( the red sphere in fig .",
    "the value of @xmath14 used in the simulation can be calculated from the known macroscopic reaction rate @xmath12 using equation ( [ smol ] ) and often differs wildly from actual molecular sizes .    one particular area of research with which the smoluchowski relation has had significant impact in the last few decades is biology .",
    "this is unsurprising as a vast number of biomolecular systems involve dilute and minute diffusing molecular populations undergoing continuous reaction . understanding how these biological systems operate is complicated and is in itself a whole field of research ; systems biology .",
    "the smoluchowski result has provided a very powerful tool for theoretical investigation of microscopic biochemical reaction - diffusion processes .",
    "one of the greatest limitations to using smoluchowski reaction kinetics , particularly in the biological sciences , is the fact that the theory only considers the interaction of two particles / molecules at a time .",
    "in biology , for example , proteins form multimolecular complexes with very specific biological function ( for example , ligand - receptor complexes , transcriptional complexes and other more specific complexes such as the @xmath15-catenin destruction complex ) . of course , these multimolecular reactions are usually not true high order reactions .",
    "instead , they are a result of multiple bimolecular reactions",
    ". often , a reaction - diffusion system is modelled using a system of bimolecular and unimolecular reactions and a long list of chemical species and intermediate complexes until it becomes apparent that the number of chemical species may be reduced by identifying high order reactions as a result of fast and slow kinetics .",
    "for example , in their seminal paper , lee _",
    "et al_. present an experimentally validated model for the wnt signalling pathway using an ode system of 15 chemical species and many bimolecular interactions @xcite .",
    "subsequent analysis of this system by kruger and heinrich identified differences in timescales associated with chemical processes involved in the lee model and by appropriately introducing higher order reactions reduced the number of chemical species from 15 to 7 @xcite .",
    "deterministic models of intracellular networks like that of lee @xcite and kruger and heinrich @xcite are extremely common in mathematical biology and often omit noise which may be added extrinsically in the form of a stochastic differential equation ( sde ) or intrinsically in the form of an agent based simulation .",
    "agent based simulations have the additional advantage over sdes since they also naturally include spatio - temporal phenomena such as transport - derived time delays . as in the case of the wnt signalling pathway , tymchyshyn and kwiatkowska @xcite and wawra _",
    "et al_. @xcite respectively show that noise and time delays in the wnt signalling process can be responsible for substantial oscillations in @xmath15-catenin .",
    "furusawa and kaneko suggest that oscillations such as these may inform differentiation decision making in cells and quantitative models that capture these effects are critical to our theoretical understanding of cellular processes @xcite .",
    "furthermore , protein - protein interactions in the cell are largely transport - limited reactions and thus often require a reaction - diffusion model .",
    "there is a clear need , therefore , for agent - based high order reaction - diffusion simulation algorithms .",
    "there are two main types of agent - based simulation techniques for reaction - diffusion systems .",
    "the first is a lattice - based technique , an extension of the 1977 algorithm by daniel gillespie @xcite , known as the spatial gillespie algorithm .",
    "famously , the spatial gillespie algorithm does not converge as the lattice is made fine and other more complicated techniques are required @xcite .",
    "the second is a simulation technique that models molecules as point particles in a continuous domain and reactions occur due to rules in a smoluchowski framework @xcite , but these types of simulation are currently limited , as previously mentioned , by the lack of utility for multimolecular reactions . since the smoluchowski framework is currently only applicable to diffusive systems with bimolecular or unimolecular reactions they have only found significant biological application in a select few processes .",
    "the min system @xcite and the mapk pathway @xcite are two common examples from the literature .    to understand why the classical smoluchowski model is inadequate to describe the multiple bimolecular reactions leading to complex formation on the scale of individual molecules in examples like that of the wnt signalling pathway and other intracellular networks , consider an example reaction between molecules @xmath16 , @xmath17 and @xmath18 .",
    "hypothetically , consider a reaction first between @xmath16 and @xmath17 , creating a short - lived chemical complex with a very high affinity for @xmath18 .",
    "what does smoluchowski have to say about this process ? there are two reactions , between @xmath16 and @xmath17 and then between the @xmath19 complex and @xmath18 . for the first of these reactions , smoluchowski theory is adequate",
    "however , the ` bimolecular reaction ' between @xmath19 and @xmath18 occurs at a very fast rate .",
    "the effective smoluchowski radius that needs to be defined for such a rate to occur , according to equation ( [ smol ] ) , is very large . as a result",
    ", reactant candidate molecules of @xmath18 may not even be physically in the vicinity of the @xmath19 complex and yet , according to the model , they are forced to somehow , instantaneously , react .",
    "thus , because one chemical reaction occurs on a short timescale , the assumptions that are required for diffusion - limited smoluchowski theory break down , despite the overall high order reaction being diffusion - limited .    throughout mostly the late 20th century , there was a lot of theoretical interest in multimolecular reactions .",
    "there has been extensive study of the smoluchowski coagulation equation for multimolecular reactions .",
    "this equation describes the rate of change of concentration of particles of particular , often discrete , size distributions and considers spatial effects implicitly in the form of a reaction / coagulation kernel @xcite .",
    "different coagulation kernels are usually studied separately and represent the rate of reaction as a function of particle sizes ( for example , the sum kernel model suggests that @xmath20-body collisions occur at a rate proportional to the sum of the sizes of all @xmath20 particles ) .",
    "these kernels are often heuristically based off smoluchowski s relation for 2-body interactions , the @xmath20-body version of which has not been studied in detail .",
    "the @xmath20-body reaction has been studied predominantly in modelling using the law of mass action and ordinary differential equations .",
    "as the number of molecules / particles is reduced , noise plays an important role in the reaction kinetics and has been studied extrinsically @xcite .",
    "explicit spatial considerations for @xmath20-body reaction - diffusion processes have also been studied .",
    "most of these studies focus on homogeneous reactions ( reactions with only one type of reactant ) and are studied on a lattice @xcite ( often only in one dimension @xcite ) . to date , there has been no study of general @xmath20-body diffusion - limited reactions which is formulated in the same way as smoluchowski s ground - breaking 1917 paper @xcite .    motivated by catalytic trimolecular reactions , oshanin and others in the 1990s attempted to find the smoluchowski condition for 3-body reactions @xcite .",
    "however , the analysis was not easily scalable to reactions of higher order or in high dimensions . in this manuscript",
    ", i will present a generalised smoluchowski relation which holds for heterogeneous reactions of any order and is consistent with ( reduces to ) the original work by smoluchowski published in 1917 in the case when the order of the reaction is two @xcite .",
    "i will demonstrate that this theory is capable of quantifying and simulating the kinetics of simple chemical systems on a scale of individual molecules which have been previously unachievable using three test problems ; a simple well - mixed 3d multimolecular reaction leading to exponential decay of one chemical species at a prescribed test rate , a steady state birth - death process utilising a trimolecular reaction and , finally , the simulation of turing patterns .",
    "according to the smoluchowski theory of chemical reaction , @xmath14 is intimately linked with @xmath12 , the macroscopic rate of reaction .",
    "the only other parameters governing the rate of reaction are the diffusion constants @xmath21 of each of the molecules involved in the chemical reaction ( where @xmath22 denotes the specific type of molecule ) . according to the geometric interpretation of the chemical reaction",
    ", @xmath14 describes the proximity molecules need to be from each other in order for reactions to occur at a rate prescribed by @xmath12 ( see equation ( [ smol ] ) ) . in the discussion which is to proceed",
    ", i shall therefore consider all molecules / particles to be point particles described only by their diffusion constants @xmath21 and positions @xmath23 . in agreement with smoluchowski theory ,",
    "there is no consideration of molecular crowding in this manuscript since i will be assuming dilute systems only .",
    "standard mathematical derivation of the bimolecular smoluchowski equation ( equation ( [ smol ] ) ) involves first describing the motion of particle @xmath8 in the frame of reference of particle @xmath7 by placing particle @xmath7 at the origin of a new set of coordinates . in this new frame of reference , coordinates @xmath24 describe the relative proximity of particle 2 compared to particle 1 . describing particles 1 and 2 using the proximity / separation vector @xmath25 instead of their individual positions @xmath26 and @xmath27 allows for the condition of reaction to be defined easily using just one vector ( that is , when @xmath28 ) .",
    "furthermore , it can be shown that the point @xmath25 diffuses linearly with a diffusion constant of @xmath29 .    in order to describe the proximity of three or more point particles",
    "the separation vector @xmath30 ( the relative separation of the @xmath22-th molecule from the collection of @xmath31 previous molecules ) is defined by @xmath32 where @xmath33 is the weighted average position of the first @xmath34 particles . for reasons discussed in detail in section [ derivtheory ] ,",
    "we choose @xmath33 to be given by the _ centre of diffusion _ of the first @xmath34 molecules .",
    "since it can be shown that @xmath33 exhibits brownian motion ( with a diffusion constant of @xmath35 - see later equation ( [ cod_d ] ) ) , @xmath30 also exhibits brownian motion with a diffusion constant of @xmath36 these results will be derived in more detail in section [ derivtheory ] .",
    "consider two point particles @xmath7 and @xmath8 undergoing brownian motion in a three - dimensional space . whilst it is well known that the separation of these points @xmath25 moves with brownian motion , a somewhat lesser known fact is that the motion is completely independent of the diffusive motion of the centre of diffusion @xmath37 ( see section [ derivtheory ] for details ) .",
    "this is an important property and underlies the reason for choosing it to represent the weighted average position of any system of particles in this theoretical framework .",
    "the centre of diffusion is calculated in a similar way to the centre of mass but instead of using the masses of a system of point particles it uses the inverse of their diffusion constants @xmath38 as weights .",
    "the centre of diffusion @xmath39 of molecules @xmath40 at positions @xmath41 respectively diffusing with rate constants @xmath42 is given by the equation @xmath43 we note also that the diffusion constant of the centre of diffusion @xmath39 is given by @xmath44 equation ( [ cod_d ] ) is derived in section [ derivtheory ] .",
    "in this subsection , the main result of this manuscript , the generalised smoluchowski theory , is summarised .",
    "the full derivation of the generalised smoluchowski theory is presented in section [ derivtheory ] .",
    "consider a sufficiently large closed system of volume @xmath2 containing @xmath20 independently diffusing point molecules with diffusion constants @xmath45 respectively .",
    "the positions of the @xmath20 molecules are uniformly initialised over the volume and denoted by @xmath46 respectively . after a short period",
    ", the molecules will come into ` contact ' at a constant rate @xmath47 per unit time where @xmath48 \\frac{4\\pi^{\\alpha+1}}{\\gamma(\\alpha)}\\left(\\frac{\\sigma}{\\sqrt{\\delta_n } } \\right)^{2\\alpha},\\ ] ] where @xmath49 is the gamma function , @xmath50 is defined by equation ( [ dhat ] ) , @xmath51 , @xmath14 is the smoluchowski radius and the scale parameter @xmath52 is given by @xmath53 the summation sign on the denominator of equation ( [ scalefact ] ) is taken for all integer combinations of @xmath54 $ ] and @xmath55 $ ] such that @xmath22 is strictly greater than @xmath56 .",
    "the rate @xmath12 is given in units of @xmath57 ( alternatively @xmath58 ) per unit time .",
    "of particular note in ( [ gensmol ] ) is that the product is taken from @xmath59 to @xmath60 .",
    "contact is defined when the proximity of the molecules becomes less than the smoluchowski radius ( @xmath61 ) .",
    "the proximity of the @xmath20 molecules is expressed in terms of the separation vectors @xmath62 as defined by equation ( [ proxvect ] ) . @xmath63 whilst it may appear that the proximity of @xmath20 diffusing molecules as defined by equation ( [ proximity ] ) is dependent on the order in which the molecules are labelled , it can be shown that this is not the case .",
    "specifically , @xmath64 is a weighted average of the square separation between all molecule pairs ( interested readers are directed to the appendix for a proof of this result ) .",
    "whilst equation ( [ proximity2 ] ) is an interesting geometrical interpretation of @xmath65 , we shall find it more convenient ( both analytically and computationally ) to use the form given in equation ( [ proximity ] ) .",
    "the proximity @xmath65 is a measure of distance / separation of the @xmath20 molecules and thus has units of length ( as does the reaction radius @xmath14 ) .    in the case of classical smoluchowski theory , @xmath66 .",
    "thus , @xmath67 , @xmath68 and @xmath69 .",
    "equation ( [ gensmol ] ) therefore simplifies to equation ( [ smol ] ) and the definition of proximity ( equation ( [ proximity ] ) ) simplifies to the separation of the two reactant molecules @xmath70 .    a diagrammatic representation of the smoluchowski reaction radius for a four - particle reaction in proximity space is presented in fig .",
    "[ multimolecular ] .     shown .",
    "these separation vectors use the centres of diffusion ( shown in green and calculated using equation ( [ cod ] ) ) as reference points .",
    "b ) any configuration of reactants in space maps uniquely to a single point / state in proximity space . note that the proximity space presented in b ) is a visualisation only ( each of the three axes represent a three coordinate vector and is therefore a visualisation of a 9-dimensional space ) . in proximity space ,",
    "the state diffuses according to linear diffusion and a reaction / contact occurs when the proximity falls within the reaction radius @xmath14 which is related to the reaction rate by equation ( [ gensmol ] ) .",
    "note that in this figure , the notation @xmath71 is used . ]",
    "in this section , the theoretical results stated in the section [ framework ] ; an overview of a generalised smoluchowski framework , will be derived in detail .",
    "the key steps will be broken down into subsections so that it is easier to follow .",
    "we consider here a general @xmath20-th order reaction occurring between @xmath20 diffusing molecules .",
    "the diffusion constant of the @xmath22-th molecule is denoted @xmath21 .",
    "the @xmath20 molecules are initially well - mixed ( distributed evenly ) within the arbitrarily large enclosed 3-dimensional domain @xmath73 of volume @xmath74 , where @xmath2 is finite but very large .",
    "the volume is enclosed ( has neumann or periodic boundary conditions ) so that the reaction becomes inevitable and should occur at a constant exponential rate given by the macroscopic reaction rate .",
    "the state of the unreacted system ( which is made up of only one possible combination of reactants ) at any moment may be described by the set of 3-dimensional molecule positions @xmath75 , where @xmath76 is the position vector of the @xmath22-th molecule .",
    "the state space spanned by @xmath77 is therefore @xmath78$]-dimensional .    since each of the @xmath20 molecules diffuse independently , the joint probability density @xmath79 to find this combination of reactant molecules with positions @xmath80 and still in an ` unreacted ' state is given by the diffusion equation @xmath81 p(\\mathbf{x},t),\\ ] ] where @xmath82 represents the laplacian operator with respect to the coordinates of the position vector @xmath23 .",
    "the condition for an @xmath20-th order reaction between these @xmath20 molecules should necessarily be defined in the case when all molecules are sufficiently close to each other ( albeit , the metric for ` closeness ' is not defined at this stage ) .",
    "since the joint probability density @xmath79 is zero when the molecules react ( are sufficiently close ) , it is sensible to transform the coordinate system into one in which the coordinates denote the molecules relative proximity .",
    "we shall perform a linear transformation of the coordinates @xmath83,@xmath84    the transformation coefficients @xmath85 are chosen strategically such that @xmath25 describes the displacement of molecule 2 from molecule 1 , @xmath86 describes the displacement of molecule 3 from some _ weighted average position _ ( wap ) of molecules 1 and 2 , @xmath87 describes the displacement of molecule 4 from some wap of molecules 1 , 2 and 3 , and so on . using this new set of coordinates describing the state of the system",
    ", the reaction condition will be proposed as some condition in which @xmath88 are sufficiently small .",
    "we shall refer to the state vectors @xmath72 as separation coordinates to differentiate them from the molecule position coordinates @xmath77 .",
    "it is natural and convenient ( for tractability ) to chose the transformation coefficients @xmath85 such that the resultant transformed state @xmath72 evolves according to linear diffusion .",
    "that is , @xmath89 for each @xmath90 .    condition ( [ nocross ] ) is met , in part , if the wap is defined by the centre of diffusion .",
    "we define the centre of diffusion , @xmath39 , of @xmath22 molecules positioned at @xmath91 ( @xmath92 ) moving with respective diffusion constants @xmath93 using equation ( [ cod ] ) @xmath94    the vector @xmath95 remains undefined until now . in order",
    "that condition ( [ nocross ] ) holds whilst leaving @xmath96 independent of the other vectors @xmath30 for @xmath97 , @xmath96 will not denote a displacement between molecules but rather the position of the centre of diffusion for the whole system of @xmath20 particles .",
    "we therefore have @xmath98    the transformation ( [ proxdef ] ) denoted by equations ( [ trans1 ] ) and ( [ trans2 ] ) is described by the matrix @xmath99 with elements @xmath85 given by @xmath100^{-1 } & & i=1   \\\\ -d_j^{-1 } \\left[\\sum_{m=1}^{i-1 } d_m^{-1 } \\right]^{-1 } & j <",
    "i & i>1 \\\\ 1 & j = i & i>1 \\\\ 0 & j > i & i>1   \\end{array}\\right . .\\ ] ]    for this particular linear transformation , the jacobian has a determinant of 1 and no scaling of the probability density is required . rewriting ( [ nparticle2 ] ) in the new coordinate system @xmath72 gives @xmath101 p_{\\boldsymbol{\\eta}}(\\boldsymbol{\\eta},t),\\ ] ] where @xmath102 and the @xmath103 notation denotes the transformed coordinates @xmath72 .",
    "that is , @xmath104 is the laplacian with respect to coordinates of @xmath30 and @xmath50 is the diffusion constant associated with the state vector @xmath30 .",
    "@xmath105 where @xmath106 is the diffusion constant associated with the centre of diffusion of the first @xmath107 molecules @xmath108      now that we have defined what is meant by separation coordinates , we will pose a suitable condition which should be placed on the state of the system of @xmath20 reactants for a reaction to occur .    according to equation ( [ nparticle_independent ] )",
    ", the state of any unreacted @xmath20 molecule system , @xmath72 , undergoes linear , albeit anisotropic , diffusion .",
    "if the @xmath20 molecules are well mixed throughout the volume @xmath73 , then there is necessarily a uniform probability density for the state @xmath77 ( and , by extension , @xmath72 ) . in the absence of the perturbation of the joint probability density caused by removal of system",
    "states upon reaction , this constant probability density , @xmath109 , can be found by normalisation .",
    "that is , @xmath110 .    since the condition for reaction should be invariant under translation of the whole system of particles ,",
    "there is no reaction condition placed on the coordinates of @xmath96 .",
    "that is , the centre of diffusion of the whole system may freely diffuse throughout the volume @xmath73 without a reaction occurring as a result of such translations .",
    "subsequently , for a well mixed system , the probability density @xmath111 is independent of @xmath96 .",
    "we therefore integrate equation ( [ nparticle_independent ] ) over @xmath73 with respect to the coordinates of @xmath96 to reduce the dimensionality of the state space .",
    "@xmath112 p(\\{\\boldsymbol{\\eta}\\}_2^n , t),\\ ] ]    where @xmath113 ( using the notation @xmath114 ) . note that the well - mixed constant probability density for the state of the @xmath20 particle system in this reduced state is given by @xmath115 .",
    "the remaining state vectors @xmath116 represent the relative separations of the @xmath20 particles .",
    "it remains to choose the condition for reaction .",
    "a condition which is placed on the coordinates of the reactants for a reaction to occur is quite arbitrary as it does not reflect specific molecular processes but it merely needs to match a macroscopic reaction rate ( the flux of the probability over the reaction boundary must be fixed at a particular macroscopic rate ) .",
    "there are two rules that this boundary must satisfy .",
    "the first is that it must describe a condition on the molecules being positioned within some prescribed colocal neighbourhood .",
    "the second rule is that the extent of this neighbourhood should be described by one parameter @xmath14 which is necessarily chosen to match the flux over the boundary with the macroscopic reaction rate . due to the arbitrariness of this boundary , it is tempting to choose a condition which can be easily described physically .",
    "an intuitive physical condition which appears to be a natural extension of the smoluchowski reaction condition is when every pair of reactants are within a fixed separation @xmath14 ( that is , the maximum distance between any two molecules is less than @xmath14 ) . in their 1995 paper ,",
    "et al_. impose this very condition to describe three - body reactions @xcite .",
    "they were successful in matching the free parameter @xmath14 with the macroscopic reaction rate for trimolecular reactions with the aid of some approximation .",
    "the challenge that was faced by the authors was that the chosen condition , although simple and intuitive , did not offer a tractable expression for the flux over the reaction boundary since the distances between diffusing molecules are correlated .",
    "the usefulness of the separation coordinates as they have been constructed in this manuscript is that they diffuse independently whilst also describing relative molecular separations ( and the separation vectors uniquely have this property , excepting for relabelling permutations ) . in order to find the flux over the reactive boundary in a tractable form for any number of molecules , we have imposed already that the separation vectors in the state space diffuse linearly , and , since the remaining diffusion is anisotropic ( see equation ( [ nparticle_reduced ] ) ) we define the reactive boundary to be @xmath117 for some _ reaction radius _ @xmath14 .",
    "defined in equation ( [ r ] ) is the symbol @xmath65 which we will call the _ proximity _ of the @xmath20 molecules and describes the overall separation of the molecules from each other .",
    "the scale parameter @xmath52 is completely arbitrary and is placed into the condition so that the proximity and reaction radius are measures of distance .",
    "the scale parameter @xmath52 should therefore have units of a diffusion constant .",
    "we define @xmath52 using equation ( [ scalefact ] ) . using this definition for @xmath52 ,",
    "the definition of proximity @xmath65 ( and by extension the reaction radius @xmath14 ) is invariant of the ordering of the molecule labels .",
    "furthermore , when @xmath66 the smolouchowski definition of proximity @xmath118 is recovered and the smoluchowski reaction condition ( [ r ] ) simplifies to @xmath119 . finally , it can be shown that the physical definition of this reaction boundary condition is to ensure that the average square distance between all pairs of molecules , weighted by the inverse product of the molecule pair diffusion constants , is no greater than the square of the reaction radius @xmath14 .",
    "a proof of this physical definition for @xmath65 as well as a justification for using equation ( [ scalefact ] ) to define @xmath52 is presented in the appendix .",
    "the choice of @xmath14 is determined by the macroscopic multimolecular reaction rate @xmath12 measured in expected number of reactions per unit time per unit volume per unit concentration of molecules of each of the @xmath20 reactants .",
    "we shall see that the relationship between @xmath12 and @xmath14 also matches that of smoluchowski for @xmath66 .",
    "the addition of a reaction condition introduces an absorbing boundary in equation ( [ nparticle_reduced ] ) .",
    "we shall define the region of the state space corresponding to the reaction condition ( [ r ] ) as @xmath120 . on being absorbed at the boundary @xmath121 ( @xmath122 ) the system of @xmath20 molecules reacts .",
    "since the system is very large compared to @xmath14 , absorption of states on @xmath121 causes a small perturbation within the bulk distribution .",
    "thus , it is expected that a pseudo - steady state for equation ( [ nparticle_reduced ] ) is reached quickly .",
    "the steady state is given by @xmath123 p,\\ ] ] where @xmath124 and @xmath125 sufficiently far from the origin should be equal to the unperturbed probability density @xmath126 .    in order to significantly simplify the analysis , we shall use the following non - dimensional quantities for the metric of the state vectors @xmath127 , time @xmath128 and subsequent reaction rate @xmath12 .",
    "@xmath129    here , the rescaling of space is designed so that the region for reaction @xmath120 becomes a unit hypersphere . comparing the spatial rescaling ( [ transforms ] ) with ( [ goveqn ] ) ,",
    "the diffusion of the state vector @xmath72 becomes isotropic in the non - dimensional coordinates .",
    "the rescaling of time is designed to make the isotropic diffusion constant equal to one in the non - dimensional coordinates .",
    "the non - dimensionalisation requires the renormalisation of the probability density which is rescaled with respect to the spatial dilations .",
    "@xmath130    where @xmath131.\\ ] ] as a result , the non - dimensionalised probability density far away from @xmath120 is given by @xmath132 note that for the remainder of this document , in the interest of notational simplicity , we shall drop the @xmath133 notation for @xmath134 .    writing the non - dimensional form of equation ( [ goveqn ] ) , we find that the partial differential equation in @xmath135 coordinates has radial symmetry .",
    "that is , by defining the radius in the normalised ( non - dimensional ) state space as @xmath136 ( note that this is actually the non - dimensionalisation of the proximity @xmath65 of the molecules ) we find that the non - dimensional form of equation ( [ goveqn ] ) becomes an ordinary differential equation in @xmath137 .",
    "note that @xmath138 corresponds to @xmath121 and @xmath139 is the proximity of the reactants .",
    "equation ( [ goveqn ] ) simplifies to the ordinary differential equation @xmath140 where @xmath51 is a parameter that appears frequently so has been given its own symbol .",
    "equation ( [ 1deq ] ) is subject to the conditions @xmath141 and @xmath142 ( see equation ( [ pinf ] ) ) .",
    "the general solution to ( [ 1deq ] ) can be written in the following form @xmath143 where @xmath144 and @xmath145 are arbitrary constants . using the boundary conditions at @xmath138 and @xmath146",
    ", we obtain @xmath147    matching the non - dimensional reaction rate @xmath148 with the correct reaction radius @xmath14 requires that @xmath148 be equal to the total flux of the probability density over the hypersurface of the unit sphere defined by @xmath138 .",
    "that is , @xmath149 where @xmath150 is the surface area of a unit @xmath56-dimensional sphere .",
    "re - dimensionalising equation ( [ condition ] ) and using ( [ 1dsols ] ) gives @xmath151 which simplifies to equation ( [ gensmol ] ) .",
    "rearranging for @xmath14 gives @xmath152 the well known bimolecular smoluchowski reaction radius can be found in the special case of @xmath66 ( @xmath153 ) @xmath154    since the theoretical framework presented here is a higher order analogue of smoluchowski s original theory , many of the analytic results that have proceeded smoluchowski may easily be extended to this theoretical framework .    in 1976",
    ", masao doi presented a modified model for chemical reactions @xcite . according to doi s model",
    ", reactions occur with a constant rate @xmath155 inside of the reaction radius rather than instantaneously like the smoluchowski model . for bimolecular reactions ,",
    "the doi reaction radius @xmath156 differs from the smoluchowski reaction radius @xmath14 and is related to the reaction rate @xmath12 and the rate @xmath155 through the following relationship @xmath157\\right).\\ ] ] the derivation of this equation can be found in erban and chapman s paper @xcite .",
    "generalising the doi model to @xmath20-th order reactions , we may register a reaction at a rate @xmath155 whenever the reactant proximities @xmath158 . using the same analysis as that used by erban and chapman , the generalised doi reaction radius @xmath156 for @xmath20-th order reactions as defined implicitly by the reaction rate @xmath12 and rate @xmath155",
    "may be easily derived .",
    "@xmath159,\\ ] ] where @xmath160 is the modified bessel function of the first kind and order @xmath161 and the @xmath133 indicates a derivative with respect to the argument of the function .",
    "modern approaches to the simulation of diffusion - limited reactions using a smoluchowski framework are subdivided into two main approaches .",
    "the first approach , known collectively as the ` event - driven ' approach , involves solving first passage times for ` contact ' events ( when molecules come within the smoluchowski radius ) .",
    "examples of algorithms which use this approach include the enhanced green s function reaction dynamics ( egfrd @xcite ) and the first passage kinetic monte - carlo ( fpkmc @xcite ) algorithms .",
    "these algorithms calculate precise moments that the proximity of reactants touch the smoluchowski radius .",
    "reaction events occur at these simulated moments in time and the algorithm proceeds asynchronously through time to coincide with these events .",
    "the second approach , known as ` time - driven ' , progresses through time using prescribed finite timesteps . at each timestep",
    ", a decision is made about whether or not ` contact ' events have occurred .",
    "timesteps can be chosen adaptively ( such as in the original green s function reaction dynamics , gfrd , algorithm @xcite ) or be held constant .",
    "a popular constant timestep algorithm and software developed using a smoluchowski framework was published in 2004 by andrews and bray @xcite .",
    "their algorithm , due to its simplicity , accuracy and usefulness for a wide array of applications , has been cited over 300 times .",
    "their algorithm is implemented in the popular software smoldyn ( named for its simulation of _ _ smol__uchowski _ _",
    "dyn__amics ) .",
    "the smoldyn package simulates diffusion and bimolecular reaction with single molecule detail .",
    "molecule coordinates @xmath162 for each molecule @xmath22 are stored and updated at discrete times separated by a prescribed timestep @xmath163 .",
    "updates for the positions at each timestep are generated randomly according to the relationship @xmath164 where @xmath165 is the molecule - specific diffusion constant and @xmath166 is a vector of independent , normally - distributed , random numbers with unit variance and zero mean re - sampled for each timestep . at each timestep , if a pair of reactant molecules are within the corresponding smoluchowski radius , a reaction is performed .",
    "the smoluchowski radius @xmath167 that needs to be used in the algorithm deviates from @xmath14 defined in equation ( [ smol ] ) .",
    "the deviation from the theoretical value occurs due to the introduction of discrete timesteps rather than continuous time .",
    "that is , whilst equation ( [ update ] ) exactly simulates diffusion , it does not account for instantaneous reaction at the smoluchowski radius between reactants .",
    "instead , molecules may artificially skip reaction by travelling in and out of the smoluchowski condition within one timestep . as such ,",
    "the radius @xmath167 that is used in practise to correct for these reaction losses is slightly larger than the continuous - time theoretical smoluchowski radius @xmath14 .",
    "the calculation of @xmath167 in smoldyn is described in their original manuscript @xcite . for high order reactions ,",
    "computation of @xmath167 may be described using the presented framework and the same approach to that used in @xcite .",
    "how this approach is generalised to the presented framework is discussed in detail later in this section .",
    "as the algorithms in this section are generalisations of the algorithms first presented in andrews and bray s 2004 paper @xcite , interested readers are directed to this reference for a discussion of the numerical considerations of this algorithm and its convergence properties .",
    "simulation of reaction - diffusion processes with high order reactions at the detail of individual molecules can be achieved with the algorithm outlined in table [ alg : complete ] .",
    "this algorithm is based on the smoldyn time - driven algorithm using the generalised smoluchowski framework presented in this manuscript and is the algorithm that is used for running the numerical tests in section [ numericalsect ] .    1 .",
    "define the domain and molecule initial positions @xmath168 for each molecule @xmath22 .",
    "decide on the temporal resolution of the simulation in timesteps @xmath163 .",
    "set the initial time @xmath169 .",
    "2 .   calculate and store the scaled reaction radii @xmath170 using the numerical technique described in the section [ numalg ] for all multimolecular reactions .",
    "update the positions @xmath171 of each molecule @xmath22 using equation ( [ update ] ) . if necessary , implement boundary conditions ( see ref .",
    "@xcite for details ) .",
    "4 .   for each possible reaction , find all combinations of reactants that have a scaled proximity @xmath172 ( defined by equation ( [ proximity ] ) ) less than the scaled reaction radius @xmath170 . perform these reactions .",
    "update the current time @xmath173 .",
    "5 .   repeat steps [ s.3 ] and [ s.4 ] until the desired end of the simulation .      for numerical simulations that test for the reaction condition at discrete times separated by timesteps of duration @xmath163",
    ", we shall show how the reaction radius needs to be modified . the reaction - diffusion algorithm outlined in table [ alg : complete ]",
    "has two main steps in order to evolve through time and correctly sample reaction events .",
    "these are :    * update molecule positions using the formulae @xmath174 where @xmath175 is the @xmath176-th component of the position vector @xmath177 and @xmath178 is a unit variance , normally distributed random number . *",
    "if the reaction condition given in equation ( [ r ] ) is satisfied between @xmath20 reactants ( using the numerical reaction radius @xmath167 ) , then a reaction is implemented .    in step [ i ] of the simulation algorithm",
    "the non - dimensional proximity @xmath137 of the system of @xmath20 particles evolves according to free diffusion .",
    "consider the scaled probability density for the proximity @xmath137 given by @xmath179 .",
    "after non - dimensionalising the timestep @xmath180 , the distribution @xmath181 at the end of step [ i ] can be found from the initial distribution @xmath182 at the start of step [ i ] using the governing equation @xmath183 for even values of @xmath20 it is possible to find analytic green s functions to equation ( [ goveqg ] ) which allows for direct numerical calculation of @xmath181 from @xmath182 . however ,",
    "this is difficult for odd values of @xmath20 . in order to calculate the reaction rate that coincides with the reaction radius @xmath167",
    ", we therefore solve equation ( [ goveqg ] ) numerically using a simple forward euler scheme from @xmath184 to @xmath185 .",
    "we implement a zero derivative boundary condition at the origin . the spatial domain is numerically truncated for some large @xmath186 . to determine the adaptive boundary condition at @xmath187",
    ", @xmath182 is fitted to the form @xmath188 which is known to be accurate far away from @xmath138 according to equation ( [ 1dsol ] ) : @xmath189 is found by least squares fitting at each timestep update of the pde using the final 10% of the numerically stored @xmath182 . the boundary condition that is implemented at @xmath187",
    "is @xmath190 given the current fitted value for @xmath191 .",
    "the reaction probability per timestep consistent with the macroscopic rate of reaction @xmath192 is given by the total probability that the molecule will react at step [ ii ] when @xmath182 has reached pseudo - steady state between consecutive timesteps .",
    "we shall refer to @xmath194 as the _ reduced reaction rate _",
    "( to match the terminology given in @xcite ) .",
    "it should be noted that we deviate slightly from the definition of @xmath194 given in @xcite by a factor of @xmath195 $ ] ( the volume of the unit @xmath196$]-dimensional sphere ) so that , in the large @xmath163 limit , the reduced reaction rate is 1 for any value of @xmath20 .",
    "the reduced reaction rate can be thought of as the ratio of the probability for a reaction per time step in pseudo - equilibrium to the probability for a reaction per time step if @xmath197 everywhere within @xmath198 ( i.e @xmath199 ) .",
    "importantly , to reach the steady state in the limit as @xmath200 in equation ( [ reducedrr ] ) , @xmath201 should be set to zero for @xmath202 after each iteration of the timestep @xmath203 .",
    "setting @xmath204 for @xmath202 , at these discrete timesteps mimics the effect of these states undergoing reaction in step [ ii ] of the simulation algorithm .",
    "to find @xmath12 given a reaction radius of @xmath167 and timestep @xmath163 , we first check if @xmath205 . in this case , @xmath206 and we may use the theory outlined in section [ derivtheory ] . alternatively ,",
    "if @xmath207 , then @xmath208 and @xmath12 can be found from equation ( [ reducedrr ] ) .",
    "the following numerical steps are taken for @xmath209 .",
    "* find the non - dimensional timestep using @xmath167 and @xmath163 : @xmath210 .",
    "* initialize @xmath211 for @xmath212 .",
    "set @xmath213 .",
    "@xmath214 is chosen to be sufficiently far from the reacting radius @xmath138 ( for the simulations in this manuscript , we chose @xmath215 ) .",
    "lattice points for storing values of @xmath216 should be separated by @xmath217 , where @xmath218 is the time discretisation of the pde ( [ goveqg ] ) .",
    "reducing @xmath219 monotonically increases accuracy of the numerical integration involved in the calculation of the reduced reaction rate ( equation ( [ reducedrr ] ) ) .",
    "for the data generated in this manuscript we found it sufficient to set @xmath220 and @xmath221 .",
    "* for @xmath222 , fit the current distribution of @xmath201 to a functional form @xmath223 to find @xmath189 .",
    "the error that is generated as a result of this imposed functional form is controlled by the truncation parameter @xmath214 . for large enough @xmath214 , this functional form is asymptotically exact @xcite . in this manuscript ,",
    "@xmath201 over the final 10% of the numerically stored domain was used to find @xmath189 using least squares fitting . *",
    "numerically evolve equation ( [ goveqg ] ) from @xmath184 to @xmath224 remembering to use recalculated fitted values for @xmath189 in the boundary condition at @xmath187 .",
    "* calculate the putative reduced reaction rate , @xmath194 , for the current timestep , @xmath203 , using the integral in equation ( [ reducedrr ] ) .",
    "this integral should be solved numerically .",
    "the trapezoidal rule was used for this manuscript . *",
    "if the putative reduced reaction rate has converged ( differs with an acceptable relative variation between timesteps ) , the reaction rate , @xmath12 , can be found from @xmath194 in equation ( [ reducedrr ] ) . in this manuscript",
    "we accepted convergence if @xmath194 differed by less than 1 part in @xmath225 over two consecutive timesteps .",
    "otherwise , set @xmath204 for @xmath202 , update the current time @xmath226 and repeat from step [ iv ] until convergence .",
    "it is common to be presented with the inverse problem of finding the reaction radius @xmath167 given the diffusion - limited reaction rate @xmath12 . whilst it possible",
    "write a ` guess and check ' algorithm for finding @xmath167 from @xmath12 using the algorithm in the previous section , here we use a look up table since finding @xmath12 using the previous algorithm can be computationally time consuming .",
    "let us define @xmath227 as the rms displacement of the state in each dimension of non - dimensionalised state space per timestep @xmath203 ( notation consistent with andrews and bray @xcite ) , @xmath228 using the algorithm in the previous section , we first find and tabulate @xmath194 for @xmath229 , where @xmath230 .",
    "whilst @xmath194 can be found for @xmath231 by interpolation of the tabulated data , we use known forms of @xmath194 in the case of large @xmath227 and small @xmath227 .    for large @xmath227 ( @xmath232 ) ,",
    "@xmath233 inside the integrand on the rhs of equation ( [ reducedrr ] ) and therefore @xmath234 for small @xmath227 ( @xmath235 ) , the smoluchowski result is accurate .",
    "therefore , using equations ( [ reactionrate2 ] ) , ( [ reducedrr ] ) and ( [ sdash ] ) it is possible to show that @xmath236 the following root bracketing algorithm used by andrews and bray @xcite can be implemented to find the reaction radius @xmath167 as a result of a reaction rate @xmath12 for the finite @xmath163 timestep smoluchowski model .    *",
    "start with an initial guess for the reaction radius @xmath237 ( @xmath238 from equation ( [ sdash ] ) ) . set a minimum bound for @xmath167 : @xmath239 .",
    "* find the reduced reaction rate @xmath240 as a result of the current guess for @xmath241 .",
    "@xmath240 is found from using a cubic lagrange interpolating polynomial applied to the data in the table as a function of @xmath242 . for data outside of the range of the table ( @xmath243 and @xmath244 )",
    "the analytical formulas ( equations ( [ largedt ] ) and ( [ smalldt1 ] ) respectively ) may be used . *",
    "find @xmath245 from @xmath240 and @xmath246 using ( [ reducedrr ] ) . * if @xmath247 , update the minimum bound on the reaction radius @xmath248 and double the guess for the reaction radius @xmath249 ( subsequently halving @xmath241 ) .",
    "* repeat steps [ ii ] , [ iii ] and [ iv ] until @xmath250 and define @xmath251 , a known bracket interval length for the value of @xmath167 . *",
    "split the difference between the minimum , @xmath252 , and maximum , @xmath253 reaction radii for a new guess @xmath254 and find the subsequent @xmath241 using equation ( [ sdash ] ) .",
    "* repeat steps [ ii ] , [ iii ] . * whether or not @xmath255 or @xmath247 , the interval between maximum and minimum reaction radii is halved : @xmath256 . if @xmath255 , update the minimum bound on the reaction radius @xmath248 .",
    "* repeat steps [ vi]-[viii ] . for each repeat , the uncertainty in the guess , @xmath257 , is halved and linear convergence of the guess towards the true reaction rate is achieved .",
    "the author finds it sufficient to repeat 15 times .",
    "* set @xmath258 .",
    "figure [ redreactionrate_img ] shows how the reduced reaction rate @xmath194 depends on the rms displacement @xmath227 .",
    "the interface between the transient tabulated reduced reaction rate and the asymptotic limits ( [ largedt ] ) and ( [ smalldt1 ] ) are smooth indicating that the numerical algorithm which generated the tabulated data is converging to the correct reaction rate .     versus the rms displacement @xmath227 for reactions of order 2 ( black ) , 3 ( red ) , 4 ( green ) and 5 ( blue ) .",
    "the solid portions of these curves were calculated using cubic interpolating polynomials ]",
    "to validate the theory and explore the scientific implications of a smoluchowski approach to multimolecular reactions we present three test problems . the first test problem demonstrates a simple well - mixed reaction of various orders .",
    "the test problem is designed to test if , indeed , the reaction rate @xmath12 is correctly determined by its associated value of the reaction radius @xmath167 .",
    "the second test problem explores the validity of the law of mass action as it is normally applied to multimolecular reactions .",
    "finally , a simulation of a basic turing system , which necessarily requires the implementation of multimolecular reactions , will be demonstrated using the stochastic algorithm in table [ alg : complete ] .      in the first numerical test",
    "we simulate separately the following reactions of increasing order @xmath259 since the generalised smoluchowski theory simplifies to the classical theory for bimolecular reactions , the bimolecular reaction ( [ bireact ] ) is simulated using the smoldyn algorithm @xcite .",
    "each of the chemical reactions ( [ bireact])-([pentareact ] ) result , in principle , in the simple exponential decay of @xmath16 .",
    "this affords us the possibility to validate the numerical algorithm which simulates these reactions .",
    "specifically , we wish to show that the average simulation rate of decay of @xmath16 matches that which we prescribe ( @xmath260 , @xmath261 , @xmath262 , and @xmath263 respectively ) . the molecular copy - numbers of @xmath17 , @xmath18 , @xmath264 and @xmath265 in each of the chemical reactions is conserved and for the sake of continuity between simulations of reactions with different orders were chosen to be equal ( @xmath266 molecules each ) . the well - mixed domain is a dimensionless @xmath267 cube with periodic boundary conditions ( to avoid boundary effects ) . in order to ensure the same prescribed rate of decay of @xmath16 , which may be then compared for each type of simulated chemical reaction , the dimensionless reaction rates were chosen as @xmath268 ( the half - life of @xmath16 for each reaction",
    "is expected to be a dimensionless time of @xmath269 ) .",
    "the population of @xmath16 is initialised at @xmath270 molecules such that intrinsic simulation noise is as small as possible and only apparent at large times .",
    "[ test3 ] demonstrates that each simulation reproduces the correct prescribed reaction rate . as the order of the reaction rate",
    "is increased , the simulated reaction rate increasingly undervalues the theoretical reaction rate .",
    "this is because the density of reactant combinations significantly increases with reaction order and the smoluchowski dilute limit becomes increasingly invalid .     for each of the chemical systems ( [ bireact])-([pentareact ] ) as a function of time @xmath128 using the generalised smoluchowski framework .",
    "the initial number of molecules of @xmath16 is @xmath270 , whilst other chemical species have @xmath266 molecules . for each of the simulations ,",
    "the prescribed rate of decay of @xmath16 is the same ( @xmath271 ) and compared with the simulation output . whilst there is fairly good agreement between simulations , the simulated rate of decay is increasingly less than the theoretical rate @xmath12 as the order of the reaction increases .",
    "the simulated decay rate of @xmath16 is determined by non - linear least squares fit to an exponential decay model and presented in the subgraph in the top right corner .",
    "the timestep for each of the simulations was @xmath272 but plotted only after every @xmath273 timesteps .",
    "the standard errors associated with the simulated reaction rates are very small ( less than @xmath274 in all four cases ) and so are not shown with errorbars . ]      in this subsection we test the well - mixed chemical system @xmath275 inside a unit cube with periodic boundary conditions ( so that boundary effects do not contaminate the results of the simulations )",
    ". only one immortal molecule of both @xmath16 and @xmath17 are initially placed at random within the cube to minimise crowding and obtain the best possible reaction rate .",
    "we shall use non - dimensional rate parameters @xmath276 and @xmath277 .",
    "this type of chemical system is often treated using the law of mass action . according to the law of mass action , at any moment in time , the propensity for the creation of a molecule of c is given by @xmath278 and the propensity for the trimolecular removal of a molecule of c is given by @xmath279 where @xmath280 is the current number of molecules of c ( the reader is reminded that @xmath281 for all time ) . using the associated master equation for this birth - death process",
    "it is trivial to show that the steady state distribution of @xmath280 ought to be the poisson distribution , @xmath282 . to test",
    "if @xmath16 , @xmath17 and @xmath18 obey mass action kinetics in a smoluchowski model of trimolecular reactions we initialise @xmath280 molecules uniformly distributed over the unit volume .",
    "the number of molecules @xmath280 is sampled from the mass action steady state @xmath283 .",
    "choosing non - dimensional diffusion constants @xmath284 , the chemical system is simulated using the generalised smoluchowski kinetics and a timestep of @xmath285 for a non - dimensional duration of @xmath286 .",
    "this simulation was repeated @xmath287 times and the distribution of @xmath280 was sampled . in fig .",
    "[ test1 ] the distribution of @xmath280 after simulation ( blue bars ) is compared with the poisson distribution with a mean of 10 ( red dots ) .",
    "the difference between the smoluchowski simulation and the poisson ( mass action ) distributions is indicated using red bars .",
    "it is clear that the variance of the initial poisson distribution has increased ( from @xmath288 to @xmath289 ) .",
    "the final number of molecules of c are more likely to be in the two tails of the distribution . because the poisson distribution is skewed , the overall average number of molecules of c is also slightly increased from @xmath288 to @xmath290 .",
    "the law of mass action assumes that the current rate of reaction depends on the current state of the chemical system and has no memory of past events .",
    "this assumption is broken for multimolecular diffusion - controlled reactions .",
    "molecules of @xmath18 can only be removed if the molecules of @xmath16 and @xmath17 are sufficiently close . given that a molecule of @xmath18 has just been removed , it is more likely that @xmath16 and @xmath17 are close ( @xmath25 small ) and that other molecules of @xmath18 will be removed in the near future .",
    "conversely , if it has been a significant time since the last removal of @xmath18 from the system , it is more likely that @xmath16 and @xmath17 are far apart ( @xmath25 large ) and this reduces the probability of a molecule of @xmath18 being removed in the near future . consequently , the number of molecules of @xmath18 linger at the two tails of the distribution for longer than they would under the assumptions of mass action . if the temporal correlation of @xmath25 disperses more rapidly ( by an increase in @xmath291 or @xmath292 ) the final distribution of the smoluchowski reaction simulations more closely matches the poisson distribution predicted by mass action .",
    "conversely , the discrepancy is emphasised by decreasing @xmath291 and @xmath292 .     for the chemical system ( [ massaction ] ) after a dimensionless time interval @xmath293 .",
    "the blue bars represent the distribution sampled from @xmath287 simulations of the generalised smoluchowski algorithm .",
    "the red dots represent the poisson distribution predicted by the law of mass action .",
    "the red bars represent the difference between these two distributions indicating that smoluchowski reaction kinetics tend to favour the two tails of the distribution .",
    "this is due to a the fact that molecules @xmath16 and @xmath17 are more likely to be near each other when the number of molecules of @xmath18 is small and at a distance when the number of molecules of @xmath18 is large .",
    "the maximum error associated with these histograms as a result of @xmath287 simulations is less than @xmath294 and are therefore not shown on this figure . ]      in 1952 , alan turing demonstrated a mathematical basis for how a system of reacting chemical species undergoing diffusion may spontaneously exhibit heterogeneity from an homogeneous initial distribution @xcite .",
    "the resultant heterogeneity in the chemical concentrations are known as turing patterns and have since been observed widely in chemistry and biology @xcite .",
    "often turing patterns are modelled using partial differential equations ( pdes ) . at low concentrations",
    ", pdes do not accurately represent the stochastic behaviour of a chemical system . in this subsection",
    ", we shall demonstrate that the generalised smoluchowski framework is capable of simulating stochastic turing patterns .",
    "we shall use the example chemical system @xmath295 this simple turing system was first studied by jrgen schnakenberg @xcite and subsequently it bears his name .",
    "the one - dimensional mean - field pde description of this chemical system in the presence of diffusion is given by @xmath296 where @xmath297 and @xmath298 are concentrations of @xmath299 and @xmath2 per unit length , the bar notation here denotes that the chemical rates are with respect to concentration per unit length and not volume and @xmath300 and @xmath301 are the einstein diffusion constants for molecules of type @xmath299 and @xmath2 respectively .",
    "a widely accepted approach to studying the stochastic nature of this chemical system in the presence of diffusion is with the use of well - mixed compartments and the spatial gillespie algorithm ( which solves exactly for realisations of the reaction - diffusion master equation ) . in their recent publication , cao and",
    "erban @xcite demonstrated that using such an approach to study turing patterns can be difficult since the pattern may be affected by the choice of lattice which bring the results of the simulation into question .",
    "cao and erban specifically used the schnakenberg system in ( [ turingsystem ] ) on a dimensionless 1d domain from 0 to 1 . for this test problem",
    ", we shall use dimensionless parameters that were used in their paper : @xmath302 , @xmath303 , @xmath304 , @xmath305 , @xmath306 and @xmath307 .",
    "since the smoluchowski dynamics is written for three - dimensional spatial domains , we simulate the reaction - diffusion system ( [ turingsystem ] ) on a rectangular prism domain of volume @xmath308 where @xmath309 , inspired by the compartment - size used in cao and erban s paper , are the side lengths of the domain in the @xmath310 and @xmath311 directions .",
    "we implement periodic boundary conditions in the @xmath310 and @xmath311 direction and no flux boundary conditions at @xmath312 and @xmath313 .",
    "importantly , since we have translated the test problem from one dimension to three dimensions , the chemical reaction rates should be translated into volumetric reaction rates .",
    "that is , we use the translated reaction rates @xmath314 , @xmath315 , @xmath316 and @xmath317 .",
    "a timestep of @xmath318 and a uniform initial condition consistent with the unstable uniform steady state of the chemical system ( @xmath319 total molecules of @xmath299 and @xmath320 total molecules of @xmath2 ) was used .",
    "simulations were performed using both the classical spatial gillespie algorithm from cao and erban @xcite and a generalised smoluchowski simulation .",
    "the results of these simulations at @xmath293 can be seen in fig .",
    "[ turingresults ] .",
    "the spatial gillespie algorithm produced two and a half peaks of both @xmath299 and @xmath2 which is consistent with the pde system ( [ u ] ) and ( [ v ] ) .",
    "on the other hand , smoluchowski simulations produced three distinct peaks ( with a significantly reduced amplitude ) in @xmath299 and peaks in @xmath2 between those of @xmath299 .",
    "simulations of multimolecular diffusion - controlled reactions in a thin layer of space near boundaries have been shown to exhibit a perturbed ( reduced ) reaction rate @xcite ( although this has never been reported experimentally ) .",
    "the reason for this is due to the reduction of total flux over the reaction radius due to the reduction of molecular flux over the boundary . whilst a rigorous analysis of this effect is yet to be published",
    ", it can be shown that a very small perturbation in the value of @xmath262 near the boundary is capable of completely changing the steady state turing pattern and that change is predicted by smoluchowski simulations .     at time @xmath293 for the chemical system in equation ( [ turingsystem ] ) .",
    "a ) molecules of u and b ) molecules of v for the chemical system simulated using the classical spatial gillespie algorithm as implemented by cao and erban @xcite on the regular lattice with spacing @xmath321 .",
    "c ) molecules of u and d ) molecules of v for the chemical system simulated using the generalised smoluchowski framework with a timestep of @xmath318 .",
    "the red solid line in each figure corresponds to the uniform unstable steady state of the pde system ( [ u ] ) and ( [ v ] ) and the initial condition for the simulations .",
    "the red dashed lines are the steady state turing solutions to the pde system ( [ u ] ) and ( [ v ] ) solved using matlab s pdepe solver with a spatial resolution of @xmath322 .",
    "bars coloured blue indicate molecular copy numbers greater than the uniform steady state so that the turing pattern can be more easily identified .",
    "it should be noted that for the pde solution in figures [ turingresults]c and [ turingresults]d a perturbed heterogeneous form for @xmath323 is used ( see equation ( [ perturbation ] ) ) to mimic the boundary effects consistent with the diffusion - controlled reactions simulated by the smoluchowski framework . ]    in figures [ turingresults]c and [ turingresults]d we compare the molecular distribution of @xmath299 and @xmath2 as a result of smoluchowski simulation with the steady state of the pde system ( [ u ] ) and ( [ v ] ) where a perturbation to @xmath262 is introduced @xmath324 where @xmath325 and @xmath326 are chosen to be conservatively small .",
    "this perturbation to @xmath262 was able to force a completely different turing pattern . in order to test that the three - peaked turing pattern was an attractor state for the smoluchowski simulation ( and not just an artefact of the initial conditions near the unstable homogeneous steady state ) , a smoluchowski simulation was run until @xmath293 using the classical gillespie algorithm distribution in figures [ turingresults]a and [ turingresults]b as an initial condition .",
    "the gillespie turing pattern reliably evolved into the three - peaked smoluchowski turing pattern . on a final note",
    ", it can be seen fairly clearly in figure [ turingresults ] that stochastic simulations , both the spatial gillespie and the smoluchowski simulations , do not generate peaks which coincide with the peaks of the pde precisely .",
    "this discrepancy is due to intrinsic stochastic noise and not due to the errors in the approximations or implementations of the simulation algorithms .",
    "in this paper we have extended the smoluchowski theory to encompass diffusion - controlled reactions of any order in three dimensions .",
    "the reaction radius in this generalised framework represents the proximity of a set of reactants , bellow which , a reaction may occur .",
    "the definition of proximity in this context is quite deliberate .",
    "it is defined by equation ( [ proximity ] ) and utilises the displacement of each successive reactant from the centre of diffusion of the previous reactants . whilst the proximity is equivalent to the square root of the weighted mean square distance between all pairs of reactants ,",
    "it is more convenient to use ( [ proximity ] ) as a definition .",
    "it can be shown that the smoluchowski reaction radius should then be given implicitly by equation ( [ gensmol ] ) . using this mathematical framework ,",
    "a number of interesting phenomena involving high order reactions were observed .",
    "high order reactions have a reduced reaction rate due to significantly increased density of reactant combinations .",
    "furthermore , since reactions of order three or higher require the proximity of two or more reactants before a final molecule can cause a reaction to occur , memory is implicit in these reaction - diffusion systems and subsequently this may cause mass action kinetics to be inaccurate .",
    "finally , multimolecular diffusion controlled reactions have a reduced reaction rate near boundaries and this may cause heterogeneous reaction - diffusion patterns to behave differently than the classical reaction - diffusion pde would indicate .",
    "one of the defining attributes of the generalised smoluchowski theory , as presented in this manuscript , is that a molecular order must be defined before the proximity @xmath65 may be calculated and compared with the reaction radius .",
    "this is because , according to equation ( [ proximity ] ) , the proximity involves summing weighted contributions of square lengths , @xmath327 , and relative diffusion constants @xmath50 , which are both functions of the chosen molecular order .",
    "seemingly , @xmath65 depends on the order in which you choose to label the molecules , however the choice of labelling was done arbitrarily and so should give the same result regardless of the order .",
    "here we shall show that the definition for the proximity of @xmath20 molecules @xmath65 as well as the reaction rate @xmath12 defined by a reaction radius @xmath14 is invariant under the choice of molecule labelling .",
    "the diffusion constant for the @xmath22-th separation vector @xmath50 depends on the labelling of the molecules , however , using equations ( [ dbar ] ) and ( [ realdbar ] ) we find that @xmath329 where , for the sake of notational simplicity , we have used the notation @xmath38 and @xmath330 ( @xmath331 acts as the diffusive weight of the @xmath22th molecule and @xmath332 the total diffusive weight of the first @xmath22 molecules used when calculating centres of diffusion ) .",
    "thus ( since @xmath333 ) , @xmath334 is independent of the labelling order .",
    "furthermore , we have , from equation ( [ scalefact ] ) , @xmath335 which is also independent of the labelling order .",
    "therefore , according to the result ( [ gensmolappend ] ) , @xmath12 is independent of the labelling order if and only if @xmath14 ( which is nothing other than a particular proximity @xmath65 ) is also independent of the labelling order .",
    "the measure of the proximity of @xmath20 reactants is given by equation ( [ proximity ] ) @xmath336 since we already know @xmath52 is independent of the molecular order , we wish to show that @xmath337 is independent of the molecular order . in order to show that this is the case , we need to write @xmath338 in terms of relative molecular distances .",
    "we denote @xmath339 and @xmath340 . since @xmath341 and @xmath342 , we shall only consider distances where the first index is larger than the second index .",
    "we wish to write all distances of the form @xmath343 in terms of relative molecular distances of the form @xmath344 for some combinations of @xmath22 and @xmath176 .",
    "using figure [ triangle ] and applying the cosine rule twice , we can write an iterative identity for distances of the form @xmath343 .    ) .",
    "the red line corresponds to a distance determined by a separation vector @xmath345 , the blue line is a portion of the red line and is determined by the relative diffusive weights at @xmath91 and the centre of diffusion of the previous @xmath346 molecules , @xmath347 .",
    "the two green lines do not , necessarily , correspond to any of the separation vectors but are distances that iteratively need to be simplified using equation ( [ triangleeqn ] ) . the black line is a distance between two molecules . ]      where @xmath349 , @xmath350 and @xmath351 . by definition of the separation vectors",
    "@xmath338 , we have that @xmath352 ) to equation ( [ etai_iterate ] ) to eliminate all distances including a centre of diffusion ( distances with an overbar over the second index ) . since indices on the rhs of equation ( [ triangleeqn ] )",
    "are less than or equal to the indices of the lhs , we have that @xmath353 can be constructed by considering all terms that contain @xmath354 after iteration of equation ( [ triangleeqn ] ) .",
    "we notice that the rhs of equation ( [ triangleeqn ] ) has three terms , one that is already a distance between two molecules ( of the form @xmath354 ) and two others that require further iteration . with each iteration ,",
    "the second index @xmath176 is reduced by 1 but the first index is either left unchanged or drops in line with @xmath355 .",
    "each time the first index is left unchanged , a factor of @xmath356 is multiplied a term in to the coefficient @xmath357 and each time the first index drops in line with @xmath355 , a factor of @xmath358 is multiplied to a term in the coefficient @xmath357 .",
    "the coefficient @xmath357 is therefore the product of all of the @xmath356 and @xmath358 steps in going from @xmath359 to @xmath360 ( that is , the product of @xmath356 or @xmath358 over second index values @xmath176 for each reduction on the interval @xmath361 ) and then summed over all possible trajectories the indices may take and finally multiplied by @xmath362 to go from @xmath360 to @xmath354 . figure [ graphdiag ] illustrates the trajectories that the indices may take in going from @xmath363 to a particular @xmath364 where @xmath361 .",
    "it is important to note that all trajectories must pass through the indices @xmath365 and thus must have a @xmath366 step and @xmath367 @xmath356 steps as @xmath176 decreases each iteration between @xmath368 and @xmath369 .",
    "finally , it does not matter which , either @xmath356 or @xmath358 , step is taken for @xmath370 and thus we should multiply @xmath371 for each iteration in this region to obtain the sum of all possible trajectories .",
    "noting , finally , that if @xmath372 we only have @xmath356 steps , @xmath373\\left[\\prod_{j = j+1}^{i-1 } \\gamma_j+\\beta_j \\right ] & \\ \\text { for } l\\neq i",
    "\\\\        \\omega_m\\left[\\prod_{j = m+1}^{i-1 } \\gamma_j\\right ] & \\ \\text { for } l = i      \\end{array } \\right . , \\\\   & =     \\left\\lbrace       \\begin{array}{cc }        -d_m d_l/\\overline{d}_{i-1}^2 & \\ \\text { for } l\\neq i \\\\",
    "d_m/\\overline{d}_{i-1 } & \\ \\text { for } l = i      \\end{array } \\right . .\\end{aligned}\\ ] ]     like terms from a decomposition of the vector @xmath374 .",
    "the dots represent possible indices of intermediate @xmath375 terms and the blue dots are those that correspond to separation vectors @xmath376 . in order to get from @xmath359 to @xmath360 the index trajectories must pass through @xmath377 and thus @xmath357 is the product over @xmath176 of three separate regions @xmath378 , @xmath379 and @xmath380 unless @xmath372 and there is only one trajectory . ]",
    "substituting @xmath357 into equation ( [ etaisq ] ) gives @xmath381 ) into equation ( [ appendeqn ] ) gives @xmath382 interchanging the sum over @xmath22 and the sum over @xmath383 in the second term on the rhs and noting that @xmath384 which can be proven easily by induction for all @xmath385 , we have @xmath386 separating the @xmath20-th term in the first sum of the first term , relabelling the dummy index @xmath383 with @xmath22 in the second term and joining the remaining double summations together gives @xmath387 where the summation in the final statement is for all combinations of @xmath22 and @xmath56 such that @xmath388 and all molecule combinations are only counted once .",
    "this expression for @xmath65 is clearly independent on the order in which the molecules are labelled .",
    "the scale factor @xmath389 as presented in equation ( [ scalefact ] ) , was chosen arbitrarily so that the resultant square proximity @xmath390 would be a weighted average of square molecular separations ( which best fits the intuitive physical definition of this metric ) and consequently , for @xmath66 , @xmath391 is consistent with the classical smoluchowski theory .",
    "o.  tymchyshyn and m.  kwiatkowska , _ combining intra and inter - cellular dynamics to investigate intestinal homeostasis _ , in : fisher j , ed .",
    "formal methods in systems biology , vol 5054 .",
    "berlin , heidelberg : springer : 6376 ( 2008 ) ."
  ],
  "abstract_text": [
    "<S> in 1917 , marian von smoluchowski presented a simple mathematical description of diffusion - controlled reactions on the scale of individual molecules . </S>",
    "<S> his model postulated that a reaction would occur when two reactants were sufficiently close and , more specifically , presented a succinct relationship between the relative proximity of two reactants at the moment of reaction and the macroscopic reaction rate . over the last century , smoluchowski reaction theory has been applied widely in the physical , chemical , environmental and , more recently , the biological sciences . despite the widespread utility of the smoluchowski theory , it only describes the rates of second order reactions and is inadequate for the description of higher order reactions for which there is no equivalent method for theoretical investigation . in this paper , we derive a generalised smoluchowski framework in which we define what should be meant by proximity in this context when more than two reactants are involved . </S>",
    "<S> we derive the relationship between the macroscopic reaction rate and the critical proximity at which a reaction occurs for higher order reactions . using this theoretical framework and using numerical experiments </S>",
    "<S> we explore various peculiar properties of multimolecular diffusion - controlled reactions which , due to there being no other numerical method of this nature , have not been previous reported . </S>"
  ]
}