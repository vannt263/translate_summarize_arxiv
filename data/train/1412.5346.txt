{
  "article_text": [
    "geometric numerical integration methods have come to the fore , partly as an alternative to traditional methods such as runge - kutta methods . a numerical method is called geometric if it preserves one or more physical / geometric properties of the system exactly ( i.e. up to round - off error )  @xcite .",
    "examples of such geometric properties that can be preserved are ( first ) integrals , symplectic structures , symmetries and reversing symmetries , phase - space volumes , lyapunov functions , foliations , etc .",
    "geometric methods have applications in many areas of physics , including celestial mechanics , particle accelerators , molecular dynamics , fluid dynamics , pattern formation , plasma physics , reaction - diffusion equations , and meteorology  @xcite .",
    "in fact , the conservation of the energy function is one of the most relevant features characterizing a hamiltonian system .",
    "methods that exactly preserve energy have been considered since several decades .",
    "many energy - preserving methods have been proposed  @xcite .",
    "the discrete gradient method is among the most popular methods for designing integral preserving schemes for ordinary differential equations , which was perhaps first discussed by o. gonzalez  @xcite .",
    "t. matsuo proposed discrete variational method for nonlinear wave equation  @xcite .",
    "l. brugnano and f. iavernaro proposed hamiltonian boundary value methods  @xcite .",
    "more recently , the existence of energy - preserving b - series methods has been shown in @xcite , and a practical integrator which is the averaged vector field ( avf ) method of order two has been proposed  @xcite .",
    "this method exactly preserves the energy of hamiltonian systems , and in contrast to projection - type integrators , only requires evaluations of the vector field .",
    "it is symmetric and its taylor series has the structure of a b - series . for polynomial hamiltonians , the integral",
    "can be evaluated exactly , and the implementation is comparable to that of the implicit mid - point rule  @xcite .    in recent years , there has been growing interest in high - order avf methods , and the second , third and fourth order avf methods have been proposed  @xcite .",
    "it is shown that the theory of b - series and the substitution law obtained by substituting a b - series into the vector field appearing in another b - series play an important role in constructing high order methods  @xcite .",
    "the substitution law for the trees of order @xmath2 has been shown in @xcite .",
    "the fourth order avf method is obtained by the concrete formulas of the substitution law for the trees of order @xmath2 . to construct a b - series method which not only has high order accuracy but also preserves the hamiltonian is an important and interesting topic .",
    "however , the concrete formulas of the substitution law for the trees of order @xmath3 have not been proposed , as the corresponding calculations are sufficiently complicated .",
    "there are two aims in this paper .",
    "the first aim is to propose the concrete formulas of the substitution law for the trees of order @xmath0 .",
    "as we know , a low order b - series integrator can be extend to high order by the substitution law . using the new obtained concrete formulas of the substitution law for the trees of order @xmath0",
    ", one can extend a low order geometric b - series integrator to sixth order naturally , easily and automatically , such as the symplectic integrator , the energy - preserving integrator , the momentum - preserving integrator and so on . using the new",
    "obtained substitution law , we also easily obtained the same sixth order symplectic integrator in  @xcite .",
    "the second aim is to derive a sixth order avf method for hamiltonian systems . by expanding the second order avf method into a b - series and considering the substitution law for the trees of order @xmath0 ,",
    "a new method can be constructed .",
    "the new method is derived by the concrete formulas of the substitution law for the trees of order @xmath0 .",
    "we prove that the new method is of order six and can also preserve the energy of hamiltonian systems exactly .",
    "the paper is organized as follows : in sect .",
    "[ sec:2 ] , we introduce the avf method . in sect .",
    "[ sec:3 ] , we recall a few definitions and properties related to trees and b - series . the substitution law for the trees of order @xmath2 is shown and we obtain that for the trees of order @xmath0 . in sect .",
    "[ sec:4 ] , we derive the sixth order avf method , and prove that the new method is of order six and it can preserve the hamiltonian .",
    "a few numerical experiments are given in sect .",
    "[ sec:5 ] to confirm the theoretical results .",
    "we finish the paper with conclusions in sect .",
    "[ sec:6 ] .",
    "here we briefly discuss the avf method and its energy - conservation property . we consider a hamiltonian differential equation , written in the form @xmath4 where @xmath5 , @xmath6 is a skew - symmetric constant matrix , @xmath7 is an even number , and the hamiltonian @xmath8 is assumed to be sufficiently differentiable . from system , we can get @xmath9 therefore , the flow of the system preserves the hamiltonian @xmath8 exactly .    the so - called avf method  @xcite is defined by @xmath10 where @xmath11 is the time step .",
    "the avf method can be rewritten as @xmath12 we can obtain @xmath13 it follows that the hamiltonian @xmath14 is conserved at every time step .",
    "r. i. mclachlan and g. r. w. quispel also proposed a higher order energy - preserving method  @xcite @xmath15 where @xmath16 is an arbitrary constant , @xmath17 is the kronecker delta , and we can take e.g. @xmath18 or @xmath19 . for @xmath20 , we recover the second order method . for @xmath21 and @xmath18 ,",
    "the method is of order three . for @xmath21 and @xmath19 ,",
    "the method is of order four .",
    "the highest order of existing avf method is four , and based on the theory of substitution law we can obtain a new avf method of order six .",
    "in this section , we briefly recall a few definitions and properties related to rooted trees and b - series  @xcite .",
    "let @xmath22 denote the empty tree .",
    "the set @xmath23 of ( rooted ) unordered trees is recursively defined by @xmath24\\in \\mathcal{t},\\quad \\forall~ \\tau_{1},\\ldots,\\tau_{m}\\in \\mathcal{t},\\ ] ] where @xmath25 is the tree with only one vertex , and @xmath26 $ ] represents the rooted tree obtained by grafting the roots of @xmath27 to a new vertex .",
    "trees @xmath28 are called the branches of @xmath29 .",
    "we note that @xmath29 does not depend on the ordering of @xmath30 .",
    "for instance , we do not distinguish between @xmath31 $ ] and @xmath32,\\tree11]$ ] .",
    "the following coefficients are defined recursively for all trees @xmath26\\in \\mathcal{t}$ ] : @xmath33 where the integers @xmath34 count equal trees among @xmath30 .    for a vector field @xmath35 , and for an unordered tree @xmath26\\in \\mathcal{t}$ ] , the so - called elementary differential is a mapping @xmath36 , recursively defined by @xmath37    for a mapping @xmath38 , a formal series of the form @xmath39 is called a b - series .",
    "if @xmath40 denotes the exact solution of , it holds for all @xmath41 , @xmath42 therefore , letting @xmath43 , the exact solution of is ( formally ) given by @xmath44        in order to manipulate trees more conveniently , it is useful to consider the set @xmath45 of ordered trees defined below .",
    "+    [ def:3s5 ] the set @xmath45 of ordered trees is recursively defined by @xmath46 in contrast to @xmath23 , the ordered tree @xmath47 depends on the ordering @xmath48 .    neglecting the ordering ,",
    "a tree @xmath49 can be considered as an equivalent class of ordered trees , denoted @xmath50 .",
    "therefore , any function @xmath51 defined on @xmath23 ( such as order , symmetry , density ,  ) can be extended to @xmath45 by putting @xmath52 for all @xmath53 . moreover , for all @xmath49 , we can choose a tree @xmath54 such as @xmath55  @xcite .",
    "+    a partition @xmath56 of an ordered tree @xmath57 is the ( ordered ) tree obtained from @xmath58 by replacing some of its edges by dashed ones .",
    "we denote @xmath59 the list of subtrees @xmath60 obtained from @xmath56 by removing dashed edges and by neglecting the ordering of each subtree .",
    "we denote @xmath61 the number of @xmath62 s .",
    "we observe that precisely one of the @xmath62 s contains the root of @xmath58 .",
    "we denote this distinguished tree by @xmath63 .",
    "we denote @xmath64 the list of @xmath62 s that do not contain the root of @xmath58 .",
    "eventually , the set of all partitions @xmath56 of @xmath58 is denoted @xmath65 .",
    "finally , for @xmath49 , we put @xmath66 where @xmath54 is given in definition [ def:3s5 ] .",
    "we observe that any tree @xmath49 has exactly @xmath67 partitions @xmath68 , and that different partitions may lead to the same list of subtrees @xmath69 .",
    "+    the skeleton @xmath70 of a partition @xmath68 of a tree @xmath49 is the tree obtained by replacing in @xmath71 each tree of @xmath69 by a single vertex and then dashed edges by solid ones .",
    "we can notice that @xmath72 .",
    "let @xmath73 be two mappings with @xmath74 . given a field @xmath35 ,",
    "consider the ( h - dependent ) field @xmath75 defined by @xmath76 then , there exists a mapping @xmath77 satisfying @xmath78 and @xmath79 is defined by @xmath80    in @xcite , the concrete formulas of the substitution law for the trees of order @xmath2 was proposed ( see table  [ tab:1 ] ) . in this paper , we obtain the concrete formulas of the substitution law for the trees of order @xmath0 ( see table  [ tab:2 ] ) .",
    "@xmath81    @xmath82    @xmath83",
    "consider an ordinary differential equation @xmath84 and the second order avf method @xmath85    the avf method can be expanded into a b - series @xmath86 where @xmath87 , and for all @xmath26\\in \\mathcal{t}$ ] , @xmath88    [ [ proof ] ] proof + + + + +    we develop the derivatives of , by leibniz s rule , and obtain @xmath89^{(q)}=h[\\int_{0}^{1}f(\\xi z_{1}+(1-\\xi)z_{0})d\\xi]^{(q)}+q[\\int_{0}^{1}f(\\xi z_{1}+(1-\\xi)z_{0})d\\xi]^{q-1}.\\ ] ] this gives , for @xmath90 , @xmath91^{q-1}|_{h=0},\\quad q\\geq 1,\\ ] ] and considering @xmath92 , we can obtain @xmath93 and so on .",
    "we now insert in recursively the computed derivatives @xmath94 into the right side of the subsequent formulas . letting @xmath95 and @xmath96",
    ", we can obtain @xmath97 and so on .",
    "for all @xmath26\\in \\mathcal{t}$ ] , letting @xmath98 , where the integers @xmath34 count equal trees among @xmath30 , we can obtain @xmath99\\cdot [ \\alpha\\alpha(\\tau_{1})\\cdot\\ldots\\cdot\\alpha(\\tau_{m})]\\cdot [ \\frac{1}{m+1}a(\\tau_{1})\\cdots a(\\tau_{m})]\\cdot f^{m}(z_{0})(f(\\tau_{1}),\\ldots , f(\\tau_{m}))\\\\ = ~ & \\gamma(\\tau)\\alpha(\\tau)[\\frac{1}{m+1}a(\\tau_{1})\\cdots a(\\tau_{m})]f(\\tau).\\end{aligned}\\ ] ] so we have @xmath100 where @xmath101 , and for all @xmath26\\in \\mathcal{t}$ ] , @xmath88 letting @xmath102 , and considering @xmath103 , we obtain @xmath104 the proof is completed .",
    "the b - series can be rewritten as @xmath105      let @xmath38 be a mapping satisfying @xmath102 , @xmath106 , and let @xmath35 be a field .",
    "we consider here the numerical flow @xmath107 , where @xmath75 denotes the modified field of @xmath108 , whose b - series expansion is @xmath109 the fundamental idea of obtaining sixth order avf method consists in interpreting the numerical solution @xmath110 of the initial value problem @xmath111 , @xmath112 as the exact solution of a modified differential equation @xmath113  @xcite .",
    "+    if @xmath114 , which is a numerical solution of , can be expanded into a b - series @xmath115 and @xmath116 be a mapping with @xmath74 satisfying @xmath117 then we can obtain a new numerical solution @xmath118 , satisfying @xmath119 where @xmath120 denotes the exact solution of , and @xmath121 is a ( h - dependent ) field defined by @xmath122    from theorem 3.1 , @xmath123 . and from theorem 3.2 , we obtain @xmath124 the proof is completed .",
    "letting @xmath125 , we can calculate @xmath126 defined in for trees of order @xmath127 : @xmath128 @xmath129 and in the same way , for all trees of order @xmath130 , we can obtain @xmath131 .    then we obtain the exact modified field @xmath132 and the sixth order modified field @xmath133,\\end{aligned}\\ ] ] satisfying @xmath134 and @xmath135 . and considering @xmath136 , we have @xmath137 letting @xmath138 , @xmath139 , @xmath140 and @xmath141 , we have @xmath142 and for all @xmath49 @xmath143 considering @xmath144 , we have @xmath145 and @xmath146 we consider @xmath147 , @xmath148 . for @xmath149 , we have @xmath150 and @xmath151d\\eta+\\mathcal{o}(h^{3})\\\\ \\label{eq:4s9 } = ~ & hf(\\hat{z})+\\mathcal{o}(h^{3})=~ hf+\\mathcal{o}(h^{3})\\nonumber\\\\ or\\quad z_{1}-z_{0 } = ~ & \\mathcal{o}(h).\\end{aligned}\\ ] ] so we can obtain @xmath152\\cdot [ f'(\\hat{z})+\\eta f''(\\hat{z})(z_{1}-z_{0})\\\\ & + \\frac{\\eta^{2}}{2 ! } f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})+\\frac{\\eta^{3}}{3!}f^{(4)}(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},z_{1}-z_{0})+\\mathcal{o}(h^{4})]\\\\ & \\cdot f(\\hat{z}+\\eta(z_{1}-z_{0}))d\\eta\\\\ = ~ & \\int_{-\\frac{1}{2}}^{\\frac{1}{2}}\\{f'(\\hat{z})f'(\\hat{z})f(\\hat{z}+\\eta(z_{1}-z_{0}))+f'(\\hat{z})[\\eta f''(\\hat{z})(z_{1}-z_{0})+\\frac{\\eta^{2}}{2 ! } f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})\\\\ & + \\frac{\\eta^{3}}{3 ! } f^{(4)}(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},z_{1}-z_{0})]\\cdot [ f(\\hat{z})+\\eta f'(\\hat{z})(z_{1}-z_{0})\\\\ & + \\frac{\\eta^{2}}{2 ! } f''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})+\\mathcal{o}(h^{3})]+[\\eta f''(\\hat{z})(z_{1}-z_{0})+\\frac{\\eta^{2}}{2 ! } f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})\\\\ & + \\frac{\\eta^{3}}{3 ! } f^{(4)}(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},z_{1}-z_{0})]\\cdot [ f'(\\hat{z})+\\eta f''(\\hat{z})(z_{1}-z_{0})\\\\ & + \\frac{\\eta^{2}}{2 ! } f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})+\\frac{\\eta^{3}}{3!}f^{(4)}(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},z_{1}-z_{0})]\\\\ & \\cdot [ f(\\hat{z})+\\eta f'(\\hat{z})(z_{1}-z_{0})+\\frac{\\eta^{2}}{2 ! } f''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0})+\\mathcal{o}(h^{3})]\\}d\\eta+\\mathcal{o}(h^{4})\\\\ = ~ & f'(\\hat{z})f'(\\hat{z})\\int_{-\\frac{1}{2}}^{\\frac{1}{2}}f(\\hat{z}+\\eta(z_{1}-z_{0}))d\\eta+\\int_{-\\frac{1}{2}}^{\\frac{1}{2}}[\\eta^{2}f'(\\hat{z})f''(\\hat{z})(z_{1}-z_{0},f'(\\hat{z})(z_{1}-z_{0}))\\\\ & + \\frac{\\eta^{2}}{2!}f'(\\hat{z})f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},f(\\hat{z}))+\\eta^{2}f''(\\hat{z})(z_{1}-z_{0},f'(\\hat{z})f'(\\hat{z})(z_{1}-z_{0}))\\\\ & + \\eta^{2}f''(\\hat{z})(z_{1}-z_{0},f''(\\hat{z})(z_{1}-z_{0},f(\\hat{z})))+\\frac{\\eta^{2}}{2!}f'''(\\hat{z})(z_{1}-z_{0},z_{1}-z_{0},f'(\\hat{z})f(\\hat{z}))]d\\eta+\\mathcal{o}(h^{4})\\\\ = ~ & f'f'f+\\frac{h^{2}}{12}[f'f''(f'f , f)+f''(f'f'f , f)+f''(f''(f , f),f)+\\frac{1}{2}f'f'''(f , f , f)\\\\ & + \\frac{1}{2}f'''(f'f , f , f ) ] + \\mathcal{o}(h^{4}).\\end{aligned}\\ ] ] considering @xmath153 , we have @xmath154\\cdot [ f'(\\hat{z})+\\eta f''(\\hat{z})(z_{1}-z_{0})+\\mathcal{o}(h^{2})]\\\\ & \\cdot [ f'(\\hat{z})+\\eta f''(\\hat{z})(z_{1}-z_{0})+\\mathcal{o}(h^{2})]\\cdot [ f'(\\hat{z})+\\eta f''(\\hat{z})(z_{1}-z_{0})+\\mathcal{o}(h^{2})]\\\\ & \\cdot [ f(\\hat{z})+\\eta f'(\\hat{z})(z_{1}-z_{0})+\\mathcal{o}(h^{2})]d\\eta\\\\ = ~ & \\int_{-\\frac{1}{2}}^{\\frac{1}{2}}f'(\\hat{z})f'(\\hat{z})f'(\\hat{z})f'(\\hat{z})f(\\hat{z}+\\eta(z_{1}-z_{0}))d\\eta+\\mathcal{o}(h^{2})\\\\ = ~ & f'f'f'f'f+\\mathcal{o}(h^{2 } ) : = a(\\tree58)f+\\mathcal{o}(h^{2}),\\end{aligned}\\ ] ] where the coefficient matrix @xmath155 is defined by @xmath156 . in the same way , we can obtain @xmath157 so we have @xmath158\\\\     & + \\frac{h^{4}}{720}[6a(\\tree58)+4a(\\tree59)+a(\\tree57)+4a(\\tree56)+a(\\tree54)+a(\\tree52)+3a(\\tree53)+8a(\\tree55)]\\}f+\\mathcal{o}(h^{6})\\\\ = ~ & \\{i-\\frac{h^{2}}{12}a(\\tree32)+\\frac{h^{4}}{720}[6a(\\tree58)-a(\\tree59)+a(\\tree57)-a(\\tree56)-\\frac{3}{2}a(\\tree54)-\\frac{3}{2}a(\\tree52)\\\\\\\\     & + 3a(\\tree53)+3a(\\tree55)]\\}f+\\mathcal{o}(h^{6}).\\end{aligned}\\ ] ] we obtain the sixth order avf method @xmath159\\}\\int_{0}^{1}f(\\xi z_{1}+(1-\\xi)z_{0}))d\\xi,\\end{aligned}\\ ] ] where @xmath160 are coefficient matrices of @xmath161 .",
    "the sixth order avf method @xmath162 satisfies @xmath163    now we have @xmath164 so we can obtain @xmath165d\\xi+\\mathcal{o}(h^{7})||\\\\ = & \\mathcal{o}(h^{7}).\\end{aligned}\\ ] ] the proof is complete .",
    "if is a hamiltonian system , the sixth order avf method @xmath162 can preserve the discrete energy of it , i.e. @xmath166    can be rewritten as @xmath167 where @xmath6 denotes an arbitrary constant skew - symmetric matrix and @xmath14 denotes the hamiltonian .",
    "so the sixth order avf method can be rewritten as @xmath168 where @xmath169\\}s,\\end{aligned}\\ ] ] is a skew - symmetric matrix .",
    "it is given by @xmath170 with the symmetric matrices @xmath171 ,",
    "@xmath172 , @xmath173 and @xmath174 being given by @xmath175 and @xmath176 we can obtain @xmath177 it follows that the hamiltonian @xmath14 is conserved at every time step .",
    "[ [ remark-1 ] ] remark 1 + + + + + + + +    in the same way , we can also obtain a fifth order method @xmath178+\\frac{h^{5}}{720}[6a(\\tree58)-16a(\\tree59)+a(\\tree57)\\\\ \\nonumber\\\\     & -16a(\\tree56)-9a(\\tree54 ) -9a(\\tree52)+3a(\\tree53)-12a(\\tree55)]\\}\\int_{0}^{1}f(\\xi z_{1}+(1-\\xi)z_{0}))d\\xi,\\nonumber\\end{aligned}\\ ] ] where @xmath179 are coefficient matrices of @xmath161 .",
    "this method is of order five , but it can not preserve the hamiltonian , because @xmath180 which is the corresponding total coefficient matrix of @xmath181 turns out to be not skew - symmetric when expanding @xmath182 in a taylor series about @xmath183 .",
    "[ [ remark-2 ] ] remark 2 + + + + + + + +    omitting the items containing @xmath184 in , the method @xmath185 is the fourth order method , where @xmath186 is defined in .",
    "llllllllll & & & & & & & & & + & & & & & & & & & + @xmath29 & @xmath22 & 11 & 21 & 31 & 32 & 41 & 42 & 43 & 44 + @xmath187 & & 1 & 1 & 2 & 1 & 6 & 1 & 2 & 1 + @xmath188 & & 1 & 2 & 3 & 6 & 4 & 8 & 12 & 24 + @xmath189 & 1 & 1 & 1/2 & 1/3 & 1/4 & 1/4 & 1/6 & 1/6 & 1/8 + @xmath126 & 0 & 1 & 0 & 0 & -1/12 & 0 & 0 & 0 & 0 + @xmath190 & 1 & 1 & 0 & 0 & -1/12 & 0 & 0 & 0 & 0 + & & & & & & & & & + & & & & & & & & & + @xmath29 & 51 & 52 & 53 & 54 & 55 & 56 & 57 & 58 & 59 + @xmath187 & 24 & 2 & 2 & 6 & 1 & 1 & 2 & 1 & 2 + @xmath188 & 5 & 10 & 20 & 20 & 40 & 30 & 60 & 120 & 15 + @xmath189 & 1/5 & 1/8 & 1/12 & 1/8 & 1/12 & 1/12 & 1/12 & 1/16 & 1/9 + @xmath126 & 0 & 1/360 & 1/120 & 1/120 & 1/90 & 1/180 & 1/360 & 1/120 & 1/90 + @xmath190 & 0 & -1/480 & 1/240 & -1/480 & 1/240 & -1/720 & 1/720 & 1/120 & -1/720 +",
    "we here report a few numerical experiments , in order to illustrate our results presented in the previous section .    the relative energy error at @xmath191 is defined as @xmath192 where @xmath193 denotes the hamiltonian at @xmath191 , @xmath194 + the solution error at @xmath191",
    "is defined as @xmath195 where @xmath11 is the time step .",
    "+ we define @xmath196 and recall that for a @xmath197-order accurate scheme @xmath198      first , we consider the initial value problem @xmath199 which has the exact solution @xmath200 .",
    "we can obtain the sixth order avf method of @xmath201\\cdot\\nonumber\\\\ & [ -\\frac{10}{3}((z_{1})^{2}+z_{1}z_{0}+(z_{0})^{2})+10(z_{1}+z_{0})-10].\\end{aligned}\\ ] ] the second , fourth and sixth order avf methods and the second order trapezoidal method are applied to solve the problem in the interval @xmath202 $ ] with different time steps .",
    "table [ tab:4 ] shows the comparison of the solution errors of the four methods .",
    "we can see that the solution errors of the second order avf method and the second order trapezoidal method have little difference , and the three avf methods are of order two , four and six respectively when solving the example 1 .",
    "l l l l l @xmath203   & @xmath11   & error   & order + second order avf & 0.04 & 2.0458e-5 & - + & 0.02 & 5.0474e-6 & 2.0191 + & 0.01 & 1.2578e-6 & 2.0046 + & 0.005 & 3.1419e-7 & 2.0012 +   + fourth order avf & 0.04 & 6.6634e-7 & - + & 0.02 & 4.0323e-8 & 4.0466 + & 0.01 & 2.4990e-9 & 4.0122 + & 0.005 & 1.5586e-10 & 4.0030 +   + sixth order avf & 0.04 & 4.2320e-8 & - + & 0.02 & 6.6074e-10 & 6.0011 + & 0.01 & 1.0325e-11 & 5.9999 + & 0.005 & 1.6231e-13 & 5.9912 +   + trapezoidal & 0.04 & 3.0981e-5 & - + & 0.02 & 7.5878e-6 & 2.0296 + & 0.01 & 1.8877e-6 & 2.0071 + & 0.005 & 4.7135e-7 & 2.0018 +      second , we consider a linear hamiltonian system @xmath204 @xmath205 which has the exact solution @xmath206 we can obtain the sixth order avf method of @xmath207 we use the second , fourth and sixth order avf methods to resolve the problem in the interval @xmath208 $ ] .",
    "[ fig:1 ] shows the solution error and the relative energy error of the numerical solution of the sixth order method with time evolution in the interval @xmath208 $ ] respectively . from fig .",
    "[ fig:1]a we observe that the solution error of the sixth order avf method shows a slow linear growth . from fig .",
    "[ fig:1]b we can see that the sixth order avf method preserves the discrete hamiltonian very well .",
    "so we can conclude that the sixth order avf method has a good numerical performance for linear hamiltonian systems in long time .",
    "table [ tab:5 ] shows the numerical solutions of three avf methods with time steps @xmath209 and @xmath210 .",
    "first , we can see that higher order method has higher accuracy .",
    "second , the convergence order of the three avf methods are 2 , 4 and 6 respectively .",
    "third , the relative energy error of the three methods is up to round - off error .",
    "table [ tab:6 ] shows the convergence order of the sixth order avf methods with different time steps .",
    "we can conclude that the new method is of order six when solving the linear hamiltonian system .",
    "( a ) from @xmath211 to @xmath212 .",
    "* a * solution error .",
    "* b * relative energy error , title=\"fig:\",scaledwidth=45.0% ] ( b ) from @xmath211 to @xmath212 . * a * solution error . * b * relative energy error , title=\"fig:\",scaledwidth=45.0% ]    l l l l @xmath212 & second order method & fourth order method & sixth order method + @xmath213 & 5.8324 @xmath214 & 2.3287 @xmath215 & 9.4389 @xmath216 + @xmath217 & 1.4562 @xmath214 & 1.4554 @xmath218 & 1.4611 @xmath219 + @xmath220 & 2.0019 & 4.0000 & 6.0135 + @xmath221 & 2.5535 @xmath222 & 2.2204 @xmath222 & 3.6638 @xmath222 +    l l l l l & @xmath223 & @xmath224 & @xmath225 & @xmath226 + @xmath227 & 63.7145 & 63.9285 & 63.8679 & 74.4285 + @xmath228 & 63.7132 & 63.9320 & 63.9419 & 60.7933 + @xmath229 & 63.7142 & 63.9287 & 63.9125 & 66.0209 + @xmath230 & 63.7138 & 63.9287 & 63.9132 & 67.6980 + @xmath203 & 63.7141 & 63.9298 & 63.9419 & 63.3118 + @xmath231 & 63.7162 & 63.9280 & 63.9409 & 62.9838 +      third , we consider a nonlinear hamiltonian system @xmath232 @xmath205 which has the exact solution @xmath206 we can obtain the sixth order avf method of @xmath233 @xmath234\\}f,\\ ] ] where @xmath160 are coefficient matrices of @xmath161 , and @xmath235 @xmath236,\\\\   ( ( p_{0})^{2}+\\frac{1}{3}(p_{1}-p_{0})^{2}+p_{0}(p_{1}-p_{0}))p_{0}\\\\   + ( \\frac{1}{2}(p_{0})^{2}+\\frac{1}{4}(p_{1}-p_{0})^{2}+\\frac{2}{3}p_{0}(p_{1}-p_{0}))(p_{1}-p_{0})\\\\   + ( ( q_{0})^{2}+\\frac{1}{3}(q_{1}-q_{0})^{2}+q_{0}(q_{1}-q_{0}))p_{0}\\\\   + ( \\frac{1}{2}(q_{0})^{2}+\\frac{1}{4}(q_{1}-q_{0})^{2}+\\frac{2}{3}q_{0}(q_{1}-q_{0}))(p_{1}-p_{0 } ) .",
    "\\end{array } \\right)\\ ] ] we use the three avf methods to resolve the problem from @xmath211 to @xmath231 .",
    "[ fig:2 ] shows the solution error and the relative energy error of and the numerical solution of the sixth order method with time evolution in the interval @xmath208 $ ] respectively . from fig .",
    "[ fig:2]a we observe that the solution error of the sixth order avf method shows a slow linear growth . from fig .",
    "[ fig:2]b we can see that the sixth order avf method preserves the discrete hamiltonian very well .",
    "so we can conclude that the sixth order avf method has a good numerical performance for nonlinear hamiltonian systems in long time .",
    "table [ tab:7 ] shows the numerical solutions of three avf methods with time steps @xmath209 and @xmath210 .",
    "first , we can see that higher order method has higher accuracy .",
    "second , the convergence order of the three avf methods are 2 , 4 and 6 respectively .",
    "third , the relative energy error of the three methods is up to round - off error .",
    "table [ tab:8 ] shows the convergence order of the sixth order avf methods with different time steps .",
    "we can conclude that the new method is of order six when solving the nonlinear hamiltonian system .",
    "* a * solution error .",
    "* b * relative energy error , title=\"fig:\",scaledwidth=45.0% ] ( b ) . * a * solution error . *",
    "b * relative energy error , title=\"fig:\",scaledwidth=45.0% ]    l l l l @xmath212 & second order method & fourth order method & sixth order method + @xmath213 & 1.7558 @xmath237 & 4.5007 @xmath238 & 1.5495 @xmath239 + @xmath217 & 4.3723 @xmath214 & 2.8137 @xmath215 & 2.4127 @xmath240 + @xmath220 & 2.0057 & 3.9996 & 6.0050 + @xmath221 & 5.2180 @xmath222 & 1.9984 @xmath222 & 1.9984 @xmath222 +    l l l l l & @xmath223 & @xmath224 & @xmath225 & @xmath226 + @xmath227 & 61.6174 & 63.3983 & 63.8492 & 63.9435 + @xmath228 & 61.6178 & 63.3983 & 63.8497 & 63.9583 + @xmath229 & 61.6174 & 63.3982 & 63.8503 & 63.9302 + @xmath230 & 61.6167 & 63.3982 & 63.8504 & 63.9213 + @xmath203 & 61.6179 & 63.3982 & 63.8515 & 63.9314 + @xmath231 & 61.6461 & 63.3975 & 63.9348 & 63.4203 +      next , we consider the 2-d nonlinear huygens system @xmath241 @xmath242 we use the sixth order avf method to resolve the problem from in the interval @xmath243 $ ] .",
    "[ fig:3 ] shows the numerical solution of the sixth order method for the huygens system with @xmath244 . from fig .",
    "[ fig:3]a we can see that the sixth order avf method can solve the problem very well . from fig .",
    "[ fig:3]b we can conclude that the hamiltonian is preserved exactly .",
    "* a * numerical solution . *",
    "b * relative energy error , title=\"fig:\",scaledwidth=45.0% ] ( b ) . * a * numerical solution . *",
    "b * relative energy error , title=\"fig:\",scaledwidth=45.0% ]      finally , we consider the pendulum problem , which can be written as a hamiltonian system @xmath245 @xmath246 we use the sixth order avf method to resolve the problem in the interval @xmath243 $ ] .",
    "[ fig:4 ] shows the numerical solution of the sixth order method for the huygens system with @xmath244 . from fig .",
    "[ fig:4]a we can see that the sixth order avf method can solve the problem very well . from fig .",
    "[ fig:4]b we can conclude that the hamiltonian is preserved exactly .",
    "* a * numerical solution . *",
    "b * relative energy error , title=\"fig:\",scaledwidth=45.0% ] ( b ) .",
    "* a * numerical solution . * b * relative energy error , title=\"fig:\",scaledwidth=45.0% ]",
    "in this paper , we have proposed the concrete formulas of the substitution law for the trees of order @xmath0 .",
    "based on the new obtained substitution law , we have derived a b - series integrator extending the second order avf method to sixth order .",
    "this approach that we expand a low order b - series integrator into a sixth order integrator can also be used in other geometric b - series integrators naturally , easily and automatically .",
    "we have proved that the new method is of order six and it can preserve the energy of hamiltonian systems . in @xcite , faou et al have derived the conditions a b - series method must satisfy in order to be energy - preserving .",
    "this new method is a practical integrator of order six .",
    "we use the sixth order avf method to solve linear and nonlinear hamiltonian systems to test the accuracy and the energy - preserving ability of it .",
    "numerical results confirm the theoretical results .",
    "this work is supported by the jiangsu collaborative innovation center for climate change , the national natural science foundation of china ( grant nos .",
    "11271195 , 41231173 ) and the priority academic program development of jiangsu higher education institutions .",
    "brugnano , l. , iavernaro , f. , trigiante , d. : hamiltonian boundary value methods(energy preserving discrete line integral methods ) . j. numer",
    "math . * 5*,17 - 37 ( 2010 ) bridges , t.j .",
    ", reich , s. : numerical methods for hamiltonian pdes . j. phys .",
    "* 39 * , 5287 - 5320 ( 2006 ) butcher , j.c . :",
    "the numerical analysis of ordinary differential equations : runge - kutta and general linear methods .",
    "wiley , new york ( 1987 ) cai , j.x . , wang , y.s .",
    ": local structure - preserving algorithms for the  good \" boussinesq equation . j. comp .",
    "phys . * 239 * , 72 - 89 ( 2013 ) celledoni , e. , grimm , v. , mclachlan , r.i . , mclaren , d.i .",
    ", oneale , d. , owren , b. , quispel , g.r.w . : preserving energy resp .",
    "dissipation in numerical pdes using the  average vector field \" method .",
    "phys . * 231 * , 6770 - 6789 ( 2012 ) celledoni , e. , mclachlan , r.i . , mclaren , d.i .",
    ", owren , b. , quispel , g.r.w . , wright , w.m . : energy - preserving runge - kutta methods . math . model . numer . anal . *",
    "43 * , 645 - 649 ( 2009 ) chartier , p. , faou , e. , murua , a. : an algebraic approach to invariant preserving integators : the case of quadratic and hamiltonian invariants .",
    "numer . math . *",
    "103 * , 575 - 590 ( 2006 ) chartier , p. , hairer , e. , vilmart , g. : a substitution law for b - series vector fields .",
    "inria report , no .",
    "5498 ( 2005 ) chartier , p. , hairer , e. , vilmart , g. : numerical integration based on modified differential equation .",
    "math . comp . * 76 * , 1941 - 1953 ( 2007 ) chartier , p. , laptre , e. : reversible b - series .",
    "inria report , no .",
    "1221 ( 1988 ) chen , y. , sun , y.j . ,",
    "tang , y.f . : energy - preserving numerical methods for landau - lifshitz equation",
    ". j. phys . a : math",
    ". theor . * 44 * , 295207 ( 2011 ) feng , k. : collected works of feng kang ii . national defence industry press , beijing ( 1994 )",
    "faou , e. , hairer , e. , pham , t .- l . : energy conservation with non - symplectic methods : examples and counter - examples .",
    "bit numer .",
    "math . * 44 * , 699 - 709 ( 2004 ) feng , k. , qin , m.z . : symplectic geometric algorithms for hamiltonian systems .",
    "springer / zhejiang science and technology publishing house , berlin / hangzhou ( 2010 ) gonzalez , o. : time integration and discrete hamiltonian systems . j. nonlinear sci . * 6 * , 449 - 467 ( 1996 ) hairer , e. : energy - preserving variant of collocation methods . j. numer",
    "appl . math . * 5 * , 73 - 84 ( 2010 ) hairer , e. , lubich , c. , wanner , g. : geometric numerical integration : structure preserving algorithms for ordinary differential equations .",
    "springer , berlin ( 2002 ) hairer , e. , norsett , s.p . , wanner , g. : solving ordinary differential equations i , nonstiff problems ( 2nd edition ) .",
    "springer , berlin ( 1993 ) hairer , e. , wanner , g. : on the butcher group and general multi - value methods .",
    "computing * 13 * , 1 - 15 ( 1974 ) iavernaro , f. , trigiante , d. : high - order symmetric schemes for the energy conservation of polynomial hamiltonian problems .",
    "appl . math . * 4 * , 87 - 101 ( 2009 ) marsden , j.e . ,",
    "patrick , g.w . ,",
    "shkoller , s. : mulltisymplectic geometry , variational integrators , and nonlinear pdes .",
    "* 199 * , 351 - 395 ( 1998 ) matsuo , t. : high - order schemes for conservative or dissipative systems .",
    "j. comput .",
    "math . * 152 * , 305 - 317 ( 2003 ) mclachlan , r.i . ,",
    "quispel , g.r.w . ,",
    "robidoux , n. : geometric integration using discrete gradients .",
    "a. * 357 * , 1021 - 1045 ( 1999 ) qin , h. , zhang , s.x .",
    ", xiao , j.y . , liu , j. , sun , y.j . ,",
    "tang , w.m .",
    ": why is boris algorithm so good ? .",
    "plasmas * 20 * , 084503 ( 2013 ) quispel , g.r.w . ,",
    "mclaren , d.i .",
    ": a new class of energy - preserving numerical integration methods .",
    "j. phys . a : math .",
    "* 41 * , 045206 ( 2008 ) sanz - serna , j.m . ,",
    "calvo , m.p . : numerical hamiltonian problems . chapman and hall , london ( 1994 )",
    "sun , j.q .",
    ", qin , m.z . :",
    "multi - symplectic methods for the coupled 1d nonlinear schrdinger system . comp .",
    ". comm . * 155 * , 221 - 235 ( 2003 ) wang , y.s . ,",
    "hong , j.l .",
    ": multi - symplectic algorithms for hamiltonian partial differential equations .",
    "* 27 * , 163 - 230 ( 2013 ) webb , s.d .",
    ": symplectic integration of magnetic systems .",
    "phys . * 270 * , 570 - 576 ( 2014 )"
  ],
  "abstract_text": [
    "<S> in this paper , based on the theory of rooted trees and b - series , we propose the concrete formulas of the substitution law for the trees of order @xmath0 . with the help of the new substitution law </S>",
    "<S> , we derive a b - series integrator extending the averaged vector field ( avf ) method to high order . </S>",
    "<S> the new integrator turns out to be of order six and exactly preserves energy for hamiltonian systems . </S>",
    "<S> numerical experiments are presented to demonstrate the accuracy and the energy - preserving property of the sixth order avf method . </S>",
    "<S> +   +    * mathematics subject classfication * 65d17 @xmath1 65l05 @xmath1 65p10 </S>"
  ]
}