{
  "article_text": [
    "we consider the systematic numerical approximation of compressible flow in pipelines .",
    "such problems arise for instance in the simulation and optimization of gas networks @xcite . motivated by such applications we tacitly assume throughout the text that the flow is subsonic . for ease of presentation , we neglect for the moment the presence of friction , viscosity , and heat transfer , and",
    "therefore consider the euler equations @xmath0 more general flow models will be considered below . here",
    "@xmath1 denotes the density , @xmath2 the mass flux , @xmath3 the pressure , and @xmath4 the total energy ; further @xmath5 is the kinetic energy , and @xmath6 the internal energy .",
    "the above equations are assumed to hold on a bounded closed interval @xmath7 representing the pipeline and for all @xmath8 .",
    "we further assume for the moment that the pipe is closed , i.e. , @xmath9 it is well - known that for smooth solutions of the euler equations  , one can also deduce a conservation law for the entropy @xcite , namely @xmath10 one may replace one of the equations in  by the entropy equation and thus obtain an equivalent system for the unknown density @xmath1 , mass flux @xmath2 , and temperature @xmath11 .",
    "this viewpoint will play an important role in our considerations below .",
    "the system  is complemented by",
    "_ equations of state_. here we choose to characterize the pressure @xmath3 , the specific internal energy @xmath6 , and the specific entropy @xmath12 as functions of density @xmath1 and temperature @xmath11 , i.e. , @xmath13 in order to comply to the basic laws of thermodynamics , these functions have to satisfy certain compatibility conditions ; see @xcite and section  [ sec : prelim ] below .    under appropriate assumptions on the initial data and the constitutive relations , the local existence of smooth solutions to the system",
    " can be guaranteed @xcite . in the context of gas pipelines ,",
    "solutions are expected to remain smooth for all time , which can be explained by the stabilizing effect of friction @xcite .",
    "moreover , the flow takes place at low mach number and therefore no shocks should be generated .",
    "a triple @xmath14 \\times \\omega)^3 $ ] is called _ smooth positive solution _ of the system  above , if all equations hold in a point wise sense and @xmath15 .    due to the many important applications",
    ", a vast amount of literature has been devoted to the study of numerical methods for compressible flow problems , and the one dimensional problem discussed above is typically used as a starting point . despite that fact , the convergence analysis for the flow of inviscid fluids is not completely settled , not even in one space dimension .",
    "finite volume methods are probably most widely used for the numerical approximation of compressible flow .",
    "while a rather complete convergence theory has been established for scalar conservation laws , only partial results are available concerning the analysis of finite volume methods for the euler equations ; we refer to @xcite and the references given there .",
    "similar results hold for discontinuous galerkin methods @xcite which can be understood as high - order generalization of finite volume schemes . using the stabilizing effect of viscosity",
    ", some truly implementable numerical schemes for the isothermal compressible navier - stokes equations have been shown to be globally convergent to weak solutions @xcite .",
    "these are however formulated in lagrangian coordinates which is prohibitive for a possible extension to pipe networks . in @xcite ,",
    "a globally convergent non - conforming finite element method for the isothermal compressible navier - stokes equations in eulerian coordinates has been proposed and analyzed .",
    "this method is based on the approximation of the velocity and density field and makes use of several stabilization terms which leads to a rather strong violation of the conservation laws .",
    "moreover , the method degenerates in the inviscid limit ; see ( * ? ? ?",
    "the main goal of the current manuscript is to construct a numerical scheme that can handle general flow models for viscous and inviscid fluids .",
    "moreover , the method should have good stability properties and preserve the basic conservation laws that encode the underlying the physical principles as good as possible .",
    "for this purpose , we consider here an extension of our previous work @xcite , which dealt with the conforming galerkin approximation of isentropic flow on networks .",
    "the extension to the full set of euler equations and generalization thereof , which are the subject of this paper , will require some non - trivial extensions .",
    "in contrast to the isentropic setting considered in @xcite , we are not yet able to systematically handle pipe networks and such extension are therefore left as a topic for future research .",
    "one obstacle here is the formulation of appropriate coupling conditions at pipe junctions .",
    "in contrast to the isentropic case @xcite , this issue seems not completely settled in the general case ; we refer to @xcite for positive as well as negative examples .",
    "the remainder of the manuscript is organized as follows : in the first part of the paper , we discuss in detail the euler equations on a closed pipe .",
    "we first recall some basic relations of equilibrium thermodynamics , and then introduce a variational characterization of smooth solutions which rather directly encodes the conservation of mass , energy , and entropy . in the second part , we investigate the numerical approximation of this variational principle in space by a conforming galerkin method and then consider the subsequent discretization in time by a problem adapted implicit time stepping scheme .",
    "we prove strict conservation of mass , energy , and entropy for the semi - discretization and a slight dissipation of energy and monotonic increase in entropy for the fully discrete scheme .",
    "the proposed method therefore perfectly complies to the basic principles of thermodynamics . in the third part of the paper",
    ", we investigate the extension of our approach to more general flow models .",
    "the last part of the paper is devoted to numerical tests which illustrate the theoretical results and demonstrate the stability and conservation properties of the fully discrete schemes .",
    "our research is motivated mainly by gas transport in pipelines , which takes place at low mach number and therefore avoids the generation of shocks .",
    "we however also consider a shock tube problem to demonstrate the correct handling of shocks , rarefaction waves , and contact discontinuities that may arise in more general applications .",
    "in the following three sections , we first review some basic relations of equilibrium thermodynamics and then present and analyze a particular variational principle for the euler equations which will serve as the basis for our further considerations .",
    "let us first consider in a bit more detail the relations of pressure , internal energy , and entropy .",
    "it is well known , see e.g. @xcite , that for thermodynamical consistency , the pressure @xmath3 has to be related to the specific internal energy @xmath6 by @xmath16 subscripts denote partial derivatives and functions may in general depend on @xmath1 and @xmath11 . by integration with respect to @xmath1 , we can then express the _ internal energy _ as @xmath17 here @xmath18 denotes a _ pressure potential _",
    "defined by @xmath19 and accordingly we call @xmath20 the _ thermal potential _ which is independent of @xmath1 .",
    "the two potentials allow us to rewrite various other terms that arise in our analysis later on in a common form .",
    "the spatial derivative of the pressure , for instance , can be expressed as @xmath21 another important quantity is the _ specific enthalpy _",
    "@xmath22 , which is given by @xmath23 the temporal change of the internal energy can then be expanded as @xmath24 the last two terms of this splitting turn out to be related to the _ specific entropy _",
    "@xmath12 , which is again determined up to a constant by thermodynamic relations @xcite , namely @xmath25 a suitable entropy can then be found by integration and reads @xmath26 the time derivative of this entropy can again be expressed via the potentials as @xmath27 note that the last term already appeared in formula for the time derivative of the internal energy .",
    "the spatial derivative of the entropy can finally be expressed as @xmath28 a combination of these two formulas and the euler equations ",
    "shows , see remark  [ rem : entropy ] for details , that the evolution of the entropy is governed by @xmath29 together with this yields the conservation law for the entropy .    to completely describe the constitutive relations for the fluid under investigation , it is thus sufficient to prescribe the two potentials @xmath30 and @xmath20 .",
    "pressure @xmath3 , internal energy @xmath6 , entropy @xmath12 , and derivatives of these quantities can then be expressed in terms of these potentials .",
    "this will substantially simplify our analysis later on .    following physical intuition and to guarantee the well - posedness of the problem under investigation , we make the following structural assumptions about the potentials .",
    "let @xmath31 and @xmath32 and assume that @xmath33 , @xmath34 , and @xmath35 for all @xmath36 and with some constant @xmath37 .",
    "these assumptions will tacitly be utilized at several places in our analysis below and they are therefore assumed to hold for the rest of the manuscript . to show that they are reasonable ,",
    "let us briefly discuss a particular example that has been discussed in literature .",
    "let us define @xmath38 with @xmath39 , @xmath40 , and such that @xmath41 , @xmath42 , and @xmath43 .",
    "the constants @xmath44 do not play a significant role in the following . via and",
    ", we can then express the pressure and internal energy as @xmath45 this yields an extension of the state equations for an ideal gas that has already been considered in @xcite . from the definition of the pressure potential",
    ", we can further see that @xmath46 and @xmath47 in addition , we obtain @xmath48 hence all assumptions about the potentials made above are valid . note that this simple example already covers , as special cases , the state equations of polytropic gases @xcite and of barotropic flow @xcite .",
    "our results are therefore directly applicable in these situations .",
    "we next present an equivalent formulation for the euler equations which turns out to be particularly well suited for numerical approximation .",
    "recall the definition of the total energy density @xmath49 . with the formulas of the previous section ,",
    "we then obtain @xmath50 note that the last term could also be expressed in terms of the entropy by @xmath51 , which will in fact be utilized below . by the euler equations  and the relations between the constitutive equations and the potentials derived in the previous section , the terms in parenthesis on the right hand side of can be expressed as @xmath52 these equations provide an equivalent formulation for the problem under investigation .",
    "[ lem : equivalence ] let the state equations be defined as in section  [ sec : prelim ]",
    ". then any smooth positive solution @xmath53 of the euler equations  also solves  , and vice versa .",
    "the two systems are equivalent in this sense .",
    "the first equation is the same as .",
    "+ next consider : from equations ",
    ", we can deduce that @xmath54 the first term can be expanded as @xmath55 the second term ( ii ) can be replaced by the expression for @xmath56 derived in .",
    "adding up all three terms then directly yields the second equation . +",
    "now consider the third identity : from equation , we immediately obtain @xmath57 we can now use , , and to replace the time derivative terms , which yields @xmath58 using that @xmath59 and @xmath60 , we can expand the first term as @xmath61 a combination with the remaining terms then yields the third identity . reversing the individual steps yields the other direction and completes the proof of the lemma .",
    "[ rem : entropy ] using the formulas and for the derivatives of the entropy , the third equation could also be expressed as @xmath62 since @xmath63 for any smooth positive solution , this is equivalent to and together with equation leads to the conservation law for the entropy . the above three equations",
    " thus actually describe the conservation of mass and the evolution of kinetic energy and of entropy .",
    "the unknown fields here are the density @xmath1 , the mass flux @xmath2 , and the temperature @xmath11 .",
    "this is the basic framework for our further considerations .",
    "the equivalent formulation  allows us to establish the following variational characterization of solutions to the euler equations which will be the starting point and main ingredient for the construction and analysis of numerical approximations later on .",
    "@xmath64 [ lem : variational ] let the state equations be given as in section  [ sec : prelim ] .",
    "then any smooth positive solution @xmath53 of  also solves @xmath65 for all test functions @xmath66 , @xmath67 , @xmath68 , and all @xmath69 .",
    "vice versa , any smooth positive solution of  and also solves .    here @xmath70 denotes the standard scalar product of @xmath71 and @xmath72 is the usual sobolev space .",
    "in addition , we denote by @xmath73 the space of smooth flux functions that additionally vanish at the boundary .",
    "note that on networks @xcite or in multiple dimensions , @xmath74 .",
    "we therefore use this specific notation already here .",
    "the assertion follows directly from the equivalence of the euler equations with  , by multiplying these latter set of equations with appropriate test functions , integration over the domain , and integration - by - parts for some of the terms .",
    "note that all boundary terms vanish due to the homogeneous boundary conditions for @xmath2 and @xmath75 .",
    "this shows that any solution of the euler equations satisfies the above variational principle .",
    "the other direction follows by reversing the individual steps .    from the previous two lemmas and the physical principles underlying the euler equations",
    ", one can now immediately deduce global conservation laws for mass , energy , and entropy for all smooth positive solutions of the above variational principle .",
    "[ lem : conservation ] @xmath64 + let @xmath53 be a smooth positive solution of  and . then @xmath76    we provide a detailed proof that is only based on the particular form of the variational principle and which carries over directly to the discrete setting considered later on .",
    "conservation of mass follows by testing with @xmath77 which yields @xmath78 where we used the boundary conditions in the last step .",
    "the second identity is obtained as follows : using formula for the derivative of the total energy , we get @xmath79 testing the variational principle with @xmath80 , @xmath81 , and @xmath82 leads to @xmath83 note that all terms vanish due to the particular structure of the variational principle which is thus responsible for the conservation of energy . in order to verify the conservation of entropy",
    ", we proceed as follows : we start by observing that @xmath84 testing the first equation in the variational principle with @xmath85 leads to @xmath86 in the last step , we used integration - by - parts and the boundary conditions for @xmath2 .",
    "the expression for the derivative of the entropy and the third equation in the variational principle tested with @xmath87 then allows us to express the second term as @xmath88 a summation of the two terms now directly yields the conservation of entropy .",
    "in the following two sections , we discuss the discretization of the variational principle for the euler equations .",
    "we start by a galerkin approximation in space and then study the subsequent discretization in time by an implicit time stepping scheme .",
    "for the numerical approximation in space , we consider a conforming galerkin approximation of the variational principle  stated above . for this purpose , we choose finite dimensional subspaces @xmath89 , @xmath90 , and @xmath91 . the semi - discrete solution is then defined by the following discrete variational problem .    [ prob : semi ] @xmath64 +",
    "let @xmath92 , @xmath93 , @xmath94 be given .",
    "find @xmath95;q_h \\times v_h \\times w_h)$ ] such that @xmath96 , @xmath97 , @xmath98 , and such that @xmath99 holds for all test functions @xmath100 , @xmath101 , @xmath102 , and for all @xmath69 .",
    "here @xmath103 , @xmath104 , @xmath105 , and @xmath106 denote the respective functions evaluated at the discrete solutions .",
    "also note that the solution components @xmath107 , @xmath108 , and @xmath109 depend on @xmath110 , while the test functions @xmath111 , @xmath112 , and @xmath113 are independent of time .",
    "we next establish the local well - posedness of this problem .",
    "[ lem : wellposedh ] let @xmath114 , @xmath115 , and let @xmath116 be given as in section  [ sec : prelim ] .",
    "then problem  [ prob : semi ] admits a unique local solution @xmath117 on @xmath118 $ ] for some @xmath119 .    by definition of the discrete internal energy",
    ", we have @xmath120 differentiation with respect to time thus yields @xmath121 after choosing a basis for @xmath122 , @xmath123 , and @xmath124 , the semi - discrete problem thus leads to a system of ordinary differential equations of the form @xmath125 where @xmath126 denotes the coordinate vector for the functions @xmath107 , @xmath108 , and @xmath109 . due to our assumptions on @xmath18 and @xmath127 , the function @xmath128 and the matrix @xmath129 are continuously differentiable as long as @xmath107 and @xmath109 are strictly positive .",
    "moreover , @xmath130 has block triangular form and therefore is regular , if the diagonal blocks are regular .",
    "the diagonal blocks , on the other hand , correspond to the mass matrices for the function spaces @xmath123 , @xmath122 , and @xmath124 with weight functions @xmath131 , @xmath132 , and @xmath133 . by our assumptions on the potentials , these functions are strictly positive as long as @xmath107 and @xmath109 are strictly positive . therefore , the matrix @xmath130 is regular if @xmath107 and @xmath109 are strictly positive .",
    "local existence of a unique solution then follows from the picard - lindelf theorem .    by inspection of the proof",
    ", one can see that the solution can be extended uniquely in time as long as it remains bounded and @xmath107 and @xmath109 stay strictly positive .",
    "due to the conforming galerkin approximation and the particular form of the variational principle , conservation of mass , energy , and entropy also hold on the discrete level .    [",
    "lem : conservationh ] let @xmath117 be a solution of problem  [ prob : semi ] with @xmath134 and @xmath135 .",
    "then @xmath136 here @xmath137 and @xmath138 denote the discrete energy and entropy .",
    "the assertions can be proved with literally the same arguments as already employed in the proof of lemma  [ lem : conservation ] on the continuous level .",
    "the conservation of energy also allows to obtain appropriate bounds for the norms of @xmath107 , @xmath109 , and @xmath108 . as a consequence",
    ", one can expect global existence of the solution , as long as @xmath107 and @xmath109 remain uniformly bounded away from zero .",
    "this may be used as a first step towards a complete convergence analysis of the proposed method .",
    "as a final step of our investigations for the flow on a single pipe , we now discuss an appropriate discretization in time which preserves the underlying conservation laws as good as possible . given a time step @xmath139",
    ", we define @xmath140 for @xmath141 , and we denote by @xmath142 the backward differences which are taken as approximations for the time derivatives . as will become clear below , adaptive time steps @xmath143",
    "could be considered as well .      for the time discretization of the galerkin approximation stated in problem  [ prob : semi ]",
    ", we now consider the following implicit time stepping scheme .",
    "[ prob : full ] set @xmath144 , @xmath145 , and @xmath146 with initial values as in problem  [ prob : semi ] . for @xmath147 find @xmath148 , such that @xmath149 holds for all test functions @xmath100 , @xmath101 , and @xmath102 .    as before @xmath150 and",
    "similar expressions denote the corresponding functions evaluated at the discrete solutions @xmath151 and @xmath152 . the local well - posedness of this fully discrete scheme can be obtained with similar arguments as that of the semi - discrete problem .",
    "let @xmath153 be given with @xmath154 and @xmath155 .",
    "furthermore , let the state equations be defined as in section  [ sec : prelim ] .",
    "then for @xmath139 sufficiently small , the system in problem  [ prob : full ] has a locally unique solution @xmath156 with @xmath157 and @xmath158 .    with similar arguments as in the proof of lemma  [ lem : wellposedh ] , one can see that the problem for the @xmath159th time step can be formulated in algebraic form as @xmath160 for @xmath161 we may set @xmath162 with matrix @xmath130 as in the proof of lemma  [ lem : wellposedh ] .",
    "there it was shown that @xmath130 is regular under the assumptions of the lemma .",
    "moreover , @xmath163 and @xmath164 are continuously differentiable with respect to their arguments .",
    "existence of a locally unique solution then follows by the implicit function theorem . for sufficiently small @xmath139",
    ", we can deduce the positivity of @xmath151 and @xmath152 from their continuous dependence on the time step size .",
    "we comment in more detail on the size of the admissible time step below . before ,",
    "let us summarize the basic stability and conservation properties of the fully discrete scheme .",
    "[ lem : conservationhh ] @xmath64 + let @xmath165 denote a positive solution of problem  [ prob : full ]",
    ". then @xmath166 for all @xmath167 . as before @xmath168 and",
    "@xmath169 denote the functions evaluated at @xmath151 , @xmath170 , and @xmath152 .",
    "we call the solution of the discrete problem _ positive _ , if @xmath171 and @xmath172 for all @xmath167",
    ".    it suffices to consider the case @xmath173 ; the results for @xmath174 follow by induction .",
    "testing the first equation with @xmath175 yields the exact conservation of mass @xmath176 in the last step we used here that @xmath177 on the boundary . + next",
    "consider the energy balance : using the definition of the total energy @xmath178 , we obtain @xmath179 the first term in this expression can be further expanded as @xmath180 in the last step , we used that for any convex differentiable function @xmath181 there holds @xmath182 this was applied here to the convex functions @xmath183 and @xmath184 , respectively .",
    "substituting @xmath185 in the second term , we obtain after integration over @xmath7 that @xmath186 the time differences can be further evaluated by testing the fully discrete problem with test functions @xmath187 , @xmath188 , and @xmath189 , similar as in the proof of lemma  [ lem : conservation ] .",
    "one can then see again that the right hand side above sums up to zero .",
    "the change of the discrete entropy can finally be expressed as @xmath190 by similar arguments as in the proof of lemma  [ lem : conservation ] , the term ( i ) can be further evaluated using the first equation in the fully discrete problem with @xmath191 , leading to @xmath192 to estimate the second term , we start by deriving a discrete analogue of . using integration along a suitable path and the thermodynamic relations , we obtain @xmath193 we can now use that @xmath194 is decreasing in @xmath11 , @xmath195 is decreasing in @xmath1 , and @xmath196 is increasing in @xmath1",
    ". moreover , these functions and also @xmath197 are non - negative .",
    "hence we get @xmath198 by testing the fully discrete variational principle with @xmath199 , we thus obtain @xmath200 a combination of the two estimates for ( i ) and ( ii ) now yields the entropy inequality .",
    "the previous lemma shows that the total mass of the discrete solution is conserved exactly for all time , while the total energy may be slightly decreasing and the discrete entropy may be slightly increasing due to numerical dissipation caused by the implicit time stepping scheme .",
    "the fully discrete scheme is therefore energy and entropy stable , and in perfect agreement with the second law of thermodynamics .",
    "the energy identity can be used to obtain bounds for the discrete solution . as long as @xmath201 and @xmath202 are bounded away from zero sufficiently well",
    ", the time step in the fully discrete scheme can hence be chosen reasonable large .",
    "for appropriate initial values , we therefore expect well - posedness of the scheme for a uniform time step @xmath139 and for all @xmath141 , which is also observed in our numerical tests .",
    "let us note that , as a consequence of the numerical dissipation of the implicit time stepping scheme , the fully discrete solution will actually converge to a steady state on the long run .",
    "in the following two sections , we briefly discuss some possible extensions of our approach to more general flow models .",
    "it will turn out that such generalizations can be incorporated very naturally and analyzed without difficulties .",
    "the case of a closed pipe which was considered in the previous section was convenient for the analysis and allowed us to establish global conservation laws for mass , energy , and entropy .",
    "this situation is however of minor practical relevance .",
    "we therefore discuss now the possibility to incorporate more general boundary conditions .",
    "motivated by transport of gas in pipelines , we always assume that the flow is sub - sonic in the whole pipe .",
    "let @xmath203 , @xmath204 denote the start and end point of the pipe @xmath205 $ ] . then @xmath206 is called _ inflow _ vertex , if @xmath207 , and _ outflow _ vertex , if @xmath208 . here",
    "@xmath209 plays the role of a normal vector at the boundary of the domain and @xmath2 is the mass flux . from the general theory of hyperbolic equations one can then deduce that in the sub - sonic regime , two boundary conditions have to be defined at an inflow boundaries , while only one condition has to be prescribed at an outflow boundary .",
    "the typical situations that may occur are depicted in figure  [ fig : boundary ] .",
    "( v1a ) at ( 0,3 ) @xmath210 ; ( v2a ) at ( 5,3 ) @xmath210 ; ( v1b ) at ( 10,3 ) @xmath210 ; ( v2b ) at ( 15,3 ) @xmath131 ; ( v1c ) at ( 0,0 ) @xmath131 ; ( v2c ) at ( 5,0 ) @xmath210 ; ( v1d ) at ( 10,0 ) @xmath131 ; ( v2d ) at ( 15,0 ) @xmath131 ; ( v1a )  node[above ] in @xmath211 in + + ( v2a ) ; ( v1b )  node[above ] in @xmath211 out + + ( v2b ) ; ( v1c )  node[above ] out @xmath211 in + + ( v2c ) ; ( v1d )  node[above ] out @xmath211 out + + ( v2d ) ;    the case of a closed pipe considered in the previous sections corresponds to that with two outflow boundaries here .",
    "let us emphasize that the choice of appropriate boundary conditions that give rise to a well - posed problem is not trivial ; an excellent review about appropriate choices can be found in @xcite .    for later reference ,",
    "let us briefly discuss one particular setting which will be utilized in our numerical tests below .",
    "as before , let @xmath205 $ ] and assume that @xmath212 with @xmath213 , @xmath214 , and @xmath215 given . here",
    "@xmath203 is the inflow boundary , where two conditions have to be prescribed , and @xmath204 is the outflow boundary , where only one condition is required .",
    "the following changes are needed in the variational principle  :",
    "\\(i ) we now have @xmath216 with @xmath217 and @xmath218 given such that @xmath219 .",
    "the space for the corresponding test function @xmath75 does not have to be modified .",
    "( ii ) to incorporate the additional boundary condition for the temperature , we can split @xmath220 with @xmath221 and @xmath222 such that @xmath223 .",
    "the zero boundary condition at the inflow has also be required for the test function @xmath224 .",
    "( iii ) in the derivation of , one obtains an additional boundary term @xmath225 which comes from integration - by - parts and where we replaced @xmath226 by @xmath227 .",
    "this term does not vanish here , since neither @xmath75 nor @xmath2 vanish at the vertex @xmath204 .",
    "similar modifications are also required for the galerkin approximation and fully discrete scheme .",
    "these can however easily be implemented on the algebraic level .",
    "due to the non - homogeneous boundary conditions , conservation of mass , energy , and entropy do no longer hold here in general .",
    "the change in total mass is given by @xmath228 the total mass will thus still be conserved if the mass fluxes at the in- and outflow are of the same size . note",
    "that this identity is again satisfied exactly by the galerkin semi - discretization and also by the fully discrete scheme .",
    "we next discuss the extension of our approach to more general flow models including the effects of viscosity , friction , heat conduction , and heat transfer across the pipe walls .",
    "the corresponding generalizations of the compressible euler equations then read @xmath229 here @xmath230 denote the coefficients for viscosity , friction , heat conduction , and heat transfer , and @xmath222 is the temperature of the surrounding medium .",
    "the particular form of the viscous term has been proposed in @xcite in the context of isentropic flow . for a constant density @xmath231 and corresponding flux @xmath232",
    ", we have @xmath233 which is the usual viscosity term arising in the compressible navier - stokes equations @xcite . also note that the first two terms on the right hand side of the energy equation are sometimes neglected in the literature on gas networks ; see for instance @xcite .",
    "they are however required to obtain a consistent formulation .    for convenience of notation",
    ", we again consider a pipe which is closed at the ends , i.e. , @xmath234 the incorporation of more general boundary conditions will be discussed below . as a direct consequence of the above system of equations ,",
    "we again obtain a balance equation for the entropy , which now reads @xmath235 with similar reasoning as in section  [ sec : var ] , we deduce the following variational principle",
    ".    @xmath64 [ lem : vara ] let the state equations be given as in section  [ sec : prelim ] .",
    "then any smooth positive solution @xmath53 of problem  also solves @xmath236 for all test functions @xmath66 , @xmath67 , @xmath68 , and all @xmath69 .",
    "vice versa , any smooth positive solution of  and also solves problem .",
    "the proof follows with minor modifications of that of lemma  [ lem : variational ] and is therefore omitted . proceeding like in section  [ sec : var ]",
    ", we now obtain the following global balance laws .",
    "[ lem : conservationa ] let @xmath53 be a smooth positive solution of  and , and let the state equations be defined as in the section  [ sec : prelim ] .",
    "then @xmath237    the assertions follow with minor modifications of the proof of lemma  [ lem : conservation ] .    note that in comparison with the euler equations , the additional effects of viscosity , friction , and heat conduction lead to dissipation of energy and to increase in entropy , respectively . depending on the sign of @xmath238 , the heat transfer through the pipe walls",
    "may yield a positive or a negative contribution to the global energy and entropy .",
    "we can now further proceed in the very same manner as outlined for the euler equations in the previous sections .",
    "we skip the details but briefly comment on the main arguments .    for the semi - discretization in space , we may use a galerkin approximation as discussed in section  [ sec : galerkin ] .",
    "the global balance laws for mass , energy , and entropy stated in lemma  [ lem : conservationa ] are again inherited literally .",
    "for the discretization in time , we can also utilize the same strategy as outlined in section  [ sec : time ] ; the additional terms appearing in the right hand side of  are treated implicitly .",
    "the fully discrete solution then again satisfies global balance laws for mass , energy , and entropy similar as the ones stated in lemma  [ lem : conservationa ] , but with the equalities replaced by respective inequalities in the energy and entropy balances ; compare with lemma  [ lem : conservationhh ] .",
    "these results follow with minor modifications of the proofs of lemma  [ lem : conservationh ] and [ lem : conservationhh ] and details are therefore left to the reader .",
    "in the final part of our paper , we now illustrate the theoretical results by some numerical tests which demonstrate the stability and performance of the proposed discretization .    for all our computations ,",
    "we utilize a galerkin approximation with mixed finite elements that we briefly introduce next .",
    "let @xmath239 $ ] be the interval related to the edge @xmath6 and let @xmath240 be a uniform partition of @xmath6 into elements @xmath241 of length @xmath22 .",
    "the global mesh is defined as @xmath242 .",
    "next we define spaces of piecewise polynomials by @xmath243 here @xmath244 denotes the space of piecewise polynomials over the mesh @xmath245 , and @xmath246 is the space of polynomials of degree @xmath247 on the subinterval @xmath241 .",
    "we then seek approximations for the density @xmath1 , the mass flux @xmath2 , and the temperature @xmath11 , in the finite element spaces @xmath248 these spaces are known to have good approximation properties .",
    "the first two spaces have already been used successfully for the numerical approximation of damped wave propagation problems and the isentropic euler equations on networks in @xcite .",
    "for illustration of our theoretical considerations , we now present some numerical results for two simple test problems . in both cases , we consider the case of an ideal gas which in our language can be modeled by the potentials @xmath249 by simple computations and the formulas of section  [ sec : prelim ] , we then obtain @xmath250 here @xmath251 is the gas constant , @xmath252 is the specific heat at constant volume , and @xmath253 is the specific heat at constant pressure . for the following tests , we set @xmath254 , @xmath255 which corresponds to @xmath256 and an adiabatic coefficient of @xmath257 .      as a first test scenario , we consider the sod problem @xcite which is known to exhibit a shock wave , a rarefaction wave , and a contact discontinuity .",
    "this allows us to demonstrate the stability and performance of our discretization scheme in a rather general situation .",
    "the flow is described by the euler equations  on a pipe @xmath258 $ ] . as initial values , we choose @xmath259 which corresponds to the setting considered in ( * ? ? ?",
    "14.13 ) . in figure",
    "[ fig : sod ] , we depict the numerical solution for this test problem at time @xmath260 obtained with the mixed finite element method with discretization parameters @xmath261 .",
    "obtained with the mixed finite element method and discretization parameters @xmath261 .",
    "the plots on the left correspond to the fields that are approximated directly in the numerical method . the plots on the right correspond to derived quantities .",
    "[ fig : sod],scaledwidth=75.0% ]    in the left column , we depict the density @xmath1 , the mass flux @xmath2 , and the temperature @xmath11 , which are the fields that are solved for in our numerical scheme . in all three solution components ,",
    "one can see , from left to right , the rarefaction wave , the contact discontinuity , and the shock wave .",
    "the rarefaction wave leads to a smooth transition of the states , while the two latter features correspond to discontinuities which are slightly smeared out by the numerical scheme .",
    "the fronts however get sharper when further refining the mesh .",
    "the three pictures in the right column display the numerical approximations for the pressure @xmath3 , the velocity @xmath262 , and the specific entropy @xmath12 , which are derived via and the relation @xmath263 .",
    "as can be seen from the solution of the corresponding riemann problem , the contact discontinuity does not appear in the pressure @xmath3 and velocity @xmath262 ; see @xcite and ( * ? ? ? *",
    "sec.13 ) for details .    as another validation of our theoretical results ,",
    "let us also investigate the conservation of mass , energy , and entropy in the numerical solution .",
    "for this , we repeat the previous test for different discretization parameters @xmath22 and @xmath264 .",
    "the results are listed in table  [ tab : sod ] .",
    ".differences @xmath265 , @xmath266 , and @xmath267 in total mass , energy , and entropy of the numerical solution between time @xmath268 and @xmath269 .",
    "[ tab : sod ] [ cols=\"^,>,>,>,>,>\",options=\"header \" , ]     from the numerical results , one can deduce an exponential convergence to equilibrium .",
    "this could in principle be proven rigorously here by a linearized stability analysis ; we refer to @xcite for related results in a simplified setting .",
    "in this paper we proposed and analyzed the systematic discretization of compressible flow problems on a pipe by galerkin approximation in space and a problem adapted implicit time integration scheme .",
    "exact conservation of mass , energy , and entropy could be proven for the semi - discretization of the euler equations . for the fully discrete scheme ,",
    "exact conservation of mass is still preserved , while a slight decay in energy and a slight increase in entropy may be observed due to numerical dissipation of the implicit time stepping scheme .",
    "these properties and the stability of the scheme in the presence of shocks , rarefaction waves , and contact discontinuities was demonstrated by numerical results for a shock tube problem . for a problem involving high friction and heat exchange , which is the typical setting observed in gas transport through pipelines , we demonstrated the convergence to the correct quasi - steady state .",
    "the numerical method discussed in this paper is a generalization of the one for isentropic flow presented in @xcite . there",
    "the method could be extended to problems on pipe networks , which is of relevance in the simulation of gas networks .",
    "we were not successful yet to provide a corresponding extension to networks for problems and methods discussed in this paper .",
    "one obstacle here is the formulation of appropriate coupling conditions at pipe junctions .",
    "such extension are therefore left for future research .",
    "this work was supported by the german research foundation ( dfg ) via grants irtg  1529 and trr  154 , and by the `` excellence initiative '' of the german federal and state governments via the graduate school of computational engineering gsc  233 .",
    "j.  zhao and d.  hoff .",
    "convergence and error bound analysis of a finite - difference scheme for the one - dimensional navier - stokes equations . in",
    "_ nonlinear evolutionary partial differential equations ( beijing , 1993 ) _ , volume  3 of _ ams / ip stud . adv .",
    "_ , pages 625631 , providence , ri , 1997 . ams ."
  ],
  "abstract_text": [
    "<S> we consider the non - isothermal flow of a compressible fluid through pipes . </S>",
    "<S> starting from the full set of euler equations , we propose a variational characterization of solutions that encodes the conservation of mass , energy , and entropy in a very direct manner . </S>",
    "<S> this variational principle is suitable for a conforming galerkin approximation in space which automatically inherits the basic physical conservation laws . </S>",
    "<S> three different spaces are used for approximation of density , mass flux , and temperature , and we consider a mixed finite element method as one possible choice of suitable approximation spaces . </S>",
    "<S> we also investigate the subsequent discretization in time by a problem adapted implicit time stepping scheme for which exact conservation of mass as well as a slight dissipation of energy and increase of entropy are proven which are due to the numerical dissipation of the implicit time discretization . </S>",
    "<S> the main arguments of our analysis are rather general and allow us to extend the approach with minor modification to more general boundary conditions and flow models taking into account friction , viscosity , heat conduction , and heat exchange with the surrounding medium .    _ </S>",
    "<S> _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _   compressible flow , gas transport , variational principle , galerkin approximation , energy estimates , mixed finite elements , implicit time stepping _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _   35d30,35r02,37l65,76m10,76n99 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ </S>"
  ]
}