{
  "article_text": [
    "with the technology improvements in modern telescopes over the last decade , astronomy now has large volumes of data that will soon reach the peta - byte regime .",
    "novel data storage , automated processing and sophisticated publishing solutions are being and will have to be developed to handle the challenges of ongoing and next - generation surveys , such as the large synoptic survey telescope ( lsst ; * ? ? ? * ) .",
    "scientific progress is increasingly dependent upon our ability to analyze the immense amount of measurements to extract more information and ultimately develop an understanding of nature s fundamental properties .",
    "today many specialized instruments and facilities release invaluable data to the public on a regular basis .",
    "multicolor and time - series studies rely on all of these observations .",
    "one of the critical requirements of these analyses is automated tools that can meaningfully combine the data sets from several independent archives @xcite . in particular , catalog matching has been the focus of several studies .",
    "some of these revisit the statistical aspects of finding the right discriminators for the associations @xcite , while others focus on the computational issues @xcite to beat down the ( naively ) combinatorial nature of the problem .",
    "these efforts are fundamentally influencing the way we handle observations and pave the road for next - generation analysis tools and services , such as those of the virtual observatories .    folding in the sky coverage into catalog matching",
    "is key to efficient algorithms .",
    "previous approaches either completely neglect to use this information or include them as an afterthought . by ignoring the footprints we eliminate our ability to constrain the brightness of non - detections that might appear in other observations . without the coverage information ,",
    "we simply can not tell whether a missing match means a lower flux than the observational limit or the direction is simply outside the observed area .",
    "there are spatial query engines ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) that can quickly find sources in a given region of the sky but they typically use a different indexing scheme to speed up the searches , and therefore require extra steps to re - organize the data set for the cross - matching .",
    "our approach is different .",
    "we create a procedure that incorporates spatial constraints directly into the crossmatching .",
    "it uses the same indexing scheme , hence performs better than previous techniques and can also deliver dropouts for further constraints on the spectral energy distribution of the sources . in this paper",
    ", we introduce a solution that builds on the sky coverage information of the catalogs to exclude irrelevant parts of the data sets before the matching begins .",
    "the method is introduced in section  [ sec : method ] .",
    "section  [ sec : implement ] describes the database implementation of the method , and extended to efficiently detect dropouts , section  [ sec : perform ] discusses the performance , and section  [ sec : con ] concludes our study .",
    "the zones algorithm is an efficient approach to crossmatching @xcite .",
    "the work presented here enhances its speed and functionality by adding geometrical constraints .",
    "the original idea involves dividing the celestial sphere to ( typically narrow ) constant declination rings or bands called _ zones_. the detections are grouped into these pre - defined zones before matching . matching speedup comes from the fact that one can just consider sources in the same zone ( as oppossed to the whole sky ) and a small number of neighboring zones depending on the search radius . when the search radius is shorter than the zone - height , one only has to consider two neighboring zones .",
    "in addition sources are also sorted by the r.a . for further improvements ( e.g. , in processor cache locality ) .",
    "this simple division has a great advantage over more complicated hierarchical schemes .",
    "any given zone has only two direct neighbors unlike in the htm or the healpix .",
    "it is also much easier to implement in any programming language and fits well with database engines .    for completeness",
    ", here we revisit the logical steps of an efficient database implementation .",
    "first we pre - calculate the zone identifier , the _ zoneid _ for each detection based on its declination @xmath0 as @xmath1 where @xmath2 is the zone - height in degrees and @xmath3 represents the floor operation .",
    "next sort the catalogs by _",
    "zoneid _ and _ r.a .",
    "_ , which typically consists of creating a table index .",
    "the equatorial coordinates @xmath4 of an object are converted to a unit vector with cartesian coordinates @xmath5 following @xmath6 euclidean distance calculation with these coordinates is fast and angular separation thresholds map directly to distance limits .",
    "this algorithm provides great improvement over naive implementations but it still searches through the entire datasets even if there is no overlap .",
    "if one knew ahead of time what the overlapping parts of the sky are , the procedure could be further speed up",
    ".      survey geometry can be arbitrarily complex and their inclusion very involved .",
    "software packages , such as the spherical toolkit @xcite , exist and can used to create , intersect and otherwise manipulate them .",
    "we can use these tools to approximate any geometry by the union of zone sections , as seen in figure  [ f1 ] .",
    "the approximation will cover a somewhat larger area but will typically be adequate due to the narrow zones .",
    "the processing involves spherical geometry problems and is somewhat time consuming but has to be perform only once , if the same pre - defined zones are used for all catalogs .    the implementation is straightforward but several noteworthy complications arise .",
    "figure  [ f4 ] illustrates the possible intersections of a zone and different small circles .",
    "due to the wraparound in r.a . , a simply connected region could translate to more than one sections .",
    "furthermore it is not enough to check the vertices of the intersections as small circles could protrude into the zone beyond the vertices as seen in figure  [ f5 ] .",
    "complex geometry could produce fragmented intervals that overlap and could be simplified .",
    "figure  [ f6 ] illustrates a scenario where such rectification is highly beneficial . with these intervals in hand ,",
    "the intersection of several footprints can quickly be determined with similar accuracy using the endpoints of the intervals .",
    "the intersection area is approximated by a set of zone segments or intervals .",
    "considering that the zones algorithm uses the same properties in the matching , namely the _",
    "zoneid _ and ( r.a . ,",
    ", one can introduce the new constraints directly into the matching code .",
    "these limits of the coordinates can be efficiently superimposed in databases that optimize the execution based on the indices and table statistics .",
    "the advantage over the traditional method is the explicit limits that trim the set of eligible combinations ahead of time .",
    "another great outcome of this approach is our new ability to find dropouts .",
    "when sources do not match anything in another catalog , one usually can not tell whether there really is no counterpart for the given sensitivity of the specific instrument or the direction is simply outside the observational coverage . in our case",
    "the overlapping area is known and accurately represented , which can be used to decide . to distinguish we can use set operations readily available in database engines .",
    "today , the largest catalogs typically reside in databases .",
    "these archives facilitate fast searches and provide different interfaces to the same data , which are frequently used by thousands of researchers every day .",
    "the sdss science archive is arguably the archetypical example of such a database solution complete with a web - based user interface .",
    "in addition to form - based searches , power users can directly use the database engine by executing custom queries .",
    "our implementation of the new method was completely done in the structure query language ( sql ) and tested on the sdss database .",
    "the geometrical computations were visualized and handled by the the footprint service  @xcite and the spherical library  @xcite .",
    "the latter is a light - weight software package for high - performance calculations with arbitrary shapes on the celestial sphere and applicable on database system  @xcite . in turn , the footprint service is bases on the spherical library . with these tools , the coverage of several telescopes and surveys have been created and recorded that include for example , sdss , galex , and first .",
    "before the crossmatch begins , several tasks are to be completed that include reorganizing and indexing the data . with a fix zone schema",
    ", the data sets can be prepared independently from each other .",
    "these pre - processing steps only have to be done once .",
    "we calculate the ` zoneid ` and index the tables by that and the azimuth .",
    "another important part of the preparation is the processing of the sky coverage .",
    "the survey footprints are approximated by a union of zone intervals , whose derivation takes place in sql followed by routines that simplify the description .",
    "each zone is bounded by two concentric small circles . the spherical shape that these describe are intersected with the footprint .",
    "considering that the zones are typically very narrow , one could just look at the verticies but we handle the generic case .",
    "the issue is that small circles can bulge and protrude farther than the vertices .",
    "sometimes further simplifications are possible , as shown in figure  [ f6 ] .",
    "in sql we can combine together the intervals to avoid unnecessarily calculations .",
    "in addition , we also have to deal with wraparound issues and split ranges across the meridian .",
    "the results of the preprocessing are persisted in tables , which capture the approximate footprint and are ready to use in subsequent crossmatch queries .",
    "the schema saves the identifier and the interval for each zone : ` i d , zoneid , ramin , ramax ` .",
    "using the zones algorithm , one can reject the majority of the possible matches by considering only the relevant zones .",
    "sources in two catalogs have to be considered if they are in the same zones .",
    "in addition to that , neighboring zones also can contribute matches , and zones farther away , if the search radius is longer than the zone height .",
    "these relations can be captured in a table that links the relevant zones called the ` zonezone ` table .",
    "figure  [ codefig : zonealg ] shows the original implementation of the matching using only the direct neighbors .",
    "the variables ` @theta ` and ` @dist2 ` represent the matching threshold in degrees and in euclidean distance ( squared ) , respectively .",
    "we see that ` catalog1 ` and ` catalog2 ` are joined via the ` zonezone ` table to minimize the initial pairs .",
    "the ` alpha2 ` column in the ` zonezone ` table contains the amount of overshooting in r.a . in the given zone such",
    "that the search can be completed without truncation . as part of the join clause , extra filtering on the angles",
    "provides fast rejection of sources that are too far and the euclidean distance is only calculated in the where clause for the best candidates .",
    "the wraparound is also handled here by the last constraint in the join clause .",
    "the source just before the meridian are also added on the other with negative values as part of the pre - processing .",
    "these conditions ensure uniqueness the pairs across the meridian .",
    "we note that this query also includes a _ hint _ for the sql optimizer that is not obvious at first .",
    "in fact , the ` loop join ` formally yields a suboptimal query plan , where the one catalogs is accessed in somewhat random order . the access pattern , however , is such that jumping happens in memory due to the ordering in r.a . ,",
    "cf . cache locality .",
    "this trick was invented by jim gray ( private communication ) and have been successfully used to create the largest crossmatches ever since .    in our new technique ,",
    "the crossmatch query also includes the zone intervals , whose union represents the approximate shape of the common coverage of the observations .",
    "first this ` zoneintersect ` table is created , which involves testing the endpoints of the intervals .",
    "the process is straightforward but it is complicated by the wraparound problem .",
    "the sql commands are relatively lengthy , hence they are omitted here .",
    "the modified crossmatch query is shown in figure  [ codefig : zonematch ] .",
    "the ` zoneintersect ` provides extra constraints on sources in ` catalog1 ` .",
    "it is also possible to subset the sources in the other catalog but the execution time does not improve as there are more limiting constraints already in place .",
    "hints are also applied here to maximize the performance of the engine .",
    "these optimization tricks might prove unnecessary in future editions of sql server .",
    ".... select c1.objid as objid1 , c2.objid as objid2 , ... from catalog1 as c1      inner loop join zonezone as zz           on zz.zoneid1 = c1.zoneid       inner loop join catalog2 as c2           on zz.zoneid2 = c2.zoneid          and c2.ra between c1.ra - zz.alpha2                         and c1.ra + zz.alpha2          and c2.dec between c1.dec - @theta                          and c1.dec + @theta          and ( c1.ra > = 0 or c2.ra > = 0 ) where ( c1.cx-c2.cx ) * ( c1.cx-c2.cx )      + ( c1.cy-c2.cy ) * ( c1.cy-c2.cy )      + ( c1.cz-c2.cz ) * ( c1.cz-c2.cz ) < @dist2 ....    .... select c1.objid as objid1 , c2.objid as objid2 , ... from zoneintersect as i      inner join catalog1 as c1          on c1.zoneid = i.zoneid and              c1.ra between i.ramin and i.ramax      inner loop join zonezone as zz           on zz.zoneid1 = c1.zoneid      inner loop join catalog2 as c2           on zz.zoneid2 = c2.zoneid          and c2.ra between c1.ra - zz.alpha2                         and c1.ra + zz.alpha2          and c2.dec between c1.dec - @theta                          and c1.dec + @theta          and ( c1.ra > = 0 or c2.ra > = 0 ) where ( c1.cx-c2.cx ) * ( c1.cx-c2.cx )      + ( c1.cy-c2.cy ) * ( c1.cy-c2.cy )      + ( c1.cz-c2.cz ) * ( c1.cz-c2.cz ) < @dist2 ....      different catalogs contain different sources .",
    "the commonality of several data sets is a function of the complicated selection effects .",
    "while our primary focus in crossmatching is to find counterparts , we also would like to know about non - detections , where the source is fainter than the limiting magnitude .    when a particular source in one of the catalogs has no counter part in another , we have to decide whether the given part of the sky is part of that observational coverage .",
    "figure  [ codefig : dropout ] illustrates the sql command to achieve this and does it fast . here",
    "we look for dropouts in ` catalog1 ` .",
    "first we select objects that are inside the overlapping area , as ` objects1 ` , then we use the sql ` except ` keyword to perform the set operation : ` objects1 `  ` matchedobjects ` .",
    ".... select c.objid from zoneintersect as o       join catalog1 as c on o.zoneid = c.zoneid          and c.ra between o.ramin and o.ramax except   select objid1 from matchedobjects ....",
    "we tested the new method on the sdss and galex catalogs ( namely dr6 and gr3 ais ) .",
    "these catalogs contain 230.4 and 54.9 million detections , respectively , and their overlap on the sky is 3689 sq",
    ".  degrees .",
    "the matching radius was set to 7 arcseconds . in the rest of this article , we quote running times and performance counters that were obtained on a single dual intel xeon e5430 cpus ( running at 2.66ghz ) with 24 gb of memory .",
    "after preparation the crossmatching was performed in 6 minutes 48 seconds using the original algorithm .",
    "the new algorithm completes in 5 minutes and 25 seconds , which is a significant 20% improvement due to the small difference in the geometry .",
    "the new strategy excels even better in situations when the overlap is smaller .",
    "we divided the data sets to create different test scenarios . considering that our method relies on the celestial coordinates , we generate cases by cutting on both coordinates to see the effect on the different shapes .",
    "figure  [ f8 ] illustrates the elapsed time as a function of the overlapping area limited by r.a .  and",
    ".  ranges .",
    "the time scales linearly with the overlapping area .",
    "black dots show the results for the subsets limited by dec . ; blue crosses represent tasks with limits in r.a .",
    "these two extremes are expected the bracket any real - life situation such as the actual intersection area of the two surveys shown with a green diamond . the red line through the origin is plotted to guide the eye .",
    "cutting on r.a .",
    "provides the lower bound of the performance .",
    "this is most noticeable at 500 sq.degrees .",
    "the regions in this case are very much elongated along dec .",
    ", hence they cut across many zones , which prevents the database from making the best use of the indexed tables .",
    "after the crossmatching was completed , only a small fraction of that time is required to find the dropouts .",
    "a total of 4.2 million galex dropouts , which are inside the sdss coverage but do not have associated counterparts , were found in just 29 seconds . similarly to the previous test , we also consider the performance as a function of the overlapping area , and the results are are shown in figure  [ f9 ] .",
    "the trend is again roughly linear with faster performance at areas below 1500 degrees .",
    "we made every attempt to clear the database s internal buffers using the ` dbcc dropcleanbuffers ` built - in procedure .",
    "the sublinear performance , however , is likely to be a result of some other caching of the small amount of data involved , for example , in the hard drive .",
    "we did not try randomization to overcome this but expect the real - life performance to be somewhere on the red line .",
    "we introduced a new algorithm for catalog matching that inherently uses the sky coverage information of all observations .",
    "the key feature of our approach is that it incorporates the coverage straight into the crossmatching and performs the filtering at runtime .",
    "it automatically restricts the datasets to the intersecting area to gain performance .",
    "user - defined spatial constraints can also be input for targeted matching .",
    "the developed method builds on the zones algorithm .",
    "the footprints of the catalogs are approximated as r.a .",
    "intervals within the thin zones .",
    "the representation is not only highly accurate but also in line with the data organization required for efficient matching .",
    "our implementation is in sql , the structure query language that is understood by most astronomy archives today including the sdss , galex and hla .",
    "coding details are also provided along with measures of the performance scaling as a function of sky coverage .",
    "the method also enables us to efficiently detect missing observations that were covered but did not appear over the detection threshold .",
    "it is a fast though preliminary step to identify dropouts . these dropouts are critical to constrain the spectral energy distribution of the celestial objects . knowing that the flux is below a given limit",
    "can be very informative for a variety of studies ranging from photometric redshift estimation to galaxy evolution and cosmological analyses .",
    "this paper is funded by national natural science foundation of china ( 10820002 , 60920010 , 90912005 ) , ministry of science and technology of china ( bsdn2009 - 07 ) , beijing municipal science and technology commission ( 2007a085 ) .",
    "becla , j. , hanushevsky , a. , nikolaev , s. , et al .",
    "2006 , , 6270 , budavri , t. , dobos , l. , szalay , a.  s. , et al .",
    "2007 , astronomical data analysis software and systems xvi , 376 , 559 budavri , t. , & szalay , a.  s.  2008 , , 679 , 301 budavri , t. , szalay , a.  s. , & fekete , g.  2010 , , 122 , 1375 gray , j. , nieto - santisteban , m.  a. , & szalay , a.  s.  2006 , microsoft research techreport , msr - tr-2006 - 52 gray , j. , szalay , a. , & fekete , g.  2005 , microsoft research techreport , msr - tr-2005 - 122 fekete , g. , szalay , a.  s. , & gray , j.  2004 , astronomical data analysis software and systems ( adass ) xiii , 314 , 289 grski , k.  m. , hivon , e. , banday , a.  j. , et al .",
    "2005 , , 622 , 759 kunszt , p.  z. , szalay , a.  s. , & thakar , a.  r.  2001 , mining the sky , 631 mazzarella , j.  m. , madore , b.  f. , & helou , g.  2001 , , 4477 , 20 pineau , f .- x . ,",
    "boch , t. , & derriere , s.  2011 , astronomical data analysis software and systems xx , 442 , 85"
  ],
  "abstract_text": [
    "<S> not only source catalogs are extracted from astronomy observations . </S>",
    "<S> their sky coverage is always carefully recorded and used in statistical analyses , such as correlation and luminosity function studies . here </S>",
    "<S> we present a novel method for catalog matching , which inherently builds on the coverage information for better performance and completeness . </S>",
    "<S> a modified version of the zones algorithm is introduced for matching partially overlapping observations , where irrelevant parts of the data are excluded up front for efficiency . </S>",
    "<S> our design enables searches to focus on specific areas on the sky to further speed up the process . </S>",
    "<S> another important advantage of the new method over traditional techniques is its ability to quickly detect dropouts , i.e. , the missing components that are in the observed regions of the celestial sphere but did not reach the detection limit in some observations . </S>",
    "<S> these often provide invaluable insight into the spectral energy distribution of the matched sources but rarely available in traditional associations . </S>"
  ]
}