{
  "article_text": [
    "in the classical mass transportation problem of monge  kantorovich , we fix at first an initial probability distribution @xmath0 and a terminal distribution @xmath1 on @xmath2 .",
    "an admissible transportation plan is defined as a random vector @xmath3 ( or , equivalently , a joint distribution on @xmath4 ) such that the marginal distributions are , respectively , @xmath0 and @xmath1 . by transporting the mass from the position @xmath5 to the position @xmath6 , an admissible plan transports a mass from the distribution @xmath0 to the distribution @xmath1 .",
    "the transportation cost is a function of the initial and final positions , given by @xmath7 $ ] for some function @xmath8 .",
    "the monge  kantorovich problem consists in minimizing the cost among all admissible transportation plans . under mild conditions , a duality result is established by kantorovich , converting the problem into an optimization problem under linear constraints .",
    "we refer to villani @xcite and rachev and ruschendorf @xcite for this classical duality and the richest development on the classical mass transportation problem .    as an extension of the monge  kantorovitch problem , mikami and thieullen",
    "@xcite introduced the following stochastic mass transportation mechanism .",
    "let @xmath9 be an @xmath2-continuous semimartingale with decomposition @xmath10 where @xmath11 is a @xmath12-dimensional standard brownian motion under the filtration @xmath13 generated by @xmath9 .",
    "the optimal mass transportation problem consists in minimizing the cost of transportation defined by some cost functional @xmath14 along all transportation plans with initial distribution @xmath0 and final distribution @xmath1 : @xmath15 where the infimum is taken over all semimartingales given by ( [ eqxmt ] ) satisfying @xmath16 and @xmath17 .",
    "mikami and thieullen @xcite proved a strong duality result , thus extending the classical kantorovitch duality to this context .",
    "motivated by a problem in financial mathematics , our main objective is to extend @xcite to a larger class of transportation plans defined by continuous semimartingales with absolutely continuous characteristics : @xmath18 where the pair process @xmath19 takes values in some closed convex subset @xmath20 of @xmath21 , and the transportation cost involves the drift and diffusion coefficients as well as the trajectory of @xmath9 .    the simplest motivating problem in financial mathematics is the following .",
    "let @xmath9 be the price process of some tradable security , and consider some path - dependent derivative security @xmath22 .",
    "then , by the no - arbitrage theory , any martingale measure @xmath23 ( i.e. , probability measure under which @xmath9 is a martingale ) induces an admissible no - arbitrage price @xmath24 $ ] for the derivative security @xmath25 .",
    "suppose further that the prices of all @xmath26-maturity european call options with all possible strikes are available .",
    "this is a standard assumption made by practitioners on liquid options markets .",
    "then , the collection of admissible martingale measures is reduced to those which are consistent with this information , that is , @xmath27 $ ] is given for all @xmath28 or , equivalently , the marginal distribution of @xmath29 under @xmath23 is given by @xmath30 , where @xmath31 denotes the left - hand side derivative of the convex function @xmath32 .",
    "hence , a natural formulation of the no - arbitrage lower and upper bounds is @xmath33 $ ] and @xmath34 $ ] with optimization over the set of all probability measures @xmath23 satisfying @xmath35 and @xmath36 , for some initial value of the underlying asset price @xmath37 .",
    "we refer to galichon , henry - labordre and touzi @xcite for the connection to the so - called model - free superhedging problem . in section  [ subsecnumericalexample ]",
    "we shall provide some applications of our results in the context of variance options @xmath38 and the corresponding weighted variance options extension .",
    "this problem is also intimately connected to the so - called skorokhod embedding problem ( sep ) that we now recall ; see obloj @xcite for a review . given a one - dimensional brownian motion @xmath39 and a centered @xmath40-integrable probability distribution @xmath1 on @xmath41 , the sep consists in searching for a stopping time @xmath42 such that @xmath43 and @xmath44 is uniformly integrable .",
    "this problem is well known to have infinitely many solutions . however , some solutions have been proved to satisfy some optimality with respect to some criterion ( azma and yor @xcite , root  @xcite and rost  @xcite ) . in order to recast the sep in our context , we specify the set @xmath20 , where the characteristics take values , to @xmath45 , that is , transportation along a local martingale .",
    "indeed , given a solution @xmath46 of the sep , the process @xmath47 defines a continuous local martingale satisfying @xmath48 .",
    "conversely , every continuous local martingale can be represented as time - changed brownian motion by the dubins ",
    "schwarz theorem ( see , e.g. , theorem 4.6 , chapter 3 of karatzas and shreve @xcite ) .",
    "we note that the seminal paper by hobson @xcite is crucially based on the connection between the sep and the above problem of no - arbitrage bounds for a specific restricted class of derivatives prices ( e.g. , variance options , lookback option , etc . ) .",
    "we refer to hobson @xcite for an overview on some specific applications of the sep in the context of finance .",
    "our first main result is to establish the kantorovitch strong duality for our semimartingale optimal transportation problem .",
    "the dual value function consists in the minimization of @xmath49 over all continuous and bounded functions @xmath50 , where @xmath51 is the initial value of a standard stochastic control problem with final cost @xmath50 . in the markovian case",
    ", the function @xmath51 can be characterized as the unique viscosity solution of the corresponding dynamics programming equation with terminal condition @xmath50 .",
    "our second main contribution is to exploit the dual formulation for the purpose of numerical approximation of the optimal cost of transportation . to the best of our knowledge , the first attempt for the numerical approximation of an intimately related problem , in the context of financial mathematics ,",
    "was initiated by bonnans and tan @xcite . in this paper , we follow their approach in the context of a bounded set of admissible semimartingale characteristics .",
    "our numerical scheme combines the finite difference scheme and the gradient projection algorithm .",
    "we prove convergence of the scheme , and we derive a rate of convergence .",
    "we also implement our numerical scheme and give some numerical experiments .",
    "the paper is organized as follows .",
    "section  [ secprobmonge ] introduces the optimal mass transportation problem under controlled stochastic dynamics . in section  [ secduality ]",
    "we extend the kantorovitch duality to our context by using the classical convex duality approach .",
    "the convex conjugate of the primal problem turns out to be the value function of a classical stochastic control problem with final condition given by the lagrange multiplier lying in the space of bounded continuous functions .",
    "then the dual formulation consists in maximizing this value over the class of all lagrange multipliers .",
    "we also show , under some conditions , that the lagrange multipliers can be restricted to the subclass of @xmath52-functions with bounded derivatives of any order . in the markovian case",
    ", we characterize the convex dual as the viscosity solution of a dynamic programming equation in the markovian case in section  [ secpdedynprog ] .",
    "further , when the characteristics are restricted to a bounded set , we use the probabilistic arguments to restrict the computation of the optimal control problem to a bounded domain of @xmath2 .",
    "section  [ secnumericalapprox ] introduces a numerical scheme to approximate the dual formulation in the markovian case .",
    "we first use the finite difference scheme to solve the control problem .",
    "the maximization is then approximated by means of the gradient projection algorithm .",
    "we provide some general convergence results together with some control of the error .",
    "finally , we implement our algorithm and provide some numerical examples in the context of its applications in financial mathematics .",
    "namely , we consider the problem of robust hedging weighted variance swap derivatives given the prices of european options of all strikes .",
    "the solution of the last problem can be computed explicitly and allows to test the accuracy of our algorithm .    given a polish space @xmath53 , we denote by @xmath54 the space of all borel probability measures on @xmath53 , equipped with the weak topology , which is also a polish space .",
    "in particular , @xmath55 is the space of all probability measures on @xmath56 .",
    "@xmath57 denotes the set of @xmath58 positive symmetric matrices .",
    "given @xmath59 , we define @xmath60 by its @xmath61-norm as an element in @xmath62 .",
    "finally , for every constant @xmath63 , we make the convention @xmath64 .",
    "let @xmath65 , \\r^d)$ ] be the canonical space , @xmath9 be the canonical process @xmath66,\\ ] ] and @xmath67 be the canonical filtration generated by @xmath9 .",
    "we recall that @xmath68 coincides with the borel @xmath69-field on @xmath70 induced by the seminorm @xmath71 , @xmath72 ( see , e.g. , the discussions in section 1.3 , chapter 1 of stroock and varadhan @xcite ) .",
    "let @xmath23 be a probability measure on @xmath73 under which the canonical process  @xmath9 is a @xmath74-continuous semimartingale .",
    "then , we have the unique continuous decomposition w.r.t .",
    "@xmath74 : @xmath75 , \\p\\mbox{-a.s.},\\ ] ] where @xmath76 is the finite variation part and @xmath77 is the local martingale part satisfying @xmath78 .",
    "denote by @xmath79 the quadratic variation of @xmath80 between @xmath81 and @xmath82 and @xmath83 .",
    "then , following jacod and shiryaev @xcite , we say that the @xmath23-continuous semimartingale @xmath9 has characteristics @xmath84 .    in this paper",
    ", we further restrict to the case where the processes @xmath85 and @xmath86 are absolutely continuous in @xmath82 w.r.t . the lebesgue measure , @xmath23-a.s .",
    "then there are @xmath74-progressive processes @xmath87 ( see , e.g. , proposition i.3.13 of @xcite ) such that @xmath88.\\end{aligned}\\ ] ]    [ remsemimart2ito ] by doob s martingale representation theorem ( see , e.g. , theorem 4.2 in chapter 3 of karatzas and shreve @xcite ) , we can find a brownian motion  @xmath89 ( possibly in an enlarged space ) such that @xmath9 has an it representation : @xmath90 where @xmath91 [ i.e. , @xmath92",
    ".    [ remuniquenu ] with the unique processes @xmath93 , the progressively measurable processes @xmath94 may not be unique .",
    "however , they are unique in sense @xmath95-a.e .",
    "since the transportation cost defined below is a @xmath95 integral , then the choice of @xmath94 will not change the cost value and then is not essential .",
    "we next introduce the set @xmath20 defining some restrictions on the admissible characteristics : @xmath96 and we denote by @xmath97 the set of probability measures @xmath23 on @xmath98 under which @xmath9 has the decomposition ( [ eqxdecomposition ] ) and satisfies ( [ eqrepresentationab ] ) with characteristics @xmath99 , @xmath100-a.e",
    ".    given two arbitrary probability measures @xmath0 and @xmath1 in @xmath101 , we also denote @xmath102    \\(i ) in general , @xmath103 may be empty .",
    "however , in the one - dimensional case @xmath104 and @xmath105 , the initial distribution @xmath106 for some constant @xmath107 , and the final distribution satisfies @xmath108 , we now verify that @xmath103 is not empty .",
    "first , we can choose any constant in @xmath41 for the drift part , hence , we can suppose , without loss of generality , that @xmath109 and @xmath1 is centered distributed , that is , @xmath110 . then , given a brownian motion @xmath39 , by skorokhod embedding ( see , e.g. , section 3 of obloj @xcite ) , there is a stopping time @xmath42 such that @xmath111 and @xmath112 is uniformly integrable .",
    "therefore , @xmath113 defined by @xmath114 is a continuous martingale with marginal distribution @xmath115 .",
    "moreover , its quadratic variation @xmath116 is absolutely continuous in @xmath82 w.r.t .",
    "lebesgue for every fixed @xmath117 , which can induce a probability on @xmath98 belonging to @xmath103 .",
    "let @xmath104 , @xmath118 , @xmath119 for some constant @xmath120 , and @xmath1 as in  ( i ) with @xmath121 .",
    "then , by the above discussion , we also have @xmath122 .    the semimartingale @xmath9 under @xmath23 can be viewed as a vehicle of mass transportation , from the @xmath23-distribution of @xmath123 to the @xmath124-distribution of @xmath29 .",
    "we then associate  @xmath23 with a transportation cost @xmath125 where @xmath126 denotes the expectation under the probability measure @xmath23 , and @xmath127\\times\\o,\\times u\\longrightarrow\\r$ ] .",
    "the above expectation is well defined on @xmath128 in view of the subsequent assumption  [ assumlconvex ] which states , in particular , that @xmath129 is nonnegative .",
    "our main interest is on the following optimal mass transportation problem , given two probability measures @xmath0 , @xmath130 : @xmath131 with the convention @xmath132 .",
    "the main objective of this section is to prove a duality result for problem ( [ eqvprimal ] ) which extends the classical kantorovitch duality in optimal transportation theory .",
    "this will be achieved by classical convex duality techniques which require to verify that the function @xmath133 is convex and lower semicontinuous . for the general theory on duality analysis in banach spaces ,",
    "we refer to bonnans and shapiro @xcite and ekeland and temam @xcite . in our context",
    ", the value function of the optimal transportation problem is defined on the polish space of measures on @xmath2 , and our main reference is deuschel and stroock @xcite .",
    "we first formulate the assumptions needed for our duality result .",
    "[ assumlconvex ] the function @xmath134 \\x\\o\\x u \\mapsto l(t , \\xb , u ) \\in\\r^+$ ] is nonnegative , continuous in @xmath135 , and convex in @xmath136 .",
    "notice that we do not impose any progressive measurability for the dependence of @xmath129 on the trajectory @xmath137 .",
    "however , by immediate conditioning , we may reduce the problem so that such a progressive measurability is satisfied .",
    "the next condition controls the dependence of the cost functional on the time variable .",
    "[ assumlunifcontinuity ] the function @xmath129 is uniformly continuous in @xmath82 in the sense that @xmath138 where the supremum is taken over all @xmath139 such that @xmath140 and all @xmath141 , @xmath142 .",
    "we finally need the following coercivity condition on the cost functional .",
    "[ assumlcroissantp ] there are constants @xmath143 and @xmath144 such that @xmath145 \\x\\o\\x u.\\end{aligned}\\ ] ]    in the particular case @xmath146 , the last condition coincides with assumption a.1 of mikami and thieullen @xcite . moreover , whenever @xmath20 is bounded , assumption [ assumlcroissantp ] is a direct consequence of assumption [ assumlconvex ] .",
    "let @xmath147 denote the set of all bounded continuous functions on @xmath2 and @xmath148 we define the dual formulation of ( [ eqvprimal ] ) by @xmath149 where @xmath150,\\end{aligned}\\ ] ] with @xmath151 defined in ( [ pmu0 ] ) .",
    "we notice that @xmath152 is well defined since @xmath51 takes value in @xmath153 , is bounded from below and is measurable by the following lemma .",
    "[ lemmdynamprogmu0 ] let assumptions  [ assumlconvex ] and  [ assumlunifcontinuity ] hold true . then , @xmath51 is measurable w.r.t .",
    "the borel @xmath154-field on @xmath2 completed by @xmath0 , and @xmath155.\\ ] ]    the proof of lemma  [ lemmdynamprogmu0 ] is based on a measurable selection argument and is reported at the end of section  [ sect - proofdpp ] .",
    "we now state the main duality result .",
    "[ theodual ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] and [ assumlcroissantp ] hold",
    ". then @xmath156 and the infimum is achieved by some @xmath157 for the problem @xmath158 of  ( [ eqvprimal ] ) .",
    "the proof of this result is reported in the subsequent subsections .",
    "we finally state a duality result in the space @xmath159 of all functions with bounded derivatives of any order : @xmath160    [ assumlunifcontinuityinx ] the function @xmath129 is uniformly continuous in @xmath137 in the sense that @xmath161 where the supremum is taken over all @xmath162 , @xmath142 and all @xmath163 such that @xmath164 .",
    "[ theoweakdual ] under the conditions of theorem  [ theodual ] together with assumption  [ assumlunifcontinuityinx ] , we have @xmath165 on @xmath166 .",
    "the proof of the last result follows exactly the same arguments as those of mikami and thieullen @xcite in the proof of their theorem 2.1 .",
    "we report it in section  [ sect - theoweakdual ] for completeness .      in preparation of the proof of theorem  [ theodual ]",
    ", we introduce the enlarged canonical space @xmath167 , \\r^d\\times \\r^{d^2}\\times\\r^{d } \\bigr),\\ ] ] following the technique used by haussmann @xcite in the proof of his proposition  3.1 .    on @xmath168 , we denote the canonical filtration by @xmath169 and the canonical process by @xmath170 , where @xmath9 , @xmath171 are @xmath12-dimensional processes and @xmath172 is a @xmath173-dimensional process .",
    "we consider a probability measure @xmath174 on @xmath168 such that @xmath9 is an @xmath175-semimartingale characterized by @xmath176 and , moreover , @xmath176 is @xmath174-a.s .",
    "absolutely continuous w.r.t .",
    "@xmath82 and @xmath177 , @xmath178-a.e . ,",
    "where @xmath179 is defined by @xmath180 we also denote by @xmath181 the set of all probability measures @xmath174 on @xmath182 satisfying the above conditions , and @xmath183 finally , we denote @xmath184    [ lemjbarlsc ] the function @xmath185 is lower semicontinuous on @xmath181 .",
    "we follow the lines in mikami @xcite . by exactly the same arguments for proving inequality ( 3.17 ) in @xcite , under assumptions  [ assumlconvex ] and [ assumlunifcontinuity ]",
    ", we get @xmath186 \\\\[-8pt ] \\nonumber & & \\qquad \\ge \\frac{1}{1 + \\delta_t l(\\eps ) } \\int_0^{1-\\eps } l \\biggl(s , \\xb,\\frac{1}{\\eps}\\int_s^{s+\\eps } \\eta_t \\,dt \\biggr)\\,ds - \\delta_t l ( \\eps)\\end{aligned}\\ ] ] for every @xmath187 , @xmath141 and @xmath62-valued process @xmath188 .",
    "suppose now @xmath189 is a sequence of probability measures in @xmath181 which converges weakly to some @xmath190 .",
    "replacing @xmath191 in ( [ eqinqllowersc ] ) by @xmath192 , taking expectation under @xmath193 , by the definition of @xmath194 in ( [ eqdnu ] ) as well as the absolute continuity of @xmath176 in @xmath82 , it follows that @xmath195\\\\ & & { } - \\delta_t l(\\eps).\\end{aligned}\\ ] ] next , by fatou s lemma , we find that @xmath196 is lower - semicontinuous .",
    "it follows by @xmath197 that @xmath198 - \\delta_t l(\\eps).\\end{aligned}\\ ] ] note that by the absolute continuity assumption of @xmath176 in @xmath82 under @xmath199 , @xmath200 and @xmath201 as @xmath202 from assumption [ assumlunifcontinuity ] ; we then finish the proof by sending @xmath203 to zero and using fatou s lemma .    in the markovian case @xmath204 ,",
    "for some deterministic function @xmath14 , we observe that assumption [ assumlunifcontinuity ] is stronger than assumption a2 in mikami @xcite .",
    "however , we can easily adapt this proof by introducing the trajectory set @xmath205 as in the proof of inequality ( 3.17 ) in @xcite .",
    "our next objective is to establish a one - to - one connection between the cost functional @xmath206 defined on the set @xmath103 of probability measures on @xmath98 and the cost functional @xmath185 defined on the corresponding set @xmath207 on the enlarged space @xmath168 .",
    "[ propjjbar ] for any probability measure @xmath208 , there exists a probability @xmath209 such that @xmath210 .",
    "conversely , let @xmath211 be such that @xmath212 . then",
    ", under assumption [ assumlconvex ] , there exists a probability measure @xmath157 such that @xmath213    \\(i ) given @xmath208 , define the processes @xmath214 , @xmath215 from decomposition ( [ eqxdecomposition ] ) and observe that the mapping @xmath216 is measurable for every @xmath217 $ ] .",
    "then the mapping @xmath218 is also measurable ; see , for example , discussions in chapter  2 of billingsley @xcite at page 57 .",
    "let @xmath174 be the probability measure on @xmath219 induced by @xmath220 . in the enlarged space @xmath221 ,",
    "the canonical process @xmath9 is clearly a continuous semimartingale characterized by @xmath222 .",
    "moreover , @xmath223 , @xmath174-a.s . , where @xmath170 are canonical processes in  @xmath168 .",
    "it follows that , on the enlarged space @xmath224 , @xmath9 is a continuous semimartingale characterized by @xmath176 . also , @xmath176 is clearly @xmath174-a.s . absolutely continuous in @xmath82 , with @xmath225 , @xmath226-a.e .",
    ", where @xmath227 is defined in ( [ eqdnu ] ) . then @xmath174 is the required probability in @xmath207 and satisfies @xmath228 .",
    "\\(ii ) let us first consider the enlarged space @xmath168 , and denote by @xmath229 the filtration generated by process @xmath9 .",
    "then for every @xmath209 , @xmath230 is still a continuous semimartingale , by the stability property of semimartingales .",
    "it follows from theorem  [ theoito2diffusion ] in the that the decomposition of @xmath9 under filtration @xmath231 can be written as @xmath232 with @xmath233 , @xmath234 $ ] and @xmath235 , @xmath226-a.e .",
    "moreover , by the convexity property ( [ eqconvexitysetsigma ] ) of the set @xmath20 , it follows that @xmath236 , @xmath226-a.e . finally , since @xmath237 , \\r^{d^2 } \\x\\r^{d } ) \\}$ ] , @xmath174 then induces a probability measure @xmath23 on @xmath238 by @xmath239:= \\pb \\bigl[e \\x c\\bigl([0,1 ] , \\r^{d^2 } \\x\\r^d\\bigr ) \\bigr ] \\qquad \\forall e \\in\\fc_1.\\ ] ] clearly , @xmath208 and @xmath240 by the convexity of @xmath129 in @xmath241 of assumption  [ assumlconvex ] and jensen s inequality .",
    "[ remebetafini ] let @xmath242 be such that @xmath243 , then from the coercivity property of @xmath129 in @xmath136 in assumption [ assumlcroissantp ] , it follows immediately that @xmath244      by the correspondence between @xmath206 and @xmath185 ( proposition [ propjjbar ] ) and the lower semicontinuity of @xmath185 ( lemma [ lemjbarlsc ] ) , we now obtain the corresponding property for @xmath133 under the crucial assumption  [ assumlcroissantp ] , which guarantees the tightness of any minimizing sequence of our problem @xmath245 .",
    "[ lemvlsc ] under assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] and  [ assumlcroissantp ] , the map @xmath246 is lower semicontinuous .",
    "we follow the arguments in lemma 3.1 of mikami and thieullen  @xcite .",
    "let @xmath247 and @xmath248 be two sequences in @xmath249 converging weakly to @xmath250 , respectively , and let us prove that @xmath251 we focus on the case @xmath252 , as the result is trivial in the alternative case .",
    "then , after possibly extracting a subsequence , we can assume that @xmath253 is bounded , and there is a sequence @xmath254 such that @xmath255 for all @xmath256 and @xmath257 by assumption  [ assumlcroissantp ] it follows that @xmath258 .",
    "then , it follows from theorem 3 of zheng @xcite that the sequence @xmath259 , of probability measures induced by @xmath260 on @xmath219 , is tight . moreover , under any one of their limit laws @xmath174 , the canonical process @xmath9 is a semimartingale characterized by @xmath176 such that @xmath176 are still absolutely continuous in  @xmath82 .",
    "moreover , @xmath261-a.e . since @xmath262-a.s .",
    "for every @xmath263 $ ] , hence , @xmath209 .",
    "we then deduce from ( [ vjpn ] ) , proposition  [ propjjbar ] and lemma  [ lemjbarlsc ] that @xmath264 by remark  [ remebetafini ] and proposition  [ propjjbar ] , we may find @xmath208 such that @xmath265 .",
    "hence , @xmath266 , completing the proof .",
    "[ propexisminimizer ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] and [ assumlcroissantp ] hold true . then for every @xmath0 , @xmath267 such that @xmath268 , existence holds for the minimization problem @xmath245 .",
    "moreover , the set of minimizers @xmath269 is a compact set of probability measures on @xmath98 .",
    "we just let @xmath270 in the proof of lemma  [ lemvlsc ] , then the required existence result is proved by following the same arguments .",
    "[ lemmconvex ] let assumptions  [ assumlconvex ] and  [ assumlcroissantp ] hold , then the map @xmath271 is convex .",
    "given @xmath272 , @xmath273 , @xmath274 , @xmath275 and @xmath276 , @xmath277 with @xmath278 , we shall prove that @xmath279 it is enough to show that for both @xmath280 such that @xmath281 , @xmath282 , we can find @xmath283 satisfying @xmath284 as in lemma  [ lemvlsc ] , let us consider the enlarged space @xmath168 , on which the probability measures @xmath285 are induced by @xmath286 , @xmath287 . by proposition  [ propjjbar ] ,",
    "@xmath288 are probability measures under which @xmath9 is a @xmath175-semimartingale characterized by the same process @xmath176 , which is absolutely continuous in @xmath82 , such that @xmath289    by corollary iii.2.8 of jacod and shiryaev @xcite , @xmath290 is also a probability measure under which @xmath9 is an @xmath175-semimartingale characterized by @xmath176 . clearly , @xmath261-a.e . since it is true @xmath291-a.e . for @xmath282",
    "thus , @xmath292 and it satisfies that @xmath293    finally , by remark  [ remebetafini ] and proposition [ propjjbar ] , we can construct @xmath208 such that @xmath240 , and it follows that inequality ( [ eqconvexityj ] ) holds true .",
    "we follow the first part of the proof of theorem 2.1 in mikami and thieullen @xcite . if @xmath245 is infinite for every @xmath294 , then @xmath295 for all @xmath296 .",
    "it follows from ( [ eqvdual ] ) and lemma  [ lemmdynamprogmu0 ] that @xmath297    now , suppose that @xmath298 is not always infinite .",
    "let @xmath299 be the space of all finite signed measures on @xmath300 , equipped with weak topology , that is , the coarsest topology making @xmath301 continuous for every @xmath302 .",
    "as indicated in section 3.2 of @xcite , the topology inherited by @xmath249 as a subset of @xmath299 is its weak topology .",
    "we then extend @xmath298 to @xmath303 by setting @xmath304 when @xmath305 , thus , @xmath306 is a convex and lower semicontinuous function defined on @xmath299 .",
    "then , the duality result @xmath307 follows from theorem 2.2.15 and lemma 3.2.3 in @xcite , together with the fact that for @xmath308 , @xmath309 \\\\ & & \\qquad= - \\inf_{\\p\\in\\pc(\\mu_0 ) } \\e^{\\p } \\biggl [ \\int_0 ^ 1 l\\bigl(s , x , \\nu^{\\p}_s\\bigr)\\,ds + \\lambda_1(x_1 ) \\biggr ] \\\\ & & \\qquad= - \\mu_0 ( \\lambda_0),\\end{aligned}\\ ] ] where the last equality follows by lemma  [ lemmdynamprogmu0 ] .",
    "the proof is almost the same as that of theorem  2.1 of mikami and thieullen @xcite ; we report it here for completeness .",
    "let @xmath310^d , \\r^+)$ ] be such that @xmath311 , and define @xmath312 .",
    "we claim that @xmath313 since the inequality @xmath314 is obvious , the required result is then obtained by sending @xmath202 and using assumption [ assumlunifcontinuityinx ] together with lemma  [ lemvlsc ] .",
    "hence , we only need to prove the claim ( [ eqdualapprox ] ) .",
    "let us denote @xmath315 in the rest of this proof .",
    "we first observe from assumption  [ assumlunifcontinuityinx ] that @xmath316 where @xmath317 .",
    "for an arbitrary @xmath308 , we denote @xmath318 .",
    "let @xmath319 and @xmath320 be a r.v .",
    "independent of @xmath9 with distribution defined by the density function @xmath321 under @xmath23 .",
    "then the probability @xmath322 on @xmath168 induced by @xmath323 is in @xmath324 , and @xmath325 \\\\ & & \\qquad\\ge - \\delta + \\frac{1}{1+\\delta } \\e^{\\p } \\biggl [ \\int _ 0 ^ 1 l\\bigl(s , x+z , \\nu^{\\p}_s \\bigr)\\,ds + \\lambda_1(x_1+z ) \\biggr ] \\\\ & & \\qquad= - \\delta + \\frac{1}{1+\\delta } \\e^{\\pb_\\eps } \\biggl [ \\int _ 0 ^ 1 l(s , x , \\nu_s)\\,ds + \\lambda_1(x_1 ) \\biggr ] \\\\ & & \\qquad \\ge - \\delta + \\frac{1}{1+\\delta } \\inf_{\\tilde{\\p } \\in\\pc(\\psi_{\\eps } \\ast\\mu_0 ) } \\e^{\\tilde{\\p } } \\biggl [ \\int_0 ^ 1 l\\bigl(s , x , \\nu^{\\tilde{\\p}}_s\\bigr)\\,ds + \\lambda_1(x_1 ) \\biggr],\\end{aligned}\\ ] ] where the last inequality follows from proposition  [ propjjbar ] .",
    "notice that @xmath326 by fubini s theorem .",
    "then , by the arbitrariness of @xmath308 and @xmath319 , the last inequality implies  ( [ eqdualapprox ] ) .",
    "in the rest of the paper we assume that @xmath327 where the deterministic function @xmath328 \\x\\r^d \\x u \\mapsto\\ell(t , x , u ) \\in\\r^+$ ] is nonnegative and convex in @xmath136 .",
    "then , the function @xmath51 in ( [ eqlambda0l ] ) is reduced to the value function of a standard markovian stochastic control problem : @xmath329.\\ ] ] our main objective is to characterize @xmath51 by means of the corresponding dynamic programming equations .",
    "then in the case of bounded characteristics , we show more regularity as well as approximation properties of @xmath51 , which serves as a preparation for the numerical approximation in section  [ secnumericalapprox ] .",
    "let us consider the probability measures @xmath23 on the canonical space @xmath238 , under which the canonical process @xmath9 is a semimartingale on @xmath330 $ ] , characterized by @xmath331 for some progressively measurable process @xmath332 . as discussed in remark  [ remuniquenu ]",
    ", @xmath332 is unique on @xmath333 $ ] in the sense of @xmath95-a.e . following the definition of @xmath97 just below  ( [ eqconvexitysetsigma ] )",
    ", we denote by @xmath334 the collection of all such probability measures @xmath23 such that @xmath335 , @xmath336-a.e . on @xmath333",
    "let @xmath337 = 1 \\bigr\\}.\\ ] ] we notice that under probability @xmath338 , @xmath9 is a semimartingale with @xmath339 , @xmath100-a.e .",
    "on @xmath340 $ ] .",
    "the dynamic value function is defined for any @xmath341 by @xmath342.\\ ] ] as in the previous sections , we also introduce the corresponding probability measures on the enlarged space @xmath219 . for all @xmath343 $ ] , we denote by @xmath344 the collection of all probability measures @xmath174 on @xmath219 under which @xmath9 is a semimartingale characterized by @xmath176 in @xmath168 and @xmath345 , @xmath346-a.e . on @xmath333",
    "$ ] , where @xmath227 is defined above ( [ eqdnu ] ) . for every @xmath347 \\x\\r^d \\x\\r^{d^2 } \\x\\r^d$ ] , let @xmath348=1 \\bigr\\}.\\end{aligned}\\ ] ] by similar arguments as in proposition  [ propjjbar ] , we have under assumption  [ assumlconvex ] that @xmath349\\ ] ] for all @xmath350 .",
    "we would like to characterize the dynamic value function @xmath351 as the viscosity solution of a dynamic programming equation .",
    "the first step is as usual to establish the dynamic programming principle ( dpp ) .",
    "we observe that a weak dynamic programming principle as introduced in bouchard and touzi  @xcite suffices to prove that @xmath352 is a viscosity solution of the corresponding dynamic programming equation .",
    "the main argument in @xcite to establish the weak dpp is the conditioning and pasting techniques of the control process , which is convenient to use for control problems in a strong formulation , that is , when the measure space @xmath353 as well as the probability measure @xmath23 are fixed a priori .",
    "however , we can not use their techniques since our problem is in weak formulation , where the controlled process is fixed as a canonical process and the controls are given as probability measures on the canonical space.=-1    we will prove the standard dynamic programming principle . for a simpler problem ( bounded convex controls set @xmath20 and bounded cost functions , etc . ) , a dpp is shown ( implicitly ) in haussmann @xcite .",
    "el karoui , nguyen and jeanblanc @xcite considered a relaxed optimal control problem and provided a scheme of proof without all details .",
    "our approach is to adapt the idea of  @xcite in our context and to provide all details for their scheme of proof .",
    "[ propdpp ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] , [ assumlcroissantp ] hold true . then , for all @xmath175-stopping time @xmath42 with values in @xmath330 $ ] , and all @xmath354 , @xmath355.\\ ] ]    the proof is reported in section  [ sect - proofdpp ] .",
    "the dynamic programming equation is the infinitesimal version of the above dynamic programming principle .",
    "let @xmath356\\ ] ] for all @xmath357    [ theouviscositysol ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] , [ assumlcroissantp ] hold true , and assume further that @xmath351 is locally bounded and @xmath358 is continuous .",
    "then , @xmath351 is a viscosity solution of the dynamic programming equation @xmath359 with terminal condition @xmath360 .",
    "the proof is very similar to that of corollary 5.1 in @xcite ; we report it in the for completeness .",
    "we first observe that @xmath358 is concave in @xmath361 as infimum of a family of affine functions .",
    "moreover , under assumption [ assumlcroissantp ] , @xmath14 is positive and @xmath362 has growth larger than @xmath363 for @xmath143 ; it follows that @xmath358 is finite valued and hence continuous in @xmath364 for every fixed @xmath365 \\x\\r^d$ ] .",
    "if we assume further that @xmath366 is uniformly continuous uniformly in @xmath136 , then clearly @xmath358 is continuous in @xmath367 .",
    "the following are two sets of sufficient conditions to ensure the local boundedness of @xmath351 in ( [ eqlambdal ] ) .",
    "suppose @xmath368 , and let @xmath369 be such that @xmath370 , @xmath100-a.e .",
    "then , @xmath371 and , hence , @xmath351 is locally bounded .",
    "suppose that there are constants @xmath372 and @xmath373 such that @xmath374 , for all @xmath365 \\x \\r^d$ ] . by considering @xmath369 induced by the process @xmath375 with @xmath376",
    ", it follows that @xmath377 < \\infty$ ] .",
    "we first prove that the dynamic value function @xmath351 is measurable and we can choose `` in a measurable way '' a family of probabilities @xmath378 \\x\\r^{2d+d^2}}$ ] which achieves ( or achieves with @xmath203 error ) the infimum in ( [ eqlambdalrelax ] ) .",
    "the main argument is theorem [ theomeasurabilitysup ] cited in the ix which follows directly from the measurable selection theorem .",
    "let @xmath379 be the upper semicontinuous envelope of the function @xmath351 , and @xmath380 \\le\\lambda^*(t , x ) \\biggr\\ } , \\\\",
    "\\tilde{\\pc } & : = & \\bigl\\ { ( t , x , a , b , \\pb ) \\dvtx\\pb\\in\\tilde{\\pc}_{t , x , a , b } \\bigr\\}.\\end{aligned}\\ ] ] in the following statement , for the borel @xmath69-field @xmath381\\x \\r^{2d+d^2})$ ] of @xmath382 \\x\\r^{2d+d^2}$ ] with an arbitrary probability measure @xmath383 on it , we denote by @xmath384\\x\\r^{2d+d^2})$ ] its @xmath69-field completed by @xmath383 .",
    "[ lemmmeasurableselection ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] , [ assumlcroissantp ] hold true , and assume that @xmath351 is locally bounded . then , for any probability measure @xmath383 on @xmath385 \\x\\r^{2d+d^2},\\break \\bc([0,1]\\x\\r^{2d+d^2 } ) ) $ ] ,    the function @xmath386 is @xmath387\\x\\r^{2d+d^2})$]-measurable ,    for any @xmath388 , there is a family of probability @xmath389 \\x\\r^{2d + d^2}}$ ] in @xmath390 such that @xmath391 is a measurable map from @xmath382 \\times\\r^{2d+d^2}$ ] to @xmath392 and @xmath393 & \\le & \\lambda(t , x ) + \\eps , \\qquad\\mu\\mbox{-a.s.}\\end{aligned}\\ ] ]    by lemma  [ lemjbarlsc ] , the map @xmath394 $ ] is lower semicontinuous , and therefore measurable .",
    "moreover , @xmath395 is nonempty for every @xmath347 \\x\\r^{2d+d^2}$ ] .",
    "finally , by using the same arguments as in the proof of lemma  [ lemvlsc ] , we see that @xmath396 is a closed subset of @xmath382 \\x\\r^{2d + d^2 } \\x\\mathbf { m}(\\ob)$ ] . then , both items of the lemma follow from theorem  [ theomeasurabilitysup ] .",
    "we next prove the stability properties of probability measures under conditioning and concatenations at stopping times , which will be the key - ingredients for the proof of the dynamic programming principle .",
    "we first recall some results from stroock and varadhan @xcite and define some notation :    * for @xmath397 , let @xmath398 , and let @xmath174 be a probability measure on @xmath399 with @xmath400 = 1 $ ] for some @xmath401 , \\r^{2d + d^2})$ ] .",
    "then , there is a unique probability measure @xmath402 on @xmath219 such that @xmath403 = 1 $ ] and @xmath404 = \\pb[a]$ ] for all @xmath405 .",
    "in addition , if @xmath174 is also a probability measure on @xmath219 , under which a process @xmath406 defined on @xmath168 is a @xmath175-martingale after time @xmath82 , then @xmath406 is still a @xmath175-martingale after time @xmath82 in probability space @xmath407 . in particular , for @xmath408 $ ] , a constant @xmath409 and @xmath174 satisfying @xmath410 = 1 $ ] , we denote @xmath411 , where @xmath412 $ ] .",
    "* let @xmath413 be a probability measure on @xmath219 and @xmath42 a @xmath175-stopping time .",
    "then , there is a family of probability measures @xmath414 such that @xmath415 is @xmath416-measurable , for every @xmath417 , @xmath418(\\om ) = \\qb_{\\om}[e]$ ] for @xmath413-almost every @xmath419 and , finally , @xmath420 = 1 $ ] , for all @xmath421 .",
    "this is theorem 1.3.4 of @xcite , and @xmath422 is called the regular conditional probability distribution ( r.c.p.d . )    [ lemmrcpdsemimartingale ] let @xmath423 , @xmath42 be an @xmath175-stopping time taking value in @xmath330 $ ] , and @xmath414 be a r.c.p.d . of @xmath424 such that @xmath425 for all @xmath426 .",
    "since @xmath423 , it follows from theorem ii.2.21 of jacod and shiryaev @xcite that @xmath427 are all local martingales after time @xmath82 .",
    "then it follows from theorem 1.2.10 of stroock and varadhan @xcite together with a localization technique that there is a @xmath174-null set @xmath428 such that they are still local martingales after time @xmath429 both under @xmath430 and @xmath431 , for all @xmath432 .",
    "it is clear , moreover , that @xmath433-a.e . on @xmath434",
    "$ ] for @xmath174-a.e . @xmath419 .",
    "then there is a @xmath174-null set @xmath435 such that @xmath436 for every @xmath437 .",
    "[ lemmconcatenation ] let assumptions  [ assumlconvex ] ,  [ assumlunifcontinuity ] , [ assumlcroissantp ] hold true , and assume that @xmath351 is locally bounded .",
    "let @xmath423 , @xmath438 a @xmath439-stopping time , and @xmath440 a family of probability measures such that @xmath441 and @xmath415 is @xmath416-measurable .",
    "then there is a unique probability measure , denoted by @xmath442 , in @xmath443 , such that @xmath444 , and @xmath445    the existence and uniqueness of the probability measure @xmath446 on @xmath219 , satisfying ( [ eqproprcpd ] ) , follows from theorem 6.1.2 of @xcite .",
    "it remains to prove that @xmath447 .",
    "since @xmath448 , @xmath9 is a @xmath449-semimartingale after time @xmath450 , characterized by @xmath176 .",
    "then , the processes @xmath451 and @xmath452 are local martingales under @xmath453 after time @xmath454 . by theorem 1.2.10 of  @xcite together with a localization argument , they are still local martingales under @xmath455 . hence , the required result follows from theorem ii.2.21 of  @xcite .",
    "we have now collected all the ingredients for the proof of the dynamic programming principle .",
    "proof of proposition  [ propdpp ] let @xmath42 be an @xmath439-stopping time taking value in @xmath330 $ ] .",
    "we proceed in two steps :    for @xmath423 , we denote by @xmath456 a family of regular conditional probability distribution of @xmath457 , and @xmath458 . by the representation  ( [ eqlambdalrelax ] ) of @xmath351 , together with the tower property of conditional expectations",
    ", we see that @xmath459 \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & & \\qquad= \\inf_{\\pb\\in\\pcb_{t , x , a , b } } \\e^{\\pb } \\biggl [ \\int_t^{\\tau } \\ell(s , x_s,\\nu_s ) \\,ds + \\e^{\\pb_\\tau^\\omega }",
    "\\biggl\\ { \\int_{\\tau}^1 \\ell(s , x_s , \\nu_s ) \\,ds + \\lambda_1(x_1 ) \\biggr\\ } \\biggr]\\hspace*{-25pt } \\\\ & & \\qquad\\ge \\inf_{\\pb\\in\\pcb_{t , x , a , b } } \\e^{\\pb } \\biggl [ \\int_t^{\\tau } \\ell(s , x_s,\\nu_s ) \\,ds + \\lambda ( \\tau , x_{\\tau } ) \\biggr ] , \\nonumber\\end{aligned}\\ ] ] where the last inequality follows from the fact that @xmath460 by lemma  [ lemmrcpdsemimartingale ] .    for @xmath388 ,",
    "let @xmath461 \\x\\r ^{2d+d^2}}$ ] be the family defined in lemma [ lemmmeasurableselection ] , and denote @xmath462 .",
    "then @xmath463 is @xmath416-measurable . moreover , for all @xmath423 , we may construct by lemmas  [ lemmmeasurableselection ] and [ lemmconcatenation ] @xmath464 such that @xmath465 \\\\ & & \\qquad \\le \\e^{\\pb } \\biggl [ \\int_t^{\\tau } \\ell(s , x_s,\\nu_s ) \\,ds + \\lambda(\\tau , x_{\\tau } ) \\biggr ] + \\eps.\\end{aligned}\\ ] ] by the arbitrariness of @xmath423 and @xmath388 , together with the representation  ( [ eqlambdalrelax ] ) of @xmath352 , this implies that the reverse inequality to ( [ ineq1-dpp ] ) holds true , and the proof is complete .",
    "we conclude this section by the following :    proof of lemma  [ lemmdynamprogmu0 ] by the same arguments as in lemma  [ lemmmeasurableselection ] , we can easily deduce that @xmath51 is @xmath466-measurable , and we just need to prove that @xmath467.\\ ] ] given a probability measure @xmath468 , we can get a family of conditional probabilities @xmath469 such that @xmath470 , which implies that @xmath471 \\ge \\mu_0(\\lambda_0 ) \\qquad\\forall\\pb\\in\\pcb ( \\mu_0).\\ ] ] on the other hand , for every @xmath472 and @xmath473 , we can select a measurable family of @xmath474 such that @xmath475 \\le \\lambda_0 ( x ) + \\eps,\\qquad \\mu_0\\mbox{-a.s.},\\ ] ] and then construct a probability measure @xmath476 by concatenation such that @xmath477 & \\le & \\mu_0(\\lambda_0 ) + \\eps \\qquad \\forall\\eps > 0,\\end{aligned}\\ ] ] which completes the proof .",
    "the main purpose of this section is to show that when @xmath20 is bounded , then @xmath51 in ( [ eqlambda0l ] ) is lipschitz , and we may construct a convenient approximation of @xmath51 by restricting the space domain to bounded domains .",
    "these properties induce a first approximation for the minimum transportation cost @xmath245 , which serves as a preparation for the numerical approximation in section  [ secnumericalapprox ] .",
    "let us assume the following conditions .",
    "[ assumlbounded ] the control set @xmath20 is compact , and @xmath14 is lipschitz - continuous in @xmath478 uniformly in @xmath479 .    [ assummu01integrability ]",
    "@xmath480    we suppose that @xmath20 is compact for two main reasons .",
    "first , the uniqueness of viscosity solution of the hjb ( [ eqhjb ] ) relies on the comparison principle , for which the boundedness of @xmath20 is generally necessary .",
    "further , to construct a convergent ( monotone ) numerical scheme for a stochastic control problem , it is also generally necessary to suppose that the diffusion functions are bounded ( see also section [ subsecnumerpde ] for more discussions ) .      denote @xmath481\\x\\r^d\\x u } \\bigl ( |u| + \\bigl|\\ell(t,0,u)\\bigr| + \\bigl | \\nabla_x\\ell(t , x , u)\\bigr| \\bigr),\\end{aligned}\\ ] ] where @xmath482 is the gradient of @xmath14 with respect to @xmath478 which exists a.e . under assumption",
    "[ assumlbounded ] .",
    "let @xmath483 for every @xmath484 , a stopping time @xmath485 can be defined as the first exit time of the canonical process @xmath9 from  @xmath486 , @xmath487 and define for all bounded functions @xmath308 , @xmath488.\\ ] ]    [ lemmlambdalip ] suppose that @xmath50 is @xmath489-lipschitz satisfying @xmath490 and assumption  [ assumlbounded ] holds true .",
    "then @xmath351 and @xmath491 are lipschitz - continuous , and there is a constant @xmath492 depending on @xmath406 such that @xmath493 for all @xmath494\\times\\r^d.$ ]    we only provide the estimates for @xmath351 ; those for @xmath495 follow from the same arguments .",
    "first , by assumption [ assumlbounded ] together with the fact that @xmath50 is @xmath489-lipschitz and @xmath496 , for every @xmath497 , @xmath498 & \\le & m + ( m+k ) \\sup_{t \\le s \\le1 } \\e^{\\p } | x_s |.\\end{aligned}\\ ] ] recall that @xmath9 is a continuous semimartingale under @xmath23 whose finite variation part and quadratic variation of the martingale part are both bounded by a constant @xmath406 . separating the two parts and using cauchy ",
    "schwarz s inequality , it follows that @xmath499 , and then @xmath500 .",
    "we next prove that @xmath351 is lipschitz and provide the corresponding estimate .",
    "observe that @xmath501 .",
    "then @xmath502 by the lipschitz property of @xmath14 and @xmath351 in @xmath478 .    denoting @xmath503 , in the special case where @xmath20 is a singleton , equation  ( [ eqhjbr ] ) degenerates to the heat equation .",
    "barles , daher and romano @xcite proved that the error @xmath504 satisfies a large deviation estimate as @xmath505 .",
    "the next result extends this estimate to our context .",
    "[ lemmerrorlambdalambdar ] letting assumption  [ assumlbounded ] hold true , we denote @xmath506 for @xmath507 and choose @xmath508 .",
    "then , there is a constant @xmath492 such that for all @xmath509 , all @xmath489-lipschitz function @xmath50 and @xmath510 , @xmath511    \\(1 ) for arbitrary @xmath494\\times\\r^d$ ] and @xmath512 , we denote @xmath513 , where @xmath514 is the @xmath515th component of the canonical process  @xmath9 . by the dubins  schwarz time - change theorem ( see , e.g. , theorem 4.6 , chapter 3 of karatzas and shreve @xcite ) , we may represent the continuous local martingale part of @xmath514 as a time - changed brownian motion @xmath39 .",
    "since the characteristics of @xmath9 are bounded by @xmath406 , we see that @xmath516 & \\le & \\p \\bigl [ \\sup_{0 \\le t \\le m } |w_t| \\ge r -    \\nonumber \\\\ & \\le & 2 \\p \\bigl[\\sup_{0 \\le t \\le m } w_t \\ge r - |x_i| - m \\bigr ] \\\\ & = & 4 \\bigl ( 1 - \\mathbf { n } \\bigl(r_{|x_i|}^m \\bigr ) \\bigr),\\nonumber\\end{aligned}\\ ] ] where @xmath517 , @xmath518 is the cumulative distribution function of the standard normal distribution @xmath519 , and the last equality follows from the reflection principle of the brownian motion . then by integration by parts as well as ( [ eqdistributionfunctionf ] ) , @xmath520 & = & r s^i(r ) + \\int_r^{\\infty } s^i(z ) \\,dz \\\\ & \\le & 4 \\int_r^{\\infty } \\frac{1}{\\sqrt{m } } \\frac{1}{\\sqrt{2 \\pi } } \\exp \\biggl(\\frac{(z - m-|x_i|)^2}{2 m } \\biggr ) z \\,dz \\\\ & = & 4\\bigl(|x_i|+m\\bigr ) \\bigl(1 - \\mathbf { n } \\bigl(r_{|x_i|}^m \\bigr ) \\bigr ) + \\frac{4 \\sqrt{m}}{\\sqrt{2 \\pi } } \\exp \\biggl(-\\frac{(r_{|x_i|}^m)^2}{2 } \\biggr).\\end{aligned}\\ ] ] we further remark that for any @xmath521 , @xmath522 ( 2 ) by definitions of @xmath351 , @xmath491",
    ", it follows that for all @xmath523 such that @xmath510 , @xmath524 \\nonumber \\\\ & \\le & \\sup_{\\p\\in\\pc_{t , x } } \\e^{\\p } \\bigl [ \\bigl ( m + \\sqrt{d } k r + ( m+k)\\sup_{t \\le s \\le1}|x_s| \\bigr ) \\1_{\\tau_r<1 } \\bigr ] \\nonumber \\\\[-8pt ] \\\\[-8pt ] \\nonumber & \\le & \\sup_{\\p\\in\\pc_{t , x } } \\e^{\\p } \\biggl [ \\sum _ { i=1}^d \\bigl(m+\\sqrt{d } k r+\\sqrt { d}(m+k)y_i \\bigr ) \\1_{y_i \\ge r } \\biggr ] \\nonumber \\\\ & \\le & c(1+k ) e^{-(r_{|x|}^m)^2/2}\\nonumber\\end{aligned}\\ ] ] for some constant @xmath492 depending on @xmath406 and @xmath12 .",
    "this completes the proof .    with the estimate in lemma  [ lemmlambdalip ]",
    ", we have the following result .",
    "suppose that assumptions  [ assumlconvex ] , [ assumlunifcontinuity ] ,  [ assumlcroissantp ] hold true and @xmath358 given by ( [ eqhamiltonian ] ) is continuous .",
    "then the function @xmath491 in ( [ eqlambdar ] ) is the unique viscosity solution of equation @xmath525 with boundary conditions @xmath526 where @xmath527 denotes the boundary of @xmath486 .",
    "first , it follows by the same arguments as in theorem [ theouviscositysol ] that @xmath491 is a viscosity solution of ( [ eqhjbr ] ) with boundary condition ( [ eqhjbrboundarycond ] ) .",
    "the uniqueness follows by the comparison principle of ( [ eqhjbr ] ) , ( [ eqhjbrboundarycond ] ) , which holds clearly true from discussions in example 3.6 of crandall et al . @xcite .      in the bounded characteristics case",
    ", we can give a first approximation of the minimum transportation cost .",
    "nevertheless , a complete resolution needs a numerical approximation which will be provided in section [ secnumericalapprox ] .",
    "let us fix the two probability measures @xmath0 and @xmath1 , and simplify the notation @xmath245 [ resp .",
    ", @xmath528 to @xmath133 ( resp . , @xmath529 ) .    first , under assumptions  [ assumlconvex ] , [ assumlunifcontinuity ] ,  [ assumlcroissantp ] , [ assumlunifcontinuityinx ] and  [ assumlbounded ]",
    ", it follows by our duality result of theorem  [ theodual ] together with theorem [ theoweakdual ] that @xmath530 \\\\[-8pt ] \\nonumber & = & \\overline{\\vc}:=\\sup_{\\lambda_1 \\in c^\\infty_b(\\r^d ) } \\bigl(\\mu_0 ( \\lambda_0 ) - \\mu_1(\\lambda_1 ) \\bigr ) , \\nonumber\\end{aligned}\\ ] ] where @xmath51 is defined in ( [ eqlambda0l ] ) .",
    "let @xmath531 denote the collection of all bounded @xmath489-lipschitz - continuous functions @xmath532 with @xmath533 , and denote @xmath534 .",
    "since @xmath535 for any @xmath536 and @xmath537 , we deduce from ( [ eqvcvcbequiv ] ) that @xmath538 as a first approximation , we introduce the function @xmath539 under assumptions  [ assumlbounded ] and [ assummu01integrability ] , it is clear that @xmath540 by lemma  [ lemmlambdalip ] .",
    "then , it is immediate that @xmath541    letting @xmath491 be defined in ( [ eqlambdar ] ) for every @xmath542 , denote @xmath543 \\\\[-8pt ] \\nonumber   v^r(\\lambda_1 ) & : = & \\mu_0\\bigl ( \\lambda^r_0 \\1_{o_r } \\bigr)-\\mu_1 ( \\lambda_1 \\1_{o_r}).\\end{aligned}\\ ] ] then the second approximation is on variable @xmath544 .",
    "let assumptions  [ assumlbounded ] and [ assummu01integrability ] hold true , then for all , @xmath545 \\\\[-8pt ] \\nonumber & & \\qquad\\le c(1+k ) \\biggl ( e^{-r^2/8 m + r/2 } + \\int_{o_{r/2}^c}\\bigl(1+|x|\\bigr ) ( \\mu_0 + \\mu_1 ) ( dx ) \\biggr).\\end{aligned}\\ ] ]    by their definitions in ( [ vk ] ) and ( [ eqvkr ] ) , we have @xmath546 now for all @xmath547 , we estimate from lemmas [ lemmlambdalip ] and  [ lemmerrorlambdalambdar ] that @xmath548 observing that @xmath549 on @xmath550 , this implies that @xmath551 and the required estimate follows .",
    "throughout this section , we consider the markovian context where @xmath552 under bounded characteristics . our objective is to provide an implementable numerical algorithm to compute @xmath553 in ( [ eqvkr ] ) , which is itself an approximation of the minimum transportation cost @xmath133 in ( [ eqvcvcbequiv ] ) .",
    "although there are many numerical methods for nonlinear pdes , our problem concerns the maximization over the solutions of a class of nonlinear pdes . to the best of our knowledge , it is not addressed in the previous literature . in bonnans and tan @xcite ,",
    "a similar but more specific problem is considered .",
    "their set @xmath20 allowing for unbounded diffusions is out of the scope of this paper .",
    "however , by using the specific structure of their problem , their key observation is to convert the unconstrained control problem into an optimal stopping problem for which they propose a numerical approximation scheme .",
    "our numerical approximation is slightly different , as we avoid the issue of singular stochastic control by restricting to bounded controls , but uses their gradient algorithm for the minimization over the choice of lagrange multipliers @xmath50 .    in the following",
    ", we shall first give an overview of the numerical methods for nonlinear pdes in section  [ subsecnumerpde ] .",
    "then by constructing the finite difference scheme for nonlinear pde ( [ eqhjbr ] ) , we get a discrete optimization problem in section [ subsecfdapproximation ] which is an approximation of @xmath553 .",
    "we then provide a gradient algorithm for the resolution of the discrete optimization problem in section  [ subsecgradientprojalgo ] .",
    "finally , we implement our numerical algorithm to test its efficiency in section  [ subsecnumericalexample ] .    in the remaining part of this paper ,",
    "we restrict the discussion to the one - dimensional case @xmath554      there are several numerical schemes for nonlinear pdes of the form ( [ eqhjb ] ) , for example , the finite difference scheme , semi - lagrangian scheme and monte - carlo schemes .",
    "general convergence is usually deduced by the monotone convergence technique of barles and souganidis @xcite or the controlled markov - chain method of kushner and dupuis  @xcite .",
    "both methods demand the monotonicity of the scheme , which implies that in practice we should assume the boundedness of drift and diffusion functions [ see , e.g. , the cfl condition ( [ eqcflcondition ] ) below ] . to derive a convergence rate ,",
    "we usually apply krylov s perturbation method ; see , for example , barles and jakobsen @xcite .    for the finite difference scheme , the monotonicity is guaranteed by the cfl condition [ see , e.g. , ( [ eqcflcondition ] ) below ] in the one - dimensional case @xmath104 . however , in the general @xmath12-dimensional case , it is usually hard to construct a monotone scheme .",
    "kushner and dupuis @xcite suggested a construction when all covariance matrices are diagonal dominated .",
    "bonnans et al .",
    "@xcite investigated this issue and provided an implementable but sophisticated algorithm in the two - dimensional case .",
    "debrabant and jakobsen @xcite proposed recently a semi - lagrangian scheme for nonlinear equations of the form ( [ eqhjb ] ) .",
    "however , to be implemented , it still needs to discretize the space and then to use an interpolation technique .",
    "therefore , it can be viewed as a kind of finite difference scheme .    in the high - dimensional case",
    ", it is generally preferred to use monte - carlo schemes . for linear and",
    "semilinear parabolic pdes , the monte - carlo methods are usually induced by the feynman  kac formula and backward stochastic differential equations ( bsdes ) .",
    "this scheme is then generalized by fahim , touzi and warin  @xcite for fully nonlinear pdes .",
    "the idea is to approximate the derivatives of the value function arising in the pde by conditional expectations , which can then be estimated by simulation - regression methods .",
    "however , the monte - carlo method is not convenient to be used here since for every terminal condition @xmath50 , one needs to simulate many paths of a stochastic differential equation and then to solve the pde by regression method , which makes the computation too costly .    for our problem in ( [ eqvkr ] )",
    ", we finally choose to use the finite difference scheme for the resolution of @xmath555 since it is easy to be constructed explicitly as a monotone scheme under explicit conditions in our context .",
    "let @xmath556 and @xmath557 be such that @xmath558 and @xmath559 .",
    "denote @xmath560 , @xmath561 and define the discrete grids : @xmath562 \\x(-r , r ) \\bigr).\\end{aligned}\\ ] ] the terminal set and boundary set as well as the interior set of @xmath563 are denoted by @xmath564    we shall use the finite differences method to solve the dynamic programming equation ( [ eqhjbr ] ) , ( [ eqhjbrboundarycond ] ) on the grid @xmath563 . for a function @xmath565 defined on @xmath563 , we introduce the discrete derivatives of @xmath565 : @xmath566 and @xmath567 where @xmath568 , @xmath569 ; and @xmath570 we now define the function @xmath571(or @xmath572 to emphasize its dependence on the boundary condition @xmath573 ) on the grid @xmath563 by the following explicit finite differences approximation of the dynamic programming equation ( [ eqhjbr ] ) : @xmath574 and on @xmath575 , @xmath576 \\\\[-10pt ] \\nonumber & & \\qquad=\\biggl(\\hat\\lambda^{h , r } + \\delta t \\inf_{u=(a , b)\\in u } \\biggl\\ { \\ell(\\cdot , u ) + ( bd)\\hat\\lambda^{h , r } + \\frac12 a d^2 \\hat \\lambda^{h , r } \\biggr\\ } \\biggr ) ( t_{k+1},x_i).\\hspace*{-25pt}\\end{aligned}\\ ] ] we then introduce the following natural approximation of @xmath577 : @xmath578 \\bigr ) -\\mu_1 \\bigl(\\lin^r[\\hat \\lambda_1 ] \\bigr)\\qquad \\mbox{where } \\hat\\lambda^{h , r}_0:= \\hat\\lambda^{h , r}(0,\\cdot),\\ ] ] and for all functions @xmath579 defined on the grid @xmath580 we denote by @xmath581 $ ] the linear interpolation of @xmath579 extended by zero outside @xmath582 $ ] .",
    "we shall also assume that the discretization parameters @xmath583 satisfy the cfl condition @xmath584 then the scheme ( [ eqdiscretwr ] ) is @xmath585-monotone , so that the convergence of the scheme is guaranteed by the monotonic scheme method of barles and souganidis @xcite .",
    "for our next result , we assume that the following error estimate holds .",
    "[ assumviscosityerrorrate ] there are positive constants @xmath586 , @xmath587 , @xmath588 which are independent of @xmath589 , such that @xmath590-\\lambda_0 \\1_{[-r , r]}\\bigr | \\bigr ) \\le l_{k , r } \\bigl(\\delta t^{\\rho_1 } + \\delta x^{\\rho_2}\\bigr)\\end{aligned}\\ ] ] for all @xmath591 .",
    "let @xmath592 be the collection of all functions on the grid @xmath580 defined as restrictions of functions in @xmath593 : @xmath594 the above approximation of the dynamic value function @xmath351 suggests the following natural approximation of the minimal transportation cost value : @xmath595 \\\\[-8pt ] \\nonumber & = & \\sup_{\\hat\\lambda_1\\in\\operatorname{lip}_0^{k , r } } \\mu_0 \\bigl(\\lin^r\\bigl[\\hat \\lambda^{h , r}_0\\bigr ] \\bigr ) -\\mu_1 \\bigl ( \\lin^r[\\hat\\lambda_1 ] \\bigr).\\end{aligned}\\ ] ]    under assumption  [ assumlbounded ] and the additional condition that @xmath14 is uniformly @xmath596-hlder in @xmath82 with constant @xmath406 , then in spirit of the analysis in barles and jakobsen @xcite , assumption  [ assumviscosityerrorrate ] holds true with @xmath597 , @xmath598 and @xmath599 with some constant @xmath492 depending on @xmath406 .",
    "this rate is not the best , but to the best of our knowledge , it is the best rate which has been proved",
    ".    let assumption  [ assumviscosityerrorrate ] be true , then with the constants @xmath586 , @xmath587 , @xmath588 introduced in assumption [ assumviscosityerrorrate ] , we have @xmath600    first , given @xmath601 ,",
    "we take @xmath602 , then clearly @xmath603 - \\lambda_1 |_{l^{\\infty}([-r , r ] ) } \\le k \\delta x$ ] , and it follows from assumption  [ assumviscosityerrorrate ] and ( [ eqvkr ] ) as well as ( [ eqvrh ] ) that @xmath604 .",
    "hence , @xmath605 next , given @xmath606 , let @xmath607 \\in\\operatorname{lip}^k_0 $ ] be the linear interpolation of @xmath573 .",
    "it follows from assumption  [ assumviscosityerrorrate ] that @xmath608 and , therefore , @xmath609      in this section we suggest a numerical scheme to approximate @xmath610 in ( [ eqvkrh ] ) . the crucial observation for our methodology is the following . by @xmath611",
    ", we denote the set of all bounded functions on @xmath580 .",
    "[ propvconcave ] under the cfl condition ( [ eqcflcondition ] ) , the function @xmath612 is concave on @xmath611 .",
    "letting @xmath613 , with @xmath614 , we introduce @xmath615 ( or just @xmath616 if there is no risk of ambiguity ) as the unique solution of the discrete linear system on @xmath563 with a given @xmath617 : @xmath618 and on @xmath575 @xmath619 \\\\[-8pt ] \\nonumber & & \\qquad = \\bigl(\\overline{\\lambda}{}^{h,\\ub } + \\delta t \\bigl ( \\ell(\\cdot , \\ub_{k , i } ) + ( \\bbb_{k , i } d ) \\overline{\\lambda}{}^{h,\\ub } + \\abb_{k , i } d^2 \\overline{\\lambda}{}^{h,\\ub } \\bigr ) \\bigr ) ( t_{k+1},x_i ) .",
    "\\nonumber\\end{aligned}\\ ] ] let @xmath620 , and define @xmath621 \\bigr ) -\\mu_1",
    "\\bigl(\\lin^r[\\hat \\lambda_1 ] \\bigr).\\ ] ] we claim that @xmath622 indeed , under the cfl condition ( [ eqcflcondition ] ) , the finite difference scheme ( [ eqdiscretwr ] ) as well as  ( [ eqdiscretwreb ] ) are both @xmath585-monotone in the sense of barles and souganidis  @xcite . moreover , the linear interpolation @xmath623 $ ] is also monotone .",
    "then taking infimum step by step in ( [ eqdiscretwr ] ) and ( [ eqvkrh ] ) is equivalent to taking infimum globally in  ( [ equhr ] ) .",
    "finally , the concavity of @xmath624 follows from its representation as the infimum of linear maps in ( [ equhr ] ) .    by the previous proposition ,",
    "@xmath625 consists in the maximization of a concave function , and a natural scheme to approximate it is the gradient projection algorithm .    [ remfdexistoptimalcontrol ] since @xmath20 is compact by assumption  [ assumlbounded ] , then for every function  @xmath617 , we have the optimal control @xmath626 such that @xmath627    now we are ready to give the gradient projection algorithm for @xmath625 in ( [ eqvkrh ] ) .",
    "given a function @xmath628 , we denote by @xmath629 the projection of @xmath630 on @xmath592 , where @xmath631 is defined in ( [ eqlip0kr ] ) .",
    "of course , the projection depends on the choice of the norm equipping @xmath632 which in turn has serious consequences on the numerics .",
    "we shall discuss this important issue later .",
    "letting @xmath633 be a sequence of positive constants , we propose the following algorithm :    to solve problem ( [ eqvkrh ] ) :    * \\(1 ) let @xmath634 .",
    "* \\(2 ) given @xmath635 , compute the super - gradient @xmath636 of @xmath637 at @xmath635 . *",
    "\\(3 ) let @xmath638 .",
    "* \\(4 ) go back to step 2 .    in the following",
    ", we shall discuss the computation of super - gradient@xmath639 , the projection @xmath640 as well as the convergence of the above gradient projection algorithm .",
    "let @xmath641 be fixed .",
    "then , by remark [ remfdexistoptimalcontrol ] , we may find an optimal control @xmath642 , where@xmath643 , for system ( [ equhr ] ) .",
    "we then denote by @xmath644 the unique solution of the following linear system on @xmath563 , for every @xmath645 : @xmath646 and on @xmath575 , @xmath647 denote @xmath648 and @xmath649 a function on @xmath580 defined by @xmath650 .",
    "let cfl condition ( [ eqcflcondition ] ) hold true , then the vector @xmath651 \\bigr ) - \\mu_1 \\bigl ( \\lin^r[\\delta_j ] \\bigr ) \\bigr ) _ { -r \\le j \\le r } \\ ] ] is a super - gradient of @xmath652 at @xmath617 .    consider the system ( [ eqdiscretwreb ] ) introduced in the proof of proposition  [ propvconcave ] . under the cfl condition ( [ eqcflcondition ] ) , by ( [ equhr ] )",
    ", we have for every perturbation @xmath653 , @xmath654 which implies that @xmath655 we next observe that for fixed @xmath617 , the function @xmath656 is linear , and it follows that @xmath657 is a super - gradient of @xmath658 at @xmath573 .",
    "finally , by ( [ eqdiscretwreb ] ) and ( [ eqdiscretsupergradient ] ) , @xmath659 where @xmath660 is the solution of ( [ eqdiscretwreb ] ) with boundary condition @xmath661 . by the definition of @xmath662 in ( [ equhr ] ) , it follows that the super - gradient ( [ eqnablauhrexpression ] ) is equivalent to @xmath639 defined in  ( [ eqnablauhr ] ) .      to compute the projection @xmath663 , @xmath664",
    ", we need to equip @xmath611 with a specific norm . in order to obtain a simple projection algorithm",
    ", we shall introduce an invertible linear map between @xmath611 and @xmath665 , then equip on @xmath611 the norm induced by the classical @xmath61-norm on @xmath665 .",
    "let us define the invertible linear map @xmath666 from @xmath611 to @xmath665 as @xmath667 and define the norm @xmath668 on @xmath611 ( easily be verified ) by @xmath669 notice that @xmath670^ { 2r+1 } \\dvtx\\psi_0 = 0 \\bigr\\}.\\end{aligned}\\ ] ] then the projection @xmath671 from @xmath611 to @xmath672 under norm @xmath668 is equivalent to the projection @xmath673 from @xmath665 to @xmath674 under the @xmath61-norm , which is simply written as @xmath675      now , let us give a convergence rate for the above gradient projection algorithm . in preparation , we first provide an estimate for the norm of super - gradients @xmath676 .",
    "suppose that cfl condition ( [ eqcflcondition ] ) holds true , then @xmath677 for every @xmath678 .",
    "in particular , the super - gradient @xmath676 satisfies @xmath679    under the cfl condition , the scheme ( [ eqdiscretwr ] ) is @xmath585-monotone , then @xmath680 and it follows from the definition of @xmath681 in  ( [ eqvrh ] ) that @xmath682 next , by the cauchy  schwarz inequality , @xmath683 together with ( [ eqgraduhrinfty ] ) , this implies that ( [ eqsupergradbound ] ) holds for every super - gradient @xmath684 .",
    "let us finish this section by providing a convergence rate for our gradient projection algorithm .",
    "denote @xmath685 and it follows from section 5.3.1 of ben - tal and nemirovski @xcite that @xmath686 \\\\[-8pt ] \\nonumber & \\le & \\frac { 2 k^2 r \\delta x + 4   ( { r}/{\\delta x } + 1   ) \\sum_{n=1}^n \\gamma_n^2 } { \\sum_{n=1}^n \\gamma_n}.\\end{aligned}\\ ] ]    we have several choices for the series @xmath687 :    * divergent series : @xmath688 , @xmath689 and @xmath690 , then the right - hand side of ( [ eqconvrategradientproj ] ) converges to @xmath81 as @xmath691 .",
    "* optimal stepsizes : @xmath692 , @xcite shows that @xmath693 for some constant @xmath492 independent of @xmath489 , @xmath544 , @xmath694 , @xmath695 and @xmath696 .",
    "we finally implement the above algorithm in the context of an application in finance which consists in the determination of the optimal no - arbitrage bounds of exotic options .",
    "as discussed in the , this problem has been solved by means of the skorokhod embedding problem ( sep ) in the context of some specific examples of derivative securities . however , the sep approach is not suitable for numerical approximation . in davis ,",
    "obloj and raval @xcite , the authors consider a similar problem for the weighted variance swap option which can be included in our context .",
    "in contrast to our constraint @xmath697 in  ( [ pmu0mu1 ] ) , they impose the constraint of the form @xmath698 = p_k , k=1,\\ldots , n$ ] for some functions @xmath699 and constants @xmath700 .",
    "then , they convert their problem into a semi - infinite linear programming problem which can be solved numerically . we shall use some techniques in  @xcite to derive an explicit solution for some examples in order to compare with our numerical results .",
    "suppose that @xmath701 , and @xmath702 \\x\\ { 0 \\}$ ] , then under every @xmath703 , the canonical process @xmath9 is a martingale .",
    "suppose that @xmath103 is nonempty , then it is clear that @xmath704 \\\\",
    "& = & \\inf_{\\p\\in\\pc(\\mu_0 , \\mu_1 ) } \\e^{\\p } \\bigl [ x^2_1 - x^2_0 \\bigr ] = \\mu_1(\\phi_0 ) - \\mu_0(\\phi_0),\\end{aligned}\\ ] ] where @xmath705 . in our implemented example",
    ", we choose @xmath706 as normal distribution @xmath707 with @xmath708 , @xmath709 , @xmath710 and @xmath711 .",
    "it follows by direct computation that @xmath712 . in our numerical test , for @xmath713 iterations ,",
    "the computation time is 56.38 seconds , and it gives a numerical solution 0.029705 , which implies that the relative error is less than @xmath714 ; see figure  [ figtoyexample ] .     with @xmath708 , @xmath709 , @xmath715 , @xmath716 , @xmath717 , @xmath718 .",
    "the computation time is 56.38 seconds for @xmath713 iterations . ]",
    "let @xmath719 denote the price process of an underlying stock .",
    "we assume that @xmath720 is a scalar positive continuous semimartingale .",
    "the variance swap contract is therefore defined by the payoff @xmath721 at maturity @xmath26 , which is the quadratic variation of the process @xmath722 at time @xmath26 .    following section 4 of @xcite",
    ", we shall consider an @xmath188-weighted variance swap , for some lipschitz function @xmath723 .",
    "this is a derivative security defined by the payoff at maturity @xmath26 : @xmath724 under no additional information , any martingale measure @xmath23 ( i.e. , a probability measure under which the process @xmath720 is a martingale ) induces an admissible no - arbitrage price @xmath725.\\ ] ] following galichon et al .",
    "@xcite , we assume that all european options maturing at time @xmath26 with all possible strikes are liquids and available for trading , that is , @xmath726 $ ] is given for all @xmath727",
    ". then the marginal distribution of @xmath728 under @xmath23 is given by @xmath729 .",
    "in other words , for every @xmath730 , the derivative security with payoff @xmath731 at maturity @xmath26 is available for trading ( long or short ) at the no - arbitrage price @xmath732 . under this additional information , a no - arbitrage lower",
    "bound of the @xmath733-weighted variance swap is given by @xmath734 - \\tilde{\\mu}_1(\\lambda_1 ) \\biggr\\},\\ ] ] where the infimum is taken over all martingale measures for @xmath720 .",
    ", @xmath715 , @xmath735 , @xmath736 , @xmath718 . for weight function @xmath737 ,",
    "the numerical solution is 0.0395311 after @xmath713 iterations . for weight function @xmath738 ,",
    "the numerical solution is 0.0391632 after @xmath713 iterations . ]",
    "this problem can be studied by our mass transportation problem .",
    "suppose that @xmath739 , where @xmath9 is the canonical process on the canonical space @xmath98 .",
    "suppose further that @xmath740 \\bigr\\},\\ ] ] with positive constants @xmath741 . then under every @xmath703 [ defined below  ( [ eqconvexitysetsigma ] ) ] , the process @xmath742 is a positive continuous martingale .",
    "if we take the infimum in ( [ eqboundvs ] ) over @xmath97 , it follows by our duality result ( theorem  [ theodual ] ) that the bound ( [ eqboundvs ] ) equals @xmath743 where @xmath744 and @xmath1 is the distribution of @xmath745 when @xmath746 [ or , equivalently , it is derived from @xmath747 by @xmath748 , @xmath749 .",
    "furthermore , by similar techniques as in section 4 of davis et  al .",
    "@xcite , using it s formula , it follows that when @xmath750 is nonempty , we have @xmath751 = \\mu_1(\\phi ) - \\phi(x_0 ) , \\label{varianceswap - explicit}\\end{aligned}\\ ] ] where @xmath579 is a solution to @xmath752 .    in our numerical experiments ,",
    "we choose @xmath710 , @xmath753 , @xmath754 , @xmath1 is a normal distribution @xmath755 with @xmath756 $ ] .",
    "then @xmath757 is nonempty since the probability @xmath23 induced by the process @xmath758 ( with brownian motion @xmath39 ) belongs to it . in a first example , we choose @xmath737 , then @xmath759 is the solution to @xmath760 .",
    "it follows by direct computation that the value in ( [ eqboundvs2 ] ) is given by @xmath761 .",
    "our numerical solution is @xmath762 after @xmath713 iterations , which takes 138.51 seconds . in a second example , we choose @xmath738 , then @xmath763 is the solution to @xmath764 .",
    "it follows that the value in ( [ eqboundvs2 ] ) is given by @xmath765 . in our numerical test",
    ", the computation time is 142.23 seconds for @xmath713 iterations and it gives the numerical solution @xmath766 ; see figure  [ figvarianceswap ] .",
    "we first give a result which follows directly from the measurable selection theorem .",
    "let @xmath53 and @xmath767 be two polish spaces with their borel @xmath69-fields @xmath768 and @xmath769 .",
    "@xmath770 is a measurable subset in the product space @xmath771 satisfying that for every @xmath772 , there is @xmath773 such that .",
    "letting @xmath383 be a probability measure on @xmath774 , we denote by @xmath775 the @xmath383-completed @xmath69-field of @xmath776 .",
    "suppose that @xmath777 is @xmath778-measurable , and denote @xmath779    [ theomeasurabilitysup ] the function @xmath780 is @xmath775-measurable .",
    "moreover , for every @xmath781 , there is a @xmath775-measurable variable @xmath782 such that for @xmath383-a.e .",
    "@xmath772 , @xmath783 and @xmath784    theorem  [ theomeasurabilitysup ] is almost the same as proposition 7.50 of bertsekas and shreve @xcite , and can be easily deduced from it .",
    "the key argument is the measurable selection theorem .",
    "we also refer to section 12.1 of stroock and varadhan @xcite , chapter 7 of bertsekas and shreve @xcite or chapter 3 of dellacherie and meyer @xcite for different versions of the measurable selection theorem .",
    "we next report a theorem which provides the unique canonical decomposition of a continuous semimartingale under different filtrations .",
    "in particular , it follows that an it process has a diffusion representation , by taking the filtration generated by itself .",
    "this is in fact theorem 7.17 of liptser and shiryayev @xcite in the case or theorem 4.3 of wong @xcite in the multidimensional case .",
    "[ theoito2diffusion ] in a filtrated space @xmath785 ( here @xmath98 is not necessarily the canonical space ) , a process @xmath9 is a continuous semimartingale with canonical decomposition : @xmath786 where @xmath787 and @xmath788 is of finite variation and @xmath113 a local martingale .",
    "in addition , suppose that there are measurable and @xmath74-adapted processes @xmath789 such that @xmath790 \\,ds < \\infty \\quad\\mbox { and}\\quad a_t:= \\langle m \\rangle_t = \\int_0^t \\a_s \\,ds.\\ ] ] let @xmath791 be the filtration generated by process @xmath9 and @xmath792 be a filtration such that @xmath793 .",
    "then @xmath9 is still a continuous semimartingale under @xmath794 , whose canonical decomposition is given by @xmath795 where @xmath796 \\quad\\mbox{and}\\quad \\bar{\\a}_t = \\a_t , d\\p\\x \\,dt\\mbox{-a.e.}\\ ] ]    proof of theorem  [ theouviscositysol ] the characterization of the value function as viscosity solution to a dynamic programming equation is a natural result of the dynamic programming principle . here",
    ", we give a proof , similar to that of corollary  5.1 in @xcite , in our context .",
    "\\(1 ) we first prove the subsolution property .",
    "suppose that @xmath797 and @xmath798 is a smooth function such that @xmath799 by adding @xmath800 to @xmath801 , we can suppose that @xmath802 without losing generality .",
    "assume to the contrary that @xmath803 and we shall derive a contradiction .",
    "indeed , by definition of @xmath358 , there is @xmath804 and @xmath805 such that @xmath806 where @xmath807 .",
    "let @xmath808 , then @xmath809 \\\\ & \\ge & \\inf_{\\pb\\in\\pcb_{t_0,x_0,0,0 } } \\e^{\\pb } \\biggl [ \\int_t^{\\tau } \\ell(s , x_s , \\nu_s ) \\,ds + \\lambda(\\tau , x_{\\tau } ) \\biggr ] + \\eta,\\end{aligned}\\ ] ] where @xmath188 is a positive constant by ( [ eqvarphiminusu ] ) and the definition of @xmath42 .",
    "this is a contradiction to proposition [ propdpp ] .",
    "\\(2 ) for the supersolution property , we assume to the contrary that there is @xmath810 and a smooth function @xmath579 satisfying @xmath811 and @xmath812 we also suppose without losing generality that @xmath813    by continuity of @xmath358 , there is @xmath814 such that for all @xmath815 and every @xmath805 , @xmath816 let @xmath817 , then @xmath818 \\\\ & \\le & \\inf_{\\pb\\in\\pcb_{t_0,x_0,0,0 } } \\e^{\\pb } \\biggl [ \\lambda ( \\tau , x_{\\tau } ) + \\int_{t_0}^{\\tau } \\ell(s , x_s , \\nu_s ) \\,ds \\biggr ] - \\eta\\end{aligned}\\ ] ] for some @xmath819 by ( [ eqvarphiplusu ] ) , which is a contradiction to proposition  [ propdpp ] .",
    "we are grateful to j. frdric bonnans , nicole el karoui and alfred galichon for fruitful discussions and two anonymous referees for helpful comments and suggestions ."
  ],
  "abstract_text": [
    "<S> we consider an extension of the monge  </S>",
    "<S> kantorovitch optimal transportation problem . </S>",
    "<S> the mass is transported along a continuous semimartingale , and the cost of transportation depends on the drift and the diffusion coefficients of the continuous semimartingale . </S>",
    "<S> the optimal transportation problem minimizes the cost among all continuous semimartingales with given initial and terminal distributions . </S>",
    "<S> our first main result is an extension of the kantorovitch duality to this context . </S>",
    "<S> we also suggest a finite - difference scheme combined with the gradient projection algorithm to approximate the dual value . </S>",
    "<S> we prove the convergence of the scheme , and we derive a rate of convergence .    </S>",
    "<S> we finally provide an application in the context of financial mathematics , which originally motivated our extension of the monge  kantorovitch problem . </S>",
    "<S> namely , we implement our scheme to approximate no - arbitrage bounds on the prices of exotic options given the implied volatility curve of some maturity . </S>"
  ]
}