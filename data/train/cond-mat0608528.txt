{
  "article_text": [
    "the wannier functions ( wfs ) play a key role in the solid - state physics , as they make a direct connection between the reciprocal @xmath4-momentum space and the real space representations for the quantum - mechanical operators , which allows us to formulate the problem of electronic - structure calculations for the infinite periodical systems in a basis of localized ( wannier ) orbitals.@xcite the construction of wfs using first - principles electronic structure calculations has attracted a considerable attention recently.@xcite the reason is mainly twofold :    * wfs appear to be extremely useful for the visualization and interpretation of the behavior of the local quantities in the real space .",
    "for example , in the electronic structure calculations based on the plane waves , such a construction can add many new functionalities , which were initially a privilege of the methods working in the basis of localized atomic orbitals.@xcite * another important application of wfs is related with the construction of the so - called `` _ _ ab initio _",
    "_ models for the strongly - correlated materials '' , which are designed to deal with the low - energy properties of these systems and go beyond the conventional ( and oversimplified in the case of the strongly - correlated systems ) local - density approximation ( lda ) . in this case , the wannier orbitals form the basis of the physical hilbert space , which is then used for the construction of the model ( typically , hubbard - type ) hamiltonians.@xcite    the choice of the wannier function is not unique , and their extension in the real space can vary depending on the procedure and the parameters of calculations . in order to illustrate the importance of this problem",
    ", one may remind to the reader that one extreme example of wfs are the bloch states , which are totally delocalized in the real space .",
    "of course , the physics should not depend on whether the wfs are localized or not , because all representations provide the complete sets of the basis functions ( for the low - energy part of the spectrum ) , which are totally equivalent from the physical point of view .",
    "however , from the viewpoint of practical applications , it is more convenient to work with the localized orbitals .",
    "for example , in the process of construction of the hubbard hamiltonian one would always like to keep only the site - diagonal elements of coulomb and exchange interactions and neglect all intersite interactions .",
    "this is only possible when the wannier basis is sufficiently well localized in the real space , so that the overlap between the functions centered at different lattice sites is minimal .",
    "the localization of the basis functions is also important in applications dealing with the response of the electronic system onto a perturbation confined within a single atomic site , like the orbital magnetization in solids.@xcite    since the idea of construction of `` _ _ ab  initio _ _ models for the strongly - correlated systems '' is still relatively new , there is no clear consensus among researchers working in this area about the origin of apparent differences , accuracy , and the scopes of applicability of their results.@xcite we believe that in such a situation it is very important to make a direct comparison between different methods of calculation of wfs , and prove several theorems regarding both the formulation of the methods and the choice of the computational parameters , which directly control the localization of wfs .",
    "particularly , we will prove rigorously that the downfolding method , considered in refs .",
    ", , and , can be reformulated as a projector - operator method , employed in refs .  , , and ( and , as an initial stage , in ref .  ) .",
    "this can be done by a simple ( scissor - operator - like ) change of the full hamiltonian of the system in the high - energy part of the spectrum , which does not contribute to the low - energy part .",
    "this procedure has been already implemented in refs .  , , and .",
    "therefore , two methods are simply equivalent , and the main difference comes from the form of trial orbitals , which are used to generate the wannier function in the projector - operator method and , directly , the effective low - energy hamiltonian in the downfolding method . concerning the last part of the problem , we will argue that an optimal choice for the trial wavefunctions can be based on the maximization of the site - diagonal part of the density matrix , as it was originally proposed in ref .  .",
    "we will also consider an analogy with the search of the ground state of the many - electron systems .",
    "we assume that there is certain set of orthonormalized atomic - like orbitals @xmath5 centered at the atomic sites @xmath6 and specified by the orbital indices @xmath7 .",
    "the basis is complete and sufficient to reproduce the one - electron band structure of a considered compound in the valent part of the spectrum .",
    "the corresponding hamiltonian matrix is denoted by @xmath0 .",
    "the concrete examples of such bases could be the orthonormalized atomic orbitals or the muffin - tin orbitals.@xcite we further assume that the basis orbitals are maximally localized ( in accordance with a certain criterion of maximal localization , the precise form of which is not important here),@xcite in the sense that any linear combination of @xmath5 will be either less localized or have the same degree of the localization as @xmath5 .",
    "then , we immediately recognize that the basis functions @xmath5 , selected in such a way , satisfy to all criteria of wfs , and can be regarded as one of possible representations of wfs for the full hamiltonian @xmath0 .",
    "indeed , the basis functions @xmath5 are localized , orthonormalized , and ( due to the property of completeness of the basis set ) any eigenvector of @xmath0 in the valent part of the spectrum can be expressed as a linear combination of @xmath5 .",
    "this is a natural result and advantage of using the localized ( or atomic - like ) basis . in the plane - wave basis",
    ", the localized wfs can be constructed from certain number of eigenvectors of @xmath0 in the valent part of the spectrum , for example , by minimizing the square of the position operator @xmath8.@xcite however , we would like emphasize that this is nothing but an elegant way of constructing a compact atomic basis from the extended plane waves , a step which becomes rather unnecessary if one works from the very beginning in an appropriate basis of atomic orbitals .",
    "the precise criterion of the maximal localization ( for example , the minimization of @xmath8 ) is not really important at this stage , because this is merely a mathematical construction and depending on the considered physical property one can introduce different criteria of the `` maximal localization ''",
    ".    however , what we typically need in the process of construction of the model hamiltonians for the strongly - correlated systems is different .",
    "for example , for the solution of the many - electron problem it is practically impossible to operate with a large number of wfs of the full hamiltonian @xmath0 .",
    "instead , one would like to concentrate on the evolution of a small number of bands , located near the fermi level , and construct the wfs only for this group of bands .",
    "a concrete example is the @xmath1 bands in many transition - metal oxides , which are typically well separated from the rest of the spectrum.@xcite of course , the wfs for the @xmath1 bands should be orthogonal to the rest of the eigenstates of the full hamiltonian @xmath0 .",
    "this causes an additional complication and the basis functions @xmath5 , though can be regarded as wfs for the full hamiltonian @xmath0 , are no longer the wfs for a limited subspace of eigenstates of @xmath0 , restricted by the @xmath1 bands .",
    "at present , there are two methods , which are commonly used for the construction of wfs for a restricted number of states of the full hamiltonian @xmath0 : the projector - operator method ( for example , employed in refs .  , , , and ) and the downfolding method ( employed in refs .  , , and ) .      in the projector - operator method ,",
    "each ( nonorthonormalized ) wannier function is generated by projecting a trial basis function @xmath9 centered at the site @xmath10 onto a chosen subset of bands ( for instance , the @xmath1 bands , located near the fermi level ) : @xmath11 where @xmath12 is the projector - operator onto the @xmath1 bands , @xmath13 denotes the eigenstate of @xmath0 , and @xmath14 is a joint index combining the band index and the position of the momentum @xmath4 in the first brillouin zone .",
    "the effective tight - binding hamiltonian @xmath15@xmath16@xmath17 in the region of @xmath1-bands is constructed from the matrix elements of @xmath0 in the basis of these wannier states : @xmath18 the orbitals @xmath19 shall be further orthonormalized : @xmath20_{{\\bf r}'{\\bf r}}^{t't } , \\label{eqn : orthonormalization}\\ ] ] where @xmath21@xmath16@xmath22 is the overlap matrix : @xmath23 then , the effective tight - binding hamiltonian @xmath24 in the basis of orthonormalized wannier orbitals @xmath25 takes the following form : @xmath26 @xmath24 is typically regarded as the kinetic - energy part of an effective hubbard - type model in the projector - operator method.@xcite    for the subsequent discussions , it will be also convenient to write the overlap matrix @xmath21 in the form : @xmath21@xmath16@xmath27 , where @xmath27 is the block of matrix elements of the projector operator ( [ eqn : projector ] ) in the basis of trial orbitals @xmath28 .",
    "since @xmath29 commutes with @xmath0 , the projector - operator method guarantees that @xmath24 has the same set of eigenvalues in the region of @xmath1-bands as the original hamiltonian @xmath0 .",
    "the conventional downfolding method also implies that all atomic basis functions can be divided into two parts : @xmath30@xmath16@xmath31@xmath32@xmath33 , so that the low - energy part of the spectrum in the direct proximity to the fermi level is mainly composed of the @xmath31-states , while @xmath33 is the rest of the basis states , which mainly contribute to the high - energy part .",
    "then , each eigenstate @xmath34 of the full hamiltonian @xmath0 can be presented identically as the sum @xmath35@xmath16@xmath36@xmath37@xmath38 , where @xmath36 and @xmath38 are expanded over the basis states of correspondingly `` @xmath39''- and `` @xmath40''-type , and the matrix equation for @xmath34 takes the form : @xmath41 where @xmath42 are the blocks of matrix elements of @xmath0 in the basis of `` @xmath39''(``@xmath40'')-states .",
    "then , @xmath43 can be expressed from eq .",
    "( [ eqn : seceq2 ] ) as @xmath44 and substituted into eq .",
    "( [ eqn : seceq1 ] ) .",
    "this yields an effective @xmath45-dependent hamiltonian , which acts formally only on @xmath46 : @xmath47 however , @xmath46 is only a part of the eigenvector , which is not orthonormalized .",
    "therefore , @xmath48 should be additionally transformed to an orthonormal basis : @xmath49 this transformation is specified by the overlap matrix @xmath50 which is obtained after the substitution of @xmath43 , given by eq .",
    "( [ eqn : relimination ] ) , into the normalization condition for the full eigenvector @xmath34 : @xmath51@xmath37@xmath52@xmath16@xmath53 .",
    "@xmath54 , which is typically calculated in the center of gravity of the low - energy bands ( @xmath55 ) constitutes the kinetic - energy part of the effective hubbard - type model in the downfolding method.@xcite    although the downfolding method does not explicitly require the construction of wfs , they are certainly implied also in this approach and , at least , can be formally reconstructed from @xmath54.@xcite      the conventional downfolding method is exact .",
    "however , this property is enforced by the @xmath45-dependence of @xmath56 , which is hardly useful from the practical point of view .",
    "formally , for each @xmath13 , @xmath45 in eq .",
    "( [ eqn : tb ] ) should coincide with the eigenvalue of @xmath0 corresponding to this @xmath13 .",
    "moreover , @xmath57 retains an excessive information about @xmath0 , and the full spectrum of eigenvalues and eigenfunctions of the original hamiltonian @xmath0 can be formally derived from @xmath57 .",
    "however , typically we do not need such a redundant information and would like to use @xmath56 only in order to describe a small group of electronic states located near the fermi level , and do it in the most exact form .",
    "therefore , what we want to do next is to show that in a restricted subspace of eigenstates @xmath58 of the original hamiltonian @xmath0 , the downfolding method can be reformulated as a projector - operator method and retains all attractive features of the latter : namely , it becomes exact and does not depend on @xmath45 .",
    "the trick ( which was actually implemented in refs .   and ) is to replace the original hamiltonian @xmath0 in the downfolding method by certain modified hamiltonian @xmath59 , which has the same set of eigenvalues @xmath60 and eigenfunctions @xmath61 in the region of @xmath1-bands .",
    "the rest of the eigenstates is not important for our purposes and can be shifted from the valent part of the spectrum to the region of infinite energies , specified by the parameter @xmath62 .",
    "hence , the modified hamiltonian @xmath59 can be taken in the form : @xmath63 where @xmath64@xmath16@xmath65@xmath66@xmath29 is the projector operator to the subspace orthogonal to the @xmath1-bands . according to the choice of the @xmath31- and @xmath33-basis functions in the downfolding method ,",
    "the latter mainly contribute to the high - energy part of the spectrum , and the overlap between @xmath13 and any linear combination of @xmath33 should be small for the low - energy bands .",
    "therefore , all eigenvalues of @xmath67 are of the order of @xmath62 and located in the high - energy part of the spectrum .",
    "then , it is intuitively clear that , for @xmath62@xmath68@xmath69 , the @xmath45-dependence in eq .",
    "( [ eqn : relimination ] ) can be neglected .",
    "therefore , the method should be exact and not depend on @xmath45 . in order to prove it rigorously ,",
    "it is convenient to use the idempotency of the projector operator : @xmath70@xmath16@xmath64 .",
    "this yields the following identities for the matrix elements @xmath71 in the basis of `` @xmath39''(``@xmath40'')-states : @xmath72 @xmath73 and @xmath74 then , using eqs .",
    "( [ eqn : palgebra1 ] ) , ( [ eqn : palgebra2 ] ) , and ( [ eqn : palgebra3 ] ) , one can prove the following identities , which are valid for the modified hamiltonian ( [ eqn : modifiedh ] ) in the limit @xmath62@xmath68@xmath69 :    1 .",
    "the overlap matrix ( [ eqn : overlapdf ] ) becomes @xmath75 which is the inverse overlap matrix of the projector - operator method ( [ eqn : overlapp ] ) ; 2 .",
    "therefore , all terms proportional to @xmath62 in the hamiltonian ( [ eqn : heff ] ) are exactly cancelled out ; 3 .   the @xmath45-dependent part of the hamiltonian ( [ eqn : heff ] ) can be transformed to the form : @xmath66@xmath77 ; 4 .",
    "the remaining part of the hamiltonian ( [ eqn : heff ] ) , which depends neither on @xmath62 nor on @xmath45 takes the following form : @xmath78@xmath66@xmath79@xmath66@xmath80@xmath37@xmath81 , where @xmath82 stand for the matrix elements of the operator @xmath83 in the basis of `` @xmath39''(``@xmath40'')-states .    moreover , it is easy to see that @xmath78 coincides with the hamiltonian matrix ( [ eqn : hamiltonianp ] ) of the projector - operator method prior the orthonormalization . then , by replacing one of the projector operators @xmath29 in @xmath84 by @xmath85 and writing explicitly the product of two operators in the basis of `` @xmath39''(``@xmath40'')-states , one obtains the following identities : @xmath86 @xmath87 and @xmath88 using these properties , it is straightforward to verify that the hamiltonian matrix ( [ eqn : heff ] ) of the downfolding method takes the following form : @xmath89 then , the orthonormalization transformation ( [ eqn : tb ] ) yields the following tight - binding hamiltonian : @xmath90 which is totally equivalent to the tight - binding hamiltonian ( [ eqn : tbp ] ) obtained in the projector - operator method .",
    "thus , we have proven that by introducing the modified hamiltonian of the form ( [ eqn : modifiedh ] ) , the downfolding method can be naturally reformulated as the projector - operator method",
    ". therefore , as long as we are interested in the low - energy properties of the system , these two methods are equivalent .    here",
    ", one comment is in order . in our proof , we have used the fact that the overlap between @xmath33 orbitals and the eigenstates @xmath61 of the hamiltonian @xmath0 should be small for the low - energy bands .",
    "however , this implies a specific choice for the orbitals @xmath33 ( and also for @xmath31 ) , for which the equivalence between the downfolding and the projector - operator methods actually takes place .",
    "if this property is not satisfied , and the overlap between @xmath33 and @xmath61 is large , the downfolding method will eventually breaks down , as we will clearly see it in our calculations for v@xmath2o@xmath3 below .",
    "the equivalence between downfolding and projector - operator methods appears to be more generic and has a direct implication to the theory of many - electron systems .",
    "indeed , any many - electron state @xmath91 can be expanded over the basis of slater determinants @xmath92 , which play the same role as atomic orbitals in the one - electron version of the downfolding method .",
    "suppose that the many - electron ground state is nondegenerate and one can identify a single slater determinant ( @xmath93 ) , which has the largest weight in the many - electron wavefunction @xmath94 corresponding to the ground state . in practice , such @xmath95 can be obtained in the frameworks of one - electron hartree - fock ( or any other ) theory .",
    "then , each @xmath91 can be formally presented in the form @xmath96@xmath16@xmath97@xmath37@xmath98 , where @xmath97 is the part proportional to @xmath99 and @xmath98 is expanded over the rest of the basis of slater determinants .",
    "@xmath100 can be further eliminated by applying the downfolding method to the true many - electron hamiltonian @xmath101 and its eigenfunctions @xmath102 . by doing so , the solution of the many - electron problem can be reformulated in terms of an @xmath45-dependent self - energy @xmath103,@xcite in a restricted hilbert space of many - electron states , which is formally spanned by only one slater determinant @xmath104 .",
    "nevertheless , such a self - energy contains all information about the ground state as well as the excited states of the many - electron system , which is formally incorporated into the @xmath45-dependence of @xmath105 .",
    "however , the analysis presented in our work clearly shows that if we are interested only in the ground - state properties of the many - electron system , the problem can be reformulated in terms of the projection onto the true ground state @xmath106@xmath16@xmath107 . in this case , the slater determinant @xmath99 plays the role of the trial wavefunction , which makes a formal correspondence between the true many - electron ground state @xmath94 and an auxiliary state of independent quasiparticles , represented by @xmath99 .",
    "as long as we are concerned with the ground - state properties , such a formulation is exact and does not depend on @xmath45 .",
    "of course , the direct application of the projector - operator method to the many - electron problem is hardly meaningful from the practical point of view , because it implies the knowledge of the true many - electron ground state @xmath94 at the first place .",
    "however , this simple example , suggested by the projector - operator method , clearly shows that , in principle , the procedure of obtaining the total energy of a many - electron system can be formulated :    * in a restricted hilbert space , which is spanned by only one slater determinant ; * in terms of an @xmath45-independent self - energy ( or an effective potential ) .",
    "this is a simple but exact property of the total energy of a many - electron system , which does not relies on any approximations .",
    "it reminiscences some basic theorems of the density - functional theory ( dft),@xcite and provides some insight into why the same many - electron problem can be formulated in two seemingly different ways , one of which is dft and the other one is the self - energy approach .",
    "now let us come back to the construction of wfs and specify the choice of the trial orbitals @xmath31 .",
    "as it was already pointed out in the introduction , the basis functions @xmath5 can be regarded as wfs of the full hamiltonian @xmath0 .",
    "each basis function is localized around a central atomic site and satisfy certain criterion of the `` maximal localization '' such that any linear combination of @xmath5 will be `` less localized '' or at least have the same degree of the localization as the original basis set @xmath5 . however",
    ", this is not necessarily true if one wants to construct the wfs only for some part of the electronic structure , specified by certain ( restricted ) set of eigenstates @xmath61 of the hamiltonian @xmath0 . due to the additional orthogonality condition to other bands , such a wannier function",
    "will inevitably be a linear combination of @xmath5 and , hence , a less localized function in comparison with the trial atomic orbital @xmath108 .",
    "nevertheless , one can formulate the problem in a slightly different way and ask which atomic orbital centered at the single atomic site is the best representation for the wannier orbital . therefore , we search a new set of orthonormalized trial orbitals in the form : @xmath109 and find the coefficients @xmath110 from the condition that maximizes the projections @xmath111 \\rangle$ ] , where @xmath112\\rangle$ ] is the nonorthonormalized wannier function constructed from @xmath113 using the projector - operator method : @xmath112\\rangle$]@xmath16@xmath114 .",
    "it will automatically guarantee that @xmath113 is the best single - orbital representation for the wannier function in the projector - operator method among the trial orbitals of the form ( [ eqn : newtrial ] ) . by substituting @xmath112\\rangle$ ] into expression for the projection @xmath111 \\rangle$ ]",
    ", one can easily find that the problem is reduced to the maximization of the functional @xmath115 with respect to the coefficient @xmath110 , where the lagrange multipliers @xmath116 enforce the orthonormalization condition for the new trial orbitals ( [ eqn : newtrial ] ) .",
    "then , the maximization of @xmath117 is equivalent to the diagonalization of @xmath118@xmath16@xmath119 , which is nothing but the site - diagonal part of the density matrix constructed for the @xmath1 bands in the basis of atomic orbitals @xmath120 . after the diagonalization",
    ", we should simply pick up @xmath121 eigenstates @xmath122 , corresponding to the @xmath121 maximal eigenvalues @xmath116 , where @xmath121 is the number of wannier orbitals centered at the atomic site @xmath10.@xcite these @xmath122 will automatically maximize @xmath117 .",
    "this procedure has been proposed in ref .   without proof .",
    "then , some intuitive arguments in support of the diagonalization of the density matrix have been given in ref .  .",
    "here , we have argued that it can be derived on the basis of a rigorous variational principle .",
    "the simplest model , which nicely illustrates the main idea of the previous section is the one - dimensional chain of atoms @xmath123 ( though the spacial dimensionality is not really important here because a similar conclusion can be obtained in two and three dimensions ) .",
    "we assume that the atomic basis at each site consists of two orthonormal orbitals , say @xmath124 and @xmath125 .",
    "the full hamiltonian @xmath0 is specified by two parameters : the splitting @xmath126 between atomic levels @xmath53 and @xmath127 , and the nearest - neighbor transfer integral @xmath39 ( @xmath128@xmath129 ) , which is assumed to be the same for all pairs of orbitals , @xmath130 the hamiltonian can be easily diagonalized in the reciprocal ( @xmath131 ) space .",
    "this yields two eigenstates : @xmath132 and @xmath133 .",
    "our goal is to construct the wfs for the lowest eigenstate @xmath132 , which can be presented as @xmath134 where @xmath135 and @xmath136 are the fourier transforms of @xmath137 and @xmath138 , respectively , and @xmath139 is nonnegative ( that is defined by a proper choice of the phase of @xmath132 ) .",
    "if @xmath126 is large , this eigenstate will be composed mainly by the atomic orbitals of the first type , i.e. @xmath137 , which correspond to the largest diagonal matrix elements of the density matrix .",
    "therefore , according to the procedure considered in the previous section , in order to obtain the maximally localized representation for the wfs , @xmath137 should be used as the trial orbitals .",
    "now , imagine that we do not know this property and continue to use for the trial orbital @xmath140 a linear combination of @xmath124 and @xmath125 : @xmath141 then , what will happen",
    "?    it is straightforward to verify that the wannier function @xmath142 ( in the reciprocal space ) obtained after the projection of @xmath124 onto @xmath143 and the orthonormalization ( [ eqn : orthonormalization ] ) takes the following form @xmath144 | \\psi_k^- \\rangle,\\ ] ] where @xmath145 $ ] stands for the sign of the argument .",
    "this means that @xmath142 differs from @xmath132 by a phase , which is controlled by @xmath146 and depends on @xmath131 . for small @xmath146 , @xmath147@xmath66@xmath148$]@xmath16@xmath53 for all @xmath131",
    "therefore , @xmath142 is a smooth function in the reciprocal space and its fourier image is well localized in the real space ( fig .",
    "[ fig.wfmodel ] ) .",
    "however , when the angle @xmath146 increases ( and starting from certain critical value of @xmath146 ) , @xmath147@xmath66@xmath148 $ ] becomes a _ discontinuous function _ of @xmath131 .",
    "the position of this discontinuity depends both on @xmath146 and on the ratio @xmath149 .",
    "certainly , the discontinuity will affect the spread of wfs and make them much less localized in the real space .",
    "thus , the model nicely illustrates the connection of the localization of the wfs in the real space with the problem of phase of the bloch waves in the reciprocal space .",
    "the degree of localization of the wfs in the real space as a function of @xmath146 is explained in fig .",
    "[ fig.localizationmodel ] .    for @xmath146@xmath16@xmath129 ,",
    "when the trial orbital corresponds to the largest eigenvalue of the local density matrix , the wannier function spreads only over the central and nearest - neighbor atomic sites ( which for @xmath149@xmath16@xmath66@xmath150 accumulate @xmath151% of the total weight of the wannier function ) . when the angle @xmath146 increases , the weight of the wannier function transfers ( abruptly , starting from certain value of @xmath146 ) from the central part to more remote atomic sites .",
    "hence , the wannier function becomes less localized .",
    "this is clearly manifested in the extremely slow convergence of the total weight of the wannier function in the real space ( for example , for @xmath149@xmath16@xmath66@xmath150 and @xmath146@xmath16@xmath152 , @xmath151% of the total weight can be regained only after including about 200 coordination spheres around the central site ) .",
    "let us discuss the behavior of the model hamiltonian for the low - energy band in the wannier basis .",
    "the kinetic - energy part of the model hamiltonian ( [ eqn : tbp ] ) is a quadratic function of @xmath153 .",
    "moreover , since @xmath0 is periodic in the real space , its matrix elements will be diagonal with respect to the momentum @xmath131 in the reciprocal space : @xmath154@xmath16@xmath155 .",
    "therefore , the phase @xmath147@xmath66@xmath148 $ ] does not contribute to @xmath154 , and the kinetic - energy part of the model hamiltonian _ will not depend on the form of the trial orbitals_. however , for the coulomb ( and exchange ) matrix elements , the situation can be different .",
    "although the bare coulomb interaction is also periodic in the real space , this is a two - particle interaction , and its matrix elements in the reciprocal space will contain a combination of the four wannier orbitals : @xmath156.@xcite in this case there will be no phase cancelation , and the matrix elements of the coulomb interaction will generally depend on the form of trial orbitals .",
    "then , one may ask which representation is better ?",
    "of course , all are equivalent and the main question here is whether we would like employ some additional approximations or not .",
    "a typical approximation is to retain only the site - diagonal part of coulomb ( and exchange ) matrix elements in the real space,@xcite which may be justified only in the basis of localized wfs ( i.e. , for @xmath146@xmath16@xmath129 in the considered example ) .",
    "then , it is reasonable to expect the matrix elements between different lattice sites to be smaller in comparison with the site - diagonal part .",
    "however , the same approximation is no longer valid for @xmath146@xmath16@xmath152 , where intersite interactions can be of the same order of magnitude as the site - diagonal ones and , therefore , can not be dropped .",
    "now let us illustrate how the same procedure works for more realistic systems .",
    "for these purposes we pick up rather typical ( and , in some sense , canonical ) example of v@xmath2o@xmath3 ( the space group is @xmath157 , no . 167 in the international tables ) .",
    "the sketch of the crystal structure as well as the positions of the main bands of v@xmath2o@xmath3 in lda are summarized in fig .",
    "[ fig.v2o3strucdos ] ( more detailed information about the lattice parameters and the basis functions used the lmto calculations can be found in ref .  ) .",
    "since each v is surrounded by six oxygen sites , which form a distorted octahedron , the v(@xmath158 ) states are split into the v(@xmath158-@xmath1 ) and v(@xmath158-@xmath159 ) bands , so that the former ones are located near in the low - energy part of the spectrum and crossed by the fermi level within lda .",
    "the trigonal distortion of the vo@xmath160 octahedra will further split the v(@xmath158-@xmath1 ) levels into one - dimensional @xmath161 and two - dimensional @xmath162 representations .",
    "since the @xmath159 and @xmath162 orbitals belong to the same representation of the point symmetry group , they will mix .",
    "the magnitude of this mixing is no longer controlled by the symmetry of the system , and can be different for different quantities ( depending on how these quantities are constructed from the wavefunctions of v@xmath2o@xmath3 ) . in the following , we will call as `` the @xmath162 orbitals associated with a site @xmath10 '' two eigenstates of the @xmath163 symmetry obtained from the diagonalization of the density matrix @xmath118@xmath16@xmath119 , constructed from the @xmath1 bands , and corresponding to two largest eigenvalues @xmath116 of @xmath118 .",
    "two other eigenstates of the @xmath163 symmetry for which @xmath116 are considerably smaller will be called as the @xmath159 orbitals ( in realistic calculations for v@xmath2o@xmath3 , @xmath164 is about @xmath165 and @xmath166 for the @xmath163 orbitals of the @xmath167 and @xmath168 type , respectively ) .",
    "thus , the situation is similar to the toy model considered in sec .",
    "[ sec : toy ] .",
    "then , we take trial orbitals of the @xmath163 symmetry in the form @xmath169 and construct wfs for the @xmath1 bands . in this expressions , @xmath170 and @xmath171",
    "were obtained from the diagonalization of the local density matrix , and @xmath146 controls the mixing of the @xmath163 orbitals of the @xmath167 and @xmath168 types . on the contrary , the trial orbital of the @xmath161 symmetry",
    "is uniquely determined by the symmetry of the system .",
    "then , according to the arguments of sec .  [",
    "sec : trial ] , @xmath146@xmath16@xmath129 should pick up the most localized representation for wfs .",
    "this effect is clearly seen in our calculations , though there is an important differences from the model considered in sec .",
    "[ sec : toy ] . note that in the multi - orbital case , the form of wfs in the reciprocal ( @xmath4 ) space is controlled by a _ matrix _ @xmath172@xmath16@xmath173 ( rather than a single phase factor ) , which generates a new set of wfs after the transformation:@xcite @xmath174 in such a case , the change of @xmath146 will generally induce the change of the whole matrix @xmath172 [ for example , through the additional orthonormalization transformation ( [ eqn : orthonormalization ] ) ] , which makes some difference from the model analysis presented in sec .",
    "[ sec : trial ] .",
    "for instance , there will be no cancelation of @xmath172 in the expression for the matrix elements of @xmath0 in the wannier basis .",
    "therefore , such matrix elements will generally depend on the representation @xmath146 .",
    "nevertheless , we have also observed an abrupt change of wfs in the region of large @xmath146 , in a close analogy with results of the model analysis in fig .",
    "[ fig.localizationmodel ] .",
    "first , let us discuss the results obtained using the downfolding method for the modified hamiltonian ( [ eqn : modifiedh ] ) , which are shown in fig .",
    "[ fig.v2o3localization ] . in practical calculations we set @xmath62@xmath16@xmath175 ry .",
    "then , the downfolding method remains stable only up to @xmath146@xmath16@xmath176 . for larger @xmath146",
    ", some eigenvalues of @xmath67 can fall into the low - energy part of the spectrum , and the whole procedure becomes meaningless .",
    "the wfs have been reconstructed from the tight - binding hamiltonian ( [ eqn : tbp ] ) using the method proposed in ref .  , which is stable up to @xmath146@xmath16@xmath177 .",
    "as the angle @xmath146 increases , the weight of the wannier function of the @xmath163 symmetry at the central v site decreases from @xmath178 to @xmath179 ( i.e. , by 5% ) , and the expectation value of @xmath180 , calculated on these wfs , increases from @xmath181 to @xmath182 @xmath183 ( i.e. , by nearly 30% ) .",
    "hence , the wfs become less localized .",
    "is it a big effect or not ?",
    "in fact , everything depends on the considered property .",
    "for example , by assuming for a while that all weight of the wannier function is uniformly distributed over the sphere of the radius @xmath184,@xcite we can estimate ( very roughly ) the change of the bare coulomb interaction as 12% , which is an appreciable value .",
    "it is interesting to note that with the increase of @xmath146 , the degree of localization of the wfs of the @xmath161 symmetry also decreases , though the effect is considerably smaller .",
    "this is not surprising , and the @xmath161 functions should inevitably change because of the additional orthogonalization of them to the @xmath163 orbitals . note that although the @xmath185 and @xmath186 orbitals are orthonormal at the same v site , the matrix elements @xmath187 between different atomic sites @xmath10 and @xmath188 are generally nonzero .",
    "therefore , the wfs of the @xmath161 and @xmath163 symmetry should be additionally orthonormalized , and this transformation depends on the value of @xmath146 .",
    "the same effects leads to the existence of nonvanishing transfer integrals between @xmath161 and @xmath163 orbitals , which are defined as the matrix elements of the tight - binding hamiltonian @xmath189 for @xmath10@xmath190@xmath188 .",
    "it is also instructive to consider other possibilities for trial orbitals , which are found from other principles , and not directly related with the diagonalization of the density matrix .",
    "one possible choice is the @xmath163 orbitals corresponding to the ideal trigonal environment .",
    "for the site 1 depicted in fig .",
    "[ fig.v2o3strucdos ] such orbitals have the following form:@xcite @xmath191@xmath37@xmath192 and @xmath193@xmath66@xmath194@xmath66@xmath195 .",
    "another possibility is the so - called `` crystal - field orbitals '' obtained from the diagonalization of the site - diagonal part of a more general @xmath196@xmath197@xmath196 tight - binding hamiltonian , constructed in the basis of all v(@xmath158 ) orbitals.@xcite both constructions yield less localized wfs of the @xmath163 symmetry in comparison with the ones obtained from the diagonalization of the local density matrix .",
    "nevertheless , the difference is very small ( for example , @xmath8@xmath16 @xmath198 and 2.470 @xmath183 for the ideal trigonal orbitals and the crystal - field orbitals , respectively ) , suggesting that in the case of v@xmath2o@xmath3 , a good starting point for the construction of wfs can be deduced from some other ( for example , geometrical ) consideration .",
    "unfortunately , this rule can not be applied equally well for other compounds .",
    "for example , one clear exception is the distorted perovskite oxides , where the parameters of the tight - binding hamiltonian in the real space are extremely sensitive to the choice of the local coordinate frame , which is not unique and , therefore , the construction of the trial orbitals by means of the diagonalization of the local density matrix seems to be the most reliable approach.@xcite    in the multi - orbital case , the degree of localization of the wfs is related with the distribution of the transfer integrals , and it is reasonable to expect that less localized wfs will produce longer - range interactions in the real space .",
    "this is clearly seen in the behavior of averaged transfer integrals in fig .",
    "[ fig.v2o3localization ] .",
    "if for @xmath146@xmath16@xmath199 all nonvanishing transfer integrals are confined within the radius @xmath200@xmath201@xmath202 (including 16 coordination spheres of the v atoms ) , those for @xmath146@xmath16@xmath176 have a much longer tail spreading up to @xmath200@xmath16@xmath203  .",
    "at the same time , the energy dispersion obtained after the diagonalization of the tight - binding hamiltonian in the reciprocal space , @xmath204@xmath16@xmath205 , is practically identical for @xmath146@xmath16 @xmath129 and @xmath176 , and well reproduce the behavior of the original lmto bands ( fig .",
    "[ fig.v2o3ek ] ) .",
    "finally , let us discuss the results of the projector - operator method .",
    "they are summarized in fig .",
    "[ fig.v2o3po ] , showing the weight of wfs at the central v site as a function of @xmath146 and the convergence of the total weight of wfs in the real space for two types of trial orbitals , which are again specified by the parameter @xmath146 . when the angle @xmath146 is not particularly large so that the downfolding method is applicable , these methods are identical , as it follows from the rigorous proof in sec .",
    "[ sec : downfoldingasprojector ] .",
    "for example , the behavior of the central weight in fig .",
    "[ fig.v2o3po ] is practically identical ( within the numerical accuracy , which is caused by slightly different details of calculations ) to that obtained for the downfolding method ( fig .",
    "[ fig.v2o3localization ] ) .",
    "however , the projector - operator method , which can be supplemented practically with any type of the trial orbitals , allows us to consider more extreme scenarios .",
    "for example , what may happen if our guess about the form of trial orbitals was totally wrong ?",
    "this situation is nicely illustrated by results of our calculations for @xmath146@xmath16@xmath152 ( i.e. , by choosing the trial @xmath163 orbital in an orthogonal subspace to that , which maximizes local part of the density matrix ) . in this case",
    "the wannier function simply `` blows up '' , and its total weight does not fully converge even within @xmath200@xmath206@xmath207    around the central v site.@xcite thus , the situation is very similar to the model analysis in sec .",
    "[ sec : toy ] and apparently related with the discontinuity of the transformation matrix ( [ eqn : transformationmatrix ] ) in the reciprocal space .",
    "we have considered the problem of construction of the wannier functions in the first - principles electronic structure calculations starting from localized atomic orbitals .",
    "there is a number of methods , which are used for these purposes .",
    "we have argued that some of them can be unified and formulated in an absolutely exact and identical way .",
    "we have demonstrated this idea for two quite a popular nowadays branches of methods : the so - called projector - operator method ( considered , for example , in refs .  , , and ) and the downfolding method ( considered in refs .  , , and ) .",
    "we believe that such an analysis will help to resolve a number of controversies existing in this area .",
    "of course , identical methods should produce identical results , and we have shown that the root of the differences between different applications is related with the choice of the trial orbitals , which are used in order to generate the wfs in the projector - operator method or the basis functions for the construction of the effective tight - binding hamiltonian in the downfolding method .",
    "we believe that it would be very important in the nearest future to make a similar analysis and generalizations for the order-@xmath208 muffin - tin orbital ( nmto ) method.@xcite however , it is beyond our present abilities .",
    "the trial orbitals effectively control the localization of wfs . to this end , we have argued that an optimal choice for the trial orbitals can be obtained by maximizing the site - diagonal part of the density matrix , constructed from the bands of interest .",
    "our numerical calculations show that such a construction already provide a good degree of localization for wfs . of course",
    ", depending on the purposes , one can further optimize the wfs ( for example , by minimizing @xmath8 or any other quantity).@xcite however , as a starting point in this procedure one can always use the wfs generated by minimizing the site - diagonal part of the density matrix .",
    "this is simple and very efficient procedure .",
    "we have also shown that some deviations from this principle and selection of the trial orbitals in an arbitrary form may lead to a substantial delocalization of wfs in the real space , which is related with discontinuity of their phase in the reciprocal space .",
    "the work of i.  v. solovyev has been partially supported by grant - in - aids for scientific research in priority area `` anomalous quantum materials '' from the ministry of education , culture , sports , science and technology of japan .",
    "z.  v. pchelkina and v.  i. anisimov acknowledge the support by russian foundation for basic research under the grants rffi-04 - 02 - 16096 and rffi-06 - 02 - 81017 .",
    "z.  v. pchelkina also acknowledges the support from the research council of president of the russian federation ( grant no .",
    "2006.2 ) , russian science support foundation , dynasty foundation , and international center for fundamental physics in moscow .",
    "v.  i.  anisimov , d.  e.  kondakov , a.  v.  kozhevnikov , i.  a.  nekrasov , z.  v.  pchelkina , j.  w.  allen , s .- k .",
    "kim , p.  metcalf , s.  suga , a.  sekiyama , g.  keller , i.  leonov , x.  ren , and d.  vollhardt , phys .",
    "b  * 71 * , 125119 ( 2005 ) .                      note that the matrices @xmath209 and @xmath210 have the same set of eigenvectors .",
    "moreover , if @xmath210 is positively defined ( that is specified by the choice of the phase factor in the definition @xmath209@xmath16@xmath210@xmath197@xmath210 ) , these eigenvectors will be arranged in the same order ( i.e. , of decreasing eigenvalues ) .",
    "therefore , the additional orthonormalization of wfs ( [ eqn : orthonormalization ] ) should not change our conclusion .",
    "note that further increase of the radius does not seem to make sense , because our calculations are always performed in the finite mesh of @xmath4-points ( in our case , generated using @xmath207@xmath211@xmath207@xmath211@xmath207 divisions of the reciprocal translation vectors ) .",
    "therefore , for large distances in the real space we inevitably face the problem of accuracy of integration in the reciprocal space ."
  ],
  "abstract_text": [
    "<S> the problem of construction of the wannier functions ( wfs ) in a restricted hilbert space of eigenstates of the one - electron hamiltonian @xmath0 ( forming the so - called low - energy part of the spectrum ) can be formulated in several different ways . </S>",
    "<S> one possibility is to use the projector - operator techniques , which pick up a set of trial atomic orbitals and project them onto the given hilbert space . </S>",
    "<S> another possibility is to employ the downfolding method , which eliminates the high - energy part of the spectrum and incorporates all related to it properties into the energy - dependence of an effective hamiltonian . </S>",
    "<S> we show that by modifying the high - energy part of the spectrum of the original hamiltonian @xmath0 , which is rather irrelevant to the construction of wfs in the low - energy part of the spectrum , these two methods can be formulated in an absolutely exact and identical form , so that the main difference between them is reduced to the choice of the trial orbitals . concerning the latter part of the problem </S>",
    "<S> , we argue that an optimal choice for trial orbitals can be based on the maximization of the site - diagonal part of the density matrix . </S>",
    "<S> this idea is illustrated for a simple toy model , consisting of only two bands , as well as for a more realistic example of @xmath1 bands in v@xmath2o@xmath3 . using the model analysis </S>",
    "<S> , we explicitly show that a bad choice of trial orbitals can be linked to the _ discontinuity _ of phase of the bloch waves in the reciprocal space , which leads to the delocalization of wfs in the real space . </S>",
    "<S> nevertheless , such a discontinuity does not necessary contribute to the matrix elements of @xmath0 in the wannier basis . </S>",
    "<S> similar tendencies are seen in realistic calculations for v@xmath2o@xmath3 , though with some variations caused by the multi - orbital effects . </S>",
    "<S> an analogy with the search of the ground state of a many - electron system is also discussed . </S>"
  ]
}