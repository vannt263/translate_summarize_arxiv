{
  "article_text": [
    "monte carlo ( mc ) simulations @xcite in the gibbs ensemble ( gemc ) of panagiotopoulos @xcite have now been extensively used for several years to study first order phase transitions in classical fluids . according to the gemc method",
    ", the simulation is performed in two boxes each of which contains one of two coexisting phases .",
    "equilibration in each phase is guaranteed by moving particles within the respective box .",
    "equality of pressures is satisfied in a statistical sense by expanding the volume of one of the boxes and contracting the volume of the other .",
    "chemical potentials are equalized by transferring particles from one box to the other .",
    "this procedure avoids either the laborious search for matching free energies calculated separately for each phase , or the simulation of a system large enough to contain both phases and their interface .    notwithstanding the isomorphism between quantum particles and classical ring polymers underlying the path integral formulation of quantum statistical physics @xcite , and the recognition that path integral monte carlo ( pimc ) is a tremendously useful numerical tool@xcite to extract unbiased statistical properties of quantum systems , the development of monte carlo methods for quantum systems is more complex , and correspondingly less complete , than for classical ones .",
    "putting aside the well known sign problem for fermions @xcite an important aspect is the development of methods able to simulate a given quantum system in different statistical ensembles .",
    "recently a new approach to continuous space pimc simulation was devised@xcite which makes use of the `` worm algorithm '' ( wa ) previously employed to study lattice models @xcite .",
    "the wa is formulated in an enlarged configuration space , which features the possible presence of an open world - line , the worm .",
    "it can simulate a system either in the grand canonical or the canonical ensemble , and it enjoys a favorable scaling of the computational cost with the system size for the calculation of properties related to the formation of long permutation cycles@xcite , such as the superfluid fraction or the one - body density matrix .",
    "it is the purpose of the present work to exploit the wa @xcite to obtain an algorithm that is the full quantum analogue of the gemc and thus can be used to study the gas - liquid phase transition of any ( bosonic ) quantum fluid @xcite .",
    "several quantum generalizations of gemc have appeared .",
    "however , some of them only consider particles which have internal quantum states but are otherwise classical@xcite ; others@xcite are limited to particles isomorph to relatively compact classical polymers ( hence high enough temperature and/or small enough quantumness ) ; none of them features the structure of particle exchanges which underlies bose ( or fermi ) statistics .",
    "we apply the quantum gibbs ensemble monte carlo ( qgemc ) method to the liquid - gas coexistence of two - dimensional @xmath1he where strong quantum effects , including superfluidity , are present .",
    "we begin with a brief summary of the gibbs ensemble monte carlo method , that we deem useful for the subsequent quantum generalization .",
    "a detailed presentation is given in ref . .",
    "the system comprises a box of volume @xmath2 containing @xmath3 particles and a box of volume @xmath4 containing @xmath5 particles .",
    "the temperature @xmath6 , the total number of particles @xmath7 , and the total volume @xmath8 are fixed , and there is no interaction between particles enclosed in different boxes .",
    "starting from the partition function for the gibbs ensemble @xmath9 where @xmath10 is the canonical partition function , the probability density for the coordinates @xmath11 of the particles , the number @xmath3 and the volume @xmath2 can be cast in the form @xmath12 here @xmath13 and the potential energy in the boltzmann weight , assuming a central pair potential @xmath14 , is @xmath15 the monte carlo simulation proceeds via three kinds of moves :    \\(1 ) displace the position @xmath16 of a randomly selected particle within its own box ; this is done as in standard canonical ensemble simulations .",
    "\\(2 ) change the volumes ; this is done by uniformly sampling a displacement of the quantity @xmath17 , with @xmath18 kept fixed .",
    "\\(3 ) exchange particles ; this is done by transferring a randomly chosen particle to a random position in the other box .",
    "the acceptance probabilities are obtained imposing detailed balance@xcite .",
    "after equilibration , provided @xmath19 is within the coexistence region at the temperature @xmath6 , each of the two boxes will contain one of the coexisting phases .",
    "the qgemc is based on the path integral monte carlo method in the worm algorithm implementation .",
    "we refer to the literature @xcite for a full account of these techniques , giving here only a brief discussion of some aspects relevant to the quantum generalization of the classical gemc .",
    "we consider an assembly of @xmath20 identical particles obeying bose statistics . in the position representation ,",
    "the canonical partition function is @xmath21 where @xmath22 is the thermal density matrix for distinguishable particles , and the sum over the permutations @xmath23 accounts for bose symmetry .",
    "the density matrix can be expressed in a form amenable to monte carlo simulation in terms of discretized path integrals : @xmath24 with @xmath25 , @xmath26 , and @xmath27 a sequence ( path ) of intermediate configurations .",
    "an adjacent pair @xmath28 is called a _",
    "link_. in eq .",
    "( [ rho_beta ] ) the factors @xmath29 have an argument @xmath30 which corresponds to a temperature @xmath31 times higher than @xmath6 , and for high temperature the unknown many - body density matrix can be accurately approximated by an explicit expression of the general form @xmath32 where @xmath33 is the density matrix for @xmath20 non - interacting particles in @xmath34 spatial dimensions , and the function @xmath35 takes into account the effect of correlations . in the limit @xmath36 , @xmath37 approaches @xmath38 and the approximate equality ( [ rho_beta ] ) becomes exact .    for each particle , eq .",
    "( [ rho_beta ] ) defines a trajectory , or world line ( wl ) , @xmath39 , where the _ bead _",
    "@xmath40 is the position of the @xmath41th particle at the @xmath42th `` time '' discretization index . in the calculation of thermal averages ,",
    "@xmath43 , the presence of the traces and the bose symmetry of eq . ( [ canonical_z ] ) require periodic boundary conditions in time , @xmath44 : the trajectory of a particle ends in the initial position of either the same or another particle , according to the permutation cycles contained in the permutation @xmath23 .",
    "all the interlinked trajectories of a permutation cycle of @xmath45 particles form a single wl with @xmath46 steps , so that all wls are closed .",
    "the wl of a single particle has a spatial extent limited by the thermal wawelength , while the wl of a long permutation cycle can span the whole system .",
    "the simulation proceeds by sampling a density probability proportional to the integrand of eq .",
    "( [ rho_beta ] ) .",
    "specific techniques are devised to update not only the particle positions along the wls , but also the permutations .",
    "the wls can be mapped onto classical ring polymers , with peculiar interactions defined through eq ( [ rho_beta ] ) by viewing the integrand as a boltzmann weight .",
    "thus it seems possible to apply the gemc method to the quantum system as well .",
    "however , an issue arises with the exchange move : a quantum particle corresponds , in the classical mapping , to a whole polymer , and the acceptance rate for transferring a polymer to the other box can be expected to be low , particularly at low temperature when the thermal wavelength increases and the spatial extension of the polymers grows .",
    "the problem is further compound by the presence of interlinked trajectories belonging to a permutation cycle .",
    "this is why quantum applications of gemc have been limited to relatively high temperature and/or relatively low quantumness@xcite .",
    "we will show how to overcome these difficulties using the wa .",
    "the wa enlarges the configuration space : along with the closed wls of section [ subsec : pimc ] , there are configurations with an open wl in which one particle is created in @xmath47 at time @xmath48 and destroyed in @xmath49 at a later time @xmath50 .",
    "the difference @xmath51 is intended modulo @xmath31 , and the open wl can belong to a permutation cycle involving other particles .",
    "the points @xmath49 and @xmath47 are called ira and masha , respectively , and the wl connecting them is called the _",
    "worm_. configurations with only closed wls belong to the `` z sector '' and contribute to the partition function .",
    "configurations with a worm belong to the `` g sector '' and contribute to the one - body green function @xmath52 .",
    "all physical properties , with the exception of the green function , are calculated only on configurations of the z sector .",
    "the full set of configurations corresponds to the extended partition function @xmath53 where @xmath10 can be either the canonical or the grand partition function , @xmath54 and the arbitrary parameter @xmath55 defines the relative weight of the z and g sectors .",
    "the discretized path integral expression of eq .",
    "( [ z_g ] ) is obtained in close analogy with section [ subsec : pimc ] in terms of @xmath56 .",
    "the simulation proceeds via a set of local moves the complementary pairs _ open _ and _ close _ , _ insert _ and _ remove _ , _ advance _ and _ recede _ , and the self - complementary _",
    "swap_ which guarantee ergodic sampling ot the enlarged configuration space by switching between the z and the g sectors and displacing the coordinates of the particles @xcite .    the usefulness of the wa for the implementation of the qgemc can be appreciated by considering the process of adding a particle to the system ( we assume here that @xmath10 is the grand partition function ) : starting from the z sector , a worm may be _ inserted _ ; once in the g sector , the worm may _ advance _ , possibly _ swap",
    "_ with existing closed wls , and eventually get _ closed _ , thus switching back to the z sector with one more particle .",
    "each single move is a local update that involves only a limited number of time steps , so that the acceptance rate can be high even in a dense system .",
    "we consider @xmath3 particles in a volume @xmath2 and @xmath5 particles in a volume @xmath4 , with @xmath18 , @xmath20 , and @xmath6 fixed ( see section [ sec : cgemc ] ) .",
    "the configurations of the system in the gibbs ensemble are distributed according to the partition function @xmath57 of eq .",
    "( [ z_gibbs ] ) , with each of the canonical partition functions @xmath10 of the two subsystems expressed as discretized path integrals with closed wls , as in section [ subsec : pimc ] .",
    "these configurations define the z sector .",
    "following the strategy of the wa we enlarge the configuration space allowing for open wls , while strictly enforcing the constraint of fixed @xmath20 : whenever there is a worm in box 1 , with masha at @xmath58 and ira at @xmath59 , there is a worm in box 2 as well , with masha at @xmath60 and ira at @xmath61 , as schematically illustrated in fig .",
    "[ fig : g_sector ] .",
    "these configurations define the g sector . in the g sector",
    "the number of particles in box @xmath62 ( @xmath63 ) varies between @xmath64 and @xmath65 , with @xmath66 , and the total number of particles within each link is @xmath20 .",
    "the extended partition function is @xmath67 , where @xmath68 the primed summation excludes the terms with @xmath69 to make sure there is a worm per box in the g sector .",
    "and the function @xmath70 the integral of eq .",
    "( [ z_g ] ) for box @xmath62 is expressed in terms of density matrices as    @xmath71    here the pair @xmath72 indicates the coordinates of masha and of all the other particles of box @xmath62 at time index @xmath42 ( the first argument of @xmath70 ) and @xmath73 the coordinates of ira and of the other particles at @xmath74 .",
    "the argument @xmath75 of the density matrices @xmath76 is the positive interval from @xmath77 to @xmath78 possibly wrapping around the periodic boundary condition , i.e. @xmath79\\epsilon$ ] .",
    "finally , the density matrices are expanded in discretized path integrals using the high temperature approximation @xmath80 as in section [ subsec : pimc ] .    the probability density for all the coordinates @xmath81 in the system , the number @xmath3 and the volume @xmath2 is@xcite @xmath82 where @xmath83 is 1(0 ) in the g(z ) sector",
    ", @xmath84 indicates the positions of all the particles in either box at time @xmath77 , and the dependence on @xmath3 and @xmath2 , as well as all possible permutations of particle labels , are implicitly contained in the configuration @xmath81 .",
    "no sums over permutations appear in @xmath85 because the symmetrizations of eqs .",
    "( [ lunga ] ) or ( [ canonical_z ] ) are carried out concurrently with the monte carlo integration over the coordinates , through updates of the permutation cycles .",
    "we next describe a set of moves which sample the configuration space with probability density @xmath86 .",
    "they are the standard moves of pimc and the wa , in some cases combined in pairs to preserve the two - worm structure of the g sector illustrated in fig .",
    "[ fig : g_sector ] , and the volume change move specific of the gemc method ; the particles exchange move of gemc builds spontaneously through a sequence of wa moves .",
    "the acceptance probabilities are obtained by enforcing detailed balance according to the generalized metropolis algorithm @xcite ( if the current configuration is in a sector where the proposed move is not applicable , the move is rejected immediately ) .    _",
    "( 1a ) open - insert_. this move , schematically illustrated in fig .",
    "[ fig : insert_open ] , is applicable only in the z sector .",
    "it switches from the z to the g sector by opening an existing closed wl in one box and inserting a new open wl in the other box .",
    "a particle is picked randomly , and the links of its wl from @xmath42 to @xmath87 are removed . the time index @xmath42",
    "is uniformly sampled in @xmath88 $ ] , and the number of removed links @xmath89 is uniformly sampled in @xmath90 $ ] , where @xmath91 is a parameter of the simulation which controls the size of the move .",
    "let @xmath62 be the label of the other box .",
    "the initial bead @xmath92 of the new wl is placed at a position @xmath93 randomly sampled in @xmath94 , and @xmath89 further beads are sampled from @xmath95 , where @xmath96 is the one - particle free propagator . the acceptance probability is @xmath97 , where @xmath98 and @xmath99 $ ] is the change of the interacting part of the action @xmath35 between the initial configuration @xmath81 and the proposed configuration @xmath100 .        _",
    "( 1b ) close - remove _ is the complementary move of _ open - insert_. a box say @xmath101 is selected at random . if @xmath102 , the move is rejected .",
    "otherwise , a wl of @xmath89 links connecting @xmath103 to @xmath104 is sampled from @xmath95 .",
    "if the open wl in the other box contains more than @xmath105 links the move is rejected , otherwise the worm is removed .",
    "the acceptance probability is @xmath106 .    _",
    "( 2 ) advance - recede_. this move is self - complementary , as are all the remaining moves .",
    "it applies only to the g sector , and we refer to fig . [",
    "fig : g_sector ] for a representation of the initial configuration .",
    "a box say @xmath101 is selected at random .",
    "an integer @xmath89 is uniformly sampled in @xmath107 $ ] and a time direction is selected at random . if the time direction is positive , a new portion of wl sampled from a product of @xmath89 free - particle propagators is added in box @xmath101 starting from @xmath108 , and a corresponding , @xmath89-link portion of the open wl existing in box @xmath62 is removed , starting from @xmath109 . if the time direction is negative , the new portion of wl is added in box @xmath101 starting from @xmath110 and going backwards in time , and the wl in box @xmath62 is shortened starting from @xmath111 .",
    "the move is rejected if @xmath112 ( this restriction could be avoided using more elaborate combinations of the wa moves ) .",
    "the acceptance probability of _ advance - recede _ is @xmath113 .",
    "_ ( 3 ) swap_. this move applies only to the g sector .",
    "a box is selected at random , and within the chosen box the move proceeds in the same way as in the wa @xcite .    _",
    "( 4 ) volume change_. we choose to apply this move only to configurations of the z sector . for the classical gemc update of the volumes ,",
    "it proves convenient to make the dependence on @xmath3 and @xmath2 explicit .",
    "this is achieved @xcite by rescaling all lengths in box @xmath62 by @xmath114 and formally performing the monte carlo integration over the rescaled coordinates @xmath115 .",
    "furthermore , the move is usually implemented @xcite by changing the quantity @xmath17 , rather than @xmath2 itself , by an amount uniformly sampled in @xmath116 $ ] with @xmath117 a parameter which controls the size of the move .",
    "a factor @xmath118 appears in @xmath119 as a result of rescaling the coordinates , and another factor @xmath120 as a result of updating the logarithm of the volume ( cfr .",
    "( [ p_classical ] ) ) . in the quantum case",
    "we adopt the same changes of variables .",
    "since each particle is mapped onto @xmath31 beads , each of which gets rescaled coordinates , the probability density is @xmath121 the acceptance probability for a move from @xmath2 to @xmath122 is @xmath123 where @xmath124 is the change of the _ full _ action between the initial configuration @xmath81 and the proposed configuration @xmath100 : @xmath125 . \\label{delta_s}\\ ] ] the proposed configuration is @xmath126 , with @xmath127 or @xmath128 as appropriate to the particle index of each component of @xmath81 . hence , both",
    "the equal - time interparticle distances , @xmath129 , and the single - particle displacements along the wl , @xmath130 , are modified upon volume changes .",
    "this prescription departs from that recommended for classical systems of composite particles @xcite , where only the center of mass follows the variation of the volume while the internal structure remains unchanged ( in the quantum analogue , only the centroid ot each ring polymer would change while the size and shape of the polymers would stay fixed @xcite ) .",
    "the reason for the prescription chosen here is that for polymers interlinked through permutation cycles the equal - time interparticle distance and the single - particle paths are not independent .    in our implementation",
    "we also include moves which _ wiggle _ an existing portion of a wl , or _ displace _ the whole wl of a particle .",
    "these moves are standard in pimc @xcite and since they are not strictly needed for the qgemc we do not describe them here .",
    "the phase diagram of @xmath1he in two dimensions has been studied in ref .   by pimc simulations of individual phases for many values of density and temperature .",
    "a gas - liquid coexistence region is found below 0.87 k. at these temperatures , on account of the large de boer parameter of @xmath1he , @xmath131 @xcite , quantum exchange of particles is an important effect@xcite : in the thermodynamic limit the normal - superfluid transition temperature at saturated vapour pressure is 0.65 k @xcite , and for finite systems of a few hundred particles the superfluid fraction is non zero even for @xmath132  k. therefore the gas - liquid coexistence of two - dimensional @xmath1he is a telling test of the qgemc algorithm for a degenerate quantum system .",
    "we simulate a two - dimensional system of @xmath133 @xmath1he atoms distributed between two square boxes with periodic boundary conditions . within each box ,",
    "the atoms interact with the hfdhe2 pair potential @xcite .",
    "we use the primitive approximation @xmath134/2 } \\label{primitiva}\\ ] ] to the high temperature density matrix , with @xmath135 k@xmath136 .",
    "we study the temperature range between 0.125 k and 1 k. for each temperature , the simulation starts from a configuration with boxes of equal volume containing 32 atoms each at a density 0.025  @xmath137 .",
    "after equilibration , deep in the subcritical temperature regime one of the boxes contains a gas of very low density @xmath138 , and the other a superfluid liquid with a density @xmath139 close to the equilibrium density of the system at @xmath140 ( see fig .",
    "[ fig : den ] ) . for",
    "temperatures closer to the critical point , @xmath138 and @xmath139 approach each other , and we frequently observe that the two boxes exchange identity , i.e. the phase of the system in each box switches back and forth between gas and liquid ( see fig . [",
    "fig : den2 ] ) . in this case",
    "the density has a bimodal distribution peaked at the values @xmath138 and @xmath139 of the coexisting phases .",
    "this bimodal distribution can be obtained in a grand canonical simulation of a single box , but this requires a fine tuning of the chemical potential@xcite . for @xmath132  k the two peaks merge into a single gaussian centered at the average density 0.025  @xmath137 .",
    "k. , width=264 ]     k , showing an exchange of identity between the two boxes .",
    ", width=264 ]    our results for the densities @xmath138 and @xmath139 of the coexisting phases are listed in table  [ tab:2d4he ] and displayed in fig .",
    "[ fig : pd ] .",
    "they compare favorably with the results of ref .  .",
    "for each @xmath6 , the latter are obtained from an integral of the isothermal pressure calculated in the canonical ensemble for several values of the density across the coexistence region ; the qgemc method is simpler because @xmath138 and @xmath139 are obtained with a single simulation , either directly or via the analysis of a bimodal distribution .",
    "each of the present qgemc calculations took @xmath141 cpu hours on a 2ghz processor .",
    "if needed , the efficiency could be significantly improved using a better approximation to the high temperature density matrix@xcite .",
    "cll @xmath6  ( k ) & @xmath138  ( @xmath137 ) & @xmath139  ( @xmath137 ) +   + 0.125 & @xmath14210@xmath143 & 0.0422(2 ) + 0.250 & 0.00009(2 ) & 0.0424(4 ) + 0.500 & 0.0016(2 ) & 0.0416(4 ) + 0.750 & 0.0106(6 ) & 0.0396(7 ) + 0.875 & 0.0209(9 ) & 0.0343(10 ) +   + 0.250 & 0.000(2 ) & 0.044(2 ) + 0.500 & 0.000(2 ) & 0.044(2 ) + 0.750 & 0.009(2 ) & 0.043(2 ) + 0.860 & 0.020(2 ) & 0.030(2 ) +    the boundary of the gas - liquid coexistence region is called the binodal line .",
    "it can be extrapolated to the critical point ( cp ) using the law of `` rectilinear diameters '' @xcite , @xmath144 , and the expansion @xcite @xmath145 . here",
    "@xmath146 and @xmath147 , while @xmath148 and @xmath149 are fitting parameters .",
    "we find @xmath150  @xmath137 and @xmath151  k.    he in two dimensions .",
    "black points : qgemc .",
    "blue points : ref .  .",
    "red line : extrapolation of the qgemc results to the critical point ( red triangle ) .",
    ", width=264 ]    finally we list in table [ tab : rhos ] the winding number estimator @xcite of the superfluid fraction @xmath152 for the two phases as a function of the temperature .",
    "a non zero value for the liquid branch of the binodal over the full range of temperatures considered is a clear indication of the importance of quantum exchanges ( although , as mentioned , a finite value of @xmath152 for @xmath153 0.65 k is a finite size effect @xcite ) .    .",
    "the superfluid fraction @xmath152 in the coexisting gas and fluid phases as a function of @xmath6 .",
    "[ cols= \" < , < , < \" , ]",
    "we have presented the qgemc method , a full quantum extension of classical gibbs ensemble monte carlo based on the worm algorithm . the method is demonstrated for the binodal of @xmath1he in two dimensions , a physical property of a strongly quantum system in the degenerate temperature regime .",
    "good agreement is found with the results of previous pimc simulations in the canonical ensemble . in analogy with applications of gemc to classical fluids@xcite , the qgemc method offers a convenient approach for problems such as gas - liquid coexistence in quantum systems and phase equilibria in quantum mixtures ."
  ],
  "abstract_text": [
    "<S> we present a path integral monte carlo method which is the full quantum analogue of the gibbs ensemble monte carlo method of panagiotopoulos to study the gas - liquid coexistence line of a classical fluid . unlike previous extensions of gibbs ensemble monte carlo to include quantum effects , our scheme is viable even for systems with strong quantum delocalization in the degenerate regime of temperature . </S>",
    "<S> this is demonstrated by an illustrative application to the gas - superfluid transition of @xmath0he in two dimensions . </S>"
  ]
}