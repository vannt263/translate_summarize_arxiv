{
  "article_text": [
    "motivated by the goal of sustainable electricity generation , renewables such as solar and wind are of increasing interest as electric energy resources . concomitantly ,",
    "the inherent time variability of such renewable generation is in turn shifting modern power system operation from the traditional  supply follows demand \" paradigm to the one where  demand adapts to supply \" .",
    "this new operational paradigm , called  demand response \" @xcite , can leverage demand side flexibility to offset variability in generation .",
    "of particular interest in this context are thermostatically controlled loads ( tcls ) such as air conditioners . in this paper",
    "we examine how an  aggregator \" also known as a  load serving entity \" ( lse ) , can employ a population of its customers tcls to shape the aggregate power consumption , while adhering to each load s comfort constraints .",
    "we consider an lse buying energy from the day - ahead market for a population of tcls .",
    "we address the question of designing the optimal aggregate power consumption trajectory for this population , given a forecast of day - ahead price trajectory .",
    "modeling the dynamics of a population of tcls has been investigated in several papers @xcite , with the aim to derive control - oriented models that can accurately predict the aggregate power trajectory .",
    "once such a model is obtained , the predominant focus in these and other papers @xcite is to design a model - based setpoint controller to enable the tcl population track a given reference aggregate power trajectory in real - time , thereby compensating possible mismatch between the real - time and forecasted ambient temperatures .",
    "although the availability of a reference power trajectory is tacitly assumed in the literature , in practice the lse needs to determine this reference to minimize the energy procurement cost while guaranteeing that the reference trajectory can be tracked by the aggregate dynamics in such a manner that individual comfort range constraints are met . in @xcite , the range of feasible reference power trajectories",
    "is studied .",
    "to the best of the authors knowledge , the present paper is first to focus on determining the optimal reference power consumption while respecting end users comfort zones .",
    "assuming that the lse is managing a finite population of tcls , we formulate and solve the optimal aggregate power consumption design as a finite horizon deterministic optimal control problem . in the presence of state inequality constraints arising from comfort range contracts between the lse and individual tcls , the optimal controls are shown to depend on the minimum chattering amplitude at the upper and lower comfort boundaries allowable by the thermostat .",
    "our results provide analytical insights on how the lse can use the knowledge of day - ahead price forecast , load forecast , and ambient temperature forecast , for the purpose of energy procurement at least cost .",
    "this paper is organized as follows . in section",
    "ii , we describe the mathematical models . in section iii",
    ", we formulate the design of power consumption as an optimal control problem .",
    "sections iv and v present the solution of the power consumption design problem . in section",
    "vi , numerical results based on the day - head price forecast data from electric reliability council of texas ( ercot ) and the ambient temperature forecast data from a weather station in houston , texas are reported , to illustrate how the lse can use the optimal power consumption trajectory computed via the proposed framework , for the purpose of demand response .",
    "section vii concludes the paper .",
    "we use the symbols @xmath0 and @xmath1 to respectively denote the indicator function , and the lebesgue measure of set @xmath2 .",
    "we use @xmath3 to denote the space of cdlg functions whose range is set @xmath4 . for @xmath5 , we use the notations @xmath6 , @xmath7 , and @xmath8^{+ } : = 0 \\vee a$ ] .",
    "the symbol @xmath9 denotes the composition operator , and spt@xmath10 denotes the support of a function .",
    ", is illustrated for a time - varying ambient temperature @xmath11 .",
    "the comfort temperature interval for the tcl is @xmath12 $ ] with range @xmath13 .",
    "the indoor temperature trajectory @xmath14 $ ] consists of alternating off ( _ blue , up - going _ ) and on ( _ red , down - going _ ) segments , with the boundaries @xmath15 and @xmath16 acting as reflecting barriers for the on and off segments , respectively.,scaledwidth=49.0% ]      the dynamic behavior of an individual tcl is shown in fig .",
    "[ tcldynamics ] . at time",
    "@xmath17 , let us denote the indoor temperature by @xmath18 , and the ambient temperature by @xmath11 . at @xmath19 ,",
    "an occupant privately sets a temperature @xmath20 , called setpoint , close to which the indoor temperature @xmath18 must lie at all times .",
    "if the occupant is willing to tolerate at most @xmath21 temperature deviation from @xmath22 , then we define its  temperature comfort range \" as @xmath12 : = [ s_{0}-\\delta , s_{0}+\\delta]$ ] .",
    "if the setpoint @xmath23 does not change with time , then @xmath24 , and consequently , the comfort boundaries @xmath15 and @xmath16 remain fixed over time . for specificity",
    "we consider the problem of controlling air - conditioning rather than heating , though the theory developed in the sequel applies to both .",
    "the rate of change of @xmath18 is governed by newton s law of heating / cooling given by the ordinary differential equation ( ode ) @xmath25 where @xmath26 is the on / off mode indicator variable of the air - conditioner , given by @xmath27 in other words , @xmath28 indicates that the tcl is in on ( off ) mode . in ( [ individualtcldynamics ] ) , the parameters @xmath29 respectively denote the heating time constant , thermal conductivity , and amount of thermal power drawn by the tcl in on mode .",
    "a parameter @xmath30 called load efficiency , relates the thermal power drawn @xmath31 , with the electrical power drawn @xmath32 , via the formula @xmath33 .",
    "the state of a tcl at time @xmath17 is the tuple @xmath34 .    as shown in fig .",
    "[ tcldynamics ] , starting from an initial condition @xmath35 , the indoor temperature @xmath18 rises exponentially until it hits the upper boundary @xmath16 , at which time an off@xmath36on mode transition occurs , and subsequently @xmath18 decreases exponentially until it hits the lower boundary @xmath15 , at which time an on@xmath36off transition takes place , and so on .",
    "thus , the dynamics of a tcl is hysteretic in the sense that if @xmath37 $ ] , then @xmath38 $ ] for all @xmath39 . while the qualitative behavior shown in fig .",
    "[ tcldynamics ] is true for any @xmath40 , temporal variations of @xmath11 engender time - varying heating / cooling rates for @xmath18 .",
    "we suppose that the lse is exposed to a price forecast @xmath41 and ambient temperature forecast @xmath42 , over a time horizon @xmath43 $ ] .",
    "for example , if @xmath44 hours , and the forecast is done on the previous day , then @xmath41 is the forecasted price from the day - ahead energy market .",
    "we also allow lse to have a target for the total energy @xmath45 consumed over @xmath43 $ ] by the population of @xmath46 tcl customers , managed by the lse .",
    "the choice of @xmath45 may be restricted by the parameters of the tcl population , an issue we address in section [ feasibilitysubsection ] . to minimize its energy procurement cost ,",
    "the lse would like to schedule purchase of energy when @xmath41 is low , and defer purchase when @xmath41 is high , while satisfying the total energy budget ( @xmath45 ) , as well as maintaining the comfort constraints described below specified by each of the tcls .",
    "each of the @xmath46 tcls managed by an lse , may have different comfort ranges @xmath47 $ ] with different tolerances @xmath48 , @xmath49 .",
    "let @xmath50 be the indoor temperature of the @xmath51^th^ home at time @xmath17 .",
    "the lse is obligated to maintain the indoor temperatures of its customer tcls within their specified comfort ranges .",
    "that is , for each @xmath49 , the lse must ensure that @xmath52 $ ] for all @xmath53 .",
    "such an agreement constitutes a contract between the lse and an individual tcl .",
    "an important part of this agreement is the flexibility of a load , captured by its range @xmath54 .",
    "the lse can utilize this flexibility to optimally time its purchase of power .",
    "the lse s business model essentially consists of sharing part of the realized savings with the customers in terms of serving their needs for energy at low cost .",
    "naturally , a customer with a greater flexibility @xmath54 is more valuable to the lse and such customers can obtain better contracts from the lse .      for rest of this paper",
    ", we make the following assumptions .",
    "* the ambient temperature forecast @xmath42 , and price forecast @xmath55 , are continuous functions of time @xmath17 . *",
    "all tcls are cooling , i.e. , for all @xmath56 $ ] , we have @xmath57 . *",
    "each tcl in the population , when on , draws the same thermal power @xmath31 .",
    "further , each tcl is assumed to have same load efficiency @xmath58 .",
    "* w.l.o.g . , the initial indoor temperatures @xmath59 $ ] , for all @xmath49 .",
    "consider an lse managing @xmath46 tcls with thermal coefficients @xmath60 , initial conditions @xmath61 , and comfort tolerances @xmath62 .",
    "we now formulate the optimal power consumption design problem .",
    "we suppose that the lse has available estimates @xcite of the parameters and initial conditions at the beginning of the time horizon .      denoting by @xmath63 the number of on tcls at time @xmath17 , the aggregate electrical power drawn by the tcl population at time @xmath17 is @xmath64 .",
    "we take the switching trajectories @xmath65 as decision variables @xmath66 , and introduce an extended state vector @xmath67 of size @xmath68 . at time @xmath17 , the components of @xmath69 are @xmath70 for @xmath49 , @xmath71 , and @xmath72 .",
    "then , to minimize the procurement cost for total energy consumption over @xmath43 $ ] , the lse needs to : @xmath73 subject to the constraints + * c1 . *",
    "( indoor temperature dynamics )    .",
    "i(t ) = -_i ( x_i(t ) - _ a(t ) ) - _ i p u_i(t ) , + & x_i(0 ) = _ i0 , i=1,,n ,    } [ dynamicsconstraintinitial ]    _ n+1(t ) = 1 , x_n+1(0 ) = 0 , x_n+1(t ) = t , [ dynamicsconstraintfinal ]    * c2 . * ( energy / isoperimetric constraint )    & _ n+2(t ) = _ i=1^nu_i(t ) , x_n+2(0 ) = 0 , x_n+2(t ) = , [ energybudgetconstraint ]    * c3 . * ( contractual comfort / state inequality constraint ) @xmath74 where @xmath47 : = [ s_{i0 } - \\delta_{i } , s_{i0 } + \\delta_{i}]$ ] for @xmath75 .",
    "we notice that the constraints ( [ dynamicsconstraintinitial ] ) and ( [ comfortrangeconstraint ] ) are decoupled , while the cost function ( [ planningcostfcn ] ) and constraint ( [ energybudgetconstraint ] ) are coupled . denoting the solution of the open loop deterministic optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) by @xmath76 ,",
    "the optimal power consumption trajectory is given by @xmath77 .",
    "the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) is non - autonomous since there are explicit dependence on time in the cost function ( via @xmath41 ) and in the dynamics ( via @xmath42 ) .",
    "this motivated us to include time @xmath17 as a component of @xmath69 .",
    "let @xmath78 , and notice that the constraint ( [ energybudgetconstraint ] ) imposes a necessary condition for feasibility , @xmath79 given an ambient temperature forecast @xmath42 and parameters of the tcl population , further restriction of @xmath80 is needed to include the possibility of zero dynamics on ( meaning the temperature trajectory chatters along ) the boundaries @xmath81 and @xmath82 .",
    "such a restriction is of the form @xmath83 where @xmath84 , and likewise for @xmath85 . here",
    "@xmath86 ( resp .",
    "@xmath87 ) is the aggregate energy consumed if the entire population were to be maintained at their private upper ( lower ) setpoint boundaries , thus resulting in the lowest ( highest ) total energy consumption while respecting ( [ comfortrangeconstraint ] ) .",
    "in other words , @xmath88 , where the zero dynamics controls are @xmath89 , and hence @xmath90 where @xmath91 .",
    "similar calculation yields @xmath92 thus , ( [ feasibilitywzerodynamics ] ) characterizes the necessary and sufficient conditions for feasibility of the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) .",
    "notice that constraint * c2 * expresses a total energy budget @xmath93 . in the absence of * c2 * , the optimal controls @xmath76 that minimize ( [ planningcostfcn ] ) subject to * c1 * and * c3 * , satisfy @xmath94 , where from ( [ taulowernormalized ] ) , we have @xmath95    notice also that condition ( [ feasibilitywzerodynamics ] ) is equivalent to the energy inequality @xmath96 , where @xmath97 , @xmath98 , @xmath86 is given by ( [ energylower ] ) , and from ( [ tauuppernormalized ] ) we have @xmath99 . as a consequence , the feasible energy budget @xmath45 must belong to an interval @xmath100 $ ] with length @xmath101 .",
    "a direct numerical approach converts the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) to an optimization problem via time discretization .",
    "such a  discretize - then - optimize \" strategy leads to a mixed integer linear program ( milp ) , since @xmath102 but @xmath66 , for @xmath49 .",
    "typically , the day - ahead price forecast @xmath41 is available as piecewise constant for each hour , and hence taking the euler discretization for dynamics ( [ dynamicsconstraintinitial ] ) with 1 minute time resolution results in an milp over @xmath103 variables . in our experience , solving the milp even for @xmath104 homes for the day - ahead price , is computationally expensive ( cpu runtime over 24 hours ) in gurobi @xcite .",
    "on the other hand , a linear program ( lp ) relaxation of the milp , resulting from the control convexification @xmath105 $ ] , has much faster runtime and was reported in our earlier work @xcite .",
    "furthermore , the optimal solution of the lp relaxation has the physical meaning of average on duration over a discretization interval ( see fig .",
    "[ milpvslp ] ) .",
    "that is piecewise constant for each hour , is shown with @xmath106 .",
    "bottom : the corresponding solution of the optimal power consumption problem ( [ planningcostfcn])([comfortrangeconstraint ] ) via discretized milp ( from gurobi ) and lp ( from matlab ` linprog ` ) for @xmath107 home with @xmath12 = [ 20^{\\circ}\\mathrm{c},30^{\\circ}\\mathrm{c}]$ ] , and constant ambient forecast @xmath108 .",
    "the parameter values used in this simulation are from table 1 , p. 1392",
    "in @xcite.,scaledwidth=44.0% ]    however , the milp equality constraint does not satisfy total unimodularity ( see for example , ch . 5 in @xcite ) , and so the optimal solution of the lp relaxation is not the optimal solution of the milp . in the following sections iv and v , we solve the continuous time optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) using pontryagin s maximum principle ( pmp ) @xcite , thereby obtaining qualitative insights into the optimal solution , which are otherwise difficult to gauge from the direct numerical solution of the discretized lp relaxation .",
    "for the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) , if we remove constraints * c2 * and * c3 * , then the optimal control is trivial : @xmath109 for all @xmath49 , for all @xmath110 $ ] . in section [ c1c2subsection ]",
    ", we first discuss the non - trivial case of solving ( [ planningcostfcn ] ) subject to * c1 * and * c2 * , i.e. , in the absence of the inequality constraints * c3*. this is followed by the solution for general case in section [ zeroampsoln ] , with all constraints * c1**c3 * active .",
    "[ 12theorem ] consider problem ( [ planningcostfcn ] ) with constraints * c1**c2*. the optimal controls are synchronizing , i.e. , @xmath111 at each @xmath112 $ ] .",
    "there is a threshold price @xmath113 , such that @xmath114 for all @xmath49 , iff @xmath115 .",
    "specifically , let @xmath116 , @xmath117 : \\widehat{\\pi}(s ) < \\pi^ { * } \\big\\}$ ] , and let @xmath118 be the costate vector corresponding to the state vector @xmath119 in section [ lseobjectivesubsection ] .",
    "then the optimal solution is @xmath120    the hamiltonian @xmath121 + \\lambda_{n+1}(t ) \\label{hamiltonian12 }    \\end{aligned}\\ ] ] gives the first order optimality conditions @xmath122 the transversality condition yields @xmath123 . since the terminal states @xmath124 are free , @xmath125 implying that @xmath126 , for all @xmath49 . since @xmath127 is fixed , @xmath128 .",
    "similarly , @xmath129 . combining @xmath130 with ( [ fooc12i ] ) gives @xmath131 for all @xmath17 . setting @xmath132 in ( [ hamiltonian12 ] ) , and invoking pmp yields the optimal controls as @xmath133 hence , if @xmath134 , then we need to minimize ( maximize ) @xmath135 over @xmath136 , meaning that the _",
    "optimal controls are synchronized_.    , right : the corresponding optimal control with constraint * c3 * inactive is given by @xmath137 , where @xmath138 $ ] for strictly increasing , and @xmath139 $ ] for strictly decreasing @xmath41.,scaledwidth=48.0% ]        we know @xmath140 @xmath141 $ ] .",
    "thus , if @xmath142 , then @xmath143 implying @xmath144 \\ : $ ] .",
    "this in turn leads to @xmath145 implying @xmath146 , which is impossible since @xmath147 ( given ) .",
    "therefore , the constant @xmath148 .    notice that whether @xmath149 is @xmath150 or @xmath151 depends on the magnitude of the constant @xmath148 , as well as on the magnitude of @xmath152 .",
    "depending on the sign of the time - varying sum @xmath149 , the optimal control will switch between 0 and 1 .",
    "let us denote the optimal value of @xmath153 as @xmath154 , and consider a set @xmath155 $ ] given by @xmath156 : \\widehat{\\pi}(s ) < -\\frac{\\eta}{p}\\lambda_{n+2}^{*}\\}$ ] .",
    "then , from pmp , @xmath157 , we can rewrite the optimal control as @xmath158 , and @xmath159 otherwise . thus , to determine @xmath160 , all that remains is to determine @xmath154 , or equivalently @xmath161 , where the latter can be interpreted as some threshold price @xmath162 .",
    "the choice of @xmath148 , or equivalently @xmath163 , is constrained by the terminal condition @xmath164 , and hence the feasible choices of @xmath165 comprise the set @xmath166 .",
    "the optimal @xmath154 , that minimizes the  cost - to - go \" @xmath167 , is given by @xmath168 .",
    "to determine @xmath169 , combining ( [ fooc12ii ] ) with @xmath131 results in @xmath170 .",
    "thus , @xmath171 constant , which we enforce to be zero . on the other hand , @xmath172 , where the integration constant @xmath173 needs to be determined . since @xmath174 constant , which , as before , we enforce to be zero ,",
    "we obtain @xmath175 , as @xmath176 @xmath177 .",
    "to derive @xmath178 for all @xmath49 , we simply substitute the optimal control @xmath160 and then integrate the resulting first - order linear non - homogeneous ode ( [ dynamicsconstraintinitial ] ) using the method of integrating factor , to get the desired expression .",
    "[ monotonerearrangmentremark ] monotone rearrangement of @xmath41 : the main insight behind the optimal control derived in theorem [ 12theorem ] can be obtained by looking at strictly monotone price forecasts , as shown in fig .",
    "[ monotone12 ] . in these cases",
    ", it is intuitive that the optimal on periods of the tcls lie at either end of the interval @xmath43 $ ] .",
    "theorem [ 12theorem ] asserts that the same insight can be extended to non - monotone @xmath41 , by first computing its monotone rearrangement ( p. 276 , ch .",
    "10 in @xcite ) @xmath179 , and then computing the threshold @xmath113 and the on time set @xmath180 from this monotone rearrangement as a function of @xmath181 , as illustrated in fig .",
    "[ monotonerearrangement ] .",
    "[ nonuniquenessremark ] non - uniqueness of optimal control : from theorem [ 12theorem ] , the synchronized optimal control @xmath76 , is unique iff the set @xmath180 is unique , where @xmath180 is the pre - image of @xmath113 . notice that although @xmath113 is unique for any continuous @xmath41 , uniqueness of @xmath180 depends on whether there exist time intervals of constancy in price forecast @xmath41 .",
    "for example , in fig .",
    "[ monotonerearrangement ] , there is no such interval of constancy , and hence the pre - image set @xmath180 , and the optimal control @xmath160 , are unique .",
    "this remains true even when @xmath181 is large ( see fig .",
    "[ nonunique](a ) ) .",
    "non - uniqueness , however , can arise if there exist an interval of constancy @xmath182 , and @xmath181 is large enough that @xmath180 contains at least a subset of @xmath182 ( see fig . [ nonunique](b ) ) .",
    "the uncountable number of non - unique solutions arising from such a situation can be resolved by fixing the convention of choosing the optimal control with minimum number of switchings .",
    "is unique , where @xmath183 , and hence @xmath160 is unique too .",
    "( b ) here also @xmath184 such that @xmath183 , however , @xmath181 and hence the threshold @xmath113 are such that the set @xmath185 , where @xmath182 is the total interval of constancy .",
    "thus , subsets of @xmath186 can be interchanged with equi - measure subsets of @xmath187 without affecting the cost . therefore ,",
    "the set @xmath180 and optimal control @xmath160 are not unique in this case .",
    "since these sets are continuous , the number of such interchanges , and hence the number of optimal controls , is uncountable.,scaledwidth=50.0% ]      now we solve ( [ planningcostfcn])([comfortrangeconstraint ] ) subject to constraints ( * c1*)(*c3 * ) , under the assumption that the indoor temperature trajectories @xmath50 can slide along the boundaries @xmath81 and @xmath82 , which can be thought of as the limit of small amplitude chattering .",
    "we assume that sliding along @xmath81 holds the on mode , while the same along @xmath82 holds the off mode .",
    "our objective is to obtain qualitative insight into the solution structure under these simplifying assumptions . in section [ minchatteringamplabel ]",
    ", we consider the practical case of finite amplitude chattering .",
    "to describe the optimal solution , we next define the two - sided skorokhod map @xcite , which generalizes the one - sided version originally introduced by skorokhod @xcite .",
    "two - sided skorokhod map : + given @xmath188 , and scalar trajectory @xmath189 , the two - sided skorokhod map @xmath190 $ ] is defined as @xmath191 , where @xmath192^{+ } \\wedge \\displaystyle\\inf_{s\\leq r \\leq t}\\left(\\phi\\left(r\\right ) - l\\right)\\right),$ ] and @xmath193^{+}$ ] . [ twosidedskorokhodmapdefn ]    [ 123theorem ] consider problem ( [ planningcostfcn ] ) with constraints * c1**c3*. the optimal controls are synchronizing , and , as in theorem [ 12theorem ] , based on a price forecast threshold @xmath113 , switch between 0 and 1 .",
    "assuming zero amplitude chattering to be feasible , the open loop optimal controls @xmath160 are identical to those in theorem [ 12theorem ] .",
    "for @xmath49 , the optimal states @xmath178 are the two - sided skorokhod maps parameterized by individual comfort ranges @xmath47 $ ] , acting on respective optimal states from theorem [ 12theorem ] , i.e. , @xmath194 , where @xmath195 is the optimal indoor temperature trajectory when constraints * c1**c3 * are active , and @xmath196 is the same when constraints * c1**c2 * are active , for the @xmath51^th^ tcl .    from the necessary conditions for optimality under state inequality constraints",
    "@xcite , it can be directly verified that the @xmath113 is as in theorem [ 12theorem ] .",
    "hence the monotone rearrangement argument applies as before , and @xmath160 are synchronized as function of time .",
    "however , the optimal states have different hitting times to the respective boundaries @xmath81 and @xmath82 . for brevity , we provide below a simple graphical argument for the optimal states for strictly monotone ( w.l.o.g . decreasing )",
    "the non - monotone @xmath41 can be dealt via the monotone rearrangement , and the non - uniqueness due to constancy can be dealt with by adopting a minimum switching convention , as earlier .    by the argument above , consider strictly decreasing @xmath41 as in fig .",
    "[ monotone12 ] left , green curve , and fix the @xmath51^th^ home with initial indoor temperature @xmath197 , and comfort boundaries @xmath81 and @xmath82 . at time @xmath198 , the trajectory @xmath50 can move either exponentially upward or downward . for @xmath112",
    "$ ] , let us call the set of all feasible trajectories @xmath52 $ ] for which @xmath199 , as the  initially up - going family \" .",
    "similarly , define  initially down - going family \" for @xmath200 .",
    "our proof consists of the following two steps .",
    "step 1 : finding the optimal indoor temperature trajectory among the  initially up - going family \" : we notice that among the  initially up - going family \" , it is optimal to hit @xmath82 , since otherwise turning the tcl on before hitting @xmath82 strictly increases the cost , as @xmath41 is strictly decreasing .",
    "similarly , starting from the time at which @xmath82 is hit , it is then optimal to hold till @xmath201 as sliding along @xmath82 , as per assumption , does not contribute to the cost . for @xmath202 $ ]",
    ", we notice that we must keep @xmath203 to respect the energy constraint .",
    "further , notice that any de - synchronization among tcls increase cost .",
    "thus , the optimal temperature trajectory among the  initially up - going family \" looks like those shown in fig .",
    "[ skorokhodnonmonotone ] bottom right . from definition [ twosidedskorokhodmapdefn ] , we find that the optimal indoor temperature trajectory among the  initially up - going family \" is @xmath204 .",
    "step 2 : showing that any trajectory from the  initially down - going family \" has cost strictly larger than the same for the optimal trajectory in step 1 : this can be easily verified by comparing the optimal from step 1 , with any trajectory from the  initially down - going family \" using that @xmath41 is strictly decreasing .    combining the above two steps ,",
    "we conclude that for @xmath41 strictly decreasing , the optimal indoor temperature trajectory found in step 1 is the optimal among all feasible indoor temperature trajectories .",
    "similar argument applies to @xmath41 strictly increasing , and to monotone rearranged version @xmath179 in case @xmath41 is non - monotone .",
    "we eschew the details and illustrate an example in fig .",
    "[ skorokhodnonmonotone ] to help the readers follow our main argument .",
    "same as in fig .",
    "[ monotonerearrangement ] , the optimal controls @xmath160 ( top left ) with constraints * c1**c3 * , are same as those shown in fig .",
    "[ monotonerearrangement ] .",
    "however , the optimal indoor temperatures @xmath195 ( right bottom ) are different from @xmath196 ( left bottom , same as in fig . [ monotonerearrangement ] ) , for @xmath205 tcls .",
    "the subscript @xmath206 in @xmath195 denotes that constraints * c1**c3 * are active.,scaledwidth=50.0% ]",
    "since physical thermostats have a minimum chattering amplitude , or equivalently minimum on - off time period @xmath207 , it is important to find an algorithm that explicitly accounts this device limit into control design . given this parameter @xmath208 , the following theorem gives an _ exact _ algorithm to compute the binary optimal control via convexification .",
    "[ recoveroptimalbinary ] for @xmath49 , consider the control convexification @xmath209 $ ] , and let @xmath210 $ ] be the optimal convexified control corresponding to the non - convex optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) with @xmath46 tcls having thermal coefficients @xmath60 .",
    "let @xmath211 ( resp .",
    "@xmath212 ) be the indoor temperature trajectory realized by the optimal control @xmath213 ( resp .",
    "@xmath160 ) .",
    "then , the following algorithm recovers the optimal control @xmath214 from @xmath210 $ ] , while guaranteeing that the indoor temperatures trajectories @xmath211 and @xmath212 coincide at the end of each minimum allowable time period of length @xmath208 .",
    "@xmath215 @xmath216 + where @xmath217 , @xmath112 $ ] @xmath218 + where @xmath217 , @xmath112 $ ]    in algorithm [ vstar2ustar ] , @xmath219 are time duration pairs such that the binary optimal trajectory @xmath160 consists of two duty cycles : @xmath220 and @xmath221 , where @xmath222    since @xmath213 is binary iff the respective upper and lower comfort boundaries are not hit , hence @xmath215 when @xmath223 or @xmath224 .",
    "we know that @xmath225 iff @xmath211 is at either upper or lower boundary",
    ". clearly , at the upper ( lower ) boundary , such cycles should begin with an on ( off ) segment , and end with an off ( on ) segment .",
    "matching indoor temperature values at each end of these switching period means @xmath226 , which gives @xmath227 at upper boundary , rhs of ( [ matchingcondition ] ) equals @xmath228 , which solved for @xmath229 yields ( [ gammaupper ] ) . at lower boundary , rhs of ( [ matchingcondition ] ) equals @xmath230 , which solved for @xmath231 yields ( [ gammalower ] ) .",
    "to illustrate how the lse can use the results derived so far for the purpose of demand response , we now provide a numerical example where the lse computes the day - ahead minimum cost energy procurement for its @xmath232 customers tcls based on ercot day - head price forecast @xmath233 data @xcite for houston on august 10 , 2015 , and the ambient temperature forecast @xmath234 data for the same day available from a weather station in houston , texas . these forecast data and the real - time ambient temperature @xmath235 data on august 11 , 2015 , are shown in fig .",
    "[ priceambient ] .",
    "( _ dashed blue _ ) , real - time ambient temperature @xmath11 ( _ solid blue _ ) , ercot day - ahead price @xmath41 ( _ dashed green _ ) , and ercot real - time price @xmath236 ( _ solid green , not used for computation in this paper _ ) data for aug .",
    "11 , 2015 in houston.,scaledwidth=49.0% ]     computed by solving the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) , via algorithm [ vstar2ustar ] with @xmath237 minutes .",
    "brick _ colored curve is the real - time controlled aggregate consumption @xmath238 corresponding to control gain tuple @xmath239 used to move the thermostatic boundaries ( see section iii.1 in @xcite for details ) .",
    "the lse can invoke demand response by controlling the setpoints of the tcl population in such a way that their real - time aggregate consumption @xmath238 track the reference aggregate consumption @xmath240 .",
    "the tracking error between the two curves depend on the forecasted versus real - time ambient temperature mismatch , as well as on the thermal inertia of the tcls in the population.,scaledwidth=48.0% ]    with the initial conditions and parameters of the heterogeneous tcl population as in section v - a in @xcite , @xmath241 ( which was verified to be feasible using ( [ feasibilitywzerodynamics ] ) ) , comfort tolerances @xmath62 sampled randomly from a uniform distribution over @xmath242 $ ] , and for @xmath41 and @xmath42 as in fig .",
    "[ priceambient ] , the lse solves the optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) by first convexifying the controls @xmath243 $ ] for @xmath49 , and then recovering the optimal controls @xmath244 using theorem [ recoveroptimalbinary ] . for this computation , we used 1 minute time - step for euler discretization of dynamics ( [ dynamicsconstraintinitial ] ) , and solved the resulting lp with 1 million 440 thousand decision variables ( see section [ difficultydns ] ) using matlab ` linprog ` , followed by algorithm [ vstar2ustar ] with @xmath237 minutes . the resulting optimal power consumption trajectory @xmath245 is shown as the black curve in fig .",
    "[ setpointtracking ] .",
    "the brick colored curve in fig .",
    "[ setpointtracking ] correspond to the actual aggregate consumption for the tcl population with same @xmath208 , and real - time ambient temperature @xmath11 as in the solid blue curve in fig .",
    "[ priceambient ] , for a pid velocity control gain tuple @xmath246 used to control the setpoint boundaries as part of a mixed centralized - decentralized control .",
    "we refer the readers to section iii.1 in @xcite for details on the real - time setpoint control . the purpose of fig .",
    "[ setpointtracking ] is to highlight how the solution of the open - loop optimal control problem ( [ planningcostfcn])([comfortrangeconstraint ] ) can be used by the lse as a reference aggregate consumption to be tracked in real - time , to elicit demand response .",
    "in this paper , we addressed how an aggregator or load serving entity can design an optimal aggregate power consumption trajectory for a population of thermostatically controlled loads .",
    "we formulated this operational planning problem as a deterministic optimal control problem in terms of the day - ahead price forecast , ambient temperature forecast , and an energy budget available from the load forecast .",
    "we discuss why a direct numerical approach to solve the problem is computationally hard .",
    "finally , we use tools from optimal control theory to gain analytic insights for the solution of the problem of designing optimal power consumption while respecting individual comfort range constraints .",
    "a numerical example is worked out to illustrate how an lse can use the optimal aggregate power consumption trajectory computed offline , as a reference signal to be tracked in real - time by its customers tcl population for the purpose of demand response .",
    "department of energy , `` benefits of demand response in electricity markets and recommendations for achieving them '' . _ a report to the united states congress pursuant to section 1252 of the energy policy act of 2005 _ , feb . 2006 .",
    "chong , and a.s .",
    "debs ,  statistical synthesis of power system functional load models \" .",
    "_ proceedings of the 18^th^ ieee conference on decision and control including the symposium on adaptive processes _ , no .",
    "18 , pp . 264269 , 1979 .",
    "r.  malham , and c .- y .",
    "chong ,  electric load model synthesis by diffusion approximation of a high - order hybrid - state stochastic system \" .",
    "_ ieee transactions on automatic control _ , vol .",
    "9 , pp . 854860 , 1985 .",
    "callaway ,  tapping the energy storage potential in electric loads to deliver load following and regulation , with application to wind energy \" . _ energy conversion and management _ , vol .",
    "5 , pp . 13891400 , 2009 .",
    "s.  bashash , and h.k .",
    "fathy ,  modeling and control insights into demand - side energy management through setpoint control of thermostatic loads \" .",
    "_ proceedings of the american control conference _ , pp . 45464553 , 2011 .",
    "s.  kundu , n.  sinitsyn , s.  backhaus , and i.  hiskens ,  modeling and control of thermostatically controlled loads \" .",
    "_ proceedings of the 17^th^ power systems computation conference _ , stockholm , sweden , 2011 .",
    "mathieu , s.  koch , and d.s .",
    "callaway ,  state estimation and control of electric loads to manage real - time energy imbalance \" .",
    "_ ieee transactions on power systems _ , vol .",
    "1 , pp . 430440 , 2013 .",
    "a.  ghaffari , s.  moura , and m.  krsti ,  analytical modeling and integral control of heterogeneous thermostatically controlled load populations \" .",
    "_ asme 2014 dynamic systems and control conference _",
    ", 2014 .",
    "s.  meyn , p.  barooah , a.  bui , y.  chen , and j.  ehren ,  ancillary service to the grid using intelligent deferrable loads \" .",
    "_ ieee transactions on automatic control",
    "28472862 , 2015 .",
    "s.  grammatico , b.  gentile , f.  parise , and j.  lygeros ,  a mean field control approach for demand side management of large populations of thermostatically controlled loads \" .",
    "_ proceedings of the european control conference _ , pp . 35483553 , 2015 .",
    "d.  paccagnan , m.  kamgarpour , and j.  lygeros ,  on the range of feasible power trajectories for a population of thermostatically controlled loads \" .",
    "_ proceedings of the 2015 ieee 54^th^ annual conference on decision and control ( cdc ) _ , pp . 58835888 , 2015 .",
    "s.  moura , j.  bendtsen , and v.  ruiz ,  observer design for boundary coupled pdes : application to thermostatically controlled loads in smart grids \" .",
    "_ proceedings of the 52^nd^ ieee conference on decision and control _ , pp . 62866291 , 2013 .",
    "s.  moura , j.  bendtsen , and v.  ruiz ,  parameter identification of aggregated thermostatically controlled loads for smart grids using pde techniques \" .",
    "_ international journal of control _ , pp .",
    "13731386 , vol .",
    "87 , no . 7 , 2014 .",
    "a.  halder , x.  geng , g.  sharma , l.  xie , and p.r .",
    "kumar ,  a control system framework for privacy preserving demand response of thermal inertial loads \" .",
    "_ proceedings of the ieee international conference on smart grid communications _ , pp . 181186 , 2015 .",
    "l.  kruk , j.  lehoczky , k.  ramanan , and s.  shreve , ",
    "double skorokhod map and reneging real - time queues \" .",
    "_ markov processes and related topics : a festschrift for thomas g. kurtz _ , institute of mathematical statistics , pp .",
    "169193 , 2008 ."
  ],
  "abstract_text": [
    "<S> we consider the problem of determining the optimal aggregate power consumption of a population of thermostatically controlled loads . </S>",
    "<S> this is motivated by the problem of synthesizing the demand response for a load serving entity ( lse ) serving a population of such customers . </S>",
    "<S> we show how the lse can opportunistically design the aggregate reference consumption to minimize its energy procurement cost , given day - ahead price , load and ambient temperature forecasts , while respecting each individual load s comfort range constraints . </S>",
    "<S> the resulting synthesis problem is shown to be amenable to optimal control techniques , but computationally difficult otherwise . </S>",
    "<S> numerical simulations elucidate how the lse can use the optimal aggregate power consumption trajectory thus computed , for the purpose of demand response . </S>"
  ]
}