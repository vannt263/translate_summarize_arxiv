{
  "article_text": [
    "we consider a system described by coordinates @xmath0 and momenta @xmath1 , where @xmath2 runs over the @xmath3 degrees of freedom , and with @xmath4 and @xmath5 we indicate the set of coordinates @xmath0 and @xmath1 .",
    "we associate a mass @xmath6 to each degree of freedom , and we define a hamiltonian @xmath7 , where @xmath8 is the potential energy , and @xmath9 is the kinetic energy .",
    "we want to sample the canonical distribution @xmath10 , where @xmath11 is the inverse temperature , by means of equations of motion in the form    [ eq - langevin ] @xmath12    equations   are hamilton equations plus a correction force @xmath13 which artificially modifies the dynamics of the system .",
    "since the total energy @xmath14 is conserved in hamiltonian dynamics , only @xmath13 is responsible for its variations and leads to the system thermalization .    in standard langevin dynamics",
    ", the correction force is @xmath15 where @xmath16 is the friction coefficient , and @xmath17 is a vector of @xmath3 independent wiener noises , normalized as @xmath18 .",
    "the thermalization speed can be quantified calculating the time derivative of the total energy from eqs .   and  .",
    "using the itoh chain rule @xcite we obtain @xmath19 this expression can be further simplified defining the average kinetic energy @xmath20 , a relaxation time @xmath21 , and exploiting the fact that the noise terms on different degrees of freedom are independent of each other : @xmath22 it is worth noting that while in eqs .   and there are @xmath3 independent noise terms , in eq .",
    "a single noise term is present .",
    "schematic representation of the momentum components at time @xmath23 and at time @xmath24 .",
    "@xmath25 is a generic force applied to the system .",
    "@xmath26 is a force which leads to the same change in the kinetic energy as @xmath25 , but minimizes the disturbance .",
    ", scaledwidth=30.0% ]    we now want to design a new correction force @xmath27 which gives the same variation of the total energy as langevin dynamics , thus the same thermalization speed , but minimizes the disturbance on the trajectory .",
    "this procedure is exactly the same used by berendsen _",
    "et al _ @xcite , the only difference being that eq .   on the total energy",
    "now contains a stochastic term .",
    "we first notice that , since the force only acts on the momenta , fixing a value for @xmath14 is equivalent to fixing a value for @xmath28 . following ref .",
    "@xcite we quantify the disturbance as @xmath29 . as it is seen in fig .",
    "[ fig - scheme ] , the minimal disturbance for a fixed kinetic energy increment is obtained with a force @xmath27 which is proportional to @xmath30 .",
    "thus @xmath31 , where @xmath32 is chosen so as to enforce a given variation of the total energy . since @xmath32 includes a stochastic part , and since the variation of the total energy depends on the momenta only through the kinetic energy @xmath28 , this last relation can be written as @xmath33,\\ ] ] where @xmath34 and @xmath35 are arbitrary functions of the kinetic energy .",
    "the change in the total energy is then @xmath36 expressions for @xmath34 and @xmath35 can be obtained setting eq .",
    "equal to eq .",
    ", resulting in the correction force @xmath37p_i dt \\\\ + \\sqrt{\\frac{\\bar{k}}{n_fk\\tau}}p_idw.\\end{gathered}\\ ] ] this equation is stochastic , with the same noise term used on all the particles .",
    "it is also very similar to the expression of the force in the berendsen algorithm .",
    "the combination of eqs .",
    "and   results in a continuous , stochastic dynamics which can be shown to sample exactly the canonical ensemble .",
    "the effect of a @xmath38 parallel to @xmath1 is the same of a rescaling procedure and the enforced increment of the total energy in eq .",
    "is the same as in ref .",
    "thus , eqs .   and   represents the continuous version of the velocity rescaling described in ref .",
    "@xcite .",
    "notably , if @xmath39 , eq .   becomes equivalent to eq .  .",
    "thus when the thermostat is applied to a single degree of freedom , it is completely equivalent to a langevin thermostat",
    ". one can perform langevin molecular dynamics by applying a thermostat per degree of freedom , or stochastic rescaling by applying a single thermostat to the total kinetic energy .",
    "intermediate schemes can be designed , where a thermostat is applied on each molecule or group of atoms .",
    "in the practical implementation , time is incremented in discrete steps , and the trotter decomposition scheme @xcite can be used to separate the integration of hamilton equations and the update of the momenta due to @xmath40 .",
    "the former is then integrated using standard velocity - verlet , while for the latter we need to integrate eq .  .",
    "a possible approach is to consider the propagation of kinetic energy when the momenta evolve according to eq .",
    ", as it is done in the appendix of ref .",
    "the analytical solution of eq .   for a finite time @xmath41 is    [ eq - propagator ] @xmath42 where @xmath43    here @xmath44 , @xmath45 is a gaussian number with unitary variance and @xmath46 is the sum of @xmath47 independent , squared , gaussian numbers .",
    "equation   has been obtained enforcing the evolution of the kinetic energy , thus , strictly speaking , it does not fix the sign of @xmath48 . a more rigorous analysis",
    "shows that the sign of @xmath48 should be chosen as @xmath49 to keep into account the finite probability to observe a flip of the momenta @xmath1 when the force in eq .   is applied . the gaussian number in eq .",
    "needs to be the same that is used in eq .  .",
    "the probability to observe the flip is extremely small if @xmath3 is large and @xmath50 , which is the usual case when the thermostat is used as global and @xmath51 .",
    "this is the case in ref .",
    "@xcite , where we set @xmath52 . on the other hand ,",
    "when the thermostat acts on a few degrees of freedom , the sign of @xmath48 needs to be calculated by means of eq .  .",
    "this is always the case for langevin dynamics . with simple manipulation",
    ", it can be shown that for @xmath39 the integration scheme given by eqs .   and  , combined with velocity - verlet ,",
    "is completely equivalent to the integration scheme for langevin dynamics introduced in ref .",
    "up to now we simply established a theoretical relationship between langevin dynamics and stochastic rescaling .",
    "the outcome is that the effect of the two algorithms on the total energy should be equivalent if the friction in the langevin dynamics and the relaxation time in the stochastic scale are related by @xmath21 .",
    "however , the stochastic rescaling is expected to give better dynamical properties , since only the component of the force which changes the total energy is retained .",
    "we test here this affirmations on a simple test - case , namely a lennard - jones fluid with density @xmath53 and temperature @xmath54 , which is close to the triple point . throughout this section",
    "we use reduced lennard - jones units for temperature , distance and time .",
    "we simulate a box containing 108 particles , with periodic boundary conditions , and we cut the interaction at distance 2.5 .",
    "we set the timestep to @xmath55 , which leads to a reasonable conservation of the effective energy  @xcite .",
    "we then perform runs of @xmath56 steps , with both the local scheme ( langevin dynamics ) and the global one ( stochastic rescaling ) , using a broad range of values of the thermostat relaxation time @xmath57 .",
    "diffusion coefficient as obtained from thermostated simulations as a function of the thermostat relaxation time @xmath57 , for the local and global thermostats as indicated .",
    "the statistical error is smaller than the symbol size . as a reference ,",
    "the diffusion coefficient of a free particle subject to the same langevin equation is plotted ( dashed line ) .",
    "all the quantities are in lennard - jones reduced units . ,",
    "scaledwidth=45.0% ]    to quantify the disturbance on hamiltonian dynamics , in fig .",
    "[ fig - diffusion ] we show the diffusion coefficient as a function of @xmath57 , as obtained from the einstein relations . when the local thermostat is used with a short relaxation time",
    ", the diffusion is strongly quenched .",
    "this happens when the typical collision time with the external bath @xmath58 is shorter than the typical collision time between the particles , so that the former becomes the real bottleneck for the diffusion process . in the limit of short @xmath57 ,",
    "the equations of motion tend to a high - friction langevin dynamics . in this case",
    ", the observed diffusion coefficient @xmath59 is proportional to @xmath60 , which is the value of the diffusion coefficient for a free particle subject to the same langevin dynamics .",
    "the prefactor is related to the difficulty in crossing the barriers between different liquid configurations . on the contrary , with the global thermostat @xmath59",
    "is almost independent on @xmath57 , indicating that the disturbance on the dynamics is very small and that good estimates of @xmath59 in the canonical ensemble can be obtained also with a thermostated simulation .    to quantify the equilibration speed",
    "we calculate the autocorrelation time of a few global observables .",
    "the efficiency of a sampling algorithm is optimal when the autocorrelation time @xmath61 of the desired quantity @xmath62 is minimal .",
    "if @xmath62 is the total energy , @xmath61 also indicates how fast a simulation started from an unlikely configuration is equilibrated .",
    "we integrate the autocorrelation function using a windowing function @xmath63 where @xmath64 and @xmath65 is a large value .",
    "the windowing function in parethesis helps the convergence because it weights less the points with larger statistical error .",
    "moreover , equation   is exactly equal to @xmath66 , where @xmath67 is the mean square error from a time average of length @xmath65 .",
    "the relative accuracy in evaluation of @xmath61 is approximately @xmath68 , where @xmath69 is the total run length . in the following we choose @xmath70 , and we expect a relative accuracy on @xmath61 on the order of 5% .",
    "since @xmath71 , @xmath61 is also a good approximation for the autocorrelation time .",
    "autocorrelation time of the kinetic ( @xmath72 ) , potential ( @xmath73 ) , and total ( @xmath74 ) energy , as a function of the thermostat relaxation time @xmath57 , for the local and global thermostats as indicated .",
    "the statistical error is smaller than the symbol size .",
    "all the quantities are in lennard - jones reduced units . , scaledwidth=45.0% ]    in figure  [ fig - autocorrelation ] we plot the autocorrelation time of the kinetic energy @xmath72 , of the potential energy @xmath73 and of the total energy @xmath74 , as a function of the thermostat relaxation time @xmath57 .",
    "the autocorrelation time of the kinetic energy is completely dictated by the thermostat relaxation time , and independent on the choice of a local or a global scheme . on the contrary , the autocorrelation time of the total energy and of the potential energies are proportional to @xmath57 only in the limit of large @xmath57 . in the local scheme ,",
    "when @xmath57 is smaller than 0.2 the disturbance of the trajectory becomes so large that the phase - space exploration turns out to be slower .",
    "comparing figs .",
    "[ fig - diffusion ] and  [ fig - autocorrelation ] , it is seen that the optimal value for @xmath57 is the smallest one that still does not affect the diffusion coefficient .",
    "when the global scheme is adopted , even small values of @xmath57 can be safely used , resulting in a faster decorrelation of the total energy .",
    "in conclusion , we have presented an alternative derivation of the global thermostat introduced in ref .",
    "this derivation allows to write continuous equations of motion and shows the analogy between this scheme and the standard langevin thermostat .",
    "namely , the new scheme can be considered as a global version of the langevin thermostat , that minimizes the disturbance of the original hamiltonian dynamics .",
    "finally , we have discussed these properties on a simple test case , showing that the global scheme preserves the dynamical properties . moreover , using as a measure the autocorrelation time of the total energy , we have shown that the global scheme allows for a faster sampling ."
  ],
  "abstract_text": [
    "<S> we show that a recently introduced stochastic thermostat [ j.  chem .  </S>",
    "<S> phys .  * 126 * , 014101 ( 2007 ) ] can be considered as a global version of the langevin thermostat . </S>",
    "<S> we compare the global scheme and the local one ( langevin ) from a formal point of view and through practical calculations on a model lennard - jones liquid . at variance with the local scheme </S>",
    "<S> , the global thermostat preserves the dynamical properties for a wide range of coupling parameters , and allows for a faster sampling of the phase - space .    </S>",
    "<S> the most common approaches to isothermal molecular dynamics are perhaps those based on the introduction of an extended lagrangian . </S>",
    "<S> the root of all these schemes is the nos algorithm @xcite , often used in the hoover formulation @xcite . </S>",
    "<S> this scheme can be rigorously shown to provide the correct boltzmann distribution and has a conserved quantity , which can be used to check the integration timestep . </S>",
    "<S> a major drawback of the nos - hoover method is that it is not ergodic in some difficult cases , such as harmonic systems . </S>",
    "<S> several different extensions of the nos - hoover method have been introduced , the most notable one being the so - called nos - hoover chains @xcite , which addresses the ergodicity issue at the price of an increased complexity in the algorithm . </S>",
    "<S> although the nos - hoover scheme was originally written as a global thermostat , i.e. coupled only to the total kinetic energy of the system , it is sometimes implemented in a local manner ( also called massive nos - hoover ) , i.e. using an independent thermostat on each degree of freedom @xcite .    </S>",
    "<S> another common choice is the weak - coupling method , introduced by berendsen _ </S>",
    "<S> et al _ @xcite . </S>",
    "<S> this scheme is a continuous version of the velocity - rescaling scheme , thus it is a global thermostat . </S>",
    "<S> it is deterministic , stable and easy to implement , but it does not produce configurations in the canonical ensemble .    an alternative approach to canonical sampling is to use stochastic molecular dynamics . the most common form is langevin dynamics @xcite . </S>",
    "<S> the langevin thermostat is local , and its major feature is that ergodicity can be proven also in pathological cases . </S>",
    "<S> however , since the friction and noise terms alter significantly the hamiltonian dynamics , it can not be used to compute dynamical properties , unless an extremely small friction is used . </S>",
    "<S> moreover , the effect of the friction and noise terms on the sampling efficiency is non trivial . even in applications </S>",
    "<S> where dynamical properties are not relevant it can be difficult to properly tune the friction in order to achieve an efficient sampling .    </S>",
    "<S> in a recent paper  @xcite we proposed a stochastic velocity rescaling which can be considered as berendsen thermostat plus a stochastic correction leading to canonical sampling . </S>",
    "<S> we also showed that , in spite of its stochastic nature , one can define a conserved quantity . </S>",
    "<S> this scheme does not suffer of ergodicity problems in solids  @xcite , has been used in practical applications for equilibration purposes  @xcite or to perform ensemble averages  @xcite and can be combined with variable - cell dynamics to perform simulations in the isothermal - isobaric ensemble  @xcite . in the present paper we present an alternative derivation of the same scheme , where stochastic velocity rescaling is obtained starting from langevin dynamics and minimizing the disturbance of the thermostat on the hamiltonian trajectory , nevertheless retaining the same thermalization speed of langevin dynamics . </S>",
    "<S> this idea was also used by berendsen _ </S>",
    "<S> et al _ to derive their algorithm @xcite . </S>",
    "<S> moreover , we show how stochastic velocity rescaling can be considered as a global version of langevin dynamics . </S>",
    "<S> thus the relationship between the two schemes is similar to that between standard nos - hoover and massive nos - hoover . </S>",
    "<S> finally , we compare in practical situations the efficiency of the local ( langevin ) and global ( rescaling ) versions , and show that the disruption of hamiltonian dynamics observed using langevin thermostat is not due to the the stochastic nature of the algorithm but to the use of a local thermostat . </S>"
  ]
}