{
  "article_text": [
    "knowledge bases are attracting considerable interest both from industry and academia  @xcite .",
    "instances of knowledge bases are the web graph , social and citation networks , and multi - relational knowledge graphs such as freebase  @xcite and yago  @xcite .",
    "large knowledge bases motivate the development of scalable machine learning models that can reason about objects as well as their properties and relationships .",
    "research in statistical relational learning ( srl ) has focused on particular formalisms such as markov logic  @xcite and problog  @xcite and is often concerned with improving the efficiency of inference and learning  @xcite .",
    "the scalability problems of these statistical relational languages , however , remain an obstacle and have prevented a wider adoption .",
    "another line of work focuses on efficient relational machine learning models that perform well on a particular task such as knowledge base completion and relation extraction .",
    "examples are knowledge base factorization and embedding approaches  @xcite and random - walk based ml models  @xcite .",
    "we aim to advance the state of the art in relational machine learning by developing efficient models that learn knowledge base embeddings that are effective for probabilistic query answering on the one hand , and interpretable and widely applicable on the other .",
    "gaifman s locality theorem  @xcite is a result in the area of finite model theory  @xcite .",
    "the gaifman graph of a knowledge base is the undirected graph whose nodes correspond to objects and in which two nodes are connected if the corresponding objects co - occur as arguments of some relation .",
    "gaifman s locality theorem states that every first - order sentence is equivalent to a boolean combination of sentences whose quantifiers range over local neighborhoods of the gaifman graph . with this paper , we aim to explore gaifman locality from a machine learning perspective . if every first - order sentence is equivalent to a boolean combination of sentences whose quantifiers range over local neighborhoods only , we ought to be able to develop models that learn effective representations from these local neighborhoods .",
    "there is increasing evidence that learning representations that are built up from local structures can be highly successful .",
    "convolutional neural networks , for instance , learn features over locally connected regions of images .",
    "the aim of this work is to investigate the effectiveness and efficiency of machine learning models that perform learning and inference within and across locally connected regions of knowledge bases .",
    "this is achieved by combining relational features that are often used in statistical relatinal learning with novel ideas from the area of deep learning .",
    "the following problem motivates gaifman models .",
    "given a knowledge base ( relational structure , mega - example , knowledge graph ) or a collection of knowledge bases , learn a relational machine learning model that supports complex relational queries .",
    "the model learns a probability for each tuple in the query answer .",
    "note that this is a more general problem than knowledge base completion since it includes the learning of a probability distribution for a complex relational query .",
    "the query corresponding to knowledge base completion is @xmath0 for logical variables @xmath1 and @xmath2 , and relation @xmath3 .",
    "the problem also touches on the problem of open - world probabilistic kbs  @xcite since tuples whose prior probability is zero will often have a non - zero probability in the query answer .",
    "we first review some important concepts and notation in first - order logic .",
    "an atom @xmath4 consists of predicate @xmath3 of arity @xmath5 followed by @xmath5 arguments , which are either elements from a finite domain @xmath6 or logical variables @xmath7 .",
    "we us the terms domain element and object synonymously .",
    "a ground atom is an atom without logical variables .",
    "formulas are built from atoms using the usual boolean connectives and existential and universal quantification .",
    "a free variable in a first - order formula is a variable @xmath1 not in the scope of a quantifier .",
    "we write @xmath8 to denote that @xmath9 are free in @xmath10 , and @xmath11 to refer to the free variables of @xmath10 .",
    "a substitution replaces all occurrences of logical variable @xmath1 by @xmath12 in some formula @xmath10 and is denoted by @xmath13 $ ] .",
    "a vocabulary consists of a finite set of predicates @xmath14 and a domain @xmath15 .",
    "every predicate @xmath3 is associated with a positive integer called the arity of @xmath3 .",
    "a @xmath14-structure ( or knowledge base ) @xmath16 consists of the domain @xmath15 , a set of predicates @xmath14 , and an interpretation .",
    "the herbrand base of @xmath16 is the set of all ground atoms that can be constructed from @xmath14 and @xmath15 .",
    "the interpretation assigns a truth value to every atom in the herbrand base by specifying @xmath17 for each @xmath5-ary predicate @xmath18 . for a formula @xmath19 and a structure @xmath16 , we write @xmath20 to say that @xmath16 satisfies @xmath10 if the variables @xmath21 are substituted with the domain elements @xmath22 .",
    "we define @xmath23 . for the @xmath14-structure @xmath16 and @xmath24",
    ", @xmath25 denotes the substructure induced by @xmath26 on @xmath16 , that is , the @xmath14-structure @xmath27 with domain @xmath26 and @xmath28 for every @xmath5-ary @xmath18 .",
    "the gaifman graph of a @xmath29-structure @xmath16 is the graph @xmath30 with vertex set @xmath15 and an edge between two vertices @xmath31 if and only if there exists an @xmath18 and a tuple @xmath32 such that @xmath33 .",
    "figure  [ fig - kb ] depicts a fragment of a knowledge base and the corresponding gaifman graph .",
    "the distance @xmath34 between two elements @xmath35 of a structure @xmath16 is the length of the shortest path in @xmath30 connecting @xmath36 and @xmath37 . for @xmath38 and @xmath39",
    ", we define the @xmath40-neighborhood of @xmath41 to be @xmath42 .",
    "we refer to @xmath40 also as the _ depth _ of the neighborhood .",
    "let @xmath43 .",
    "the @xmath40-neighborhood of @xmath44 is defined as @xmath45    for the gaifman graph in figure  [ fig - kb ] , we have that @xmath46 and @xmath47 .",
    "@xmath48 is the formula obtained from @xmath49 by _ relativizing _ all quantifiers to @xmath50 , that is , by replacing every subformula of the form @xmath51 by @xmath52 and every subformula of the form @xmath53 by @xmath54 . a formula @xmath55 of the form @xmath56 , for some @xmath49",
    ", is called @xmath40-local . whether an @xmath40-local formula @xmath55 holds depends only on the @xmath40-neighborhood of @xmath1 , that is , for every structure @xmath16 and every @xmath39 we have @xmath57 if and only if @xmath58 . for @xmath59 and @xmath55 being @xmath40-local , a local sentence is of the form @xmath60    we can now state gaifman s locality theorem .",
    "@xcite every first - order sentence is equivalent to a boolean combination of local sentences .",
    "gaifman s locality theorem states that any first - order sentence can be expressed as a boolean combination of @xmath40-local sentences defined for neighborhoods of objects that are mutually far apart ( have distance at least @xmath61 ) .",
    "now , a novel approach to ( statistical ) relational learning would be to consider a large set of objects ( or tuples of objects ) and learn models from their local neighborhoods in the gaifman graphs . it is this observation that motivates gaifman models .",
    "instead of taking the costly approach of applying relational learning and inference directly to entire knowledge bases , the representations of gaifman models are learned bottom up , by performing inference and learning within bounded - size , locally connected regions of gaifman graphs .",
    "each gaifman model specifies the data generating process from a given knowledge base ( or collection of knowledge bases ) , a set of relational features , and a ml model class used for learning .",
    "given a @xmath14-structure @xmath16 , a discriminative gaifman model for @xmath16 is a tuple @xmath62 as follows :    * @xmath63 is a first - order formula called the _ target query _ with at least one free variable ; * @xmath40 is the _ depth _ of the gaifman neighborhoods ; * @xmath64 is the _ size - bound _ of the gaifman neighborhoods ; * @xmath65 is a set of first - order formulas ( the relational features ) ; * @xmath66 is the base model class ( loss , hyper - parameters , etc . ) .    throughout the rest of the paper",
    ", we will provide detailed explanations of the different parameters of gaifman models and their interaction with data generation , learning , and inference .    during the training of gaifman models ,",
    "neighborhoods are generated for _ tuples of objects _",
    "@xmath67 based on the parameters @xmath40 and @xmath64 .",
    "we first describe the procedure for arbitrary tuples @xmath44 of objects and will later explain where these tuples come from . for a given tuple @xmath44 the @xmath40-neighborhood of @xmath44 within the gaifman graph is computed .",
    "this results in the set of objects @xmath68 .",
    "now , from this neighborhood we sample @xmath69 neighborhoods consisting of at most @xmath64 objects . sampling bounded - size sub - neighborhoods from @xmath68",
    "is motivated as follows :    1 .",
    "the degree distribution of gaifman graphs is often skewed ( see figure  [ fig - node - distr ] ) , that is , the number of other objects a domain element is related to varies heavily . generating smaller , bounded - size neighborhoods allows the transfer of learned representations between more and less connected objects .",
    "moreover , the sampling strategy makes gaifman models more robust to object uncertainty  @xcite .",
    "we show empirically that larger values for @xmath64 reduce the effectiveness of the learned models for some knowledge bases .",
    "2 .   relational learning and inference is performed within the generated neighborhoods .",
    "@xmath68 can be very large , even for @xmath70 ( see figure  [ fig - node - distr ] ) , and we want full control over the complexity of the computational problems .",
    "3 .   even for a single object tuple @xmath44 we can generate a large number of training examples if @xmath71 .",
    "this mitigates the risk of overfitting .",
    "the number of training examples per tuple strongly influences the models accuracy .",
    "we can now define the set of @xmath72-neighborhoods generated from a @xmath40-neighborhood .",
    "@xmath73    for a given tuple of objects @xmath44 , algorithm  [ alg : generate ] returns a set of @xmath69 neighborhoods drawn from @xmath74 such that the number of objects for each @xmath75 is the same in expectation .",
    "the formulas in the set @xmath65 are indexed and of the form @xmath76 with @xmath77 and @xmath78 .",
    "for every tuple @xmath79 , generated neighborhood @xmath80 , and @xmath81 , we perform the substitution @xmath82 $ ] and relativize @xmath83 s quantifiers to @xmath84 , resulting in @xmath85 $ ] which we write as @xmath86 $ ]",
    ". let @xmath87 be the substructure induced by @xmath84 on @xmath16 . for every formula @xmath76 and every @xmath88",
    ", we now have that @xmath89 $ ] if and only if @xmath90 $ ] .",
    "in other words , satisfaction is now checked locally within the neighborhoods @xmath84 , by deciding whether @xmath90 $ ] .",
    "the relational semantics of gaifman models is based on the set of formulas @xmath65 .",
    "the feature vector @xmath91 for tuple @xmath44 , and neighborhood @xmath80 , written as @xmath92 , is constructed as follows @xmath93(\\langle \\mathbf{n}\\rangle ) & \\mbox { if } \\mathtt{free}(\\varphi_{i}^{\\mathbf{n}}[\\mathbf{s}/\\mathbf{d } ] ) > 0 \\\\          1 & \\mbox{if } \\langle \\mathbf{n } \\rangle \\models \\varphi_{i}^{\\mathbf{n}}[\\mathbf{s}/\\mathbf{d } ] \\\\          0 & \\mbox{otherwise}.         \\end{array}\\right.\\ ] ]    that is , if @xmath94 $ ] has free variables , @xmath95 is equal to the _ number of groundings _ of @xmath96 $ ] that are satisfied within the neighborhood substructure @xmath87 ; if @xmath96 $ ] has no free variables , @xmath97 if and only if @xmath96 $ ] is satisfied within the neighborhod substructure @xmath87 ; and @xmath98 otherwise . the neighborhood representations @xmath99",
    "capture @xmath40-local formulas and help the model learn formula combinations that are associated with negative and positive examples . for the right choices of the parameters @xmath40 and @xmath64 ,",
    "the neighborhood representations of gaifman models capture the relational structure associated with positive and negative examples .",
    "deciding @xmath100 for a structure @xmath16 and a first - order formula @xmath10 is referred to as _ model checking _ and",
    "computing @xmath101 is called _",
    "@xmath10-counting_. the combined complexity of model checking is pspace - complete  @xcite and there exists a @xmath102 algorithm for _ both _ problems where @xmath103 is the size of an encoding .",
    "clearly , for most real - world kbs this is not feasible . for gaifman models , however , where the neighborhoods are bounded - size , typically @xmath104",
    ", the above representation can be computed very efficiently for a large class of relational features .",
    "we can now state the following complexity result .",
    "let @xmath16 be a relational structure ( knowledge base ) , let @xmath105 be the size of the largest @xmath40-neighborhood of @xmath16 s gaifman graph , and let @xmath106 be the greatest encoding size of any formula in @xmath65 . for a gaifman model with parameters",
    "@xmath40 and @xmath64 , the worst - case complexity for computing the feature representations of @xmath107 neighborhoods is @xmath108 .",
    "existing srl approaches could be applied to the generated neighborhoods , treating each as a possible world for structure and parameter learning . however , our goal is to learn relational models that utilize embeddings computed by multi - layered neural networks .",
    "tuple @xmath67 , parameters @xmath40 , @xmath64 , and @xmath69 @xmath109 $ ] @xmath110 @xmath111 @xmath112 elements sampled uniformly from @xmath113 @xmath114 @xmath115 @xmath116 elements sampled uniformly from @xmath107 @xmath115",
    "@xmath117 @xmath118      let @xmath63 be a first - order formula ( the relational query ) and @xmath119 the result set of the query , that is , all groundings that render the formula satisfied in the knowledge base .",
    "the feature representations generated for tuples of objects @xmath120 serve as _ positive _ training examples . the gaifman models aim is to learn neighborhood embeddings that capture local structure of tuples for which we know that the target query evaluates to true .",
    "similar to previous work , we generate _ negative _ examples by corrupting tuples that correspond to positive examples .",
    "the corruption mechanism takes a positive input tuple @xmath121 and substitutes , for each @xmath122 , the domain element @xmath75 with objects sampled from @xmath15 while keeping the rest of the tuple fixed .",
    "the discriminative gaifman model performs the following steps .    1 .",
    "evaluate the target query @xmath63 and compute the result set @xmath119 2 .   for each tuple @xmath44 in the result set @xmath119 : * compute @xmath123 , a multiset of @xmath69 neighborhoods @xmath124 with algorithm  [ alg : generate ] ; each such neighborhood serves as a _ positive _ training example * compute @xmath125 , a multiset of @xmath126 neighborhoods @xmath127 for corrupted versions of @xmath44 with algorithm  [ alg : generate ] ; each such neighborhood serves as a _ negative _ training example * perform model checking and counting within the neighborhoods to compute the feature representations @xmath92 and @xmath128 for each @xmath129 and @xmath130 , respectively 3 .",
    "learn a ml model with the generated positive and negative training examples .",
    "learning the final gaifman model depends on the base ml model class @xmath66 and its loss function .",
    "we obtained state of the art results with neural networks , gradient - based learning , and categorical cross - entropy as loss function @xmath131,\\ ] ]    where @xmath132 is the probability the model returns on input @xmath92 .",
    "however , other loss functions are possible .",
    "the probability of a particular substitution of the target query to be true is now @xmath133 = \\mathtt{true } ) = \\underset{{\\mathbf{n } \\in \\mathbf{n}_{(r , k)}(\\mathbf{d})}}{\\mathbb{e } } [ p_{\\mathcal{m}}(\\mathbf{v}_{\\mathbf{n}})].\\ ] ]    the expected probability of a representation of a neighborhood drawn uniformly at random from @xmath134 .",
    "it is now possible to generate several neighborhoods @xmath84 and their representations @xmath92 to estimate @xmath135 = \\mathtt{true})$ ] , simply by averaging the neighborhoods probabilities .",
    "we have found experimentally that a single neighborhood already leads to highly accurate results but also that more neighborhood samples further improve the accurracy .",
    "let us emphasize again the novel semantics of gaifman models .",
    "gaifman models generate a large number of small , bounded - size structures from a large structure , learn a representation for these bounded - size structures , and use the resulting representation to answer queries concerning the original structure as a whole .",
    "the advantages are model weight sharing across a large number of neighborhoods and efficiency of the computational problems .",
    "figure  [ fig - learning - example ] and figure  [ fig - inference - example ] illustrate learning from bounded - size neighborhood structures and inference in gaifman models .",
    "structure learning is the problem of determining the set of relational features @xmath65 .",
    "we provide some directions and leave the problem to future work .",
    "given a collection of bounded - size neighborhoods of the gaifman graph , the goal is to determine suitable relational features for the problem at hand .",
    "there is a set of features which we found to be highly effective .",
    "for example , formulas of the form @xmath136 , @xmath137 , and @xmath138 for all relations .",
    "the latter formulas capture fixed - length paths between @xmath139 and @xmath140 in the neighborhoods .",
    "hence , path ranking type features  @xcite can be used in gaifman models as a particular relational feature class . for path formulas with several different relations",
    "we can not include all @xmath141 combinations and , hence , we have to determine a subset occurring in the training data . fortunately , since the neighborhood size is bounded , it is computationally feasible to compute _ frequent paths _ in the neighborhoods and to use these as features .",
    "the complexity of this learning problem is in the number of elements in the neighborhood and not in the number of all objects in the knowledge base .",
    "relation paths that do not occur in the data can be discarded .",
    "gaifman models can also use features of the form @xmath142 , @xmath143 , and @xmath144 , to name but a few .",
    "moreover , features with free variables , such as @xmath145 are _ counting features _",
    "( here : the @xmath3 out - degree of @xmath139 ) .",
    "it is even computationally feasible to include specific second - order features ( for instance , quantifiers ranging over @xmath14 ) and aggregations of feature values .",
    "numerous existing knowledge bases assign confidence values ( probabilities , weights , etc . ) to their statements .",
    "gaifman models can incorporate confidence values during the sampling and learning process . instead of adding random noise to the representations , which we have found to be beneficial",
    ", noise can be added inversely proportional to the confidence values .",
    "statements for which the prior confidence values are lower are more likely to be dropped out during training than statements with higher confidence values .",
    "furthermore , gaifman models can directly incorporate object types such as _ actor _ and _ action movie _ as well as numerical features such as _ location _ and _ elevation_. one simply has to specify a fixed position in the neighborhood representation @xmath99 for each object position within the input tuples @xmath44 .",
    "recent work on relational machine learning for knowledge graphs is surveyed in @xcite .",
    "we focus on a select few methods we deem most related to gaifman models and refer the interested reader to the above article .",
    "a large body of work exists on learning inference rules from knowledge bases .",
    "examples include @xcite and @xcite where inference rules of length one are learned ; and @xcite where general inference rules are learned by applying a support threshold .",
    "their method does not scale to large kbs and depends on predetermined thresholds .",
    "lao et al .",
    "@xcite train a logistic regression classifier with path features to perform kb completion .",
    "the idea is to perform a random walk between objects and to exploit the discovered paths as features .",
    "sfe  @xcite improves pra by making the generation of random walks more efficient .",
    "more recent embedding methods have combined paths in kbs with kb embedding methods  @xcite .",
    "gaifman models support a much broader class of relational features subsuming path features .",
    "for instance , gaifman models incorporate counting features that have shown to be beneficial for relational models .",
    "latent feature models learn features for objects and relations that are not directly observed in the data .",
    "examples of latent feature models are tensor factorization  @xcite and embedding models  @xcite .",
    "the majority of these models can be understood as more or less complex neural networks operating on object and relation representations .",
    "gaifman models can also be used to learn knowledge base embeddings .",
    "indeed , one can show that it generalizes or complements existing approaches .",
    "for instance , the universal schema  @xcite considers pairs of objects where relation membership variables comprise the model s features .",
    "we have the following interesting relationship between universal schemas  @xcite and gaifman models . given a knowledge base @xmath16 .",
    "the gaifman model for @xmath16 with @xmath146 , @xmath147 , @xmath148 , @xmath149 and @xmath150 is equivalent to the universal schema  @xcite for @xmath16 up to the base model class @xmath66 .",
    "more recent methods combine embedding methods and inference - based logical approaches for relation extraction  @xcite .",
    "contrary to most existing multi - relational ml models  @xcite , gaifman models natively support higher - arity relations , functional and type constraints , numerical features , and complex target queries .",
    "r6.6 cm    [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     table  [ exp - table ] lists the experimental results for different parameter settings @xmath151 $ ] .",
    "the gaifman models achieve the highest hits@10 and hits@1 values for both data sets .",
    "as expected , the more neighborhood samples are used to compute the probability estimate @xmath152 the better the result . when the entire @xmath153-neighborhood is considered ( @xmath154 ) , the performance for wn18 does not deteriorate as it does for fb15k .",
    "this is due to the fact that objects in wn18 have on average few neighbors .",
    "fb15k has more variance in the gaifman graph s degree distribution ( see figure  [ fig - node - distr ] ) which is reflected in the better performance for smaller @xmath64 values .",
    "the experiments also show that it is beneficial to generate a large number of representations ( both positive and negative ones ) .",
    "the performance improves with larger number of training examples .",
    "the runtime experiments demonstrate that gaifman models perform inference very efficiently for @xmath155 .",
    "figure  [ fig - runtimes ] depicts the number of query answers the gaifman models are able to serve per second , averaged over relation types .",
    "a query answer returns the probability for one object pair .",
    "these numbers include neighborhood generation and network inference .",
    "the results are promising with about @xmath156 query answers per second ( averaged across relation types ) as long as @xmath64 remains small .",
    "since most object pairs of wn18 have a @xmath153-neighborhood whose size is smaller than @xmath157 , the answers per second rates for @xmath158 is not reduced as drastically as for fb15k .",
    "gaifman models are a novel family of relational machine learning models that perform learning and inference within and across locally connected regions of relational structures .",
    "future directions of research include structure learning , more sophisticated base model classes , and application of gaifman models to additional relational ml problems .",
    "a.  bordes , x.  glorot , j.  weston , and y.  bengio .",
    "joint learning of words and meaning representations for open - text semantic parsing . in _ conference on artificial intelligence and statistics _ ,",
    "pages 127135 , 2012 .",
    "a.  carlson , j.  betteridge , b.  kisiel , b.  settles , e.  r. hruschka , and t.  m. mitchell . toward an architecture for never - ending language learning . in _",
    "twenty - fourth aaai conference on artificial intelligence _ , 2010 .",
    "i.  i. ceylan , a.  darwiche , and g.  van den broeck .",
    "open - world probabilistic databases . in _ proceedings of the 15th international conference on principles of knowledge representation and reasoning ( kr )",
    "_ , 2016 .",
    "m.  gardner and t.  m. mitchell .",
    "efficient and expressive knowledge base completion using subgraph feature extraction . in _ proceedings of the 2015 conference on empirical methods in natural language processing _ , pages 14881498 , 2015 .",
    "g.  ji , k.  liu , s.  he , and j.  zhao .",
    "knowledge graph completion with adaptive sparse transfer matrix . in d.  schuurmans and m.  p. wellman , editors , _ proceedings of the thirtieth aaai conference on artificial intelligence _ , pages 985991 , 2016 .",
    "y.  lin , z.  liu , h.  luan , m.  sun , s.  rao , and s.  liu .",
    "modeling relation paths for representation learning of knowledge bases . in _ proceedings of the 2015 conference on empirical methods in natural language processing ,",
    "emnlp 2015 , lisbon , portugal , september 17 - 21 , 2015 _ , pages 705714 , 2015 .",
    "t.  trouillon , j.  welbl , s.  riedel ,  .",
    "gaussier , and g.  bouchard .",
    "complex embeddings for simple link prediction . in _ proceedings of the 33nd international conference on machine learning _ , volume  48 , pages 20712080 , 2016 ."
  ],
  "abstract_text": [
    "<S> we present discriminative gaifman models , a novel family of relational machine learning models . </S>",
    "<S> gaifman models learn feature representations bottom up from representations of locally connected and bounded - size regions of knowledge bases ( kbs ) . </S>",
    "<S> considering local and bounded - size neighborhoods of knowledge bases renders logical inference and learning tractable , mitigates the problem of overfitting , and facilitates weight sharing . </S>",
    "<S> gaifman models sample neighborhoods of knowledge bases so as to make the learned relational models more robust to missing objects and relations which is a common situation in open - world kbs . </S>",
    "<S> we present the core ideas of gaifman models and apply them to large - scale relational learning problems . </S>",
    "<S> we also discuss the ways in which gaifman models relate to some existing relational machine learning approaches . </S>"
  ]
}