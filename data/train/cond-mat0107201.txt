{
  "article_text": [
    "during the last decade the question of how to make most efficient use of the data sampled during a monte carlo ( mc ) simulation has received an increasing amount of attention .",
    "the idea of _ reweighting _ @xcite of time - series data from a single canonical simulation at a given fixed value of a coupling parameter ( i.e. , most commonly temperature or magnetic field ) to nearby regions of the coupling - parameter space , allows for the analysis of thermal averages as continuous functions of external parameters and thus a much more precise determination of extremal , pseudo - critical points . as an extension of this , the combination of data from simulations at _ different _ points in the coupling - parameter space , commonly known as _ multi - histogram technique _",
    "@xcite , in principle allows to get accurate estimates for thermal averages over a macroscopical region of couplings from a relatively small number of simulation ( that , however , generally has to be increased with the size of the system ) .",
    "the basic problem with collapsing data from different simulations is that of finding the correct relative normalization of the single histograms . consider the sampled energy histogram @xmath2 of , e.g. , an ising model simulation at the coupling @xmath3 , consisting of @xmath4 energy - measurements .",
    "the thermal average of an observable @xmath5 at @xmath6 is just given by the time - series average in the importance - sampling scheme and thus insensitive to the value of the partition function at that point .",
    "combining two histograms , however , amounts to the combination of the temperature - independent expressions @xmath7 for different simulations @xmath8 , where the partition function @xmath9 appears as a normalization constant .",
    "thus , for correct relative normalization of the histograms to be combined , one has to know the ratio of partition functions @xmath10 or , equivalently , differences in the free energy densities @xmath11 at the simulated couplings @xmath6 . in ref .",
    "@xcite this problem has been solved by an iterative solution of self - consistency equations for the free energy differences at adjacent simulation couplings @xmath6 .    since the combination given in eq .",
    "( [ simple_density ] ) is nothing but an estimator for the density of ( energy ) states @xmath12 , multi - histograming data analysis amounts to estimating the density of states of the variable that is thermodynamically conjugate to the considered coupling parameter .",
    "going to the random - cluster representation of the potts model , i.e. , its interpretation as correlated percolation model @xcite , the relevant density of states is given by the number @xmath13 of bond configurations with @xmath14 bonds and @xmath15 clusters on the lattice .",
    "apart from gaining control over _ two _ parameters , the thermal coupling @xmath1 and the number of states @xmath0 , this language suggests the use of cluster estimators for thermal averages like correlation functions , which are known to yield a variance - reduction in certain situations @xcite .",
    "one of us @xcite has proposed a multi - histogram technique for the @xmath0-state potts model and simulations at different temperatures making use of the sampling of cluster decompositions of the lattice as they occur in the swendsen - wang cluster - update algorithm @xcite . there , the relative normalization of the individual histograms at couplings @xmath6 is accomplished by making use of the known absolute number of configurations with @xmath14 active bonds on the lattice , which is just given by the binomial @xmath16 , @xmath17 being the total number of bonds of the lattice . while this method appears advantageous at first sight and",
    "gives nice results from the cases of percolation ( @xmath18 ) @xcite and the ising model ( @xmath19 ) @xcite , we find that this procedure is not the best choice of normalization for simulations of potts models with @xmath0 larger than 2 or 3 and propose a different approach for normalization to circumvent this problem .",
    "the outline of the paper is as follows . in section",
    "ii we restate the multi - histogram approach of ref .",
    "@xcite in the random - cluster representation ( `` rc histograming '' ) , which was originally formulated for simulations at fixed @xmath0 only , and generalize it to simulations of multiple @xmath0 values . applying it to the @xmath20 potts model in two dimensions",
    "we find large deviations from the expected results . as an alternative , in section iii we propose an adaptively normalized rc multi - histograming ansatz .",
    "we discuss details of its implementation and present a comparative reweighting analysis for the @xmath20 case . for energy - related observables",
    "we also compare histograming in the random - cluster language to the sampling of the _ energy _ density of states in the well - known framework of histograming in the energy / magnetization language ( `` em histograming '' ) @xcite . comparing both methods , in section",
    "iv we track down the observed deviations with the first ansatz to be a result of the application of the above mentioned normalization condition .",
    "this problem can thus be resolved by the second ansatz .",
    "finally , section v contains our conclusions .",
    "consider the hamiltonian of the @xmath0-state potts model in zero magnetic field , @xmath21 on a general graph @xmath22 with @xmath23 sites and @xmath17 bonds . transforming to the random - cluster representation @xcite , the partition function becomes @xmath24 where the sum runs over all bond configurations @xmath25 on the graph ( subgraphs ) , and @xmath26 denotes the thermal coupling .",
    "notice that the formulation ( [ random_cluster ] ) in contrast to that of eq .",
    "( [ potts_hamilton ] ) allows for a natural continuation of the model to _ non - integer _ values of the parameter @xmath0 . using the subgraph expansion of the @xmath0-state potts in external field , one of us @xcite has shown that the @xmath0-state potts model can be considered as a bond - correlated percolation model ( bcpm ) with bond occupation probability @xmath27 .",
    "( [ random_cluster ] ) can be rewritten as : @xmath28 where @xmath13 denotes the number of subgraphs of @xmath22 with @xmath14 activated bonds and @xmath15 clusters resulting therefrom .",
    "this purely combinatorial quantity corresponds to the density of states of the bcpm .",
    "the swendsen - wang cluster - update algorithm generates bond configurations drawn from the equilibrium canonical distribution of this model .",
    "thus , the probability for the occurrence of a subgraph with @xmath14 bonds and @xmath15 clusters is given by @xmath29 which in turn is the expectation value of the normalized sampled histogram of bond configurations , i.e. , @xmath30 , where @xmath4 denotes the length of the time series of measurements .",
    "here , we separated the common factor @xmath31 from the partition function : @xmath32 an estimator for the density of states @xmath13 is therefore given by @xmath33 since the reduced partition function @xmath34 is _ a priori _ unknown , the correct normalization of this estimator is not known at the beginning .",
    "probably the most obvious way of fixing the normalization would be to estimate the reduced partition function @xmath34 directly from eq .",
    "( [ first_nt_est ] ) .",
    "one can do better than that , however , by considering the accumulated density @xmath35 , which is obviously just a binomial @xcite , @xmath36 imposing this restriction on the estimate @xmath37 also , one arrives at @xmath38 so that the absolute values of @xmath37 are now fixed by @xmath17 independent normalization conditions , one for each number of active bonds @xmath14 .",
    "thus we have the following estimate for the density of states @xcite : @xmath39    now , we want to combine the estimates @xmath40 from several simulations at different parameters @xmath41 , i.e. , we want to do multi - histograming in both parameters , @xmath42 and @xmath0 .",
    "then , we have @xmath43 since we want to minimize the variance @xmath44 $ ] of the final estimate and the different simulations are statistically independent , the correct choice of the weights @xmath45 obviously is given by @xmath46}{\\sum_i      1/\\hat{\\sigma}^2[\\hat{g}^{(i)}(b , n)]}.\\ ] ] from eq .",
    "( [ single_nt_est ] ) we have @xmath47 & = & \\hat{c}^2_{p_i , q_i}(b)\\,q_i^{-2n}\\ ,    \\hat{\\sigma}^2[\\hat{h}_{p_i , q_i}(b , n ) ] \\nonumber \\\\    & \\approx & \\hat{c}^2_{p_i , q_i}(b)\\,q_i^{-2n}\\,\\hat{h}_{p_i , q_i}(b , n ) ,    \\label{sigma_nt}\\end{aligned}\\ ] ] such that the variance - optimized estimate for @xmath13 becomes @xmath48}^2\\,q_j^{2n}\\ ,      [ \\hat{h}_{p_j , q_j}(b , n)]^{-1}}.    \\label{nt_abs}\\ ] ] in writing this expression we allow for several approximations : first , we treat @xmath49 as a parameter in eq .",
    "( [ sigma_nt ] ) instead of taking its own variance into account ; this is justified by the clear suppression of variance of this quantity as a sum as compared to the the variance of its summands @xmath50 .",
    "secondly , we take @xmath51=\\hat{h}(b , n)$ ] , i.e. , we treat the individual bins @xmath52 as independently distributed according to an uncorrelated @xmath53 statistics , which will in general not be exactly fulfilled . since those assumptions only affect the variance of the final estimate , however , and do not introduce a bias , we consider them justified",
    ". finally , we do not take autocorrelations between successive measurements @xmath52 into account , i.e. , we assume here and in the following that measurements in the sampling process are taken with a frequency around @xmath54 , where @xmath55 denotes the integrated autocorrelation time , resulting in an effectively uncorrelated time series",
    ".    8.75 cm    ( 1,0.7 ) ( -0.00886287625418057 , -0.0313628762541806 )    8.75 cm    ( 1,0.7 ) ( -0.0173913043478261 , -0.0313628762541806 )    8.75 cm    ( 1,0.7 ) ( -0.0173913043478261 , -0.0313628762541806 )    8.75 cm    ( 1,0.7 ) ( -0.0117056856187291 , -0.0313628762541806 )    8.75 cm    ( 1,0.7 ) ( -0.0117056856187291 , -0.0313628762541806 )    8.75 cm    ( 1,0.7 ) ( -0.00459866220735784 , -0.0313628762541806 )    from the partition function eq .",
    "( [ partition ] ) we infer the following cluster - language estimators for the free energy density @xmath56 , the per - site internal energy @xmath57 and specific heat @xmath58 , @xmath59 ,    \\label{hu_thermal}\\end{aligned}\\ ] ] cf .",
    "appendix a. here , the estimated expectation value of an observable @xmath60 is defined as @xmath61    for the evaluation of magnetic observables one has to distinguish percolating clusters , denoted by indices @xmath62 , from non - percolating , finite clusters , denoted by indices @xmath63 .",
    "let @xmath64 be the set of clusters of a subgraph @xmath65 of the lattice and @xmath66 the number of sites in cluster @xmath67 of @xmath65 .",
    "then , consider the following microcanonical averages : @xmath68 i.e. , the average number of sites in percolating clusters for subgraphs with @xmath14 active bonds and @xmath15 clusters , @xmath69 ^ 2,\\ ] ] i.e. , the mean square number of sites in non - percolating clusters for those subgraphs , and @xmath70 ^ 2,\\ ] ] i.e. , the mean squared sum of the size of non - percolating clusters .",
    "these microcanonical averages obviously can be estimated by adding @xmath71 to @xmath72 for each bond configuration @xmath65 with @xmath73 , where @xmath74 should be taken @xmath75 for non - percolating bond configurations , adding @xmath76 ^ 2 $ ] to @xmath77 , and adding @xmath78 ^ 2 $ ] to @xmath79 for each such observed configuration .",
    "then , if we define @xmath80 we have the following estimates for @xmath81 , @xmath82 , and @xmath83 , @xmath84 which , finally , result in the following expressions for the ( zero - field ) magnetization @xmath85 and the magnetic susceptibility @xmath86 , @xmath87 \\nonumber \\\\      & & + \\frac{q-1}{q^2}\\left\\langle m_3^{\\phi}\\right\\rangle_{\\hat{g}},\\end{aligned}\\ ] ] cf .  appendix a. note , that we simply add up histograms from different simulations in eqs .",
    "( [ histo_sum ] ) and ( [ mest ] ) without using any reweighting factors in @xmath42 and @xmath0 .",
    "this is correct since the conditional probability of the occurrence of , say , a given number of sites in percolating clusters in a subgraph with @xmath14 active bonds and @xmath15 clusters does no longer depend on @xmath42 and @xmath0 .",
    "the order parameter @xmath88 of the potts model is given by @xcite @xmath89 and the corresponding , rescaled susceptibility is @xmath90 ^ 2\\tilde{\\chi}$ ] .    as a first comparative test for the method we performed a swendsen - wang cluster mc simulation for the ising model case ( @xmath19 ) on a small , simple - cubic @xmath91 lattice with periodic boundary conditions .",
    "we gathered histograms from 9 different simulations at the couplings @xmath92 and @xmath93 , where the couplings are given in the language of the ising model in this case , i.e. , are half of the couplings of the corresponding @xmath19 potts model .",
    "each run sampled @xmath94 bond configurations resulting in corresponding time series of @xmath52 and of the energy / magnetization pairs @xmath95 for comparison with the em histograming method .",
    "thus , any differences in the results must be solely due to the method of data analysis , the underlying simulation data being exactly identical .",
    "for the em histograms throughout this paper we use a multi - histogram analysis according to ref .",
    "@xcite very similar to that presented for the rc histograms in sec .",
    "figure  [ ising_hu_sf ] shows the results in comparison to the exact expression for @xmath96 and @xmath97 on square lattices as given by kaufman @xcite and analysed by ferdinand and fisher @xcite .",
    "statistical errors for both analysis schemes were evaluated using the `` jackknife '' error estimation technique @xcite .",
    "the relative deviations @xmath98 from the exact result are noticeably larger for the rc histogram analysis , however in agreement with statistical errors in both cases , cp .",
    "[ ising_hu_sf](b ) .",
    "the same holds true for the internal energy @xmath99 given by the different estimates , which is not shown in fig .",
    "[ ising_hu_sf ] .",
    "note that for the energy related observables from eq .",
    "( [ hu_thermal ] ) only the limiting distribution @xmath100 is needed , which , in general , has a different width than the distribution of energies @xmath101 , thus leading to different variances .    in fact , by inspection of the random - cluster expression for the specific heat eq .",
    "( [ hu_thermal ] ) and comparison with its definition in the energy language as @xmath102 we can infer the following relation between the variances of energy estimates in the rc and em schemes : @xmath103 thus , energy estimates from rc histograms are always less precise than those from em histograms , regardless of the temperature .",
    "figure [ energy_error](a ) shows the ratio of jackknife - estimated variances of the two different estimates of internal energy , compared to the result from eq .",
    "( [ energy_error_eq ] ) with the exact expressions for @xmath99 and @xmath97 for the @xmath19 case inserted @xcite .",
    "note , that from fig .",
    "[ energy_error](a ) this quantity seems to have extremely small finite - size corrections . as a reminder , this shows clearly that cluster estimators are not always improved estimators @xcite , but sometimes `` deteriorated estimators '' .",
    "note , however , that this effect will decrease with increasing number of states @xmath0 , at least in the transition region , since the singularity in @xmath97 sharpens in this limit , whereas the energies @xmath99 always stay in the range @xmath104 .",
    "for the @xmath20 model is has been observed that at the transition point @xmath100 is almost indistinguishable from @xmath101 , when suitably rescaled @xcite . the minimum of the exact curve of fig .",
    "[ energy_error ] at the critical point is somewhat in contrast to the usual notion that cluster estimators work best off criticality @xcite ; this result , however , applies to the spin - spin correlation function at medium and long distances and to magnetic observables like the susceptibility , which is the integral of the correlation function , whereas the internal energy @xmath99 constitutes the extreme short distance limit of this quantity . for the magnetic observables",
    "@xmath88 and @xmath105 the situation is reversed , the variance of the rc estimators being strongly reduced as compared to the em estimators , cp .  fig .",
    "[ energy_error](b ) .",
    "note that in contrast to the em case , the rc estimators provide a single consistent definition of @xmath88 and @xmath105 for both , the broken and unbroken phases , cf .",
    "appendix a.    for the free energy , on the other hand , deviations for the rc method are by far smaller than those of the em method , cp .",
    "[ ising_hu_sf](c ) .",
    "moreover , deviations are not covered by statistical errors in the latter case , a fact we will comment on later in the next section . in the em case @xmath96 is being fixed by making contact with the non - interacting limit @xmath106 resp .",
    "@xmath107 , where @xmath108 so that @xmath109 .",
    "this equation corresponds to the normalization condition eq .",
    "( [ sum_rule ] ) .",
    "it is obvious that having a normalization condition for each number @xmath14 of active bonds and therefore , implicitly , for each ( microcanonical ) temperature in the rc case allows for accurate estimation of the free energy even far away from @xmath110 , whereas for em histograms the results deteriorate with the distance from the only normalization point @xmath106 .",
    "thus , for sampling free energies the rc multi - histogram technique normalized by eq .",
    "( [ sum_rule ] ) seems to be a good choice .    as a slightly less trivial example we performed simulations for the @xmath20 potts model on the same lattice , which exhibits a strongly first - order phase transition",
    "it is well known that cluster algorithms are not efficient to reduce the `` super - critical '' ( exponentially strong ) slowing down of the local mc dynamics at first - order transitions .",
    "for the small lattice under consideration , however , autocorrelation times are still quite moderate , so that one gets reliable results without having to resort to more sophisticated methods like multi - canonical simulations @xcite .",
    "we gathered data from 11 single - histogram simulations at couplings @xmath111 with @xmath112 measurements each .",
    "figure [ q10_hu_sf ] shows the quite astonishing results for the internal energy from this simulation data using the analyses in the rc and em languages , respectively .",
    "naturally , we do not have exact results to compare with in this case ; nevertheless , the results from the em analysis are completely in agreement with our expectations and also well compatible with results from previous simulations @xcite .",
    "so , obviously , the results from the rc histogram analysis are strikingly wrong  and in a way that is clearly not covered by the present statistical errors .",
    "obviously , the results for the specific heat , which are not shown , look even worse , with a pronounced , unphysical double - peak resulting from the deviations in internal energy shown in fig .",
    "[ q10_hu_sf ] .    8.75 cm    ( 1,0.7 ) ( -0.00459866220735784 , -0.0313628762541806 )    since as one of its major strengths in the rc approach we have the possibility of reweighting in the parameter @xmath0 also , as a first clue to the reason for this conspicuous failure we show the outcome of using the @xmath19 simulation data from above for determining the internal energy of the @xmath20 case , cp .",
    "[ q10_ising_hu_sf ] .",
    "the agreement with the direct em analysis of the @xmath20 simulations is remarkably good considering the large distance in @xmath0 between the simulation and analysis points . comparing figs .",
    "[ q10_hu_sf ] and [ q10_ising_hu_sf ] it is quite natural to suspect that the application of the normalization condition ( [ sum_rule ] ) is not a proper choice for simulation data from larger @xmath0 models .    8.75 cm    ( 1,0.7 ) ( -0.00744147157190635 , -0.0270986622073578 )",
    "to understand this normalization problem let us shortly go back to the sampling of the energy density of states @xmath12 for the case of the two - dimensional @xmath19 ( ising ) model . here ,",
    "exact results are not only available for thermal averages , but for @xmath12 itself @xcite . using the @xmath110 normalization condition ( [ omega_norm ] ) , a single - histogram estimator for the density of states in the energy language",
    "would be given by @xmath113 this works quite well in the high - temperature phase and for small lattices . for lower temperatures",
    ", however the histogram loses contact with the normalization point @xmath110 , resulting in large deviations from the correct normalization , cp .",
    "[ omega_fig ] .",
    "clearly , each simulation samples only a rather small window of energy space ; from the exponential in the denominator of eq .",
    "( [ omega_est ] ) , however , configurations near the maximal energy @xmath114 receive the largest weight in the sum , so that missing those configurations , which is the case for large @xmath1 , results in an exponentially wrong normalization factor ( linear in @xmath115 ) .",
    "in other words , the absolute normalization condition ( [ omega_norm ] ) reweights the histogram data to the point @xmath110 , which will have no reliable outcome if the overlap between the histograms at the simulation coupling and at @xmath110 is too small or even vanishes .",
    "note also , that the statistical error bars given in fig .",
    "[ omega_fig ] do not reflect this fundamental failure , although it is statistical in nature .",
    "this is due to the fact that the usual implementation of error estimation schemes for histograms take the error of histogram bins without entries to be zero , whereas according to @xmath53 statistics it should in some sense be considered infinitely large .",
    "8.75 cm    ( 1,0.7 ) ( -0.00886287625418057 , -0.0313628762541806 )    expecting a similar sampling - related normalization failure for the rc histograms normalized by the condition ( [ sum_rule ] ) let us relax this absolute normalization and apply an adaptive normalization scheme as in the original em multi - histograming formulation of ref .",
    "consider single - histogram estimates of the partition function from simulations at @xmath41 and define reduced free energies @xmath116 as @xmath117 from eq .",
    "( [ first_nt_est ] ) estimates of the density @xmath13 from the single histograms @xmath118 are given by : @xmath119 once again combining these estimates in a variance - optimized way as above in section ii , treating the @xmath116 as parameters with zero variance , we arrive at the following expression @xmath120^{-1}}.    \\label{selfcon_1}\\ ] ] now , from this estimate one has the following _ a posteriori _ relation for computation of the parameters @xmath116 : @xmath121 eqs .",
    "( [ selfcon_1 ] ) and ( [ selfcon_2 ] ) form a pair of equations to be solved self - consistently for the determination of the parameters @xmath116 , which can be straightforwardly iterated by plugging in the results for @xmath116 from eq .",
    "( [ selfcon_1 ] ) into eq .",
    "( [ selfcon_2 ] ) and vice versa",
    ". one can improve on that by applying more sophisticated iteration schemes like , e.g. , the newton - raphson iteration @xcite .",
    "we find , however , that the radius of convergence of this method is quite small ; therefore , we adaptively revert to the simple iteration if the procedure leaves the newton - raphson convergence region .",
    "it is obvious that for the iteration to converge , one needs some overlap between the @xmath122 histograms between `` adjacent '' simulations , i.e. , at least pairwise overlap .",
    "apart from this restriction , however , we find this iterative scheme to be very well - behaved , converging rapidly in every case that fulfils the overlap - condition .",
    "to get started , we use first - guess values of the @xmath116 from thermodynamic integration .",
    "assume that the simulation points @xmath123 are ordered such that the histograms of @xmath124 and @xmath125 have reasonable overlap ; then @xmath126 is a good starting point for the described iteration scheme .",
    "@xmath127 can be chosen arbitrarily , since the given pair of equations is obviously invariant under a global shift @xmath128 .",
    "thus , we have determined the final estimate @xmath37 only up to a global factor . to fix this last normalization",
    "we propose two different possibilities ; on the one hand , we can use the free model limit , i.e. , evaluate @xmath129 from eq .",
    "( [ selfcon_2 ] ) and use eq .",
    "( [ omega_norm ] ) for any @xmath0 : @xmath130 on the other hand , also the @xmath131 partition function is trivial , @xmath132 = 0 ,    \\label{q0norm}\\ ] ] and can serve as normalization point for arbitrary @xmath42 . in practice",
    "the best choice depends on the set of simulated couplings @xmath133 ) : for large-@xmath0 simulations one might want to resort to eq .",
    "( [ p0norm ] ) , while otherwise eq .",
    "( [ q0norm ] ) should be the better choice .",
    "now , we can re - consider the internal energy of the @xmath20 case from above with the new , adaptively normalized rc multi - histograming scheme .",
    "figure [ q10_adapt_hu_sf ] shows internal energy and free energy from this analysis as compared to the em multi - histogram approach .",
    "as far as the error estimates are concerned , we apply the jackknife process to the whole iteration run , i.e. , the iteration scheme for fixing the weights @xmath116 is done for each jackknife block of data separately , taking full account of statistical errors .",
    "clearly , now the results from both approaches perfectly agree , the deviations of fig .",
    "[ q10_ising_hu_sf ] have vanished . as anticipated in sec .",
    "ii , also the cluster estimator for the internal energy performs noticeably better than in the @xmath19 case , such that  at least in the critical region  it is quite comparable in precision to the em estimator , cp .",
    "[ energy_error_q10 ] .    for the free energy it is obvious that with the adaptive normalization scheme of rc histograms we lose the especially high precision throughout the whole @xmath1 region obtained by the application of the sum rule ( [ sum_rule ] ) in fig .",
    "[ ising_hu_sf ] for the ising model . to amend this , having fixed the relative normalization of the single histograms adaptively , one might consider applying the sum rule ( [ sum_rule ] ) to the final result @xmath37 instead of using the normalizations eq .",
    "( [ q0norm ] ) or eq .",
    "( [ p0norm ] ) .",
    "this , however , gives results looking almost identical to those shown above in fig .",
    "[ q10_hu_sf ] , i.e. , the large deviations reappear , which clearly reveals the source they are resulting from .    8.75 cm    ( 1,0.7 ) ( -0.0117056856187291 , -0.0313628762541806 )",
    "the effect of this normalization problem should also be clearly seen in the final estimates for the density of states @xmath13 from the two rc histograming methods . in fig .",
    "[ density_plot ] we show a density plot of the relative differences of the estimated density of states @xmath37 from the absolutely normalized histograming scheme of eq .",
    "( [ nt_abs ] ) , @xmath134 , and of the adaptively normalized scheme of eqs .",
    "( [ selfcon_1 ] ) and ( [ selfcon_2 ] ) , @xmath135 , i.e. , the quantity @xmath136 note that the range of possible value pairs @xmath52 is restricted by two simple bounds in the @xmath52 plane .",
    "first , starting from the point @xmath137 each added bond can at most reduce the number of clusters by one , namely by connecting two previously unconnected clusters , i.e. , one has @xmath138 on the other hand , starting from the `` opposite '' point @xmath139 one has @xmath140 bonds per site , so that for producing a new cluster one must at least remove @xmath141 bonds , @xmath142 or , for the square lattice , @xmath143 apart from single points near those bounds , all configurations within this triangle can actually appear in a potts model simulation with non - vanishing probability .    8.75 cm    ( 1,0.7 ) ( 0.01 , 0.0 )    now , from fig .",
    "[ density_plot ] it is obvious , given that the estimate @xmath135 is correct up to an overall factor , that the absolutely normalized histograming estimate @xmath134 gives too large estimates for @xmath14 values near the centre @xmath144 as compared to the other regions of @xmath14 ( dark shading in fig .",
    "[ density_plot ] ) . then , considering again the deviation in internal energy shown in fig .",
    "[ q10_hu_sf ] , its origin becomes clear : the histogram @xmath145 for a simulation somewhat below the transition point will be centred around the line @xmath146 in fig .",
    "[ density_plot ] ; then , using the density of states estimate @xmath134 for evaluating @xmath99 , the parts of the histogram lying to the right of @xmath146 will have too large weight as compared to the values @xmath147 , thus by eq .",
    "( [ hu_thermal ] ) resulting in a too large estimate for the internal energy @xmath99 . on the other hand , for couplings above the transition",
    "point the histogram will be centred around @xmath148 with too large weights for @xmath149 , leading to estimates for @xmath99 that are too low . directly in the vicinity of the transition point , deviations in normalization are symmetric with respect to the histogram , which will be centred around @xmath150 , thus leading to an unbiased estimate for @xmath99 .",
    "this is exactly the behavior found in fig .",
    "[ q10_hu_sf ] . finally , contemplating on the reason for the deviations in normalization shown in fig .",
    "[ density_plot ] in the first place , it becomes obvious that they have the same origin as those shown in fig .",
    "[ omega_fig ] . the exponential factor @xmath151 from the sum rule eq .",
    "( [ sum_rule_data ] ) attaches large weight to the configurations with small number of clusters @xmath15 ; if , however , histograms miss entries for small @xmath15 , as is the case for histograms in the transition region @xmath152 of fig .",
    "[ density_plot ] , the sum @xmath153 will become too small , resulting in too large normalization factors @xmath154 .",
    "( 1,0.7 ) ( -0.0131270903010033 , -0.0313628762541806 )    thus , for the application of the sum rule ( [ sum_rule ] ) to the final result from the adaptively normalized rc histograming scheme to work reliably , one always has to include histograms from small-@xmath0 simulations , like percolation ( @xmath18 ) or the ising model ( @xmath19 ) , that produce configurations with relatively small numbers of clusters @xmath15 . to illustrate this , we combined the data from the @xmath19 and @xmath20 simulations reported above , used the histograming scheme eqs .",
    "( [ selfcon_1 ] ) and ( [ selfcon_2 ] ) to get results for @xmath20 and applied the sum rule eq .",
    "( [ sum_rule ] ) afterwards , i.e. , the normalization of the single histograms was found adaptively , whereas the total histogram was normalized by the sum rule ( [ sum_rule ] ) ; this yields results for the internal and free energies indistinguishable from those of the pure @xmath20 results of fig .",
    "[ q10_adapt_hu_sf ] . for the free energy , however , the size of statistical errors is largely affected by the final normalization , cf .   fig .",
    "[ q10_free_error ] . for most of the couplings shown , the estimate from the finally sum - rule - normalized density of states is up to about 10 times more accurate in terms of the statistical errors .",
    "the presence and size of such a gain for a given coupling is not mainly physically motivated , but rather depends on the relation of the simulation points @xmath155 to the points of data analysis .",
    "we have considered multi - histogram data analyses of time series from cluster - update monte carlo simulations of the @xmath0-state potts model in the random - cluster language .",
    "generalizing the original formulation of ref .",
    "@xcite to the case of simulations of different number of states @xmath0 , we found the original ansatz of absolutely normalizing the individual histograms with a geometrical sum rule for finite - length time series to produce large deviations from the expected behavior when applied to cases @xmath0 larger then about @xmath156 or @xmath157 in two dimensions .",
    "we track this error down to a mismatch between exponential suppression of a part of the state space @xmath52 and a simultaneous exponential enhancement of this region in the sum rule eq .",
    "( [ sum_rule_data ] ) . to circumvent this problem",
    ", we propose a different ansatz , normalizing the histograms adaptively via a set of self - consistency equations aiming at the minimization of the variance of the final estimate of the density of states @xmath13 .",
    "absolute normalization over the whole temperature region can still be maintained by making contact with the trivial partition function of the percolation limit @xmath18 or by combining large- and small-@xmath0 data and applying the sum rule ( [ sum_rule ] ) after the adaptive normalization .",
    "this new approach does not exhibit the limitations of the absolutely normalized ansatz to small-@xmath0 simulations .    comparing the newly introduced , adaptively normalized random - cluster `` rc '' multi - histogram technique with multi - histograming in the energy / magnetization `` em '' language",
    ", we can make the following statements : ( a ) the cluster variables @xmath52 form the natural state space for the analysis of the potts model . using the swendsen - wang cluster - update algorithm ,",
    "these numbers are automatically known as a by - product of the update - steps ; no additional measurement steps are needed .",
    "( b ) the rc representation allows for reweighting in both parameters , the thermal coupling @xmath42 resp .",
    "@xmath1 , and the number of states @xmath0 , without systematical errors as in the partial transformation of ref .",
    "@xcite . especially , the model can be considered for the case of non - integer @xmath0 .",
    "it is easy to combine data from different-@xmath0 simulations to enhance the accuracy for large @xmath0 .",
    "( c ) cluster estimators occur naturally in the rc language .",
    "although we found that short - distance observables like the internal energy and specific heat are sampled systematically less acurate by cluster estimators , this situation is reversed for observables sensitive to long - range order like the magnetization , susceptibility and correlation functions . also , even short - range cluster estimators perform comparable to em language estimators for larger @xmath0 values , at least in the transition region . in the rc language ,",
    "the magnetic observables can be defined consistently throughout the broken and unbroken phases , cf .",
    "appendix a.    apart from that , the combination of data from small and large @xmath0 models can serve as a new method to cope with the super - critical slowing down at the first - order transitions for large @xmath0 : for sufficiently large lattices simulation runs will entirely stay in one of the pure phases depending on the initial configuration and boundary conditions due to ergodicity breaking at the transition point .",
    "however , combining such data with smaller-@xmath0 simulations from the second - order or weak first - order regime allows the adaptive normalization scheme to still find the correct normalization of the pure - phase histograms without real tunneling events .",
    "this approach is similar in spirit to the simulated tempering technique @xcite .",
    "one might also think of applying the multi - canonical @xcite resp .",
    "multi - bondic @xcite simulation approach or one of the related techniques to the sampling of the density of states @xmath13 .",
    "especially , application of the absolute normalization eq .",
    "( [ sum_rule ] ) to this case might be of interest .",
    "this approach is currently under investigation .",
    "however , sampling the complete range of possible values in the @xmath52 plane with sufficient accuracy is found to be a computationally very demanding problem .",
    "in contrast , in the current approach , we still stick to the physically sensible approach of importance - sampling , i.e. , sampling the phase - space according to the local canonical weights .",
    "furthermore , we are able to take full advantage of the computational gain of cluster algorithms , whereas the generalized - ensemble algorithms put forward so far employ local updates ( apart from the multi - bondic algorithm of ref .",
    "@xcite ) .    as an interesting application of our ansatz we suggest the analysis of the tri - critical point @xmath158 , where the order of the thermal transitions changes from second to first order , in three dimensions .",
    "there has been quite some debate about the location of this point , estimates ranging from @xmath159 @xcite to @xmath160 @xcite .",
    "furthermore , the universality class , critical exponents etc .  of this transition have not yet been properly analyzed .",
    "a test for the @xmath161 case in two dimensions shows that our method is well suited for such an analysis .",
    "this problem will be considered in a forthcoming publication .",
    "the collaboration of the authors has been supported by daad - nsc grant no .",
    "mw acknowledges support by the dfg through the `` graduiertenkolleg qft '' .",
    "consider the potts model coupled to an external magnetic field @xmath162 with hamiltonian @xmath163 then , the random - cluster representation of the partition function on a graph @xmath164 consisting of @xmath23 sites and @xmath17 edges ( bonds ) is given by @xmath165 \\nonumber \\\\    & = & e^{k{\\cal e}}\\,\\sum_{{\\cal g } ' \\subseteq { \\cal g } }     p^{b({\\cal g}')}(1-p)^{{\\cal e}-b({\\cal g } ' ) } \\nonumber \\\\    & & \\times \\prod_c\\,[(q-1)+e^{bn_c}],\\end{aligned}\\ ] ] where the product runs over the set of clusters @xmath166 of the subgraph @xmath25 , @xmath167 is the number of sites in cluster @xmath67 , @xmath26 is the thermal coupling parameter and @xmath168 denotes the reduced magnetic field .",
    "@xmath27 is the probability for the activation of bonds .    the zero - field , per - site internal energy @xmath169",
    "is then given by @xmath170 \\nonumber \\\\    & = & -\\frac{1}{\\cal n}\\left\\langle\\frac{\\frac{\\partial}{\\partial k }          [ ( e^k-1)^b]}{(e^k-1)^b}\\right\\rangle = -\\frac{1}{p}\\left\\langle\\frac{b}{\\cal n}\\right\\rangle,\\end{aligned}\\ ] ] which shows the close connection between the @xmath14 and @xmath171 distributions .",
    "the zero - field specific heat @xmath172 follows from @xmath173 = \\frac{k^2}{\\cal n}\\left[-\\frac{1}{p^2}\\langle        b\\rangle^2+\\left\\langle\\frac{\\frac{\\partial^2}{\\partial            k^2}[(e^k-1)^b]}{(e^k-1)^b}\\right\\rangle\\right ] \\nonumber \\\\        & = & \\frac{k^2}{p^2{\\cal n}}\\left[\\langle b^2\\rangle-\\langle            b\\rangle^2-(1-p)\\langle b\\rangle\\right ] .",
    "\\end{aligned}\\ ] ]    in the thermodynamic limit , the per - site , zero - field `` magnetization '' @xmath174 is given by @xmath175      \\nonumber \\\\      & = & \\lim_{b\\rightarrow 0+}\\,\\lim_{{\\cal          n}\\rightarrow\\infty}\\,\\frac{e^{k{\\cal e}}}{z_{p , q}({\\cal g},b)}\\ ,      \\sum_{{\\cal g } ' \\subseteq { \\cal g}}p^{b({\\cal g}')}(1-p)^{{\\cal e}-b({\\cal g } ' ) }      \\prod_c\\,[(q-1)+e^{bn_c}]\\,\\sum_{c'}\\frac{n_c'}{\\cal        n}\\,\\frac{e^{bn_c'}}{(q-1)+e^{bn_c ' } }      \\nonumber \\\\      & = & \\lim_{b\\rightarrow 0+}\\,\\lim_{{\\cal n}\\rightarrow\\infty}\\,\\left [        \\left\\langle\\sum_{c^{\\pi } } \\frac{n_c^{\\pi } } { \\cal            n}\\,\\frac{1}{(q-1)e^{-bn_c^{\\pi}}+1}\\right\\rangle        + \\left\\langle\\sum_{c^{\\phi}}\\frac{n_c^{\\phi}}{\\cal            n}\\,\\frac{1}{(q-1)e^{-bn_c^{\\phi}}+1}\\right\\rangle      \\right ] .",
    "\\end{aligned}\\ ] ]    here , we split the cluster contributions of the subgraph into percolating clusters @xmath176 and non - percolating , finite clusters @xmath177 . in the indicated order of taking the limits , first @xmath178 and then @xmath179 , the factors @xmath180 take the values @xmath75 and @xmath181 for percolating and non - percolating clusters @xmath67 , respectively .",
    "thus , we arrive at @xmath182 which explicitly reflects the symmetry - breaking nature of the percolating configurations . for the order parameter @xmath88 , which varies between @xmath75 for the completely disordered state and @xmath181 for the ground states ,",
    "we find @xmath183 for finite lattices one can retain this definition since the notion of percolating and non - percolating clusters is still well - defined . note , that this gives a consistent definition of the order parameter throughout the disordered and broken phases .",
    "in contrast , in the em language one has to explicitly break symmetry in the low - temperature phase , which is usually done by defining @xmath184 whereas for the unbroken phase one uses @xmath185 obviously , for finite lattices , the expectation values of the rc and em definitions will not coincide exactly ; critical exponents , however , will of course agree .",
    "@xmath186      \\nonumber \\\\          & = & -{\\cal n } m^2 + \\lim_{b\\rightarrow 0+}\\,\\lim_{{\\cal          n}\\rightarrow\\infty}\\left[\\left\\langle\\sum_{c}\\frac{n_c^2}{\\cal          n}\\frac{1}{(q-1)e^{-bn_c}+1}\\right\\rangle +       { \\cal n}\\left\\langle\\left(\\sum_{c}\\frac{n_c}{\\cal            n}\\frac{1}{(q-1)e^{-bn_c}+1}\\right)^2\\right\\rangle\\right .      \\nonumber \\\\      & & \\hspace{7.9 cm } + \\hspace{0.4cm}\\left.\\left\\langle\\sum_{c}\\frac{n_c^2}{\\cal            n}\\frac{1}{[(q-1)e^{-bn_c}+1]^2}\\right\\rangle\\right ] \\nonumber \\\\      & = & { \\cal          n}\\left(\\frac{q-1}{q}\\right)^2\\left[\\left\\langle\\left(\\sum_{c^{\\pi}}\\frac{n_c^{\\pi}}{\\cal          n}\\right)^2\\right\\rangle-\\left\\langle\\sum_{c^{\\pi}}\\frac{n_c^{\\pi}}{\\cal          n}\\right\\rangle^2\\right]+\\frac{q-1}{q^2}\\left\\langle\\sum_{c^{\\phi}}\\frac{{n_c^{\\phi}}^2}{\\cal          n}\\right\\rangle .",
    "\\label{cluster_sus }    \\end{aligned}\\ ] ]    from eq .",
    "( [ cluster_sus ] ) one recognizes the widely used improved cluster estimator for the high - temperature phase , namely the last term .",
    "note , however , that the original improved estimator includes _ all _ clusters here instead of only the non - percolating ones , which makes a difference for finite lattices . for finite lattices ,",
    "once again , from eq .",
    "( [ cluster_sus ] ) we have a single definition for both , the unbroken and broken phases ."
  ],
  "abstract_text": [
    "<S> using the random - cluster representation of the @xmath0-state potts models we consider the pooling of data from cluster - update monte carlo simulations for different thermal couplings @xmath1 and number of states per spin @xmath0 . </S>",
    "<S> proper combination of histograms allows for the evaluation of thermal averages in a broad range of @xmath1 and @xmath0 values , including non - integer values of @xmath0 . due to restrictions in the sampling process </S>",
    "<S> proper normalization of the combined histogram data is non - trivial . </S>",
    "<S> we discuss the different possibilities and analyze their respective ranges of applicability . </S>"
  ]
}