{
  "article_text": [
    "in several applications involving time series , it is of interest to describe how the evolution of variables over time depends on latent characteristics or the focus may be on the dynamics of unobservable characteristics measured by variables observed at consecutive time occasions .",
    "these issues are addressed by hidden markov models and a widespread application of them has occurred in several fields such as speech recognition , signal processing , digital communication , biology , reliability etc . , standard references are macdonald and zucchini , 1997 and 2009 , capp et al . , 2005 , among others .",
    "basically , an hidden markov model assumes that an observable time series depends on an unobservable markov chain in such a way that the joint process is also markovian .    in this work ,",
    "we focus on discrete hidden markov models with a multivariate categorical observable process depending on a multivariate latent chain , so we observe more variables at each time and assume that their distribution can be affected by one or more latent variables .",
    "we will refer to these extensions of the traditional hidden markov process as multiple hidden markov models ( mhmms ) .",
    "mhmms can be well suited to applications where all the observable time series are affected by one common unobservable factor ( general effect ) and each observable variable is also governed by its specific latent variable .",
    "mhmms may also handle time series data where an unobservable aspect influences the marginal dynamics of each observable variable while another latent factor influences the association among them . in the framework of mhmms ,",
    "different sets of observable categorical time series are allowed to depend on different sets of unobservable processes and the observable variables are not required to be independent given the latent states ( local independence assumption ) , but the association between them is also modeled . moreover , in mhmms , the multivariate latent process can satisfy the hypotheses of granger noncausality and contemporaneous independence described by colombi and giordano ( 2012 ) for multivariate markov chains .",
    "therefore , mhmms widen the opportunities of applications of the classical hidden markov models .",
    "this approach , for example , responds to the shortcomings highlighted in zucchini and guttorp , 1991 , who proposed a model for describing the sequence of wet and dry days at 5 sites without taking into account the spatial dependence among sites situated in closed locations and without allowing for a multivariate state process with sites in different regions responding to different components of the latent process .",
    "other examples illustrated in the literature can be enriched of more flexible and realistic hypotheses using mhmms .    in mhmms ,",
    "the state space @xmath0 is the cartesian product of the state spaces of the single latent variables .",
    "these models , without restrictions on the transition probabilities of the latent chain are useless as they are equivalent to the conventional hidden markov model ( hmm ) with a number of states equal to the cardinality of @xmath1 .",
    "however , the conventional hmm has an extremely large number of parameters and can not be easily used to discover interesting independence structures in the transition matrix of the latent chain and in the distributions of observable variables given the latent states , while mhmms enable us to formulate meaningful constraints offering advantages of parsimony and interpretability .    in the sequel , to make easier the interpretability of the proposed models , we will associate graphical markov models to mhmms whose probabilities will be parameterized by marginal models .",
    "thus , our contribution stays also in taking advantages of the use of graphical and marginal models into the framework of hidden markov processes .",
    "the paper is organized as follows .",
    "mhmms are presented in section 2 .",
    "the transition probabilities of the latent model and the distributions of observable variables given the latent states are required to obey the markov properties of a mixed and a chain graph , respectively , in section 3 .",
    "finally , we will show in section 4 that the independencies among the observable and latent variables of the mhmm can be easily verified by testing linear constraints on parameters of marginal parameterizations ( bergsma and rudas , 2002 ) of the transition probabilities and the probabilities of the observations given the latent states .",
    "let @xmath2 be a @xmath3-variate process of categorical variables , @xmath4 @xmath5 @xmath6 , @xmath7 , @xmath8 and let @xmath9 be a @xmath10-dimensional process of categorical variables @xmath11 @xmath12 @xmath13 , @xmath14 .",
    "the random variables @xmath15 , @xmath16 take values in finite sets @xmath17 and @xmath18 @xmath19 , @xmath20 .",
    "one realization of the process @xmath9 at a given time is denoted by @xmath21 , and the realization of @xmath2 is @xmath22 in @xmath23 . for every subset @xmath24 and @xmath25 ,",
    "marginal processes are represented by @xmath26 and @xmath27 univariate marginal processes will be denoted by @xmath28 , @xmath29 , @xmath30 .",
    "the following definition states when ( @xmath2 , @xmath9 ) is an mhmm .    the joint process ( @xmath2 , @xmath9 ) is an mhmm if    * @xmath2 is not observable * ( @xmath2 , @xmath9 ) is a first order multivariate markov chain * @xmath31 * @xmath32 .",
    "in particular , condition @xmath33 implies that @xmath2 is a first order markov chain ( colombi and giordano , 2011 ) .",
    "the marginal process @xmath34 , @xmath35 , of an mhmm ( @xmath2 , @xmath9 ) is hidden markov too , whereas in general @xmath36 , @xmath24 , is not a hidden markov model .",
    "the following theorem clarifies when the properties of an mhmm are preserved after marginalizing the latent and observable processes .",
    "[ marg ] let @xmath37 and @xmath38 , @xmath24 and @xmath35 , be marginal processes of the latent and observable components of an mhmm @xmath39 .",
    "the marginal process @xmath36 is still an mhmm if and only if the following conditions are satisfied for all @xmath40 @xmath41 @xmath42    this theorem is a special case of the results presented in colombi and giordano ( 2011 ) where the statement ( [ m ] ) is proved to ensure that the marginal process @xmath37 of the latent component @xmath43 is still a markov chain .",
    "condition ( [ li ] ) states that observable variables @xmath44 at time @xmath45 depend only on the latent variables @xmath46 .      here",
    ", we discuss some special cases of mhmms which generalize the linked and coupled hidden markov models proposed in the literature in the simple version with two observable variables and two latent processes ( koski , 2001 , brand et al . , 1997 ) .    in our generalized version of linked hidden markov models ,",
    "every set of a partition of the latent variables is affected only by its own past , while in the coupled hidden markov models , these sets are independent conditionally on the past of every latent variable . in all the mentioned models ,",
    "every set of the partition of the latent variables influences one and only one set of a partition of the manifest variables and the sets of the observable variables are independent given the latent states .",
    "a formal definition is presented below .",
    "( linked and coupled mhmms).[linked ] the joint process ( @xmath2 , @xmath9 ) is a linked mhmm , with @xmath47 components if and only if there is a partition of the latent variables @xmath48 and a partition of the observable variables @xmath49 such that the following conditions are satisfied for all the unions of variables @xmath50 , @xmath51 , @xmath52",
    "@xmath53 @xmath54 @xmath55 if condition ( [ linked ] ) is replaced by @xmath56 the process ( @xmath2 , @xmath9 ) satisfying ( [ obslat ] ) , ( [ obs ] ) and ( [ coupled ] ) is called coupled mhmm .    it is worthwhile to note that according to theorem [ marg ] , the marginal processes ( @xmath57 , @xmath58 , @xmath59 , of a linked mhmm are still mhmms , but this is not true for a coupled mhmm .",
    "we stress that it is important to involve the unions of variables @xmath50 , @xmath51 in the conditions ( [ linked ] ) and ( [ obslat ] ) . in fact , if they were replaced by the weaker version @xmath60 and @xmath61 with @xmath62 , it could happen , for example , that @xmath63 and @xmath64 are marginally affected only by their own past , but @xmath65 is influenced by the past of all the latent variables .",
    "similarly , it could happen that @xmath66 and @xmath67 respond marginally only to @xmath63 and @xmath64 , respectively , but their joint distribution depends on all the latent variables .",
    "moreover in linked mhmm , it could be that the marginal processes @xmath68 and @xmath69 are hidden markov , but @xmath70 is no longer an mhmm .",
    "in this section , we address the use of graphical markov models for mhmms . such models associate missing edges of a graph with some conditional independence restrictions imposed on the probabilities of the observable variables given the latent states and the transition probabilities of the latent process .",
    "the terminology and the notation used throughout the paper follow colombi and giordano , 2012 .",
    "we just briefly remind that @xmath71 is a graph with a finite set of nodes @xmath72 and a set of edges @xmath73 ; moreover , for every non - empty subset of nodes @xmath74 , @xmath75 , @xmath76 , @xmath77 , and @xmath78 are the collection of parents , children , neighbours and spouses of nodes in the set @xmath74 . in particular , here",
    "the nodes can correspond to variables or to processes .",
    "note that every node is neighbour and spouse of itself .",
    "finally , @xmath79 indicates the family of the bi - connected sets in the graph .",
    "we consider two types of graphs : a mixed graph for the latent component of the mhmm and a chain graph for the observable component .",
    "in particular , the transition probabilities of the multivariate latent markov chain @xmath2 in the mhmm are required to obey a set of markov properties encoded by a mixed graph @xmath80 whose basic features are discussed in colombi and giordano , 2012 , for markov chains , while the markov properties satisfied by the distribution of the observable variables conditioned on the latent states are read off a chain graph @xmath81 .    in a mixed graph @xmath80 , a node @xmath82 corresponds to the marginal process @xmath28 , for every @xmath19 , and independence restrictions are associated with missing directed and bi - directed edges , respectively . in particular , missing bi - directed edges lead to independencies of marginal processes at the same point in time ; missing directed edges , instead , refer to independencies which involve marginal processes at two consecutive instants .    a chain graph @xmath81 with two chain components @xmath83 and @xmath84 serves the need to encode the independence relations among observable and latent variables of the mhmm at a given time point . the nodes of the chain graph @xmath81 , belonging to @xmath83 correspond to the random variables @xmath85 , @xmath19 , and the nodes belonging to @xmath84 , correspond to the random variables @xmath86 , @xmath87 , for any arbitrary @xmath88 .",
    "all the edges in the subgraph induced by a chain component are bi - directed and the graph induced by the chain component @xmath83 is bi - complete .",
    "furthermore , the directed edges in graph @xmath81 point in the same direction from @xmath83 towards @xmath84 .",
    "the definition below specifies the properties for an mhmm being markov with respect to a mixed and a chain graph .",
    "( mhmm markov wrt a mixed and a chain graph).[mixchain ] the latent process @xmath2 of an mhmm ( @xmath2,@xmath9 ) is markov wrt a mixed graph @xmath80 if and only if its transition probabilities satisfy the following conditional independencies for all @xmath40 associated to missing directed and bi - directed edges of @xmath80 , respectively : @xmath89 e_{\\mathcal{t}}(t ) { \\protect\\mathpalette{\\protect\\independent}{\\perp}}e_{\\mathcal{u } \\backslash sp_{g}(\\mathcal{t})}(t)|e_{\\mathcal{u}}(t-1 ) \\hspace{1 cm } \\forall \\mathcal{t } \\subset \\mathcal{u}. \\label{c2}\\end{aligned}\\ ] ] the observable process @xmath9 is markov wrt a chain graph @xmath81 if and only if the distribution of the observable variables given the latent states satisfies the following conditional independencies for all @xmath40 associated to missing bi - directed and directed edges of @xmath81 , respectively : @xmath90 f_{\\mathcal{r}}(t ) { \\protect\\mathpalette{\\protect\\independent}{\\perp}}e_{\\mathcal{u } \\backslash pa_{g^*}(\\mathcal{r})}(t)|e_{pa_{g^*}(\\mathcal{r})}(t ) \\hspace{1 cm } \\forall \\mathcal{r } \\subset \\mathcal{v}. \\label{c3b}\\end{aligned}\\ ] ] therefore , an mhmm ( @xmath2,@xmath9 ) is said to be markov wrt a mixed and a chain graph when the latent component is markov wrt a mixed graph , and the observation component given the latent states is markov wrt a chain graph .    in the context of first order multivariate markov chains ,",
    "condition ( [ c3 ] ) corresponds to a notion of granger noncausality and , when @xmath91 , it ensures that the marginal process @xmath37 is a markov chain ( colombi and giordano , 2012 , florens et al . , 1993 ) .",
    "henceforth , we will refer to ( [ c3 ] ) with the term granger noncausality ( g - noncausality ) condition saying that the latent process @xmath92 is not g - caused by @xmath93 with respect to @xmath2 .",
    "condition ( [ c2 ] ) states that the transition probabilities satisfy the bi - directed markov property ( richardson , 2003 ) with respect to the graph obtained by removing the directed edges from the mixed graph . here",
    ", we will refer to ( [ c2 ] ) with the term contemporaneous independence condition and say that the latent processes @xmath94 and @xmath95 are contemporaneously independent .",
    "on the other hand , conditions ( [ c2b ] ) and ( [ c3b ] ) encoded by the chain graph @xmath81 refer to the observable component of the mhmm and are equivalent to the type iv markov properties @xmath96 and @xmath97 discussed by drton , 2009 .",
    "note that conditions ( [ c2b ] ) are bi - directed markov properties which describe a local independence assumption , the independencies ( [ c3b ] ) of a set of manifest variables from a set of latent variables , at time @xmath45 , are conditioned on the remaining latent variables , but not to the remaining observable variables .",
    "missing edges in @xmath81 can be alternatively interpreted as the type i markov properties @xmath98 and @xmath99 proposed by drton , 2009 .",
    "in such a case , bi - directed edges in @xmath81 are usually replaced by undirected edges and the markov properties expressed by the following statements for all @xmath40 @xmath100 f_{\\mathcal{r}}(t ) { \\protect\\mathpalette{\\protect\\independent}{\\perp}}e_{\\mathcal{u } \\backslash pa_{g^*}(\\mathcal{r})}(t)|e_{pa_{g^*}(\\mathcal{r})}(t),f_{nb_{g^*}(\\mathcal{r})}(t ) \\hspace{1 cm } \\forall \\mathcal{r } \\subset \\mathcal{v}. \\label{c3bis}\\end{aligned}\\ ] ] although this type i chain graph model is simpler since it corresponds to zero constraints on standard log - linear parameters of the observation probabilities , in our opinion the independence conditions it encodes are less meaningful than type iv markov properties .",
    "in fact , when the independence of set of observable variables from some latent variables is of interest it seems inappropriate to condition also with respect to the remaining observable variables .    as a matter of convenience ,",
    "the mentioned mixed graph and the two component chain graph can be superimposed as shown in figure [ figrs0 ] to form a unique graph that we will refer to as mixed - chain graph for simplicity .",
    "in all the examples throughout the paper , we implicitly assume that each node of the mixed - chain graph , corresponding to a latent variable , is parent of itself , even if the edge @xmath101 is not reported .",
    "the mixed - chain graph on the right of figure [ figrs1 ] encodes that the latent variables of the three dimensional mhmm are granger caused reciprocally but are contemporaneously independent , i.e. @xmath102 ; moreover , every observable variable depends only on its own latent variable , i.e. @xmath103 , @xmath104 , @xmath105 , @xmath106 @xmath107 , @xmath108 , @xmath109 ; and , at every time point , the observable variables given the latent states are independent , i.e. @xmath110 .    the mixed - chain graph on the left of figure [ figrs1 ] is associated to a 3-variate mhmm where the latent variables are not contemporaneously independent , and each of them depends only on its own past , i.e. the encoded granger noncausality conditions ( [ c3 ] ) are @xmath111 , @xmath112 , @xmath113 , @xmath114 , @xmath115 , @xmath116 ; while the independence conditions ( [ c3b ] ) of manifest from latent variables are @xmath117 and @xmath118 ; the local independence ( [ c2b ] ) is @xmath119 .",
    "( mhmms for marketing and financial data ) .",
    "the mixed - chain graph on the left in figure [ figrsex ] is associated to an mhmm encoding the dynamic relations of three observable time series which depend on two latent factors .",
    "the observable time series can represent , for example , the sales levels of three products that can be interpreted as indicators of the motivational latent states of the customers behaviors .",
    "the distributions of the motivational states may be of interest more than those of the product sales .",
    "the graph underlies that the first two products belong to the same category so their sales series ( @xmath120 ) depend on the latent variable @xmath121 @xmath122 , the sales of the third product respond to a different latent variable @xmath123 @xmath124 ; the observable sales levels are independent given the latent states @xmath125 ; the two motivational latent processes are g - caused reciprocally , so that the past motivational states influence the actual state of each latent variable , but they are contemporaneously independent @xmath126 .",
    "the mixed - chain graph on the right in figure [ figrsex ] can describe a model for financial series where specific and generic latent effects exist .",
    "the series @xmath120 can indicate the trading patterns of two financial traded shares in two different financial sectors .",
    "the presence or the absence of trading may depend on a specific latent aspect typical of each financial sector where the trading takes place ( e.g. the turbulence of the sector ) , so each observable variable depends on one specific latent variable : @xmath127 on @xmath121 , @xmath128 on @xmath123 , but all the trading patterns may be influenced by one common unobservable variable ( @xmath129 ) such as the market turbulence with states that correspond to calm or turbulent phases of the market @xmath130 .",
    "there is local independence @xmath131 .",
    "moreover , the past market turbulence can affect the current turbulence of each financial sector ( g - causality ) whereas a specific latent variable of a sector does not granger cause the other specific latent variable and the turbolence of the market , @xmath132 .",
    "finally there is no contemporaneous relation among the three turbulences @xmath133 .",
    "two final remarks can be advisable .",
    "first , one immediate consequence of theorem [ marg ] and definition [ mixchain ] is the following result    [ cor1 ] if the mhmm @xmath39 is markov wrt a mixed graph @xmath80 and a chain graph @xmath81 , such that @xmath134 and @xmath135 , then the marginal process @xmath36 , @xmath24 , @xmath35 , is an mhmm .",
    "_ conditions ( [ c3 ] ) and ( [ c3b ] ) for @xmath39 being markov with respect to the graphs where @xmath134 and @xmath135 coincide with the conditions ( [ m ] ) and ( [ li ] ) ensuring that @xmath36,@xmath24 , @xmath35 , is still a hidden process .",
    "moreover , the restrictions which the observation and latent models obey in linked and coupled mhmms ( definition 2 ) can be described by the markov properties of mixed and chain graphs as specified in the corollary below .",
    "[ cor2 ] an mhmm @xmath39 which is markov wrt a mixed graph @xmath80 and a chain graph @xmath81 is a linked mhmm with @xmath47 components if , for a partition of the latent variables @xmath48 and a partition of of the observable variables @xmath49 , @xmath136 , it holds that : @xmath137 , @xmath138 and @xmath139 if the condition @xmath137 is replaced by @xmath140 , the process @xmath39 markov wrt such graphs is a coupled mhmm .",
    "the proof is omitted as similar to that of corollary 1 .",
    "for instance , in figure [ figrs1 ] , the mixed - chain graph on the left corresponds to a linked mhmm with two components and the mixed - chain graph on the right to a coupled mhmm with three components .",
    "standard hidden markov models , and more in general mixture models , suffer from the non - identifiability problem due to the invariance with respect to relabeling of hidden states .",
    "for this reason , mhmms are identifiable only up to switching the latent categories and the labels of the latent variables . due to the invariance with respect to switching labels of the latent variables , there are mixed - chain graphs equivalent in the sense that they correspond to the same mhmm .",
    "we now clarify this point thoroughly .",
    "two mixed - chain graphs , say @xmath141 and @xmath142 , with the same sets of nodes , are equivalent if there is a bijection @xmath143 which maps the set of nodes corresponding to the latent variables onto itself assuring that : _ i _ ) the nodes @xmath144 of @xmath145and @xmath146 of @xmath142 are associated to latent variables with the same number of states ; _ ii _ )",
    "if @xmath144 , @xmath147 are connected by an edge in @xmath141 then @xmath146 and @xmath148 are connected by the same type of edge in @xmath142 ; _ iii _ ) if @xmath144 , @xmath147 are not connected by any edges in @xmath141 then @xmath146 and @xmath148 are not connected in @xmath142 ; _ iv _ ) if @xmath144 is a parent of @xmath149 in @xmath141 then @xmath146 is a parent of @xmath149 in @xmath142 .",
    "it is evident that two mixed - chain graphs , equivalent according to the previous conditions , encode conditional independencies that differ only for the labels assigned to the latent variables .",
    "an example illustrates the mentioned concepts .",
    "the first line of figure [ figequiv ] shows three equivalent mixed - chain graphs corresponding to an mhmm where a latent variable affects both the observable variables ( generic latent effect ) and each manifest variable is governed by its specific latent variable ( specific latent effect ) . in the second line of figure [ figequiv ]",
    ", the two equivalent mixed - chain graphs identify the mhmm where two latent variables affect only the first two observable variables and another latent variable is specific for the third observable variable .",
    "moreover , the latent variable specific for @xmath150 is contemporaneously independent of the other two latent variables , and there is no granger - causality between this variable and one of the remaining unobservable variables .",
    "till now we have described the hypotheses underlying mhmms , now we need to illustrate how to test such hypotheses .",
    "in particular , all the conditional independencies so far illustrated are related to the natural parameters of the mhmms : the probabilities of the observable variables given the latent states and the transition probabilities of the latent process .",
    "the time - homogeneous joint transition probabilities are denoted by @xmath151 for every pair of states @xmath152 , @xmath153",
    ". moreover , latexmath:[$\\phi_\\mathcal{t}(\\emph{\\textbf{\\text{e}}}_\\mathcal{t }    from state @xmath152 to state @xmath155 with components @xmath156 .",
    "we assume that the initial distribution of @xmath2 is the invariant one and is unique .",
    "finally , @xmath157 indicates the state - dependent distribution that is the conditional probabilities of the observable variables given the latent state @xmath158 and @xmath159 represents the marginal probability of the observable variables in the set @xmath160 given the latent state @xmath158 .",
    "in this section , we propose to parameterize both the state - dependent distributions and the transition probabilities of the latent process through marginal models and verify hypotheses which make these models more parsimonious by constraining marginal parameters . in the marginal models ,",
    "the parameters are called _",
    "marginal interactions_. in particular , marginal interactions are log - linear parameters defined in different marginal distributions in bergsma and rudas ( 2002 ) models , while bartolucci _",
    "et al . _ , 2007 ,",
    "use more general marginal interactions which are meaningful when the variables have an ordinal nature . here",
    ", we adopt a gloneck - mccullagh multivariate logistic model ( gloneck and mccullagh , 1995 ) whose interactions , involving the variables in the set @xmath161 , are log - linear parameters defined on the marginal distributions @xmath162 .    for every observable or latent categorical variable , the first category is called baseline . any observation @xmath163 which includes categories at the baseline level for variables @xmath164 , @xmath165",
    "is denoted by @xmath166 .",
    "a similar notation holds for the latent state @xmath167 . for every non - empty subset @xmath161 of the observable variables @xmath168 and for every @xmath169",
    ", the baseline interactions @xmath170 , @xmath171 , of the gloneck - mccullagh marginal model for the observable variables are contrasts of logarithms of marginal state - dependent probabilities @xmath172 in order to model the dependence of the distribution of the observable variables on the states @xmath173 , we adopt the usual factorial expansion @xmath174    analogously , in the marginal model for the latent component of mhmms , we define , for every @xmath175 , the marginal parameters @xmath176 and the factorial expansion @xmath177      the properties of graphical models for mhmms ( definition [ mixchain ] ) correspond to zero restrictions on the parameters @xmath178 and @xmath179 , introduced in ( [ teta ] ) and ( [ logconstr0b ] ) , as illustrated in the next theorem .",
    "[ param ] for a latent model with strictly positive time - homogeneous transition probabilities , the granger noncausality condition ( [ c3 ] ) is equivalent to @xmath180 for all @xmath181 , while the conditional contemporaneous independence ( [ c2 ] ) is equivalent to @xmath180 for all @xmath182 , @xmath183 , @xmath184 .",
    "moreover , if the state - dependent probabilities are strictly positive , the independence ( [ c2b ] ) is equivalent to @xmath185 for all @xmath186 , while condition ( [ c3b ] ) corresponds to @xmath185 for all @xmath187 , @xmath188 , @xmath189 , @xmath190 .",
    "_ the equivalence between the zero restrictions on @xmath191 parameters and conditions ( [ c3 ] ) and ( [ c2 ] ) follows from colombi and giordano , 2012 , the nullity of @xmath192 parameters under the conditions ( [ c2b ] ) and ( [ c3b ] ) from marchetti and lupparelli , 2011 .",
    "the theorem allows a simple implementation of standard methods to fit and test mhmms under the restrictions ( [ c3 ] , [ c2 ] , [ c2b ] , [ c3b ] ) .",
    "the theorem enhances the use of the marginal parametrization since all the conditions ( [ c3 ] , [ c2 ] , [ c2b ] , [ c3b ] ) are equivalent to linear constraints on the marginal parameters , the same restrictions under the log - linear parametrization would correspond to non linear constraints on the parameters .",
    "moreover , since corollary [ cor1 ] proves that conditions ( [ m ] ) and ( [ li ] ) are particular cases of the independencies ( [ c3 ] ) and ( [ c3b ] ) , the constraints on marginal parameters described in theorem [ param ] are useful also for testing if the properties of an mhmm are preserved after marginalizing the latent and observable processes .",
    "an example clarifies which marginal parameters are restricted to zero in order to satisfy the conditional independencies that correspond to the markov properties of the mixed - chain graph .",
    "the left mixed - chain graph of figure [ figese3 ] encodes the following markov properties : @xmath193 so that @xmath121 is no granger caused by @xmath123 and @xmath194 for @xmath195 @xmath196 which reveals a specific effect of the first ( second ) latent variable on the first ( second ) observable variable . according to theorem [ marg ] , these conditions ensure that the marginal process @xmath197 , @xmath198 of the mhmm is still hidden markov , but @xmath199 , @xmath200 is not .",
    "moreover , the local independence condition @xmath201 can be also read off the same graph .",
    "the mentioned conditional independencies are equivalent to the nullity of the following parameters : @xmath202 , @xmath203 , @xmath204 , @xmath205 , @xmath206 @xmath207 , @xmath208 , @xmath209 , @xmath210 , @xmath211 .",
    "in the right graph of figure [ figese3 ] there is contemporaneous independence between the two latent variables , i.e. @xmath212 that is equivalent to the zero restrictions on @xmath213 , @xmath214 , @xmath215 , @xmath216 . as for the left graph , the parameters @xmath206 , @xmath207 , @xmath208 , @xmath209 are null according to the local independence condition .      in the framework of hidden markov models with several latent and observable variables , other interesting hypotheses , that do not correspond to any conditional independence , can be easily formulated .",
    "these hypotheses reduce the number of parameters needed to parameterize the transition and observation probabilities . a useful restriction that considerably simplifies the observation model is the hypothesis of _ additivity _ of the effects of the latent variables on the marginal interactions of the observable variables .",
    "this marginal additive dependence allows the interactions to be expressed by the factorial expansion @xmath217    note that under this hypothesis , the parameters @xmath218 described in ( [ teta ] ) are null if @xmath219 a similar additivity hypothesis can be used for the interactions of the latent model @xmath220    another hypothesis is that of _ invariant association _ corresponding to the constraints @xmath221 , if @xmath222 . according to this hypothesis the interactions between observable variables",
    "do not depend on the states of the latent variables .",
    "similarly , the constraints for the invariant association can be also imposed to the interactions of the latent model : @xmath223 , if @xmath222 .",
    "in this section , we fit different mhmms on two data sets . the em algorithm used for estimating the models",
    "is described in colombi and giordano , 2011 , and implemented in the r - package hmmm by colombi et al . , 2012 .",
    "the data set of a soft - drink company ( ching _ et al .",
    "_ , 2002 , available also in the r - package hmmm ) consists of a one - year time series of daily sales of soft - drinks : lemon tea , orange juice and apple juice , all with categories : low , medium , high level .",
    "changes in sale outcomes over time can depend on time - varying unobservable factors and we consider an mhmm with two dichotomous latent variables to model these data .      among others , we tested the hypotheses that the latent components @xmath227 and @xmath228 are marginally markov chains and that the tea sales depend on @xmath227 only , the orange and apple juices sales on @xmath228 only .",
    "that is we test for condition ( [ c3 ] ) of double granger noncausality ( in short _",
    "nogranger _ ) for the latent variables : @xmath229 and @xmath230 which ensure that @xmath227 and @xmath228 are univariate markov chains and the restriction ( [ c3b ] ) of conditional independencies for the observable variables given the latent chains : @xmath231 and @xmath232 that we will refer to as _ ci_. these restrictions serve to assure that the marginal processes @xmath233 and @xmath234 are still hidden markov models .",
    "additional hypotheses tested for the observable model are : the invariant association ( _ ia _ ) mentioned in section 4.2 meaning that the interactions of second and higher order of the observable variables do not depend on the latent states , i.e. @xmath235 for @xmath236 , and the local independence ( [ c2b ] ) ( in short _ ind _ ) of all the observable variables given the latent chain latexmath:[${f}_{t}(t ) { \\protect\\mathpalette{\\protect\\independent}{\\perp}}f_{o}(t ) { \\protect\\mathpalette{\\protect\\independent}{\\perp}}f_{a}(t )      table  [ cogiotab ] reports the likelihood ratio tests ( lrt ) , degrees of freedom ( df ) and p - values for models restricted under the mentioned hypotheses against the unrestricted model , the number of parameters ( par ) , the values of the log - likelihood function ( loglike ) and the akaike criterion ( aic ) .",
    "the mhmm with the lowest aic value is also the most parsimonious model ( last row in table  [ cogiotab ] ) which corresponds to the mixed - chain graph illustrated in figure [ bevande ] .",
    "it encodes the properties of double granger noncausality and invariant association for the latent component of the mhmm , the local independence and the specific dependence of the observable variables on the latent chains for the observable component of the mhmm .",
    "the second data set , available at @xmath238 , reports daily measurements ( from december 2006 to november 2010 ) of electric power consumption in one household .",
    "the energy ( in watt - hour of active energy ) from the sub - meter 1 corresponds to the kitchen , containing mainly a dishwasher , an oven and a microwave ; the energy from the sub - meter 2 is used for the laundry room , containing a washing - machine , a tumble - drier , a refrigerator and a light ; energy from sub - meter 3 corresponds to an electric water - heater and an air - conditioner . here ,",
    "the energy consumptions registered over 4 years by the sub - meters 1 , 2 , and 3 , are categorized in low and high levels according to whether the real measurements are under or over an established threshold , and @xmath239 , @xmath240 and @xmath241 indicate the resulting categorical time series .",
    "the categorized consumptions for kitchen , laundry and heater are the manifest variables used as indicators of the true need of energy for eating , cleaning and heating / cooling which is unobservable directly",
    ". the latent real request of energy , in fact , can be lower ( higher ) than the measured level due , for example , to waste ( saving need ) .",
    "therefore , we model the energy data through an mhmm involving three latent variables with two states and three observable binary variables .",
    "several hypotheses has been considered to describe the relations among the observable series and the latent factors , but in the sequel we will focus only on those models which better perform in terms of interpretability , parsimony and fitting .      among the alternatives to the saturated model",
    ", a simple and intuitive linked mhmm considers that each of the three observable series of energy consumptions is an indicator of its specific latent variable and the observable variables are locally independent .",
    "regarding the latent model , the three unobservable variables affect each others at the same time but each one depends only on the proper past ( no granger causality and no contemporaneous independence ) .",
    "this linked mhmm ( @xmath245 , @xmath246 , @xmath247 ) can not be preferred to the saturated model .",
    "also the coupled mhmm with every observable variable depending on its own latent variable and with contemporaneous independence and granger causality among the three latent variables ( @xmath248 , @xmath249 , @xmath250 ) is outperformed by the saturated model .",
    "unfortunately , although combined with other different hypotheses on the latent component of the mhmm , the model restricted under the assumption of a specific effect of each latent variable on one and only one energy consumption series shows an unsatisfactory performance with an higher aic value than that of the saturated model .",
    "an interesting model with a better fit assumes that : there is a specific effect of one latent variable on the energy consumptions for kitchen and laundry , another latent variable influences the energy consumptions for the heater , and there is a generic effect since a third latent variable affects all the manifest variables .",
    "this observation model is combined with the assumption that granger causality and contemporaneous independence exist among all the latent variables .",
    "the model with these restrictions has @xmath251 , @xmath252 , @xmath253 .",
    "its corresponding mixed - chain graph is reported in figure [ grafofinale ] on the left .",
    "the mhmm which seems the most suitable for representing the dynamics of the energy consumptions , among several models we fitted , assumes that : the first two latent variables are g - caused reciprocally , the third one depends only on its past , and there is contemporaneous independence among the three latent factors ; moreover , there is local independence among the consumptions of the energy for eating , cleaning and air - conditioning which seem to depend on all the three latent variables ( @xmath254 , @xmath255 , @xmath256 ) .",
    "its mixed - chain graph is reported in figure [ grafofinale ] on the right .",
    "this model is nested in an mhmm which shows a similar fit but admits that there is granger causality among all the latent variables , the other hypotheses being equal ( @xmath257 , @xmath258 , @xmath259 ) .",
    "when the two models are compared , the lrt ( @xmath260 ) confirms that the most parsimonious model can be retained coherently with the aic results .",
    "15 bartolucci , f. , colombi , r. and forcina , a. ( 2007 ) . an extended class of marginal link functions for modelling contingency tables by equality and inequality constraints .",
    "_ statistica sinica _ , * 17 * , 691711 .",
    "bergsma , w. p. and rudas , t. ( 2002 ) .",
    "marginal models for categorical data . _",
    "the annals of statistics _ , * 30 * , 140159 .",
    "brand , m. , oliver , n. and pentland , a. ( 1997 ) . coupled hidden markov models for complex action recognition .",
    "proceedings of ieee computer society conference on computer vision and pattern recognition , 994999 .",
    "ching , w.k . , fung , e.s .",
    "and ng , m.k.(2002 ) . a multivariate markov chain for categorical data sequences and its applications in demand predictions .",
    "_ i m a j. manag . math .",
    "_ , * 13 * , 187199 .",
    "colombi , r. and giordano , s. ( 2011 ) .",
    "testing lumpability for marginal discrete hidden markov models .",
    "_ advances in statistical analysis _ , * 95 * , 293311 ."
  ],
  "abstract_text": [
    "<S> _ we introduce multiple hidden markov models ( mhmms ) where an observed multivariate categorical time series depends on an unobservable multivariate mar- kov chain . </S>",
    "<S> mhmms provide an elegant framework for specifying various independence relationships between multiple discrete time processes . </S>",
    "<S> these independencies are interpreted as markov properties of a mixed graph and a chain graph associated to the latent and observable components of the mhmm , respectively . </S>",
    "<S> these markov properties are also translated into zero restrictions on the parameters of marginal models for the transition probabilities and the distributions of the observable variables given the latent states . _    * keywords and phrases : * granger noncausality ; conditional independence ; marginal models ; graphical models . </S>"
  ]
}