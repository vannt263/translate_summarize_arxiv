{
  "article_text": [
    "quantum key distribution ( qkd ) is a way to share secret keys between separated parties ( alice and bob ) with negligibly small leakage of its information to an unauthorized third party , eve . the first qkd protocol , bb84 , was introduced by bennett and brassard in 1984 @xcite , and its unconditional security was first proven by mayers @xcite in a bit complicated manner . after the first proof",
    ", researchers have tried to prove its security in a simple manner . some proofs",
    "are based on the entanglement distillation protocol ( edp ) idea @xcite , and others rely on uncertainty principle @xcite or information - theoretic approach @xcite .    in edp - based security proofs , we usually assume implicitly that bob has a detector which can discriminate between vacuum , single - photon , and multi - photon states in order to distill a qubit state , while this is not the case for the security proof based on uncertainty principle @xcite , i.e. , the conventional on - off detectors ( threshold detectors ) can be used in this case . on the other hand",
    ", the edp - based security proof can apply to many protocols , including bb84 with two - way classical communications @xcite , with decoy states @xcite , for b92 @xcite , and so on @xcite , however , the security proof based on uncertainty principle can not directly apply to these protocols .",
    "thus , it is important to consider from experimental or theoretical viewpoints how to accommodate the use of threshold detectors in edp - based security proof , or to consider how to apply the uncertainty principle idea to the other protocols .    in this paper",
    ", we first prove unconditional security of bb84 with threshold detectors based on the argument of virtual edp , which is valid regardless of one - way or two - way classical communications . in order to show its security , instead of assuming photon - number discriminating detectors",
    ", we introduce an explicit _ squash operator _ in the virtual protocol , which transforms bob s incoming multi - photon state to a qubit state .",
    "then we suppose that they run a virtual edp on the obtained qubit pairs in order to extract secret keys .",
    "if one - way classical communications are used in this setup , the secret key rate @xmath0 from the single photon part is @xmath1 , where @xmath2 and @xmath3 are the phase and the bit error rates in the virtual protocol . as a consequence of introducing an explicit squash operator , all of the formulas for key generation rate given in the preceding literatures of edp - based security proofs are valid with threshold detectors , even when multi - photon emission is taken into account @xcite or with decoy states @xcite .",
    "our formulation also applies to the case of two - way classical communications @xcite , hence the bit error rate threshold of 20% or higher is true with threshold detectors as well .    by using the same technique",
    ", we also prove the security of the bennett - brassard - mermin 1992 ( bbm92 ) protocol @xcite , where alice and bob both use threshold detectors ( see fig.[fig:2a ] ) . in the bbm92 protocol , a third party supplies entangled states to alice and bob , and they measure it with the same set of bases as in bb84",
    ". if both the receivers have photon - number discriminating detectors and can reject incoming multi - photon states , this protocol is theoretically equivalent to bb84 . when threshold detectors are used , however , the security of this protocol is not straightforward , and we will give the security proof for this scheme in this paper .",
    "the assumptions that we make for theoretical description of bb84 are as follows .",
    "first , it is assumed that alice s signals are block diagonalized with respect to photon number , and thus one can treat events having different photon numbers as distinct classical events .",
    "moreover , we assume that alice s mixed states in the @xmath4 basis and the one in the @xmath5 basis are the same , i.e. , there is no basis information flow from alice s source .",
    "we also suppose that when alice emits a multi - photon state , all information regarding that bit is freely leaked to eve due to the photon - number splitting attack @xcite .",
    "it is proven , however , that we can still generate a secret key as long as alice s signals contain a sufficiently high ratio of single - photon states @xcite .",
    "this ratio can be well - monitored by the decoy state method @xcite , resulting in longer distances of communications .",
    "thus , only single - photon emission part is important , to which we restrict our attention in this paper .",
    "another assumption we make is that all imperfections of alice s and bob s devices , i.e. , non - unit quantum efficiency of bob s detectors , dark counts , miss - alignment , etc .",
    ", are under eve s control .",
    "this is the so - called _ untrusted devise scenario _ , and with this hypothesis we are in a situation where alice s and bob s devices are all perfect .",
    "in addition , we suppose that bob s phase modulator acts on multi - photon states as linear operations on tensor product states .",
    "in other words , they transform each photon contained in a signal independently , whether they are in a superposition or not ( for more details , see sec .",
    "[ eq : bob_operations ] ) .    finally , when bob s two detectors click simultaneously ( coincidence count ) , he assigns a random bit to the corresponding event .",
    "these assumptions are also made in our security proof of bbm92 except that alice , as well as bob , plays the role of a receiver .",
    "that is , imperfections of apparatuses are attributed to eve s attack , and alice s and bob s phase modulators transform their incoming multi - photon states as tensor products .",
    "if a coincident - detection event occurs on either alice s or bob s side , he or she manually replaces it by a random bit .",
    "we emphasize in the case of bbm92 that we do not put any assumption on incoming signals .",
    "this paper is organized as follows .",
    "we describe and formulate our model for actual qkd systems based on bb84 in sec .",
    "[ sec : our_model ] , and convert it into a virtual edp in sec .",
    "[ sec : virtual ] .",
    "[ sec : bbm92 ] is devoted to the security proof for bbm92 .",
    "then finally we conclude in sec .",
    "[ sec : conclusion ] .",
    "in this section we illustrate our setup ( fig.[fig:1a ] ) . as in usual implementations of the bb84 protocol",
    ", alice emits out signal pulses whose phases are chosen randomly out of @xmath6 . among them",
    "we regard a set of phase choices @xmath7 ( respectively , @xmath8 ) as the encodings of bit value @xmath9 in the @xmath4 basis ( respectively , in the @xmath5 basis ) . after traveling eve s regime ,",
    "the signal pulse is again phase - modulated according to bob s random basis choice , and then enters the detection unit consisting of a 50:50 beam splitter followed by two threshold detectors ( det @xmath10 ) , which read out the bit value @xmath11 .",
    "even when coincident detections occur on both detectors , bob does not discard the event and instead assigns a random value for the output @xmath12 .    as mentioned in the introduction",
    ", the goal of this paper is to rigorously prove the security of qkd even when the receiver ( or the receivers ) uses threshold detectors which can not distinguish photon numbers .",
    "hence throughout the paper , we will always take into account the possibility that states which a receiver obtains contain more than one photon . to this end",
    ", we will below formulate general @xmath13-photon states and describe how they are transformed by bob s phase modulations .",
    "denotes bob s threshold detectors .",
    "when two detectors click simultaneously ( coincidence count ) , bob assigns a random bit ( rand ) to the corresponding event . ]",
    "consisting of identical particles with bosonic statistics , a state received by bob is always symmetric under particle permutations @xcite .",
    "hence an @xmath13-particle state in bob s hilbert space @xmath14 can be expanded with basis @xmath15 where @xmath16 , with @xmath17 and @xmath18 repeating @xmath19 and @xmath11 times respectively .",
    "@xmath20 are defined in the @xmath21 basis similarly ( we define @xmath21 basis and @xmath5 basis as @xmath22 ( @xmath23 ) and @xmath24 , respectively ) . thus for example , @xmath25 , whereas @xmath26 and @xmath27 .    using this basis , quantum non - demolition ( qnd ) measurement of @xmath13 photon , to be mentioned below ,",
    "can be represented by kraus operators @xmath28 , where @xmath29 .    as is usually the case for a linear operator on tensor product states , or as one",
    "typically encounters when adding angular momenta @xcite , bob s phase modulator acts on these symmetric states independently in a qubit by qubit manner .",
    "for example , bit flip @xmath30 operates on @xmath31 as @xmath32 , and similarly the hamadard gate transforms @xmath33 as @xmath34 , where @xmath35 in the @xmath4 basis . if one regards qubit operations as rotations of spin-1/2 , these symmetric @xmath13-photon states correspond to a spin-@xmath36 representation .",
    "in fact these formulations are equivalent to those using creation and annihilation operators .",
    "for example , let @xmath37 be the annihilation operator corresponding to @xmath38 , then @xmath39 corresponds to @xmath40 and @xmath41 is reproduced by @xmath42.\\ ] ]    photon detection in general corresponds to a projective measurement with respect to photon - number states in the @xmath4 basis @xmath43 .",
    "since bob s threshold detectors can not discriminate photon numbers in our case , it is assumed that they can only distinguish between vacuum @xmath44 , single detection events @xmath45 , @xmath46 , and coincident detection events @xmath47 .",
    "in this section , in order to prove the security of our qkd , we convert the actual bb84 protocol to an equivalent virtual protocol ( fig . [ fig:1b ] ) .",
    "we do this conversion in two steps .",
    "first , immediately after bob s phase modulator , we introduce an explicit _ squash operator _ @xmath48 , which projects an @xmath13-particle state received from eve into a qubit state ( see edp1 in fig .",
    "[ fig:1b ] ) .",
    "then by using the invariance of @xmath48 under the hadamard transformation @xmath49 , we replace bob s phase modulator with a hadamard operation that follows @xmath48 ( edp2 in fig .",
    "[ fig:1b ] ) . in this edp2 , alice and",
    "bob obtain a pair of qubit states with hadamard operators , as if bob s incoming states were always a single - photon state .",
    "hence we can prove security of our qkd system by following exactly the same argument as in shor - preskill @xcite or in gllp @xcite .",
    "that is , alice and bob can perform a virtual edp to extract secret keys .     by a squash operator @xmath48 . by using the hadamard invariance of @xmath48 , we may interchange the order of bob s phase modulations and @xmath48 , and obtain the second protocol ( edp2 ) . in edp2 , alice and bob",
    "both have a qubit space @xmath50 or @xmath51 with hadamard operations acting on them .",
    "thus by performing a virtual edp in these spaces , they can extract secret keys . ]    first , on alice s side we assume that , instead of randomly choosing the phase of signal states out of @xmath52 , alice takes the following procedure ; she prepares one of the bell states @xmath53 keeps the first one half in @xmath50 ( reference state ) , and sends the second one half in @xmath54 ( signal state ) to eve .",
    "the converted protocol is still equivalent to the original one , since she can effectively emit a random bit @xmath55 by measuring the reference state with @xmath4- and @xmath5-bases .    on receiving the signal pulse",
    ", eve generates an arbitrary state in bob s hilbert state @xmath14 , which in general may be a superposition of any photon number @xmath13 . as a result , alice and",
    "bob end up sharing a state @xmath56 . without sacrificing security",
    ", we may simplify the analysis further by assuming that @xmath57 is actually given from eve to alice and bob .    then on bob s side , we assume that immediately after receiving a pulse , he performs a qnd measurement on the photon number @xmath13 , described by kraus operators @xmath58 .",
    "since this measurement does not disturb the statistics of bob s and eve s data , we can introduce this measurement without loss of generality . to be more precise ,",
    "bob s sifted keys are the same regardless of performing qnd or not .",
    "moreover , since the measurement outcomes are kept secret from eve , she can not behave differently depending on whether he performs the qnd or not . in other words ,",
    "the qnd measurement here is introduced only as a convenient tool for proving the security , and bob need not perform this measurement in the actual protocol . for the sake of simplicity",
    ", we fix the value of @xmath13 from now on , and sometimes suppress its indices . following this measurement , bob projects his state to a qubit state using a _ squash operator _",
    "@xmath48 which converts a state in his @xmath59-dimensional hilbert space @xmath14 to that in a qubit space @xmath51 .",
    "this consists of kraus operators @xmath60 for all combinations of @xmath61 satisfying @xmath62 . with these operators ,",
    "an arbitrary state @xmath63 is converted to @xmath64 in @xmath51 .",
    "as shown in appendix [ app : prop_f ] , these operators indeed satisfy @xmath65 , and thus form a legitimate quantum operation .    this protocol ( edp1 in fig .",
    "[ fig:1b ] ) can indeed be considered as equivalent to the original one , since , as we shall show in appendix [ app : equiv_z_meas ] , the povm elements in the virtual protocol and in the actual protocol corresponding to bob s sifted key bit @xmath66 take exactly the same forms .",
    "hence eve can never distinguish the two protocols .",
    "moreover , as we shall show in appendix [ sec : hadamard_invariance ] , our squash operation @xmath48 is in fact invariant under the hadamard transformation @xmath49 .",
    "that is , for an arbitrary input state @xmath63 , we have @xmath67 in other words , applying the hadamard transformation in bob s @xmath59-dimensional space @xmath14 is equivalent to applying it in the squashed qubit state @xmath51 .",
    "hence we may assume that bob s hadamard transformation and the squash operator @xmath48 are actually interchanged , as in edp2 in fig .",
    "[ fig:1b ] .",
    "then by supposing that , instead of immediately conducting @xmath4-basis measurements , alice and bob perform a virtual edp on a qubit - pair state in their squashed qubit spaces @xmath68 , the standard argument for security proofs due to shor and preskill @xcite can be directly applied .",
    "this means that , even when threshold detectors are used , all the previous security proofs for bb84 based on a virtual edp ( e.g. , @xcite ) are valid , including the ones involving two - way classical communications @xcite or decoy states @xcite .",
    "by the same arguments as above , it is straightforward to prove the security of the bbm92 protocol where alice and bob both use threshold detectors .    in the actual bbm92 protocol ,",
    "entangled states are supplied to alice and bob from a third party who is not necessarily trusted . upon receiving pulses , alice and bob modulate and measure them in randomly chosen @xmath5 or @xmath4 basis , and then output sifted key bits by selecting out events where their choices of basis match .",
    "if a coincident - detection event occurs , the receiver assigns a random value to the output bit @xmath69 or @xmath12 ( fig .",
    "[ fig:2a ] ) .         and",
    "obtain qubit states in @xmath70 and @xmath51 . by using the hadamard invariance of @xmath48 ,",
    "we may interchange the order of phase modulations and @xmath48 s , and obtain edp2 , where both parties apply the hadamard gate @xmath49 on the squashed qubit states @xmath70 and @xmath51 . ]    in this case as well , by using the equivalence of povm elements for @xmath4-basis measurements ( appendix [ app : equiv_z_meas ] ) , this protocol can be equivalently converted into the first virtual protocol ( edp1 in fig.[fig:2b ] ) , where alice and bob apply squash operations @xmath48 after phase modulations . then due to the hadamard - invariance of @xmath48 in eq .",
    "( [ eq : f_invariance ] ) , we may interchange the order of phase modulations and @xmath48 s . as a result",
    ", we obtain our second virtual protocol ( edp2 in fig.[fig:2a ] ) , where both parties apply @xmath49 on the squashed qubit states @xmath70 and @xmath51 . here",
    "@xmath70 denotes alice s qubit space . in this edp2 , the standard shor - preskill - type argument for security proof can be applied to prove the security .",
    "in this paper , we gave a rigorous security proof for bb84 , which is valid even when the actual bob uses threshold detectors .",
    "the key ingredient here was the introduction of an explicit squash operator @xmath48 in the virtual protocol , which projects bob s @xmath13-photon state into a qubit space and still preserves their transformation property under the hadamard transformation .",
    "our results show that all the formulas for key generation rates obtained in previous proofs based on a virtual qubit entanglement distillation protocol are valid even with threshold detectors .",
    "in particular , one can tolerate a higher error rate up to 20% with two - way classical communications @xcite .",
    "in addition , by using the same technique , we also proved the security of bbm92 protocol , where alice and bob both use threshold detectors .",
    "_ note added_. recently , similar results regarding construction of squash operators were obtained independently by beaudry , moroder and ltkenhaus @xcite . a security proof of bbm92 with threshold detectors",
    "was also given independently by koashi et al .",
    "@xcite , although the techniques used there were different from ours .",
    "* acknowledgments *    the authors would like to thank t. moroder , m. curty , h .- k . lo and , especially , m. koashi for enlightening discussions .",
    "this work was supported by the project  research and development on quantum cryptography of the national institute of information and communications technology , \" as part of ministry of internal affairs and communications of japan s program  r&d on quantum communication technology . \"",
    "in this appendix we discuss and prove some important properties of our squash operator @xmath48 defined in eq .",
    "( [ eq : def_f ] ) . without loss of generality",
    ", we here consider only bob s filter , and denote the @xmath59-dimensional space of incoming pulses by @xmath14 and the target qubit space by @xmath51 .",
    "note that the arguments proved here can immediately apply when alice uses @xmath48 in bbm92 as well .",
    "first we show that @xmath48 is a legitimate quantum operation .",
    "that is , we demonstrate that @xmath71 where @xmath72 is the unit operator in @xmath14 , and @xmath73 is defined as @xmath74 to this end , we work in a basis @xmath75 , and prove @xmath76 for @xmath77    first , it is obvious from the definition of @xmath48 in ( [ eq : def_f ] ) that @xmath78 for @xmath79 . on the other hand , if @xmath80 , a simple calculation shows that for a fixed value of @xmath11 , @xmath81 where the sum is over all values of @xmath82 satisfying @xmath83 . for @xmath11",
    "even , this equals @xmath84 as anticipated .",
    "the case of odd @xmath11 can be shown similarly .",
    "this completes the proof .",
    "next we show that bob s @xmath4 measurement in the virtual protocol affects the entire quantum system in exactly the same manner as in the actual one .",
    "that is to say , with the povm corresponding to a sifted key bit @xmath66 defined as @xmath85 respectively for the virtual and the actual protocols , we shall show that @xmath86 .",
    "if one notes that @xmath87 holds from eq.([eq : f_sum_rel ] ) , it is rather convenient to consider a povm element corresponding to the @xmath88 operator @xmath89 and show that @xmath90 note that @xmath86 can be shown from ( [ eq : pz_ac_vc_equal ] ) and by using the relation @xmath91 and @xmath87 , and similar relations for the actual protocol .    now , from the definition of @xmath48 in eq .",
    "( [ eq : def_f ] ) , @xmath92,\\end{aligned}\\ ] ] where the sum is over all @xmath61 satisfying @xmath93 this can be rewritten further as @xmath94 where the sum is over all @xmath95 with @xmath96 .",
    "next , expanding @xmath39 with @xmath97 gives @xmath98 where the sum is again over all @xmath61 satisfying @xmath96 .",
    "( [ eq : pzvi1 ] ) and ( [ eq : pzac1 ] ) prove eq .",
    "( [ eq : pz_ac_vc_equal ] ) .",
    "this completes the proof .      in this subsection",
    "we prove in eq .",
    "( [ eq : f_invariance ] ) , i.e. , the hadamard - invariance of @xmath48 .",
    "since @xmath99 transforms under the hadamard transformation @xmath49 as @xmath100 with @xmath101 , we have @xmath102 that is , each operator @xmath103 yields a phase factor @xmath104 when @xmath49 is applied .",
    "however , such factor does not change the operations of @xmath48 as a kraus operator .",
    "for example , when applied to an arbitrary mixed state @xmath63 , it yields @xmath105 by summing these over all combinations of @xmath95 satisfying @xmath106 , we obtain eq .",
    "( [ eq : f_invariance ] ) .",
    "99 c. h. bennett and g. brassard , in proceeding of the ieee international conference on computers , systems , and signal processing , bangalore , india ( ieee , new york , 1984 ) , pp.175 - 179 .",
    "d. mayers , jacm * 48 * , 351 ( 2001 ) .",
    "lo and h. f. chau , science * 283 * , 2050 ( 1999 ) .",
    "p. w. shor and j. preskill , phys .",
    "85 * , 441 ( 2000 ) .",
    "d. gottesman and h .- k .",
    "lo , ieee trans .",
    "theory * 49 * , 457 ( 2003 ) , h. f. chau , phys .",
    "a * 66 * , 060302(r ) ( 2002 ) , k. s. ranade and g. alber , j. phys .",
    "a : math . gen . * 39 * , 1701 ( 2006 ) . d. gottesman , h .- k .",
    "lo , n. ltkenhaus , and j. preskill , quant .",
    "inf . comput . * 5 * , 325 ( 2004 ) .",
    "m. koashi , arxiv : quant - ph/0609180v1 .",
    "b. kraus , n. gisin and r. renner , phys .",
    "lett . * 95 * , 080501 ( 2005 ) : r. renner , n. gisin and b. kraus , phys .",
    "a * 72 * , 012332 ( 2005 ) .",
    "hwang , phys .",
    "lett . * 91 * , 057901 ( 2003 ) ; h .- k .",
    "lo , x. ma , and k. chen , phys .",
    "* 94 * , 230504 ( 2005 ) ; x. -b .",
    "wang , phys .",
    "lett . * 94 * , 230503 ( 2005 ) .",
    "k. tamaki , m. koashi , and n. imoto , phys .",
    "* 90 * , 167904 ( 2003 ) : k. tamaki and n. ltkenhaus , phys .",
    "a * 69 * , 032316 ( 2004 ) ; m. koashi , phys . rev .",
    "93 , 120501 ( 2004 ) ; k. tamaki , n. ltkenhaus , m. koashi , and j. batuwantudawe , arxiv : quant - ph/0607082v1 . k. tamaki and h .- k .",
    "lo , phys .",
    "a. * 73 * , 010302(r ) ( 2006 ) ; c .- h .",
    "f. fung , k. tamaki , h .- k .",
    "lo , phys . rev .",
    "a * 73 * , 012337 ( 2006 ) . c. h. bennett , g. brassard , and n. d. mermin , phys .",
    ". lett . * 68 * , 557 ( 1992 ) ; x. ma , c .- h .",
    "f. fung , h .- k .",
    "lo , phys . rev .",
    "a * 76 * , 012307 ( 2007 ) .",
    "g. brassard , n. ltkenhaus , t. mor , and b. c. sanders , phys .",
    "lett . * 85 * , 1330 ( 2000 ) ; n. ltkenhaus , phy .",
    "a * 61 * , 052304 ( 2000 ) .",
    "see , e.g. , j. j. sakurai , modern quantum mechanics , revised edition ( addison - wesley , massachusetts , 1994 ) .",
    "n. j. beaudry , t. moroder , n. ltkenhaus , arxiv:0804.3082v3 .",
    "m. koashi , y. adachi , t. yamamoto , and n. imoto , arxiv:0804.0891v1 ."
  ],
  "abstract_text": [
    "<S> in this paper , we rigorously prove the intuition that in security proofs for bb84 one may regard an incoming signal to bob as a qubit state . from this result </S>",
    "<S> , it follows that all security proofs for bb84 based on a virtual qubit entanglement distillation protocol , which was originally proposed by lo and chau [ h .- k . </S>",
    "<S> lo and h. f. chau , science 283 , 2050 ( 1999 ) ] , and shor and preskill [ p. w. shor and j. preskill , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> 85 , 441 ( 2000 ) ] , are all valid even if bob s actual apparatus can not distill a qubit state explicitly . as a consequence , </S>",
    "<S> especially , the well - known result that a higher bit error rate of 20% can be tolerated for bb84 by using two - way classical communications is still valid even when bob uses threshold detectors . using the same technique </S>",
    "<S> , we also prove the security of the bennett - brassard - mermin 1992 ( bbm92 ) protocol where alice and bob both use threshold detectors . </S>"
  ]
}