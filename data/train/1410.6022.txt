{
  "article_text": [
    "radiation transfer plays an important role in several areas of the physical sciences such as atmospheric science , medical physics and astrophysics .",
    "less well known , at least in the physics community , are the various applications of radiation transfer theory in computer graphics .",
    "computer scientists apply physically - inspired radiation transfer not only to create photo - realistic images and animations @xcite , but also use it in a non - obvious way for visualisation @xcite .",
    "volume rendering is a visualisation technique in which radiation transfer is quintessential and , besides being of immense practical importance , can be very easily understood from physical principles .    in this short note ,",
    "i introduce the method of direct volume rendering to an audience with a physical background .",
    "i provide a dictionary of technical terms used by computer scientists and derive the volume rendering method from the integral form of the well - known radiation transfer equation .",
    "i then describe an implementation of direct volume rendering in the freely available astrophysical radiative transfer code radmc-3ddullemond / software / radmc-3d/ ] .",
    "i conclude with some exemplary applications of this code to analytical models and simulations in astrophysics .",
    "the starting point for our considerations is the ( one - dimensional ) _ formal radiative transfer equation in integral form _",
    "@xcite @xmath0 here , @xmath1 is the _ intensity _ of radiation at location @xmath2 , @xmath3 the _ emissivity _ , @xmath4 the _ optical depth _ between @xmath5 and @xmath6 , and @xmath7 is the _ opacity _ ( or _ extinction coefficient _ ) .",
    "all these quantities depend on the _ frequency _ @xmath8 as well .",
    "the radiation transfer equation   is easy to interpret .",
    "the radiation that arrives at @xmath6 has two contributions .",
    "the first term represents the incoming radiation at @xmath5 , which gets diluted by absorption along the ray from @xmath5 to @xmath6 .",
    "the second contribution describes the emission of radiation by the material between @xmath5 and @xmath6 , which gets diluted as well until it arrives at @xmath6 .",
    "scattering processes are excluded from the formal transfer equation considered here , but can be described by the well - known _ _ rendering equation _ _ in more advanced treatments @xcite . to indicate the omission of scattered radiation , the simple rendering technique employed here",
    "is also called _ emission - absorption model_. in the examples considered below , @xmath9 is set to zero at the domain boundary @xmath5 , so that only contains the integral term , which physically means that objects are visualised through their own emission and not through their shadowing of some background illumination .    in physics ,",
    "@xmath10 and @xmath11 can describe , e.g. , the thermal emission and absorption of dust or of molecular lines . in computer science , however , @xmath10 and @xmath11 are designed to visualise volumetric data sets .",
    "the basic idea is to send a ray from a camera through the computational domain for each pixel of the image .",
    "this procedure is called _",
    "ray tracing_. along each ray is then solved . of course ,",
    "now @xmath10 and @xmath11 do not represent any physical processes . instead , they are defined using _ transfer functions _ , and the assignment of a transfer function to a particular grid cell is called _",
    "classification_. for example , we might want to visualise a three - dimensional density field @xmath12 .",
    "the transfer function @xmath13 then specifies how much radiation a grid cell ( or _ voxel _ ) in a certain density interval will emit or absorb . to display a density isosurface around @xmath14 , we will choose @xmath13 such that it is non - zero only in a small interval around @xmath14 .",
    "typical examples for isosurface transfer functions are rectangle functions @xmath15 or narrow gaussians @xmath16 .\\ ] ] one then defines the emissivity @xmath17 and the extinction coefficient @xmath18 , with the transfer functions for emission and absorption , @xmath19 and @xmath20 , respectively .",
    "the choice of a proper transfer function for a given data set is the central problem of _ _ direct volume rendering _ _ and in general very difficult .",
    "in fact , this is a very active research area with important applications in , e.g. , medical visualisation @xcite .",
    "there are different ways to convert the results of to a colour image .",
    "the easiest and least interesting one is to compute only for a single frequency .",
    "a _ colour table _ can then be used to map each intensity value to a colour .",
    "the obvious problem is that integration of the ray over diverse objects in the scene , represented by distinct transfer functions , can lead to the same final intensity value .",
    "this method is therefore fundamentally unable to assign a certain colour to a particular object .",
    "however , this ability is of course exactly what makes volume rendering so interesting for applications in medical imaging and visualisation .",
    "another and more difficult option is to assign a colour spectrum to each transfer function .",
    "for example , if we describe a colour by its rgb ( red , green , blue ) values , then we can define transfer functions @xmath21 , @xmath22 , @xmath23 for each object and solve for the three frequencies @xmath24 .",
    "in general , this means that the three emissivities @xmath25 , @xmath26 , @xmath27 and the three opacities @xmath28 , @xmath29 , @xmath30 must be specified .",
    "however , one generally assumes that all opacities are equal ( _ grey opacities _ ) , so that only one opacity @xmath31 is used .",
    "the final intensities @xmath32 , @xmath33 , @xmath34 can then directly be interpreted as rgb colour values .",
    "as remarked above , finding appropriate transfer functions can be highly non - trivial .",
    "we illustrate the problem with the simple example of a density isosurface , modeled with the gaussian transfer function  .",
    "this isosurface has a certain width around @xmath14 in physical space ( spatial distance between grid cells ) and in density space ( the parameter @xmath35 from ) .",
    "the parameters @xmath35 and @xmath36 must be chosen such that integration of the intensities @xmath37 yields the desired colours @xmath38 . however",
    ", the spatial width of the isosurface does not have to be the same everywhere .",
    "for example , if the isosurface is wider for one ray than for another ray , its colour can be darker or brighter , depending on whether the ray picks up more emission or less .",
    "therefore , an isosurface of varying thickness can not be visualised with a constant transfer function if all rays should yield the same colour .",
    "methods to compute transfer functions locally based on the variation of the data have been developed to overcome this problem @xcite .",
    "we here only describe the most basic algorithm , corresponding to the current implementation in radmc-3d .",
    "once the transfer functions for emission and absorption are defined , must be numerically integrated on the grid @xcite .",
    "since holds for all points @xmath5 and @xmath6 along the ray , we can decompose the ray into intervals ( not necessarily of equal length ) @xmath39 $ ] and arrive at @xmath40 for neighbouring grid cells at position @xmath41 and @xmath42 . with the abbreviations @xmath43 and @xmath44",
    "we can write more conveniently as @xmath45 the quantity @xmath46 is called _ transparency _ of the medium between the grid cells @xmath41 and @xmath42 .",
    "note that @xmath46 can only attain values between @xmath47 and @xmath48 , corresponding to totally opaque ( large @xmath49 ) and fully transparent ( vanishing @xmath49 ) material , respectively .",
    "applying recursively from the last grid cell @xmath50 back to the first one @xmath5 , we get @xmath51 \\,\\theta_n + b_n\\\\ & = i_\\nu(s_0 ) \\,\\theta_1 \\cdots \\theta_{n-1 } \\,\\theta_n + b_1 \\,\\theta_2 \\cdots \\theta_{n-1 } \\,\\theta_n + \\cdots + b_{n-1 } \\theta_n + b_n .\\end{aligned}\\ ] ] introducing @xmath52 , which we set to zero , this expression can be written shorter as @xmath53 in this form , the sum is evaluated starting from the far side of the domain , and then the summation proceeds towards the camera ( _ back - to - front _ )",
    ". however , with the help of an auxiliary variable to store the accumulated transparency , can be integrated in the other direction ( _ front - to - back _ ) @xcite .",
    "this has the advantage to allow for _ early ray termination _ when the transparency gets very small , so that more distant voxels can not be seen anymore .    to compute ,",
    "the quantities @xmath46 and @xmath54 must be calculated .",
    "this requires the numerical integration of the corresponding integrals .",
    "usually , interpolation is used to carry out the quadrature .",
    "radmc-3d supports both first and second order integration methods .",
    "the first order scheme assumes that @xmath11 and @xmath10 are constant in each cell , so that the integrals can be easily computed analytically . to apply the second order method , @xmath11 and @xmath10",
    "are first mapped from the cell centres to the cell corners .",
    "these vertex values are computed by averaging over all cells that touch the vertex .",
    "when a ray traverses a cell , the entry and exit values of @xmath11 and @xmath10 at the position where the ray pierces through the cell faces are determined using bilinear interpolation from the four vertex values of each face . the second order method than integrates the formal radiative transfer equation assuming that @xmath11 and @xmath10 vary linearly between the entry and exit values , and in this case an analytical solution is also possible @xcite .",
    "radmc-3d interpolates @xmath11 and @xmath10 during the integration of the radiative transfer equation over a single grid cell .",
    "this means that the transfer functions are only evaluated once for each grid cell .",
    "computer scientists call this method _ pre - classification_. a better method , named _ post - classification _ , instead interpolates the grid variables and applies the transfer functions to the interpolated data .",
    "the latter method is known to yield better results and to reduce aliasing artifacts @xcite . however , since radmc-3d is an astrophysical radiative transfer code and many grid variables can contribute to the emission and extinction coefficients , a general interpolation of all these variables is prohibitively memory consuming . in practise ,",
    "aliasing artifacts are visible but not severe with second order integration , but it can be difficult to visualise isosurfaces when the grid variable varies a lot between neighbouring cells .",
    "to illustrate the method , we apply it to a very simple analytical model of a prestellar core .",
    "we use a cubical volume with a box length of @xmath55pc , which we resolve with @xmath56 grid cells in each direction .",
    "we let the number density vary as @xmath57@xmath58pc@xmath59 , where @xmath60 is the radial distance from the centre of the box .",
    "we will visualise two isosurfaces .",
    "since the number density follows a power law , we work with the logarithm @xmath61 instead of the actual density @xmath62 to get smooth results .",
    "we define transfer functions of the form @xmath63 .\\ ] ] the normalisation constant @xmath64 cm is of the order of the size of a grid cell and chosen such that the integration over the gaussian results in the desired colour .",
    "experimentation is required to find suitable values for @xmath65 .",
    "the amplitude @xmath66 is different for the four transfer functions @xmath25 , @xmath26 , @xmath27 and @xmath31 .",
    "for the first isosurface , we set @xmath67 , @xmath68 and @xmath69 ( purple with almost no absorption ) , for the second isosurface we pick @xmath70 , @xmath71 and @xmath72 ( ochre ) .    the first panel of fig .",
    "[ fig : anadata ] shows the resulting image using first order integration .",
    "we see the two spherical isosurfaces , which correspond to the different densities , with their respective colours .",
    "since the rays pick up more contributions from the transfer functions when they hit the isosurface tangentially , the boundaries of the spheres are much brighter than their interiors .",
    "this is analogous to , e.g. , giant h  ii region bubbles in the interstellar medium , where the boundaries are visible by exactly the same mechanism .",
    "we also see pronounced grid artifacts in the image .",
    "the middle panel of fig .",
    "[ fig : anadata ] displays the result of the second order integration . here",
    ", these artifacts are much reduced .",
    "the third panel illustrates the effect of setting @xmath73 for the inner isosurface , which makes this isosurface more opaque .",
    "apart from its use to create analytical models , radmc-3d can also be employed to post - process simulation data .",
    "we demonstrate this with two examples .",
    "the left panel of fig .",
    "[ fig : simdata ] shows density isosurfaces of a minihalo taken from a simulation of primordial star formation @xcite .",
    "such minihalos typically collapse monolithically , creating an onion - like density structure very similar to the one in our analytical model .",
    "we have used the same colours as in the previous section , but have adapted the normalisation constants for this particular situation .",
    "this time , the higher densities are shown in purple and the lower ones in ochre .",
    "one can nicely see how the isosurfaces are deformed by turbulent motions during the collapse of the halo .    the right panel of fig .",
    "[ fig : simdata ] features a density isosurface of an ionisation - driven molecular outflow , taken from a collapse simulation of massive star formation including ionisation feedback @xcite .",
    "the isosurface shows both the disk in which the star forms as well as the outflow driven perpendicular to it .",
    "a fourth frequency channel was used to display the star that drives the outflow , simply using a rectangle function with a small radius around the star and drawing the resulting emission in the foreground of the image .",
    "one can see that the purple colour becomes white were rays intersect the isosurface several times or where the isosurface is thicker than elsewhere .",
    "again , this is because we are assuming a constant thickness of the isosurface , which is clearly not the case . on the lower part of the image",
    ", some dark aliasing artifacts can be seen that are likely due to our use of pre - classification .",
    "apart from the generation of nice images , this volume rendering module for radmc-3d is also useful for diagnostic purposes because the transfer functions can be made arbitrarily complex .",
    "for example , one might want to see an isosurface of density for all gas moving with a certain velocity , coloured according to the temperature of the gas .",
    "generating such a visualisation might be hard or even impossible with standard visualisation tools .",
    "the integration of the radiative transfer equation for arbitrary transfer functions can also be used to measure physical quantities .",
    "for example , using the opacities @xmath74 , @xmath75 and @xmath76 with the gas density @xmath12 and velocity @xmath77 we can compute the mass @xmath78 , momentum @xmath79 and kinetic energy @xmath80 of the outflow by looking at the optical depth instead of the intensity . these exact values",
    "can then be compared with figures derived using observational techniques like synthetic co line measurements @xcite .",
    "this method is particularly useful when the outflows are misaligned with the grid axes , so that a direct measurement from the simulation data is not straightforward .",
    "i have pointed out an interesting connection between the physics of radiation transfer and the visualisation technique of direct volume rendering .",
    "i have explained how the terminology used by computer scientists fits into the physical framework and described an implementation of direct volume rendering in the astrophysical radiative transfer code radmc-3d .",
    "i believe that the connection between computer graphics and radiation transfer is an attractive topic for students and teachers not only of astrophysics , and that it can also help to better understand analytical models and numerical simulations .",
    "it is a pleasure to thank cornelis dullemond for his ongoing support with the development of radmc-3d and for making this code freely available .",
    "i acknowledge financial support through a forschungskredit of the university of zrich , grant no .",
    "fk-13 - 112 .",
    "g.  kindlmann and j.  w. durkin .",
    "semi - automatic generation of transfer functions for direct volume rendering . in _ proceedings of the 1998 ieee symposium on volume visualization _ , vvs 98 , pages 7986 , new york , ny , usa , 1998 ."
  ],
  "abstract_text": [
    "<S> radiation transfer is an important topic in several physical disciplines , probably most prominently in astrophysics . </S>",
    "<S> computer scientists use radiation transfer , among other things , for the visualisation of complex data sets with direct volume rendering . in this note , </S>",
    "<S> i point out the connection between physical radiation transfer and volume rendering , and i describe an implementation of direct volume rendering in the astrophysical radiation transfer code radmc-3d . </S>",
    "<S> i show examples for the use of this module on analytical models and simulation data . </S>"
  ]
}