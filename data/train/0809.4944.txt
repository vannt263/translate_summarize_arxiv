{
  "article_text": [
    "the standard model of hot big bang cosmology is based upon the spatially homogeneous and isotropic friedmann - robertson - walker ( frw ) model .",
    "this successfully describes the average expansion of the universe on large scales according to einstein s theory of general relativity , and the evolution from a hot , dense initial state dominated by radiation to the cool , low density state dominated by non - relativistic matter and , apparently , vacuum energy at the present day .",
    "this standard model is described by just a handful of numbers specifying the expansion rate , the temperature of the present microwave background radiation , the density of visible matter , dark matter and dark vacuum energy .",
    "but an homogeneous model can not describe the complexity of the actual distribution of matter and energy in our observed universe where stars and galaxies form clusters and superclusters of galaxies across a wide range of scales . for this",
    "we need to be able to describe spatial inhomogeneity and anisotropy .",
    "but there are few exact solutions of general relativity that incorporate spatially inhomogeneous and anisotropic matter and hence geometry",
    ". therefore we use a perturbative approach starting from the spatially homogeneous and isotropic frw model as a background solution with simple properties within which we can study the increasing complexity of inhomogeneous perturbations order by order .    the introduction of a homogeneous background model to describe the inhomogeneous universe leads to an ambiguity in the choice of coordinates . in the frw model",
    "the homogeneous three - dimensional hypersurfaces provide a natural time slicing of four - dimensional spacetime .",
    "for instance , hypersurfaces of a uniform density coincide with hypersurfaces with uniform spatial curvature .",
    "however in the real , inhomogeneous universe spatial hypersurfaces of uniform density do not in general have uniform spatial curvature , and hypersurfaces of uniform curvature do not have uniform density . in general relativity there is , a priori , no preferred choice of coordinates .",
    "choosing a set of coordinates in the inhomogeneous universe which will then be described by an frw model plus perturbations amounts to assigning a mapping between spacetime points in the inhomogeneous universe and the homogeneous background model .",
    "the freedom in this choice is the gauge freedom , or gauge problem , in general relativistic perturbation theory .",
    "it can lead to apparently different descriptions of the same physical solution simply due to the choice of coordinates .",
    "this freedom can be a powerful tool as it allows one to work in terms of variables best suited to the problem in hand , however it is important to work with gauge - invariant definitions of the perturbations variables if the results are to be easily assimilated and cross - referenced to the work of others .    in this review",
    "we will focus on how one can construct a variety of gauge - invariant variables to deal with perturbations in different cosmological models at first order and beyond .",
    "we will emphasise the geometrical meaning of metric and matter perturbations and their gauge - invariant definitions .",
    "most work to date has been done only to linear order where the perturbations obey linear field equations .",
    "even then we must consistently solve the linear evolution equations , subject to the constraint equations of general relativity which relate the matter variables to the geometry . beyond first order ,",
    "the non - linearity of einstein s equations becomes evident , making progress much more difficult .",
    "but in limiting cases , notably the large scale limit , it is possible to extend some of the simple results of linear theory to higher orders .",
    "previous reviews on the topic of linear perturbation theory in cosmology include , for example , refs .",
    "@xcite , and the relevant chapters in refs .",
    "@xcite . for",
    "second - order perturbation theory see refs .",
    "@xcite . for reviews on inflation in particular",
    "see , e.g. , refs .",
    "@xcite and for cosmic microwave background anisotropies see , e.g. , refs .",
    "@xcite finally , for reviews on perturbation theory in the context of the higher - dimensional brane - world scenario see , e.g. , refs .",
    "@xcite and for perturbation theory in the context of the low - energy string effective action see , e.g. , refs .",
    "@xcite .    for simplicity we work with a flat background spatial metric which is compatible with current observations . for generalisation",
    "to spatially hyperbolic or spherical frw models see other reviews , e.g. ,  ref.@xcite .",
    "we use a prime to denote derivatives with respect to conformal time , and we use a comma to denote partial derivatives with respect to comoving spatial coordinates , i.e. , t_,i . for",
    "further definitions and notation see appendix [ defandnot_sect ] .",
    "throughout this review we will assume that our observable universe can approximately be described by a homogeneous and isotropic friedmann - robertson - walker ( frw ) spacetime .",
    "thus we assume that the physical quantities can usefully be decomposed into a homogeneous background , where quantities depend solely on cosmic time , and inhomogeneous perturbations .",
    "the perturbations thus `` live '' on the background spacetime and it is this background spacetime which is used to split four - dimensional spacetime into spatial three - hypersurfaces , using a ( 3 + 1 ) decomposition .",
    "in addition we work with a spatially flat frw background , though results can be readily extended to non - zero spatial curvature .",
    "we start this section by defining arbitrary perturbations of tensorial quantities and then proceed by decomposing vectors and tensors into `` time '' and `` space '' parts on the spatial hypersurfaces .",
    "any tensorial quantities can then be split into a homogeneous background and an inhomogeneous perturbation [ tensor_split1 ] * t*(,x^i ) = * t*_0 ( ) + ( , x^i ) .",
    "the background part is a time - dependent quantity , @xmath0 , whereas the perturbations depend on time and space coordinates @xmath1 $ ] .",
    "the perturbation can be further expanded as a power series , [ tensor_split2 ] ( , x^i)= _",
    "n=1^_n(,x^i ) , where the subscript @xmath2 denotes the order of the perturbations , and we explicitly include here the small parameter @xmath3 . in linear perturbation theory , for example , we only consider first - order terms , @xmath4 , and can neglect terms resulting from the product of two perturbations , which would necessarily be of order @xmath5 or higher , which considerably simplifies the resulting equations . in the following sections we shall omit the small parameter @xmath3 whenever possible , as is usually done to avoid the equations getting too cluttered .",
    "it is convenient to slice the spacetime manifold into a one - parameter family of spatial hypersurfaces of constant time , which is the standard ( 3 + 1 ) split of spacetime .",
    "this foliation was introduced by darmois already in 1927 ( see ref .",
    "@xcite ) and popularised by arnowitt , deser and misner @xcite ( for conditions on the existence of the foliation see e.g.  ref .",
    "we refer to the foliation of spacetime by spatial hypersurfaces of given conformal time as the time - slicing , and the identification of spatial coordinates on each hypersurface as the threading .",
    "note that the ( 3 + 1 ) split of spacetime precedes the decomposition of 3-dimensional quantities into scalars and vectors , or scalar , vectors , and tensors below .",
    "we can split any 4 vector @xmath6 into a temporal and spatial part , [ vectorsplit ] ^=. note that @xmath7 is a _ scalar _ on spatial hypersurfaces .",
    "the spatial part @xmath8 can then be further decomposed into a further _ scalar _ part @xmath9 and a _ vector _",
    "part @xmath10 , [ vectordecomp ] ^i ^ij _ , j + , where @xmath11 . the denominations _",
    "scalar _ and _ vector _ part go back to bardeen @xcite and are due to the transformation behaviour of @xmath9 and @xmath10 on spatial hypersurfaces .",
    "the decomposition of a vector field into potential ( or curl - free ) part and a divergence - free part in euclidean space is known as helmholtz s theorem .",
    "the curl - free and divergence - free parts are also called longitudinal and solenoidal parts , respectively .    in our isotropic ( frw ) background , there can be no spatial vector part at zeroth order ( as this would correspond to a preferred direction ) , but there can be a non - zero temporal part , [ backgroundvector ] ^0_(0)0,^i_(0)=0 .",
    "a non - trivial vector , with a non - zero spatial part , can appear only at first order .",
    "we give examples of vector fields in a frw background including perturbations in section [ vectorfieldsec ] , where we discuss the unit vector field normal to constant - time hypersurfaces and the fluid 4-velocity .",
    "note that `` divergence - free '' , etc , is defined with respect to the flat - space metric , rather than using covariant derivatives , since perturbations are defined with respect to the spatially flat background .      as for vector fields",
    ", we can decompose a rank-2 tensor into a time part and spatial part , but now have also mixed time - space parts .",
    "consider the metric tensor @xmath12 which we require to be symmetric , g _ g_. the metric tensor has therefore only 10 independent components in 4 dimensions .",
    "we first split the metric tensor into a background and a perturbed part , using eq .",
    "( [ tensor_split1 ] ) .",
    "it then turns out to be useful to split the metric perturbation into different parts labelled _ scalar _ , _ vector _ or _ tensor _ according to their transformation properties on spatial hypersurfaces @xcite , which are themselves expanded into first and higher order parts using eq .",
    "( [ tensor_split2 ] ) .",
    "our background spacetime is described by a spatially flat frw background metric [ def_bg_metric ] ds^2 = a^2 , where @xmath13 is conformal time and @xmath14 is the scale factor .",
    "the cosmic time , measured by observers at fixed comoving spatial coordinates , @xmath15 , is given by @xmath16 .",
    "the perturbed part of the metric tensor can be written as @xmath17 the @xmath18 and the @xmath19-components of the metric tensor can be further decomposed into scalar , vector and tensor parts [ decompbi ] b_i & = & b_,i -s_i , + [ decompcij ] c_ij & = & -_ij + e_,ij+ f_(i , j ) + 12 h_ij . where @xmath20 , @xmath21 , @xmath22 and @xmath23 are _ scalar _ metric perturbations , @xmath24 and @xmath25 are _ vector _ metric perturbations , and @xmath26 is a _ tensor _ metric perturbation , which we will now define .",
    "_ scalar _ perturbations can always be constructed from a scalar , or its derivatives , and background quantities .",
    "any 3-vector , such as @xmath27 , constructed from a scalar is necessarily curl - free , i.e. , @xmath28}=0 $ ] .",
    "_ vector _ perturbations are divergence - free .",
    "for instance one can distinguish an intrinsically _ vector _ part of the metric perturbation @xmath29 , which we denote by @xmath30 , which gives a non - vanishing contribution to @xmath31}$ ] .",
    "similarly we define the vector contribution to @xmath32 constructed from the ( symmetric ) derivative of a vector @xmath33 .",
    "finally there is a _ tensor _",
    "contribution to @xmath34 which is both transverse , @xmath35 ( i.e. , divergence - free ) , and trace - free ( @xmath36 ) which therefore can not be constructed from inhomogeneous scalar or vector perturbations .",
    "note that when raising and lowering spatial indices of vector and tensor perturbations we use the comoving background spatial metric , @xmath37 , so that , for instance , @xmath38 .",
    "the reason for splitting the metric perturbation into these three types is that the governing equations decouple at linear order , and hence we can solve each perturbation type separately . at higher order",
    "this is no longer true : we find for example at second order that although the `` true '' second order perturbations , @xmath39 , still decouple , but their governing equations have source terms quadratic in the first order variables , @xmath40 , mixing the different types @xcite . indeed at all higher orders , @xmath41 , the different types of perturbations of order @xmath2 decouple , but are sourced by terms comprising perturbations of lower order .",
    "we have introduced four scalar functions , two spatial vector valued functions with three components each , and a symmetric spatial tensor with six components . but these functions are subject to several constraints : @xmath26 is transverse and traceless , which contributes four constraints , @xmath25 and @xmath24 are divergence - free , one constraint each",
    ". we are therefore finally left 10 new degrees of freedom , the same number as the independent components of the perturbed metric .",
    "the choice of variables to describe the perturbed metric is not unique .",
    "already at first order there are different conventions for the split of the spatial part of the metric .",
    "we follow the notation of mukhanov et al  @xcite so that the metric perturbation , @xmath22 , can be identified directly with the intrinsic scalar curvature of spatial hypersurfaces at first order , see later .",
    "sometimes it is useful to work in terms of the trace of the perturbed spatial metric c = c_i^i = -3 + ^2 e at first order this coincides with the perturbation of the determinant of the spatial metric . including terms up to second order we have [ determinant ] ( _ ij+2c_ij ) & = & 1 + 2c + 2 ( c^2-c_ijc^ij ) + & = & 1 -6 + 2 ^ 2 e + & & + 12 ^ 2 - 8 ^ 2e + 2(^2e)^2 - 2e_,ije_,^  ij - 2f_i , jf _",
    ", ^i  j + & & - 12 h_ijh^ij - 2e_,ijh^ij - 2f_i , jh^ij . where we have used the general result @xmath42 .",
    "there are further choices for the way the spatial metric is split into the different perturbation variables at second ( and higher ) order in the perturbations .",
    "note that our metric perturbations in eqs .",
    "( [ defa][decompcij ] ) include all orders . if we write out the complete metric tensor , up to and including second - order in the perturbations we have [ metric1 ] g_00&=&-a^2(1 + 21 + 2 ) , + g_0i&=&a^2(b_1i+b_2i ) , + g_ij&=&a^2 , where the first and second order perturbations @xmath43 and @xmath44 , and @xmath45 and @xmath46 , can be further split according to eqs .",
    "( [ decompbi ] ) and ( [ decompcij ] ) .",
    "the contravariant metric tensor follows from the constraint ( to the required order ) , g _   g^=_^  , which up to second order gives [ metric2 ] g^00&=&-a^-2 , + g^0i&=&a^-2 , + g^ij&=&a^-2 .",
    "the perturbed metric given in section [ decomposingtensors ] implicitly defines a unit time - like vector field orthogonal to constant-@xmath13 hypersurfaces , n _ , subject to the constraint n^n_=-1 . in the frw background",
    "this coincides with the 4-velocity of matter and the expansion of the velocity field @xmath47 , where @xmath48 is the hubble expansion rate .",
    "we define the conformal hubble parameter ah . in this section",
    "we calculate corresponding geometrical quantities for @xmath49 , and thus the space - time , defined by the perturbed metric tensor .",
    "note however that in the perturbed spacetime the vector field @xmath50 , need no longer coincide with the 4-velocity of matter fields at first order and beyond .    up to and including to second order , the covariant vector field is [ defnmu ] n_= -a , and",
    "the contravariant vector field is [ defnmuup ] n^0 & = & , + n^i & = & .",
    "observers moving along the hypersurface - orthogonal vector field , @xmath50 , have a vanishing 3-velocity with respect to the spatial coordinates @xmath15 when the shift vector @xmath51 is zero",
    ". we will refer to these as orthogonal coordinate systems .",
    "the covariant derivative of any time - like unit vector field @xmath52 can be decomposed uniquely as follows  @xcite : n_;= _ + _ + _ - a_n _ , where the spatial projection tensor @xmath53 , orthogonal to @xmath50 , is given by [ defpmunu ] _ = g_+n_n_.    the overall expansion rate is given by [ theta ] = n^ _  ; , the ( trace - free and symmetric ) shear is [ defshear ] _ = ^  _ ^  _ ( n _ ; + n _ ; ) - _ , the ( antisymmetric ) vorticity is [ defomega ] _ = ^  _ ^  _ ( n _ ; - n _ ; ) , and the acceleration is [ defacc ] a_=n _ ; n^ . on spatial hypersurfaces",
    "the expansion , shear , vorticity and acceleration coincide with their newtonian counterparts in fluid dynamics @xcite . in this subsection",
    "we focus on the unit normal vector field @xmath50 , but the expansion , shear , vorticity and acceleration defined in this way can readily be applied to any other 4-vector field , such as the 4-velocity @xmath54 .",
    "one can easily verify that the vorticity ( [ defomega ] ) is automatically zero for the hypersurface orthogonal vector field , @xmath55 defined in eq .",
    "( [ defnmu ] ) .",
    "note however that the perturbed fluid velocity can have vorticity and this is described by the vector ( divergence - free ) part of the fluid 3-velocity which we will define in section  [ tmunufluid_sec ] .",
    "the projection tensor @xmath53 is the induced 3-metric on the spatial hypersurfaces , and the lie derivative of @xmath53 along the vector field @xmath50 is the extrinsic curvature of the hypersurface embedded in the higher - dimensional spacetime @xcite .",
    "the extrinsic curvature of the spatial hypersurfaces defined by @xmath52 is thus given by k _",
    "12  _ n _ = _",
    "^   n _ ; = _ + _ .    at first order we can easily identify the metric perturbations with geometrical perturbations of the spatial hypersurfaces or the associated vector field , @xmath55 .",
    "the intrinsic curvature of spatial hypersurfaces up to first order is given by ^(3)r_1 = ^2 _ 1 .",
    "the scalar part of the shear ( [ defshear ] ) up to first order is given by _",
    "1ij = ( _ i_j-^2)a_1 , where we define the shear potential [ shearscalar1 ] _ 1 e_1-b_1 .",
    "the vector and tensor parts are given by , respectively , _",
    "1vij= a(f_1(i , j)-b_1(i , j ) ) , _ 1tij = h_1ij.    the acceleration up to",
    "first order is a_i = _ _ , i .",
    "the expansion rate up to first order is given by = .",
    "the intrinsic spatial curvature , shear and acceleration of @xmath55 are given up to second order in appendix  [ app_n_components ] .",
    "the overall expansion , up to second order is given by [ expansion_comp ] = .",
    "focusing for the moment only on scalar perturbations ( neglecting first order vectors and tensors ) on large scales ( neglecting spatial derivatives ) the perturbed part of the expansion simplifies to _ 1&&- ( _ 1+_1 ) , + _ 2&&- .",
    "note that the expansion rate , @xmath56 in eq .",
    "( [ expansion_comp ] ) , is defined with respect to proper time ( comoving with @xmath50 ) .",
    "the expansion rate with respect to conformal time on large scales is _ coord 3 .",
    "we see that on large scales ( and considering only scalar perturbations ) spatially flat hypersurfaces ( @xmath57 ) are also uniform coordinate expansion hypersurfaces ( on which the perturbed expansion vanishes ) .",
    "in the following we will often refer to the perturbed logarithmic expansion , or `` number of e - foldings '' n 13 d= 13 _ coord d = a - _ 1 - 12_2 - _ 1 ^ 2 .",
    "this quantity , and its perturbation @xmath58 becomes a particularly useful quantity to describe the primordial scalar perturbation beyond linear order , as we will discuss in section  [ non_linear_sec ] .",
    "the calculation of the shear , defined above in eq .",
    "( [ defshear ] ) , simplifies in case of the unit normal vector field @xmath50 , that is for @xmath499 , _",
    "ij =- n_0 ^0_ij-  g_ij , which gives ( including vectors and tensors ) at first order ^(1)_00&=&0 , ^(1)_0i=0 , + ^(1)_ij&=&a , and at second order ^(2)_00&=&0 , + ^(2)_0i&=&2a , + ^(2)_ij&=&a .",
    "the expansion is given from eq .",
    "( [ theta ] ) in the background as _ 0= , at first order _ 1= , and at second order",
    "+ the acceleration is given from eq .",
    "( [ defacc ] ) at first order as a_(1)0=0 , a_(1)i=__1,i , and at second order as a_(2)0&=&2b_1^k__1,k , a_(2)i=.      the intrinsic curvature of spatial three - hypersurfaces is given at first and second order , respectively , by ^(3)r_1&=&^2_1 , + ^(3)r_2&= & [ 4 ^ 2_2 - 4c_1km,^  mc_1  , n^kn + 3c_1mn,^  kc^mn_1  , k -c^k_1  k , nc^m  n_1  m , + & & + 4c_1^mn ( c_1mn ,  k^  k+c^k_1  k , mn - c_1mk , n^  k - c_1kn , m^  k ) + & & + 2(c^k_1  k , j c^jn_1  , n + c_1jk,^  jc^m  k_1  m , -c^k_1  n , mc^mn_1  , k ) , where we used 2(c^mn _  , mn - c^m  k _  m ,  k)=4 ^ 2 .",
    "we are interested in how the spacetime geometry , described by the metric tensor , is affected by the perturbed matter content , described by the energy - momentum tensor .",
    "the four - velocity of matter , @xmath54 , is defined by u^= , where @xmath59 is the proper time comoving with the fluid , subject to the constraint @xmath60 the components of the 4-velocity up to second order are then given by [ defumu ] u_0 & = & -a , + u_i & = & a , + [ defumuup ] u^0 & = & a^-1 , + u^i & = & a^-1(v_1^i+v_2^i ) , the spatial part of the velocity can be split into a scalar ( potential ) part and a vector ( solenoidal ) part , order by order , following eq .",
    "( [ vectordecomp ] ) as [ defv ] v^i ^ijv_,j+v_vec^i , for each order @xmath2 where we refer to @xmath61 as the scalar velocity potential , and to @xmath62 as the vector part .",
    "note that @xmath63 is the 3-velocity of matter defined with respect to the spatial coordinates , @xmath15 , and so is not the velocity with respect to the hypersurface - orthogonal vector field @xmath64 , except in orthogonal coordinate systems for which @xmath65 . in comoving orthogonal coordinates , which we will discuss later , @xmath66 and @xmath65 .",
    "the energy - momentum tensor of a fluid with density @xmath67 , isotropic pressure @xmath68 and 4-velocity @xmath69 , defined above in eq .",
    "( [ defumu ] ) , is defined as  @xcite [ deftmunugeneral ] t _ = ( + p ) u_u_+p g _",
    "the anisotropic stress tensor @xmath70 is split into first and second order parts in the usual way , _ _",
    "( 1)+_(2 ) , and is subject to the constraints [ pi_constraint ] _",
    "u^=0 , ^ _",
    "the anisotropic stress vanishes for a perfect fluid or minimally coupled scalar fields , but may be non - zero in the presence of free - streaming neutrinos or a non - minimally coupled scalar field .",
    "we follow kodama and sasaki @xcite in defining the proper energy density as the eigenvalue of the energy - momentum tensor , and the four velocity @xmath54 as the corresponding eigenvector [ eigen1 ] t^ _  u^=-u^.    the anisotropic stress tensor decomposes into a trace - free scalar part , @xmath71 , a vector part , @xmath72 , and a tensor part , @xmath73 , at each order according to [ def : pi_ij ] _ ij = a^2 .",
    "we get for the components of the stress energy tensor in the background t^0 _  0 = -_0 , t^0 _  i = 0 , t^i _  j = ^i _  j p_0 , at first order , ^(1)t^0 _  0 & = & -_1 , + [ deftmtm ] ^(1)t^0 _  i & = & ( _ 0+p_0)(v_1i+b_1i ) , + [ perft_ij ] ^(1)t^i _  j & = & p_1^i _  j+a^-2_(1 )  j^  i , and at second order ^(2)t^0 _  0 & = & -_2 -2(_0+p_0)v_1k(v_1^  k+b_1^  k ) , + ^(2)t^0 _",
    "i & = & ( _ 0+p_0 ) + & & + 2(_1+p_1)(v_1i+b_1i ) + ( b^k_1 + v_1^k ) _",
    "1ik , + [ perft_2ij ] ^(2)t^i _  j & = & p_2^i _  j+a^-2 ^  i_2  j -c^ik_1 _ 1jk + 2(_0+p_0)v_1^i(v_1j+b_1j ) .",
    "note , that for compactness of presentation we have not split perturbations into their constituent scalar , vector and tensor parts in the above expressions . the decompositions are given for @xmath74 and @xmath75 in eqs .",
    "( [ defv ] ) and ( [ def : pi_ij ] ) , and given for @xmath76 and @xmath77 in section [ decomposingtensors ] , in eqs .",
    "( [ decompbi ] ) and ( [ decompcij ] ) .",
    "note that contracting the @xmath19 part of the energy - momentum tensor , eq .",
    "( [ perft_2ij ] ) , including the constraints for the anisotropic stress , eq .",
    "( [ pi_constraint ] ) , guarantees that the anisotropic stress cancels on the trace , ^(1)t^k _  k & = & 3 p_1 , + ^(2)t^k _  k & = & 3p_2 + 2(_0+p_0)v_1^k(v_1k+b_1k ) .",
    "this cancellation is true at all orders .",
    "coordinate transformations affect the split between spatial and temporal components of the matter fields and so quantities like the density , pressure and 3-velocity are gauge - dependent , as described in section [ gaugesec ] .",
    "density and pressure are 4-scalar quantities which transform as given in eq .",
    "( [ rhotransform1 ] ) in the following section , but the 4-velocity is a 4-vector which transforms described in section  [ gauge_vector_sec ] .",
    "the anisotropic stress is gauge - invariant at first order , but becomes gauge - dependent at second order .      in the multiple fluid case",
    "the total energy - momentum tensor is the sum of the energy - momentum tensors of the individual fluids [ def : sumt ] t^=_t^ _ ( ) . for each fluid we define the local energy - momentum transfer 4-vector @xmath78 through the relation [ nablatalpha ] _",
    "( ) , where the energy - momentum tensor , @xmath79 , is locally conserved only for non - interacting fluids , for which @xmath80 . equations  ( [ nablatmunu ] ) and  ( [ nablatalpha ] ) imply the constraint [ qconstraint ] _ q^_()=0 .    following refs .",
    "@xcite we split the energy - momentum transfer 4-vector using the total fluid velocity @xmath54 as [ defqmu ] q^_()=q _ ( ) u^+f^ _ ( ) , where @xmath81 is the energy transfer rate and @xmath82 the momentum transfer rate , subject to the constraint [ fmucon ] u_f^_()=0 , from eq .",
    "( [ fmucon ] ) we find for the temporal component of the momentum transfer rate vector @xmath82 f^0_1()=0 , f^0_2 ( ) = 2 f^k_1()(v_1k+b_1k ) , we then find for the temporal components of the energy transfer 4-vector to be at zeroth , first and second order , respectively q^0_()&=&q_0 , + q^0_()&= & ( q_1 - 1 q_0 ) , + q^0_()&= & , where @xmath83 , @xmath84 , and @xmath85 are the energy transfer to the @xmath86-fluid in the background , at first and at second order , respectively .    for the spatial components of the energy transfer 4-vector , the momentum part , we get at first and second order , respectively q^i_()&= & q_0 v_1^i + f^i_1 ( ) , + q^i_()&= & , where @xmath87 and @xmath88 are the spatial parts of the momentum transfer rates at first and second order .",
    "note that the homogeneous and isotropic frw background excludes a zeroth order momentum transfer .",
    "using eq .",
    "( [ vectordecomp ] ) the spatial momentum transfer vector of order @xmath2 , @xmath89 , can be further decomposed into a scalar and a vector part , according to f^i_n()^ij f_n(),j + f^i_n ( ) .",
    "a minimally coupled scalar field is specified by the lagrangian density [ lscal ] l=- g^ _ , _ , - u ( ) , where the scalar field kinetic energy is then non - negative for our choice of metric signature .",
    "the energy momentum tensor is defined as t_=-2 + g_l , and we therefore get for a scalar field @xmath90 t^ _   = g^ _ , _ , -^ _  ( u ( ) + g^ _ , _ , ) . comparing to the energy - momentum tensor for a perfect fluids , eq .",
    "( [ deftmunugeneral ] ) , we can identify the non - linear 4-velocity , density and pressure of the scalar field @xcite u_&= & , = - g^ _ , _ , + u , + p & = & - g^ _ , _ , - u .",
    "note that the anisotropic stress , @xmath70 , is identically zero for minimally coupled scalar fields .",
    "in fact we can subdivide the energy - momentum tensor for a single field into that of a stiff kinetic fluid with @xmath91 and a vacuum energy @xmath92 , which exchange energy - momentum @xmath93 .    splitting the scalar field into a homogeneous background field and a perturbation , ( , x^i)=_0()+_1(,x^i ) , and using the definitions above",
    "we find for the components of the energy momentum tensor of a perturbed scalar field at linear order without specifying a gauge yet @xmath94~\\delta^i_{~j } \\,,\\end{aligned}\\ ] ] where @xmath95 and @xmath96 . by comparing eq .",
    "( [ scalt_ij ] ) with eq .",
    "( [ perft_ij ] ) , we see that scalar fields do not support vector or tensor perturbations to first order .      for @xmath97",
    "minimally coupled scalar fields the lagrangian density is given by = - _ i ( g^_i,_i , ) - u(_1, ",
    "the energy - momentum tensor is [ multitmunu ] t_=_k=1^n - g_u , where @xmath98 is the @xmath99th scalar field and @xmath100 the scalar field potential and @xmath101 .",
    "analogous to the energy - momentum tensor for a single field , we can identify the non - linear 4-velocity , density and pressure of each of the scalar fields @xcite u_(i ) & = & , + _ ( i ) & = & p_(i ) = - g^_i,_i , . the energy - momentum transfer to each fluid",
    "is @xmath102 .",
    "the total energy - momentum tensor ( [ multitmunu ] ) is the sum over @xmath97 stiff fluids plus the vacuum energy t _ = _",
    "( i ) - u g _ .",
    "the anisotropic stress , @xmath70 , is identically zero for any number of minimally coupled scalar fields .",
    "the total energy - momentum tensor is only equivalent to that of a single scalar field in the special case where all the 4-velocities of the fields , @xmath103 , are identical .",
    "this is true in the homogeneous frw cosmology , but in general breaks down when inhomogeneous perturbations are considered .",
    "we split the scalar fields @xmath104 into a background and perturbations up to and including second order according to eqs .",
    "( [ tensor_split1 ] ) and ( [ tensor_split2 ] ) , _",
    "i(x^)=_0i()+_1i(x^)+_2i(x^ ) .",
    "the potential @xmath105 can be split similarly according to u(_i)=u_0 + 1 + 2 , where [ defdu1 ] 1&=&_k u_k _ 1k , + [ defdu2 ] 2&=&_k , lu_kl_1k_1l + _ k u_k_2k .",
    "and we use the shorthand @xmath106 .",
    "the energy - momentum tensor , eq .  ( [ multitmunu ] ) , expanded up to second order in the perturbations for the metric tensor eq .",
    "( [ metric1 ] ) is given in appendix [ scalartmunu_sect ] .",
    "we now review how tensorial quantities change under coordinate transformations @xcite ( see ref .",
    "@xcite for earlier work on this subject ) . while the order of the perturbation is indicated by a subscript",
    ", we also keep the small parameter @xmath107 in the following equations whenever appropriate .",
    "a problem which arises in cosmological perturbation theory is the presence of spurious coordinate artefacts or gauge modes in the calculations .",
    "although the gauge modes had been dealt with on a `` case by case '' basis before , the gauge issue was resolved in a systematic way by bardeen  @xcite .",
    "the gauge issue will arise in any approach to gr that splits quantities into a background and a perturbation . although gr is covariant , i.e.  manifestly coordinate choice independent , splitting variables into a background part and a perturbation is not a covariant procedure , and therefore introduces a coordinate or gauge dependence . by construction",
    "this only affects the perturbations ; the background quantities remain the same in the different coordinate systems . here",
    "we assume the difference between the coordinate systems is small , of @xmath108 , however the gauge problem would persist also for finite transformations . note that the `` covariant approach '' @xcite also corresponds to a choice of gauge , namely the comoving one , which is made explicit by the inclusion of the velocity field @xcite .    in order to restore covariance",
    "as far as possible , we usually wish to eliminate the gauge degrees of freedom .",
    "we will show in section [ gi_var_sec ] how , by constructing variables corresponding to perturbations in physically defined coordinate systems , the gauge dependencies can be made to cancel out ( the quantities so constructed will not change under a gauge transformation ) .",
    "there are two approaches to calculate how perturbations change under a small coordinate or gauge transformation .",
    "for the _ active view _ we study how perturbations change under a mapping , where the map directly induces the transformation of the perturbed quantities . in the _ passive view _",
    "the relation between two coordinate systems is specified , and we calculate how the perturbations are changed under this coordinate transformation . in the passive approach",
    "the transformation is taken at the same physical point , whereas in the active approach the transformation of the perturbed quantities is evaluated at the same coordinate point .",
    "we will discuss both approaches briefly in the following , but shall use the active approach to calculate the transformation behaviour of the first and second order variables . for a mathematically more rigorous discussion",
    "see e.g.  ref .",
    "@xcite .",
    "the starting point in the active approach is the exponential map , that allows us to immediately write down how a tensor @xmath109 transforms up to second order , once the generator of the gauge transformation , @xmath110 , has been specified .",
    "the exponential map is [ ttransgeneral ] = e^_*t * , where @xmath111 denotes the lie derivative with respect to @xmath112 .",
    "the vector field generating the transformation , @xmath112 , is up to second order ^_1^ + ^2_2^ + o(^3 ) .",
    "the exponential map can be readily expanded [ exp_expand ] (  _ ) = 1+__1 + ^2__1 ^ 2 + ^2__2 +  where we kept terms up to @xmath113 .",
    "splitting the tensor @xmath109 up to second order , as given in eq .",
    "( [ tensor_split2 ] ) , and collecting terms of like order in @xmath3 we find that tensorial quantities transform at zeroth , first and second order , respectively , as @xcite & = & * t*_0 , + [ ttrans1 ] & = & + __1 * t*_0 , + ^2[ttrans2 ] & = & ^2(+__2 * t*_0 + ^2__1 * t*_0 + 2__1 ) .",
    "note that the background quantities are not affected by the mapping .",
    "we will apply eqs .",
    "( [ ttrans1 ] ) and ( [ ttrans2 ] ) to scalars , vectors , and tensors after discussing the passive approach next .    applying the map ( [ ttransgeneral ] ) to the coordinate functions",
    "@xmath114 we get a relation for the coordinates of a point @xmath115 in and a point @xmath116 as [ defcoordtrans ] x^ ( q ) = e^^|_p x^ ( p ) , where we have used the fact that when acting on scalars @xmath117 and the partial derivatives are evaluated at @xmath116 . the left - hand - side and the right - hand - side of eq .",
    "( [ defcoordtrans ] ) are evaluated at different points .",
    "equation ( [ defcoordtrans ] ) can then be expanded up to second - order as [ coordtrans2 ] x^(q ) = x^(p)+_1^(p ) + ^2(^_1,(p)_1^  ( p ) + _ 2^(p ) ) .",
    "note that we do not need eq .",
    "( [ coordtrans2 ] ) to calculate how perturbations change under a gauge transformation in the active approach , it simply tells us how the coordinates of the points @xmath116 and @xmath115 are related in this approach .      in the passive approach",
    "we specify the relation between two coordinate systems directly , and then calculate the change in the metric and matter variables when changing from one system to the other .",
    "as long as the two coordinate systems are related through a small perturbation , the functional form relating them is quite arbitrary .",
    "however , in order to make contact with the active approach , discussed above , we take eq .",
    "( [ coordtrans2 ] ) as our starting point .",
    "note , that all quantities in the passive approach are evaluated at the same physical point .",
    "equation ( [ coordtrans2 ] ) can be rewritten to give a relation between the `` old '' ( untilded ) and the `` new '' ( tilde ) coordinate systems @xcite , [ passive_coord ] ( q)=x^(q)-_1^(q ) + ^2(^_1(q)_,_1^  ( q ) -_2^(q ) ) , evaluated at the same physical point @xmath115 .",
    "the passive point of view is very popular at first order , see e.g.  the original paper by bardeen @xcite and the widely used reviews by kodama and sasaki @xcite , and mukhanov , feldman , and brandenberger @xcite .",
    "the starting point in the passive approach is to identify an invariant quantity , that allows us to relate quantities to be evaluated in the two coordinate systems .",
    "we denote the two coordinate systems by @xmath118 and @xmath114 system , and their relation is given by eq .",
    "( [ passive_coord ] ) .",
    "we choose as an example the energy density , @xmath67 , which as a four scalar will not change under a coordinate transformation .",
    "however , once it has been split into the background quantity and perturbation at different orders , these variables will change .",
    "the two coordinate systems are related by eq .",
    "( [ passive_coord ] ) , which we can use to expand the right - hand - side of eq .",
    "( [ tilderho ] ) in a taylor expansion up to second order .",
    "to first order , the two coordinate systems are simply related , using the linear part of eq .",
    "( [ coordtrans2 ] ) , by x^=x^-_1^.    we get the transformation behaviour of the density perturbation , @xmath119 , from the requirement that the total density , @xmath120 , has to be invariant under a change of coordinate system and therefore has to be the same in the @xmath121 and the @xmath114 system , that is [ tilderho ] ( x^)= ( x^ ) .    expanding both sides of eq .",
    "( [ tilderho ] ) using eq .",
    "( [ tensor_split1 ] ) , we get ( x^ ) & = & _ 0(x^0 ) + _ 1(x^ ) + o(^2 ) , + ( x^)&=&_0 ( ) + ( ) + o(^2 ) , + & = & _ 0(x^0)+ ( - _ 0(x^0 ) _ 1 ^ 0(x^ ) + ( x^ ) ) + o(^2 ) .",
    "note that we use the same background solution @xmath122 in both expressions .",
    "thus we obtain the transformation rule at first order [ rho_trans_passive ] = _",
    "1+_0_1 ^ 0 .",
    "another invariant is the line element @xmath123 , which allows us to deduce the transformation properties of the metric tensor by exploiting the invariance of @xmath123 , i.e. , ds^2=g_d x^dx^= g_dx^d x^ , we here will not follow this approach further here , but see e.g.  @xcite .",
    "we now return to the active approach by studying the simplest tensorial quantity , the four - scalar .",
    "examples of four - scalar are the energy density , @xmath67 , and the scalar field @xmath124 , and we shall use the former below .    from eqs .",
    "( [ tensor_split1 ] ) and ( [ tensor_split2 ] ) we immediately get the perturbed four - scalar up to second order = _ 0+_1 + 12_2 , using the energy density as an example .",
    "before we can study the transformation behaviour of the perturbations at first order , we split the generating vector @xmath125 into a scalar temporal part @xmath126 and a spatial scalar and vector part , @xmath127 and @xmath128 , according to [ def_xi1 ] _",
    "1^=(_1,_1,^  i+1 ) , where the vector part is divergence - free @xmath129 .    under a first - order transformation a four scalar , here the energy density , @xmath67 , then transforms from eqs .  ( [ ttrans1 ] ) and ( [ lie_scalar ] ) as , [ rhotransform1 ]",
    "= + _ 0_1 .",
    "the first - order density perturbation is fully specified by prescribing the first order temporal gauge or time slicing , @xmath126 .      at second order , as at first order , we split the generating vector @xmath130 into a scalar time and scalar and vector spatial part , similarly as at first order , as [ def_xi2 ] _",
    "2^=(_2,_2,^  i+2 ) , where the vector part is divergence - free @xmath131 .",
    "we then find from eqs .",
    "( [ ttrans2 ] ) and ( [ lie_scalar ] ) that a four scalar transforms as [ rhotransform2 ] = + _ 0_2&+&_1 ( _ 0_1+_0_1+2 ) + & + & ( 2+_0_1)_,k ( _ 1,^  k+1 ) .",
    "we see here already the coupling between vector and scalar perturbations in the last term through the gradient and @xmath128 .",
    "the gauge is only specified once the scalar temporal gauge perturbations at first and second order , @xmath126 and @xmath132 , and the first order spatial gauge perturbations , @xmath127 and @xmath128 , are specified .",
    "we now turn to four - vectors and their transformation properties . of particular interest in cosmology",
    "is the unit four - velocity @xmath54 , which we defined in section [ tmunufluid_sec ] above .",
    "hypersurface , @xmath50 defined in section [ vectorfieldsec ] , will be replaced by a new vector field normal to the constant-@xmath133 hypersurfaces , therefore it is not particularly helpful to study the transformation of @xmath50 .",
    "we will study the gauge transformation of the metric tensor in section [ gauge_tensor_sec ] , from which we can derive the transformation rules for the hypersurface - orthogonal field and its expansion , shear , etc . ]",
    "a four - vector transforms at first order , using eqs .",
    "( [ ttrans1 ] ) and ( [ lie_vector ] ) , as [ transu1 ] = _ 1 + _",
    "( 0)_1 + _ ( 0 ) ^_1 , , where we used the fact that in a frw spacetime background quantities are time dependent only .    for the specific example of the four - velocity , defined in eq .",
    "( [ defumu ] ) , we find , + = v_1i+b_1i-_1,i . using the transformation of the metric perturbation @xmath43 , given below in eq .  ( [ b1itrans ] ) , and using the decompositions given in section [ decomposingvectors ] above , we get the transformations for the scalar and vector parts , respectively , at first order [ transv1 ] & = & v_1-_1 , + [ transv1vec ] & = & v_vec(1)^i-1 , and the perturbed temporal part of @xmath54 does indeed transform as a scalar .      at second order",
    "we find that a four - vector transforms , using eqs .",
    "( [ ttrans2 ] ) and ( [ lie_vector ] ) , as [ transu2 ] & = & _ 2+_(0)_2+_(0)0_2 , + _ ( 0)_1 ^ 2+_(0)_1,^_1 + & & + 2_(0)0_1_1 , + _ ( 0)0(^_1_1 , + _ 1,^_1 , ) + 2(_1,^_1 + _ 1^_1 , ) , where as before we used for the background @xmath134 and @xmath135 .",
    "focusing again on the four - velocity , eq .",
    "( [ defumu ] ) , and following a similar procedure as at first order , we find that the second order combined scalar and vector spatial part transforms as [ transv2i ] & = & v_2i-_2i+_i , where @xmath136 contains the terms quadratic in the first order perturbations and is given by [ defxvi ] _ i & & _1i(21+_1+2_1)-_1_1i + & & -_1^k_1i , k+_1^k_1i , k -2_1(v_1i+v_1i ) + 2v_1i , k_1^k-2v_1^k_1i , k , and we already substituted for the transformation of the metric perturbation @xmath45 , given below in eq .",
    "( [ b2itrans ] ) .",
    "decomposing then the second order velocity transformation , eq .",
    "( [ transv2i ] ) , into scalar and vector parts , we get the transformations as [ transv2 ] & = & v_2-_2+^-2^k _  , k , + [ transv2vec ] & = & v_vec(2)^i-2 + _ i-^-2^k _  , ki",
    ".        we can now calculate how the first order metric perturbations change under a gauge transformation .",
    "we get the change of the @xmath137 and hence the lapse function @xmath138 immediately from eqs .",
    "( [ ttrans1 ] ) and ( [ lie_tensor ] ) , since this component of the metric is scalar in nature .",
    "the change of the @xmath139 slightly more involved , since this component contains scalar and vector perturbations .",
    "we therefore have to compute the overall transformation of this metric component using eqs .",
    "( [ ttrans1 ] ) and ( [ lie_tensor ] ) , and then split the result for @xmath43 into its scalar part , @xmath140 , and its divergence - free part @xmath30 .",
    "we therefore get for the combined part @xmath43 , [ b1itrans ] b_1i&=&b_1i+_1i-_1,i , and taking the divergence gives for the scalar part , [ b1idiv ] ^2 b_1&=&^2 b_1 + ^2 _ 1-^2 _ 1 , which , after `` removal '' of the laplacian gives the transformation behaviour of @xmath140 .",
    "we can then subtract the scalar part from eq .",
    "( [ b1idiv ] ) and are left with the vector part .",
    "the results are given below .",
    "to get the change of the metric functions in the spatial part of the metric under a gauge transformation , we again first use eqs .",
    "( [ ttrans1 ] ) and ( [ lie_tensor ] ) to get transformation of the spatial part of the metric @xmath141 , or @xmath44 , [ cij1trans ] 2c_1ij=2 c_1ij + 2_1_ij+_1i , j+_1j , i , where we reproduce eq .",
    "( [ decompcij ] ) above for convenience , @xmath142 taking the trace of eq .",
    "( [ cij1trans ] ) we get [ cij1trace ] -3_1+^2e_1 = -3_1+^2 e_1 + 3_1+^2_1 .",
    "now applying the operator @xmath143 to eq .",
    "( [ cij1trans ] ) we get a second equation relating the scalar perturbation @xmath144 and @xmath145 , [ cij1divdiv ] -3 ^ 2_1+^2 ^ 2e_1 = -3 ^ 2_1+^2 ^ 2 e_1 + 3 ^ 2_1 + ^2 ^ 2_1 .",
    "taking the divergence of eq .",
    "( [ cij1trans ] ) we get 2c_1ij,^  j=2 c_1ij,^  j + 2_1,i + ^2_1i+^2_1,i .",
    "substituting in our results for @xmath146 and @xmath147 we arrive at ^2 f_1i= ^2 f_1i+^2 1 .",
    "we can sum up the transformations of the first order metric perturbations we have from the above , first for the scalars as [ transphi1 ] & = & 1 + _ 1+_1 , + [ transpsi1 ] _ 1 & = & _ 1-_1 , + [ transb1 ] b_1 & = & b_1-_1+_1 , + [ transe1 ] e_1 & = & e_1+_1 , and for the vector perturbations as [ transs1 ] & = & s_1^  i-1 , + [ transf1 ] & = & f_1^  i+1 .",
    "the first order tensor perturbation is found to be gauge - invariant , h_1ij = h_1ij . by substituting eqs .",
    "( [ transphi1 ] ) to ( [ transf1 ] ) into eq .",
    "( [ cij1trans ] ) .    for later use",
    ", we note that the scalar shear potential , @xmath148 , defined in eq .",
    "( [ shearscalar1 ] ) above , and the combination @xmath149 corresponding to the momentum scalar , transform as & = & _ 1+_1 , + + & = & v_1+b_1-_1 .",
    "the metric tensor transforms at second order , from eqs .",
    "( [ ttrans2 ] ) and ( [ lie_tensor ] ) , as [ general_gmunu2 ] & = & g^(2 ) _ + g^(0)_,^_2 + g^(0)_^_2  , + g^(0)_^_2  , + 2 + & & + g^(0)_,^_1^_1 + g^(0)_,^_1  , ^_1 + 2 + & & + g^(0 ) _",
    "( ^_1  , ^_1 + ^_1  , ^_1 ,   ) + g^(0 ) _ ( ^_1  , ^_1 + ^_1  , ^_1 ,   ) .    as at first order , in the previous subsection",
    ", we get the transformation behaviour for the second order lapse function @xmath150 straight from the @xmath151 component of eq .",
    "( [ general_gmunu2 ] ) , which gives [ transphi2 ] & = & 2+_2+_2 + _ 1 + & & + 2_1(_1+2_1 ) + _ 1k ( _ 1+_1 + 2_1)_,^  k + & & + _",
    "1k.    the combined scalar and vector @xmath18 metric part transforms from eqs .",
    "( [ ttrans2 ] ) and ( [ lie_tensor ] ) as [ b2itrans ] b_2i&=&b_2i+_2i-_2,i + _ i , where @xmath45 is similarly vector and scalar combined , and we defined @xmath152 to contain the terms quadratic in the first order perturbations , as [ defxbi ] _ i & & 2 + & & + 4_1(_1i-_1,i ) + _ 1(_1i-3_1,i ) + _ 1(_1i-_1,i ) + & & + _ 1^k(_1i , k+2_1k , i ) + _ 1^k(_1i , k-_1,ik ) -_1,k_1 ,  i^k .    to get the transformation behaviour of the vector and the scalar part separately , we take the divergence of eq .",
    "( [ b2itrans ] ) and find after applying the inverse laplacian , the transformation scalar part @xmath153 , [ transb2 ] b_2 & = & b_2-_2+_2 + ^-2 ^k _  , k , or explicitly [ transb2detail ] b_2 & = & b_2-_2+_2 + & + & ^-2\\ { 2 + 4 + & & + _ 1^2(_1-3_1 ) + _ 1,k(_1^  k-3_1,^  k ) + _ 1 ^ 2(_1-_1 ) + _ 1,k(_1^  k-_1,^  k ) + & & + _",
    "1^  k^2(_1,k+2_1k ) + _ 1  l^  k(_1  k^  l+2_1k,^",
    "1^  k^2(_1,k-_1,k ) + & & + _ 1  l^  k(_1  k^  l-_1 ,  k^  l ) -_1,k^2_1^  k -_1,k^  l_1  , l^  k } .",
    "the vector part is then simply found by subtracting the scalar part from eq .",
    "( [ b2itrans ] ) , and is given by [ transs2 ] s_2i&=&s_2i-2-_i+^-2^k _  , ki .",
    "we now turn to the transformation behaviour of the perturbations in the spatial part of the metric tensor .",
    "we can follow here along similar lines as in the linear case . however , the task is made more complicated not only by the size of the expressions but more importantly by the fact that now we will have to let inverse gradients operate on products of first order quantities .",
    "the perturbed spatial part of the metric , @xmath46 , transforms at second order as [ cij2trans ] 2c_2ij&=&2c_2ij+2_2 _ ij + _",
    "2i , j+_2j , i+_ij , where we defined @xmath154 to contain the terms quadratic in the first order perturbations as [ xijdef ] _ ij & & 2_ij + & & + 4 + 2(b_1i_1,j+b_1j_1,i ) + & & + 4_1 ( _ 1i , j+_1j , i ) -2_1,i_1,j+2_1k , i_1  , j^  k + _ 1 ( _ 1i , j+_1j , i ) + ( _ 1i , jk+_1j , ik)_1^  k + & & + _ 1i , k_1  , j^  k+_1j , k_1  , i^  k + _ 1i_1,j+_1j_1,i . the perturbed spatial part of the metric , @xmath46 , is decomposed in eq .",
    "( [ decompcij ] ) above into scalar , vector , and tensor part , which we reproduce here at second order , @xmath155 taking the trace of eq .",
    "( [ cij2trans ] ) we get [ cij2trace ] -3+^2 & = & -3_2+^2 e_2 + 3_2 + ^2_2 + ^k _",
    "k , where we find @xmath156 to be [ xtrace ] ^k _  k&= & 3(^2+)_1 ^ 2 + 3(_1_1+_1,k_1^  k ) + & & + 2 + & & + 2b_1k_1,^  k -_1,k_1,^  k + _ 1k,^  l_1  , l^  k + _ 1k,^",
    "l_1l,^  k + & & + _ 1 ^ 2(_1+4_1 ) + ^2_1,k_1^  k + _ 1k_1,^  k . now applying the operator @xmath143 to eq .",
    "( [ cij2trans ] ) we get a second equation relating the scalar perturbations @xmath157 and @xmath158 , [ cij2divdiv ] -^2_2+^2 ^ 2e_2 = -^2_2+^2 ^ 2 e_2+^2_2 + ^2 ^",
    "2_2 + ^ij _  , ij , this gives the second - order scalar metric perturbations [ transpsi2 ] _",
    "2=_2-_2-^k _  k + ^-2 ^ij _  , ij , and [ transe2 ] e_2=e_2+_2+^-2 ^ -2^ij _  , ij -^-2^k _  k. taking the divergence of eq .  (",
    "[ cij2trans ] ) we get 2c_2ij,^  j=2 c_2ij,^  j + 2_2,i + ^2_2i+^2_2,i+_ik,^  k. substituting in our results for @xmath159 and @xmath160 we then arrive at ^2 f_2i= ^2 f_2i+^2 _ 2i + _",
    "ik,^  k-^-2^kl _  , kli .",
    "finally we obtain the second - order vector metric perturbation [ transfi2 ] f_2i= f_2i+_2i + ^-2_ik,^  k-^-2 ^ -2^kl _  , kli .",
    "we can now turn to the tensor perturbation at second order . substituting our previous results for @xmath157 , @xmath158 , and @xmath161 into eq .",
    "( [ cij2trans ] ) we get [ transhij2 ] h_2ij&= & h_2ij+_ij + ( ^-2^kl _  , kl-^k _  k ) _ ij + ^-2 ^ -2^kl _  , klij + & & + ^-2^k _  k , ij -^-2(_ik ,  j^  k+_jk ,  i^  k ) .",
    "although the second - order tensor transformation @xmath162 is not dependent on the second - order part of the gauge transformation , @xmath163 , it does depend on first order quantities quadratically .",
    "the tensor metric perturbations are no longer gauge - invariant at second and higher order .      from eqs .",
    "( [ rhotransform2 ] ) , ( [ transpsi2 ] ) , and ( [ transphi2 ] ) we see that on large scales , where gradient terms can be neglected , the definition of the second order perturbations in the `` new '' coordinate is independent of the spatial coordinate choice ( the `` threading '' ) at second order in the gradients .",
    "it is therefore sufficient on large scales ( at @xmath165 ) to specify the time slicing by prescribing @xmath126 and @xmath132 , in order to define gauge - invariant variables @xcite .",
    "the procedure to neglect the gradient terms , is explained in detail in ref .",
    "@xcite . for the approximation to hold",
    "one assumes that each quantity can be treated as smooth on some sufficiently large scale .",
    "formally one multiplies each spatial gradient @xmath166 by a fictitious parameter @xmath164 , and expands the exact equations as a power series in @xmath164 , keeping only the zero- and first - order terms , finally setting @xmath167 .",
    "the notion of invariance under coordinate reparametrisation is central to einstein s theory of general relativity .",
    "this is both a blessing and a curse in the study of cosmological perturbations .",
    "we are free to pick coordinate systems best adapted to the problem at hand , but we also obtain apparently different results depending upon this arbitrary choice of coordinates . this is the gauge problem .",
    "ultimately physical observables are not dependent on the choice of coordinate , though observables may be different for different observers .",
    "all one can do is to specify quantities unambiguously , such that they have a _ gauge - invariant _ definition .",
    "this is not the same as _",
    "gauge independence_. a quantity like the tensor metric perturbation , @xmath168 , is truly gauge independent at first order in that the tensor part of the metric perturbation is the same in all gauges .",
    "the scalar curvature perturbation , @xmath144 , on the other hand is intrinsically gauge - dependent .",
    "it is different under different time slicings .",
    "( indeed in the spatially flat slicing the curvature perturbation is zero by construction . )",
    "one can construct gauge - invariant combinations , which may be referred to as the gauge - invariant curvature perturbation , but they only correspond with the curvature perturbation in one particular gauge . as a result one can find in the literature many different gauge - invariant curvature perturbations corresponding to the many different choices of gauge , such as @xmath169 , @xmath170 and @xmath171 , corresponding to the curvature perturbation in the longitudinal , the uniform density , and the comoving gauge , respectively , to name just three",
    ".    in this section we shall show how different gauge invariant combinations of otherwise gauge dependent quantities can be constructed by fixing the otherwise arbitrary coordinate transformations at first order and beyond , yielding gauge invariant definitions of the physical perturbations in specified gauges .",
    "residual gauge degrees of freedom only remain in cases where the coordinate choice is not unambiguously fixed , as in the synchronous gauge .    at first order the tensor metric perturbation , @xmath168 , is not affected by the mapping , or by the change of coordinate system , and hence is gauge - invariant .",
    "thus we only have to construct gauge - invariant scalar and vector perturbations at first order .",
    "however at second order the tensor part of the metric perturbation also becomes gauge - dependent .    at",
    "first order we can define scalar and vector type gauge - invariant variables independently of each other , but matters are more complicated at second order . whereas we can still specify the `` proper '' second order scalar and vector slicings and threadings independently , we now also have to specify the first order gauge functions of both types simultaneously",
    ".    we could specify different gauges at first and second order , but we would be losing the physical interpretation of the quantity thus constructed .",
    "we therefore choose the same gauge at first and second order , and at first order the same physical gauge condition for the scalar and vector gauge functions .",
    "it is however sometimes necessary to combine different temporal and spatial gauge conditions .",
    "for example imposing the uniform density condition only specifies the slicing , and we are free to combine it with a flat threading .",
    "the gauge - dependence of the metric perturbations lead bardeen  @xcite to propose that only quantities that are explicitly invariant under gauge transformations should be considered . by studying the transformation eqs .",
    "( [ transphi1][transe1 ] ) , bardeen and @xmath172 . ]",
    "constructed two such quantities  @xcite @xmath173 these turn out to coincide with the scalar metric perturbations in a particular gauge , called variously the orthogonal zero - shear  @xcite , conformal newtonian  @xcite or longitudinal gauge  @xcite .",
    "it may therefore appear that this gauge is somehow preferred over other gauge choices .",
    "however any unambiguous choice of time - slicing and threading can be used to define explicitly gauge - invariant perturbations .",
    "the longitudinal gauge of ref .",
    "@xcite provides but one example .",
    "the two scalar gauge functions , @xmath86 and @xmath174 defined in eq .",
    "( [ def_xi1 ] ) , which represent different choices of time - slicings ( choice of spatial hypersurfaces ) and threading ( choice of spatial coordinates on these hypersurfaces ) respectively , allow two of the scalar metric perturbations to be eliminated , implying that the two remaining gauge - invariant combinations should then be gauge - invariant .",
    "if we choose to work on spatial hypersurfaces with vanishing shear , we find from eqs .",
    "( [ transb1]),([transe1 ] ) and ( [ shearscalar1 ] ) that the shear scalar transforms as @xmath175 and this implies that to obtain perturbations in the longitudinal gauge starting from arbitrary coordinates we should perform a transformation @xmath176 this is sufficient to determine the geometrical perturbations @xmath177 , @xmath144 , @xmath178 or other scalar quantities on these hypersurfaces .",
    "in addition , the longitudinal gauge is completely determined by the spatial gauge choice @xmath179 [ and hence from eq .",
    "( [ alpha1l ] ) @xmath180 which requires from eq .",
    "( [ transe1 ] ) @xmath181 the remaining scalar metric perturbations , @xmath177 and @xmath144 , are given from eqs .",
    "( [ transphi1 ] ) and ( [ transpsi1 ] ) as @xmath182 note that @xmath183 and @xmath184 are then identical to @xmath185 and @xmath169 defined in eqs .",
    "( [ defphi ] ) and  ( [ defpsi ] ) .",
    "the fluid density perturbation , @xmath186 , and scalar velocity , @xmath187 , are given from ( [ rhotransform1 ] ) and ( [ transv1 ] ) @xmath188 these gauge - invariant quantities are simply a gauge - invariant definition of the perturbations in the longitudinal gauge .",
    "this gauge is widely used , for example , throughout ref .",
    "it has also proven useful for calculations on small scales , since it gives evolution equations closest to the newtonian ones , e.g.  ref .",
    "recently it has also become popular in backreaction studies , e.g.  @xcite . after imposing the gauge - conditions the metric tensor is diagonal , which simplifies many calculations , for example the derivation of the governing equations of the boltzmann - hierarchy .",
    "moreover we shall show in section  [ sect : dynamics ] that in many cases of physical interest ( in the absence of anisotropic stress ) one finds @xmath189 and there is only one variable required to describe all scalar metric perturbations .",
    "however , it can be difficult to define quantities in this gauge in the super - horizon limit , since in the super - horizon limit the shear vanishes and hence numerical instabilities can occur on large scales in the longitudinal gauge , see e.g.  refs .",
    "@xcite .",
    "the extension to include vector and tensor metric perturbations is called the poisson gauge @xcite .",
    "tensor metric perturbations are automatically gauge independent at first order ( and hence gauge invariant ) . eliminating the spatial part of the contravariant vector field @xmath50 in eq .",
    "( [ defnmuup ] ) requires both @xmath190 and @xmath191 which from eq .",
    "( [ transs1 ] ) fixes the vector part of the spatial gauge transformation  ( [ def_xi1 ] ) [ gamma1l ] _",
    "1^i = s_1^i d+ _ 1^i(x^j ) , up to an arbitrary constant 3-vector @xmath192 which depends on the choice of spatial coordinates on an initial hypersurface .",
    "the remaining vector metric perturbation is [ def : sgi ] ^i = f_1^i+s_1^i d+ _ 1^i(x^j ) .",
    "it is possible to extend the longitudinal , or poisson , gauge to higher orders .",
    "the principle for constructing gauge invariant variables remains the same .",
    "we use a physical choice of gauge to specify the vector field @xmath110 generating the transformation ( [ defcoordtrans ] ) from an arbitrary gauge @xcite . requiring first that @xmath193 fixes the scalar part of the spatial gauge using eq .",
    "( [ transe2 ] ) , which gives _ 2=- e_2 - ^-2 ^ -2^ij _  , ij + ^-2^k _  k. note that having already imposed the poisson gauge at first order , @xmath126 , @xmath194 and @xmath195 are fixed by eqs .",
    "( [ alpha1l ] ) , ( [ beta1l ] ) and  ( [ gamma1l ] ) , and thus so is @xmath154 , given in eq .",
    "( [ xijdef ] ) .    requiring that the scalar part of the perturbed shift function vanishes , @xmath196",
    ", then sets the temporal gauge , @xmath197 using eq .",
    "( [ transb2 ] ) , while requiring that the vector part vanishes , @xmath198 , can be used along with eq .",
    "( [ transfi2 ] ) to fix the vector part of the spatial gauge , @xmath199 , up to a constant of integration as at first order , eq .",
    "( [ gamma1l ] ) .",
    "we then obtain gauge invariant definition of @xmath185 , @xmath169 and other perturbations at second order by substituting these specific gauge transformations into eq .",
    "( [ transphi2 ] ) and ( [ transpsi2 ] ) to obtain [ transphi2l ] & = & 2+_2+_2 + _ 1 + & & + 2_1(_1+2_1 ) + _ 1k ( _ 1+_1 + 2_1)_,^  k + & & + _ 1k. + [ transpsi2l ] & = & _ 2-_2-^  k_k + ^-2 ^  ij _  ,",
    "ij , where @xmath200 is denotes the quadratic first order terms in eq .",
    "( [ xijdef ] ) using the longitudinal gauge transforms @xmath201 and @xmath202 .    the tensor ( transverse , tracefree ) part of the metric perturbation at second order , @xmath26 in eq .",
    "( [ transhij2 ] ) , is not affected by the second order gauge transformations @xmath132 and @xmath203 , but it does depend on the choice of gauge at first order , @xmath126 and @xmath204 . thus we need to include the corresponding first - order gauge definition to obtain a gauge invariant definition of the tensor metric perturbations at second order .    in particular , recent work on the generation of gravitational waves at second order @xcite has calculated the resulting tensor mode in the poisson gauge . to give a gauge invariant definition of the tensor perturbation in the poisson gauge one needs to explicitly include the transverse and tracefree ( tensor ) part of the second order gauge transformation from an arbitrary gauge . from eqs .",
    "( [ transhij2 ] ) we obtain the gauge invariant definition of the tensor metric perturbation in the poisson gauge : [ transhij2l ] h_2ij&= & h_2ij+_ij + ( ^-2^kl _  , kl-^  k_k ) _ ij + ^-2 ^ -2^kl _  , klij + & & + ^-2^  k_k , ij -^-2(_ik ,  j^  k+_jk ,  i^  k ) .",
    "an alternative gauge choice , defined purely by local metric quantities is the spatially flat or uniform curvature gauge  @xcite , also called the off - diagonal gauge  @xcite . in this gauge",
    "one selects spatial hypersurfaces on which the induced 3-metric on spatial hypersurfaces is left unperturbed by scalar or vector perturbations , which requires @xmath205 and @xmath206 .",
    "using eqs .",
    "( [ transpsi1 ] ) , ( [ transe1 ] ) and  ( [ transf1 ] ) this corresponds to a gauge transformation ( [ def_xi1 ] ) where @xmath207 the gauge - invariant definitions of the remaining scalar metric degrees of freedom are then from eqs .",
    "( [ transphi1 ] ) and  ( [ transb1 ] ) @xmath208 these gauge - invariant combinations were denoted @xmath209 and @xmath210 by kodama and sasaki  @xcite .",
    "the gauge - invariant definition of the remaining vector metric perturbation is the time derivative of the vector metric perturbation in the poisson gauge ( [ def : sgi ] ) : ^i = s_1^i+f_1^i = ^i .",
    "perturbations of scalar quantities in this gauge , such as the density perturbation , have gauge invariant definitions from eq .",
    "( [ rhotransform1 ] ) : @xmath211 and the velocity potential ( [ transv1 ] ) is given from eq .",
    "( [ transv1 ] ) : = v_1+e_1.    the shear perturbation in the spatially flat gauge is given by @xmath212 .",
    "this is closely related to the curvature perturbation in the zero - shear ( longitudinal ) gauge , @xmath213 , given in eqs .",
    "( [ defpsi ] ) or ( [ defpsi1l ] ) , = - = - .",
    "gauge - invariant quantities , such as @xmath214 or @xmath184 are proportional to the displacement between two different choices of spatial hypersurface , = - = _ 1 - _ 1 , which would vanish for a homogeneous cosmology .    in some circumstances",
    "it is more convenient to use the spatially - flat gauge - invariant variables instead of those in the longitudinal gauge .",
    "for instance , when calculating the evolution of perturbations during a collapsing `` pre big bang '' era the perturbations @xmath215 and @xmath214 may remain small even when @xmath185 and @xmath169 become large  @xcite . on the other hand",
    "the metric perturbation @xmath214 grows on large scales in radiation or matter dominated eras , @xmath216 , when the longitudinal gauge metric perturbation @xmath169 remains constant .",
    "note that the scalar field perturbation on spatially flat hypersurfaces , [ defvpflat1 ] 1+_0 , is the gauge - invariant sasaki - mukhanov variable  @xcite , often denoted @xmath217 .      at second order",
    "we get from the gauge condition @xmath218 using eq .",
    "( [ transpsi2 ] ) [ deffg2 ] _ 2=+ , where we get @xmath219 from eq .",
    "( [ xijdef ] ) using the first order gauge generators given above , as [ xijflat ] _ ij&=&2_ij + _",
    "1(c_1ij+2c_1ij ) + & & + 4 c_1ij , k_1^k + ( 4 c_1ik+_1i , k)_1,j^k + ( 4 c_1jk+_1j , k)_1,i^k + & & + -_1,i_1,j + & & + _ 1 ( _ 1(i , j)+4_1(i , j ) ) + 2_1^k_1(i , j)k + 2_1k , i_1,j^k , + where we define _ 1i=-(e_1,i+f_1i ) .",
    "the trace of eq .",
    "( [ xijflat ] ) is then ^k_k&=&6+_1(c_1  k^k+2c_1  k^k ) + & & + 4 c_1  k , l^k_1^l + 4 ( 2 c_1^kl+_1,^k  l)_1(k , l ) -2 ^ 2e_1,k_1^k + & & + ( 2b_1k+_1k-_1,k)_1,^  k -(_1 ^ 2e_1+4 ^ 2e_1 ) .    as an example of a second - order scalar metric perturbation we give the lapse function in the flat gauge & = & 2 + + & & + + & & + ( _ 1_1 + 2_1 ^",
    "2 ) + ( 2-)_1 ^ 2 + ( 5 - 6)_1_1 + 1_1 + & & + 1 + _ , k _ 1^k + & & + _ 1^k .",
    "the second order tensor perturbation is in the flat gauge [ transhij2flat ] h_2ij&= & h_2ij+_ij + ( ^-2^kl_,kl-^k_k ) _ ij + ^-2 ^ -2^kl_,klij + & & + ^-2^k_k , ij -^-2(_ik , j^  k+_jk , i^  k ) . as an example of a matter variable we choose the energy density , which in the flat gauge is [ rhotransform2flat ] & = & + _ 2 + ( ^-2^ij_,ij-^k_k ) + & & + + ( 2+_1)_,k_1^k .    to show the relation between gauge - invariant perturbations defined in the flat gauge and those previously defined in the longitudinal gauge we note that in the longitudinal gauge we have 2_ij = -2_ij + 2 _ ( i , j ) + h_1ij , and the first - order gauge shifts to the flat gauge , eqs .",
    "( [ deffg1 ] ) , become @xmath220 substituting these into eq.([xijflat ] ) we obtain [ xijflatell ] _ ij|_&=&_ij + ( h_1ij+2h_1ij ) + & & + 2 ( 2_,k _ ij - 2 _ ( i , j)k - h_ij , k ) ^k - 4 h_k(i _ , j)^k + & & - _ , ( i _ j ) -_,i_,j + & & - _ ( i , j) + 2 ^k_(i , j)k + 2 _ k , i^k_,j . if we can neglect the first - order vector and tensor perturbations , @xmath221 and @xmath168 , then we have [ xijflatellspecial ] _ ij|_= - ( +2 ) _",
    "ij -_,i_,j . similarly",
    ", neglecting first vector and tensor perturbations , i.e.  setting @xmath222 and hence only considering scalar perturbations , the energy density at second order , eq .",
    "( [ rhotransform2flat ] ) , simplifies to [ rhotransform2flatscal ] & & = _ 2 + _ 2 + + & & -2(+_1)_,ke_1,^  k + & & + \\",
    "{ e_1,kle_1,^  kl+^2e_1,ke_1,^  k -2_1",
    "^ 2(+2e_1 ) - ( 2b_1+e_1-)_,k + & & + ^-2_,ij } .",
    "+ this expression was first derived in ref .",
    "@xcite , however with a different , incorrect sub - horizon part  @xcite . on super - horizon scales , where gradient terms can be neglected ,",
    "we recover the expressions given in ref .",
    "@xcite .",
    "the synchronous gauge is defined by @xmath223 , so that the proper time for observers at fixed spatial coordinates coincides with cosmic time in the frw background , i.e. , @xmath224 .",
    "this simplifies dynamical equations as the time derivatives can be directly related to proper time derivatives .",
    "this gauge is very popular for numerical studies , and used in many boltzmann solvers such as cmbfast @xcite .",
    "it is also popular in the older literature @xcite .",
    "the gauge condition at first order is @xmath225 , which from eqs .",
    "( [ transphi1 ] ) and ( [ transb1 ] ) gives _ 1 & = & -(a_1 d-_1(x^i ) ) , + _ 1&= & ( _ 1-b_1 ) d+_1(x^i ) , + _ 1^i & = & s_1^i d+ _ 1^i(x^i ) .",
    "this does not determine the time - slicing unambiguously and we are left with two arbitrary scalar functions of the spatial coordinates , @xmath226 and @xmath227 .",
    "note that @xmath228 affects only the labelling of the coordinates on the initial spatial hypersurface , but @xmath226 affects scalar perturbations on spatial hypersurfaces .",
    "we are left with two non - zero geometrical scalar perturbations , & = & _ 1+(a_1 d-(x^i ) ) , + _ 1 & = & _ 1 + _ 1-b_1 , and the matter variables are & = & _ 1 -(a_1 d-(x^i ) ) , + & = & v_1+b_1- _ 1 . thus it is not possible to define gauge - invariant quantities in general using this gauge condition  @xcite .",
    "this gauge was originally used by lifshitz in his pioneering work on perturbations in a frw spacetime @xcite ( see also ref .",
    "he dealt with the residual gauge freedom by eliminating the unphysical gauge modes through symmetry arguments .    to remove the ambiguity",
    ", we can follow ref .",
    "@xcite and choose the initial velocity of cold dark matter to be zero , @xmath229 , which fixes the residual gauge freedom _",
    "1(x ) = a ( v_1cdm + b_1 ) .",
    "note that for pressureless matter , momentum conservation equation ensures that @xmath230 is a constant ( see section  [ sect : dynamics ] ) .",
    "the comoving gauge is defined by choosing spatial coordinates such that the 3-velocity of the fluid vanishes , @xmath231 .",
    "orthogonality of the constant-@xmath13 hypersurfaces to the 4-velocity , @xmath54 , then requires @xmath232 , which shows that the momentum vanishes as well . from eqs .",
    "( [ transb1 ] ) and  ( [ transv1 ] ) this implies @xmath233 where @xmath234 represents a residual gauge freedom , corresponding to a constant shift of the spatial coordinates .",
    "all the 3-scalars like curvature , expansion , acceleration and shear are independent of @xmath234 . applying the above transformation from arbitrary coordinates , the scalar perturbations in the comoving orthogonal gauge can be written as @xmath235 defined in this way , these combinations are gauge - invariant under transformations of their component parts in exactly the same way as , for instance , @xmath185 and @xmath169 defined in eqs .",
    "( [ defphi ] ) and  ( [ defpsi ] ) .",
    "note that the curvature perturbation in the comoving gauge given above , eq .",
    "( [ defpsi1com ] ) was used ( with a constant pre - factor ) by lukash @xcite .",
    "it was later employed by lyth and denoted @xmath236 in his seminal paper , @xcite , and in many subsequent works , e.g.  @xcite and @xcite .",
    "the density perturbation on the comoving orthogonal hypersurfaces is given by eqs .",
    "( [ rhotransform1 ] ) and  ( [ alpha1com ] ) in gauge - invariant form as @xmath237 and corresponds to the gauge - invariant density perturbation @xmath238 in the notation of bardeen  @xcite .",
    "the gauge - invariant scalar density perturbation @xmath239 introduced in refs .",
    "@xcite corresponds to @xmath240 .",
    "if we wish to write these gauge - invariant quantities in terms of the metric perturbations rather than the velocity potential then we can use the einstein equations , presented in section  [ sect : dynamics ] , to obtain @xmath241 in particular we note that we can write the comoving curvature perturbation , given in eq .",
    "( [ defr ] ) , in terms of the longitudinal gauge - invariant quantities as @xmath242 which coincides the quantity denoted @xmath170 by mukhanov , feldman and brandenberger in ref .",
    "@xcite .    by comparing the definitions of the energy - momentum tensor for a single fluid and a single scalar field in sections [ tmunu_single_sec ] and [ tmunu_scal_sec_single ] we can relate the @xmath149 to @xmath243 , which allows one to rewrite the definition of the comoving curvature perturbations , eq .",
    "( [ defr ] ) , as [ defrfield1 ] = _ 1 + 1 . from the definition above we immediately that the comoving curvature perturbation is related to the field fluctuation on flat slices , defined in eq .",
    "( [ defvpflat1 ] ) , by = . for extensions to the multi - field case",
    "see section [ multi_field_sec ] .",
    "this gauge is also known as the velocity orthogonal isotropic gauge @xcite but here we follow the terminology of ref",
    ".  @xcite .",
    "it is closely related to comoving orthogonal and longitudinal gauges .    to fix the temporal gauge we require the total momentum potential on spatial hypersurfaces to vanish + = 0 .",
    "in addition we require @xmath244 and @xmath245 , which fixes the spatial gauge .",
    "these require _ 1=v_1+b_1 , _ 1 = -e_1 , _",
    "1^i =- f_1^i .",
    "we therefore get the metric perturbations in the total matter gauge related to the comoving orthogonal and longitudinal gauge perturbations : & = & , + & = & , + & = & - , and for the matter quantities we get in the total matter gauge & = & , + & = & .",
    "note that in the total matter gauge velocity potential is not identically zero ( unlike in the comoving orthogonal gauge ) , but equal to the shear potential , @xmath246 , which also coincides with velocity potential in longitudinal gauge .",
    "alternatively we can use the matter to pick out a foliation of uniform density hypersurfaces on which to define perturbed quantities .      using eq .",
    "( [ rhotransform1 ] ) we see that @xmath247 implies a temporal gauge transformation @xmath248 on these hypersurfaces the gauge - invariant curvature perturbation is  @xcite @xmath249 the sign is chosen to coincide with @xmath170 defined in refs .",
    "@xcite defined in eq .",
    "( [ defzeta ] ) is related to the curvature perturbation @xmath250 defined in ref .",
    "@xcite by @xmath251 . ] .",
    "there is still the freedom to choose the spatial gauge .",
    "in particular we can choose either @xmath252 , @xmath253 or @xmath254 to be zero and thus fix @xmath174 .",
    "note that @xmath255 is simply related to the density perturbation in the flat gauge , eq .",
    "( [ defrho1psi ] ) by -_1=_1 .",
    "the curvature perturbation in the uniform - density gauge is also closely related to the comoving curvature perturbation ( [ defr ] ) . at first order",
    "we have @xmath256 where @xmath257 is the comoving density perturbation ( [ defrho1com ] ) .",
    "in section [ sect : dynamics ] we shall use the einstein equations to show that @xmath255 and @xmath258 differ only by an overall minus sign in the large scale limit where the comoving density perturbation vanishes .",
    "the transformation behaviour of scalars at second order , eq .",
    "( [ rhotransform2 ] ) , allows us to define the temporal gauge corresponding to uniform density hypersurfaces as [ interdefunid2 ] _ 2=- - ( _ 0_1+_0_1+2_1 ) -(2_1+_0_1)_,k ( _ 1,^  k+1 ) . using then the definition of uniform density hypersurfaces at first order , eq .",
    "( [ defunid1 ] ) , and choosing a spatially flat threading by using eq .",
    "( [ deffg1 ] ) , we finally get [ defunid2 ] _ 2=.    using eq .",
    "( [ xijdef ] ) we find [ xijud2 ] & & _ ij-2_ij + & & + 4+(4 c_1ik+_1i , k)_1,j^k + & & + ( 4 c_1jk+_1j , k)_1,i^k - + & & -2 ( _ 1(i , j)+4_1(i , j ) ) -_1,i_1,j + 2_1^k_1(i , j)k + 2_1k , i_1,j^k , where we choose a flat threading by defining , _ 1^i-(e_1,^  i+f_1^i ) . from eq .",
    "( [ xijud2 ] ) we get for the trace in the uniform density gauge [ xtrace_udg ] ^k _  k&= & -6 + & & + 4 + & & + 4(2 c_1^kl+_1,^k  l)_1(k , l ) - ( 2b_1^k+_1k)_1,k + & & + 2 ^ 2 ( e_1+4 ^ 2e_1 ) -_1,_1,^k -2 ^ 2e_1,k_1^k .    finally , from eq .",
    "( [ transpsi2 ] ) we get for @xmath259 , the curvature perturbation on uniform density hypersurfaces , [ zeta2 ] -_2=_2 + -^k _  k + ^-2^ij _  , ij .",
    "the second order tensor perturbation is in the uniform density gauge [ transhij2udg ] h_2ij&= & h_2ij+_ij + ( ^-2^kl_,kl-^k_k ) _ ij + ^-2 ^ -2^kl_,klij + & & + ^-2^k_k , ij -^-2(_ik ,  j^  k+_jk ,  i^  k ) .    the curvature perturbation on uniform density hypersurfaces , defined in eq .",
    "( [ zeta2 ] ) , simplifies considerably if we neglect first order vector and tensor perturbations , i.e.  setting @xmath222 and hence only considering scalar perturbations , [ zeta2scal ] & & -_2=_2+_2 - + & & -(_1 + _",
    "1)_,ke_1,^  k + _ 1 ^ 2e_1-e_1,kle_1,^  kl + & & - + & & + ^-2\\{2e_1,^  ij ( 4_1- ) -2e_1,^  ijke_1,k-4e_1,^  ike_1,k^  j - ( 2b_1-e_1 ) _",
    "1,^  j ) } _ , ij.this expression was first derived in ref .",
    "@xcite , however with a different , incorrect sub - horizon part  @xcite . on super - horizon scales , where gradient terms can be neglected ,",
    "we recover the expressions given in ref .  @xcite .",
    "in this section we give the einstein equations governing the evolution of the frw background and perturbations in general relativity .",
    "this will allow us to derive some key properties of the perturbation variables , such as the conservation of the curvature perturbation @xmath170 on super - horizon scales in the adiabatic case .    in general relativity",
    "the einstein equations relate the local spacetime curvature to the local energy - momentum : @xmath260 in more general theories of gravity we can still equate the local spacetime curvature , @xmath261 , with an effective energy - momentum , though this may not be simply related to the energy - momentum tensor derived , say , from the matter lagrangian .",
    "moreover , many modified gravity theories , including brans - dicke gravity or higher - order theories , may be rewritten in terms of general relativity plus non - minimally coupled matter fields through a conformal rescaling of coordinates @xcite . in this review",
    "we will restrict our analysis to general relativity .",
    "we can project the tensor equation ( [ einstein ] ) into components tangent to and orthogonal to the timelike 4-vector field , @xmath50 defined in eq .",
    "( [ defnmu ] ) , which defines the coordinate system ( see section [ geo_sec ] ) .",
    "this gives two constraint equations for the metric perturbations , which we will refer to as the energy and momentum constraint equations .",
    "we also have two evolution equations driven by the trace and trace - free parts of the pressure . through the bianchi identities , @xmath262 , the field equations ( [ einstein ] )",
    "imply the local conservation the total energy and momentum , [ nablatmunu ] _ t^=0 . which can similarly be split into energy and momentum conservation equations with respect to a given coordinate system .    in the case of multiple matter components",
    "the total energy - momentum tensor is the sum of the energy - momentum tensors of the individual fluids , @xmath79 , given in eq .",
    "( [ def : sumt ] ) . for each fluid",
    "the local energy - momentum `` conservation '' equation ( [ nablatalpha ] ) , has an energy - momentum transfer 4-vector , @xmath78 on the right - hand - side , which is zero only for non - interacting fluids .",
    "however local conservation of the total energy - momentum imposes the constraint eq .",
    "( [ qconstraint ] ) .",
    "we also have at our disposal the equations of motion for specific matter fields , such as the klein - gordon equation for canonical scalar fields , @xmath263 , with interaction potential energy @xmath100 : @xmath264    in the following we equate terms order by order in a perturbative expansion about a homogeneous background spacetime .",
    "the einstein equations ( [ einstein ] ) give the friedmann constraint and evolution equation for the background frw universe [ friedmann ] ^2&= & a^2 , + [ hdot ]  & = & - a^2 ( + 3p ) , and energy - momentum conservation , eq .",
    "( [ nablatmunu ] ) , gives the continuity equation [ continuity ] =-3 ( + p ) , where @xmath67 and @xmath68 are the total energy density and the total pressure , a prime denotes a derivative with respect to conformal time , @xmath13 , the scale factor is @xmath265 , and @xmath266 is the conformal hubble parameter .",
    "the total density and the total pressure are related to the density and pressure of the component fluids by _ _",
    "the continuity equation ( [ nablatalpha ] ) for each individual fluid in the background is @xcite [ cont_alpha ] _",
    "=-3(_+p _ ) + aq _ , where the energy transfer to the @xmath86-fluid is given by the time component of the energy - momentum transfer vector @xmath267 equation  ( [ qconstraint ] ) implies that the energy transfer obeys the constraint [ backconstraint ] _",
    "homogeneous scalar fields in the frw metric obey the klein - gordon equation @xmath268 it is sometimes useful to identify the kinetic energy density and ( isotropic ) pressure of each field as @xmath269 the klein - gordon equation ( [ homogkgi ] ) then implies an energy transfer of the form given by eq .",
    "( [ cont_alpha ] ) @xmath270 where this energy is transferred to the potential energy @xmath271 and overall energy conservation ( [ backconstraint ] ) implies @xmath272      in the following we discuss the linear constraint and evolution equations for inhomogeneous perturbations at first order .",
    "we omit the subscript `` 1 '' denoting the order of the perturbations to avoid unnecessary clutter .",
    "the scalar metric perturbations in an arbitrary gauge are related to matter perturbations via the first - order energy and momentum constraints @xcite @xmath273   & = & -4\\pi g",
    "a^2 \\delta\\rho , \\\\",
    "\\psi'+\\h{{\\phi _ { { } } } } & = & -4\\pi g a^2 ( \\rho+p ) v   \\label{eq : mtmcon}\\end{aligned}\\ ] ] where the total covariant velocity perturbation is given by [ defv ] v v+b , and @xmath274 is the total scalar velocity potential ( [ defv ] ) .    in a specific gauge , such as the spatially flat gauge",
    "these can be written in terms of the corresponding gauge - invariant quantities .",
    "for instance , in the spatially flat gauge we have @xmath275 which makes it straightforward to eliminate the metric variables @xmath276 and @xmath277 in favour of the energy and momentum in the flat gauge .",
    "alternatively in the longitudinal gauge the shear terms are absent and we obtain first order differential equations for the curvature perturbation @xmath278 typically one then uses these equations to eliminate the density and velocity perturbations , @xmath279 and @xmath280 , in terms of the metric perturbations in the longitudinal gauge .    the same energy and momentum constraints can be re - written in terms of gauge invariant variables to give expressions for the curvature perturbation in the uniform - density gauge ( [ defzeta ] ) and the comoving curvature perturbation ( [ defr ] ) , respectively , in terms of the longitudinal gauge metric perturbations ( [ defphi ] ) and ( [ defpsi ] ) : @xmath281    these can be combined to give the gauge - invariant generalisation of the newtonian poisson equation @xmath282 relating the longitudinal gauge curvature perturbation ( [ defpsi ] ) to the comoving density perturbation ( [ defrho1com ] ) .",
    "we see that the comoving density perturbation is suppressed relative to the metric perturbation @xmath169 on large scales , and that @xmath170 and @xmath283 coincide in the large scale limit so long as @xmath169 is finite in this limit ) shows that the variable denoted @xmath170 in the review by mukhanov , feldman and brandenberger : @xmath284 coincides with the comoving curvature perturbation when @xmath285 . ] .",
    "the perturbed einstein equations at first order also yield two evolution equations for the scalar metric perturbations @xmath286 where @xmath71 is the scalar part of the ( tracefree ) anisotropic stress , defined in eq .",
    "( [ def : pi_ij ] ) .",
    "equation  ( [ eq : aniso ] ) in a general gauge can be interpreted as the evolution equation for the scalar shear , but in the longitudinal gauge it becomes a constraint equation for the gauge - invariant perturbations @xmath185 and @xmath169 , defined in eqs .",
    "( [ defphi ] ) and  ( [ defpsi ] ) , @xmath287 and hence we have @xmath285 in the absence of anisotropic stresses .",
    "equation  ( [ eq : psievol ] ) then provides a second - order evolution equation for the metric perturbation in the longitudinal gauge driven by isotropic pressure : @xmath288 for adiabatic perturbations we can relate the pressure to the density , @xmath289 where @xmath290 is the adiabatic sound speed , in which case ( [ eq : psievol ] ) and ( [ eq : densitycon ] ) yield a closed second - order differential equation  @xcite @xmath291\\psi =   0 \\,.\\ ] ]      energy - momentum conservation gives evolution equations for the perturbed energy and momentum [ pertcontinuity ]  + 3 ( + p ) -3 ( + p )  + ( + p ) ^2 ( v+ ) = 0 , + v+(1 - 3c^2_s)v + + ( p+^2)=0 , where @xmath292 is the adiabatic speed of sound , defined as [ c2s ] c^2_s . from the momentum conservation equation in the total matter gauge , such that @xmath293 , we see that the acceleration is proportional to the pressure perturbation : @xmath294 .",
    "alternatively , for pressureless , non - interacting dust we have @xmath295 and hence the scalar velocity potential redshifts as @xmath296 in a synchronous gauge .",
    "re - writing the energy conservation equation ( [ pertcontinuity ] ) in terms of the curvature perturbation on uniform - density hypersurfaces , @xmath170 in ( [ defzeta ] ) , we obtain the important result @xmath297 where @xmath298 is the non - adiabatic pressure perturbation , defined in ( [ defpnad ] ) , and @xmath299 describes the divergence of the velocity in the longitudinal gauge , eq .",
    "( [ defv1l ] ) or , equivalently , the scalar shear along comoving worldlines  @xcite @xmath300 thus the curvature perturbation on uniform - density hypersurfaces is constant for adiabatic perturbations on large scales when the shear of comoving worldlines becomes negligible .",
    "this follows directly from local energy conservation and holds independently of the gravitational field equations  @xcite .    using the definition of @xmath170 and @xmath169 in eqs .",
    "( [ defzeta ] ) and ( [ defpsi ] ) and the constraint equation for the comoving density perturbation ( [ eq : rhomcon ] ) , we have @xmath301 thus we see that @xmath170 is constant for adiabatic perturbations ( @xmath302 ) on super - hubble scales ( @xmath303 ) , so long as @xmath169 remains finite .",
    "this makes @xmath170 a convenient variable to characterise the primordial density perturbation on super - hubble scales , either during a period of inflation in the very early universe , or in the subsequent radiation dominated era .",
    "this is an excellent approximation throughout reheating at the end of inflation and the subsequent radiation era on scales relevant for observations of degree - scale anisotropies in the cosmic microwave background and large - scale galaxy surveys @xcite .",
    "conversely , local variations in the pressure leading to a non - adiabatic pressure perturbation , @xmath298 , will lead to a change in the curvature perturbation @xmath170 on super - hubble scales @xcite .",
    "this mechanism is at the heart of the curvaton scenario for the origin of large scale structure in the universe @xcite .",
    "the perturbations in the total energy - momentum can be related to the perturbations of individual fluids by [ sum_delta_rho ] _ _ = , _ p _",
    "= , and [ sum_v ] v=_v _ , where @xmath304 and @xmath305 are the perturbed energy density and the perturbed pressure of the @xmath86-fluid , respectively , and @xmath306 is the covariant velocity perturbation of the @xmath86-fluid defined as [ defva ] v_+b , where @xmath307 is the scalar velocity potential of the @xmath86-fluid .",
    "the perturbed energy transfer 4-vector , eq .",
    "( [ nablatalpha ] ) , for individual fluids including terms up to first order , is written as  @xcite [ pert_q_vector ] q_()0 & = & -aq_(1+)-a q _ , + q_()i & = & ( f_+ aq_v ) _ , i , and eq .  ( [ qconstraint ] ) implies that the perturbed energy and momentum transfer obey the constraints [ pertconstraint ] _ q _",
    "= 0 , _ f_=0 .",
    "note that the momentum transfer , @xmath308 , is by convention @xcite defined with respect to the total momentum , @xmath309 , so is non - zero only if the momentum transfer vanishes in the total matter frame ( @xmath293 ) .    the perturbed energy conservation equation for a particular fluid , including energy transfer ,",
    "is then obtained by the first - order part of the time - component of the perturbed continuity equation ( [ nablatalpha ] ) to give @xcite [ pertenergyexact ] _ ",
    "+ 3(_+p _ ) - 3(_+p_) + ( _ + p _ ) ^2(+ ) = aq_+ aq _ , the momentum conservation equation of the @xmath86-fluid is [ dotva ] v_ & + & + + & + & = 0 , where @xmath310 is the adiabatic sound speed of the @xmath86-fluid and @xmath311 $ ] is the scalar anisotropic stress of that fluid . the total adiabatic sound speed , eq .",
    "( [ c2s ] ) , is the weighted sum of the adiabatic sound speeds of the individual fluids , c^2_s = _",
    "c^2_.    we recover the evolution equation for the total density perturbation ( [ pertcontinuity ] ) from eq .",
    "( [ pertenergyexact ] ) by summing over all fluids , using eq .",
    "( [ sum_delta_rho ] ) and the constraint ( [ pertconstraint ] ) .",
    "analogous to the curvature perturbation on uniform - total - density hypersurfaces , @xmath170 defined in eq .",
    "( [ defzeta ] ) , we can define a gauge - invariant perturbation on the uniform-@xmath86-density hypersurfaces @xmath312 the perturbed energy conservation equation for each fluid can then be written as @xmath313 \\nonumber \\\\ & & -\\left(\\frac{\\h}{a}\\right)^\\prime\\frac{aq_\\alpha}{\\rho_\\alpha ' }   \\left(\\frac{\\delta\\rho_{\\alpha}}{\\rho_\\alpha ' } -   \\frac{\\delta\\rho}{\\rho'}\\right ) - \\frac{\\h}{\\rho_\\alpha'}\\left ( \\delta q_{\\alpha } -\\frac{q_\\alpha'}{\\rho_\\alpha'}\\delta\\rho_{\\alpha}\\right ) \\",
    ", ,   \\end{aligned}\\ ] ] where the intrinsic non - adiabatic pressure perturbation of each fluid is given by [ deltapintralpha ] p_intr , p _ - c^2 _ _ , the scalar shear along worldlines comoving with the @xmath86-fluid is @xmath314 and , extending eq .",
    "( [ defpsi1com ] ) , the curvature perturbation comoving with the @xmath86-fluid is @xmath315 thus we see that @xmath316 is constant on large scales for adiabatic perturbations of any perfect fluid , with @xmath317 , whose energy is conserved , @xmath318 @xcite .",
    "in fact we shall show later that @xmath316 is constant even in the presence of energy transfer , @xmath319 , so long as that energy transfer is adiabatic @xcite .",
    "if we consider @xmath97 scalar fields with lagrangian density @xmath320 and minimal coupling to gravity , then the total energy , pressure and momentum perturbations are given by @xmath321 \\",
    ", , \\label{eq : densityphi } \\\\",
    "\\delta p & = & \\sum_i\\left [ a^{-2 } \\varphi_i ' \\left ( { \\delta\\varphi}_i ' -\\varphi_i ' { { \\phi_{{1 } } } } \\right )    - u_{i}\\delta\\varphi_i \\right ] \\ , , \\label{eq : pressurephi } \\\\ ( \\rho+p)(v+b)_{,i }   & = & - \\sum_i a^{-1 } { \\varphi}_i ' \\delta\\varphi_{i , i } \\ , , \\label{eq : mtmphi}\\end{aligned}\\ ] ] where @xmath322 .",
    "these then give the gauge - invariant comoving density perturbation ( [ defrho1com ] ) @xmath323\\,.\\end{aligned}\\ ] ] the comoving density is sometimes used to represent the total matter perturbation , but for a single scalar field it is proportional to the non - adiabatic pressure ( [ defpnad ] ) : @xmath324 from the einstein constraint equation ( [ eq : rhomcon ] ) this will vanish on large scales ( @xmath325 ) if @xmath169 remains finite , and hence single scalar field perturbations become adiabatic in this large - scale limit , even without assuming slow - roll @xcite .    the anisotropic stress , @xmath75 , vanishes to linear order for any number of scalar fields minimally coupled to gravity .",
    "the first - order scalar field perturbations obey the wave equation @xmath326 .",
    "\\label{eq : perturbation}\\nonumber\\\\\\end{aligned}\\ ] ] where the terms on the right - hand - side represent the effect of metric perturbations at first - order ( sometimes called the gravitational back - reaction ) .",
    "the scalar field wave equation in a perturbed frw cosmology can most easily be written in closed form in terms of the field perturbations in the spatially flat gauge , defined in eq .",
    "( [ defvpflat1 ] ) , which in the multi - field case have the gauge invariant definitions @xmath327 note that since the scalar field can be thought of as a potential for the 4-velocity , this variable is a rescaling of the curvature perturbation on the comoving - orthogonal hypersurface for each field @xmath328 using the einstein equations to eliminate the metric perturbations on the right - hand - side of eq .",
    "( [ eq : perturbation ] ) yields @xcite @xmath329 { \\delta\\varphi}_{\\fg j } = 0\\,.\\ ] ] the effect of gravitational coupling is now evident due to the terms proportional to newton s gravitational constant .",
    "it is also evident that this gravitational coupling vanishes at first order for fields whose time derivative vanishes in the background solution , which is why at lowest order in a slow - roll approximation during inflation one can neglect the gravitational coupling .    in the next section",
    "we will discuss how the coupled equations for multiple fields may be partially decoupled by identifying the adiabatic and isocurvature field perturbations on large scales .      the divergence - free part of the 3-momentum [ see eqs .",
    "( [ decompbi ] ) , ( [ defv ] ) and  ( [ deftmtm ] ) ] _ i = ( + p)(v_veci - s_i ) , obeys the momentum conservation equation @xmath330 where the vector part of the anisotropic stress , eq .",
    "( [ def : pi_ij ] ) , is given by @xmath331 .",
    "the gauge - invariant vector metric perturbation is then directly related to the divergence - free part of the momentum via the constraint equation @xmath332 thus the einstein equations constrain the gauge - invariant vector metric perturbation , @xmath333 , to vanish in the presence of only scalar fields , for which the divergence - free momentum necessarily vanishes .",
    "equation  ( [ eq : convec ] ) shows that vector metric perturbations can be supported only by divergence - free momenta , but even then equation ( [ eq : evolvec ] ) shows that the vector perturbations are redshifted away by the hubble expansion on large scales unless they are driven by an anisotropic stress .",
    "there is no constraint equation for the tensor perturbations as these are the free gravitational degrees of freedom ( gravitational waves ) .",
    "the spatial part of the einstein equations yields a wave equation @xmath334 where @xmath335 is the transverse and tracefree part of the anisotropic stress ( [ def : pi_ij ] ) .",
    "we can decompose arbitrary tensor perturbations into eigenmodes of the spatial laplacian , @xmath336 , with comoving wavenumber @xmath164 , and scalar amplitude @xmath337 : @xmath338 with two possible polarisation states , @xmath339 and @xmath340 . in the absence of any such anisotropic stress , e.g. , in the presence of scalar fields and perfect fluids , the amplitude , defined in eq .",
    "( [ eq : defh ] ) , of the tensor metric perturbation with comoving wavenumber , @xmath164 , obeys the wave equation for a massless scalar field ( [ eq : pertkg ] ) in an unperturbed frw metric . @xmath341",
    "we will refer to primordial perturbations as the perturbations at the epoch of primordial nucleosynthesis .",
    "the abundances of the light elements provide constraints on the matter content and expansion rate of the universe at this epoch , so we will assume that the material content of the universe is known ( photons , neutrinos , baryonic matter and cold dark matter ) and the gravitational laws are described by general relativity .",
    "this is expected to be some time after an early inflationary epoch when the perturbations originated as vacuum fluctuations on much smaller scales . by the time of primordial nucleosynthesis , the scales responsible for the large scale structure of our observable universe today",
    "were far outside the hubble scale and well described by large scale limit .    in the standard hot big bang the entropy density of the universe",
    "is dominated by the number of relativistic particles and for most of the history of the universe it is proportional to the number of photons , @xmath342 , where @xmath343 is the effective number of light species @xcite .",
    "in particular the perturbed baryon - entropy ratio @xmath344 ( assuming @xmath343 remains constant ) is given by @xcite @xmath345 written in terms of the energy density of photons , @xmath346 , and baryons , @xmath347 , at the time of primordial nucleosynthesis this becomes @xmath348    more generally , density perturbations in an @xmath2-component system can be decomposed into an overall density perturbation and @xmath349 relative density perturbations between the different components .",
    "the overall density perturbation is naturally gauge - dependent , however the gauge transformation rule for the linear density perturbation ( [ rhotransform1 ] ) suggests a natural gauge - invariant definition of the relative density perturbation at first - order , @xmath350 corresponding to the density perturbation of fluid @xmath351 on surfaces of uniform density of the fluid @xmath352 . comparing",
    "this expression with the conventional definition of the primordial baryon - entropy perturbation ( [ sb ] ) suggests a gauge - invariant definition of the relative perturbation between _ any _ two fluids @xcite @xmath353 which reduces to baryon - entropy perturbation  ( [ sb ] ) for @xmath354 .",
    "hence we refer to @xmath355 as the relative entropy perturbation for two fluids .",
    "it is the correct generalisation of the the entropy perturbation defined in ref .",
    "@xcite to the case of non - interacting fluids .",
    "the non - adiabatic pressure perturbation is given by @xmath356 for a detailed recent discussion of the non - adiabatic pressure see ref .",
    "@xcite .    in a system of more than one fluids the total non - adiabatic pressure perturbation , @xmath298 ,",
    "may be further split into two parts @xcite , [ deltapnad ] p_nadp_intr+p_rel .",
    "the first part is due to the intrinsic entropy perturbation of each fluid [ deltapintr ] p_intr=_p_nad , , where the intrinsic non - adiabatic pressure perturbation of each fluid was given in eq .",
    "( [ deltapintralpha ] ) .",
    "the second part of the non - adiabatic pressure perturbation ( [ deltapnad ] ) is due to the _ relative entropy perturbation _",
    "@xmath357 between different fluids ( [ defsij ] ) [ deltaprel ] p_rel - _ , _ _ ( c^2_-c^2_) _ .    in analogy with the non - adiabatic pressure perturbation for each fluid ( [ deltapintralpha ] )",
    ", we can identify an intrinsic non - adiabatic part of the energy transfer perturbation @xcite that appears in the perturbed energy conservation equation for each fluid ( [ pertenergyexact ] ) [ deltaqintralpha ] q_intr , q_- _ .",
    "this is automatically zero if the local energy transfer @xmath358 is a function of the local density @xmath359 so that @xmath360 , just as the intrinsic non - adiabatic pressure perturbation ( [ deltapintralpha ] ) vanishes when @xmath361 .",
    "we can also identify in eq .",
    "( [ pertenergyexact ] ) a relative non - adiabatic energy transfer @xmath362 due to the presence of relative entropy perturbations whenever the background energy transfer is non - zero , @xmath319 .",
    "the perturbed energy conservation eq .",
    "( [ dotzetaalpha ] ) for each fluid can then be written as @xmath363   \\end{aligned}\\ ] ] where the non - adiabatic pressure perturbation of each fluid is given by eq .",
    "( [ deltapintralpha ] ) and the non - adiabatic energy transfer is given by eqs .",
    "( [ deltaqintralpha ] ) and ( [ deltaqrelalpha ] ) .",
    "we thus see that @xmath316 is constant for adiabatic perturbations in the large scale limit where the shear of comoving worldlines , @xmath364 defined in eq .",
    "( [ sigmaalpha ] ) , vanishes @xcite .",
    "more generally @xcite one finds a conserved perturbation whenever there is a local conservation equation of the form @xmath365 , where @xmath56 is the local expansion rate and @xmath59 the proper time along comoving worldlines .",
    "when one integrates this conservation equation one finds the local logarithmic expansion as a function of @xmath366 : @xmath367 thus the difference @xmath368 evaluated along different worldlines remains a fixed constant of integration if one evaluates @xmath369 on constant time hypersurfaces separated by a fixed expansion , and spatially flat hypersurfaces provide a suitable time - slicing on large scales .",
    "the classic example of such a conserved quantity is the curvature perturbation on uniform density hypersurfaces , @xmath170 defined in eq .",
    "( [ defzeta ] ) , which is conserved on large scales when @xmath370 and thus the perturbations are adiabatic . but as we have seen the same result holds for the curvature perturbation on uniform - density hypersurfaces for any fluid whose pressure perturbation and energy transfer is adiabatic .",
    "thus the matter isocurvature perturbation ( [ sb ] ) is constant on large scales if there is negligible energy transfer between non - relativistic matter and radiation .",
    "however at even higher energies we can still define a conserved perturbation associated with conserved baryon number density @xcite @xmath371 so long as we have a conserved quantum number associated with baryon number",
    ". the observed stability of the proton implies that baryon number is conserved up to very high energy , possibly the gut scale , and thus it should be possible to relate any primordial baryon isocurvature perturbation to physics at very high energies .      in the background frw cosmology driven by multiple scalar fields it is possible to identify an adiabatic direction along the background trajectory in field space @xmath372 the background solution , even in the presence of multiple fields , can then be described in terms of an effective single field , @xmath373 , obeying the usual klein - gordon equation @xmath374 where @xmath375 and @xmath376 .",
    "however field perturbations need not follow this background trajectory and we encounter qualitatively different behaviour from that in the single field case when we consider inhomogeneous perturbations about the background trajectory",
    ".    in analogy with our treatment of fluid perturbations one can identify adiabatic and isocurvature field perturbations in a cosmology with more than one scalar field .",
    "indeed even a single scalar field , @xmath90 , can support a non - adiabatic pressure perturbation , given in eq .",
    "( [ dpnadsingle ] ) .",
    "we refer to this as the intrinsic pressure perturbation for the field .",
    "however this intrinsic non - adiabatic perturbation for a single field is proportional to the comoving density perturbation and thus vanishes in a scalar field dominated universe on large scales according to eq .",
    "( [ eq : rhomcon ] ) , leaving effectively only adiabatic perturbations in this large scale limit .    for multiple fields we can perform a local rotation in field space to identify the adiabatic part of arbitrary perturbations along the background trajectory @xcite @xmath377 the generalisation to non - canonical fields with arbitrary metric in field space",
    "is given in refs .",
    "@xcite .",
    "field perturbations orthogonal to the adiabatic field are isocurvature field perturbations , or entropy perturbations in analogy with the fluid density perturbations ( [ sb ] ) , @xmath378    note that the adiabatic field perturbation is naturally gauge - dependent , whereas the isocurvature field perturbations are gauge - independent at first order . for simplicity we will consider the case of two scalar fields where the direction in field space is given by the angle @xmath56 , see figure  1 , so that @xmath379 .",
    "we then have @xmath380 and we will work with the adiabatic field perturbation in the spatially flat gauge @xmath381 note that @xmath382 is thus proportional to the total comoving curvature perturbation @xmath383 since the adiabatic field , @xmath373 , is the potential for the total velocity , @xmath384 .",
    "[ fig : decompose ]      and @xmath385 are used to denote the instantaneous adiabatic and entropy fields respectively , along and orthogonal to the curved background solution in field space.,title=\"fig:\",height=188 ]    the adiabatic and isocurvature field perturbations obey the coupled evolution equations @xcite @xmath386 \\delta r_\\fg \\nonumber\\\\ = 2(\\theta'\\delta s ) ' - 2\\left ( \\frac{a^2u_r}{r ' } + \\frac{\\h'}{\\h } \\right ) \\theta ' \\delta s\\,,\\\\ \\label{eq : entropyeom }   { \\delta s } '' + 2\\h{\\delta s } ' + \\left({k^2 }    + a^2u_{ss } + 3{\\theta}^{\\prime2 } \\right ) \\delta s = \\frac{\\theta'}{r ' } \\frac{k^2}{2\\pi g } \\psi\\,,\\end{aligned}\\ ] ] where @xmath387 we can identify a purely adiabatic mode where @xmath388 and remains zero on large scales . however a non - zero isocurvature perturbation appears as a source term in the perturbed inflaton equation ( [ eq : twoscalareom ] ) whenever @xmath389 and the inflaton trajectory is curved in field space . note that @xmath390 is given by @xcite @xmath391 where @xmath392 is the potential gradient orthogonal to the inflaton trajectory in field space . in the slow - roll approximation",
    "the background field always follows the potential gradient so the adiabatic - isocurvature coupling is suppressed in this slow - roll limit the integrated effect of isocurvature field perturbations on the adiabatic field perturbation can not in general be neglected .",
    "equation  ( [ eq : twoscalareom ] ) shows that the isocurvature perturbation @xmath393 works as a source term for the adiabatic curvature perturbation .",
    "this is in fact clearly seen if we take the time derivative of the comoving curvature perturbation ( [ radiabatic ] ) : @xmath394 therefore @xmath395 ( or equivalently @xmath170 ) is not conserved even in the large - scale limit in the presence of an isocurvature field perturbation , @xmath393 , with a non - straight trajectory in field space ( @xmath389 ) .",
    "by contrast , the solution for the isocurvature field perturbation is independent of any initial adiabatic perturbation on large - scales .",
    "the adiabatic perturbation provides a source term for the isocurvature field only through the spatial gradient of the longitudinal gauge metric potential , @xmath169 , which rapidly becomes negligible on super - hubble scales during slow - roll inflation .",
    "the standard hot big bang model of cosmology has a major shortcoming in that there is no causal explanation for the existence of primordial density perturbations on super - hubble scales during the radiation dominated era .",
    "the cmb , and in particular the acoustic peaks in the temperature and polarisation anisotropies seen by the wmap satellite @xcite provide strong evidence that these primordial density perturbations do exist on scales much larger than the causal horizon at early times .",
    "the detailed distribution of primordial inhomogeneities is left as an unexplained initial condition in the standard hot big bang .",
    "the primary success of inflation @xcite is to give a model for the origin of the primordial density perturbations from vacuum fluctuations during a period of accelerated expansion at very early times .",
    "this relies on speculative and uncertain physics - in particular it requires some form of energy density with negative pressure in general relativity - but the unexpected discovery that the universe is accelerating today appears to show that cosmological inflation does happen .",
    "zero - point vacuum fluctuations of any light , weakly - coupled scalar field will be stretched up to super - hubble scales during inflation and leave an approximately scale - invariant and gaussian distribution of perturbations on large scales @xcite .",
    "the simplest model for inflation is that it is driven by a vacuum ( potential ) energy density which is a function of one or more scalar fields .",
    "we can describe the homogeneous frw solution using the inflaton field , @xmath373 , which describes the evolution along the trajectory , @xmath396 defined in eq .",
    "( [ defhatr ] ) , in a possibly multi - dimensional field space . for a sufficiently flat potential",
    "the evolution can be well - described by the slow - roll approximation which assumes that the energy density is potential dominated @xmath397 this is equivalent to requiring that the first slow - roll parameter is small : @xmath398 note that the condition for accelerated expansion requires @xmath399 . in terms of the potential we have @xmath400",
    "we also assume the universe is overdamped , such that @xmath401 this implies that we can neglect the decaying mode of the overdamped system and we have a unique trajectory in field space for a single field .",
    "this is a self - consistent approximation when the inflaton field is light compared with the hubble scale , which requires that the second slow - roll parameter is small : @xmath402    in the two - field model described in section  [ twofield ] , allowing for non - adiabatic perturbations , we can define three parameters @xcite , @xmath403 , @xmath404 and @xmath405 , describing the curvature of the potential , where in general we have @xmath406    the background slow - roll solution is described in terms of the slow - roll parameters by @xmath407 while the perturbations on large scales ( comoving wavenumber @xmath408 ) obey @xmath409 where we neglect spatial gradients .",
    "although @xmath410 at lowest order in slow - roll , this does not mean that the inflaton and entropy perturbations decouple .",
    "@xmath411 given by eq .",
    "( [ twofieldbackground ] ) is in general non - zero at first - order in slow - roll and large - scale entropy perturbations do affect the evolution of the adiabatic perturbations when @xmath412 .",
    "while the general solution to the two second - order perturbation equations ( [ eq : twoscalareom ] ) and ( [ eq : entropyeom ] ) has four independent modes , the two first - order slow - roll equations ( [ twofieldperturbations ] ) give the approximate form of the squeezed state on large scales .",
    "this has only two modes which we can describe in terms of the dimensionless comoving curvature and isocurvature perturbations : @xmath413 the normalisation of @xmath171 coincides with the standard definition of the comoving curvature perturbation , eq .",
    "( [ defr ] ) .",
    "the normalisation of the dimensionless entropy during inflation , @xmath414 , is chosen here coincide with ref .",
    "it can be related to the non - adiabatic pressure perturbation ( [ defpnad ] ) on large scales @xmath415 the slow - roll approximation can provide a useful approximation to the instantaneous evolution of the fields and their perturbations on large scales during slow - roll inflation , but is not expected to remain accurate when integrated over many hubble times , where inaccuracies can accumulate . in single - field inflation the constancy of the comoving curvature perturbation after hubble exit , which does not rely on the slow - roll approximation , is crucial in order to make accurate predictions of the primordial perturbations using the slow - roll approximation only around hubble crossing . in a two - field model",
    "we must describe the evolution after hubble exit in terms of a general transfer matrix : @xmath416 on large scales the comoving curvature perturbation still remains constant for the purely adiabatic mode , corresponding to @xmath417 , and adiabatic perturbations remain adiabatic .",
    "these general results are enough to fix two of the coefficients in the transfer matrix , but @xmath418 and @xmath419 remain to be determined either within a given theoretical model , or from observations , or ideally by both .",
    "the scale - dependence of the transfer functions depends upon the inflaton - entropy coupling at hubble exit during inflation and can be given in terms of the slow - roll parameters as @xcite @xmath420      the expectation value of the fluctuations of a homogeneous field are given by @xmath421 where angle brackets denote the ensemble average ( i.e. , the average over infinitely many realisations of the field , which is equivalent to taking the spatial average in an infinite space ) .",
    "the dimensionless power spectrum of the field ( equivalently the variance of the field per logarithmic range of @xmath164 ) is given by @xmath422    for weakly - coupled , light fields we can neglect interactions on wavelengths below the hubble scale , so that vacuum fluctuations correspond to @xcite @xmath423 this gives rise to the power spectrum of field fluctuations on the hubble scale ( @xmath424 ) during inflation given by @xmath425 where we use a @xmath426 to denote quantities evaluated at hubble - exit . if a field has a mass comparable to the hubble scale or larger then the vacuum fluctuations on wavelengths greater than the effective compton wavelength are suppressed .",
    "in addition fluctuations in strongly interacting fields may develop correlations before hubble exit .",
    "but during slow - roll inflation the correlation between vacuum fluctuations in weakly coupled , light fields at hubble - exit is suppressed by slow - roll parameters .",
    "this remains true under a local rotation in fields space to another orthogonal basis such as the instantaneous inflaton and entropy directions ( [ defdeltar ] ) and ( [ defdeltas ] ) in field space .",
    "the curvature and isocurvature power spectra at hubble - exit are given by @xmath427 while the cross - correlation is first - order in slow - roll @xcite , @xmath428 where @xmath429 and @xmath430 is the euler number .",
    "the normalisation chosen for the dimensionless entropy perturbation in eq .",
    "( [ eq : defrs ] ) ensures that the curvature and isocurvature fluctuations have the same power at horizon exit @xcite .",
    "the spectral tilts at horizon - exit are also the same and are given by @xmath431 where @xmath432 .",
    "the tensor perturbations ( [ teneq ] ) are decoupled from scalar metric perturbations at first - order and hence the power spectrum has the same form as in single field inflation .",
    "thus the power spectrum of gravitational waves on super - hubble scales during inflation is given by @xmath433 and the spectral tilt is @xmath434      the resulting primordial power spectra on large scales can be obtained simply by applying the general transfer matrix ( [ deftransfer ] ) to the initial scalar perturbations .",
    "the scalar power spectra probed by astronomical observations are thus given by @xcite @xmath435 note that the primordial curvature and isocurvature perturbations from inflation are in general correlated  @xcite ( see also @xcite ) .",
    "the cross - correlation can be given in terms of a dimensionless correlation angle : @xmath436 we see that if we can determine the dimensionless correlation angle , @xmath437 , from observations , then this determines the off - diagonal term in the transfer matrix @xmath438 and we can in effect measure the contribution of the entropy perturbation during two - field inflation to the resultant curvature primordial perturbation . in particular this allows us in principle to deduce from observations the power spectrum of the curvature perturbation at hubble - exit during two - field slow - roll inflation @xcite : @xmath439    the scale - dependence of the resulting scalar power spectra depends both upon the scale - dependence of the initial power spectra and of the transfer coefficients .",
    "the spectral tilts are given from eqs .",
    "( [ pr][crs ] ) by @xmath440 \\ , ,   \\nonumber\\end{aligned}\\ ] ] where we have used eq .",
    "( [ deftrs ] ) to eliminate @xmath441 in favour of the observable correlation angle @xmath437 .",
    "substituting eq .",
    "( [ nr * ] ) for the tilt at hubble - exit , and eqs .",
    "( [ dtdlnk ] ) for the scale - dependence of the transfer functions , we obtain @xcite @xmath442 although the overall amplitude of the transfer functions are dependent upon the evolution after hubble - exit and through reheating into the radiation era , the spectral tilts can be expressed solely in terms of the slow - roll parameters at hubble - exit during inflation and the correlation angle , @xmath437 , which can in principle be observed .    if the primordial curvature perturbation results solely from the adiabatic inflaton field fluctuations during inflation then we have @xmath443 in eq .",
    "( [ pr ] ) and hence @xmath444 in eqs .",
    "( [ srtilts ] ) , which yields the standard single field result @xmath445 any residual isocurvature perturbations must be uncorrelated with the adiabatic curvature perturbation ( at first - order in slow - roll ) with spectral index @xmath446    on the other hand , if the observed primordial curvature perturbation is produced due to some entropy field fluctuations during inflation , we have @xmath447 and @xmath448 . in a two - field inflation model any residual primordial isocurvature perturbations will then be completely correlated ( or anti - correlated ) with the primordial curvature perturbation and we have @xmath449    the gravitational wave power spectrum is frozen - in on large scales , independent of the scalar perturbations , and hence @xmath450 thus we can derive a modified consistency relation @xcite between observables applicable in the case of two - field slow - roll inflation : @xmath451 this relation was first obtained in ref .",
    "@xcite at the end of two - field inflation , and verified in ref .",
    "@xcite for slow - roll models .",
    "but it was realised in ref .",
    "@xcite that this relation also applies to the primordial perturbation spectra in the radiation era long after two - field slow - roll inflation has ended and hence may be tested observationally .    more generally , if there is any additional source of the scalar curvature perturbation , such as additional scalar fields during inflation , then this could give an additional contribution to the primordial scalar curvature spectrum without affecting the gravitational waves , and hence the more general result is the inequality @xcite : @xmath452 this leads to a fundamental difference when interpreting the observational constraints on the amplitude of primordial tensor perturbations in multiple inflation models . in single field inflation",
    ", observations directly constrain @xmath453_*$ ] and hence , from eqs .",
    "( [ rstar ] ) and ( [ tstar ] ) , the slow - roll parameter @xmath107 .",
    "however in multiple field inflation , non - adiabatic perturbations can enhance the power of scalar perturbations after hubble exit and hence observational constraints on the amplitude of primordial tensor perturbations do not directly constrain the slow - roll parameter @xmath107 .",
    "current cmb data alone require @xmath454 ( assuming power - law primordial spectra ) @xcite which in single - field models is interpreted as requiring @xmath455 .",
    "but in multiple field models @xmath107 could be larger if the primordial density perturbation comes from non - adiabatic perturbations during inflation .",
    "a powerful technique to calculate the primordial curvature perturbation resulting from many inflation models , including multi - field models , is to note that the curvature perturbation @xmath170 defined in eq .",
    "( [ defzeta ] ) can be interpreted as a perturbation in the local expansion @xcite @xmath456 where @xmath58 is the perturbed expansion to uniform - density hypersurfaces with respect to spatially flat hypersurfaces , which is given to first - order by @xmath457 where @xmath458 must be evaluated on spatially flat ( @xmath57 ) hypersurfaces ( see sections [ geo_quant_sec ] and [ udg_sec ] ) .",
    "an important simplification arises on large scales where anisotropy and spatial gradients can be neglected , and the local density , expansion , etc .",
    ", obeys the same evolution equations as in a homogeneous frw universe @xcite .",
    "thus we can use the homogeneous frw solutions to describe the local evolution , which is known as the `` separate universe '' approach @xcite .",
    "in particular we can evaluate the perturbed expansion in different parts of the universe resulting from different initial values for the fields during inflation using the homogeneous background solutions @xcite .    in the slow - roll approximation",
    "the integrated expansion on super - hubble scales from some initial spatially flat hypersurface up to a subsequent fixed density hypersurface ( say at the epoch of primordial nucleosynthesis ) is some function of the local field values on the initial hypersurface , @xmath459 .",
    "more generally we expect this to hold whenever we can neglect the decaying mode for the field perturbations on super - hubble scales .",
    "the resulting primordial curvature perturbation on the uniform - density hypersurface is then @xmath460 where @xmath461 and @xmath462 is the field perturbation on some initial spatially - flat hypersurfaces during inflation ( [ eq : defdphipsi ] ) .",
    "in particular the power spectrum for the primordial density perturbation in a multi - field inflation can be written ( at leading order ) in terms of the field perturbations after hubble - exit as @xmath463    this approach is readily extended to estimate the non - linear effect of field perturbations on the metric perturbations @xcite .",
    "we can take eq .",
    "( [ deltan ] ) as our definition of the non - linear primordial curvature perturbation , @xmath170 , so that in the radiation dominated era the non - linear extension of eq .",
    "( [ linearzetarho ] ) is given by @xcite @xmath464 where @xmath465 is the perturbed ( inhomogeneous ) density evaluated on a spatially flat hypersurface and @xmath466 is the background ( homogeneous ) density . see refs .",
    "@xcite for alternative approaches to define the non - linear extension of @xmath170 .",
    "this non - linear curvature perturbation as a function of the initial field fluctuations can simply be expanded as a taylor expansion @xcite @xmath467 where we now identify ( [ lineardeltan ] ) as the leading - order term .",
    "we expect the field perturbations at hubble - exit to be close to gaussian for weakly coupled scalar fields during inflation @xcite . in this case",
    "the bispectrum of the primordial curvature perturbation at leading ( fourth ) order , can be written as @xcite [ fnlmultifielddefn ] b _ ( , , ) & = & 65 . where @xmath468 , and the dimensionless non - linearity parameter is given , using the @xmath469-formalism , by '' in eq .",
    "( [ fnlmultifield ] ) is a historical convention , due to the original definition @xcite which was given in terms of the newtonian potential , which on large scales in the matter era is given by @xmath470 . ]",
    "@xcite @xmath471 similarly to the bispectrum , the connected part of the trispectrum in this case can be written as @xcite [ taunlgnldefn ] t _ ( , , , ) & = & _ nl + & & + g_nl . where [ taunlmultifield ] _",
    "nl&= & , + [ gnlmultifield ] g_nl&=&. the expression for @xmath472 was first given in @xcite .",
    "note that we have factored out products in the trispectrum with different @xmath164 dependence in order to define the two @xmath164 independent non - linearity parameters @xmath472 and @xmath473 .",
    "this gives the possibility that observations may be able to distinguish between the two parameters @xcite .",
    "in many cases there is single direction in field - space , @xmath474 , which is responsible for perturbing the local expansion , @xmath475 , and hence generating the primordial curvature perturbation ( [ taylor ] ) .",
    "for example this would be the inflaton field in single field models of inflation , or it could be a late - decaying scalar field @xcite as in the curvaton scenario @xcite . in this case",
    "the curvature perturbation ( [ taylor ] ) is given by @xmath476 and the non - gaussianity of the primordial perturbation has the simplest `` local '' form @xmath477 where @xmath478 is the leading - order gaussian curvature perturbation and the non - linearity parameters @xmath479 and @xmath473 , are given by @xcite [ fnl1field ] f_nl&=&56 , + [ gnl1field ] g_nl&= & , the primordial bispectrum and trispectrum are then given by eqs .",
    "( [ fnlmultifielddefn ] ) and  ( [ taunlgnldefn ] ) , where the non - linearity parameters @xmath479 and @xmath473 , given in eqs .",
    "( [ fnlmultifield ] ) and  ( [ gnlmultifield ] ) , reduce to eqs .",
    "( [ fnl1field ] ) and  ( [ gnl1field ] ) respectively , and @xmath472 given in eq.([taunlmultifield ] ) reduces to [ taunl1field ] _ nl&=&=f_nl^2 .",
    "thus @xmath472 is proportional to @xmath480 ( first shown in @xcite using the bardeen potential , and in @xcite using this notation ) .",
    "however the trispectrum could be large even when the bispectrum is small because of the @xmath473 term @xcite .    in the case of where the primordial curvature perturbation is generated solely by adiabatic fluctuations in the inflaton field , @xmath373 ,",
    "the curvature perturbation is non - linearly conserved on large scales @xcite and we can calculate @xmath481 , @xmath482 , @xmath483 , etc , at hubble - exit . in terms of the slow - roll parameters , we find n&= & ~ ( ^-1/2 ) , + n&&-12(_rr-2 ) ~ ( 1 ) , + n&&(_rr-_rr^2 + 12_r^2 ) ~ ( ^1/2 ) , where we have used the reduced planck mass @xmath484 and introduced the second - order slow - roll parameter @xmath485 .",
    "hence the non - linearity parameters for single field inflation , ( [ fnl1field ] ) and  ( [ gnl1field ] ) , are given by f_nl&=&56(_rr-2 ) , + g_nl&=&(2_rr-2_rr^2 + _ r^2 ) .",
    "with @xmath472 given by eq .",
    "( [ taunl1field ] ) .",
    "although there are additional contributions to the primordial bispectrum and trispectrum coming from the intrinsic non - gaussianity of the field perturbations at hubble - exit , these are also suppressed by slow - roll parameters in slow - roll inflation .",
    "thus the primordial non - gaussianity is likely to be too small to ever be observed in the conventional inflaton scenario of single - field slow - roll inflation  @xcite .",
    "indeed any detection of primordial non - gaussianity @xmath486 would appear to rule out this inflaton scenario .",
    "however significant non - gaussianity can be generated due to non - adiabatic field fluctuations .",
    "thus far it has proved difficult to generate detectable non - gaussianity in the curvature perturbation during conventional slow - roll inflation , even in multiple field models @xcite , though see refs .",
    "but detectable non - gaussianity might be produced in non - slow - roll @xcite or non - canonical scalar field inflation @xcite , or when the curvature perturbation is generated from isocurvature field perturbations at the end of inflation @xcite , during inhomogeneous reheating @xcite , or some time after inflation has ended in the curvaton model @xcite .",
    "linear perturbations have become part of the standard toolbox of modern cosmology .",
    "earlier confusion surrounding apparently different behaviour found in different coordinate bases has largely been resolved through the use of variables which have gauge - invariant definitions . in section [ gi_var_sec ]",
    "we have emphasised the physical interpretation of these gauge - invariant variables .",
    "the power spectrum of primordial perturbations revealed by the cosmic microwave background and large scale galaxy surveys is a powerful probe of inflationary models of the very early universe , and a challenge for alternative theories .",
    "linear theory enables us to relate the primordial spectra to quantum fluctuations in the metric and matter fields at much higher energies . in the simplest single field inflation models , it is possible to equate the primordial density perturbation with the curvature perturbation , @xmath170 defined in eq .",
    "( [ defzeta ] ) , during inflation which remains constant on large scales for adiabatic density perturbations .",
    "more generally , if one allows for non - adiabatic perturbations then it becomes necessary to allow for variation in the curvature perturbation , even on super - hubble scales .",
    "nonetheless it is still possible in many cases to identify the primordial density perturbation with a perturbed expansion in the @xmath58 approach described in section  [ non_linear_sec ] where the integrated expansion , @xmath97 , is a function of the local field values on spatially flat slices during inflation .",
    "as one goes beyond the textbook examples , it becomes necessary to have a clear physical definition of the perturbation variables to consistently extend the background frw equations to the inhomogeneous perturbations .",
    "the new frontier in the study of cosmological perturbations is the study of non - linear primordial perturbations , at second - order and beyond .",
    "many of the familiar certainties of linear perturbation theory no longer apply .",
    "we have shown in section [ gaugesec ] that quantities that were automatically gauge - independent at first order ( including the non - adiabatic pressure perturbation , anisotropic stress , and the tensor metric perturbation ) become gauge dependent at second order .",
    "we have shown in section [ gi_var_sec ] that it is possible to use the same methodology to construct gauge - invariant variables at second ( and higher ) order .",
    "a variable with an unambiguous physical meaning will have a gauge invariant definition .",
    "the resulting gauge invariant definitions inevitably become more complicated than those at first order and we have only presented explicit definitions at second order for a few cases . likewise we have not attempted to present the second order dynamical equations in a comprehensive manner as was done at first order in section  [ sect : dynamics ] .",
    "our aim has been to provide an introduction to some of the issues that arise at higher order .",
    "early works on non - linear and second order perturbation theory include refs .",
    "@xcite , more recently see also refs .",
    "@xcite .",
    "non - linearities allow additional information to be gleaned from the primordial perturbations . much effort is currently being devoted to the study of higher - order correlations .",
    "non - gaussianity in the distribution of primordial density perturbations would reveal interactions beyond the linear theory .",
    "such interactions are minimal ( suppressed by slow - roll parameters ) in the simplest single field inflation model , so any detection of primordial non - gaussianity would cause a major upheaval in our thinking about the very early universe . in principle",
    "the @xmath58 approach can be easily extended to higher - orders , simply by extending the taylor series for the integrated expansion as a function of the field perturbations beyond linear order .",
    "this enables one to compute higher - order correlation functions for @xmath170 as shown in section [ non_linear_sec ] .",
    "the challenge is then to develop transfer functions to relate the primordial @xmath170 to observables beyond linear order  @xcite , although large primordial non - gaussianity ( e.g. , @xmath487 ) is expected to dominate over non - linearity in the transfer functions .",
    "the klein - gordon equation in closed form at second order shows that at second order scalar perturbations will also be sourced by terms quadratic in first order field perturbations @xcite .",
    "this and second order perturbation theory in general , provides an alternative to using the @xmath58 formalism in calculating the primordial non - gaussianity @xmath488 @xcite .",
    "the main advantage of perturbation theory is that it can also be extended to sub - horizon scales , whereas the @xmath58 formalism is only valid on super - horizon scales , and in some cases it has been shown to be numerically more efficient @xcite .",
    "typically non - linear effects are going to be small , given that scalar metric perturbations are only of order @xmath489 .",
    "primordial tensor modes are smaller , and vector modes are effectively zero during scalar field driven inflation .",
    "but the additional information available from higher - order correlations and the use of optimised filters for specific forms of non - gaussianity means that there are already impressive constraints on the degree of primordial gaussianity .",
    "qualitatively new effects appear beyond linear order .",
    "the non - linearity of the field equations inevitably leads to mixing between scalar , vector and tensor modes and the existence of primordial density perturbations then inevitably generates vector and tensor modes @xcite .",
    "as shown in section [ gaugesec ] , if we continue studies of scalar perturbations to higher order then the distinction between the different types of perturbations becomes gauge dependent and consistent computation will require careful ( gauge invariant ) definition of the variables being used .",
    "dw is supported by stfc .",
    "the authors are grateful to all their collaborators for the collaborative work upon which much of this review is based , including kishore ananda , marco bruni , ed copeland , juan garcia - bellido , chris gordon , kazuya koyama , david langlois , andrew liddle , jim lidsey , david lyth , david matravers , misao sasaki , david seery , and filippo vernizzi , and we thank hooshyar assadullahi , chris byrnes , anne green , and roy maartens for their careful reading of this manuscript .",
    "algebraic computations were assisted by the grtensorii package for maple and by cadabra @xcite .",
    "the sign convention is ( + + + ) in the classification of misner , thorne , and wheeler @xcite . + tensor indices : + greek indices , such as @xmath490 , run from 0 to @xmath491 .",
    "latin indices , such as @xmath492 , run from 1 to @xmath491 , that is only over spatial dimensions .",
    "+ spatial three - vectors are written in boldface , i.e.  @xmath493 , whenever convenient .",
    "+ throughout this work we use the units @xmath494 .",
    "the connection coefficient is defined as ^_= 12 g^ ( g _ , + g _ , - g _ , ) .",
    "the riemann tensor is defined as r^ _",
    "= ^_,-^_,+ ^_^_- ^_^ _ .",
    "the ricci tensor is a contraction of the riemann tensor and given by r_=r^ _   , and the ricci scalar is given by contracting the ricci tensor r = r^ _   .",
    "the einstein tensor is defined as g_=r_-g_r .",
    "the covariant derivatives are denoted by & _ ; & _   covariant  differentiation  with   respect  to  g _ .",
    "partial derivatives are denoted by x_,i .",
    "symmetrisation and anti - symmetrisation are , as usual , defined as v_(i , j)(v_i , j+v_j , i ) , v_[i , j](v_i , j - v_j , i ) .",
    "the lie derivatives with respect to a vector field @xmath110 of a scalar @xmath124 , a covariant vector @xmath495 , and a covariant tensor @xmath496 are given by ( see e.g. ref .",
    "@xcite ) [ lie_scalar ]  _ & = & ^ _ , , + [ lie_vector ]  _ v_&= & v_,^+v_^ _ ,  , + [ lie_tensor ]  _ t _ & = & t_,^+t_^ _ ,  + t_^ _ ,  .",
    "the covariant derivatives of a scalar @xmath124 , a covariant vector @xmath497 , and a covariant tensor @xmath496 are given by ( e.g.  @xcite ) _ ; & = & _ , , + v_;&=&v_,-^_v _ , + t_;&=&t _ , -^_t _",
    "in the following no gauge is specified , and we leave quantities undecomposed whenever convenient ( the decomposition rules are given in eqs .",
    "( [ vectordecomp ] ) , ( [ decompbi ] ) , and ( [ decompcij ] ) ) .",
    "the connection coefficients up to and including second order are ^0_00 & = & + _ 1+_2-2_1_1 + b_1kb^1k+b_1^kb_1k+b_1^k_1,k , + ^0_0i & = & _ 1,i+_2,i + ( b_1i+b_2i ) -2_1_1,i-2_1 b_1i + b_1^k c_1ki + & & + b_1^k ( b_1k , i - b_1i , k ) , + ^i_00 & = & ( b_1^  i+b_2^  i ) + ( b_1^  i+b_2^  i ) + _",
    "1,^  i+_2,^  i-_1b_1^  i + & & -2c_1^ikb_1k -2c_1^ikb_1k-2c_1^ik_1,k , + ^i_j0 & = & ^i_j+c^i_1  j+ + ( b_1  , j^  i - b_1j,^  i ) + ( b_2  , j^  i - b_2j,^  i ) + & & -2c_1^ikc_1jk-b_1^  i(b_1j+_1,j ) + c_1^ik ( b_1j , k - b_1k , j ) , + ^0_ij & = & _ ij + c_1ij+c_2ij + 2c_ij+c_2ij + & & -(b_1j , i + b_1i , j ) -(b_2j , i + b_2i , j ) + b_1^  k(c_1jk , i+c_1ik , j - c_1ij , k ) + & & + _ 1+_ij , + ^i_jk & = & c^  i_1k , j+c^  i_1j , k - c^  i_1jk , + ( c^  i_2k , j+c^  i_2j , k - c^  i_2jk , ) -_kj ( b_1^  i+b_2^  i ) + & & + b_1^  i ( b_1k , j + b_1j , k ) + b_1^  i+2_kjb_1l c_1^li + & & -2c_1^il ( c_1kl , j+c_1jl , k - c_1jk , l ) , including scalar , vector , and tensor perturbations .",
    "the energy - momentum tensor for @xmath97 scalar fields with potential @xmath498 is then split into background , first , and second order perturbations , using eq .",
    "( [ tensor_split1 ] ) , as t^ _",
    "t^_(0 ) + t^_(1 ) + t^_(2 ) , and we get for the components , from eq .",
    "( [ multitmunu ] ) , at zeroth order t^0_(0)0 & = & -(_k^2+u_0 ) , t^i_(0)j = ( ^2-u_0)^i _  j , at first order [ deltat100 ] t^0_(1)0 & = & -_k ( _ 0k1-_0k^21 ) -1 , + [ deltat10i ] t^0_(1)i & = & -_k(_0k1_,i ) , + t^i_(1)j & = & ^i _",
    "j , and at second order in the perturbations t^0_(2)0 & = & -_k , + [ deltat20i ] t^0_(2)i & = & -_k(_0k2_,i -4 1_0k1_,i+211_,i ) , + t^i_(2)j & = & _ k^i _  j + & & + ( _ 0kb_1^  i+1_,^  i ) _ 1k , j .",
    "we get for the components of the stress energy tensor , indices down , in the background t_00 = -a^2_0 , t_0i = 0 , t_ij = a^2 p_0 , at first order , ^(1)t_00 & = & a^2(_1 + 2_01 ) , + ^(1)t_0i & = & a^2 , + ^(1)t_ij & = & a^2 , and at second order ^(2)t_00 & = & a^2 , + ^(2)t_0i & = & -a^2 , + ^(2)t_ij & = & a^2 .",
    "it is often convenient to have all relevant equations available `` at a single glance '' . we therefore reproduce all governing equations given in previous sections in this appendix together .",
    "no gauge is specified , i.e.  without choosing a particular hypersurface or gauge restrictions , and we leave quantities undecomposed whenever possible ( the decomposition rules are given in eqs .",
    "( [ vectordecomp ] ) , ( [ decompbi ] ) , and ( [ decompcij ] ) ) .      energy conservation for the @xmath86-fluid in the background is given from eq .",
    "( [ nablatalpha ] ) as _ 0=-3(_0+p_0)+aq_0 , and the total energy conservation is then given by summing over the individual fluids and using eq .",
    "( [ qconstraint ] ) as _ 0=-3(_0+p_0 ) .",
    "the @xmath151 einstein equation is given from eq .",
    "( [ einstein ] ) as 3 ( _ 1 + _ 1 ) -^2(_1+_1)= -4 g a^2_1 .",
    "the @xmath18 einstein equation is _ 1 + _",
    "1= -4ga^2(_0+p_0)(v_1+b_1 ) , the off - trace is _",
    "1+2_1+_1-_1=8 g a^2 , and the trace is _ 1+2_1+_1 + ( 2-)_1 = 4 g a^2 ( p_1+^2 ) .      energy and momentum conservation of the @xmath86-fluid is given from eq .",
    "( [ nablatalpha ] ) at first order as _  + 3(_+p",
    "_ ) - 3(_+p_) + a^-1(_+p _ ) ^2(+ ) = aq_+ aq _ , the momentum conservation equation of the @xmath86-fluid is _ ",
    "total energy and momentum conservation follows from the above , by summing over all individual fluids and using eqs .  ( [ qconstraint ] ) , and is given by _",
    "1 + 3 ( _ 1+p_1 ) & + & ( _ 0+p_0)=0 , +  & + & ( _ 0+p_0 ) + p_1+^2=0 .",
    "+        in the multi - fluid case , energy conservation of the @xmath86-fluid is given from eq .",
    "( [ nablatalpha ] ) at second order as & & _ 2+3 ( _ 2 + p_2 ) + ( _ 0+p_0 ) ( -3_2+^2 e_2+^2v_2 ) + & & + 2 ( _ 1+p_1 ) ( -3_1+^2 e_1+^2v_1 ) + & & + 2 ( _ 1+p_1)_,k v_1^k + 2(_0+p_0)v_1^k ( v_1()k+b_1k ) + & & + 2(_0+p_0 ) + & & -4(_0+p_0)c_1ijc_1^ij + 2(_0+p_0 ) ( 2v_1^k1_,k+1 ^ 2v_1 ) + & & + 2_1()ij(c_1^ij-2c_1^ij ) + 2_1()^klv_1()k , l + 2v_1^k_1()kl,^  l + & & + 2(_0+p_0 ) ( -3_1,l+^2 e_1,l)v_1^l + & & = a\\ { q_2 + 21q_1 + q_0(2 - 1 ^ 2+v_1kv_1^k ) + f_1()kv_1^k } .    for a single fluid",
    "we find by summing over the individual fluids and using eq .",
    "( [ qconstraint ] ) & & _ 2+3 ( _ 2+p_2 ) + ( _ 0+p_0 ) ( -3_2+^2 e_2+^2v_2 ) + & & + 2 ( _ 1+p_1 ) ( -3_1+^2 e_1+^2v_1 ) + 2 ( _ 1+p_1)_,kv_1^k + 2(_0+p_0)v_1^k(v_1k+b_1k ) + & & + 2(_0+p_0)-4(_0+p_0)c_1ijc_1^ij + & & + 2(_0+p_0)(2v_1^k1_,k+1 ^ 2v_1 ) + 2_1ij(c_1^ij-2c_1^ij ) + 2_1^klv_1k , l+2v_1^k_1kl,^  l + & & + 2(_0+p_0 ) ( -3_1,l+^2 e_1,l)v_1^l = 0 .",
    "b.  a.  bassett , s.  tsujikawa and d.  wands , rev .",
    "phys .   * 78 * , 537 ( 2006 ) [ arxiv : astro - ph/0507632 ] .",
    "d.  baumann , p.  j.  steinhardt , k.  takahashi and k.  ichiki , phys .",
    "d * 76 * , 084019 ( 2007 ) [ arxiv : hep - th/0703290 ] .",
    "g.  i.  rigopoulos and e.  p.  s.  shellard , `` stochastic fluctuations in multi - field inflation , '' j.  phys .",
    "* 8 * , 145 ( 2005 ) .",
    "g.  i.  rigopoulos , e.  p.  s.  shellard and b.  j.  w.  van tent , phys .",
    "d * 72 * , 083507 ( 2005 ) [ arxiv : astro - ph/0410486 ]",
    ". g.  i.  rigopoulos , e.  p.  s.  shellard and b.  j.  w.  van tent , phys .",
    "d * 73 * , 083521 ( 2006 ) [ arxiv : astro - ph/0504508 ] .",
    "g.  i.  rigopoulos , e.  p.  s.  shellard and b.  j.  w.  van tent , phys .",
    "d * 73 * , 083522 ( 2006 ) [ arxiv : astro - ph/0506704 ] .",
    "a.  a.  starobinsky , s.  tsujikawa and j.  yokoyama , nucl .",
    "b * 610 * , 383 ( 2001 ) [ arxiv : astro - ph/0107555 ] .",
    "h.  stephani , _ relativity : an introduction to special and general relativity , _ cup , cambridge ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> we review the study of inhomogeneous perturbations about a homogeneous and isotropic background cosmology . </S>",
    "<S> we adopt a coordinate based approach , but give geometrical interpretations of metric perturbations in terms of the expansion , shear and curvature of constant - time hypersurfaces and the orthogonal timelike vector field . </S>",
    "<S> we give the gauge transformation rules for metric and matter variables at first and second order . </S>",
    "<S> we show how gauge invariant variables are constructed by identifying geometric or matter variables in physically - defined coordinate systems , and give the relations between many commonly used gauge - invariant variables . </S>",
    "<S> in particular we show how the einstein equations or energy - momentum conservation can be used to obtain simple evolution equations at linear order , and discuss extensions to non - linear order . </S>",
    "<S> we present evolution equations for systems with multiple interacting fluids and scalar fields , identifying adiabatic and entropy perturbations . as an application we consider the origin of primordial curvature and isocurvature perturbations from field perturbations during inflation in the very early universe .    </S>",
    "<S>      </S>",
    "<S> h 2c_s^2 0|u_0    and    cosmology , perturbation theory , cosmological inflation 98.80.cq </S>"
  ]
}