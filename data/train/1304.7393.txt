{
  "article_text": [
    "multiscale stochastic reaction - diffusion methods which use models with different levels of detail in different parts of the computational domain are applicable to a number of biological systems , including modelling of intracellular calcium dynamics @xcite , mapk pathway @xcite and actin dynamics @xcite . in these applications ,",
    "a detailed modelling approach ( which requires simulation of trajectories and reactive collisions of individual biomolecules ) is only needed in a small part of the computational domain .",
    "the main idea of multiscale methods is then simple to formulate @xcite : we use a detailed modelling approach in the small subdomain of interest and a coarser model in the rest of the computational domain . in this paper",
    ", detailed molecular - based ( microscopic ) models will be given in terms of brownian dynamics @xcite .",
    "the remainder of the computational domain will be divided into compartments and a mesoscopic ( compartment - based ) model will be used , i.e. we will simulate the time evolution of the numbers of molecules in the corresponding compartments @xcite .",
    "there have been a number of approaches developed for coupling different reaction - diffusion models .",
    "they include coupling of mesoscopic ( compartment - based ) models with coarser ( mean - field ) pde - based descriptions @xcite , coupling of microcopic ( molecular - based ) models with mean - field pdes @xcite , and coupling of microscopic and mesoscopic models @xcite a successful multiscale algorithm requires an accurate implementation of inter - regime transfer of molecules . in this paper",
    ", we will study convergence properties of two algorithms for coupling microscopic and mesoscopic descriptions which were previously published in the literature : the two - regime method ( trm ) @xcite and the compartment - placement method ( cpm ) @xcite .",
    "one of the conclusions of our analysis is that these algorithms do not converge in the limit of small time steps and a fixed compartment size .",
    "thus , we also propose another approach , the ghost cell method ( gcm ) which is suitable for this parameter regime .",
    "we will consider a reaction - diffusion model in the computational domain @xmath6 for both @xmath7 and @xmath8 .",
    "we will divide @xmath9 into two parts , open sets @xmath10 and @xmath11 , which satisfy @xmath12 where an overbar denotes the closure of the corresponding set .",
    "the microscopic simulation technique is used in @xmath13 each molecule , @xmath14 , in @xmath10 is considered to be a point particle at some location in space , @xmath15 , at time @xmath16 , which is updated according to discretized brownian motion , i.e. @xmath17 where @xmath18 is the diffusion constant of the @xmath14-th molecule , @xmath0 is a small prescribed time step and @xmath19 is a vector containing zero mean , unit variance normally distributed random numbers .    in this paper , we will study the convergence of multiscale methods in the limit @xmath3 .",
    "since the discretized brownian motion ( [ moleculeupdate ] ) is only used in @xmath10 , we have to specify what will be done in the remainder of the domain , @xmath11 , where the mesoscopic model is used . in this paper , we distinguish the following two cases :    \\(i ) the mesoscopic model is kept fixed in the limit @xmath3 ;    \\(ii ) the mesoscopic model is refined as @xmath0 approaches zero .",
    "the resolution of the mesoscopic model ( compartment size ) will be denoted by @xmath1 .",
    "of particular interest is the error that is caused as a direct result of the coupling and thus we will use the parameter @xmath1 as a measure of the compartment size at / on the interface between the two modelling subdomains . in the case of regular cubic compartments of volume @xmath20 ,",
    "the parameter @xmath1 is simply the length of an edge of each cube .",
    "we will also consider unstructured meshes where the compartment size @xmath1 will be suitably generalized . using @xmath1 , the cases ( i)(ii ) can be formulated as follows :    @xmath2(i ) @xmath3 and @xmath1 is fixed ;    \\(ii ) @xmath3 and @xmath4 such that @xmath5 is fixed",
    ".    both limits ( i ) and ( ii ) are important in applications .",
    "we will see that the error at the interface @xmath21 of previously developed methods @xcite converges to zero in the limit ( ii ) .",
    "this limit requires the refinement of the mesoscopic model .",
    "however , the standard mesoscopic model converges in the limit @xmath22 only if the molecules are subject to zero - order or first - order chemical reactions @xcite .",
    "it fails to converge when bimolecular reactions are present @xcite .",
    "this makes the limit ( i ) attractive in applications . in section [ gcm ]",
    ", we introduce the gcm which converges in the limit ( i ) .",
    "the paper is organized as follows . in section [ trm ] , we summarize the trm for coupling of structured mesoscopic meshes with microscopic simulations . the methodology for simulation of stochastic reaction - diffusion processes on irregular meshes and the implementation of the cpm is presented in section [ urdme ] . the gcm is introduced in section [ gcm ] . using numerical examples in section [ results ] , we compare the computational error associated with the trm with that of the gcm for structured meshes and the cpm with the gcm for unstructured meshes .",
    "we will then discuss the sources of these errors and ways in which they may be reduced .",
    "the two - regime method ( trm ) @xcite couples microscopic and mesoscopic subdomains by careful selection of the jump rate over the interface from the mesoscopic compartments and careful placement of these molecules into the microscopic domain . to date , the trm has been used with mesoscopic subdomains with regular meshes @xcite .",
    "the advantage of using this technique is that accuracy can be gained in ` regions of interest ' @xmath10 without the need to run computationally expensive microscopic simulations over the entire domain @xmath9 . in this section",
    "we will briefly cover the two different simulation paradigms and then discuss how these paradigms are combined using the trm .",
    "the defining characteristic of ` microscopic ' simulation techniques for diffusion is that each molecule in the system is simulated individually on a continuous domain .",
    "in particular , these techniques follow the trajectory of each brownian molecule to a resolution dependent on the time steps that are used .",
    "for illustrative purposes we consider here a time - driven microscopic algorithm .",
    "that is , an algorithm with a defined constant time step .",
    "furthermore , we will not be considering volume exclusion effects in this manuscript .",
    "each molecule , @xmath14 , is therefore considered to be a point particle at some location in space , @xmath15 , at time @xmath16 . the brownian diffusion of these molecules is modelled by @xmath23 .",
    "reactions may take place between these diffusing molecules at a particular time step if the reactants are within a given reaction radius of each other @xcite .",
    "molecule interactions with boundaries depend on the type of boundary : boundaries can be reflective , adsorbing or reactive ( partially adsorbing ) @xcite . considering that @xmath24 is much smaller than the local radius of curvature of the boundary ,",
    "then the boundary is locally flat on the scale of relative motion of the molecules in one time step . in the case of absorbing boundaries ,",
    "molecules are removed from the system when they are updated to a position outside of the boundary .",
    "since we simulate brownian motion using a finite time step , we have to take into account that a molecule can interact with the boundary during the time step @xmath25 $ ] even if its computed position at time @xmath26 is inside the simulation domain .",
    "the probability , @xmath27 that this molecule - boundary interaction occured within the time interval @xmath28 $ ] is dependent on the diffusion constant and the initial and final normal distances from the boundary the molecule is found ( @xmath29 and @xmath30 respectively ) @xmath31 this probability will also be important when it comes to coupling of microscopic simulations with mesoscopic simulations via an interface in the two - regime method @xcite .",
    "mesoscopic approaches to reaction - diffusion processes are simulated on a lattice . for the purposes of the trm",
    "we will describe how this is done for a regular cubic lattice .",
    "the distance between each node is @xmath1 . in a mesoscopic model",
    ", molecules can be thought to exist only at lattice nodes rather than existing in continuous space .",
    "the state of the simulation at any moment of time is defined by a set of numbers describing the copy numbers @xmath32 of molecules of the @xmath33-th type at the @xmath14-th lattice point .",
    "considering the diffusion of ( non - reacting ) molecules , the expected state of the system @xmath34 is described by the equation : @xmath35 where @xmath36 is the propensity per molecule to go from the @xmath37-th compartment to the @xmath38th compartment .",
    "it is possible to show that for a regular lattice with spacing @xmath1 , @xmath39 results in the recovery of the discretized form of the diffusion partial differential equation and can therefore be used to approximate a diffusion process on the lattice correct to order @xmath40 .",
    "the simulation of a mesoscopic reaction - diffusion process usually makes use of event - driven algorithms , such as the gillespie algorithm @xcite or the gibson - bruck algorithm @xcite .",
    "we shall conceptualize the mesoscopic simulation by considering that when a molecule is at a particular lattice point , rather than existing at the node , it is somewhere at random inside the compartment belonging to the node defined by the lattice dual mesh @xcite .",
    "that is , for a regular cubic lattice with node spacing @xmath1 , each molecule which is at a particular lattice point is thought to exist inside the cubic compartment of side length @xmath1 for which the lattice point is at the center .",
    "it is important to note that the state of the molecule has no specific location but rather is thought to exist in a probabilistic sense uniformly over its compartment .",
    "interfacing microscopic and mesoscopic simulations of reaction - diffusion processes using the trm has previously been derived for mesoscopic regimes that use regular cubic lattices @xcite .",
    "the trm is proposed by partitioning the domain @xmath9 into subdomains ( [ trmgeometry ] ) separted by the interface @xmath41 . in both subdomains , molecules behave as they would normally according to the rules of that particular regime .",
    "we describe the trm with an event - driven mesoscopic simulation in @xmath11 and a time - driven microscopic simulation with constant time step @xmath0 in @xmath10 .",
    "reactions do not cause any issue within the domain because they occur locally .",
    "we focus , therefore , on the correct manner in which molecules may migrate over the interface @xmath42 .",
    "it is assumed that the trm is simulated such that @xmath43 .",
    "a diagram of the numerical trm scheme using a regular cubic lattice can be seen in two dimensions in figure [ trmdiagram ] .",
    "a detailed trm algorithm may be found in the reference @xcite . in order that a molecular migration over the interface is smooth with optimally small error , the propensity @xmath44 per molecule to cross the interface @xmath42 from each adjacent compartment is dependent on the parameters @xmath1 and @xmath0 . for a regular cubic mesoscopic lattice , @xmath45 where @xmath46 is the diffusion constant of the migrating molecule .",
    "the trm considers that microscopic molecules in @xmath10 cease to be microscopic molecules , in principle , when they migrate over the interface .",
    "molecules are therefore absorbed by the interface @xmath42 from @xmath10 and placed in the closest compartment in @xmath11 .",
    "equation ( [ pm ] ) is used to absorb all molecules which interacted with the interface .",
    "if this is not used then molecules effectively migrate into @xmath11 and back out again without changing from a microscopic molecule to a mesoscopic one .",
    "this is crucial for coupling of the two regimes as outlined in the derivation in the reference @xcite .",
    "furthermore , molecules must be precisely placed in @xmath10 when migrating from @xmath11 .",
    "in particular , the perpendicular distance @xmath47 the molecule is placed from the interface into @xmath10 is found by sampling from the distribution @xmath48 @xmath49 where @xmath50 is the complementary error function . in higher dimensions ,",
    "the initial position of molecules migrating into @xmath10 can be chosen to be uniformly distributed tangentially to the interface in the region of the originating compartment @xcite .",
    "then the error associated with the trm is @xmath51 .",
    "we shall investigate the error associated with the trm in 1d in a later section of this manuscript and compare it with the gcm method introduced in section [ gcm ] .",
    "in this section , we will discuss how mesoscopic simulation is implemented on an irregular lattice @xcite .",
    "we will then present a brief description of the cpm @xcite .",
    "mesoscopic simulations on cartesian meshes are convenient in the sense that they are memory lenient . however , complex geometries and surfaces with high curvature , are easier to resolve accurately with an unstructured mesh .",
    "living cells can have different shapes and eukaryotes have a complicated internal structure with two - dimensional membranes and a one - dimensional cytoskeleton @xcite .",
    "the geometrical flexibility of unstructured meshes is therefore an advantage when considering simulations of realistic biological problems .",
    "consider a domain @xmath9 .",
    "the domain is covered by a primal mesh , such that the boundary @xmath52 is covered with non - overlapping triangles and the domain @xmath9 is covered with non - overlapping tetrahedra ( resp .",
    "triangles in 2d ) .",
    "a dual mesh is constructed from the primal mesh , see figure [ compartments ] , from the bisectors of the tetrahedra ( resp .",
    "triangles ) that use the nodes as vertices . the diffusion of molecules is now modelled as discrete jumps between the nodes of the dual mesh . the rate @xmath53 at which a molecules jump from voxel @xmath54 to @xmath55 is given by the diffusion constant of the molecule and the finite element discretization of the laplacian on the primal mesh . for details on how the unstructured meshes and the diffusion matrix",
    "are generated the reader is referred to @xcite .     and microscopic @xmath10 domains",
    ". jumps between compartments and from the compartments into @xmath10 are calculated using a finite element discretization of the laplacian .",
    "the copy numbers of molecules in each compartment in @xmath11 are stored whilst in @xmath10 each molecule has its own position in continuous space . _ ]      the algorithm for the cpm is presented in a similar way to the trm .",
    "the algorithm progresses asynchronously by updates in the mesoscopic simulation and microscopic simulation separately @xcite .",
    "the jump rates from compartments that are on the interface @xmath42 between regimes are calculated from the underlying mesh over the entire domain .",
    "that is , the jump rates are calculated by computing the mesoscopic jump rates between interfacial compartments and `` compartments '' that are adjacent to the interface in the microscopic domain @xmath10 ( see figure [ compartments ] ) .",
    "molecules that start in a compartment in @xmath11 and , at the end of the time step , have ended up in @xmath10 are initialized uniformly inside the `` compartment '' which they jump into , and is the process from which the cpm has been named .",
    "molecules in @xmath10 migrate back to @xmath11 via microscopic domain diffusion ( [ moleculeupdate ] ) .",
    "when a molecule appears inside one of the mesoscopic compartments from brownian motion , it is encorporated into that compartment by increasing the copy number inside this compartment .",
    "the cpm has been determined using heuristics .",
    "molecules that are in compartments obey mesoscopic rules for diffusive migration .",
    "this includes molecules that are on interfacial compartments .",
    "they jump to compartments in @xmath10 as though they were still in @xmath11 .",
    "when this occurs , initialization of the molecules must take place .",
    "the molecules are initiated uniformly over the compartment in which they are placed .",
    "molecules are not placed at the node at the center of this compartment because this would unphysically concentrate molecules at this point and reactions would occur between possible reactants apon migration over the interface .",
    "conversely , molecules that are in @xmath10 obey microscopic rules for diffusive migration ( brownian trajectory ) .",
    "when this brownian trajectory leads to a compartment , it can no longer be described using the microscopic description and is added to the compartment in which it lands . as we shall see , this heuristic approach can lead to inaccuracies .",
    "the inaccuracies can be minimized if @xmath56 ( that is , if the size of the compartment is approximately the size of a microscopic molecular jump ) .",
    "here we will consider a new method for interfacing mesoscopic and microscopic simulations .",
    "this method uses different assumptions to the trm and cpm and is therefore implemented differently .",
    "we call this method the ghost cell method ( gcm ) since microscopic molecules in @xmath10 feel the presence of a pseudo - compartment allowing for instantaneous jumping from @xmath10 to @xmath11 in the same way that molecules within compartments jump instantaneously",
    ". the steps of the gcm are given in table [ alg : complete ] .",
    "1 .   initialize lattice over whole domain @xmath9 and construct dual mesh ( compartments ) .",
    "generate interface @xmath42 on the edges of compartments to separate @xmath10 from @xmath11 .",
    "choose @xmath0 and set time @xmath57 .",
    "determine @xmath36 using finite element method between all compartments @xcite .",
    "2 .   initialize the initial state of the system by placing molecules in compartments in @xmath11 and placing molecules in continuous space in @xmath10 . count and",
    "store numbers of molecules in ghost cells , those compartments in @xmath10 which are adjacent to the interface @xmath42 .",
    "3 .   determine the time @xmath58 for the next event ( reaction or diffusive ) in @xmath11 or diffusive jumps to and from ghost cells and @xmath11 .",
    "4 .   if @xmath59 then change the state of the system to reflect the next event corresponding to @xmath58 and update time @xmath60 . if this event is a diffusive jump from ghost cell to @xmath11 choose a molecule at random within the relavant ghost cell to migrate .",
    "if this event is a diffusive jump from @xmath11 to a ghost cell then initialize this molecule with uniform probability over the ghost cell .",
    "5 .   if @xmath61 then update the positions of all molecules in @xmath10 using ( [ moleculeupdate ] ) .",
    "check for reactions in @xmath10 @xcite .",
    "all molecules incident on the interface @xmath42 are reflected .",
    "update time @xmath62 6 .",
    "repeat steps [ g.3][g.5 ] until the desired end of the simulation .",
    "the key assumption that is used in the trm and cpm is that molecules in @xmath10 migrate via diffusion ( [ moleculeupdate ] ) over the interface @xmath42 whereby they become parts of the corresponding compartment . in the gcm",
    ", this assumption is relaxed .",
    "instead , molecules migrate over the interface using the compartment - based approach in both directions .",
    "microscopic molecules in @xmath10 near the interface feel the presence of a layer of `` ghost '' cells ( compartments ) . in the step [ g.2 ] in table [ alg : complete ] , we calculate the numbers of molecules in these `` ghost '' cells .",
    "they are used in the step [ g.4 ] to create a fully compartment - based simulation of transition across the interface @xmath42 .    to justify the gcm ,",
    "let us consider a simulation of diffusion in a domain @xmath9 for which a mesoscopic method was implemented .",
    "then consider the same domain where a microscopic simulation is implemented .",
    "let the molecules of the microscopic simulation be `` binned '' according to compartments of the mesoscopic simulation .",
    "the expected number of molecules binned into each compartment should match that of the mesoscopic simulation to within the precision of the mesoscopic method .",
    "this is because both simulations are accurate representations of the same phenomena , diffusion .",
    "this is the philosophy behind the gcm .",
    "molecules which are binned into ghost compartments near the interface may jump into compartments in @xmath11 via the rates prescribed by the mesoscopic algorithm . if both regimes are correct individually then the flux over the interface @xmath42 is the same as though a mesoscopic algorithm was used over the whole domain . to ensure that microscopic molecules do not migrate to @xmath11 via diffusion ( [ moleculeupdate ] ) ,",
    "they are reflected at the interface @xmath42 in the step [ g.5 ] .",
    "figure [ regimediagram ] demonstrates the principle differences between a trm / cpm and a gcm description of the interface . in [ gcmproof ] we provide a mathematical analysis of the gcm in one dimension to demonstrate that the expected concentration and flux of molecules over the interface are matched . the theoretical error associated with the gcm scales as @xmath63 which is on the same order as that of the trm . unlike the trm",
    ", this error , as we will see in the later part of this manuscript , is reduced to zero by reducing @xmath5 .",
    "the ghost cell method is implemented using the algorithm in table [ alg : complete ] .",
    "this algorithm is given for an event - driven mesoscopic simulation and a time - driven microscopic simulation , however it can also be extended to event - driven microscopic simulations .",
    "in this section , we present numerical examples comparing the trm , cpm and gcm .",
    "first , we demonstrate how the error associated with the interface @xmath42 is dependent on choices of mesh spacing @xmath1 in the mesoscopic subdomain at the interface and the time step chosen for the microscopic subdomain @xmath0 for both the trm and the gcm using one dimensional simulations .",
    "we use a simple diffusion test problem to compare the diffusive flow over the interface with an exact solution which can be analytically obtained .",
    "we use the domain @xmath64 and subdomains @xmath65 @xmath66 , which are separated by the interface @xmath67 .",
    "we initially position @xmath68 molecules according to the distribution @xmath69 , @xmath70 .",
    "we construct regular spaced compartments of width @xmath71 within @xmath11 and `` bin '' the molecules generated in @xmath11 into these compartments .",
    "we allow these molecules to diffuse throughout the domain @xmath9 with a diffusion constant @xmath72 using the trm or gcm until time @xmath73 . at the boundary @xmath74 molecules",
    "are absorbed and placed at @xmath75 . at the boundary @xmath75 molecules are reflected . in this way",
    ", @xmath76 is the steady state distribution of this system and @xmath77 is the steady state number of molecules in @xmath78 we define a measure of the error @xmath79 to this test problem for each simulation scheme @xmath80 where @xmath81 is the copy number of molecules in the @xmath14-th compartment evaluated at @xmath73 and the sum is taken over all compartments in @xmath11 .    in order to see the effect of the compartment spacing near the interface @xmath1 on the error @xmath79 for both the trm and gcm we start with the set of regular compartments @xmath82 which have nodes ( centres of compartments ) at @xmath83 , @xmath84 ,  , @xmath85 .",
    "then we use the following lattice refinement technique designed specifically so that the position of the interface does not change ( see figure [ refinement ] ) :    1 .   delete the two nodes closest to the interface .",
    "2 .   introduce into the space between the new node closest to the interface and the interface ( a distance of @xmath86 ) three nodes placed consecutively a distance of @xmath87 from the node to its left .",
    "3 .   recompute the compartments by finding the bisectors of each node .",
    "the specific distances in the step [ r.2 ] are chosen such that the interface does not change location and the last two compartments have the same size .",
    "this is also the size that is given to the ghost cell in the gcm .",
    "the refinement algorithm [ r.1][r.3 ] is repeated @xmath88 times such that the size of the final compartment in @xmath11 ( and ghost cell ) , @xmath89 , is @xmath90 a diagram representing one iteration of the refinement technique [ r.1][r.3 ] is shown in figure [ refinement ] .",
    "[r.3 ] . ]",
    "the error is computed for various final compartment sizes @xmath89 ( @xmath91 ) and various time steps @xmath92 ( @xmath93 ) where @xmath94 and @xmath95 .",
    "defined by @xmath96 as a function of compartment size at the interface @xmath89 and time step @xmath0 for the one dimensional test problem using the trm .",
    "_ ]    figures [ trmsurface ] and [ gcmsurface ] show how the absolute error @xmath97 given by ( [ error ] ) depends on both parameters @xmath89 ( compartment size on the interface ) and @xmath0 for the trm and gcm algorithms respectively .",
    "the error due to the interface in the trm includes a shift of @xmath98 in the expected distribution of molecules at the interface into @xmath11 @xcite .",
    "this is because of the `` initialization '' of molecules from @xmath10 into @xmath11 . unlike the initialization of molecules from @xmath11 into @xmath10 , molecules that are transported in the reverse direction",
    "can not be placed carefully according to a continuous distribution but must necessarily be placed in the nearest compartment .",
    "this initialization has an expected position of @xmath98 away from the boundary causing a shift of @xmath98 in the distribution of molecules .",
    "however , if molecules could be initialized into @xmath11 with a continuous distribution , for symmetry reasons one would expect this to be done with a distribution of @xmath48 given by ( [ distribution ] ) .",
    "the average distance , therefore , that a molecule would ideally be placed into @xmath11 is @xmath99 .",
    "therefore , the error that is due to unphysical shifting of molecules is proportional to the expected shift of molecules as they are transferred from @xmath10 to @xmath11 .",
    "that is @xmath100 .    in figure [ trmsurface ]",
    "a dotted red line showing @xmath101 approximately follows the path of the minimum absolute error .",
    "the discrepancy between the actual minimum absolute error and the dotted red line in figure [ trmsurface ] can be attributed to higher order error that is inherent in the mesoscopic approximation to the diffusion equation . to show that @xmath100 , figure [ plotdatatrm ] is a plot of error @xmath79 versus @xmath102 .",
    "the plot is generated by using various values of @xmath89 ( see legend ) and then plotting a number of points while changing @xmath0 . whilst it is clear that the graph is approximately linear , the higher order mesoscopic error",
    "is clearly seen in the form of a vertical displacement of this curve about the origin .",
    "the effect that the higher order mesoscopic error has on the interface is difficult to quantify because it will depend on the particular molecular system .",
    "therefore , the best choice of parameters that can be chosen for the trm is @xmath103 .    in figure",
    "[ gcmsurface ] , we see that the error of the gcm depends on @xmath0 and specifically on its relative size compared to @xmath1 ( the analysis of the gcm is provided in [ gcmproof ] ) . rapidly increasing error ( quickly saturating the color bar in figure [ gcmsurface ] ) is observed when @xmath104 .",
    "the higher order mesoscopic error artefact can also be seen in figure [ gcmsurface ] since this artefact is independent of the coupling mechanism ( see the larger absolute error for large values of @xmath1 ) .",
    "the gcm is therefore most accurate for very small values of @xmath0 .",
    "whilst in practice making @xmath0 small may significantly increase the computing time , small @xmath0 is often required for accurate microscopic simulation ( for example , capturing reactions with high resolution ) and in such cases the gcm is more appropriate than the trm .",
    "defined by @xmath96 as a function of compartment size at the interface @xmath89 and time step @xmath0 for the one dimensional test problem using the gcm .",
    "_ ]     versus @xmath102 for the trm .",
    "the different color points represent different values of the compartment size at the interface @xmath1 ( see legend ) and in each instance @xmath0 is varied from @xmath105 to @xmath106 .",
    "_ ]      in this section we will demonstrate how , when using an unstructured mesh , the error associated with the gcm coupling converges as @xmath107 whereas error associated with the cpm is minimized when @xmath108 where @xmath1 is the average size of boundary compartments .",
    "both the error associated with the cpm and gcm are due to imbalances in the flux of molecules over the interface .",
    "we implement the cpm and gcm in three spatial dimensions using a tetrahedral primal mesh as described in section [ urdme ] .",
    "the implementation builds on the freely available software urdme @xcite .",
    "we consider a cube with side length @xmath109 .",
    "the cube is first discretized with an unstructured mesh and then divided into a mesoscopic region @xmath110 , and a microscopic region @xmath111 , where @xmath111 is the set of all voxels with a vertex @xmath112 such that @xmath113 and @xmath114 . here",
    "@xmath9 is the set of all voxels .",
    "the partitioning is illustrated in figure [ fig : partitioned_cube ] for two different mesh sizes .",
    "6.11 cm -8 mm 6.11 cm -8 mm    we start each simulation with @xmath115 molecules whose initial positions are sampled from a uniform distribution .",
    "the diffusion constant of the molecules is @xmath72 , and we simulate the system for time t=@xmath116 . since we start with a uniform distribution and the molecules only diffuse and do not react , we expect the distribution to be uniform at the final time . as the interface is parallel with the @xmath117-plane , we expect that the distributions of molecules in the @xmath118- and @xmath119-directions are uniform , but that we get a small error in the distribution of molecules in the @xmath47-direction .",
    "we now divide the @xmath47-axis into @xmath120 bins of equal length , and then count the number of molecules in each bin at the final time .",
    "mesoscopic molecules are binned by first sampling a continuous position from a uniform distribution on the voxel .",
    "we expect @xmath121 molecules in each bin , and can therefore estimate the error @xmath79 by @xmath122 in figure [ fig : results_3d ] we have computed @xmath97 for different mesh sizes and time steps . as expected , the error decreases as we refine the mesh and decrease the time step .     of the gcm method for different mesh sizes and time steps .",
    "the error decreases with decreasing time step , as expected . _ ]    in the cpm method , mesoscopic ( resp .",
    "microscopic ) molecules stay mesoscopic ( resp .",
    "microscopic ) during a time step .",
    "this implies that the time step should be chosen sufficiently small such that a molecule does not diffuse across several voxels . on the other hand ,",
    "if the time step is too small the distribution of molecules in space will be biased towards the microscopic region .",
    "this can be seen by considering a microscopic molecule diffusing into the mesoscopic regime .",
    "if the time step is small , it is likely that it will be close to the microscopic regime at the end of the time step , but if it ends up on the mesoscopic side it will nevertheless be considered uniformly distributed in the voxel at the end of the time step .",
    "thus , the time step should not be chosen too small relative to the size of the voxels , or the error due to the spatial splitting will become large .    since the gcm converges with decreasing time step , but performs worse for larger time steps , one could suspect that there is a regime where the cpm in @xcite performs better than the gcm . at some point , however , the error of the gcm will become small and outperform the cpm in @xcite .",
    "the errors of the different methods are compared in figure [ fig : comparison ] for a mesh with @xmath123 voxels .",
    "indeed , we see that the cpm method performs better for time steps down to almost @xmath124 , at which point the error of the gcm method becomes smaller .     produced by the gcm and cpm for interfacing microscopic and mesoscopic simulations as a function of the time step in the microscopic simulation domain @xmath0 .",
    "the length scale @xmath1 is defined to be the cubic root of the average volume of a voxel . _ ]",
    "in this paper we have compared two existing mesoscopic - microscopic coupling techniques for stochastic simulations of reaction - diffusion processes with a new convergent method called the ghost cell method ( gcm ) . here",
    "we will summarize the specific sources of error of the trm , cpm and gcm , when they converge , how they may be optimized for accuracy and notes on their computational efficiency .",
    "the trm couples molecules by considering that mesoscopic compartments contain molecules that are evenly distributed in a probabilistic sense . as these molecules diffuse over the interface they are placed according to the distribution @xmath48 given by ( [ distribution ] ) .",
    "molecules migrating in reverse from the microscopic regime to the mesoscopic regime must be absorbed by the interfacial compartments and be indistinguishable from other molecules in these compartments by virtue of this paradigm . as such , instead of migrating an average distance over the interface proportional to @xmath63 it becomes evenly distributed over the compartment with an expected location of @xmath125 over the interface .",
    "the molecules are therefore effectively shifted @xmath126 into the compartment regime .",
    "this shift in the molecules therefore creates a discontinuity of in the distribution to find molecules on the interface and therefore an error due to the presence of the coupling proportional to @xmath127 .",
    "the nature of this error is that , if the expected net flux of molecules over the interface is 0 , then no error due to the presence of the interface will be experienced .",
    "this is important to note , since , this is not the case for both the cpm and gcm methods .",
    "furthermore , since the error is proportional to @xmath127 it clearly converges in the limiting case ( ii ) described in the introduction but not in the limiting case ( i ) .    whilst the trm can give controllably accurate results",
    ", it can be computationally more costly to implement .",
    "this is because perfect absorption of molecules is required on the boundary and this means that each molecule in the molecular - based domain needs to be checked for interaction with the boundary in a given time step using ( [ pm ] ) .",
    "the cpm is a coupling mechanism that , whilst heuristically derived , can produce accurate results under some circumstances and do so with minimum computational cost .",
    "molecules are placed within a pseudo - compartment in the molecular - based domain via diffusion from the compartment - based domain . in reverse molecules",
    "are placed in compartments from the molecular - based domain via diffusion of these molecules in the continuous domain over the interface .",
    "the antisymmetry that is seen in the methods of migration , mesoscopic to microscopic and microscopic to mesoscopic , result in a boundary layer in the expected distribution of molecules at the interface .",
    "this boundary layer is caused by the fact that molecules diffusing from the molecular region to the compartmental region are considered uniformly distributed on the compartment at the end of the time step .",
    "if @xmath0 is small compared to @xmath1 , this will be a poor approximation .",
    "it should thus be noted that the error of the cpm does not converge in the limiting case ( i ) described in the introduction , however the error appears to converge according to limiting case ( ii ) .",
    "the cpm is computationally efficient .",
    "its only inefficiency is that , unlike the trm , it requires the knowledge of a pseudo - compartment in the microscopic domain .",
    "the trm is therefore more appropriate than the cpm for coupling completely independent simulation algorithms , since the cpm requires its own custom algorithm to be implemented fully .      the gcm couples molecules according to a discrete domain on each side of the interface . molecules that are in the microscopic domain",
    "are binned according to a ghost compartment / cell and jump into the mesoscopic domain using jump rates derived using the mesoscopic approach .",
    "in such a way , symmetry is conserved in the method of migration from mesoscopic to microscopic and from microscopic to mesoscopic , unlike the cpm .",
    "it is important that the molecules are binned correctly for this coupling to work accurately .",
    "the error , therefore , can be attributed to molecules that are in the ghost cell when they should not be , or not in the ghost cell when they should be .",
    "therefore , if the compartment size @xmath1 at the interface ( and of the ghost cell ) is much larger than the resolution of the particle tracking in the microscopic domain , the correct number of molecules will be in the ghost cell .",
    "the error therefore converges in the limit of small @xmath0 so long as @xmath1 is sufficiently coarse .",
    "furthermore , it is possible to show that , unlike the trm , this source of error is not due to a displacement of molecules but an unballanced flux of molecules ( see [ gcmproof ] ) and will therefore appear even if the expected net flux over the interface is 0 .",
    "the gcm , however , is convergent in the limiting case ( i ) but not ( ii ) from the introduction giving the gcm a unique advantage over both the cpm and trm .",
    "the gcm is computationally efficient for small @xmath0 since the jump rates from the microscopic domain to the mesoscopic domain are determined by the ghost cell size and not the time step ( like the trm for example ) .    * acknowledgements : * -0.07 mm the research leading to these results has received funding from the research council under the _",
    "european community _ s seventh framework programme ( _ fp7/2007 - 2013_)/ erc _ grant agreement _ no . 239870 .",
    "this publication was based on work supported in part by award no kuk - c1 - 013 - 04 , made by king abdullah university of science and technology ( kaust ) .",
    "stefan hellander has been supported by the national institute of health under award no .",
    "1r01eb014877 - 01 and the swedish research council .",
    "radek erban would also like to thank brasenose college , university of oxford , for a nicholas kurti junior fellowship ; the royal society for a university research fellowship ; and the leverhulme trust for a philip leverhulme prize .",
    "here we present an analysis of the gcm in one - dimension .",
    "we show that error of the gcm that is produced on the interface between mesoscopic and microscopic subdomains converges in the case ( i ) .",
    "specifically , we see convergence of the interface - derived error as @xmath128 . this property of convergence is unique to the gcm when compared with other reported coupling mechanisms . in showing that the interface - derived error vanishes in the small time step limit",
    ", we will show that rapid variation within the boundary layer of the interface vanishes as @xmath129 , leaving behind a linear approximation of the true distribution of molecules . since the error at the interface will be of order @xmath40",
    "it is accurate to the same order as the mesoscopic algorithm itself .    without loss of generality ,",
    "consider an interface at @xmath74 on an infinite one - dimensional domain .",
    "to the left of this interface ( @xmath130 ) a compartment - based model is used with fixed compartment size @xmath1 . to the right of the interface ( @xmath131 ) a molecular - based algorithm is used and is updated at fixed time increments of @xmath132 , i.e. @xmath133 and @xmath134 .",
    "we denote the compartments in @xmath11 by @xmath135 , where @xmath136 then the interface compartment is @xmath137",
    ". the ghost cell will be denoted by @xmath138 .",
    "molecules in @xmath11 are described only by their compartment .",
    "their compartment changes with an exponentially distributed random time with a rate that is given by @xmath139 .",
    "this rate is conditional on initial and final states being compartments .",
    "the rate given by @xmath139 is chosen in such a way that the expected number of molecules in each compartment matches that of a discretized diffusion equation ( see ( [ equationformean ] ) and ( [ equationforq ] ) ) .",
    "these rates , however , breakdown in the case of the trm because the initial and final states of jump across the interface are not compartments but rather the final state is a molecule in @xmath10 .",
    "the jump across the boundary for the trm is given by ( [ gamma ] ) .",
    "molecules in @xmath10 have one thing in common with those in compartments .",
    "a domain that is modeled microscopically and then binned into compartments shows the same expected behaviour as a domain modeled with compartments to leading and first order accuracy in @xmath1 in the limit as @xmath140 .",
    "therefore , in an attempt to interface the two regimes together it may be appropriate to bin molecules in @xmath10 into a ghost cell / compartment @xmath141 near the interface .",
    "the molecules that are in @xmath141 will then have the same properties as a compartment from the perspective of the interface compartment @xmath142 .",
    "to this end , any molecule in @xmath141 may spontaneously change state from the molecular domain to @xmath142 .",
    "we expect that since the interface compartment - bound molecules see a compartment state for molecules in @xmath141 , the change of state from @xmath142 to a random position within @xmath141 will occur with a normal inter - compartmental rate . in the following analysis",
    "we show that this is the case .",
    "we shall test the hypothesis by matching the master equations for @xmath142 and the probability distribution in @xmath10 in such a way that no rapid variation in probability to find molecules , @xmath143 , is apparent at the interface .",
    "we shall assume that the rate for molecules to jump into @xmath10 from @xmath142 is @xmath144 and are placed in an initial position from the interface given by the probability distribution @xmath48 .",
    "molecules in @xmath10 spontaneously jump into @xmath142 with a rate @xmath145 .",
    "functions @xmath48 and @xmath146 are normalized such that they have a unit integral over @xmath10",
    ". we shall show that @xmath147 we will find it convenient for the sake of notation to introduce the parameters @xmath148 to show ( [ gcmresult ] ) we focus on the purely diffusive problem , since bulk reactions have no effect on boundary conditions . in order to limit the flux of molecules jumping into @xmath142 , all molecules in @xmath10 that hit the interface by brownian motion are reflected back to @xmath10 .",
    "we denote the probability of finding a molecule in compartment @xmath149 , @xmath150 by @xmath151 ( so that @xmath152 approximates the probability density function at the node within this compartment ) .",
    "if we denote by @xmath153 the probability density function of the discrete - time molecular - based algorithm , then the transmission / reflection rules give us the following master equation @xmath154\\ , \\mbox{d}y     \\nonumber   \\\\ & & \\mbox { } + \\frac{\\alpha^+d{\\delta t}p_{1}(t)f(x)}{h }    - \\frac{\\alpha^-d{\\delta t}p(x , t)g(x)}{h } .\\end{aligned}\\ ] ] in the vicinity of @xmath74 there is a boundary layer of width @xmath51 so long as @xmath48 and @xmath146 vanish for @xmath155 @xcite .",
    "we rescale ( [ master1 ] ) and ( [ master2 ] ) using the ( dimensionless ) boundary layer coordinate @xmath156 .",
    "we also denote @xmath157 , @xmath158 and @xmath159 .",
    "the rescalings of @xmath160 and @xmath161 by @xmath1 are done to keep the integrals of these functions equal to 1 .",
    "thus , in the boundary layer coordinates , ( [ master1 ] ) and ( [ master2 ] ) become @xmath162\\ , \\mbox{d}\\eta   \\nonumber    \\\\ & & \\mbox { } + \\alpha^+\\lambda^2 p_{1}(t)\\ , f_{\\mathrm{inner}}(\\xi )   - \\alpha^-\\lambda^2 p_{\\mathrm{inner}}(\\xi , t)\\ , g_{\\mathrm{inner}}(\\xi),\\end{aligned}\\ ] ] where @xmath163 .",
    "the parameter @xmath164 gives us the relative size of @xmath165 to @xmath40 and we wish to show that as @xmath166 the distribution of molecules across the boundary is smooth and the error that remains is of the order of @xmath40 , which is the same size of the error associated with the mesoscopic discretization in @xmath11 . in order to join these models",
    "smoothly we require in @xmath11 that @xmath167 while , for the molecular - based side , we want variation from the linear approximation in the boundary layer to be limited to @xmath168 up to order @xmath40 accuracy , so that @xmath169 the prescription of a consistent probability density @xmath170 and derivative @xmath171 for both sides of the interface , along with linear approximations sufficiently close to the interface equates to continuity and differentiability over the interface which is the matching condition that we are attempting to achieve .    substituting ( [ condition2])([expansion ] ) into ( [ master3 ] ) and ( [ master4 ] ) and equating terms of the same order in @xmath1 and leading order in @xmath164 gives the following conditions that must be placed on @xmath146 , @xmath48 , @xmath172 and @xmath173 :      \\(i ) @xmath174 terms from equation ( [ master3 ] ) give condition : @xmath175 condition ( [ condition1a ] ) states how the relative rates for molecules to transition to and from @xmath10 and @xmath11 must be dependent on the relative sizes of @xmath142 and @xmath141 .",
    "\\(ii ) @xmath176 terms from equation ( [ master3 ] ) give condition : @xmath177 condition ( [ condition2a ] ) states how the rates for molecules to transition to and from @xmath10 and @xmath11 depend on the average distance molecules are placed from the interface when placed within @xmath141 .",
    "this is the same condition given in @xmath11 for jumps between the compartments .",
    "\\(iii ) @xmath174 terms from equation ( [ master4 ] ) give condition : @xmath178 condition ( [ condition3a ] ) states that molecules must be placed into @xmath10 with the same probability weighting that they are taken out and placed back into @xmath11 .",
    "the gcm that is presented in this manuscript uses parameters ( [ gcmresult ] ) which satisfy the three conditions ( [ condition1a])([condition3a ] ) listed above .",
    "such a scheme , therefore , has an error that is no greater than the error of the mesoscopic scheme in the limit @xmath129 , in other words , in the limit @xmath140 whilst @xmath1 remains constant .",
    "m.  flegg , j.  chapman , l.  zheng , and r.  erban .",
    "analysis of the two - regime method on square meshes .",
    "submitted to _",
    "siam journal on scientific computing _ , 23 pages , available as http://arxiv.org/abs/1304.5487 2013 .",
    "b.  franz , m.  flegg , j.  chapman , and r.  erban .",
    "multiscale reaction - diffusion algorithms : pde - assisted brownian dynamics .",
    "available as http://arxiv.org/abs/1206.5860 , to appear in siam journal on applied mathematics , 2013 ."
  ],
  "abstract_text": [
    "<S> in this paper , three multiscale methods for coupling of mesoscopic ( compartment - based ) and microscopic ( molecular - based ) stochastic reaction - diffusion simulations are investigated . </S>",
    "<S> two of the three methods that will be discussed in detail have been previously reported in the literature ; the two - regime method ( trm ) and the compartment - placement method ( cpm ) . </S>",
    "<S> the third method that is introduced and analysed in this paper is the ghost cell method ( gcm ) . </S>",
    "<S> presented is a comparison of sources of error . </S>",
    "<S> the convergent properties of this error are studied as the time step @xmath0 ( for updating the molecular - based part of the model ) approaches zero . </S>",
    "<S> it is found that the error behaviour depends on another fundamental computational parameter @xmath1 , the compartment size in the mesoscopic part of the model . </S>",
    "<S> two important limiting cases , which appear in applications , are considered :    @xmath2(i ) @xmath3 and @xmath1 is fixed ;    \\(ii ) @xmath3 and @xmath4 such that @xmath5 is fixed . + the error for previously developed approaches ( the trm and cpm ) converges to zero only in the limiting case ( ii ) , but not in case ( i ) . </S>",
    "<S> it is shown that the error of the gcm converges in the limiting case ( i ) . </S>",
    "<S> thus the gcm is superior to previous coupling techniques if the mesoscopic description is much coarser than the microscopic part of the model .    </S>",
    "<S> multiscale simulation , reaction - diffusion , particle - based model . </S>"
  ]
}