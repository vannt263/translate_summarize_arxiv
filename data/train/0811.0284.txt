{
  "article_text": [
    "the preparation and accurate characterization of non - gaussian states is of paramount importance for quantum processing applications . for example",
    "the implementation of scalable continuous variable quantum information protocols require an entanglement distillation procedure , which has been proven to be impossible using only a set of gaussian states and gaussian operations  @xcite .",
    "the most fundamental _ non - gaussian _ states are fock states .",
    "recent experiments have demonstrated for the first time the generation of fock states and photon added / substracted states  @xcite . in all of these experiments conventional homodyne detection  @xcite followed by tomographic reconstruction was employed to prove the presence of the non - gaussian characteristics , as well as the presence of negative values , in the wigner functions of the quantum states  @xcite .",
    "these negative values are considered to be a signature of quantum behaviour . in a homodyne measurement ,",
    "the detected signal consists of a beating between the quantum signal and a strong local oscillator field , which in turn has the effect that mode mismatch can not be distinguished from losses .",
    "another drawback in this method is the fact that homodyne tomography is always an indirect state characterization : the wigner function can be reconstructed only after intricate computational back - projection , and the photon statistics have to be recovered by more involved means  @xcite",
    ". a more direct characterization of the wigner function is possible if a photon number resolving detector is available .",
    "the wigner function at a given position @xmath0 of phase space ( @xmath1 ) is equal to the average value of the photon number parity operator on a quantum state displaced by @xmath2  @xcite .",
    "the expectation value of the parity operator is directly inferred from a complete measurement of the photon number distribution  @xcite . as opposed to tomography , in this method the wigner function",
    "is probed point  by  point in phase space , resulting in a high resolution measurement . until now",
    ", the requirement of measurements with photon number resolution has severely limited the usage of this method , although different ideas to overcome the problem have arisen for specific systems  @xcite .",
    "recently , new strategies for measuring light with photon number resolution have been developed , which allow a more intensive exploration and characterization of quantum states  @xcite .",
    "one of them ",
    "applicable for pulsed light  is a time multiplexed detector ( tmd ) . with the tmd",
    ", the photon number distribution of a quantum state can be revealed via an inversion procedure applied to the measured photon statistics .",
    "experimental applications , demonstrating a reliable loss calibration , and the tmd s suitability for detecting multimode statistics have been accomplished  @xcite . in this paper",
    ", we apply for the first time to our knowledge the probing method in connection with a tmd to reconstruct the wigner functions of single - photon and two - photon fock states , showing the capability of loss - tolerant _ state _ characterization .",
    "this is achieved by decoupling the effects of experimental imperfections from the ideal mathematical operations .",
    "we find an equivalent model for the experimental setup , in which losses are independent from the displacement operation .",
    "in addition , mode mismatch is modeled by a convolution of a poissonian distribution with the statistics of an ideally displaced fock state . via monte carlo simulations we evaluate the specific experimental conditions necessary to characterize reliably non - gaussian fock states . using a reasonable number of data points ( @xmath3 )",
    "we show the extent of degradation caused by losses and mode mismatch .",
    "a simple inspection of the characteristic photon number oscillation of displaced fock states enables us to quantify the degree of overlap .",
    "this paper is organised as follows . in sec .",
    "[ bssec ] we briefly introduce the method for probing the wigner function using displacement operations and photon counting .",
    "experimental issues related to the implementation of the ideal displacement operation are discussed in sec .",
    "[ displacementsec ] . in sec .",
    "[ tmdsec ] we recall important properties of a tmd and explain how to handle the effect of losses via an inversion algorithm . in sec .",
    "[ modeoverlapsec ] we introduce a model to study the effect of imperfect mode overlap , which is used in sec .",
    "[ diagnosis ] in order to relate the degree of overlap to usual experimental observables . in the following section ( sec .  [ highlosses ] ) , we exploit this theoretical framework and employ monte carlo simulations to analyse the reliability of the probing technique under the usual circumstances of high losses and imperfect mode overlap .",
    "we show how the wigner function characterictics can be efficiently recovered from the response of the tmd . finally , in sec .",
    "[ conclusions ] we conclude and highlight the main findings of our investigations .",
    "the probing method is based on a simple expression that relates the wigner function at the origin of the phase space with the mean value of the photon number parity operator @xmath4  @xcite , @xmath5 as the fock states @xmath6 are eigenstates of the photon number parity operator , with eigenvalues @xmath7 , a natural representation for the density matrix is @xmath8 . with this representation eq .",
    "( [ w_origo ] ) simplifies to @xmath9 since @xmath10 is equal to the probability of counting @xmath11 photons , the wigner function can be directly measured from the photon statistics .    due to the fact that the projection onto the photon number basis always erases the information about the coherence of the state ,",
    "the parity measurement returns the value of the wigner function only at one single point of phase space .",
    "nevertheless , the whole wigner function can be reconstructed if appropriate displacements are applied to the state .",
    "to access its value at a given position @xmath0 in phase space we need to displace the state by the quantity @xmath2 .",
    "mathematically , this is described by the action of the displacement operator @xmath12 .",
    "the evolution of the density operator is given by @xmath13 , which results in @xmath14 similarly to the expression in eq .",
    "( [ w_0 ] ) , the value of the wigner function in eq .",
    "( [ w_pn ] ) is determined directly by the photon statistics of the displaced state .    in general terms",
    ", the reconstruction of a quasi - probability distribution function of a degraded quantum state via the direct probing technique has been analysed in the past  @xcite . here , we extend the previous work by showing , how to deal with the experimental imperfections in practical terms in order to achieve a loss - tolerant state characterization . to increase the amount of information , which can be extracted from our simulations we establish a strong connection between the theory and the actual experimental parameters that constrain the reconstruction of the wigner function .",
    "in the course of this work we evaluate the impact of imperfections in this characterization method , i.e.  losses and mode mismatch between fields .",
    "in addition , an important degrading effect comes from the implementation of the displacement , which nevertheless can be handled with a loss inversion strategy similar to the inefficient detection .",
    "in an experiment the displacement operation can be well approximated by the effect of a highly asymmetric beam splitter with transmission @xmath15 , which is used to superimpose the quantum signal of interest with a coherent reference field @xmath16  @xcite .",
    "the beam splitter is a linear optical element that connects two input modes @xmath17 and @xmath18 , delivering output modes @xmath19 and @xmath20 , as shown in fig .  [ displacement](i ) .    in the heisenberg picture , the output annihilation operators are related to input operators by the transformations @xmath21 with @xmath22 and @xmath23 being equal to the transmission and reflection intensity coefficients . from the experimental point of view , the beam splitter will always introduce some amount of loss , since @xmath24 . to decouple the displacement from the loss we analyse the configuration shown in fig .",
    "[ displacement](ii ) .",
    "it is straightforward to derive the conditions under which the networks ( i ) and ( ii ) are equivalent , if we follow an approach introduced by wallentowitz and vogel  @xcite .",
    "firstly , using the beam splitter transformation in eq .",
    "( [ beamsplitter ] ) , the output annihilation operators of each model are related to the input modes by , @xmath25 in which we employed the relationship @xmath26 .",
    "second , we note that in a photon - counting experiment the probability of recording @xmath11 photons is given by  @xcite @xmath27 with the symbol @xmath28 defining a normal ordering of the operators . the average in eq .",
    "( [ p_n ] ) is taken over the initial quantum state @xmath29 and @xmath30 is the number operator of the detection mode .    as mode @xmath18",
    "is prepared in a coherent state in both models , and @xmath31 is evaluated by the average of normally ordered operators , the operator @xmath32 can be replaced by a complex number @xmath33 , with @xmath34 .",
    "thus , the annihilation operators from models ( i ) and ( ii ) introduced by the number operator in eq .",
    "( [ p_n ] ) can be substituted by @xmath35 we are only interested in the photon number probability @xmath31 and therefore define effective photon number operators @xmath36 and @xmath37 , which are independent of losses but represent effective displacements .",
    "the number operators for networks ( i ) and ( ii ) can then be substituted by @xmath38 examining the last two equations we reason that both schemes manifest equal photon number probabilities if @xmath39 .",
    "we would like to emphasise that the loss element in eq .",
    "( [ nii ] ) modelled by the beam splitter with transmission coefficient @xmath22 , increases the net amount of displacement , i.e. the _ total _ amount of displacement is @xmath40 .",
    "in addition to the displacement , the resulting probability is given by an attenuated signal with an the overall quantum efficiency of @xmath41 .",
    "as a conclusion we find that even when the beam splitter transmission is far from the idealized case , the device still works as a displacing element and introduces simply some amount of extra loss that can be inverted as will be described in sec .",
    "[ tmdsec ] .    to simulate the possible statistics resulting from an actual measurement",
    ", we can use network ( ii ) to calculate the photon number distributions of displaced fock states @xmath42 . in the absence of loss , these photon number distributions are well known and given by @xmath43  @xcite .",
    "the effect of losses can be analysed in a very straightforward fashion . for fock states a beam splitter with",
    "transmission coefficient @xmath22 yields a statistical mixture , which is governed by binomial distribution @xmath44 for the fock states @xmath45 and",
    "@xmath46 this results explicitly in @xmath47 , \\;\\;\\;\\;\\mathrm { } \\ ,   \\nonumber       \\label{p_displaced1}\\end{aligned}\\ ] ] @xmath48\\,\\ , .",
    "\\label{p_displaced2}\\end{aligned}\\ ] ]",
    "according to the previous sec .",
    "[ displacementsec ] the measurable probability @xmath31 differs from the ideal @xmath49 that is required for the reconstruction of the wigner function in eq .",
    "( [ w_pn ] ) . in this section",
    "we study how to relate these quantities and generalise the model to allow for the detection losses . in this case",
    "the quantum signal is degraded both before and after the realisation of the displacement . the network shown in fig .",
    "[ scheme ] represents the sequence of operations undergone by the signal , where losses are modelled as beam splitters combining the signal with vacuum modes .",
    "the last beam splitter , with transmission @xmath50 , represents the limited quantum efficiency of the detector itself .",
    "as before , to evaluate the photon number probabilities , we introduce the effective photon number operator , which can be expressed as @xmath51 with @xmath52 being the overall quantum efficiency .",
    "the total amount of displacement is equal to @xmath53 .",
    "note that in contrast to losses experienced by the signal before the displacement , the detection efficiency @xmath50 has no impact on @xmath0 .    in analogy to eq .",
    "( [ p_n ] ) with the detection loss @xmath54 , we note that the exponential factor @xmath55 can be rewritten as @xmath56\\hat{a}^{\\dagger}\\hat{a}$ ] . employing the series expansion of exponential function",
    "it is easy to show that @xmath57 where we define @xmath58 as an element of an upper diagonal matrix , referred as the loss matrix .",
    "recording @xmath11 events with a non - ideal detection , ensures that the signal contained at least @xmath59 photons .",
    "we note that eq .",
    "( [ p_nloss ] ) differs from eq .",
    "( [ ideald ] ) in the sense that the right hand term @xmath60 directly corresponds to the non - degraded statistics of the displaced initial state @xmath61 .",
    "( [ p_nloss ] ) is expressed in matrix form @xmath62 , we can easily verify that the loss inverted statistics correspond to the ideal displaced statistics .",
    "thus , we can deduce that the effect of non - ideal detection can in principle be handled by the loss inversion method .",
    "nevertheless , photodetectors with photon number resolution are still essential .",
    "photon number resolution can be achieved by distributing several photons into many different temporal modes , which are then analysed with binary detectors by time multiplexing . in practice ,",
    "a tmd consists of a fibre - integrated 50/50 beam splitter network with time delays implemented as fibre loops of different lengths ( fig .  [ scheme ] ) .",
    "a pulse launched into the detector is divided into a train of pulses in two separate fibre outputs  @xcite .",
    "the existence of photons in each mode ( or time - bin ) can be detected by avalanche photo diodes ( apds ) and the so - called click - statistics are collected for ensemble measurements .",
    "the measured click statistics @xmath63 are related to the input photon number distribution through the relation  @xcite @xmath64 the convolution matrix @xmath65 takes into account a stochastic distribution of @xmath11 photons into several bins ( from which follows that the number of clicks @xmath66 is lower or equal to @xmath11 ) and the matrix @xmath67 describes the binomial process of loss , as introduced in eq .",
    "( [ p_nloss ] ) .",
    "therefore , by inverting equation  ( [ cl_inversion ] ) ( or using a maximum likelihood technique ) , the photon number distribution of the quantum signal can be reconstructed from the click statistics if the overall loss @xmath54 and the convolution matrix are known . beside the numerical techniques",
    "an analytical solution can be used for inverting the losses , as presented in [ app_a ] .",
    "experimentally , the calibration of the overall efficiency @xmath68 can be reliably accomplished by taking advantage of the twin photon generation properties of a parametric down conversion process  @xcite .",
    "in addition to the overall loss , the total amount of displacement @xmath69 needs to be properly calibrated .",
    "the transmission @xmath22 of the beam splitter can be characterized by monitoring both outputs of the beam splitter and measuring the fraction of a strong input field @xmath33 that is transmitted and detected by a standard photo diode .",
    "an additional measurement extracts the value of @xmath50 by , e.g. measuring the poissonian statistics of the coherent reference field @xmath70 that is incident on the tmd .",
    "finally , combining the results of the unbalanced homodyning of vacuum together with the knowledge of the overall losses and @xmath22 , enables us to determine the amount @xmath71 .",
    "thus , all losses can be experimentally characterized enabling the loss - tolerant probing of the wigner function .",
    "mode overlap is a crucial issue for both unbalanced and balanced characterization techniques . in balanced homodyne measurements",
    "the detected photocurrent @xmath72 is proportional to the _ product _ of the quantum signal and the local oscillator , @xmath73 , @xcite . as only the overlapping part of the signal state",
    "is measured , imperfect mode overlap has intrinsically the same signature as a loss .",
    "contrariwise , in unbalanced measurements such as the direct probing method , the detection is proportional to the photon number operator , represented by _",
    "sum _ of the signal and reference field , i.e.  @xmath74 .",
    "each photon impinging on the apd causes a detectable photocount , and the signature of the mode mismatch becomes different from loss @xcite .",
    "we model the imperfect mode overlap by the beam splitter network as shown in fig .",
    "[ 3bs_overlap ] . in the following",
    "we elaborate the conditions under which this network is equivalent to the one depicted in fig .",
    "[ simple_overlap ] .",
    "as before we relate the actual experimental parameters with the values of the equivalent network . in the network of fig .",
    "[ 3bs_overlap ] , the signal and the reference beam are divided into four modes , two of them interfering .",
    "the other modes do not overlap and are just split according to the ratio @xmath22 .",
    "hereby we assume that @xmath75 and @xmath76 correspond to the fractions of the signal and reference fields , which are perfectly mode matched and the product @xmath77 defines the degree of overlap .",
    "the probability @xmath31 of detecting @xmath11 photons is given by the convolution of the joint probability distribution @xmath78 .",
    "the parameters @xmath79 , @xmath80 and @xmath81 label the photon number in the three modes of the network : the signal ancilla , the displaced signal , and the reference ancilla . using the multimode theory of photo detection  @xcite",
    ", we can simplify the evaluation of the convolution by expressing the photon number distribution @xmath31 in the form of eq .",
    "( [ p_n ] ) , @xmath82 where the photon number operator @xmath83 of the multimode field is equal to the sum of the number operators of each different detection mode @xmath84 . applying the beam splitter transformation of eq .",
    "( [ beamsplitter ] ) , the evolution of the different modes are given by @xmath85 @xmath86 @xmath87 in which @xmath88 , @xmath89 , are auxiliary operators that represent the modes of the vacuum , as depicted in fig .  [ 3bs_overlap ] .",
    "once more , considering coherent states , the operators can be replaced by complex numbers .",
    "the number operator @xmath83 can be substituted by @xmath90 where @xmath91 is the amount of displacement .",
    "the parameter @xmath92 can be interpreted as the amplitude of an effective coherent field .",
    "finally , the probability of @xmath11 counts is given by @xmath93 from eq .",
    "( [ p_convoluted ] ) , we recognise that the photon number distribution is a convolution of two different photon number distributions .",
    "the first contribution corresponds to the statistics of an ideally displaced quantum signal , detected with efficiency @xmath22 , and the second corresponds to a poissonian distribution . as a consequence , the network shown in fig .",
    "[ 3bs_overlap ] and its counterpart depicted in fig .",
    "[ simple_overlap ] , which is conceptually simplified , exhibit equivalent photon number probabilities .",
    "our derivations lead to the conclusion that the detected photon number distribution can always be expressed as a convolution of the displaced state distribution and a poissonian distribution . as first mentioned in  @xcite , a wigner function constructed with the distribution in eq .",
    "( [ p_convoluted ] ) is composed of the product of two separate wigner functions .",
    "the decreasing overlap between the signal and reference fields distorts the reconstructed wigner function such that it deviates towards a gaussian multiplied with the value of the signal state wigner function at the origin .",
    "this results in an artificial broadening of the reconstructed wigner functions of low - photon number fock states .",
    "beyond the investigation of loss - tolerant reconstruction of the wigner function , direct probing also allows us to explore the non - trivial photon number distributions of displaced fock states . as a result of their exact photon number ,",
    "fock states exhibit a completely undetermined phase , which can be depicted by a rotational symmetry of the field quadratures around the origin of the phase space . in other words ,",
    "fock states can be imagined as rings around the origin ( uncertain phase ) that have definite amplitudes ( exact photon numbers ) .",
    "photon number detection corresponds to evaluating the overlap of the studied signal state with fock states . using this concept",
    "it becomes intuitive that the photon number distributions of displaced fock states must present oscillations as a consequence of an interference process in phase space @xcite .",
    "[ 95wignerp ] presents typical oscillations of the states @xmath45 and @xmath46 . considering e.g.  the displaced single photon fock state",
    ", we clearly see that the probability of measuring one photon decreases as the displacement is increased .",
    "it is maximally suppressed when the displacement reaches the mean photon number @xmath94 , and increases again for higher values of the displacement . in this section this quantum behavior",
    "is explored in order to distinguish the effects of losses from those of imperfect mode overlap between the signal and reference fields .",
    "we numerically study the reconstruction of the photon number distribution of the single photon fock state as a function of the degree of overlap @xmath95 introduced in the last section .",
    "the photon number distribution is evaluated using eq .",
    "( [ p_convoluted ] ) , which gives for @xmath96 and @xmath97 the following expressions @xmath98 @xmath99 .",
    "\\label{overlapp1}\\ ] ] we consider a beam splitter with @xmath100 and reconstruct the photon number distributions for the cases of 100% , 50% and 0% overlap applying the loss inversion algorithm and scaling of the displacement as discussed previously .",
    "[ overlaps ] illustrates the characteristic behaviour of the vacuum and one photon components of the photon number distribution with respect to the displacement applied to single photon fock state . in the case of perfect overlap between signal and reference",
    "we expect a complete suppression of the one photon component when the displacement is @xmath101 [ fig .  [ overlaps](a ) ] , for 50% overlap , the oscillation of the vacuum and one photon components is reduced but still visible [ fig .",
    "[ overlaps](b ) ] . however , for non - overlapping fields the oscillation is completely washed out and the photon number distribution is just a convolution of the single photon state statistics with a poissonian [ fig .",
    "[ overlaps](c ) ] .",
    "a clear signature of the lack of mode matching becomes apparent in the vacuum component of the inverted statistics : in the case of non - overlapping fields this contribution is always zero independent of the displacement .",
    "this effect is opposed to the signal degradation caused by losses , which always increases the probability of obtaining the zeroth photon number component .",
    "these results suggest a recipe to directly deduce the degree of mode matching from the amount of oscillation of the vacuum and one photon components . in fig .",
    "[ oscillation ] we show the values of @xmath102 and @xmath103 as a function of @xmath95 , where @xmath104 is the probability of having @xmath105 photons in the photon number distribution at the displacement @xmath0 .",
    "thus , @xmath106 represents a measure of the amplitude of the oscillation . from an experimental point of view",
    ", this method is an extremely direct way of characterizing the amount of overlap , as it solely requires the measurement of the vacuum ( or one photon ) component without displacement and at a single point with @xmath101 .",
    "in order to characterize a quantum state experimentally it has to be prepared several times enabling an ensemble measurement , which allows us to reconstruct the photon number statistics of the state . here",
    ", a similar scenario was achieved using a monte carlo simulation .",
    "the detected click statistics were simulated with the help of eqs .",
    "( [ p_displaced1 ] ) and ( [ p_displaced2 ] ) , which describe the photon number distribution of displaced fock states .",
    "we then replaced the parameter @xmath22 with the value of the overall loss @xmath54 and recalibrated the value of the displacement accordingly . by performing a monte carlo simulation we generated the statistics of the studied quantum states , which were then convolved with the known stochastic description of the tmd .",
    "as the states under consideration ( @xmath45 and @xmath46 ) are symmetric in phase space , we assumed fixed values for the relative phase between signal and reference beam and changed only the amplitude of the displacement .    to recover the photon number statistics of the displaced state we employed the direct numerical inversion of eq .",
    "( [ cl_inversion ] ) and evaluated the photon number parity from the statistics to yield the reconstructed value of the wigner function . in order to estimate the statistical errors , for each sampled point of the phase space we performed ten monte carlo simulations ,",
    "each consisting of @xmath107 events .",
    "the chosen number of events was based on the expected number of experimental trials ; this depends , for example , on the setup stability .",
    "this set of simulations gave at each sampled point ten simulated values for the wigner function , from which we evaluated the mean value and the standard deviation .",
    "there are two factors limiting the range over which the state reconstruction can be considered reliable .",
    "first , as a consequence of the tmd resolution , the mean photon number of the displaced beam is restricted . with a @xmath80-stage tmd ( incorporating @xmath80 50/50 couplers ) we are able to resolve at maximum @xmath108 clicks ( equal to the number of bins into which the incident pulse is separated ) .",
    "the reconstruction becomes unstable as soon as the displaced state has a significant contribution of photon numbers larger than the number of the tmd bins . in our numerical investigations",
    ", we observed that the instability can be tolerated until the probability of having more than @xmath108 photons in the displaced state is on the order of @xmath109 .",
    "the second limitation arises from statistical errors and can be estimated from the amount of collected events versus losses .",
    "statistical errors are highly amplified in the loss inversion process .",
    "as the losses increase the inversion becomes unstable , yielding a singular loss matrix and negative probability components for the reconstructed photon number statistics .",
    "we define the reliable reconstruction range by a boundary value for the displacement at which the inversion becomes unstable or , similarly , we accept the values of displacement at which the photon number statistics reconstructed from all @xmath110 events render components @xmath111 .    any experimental implementation of the direct probing scheme , as envisioned with the current technology , is subjected to high losses .",
    "for example , the quantum efficiencies of apds can reach values between 60 - 80% .",
    "the coupling efficiency into single - mode fibres is highly mode - sensitive and can drop down to 30 - 40% in case of mismatched modes .",
    "another important source of degradation of the signal is the beam splitter used as displacing element .",
    "typically , the transmittance of this beam splitter is around 95% . due to the 5% reflectance",
    ", the beam splitter intrinsically attenuates the quantum signal and modifies the displacement . effectively ,",
    "in a realistic experiment for state characterization the achievable detection efficiency will lie between 20% and 30% .",
    "in addition to the effects of inefficiencies or losses , we must take into account the accuracy with which the convolution matrix of the tmd can be determined .",
    "this is caused by unbalanced 50/50 couplers , which are generally specified with @xmath112 uncertainty .",
    "we performed the simulation for four different scenarios to clarify the effects of different experimental frames .",
    "we analysed the performance of the state characterization and estimated the limitations by considering a realisable displacement operator implemented with a beam splitter of 95% transmittance , a detection with three - stage ( 8-bin ) tmd and perfect efficiency .",
    "furthermore , we analysed the possible benefits associated with the use of a four - stage ( 16-bin ) tmd taking also into account a finite detection efficiency .",
    "next , the amount of degradation was increased , considering the experimentally achievable efficiency level .",
    "finally , the effect of imperfect mode overlap was included .",
    "[ [ case-1 ] ] case 1 : + + + + + + +    first we studied the idealized case of perfect detection efficiency but included the finite resolution of a tmd due to its limited number of stages .",
    "the quantum signal was displaced at a beam splitter with 95% transmittance and the tmd was assumed to be constructed from ideal 50/50 couplers .",
    "the results show that the reconstructed wigner functions of the @xmath45 and @xmath46 fock states are slightly loss - degraded around the origin due to the reflection of the signal at the beam splitter .",
    "nevertheless , this degradation can be easily handled with the direct inversion , as shown in fig .",
    "[ 95wigner ] . due to the limited number of tmd stages ,",
    "a reliable reconstruction of @xmath113 is possible only inside a given scanning range of phase space , i.e. there is a maximum value of @xmath0 that can be safely used .",
    "the ultimate boundaries for the reliable scanning ranges correspond to displacements of @xmath114 and @xmath115 for states @xmath45 and @xmath46 , respectively . nevertheless , with lossless detection , the 8-bin tmd is adequate to scan the interesting regions of the phase space for both of these states .",
    "[ [ case-2 ] ] case 2 : + + + + + + + +    in the second simulation we considered more realistic parameters , which might be accessible in the near future .",
    "we assumed again a beam splitter with 95% transmittance , and a detection efficiency of @xmath116 . in this case",
    "we compared the performance of 8- and 16-bin tmds for reconstructing the wigner function of the single photon fock state .",
    "as an example of an unbalanced tmd we chose couplers with splitting ratios of 45/55 . however , the deconvolution was still done by assuming perfect 50/50 couplers , as the imbalance of @xmath112 is due to uncertainty in the beam splitter specification .",
    "as the detection efficiency decreases , the effect of the loss becomes prominent restricting the reliable scanning range in phase space .",
    "moreover , the effect of the unbalanced deconvolution becomes negligible in comparison to the effect of loss .",
    "an inspection of fig .",
    "[ 60wigner ] shows that very little advantage is gained in this loss regime by choosing the larger tmd . in this case the direct inversion of the fock state @xmath45 breaks down when the displacement is close to @xmath117 and @xmath118 for 8- and 16-bin tmds , respectively .",
    "[ [ case-3 ] ] case 3 : + + + + + + + +    in the third simulation , we studied the reconstruction ranges for the single and two photon fock states , assuming a currently feasible experimental situation in which the detection efficiency equals 30% . once again",
    ", the scheme consists of a beam splitter with 95% transmittance , unbalanced tmd with 45/55 couplers but balanced deconvolution . at this high loss regime",
    "we can choose the 8-bin tmd for photon counting , since the ability to record higher photon numbers does not bring any advantage to the loss inversion .",
    "in this situation , the negative parts of the loss - degraded wigner functions are completely washed out in the loss - degraded data .",
    "nevertheless , the inner regions of the wigner functions can still be reliably reconstructed up to displacements of 0.8 and 0.6 for the states @xmath45 and @xmath46 , respectively ( fig .  [ 30wigner ] ) . in the case of the fock state @xmath46 ,",
    "the inversion causes negative probability components also close to the origin , indicating that the inversion is unstable .",
    "this is not caused by the contribution of higher photon numbers but by the accuracy at which the vacuum , one and two photon components are recorded .",
    "nevertheless , the results appear to be accurate as the error in the parity measurement is seen to be negligible .    despite the low efficiency ( 30% )",
    ", the simulation indicates that we are able to reconstruct the oscillatory behaviour of the photon number statistics for the fock states @xmath45 and @xmath46 .",
    "the loss obscures the oscillations of the photon statistics , but similarly to the wigner function analysis , the inversion technique enables us to reconstruct this characteristic behavior from the tmd measurement . in fig .",
    "[ 30probability ] we show this behavior , comparing the loss - degraded , inverted , and expected photon statistics at zero displacement and at the highest reliable displacement that can be applied to the quantum state .",
    "[ [ case-4 ] ] case 4 : + + + + + + +    finally , we studied the reconstruction of the single photon wigner function in the presence of imperfect mode overlap between the signal and reference fields .",
    "the statistics were generated according to eq .",
    "( [ p_convoluted ] ) .",
    "we now restricted the reconstruction range of the wigner function to the region where probability components @xmath119 .",
    "other procedures , such as the error estimation , were kept the same .",
    "we utilised a beam splitter with 95% transmittance for the implementation of the displacement and a an 8-bin tmd with ideal 50/50 couplers and assumed that the single photon fock state was affected by loss ( efficiency equal to 30% ) before applying a non - ideal displacement ( @xmath120 ) . in fig .",
    "[ 30loss50overlap ] we show the photon number statistics for both the degraded and reconstructed signals at different values of the displacement .",
    "the quantum feature of photon number oscillation is washed out by the dual action of losses and imperfect overlap .",
    "nevertheless , the loss can still be handled by applying an appropriate inversion method . in terms of displacement , the reconstruction is reliable to the boundary value of @xmath121 . as shown in fig .",
    "[ 30loss50overlapw ] , the wigner function determined via the degraded signal does not display any quantum features .",
    "however , using the inversion of the statistics , the negative inner parts are recovered , although with a broadened width as a consequence of the imperfect mode overlap .",
    "we studied the reconstruction of wigner functions of low - photon - number fock states in a tmd - based photon counting experiment .",
    "several parameters restrict the reliable reconstruction range of the wigner function in phase space : the number of photons that a tmd can maximally resolve , the stability of the inversion with respect to the level of loss and the amount of statistics collected , and the imperfect mode overlap.with current technology , the dominant limitation is the efficiency achievable by the experimental realisation .    performing monte carlo simulations we reconstructed the wigner functions for single - photon and two - photon fock states at different levels of detection efficiency .",
    "we showed that , under perfect mode - matching conditions , the wigner function of the single - photon fock state can be reconstructed with high confidence .",
    "the characteristic oscillatory behaviour present in the photon number distributions of displaced fock states are extremely sensitive to losses , yet this interesting quantum feature can be reliable restored by applying a loss - inversion . a clear indication of phase space interference is given by the suppression of the one - photon component of the displaced single - photon fock state .    furthermore , we analysed the the situation of imperfect mode overlap .",
    "we showed how to employ the oscillatory behaviour as a tool to characterize the degree of mode overlap between the quantum signal and reference beam . regarding the reconstruction of the wigner function , even in a scenario of only 50% mode overlap",
    ", the simulation shows the possibility of recovering the negative values of the single - photon fock state , although with a broader width .",
    "our results motivate the experimental exploration of non - gaussian states with photon number resolving detectors .",
    "this kind of experiments offers the opportunity of loss - tolerant _ state _ characterization via the inversion of losses , along with the ability to probe the wigner function point  by  point in phase space .",
    "furthermore , the probing method allows advanced quantum state characterization that is intrinsically not only sensitive to a single mode but takes into account all the characteristics of the original quantum state and the coherent reference field . in our paper",
    ", we provided the tools to reliably characterize the prepared state and highlighted the different impacts of inefficient detection , convolution of statistics and mode mismatch .",
    "in contrast to standard homodyne detection , our analysis enables us to recognise the type of experimental imperfections , and gives valuable information about the extent of degradation caused by each one .",
    "hence , our work constitutes a basis for a broad understanding and efficient manipulation of experimental data . we expect that our investigation will open a new route of detecting and studying quantum states and offer a new experimental technique for hybrid quantum information applications .",
    "we would like to acknowledge fruitful discussions with t.  c.   ralph , w.  p.  schleich and w.  vogel .",
    "we thank p.  j.  mosley for his comments about the manuscript .",
    "this work was supported by the eu under qap funded by the ist directorate as contract no . 015848 .",
    "in this section we derive the analytical solution for reconstructing the wigner function from the loss - degraded statistics .",
    "the elements of the loss matrix are determined by eq .",
    "( [ p_nloss ] ) @xmath122 and the loss degraded statistics @xmath123 are connected to the photon number statistics by @xmath124 where @xmath66 is the highest resolvable photon number of the detector , @xmath80 is the number of detected photons while @xmath11 is the number of incident photons .",
    "regardless of the efficiency ( @xmath125 ) , the direct inversion of the loss matrix is possible by @xmath126 where @xmath11 now corresponds to the number of loss - degraded detection events and @xmath80 is the number of photons in the signal state .",
    "note that both matrices in eqs .",
    "( [ loss ] ) and ( [ loss_inversion ] ) are upper diagonal matrices .",
    "the inverted photon number statistics are given by @xmath127 the reconstruction of the photon number @xmath80 is affected by all photon numbers satisfying @xmath128 . the wigner function can be evaluated with the help of eq .",
    "( [ w_pn ] ) using the degraded statistics in eq .",
    "( [ deg_pl ] ) @xmath129 p^{l}_{m } , \\qquad m \\leq n \\leq n \\nonumber \\\\        & = & \\frac{2}{\\pi } \\sum_{n=0}^{n } \\left ( -\\frac{2-\\eta}{\\eta } \\right ) ^{n }   p^{l}_{n}.        \\label{linv}\\end{aligned}\\ ] ] the result of eq .",
    "( [ linv ] ) agrees with the independent analysis presented in ref .",
    "@xcite and corresponds to scaling the parity factor by the detection efficiency .",
    "we can apply this method for example on the loss - degraded statistics of the single photon fock state derived in eq .",
    "( [ p_displaced1 ] ) . the loss - inverted wigner function can be written as @xmath130\\nonumber \\\\ & = & \\frac{2}{\\pi}e^{-2\\frac{|\\gamma|^{2}}{t}}\\left [   4\\frac{|\\gamma|^2}{t } -1\\right ] , \\label{wfock1}\\end{aligned}\\ ] ] which corresponds to the wigner function of the single photon fock state at the phase space point @xmath131 as expected .",
    "experimentally , the reconstruction of the wigner function at any given point of phase space is not possible , since the maximal resolvable photon number upon detection is finite , i.e. for an @xmath80-stage tmd the summation upper bound @xmath132 in eq .",
    "( [ linv ] ) . nevertheless , concerning the characterization of low - photon number fock states , the interesting regions of the wigner function are around the origin of phase space and thus the probabilities for measuring high - photon number components are negligible .",
    "for these reasons , the reconstruction range depends on the photon - number of the displaced state and on the resolution capability of the detector .",
    "10              j.  s. neergaard - nielsen , b.  meltholt nielsen , c.  hettich , k.  molmer , and e.  s. polzik .",
    "generation of a superposition of odd photon number states for quantum information networks .",
    ", 97(8):0836041 , 2006 .",
    "d.  t. smithey , m.  beck , m.  g. raymer , and a.  faridani .",
    "measurement of the wigner distribution and the density matrix of a light mode using optical homodyne tomography : application to squeezed states and the vacuum .",
    ", 70(9):1244 , 1993 .",
    "d.  achilles , ch .",
    "silberhorn , c.  sliwa , k.  banaszek , i.  a. wamsley , m.  j. fitch , b.  c. jacobs , t.  b. pittman , and j.  d. franson .",
    "photon - number - resolving detection using time - multiplexing .",
    ", 51(9 - 10):1499 , 2004 .",
    "the lack of mode matching between signal and reference fields have been analyzed in the past by banaszek et al .",
    "although with equivalent results , the approach for the calculations and the focus of the discussion are different .",
    "the authors explore the multimode characteristic itself in detail , nevertheless without expressing the results as a function of the original input mode .",
    "we explicitly show how to evaluate the photon statistics with the _ single _ initial input mode @xmath133 , which may have a multimode structure ( for convenience , @xmath133 has been decomposed into an overlapping and a non - overlapping mode ) ."
  ],
  "abstract_text": [
    "<S> we investigate the capabilities of loss - tolerant quantum state characterization using a photon - number resolving , time - multiplexed detector ( tmd ) . </S>",
    "<S> we employ the idea of probing the wigner function point  by  point in phase space via photon parity measurements and displacement operations , replacing the conventional homodyne tomography . </S>",
    "<S> our emphasis lies on reconstructing the wigner function of non - gaussian fock states with highly negative values in a scheme that is based on a realistic experimental setup . in order to establish the concept of loss - tolerance for state characterization </S>",
    "<S> we show how losses can be decoupled from the impact of other experimental imperfections , i.e. the non - unity transmittance of the displacement beamsplitter and non - ideal mode overlap . </S>",
    "<S> we relate the experimentally accessible parameters to effective ones that are needed for an optimised state reconstruction . </S>",
    "<S> the feasibility of our approach is tested by monte carlo simulations , which provide bounds resulting from statistical errors that are due to limited data sets . </S>",
    "<S> our results clearly show that high losses can be accepted for a defined parameter range , and moreover , that  in contrast to homodyne detection  mode mismatch results in a distinct signature , which can be evaluated by analysing the photon number oscillations of the displaced fock states . </S>"
  ]
}