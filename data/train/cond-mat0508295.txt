{
  "article_text": [
    "even though the _ gw _ approximation ( @xmath0a ) of hedin@xcite is as old as the local - density approximation ( lda ) , it is still in its early stages because of serious difficulties in its implementation . in the usual _ ab initio _",
    "procedure , @xmath3 and @xmath4 are constructed from the lda potential , which generate the self - energy @xmath5 .",
    "additionally the quasiparticle energies ( qpe ) are usually approximated as a perturbation correction to the lda , from the matrix elements of the diagonal parts of @xmath6 ; see eqns .",
    "[ eq : qpgwnc ] and  [ eq : qpgw ] below . in principle , it is well - defined as a procedure .",
    "however , there is a controversy what the numerical result of this procedure is for semiconductors .",
    "nearly always the @xmath0a is implemented in conjunction with the pseudopotential ( pp ) approximation , which we will call pp@xmath0 .",
    "it was widely thought that pp@xmath0 predicts bandgaps in semiconductors to rather high accuracy .",
    "however , recent all - electron _ gw _ calculations to survey bandgaps in semiconductors using the full - potential lmto ( fp - lmto ) by kotani and van schilfgaarde @xcite result in bandgaps that are generally smaller than experimental values .",
    "the result is confirmed by other calculations using two independently - developed full - potential linear augmented plane wave ( fp - lapw ) codes : one by usuda , hamada , kotani and van schilfgaarde@xcite and another by friedrich , schindlmayr , blgel and kotani @xcite .",
    "these methods all use essentially the same @xmath0 codes originally developed in conjunction with the lmto method @xcite ; they differ only in the input eigenfunctions .",
    "calculations from other , independently developed all - electron @xmath0 methods @xcite are consistent with this conclusion@xcite .",
    "tiago , ismail - beigi , and louie@xcite used the pp@xmath0 scheme that included si @xmath7 and @xmath8 cores in the valence to analyze the dependence of some semiconductor bandgaps on the number of unoccupied states @xmath9 used to construct the self - energy .",
    "they suggested that the discrepancy between all - electron @xmath0 and pp@xmath0 gaps could be attributed to incomplete convergence in the all - electron calculations .",
    "to address this point , the convergence in @xmath9 is taken up in sec .",
    "[ sec : nconvergence ] .",
    "we begin with an outline our all - electron @xmath0 method ( sec .",
    "[ sec : methodology ] ) ; it includes a comparison of the energy bands in si to those of an apw calculation taken from friedrich et al .",
    "@xcite , establish the method s ability to reproduce near - exact lda eigenvalues . in sec .",
    "[ sec : basisconvergence ] we show how selected qpes change with increasingly larger lmto basis sets for a variety of semiconductors .",
    "the results are weakly dependent on basis even for relatively small basis sets .",
    "we present some rationale for why this should be so , and note the implications for both precision and efficiency in implementations of the @xmath0a for basis sets in general .",
    "because our results are well converged for either kind of test , we still think that pp@xmath0 is problematic , in contradistinction to the conclusions in a recent paper by delaney , garca - gonzalz , rubio , rinke and godby @xcite , who showed that all - electron @xmath0 and pp@xmath0 give essentially the same result for the be free atom .",
    "however , the be atom is a special case in part because the all - electron and pseudo radial functions should closely correspond to each other ( the @xmath8 radial function has no nodes , and the only core that is orthogonalized or pseudized is the deep @xmath10 core ( @xmath11ev ) ; moreover the pp is constructed with the atom itself as reference .",
    "pseudopotentials are constructed to solve lda reliably , but not to solve the @xmath0a .",
    "there are now many detailed checks comparing pp - lda results against the corresponding all - electron values ; but there are few similar comparisons for @xmath0 .",
    "the discrepancies between all - electron and pp@xmath0 appear to be much smaller when pp@xmath0 includes the highest lying core states in the valence .",
    "[ sec : core ] analyzes different core contributions to the qpe in several semiconductors .",
    "this provides some insight as to what approximations may be made concerning the core ; we also briefly consider some aspects of pp@xmath0 in this context .    in sec .",
    "[ sec : gldawlda ] we show some new results for a variety of materials , as well as repeating some previously reported calculations@xcite with rather tight tolerances .",
    "we confirm that the usual @xmath0a procedure generally underestimates bandgaps .",
    "we also show that a partial self - consistency can be accomplished by calculating qpes without the renormalization factor @xmath2 ( i.e. @xmath2=1 ) .",
    "semiconductor bandgaps are systematically improved using @xmath2=1 , though they continue to be underestimated .",
    "an important reason for this is that the lda overestimates the screening of @xmath4 , resulting in an underestimate of @xmath12 and bandgaps .",
    "we show that the adequacy of the @xmath0a varies from system to system : only when the starting lda is reasonably good does the @xmath0a reasonably predict qp energies .",
    "thus , some kind of self - consistency is necessary to obtain reasonable results for wide range of materials.@xcite",
    "before turning to the analysis , we briefly describe the lda method we use as input for the @xmath0 calculations .",
    "( readers interested in conclusions of this paper _ not _ related to basis - set issues can skip this section ) .",
    "an early version of this method was presented in ref .  ; we describe here how additional local orbitals are included to extend the linear method .",
    "local orbitals are essential to the analysis , because qpe in @xmath0a are sensitive to a wider range of states than in lda ( e.g. , the lda depends only on occupied states ) .",
    "one consequence is that the linear approximation inherent in standard linear and pseudopotential methods is less reliable for the @xmath0a than for the lda .",
    "the basis functions used in the present technique are a generalization@xcite of the standard@xcite method of linear muffin - tin orbitals ( lmto ) .",
    "conventional lmtos consist of atom - centered envelope functions augmented around atomic sites by a linear combination of radial wave functions @xmath13 and their energy derivatives @xmath14 .",
    "@xmath15 is the solution of radial schrdinger equation at site @xmath16 at some linearization energy @xmath17 .",
    "a linear method matches the @xmath18 pair to value and slope of the envelope function at each augmentation sphere boundary , which means that the lda schrdinger equation can be solved more or less exactly to first order in @xmath19 inside each augmentation sphere .",
    "envelope functions in the standard lmto method consist of hankel functions . in the present basis@xcite the envelope functions are smooth , nonsingular generalizations@xcite of the hankel functions : the @xmath20=0 smooth hankel satisfies the equation @xmath21 and reduces to a usual hankel function in the limit @xmath22 .",
    "@xmath23 for higher @xmath24=(@xmath20,@xmath25 ) are obtained by recursion@xcite .",
    "the basis can be divided into three types of functions :    ( _ _ )    a muffin - tin orbital ( mto ) @xmath26 which consists of a smoothed hankel centered at nucleus @xmath27 and augmented by linear combinations of @xmath28 and @xmath29 for each @xmath24 channel inside every augmentation sphere @xmath30 @xmath31 is a one - center expansion of @xmath32 , and @xmath33 is a linear combination of @xmath34 and @xmath35 that matches @xmath31 at the augmentation sphere radius .",
    "expansion coefficients @xmath36 are chosen to make @xmath37 smooth across each augmentation boundary .",
    "@xmath38 is chosen to be at or near the center of the occupied part of that particular @xmath20 channel .",
    "products of such functions enters into the construction of the hamiltonian and output density .",
    "the present method differs in significant ways from the usual lmto and lapw methods , and is not a simple product of mto eq .",
    "( [ eq : defmt ] ) , and bears some resemblance to the projector augmented wave prescription@xcite .",
    "it greatly facilitates @xmath20 convergence in the augmentation ; see ref .  .",
    "`` floating orbitals '' consisting of the same kind of function as ( @xmath39 ) , but not centered at a nucleus .",
    "thus , there is no augmentation sphere where the envelope function is centered .",
    "there is no fundamental distinction between this kind of function and the first type , except that the distinction is useful when analyzing convergence .",
    "floating orbitals make little difference in lda calculations ; but a basis consisting of purely atom centered envelope functions is not quite sufficient to precisely represent the interstitial over the wide energy window needed for @xmath0 calculations . without their inclusion ,",
    "errors in qpe of order 0.1  ev can not be avoided , as we will show .    a kind of `` local orbital '' which has a structure similar to ( @xmath39 ) .",
    "the fundamental distinction is that the `` head '' ( site where the envelope is centered ) consists of a new radial function @xmath40 evaluated at energy @xmath41 either far above or far below the linearization energy @xmath42 . for deep ,",
    "core - like orbitals @xmath40 is integrated at the core energy ; for high - lying orbitals @xmath41 is typically taken 1 - 2 ry above the fermi level @xmath43 . in the former case",
    "a tail is attached , with its smoothing radius @xmath44 chosen to make the kinetic energy continuous across the `` head '' augmentation sphere .",
    "it is thus atypical of conventional local orbitals , as it is nearly an eigenstate of the lda hamiltonian without requiring other basis functions .",
    "as is well known , the reason for using augmented wave methods in general ( and especially the lmto method ) , is that the hilbert space of eigenfunctions in the energy range of interest is spanned by much fewer basis functions than with other basis sets . in the present method two envelope functions @xmath45",
    "are typically used for low @xmath20 channels @xmath46 , @xmath47 , and @xmath48 , and one for higher @xmath20 channels ( @xmath49 and sometimes @xmath50 ) .",
    "the augmentation + local orbital procedure ensures that the basis is reasonably complete inside each augmentation sphere within a certain energy window ; the envelope functions + floating orbitals ensures completeness of the basis in the interstitial .",
    "the distinction between standard lmto envelope functions and the smoothed ones used here is important because the generalized form significantly improves this convergence .",
    "core states not treated as local orbitals are handled by integrating the radial schrdinger equation inside an augmentation sphere and attaching a smoothed hankel tail , allowing it to spill into the interstitial .",
    "thus the hartree and exchange correlation potentials are properly included ; only the matrix element coupling core and valence states is neglected .",
    "first column denotes the range of bands used to compute the rms deviation ; the horizontal dashed lines denote the approximate energy window for each range .",
    "second and third columns denote the how the present method and the lapw method respectively deviate from the apw bands , in ev , as described in the text . ]",
    "when used in conjunction with @xmath0 calculations we typically add local orbitals for states not spanned by @xmath51 , and whose center of gravity falls within @xmath52  ev of the fermi level @xmath43 .",
    "both the low - lying and high - lying states can be important , and we shall return to it later .",
    "[ fig : sildabands ] shows the effects of linearization in si , where an apw calculation of the lda energy bands is available@xcite .",
    "friedrich et al .",
    "@xcite compared lda bands generated by a full apw calculation to those generated by lapw .",
    "they are reproduced in fig .",
    "[ fig : sildabands ] , together with the bands generated by the lmto+local+floating orbitals described above .",
    "the lapw and apw are nearly indistinguishable on the scale of figure for energies up to @xmath5325 ev . for energies above 25 ev , the lapw begins to deviate from the other two , showing the effects of linearization .",
    "the apw and generalized lmto bands are essentially indistinguishable on the scale of figure for energies up to @xmath5340 ev . above that , slight differences begin to appear ; the differences gradually increase for still higher energies .",
    "[ fig : sildabands ] also tabulates the rms deviation from the apw bands for several energy windows .",
    "the present method agrees with the apw bands to @xmath530.01 ev for levels within @xmath54ry , and to @xmath530.25 ev for levels below @xmath55ry .",
    "friedrich et al .",
    "report similar improvements to their lapw bands when local orbitals are added@xcite .",
    "they also compare bands generated by a pp , and show that the errors are comparable to the conventional lapw method .",
    "[ fig : sildabands ] establishes rather convincingly that the present method is nearly complete over a rather wide energy window in si . when local orbitals are included , it is comparable to an lapw method that includes local orbitals@xcite , and it is superior both to pp and conventional lapw methods .",
    "we briefly describe our all - electron implementation of the @xmath0 approximation . a more detailed account",
    "will be given elsewhere@xcite .",
    "the self - energy @xmath56 is @xmath57 in this paper @xmath3 will be taken to be the one - body non - interacting green function as computed by the lda , and the screened coulomb interaction @xmath4 is computed in the random - phase approximation ( rpa ) from @xmath3 .",
    "both @xmath3 and @xmath4 are obtained from the lda eigenvalues @xmath58 and eigenfunctions @xmath59 . for a periodic hamiltonian",
    ", we can restrict @xmath60 and @xmath61 to a unit cell and write @xmath3 as @xmath62 the infinitesimal @xmath63 is to be used for occupied states , and @xmath64 for unoccupied states .",
    "@xmath4 is written as @xmath65 where @xmath66 is the bare polarization function shown below , @xmath67 is the bare coulomb interaction , and @xmath68 is the dielectric function . for simplicity , the spin degree of freedom is omitted .    neglecting the off - diagonal part of @xmath56",
    ", we can evaluate qpe @xmath69 from @xmath70 .",
    "\\label{eq : e1shot}\\ ] ] @xmath71 is the quasi - particle ( qp ) renormalization factor @xmath72^{-1 } , \\label{eq : defzfac}\\ ] ] and accounts for the fact that @xmath56 is evaluated at the lda energy rather than at the qpe .",
    "( [ eq : e1shot ] ) is the customary way qpes are evaluated in @xmath0 calculations . in sec .  [",
    "sec : gldawlda ] , we present an argument that using @xmath2=1 ( or neglecting the @xmath2 factor ) is a better choice than eq .",
    "( [ eq : defzfac ] ) , and how the qpe is affected in actual calculations .",
    "however , the results presented here use the @xmath2 factor except where noted .    in fp - lmto ,",
    "eigenfunctions of the valence states are expanded in linear combinations of bloch summed mtos , eq .",
    "( [ eq : defmt ] ) @xmath73 inside augmentation sphere @xmath27 , the hilbert space of the valence eigenfunction @xmath74 consists of the pair ( or triplet ) of orbitals ( @xmath28 , @xmath29 or @xmath28 , @xmath29 , @xmath75 ) at that site@xcite , and can be represented in a compact notation @xmath76 .",
    "@xmath77 is a compound index for both @xmath24 and one of the @xmath78 , @xmath29 , @xmath75 ) triplet .",
    "the interstitial is comprised of linear combinations of envelope functions consisting of smooth hankel functions , which can be expanded in terms of plane waves@xcite .",
    "therefore the @xmath74 can be written as a sum of augmentation and interstitial parts @xmath79 where the interstitial plane wave ( ipw ) is defined as @xmath80 and the @xmath81 are bloch sums of @xmath82 @xmath83 * t * and * g * are lattice translation vectors in real and reciprocal space , respectively .    throughout this paper , we will designate eigenfunctions constructed from mtos as `` val '' .",
    "below them are the core eigenfunctions which we designate as `` core '' .",
    "there are two fundamental distinctions between val  and core : eigenfunctions : the latter are constructed independently by integration of the spherical part of the lda potential , and they not included in the secular matrix .",
    "second , the cores are confined to mt spheres@xcite .",
    "core  eigenfunctions are also expanded using eq .",
    "( [ def : psiexp ] ) in a trivial manner ; @xmath84 and only one of @xmath85 .",
    "the discussion below applies to all eigenfunctions , val  and core .    through eq .",
    "( [ def : psiexp ] ) , products @xmath86 can be expanded by @xmath87 in the interstitial region because @xmath88 .",
    "within sphere @xmath16 , wave function products can be expanded by @xmath89 , which is the bloch sum of the product basis @xmath90 , which in turn is constructed from the set of products @xmath91 adapting the procedure by aryasetiawan@xcite .",
    "( [ def : psiexp ] ) is equally valid in a lmto or lapw framework , and eigenfunctions from both types of methods have been used in this @xmath0 scheme@xcite .",
    "we restrict ourselves to lmto - derived basis functions here .",
    "we define the mixed basis @xmath92 , where the index @xmath93 classifies the members of the basis . by construction",
    ", @xmath94 is a good basis set for the expansion of products of @xmath59 .",
    "complete information to calculate @xmath56 and @xmath95 are matrix elements of the products @xmath96 , the lda eigenvalues @xmath97 , the coulomb matrix @xmath98 , and the overlap matrix @xmath99 .",
    "( the overlap matrix of ipw is necessary because @xmath100 for @xmath101 . )",
    "the coulomb interaction is expanded as @xmath102 where we define @xmath103 @xmath4 and the polarization function @xmath104 shown below are expanded in the same manner as eq .",
    "( [ coulombexpand ] ) .",
    "the exchange part of @xmath56 is written in the mixed basis as @xmath105    the screened coulomb interaction @xmath106 is calculated through eq .",
    "( [ eq : defw ] ) , where the polarization function @xmath104 is written @xmath107 eq .  ( [ eq : polf ] ) assumes time - reversal symmetry .",
    "we use the tetrahedron method for the brillouin zone ( bz ) summation in eq .",
    "( [ dieele ] ) following ref .  .",
    "we first calculate the contribution to @xmath104 proportional to the imaginary part of the second line in eq .",
    "( [ eq : polf ] ) , and determine the rest of @xmath104 by hilbert transformation ( kramers - krnig relation ) .",
    "such approach significantly reduces the computational time required to calculate @xmath104 .",
    "the correlation part of @xmath56 is @xmath108 here @xmath109 is for occupied states ; @xmath110 is for unoccupied states .",
    "@xmath111 .",
    "@xmath0 calculations usually approximate eq .",
    "( [ eq : e1shot ] ) by @xmath112,{{\\bf r}})|\\psikn \\rangle ] \\label{eq : qpgwnc}\\ ] ] where @xmath113 and @xmath114)$ ] are calculated only from eigenfunctions belonging to val . in the present method we calculate the @xmath69 including the core contributions from @xmath115,{{\\bf r}})|\\psikn \\rangle ] .",
    "\\label{eq : qpgw}\\end{aligned}\\ ] ] note @xmath116,{{\\bf r}})$ ] is for entire density @xmath117 . as @xmath118 in eq .",
    "( [ eq : sigx ] ) can be divided between core  and val , we have @xmath119 . in this paper",
    ", we neglect the core  contribution to @xmath120 . in sec .",
    "[ sec : core ] we examine in some detail the contributions by shallow cores to correlation by including them in val using local orbitals , and will see that their contribution is small except for very shallow cores .    in short ,",
    "no important approximation is made other than the @xmath0 approximation itself ; and it is to the best of our knowledge the only implementation of @xmath0a that makes no significant approximations .",
    "results depend slightly on what kind basis set used to generate @xmath3 and @xmath4 , as we will show , and also on the tolerances in parameters used in the @xmath0-specific part of the calculation .",
    "lmto - based calculations presented here employ a widely varying set of basis functions , ranging from @xmath5320@xmath12190 orbitals per atom , as described in more detail below .",
    "they typically consist of a basis of _",
    "orbitals centered on each atom , some floating orbitals and sometimes local orbitals . in the si calculations local @xmath47 orbitals of either of @xmath8 character or of @xmath122 character were used , as we describe below . for the @xmath0 part of the calculation ,",
    "the si results shown below use parameters representative of the various system studied : lmto basis functions are re - expanded in plane waves to a cutoff of 3.3  a.u . in the interstitial region ,",
    "i.e. @xmath123  bohr@xmath124 in the second term of eq .",
    "( [ def : psiexp ] ) .",
    "the ipw part of the mixed basis used to expand @xmath125 , @xmath104 , and @xmath4 used a cutoff @xmath126  bohr@xmath124 ; the product basis part consisted of 90110 bloch functions / atom ( we use different product basis for @xmath127 and @xmath128 ) .",
    "augmentation sphere radii were chosen so that spheres approximately touched but did not overlap , and the product basis functions entering into the mixed basis @xmath129 in eqns .",
    "( [ eq : polf ] ) and ( [ eq : sigc ] ) were expanded to @xmath20=5 . in the calculation of eq .",
    "( [ eq : sigc ] ) the poles of @xmath3 were gaussian broadened by @xmath130=0.003 or 0.01  ry .",
    "these parameters correspond to rather conservative tolerances : tests at tighter tolerances in these parameters change the qpe by @xmath530.01  ev .",
    "( systematic checks were performed for each material studied . )",
    "the tetrahedron method was used for @xmath104 with a @xmath131 @xmath132-mesh ( doubling the number of points in the energy denominator ) except where noted . the same mesh is used to calculate @xmath104 and @xmath56 .",
    "this @xmath132 mesh is reasonably well converged , systematically overestimating conduction - band states by @xmath530.02  ev in si and similar semiconductors relative to the fully @xmath132-converged result.@xcite",
    "@xmath133x@xmath134 gap in si in @xmath0a as a function of the number of unoccupied states @xmath9 .",
    "* filled(yellow ) squares * : lapw @xmath0a taken from ku and eguiluz@xcite .",
    "the authors presented data only for @xmath135 .",
    "also , their data was given for the minimum gap , so we shifted their results by + 0.14  ev to estimate the @xmath136@xmath133x@xmath134 gap .",
    "some checks show that the shift should be @xmath530.14  ev , approximately independent of @xmath9 . *",
    "filled(green ) pentagons * : lmto results varying @xmath9 both @xmath3 and @xmath4 .",
    "lmto results were shifted by -0.02  ev to correct for incomplete @xmath132 convergence@xcite .",
    "the si 2@xmath47 was included in the valence using a local orbital ( the lapw calculation of ku and eguiluz did not ) .",
    "the total dimension of the lmto basis is 180 .",
    "results from the same basis are shown as filled(green ) pentagons in fig .",
    "[ fig : gapvsinversen ] , and also filled(green ) pentagons no .",
    "( 13 ) in fig .",
    "[ fig : gapvsbasis ] . * open triangles * : pp@xmath0 from ref .  ,",
    "which included the si @xmath8 levels as part of the valence , and in which @xmath4 was computed using the plasmon - pole approximation . * open circles * : lmto results varying @xmath9 in @xmath3 but not @xmath4 . ]    in fig .",
    "[ fig : gapconvergence ] , we show the @xmath136@xmath133x@xmath134 gap for si computed by eq .",
    "( [ eq : qpgw ] ) as a function of the number of unoccupied states @xmath9 in eqns .",
    "( [ eq : polf ] ) and ( [ eq : sigc ] ) : i.e. summation @xmath118 over unoccupied states is restricted to @xmath137 . fig .",
    "[ fig : gapconvergence ] depicts our main with pentagons ( si 2@xmath47 treated as val ) .",
    "it tracks well the all - electron results of ku and eguiluz  @xcite , which used an lapw method , except their data is @xmath530.05  ev less than ours .",
    "however , their results are limited to @xmath135 , which is not sufficient to analyze convergence for large @xmath9 .",
    "if one assumes the lapw converges with @xmath9 at the same rate as the lmto case , their best result with @xmath138 should be @xmath530.1  ev less than the converged value .",
    "indeed a very recent calculation of the same system by friedrich , schindlmayr , blgel and kotani  @xcite , based on lapw with an lda basis of @xmath53300 basis functions , showed @xmath9-convergence similar to lmto .",
    "tiago , ismail - beigi , and louie@xcite presented a pp@xmath0 calculation of some qpe in si , ge , and gaas where they included the higher - lying core states into the valence so as to assess the effect of the core .",
    "they monitored the rate of convergence in qpe with @xmath9 ; their data for si are shown as open triangles in fig .",
    "[ fig : gapconvergence ] .",
    "there are some similarities , but also two discrepancies :    ( )    for @xmath139 , the behavior is rather different .    in the asymptotic region @xmath140 ,",
    "the pp@xmath0 and lmto results converge at somewhat different rates .    in order to examine point ( i ) , we tried lmto calculations where @xmath4 is fixed ( i.e. @xmath9 is truncated only in eq .",
    "( [ eq : defg ] ) ) . this calculation ( open circles in fig .",
    "[ fig : gapconvergence ] ) tracks well the pp@xmath0 result for @xmath141 .",
    "this looks reasonable because the pp@xmath0 is combined with the plasmon - pole approximation , which satisfies the sum rule for @xmath142 for any @xmath9 ; thus @xmath4 converges rather quickly with respect to @xmath9 .",
    "however , the two lmto calculations show little difference in the asymptotic behavior , which means that it is controlled by @xmath9 in eq .",
    "( [ eq : sigc ] ) , as was already discussed by tiago et al .",
    "it can be seen that the @xmath9 dependence of either lmto calculation is slightly different than the pp@xmath0 result for both intermediate and large @xmath9 : the change in the @xmath136@xmath133x@xmath134 gap from @xmath143 to @xmath144 for pp@xmath0 is roughly twice the change obtained by the lmto method . as we noted in sec .",
    "[ sec : methodology ] , lmto - lda eigenvalues are very close to the full apw results in this energy range ( see fig .  [",
    "fig : sildabands ] ) .",
    "this indicates that the eigenfunctions are also precise .",
    "moreover , friedrich et al .",
    "@xcite compare lda - apw eigenvalues to an lapw+local orbitals method ; the three sets of eigenvalues ( apw and lmto+local orbitals , lapw+local orbitals ) are very close to one another . by contrast , the lda energy bands computed by either conventional lapw or pp methods correspond to apw eigenvalues far less well ; see ref .  .",
    "finally , the dependence on @xmath9 as computed by the lapw+local orbitals method is essentially similar to the present lmto results .",
    "when these observations are considered as a whole , they suggest that what discrepancy does exist between lmto+local orbitals ( or lapw+local orbitals ) and pp@xmath0 may be an artifact of the pseudopotential construction in the pp@xmath0 method .",
    "we can not rule out possible limitations to the present method , however .",
    "differences with ppgw are small in absolute terms . even though eigenvalues generated by lmto and lapw+local orbitals are very close to apw eigenvalues , eigenfunctions may be less well described . and even though the lmto and lapw hamiltonians are very different , the qpes are generated by a common @xmath0 code . if there is some limitation in the numerical procedure , it would be common to both lmto and lapw calculations .",
    "gap in si , as a function @xmath145 , where @xmath146 is the number of @xmath132-points in the full brillouin zone .",
    "the dependence on @xmath145 shown for @xmath147 is essentially same for all of the unoccupied qpes we examined .",
    "gaps for @xmath148=6 , @xmath148=5 , and @xmath148=4 , exceed the @xmath148=8 case by 0.02  ev , 0.04  ev , and 0.10  ev , respectively .",
    "we can also estimate what the @xmath149 gap would be by extrapolating the approximately linear dependence on @xmath145 to zero ( dashed line ) .",
    "the @xmath150 case apparently overestimates the converged result by 0.01  ev . ]",
    "it is also possible that the calculation by tiago et al .",
    "suffers from incomplete @xmath132-convergence .",
    "their pp@xmath0 used a @xmath151 @xmath132-mesh .",
    "@xmath132-convergence is mainly limited by divergent behavior for @xmath152 in eq .",
    "[ eq : sigx ] . to treat this divergence",
    ", we use the offset-@xmath153 method , which was originally developed by ourselves@xcite and is now used by other groups @xcite .",
    "it is essentially equivalent to techniques that treat the divergent part analytically , as is typically done by pp@xmath0 practitioners .",
    "[ fig : nkconvergence ] shows the dependence of @xmath147 gap on @xmath148 , but in general all of conduction bands shift nearly rigidly with changes in @xmath148 ( @xmath148 = number of linear divisions of the @xmath132-mesh in the brillouin zone ) .",
    "bandgaps are approximately linear in the reciprocal of the total number of points , @xmath145 .",
    "the figure shows that a @xmath151 @xmath132-mesh overestimates the @xmath132-converged gap by @xmath530.1  ev  @xcite .",
    "this may explain most of the remaining discrepancy between the pp@xmath0 calculations of tiago et  al . and the present results .    in sec .",
    "[ sec : core ] we analyze the dependence of qpes on the core treatment .",
    "proper treatment of the core is somewhat subtle@xcite , and we use the local orbitals for the analysis . because they are already nearly exact solutions of the lda for the states they constructed to represent , they minimally hybridize with other basis functions ; consequently any higher lying core  state can be readily be converted into a valence state with minimal perturbation of the lda basis .",
    "use of local orbitals enables us to investigate how different kinds of core contributions affect qpes in a well - controlled and systematic way .",
    "we show that differing treatments of the si @xmath8 core only slightly affect qpes ; similar results are found for other deep cores .",
    "a significantly larger dependence is apparently found using the pp@xmath0 method .",
    "gap in si , as a function of number of unoccupied states @xmath154 for a smaller basis ( squares ) and a larger basis ( pentagons ) .",
    "the latter are redrawn from fig .",
    "[ fig : gapconvergence ] .",
    "top horizontal scale shows an approximate relation between energy and @xmath9 in the large basis ( interpolated from levels at @xmath153 ) .",
    "right panel contains the same data but reverses the top and bottom horizontal scales .",
    "( had @xmath9 in the upper horizonatal axis been drawn for the small basis ( squares ) , the scale would be a little different : the last data point corresponds to @xmath155 instead of 120 . )",
    "inset compares convergence in x@xmath134 as a function of @xmath156 to a pp@xmath0 calculation that includes @xmath8 states in the valence  @xcite ( triangles ) and a pp@xmath0 calculation that does not  @xcite ( diamonds ) .",
    "lmto data were shifted by -0.02  ev to correct for incomplete @xmath132 convergence@xcite .",
    "the small - basis data ( squares ) in the right panel were further shifted by -0.01  ev@xcite to clarify how large- and small - basis data diverge as the energy increases .",
    ", title=\"fig : \" ]    gap in si , as a function of number of unoccupied states @xmath154 for a smaller basis ( squares ) and a larger basis ( pentagons ) .",
    "the latter are redrawn from fig .",
    "[ fig : gapconvergence ] .",
    "top horizontal scale shows an approximate relation between energy and @xmath9 in the large basis ( interpolated from levels at @xmath153 ) .",
    "right panel contains the same data but reverses the top and bottom horizontal scales .",
    "( had @xmath9 in the upper horizonatal axis been drawn for the small basis ( squares ) , the scale would be a little different : the last data point corresponds to @xmath155 instead of 120 . )",
    "inset compares convergence in x@xmath134 as a function of @xmath156 to a pp@xmath0 calculation that includes @xmath8 states in the valence  @xcite ( triangles ) and a pp@xmath0 calculation that does not  @xcite ( diamonds ) .",
    "lmto data were shifted by -0.02  ev to correct for incomplete @xmath132 convergence@xcite .",
    "the small - basis data ( squares ) in the right panel were further shifted by -0.01  ev@xcite to clarify how large- and small - basis data diverge as the energy increases .",
    ", title=\"fig : \" ]    here we study the convergence in qpes as the lmto basis set changes , retaining all the eigenfunctions for a given basis in the calculation ( @xmath9 encompasses all unoccupied states ) .",
    "a given lmto basis defines a finite hilbert space of eigenfunctions ; the @xmath0a is a well - defined procedure in that space , and we can study how the qpes change as the hilbert space is refined .",
    "this procedure corresponds more closely to analyses of basis set convergence common in other kinds of calculations ( e.g. lda and hartree - fock ) .",
    "we can also anticipate that it will be smoother than the @xmath9 truncation of sec  [ sec : nconvergence ] ; indeed this will turn out to be the case ( see especially fig .",
    "[ fig : gapvsbasis ] ) : the band gaps are insensitive to the choice of basis once a certain level of completeness is reached .",
    "it its also obviously true that the hilbert space depends on the choice of basis constructing it .",
    "therefore , the results presented here are specific to the lmto basis described in sec .",
    "[ sec : methodology ] , and in particular _ what kinds _ of orbitals are included , e.g. orbitals of @xmath49 or @xmath50 character , or local orbitals that correct the linearization inherent in most of the standard methods ( lmto , lapw , and the construction of a norm - conserving pp ) . by adding different kinds of orbitals we can identify how different parts of the hilbert space , ( most notably corrections to linearization common to most methods ) affect qpes . since the lmto basis is tailored to the crystal potential , the lda eigenfunctions converge more rapidly with the basis dimension than do plane - wave based basis sets@xcite . consequently we might expect a more rapid convergence in the @xmath0a qpes . on the other hand , by transformation to ,",
    "e.g. , wannier functions , it should be possible to design a generic scheme that exhibits similarly rapid convergence .    initially , we compare in fig .",
    "[ fig : gapvsinversen ] the dependence of the @xmath136@xmath133x@xmath134 gap in si on @xmath9 for two basis sets : one relatively small and another relatively large . the right panel of fig .",
    "[ fig : gapvsinversen ] compares the same data , but the horizontal scale corresponds the energy of state @xmath9 at @xmath153 .",
    "also in this panel , the small basis - data at small energy was artificially shifted down by 0.01  ev to make it easier to see how the two cases depend on energy.@xcite .",
    "the difference , initially 0.01  ev , increases by an additional 0.01  ev as the energy @xmath157 approaches @xmath158  ev . for higher energies , the discrepancy between the two increases more rapidly .",
    "this is because the ability of the small lmto basis to describe eigenvalues above @xmath159  ev begins to degrade .",
    "however , we can see that the gaps at the respective maximal @xmath9 ( i.e. all unoccupied states included ) are in good agreement .",
    "including all unoccupied states in a limited basis is a another kind of hilbert space truncation , but it is also well defined : use use the hilbert space of eigenfunctions basis consisting of lmto eigenfunctions and their products ( sec .",
    "[ sec : methodology ] ) , and apply the @xmath0a within that hilbert space .",
    "the lmto basis can efficiently choose the important part of the hilbert space tailored to the crystal potential .",
    "thus good agreement need not be some fortutitous artifact of this particular pair of the lmto basis sets , even though the maximal @xmath9 is small in light of a traditional @xmath9 cutoff analysis@xcite .",
    "indeed the @xmath9 cutoff of sec  [ sec : nconvergence ] may choose the hilbert space less well , especially since that kind of truncation is not smooth .",
    "below we present detailed analysis of the dependence on the basis set to justify the good agreement in fig .",
    "[ fig : gapvsinversen]@xcite : the band gaps are insensitive to the choice of basis once a certain level of completeness is reached .",
    "a at @xmath160 ( top ) , @xmath161 ( middle ) , and @xmath162 ( bottom ) in si relative to the valence band maximum , using different basis sets in the present fp - lmto .",
    "abscissa is the total number of basis functions @xmath163 .",
    "yellow diamonds are a minimal basis ( see text ) .",
    "all results depicted by fill circles contain no local orbitals .",
    "those depicted by filled ( empty ) squares or pentagons include the si @xmath8 ( si @xmath164 ) as local orbitals .",
    "see text for further description . ]",
    "[ fig : gapvsbasis ] shows results of a systematic study of the convergence in the first unoccupied qpe at @xmath153 , x , and l in si with progressively larger basis sets .",
    "lda eigenvalues are not shown because they are the same within @xmath165  ev for all cases ( 0.60  ev for x , 1.42  ev for l , 2.52  ev for @xmath153 ) .",
    "these data comprise very diverse basis sets , particularly for the lmto method which traditionally uses a minimal basis . some details concerning these sets help explain in what manner convergence is reached :        * filled(yellow ) diamonds ( 1 ) * includes _ spdfsp _ atom - centered functions , and is the only basis without floating orbitals .",
    "there are no local orbitals ; si 1@xmath46,2@xmath46,2@xmath47 are core .",
    "* filled(blue ) circles ( 2 ) and ( 3 ) * add floating orbitals of @xmath1 and of @xmath166 character , respectively .",
    "their effect is to cause qpes to _ decrease _ slightly relative to ( 1 ) .",
    "adding still more floating orbitals ( even large numbers of them ) shift qpes by @xmath530.01  ev .",
    "* other filled(blue ) circles ( 5 , 6 , 10 , 12 ) * include still more envelope functions comprised of a mixture of atom - centered functions and floating orbitals , but adding no local orbitals .    * filled(green ) square and open square ( 4 , 7 ) * correspond to ( 3 , 6 ) , respectively , but adding a local orbital ( green : si 2@xmath47 , open : si 4@xmath47 ) .",
    "when the @xmath8 is included as val , core  consists of si1@xmath46,2@xmath46 only .",
    "a local orbital of _ either _ si2@xmath47 or si4@xmath47 shifts qpes  in roughly equal but opposite directions .    *",
    "filled(green ) pentagon and open pentagon , ( 8,9,11,13 ) * include an additional si4@xmath48 local orbital .",
    "( 11 ) corresponds to ( 10)+(si2@xmath47 or si4@xmath47)+ si4@xmath48 .",
    "( 13 ) corresponds to ( 12)+ ... as well .",
    "( 8) is ( 6)+si4@xmath47+si4@xmath48 .",
    "the effect of si4@xmath48 is small .",
    "these points show in a compelling way that once the basis reaches a certain level of completeness , the change of qpe with further enlargement is very small .",
    "set ( 1 ) , which consists only of atom - centered functions , is somewhat incomplete except inside the augmentation spheres where the eigenfunctions are constructed out of linear combinations of @xmath51 . considering the open structure of zincblende",
    ", such a basis may be expected to be less complete in the interstitial .",
    "comparison basis sets without local orbitals ( circles ) with set ( 1 ) shows that this particular purely atom - centered basis is slightly deficient for reliable calculation of qpe , since the addition of floating orbitals induces a ( @xmath132-dependent ) reduction in the conduction band of @xmath167  ev .",
    "it is an open question whether a still more sophisticated atom - centered basis@xcite would be adequate to describe the interstitial .",
    "once the interstitial is reasonably complete ( @xmath168 sets ( 3 ) and higher ) , there is an almost negligible dependence on basis _ provided _ no orbitals are included that extend the linear method or alter how the core is treated .",
    "basis sets marked by a common symbol ( squares , circles , pentagons ) share essentially the same hilbert space in the _ augmentation _ regions ; only the basis set corresponding to the _ interstitial _ region changes .",
    "the variation is @xmath1690.01  ev for a wide range of basis sets@xcite .",
    "[ fig : gapvsbasis ] also gives us some insight to the limitations of the linear method .",
    "basis sets ( 3 ) and ( 4 ) , which differ only in how the si @xmath47 channel is treated inside the augmentation region , affect qpes more strongly than radically enlarging the hilbert space of the envelope functions  compare ( 3)@xmath133(4 ) and ( 3)@xmath133(12 ) .",
    "envelope functions affect only the interstitial ; they negligibly affect the hilbert space of the augmentation region .",
    "for the latter it is largely irrelevant how many envelope functions are used  and consequently the size of @xmath9 entering into eqns .",
    "( [ eq : polf ] ) and ( [ eq : sigc ] ) .",
    "what _ is _ relevant is the completeness of @xmath51 , and results are independent of basis dimension provided that _",
    "the entire _",
    "hilbert space is included_. said another way , the lmto method is by design reasonably complete over a certain energy window in the augmentation spheres , more or less independent of the envelope functions .",
    "a similar story may be told for the interstitial : sets ( 3 , 6 , 10 , 12 ) differ in the number of envelope functions by as much as a factor of three , but qpes are unchanged within @xmath1690.01  ev . qpes shift when @xmath51@xmath133@xmath170 or @xmath51@xmath133@xmath171 , essentially independently of the number of envelope functions ( 3@xmath1334 , 6@xmath1337 , 10@xmath13311 , 12@xmath13313 ) .",
    "l@|*3@r@|*3@r data type & @xmath172 & @xmath173 & @xmath174 & @xmath153 & l & x & 5 cdo expt+0 & & & & 0.84 & & + lda & 59 & 18 & 12 & -0.53 & 4.26 & 3.58 + @xmath0 & 59 & 18 & 12 & 0.14 & 5.18 & 4.97 + & 59 & 50 & 12 & 0.10 & 5.14 & 4.92 + & 82 & 66 & 12 & 0.10 & 5.16 & 4.89 + & 82 & 82 & 12 & 0.10 & 5.16 & 4.88 + & 59 & 18 & 3 & -0.01 & 5.05 & 4.78 + & 59 & 50 & 3 & -0.06 & 5.01 & 4.73 + & 82 & 66 & 3 & -0.02 & 5.05 & 4.73 + & 82 & 82 & 3 & -0.02 & 5.06 & 4.74 + & 5 ge expt+0.10 & & & & 1.00 & 0.88 & 1.20 + lda & 50 & 18 & 10 & -0.12 & 0.07 & 0.65 + @xmath0 & 50 & 18 & 10 & 0.80 & 0.65 & 0.94 + & 68 & 18 & 10 & 0.84 & 0.68 & 0.97 + & 82 & 50 & 10 & 0.83 & 0.67 & 0.96 + & 82 & 82 & 10 & 0.82 & 0.67 & 0.96 + & 5 gaas expt+0.11 & & & & 1.63 & 1.96 & 2.11 + lda & 42 & 18 & 6 & 0.34 & 0.86 & 1.34 + @xmath0 & 42 & 18 & 6 & 1.44 & 1.68 & 1.79 + & 68 & 18 & 6 & 1.46 & 1.69 & 1.79 + & 82 & 50 & 6 & 1.44 & 1.66 & 1.77 + & 82 & 82 & 6 & 1.43 & 1.66 & 1.77 + & 82 & 82 & 11 & 1.43 & 1.68 & 1.81 +    table [ tab : gapvsbasis ] shows three other materials ( cdo , ge , and gaas ) .",
    "we can see ( 1 ) rapid convergence in qpes as the basis is enlarged for a _",
    "fixed _ set of augmentation functions ; and ( 2 ) extensions to a linear augmentation affect qpes in an manner approximately independent of the total dimension of the hamiltonian .",
    "( in gaas , both @xmath175 and @xmath176 must be included as val . if not , significant errors result@xcite ) .",
    "we have tested a number of other materials as well , and these trends appear to be rather general .",
    "as might be expected , the number of basis functions needed to make the hilbert space reasonably complete depends somewhat on the elements involved .",
    "the heavier atoms have larger radii and consequently slower @xmath20-convergence in the number of envelope functions needed ; also @xmath48 orbitals often play an important role .",
    "more orbitals are required to make the basis complete when heavier atoms are involved .",
    "as noted , the linear @xmath51 hilbert space is already reasonably complete in the case of si .",
    "but this is not true in general : oxides and nitrides form a materials class where the effect is significantly larger .",
    "cdo is one such example ( cdo forms in the nacl structure ; the valence band maximum falls at l and the conduction band minimum falls at @xmath153 . )",
    "as happens for si , there is a weak dependence on basis when the number of envelope functions is changed and the hilbert space of the augmentation is held constant . but",
    "the qpes change by @xmath177  ev when the o 3@xmath47 and cd @xmath178 states are added , as table  [ tab : gapvsbasis ] shows .",
    "( in this particular case it is the o @xmath164 contribution that is dominant ; however , cases arise when the contributions from high - lying @xmath48 or @xmath49 orbitals can be of order @xmath179  ev .",
    "nio is such a case@xcite . )",
    "the inset of fig .",
    "[ fig : gapvsinversen ] shows some pp@xmath0 results for reference .",
    "based on the observation that cutoff in the hilbert space should be important , pp@xmath0 data by tiago et al . should be extrapolated to @xmath180 because they used a very large lda basis",
    "in a series of papers , shirley and co - workers analyzed the effects of the core on qpe in atoms ( shirley , mits and martin , ref .  , shirley and martin , ref .  ) semiconductors ( shirley , zhu and s. g. louie  @xcite ) within the pseudopotential framework .",
    "approximate core contributions to both eq .",
    "( [ eq : polf ] ) and ( [ eq : sigc ] ) were evaluated .",
    "they also compared pseudopotentials constructed from both lda exchange and from hartree - fock ( hf ) exchange for atoms and molecules@xcite , and incorporated pseudopotentials of both types in studying core effects@xcite .",
    "they found sizable shifts in qpe in si , and rather dramatic and @xmath132-dependent shifts in ge and gaas .",
    "these analyses highlight the importance of core effects . however , the decomposition of the various core contributions in ref .",
    "is somewhat involved , and it is rather closely tied to the pseudopotential construction that was a part of their implementation .",
    "this makes it a little difficult to disentangle the various contributions .",
    "here we examine contributions from the shallowest cores to @xmath181 within the framework of our @xmath0 .",
    "as we noted , all the eigenfunctions are divided into two groups core  and val  as explained in sec .",
    "[ subsec : allgw ] . using local orbitals",
    "we can represent the shallowest cores in val . to distinguish true core effects from artifacts of implementation@xcite",
    ", we include these cores in the valence with local orbitals and treat them in a special way , as described below .",
    "we denote such eigenfunctions as _ core _ , and the rest as _ val_. thus we distinguish three kinds of orbitals : core , _ core _ , and _ val _ : @xmath182{\\tr{\\hbox{all eigenfunctions } } }    { \\pstree{\\tr{{{\\rm{core } } } } } { }     \\pstree{\\tr{{{\\rm{val } } } } }       { \\pstree{\\tr{{{\\it{core } } } } } { }        \\pstree{\\tr{{{\\it{val } } } } } { }    } } \\label{eq:}\\end{aligned}\\ ] ] in si , for example , we use : core=@xmath183 , _ core_=@xmath184 and _ val_=@xmath185 .",
    "because the _ core _  states are well separated from higher lying states , @xmath3 can be partitioned into @xmath186 .",
    "@xmath187 is always calculated from the entire @xmath3 , while @xmath181 is calculated from _",
    "core _  and _ val _  only ( we do not consider any case where some portion of the self - energy is supplied by the lda ) : @xmath188 , where @xmath189-v$ ] , and @xmath104 is calculated from @xmath190 .",
    "thus _ core_states contribute to @xmath181 directly through @xmath3 in @xmath191 , and also through @xmath192 .",
    "we resolve these contributions ; that is , we calculate @xmath181 in one of four ways :    ( _ _ )    neglect the _ core _",
    "contribution to @xmath181 entirely : i.e. @xmath193-v)$ ] , where @xmath194 $ ] means that @xmath104 is calculated from @xmath195 only .",
    "we denote this as `` exchange - only _ core _ '' .",
    "neglect the _ core _  contribution to screening : @xmath196-v)$ ] .",
    "neglect the _ core _  contribution to @xmath3 : @xmath197-v)$ ] .",
    "@xmath198-v)$ ] : there is no distinction between _ core _  and _ val _  states .",
    "l@|@r@rrr@rrr@rrr@rrr & @xmath199 & 3 @xmath200 $ ] & 3 @xmath201 $ ] & 3 @xmath202 & 3 @xmath203 & & @xmath153 & l & x & @xmath153 & l & x & @xmath153 & l & x & @xmath153 & l & x si & -89.6 & 3.17 & 2.09 & 1.14 & 3.17 & 2.09 & 1.14 & 3.17 & 2.06 & 1.15 & 3.16 & 2.02 & 1.11 ge & -24.7 & 0.98 & 0.74 & 0.98 & 0.96 & 0.73 & 0.95 & 0.88 & 0.71 & 0.99 & 0.84 & 0.68 & 0.97 gaas & -14.8 & 1.65 & 1.83 & 1.86 & 1.63 & 1.82 & 1.85 & 1.54 & 1.75 & 1.83 & 1.46 & 1.69 & 1.79 mgo & -71.4 & 7.31&10.55&11.62 & 7.36&10.56 & 11.62 & 7.30&10.55&11.60 & 7.36&10.55&11.60    table [ tab : corecontr ] shows that the difference between exchange - only @xmath204 and @xmath0 @xmath205 approximations to core treatment is small in si ( @xmath530.03  ev for @xmath162 ) .",
    "as expected , the adequacy of an exchange - only core depends on how deep the core is . the exchange - only approximation for shallow cores , such as the ga @xmath175 and in @xmath176 , and the highest lying @xmath47 core in the column i ( na , k , rb ) and column iia alkali metals ( mg , ca , and sr ) , is rather crude .",
    "it is interesting that the core contributions to @xmath104 and to @xmath3 are _ not _ always additive .",
    "the difference between @xmath206 and @xmath205 is in general rather small ; that is , inclusion of _ core _  contributions of @xmath104 alone is sufficient to bring qpe results within 0.05  ev of the full results in table  [ tab : corecontr ] except for the very shallow ga 3@xmath48 channel . for moderately deep cores ,",
    "exchange - only treatment @xmath204 is generally adequate , as aryasetiawan suggested .",
    "a rough rule of thumb seems to be : for cores whose total charge @xmath207 outside the augmentation radius is less than 0.01 electrons , exchange - only treatment of them results in errors @xmath530.1  ev or less for the lowest excited states .",
    "( this radius may be taken as approximately half the nearest - neighbor bond length ) .",
    "inclusion of core contributions to @xmath104 can significantly increase the computational cost ( in the si case , leaving out the 2@xmath47 contribution to @xmath104 reduces the computational cost by @xmath5340% ) .",
    "the relative smallness of corrections to exchange - only treatment , and the observation that core contributions to @xmath104 alone are adequate for all but the most shallow cores , suggests that a simple approximate inclusion of core contributions to @xmath104 , eq .  ( [ eq : polf ] ) , should be adequate for all but the most shallow cores such as the ga @xmath175 .",
    "( fleszar and hanke proposed a construction for pseudopotentials when core states are not pseudized@xcite . )",
    "supposing the core were confined to the augmentation sphere at site @xmath16 , we can eliminate all contributions to the matrix element @xmath208 except from the product - basis contribution at @xmath16 . since also the augmented part of @xmath209 depends rather weakly on @xmath29 we can neglect the @xmath29 contribution to the eigenfunctions and assume that @xmath210 only depends @xmath211 , @xmath118 , @xmath212 , or @xmath213 through the coefficients , @xmath214 .",
    "moreover , the core level energy is large and negative , and nearly independent of @xmath212 or @xmath211 .",
    "since the dominant contributions to @xmath104 will come from coupling to low - lying states , we can approximate @xmath215 by a constant , e.g. @xmath216 .",
    "these approximations are all modest but can vastly simplify the computation of @xmath217 .    the fact that the core spills out slightly from the augmentation region needs to be taken into account@xcite .",
    "this can readily be accomplished by integrating the core and corresponding valence @xmath218 to a larger radius , and orthogonalizing @xmath218 to the core .",
    "checks show that the adjustment to @xmath219 is small unless the core is very shallow , in which case the core should be treated as a valence state .",
    "when the highest cores are put explicitly into the valence as tiago et al .",
    "did , there is reasonable agreement between pp@xmath0 and our results for @xmath1 semiconductors .",
    "comparison with the paper of tiago et al . to table  [ tab : corecontr ] below shows that there is agreement at the @xmath530.1  ev level in si@xcite and similar agreement is found for gaas and ge , with the pp@xmath0 results systematically higher than our results by @xmath530@xmath1210.1  ev .",
    "similarly , fleszar and hanke@xcite calculated qpes in the @xmath0a for a variety of ii - vi semiconductors , including the highest @xmath46 and @xmath47 cores in the valence .",
    "their values are also in reasonable agreement with results presented in table  [ tab : gladgaps ] ( below ) , though the pp@xmath0 data are systematically higher by @xmath530.0 - 0.2  ev .",
    "( part of the discrepancy can be traced to contributions from high - lying @xmath48 states , which are included in the present calculation using local orbitals . ) even when the high - lying @xmath46 and @xmath47 core states are included explicitly in the valence , it still seems to be the case that pp@xmath0 band gaps are systematically slightly larger ( by @xmath530.1  ev ) in semiconductors than our @xmath0 predict .",
    "materials involving transitions metals are rather more complicated . in a recent pp@xmath0 calculation ,",
    "marini , onida and del sole analyzed the qp valence bands of cu@xcite , comparing in some detail the occupied @xmath48 bands to photoemission experiments .",
    "the lda places the position of these levels approximately 0.5  ev closer to @xmath43 than the experiments show .",
    "the authors find that the @xmath48 bands narrow and shift downward by approximately 0.5  ev , bringing the pp@xmath0 @xmath48 bands into excellent agreement with photoemission experiments .",
    "they report that the pp@xmath0 results depend rather dramatically on the treatment of the cu core @xmath220 and @xmath164 levels : that it is necessary to include both states explicitly in the valence to obtain reasonable results .",
    "they found that the correlation contribution @xmath221 from these states shifts the @xmath48 bands downward @xmath530.5  ev .    we conducted a similar calculation using the present all - electron @xmath0 , and find a very different result . in our case , the @xmath0 correction to the lda @xmath48 bands is small  between 0 and 0.1",
    "ev . moreover , qpes are essentially independent of how the cu @xmath164 state is treated : the @xmath175 levels change by less than 0.05  ev when the cu @xmath164 state is explicitly included in the valence ( using a @xmath164 local orbital ) , as compared to being treated as core at the exchange - only level .",
    "the cu @xmath164 state is rather deep , and the weak dependence on correlation contributions from it is consistent with the rule of thumb indicated above : @xmath222  electrons ; @xmath223  ev . in the cu case",
    ", it appears likely that the main discrepancy between pp@xmath0 and our @xmath0 ( whether @xmath48 bands shift by 0.5  ev or not ) originates in the discrepancies in @xmath221 .",
    "in ref .   delaney et al . argued that @xmath0a based on the lda eigenfunctions and eigenvalues , is an adequate ( or better ) approximation than self - consistent @xmath0 .",
    "it is apparently the case that self - consistency worsens agreement with experiment for the be atom .",
    "moreover , holm and von barth  @xcite found that the valence bandwidth of the homogeneous electron gas is considerably worsened by self - consistency ; similarly a self - consistent @xmath0 calculation ku and eguiluz resulted in an overestimate of the valence bandwidth in ge@xcite .",
    "thus , self - consistency of this type has shortcomings .",
    "on the other hand , even in simple materials such as @xmath1 semiconductors , @xmath0a bandgaps based on lda eigenvalues and eigenfunctions are _ always _ underestimated when properly calculated @xcite .",
    "the @xmath0a based on lda is evaluated as a perturbation relative to lda ; thus the band gap can be poor if the lda itself is poor .",
    "thus , some kind of self - consistency is necessary to reduce the dependence on the starting point .    in this section ,",
    "we consider three points about the @xmath0a based on lda , eq .",
    "( [ eq : e1shot ] ) :    ( )    * use of the @xmath2 factor*. we show that using @xmath2=1 in eq .",
    "( [ eq : e1shot ] ) is a way to include partial self - consistency , and it should be a better approximation than including the @xmath2 factor .    *",
    "off - diagonal @xmath56*. eq .  ( [ eq : e1shot ] ) is a perturbation treatment that involves only the diagonal matrix element of @xmath56 .",
    "we consider the effect of the full @xmath56 in a variety of systems analyzing how the adequacy of @xmath0a is dependent on the adequacy of lda .",
    "even @xmath0a with @xmath2=1 fails for cases when the starting lda is poor .    *",
    "band - disentanglement problem .",
    "* even when lda eigenfunctions are reasonable , if eigenvalues are wrongly ordered the perturbation treatment can have important adverse consequences .",
    "let us consider a partial kind self - consistency where only eigenvalues are updated : both eigenfunctions and @xmath4 are unchanged from the lda .",
    "this is a little different from the customary usual eigenvalue - only self - consistency , where eigenfunctions are frozen but @xmath4 is updated . updating eigenvalues widens semiconductor bandgaps .",
    "this reduces the screening , which causes @xmath4 to increase , which in turn cause gaps to increase still more .",
    "thus we expect that results from such the kind of partial self - consistency we are considering here should fall somewhere between the usual one - shot @xmath0 and the usual eigenvalue - only self - consistency .",
    "partial self - consistency , while incomplete , should result in better qpes than the standard 1-shot @xmath0 , since eigenvalues shift in the right direction .",
    "appendix [ appendix : z1 ] evaluates how eq .",
    "( [ eq : e1shot ] ) gets modified for a model two - level system .",
    "the result is that this kind of self - consistency can be approximately realized by putting @xmath224 in eq .",
    "( [ eq : e1shot ] ) .",
    "a different justification for omitting the @xmath2 factor emerged from a paper of niquet and gonze@xcite , who calculated the interacting bandgap energy ( within rpa ) to obtain a correction to the kohn - sham gap .",
    "they found that the difference is essentially eq .",
    "( [ eq : e1shot ] ) with @xmath2=1 .",
    "finally , a further justification for using @xmath2=1 is discussed in chapter 7 of ref .  .",
    "@xmath2=1 corresponds to the rayleigh - schrdinger perturbation , @xmath2 with eq .",
    "( [ zfactor ] ) to the brillouin - wigner perturbation .",
    "it shows the @xmath2=1 scheme should be better for the frlich hamiltonian mahan analyzed .    .",
    "fundamental gap , in ev .",
    "( for gd , qpe correspond to the position of the majority and minority @xmath49 levels relative to @xmath43 ; for cu qpe corresponds to the @xmath48 level . )",
    "low temperature experimental data were used when available .",
    "qpes in the `` @xmath0 '' column are calculated with usual @xmath0a eq .",
    "( [ eq : e1shot ] ) and eq .",
    "( [ eq : defzfac ] ) . in the",
    "`` @xmath2=1 '' column the @xmath2 factor is taken to be unity . in the `` @xmath225 '' column",
    "the off - diagonal parts of @xmath56 are included in addition to taking @xmath2=1 .",
    "@xmath132-meshes of @xmath226 @xmath132 and @xmath131 were used for cubic and hexagonal structures , respectively ( symbol @xmath227 indicates the wurtzite structure ) .",
    "@xmath0 calculations leave out spin - orbit coupling and zero - point motion effects .",
    "the former is determined from @xmath228 , where @xmath229 is the spin splitting of the @xmath230 level ( in the zincblende structure ) ; it is shown in the `` @xmath228 '' column .",
    "contributions to zero - point motion are estimated from table 2 in ref .   and are shown in the `` zp '' column .",
    "the `` adjusted '' gap adds these columns to the true gap , and is the appropriate quantity to compare to @xmath0 . [ cols=\"<,<,^,<,<,^,<,<,^ \" , ]     the calculations in table  [ tab : gladgaps ] support the argument that using @xmath2=1 is a better approximation than including @xmath2 : semiconductor bandgaps are in significantly better agreement with experiment .",
    "they continue to be smaller than experimental values , which can be qualitatively understood as follows .",
    "using @xmath2=1 corresponds to updating @xmath3 , but leaving @xmath4 determined from the lda eigenfunctions and eigenvalues . because the gap is underestimated in the construction of @xmath104 and @xmath4 , @xmath104 is overestimated so that @xmath4 is screened too strongly ; thus @xmath56 is too small .",
    "it is interesting , however , that qpes evaluated with @xmath2=1 can be rather good at times because of a fortuitous cancellation of errors .",
    "we can refine self - consistency by updating @xmath4 in a manner similar to the updating of @xmath3 : that is using eigenvalues from eq .",
    "( [ eq : e1shot ] ) in the calculation of @xmath104 .",
    "however , @xmath68 computed in the rpa @xmath231 , omits excitonic effects .",
    "inclusion of electron - hole correlations to @xmath104 ( via e.g. , ladder diagrams ) increases @xmath232 for @xmath233 in the vicinity of the gap for semiconductors .",
    "there is a concomitant increase in @xmath234 for @xmath235 , as is evident by the kramers - kronig relations ; see e.g. , ref .  .",
    "errors resulting from the neglect of excitonic contributions to @xmath68 partially cancel errors resulting from lda eigenvalues , as shown by arnaud and alouani@xcite .",
    "thus , @xmath4 calculated from lda eigenvalues is not so bad in many cases because of this cancellation .",
    "often @xmath236 calculated from the lda eigenvalues is better than @xmath236 calculated from lda eigenvalues shifted by a scissors operator to match the experimental band gap ( see table iii in ref .  ) .",
    "this cancellation means that @xmath0(@xmath2=1 ) can be often be rather good , since @xmath4 itself is also better than what would be obtained from ( eigenvalue ) self - consistency .",
    "table  [ tab : gladgaps ] shows that the fundamental gap for @xmath237 is quite good for mostly - covalent semiconductors such as si or gaas , but that the agreement deteriorates as the ionicity increases .",
    "the usual @xmath0a in eq .",
    "( [ eq : e1shot ] ) does not include the off - diagonal contribution of @xmath6 .",
    "a simple way to take into account the contribution off - diagonal parts is to replace the energy - dependent matrix @xmath56 with some static hermitian matrix @xmath238 as in the following , and to solve the eigenvalue problem , replacing @xmath239 in the lda hamiltonian with this potential .",
    "we take @xmath240_{ij}+{\\rm re}[\\sigma(\\ej)]_{ij } } \\right\\ }         \\langle\\psi_j| , \\label{eq : veff}\\end{aligned}\\ ] ] for @xmath56 . here re signifies the hermitian part , the eigenvalues @xmath241 and the eigenfunctions @xmath242 are in lda .",
    "this @xmath238 is used in our qp self - consistent @xmath0 method  @xcite .",
    "this @xmath238 retains the diagonal part contribution as in eq .",
    "( [ eq : e1shot ] ) ( we now consider @xmath2=1 case ) . from the perspective of the qp self - consistent @xmath0 method , including the off - diagonal @xmath56 corresponds to the first iteration , and the lda corresponds to the 0th iteration .",
    "table [ tab : gladgaps ] shows how the fundamental gap is affected by the off - diagonal parts of @xmath238 for selected semiconductors .",
    "because the semiconductor eigenfunctions and density are already rather good , the off - diagonal contributions are small .",
    "contributions from the off - diagonal part of @xmath238 significantly increase when eigenfunctions have significant @xmath48 character ( see srtio@xmath243 and scn in table  [ tab : gladgaps ] ) . for correlated systems",
    "the effects can be rather dramatic ; see ref .",
    "how the qpes are affected by the off - diagonal parts of @xmath56 in ceo@xmath244 .",
    "in general , @xmath0a errors are rather closely tied to the quality of lda starting point . in the covalent",
    "@xmath1 semiconductors c , si and ge , @xmath0 gaps are rather good for @xmath2=1 . in the series zn(te ,",
    "se , s , o ) , the deviation between the lda and experimental gap steadily worsens , and so does the @xmath0 gap . for zno , and",
    "even more so in cubr , the @xmath0 gap falls far below experiment . for these simple @xmath1 materials ,",
    "errors are related to their ionicity , which can be seen qualitatively as follows .",
    "as ionicity increases , the dielectric response becomes smaller ; consequently the nonlocality missing from the lda exchange - correlation potential@xcite becomes progressively more important .",
    "roughly speaking , a reasonable picture of electronic structure in @xmath1 systems resembles an interpolation between the lda , which has no nonlocality in the exchange and underestimates gaps , and hartree - fock , which has nonlocality but wildly overestimates gaps because the nonlocal exchange is not screened .",
    "as ionicity increases the gap widens and the dielectric function decreases . as the screening is reduced the lda becomes a progressively worse approximation .",
    "thus , the lda is not an adequate starting point for @xmath0 in the latter cases .",
    "discrepancies between @xmath0 and experiments become drastic when electronic correlations are strong .",
    "the @xmath0a band gap for the antiferromagnetic - ii nio is far from experiment , and moreover the conduction band minimum falls at the wrong place ( between @xmath153 and x @xcite ) . as table  [ tab : gladgaps ] shows , the lda puts @xmath49 levels in gd too close to @xmath43 .",
    "@xmath0a results are only moderately better : shifts in the gd @xmath49 level relative to the lda are severely underestimated ( see table  [ tab : gladgaps ] ) .",
    "@xmath0 based on the lda fails even qualitatively in coo : it predicts a metal with @xmath43 passing through an itinerant band of @xmath48 character . in this case , the @xmath0a gives essentially meaningless results . to get reasonable results",
    "it is essential to apply the @xmath0a with a starting point that already has a gap .",
    "to get band gap for coo in the single band picture , a non - local potential which breaks time - reversal symmetry is required , something which is not built into the local potential of the lda .",
    "similar problems occur with eras : the lda predicts a very narrow minority @xmath49 band straddling @xmath43 , whereas in reality the minority @xmath49 manifold is exchange - split into several distinct levels well removed from @xmath43@xcite . @xmath0a",
    "shifts the minority @xmath49 levels only slightly relative to the lda : the entire @xmath49 manifold remains clustered in a narrow band at the fermi level , appearing once again qualitatively similar to the lda .    generally speaking , the @xmath0a ( even @xmath0a(z=1 ) ) is reasonable only under limited circumstances  when the lda itself is already reasonable .",
    "$ ] for small @xmath132 within the @xmath0a , using @xmath2=1 .",
    "spin orbit coupling was omitted .",
    "three approximations are compared : lda ( dashed blue line ) , @xmath0 in the diagonal-@xmath56 only approximation , eq .",
    "( [ eq : e1shot ] ) ( black line with circles ) , and @xmath0 with @xmath56 computed according to eq .",
    "( [ eq : veff ] ) ( solid green line ) .",
    "in all three cases the three states of @xmath47 character ( @xmath245 symmetry ) form the valence band maximum ; this was taken to be the energy zero .",
    "the lda predicts the conduction band , the @xmath246 state of @xmath46 character , to be slightly negative , causing the energy bands to be wrongly ordered at @xmath153 . for @xmath247 , the @xmath245 state of @xmath248 symmetry couples to the @xmath246 state , and the two repel each other . both kinds of @xmath0 put @xmath249 at approximately the correct position , 1  ev .",
    "however , the diagonal - only @xmath0 must follow the topology of the lda : the eigenvectors are unchanged from the lda .",
    "therefore the band starting out at @xmath249 sweeps downward , while the @xmath248 band starting out at @xmath250 sweeps upward , and the two bands cross near @xmath251 .",
    "when the off - diagonal parts of @xmath56 are included , these two bands repel each other as they should . ]    even for the simple @xmath1 semiconductors , there can be a `` band disentanglement problem '' as a consequence of the diagonal - only approximation . at times the lda orders energy levels wrongly : in hcp co , for example , it inverts the order of the minority @xmath252 and @xmath253 levels , which correspond to states of @xmath254 and @xmath255 symmetry in the fcc structure .",
    "wrong ordering of levels is a particularly serious difficulty for narrow - gap semiconductors such as ge , inas , insb , and inn .",
    "because the lda underestimates bandgaps , the energy band structure around @xmath153 has an inverted structure : the @xmath46-like conduction band of @xmath256 symmetry ( labeled as @xmath246 in the homopolar case ) incorrectly falls below the @xmath47-like states of @xmath245 symmetry .    when the @xmath0a is evaluated from eq .",
    "( [ eq : e1shot ] ) , the energy bands retain the same connectivity as in the lda , as fig .",
    "[ fig : bands - ge - smallk ] shows . consequently the conduction band has a nonsensical negative mass near @xmath153 , and it crosses with one of the valence bands .",
    "the diagonal - only approximation can not make ge an insulator in principle , even though the levels are properly ordered at @xmath153 .",
    "this problem is avoided if the off - diagonal parts of @xmath56 are included , as fig .",
    "[ fig : bands - ge - smallk ] shows .",
    "the conduction - band effective mass in the latter case is computed to be @xmath257 , in good agreement with a value of @xmath258 estimated from magnetopiezoreflectance spectra@xcite .",
    "this shows that the off - diagonal contributions of @xmath56 are reasonably well described by eq .",
    "( [ eq : veff ] ) .",
    "to conclude , we have analyzed various possible sources of error in implementations of the _ _",
    "gw__a , using calculations based on an all - electron method with generalized linear muffin tin orbitals as a basis .",
    "we analyzed convergence in qpes with the number unoccupied states @xmath9 : the rate of convergence for intermediate @xmath9 ( where the lmto energy bands were shown to precisely replicate apw bands ) , was qualitatively similar to , but roughly twice that of a pp analysis by tiago , ismail - beigi , and louie@xcite .",
    "on the other hand , it closely tracked the convergence calculated by an lapw+local orbitals method , which had a very similar lda band structure .",
    "more generally , our @xmath0a that properly subtracts @xmath259 calculated from the full density are in reasonable agreement with each other @xcite ; those that subtract valence density only@xcite are also in reasonable agreement for cases such as si and sic where the cores are sufficiently deep .",
    "our own experience suggests that the lda treatment of core levels , where qpe are computed from eq .",
    "( [ eq : qpgwnc ] ) , will be problematic for @xmath0@xcite unless the cores are very deep .",
    "since a pp construction is an approximation whose justification is grounded in an all - electron theory , we should expect @xmath0 calculations based on an lda pp should be similarly problematic .",
    "there is apparently a significant dependence on how cores are treated in pp implementations@xcite , even in si and cu with their deep 2@xmath47 and 3@xmath47 cores .",
    "we then presented a new analysis of convergence that is of particular importance for minimal - basis implementations , and argued that measuring convergence in the traditional cutoff procedure  by number of unoccupied states @xmath9 as given in figs .",
    "[ fig : gapconvergence ] and [ fig : gapvsinversen]are not particularly meaningful for a minimal basis .",
    "we presented an alternative truncation of the full hilbert space of eigenfunctions , namely to use the entire hilbert space of a relatively small basis .",
    "we showed that a suitably constructed minimal basis is sufficient to precisely describe the @xmath0a qpe within 1 ry or so of the fermi level , and that this kind of cutoff procedure seems to be more efficient than the traditional @xmath9 cutoff of a large basis .",
    "we also showed that traditional linearization of basis functions , either explicit in an all - electron method or implicit through the construction of a pseudopotential , result in errors approximately independent of the size of basis .",
    "addition of local orbitals to extend the linear approximation results in modest shifts in @xmath1 nitride and oxide compounds , and shifts of order 1 - 2  ev in transition - metal oxides .",
    "we analyzed core contributions to the self - energy , and showed that an exchange - only treatment of the core is adequate in most cases .",
    "for all but the most shallow cores ( such as na @xmath8 and ga @xmath175 ) , we showed that it is sufficient to include the core contribution to the polarization only ; an approximate and rather painless implementation was suggested .",
    "these results can provide a framework for improved treatment of the core within a pseudopotential approximation .    finally , we considered the adequacy of @xmath0a based on the lda , for different kinds of materials , and also eq .",
    "( [ eq : e1shot ] ) as an approximation to the @xmath0a .",
    "we presented logical and numerical justifications that using @xmath2=1 generally gives better band gaps in insulators .",
    "in general inclusion of the off - diagonal part of @xmath56 and some kind of self - consistency is essential to make the @xmath0a a universally applicable and predictive tool . taking into account both theoretical and practical aspects , the quasi - particle self - consistent @xmath0 scheme we have proposed  @xcite has the potential to be an excellent candidate for such a tool : it obviates some of the difficulties seen in the standard self - consistency , it no longer depends on the lda , and it appears to predict qpes in a consistently reliable way for broad classes of materials .",
    "this work was supported by onr contract n00014 - 02 - 1 - 1025 .",
    "s.  f. was supported by doe , bes contract no .",
    "de - ac04 - 94al85000 .",
    "we thank the ira a. fulton high performance computing initiative for use of their computer facilities .",
    "let us consider a limited self - consistency within @xmath0a as follows .",
    "we restrict self - consistency as follows :    1 .",
    "we make only the qpe self - consistent .",
    "eigenfunctions are constrained to be the lda eigenfunctions .",
    "@xmath4 is assumed to be fixed .",
    "thus only the eigenvalues entering into @xmath3 are made self - consistent .    under these assumptions",
    ", we can show that qpe are rather well approximated by eq .",
    "( [ eq : e1shot ] ) with @xmath2=1 . to illustrate it ,",
    "consider a two - states model whose lda eigenvalues and eigenfunctions are given by @xmath261 , and @xmath262 , and the fermi energy falls between these states : @xmath263 .",
    "then the lda green s function is @xmath264 after the limited self - consistency is attained , we will have eigenvalues : @xmath265 where @xmath266 is given by @xmath267)- v^{\\rm{lda}}_{\\rm{xc}}|\\psi_1\\rangle .\\end{aligned}\\ ] ] there is a similar equation for @xmath268 .",
    "note that @xmath269)$ ] is calculated in @xmath0a from @xmath3 of eq .",
    "( [ eq : gsc ] ) at @xmath266 .    as we can expect that @xmath4 is dominated by diagonal terms @xmath270 and @xmath271 , we neglect other matrix elements of @xmath272 .",
    "then @xmath56 becomes @xmath273)|\\psi_1\\rangle & = & { \\rm re } \\int \\langle\\psi_1| i g(e_1+\\omega ' ) w(\\omega')|\\psi_1\\rangle \\,d \\omega'\\nonumber\\\\ & \\approx & { \\rm re } \\int \\frac{iw_1(\\omega ' ) \\,d \\omega'}{e_1 + \\omega ' -",
    "e_1 -i\\delta } \\nonumber\\\\ & = & { \\rm re } \\int \\frac{iw_1(\\omega ' ) \\,d \\omega'}{\\varepsilon_1 + \\omega ' - \\varepsilon_1 -i\\delta } \\nonumber\\\\ & = & { \\rm re } \\langle\\psi_1|\\,\\sigma\\left(\\varepsilon_1,[g^{\\rm{lda}}]\\right)\\,|\\psi_1\\rangle \\label{eq : sigmawithoutz}\\end{aligned}\\ ] ] a similar equation applies for @xmath268 .",
    "the energy shift @xmath274 entering into the evaluation @xmath56 is exactly compensated by the energy shift in @xmath275 . or equivalently using @xmath2=1 is an approximate way to obtain self - consistency .",
    "( [ eq : sigmawithoutz ] ) corresponds eq .",
    "( [ eq : e1shot ] ) with @xmath2=1 ."
  ],
  "abstract_text": [
    "<S> following the usual procedure of the @xmath0 approximation ( @xmath0a ) within the first - principles framework , we calculate the self energy from eigenfunctions and eigenvalues generated by the local - density approximation ( lda ) . </S>",
    "<S> we analyze several possible sources of error in the theory and its implementation , using a recently development all - electron method approach based on the full - potential linear muffin - tin orbital ( lmto ) method . </S>",
    "<S> first we present some analysis of convergence in some quasiparticle energies with respect to the number of bands , and also their dependence on different basis sets within the lmto method . </S>",
    "<S> we next present a new analysis of core contributions . </S>",
    "<S> then we apply the @xmath0a to a variety of materials systems , to test its range of validity . for simple @xmath1 semiconductors </S>",
    "<S> , @xmath0a always underestimates bandgaps . better agreement with experiment </S>",
    "<S> is obtained when the renormalization ( @xmath2 ) factor is not included , and we propose a justification for it . </S>",
    "<S> we close with some analysis of difficulties in the usual @xmath0a procedure . </S>"
  ]
}