{
  "article_text": [
    "the origin and nature of dark energy @xcite is one of the most difficult challenges facing physicists and cosmologists now . among all the proposed models to tackle this problem ,",
    "a scalar field is perhaps the most popular one up to now .",
    "the scalar field , denoted by @xmath4 , might only interact with other matter species through gravity , or have a coupling to normal matter and therefore producing a fifth force on matter particles .",
    "the latter idea has seen a lot of interests in recent years , in the light that such a coupling could alleviate the coincidence problem of dark energy and that it is commonly predicted by low energy effective theories from a fundamental theory .",
    "nevertheless , if there is a coupling between the scalar field and baryonic particles , then stringent experimental constraints might be placed on the fifth force on the latter provided that the scalar field mass is very light ( which is needed for the dark energy ) .",
    "such constraints severely limit the viable parameter space of the model .",
    "different ways out of the problem have been proposed , of which the simplest one is to have the scalar field coupling to dark matter only but not to standard model particles , therefore evading those constraints entirely .",
    "this is certainly possible , especially because both dark matter and dark energy are unknown to us and they may well have a common origin .",
    "another interesting possibility is to have the chameleon mechanism @xcite , by virtue of which the scalar field acquires a large mass in high density regions and thus the fifth force becomes undetectablly short - ranged , and so also evades the constraints .",
    "study of the cosmological effect of a chameleon scalar field shows that the fifth force is so short - ranged that it has negligible effect in the large scale structure formation @xcite for certain choices of the scalar field potential .",
    "but it is possible that the scalar field has a large enough mass in the solar system to pass any constraints , and at the same time has a low enough mass ( thus long range forces ) on cosmological scales , producing interesting phenomenon in the structure formation .",
    "this is the case of some @xmath5 gravity models @xcite , which survives solar system tests thanks again to the chameleon effect @xcite .",
    "note that the @xmath5 gravity model is mathematically equivalent to a scalar field model with matter coupling .    no matter whether the scalar field couples with dark matter only or with all matter species , it is of general interests to study its effects in cosmology , especially in the large scale structure formation . indeed , at the linear perturbation level there have been a lot of studies about the coupled scalar field and @xmath5 gravity models which enable us to have a much clearer picture about their behaviors now .",
    "but linear perturbation studies do not conclude the whole story , because it is well known that the matter distribution at late times becomes nonlinear , making the behavior of the scalar field more complex and the linear analysis insufficient to produce accurate results to confront with observations .",
    "for the latter purpose the best way is to perform full n - body simulations @xcite to evolve the individual particles step by step .",
    "n - body simulations for scalar field and relevant models have been performed before @xcite .",
    "for example , in @xcite the simulation is about a specific coupled scalar field model .",
    "this study however does not obtain a full solution to the spatial configuration of the scalar field , but instead simplifies the simulation by assuming that the scalar field s effect is to change the value of the gravitational constant , and presenting an justifying argument for such an approximation . as we will see below , this approximation is only good in certain parameter spaces and for certain choices of the scalar field potential , and therefore we believe fuller simulations than the one performed in @xcite is needed to study the scalar field behavior most rigorously .",
    "note also the structure formation with a coupled chameleon scalar field has also been studied using non b - body techniques previously @xcite .",
    "recently there have also appeared full simulations of the @xmath5 gravity model @xcite , which do solve the scalar degree of freedom explicitly .",
    "however , embedded in the @xmath5 framework there are some limitations in the generality of these works . as a first thing ,",
    "@xmath5 gravity model ( no matter what the form @xmath6 is ) only corresponds to the couple scalar field models for a specific value of coupling strength @xcite .",
    "second , in @xmath5 models the correction to standard general relativity is through the modification to the poission equation and thus to the gravitational potential as a whole @xcite , while in the coupled scalar field models we could clearly separate the scalar fifth force from gravity and analyze the former directly . also , in @xmath5 models the coupling between matter and the scalar field is universal ( the same to dark matter and baryons ) , while in the couple scalar field models it is straightforward to switch on / off the coupling to baryons and study the effects on baryonic and dark matter clusterings respectively . and",
    "finally , the general framework of n - body simulations in couple scalar field models could also handle the situation where the chameleon effect is absent and scalar field only couples to dark matter ( which is of no interests for @xmath5 people ) .    in this article we present the general formulae and algorithm of full n - body simulations in coupled scalar field models and consider as an explicit example the results for a chameleon scalar field .",
    "unlike in @xcite , here we shall calculate the spatial distribution of the scalar field directly without making simplifications such as a rescaled gravitational constant . neither",
    "shall we use the concept of varying - mass dark matter particles as in @xcite , but instead we treat the system as constant - mass dark matter particles under the action of a fifth force .",
    "the article is organized as follows : in   [ sect : model ] we review the general equations of motion for the coupled scalar field model and introduce our specific choices of the coupling function and scalar field potential .",
    "next we analyze in   [ sect : lin ] the general linear perturbation equations in the @xmath7 formalism @xcite and integrate them into the numerical boltzmann code camb @xcite to study the effects on the linear structure formation . then in   [ sect : nonlin ] we turn to our main focus , introducing the formulae and algorithm of the n - body simulation .",
    "we also study the chosen model explicitly , display the preliminary results and discuss on them .",
    "finally we conclude in   [ sect : disc ] .",
    "in this section we briefly introduce the model considered here and present the equations that will be analyzed in the following sections .",
    "let us start by looking at the general field equations for a scalar field coupled to dark matter .",
    "the lagrangian for our coupled scalar field model is",
    "@xmath8 + v(\\varphi ) - c(\\varphi)\\mathcal{l}_{\\mathrm{cdm } } + \\mathcal{l}_{\\mathrm{s}}\\ \\\\end{aligned}\\ ] ] where @xmath9 is the ricci scalar , @xmath10 with @xmath11 newton s constant , @xmath4 is the scalar field , @xmath12 is its potential energy and @xmath13 its coupling to dark matter , which is assumed to be cold and described by the lagrangian @xmath14 .",
    "@xmath15 includes all the terms for photons , neutrinos and baryons , and these will be considered only when we calculate the large scale structure formation in the next section .",
    "the dark matter lagrangian , for a point - like particle with ( bare ) mass @xmath16 , is @xmath17 where @xmath18 is the coordinate and @xmath19 is the coordinate of the centre of the particle . from this equation",
    "it can be easily derived that @xmath20 also , because @xmath21 where @xmath22 is the four velocity of the dark matter particle , so the lagrangian could be rewritten as @xmath23 which will be used below .",
    "( [ eq : dmemt_particle ] ) is the energy momentum tensor for a single dark matter particle . for a fluid with many particles",
    "the energy momentum tensor will be @xmath24 in which @xmath25 is a volume microscopically large and macroscopically small , and we have extend the 3-dimensional @xmath26 function to a 4-dimensional one by adding a time component .",
    "meanwhile , using @xmath27 it is straightforward to show that the energy momentum tensor for the scalar field is given by @xmath28.\\end{aligned}\\ ] ] so the total energy momentum tensor is @xmath29\\nonumber\\\\ & & + c(\\varphi)t^{\\mathrm{cdm}}_{ab } + t^{\\mathrm{s}}_{ab}\\end{aligned}\\ ] ] where @xmath30 , @xmath31 is the energy momentum tensor for standard model particles , and the einstein equation is @xmath32 where @xmath33 is the einstein tensor . note that due to the coupling between the scalar field @xmath4 and the dark matter , the energy momentum tensors for either will not be conserved , and we have @xmath34 where throughout this paper we shall use a @xmath35 to denote the derivative with respect to @xmath4 .",
    "finally , the scalar field equation of motion ( eom ) from the given lagrangian is @xmath36 where @xmath37 . using eq .",
    "( [ eq : dmlagrangian2 ] ) it can be rewritten as @xmath38    eqs .",
    "( [ eq : emt_tot ] , [ eq : einsteineq ] , [ eq : dm_energy_conservation ] , [ eq : phieom ] ) summarize all the physics that will be used in our analysis .",
    "we will consider a special form for the scalar field potential , @xmath39^{\\mu}},\\end{aligned}\\ ] ] where we have fixed the coefficient in front of @xmath4 to be @xmath40 without loss of generality , since we can always rescale @xmath4 to achieve this ; @xmath41 is a dimensionless constant and @xmath42 is a constant with mass dimension @xmath43 .",
    "as will be discussed below , we need @xmath44 to evade local observational constraints . meanwhile , the coupling between the scalar field and dark matter particle is chosen as @xmath45 where @xmath46 is another dimensionless constant .    as will be explained below",
    ", the two dimensionless parameters @xmath41 and @xmath47 have clear physical meanings : _ roughly speaking _",
    ", @xmath41 controls the time when the effect of the scalar field becomes important in cosmology while @xmath47 determines how important it would ultimately be . indeed , the potential given in eq .",
    "( [ eq : potential ] ) is motivated by the @xmath5 cosmology @xcite , in which the extra degree of freedom behaves as a coupled scalar field in the einstein frame . as we could see from eq .",
    "( [ eq : potential ] ) , the potential @xmath48 when @xmath49 while @xmath50 when @xmath51 . in the latter case , however , @xmath52 , so that the effective total potential @xmath53 has a global minimum at some finite @xmath4 .",
    "if the total potential @xmath54 is steep enough around this minimum , then the scalar field becomes very heavy and thus follows its minimum dynamically , as is in the case of the chameleon cosmology .",
    "if @xmath55 is not steep enough at the minimum , however , the scalar field will have a more complicated evolution .",
    "these two different cases can be obtained by choosing appropriate values of @xmath56 : if @xmath47 is very large or @xmath41 is small then we run into the former situation and if @xmath47 is small and @xmath41 is large we have the latter .    in fig .",
    "[ fig : figure1 ] we present a schematic plot of the two situations : the significant difference is that at late times when @xmath57 becomes small , the effective potential becomes flat around its minimum if @xmath47 is not very large and @xmath41 not very small , and as a result the true value of @xmath4 will lag behind that corresponding to the minimum of @xmath55 .",
    "of course if @xmath42 is chosen appropriately the scalar field can act as a dynamical dark energy in this slow - roll regime .",
    "the complexity of the two cases also makes them phenomenologically rich , and it is of our interests to study how such a setup will affect the cosmology in background , linear perturbation and in particular nonlinear structure formation regimes . in the next two sections we shall consider these questions .         as a function of @xmath58 .",
    "the parameters are the same as in fig .",
    "[ fig : figure2 ] and the values of @xmath41 are given beneath the curves . ]",
    "our first task is to linearize the model .",
    "since this involves many equations , we refer the interested readers to the appendices [ appen : perteqn ] and [ appen : k - eqn ] for the complete first - order perturbation equations and their representations in @xmath59-space .",
    "we shall proceed then to study their effects on the large scale structure at linear perturbation level in the universe by putting these linearize equations into the numerical boltzmann code .      in what follows",
    "we will consider the limit of small @xmath41 , @xmath60 .",
    "it is then useful to define the effective mass of the scalar field by the taylor expansion @xmath61 where @xmath62 is at the minimum of @xmath55 , given by @xmath63 in which we have used the facts that @xmath64 as well as @xmath65 so that @xmath66 and @xmath67 . thus the effective mass @xmath68^{1+\\mu } } \\left [ 1 + { ( 1+\\mu ) y\\over 1-y } \\right ] + \\gamma^{2}\\kappa\\rho_{\\mathrm cdm } y^{-\\gamma } \\nonumber\\\\ & \\approx & \\frac { ( \\gamma \\kappa \\rho_{\\mathrm cdm})^2 } { \\kappa v_{0 } } \\left[{1+\\mu \\over \\mu } + \\ln { \\mu v_0 \\over \\gamma \\rho_{\\mathrm cdm } } + { ( 1 + 3\\gamma ) v_0 \\over \\gamma \\rho_{\\mathrm cdm}}\\right ] , \\nonumber\\\\ & \\approx & \\frac { ( \\gamma \\kappa \\rho_{\\mathrm cdm})^2 } { \\mu \\kappa v_{0}}\\end{aligned}\\ ] ]    to see that the scalar field is heavy , _",
    "i.e. _ , @xmath69 , note that @xmath70 , true for @xmath71 [ or @xmath72 but in the early universe , remember that we always assume @xmath73 .",
    "this means that for @xmath44 ( or in the early times ) the scalar field has a very heavy mass and tends to settle at @xmath74 ( quickly oscillating there ) .",
    "then as a good approximation we have @xmath75 in which we have used the facts that @xmath76 in this regime . at the same time , because @xmath77 with the use of eq .",
    "( [ eq : phi_min ] ) , so the kinetic energy of the scalar field is negligible .",
    "this shows that for small @xmath41 we do expect the scalar field to behave like a cosmological constant in background cosmology .",
    "this analysis has been confirmed by numerical calculations . in fig .",
    "[ fig : figure2 ] we show the fractional energy densities of the radiation , dust ( baryon plus cdm ) and dark energy ( the scalar field ) components for @xmath78 and several values of @xmath41 .",
    "it can be seen there the evolutions of these fractional energy densities are not sensitive to @xmath41 . to see this more clearly we have also plotted in fig .  [",
    "fig : figure3 ] the total equation of state of all matter species . as @xmath79",
    "the curves quickly become indistinguishable from each other ( and indistinguishable from the @xmath1cdm prediction ) .",
    "to study the perturbation evolution and the effect of the scalar field on large scale structure formation , we just need to implement the perturbation equations listed in appendix  [ appen : k - eqn ] into a boltzmann code .",
    "as mentioned earlier , here we work in the @xmath80 frame , in which the cdm peculiar velocity @xmath81 must be dynamically evolved according to eq .",
    "( [ eq : pb_v_cdm ] ) with @xmath80 .",
    "also note that the tight coupling approximation is not affected as compared with gr+@xmath1cdm .",
    "the initial condition for @xmath81 could be set to zero . in this way",
    "the observer is comoving with the dark matter particles initially ( when the @xmath82 term in eq .",
    "( [ eq : bg_rho_cdm ] ) is extremely small ) and only deviate from the dark matter particle world lines when this @xmath82 term becomes significant . as for the initial conditions of @xmath82 and @xmath83 , they are also very small at early times , and as we shall see below , there is good reason to set them to zero at those times .",
    "thus we have adopted @xmath84 as the initial conditions of the new variables which need to be evolved in the code .    in fig .",
    "[ fig : figure4 ] we show a collect of the cmb power spectra for the model with @xmath85 . in fig .",
    "[ fig : figure5 ] the matter power spectra of the corresponding parameter choices are given .",
    "we can see that the effect of the scalar field on the cmb spectrum is most significant for low-@xmath86 ( large scales ) , and even there the effect is only to slightly reduce the power .",
    "this behavior is quite similar to the one found in @xcite and is due to the less decay of the gravitational potential on large scales at late times , which decreases the integrated sachs - wolfe ( isw ) effect .",
    "such small deviations of the cmb spectrum from the @xmath1cdm result are obviously not of much help in placing constraints on the model parameters @xmath41 and @xmath47 , especially because of the cosmic variance on large scales .",
    "thus to distinguish this model from others we necessarily need to use other observables such as the linear ( on large scales ) and nonlinear ( on smaller scales ) matter power spectra .",
    "to explain the matter power spectrum , let us consider the evolution of cold dark matter density contrast @xmath87 ( a similar analysis is first given in @xcite for @xmath5 model and later more generally in @xcite ) . for simplicity we shall assume a universe filled with only radiation and cdm particles .",
    "taking the ( conformal ) time derivative of the equation @xmath88 we have @xmath89 taking the spatial derivative of eq .",
    "( [ eq : raychaudhrui ] ) , collecting the coefficients of harmonic expansions and using the frame choice @xmath90 we obtain @xmath91 substituting eq .",
    "( [ eq : zevolution ] ) into eq .",
    "( [ eq : deltaevolution2 ] ) and using eqs .",
    "( [ eq : pb_v_cdm ] , [ eq : deltaevolution1 ] ) we arrive at @xmath92 where the last term is equal to @xmath93 with @xmath82 being substituted using the propagation equation of @xmath94 ( remember that @xmath80 by choice of the frame ) .    now according to eq .",
    "( [ eq : sfpert_eom ] ) the evolution of @xmath82 is governed by @xmath95 for small scales ( and late times ) @xmath96 and the term @xmath97 dominates over other terms proportional to @xmath82 in the above equations dominates so that the equation is approximately @xmath98 where we choose to eliminate @xmath99 by using eq .",
    "( [ eq : deltaevolution1 ] ) . substituting eq .",
    "( [ eq : sf_pert ] ) into eq .",
    "( [ eq : deltaevolution3 ] ) to eliminate @xmath82 and @xmath81 , we get @xmath100 during the matter dominated era we can neglect the contribution from radiation , and the above equation for the growth of the overdensity reduces to @xmath101 where @xmath102 where @xmath103 as before , and @xmath104 for our coupling function of @xmath105 as given by eq .",
    "( [ eq : coupling_function ] ) .",
    "thus we could see that the growth of cold dark matter density contrast is ( on small scales ) scale - independent , which explains the matter power spectrum at large @xmath59 values ( small scales ) in fig .",
    "[ fig : figure5 ] . in particular , note that for our choice of parameters we have @xmath106 and @xmath107 , and so this equation is approximately the same as that in the @xmath108 paradigm but with an effective gravitational constant @xmath109 .",
    "this indicates that the parameter @xmath47 characterizes the strength of the scalar field fifth force relative to gravity ; the larger @xmath47 is , the stronger the fifth force will _ ultimately _ be .    .",
    "the red , blue , green and black curves correspond to @xmath110 with chameleon perturbations and @xmath111 _ without _ chameleon perturbations , respectively .",
    "curves for @xmath112 are indistinguishable from the @xmath1cdm result . ]    .",
    "the curves with @xmath112 are very close to the @xmath1cdm result . ]",
    "meanwhile , from the derivation process of eq .",
    "( [ eq : deltaevolution4 ] ) we see that the assumption that @xmath113 [ cf .",
    "[ eq : sfpert_eom2 ] ] has been used .",
    "this is of course true for our choices of @xmath41 , but eq .",
    "( [ eq : v_phiphi ] ) tells us that this is not necessarily the case for @xmath44 , due to the strong nonlinearity of @xmath12 .",
    "let s suppose now @xmath114 for some small enough value of @xmath41 ( say @xmath115 ) , then eq .  ( [ eq : sfpert_eom2 ] )",
    "should be approximated as @xmath116 rather than as eq .",
    "( [ eq : sf_appox1 ] ) , so that in eq",
    ".  ( [ eq : deltaevolution3 ] ) the @xmath97 term could be neglected , implying that the scalar field simply has negligible effects on the evolution of @xmath87 .",
    "thus we conclude that the effect of the parameter @xmath41 is to control the time when the fifth force becomes important as compared with gravity ; the smaller @xmath41 is , the later will this time be .",
    "so with very strong chameleon effects ( very nonlinear potentials ) the fifth force could be greatly suppressed all through the cosmic history up to now , and it is therefore possible to get a cosmology very close to the @xmath1cdm paradigm in every aspect .    obviously , at the very early times the fifth force is also suppressed even in cases of @xmath117 , because in this regime again we have @xmath114 .",
    "indeed this is the reason why we could set the initial condition as in eq .",
    "( [ eq : initcond ] ) .",
    "now the matter power spectra as seen in fig .",
    "[ fig : figure5 ] could be well explained : when @xmath41 decreases , the time when the fifth force could fully show its power becomes later and as a result the growth of structure does not reach its maximum potential  this explains why the @xmath118 curves increasingly get far away from the black one .",
    "but because all these values of @xmath41 are large enough ( compared with , say , @xmath115 ) , the fifth force in all these cases has _ almost _ realized its _",
    "full _ power ( which is @xmath2 times stronger than gravity according to eq .",
    "( [ eq : deltaevolution4 ] ) )  this explains why all the colored curves are fairly far from the black one . finally , eq .  ( [ eq : deltaevolution4 ] ) explains why on small scales the colored @xmath119 curves are almost parallel to the black one .",
    "given the complexity of the scalar field behavior , especially in regions with highly nonlinear matter distribution , we must say that the linear analysis performed above is only qualitatively correct and lacks the high precision to compare with various cosmological data sets .",
    "in particular , it may well be that the effect of the fifth force is not significant on linear scales because the fifth force is not long - range enough , but much more important on smaller scales which are beyond the linear regime .",
    "thus in the next section we shall consider the scalar field model in the context of n - body cosmological simulations , and try to study its effects in a more accurate manner .",
    "in   [ sect : lin ] we have considered the background evolution and linear large structure formation in the couple scalar field model . for the former , the coupling between @xmath4 and cdm prevents @xmath4 from rolling to infinity and instead tends to keep @xmath4 and @xmath12 constant ; here we find that for a value of @xmath60 this effect is significant enough to make the background cosmology similar to that of @xmath1cdm .",
    "for the latter , the cmb spectrum is also not very sensitive to the value of @xmath41 or @xmath47 such that @xmath60 is difficult to be distinguished from @xmath1cdm .",
    "these results suggest that large scale observables are not particularly well suited in studying the new features of this class of coupled scalar field models .    on smaller but still linear scales",
    ", we already see that the scalar field coupling effectively increases the gravitational force by a factor of @xmath2 , leading to a significant increase in the small scale power of @xmath119 for gravitational - strength couplings [ @xmath73 .",
    "one could of course argue that the observed matter power spectrum is indeed for the luminous matter only and can not be applied to dark matter navely due to the bias between the two .",
    "but the enhancement of dark matter clustering in this model is abstract and can be tested by observations such as weak lensing without much ambiguity . if this is done ,",
    "it is unlikely that there remains much space for such a strongly coupled model .",
    "however , two things must be taken into account before we arrive at any definite conclusions about the fate of the model .",
    "first , on small scales where the scalar field effect becomes important , the distribution of matter is already beyond the linear perturbation regime and in some regions could be very nonlinear .",
    "this means that a linear analysis as presented in the above section is no longer sufficient and we must consider the nonlinear effect , which is most precisely taken in account by large n - body simulations",
    ". this will be the very topic of this section .",
    "second , as we argued in ",
    "[ sect : lin ] , the behavior of the model is not only controlled by @xmath47 , but also by parameter @xmath41 : for @xmath44 , the epoch when the scalar field fifth force starts to realizes its full power as @xmath2 times of gravity could be greatly postponed .",
    "it is then possible to prevent too powerful a structure formation .    like in the background cosmology , this has something to do with nonlinear ( chameleon ) effects , but here things become much more complicated . in a homogeneous universe , the spatial gradient of the scalar field vanishes and the scalar field @xmath4 takes the same value anywhere , largely simplifying the analysis . for the real universe with nonlinear matter distributions ,",
    "the spatial gradient of @xmath4 is normally much larger than the time derivative so that the configuration of the scalar field relies on the underlying matter distribution sensitively in a nonlinear way , and at the same time strongly affects the latter via the action of fifth force . quantifying such complex couplings",
    "also calls for the use of n - body simulations .    in this paper",
    "we shall set up the basic framework of studying coupled scalar field models using n - body technique , putting much emphasis on the working mechanism and the fifth force effect .",
    "we shall start with a derivation of all the relevant equations of motion , describe how to integrate them into the numerical code and present some preliminary results .",
    "detailed analysis will be postponed to companion papers .",
    "we will not provide an introduction to general n - body simulation techniques here , and interested readers are referred to the relevant literature @xcite .",
    "our first step is to simplify the relevant equations of motion in the appropriate limit to get a set of equations which can be directly applied to the numerical code .",
    "we know that the existence of the scalar field and its coupling to standard cold dark matter particles make the following changes to the @xmath1cdm model : first , the energy momentum tensor has a new piece of contribution from the scalar field ; second , the energy density of dark matter is multiplied by a function @xmath13 , which is because the coupling to scalar field essentially renormalizes the mass of dark matter particles ; third and most important , dark matter particles will not follow geodesics in their motions as in @xmath1cdm , rather , the total force on them has a contribution from the scalar field .",
    "these imply that the following things need to be modified or added :    1 .",
    "the scalar field @xmath4 equation of motion , which determines the value of the scalar field at any given time and position .",
    "2 .   the poisson equation , which determines the gravitational potential ( and thus gravity ) at any given time and position , according to the local energy density and pressure , which include the contribution from the scalar field ( as obtained from @xmath4 equation of motion ) now .",
    "the total force on the dark matter particles , which is determined by the spatial configuration of @xmath4 , just like gravity is determined by the spatial configuration of the gravitational potential .",
    "we shall describe these one by one now .    for the scalar field equation of motion ,",
    "we denote @xmath120 as the background value of @xmath4 and @xmath121 as the scalar field perturbation .",
    "then eq .",
    "( [ eq : phieom ] ) could be rewritten as @xmath122 by subtracting the corresponding background equation from it . here",
    "@xmath123 is the covariant spatial derivative with respect to the physical coordinate @xmath124 with @xmath125 the conformal coordinate , and @xmath126 .",
    "@xmath123 is essentially the @xmath127 , but because here we are working in the weak field limit we approximate it as @xmath128 by assuming a flat background ; the minus sign is because our metric convention is @xmath129 instead of @xmath130 . for the simulation here we will also work in the quasi - static limit , assuming that the spatial gradient is much larger than the time derivative , @xmath131 ( which will be justified below ) .",
    "thus the above equation can be further simplified as @xmath132,\\nonumber\\end{aligned}\\ ] ] in which @xmath133 is with respect to the conformal coordinate @xmath125 so that @xmath134 , and we have restored the factor @xmath135 in front of @xmath136 ( the @xmath4 here and in the remaining of this paper is @xmath137 times the @xmath4 in the original lagrangian unless otherwise stated ) .",
    "note that here @xmath25 and @xmath57 both have the dimension of__mass _ _ density rather than _ energy _ density .",
    "next look at the poisson equation , which is obtained from the einstein equation in weak - field and slow - motion limits . here",
    "the metric could be written as @xmath138 from which we find that the time - time component of the ricci curvature tensor @xmath139 , and then the einstein equation @xmath140 gives @xmath141 where @xmath142 and @xmath143 are respectively the total energy density and pressure .",
    "the quantity @xmath144 can be expressed in terms of the comoving coordinate @xmath125 as @xmath145 where we have defined a new newtonian potential @xmath146 and used @xmath147 .",
    "thus @xmath148\\nonumber\\end{aligned}\\ ] ] where in the second step we have used eq .",
    "( [ eq : einsteineqn ] ) and the raychaudhrui equation , and an overbar means the background value of a quantity . because the energy momentum tensor for the scalar field is given by eq .",
    "( [ eq : phiemt ] ) , it is easy to show that @xmath149 $ ] and so @xmath150\\right\\}\\nonumber\\\\ & & + 4\\pi ga^{3 } \\left\\{\\bar{\\rho}_{\\mathrm{cdm}}c(\\bar{\\varphi})+ 2\\left[\\dot{\\bar{\\varphi}}^{2}-v(\\bar{\\varphi})\\right]\\right\\}.\\nonumber\\end{aligned}\\ ] ] now in this equation @xmath151 in the quasi - static limit and so could be dropped safely .",
    "so we finally have @xmath152\\nonumber\\\\ & & - 8\\pi ga^{3}\\left[v(\\varphi)-v(\\bar{\\varphi})\\right].\\end{aligned}\\ ] ]    finally , for the equation of motion of the dark matter particle , consider eq .",
    "( [ eq : dm_energy_conservation ] ) . using eqs .",
    "( [ eq : dmemt_particle ] , [ eq : dmlagrangian2 ] ) , this can be reduced to @xmath153 obviously the left hand side is the conventional geodesic equation and the right hand side is the new fifth force due to the coupling to the scalar field . before going on further , note that the fifth force @xmath154 is perpendicular to the 4-velocity @xmath155 ; this means that the energy density of cdm will be conserved and only the particle trajectories are modified as mentioned above . now in the non - relativistic limit the spatial components of eq .",
    "( [ eq : dmeom ] ) can be written as @xmath156 where @xmath157 is the physical time coordinate .",
    "if we instead use the comoving coordinate @xmath125 , then this becomes @xmath158 where we have used eq .",
    "( [ eq : newphi ] ) .",
    "the canonical momentum conjugate to @xmath125 is @xmath159 so we have now @xmath160    eqs .",
    "( [ eq : wfphieom ] , [ eq : wfpoisson ] , [ eq : wfdxdtcomov ] , [ eq : wfdpdtcomov ] ) will be used in the code to evaluate the forces on the dark matter particles and evolve their positions and momenta in time .      in our numerical simulation",
    "we use a modified version of mlapm ( @xcite , see [ subsect : n - body ] ) , and we must change our above equations in accordance with the internal units used in that code . here",
    "we briefly summarize the main features .",
    "mlapm code uses the following internal units ( with subscript @xmath161 ) : @xmath162 in which @xmath163 is the present size of the simulation box and @xmath164 is the present hubble constant . using these newly - defined quantities , it is easy to check that eqs .",
    "( [ eq : wfdxdtcomov ] , [ eq : wfdpdtcomov ] , [ eq : wfpoisson ] , [ eq : wfphieom ] ) could be rewritten as @xmath165 and @xmath166 where @xmath167 is the present cdm fractional energy density , we have again restored the factor @xmath135 and again the @xmath4 is @xmath137 times the @xmath4 in the original lagrangian .",
    "also note that from here on we shall use @xmath168 unless otherwise stated , for simplicity .",
    "we also define @xmath169 to be used below .",
    "making discretized version of the above equations for n - body simulations is non - trivial task .",
    "for example , the use of variable @xmath170 instead of @xmath4 ( see below ) helps to prevent @xmath171 , which is unphysical , but numerically possible due to discretization .",
    "we refer the interested readers to appendix  [ appen : discret ] to the whole treatment , with which we can now proceed to do n - body runs .",
    "the full name of mlapm is multi - level adaptive particle mesh code . as the name has suggested , this code uses multilevel grids @xcite to accelerate the convergence of the ( nonlinear ) gauss - seidel relaxation method @xcite in solving boundary value partial differential equations .",
    "but more than this , the code is also adaptive , always refining the grid in regions where the mass / particle density exceeds a certain threshold .",
    "each refinement level form a finer grid which the particles will be then ( re)linked onto and where the field equations will be solved ( with a smaller time step ) .",
    "thus mlapm has two kinds of grids : the domain grid which is fixed at the beginning of a simulation , and refined grids which are generated according to the particle distribution and which are destroyed after a complete time step .",
    "one benefit of such a setup is that in low density regions where the resolution requirement is not high , less time steps are needed , while the majority of computing sources could be used in those few high density regions where high resolution is needed to ensure precision .",
    "some technical issues must be taken care of however .",
    "for example , once a refined grid is created , the particles in that region will be linked onto it and densities on it are calculated , then the coarse - grid values of the gravitational potential are interpolated to obtain the corresponding values on the finer grid . when the gauss - seidel iteration is performed on refined grids , the gravitational potential on the boundary nodes",
    "are kept constant and only those on the interior nodes are updated according to eq .",
    "( [ eq : gs ] ) : just to ensure consistency between coarse and refined grids .",
    "this point is also important in the scalar field simulation because , like the gravitational potential , the scalar field value is also evaluated on and communicated between multi - grids ( note in particular that different boundary conditions lead to different solutions to the scalar field equation of motion ) .",
    "in our simulation the domain grid ( the finest grid that is not a refined grid ) has @xmath172 nodes , and there are a ladder of coarser grids with @xmath173 , @xmath174 , @xmath175 , @xmath176 , @xmath177 nodes respectively .",
    "these grids are used for the multi - grid acceleration of convergence : for the gauss - seidel relaxation method , the convergence rate is high upon the first several iterations , but quickly becomes very slow then ; this is because the convergence is only efficient for the high frequency ( short - range ) fourier modes , while for low frequency ( long - range ) modes more iterations just do not help much . to accelerate the solution process",
    ", one then switches to the next coarser grid for which the low frequency modes of the finer grid are actually high frequency ones and thus converge fast .",
    "the mlapm solver adopts the self - adaptive scheme : if convergence is achieved on a grid , then interpolate the relevant quantities back to the finer grid ( provided that the latter is not on the refinements ) and solve the equation there again ; if convergence becomes slow on a grid , then go to the next coarser grid . this way it goes indefinitely except when converged solution on the domain grid",
    "is obtained or when one arrives at the coarsest grid ( normally with @xmath178 nodes ) on which the equations can be solved exactly using other techniques . for our scalar field model ,",
    "the equations are difficult to solve anyway , and so we truncate the coarser - grid series at the @xmath177-node one , on which we simply iterate until convergence is achieved .    for the refined grids the method is different : here one",
    "just iterate eq .  ( [ eq : gs ] ) until convergence , without resorting to coarser grids for acceleration .",
    "as is normal in the gauss - seidel relaxation method , convergence is deemed to be achieved when the numerical solution @xmath179 after @xmath180 iterations on grid @xmath59 satisfies that the norm @xmath181 ( mean or maximum value on a grid ) of the residual @xmath182 is smaller than the norm of the truncation error @xmath183\\end{aligned}\\ ] ] by a certain amount .",
    "note here @xmath184 is the discretization of the differential operator eq .",
    "( [ eq : diffop ] ) on grid @xmath59 and @xmath185 a similar discretization on grid @xmath186 , @xmath187 is the source term , @xmath188 is the restriction operator to interpolate values from the grid @xmath59 to the grid @xmath186 . in the modified code",
    "we have used the full - weighting restriction for @xmath188 .",
    "correspondingly there is a prolongation operator @xmath189 to obtain values from grid @xmath186 to grid @xmath59 , and we use a bilinear interpolation for it . for more details see @xcite .",
    "mlapm calculates the gravitational forces on particles by centered difference of the potential @xmath190 and propagate the forces to locations of particles by the so - called triangular - shaped - cloud ( tsc ) scheme to ensure momentum conservation on all grids .",
    "the tsc scheme is also used in the density assignment given the particle distribution .",
    "the main modifications to the mlapm code for our model are :    1 .   we have added a parallel solver for the scalar field based on eq .",
    "( [ eq : u_phi_eom ] ) .",
    "the solver uses a similar nonlinear gauss - seidel method and same criterion for convergence as the poisson solver .",
    "2 .   the solved value of @xmath170 is then used to calculate local mass density and thus the source term for the poisson equation , which is solved using fast fourier transform . 3 .",
    "the fifth force is obtained by differentiating the @xmath170 just like the calculation of gravity .",
    "4 .   the momenta and positions of particles",
    "are then updated taking in account of both gravity and the fifth force .",
    "there are a lot of additions and modifications to ensure smooth interface and the newly added data structures . for the output , as there are multilevel grids all of which host particles , the composite grid is inhomogeneous and thus we choose to output the positions , momenta of the particles , plus the gravity , fifth force and scalar field value _ at the positions _ of these particles .",
    "we can of course easily read these data into the code , calculate the corresponding quantities on each grid and output them if needed .      in this subsection",
    "we shall present some preliminary results of several runs and give a sense about the qualitative behaviors of the coupled scalar field model . also we will not make detailed and quantitative analysis in this paper , which will be shown in forthcoming papers .",
    "we have performed 8 runs of the modified code with parameters @xmath191 and @xmath192 respectively .",
    "for all these runs there are @xmath172 dark matter particles , the simulation box has a size @xmath193 in which @xmath194 and @xmath195 domain grid cells in each direction .",
    "we assume a @xmath1cdm background cosmology which is a very good approximation for @xmath44 as we mentioned in   [ sect : lin ] ; the current fractional energy densities of dark matter and dark energy are @xmath196 and @xmath197 ( note that this is a dark - matter - only simulation and baryons will be added in a later work to study the bias effect caused by the dark matter coupling ) .",
    "given these parameters , the mass resolution of the simulation is @xmath198 with @xmath199 the solar mass .",
    "the spatial resolution is @xmath200 on the finest refined grids and @xmath201 on the domain grid .",
    "the high resolution in high density regions is actually necessary to ensure precision in those regions because the fifth force is generally short - ranged there .",
    "all the simulations start at redshift @xmath202 . in principle ,",
    "modified initial conditions ( initial displacements and velocities of particles which is obtained given a linear matter power spectrum ) need to be generated for the coupled scalar field model , because the zeldovich approximation @xcite is also affected by the scalar field coupling .",
    "in practice , however , we find that the effect on the linear matter power spectrum is negligible ( @xmath203 ) for our choices of parameters @xmath56 .",
    "thus we simply use the @xmath1cdm initial displacements / velocities for the particles in these simulations , which are generated using grafic @xcite again with @xmath196 and @xmath197 .",
    "@xmath204 at present day .            in figs .",
    "[ fig : figurex1 ] , [ fig : figurex2 ] we have shown the results for the runs with @xmath205 and @xmath206 .",
    "these choices of @xmath41 are such that for @xmath207 ( the lower two rows ) the chameleon effect is pretty strong while for @xmath208 ( the upper two rows ) it is much weaker ; the choices of @xmath47 are to see the effects of different full strengths of the fifth force .",
    "the three panels in the first and third rows display the particle distributions at three output redshifts @xmath209 from right to left , and the three panels in the second and fourth rows show the correlation between the fifth force and gravity at these redshifts .    for clearness we have only plotted a thin slice ( along the @xmath210 direction ) of the full 3-dimensional particle distribution .",
    "first let s have a look at the first and third rows .",
    "because we have output the scalar field value at the position of each particle together with other parameters of the particle , we also include this information in the plots",
    ". on top of each panel the range of the value @xmath13 at the positions of all the shown particles is shown , and color is used to illustrate the amplitude of @xmath13 ( going from black to red from the minimum to the maximum value of @xmath13 ) . note that @xmath211 for @xmath65 , thus the color also indicates the value of the scalar field indirectly . also bear in mind that the same color may denote different values of @xmath13 at different redshifts .",
    "the scalar field or @xmath13 grows with time in general .",
    "next look at the second and fourth rows , which display the logarithmic of the magnitude of the fifth force versus that of gravity .",
    "the color here has the same meaning as above .",
    "furthermore , each point ( particle ) now is engaged with a square box centered on it , which denotes the size of the angle ( from @xmath212 to @xmath213 ) between the two forces ; the size of the box increases linearly with the angle , from a minimum size @xmath212 to a maximum size comparable to the largest box size shown in the entire figure . as we have mentioned above , the strength of the fifth force , if not suppressed by the chameleon mechanism , is @xmath2 times that of gravity , so we also plot the functions @xmath214 where @xmath215 are respectively the magnitudes of the fifth force and gravity , as the black solid lines in these figure , to compare with the simulation data",
    ".    we can understand these results qualitatively as follows by taking fig .",
    "[ fig : figurex1 ] as example .",
    "the chameleon effect is generally stronger at earlier times when matter density is high and the scalar field value is small .",
    "as is shown in the panels of the first row , at redshift @xmath216 there is a strong contrast of the value @xmath13 in high density ( _ blue _ ) regions ( clusters hereafter ) compared to @xmath13 in the low density ( _ green , yellow and red _ ) regions ( voids hereafter ) , which is a direct reflection of the nonlinearity in the scalar field .",
    "as time evolves and the background value of the scalar field increases , at redshift @xmath217 the chameleon effect gets suppressed ; this is manifested by the facts that ( 1 ) in the regions of small clusters the scalar field values are no longer significantly different from the background value , both of which are yellow and orange - colored , ( 2 ) even in the largest clusters the contrast between the scalar field values inside and outside ( green / light blue versus yellow / orange ) is not so strong compared with the result at redshift @xmath216 ( purple / dark blue versus green / yellow ) .",
    "these show that the size of nonlinear regions is shrinking and the thin shells in the clusters are thickening , together leading to less nonlinear behaviors of the scalar field . at redshift",
    "@xmath218 this tendency just becomes more obvious , leaving only a small portion of the space with chameleon effect and thin shells .",
    "the strength of the chameleon effect is determined by several factors . in principle , the larger the effective mass of scalar field ( @xmath219 ) at a position is , the shorter - ranged the fifth force is and the less sensitive the scalar field value at this position will be to the matter distribution around it : this in turn corresponds to a stronger chameleon effect because the scalar field value is mainly determined by the local matter density . on the other hand , @xmath219 depends on @xmath41 ( smaller @xmath41 implies larger @xmath219 within a given cluster and thus stronger chameleon effect ) , @xmath47 and local @xmath57 ( larger values for these two parameters also imply larger @xmath219 and stronger chameleon effect ) and also the background value of the scalar field ( this is because the interior solution of the scalar field inside a cluster should only be solved given the boundary conditions outside the cluster , due to the differential nature of the scalar field eom . of course for very small @xmath41 and/or very large @xmath47 , the scalar field eom indeed behaves as an algebraic equation and then the influence of the background value of the scalar field is not important , but for our choices of @xmath220 that influence is significant ) .",
    "these analysis agree well with what we have seen in the scalar field configuration from the above n - body simulation results ( first and third rows of fig .",
    "[ fig : figurex1 ] ) . also note that the fifth force is much weaker in regions where chameleon effect is strong , because a particle there can only feel the fifth force from those particles that are very close to it : in this sense we say that the chameleon effect could suppress the fifth force .",
    "a comparison between gravity and the fifth force can illustrate this more clearly .",
    "remember that the chameleon effect could strongly suppress the fifth force . at low redshift ( @xmath218 )",
    "the chameleon effect is not significant and so the fifth force is not suppressed ; in this case we find that there is a strong correlation between both the magnitudes and directions of these two forces , and the simulation results agree with the prediction eq .",
    "( [ eq : fgcurve ] ) to very high degrees .",
    "both forces are stronger in clusters and weaker in voids as expected .",
    "going backwards in time to the redshift @xmath217 , there is still a good correlation but the simulation results begin to scatter over the predicted line eq .",
    "( [ eq : fgcurve ] ) in the void regions due to the chameleon effect ( the scalar field potential term in eq .",
    "( [ eq : intphieom ] ) becomes comparable with the matter coupling term ) .",
    "finally , at very early times ( @xmath216 ) the scalar field value becomes so small that the potential term in eq .",
    "( [ eq : intphieom ] ) is indeed much more important than the matter coupling term so that the latter can be neglected : we then have a complete mismatch between the numerical results and the prediction eq .",
    "( [ eq : fgcurve ] ) as almost all data points are significantly below the black solid line .",
    "the above mismatch in the strongly chameleon regime can be understood schematically as follows :    1 .   when there is no potential for the scalar field but just a matter coupling , the fifth force is indeed long ranged and can probe the same region as gravity does . then a comparison of eqs .",
    "( [ eq : intdpdtcomov ] , [ eq : intpoisson ] , [ eq : intphieom ] ) shows that the fifth force is exactly @xmath2 times of gravity .",
    "this is indeed what we have observed for @xmath218 when the potential term in eq .",
    "( [ eq : intphieom ] ) is negligible .",
    "when the scalar field has a potential , it acquires an effective mass which is well - known to be inversely proportional to the range of the scalar fifth force . as a result",
    "the fifth force is no longer as long range as gravity .",
    "meanwhile , eq .  ( [ eq : intdpdtcomov ] ) makes it clear that the scalar field @xmath4 ( or equivalently @xmath221 $ ] ) acts as a potential for the fifth force , and eq .",
    "( [ eq : intphieom ] ) shows that this potential depends on the underlying matter distribution in a different ( nonlinear ) way from what the gravitational potential @xmath190 does .",
    "+ so we could see that there will be differences between both the ranges and the magnitudes of gravity and fifth force . in high density regions these differences will be dominated over by the competing effects that ( _ i _ ) the majority part of the ( either gravitational or fifth ) force on a particle is contributed by nearby particles and there are so many particles nearby that contribution from distant particles is negligible , ( _ ii _ ) in eq .",
    "( [ eq : intphieom ] ) the potential term is much less important than the matter coupling term , together making the fifth force behavior similar to that of gravity again . in the void regions",
    "the number of nearby particles is small so that contribution from distant particles should be taken into account , and the matter coupling term in eq .",
    "( [ eq : intphieom ] ) is much smaller , then the difference between gravity and the fifth force becomes manifesting .",
    "these effects can be observed in the @xmath217 panel .",
    "3 .   at even higher redshifts",
    "the potential of the scalar field makes its effective mass very large and thus its range very short compared with that of gravity .",
    "meanwhile eq .  ( [ eq : intphieom ] ) becomes very nonlinear due to the smallness of the scalar field value , and thus the fifth force potential depends on matter distribution very differently from the gravitational potential .",
    "+ as a result , the fifth force reflects the matter distribution in a very small region around a given particle , while gravity probes that in a much larger region .",
    "even in that small region where both forces exist , their magnitude can generally be very different .",
    "so it is not surprising that the two forces look so different as in the @xmath216 panel .",
    "note that here the fifth force is also much weaker than gravity because its strength is suppressed by the smallness of the scalar field value .",
    "result for the @xmath115 case ( the lower two rows ) is qualitatively the same as that of the @xmath222 case above , but here because @xmath41 is much smaller , so the chameleon effect exists until much more recent than in the @xmath222 case . indeed , even at low redshifts @xmath217 and @xmath223 there is still strong contrast between the scalar field values inside and outside the clusters ( purple / dark blue versus yellow / orange ) . the correlation between the forces also follow our above analysis , but here there are some new features .",
    "the first feature is that even today the fitting to eq .",
    "( [ eq : fgcurve ] ) is far from perfect ; this is easy to understand , because the scalar field potential is so nonlinear that the scalar field potential term in eq .",
    "( [ eq : intphieom ] ) is important up to now .",
    "the second feature is that in the @xmath218 ( also @xmath217 ) panel we could find that in high density regions the fifth force does not obey eq .",
    "( [ eq : fgcurve ] ) as in the @xmath222 case , but becomes much smaller than gravity  actually , the stronger gravity is , the weaker the fifth force will be !",
    "this is again due to the strong chameleon effect in the clusters , which makes the scalar field value very small and thus suppresses the fifth force there .",
    "note that this feature is desirable because if we also couple the scalar field to baryonic matter then we definitely want the fifth force to be suppressed to evade solar system tests .    if we choose @xmath224 as in fig .",
    "[ fig : figurex2 ] , then all the qualitative results we have obtained above should still apply .",
    "but the stronger coupling between matter and the scalar field enhances the chameleon effect .",
    "this implies that a coupling whose strength is significantly larger than that of gravity could probably produce the correct amount of large scale structure as observed by suppressing the fifth force on all cosmological epochs and scales of interests to us .",
    "the analysis above clearly shows the complexity of the fifth force and its possible effects on the nonlinear structure formation .",
    "though in certain ( no chameleon ) limits the fifth force is greatly simplified and one can assume a modified gravitational constant in the n - body simulations as an approximation , this is evidently not the case if the scalar field potential is too much nonlinear .",
    "of course , we have no _ a priori _ knowledge about when the chameleon effect becomes important , and full numerical simulations like the one presented here are therefore necessary to precisely study the effects of ( coupled ) scalar fields in the large scale structure . in forthcoming works",
    "we shall analyze the nonlinear matter power spectrum , halo profile , scalar field configuration within clusters , as well as the development and disappearance of thin shells in a quantitative manner .",
    "one may wonder if a more complete simulation should keep the time derivatives of the scalar field in eq .",
    "( [ eq : wfphieom ] ) .",
    "this is certainly true , yet these terms indeed have negligible effect @xcite , which could be understood in the following way : when there is no ( or very weak ) chameleon effect , the scalar field potential term in eq .",
    "( [ eq : intphieom ] ) is negligible and so this equation has the same form as the poisson equation eq .",
    "( [ eq : intpoisson ] ) ; as a result the quasi - static approximation works as well for the scalar field as for the gravitational potential ( which is what any n - body code relies on ) . on the other hand ,",
    "if there is strong chameleon effect , the scalar field value tends to be much smaller which means that the time derivative of the scalar field also gets smaller ; and at the same time the spatial gradient of the scalar field becomes larger : these together indicate that the quasi - static approximation should be good here too .",
    "to conclude , in this paper we have presented the general frameworks to study the linear and nonlinear structure formations in coupled scalar field models , and given some preliminary numerical results for both in the context of a specific coupling function and scalar field potential .    for the linear large scale structure ,",
    "we write down the perturbed field equations using the @xmath7 decomposition , which can be directly applied into numerical boltzmann codes such as camb to generate the cmb and matter power spectra . for the chosen coupling function with parameter @xmath47 and potential with parameter @xmath41 , we find that @xmath47 roughly controls the strength of the fifth force ( which is due to the propagation of the scalar field ) while @xmath41 controls how much the effect of the fifth force is suppressed by the chameleon mechanism . with @xmath60",
    "the chameleon effect makes the model behave like @xmath1cdm on very large scales , but this is far from enough to significantly decrease the effects of the fifth force on the small scale density perturbation growth . on those small scales",
    ", however , nonlinearity becomes an important issue , which leads us to the n - body simulation in   [ sect : nonlin ] .",
    "previous n - body simulations with scalar fields are generally simplified by certain approximations such as treating the scalar coupling effect as a simple change of gravitational constant @xmath11 , or assuming a yukawa - type force with a certain range .",
    "these approximations do not work well in the present model , and so here we set up the formula needed for a more precise simulation , putting much emphasis on the calculation of the fifth force and its action on particles .",
    "the equations derived and the algorithm described in   [ sect : nonlin ] are general enough and should be directly applicable to other coupled scalar field models .",
    "we integrate the equations into a modified version of the n - body code mlapm and performed several runs with different combinations of @xmath56 .",
    "some results are displayed in figs .",
    "[ fig : figurex1 ] and [ fig : figurex2 ] .",
    "it is confirmed that when the chameleon effect is not important , the fifth force is parallel to gravity and is @xmath2 times stronger , meaning that simply using a different gravitational constant which is @xmath225 times as large as the bare one in the simulation should be an acceptable approximation .",
    "there are some caveats however .",
    "for one thing , the correlation between gravity and the fifth force is only good for a portion of the parameter space @xmath226 , and for @xmath44 the potential is so nonlinear as to destroy this correlation .",
    "more importantly , even the correlation is perfect now it is possible that at earlier times the nonlinear effects modify it dramatically ( cf .  fig .",
    "[ fig : figurex2 ] with @xmath222 at @xmath227 ) .",
    "this means that the above - mentioned approximation is unlikely to be correct consistently and full simulations as the ones in this paper are needed .",
    "all in all , from the results we can spot the trend that , with the same value of @xmath41 increasing @xmath47 simply enhances the power of structure growth , while with the same value of @xmath47 decreasing @xmath41 has the effects of reducing that power . also , for small @xmath41 the configuration of the scalar field becomes very nonlinear and highly sensitive to the underlying matter distribution , while for large @xmath41 this becomes much more smooth and stiff .",
    "all these observations ( and others as explained in   [ subsect : numresult ] ) agree with the chameleon analysis .",
    "our simulations also provides a test bed for scalar field theories . among the applications",
    ", one could look for high - speed encounters of halos to see the probability of generating a bullet - cluster - like encounters @xcite . since this paper is only served to set up the general framework of linear and nonlinear simulations , these applications of the simulation results , as well as the matter power spectrum and scalar field profile / evolution , will be presented in forthcoming works .",
    "the authors thank alexander knebe , claudio llinares and xufen wu for their helps in technical problems about the n - body code and its implementation , john barrow , carsten van der bruck , anne davis , george efstathiou , david f. mota and douglas shaw for encouragements to finish this work and discussions in the process , and luca amendola for listening about the work and helpful information at earlier stages .",
    "b.  li acknowledges supports from overseas research studentship , cambridge overseas trust , damtp and queens college .",
    "we are also indebted to the hpc - europa transnational access visit programme for its support and the lorentz center and leiden observatory for hospitality when part of this work is undertaken .",
    "the n - body simulations are performed on the sara supercomputer in the netherlands .",
    "natexlab    bibnamefont    bibfnamefont    citenamefont    url    urlprefix    [ 2]#2 [ 2][]#2    , and , * * , ( ) .    and , * * , ( ) .    and , *",
    "* , ( ) .    and , * * , ( ) .    and , * * , ( ) .    , , , and , * * , ( ) .    , , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( )",
    ".    and , * * , ( ) .    and , * * , ( ) .    , , and , * * , ( ) .    , *",
    "* , ( ) .    and , * * , ( ) .",
    ", , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) ; * * , ( )    and , * * , ( ) .    , and ( ) , arxiv:0902.3452 [ astro - ph ]",
    ".    , , , and",
    ", * * , ( ) .",
    ", , and ( ) , arxiv:0812.3901 [ astro - ph ] .    , , and , * * , ( ) .    , * * , ( ) .    , and , * * , ( ) .    , and , * * , ( ) .    and , * * , ( ) .    and , * * , ( ) .    , and , * * , ( ) .    , * * , ( ) .    , and , * * , ( ) .    , * * , ( ) .    , , and , _ numerical recipes in c. the art of scientific computing _",
    "( cambridge university press , cambridge 1992 ) , second ed .    , and , _ a multigrid tutorial _",
    "( society for industrial and applied mathematics , philadelphia 2000 ) , second ed .    , * * , ( ) .    , , and , * * , ( ) .    ) ,",
    "arxiv : astro - ph/9506070 .    , and , * * , ( ) .",
    "consider the decomposition of the stress energy tensor @xmath228 @xmath229 where @xmath155 is the 4-velocity of an observer with respect to which @xmath7 space - time splitting is made , @xmath230 the projection tensor used to obtain covariant tensors perpendicular to @xmath155 . here",
    "@xmath231 is the projected symmetric tracefree anisotropic stress , @xmath232 is the vector heat flux and @xmath233 and @xmath234 respectively the energy density and isotropic pressure .",
    "these quantities could be obtained from @xmath228 through the relations @xmath235 based on these , the components of the stress energy tensor ( up to first order ) in this model is summarized in the following table :    [ cols=\"^,^,^,^,^\",options=\"header \" , ]     throughout this paper an overdot denotes the derivative with respect to the cosmic time @xmath157 and @xmath127 is the covariant spatial derivative perpendicular to @xmath155 ( up to first order in perturbation ) . note that it is the _ coupled _ cdm quantities which appear in the ( background and perturbed ) einstein equations , and also note that we have included the massless neutrinos into the model here .",
    "the five constraint equations in the model are given as @xmath236 \\epsilon_{b)ec}^{\\ \\ \\ \\ d}u^{e } ; \\\\ \\hat{\\nabla}^{b}\\mathcal{e}_{ab } & = & \\frac{1}{2}\\kappa \\left [ \\hat{\\nabla}^{b}\\pi_{ab}+ \\frac{2}{3}\\theta q_{a}+\\frac{2}{3}\\hat{\\nabla}_{a}\\rho\\right ] ; \\\\ \\hat{\\nabla}^{b}\\mathcal{b}_{ab } & = & \\frac{1}{2}\\kappa \\left [ \\hat{\\nabla}_{c}q_{d}+(\\rho+p)\\varpi_{cd}\\right]\\epsilon_{ab}^{\\ \\ cd}u^{b}.\\end{aligned}\\ ] ] here , @xmath237 is the covariant permutation tensor , @xmath238 and @xmath239 are respectively the electric and magnetic parts of the weyl tensor @xmath240 , given respectively through @xmath241 and @xmath242 . @xmath243",
    "come from the decomposition of the covariant derivative of 4-velocity @xmath244 with @xmath245 being the acceleration , @xmath246 the expansion scalar , @xmath247}$ ] and @xmath248 the shear .",
    "note that @xmath249 in the above section has a completely different meaning .",
    "in addition , the seven propagation equations are : @xmath250 } & = & 0 ; \\\\ \\frac{1}{2}\\kappa \\left[\\dot{\\pi}_{ab } + \\frac{1}{3}\\theta\\pi_{ab}\\right ] - \\frac{1}{2}\\kappa \\left[(\\rho + p)\\sigma_{ab}\\ + \\hat{\\nabla}_{\\langle a}q_{b\\rangle } \\right ] \\nonumber \\\\ -\\left [ \\dot{\\mathcal{e}}_{ab } + \\theta \\mathcal{e}_{ab}-\\hat{\\nabla}^{c}\\mathcal{b}_{d(a}\\epsilon_{b)ec}^{\\ \\ \\ \\ d}u^{e}\\right ]   & = & 0 ; \\\\ \\dot{\\mathcal{b}}_{ab } + \\theta\\mathcal{b}_{ab}+\\hat{\\nabla}^{c}\\mathcal{e}_{d(a}\\epsilon_{b)ec}^{\\ \\ \\ \\ d}u^{e } + \\frac{1}{2}\\kappa \\hat{\\nabla}^{c}\\mathcal{\\pi}_{d(a}\\epsilon_{b)ec}^{\\ \\ \\ \\ d}u^{e } & = & 0.\\ \\ \\ \\\\end{aligned}\\]]where the angle bracket means taking the trace - free part of a quantity . note that the first of eq .",
    "( [ eq : q_dm ] ) is for normal matter while the second is for the coupled dark matter .    besides the above equations , it is useful to express the projected ricci scalar @xmath251 into the hypersurfaces orthogonal to @xmath22 as @xmath252the spatial derivative of the projected ricci scalar , @xmath253 , is given as @xmath254 and its propagation equation @xmath255 as we are considering a spatially flat universe , the spatial curvature must vanish on large scales which means that @xmath256 . thus , from eq .",
    "( [ eq : projected_ricci_scalar ] ) , we can obtain the friedman equation @xmath257 note that in all the above equations @xmath258 and @xmath231 are all the total quantities contributed by all matter species : @xmath259    finally , there is the perturbed scalar field eom @xmath260",
    "to put the above perturbation equations into numerical calculation , we need to write them in the @xmath59-space .",
    "as we want to present the complete framework to study the structure formation in coupled scalar field models , here we also list those equations .",
    "first of all , the change into @xmath59-space is accomplished with the aid of following harmonic expansions : @xmath261 where @xmath262 with @xmath263 being the zero order eigenfunctions of the comoving laplacian @xmath264 ( @xmath265 ) and @xmath266 .",
    "note that we only consider scalar mode perturbations in the present paper and so shall neglect the second order quantities such as @xmath239 and @xmath267 .    with these we list the equations that will be used in the numerical calculation of the linear large scale structure .",
    "@xmath268    note that because our definition of the dark matter energy density includes only the mass density , but not the contribution from its coupling to the scalar field , so @xmath57 evolves as in @xmath1cdm .",
    "one can also understand this as follows : the coupling to the scalar field produces a fifth force on the dark matter particles , making their trajectories be non - geodesic , but as we shall see below , the fifth force is spatial ( perpendicular to the worldline of the dark matter particle ) and can not change the mass of dark matter particles .",
    "consequently the averaged dark matter mass density is the same as in @xmath1cdm .",
    "one can of course define the energy momentum tensor for dark matter as including @xmath13 , and in this case eq .",
    "( [ eq : bg_rho_cdm ] ) will no longer be valid and we end up with varying mass dark matter particles .",
    "@xmath269      @xmath270      @xmath271a^{2 } & = & 0,\\\\ k\\eta ' + 2\\frac{a'}{a}ka + \\kappa qa^{2 } & = & 0,\\end{aligned}\\ ] ]    in which we have used @xmath272 and defined the density contrast @xmath273 for matter species @xmath274 .",
    "@xmath275a^{2 } & = & 0,\\\\ k^{2}\\eta",
    "+ 2\\frac{a'}{a}k\\mathcal{z } - \\kappa\\mathcal{x}a^{2 } & = & 0.\\end{aligned}\\ ] ]      @xmath276      @xmath277    when it comes to perturbation calculations , we need to fix a gauge , _",
    "i.e. _ , choose a @xmath155 .",
    "one possibility is to use the 4-velocity of dark matter particles as our @xmath155 . in this case",
    "the dark matter heat flux is zero and according to eq .",
    "( [ eq : pb_v_cdm ] ) we will simply have @xmath278 , and this relation can then be used to replace the @xmath245 s appearing in all the above equations .",
    "another possibility is to choose @xmath155 such that @xmath80 : in this case @xmath81 will become nonzero and we need to dynamically evolve it .",
    "below in the numerical calculations we shall adopt the second possibility .",
    "in the mlapm code the partial differential equation eq .",
    "( [ eq : intpoisson ] ) is ( and in our modified code eq .",
    "( [ eq : intphieom ] ) will also be ) solved on discretized grid points , and as such we must develop the discretized versions of eqs .",
    "( [ eq : intdxdtcomov ] - [ eq : intphieom ] ) to be implemented into the code .    but before going on to the discretization , we need to address a technical issue .",
    "as the potential is highly nonlinear , in the high density regime the value of the scalar field @xmath279 will be very close to 0 , and this is potentially a disaster as during the numerical solution process the value of @xmath279 might easily go into the forbidden region @xmath171 @xcite .",
    "one way of solving this problem is to define @xmath280 in which @xmath281 is the background value of @xmath282 , as in @xcite .",
    "then the new variable @xmath170 takes value in @xmath283 so that @xmath284 is positive definite which ensures that @xmath285 .",
    "however , since there are already exponentials of @xmath282 in the potential , this substitution will result terms involving @xmath286 $ ] , which could potentially magnify any numerical error in @xmath170 .    instead",
    ", we can define a new variable @xmath170 according to @xmath287 by this , @xmath170 still takes value in @xmath283 , @xmath288 and thus @xmath289 which ensures that @xmath282 is positive definite in numerical solutions .",
    "besides , @xmath290^{\\beta}$ ] so that there will be no exponential - of - exponential terms , and the only exponential is what we have for the potential itself .",
    "@xmath291 above .",
    "then the poisson equation becomes @xmath292\\nonumber\\\\ & & - \\frac{3\\omega_{v_{0}}a^{3}}{\\left[1-\\left(1+e^{u}\\right)^{\\beta}\\right]^{\\mu } } + 3\\bar{\\omega}_{v}a^{3},\\end{aligned}\\ ] ] where we have defined @xmath293 which is determined by background cosmology , the quantity @xmath294 is also determined solely by background cosmology .",
    "these background quantities should not bother us here .",
    "the scalar field eom becomes @xmath295^{\\mu+1}}\\nonumber\\\\ & & - 3\\gamma\\omega_{\\mathrm{cdm}}e^{\\gamma\\sqrt{\\kappa}\\bar{\\varphi } } - \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi } } } { \\left[1-e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi}}\\right]^{m+1}}\\end{aligned}\\ ] ] in which we have used the fact that @xmath296 , and moved all terms depending only on background cosmology ( the source terms ) to the right hand side .",
    "so , in terms of the new variable @xmath170 , the set of equations used in the n - body code should be @xmath297 plus eqs .",
    "( [ eq : u_poisson ] , [ eq : u_phi_eom ] ) .",
    "these equations will ultimately be used in the code . among them , eqs .",
    "( [ eq : u_poisson ] , [ eq : u_dpdt ] ) will use the value of @xmath170 while eq .",
    "( [ eq : u_phi_eom ] ) solves for @xmath170 . in order that these equations can be integrated into mlapm",
    ", we need to discretize eq .",
    "( [ eq : u_phi_eom ] ) for the application of newton - gauss - seidel iterations .    to discretize eq .",
    "( [ eq : u_phi_eom ] ) , let us define @xmath298 .",
    "the discretization involves writing down a discretion version of this equation on a uniform grid with grid spacing @xmath299 .",
    "suppose we require second order precision as is in the standard poisson solver of mlapm , then @xmath300 in one dimension can be written as @xmath301 where a subscript @xmath302 means that the quantity is evaluated on the @xmath303-th point .",
    "of course the generalization to three dimensions is straightforward .",
    "@xmath309\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right].\\end{aligned}\\ ] ]      @xmath311\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right]\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}\\left[3\\gamma\\omega_{\\mathrm{cdm}}\\rho_{c , i , j , k } \\left(1+e^{u_{i , j , k}}\\right)^{\\gamma } + \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}\\left(1+e^{u_{i , j , k}}\\right)^{\\beta } } { \\left[1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}\\right]^{\\mu+1}}\\right]\\nonumber\\\\ & & + \\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}\\left [ 3\\gamma\\omega_{\\mathrm{cdm}}e^{\\gamma\\sqrt{\\kappa}\\bar{\\varphi } } + \\frac{3\\mu\\beta\\omega_{v_{0}}a^{3}e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi } } } { \\left[1-e^{\\beta\\sqrt{\\kappa}\\bar{\\varphi}}\\right]^{\\mu+1}}\\right].\\end{aligned}\\ ] ]    then the newton - gauss - seidel iteration says that we can obtain a new ( and often more accurate ) solution of @xmath170 , @xmath312 , using our knowledge about the old ( and less accurate ) solution @xmath313 as @xmath314 the old solution will be replaced by the new solution to @xmath315 once the new solution is ready , using the red - black gauss - seidel sweeping scheme .",
    "note that    @xmath316\\nonumber\\\\ & & -\\frac{1}{2h^{2}}\\left[b_{i+1,j , k}+b_{i-1,j , k}+b_{i , j+1,k } + b_{i , j-1,k}+b_{i , j , k+1}+b_{i , j , k-1}+6b_{i , j , k}\\right]\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2}}3\\gamma^{2}\\omega_{\\mathrm{cdm}}\\rho_{c , i , j , k } \\left(1+e^{u_{i , j , k}}\\right)^{\\gamma}b_{i , j , k}\\nonumber\\\\ & & -\\frac{\\left(h_{0}b\\right)^{2}}{ac^{2 } } \\frac{3\\mu\\beta^{2}\\omega_{v_{0}}a^{3}\\left(1+e^{u_{i , j , k}}\\right)^{\\beta } } { \\left[1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}\\right]^{\\mu+1}}b_{i , j , k } \\left[1+(\\mu+1)\\frac{\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}}{1-\\left(1+e^{u_{i , j , k}}\\right)^{\\beta}}\\right].\\end{aligned}\\ ] ]    in principle , if we start from a high redshift , then the initial guess of @xmath315 could be such that the initial value of @xmath282 in all the space is equal to the background value @xmath281 , because anyway at this time we expect this to be approximately true . for subsequent time steps we could use the solution for @xmath315 at the previous time step as our initial guess ; if the time step is small enough then we do not expect @xmath170 to change significantly between consecutive times so that such a guess will be good enough for the iteration to converge fast ."
  ],
  "abstract_text": [
    "<S> we lay out the frameworks to numerically study the structure formation in both linear and nonlinear regimes in general dark - matter - coupled scalar field models , and give an explicit example where the scalar field serves as a dynamical dark energy . adopting parameters of the scalar field which yield a realistic cmb spectrum </S>",
    "<S> , we generate the initial conditions for our n - body simulations , which follow the spatial distributions of the dark matter and the scalar field by solving their equations of motion using the multilevel adaptive grid technique . </S>",
    "<S> we show that the spatial configuration of the scalar field tracks well the voids and clusters of dark matter . </S>",
    "<S> indeed , the propagation of scalar degree of freedom effectively acts a fifth force on dark matter particles , whose range and magnitude are determined by the two model parameters @xmath0 , local dark matter density as well as the background value for the scalar field . </S>",
    "<S> the model behaves like the @xmath1cdm paradigm on scales relevant to the cmb spectrum , which are well beyond the probe of the local fifth force and thus not significantly affected by the matter - scalar coupling . on scales comparable or shorter than the range of the local fifth force , </S>",
    "<S> the fifth force is perfectly parallel to gravity and their strengths have a fixed ratio @xmath2 determined by the matter - scalar coupling , provided that the chameleon effect is weak ; if on the other hand there is a strong chameleon effect ( _ i.e. _ , the scalar field almost resides at its effective potential minimum everywhere in the space ) , the fifth force indeed has suppressed effects in high density regions and shows no obvious correlation with gravity , which means that the dark - matter - scalar - field coupling is not simply equivalent to a rescaling of the gravitational constant or the mass of the dark matter particles . </S>",
    "<S> we show these spatial distributions and ( lack of ) correlations at typical redshifts ( @xmath3 ) in our multi - grid million - particle simulations . </S>",
    "<S> the viable parameters for the scalar field can be inferred on intermediate or small scales at late times from , _ </S>",
    "<S> e.g. _ , weak lensing and phase space properties , while the predicted hubble expansion and linearly simulated cmb spectrum are virtually indistinguishable from the standard @xmath1cdm predictions . </S>"
  ]
}