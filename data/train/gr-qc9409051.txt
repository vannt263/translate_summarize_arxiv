{
  "article_text": [
    "many of the most interesting astrophysical systems can be described by the equations of hydrodynamics coupled to gravity . among these",
    "are sources of gravitational waves such as inspiralling neutron star binaries and collapsing compact stars undergoing global rotational instabilities ( thorne 1987 , 1992 ; schutz 1989 ) . with the prospect of several gravitational wave detectors becoming operational within a decade ( see abramovici , et al . 1992 and references therein ) , the detailed modeling of such sources has a high priority .",
    "since these are time - dependent , nonlinear , and fully 3-d systems , calculating the gravitational radiation they produce requires numerical simulations .",
    "we have developed a 3-d eulerian hydrodynamics code to model such sources .",
    "the code is written in cylindrical coordinates with a moving grid .",
    "it uses newtonian gravity and calculates the gravitational radiation produced in the quadrupole limit .",
    "the code is structured so that post - newtonian effects , and even the full field equations of general relativity , can be coupled to the basic hydrodynamics routines in the future . in this paper",
    "we describe this code and the tests we have performed to insure its accuracy .",
    "section  [ hydro - eqs ] presents the basic hydrodynamical equations on which the code is built and   [ sec - grid - cen ] discusses the numerical grids and the centering of the basic variables on those grids .",
    "the numerical implementation of the hydrodynamical equations is presented in detail in   [ sec - fd ] , including a discussion of the finite differencing techniques used .",
    "the method used to solve poisson s equation is discussed in   [ sec - pois ] .",
    "section  [ extract ] considers the extraction of gravitational radiation using various quadrupole formulae .",
    "the test - bed problems we ran on the code and the results we obtained are presented in ",
    "[ tests ] .",
    "finally ,   [ summary ] summarizes our work .",
    "we begin with the basic equations of hydrodynamics ( landau & lifshitz 1959 ; bowers & wilson 1991 ) . conservation of mass gives the mass continuity equation @xmath3 where @xmath4 is the total or lagrangian time derivative . for a moving coordinate system @xmath5 where @xmath6 is the velocity of the fluid , @xmath7 is the velocity of the fluid relative to the grid , and @xmath8 is the velocity of the grid .",
    "substituting this into  ( [ mass - cont - l ] ) gives @xmath9 which is the mass continuity equation with a moving grid .",
    "the remaining equations will all be given in a form which shows the moving grid terms explicitly .",
    "the momentum conservation equation , or euler s equation , is @xmath10 or , in component form , @xmath11 where @xmath12 is the body force density .",
    "the body force can arise from many sources , including self - gravity of the fluid , electric and magnetic fields generated within the fluid , and externally applied fields . in the current version of the code , we are only concerned with the body force density due to the self - gravity of the fluid .",
    "this is given by @xmath13 where the gravitational potential @xmath14 satisfies poisson s equation @xmath15 we follow bowers & wilson ( 1991 ) and use an internal energy equation @xmath16 where @xmath17 is the specific internal energy of the fluid .",
    "to complete this set we need the equation of state ( eos ) of the fluid , @xmath18 . in this paper",
    "we use the eos for a perfect fluid , @xmath19 more sophisticated equations of state , in the form of analytic expressions or tabulated values , can be inserted into the code in the future .",
    "we use a cylindrical coordinate system in our code since it gives an efficient means of modeling rotating systems ; in addition stellar collisions and inspiralling binary stars can easily be set up . to formulate the hydrodynamical equations in cylindrical coordinates @xmath0",
    "we write @xmath20 , with similar expressions for @xmath8 and @xmath7 ( note that @xmath21 is a _ linear _ velocity so that @xmath22 , where @xmath23 is the angular velocity ) . with this , and the definition of the gradient in cylindrical coordinates , the hydrodynamical equations take the following forms ( clancy 1989 ; smith 1993 ) .",
    "the mass continuity equation  ( [ mass - cont ] ) becomes @xmath24 and the internal energy equation  ( [ energy ] ) is euler s equation ( [ euler ] ) in component form becomesand @xmath25poisson s equation ( [ poisson ] ) for the potential @xmath14 in cylindrical coordinates is @xmath26 the eos is independent of coordinates , and remains unchanged .",
    "thus , ( [ mass - cyl])([poisson - cyl ] ) , along with ( [ ideal - gas ] ) , are the equations that will be implemented in the hydrodynamics code .",
    "the next step is to define the numerical grids in space and time on which the hydrodynamical equations will be discretized .",
    "we use staggered spatial and temporal grids , and place the physical variables in such a way as to simplify calculations ( bowers & wilson 1991 ) .",
    "for each of the cylindrical coordinates @xmath0 we define two grids : a `` zone centered '' grid , which has nodes at the centers of grid zones , and a `` face centered '' grid , which has nodes on the faces or boundaries separating grid zones .",
    "this is illustrated for the axial or z - grid in figure  [ z - gridfig ] . in our notation ,",
    "grid zone boundaries are denoted by integral indices and zone centers by half - integral indices .",
    "thus , for an array of zone boundaries @xmath27 , the center of the @xmath28th axial zone is given by @xmath29 and the grid spacings are @xmath30 and @xmath31 the radial and angular grids are handled in a similar manner .",
    "for example , the @xmath32th radial zone is bounded by @xmath33 and @xmath34 , and has its center at @xmath35 the evolution of the fluid is carried out on grids that are staggered in time . for reasons that will become evident later , the zone centered quantities are defined at integral time steps , while face centered variables are defined at half - integral time steps .    throughout this paper",
    ", we use the subscript indices @xmath36 and the superscript @xmath37 to refer to the grids in @xmath38 , and @xmath39 , respectively .",
    "thus , a zone centered quantity @xmath40 is written @xmath41 and a face centered quantity @xmath42 is @xmath43 any variable that has three half - integral spatial indices is defined at the center of a 3-d grid cell .",
    "variables having two half - integral indices and one integral index are defined in the center of a zone face ( the surface separating two neighboring zones ) . while it is occasionally necessary to evaluate a quantity at a zone edge ( where four zones meet , specified by one half - integral and two integral indices ) ,",
    "physical quantities are never evaluated at zone corners ( all integral indices ) .    in order to reduce memory requirements",
    "we have chosen to let our grid cover only the `` top '' of the coordinate system @xmath44 , which restricts us to treating problems for which @xmath45 is a plane of reflection symmetry .",
    "this is not currently a serious limitation , as there is a large class of interesting problems possessing such a plane of symmetry .",
    "furthermore , this restriction can be removed in the future with a small number of changes .    in our code scalar quantities , such as mass , density , and gravitational potential , are defined at the zone centers and at integral time steps .",
    "vector quantities , such as velocities , are defined on the faces between zones and at half - integral time steps .",
    "this is the most natural choice for locating the variables , since the velocities are updated using the gradients of scalar quantities ( pressure and gravitational potential ) , which are naturally defined on the zone faces , and the velocities are used to transport scalar quantities between zones .",
    "the velocity components are face - centered in the coordinate along which they are directed , as illustrated in figure  [ gridfig ] .",
    "the physical variables thus map onto the spatial and temporal numerical grids as follows :    = density :  = @xmath46   = @xmath47  = @xmath48 + specific internal energy : @xmath49 @xmath47 @xmath50 + pressure : @xmath51 @xmath47 @xmath52 + gravitational potential : @xmath53 @xmath47 @xmath54 + fluid velocity : @xmath55 @xmath47 @xmath56 + @xmath57 @xmath47 @xmath58 + @xmath59 @xmath47 @xmath60 + grid velocity : @xmath61 @xmath47 @xmath62 ,",
    "@xmath63 + @xmath64 @xmath47 @xmath65 , @xmath66 + @xmath67 @xmath47 @xmath68 , @xmath69 +    note that each component of the grid velocity maps into two 1-d arrays , one for the zone centered grid and one for the face centered grid in that coordinate .",
    "it is sometimes necessary to evaluate a zone centered quantity on a face centered grid ; we accomplish this by using a volume average ( clancy 1989 ) .",
    "consider the case of averaging a zone centered quantity @xmath70 ( temporal index suppressed ) in the axial direction to obtain the value @xmath71 .",
    "zone centered quantities are defined to be constant throughout the zone , as indicated in figure  [ fig - average ] .",
    "the volume averaged value of @xmath72 in the @xmath2-direction is given by @xmath73 which reduces to a simple average if all volume elements are equal .",
    "since the volume element is @xmath74 equation  ( [ vol - avg ] ) reduces to @xmath75 similarly , volume averaging in the angular direction gives @xmath76    a problem arises if this simple prescription is followed for volume averaging in the @xmath1-direction .",
    "the radial averaged analog of ( [ vol - avg ] ) is @xmath77 however , this expression will introduce inaccuracy arising from the curvature of the coordinate system .",
    "for example , if @xmath78 ( angular and axial subscripts suppressed ) , then the face centered quantity @xmath79 should have this same value .",
    "if ( [ r - vol - avg ] ) is applied , however , we see that @xmath79 differs from the values on either side by a factor @xmath80 the numerical error present in this term is particularly pronounced near the axis coordinate singularity .",
    "however , it can easily be avoided by replacing the radius @xmath33 in the denominator of ( [ r - vol - avg ] ) with a curvature corrected radius @xmath81 given by @xmath82 to yield @xmath83 using equation  ( [ rt - vol - avg ] ) provides a more accurate volume average in the radial direction , and helps to avoid singular behavior on the coordinate axis .",
    "it is also necessary to evaluate face centered quantities at zone centers , and this is accomplished using expressions analogous to ( [ z - vol - avg ] ) , ( [ t - vol - avg ] ) , ( [ rtilde ] ) , and ( [ rt - vol - avg ] ) .",
    "these are given by @xmath84 @xmath85 and @xmath86 where @xmath87",
    "in this section we obtain the operator split , finite difference versions of the eulerian hydrodynamical equations ( [ mass - cyl ] ) - ( [ poisson - cyl ] ) .",
    "we assume that the values of the scalar variables are known at time step @xmath37 and that the velocities are known at time step @xmath88 .",
    "when constructing a general purpose hydrodynamics code it is important to maintain flexibility and allow for future modifications by using structured programming techniques .",
    "our code is divided into a large number of separate subroutines , each of which is dedicated to a specific task and may be replaced or modified as needed for particular astrophysical problems ( bowers & wilson 1991 ) .",
    "this modular structure allows the program to be easily adapted to study new situations , adding or removing different processes as desired , and makes it possible to change a subroutine without affecting other parts of the program .",
    "the central portion of our code is the `` main driver '' routine , which is responsible for determining the flow of the program during execution .",
    "it determines which subroutines will be included in the computation , what outputs will be required , when to write out data , and at what point to stop the calculation .",
    "the first task of the main driver is to call a setup routine that reads in various input files , sets up the coordinate grids , and either generates or reads in the initial data , depending on the problem being run .",
    "once the initial configuration has been determined control is passed back to the main driver , which calls the physics driver to propagate the system forward in time .",
    "whenever appropriate the main driver will call the routines that output graphics , restart dumps , and other data .",
    "the evolution of the physical system is carried out by the physics driver , which coordinates the numerical integration of the hydrodynamical equations with the calculation of the newtonian gravitational field and the gravitational radiation quantities .",
    "the hydrodynamics computation is performed by a large number of subroutines , each devoted to a separate task such as the advection of a particular quantity along a given coordinate direction .",
    "the gravitational potential calculation is separated into computing the boundary conditions and solving poisson s equation .",
    "this modular structure permits the simple interchange of different methods of implementing certain calculations , such as differencing the advection terms , solving poisson s equation , or computing the gravitational radiation .",
    "it further allows for changes in the physical system such as specifying a different eos or using a 1-d or 2-d grid to treat problems that do not require a full 3-d calculation .",
    "one may choose to skip certain calculations , such as not solving poisson s equation for the case of a pure hydrodynamics problem without gravity .",
    "finally , if it becomes desirable to include additional physics , such as radiation transport , magneto - hydrodynamics , or the effects of nuclear processes , this can be done by adding new subroutines for computing these processes .",
    "we use the technique of _ operator splitting _ ( wilson 1979 ; bowers & wilson 1991 ) to solve the hydrodynamical equations ( [ mass - cyl ] ) - ( [ euler - phi ] ) . in this method ,",
    "terms are split off from the original set of equations and are successively applied to update the physical variables .",
    "thus , the full set of equations is not solved simultaneously , and each variable is not updated due to the full set of physical processes in a single operation . instead , each variable is partially updated under the approximation that only a single process is responsible , and each physical process is applied sequentially to update that variable fully .",
    "the order in which each term is updated can be important for the accuracy and stability of the code , and is generally determined by experience and experiment .",
    "the order used in our code is based on the accumulated experience of many people with different numerical codes , and is thought to be particularly good for treating shocks ( clancy 1989 ; bowers & wilson 1991 ) .",
    "we first divide the solution of the hydrodynamical equations into a `` lagrangian step '' , including lagrangian - like processes such as acceleration and work done on a given fluid element , and a `` transport step '' , which includes both transport of material through the grid and grid motion .",
    "the lagrangian step is performed first , with the following sequence of operations :    = ( a )  = update velocities due to pressure and gravitational forces ; + ( b ) update velocities and energy due to artificial viscosity , using the + updated velocities from step ( a ) ; + ( c ) update energy due to mechanical or compressional work , using the updated quantities + from step ( b ) .",
    "the transport step is then performed to update mass density , energy , and velocities due to the transport of fluid across zone boundaries and due to the changes in the zones arising from the grid motion .",
    "the transport step is broken into three parts , one for advection in each of the three coordinate directions . to minimize numerical artifacts , the order in which the transport in each direction is performed is varied with each cycle .",
    "thus , on the first cycle the radial advection might be performed first , followed by the axial and angular advections , while on the next cycle the order might be axial - angular - radial , with the order changing on each successive cycle until all six permutations have been exhausted . at the end of the transport calculation in each direction ,",
    "a momentum conservation condition is applied to update the velocities . for each successive substep of the transport step ,",
    "the input variables contain the updated values from the previous substep .",
    "the lagrangian step begins by updating the terms containing the accelerations due to gravity and pressure gradients .",
    "for the @xmath1 component of momentum , with the density held constant , the acceleration part of ( [ euler - r ] ) is simply @xmath89 integrating this over the volume element @xmath90 we obtain , after some manipulation , where @xmath91 is used to indicate that the velocity has been _ partially _ updated to the next time level @xmath92 . here , @xmath93 is the radial edge centered density defined by the volume averaging method given by ( [ rt - vol - avg ] ) .",
    "similarly , ( [ euler - z ] ) and ( [ euler - phi ] ) becomeandwhere the @xmath2 and @xmath94 face centered densities are defined by ( [ z - vol - avg ] ) and ( [ t - vol - avg ] ) .    at this point in the code",
    "the effects of artificial viscosity are included .",
    "the discussion of these terms is deferred to the next section , however , so that they may be treated in greater detail .",
    "next we consider the lagrangian term for mechanical or compressional work . separating this term out of ( [ ener - cyl ] ) yields @xmath95 the finite difference version of this equation is @xmath96 where all quantities are evaluated at zone center , the common subscripts @xmath97 , @xmath98 , @xmath99 have been omitted for convenience , and we have used the superscript @xmath100 and @xmath101 to denote partial updates due to compressional work and artificial viscosity , respectively .",
    "the finite difference velocity divergence that appears in  ( [ fdwork-1 ] ) is given bythe pressure that appears in ( [ fdwork-1 ] ) must be evaluated at time step @xmath92 .",
    "since pressure is calculated from the eos and the density and energy are known only at time step @xmath37 , we approximate this by @xmath102 where the partial derivatives are evaluated using the known values of @xmath103 and @xmath104 at time step @xmath37 . depending on the eos being used , an analytic form may be available for these partial derivatives , or they may be interpolated from a table . using @xmath105 ,",
    "we convert ( [ fdwork-1 ] ) into an equation for the change in internal energy , @xmath106 ( \\nabla\\cdot\\vec{v})^{q}\\delta t^{n+\\frac{1}{2 } } } { \\rho^c+\\frac{1}{2}\\left(\\frac{\\partial p}{\\partial\\varepsilon}\\right)^n_{\\rho } ( \\nabla\\cdot\\vec{v})^{q}\\delta t^{n+\\frac{1}{2 } } } .",
    "\\label{fdwork}\\ ] ] we obtain @xmath107 and @xmath108 by using the fact that , since this is a lagrangian process , the density must obey the condition @xmath109 when these values are substituted into ( [ fdwork ] ) along with ( [ vdiv ] ) and the partial derivatives of the eos , we get an explicit formula for updating the internal energy due to the effects of mechanical work . for the case of the ideal gas eos ( [ ideal - gas ] ) we have @xmath110 }",
    "{ 1 + \\frac{1}{2}(\\gamma -1)\\left[1 + \\frac{1}{2}(\\nabla\\cdot\\vec{v})\\delta t\\right](\\nabla\\cdot\\vec{v})\\delta t}\\right\\ } , \\label{int - mech}\\ ] ] where the velocity divergence is evaluated using ( [ vdiv ] ) .",
    "the effects of artificial viscosity are part of the lagrangian step , and these terms are actually updated in our code prior to the treatment of mechanical work as noted above .",
    "however , we have separated the discussion of artificial viscosity from the rest of the lagrangian processes because it warrants a more thorough treatment .",
    "artificial viscosity is not a true physical process , but has been developed to mimic the effects of physical processes in shock fronts which occur on length scales much smaller than that of the numerical grid .",
    "the original concept was developed by von neumann & richtmeyer ( 1949 ) and a modern discussion can be found in bowers & wilson ( 1991 ) .",
    "artificial viscosity is designed to take the place of the microphysics of true molecular viscosity in shock fronts . by analogy to the equations of molecular viscosity we write the artificial viscosity terms in the momentum and energy equations in the form ( bowers & wilson 1991 ) : @xmath111 and @xmath112 the quantity @xmath113 is the tensor artificial viscosity defined by @xmath114 where @xmath115 and @xmath116 are constants that specify the amount of compressional and shear viscosity , respectively , and are given as input to the program .",
    "we use the notation @xmath117 the definition of the diagonal terms @xmath118 in ( [ avtensor ] ) ensures that artificial viscosity is present under circumstances of compression but not expansion .",
    "currently we are not including shear artificial viscosity in our code , so we take @xmath119 and limit our attention to the compressional terms .    when the artificial viscosity is placed on the numerical grid the compressional terms are zone centered .",
    "thus the finite difference version of the radial component of ( [ avtensor ] ) is @xmath120 assuming that @xmath121 .",
    "note that the artificial viscosity tensor is calculated using the velocity that has been partially updated by the pressure and potential gradients .",
    "the other diagonal components , again assuming that @xmath122 and @xmath123 , are given by @xmath124 and @xmath125    with these expressions the acceleration terms ( [ artv1 ] ) , including only the compressional viscosity , can easily be differenced to obtain @xmath126 @xmath127 and @xmath128 here we have suppressed the common subscripts @xmath129 wherever they appear and have used the superscript @xmath101 to indicate the partial update due to artificial viscosity .    finally , the shock heating from ( [ artv2 ] ) is @xmath130.\\ ] ] again , the common subscripts @xmath129 have been suppressed in each term . note that although the velocities used in the shock heating have already been updated by ( [ artvv])([artvw ] ) , the artificial viscosity tensor is the same one calculated previously and used to update the velocities .",
    "the transport step includes terms involving advection and the change in zone size .",
    "it is divided into three parts , for transport along each of the three coordinate directions . to minimize numerical effects , the order in which these substeps are performed is varied on each cycle through all possible permutations .",
    "we use a second order monotonic advection scheme developed by leblanc ( clancy 1989 ; bowers & wilson 1991 ) , and the consistent advection scheme of norman and winkler ( 1986 ) for angular momentum transport .    first , consider the transport of mass density in the @xmath2-direction .",
    "the relevant transport terms from ( [ mass - cyl ] ) are @xmath131 integrating this equation over a zone volume and rearranging terms gives @xmath132\\right\\ } -\\frac{\\delta t^{n+\\frac{1}{2}}}{\\delta z_{k+\\frac{1}{2 } } } \\left[\\left(\\rho^*u_r\\right)_{k+1}-\\left(\\rho^*u_r\\right)_{k}\\right ] , \\label{zadv-1}\\ ] ] where we have suppressed the indices @xmath133 , and the superscript @xmath134 is used to indicate that the density has been partially updated by advection in the @xmath2-direction .",
    "the quantity @xmath135 represents the density interpolated to the zone face ; this interpolation is performed using a monotonic scheme as described in ",
    "[ sec - mono ] below .",
    "the first term on the right hand side of ( [ zadv-1 ] ) can be shown to be a first order approximation to the change in density due to the change in the cell volume caused by the motion of the @xmath2-grid . since the second term , which specifies the change in density due to the transport of matter across the zone boundaries ,",
    "will be given to second order by the monotonic interpolation scheme specified below , the first order term limits the accuracy of the calculation when the grid velocity is non - zero .",
    "however , if the grid position at the updated time step , @xmath136 , is known , we can replace this approximation by the exact expression to give @xmath137 , \\label{zadv - d}\\ ] ] where we have also used the updated zone spacing in the second term .",
    "since the effects of the change in grid spacing are treated exactly in ( [ zadv - d ] ) , the accuracy is determined by the transport term , which is second order .",
    "this gives a higher degree of accuracy than ( [ zadv-1 ] ) when the moving grid is used ( and the same accuracy when the grid is stationary ) , and therefore we use ( [ zadv - d ] ) in our code .",
    "the energy transport in the @xmath2-directon can be treated in similar fashion , yielding @xmath138 , \\label{zadv - e}\\ ] ] where @xmath139 is calculated using a monotonic interpolation scheme , and we have again suppressed the common subscripts @xmath133 . the specific internal energy at the updated time level is then @xmath140 where @xmath141 is defined in ( [ zadv - d ] ) .",
    "the term @xmath142 in  ( [ zadv - e ] ) involves the internal energy @xmath143 , which was updated for mechanical work in equation  ( [ int - mech ] ) in the lagrangian step .",
    "this is given by @xmath144 where @xmath108 is the density updated under lagrangian conditions for mechanical work similar to those used to get @xmath143 .",
    "to obtain @xmath108 we apply the lagrangian density condition ( [ lag - rho ] ) , but include only the effects of axial velocity ; this gives @xmath145 where @xmath146 and the superscript @xmath101 indicates that the velocity has been updated by artificial viscosity .",
    "a similar procedure is used to transport the radial and axial momentum in the @xmath2-direction in ( [ euler - r ] ) and ( [ euler - z ] ) , yielding @xmath147 , \\label{zadv - v}\\ ] ] where the common subscripts @xmath148 have been suppressed , and @xmath149 , \\label{zadv - u}\\ ] ] where the common subscripts @xmath133 have been suppressed .",
    "several of the quantities in these equations are not evaluated at their usual positions on the grid , and these values are obtained by volume averaging as described in   [ sec - grid - cen ] above . in particular , the edge centered velocity @xmath150 in ( [ zadv - v ] ) and the zone centered velocity @xmath151 in ( [ zadv - u ] ) must be obtained from the velocity field @xmath152 before the monotonic scheme is applied to obtain @xmath153 and @xmath154 in each equation . the densities @xmath155 and @xmath156 are obtained by a volume average of the monotonic density @xmath157 that was calculated in ( [ zadv - d ] ) .",
    "the advection of angular momentum presents special problems in finite difference codes , and will be discussed more fully in   [ sec - mono ] below . at this point",
    "we simply state that it is advantageous to perform the advection in terms of the specific angular momentum , @xmath158 . when placed on the finite difference grid , this becomes @xmath159 the @xmath2-transport terms from ( [ euler - phi ] ) can be rewritten in terms of the specific angular momentum as @xmath160 in finite difference form this becomes @xmath161 , \\label{zadv - w}\\ ] ] where we have again suppressed the indices @xmath162 .",
    "the symbol @xmath163 is used to indicate that we have used a `` smooth '' value of @xmath164 in the monotonic interpolation scheme for the transport terms ; see equation  ( [ smooth ] ) below . as before ,",
    "we obtain the edge centered relative velocity @xmath165 by volume averaging before applying the monotonic interpolation scheme to the angular quantities , and get the density @xmath166 from a volume average of the interpolated density in ( [ zadv - d ] ) .    during the momentum advection",
    "the density has been held constant at time level @xmath37 . in order to ensure momentum conservation",
    "as the density is updated to time step @xmath167 we must update the velocity by @xmath168 where @xmath103 is evaluated at the appropriate grid location for each of the velocity components .",
    "in component form , this gives @xmath169_{j , k+\\frac{1}{2},l+\\frac{1}{2}},\\ ] ] @xmath170_{j+\\frac{1}{2},k , l+\\frac{1}{2 } } , \\label{mocon - cpts}\\ ] ] and @xmath171_{j+\\frac{1}{2},k+\\frac{1}{2},l},\\ ] ] where the face centered densities are again calculated using volume averaging .",
    "this update completes the transport in the axial direction .    the advection in the radial and angular directions",
    "is accomplished in a similar fashion , with results as follows .    for radial advection : @xmath172 , \\label{radv - d}\\ ] ] @xmath173 , \\label{radv - e}\\ ] ] @xmath174 , \\label{radv - v}\\ ] ] @xmath175_k , \\label{radv - u}\\ ] ] and @xmath176_l .",
    "\\label{radv - w}\\ ] ] here we have suppressed the indices @xmath177 throughout .",
    "the coordinate @xmath178 is the radial position at which the monotonically interpolated quantities are evaluated , as discussed in the next section .",
    "the velocities @xmath179 , @xmath180 and @xmath181 in ( [ radv - v ] ) , ( [ radv - u ] ) and ( [ radv - w ] ) , respectively , are obtained by volume averaging before the monotonic interpolation scheme is applied , and the densities @xmath182 , @xmath183 and @xmath184 are obtained by volume averaging the density @xmath185 that results from monotonic interpolation in the radial direction .",
    "the specific internal energy @xmath186 is obtained from ( [ radv - e ] ) by using ( [ rhoc ] ) , with the velocity divergence term replaced with the radial velocity divergence @xmath187    for angular advection , with the indices @xmath188 suppressed throughout : @xmath189 , \\label{wadv - d}\\ ] ] @xmath190 , \\label{wadv - e}\\ ] ] @xmath191_j , \\label{wadv - v}\\ ] ] @xmath192_k , \\label{wadv - u}\\ ] ] and @xmath193 .",
    "\\label{wadv - w}\\ ] ] we again evaluate @xmath194 , @xmath195 and @xmath196 by volume averaging before applying the monotonic interpolation and obtain @xmath184 , @xmath197 and @xmath198 by volume averaging the density @xmath199 , which is monotonically interpolated in the angular direction . as before , we get @xmath200 from ( [ wadv - e ] ) and ( [ rhoc ] ) with the velocity divergence term now replaced with its angular analog , @xmath201    as noted above , the order in which the advection is carried out along each of the coordinate directions is varied with each time step through all six permutations .",
    "this is done to minimize any non - physical effects that might arise from carrying out the advection in the same order on each cycle .",
    "the momentum conservation calculation ( [ mocon])([mocon - cpts ] ) is performed at the end of the transport in each direction .",
    "caution should thus be exercised in interpreting each of the partially updated time levels occurring in ( [ zadv-1])([wadv - w ] ) .",
    "for example , the values of @xmath202 , @xmath203 , and @xmath204 may refer to the values of those variables after advection along one or more directions rather than at the end of the lagrangian step .",
    "the full time level update @xmath167 indicated in ( [ mocon])([mocon - cpts ] ) is only achieved after advection has been completed in all three directions .      in transporting physical quantities from one zone to another",
    "it is necessary to obtain an accurate value for the quantity crossing the zone face .",
    "this is accomplished by using a monotonic interpolation scheme from the zone center to the zone face .",
    "the method that we are currently using is a second order accurate scheme developed by leblanc ( clancy 1989 ; bowers & wilson 1991 ) , although the option currently exists in the code to use either donor cell advection or a monotonic scheme developed by barton ( see centrella & wilson 1984 ) .",
    "the simplest advection scheme is the donor cell method , in which the density of the material that flows from one cell to another is simply taken to be the density in the cell that it is flowing out of .",
    "for example , if we are considering mass advection in the radial direction between cell @xmath205 and cell @xmath206 , then the value of the density would be taken as @xmath207 if @xmath208 and @xmath209 if @xmath210 .",
    "the total mass transferred from cell @xmath205 to cell @xmath206 would be @xmath211 .",
    "this method is only accurate to first order and produces large numerical diffusion ( bowers & wilson 1991 ) .    in order to achieve higher accuracy , it is preferable to interpolate zone centered quantities to face centers using a method that preserves monotonicity in the quantity being advected ( van leer 1974 ; bowers & wilson 1991 ) .",
    "monotonic advection prevents zones from being evacuated and eliminates unstable zone to zone oscillations ; see hawley , smarr and wilson ( 1984b ) for a study of various second order monotonic schemes .",
    "we have found the leblanc method to produce the best results in test problems .",
    "the leblanc interpolation scheme is illustrated in figure  [ monofig ] for the advection of density in the @xmath2-direction ; a similar treatment applies to the advection of all quantities along any direction .",
    "the purpose of the interpolation is to determine the value of the density at the zone face @xmath212 ( actually , near the zone face , as described below ) .",
    "we use the density in zone @xmath213 and the two neighboring zones to get the slope of the density function , @xmath214 , in that zone , and then use that slope to interpolate the density to the zone face . to obtain @xmath214 we first calculate the three slopes @xmath215 , and @xmath216 as shown in figure  [ monofig ] .",
    "we assume that the densities @xmath217 and @xmath218 are constant in the cells @xmath219 and @xmath220 , respectively .",
    "the `` left '' slope @xmath221 is then calculated by using @xmath217 at the zone face @xmath212 and assuming that the density varies linearly from that value to the value @xmath222 , as shown in figure  [ monofig ] .",
    "this gives @xmath223 a similar calculation using @xmath218 at the zone face @xmath224 gives the `` right '' slope @xmath225 , where @xmath226 the third slope , @xmath216 , is calculated by first linearly interpolating the density @xmath217 from the zone center to the zone face @xmath212 , and the density @xmath218 to the zone face @xmath224 .",
    "the slope between those values gives @xmath216 , which is @xmath227 the slope @xmath214 is then chosen to be the one from the set @xmath228 with the minimum absolute value , or zero if any two of the slopes have opposite sign .",
    "the interpolated density is calculated using this slope and is given by @xmath229 this is the density @xmath135 that appears in the axial mass advection equation ( [ zadv - d ] ) and the other axial advection equations .",
    "note that the position at which the density is evaluated is not the zone edge itself , but rather a distance @xmath230 `` upwind '' from the zone edge @xmath212 .",
    "this is the position of the center of the volume that will be transported across that zone boundary in the time step @xmath231 . to simplify this illustration ,",
    "we have ignored grid motion ; this may be included by replacing the velocity @xmath232 with the relative velocity @xmath233 in ( [ eqmono ] ) and in figure  [ monofig ] .",
    "a similar procedure is applied to interpolate each quantity to be advected , and the use of a superscript @xmath234 in the transport equations of   [ sec - trans ] indicates quantities that must be evaluated using monotonic interpolation .",
    "note that the coordinate @xmath235 , defined in equation  ( [ varpi - star ] ) , appears in the radial transport equations .",
    "this is the position at which the variable is evaluated in the monotonic interpolation scheme for transport in the @xmath1-direction .    in developing the advection equations above",
    ", we stated that it was advantageous to recast euler s equations in terms of specific angular momentum , @xmath236 , and that the angular velocity components are updated using this formulation .",
    "the reason for this will now be explained .",
    "the advection of angular momentum presents special problems in finite difference codes .",
    "numerical effects can cause a gradual loss of total angular momentum or a non - physical diffusion of angular momentum outwards from the rotation axis .",
    "these effects can be minimized by employing a consistent advection scheme for angular momentum advection ( norman & winkler 1986 ; norman , wilson , & barton 1980 ) . in this method",
    ", we must calculate the specific angular momentum @xmath164 and the angular velocity @xmath237 , in addition to the linear velocity in the angular direction @xmath21 , which is the variable used in the code . on the numerical grid @xmath164",
    "is given by ( [ spec - ang - mom ] ) and the angular velocity is obtained from @xmath238 the key to the consistent advection method is to perform advection based on the smoothest of the three angular quantities , @xmath21 , @xmath164 and @xmath23 .",
    "each of these quantities is interpolated to the zone boundary using the leblanc monotonic scheme described above . for the case of advection in the axial direction",
    "the `` smooth '' specific angular momentum is defined to be @xmath239{0pt}{25pt}if % % following line can not be broken before 80 char $ { \\displaystyle\\left|\\frac{\\omega_{k+\\frac{1}{2}}-\\omega_{k-\\frac{1}{2}}}{\\omega^*_k } \\right|}$ is smallest } \\\\",
    "w_{k}^*\\varpi , & \\mbox{\\rule[-5pt]{0pt}{25pt}if $ { \\displaystyle\\left|\\frac{w_{k+\\frac{1}{2}}-w_{k-\\frac{1}{2}}}{w^*_k } \\right|}$ is smallest } \\\\",
    "j_{k}^ * , & \\mbox{\\rule[-5pt]{0pt}{25pt}if $ { \\displaystyle\\left|\\frac{j_{k+\\frac{1}{2}}-j_{k-\\frac{1}{2}}}{j^*_k } \\right|}$ is smallest } \\end{array}\\right . , \\label{smooth}\\ ] ] where we have suppressed the indices @xmath162 .",
    "this smooth quantity @xmath240 is the one that appears in the angular momentum transport equations ( [ zadv - w ] ) , ( [ radv - w ] ) and ( [ wadv - w ] ) . the new linear velocity in the angular direction is obtained by inverting ( [ spec - ang - mom ] ) at the end of the specific angular momentum transport .",
    "the equation for obtaining the smooth specific angular momentum in the angular direction is completely analogous to ( [ smooth ] ) , with an appropriate change of indices .",
    "for advection in the radial direction , @xmath241 must be substituted for @xmath1 in ( [ smooth ] ) so that the radius is evaluated at the same position as the interpolated quantities ; see equation  ( [ varpi - star ] ) .",
    "the finite difference equations that have been developed are used to evolve a numerical model of a physical system forward in time by taking discrete time steps .",
    "the time steps can not be arbitrarily large , as the system of equations can become unstable ( bowers & wilson 1991 ) .",
    "we now discuss the restrictions placed on the time step to produce accurate and stable solutions .",
    "whenever a quantity is being transported ( or a signal is being propagated ) through a grid , it is important that the time step be small enough so that the quantity or signal can not cross an entire grid zone in a single time step .",
    "this is the well known courant condition ( courant , friedrichs , & lewy 1928 ) given by @xmath242 in 1-d .",
    "it leads to two explicit criteria that the time step in our code must satisfy .    in an eulerian code",
    "the fluid itself is transported through the grid , with a velocity @xmath243 relative to the grid .",
    "the courant condition for fluid transport applied in each of the three coordinate directions is thus note that the time step constraint varies for each zone and for each coordinate direction , so that ( [ ttrans ] ) actually specifies @xmath244 time constraints , where @xmath245 is the total number of grid zones . since all of these contraints are satisfied",
    "if we satisfy the most restrictive of them , we define the transport time step condition to be @xmath246 where @xmath247 \\label{dttrans}\\ ] ] and the minimum is taken over the entire grid .",
    "although sound waves do not physically transport fluid through the grid , they do propagate changes in physical variables such as density and pressure .",
    "therefore , the courant condition must be satified for the propagation of sound waves through the grid . the adiabatic sound speed in the fluid is @xmath248 which , for the ideal gas eos ( [ ideal - gas ] ) , is simply @xmath249 this is the velocity of the sound wave _ with respect to the fluid _ through which it travels .",
    "if the fluid itself is moving through the grid , then the speed of sound with respect to the grid varies with the direction of propagation , but has a maximum of @xmath250 .",
    "thus the courant condition for sound wave propagation in each of the three coordinate directions is again , the time step is limited by the most restrictive of these conditions , so the sound speed courant condition becomes @xmath251 where @xmath252 .",
    "\\label{dtcour}\\ ] ]    the presence of artificial viscosity introduces an explicit diffusion into the system and therefore leads to an additional restriction on the time step . considering only the compressional viscosity ,",
    "the condition for stability in each direction is ( bowers & wilson 1991 ) @xmath253 satisfying this for all three coordinate directions in each grid zone again yields a set of @xmath244 constraint conditions , of which we must satisfy the most restrictive . using expressions ( [ qrr])([qtt ] ) for the artificial viscosity tensor we define then the artificial viscosity constraint becomes @xmath254 where @xmath255 .",
    "\\label{dtshock}\\ ] ]    the time step must be less than the three values defined by ( [ dttrans ] ) , ( [ dtcour ] ) , and ( [ dtshock ] ) . note that the sound speed condition is always more restrictive than the transport condition since @xmath256 , where the equality only holds in the case where pressure is independent of density and the sound speed @xmath257 .",
    "we therefore ignore the transport constraint and concentrate only on the sound speed and artificial viscosity constraints ( [ concour ] ) and ( [ conshock ] ) .    these time step restrictions are the minimal constraint conditions based on a linearized stability analysis ( bowers & wilson 1991 ; press , et al .",
    "1992 ) . to allow for nonlinear effects",
    "we therefore introduce two constant parameters , @xmath258 and @xmath259 , which are given as input to the program , and impose the condition @xmath260.\\ ] ] the values chosen for the constants @xmath261 and @xmath262 are important . if they are too large , the accuracy of the simulation may be compromised ; if they are too small , the number of cycles , and hence the cpu time , required for the calculation is increased .",
    "we usually run with @xmath263 .",
    "there is one final condition that should be applied .",
    "the time step is recalculated for each cycle , and therefore is constantly varying .",
    "if the time step changes by too much from one cycle to the next , irregularities can arise in the computation . to avoid this , we limit the maximum change from one time step to the next by introducing another constant , @xmath264 , and requiring @xmath265 . \\label{tnhalf}\\ ] ] it is usually sufficient to choose @xmath266 such that the time step can not grow by more than 10%20% per cycle .    the time step calculated in ( [ tnhalf ] )",
    "is used to update zone centered quantities , defined at integral time levels @xmath267 .",
    "face centered quantities are defined at half - integral time levels @xmath268 , and these are updated using the time step @xmath269 when @xmath270 and @xmath271 are calculated , the scalar quantities are known at time level @xmath37 and the vector quantities are known at time level @xmath272 , and it is these values that are used in equations ( [ tcour ] ) and ( [ tshock ] ) . using conservative values for the constants in ( [ tnhalf ] ) should guarantee that the constraints will be satisfied for the values of the variables that are coincident with the time step even though they have been calculated using values that are up to a full time step behind .",
    "the newtonian gravitational potential @xmath14 is obtained by solving poisson s equation ( [ poisson - cyl ] ) . expressed in finite difference form this givesrearranging terms , we findwhere @xmath273 and @xmath274 we can rewrite equation  ( [ pois - grid ] ) in matrix form by relabeling the 3-d arrays @xmath275 and @xmath276 so that they are in 1-d form @xmath277 and @xmath278 . for a grid with dimensions @xmath279",
    ", the 1-d index @xmath280 can be written @xmath281 where we have defined @xmath282 , @xmath283 , and @xmath284 for convenience . with this ,  ( [ pois - grid ] ) becomes @xmath285 by inspection we see that  ( [ pois - a ] ) is in matrix form @xmath286 where @xmath287 is a sparse , banded matrix that is tridiagonal with 2 additional diagonal bands above and below the main diagonal ; such a matrix is called `` tridiagonal with fringes '' ( press , et al .",
    "1992 ) ,    we have used the preconditioned conjugate gradient ( pcg ) method ( press , et al . 1992 ) to solve poisson s equation in the form  ( [ pois - mat ] ) .",
    "we have found that this produces accurate and stable solutions , as will be demonstrated by the test cases reported later in this section and in ",
    "[ tests ] .",
    "the pcg method was derived to solve a large , sparse system of equations in which the matrix @xmath287 is symmetric and positive definite , and we have found it to perform well in cases where the matrix is nearly symmetric . from equations  ( [ pois - a ] ) and  ( [ coeff ] ) we see that @xmath287 is exactly symmetric when a uniform grid is used , and is nearly symmetric ( typically within a few percent ) for nonuniform zoning with zoning ratios near unity .",
    "these conditions are always met in our simulations .",
    "the pcg method is an iterative technique that works as follows ( clancy 1989 ; press , et al .",
    "the equation to be solved is written in the form @xmath288 where @xmath289 is a matrix and the dot indicates matrix multiplication .",
    "let @xmath290 be the residual , and @xmath291 be the solution on the @xmath292th iteration .",
    "next , form @xmath293 where the matrix @xmath294 is called the preconditioner .",
    "then , calculate @xmath295 @xmath296 and @xmath297 the improved estimate to the solution is @xmath298 and the new residual is @xmath299 to start the process , choose @xmath300 to be an initial guess for the solution and use  ( [ resid ] ) and  ( [ zvec ] ) to form @xmath301 and @xmath302 , respectively .",
    "let @xmath303 , and then proceed to iterate beginning with equation  ( [ pvec ] ) .",
    "note that equation  ( [ new - x ] ) guarantees that @xmath304 in  ( [ new - resid ] ) is in fact the residual given by  ( [ resid ] ) .",
    "we continue iterating until we have converged to the solution for @xmath14 to within a specified tolerance @xmath305 .",
    "we monitor 2 quantities ,",
    "@xmath306 ^2 \\right ) ^{1/2 } \\label{eps1}\\ ] ] and @xmath307 and stop iterating when either @xmath308 or @xmath309 . to achieve accuracy of @xmath310 in @xmath311 , we need @xmath312 .    there are various choices for the preconditioning matrix @xmath294 .",
    "we have chosen to let @xmath294 be the diagonal part of @xmath289 , @xmath313 to minimize the amount of storage required .",
    "this is known as diagonal scaling ( meijerink & van der vorst 1981 ; press , et al .",
    "we have implemented this method using only 3 additional 3-d arrays , one for each of the vectors @xmath314 , @xmath315 , and @xmath316 ; the vector @xmath317 in equation  ( [ alpha ] ) can also be stored in the array used to hold @xmath315 .",
    "two of these arrays are shared storage spaces with the temporary arrays needed to solve the hydrodynamical equations , and so solving poisson s equation requires only one additional 3-d array . using the indexing convention  ( [ 1-d - index ] ) , the coefficients  ( [ coeff ] ) are calculated for each @xmath280 within the loop to form the components of the matrices @xmath289 and @xmath294 as needed .",
    "overall , this method yields a significant reduction in memory requirements over related methods .",
    "we ran comparison tests of our poisson solver with the routine sitrsol from the cray library of scientific subroutines libsci ( cray research 1992 ) .",
    "this routine is a generic solver for real , sparse linear systems of the form  ( [ mat - eq ] ) , allowing for a variety of solution methods and preconditioning options .",
    "we modeled uniform density dust ellipsoids with eccentricities up to 0.993 and compared the numerically calculated values of @xmath14 with the analytic expressions given by chandrasekhar ( 1969 ) ; cf . ",
    "[ sec - ellip - tests ] below .",
    "we ran with @xmath318 and @xmath319 grids , with zoning ratios in @xmath1 and @xmath2 varying from 1.0 ( uniformly zoned ) to 1.05 .",
    "the outer boundary of the grid was generally set at a distance of twice the largest extent of the mass distribution to produce good boundary conditions ; see below . in terms of accuracy , all of the sitrsol algorithms that converged produced results that matched the solution given by our poisson solver . in all cases the sitrsol algorithms used the full matrix @xmath287 , without assuming that it is symmetric . since they gave the same result as our routine , this is confirmation that the our poisson solver is reaching the right solution even with the slight non - symmetry in @xmath287 due to nonuniform zoning . when evaluated for efficiency , both in terms of memory and computational speed , our solver was clearly superior to the other options we investigated .",
    "although the cray routine is fully optimized , it required approximately 10 times more cpu time , regardless of the choice of method or the mass distribution .",
    "furthermore , it increased the memory requirements of the code by a factor of 1030 , depending on the choice of method and preconditioner .",
    "these differences are due at least in part to the fact that our routine was designed for the specific problem we are solving , never requires the storage of the entire matrix being inverted , and takes advantage of existing temporary arrays . since the cray solver is a generic sparse matrix routine it can not efficiently take advantage of what is known for the specific case at hand .",
    "the solution of poisson s equation also requires specifying boundary conditions for the potential .",
    "these are given at the edges of the grid using a spherical multipole expansion @xmath320 where @xmath321 here @xmath322 are the standard spherical coordinates , the asterisk indicates the complex conjugate , and the integral is taken over the entire source .",
    "we carry the expansion out to order @xmath323 .",
    "to calculate these boundary conditions numerically , we use a set of real harmonic functions @xmath324 that are related to the standard spherical harmonics by the equation @xmath325 the @xmath326 are simply the associated legendre functions with a non - standard normalization , @xmath327 thus , they obey the recursion relations @xmath328 and @xmath329 with @xmath330 @xmath331 and @xmath332 with this , the integral ( [ mass - moment ] ) can be written in finite difference form as @xmath333 where @xmath334 , @xmath335 , and the symbol",
    "@xmath336 indicates that we have used @xmath337 instead of @xmath338 in  ( [ mass - moment ] ) .",
    "then ( [ bcgrav ] ) becomes @xmath339 \\frac{\\tilde{y}_{nm}(\\theta_{jk})}{r_{jk}^{n+1}}\\right\\ } , \\label{phi - bc}\\ ] ] where @xmath340 indicates the highest order multipole , currently 8 in our case , and @xmath341 is used to indicate that we take the real part of the quantity in square brackets .",
    "@xmath342 with @xmath343 odd are identically zero due to the reflection symmetry through @xmath45 .",
    "note that the boundary conditions  ( [ phi - bc ] ) are determined by the source and are calculated in a separate subroutine prior to solving poisson s equation .",
    "it is a simple matter to increase the number of terms in the expansion of the potential  ( [ phi - bc ] ) at the boundaries of the grid .",
    "however , due to the discrete nature of the grid , we must not take the expansion out too far .",
    "this decomposition of the potential into multipoles is based on the orthogonality of the spherical harmonics , which must be preserved on the grid .",
    "thus , the accuracy of the calculation of the boundary conditions depends on accurately resolving the functions used in the expansion .",
    "for example , consider the function @xmath344 , where @xmath345 is equal to the number of angular grid zones @xmath346 .",
    "if the angular grid is equally spaced , then this function will yield a value of @xmath347 at each point on the grid since the argument will always be a multiple of @xmath348 .",
    "for an axisymmetric distribution , numerically integrating this function will give nonzero values for multipole moments with @xmath349 , although all multipole moments with @xmath350 should be zero by symmetry .",
    "therefore , we must have the order of the multipole expansion @xmath351 at least ; in general we keep @xmath352 .",
    "we expect a similar restriction on @xmath340 from the evaluation of the legendre polynomials at discrete grid locations . estimating this restriction is more difficult for two reasons .",
    "first , the legendre polynomials themselves are more complicated then the simple trigonometric functions . also , since the argument of the polynomials , @xmath353 , is not a natural variable on our grid , the sampling distribution for a discrete realization of the functions is a complicated function of the @xmath2 and @xmath1 grid spacings , with some regions sampled more densely than others .",
    "we must thus take care to limit the number of terms in the multipole expansion  ( [ phi - bc ] ) .",
    "we have found that errors in the calculation of the boundary values for @xmath14 are most likely to occur near the @xmath2-axis .",
    "for example , for a uniform density oblate spheroid of eccentricity 0.995 on a @xmath354 ( @xmath355 ) grid with the grid boundary set at twice the equatorial radius , the multipole expansion  ( [ phi - bc ] ) gave values for @xmath14 that matched the analytic values to within @xmath356 over the entire boundary except for the zones on the @xmath2-axis .",
    "on the @xmath2-axis there were large errors ( @xmath357 ) when the expansion was taken to @xmath358 .",
    "these did not improve when additional terms in the expansion were included , but were reduced to @xmath359 when the order of the expansion was reduced to @xmath360 .    for a given angular resolution @xmath346",
    ", the accuracy of the multipole expansion can be improved only by moving the boundary farther from the surface of the mass distribution to reduce the magnitude of the higher order terms that have been discarded .",
    "we have found that for significantly aspherical configurations it is best to set both the @xmath1 and @xmath2 boundaries at least a factor of 2 larger than the largest dimension of the mass distribution .",
    "for example , when this condition was imposed for a uniform density triaxial ellipsoid with axis ratios 4:2:1 ( in the @xmath361 , @xmath362 , and @xmath2-directions , respectively ) , the potential deviated from the expected value by @xmath363 throughout the grid on a @xmath364 ( @xmath355 ) uniform grid with @xmath360 . when the ratio of the grid boundary to the largest axis was reduced from 2 to @xmath365 , maximum errors of several percent",
    "were encountered for the same parameters .",
    "we calculate the gravitational radiation produced in these models using the quadrupole approximation ( misner , thorne and wheeler 1973 ) .",
    "the spacetime metric is @xmath366 where @xmath367 , @xmath368 is the metric of flat spacetime , and @xmath369 .",
    "the gravitational wave amplitude at distance @xmath370 from the source is given by the transverse - traceless ( tt ) components of the metric perturbation @xmath371 , @xmath372 where the reduced mass quadrupole moment tensor in cartesian coordinates is @xmath373 here , spatial indices @xmath374 , the dot indicates a time derivative @xmath4 , and the integral is performed over the volume of the source . the tt part of the quadrupole moment is defined by @xmath375 where the projection operator @xmath376 removes the parts of the quadrupole tensor in the propagation direction and @xmath377 are the components of the radial unit vector from the source to the field point .",
    "the gravitational wave luminosity of the source is @xmath378 where the superscript @xmath379 indicates 3 time derivatives , there is an implied sum on repeated indices , and the angle brackets are used to denote an average over several wavelengths .",
    "the energy emitted as gravitational radiation is @xmath380 finally , the angular momentum carried away by the gravitational waves is @xmath381 where @xmath382 is the totally antisymmetric levi - civita tensor .",
    "if we use an orthonormal spherical coordinate system defined by the unit vectors @xmath383 with the center of mass of the source located at the origin , then the tt part of @xmath384 has only four non - vanishing components",
    ". expressed in terms of the cartesian components  ( [ ibar ] ) these are ( kochanek , et al .",
    "1990)with the standard definition of the polarization basis tensors , @xmath385 @xmath386 the gravitational radiation waveform can then be written @xmath387 where the wave amplitudes are given by @xmath388    all of these physical quantities associated with gravitational radiation are functions of at least the second time derivative of the reduced quadrupole tensor @xmath384 .",
    "the standard quadrupole formula ( sqf ) consists of using these relations in conjunction with the definition ( [ ibar ] ) for @xmath384 . in an eulerian code @xmath384",
    "may be calculated directly by summing over the grid , and the time derivatives calculated by using the finite difference approximation @xmath389 .",
    "however , the successive application of numerical time derivatives can introduce a great deal of noise into the calculated quantities , especially when the time step varies from cycle to cycle . to reduce this problem , finn & evans ( 1990 )",
    "have developed two partially integrated versions of the sqf that eliminate one of the time derivatives by calculating @xmath390 directly .",
    "they find that both of these methods produce much cleaner waveforms , with the high frequency numerical noise greatly suppressed .",
    "if we take the time derivative of ( [ ibar ] ) and use the mass continuity equation  ( [ mass - cont - l ] ) we obtain , after some manipulation , @xmath391 this is the momentum divergence formula , which finn & evans ( 1990 ) refer to as qf2 .",
    "analytically , using ( [ qf2 ] ) to calculate gravitational waveforms and luminosities is equivalent to using ( [ ibar ] ) directly ; however , in a finite difference formulation the elimination of one numerical time derivative greatly increases the signal - to - noise ratio .",
    "we note that  ( [ qf2 ] ) introduces a spatial derivative , the momentum divergence , into the calculation , and that this derivative must be performed numerically .",
    "while this can also be expected to produce numerical noise , it should have little effect on the resulting value for @xmath390 since the spatial derivative appears inside the volume integral and the noise will be smoothed by the integration process .",
    "the divergence in ( [ qf2 ] ) can be eliminated by integrating by parts and discarding the surface terms at infinity .",
    "the result is @xmath392dv , \\label{qf1}\\ ] ] where @xmath393 finn & evans ( 1990 ) refer to this as the first moment of momentum formula , qf1 .",
    "again , the use of ( [ qf1 ] ) in calculating the gravitational radiation is mathematically equivalent to using ( [ ibar ] ) or ( [ qf2 ] ) , but in a finite difference code qf1 has several advantages .",
    "the first is that , like qf2 , one numerical time derivative is eliminated when gravitational waveforms are calculated using qf1 .",
    "the numerical divergence that must be calculated in qf2 has also been eliminated .",
    "another advantage is that the moment arm that weights the mass has been reduced from @xmath394 to @xmath370 , which decreases the emphasis on low density material at large radii , while the presence of the velocity increases the emphasis on the more dynamical regions ( finn & evans 1990 ) .",
    "we have implemented sqf , qf1 , and qf2 in our hydrodynamics code to calculate the gravitational radiation .",
    "we calculate @xmath384 ( for sqf ) and @xmath390 ( for qf1 and qf2 ) on each of the cycles during the run and write them to disk for additional post - processing to determine waveforms and luminosities .",
    "note that on cycle @xmath37 sqf produces quadrupole tensor components defined at time level @xmath395 , while qf1 and qf2 produce time derivatives defined at level @xmath396 .",
    "the numerical integration of the sqf ( [ ibar ] ) is a simple task .",
    "we begin by definingthe cartesian components of @xmath384 are then @xmath397 @xmath398 @xmath399 @xmath400 and @xmath401 where we have used the fact that the summation is over the top half of the distribution only ( @xmath402 ) with reflection symmetry through the @xmath403 plane",
    ". the volume element is defined by ( [ dvol ] ) .",
    "the reduced quadrupole tensor calculated from ( [ ixx])([ixz ] ) is mathematically traceless , as required . in practice , however , truncation errors can lead to a small non - zero trace if all components are calculated as specified . to guarantee the tracelessness of @xmath384 , we replace the calculation of @xmath404 using  ( [ iyy ] ) with @xmath405    the numerical implementation of qf2 presents some complications because of the presence of both @xmath103 and @xmath406 , which are defined in different positions on the grid , in the divergence .",
    "recall from   [ sec - grid - cen ] above",
    "that the density is zone centered , while each component of the velocity is face centered _ on a different face_. in addition , zone centered quantities and face centered quantities are defined at different time levels . in order to obtain an accurate discrete representation of ( [ qf2 ] ) we must perform the summation on objects that are defined at the same space - time points .    at the time that we calculate the gravitational radiation ,",
    "the density has been updated to time level @xmath167 and the velocities have been updated to time level @xmath92 . by saving the value of the density at the previous time step we can interpolate the density to the same time level as the velocity ,",
    "@xmath407 here we use the simple average because time level @xmath92 is defined to be halfway between levels @xmath37 and @xmath167 , @xmath408 with this , all of the variables needed for qf2 are available at the same time level .    to evaluate the divergence we use the identity @xmath409 .",
    "the divergence of @xmath406 is naturally defined at the zone center , while each component of the gradient of @xmath103 is naturally face centered in that coordinate , @xmath410",
    "@xmath411 and @xmath412 the integral in ( [ qf2 ] ) thus naturally breaks into four separate discrete summations over the numerical grid , where the factor of two appears to account for integration below the @xmath403 plane .",
    "we again use the symmetry of the grid to write @xmath413 and the tracelessness of the quadrupole tensor to obtain @xmath414 we therefore use ( [ nqf2 ] ) to obtain only the three components @xmath415 , @xmath416 , and @xmath417 .",
    "explicitly , these areandhere the divergence and gradient terms are obtained using ( [ div - v])([grad - t - d ] ) .",
    "the volume element , @xmath418 , and the position variables , @xmath361 , @xmath362 , and @xmath370 , are defined by ( [ dvol ] ) and ( [ xdefs ] ) , respectively , with appropriate indices .",
    "the numerical representation of qf1 is also complicated by the presence of both zone centered and face centered quantities in the integral . in this case , however , it is not possible simply to break up the summation into zone centered and face centered parts .",
    "it is therefore necessary to interpolate one of the quantities onto the position of the other .",
    "we first interpolate the density to the same time level as the velocities using ( [ rhohalf ] ) .",
    "we then have the choice of evaluating the density on the zone faces , or interpolating the velocity components to the zone center .    as with qf2",
    "the symmetries of the grid and the tracelessness of @xmath384 guarantee that ( [ ref - sym ] ) and ( [ traceless ] ) still hold .",
    "the cartesian velocity components in the @xmath361 and @xmath362-directions arethe zone centered representation of the components of @xmath390 is thus @xmath419 \\delta v\\right\\}_{{j+\\frac{1}{2},k+\\frac{1}{2},l+\\frac{1}{2}}},\\ ] ] @xmath420 \\delta v\\right\\}_{{j+\\frac{1}{2},k+\\frac{1}{2},l+\\frac{1}{2}}},\\ ] ] and @xmath421 \\delta v\\right\\}_{{j+\\frac{1}{2},k+\\frac{1}{2},l+\\frac{1}{2}}},\\ ] ] where the zone centered velocity components are calculated by volume averaging as described in   [ sec - grid - cen ] . a face centered discrete representation of ( [ qf1 ] ) can also be obtained . in this case",
    "the summation again breaks up into terms centered on each face , in a manner similar to the separation of terms in qf2 .",
    "the mass density is evaluated on each zone face by volume averaging , and we obtainand @xmath422 we have implemented both the zone centered and the face centered methods , and found no noticeable difference in the results .",
    "the finn & evans ( 1990 ) formulae qf1 and qf2 produce much less noisy waveforms than the sqf .",
    "nevertheless , when luminosities , which require the third derivative of the reduced quadrupole tensor , are calculated using these expressions we still find that numerical noise frequently dominates the signal .",
    "this is especially true when the time step is changing significantly from cycle to cycle .",
    "we have therefore implemented some techniques to improve the signal - to - noise ratio when the numerical derivatives are taken .    the simplest method of taking a numerical time derivative is a simple two - point formula , @xmath423 when @xmath231 changes a lot from cycle to cycle , this can fluctuate wildly from one time level to the next , causing numerical noise in the signal .",
    "these fluctuations can be reduced somewhat by obtaining the derivative from a higher order fit to the neighboring points .",
    "we have implemented a 4-point cubic fit , as follows .",
    "first definethe time derivative can then be written @xmath424 where @xmath425 and @xmath426 this gives the time derivative at time level @xmath267 .",
    "the choice of the time levels @xmath345 , @xmath427 , and @xmath72 in ( [ cub - fit])([cub - fit - b ] ) is essentially arbitrary , although one should ideally choose nearby points . to provide additional noise reduction",
    ", we perform the calculation for the four contiguous 4-point sets @xmath428 , @xmath429 , @xmath430 , and @xmath431 , and average the results to obtain a value for the derivative .",
    "this procedure is repeated for each successive time derivative .",
    "while using the cubic fit to obtain the derivative does provide a cleaner waveform , there is still a significant amount of numerical noise when several time derivatives are taken in succession .",
    "we have therefore found it necessary to pass the data through a filter to smooth it after each derivative is performed .",
    "the numerical noise in the time derivative has a very high frequency @xmath432 , whereas the signal that we are seeking is expected at much lower frequencies @xmath433 , where @xmath434 is the dynamical time , @xmath435 is the radius , and @xmath436 is the mass of the system .",
    "the relation @xmath437 is guaranteed because the courant conditions derived in   [ sec - courant ] require that no significant movement of the system can occur in a single time step .",
    "we can therefore smooth the data using a low pass filter with a cutoff frequency on the order of @xmath438 , with little degradation of the signal . by doing this ,",
    "we have been able to obtain smooth functions for the waveforms and luminosities ; see   [ sec - ellip - tests ] below .",
    "there are many methods for filtering data ( see , eg . , press et al .",
    "( 1992 ) ) .",
    "because we are usually dealing with a large number of nonuniformly spaced data points , we use a `` real - time '' smoothing technique that consists of performing a weighted average over a moving window .",
    "we have made it an option to choose either a recursive ( input includes filter output from previous cycles ) or nonrecursive ( input includes only unfiltered data ) filter , although we usually use the recursive method .",
    "we commonly use a triangular weighting function , but other forms are available .",
    "the size of the window is variable , and is chosen to be at least several time steps , but smaller than any expected signal features .",
    "an estimate of the desired window size can easily be obtained by looking at @xmath384 , which has only small amplitude numerical noise .",
    "we have developed a 3-d code to be used as a computational laboratory for modeling sources of gravitational radiation .",
    "it has been well - tested at all stages of its development to insure its accuracy and verify its performance ( centrella , et al .",
    "1986 ) . in this section",
    "we discuss the major test - bed problems we used and present the results of running them on our code .",
    "the riemann shock tube is a classic problem that tests the hydrodynamics portion of the code , in particular the shock jump conditions , shock heating , and the resolution of the shock and contact discontinuities ( hawley , smarr , & wilson 1984a , b ) .",
    "initially , the system consists of a fluid at rest that exists in 2 states separated by a membrane . on the left of",
    "the membrane is hot , dense fluid and on the right is cold , rarefied fluid . at @xmath439 the membrane",
    "is removed and the high density fluid flows into the low density region , creating a shock front moving to the right and a rarefaction wave moving to the left .",
    "we ran the riemann shock tube along all 3 coordinate directions .",
    "( for the @xmath1-direction we had to use a very large radius to approximate 1-d planar symmetry . )",
    "we tested several different advection schemes and found that the leblanc monotonic method discussed in ",
    "[ sec - mono ] produced the best results ; for this reason we use it exclusively .",
    "figure  [ fig - shock - tube ] shows typical results from running a shock tube with 100 uniformly spaced zones in the @xmath1-direction .",
    "the initial conditions for this run are ( sod 1978 ) : @xmath440 we used the perfect fluid eos  ( [ ideal - gas ] ) with @xmath441 and ran the shock tube in the @xmath2-direction . as figure  [ fig - shock - tube ] shows , the code results ( shown by the @xmath442 symbols ) accurately reproduce the analytic solution ( shown by the solid line ) .",
    "our results are essentially the same as those obtained by hawley , smarr , & wilson ( 1984b ) for monotonic advection .",
    "a polytrope is a self - gravitating fluid that obeys the simple eos @xmath443 where @xmath28 is a constant related to the specific entropy and @xmath37 is called the polytropic index .",
    "this can be put into the form of an ideal gas eos ( [ ideal - gas ] ) by defining the specific internal energy to be @xmath444 where the @xmath445 s that appear in ( [ poly - eos ] ) and ( [ ideal - gas ] ) are chosen to be identical .",
    "the smaller values of @xmath37 produce `` stiffer '' equations of state , with @xmath446 corresponding to an incompressible fluid .",
    "a polytrope with index @xmath447 ( @xmath448 ) corresponds to a classical ideal gas , while a polytrope with @xmath449 ( @xmath450 ) models an ideal relativistic gas .",
    "we have used spherical polytropes to test the hydrodynamics coupled to newtonian gravity .",
    "since we have a cylindrical grid , this provides a non - trivial test of our code .",
    "the simplest test is to generate a stable spherical equilibrium polytrope , and verify that the code preserves the initial configuration .",
    "we have run this test for a @xmath448 polytrope on a @xmath451 @xmath0 grid with zoning ratios in the range 1.01 - 1.03 .",
    "we found that the models remained stable for @xmath452 .",
    "we compared the gravitational potential calculated by our poisson solver with the analytic values and found that the maximum deviation was @xmath453 , just outside the surface of the mass distribution , with errors @xmath454 throughout more than @xmath455 of the zones .",
    "the deviations from spherical symmetry were @xmath456 .",
    "we found that an initially spherical polytrope placed on our numerical grid exhibited small amplitude pulsations , indicating that the finite difference model was not a true equilibrium configuration .",
    "we therefore inserted an artificial damping term into the velocity equations and allowed the initial configuration to `` relax '' into equilibrium .",
    "the model that resulted when the oscillations had been damped was slightly non - spherical .",
    "the asphericity of the polytrope , in terms of the equatorial and polar radii , is less than a grid zone .",
    "the moments of inertia about the @xmath2 and @xmath361-axes differed by @xmath457 when the relaxation was performed on a @xmath458 ( @xmath459 ) 2-d axisymmetric grid .",
    "a polytrope with @xmath449 ( @xmath450 ) is marginally stable , and will collapse homologously if the internal pressure is slightly reduced ( goldreich & weber 1980 ) .",
    "we have run such simulations in 2-d and 3-d , with moving and stationary grids of various sizes and zoning ratios ( evans 1986 ) . in all cases ,",
    "the collapse remained homologous through increases in the central density of @xmath460@xmath461 , depending on the resolution of the grid in the center of the polytrope .",
    "figure  [ poly.coll-2d ] shows the results of a 2-d run with a @xmath462 @xmath463 grid and a zoning ratio of 1.02 , and figure  [ poly.coll-3d ] shows a 3-d run with a @xmath464 @xmath0 grid and a zoning ratio of 1.04 ; both models use moving grids in the @xmath1 and @xmath2 directions .",
    "for these cases , we set up a spherical polytrope with mass @xmath465 and radius @xmath466 .",
    "collapse was initiated by reducing pressure throughout the polytrope by @xmath356 and imposing an inwardly directed homologous velocity profile @xmath467 with maximum velocity @xmath468cm / sec .",
    "the moving grid is homologous , and is specified by choosing the grid velocity of a particular zone , @xmath469 of the way from the center to the surface , to be a fixed fraction ( @xmath470 for the 2-d run and @xmath471 for the 3-d run ) of the fluid velocity in that zone .    for homologous collapse the density profile , suitably scaled , should not change throughout the evolution and",
    "the velocity should be purely radial , @xmath467 , and directed inward .",
    "figure  [ poly.coll-2d ] shows @xmath472 the scaled density @xmath473 and @xmath474 the velocity versus the scaled radial distance @xmath475 for the 2-d run .",
    "figure  [ poly.coll-3d ] @xmath472 and @xmath474 show the same quantities for the 3-d run . here",
    ", @xmath476 is the central density and @xmath477 is the initial polytrope radius .",
    "each density graph includes plots for @xmath478 = 9 , 10 , 11 , 12 , and 13 ; the 2-d plots in figure  [ poly.coll-2d ] also show @xmath478 = 14 .",
    "we see that the density profiles overlay each other within the resolution of the graphics , except for the last trace on the graph for the 2-d collapse . from the velocity plot for the 2-d collapse , figure  [ poly.coll-2d",
    "] @xmath474 , we see that the core is beginning to rebound when @xmath479 , so we would not expect this density profile to be the same as the other plots .",
    "the velocity plots show a homologous profile for the central region of the polytrope , including more than @xmath471 of the mass , again except for the case @xmath479 in the 2-d model .",
    "the sphericity of the polytrope was well preserved throughout the collapse in all runs .",
    "figure  [ poly - sphere ] illustrates this for the 3-d collapse described above .",
    "each graph displays three density profiles , one for density along a cut along @xmath1 , one along the @xmath2-axis , and one along the line @xmath480 .",
    "we see that the density profiles are indistinguishable from each other in both cases , demonstrating that spherical symmetry has been well - preserved .      an initially uniform density , rigidly rotating",
    ", pressureless dust ellipsoid will undergo gravitational collapse to a pancake while maintaining a uniform density and an ellipsoidal figure .",
    "this process is described by a small number of ordinary differential equations ( miller 1974 ; saenz & shapiro 1978 ) , which can be easily integrated numerically to obtain a complete description of the collapse .",
    "since the reduced quadrupole tensor for a uniform ellipsoid of axes @xmath481 , @xmath482 , and @xmath483 aligned along the @xmath361 , @xmath362 , and @xmath2 axes , respectively , is given by the simple expression @xmath484 the expected gravitational radiation from this collapse is easily obtained using the quadrupole formula . finally , the gravitational potential of a uniform density ellipsoid is also known theoretically ( chandrasekhar 1969 ) .",
    "the collapse of such uniform ellipsoids thus provides an important means of testing the hydrodynamics , gravitational radiation , and poisson solver of our code .",
    "figures  [ ellip-2d-1]-[ellip-2d-2 ] illustrate the results of simulations of the collapse of axisymmetric dust ellipsoids .",
    "the plots have all been scaled to the natural scales of the problem .",
    "thus , the axes @xmath485 , and @xmath483 have been scaled by the initial length of the semi - major axis @xmath486 .",
    "the times are expressed in units of the dynamical time @xmath487 for a _ spherical _ polytrope of the same mass @xmath436 and radius @xmath488 ; see equation  ( [ td ] ) . finally , the gravitational radiation waveforms and efficiencies are scaled by @xmath489 and @xmath490 , respectively .",
    "figure  [ ellip-2d-1 ] shows the behavior of an axisymmetric oblate ellipsoid @xmath485 uniformly rotating about the @xmath2-axis with @xmath491 and eccentricity @xmath492 .",
    "this calculation was run using a 2-d @xmath493 @xmath463 grid with uniform zoning and moving grids .",
    "the evolution of the semi - major ( equatorial ) and semi - minor ( polar ) axes is shown in figure  [ ellip-2d-1 ]  @xmath472 , using solid lines for the theoretical values and dashed lines for the code results .",
    "figure  [ ellip-2d-1 ]  @xmath474 shows the evolution of the eccentricity throughout the collapse as the ellipsoid approaches a `` pancake '' with @xmath494 . due to the axisymmetry , @xmath495 = @xmath404 = @xmath496 , and all the off - diagonal components of @xmath384 are zero .",
    "thus , the gravitational radiation is all in the `` @xmath497 '' polarization , and the amplitude has a simple @xmath498 dependence .",
    "the on - axis waveform @xmath499 is shown in figure  [ ellip-2d-1 ] @xmath500 . finally , figure  [ ellip-2d-1 ] @xmath501 shows the energy emitted as gravitational radiation @xmath502 .",
    "the gravitational radiation waveforms and efficiency dispalyed here were obtained using qf1a .",
    "those obtained using qf1b and qf2 are indistinquishable , while the waveform obtained using sqf exhibits a substantial amount of numerical noise .",
    "overall , we see that the code matches the results of the theoretical calculation very well .",
    "in addition , we ran an axisymmetric collapse starting with eccentricity @xmath503 and @xmath504 using a @xmath505 @xmath463 grid with uniform zoning and moving grids .",
    "this eccentricity corresponds to an axis ratio of @xmath506 , significantly more oblate than the axis ratio of @xmath507 used for the bar mode instability problem of the next section .",
    "the results are shown in figure  [ ellip-2d-2 ] , which gives @xmath472 the behavior of the axes , @xmath474 the eccentricity , @xmath500 the waveform @xmath499 , and @xmath501 the energy emitted as gravitational radiation @xmath508 .",
    "we see that the code results again agree closely with the analytic results .",
    "while the simulation results for the hydrodynamic quantities , such as the axes , match the analytic results well throughout the calculation , we can see that , towards the end of the simulation , when the @xmath483-axis is reduced to only a few zones in the @xmath2-direction , the gravitational wave calculation breaks down due to insufficient resolution .",
    "rotating axisymmetric fluids are subject to global rotational instabilities that arise from growing modes @xmath509 , where @xmath510 is the so - called `` bar mode '' .",
    "these can be parametrized by @xmath511 where @xmath512 is the rotational kinetic energy and @xmath513 is the gravitational potential energy ; see durisen & tohline ( 1985 ) and tassoul ( 1978 ) for reviews .",
    "the dynamical bar instability is driven by hydrodynamics with newtonian gravity and develops on a timescale of about a rotation period .",
    "it occurs for values of @xmath514 , where @xmath515 for a wide range of rotating fluids ( durisen & tohline 1985 ; shapiro & teukolsky 1983 ) .",
    "the growth rate and eigenfrequency of the bar mode can be calculated using the linearized tensor virial equations ( tve ) ( chandrasekhar 1969 ) .",
    "the development of the bar instability in a differentially rotating polytrope with @xmath516 for various values of @xmath517 has been studied extensively by tohline , durisen , & mccollough ( 1985 , hereafter tdm ) using 3-d numerical simulations which were compared to the results of the tve analysis .",
    "since both their numerical and analytic results are available , we decided to use this case , with @xmath518 , as a test bed problem for the hydrodynamics and gravity .",
    "we set up the initial axisymmetric equilibrium polytrope on a cylindrical grid using the self - consistent field method of smith & centrella ( 1992 ) , which is based on earlier work of ostriker & mark ( 1968 ) and hachisu ( 1986 ) .",
    "we specify a rotation law of the general form @xmath519 , where @xmath32 is the specific angular momentum and @xmath520 is the mass interior to a cylinder of radius @xmath1 ( ostriker & mark 1968 ) . for comparison with previous work",
    "we use the rotation law for the uniformly rotating , constant density maclaurin spheriods , @xmath521 where @xmath164 is the total angular momentum and @xmath436 is the total mass .",
    "since polytropes do not have constant density , this produces differential rotation .    the free parameters in this self - consistent field method are , in addition to the rotation law @xmath522 , the polytropic index @xmath37 , the central density @xmath476 , and the axis ratio @xmath523 , where @xmath524 is the polar radius and @xmath435 is the equatorial radius . upon convergence to a solution of the equations of hydrodynamic equilibrium , this method gives the total mass @xmath436 , the polytropic constant @xmath28 ( and hence the pressure @xmath525 ) , the angular velocity @xmath526 , and @xmath517 .",
    "since @xmath517 is not specified initially , some experimentation with the input parameters is generally necessary to achieve a particular value of @xmath517 . in constructing our model with @xmath527",
    "we were guided in our choice of input parameters by the values given in tohline , durisen , & mccollough ( 1985 ) .",
    "we found that using @xmath528 gives @xmath529 .",
    "note that this model is highly flattened due to the rotation .",
    "the self - consistent field code produces a rotating axisymmetric equilibrium using a relatively high resolution grid ; this model is then interpolated onto a lower resolution grid for evolution by the 3-d code . to evolve the test run described here we used a @xmath530 @xmath0 grid .",
    "calculating @xmath512 and @xmath513 over this grid at the initial time gives @xmath531 .",
    "we set the grid boundaries at @xmath532 and @xmath533 .",
    "this large amount of initially empty space is necessary both to provide room for the star to expand as the bar mode grows as well as to the specify the boundary conditions for the solution of poisson s equation accurately .",
    "we used a finer grid in the region initially occupied by the matter and a coarser grid outside .",
    "the @xmath1 grid is uniform to the zone @xmath534 , and the @xmath2 grid is uniform up to @xmath535 .",
    "the zoning is chosen such that the center of the radial zone @xmath536 is at @xmath435 and the center of the axial zone @xmath537 is at @xmath524 .",
    "outside of this uniformly zoned region , the zone size increases linearly with zoning ratios @xmath538 and @xmath539 the angular grid is uniformly zoned .",
    "all grids are held fixed throughout this simulation . to trigger the bar instability we imposed a random perturbation with amplitude @xmath540 on the density in each grid cell .",
    "figure  [ spiral - arms ] shows the development of the bar mode at 4 different times during the evolution of this model .",
    "the first frame , at @xmath541 , shows the model near the end of the linear growth regime of the bar mode .",
    "the bar structure is very apparent here , and the model has not yet expanded significantly beyond its initial boundaries . at @xmath542",
    "we see the beginning of the growth of spiral arms .",
    "by @xmath543 the model has expanded significantly and the spiral arms are pronounced . in the final frame , at @xmath544 ,",
    "the core has returned to a more axisymmetric configuration and the spiral arms have expanded to about twice the initial radius .",
    "when evolved further , the spiral arms merge into a tenuous envelope surrounding the central core .",
    "these results are qualitatively similar to those obtained by tdm .",
    "we observe the formation of shocks during the formation and expansion of the spiral arms , which were not modelled in the tdm simulation .    to study the development of the bar mode quantitataively",
    ", we analyze the density in a ring of fixed @xmath1 and @xmath2 using a complex fourier integral @xmath545 where @xmath546 .",
    "the bar mode amplitude is then @xmath547 where @xmath548 is the mean density in the ring , and the phase angle is @xmath549 according to the tve analysis , the amplitude @xmath550 should grow exponentially with time as the instability develops .",
    "figure  [ bar - mode ] shows the growth of the bar mode @xmath551 versus time for the ring @xmath552 in zone @xmath553 in the equatorial plane @xmath45 .",
    "we find the slope @xmath554 .",
    "this compares favorably with the tve result @xmath555 , which is very close to the tve prediction @xmath556 ( tdm ) .",
    "we can also compare our results with the numerical calculations of tdm .",
    "they used a 3-d eulerian code written in cylindrical coordinates and required that the eos remain polytropic .",
    "their code does not solve an energy equation , and therefore has no way to handle self - consistently the shocks that form as the spiral arms expand .",
    "they used donor cell advection , which is known to be very diffusive ; see ",
    "[ sec - mono ] . and",
    ", their code assumes `` @xmath557-symmetry '' , which means that the flow is calculated only in the angular range @xmath558 so that only the even mode distortions are modeled .",
    "they used a @xmath559 @xmath0 grid , with the model extending out to zone 24 in the @xmath1-direction and zone 9 in the @xmath2-direction , which is equivalent in resolution to our initial setup .",
    "they found a bar mode growth rate of @xmath560 and an eigenfrequency @xmath561 .",
    "the substantial deviation from the tve result for the growth rate is attributed to the large numerical diffusion in their code ; see tdm for details .",
    "overall , our code , which takes advantage of more modern techniques , performs significantly better on this problem .",
    "we have developed a 3-d eulerian hydrodynamics code designed to model sources of gravitational radiation .",
    "this code is written in cylindrical coordinates @xmath0 , and has moving grids in the @xmath1 and @xmath2-directions .",
    "the hydrodynamical equations are solved using operator splitting ( wilson 1979 ; bowers & wilson 1991 ) .",
    "the equations are divided into a `` lagrangian step '' , which includes lagrangian - like processes such as accelerations and work done on a fluid element , and a `` transport step '' , which includes advection of material through the grid and grid motion .",
    "the transport is handled using a monotonic advection scheme developed by leblanc ( clancy 1989 ; bowers & wilson 1991 ) , with the consistent advection scheme for angular momentum transport ( norman & winkler 1986 ; norman , wilson , & barton 1980 ) .",
    "we use newtonian gravity , and calculate the gravitational radiation produced using the quadrupole approximation .",
    "poisson s equation is solved using an efficient and robust 3-d matrix solver based on the preconditioned conjugate gradient method .",
    "we have implemented the partially integrated quadrupole formulae qf1 and qf2 developed by finn & evans ( 1990 ) and numerical filtering techniques to produce smooth gravitational waveforms and luminosities .",
    "this code has been extensively tested to verify its accuracy and stability .",
    "for example , the riemann shock tube has been used to test the hydrodynamics part of the code , with particular attention to the shock jump conditions , shock heating , and resolution of the shock and contact discontinuities .",
    "the homologous collapse of spherical polytropes was used to test the poisson solver and the coupling between the hydrodynamics and gravity , as well as the ability of the code to reproduce spherical symmetry on a cylindrical grid as the polytrope collapsed through many order of magnitude in density .",
    "the gravitational collapse of axisymmetric homogeneous dust ellipsoids expanded the tests to include the gravitational radiation produced .",
    "finally , the development of the dynamical bar mode instability was modeled , and the results compared with theoretical calculations and previous numerical models . in all , our code has produced accurate and stable solution to these test - bed problems , and we believe it is ready to be used to model more realistic astrophysical sources of gravitational radiation .",
    "we thank r. bowers and j. leblanc for many enlightening discussions and much valuable help .",
    "this work was supported by nsf grants phy-8451732 , phy-8706135 , phy-9012383 , and phy-9208914 , and by lanl .",
    "the simulations were carried out at psc , ncsa , and lanl ."
  ],
  "abstract_text": [
    "<S> we have developed a 3-d eulerian hydrodynamics code to model sources of gravitational radiation . </S>",
    "<S> the code is written in cylindrical coordinates @xmath0 and has moving grids in the @xmath1 and @xmath2-directions . </S>",
    "<S> we use newtonian gravity and calculate the gravitational radiation in the quadrupole approximation . </S>",
    "<S> this code has been tested on a variety of problems to verify its accuracy and stability , and the results of these tests are reported here . </S>"
  ]
}