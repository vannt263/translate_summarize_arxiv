{
  "article_text": [
    "equilibrium equations in the form of complementarity conditions often appear as constraints in optimization problems .",
    "problems of this type are commonly referred to as mathematical programs with complementarity constraints ( mpccs ) , and arise in many engineering and economic applications ; see the survey @xcite and the monographs @xcite for further references .",
    "the growing collections of test problems @xcite indicate that this an important area .",
    "mpccs can be expressed in general as [ mpec ]    ll & f(x , y , w , z ) + & x x + & f(x , y , w , z ) = 0 + & 0 y w 0 ,    where @xmath0 is a polyhedral set , @xmath1 and @xmath2 are twice continuously differentiable functions , and @xmath3 .",
    "the complementarity constraint @xmath4 means that either a component of @xmath5 is zero , or the corresponding component of @xmath6 is zero , which implies that @xmath7 .",
    "many approaches exist for solving mpccs .",
    "these include branch - and - bound methods @xcite , implicit nonsmooth approaches @xcite , piecewise sqp methods @xcite , perturbation and penalization approaches @xcite analyzed in @xcite , and the penalty interior - point algorithm ( pipa ) @xcite , whose convergence properties are the subject of this note .",
    "recently , there has also been renewed interest in solving ( [ mpec ] ) with standard nonlinear programming ( nlp ) techniques by replacing the complementarity constraint by @xmath8 this approach had been regarded as numerically unsafe because ( [ mpec ] ) violates a constraint qualification at any feasible point @xcite .",
    "however , numerical @xcite and theoretical evidence @xcite suggests that sequential quadratic programming ( sqp ) solvers are able to solve large classes of mpccs .",
    "a similar analysis is being extended to interior - point methods ( ipms ) @xcite .",
    "this note is organized as follows .",
    "the next section briefly describes pipa and presents its convergence result .",
    "section  [ example ] presents a small counterexample that shows that pipa can fail to converge for certain admissible choices of parameters .",
    "finally , section  [ conclusion ] discusses the example and suggests a remedy that avoids this problem .",
    "pipa ( * ? ? ?",
    "* chapter 6.1 ) solves mpccs of the form ( [ mpec ] ) .",
    "it has been studied in @xcite and has been applied to a number of real applications in finance @xcite , target classification @xcite , and electricity markets @xcite .",
    "pipa generates a sequence of iterates @xmath9 that are strictly interior in @xmath10 , @xmath11 .",
    "the iterates are computed by solving a quadratic direction - finding problem . in that sense",
    ", pipa combines aspects of interior - point and sqp methods .",
    "we use @xmath12 to denote the step or displacement computed by pipa .",
    "subscripts such as @xmath13 refer the part of @xmath12 corresponding to the @xmath14-variables ; superscripts are used to denote iterates or evaluation of functions at a particular point , for example , @xmath15 .",
    "diagonal matrices are denoted by @xmath16 and @xmath17 and @xmath18 .",
    "the algorithm solves the following direction - finding problem at every iteration : [ qp - dir ]    ll & f^k^t d + d_x^t q^k d_x + & x^k + d_x x + & f^k + f^k^t d = 0 + & y^k d_w + w^k d_y = - y^k w^k + e + & d_x ^2_2 c ( f^k + y^k^tw^k ) ,    where @xmath19 and @xmath20 are parameters and @xmath21 approximates second - order information in @xmath1 and @xmath2 .",
    "note that ( [ qp - dir ] ) has a quadratic trust - region - type constraint .",
    "if this constraint is replaced by the @xmath22 norm , then ( [ qp - dir ] ) becomes a quadratic program ( qp ) .",
    "note also that the linearization of the complementarity constraint @xmath23 is relaxed by @xmath24 , giving pipa an interior - point flavor .",
    "note that pipa is not strictly an interior - point algorithm , as it remains interior only with respect to the complementary variables @xmath25 but not with respect to the other constraints .",
    "we will show that the final trust - region type constraint is the source of the problems affecting pipa .    after determining a search direction",
    ", pipa performs a backtracking line - search to ensure that @xmath26 remain positive and close to the central path .",
    "this is achieved by finding the root @xmath27 of [ e - g ] g_k ( ) = ( 1 - ) + ( _ 1 i m d^k_y_i d^k_w_i - ) .",
    "global convergence is enforced by further reducing the step length to yield sufficient reduction in a quadratic penalty function [ e - p ] p_(x , y , w , z ) = f(x , y , w , z ) + ( f(x , y , w , z ) ^2 + y^t w ) , where the penalty parameter @xmath28 is chosen to be the smallest @xmath29 such that the step ensures sufficient model decrease , [ e - moddecr ] f^k^t d - ^p",
    "( 1- ) y^k^t w^k < - ^p ( 1- ) y^k^t w^k < - y^k^t w^k .",
    "note that the penalty function @xmath30 mixes a quadratic penalty for the nonlinear equation @xmath2 with an @xmath31 penalty for complementarity ( since @xmath32 , it follows that @xmath33 ) .",
    "further details of the algorithm can be found in @xcite .",
    "pipa can be summarized as follows .",
    "* penalty interior - point algorithm ( pipa ) *    = = = 1 .",
    "_ initialization : _ + choose parameters @xmath19 , @xmath34 , + choose a starting point @xmath35 such that @xmath36 suitably centered , + choose a penalty parameter @xmath37 and set @xmath38 . +",
    "* repeat * + 2 . solve problem ( [ qp - dir ] ) for a trial step @xmath39 .",
    "+ 3 . find a step size @xmath40 to : + 3.1 ensure centrality and positivity of @xmath41 by finding the root of @xmath42 in ( [ e - g ] ) + or setting @xmath43 if this root does not exist or is greater than 1 .",
    "+ 3.2 ensure sufficient reduction in the quadratic penalty function @xmath44 + in ( [ e - p ] ) by performing an armijo - search on @xmath30 .",
    "+ let @xmath45 be the step size determined in 3.1 and 3.2 .",
    "@xmath46 , @xmath47 .",
    "+ * until * @xmath48    this presentation of pipa is less sophisticated than @xcite , which allows for instance @xmath49 to vary with the iteration . convergence of pipa is established in @xcite under the following two assumptions .",
    "* [ sc ] * strict complementarity of the solution , namely @xmath50 .    * [ ns ] * nonsingularity of the matrix @xmath51 .\\ ] ]    a sufficient condition of * [ ns ] * is that the jacobian of @xmath2 satisfies the mixed @xmath52 property .",
    "the following theorem summarizes the convergence results in @xcite .     in the next section ,",
    "we present a small example for which pipa converges to a non - stationary point , contradicting theorem  [ pipa - conv ] .",
    "in this section , we show that pipa may fail to converge to a stationary point .",
    "this result contradicts the convergence results of @xcite .",
    "this section examines the behavior of pipa applied to the following small example : [ example ]    ll & x + w + & -1 x 1 + & -1 + x + y = 0 + & 0 y w 0 .",
    "the solution of ( [ example ] ) is @xmath53 , which satisfies the assumptions * [ sc ] * and * [ ns ] * , since @xmath54 and @xmath55 \\ ; = \\ ;     \\left [ \\begin{array}{ll } 1 & 0 \\\\ 0 & 2 \\end{array } \\right]\\ ] ] is nonsingular .",
    "next , we show that this example generates a limit point that is not stationary .",
    "specifically , we perform a standard iteration of the algorithm and bound the limit away from stationarity . the following lemma summarizes our result",
    ".     * proof . *",
    "the starting point satisfies the linear equation , which implies that they are satisfied for all subsequent iterations .",
    "the theorem follows by induction . clearly , the assertions hold for the starting point",
    ". now assume that ( [ e - ind-1 ] ) to ( [ e - ind-5 ] ) hold for @xmath56 , and show that they also hold for @xmath57 .",
    "the direction - finding problem for this example can be simplified as follows : [ ex - qp ]    ll & d_x + d_w + & -1 x^k + d_x 1",
    "+ & d_x + d_y = 0 + & w^k d_y + y^k d_w = ( - 1 ) y^k w^k + & - d_x ,    where @xmath58 for simplicity .",
    "however , the example remains valid for certain positive semi - definite bounded @xmath21 .",
    "first we show that the optimal basis @xmath59 to the lp ( [ ex - qp ] ) is given by @xmath60^{-1 }     \\ ; = \\ ;     \\left [ \\begin{array}{ccc }     0 & 1 & -\\frac{w^k}{y^k } \\\\                  0 & 0 & \\frac{1}{y^k }    \\\\                  1 & -1 & \\frac{w^k}{y^k } \\end{array } \\right ] .\\ ] ] from this , multipliers can be computed as @xmath61 \\ ;      \\left ( \\begin{array}{c } 1 \\\\ 0 \\\\ 1 \\end{array } \\right ) \\ ; = \\ ;      \\left ( \\begin{array}{c }   -\\frac{w^k}{y^k } \\\\ \\frac{1}{y^k } \\\\                    1 + \\frac{w^k}{y^k } \\end{array } \\right).\\ ] ] optimality follows , since @xmath62 for the only inequality constraint .",
    "the step @xmath12 can also be computed as @xmath63 where @xmath64 is the right - hand side of the active constraints .",
    "note that for any positive semi - definite @xmath21 , this solution remains unchanged as long as @xmath62 .",
    "the contribution of the hessian to the multipliers can be estimated as @xmath65 which remains positive for @xmath66 or @xmath67 sufficiently small .",
    "thus , the same conclusions apply even if a positive definite @xmath21 is used .",
    "next , we show that ( [ e - ind-3 ] ) follows by applying the step @xmath68 , using @xmath69 and induction : x^k+1 & = & x^k + ^k d^k_x + & & x^k - + & & x^k - _ l=0^k ( ) ^l + & = & ( ) .",
    "[ e - xk ] it is easy to show that the expression in the last line is greater than @xmath70 , which implies that the `` choice '' of active set in the lp ( [ ex - qp ] ) was correct , and the lower bound on @xmath14 is never active during the iteration .",
    "next we show that ( [ e - ind-1 ] ) follows by applying the step in the @xmath5 component , @xmath71 next consider ( [ e - ind-5 ] ) , and observe that @xmath69 follows trivially . to obtain the lower bound , observe that the root of @xmath42 in ( [ e - g ] ) is given by the following expression , where the superscripts @xmath57 have been omitted for the sake of simplicity @xmath72 from the fact that @xmath73 , @xmath74 , induction , and @xmath75 , the step size can be bounded below by its leading terms : @xmath76 it remains to show that this lower bound on @xmath27 also passes the second line - search criterion . the penalty update rule in (",
    "* ( 6.1.24 ) ) finds the smallest integer @xmath77 such that @xmath78 holds , where we have used the fact that @xmath79 for all @xmath57 .",
    "since @xmath80 and @xmath81 , this is always satisfied for @xmath82 , and the penalty parameter is never increased .",
    "finally , this step size also satisfies the conditions for the armijo search in step 3.2 .",
    "the actual reduction clearly satisfies @xmath83 since @xmath84 , it follows that @xmath85 which implies the sufficient reduction condition , @xmath86 since @xmath87 and @xmath88 .",
    "next consider ( [ e - ind-2 ] ) .",
    "since @xmath89 , it follows that [ e - wnew ] w^k+1 = w^k + ( - w^k - ) w^k - .",
    "thus , it is possible to bound the new complementarity violation after the step by @xmath90 obtaining ( [ e - ind-4 ] ) .",
    "this concludes the proof .",
    "@xmath91    by taking the limit ( @xmath92 ) in ( [ e - xk ] ) , it follows , that all control iterates satisfy the bound [ e - xlim ] x^k+1 - 0.4828 . similarly , an upper bound can be derived for the state iterates as @xmath93 which shows that [ e - ylim ] y^k+1 1 + 1.4828 .",
    "these bounds can also be verified numerically .",
    "example ( [ example ] ) and pipa have been implemented in ampl @xcite by using the `` looping extension '' , which allows the convenient implementation of algorithms in ampl .",
    "the sequence that is generated is given in table  [ t - res ] and confirms the bounds given above .",
    "the columns headed `` ared '' and `` pred '' in table  [ t - res ] refer to the actual and predicted reduction .",
    "their implications are discussed below .",
    ".iterates , actual and predicted reduction of ampl implementation of pipa [ cols=\">,>,>,>,>,>\",options=\"header \" , ]     thus , it follows that all iterates remain in a compact set , namely , @xmath94 and the sequence @xmath95 has a limit point @xmath96 . from ( [ e - wnew ] ) it follows that @xmath97 so that @xmath98 and @xmath99",
    ". therefore , pipa converges to a limit point @xmath96 such that @xmath100 this limit point satisfies complementarity and the linear constraints for problem ( [ example ] ) ( since @xmath101 satisfies the linear constraints ) .",
    "moreover , this limit point also satisfies the assumptions of theorem  [ pipa - conv ] .",
    "assumption * [ sc ] * is satisfied because @xmath102 , and assumption * [ ns ] * holds because @xmath103 \\ ; = \\ ;     \\left [ \\begin{array}{ll } 1 & 0 \\\\ 0 & y^{\\infty } \\end{array } \\right]\\ ] ] is nonsingular for all @xmath104 .",
    "however , the limit point is clearly not a stationary point , thereby contradicting theorem  [ pipa - conv ] .",
    "in the preceding section , a small example has been presented for which pipa converges to a feasible but nonstationary limit point .",
    "this example contradicts ( * ? ? ?",
    "* theorem 6.1.17 ) , which establishes the convergence of pipa .",
    "the example might be considered contrived in the sense that we choose a particular starting point and parameter values . however , for any different starting point it is possible to construct parameters such that pipa fails .",
    "the reason for this apparent failure of pipa is the trust - region type constraint [ e - tr ] d_x ^2_2 c ( f^k + y^k^tw^k ) = : _ k in the direction - finding problem ( [ qp - dir ] ) .",
    "the trust - region radius @xmath105 converges to zero as the iterates approach feasibility , thereby limiting the progress toward optimality in the controls @xmath14 .",
    "this adverse behavior can be expected to occur whenever the iterates approach feasibility `` faster '' than optimality .    linking the trust - region radius to the feasibility of",
    "the problem is counterintuitive .",
    "normally , @xmath105 is controlled by the algorithm , rather than by the iterates .",
    "in particular , it should reflect how well the model problem ( [ qp - dir ] ) approximates the original problem , measured , for instance , by the agreement between actual reduction , @xmath106 and predicted reduction , @xmath107 table  [ t - res ] shows that in this example , both the actual and the predicted reductions show near perfect agreement toward the end .",
    "thus , one would expect @xmath105 to be increased rather than decreased .",
    "the adverse situation in which ( [ e - tr ] ) limits progress toward optimality can be easily detected .",
    "the lagrange multiplier of ( [ e - tr ] ) indicates whether progress can be made by relaxing this constraint . in the present example",
    ", this multiplier converges to 1 .",
    "one possible way to remedy the adverse behavior of pipa is to control the trust - region radius by using standard trust - region techniques .",
    "the direction - finding problem then becomes [ qp - dir1 ]    ll & f^k^t d + d_x^t q^k d_x + & x^k + d_x x + & f^k + f^k^t d = 0 + & y^k d_w + w^k d_y = - y^k w^k + e + & d_x _ k ,    where the trust - region is now controlled by the algorithm .",
    "a typical updating scheme for @xmath105 is as follows .",
    "first compute the ratio of actual over predicted reduction @xmath108 and then update @xmath105 according to @xmath109               & \\mbox{if } \\rho_k < \\eta_1   \\\\          \\left[\\gamma_1 \\delta_k,\\delta_k\\right ]               &",
    "\\mbox{if } \\rho_k \\in [ \\eta_1,\\eta_2 ) \\\\          \\left[\\delta_k,\\gamma_2 \\delta_k\\right ]               & \\mbox{if } \\rho_k \\geq \\eta_2          \\end{array } \\right.\\ ] ] in step 4 , where @xmath110 , and @xmath111 .",
    "typical values for these constants are @xmath112 , @xmath113 , @xmath114 , and @xmath115 .",
    "this results in a mixed trust - region / line - search algorithm .",
    "convergence can be established under the assumption that the jacobian of @xmath2 , @xmath116 , \\ ] ] remains nonsingular and has a bounded inverse along the lines of the coupled trust - region approach of dennis et al .",
    "@xcite , since the qp subproblem can be regarded as a problem in @xmath13 only after eliminating @xmath117 using the linearization of @xmath2 .",
    "i am grateful to roger fletcher and jorge nocedal for many fruitful discussions on mpccs and interior - point methods .",
    "i am also grateful to jong - shi pang and an anonymous referee for useful comments on an earlier version of the paper .",
    "this work was supported by the mathematical , information , and computational sciences division subprogram of the office of advanced scientific computing research , office of science , u.s .",
    "department of energy , under contract w-31 - 109-eng-38 .",
    "m.  anitescu . on solving mathematical programs with complementarity constraints as nonlinear programs .",
    "preprint anl / mcs - p864 - 1200 , mcs division , argonne national laboratory , argonne , il , 2000 .",
    "submitted to siam j. optimization .",
    "h.  benson , d.  f. shanno , and r.  v.  d. vanderbei .",
    "interior - point methods for nonconvex nonlinear programming : complementarity constraints . technical report",
    "orfe 02 - 02 , princeton university , operations research and financial engineering , 2002 .",
    "s.  p. dirkse , m.  c. ferris , and a.  meeraus .",
    "mathematical programs with equilibrium constraints : automatic reformulation and solution via constraint optimization .",
    "technical report na-02/11 , oxford university computing laboratory , july 2002 .",
    "r.  fletcher , s.  leyffer , d.  ralph , and s.  scholtes . local convergence of sqp methods for mathematical programs with equilibrium constraints .",
    "numerical analysis report na/209 , department of mathematics , university of dundee , dundee , uk , may 2002 .",
    "j.  huang and j .- s .",
    "pang . a mathematical programming with equilibrium approach to the implied volatility surface of american options . technical report , dept . of mathematical sciences , the johns hopkins university , baltimore , maryland ,",
    "december 1999 .",
    "a.  raghunathan and l.  t. biegler .",
    "barrier methods for mathematical programs with complementarity constraints ( mpccs ) . technical report , carnegie mellon university , department of chemical engineering , pittsburgh , december 2002 ."
  ],
  "abstract_text": [
    "<S> equilibrium equations in the form of complementarity conditions often appear as constraints in optimization problems . </S>",
    "<S> problems of this type are commonly referred to as mathematical programs with complementarity constraints ( mpccs ) . a popular method for solving mpccs </S>",
    "<S> is the penalty interior - point algorithm ( pipa ) . </S>",
    "<S> this paper presents a small example for which pipa converges to a nonstationary point , providing a counterexample to the established theory . </S>",
    "<S> the reasons for this adverse behavior are discussed .    </S>",
    "<S> * keywords : * nonlinear programming , interior - point methods , pipa , mpec , mpcc , equilibrium constraints .    </S>",
    "<S> * ams - msc2000 : * 90c30 , 90c33 , 90c51 , 49m37 , 65k10 . </S>"
  ]
}