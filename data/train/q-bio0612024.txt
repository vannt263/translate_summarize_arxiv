{
  "article_text": [
    "it is well known that the dynamics of populations under recombination is notoriously difficult to treat , even if the population is so large that stochastic fluctuations due to genetic drift can be neglected , so that the time evolution may be described by a deterministic dynamical system .",
    "the difficulty lies in the inherent nonlinearity of the corresponding ( difference or differential ) equations , which stems from the interaction of pairs of parental individuals during recombination .    the overwhelming part of the literature on the dynamics of recombination deals with _ discrete _ time .",
    "the first solutions go back to geiringer ( 1944 , @xcite ) and bennett ( 1954 , @xcite ) ; their construction was more recently worked out in greater detail and completeness by dawson @xcite .",
    "the underlying mathematical structures were investigated within the framework of genetic algebras , see @xcite , or @xcite .",
    "quite generally , the solution relies on a certain nonlinear transformation ( known as haldane linearisation ) from ( gamete or haplotype ) frequencies to suitable linkage disequilibria , which decouple from each other and decay geometrically .",
    "but if more than three loci are involved , this transformation must be constructed via recursions that involve the parameters of the recombination process , and is not available explicitly except in the trivial case of free recombination ( i.e. , independent gene loci ) .",
    "a different approach was taken by barton and turelli @xcite by translating type frequencies into certain sets of moments ; the resulting iterations are well - suited for symbolic manipulation , numerical treatment , and biological interpretation , but do not lead to ( and do not primarily aim at ) explicit solutions . for a review of the area , see ( * ? ? ?",
    "it has turned out recently @xcite that , in contrast to the discrete - time situation , the corresponding dynamics in _ continuous _ time permits a simple explicit solution in a biologically relevant special case , namely , the situation in which at most one crossover happens at any given time . here",
    ", only recombination events may occur that partition the sites of a sequence ( or the loci on a chromosome ) into two _ ordered _ subsets that correspond to the sites before and after a given crossover point .",
    "in contrast to previous approaches , the solution is given directly in terms of the original type frequencies ; but , again , a transformation to certain linkage disequilibria is available that linearise and diagonalise the system .",
    "the main simplification lies in the fact that the transformation is independent of the recombination rates and is available in a simple explicit form .",
    "however , the focus in modern population genetics is on _ finite _ populations , which also experience genetic drift ( that is , resampling ) . in order to investigate the relevance of the deterministic solution for the more involved stochastic system",
    ", we shall , in this paper , examine the corresponding finite population model , namely , the moran model with recombination , and compare some of its properties with the infinite population model , both analytically and by means of simulations .",
    "we shall show the following :    * in a _",
    "finite _ population with recombination , but without resampling ( i.e. , every pair of recombined offspring replaces its pair of parents ) , the type frequencies are , _ in expectation _ , given by the corresponding quantities for _ infinite _ populations .",
    "this property holds exactly as long as the genetic material is conserved in the recombination process , and to a very good approximation otherwise .",
    "this connection between stochastic and deterministic models is by no means obvious : it is usually reserved for populations of individuals that evolve independently ( like branching processes ) ; or to systems with interactions that do not change the expected type frequencies ( such as the moran model with independent mutation and resampling ) .",
    "in contrast , interaction due to recombination _ does _ change the expected composition of the population , and does , therefore , not appear to be of this simple form .",
    "* if the joint action of recombination and resampling is considered , the process of type frequencies differs from the deterministic dynamics , even in expectation , particularly if the population is small .",
    "it follows from general arguments , however , that the former converges to the latter when population size goes to infinity . by means of simulations ,",
    "we show that this limit yields a good approximation of realistic biological situations : convergence is fast enough to justify the use of the deterministic solution already for populations of moderate size ( of the order of @xmath0 individuals , say ) .    the paper is organised as follows .",
    "we first recapitulate the single - crossover differential equation and its solution .",
    "this is appropriate since the original articles @xcite use a rather abstract measure - theoretical framework suitable for very general type spaces , which is not easily accessible to theoretical biologists .",
    "we reduce the formalism to the important special case of finite type spaces , which is free from technical subtleties and permits an explicit representation in terms of probability vectors as well as illustration by means of concrete examples .",
    "we then change gears and explore the moran model with recombination . with the help of standard techniques for markov chains in continuous time",
    ", we develop the results stated above .",
    "we start by extracting from @xcite and @xcite the continuous - time dynamics of single crossovers in an infinite population .",
    "let us consider genes or chromosomes as linear arrangements of sites , indexed by the set @xmath1 ; sites may be interpreted as either nucleotide positions in a stretch of dna , or gene loci on a chromosome .",
    "for each site @xmath2 , there is a set @xmath3 of `` letters '' ( to be interpreted as nucleotides or alleles , respectively ) that may possibly occur at that site . to allow for a convenient notation",
    ", we restrict ourselves to the simple but important case of _ finite _ sets @xmath3 ; for the full generality of arbitrary locally compact @xmath3 , the reader is referred to the original articles .    a _ type _",
    "is thus defined as a sequence @xmath4 , where @xmath5 shall be called the _",
    "type space_. by construction , @xmath6 is the @xmath7-th coordinate of @xmath8 , and we define @xmath9 as the collection of coordinates with indices in @xmath10 , where @xmath10 is a subset of @xmath11 .",
    "types may be understood as alleles ( if sites are nucleotide positions ) or haplotypes ( if sites are gene loci ) .",
    "we shall think at the haploid level , speak of gametes as individuals , and describe a population as a distribution of ( absolute ) frequencies ( or a non - negative measure ) @xmath12 on @xmath5 .",
    "namely , @xmath13 denotes the frequency of type @xmath14 , and @xmath15 for @xmath16 ; we abbreviate @xmath13 as @xmath17 .",
    "the set of all frequency distributions on @xmath5 is denoted by @xmath18 .",
    "if we define @xmath19 as the point measure on @xmath8 ( i.e. , @xmath20 for @xmath21 ) , we can also write @xmath22 . we may , alternatively , interpret @xmath19 as the basis vector of @xmath23 that corresponds to @xmath8 ( where a suitable ordering of types is implied , and @xmath24 is the number of elements in @xmath5 ) ; @xmath12 is thus identified with a vector in @xmath23 .    at this stage , frequencies need not be normalised ; @xmath17 may simply be thought of as the size of the subpopulation of type @xmath8 , measured in units so large that it may be considered a continuous quantity .",
    "the corresponding normalised version @xmath25 ( where @xmath26 is the total population size ) is then a probability distribution on @xmath5 , and may be identified with a probability vector .",
    "recombination acts on the links between the sites ; the links are collected into the set @xmath27 .",
    "we shall use latin indices for the sites and greek indices for the links , and the implicit rule will always be that @xmath28 is the link between sites @xmath7 and @xmath29 ; see figure  [ fig : sitesandlinks ] .     sites and links . ]",
    "we shall make the simplifying assumption that only single crossovers occur at a time ( which is realistic if linkage is tight , i.e. , if the sites belong to the dna sequence of , say , less than a megabase , or represent a few adjacent loci ) .",
    "more precisely , for every @xmath30 , every individual exchanges , at rate @xmath31 , the sites after link @xmath32 with those of a randomly chosen partner . explicitly , if the ` active ' and the partner individual are of type @xmath8 and @xmath33 , then the new pair has types @xmath34 and @xmath35 , where @xmath36 is the largest integer below @xmath32 ( the smallest above @xmath32 ) ; see fig .",
    "[ fig : reco ] .",
    "since every individual can occur as either the ` active ' individual or as its randomly chosen partner , we have a total rate of @xmath37 for crossovers at link @xmath32 . for later use ,",
    "we also define @xmath38 .",
    "the dynamics of the type frequencies is then given by the system of differential equations @xmath39 for all @xmath14 , where a `` @xmath40 '' at site @xmath7 stands for @xmath3 and denotes marginalisation over the letters at site @xmath7 ( i.e. , @xmath41 is the frequency of individuals which have letters @xmath42 at the sites before @xmath32 , and arbitrary letters from @xmath43 at the sites after @xmath32 ) .",
    "note that the assumption of a reciprocal exchange ( between two parents that combine into _ two _ offspring under conservation of the genetic material ) is an ` effective ' description that results from taking the symmetry of recombination into account .",
    "a more detailed model starts out from two parents combining into _ one _ offspring ; but the symmetry of the process again leads to eq .",
    "[ eq : ode ] and is thus equivalent to our picture , see ( * ? ? ?",
    "in contrast to the deterministic situation , however , these details do play a role in finite populations ; this will be taken up in sec .",
    "[ sec : stoch ] .",
    "upper panel : recombination between individuals of type @xmath8 and @xmath33 .",
    "lower panel : the corresponding ` marginalised ' version that summarises all events by which individuals of type @xmath8 are gained or lost . note that , in either case , the process can go both ways , as indicated by the arrows . ]    we have retained the non - normalised version for the frequencies here for easier comparison with the stochastic model ( the stochastic process will come naturally as a family of integer - valued random variables , which sum up to the population size @xmath44 ) .",
    "of course , the more familiar normalised version emerges if @xmath45 in is replaced by @xmath46 ; the normalising factor on the right - hand side is then , of course , unity .",
    "note that the model implies hardy - weinberg proportions ( i.e. , frequencies of diplotypes are given by independent combination of the corresponding haplotypes at all times ) .",
    "in continuous time , this only applies exactly if the duration of the diplophase is negligible .",
    "however , it is a good approximation if recombination is rare at the scale of an individual s lifetime .",
    "an important ingredient to the solution of the large , nonlinear system of differential equations ( [ eq : ode ] ) lies in its reformulation in terms of recombination operators .",
    "let us introduce the projection operators @xmath47",
    ", @xmath48 , via @xmath49 i.e. , @xmath47 is the canonical projection to the @xmath7-th coordinate . likewise , for any index set @xmath50 ,",
    "one defines a projector @xmath51 via @xmath52 .",
    "we shall frequently use the abbreviations @xmath53 and @xmath54 , as well as @xmath55 , @xmath56 .",
    "the projectors @xmath57 and @xmath58 may be thought of as _ cut and forget _ operators because they take the leading or trailing segment of a sequence @xmath8 , and forget about the rest .",
    "whereas the @xmath59 act on the types , we also need the induced mapping at the level of the population , namely , @xmath60 where @xmath61 denotes the preimage under @xmath59 . the operation @xmath62 ( where the dot is on the line and",
    "should not be confused with a multiplication sign ) is known as the `` pullback '' of @xmath59 w.r.t .",
    "@xmath12 ; in terms of coordinates , the definition may be spelled out as @xmath63",
    "so , @xmath64 is nothing but the marginal distribution of @xmath12 with respect to the sites in @xmath10 .",
    "in particular , @xmath65 is the marginal frequency of sequences prescribed at the sites before @xmath32 , and vice versa for the sites after @xmath32 .",
    "note that , although we have defined @xmath66 as acting on nonnegative measures ( or vectors ) only , this linear operator may be extended to the set of all measures .",
    "now , recombination ( at the level of the population ) means the relinking of a randomly chosen leading segment with a randomly chosen trailing segment .",
    "we therefore introduce ( elementary ) recombination operators ( or _ recombinators _ , for short ) , @xmath67 for @xmath30 , defined by @xmath68 here , the tensor product reflects the independent combination ( i.e. , the product measure ) of the two marginals @xmath69 and @xmath70 .",
    "@xmath71 is therefore a _ cut and relink _ operator .",
    "@xmath72 may be understood as the population that emerges if _ all _ individuals of the population @xmath12 disintegrate into their leading and trailing segments , and these are relinked randomly ; the sites before @xmath32 are then in linkage equilibrium with respect to those after @xmath32 .",
    "note that @xmath73 .    in terms of coordinates , eq .",
    "reads @xmath74 the recombination dynamics ( [ eq : ode ] ) may thus be compactly rewritten as @xmath75 where @xmath76 is the identity operator .",
    "the solution of ( [ eq : compact ] ) relies on some elementary properties of our recombinators .",
    "most importantly , they are idempotents and commute with each other , i.e. , @xmath77 these properties are intuitively very plausible : if linkage equilibrium has already been established at link @xmath32 , then further recombination at that link does not change the situation ; and if a product measure is formed with respect to two links @xmath32 and @xmath78 , the result does not depend on the order in which the links are affected . for the proof , we refer to ( * ? ? ?",
    "2 ) ; let us only mention here that it relies on the elementary fact that , for @xmath79 , @xmath80 that is , recombination at or after @xmath32 does not affect the marginal frequencies at sites before @xmath32 , and vice versa .",
    "we now define _ composite _ recombinators as @xmath81 here , the product is to be read as composition ; it is , indeed , a matrix product if the recombinators are written in their matrix representation , which is available in the case of finite types considered here ( see @xcite ) . by property ( [ eq : commut ] )",
    ", the order in the composition plays no role .",
    "furthermore , ( [ eq : idpot ] ) and ( [ eq : commut ] ) obviously entail @xmath82 for @xmath83 .",
    "the solution of the single - crossover dynamics ( [ eq : compact ] ) may now be given in closed form as @xmath84 with coefficients @xmath85 and initial value @xmath86 ; i.e. , @xmath87 is the _ semigroup _ belonging to the recombination equation .",
    "for the proof , the reader is referred to ( * ? ? ?",
    "2 ) , or ( * ? ? ?",
    "3 ) ( the former article contains the original , the latter a shorter and more elegant version of the proof ) .",
    "let us only note here that the coefficients @xmath88 have the following intuitive explanation . in a given individual , consider the set of links that has , until @xmath89 , been hit by at least one crossover event .",
    "the probability that this set is @xmath90 equals the probability that all links in @xmath90 have already been hit , while those in the complement of @xmath90 have not ; by independence across links , this probability is just @xmath88 .",
    "we would like to note , however , that this plausible argument should not be taken too far : for example , an analogous solution , although suggestive , does _ not _ apply to the corresponding single - crossover model in _ discrete _ time ( its solution is , in fact , much more difficult , see the discussion in @xcite ) .",
    "indeed , explicit solutions to large , nonlinear systems are rare ",
    "explicit semigroups are usually available for linear systems at best . for this reason , the recombination equation and its solution",
    "have already been taken up in the framework of functional analysis , where they have led to an extension of potential theory @xcite . in the next paragraph",
    ", we will meet some further clues to an underlying linear structure that lurks behind the solution .",
    "the approach described in the previous section is somewhat unconventional from a population genetics perspective , in that it solves the recombination dynamics at the level of the type frequencies . as mentioned in the introduction",
    ", however , one usually works with transformed quantities , like moments , cumulants , or linkage disequilibria ( ldes ) .",
    "indeed , certain linkage disequilibria are intimately connected with the solution just presented , and provide the key to an underlying linearity , and hence simplicity , as we shall now see . following @xcite ,",
    "let us define what we shall call _ lde operators _ via @xmath91 where the underdot indicates the summation variable .",
    "( [ eq : t_g ] ) leads to the inverse @xmath92 by mbius inversion , a versatile tool from combinatorial theory , see ( * ? ? ?",
    "* thm .  4.18 ) .",
    "it was shown in @xcite that , if @xmath45 is the solution , the transformed quantities @xmath93 satisfy @xmath94 which is a system of _ decoupled , linear , homogeneous _",
    "differential equations , with solution @xmath95 .",
    "note that this simple form emerged through the _ nonlinear _ transform  ( [ eq : t_g ] ) as applied to the solution of the _ coupled , nonlinear _ differential equation .",
    "obviously , the @xmath93 provide candidates for the definition of linkage disequilibria which decouple , and decay exponentially ( unless , of course , @xmath96 , which corresponds to the stationary state @xmath97 the population in linkage equilibrium with respect to all links ) .",
    "all that remains to be done is to identify a set of suitable components to work with ( using all components of @xmath93 , for all @xmath98 , would imply a lot of redundancy ) .    to this end , let us introduce the following shorthand notation .",
    "let @xmath99 , with @xmath100 , symbolically denote a so - called _ cylinder set _ in @xmath5 that is specified at sites @xmath101 , for @xmath102 .",
    "more precisely , these are sets of the form @xmath103 \\times \\ { x^{}_{j_k } \\ }   \\times x_{j_{k+1 } } \\times \\dots   \\times x_n , \\label{eq : prec}\\ ] ] where @xmath104 $ ] contains factors @xmath105 or @xmath3 depending on whether @xmath7 appears in the set @xmath106 or not .",
    "that is , with the cylinder set @xmath107 , we mean the set of types that have prescribed letters @xmath108 at sites @xmath109 , and arbitrary letters at all other sites .",
    "note that the shorthand @xmath110 is symbolic in that it does not specify the letters explicitly ( the @xmath111 appear on the right - hand side of ( [ eq : prec ] ) , but not on the left ) . note also that the cylinder sets formalise our previous ` @xmath112 ' notation : @xmath113 is the marginal frequency of the types prescribed at sites @xmath114 , and may be rewritten as @xmath115    let us now define _ linkage disequilibria _ ( or _ correlation functions _ ) of order @xmath116 via @xmath117 that is , for a given cylinder set , ldes emerge by applying , to @xmath118 , the lde operator defined by the links before the first and after the last element of that cylinder set , and evaluating the resulting quantity at the cylinder set .",
    "clearly , @xmath119 contains products of at most @xmath116 marginal frequencies .",
    "note that we have defined linkage disequilibria on the basis of the _ normalised _ quantities @xmath120 for the sake of compatibility , and comparability , with related quantities in population genetics .    by we know that , for every cylinder set @xmath107 , @xmath121 we thus have linkage disequilibria _ of all orders _ that decouple and decay exponentially . it was shown in @xcite that the collection of @xmath122 , for all index sets @xmath123 and all choices of letters @xmath124 , is complete in that it uniquely determines @xmath120 .    _ an example .",
    "_ consider @xmath125 .",
    "the highest ( fourth - order ) lde is , on the basis of ( [ eq : t_g ] ) and ( [ eq : d_t ] ) , given by @xmath126 - [ 0 ] [ 1,2,3 ] -   [ 0,1 ] [ 2,3 ] -   [ 0,1,2 ] [ 3 ] \\\\   +   & [ 0 ] [ 1 ] [ 2,3 ] + [ 0 ] [ 1,2 ] [ 3 ]    + [ 0,1 ] [ 2 ] [ 3 ] \\\\   -   & [ 0][1][2][3 ] , \\end{split}\\ ] ] where we have now used the shorthand @xmath127:=   p_t(\\langle j_1 , \\ldots , j_k \\rangle ) $ ] . by , we have @xmath128 .",
    "the third- , second- , and first - order ldes are given by @xmath129   - [ j_1 ] [ j_2,j_3 ] - [ j_1,j_2 ] [   j_3 ] + [ j_1 ] [ j_2 ] [ j_3 ] , \\\\",
    "d_t(\\langle j_1,j_2 \\rangle ) & = & [ j_1,j_2 ] - [ j_1 ] [ j_2 ] , \\\\ d_t(\\langle",
    "j_1 \\rangle ) & = & [ j_1 ] , \\end{aligned}\\ ] ] where the latter correspond to the letter frequencies , as usual .    obviously , the @xmath130 are correlation functions that measure the dependence between sites , at the various orders .",
    "it is important to note that they agree with other measures of lde ( see ( * ? ? ?",
    "v.4.2 ) for an overview ) only up to order two . from order",
    "three onwards , they are special in that terms like @xmath131[1]$ ] or @xmath132[1,2]$ ] are absent .",
    "this is due to the fact that our @xmath130 are based on _ ordered _ partitions of @xmath11 , and thus only contain terms ` produced ' by composite recombinators ; they are therefore adapted to single - crossover dynamics . in contrast , conventional ldes or central moments",
    "are based on _ unordered _ partitions , which can not be produced by composite recombinators .",
    "the finite population counterpart of our deterministic model is the moran model with single - crossover recombination . to simplify matters ( and in order to clearly dissect the individual effects of recombination and resampling ) , we shall assume that resampling ( traditionally referred to as genetic drift ) and recombination occur independently of each other .",
    "more precisely , we assume a finite population of fixed size @xmath44 , in which every individual experiences , independently of the others ,    * resampling at rate @xmath133 . the individual reproduces , the offspring inherits the parent s type and replaces a randomly chosen individual ( possibly its own parent ) . + * recombination at ( overall ) rate @xmath134 at link @xmath30 .",
    "every individual picks a random partner ( maybe itself ) at rate @xmath31 , and the pair exchanges the sites after link @xmath32 .",
    "that is , if the recombining individuals have types @xmath8 and @xmath33 , they are replaced by the two offspring individuals @xmath135 and @xmath136 , as in the deterministic case , and fig .  [ fig : reco ] .",
    "that is , the genetic material is conserved , and any resampling effect is excluded . as before , the per - capita rate of recombination at link @xmath32 is then @xmath134 , because both orderings of the individuals lead to the same event . to avoid degeneracies",
    ", we shall assume throughout that @xmath137 for all @xmath30 .",
    "as in the deterministic model , the factor @xmath138 arises every time _ ordered _ pairs ( of an active individual and a randomly chosen partner ) are considered ( it is the same factor that also occurs when the moran and wright - fisher models are compared @xcite ) .",
    "note that the randomly chosen second individual ( for resampling or recombination ) may be the active individual itself ; then , effectively , nothing happens .",
    "one might , for biological reasons , prefer to exclude these events by sampling from the remaining population only ; but this means nothing but a change in time scale of order @xmath139 .    to formalise this verbal description of the process ,",
    "let the state of the population at time @xmath89 be given by the collection @xmath140 , where @xmath141 is the number of individuals of type @xmath8 at time @xmath89 ; clearly , @xmath142 .",
    "we also use @xmath143 in the sense of a ( random counting ) measure , in analogy with @xmath45 ( but keep in mind that @xmath143 is integer - valued and counts single individuals , whereas @xmath45 denotes continuous frequencies in an infinite population ) .",
    "the letter @xmath144 will be used to denote realisations of @xmath143  but note that the symbols @xmath145 , and @xmath144 are not on equal footing ( @xmath8 and @xmath33 will continue to be types ) .",
    "the stochastic process @xmath146 is the continuous - time markov chain on @xmath147 defined as follows .",
    "if the current state is @xmath148 , two types of transitions may occur : @xmath149 ( where @xmath19 is the point measure on @xmath8 , as before ) .",
    "note that , in and , transitions that leave @xmath147 are automatically excluded by the fact that the corresponding rates vanish .",
    "note that ` empty transitions ' ( @xmath150 or @xmath151 ) are explicitly included ( they occur if @xmath152 in resampling or recombination , and if @xmath153 or @xmath154 in recombination ) .",
    "this is convenient since the total reproduction and recombination rates in the population ( as based on active individuals ) are then given by @xmath155 and @xmath156 , respectively , independently of @xmath144 , a fact that comes in handy in the simulations .",
    "since we only require @xmath143 at ( equidistant ) epochs @xmath157 , @xmath158 no waiting times for individual events need be generated ; rather , we may draw the total number of events in a time interval @xmath159 from the poisson distribution with parameter @xmath160 .",
    "the nature of each event is then determined in the obvious way ( the active individual is of type @xmath8 with probability @xmath161 ; the second individual ( chosen randomly for resampling or recombination ) is of type @xmath33 with probability @xmath162 ; the pair performs resampling with probability @xmath163 , or recombination with probability @xmath164 ; if recombination occurs , then at link @xmath32 with probability @xmath165 ) .    for simulations ,",
    "the description of the process through and is perfectly adequate . for the theoretical analysis",
    ", however , one also needs the rates @xmath166 for the transitions @xmath167 for _ given _",
    "@xmath168 , @xmath169 ( where @xmath170 ) . here",
    ", one must take care of the fact that distinct combinations of @xmath145 , and @xmath32 may lead to the same ` net ' transition .",
    "clearly , @xmath171 , where @xmath172 of course , the empty sum corresponds to impossible transitions and is understood as @xmath173 .",
    "note that the sum in contains more than one term only in the case @xmath174 ; however , is a ` true ' sum ( of at least two terms ) whenever @xmath175 is of the form @xmath176 for some @xmath177 .",
    "note that , with the rates for ` empty transitions ' as ascribed to the diagonal elements @xmath178 , the collection @xmath179 does _ not _ form a markov generator ; but the corresponding generator @xmath180 is obtained by defining @xmath181 , for @xmath182 , together with @xmath183 .",
    "this rather informal definition of the markov chain in terms of its transitions and their rates is all that is required for this article ",
    "after all , we are in the well - behaved situation of a finite state space . excellent overviews of many aspects of markov chains in continuous time ( including the formal details ) can be found in ( * ? ? ?",
    "2 ) or ( * ? ? ?",
    "in contrast to the situation in infinite populations , it now matters whether one or two offspring are created at a time . for comparison",
    ", we shall , therefore , also consider the alternate ( biologically more realistic ) recombination scheme in which an individual recombines with a random partner , but only _ one _ of the offspring is kept ( chosen randomly ) , and replaces _",
    "one _ of its parents ( again chosen randomly ) . that is , instead of , we now have four recombination transitions @xmath184 each at rate @xmath185 note that , in contrast to , the symmetry between @xmath8 and @xmath33 is broken in single transitions .",
    "furthermore , only half as many replacements happen here ; the corresponding deterministic dynamics is , therefore , given by with @xmath134 replaced by @xmath31 for all @xmath30 .",
    "more importantly , the recombination scheme , no longer conserves the genetic material ( since net replacements ( e.g.  of @xmath186 by @xmath187 ) take place ) , which introduces a ( minor ) resampling effect not present in .",
    "if not stated otherwise , however , we will stick to for our recombination transitions .",
    "let us now explore the connection between the stochastic process @xmath188 on @xmath147 , its normalised version @xmath189 on @xmath190 , and the solution @xmath191 of the differential equation .",
    "we shall first consider the case without resampling ( i.e. , @xmath192 ) and show that @xmath193 ( and , consequently , @xmath194 ) , for _ arbitrary _ @xmath44 . for @xmath195 , still with finite @xmath44 , this is no longer true ; however , @xmath196 converges to @xmath197 for @xmath198 , provided @xmath199 converges to @xmath200 .",
    "we shall make this convergence explicit , and investigate it by means of simulations .      for lack of reference and the sake of completeness ,",
    "we start by making explicit a plausible  and often implicitly - used  fact concerning the evolution of the expectation in finite - state continuous - time markov chains .",
    "[ fact : exp_change ] let @xmath188 be a continuous - time markov chain on a finite subset @xmath147 of @xmath201 , as defined by its transitions from state @xmath144 to state @xmath202 ( @xmath203 ) taking place at rates @xmath166 . for all @xmath204 ,",
    "the expectation of @xmath143 then satisfies the equation @xmath205 where , for @xmath168 , @xmath206    before turning to the proof , let us note that @xmath207 may be interpreted as the ` mean rate - of - change vector ' of the chain in state @xmath144 .",
    "a little later , we shall turn into a differential equation for @xmath208 .",
    "let us first recall the elementary fact that , for the markov chain starting in @xmath209 , we have @xmath210 , where we have suppressed dependence on @xmath211 on the left - hand side , and @xmath212 is the markov semigroup corresponding to @xmath213 , the generator of the chain ( obtained from the collection of transition rates @xmath214 , see above ) .",
    "therefore , @xmath215 , and , since @xmath216 , @xmath217 where the third equality sign is due to the fact that @xmath213 is a markov generator .    after this digression ,",
    "let us return to the moran model ( with recombination _ and _ resampling ) , and show that @xmath218 on @xmath147 , where @xmath219 continues to be the right - hand side of .",
    "to this end , recall that @xmath143 is a ( counting ) measure , to which our projection operators may be applied in the usual way . in agreement with",
    ", we write @xmath220 i.e. , @xmath221 is the marginal of @xmath143 w.r.t .   the sites in @xmath10 ; and , likewise , for a realisation @xmath144 of @xmath143 .",
    "again , we also use shorthands such as @xmath222 to denote marginal frequencies ( in this case , @xmath223 ) . furthermore , we set @xmath224 for @xmath50 .    to calculate @xmath225 ,",
    "let us write @xmath226 , where @xmath227 and @xmath228 take care of transitions due to resampling and recombination , respectively . by symmetry of the transition rates for resampling , @xmath229 ( type frequencies are martingales under resampling alone ) ; we can therefore restrict ourselves to the recombination transitions defined by @xmath230 of . summing , as in , over all possibilities for the gain or loss of a single @xmath8-individual ( cf .  fig .  [",
    "fig : reco ] , lower panel ) , one obtains for the @xmath8-component of @xmath225 @xmath231 where , of course , @xmath232 , and @xmath233 .",
    "one immediately recognises the familiar structure of .",
    "we may therefore conclude :    [ fact : f = phi ] in the moran model with resampling and recombination transitions according to and , we have @xmath218 on @xmath147 , with @xmath219 of .",
    "let us now return to eq .  .",
    "note that , in general , it does not lead to a `` closed '' differential equation for @xmath234 , because it is not clear whether @xmath235 can be written as a function of @xmath208 alone . clearly , @xmath236 if @xmath225 is linear ( or affine ) , as , for example , in markov branching processes , or in the moran model with mutation , but without recombination .",
    "but for nonlinear @xmath225 , this tends to be violated , as nicely illustrated in ( * ? ? ?",
    "1.4 ) for the case of the ricker model in ecology .",
    "if @xmath225 is nonlinear but polynomial ( the usual case in population genetics or chemical reaction systems , for example ) , ( [ eq : ivp ] ) can still serve as a starting point for an expansion involving a hierarchy of moments , which can be closed by suitable approximation methods ( like , for example , the quasi - linkage equilibrium approach in @xcite ) .",
    "our aim in this paragraph is to show that recombination _ without _ resampling is another ( and apparently new ) exception : despite its nonlinearity , @xmath219 satisfies @xmath237 , provided the marginals of @xmath238 are independent , which always applies if @xmath238 is fixed .",
    "this will require a lemma concerning the independence of marginal processes .",
    "for @xmath50 , we introduce the ` stretch ' @xmath239 and look at the projection of the recombination process on non - overlapping stretches .",
    "this is the content of the following lemma .",
    "[ lem : indep_marginals ] let @xmath188 be the recombination process without resampling as defined by the transition rates .",
    "let @xmath240 with @xmath241 .",
    "then , @xmath242 and @xmath243 are conditionally ( on @xmath238 ) independent markov chains on @xmath244 and @xmath245 .",
    "clearly , for any given @xmath50 , @xmath246 is a stochastic process on @xmath247 .",
    "let us first show that @xmath248 and @xmath249 are individually markov chains , and then establish that they are ( conditionally ) independent . for the first step ,",
    "observe that , when @xmath143 performs the transition @xmath167 ( on @xmath147 ) , with @xmath250 for some @xmath30 and @xmath21 , then @xmath221 goes from @xmath251 on @xmath247 , where @xmath252 .",
    "the rate for a corresponding ` projected transition ' @xmath253 ( @xmath254 ) is then given by summing all rates of the original process that lead to the transition @xmath255 under the projection . that is , with @xmath256 and the shorthand @xmath257 ( and likewise for @xmath258 ) , one gets @xmath259 for @xmath168 .",
    "since these rates only depend on @xmath260 ( rather than @xmath144 itself ) , they define a collection of rates @xmath261 ( @xmath262 ) so that @xmath263 for all @xmath168 .",
    "therefore , the marginalised process @xmath264 is a markov chain on @xmath247 with transitions @xmath265 at rates @xmath261 .",
    "( this is an example of the so - called _ lumping procedure _ for markov chains , compare @xcite and @xcite for the general case , or @xcite for the sequence context considered here ) .",
    "our processes @xmath242 and @xmath243 are therefore markov on @xmath244 and @xmath245 , respectively .    for the second step , we note that , for given @xmath32 and @xmath10 , a net transition in @xmath266 ( i.e. , @xmath267 ) requires @xmath268 .",
    "since @xmath241 by assumption , @xmath269 implies @xmath270 and vice versa .",
    "a transition in @xmath242 therefore leaves @xmath243 unchanged , and vice versa . the joint process @xmath271 therefore has generator @xmath272 , where @xmath273 is the generator of @xmath242 , @xmath274 the generator of @xmath243 , and @xmath275 and @xmath276 denote the identity on @xmath244 and @xmath245 , respectively . hence , the marginal processes are conditionally independent , and the claim follows .",
    "[ rem : mutual ] although we have , for ease of notation , formulated the above result for two subsets @xmath277 and @xmath278 only , the proof obviously goes through for any collection @xmath279 , if the @xmath280 , @xmath281 , are pairwise disjoint .",
    "we then obtain that @xmath282 are conditionally independent markov chains .",
    "if , furthermore , @xmath283 are independent , conditional independence of the marginal processes turns into independence .",
    "in particular , this is the case if @xmath238 is fixed ( since @xmath284 is then a point measure on some @xmath285 ) .    as an immediate consequence ,",
    "we now arrive at    [ thm : reco_expect ] let @xmath146 be the recombination process without resampling ( i.e. , @xmath192 ) , and let @xmath238 be fixed . then , @xmath286 satisfies the differential equation @xmath287 with initial value @xmath238 , and @xmath219 from ; therefore , @xmath288 with @xmath87 from .    applying fact [ fact : exp_change ] , eq .",
    ", lemma  [ lem : indep_marginals ] , and the linearity of the expectation , one finds @xmath289\\\\ & = & \\sum_{\\alpha\\in l }    \\frac{\\varrho^{}_\\alpha}{n } \\big [ \\big ( \\mathbb{e } ( \\pi^{}_{<\\alpha }   .",
    "z_t ) \\big ) \\otimes \\big ( \\mathbb{e } ( \\pi^{}_{>\\alpha}. z_t ) \\big )   - \\ee(z_t ) \\big ] \\\\ & = & \\sum_{\\alpha\\in",
    "l }    \\frac{\\varrho^{}_\\alpha}{n } \\big [ \\big ( \\pi^{}_{<\\alpha } .",
    "\\mathbb{e } (    z_t ) \\big ) \\otimes \\big ( \\pi^{}_{>\\alpha}. \\mathbb{e } (   z_t )   \\big ) - \\ee(z_t ) \\big ] \\\\",
    "& = & \\varphi \\big ( \\ee(z_t ) \\big ) .\\end{aligned}\\ ] ]    ( clearly , the third step is the decisive one ; it hinges on the independence of the marginals . )    [ rem : oneoff ] note that theorem  [ thm : reco_expect ] does _ not _ hold for the alternate recombination scheme .",
    "this is because the associated resampling effect already destroys the validity of lemma [ lem : indep_marginals ] , which is essential for the proof .",
    "we will come back to this in the next paragraph ; but let us already mention here that the deterministic solution continues to be an excellent approximation to the expectation , as long as recombination rates are small .",
    "it will also be shown below that , in practice , the resampling effect thus introduced is minor as long as recombination rates are small , and averages continue to be very close to the deterministic solution .",
    "now that the equivalence between the deterministic solution and the expectation has been safely established at the level of the type frequencies , it immediately carries over to the linkage disequilibria :    under the assumptions of thm .",
    "[ thm : reco_expect ] , one has , for all @xmath204 , @xmath290    use the definitions of @xmath291 and @xmath292 , then remark  [ rem : mutual ] , and finally theorem  [ thm : reco_expect ] .",
    "in particular , if we define @xmath293 ( so that @xmath294 is the stochastic equivalent of @xmath130 of ) , we obtain the relation @xmath295 , for all cylinder sets @xmath296 .",
    "[ fig : reco_only ] illustrates the findings of this paragraph for a four - locus two - allele system with recombination and no resampling .",
    "we have chosen @xmath297 and @xmath298 for @xmath299 , which corresponds to four sites spaced evenly across a stretch of @xmath300 bp , at a per - nucleotide recombination rate of @xmath301 .",
    "the figure shows haplotype frequencies and highest - order ldes , both as single trajectories and averages over many realisations , as compared to the solution of the deterministic recombination equation .",
    "for very small populations ( @xmath302 ) , single trajectories fluctuate markedly , but averages over 100 realisations are already indistinguishable from the deterministic solution  in line with the property of the expectation just established . for larger populations , the stochasticity is already greatly reduced in single trajectories  but this is the topic of the next paragraph .",
    "the figure also contains results from the alternate resampling scheme with one offspring only ,  .",
    "although theorem  [ thm : reco_expect ] is not exactly valid in this case , the resampling effect thus introduced is obviously minor as long as recombination rates are small , and averages continue to be very close to the deterministic solution .",
    "-3ex + 2ex      let us now include resampling , at rate @xmath303 , and consider the stochastic process @xmath304 defined by both and , where we add the upper index here to indicate the dependence on @xmath44 .",
    "now , @xmath219 and @xmath305 no longer commute . the processes @xmath306 and @xmath307 are still individually markov , but",
    "their resampling events are coupled ( replacement of @xmath308 by @xmath309 is always tied to replacement of @xmath187 by @xmath186 ) .",
    "hence the marginal processes fail to be independent , so that no equivalent of lemma [ lem : indep_marginals ] holds .",
    "let us , therefore , change focus and consider the normalised version @xmath310 .",
    "it seems to be general folklore in population genetics that , in the limit @xmath311 , the relative frequencies of the moran or wright - fisher model cease to fluctuate and are then given by the solution of the corresponding deterministic equation .",
    "this is implied no matter which evolutionary forces ( like mutation , selection , or recombination ) are included into the model ; in our case , @xmath312 should be described by the differential equation as @xmath311 .",
    "however , the limit theorem behind this is usually not made explicit , and , in fact , does not seem to be well known in the population genetics literature . indeed , it is given by a very general law of large numbers due to ethier and kurtz ( * ? ? ?",
    "11.2.1 ) , which provides the formal justification for a very large class of models in biology that are stochastic at the microscopic scale but are adequately described deterministically if the population size is large ; they range from biochemical reaction kinetics to population dynamics and population genetics . for our special case",
    ", it reads as follows .",
    "[ prop : lln ] consider the family of processes @xmath313 , @xmath314 , where @xmath315 is defined by and .",
    "assume that the initial states are chosen so that @xmath316",
    ". then , for every given @xmath317 , one has _",
    "st | ^(n)_s - p_s | = 0 with probability @xmath318 , where @xmath319 is the solution of the deterministic recombination equation .    to apply thm .",
    "11.2.1 of @xcite , we need a linear scaling of the transition rates with @xmath44 . more precisely , we must show that the transition rates @xmath320 of the process @xmath321 are , for all @xmath203 , of the form @xmath322 with non - negative functions @xmath323 defined on a subset of @xmath324 .",
    "setting @xmath325 together with @xmath326 , and recalling that @xmath327 ( from and  now with notational dependence on @xmath44 ) , it is obvious that is indeed satisfied .",
    "( observe that this just reflects the relation @xmath328 . )",
    "the normalised process @xmath329 on @xmath190 has the corresponding transitions @xmath330 , again at rates @xmath331 .",
    "thus , the collection of processes @xmath329 constitutes what is known as a _ density - dependent family corresponding to the @xmath323 _ @xcite .",
    "now , for such a density - dependent family , thm .",
    "11.2.1 of @xcite implies if @xmath120 solves @xmath332 , with initial value @xmath200 , and @xmath333 .",
    "proceeding as in and , we obtain @xmath334 in analogy with fact  [ fact : f = phi ] .",
    "note that the convergence in applies for any given @xmath89 , but need not hold for @xmath335 ; we shall come back to this point in the discussion .",
    "note also that the convergence carries over to linkage disequilibria , since @xmath336 converges to @xmath337 ( in the above sense ) .",
    "the question that remains is whether this limit result bears any relevance to real populations , which are always finite .",
    "how large must @xmath44 be for the infinite - population limit to yield a reasonable approximation ?",
    "we have investigated this by means of simulations of our four - locus two - allele system ( fig .",
    "[ fig : reco_res ] ) .",
    "as is to be expected , single realisations , as well as averages , approach the deterministic limit with increasing @xmath44 ; and for @xmath338 , the stochastic process is already very close to the limit .",
    "this is observed at the level of type frequencies , as well as linkage disequilibria .",
    "the situation is very similar to that without resampling ( fig .",
    "[ fig : reco_only ] , ( a ) and ( e ) ) , except that somewhat larger population sizes are required due to the increased stochasticity induced by resampling .",
    "in contrast , averages over _ small _ populations are not expected to , and in fact do not , get close to the deterministic solution .",
    "the main purpose of this article has been to clarify some relationships between the moran model with recombination and the deterministic recombination model ( both with single crossovers ) . to separate the effects of recombination from those of resampling , we formulated the moran model in its ` decoupled ' version , with independent recombination and resampling events ; this approach is also taken in @xcite , for example .",
    "the coupling of recombination to resampling ( which happens to be biological reality ) is thus neglected .",
    "put differently , our model describes correctly the resampling effects due to reproduction events that do not involve recombination , but neglects those resampling events that occur in the course of reproduction associated with recombination .",
    "but recombination is rare ( relative to reproduction ) , at least at the molecular level aimed at by the single - crossover model ; and the bias introduced by this simplification is accordingly small , as also illustrated by our simulations of the alternative recombination scheme  .      1 .   for recombination without resampling ,",
    "the expected type frequencies are given by the deterministic dynamics , for arbitrary ( even small ) population sizes .",
    "although this is not a biologically realistic situation , it yields insight into the moran model with recombination , and establishes a relationship between finite and infinite populations that is somewhat unexpected in view of the inherent nonlinearity of recombination .",
    "the key observation that led to this result rests upon the fact that the marginal processes ( i.e. , the type frequencies at the sites before resp .  after a given link ) are independent markov chains .",
    "of course , this is related to the fact that , in the absence of resampling , the genetic material is completely conserved ( just rearranged ) ; in particular , types can not go to fixation .",
    "2 .   the combined model _ with _",
    "resampling deviates ( in expectation ) from the deterministic dynamics ; in view of the findings above , these deviations are solely due to resampling , rather than recombination .",
    "but the infinite population limit continues to apply , and is , again , given by the deterministic recombination equation .",
    "we have investigated its range of validity here for one representative scenario ( four biallelic loci , a time horizon of @xmath339 , an expected number of @xmath340 recombination events per link and individual , and @xmath341 resampling events per individual ) ; then , a population of moderate size ( @xmath338 ) is already close to the deterministic limit . it should be noted , however , that this result is expected to further vary with : 1 .",
    "the number of sites , or of alleles per site ( or , more generally , the size of the type space ) : the deterministic limit can only be a good approximation if _ all types _ are well - populated ; for a larger type space , the required population size will be larger .",
    "but situations with four loci ( or variable nucleotide sites ) already cover many interesting biological situations ; and typing them ( and determining the corresponding four - way ldes ) is , after all , a veritable task that yields a great deal of information .",
    "it remains to be investigated , however , how the quality of the approximation changes when there are more than two alleles per site .",
    "the time horizon : the law of large numbers holds for every given , finite time horizon , but need not carry over to @xmath335 . indeed , if resampling is present , the population size required to get close to the deterministic solution is expected to grow over all bounds with increasing @xmath89 .",
    "this is because , for every finite @xmath44 , the moran model with resampling and recombination is an _ absorbing _ markov chain , which leads to fixation ( i.e. , a homogeneous population of uniform type ) in finite time with probability one ( for the special case of just two types without recombination , the expected time is of order @xmath44 , if the initial frequencies are both @xmath138 @xcite ) . in sharp contrast , the deterministic system never loses any type , and the stationary state , the complete product measure , is , in a sense , even the most variable state accessible to the system . for increasing @xmath44 ,",
    "finite populations stay close to the deterministic limit for an increasing length of time ( see fig .",
    "[ fig : reco_res ] ) .",
    "indeed , our main interest here is this time horizon during which substantial changes in lde occur , and this is described by the deterministic model ; in contrast , the deterministic solution does not provide a meaningful picture for the equilibrium situation .",
    "the case would be very different if mutation were included into the model , since this would turn the absorbing markov chain into an ergodic one , whose stationary distribution allows a meaningful comparison with the deterministic dynamics even for @xmath335 .",
    "* a model without resampling ( i.e. , the only events are single crossovers between pairs of individuals , with pairs of offspring replacing pairs of parents ) : although one might assume this model to behave like the corresponding discrete - time dynamical system for finite @xmath44 , _ in expectation _ , we indeed stipulate that this is not the case .",
    "the reason is that , in discrete time , the marginal processes ( related to non - overlapping stretches ) cease to be independent .",
    "this is because such independence would imply the possibility of two or more crossovers in one generation  in contrast to the single - crossover assumption .",
    "for the same reason , the deterministic single - crossover model in discrete time is much more difficult to solve than in continuous time , see the discussion in @xcite .",
    "* recombination combined with resampling : it is strongly expected that , for @xmath198 , there is again a law of large numbers , which makes the relative frequencies converge to the corresponding deterministic dynamics , in analogy with prop .",
    "[ prop : lln ] .",
    "however , no explicit equivalent of the underlying theorem 11.2.1 of @xcite is known to the authors .",
    "it is our pleasure to thank richard hudson for a decisive hint on the structure of stochastic recombination , and the icms workshop on mathematical genetics ( edinburgh 2006 ) for providing ample opportunity to discuss the results .",
    "we are grateful to michael baake , matthias birkner , and thiemo hustedt for critically reading the manuscript .",
    "this work was supported by the dutch - german bilateral research group on random spatial models in physics and biology ( dfg - for 498 ) .",
    "e.  popa . some remarks on a nonlinear semigroup acting on positive measures . in o.",
    "carja and i.  i. vrabie , eds .",
    ", _ applied analysis and differential equations _ , pp .",
    "308319 . world scientific , singapore , 2007 ."
  ],
  "abstract_text": [
    "<S> populations evolving under the joint influence of recombination and resampling ( traditionally known as genetic drift ) are investigated . </S>",
    "<S> first , we summarise and adapt a deterministic approach , as valid for infinite populations , which assumes continuous time and single crossover events . </S>",
    "<S> the corresponding nonlinear system of differential equations permits a closed solution , both in terms of the type frequencies and via linkage disequilibria of all orders . to include stochastic effects </S>",
    "<S> , we then consider the corresponding finite - population model , the moran model with single crossovers , and examine it both analytically and by means of simulations . </S>",
    "<S> particular emphasis is on the connection with the deterministic solution . </S>",
    "<S> if there is only recombination and every pair of recombined offspring replaces their pair of parents ( i.e. , there is no resampling ) , then the _ expected _ type frequencies in the finite population , of arbitrary size , equal the type frequencies in the infinite population . </S>",
    "<S> if resampling is included , the stochastic process converges , in the infinite - population limit , to the deterministic dynamics , which turns out to be a good approximation already for populations of moderate size . </S>"
  ]
}